From mbdavis at VividSolutions.com  Mon Feb  3 13:07:51 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] RE: CoordinateListFactory
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD876@venus.VividSolutions.com>

Here's the idea for CoordinateListFactory:  (I'm doing it in Java terms since it's a bit simpler

abstract class CoordinateListFactory
{
	public static CoordinateListFactory internalFactory = new BasicCoordinateListFactory();

	CoordinateList createCoordinateList(int size);
}

class BasicCoordinateListFactory
{
	createCoordinateList(int size)	{		return new BasicCoordinateList(size); }
}

... in the code, where it needs to create a new CoordinateList:

	CoordinateList coordList = CoordinateListFactory.internalFactory.createCoordinateList(size);

Library users such as PostGIS can initialize CoordinateListFactory.internalFactory to whatever CoordinateListFactory they want to use, or simply leave it as Basic if they don't care.

I haven't had a chance to try the compile again, but I will today.


Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Yury A. Bychkov [mailto:me@yury.ca]
> Sent: Saturday, February 01, 2003 10:38 PM
> To: Martin Davis
> Subject: CoordinateListFactory
> 
> 
> Hi Martin,
> 
> I've finished removing useless methods from CoordinateLists 
> and cleaned up more
> of the code including those "returning address of local 
> variable or temporary"
> errors (I don't know how I've missed them), but I wanted to 
> consult with you on
> something:
> 
> When we talked on friday, you've mentioned a very nice 
> solution on how to switch
> the CoordinateListFactory to making a particular subclass of 
> CoordinateList. I
> am afraid that I didn't quite understood your solution (and 
> only realized it
> later (well, sometimes my brain doesn't work well :-(
> Maybe you can explain it to me again? I came up with other 
> ways to implement the
> CoordinateListFactory, but all of them are much more cumbersome.
> 
> Yury
> P.S. BTW, did the code compile once you removed CoordinateList.cpp?
> 
> 
> 

From an900th at lycos.com  Tue Feb  4 14:43:05 2003
From: an900th at lycos.com (ANTHONY THABO)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] ANTHONY  THABO  ( Urgent business proposal )
Message-ID: <20030204194225.0677E43774@offsite.refractions.net>

Dear Sir / Madam,
                                                STRICTLY CONFIDENTIAL.

I am pleased to introduce myself  to you.My name is Mr. Anthony  Thabo  a native of South Africa and a senior employee of mines and natura resources department currently on a trainning course in Holland for few months.

I  am writing this letter to request your assistance in order to redeem an investment with the South African mining Corporation.The said investment, now valued at  ( US$15.750 million dollars) Fifteen million,seven hundred and fifty thousand dollars only was purchased by ( Lucio
Harper ) and contracted out to the South  African Mining Corporation in 1977 now recognised as mines and natural resources department.This redeemable investment interest,has now matured since March last year.

Since March last year, several attempts have been made to contact Lucio Harper without success and there is no way to contact any of his close relatives in whose favour the investment cash value can be paid.

Since we have access to all Lucio Harper's information,we can claim this money with the help of my partners with the South African Mines and natural resources department.All we have to do is to file claim using you as Lucio Harper's relative. I will like to assure you that there is absolutely nothing to worry about,because it is perfectly safe with no risk involved.Please
ensure to keep this matter strictly confidential.My partner will file a claim for this money on your behalf from the South African mining Corporation.When the claim is approved,you as the beneficiary will be paid (35%) of the total amouth.

Since this money can be paid directly into any bank account of your choice,you have responsibility to ensure that my partner and I receive(60%)of the total amouth.While the balance (5%) will be set aside for any unforseen expenses in the cause of transfering this money. I will appreciate if you can give your assurance and guarantee that our share will
be well secured.Please for the sake of confidentiality,reach me on my e-mail
address:  anthonythabo@netscape.net      Let me know if this proposal is acceptable to you.And kindly reach me immediately with any of the stated contact addresses so that better clearifications relating to the transaction will be explained to you.

Thank you and God bless.

Truly yours,
Anthony  Thabo.
      
From nhv at cape.com  Thu Feb  6 22:48:12 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] RE: CoordinateListFactory
References: <5A94289A9268514C8D6C0F1FF44BA0270FD876@venus.VividSolutions.com>
Message-ID: <093901c2ce5b$bd6c6aa0$7037ba8c@sfdev3>

gcc 3.2 has a problem in geometry.cpp

Coordinate& Geometry::minCoordinate(CoordinateList* coordinates){
 vector<Coordinate> v(*(coordinates->toVector()));
< line 80 > sort(v.begin(),v.end(),lessThen);
 return v.front();
}

< comment >
If this is called a lot it would probably be faster to have a
CoordinateList::minCoordinate() method so that the
vector copy and sort need not be performed
< / comment >

It is nice to see some action in the CVS

Cheers

Norman

g++ -DHAVE_CONFIG_H -I. -I../../../source/geom -I../../source/headers -I../../../source/headers -DGEOS_VERSION=\"1\" -O2 -MT
Geometry.lo -MD -MP -MF .deps/Geometry.Tpo -c ../../../source/geom/Geometry.cpp  -DPIC -DPIC -o Geometry.o
/usr/include/c++/3.2/bits/stl_algo.h: In function `const _Tp&
   std::__median(const _Tp&, const _Tp&, const _Tp&, _Compare) [with _Tp =
   Coordinate, _Compare = bool (*)(Coordinate&, Coordinate&)]':
/usr/include/c++/3.2/bits/stl_algo.h:2147:   instantiated from `void std::__introsort_loop(_RandomAccessIter, _RandomAccessIter,
_Size, _Compare) [with _RandomAccessIter = __gnu_cxx::__normal_iterator<Coordinate*, std::vector<Coordinate,
std::allocator<Coordinate> > >, _Size = int, _Compare = bool (*)(Coordinate&, Coordinate&)]'
/usr/include/c++/3.2/bits/stl_algo.h:2209:   instantiated from `void std::sort(_RandomAccessIter, _RandomAccessIter, _Compare) [with
_RandomAccessIter = __gnu_cxx::__normal_iterator<Coordinate*, std::vector<Coordinate, std::allocator<Coordinate> > >, _Compare =
bool (*)(Coordinate&, Coordinate&)]'
../../../source/geom/Geometry.cpp:80:   instantiated from here
/usr/include/c++/3.2/bits/stl_algo.h:124: could not convert `__a' to `
   Coordinate&'
/usr/include/c++/3.2/bits/stl_algo.h:125: could not convert `__b' to `
   Coordinate&'
/usr/include/c++/3.2/bits/stl_algo.h:127: could not convert `__a' to `
   Coordinate&'
/usr/include/c++/3.2/bits/stl_algo.h:131: could not convert `__a' to `
   Coordinate&'
/usr/include/c++/3.2/bits/stl_algo.h:133: could not convert `__b' to `




From pramsey at refractions.net  Fri Feb  7 11:31:25 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] RE: CoordinateListFactory
In-Reply-To: <093901c2ce5b$bd6c6aa0$7037ba8c@sfdev3>
References: <5A94289A9268514C8D6C0F1FF44BA0270FD876@venus.VividSolutions.com>
 <093901c2ce5b$bd6c6aa0$7037ba8c@sfdev3>
Message-ID: <3E43DF5D.6050004@refractions.net>

There is also a resurgance in the use of ->at() in the newly committed 
code which should probably be removed.

That stl error w/ GNU is a little worrisome.

P.

Norman Vine wrote:
> gcc 3.2 has a problem in geometry.cpp
> 
> Coordinate& Geometry::minCoordinate(CoordinateList* coordinates){
>  vector<Coordinate> v(*(coordinates->toVector()));
> < line 80 > sort(v.begin(),v.end(),lessThen);
>  return v.front();
> }
> 
> < comment >
> If this is called a lot it would probably be faster to have a
> CoordinateList::minCoordinate() method so that the
> vector copy and sort need not be performed
> < / comment >
> 
> It is nice to see some action in the CVS
> 
> Cheers
> 
> Norman
> 
> g++ -DHAVE_CONFIG_H -I. -I../../../source/geom -I../../source/headers -I../../../source/headers -DGEOS_VERSION=\"1\" -O2 -MT
> Geometry.lo -MD -MP -MF .deps/Geometry.Tpo -c ../../../source/geom/Geometry.cpp  -DPIC -DPIC -o Geometry.o
> /usr/include/c++/3.2/bits/stl_algo.h: In function `const _Tp&
>    std::__median(const _Tp&, const _Tp&, const _Tp&, _Compare) [with _Tp =
>    Coordinate, _Compare = bool (*)(Coordinate&, Coordinate&)]':
> /usr/include/c++/3.2/bits/stl_algo.h:2147:   instantiated from `void std::__introsort_loop(_RandomAccessIter, _RandomAccessIter,
> _Size, _Compare) [with _RandomAccessIter = __gnu_cxx::__normal_iterator<Coordinate*, std::vector<Coordinate,
> std::allocator<Coordinate> > >, _Size = int, _Compare = bool (*)(Coordinate&, Coordinate&)]'
> /usr/include/c++/3.2/bits/stl_algo.h:2209:   instantiated from `void std::sort(_RandomAccessIter, _RandomAccessIter, _Compare) [with
> _RandomAccessIter = __gnu_cxx::__normal_iterator<Coordinate*, std::vector<Coordinate, std::allocator<Coordinate> > >, _Compare =
> bool (*)(Coordinate&, Coordinate&)]'
> ../../../source/geom/Geometry.cpp:80:   instantiated from here
> /usr/include/c++/3.2/bits/stl_algo.h:124: could not convert `__a' to `
>    Coordinate&'
> /usr/include/c++/3.2/bits/stl_algo.h:125: could not convert `__b' to `
>    Coordinate&'
> /usr/include/c++/3.2/bits/stl_algo.h:127: could not convert `__a' to `
>    Coordinate&'
> /usr/include/c++/3.2/bits/stl_algo.h:131: could not convert `__a' to `
>    Coordinate&'
> /usr/include/c++/3.2/bits/stl_algo.h:133: could not convert `__b' to `
> 
> 
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From pramsey at refractions.net  Sat Feb  8 19:32:00 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Status? Almost there? Working?
Message-ID: <3E45A180.5030406@refractions.net>


Itching to know...


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From me at yury.ca  Sat Feb  8 22:27:19 2003
From: me at yury.ca (Yury A. Bychkov)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Status
Message-ID: <00ff01c2cfeb$2ad39a10$b9354d18@yury>

Hi Everyone,

Current Status: I've committed the latest version of GEOS to the repository. It
now has
CoordinateList Factories, PointCoordinateClass, etc and GEOS seems to be working
fine regardless of which CoordinateList implementation (Basic or Point) is used
as the default one. Code is currently being reviewed by Martin and hopefully
he'll Ok it.

Results from Friday's phone meeting: There was a bug (reported by Norman) in the
Geometry::minCoordinate method that has to be fixed. He also suggested it would
be more efficient to move this method into CoordinateList. Me and Martin
discussed it on Friday agreed with him. Some of the similar methods would be
moved into CoordinateList as well.

Things to do next: Bring the GEOS up to date with the latest JTS version (1.3)
and continue the porting (with isValid).

Yury



From pramsey at refractions.net  Tue Feb 11 17:45:13 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Some Compile Issues
Message-ID: <3E497CF9.1080007@refractions.net>

OK, since there were some new checkins I started doing some compile 
stuff on Linux.

Firstly, in PointCoordinateList.cpp on lines 25 and 35, the for loops 
should have {} around their commands (don't skimp on the {}!).

Secondly, I have a cataclysmic failure in Geometry.cpp, as follows:

/bin/sh ../../libtool --mode=compile g++ -DHAVE_CONFIG_H -I. -I. 
-I../../source/headers -I../../source/headers -DGEOS_VERSION=\""1"\" 
-g -O2 -c -o Geometry.lo `test -f 'Geometry.cpp' || echo './'`Geometry.cpp
rm -f .libs/Geometry.lo
g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers 
-I../../source/headers -DGEOS_VERSION=\"1\" -g -O2 -c Geometry.cpp -MT 
Geometry.lo -MD -MP -MF .deps/Geometry.TPlo  -fPIC -DPIC -o 
.libs/Geometry.lo
/usr/include/g++-3/stl_algo.h: In function `const _Tp &__median (const
_Tp &, const _Tp &, const _Tp &, _Compare) [with _Tp = Coordinate,
_Compare = bool (*) (Coordinate &, Coordinate &)]':
/usr/include/g++-3/stl_algo.h:1309:   instantiated from 
`__introsort_loop (_RandomAccessIter, _RandomAccessIter, _Tp *, _Size, 
_Compare) [with _RandomAccessIter = Coordinate *, _Tp = Coordinate, 
_Size = int, _Compare = bool (*) (Coordinate &, Coordinate &)]'
/usr/include/g++-3/stl_algo.h:1332:   instantiated from `sort 
(_RandomAccessIter, _RandomAccessIter, _Compare) [with _RandomAccessIter 
= Coordinate *, _Compare = bool (*) (Coordinate &, Coordinate &)]'
Geometry.cpp:80:   instantiated from here
/usr/include/g++-3/stl_algo.h:64: could not convert `__a' to
`Coordinate &'
/usr/include/g++-3/stl_algo.h:65: could not convert `__b' to
`Coordinate &'
/usr/include/g++-3/stl_algo.h:67: could not convert `__a' to
`Coordinate &'
/usr/include/g++-3/stl_algo.h:71: could not convert `__a' to
`Coordinate &'
/usr/include/g++-3/stl_algo.h:73: could not convert `__b' to
`Coordinate &'
make[2]: *** [Geometry.lo] Error 1
make[2]: Leaving directory `/home/pramsey/geos/source/geom'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/pramsey/geos/source'
make: *** [all-recursive] Error 1


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From me at yury.ca  Tue Feb 11 18:36:12 2003
From: me at yury.ca (Yury A. Bychkov)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Some Compile Issues
References: <3E497CF9.1080007@refractions.net>
Message-ID: <00d701c2d226$5f342bc0$b9354d18@yury>

> Firstly, in PointCoordinateList.cpp on lines 25 and 35, the for loops
> should have {} around their commands (don't skimp on the {}!).

Fixed.

> Secondly, I have a cataclysmic failure in Geometry.cpp, as follows:
This seems to be same error that Norman reported several days ago. Hopefully
I've fixed it now (also, the minCoordinate() method has been moved to the
CoordinateList).

I've just committed the code to the CVS. Try it now.

Yury



From pramsey at refractions.net  Tue Feb 11 18:56:20 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Some Compile Issues
In-Reply-To: <00d701c2d226$5f342bc0$b9354d18@yury>
References: <3E497CF9.1080007@refractions.net>
	<00d701c2d226$5f342bc0$b9354d18@yury>
Message-ID: <3E498DA4.8080205@refractions.net>

OK, we have complete compilation! I have checked some changes to 
source/geom/Makefile.am back in. There were copious warnings, some of 
which are probably important :) I leave such determinations to the 
experts though. Now on to the tests...

P.

Yury A. Bychkov wrote:
> Firstly, in PointCoordinateList.cpp on lines 25 and 35, the for loops
> should have {} around their commands (don't skimp on the {}!).
> 
> 
> Fixed.
> 
> 
>>Secondly, I have a cataclysmic failure in Geometry.cpp, as follows:
> 
> This seems to be same error that Norman reported several days ago. Hopefully
> I've fixed it now (also, the minCoordinate() method has been moved to the
> CoordinateList).
> 
> I've just committed the code to the CVS. Try it now.
> 
> Yury
> 
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From pramsey at refractions.net  Tue Feb 11 18:58:20 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Current Benchmarks
In-Reply-To: <00d701c2d226$5f342bc0$b9354d18@yury>
References: <3E497CF9.1080007@refractions.net>
	<00d701c2d226$5f342bc0$b9354d18@yury>
Message-ID: <3E498E1C.9040201@refractions.net>

Athlon 1800+

# overlapping MCs: 406
# segment intersection tests: 226
n Pts: 1000  Executed in  10000 ms.
# overlapping MCs: 406
# segment intersection tests: 278
n Pts: 2000  Executed in  40000 ms.
# overlapping MCs: 406
# segment intersection tests: 248
n Pts: 4000  Executed in  70000 ms.
# overlapping MCs: 406
# segment intersection tests: 250
n Pts: 8000  Executed in 120000 ms.
# overlapping MCs: 406
# segment intersection tests: 272
n Pts: 16000  Executed in 250000 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 32000  Executed in 510000 ms.
# overlapping MCs: 406
# segment intersection tests: 236
n Pts: 64000  Executed in 1030000 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 128000  Executed in 2040000 ms.
# overlapping MCs: 406
# segment intersection tests: 238
n Pts: 256000  Executed in 4100000 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 512000  Executed in 8100000 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 1024000  Executed in 16280000 ms.
Done

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From me at yury.ca  Tue Feb 11 19:05:24 2003
From: me at yury.ca (Yury A. Bychkov)
Date: Fri Nov  2 20:52:05 2007
Subject: [geos-devel] Current Benchmarks
References: 
	<3E497CF9.1080007@refractions.net><00d701c2d226$5f342bc0$b9354d18@yury>
	<3E498E1C.9040201@refractions.net>
Message-ID: <001801c2d22a$72d86980$b9354d18@yury>

Hi Paul,

Are you sure you don't have 3 extra 0's at the end of those numbers?

My results (P4-2.53):
# overlapping MCs: 406
# segment intersection tests: 226
n Pts: 1000  Executed in     10 ms.
# overlapping MCs: 406
# segment intersection tests: 278
n Pts: 2000  Executed in     20 ms.
# overlapping MCs: 406
# segment intersection tests: 248
n Pts: 4000  Executed in     40 ms.
# overlapping MCs: 406
# segment intersection tests: 250
n Pts: 8000  Executed in     90 ms.
# overlapping MCs: 406
# segment intersection tests: 272
n Pts: 16000  Executed in    190 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 32000  Executed in    351 ms.
# overlapping MCs: 406
# segment intersection tests: 236
n Pts: 64000  Executed in    701 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 128000  Executed in   1502 ms.
# overlapping MCs: 406
# segment intersection tests: 238
n Pts: 256000  Executed in   2784 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 512000  Executed in   5528 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 1024000  Executed in  11426 ms.

Yury
----- Original Message ----- 
From: "Paul Ramsey" <pramsey@refractions.net>
To: "GEOS Development List" <geos-devel@geos.refractions.net>
Sent: Tuesday, February 11, 2003 3:58 PM
Subject: [geos-devel] Current Benchmarks


> Athlon 1800+
> 
> # overlapping MCs: 406
> # segment intersection tests: 226
> n Pts: 1000  Executed in  10000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 278
> n Pts: 2000  Executed in  40000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 248
> n Pts: 4000  Executed in  70000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 250
> n Pts: 8000  Executed in 120000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 272
> n Pts: 16000  Executed in 250000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 264
> n Pts: 32000  Executed in 510000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 236
> n Pts: 64000  Executed in 1030000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 264
> n Pts: 128000  Executed in 2040000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 238
> n Pts: 256000  Executed in 4100000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 232
> n Pts: 512000  Executed in 8100000 ms.
> # overlapping MCs: 406
> # segment intersection tests: 232
> n Pts: 1024000  Executed in 16280000 ms.
> Done
> 
> -- 
>        __
>       /
>       | Paul Ramsey
>       | Refractions Research
>       | Email: pramsey@refractions.net
>       | Phone: (250) 885-0632
>       \_
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 


From pramsey at refractions.net  Tue Feb 11 19:59:25 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current Benchmarks
In-Reply-To: <001801c2d22a$72d86980$b9354d18@yury>
References: 
	<3E497CF9.1080007@refractions.net><00d701c2d226$5f342bc0$b9354d18@yury>
	<3E498E1C.9040201@refractions.net> <001801c2d22a$72d86980$b9354d18@yury>
Message-ID: <3E499C6D.5040402@refractions.net>

I'll check... in other news, this version still passes all the JTS tests.

Failed: 0
Succeeded: 490

Yury A. Bychkov wrote:
> Hi Paul,
> 
> Are you sure you don't have 3 extra 0's at the end of those numbers?



-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From pramsey at refractions.net  Tue Feb 11 20:21:22 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current Benchmarks
In-Reply-To: <001801c2d22a$72d86980$b9354d18@yury>
References: 
	<3E497CF9.1080007@refractions.net><00d701c2d226$5f342bc0$b9354d18@yury>
	<3E498E1C.9040201@refractions.net> <001801c2d22a$72d86980$b9354d18@yury>
Message-ID: <3E49A192.8070100@refractions.net>

I'm using exactly the same code as you are... the only thing I can think 
is that the GNU library uses microseconds and the MS library uses 
milliseconds.

   startTime=clock();
   poly->intersects(box);
   endTime=clock();
   double totalTime=(double)(endTime-startTime);
   printf( "n Pts: %i  Executed in %6.0f ms.\n",nPts,totalTime);


Yury A. Bychkov wrote:
> Hi Paul,
> 
> Are you sure you don't have 3 extra 0's at the end of those numbers?


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From mbdavis at VividSolutions.com  Tue Feb 11 20:45:46 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current Benchmarks
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD91F@venus.VividSolutions.com>

And people wonder why C isn't portable...

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Paul Ramsey [mailto:pramsey@refractions.net]
> Sent: Tuesday, February 11, 2003 5:21 PM
> To: Yury A. Bychkov; GEOS Development List
> Subject: Re: [geos-devel] Current Benchmarks
> 
> 
> I'm using exactly the same code as you are... the only thing 
> I can think 
> is that the GNU library uses microseconds and the MS library uses 
> milliseconds.
> 
>    startTime=clock();
>    poly->intersects(box);
>    endTime=clock();
>    double totalTime=(double)(endTime-startTime);
>    printf( "n Pts: %i  Executed in %6.0f ms.\n",nPts,totalTime);
> 
> 
> Yury A. Bychkov wrote:
> > Hi Paul,
> > 
> > Are you sure you don't have 3 extra 0's at the end of those numbers?
> 
> 
> -- 
>        __
>       /
>       | Paul Ramsey
>       | Refractions Research
>       | Email: pramsey@refractions.net
>       | Phone: (250) 885-0632
>       \_
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 

From mbdavis at VividSolutions.com  Tue Feb 11 20:48:17 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current benchmarks - MD
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD920@venus.VividSolutions.com>

# overlapping MCs: 406
# segment intersection tests: 226
n Pts: 1000  Executed in    120 ms.
# overlapping MCs: 406
# segment intersection tests: 278
n Pts: 2000  Executed in    210 ms.
Here's my performance figures...  disappointingly slower than both Paul (adjusted for 000's) and Yury...

But I'm happy that it compiles and runs!  Next up - a bit of a code review, and then sign-off.

(Pentium 1.1 GhZ)

# overlapping MCs: 406
# segment intersection tests: 248
n Pts: 4000  Executed in    441 ms.
# overlapping MCs: 406
# segment intersection tests: 250
n Pts: 8000  Executed in    881 ms.
# overlapping MCs: 406
# segment intersection tests: 272
n Pts: 16000  Executed in   1713 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 32000  Executed in   3675 ms.
# overlapping MCs: 406
# segment intersection tests: 236
n Pts: 64000  Executed in   7970 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 128000  Executed in  14019 ms.
# overlapping MCs: 406
# segment intersection tests: 238
n Pts: 256000  Executed in  27987 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 512000  Executed in  57696 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 1024000  Executed in 113169 ms.
Done

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


From nhv at cape.com  Tue Feb 11 21:25:53 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current benchmarks - MD
In-Reply-To: <5A94289A9268514C8D6C0F1FF44BA0270FD920@venus.VividSolutions.com>
Message-ID: <EKEJIKAILPONGGENMBGAOEBDCIAA.nhv@cape.com>

Martin  Davis writes:
> 
> Here's my performance figures...  disappointingly slower than 
> both Paul (adjusted for 000's) and Yury...
> 
> But I'm happy that it compiles and runs!  Next up - a bit of a 
> code review, and then sign-off.

attached find changes I needed to compile the CVS
< CoordinateList.cpp change was *not* required but ...  >

Norman

FWIW
Cygwin compiled gcc 3.2
PentiumIII 733

$ source/bigtest/TestSweepLineSpeed.exe
# overlapping MCs: 406
# segment intersection tests: 226
n Pts: 1000  Executed in     30 ms.
# overlapping MCs: 406
# segment intersection tests: 278
n Pts: 2000  Executed in     60 ms.
# overlapping MCs: 406
# segment intersection tests: 248
n Pts: 4000  Executed in    110 ms.
# overlapping MCs: 406
# segment intersection tests: 250
n Pts: 8000  Executed in    210 ms.
# overlapping MCs: 406
# segment intersection tests: 272
n Pts: 16000  Executed in    401 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 32000  Executed in    861 ms.
# overlapping MCs: 406
# segment intersection tests: 236
n Pts: 64000  Executed in   1632 ms.
# overlapping MCs: 406
# segment intersection tests: 264
n Pts: 128000  Executed in   3294 ms.
# overlapping MCs: 406
# segment intersection tests: 238
n Pts: 256000  Executed in   6629 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 512000  Executed in  13289 ms.
# overlapping MCs: 406
# segment intersection tests: 232
n Pts: 1024000  Executed in  26518 ms.
Done
-------------- next part --------------
A non-text attachment was scrubbed...
Name: diffs
Type: application/octet-stream
Size: 6499 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20030211/2c9b5d21/diffs.obj
From nhv at cape.com  Tue Feb 11 22:36:01 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current benchmarks - MD
In-Reply-To: <5A94289A9268514C8D6C0F1FF44BA0270FD920@venus.VividSolutions.com>
Message-ID: <EKEJIKAILPONGGENMBGAEEBGCIAA.nhv@cape.com>

FYI

# segment intersection tests: 232
n Pts: 1024000  Executed in  26518 ms.
Flat profile:

Each sample counts as 0.01 seconds.
  %   cumulative   self              self     total
 time   seconds   seconds    calls   s/call   s/call  name
 29.67      7.08     7.08 161283000     0.00     0.00
BasicCoordinateList::getAt(int)
 27.45     13.63     6.55 160822780     0.00     0.00
Coordinate::Coordinate(Coordinate const&)
  6.87     15.27     1.64 41853974     0.00     0.00  Envelope::init(double,
double, double, double)
  6.12     16.73     1.46 10624588     0.00     0.00
SegmentIntersector::addIntersections(Edge*, int, Edge*, int)
  5.36     18.01     1.28 27902648     0.00     0.00
Envelope::init(Coordinate&, Coordinate&)
  2.85     18.69     0.68 13951325     0.00     0.00
Envelope::overlaps(Envelope)
  2.81     19.36     0.67 18431896     0.00     0.00
RobustCGAlgorithms::orientationIndex(Coordinate, Coordinate, Coordinate)

after inlining the top two

# segment intersection tests: 232
n Pts: 1024000  Executed in  25277 ms.
Done

Almost the same --  this is good :-)

Cheers

Norman


From pramsey at refractions.net  Wed Feb 12 01:34:19 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Current benchmarks - MD
In-Reply-To: <EKEJIKAILPONGGENMBGAOEBDCIAA.nhv@cape.com>
References: <EKEJIKAILPONGGENMBGAOEBDCIAA.nhv@cape.com>
Message-ID: <3E49EAEB.3070709@refractions.net>

I have applied all Normans diffs except the one to CoordinateList, which 
I did not feel competent to evaluate or apply. A couple of them allowed 
me to compile here at home on Red Hat 8.0.

We are getting very close to being able to do an alpha release, which is 
when we find out just how terrible the different versions of STL out 
there are. :) It is disheartening how many issues we have had just in 
the limited number of platforms available amongst us.

P.

Norman Vine wrote:
> 
> attached find changes I needed to compile the CVS

       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From pramsey at refractions.net  Wed Feb 12 01:45:09 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Warnings
Message-ID: <3E49ED75.1010306@refractions.net>

Here are the (non-trivial) warnings I get under Red Hat 8.

MultiPolygon.cpp:31: warning: taking address of temporary
Polygon.cpp:14: warning: taking address of temporary
LineString.cpp:108: warning: taking address of temporary
LineString.cpp:109: warning: taking address of temporary
../graph/GeometryGraph.cpp:42: warning: taking address of temporary
../graph/Edge.cpp:118: warning: taking address of temporary

../graph/Depth.cpp:7: warning: return to non-pointer type `int' from NULL
../graph/Depth.cpp:7: warning: argument to non-pointer type `int' from NULL
../graph/Depth.cpp:14: warning: assignment to non-pointer type `int' 
from NULL
../graph/Depth.cpp:14: warning: argument to non-pointer type `int' from NULL
../graph/Depth.cpp:45: warning: NULL used in arithmetic
../graph/Depth.cpp:53: warning: NULL used in arithmetic
../graph/Depth.cpp:57: warning: NULL used in arithmetic

LineSegment.cpp:138: warning: passing `double' for argument 1 of `
LineSegment.cpp:140: warning: passing `double' for argument 1 of `
LineSegment.cpp:142: warning: passing `double' for argument 1 of `
LineSegment.cpp:144: warning: passing `double' for argument 1 of `

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From pramsey at refractions.net  Wed Feb 12 12:24:59 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
Message-ID: <3E4A836B.4000708@refractions.net>


For the API headers, it would probably be wise to do a mass renaming, so 
that all the headers which get installed have a geos_ prefix. That way 
we can lower our odds of name collision on systems we install on. 
(Martin, insert comment about beauty of Java packaging here. :)

I was just looking at what is required to do an alpha release of geos 
(to go alongside a pre-release of geos-enabled postgis) and having 
nicely named includes would be good.

Thoughts?

P.

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From mbdavis at VividSolutions.com  Wed Feb 12 12:30:30 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD927@venus.VividSolutions.com>

Paul, can you give an example of what you mean?  It's not clear what you mean by "API headers".

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Paul Ramsey [mailto:pramsey@refractions.net]
> Sent: Wednesday, February 12, 2003 9:25 AM
> To: GEOS Development List
> Subject: [geos-devel] Include Refactoring
> 
> 
> 
> For the API headers, it would probably be wise to do a mass 
> renaming, so 
> that all the headers which get installed have a geos_ prefix. 
> That way 
> we can lower our odds of name collision on systems we install on. 
> (Martin, insert comment about beauty of Java packaging here. :)
> 
> I was just looking at what is required to do an alpha release of geos 
> (to go alongside a pre-release of geos-enabled postgis) and having 
> nicely named includes would be good.
> 
> Thoughts?
> 
> P.
> 
> -- 
>        __
>       /
>       | Paul Ramsey
>       | Refractions Research
>       | Email: pramsey@refractions.net
>       | Phone: (250) 885-0632
>       \_
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 

From pramsey at refractions.net  Wed Feb 12 12:37:26 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <5A94289A9268514C8D6C0F1FF44BA0270FD927@venus.VividSolutions.com>
References: <5A94289A9268514C8D6C0F1FF44BA0270FD927@venus.VividSolutions.com>
Message-ID: <3E4A8656.8010807@refractions.net>

The headers needed by external programs in order to call geos objects 
and know what functions are inside the library. The headers which a 
'make install' would place in the system include directory for use by 
other software.  Right now, 'make install' on geos installs the 
following in /usr/local/include:

-rw-r--r--    1 root     root        26474 Feb 12 09:22 geom.h
-rw-r--r--    1 root     root         6912 Feb 12 09:22 geosAlgorithm.h
-rw-r--r--    1 root     root        17260 Feb 12 09:22 graph.h
-rw-r--r--    1 root     root         4987 Feb 12 09:22 graphindex.h
-rw-r--r--    1 root     root         4301 Feb 12 09:22 io.h
-rw-r--r--    1 root     root         1630 Feb 12 09:22 operation.h
-rw-r--r--    1 root     root         3624 Feb 12 09:22 opRelate.h
-rw-r--r--    1 root     root          229 Feb 12 09:22 platform.h
-rw-r--r--    1 root     root          936 Feb 12 09:22 util.h

It also installs the libraries in /usr/local/lib

-rw-r--r--    1 root     root     15002262 Feb 12 09:22 libgeos.a
-rwxr-xr-x    1 root     root          705 Feb 12 09:22 libgeos.la*
lrwxrwxrwx    1 root     root           16 Feb 12 09:22 libgeos.so -> 
libgeos.so.1.0.0*
lrwxrwxrwx    1 root     root           16 Feb 12 09:22 libgeos.so.1 -> 
libgeos.so.1.0.0*
-rwxr-xr-x    1 root     root      3624493 Feb 12 09:22 libgeos.so.1.0.0*



Martin Davis wrote:
> Paul, can you give an example of what you mean?  It's not clear what you mean by "API headers".
> 
> Martin Davis, Senior Technical Specialist
> Vivid Solutions Inc.
> Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
> Phone: (250) 385 6040    Fax: (250) 385 6046
> EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com
> 
> 
> 
>>-----Original Message-----
>>From: Paul Ramsey [mailto:pramsey@refractions.net]
>>Sent: Wednesday, February 12, 2003 9:25 AM
>>To: GEOS Development List
>>Subject: [geos-devel] Include Refactoring
>>
>>
>>
>>For the API headers, it would probably be wise to do a mass 
>>renaming, so 
>>that all the headers which get installed have a geos_ prefix. 
>>That way 
>>we can lower our odds of name collision on systems we install on. 
>>(Martin, insert comment about beauty of Java packaging here. :)
>>
>>I was just looking at what is required to do an alpha release of geos 
>>(to go alongside a pre-release of geos-enabled postgis) and having 
>>nicely named includes would be good.
>>
>>Thoughts?
>>
>>P.
>>
>>-- 
>>       __
>>      /
>>      | Paul Ramsey
>>      | Refractions Research
>>      | Email: pramsey@refractions.net
>>      | Phone: (250) 885-0632
>>      \_
>>
>>
>>_______________________________________________
>>geos-devel mailing list
>>geos-devel@geos.refractions.net
>>http://geos.refractions.net/mailman/listinfo/geos-devel
>>
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From nhv at cape.com  Wed Feb 12 12:52:42 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <3E4A8656.8010807@refractions.net>
Message-ID: <EKEJIKAILPONGGENMBGAMEDECIAA.nhv@cape.com>

Paul Ramsey writes:
> 
> The headers needed by external programs in order to call geos objects 
> and know what functions are inside the library. The headers which a 
> 'make install' would place in the system include directory for use by 
> other software.  Right now, 'make install' on geos installs the 
> following in /usr/local/include:

Instead of prepending 'geos_',  I suggest installing the headers
into a 'geos' subdirectory

ie normally install into /usr/local/include/geos 
or /usr/local/include/libgeos

Cheers

Norman

From fvilla at zoo.uvm.edu  Wed Feb 12 13:42:56 2003
From: fvilla at zoo.uvm.edu (Ferdinando Villa)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <3E4A836B.4000708@refractions.net>
References: <3E4A836B.4000708@refractions.net>
Message-ID: <1045075375.1698.1.camel@basil>

I'll just add my usual plea for a geos namespace here - looks like the
right place to do it!

ciao f

On Wed, 2003-02-12 at 12:24, Paul Ramsey wrote:
> For the API headers, it would probably be wise to do a mass renaming, so 
> that all the headers which get installed have a geos_ prefix. That way 
> we can lower our odds of name collision on systems we install on. 
> (Martin, insert comment about beauty of Java packaging here. :)
> 
> I was just looking at what is required to do an alpha release of geos 
> (to go alongside a pre-release of geos-enabled postgis) and having 
> nicely named includes would be good.
> 
> Thoughts?
> 
> P.
-- 
ferdinando villa, ph.d.                    associate professor
gund institute for ecological economics, university of vermont
590 main street, burlington, vt 05405    phone: (802) 656-2972


From mbdavis at VividSolutions.com  Wed Feb 12 13:57:57 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD92B@venus.VividSolutions.com>

I agree with Norman - it seems much cleaner to put all the include files into a geos subdirectory.

Actually, I'm surprised that this concept of installing include files into a single common directory even exists.  Surely the directory gets ridiculouly massive, and there's huge risk of name collisions?  Why wouldn't all the src files for GEOS go into single geos subdirectory (e.g. the way it's organized on the CVS?)

The current way just seems like a Unix version of "DLL hell"....

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Norman Vine [mailto:nhv@cape.com]
> Sent: Wednesday, February 12, 2003 9:53 AM
> To: GEOS Development List
> Subject: RE: [geos-devel] Include Refactoring
> 
> 
> Paul Ramsey writes:
> > 
> > The headers needed by external programs in order to call 
> geos objects 
> > and know what functions are inside the library. The headers which a 
> > 'make install' would place in the system include directory 
> for use by 
> > other software.  Right now, 'make install' on geos installs the 
> > following in /usr/local/include:
> 
> Instead of prepending 'geos_',  I suggest installing the headers
> into a 'geos' subdirectory
> 
> ie normally install into /usr/local/include/geos 
> or /usr/local/include/libgeos
> 
> Cheers
> 
> Norman
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 

From mbdavis at VividSolutions.com  Wed Feb 12 13:58:54 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD92C@venus.VividSolutions.com>

Good point, Fernandino - we'll look into doing this.  I'm no expert on namespaces, but surely it can't be too hard?  Oh - I forgot - this is C++...  8^)

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Ferdinando Villa [mailto:fvilla@zoo.uvm.edu]
> Sent: Wednesday, February 12, 2003 10:43 AM
> To: GEOS Development List
> Subject: Re: [geos-devel] Include Refactoring
> 
> 
> I'll just add my usual plea for a geos namespace here - looks like the
> right place to do it!
> 
> ciao f
> 
> On Wed, 2003-02-12 at 12:24, Paul Ramsey wrote:
> > For the API headers, it would probably be wise to do a mass 
> renaming, so 
> > that all the headers which get installed have a geos_ 
> prefix. That way 
> > we can lower our odds of name collision on systems we install on. 
> > (Martin, insert comment about beauty of Java packaging here. :)
> > 
> > I was just looking at what is required to do an alpha 
> release of geos 
> > (to go alongside a pre-release of geos-enabled postgis) and having 
> > nicely named includes would be good.
> > 
> > Thoughts?
> > 
> > P.
> -- 
> ferdinando villa, ph.d.                    associate professor
> gund institute for ecological economics, university of vermont
> 590 main street, burlington, vt 05405    phone: (802) 656-2972
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 

From fvilla at zoo.uvm.edu  Wed Feb 12 14:05:06 2003
From: fvilla at zoo.uvm.edu (Ferdinando Villa)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <5A94289A9268514C8D6C0F1FF44BA0270FD92C@venus.VividSolutions.com>
References: 
	 <5A94289A9268514C8D6C0F1FF44BA0270FD92C@venus.VividSolutions.com>
Message-ID: <1045076706.1698.9.camel@basil>

what about 

namespace geos {
....
}
in all the headers, and

using namespace geos;
 
in all the implementation files just after the #include's?  Almost as
easy as specifying a 100kb Java classpath :)

ciao f

On Wed, 2003-02-12 at 13:58, Martin Davis wrote:
> Good point, Fernandino - we'll look into doing this.  I'm no expert on namespaces, but surely it can't be too hard?  Oh - I forgot - this is C++...  8^)
> 
> Martin Davis, Senior Technical Specialist
> Vivid Solutions Inc.
> Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
> Phone: (250) 385 6040    Fax: (250) 385 6046
> EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com
> 
> 
> > -----Original Message-----
> > From: Ferdinando Villa [mailto:fvilla@zoo.uvm.edu]
> > Sent: Wednesday, February 12, 2003 10:43 AM
> > To: GEOS Development List
> > Subject: Re: [geos-devel] Include Refactoring
> > 
> > 
> > I'll just add my usual plea for a geos namespace here - looks like the
> > right place to do it!
> > 
> > ciao f
> > 
> > On Wed, 2003-02-12 at 12:24, Paul Ramsey wrote:
> > > For the API headers, it would probably be wise to do a mass 
> > renaming, so 
> > > that all the headers which get installed have a geos_ 
> > prefix. That way 
> > > we can lower our odds of name collision on systems we install on. 
> > > (Martin, insert comment about beauty of Java packaging here. :)
> > > 
> > > I was just looking at what is required to do an alpha 
> > release of geos 
> > > (to go alongside a pre-release of geos-enabled postgis) and having 
> > > nicely named includes would be good.
> > > 
> > > Thoughts?
> > > 
> > > P.
> > -- 
> > ferdinando villa, ph.d.                    associate professor
> > gund institute for ecological economics, university of vermont
> > 590 main street, burlington, vt 05405    phone: (802) 656-2972
> > 
> > 
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@geos.refractions.net
> > http://geos.refractions.net/mailman/listinfo/geos-devel
> > 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
-- 
ferdinando villa, ph.d.                    associate professor
gund institute for ecological economics, university of vermont
590 main street, burlington, vt 05405    phone: (802) 656-2972


From mbdavis at VividSolutions.com  Wed Feb 12 14:07:30 2003
From: mbdavis at VividSolutions.com (Martin Davis)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
Message-ID: <5A94289A9268514C8D6C0F1FF44BA0270FD92D@venus.VividSolutions.com>

great, thanks for the tutorial.  Seems easy enough...

Martin Davis, Senior Technical Specialist
Vivid Solutions Inc.
Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
Phone: (250) 385 6040    Fax: (250) 385 6046
EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com


> -----Original Message-----
> From: Ferdinando Villa [mailto:fvilla@zoo.uvm.edu]
> Sent: Wednesday, February 12, 2003 11:05 AM
> To: GEOS Development List
> Subject: RE: [geos-devel] Include Refactoring
> 
> 
> what about 
> 
> namespace geos {
> ....
> }
> in all the headers, and
> 
> using namespace geos;
>  
> in all the implementation files just after the #include's?  Almost as
> easy as specifying a 100kb Java classpath :)
> 
> ciao f
> 
> On Wed, 2003-02-12 at 13:58, Martin Davis wrote:
> > Good point, Fernandino - we'll look into doing this.  I'm 
> no expert on namespaces, but surely it can't be too hard?  Oh 
> - I forgot - this is C++...  8^)
> > 
> > Martin Davis, Senior Technical Specialist
> > Vivid Solutions Inc.
> > Suite #1A-2328 Government Street   Victoria, B.C.   V8T 5G5
> > Phone: (250) 385 6040    Fax: (250) 385 6046
> > EMail: mbdavis@vividsolutions.com  Web: www.vividsolutions.com
> > 
> > 
> > > -----Original Message-----
> > > From: Ferdinando Villa [mailto:fvilla@zoo.uvm.edu]
> > > Sent: Wednesday, February 12, 2003 10:43 AM
> > > To: GEOS Development List
> > > Subject: Re: [geos-devel] Include Refactoring
> > > 
> > > 
> > > I'll just add my usual plea for a geos namespace here - 
> looks like the
> > > right place to do it!
> > > 
> > > ciao f
> > > 
> > > On Wed, 2003-02-12 at 12:24, Paul Ramsey wrote:
> > > > For the API headers, it would probably be wise to do a mass 
> > > renaming, so 
> > > > that all the headers which get installed have a geos_ 
> > > prefix. That way 
> > > > we can lower our odds of name collision on systems we 
> install on. 
> > > > (Martin, insert comment about beauty of Java packaging here. :)
> > > > 
> > > > I was just looking at what is required to do an alpha 
> > > release of geos 
> > > > (to go alongside a pre-release of geos-enabled postgis) 
> and having 
> > > > nicely named includes would be good.
> > > > 
> > > > Thoughts?
> > > > 
> > > > P.
> > > -- 
> > > ferdinando villa, ph.d.                    associate professor
> > > gund institute for ecological economics, university of vermont
> > > 590 main street, burlington, vt 05405    phone: (802) 656-2972
> > > 
> > > 
> > > _______________________________________________
> > > geos-devel mailing list
> > > geos-devel@geos.refractions.net
> > > http://geos.refractions.net/mailman/listinfo/geos-devel
> > > 
> > 
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@geos.refractions.net
> > http://geos.refractions.net/mailman/listinfo/geos-devel
> -- 
> ferdinando villa, ph.d.                    associate professor
> gund institute for ecological economics, university of vermont
> 590 main street, burlington, vt 05405    phone: (802) 656-2972
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel
> 

From pramsey at refractions.net  Wed Feb 12 14:09:51 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <5A94289A9268514C8D6C0F1FF44BA0270FD92B@venus.VividSolutions.com>
References: <5A94289A9268514C8D6C0F1FF44BA0270FD92B@venus.VividSolutions.com>
Message-ID: <3E4A9BFF.8020909@refractions.net>

Martin Davis wrote:
> I agree with Norman - it seems much cleaner to put all the include
> files into a geos subdirectory.
> 
> Actually, I'm surprised that this concept of installing include files
> into a single common directory even exists.  Surely the directory
> gets ridiculouly massive, and there's huge risk of name collisions?
> Why wouldn't all the src files for GEOS go into single geos
> subdirectory (e.g. the way it's organized on the CVS?)

I cannot give you the "why", I can just tell you "how it is" here in 
UNIX sysadmin land. Sure, include directories (and lib directories) get 
pretty massive and fuddling, which is why package management has become 
all the rage.

> The current way just seems like a Unix version of "DLL hell"....

It's more of a DLL purgatory, since most linking library version 
problems can be solved with a recompilation. Not an option outside of 
the open source world.


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From nhv at cape.com  Wed Feb 12 14:12:39 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Include Refactoring
In-Reply-To: <1045075375.1698.1.camel@basil>
Message-ID: <EKEJIKAILPONGGENMBGAKEDICIAA.nhv@cape.com>

Ferdinando Villa writes:
> 
> I'll just add my usual plea for a geos namespace here - looks like the
> right place to do it!

I'll second this

Norman

From me at yury.ca  Mon Feb 17 10:48:07 2003
From: me at yury.ca (Yury A. Bychkov)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Status
Message-ID: <002201c2d69b$fd268430$b9354d18@yury>

After seeing some of the warnings that Linux compilation has produced me and
Martin (during our phone meeting on Friday) have decided that while Martin
reviews the API, I would change some of the code (mainly things that I did in
the beginning of the porting process) from using instances to pointers. I've
been putting off that task for a while, but it should fix some problems and
improve the code a bit.

Done so far: geom package.
To do: Finish cleaning up the code. Bring the GEOS up to date with the latest
JTS version (1.3), add namespace and continue the porting (with isValid).

Yury

From pramsey at refractions.net  Mon Feb 17 11:41:07 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Status
In-Reply-To: <002201c2d69b$fd268430$b9354d18@yury>
References: <002201c2d69b$fd268430$b9354d18@yury>
Message-ID: <3E5110A3.7020300@refractions.net>

Thanks for the update Yury! Keep them coming... sounds like a good plan 
of work. Be sure to advise the list when you think you've got a 
compilable version checked in for some GNU testing.

P.

Yury A. Bychkov wrote:
> After seeing some of the warnings that Linux compilation has produced me and
> Martin (during our phone meeting on Friday) have decided that while Martin
> reviews the API, I would change some of the code (mainly things that I did in
> the beginning of the porting process) from using instances to pointers. I've
> been putting off that task for a while, but it should fix some problems and
> improve the code a bit.
> 
> Done so far: geom package.
> To do: Finish cleaning up the code. Bring the GEOS up to date with the latest
> JTS version (1.3), add namespace and continue the porting (with isValid).
> 
> Yury

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From nhv at cape.com  Mon Feb 17 12:34:37 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Judicous Inlining
In-Reply-To: <EKEJIKAILPONGGENMBGAEEBGCIAA.nhv@cape.com>
Message-ID: <EKEJIKAILPONGGENMBGACEPHCIAA.nhv@cape.com>

Hi All

After looking at the code some more
I think we want a few inline methods

class CoordinateList {
public:
    Coordinate& rawGetAt(int pos){
        return (*vect)[pos];
    }
}

and a

class PointCoordinateList : public CoordinateList {
public:
    Coordinate& rawGetAt(int pos){
        point_3d pt;
        pt=(*vect)[pos];
        return *(new Coordinate(pt.x,pt.y,pt.z));
    }
}

for those cases where we *know* we are making an 'inbounds' getAt() call.
AFAICT this is the *majority* of the cases.

FWIW
With this and inlining most of the Coordinate class
TestSweepLineSpeed execution time drops from

n Pts: 1024000  Executed in  26518 ms.
  to
n Pts: 1024000  Executed in  21210 ms.
 a 20% improvement

and coupled with CFLAGS=-O3 -fomit-frame-pointer
 18500ms or a 30% improvement

Cheers

Norman


class Coordinate {
public:
    static Coordinate getNull() {
        return
Coordinate(DoubleNotANumber,DoubleNotANumber,DoubleNotANumber);
    }

    Coordinate() {
        x=0.0;
        y=0.0;
        z=DoubleNotANumber;
    }

    Coordinate(double xNew, double yNew, double zNew) {
        x=xNew;
        y=yNew;
        z=zNew;
    }

    Coordinate(const Coordinate &c){
        x=c.x;
        y=c.y;
        z=c.z;
    }

    Coordinate(double xNew, double yNew){
        x=xNew;
        y=yNew;
        z=DoubleNotANumber;
    }
    void setNull() {
        x=DoubleNotANumber;
        y=DoubleNotANumber;
        z=DoubleNotANumber;
    }

    void setCoordinate(Coordinate other) {
        x = other.x;
        y = other.y;
        z = other.z;
    }

    bool equals2D(Coordinate other) {
        return (x == other.x && y == other.y);
    }

    int compareTo(Coordinate other);
    bool equals3D(Coordinate other);
    string toString();
    void makePrecise();

    double distance(Coordinate p) {
        double dx = x - p.x;
        double dy = y - p.y;
        return sqrt(dx * dx + dy * dy);
    }

    double x;	/// x-coordinate
    double y;	/// y-coordinate
    double z;	/// z-coordinate
};


From pramsey at refractions.net  Mon Feb 17 13:32:08 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Crunch
Message-ID: <3E512AA8.1050404@refractions.net>

Compile under GNU craps out early in GeometryFactory::buildGeometry

GeometryFactory.cpp:102: name lookup of `i' changed for new ISO `for'
scoping
GeometryFactory.cpp:86:   using obsolete binding at `i'
make[2]: *** [GeometryFactory.lo] Error 1

-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


From nhv at cape.com  Mon Feb 17 14:13:45 2003
From: nhv at cape.com (Norman Vine)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] Crunch
In-Reply-To: <3E512AA8.1050404@refractions.net>
Message-ID: <EKEJIKAILPONGGENMBGAAEPPCIAA.nhv@cape.com>

Paul Ramsey
> 
> Compile under GNU craps out early in GeometryFactory::buildGeometry
> 
> GeometryFactory.cpp:102: name lookup of `i' changed for new ISO `for'
> scoping
> GeometryFactory.cpp:86:   using obsolete binding at `i'
> make[2]: *** [GeometryFactory.lo] Error 1

Need to move 'i' out of the loop

Geometry* GeometryFactory::buildGeometry(vector<Geometry *> *geoms) {
	string geomClass("NULL");
	bool isHeterogeneous=false;
	bool isCollection=geoms->size()>1;

            unsigned int i;
	for (i=0; i<geoms->size(); i++) {
........

Norman

From me at yury.ca  Mon Feb 24 04:44:06 2003
From: me at yury.ca (Yury A. Bychkov)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] GEOS Status (Sunday, Feb. 24)
Message-ID: <005e01c2dbe9$47fef7b0$b9354d18@yury>

Current status: Operation and io packages (and a big part of algorithm) has been
cleaned up.

Results of Friday (Feb. 21) phone meeting: Discussed some details of code
cleanup. Decided that some classes (e.g. IntersectionMatrix) should be left as
instances (instead of pointers).

To do: Finish cleaning up the code (should be finished by the end of this week).
Bring the GEOS up to date with the latest JTS version (1.3), add namespace and
continue the porting (with isValid).

Yury


From pramsey at refractions.net  Mon Feb 24 11:24:26 2003
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Nov  2 20:52:06 2007
Subject: [geos-devel] GEOS Status (Sunday, Feb. 24)
In-Reply-To: <005e01c2dbe9$47fef7b0$b9354d18@yury>
References: <005e01c2dbe9$47fef7b0$b9354d18@yury>
Message-ID: <3E5A473A.7040603@refractions.net>

Yury,
Could we have a couple example programs using the new coordinatelist 
interfaces? Something which demonstrates the new API in action.
Thanks,
Paul

Yury A. Bychkov wrote:
> Current status: Operation and io packages (and a big part of algorithm) has been
> cleaned up.
> 
> Results of Friday (Feb. 21) phone meeting: Discussed some details of code
> cleanup. Decided that some classes (e.g. IntersectionMatrix) should be left as
> instances (instead of pointers).
> 
> To do: Finish cleaning up the code (should be finished by the end of this week).
> Bring the GEOS up to date with the latest JTS version (1.3), add namespace and
> continue the porting (with isValid).
> 
> Yury
> 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@geos.refractions.net
> http://geos.refractions.net/mailman/listinfo/geos-devel


-- 
       __
      /
      | Paul Ramsey
      | Refractions Research
      | Email: pramsey@refractions.net
      | Phone: (250) 885-0632
      \_


