From strk at keybit.net  Tue Dec  1 15:45:37 2009
From: strk at keybit.net (strk)
Date: Tue Dec  1 15:45:40 2009
Subject: [geos-devel] Another cleanup pass on 3.2.0 ongoing
Message-ID: <20091201204537.GC94542@keybit.net>

FYI,
Mateusz is doing a cleanup pass on trunk.
He mentioned it should be done in a week.
I think it's worth waiting till then and ship
an rc4. If anyone is concerned with that please
let me know. 

TIA

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From geos-trac at osgeo.org  Wed Dec  2 08:47:11 2009
From: geos-trac at osgeo.org (GEOS)
Date: Wed Dec  2 08:47:12 2009
Subject: [geos-devel] [GEOS] #303: geos 3.2.0rc3 compiling under vc 2005
 (using vc80 solution)
Message-ID: <044.7f45f9f36028da57d4a75cdc11091a42@osgeo.org>

#303: geos 3.2.0rc3 compiling under vc 2005 (using vc80 solution)
------------------------+---------------------------------------------------
 Reporter:  robe        |       Owner:  geos-devel@lists.osgeo.org
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.2.0                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 Okay this time I'm testing on my VC 2005 box.

 geos_xmltester -- completely missing from vc 2005.


 geos_capi and geos_lib give these errors -- so I guess the same issue as
 was with the vc 2008 solution files (vc90)

 {{{
 Error   1       fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\LinearComponentExtracter.cpp': No such file or
 directory c1xx
 Error   2       fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\PointExtracter.cpp': No such file or directory
 c1xx
 Error   3       fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\PolygonExtracter.cpp': No such file or
 directory c1xx
 Error   4       fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\FuzzyPointLocator.cpp': No such file or
 directory        c1xx
 Error   5       fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\OffsetPointGenerator.cpp': No such file
 or directory     c1xx
 Error   6       fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\OverlayResultValidator.cpp': No such
 file or directory   c1xx
 Error   7       fatal error C1083: Cannot open source file:
 '..\..\..\source\precision\GeometrySnapper.cpp': No such file or directory
 c1xx
 Error   8       fatal error C1083: Cannot open source file:
 '..\..\..\source\precision\LineStringSnapper.cpp': No such file or
 directory        c1xx
 Error   9       fatal error C1083: Cannot open source file:
 '..\..\..\source\util\AssertionFailedException.cpp': No such file or
 directory      c1xx
 Error   10      fatal error C1083: Cannot open source file:
 '..\..\..\source\util\IllegalArgumentException.cpp': No such file or
 directory      c1xx
 Error   11      fatal error C1083: Cannot open source file:
 '..\..\..\source\util\UnsupportedOperationException.cpp': No such file or
 directory c1xx

 }}}


 Also get these errors -- from geos_unit project
 {{{
 Error   55      fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\LinearComponentExtracter.cpp': No such file or
 directory c1xx
 Error   56      fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\PointExtracter.cpp': No such file or directory
 c1xx
 Error   57      fatal error C1083: Cannot open source file:
 '..\..\..\source\geom\util\PolygonExtracter.cpp': No such file or
 directory c1xx
 Error   261     fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\FuzzyPointLocator.cpp': No such file or
 directory        c1xx
 Error   262     fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\OffsetPointGenerator.cpp': No such file
 or directory     c1xx
 Error   263     fatal error C1083: Cannot open source file:
 '..\..\..\source\operation\overlay\OverlayResultValidator.cpp': No such
 file or directory   c1xx
 Error   313     fatal error C1083: Cannot open source file:
 '..\..\..\source\precision\GeometrySnapper.cpp': No such file or directory
 c1xx
 Error   314     fatal error C1083: Cannot open source file:
 '..\..\..\source\precision\LineStringSnapper.cpp': No such file or
 directory        c1xx
 Error   316     fatal error C1083: Cannot open source file:
 '..\..\..\source\util\AssertionFailedException.cpp': No such file or
 directory      c1xx
 Error   317     fatal error C1083: Cannot open source file:
 '..\..\..\source\util\IllegalArgumentException.cpp': No such file or
 directory      c1xx
 Error   318     fatal error C1083: Cannot open source file:
 '..\..\..\source\util\UnsupportedOperationException.cpp': No such file or
 directory c1xx
 Error   348     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\coordinatearraysequencefactorytest.cpp
 5
 Error   349     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\coordinatearraysequencetest.cpp
 5
 Error   350     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\coordinatelisttest.cpp
 6
 Error   351     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\coordinatetest.cpp 5
 Error   352     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\dimensiontest.cpp  6
 Error   353     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\envelopetest.cpp   6
 Error   354     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\geometryfactorytest.cpp
 6
 Error   355     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\intersectionmatrixtest.cpp
 5
 Error   356     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\linearringtest.cpp 6
 Error   357     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\linesegmenttest.cpp
 5
 Error   358     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\linestringtest.cpp 6
 Error   359     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\locationtest.cpp   6
 Error   360     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\multilinestringtest.cpp
 5
 Error   361     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\multipointtest.cpp 6
 Error   362     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\multipolygontest.cpp
 5
 Error   363     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\pointtest.cpp      5
 Error   364     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\polygontest.cpp    5
 Error   365     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\triangletest.cpp   6
 Error   366     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\geometry\coverstest.cpp
 6
 Error   367     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\geometry\isrectangletest.cpp
 6
 Error   368     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geom\prep\preparedgeometryfactorytest.cpp
 6
 Error   369     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\noding\segmentnodetest.cpp
 5
 Error   370     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\noding\segmentpointcomparatortest.cpp
 5
 Error   371     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\noding\SegmentStringTest.cpp': No such file or
 directory       c1xx
 Error   372     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\io\byteordervaluestest.cpp
 6
 Error   373     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\io\wkbreadertest.cpp    10
 Error   374     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\simplify\douglaspeuckersimplifiertest.cpp
 5
 Error   375     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\simplify\topologypreservingsimplifiertest.cpp
 5
 Error   376     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\algorithm\convexhulltest.cpp
 6
 Error   377     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\algorithm\pointlocatortest.cpp
 6
 Error   378     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\algorithm\cgalgorithms\computeorientationtest.cpp
 6
 Error   379     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\algorithm\cgalgorithms\isccwtest.cpp
 7
 Error   380     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\algorithm\cgalgorithms\ispointinringtest.cpp
 6
 Error   381     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\index\quadtree\doublebitstest.cpp
 5
 Error   382     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\util\uniquecoordinatearrayfiltertest.cpp
 6
 Error   383     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\operation\issimpleoptest.cpp
 6
 Error   384     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\operation\distance\distanceoptest.cpp
 6
 Error   385     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\operation\overlay\FuzzyPointLocatorTest.cpp': No such
 file or directory        c1xx
 Error   386     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\operation\overlay\OffsetPointGeneratorTest.cpp': No
 such file or directory     c1xx
 Error   387     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\operation\overlay\OverlayResultValidatorTest.cpp': No
 such file or directory   c1xx
 Error   388     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\operation\union\cascadedpolygonuniontest.cpp
 6
 Error   389     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\precision\GeometrySnapperTest.cpp': No such file or
 directory  c1xx
 Error   391     fatal error C1083: Cannot open source file:
 '..\..\..\tests\unit\precision\LineStringSnapperTest.cpp': No such file or
 directory        c1xx
 Error   392     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\precision\simplegeometryprecisionreducertest.cpp
 6
 Error   393     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\capi\geoscoordseqtest.cpp
 5
 Error   394     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\capi\geosgeomtowkttest.cpp
 5
 Error   395     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\capi\geospolygonizer_getcutedgestest.cpp
 5
 Error   396     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\capi\geossimplifytest.cpp
 5
 Error   397     fatal error C1083: Cannot open include file: 'tut.hpp': No
 such file or directory
 c:\projects\geos\geos-3.2.0rc3vc2005\tests\unit\geos_unit.cpp   8

 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/303>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From mateusz at loskot.net  Thu Dec  3 15:37:50 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Dec  3 15:34:05 2009
Subject: [geos-devel] Re: Another cleanup pass on 3.2.0 ongoing
Message-ID: <4B18219E.4020206@loskot.net>

Hi,

The cleanup [1] is in place. Tested tens of times
using GCC 4.4.1 and Visual C++ 9.0.

[1] http://trac.osgeo.org/geos/ticket/304

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From mateusz at loskot.net  Sat Dec  5 19:59:59 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Dec  5 20:07:00 2009
Subject: [geos-devel] Tested using Visual C++ 2010 (10.0)
Message-ID: <4B1B020F.9030906@loskot.net>

Folks,

I added build/msvc10 with solution for Visual C++ compiler from
Visual Studio 2010

http://trac.osgeo.org/geos/ticket/306

I think it's worth to add it to distribution.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Sat Dec  5 20:24:36 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Dec  5 20:24:41 2009
Subject: [geos-devel] Tickets cleanup
Message-ID: <4B1B07D4.5070107@loskot.net>

Folks,

I've cleaned/fixed all outstanding tickets that were assigned to me.
I unassigned one ticket [1] because I'm unable to reproduce the problem
or perform any testing myself because I have no access to Mac OS X

[1] http://trac.osgeo.org/geos/ticket/299

I believe nothing has been broken during my works. I have successfully
tested GEOS trunk with in the following environments:

* Visual C++ 2005 (target x86-32, Windows 7 Pro)
* Visual C++ 2008 (target x86-32 on Windows Vista x86-64)
* Visual C++ 2010 Beta2 (target x86-32, Windows 7 Pro)
* GCC 4.4.1 (target x86-64, Ubuntu 9.10 x86-64)

The only builds I haven't performed was using Visual C++
and NMAKE makefiles.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From kiorky at cryptelium.net  Mon Dec  7 09:17:25 2009
From: kiorky at cryptelium.net (kiorky)
Date: Mon Dec  7 09:22:05 2009
Subject: [geos-devel] geos make check fails with cygwin-1.7
Message-ID: <4B1D0E75.9060106@cryptelium.net>

Hello, i'm trying to compile geos under cygwin(1.7) with a gcc4 (the one shipped
with cygwin1.7).

The compilation pass flawlessly, make check compilation also, but execution core
dump everytimes.

As compilation passed, and dependencies link pass also (gdal for example), i
didn't notice at first the failure.

My geos usage is throught Django (so basicly python+ctypes) and this is were i
found first there was something wrong:
Here is the relevant trace (unit tests providen by the django gis package, see [1].)
django/contrib/gis/tests/test_geos.py(29)
(Pdb) geom.wkt
*** AttributeError: function 'free' not found (4|??~")

I decided so, to execute make check in tests/units but the executable
'geos_unit.exe' core dump everytime [2]

So, i investigate some more and found that:
http://trac.osgeo.org/geos/ticket/276
So, i tried to modify the configure to recompile without -O2, but no success

Now, i have no more clues to solve the problem.


[1] -
http://code.djangoproject.com/browser/django/tags/releases/1.0.2/django/contrib/gis/tests/test_geos.py#L27

[2] -
$ gdb ./geos_unit.exe
GNU gdb 6.8.0.20080328-cvs (cygwin-special)
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-cygwin"...
(no debugging symbols found)
(gdb) run
Starting program:
/cygdrive/e/minitage2/django/cchb-win/geos-3.2.0rc3/tests/unit/geos_unit.exe
[New thread 2708.0x610]
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[New thread 2708.0xbc4]
(no debugging symbols found)
(no debugging symbols found)
[New thread 2708.0x9b0]
[New thread 2708.0x144]
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[New thread 2708.0xdd8]
[New thread 2708.0x37c]
[New thread 2708.0xfdc]
      4 [main] geos_unit 2708 _cygtls::handle_exceptions: Exception:
STATUS_ACCESS_VIOLATION
    301 [main] geos_unit 2708 open_stackdumpfile: Dumping stack trace to
geos_unit.exe.stackdump
(no debugging symbols found)

Program exited with code 0105400.
(gdb) q



makina@APEM3 /minitage/django/cchb-win/geos-3.2.0rc3/tests/unit
$ cat geos_unit.exe.stackdump
Exception: STATUS_ACCESS_VIOLATION at eip=6C4E8010
eax=61147000 ebx=00000019 ecx=6C4E8010 edx=00000000 esi=712621A4 edi=6115DFEB
ebp=0022CCE8 esp=0022CCBC
program=E:\minitage2\django\cchb-win\geos-3.2.0rc3\tests\unit\.libs\geos_unit.exe,
pid 2708, thread main
cs=001B ds=0023 es=0023 fs=003B gs=0000 ss=0023
Stack trace:
Frame     Function  Args
0022CCE8  6C4E8010  (712B0248, 00000000, 00000000, 00000000)
0022CD18  7119AA4B  (712B01E0, 7FF80000, 0022CD38, 71194287)
0022CD28  71194223  (00000001, 0000FFFF, 0022CDA8, 610203C3)
0022CD38  71194287  (00000001, 612135EC, 612135AF, 610204B0)
0022CDA8  610203C3  (00000000, 0022CDE0, 610066E0, 7FFD5000)
End of stack trace
(minitage-cchb-win)
makina@APEM3 /minitage/django/cchb-win/geos-3.2.0rc3/tests/unit
$
[ APEM3 ][
-- 
Cordialement,
KiOrKY
GPG Key FingerPrint: 0x1A1194B7681112AF

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091207/9c402d08/signature.bin
From kiorky at cryptelium.net  Mon Dec  7 09:42:32 2009
From: kiorky at cryptelium.net (kiorky)
Date: Mon Dec  7 09:43:25 2009
Subject: [geos-devel] geos make check fails with cygwin-1.7
In-Reply-To: <4B1D0E75.9060106@cryptelium.net>
References: <4B1D0E75.9060106@cryptelium.net>
Message-ID: <4B1D1458.5000502@cryptelium.net>

Uhm, when reading better the #276, here is additionnal info:

$ libtool --mode=execute gdb ./geos_unit.exe
GNU gdb 6.8.0.20080328-cvs (cygwin-special)
Copyright (C) 2008 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-cygwin"...

(gdb)
(gdb) run
Starting program:
/cygdrive/e/minitage2/django/cchb-win/geos-3.2.0rc3/tests/unit/.libs/geos_unit
[New thread 3712.0xd68]
[New thread 3712.0x7b4]
[New thread 3712.0xd90]
[New thread 3712.0xd50]
[New thread 3712.0xee0]

Program received signal SIGSEGV, Segmentation fault.
0x6c4e8010 in ?? ()
(gdb) bt
#0  0x6c4e8010 in ?? ()
#1  0x7119a9b7 in GeometryFactory (this=0x712b0248) at GeometryFactory.cpp:74
#2  0x7119aa4b in geos::geom::GeometryFactory::getDefaultInstance () at
GeometryFactory.cpp:694
#3  0x71194223 in __static_initialization_and_destruction_0 (__initialize_p=1,
__priority=65535) at Geometry.cpp:106
#4  0x71194287 in global constructors keyed to _ZN4geos4geom11geosversionEv ()
at Geometry.cpp:834
#5  0x610203c3 in per_module::run_ctors () from /usr/bin/cygwin1.dll
#6  0x01c70553 in ?? ()
#7  0x610204b0 in dll::init () from /usr/bin/cygwin1.dll
#8  0x00000000 in ?? ()
(gdb)





kiorky a ?crit :
> Hello, i'm trying to compile geos under cygwin(1.7) with a gcc4 (the one shipped
> with cygwin1.7).
> 
> The compilation pass flawlessly, make check compilation also, but execution core
> dump everytimes.
> 
> As compilation passed, and dependencies link pass also (gdal for example), i
> didn't notice at first the failure.
> 
> My geos usage is throught Django (so basicly python+ctypes) and this is were i
> found first there was something wrong:
> Here is the relevant trace (unit tests providen by the django gis package, see [1].)
> django/contrib/gis/tests/test_geos.py(29)
> (Pdb) geom.wkt
> *** AttributeError: function 'free' not found (4|??~")
> 
> I decided so, to execute make check in tests/units but the executable
> 'geos_unit.exe' core dump everytime [2]
> 
> So, i investigate some more and found that:
> http://trac.osgeo.org/geos/ticket/276
> So, i tried to modify the configure to recompile without -O2, but no success
> 
> Now, i have no more clues to solve the problem.
> 
> 
> [1] -
> http://code.djangoproject.com/browser/django/tags/releases/1.0.2/django/contrib/gis/tests/test_geos.py#L27
> 
> [2] -
> $ gdb ./geos_unit.exe
> GNU gdb 6.8.0.20080328-cvs (cygwin-special)
> Copyright (C) 2008 Free Software Foundation, Inc.
> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
> This is free software: you are free to change and redistribute it.
> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
> and "show warranty" for details.
> This GDB was configured as "i686-pc-cygwin"...
> (no debugging symbols found)
> (gdb) run
> Starting program:
> /cygdrive/e/minitage2/django/cchb-win/geos-3.2.0rc3/tests/unit/geos_unit.exe
> [New thread 2708.0x610]
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> [New thread 2708.0xbc4]
> (no debugging symbols found)
> (no debugging symbols found)
> [New thread 2708.0x9b0]
> [New thread 2708.0x144]
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> (no debugging symbols found)
> [New thread 2708.0xdd8]
> [New thread 2708.0x37c]
> [New thread 2708.0xfdc]
>       4 [main] geos_unit 2708 _cygtls::handle_exceptions: Exception:
> STATUS_ACCESS_VIOLATION
>     301 [main] geos_unit 2708 open_stackdumpfile: Dumping stack trace to
> geos_unit.exe.stackdump
> (no debugging symbols found)
> 
> Program exited with code 0105400.
> (gdb) q
> 
> 
> 
> makina@APEM3 /minitage/django/cchb-win/geos-3.2.0rc3/tests/unit
> $ cat geos_unit.exe.stackdump
> Exception: STATUS_ACCESS_VIOLATION at eip=6C4E8010
> eax=61147000 ebx=00000019 ecx=6C4E8010 edx=00000000 esi=712621A4 edi=6115DFEB
> ebp=0022CCE8 esp=0022CCBC
> program=E:\minitage2\django\cchb-win\geos-3.2.0rc3\tests\unit\.libs\geos_unit.exe,
> pid 2708, thread main
> cs=001B ds=0023 es=0023 fs=003B gs=0000 ss=0023
> Stack trace:
> Frame     Function  Args
> 0022CCE8  6C4E8010  (712B0248, 00000000, 00000000, 00000000)
> 0022CD18  7119AA4B  (712B01E0, 7FF80000, 0022CD38, 71194287)
> 0022CD28  71194223  (00000001, 0000FFFF, 0022CDA8, 610203C3)
> 0022CD38  71194287  (00000001, 612135EC, 612135AF, 610204B0)
> 0022CDA8  610203C3  (00000000, 0022CDE0, 610066E0, 7FFD5000)
> End of stack trace
> (minitage-cchb-win)
> makina@APEM3 /minitage/django/cchb-win/geos-3.2.0rc3/tests/unit
> $
> [ APEM3 ][
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

-- 
Cordialement,
KiOrKY
GPG Key FingerPrint: 0x1A1194B7681112AF

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091207/f90645f0/signature.bin
From pramsey at opengeo.org  Mon Dec  7 13:50:20 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Mon Dec  7 13:50:27 2009
Subject: [geos-devel] 2010 Code Sprint
Message-ID: <30fe546d0912071050x565a577ape9129d041c6f4261@mail.gmail.com>

Hi GEOS folks, in case you haven't heard yet, there will be a sprint
this winter, on topics including GEOS:
http://wiki.osgeo.org/wiki/New_York_Code_Sprint_2010

Hope you can join us!

Paul
From bontepaarden at gmail.com  Tue Dec  8 04:55:26 2009
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue Dec  8 04:55:28 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
Message-ID: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>

Hi List,

I'm new to this list.
I'm Paul Meems from The Netherlands.
I'm a member of the MapWindow GIS community.
We use GEOS together with GDAL in MapWindow GIS.
We're currently in the process of updating all our supporting libraries to
the latest stable ones.

Yesterday I've downloaded *2009/06/15 geos-3.1.1.tar.bz2* and try to compile
it using VS2008
I get all kinds of errors about missing files.
I managed to find some in SVN but these are still missing:
Error    104    fatal error C1083: Cannot open source file:
'..\..\..\source\geom\util\
PolygonExtracter.cpp': No such file or directory    c1xx    geos_lib
Error    105    fatal error C1083: Cannot open source file:
'..\..\..\source\geom\util\PointExtracter.cpp': No such file or directory
c1xx    geos_lib
Error    106    fatal error C1083: Cannot open source file:
'..\..\..\source\geom\util\LinearComponentExtracter.cpp': No such file or
directory    c1xx    geos_lib
Error    122    fatal error C1083: Cannot open source file:
'..\..\..\source\geom\CoordinateSequenceFactory.cpp': No such file or
directory    c1xx    geos_lib

I tried searching the net for this or on the GEOS website but I can't find a
solution.
I did read something about not mixing source files of different version of
GEOS.
So I'm puzzled how to continue.

I hope someone can help me.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091208/2bda0f50/attachment.html
From nidhiagrawal18 at gmail.com  Tue Dec  8 05:38:47 2009
From: nidhiagrawal18 at gmail.com (nidhi agrawal)
Date: Tue Dec  8 05:38:51 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
In-Reply-To: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
References: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
Message-ID: <887cb8bb0912080238n20796baal42dd88c63f9e6add@mail.gmail.com>

same problem with me.....
please if you got the solution .....then guide me also.....
thanks...
nidhi
On 12/8/09, Paul Meems <bontepaarden@gmail.com> wrote:
> Hi List,
>
> I'm new to this list.
> I'm Paul Meems from The Netherlands.
> I'm a member of the MapWindow GIS community.
> We use GEOS together with GDAL in MapWindow GIS.
> We're currently in the process of updating all our supporting libraries to
> the latest stable ones.
>
> Yesterday I've downloaded *2009/06/15 geos-3.1.1.tar.bz2* and try to compile
> it using VS2008
> I get all kinds of errors about missing files.
> I managed to find some in SVN but these are still missing:
> Error    104    fatal error C1083: Cannot open source file:
> '..\..\..\source\geom\util\
> PolygonExtracter.cpp': No such file or directory    c1xx    geos_lib
> Error    105    fatal error C1083: Cannot open source file:
> '..\..\..\source\geom\util\PointExtracter.cpp': No such file or directory
> c1xx    geos_lib
> Error    106    fatal error C1083: Cannot open source file:
> '..\..\..\source\geom\util\LinearComponentExtracter.cpp': No such file or
> directory    c1xx    geos_lib
> Error    122    fatal error C1083: Cannot open source file:
> '..\..\..\source\geom\CoordinateSequenceFactory.cpp': No such file or
> directory    c1xx    geos_lib
>
> I tried searching the net for this or on the GEOS website but I can't find a
> solution.
> I did read something about not mixing source files of different version of
> GEOS.
> So I'm puzzled how to continue.
>
> I hope someone can help me.
>
> Thanks,
>
> Paul
>
From robe.dnd at cityofboston.gov  Tue Dec  8 08:50:25 2009
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Tue Dec  8 08:50:34 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
In-Reply-To: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
References: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
Message-ID: <BD3A1BBF51D14C47B26207A0766994822807870A65@XCCMS2.cityhall.boston.cob>

Paul,

Geos 3.1.1 had missing files for VS.  I believe if you pull from SVN you get all the missing files.

On another note.  GEOS 3.2 is coming out really soon -- its up to RC3 and Mateusz has been working really hard to make sure all the pieces are packaged in there to compile from the tar ball without having to go to SVN.  I encourage you to give GEOS 3.2 a try.  I've found it to be a much stabler product than the 3.1 series in many ways (like dealing with topological exceptions not to mention improved speed)

Hope that helps,
Regina

________________________________
From: geos-devel-bounces@lists.osgeo.org [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Meems
Sent: Tuesday, December 08, 2009 4:55 AM
To: geos-devel@lists.osgeo.org
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2

Hi List,

I'm new to this list.
I'm Paul Meems from The Netherlands.
I'm a member of the MapWindow GIS community.
We use GEOS together with GDAL in MapWindow GIS.
We're currently in the process of updating all our supporting libraries to the latest stable ones.

Yesterday I've downloaded 2009/06/15 geos-3.1.1.tar.bz2 and try to compile it using VS2008
I get all kinds of errors about missing files.
I managed to find some in SVN but these are still missing:
Error    104    fatal error C1083: Cannot open source file: '..\..\..\source\geom\util\
PolygonExtracter.cpp': No such file or directory    c1xx    geos_lib
Error    105    fatal error C1083: Cannot open source file: '..\..\..\source\geom\util\PointExtracter.cpp': No such file or directory    c1xx    geos_lib
Error    106    fatal error C1083: Cannot open source file: '..\..\..\source\geom\util\LinearComponentExtracter.cpp': No such file or directory    c1xx    geos_lib
Error    122    fatal error C1083: Cannot open source file: '..\..\..\source\geom\CoordinateSequenceFactory.cpp': No such file or directory    c1xx    geos_lib

I tried searching the net for this or on the GEOS website but I can't find a solution.
I did read something about not mixing source files of different version of GEOS.
So I'm puzzled how to continue.

I hope someone can help me.

Thanks,

Paul



-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091208/6183f272/attachment.html
From pramsey at opengeo.org  Tue Dec  8 11:01:25 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Tue Dec  8 11:02:31 2009
Subject: [geos-devel] 3.2 RC4?
Message-ID: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>

Thanks to Mats for taking the cleanup run through the code! I would
like to cut one more RC, anyone have objections, fixes-in-progress?

P
From strk at keybit.net  Tue Dec  8 13:04:26 2009
From: strk at keybit.net (strk)
Date: Tue Dec  8 13:04:31 2009
Subject: [geos-devel] 3.2 RC4?
In-Reply-To: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>
References: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>
Message-ID: <20091208180426.GC33329@keybit.net>

On Tue, Dec 08, 2009 at 08:01:25AM -0800, Paul Ramsey wrote:
> Thanks to Mats for taking the cleanup run through the code! I would
> like to cut one more RC, anyone have objections, fixes-in-progress?

Just closed a couple ([1], [2]) of fresh tickets and am
now ready for rc4.

[1] http://trac.osgeo.org/geos/ticket/305
[2] http://trac.osgeo.org/geos/ticket/307

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From strk at keybit.net  Tue Dec  8 13:06:37 2009
From: strk at keybit.net (strk)
Date: Tue Dec  8 13:06:40 2009
Subject: [geos-devel] 3.2 RC4?
In-Reply-To: <20091208180426.GC33329@keybit.net>
References: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>
	<20091208180426.GC33329@keybit.net>
Message-ID: <20091208180637.GD33329@keybit.net>

On Tue, Dec 08, 2009 at 07:04:26PM +0100, strk wrote:
> On Tue, Dec 08, 2009 at 08:01:25AM -0800, Paul Ramsey wrote:
> > Thanks to Mats for taking the cleanup run through the code! I would
> > like to cut one more RC, anyone have objections, fixes-in-progress?
> 
> Just closed a couple ([1], [2]) of fresh tickets and am
> now ready for rc4.

Actually, distcheck is failing:
make[2]: *** No rule to make target `geos.vsprops', needed by `distdir'.  Stop.

Mat ?


--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From mateusz at loskot.net  Tue Dec  8 14:32:51 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Dec  8 14:32:57 2009
Subject: [geos-devel] 3.2 RC4?
In-Reply-To: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>
References: <30fe546d0912080801g2da2221cm9b553ff1ca3fd6dd@mail.gmail.com>
Message-ID: <4B1EA9E3.9020902@loskot.net>

Paul Ramsey wrote:
> Thanks to Mats for taking the cleanup run through the code! I would
> like to cut one more RC, anyone have objections, fixes-in-progress?

No pending big commits from me, so ready for RC.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Tue Dec  8 14:39:40 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Dec  8 14:39:45 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
In-Reply-To: <BD3A1BBF51D14C47B26207A0766994822807870A65@XCCMS2.cityhall.boston.cob>
References: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
	<BD3A1BBF51D14C47B26207A0766994822807870A65@XCCMS2.cityhall.boston.cob>
Message-ID: <4B1EAB7C.7030306@loskot.net>

Obe, Regina wrote:
> Paul,
> 
> Geos 3.1.1 had missing files for VS.  I believe if you pull from SVN 
> you get all the missing files.

Yes, it should be fixed in the trunk:

http://trac.osgeo.org/geos/ticket/303

So, we have 3 solutions [1] in the trunk available for Visual C++ 2005,
2008 and 2010. In future, I believe it would be reasonable to move
completely to CMake, so we no longer need to manually maintain
Visual C++ projects manually.

[1] http://trac.osgeo.org/geos/browser/trunk/build/README?rev=2800

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From pramsey at opengeo.org  Tue Dec  8 17:12:38 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Tue Dec  8 17:12:42 2009
Subject: [geos-devel] 3.1 vs 3.2
Message-ID: <CDA089E3-73DD-4EFD-9EF6-AC259C824C54@opengeo.org>

Not sure what this means, but:

---- 3.1 ----

Heron-2:xmltester pramsey$ time make check
make  check-TESTS
Area of difference between obtained and expected: 0 - Tolerated diff: 0.449 (SUCCESS!)
Area of difference between obtained and expected: 0 - Tolerated diff: 0.605 (SUCCESS!)
bufferOriginalPrecision failed (TopologyException: depth mismatch at  378588 5.68601e+06), trying with reduced precision
recomputing with precision scale factor = 1e+08
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+08
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+08
recomputing with precision scale factor = 1e+07
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+07
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+07
Area of difference between obtained and expected: 4.98287e-05 - Tolerated diff: 495.66 (SUCCESS!)
Area of difference between obtained and expected: 0 - Tolerated diff: 6.68967 (SUCCESS!)
Area of difference between obtained and expected: 8.18545e-12 - Tolerated diff: 3.14191 (SUCCESS!)
Area of difference between obtained and expected: 0 - Tolerated diff: 703.749 (SUCCESS!)
Area of difference between obtained and expected: 0 - Tolerated diff: 17645.6 (SUCCESS!)
Area of difference between obtained and expected: 0 - Tolerated diff: 15299.8 (SUCCESS!)
Files: 20
Tests: 2216
Failed: 0
Succeeded: 2216
PASS: testrunner
=============
1 test passed
=============

real	0m29.194s
user	0m24.750s
sys	0m1.489s
Heron-2:xmltester pramsey$ 


---- 3.2 ----

Heron-2:xmltester pramsey$ time make check
make  check-TESTS
bufferOriginalPrecision failed (TopologyException: assigned depths do not match 1.33558e+06 631781), trying with reduced precision
recomputing with precision scale factor = 1e+10
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+10
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+10
recomputing with precision scale factor = 1e+09
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+09
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+09
bufferOriginalPrecision failed (TopologyException: assigned depths do not match 1.33559e+06 631780), trying with reduced precision
recomputing with precision scale factor = 1e+10
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+10
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+10
recomputing with precision scale factor = 1e+09
Scaler: offsetX,Y: 0,0 scaleFactor: 1e+09
ReScaler: offsetX,Y: 0,0 scaleFactor: 1e+09
Files: 58
Tests: 3582
Failed: 0
Succeeded: 3582
PASS: testrunner
==================
All 1 tests passed
==================

real	0m11.558s
user	0m10.630s
sys	0m0.230s
Heron-2:xmltester pramsey$ 

From pramsey at opengeo.org  Tue Dec  8 18:04:19 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Tue Dec  8 18:04:22 2009
Subject: [geos-devel] GEOS 3.2.0rc4
Message-ID: <30fe546d0912081504o4530e941q9998acb84d5bb1cd@mail.gmail.com>

Is available for download and testing:

http://download.osgeo.org/geos/geos-3.2.0rc4.tar.bz2

P
From strk at keybit.net  Wed Dec  9 03:59:04 2009
From: strk at keybit.net (strk)
Date: Wed Dec  9 03:59:22 2009
Subject: [geos-devel] 3.1 vs 3.2
In-Reply-To: <CDA089E3-73DD-4EFD-9EF6-AC259C824C54@opengeo.org>
References: <CDA089E3-73DD-4EFD-9EF6-AC259C824C54@opengeo.org>
Message-ID: <20091209085904.GE33329@keybit.net>

On Tue, Dec 08, 2009 at 02:12:38PM -0800, Paul Ramsey wrote:
> Not sure what this means, but:

> ---- 3.1 ----               > ---- 3.2 ----
>                             >
> Files: 20                   > Files: 58
> Tests: 2216                 > Tests: 3582
> Failed: 0                   > Failed: 0
> Succeeded: 2216             > Succeeded: 3582
> PASS: testrunner            > PASS: testrunner
>                             >
> real  0m29.194s             > real  0m11.558s
> user  0m24.750s             > user  0m10.630s
> sys   0m1.489s              > sys   0m0.230s

Much more tests in less of half the time !
It seems to mean 3.2.0 rocks :)

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From maxime at altribe.org  Wed Dec  9 11:13:15 2009
From: maxime at altribe.org (Maxime van Noppen)
Date: Wed Dec  9 11:18:26 2009
Subject: [geos-devel] Benchmark between various geometry libraries
In-Reply-To: <4B0B9E21.201@altribe.org>
References: <4B042704.1080807@refractions.net>	<4B042C53.2050509@altribe.org>	<4B04315D.7090506@refractions.net>	<4B043239.5000009@refractions.net>	<4b043b0f.0e1abc0a.228c.14cf@mx.google.com>	<4B0444B5.7020606@refractions.net>	<20091119155138.GB22298@keybit.net>	<4B056F75.4020701@altribe.org>	<20091119213207.GD22298@keybit.net>	<4B06D51D.7060103@altribe.org>
	<20091123180944.GY22298@keybit.net> <4B0B9E21.201@altribe.org>
Message-ID: <4B1FCC9B.1090707@altribe.org>

Maxime van Noppen wrote:
> I will post any numbers I get.

I'm still far from having a solid and complete report but just to give
you a taste : on 100 intersections dynamic allocations represent 25.01%
of the time cost (17.14% spent allocating, 7.87% deallocating).

I've also found several small optimizations that can lead to significant
performance boosts. For example, on the 100 intersection benchmark I
found that 10% of the time was spent in CoordinateArraySequence::getAt.
The fact is that as the code is in the .cpp file it cannot be inlined by
the compiler. So I juste moved the one-line code of the .cpp file to the
.h file and the runtime cost dropped drastically (to ~ 2%).

I'll try to make a clean report with simple test cases spotting the
bottlenecks and try to provide some patches to fix. Don't expect it
before early 2010 though.

-- 
Maxime
From strk at keybit.net  Wed Dec  9 11:24:10 2009
From: strk at keybit.net (strk)
Date: Wed Dec  9 11:24:13 2009
Subject: [geos-devel] Benchmark between various geometry libraries
In-Reply-To: <4B1FCC9B.1090707@altribe.org>
References: <4B043239.5000009@refractions.net>
	<4b043b0f.0e1abc0a.228c.14cf@mx.google.com>
	<4B0444B5.7020606@refractions.net>
	<20091119155138.GB22298@keybit.net> <4B056F75.4020701@altribe.org>
	<20091119213207.GD22298@keybit.net> <4B06D51D.7060103@altribe.org>
	<20091123180944.GY22298@keybit.net> <4B0B9E21.201@altribe.org>
	<4B1FCC9B.1090707@altribe.org>
Message-ID: <20091209162410.GA64809@keybit.net>

On Wed, Dec 09, 2009 at 05:13:15PM +0100, Maxime van Noppen wrote:
> Maxime van Noppen wrote:
> > I will post any numbers I get.
> 
> I'm still far from having a solid and complete report but just to give
> you a taste : on 100 intersections dynamic allocations represent 25.01%
> of the time cost (17.14% spent allocating, 7.87% deallocating).
> 
> I've also found several small optimizations that can lead to significant
> performance boosts. For example, on the 100 intersection benchmark I
> found that 10% of the time was spent in CoordinateArraySequence::getAt.
> The fact is that as the code is in the .cpp file it cannot be inlined by
> the compiler. So I juste moved the one-line code of the .cpp file to the
> .h file and the runtime cost dropped drastically (to ~ 2%).

CoordinateArraySequence::getAt is a virtual function, which is probably
the reason why the fully templated solution is much faster instead.

How can a virtual method be inlined by the compiler ? 

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From maxime at altribe.org  Wed Dec  9 11:23:09 2009
From: maxime at altribe.org (Maxime van Noppen)
Date: Wed Dec  9 11:28:24 2009
Subject: [geos-devel] Benchmark between various geometry libraries
In-Reply-To: <20091209162410.GA64809@keybit.net>
References: <4B043239.5000009@refractions.net>	<4b043b0f.0e1abc0a.228c.14cf@mx.google.com>	<4B0444B5.7020606@refractions.net>	<20091119155138.GB22298@keybit.net>
	<4B056F75.4020701@altribe.org>	<20091119213207.GD22298@keybit.net>
	<4B06D51D.7060103@altribe.org>	<20091123180944.GY22298@keybit.net>
	<4B0B9E21.201@altribe.org>	<4B1FCC9B.1090707@altribe.org>
	<20091209162410.GA64809@keybit.net>
Message-ID: <4B1FCEED.8070806@altribe.org>

strk wrote:
> CoordinateArraySequence::getAt is a virtual function, which is probably
> the reason why the fully templated solution is much faster instead.
> 
> How can a virtual method be inlined by the compiler ? 

Obviously it can't. I just missed the fact it was virtual because it's
not declared as such in CoordinateArraySequence. So I believe the
compiler was only able to inline it when it was used explicitly through
the exact type. This explains why the cost remains visible (indeed if it
was totally inlined I didn't expect to see it in the call graph anymore).

-- 
Maxime
From mateusz at loskot.net  Wed Dec  9 11:32:42 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Dec  9 11:28:46 2009
Subject: [geos-devel] Benchmark between various geometry libraries
In-Reply-To: <20091209162410.GA64809@keybit.net>
References: <4B043239.5000009@refractions.net>	<4b043b0f.0e1abc0a.228c.14cf@mx.google.com>	<4B0444B5.7020606@refractions.net>	<20091119155138.GB22298@keybit.net>
	<4B056F75.4020701@altribe.org>	<20091119213207.GD22298@keybit.net>
	<4B06D51D.7060103@altribe.org>	<20091123180944.GY22298@keybit.net>
	<4B0B9E21.201@altribe.org>	<4B1FCC9B.1090707@altribe.org>
	<20091209162410.GA64809@keybit.net>
Message-ID: <4B1FD12A.3030101@loskot.net>

strk wrote:
> On Wed, Dec 09, 2009 at 05:13:15PM +0100, Maxime van Noppen wrote:
>> Maxime van Noppen wrote:
>>> I will post any numbers I get.
>> I'm still far from having a solid and complete report but just to give
>> you a taste : on 100 intersections dynamic allocations represent 25.01%
>> of the time cost (17.14% spent allocating, 7.87% deallocating).
>>
>> I've also found several small optimizations that can lead to significant
>> performance boosts. For example, on the 100 intersection benchmark I
>> found that 10% of the time was spent in CoordinateArraySequence::getAt.
>> The fact is that as the code is in the .cpp file it cannot be inlined by
>> the compiler. So I juste moved the one-line code of the .cpp file to the
>> .h file and the runtime cost dropped drastically (to ~ 2%).
> 
> CoordinateArraySequence::getAt is a virtual function, which is probably
> the reason why the fully templated solution is much faster instead.
> 
> How can a virtual method be inlined by the compiler ? 

If compiler is able to determine exact type...

http://www.parashift.com/c++-faq-lite/value-vs-ref-semantics.html#faq-31.6

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
From bontepaarden at gmail.com  Thu Dec 10 06:45:23 2009
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu Dec 10 06:45:26 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
In-Reply-To: <4B1EAB7C.7030306@loskot.net>
References: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
	<BD3A1BBF51D14C47B26207A0766994822807870A65@XCCMS2.cityhall.boston.cob>
	<4B1EAB7C.7030306@loskot.net>
Message-ID: <870e056a0912100345p65bfb6bbuf9750330b2763ac8@mail.gmail.com>

As suggested I've moved over to geos-3.2.0rc4.
And it is compiling fine.

I did notice the resulting geos_c.dll does not have any version numbers in
Windows.
Will that be fixed in the Stable Release?
Or can I fix that myself in the VS2008 files?

We used to have two folders with GEOS source code. One for 32Bit and the
other for 64Bit.
With GDAL 1.6.2 we've managed to merge those folders and have a more
extended makefile which handles the build of 32/64Bit.
Will that also be possible with the GEOS library?
I'm no expert on makefiles but I could use the gdal makefile as an example.

I have one last question (for now ;)).
We use the IsValid() method to check shapes in a shapefile. Currently it
only return false if invalid but not the reason. Is that been added in
3.2.0rc4 or is that for a future version?

Thank you all for your hard work.

With regards,

Paul Meems
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org





2009/12/8 Mateusz Loskot <mateusz@loskot.net>

> Obe, Regina wrote:
> > Paul,
> >
> > Geos 3.1.1 had missing files for VS.  I believe if you pull from SVN
> > you get all the missing files.
>
> Yes, it should be fixed in the trunk:
>
> http://trac.osgeo.org/geos/ticket/303
>
> So, we have 3 solutions [1] in the trunk available for Visual C++ 2005,
> 2008 and 2010. In future, I believe it would be reasonable to move
> completely to CMake, so we no longer need to manually maintain
> Visual C++ projects manually.
>
> [1] http://trac.osgeo.org/geos/browser/trunk/build/README?rev=2800
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091210/3d3b3b07/attachment.html
From robe.dnd at cityofboston.gov  Thu Dec 10 09:57:50 2009
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Thu Dec 10 09:57:58 2009
Subject: [geos-devel] Missing files in geos-3.1.1.tar.bz2
In-Reply-To: <870e056a0912100345p65bfb6bbuf9750330b2763ac8@mail.gmail.com>
References: <870e056a0912080155p78d54de7k43cd9ff9d38e720a@mail.gmail.com>
	<BD3A1BBF51D14C47B26207A0766994822807870A65@XCCMS2.cityhall.boston.cob>
	<4B1EAB7C.7030306@loskot.net>
	<870e056a0912100345p65bfb6bbuf9750330b2763ac8@mail.gmail.com>
Message-ID: <BD3A1BBF51D14C47B26207A07669948228078E1889@XCCMS2.cityhall.boston.cob>

Paul,
Can't answer your other questions, but IsValidReason is definitely in 3.2 (I think it was in 3.1 as well) since PostGIS has been leveraging it since PostGIS 1.4 which shipped with 3.1

Hope that helps,
Regina

________________________________
From: geos-devel-bounces@lists.osgeo.org [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Meems
Sent: Thursday, December 10, 2009 6:45 AM
To: GEOS Development List
Subject: Re: [geos-devel] Missing files in geos-3.1.1.tar.bz2

As suggested I've moved over to geos-3.2.0rc4.
And it is compiling fine.

I did notice the resulting geos_c.dll does not have any version numbers in Windows.
Will that be fixed in the Stable Release?
Or can I fix that myself in the VS2008 files?

We used to have two folders with GEOS source code. One for 32Bit and the other for 64Bit.
With GDAL 1.6.2 we've managed to merge those folders and have a more extended makefile which handles the build of 32/64Bit.
Will that also be possible with the GEOS library?
I'm no expert on makefiles but I could use the gdal makefile as an example.

I have one last question (for now ;)).
We use the IsValid() method to check shapes in a shapefile. Currently it only return false if invalid but not the reason. Is that been added in 3.2.0rc4 or is that for a future version?

Thank you all for your hard work.

With regards,

Paul Meems
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org<http://www.mapwindow.org/>



2009/12/8 Mateusz Loskot <mateusz@loskot.net<mailto:mateusz@loskot.net>>
Obe, Regina wrote:
> Paul,
>
> Geos 3.1.1 had missing files for VS.  I believe if you pull from SVN
> you get all the missing files.

Yes, it should be fixed in the trunk:

http://trac.osgeo.org/geos/ticket/303

So, we have 3 solutions [1] in the trunk available for Visual C++ 2005,
2008 and 2010. In future, I believe it would be reasonable to move
completely to CMake, so we no longer need to manually maintain
Visual C++ projects manually.

[1] http://trac.osgeo.org/geos/browser/trunk/build/README?rev=2800

Best regards,
--
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org<mailto:geos-devel@lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/geos-devel



-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091210/9742763a/attachment.html
From pramsey at opengeo.org  Thu Dec 10 15:30:43 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Thu Dec 10 15:30:48 2009
Subject: [geos-devel] 3.2.0 Final
Message-ID: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>

Shall we release 3.2.0 final? Things seem quiet...

P

--
Paul Ramsey
OpenGeo - http://opengeo.org
The secret sauce is called... PostGIS.

From alex.trofast at ingres.com  Thu Dec 10 15:41:00 2009
From: alex.trofast at ingres.com (Alex Trofast)
Date: Thu Dec 10 15:42:03 2009
Subject: [geos-devel] Return value of GEOSGeom_getDimensions_r
Message-ID: <4B215CDC.8040602@ingres.com>

Hello,

I'm using the GEOS C API and calling GEOSGeom_getDimensions_r on a 
GEOSGeometry. However it always seems to return the number 3, no matter 
what kind of Geometry I pass to it the return value is the same. It 
doesn't seem like GEOS is giving off any kind of error. The Geometry is 
created using a WKBReader from a binary format.
Any help is greatly appreciated.
Thank you!

Alex
From Barend.Gehrels at geodan.nl  Fri Dec 11 05:49:54 2009
From: Barend.Gehrels at geodan.nl (Barend Gehrels)
Date: Fri Dec 11 05:50:09 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
Message-ID: <4B2223D2.7010409@geodan.nl>

Hi,

Maybe you can consider removing (or altering) this statement from the 
documentation main page: "If you prefer troubles you can use the C++ 
interface. " (in geom.h).

Regards, Barend




Paul Ramsey wrote:
> Shall we release 3.2.0 final? Things seem quiet...
>
> P
>
> --
> Paul Ramsey
> OpenGeo - http://opengeo.org
> The secret sauce is called... PostGIS.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>   



From alex.trofast at ingres.com  Fri Dec 11 07:51:37 2009
From: alex.trofast at ingres.com (Alex Trofast)
Date: Fri Dec 11 07:51:41 2009
Subject: [geos-devel] Re: Return value of GEOSGeom_getDimensions_r
In-Reply-To: <4B215CDC.8040602@ingres.com>
References: <4B215CDC.8040602@ingres.com>
Message-ID: <4B224059.4000202@ingres.com>

Hi all,

After reading the source and if I did it right, it seems like that 
GEOSGeom_getDimensions_r would always return a 3, judging by 
getDimensions in this file: 
source/headers/geos/geom/CoordinateArraySequence.h
If this is the case am I misunderstanding what GEOSGeom_getDimensions_r 
is actually supposed to do: return 0 for point, 1 for curve, 2 for surface?
Any help is greatly appreciated,

Thank you

Alex

On 12/10/2009 03:41 PM, Alex Trofast wrote:
> Hello,
>
> I'm using the GEOS C API and calling GEOSGeom_getDimensions_r on a 
> GEOSGeometry. However it always seems to return the number 3, no 
> matter what kind of Geometry I pass to it the return value is the 
> same. It doesn't seem like GEOS is giving off any kind of error. The 
> Geometry is created using a WKBReader from a binary format.
> Any help is greatly appreciated.
> Thank you!
>
> Alex

From strk at keybit.net  Fri Dec 11 08:17:14 2009
From: strk at keybit.net (strk)
Date: Fri Dec 11 08:17:18 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
Message-ID: <20091211131714.GF64809@keybit.net>

On Thu, Dec 10, 2009 at 12:30:43PM -0800, Paul Ramsey wrote:
> Shall we release 3.2.0 final? Things seem quiet...

I've fixed a reported leak in r2822.
r2823 also contains an updated ChangeLog.

Ready for final myself.

--strk; 

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From strk at keybit.net  Fri Dec 11 08:18:30 2009
From: strk at keybit.net (strk)
Date: Fri Dec 11 08:18:32 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B2223D2.7010409@geodan.nl>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl>
Message-ID: <20091211131830.GG64809@keybit.net>

On Fri, Dec 11, 2009 at 11:49:54AM +0100, Barend Gehrels wrote:
> Hi,
> 
> Maybe you can consider removing (or altering) this statement from the 
> documentation main page: "If you prefer troubles you can use the C++ 
> interface. " (in geom.h).

It's still troubles ! how would you reword it ?
Leaks, API/ABI instabilities...

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From strk at keybit.net  Fri Dec 11 08:20:57 2009
From: strk at keybit.net (strk)
Date: Fri Dec 11 08:20:59 2009
Subject: [geos-devel] Re: Return value of GEOSGeom_getDimensions_r
In-Reply-To: <4B224059.4000202@ingres.com>
References: <4B215CDC.8040602@ingres.com> <4B224059.4000202@ingres.com>
Message-ID: <20091211132057.GH64809@keybit.net>

On Fri, Dec 11, 2009 at 07:51:37AM -0500, Alex Trofast wrote:

> If this is the case am I misunderstanding what GEOSGeom_getDimensions_r 
> is actually supposed to do: return 0 for point, 1 for curve, 2 for surface?
> Any help is greatly appreciated,

It's the number of ordinates used in the geometry (2 or 3, but will
always be 3 atm). Pretty useless method indeed.

--strk; 

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From warmerdam at pobox.com  Fri Dec 11 09:51:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Dec 11 09:51:35 2009
Subject: [geos-devel] Re: Return value of GEOSGeom_getDimensions_r
In-Reply-To: <4B224059.4000202@ingres.com>
References: <4B215CDC.8040602@ingres.com> <4B224059.4000202@ingres.com>
Message-ID: <4B225C7C.9030804@pobox.com>

Alex Trofast wrote:
> Hi all,
> 
> After reading the source and if I did it right, it seems like that 
> GEOSGeom_getDimensions_r would always return a 3, judging by 
> getDimensions in this file: 
> source/headers/geos/geom/CoordinateArraySequence.h
> If this is the case am I misunderstanding what GEOSGeom_getDimensions_r 
> is actually supposed to do: return 0 for point, 1 for curve, 2 for surface?
> Any help is greatly appreciated,

Alex,

I do not believe that a CoordinateArraySequence is a Geometry based on my
cursory review.  Instead the particular instance classes of Geometry, like
LineString, own an instance of a CoordinateArraySequence, but actually provide
their own implementation of Geometry::getDimension(). In the case of LineString
I see this returns Dimension::L which I assume is 2.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From alex.trofast at ingres.com  Fri Dec 11 11:11:06 2009
From: alex.trofast at ingres.com (Alex Trofast)
Date: Fri Dec 11 11:11:08 2009
Subject: [geos-devel] Re: Return value of GEOSGeom_getDimensions_r
In-Reply-To: <4B225C7C.9030804@pobox.com>
References: <4B215CDC.8040602@ingres.com> <4B224059.4000202@ingres.com>
	<4B225C7C.9030804@pobox.com>
Message-ID: <4B226F1A.3000000@ingres.com>

Hi Frank,

The reason I said that is because the fact is I get a 3 no matter which 
type I use (Point, Polygon, or Linestring) and looking at the 
implementation of GEOSGeom_getDimensions_r it is returned as this:
dim = ls->getCoordinatesRO()->getDimension();
It does not call the Linestring's getDimension it seems. Does this seem 
like the correct interpretation?

Thanks,

Alex


On 12/11/2009 09:51 AM, Frank Warmerdam wrote:
> Alex Trofast wrote:
>> Hi all,
>>
>> After reading the source and if I did it right, it seems like that 
>> GEOSGeom_getDimensions_r would always return a 3, judging by 
>> getDimensions in this file: 
>> source/headers/geos/geom/CoordinateArraySequence.h
>> If this is the case am I misunderstanding what 
>> GEOSGeom_getDimensions_r is actually supposed to do: return 0 for 
>> point, 1 for curve, 2 for surface?
>> Any help is greatly appreciated,
>
> Alex,
>
> I do not believe that a CoordinateArraySequence is a Geometry based on my
> cursory review.  Instead the particular instance classes of Geometry, 
> like
> LineString, own an instance of a CoordinateArraySequence, but actually 
> provide
> their own implementation of Geometry::getDimension(). In the case of 
> LineString
> I see this returns Dimension::L which I assume is 2.
>
> Best regards,

From warmerdam at pobox.com  Fri Dec 11 11:33:14 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Dec 11 11:33:12 2009
Subject: [geos-devel] Re: Return value of GEOSGeom_getDimensions_r
In-Reply-To: <4B226F1A.3000000@ingres.com>
References: <4B215CDC.8040602@ingres.com> <4B224059.4000202@ingres.com>
	<4B225C7C.9030804@pobox.com> <4B226F1A.3000000@ingres.com>
Message-ID: <4B22744A.3000102@pobox.com>

Alex Trofast wrote:
> Hi Frank,
> 
> The reason I said that is because the fact is I get a 3 no matter which 
> type I use (Point, Polygon, or Linestring) and looking at the 
> implementation of GEOSGeom_getDimensions_r it is returned as this:
> dim = ls->getCoordinatesRO()->getDimension();
> It does not call the Linestring's getDimension it seems. Does this seem 
> like the correct interpretation?

Alex,

Looking in the C bindings, I see what you mean.  I think this is an error
in how the bindings were constructed.  Would you mind filing a ticket on it?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Barend.Gehrels at geodan.nl  Fri Dec 11 14:22:31 2009
From: Barend.Gehrels at geodan.nl (Barend Gehrels)
Date: Fri Dec 11 14:22:51 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <20091211131830.GG64809@keybit.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>	<4B2223D2.7010409@geodan.nl>
	<20091211131830.GG64809@keybit.net>
Message-ID: <4B229BF7.7020103@geodan.nl>


>> Maybe you can consider removing (or altering) this statement from the 
>> documentation main page: "If you prefer troubles you can use the C++ 
>> interface. " (in geom.h).
>>     
>
> It's still troubles ! how would you reword it ?
> Leaks, API/ABI instabilities...
>   
If I see such a statement, I skip such a library. That happened for me 
in 2007...

I would say "You can use the C++ interface but realize that the API 
might change".

Leaks? The C Api just wraps it...

Regards, Barend

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091211/6ee1dbd2/attachment.html
From mateusz at loskot.net  Fri Dec 11 15:21:58 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Dec 11 15:22:25 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <20091211131830.GG64809@keybit.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
Message-ID: <54928.90.212.246.26.1260562918.squirrel@loskot.net>

strk wrote:
> On Fri, Dec 11, 2009 at 11:49:54AM +0100, Barend Gehrels wrote:
>> Hi,
>>>> Maybe you can consider removing (or altering) this statement from the
>> documentation main page: "If you prefer troubles you can use the C++
>> interface. " (in geom.h).
>
> It's still troubles ! how would you reword it ?
> Leaks, API/ABI instabilities...

Leaks? So, C++ API causes memory leaks out of the box?

It's just silly to warns users "please don't use our software
because it hasn't been fixed in concrete yet, the dev team is alive
and keeps working on it"

Let's just send users to JTS, so they can avoid more potential
troubles than just those mentioned.

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Fri Dec 11 15:55:54 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Dec 11 15:55:41 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <54928.90.212.246.26.1260562918.squirrel@loskot.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<54928.90.212.246.26.1260562918.squirrel@loskot.net>
Message-ID: <4B22B1DA.1080601@pobox.com>

Mateusz Loskot wrote:
> strk wrote:
>> On Fri, Dec 11, 2009 at 11:49:54AM +0100, Barend Gehrels wrote:
>>> Hi,
>>>>> Maybe you can consider removing (or altering) this statement from the
>>> documentation main page: "If you prefer troubles you can use the C++
>>> interface. " (in geom.h).
>> It's still troubles ! how would you reword it ?
>> Leaks, API/ABI instabilities...
> 
> Leaks? So, C++ API causes memory leaks out of the box?
> 
> It's just silly to warns users "please don't use our software
> because it hasn't been fixed in concrete yet, the dev team is alive
> and keeps working on it"
> 
> Let's just send users to JTS, so they can avoid more potential
> troubles than just those mentioned.

strk / Mateusz,

I would suggest "If you prefer troubles you can use the C++ interface"
to "Applications requiring API/ABI stability are encouraged to use the
C interface instead of the C++ interface."

I agree with Mateusz that the current text is unhelpful, and unnecessarily
unprofessional even though I'm a strong proponent of using the C API in
many situations.

I am not aware of memory leaks related to the C++ API, and if there are some
there is no reason not to fix them.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From strk at keybit.net  Sat Dec 12 03:34:54 2009
From: strk at keybit.net (strk)
Date: Sat Dec 12 03:35:02 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B229BF7.7020103@geodan.nl>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<4B229BF7.7020103@geodan.nl>
Message-ID: <20091212083454.GA54715@keybit.net>

On Fri, Dec 11, 2009 at 08:22:31PM +0100, Barend Gehrels wrote:

> Leaks? The C Api just wraps it...

The C Api wraps a small portion of the C++ API.
The thing is that in C++ there are *a lot* of interfaces
exposed which should not be.

You might have noticed that many of the headers were not
installed up to 3.1.x. This was an attempt to reduce the
set of exposed interface.

Remember that GEOS is a direct port of JTS, where (in Java)
there are visibility levels that are not supported in C++
(default visibility == only classes in same package can use
those interfaces). In GEOS those all became public instead.

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From strk at keybit.net  Sat Dec 12 03:37:02 2009
From: strk at keybit.net (strk)
Date: Sat Dec 12 03:37:18 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B22B1DA.1080601@pobox.com>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<54928.90.212.246.26.1260562918.squirrel@loskot.net>
	<4B22B1DA.1080601@pobox.com>
Message-ID: <20091212083702.GB54715@keybit.net>

On Fri, Dec 11, 2009 at 03:55:54PM -0500, Frank Warmerdam wrote:

> I am not aware of memory leaks related to the C++ API, and if there are some
> there is no reason not to fix them.

I'm not aware either, but it may happen because the clients
we test GEOS again all use the C Api, which doesn't expose
the leaks itself.

I just fixed a couple of leaks reported by a C++ API user
in methods that would never be called by the C-Api, that's
why I mentioned them.

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From maxime at altribe.org  Sat Dec 12 04:04:26 2009
From: maxime at altribe.org (Maxime van Noppen)
Date: Sat Dec 12 04:08:53 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <20091212083454.GA54715@keybit.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>	<4B2223D2.7010409@geodan.nl>
	<20091211131830.GG64809@keybit.net>	<4B229BF7.7020103@geodan.nl>
	<20091212083454.GA54715@keybit.net>
Message-ID: <4B235C9A.9060009@altribe.org>

strk wrote:
> Remember that GEOS is a direct port of JTS, where (in Java)
> there are visibility levels that are not supported in C++
> (default visibility == only classes in same package can use
> those interfaces). In GEOS those all became public instead.

I believe it's a design issue. It could be possible to put those methods
as protected and to define friend classes that have access to those methods.

-- 
Maxime
From strk at keybit.net  Sat Dec 12 05:04:04 2009
From: strk at keybit.net (strk)
Date: Sat Dec 12 05:04:09 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B235C9A.9060009@altribe.org>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<4B229BF7.7020103@geodan.nl> <20091212083454.GA54715@keybit.net>
	<4B235C9A.9060009@altribe.org>
Message-ID: <20091212100404.GC54715@keybit.net>

On Sat, Dec 12, 2009 at 10:04:26AM +0100, Maxime van Noppen wrote:
> strk wrote:
> > Remember that GEOS is a direct port of JTS, where (in Java)
> > there are visibility levels that are not supported in C++
> > (default visibility == only classes in same package can use
> > those interfaces). In GEOS those all became public instead.
> 
> I believe it's a design issue. It could be possible to put those methods
> as protected and to define friend classes that have access to those methods.

Yes but then we'll have to add new friends everytime a new class is added
and it's something increasing the maintainance cost. If we could mark
a whole namespace as a friend that'd be 1:1 mapping with JTS I guess, and
no additional maintainance cost.

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From maxime at altribe.org  Sat Dec 12 06:14:44 2009
From: maxime at altribe.org (Maxime van Noppen)
Date: Sat Dec 12 06:19:07 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <20091212100404.GC54715@keybit.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>	<4B2223D2.7010409@geodan.nl>
	<20091211131830.GG64809@keybit.net>	<4B229BF7.7020103@geodan.nl>
	<20091212083454.GA54715@keybit.net>	<4B235C9A.9060009@altribe.org>
	<20091212100404.GC54715@keybit.net>
Message-ID: <4B237B24.4060608@altribe.org>

strk wrote:
> Yes but then we'll have to add new friends everytime a new class is added
> and it's something increasing the maintainance cost.

You're right.

> If we could mark
> a whole namespace as a friend that'd be 1:1 mapping with JTS I guess, and
> no additional maintainance cost.

It's unfortunately not possible, friends are only function & classes.

I'm curious about the design though. You're talking about "packages".
What to they represent in Geos and what is their role ? I don't now the
exact problematic but some design idioms might help (virtual friend
functions, ...). Is there any documentation about geos design and the
reasons that motivated it ?

-- 
Maxime
From Barend.Gehrels at geodan.nl  Sat Dec 12 06:47:47 2009
From: Barend.Gehrels at geodan.nl (Barend Gehrels)
Date: Sat Dec 12 06:48:04 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <20091212083454.GA54715@keybit.net>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>	<4B2223D2.7010409@geodan.nl>
	<20091211131830.GG64809@keybit.net>	<4B229BF7.7020103@geodan.nl>
	<20091212083454.GA54715@keybit.net>
Message-ID: <4B2382E3.4000601@geodan.nl>


> The C Api wraps a small portion of the C++ API.
> The thing is that in C++ there are *a lot* of interfaces
> exposed which should not be.
>
> You might have noticed that many of the headers were not
> installed up to 3.1.x. This was an attempt to reduce the
> set of exposed interface.
>
> Remember that GEOS is a direct port of JTS, where (in Java)
> there are visibility levels that are not supported in C++
> (default visibility == only classes in same package can use
> those interfaces). In GEOS those all became public instead.
>   
Thanks, this explanation is much more clear than the "prefer troubles" 
statement. I think Frank's suggested wording is perfect.

On the friend discussion: you can probably put those not-to-be-exposed 
interfaces in a namespace like "detail", or "impl", or "not_exposed". 
That will prevent normal C++ programmers from using it, without the 
drawbacks of friends. The interfaces are technically not hidden then, 
but it is clear they are not recommended.

Regards, Barend



From mateusz at loskot.net  Sat Dec 12 09:36:34 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Dec 12 09:37:06 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B2382E3.4000601@geodan.nl>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<4B229BF7.7020103@geodan.nl> <20091212083454.GA54715@keybit.net>
	<4B2382E3.4000601@geodan.nl>
Message-ID: <50003.94.1.119.76.1260628594.squirrel@loskot.net>

Barend Gehrels wrote:
> On the friend discussion: you can probably put those not-to-be-exposed
> interfaces in a namespace like "detail", or "impl", or "not_exposed".

...or private

> That will prevent normal C++ programmers from using it, without the
> drawbacks of friends.

I second Barend's voice.

Everything what does not belong to public interface of GEOS,
but it a member of so called implementation detail should
go to separate namespace.
This is common approach to indicate what elements are
supposed to be used by a library client.

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From raffi.krikorian at gmail.com  Sat Dec 12 11:46:58 2009
From: raffi.krikorian at gmail.com (raffi)
Date: Sat Dec 12 11:47:20 2009
Subject: [geos-devel] SWIG Ruby bindings on OS X
Message-ID: <263713070912120846s6bacbe69x5e6c4a7cf014c7d3@mail.gmail.com>

has anybody had any luck, recently, getting the ruby OS X bindings to work
and install?

i've tried both checking out from SVN, and the geos-3.2.0rc4.tar.bz2 tarball
-- when configuring with

./configure --enable-ruby

it clearly wants to create ruby bindings, and they even are existent
in /Library/Ruby/Site/1.8/universal-darwin9.0/:

[raffi@tw-mbp13-raffi swig]$  ls -l
/Library/Ruby/Site/1.8/universal-darwin9.0/geos.*
-rw-r--r--  1 root  admin  355768 Dec 12 08:45
/Library/Ruby/Site/1.8/universal-darwin9.0/geos.a
-rwxr-xr-x  1 root  admin    1044 Dec 12 08:45
/Library/Ruby/Site/1.8/universal-darwin9.0/geos.la
-rwxr-xr-x  1 root  admin  124932 Dec 12 08:45
/Library/Ruby/Site/1.8/universal-darwin9.0/geos.so

but when i try to actually require it

raffi@tw-mbp13-raffi ~]$ irb
>> require 'geos'
LoadError: no such file to load -- geos
from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in
`gem_original_require'
 from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `require'
from (irb):1

anybody have any suggestions?  i'm running 10.5.

thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20091212/c42c101c/attachment.html
From strk at keybit.net  Mon Dec 14 14:02:14 2009
From: strk at keybit.net (strk)
Date: Mon Dec 14 14:02:21 2009
Subject: [geos-devel] 3.2.0 Final
In-Reply-To: <4B22B1DA.1080601@pobox.com>
References: <C2FAA596-DC38-4F32-86BD-167E2E0A1661@opengeo.org>
	<4B2223D2.7010409@geodan.nl> <20091211131830.GG64809@keybit.net>
	<54928.90.212.246.26.1260562918.squirrel@loskot.net>
	<4B22B1DA.1080601@pobox.com>
Message-ID: <20091214190214.GG54715@keybit.net>

On Fri, Dec 11, 2009 at 03:55:54PM -0500, Frank Warmerdam wrote:

> I would suggest "If you prefer troubles you can use the C++ interface"
> to "Applications requiring API/ABI stability are encouraged to use the
> C interface instead of the C++ interface."

I changed:
<< If you prefer troubles you can use the C++ interface. >>
with:
<< If you don't care about adapting/rebuilding your client code you
  can still use the C++ interface. >>

Your statement was already in previous statement:

<<
The recommended low-level interface to the GEOS library is the simplified C wrapper interface. This will ensure stability of the API and the ABI of the library during performance improvements that will likely change classes definitions.
>>

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From strk at keybit.net  Mon Dec 14 14:53:51 2009
From: strk at keybit.net (Sandro Santilli)
Date: Mon Dec 14 14:53:55 2009
Subject: [geos-devel] 3.2.0 release ready for download
Message-ID: <20091214195351.GH54715@keybit.net>

I'm pleased to announce the final release of GEOS 3.2.0.

  http://download.osgeo.org/geos/geos-3.2.0.tar.bz2

This new release provides improved robustness and speed,
along with new additions to the C api:
 - STRtree support 
 - Linear referencing functions (project, interpolate)
 - Styled Buffer operations (define join and endcap styles)

C-Api clients (like postgis) will benefit from the improvements
(not the additions) by just installing the new library.
C++ clients will need rebuilding, but hopefully no tweaking of the code.

For PostGIS, rebuilding it will also give SQL access to the styled
buffer operation.

Happy holidays !

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From gdt at ir.bbn.com  Mon Dec 14 18:39:21 2009
From: gdt at ir.bbn.com (Greg Troxel)
Date: Mon Dec 14 18:48:37 2009
Subject: [geos-devel] 3.2.0 release ready for download
In-Reply-To: <20091214195351.GH54715@keybit.net> (Sandro Santilli's message of
	"Mon, 14 Dec 2009 20:53:51 +0100")
References: <20091214195351.GH54715@keybit.net>
Message-ID: <rmibpi1nn12.fsf@fnord.ir.bbn.com>


I have updated the pkgsrc entry for geos.  It passed make check on
NetBSD/5.0 i386.

The shlib major version changed; probably NEWS should mention that.  Are
there incompatible ABI changes?  (From a packaging point of view, shlib
version changes when there aren't actually ABI changes generates work
that could be avoided; all depending packages need a version change
because they only interoperate with one or the other geos version.)



From: Greg Troxel <gdt@netbsd.org>
Subject: CVS commit: pkgsrc/geography/geos
To: pkgsrc-changes@NetBSD.org
Date: Mon, 14 Dec 2009 23:31:06 +0000
Reply-To: gdt@netbsd.org

Module Name:	pkgsrc
Committed By:	gdt
Date:		Mon Dec 14 23:31:06 UTC 2009

Modified Files:
	pkgsrc/geography/geos: Makefile PLIST distinfo

Log Message:
Update to 3.2.0:

Changes in 3.2.0

- Add Single-sided buffer operation
- JTS-1.10 sync ...
  - Drastically improved Buffer speed (20x for a case in testsuite)
  - Improved EdgeList duplicate edge finding
  - Added algorithm::distance package
  - Added algorithm::Angle class
  - Added algorithm::BoundaryNodeRule class
  - IsSimpleOp can now return non-simple location coordinate
  - DistanceOp can now check for 'within distance' predicate
    (earlier exit)
  - MultiPolygon::getBoundary always return MultiLineString, also
    when the result is the EMPTY geometry.
- Various bug and leak fixes, optimizations
- Replace MarkupSTL with tinyXML


To generate a diff of this commit:
cvs rdiff -u -r1.10 -r1.11 pkgsrc/geography/geos/Makefile
cvs rdiff -u -r1.8 -r1.9 pkgsrc/geography/geos/PLIST \
    pkgsrc/geography/geos/distinfo

Please note that diffs are not public domain; they are subject to the
copyright notices on the relevant files.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091214/04d33815/attachment.bin
From strk at keybit.net  Tue Dec 15 03:49:36 2009
From: strk at keybit.net (strk)
Date: Tue Dec 15 03:49:40 2009
Subject: [geos-devel] 3.2.0 release ready for download
In-Reply-To: <rmibpi1nn12.fsf@fnord.ir.bbn.com>
References: <20091214195351.GH54715@keybit.net>
	<rmibpi1nn12.fsf@fnord.ir.bbn.com>
Message-ID: <20091215084936.GD23203@keybit.net>

On Mon, Dec 14, 2009 at 06:39:21PM -0500, Greg Troxel wrote:

> The shlib major version changed; probably NEWS should mention that. 

GEOS has 2 shared libraries. 
The one implementing the C++ API and the one implementing the C API.

While we maintain proper library versioning for the C API, we don't
for the C++ one, due to the way too wide set of exposed interfaces
we should look at to figure when ABI was or wasn't broken (and in C++
land ABI breaks SO easily).

> Are
> there incompatible ABI changes? 

For the C++ shlib, most likely.

> (From a packaging point of view, shlib
> version changes when there aren't actually ABI changes generates work
> that could be avoided; all depending packages need a version change
> because they only interoperate with one or the other geos version.)

This is exactly the reason why we incourage use of the C library
(libgeos_c.so). The C library hard continues to expose a compatible ABI
to the ABI-incompatible C++ library.

So, while GEOS 3.2.0 *c++* lib is a few steps away from GEOS 3.0.0 *c++* lib,
any code which linked against the *c* lib in GEOS 3.0.0 will still work
with the *c* lib of GEOS 3.2.0.

>From a packaging point of view you should likely properly encode
if a client is dependent on *libgeos* or *libgeos_c* as that makes
a big difference.

Is this too much confusing ?


--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From gdt at ir.bbn.com  Tue Dec 15 10:59:01 2009
From: gdt at ir.bbn.com (Greg Troxel)
Date: Tue Dec 15 10:59:04 2009
Subject: [geos-devel] 3.2.0 release ready for download
References: <20091214195351.GH54715@keybit.net>
	<rmibpi1nn12.fsf@fnord.ir.bbn.com> <20091215084936.GD23203@keybit.net>
Message-ID: <rmiaaxkz0sa.fsf@fnord.ir.bbn.com>


strk <strk@keybit.net> writes (reordered)

> Is this too much confusing ?

Yes :-) So here are the results of the build on NetBSD with pkgsrc.  The
build is very default, with the only change being putting @LDFLAGS@ into
geos-config so that rpath works right.  So here are the results:

For 3.1:

-rwxr-xr-x  1 root  wheel  1703998 Dec 15 10:27 libgeos-3.1.0.so
-rw-r--r--  1 root  wheel  3626526 Dec 15 10:27 libgeos.a
-rwxr-xr-x  1 root  wheel      844 Dec 15 10:27 libgeos.la
lrwxr-xr-x  1 root  wheel       16 Dec 15 10:27 libgeos.so -> libgeos-3.1.0.so
-rw-r--r--  1 root  wheel   101126 Dec 15 10:27 libgeos_c.a
-rwxr-xr-x  1 root  wheel      871 Dec 15 10:27 libgeos_c.la
lrwxr-xr-x  1 root  wheel       18 Dec 15 10:27 libgeos_c.so -> libgeos_c.so.1.5.0
lrwxr-xr-x  1 root  wheel       18 Dec 15 10:27 libgeos_c.so.1 -> libgeos_c.so.1.5.0
-rwxr-xr-x  1 root  wheel   103071 Dec 15 10:27 libgeos_c.so.1.5.0

For 3.2:

-rwxr-xr-x  1 root  wheel  1894950 Dec 14 18:29 libgeos-3.2.0.so
-rw-r--r--  1 root  wheel  3884736 Dec 14 18:29 libgeos.a
-rwxr-xr-x  1 root  wheel      844 Dec 14 18:29 libgeos.la
lrwxr-xr-x  1 root  wheel       16 Dec 14 18:29 libgeos.so -> libgeos-3.2.0.so
-rw-r--r--  1 root  wheel   138296 Dec 14 18:29 libgeos_c.a
-rwxr-xr-x  1 root  wheel      871 Dec 14 18:29 libgeos_c.la
lrwxr-xr-x  1 root  wheel       18 Dec 14 18:29 libgeos_c.so -> libgeos_c.so.1.6.0
lrwxr-xr-x  1 root  wheel       18 Dec 14 18:29 libgeos_c.so.1 -> libgeos_c.so.1.6.0
-rwxr-xr-x  1 root  wheel   133825 Dec 14 18:29 libgeos_c.so.1.6.0

> On Mon, Dec 14, 2009 at 06:39:21PM -0500, Greg Troxel wrote:
>
>> The shlib major version changed; probably NEWS should mention that. 
>
> GEOS has 2 shared libraries. 
> The one implementing the C++ API and the one implementing the C API.
>
> While we maintain proper library versioning for the C API, we don't
> for the C++ one, due to the way too wide set of exposed interfaces
> we should look at to figure when ABI was or wasn't broken (and in C++
> land ABI breaks SO easily).

OK, but it would be good to say that c++ shlib version changed in NEWS,
because that is in itself an ABI change, which I realize makes
irrelevant whether the actual ABI of the library changed.

The whole relationship between libgeos and libgeos_c was unintuitive,
but now I figured it out, and I see the c library major version did not
change.

>> (From a packaging point of view, shlib
>> version changes when there aren't actually ABI changes generates work
>> that could be avoided; all depending packages need a version change
>> because they only interoperate with one or the other geos version.)
>
> This is exactly the reason why we incourage use of the C library
> (libgeos_c.so). The C library hard continues to expose a compatible ABI
> to the ABI-incompatible C++ library.
>
> So, while GEOS 3.2.0 *c++* lib is a few steps away from GEOS 3.0.0 *c++* lib,
> any code which linked against the *c* lib in GEOS 3.0.0 will still work
> with the *c* lib of GEOS 3.2.0.

I see; it might be nice to have the C wrapper separately buildable and
then it could easily be in a separate package (via --disable-c++ and
--disable-c, where --disable-c++ builds the c wrapper and expects
libgeos already installed).

>>From a packaging point of view you should likely properly encode
> if a client is dependent on *libgeos* or *libgeos_c* as that makes
> a big difference.

Agreed, probably should but we don't.  It's not just libraries but
programs.  Now, if something depends on 'geos', then it gets a revision
bump if the ABI of the *geos package* changes, which it does if any
shlib or program used by a program (none in this case) changes.
And geos-config seems to be maingly the c++ version (with --libs).

Perhaps two pkg-config files should be installed, for geos and geos_c.

I realize splitting c/c++ is a lot of work for not much gain, but
thought it might be helpful to explain where I'm coming from.
Explaining API and ABI changes in NEWS should be easy (even to say "This
is API compatible with release X" when there are no backwards
incompatibilites) -- that's the information I need to adjust the
packaging control files.

Thanks for the explanations.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091215/8d35d6d2/attachment.bin
From gwaldron at gmail.com  Tue Dec 15 13:04:11 2009
From: gwaldron at gmail.com (Glenn Waldron)
Date: Tue Dec 15 13:04:15 2009
Subject: [geos-devel] Missing file in Makefile.vc
Message-ID: <70fbea790912151004q70b08179t68cada35060743e3@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: Makefile.vc
Type: application/octet-stream
Size: 13598 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091215/9e9622ba/Makefile.obj
From strk at keybit.net  Tue Dec 15 16:49:08 2009
From: strk at keybit.net (strk)
Date: Tue Dec 15 16:49:12 2009
Subject: [geos-devel] 3.2.0 release ready for download
In-Reply-To: <rmiaaxkz0sa.fsf@fnord.ir.bbn.com>
References: <20091214195351.GH54715@keybit.net>
	<rmibpi1nn12.fsf@fnord.ir.bbn.com>
	<20091215084936.GD23203@keybit.net>
	<rmiaaxkz0sa.fsf@fnord.ir.bbn.com>
Message-ID: <20091215214908.GJ23203@keybit.net>

On Tue, Dec 15, 2009 at 10:59:01AM -0500, Greg Troxel wrote:
> 
> strk <strk@keybit.net> writes (reordered)
> 
> > Is this too much confusing ?
> 
> Yes :-) So here are the results of the build on NetBSD with pkgsrc.  The
> build is very default, with the only change being putting @LDFLAGS@ into
> geos-config so that rpath works right.  So here are the results:
> 
> For 3.1:
> 
> -rwxr-xr-x  1 root  wheel  1703998 Dec 15 10:27 libgeos-3.1.0.so
> lrwxr-xr-x  1 root  wheel       16 Dec 15 10:27 libgeos.so -> libgeos-3.1.0.so
> lrwxr-xr-x  1 root  wheel       18 Dec 15 10:27 libgeos_c.so -> libgeos_c.so.1.5.0
> lrwxr-xr-x  1 root  wheel       18 Dec 15 10:27 libgeos_c.so.1 -> libgeos_c.so.1.5.0
> -rwxr-xr-x  1 root  wheel   103071 Dec 15 10:27 libgeos_c.so.1.5.0
> 
> For 3.2:
> 
> -rwxr-xr-x  1 root  wheel  1894950 Dec 14 18:29 libgeos-3.2.0.so
> lrwxr-xr-x  1 root  wheel       16 Dec 14 18:29 libgeos.so -> libgeos-3.2.0.so
> lrwxr-xr-x  1 root  wheel       18 Dec 14 18:29 libgeos_c.so -> libgeos_c.so.1.6.0
> lrwxr-xr-x  1 root  wheel       18 Dec 14 18:29 libgeos_c.so.1 -> libgeos_c.so.1.6.0
> -rwxr-xr-x  1 root  wheel   133825 Dec 14 18:29 libgeos_c.so.1.6.0

Sounds good to me. 
As you can see the SONAME for libgeos_c.o hasn't changed (libgeos_c.so.1)
while the one for libgeos is (libgeos-3.1.0.so vs libgeos-3.2.0.so).

What I expect is that if you compile a couple simple test program
one with -lgeos and the other with -lgeos_c while only 3.1 is
installed, then when you install 3.2 the one compiled with -lgeos_c
will automatically use functionalities of libgeos-3.2.0.so while
the other will be strictly bound to libgeos-3.1.0.so.

Can you confirm ?

--strk;

 Free GIS & Flash consultant/developer      ()  ASCII Ribbon Campaign
 http://foo.keybit.net/~strk/services.html  /\  Keep it simple! 
From pramsey at opengeo.org  Tue Dec 15 19:07:26 2009
From: pramsey at opengeo.org (Paul Ramsey)
Date: Tue Dec 15 19:07:29 2009
Subject: [geos-devel] New York Code Sprint
Message-ID: <30fe546d0912151607g1ca68349obaae14adbe4ebced@mail.gmail.com>

Hi Devs,

Friendly reminder to start making your travel arrangements and in
particular book your hotel, so our block booking doesn't get lost, if
you're coming to the Code Sprint.

http://wiki.osgeo.org/wiki/New_York_Code_Sprint_2010#Hotel

We've got room to play still, so if you are thinking of coming please
do add yourself to the attendance list. We can't plan for people we
don't know are coming!

Thanks,

Paul
From gdt at ir.bbn.com  Tue Dec 15 19:32:52 2009
From: gdt at ir.bbn.com (Greg Troxel)
Date: Tue Dec 15 19:32:58 2009
Subject: [geos-devel] 3.2.0 release ready for download
In-Reply-To: <20091215214908.GJ23203@keybit.net> (strk@keybit.net's message of
	"Tue, 15 Dec 2009 22:49:08 +0100")
References: <20091214195351.GH54715@keybit.net>
	<rmibpi1nn12.fsf@fnord.ir.bbn.com> <20091215084936.GD23203@keybit.net>
	<rmiaaxkz0sa.fsf@fnord.ir.bbn.com> <20091215214908.GJ23203@keybit.net>
Message-ID: <rmizl5jkbbf.fsf@fnord.ir.bbn.com>


  Sounds good to me. 
  As you can see the SONAME for libgeos_c.o hasn't changed (libgeos_c.so.1)
  while the one for libgeos is (libgeos-3.1.0.so vs libgeos-3.2.0.so).

  What I expect is that if you compile a couple simple test program
  one with -lgeos and the other with -lgeos_c while only 3.1 is
  installed, then when you install 3.2 the one compiled with -lgeos_c
  will automatically use functionalities of libgeos-3.2.0.so while
  the other will be strictly bound to libgeos-3.1.0.so.

  Can you confirm ?

That's what ldd would lead me to believe; the library looks to have the
right dependency.  I'll see if I can get to trying that test.

gdt 65 > l /usr/pkg/lib/libgeos_c.so.1.6.0 
-rwxr-xr-x  1 root  wheel  133825 Dec 14 18:29 /usr/pkg/lib/libgeos_c.so.1.6.0
gdt 66 ~ > ldd /usr/pkg/lib/libgeos_c.so.1.6.0 
/usr/pkg/lib/libgeos_c.so.1.6.0:
        -lc.12 => /usr/lib/libc.so.12
        -lstdc++.6 => /usr/lib/libstdc++.so.6
        -lm.0 => /usr/lib/libm.so.0
        -lgcc_s.1 => /usr/lib/libgcc_s.so.1
        -lgeos-3.2.0 => /usr/pkg/lib/libgeos-3.2.0.so

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091215/c891e6e2/attachment-0001.bin
From geos-trac at osgeo.org  Sun Dec 20 05:48:02 2009
From: geos-trac at osgeo.org (GEOS)
Date: Sun Dec 20 05:48:04 2009
Subject: [geos-devel] Re: [GEOS] #222: GEOS 3.0 won't link on ARM-EABI
	platform
In-Reply-To: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
References: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
Message-ID: <058.35f79cc4fef42b30791ef368934eed32@osgeo.org>

#222: GEOS 3.0 won't link on ARM-EABI platform
-----------------------+----------------------------------------------------
 Reporter:  jcrepetto  |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |       Status:  new                       
 Priority:  major      |    Milestone:  3.3.0                     
Component:  Default    |      Version:  3.1.1                     
 Severity:  Critical   |   Resolution:                            
 Keywords:             |  
-----------------------+----------------------------------------------------
Comment (by letop):

 Replying to [comment:1 pramsey]:
 > Sorry, we need a patch on this that you like, we don't have ARM systems
 lying around to re-create it.

 I already made a description of the fix in my post, but here is one that I
 had to redo on 'geos-3.2.0' to make it build:

 --- inlines-3.2.0.cpp   2009-12-20 11:38:18.000000000 +0100
 +++ build/geos-3.2.0/source/inlines.cpp 2009-12-20 11:43:48.000000000
 +0100
 @@ -59,7 +59,17 @@
  #include <geos/geom/CoordinateArraySequenceFactory.inl>
  #include <geos/noding/SegmentString.inl>
  #include <geos/noding/snapround/HotPixel.inl>
 -#include <geos/noding/snapround/MCIndexSnapRounder.inl>
 +//
 +// Include MCIndexSnapRounder.inl line commented.
 +//  Resolves double definition of
 geos::noding::snapround::MCIndexSnapRounder
 +//  on ARM platform.
 +//  The header inclusion does not just include, but also creates code for
 +//  MCIndexSnapRounder.
 +// osgeo.org Ticket #222
 +// Fix suggested by Mario De Weerd.
 +// Impact must be analysed on other platforms.
 +//
 +//#include <geos/noding/snapround/MCIndexSnapRounder.inl>
  #include <geos/noding/MCIndexNoder.inl>

  #endif // defined __CYGWIN__

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/222#comment:8>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Sun Dec 20 05:49:01 2009
From: geos-trac at osgeo.org (GEOS)
Date: Sun Dec 20 05:49:03 2009
Subject: [geos-devel] Re: [GEOS] #222: GEOS 3.0 won't link on ARM-EABI
	platform
In-Reply-To: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
References: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
Message-ID: <058.9a2c557990134ac63139122a6a3c5a01@osgeo.org>

#222: GEOS 3.0 won't link on ARM-EABI platform
-----------------------+----------------------------------------------------
 Reporter:  jcrepetto  |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |       Status:  new                       
 Priority:  major      |    Milestone:  3.3.0                     
Component:  Default    |      Version:  3.1.1                     
 Severity:  Critical   |   Resolution:                            
 Keywords:             |  
-----------------------+----------------------------------------------------
Comment (by letop):

 Same patch without WikiFormatting breaking it:
 {{{
 --- inlines-3.2.0.cpp   2009-12-20 11:38:18.000000000 +0100
 +++ build/geos-3.2.0/source/inlines.cpp 2009-12-20 11:43:48.000000000
 +0100
 @@ -59,7 +59,17 @@
  #include <geos/geom/CoordinateArraySequenceFactory.inl>
  #include <geos/noding/SegmentString.inl>
  #include <geos/noding/snapround/HotPixel.inl>
 -#include <geos/noding/snapround/MCIndexSnapRounder.inl>
 +//
 +// Include MCIndexSnapRounder.inl line commented.
 +//  Resolves double definition of
 geos::noding::snapround::MCIndexSnapRounder
 +//  on ARM platform.
 +//  The header inclusion does not just include, but also creates code for
 +//  MCIndexSnapRounder.
 +// osgeo.org Ticket #222
 +// Fix suggested by Mario De Weerd.
 +// Impact must be analysed on other platforms.
 +//
 +//#include <geos/noding/snapround/MCIndexSnapRounder.inl>
  #include <geos/noding/MCIndexNoder.inl>

  #endif // defined __CYGWIN__
 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/222#comment:9>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From Nick.Uebelhor at noaa.gov  Mon Dec 28 22:43:08 2009
From: Nick.Uebelhor at noaa.gov (Nick Uebelhor)
Date: Mon Dec 28 23:43:24 2009
Subject: [geos-devel] Installation of Postgis/postgresql
Message-ID: <4B397ACC.8030106@noaa.gov>

Trying to install postgis on LINUX machine, need to find the geos-
config file, as seems it is no where to be found after download of
postgis in the ./configure step, is there anyone that can give me a
clue on how to find this file? Ultimate goal is to get postgis working
so we can use geom data type in the tables on postgresql, and to get
php to be able to talk to postgresql when scripts are run using
pg_connect function.

during ./configure of postGIS errors out looking for geos-config

during ./configure of geos errors out looking for g++

to the best of my knowledge g++ is part of gcc and we have a current
version of the gcc compiler on the computer

Thanks,
Nick


From mateusz at loskot.net  Tue Dec 29 04:25:31 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Dec 29 04:25:39 2009
Subject: [geos-devel] Installation of Postgis/postgresql
In-Reply-To: <4B397ACC.8030106@noaa.gov>
References: <4B397ACC.8030106@noaa.gov>
Message-ID: <4B39CB0B.1020908@loskot.net>

Nick Uebelhor wrote:
> Trying to install postgis on LINUX machine, need to find the geos-
> config file, as seems it is no where to be found after download of
> postgis in the ./configure step,

Read the PostGIS manual, where you can learn about its requirements:

http://postgis.org/documentation/manual-1.4/ch02.html#id2478443

Then you will find out that GEOS is a third-party requirement of PostGIS
and is not included in PostGIS source package.

> is there anyone that can give me a clue on how to find this file?

You need to install GEOS with library and header files.
Check if the distribution of Linux you're using does provide
GEOS packages. If not, you need to build and install it from
sources according to "Build and Install" section here:

http://trac.osgeo.org/geos/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From kurama_xp at hotmail.com  Tue Dec 29 20:37:30 2009
From: kurama_xp at hotmail.com (=?utf-8?B?5rKZ5Y2OIOiUk+auig==?=)
Date: Tue Dec 29 20:38:41 2009
Subject: [geos-devel] =?utf-8?q?how_to_compile_this_new_package=E2=80=8F?=
Message-ID: <BAY142-W43CD389A335F1865521FA99790@phx.gbl>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1.bmp
Type: image/bmp
Size: 1724598 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20091230/076a2f12/1-0001.bmp
From mateusz at loskot.net  Wed Dec 30 12:50:40 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Dec 30 12:50:47 2009
Subject: [geos-devel] how to compile this new =?UTF-8?B?cGFja2FnZeKAjw==?=
In-Reply-To: <BAY142-W43CD389A335F1865521FA99790@phx.gbl>
References: <BAY142-W43CD389A335F1865521FA99790@phx.gbl>
Message-ID: <4B3B92F0.3010705@loskot.net>

?? ?? wrote:
> All,

> 
> I can't compile geos-3.2.0.tar.bz2 with following commands.
> 
> autogen.bat nmake /f makefile.vc MSVC_VER=1500
> 
> I use VS 2005 + Sp1 and Wndows xp + Sp3. Please take a look at the
> file attached. I got an error.
> 
> CoordinateArraySequenceFactory.obj : error LNK2019: unresolved
> external symbol " public: virtual __thiscall
> geos::geom::CoordinateSequenceFactory::~CoordinateSeq 
> uenceFactory(void)" (??1CoordinateSequenceFactory@geom@geos@@UAE@XZ)
> referenced in function "public: virtual __thiscall
> geos::geom::CoordinateArraySequenceFacto 
> ry::~CoordinateArraySequenceFactory(void)"
> (??1CoordinateArraySequenceFactory@ge om@geos@@UAE@XZ) geos_ts_c.obj
> : error LNK2001: unresolved external symbol "public: virtual __thi 
> scall
> geos::geom::CoordinateSequenceFactory::~CoordinateSequenceFactory(void)"
> ( ??1CoordinateSequenceFactory@geom@geos@@UAE@XZ) geos.dll : fatal
> error LNK1120: 1 unresolved externals NMAKE : fatal error U1077:
> '"C:\Program Files\Microsoft Visual Studio 8\VC\BIN\l ink.exe"' :
> return code '0x460' Stop. NMAKE : fatal error U1077: '"C:\Program
> Files\Microsoft Visual Studio 8\VC\BIN\n make.EXE"' : return code
> '0x2' Stop.
> 
> Please give me an advice to solve it. Thanks.


It is a known problem that was reported here:

http://trac.osgeo.org/geos/ticket/313

It's been already fixed in the SVN trunk. Simply, add the missing line
to source/Makefile.vc file as presented here:

http://trac.osgeo.org/geos/changeset/2833

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From geos-trac at osgeo.org  Thu Dec 31 09:15:19 2009
From: geos-trac at osgeo.org (GEOS)
Date: Thu Dec 31 09:15:21 2009
Subject: [geos-devel] Re: [GEOS] #222: GEOS 3.0 won't link on ARM-EABI
	platform
In-Reply-To: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
References: <049.6e4246ab4b7f6c9a4effd3a2be850484@osgeo.org>
Message-ID: <058.1b55b0f3d04899c52ae7eb1f8e9632be@osgeo.org>

#222: GEOS 3.0 won't link on ARM-EABI platform
-----------------------+----------------------------------------------------
 Reporter:  jcrepetto  |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |       Status:  new                       
 Priority:  major      |    Milestone:  3.3.0                     
Component:  Default    |      Version:  3.1.1                     
 Severity:  Critical   |   Resolution:                            
 Keywords:             |  
-----------------------+----------------------------------------------------
Comment (by wmark):

 Above patch helped me compile GEOS-3.2.0 on ''armv5tel-softfloat-linux-
 gnueabi'' with:

  * GCC 4.4.1, {{{-Os -march=armv5te -pipe -combine -fomit-frame-pointer
 -ftree-builtin-call-dce}}}
  * binutils 2.19.1-!r1
  * glibc 2.11-!r1
  * Gentoo

 Thank you!

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/222#comment:10>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
