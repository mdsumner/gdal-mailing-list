From pramsey at cleverelephant.ca  Sun Aug  2 10:23:27 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Sun, 2 Aug 2020 10:23:27 -0700
Subject: [geos-devel] VS Studio Help?
In-Reply-To: <CACJ51z31UM8XPx3bkWfcdEOyS9oYtTH7LhstXuMOfU_c=eH8Qg@mail.gmail.com>
References: <C1726F2C-765B-4701-B239-25B301B5811A@cleverelephant.ca>
 <CACJ51z1GdzZP-ZwNPj49zydV2=Vk_eDWv1ZyRyykrZmaVQ-9og@mail.gmail.com>
 <706623DD-C680-4617-BFA5-B66B342E52FF@cleverelephant.ca>
 <71E30459-8299-465C-9C49-CFAA76DC7B8D@cleverelephant.ca>
 <CACJ51z31UM8XPx3bkWfcdEOyS9oYtTH7LhstXuMOfU_c=eH8Qg@mail.gmail.com>
Message-ID: <35CBA724-A44D-4CF0-9512-051DFA3BD9A0@cleverelephant.ca>

Bringing in the namespace did not seem to be the trick. 

https://dev.azure.com/libgeos/geos/_build/results?buildId=596&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=1064

https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65

Still mysterious to me.

P

> On Jul 31, 2020, at 2:03 PM, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> 
> The CoordinateSequence there doesn't appear to be in the correct namespace. Seems like you would need geom::CoordinateSequence.  
> 
> On Fri, Jul 31, 2020 at 3:34 PM Paul Ramsey <pramsey at cleverelephant.ca> wrote:
> Er, here's the line it's complaining about.
> 
> https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65
> 
> > On Jul 31, 2020, at 12:27 PM, Paul Ramsey <pramsey at cleverelephant.ca> wrote:
> > 
> > That maybe was a lot of them? I put actual headers into place where a std::vector<std::unique_ptr<>> was being declared, but I'm still left with 
> > 
> > https://dev.azure.com/libgeos/geos/_build/results?buildId=591&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=156
> > 
> > and a handful of others. The error seems the same, but I've already brought in the class defn, not sure what else to do...
> > 
> > P
> > 
> >> On Jul 31, 2020, at 10:51 AM, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> >> 
> >> https://stackoverflow.com/questions/34627874/c11-container-of-unique-ptr-of-forward-declared-class
> >> 
> >> On Fri, Jul 31, 2020 at 12:26 PM Paul Ramsey <pramsey at cleverelephant.ca> wrote:
> >> We've got a CI failure in MSVC and it's totally opaque. Anyone have a MSVC build environment and ability to look at what's up?
> >> 
> >> https://dev.azure.com/libgeos/geos/_build/results?buildId=585&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96
> >> 
> >> Thanks!
> >> 
> >> P
> >> _______________________________________________
> >> geos-devel mailing list
> >> geos-devel at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/geos-devel
> >> 
> >> 
> >> -- 
> >> Andrew Bell
> >> andrew.bell.ia at gmail.com
> >> _______________________________________________
> >> geos-devel mailing list
> >> geos-devel at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/geos-devel
> > 
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel
> 
> 
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel


From andrew.bell.ia at gmail.com  Sun Aug  2 16:04:15 2020
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Sun, 2 Aug 2020 19:04:15 -0400
Subject: [geos-devel] VS Studio Help?
In-Reply-To: <35CBA724-A44D-4CF0-9512-051DFA3BD9A0@cleverelephant.ca>
References: <C1726F2C-765B-4701-B239-25B301B5811A@cleverelephant.ca>
 <CACJ51z1GdzZP-ZwNPj49zydV2=Vk_eDWv1ZyRyykrZmaVQ-9og@mail.gmail.com>
 <706623DD-C680-4617-BFA5-B66B342E52FF@cleverelephant.ca>
 <71E30459-8299-465C-9C49-CFAA76DC7B8D@cleverelephant.ca>
 <CACJ51z31UM8XPx3bkWfcdEOyS9oYtTH7LhstXuMOfU_c=eH8Qg@mail.gmail.com>
 <35CBA724-A44D-4CF0-9512-051DFA3BD9A0@cleverelephant.ca>
Message-ID: <CACJ51z1hLy39fu17s5=zyPkbx9SZrgQyaJWq_OnepYLC4XLqpw@mail.gmail.com>

I've got this fixed. I'll push something tomorrow.

On Sun, Aug 2, 2020 at 1:23 PM Paul Ramsey <pramsey at cleverelephant.ca>
wrote:

> Bringing in the namespace did not seem to be the trick.
>
>
> https://dev.azure.com/libgeos/geos/_build/results?buildId=596&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=1064
>
>
> https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65
>
> Still mysterious to me.
>
> P
>
> > On Jul 31, 2020, at 2:03 PM, Andrew Bell <andrew.bell.ia at gmail.com>
> wrote:
> >
> > The CoordinateSequence there doesn't appear to be in the correct
> namespace. Seems like you would need geom::CoordinateSequence.
> >
> > On Fri, Jul 31, 2020 at 3:34 PM Paul Ramsey <pramsey at cleverelephant.ca>
> wrote:
> > Er, here's the line it's complaining about.
> >
> >
> https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65
> >
> > > On Jul 31, 2020, at 12:27 PM, Paul Ramsey <pramsey at cleverelephant.ca>
> wrote:
> > >
> > > That maybe was a lot of them? I put actual headers into place where a
> std::vector<std::unique_ptr<>> was being declared, but I'm still left with
> > >
> > >
> https://dev.azure.com/libgeos/geos/_build/results?buildId=591&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=156
> > >
> > > and a handful of others. The error seems the same, but I've already
> brought in the class defn, not sure what else to do...
> > >
> > > P
> > >
> > >> On Jul 31, 2020, at 10:51 AM, Andrew Bell <andrew.bell.ia at gmail.com>
> wrote:
> > >>
> > >>
> https://stackoverflow.com/questions/34627874/c11-container-of-unique-ptr-of-forward-declared-class
> > >>
> > >> On Fri, Jul 31, 2020 at 12:26 PM Paul Ramsey <
> pramsey at cleverelephant.ca> wrote:
> > >> We've got a CI failure in MSVC and it's totally opaque. Anyone have a
> MSVC build environment and ability to look at what's up?
> > >>
> > >>
> https://dev.azure.com/libgeos/geos/_build/results?buildId=585&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96
> > >>
> > >> Thanks!
> > >>
> > >> P
> > >> _______________________________________________
> > >> geos-devel mailing list
> > >> geos-devel at lists.osgeo.org
> > >> https://lists.osgeo.org/mailman/listinfo/geos-devel
> > >>
> > >>
> > >> --
> > >> Andrew Bell
> > >> andrew.bell.ia at gmail.com
> > >> _______________________________________________
> > >> geos-devel mailing list
> > >> geos-devel at lists.osgeo.org
> > >> https://lists.osgeo.org/mailman/listinfo/geos-devel
> > >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> >
> > --
> > Andrew Bell
> > andrew.bell.ia at gmail.com
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200802/7679444e/attachment.html>

From rmrodriguez at carto.com  Mon Aug  3 10:18:56 2020
From: rmrodriguez at carto.com (rmrodriguez at carto.com)
Date: Mon, 3 Aug 2020 19:18:56 +0200
Subject: [geos-devel] overlay-sr merged to master
In-Reply-To: <CAK2ens2ASTnNsGzTDWZ7M0Y10jhGrry1Eh7C-AKUbwtNk-Qc3w@mail.gmail.com>
References: <30A6EBB1-63D2-43A8-8733-EA819EB9465B@cleverelephant.ca>
 <005501d6653b$f5d8cbb0$e18a6310$@pcorp.us>
 <CAM6_UM7f6egzCGrkkd92bGWJhhdhQ_Xm1ph7pmjdDi=OjXx0=Q@mail.gmail.com>
 <CAK2ens2ASTnNsGzTDWZ7M0Y10jhGrry1Eh7C-AKUbwtNk-Qc3w@mail.gmail.com>
Message-ID: <CAM6_UM5XQsCdxdQGpe+1QWn0k6-pKpTZeMm23fj5bcPXPzO7QA@mail.gmail.com>

I've been doing some tests today and opened a couple of tickets
related to issues with intersections.

I'm not sure how interesting they are right now as I haven't checked
for validity, but I've run the default tile generation performance
test (full tiler) to compare the performance between the new and old
overlay generations (attached doc).

The MVT tests are using the GEOS backend, which is still much slower
than wagyu (5-10x in the slow cases, which are huge polygons in low
level zooms) but there are some really nice improvements there (see
`[MVT] Canada [...]` tests). It is possible that those cases are slow
because they need to call makeValid because the call to Intersection
fails or because new points are added outside the MVT precision, but
the only way to check is to add logging and check specific tiles. In
any case, I've only used the GEOS C API, which AFAIK doesn't yet
provide control over the precision.

There are other tests that have slowed down a bit but I haven't looked
into any of them at this point.

-- 
Raúl Marín Rodríguez
carto.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: old_geos_nowagyu_vs_overnlayng_nowagyu.pdf
Type: application/pdf
Size: 648537 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200803/7bdcca54/attachment-0001.pdf>

From mtnclimb at gmail.com  Mon Aug  3 11:48:02 2020
From: mtnclimb at gmail.com (Martin Davis)
Date: Mon, 3 Aug 2020 11:48:02 -0700
Subject: [geos-devel] Test OverlayNG for MVT tiling
In-Reply-To: <CAM6_UM5XQsCdxdQGpe+1QWn0k6-pKpTZeMm23fj5bcPXPzO7QA@mail.gmail.com>
References: <30A6EBB1-63D2-43A8-8733-EA819EB9465B@cleverelephant.ca>
 <005501d6653b$f5d8cbb0$e18a6310$@pcorp.us>
 <CAM6_UM7f6egzCGrkkd92bGWJhhdhQ_Xm1ph7pmjdDi=OjXx0=Q@mail.gmail.com>
 <CAK2ens2ASTnNsGzTDWZ7M0Y10jhGrry1Eh7C-AKUbwtNk-Qc3w@mail.gmail.com>
 <CAM6_UM5XQsCdxdQGpe+1QWn0k6-pKpTZeMm23fj5bcPXPzO7QA@mail.gmail.com>
Message-ID: <CAK2ens1OLn6=AE_nHQe83OoYdxaPWDaDfWYZOUNjZptGHdeH3Q@mail.gmail.com>

Great that you're testing this.

Yes, currently the precision is not exposed via the C API (well, I think it
is technically, by setting the geometry precision model, but this involves
an expensive (and unnecessary) precision reduction step, so that's useless
for performance.

My hope is that the C API will expose overlay operations which take an
explicit precision (scale factor = 1 / grid size). This will invoke
snap-rounding, which should provide fully-robust rounded geometry - ideal
for clipping to low-resolution tiles - I hope!


On Mon, Aug 3, 2020 at 10:19 AM <rmrodriguez at carto.com> wrote:

> I've been doing some tests today and opened a couple of tickets
> related to issues with intersections.
>
> I'm not sure how interesting they are right now as I haven't checked
> for validity, but I've run the default tile generation performance
> test (full tiler) to compare the performance between the new and old
> overlay generations (attached doc).
>
> The MVT tests are using the GEOS backend, which is still much slower
> than wagyu (5-10x in the slow cases, which are huge polygons in low
> level zooms) but there are some really nice improvements there (see
> `[MVT] Canada [...]` tests). It is possible that those cases are slow
> because they need to call makeValid because the call to Intersection
> fails or because new points are added outside the MVT precision, but
> the only way to check is to add logging and check specific tiles. In
> any case, I've only used the GEOS C API, which AFAIK doesn't yet
> provide control over the precision.
>
> There are other tests that have slowed down a bit but I haven't looked
> into any of them at this point.
>
> --
> Raúl Marín Rodríguez
> carto.com
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200803/4f0f02c3/attachment.html>

From pramsey at cleverelephant.ca  Mon Aug  3 19:41:29 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon, 3 Aug 2020 19:41:29 -0700
Subject: [geos-devel] VS Studio Help?
In-Reply-To: <CACJ51z1hLy39fu17s5=zyPkbx9SZrgQyaJWq_OnepYLC4XLqpw@mail.gmail.com>
References: <C1726F2C-765B-4701-B239-25B301B5811A@cleverelephant.ca>
 <CACJ51z1GdzZP-ZwNPj49zydV2=Vk_eDWv1ZyRyykrZmaVQ-9og@mail.gmail.com>
 <706623DD-C680-4617-BFA5-B66B342E52FF@cleverelephant.ca>
 <71E30459-8299-465C-9C49-CFAA76DC7B8D@cleverelephant.ca>
 <CACJ51z31UM8XPx3bkWfcdEOyS9oYtTH7LhstXuMOfU_c=eH8Qg@mail.gmail.com>
 <35CBA724-A44D-4CF0-9512-051DFA3BD9A0@cleverelephant.ca>
 <CACJ51z1hLy39fu17s5=zyPkbx9SZrgQyaJWq_OnepYLC4XLqpw@mail.gmail.com>
Message-ID: <CACowWR2-XSVoEHKM8TH3=a2NZJa-MFPQFP9gY_4OUroYBgm5-A@mail.gmail.com>

Thank you!!!
I see this pattern in other parts of the code base, I just never understood
it.

On Sun, Aug 2, 2020 at 4:04 PM Andrew Bell <andrew.bell.ia at gmail.com> wrote:

> I've got this fixed. I'll push something tomorrow.
>
> On Sun, Aug 2, 2020 at 1:23 PM Paul Ramsey <pramsey at cleverelephant.ca>
> wrote:
>
>> Bringing in the namespace did not seem to be the trick.
>>
>>
>> https://dev.azure.com/libgeos/geos/_build/results?buildId=596&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=1064
>>
>>
>> https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65
>>
>> Still mysterious to me.
>>
>> P
>>
>> > On Jul 31, 2020, at 2:03 PM, Andrew Bell <andrew.bell.ia at gmail.com>
>> wrote:
>> >
>> > The CoordinateSequence there doesn't appear to be in the correct
>> namespace. Seems like you would need geom::CoordinateSequence.
>> >
>> > On Fri, Jul 31, 2020 at 3:34 PM Paul Ramsey <pramsey at cleverelephant.ca>
>> wrote:
>> > Er, here's the line it's complaining about.
>> >
>> >
>> https://github.com/libgeos/geos/blob/master/include/geos/operation/overlayng/OverlayGraph.h#L65
>> >
>> > > On Jul 31, 2020, at 12:27 PM, Paul Ramsey <pramsey at cleverelephant.ca>
>> wrote:
>> > >
>> > > That maybe was a lot of them? I put actual headers into place where a
>> std::vector<std::unique_ptr<>> was being declared, but I'm still left with
>> > >
>> > >
>> https://dev.azure.com/libgeos/geos/_build/results?buildId=591&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96&l=156
>> > >
>> > > and a handful of others. The error seems the same, but I've already
>> brought in the class defn, not sure what else to do...
>> > >
>> > > P
>> > >
>> > >> On Jul 31, 2020, at 10:51 AM, Andrew Bell <andrew.bell.ia at gmail.com>
>> wrote:
>> > >>
>> > >>
>> https://stackoverflow.com/questions/34627874/c11-container-of-unique-ptr-of-forward-declared-class
>> > >>
>> > >> On Fri, Jul 31, 2020 at 12:26 PM Paul Ramsey <
>> pramsey at cleverelephant.ca> wrote:
>> > >> We've got a CI failure in MSVC and it's totally opaque. Anyone have
>> a MSVC build environment and ability to look at what's up?
>> > >>
>> > >>
>> https://dev.azure.com/libgeos/geos/_build/results?buildId=585&view=logs&j=305851a9-a7bb-55db-0042-7e2b6f48aa1c&t=7382dcd6-bc22-5ed4-59fb-7b403df8dc96
>> > >>
>> > >> Thanks!
>> > >>
>> > >> P
>> > >> _______________________________________________
>> > >> geos-devel mailing list
>> > >> geos-devel at lists.osgeo.org
>> > >> https://lists.osgeo.org/mailman/listinfo/geos-devel
>> > >>
>> > >>
>> > >> --
>> > >> Andrew Bell
>> > >> andrew.bell.ia at gmail.com
>> > >> _______________________________________________
>> > >> geos-devel mailing list
>> > >> geos-devel at lists.osgeo.org
>> > >> https://lists.osgeo.org/mailman/listinfo/geos-devel
>> > >
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> >
>> > --
>> > Andrew Bell
>> > andrew.bell.ia at gmail.com
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200803/21a3ca97/attachment.html>

From geos-trac at osgeo.org  Wed Aug  5 05:48:24 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 05 Aug 2020 12:48:24 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.a340f5940954c7b4e4a479b33452686d@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by jorisvandenbossche):

 What are the thoughts about adding this special case to GEOS?
 I think it would be good to have consistency in reading vs writing in
 GOES, and enable a full roundtrip.

 Further, PostGIS does this as well, and I think Shapely/PyGEOS would like
 to do this as well (in which case they need to add a special case on top
 of their usage of GEOS if it is not changed in GEOS itself).

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Wed Aug  5 07:29:09 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 05 Aug 2020 14:29:09 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.215f9efdf0a9b255b09e118f0326925d@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by mdavis):

 +1, especially since this was recently
 [https://github.com/locationtech/jts/pull/567 fixed] in JTS.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Thu Aug  6 13:08:26 2020
From: strk at kbt.io (Sandro Santilli)
Date: Thu, 6 Aug 2020 22:08:26 +0200
Subject: [geos-devel] OverlayNG for Testing
In-Reply-To: <53809BA2-C9A2-454B-AB77-22DABBD19E23@cleverelephant.ca>
References: <5422276B-2D6C-406F-9879-3A14AD9B2F6E@cleverelephant.ca>
 <CAK2ens2c84RwF5EgbipEja1UFN9oJzU-RG3k+XLdA8xgak5VLw@mail.gmail.com>
 <CA+K_q_qDO28C00mWV+9taKbxhhKYPaz+7PSSb9Yz3uD_H9OOiw@mail.gmail.com>
 <CAB28Asg=LkMCcC89bbENNLwHV3nJdXV6D8ATEhnSaqVv6uVRBQ@mail.gmail.com>
 <53809BA2-C9A2-454B-AB77-22DABBD19E23@cleverelephant.ca>
Message-ID: <20200806185348.GB22960@lif>

On Thu, Jul 30, 2020 at 06:04:11PM -0700, Paul Ramsey wrote:

> On a similar note, Martin has recovered the old behaviour for linstrings in overlays so we should be able to be back-compatible there too. As with the collections, there's an existing mechanism to get "nicer" behaviour already, the ST_Linemerge function. 
> 
> My hope is that, if we do these pieces to get old semantics, we will just be left with adding in the Z handling and be very very close to original semantics, enough so that we can stamp it 3.9 instead of 4.0. I love backwards compatibility on principle.

Do you have an updated list of tasks to complete to get backward
compatibility in place ? I probably have the possibility to work
on some of them.

--strk;

From pramsey at cleverelephant.ca  Thu Aug  6 13:47:56 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu, 6 Aug 2020 13:47:56 -0700
Subject: [geos-devel] OverlayNG for Testing
In-Reply-To: <20200806185348.GB22960@lif>
References: <5422276B-2D6C-406F-9879-3A14AD9B2F6E@cleverelephant.ca>
 <CAK2ens2c84RwF5EgbipEja1UFN9oJzU-RG3k+XLdA8xgak5VLw@mail.gmail.com>
 <CA+K_q_qDO28C00mWV+9taKbxhhKYPaz+7PSSb9Yz3uD_H9OOiw@mail.gmail.com>
 <CAB28Asg=LkMCcC89bbENNLwHV3nJdXV6D8ATEhnSaqVv6uVRBQ@mail.gmail.com>
 <53809BA2-C9A2-454B-AB77-22DABBD19E23@cleverelephant.ca>
 <20200806185348.GB22960@lif>
Message-ID: <DE593522-AE02-4FC3-89FF-FECC96B89552@cleverelephant.ca>

Here's a spreadsheet... 

https://docs.google.com/spreadsheets/d/15Jk5cNuYdxPPA9fXIxCreRJNlkQZjc2KdYaX-odW8So/edit#gid=936876052

It's probably not complete, but it's got the big entries... 

> On Aug 6, 2020, at 1:08 PM, Sandro Santilli <strk at kbt.io> wrote:
> 
> On Thu, Jul 30, 2020 at 06:04:11PM -0700, Paul Ramsey wrote:
> 
>> On a similar note, Martin has recovered the old behaviour for linstrings in overlays so we should be able to be back-compatible there too. As with the collections, there's an existing mechanism to get "nicer" behaviour already, the ST_Linemerge function. 
>> 
>> My hope is that, if we do these pieces to get old semantics, we will just be left with adding in the Z handling and be very very close to original semantics, enough so that we can stamp it 3.9 instead of 4.0. I love backwards compatibility on principle.
> 
> Do you have an updated list of tasks to complete to get backward
> compatibility in place ? I probably have the possibility to work
> on some of them.
> 
> --strk;
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel


From rmrodriguez at carto.com  Fri Aug  7 01:48:03 2020
From: rmrodriguez at carto.com (rmrodriguez at carto.com)
Date: Fri, 7 Aug 2020 10:48:03 +0200
Subject: [geos-devel] OverlayNG for Testing
In-Reply-To: <DE593522-AE02-4FC3-89FF-FECC96B89552@cleverelephant.ca>
References: <5422276B-2D6C-406F-9879-3A14AD9B2F6E@cleverelephant.ca>
 <CAK2ens2c84RwF5EgbipEja1UFN9oJzU-RG3k+XLdA8xgak5VLw@mail.gmail.com>
 <CA+K_q_qDO28C00mWV+9taKbxhhKYPaz+7PSSb9Yz3uD_H9OOiw@mail.gmail.com>
 <CAB28Asg=LkMCcC89bbENNLwHV3nJdXV6D8ATEhnSaqVv6uVRBQ@mail.gmail.com>
 <53809BA2-C9A2-454B-AB77-22DABBD19E23@cleverelephant.ca>
 <20200806185348.GB22960@lif>
 <DE593522-AE02-4FC3-89FF-FECC96B89552@cleverelephant.ca>
Message-ID: <CAM6_UM71aOv9YHGqNpEbppCba1ECqQjpgTYh0LxKJfewsTC_Yg@mail.gmail.com>

Hi there,

> It's probably not complete, but it's got the big entries...

I reported a couple of issues on GEOS trac. Is that good or is there a
more convenient place to track OverlayNG issues?

On Thu, Aug 6, 2020 at 10:48 PM Paul Ramsey <pramsey at cleverelephant.ca> wrote:
>
> Here's a spreadsheet...
>
> https://docs.google.com/spreadsheets/d/15Jk5cNuYdxPPA9fXIxCreRJNlkQZjc2KdYaX-odW8So/edit#gid=936876052
>
> It's probably not complete, but it's got the big entries...
>
> > On Aug 6, 2020, at 1:08 PM, Sandro Santilli <strk at kbt.io> wrote:
> >
> > On Thu, Jul 30, 2020 at 06:04:11PM -0700, Paul Ramsey wrote:
> >
> >> On a similar note, Martin has recovered the old behaviour for linstrings in overlays so we should be able to be back-compatible there too. As with the collections, there's an existing mechanism to get "nicer" behaviour already, the ST_Linemerge function.
> >>
> >> My hope is that, if we do these pieces to get old semantics, we will just be left with adding in the Z handling and be very very close to original semantics, enough so that we can stamp it 3.9 instead of 4.0. I love backwards compatibility on principle.
> >
> > Do you have an updated list of tasks to complete to get backward
> > compatibility in place ? I probably have the possibility to work
> > on some of them.
> >
> > --strk;
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel



-- 
Raúl Marín Rodríguez
carto.com

From geos-trac at osgeo.org  Fri Aug  7 11:27:55 2020
From: geos-trac at osgeo.org (GEOS)
Date: Fri, 07 Aug 2020 18:27:55 -0000
Subject: [geos-devel] [GEOS] #1041: Port DBSCAN clustering from PostGIS
Message-ID: <045.b4518afaae1beb0857e1ced178171fc8@osgeo.org>

#1041: Port DBSCAN clustering from PostGIS
-------------------------+--------------------------
 Reporter:  dericke      |      Owner:  geos-devel@…
     Type:  enhancement  |     Status:  new
 Priority:  major        |  Milestone:
Component:  Default      |    Version:  3.8.0
 Severity:  Unassigned   |   Keywords:
-------------------------+--------------------------
 I've been finding PostGIS' ST_ClusterDBSCAN and ST_ClusterIntersecting
 functions tremendously useful; they're the only clustering implementation
 I'm aware of that can aggregate interconnected line networks. Would it be
 feasible to port them into GEOS so that they could eventually be available
 in other downstream projects, like QGIS, Shapely and GeoPandas?

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1041>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Fri Aug  7 12:22:42 2020
From: geos-trac at osgeo.org (GEOS)
Date: Fri, 07 Aug 2020 19:22:42 -0000
Subject: [geos-devel] [GEOS] #1041: Port DBSCAN clustering from PostGIS
In-Reply-To: <045.b4518afaae1beb0857e1ced178171fc8@osgeo.org>
References: <045.b4518afaae1beb0857e1ced178171fc8@osgeo.org>
Message-ID: <060.fb6b7bc9cefeed3062640e6524aea7f4@osgeo.org>

#1041: Port DBSCAN clustering from PostGIS
-------------------------+---------------------------
 Reporter:  dericke      |       Owner:  geos-devel@…
     Type:  enhancement  |      Status:  new
 Priority:  major        |   Milestone:
Component:  Default      |     Version:  3.8.0
 Severity:  Unassigned   |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by dbaston):

 Definitely possible. Work-in-progress (mostly done?) here:
 https://github.com/dbaston/libgeos/commit/50717e04e719e988fde8b6368c5a7316df6c770a

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1041#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From pramsey at cleverelephant.ca  Fri Aug  7 16:36:28 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri, 7 Aug 2020 16:36:28 -0700
Subject: [geos-devel] OverlayNG for Testing
In-Reply-To: <DE593522-AE02-4FC3-89FF-FECC96B89552@cleverelephant.ca>
References: <5422276B-2D6C-406F-9879-3A14AD9B2F6E@cleverelephant.ca>
 <CAK2ens2c84RwF5EgbipEja1UFN9oJzU-RG3k+XLdA8xgak5VLw@mail.gmail.com>
 <CA+K_q_qDO28C00mWV+9taKbxhhKYPaz+7PSSb9Yz3uD_H9OOiw@mail.gmail.com>
 <CAB28Asg=LkMCcC89bbENNLwHV3nJdXV6D8ATEhnSaqVv6uVRBQ@mail.gmail.com>
 <53809BA2-C9A2-454B-AB77-22DABBD19E23@cleverelephant.ca>
 <20200806185348.GB22960@lif>
 <DE593522-AE02-4FC3-89FF-FECC96B89552@cleverelephant.ca>
Message-ID: <CACowWR1d_zGrkGKykjAvOc3ZkEMs2srkzrKZicP9JC0dB87P2Q@mail.gmail.com>

So, with the last two commits

https://github.com/libgeos/geos/commit/aaafcce2
https://github.com/pramsey/geos/commit/8e340a77322445669bbffc5d6b9bf4d01b676a5a

We (haha, mostly Martin) have restored the old Linstring.Union() behaviour
(node-to-node lines extracted from graph) and the old
Geometry.Intersection() behaviour (all dimensional components extracted
from graph into GeometryCollection).

This should substantially reduce the number of regression issues when
building with the NG overlay turned on. As before I haven't actually tested
this myself yet, it's the end of the day, but I have high hopes.

We still have the known regression that Z values aren't going to be
added/preserved in 2d/3d and 3d/3d overlays.

Thank you Andrew Bell for the fixes to master to pass MSVC builds now too.

Next week, continued testing on regressions from me. Martin is away.

P.


On Thu, Aug 6, 2020 at 1:47 PM Paul Ramsey <pramsey at cleverelephant.ca>
wrote:

> Here's a spreadsheet...
>
>
> https://docs.google.com/spreadsheets/d/15Jk5cNuYdxPPA9fXIxCreRJNlkQZjc2KdYaX-odW8So/edit#gid=936876052
>
> It's probably not complete, but it's got the big entries...
>
> > On Aug 6, 2020, at 1:08 PM, Sandro Santilli <strk at kbt.io> wrote:
> >
> > On Thu, Jul 30, 2020 at 06:04:11PM -0700, Paul Ramsey wrote:
> >
> >> On a similar note, Martin has recovered the old behaviour for
> linstrings in overlays so we should be able to be back-compatible there
> too. As with the collections, there's an existing mechanism to get "nicer"
> behaviour already, the ST_Linemerge function.
> >>
> >> My hope is that, if we do these pieces to get old semantics, we will
> just be left with adding in the Z handling and be very very close to
> original semantics, enough so that we can stamp it 3.9 instead of 4.0. I
> love backwards compatibility on principle.
> >
> > Do you have an updated list of tasks to complete to get backward
> > compatibility in place ? I probably have the possibility to work
> > on some of them.
> >
> > --strk;
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200807/9f52f90c/attachment.html>

From geos-trac at osgeo.org  Tue Aug 11 12:47:37 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 11 Aug 2020 19:47:37 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.6f2d4cb87b8f4f362e8ef89fea2d221d@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by Paul Ramsey <pramsey@…>):

 In [changeset:"466cff135c8e504632ae38b79a1348dbadb390f1/git" 466cff1/git]:
 {{{
 #!CommitTicketReference repository="git"
 revision="466cff135c8e504632ae38b79a1348dbadb390f1"
 Output POINT EMPTY in WKB. References #1005
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:4>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 11 12:48:01 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 11 Aug 2020 19:48:01 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.a671da2002da46e18f396b9766c8685a@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------
Changes (by pramsey):

 * status:  new => closed
 * resolution:   => fixed


-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:5>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 11 13:57:34 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 11 Aug 2020 20:57:34 -0000
Subject: [geos-devel] [GEOS] #718: Port InteriorIntersectionFinder
 improvements from JTS
In-Reply-To: <042.c98d58977bf1f66db6bb79e74e6727f3@osgeo.org>
References: <042.c98d58977bf1f66db6bb79e74e6727f3@osgeo.org>
Message-ID: <057.b00c2eeb045655fe69bafb02c7f539cc@osgeo.org>

#718: Port InteriorIntersectionFinder improvements from JTS
-------------------------+---------------------------
 Reporter:  strk         |       Owner:  geos-devel@…
     Type:  enhancement  |      Status:  closed
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  master
 Severity:  Unassigned   |  Resolution:  invalid
 Keywords:               |
-------------------------+---------------------------
Changes (by pramsey):

 * status:  new => closed
 * resolution:   => invalid


Comment:

 The InteriorIntersectionFinderAdder only seems to be used in the
 MCIndexSnapRounder which in turn is used almost nowhere. This code line
 seems to have died out. The new snap rounder for overlayng will likely
 form the basis for any future snap rounding code in JTS and GEOS.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/718#comment:6>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 11 14:34:31 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 11 Aug 2020 21:34:31 -0000
Subject: [geos-devel] [GEOS] #1036: GeomDifference with Overlay turned
 on goes into infinite look in PostGIS ST_WrapX
In-Reply-To: <042.45ca84b56bd5c596ea368b4b982408d7@osgeo.org>
References: <042.45ca84b56bd5c596ea368b4b982408d7@osgeo.org>
Message-ID: <057.7a35343329c5e4090ea832dbff425dd2@osgeo.org>

#1036: GeomDifference with Overlay turned on goes into infinite look in PostGIS
ST_WrapX
------------------------+---------------------------
 Reporter:  robe        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  blocker     |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by pramsey):

 Check against current master, this should be gone now.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1036#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From pramsey at cleverelephant.ca  Tue Aug 11 15:06:00 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Tue, 11 Aug 2020 15:06:00 -0700
Subject: [geos-devel] Inlines?
Message-ID: <EB9F14AB-A39A-4E72-BE7E-EAFE2610B727@cleverelephant.ca>

Can anyone shed some light on our inlining strategy? It seems really... odd. 
Like picked at random, in ConvexHull, the following methods are inlined if GEOS_INLINE is on (it is by default).

ConvexHull::ConvexHull(const geom::Geometry* newGeometry)
ConvexHull::~ConvexHull()
ConvexHull::extractCoordinates(const geom::Geometry* geom)

Now... none of these feel like they are particularly hot path to me. The constructor, destructor, and a private utilty method.
I ask mostly because there's a lot of this .inl stuff scattered around and it doesn't seem particularly helpful.
If there's some history I'd be intrigued to know.
P

From geos-trac at osgeo.org  Tue Aug 11 16:33:45 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 11 Aug 2020 23:33:45 -0000
Subject: [geos-devel] [GEOS] #1036: GeomDifference with Overlay turned
 on goes into infinite look in PostGIS ST_WrapX
In-Reply-To: <042.45ca84b56bd5c596ea368b4b982408d7@osgeo.org>
References: <042.45ca84b56bd5c596ea368b4b982408d7@osgeo.org>
Message-ID: <057.ae830bf3c3aea89062375f00c0a3183c@osgeo.org>

#1036: GeomDifference with Overlay turned on goes into infinite look in PostGIS
ST_WrapX
------------------------+---------------------------
 Reporter:  robe        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  blocker     |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------
Changes (by robe):

 * status:  new => closed
 * resolution:   => fixed


Comment:

 yap no more crashing.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1036#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 11 22:35:17 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 12 Aug 2020 05:35:17 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.3a6731096d7d9948746960349d434170@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------

Comment (by Mike Taves):

 Just tested master, and I see `POINT EMPTY` ->
 `0101000080000000000000F87F000000000000F87F000000000000F87F` -> `POINT Z
 EMPTY`, which is a bit of a surprise. Three-dimensional empty geometries
 are getting really abstract. Could this just be WKB for `POINT EMPTY`?

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:6>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 11 23:07:01 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 12 Aug 2020 06:07:01 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.1dbee06f60bc9d4d33e5c44b2d15069b@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------

Comment (by Mike Taves):

 With `POINT EMPTY`, `GEOSGeom_getCoordinateDimension` is currently
 returning 3.

 With `MULTIPOINT EMPTY` this is 2, not 3.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:7>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Wed Aug 12 02:52:41 2020
From: strk at kbt.io (Sandro Santilli)
Date: Wed, 12 Aug 2020 11:52:41 +0200
Subject: [geos-devel] Inlines?
In-Reply-To: <EB9F14AB-A39A-4E72-BE7E-EAFE2610B727@cleverelephant.ca>
References: <EB9F14AB-A39A-4E72-BE7E-EAFE2610B727@cleverelephant.ca>
Message-ID: <20200812095241.GB4419@lif>

On Tue, Aug 11, 2020 at 03:06:00PM -0700, Paul Ramsey wrote:
> Can anyone shed some light on our inlining strategy? It seems really... odd. 
> Like picked at random, in ConvexHull, the following methods are inlined if GEOS_INLINE is on (it is by default).
> 
> ConvexHull::ConvexHull(const geom::Geometry* newGeometry)
> ConvexHull::~ConvexHull()
> ConvexHull::extractCoordinates(const geom::Geometry* geom)
> 
> Now... none of these feel like they are particularly hot path to me. The constructor, destructor, and a private utilty method.
> I ask mostly because there's a lot of this .inl stuff scattered around and it doesn't seem particularly helpful.
> If there's some history I'd be intrigued to know.

I can't remember why those things ended up in .inl.
I guess destructors were there to try at debugging some issues
with virtual tables not being correct when destructors were inlined
(so to turn inlining off)

--strk;

From pramsey at cleverelephant.ca  Wed Aug 12 14:24:09 2020
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed, 12 Aug 2020 14:24:09 -0700
Subject: [geos-devel] Inlines?
In-Reply-To: <20200812095241.GB4419@lif>
References: <EB9F14AB-A39A-4E72-BE7E-EAFE2610B727@cleverelephant.ca>
 <20200812095241.GB4419@lif>
Message-ID: <7F657BAA-13FA-43BB-8267-7AD921F4F12D@cleverelephant.ca>



> On Aug 12, 2020, at 2:52 AM, Sandro Santilli <strk at kbt.io> wrote:
> 
> On Tue, Aug 11, 2020 at 03:06:00PM -0700, Paul Ramsey wrote:
>> Can anyone shed some light on our inlining strategy? It seems really... odd. 
>> Like picked at random, in ConvexHull, the following methods are inlined if GEOS_INLINE is on (it is by default).
>> 
>> ConvexHull::ConvexHull(const geom::Geometry* newGeometry)
>> ConvexHull::~ConvexHull()
>> ConvexHull::extractCoordinates(const geom::Geometry* geom)
>> 
>> Now... none of these feel like they are particularly hot path to me. The constructor, destructor, and a private utilty method.
>> I ask mostly because there's a lot of this .inl stuff scattered around and it doesn't seem particularly helpful.
>> If there's some history I'd be intrigued to know.
> 
> I can't remember why those things ended up in .inl.
> I guess destructors were there to try at debugging some issues
> with virtual tables not being correct when destructors were inlined
> (so to turn inlining off)

Going back to an old question from mloskot, would it be crazy to just put the inlined functions into the standard header, marked "inline" and use compiler flags to turn off inling if we so desire? Maybe things work better now than they did ~2007 when you laid this structure out?

P.



From andrew.bell.ia at gmail.com  Wed Aug 12 16:36:57 2020
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 12 Aug 2020 19:36:57 -0400
Subject: [geos-devel] Inlines?
In-Reply-To: <7F657BAA-13FA-43BB-8267-7AD921F4F12D@cleverelephant.ca>
References: <EB9F14AB-A39A-4E72-BE7E-EAFE2610B727@cleverelephant.ca>
 <20200812095241.GB4419@lif>
 <7F657BAA-13FA-43BB-8267-7AD921F4F12D@cleverelephant.ca>
Message-ID: <CACJ51z3hgdo3t1g7FhYBibPBvSKt39Wx2mc7W9YgaFNrC83-Hg@mail.gmail.com>

Unless you're dealing with templates or some functions that are important
to let the compiler inline so that it can "see" more code, I would just put
things in the .cpp file. Functions like accessors that are used frequently
should definitely be made available for inlining.

On Wed, Aug 12, 2020, 5:54 PM Paul Ramsey <pramsey at cleverelephant.ca> wrote:

>
>
> > On Aug 12, 2020, at 2:52 AM, Sandro Santilli <strk at kbt.io> wrote:
> >
> > On Tue, Aug 11, 2020 at 03:06:00PM -0700, Paul Ramsey wrote:
> >> Can anyone shed some light on our inlining strategy? It seems really...
> odd.
> >> Like picked at random, in ConvexHull, the following methods are inlined
> if GEOS_INLINE is on (it is by default).
> >>
> >> ConvexHull::ConvexHull(const geom::Geometry* newGeometry)
> >> ConvexHull::~ConvexHull()
> >> ConvexHull::extractCoordinates(const geom::Geometry* geom)
> >>
> >> Now... none of these feel like they are particularly hot path to me.
> The constructor, destructor, and a private utilty method.
> >> I ask mostly because there's a lot of this .inl stuff scattered around
> and it doesn't seem particularly helpful.
> >> If there's some history I'd be intrigued to know.
> >
> > I can't remember why those things ended up in .inl.
> > I guess destructors were there to try at debugging some issues
> > with virtual tables not being correct when destructors were inlined
> > (so to turn inlining off)
>
> Going back to an old question from mloskot, would it be crazy to just put
> the inlined functions into the standard header, marked "inline" and use
> compiler flags to turn off inling if we so desire? Maybe things work better
> now than they did ~2007 when you laid this structure out?
>
> P.
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200812/7d037ea2/attachment.html>

From geos-trac at osgeo.org  Thu Aug 13 08:50:23 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 13 Aug 2020 15:50:23 -0000
Subject: [geos-devel] [GEOS] #876: rgeos::writeWKT() pass polygon
 direction as parameter
In-Reply-To: <048.ec0407fefc3a6b0f055bf25fa015b32b@osgeo.org>
References: <048.ec0407fefc3a6b0f055bf25fa015b32b@osgeo.org>
Message-ID: <063.f6e7025a81196c2edfabc7a9287faebe@osgeo.org>

#876: rgeos::writeWKT() pass polygon direction as parameter
-----------------------------+---------------------------
 Reporter:  dennisguse       |       Owner:  geos-devel@…
     Type:  enhancement      |      Status:  new
 Priority:  minor            |   Milestone:  3.9.0
Component:  Default          |     Version:  3.6.2
 Severity:  Feature Request  |  Resolution:
 Keywords:  WKT              |
-----------------------------+---------------------------

Comment (by pramsey):

 I'm going to close this out, since GEOSNormalize() already exists, and
 forces CCW orientation onto rings.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/876#comment:5>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 13 10:01:01 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 13 Aug 2020 17:01:01 -0000
Subject: [geos-devel] [GEOS] #876: rgeos::writeWKT() pass polygon
 direction as parameter
In-Reply-To: <048.ec0407fefc3a6b0f055bf25fa015b32b@osgeo.org>
References: <048.ec0407fefc3a6b0f055bf25fa015b32b@osgeo.org>
Message-ID: <063.69dd1f28a288b88775b82a38119caee0@osgeo.org>

#876: rgeos::writeWKT() pass polygon direction as parameter
-----------------------------+---------------------------
 Reporter:  dennisguse       |       Owner:  geos-devel@…
     Type:  enhancement      |      Status:  closed
 Priority:  minor            |   Milestone:  3.9.0
Component:  Default          |     Version:  3.6.2
 Severity:  Feature Request  |  Resolution:  wontfix
 Keywords:  WKT              |
-----------------------------+---------------------------
Changes (by pramsey):

 * status:  new => closed
 * resolution:   => wontfix


-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/876#comment:6>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 13 10:14:18 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 13 Aug 2020 17:14:18 -0000
Subject: [geos-devel] [GEOS] #1017: Add berrie Raspberry Pi 32-bit to
 jenkins bots list
In-Reply-To: <042.5d42db1f1c032fd895d35860151fa936@osgeo.org>
References: <042.5d42db1f1c032fd895d35860151fa936@osgeo.org>
Message-ID: <057.c3520e952bbf5ebbccaf1f5352589482@osgeo.org>

#1017: Add berrie Raspberry Pi 32-bit to jenkins bots list
------------------------+---------------------------
 Reporter:  robe        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------
Changes (by pramsey):

 * status:  new => closed
 * resolution:   => fixed


-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1017#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 13 12:57:18 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 13 Aug 2020 19:57:18 -0000
Subject: [geos-devel] [GEOS] #460: Add 'M' EWKB support to WKBReader
In-Reply-To: <042.547ea3ece3f5062e5144cae999bd0e44@osgeo.org>
References: <042.547ea3ece3f5062e5144cae999bd0e44@osgeo.org>
Message-ID: <057.c92243521591c651c0b8a21739ae8688@osgeo.org>

#460: Add 'M' EWKB support to WKBReader
-------------------------+---------------------------
 Reporter:  strk         |       Owner:  geos-devel@…
     Type:  enhancement  |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  master
 Severity:  Unassigned   |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by Paul Ramsey <pramsey@…>):

 In [changeset:"1d34d2c497786920f69521c77e50620f2efb34a6/git" 1d34d2c/git]:
 {{{
 #!CommitTicketReference repository="git"
 revision="1d34d2c497786920f69521c77e50620f2efb34a6"
 Support reading WKB that includes M coordinates, but do not actually store
 the M (because we have nowhere to store it right now). References #460
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/460#comment:7>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 13 12:58:12 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 13 Aug 2020 19:58:12 -0000
Subject: [geos-devel] [GEOS] #460: Add 'M' EWKB support to WKBReader
In-Reply-To: <042.547ea3ece3f5062e5144cae999bd0e44@osgeo.org>
References: <042.547ea3ece3f5062e5144cae999bd0e44@osgeo.org>
Message-ID: <057.d49b0a65d189a5ca869704648c876722@osgeo.org>

#460: Add 'M' EWKB support to WKBReader
-------------------------+---------------------------
 Reporter:  strk         |       Owner:  geos-devel@…
     Type:  enhancement  |      Status:  closed
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  master
 Severity:  Unassigned   |  Resolution:  fixed
 Keywords:               |
-------------------------+---------------------------
Changes (by pramsey):

 * status:  new => closed
 * resolution:   => fixed


-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/460#comment:8>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 16 22:56:51 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 05:56:51 -0000
Subject: [geos-devel] [GEOS] #1042: Segfault on multipolygon
Message-ID: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>

#1042: Segfault on multipolygon
------------------------+--------------------------
 Reporter:  stefgis     |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  minor       |  Milestone:
Component:  Default     |    Version:  3.8.0
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 A customer of us triggered a segfault (through postgis):

 kernel: [3756240.108588] postgres[17471]: segfault at 0 ip
 00007fc6a56acce7 sp 00007fffffca5090 error 4 in
 libgeos-3.8.0.so[7fc6a5605000+1be000]

 After some debugging this seems related to the way some of their polygons
 are saved in a specific table:

 GEOMETRYCOLLECTION(MULTIPOLYGON(((224480.183 573551.3,224490.982
 573554.021,224493.322 573554.693,224492.601 573557.214,224487.439
 573555.74,224486.357 573559.53,224478.47 573557.287,224480.183
 573551.3))))

 In combination with st_intersecs or st_buffer this leads to a segfault. We
 can reproduce the issue with the following query:

 SELECT link AS id FROM ybak."test_bit_libgeos" WHERE
 ST_dimension(m1g1) IN (2) AND st_isvalid(m1g1)=true AND
 ST_Intersects(ST_Buffer(ST_GeomFromText('POINT(224707.42286981
 573643.1066404)'), 2), m1g1) ORDER BY
 ST_Intersects(ST_Geomfromtext('POINT(224707.42286981 573643.1066404)'),
 m1g1) DESC LIMIT 1;

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1042>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 16 23:03:24 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 06:03:24 -0000
Subject: [geos-devel] [GEOS] #1042: Segfault on multipolygon
In-Reply-To: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
References: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
Message-ID: <060.392baf129b52944fb7d45d5f5a941f8d@osgeo.org>

#1042: Segfault on multipolygon
------------------------+---------------------------
 Reporter:  stefgis     |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  minor       |   Milestone:
Component:  Default     |     Version:  3.8.0
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by stefgis):

 The wkb of the geometry is:

 \001\007\000\000\000\001\000\000\000\001\006\000\000\000\001\000\000\000\001\003\000\000\000\001\000\000\000\010\000\000\000Zd;\337Bo\013A\252\361\322\215\232\201!A\000\000\000\000Do\013AD\213l\347\246\201!A;\337O\215\002o\013Ash\221\355\247\201!A\016-\262\235\327n\013A\333\371~*\250\201!A\356|?5\327n\013A\035Zd;\243\201!A\033/\335$\002o\013A\006\201\225\003\243\201!AR\270\036\205\001o\013Ao\022\203\200\233\201!AZd;\337Bo\013A\252\361\322\215\232\201!A

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1042#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Mon Aug 17 09:45:50 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 17 Aug 2020 18:45:50 +0200
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
	change ?
Message-ID: <20200817164550.GF4738@lif>

Commit 81b2a236abca2d992572ae1d49dd9b44347e1b80 in JTS
renamed all TestFunction*.xml files to TestOverlay*.xml

In order to better track upstream, I think it'd be useful for GEOS to
do the same. Martin: was it really only a rename or did anything else
change ?

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   https://strk.kbt.io/services.html

From strk at kbt.io  Mon Aug 17 10:04:10 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 17 Aug 2020 19:04:10 +0200
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
	change ?
In-Reply-To: <20200817164550.GF4738@lif>
References: <20200817164550.GF4738@lif>
Message-ID: <20200817170410.GG4738@lif>

On Mon, Aug 17, 2020 at 06:45:50PM +0200, Sandro Santilli wrote:
> Commit 81b2a236abca2d992572ae1d49dd9b44347e1b80 in JTS
> renamed all TestFunction*.xml files to TestOverlay*.xml
> 
> In order to better track upstream, I think it'd be useful for GEOS to
> do the same. Martin: was it really only a rename or did anything else
> change ?

I noticed some tests are actually missing from GEOS, like
TestOverlayEmpty. Any reason why we shouldn't port them over ?

--strk;

From strk at kbt.io  Mon Aug 17 10:58:38 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 17 Aug 2020 19:58:38 +0200
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
	change ?
In-Reply-To: <20200817170410.GG4738@lif>
References: <20200817164550.GF4738@lif>
 <20200817170410.GG4738@lif>
Message-ID: <20200817175838.GI4738@lif>

On Mon, Aug 17, 2020 at 07:04:10PM +0200, Sandro Santilli wrote:
> On Mon, Aug 17, 2020 at 06:45:50PM +0200, Sandro Santilli wrote:
> > Commit 81b2a236abca2d992572ae1d49dd9b44347e1b80 in JTS
> > renamed all TestFunction*.xml files to TestOverlay*.xml
> > 
> > In order to better track upstream, I think it'd be useful for GEOS to
> > do the same. Martin: was it really only a rename or did anything else
> > change ?
> 
> I noticed some tests are actually missing from GEOS, like
> TestOverlayEmpty. Any reason why we shouldn't port them over ?

I found out: Empty test was failing.
I've nonetheless done the renaming and the fix for Empty
with commit 264168eeb0f921f0edfc9acab6f12ee5357a15ae

Testsuite passes, for both GEOS and PostGIS.
Hopefully this will help with OverlayNG test comparison.

--strk;

From mtnclimb at gmail.com  Mon Aug 17 11:15:00 2020
From: mtnclimb at gmail.com (Martin Davis)
Date: Mon, 17 Aug 2020 11:15:00 -0700
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
	change ?
In-Reply-To: <20200817164550.GF4738@lif>
References: <20200817164550.GF4738@lif>
Message-ID: <CAK2ens3wzoCHMPS_2cFGWn5LTfUPgHKyucNJX__cRz2UK0aa+Q@mail.gmail.com>

It was just a rename, to better identify what tests are in the files.

Good idea to mirror in GEOS - thanks.

On Mon, Aug 17, 2020 at 9:45 AM Sandro Santilli <strk at kbt.io> wrote:

> Commit 81b2a236abca2d992572ae1d49dd9b44347e1b80 in JTS
> renamed all TestFunction*.xml files to TestOverlay*.xml
>
> In order to better track upstream, I think it'd be useful for GEOS to
> do the same. Martin: was it really only a rename or did anything else
> change ?
>
> --strk;
>
>   ()   Free GIS & Flash consultant/developer
>   /\   https://strk.kbt.io/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200817/79f13641/attachment.html>

From geos-trac at osgeo.org  Mon Aug 17 11:42:07 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 18:42:07 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
Message-ID: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+--------------------------
 Reporter:  strk        |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:  3.9.0
Component:  Default     |    Version:  master
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 A simple test is failing with --overlay-ng. Passes with JTS:

 {{{
         Description: LrL - LinearRing bug
         Geometry A: LINEARRING (0 0, 0 5, 5 5, 5 0, 0 0)
         Geometry B: LINESTRING (2 2, 5 5)
         Expected result: POINT (5 5)
         Obtained result: LINESTRING EMPTY
 }}}

 The test is in the tests/general/TestOverlayLL.xml file

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Mon Aug 17 11:42:53 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 17 Aug 2020 20:42:53 +0200
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
 change ?
In-Reply-To: <CAK2ens3wzoCHMPS_2cFGWn5LTfUPgHKyucNJX__cRz2UK0aa+Q@mail.gmail.com>
References: <20200817164550.GF4738@lif>
 <CAK2ens3wzoCHMPS_2cFGWn5LTfUPgHKyucNJX__cRz2UK0aa+Q@mail.gmail.com>
Message-ID: <20200817184253.GJ4738@lif>

On Mon, Aug 17, 2020 at 11:15:00AM -0700, Martin Davis wrote:
> It was just a rename, to better identify what tests are in the files.
> 
> Good idea to mirror in GEOS - thanks.

The mirroring process currently requires stripping carriage-returns
from the files. Is there a strict policy on carriage-returns in the
JTS source files ?

--strk;

From mtnclimb at gmail.com  Mon Aug 17 11:50:48 2020
From: mtnclimb at gmail.com (Martin Davis)
Date: Mon, 17 Aug 2020 11:50:48 -0700
Subject: [geos-devel] Renaming TestFunction* to TestOverlay as per JTS
 change ?
In-Reply-To: <20200817184253.GJ4738@lif>
References: <20200817164550.GF4738@lif>
 <CAK2ens3wzoCHMPS_2cFGWn5LTfUPgHKyucNJX__cRz2UK0aa+Q@mail.gmail.com>
 <20200817184253.GJ4738@lif>
Message-ID: <CAK2ens1br+BLvrMqz-aOtuYBvLS8YhEPOTPN7hiTyBcMbePjLw@mail.gmail.com>

Ah, no, no particular policy on CRs in JTS files.  Has not been an issue
there so far.

On Mon, Aug 17, 2020 at 11:42 AM Sandro Santilli <strk at kbt.io> wrote:

> On Mon, Aug 17, 2020 at 11:15:00AM -0700, Martin Davis wrote:
> > It was just a rename, to better identify what tests are in the files.
> >
> > Good idea to mirror in GEOS - thanks.
>
> The mirroring process currently requires stripping carriage-returns
> from the files. Is there a strict policy on carriage-returns in the
> JTS source files ?
>
> --strk;
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200817/7e24569d/attachment.html>

From geos-trac at osgeo.org  Mon Aug 17 12:41:42 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 19:41:42 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.a68ef96b2b6a718c768c07325d573702@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 Adding debugging to the OverlayNG GEOS class I'm seeing this graph:
 {{{
 OverlayNG::extractResult: graph: OGRPH
 NODEMAP [2]
  2 2 OE( 2 2 .. 5 5 ) A:e/B:eL / Sym: A:e/B:eL
  5 5 OE( 5 5 .. 2 2 ) A:e/B:eL / Sym: A:e/B:eL
 EDGES [2]
  OE( 2 2 .. 5 5 ) A:e/B:eL / Sym: A:e/B:eL
  OE( 5 5 .. 2 2 ) A:e/B:eL / Sym: A:e/B:eL
 }}}

 The JTS class does not have a toString method, so not sure how to compare
 (should add one).

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Mon Aug 17 12:47:44 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 19:47:44 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.2f361c247f6b7aec5faead1577292249@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 Changing the LINEARRING type to a POLYGON or LINESTRING fixes the test, so
 this seems to be a simple bug which was fixed in old OverlayOP but not the
 new OverlayNG

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Mon Aug 17 12:59:26 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 19:59:26 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.4aead10778efd41daaa4377fdbecdae7@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 OverlayGraph::addEdge is called only once, in GEOS, while it's called 3
 times in JTS. The missing 2 times are for both directions of the
 linearring edge

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Mon Aug 17 13:02:44 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 20:02:44 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.6203192d2d1683f0d1d1c29fa5981825@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 Found the culprit: EdgeNodingBuilder::add, in GEOS, uses getGeometryTypeID
 to decide what to do, and decides to do NOTHING for LineaRing. Instead JTS
 uses an instanceOf operator (like a dynamic cast) which would see
 LinearRing as being an instance of a LINESTRING

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:4>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Mon Aug 17 13:11:05 2020
From: geos-trac at osgeo.org (GEOS)
Date: Mon, 17 Aug 2020 20:11:05 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.f22b38832e45afaf179cf68cefb234ad@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------
Changes (by Sandro Santilli <strk@…>):

 * status:  new => closed
 * resolution:   => fixed


Comment:

 In [changeset:"e6ffc18a8de531f487088e7275a0af9d1d6736bc/git" e6ffc18/git]:
 {{{
 #!CommitTicketReference repository="git"
 revision="e6ffc18a8de531f487088e7275a0af9d1d6736bc"
 [OverlayNG] Fix handling of LinearRing

 Closes #1043
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:5>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Mon Aug 17 13:12:26 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 17 Aug 2020 22:12:26 +0200
Subject: [geos-devel] what happened to my digits ?
Message-ID: <20200817201226.GC164627@lif>

I'm looking at this report from XMLTester and wondering what
happened to output digits:

        Description: AA - sliver triangle, cut by polygon
        Geometry A: POLYGON ((1e+01 1e+01, 1e+02 1e+01, 1e+01 1e+01, 1e+01 1e+01))
        Geometry B: POLYGON ((9e+01 0, 2e+02 0, 2e+02 2e+02, 9e+01 2e+02, 9e+01 0))
        Expected result: LINESTRING (9e+01 1e+01, 1e+02 1e+01)
        Obtained result: POINT (9e+01 1e+01)

You can see the above output is not very useful. I've the impression
we used to have more digits printed, do you remember which commit took
them off ?

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   https://strk.kbt.io/services.html

From mtnclimb at gmail.com  Mon Aug 17 13:45:41 2020
From: mtnclimb at gmail.com (Martin Davis)
Date: Mon, 17 Aug 2020 13:45:41 -0700
Subject: [geos-devel] what happened to my digits ?
In-Reply-To: <20200817201226.GC164627@lif>
References: <20200817201226.GC164627@lif>
Message-ID: <CAK2ens1LQ_NPVQ6GfpMVi42Zn0ZFJmHeKKsm_+KJFa=8j865Eg@mail.gmail.com>

Would it be this one?

https://github.com/libgeos/geos/commit/bacd58058025b25de93fb23bb78ff540ef1e3b63

Paul was having some issues with output precision, but I can't remember the
details.  He made some kind of fix - perhaps this one.

Agreed that the output in sci not for such small numbers is not useful.

On Mon, Aug 17, 2020 at 1:12 PM Sandro Santilli <strk at kbt.io> wrote:

> I'm looking at this report from XMLTester and wondering what
> happened to output digits:
>
>         Description: AA - sliver triangle, cut by polygon
>         Geometry A: POLYGON ((1e+01 1e+01, 1e+02 1e+01, 1e+01 1e+01, 1e+01
> 1e+01))
>         Geometry B: POLYGON ((9e+01 0, 2e+02 0, 2e+02 2e+02, 9e+01 2e+02,
> 9e+01 0))
>         Expected result: LINESTRING (9e+01 1e+01, 1e+02 1e+01)
>         Obtained result: POINT (9e+01 1e+01)
>
> You can see the above output is not very useful. I've the impression
> we used to have more digits printed, do you remember which commit took
> them off ?
>
> --strk;
>
>   ()   Free GIS & Flash consultant/developer
>   /\   https://strk.kbt.io/services.html
> _______________________________________________
> geos-devel mailing list
> geos-devel at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/geos-devel/attachments/20200817/71c495c0/attachment.html>

From geos-trac at osgeo.org  Tue Aug 18 13:10:24 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 18 Aug 2020 20:10:24 -0000
Subject: [geos-devel] [GEOS] #1044: [OverlayNG] general/TestOverlayAA.xml
	fails
Message-ID: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>

#1044: [OverlayNG] general/TestOverlayAA.xml fails
------------------------+--------------------------
 Reporter:  strk        |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:  3.9.0
Component:  Default     |    Version:  master
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 {{{
  Description: AA - A hole close to shell, B coincident with A
  Geometry A: POLYGON ((10 100, 10 10, 100 10, 100 100, 10 100), (90 90, 11
 90, 10 10, 90 11, 90 90))
  Geometry B: POLYGON ((10 30, 10 10, 30 10, 30 30, 10 30))
  Expected result: MULTILINESTRING ((10 10, 30 10), (10 10, 10 30))
  Obtained result: MULTIPOINT (30 10, 10 30)
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1044>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 18 13:10:50 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 18 Aug 2020 20:10:50 -0000
Subject: [geos-devel] [GEOS] #1044: [OverlayNG]
 general/TestOverlayAAPrec.xml fails (was: [OverlayNG]
 general/TestOverlayAA.xml fails)
In-Reply-To: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
References: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
Message-ID: <057.7b8bf112627eda196f59242fc3ab7d34@osgeo.org>

#1044: [OverlayNG] general/TestOverlayAAPrec.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1044#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Tue Aug 18 13:17:42 2020
From: strk at kbt.io (Sandro Santilli)
Date: Tue, 18 Aug 2020 22:17:42 +0200
Subject: [geos-devel] what happened to my digits ?
In-Reply-To: <CAK2ens1LQ_NPVQ6GfpMVi42Zn0ZFJmHeKKsm_+KJFa=8j865Eg@mail.gmail.com>
References: <20200817201226.GC164627@lif>
 <CAK2ens1LQ_NPVQ6GfpMVi42Zn0ZFJmHeKKsm_+KJFa=8j865Eg@mail.gmail.com>
Message-ID: <20200818201742.GH23047@lif>

On Mon, Aug 17, 2020 at 01:45:41PM -0700, Martin Davis wrote:
> Would it be this one?
> 
> https://github.com/libgeos/geos/commit/bacd58058025b25de93fb23bb78ff540ef1e3b63
> 
> Paul was having some issues with output precision, but I can't remember the
> details.  He made some kind of fix - perhaps this one.

Yes, this was the one.

> Agreed that the output in sci not for such small numbers is not useful.

Not really. I'd revert. Look what output we get here, with that commit
reverted:

        Description: AA - A hole close to shell, B coincident with A
        Geometry A: POLYGON ((10 100, 10 10, 100 10, 100 100, 10 100), (90 90, 11 90, 10 10, 90 11, 90 90))
        Geometry B: POLYGON ((10 30, 10 10, 30 10, 30 30, 10 30))
        Expected result: MULTILINESTRING ((10 10, 30 10), (10 10, 10 30))
        Obtained result: MULTIPOINT (30 10, 10 30)

Pretty clear. Now to find out WHY we get the wrong result with
OverlayNG... (JTS passes)

I've filed https://trac.osgeo.org/geos/ticket/1044 to tackle this

--strk;

From geos-trac at osgeo.org  Tue Aug 18 13:17:58 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 18 Aug 2020 20:17:58 -0000
Subject: [geos-devel] [GEOS] #1044: [OverlayNG]
	general/TestOverlayAAPrec.xml fails
In-Reply-To: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
References: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
Message-ID: <057.2a79cd3ced97012e46f003d735b6f544@osgeo.org>

#1044: [OverlayNG] general/TestOverlayAAPrec.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 JTS passes the test

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1044#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 18 13:20:30 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 18 Aug 2020 20:20:30 -0000
Subject: [geos-devel] [GEOS] #1044: [OverlayNG]
	general/TestOverlayAAPrec.xml fails
In-Reply-To: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
References: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
Message-ID: <057.519b8a87d30a22220bbf25bcd90b9ff0@osgeo.org>

#1044: [OverlayNG] general/TestOverlayAAPrec.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 Debugging shows the expected edges are in the graph:
 {{{
 Using fixed precision overlay.
 OverlayNG::extractResult: graph: OGRPH
 NODEMAP [5]
  10 10 OE( 10 10 .. 10 30 ) A:eCs/B:eiB / Sym: A:eCs/B:ieB
  10 30 OE( 10 30 .. 10 10 ) A:eCs/B:ieB / Sym: A:eCs/B:eiB
  10 100 OE( 10 100 .. 10 30 ) A:ieB/B:e / Sym: A:eiB/B:e
  30 10 OE( 30 10 .. 10 10 ) A:eCs/B:eiB / Sym: A:eCs/B:ieB
  90 90 OE( 90 90, 11 90 .. 10 30 ) A:eiB/B:e / Sym: A:ieB/B:e
 EDGES [14]
  OE( 10 30 .. 10 10 ) A:eCs/B:ieB / Sym: A:eCs/B:eiB
  OE( 10 10 .. 10 30 ) A:eCs/B:eiB / Sym: A:eCs/B:ieB
  OE( 10 10 .. 30 10 ) A:eCs/B:ieB / Sym: A:eCs/B:eiB
  OE( 30 10 .. 10 10 ) A:eCs/B:eiB / Sym: A:eCs/B:ieB
  OE( 10 100 .. 10 30 ) A:ieB/B:e / Sym: A:eiB/B:e
  OE( 10 30 .. 10 100 ) A:eiB/B:e / Sym: A:ieB/B:e
  OE( 90 90, 11 90 .. 10 30 ) A:eiB/B:e / Sym: A:ieB/B:e
  OE( 10 30, 11 90 .. 90 90 ) A:ieB/B:e / Sym: A:eiB/B:e
  OE( 30 10, 30 30 .. 10 30 ) A:e/B:ieB / Sym: A:e/B:eiB
  OE( 10 30, 30 30 .. 30 10 ) A:e/B:eiB / Sym: A:e/B:ieB
  OE( 30 10, 100 10 .. 10 100 ) A:ieB/B:e / Sym: A:eiB/B:e
  OE( 10 100, 100 100 .. 30 10 ) A:eiB/B:e / Sym: A:ieB/B:e
  OE( 30 10, 90 11 .. 90 90 ) A:eiB/B:e / Sym: A:ieB/B:e
  OE( 90 90, 90 11 .. 30 10 ) A:ieB/B:e / Sym: A:eiB/B:e
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1044#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Tue Aug 18 13:37:42 2020
From: geos-trac at osgeo.org (GEOS)
Date: Tue, 18 Aug 2020 20:37:42 -0000
Subject: [geos-devel] [GEOS] #1044: [OverlayNG]
	general/TestOverlayAAPrec.xml fails
In-Reply-To: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
References: <042.41eede8a55ce5383d56decf52e1cef67@osgeo.org>
Message-ID: <057.328a5dd2937634fbaa219fa97c356c39@osgeo.org>

#1044: [OverlayNG] general/TestOverlayAAPrec.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by strk):

 I was wrong about JTS, it fails with the same error. The difference is
 that while JTS uses the OLD Overlay code for XML test "intersection", GEOS
 uses the OverlayNG when compiled with --enable-overlayng.

 Martin: I find the expected output more correct than the obtained one,
 don't you ?
 {{{
 Case x.xml - #1 (4): AA - A hole close to shell, B coincident with A
 Test Failed (A intersectionng B)
   Expected: MULTILINESTRING ((10 30, 10 10),
   (10 10, 30 10))
   Actual: MULTIPOINT ((30 10), (10 30))

 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1044#comment:4>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 20 02:40:07 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 20 Aug 2020 09:40:07 -0000
Subject: [geos-devel] [GEOS] #1045: Buffer returns unexpected geometry
Message-ID: <045.55f1b5c679138ff7e7b655bc34eb4a27@osgeo.org>

#1045: Buffer returns unexpected geometry
------------------------+--------------------------
 Reporter:  Mike Taves  |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:
Component:  Default     |    Version:  master
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 Take a valid circular Polygon:
 {{{
 01030000000100000021000000445B6A96389731401353F306D7FA38C00C8E72DE4B2C2840DA10155FE8C23BC0B9E62D120E6D17401CE694D0C4633DC0A6E7A7179C38E6BF33E1A644CEB83DC04C7E65657C8B1CC0F2C289AA62BB3CC0DC9ACC478A202AC0E7D98A87EA7E3AC019113CD90B2D32C0FAD6B8818D2B37C0F5EEAAB0B34D36C0D9805A6E0CF532C075D7B834ED6139C0B978C930CA242CC035BBB24B45693BC0A37F2867967121C043661D7EFD683CC08B2510BBF9CF08C0AEE85DB16E653CC0449B26F9B3D8044040946EBAF95E3BC0149194A449712040912AB33E0F5239C04939857DBB1F2B40F3F39B69473A36C03822276A3C6F3240124304BCEE1832C0B1FE0D7BF4A1364064254FA8E4FD29C028F98B5EA0F1394094F0128D365F1CC0DA73371D392B3C40F1A415BA5AEDE5BFCCFA845943273D4066587F30665117406A47A472B2D23C40EBD11CFE1C0F2840AEFB7D7108343B40DF5CF9858F8F314017448CE485693840C0C50653C4303640406FCA5C94A134405D77CF7B34CE3940F625DCEEC211304000AA8A9229603C4071A11C7320E02540BAC8467F3DE93D4023E847E9BDBE15407D8C2472036E3E4075335E981BB0CFBF7D8C2472036E3E406D345E981BB0CFBFF94E860643F03D40C8029D3141BC17C0F9AB8EE2706D3C4084D967018BE226C00980124E0CE8394057DDAEC0EF8530C0EDB89B24453F3640AEBDA0FE132A35C0445B6A96389731401353F306D7FA38C0
 }}}
 Buffering with -1.047e-13 and 8 quadrant segments returns an unexpected
 collapsed 1-D Polygon (if that's a thing) with zero area:
 {{{
 POLYGON ((30.429740079806265 -0.2475618833526883, 30.429740079806265
 -0.2475618833526937, 30.429740079806265 -0.2475618833526936,
 30.429740079806265 -0.2475618833526911, 30.429740079806265
 -0.2475618833526842, 30.429740079806265 -0.2475618833526821,
 30.429740079806265 -0.247561883352682, 30.429740079806265
 -0.2475618833526883))
 }}}
 JTS has the same behaviour with this specific example.

 Other buffer distances like -1.04e-13 are not an issue with this polygon.
 This is perhaps related (but not identical) to #1032.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1045>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 20 14:58:54 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 20 Aug 2020 21:58:54 -0000
Subject: [geos-devel] [GEOS] #1046: Unary union does not combine all parts
Message-ID: <045.4b1222dc9e4205efbe02100d334127d4@osgeo.org>

#1046: Unary union does not combine all parts
------------------------+--------------------------
 Reporter:  Mike Taves  |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:
Component:  Default     |    Version:  master
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 This issue is described thru shapely with the following:
 {{{
 #!python
 from shapely import wkt, ops, geos
 print(geos.geos_version_string)  # 3.9.0-CAPI-1.14.0

 mls = wkt.loads('MULTILINESTRING ((-0.6576979014845081 1.601480154089968,
 -0.5760076586550748 1.594118888807711), (-0.5760076586550748
 1.594118888807711, -0.4943174158256414 1.586757623525453),
 (-0.4943174158256414 1.586757623525453, -0.412627172996208
 1.579396358243196), (-0.412627172996208 1.579396358243196,
 -0.3309369301667746 1.572035092960939), (-0.6698736576063997
 1.466362013920959, -0.5881834147769663 1.459000748638702),
 (-0.5881834147769663 1.459000748638702, -0.506493171947533
 1.451639483356445), (-0.506493171947533 1.451639483356445,
 -0.4248029291180996 1.444278218074187), (-0.4248029291180996
 1.444278218074187, -0.3431126862886662 1.43691695279193),
 (-0.6820496602460158 1.331241138068341, -0.6003594174165824
 1.323879872786084), (-0.6003594174165824 1.323879872786084,
 -0.518669174587149 1.316518607503827), (-0.518669174587149
 1.316518607503827, -0.4369789317577156 1.30915734222157),
 (-0.4369789317577156 1.30915734222157, -0.3552886889282822
 1.301796076939312), (-0.6942256628856115 1.19612026221595,
 -0.6125354200561781 1.188758996933693), (-0.6125354200561781
 1.188758996933693, -0.5308451772267447 1.181397731651435),
 (-0.5308451772267447 1.181397731651435, -0.4491549343973113
 1.174036466369178), (-0.4491549343973113 1.174036466369178,
 -0.3674646915678779 1.166675201086921), (-0.7064014190075235
 1.061002122046715, -0.6247111761780901 1.053640856764457),
 (-0.6247111761780901 1.053640856764457, -0.5430209333486568
 1.0462795914822), (-0.5430209333486568 1.0462795914822,
 -0.4613306905192234 1.038918326199943), (-0.4613306905192234
 1.038918326199943, -0.37964044768979 1.031557060917686),
 (-0.7185774216471191 0.9258812461943232, -0.6368871788176858
 0.9185199809120661), (-0.6368871788176858 0.9185199809120661,
 -0.5551969359882524 0.9111587156298089), (-0.5551969359882524
 0.9111587156298089, -0.473506693158819 0.9037974503475517),
 (-0.473506693158819 0.9037974503475517, -0.3918164503293856
 0.8964361850652945), (-0.7307531777690311 0.7907631060250878,
 -0.6490629349395978 0.7834018407428307), (-0.6490629349395978
 0.7834018407428307, -0.5673726921101644 0.7760405754605735),
 (-0.5673726921101644 0.7760405754605735, -0.485682449280731
 0.7686793101783163), (-0.485682449280731 0.7686793101783163,
 -0.4039922064512976 0.7613180448960591), (-0.7429291804086269
 0.6556422301726965, -0.6612389375791935 0.6482809648904393),
 (-0.6612389375791935 0.6482809648904393, -0.5795486947497601
 0.6409196996081822), (-0.5795486947497601 0.6409196996081822,
 -0.4978584519203267 0.6335584343259251), (-0.4978584519203267
 0.6335584343259251, -0.4161682090908933 0.6261971690436678),
 (-0.7551051830482327 0.520521354320192, -0.6734149402187993
 0.5131600890379348), (-0.6734149402187993 0.5131600890379348,
 -0.591724697389366 0.5057988237556776), (-0.591724697389366
 0.5057988237556776, -0.5100344545599326 0.4984375584734204),
 (-0.5100344545599326 0.4984375584734204, -0.4283442117304992
 0.4910762931911632), (-0.7672809391701243 0.3854032141511831,
 -0.6855906963406909 0.3780419488689258), (-0.6855906963406909
 0.3780419488689258, -0.6039004535112575 0.3706806835866687),
 (-0.6039004535112575 0.3706806835866687, -0.5222102106818243
 0.3633194183044115), (-0.5222102106818243 0.3633194183044115,
 -0.4405199678523908 0.3559581530221543), (-0.9306610432639912
 -1.427676448810457, -0.8489708004345579 -1.435037714092715),
 (-0.8489708004345579 -1.435037714092715, -0.7672805576051245
 -1.442398979374972), (-0.7672805576051245 -1.442398979374972,
 -0.6855903147756911 -1.449760244657229), (-0.6855903147756911
 -1.449760244657229, -0.6039000719462577 -1.457121509939486),
 (-0.9184850406243956 -1.292555572958066, -0.8367947977949622
 -1.299916838240323), (-0.8367947977949622 -1.299916838240323,
 -0.7551045549655289 -1.30727810352258), (-0.7551045549655289
 -1.30727810352258, -0.6734143121360955 -1.314639368804838),
 (-0.6734143121360955 -1.314639368804838, -0.5917240693066621
 -1.322000634087095), (-0.906309284502504 -1.157437432789057,
 -0.8246190416730707 -1.164798698071314), (-0.8246190416730707
 -1.164798698071314, -0.7429287988436373 -1.172159963353572),
 (-0.7429287988436373 -1.172159963353572, -0.6612385560142039
 -1.179521228635829), (-0.6612385560142039 -1.179521228635829,
 -0.5795483131847705 -1.186882493918086), (-0.894133281862888
 -1.022316556936439, -0.8124430390334546 -1.029677822218697),
 (-0.8124430390334546 -1.029677822218697, -0.7307527962040212
 -1.037039087500954), (-0.7307527962040212 -1.037039087500954,
 -0.6490625533745878 -1.044400352783211), (-0.6490625533745878
 -1.044400352783211, -0.5673723105451545 -1.051761618065468),
 (-0.881957279223282 -0.887195681083935, -0.8002670363938487
 -0.8945569463661922), (-0.8002670363938487 -0.8945569463661922,
 -0.7185767935644153 -0.9019182116484493), (-0.7185767935644153
 -0.9019182116484493, -0.6368865507349819 -0.9092794769307064),
 (-0.6368865507349819 -0.9092794769307064, -0.5551963079055485
 -0.9166407422129637), (-0.8697815231014007 -0.7520775409150393,
 -0.7880912802719673 -0.7594388061972965), (-0.7880912802719673
 -0.7594388061972965, -0.7064010374425339 -0.7668000714795536),
 (-0.7064010374425339 -0.7668000714795536, -0.6247107946131005
 -0.7741613367618108), (-0.6247107946131005 -0.7741613367618108,
 -0.5430205517836671 -0.781522602044068), (-0.8576055204617845
 -0.6169566650624215, -0.7759152776323511 -0.6243179303446786),
 (-0.7759152776323511 -0.6243179303446786, -0.6942250348029178
 -0.6316791956269359), (-0.6942250348029178 -0.6316791956269359,
 -0.6125347919734844 -0.6390404609091931), (-0.6125347919734844
 -0.6390404609091931, -0.530844549144051 -0.6464017261914502),
 (-0.8454295178221787 -0.481835789209917, -0.7637392749927453
 -0.4891970544921742), (-0.7637392749927453 -0.4891970544921742,
 -0.6820490321633119 -0.4965583197744314), (-0.6820490321633119
 -0.4965583197744314, -0.6003587893338785 -0.5039195850566885),
 (-0.6003587893338785 -0.5039195850566885, -0.5186685465044452
 -0.5112808503389458), (-0.8332537617002769 -0.3467176490407948,
 -0.7515635188708435 -0.3540789143230521), (-0.7515635188708435
 -0.3540789143230521, -0.6698732760414101 -0.3614401796053092),
 (-0.6698732760414101 -0.3614401796053092, -0.5881830332119767
 -0.3688014448875664), (-0.5881830332119767 -0.3688014448875664,
 -0.5064927903825434 -0.3761627101698236), (-0.8210777590606811
 -0.2115967731884035, -0.7393875162312478 -0.2189580384706607),
 (-0.7393875162312478 -0.2189580384706607, -0.6576972734018144
 -0.2263193037529179), (-0.6576972734018144 -0.2263193037529179,
 -0.576007030572381 -0.2336805690351751), (-0.576007030572381
 -0.2336805690351751, -0.4943167877429477 -0.2410418343174323),
 (-0.4526959704920171 0.2208372771694233, -0.4859475131545354
 0.1930830793980719), (-0.4859475131545354 0.1930830793980719,
 -0.5191990558170538 0.1653288816267205), (-0.5191990558170538
 0.1653288816267205, -0.5524505984795721 0.137574683855369),
 (-0.5524505984795721 0.137574683855369, -0.5857021411420905
 0.1098204860840176), (-0.7794569418097506 0.2502823382984521,
 -0.7517027440383682 0.2170307956359595), (-0.7517027440383682
 0.2170307956359595, -0.7239485462669859 0.1837792529734669),
 (-0.7239485462669859 0.1837792529734669, -0.6961943484956037
 0.1505277103109743), (-0.6961943484956037 0.1505277103109743,
 -0.6684401507242214 0.1172761676484817), (-0.4821410316210357
 -0.1059236941481969, -0.5098952293924154 -0.072672151485676),
 (-0.5098952293924154 -0.072672151485676, -0.5376494271637952
 -0.0394206088231551), (-0.5376494271637952 -0.0394206088231551,
 -0.5654036249351749 -0.006169066160634187), (-0.5654036249351749
 -0.006169066160634187, -0.5931578227065547 0.02708247650188672),
 (-0.8089020029387691 -0.07647863301916814, -0.7756504602762482
 -0.0487244352477884), (-0.7756504602762482 -0.0487244352477884,
 -0.7423989176137273 -0.02097023747640865), (-0.7423989176137273
 -0.02097023747640865, -0.7091473749512065 0.006783960294971095),
 (-0.7091473749512065 0.006783960294971095, -0.6758958322886855
 0.03453815806635084), (-0.8089020029387691 -0.07647863301916814,
 -0.7272117601093357 -0.08383989830142534), (-0.7272117601093357
 -0.08383989830142534, -0.6455215172799024 -0.09120116358368252),
 (-0.6455215172799024 -0.09120116358368252, -0.563831274450469
 -0.09856242886593972), (-0.563831274450469 -0.09856242886593972,
 -0.4821410316210357 -0.1059236941481969), (-0.7794569418097506
 0.2502823382984521, -0.7868182070920052 0.168592095469047),
 (-0.7868182070920052 0.168592095469047, -0.7941794723742599
 0.08690185263964198), (-0.7941794723742599 0.08690185263964198,
 -0.8015407376565145 0.005211609810236939), (-0.8015407376565145
 0.005211609810236939, -0.8089020029387691 -0.07647863301916813),
 (-0.4526959704920171 0.2208372771694233, -0.5343862133214504
 0.2281985424516805), (-0.5343862133214504 0.2281985424516805,
 -0.6160764561508838 0.2355598077339377), (-0.6160764561508838
 0.2355598077339377, -0.6977666989803172 0.2429210730161949),
 (-0.6977666989803172 0.2429210730161949, -0.7794569418097506
 0.2502823382984521), (-0.4821410316210357 -0.1059236941481969,
 -0.4747797663387811 -0.02423345131879184), (-0.4747797663387811
 -0.02423345131879184, -0.4674185010565264 0.05745679151061323),
 (-0.4674185010565264 0.05745679151061323, -0.4600572357742717
 0.1391470343400183), (-0.4600572357742717 0.1391470343400183,
 -0.4526959704920171 0.2208372771694234), (-0.6160758280681697
 -1.592239650108722, -0.5417471029329169 -0.7673907453781521),
 (-0.5417471029329169 -0.7673907453781521, -0.4674183777976642
 0.05745815935241749), (-0.4674183777976642 0.05745815935241749,
 -0.3930896526624113 0.8823070640829869), (-0.3930896526624113
 0.8823070640829869, -0.3187609275271585 1.707155968813557),
 (-0.9428367993859033 -1.562794588979693, -0.8685080742506505
 -0.7379456842491232), (-0.8685080742506505 -0.7379456842491232,
 -0.7941793491153977 0.08690322048144639), (-0.7941793491153977
 0.08690322048144639, -0.7198506239801449 0.9117521252120158),
 (-0.7198506239801449 0.9117521252120158, -0.6455218988448921
 1.736601029942586), (-0.9993957611019492 -1.459318228223596,
 -0.983057575751899 -1.460790493605932), (-0.983057575751899
 -1.460790493605932, -0.966719390401849 -1.462262758988268),
 (-0.966719390401849 -1.462262758988268, -0.9503812050517988
 -1.463735024370604), (-0.9503812050517988 -1.463735024370604,
 -0.9340430197017486 -1.465207289752941), (-0.7196684199292575
 1.644902792245065, -0.7033302345792073 1.643430526862729),
 (-0.7033302345792073 1.643430526862729, -0.6869920492291572
 1.641958261480392), (-0.6869920492291572 1.641958261480392,
 -0.6706538638791071 1.640485996098056), (-0.6706538638791071
 1.640485996098056, -0.6543156785290569 1.63901373071572),
 (-0.859531438839926 0.09279159215271227, -1.159645638350528
 0.1499009901749203), (-1.159645638350528 0.1499009901749203,
 -1.442851736820215 0.2644624229519199), (-1.442851736820215
 0.2644624229519199, -1.698266282708604 0.4320733588688825),
 (-1.698266282708604 0.4320733588688825, -1.916073838255332
 0.6462926036558143), (-1.998004052704932 -0.2629123844577409,
 -1.745408824489664 -0.09108204146443584), (-1.745408824489664
 -0.09108204146443584, -1.464144705809355 0.02816774525781686),
 (-1.464144705809355 0.02816774525781686, -1.165020519010141
 0.09025427328133792), (-1.165020519010141 0.09025427328133792,
 -0.8595314388399259 0.09279159215271232), (-0.7196684199292575
 1.644902792245065, -1.01876983555948 1.395249987913508),
 (-1.01876983555948 1.395249987913508, -1.317871251189702
 1.145597183581952), (-1.317871251189702 1.145597183581952,
 -1.616972666819924 0.8959443792503951), (-1.616972666819924
 0.8959443792503951, -1.916074082450146 0.6462915749188385),
 (-0.9993950635108855 -1.459318408544343, -1.24904735831936
 -1.160217009463332), (-1.24904735831936 -1.160217009463332,
 -1.498699653127834 -0.8611156103823205), (-1.498699653127834
 -0.8611156103823205, -1.748351947936309 -0.5620142113013092),
 (-1.748351947936309 -0.5620142113013092, -1.998004242744783
 -0.2629128122202979), (-0.6543156785290569 1.63901373071572,
 -0.7242475138222298 0.862958475598555), (-0.7242475138222298
 0.862958475598555, -0.7941793491154028 0.08690322048138976),
 (-0.7941793491154028 0.08690322048138976, -0.8641111844085757
 -0.6891520346357756), (-0.8641111844085757 -0.6891520346357756,
 -0.9340430197017486 -1.465207289752941), (-0.7196684199292575
 1.644902792245065, -0.7896002552224304 0.8688475371278995),
 (-0.7896002552224304 0.8688475371278995, -0.8595320905156033
 0.09279228201073431), (-0.8595320905156033 0.09279228201073431,
 -0.9294639258087762 -0.683262973106431), (-0.9294639258087762
 -0.683262973106431, -0.9993957611019492 -1.459318228223596),
 (-1.008188929795388 -1.556906668802002, -0.9918509297880254
 -1.558378917482751), (-0.9918509297880254 -1.558378917482751,
 -0.9755129297806626 -1.5598511661635), (-0.9755129297806626
 -1.5598511661635, -0.9591749297732999 -1.561323414844249),
 (-0.9591749297732999 -1.561323414844249, -0.9428369297659371
 -1.562795663524999), (-0.9993950628321178 -1.459318401011847,
 -1.001593529572935 -1.483715467959386), (-1.001593529572935
 -1.483715467959386, -1.003791996313753 -1.508112534906924),
 (-1.003791996313753 -1.508112534906924, -1.00599046305457
 -1.532509601854463), (-1.00599046305457 -1.532509601854463,
 -1.008188929795388 -1.556906668802002), (-0.7108739478844331
 1.742489853107766, -0.7130724146252558 1.718092786160171),
 (-0.7130724146252558 1.718092786160171, -0.7152708813660785
 1.693695719212575), (-0.7152708813660785 1.693695719212575,
 -0.7174693481069012 1.66929865226498), (-0.7174693481069012
 1.66929865226498, -0.7196678148477239 1.644901585317385),
 (-0.6455219478549822 1.736600858384769, -0.6618599478623449
 1.738073107065518), (-0.6618599478623449 1.738073107065518,
 -0.6781979478697077 1.739545355746267), (-0.6781979478697077
 1.739545355746267, -0.6945359478770704 1.741017604427017),
 (-0.6945359478770704 1.741017604427017, -0.7108739478844331
 1.742489853107766), (-0.6543158148182729 1.639012590594388,
 -0.6521173480774503 1.663409657541983), (-0.6521173480774503
 1.663409657541983, -0.6499188813366276 1.687806724489578),
 (-0.6499188813366276 1.687806724489578, -0.6477204145958049
 1.712203791437174), (-0.6477204145958049 1.712203791437174,
 -0.6455219478549822 1.736600858384769), (-0.9428369297659371
 -1.562795663524999, -0.9406384630251196 -1.53839859657746),
 (-0.9406384630251196 -1.53839859657746, -0.938439996284302
 -1.514001529629921), (-0.938439996284302 -1.514001529629921,
 -0.9362415295434844 -1.489604462682383), (-0.9362415295434844
 -1.489604462682383, -0.9340430628026668 -1.465207395734844),
 (-0.7196684199292575 1.644902792245065, -0.7033302345792073
 1.643430526862729), (-0.7033302345792073 1.643430526862729,
 -0.6869920492291572 1.641958261480392), (-0.6869920492291572
 1.641958261480392, -0.6706538638791071 1.640485996098056),
 (-0.6706538638791071 1.640485996098056, -0.6543156785290569
 1.63901373071572), (-0.9993957611019492 -1.459318228223596,
 -0.983057575751899 -1.460790493605932), (-0.983057575751899
 -1.460790493605932, -0.966719390401849 -1.462262758988268),
 (-0.966719390401849 -1.462262758988268, -0.9503812050517988
 -1.463735024370604), (-0.9503812050517988 -1.463735024370604,
 -0.9340430197017486 -1.465207289752941), (1.972238675020841
 1.541886069483511, 1.97867976299911 1.613364819515621), (1.97867976299911
 1.613364819515621, 1.985120850977379 1.68484356954773), (1.985120850977379
 1.68484356954773, 1.991561938955647 1.75632231957984), (1.991561938955647
 1.75632231957984, 1.998003026933916 1.827801069611949), (1.671243071408027
 -1.798355452444507, 1.752933071444756 -1.805716695848246),
 (1.752933071444756 -1.805716695848246, 1.834623071481485
 -1.813077939251984), (1.834623071481485 -1.813077939251984,
 1.916313071518214 -1.820439182655723), (1.916313071518214
 -1.820439182655723, 1.998003071554943 -1.827800426059461),
 (1.968558053318982 1.50104106946526, 1.894229307841243
 0.6761919389878184), (1.894229307841243 0.6761919389878184,
 1.819900562363505 -0.1486571914896235), (1.819900562363505
 -0.1486571914896235, 1.745571816885766 -0.9735063219670657),
 (1.745571816885766 -0.9735063219670657, 1.671243071408027
 -1.798355452444507))')
 print(mls.is_valid)  # True
 print(mls.is_simple)  # False
 print(mls.length)  # 31.700520464688292

 # Split multi-part geometry to a list of LineString
 ls = [x for x in mls.geoms]
 print(all([x.is_valid for x in ls]))  # True
 print(all([x.is_simple for x in ls]))  # True
 print(len(mls))  # 196
 print(sum([x.length for x in ls]))  # 31.700520464688292

 # Here is the issue
 u = ops.unary_union(ls)
 print(len(u))  # 19
 print(u.length) # 19.414213562373096
 }}}
 As is shown, unary union only collects 19 of 196 !LineString geometries,
 returning an incomplete result. The expected result would recombine all
 LineString geometries (but perhaps in a different order).

 The same behaviour is shown with `ops.cascaded_union(ls)` (deprecated).

 And the same issue via PostGIS:
 {{{
 select st_numgeometries(g), st_numgeometries(st_unaryunion(g))
 from (
   select
 '0105000000C4000000010200000002000000E8C23078DC0BE5BFB82670A7A99FF93F1569059DA76EE2BFF4D6D5CE8281F93F0102000000020000001569059DA76EE2BFF4D6D5CE8281F93F851EB483E5A2DFBF2C873BF65B63F93F010200000002000000851EB483E5A2DFBF2C873BF65B63F93FDE6A5DCD7B68DABF6837A11D3545F93F010200000002000000DE6A5DCD7B68DABF6837A11D3545F93F38B70617122ED5BFA4E706450E27F93F0102000000020000006AE27BE19A6FE5BF0932DE033876F73F9788500666D2E2BF45E2432B1158F73F0102000000020000009788500666D2E2BF45E2432B1158F73FC42E252B3135E0BF8192A952EA39F73F010200000002000000C42E252B3135E0BF8192A952EA39F73FE2A9F39FF82FDBBFB9420F7AC31BF73F010200000002000000E2A9F39FF82FDBBFB9420F7AC31BF73F3CF69CE98EF5D5BFF5F274A19CFDF63F010200000002000000442520CF59D3E5BF587EF181C34CF53F71CBF4F32436E3BF942E57A99C2EF53F01020000000200000071CBF4F32436E3BF942E57A99C2EF53F9E71C918F098E0BFD0DEBCD07510F53F0102000000020000009E71C918F098E0BFD0DEBCD07510F53F962F3C7B76F7DBBF0C8F22F84EF2F43F010200000002000000962F3C7B76F7DBBF0C8F22F84EF2F43FEF7BE5C40CBDD6BF433F881F28D4F43F0102000000020000006767C4BC1837E6BFA4CE04004F23F33F940D99E1E399E3BFE07E6A272805F33F010200000002000000940D99E1E399E3BFE07E6A272805F33FC1B36D06AFFCE0BF182FD04E01E7F23F010200000002000000C1B36D06AFFCE0BF182FD04E01E7F23FDBB38456F4BEDCBF54DF3576DAC8F23F010200000002000000DBB38456F4BEDCBF54DF3576DAC8F23F35002EA08A84D7BF908F9B9DB3AAF23F010200000002000000A1870F26D79AE6BFFBD5725CDDF9F03FCE2DE44AA2FDE3BF3386D883B6DBF03F010200000002000000CE2DE44AA2FDE3BF3386D883B6DBF03FFBD3B86F6D60E1BF6F363EAB8FBDF03F010200000002000000FBD3B86F6D60E1BF6F363EAB8FBDF03F50F41A297186DDBFABE6A3D2689FF03F01020000000200000050F41A297186DDBFABE6A3D2689FF03FAA40C472074CD8BFE79609FA4181F03F010200000002000000C3C9B31396FEE6BF894C0CB5D1A0ED3FF06F88386161E4BF00ADD7038464ED3F010200000002000000F06F88386161E4BF00ADD7038464ED3F1D165D5D2CC4E1BF760DA3523628ED3F0102000000020000001D165D5D2CC4E1BF760DA3523628ED3F94786304EF4DDEBFEC6D6EA1E8EBEC3F01020000000200000094786304EF4DDEBFEC6D6EA1E8EBEC3FEEC40C4E8513D9BF63CE39F09AAFEC3F010200000002000000FDE9FE7C5462E7BF335BE86DEE4DE93F2A90D3A11FC5E4BFAABBB3BCA011E93F0102000000020000002A90D3A11FC5E4BFAABBB3BCA011E93F5736A8C6EA27E2BF201C7F0B53D5E83F0102000000020000005736A8C6EA27E2BF201C7F0B53D5E83F08B9F9D66B15DFBF967C4A5A0599E83F01020000000200000008B9F9D66B15DFBF967C4A5A0599E83F6105A32002DBD9BF0DDD15A9B75CE83F010200000002000000202CA36A13C6E7BFCAFB0E6A05FBE43F4DD2778FDE28E5BF405CDAB8B7BEE43F0102000000020000004DD2778FDE28E5BF405CDAB8B7BEE43F7A784CB4A98BE2BFB7BCA5076A82E43F0102000000020000007A784CB4A98BE2BFB7BCA5076A82E43F4D3D42B2E9DCDFBF2E1D71561C46E43F0102000000020000004D3D42B2E9DCDFBF2E1D71561C46E43FA789EBFB7FA2DABFA47D3CA5CE09E43F0102000000020000009E6E4758D229E8BF659835661CA8E03FCB141C7D9D8CE5BFDBF800B5CE6BE03F010200000002000000CB141C7D9D8CE5BFDBF800B5CE6BE03FF8BAF0A168EFE2BF5259CC03812FE03F010200000002000000F8BAF0A168EFE2BF5259CC03812FE03F2561C5C63352E0BF90732FA566E6DF3F0102000000020000002561C5C63352E0BF90732FA566E6DF3FA40E34D7FD69DBBF7C34C642CB6DDF3F010200000002000000208E92C1908DE8BF0F5E233E72AAD83F4D3467E65BF0E5BFF91EBADBD631D83F0102000000020000004D3467E65BF0E5BFF91EBADBD631D83F7ADA3B0B2753E3BFE8DF50793BB9D73F0102000000020000007ADA3B0B2753E3BFE8DF50793BB9D73FA8801030F2B5E0BFD4A0E716A040D73F010200000002000000A8801030F2B5E0BFD4A0E716A040D73FA84DCAA97A31DCBFC0617EB404C8D63F010200000002000000D85C0FABF9C7EDBFB7908E42C3D7F6BF0503E4CFC42AEBBF80E0281BEAF5F6BF0102000000020000000503E4CFC42AEBBF80E0281BEAF5F6BF32A9B8F48F8DE8BF4430C3F31014F7BF01020000000200000032A9B8F48F8DE8BF4430C3F31014F7BF5F4F8D195BF0E5BF08805DCC3732F7BF0102000000020000005F4F8D195BF0E5BF08805DCC3732F7BF8CF5613E2653E3BFCCCFF7A45E50F7BF010200000002000000B61A6BBD3A64EDBF04E1A1C04EAEF4BFE3C03FE205C7EABFC8303C9975CCF4BF010200000002000000E3C03FE205C7EABFC8303C9975CCF4BF10671407D129E8BF8C80D6719CEAF4BF01020000000200000010671407D129E8BF8C80D6719CEAF4BF3D0DE92B9C8CE5BF54D0704AC308F5BF0102000000020000003D0DE92B9C8CE5BF54D0704AC308F5BF6AB3BD5067EFE2BF18200B23EA26F5BF01020000000200000034FB1F547C00EDBF55EC0F1DDD84F2BF61A1F4784763EABF193CAAF503A3F2BF01020000000200000061A1F4784763EABF193CAAF503A3F2BF8E47C99D12C6E7BFE18B44CE2AC1F2BF0102000000020000008E47C99D12C6E7BFE18B44CE2AC1F2BFBBED9DC2DD28E5BFA5DBDEA651DFF2BF010200000002000000BBED9DC2DD28E5BFA5DBDEA651DFF2BFE89372E7A88BE2BF692B797F78FDF2BF0102000000020000005AB87B66BD9CECBFA338239B685BF0BF875E508B88FFE9BF6C88BD738F79F0BF010200000002000000875E508B88FFE9BF6C88BD738F79F0BFB40425B05362E7BF30D8574CB697F0BF010200000002000000B40425B05362E7BF30D8574CB697F0BFE1AAF9D41EC5E4BFF427F224DDB5F0BF010200000002000000E1AAF9D41EC5E4BFF427F224DDB5F0BF0E51CEF9E927E2BFB8778CFD03D4F0BF010200000002000000DB75D778FE38ECBFE60D6D32E863ECBF081CAC9DC99BE9BF70ADA1E335A0ECBF010200000002000000081CAC9DC99BE9BF70ADA1E335A0ECBF35C280C294FEE6BFF94CD69483DCECBF01020000000200000035C280C294FEE6BFF94CD69483DCECBF626855E75F61E4BF82EC0A46D118EDBF010200000002000000626855E75F61E4BF82EC0A46D118EDBF8F0E2A0C2BC4E1BF0C8C3FF71E55EDBF010200000002000000B5568C0F40D5EBBF842849EB0411E8BFE2FC60340B38E9BF0EC87D9C524DE8BF010200000002000000E2FC60340B38E9BF0EC87D9C524DE8BF0FA33559D69AE6BF9767B24DA089E8BF0102000000020000000FA33559D69AE6BF9767B24DA089E8BF3C490A7EA1FDE3BF2007E7FEEDC5E8BF0102000000020000003C490A7EA1FDE3BF2007E7FEEDC5E8BF69EFDEA26C60E1BFAAA61BB03B02E9BF010200000002000000DA13E8218171EBBF23C16FE71BBEE3BF07BABC464CD4E8BFAC60A49869FAE3BF01020000000200000007BABC464CD4E8BFAC60A49869FAE3BF3460916B1737E6BF3600D949B736E4BF0102000000020000003460916B1737E6BF3600D949B736E4BF61066690E299E3BFC09F0DFB0473E4BF01020000000200000061066690E299E3BFC09F0DFB0473E4BF8EAC3AB5ADFCE0BF493F42AC52AFE4BF0102000000020000005CD14334C20DEBBF7CBB2CC765D6DEBF897718598D70E8BF90FA9529014FDFBF010200000002000000897718598D70E8BF90FA9529014FDFBFB61DED7D58D3E5BFA339FF8B9CC7DFBF010200000002000000B61DED7D58D3E5BFA339FF8B9CC7DFBFE3C3C1A22336E3BF5B3C34F71B20E0BF010200000002000000E3C3C1A22336E3BF5B3C34F71B20E0BF106A96C7EE98E0BFE5DB68A8695CE0BF0102000000020000007EB1F8CA03AAEABFC7E0E4389F30D6BFAB57CDEFCE0CE8BFDD1F4E9B3AA9D6BF010200000002000000AB57CDEFCE0CE8BFDD1F4E9B3AA9D6BFD8FDA1149A6FE5BFEF5EB7FDD521D7BF010200000002000000D8FDA1149A6FE5BFEF5EB7FDD521D7BF05A4763965D2E2BF029E2060719AD7BF01020000000200000005A4763965D2E2BF029E2060719AD7BF324A4B5E3035E0BF16DD89C20C13D8BF0102000000020000005B6F54DD4446EABFEB4364629A15CBBF8815290210A9E7BF12C23627D106CCBF0102000000020000008815290210A9E7BF12C23627D106CCBFB5BBFD26DB0BE5BF394009EC07F8CCBF010200000002000000B5BBFD26DB0BE5BF394009EC07F8CCBFE261D24BA66EE2BF60BEDBB03EE9CDBF010200000002000000E261D24BA66EE2BF60BEDBB03EE9CDBF1F104EE1E2A2DFBF883CAE7575DACEBF01020000000200000015D41285F8F8DCBF0E1697596544CC3F838F2499C319DFBF047DB643F2B6C83F010200000002000000838F2499C319DFBF047DB643F2B6C83F7A259B56479DE0BFFAE3D52D7F29C53F0102000000020000007A259B56479DE0BFFAE3D52D7F29C53F3103A4E0ACADE1BFED4AF5170C9CC13F0102000000020000003103A4E0ACADE1BFED4AF5170C9CC13FE9E0AC6A12BEE2BFC6632904321DBC3F01020000000200000056D136AF4FF1E8BF55877036A004D03FFDA9BEE9F20DE8BF6C9BBD44AAC7CB3F010200000002000000FDA9BEE9F20DE8BF6C9BBD44AAC7CB3FA4824624962AE7BF2D289A1C1486C73F010200000002000000A4824624962AE7BF2D289A1C1486C73F4C5BCE5E3947E6BFEFB476F47D44C33F0102000000020000004C5BCE5E3947E6BFEFB476F47D44C33FF3335699DC63E5BF6083A698CF05BE3F010200000002000000ACCFB70E66DBDEBF5FEE3CB2D01DBBBF170FD4CC0F51E0BFEBFFF561A49AB2BF010200000002000000170FD4CC0F51E0BFEBFFF561A49AB2BF59364C926C34E1BFED225E23F02EA4BF01020000000200000059364C926C34E1BFED225E23F02EA4BF9B5DC457C917E2BF10308216BC4479BF0102000000020000009B5DC457C917E2BF10308216BC4479BFDD843C1D26FBE2BFD02D7B3B82BB9B3F010200000002000000214F097486E2E9BF29FDA88B1A94B3BF527100EA20D2E8BF3686CFBF68F2A8BF010200000002000000527100EA20D2E8BF3686CFBF68F2A8BF8493F75FBBC1E7BF34249AD0387995BF0102000000020000008493F75FBBC1E7BF34249AD0387995BFB6B5EED555B1E6BF1010AB797FC97B3F010200000002000000B6B5EED555B1E6BF1010AB797FC97B3FE7D7E54BF0A0E5BF1ED6B746FCAEA13F010200000002000000214F097486E2E9BF29FDA88B1A94B3BF4EF5DD985145E7BF77F94D158876B5BF0102000000020000004EF5DD985145E7BF77F94D158876B5BF7B9BB2BD1CA8E4BFC4F5F29EF558B7BF0102000000020000007B9BB2BD1CA8E4BFC4F5F29EF558B7BFA84187E2E70AE2BF12F29728633BB9BF010200000002000000A84187E2E70AE2BF12F29728633BB9BFACCFB70E66DBDEBF5FEE3CB2D01DBBBF01020000000200000056D136AF4FF1E8BF55877036A004D03FC9706B609D2DE9BF59AB33006D94C53F010200000002000000C9706B609D2DE9BF59AB33006D94C53F3C10A011EB69E9BF16900C27333FB63F0102000000020000003C10A011EB69E9BF16900C27333FB63FAEAFD4C238A6E9BF80971CDBC458753F010200000002000000AEAFD4C238A6E9BF80971CDBC458753F214F097486E2E9BF28FDA88B1A94B3BF01020000000200000015D41285F8F8DCBF0E1697596544CC3FDDC3B41DB119E1BF3594691E9C35CD3F010200000002000000DDC3B41DB119E1BF3594691E9C35CD3FB01DE0F8E5B6E3BF5C123CE3D226CE3F010200000002000000B01DE0F8E5B6E3BF5C123CE3D226CE3F83770BD41A54E6BF83900EA80918CF3F01020000000200000083770BD41A54E6BF83900EA80918CF3F56D136AF4FF1E8BF55877036A004D03F010200000002000000ACCFB70E66DBDEBF5FEE3CB2D01DBBBFC7904EACCA62DEBFFF9E8863A7D098BF010200000002000000C7904EACCA62DEBFFF9E8863A7D098BFE051E5492FEADDBFC13DF100FA6AAD3F010200000002000000E051E5492FEADDBFC13DF100FA6AAD3FFA127CE79371DDBFC0B2E9EC91CFC13F010200000002000000FA127CE79371DDBFC0B2E9EC91CFC13F15D41285F8F8DCBF111697596544CC3F010200000002000000C615ADA7E4B6E3BF79C88948D079F9BF85963905FE55E1BF0ADF5409778EE8BF01020000000200000085963905FE55E1BF0ADF5409778EE8BF892E8CC52EEADDBFC02D9DE6276BAD3F010200000002000000892E8CC52EEADDBFC02D9DE6276BAD3F0530A5806128D9BFC0842806DC3BEC3F0102000000020000000530A5806128D9BFC0842806DC3BEC3F8331BE3B9466D4BF559BF3C68250FB3F010200000002000000127D5A14B82BEEBF658920E63401F9BFD1FDE671D1CAEBBFE2608244409DE7BF010200000002000000D1FDE671D1CAEBBFE2608244409DE7BF907E73CFEA69E9BF2088E2194A3FB63F010200000002000000907E73CFEA69E9BF2088E2194A3FB63F4FFFFF2C0409E7BFE802FBCA122DED3F0102000000020000004FFFFF2C0409E7BFE802FBCA122DED3F0E808C8A1DA8E4BF6ADA5C291EC9FB3F0102000000020000006F34B6D10CFBEFBF07D50A125E59F7BFF70F3E293575EFBFD68545DA655FF7BF010200000002000000F70F3E293575EFBFD68545DA655FF7BF80EBC5805DEFEEBFA53680A26D65F7BF01020000000200000080EBC5805DEFEEBFA53680A26D65F7BF08C74DD88569EEBF74E7BA6A756BF7BF01020000000200000008C74DD88569EEBF74E7BA6A756BF7BF90A2D52FAEE3EDBF4798F5327D71F7BF010200000002000000CBECF1108607E7BF8BAA1C978551FA3F53C87968AE81E6BFBCF9E1CE7D4BFA3F01020000000200000053C87968AE81E6BFBCF9E1CE7D4BFA3FDCA301C0D6FBE5BFE948A7067645FA3F010200000002000000DCA301C0D6FBE5BFE948A7067645FA3F647F8917FF75E5BF1A986C3E6E3FFA3F010200000002000000647F8917FF75E5BF1A986C3E6E3FFA3FEC5A116F27F0E4BF4BE731766639FA3F0102000000020000001A7176134881EBBF60C1A39530C1B73F0BA2BA95E88DF2BFFC3A38A5F42FC33F0102000000020000000BA2BA95E88DF2BFFC3A38A5F42FC33FF9E9E9B3EB15F7BFD45C66CCF3ECD03F010200000002000000F9E9E9B3EB15F7BFD45C66CCF3ECD03F8A200244192CFBBF6724740417A7DB3F0102000000020000008A200244192CFBBF6724740417A7DB3F0D72800A3DA8FEBF32268BD36DAEE43F010200000002000000514AFA18D3F7FFBF6A663D778ED3D0BF9A53B5CD31EDFBBF15B957152751B7BF0102000000020000009A53B5CD31EDFBBF15B957152751B7BFE800C1FF226DF7BFC4CEBC6201D89C3F010200000002000000E800C1FF226DF7BFC4CEBC6201D89C3F7D14458EECA3F2BFC64D1170E71AB73F0102000000020000007D14458EECA3F2BFC64D1170E71AB73F197176134881EBBF64C1A39530C1B73F010200000002000000CBECF1108607E7BF8BAA1C978551FA3F78115E99E14CF0BF9C53BDA6F152F63F01020000000200000078115E99E14CF0BF9C53BDA6F152F63F872C432A0016F5BFB1FC5DB65D54F23F010200000002000000872C432A0016F5BFB1FC5DB65D54F23F974728BB1EDFF9BF834BFD8B93ABEC3F010200000002000000974728BB1EDFF9BF834BFD8B93ABEC3FA7620D4C3DA8FEBFA89D3EAB6BAEE43F010200000002000000E204325B0BFBEFBF286172425E59F7BF8430321519FCF3BFE586FEB53F90F2BF0102000000020000008430321519FCF3BFE586FEB53F90F2BF955ECB7CACFAF7BF40591553428EEBBF010200000002000000955ECB7CACFAF7BF40591553428EEBBFAA8C64E43FF9FBBFB7A42D3A05FCE1BF010200000002000000AA8C64E43FF9FBBFB7A42D3A05FCE1BFBBBAFD4BD3F7FFBF5BE08B4290D3D0BF010200000002000000EC5A116F27F0E4BF4BE731766639FA3FD56C421F092DE7BFCF0ED0175B9DEB3F010200000002000000D56C421F092DE7BFCF0ED0175B9DEB3FBE7E73CFEA69E9BF3078E2194A3FB63F010200000002000000BE7E73CFEA69E9BF3078E2194A3FB63FA790A47FCCA6EBBFC4705791880DE6BF010200000002000000A790A47FCCA6EBBFC4705791880DE6BF90A2D52FAEE3EDBF4798F5327D71F7BF010200000002000000CBECF1108607E7BF8BAA1C978551FA3FB4FE22C16744E9BF4B95A55999CDEB3F010200000002000000B4FE22C16744E9BF4B95A55999CDEB3F9D1054714981EBBF10AC8E283CC1B73F0102000000020000009D1054714981EBBF10AC8E283CC1B73F862285212BBEEDBF48EA814F4ADDE5BF010200000002000000862285212BBEEDBF48EA814F4ADDE5BF6F34B6D10CFBEFBF07D50A125E59F7BF01020000000200000021911AB78A21F0BFC8DC96F716E9F8BFDE4B3E293EBDEFBF2AD455BB1EEFF8BF010200000002000000DE4B3E293EBDEFBF2AD455BB1EEFF8BF7A7547E46637EFBF8CCB147F26F5F8BF0102000000020000007A7547E46637EFBF8CCB147F26F5F8BF169F509F8FB1EEBFEEC2D3422EFBF8BF010200000002000000169F509F8FB1EEBFEEC2D3422EFBF8BFB2C8595AB82BEEBF55BA92063601F9BF010200000002000000DEBAD45A0BFBEFBF16C06C405E59F7BF5A6AD6EF8606F0BF4447376E4CBDF7BF0102000000020000005A6AD6EF8606F0BF4447376E4CBDF7BF48774232880FF0BF6DCE019C3A21F8BF01020000000200000048774232880FF0BF6DCE019C3A21F8BF3284AE748918F0BF9B55CCC92885F8BF0102000000020000003284AE748918F0BF9B55CCC92885F8BF21911AB78A21F0BFC8DC96F716E9F8BF010200000002000000DDBEB7B87ABFE6BFED5A4B0A3DE1FB3FE4D88F3D7DD1E6BFC3D280DC4E7DFB3F010200000002000000E4D88F3D7DD1E6BFC3D280DC4E7DFB3FEBF267C27FE3E6BF954AB6AE6019FB3F010200000002000000EBF267C27FE3E6BF954AB6AE6019FB3FF20C404782F5E6BF6BC2EB8072B5FA3F010200000002000000F20C404782F5E6BF6BC2EB8072B5FA3FF92618CC8407E7BF413A21538451FA3F0102000000020000004D65DCA41DA8E4BF617D4FFB1DC9FB3FB13BD3E9F42DE5BFC3740EBF25CFFB3F010200000002000000B13BD3E9F42DE5BFC3740EBF25CFFB3F1512CA2ECCB3E5BF256CCD822DD5FB3F0102000000020000001512CA2ECCB3E5BF256CCD822DD5FB3F79E8C073A339E6BF8B638C4635DBFB3F01020000000200000079E8C073A339E6BF8B638C4635DBFB3FDDBEB7B87ABFE6BFED5A4B0A3DE1FB3F01020000000200000069CD3CB827F0E4BFB55C25446539FA3F62B3643325DEE4BFDFE4EF71539DFA3F01020000000200000062B3643325DEE4BFDFE4EF71539DFA3F5B998CAE22CCE4BF096DBA9F4101FB3F0102000000020000005B998CAE22CCE4BF096DBA9F4101FB3F547FB42920BAE4BF37F584CD2F65FB3F010200000002000000547FB42920BAE4BF37F584CD2F65FB3F4D65DCA41DA8E4BF617D4FFB1DC9FB3F010200000002000000B2C8595AB82BEEBF55BA92063601F9BFD9AE81D5B519EEBF2733C8D8479DF8BF010200000002000000D9AE81D5B519EEBF2733C8D8479DF8BF0095A950B307EEBFF9ABFDAA5939F8BF0102000000020000000095A950B307EEBFF9ABFDAA5939F8BF277BD1CBB0F5EDBFD024337D6BD5F7BF010200000002000000277BD1CBB0F5EDBFD024337D6BD5F7BF4E61F946AEE3EDBFA29D684F7D71F7BF010200000002000000CBECF1108607E7BF8BAA1C978551FA3F53C87968AE81E6BFBCF9E1CE7D4BFA3F01020000000200000053C87968AE81E6BFBCF9E1CE7D4BFA3FDCA301C0D6FBE5BFE948A7067645FA3F010200000002000000DCA301C0D6FBE5BFE948A7067645FA3F647F8917FF75E5BF1A986C3E6E3FFA3F010200000002000000647F8917FF75E5BF1A986C3E6E3FFA3FEC5A116F27F0E4BF4BE731766639FA3F0102000000020000006F34B6D10CFBEFBF07D50A125E59F7BFF70F3E293575EFBFD68545DA655FF7BF010200000002000000F70F3E293575EFBFD68545DA655FF7BF80EBC5805DEFEEBFA53680A26D65F7BF01020000000200000080EBC5805DEFEEBFA53680A26D65F7BF08C74DD88569EEBF74E7BA6A756BF7BF01020000000200000008C74DD88569EEBF74E7BA6A756BF7BF90A2D52FAEE3EDBF4798F5327D71F7BF01020000000200000024EF11244A8EFF3F436F29BA90ABF83F4D69751CACA8FF3F726205A157D0F93F0102000000020000004D69751CACA8FF3F726205A157D0F93F76E3D8140EC3FF3F9D55E1871EF5FA3F01020000000200000076E3D8140EC3FF3F9D55E1871EF5FA3F9A5D3C0D70DDFF3FCD48BD6EE519FC3F0102000000020000009A5D3C0D70DDFF3FCD48BD6EE519FC3FC3D79F05D2F7FF3FF83B9955AC3EFD3F0102000000020000003AD3F55F69BDFA3FAD51ED5D10C6FCBFB6E95E8C030CFC3F7C26A83037E4FCBF010200000002000000B6E95E8C030CFC3F7C26A83037E4FCBF3300C8B89D5AFD3F46FB62035E02FDBF0102000000020000003300C8B89D5AFD3F46FB62035E02FDBFAF1631E537A9FE3F14D01DD68420FDBF010200000002000000AF1631E537A9FE3F14D01DD68420FDBF2C2D9A11D2F7FF3FDEA4D8A8AB3EFDBF010200000002000000EC84B4BA367FFF3F04E6F4A34304F83F7FD80464C34EFE3F30B0F8465DA3E53F0102000000020000007FD80464C34EFE3F30B0F8465DA3E53F152C550D501EFD3FA7AEE1E73207C3BF010200000002000000152C550D501EFD3FA7AEE1E73207C3BFA77FA5B6DCEDFB3F8687E9BAF626EFBF010200000002000000A77FA5B6DCEDFB3F8687E9BAF626EFBF3AD3F55F69BDFA3FAD51ED5D10C6FCBF'::geometry
 g
 ) f;
 -- 196;19
 }}}

 Checking the !MultiLineString with JTS, unaryUnion throws:
 > `org.locationtech.jts.geom.TopologyException :
 org.locationtech.jts.geom.TopologyException: found non-noded intersection
 between LINESTRING ( -0.4491549343973113 1.174036466369178,
 -0.3674646915678779 1.166675201086921 ) and LINESTRING (
 -0.3930896526624113 0.8823070640829869, -0.3552886889282823
 1.301796076939312 ) [ (-0.3674646915678779, 1.166675201086921, NaN) ]`

 ----
 This issue was initially reported at
 [https://github.com/Toblerity/Shapely/issues/970 Shapely#970]

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1046>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 20 16:20:48 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 20 Aug 2020 23:20:48 -0000
Subject: [geos-devel] [GEOS] #1046: Unary union does not combine all
	parts
In-Reply-To: <045.4b1222dc9e4205efbe02100d334127d4@osgeo.org>
References: <045.4b1222dc9e4205efbe02100d334127d4@osgeo.org>
Message-ID: <060.1e5be5fad0ee7f2eb39b9a84c62a43a7@osgeo.org>

#1046: Unary union does not combine all parts
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by mdavis):

 Not sure what's going wrong in GEOS.  Possibly a robustness error causes
 some of the result components to be omitted (which is of course a bug).

 The good news is that the forthcoming OverlayNG handles this using
 snapping.  This is a good test case to add to the corpus.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1046#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Fri Aug 21 12:44:34 2020
From: geos-trac at osgeo.org (GEOS)
Date: Fri, 21 Aug 2020 19:44:34 -0000
Subject: [geos-devel] [GEOS] #1034: Union topology exceptions lead to
 complete loss of floating point precision
In-Reply-To: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
References: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
Message-ID: <063.23bebeb757f1003d31741c78f3f9ad95@osgeo.org>

#1034: Union topology exceptions lead to complete loss of floating point precision
-------------------------+---------------------------
 Reporter:  dannytoone   |       Owner:  geos-devel@…
     Type:  defect       |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  3.8.0
 Severity:  Significant  |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by dannytoone):

 @mdavis

 I found your repo where you're developing OverlayNG and I'm currently
 trying to build it and use it on some of the geometries I've worked with.
 It is [https://github.com/dr-jts/jts/tree/overlay-sr], right? And the
 OverlayNGSnapIfNeeded.union method?

 I could help with geometries and stack traces for any exceptions
 thrown...is there an easy way to serialize the data that throws the
 exceptions? I'm fairly unfamiliar with JTS and java in general, so any
 help would be appreciated.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1034#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Fri Aug 21 14:56:21 2020
From: geos-trac at osgeo.org (GEOS)
Date: Fri, 21 Aug 2020 21:56:21 -0000
Subject: [geos-devel] [GEOS] #1034: Union topology exceptions lead to
 complete loss of floating point precision
In-Reply-To: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
References: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
Message-ID: <063.44d7fed6c7b8a5addad8158732bd4208@osgeo.org>

#1034: Union topology exceptions lead to complete loss of floating point precision
-------------------------+---------------------------
 Reporter:  dannytoone   |       Owner:  geos-devel@…
     Type:  defect       |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  3.8.0
 Severity:  Significant  |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by mdavis):

 Yes, that is the repo for OverlayNG.

 It would be great if you are able to test this.  I'm happy to help with
 advice on building and running JTS.

 You can use `WKBWriter` to serialize geometry data.  (I assume you are
 creating the data synthetically, since otherwise you would already have an
 image of the data?).

 If you are building from source, you could even add some code at the point
 the exception is thrown to write out just the geometries which cause the
 exception (as opposed to the full union() input dataset).  The location is
 given in the stack trace.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1034#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sat Aug 22 09:02:34 2020
From: geos-trac at osgeo.org (GEOS)
Date: Sat, 22 Aug 2020 16:02:34 -0000
Subject: [geos-devel] [GEOS] #1047: GEOS Panics on GeometryCollection with 1
 MultiPolygon object
Message-ID: <042.fab70f2ddc7e3e25e3dfb748888ae40a@osgeo.org>

#1047: GEOS Panics on GeometryCollection with 1 MultiPolygon object
------------------------+--------------------------
 Reporter:  otan        |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:
Component:  Default     |    Version:  3.8.0
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 Tested on v3.8.1.

 The following code will seg fault:

 {{{
 #include <geos_c.h>
 #include <string>

 using namespace std;

 void geos_message_handler(const char *fmt, ...) {}
 void geos_error_handler(const char *fmt, ...) {}

 int main() {
   string aEWKB =
 "01020000000200000000000000000000000000000000000000000000000000F03F0000000000000000";
   string bEWKB =
 "0107000000010000000106000000010000000103000000010000000500000008690b3a70a9c347540a11d15993eec7e04b9e4d8fd2cb4702907c2929abe847d02aef5652e3cec72c1b57867da3dd47bbf47698d501eac7ccc0d287b380d44708690b3a70a9c347540a11d15993eec7";

   initGEOS(&geos_message_handler, &geos_error_handler);

   auto wkbReader = GEOSWKBReader_create();
   auto geomA = GEOSWKBReader_read(wkbReader, reinterpret_cast<const
 unsigned char*>(aEWKB.data()), aEWKB.length());
   auto geomB = GEOSWKBReader_read(wkbReader, reinterpret_cast<const
 unsigned char*>(bEWKB.data()), bEWKB.length());
   GEOSIntersects(geomA, geomB);
   return 0;
 }
 }}}

 Seems like geometryN does not work and returns NULL:


 {{{
 _ZN4geos9algorithm6locate24SimplePointInAreaLocator20locatePointInPolygonERKNS_4geom10CoordinateEPKNS3_7PolygonE
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x14218db3
 _ZN4geos9geomgraph11EdgeEndStar11getLocationEiRKNS_4geom10CoordinateEPNSt3__16vectorIPNS0_13GeometryGraphENS6_9allocatorIS9_EEEE
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x1423fce8
 _ZN4geos9geomgraph11EdgeEndStar16computeLabellingEPNSt3__16vectorIPNS0_13GeometryGraphENS2_9allocatorIS5_EEEE
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x1423f936
 _ZN4geos9operation6relate14RelateComputer9computeIMEv
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x142a95a3
 _ZN4geos9operation6relate8RelateOp6relateEPKNS_4geom8GeometryES6_
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x142ab1f2
 _ZNK4geos4geom8Geometry10intersectsEPKS1_
 /Users/otan/go/src/github.com/cockroachdb/cockroach/lib/libgeos.dylib:0
 pc=0x14220773
 GEOSIntersects_r
 }}}

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1047>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From strk at kbt.io  Mon Aug 24 12:38:35 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 24 Aug 2020 21:38:35 +0200
Subject: [geos-devel] Test OverlayNG for MVT tiling
In-Reply-To: <CAK2ens1OLn6=AE_nHQe83OoYdxaPWDaDfWYZOUNjZptGHdeH3Q@mail.gmail.com>
References: <30A6EBB1-63D2-43A8-8733-EA819EB9465B@cleverelephant.ca>
 <005501d6653b$f5d8cbb0$e18a6310$@pcorp.us>
 <CAM6_UM7f6egzCGrkkd92bGWJhhdhQ_Xm1ph7pmjdDi=OjXx0=Q@mail.gmail.com>
 <CAK2ens2ASTnNsGzTDWZ7M0Y10jhGrry1Eh7C-AKUbwtNk-Qc3w@mail.gmail.com>
 <CAM6_UM5XQsCdxdQGpe+1QWn0k6-pKpTZeMm23fj5bcPXPzO7QA@mail.gmail.com>
 <CAK2ens1OLn6=AE_nHQe83OoYdxaPWDaDfWYZOUNjZptGHdeH3Q@mail.gmail.com>
Message-ID: <20200824193835.GA64534@lif>

On Mon, Aug 03, 2020 at 11:48:02AM -0700, Martin Davis wrote:
> Great that you're testing this.
> 
> Yes, currently the precision is not exposed via the C API (well, I think it
> is technically, by setting the geometry precision model, but this involves
> an expensive (and unnecessary) precision reduction step, so that's useless
> for performance.
> 
> My hope is that the C API will expose overlay operations which take an
> explicit precision (scale factor = 1 / grid size). This will invoke
> snap-rounding, which should provide fully-robust rounded geometry - ideal
> for clipping to low-resolution tiles - I hope!

Here it is: https://git.osgeo.org/gitea/geos/geos/pulls/105

I'm merging it shortly.


--strk;

From strk at kbt.io  Mon Aug 24 12:58:45 2020
From: strk at kbt.io (Sandro Santilli)
Date: Mon, 24 Aug 2020 21:58:45 +0200
Subject: [geos-devel] Test OverlayNG for MVT tiling
In-Reply-To: <20200824193835.GA64534@lif>
References: <30A6EBB1-63D2-43A8-8733-EA819EB9465B@cleverelephant.ca>
 <005501d6653b$f5d8cbb0$e18a6310$@pcorp.us>
 <CAM6_UM7f6egzCGrkkd92bGWJhhdhQ_Xm1ph7pmjdDi=OjXx0=Q@mail.gmail.com>
 <CAK2ens2ASTnNsGzTDWZ7M0Y10jhGrry1Eh7C-AKUbwtNk-Qc3w@mail.gmail.com>
 <CAM6_UM5XQsCdxdQGpe+1QWn0k6-pKpTZeMm23fj5bcPXPzO7QA@mail.gmail.com>
 <CAK2ens1OLn6=AE_nHQe83OoYdxaPWDaDfWYZOUNjZptGHdeH3Q@mail.gmail.com>
 <20200824193835.GA64534@lif>
Message-ID: <20200824195845.GB64534@lif>

On Mon, Aug 24, 2020 at 09:38:35PM +0200, Sandro Santilli wrote:
> On Mon, Aug 03, 2020 at 11:48:02AM -0700, Martin Davis wrote:
> > Great that you're testing this.
> > 
> > Yes, currently the precision is not exposed via the C API (well, I think it
> > is technically, by setting the geometry precision model, but this involves
> > an expensive (and unnecessary) precision reduction step, so that's useless
> > for performance.
> > 
> > My hope is that the C API will expose overlay operations which take an
> > explicit precision (scale factor = 1 / grid size). This will invoke
> > snap-rounding, which should provide fully-robust rounded geometry - ideal
> > for clipping to low-resolution tiles - I hope!
> 
> Here it is: https://git.osgeo.org/gitea/geos/geos/pulls/105
> 
> I'm merging it shortly.

Merged with 87ce4c1a06460d82fa97fb1c7736434015928ac5

--strk;

From geos-trac at osgeo.org  Tue Aug 25 18:16:36 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 26 Aug 2020 01:16:36 -0000
Subject: [geos-devel] [GEOS] #1042: Segfault on multipolygon
In-Reply-To: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
References: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
Message-ID: <060.7ee371d8ec121d5c9170cf84ecccd42c@osgeo.org>

#1042: Segfault on multipolygon
------------------------+---------------------------
 Reporter:  stefgis     |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  minor       |   Milestone:
Component:  Default     |     Version:  3.8.0
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by otan):

 Looks the same as https://trac.osgeo.org/geos/ticket/1047.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1042#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Wed Aug 26 02:12:49 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 26 Aug 2020 09:12:49 -0000
Subject: [geos-devel] [GEOS] #1042: Segfault on multipolygon
In-Reply-To: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
References: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
Message-ID: <060.4846ae7cd44f4b103adbb45992e04409@osgeo.org>

#1042: Segfault on multipolygon
------------------------+---------------------------
 Reporter:  stefgis     |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  minor       |   Milestone:
Component:  Default     |     Version:  3.8.0
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by stefgis):

 Yes, looks like it.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1042#comment:3>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Wed Aug 26 02:18:56 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 26 Aug 2020 09:18:56 -0000
Subject: [geos-devel] [GEOS] #1042: Segfault on multipolygon
In-Reply-To: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
References: <045.74b275ead7856326ae7320f1abd5bbc6@osgeo.org>
Message-ID: <060.5e6a61f3bf0f9dee6ba92d0787490d67@osgeo.org>

#1042: Segfault on multipolygon
------------------------+---------------------------
 Reporter:  stefgis     |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  minor       |   Milestone:
Component:  Default     |     Version:  3.8.0
 Severity:  Unassigned  |  Resolution:  duplicate
 Keywords:              |
------------------------+---------------------------
Changes (by strk):

 * status:  new => closed
 * resolution:   => duplicate


Comment:

 Duplicate of #1047

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1042#comment:4>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Wed Aug 26 08:44:42 2020
From: geos-trac at osgeo.org (GEOS)
Date: Wed, 26 Aug 2020 15:44:42 -0000
Subject: [geos-devel] [GEOS] #1043: [OverlayNG]
	tests/general/TestOverlayLL.xml fails
In-Reply-To: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
References: <042.89310c7780fc6f190d1fbbff4abed00a@osgeo.org>
Message-ID: <057.7e4c4656f03aa074a1efde7a70605242@osgeo.org>

#1043: [OverlayNG] tests/general/TestOverlayLL.xml fails
------------------------+---------------------------
 Reporter:  strk        |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:  3.9.0
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------

Comment (by pramsey):

 Very nice catch.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1043#comment:6>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 27 15:00:03 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 27 Aug 2020 22:00:03 -0000
Subject: [geos-devel] [GEOS] #1034: Union topology exceptions lead to
 complete loss of floating point precision
In-Reply-To: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
References: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
Message-ID: <063.553609771e1edc2abac65004805ff528@osgeo.org>

#1034: Union topology exceptions lead to complete loss of floating point precision
-------------------------+---------------------------
 Reporter:  dannytoone   |       Owner:  geos-devel@…
     Type:  defect       |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  3.8.0
 Severity:  Significant  |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by dannytoone):

 Just gave it a runthrough on my dataset, and with the exception of a stack
 overflow error (fixed by increasing the stack size through `-Xss`), it ran
 flawlessly. I fully expected to see a bunch of exceptions, but it handled
 them all really well. Visually I can't find any flaws in the result.

 The operation was basically a process to flatten a bunch of geometries
 using a process similar to this: http://blog.cleverelephant.ca/2019/07
 /postgis-overlays.html

 My full dataset is probably too big to post here, but here I'll try to
 attach a photo of the resulting geometries to get an idea at what I was
 throwing at it.

 Not sure if it would be useful to find a way to get you this dataset for
 exploring the behavior around topology exceptions that are handled
 internally. I know for a fact that this same dataset will reproduce the
 error linked above in the postgis tracker.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1034#comment:4>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 27 15:03:56 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 27 Aug 2020 22:03:56 -0000
Subject: [geos-devel] [GEOS] #1034: Union topology exceptions lead to
 complete loss of floating point precision
In-Reply-To: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
References: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
Message-ID: <063.8f46ba861d82c86568608b243e621155@osgeo.org>

#1034: Union topology exceptions lead to complete loss of floating point precision
-------------------------+---------------------------
 Reporter:  dannytoone   |       Owner:  geos-devel@…
     Type:  defect       |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  3.8.0
 Severity:  Significant  |  Resolution:
 Keywords:               |
-------------------------+---------------------------
Changes (by dannytoone):

 * Attachment "image.png" added.

 fully unioned dataset

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1034>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Thu Aug 27 15:58:26 2020
From: geos-trac at osgeo.org (GEOS)
Date: Thu, 27 Aug 2020 22:58:26 -0000
Subject: [geos-devel] [GEOS] #1034: Union topology exceptions lead to
 complete loss of floating point precision
In-Reply-To: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
References: <048.09792d1927f25cb0a8009c28ba2a9894@osgeo.org>
Message-ID: <063.49cd3c3673d53a8036adf6a632dbff2e@osgeo.org>

#1034: Union topology exceptions lead to complete loss of floating point precision
-------------------------+---------------------------
 Reporter:  dannytoone   |       Owner:  geos-devel@…
     Type:  defect       |      Status:  new
 Priority:  major        |   Milestone:  3.9.0
Component:  Default      |     Version:  3.8.0
 Severity:  Significant  |  Resolution:
 Keywords:               |
-------------------------+---------------------------

Comment (by mdavis):

 Replying to [comment:4 dannytoone]:
 > Just gave it a runthrough on my dataset, and with the exception of a
 stack overflow error (fixed by increasing the stack size through `-Xss`),
 it ran flawlessly. I fully expected to see a bunch of exceptions, but it
 handled them all really well. Visually I can't find any flaws in the
 result.

 Excellent!

 > Not sure if it would be useful to find a way to get you this dataset for
 exploring the behavior around topology exceptions that are handled
 internally. I know for a fact that this same dataset will reproduce the
 error linked above in the postgis tracker.

 That's fine.  We are using some of the data from your synthetic data
 generator as part of the OverlayNG robustness tests.  Given the success of
 your testing, I think we can call this good, and you can wait for
 OverlayNG to land in GEOS.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1034#comment:5>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 30 14:03:02 2020
From: geos-trac at osgeo.org (GEOS)
Date: Sun, 30 Aug 2020 21:03:02 -0000
Subject: [geos-devel] [GEOS] #1048: WKB representation of POINT EMPTY has 3
	dimensions
Message-ID: <045.09b3c48e6a8017106287792e0a467f3d@osgeo.org>

#1048: WKB representation of POINT EMPTY has 3 dimensions
------------------------+--------------------------
 Reporter:  Mike Taves  |      Owner:  geos-devel@…
     Type:  defect      |     Status:  new
 Priority:  major       |  Milestone:
Component:  Default     |    Version:  master
 Severity:  Unassigned  |   Keywords:
------------------------+--------------------------
 This is related to #1005

 An empty point geometry can be created using either `POINT EMPTY` or with
 `GEOSGeom_createEmptyPoint_r`. This geometry returns 0 from `GEOSHasZ_r`
 and the WKT representation is `POINT EMPTY`, as expected.

 However, the WKB representation is
 `0101000080000000000000F87F000000000000F87F000000000000F87F` or `POINT Z
 EMPTY`. The expected result should be
 `0101000000000000000000F87F000000000000F87F`.

 The only workaround is to use `GEOSWKBWriter_setOutputDimension_r` to
 write a 2D representation.

 Note that WKB representations of `MULTIPOINT EMPTY` or
 `GEOSGeom_createEmptyLineString_r` do not contain Z coordinate info, for
 any WKB writer output dimension setting.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1048>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 30 14:10:44 2020
From: geos-trac at osgeo.org (GEOS)
Date: Sun, 30 Aug 2020 21:10:44 -0000
Subject: [geos-devel] [GEOS] #1005: Writing POINT EMPTY in WKB
In-Reply-To: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
References: <045.366567d3a98a536e7a5028bd2b4c1f41@osgeo.org>
Message-ID: <060.d6ed51f96589a31fcaf3a563af5d53f5@osgeo.org>

#1005: Writing POINT EMPTY in WKB
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  closed
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Annoyance   |  Resolution:  fixed
 Keywords:              |
------------------------+---------------------------

Comment (by Mike Taves):

 A related issue regarding the 3D oddities is in #1048

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1005#comment:8>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 30 14:15:02 2020
From: geos-trac at osgeo.org (GEOS)
Date: Sun, 30 Aug 2020 21:15:02 -0000
Subject: [geos-devel] [GEOS] #1048: WKB representation of POINT EMPTY
	has 3 dimensions
In-Reply-To: <045.09b3c48e6a8017106287792e0a467f3d@osgeo.org>
References: <045.09b3c48e6a8017106287792e0a467f3d@osgeo.org>
Message-ID: <060.7f3a8bca2457e89c702fd1a134885a65@osgeo.org>

#1048: WKB representation of POINT EMPTY has 3 dimensions
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by Mike Taves):

 Also, unsure if this is directly related, but WKT `GEOMETRYCOLLECTION
 (MULTIPOINT EMPTY)` returns WKB
 `0107000080010000000101000080000000000000F87F000000000000F87F000000000000F87F`
 or `GEOMETRYCOLLECTION Z (POINT Z EMPTY)`

 Whereas `GEOMETRYCOLLECTION (MULTIPOINT EMPTY)` remains a 2D
 !GeometryCollection with `010700000001000000010400000000000000`

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1048#comment:1>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

From geos-trac at osgeo.org  Sun Aug 30 14:22:42 2020
From: geos-trac at osgeo.org (GEOS)
Date: Sun, 30 Aug 2020 21:22:42 -0000
Subject: [geos-devel] [GEOS] #1048: WKB representation of POINT EMPTY
	has 3 dimensions
In-Reply-To: <045.09b3c48e6a8017106287792e0a467f3d@osgeo.org>
References: <045.09b3c48e6a8017106287792e0a467f3d@osgeo.org>
Message-ID: <060.e7a88be6f2b3d57a441c0a6373166b44@osgeo.org>

#1048: WKB representation of POINT EMPTY has 3 dimensions
------------------------+---------------------------
 Reporter:  Mike Taves  |       Owner:  geos-devel@…
     Type:  defect      |      Status:  new
 Priority:  major       |   Milestone:
Component:  Default     |     Version:  master
 Severity:  Unassigned  |  Resolution:
 Keywords:              |
------------------------+---------------------------

Comment (by Mike Taves):

 Another related inconsistency `GEOMETRYCOLLECTION (POINT(1 2), POINT
 EMPTY)` returns
 `0107000080020000000101000000000000000000F03F00000000000000400101000080000000000000F87F000000000000F87F000000000000F87F`,
 which is not portable WKB. Handing this to PostGIS raises "Dimensions
 mismatch in lwcollection", because of the extra coordinate surprise.

-- 
Ticket URL: <https://trac.osgeo.org/geos/ticket/1048#comment:2>
GEOS <http://trac.osgeo.org/geos>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).

