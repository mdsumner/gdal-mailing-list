From Allan.Meek at drdc-rddc.gc.ca  Wed Jan  2 16:02:13 2008
From: Allan.Meek at drdc-rddc.gc.ca (Meek, Allan (Contractor))
Date: Wed Jan  2 16:02:16 2008
Subject: [geos-devel] Compiling troubles
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Hi,

I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
Red Hat Linux, but I have encountered some troubles.

Here are the steps I followed:

- extracted the contents of the tar file to /rde/ameek/GEOS/geos-3.0.0
- set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
- created the directory /rde/ameek/GEOS/binlin
- from the geos-3.0.0 directory, executed "./configure
--prefix=${INSTALL}"
- executed "make"; everything looked good
- executed "make check"; everything looked good
- executed "make install"; I ended up with the following error messages:

=================================================

{...}
make[4]: Entering directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[5]: Entering directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[6]: Entering directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[6]: Nothing to be done for 'install-exec-am'.
test -z "/rde/ameek/GEOS/binlin/include/geos/algorithm" || mkdir -p --
"/rde/ameek/GEOS/binlin/include/geos/algorithm"
 /rde/ameek/GEOS/binlin -m 644 'LineIntersector.h'
'/rde/ameek/GEOS/binlin/include/geos/algorithm/LineIntersector.h'
/bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
 /rde/ameek/GEOS/binlin -m 644 'PointLocator.h'
'/rde/ameek/GEOS/binlin/include/geos/algorithm/PointLocator.h'
/bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
make[6]: *** [install-geosHEADERS] Error 126
make[6]: Leaving directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[5]: *** [install-am] Error 2
make[5]: Leaving directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[4]: *** [install-recursive] Error 1
make[4]: Leaving directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
make[3]: *** [install-recursive] Error 1
make[3]: Leaving directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos'
make[2]: *** [install-recursive] Error 1
make[2]: Leaving directory
'/home/rde/ameek/GEOS/geos-3.0.0/source/headers'
make[1]: *** [install-recursive] Error 1
make[1]: Leaving directory '/home/rde/ameek/GEOS/geos-3.0.0/source'
make: *** [install-recursive] Error 1

* /home/rde and /rde point to the same location.
=================================================

What can I do to avoid this problem and complete the installation?

Thanks,
Allan
From mateusz at loskot.net  Wed Jan  2 16:30:04 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jan  2 16:30:14 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <477C025C.2030908@loskot.net>

Meek, Allan (Contractor) wrote:
> Hi,
> 
> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
> Red Hat Linux, but I have encountered some troubles.
> 
> Here are the steps I followed:
> 
> - extracted the contents of the tar file to /rde/ameek/GEOS/geos-3.0.0
> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
> - created the directory /rde/ameek/GEOS/binlin
> - from the geos-3.0.0 directory, executed "./configure
> --prefix=${INSTALL}"
> - executed "make"; everything looked good
> - executed "make check"; everything looked good
> - executed "make install"; I ended up with the following error messages:
> [...]


Allan,

Shouldn't the last command read:

sudo make install

unless you have sufficient privs to write to prefix location?

I just tested GEOS from SVN and make install command works perfectly
well for me. I assume both SVN and 3.0.0 makefiles are correct.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
From Allan.Meek at drdc-rddc.gc.ca  Wed Jan  2 16:33:58 2008
From: Allan.Meek at drdc-rddc.gc.ca (Meek, Allan (Contractor))
Date: Wed Jan  2 16:34:02 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <477C025C.2030908@loskot.net>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<477C025C.2030908@loskot.net>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E0B2348@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Hi Mateusz,

Whoops. My configure line was actually "./configure --prefix=${INSTALL}"
so that things would be installed in /rde/ameek/GEOS/binlin. So, I
wouldn't need sudo to run "make install".

I think my biggest question is this: What does Error 126 mean?

Thanks for your help,
Allan


-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Mateusz Loskot
Sent: January 2, 2008 4:30 PM
To: GEOS Development List
Subject: Re: [geos-devel] Compiling troubles

Meek, Allan (Contractor) wrote:
> Hi,
> 
> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
> Red Hat Linux, but I have encountered some troubles.
> 
> Here are the steps I followed:
> 
> - extracted the contents of the tar file to /rde/ameek/GEOS/geos-3.0.0
> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
> - created the directory /rde/ameek/GEOS/binlin
> - from the geos-3.0.0 directory, executed "./configure
> --prefix=${INSTALL}"
> - executed "make"; everything looked good
> - executed "make check"; everything looked good
> - executed "make install"; I ended up with the following error
messages:
> [...]


Allan,

Shouldn't the last command read:

sudo make install

unless you have sufficient privs to write to prefix location?

I just tested GEOS from SVN and make install command works perfectly
well for me. I assume both SVN and 3.0.0 makefiles are correct.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From pramsey at refractions.net  Wed Jan  2 16:41:35 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Wed Jan  2 16:41:40 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E0B2348@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<477C025C.2030908@loskot.net>
	<DF1471B5C308B346BF5A2AEA00C5615E0B2348@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <B1A3463E-6A21-4DD7-958D-99482AAC6270@refractions.net>

You might have to pre-make the target directories...

mkdir $INSTALL/bin
mkdir $INSTALL/lib
mkdir $INSTALL/include

P.

On 2-Jan-08, at 1:33 PM, Meek, Allan (Contractor) wrote:

> Hi Mateusz,
>
> Whoops. My configure line was actually "./configure --prefix=$ 
> {INSTALL}"
> so that things would be installed in /rde/ameek/GEOS/binlin. So, I
> wouldn't need sudo to run "make install".
>
> I think my biggest question is this: What does Error 126 mean?
>
> Thanks for your help,
> Allan
>
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Mateusz  
> Loskot
> Sent: January 2, 2008 4:30 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] Compiling troubles
>
> Meek, Allan (Contractor) wrote:
>> Hi,
>>
>> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
>> Red Hat Linux, but I have encountered some troubles.
>>
>> Here are the steps I followed:
>>
>> - extracted the contents of the tar file to /rde/ameek/GEOS/ 
>> geos-3.0.0
>> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
>> - created the directory /rde/ameek/GEOS/binlin
>> - from the geos-3.0.0 directory, executed "./configure
>> --prefix=${INSTALL}"
>> - executed "make"; everything looked good
>> - executed "make check"; everything looked good
>> - executed "make install"; I ended up with the following error
> messages:
>> [...]
>
>
> Allan,
>
> Shouldn't the last command read:
>
> sudo make install
>
> unless you have sufficient privs to write to prefix location?
>
> I just tested GEOS from SVN and make install command works perfectly
> well for me. I assume both SVN and 3.0.0 makefiles are correct.
>
> Cheers
> -- 
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From Allan.Meek at drdc-rddc.gc.ca  Wed Jan  2 16:48:35 2008
From: Allan.Meek at drdc-rddc.gc.ca (Meek, Allan (Contractor))
Date: Wed Jan  2 16:48:37 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <B1A3463E-6A21-4DD7-958D-99482AAC6270@refractions.net>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca><477C025C.2030908@loskot.net><DF1471B5C308B346BF5A2AEA00C5615E0B2348@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<B1A3463E-6A21-4DD7-958D-99482AAC6270@refractions.net>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E0B234D@ottawaex02.Ottawa.drdc-rddc.gc.ca>

I just gave that a try, but the end result is the same. Incidentally,
the "make install" process doesn't have any problem making the include,
include/geos, or the include/geos/algorithm directories.

--Allan.


-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: January 2, 2008 4:42 PM
To: GEOS Development List
Subject: Re: [geos-devel] Compiling troubles

You might have to pre-make the target directories...

mkdir $INSTALL/bin
mkdir $INSTALL/lib
mkdir $INSTALL/include

P.

On 2-Jan-08, at 1:33 PM, Meek, Allan (Contractor) wrote:

> Hi Mateusz,
>
> Whoops. My configure line was actually "./configure --prefix=$ 
> {INSTALL}"
> so that things would be installed in /rde/ameek/GEOS/binlin. So, I
> wouldn't need sudo to run "make install".
>
> I think my biggest question is this: What does Error 126 mean?
>
> Thanks for your help,
> Allan
>
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Mateusz  
> Loskot
> Sent: January 2, 2008 4:30 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] Compiling troubles
>
> Meek, Allan (Contractor) wrote:
>> Hi,
>>
>> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
>> Red Hat Linux, but I have encountered some troubles.
>>
>> Here are the steps I followed:
>>
>> - extracted the contents of the tar file to /rde/ameek/GEOS/ 
>> geos-3.0.0
>> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
>> - created the directory /rde/ameek/GEOS/binlin
>> - from the geos-3.0.0 directory, executed "./configure
>> --prefix=${INSTALL}"
>> - executed "make"; everything looked good
>> - executed "make check"; everything looked good
>> - executed "make install"; I ended up with the following error
> messages:
>> [...]
>
>
> Allan,
>
> Shouldn't the last command read:
>
> sudo make install
>
> unless you have sufficient privs to write to prefix location?
>
> I just tested GEOS from SVN and make install command works perfectly
> well for me. I assume both SVN and 3.0.0 makefiles are correct.
>
> Cheers
> -- 
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From pramsey at refractions.net  Wed Jan  2 16:55:12 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Wed Jan  2 16:55:17 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <2C304D13-00E2-4EC4-BB12-E9477CD5C75E@refractions.net>

Ah, so simple it bonks one over the nose, once you see it:

You over-rode the INSTALL environment variable, which has *whoops*  
special meaning within the context of a "make install" operation...  
it is the program to use to install the files!  Unsetenv INSTALL and  
use something a little less generic.

P

On 2-Jan-08, at 1:02 PM, Meek, Allan (Contractor) wrote:

> Hi,
>
> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
> Red Hat Linux, but I have encountered some troubles.
>
> Here are the steps I followed:
>
> - extracted the contents of the tar file to /rde/ameek/GEOS/geos-3.0.0
> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
> - created the directory /rde/ameek/GEOS/binlin
> - from the geos-3.0.0 directory, executed "./configure
> --prefix=${INSTALL}"
> - executed "make"; everything looked good
> - executed "make check"; everything looked good
> - executed "make install"; I ended up with the following error  
> messages:
>
> =================================================
>
> {...}
> make[4]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[5]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[6]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[6]: Nothing to be done for 'install-exec-am'.
> test -z "/rde/ameek/GEOS/binlin/include/geos/algorithm" || mkdir -p --
> "/rde/ameek/GEOS/binlin/include/geos/algorithm"
>  /rde/ameek/GEOS/binlin -m 644 'LineIntersector.h'
> '/rde/ameek/GEOS/binlin/include/geos/algorithm/LineIntersector.h'
> /bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
>  /rde/ameek/GEOS/binlin -m 644 'PointLocator.h'
> '/rde/ameek/GEOS/binlin/include/geos/algorithm/PointLocator.h'
> /bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
> make[6]: *** [install-geosHEADERS] Error 126
> make[6]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[5]: *** [install-am] Error 2
> make[5]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[4]: *** [install-recursive] Error 1
> make[4]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[3]: *** [install-recursive] Error 1
> make[3]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos'
> make[2]: *** [install-recursive] Error 1
> make[2]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers'
> make[1]: *** [install-recursive] Error 1
> make[1]: Leaving directory '/home/rde/ameek/GEOS/geos-3.0.0/source'
> make: *** [install-recursive] Error 1
>
> * /home/rde and /rde point to the same location.
> =================================================
>
> What can I do to avoid this problem and complete the installation?
>
> Thanks,
> Allan
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From Allan.Meek at drdc-rddc.gc.ca  Wed Jan  2 17:18:19 2008
From: Allan.Meek at drdc-rddc.gc.ca (Meek, Allan (Contractor))
Date: Wed Jan  2 17:18:21 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <2C304D13-00E2-4EC4-BB12-E9477CD5C75E@refractions.net>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<2C304D13-00E2-4EC4-BB12-E9477CD5C75E@refractions.net>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E0B2350@ottawaex02.Ottawa.drdc-rddc.gc.ca>

And there it is! Thanks for the help, Paul and Mateusz. I got rid of the
INSTALL variable, logged out, logged back in, and did a compile from
scratch. Everything looks good now.

Allan



-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: January 2, 2008 4:55 PM
To: GEOS Development List
Subject: Re: [geos-devel] Compiling troubles

Ah, so simple it bonks one over the nose, once you see it:

You over-rode the INSTALL environment variable, which has *whoops*  
special meaning within the context of a "make install" operation...  
it is the program to use to install the files!  Unsetenv INSTALL and  
use something a little less generic.

P

On 2-Jan-08, at 1:02 PM, Meek, Allan (Contractor) wrote:

> Hi,
>
> I just downloaded geos-3.0.0.tar.bz2 today and tried to compile it in
> Red Hat Linux, but I have encountered some troubles.
>
> Here are the steps I followed:
>
> - extracted the contents of the tar file to /rde/ameek/GEOS/geos-3.0.0
> - set the INSTALL environmental variable to /rde/ameek/GEOS/binlin
> - created the directory /rde/ameek/GEOS/binlin
> - from the geos-3.0.0 directory, executed "./configure
> --prefix=${INSTALL}"
> - executed "make"; everything looked good
> - executed "make check"; everything looked good
> - executed "make install"; I ended up with the following error  
> messages:
>
> =================================================
>
> {...}
> make[4]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[5]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[6]: Entering directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[6]: Nothing to be done for 'install-exec-am'.
> test -z "/rde/ameek/GEOS/binlin/include/geos/algorithm" || mkdir -p --
> "/rde/ameek/GEOS/binlin/include/geos/algorithm"
>  /rde/ameek/GEOS/binlin -m 644 'LineIntersector.h'
> '/rde/ameek/GEOS/binlin/include/geos/algorithm/LineIntersector.h'
> /bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
>  /rde/ameek/GEOS/binlin -m 644 'PointLocator.h'
> '/rde/ameek/GEOS/binlin/include/geos/algorithm/PointLocator.h'
> /bin/sh: line 1: /rde/ameek/GEOS/binlin: is a directory
> make[6]: *** [install-geosHEADERS] Error 126
> make[6]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[5]: *** [install-am] Error 2
> make[5]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[4]: *** [install-recursive] Error 1
> make[4]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos/algorithm'
> make[3]: *** [install-recursive] Error 1
> make[3]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers/geos'
> make[2]: *** [install-recursive] Error 1
> make[2]: Leaving directory
> '/home/rde/ameek/GEOS/geos-3.0.0/source/headers'
> make[1]: *** [install-recursive] Error 1
> make[1]: Leaving directory '/home/rde/ameek/GEOS/geos-3.0.0/source'
> make: *** [install-recursive] Error 1
>
> * /home/rde and /rde point to the same location.
> =================================================
>
> What can I do to avoid this problem and complete the installation?
>
> Thanks,
> Allan
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From mateusz at loskot.net  Wed Jan  2 18:14:37 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Jan  2 18:14:43 2008
Subject: [geos-devel] Compiling troubles
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E0B2350@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B233E@ottawaex02.Ottawa.drdc-rddc.gc.ca>	<2C304D13-00E2-4EC4-BB12-E9477CD5C75E@refractions.net>
	<DF1471B5C308B346BF5A2AEA00C5615E0B2350@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <477C1ADD.7060105@loskot.net>

Meek, Allan (Contractor) wrote:
> And there it is! Thanks for the help, Paul and Mateusz. I got rid of the
> INSTALL variable, logged out, logged back in, and did a compile from
> scratch. Everything looks good now.

Allan,

Great to hear it!

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
From chirag19 at yahoo.com  Mon Jan  7 07:35:44 2008
From: chirag19 at yahoo.com (chirag soni)
Date: Mon Jan  7 07:35:47 2008
Subject: [geos-devel] Compiling troubles
Message-ID: <205578.28158.qm@web52504.mail.re2.yahoo.com>

Hello Friends,

I have problem with buffer operation which has same input geometry with three different distance. I have three cases for buffer operation as bellow. Case 1 and Case 3 gives perfect result.But Case 2 has some problem it sould give Multipolygon with two circular polygon like Case3. Case 2 only return one polygon instead of two polygon. there is some problem in buffer operation. please help me. It is happening for all type of Multi Geometry.

------------------------------------------------------------------------
Case : 1
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 60.000000
Status = Working Ok
Result Output Geometry  = POLYGON ((-69.7683199416213710 28.3909394912853800, -69.6644248241938730 29.4458043209674900, -66.2500799506772890 40.7013909419051810, -60.7054847381528480 51.0745989811759390, -53.2437148711930350 60.1667918711926720, -44.1515219811763440 67.6285617381525700, -33.7783139419056230 73.1731569506771110, -22.5227273209679310 76.5875018241937790, -10.8173080000002240 77.7403850000000030, 0.8881113209674876 76.5875018241938650, 12.1436979419052020 73.1731569506772810, 22.5169059811759770 67.6285617381528110, 31.6090988711927250 60.1667918711929700, 39.0708687381526260 51.0745989811762660, 44.6154639506771530 40.7013909419055220, 48.0298088241937930 29.4458043209678270, 49.1826920000000030 17.7403850000000000, 48.0298088241938360 6.0349656790323145, 44.6154639506772240 -5.2206209419053629, 39.0708687381527400 -15.5938289811761060, 31.6090988711928880 -24.6860218711928180, 22.5169059811761830 -32.1477917381526770, 12.1436979419054510
 -37.6923869506771750, 0.8881113209677771 -41.1067318241938150, -10.8173079999999030 -42.2596149999999970, -22.5227273209675900 -41.1067318241938440, -33.7783139419052670 -37.6923869506772460, -44.1515219811760320 -32.1477917381527760, -53.2437148711927510 -24.6860218711929460, -60.7054847381526340 -15.5938289811762550, -64.3133250583786380 -8.8440344912853597, -64.4172201758061650 -9.8988993209676863, -67.8315650493227760 -21.1544859419053640, -73.3761602618472610 -31.5276939811761070, -80.8379301288071020 -40.6198868711928180, -89.9301230188238210 -48.0816567381526810, -100.3033310580945400 -53.6262519506771800, -111.5589176790322200 -57.0405968241938130, -123.2643369999999000 -58.1934800000000010, -134.9697563209675800 -57.0405968241938480, -146.2253429419052700 -53.6262519506772510, -156.5985509811760300 -48.0816567381527800, -165.6907438711927500 -40.6198868711929460, -173.1525137381526300 -31.5276939811762560, -178.6971089506771500
 -21.1544859419055410, -182.1114538241938000 -9.8988993209678746, -183.2643370000000100 1.8065199999998061, -182.1114538241938600 13.5119393209674930, -178.6971089506772900 24.7675259419051810, -173.1525137381528300 35.1407339811759340, -165.6907438711930400 44.2329268711926740, -156.5985509811763400 51.6946967381525650, -146.2253429419056100 57.2392919506771070, -134.9697563209679200 60.6536368241937750, -123.2643370000002200 61.8065199999999990, -111.5589176790325000 60.6536368241938670, -100.3033310580948000 57.2392919506772840, -89.9301230188240200 51.6946967381528140, -80.8379301288072720 44.2329268711929730, -73.3761602618473600 35.1407339811762610, -69.7683199416213710 28.3909394912853800))

------------------------------------------------------------------------
Case : 2
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 40.000000
Status = Notwroking Properly
Result Output Geometry  = POLYGON ((29.1826919999999990 17.7403850000000000, 28.4141032161292240 9.9367721193548775, 26.1378733004514780 2.4330477053964241, 22.4414764921018240 -4.4824243207840695, 17.4669632474619230 -10.5438862474618770, 11.4055013207841220 -15.5183994921017890, 4.4900292946036338 -19.2147963004514500, -3.0136951193548152 -21.4910262161292100, -10.8173079999999370 -22.2596150000000000, -18.6209208806450590 -21.4910262161292320, -26.1246452946035140 -19.2147963004515000, -33.0401173207840200 -15.5183994921018530, -39.1015792474618420 -10.5438862474619660, -44.0760924921017510 -4.4824243207841725, -47.7724893004514260 2.4330477053963069, -50.0487192161292000 9.9367721193547514, -50.8173079999999970 17.7403849999998720, -50.0487192161292430 25.5439978806449940, -47.7724893004515250 33.0477222946034530, -44.0760924921018930 39.9631943207839560, -39.1015792474620200 46.0246562474617780, -33.0401173207842330 50.9991694921017140,
 -26.1246452946037450 54.6955663004514040, -18.6209208806452860 56.9717962161291920, -10.8173080000001500 57.7403850000000030, -3.0136951193550079 56.9717962161292490, 4.4900292946034686 54.6955663004515170, 11.4055013207839830 50.9991694921018710, 17.4669632474618160 46.0246562474619840, 22.4414764921017530 39.9631943207841760, 26.1378733004514350 33.0477222946036800, 28.4141032161292020 25.5439978806452180, 29.1826919999999990 17.7403850000000000))

------------------------------------------------------------------------
Case : 3
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 10.000000
Status = Working Ok
Result Output Geometry  = MULTIPOLYGON (((-0.8173080000000006 17.7403850000000000, -1.0094551959676945 15.7894817798387180, -1.5785126748871310 13.9135506763491050, -2.5026118769745445 12.1846826698039830, -3.7462401881345198 10.6693171881345310, -5.2616056698039699 9.4256888769745526, -6.9904736763490920 8.5015896748871373, -8.8664047798387049 7.9325321959676973, -10.8173079999999850 7.7403849999999998, -12.7682112201612660 7.9325321959676920, -14.6441423236508790 8.5015896748871249, -16.3730103301960060 9.4256888769745366, -17.8883758118654580 10.6693171881345080, -19.1320041230254390 12.1846826698039570, -20.0561033251128580 13.9135506763490770, -20.6251608040322980 15.7894817798386880, -20.8173080000000010 17.7403849999999680, -20.6251608040323120 19.6912882201612480, -20.0561033251128830 21.5672193236508640, -19.1320041230254740 23.2960873301959880, -17.8883758118655050 24.8114528118654430, -16.3730103301960600 26.0550811230254280,
 -14.6441423236509360 26.9791803251128500, -12.7682112201613230 27.5482378040322970, -10.8173080000000380 27.7403850000000000, -8.8664047798387529 27.5482378040323110, -6.9904736763491329 26.9791803251128780, -5.2616056698040046 26.0550811230254670, -3.7462401881345464 24.8114528118654970, -2.5026118769745622 23.2960873301960450, -1.5785126748871416 21.5672193236509210, -1.0094551959676998 19.6912882201613040, -0.8173080000000006 17.7403850000000000)), ((-113.2643370000000000 1.8065199999999999, -113.4564841959676900 -0.1443832201612809, -114.0255416748871200 -2.0203143236508940, -114.9496408769745400 -3.7491823301960174, -116.1932691881345200 -5.2645478118654694, -117.7086346698039700 -6.5081761230254473, -119.4375026763490800 -7.4322753251128626, -121.3134337798387000 -8.0013328040323017, -123.2643369999999800 -8.1934800000000010, -125.2152402201612600 -8.0013328040323088, -127.0911713236508800 -7.4322753251128750, -128.8200393301960100
 -6.5081761230254633, -130.3354048118654600 -5.2645478118654916, -131.5790331230254300 -3.7491823301960432, -132.5031323251128600 -2.0203143236509233, -133.0721898040322900 -0.1443832201613122, -133.2643370000000100 1.8065199999999675, -133.0721898040323200 3.7574232201612485, -132.5031323251128900 5.6333543236508632, -131.5790331230254800 7.3622223301959897, -130.3354048118655200 8.8775878118654461, -128.8200393301960700 10.1212161230254270, -127.0911713236509400 11.0453153251128530, -125.2152402201613200 11.6143728040322960, -123.2643370000000400 11.8065199999999990, -121.3134337798387500 11.6143728040323100, -119.4375026763491300 11.0453153251128810, -117.7086346698040000 10.1212161230254690, -116.1932691881345400 8.8775878118654958, -114.9496408769745600 7.3622223301960439, -114.0255416748871400 5.6333543236509200, -113.4564841959677000 3.7574232201613045, -113.2643370000000000 1.8065199999999999)))

Thanking you'
Chirag Soni


      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs
From chirag19 at yahoo.com  Mon Jan  7 07:37:56 2008
From: chirag19 at yahoo.com (chirag soni)
Date: Mon Jan  7 07:37:58 2008
Subject: [geos-devel] Buffer Problem
Message-ID: <244655.70157.qm@web52501.mail.re2.yahoo.com>

Hello Friends,
I have problem with buffer operation which has same input geometry with three different distance. I have three cases for buffer operation as bellow. Case 1 and Case 3 gives perfect result.But Case 2 has some problem it sould give Multipolygon with two circular polygon like Case3. Case 2 only return one polygon instead of two polygon. there is some problem in buffer operation. please help me. It is happening for all type of Multi Geometry.
------------------------------------------------------------------------
Case : 1
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 60.000000
Status = Working Ok
Result Output Geometry  = POLYGON ((-69.7683199416213710 28.3909394912853800, -69.6644248241938730 29.4458043209674900, -66.2500799506772890 40.7013909419051810, -60.7054847381528480 51.0745989811759390, -53.2437148711930350 60.1667918711926720, -44.1515219811763440 67.6285617381525700, -33.7783139419056230 73.1731569506771110, -22.5227273209679310 76.5875018241937790, -10.8173080000002240 77.7403850000000030, 0.8881113209674876 76.5875018241938650, 12.1436979419052020 73.1731569506772810, 22.5169059811759770 67.6285617381528110, 31.6090988711927250 60.1667918711929700, 39.0708687381526260 51.0745989811762660, 44.6154639506771530 40.7013909419055220, 48.0298088241937930 29.4458043209678270, 49.1826920000000030 17.7403850000000000, 48.0298088241938360 6.0349656790323145, 44.6154639506772240 -5.2206209419053629, 39.0708687381527400 -15.5938289811761060, 31.6090988711928880 -24.6860218711928180, 22.5169059811761830 -32.1477917381526770, 12.1436979419054510
 -37.6923869506771750, 0.8881113209677771 -41.1067318241938150, -10.8173079999999030 -42.2596149999999970, -22.5227273209675900 -41.1067318241938440, -33.7783139419052670 -37.6923869506772460, -44.1515219811760320 -32.1477917381527760, -53.2437148711927510 -24.6860218711929460, -60.7054847381526340 -15.5938289811762550, -64.3133250583786380 -8.8440344912853597, -64.4172201758061650 -9.8988993209676863, -67.8315650493227760 -21.1544859419053640, -73.3761602618472610 -31.5276939811761070, -80.8379301288071020 -40.6198868711928180, -89.9301230188238210 -48.0816567381526810, -100.3033310580945400 -53.6262519506771800, -111.5589176790322200 -57.0405968241938130, -123.2643369999999000 -58.1934800000000010, -134.9697563209675800 -57.0405968241938480, -146.2253429419052700 -53.6262519506772510, -156.5985509811760300 -48.0816567381527800, -165.6907438711927500 -40.6198868711929460, -173.1525137381526300 -31.5276939811762560, -178.6971089506771500
 -21.1544859419055410, -182.1114538241938000 -9.8988993209678746, -183.2643370000000100 1.8065199999998061, -182.1114538241938600 13.5119393209674930, -178.6971089506772900 24.7675259419051810, -173.1525137381528300 35.1407339811759340, -165.6907438711930400 44.2329268711926740, -156.5985509811763400 51.6946967381525650, -146.2253429419056100 57.2392919506771070, -134.9697563209679200 60.6536368241937750, -123.2643370000002200 61.8065199999999990, -111.5589176790325000 60.6536368241938670, -100.3033310580948000 57.2392919506772840, -89.9301230188240200 51.6946967381528140, -80.8379301288072720 44.2329268711929730, -73.3761602618473600 35.1407339811762610, -69.7683199416213710 28.3909394912853800))

------------------------------------------------------------------------
Case : 2
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 40.000000
Status = Notwroking Properly
Result Output Geometry  = POLYGON ((29.1826919999999990 17.7403850000000000, 28.4141032161292240 9.9367721193548775, 26.1378733004514780 2.4330477053964241, 22.4414764921018240 -4.4824243207840695, 17.4669632474619230 -10.5438862474618770, 11.4055013207841220 -15.5183994921017890, 4.4900292946036338 -19.2147963004514500, -3.0136951193548152 -21.4910262161292100, -10.8173079999999370 -22.2596150000000000, -18.6209208806450590 -21.4910262161292320, -26.1246452946035140 -19.2147963004515000, -33.0401173207840200 -15.5183994921018530, -39.1015792474618420 -10.5438862474619660, -44.0760924921017510 -4.4824243207841725, -47.7724893004514260 2.4330477053963069, -50.0487192161292000 9.9367721193547514, -50.8173079999999970 17.7403849999998720, -50.0487192161292430 25.5439978806449940, -47.7724893004515250 33.0477222946034530, -44.0760924921018930 39.9631943207839560, -39.1015792474620200 46.0246562474617780, -33.0401173207842330 50.9991694921017140,
 -26.1246452946037450 54.6955663004514040, -18.6209208806452860 56.9717962161291920, -10.8173080000001500 57.7403850000000030, -3.0136951193550079 56.9717962161292490, 4.4900292946034686 54.6955663004515170, 11.4055013207839830 50.9991694921018710, 17.4669632474618160 46.0246562474619840, 22.4414764921017530 39.9631943207841760, 26.1378733004514350 33.0477222946036800, 28.4141032161292020 25.5439978806452180, 29.1826919999999990 17.7403850000000000))

------------------------------------------------------------------------
Case : 3
------------------------------------------------------------------------
Input Geometry = MULTIPOINT(-123.264337 1.80652,-10.817308 17.740385) 
Buffer Distance = 10.000000
Status = Working Ok
Result Output Geometry  = MULTIPOLYGON (((-0.8173080000000006 17.7403850000000000, -1.0094551959676945 15.7894817798387180, -1.5785126748871310 13.9135506763491050, -2.5026118769745445 12.1846826698039830, -3.7462401881345198 10.6693171881345310, -5.2616056698039699 9.4256888769745526, -6.9904736763490920 8.5015896748871373, -8.8664047798387049 7.9325321959676973, -10.8173079999999850 7.7403849999999998, -12.7682112201612660 7.9325321959676920, -14.6441423236508790 8.5015896748871249, -16.3730103301960060 9.4256888769745366, -17.8883758118654580 10.6693171881345080, -19.1320041230254390 12.1846826698039570, -20.0561033251128580 13.9135506763490770, -20.6251608040322980 15.7894817798386880, -20.8173080000000010 17.7403849999999680, -20.6251608040323120 19.6912882201612480, -20.0561033251128830 21.5672193236508640, -19.1320041230254740 23.2960873301959880, -17.8883758118655050 24.8114528118654430, -16.3730103301960600 26.0550811230254280,
 -14.6441423236509360 26.9791803251128500, -12.7682112201613230 27.5482378040322970, -10.8173080000000380 27.7403850000000000, -8.8664047798387529 27.5482378040323110, -6.9904736763491329 26.9791803251128780, -5.2616056698040046 26.0550811230254670, -3.7462401881345464 24.8114528118654970, -2.5026118769745622 23.2960873301960450, -1.5785126748871416 21.5672193236509210, -1.0094551959676998 19.6912882201613040, -0.8173080000000006 17.7403850000000000)), ((-113.2643370000000000 1.8065199999999999, -113.4564841959676900 -0.1443832201612809, -114.0255416748871200 -2.0203143236508940, -114.9496408769745400 -3.7491823301960174, -116.1932691881345200 -5.2645478118654694, -117.7086346698039700 -6.5081761230254473, -119.4375026763490800 -7.4322753251128626, -121.3134337798387000 -8.0013328040323017, -123.2643369999999800 -8.1934800000000010, -125.2152402201612600 -8.0013328040323088, -127.0911713236508800 -7.4322753251128750, -128.8200393301960100
 -6.5081761230254633, -130.3354048118654600 -5.2645478118654916, -131.5790331230254300 -3.7491823301960432, -132.5031323251128600 -2.0203143236509233, -133.0721898040322900 -0.1443832201613122, -133.2643370000000100 1.8065199999999675, -133.0721898040323200 3.7574232201612485, -132.5031323251128900 5.6333543236508632, -131.5790331230254800 7.3622223301959897, -130.3354048118655200 8.8775878118654461, -128.8200393301960700 10.1212161230254270, -127.0911713236509400 11.0453153251128530, -125.2152402201613200 11.6143728040322960, -123.2643370000000400 11.8065199999999990, -121.3134337798387500 11.6143728040323100, -119.4375026763491300 11.0453153251128810, -117.7086346698040000 10.1212161230254690, -116.1932691881345400 8.8775878118654958, -114.9496408769745600 7.3622223301960439, -114.0255416748871400 5.6333543236509200, -113.4564841959677000 3.7574232201613045, -113.2643370000000000 1.8065199999999999)))

Chirag Soni


      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs
From arovira at ngeografics.com  Mon Jan  7 11:17:55 2008
From: arovira at ngeografics.com (Albert Rovira)
Date: Mon Jan  7 11:19:48 2008
Subject: [geos-devel] About Geos QuadTree index
Message-ID: <478250B3.2070307@ngeografics.com>

Geos QuadTree index works? Any sample ?

Thanks,
Albert.
From sgillies at frii.com  Sat Jan 12 16:07:52 2008
From: sgillies at frii.com (Sean Gillies)
Date: Sat Jan 12 16:07:58 2008
Subject: [geos-devel] GEOS 3 DLLs?
Message-ID: <47892C28.2010702@frii.com>

Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
get them out of the PostGIS 1.3.2 installer, but that appeared to
require installing Postgres and I'm unwilling to do that.

Thanks,
Sean
From cfis at savagexi.com  Sat Jan 12 17:15:20 2008
From: cfis at savagexi.com (Charlie Savage)
Date: Sat Jan 12 17:15:47 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <47892C28.2010702@frii.com>
References: <47892C28.2010702@frii.com>
Message-ID: <47893BF8.1020906@savagexi.com>

Sean,

I have debug dlls compiled from September which I can send along.  Using 
either VC++2005 or MingW.  Note that I have not yet updated them to the 
final 3.0 release, although its on my todo list.

Charlie

Sean Gillies wrote:
> Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
> get them out of the PostGIS 1.3.2 installer, but that appeared to
> require installing Postgres and I'm unwilling to do that.
> 
> Thanks,
> Sean
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20080112/d9a741d3/smime.bin
From mark.cave-ayland at ilande.co.uk  Sun Jan 13 06:58:12 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Sun Jan 13 06:58:24 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <47892C28.2010702@frii.com>
References: <47892C28.2010702@frii.com>
Message-ID: <1200225492.9557.1.camel@mca-desktop>

On Sat, 2008-01-12 at 14:07 -0700, Sean Gillies wrote:
> Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
> get them out of the PostGIS 1.3.2 installer, but that appeared to
> require installing Postgres and I'm unwilling to do that.
> 
> Thanks,
> Sean


Hi Sean,

FWIW I've been told that 7-Zip can open NSIS installers such as the
PostGIS installer and allow you to extract individual files as needed.


HTH,

Mark.

-- 
ILande - Open Source Consultancy
http://www.ilande.co.uk


From artem.mapnik at googlemail.com  Sun Jan 13 07:41:52 2008
From: artem.mapnik at googlemail.com (Artem Pavlenko)
Date: Sun Jan 13 07:42:01 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <47892C28.2010702@frii.com>
References: <47892C28.2010702@frii.com>
Message-ID: <EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>

Hi Sean,

You can get  geos 3 dlls (+libs) from : http:// 
artem.dev.openstreetmap.org/files/geos_3.zip
Or you can always build them yourself using VC++ express (free as in  
beer):

nmake /f Makefile.vc

HTH
Cheers
Artem
On 12 Jan 2008, at 21:07, Sean Gillies wrote:

> Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
> get them out of the PostGIS 1.3.2 installer, but that appeared to
> require installing Postgres and I'm unwilling to do that.
>
> Thanks,
> Sean
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From sgillies at frii.com  Sun Jan 13 14:34:19 2008
From: sgillies at frii.com (Sean Gillies)
Date: Sun Jan 13 14:34:23 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
References: <47892C28.2010702@frii.com>
	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
Message-ID: <478A67BB.3090105@frii.com>

Thanks, Artem. Once I got the redistributable package with msvcp80.dll
it worked fine. That is standard on XP, yes?

Charlie, Mark: thanks too.

Sean


Artem Pavlenko wrote:
> Hi Sean,
> 
> You can get  geos 3 dlls (+libs) from :
> http://artem.dev.openstreetmap.org/files/geos_3.zip
> Or you can always build them yourself using VC++ express (free as in beer):
> 
> nmake /f Makefile.vc
> 
> HTH
> Cheers
> Artem
> On 12 Jan 2008, at 21:07, Sean Gillies wrote:
> 
>> Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
>> get them out of the PostGIS 1.3.2 installer, but that appeared to
>> require installing Postgres and I'm unwilling to do that.
>>
>> Thanks,
>> Sean
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 

From sgillies at frii.com  Sun Jan 13 15:53:52 2008
From: sgillies at frii.com (Sean Gillies)
Date: Sun Jan 13 15:53:57 2008
Subject: [geos-devel] Windows installer for the Shapely Python GEOS package
Message-ID: <478A7A60.9050009@frii.com>

Hi all,

I've included Artem's DLLs in an installer for Shapely:

http://gispython.org/downloads/gispy/Shapely-1.0rc1.win32.exe

Shapely, the project for which I abandoned the GEOS SWIG bindings, also
has a new manual:

http://gispython.org/shapely/manual.html

Cheers,
Sean
From sgillies at frii.com  Mon Jan 14 11:49:31 2008
From: sgillies at frii.com (Sean Gillies)
Date: Mon Jan 14 11:49:35 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
References: <47892C28.2010702@frii.com>
	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
Message-ID: <478B929B.306@frii.com>

Artem,

My user is unable to load these DLLs on a new Vista system.

---------------------------
Microsoft Visual C++ Runtime Library
---------------------------
Runtime Error!

Program: C:\Python25\python.exe

R6034

An application has made an attempt to load the C runtime library
incorrectly.
Please contact the application's support team for more information.


---------------------------
OK
---------------------------

Could it be a missing manifest?

Sean

Artem Pavlenko wrote:
> Hi Sean,
> 
> You can get  geos 3 dlls (+libs) from :
> http://artem.dev.openstreetmap.org/files/geos_3.zip
> Or you can always build them yourself using VC++ express (free as in beer):
> 
> nmake /f Makefile.vc
> 
> HTH
> Cheers
> Artem
> On 12 Jan 2008, at 21:07, Sean Gillies wrote:
> 
>> Can anyone share GEOS 3 DLLs (including the C API) with me? I tried to
>> get them out of the PostGIS 1.3.2 installer, but that appeared to
>> require installing Postgres and I'm unwilling to do that.
>>
>> Thanks,
>> Sean
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 

From artem.mapnik at googlemail.com  Mon Jan 14 11:58:16 2008
From: artem.mapnik at googlemail.com (Artem Pavlenko)
Date: Mon Jan 14 11:58:24 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <478B929B.306@frii.com>
References: <47892C28.2010702@frii.com>
	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
	<478B929B.306@frii.com>
Message-ID: <C2E95D8C-0895-42AB-9811-71A752519A96@gmail.com>

Hi Sean,


> Artem,
>
> My user is unable to load these DLLs on a new Vista system.
>
> ---------------------------
> Microsoft Visual C++ Runtime Library
> ---------------------------
> Runtime Error!
>
> Program: C:\Python25\python.exe
>
> R6034
>
> An application has made an attempt to load the C runtime library
> incorrectly.
> Please contact the application's support team for more information.
>
>
> ---------------------------
> OK
> ---------------------------
>
> Could it be a missing manifest?

It might well be the manifest. Let me check...
Artem
>
> Sean
>
> Artem Pavlenko wrote:
>> Hi Sean,
>>
>> You can get  geos 3 dlls (+libs) from :
>> http://artem.dev.openstreetmap.org/files/geos_3.zip
>> Or you can always build them yourself using VC++ express (free as  
>> in beer):
>>
>> nmake /f Makefile.vc
>>
>> HTH
>> Cheers
>> Artem
>> On 12 Jan 2008, at 21:07, Sean Gillies wrote:
>>
>>> Can anyone share GEOS 3 DLLs (including the C API) with me? I  
>>> tried to
>>> get them out of the PostGIS 1.3.2 installer, but that appeared to
>>> require installing Postgres and I'm unwilling to do that.
>>>
>>> Thanks,
>>> Sean
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From cfis at savagexi.com  Mon Jan 14 12:02:23 2008
From: cfis at savagexi.com (Charlie Savage)
Date: Mon Jan 14 12:02:30 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <478B929B.306@frii.com>
References: <47892C28.2010702@frii.com>	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
	<478B929B.306@frii.com>
Message-ID: <478B959F.8080005@savagexi.com>

> Could it be a missing manifest?

That is almost always the issue I run into.  VC 2005 will embed the 
manifest for you, but I'm not sure if the Express versions do and nmake 
definitely does not.

To fix, use the mt command link tool to embed the manifest:

http://msdn2.microsoft.com/en-us/library/ms235591.aspx

Charlie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3237 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20080114/954b1393/smime.bin
From artem.mapnik at googlemail.com  Mon Jan 14 12:12:33 2008
From: artem.mapnik at googlemail.com (Artem Pavlenko)
Date: Mon Jan 14 12:12:41 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <478B959F.8080005@savagexi.com>
References: <47892C28.2010702@frii.com>	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>
	<478B929B.306@frii.com> <478B959F.8080005@savagexi.com>
Message-ID: <E49C672E-AC38-4E36-A8C8-E5B766938E59@gmail.com>


On 14 Jan 2008, at 17:02, Charlie Savage wrote:

>> Could it be a missing manifest?
>
> That is almost always the issue I run into.  VC 2005 will embed the  
> manifest for you, but I'm not sure if the Express versions do and  
> nmake definitely does not.
>
> To fix, use the mt command link tool to embed the manifest:
>
> http://msdn2.microsoft.com/en-us/library/ms235591.aspx

I found this one, too:
http://msdn2.microsoft.com/en-us/library/ms235591(VS.80).aspx

OK, I embedded manifests into geos.dll and geos_c.dll, could you try ?

http://artem.dev.openstreetmap.org/files/geos_c.dll
http://artem.dev.openstreetmap.org/files/geos.dll

Joy of windows dev :)

Artem

>
> Charlie
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From t.mitchell at aranz.com  Mon Jan 14 14:40:40 2008
From: t.mitchell at aranz.com (Tim Mitchell)
Date: Mon Jan 14 14:41:16 2008
Subject: [geos-devel] Geos 3 library size
In-Reply-To: <E49C672E-AC38-4E36-A8C8-E5B766938E59@gmail.com>
References: <47892C28.2010702@frii.com>
Message-ID: <478BBAB8.2020500@aranz.com>

Hi,

I'm new to geos and have just downloaded an svn snapshot and built the 
libraries on windows XP using the visual studio solution files in 
build/msvc80 using 2005 Express edition.  I am using the library via the 
shapely python interface and it seems to work.

However the resulting geos.lib is 113Mb which is twice the size of the 
debug build (47 Mb).  I find hard to believe the release lib is bigger 
than the debug lib and all this from 6Mb of source (using it will triple 
the size of my app!!).  I am a C person and have never touched C++ 
before and I just wanted to check that these file sizes are correct.

Thanks,
Tim

-- 
Tim Mitchell
Software Engineer
Applied Research Associates (NZ) Ltd. (www.aranz.com)
Ph: +64 (3) 374-6120 ext: 203
Fax: +64 (3) 374-6130
Skype: tim-mitchell

From warmerdam at pobox.com  Mon Jan 14 14:55:55 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jan 14 14:55:47 2008
Subject: [geos-devel] Geos 3 library size
In-Reply-To: <478BBAB8.2020500@aranz.com>
References: <47892C28.2010702@frii.com> <478BBAB8.2020500@aranz.com>
Message-ID: <478BBE4B.7050004@pobox.com>

Tim Mitchell wrote:
> Hi,
> 
> I'm new to geos and have just downloaded an svn snapshot and built the 
> libraries on windows XP using the visual studio solution files in 
> build/msvc80 using 2005 Express edition.  I am using the library via the 
> shapely python interface and it seems to work.
> 
> However the resulting geos.lib is 113Mb which is twice the size of the 
> debug build (47 Mb).  I find hard to believe the release lib is bigger 
> than the debug lib and all this from 6Mb of source (using it will triple 
> the size of my app!!).  I am a C person and have never touched C++ 
> before and I just wanted to check that these file sizes are correct.

Tim,

I build GEOS with the nmakefile's and I see:

warmerda@gdal3200% ls -l *.lib
-rwxr-xr-x 1 warmerda None 19677468 Dec 20 17:32 geos.lib
-rwxr-xr-x 1 warmerda None    23382 Dec 20 17:32 geos_c_i.lib
-rwxr-xr-x 1 warmerda None    23160 Dec 11 23:39 geos_i.lib

warmerda@gdal3200% ls -l *.dll
-rwxr-xr-x 1 warmerda None 823296 Dec 20 17:32 geos_c_fw.dll
-rwxr-xr-x 1 warmerda None 978944 Dec 20 17:32 geos_fw.dll

I find it bizarre that your release build should be so much larger
than the debug build.  But I don't think the size of the .lib file
is a reflection on what will actually end up in your linked .exe or
.dll as all sorts of stuff tends to get duplicated in each .obj in a .lib
file, but then boiled by down by the linker when producing a dll or exe.

Looking at my build, I suspect that the C DLL is linking in a copy of
all used code from the main C++ DLL which I think I'll look into.  It wasn't
my expectation that this would happen and it isn't how things work
on linux.  But that isn't your problem.

So my advice is to look instead at the size of DLL that ends up being
used by Shapely and determine if that is large or not.  Make sure it
gets built without debug info when checking the size.  If that is still
huge, consider building GEOS with the nmakefile's instead of the solutions.
(or perhaps carefully compare the build options).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From t.mitchell at aranz.com  Mon Jan 14 15:07:25 2008
From: t.mitchell at aranz.com (Tim Mitchell)
Date: Mon Jan 14 15:08:00 2008
Subject: [geos-devel] Geos 3 library size
In-Reply-To: <478BBE4B.7050004@pobox.com>
References: <47892C28.2010702@frii.com>
Message-ID: <478BC0FD.8050408@aranz.com>

Frank,

Thanks for that.  The geos_c.dll is less than 1 Mb so I think I'll just 
ignore the lib problem for now - bigger fish to fry ATM.
The makefile didn't work for me and I gave up after half an hour - I 
might try it again later.

Thanks
Tim

Frank Warmerdam wrote:
> Tim Mitchell wrote:
>> Hi,
>>
>> I'm new to geos and have just downloaded an svn snapshot and built 
>> the libraries on windows XP using the visual studio solution files in 
>> build/msvc80 using 2005 Express edition.  I am using the library via 
>> the shapely python interface and it seems to work.
>>
>> However the resulting geos.lib is 113Mb which is twice the size of 
>> the debug build (47 Mb).  I find hard to believe the release lib is 
>> bigger than the debug lib and all this from 6Mb of source (using it 
>> will triple the size of my app!!).  I am a C person and have never 
>> touched C++ before and I just wanted to check that these file sizes 
>> are correct.
>
> Tim,
>
> I build GEOS with the nmakefile's and I see:
>
> warmerda@gdal3200% ls -l *.lib
> -rwxr-xr-x 1 warmerda None 19677468 Dec 20 17:32 geos.lib
> -rwxr-xr-x 1 warmerda None    23382 Dec 20 17:32 geos_c_i.lib
> -rwxr-xr-x 1 warmerda None    23160 Dec 11 23:39 geos_i.lib
>
> warmerda@gdal3200% ls -l *.dll
> -rwxr-xr-x 1 warmerda None 823296 Dec 20 17:32 geos_c_fw.dll
> -rwxr-xr-x 1 warmerda None 978944 Dec 20 17:32 geos_fw.dll
>
> I find it bizarre that your release build should be so much larger
> than the debug build.  But I don't think the size of the .lib file
> is a reflection on what will actually end up in your linked .exe or
> .dll as all sorts of stuff tends to get duplicated in each .obj in a .lib
> file, but then boiled by down by the linker when producing a dll or exe.
>
> Looking at my build, I suspect that the C DLL is linking in a copy of
> all used code from the main C++ DLL which I think I'll look into.  It 
> wasn't
> my expectation that this would happen and it isn't how things work
> on linux.  But that isn't your problem.
>
> So my advice is to look instead at the size of DLL that ends up being
> used by Shapely and determine if that is large or not.  Make sure it
> gets built without debug info when checking the size.  If that is still
> huge, consider building GEOS with the nmakefile's instead of the 
> solutions.
> (or perhaps carefully compare the build options).
>
> Best regards,

-- 
Tim Mitchell
Software Engineer
Applied Research Associates (NZ) Ltd. (www.aranz.com)
Ph: +64 (3) 374-6120 ext: 203
Fax: +64 (3) 374-6130
Skype: tim-mitchell

From warmerdam at pobox.com  Mon Jan 14 15:22:36 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Jan 14 15:22:36 2008
Subject: [geos-devel] Geos 3 library size
In-Reply-To: <478BC0FD.8050408@aranz.com>
References: <47892C28.2010702@frii.com> <478BC0FD.8050408@aranz.com>
Message-ID: <478BC48C.8000500@pobox.com>

Tim Mitchell wrote:
> Frank,
> 
> Thanks for that.  The geos_c.dll is less than 1 Mb so I think I'll just 
> ignore the lib problem for now - bigger fish to fry ATM.
> The makefile didn't work for me and I gave up after half an hour - I 
> might try it again later.

Tim, etc,

I have discovered that my findings were essentially true of the 3.0 branch,
and didn't include the recent updates in trunk.  Also the nmakefile's in
trunk no longer work since lots of new files have been added.  I'll try to
bring the nmakefile's up to date when I have chance as they are how I build
GEOS for FWTools.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From sgillies at frii.com  Mon Jan 14 15:54:10 2008
From: sgillies at frii.com (Sean Gillies)
Date: Mon Jan 14 15:54:12 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <E49C672E-AC38-4E36-A8C8-E5B766938E59@gmail.com>
References: <47892C28.2010702@frii.com>	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>	<478B929B.306@frii.com>
	<478B959F.8080005@savagexi.com>
	<E49C672E-AC38-4E36-A8C8-E5B766938E59@gmail.com>
Message-ID: <478BCBF2.90109@frii.com>

Artem,

Thanks, man! My Vista user confirms that it works.

Cheers,
Sean

Artem Pavlenko wrote:
> 
> On 14 Jan 2008, at 17:02, Charlie Savage wrote:
> 
>>> Could it be a missing manifest?
>>
>> That is almost always the issue I run into.  VC 2005 will embed the
>> manifest for you, but I'm not sure if the Express versions do and
>> nmake definitely does not.
>>
>> To fix, use the mt command link tool to embed the manifest:
>>
>> http://msdn2.microsoft.com/en-us/library/ms235591.aspx
> 
> I found this one, too:
> http://msdn2.microsoft.com/en-us/library/ms235591(VS.80).aspx
> 
> OK, I embedded manifests into geos.dll and geos_c.dll, could you try ?
> 
> http://artem.dev.openstreetmap.org/files/geos_c.dll
> http://artem.dev.openstreetmap.org/files/geos.dll
> 
> Joy of windows dev :)
> 
> Artem
> 
>>
>> Charlie
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 

From artem.mapnik at googlemail.com  Mon Jan 14 17:21:32 2008
From: artem.mapnik at googlemail.com (Artem Pavlenko)
Date: Mon Jan 14 17:21:40 2008
Subject: [geos-devel] GEOS 3 DLLs?
In-Reply-To: <478BCBF2.90109@frii.com>
References: <47892C28.2010702@frii.com>	<EFF8D677-DDB5-46AB-AAC0-C998178B2943@gmail.com>	<478B929B.306@frii.com>
	<478B959F.8080005@savagexi.com>
	<E49C672E-AC38-4E36-A8C8-E5B766938E59@gmail.com>
	<478BCBF2.90109@frii.com>
Message-ID: <4522C066-9248-42EB-A234-BA2481FCF2D3@gmail.com>

Sean,

Great! Glad it works. Another happy vista user :)

Cheers
Artem

> Artem,
>
> Thanks, man! My Vista user confirms that it works.
>
> Cheers,
> Sean
>
> Artem Pavlenko wrote:
>>
>> On 14 Jan 2008, at 17:02, Charlie Savage wrote:
>>
>>>> Could it be a missing manifest?
>>>
>>> That is almost always the issue I run into.  VC 2005 will embed the
>>> manifest for you, but I'm not sure if the Express versions do and
>>> nmake definitely does not.
>>>
>>> To fix, use the mt command link tool to embed the manifest:
>>>
>>> http://msdn2.microsoft.com/en-us/library/ms235591.aspx
>>
>> I found this one, too:
>> http://msdn2.microsoft.com/en-us/library/ms235591(VS.80).aspx
>>
>> OK, I embedded manifests into geos.dll and geos_c.dll, could you  
>> try ?
>>
>> http://artem.dev.openstreetmap.org/files/geos_c.dll
>> http://artem.dev.openstreetmap.org/files/geos.dll
>>
>> Joy of windows dev :)
>>
>> Artem
>>
>>>
>>> Charlie
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From ericknappe at gmail.com  Wed Jan 16 00:39:30 2008
From: ericknappe at gmail.com (Eric Knappe)
Date: Wed Jan 16 00:39:31 2008
Subject: [geos-devel] geos make check fails
Message-ID: <7204e3ff0801152139x2132ad01wb68993cb57dd1d4e@mail.gmail.com>

Hello,

I've installed geos on red hat linux, but cannot sucessfully run the tests.
I get the following error and do not know what is wrong.

make[2]: Entering directory `/usr/home/mydir/geos-3.0.0/capi'
./testrunner: line 2:   695 Segmentation fault      ./geostest ./test.wkt >
test.out
geostest exited with non-zero status (139)
1,25d0
< GEOS version 3.0.0rc2-CAPI-1.3.0

Appreciate the help
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20080116/26394714/attachment.html
From warmerdam at pobox.com  Wed Jan 16 13:44:56 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jan 16 13:44:41 2008
Subject: [geos-devel] Makefile.vc Updates
Message-ID: <478E50A8.1030305@pobox.com>

Folks,

I have updated source/Makefile.vc to include a bunch of the new classes
so it seems to properly create the DLLs (r2107).

I have also observed that the distinction between geos.dll and
geos_c.dll as built by the Makefile.vc is essentially a fraud.  It
appears we make no effort to declare GEOS C++ classes in a way that allows
the C++ API to be exported from DLLs, so geos.dll is really just the same
as geos_c.dll (only C API exported) with the exception that a bunch of
extra C++ classes are included that have no access via the C API.

I have not changed this yet, but I assuming we don't want to declare the
C++ classes in a way that they can be exported from DLLs, I'll just strip
down the Makefile.vc to only generate geos.dll.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From sgillies at frii.com  Wed Jan 16 13:50:48 2008
From: sgillies at frii.com (Sean Gillies)
Date: Wed Jan 16 13:50:52 2008
Subject: [geos-devel] Makefile.vc Updates
In-Reply-To: <478E50A8.1030305@pobox.com>
References: <478E50A8.1030305@pobox.com>
Message-ID: <478E5208.9000003@frii.com>

Frank Warmerdam wrote:
> Folks,
> 
> I have updated source/Makefile.vc to include a bunch of the new classes
> so it seems to properly create the DLLs (r2107).
> 
> I have also observed that the distinction between geos.dll and
> geos_c.dll as built by the Makefile.vc is essentially a fraud.  It
> appears we make no effort to declare GEOS C++ classes in a way that allows
> the C++ API to be exported from DLLs, so geos.dll is really just the same
> as geos_c.dll (only C API exported) with the exception that a bunch of
> extra C++ classes are included that have no access via the C API.
> 
> I have not changed this yet, but I assuming we don't want to declare the
> C++ classes in a way that they can be exported from DLLs, I'll just strip
> down the Makefile.vc to only generate geos.dll.
> 
> Best regards,

Thanks for looking into it, Frank. I guess my Shapely installer no
longer needs to be the Number of the Beast in kb. Eddie the Head will be
disappointed.

Sean

From ericknappe at gmail.com  Wed Jan 16 16:06:56 2008
From: ericknappe at gmail.com (Eric Knappe)
Date: Wed Jan 16 16:06:59 2008
Subject: [geos-devel] geos make check fails
Message-ID: <7204e3ff0801161306t63e3ceadw13797d856df805ec@mail.gmail.com>

I tried removing geos-3.0.0 and installing geos-2.2.3, but no luck, so back
to 3.0.0.  I still get and error - segmentation fault - when running
geostest. The system is Red Hat 3.4.6-3. Can anyone give me a clue as to
where to look?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20080116/dd0f1406/attachment.html
From pramsey at refractions.net  Wed Jan 16 16:47:00 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Wed Jan 16 16:48:32 2008
Subject: [geos-devel] geos make check fails
In-Reply-To: <7204e3ff0801161306t63e3ceadw13797d856df805ec@mail.gmail.com>
References: <7204e3ff0801161306t63e3ceadw13797d856df805ec@mail.gmail.com>
Message-ID: <4E445302-9C73-44E9-B034-B63F33C56C3E@refractions.net>

Segfault, or failure? I get this...

FAIL: testrunner
===================
1 of 1 tests failed
===================
make[2]: *** [check-TESTS] Error 1
make[2]: Leaving directory `/home/pramsey/geos-3.0-svn/capi'
make[1]: *** [check-am] Error 2

But it's not a segfault, there's something fiddly with my linker.

P

On Jan 16, 2008, at 1:06 PM, Eric Knappe wrote:

> I tried removing geos-3.0.0 and installing geos-2.2.3, but no luck,  
> so back to 3.0.0.  I still get and error - segmentation fault - when  
> running geostest. The system is Red Hat 3.4.6-3. Can anyone give me  
> a clue as to where to look?
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From sgillies at frii.com  Wed Jan 16 17:14:06 2008
From: sgillies at frii.com (Sean Gillies)
Date: Wed Jan 16 17:14:11 2008
Subject: [geos-devel] Odd problem on Vista
Message-ID: <478E81AE.2020500@frii.com>

I'm using Python's ctypes and libffi to access functions in GEOS.
GEOSGeomToWKT and GEOSGeomToWKB_buf each allocate memory that must be
freed by the caller. This has been no problem for me on Linux or Windows
2000, I simply free the memory with libc.free or msvcrt.free. There
seems to be an authorization problem on Vista with the result that
msvcrt.free cannot access the memory allocated by geos.dll. This is the
DLL I got from Artem the other day. I'm thinking that the solution is
for GEOS to export its own free function ala msFree in MapServer, yes?

Sean
From artem.mapnik at googlemail.com  Wed Jan 16 17:33:49 2008
From: artem.mapnik at googlemail.com (Artem Pavlenko)
Date: Wed Jan 16 17:33:57 2008
Subject: [geos-devel] Odd problem on Vista
In-Reply-To: <478E81AE.2020500@frii.com>
References: <478E81AE.2020500@frii.com>
Message-ID: <8504344B-5405-4C15-8F49-99B6CAE047B1@gmail.com>

Hi Sean,
On 16 Jan 2008, at 22:14, Sean Gillies wrote:

> I'm using Python's ctypes and libffi to access functions in GEOS.
> GEOSGeomToWKT and GEOSGeomToWKB_buf each allocate memory that must be
> freed by the caller. This has been no problem for me on Linux or  
> Windows
> 2000, I simply free the memory with libc.free or msvcrt.free. There
> seems to be an authorization problem on Vista with the result that
> msvcrt.free cannot access the memory allocated by geos.dll. This is  
> the
> DLL I got from Artem the other day. I'm thinking that the solution is
> for GEOS to export its own free function ala msFree in MapServer, yes?
>
> Sean

Could you check you're using the same C and C++ runtime for geos/ 
ctypes/libffi ( i.e. Multi-threaded DLL )
I think there is program called 'Dependency walker' or something on  
win32. If your objects travel between DLL boundaries, make sure
new/delete malloc/free are from the same runtime.

HTH
Cheers
Artem
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From warmerdam at pobox.com  Wed Jan 16 17:39:47 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Jan 16 17:39:30 2008
Subject: [geos-devel] Odd problem on Vista
In-Reply-To: <478E81AE.2020500@frii.com>
References: <478E81AE.2020500@frii.com>
Message-ID: <478E87B3.5070406@pobox.com>

Sean Gillies wrote:
> I'm using Python's ctypes and libffi to access functions in GEOS.
> GEOSGeomToWKT and GEOSGeomToWKB_buf each allocate memory that must be
> freed by the caller. This has been no problem for me on Linux or Windows
> 2000, I simply free the memory with libc.free or msvcrt.free. There
> seems to be an authorization problem on Vista with the result that
> msvcrt.free cannot access the memory allocated by geos.dll. This is the
> DLL I got from Artem the other day. I'm thinking that the solution is
> for GEOS to export its own free function ala msFree in MapServer, yes?

Sean,

I can't see any harm in that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mark.m.fredrickson at gmail.com  Wed Jan 16 18:30:53 2008
From: mark.m.fredrickson at gmail.com (Mark Fredrickson)
Date: Wed Jan 16 18:30:56 2008
Subject: [geos-devel] Odd problem on Vista
In-Reply-To: <478E87B3.5070406@pobox.com>
References: <478E81AE.2020500@frii.com> <478E87B3.5070406@pobox.com>
Message-ID: <3db8a8970801161530v13d4cd59u731263019945909a@mail.gmail.com>

Sean,

Do you have access to GEOSGeom_destroy()? It's in the geos_c.h, which
IIRC is what was used to build that DLL according to traffic on this
list.

-Mark




On Jan 16, 2008 4:39 PM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Sean Gillies wrote:
> > I'm using Python's ctypes and libffi to access functions in GEOS.
> > GEOSGeomToWKT and GEOSGeomToWKB_buf each allocate memory that must be
> > freed by the caller. This has been no problem for me on Linux or Windows
> > 2000, I simply free the memory with libc.free or msvcrt.free. There
> > seems to be an authorization problem on Vista with the result that
> > msvcrt.free cannot access the memory allocated by geos.dll. This is the
> > DLL I got from Artem the other day. I'm thinking that the solution is
> > for GEOS to export its own free function ala msFree in MapServer, yes?
>
> Sean,
>
> I can't see any harm in that.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From mark.m.fredrickson at gmail.com  Wed Jan 16 18:32:23 2008
From: mark.m.fredrickson at gmail.com (Mark Fredrickson)
Date: Wed Jan 16 18:32:26 2008
Subject: [geos-devel] Odd problem on Vista
In-Reply-To: <3db8a8970801161530v13d4cd59u731263019945909a@mail.gmail.com>
References: <478E81AE.2020500@frii.com> <478E87B3.5070406@pobox.com>
	<3db8a8970801161530v13d4cd59u731263019945909a@mail.gmail.com>
Message-ID: <3db8a8970801161532y3349bd0ar7b649cc5573e0ba6@mail.gmail.com>

Oh. My bad. I misread your post. Good point. I'm writing a Scheme
wrapper right now and dealing with similar issues.

Cheers,
-Mark


On Jan 16, 2008 5:30 PM, Mark Fredrickson <mark.m.fredrickson@gmail.com> wrote:
> Sean,
>
> Do you have access to GEOSGeom_destroy()? It's in the geos_c.h, which
> IIRC is what was used to build that DLL according to traffic on this
> list.
>
> -Mark
>
>
>
>
>
> On Jan 16, 2008 4:39 PM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> > Sean Gillies wrote:
> > > I'm using Python's ctypes and libffi to access functions in GEOS.
> > > GEOSGeomToWKT and GEOSGeomToWKB_buf each allocate memory that must be
> > > freed by the caller. This has been no problem for me on Linux or Windows
> > > 2000, I simply free the memory with libc.free or msvcrt.free. There
> > > seems to be an authorization problem on Vista with the result that
> > > msvcrt.free cannot access the memory allocated by geos.dll. This is the
> > > DLL I got from Artem the other day. I'm thinking that the solution is
> > > for GEOS to export its own free function ala msFree in MapServer, yes?
> >
> > Sean,
> >
> > I can't see any harm in that.
> >
> > Best regards,
> > --
> > ---------------------------------------+--------------------------------------
> > I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> > light and sound - activate the windows | http://pobox.com/~warmerdam
> > and watch the world go round - Rush    | President OSGeo, http://osgeo.org
> >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
>
From ericknappe at gmail.com  Thu Jan 17 00:02:51 2008
From: ericknappe at gmail.com (Eric Knappe)
Date: Thu Jan 17 00:02:59 2008
Subject: [geos-devel] geos make check fails
Message-ID: <7204e3ff0801162102q1bfad9dcofd8535b34922748e@mail.gmail.com>

Paul,

A segmentation fault caused make check to FAIL.


./configure --prefix=/home/mydir
make
make check

The tail of the output from make check is this:



FAIL: testrunner
===================
1 of 1 tests failed
===================
make[2]: *** [check-TESTS] Error 1
make[2]: Leaving directory `/usr/home/mydir/geos-3.0.0/capi'
make[1]: *** [check-am] Error 2
make[1]: Leaving directory `/usr/home/mydir/geos-3.0.0/capi'
make: *** [check-recursive] Error 1
[mydir][~/geos-3.0.0]$



In looking through the output of make check I found the listing below:
Is it odd that geostest is up to date here?
Is it odd to see "GEOS version 3.0.0rc2-CAPI"?


Making check in capi
make[1]: Entering directory `/usr/home/mydir/geos-3.0.0/capi'
make  geostest
make[2]: Entering directory `/usr/home/mydir/geos-3.0.0/capi'
make[2]: `geostest' is up to date.
make[2]: Leaving directory `/usr/home/mydir/geos-3.0.0/capi'
make  check-TESTS
make[2]: Entering directory `/usr/home/mydir/geos-3.0.0/capi'
./testrunner: line 2:  4800 Segmentation fault      ./geostest ./test.wkt >
test.out
geostest exited with non-zero status (139)
1,25d0
< GEOS version 3.0.0rc2-CAPI-1.3.0



I found some warnings in the make output:



make[1]: Entering directory `/usr/home/mydir/geos-3.0.0/capi'
if /bin/sh ../libtool --tag=CXX --mode=compile g++ -DHAVE_CONFIG_H -I. -I.
-I../                           source/headers -I../source/headers/geos
-I../source/headers -DGEOS_CAPI_VERSION=                           '"
3.0.0-CAPI-1.4.1"' -DGEOS_JTS_PORT='"1.7.1"'   -g -O2 -DGEOS_INLINE -Wall
-ans                           i -pedantic -Wno-long-long -MT
libgeos_c_la-geos_c.lo -MD -MP -MF ".deps/libgeos
_c_la-geos_c.Tpo" -c -o libgeos_c_la-geos_c.lo `test -f 'geos_c.cpp' || echo
'./                           '`geos_c.cpp; \
then mv -f ".deps/libgeos_c_la-geos_c.Tpo" ".deps/libgeos_c_la-geos_c.Plo";
else                            rm -f ".deps/libgeos_c_la-geos_c.Tpo"; exit
1; fi
mkdir .libs
 g++ -DHAVE_CONFIG_H -I. -I. -I../source/headers -I../source/headers/geos
-I../s                           ource/headers -DGEOS_CAPI_VERSION=\"
3.0.0-CAPI-1.4.1\" -DGEOS_JTS_PORT=\"1.7.1\"                            -g
-O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT
libgeos_c_la-geos                           _c.lo -MD -MP -MF
.deps/libgeos_c_la-geos_c.Tpo -c geos_c.cpp  -fPIC -DPIC -o
.l                           ibs/libgeos_c_la-geos_c.o
geos_c.cpp: In function `int GEOSWKBWriter_getOutputDimension(const
GEOSWKBWrite                           r*)':
geos_c.cpp:2207: warning: converting to non-pointer type `int' from NULL
geos_c.cpp: In function `int GEOSWKBWriter_getByteOrder(const
GEOSWKBWriter*)':
geos_c.cpp:2236: warning: converting to non-pointer type `int' from NULL
geos_c.cpp: In function `char GEOSWKBWriter_getIncludeSRID(const
GEOSWKBWriter*)                           ':
geos_c.cpp:2265: warning: converting to non-pointer type `char' from NULL
 g++ -DHAVE_CONFIG_H -I. -I. -I../source/headers -I../source/headers/geos
-I../s                           ource/headers -DGEOS_CAPI_VERSION=\"
3.0.0-CAPI-1.4.1\" -DGEOS_JTS_PORT=\"1.7.1\"                            -g
-O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT
libgeos_c_la-geos                           _c.lo -MD -MP -MF
.deps/libgeos_c_la-geos_c.Tpo -c geos_c.cpp -o
libgeos_c_la-ge                           os_c.o >/dev/null 2>&1

.
.
.

creating XMLTester
if g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers
-I../../source/headers/geo                           s
-I../../source/headers -I../../source/io/markup    -g -O2 -DGEOS_INLINE
-Wall                            -ansi -pedantic -Wno-long-long -MT
SimpleWKTTester.o -MD -MP -MF ".deps/SimpleWK
TTester.Tpo" -c -o SimpleWKTTester.o SimpleWKTTester.cpp; \
then mv -f ".deps/SimpleWKTTester.Tpo" ".deps/SimpleWKTTester.Po"; else rm
-f ".                           deps/SimpleWKTTester.Tpo"; exit 1; fi
In file included from SimpleWKTTester.cpp:23:
../../source/headers/geos/io.h:61:2: warning: #warning is a GCC extension
../../source/headers/geos/io.h:61:2: warning: #warning *** DEPRECATED: You
are u                           sing deprecated header io.h. Please, update
your sources according to new layout                            of GEOS
headers and namespaces
In file included from SimpleWKTTester.cpp:24:
../../source/headers/geos/geom.h:145:2: warning: #warning is a GCC extension
../../source/headers/geos/geom.h:145:2: warning: #warning *** DEPRECATED:
You ar                           e using deprecated header geom.h. Please,
update your sources according to new l                           ayout of
GEOS headers and namespaces
/bin/sh ../../libtool --tag=CXX --mode=link g++  -g -O2 -DGEOS_INLINE -Wall
-ans                           i -pedantic -Wno-long-long   -o
SimpleWKTTester  SimpleWKTTester.o ../../source/
libgeos.la ../../source/libgeos.la
g++ -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -o
.libs/SimpleWKT                           Tester SimpleWKTTester.o
../../source/.libs/libgeos.so
creating SimpleWKTTester



Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20080117/58db7c9a/attachment-0001.html
From pramsey at refractions.net  Thu Jan 17 22:55:20 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Thu Jan 17 22:56:10 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>
Message-ID: <26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>

I just confirmed this behavior. true/true on geos 2.2 true/false on  
geos 3.0.
Please file this at http://trac.osgeo.org/geos, it's real, and it's  
not right.

P

On Jan 17, 2008, at 7:35 PM, KXK wrote:

> SELECT
> ST_Contains(
> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>
> returns TRUE
>
>
> But,
>
> SELECT
> ST_Contains(
> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>
> returns FALSE
>
> I thought the above would also return TRUE.
>
>
> Is this behavior of ST_Contains correct?
>
> [VERSION INFORMATION]
> OS: fc6
> PostgreSQL: 8.2.4
> PostGIS: 1.2
> GEOS: 3.0.0
> _______________________________________________
> postgis-users mailing list
> postgis-users@postgis.refractions.net
> http://postgis.refractions.net/mailman/listinfo/postgis-users

From pramsey at refractions.net  Thu Jan 17 23:02:13 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Thu Jan 17 23:02:20 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>
	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>
Message-ID: <19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>

I think this must be arising in the "I'm a box so I can short-circuit  
full computation" code. The error displays with different combinations  
of square and non-square arguments.

On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:

> I just confirmed this behavior. true/true on geos 2.2 true/false on  
> geos 3.0.
> Please file this at http://trac.osgeo.org/geos, it's real, and it's  
> not right.
>
> P
>
> On Jan 17, 2008, at 7:35 PM, KXK wrote:
>
>> SELECT
>> ST_Contains(
>> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>
>> returns TRUE
>>
>>
>> But,
>>
>> SELECT
>> ST_Contains(
>> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>
>> returns FALSE
>>
>> I thought the above would also return TRUE.
>>
>>
>> Is this behavior of ST_Contains correct?
>>
>> [VERSION INFORMATION]
>> OS: fc6
>> PostgreSQL: 8.2.4
>> PostGIS: 1.2
>> GEOS: 3.0.0
>> _______________________________________________
>> postgis-users mailing list
>> postgis-users@postgis.refractions.net
>> http://postgis.refractions.net/mailman/listinfo/postgis-users
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From vivahome2 at gmail.com  Thu Jan 17 23:35:21 2008
From: vivahome2 at gmail.com (KXK)
Date: Thu Jan 17 23:35:25 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>
	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>
	<19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>
Message-ID: <e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>

Paul


Thanx for a quick reply.

At http://trac.osgeo.org/geos, I issued a ticket whose number is #171.


KXK

2008/1/18, Paul Ramsey <pramsey@refractions.net>:
> I think this must be arising in the "I'm a box so I can short-circuit
> full computation" code. The error displays with different combinations
> of square and non-square arguments.
>
> On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:
>
> > I just confirmed this behavior. true/true on geos 2.2 true/false on
> > geos 3.0.
> > Please file this at http://trac.osgeo.org/geos, it's real, and it's
> > not right.
> >
> > P
> >
> > On Jan 17, 2008, at 7:35 PM, KXK wrote:
> >
> >> SELECT
> >> ST_Contains(
> >> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
> >> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
> >>
> >> returns TRUE
> >>
> >>
> >> But,
> >>
> >> SELECT
> >> ST_Contains(
> >> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
> >> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
> >>
> >> returns FALSE
> >>
> >> I thought the above would also return TRUE.
> >>
> >>
> >> Is this behavior of ST_Contains correct?
> >>
> >> [VERSION INFORMATION]
> >> OS: fc6
> >> PostgreSQL: 8.2.4
> >> PostGIS: 1.2
> >> GEOS: 3.0.0
> >> _______________________________________________
> >> postgis-users mailing list
> >> postgis-users@postgis.refractions.net
> >> http://postgis.refractions.net/mailman/listinfo/postgis-users
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From Allan.Meek at drdc-rddc.gc.ca  Fri Jan 18 12:01:14 2008
From: Allan.Meek at drdc-rddc.gc.ca (Meek, Allan (Contractor))
Date: Fri Jan 18 12:01:32 2008
Subject: [geos-devel] How does "intersects" work?
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E0B2716@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Is there a brief explanation of how the "intersects" function in
GEOS/JTS works? I've traced the code down to RelateComputer::computeIM,
but the code comments fly over my head. :)

Thanks,
Allan
From mbdavis at refractions.net  Fri Jan 18 15:08:48 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Fri Jan 18 15:17:37 2008
Subject: [geos-devel] How does "intersects" work?
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E0B2716@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E0B2716@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <47910750.4040509@refractions.net>

Let me try...

The two input geometries are decomposed into labelled topology graphs 
(GeometryGraphs).  The labels are on the nodes and edges of the graphs, 
and contain full information about the topology of the node/edge in the 
points/lines/polygons of the original geometry.  These graphs are 
merged.  The resulting relationship (Intersection Matrix) is determined 
by the merged label information at the nodes of the merged graph. The 
labelling of each node and its incident edges is inspected, and the 
topological relationship information it contributes is added to the 
overall IM. At the end of this process the IM has been completely 
determined.

HTH - Martin


Meek, Allan (Contractor) wrote:
> Is there a brief explanation of how the "intersects" function in
> GEOS/JTS works? I've traced the code down to RelateComputer::computeIM,
> but the code comments fly over my head. :)
>
> Thanks,
> Allan
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mbdavis at refractions.net  Tue Jan 22 18:16:59 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Tue Jan 22 18:19:32 2008
Subject: [geos-devel] [Fwd: [jts-devel] JTS FAQ]
Message-ID: <4796796B.8050502@refractions.net>

GEOS users may be interested in this as well, since most of it applies 
to GEOS as well.

-------- Original Message --------

At long last JTS has a FAQ (or the beginnings of one).   My excuse is 
that I wanted to wait until there was a large enough population to have 
a statistically valid determination of "frequent"  8^)

It's at:  http://tsusiatsoftware.net/jts/jts-faq/jts-faq.html

Feel free to make suggestions for more content.



-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From benjubb at refractions.net  Thu Jan 24 17:20:52 2008
From: benjubb at refractions.net (Ben Jubb)
Date: Thu Jan 24 17:29:32 2008
Subject: [geos-devel] Found a bug in contains().
Message-ID: <47990F44.9040802@refractions.net>

i all,
While doing some testing on the prepared geometry code in PostGIS, I 
found what appears to be a bug in
operation/predicate/RectangleContains.cpp.  This appeared while testing 
the contains() predicate, with input geometries like:

A] POINT (110 120)

and

B] POLYGON ((60 120, 60 40, 160 40, 160 120, 60 120))

(the point is on one of the horizontal edges of the polygon)

When testing B.contains(A), since the poly is a rectangle, there is a 
shortcut path for the test that ends up invoking 
isPointContainedInBoundary() in RectangleContains.cpp. This is supposed 
to test if the point lies on the boundary of the rectangle.  However, as 
coded, the test will prematurely return false, and thus the whole test 
errantly returns true.


Heres the patch.

Index: RectangleContains.cpp
===================================================================
--- RectangleContains.cpp    (revision 2111)
+++ RectangleContains.cpp    (working copy)
@@ -79,10 +79,9 @@
 {
     // we already know that the point is contained in the
     // rectangle envelope
-    if (! (pt.x == rectEnv.getMinX() || pt.x == rectEnv.getMaxX()) )
+    if (pt.x != rectEnv.getMinX() && pt.x != rectEnv.getMaxX() &&
+        pt.y != rectEnv.getMinY() && pt.y != rectEnv.getMaxY() )
         return false;
-    if (! (pt.y == rectEnv.getMinY() || pt.y == rectEnv.getMaxY()) )
-        return false;
 
     return true;
 }

cheers
b
-------------- next part --------------
A non-text attachment was scrubbed...
Name: benjubb.vcf
Type: text/x-vcard
Size: 255 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20080124/0804605a/benjubb.vcf
From pramsey at refractions.net  Fri Jan 25 00:47:02 2008
From: pramsey at refractions.net (Paul Ramsey)
Date: Fri Jan 25 00:48:17 2008
Subject: [geos-devel] Found a bug in contains().
In-Reply-To: <47990F44.9040802@refractions.net>
References: <47990F44.9040802@refractions.net>
Message-ID: <A568B28A-92C6-4E89-9A3F-CDEC06E2E8ED@refractions.net>

Ben, does your patch also resolve this?

http://trac.osgeo.org/geos/ticket/171


On 24-Jan-08, at 2:20 PM, Ben Jubb wrote:

> i all,
> While doing some testing on the prepared geometry code in PostGIS,  
> I found what appears to be a bug in
> operation/predicate/RectangleContains.cpp.  This appeared while  
> testing the contains() predicate, with input geometries like:
>
> A] POINT (110 120)
>
> and
>
> B] POLYGON ((60 120, 60 40, 160 40, 160 120, 60 120))
>
> (the point is on one of the horizontal edges of the polygon)
>
> When testing B.contains(A), since the poly is a rectangle, there is  
> a shortcut path for the test that ends up invoking  
> isPointContainedInBoundary() in RectangleContains.cpp. This is  
> supposed to test if the point lies on the boundary of the  
> rectangle.  However, as coded, the test will prematurely return  
> false, and thus the whole test errantly returns true.
>
>
> Heres the patch.
>
> Index: RectangleContains.cpp
> ===================================================================
> --- RectangleContains.cpp    (revision 2111)
> +++ RectangleContains.cpp    (working copy)
> @@ -79,10 +79,9 @@
> {
>     // we already know that the point is contained in the
>     // rectangle envelope
> -    if (! (pt.x == rectEnv.getMinX() || pt.x == rectEnv.getMaxX()) )
> +    if (pt.x != rectEnv.getMinX() && pt.x != rectEnv.getMaxX() &&
> +        pt.y != rectEnv.getMinY() && pt.y != rectEnv.getMaxY() )
>         return false;
> -    if (! (pt.y == rectEnv.getMinY() || pt.y == rectEnv.getMaxY()) )
> -        return false;
>     return true;
> }
>
> cheers
> b<benjubb.vcf>_______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From vivahome2 at gmail.com  Fri Jan 25 01:45:58 2008
From: vivahome2 at gmail.com (KXK)
Date: Fri Jan 25 01:46:01 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>
	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>
	<19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>
	<e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>
Message-ID: <e7ff65060801242245k3975d324va803add2ed2d3f83@mail.gmail.com>

Paul & Ben J.


I found a quick solution for this "Contains" problem.

These 3 lines below should be deleted to fix this bug.

source/geom/Geomtry.cpp

bool
Geometry::contains(const Geometry *g) const
{
.
.
.
	if (isRectangle()) {
		return predicate::RectangleContains::contains((Polygon&)*this, *g);
	}
// Delete from here
	if (g->isRectangle()) {
		return predicate::RectangleContains::contains((const Polygon&)*g, *this);
	}
// Delete until here
.
.
}



The reason why I thought of deleting these 3 lines was:

The 1st argument should be passed as the 2nd argument,
and the 2nd argument should be passed as the 1st argument,
because it should varify if *this contains *g. Not the other way around.

BUT, predicate::RectangleContains::contains method accepts the 1st
argument only being a rectangle.
So, passing *this as the 1st argument is not acceptable since *this is
not guaranteed as a rectangle; it is just a geometry.


I will put this info to the below site, too.
http://trac.osgeo.org/geos/

What do you think about the solution? I need your feedbacks.


Good Day,

KXK


2008/1/18, KXK <vivahome2@gmail.com>:
> Paul
>
>
> Thanx for a quick reply.
>
> At http://trac.osgeo.org/geos, I issued a ticket whose number is #171.
>
>
> KXK
>
> 2008/1/18, Paul Ramsey <pramsey@refractions.net>:
> > I think this must be arising in the "I'm a box so I can short-circuit
> > full computation" code. The error displays with different combinations
> > of square and non-square arguments.
> >
> > On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:
> >
> > > I just confirmed this behavior. true/true on geos 2.2 true/false on
> > > geos 3.0.
> > > Please file this at http://trac.osgeo.org/geos, it's real, and it's
> > > not right.
> > >
> > > P
> > >
> > > On Jan 17, 2008, at 7:35 PM, KXK wrote:
> > >
> > >> SELECT
> > >> ST_Contains(
> > >> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
> > >> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
> > >>
> > >> returns TRUE
> > >>
> > >>
> > >> But,
> > >>
> > >> SELECT
> > >> ST_Contains(
> > >> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
> > >> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
> > >>
> > >> returns FALSE
> > >>
> > >> I thought the above would also return TRUE.
> > >>
> > >>
> > >> Is this behavior of ST_Contains correct?
> > >>
> > >> [VERSION INFORMATION]
> > >> OS: fc6
> > >> PostgreSQL: 8.2.4
> > >> PostGIS: 1.2
> > >> GEOS: 3.0.0
> > >> _______________________________________________
> > >> postgis-users mailing list
> > >> postgis-users@postgis.refractions.net
> > >> http://postgis.refractions.net/mailman/listinfo/postgis-users
> > >
> > > _______________________________________________
> > > geos-devel mailing list
> > > geos-devel@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
>
From reimer at rapideye.de  Fri Jan 25 09:26:59 2008
From: reimer at rapideye.de (Silke Reimer)
Date: Fri Jan 25 09:27:11 2008
Subject: [geos-devel] Bug in buffer function?
Message-ID: <200801251526.59314.reimer@rapideye.de>


Hallo!

I observed a really strange behavior of the buffer function when using an 
inner buffer. The error occurs with the following geometry:
POLYGON ((
513.4 343.1, 
707.3 344.2, 
707.0 394.9,
797.9 395.4, 
799.2 341.8,
516.9 340.9,
516.7 262.3, 
513.2 262.3,
513.4 343.1
))
Its WKB representation is
0103000000010000000900000033333333330B80409A9999999971754066666666661A8640333333333383754000000000001886406666666666AE78403333333333EF88406666666666B678409A99999999F98840CDCCCCCCCC5C7540333333333327804066666666664E75409A99999999258040CDCCCCCCCC6470409A99999999098040CDCCCCCCCC64704033333333330B80409A99999999717540

Using a buffer of -2 should lead to an inner buffer but leads 
to "GEOMETRYCOLLECTION EMPTY" resp. "POLYGON( EMPTY)" depending on the geos 
version.

Using the same buffer of -2 on a polygon with the same shape but shifted to 
the left by 100 and shifted down by 100, i.e.

POLYGON ((
413.4 243.1, 
607.3 244.2, 
607.0 294.9,
697.9 295.4, 
699.2 241.8,
416.9 240.9,
416.7 162.3, 
413.2 162.3,
413.4 243.1
))

resp.
010300000001000000090000006666666666D679403333333333636E406666666666FA82406666666666866E400000000000F8824066666666666E72403333333333CF854066666666667672409A99999999D985409A99999999396E4066666666660E7A40CDCCCCCCCC1C6E4033333333330B7A409A999999994964403333333333D379409A999999994964406666666666D679403333333333636E40

leads to the expected buffer:
POLYGON((609.172261037685 243.512992930268,609.26383338939 
243.821372982058,609.29996498814 244.211834112356,609.011804031568 
292.911035772954,695.948180429531 293.389233662932,697.151062564334 
243.793477951075,609.172261037685 243.512992930268))
resp. 
01030000000100000007000000DD1965CA600983408D5226706A706E403118AE541C0A83402AF8FDAF487A6E400A300B54660A8340DB175558C7866E405E4CB62C1808834035253F9A934E72405BFC9EDF95BF8540BECC134D3A567240B72B4A6035C98540EB3EDF2B64796E40DD1965CA600983408D5226706A706E40

I tested this on different geos versions among them
3.0.0rc4 and 3.0.0

I would say that this is a bug but it would be nice if somebody could confirm 
this - and perhaps you even have an idea how to solve this? I did not find 
any entry in the bug tracker but maybe I just missed it. In this case I would 
be glad for a hint.

Many greetings,

	Silke

-- 

RapidEye AG
Molkenmarkt 30
14776 Brandenburg an der Havel
Germany

Head Office/Sitz der Gesellschaft: Brandenburg an der Havel
Management Board/Vorstand: Wolfgang G. Biedermann
Chairman of Supervisory Board/Vorsitzender des Aufsichtsrates: Axel Schmalz
Commercial Register/Handelsregister Potsdam HRB 17 796
Tax Number/Steuernummer: 048/100/00053
VAT-Ident-Number/Ust.-ID: DE 199331235

*************************************************************************
Diese E-Mail enthaelt vertrauliche und/oder rechtlich geschuetzte
Informationen. Wenn Sie nicht der richtige Adressat sind oder diese
E-Mail irrtuemlich erhalten haben, informieren Sie bitte sofort den
Absender und vernichten Sie diese E-Mail. Das unerlaubte Kopieren sowie
die unbefugte Weitergabe dieser E-Mail ist nicht gestattet.

The information in this e-mail is intended for the named recipients
only. It may contain privileged and confidential information. If you
have received this communication in error, any use, copying or
dissemination of its contents is strictly prohibited. Please erase all
copies of the message along with any included attachments and notify
RapidEye AG or the sender immediately by telephone at the number
indicated on this page.
From mbdavis at refractions.net  Fri Jan 25 11:38:40 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Fri Jan 25 11:34:42 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <e7ff65060801242245k3975d324va803add2ed2d3f83@mail.gmail.com>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>	<19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>	<e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>
	<e7ff65060801242245k3975d324va803add2ed2d3f83@mail.gmail.com>
Message-ID: <479A1090.2050904@refractions.net>

The original code is correct as it stands.   Your fix works because it 
just removes a potential optimization.

The fix that Ben posted is the correct one (and has been implemented in 
JTS as well).

KXK wrote:
> Paul & Ben J.
>
>
> I found a quick solution for this "Contains" problem.
>
> These 3 lines below should be deleted to fix this bug.
>
> source/geom/Geomtry.cpp
>
> bool
> Geometry::contains(const Geometry *g) const
> {
> .
> .
> .
> 	if (isRectangle()) {
> 		return predicate::RectangleContains::contains((Polygon&)*this, *g);
> 	}
> // Delete from here
> 	if (g->isRectangle()) {
> 		return predicate::RectangleContains::contains((const Polygon&)*g, *this);
> 	}
> // Delete until here
> .
> .
> }
>
>
>
> The reason why I thought of deleting these 3 lines was:
>
> The 1st argument should be passed as the 2nd argument,
> and the 2nd argument should be passed as the 1st argument,
> because it should varify if *this contains *g. Not the other way around.
>
> BUT, predicate::RectangleContains::contains method accepts the 1st
> argument only being a rectangle.
> So, passing *this as the 1st argument is not acceptable since *this is
> not guaranteed as a rectangle; it is just a geometry.
>
>
> I will put this info to the below site, too.
> http://trac.osgeo.org/geos/
>
> What do you think about the solution? I need your feedbacks.
>
>
> Good Day,
>
> KXK
>
>
> 2008/1/18, KXK <vivahome2@gmail.com>:
>   
>> Paul
>>
>>
>> Thanx for a quick reply.
>>
>> At http://trac.osgeo.org/geos, I issued a ticket whose number is #171.
>>
>>
>> KXK
>>
>> 2008/1/18, Paul Ramsey <pramsey@refractions.net>:
>>     
>>> I think this must be arising in the "I'm a box so I can short-circuit
>>> full computation" code. The error displays with different combinations
>>> of square and non-square arguments.
>>>
>>> On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:
>>>
>>>       
>>>> I just confirmed this behavior. true/true on geos 2.2 true/false on
>>>> geos 3.0.
>>>> Please file this at http://trac.osgeo.org/geos, it's real, and it's
>>>> not right.
>>>>
>>>> P
>>>>
>>>> On Jan 17, 2008, at 7:35 PM, KXK wrote:
>>>>
>>>>         
>>>>> SELECT
>>>>> ST_Contains(
>>>>> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>
>>>>> returns TRUE
>>>>>
>>>>>
>>>>> But,
>>>>>
>>>>> SELECT
>>>>> ST_Contains(
>>>>> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>
>>>>> returns FALSE
>>>>>
>>>>> I thought the above would also return TRUE.
>>>>>
>>>>>
>>>>> Is this behavior of ST_Contains correct?
>>>>>
>>>>> [VERSION INFORMATION]
>>>>> OS: fc6
>>>>> PostgreSQL: 8.2.4
>>>>> PostGIS: 1.2
>>>>> GEOS: 3.0.0
>>>>> _______________________________________________
>>>>> postgis-users mailing list
>>>>> postgis-users@postgis.refractions.net
>>>>> http://postgis.refractions.net/mailman/listinfo/postgis-users
>>>>>           
>>>> _______________________________________________
>>>> geos-devel mailing list
>>>> geos-devel@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>         
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>>>       
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mbdavis at refractions.net  Fri Jan 25 11:49:17 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Fri Jan 25 11:49:49 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <479A1090.2050904@refractions.net>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>	<19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>	<e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>	<e7ff65060801242245k3975d324va803add2ed2d3f83@mail.gmail.com>
	<479A1090.2050904@refractions.net>
Message-ID: <479A130D.3020801@refractions.net>

Whoops!  My mistake. I thought you were posting this as a solution to 
the point-in-rectangle-border bug.  I realize now that your patch is is 
a solution to

http://trac.osgeo.org/geos/ticket/171

And yes, your fix is correct - it matches what is in JTS.  As you point 
out, contains() is not commutative, so you can't just exchange the order 
of the parameters.


Martin Davis wrote:
> The original code is correct as it stands.   Your fix works because it 
> just removes a potential optimization.
>
> The fix that Ben posted is the correct one (and has been implemented 
> in JTS as well).
>
> KXK wrote:
>> Paul & Ben J.
>>
>>
>> I found a quick solution for this "Contains" problem.
>>
>> These 3 lines below should be deleted to fix this bug.
>>
>> source/geom/Geomtry.cpp
>>
>> bool
>> Geometry::contains(const Geometry *g) const
>> {
>> .
>> .
>> .
>>     if (isRectangle()) {
>>         return 
>> predicate::RectangleContains::contains((Polygon&)*this, *g);
>>     }
>> // Delete from here
>>     if (g->isRectangle()) {
>>         return predicate::RectangleContains::contains((const 
>> Polygon&)*g, *this);
>>     }
>> // Delete until here
>> .
>> .
>> }
>>
>>
>>
>> The reason why I thought of deleting these 3 lines was:
>>
>> The 1st argument should be passed as the 2nd argument,
>> and the 2nd argument should be passed as the 1st argument,
>> because it should varify if *this contains *g. Not the other way around.
>>
>> BUT, predicate::RectangleContains::contains method accepts the 1st
>> argument only being a rectangle.
>> So, passing *this as the 1st argument is not acceptable since *this is
>> not guaranteed as a rectangle; it is just a geometry.
>>
>>
>> I will put this info to the below site, too.
>> http://trac.osgeo.org/geos/
>>
>> What do you think about the solution? I need your feedbacks.
>>
>>
>> Good Day,
>>
>> KXK
>>
>>
>> 2008/1/18, KXK <vivahome2@gmail.com>:
>>  
>>> Paul
>>>
>>>
>>> Thanx for a quick reply.
>>>
>>> At http://trac.osgeo.org/geos, I issued a ticket whose number is #171.
>>>
>>>
>>> KXK
>>>
>>> 2008/1/18, Paul Ramsey <pramsey@refractions.net>:
>>>    
>>>> I think this must be arising in the "I'm a box so I can short-circuit
>>>> full computation" code. The error displays with different combinations
>>>> of square and non-square arguments.
>>>>
>>>> On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:
>>>>
>>>>      
>>>>> I just confirmed this behavior. true/true on geos 2.2 true/false on
>>>>> geos 3.0.
>>>>> Please file this at http://trac.osgeo.org/geos, it's real, and it's
>>>>> not right.
>>>>>
>>>>> P
>>>>>
>>>>> On Jan 17, 2008, at 7:35 PM, KXK wrote:
>>>>>
>>>>>        
>>>>>> SELECT
>>>>>> ST_Contains(
>>>>>> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
>>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>>
>>>>>> returns TRUE
>>>>>>
>>>>>>
>>>>>> But,
>>>>>>
>>>>>> SELECT
>>>>>> ST_Contains(
>>>>>> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
>>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>>
>>>>>> returns FALSE
>>>>>>
>>>>>> I thought the above would also return TRUE.
>>>>>>
>>>>>>
>>>>>> Is this behavior of ST_Contains correct?
>>>>>>
>>>>>> [VERSION INFORMATION]
>>>>>> OS: fc6
>>>>>> PostgreSQL: 8.2.4
>>>>>> PostGIS: 1.2
>>>>>> GEOS: 3.0.0
>>>>>> _______________________________________________
>>>>>> postgis-users mailing list
>>>>>> postgis-users@postgis.refractions.net
>>>>>> http://postgis.refractions.net/mailman/listinfo/postgis-users
>>>>>>           
>>>>> _______________________________________________
>>>>> geos-devel mailing list
>>>>> geos-devel@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>>         
>>>> _______________________________________________
>>>> geos-devel mailing list
>>>> geos-devel@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>
>>>>       
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>   
>

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From benjubb at refractions.net  Fri Jan 25 12:07:35 2008
From: benjubb at refractions.net (Ben Jubb)
Date: Fri Jan 25 12:09:27 2008
Subject: [geos-devel] Re: [postgis-users] ST_Contains doesn't work?
In-Reply-To: <479A130D.3020801@refractions.net>
References: <e7ff65060801171935g5918593co9593d5b23337d8f3@mail.gmail.com>	<26E1948E-4099-47D4-B08D-33567C2E7C14@refractions.net>	<19377B7A-F4EA-4CE5-9A9D-42039A5B06D0@refractions.net>	<e7ff65060801172035r5b59ff4bpdeecf994d03b813e@mail.gmail.com>	<e7ff65060801242245k3975d324va803add2ed2d3f83@mail.gmail.com>	<479A1090.2050904@refractions.net>
	<479A130D.3020801@refractions.net>
Message-ID: <479A1757.6020403@refractions.net>

This bug has been noted before, see message from [2007-07-23 17:06] 
"[geos-devel] GEOS SVN Geometry::contains bug!?" in the this list.

Somehow this fix didn't get into code the first time around. 

b

Martin Davis wrote:
> Whoops!  My mistake. I thought you were posting this as a solution to 
> the point-in-rectangle-border bug.  I realize now that your patch is 
> is a solution to
>
> http://trac.osgeo.org/geos/ticket/171
>
> And yes, your fix is correct - it matches what is in JTS.  As you 
> point out, contains() is not commutative, so you can't just exchange 
> the order of the parameters.
>
>
> Martin Davis wrote:
>> The original code is correct as it stands.   Your fix works because 
>> it just removes a potential optimization.
>>
>> The fix that Ben posted is the correct one (and has been implemented 
>> in JTS as well).
>>
>> KXK wrote:
>>> Paul & Ben J.
>>>
>>>
>>> I found a quick solution for this "Contains" problem.
>>>
>>> These 3 lines below should be deleted to fix this bug.
>>>
>>> source/geom/Geomtry.cpp
>>>
>>> bool
>>> Geometry::contains(const Geometry *g) const
>>> {
>>> .
>>> .
>>> .
>>>     if (isRectangle()) {
>>>         return 
>>> predicate::RectangleContains::contains((Polygon&)*this, *g);
>>>     }
>>> // Delete from here
>>>     if (g->isRectangle()) {
>>>         return predicate::RectangleContains::contains((const 
>>> Polygon&)*g, *this);
>>>     }
>>> // Delete until here
>>> .
>>> .
>>> }
>>>
>>>
>>>
>>> The reason why I thought of deleting these 3 lines was:
>>>
>>> The 1st argument should be passed as the 2nd argument,
>>> and the 2nd argument should be passed as the 1st argument,
>>> because it should varify if *this contains *g. Not the other way 
>>> around.
>>>
>>> BUT, predicate::RectangleContains::contains method accepts the 1st
>>> argument only being a rectangle.
>>> So, passing *this as the 1st argument is not acceptable since *this is
>>> not guaranteed as a rectangle; it is just a geometry.
>>>
>>>
>>> I will put this info to the below site, too.
>>> http://trac.osgeo.org/geos/
>>>
>>> What do you think about the solution? I need your feedbacks.
>>>
>>>
>>> Good Day,
>>>
>>> KXK
>>>
>>>
>>> 2008/1/18, KXK <vivahome2@gmail.com>:
>>>  
>>>> Paul
>>>>
>>>>
>>>> Thanx for a quick reply.
>>>>
>>>> At http://trac.osgeo.org/geos, I issued a ticket whose number is #171.
>>>>
>>>>
>>>> KXK
>>>>
>>>> 2008/1/18, Paul Ramsey <pramsey@refractions.net>:
>>>>   
>>>>> I think this must be arising in the "I'm a box so I can short-circuit
>>>>> full computation" code. The error displays with different 
>>>>> combinations
>>>>> of square and non-square arguments.
>>>>>
>>>>> On Jan 17, 2008, at 7:55 PM, Paul Ramsey wrote:
>>>>>
>>>>>     
>>>>>> I just confirmed this behavior. true/true on geos 2.2 true/false on
>>>>>> geos 3.0.
>>>>>> Please file this at http://trac.osgeo.org/geos, it's real, and it's
>>>>>> not right.
>>>>>>
>>>>>> P
>>>>>>
>>>>>> On Jan 17, 2008, at 7:35 PM, KXK wrote:
>>>>>>
>>>>>>       
>>>>>>> SELECT
>>>>>>> ST_Contains(
>>>>>>> GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))', -1),
>>>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>>>
>>>>>>> returns TRUE
>>>>>>>
>>>>>>>
>>>>>>> But,
>>>>>>>
>>>>>>> SELECT
>>>>>>> ST_Contains(
>>>>>>> GeomFromText('POLYGON((0 0,0 11,11 10,10 0,0 0))', -1),
>>>>>>> GeomFromText('POLYGON((5 5,5 6,6 6,6 5,5 5))', -1) );
>>>>>>>
>>>>>>> returns FALSE
>>>>>>>
>>>>>>> I thought the above would also return TRUE.
>>>>>>>
>>>>>>>
>>>>>>> Is this behavior of ST_Contains correct?
>>>>>>>
>>>>>>> [VERSION INFORMATION]
>>>>>>> OS: fc6
>>>>>>> PostgreSQL: 8.2.4
>>>>>>> PostGIS: 1.2
>>>>>>> GEOS: 3.0.0
>>>>>>> _______________________________________________
>>>>>>> postgis-users mailing list
>>>>>>> postgis-users@postgis.refractions.net
>>>>>>> http://postgis.refractions.net/mailman/listinfo/postgis-users
>>>>>>>           
>>>>>> _______________________________________________
>>>>>> geos-devel mailing list
>>>>>> geos-devel@lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>>>         
>>>>> _______________________________________________
>>>>> geos-devel mailing list
>>>>> geos-devel@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>>
>>>>>       
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>>>   
>>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: benjubb.vcf
Type: text/x-vcard
Size: 255 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20080125/959929ee/benjubb.vcf
From geos at billz.fastmail.fm  Mon Jan 28 05:01:24 2008
From: geos at billz.fastmail.fm (Bill Zissimopoulos)
Date: Mon Jan 28 05:01:26 2008
Subject: [geos-devel] Potential memory leak in GEOSTopologyPreserveSimplify
Message-ID: <1201514484.24104.1233628311@webmail.messagingengine.com>

Hello:

I wish to report a potential memory leak in
GEOSTopologyPreserveSimplify. This memory leak appears serious enough
that my batch processing software will run out of memory a few minutes
into its processing.

This is with geos-3.0.0 on Mac OS X 10.4.11. The library has been
configured and made without any special options:
	./configure --prefix=<somedir>/.install; make; make install

I have modified the capi/geostest.c program to demonstrate the problem.
The file is included at the end of this mail. I have used standard Mac
OS X tools to track the memory leak:
	MallocStackLogging=1 ./a.out test.wkt
Using Mac OS X's /usr/bin/leaks tool and after some post-processing I
get as output the call stacks of the allocation point of leaked objects.
This output is included at the end of this mail.

Looking at the output it appears that (among others)
geos::index::quadtree::Node::NodeBase objects get created but never
freed. My knowledge of the GEOS internals is 0, so I am turning to this
list in the hope that the matter can be resolved.

Many thanks for your help and attention. Please note that I am not
subscribed to the geos-devel list so CC me on any responses.

Bill


leaks:
<<
start | _start | main | do_all | GEOSTopologyPreserveSimplify |
geos::simplify::TopologyPreservingSimplifier::simplify(geos::geom::Geometry
const*, double) |
geos::simplify::TopologyPreservingSimplifier::getResultGeometry() |
geos::simplify::LineSegmentIndex::add(geos::simplify::TaggedLineString
const&) | geos::simplify::LineSegmentIndex::add(geos::geom::LineSegment
const*) | geos::index::quadtree::Quadtree::insert(geos::geom::Envelope
const*, void*) |
geos::index::quadtree::Root::insert(geos::geom::Envelope const*, void*)
| geos::index::quadtree::NodeBase::add(void*) | std::vector<void*,
std::allocator<void*>
>::_M_insert_aux(__gnu_cxx::__normal_iterator<void**, std::vector<void*,
std::allocator<void*> > >, void* const&) | operator new(unsigned long) |
malloc

start | _start | main | do_all | GEOSTopologyPreserveSimplify |
geos::simplify::TopologyPreservingSimplifier::simplify(geos::geom::Geometry
const*, double) |
geos::simplify::TopologyPreservingSimplifier::getResultGeometry() |
geos::simplify::LineSegmentIndex::add(geos::simplify::TaggedLineString
const&) | geos::simplify::LineSegmentIndex::add(geos::geom::LineSegment
const*) | geos::index::quadtree::Quadtree::insert(geos::geom::Envelope
const*, void*) |
geos::index::quadtree::Root::insert(geos::geom::Envelope const*, void*)
|
geos::index::quadtree::Root::insertContained(geos::index::quadtree::Node*,
geos::geom::Envelope const*, void*) |
geos::index::quadtree::Node::getNode(geos::geom::Envelope const*) |
geos::index::quadtree::Node::getSubnode(int) |
geos::index::quadtree::Node::createSubnode(int) |
geos::index::quadtree::NodeBase::NodeBase[not-in-charge]() | operator
new(unsigned long) | malloc

start | _start | main | do_all | GEOSTopologyPreserveSimplify |
geos::simplify::TopologyPreservingSimplifier::simplify(geos::geom::Geometry
const*, double) |
geos::simplify::TopologyPreservingSimplifier::getResultGeometry() |
geos::simplify::LineSegmentIndex::add(geos::simplify::TaggedLineString
const&) | geos::simplify::LineSegmentIndex::add(geos::geom::LineSegment
const*) | geos::index::quadtree::Quadtree::insert(geos::geom::Envelope
const*, void*) |
geos::index::quadtree::Root::insert(geos::geom::Envelope const*, void*)
|
geos::index::quadtree::Root::insertContained(geos::index::quadtree::Node*,
geos::geom::Envelope const*, void*) |
geos::index::quadtree::Node::getNode(geos::geom::Envelope const*) |
geos::index::quadtree::Node::getSubnode(int) |
geos::index::quadtree::Node::createSubnode(int) | operator new(unsigned
long) | malloc

start | _start | main | do_all | GEOSTopologyPreserveSimplify |
geos::simplify::TopologyPreservingSimplifier::simplify(geos::geom::Geometry
const*, double) |
geos::simplify::TopologyPreservingSimplifier::getResultGeometry() |
geos::simplify::TaggedLineStringSimplifier::simplify(geos::simplify::TaggedLineString*)
| geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::hasBadIntersection(geos::simplify::TaggedLineString
const*, std::vector<unsigned long, std::allocator<unsigned long> >
const&, geos::geom::LineSegment const&) |
geos::simplify::TaggedLineStringSimplifier::hasBadInputIntersection(geos::simplify::TaggedLineString
const*, std::vector<unsigned long, std::allocator<unsigned long> >
const&, geos::geom::LineSegment const&) |
geos::simplify::LineSegmentIndex::query(geos::geom::LineSegment const*)
const | geos::index::quadtree::NodeBase::visit(geos::geom::Envelope
const*, geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visit(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::index::quadtree::NodeBase::visitItems(geos::geom::Envelope const*,
geos::index::ItemVisitor&) |
geos::simplify::LineSegmentVisitor::visitItem(void*) |
std::vector<geos::geom::LineSegment*,
std::allocator<geos::geom::LineSegment*>
>::_M_insert_aux(__gnu_cxx::__normal_iterator<geos::geom::LineSegment**,
std::vector<geos::geom::LineSegment*,
std::allocator<geos::geom::LineSegment*> > >, geos::geom::LineSegment*
const&) | operator new(unsigned long) | malloc

start | _start | main | do_all | GEOSTopologyPreserveSimplify |
geos::simplify::TopologyPreservingSimplifier::simplify(geos::geom::Geometry
const*, double) |
geos::simplify::TopologyPreservingSimplifier::getResultGeometry() |
geos::simplify::TaggedLineStringSimplifier::simplify(geos::simplify::TaggedLineString*)
| geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::simplifySection(unsigned
long, unsigned long, unsigned long) |
geos::simplify::TaggedLineStringSimplifier::flatten(unsigned long,
unsigned long) |
geos::simplify::TaggedLineStringSimplifier::remove(geos::simplify::TaggedLineString
const*, unsigned long, unsigned long) |
geos::simplify::LineSegmentIndex::remove(geos::geom::LineSegment const*)
| geos::index::quadtree::Quadtree::remove(geos::geom::Envelope const*,
void*) |
geos::index::quadtree::Quadtree::ensureExtent(geos::geom::Envelope
const*, double) | operator new(unsigned long) | malloc
>>

modified geostest.c:
<<
#define _GNU_SOURCE

#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

#include "geos_c.h"

#define MAXWKTLEN 1047551

void
usage(char *me)
{
	fprintf(stderr, "Usage: %s <wktfile>\n", me);
	exit(1);
}

void
notice(const char *fmt, ...) {
	va_list ap;

        fprintf( stdout, "NOTICE: ");

	va_start (ap, fmt);
        vfprintf( stdout, fmt, ap);
        va_end(ap);
        fprintf( stdout, "\n" );
}

void
log_and_exit(const char *fmt, ...) {
	va_list ap;

        fprintf( stdout, "ERROR: ");

	va_start (ap, fmt);
        vfprintf( stdout, fmt, ap);
        va_end(ap);
        fprintf( stdout, "\n" );
	exit(1);
}

int
do_all(char *inputfile)
{
	GEOSGeometry* g1;
	GEOSGeometry* g2;
	static char wkt[MAXWKTLEN];
	FILE *input;
	char *ptr;
	unsigned char* uptr;
	size_t size;
    int i;

	input = fopen(inputfile, "r");
	if ( ! input ) { perror("fopen"); exit(1); }

	size = fread(wkt, 1, MAXWKTLEN-1, input);
	fclose(input);
	if ( ! size ) { perror("fread"); exit(1); }
	if ( size == MAXWKTLEN-1 ) { perror("WKT input too big!"); exit(1); }
	wkt[size] = '\0'; /* ensure it is null terminated */

	g1 = GEOSGeomFromWKT(wkt);

#if 0
	/* Simplify */
    for (i = 0; i < 100000; i++)
    {
    	g2 = GEOSSimplify(g1, 0.5);
    	GEOSGeom_destroy(g2);
    	putc('s', stderr); fflush(stderr);
    }
#endif

#if 1
	/* Topology Preserve Simplify */
    for (i = 0; i < 100000; i++)
    {
    	g2 = GEOSTopologyPreserveSimplify(g1, 0.5);
    	GEOSGeom_destroy(g2);
    	putc('t', stderr); fflush(stderr);
    }
#endif

	GEOSGeom_destroy(g1);
	
    getc(stdin);

	return 0;
}

int
main(int argc, char **argv)
{
	int i, n=1;

	initGEOS(notice, log_and_exit);
	printf("GEOS version %s\n", GEOSversion());

	if ( argc < 2 ) usage(argv[0]);
	if ( argc > 2 ) n=atoi(argv[2]);
	if ( ! n ) n=1;

	for (i=0; i<n; i++) {
		do_all(argv[1]);
	}
	putc('\n', stderr);

	finishGEOS();

	return EXIT_SUCCESS;
}
>>
From ablas at indra.es  Tue Jan 29 05:49:07 2008
From: ablas at indra.es (Blas Jimenez, Arturo)
Date: Tue Jan 29 05:49:18 2008
Subject: [geos-devel] Editing geometry
Message-ID: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>

Hello, 

 

I am currently learning GEOS c++ API and I'm trying to edit a simple
geometry (trying to add a point to a line string). I've realized that
geometries are not editable, so I must, to move, remove or add a single
point to create a fully new geometry with a new coordinate sequence that
only differs on a single point.

 

Is there any way to edit a geometry without creating a full copy of it
(in my case due to the complexity of my geometries is not possible - I
have geometries that can reach 100Mb stored in memory-).

 

Another doubt is how to edit geometries using GeometryEditor class.
Should I implement my own class deriving of it? How must it be used?

 

Thanks in advance.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20080129/05b8b6fe/attachment.html
From mbdavis at refractions.net  Tue Jan 29 11:57:02 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Tue Jan 29 11:53:03 2008
Subject: [geos-devel] Editing geometry
In-Reply-To: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>
References: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>
Message-ID: <479F5ADE.1050304@refractions.net>

How are you planning to "add a point" to your (presumably) 100Mb long 
array of points in memory?

However you do this, you can them simply build a new Geometry sitting on 
top of the modified array inside a CoordinateSequence.

The reason GEOS/JTS don't provide update capability is that there are 
many ways to implement this depending on how your underlying data is 
structured. The design decision was made that it's better not to make 
assumptions about how best to do this.

Also, this means that "aliasing" errors are not the fault of the API!

The Javadoc of GeometryEditor in JTS explains how to use it. Not sure if 
this is provided in GEOS - if not, download JTS 1.9 ( 
http://sourceforge.net/projects/jts-topo-suite/) and have a look.

Blas Jimenez, Arturo wrote:
>
> Hello,
>
> I am currently learning GEOS c++ API and I?m trying to edit a simple 
> geometry (trying to add a point to a line string). I?ve realized that 
> geometries are not editable, so I must, to move, remove or add a 
> single point to create a fully new geometry with a new coordinate 
> sequence that only differs on a single point.
>
> Is there any way to edit a geometry without creating a full copy of it 
> (in my case due to the complexity of my geometries is not possible ? I 
> have geometries that can reach 100Mb stored in memory-).
>
> Another doubt is how to edit geometries using GeometryEditor class. 
> Should I implement my own class deriving of it? How must it be used?
>
> Thanks in advance.
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From ablas at indra.es  Wed Jan 30 02:12:38 2008
From: ablas at indra.es (Blas Jimenez, Arturo)
Date: Wed Jan 30 02:12:46 2008
Subject: [geos-devel] Editing geometry
In-Reply-To: <479F5ADE.1050304@refractions.net>
References: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>
	<479F5ADE.1050304@refractions.net>
Message-ID: <488C3BCC796130459A3DDC9FA05730522C69AA@MADARRMAIL1.indra.es>



> How are you planning to "add a point" to your (presumably) 100Mb long 
> array of points in memory?

To add a point to an array of points it's not trivial, but an efficient
way to do it it's to maintain a list of pointers to points and add it at
the end or change intermediate pointers to insert at the middle of the
list.


> However you do this, you can them simply build a new Geometry sitting
on 
> top of the modified array inside a CoordinateSequence.

I cannot do that because I would have been spending high amounts of
memory and time to get 'almost' the same that I had at the beginning.
It's unneficient to copy all the list to add a single point.


> The Javadoc of GeometryEditor in JTS explains how to use it. Not sure
if 
> this is provided in GEOS - if not, download JTS 1.9 ( 
> http://sourceforge.net/projects/jts-topo-suite/) and have a look.

I have already take a look, but the documentation is very similar that
GEOS'.

How can be used GEOS geometry editors/filters? Is also with this method
necessary to copy the whole geometry to a new one)

Best regards.

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From mbdavis at refractions.net  Wed Jan 30 11:38:51 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Wed Jan 30 11:37:18 2008
Subject: [geos-devel] Editing geometry
In-Reply-To: <488C3BCC796130459A3DDC9FA05730522C69AA@MADARRMAIL1.indra.es>
References: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>	<479F5ADE.1050304@refractions.net>
	<488C3BCC796130459A3DDC9FA05730522C69AA@MADARRMAIL1.indra.es>
Message-ID: <47A0A81B.5030108@refractions.net>



Blas Jimenez, Arturo wrote:
>   
>> How are you planning to "add a point" to your (presumably) 100Mb long 
>> array of points in memory?
>>     
>
> To add a point to an array of points it's not trivial, but an efficient
> way to do it it's to maintain a list of pointers to points and add it at
> the end or change intermediate pointers to insert at the middle of the
> list.
>
>   
I'm not sure I follow your logic, but the key point is that if you think 
you have a structure that allows adding points efficiently and (more 
importantly) allows accessing the points in an array fashion 
efficiently, then just wrap it in a CoordinateSequence and use that to 
build your geometries.  (A CoordinateSequence is just an interface - you 
can have whatever implementation you want underneath it)
>   
>> However you do this, you can them simply build a new Geometry sitting
>>     
> on 
>   
>> top of the modified array inside a CoordinateSequence.
>>     
>
> I cannot do that because I would have been spending high amounts of
> memory and time to get 'almost' the same that I had at the beginning.
> It's unneficient to copy all the list to add a single point.
>
>
>   
>> The Javadoc of GeometryEditor in JTS explains how to use it. Not sure
>>     
> if 
>   
>> this is provided in GEOS - if not, download JTS 1.9 ( 
>> http://sourceforge.net/projects/jts-topo-suite/) and have a look.
>>     
>
> I have already take a look, but the documentation is very similar that
> GEOS'.
>
> How can be used GEOS geometry editors/filters? Is also with this method
> necessary to copy the whole geometry to a new one)
>   
Filters don't require you to copy - but they also won't let you change 
the length of the underlying array.
> Best regards.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From benjubb at refractions.net  Wed Jan 30 17:42:44 2008
From: benjubb at refractions.net (Ben Jubb)
Date: Wed Jan 30 17:43:56 2008
Subject: [geos-devel] New Release?
Message-ID: <47A0FD64.3010405@refractions.net>

Hi all,
I want to wrap up my prepared geometry additions to GEOS.  The code is 
complete and tested.  Documentation is in place.  What is required to 
push out a 3.1.0 release?

b
-------------- next part --------------
A non-text attachment was scrubbed...
Name: benjubb.vcf
Type: text/x-vcard
Size: 255 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20080130/76957825/benjubb.vcf
From geos at billz.fastmail.fm  Thu Jan 31 01:27:31 2008
From: geos at billz.fastmail.fm (Bill Zissimopoulos)
Date: Thu Jan 31 01:27:33 2008
Subject: [geos-devel] Potential memory leak in GEOSTopologyPreserveSimplify
Message-ID: <1201760851.21962.1234264009@webmail.messagingengine.com>

I have spent time investigating this memory leak and produced a patch
that I believe fixes it. The patch is included in this mail.

The GEOS tests (make check) pass with this patch. However in one of my
private tests I found a one point difference in the simplified polyline
produced with and without the patch (one point missing with this patch).
Because the resulting polyline looks correct to me I decided to
incorporate the patch, however your decision may be different.


I would much appreciate it if someone more knowledgeable than I gave the
patch a look. Thank you.

Bill

diff -Naur geos-3.0.0/source/index/quadtree/NodeBase.cpp
geos-3.0.0.new/source/index/quadtree/NodeBase.cpp
--- geos-3.0.0/source/index/quadtree/NodeBase.cpp       2007-12-12
13:59:26.000000000 -0800
+++ geos-3.0.0.new/source/index/quadtree/NodeBase.cpp   2008-01-30
20:59:05.000000000 -0800
@@ -215,7 +215,10 @@
 			if (found) {
 				// trim subtree if empty
 				if (subnode[i]->isPrunable())
-                               subnode[i] = NULL;
+                               {
+                                       delete subnode[i];
+                                       subnode[i] = NULL;
+                               }
 				break;
 			}
 		}
diff -Naur geos-3.0.0/source/index/quadtree/Quadtree.cpp
geos-3.0.0.new/source/index/quadtree/Quadtree.cpp
--- geos-3.0.0/source/index/quadtree/Quadtree.cpp       2007-12-12
13:59:26.000000000 -0800
+++ geos-3.0.0.new/source/index/quadtree/Quadtree.cpp   2008-01-30
20:59:05.000000000 -0800
@@ -142,7 +142,10 @@
 Quadtree::remove(const Envelope* itemEnv, void* item)
 {
 	Envelope* posEnv = ensureExtent(itemEnv, minExtent);
-       return root->remove(posEnv, item);
+       bool result = root->remove(posEnv, item);
+       if (itemEnv != posEnv)
+               delete posEnv;
+       return result;
 }
 
 /*private*/
From ablas at indra.es  Thu Jan 31 03:15:28 2008
From: ablas at indra.es (Blas Jimenez, Arturo)
Date: Thu Jan 31 03:15:50 2008
Subject: [geos-devel] Editing geometry
In-Reply-To: <47A0A81B.5030108@refractions.net>
References: <488C3BCC796130459A3DDC9FA05730522C6884@MADARRMAIL1.indra.es>	<479F5ADE.1050304@refractions.net><488C3BCC796130459A3DDC9FA05730522C69AA@MADARRMAIL1.indra.es>
	<47A0A81B.5030108@refractions.net>
Message-ID: <488C3BCC796130459A3DDC9FA05730522FE192@MADARRMAIL1.indra.es>

Ok, lots of thanks Martin. 

I'll maybe implement a kind of wrapper to give my geometries the
posibility to make a commit of changes, so that I don't have to change
my whole data to add or modify a single point. 

I store a list of command objects with local changes and in my commit
all changes are applied to a CoordinateSequence that is assigned again
to the geometry.

Best regards.

>   
>> How are you planning to "add a point" to your (presumably) 100Mb long

>> array of points in memory?
>>     
>
> To add a point to an array of points it's not trivial, but an
efficient
> way to do it it's to maintain a list of pointers to points and add it
at
> the end or change intermediate pointers to insert at the middle of the
> list.
>
>   
I'm not sure I follow your logic, but the key point is that if you think

you have a structure that allows adding points efficiently and (more 
importantly) allows accessing the points in an array fashion 
efficiently, then just wrap it in a CoordinateSequence and use that to 
build your geometries.  (A CoordinateSequence is just an interface - you

can have whatever implementation you want underneath it)
>   
>> However you do this, you can them simply build a new Geometry sitting
>>     
> on 
>   
>> top of the modified array inside a CoordinateSequence.
>>     
>
> I cannot do that because I would have been spending high amounts of
> memory and time to get 'almost' the same that I had at the beginning.
> It's unneficient to copy all the list to add a single point.
>
>
>   
>> The Javadoc of GeometryEditor in JTS explains how to use it. Not sure
>>     
> if 
>   
>> this is provided in GEOS - if not, download JTS 1.9 ( 
>> http://sourceforge.net/projects/jts-topo-suite/) and have a look.
>>     
>
> I have already take a look, but the documentation is very similar that
> GEOS'.
>
> How can be used GEOS geometry editors/filters? Is also with this
method
> necessary to copy the whole geometry to a new one)
>   
Filters don't require you to copy - but they also won't let you change 
the length of the underlying array.
> Best regards.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
