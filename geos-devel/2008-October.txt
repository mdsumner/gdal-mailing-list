From pramsey at cleverelephant.ca  Wed Oct  1 13:34:12 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 13:34:14 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <48E2C677.3090907@refractions.net>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>
	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>
	<48E25A00.4060700@refractions.net>
	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>
	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>
	<48E2C677.3090907@refractions.net>
Message-ID: <30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>

Crisis averted, situation normal.
The problem was in the memory contexted being switch out from under
the allocator. The difficulty is that palloc() isn't a function in
pgsql, it's rewritten to a two-parameter memory context allocation,
and putting that function into the callback makes the question of
"which context am I addressing?" a bit hard to figure out. If I use a
static context like TopMemoryContext things work, but that means I'm
leaking into a permanent pool which is non-optimal. More work to do...
:)

P.

On Tue, Sep 30, 2008 at 5:38 PM, Chris Hodgson <chodgson@refractions.net> wrote:
> Do all of the "new std:vector<Geometry *>" calls use the overridden new?
>
> If not, then I think the problem is that the code inside the extern C{}
> doesn't understand that we have overridden new and delete. It MIGHT be as
> easy (and clumsy) as adding two methods geosNew and geosDelete, outside of
> the extern C {} block (which in turn call the overridden new and delete),
> and calling those from within the extern C{} instead of calling the raw
> new/delete which we are overridden.
>
> I would try this myself except I don't have the development environment
> setup yet...
>
> Chris
>
> Paul Ramsey wrote:
>>
>> Help!
>>
>> I've attached the modified geos_c.cpp and geos_c.h.in files for geos
>> for your perusal. The symptom is this:
>>
>> - Modified containsPrepared to use initGEOSMemory
>> - Run an ST_Contains(g,g,i) prepared example
>> - Memory is both allocated and deallocated through the over-ridden
>> functions just fine
>> - UNTIL
>> - The code gets to the point where it has to deallocate a prepared
>> geometry and runs GEOSPreparedGeom_destroy()
>> - At that point, the deallocation does *not* enter the over-ridden
>> new/delete operators, it appears to use default operators, and
>> everything goes boom
>>
>> So,
>>
>> - the over-ride of new/delete seems to work fine inside the main geos
>> library, things get both allocated and freed using palloc and pfree
>> - but the delete inside the "extern C {}" block where
>> GEOSPreparedGeom_destroy does *not* appear to be over-ridden by our
>> cunning trick
>>
>> Anyone have the secret sauce?
>>
>> P.
>>
>>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Wed Oct  1 14:08:20 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 14:08:23 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>
	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>
	<48E25A00.4060700@refractions.net>
	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>
	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>
	<48E2C677.3090907@refractions.net>
	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>
Message-ID: <30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>

So, using a longer lived memory context I can get right to the end of
a query before the segfault arrives. The segfault happens when
deleting a geometryfactory at the end, which tells me a couple things,
I think.

First, those two std allocs that sneak in before we over-ride new are
related to the geometry factory. The segfault happens when we're
trying to pfree the geometryfactory.

The offending code is this in geos_c.cpp:

// NOTE: SRID will have to be changed after geometry creation
static const GeometryFactory *geomFactory =
	GeometryFactory::getDefaultInstance();

This global geomFactory is called a number of times by WKB readers and
some other functions.  I wonder if we can initialize it in initGEOS
and clean it up in finishGEOS?

It appears, that this is what used to happen? Here's the current code.

void
finishGEOS ()
{
	// Nothing to do
	//delete geomFactory;
}

Any help on the history behind this global?

P.
From mark.cave-ayland at ilande.co.uk  Wed Oct  1 14:15:00 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct  1 14:14:37 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
Message-ID: <1222884900.3410.10.camel@mca-desktop>


On Mon, 2008-09-29 at 13:42 -0700, Paul Ramsey wrote:
> All,
> 
> We are currently grappling with a pretty big issue in the PostGIS/GEOS
> integration, namely that PgSQL allocates it's memory inside pools
> (palloc/pfree), while GEOS allocates in general memory (malloc/free).
> This (a) imposes a requirement of memory management perfection on
> GEOS, otherwise the long-running postgres processes will leak and (b)
> can lead to insoluble problems in certain implementation patterns.
> 
> We have recently found one such problem pattern. When using
> preparedgeometry in postgis, we create a GEOS geometry and associated
> prepared geometry, these are duly malloc'ed, but we store references
> to them in a palloc'ed struct in a memory pool which lasts for the
> life of a postgres query.  All is good (well, there are memory leaks
> in the prepared stuff still, but those are theoretically fixable)
> until the end of the query, when postgres cleans up the query memory
> pool. All of a sudden the struct with the references to the geometry
> and prepared geometry are gone -- but the objects have not been freed.
> 
> Basically, the prepared geometry system will leak one geometry and one
> prepared geometry for every SQL statement run, and there's SFA we can
> do about it.
> 
> My immodest proposal is to use geosInit as a location where users can
> provide their own allocator/deallocators.  Right now, geosInit lets us
> set custom error handlers, so this extends the idea further.
> 
> In GEOS we would override new/delete in GEOS to our own functions that
> would check and see if the custom alloc/dealloc functions were set. If
> not, they would fall back to malloc/free, otherwise use what was
> provided.  For postgis, we would provide palloc/pfree in our geosInit
> calls.
> 
> In this way, we could hook GEOS into the PgSQL pool system at runtime,
> while still have it operate in the normal way when used with other
> applications. And other applications with their own memory systems
> could also more tightly integrate GEOS.
> 
> Thoughts?
> 
> P.

Well, in terms of providing a quick solution that works with PostgreSQL
then it can be seen as an improvement. But the fundamental issue is
still that GEOS still leaks memory, and nearly every other application
will still suffer the same consequences. Providing a hook so that other
applications can handle the context tracking and lack of memory lifetime
of a library which is known to leak is not really a suitable solution
IMO.

At the end of the day, for the solution to work 100% it still requires
someone to go through the code and specify the lifetime for each "new"
constructor in terms of a hierarchical memory system. I guess it depends
on how desperately do people want a new GEOS release? I'd argue that
there should be a new 3.0 branch release which has the containment fixes
real soon now, but if there is time for 3.1, it would be well worth
someone spending the time on this to nail the issue for once and for
all. In terms of effort required, it would be more repetitive than
technical.


ATB,

Mark.




From mbdavis at refractions.net  Wed Oct  1 14:22:27 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Wed Oct  1 14:16:12 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>	<48E25A00.4060700@refractions.net>	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>	<48E2C677.3090907@refractions.net>	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>
	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
Message-ID: <48E3BFE3.3010903@refractions.net>

Makes sense to me.  Basically this would take control of this 
initialization away from the compiler and place it in a function which 
is under user control.

And if the user forgot to call initGEOS they would get a nice segfault 
to remind them...

Paul Ramsey wrote:
> So, using a longer lived memory context I can get right to the end of
> a query before the segfault arrives. The segfault happens when
> deleting a geometryfactory at the end, which tells me a couple things,
> I think.
>
> First, those two std allocs that sneak in before we over-ride new are
> related to the geometry factory. The segfault happens when we're
> trying to pfree the geometryfactory.
>
> The offending code is this in geos_c.cpp:
>
> // NOTE: SRID will have to be changed after geometry creation
> static const GeometryFactory *geomFactory =
> 	GeometryFactory::getDefaultInstance();
>
> This global geomFactory is called a number of times by WKB readers and
> some other functions.  I wonder if we can initialize it in initGEOS
> and clean it up in finishGEOS?
>
> It appears, that this is what used to happen? Here's the current code.
>
> void
> finishGEOS ()
> {
> 	// Nothing to do
> 	//delete geomFactory;
> }
>
> Any help on the history behind this global?
>
> P.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From pramsey at cleverelephant.ca  Wed Oct  1 14:33:58 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 14:34:01 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <1222884900.3410.10.camel@mca-desktop>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<1222884900.3410.10.camel@mca-desktop>
Message-ID: <30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>

Mark, there's two issues at play here:

(1) - GEOS leaks, independently of the pgsql use of it, and yes, that
should be fixed
(2) - when you place a reference to a GEOS malloc'ed object in a
palloc'ed struct in pgsql, if the memorycontext where the struct
resides is cleaned up, you leak the GEOS object

It's (2) which seems to require a callback and hooks to do memory work
inside the pgsql pools. BTW, the XML support in PgSQL also uses
callbacks to do the memory allocation inside the pgsql pools, I have
found. However, as a core module, they get to create their own memory
context and have a piece of code right in core that cleans up their
context at the end of a transaction block.

If, alternately, the pgsql function manager provided a way to know
when fcinfo->flinfo->fn_mcxt was going to be freed, we could keep all
our GEOS objects in malloc'ed space and clean them up before the
context was freed.

So, I agree that (1) GEOS still needs work, I'm just not smart enough
to provide it, but I think the use of preparedgeometry is going to
require binding GEOS into the pgsql memory system in any event,
because of (2).

P.

On Wed, Oct 1, 2008 at 11:15 AM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:
>
> On Mon, 2008-09-29 at 13:42 -0700, Paul Ramsey wrote:
>> All,
>>
>> We are currently grappling with a pretty big issue in the PostGIS/GEOS
>> integration, namely that PgSQL allocates it's memory inside pools
>> (palloc/pfree), while GEOS allocates in general memory (malloc/free).
>> This (a) imposes a requirement of memory management perfection on
>> GEOS, otherwise the long-running postgres processes will leak and (b)
>> can lead to insoluble problems in certain implementation patterns.
>>
>> We have recently found one such problem pattern. When using
>> preparedgeometry in postgis, we create a GEOS geometry and associated
>> prepared geometry, these are duly malloc'ed, but we store references
>> to them in a palloc'ed struct in a memory pool which lasts for the
>> life of a postgres query.  All is good (well, there are memory leaks
>> in the prepared stuff still, but those are theoretically fixable)
>> until the end of the query, when postgres cleans up the query memory
>> pool. All of a sudden the struct with the references to the geometry
>> and prepared geometry are gone -- but the objects have not been freed.
>>
>> Basically, the prepared geometry system will leak one geometry and one
>> prepared geometry for every SQL statement run, and there's SFA we can
>> do about it.
>>
>> My immodest proposal is to use geosInit as a location where users can
>> provide their own allocator/deallocators.  Right now, geosInit lets us
>> set custom error handlers, so this extends the idea further.
>>
>> In GEOS we would override new/delete in GEOS to our own functions that
>> would check and see if the custom alloc/dealloc functions were set. If
>> not, they would fall back to malloc/free, otherwise use what was
>> provided.  For postgis, we would provide palloc/pfree in our geosInit
>> calls.
>>
>> In this way, we could hook GEOS into the PgSQL pool system at runtime,
>> while still have it operate in the normal way when used with other
>> applications. And other applications with their own memory systems
>> could also more tightly integrate GEOS.
>>
>> Thoughts?
>>
>> P.
>
> Well, in terms of providing a quick solution that works with PostgreSQL
> then it can be seen as an improvement. But the fundamental issue is
> still that GEOS still leaks memory, and nearly every other application
> will still suffer the same consequences. Providing a hook so that other
> applications can handle the context tracking and lack of memory lifetime
> of a library which is known to leak is not really a suitable solution
> IMO.
>
> At the end of the day, for the solution to work 100% it still requires
> someone to go through the code and specify the lifetime for each "new"
> constructor in terms of a hierarchical memory system. I guess it depends
> on how desperately do people want a new GEOS release? I'd argue that
> there should be a new 3.0 branch release which has the containment fixes
> real soon now, but if there is time for 3.1, it would be well worth
> someone spending the time on this to nail the issue for once and for
> all. In terms of effort required, it would be more repetitive than
> technical.
>
>
> ATB,
>
> Mark.
>
>
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Wed Oct  1 17:36:53 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 17:36:55 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>
	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>
	<48E25A00.4060700@refractions.net>
	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>
	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>
	<48E2C677.3090907@refractions.net>
	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>
	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
Message-ID: <30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>

So, moving the instantiation of geomFactory object into initGEOS did
nothing for me, the object is still allocated by malloc, not palloc,
perhaps because it's a global, so it's getting set up at library load
time?

Putting the whole factory and creation process inside the function
bodies could get very expensive, since the functions are called
repetitively a lot, which means each call would do a newfactory,
newgeo, destroygeom, destroyfactory (ack!).  This is presumably why
the factory was made into a global outside the functions.

I'm at an impasse. If new/delete are overridden, when the end of a
postgres comes along, the system will attempt to pfree the globals as
it cleans up the library, and since the globals are malloc'ed,
segfault ensues.

If we backtrack to not over-riding new/delete, then we have the
problem of leaking the prepared objects at the end of each
transaction.

P.

On Wed, Oct 1, 2008 at 11:08 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> So, using a longer lived memory context I can get right to the end of
> a query before the segfault arrives. The segfault happens when
> deleting a geometryfactory at the end, which tells me a couple things,
> I think.
>
> First, those two std allocs that sneak in before we over-ride new are
> related to the geometry factory. The segfault happens when we're
> trying to pfree the geometryfactory.
>
> The offending code is this in geos_c.cpp:
>
> // NOTE: SRID will have to be changed after geometry creation
> static const GeometryFactory *geomFactory =
>        GeometryFactory::getDefaultInstance();
>
> This global geomFactory is called a number of times by WKB readers and
> some other functions.  I wonder if we can initialize it in initGEOS
> and clean it up in finishGEOS?
>
> It appears, that this is what used to happen? Here's the current code.
>
> void
> finishGEOS ()
> {
>        // Nothing to do
>        //delete geomFactory;
> }
>
> Any help on the history behind this global?
>
> P.
>
From chodgson at refractions.net  Wed Oct  1 17:52:34 2008
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Oct  1 17:51:53 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>	<48E25A00.4060700@refractions.net>	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>	<48E2C677.3090907@refractions.net>	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
	<30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
Message-ID: <48E3F122.3070702@refractions.net>

If we're willing to accept a bit of a hack, you could just check in your 
overridden free() if the thing being free()'d was the global 
geomFactory, and if so, always use regular free().

This would have no effect on programs that aren't specifying their own 
memory functions (other than the additional instructions to execute on 
every call to free() ), and I think it would solve the problem as you've 
stated it.

Chris

Paul Ramsey wrote:
> So, moving the instantiation of geomFactory object into initGEOS did
> nothing for me, the object is still allocated by malloc, not palloc,
> perhaps because it's a global, so it's getting set up at library load
> time?
>
> Putting the whole factory and creation process inside the function
> bodies could get very expensive, since the functions are called
> repetitively a lot, which means each call would do a newfactory,
> newgeo, destroygeom, destroyfactory (ack!).  This is presumably why
> the factory was made into a global outside the functions.
>
> I'm at an impasse. If new/delete are overridden, when the end of a
> postgres comes along, the system will attempt to pfree the globals as
> it cleans up the library, and since the globals are malloc'ed,
> segfault ensues.
>
> If we backtrack to not over-riding new/delete, then we have the
> problem of leaking the prepared objects at the end of each
> transaction.
>
> P.
>
> On Wed, Oct 1, 2008 at 11:08 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>   
>> So, using a longer lived memory context I can get right to the end of
>> a query before the segfault arrives. The segfault happens when
>> deleting a geometryfactory at the end, which tells me a couple things,
>> I think.
>>
>> First, those two std allocs that sneak in before we over-ride new are
>> related to the geometry factory. The segfault happens when we're
>> trying to pfree the geometryfactory.
>>
>> The offending code is this in geos_c.cpp:
>>
>> // NOTE: SRID will have to be changed after geometry creation
>> static const GeometryFactory *geomFactory =
>>        GeometryFactory::getDefaultInstance();
>>
>> This global geomFactory is called a number of times by WKB readers and
>> some other functions.  I wonder if we can initialize it in initGEOS
>> and clean it up in finishGEOS?
>>
>> It appears, that this is what used to happen? Here's the current code.
>>
>> void
>> finishGEOS ()
>> {
>>        // Nothing to do
>>        //delete geomFactory;
>> }
>>
>> Any help on the history behind this global?
>>
>> P.
>>
>>     
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>   

From mbdavis at refractions.net  Wed Oct  1 17:59:23 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Wed Oct  1 17:53:07 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>	<48E25A00.4060700@refractions.net>	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>	<48E2C677.3090907@refractions.net>	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
	<30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
Message-ID: <48E3F2BB.7030707@refractions.net>

The geomFactory is static for the lifetime of GEOS, right?  So why is it 
freed at all between queries - shouldn't it live until the process 
containing GEOS ends (at which point the entire process image 
disappears, so it doesn't matter if it's never freed).

If the problem is that you are trying to delete this statically 
allocated object, then you need to find a way of *not* deleting that 
object.  Perhaps check the value of the pointer you are about to delete 
against this object and don't delete it if is the same?

Paul Ramsey wrote:
> So, moving the instantiation of geomFactory object into initGEOS did
> nothing for me, the object is still allocated by malloc, not palloc,
> perhaps because it's a global, so it's getting set up at library load
> time?
>
> Putting the whole factory and creation process inside the function
> bodies could get very expensive, since the functions are called
> repetitively a lot, which means each call would do a newfactory,
> newgeo, destroygeom, destroyfactory (ack!).  This is presumably why
> the factory was made into a global outside the functions.
>
> I'm at an impasse. If new/delete are overridden, when the end of a
> postgres comes along, the system will attempt to pfree the globals as
> it cleans up the library, and since the globals are malloc'ed,
> segfault ensues.
>
> If we backtrack to not over-riding new/delete, then we have the
> problem of leaking the prepared objects at the end of each
> transaction.
>
> P.
>
> On Wed, Oct 1, 2008 at 11:08 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>   
>> So, using a longer lived memory context I can get right to the end of
>> a query before the segfault arrives. The segfault happens when
>> deleting a geometryfactory at the end, which tells me a couple things,
>> I think.
>>
>> First, those two std allocs that sneak in before we over-ride new are
>> related to the geometry factory. The segfault happens when we're
>> trying to pfree the geometryfactory.
>>
>> The offending code is this in geos_c.cpp:
>>
>> // NOTE: SRID will have to be changed after geometry creation
>> static const GeometryFactory *geomFactory =
>>        GeometryFactory::getDefaultInstance();
>>
>> This global geomFactory is called a number of times by WKB readers and
>> some other functions.  I wonder if we can initialize it in initGEOS
>> and clean it up in finishGEOS?
>>
>> It appears, that this is what used to happen? Here's the current code.
>>
>> void
>> finishGEOS ()
>> {
>>        // Nothing to do
>>        //delete geomFactory;
>> }
>>
>> Any help on the history behind this global?
>>
>> P.
>>
>>     
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mbdavis at refractions.net  Wed Oct  1 18:00:06 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Wed Oct  1 17:53:51 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <48E3F122.3070702@refractions.net>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>	<48E25A00.4060700@refractions.net>	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>	<48E2C677.3090907@refractions.net>	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>	<30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
	<48E3F122.3070702@refractions.net>
Message-ID: <48E3F2E6.3010902@refractions.net>

So Chris is saying almost the same thing I am - except I don't think you 
ever have to free the static factory object.

Chris Hodgson wrote:
> If we're willing to accept a bit of a hack, you could just check in 
> your overridden free() if the thing being free()'d was the global 
> geomFactory, and if so, always use regular free().
>
> This would have no effect on programs that aren't specifying their own 
> memory functions (other than the additional instructions to execute on 
> every call to free() ), and I think it would solve the problem as 
> you've stated it.
>
> Chris
>
> Paul Ramsey wrote:
>> So, moving the instantiation of geomFactory object into initGEOS did
>> nothing for me, the object is still allocated by malloc, not palloc,
>> perhaps because it's a global, so it's getting set up at library load
>> time?
>>
>> Putting the whole factory and creation process inside the function
>> bodies could get very expensive, since the functions are called
>> repetitively a lot, which means each call would do a newfactory,
>> newgeo, destroygeom, destroyfactory (ack!).  This is presumably why
>> the factory was made into a global outside the functions.
>>
>> I'm at an impasse. If new/delete are overridden, when the end of a
>> postgres comes along, the system will attempt to pfree the globals as
>> it cleans up the library, and since the globals are malloc'ed,
>> segfault ensues.
>>
>> If we backtrack to not over-riding new/delete, then we have the
>> problem of leaking the prepared objects at the end of each
>> transaction.
>>
>> P.
>>
>> On Wed, Oct 1, 2008 at 11:08 AM, Paul Ramsey 
>> <pramsey@cleverelephant.ca> wrote:
>>  
>>> So, using a longer lived memory context I can get right to the end of
>>> a query before the segfault arrives. The segfault happens when
>>> deleting a geometryfactory at the end, which tells me a couple things,
>>> I think.
>>>
>>> First, those two std allocs that sneak in before we over-ride new are
>>> related to the geometry factory. The segfault happens when we're
>>> trying to pfree the geometryfactory.
>>>
>>> The offending code is this in geos_c.cpp:
>>>
>>> // NOTE: SRID will have to be changed after geometry creation
>>> static const GeometryFactory *geomFactory =
>>>        GeometryFactory::getDefaultInstance();
>>>
>>> This global geomFactory is called a number of times by WKB readers and
>>> some other functions.  I wonder if we can initialize it in initGEOS
>>> and clean it up in finishGEOS?
>>>
>>> It appears, that this is what used to happen? Here's the current code.
>>>
>>> void
>>> finishGEOS ()
>>> {
>>>        // Nothing to do
>>>        //delete geomFactory;
>>> }
>>>
>>> Any help on the history behind this global?
>>>
>>> P.
>>>
>>>     
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>   
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mark.cave-ayland at ilande.co.uk  Wed Oct  1 18:12:45 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct  1 18:12:29 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<1222884900.3410.10.camel@mca-desktop>
	<30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
Message-ID: <1222899165.3678.15.camel@mca-desktop>


On Wed, 2008-10-01 at 11:33 -0700, Paul Ramsey wrote:
> Mark, there's two issues at play here:
> 
> (1) - GEOS leaks, independently of the pgsql use of it, and yes, that
> should be fixed
> (2) - when you place a reference to a GEOS malloc'ed object in a
> palloc'ed struct in pgsql, if the memorycontext where the struct
> resides is cleaned up, you leak the GEOS object
> 
> It's (2) which seems to require a callback and hooks to do memory work
> inside the pgsql pools. BTW, the XML support in PgSQL also uses
> callbacks to do the memory allocation inside the pgsql pools, I have
> found. However, as a core module, they get to create their own memory
> context and have a piece of code right in core that cleans up their
> context at the end of a transaction block.
> 
> If, alternately, the pgsql function manager provided a way to know
> when fcinfo->flinfo->fn_mcxt was going to be freed, we could keep all
> our GEOS objects in malloc'ed space and clean them up before the
> context was freed.

Ah but we do this in PostGIS already - this is exactly how I implemented
caching for PROJ.4 objects :)

The way it works is to attach our own set of methods to a new child
memory context of the function context. Then when this is context is
destroyed at the end of the query/abort, we can go through the list and
free everything as required.

Now the trick would be to do this hierarchically: say for example you
have something like this in GEOS:

Geometry
   |
 CoordinateSequence
        |
      Coordinate

Thus each layer would store the list of malloc()d pointers for
everything in the immediate layer below it. This would then mean that we
would only need to track the topmost pointer within PostGIS since
deletion of this object would automatically cause a cascade deletion of
everything else.


ATB,

Mark.


From pramsey at cleverelephant.ca  Wed Oct  1 18:20:48 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 18:20:50 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <1222899165.3678.15.camel@mca-desktop>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<1222884900.3410.10.camel@mca-desktop>
	<30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
	<1222899165.3678.15.camel@mca-desktop>
Message-ID: <30fe546d0810011520k728f989doce15a5a3eb46399e@mail.gmail.com>

Well, there's a day and a half of my life down the drain... :/

P

On Wed, Oct 1, 2008 at 3:12 PM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:
>
> On Wed, 2008-10-01 at 11:33 -0700, Paul Ramsey wrote:
>> Mark, there's two issues at play here:
>>
>> (1) - GEOS leaks, independently of the pgsql use of it, and yes, that
>> should be fixed
>> (2) - when you place a reference to a GEOS malloc'ed object in a
>> palloc'ed struct in pgsql, if the memorycontext where the struct
>> resides is cleaned up, you leak the GEOS object
>>
>> It's (2) which seems to require a callback and hooks to do memory work
>> inside the pgsql pools. BTW, the XML support in PgSQL also uses
>> callbacks to do the memory allocation inside the pgsql pools, I have
>> found. However, as a core module, they get to create their own memory
>> context and have a piece of code right in core that cleans up their
>> context at the end of a transaction block.
>>
>> If, alternately, the pgsql function manager provided a way to know
>> when fcinfo->flinfo->fn_mcxt was going to be freed, we could keep all
>> our GEOS objects in malloc'ed space and clean them up before the
>> context was freed.
>
> Ah but we do this in PostGIS already - this is exactly how I implemented
> caching for PROJ.4 objects :)
>
> The way it works is to attach our own set of methods to a new child
> memory context of the function context. Then when this is context is
> destroyed at the end of the query/abort, we can go through the list and
> free everything as required.
>
> Now the trick would be to do this hierarchically: say for example you
> have something like this in GEOS:
>
> Geometry
>   |
>  CoordinateSequence
>        |
>      Coordinate
>
> Thus each layer would store the list of malloc()d pointers for
> everything in the immediate layer below it. This would then mean that we
> would only need to track the topmost pointer within PostGIS since
> deletion of this object would automatically cause a cascade deletion of
> everything else.
>
>
> ATB,
>
> Mark.
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From mark.cave-ayland at ilande.co.uk  Wed Oct  1 18:12:45 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct  1 18:21:03 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<1222884900.3410.10.camel@mca-desktop>
	<30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
Message-ID: <1222899165.3678.15.camel@mca-desktop>


On Wed, 2008-10-01 at 11:33 -0700, Paul Ramsey wrote:
> Mark, there's two issues at play here:
> 
> (1) - GEOS leaks, independently of the pgsql use of it, and yes, that
> should be fixed
> (2) - when you place a reference to a GEOS malloc'ed object in a
> palloc'ed struct in pgsql, if the memorycontext where the struct
> resides is cleaned up, you leak the GEOS object
> 
> It's (2) which seems to require a callback and hooks to do memory work
> inside the pgsql pools. BTW, the XML support in PgSQL also uses
> callbacks to do the memory allocation inside the pgsql pools, I have
> found. However, as a core module, they get to create their own memory
> context and have a piece of code right in core that cleans up their
> context at the end of a transaction block.
> 
> If, alternately, the pgsql function manager provided a way to know
> when fcinfo->flinfo->fn_mcxt was going to be freed, we could keep all
> our GEOS objects in malloc'ed space and clean them up before the
> context was freed.

Ah but we do this in PostGIS already - this is exactly how I implemented
caching for PROJ.4 objects :)

The way it works is to attach our own set of methods to a new child
memory context of the function context. Then when this is context is
destroyed at the end of the query/abort, we can go through the list and
free everything as required.

Now the trick would be to do this hierarchically: say for example you
have something like this in GEOS:

Geometry
   |
 CoordinateSequence
        |
      Coordinate

Thus each layer would store the list of malloc()d pointers for
everything in the immediate layer below it. This would then mean that we
would only need to track the topmost pointer within PostGIS since
deletion of this object would automatically cause a cascade deletion of
everything else.


ATB,

Mark.


From rindahl at lrcwe.com  Wed Oct  1 18:39:04 2008
From: rindahl at lrcwe.com (Bruce Rindahl)
Date: Wed Oct  1 18:58:32 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011520k728f989doce15a5a3eb46399e@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<1222884900.3410.10.camel@mca-desktop>	<30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>	<1222899165.3678.15.camel@mca-desktop>
	<30fe546d0810011520k728f989doce15a5a3eb46399e@mail.gmail.com>
Message-ID: <48E3FC08.3050406@lrcwe.com>

Paul Ramsey wrote:
> Well, there's a day and a half of my life down the drain... :/
>
> P
>   
Sounds like a memory leak coming up...
From pramsey at cleverelephant.ca  Wed Oct  1 18:58:38 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct  1 18:58:41 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <1222899165.3678.15.camel@mca-desktop>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>
	<1222884900.3410.10.camel@mca-desktop>
	<30fe546d0810011133k3009bd26g32f22be73f494e8c@mail.gmail.com>
	<1222899165.3678.15.camel@mca-desktop>
Message-ID: <30fe546d0810011558x3f529843t23ed73ae6886aaa2@mail.gmail.com>

OK, I understand this diabolical scheme.
Now we just need GEOS to not leak.
Easy peasy :/

P.

On Wed, Oct 1, 2008 at 3:12 PM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:

> Ah but we do this in PostGIS already - this is exactly how I implemented
> caching for PROJ.4 objects :)
>
> The way it works is to attach our own set of methods to a new child
> memory context of the function context. Then when this is context is
> destroyed at the end of the query/abort, we can go through the list and
> free everything as required.
>
> Now the trick would be to do this hierarchically: say for example you
> have something like this in GEOS:
>
> Geometry
>   |
>  CoordinateSequence
>        |
>      Coordinate
>
> Thus each layer would store the list of malloc()d pointers for
> everything in the immediate layer below it. This would then mean that we
> would only need to track the topmost pointer within PostGIS since
> deletion of this object would automatically cause a cascade deletion of
> everything else.
>
>
> ATB,
>
> Mark.
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From woodbri at swoodbridge.com  Wed Oct  1 22:46:44 2008
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Wed Oct  1 21:46:01 2008
Subject: [geos-devel] An Immodest Proposal
In-Reply-To: <30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
References: <30fe546d0809291342o1d69add8m4ce9e2ef1d861234@mail.gmail.com>	<8B319E5A30FF4A48BE7EEAAF609DB233021F3444@COMAIL01.digitalglobe.com>	<30fe546d0809292105j11daf52x7f3ce4350f0b3aef@mail.gmail.com>	<48E25A00.4060700@refractions.net>	<30fe546d0809301036n37501c32m6149a3c8bb984b39@mail.gmail.com>	<30fe546d0809301647s2bb454feh24cd0162cbb073f8@mail.gmail.com>	<48E2C677.3090907@refractions.net>	<30fe546d0810011034h591eb28ne64b1f0f1cbd6792@mail.gmail.com>	<30fe546d0810011108i70b0e88ci18c2a2bbc05b0604@mail.gmail.com>
	<30fe546d0810011436h62921a59q3638ab9852e66b02@mail.gmail.com>
Message-ID: <48E43614.4020306@swoodbridge.com>

Paul,

As part of the GEOS cleanup, why don't you restore the default 
malloc/free so after you have cleaned up everything, the system can then 
free() on the factory stuff instead of pfree() them.

-Steve W

Paul Ramsey wrote:
> So, moving the instantiation of geomFactory object into initGEOS did
> nothing for me, the object is still allocated by malloc, not palloc,
> perhaps because it's a global, so it's getting set up at library load
> time?
> 
> Putting the whole factory and creation process inside the function
> bodies could get very expensive, since the functions are called
> repetitively a lot, which means each call would do a newfactory,
> newgeo, destroygeom, destroyfactory (ack!).  This is presumably why
> the factory was made into a global outside the functions.
> 
> I'm at an impasse. If new/delete are overridden, when the end of a
> postgres comes along, the system will attempt to pfree the globals as
> it cleans up the library, and since the globals are malloc'ed,
> segfault ensues.
> 
> If we backtrack to not over-riding new/delete, then we have the
> problem of leaking the prepared objects at the end of each
> transaction.
> 
> P.
> 
> On Wed, Oct 1, 2008 at 11:08 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>> So, using a longer lived memory context I can get right to the end of
>> a query before the segfault arrives. The segfault happens when
>> deleting a geometryfactory at the end, which tells me a couple things,
>> I think.
>>
>> First, those two std allocs that sneak in before we over-ride new are
>> related to the geometry factory. The segfault happens when we're
>> trying to pfree the geometryfactory.
>>
>> The offending code is this in geos_c.cpp:
>>
>> // NOTE: SRID will have to be changed after geometry creation
>> static const GeometryFactory *geomFactory =
>>        GeometryFactory::getDefaultInstance();
>>
>> This global geomFactory is called a number of times by WKB readers and
>> some other functions.  I wonder if we can initialize it in initGEOS
>> and clean it up in finishGEOS?
>>
>> It appears, that this is what used to happen? Here's the current code.
>>
>> void
>> finishGEOS ()
>> {
>>        // Nothing to do
>>        //delete geomFactory;
>> }
>>
>> Any help on the history behind this global?
>>
>> P.
>>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From pramsey at cleverelephant.ca  Fri Oct  3 11:41:59 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct  3 11:42:02 2008
Subject: [geos-devel] C++ Expert Wanted (GEOS)
Message-ID: <30fe546d0810030841t786f1b4y68d30cecf8577f0a@mail.gmail.com>

I have a client who desperately wants to clean some memory leaks out
of GEOS in a relatively short time frame. If you have enough C++ chops
to wrestle with the GEOS code base (warning, non-trivial and not
exactly a french garden) and some time over the next few weeks, let me
know.

Paul
From geos-trac at osgeo.org  Sat Oct  4 14:15:01 2008
From: geos-trac at osgeo.org (GEOS)
Date: Sat Oct  4 14:15:03 2008
Subject: [geos-devel] Re: [GEOS] #208: Provide alternate malloc/free at run
	time
In-Reply-To: <047.c88fe52778b574f126d52dfe32c2c9cb@osgeo.org>
References: <047.c88fe52778b574f126d52dfe32c2c9cb@osgeo.org>
Message-ID: <056.b0edac9c3a658ce2d7687bebf9cf3080@osgeo.org>

#208: Provide alternate malloc/free at run time
-------------------------+--------------------------------------------------
 Reporter:  pramsey      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  closed                    
 Priority:  major        |    Milestone:  3.1                       
Component:  Default      |      Version:  svn-trunk                 
 Severity:  Unassigned   |   Resolution:  wontfix                   
 Keywords:               |  
-------------------------+--------------------------------------------------
Changes (by pramsey):

  * status:  new => closed
  * resolution:  => wontfix

Comment:

 Using a PostgreSQL trick from Mark Cave-Ayland, this is no longer a
 critical issue for PostGIS, so this idea is being shelved until someone
 else has an existential need for it.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/208#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From pramsey at cleverelephant.ca  Mon Oct  6 13:17:42 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon Oct  6 13:17:45 2008
Subject: [geos-devel] Re: [postgis-devel] Shhhh....
In-Reply-To: <1223208141.2739.125.camel@laptop.gunduz.org>
References: <30fe546d0810041914n34b30d77q7a0f64ac73d63cbb@mail.gmail.com>
	<1223208141.2739.125.camel@laptop.gunduz.org>
Message-ID: <30fe546d0810061017n4807f49bnad95817cee021d71@mail.gmail.com>

I'd like to do 3.0.1. Objections?

P.

On Sun, Oct 5, 2008 at 5:02 AM, Devrim G?ND?Z <devrim@gunduz.org> wrote:
> On Sat, 2008-10-04 at 19:14 -0700, Paul Ramsey wrote:
>
>> postgis-trunk + geos-trunk = working, non-leaky prepared geometries
>
> This reminded me something: Are there any plans for Geos 3.0.1 very
> soon? AFAICS from svn logs, there are many many important fixes since
> 3.0.0 was released.
>
> Regards,
> --
> Devrim G?ND?Z, RHCE
> devrim~gunduz.org, devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
>                   http://www.gunduz.org
>
> _______________________________________________
> postgis-devel mailing list
> postgis-devel@postgis.refractions.net
> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>
>
From hobu.inc at gmail.com  Mon Oct  6 14:18:49 2008
From: hobu.inc at gmail.com (Howard Butler)
Date: Mon Oct  6 14:19:58 2008
Subject: [geos-devel] Re: [postgis-devel] Shhhh....
In-Reply-To: <30fe546d0810061017n4807f49bnad95817cee021d71@mail.gmail.com>
References: <30fe546d0810041914n34b30d77q7a0f64ac73d63cbb@mail.gmail.com>
	<1223208141.2739.125.camel@laptop.gunduz.org>
	<30fe546d0810061017n4807f49bnad95817cee021d71@mail.gmail.com>
Message-ID: <73712F38-FF28-4B0F-933D-642B26F113FB@gmail.com>

The 3.0 branch of GEOS does not have anything in it about prepared  
geometries. http://trac.osgeo.org/geos/log/branches/3.0

Did you mean to say release a 3.1 version of GEOS with non-leaky  
prepared geometries?

I don't think we should do minor releases with major features in them.

Howard

On Oct 6, 2008, at 12:17 PM, Paul Ramsey wrote:

> I'd like to do 3.0.1. Objections?
>
> P.
>
> On Sun, Oct 5, 2008 at 5:02 AM, Devrim G?ND?Z <devrim@gunduz.org>  
> wrote:
>> On Sat, 2008-10-04 at 19:14 -0700, Paul Ramsey wrote:
>>
>>> postgis-trunk + geos-trunk = working, non-leaky prepared geometries
>>
>> This reminded me something: Are there any plans for Geos 3.0.1 very
>> soon? AFAICS from svn logs, there are many many important fixes since
>> 3.0.0 was released.
>>
>> Regards,
>> --
>> Devrim G?ND?Z, RHCE
>> devrim~gunduz.org, devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
>>                  http://www.gunduz.org
>>
>> _______________________________________________
>> postgis-devel mailing list
>> postgis-devel@postgis.refractions.net
>> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>>
>>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From pramsey at cleverelephant.ca  Mon Oct  6 14:28:14 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon Oct  6 14:28:16 2008
Subject: [geos-devel] Re: [postgis-devel] Shhhh....
In-Reply-To: <73712F38-FF28-4B0F-933D-642B26F113FB@gmail.com>
References: <30fe546d0810041914n34b30d77q7a0f64ac73d63cbb@mail.gmail.com>
	<1223208141.2739.125.camel@laptop.gunduz.org>
	<30fe546d0810061017n4807f49bnad95817cee021d71@mail.gmail.com>
	<73712F38-FF28-4B0F-933D-642B26F113FB@gmail.com>
Message-ID: <30fe546d0810061128q7f692518jd32a9dd4874de532@mail.gmail.com>

No, I mean to say a 3.0.1 release, without prepared geometries.

A 3.1.0 release would seem to be a number of testing and bug closing
iterations aways.

P.

On Mon, Oct 6, 2008 at 11:18 AM, Howard Butler <hobu.inc@gmail.com> wrote:
> The 3.0 branch of GEOS does not have anything in it about prepared
> geometries. http://trac.osgeo.org/geos/log/branches/3.0
>
> Did you mean to say release a 3.1 version of GEOS with non-leaky prepared
> geometries?
>
> I don't think we should do minor releases with major features in them.
>
> Howard
>
> On Oct 6, 2008, at 12:17 PM, Paul Ramsey wrote:
>
>> I'd like to do 3.0.1. Objections?
>>
>> P.
>>
>> On Sun, Oct 5, 2008 at 5:02 AM, Devrim G?ND?Z <devrim@gunduz.org> wrote:
>>>
>>> On Sat, 2008-10-04 at 19:14 -0700, Paul Ramsey wrote:
>>>
>>>> postgis-trunk + geos-trunk = working, non-leaky prepared geometries
>>>
>>> This reminded me something: Are there any plans for Geos 3.0.1 very
>>> soon? AFAICS from svn logs, there are many many important fixes since
>>> 3.0.0 was released.
>>>
>>> Regards,
>>> --
>>> Devrim G?ND?Z, RHCE
>>> devrim~gunduz.org, devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
>>>                 http://www.gunduz.org
>>>
>>> _______________________________________________
>>> postgis-devel mailing list
>>> postgis-devel@postgis.refractions.net
>>> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>>>
>>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Mon Oct  6 15:41:57 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon Oct  6 15:42:02 2008
Subject: [geos-devel] 3.0.1
Message-ID: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>

There's actually been surprisingly little activity on the 3.0 branch:

2008-08-29 15:00  sgillies

        * source/headers/geos/io/CLocalizer.h, source/io/CLocalizer.cpp,
          source/io/WKTWriter.cpp: Added CLocalizer class that switches to
          C locale and restores to the outer context's locale when deleted
          (#201)

2008-08-29 14:57  sgillies

        * capi/geos_c.cpp, source/headers/geos/io.h, source/io/Makefile.am,
          source/io/WKTWriter.cpp: Added CLocalizer class that switches to
          C locale and restores to the outer context's locale when deleted
          (#201)

2008-07-19 18:45  warmerdam

        * source/Makefile.vc: incorporate manifest into dlls (#193)

2008-07-19 18:20  warmerdam

        * source/Makefile.vc, source/headers/geos/version.h.vc: add
          automatic copying of version.h for svn builds

2008-04-21 23:22  pramsey

        * source/geom/Geometry.cpp: Fix for rectangle optimization logic.

2008-02-06 21:23  warmerdam

        * Makefile.am, source/Makefile.am, source/Makefile.vc: Add missing
          files into distribution, remove unused source files from win32
          make (#175)

2008-01-02 23:31  sgillies

        * swig/Makefile.am: Conditionally add swig/python,ruby to SUBDIRS


On Mon, Oct 6, 2008 at 11:28 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> No, I mean to say a 3.0.1 release, without prepared geometries.
>
From yannick.lafont at emc3.fr  Tue Oct  7 06:18:51 2008
From: yannick.lafont at emc3.fr (Yannick Lafont)
Date: Tue Oct  7 06:34:52 2008
Subject: [geos-devel] build error
Message-ID: <48EB378B.5090802@emc3.fr>

Hello,

I'd like to compile geos but I have some errors. I build it with gcc 
2.96. I can read in INSTALL file, the gcc 2.96 is know to work !
I suppose there is a conflict : #include<algorithm> and the directories 
algorithm.
How to solve this error ?

Thank you.

bash-2.05$ make
Making all in source
make[1]: Entre dans le r?pertoire `/home/postgres/geos-3.0.0/source'
Making all in algorithm
make[2]: Entre dans le r?pertoire 
`/home/postgres/geos-3.0.0/source/algorithm'
if /bin/sh ../../libtool --tag=CXX --mode=compile g++ -DHAVE_CONFIG_H 
-I. -I. -I../../source/headers -I../../source/headers/geos 
-I../../source/headers   -I/usr/local/include  -g -O2 -DGEOS_INLINE 
-Wall -ansi -pedantic -Wno-long-long -MT CGAlgorithms.lo -MD -MP -MF 
".deps/CGAlgorithms.Tpo" -c -o CGAlgorithms.lo CGAlgorithms.cpp; \
then mv -f ".deps/CGAlgorithms.Tpo" ".deps/CGAlgorithms.Plo"; else rm -f 
".deps/CGAlgorithms.Tpo"; exit 1; fi
mkdir .libs
 g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers 
-I../../source/headers/geos -I../../source/headers -I/usr/local/include 
-g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT 
CGAlgorithms.lo -MD -MP -MF .deps/CGAlgorithms.Tpo -c CGAlgorithms.cpp  
-fPIC -DPIC -o .libs/CGAlgorithms.o
CGAlgorithms.cpp:27:21: ../../source/headers/geos/algorithm is a directory
make[2]: *** [CGAlgorithms.lo] Erreur 1
make[2]: Quitte le r?pertoire `/home/postgres/geos-3.0.0/source/algorithm'
make[1]: *** [all-recursive] Erreur 1
make[1]: Quitte le r?pertoire `/home/postgres/geos-3.0.0/source'
make: *** [all-recursive] Erreur 1

From pramsey at cleverelephant.ca  Thu Oct  9 12:38:23 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct  9 12:38:27 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <48ee0d3d.271d640a.40b3.717d@mx.google.com>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>
	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>
	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>
	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>
	<48ee0d3d.271d640a.40b3.717d@mx.google.com>
Message-ID: <30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>

Another quarter heard from. I have applied this "ugly" patch
nonetheless, since it removes my leak in PostGIS.

P


---------- Forwarded message ----------
From: Hartmut Kaiser <hartmut.kaiser@gmail.com>
Date: Thu, Oct 9, 2008 at 6:55 AM
Subject: RE: Prepared Geometry
To: Paul Ramsey <pramsey@cleverelephant.ca>


Paul,

> Could you try big against small1 and small2?

Patch attached. But frankly, I don't like the solution (even if it adopted
the way it's currently handled all over the place in GEOS).

The way the SegmentString class is written and used requires the user of the
an instance of SegmentString to take care of the deletion of the embedded
point array, for instance:

   for ( size_t i = 0, ni = lineSegStr.size(); i < ni; i++ )
   {
       delete lineSegStr[ i ]->getCoordinates();    // <-- here
       delete lineSegStr[ i ];
   }

Which is just wrong, because this could be done in a better way if
SegmentString was taking care of this in the destructor. I tried to fix GEOS
(and the tests) in this direction, but apparently the buffers stored in the
SegmentString are shared in between different higher level structures in
addition, which makes it impossible (at least currently for me) to fix that
without introducing some kind of smart pointers (or investing a really large
amount of time, which I don't have) ...

For this reason I fixed this memory leak the straightforward (and ugly) way.
I'm sure there are more similar bugs to recover, though :-P

Regards Hartmut

PS: As impressive GEOS is it convinces me once more that it's not a good
idea to write C++ in a way similar to Java, especially if no special means
of memory management (i.e. smart ptrs) are introduced.


>
> Thanks!
>
> Paul
>
> On Wed, Oct 8, 2008 at 1:54 PM, Hartmut Kaiser
> <hartmut.kaiser@gmail.com> wrote:
> > Paul,
> >
> >> The reason I ask is because while contains and covers appear leak
> >> free, intersects seems to be leaking. I'm pretty sure it's not on
> the
> >> PostGIS side (I think).
> >>
> >> P.
> >>
> >> On Wed, Oct 8, 2008 at 12:25 PM, Paul Ramsey
> >> <pramsey@cleverelephant.ca> wrote:
> >> > Hartmut,
> >> >
> >> > When you tested for leaks, did you test prepared contains,
> >> intersects,
> >> > covers, coversproperly? Or just one of them?
> >
> > I was using the test program as attached to the ticket (which AFAIR
> > calls all of the topological attribute functions). This test program
> > was leak free for me. But I tried the geometries as attached to the
> > ticket only either, so your leaks might show themselves with certain
> geometries only.
> >
> > Regards Hartmut
> >
> >
> >
> >
-------------- next part --------------
A non-text attachment was scrubbed...
Name: memleak2.patch
Type: application/octet-stream
Size: 678 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081009/92920944/memleak2.obj
From mbdavis at refractions.net  Thu Oct  9 13:35:13 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Thu Oct  9 13:28:19 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>	<48ee0d3d.271d640a.40b3.717d@mx.google.com>
	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>
Message-ID: <48EE40D1.5000606@refractions.net>

I have to disagree with Hartmut's complaint.  The SegmentString class is 
intended to be an adapter class, which wraps a data structure 
(Coordinate sequence) owned by some client to allow it to be processed 
by the noding logic.  Under this pattern, the SegmentString class 
definitely should  *not* be freeing the memory for the wrapped sequence 
- that is the responsibility of the client.

I can't comment on "writing C++ like Java", but obviously C++ requires 
more knowledge of the usage patterns of memory resources than Java 
does.  That's why Java is easier to write  8^)

Paul Ramsey wrote:
> Another quarter heard from. I have applied this "ugly" patch
> nonetheless, since it removes my leak in PostGIS.
>
> P
>
>
> ---------- Forwarded message ----------
> From: Hartmut Kaiser <hartmut.kaiser@gmail.com>
> Date: Thu, Oct 9, 2008 at 6:55 AM
> Subject: RE: Prepared Geometry
> To: Paul Ramsey <pramsey@cleverelephant.ca>
>
>
> Paul,
>
>   
>> Could you try big against small1 and small2?
>>     
>
> Patch attached. But frankly, I don't like the solution (even if it adopted
> the way it's currently handled all over the place in GEOS).
>
> The way the SegmentString class is written and used requires the user of the
> an instance of SegmentString to take care of the deletion of the embedded
> point array, for instance:
>
>    for ( size_t i = 0, ni = lineSegStr.size(); i < ni; i++ )
>    {
>        delete lineSegStr[ i ]->getCoordinates();    // <-- here
>        delete lineSegStr[ i ];
>    }
>
> Which is just wrong, because this could be done in a better way if
> SegmentString was taking care of this in the destructor. I tried to fix GEOS
> (and the tests) in this direction, but apparently the buffers stored in the
> SegmentString are shared in between different higher level structures in
> addition, which makes it impossible (at least currently for me) to fix that
> without introducing some kind of smart pointers (or investing a really large
> amount of time, which I don't have) ...
>
> For this reason I fixed this memory leak the straightforward (and ugly) way.
> I'm sure there are more similar bugs to recover, though :-P
>
> Regards Hartmut
>
> PS: As impressive GEOS is it convinces me once more that it's not a good
> idea to write C++ in a way similar to Java, especially if no special means
> of memory management (i.e. smart ptrs) are introduced.
>
>
>   
>> Thanks!
>>
>> Paul
>>
>> On Wed, Oct 8, 2008 at 1:54 PM, Hartmut Kaiser
>> <hartmut.kaiser@gmail.com> wrote:
>>     
>>> Paul,
>>>
>>>       
>>>> The reason I ask is because while contains and covers appear leak
>>>> free, intersects seems to be leaking. I'm pretty sure it's not on
>>>>         
>> the
>>     
>>>> PostGIS side (I think).
>>>>
>>>> P.
>>>>
>>>> On Wed, Oct 8, 2008 at 12:25 PM, Paul Ramsey
>>>> <pramsey@cleverelephant.ca> wrote:
>>>>         
>>>>> Hartmut,
>>>>>
>>>>> When you tested for leaks, did you test prepared contains,
>>>>>           
>>>> intersects,
>>>>         
>>>>> covers, coversproperly? Or just one of them?
>>>>>           
>>> I was using the test program as attached to the ticket (which AFAIR
>>> calls all of the topological attribute functions). This test program
>>> was leak free for me. But I tried the geometries as attached to the
>>> ticket only either, so your leaks might show themselves with certain
>>>       
>> geometries only.
>>     
>>> Regards Hartmut
>>>
>>>
>>>
>>>
>>>       
>>> ------------------------------------------------------------------------
>>>
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From hartmut.kaiser at gmail.com  Thu Oct  9 16:48:08 2008
From: hartmut.kaiser at gmail.com (Hartmut Kaiser)
Date: Thu Oct  9 16:48:16 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <48EE40D1.5000606@refractions.net>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>	<48ee0d3d.271d640a.40b3.717d@mx.google.com>	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>
	<48EE40D1.5000606@refractions.net>
Message-ID: <48ee6e0e.1335640a.790b.7444@mx.google.com>

Martin, 

> I have to disagree with Hartmut's complaint.  The SegmentString class
> is
> intended to be an adapter class, which wraps a data structure
> (Coordinate sequence) owned by some client to allow it to be processed
> by the noding logic.  Under this pattern, the SegmentString class
> definitely should  *not* be freeing the memory for the wrapped sequence
> - that is the responsibility of the client.

Well, that's a decision of the people around the GEOS project, not mine. I
just fixed some nasty memleaks which wouldn't have been there if some more
coherent memory (and encapsulation) strategy had been used. I'm sure there
was a reason for that. But please don't jump on me, I'm only saying that I
would have done it differently.

> I can't comment on "writing C++ like Java", but obviously C++ requires
> more knowledge of the usage patterns of memory resources than Java
> does.  That's why Java is easier to write  8^)

Come on, this is your personal opinion. And please, there is no need to
start a religious war here. 
I was intentionally very cautious while writing my remark in the first
place.

Regards Hartmut

> 
> Paul Ramsey wrote:
> > Another quarter heard from. I have applied this "ugly" patch
> > nonetheless, since it removes my leak in PostGIS.
> >
> > P
> >
> >
> > ---------- Forwarded message ----------
> > From: Hartmut Kaiser <hartmut.kaiser@gmail.com>
> > Date: Thu, Oct 9, 2008 at 6:55 AM
> > Subject: RE: Prepared Geometry
> > To: Paul Ramsey <pramsey@cleverelephant.ca>
> >
> >
> > Paul,
> >
> >
> >> Could you try big against small1 and small2?
> >>
> >
> > Patch attached. But frankly, I don't like the solution (even if it
> adopted
> > the way it's currently handled all over the place in GEOS).
> >
> > The way the SegmentString class is written and used requires the user
> of the
> > an instance of SegmentString to take care of the deletion of the
> embedded
> > point array, for instance:
> >
> >    for ( size_t i = 0, ni = lineSegStr.size(); i < ni; i++ )
> >    {
> >        delete lineSegStr[ i ]->getCoordinates();    // <-- here
> >        delete lineSegStr[ i ];
> >    }
> >
> > Which is just wrong, because this could be done in a better way if
> > SegmentString was taking care of this in the destructor. I tried to
> fix GEOS
> > (and the tests) in this direction, but apparently the buffers stored
> in the
> > SegmentString are shared in between different higher level structures
> in
> > addition, which makes it impossible (at least currently for me) to
> fix that
> > without introducing some kind of smart pointers (or investing a
> really large
> > amount of time, which I don't have) ...
> >
> > For this reason I fixed this memory leak the straightforward (and
> ugly) way.
> > I'm sure there are more similar bugs to recover, though :-P
> >
> > Regards Hartmut
> >
> > PS: As impressive GEOS is it convinces me once more that it's not a
> good
> > idea to write C++ in a way similar to Java, especially if no special
> means
> > of memory management (i.e. smart ptrs) are introduced.
> >
> >
> >
> >> Thanks!
> >>
> >> Paul
> >>
> >> On Wed, Oct 8, 2008 at 1:54 PM, Hartmut Kaiser
> >> <hartmut.kaiser@gmail.com> wrote:
> >>
> >>> Paul,
> >>>
> >>>
> >>>> The reason I ask is because while contains and covers appear leak
> >>>> free, intersects seems to be leaking. I'm pretty sure it's not on
> >>>>
> >> the
> >>
> >>>> PostGIS side (I think).
> >>>>
> >>>> P.
> >>>>
> >>>> On Wed, Oct 8, 2008 at 12:25 PM, Paul Ramsey
> >>>> <pramsey@cleverelephant.ca> wrote:
> >>>>
> >>>>> Hartmut,
> >>>>>
> >>>>> When you tested for leaks, did you test prepared contains,
> >>>>>
> >>>> intersects,
> >>>>
> >>>>> covers, coversproperly? Or just one of them?
> >>>>>
> >>> I was using the test program as attached to the ticket (which AFAIR
> >>> calls all of the topological attribute functions). This test
> program
> >>> was leak free for me. But I tried the geometries as attached to the
> >>> ticket only either, so your leaks might show themselves with
> certain
> >>>
> >> geometries only.
> >>
> >>> Regards Hartmut
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> -------------------------------------------------------------------
> -----
> >>>
> >>> _______________________________________________
> >>> geos-devel mailing list
> >>> geos-devel@lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 
> --
> Martin Davis
> Senior Technical Architect
> Refractions Research, Inc.
> (250) 383-3022
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From pramsey at cleverelephant.ca  Thu Oct  9 16:52:59 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct  9 16:53:01 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <48ee6e0e.1335640a.790b.7444@mx.google.com>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>
	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>
	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>
	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>
	<48ee0d3d.271d640a.40b3.717d@mx.google.com>
	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>
	<48EE40D1.5000606@refractions.net>
	<48ee6e0e.1335640a.790b.7444@mx.google.com>
Message-ID: <30fe546d0810091352i31397141wadcfb953fd14fa49@mail.gmail.com>

Hartmut,

Just FYI, in case you didn't know, GEOS comes by it's Java'ish
anti-pattern "honestly",

http://lin-ear-th-inking.blogspot.com/2007/06/history-of-jts-and-geos.html

Thanks again for the patch. Compared to the postgis code calling it,
it's a thing of beauty :)

P.

On Thu, Oct 9, 2008 at 1:48 PM, Hartmut Kaiser <hartmut.kaiser@gmail.com> wrote:
> Martin,
>
>> I have to disagree with Hartmut's complaint.  The SegmentString class
>> is
>> intended to be an adapter class, which wraps a data structure
>> (Coordinate sequence) owned by some client to allow it to be processed
>> by the noding logic.  Under this pattern, the SegmentString class
>> definitely should  *not* be freeing the memory for the wrapped sequence
>> - that is the responsibility of the client.
>
> Well, that's a decision of the people around the GEOS project, not mine. I
> just fixed some nasty memleaks which wouldn't have been there if some more
> coherent memory (and encapsulation) strategy had been used. I'm sure there
> was a reason for that. But please don't jump on me, I'm only saying that I
> would have done it differently.
>
>> I can't comment on "writing C++ like Java", but obviously C++ requires
>> more knowledge of the usage patterns of memory resources than Java
>> does.  That's why Java is easier to write  8^)
>
> Come on, this is your personal opinion. And please, there is no need to
> start a religious war here.
> I was intentionally very cautious while writing my remark in the first
> place.
>
> Regards Hartmut
>
>>
>> Paul Ramsey wrote:
>> > Another quarter heard from. I have applied this "ugly" patch
>> > nonetheless, since it removes my leak in PostGIS.
>> >
>> > P
>> >
>> >
>> > ---------- Forwarded message ----------
>> > From: Hartmut Kaiser <hartmut.kaiser@gmail.com>
>> > Date: Thu, Oct 9, 2008 at 6:55 AM
>> > Subject: RE: Prepared Geometry
>> > To: Paul Ramsey <pramsey@cleverelephant.ca>
>> >
>> >
>> > Paul,
>> >
>> >
>> >> Could you try big against small1 and small2?
>> >>
>> >
>> > Patch attached. But frankly, I don't like the solution (even if it
>> adopted
>> > the way it's currently handled all over the place in GEOS).
>> >
>> > The way the SegmentString class is written and used requires the user
>> of the
>> > an instance of SegmentString to take care of the deletion of the
>> embedded
>> > point array, for instance:
>> >
>> >    for ( size_t i = 0, ni = lineSegStr.size(); i < ni; i++ )
>> >    {
>> >        delete lineSegStr[ i ]->getCoordinates();    // <-- here
>> >        delete lineSegStr[ i ];
>> >    }
>> >
>> > Which is just wrong, because this could be done in a better way if
>> > SegmentString was taking care of this in the destructor. I tried to
>> fix GEOS
>> > (and the tests) in this direction, but apparently the buffers stored
>> in the
>> > SegmentString are shared in between different higher level structures
>> in
>> > addition, which makes it impossible (at least currently for me) to
>> fix that
>> > without introducing some kind of smart pointers (or investing a
>> really large
>> > amount of time, which I don't have) ...
>> >
>> > For this reason I fixed this memory leak the straightforward (and
>> ugly) way.
>> > I'm sure there are more similar bugs to recover, though :-P
>> >
>> > Regards Hartmut
>> >
>> > PS: As impressive GEOS is it convinces me once more that it's not a
>> good
>> > idea to write C++ in a way similar to Java, especially if no special
>> means
>> > of memory management (i.e. smart ptrs) are introduced.
>> >
>> >
>> >
>> >> Thanks!
>> >>
>> >> Paul
>> >>
>> >> On Wed, Oct 8, 2008 at 1:54 PM, Hartmut Kaiser
>> >> <hartmut.kaiser@gmail.com> wrote:
>> >>
>> >>> Paul,
>> >>>
>> >>>
>> >>>> The reason I ask is because while contains and covers appear leak
>> >>>> free, intersects seems to be leaking. I'm pretty sure it's not on
>> >>>>
>> >> the
>> >>
>> >>>> PostGIS side (I think).
>> >>>>
>> >>>> P.
>> >>>>
>> >>>> On Wed, Oct 8, 2008 at 12:25 PM, Paul Ramsey
>> >>>> <pramsey@cleverelephant.ca> wrote:
>> >>>>
>> >>>>> Hartmut,
>> >>>>>
>> >>>>> When you tested for leaks, did you test prepared contains,
>> >>>>>
>> >>>> intersects,
>> >>>>
>> >>>>> covers, coversproperly? Or just one of them?
>> >>>>>
>> >>> I was using the test program as attached to the ticket (which AFAIR
>> >>> calls all of the topological attribute functions). This test
>> program
>> >>> was leak free for me. But I tried the geometries as attached to the
>> >>> ticket only either, so your leaks might show themselves with
>> certain
>> >>>
>> >> geometries only.
>> >>
>> >>> Regards Hartmut
>> >>>
>> >>>
>> >>>
>> >>>
>> >>>
>> >>> -------------------------------------------------------------------
>> -----
>> >>>
>> >>> _______________________________________________
>> >>> geos-devel mailing list
>> >>> geos-devel@lists.osgeo.org
>> >>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> --
>> Martin Davis
>> Senior Technical Architect
>> Refractions Research, Inc.
>> (250) 383-3022
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From hartmut.kaiser at gmail.com  Thu Oct  9 17:25:42 2008
From: hartmut.kaiser at gmail.com (Hartmut Kaiser)
Date: Thu Oct  9 17:25:53 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <30fe546d0810091352i31397141wadcfb953fd14fa49@mail.gmail.com>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>	
	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>	
	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>	
	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>	
	<48ee0d3d.271d640a.40b3.717d@mx.google.com>	
	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>	
	<48EE40D1.5000606@refractions.net>	
	<48ee6e0e.1335640a.790b.7444@mx.google.com>
	<30fe546d0810091352i31397141wadcfb953fd14fa49@mail.gmail.com>
Message-ID: <48ee76dc.0609c00a.7d02.5d05@mx.google.com>

Paul,

> Just FYI, in case you didn't know, GEOS comes by it's Java'ish
> anti-pattern "honestly",
> 
> http://lin-ear-th-inking.blogspot.com/2007/06/history-of-jts-and-
> geos.html

Thanks for this link. That explains everything. 

> Thanks again for the patch. Compared to the postgis code calling it,
> it's a thing of beauty :)

Is that an excuse? :-P

Regards Hartmut

From mbdavis at refractions.net  Thu Oct  9 18:31:07 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Thu Oct  9 18:24:12 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <48ee6e0e.1335640a.790b.7444@mx.google.com>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>	<48ee0d3d.271d640a.40b3.717d@mx.google.com>	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>	<48EE40D1.5000606@refractions.net>
	<48ee6e0e.1335640a.790b.7444@mx.google.com>
Message-ID: <48EE862B.5090604@refractions.net>

Harmut, I'm not trying to be inflammatory.  You're right, the Java-vs-C 
thing is my personal opinion.  It was a small attempt at humour, but 
this probably isn't the right forum for that kind of joke.

I was the person who made the decision about the semantics of 
SegmentString, and I (with others) made the decision to try and track 
the JTS codebase as closely as possible with GEOS.  I still think that 
was the right decision, given the limited resources to maintain the two 
codebases.  It's easy to skeet-shoot from the sidelines, but unless 
you're willing to contribute the time to rewrite the entire library the 
question is moot.

Hartmut Kaiser wrote:
> Martin, 
>
>   
>> I have to disagree with Hartmut's complaint.  The SegmentString class
>> is
>> intended to be an adapter class, which wraps a data structure
>> (Coordinate sequence) owned by some client to allow it to be processed
>> by the noding logic.  Under this pattern, the SegmentString class
>> definitely should  *not* be freeing the memory for the wrapped sequence
>> - that is the responsibility of the client.
>>     
>
> Well, that's a decision of the people around the GEOS project, not mine. I
> just fixed some nasty memleaks which wouldn't have been there if some more
> coherent memory (and encapsulation) strategy had been used. I'm sure there
> was a reason for that. But please don't jump on me, I'm only saying that I
> would have done it differently.
>
>   
>> I can't comment on "writing C++ like Java", but obviously C++ requires
>> more knowledge of the usage patterns of memory resources than Java
>> does.  That's why Java is easier to write  8^)
>>     
>
> Come on, this is your personal opinion. And please, there is no need to
> start a religious war here. 
> I was intentionally very cautious while writing my remark in the first
> place.
>
> Regards Hartmut
>
>   
>> Paul Ramsey wrote:
>>     
>>> Another quarter heard from. I have applied this "ugly" patch
>>> nonetheless, since it removes my leak in PostGIS.
>>>
>>> P
>>>
>>>
>>> ---------- Forwarded message ----------
>>> From: Hartmut Kaiser <hartmut.kaiser@gmail.com>
>>> Date: Thu, Oct 9, 2008 at 6:55 AM
>>> Subject: RE: Prepared Geometry
>>> To: Paul Ramsey <pramsey@cleverelephant.ca>
>>>
>>>
>>> Paul,
>>>
>>>
>>>       
>>>> Could you try big against small1 and small2?
>>>>
>>>>         
>>> Patch attached. But frankly, I don't like the solution (even if it
>>>       
>> adopted
>>     
>>> the way it's currently handled all over the place in GEOS).
>>>
>>> The way the SegmentString class is written and used requires the user
>>>       
>> of the
>>     
>>> an instance of SegmentString to take care of the deletion of the
>>>       
>> embedded
>>     
>>> point array, for instance:
>>>
>>>    for ( size_t i = 0, ni = lineSegStr.size(); i < ni; i++ )
>>>    {
>>>        delete lineSegStr[ i ]->getCoordinates();    // <-- here
>>>        delete lineSegStr[ i ];
>>>    }
>>>
>>> Which is just wrong, because this could be done in a better way if
>>> SegmentString was taking care of this in the destructor. I tried to
>>>       
>> fix GEOS
>>     
>>> (and the tests) in this direction, but apparently the buffers stored
>>>       
>> in the
>>     
>>> SegmentString are shared in between different higher level structures
>>>       
>> in
>>     
>>> addition, which makes it impossible (at least currently for me) to
>>>       
>> fix that
>>     
>>> without introducing some kind of smart pointers (or investing a
>>>       
>> really large
>>     
>>> amount of time, which I don't have) ...
>>>
>>> For this reason I fixed this memory leak the straightforward (and
>>>       
>> ugly) way.
>>     
>>> I'm sure there are more similar bugs to recover, though :-P
>>>
>>> Regards Hartmut
>>>
>>> PS: As impressive GEOS is it convinces me once more that it's not a
>>>       
>> good
>>     
>>> idea to write C++ in a way similar to Java, especially if no special
>>>       
>> means
>>     
>>> of memory management (i.e. smart ptrs) are introduced.
>>>
>>>
>>>
>>>       
>>>> Thanks!
>>>>
>>>> Paul
>>>>
>>>> On Wed, Oct 8, 2008 at 1:54 PM, Hartmut Kaiser
>>>> <hartmut.kaiser@gmail.com> wrote:
>>>>
>>>>         
>>>>> Paul,
>>>>>
>>>>>
>>>>>           
>>>>>> The reason I ask is because while contains and covers appear leak
>>>>>> free, intersects seems to be leaking. I'm pretty sure it's not on
>>>>>>
>>>>>>             
>>>> the
>>>>
>>>>         
>>>>>> PostGIS side (I think).
>>>>>>
>>>>>> P.
>>>>>>
>>>>>> On Wed, Oct 8, 2008 at 12:25 PM, Paul Ramsey
>>>>>> <pramsey@cleverelephant.ca> wrote:
>>>>>>
>>>>>>             
>>>>>>> Hartmut,
>>>>>>>
>>>>>>> When you tested for leaks, did you test prepared contains,
>>>>>>>
>>>>>>>               
>>>>>> intersects,
>>>>>>
>>>>>>             
>>>>>>> covers, coversproperly? Or just one of them?
>>>>>>>
>>>>>>>               
>>>>> I was using the test program as attached to the ticket (which AFAIR
>>>>> calls all of the topological attribute functions). This test
>>>>>           
>> program
>>     
>>>>> was leak free for me. But I tried the geometries as attached to the
>>>>> ticket only either, so your leaks might show themselves with
>>>>>           
>> certain
>>     
>>>> geometries only.
>>>>
>>>>         
>>>>> Regards Hartmut
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> -------------------------------------------------------------------
>>>>>           
>> -----
>>     
>>>>> _______________________________________________
>>>>> geos-devel mailing list
>>>>> geos-devel@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>>>           
>> --
>> Martin Davis
>> Senior Technical Architect
>> Refractions Research, Inc.
>> (250) 383-3022
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>     
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From hartmut.kaiser at gmail.com  Thu Oct  9 18:47:56 2008
From: hartmut.kaiser at gmail.com (Hartmut Kaiser)
Date: Thu Oct  9 18:48:04 2008
Subject: [geos-devel] Fwd: Prepared Geometry
In-Reply-To: <48EE862B.5090604@refractions.net>
References: <30fe546d0810081225y761a02bcp8388bf8f5257f0c7@mail.gmail.com>	<30fe546d0810081240i48d8f101oa306675f7e912f5d@mail.gmail.com>	<48ed1e1c.26015a0a.1237.25c0@mx.google.com>	<30fe546d0810081646r677b441al40caaca7f6e6d8c2@mail.gmail.com>	<48ee0d3d.271d640a.40b3.717d@mx.google.com>	<30fe546d0810090938j43dcb614t39726d49db341d1a@mail.gmail.com>	<48EE40D1.5000606@refractions.net>
	<48ee6e0e.1335640a.790b.7444@mx.google.com>
	<48EE862B.5090604@refractions.net>
Message-ID: <48ee8a23.e203be0a.1656.070f@mx.google.com>

Martin,

> Harmut, I'm not trying to be inflammatory.  You're right, the Java-vs-C
> thing is my personal opinion.  It was a small attempt at humour, but
> this probably isn't the right forum for that kind of joke.

Heh, I might be German, but I'm always open to somebody cracking a joke. :-P

> I was the person who made the decision about the semantics of
> SegmentString, and I (with others) made the decision to try and track
> the JTS codebase as closely as possible with GEOS.  I still think that
> was the right decision, given the limited resources to maintain the two
> codebases.  

Ok, this explains the situation.

> It's easy to skeet-shoot from the sidelines, but unless
> you're willing to contribute the time to rewrite the entire library the
> question is moot.

Since I implemented such a thing in C++ in the late 90's once, I exactly
know what's involved. So rest assured, I'm not going to do it again. And I
hope you accept me contributing my time even if I'm not going to rewrite it.

And hey, I'm not skeet-shooting or criticizing, all I said was I'ld have
done it differently. And - IIRC, I said I'm impressed by GEOS.

But I stop responding to this thread, it's way too far off topic already.

Regards Hartmut


From mbdavis at refractions.net  Thu Oct  9 20:04:12 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Thu Oct  9 19:57:17 2008
Subject: [geos-devel] Improved buffering in JTS
Message-ID: <48EE9BFC.4000304@refractions.net>

GEOS'ers,

After years of thinking (really!) I've implemented some improvements for 
buffering in JTS which dramatically improve the performance and memory 
usage characteristics.  See this thread for some more details:

http://lists.jump-project.org/pipermail/jts-devel/2008-October/002675.html

It might be of interest to consider porting this over to GEOS (before 
the upcoming release?).  It's a relatively minor port - 1 class and 
about 20 lines of calling code.  I can give specific details if required.

Martin

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From robe.dnd at cityofboston.gov  Fri Oct 10 08:25:41 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 10 08:25:46 2008
Subject: [geos-devel] Compiling challenges with 3.1.0
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204DB2CD9@ZDND.DND.boston.cob>

Is there something different about the way I should be compiling 3.1.0.
I was hoping to test the new changes out on some of my datasets. So I
compiled the same way I did with 3.0.0

Basically download latest svn nightly snapshot from 
http://download.osgeo.org/geos/geos-svn.tar.bz2

Extract
cd geos-3.1.0
./configure
make clean
make

When doing so I get an error
CLocalizer.cpp:1:32: error: geos/io/CLocalizer.h: No such file or
directory
CLocalizer.cpp:11: error: 'CLocalizer' has not been declared
CLocalizer.cpp:11: error: ISO C++ forbids declaration of 'CLocalizer'
with no type
CLocalizer.cpp: In function 'int geos::io::CLocalizer()':
CLocalizer.cpp:16: error: 'saved_locale' was not declared in this scope
CLocalizer.cpp: At global scope:
CLocalizer.cpp:21: error: expected constructor, destructor, or type
conversion before '::' token
make[2]: *** [CLocalizer.lo] Error 1
make[2]: Leaving directory `/home/linux/projects/geos-3.1.0/source/io'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/linux/projects/geos-3.1.0/source'
make: *** [all-recursive] Error 1

This is when trying to compile on OpenSUSE 10.3 VM.  Don't have issues
with compiling the geos-3.0.0 build.

I found a bug report about something similar, but its marked as closed
and seemed to be an issue with compiling with Microsoft VC++

http://trac.osgeo.org/geos/ticket/206


I assume the snapshot is up to date since when I look at the dates on
the extracted files they match the SVN logs 
http://download.osgeo.org/geos/SVN.txt

Thanks,
Regina

 
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From robe.dnd at cityofboston.gov  Fri Oct 10 09:07:32 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 10 09:07:40 2008
Subject: [geos-devel] Compiling challenges with 3.1.0
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204DB2CD9@ZDND.DND.boston.cob>
References: <53F9CF533E1AA14EA1F8C5C08ABC08D204DB2CD9@ZDND.DND.boston.cob>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204DB2D1E@ZDND.DND.boston.cob>

Okay I pulled directly from svn did the usual
sh autogen.sh
./configure
make

The one from svn seems to work fine, so what's the deal with the nightly
svn snapshot? 

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Obe, Regina
Sent: Friday, October 10, 2008 8:26 AM
To: GEOS Development List
Subject: [geos-devel] Compiling challenges with 3.1.0

Is there something different about the way I should be compiling 3.1.0.
I was hoping to test the new changes out on some of my datasets. So I
compiled the same way I did with 3.0.0

Basically download latest svn nightly snapshot from 
http://download.osgeo.org/geos/geos-svn.tar.bz2

Extract
cd geos-3.1.0
./configure
make clean
make

When doing so I get an error
CLocalizer.cpp:1:32: error: geos/io/CLocalizer.h: No such file or
directory
CLocalizer.cpp:11: error: 'CLocalizer' has not been declared
CLocalizer.cpp:11: error: ISO C++ forbids declaration of 'CLocalizer'
with no type
CLocalizer.cpp: In function 'int geos::io::CLocalizer()':
CLocalizer.cpp:16: error: 'saved_locale' was not declared in this scope
CLocalizer.cpp: At global scope:
CLocalizer.cpp:21: error: expected constructor, destructor, or type
conversion before '::' token
make[2]: *** [CLocalizer.lo] Error 1
make[2]: Leaving directory `/home/linux/projects/geos-3.1.0/source/io'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/linux/projects/geos-3.1.0/source'
make: *** [all-recursive] Error 1

This is when trying to compile on OpenSUSE 10.3 VM.  Don't have issues
with compiling the geos-3.0.0 build.

I found a bug report about something similar, but its marked as closed
and seemed to be an issue with compiling with Microsoft VC++

http://trac.osgeo.org/geos/ticket/206


I assume the snapshot is up to date since when I look at the dates on
the extracted files they match the SVN logs 
http://download.osgeo.org/geos/SVN.txt

Thanks,
Regina

 
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From pramsey at cleverelephant.ca  Fri Oct 10 18:17:46 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 10 18:17:48 2008
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program
Message-ID: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>

PSC members,

I'd like to get official approval from you to engage in the OSGeo
Project Sponsorship program. The upshot of the Program is:

http://wiki.osgeo.org/wiki/Project_Sponsorship

- OSGeo acts as the banker, invoicing sponsors and holding funds in trust
- 25% of funds are put towards OSGeo general revenue, for thinks like
promotion and marketing
- The rest is disbursed at *our* direction

Things we might want to direct?

- maintainer to review all outstanding bugs!
- port forward cascaded union and new faster buffer
- investigate multi-platform issues

I am soliciting funds from the PostGIS community in addition to the
$5000 Safe Software pledge already generously provided.

Motion on the floor:

- To engage in OSGeo Project Sponsorship program?

+1 Paul
From hobu.inc at gmail.com  Fri Oct 10 19:46:02 2008
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Oct 10 19:53:10 2008
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program
In-Reply-To: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
References: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
Message-ID: <6A09FCEE-E4AE-4CB8-BA69-326FB651D0DE@gmail.com>

+1.

On Oct 10, 2008, at 5:17 PM, Paul Ramsey wrote:

> PSC members,
>
> I'd like to get official approval from you to engage in the OSGeo
> Project Sponsorship program. The upshot of the Program is:
>
> http://wiki.osgeo.org/wiki/Project_Sponsorship
>
> - OSGeo acts as the banker, invoicing sponsors and holding funds in  
> trust
> - 25% of funds are put towards OSGeo general revenue, for thinks like
> promotion and marketing
> - The rest is disbursed at *our* direction
>
> Things we might want to direct?
>
> - maintainer to review all outstanding bugs!
> - port forward cascaded union and new faster buffer
> - investigate multi-platform issues
>
> I am soliciting funds from the PostGIS community in addition to the
> $5000 Safe Software pledge already generously provided.
>
> Motion on the floor:
>
> - To engage in OSGeo Project Sponsorship program?
>
> +1 Paul
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From mark.cave-ayland at ilande.co.uk  Mon Oct 13 08:00:13 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Mon Oct 13 08:00:17 2008
Subject: [geos-devel] Incorrect function prototype for
	GEOSPreparedGeom_destroy in CAPI
Message-ID: <36453.81.187.123.11.1223899213.squirrel@www.ilande.co.uk>

Hi there,

In some of my testing on GEOS SVN/PostGIS SVN I've noticed some warnings
on calls to GEOSPreparedGeom_destroy. The reason for this is that the
GEOSPrepare() constructor returns a "const PreparedGeometry *" whereas
GEOSPreparedGeom_destroy() currently accepts a "PreparedGeometry *". The
attached patch adds the missing const qualifier to
GEOSPreparedGeom_destroy which removes the warnings in PostGIS.


ATB,

Mark.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos_preparedgeom_destroy.patch
Type: text/x-diff
Size: 1277 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081013/a72adb20/geos_preparedgeom_destroy.bin
From pramsey at cleverelephant.ca  Tue Oct 14 11:01:51 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Tue Oct 14 11:01:54 2008
Subject: [geos-devel] Incorrect function prototype for
	GEOSPreparedGeom_destroy in CAPI
In-Reply-To: <36453.81.187.123.11.1223899213.squirrel@www.ilande.co.uk>
References: <36453.81.187.123.11.1223899213.squirrel@www.ilande.co.uk>
Message-ID: <30fe546d0810140801p2e35eb9ctfad4fa3d1db8cfb@mail.gmail.com>

Done, #209.

On Mon, Oct 13, 2008 at 5:00 AM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:
> Hi there,
>
> In some of my testing on GEOS SVN/PostGIS SVN I've noticed some warnings
> on calls to GEOSPreparedGeom_destroy. The reason for this is that the
> GEOSPrepare() constructor returns a "const PreparedGeometry *" whereas
> GEOSPreparedGeom_destroy() currently accepts a "PreparedGeometry *". The
> attached patch adds the missing const qualifier to
> GEOSPreparedGeom_destroy which removes the warnings in PostGIS.
>
>
> ATB,
>
> Mark.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Tue Oct 14 11:49:09 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Tue Oct 14 11:49:12 2008
Subject: [geos-devel] Fwd: [postgis-devel] 1.3.4SVN Testers Needed
In-Reply-To: <4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
Message-ID: <30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>

Does anyone have the wherewithal to clean out some build warnings?

Paul


---------- Forwarded message ----------
From: Dane Springmeyer <blake@hailmail.net>
Date: Mon, Oct 13, 2008 at 4:30 PM
Subject: Re: [postgis-devel] 1.3.4SVN Testers Needed
To: PostGIS Development Discussion <postgis-devel@postgis.refractions.net>


Thanks Paul.
Geos builds great now for me on Mac OS 10.5. Only a few warnings
during compile which I'll paste below.
Cheers,
Dane



$ make
 g++ -DHAVE_CONFIG_H -I. -I. -I../../../source/headers
-I../../../source/headers/geos -I../../../source/headers -g -O2
-DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT
AbstractPreparedPolygonContains.lo -MD -MP -MF
.deps/AbstractPreparedPolygonContains.Tpo -c
AbstractPreparedPolygonContains.cpp  -fno-common -DPIC -o
.libs/AbstractPreparedPolygonContains.o
../../../source/headers/geos/noding/NodedSegmentString.h: In member
function 'geos::noding::SegmentNode*
geos::noding::NodedSegmentString::addIntersectionNode(geos::geom::Coordinate*,
int)':
../../../source/headers/geos/noding/NodedSegmentString.h:88: warning:
comparison between signed and unsigned integer expressions

[....snip...]

 g++ -DHAVE_CONFIG_H -I. -I. -I../../../source/headers
-I../../../source/headers/geos -I../../../source/headers -g -O2
-DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT
IntervalRTreeLeafNode.lo -MD -MP -MF .deps/IntervalRTreeLeafNode.Tpo
-c IntervalRTreeLeafNode.cpp  -fno-common -DPIC -o
.libs/IntervalRTreeLeafNode.o
../../../source/headers/geos/index/intervalrtree/IntervalRTreeLeafNode.h:
In destructor 'virtual
geos::index::intervalrtree::IntervalRTreeLeafNode::~IntervalRTreeLeafNode()':
../../../source/headers/geos/index/intervalrtree/IntervalRTreeLeafNode.h:50:
warning: deleting 'void*' is undefined

[....snip...]

 g++ -DHAVE_CONFIG_H -I. -I. -I../../../source/headers
-I../../../source/headers/geos -I../../../source/headers -g -O2
-DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT
SortedPackedIntervalRTree.lo -MD -MP -MF
.deps/SortedPackedIntervalRTree.Tpo -c SortedPackedIntervalRTree.cpp
-fno-common -DPIC -o .libs/SortedPackedIntervalRTree.o
../../../source/headers/geos/index/intervalrtree/IntervalRTreeLeafNode.h:
In destructor 'virtual
geos::index::intervalrtree::IntervalRTreeLeafNode::~IntervalRTreeLeafNode()':
../../../source/headers/geos/index/intervalrtree/IntervalRTreeLeafNode.h:50:
warning: deleting 'void*' is undefined
../../../source/headers/geos/index/intervalrtree/SortedPackedIntervalRTree.h:
In constructor 'geos::index::intervalrtree::SortedPackedIntervalRTree::SortedPackedIntervalRTree()':
../../../source/headers/geos/index/intervalrtree/SortedPackedIntervalRTree.h:53:
warning: 'geos::index::intervalrtree::SortedPackedIntervalRTree::root'
will be initialized after
../../../source/headers/geos/index/intervalrtree/SortedPackedIntervalRTree.h:52:
warning:   'std::vector<const
geos::index::intervalrtree::IntervalRTreeNode*, std::allocator<const
geos::index::intervalrtree::IntervalRTreeNode*> >*
geos::index::intervalrtree::SortedPackedIntervalRTree::leaves'
SortedPackedIntervalRTree.cpp:101: warning:   when initialized here

[....snip...]

g++ -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -o
.libs/XMLTester XMLTester.o MarkupSTL.o -Wl,-bind_at_load
../../source/.libs/libgeos.dylib
creating XMLTester
if g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers
-I../../source/headers/geos -I../../source/headers
-I../../source/io/markup    -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic
-Wno-long-long -MT SimpleWKTTester.o -MD -MP -MF
".deps/SimpleWKTTester.Tpo" -c -o SimpleWKTTester.o
SimpleWKTTester.cpp; \
then mv -f ".deps/SimpleWKTTester.Tpo" ".deps/SimpleWKTTester.Po";
else rm -f ".deps/SimpleWKTTester.Tpo"; exit 1; fi
In file included from SimpleWKTTester.cpp:23:
../../source/headers/geos/io.h:62:2: warning: #warning is a GCC extension
../../source/headers/geos/io.h:62:2: warning: #warning *** DEPRECATED:
You are using deprecated header io.h. Please, update your sources
according to new layout of GEOS headers and namespaces
In file included from SimpleWKTTester.cpp:24:
../../source/headers/geos/geom.h:145:2: warning: #warning is a GCC extension
../../source/headers/geos/geom.h:145:2: warning: #warning ***
DEPRECATED: You are using deprecated header geom.h. Please, update
your sources according to new layout of GEOS headers and namespaces


On Oct 13, 2008, at 4:00 PM, Obe, Regina wrote:

Thanks for the prompt service :)


-----Original Message-----
From: postgis-devel-bounces@postgis.refractions.net on behalf of Paul Ramsey
Sent: Mon 10/13/2008 6:47 PM
To: PostGIS Development Discussion
Subject: Re: [postgis-devel] 1.3.4SVN Testers Needed

Found it. SVN snapshot should build now. (We use 'make dist' to build
the tarball, but that requires that every file be declared in the
build scripts, so they can be packaged up. That new header was not
declared.)

P.

On Mon, Oct 13, 2008 at 2:25 PM, Havard Tveite <havard.tveite@umb.no> wrote:
> Errors at the same place here - Solaris 2.7, gcc 3.3.2:
>
>  g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers
> -I../../source/headers/geos
> -I../../source/headers -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic
> -Wno-long-long
>  -MT CLocalizer.lo -MD -MP -MF .deps/CLocalizer.Tpo -c CLocalizer.cpp  -fPIC
> -DP
> IC -o .libs/CLocalizer.o
> CLocalizer.cpp:1:32: geos/io/CLocalizer.h: No such file or directory
> CLocalizer.cpp:11: error: syntax error before `::' token
> CLocalizer.cpp:18: error: ISO C++ forbids declaration of `setlocale' with no
>   type
> CLocalizer.cpp:18: error: declaration of `setlocale' not in a namespace
>   surrounding `std'
> CLocalizer.cpp:18: error: `int std::setlocale' redeclared as different kind
> of
>   symbol
> /usr/include/locale.h:102: error: previous declaration of `char*
> setlocale(int,
>   const char*)'
> CLocalizer.cpp:18: error: initializer list being treated as compound
> expression
> CLocalizer.cpp:18: error: invalid conversion from `const char*' to `int'
> CLocalizer.cpp:21: error: syntax error before `::' token
> make[2]: *** [CLocalizer.lo] Error 1
> make[2]: Leaving directory `/data3/usr/local/src/geos/geos-3.1.0/source/io'
>
> H?vard Tveite
>
> Dane Springmeyer wrote:
>>
>> Paul,
>>
>> Just tried building GEOS from the provided svn download on Mac 10.5.5
>> and I get this error during make:
>>
>>        then mv -f ".deps/Unload.Tpo" ".deps/Unload.Plo"; else rm -f
>> ".deps/
>> Unload.Tpo"; exit 1; fi
>>  g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers -I../../source/
>> headers/geos -I../../source/headers -g -O2 -DGEOS_INLINE -Wall -ansi -
>> pedantic -Wno-long-long -MT Unload.lo -MD -MP -MF .deps/Unload.Tpo -c
>> Unload.cpp  -fno-common -DPIC -o .libs/Unload.o
>>  g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers -I../../source/
>> headers/geos -I../../source/headers -g -O2 -DGEOS_INLINE -Wall -ansi -
>> pedantic -Wno-long-long -MT Unload.lo -MD -MP -MF .deps/Unload.Tpo -c
>> Unload.cpp -o Unload.o >/dev/null 2>&1
>> if /bin/sh ../../libtool --tag=CXX --mode=compile g++ -DHAVE_CONFIG_H -
>> I. -I. -I../../source/headers -I../../source/headers/geos -I../../
>> source/headers     -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-
>> long-long -MT CLocalizer.lo -MD -MP -MF ".deps/CLocalizer.Tpo" -c -o
>> CLocalizer.lo CLocalizer.cpp; \
>>        then mv -f ".deps/CLocalizer.Tpo" ".deps/CLocalizer.Plo"; else rm
>> -f
>> ".deps/CLocalizer.Tpo"; exit 1; fi
>>  g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers -I../../source/
>> headers/geos -I../../source/headers -g -O2 -DGEOS_INLINE -Wall -ansi -
>> pedantic -Wno-long-long -MT CLocalizer.lo -MD -MP -MF .deps/
>> CLocalizer.Tpo -c CLocalizer.cpp  -fno-common -DPIC -o .libs/
>> CLocalizer.o
>> CLocalizer.cpp:1:32: error: geos/io/CLocalizer.h: No such file or
>> directory
>> CLocalizer.cpp:11: error: 'CLocalizer' has not been declared
>> CLocalizer.cpp:11: error: ISO C++ forbids declaration of 'CLocalizer'
>> with no type
>> CLocalizer.cpp: In function 'int geos::io::CLocalizer()':
>> CLocalizer.cpp:16: error: 'saved_locale' was not declared in this scope
>> CLocalizer.cpp: At global scope:
>> CLocalizer.cpp:21: error: expected constructor, destructor, or type
>> conversion before '::' token
>> CLocalizer.cpp: In function 'int geos::io::CLocalizer()':
>> CLocalizer.cpp:19: warning: control reaches end of non-void function
>> make[2]: *** [CLocalizer.lo] Error 1
>> make[1]: *** [all-recursive] Error 1
>> make: *** [all-recursive] Error 1
>>
>>
>> I see it must be related to http://trac.osgeo.org/geos/ticket/201
>>
>> Let me know if I'm missing something.
>>
>> Dane
>>
>>
>>
>> On Oct 13, 2008, at 11:57 AM, Paul Ramsey wrote:
>>
>>> 1.3.4 is very close to release, but we can release it faster, with
>>> less intestinal distress, if we get some solid pre-release testing
>>> from folks. You can download the current SVN version directly from the
>>> downloads page, no SVN client required:
>>>
>>> http://postgis.refractions.net/download/postgis-1.3.4SVN.tar.gz
>>>
>>> If you want to also try the latest preparedgeometry enhancements,
>>> you'll need to upgrade your GEOS version to the SVN trunk before
>>> compiling and installing1.3.4SVN,
>>> http://download.osgeo.org/geos/geos-svn.tar.bz2
>>>
>>> Even if you don't, you should see some performance increases in 1.3.4,
>>> particularly in point-and-polygon predicate tests, and large joins
>>> using point-ant-polygon predicates.
>>>
>>> Let us know how it goes. We are particularly  interested in any
>>> compilation difficulties or regression failures on less common unix
>>> variants (Solaris on Sparc, AIX on Power, etc)
>>>
>>> Paul
>>> _______________________________________________
>>> postgis-devel mailing list
>>> postgis-devel@postgis.refractions.net
>>> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>>
>> _______________________________________________
>> postgis-devel mailing list
>> postgis-devel@postgis.refractions.net
>> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>
> --
> --
> H?vard Tveite
> Department of Mathematical Sciences and Technology
> Norwegian University of Life Sciences
> _______________________________________________
> postgis-devel mailing list
> postgis-devel@postgis.refractions.net
> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>
_______________________________________________
postgis-devel mailing list
postgis-devel@postgis.refractions.net
http://postgis.refractions.net/mailman/listinfo/postgis-devel


________________________________

The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended solely for the
addressee. If you received this in error, please contact the sender
and delete the material from any computer.

________________________________

Help make the earth a greener place. If at all possible resist
printing this email and join us in saving paper.

_______________________________________________
postgis-devel mailing list
postgis-devel@postgis.refractions.net
http://postgis.refractions.net/mailman/listinfo/postgis-devel


_______________________________________________
postgis-devel mailing list
postgis-devel@postgis.refractions.net
http://postgis.refractions.net/mailman/listinfo/postgis-devel
From charles.thibert at ingres.com  Tue Oct 14 14:12:07 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Tue Oct 14 14:12:09 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
Message-ID: <1224007927.3310.6.camel@localhost.localdomain>

Hi,

I have been prototyping a thread safe CAPI.  I have attached a simple
proposal/design intent.  I have sample executables and test data that
will illustrate the thread issues but I don't want to flood the mailing
list with them.  If the proposal attached looks decent to you all I'll
create a new ticket and attach the code I have to that.

Thanks,
Chuck
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GEOS_Thread_Safe_CAPI.txt
Type: text/x-rpm-spec
Size: 1413 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081014/7e9f9806/GEOS_Thread_Safe_CAPI.bin
From pramsey at cleverelephant.ca  Tue Oct 14 14:46:06 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Tue Oct 14 14:46:09 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <1224007927.3310.6.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
Message-ID: <30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>

I'd be interested in seeing more. I think I "get" this, and there have
to be more folks w/ this problem. Could we reduce the two-apis
duplication somewhat by having the old API call into the new API, and
just stick the handle into a global in that case? That way we have
twice as much API still, but about the same amount of C/C++ gluecode.

P.

On Tue, Oct 14, 2008 at 11:12 AM, Chuck Thibert
<charles.thibert@ingres.com> wrote:
> Hi,
>
> I have been prototyping a thread safe CAPI.  I have attached a simple
> proposal/design intent.  I have sample executables and test data that
> will illustrate the thread issues but I don't want to flood the mailing
> list with them.  If the proposal attached looks decent to you all I'll
> create a new ticket and attach the code I have to that.
>
> Thanks,
> Chuck
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From charles.thibert at ingres.com  Tue Oct 14 15:13:12 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Tue Oct 14 15:13:13 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
Message-ID: <1224011592.3310.9.camel@localhost.localdomain>

Great idea Paul.  I can do that while cleaning up the prototype for
sure.  I'll open the ticket and post up what I've got for a more
detailed look.

Chuck


On Tue, 2008-10-14 at 11:46 -0700, Paul Ramsey wrote:
> I'd be interested in seeing more. I think I "get" this, and there have
> to be more folks w/ this problem. Could we reduce the two-apis
> duplication somewhat by having the old API call into the new API, and
> just stick the handle into a global in that case? That way we have
> twice as much API still, but about the same amount of C/C++ gluecode.
> 
> P.
> 
> On Tue, Oct 14, 2008 at 11:12 AM, Chuck Thibert
> <charles.thibert@ingres.com> wrote:
> > Hi,
> >
> > I have been prototyping a thread safe CAPI.  I have attached a simple
> > proposal/design intent.  I have sample executables and test data that
> > will illustrate the thread issues but I don't want to flood the mailing
> > list with them.  If the proposal attached looks decent to you all I'll
> > create a new ticket and attach the code I have to that.
> >
> > Thanks,
> > Chuck
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
From geos-trac at osgeo.org  Tue Oct 14 15:15:39 2008
From: geos-trac at osgeo.org (GEOS)
Date: Tue Oct 14 15:15:41 2008
Subject: [geos-devel] [GEOS] #210: Create a thread safe CAPI
Message-ID: <048.6c4e30c5ade9074657c1ea5390f33d29@osgeo.org>

#210: Create a thread safe CAPI
-----------------------------+----------------------------------------------
 Reporter:  cthibert         |       Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement      |      Status:  new                       
 Priority:  major            |   Milestone:                            
Component:  C API            |     Version:                            
 Severity:  Feature Request  |    Keywords:                            
-----------------------------+----------------------------------------------
 The current CAPI in GEOS is not thread safe.  The error handling and
 initialization/finalization process specifically can cause problems.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/210>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From warmerdam at pobox.com  Tue Oct 14 16:02:53 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Oct 14 16:03:16 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <1224011592.3310.9.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
Message-ID: <48F4FAED.5010602@pobox.com>


>> On Tue, Oct 14, 2008 at 11:12 AM, Chuck Thibert
>> <charles.thibert@ingres.com> wrote:
>>> Hi,
>>>
>>> I have been prototyping a thread safe CAPI.  I have attached a simple
>>> proposal/design intent.  I have sample executables and test data that
>>> will illustrate the thread issues but I don't want to flood the mailing
>>> list with them.  If the proposal attached looks decent to you all I'll
>>> create a new ticket and attach the code I have to that.

Chuck,

As defined, the GEOSHandle structure is public.  This means any change
in the layout or items in the GEOSHandle structure cannot be changed
without altering the ABI.

I would like to suggest altering the approach so that the structure
structure is allocated internally by initGEOS_TS() and only an opaque
handle would be returned.

eg.

   typedef void *GEOSHandle_t;

   GEOSHandle_t initGEOS_TS( GEOSMessageHandler notice_function,
                             GEOSMessageHandler error_function);

   void finishGEOS_TS( GEOSHandle_t *handle );

I think we should also at this point consider whether there is anything
else that we want to be able to control on a per-thread-context basis.
For instance, currently the C API only offers use of the default
geometry factory.  Would there be reasons to provide access to others?
Also, given recent discussions, allowing overloading of the memory
allocator might be of interest.

I'm quite supportive of this thread safety change, and the approach
seems quite practical. I'd like to see a "proper" RFC written up in
Trac and voted on.

PS. It isn't very important, but I think a name like GEOSContext_t
or even GEOSContextHandle_t would be better than GEOSHandle_t.  The
object is essentially an execution context/environment.

PPS. I'm not sure why there are GEOSversion_TS() and GEOS_jtsport_TS()
function that operate exactly like the non-TS version. I'd like to
suggest we only implement _TS() versions of function that need the
handle/context to operate.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From charles.thibert at ingres.com  Tue Oct 14 16:32:01 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Tue Oct 14 16:32:04 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <48F4FAED.5010602@pobox.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
Message-ID: <1224016321.3310.17.camel@localhost.localdomain>

Thanks for the great feedback Frank.  I will implement the suggestions.
As for the TS versions of functions that don't quite need it... Mostly
did those for completeness atm and proof of concept.

I'll work on a proper RFC in the next day or so for sure.

Chuck


On Tue, 2008-10-14 at 16:02 -0400, Frank Warmerdam wrote:
> >> On Tue, Oct 14, 2008 at 11:12 AM, Chuck Thibert
> >> <charles.thibert@ingres.com> wrote:
> >>> Hi,
> >>>
> >>> I have been prototyping a thread safe CAPI.  I have attached a simple
> >>> proposal/design intent.  I have sample executables and test data that
> >>> will illustrate the thread issues but I don't want to flood the mailing
> >>> list with them.  If the proposal attached looks decent to you all I'll
> >>> create a new ticket and attach the code I have to that.
> 
> Chuck,
> 
> As defined, the GEOSHandle structure is public.  This means any change
> in the layout or items in the GEOSHandle structure cannot be changed
> without altering the ABI.
> 
> I would like to suggest altering the approach so that the structure
> structure is allocated internally by initGEOS_TS() and only an opaque
> handle would be returned.
> 
> eg.
> 
>    typedef void *GEOSHandle_t;
> 
>    GEOSHandle_t initGEOS_TS( GEOSMessageHandler notice_function,
>                              GEOSMessageHandler error_function);
> 
>    void finishGEOS_TS( GEOSHandle_t *handle );
> 
> I think we should also at this point consider whether there is anything
> else that we want to be able to control on a per-thread-context basis.
> For instance, currently the C API only offers use of the default
> geometry factory.  Would there be reasons to provide access to others?
> Also, given recent discussions, allowing overloading of the memory
> allocator might be of interest.
> 
> I'm quite supportive of this thread safety change, and the approach
> seems quite practical. I'd like to see a "proper" RFC written up in
> Trac and voted on.
> 
> PS. It isn't very important, but I think a name like GEOSContext_t
> or even GEOSContextHandle_t would be better than GEOSHandle_t.  The
> object is essentially an execution context/environment.
> 
> PPS. I'm not sure why there are GEOSversion_TS() and GEOS_jtsport_TS()
> function that operate exactly like the non-TS version. I'd like to
> suggest we only implement _TS() versions of function that need the
> handle/context to operate.
> 
> Best regards,
From pramsey at cleverelephant.ca  Wed Oct 15 13:45:38 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 15 13:45:41 2008
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program
In-Reply-To: <6A09FCEE-E4AE-4CB8-BA69-326FB651D0DE@gmail.com>
References: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
	<6A09FCEE-E4AE-4CB8-BA69-326FB651D0DE@gmail.com>
Message-ID: <30fe546d0810151045r585578cdk64883b216fa65b2c@mail.gmail.com>

Thanks Howard.

HEY, PSC MEMBERS! HEY! USE IT OR LOSE IT!

On Fri, Oct 10, 2008 at 4:46 PM, Howard Butler <hobu.inc@gmail.com> wrote:
> +1.
>
> On Oct 10, 2008, at 5:17 PM, Paul Ramsey wrote:
>
>> PSC members,
>>
>> I'd like to get official approval from you to engage in the OSGeo
>> Project Sponsorship program. The upshot of the Program is:
>>
>> http://wiki.osgeo.org/wiki/Project_Sponsorship
>>
>> - OSGeo acts as the banker, invoicing sponsors and holding funds in trust
>> - 25% of funds are put towards OSGeo general revenue, for thinks like
>> promotion and marketing
>> - The rest is disbursed at *our* direction
>>
>> Things we might want to direct?
>>
>> - maintainer to review all outstanding bugs!
>> - port forward cascaded union and new faster buffer
>> - investigate multi-platform issues
>>
>> I am soliciting funds from the PostGIS community in addition to the
>> $5000 Safe Software pledge already generously provided.
>>
>> Motion on the floor:
>>
>> - To engage in OSGeo Project Sponsorship program?
>>
>> +1 Paul
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From mbdavis at refractions.net  Wed Oct 15 13:54:17 2008
From: mbdavis at refractions.net (Martin Davis)
Date: Wed Oct 15 13:47:09 2008
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program
In-Reply-To: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
References: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
Message-ID: <48F62E49.20803@refractions.net>

+1

Paul Ramsey wrote:
> PSC members,
>
> I'd like to get official approval from you to engage in the OSGeo
> Project Sponsorship program. The upshot of the Program is:
>
> http://wiki.osgeo.org/wiki/Project_Sponsorship
>
> - OSGeo acts as the banker, invoicing sponsors and holding funds in trust
> - 25% of funds are put towards OSGeo general revenue, for thinks like
> promotion and marketing
> - The rest is disbursed at *our* direction
>
> Things we might want to direct?
>
> - maintainer to review all outstanding bugs!
> - port forward cascaded union and new faster buffer
> - investigate multi-platform issues
>
> I am soliciting funds from the PostGIS community in addition to the
> $5000 Safe Software pledge already generously provided.
>
> Motion on the floor:
>
> - To engage in OSGeo Project Sponsorship program?
>
> +1 Paul
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>   

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mark.cave-ayland at ilande.co.uk  Wed Oct 15 14:46:44 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct 15 14:45:02 2008
Subject: [geos-devel] Proposal: Thread safe CAPI
In-Reply-To: <1224016321.3310.17.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224016321.3310.17.camel@localhost.localdomain>
Message-ID: <1224096404.3342.1.camel@mca-desktop>


On Tue, 2008-10-14 at 16:32 -0400, Chuck Thibert wrote:
> Thanks for the great feedback Frank.  I will implement the suggestions.
> As for the TS versions of functions that don't quite need it... Mostly
> did those for completeness atm and proof of concept.
> 
> I'll work on a proper RFC in the next day or so for sure.
> 
> Chuck


Hi Chuck,

Looks reasonable. My only comment would be that it makes sense to mark
the thread-safe versions of the functions with a _r prefix so that it
matches the normal UNIX convention, e.g. initGEOS() becomes initGEOS_r()
etc...


ATB,

Mark.


From pramsey at cleverelephant.ca  Wed Oct 15 17:56:09 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 15 17:56:11 2008
Subject: [geos-devel] Re: 3.0.1
In-Reply-To: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>
References: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>
Message-ID: <30fe546d0810151456h6cd117e1o632e27e2674e636b@mail.gmail.com>

Hearing no screams of dismay, I am going to push out 3.0.1 at my
earliest convenience.

P.

On Mon, Oct 6, 2008 at 12:41 PM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> There's actually been surprisingly little activity on the 3.0 branch:
>
> 2008-08-29 15:00  sgillies
>
>        * source/headers/geos/io/CLocalizer.h, source/io/CLocalizer.cpp,
>          source/io/WKTWriter.cpp: Added CLocalizer class that switches to
>          C locale and restores to the outer context's locale when deleted
>          (#201)
>
> 2008-08-29 14:57  sgillies
>
>        * capi/geos_c.cpp, source/headers/geos/io.h, source/io/Makefile.am,
>          source/io/WKTWriter.cpp: Added CLocalizer class that switches to
>          C locale and restores to the outer context's locale when deleted
>          (#201)
>
> 2008-07-19 18:45  warmerdam
>
>        * source/Makefile.vc: incorporate manifest into dlls (#193)
>
> 2008-07-19 18:20  warmerdam
>
>        * source/Makefile.vc, source/headers/geos/version.h.vc: add
>          automatic copying of version.h for svn builds
>
> 2008-04-21 23:22  pramsey
>
>        * source/geom/Geometry.cpp: Fix for rectangle optimization logic.
>
> 2008-02-06 21:23  warmerdam
>
>        * Makefile.am, source/Makefile.am, source/Makefile.vc: Add missing
>          files into distribution, remove unused source files from win32
>          make (#175)
>
> 2008-01-02 23:31  sgillies
>
>        * swig/Makefile.am: Conditionally add swig/python,ruby to SUBDIRS
>
>
> On Mon, Oct 6, 2008 at 11:28 AM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>> No, I mean to say a 3.0.1 release, without prepared geometries.
>>
>
From mark.cave-ayland at ilande.co.uk  Wed Oct 15 18:05:47 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct 15 18:04:01 2008
Subject: [geos-devel] Re: 3.0.1
In-Reply-To: <30fe546d0810151456h6cd117e1o632e27e2674e636b@mail.gmail.com>
References: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>
	<30fe546d0810151456h6cd117e1o632e27e2674e636b@mail.gmail.com>
Message-ID: <1224108347.14741.2.camel@mca-desktop>


On Wed, 2008-10-15 at 14:56 -0700, Paul Ramsey wrote:
> Hearing no screams of dismay, I am going to push out 3.0.1 at my
> earliest convenience.
> 
> P.

Cool. Looking at the ChangeLog you included in your original email, has
your recent fix for installing CLocalizer.h in trunk hit the 3.0 branch?


ATB,

Mark.


From pramsey at cleverelephant.ca  Wed Oct 15 18:22:30 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 15 18:22:33 2008
Subject: [geos-devel] Re: 3.0.1
In-Reply-To: <1224108347.14741.2.camel@mca-desktop>
References: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>
	<30fe546d0810151456h6cd117e1o632e27e2674e636b@mail.gmail.com>
	<1224108347.14741.2.camel@mca-desktop>
Message-ID: <30fe546d0810151522h4c3cd6eaxae1a714431699c2d@mail.gmail.com>

Running the pre-release tests now :)

P

On Wed, Oct 15, 2008 at 3:05 PM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:
>
> On Wed, 2008-10-15 at 14:56 -0700, Paul Ramsey wrote:
>> Hearing no screams of dismay, I am going to push out 3.0.1 at my
>> earliest convenience.
>>
>> P.
>
> Cool. Looking at the ChangeLog you included in your original email, has
> your recent fix for installing CLocalizer.h in trunk hit the 3.0 branch?
>
>
> ATB,
>
> Mark.
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Wed Oct 15 18:22:43 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 15 18:22:45 2008
Subject: [geos-devel] Re: 3.0.1
In-Reply-To: <30fe546d0810151522h4c3cd6eaxae1a714431699c2d@mail.gmail.com>
References: <30fe546d0810061241h605ceec2td08f9d318138a88c@mail.gmail.com>
	<30fe546d0810151456h6cd117e1o632e27e2674e636b@mail.gmail.com>
	<1224108347.14741.2.camel@mca-desktop>
	<30fe546d0810151522h4c3cd6eaxae1a714431699c2d@mail.gmail.com>
Message-ID: <30fe546d0810151522n422938bftf92bd07f9de3125d@mail.gmail.com>

Crunch. :) No, it hadn't :)

On Wed, Oct 15, 2008 at 3:22 PM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> Running the pre-release tests now :)
>
> P
>
> On Wed, Oct 15, 2008 at 3:05 PM, Mark Cave-Ayland
> <mark.cave-ayland@ilande.co.uk> wrote:
>>
>> On Wed, 2008-10-15 at 14:56 -0700, Paul Ramsey wrote:
>>> Hearing no screams of dismay, I am going to push out 3.0.1 at my
>>> earliest convenience.
>>>
>>> P.
>>
>> Cool. Looking at the ChangeLog you included in your original email, has
>> your recent fix for installing CLocalizer.h in trunk hit the 3.0 branch?
>>
>>
>> ATB,
>>
>> Mark.
>>
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>
From pramsey at cleverelephant.ca  Wed Oct 15 20:34:19 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 15 20:34:22 2008
Subject: [geos-devel] GEOS 3.0.1
Message-ID: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>

I'm pleased to report, GEOS 3.0.1 is available:

http://download.osgeo.org/geos/geos-3.0.1.tar.bz2

This removes a contains bug that has been reported here a couple time recently.

P.
From warmerdam at pobox.com  Thu Oct 16 11:44:40 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Oct 16 11:45:09 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
Message-ID: <48F76168.3050409@pobox.com>

Paul Ramsey wrote:
> I'm pleased to report, GEOS 3.0.1 is available:
> 
> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
> 
> This removes a contains bug that has been reported here a couple time recently.

Paul,

As a "process hound", I'd suggest that point releases be issued as a
release candidate and then voting in the PSC to promote it to a final
release based on peoples rudimentary testing.  This keeps the process
low, but includes a limited release candidate phase to weed out annoying
issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dale.lutz at safe.com  Thu Oct 16 12:25:27 2008
From: dale.lutz at safe.com (Dale Lutz)
Date: Thu Oct 16 12:32:12 2008
Subject: [geos-devel] Re: Participating in OSGeo Project Sponsorship Program
In-Reply-To: <20081016160010.AE470E01054@lists.osgeo.org>
References: <20081016160010.AE470E01054@lists.osgeo.org>
Message-ID: <1F3C01D6E667B64985B9D81FD8AC90DE365A6A9DBE@email1.safe.internal>

+1 (I'm not sure if my vote was implied by our willingness to sponsor this which is already known (and unfortunately unmatched), but I'll vote explicitly and live in fear that Paul will take glee in cancelling me out...)<http://blog.cleverelephant.ca/2008/10/voting-day-in-canada.html>





Dale



----------------------------------------------------------------------

Dale Lutz              Safe Software Inc.           dale.lutz@safe.com

VP Development         Surrey, BC, CANADA        phone: (604) 501-9985

                       http://www.safe.com         fax: (604) 501-9965

----------------------------------------------------------------------




-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081016/c6f58069/attachment.html
From pramsey at cleverelephant.ca  Thu Oct 16 14:10:48 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct 16 14:10:52 2008
Subject: [geos-devel] Re: [postgis-users] GEOS 3.0.1
In-Reply-To: <200810161052.57284.dylan.beaudette@gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<200810161052.57284.dylan.beaudette@gmail.com>
Message-ID: <30fe546d0810161110i51e3a777pc849ba4c35556bf8@mail.gmail.com>

Does adding

#include <cstdlib>

help?

What is the value of HAVE_MEMCPY in your source/headers/config..h file?

P.

On Thu, Oct 16, 2008 at 10:52 AM, Dylan Beaudette
<dylan.beaudette@gmail.com> wrote:
> On Wednesday 15 October 2008, Paul Ramsey wrote:
>> I'm pleased to report, GEOS 3.0.1 is available:
>>
>> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>>
>> This removes a contains bug that has been reported here a couple time
>> recently.
>>
>> P.
>
> Hmm.. I am still getting an odd compile-time bug, that cropped up with
> Debian's switch to GCC-4.3
>
>
> DoubleBits.cpp: In static member function 'static double
> geos::index::quadtree::DoubleBits::powerOf2(int)':
> DoubleBits.cpp:51: error: 'memcpy' was not declared in this scope
>
> Odd..
>
> Dylan
>
>
> --
> Dylan Beaudette
> Soil Resource Laboratory
> http://casoilresource.lawr.ucdavis.edu/
> University of California at Davis
> 530.754.7341
>
From charles.thibert at ingres.com  Thu Oct 16 14:12:37 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Thu Oct 16 14:12:40 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <48F4FAED.5010602@pobox.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
Message-ID: <1224180757.4045.2.camel@localhost.localdomain>

Hello all,

Thanks for the feedback on my initial proposal.  I have updated the
proposal with said feedback and posted an official RFC on Trac at:

http://trac.osgeo.org/geos/wiki/RFC3

Thanks,
Chuck

From geosanak at gmail.com  Thu Oct 16 14:08:50 2008
From: geosanak at gmail.com (Sanak)
Date: Thu Oct 16 14:23:06 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
Message-ID: <5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>

Following link archive seems to be some old revision. (It is difference from
svn 3.0.1 tags in  io/CLocalizer.cpp .etc).

Could anyone confirm the archive?

Regards,

2008/10/16 Paul Ramsey <pramsey@cleverelephant.ca>

> I'm pleased to report, GEOS 3.0.1 is available:
>
> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>
> This removes a contains bug that has been reported here a couple time
> recently.
>
> P.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081017/95fbc802/attachment.html
From pramsey at cleverelephant.ca  Thu Oct 16 14:36:40 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct 16 14:36:43 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>
Message-ID: <30fe546d0810161136o77bfd9gbff4fc62112a19f4@mail.gmail.com>

Confirmed.

P

On Thu, Oct 16, 2008 at 11:08 AM, Sanak <geosanak@gmail.com> wrote:
> Following link archive seems to be some old revision. (It is difference from
> svn 3.0.1 tags in  io/CLocalizer.cpp .etc).
>
> Could anyone confirm the archive?
>
> Regards,
>
> 2008/10/16 Paul Ramsey <pramsey@cleverelephant.ca>
>>
>> I'm pleased to report, GEOS 3.0.1 is available:
>>
>> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>>
>> This removes a contains bug that has been reported here a couple time
>> recently.
>>
>> P.
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From pramsey at cleverelephant.ca  Thu Oct 16 14:40:38 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct 16 14:40:41 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>
Message-ID: <30fe546d0810161140t24865d28w6b713f7558191e2f@mail.gmail.com>

Thanks for the catch. The *archive* is correct, the *tag* is not, I
tagged off of trunk instead of the branch. Hopefully things are better
now.

On Thu, Oct 16, 2008 at 11:08 AM, Sanak <geosanak@gmail.com> wrote:
> Following link archive seems to be some old revision. (It is difference from
> svn 3.0.1 tags in  io/CLocalizer.cpp .etc).
>
> Could anyone confirm the archive?
>
> Regards,
>
> 2008/10/16 Paul Ramsey <pramsey@cleverelephant.ca>
>>
>> I'm pleased to report, GEOS 3.0.1 is available:
>>
>> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>>
>> This removes a contains bug that has been reported here a couple time
>> recently.
>>
>> P.
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From grof at rogers.com  Thu Oct 16 14:47:46 2008
From: grof at rogers.com (Andrew Ross)
Date: Thu Oct 16 14:54:29 2008
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program
In-Reply-To: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
References: <30fe546d0810101517w2043ffc7ia79bb2dcf8029fbd@mail.gmail.com>
Message-ID: <010f01c92fbf$ae689bc0$0e00000a@rosan01>

+1

Andrew 

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: October 10, 2008 6:18 PM
To: GEOS Development List
Subject: [geos-devel] Participating in OSGeo Project Sponsorship Program

PSC members,

I'd like to get official approval from you to engage in the OSGeo Project
Sponsorship program. The upshot of the Program is:

http://wiki.osgeo.org/wiki/Project_Sponsorship

- OSGeo acts as the banker, invoicing sponsors and holding funds in trust
- 25% of funds are put towards OSGeo general revenue, for thinks like
promotion and marketing
- The rest is disbursed at *our* direction

Things we might want to direct?

- maintainer to review all outstanding bugs!
- port forward cascaded union and new faster buffer
- investigate multi-platform issues

I am soliciting funds from the PostGIS community in addition to the $5000
Safe Software pledge already generously provided.

Motion on the floor:

- To engage in OSGeo Project Sponsorship program?

+1 Paul
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel

From grof at rogers.com  Thu Oct 16 15:03:49 2008
From: grof at rogers.com (Andrew Ross)
Date: Thu Oct 16 15:10:32 2008
Subject: [Bulk] [geos-devel] Re: Participating in OSGeo Project
	Sponsorship Program
In-Reply-To: <1F3C01D6E667B64985B9D81FD8AC90DE365A6A9DBE@email1.safe.internal>
References: <20081016160010.AE470E01054@lists.osgeo.org>
	<1F3C01D6E667B64985B9D81FD8AC90DE365A6A9DBE@email1.safe.internal>
Message-ID: <011701c92fc1$ec53ac70$0e00000a@rosan01>

Hi Dale, 
 
You're not alone. I'd like to share that Ingres is contributing development
resources as planned.
 
Andrew

  _____  

From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Dale Lutz
Sent: October 16, 2008 12:25 PM
To: geos-devel@lists.osgeo.org
Subject: [Bulk] [geos-devel] Re: Participating in OSGeo Project Sponsorship
Program



+1 (I'm not sure if my vote was implied by our willingness to sponsor this
which is already known (and unfortunately unmatched), but I'll vote
explicitly and live in fear that Paul will take glee in cancelling
<http://blog.cleverelephant.ca/2008/10/voting-day-in-canada.html> me out...)

 

 

Dale

 

----------------------------------------------------------------------

Dale Lutz              Safe Software Inc.           dale.lutz@safe.com

VP Development         Surrey, BC, CANADA        phone: (604) 501-9985

                       http://www.safe.com         fax: (604) 501-9965

----------------------------------------------------------------------

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081016/b2c4682a/attachment-0001.html
From geosanak at gmail.com  Thu Oct 16 21:18:44 2008
From: geosanak at gmail.com (Sanak)
Date: Thu Oct 16 21:18:45 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <30fe546d0810161140t24865d28w6b713f7558191e2f@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<5f9be0a0810161108i6bff9b34g47bc28146e9c06ae@mail.gmail.com>
	<30fe546d0810161140t24865d28w6b713f7558191e2f@mail.gmail.com>
Message-ID: <5f9be0a0810161818mee76732v2ef64b4c9afa55af@mail.gmail.com>

Paul,

Thank you for your confirmation.

Regards,


2008/10/17 Paul Ramsey <pramsey@cleverelephant.ca>

> Thanks for the catch. The *archive* is correct, the *tag* is not, I
> tagged off of trunk instead of the branch. Hopefully things are better
> now.
>
> On Thu, Oct 16, 2008 at 11:08 AM, Sanak <geosanak@gmail.com> wrote:
> > Following link archive seems to be some old revision. (It is difference
> from
> > svn 3.0.1 tags in  io/CLocalizer.cpp .etc).
> >
> > Could anyone confirm the archive?
> >
> > Regards,
> >
> > 2008/10/16 Paul Ramsey <pramsey@cleverelephant.ca>
> >>
> >> I'm pleased to report, GEOS 3.0.1 is available:
> >>
> >> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
> >>
> >> This removes a contains bug that has been reported here a couple time
> >> recently.
> >>
> >> P.
> >> _______________________________________________
> >> geos-devel mailing list
> >> geos-devel@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081017/062e24c7/attachment.html
From woklist at kyngchaos.com  Thu Oct 16 23:20:58 2008
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu Oct 16 23:21:03 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
Message-ID: <C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>

Um, it looks like libtool was *downgraded* from 1.5.22 (in GEOS 3.0.0)  
to 1.5.16.  Some important OSX features were added somewhere around  
1.5.20 (at least, that's the version in the OSX developer tools on  
10.4, which added multi-arch capabilities to OSX).

I can't easily build a multi-architecture (PPC/Intel) library with  
libtool 1.5.16.  Unless I update libtool from the system (but I'm  
always afraid of breaking something).

On Oct 15, 2008, at 7:34 PM, Paul Ramsey wrote:

> I'm pleased to report, GEOS 3.0.1 is available:
>
> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>
> This removes a contains bug that has been reported here a couple  
> time recently.
>
> P.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

All generalizations are dangerous, even this one.


From pramsey at cleverelephant.ca  Thu Oct 16 23:32:46 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct 16 23:32:48 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
Message-ID: <30fe546d0810162032i375f8551q36fd882be4d87c1@mail.gmail.com>

The different is I built this one on the upload.osgeo.org server,
whereas 3.0.0 was built on the Refractions server. I will see if SAC
will upgrade the libtool on the osgeo server.

P

On Thu, Oct 16, 2008 at 8:20 PM, William Kyngesburye
<woklist@kyngchaos.com> wrote:
> Um, it looks like libtool was *downgraded* from 1.5.22 (in GEOS 3.0.0) to
> 1.5.16.  Some important OSX features were added somewhere around 1.5.20 (at
> least, that's the version in the OSX developer tools on 10.4, which added
> multi-arch capabilities to OSX).
>
> I can't easily build a multi-architecture (PPC/Intel) library with libtool
> 1.5.16.  Unless I update libtool from the system (but I'm always afraid of
> breaking something).
>
> On Oct 15, 2008, at 7:34 PM, Paul Ramsey wrote:
>
>> I'm pleased to report, GEOS 3.0.1 is available:
>>
>> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>>
>> This removes a contains bug that has been reported here a couple time
>> recently.
>>
>> P.
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> All generalizations are dangerous, even this one.
>
>
>
From pramsey at cleverelephant.ca  Fri Oct 17 14:17:39 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 14:17:42 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
Message-ID: <30fe546d0810171117j1d3570c3va9559cd70cce172a@mail.gmail.com>

OK, now it's back to 1.5.26, hopefully that helps.

P

On Thu, Oct 16, 2008 at 8:20 PM, William Kyngesburye
<woklist@kyngchaos.com> wrote:
> Um, it looks like libtool was *downgraded* from 1.5.22 (in GEOS 3.0.0) to
> 1.5.16.  Some important OSX features were added somewhere around 1.5.20 (at
> least, that's the version in the OSX developer tools on 10.4, which added
> multi-arch capabilities to OSX).
>
> I can't easily build a multi-architecture (PPC/Intel) library with libtool
> 1.5.16.  Unless I update libtool from the system (but I'm always afraid of
> breaking something).
>
> On Oct 15, 2008, at 7:34 PM, Paul Ramsey wrote:
>
>> I'm pleased to report, GEOS 3.0.1 is available:
>>
>> http://download.osgeo.org/geos/geos-3.0.1.tar.bz2
>>
>> This removes a contains bug that has been reported here a couple time
>> recently.
>>
>> P.
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> All generalizations are dangerous, even this one.
>
>
>
From woklist at kyngchaos.com  Fri Oct 17 14:31:53 2008
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Fri Oct 17 14:31:55 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <30fe546d0810171117j1d3570c3va9559cd70cce172a@mail.gmail.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
	<30fe546d0810171117j1d3570c3va9559cd70cce172a@mail.gmail.com>
Message-ID: <A7A78916-B8C7-42AA-97B7-C2DADDA93B3F@kyngchaos.com>

Thanks.  Looks like you repackaged GEOS 3.0.1.  Cool.

On Oct 17, 2008, at 1:17 PM, Paul Ramsey wrote:

> OK, now it's back to 1.5.26, hopefully that helps.
>
> P
>
> On Thu, Oct 16, 2008 at 8:20 PM, William Kyngesburye
> <woklist@kyngchaos.com> wrote:
>> Um, it looks like libtool was *downgraded* from 1.5.22 (in GEOS  
>> 3.0.0) to
>> 1.5.16.  Some important OSX features were added somewhere around  
>> 1.5.20 (at
>> least, that's the version in the OSX developer tools on 10.4, which  
>> added
>> multi-arch capabilities to OSX).
>>
>> I can't easily build a multi-architecture (PPC/Intel) library with  
>> libtool
>> 1.5.16.  Unless I update libtool from the system (but I'm always  
>> afraid of
>> breaking something).
>>
>>

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Those people who most want to rule people are, ipso-facto, those  
least suited to do it."

- A rule of the universe, from the HitchHiker's Guide to the Galaxy


From warmerdam at pobox.com  Fri Oct 17 14:36:42 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Oct 17 14:37:03 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <1224180757.4045.2.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
Message-ID: <48F8DB3A.1080405@pobox.com>

Chuck Thibert wrote:
> Hello all,
> 
> Thanks for the feedback on my initial proposal.  I have updated the
> proposal with said feedback and posted an official RFC on Trac at:
> 
> http://trac.osgeo.org/geos/wiki/RFC3

Chuck,

It looks good, but I would like to stress the value of providing actual
prototypes for a few of the new functions (especially the initialization
and cleanup functions) to make it more clear what would happen.

I'd also like to see the RFC declaring that the _r versions will be the
preferred API going into the future, with the old API being deprecated
and eliminated in the distant future (perhaps GEOS 4 or GEOS 5).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Oct 17 14:38:52 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Oct 17 14:39:17 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <A7A78916-B8C7-42AA-97B7-C2DADDA93B3F@kyngchaos.com>
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
	<30fe546d0810171117j1d3570c3va9559cd70cce172a@mail.gmail.com>
	<A7A78916-B8C7-42AA-97B7-C2DADDA93B3F@kyngchaos.com>
Message-ID: <48F8DBBC.9050304@pobox.com>

William Kyngesburye wrote:
> Thanks.  Looks like you repackaged GEOS 3.0.1.  Cool.
> 
> On Oct 17, 2008, at 1:17 PM, Paul Ramsey wrote:
> 
>> OK, now it's back to 1.5.26, hopefully that helps.
>>
>> P

Paul,

Speaking as someone who has in the past repackaged releases and then
suffered substantial criticism from "downstream", I'd encourage you to
actually issue updates as 3.0.2 and so forth even if only updating stuff
like libtool.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pramsey at cleverelephant.ca  Fri Oct 17 14:43:15 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 14:43:18 2008
Subject: [geos-devel] Re: Package numbering...
Message-ID: <30fe546d0810171143q15472ba6m30650d4da6598925@mail.gmail.com>

3.0.2 or 3.0.1-1?

P.

On Fri, Oct 17, 2008 at 11:38 AM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> William Kyngesburye wrote:
>>
>> Thanks.  Looks like you repackaged GEOS 3.0.1.  Cool.
>>
>> On Oct 17, 2008, at 1:17 PM, Paul Ramsey wrote:
>>
>>> OK, now it's back to 1.5.26, hopefully that helps.
>>>
>>> P
>
> Paul,
>
> Speaking as someone who has in the past repackaged releases and then
> suffered substantial criticism from "downstream", I'd encourage you to
> actually issue updates as 3.0.2 and so forth even if only updating stuff
> like libtool.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From charles.thibert at ingres.com  Fri Oct 17 14:49:50 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Fri Oct 17 14:49:53 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <48F8DB3A.1080405@pobox.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
Message-ID: <1224269390.3370.6.camel@localhost.localdomain>

RFC updated.

Thanks Frank.

Chuck


On Fri, 2008-10-17 at 14:36 -0400, Frank Warmerdam wrote:
> Chuck Thibert wrote:
> > Hello all,
> > 
> > Thanks for the feedback on my initial proposal.  I have updated the
> > proposal with said feedback and posted an official RFC on Trac at:
> > 
> > http://trac.osgeo.org/geos/wiki/RFC3
> 
> Chuck,
> 
> It looks good, but I would like to stress the value of providing actual
> prototypes for a few of the new functions (especially the initialization
> and cleanup functions) to make it more clear what would happen.
> 
> I'd also like to see the RFC declaring that the _r versions will be the
> preferred API going into the future, with the old API being deprecated
> and eliminated in the distant future (perhaps GEOS 4 or GEOS 5).
> 
> Best regards,
From pramsey at cleverelephant.ca  Fri Oct 17 14:51:54 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 14:51:57 2008
Subject: [geos-devel] 3.0.2
Message-ID: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>

Release with libtool updated to 1.5.26
From warmerdam at pobox.com  Fri Oct 17 15:06:49 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Oct 17 15:07:09 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <1224269390.3370.6.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
Message-ID: <48F8E249.2070602@pobox.com>

Chuck Thibert wrote:
> RFC updated.
> 

Chuck,

I notice that the application still needs to pass a pointer to a
GEOSContextHandle_t structure into initGEOS_r() instead of having
initGEOS_r() allocate the structure internally.  Was there a reason for
this?  As I mentioned before, I think this makes the interface brittle
in the sense that the application code has to be recompiled any time
the contents of the context structure change.  My suggested alternative
is:

   GEOSContextHandle_t initGEOS_r( GEOSMessageHandler notice_function,
                                   GEOSMessageHandler error_function);

I'd add that I'd like the RFC to define the context of the context
structure.  I also think that the application visible handle should be
declared:

   type void *GEOSContextHandle_t;

so that it would be passed around as a value rather than a pointer.  This
isn't really very important, but I think it makes the opaqueness of the
handle clearer.  This is the same model used by all the handles for objects
in the GDAL and OGR C APIs for instance.

Last, I *think* that the _r appended to some C library functions implies
reentrancy, while I think this RFC aimed only at thread-safety.  If that
is the case the original idea of appending _TS might be better than _r to
avoid fooling people into thinking the C API is reentrant (that is that
multiple threads could operate on the same context at the same time).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Oct 17 15:20:20 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Oct 17 15:20:41 2008
Subject: [geos-devel] Re: Package numbering...
In-Reply-To: <30fe546d0810171143q15472ba6m30650d4da6598925@mail.gmail.com>
References: <30fe546d0810171143q15472ba6m30650d4da6598925@mail.gmail.com>
Message-ID: <48F8E574.5020901@pobox.com>

Paul Ramsey wrote:
> 3.0.2 or 3.0.1-1?

Paul,

The 3.0.1-1, and 3.0.1-2 would normally indicate particular packaging
attempts against a fixed 3.0.1 source tarball.  So the "dash series" is
really naming reserved for packagers (Debian, OSGeo4W, etc) rather than
source releases from the projects.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From hobu.inc at gmail.com  Fri Oct 17 15:25:03 2008
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Oct 17 15:26:20 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <48F8E249.2070602@pobox.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
	<48F8E249.2070602@pobox.com>
Message-ID: <43F6AEC5-273F-4027-AB2A-BF671D9B5E29@gmail.com>


On Oct 17, 2008, at 2:06 PM, Frank Warmerdam wrote:
>
> I'd add that I'd like the RFC to define the context of the context
> structure.  I also think that the application visible handle should be
> declared:
>
>  type void *GEOSContextHandle_t;


I would suggest we change this to:

    typedef struct GEOSContextHandle_HS *GEOSContextHandle_t;

which makes it easier for the compiler to catch when we pass in an  
incorrect pointer.  For GDAL/OGR, if you compile with -DDEBUG, this  
pattern is currently applied, but it is not otherwise because we  
didn't want to risk breaking existing client code.

Howard

From charles.thibert at ingres.com  Fri Oct 17 15:38:18 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Fri Oct 17 15:38:20 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <48F8E249.2070602@pobox.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
	<48F8E249.2070602@pobox.com>
Message-ID: <1224272298.3370.23.camel@localhost.localdomain>

Thanks for the comments again Frank.  I appreciate the time put into
reviewing this.

I'll illustrate the handle better.  I was thinking along the same lines
as you were, just assuming too much and not specifying.

I was assuming the pointer being passed to initGEOS would be empty and
allocated by initGEOS.  Probably just me being more used to passing
variables to be allocated instead of returning them.  I'm not opposed to
the way you have it and will update it.

The _r was a comment from Mark Cave-Ayland.  I agree it usually means
re-entrant.  I've been torn on how to name this as I'm not going for
re-entrancy but it is 'more standard.'  Mark, it was your comment,
rebuttal? :) Otherwise I think I'll go back to TS since I'm not
guaranteeing re-entrance.

Thanks,
Chuck


On Fri, 2008-10-17 at 15:06 -0400, Frank Warmerdam wrote:
> Chuck Thibert wrote:
> > RFC updated.
> > 
> 
> Chuck,
> 
> I notice that the application still needs to pass a pointer to a
> GEOSContextHandle_t structure into initGEOS_r() instead of having
> initGEOS_r() allocate the structure internally.  Was there a reason for
> this?  As I mentioned before, I think this makes the interface brittle
> in the sense that the application code has to be recompiled any time
> the contents of the context structure change.  My suggested alternative
> is:
> 
>    GEOSContextHandle_t initGEOS_r( GEOSMessageHandler notice_function,
>                                    GEOSMessageHandler error_function);
> 
> I'd add that I'd like the RFC to define the context of the context
> structure.  I also think that the application visible handle should be
> declared:
> 
>    type void *GEOSContextHandle_t;
> 
> so that it would be passed around as a value rather than a pointer.  This
> isn't really very important, but I think it makes the opaqueness of the
> handle clearer.  This is the same model used by all the handles for objects
> in the GDAL and OGR C APIs for instance.
> 
> Last, I *think* that the _r appended to some C library functions implies
> reentrancy, while I think this RFC aimed only at thread-safety.  If that
> is the case the original idea of appending _TS might be better than _r to
> avoid fooling people into thinking the C API is reentrant (that is that
> multiple threads could operate on the same context at the same time).
> 
> Best regards,
From charles.thibert at ingres.com  Fri Oct 17 15:39:56 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Fri Oct 17 15:39:57 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <43F6AEC5-273F-4027-AB2A-BF671D9B5E29@gmail.com>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
	<48F8E249.2070602@pobox.com>
	<43F6AEC5-273F-4027-AB2A-BF671D9B5E29@gmail.com>
Message-ID: <1224272396.3370.25.camel@localhost.localdomain>

I like it when the compiler can catch my mistakes. :) I've not seen _HS
before.  Does it mean something particular?

Chuck


On Fri, 2008-10-17 at 14:25 -0500, Howard Butler wrote:
> On Oct 17, 2008, at 2:06 PM, Frank Warmerdam wrote:
> >
> > I'd add that I'd like the RFC to define the context of the context
> > structure.  I also think that the application visible handle should be
> > declared:
> >
> >  type void *GEOSContextHandle_t;
> 
> 
> I would suggest we change this to:
> 
>     typedef struct GEOSContextHandle_HS *GEOSContextHandle_t;
> 
> which makes it easier for the compiler to catch when we pass in an  
> incorrect pointer.  For GDAL/OGR, if you compile with -DDEBUG, this  
> pattern is currently applied, but it is not otherwise because we  
> didn't want to risk breaking existing client code.
> 
> Howard
> 
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
From schwehr at ccom.unh.edu  Fri Oct 17 16:16:49 2008
From: schwehr at ccom.unh.edu (Kurt Schwehr)
Date: Fri Oct 17 16:48:55 2008
Subject: [geos-devel] Repackaging releases
In-Reply-To: <20081017192621.45050E00E65@lists.osgeo.org>
References: <20081017192621.45050E00E65@lists.osgeo.org>
Message-ID: <1FA945F7-785C-4251-B832-978B13E39DF5@ccom.unh.edu>

The joys of software release :)

As a packager of geos in fink, I would suggest going to 3.0.2.  Using  
the -1 -2 -3 series will get confusing at best.  Tars that change  
make things happen that confuse the packagers, the users, and the  
mirroring systems.

Thanks,
-kurt


> OK, now it's back to 1.5.26, hopefully that helps.
>
> P
>
>
>>>
> Paul,
>
> Speaking as someone who has in the past repackaged releases and then
> suffered substantial criticism from "downstream", I'd encourage you to
> actually issue updates as 3.0.2 and so forth even if only updating  
> stuff
> like libtool.
>
>
> 3.0.2 or 3.0.1-1?
>
> P.
>
>
> The 3.0.1-1, and 3.0.1-2 would normally indicate particular packaging
> attempts against a fixed 3.0.1 source tarball.  So the "dash  
> series" is
> really naming reserved for packagers (Debian, OSGeo4W, etc) rather  
> than
> source releases from the projects.
>
>
From ramercer at gmail.com  Fri Oct 17 18:03:57 2008
From: ramercer at gmail.com (Adam Mercer)
Date: Fri Oct 17 18:04:00 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
Message-ID: <799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>

On Fri, Oct 17, 2008 at 13:51, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> Release with libtool updated to 1.5.26

When untarred this produces a directory called geos-3.0.1.

Cheers

Adam
From pramsey at cleverelephant.ca  Fri Oct 17 18:08:29 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 18:08:31 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
Message-ID: <30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>

Onward, to 3.0.3!

On Fri, Oct 17, 2008 at 3:03 PM, Adam Mercer <ramercer@gmail.com> wrote:
> On Fri, Oct 17, 2008 at 13:51, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>> Release with libtool updated to 1.5.26
>
> When untarred this produces a directory called geos-3.0.1.
>
> Cheers
>
> Adam
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From gdt at ir.bbn.com  Fri Oct 17 18:18:13 2008
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri Oct 17 18:18:15 2008
Subject: [geos-devel] GEOS 3.0.1
In-Reply-To: <48F8DBBC.9050304@pobox.com> (Frank Warmerdam's message of "Fri, 
	17 Oct 2008 14:38:52 -0400")
References: <30fe546d0810151734u1d05d8e2j63b726d45411351a@mail.gmail.com>
	<C0C97F3E-B073-409A-80B1-3B7171DE1ED2@kyngchaos.com>
	<30fe546d0810171117j1d3570c3va9559cd70cce172a@mail.gmail.com>
	<A7A78916-B8C7-42AA-97B7-C2DADDA93B3F@kyngchaos.com>
	<48F8DBBC.9050304@pobox.com>
Message-ID: <rmi7i86euhm.fsf@fnord.ir.bbn.com>


Frank Warmerdam <warmerdam@pobox.com> writes:

> William Kyngesburye wrote:
>> Thanks.  Looks like you repackaged GEOS 3.0.1.  Cool.
>>
>> On Oct 17, 2008, at 1:17 PM, Paul Ramsey wrote:
>>
>>> OK, now it's back to 1.5.26, hopefully that helps.
>>>
>>> P
>
> Speaking as someone who has in the past repackaged releases and then
> suffered substantial criticism from "downstream", I'd encourage you to
> actually issue updates as 3.0.2 and so forth even if only updating stuff
> like libtool.

As one of those downstream packagers, I'll second this.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 193 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081017/db471c77/attachment.bin
From pramsey at cleverelephant.ca  Fri Oct 17 18:18:20 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 18:18:22 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
	<30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
Message-ID: <30fe546d0810171518x70b9975fp20663a680b888a10@mail.gmail.com>

I left the number at 3.0.2, to heck with the downstream.
I'll probably be patching up to 3.0.3 shortly anyways, since 3.0 isnt'
compiling with new compilers in debian.

On Fri, Oct 17, 2008 at 3:08 PM, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
> Onward, to 3.0.3!
>
> On Fri, Oct 17, 2008 at 3:03 PM, Adam Mercer <ramercer@gmail.com> wrote:
>> On Fri, Oct 17, 2008 at 13:51, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>>> Release with libtool updated to 1.5.26
>>
>> When untarred this produces a directory called geos-3.0.1.
>>
>> Cheers
>>
>> Adam
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>
From chodgson at refractions.net  Fri Oct 17 18:19:18 2008
From: chodgson at refractions.net (Chris Hodgson)
Date: Fri Oct 17 18:19:12 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
	<30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
Message-ID: <48F90F66.8010508@refractions.net>

Is this why some projects do RCs? ;)

3.0.1RC1, 3.0.1RC2, 3.0.1RC3?

Or was Frank only suggesting this for the 3.1.0 level of release?

Would these little issues happening in an RC-release cause less problems 
for packagers? At least it would save us the "version creep" (if we care).

I'm sure the last thing Paul needs is another person nitpicking the 
release process... but I wanted to throw my 2c in.

Chris

Paul Ramsey wrote:
> Onward, to 3.0.3!
>
> On Fri, Oct 17, 2008 at 3:03 PM, Adam Mercer <ramercer@gmail.com> wrote:
>   
>> On Fri, Oct 17, 2008 at 13:51, Paul Ramsey <pramsey@cleverelephant.ca> wrote:
>>     
>>> Release with libtool updated to 1.5.26
>>>       
>> When untarred this produces a directory called geos-3.0.1.
>>
>> Cheers
>>
>> Adam
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>     
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>   

From gdt at ir.bbn.com  Fri Oct 17 18:32:23 2008
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri Oct 17 18:32:24 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <48F90F66.8010508@refractions.net> (Chris Hodgson's message of
	"Fri, 17 Oct 2008 15:19:18 -0700")
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
	<30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
	<48F90F66.8010508@refractions.net>
Message-ID: <rmi3aiuetu0.fsf@fnord.ir.bbn.com>


Chris Hodgson <chodgson@refractions.net> writes:

> Is this why some projects do RCs? ;)
>
> 3.0.1RC1, 3.0.1RC2, 3.0.1RC3?
>
> Or was Frank only suggesting this for the 3.1.0 level of release?
>
> Would these little issues happening in an RC-release cause less
> problems for packagers? At least it would save us the "version creep"
> (if we care).

(Speaking as the pkgsrc maintainer for geos and postgis.)

The issue is that once there is a foo-x.y.z.tar.gz out there (a
'distfile' in pkgsrc speak), and a packaging system references it, a
checksum of the distfile is stored and the wrapper build scripts are
tuned to that particular exact distfile.  Then mirror sites fetch the
distfile and store it.  If the distfile changes, the checksum will not
match.  To work around the file changing, in pkgsrc we assign
DIST_SUBDIR to a new directory so that the old cached contents will be
ignore.

I don't have any problem with "version creep"; we have an infinite
supply of even small integers.  I don't think it matters much if one
uses an rcN suffix or just increments the numbers.

In this case, it seems 3.0.2 has been regenerated with the right dir, so
I'll just package that - because I didn't package the older 3.0.2 it
doesn't matter.


pkgsrc guide says:

  19.2.2. How to handle modified distfiles with the 'old' name

  Sometimes authors of a software package make some modifications after
  the software was released, and they put up a new distfile without
  changing the package's version number. If a package is already in
  pkgsrc at that time, the checksum will no longer match. The contents
  of the new distfile should be compared against the old one before
  changing anything, to make sure the distfile was really updated on
  purpose, and that no trojan horse or so crept in. Please mention that
  the distfiles were compared and what was found in your commit
  message. Then, the correct way to work around this is to set
  DIST_SUBDIR to a unique directory name, usually based on
  PKGNAME_NOREV. All DISTFILES and PATCHFILES for this package will be
  put in that subdirectory of the local distfiles directory. (See
  Section 19.1.11, "How to handle incrementing versions when fixing an
  existing package" for more details.) In case this happens more often,
  PKGNAME can be used (thus including the nbX suffix) or a date stamp
  can be appended, like ${PKGNAME_NOREV}-YYYYMMDD. Do not forget
  regenerating the distinfo file after that, since it contains the
  DIST_SUBDIR path in the filenames. Also increase the PKGREVISION if
  the installed package is different.  Furthermore, a mail to the
  package's authors seems appropriate telling them that changing
  distfiles after releases without changing the file names is not good
  practice.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 193 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081017/3fbdd127/attachment-0001.bin
From pramsey at cleverelephant.ca  Fri Oct 17 18:40:12 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 17 18:40:13 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <rmi3aiuetu0.fsf@fnord.ir.bbn.com>
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
	<30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
	<48F90F66.8010508@refractions.net> <rmi3aiuetu0.fsf@fnord.ir.bbn.com>
Message-ID: <30fe546d0810171540n2e0e9774u322afd91455e3a0b@mail.gmail.com>

What's the "10 second rule" for dropped releases? :)

P

On Fri, Oct 17, 2008 at 3:32 PM, Greg Troxel <gdt@ir.bbn.com> wrote:
>> Is this why some projects do RCs? ;)
>>
>> 3.0.1RC1, 3.0.1RC2, 3.0.1RC3?
>>
>> Or was Frank only suggesting this for the 3.1.0 level of release?
>>
>> Would these little issues happening in an RC-release cause less
>> problems for packagers? At least it would save us the "version creep"
>> (if we care).
>
> (Speaking as the pkgsrc maintainer for geos and postgis.)
>
> The issue is that once there is a foo-x.y.z.tar.gz out there (a
> 'distfile' in pkgsrc speak), and a packaging system references it, a
> checksum of the distfile is stored and the wrapper build scripts are
> tuned to that particular exact distfile.  Then mirror sites fetch the
> distfile and store it.  If the distfile changes, the checksum will not
> match.  To work around the file changing, in pkgsrc we assign
> DIST_SUBDIR to a new directory so that the old cached contents will be
> ignore.
>
> I don't have any problem with "version creep"; we have an infinite
> supply of even small integers.  I don't think it matters much if one
> uses an rcN suffix or just increments the numbers.
>
> In this case, it seems 3.0.2 has been regenerated with the right dir, so
> I'll just package that - because I didn't package the older 3.0.2 it
> doesn't matter.
>
>
> pkgsrc guide says:
>
>  19.2.2. How to handle modified distfiles with the 'old' name
>
>  Sometimes authors of a software package make some modifications after
>  the software was released, and they put up a new distfile without
>  changing the package's version number. If a package is already in
>  pkgsrc at that time, the checksum will no longer match. The contents
>  of the new distfile should be compared against the old one before
>  changing anything, to make sure the distfile was really updated on
>  purpose, and that no trojan horse or so crept in. Please mention that
>  the distfiles were compared and what was found in your commit
>  message. Then, the correct way to work around this is to set
>  DIST_SUBDIR to a unique directory name, usually based on
>  PKGNAME_NOREV. All DISTFILES and PATCHFILES for this package will be
>  put in that subdirectory of the local distfiles directory. (See
>  Section 19.1.11, "How to handle incrementing versions when fixing an
>  existing package" for more details.) In case this happens more often,
>  PKGNAME can be used (thus including the nbX suffix) or a date stamp
>  can be appended, like ${PKGNAME_NOREV}-YYYYMMDD. Do not forget
>  regenerating the distinfo file after that, since it contains the
>  DIST_SUBDIR path in the filenames. Also increase the PKGREVISION if
>  the installed package is different.  Furthermore, a mail to the
>  package's authors seems appropriate telling them that changing
>  distfiles after releases without changing the file names is not good
>  practice.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From gdt at ir.bbn.com  Fri Oct 17 19:19:52 2008
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri Oct 17 19:19:54 2008
Subject: [geos-devel] 3.0.2
In-Reply-To: <30fe546d0810171540n2e0e9774u322afd91455e3a0b@mail.gmail.com>
	(Paul Ramsey's message of "Fri, 17 Oct 2008 15:40:12 -0700")
References: <30fe546d0810171151u37d1169dnd55978ef229d40b4@mail.gmail.com>
	<799406d60810171503n1a29117ei26b0c38271889aff@mail.gmail.com>
	<30fe546d0810171508j57bd31f3j71288cc3f843b73a@mail.gmail.com>
	<48F90F66.8010508@refractions.net> <rmi3aiuetu0.fsf@fnord.ir.bbn.com>
	<30fe546d0810171540n2e0e9774u322afd91455e3a0b@mail.gmail.com>
Message-ID: <rmiljwmdd2f.fsf@fnord.ir.bbn.com>


  What's the "10 second rule" for dropped releases? :)

Fair enough, I think I'm touchy because this happened recently for
something eles perhaps totally unrelated.

Now for something perhaps useful:

I have updated pkgsrc to geos 3.0.2.  On NetBSD-current/i386 It builds
fine and runs "gmake check" without errors.

I did get some warnings during the build, including:

 "[] has virtual functions but non-virtual destructor"
 "converting to non-pointer type 'char' from NULL"

I put up a full build log in case anyone wants to see the details

  http://www.lexort.com/pkgsrc/geos-3.0.2-buildlog.txt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 193 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081017/c09cf585/attachment.bin
From mark.cave-ayland at ilande.co.uk  Sat Oct 18 03:28:10 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Sat Oct 18 03:28:14 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <1224272298.3370.23.camel@localhost.localdomain>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
	<48F8E249.2070602@pobox.com>
	<1224272298.3370.23.camel@localhost.localdomain>
Message-ID: <34839.82.189.249.150.1224314890.squirrel@www.ilande.co.uk>

> Thanks for the comments again Frank.  I appreciate the time put into
> reviewing this.
>
> I'll illustrate the handle better.  I was thinking along the same lines
> as you were, just assuming too much and not specifying.
>
> I was assuming the pointer being passed to initGEOS would be empty and
> allocated by initGEOS.  Probably just me being more used to passing
> variables to be allocated instead of returning them.  I'm not opposed to
> the way you have it and will update it.
>
> The _r was a comment from Mark Cave-Ayland.  I agree it usually means
> re-entrant.  I've been torn on how to name this as I'm not going for
> re-entrancy but it is 'more standard.'  Mark, it was your comment,
> rebuttal? :) Otherwise I think I'll go back to TS since I'm not
> guaranteeing re-entrance.

Heh, of course ;)

Well the definition is fairly woolly as a quick search revealed that the
distinction between thread safety and re-entrancy is not always apparent
in various descriptions of the functions. Probably the best descriptions I
found were here:

http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.genprogc/doc/genprogc/writing_reentrant_thread_safe_code.htm
http://www.ibm.com/developerworks/linux/library/l-reent.html

These basically describe a re-entrant function as one that does not hold
static data across successive calls, or return a pointer to static data.
So you could argue that since the static data will be held outside of the
function (and it is not modified by the function) then it is re-entrant
and thus qualifies for the _r suffix.

Then again, I will confess up front that I don't do much in the way of
multi-threaded programming and so this was just my interpretation of the
above and other random sources located using Google.


ATB,

Mark.


From robe.dnd at cityofboston.gov  Sun Oct 19 08:44:43 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Sun Oct 19 08:44:47 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E2A37E@ZDND.DND.boston.cob><30fe546d0810170827j49fd5e2en6987f232db5d246a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob>
	<30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob>

Paul,

Sounds like a plan.  

Regarding the kml failure.  I tried to be lazy by

1) copying my Open SUSE 11 vm.
2) downgrade to 1.3.3
3) ran make check and it failed on kml check again.  So I assume the kml thing is nothing to worry about.
(But oops wait a minute reads 1.3.3 with GEOS 3.1.0.  I assume KML doesn't use GEOS so that wouldn't affect things, but just to be sure, I tried to downgrade to geos 3.0.0 and couldn't because got this error during compile

DoubleBits.cpp: In constructor 'geos::index::quadtree::DoubleBits::DoubleBits(double)':
DoubleBits.cpp:94: error: 'memcpy' was not declared in this scope
make[3]: *** [DoubleBits.lo] Error 1
make[3]: Leaving directory `/projects/geos-3.0.0/source/index/quadtree'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/projects/geos-3.0.0/source/index'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/projects/geos-3.0.0/source'
make: *** [all-recursive] Error 1


4) Okay that didn't work so I went to http://download.osgeo.org/geos/geos-3.0.2.tar.bz2  - still no go
 g++ -DHAVE_CONFIG_H -I. -I. -I../../../source/headers -I../../../source/headers/geos -I../../../source/headers -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT DoubleBits.lo -MD -MP -MF .deps/DoubleBits.Tpo -c DoubleBits.cpp  -fPIC -DPIC -o .libs/DoubleBits.o
DoubleBits.cpp: In static member function ?static double geos::index::quadtree::DoubleBits::powerOf2(int)?:
DoubleBits.cpp:51: error: ?memcpy? was not declared in this scope
DoubleBits.cpp: In constructor ?geos::index::quadtree::DoubleBits::DoubleBits(double)?:
DoubleBits.cpp:94: error: ?memcpy? was not declared in this scope
make[3]: *** [DoubleBits.lo] Error 1
make[3]: Leaving directory `/projects/geos-3.0.2/source/index/quadtree'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/projects/geos-3.0.2/source/index'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/projects/geos-3.0.2/source'
make: *** [all-recursive] Error 1

Not quite sure what the above errors mean? Probably that compiling should be left to people who know what they are doing.  I think I was able to compile these on my OpenSUSE 10.5, but I'll have to double check.  I can only wildly guess this is all due to me using a dev version of gcc.

gcc -v gives this info

Using built-in specs.
Target: i586-suse-linux
Configured with: ../configure --prefix=/usr --with-local-prefix=/usr/local --infodir=/usr/share/info --mandir=/usr/share/man --libdir=/usr/lib --libexecdir=/usr/lib --enable-languages=c,c++,objc,fortran,obj-c++,java,ada --enable-checking=release --with-gxx-include-dir=/usr/include/c++/4.3 --enable-ssp --disable-libssp --with-bugurl=http://bugs.opensuse.org/ --with-pkgversion='SUSE Linux' --disable-libgcj --with-slibdir=/lib --with-system-zlib --enable-__cxa_atexit --enable-libstdcxx-allocator=new --disable-libstdcxx-pch --program-suffix=-4.3 --enable-version-specific-runtime-libs --enable-linux-futex --without-system-libunwind --with-cpu=generic --build=i586-suse-linux
Thread model: posix
gcc version 4.3.1 20080507 (prerelease) [gcc-4_3-branch revision 135036] (SUSE Linux) 


5) Okay so I then went back redownloaded geos-svn.tar.gz to make sure I could still compile that.  That still compiles fine, but does give some deprecation warnings which I'm assuming you are all aware of.

	then mv -f ".deps/MarkupSTL.Tpo" ".deps/MarkupSTL.Po"; else rm -f ".deps/MarkupSTL.Tpo"; exit 1; fi
markup/MarkupSTL.cpp: In member function ?std::string CMarkupSTL::x_TextToDoc(const char*, bool) const?:
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp: In member function ?std::string CMarkupSTL::x_TextFromDoc(int, int) const?:
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string constant to ?char*?
markup/MarkupSTL.cpp:941: warning: deprecated conversion from string constant to ?char*?
/bin/sh ../../libtool --tag=CXX --mode=link g++  -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long   -o XMLTester  XMLTester.o MarkupSTL.o ../../source/libgeos.la ../../source/libgeos.la
mkdir .libs
g++ -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -o .libs/XMLTester XMLTester.o MarkupSTL.o  ../../source/.libs/libgeos.so 
creating XMLTester
if g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers -I../../source/headers/geos -I../../source/headers -I../../source/io/markup    -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -MT SimpleWKTTester.o -MD -MP -MF ".deps/SimpleWKTTester.Tpo" -c -o SimpleWKTTester.o SimpleWKTTester.cpp; \
	then mv -f ".deps/SimpleWKTTester.Tpo" ".deps/SimpleWKTTester.Po"; else rm -f ".deps/SimpleWKTTester.Tpo"; exit 1; fi
In file included from SimpleWKTTester.cpp:23:
../../source/headers/geos/io.h:62:2: warning: #warning is a GCC extension
../../source/headers/geos/io.h:62:2: warning: #warning *** DEPRECATED: You are using deprecated header io.h. Please, update your sources according to new layout of GEOS headers and namespaces
In file included from SimpleWKTTester.cpp:24:
../../source/headers/geos/geom.h:145:2: warning: #warning is a GCC extension
../../source/headers/geos/geom.h:145:2: warning: #warning *** DEPRECATED: You are using deprecated header geom.h. Please, update your sources according to new layout of GEOS headers and namespaces
/bin/sh ../../libtool --tag=CXX --mode=link g++  -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long   -o SimpleWKTTester  SimpleWKTTester.o ../../source/libgeos.la ../../source/libgeos.la
g++ -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long -o .libs/SimpleWKTTester SimpleWKTTester.o  ../../source/.libs/libgeos.so 
creating SimpleWKTTester


I guess this is what I get for trying to live on the edge virtually.  Good thing I don't try to do these things in real life :)


Thanks,
Regina



-----Original Message-----
From: postgis-devel-bounces@postgis.refractions.net on behalf of Paul Ramsey
Sent: Sat 10/18/2008 1:47 PM
To: PostGIS Development Discussion
Subject: Re: [postgis-devel] 1, dot, 3 dot 4!
 
All,

I'm going to put out a 1.3.4RC1, ala FrankW's recommendation and see
if we can shake loose a little more testing and then drop the final
1.3.4 mid next week.

Howl in outrage if you disagree, please.

P.
_______________________________________________
postgis-devel mailing list
postgis-devel@postgis.refractions.net
http://postgis.refractions.net/mailman/listinfo/postgis-devel










-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081019/f815bee8/attachment.html
From mark.cave-ayland at ilande.co.uk  Sun Oct 19 16:48:56 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Sun Oct 19 16:49:02 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
Message-ID: <1224449336.8415.9.camel@mca-desktop>

Hi everyone,

I've started looking at compiling the latest versions of GEOS/PostGIS
for the Win32 installers and have found that the latest GEOS 3.0.2 does
not compile.

The issue is that GEOS is compiled using the -ansi flag, and since the
new CLocalizer.cpp file uses strdup() which is not an ANSI function then
the build blows up. Interestingly enough, it will build for me on Linux
so I have no idea why MingW in particular is much more strict about
this.

Note that before we have been able to add some definitions protected by
-ansi by copying the definitions from the header files. Unfortunately
while this allows the compile to proceed, the link fails with an
undefined symbol error and so I guess there is trickery further down
within the MingW runtimes to prevent these symbols from even being
visible in ANSI mode :(

My current solution is the attached patch which works by replacing
strdup() with a simple malloc() and strcpy() to preserve the old locale.
Note that this will almost certainly need to be applied to the 3.1
branch too, although I haven't got as far as trying to compile it on
Win32 - yet ;)


ATB,

Mark.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos-3.0.2-strdup.patch
Type: text/x-patch
Size: 800 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081019/0dbb0644/geos-3.0.2-strdup.bin
From mark.cave-ayland at ilande.co.uk  Sun Oct 19 17:01:09 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Sun Oct 19 17:01:14 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <1224449336.8415.9.camel@mca-desktop>
References: <1224449336.8415.9.camel@mca-desktop>
Message-ID: <1224450069.8415.16.camel@mca-desktop>

On Sun, 2008-10-19 at 21:48 +0100, Mark Cave-Ayland wrote:

> My current solution is the attached patch which works by replacing
> strdup() with a simple malloc() and strcpy() to preserve the old locale.
> Note that this will almost certainly need to be applied to the 3.1
> branch too, although I haven't got as far as trying to compile it on
> Win32 - yet ;)

And as if by magic:
http://trac.osgeo.org/geos/ticket/212

Cool. In that case, please can this be backported to the 3.0 branch? And
I think we also need to backport the gcc-4.3 fixes since Debian and SUSE
are now using gcc-4.3 by default (see
http://postgis.refractions.net/pipermail/postgis-devel/2008-October/003939.html for the SUSE confirmation, and my local machine as of 2 hours ago is the Debian Lenny confirmation).


ATB,

Mark.


From robe.dnd at cityofboston.gov  Sun Oct 19 22:33:14 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Sun Oct 19 22:34:06 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob><30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob><48FB5422.3000504@siriusit.co.uk><30fe546d0810191414n94a3dceh631476ed4efdd97a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB9@ZDND.DND.boston.cob>
	<30fe546d0810191833v66d44065p6d358d8cd551a9d@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBB@ZDND.DND.boston.cob>

Allright I'm working on it, but I don't have commit access so I'll just send you the revised patch when I am done.

Thanks,
Regina

-----Original Message-----
From: postgis-devel-bounces@postgis.refractions.net on behalf of Paul Ramsey
Sent: Sun 10/19/2008 9:33 PM
To: PostGIS Development Discussion
Subject: Re: [postgis-devel] 1, dot, 3 dot 4!
 
Well, unless someone else (Mat?) can apply this patch back into 3.0
and test it, or you can work it up Regina, it'll have to wait until I
get home and set up a VM with a new debian in it that has the new gcc.

P

On Sun, Oct 19, 2008 at 4:06 PM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> P,
> that got me further but no go.  Seems to be same issue in an unpatched file
>
>         then mv -f ".deps/ByteOrderValues.Tpo" ".deps/ByteOrderValues.Plo";
> else rm -f ".deps/ByteOrderValues.Tpo"; exit 1; fi
>  g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers
> -I../../source/headers/geos -I../../source/headers -g -O2 -DGEOS_INLINE
> -Wall -ansi -pedantic -Wno-long-long -MT ByteOrderValues.lo -MD -MP -MF
> .deps/ByteOrderValues.Tpo -c ByteOrderValues.cpp  -fPIC -DPIC -o
> .libs/ByteOrderValues.o
> ByteOrderValues.cpp: In static member function 'static double
> geos::io::ByteOrderValues::getDouble(const unsigned char*, int)':
> ByteOrderValues.cpp:139: error: 'memcpy' was not declared in this scope
> ByteOrderValues.cpp: In static member function 'static void
> geos::io::ByteOrderValues::putDouble(double, unsigned char*, int)':
> ByteOrderValues.cpp:147: error: 'memcpy' was not declared in this scope
> make[2]: *** [ByteOrderValues.lo] Error 1
> make[2]: Leaving directory `/projects/geos-3.0.2/source/io'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory `/projects/geos-3.0.2/source'
> make: *** [all-recursive] Error 1
>
>
> Thanks,
>
> Regina
>
>
> -----Original Message-----
> From: postgis-devel-bounces@postgis.refractions.net on behalf of Paul Ramsey
> Sent: Sun 10/19/2008 5:14 PM
> To: PostGIS Development Discussion
> Subject: Re: [postgis-devel] 1, dot, 3 dot 4!
>
> Yes, this has already been fixed on trunk, here's a patch against 3.0,
> let me know if it helps.
>
> P.
>
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing this
> email and join us in saving paper.
>
> _______________________________________________
> postgis-devel mailing list
> postgis-devel@postgis.refractions.net
> http://postgis.refractions.net/mailman/listinfo/postgis-devel
>
>
_______________________________________________
postgis-devel mailing list
postgis-devel@postgis.refractions.net
http://postgis.refractions.net/mailman/listinfo/postgis-devel



-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081019/0611f996/attachment.html
From robe.dnd at cityofboston.gov  Sun Oct 19 23:17:06 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Sun Oct 19 23:20:30 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob><30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob><48FB5422.3000504@siriusit.co.uk><30fe546d0810191414n94a3dceh631476ed4efdd97a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB9@ZDND.DND.boston.cob><30fe546d0810191833v66d44065p6d358d8cd551a9d@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBB@ZDND.DND.boston.cob>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBC@ZDND.DND.boston.cob>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: debianrevised.patch
Type: application/octet-stream
Size: 5291 bytes
Desc: debianrevised.patch
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081019/03fe470b/debianrevised-0001.obj
From robe.dnd at cityofboston.gov  Mon Oct 20 01:29:43 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Mon Oct 20 01:29:49 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob><30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob><48FB5422.3000504@siriusit.co.uk><30fe546d0810191414n94a3dceh631476ed4efdd97a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB9@ZDND.DND.boston.cob><30fe546d0810191833v66d44065p6d358d8cd551a9d@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBB@ZDND.DND.boston.cob>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBC@ZDND.DND.boston.cob>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBD@ZDND.DND.boston.cob>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: debianrevised.patch
Type: application/octet-stream
Size: 11105 bytes
Desc: debianrevised.patch
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081020/526186bf/debianrevised.obj
From mark.cave-ayland at ilande.co.uk  Mon Oct 20 06:11:49 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Mon Oct 20 06:11:51 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBD@ZDND.DND.boston.cob>
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob><30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob><48FB5422.3000504@siriusit.co.uk><30fe546d0810191414n94a3dceh631476ed4efdd97a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB9@ZDND.DND.boston.cob><30fe546d0810191833v66d44065p6d358d8cd551a9d@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBB@ZDND.DND.boston.cob>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBC@ZDND.DND.boston.cob>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBD@ZDND.DND.boston.cob>
Message-ID: <43029.81.187.123.11.1224497509.squirrel@www.ilande.co.uk>

> Okay here is my complete patch.  I'm still fussing with my install to get
> my postgis compile to take the new GEOS (insists on hanging on to the
> 3.1.0), but the GEOS 3.0.2 with the attached seems to compile fine on my
> OpenSUSE 11 vm.

You should be able to nudge this using the --with-geos-config option to
configure which you can use to force PostGIS to use a particular GEOS
installation.

> Like I mentioned before - many file changes, mostly adding headers,
> XMLTester - changing .. to std::.
>
> The only one I'm not really sure about is the CLocalizer one since that
> was so different from trunk and adding the missing top header wasn't
> enough, I just replaced with trunk version.

Yup, exactly the right call - keep them both in sync as much as possible.

> If someone with the new gcc can test this out /Debian etc. that would be
> great.

Way to go Regina!

I just applied your patch to the GEOS 3.0.2 and this fixes compilation
under both Debian Lenny gcc-4.3 and MingW :)

Note: I still see some XMLTester warnings like this:

if g++ -DHAVE_CONFIG_H -I. -I. -I../../source/headers
-I../../source/headers/geos -I../../source/headers
-I../../source/io/markup    -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic
-Wno-long-long -MT MarkupSTL.o -MD -MP -MF ".deps/MarkupSTL.Tpo" -c -o
MarkupSTL.o `test -f 'markup/MarkupSTL.cpp' || echo
'./'`markup/MarkupSTL.cpp; \
        then mv -f ".deps/MarkupSTL.Tpo" ".deps/MarkupSTL.Po"; else rm -f
".deps/MarkupSTL.Tpo"; exit 1; fi
markup/MarkupSTL.cpp: In member function ?std::string
CMarkupSTL::x_TextToDoc(const char*, bool) const?:
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:910: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp: In member function ?std::string
CMarkupSTL::x_TextFromDoc(int, int) const?:
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:939: warning: deprecated conversion from string
constant to ?char*?
markup/MarkupSTL.cpp:941: warning: deprecated conversion from string
constant to ?char*?


I'm not too worried about these as they are outside of the core library,
however I suspect someone with more C++ knowledge would be able to fix
them fairly easily.

Pretty please can we get this applied to the GEOS 3.0 branch, and schedule
either a new 3.0.3 RC or 3.0.3 release within the next couple of weeks?


Many thanks,

Mark.


From robe.dnd at cityofboston.gov  Mon Oct 20 06:58:31 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Mon Oct 20 06:58:35 2008
Subject: [geos-devel] RE: [postgis-devel] 1, dot, 3 dot 4!
In-Reply-To: <43029.81.187.123.11.1224497509.squirrel@www.ilande.co.uk>
References: <30fe546d0810162226t1878065dna07c7778f7566cef@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB5@ZDND.DND.boston.cob><30fe546d0810171651h1a9eeefbga00a5e51bc114b70@mail.gmail.com><48F98C27.409@siriusit.co.uk><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB6@ZDND.DND.boston.cob><30fe546d0810181047w40345795k8cc54d21d90df277@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB8@ZDND.DND.boston.cob><48FB5422.3000504@siriusit.co.uk><30fe546d0810191414n94a3dceh631476ed4efdd97a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFB9@ZDND.DND.boston.cob><30fe546d0810191833v66d44065p6d358d8cd551a9d@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBB@ZDND.DND.boston.cob><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBC@ZDND.DND.boston.cob><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFBD@ZDND.DND.boston.cob>
	<43029.81.187.123.11.1224497509.squirrel@www.ilande.co.uk>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204E2A9DE@ZDND.DND.boston.cob>

Mark,
> Way to go Regina!

> I just applied your patch to the GEOS 3.0.2 and this fixes compilation
> under both Debian Lenny gcc-4.3 and MingW :)

Thanks - I almost feel brave enough now to try to port some of that JTS
stuff to GEOS. 


> Note: I still see some XMLTester warnings like this:

Yap I saw those too but was afraid to touch them.

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From sgillies at frii.com  Mon Oct 20 09:42:24 2008
From: sgillies at frii.com (Sean Gillies)
Date: Mon Oct 20 09:51:07 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <1224450069.8415.16.camel@mca-desktop>
References: <1224449336.8415.9.camel@mca-desktop>
	<1224450069.8415.16.camel@mca-desktop>
Message-ID: <48FC8AC0.8060400@frii.com>

Mark Cave-Ayland wrote:
> On Sun, 2008-10-19 at 21:48 +0100, Mark Cave-Ayland wrote:
> 
>> My current solution is the attached patch which works by replacing
>> strdup() with a simple malloc() and strcpy() to preserve the old locale.
>> Note that this will almost certainly need to be applied to the 3.1
>> branch too, although I haven't got as far as trying to compile it on
>> Win32 - yet ;)
> 
> And as if by magic:
> http://trac.osgeo.org/geos/ticket/212
> 
> Cool. In that case, please can this be backported to the 3.0 branch? And
> I think we also need to backport the gcc-4.3 fixes since Debian and SUSE
> are now using gcc-4.3 by default (see
> http://postgis.refractions.net/pipermail/postgis-devel/2008-October/003939.html for the SUSE confirmation, and my local machine as of 2 hours ago is the Debian Lenny confirmation).
> 
> 
> ATB,
> 
> Mark.

Mark,

Sorry about not seeing the problem on windows until now. I've backported
and am testing locally (linux) and am game to commit the fix of #212 to
the 3.0 branch. What do you think, Mateusz?

Sean

From robe.dnd at cityofboston.gov  Mon Oct 20 10:12:11 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Mon Oct 20 10:12:16 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <48FC8AC0.8060400@frii.com>
References: <1224449336.8415.9.camel@mca-desktop><1224450069.8415.16.camel@mca-desktop>
	<48FC8AC0.8060400@frii.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204E2ABF5@ZDND.DND.boston.cob>

Sean,

Not sure how far you got.  But the patch I submitted contains the below
backport and the gcc-4.3 fixes.

Mark has tested and said it fixes the MingW issues too. I have tested on
OpenSuse 11 gcc 4.3dev something or other and seems to compile fine.

Thanks,
Regina 

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Sean Gillies
Sent: Monday, October 20, 2008 9:42 AM
To: GEOS Development List
Subject: Re: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32

Mark Cave-Ayland wrote:
> On Sun, 2008-10-19 at 21:48 +0100, Mark Cave-Ayland wrote:
> 
>> My current solution is the attached patch which works by replacing
>> strdup() with a simple malloc() and strcpy() to preserve the old
locale.
>> Note that this will almost certainly need to be applied to the 3.1
>> branch too, although I haven't got as far as trying to compile it on
>> Win32 - yet ;)
> 
> And as if by magic:
> http://trac.osgeo.org/geos/ticket/212
> 
> Cool. In that case, please can this be backported to the 3.0 branch?
And
> I think we also need to backport the gcc-4.3 fixes since Debian and
SUSE
> are now using gcc-4.3 by default (see
>
http://postgis.refractions.net/pipermail/postgis-devel/2008-October/0039
39.html for the SUSE confirmation, and my local machine as of 2 hours
ago is the Debian Lenny confirmation).
> 
> 
> ATB,
> 
> Mark.

Mark,

Sorry about not seeing the problem on windows until now. I've backported
and am testing locally (linux) and am game to commit the fix of #212 to
the 3.0 branch. What do you think, Mateusz?

Sean

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From robe.dnd at cityofboston.gov  Mon Oct 20 10:18:35 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Mon Oct 20 10:18:40 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <48FC8AC0.8060400@frii.com>
References: <1224449336.8415.9.camel@mca-desktop><1224450069.8415.16.camel@mca-desktop>
	<48FC8AC0.8060400@frii.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204E2AC1A@ZDND.DND.boston.cob>

Mark et. al,

Not sure it matters - hmm I forget which file it was. I probably should
have taken notes, but the  include listings were in a different order
from the trunk.  I added the missing one I think cstring or was it
version, but was hesitant to change the order of the includes to match
trunk since I wasn't sure the significance of the order.

It didn't seem to affect the compilation process as far as I could tell.


Thanks,
Regina

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Sean Gillies
Sent: Monday, October 20, 2008 9:42 AM
To: GEOS Development List
Subject: Re: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32

Mark Cave-Ayland wrote:
> On Sun, 2008-10-19 at 21:48 +0100, Mark Cave-Ayland wrote:
> 
>> My current solution is the attached patch which works by replacing
>> strdup() with a simple malloc() and strcpy() to preserve the old
locale.
>> Note that this will almost certainly need to be applied to the 3.1
>> branch too, although I haven't got as far as trying to compile it on
>> Win32 - yet ;)
> 
> And as if by magic:
> http://trac.osgeo.org/geos/ticket/212
> 
> Cool. In that case, please can this be backported to the 3.0 branch?
And
> I think we also need to backport the gcc-4.3 fixes since Debian and
SUSE
> are now using gcc-4.3 by default (see
>
http://postgis.refractions.net/pipermail/postgis-devel/2008-October/0039
39.html for the SUSE confirmation, and my local machine as of 2 hours
ago is the Debian Lenny confirmation).
> 
> 
> ATB,
> 
> Mark.

Mark,

Sorry about not seeing the problem on windows until now. I've backported
and am testing locally (linux) and am game to commit the fix of #212 to
the 3.0 branch. What do you think, Mateusz?

Sean

_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From pramsey at cleverelephant.ca  Wed Oct 22 14:33:37 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 22 14:33:41 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <48FC8AC0.8060400@frii.com>
References: <1224449336.8415.9.camel@mca-desktop>
	<1224450069.8415.16.camel@mca-desktop> <48FC8AC0.8060400@frii.com>
Message-ID: <30fe546d0810221133tcf8c8cco331c132bf8ad3176@mail.gmail.com>

On Mon, Oct 20, 2008 at 6:42 AM, Sean Gillies <sgillies@frii.com> wrote:
> Sorry about not seeing the problem on windows until now. I've backported
> and am testing locally (linux) and am game to commit the fix of #212 to
> the 3.0 branch. What do you think, Mateusz?

Yeehaw, cowboy Paul says "commit that doggie", let's get a 3.0.2 out
the door to go with PostGIS 1.3.4 :)

P
From charles.thibert at ingres.com  Wed Oct 22 14:37:25 2008
From: charles.thibert at ingres.com (Chuck Thibert)
Date: Wed Oct 22 14:37:28 2008
Subject: [geos-devel] RFC for Thread safe CAPI announced
In-Reply-To: <34839.82.189.249.150.1224314890.squirrel@www.ilande.co.uk>
References: <30fe546d0810131157y20e64073y758319c2af5ba2d4@mail.gmail.com>
	<D12AFD6C-240A-42EE-B751-13935EF3171C@hailmail.net>
	<48F3BCB9.9040107@umb.no>
	<30fe546d0810131547u7838e95epd98df970b9e81914@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFA7@ZDND.DND.boston.cob>
	<4E4EFF99-9819-4E55-9488-E58B3AF08B77@hailmail.net>
	<30fe546d0810140849x78a1df1dp9f91302129dbd3c@mail.gmail.com>
	<1224007927.3310.6.camel@localhost.localdomain>
	<30fe546d0810141146jad91d0arada60a0456c03347@mail.gmail.com>
	<1224011592.3310.9.camel@localhost.localdomain>
	<48F4FAED.5010602@pobox.com>
	<1224180757.4045.2.camel@localhost.localdomain>
	<48F8DB3A.1080405@pobox.com>
	<1224269390.3370.6.camel@localhost.localdomain>
	<48F8E249.2070602@pobox.com>
	<1224272298.3370.23.camel@localhost.localdomain>
	<34839.82.189.249.150.1224314890.squirrel@www.ilande.co.uk>
Message-ID: <1224700645.4834.14.camel@localhost.localdomain>

On Sat, 2008-10-18 at 08:28 +0100, Mark Cave-Ayland wrote:
> Well the definition is fairly woolly as a quick search revealed that the
> distinction between thread safety and re-entrancy is not always apparent
> in various descriptions of the functions. Probably the best descriptions I
> found were here:
> 
> http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.genprogc/doc/genprogc/writing_reentrant_thread_safe_code.htm
> http://www.ibm.com/developerworks/linux/library/l-reent.html
> 
> These basically describe a re-entrant function as one that does not hold
> static data across successive calls, or return a pointer to static data.
> So you could argue that since the static data will be held outside of the
> function (and it is not modified by the function) then it is re-entrant
> and thus qualifies for the _r suffix.
> 
> Then again, I will confess up front that I don't do much in the way of
> multi-threaded programming and so this was just my interpretation of the
> above and other random sources located using Google.
> 

Thanks Mark.

I agree, it looks like these changes should make the functions re-entrant.

I think I'll keep it at _r and let a vote finalize it.

Are there other comments/feedback?

Thanks,
Chuck
From sgillies at frii.com  Wed Oct 22 14:47:54 2008
From: sgillies at frii.com (Sean Gillies)
Date: Wed Oct 22 14:47:59 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <30fe546d0810221133tcf8c8cco331c132bf8ad3176@mail.gmail.com>
References: <1224449336.8415.9.camel@mca-desktop>	<1224450069.8415.16.camel@mca-desktop>
	<48FC8AC0.8060400@frii.com>
	<30fe546d0810221133tcf8c8cco331c132bf8ad3176@mail.gmail.com>
Message-ID: <48FF755A.7040005@frii.com>

Paul Ramsey wrote:
> On Mon, Oct 20, 2008 at 6:42 AM, Sean Gillies <sgillies@frii.com> wrote:
>> Sorry about not seeing the problem on windows until now. I've backported
>> and am testing locally (linux) and am game to commit the fix of #212 to
>> the 3.0 branch. What do you think, Mateusz?
> 
> Yeehaw, cowboy Paul says "commit that doggie", let's get a 3.0.2 out
> the door to go with PostGIS 1.3.4 :)
> 
> P

Can anybody commit to testing the fix on windows?

Sean

From pramsey at cleverelephant.ca  Wed Oct 22 14:57:26 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 22 14:57:29 2008
Subject: [geos-devel] 3.0.3 To Do
Message-ID: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>

Well, that was fast...

I've applied Regina's patch so we should compile under new GCC and
hopefully Windows too? We have a patch to CLocalizer that needs to go
in and be tested on Windows.

Sean, how about you commit the patch and then we can have the Windows
people test off of SVN. If it's not working we can fix it up post
facto.

Is there anything else outstanding on the 3.0 branch standing in front
of another point release?

Paul
From warmerdam at pobox.com  Wed Oct 22 14:58:51 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Oct 22 14:59:12 2008
Subject: [geos-devel] GEOS 3.0.2 fails to compile under MingW Win32
In-Reply-To: <48FF755A.7040005@frii.com>
References: <1224449336.8415.9.camel@mca-desktop>
	<1224450069.8415.16.camel@mca-desktop> <48FC8AC0.8060400@frii.com>
	<30fe546d0810221133tcf8c8cco331c132bf8ad3176@mail.gmail.com>
	<48FF755A.7040005@frii.com>
Message-ID: <48FF77EB.2060806@pobox.com>

Sean Gillies wrote:
> Paul Ramsey wrote:
>> On Mon, Oct 20, 2008 at 6:42 AM, Sean Gillies <sgillies@frii.com> wrote:
>>> Sorry about not seeing the problem on windows until now. I've backported
>>> and am testing locally (linux) and am game to commit the fix of #212 to
>>> the 3.0 branch. What do you think, Mateusz?
>> Yeehaw, cowboy Paul says "commit that doggie", let's get a 3.0.2 out
>> the door to go with PostGIS 1.3.4 :)
>>
>> P
> 
> Can anybody commit to testing the fix on windows?

Sean,

I can build it with a recent MSVC but I don't normall do MingW/MSYS.  Can
"cesh", the bug reporter, test it?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From robe.dnd at cityofboston.gov  Wed Oct 22 14:58:25 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Wed Oct 22 14:59:46 2008
Subject: [geos-devel] 3.0.3 To Do
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>

Wasn't the CLocalizer change in trunk already.  It should have been in my patch since I took the CLocalizer.cpp and .h from trunk since I couldn't get it to compile otherwise.  Or hmm I think I that was the one that I couldn't just add the header line.

________________________________

From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
Sent: Wed 10/22/2008 2:57 PM
To: GEOS Development List
Subject: [geos-devel] 3.0.3 To Do



Well, that was fast...

I've applied Regina's patch so we should compile under new GCC and
hopefully Windows too? We have a patch to CLocalizer that needs to go
in and be tested on Windows.

Sean, how about you commit the patch and then we can have the Windows
people test off of SVN. If it's not working we can fix it up post
facto.

Is there anything else outstanding on the 3.0 branch standing in front
of another point release?

Paul
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel




-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081022/d09e1b55/attachment.html
From pramsey at cleverelephant.ca  Wed Oct 22 15:03:42 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 22 15:03:44 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>
Message-ID: <30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com>

You're right, the removal of strdup was in your patch already... so, I
guess we just need a Windoze volunteer to compile branch 3.0.

P.

On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> Wasn't the CLocalizer change in trunk already.  It should have been in my
> patch since I took the CLocalizer.cpp and .h from trunk since I couldn't get
> it to compile otherwise.  Or hmm I think I that was the one that I couldn't
> just add the header line.
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 2:57 PM
> To: GEOS Development List
> Subject: [geos-devel] 3.0.3 To Do
>
> Well, that was fast...
>
> I've applied Regina's patch so we should compile under new GCC and
> hopefully Windows too? We have a patch to CLocalizer that needs to go
> in and be tested on Windows.
>
> Sean, how about you commit the patch and then we can have the Windows
> people test off of SVN. If it's not working we can fix it up post
> facto.
>
> Is there anything else outstanding on the 3.0 branch standing in front
> of another point release?
>
> Paul
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From robe.dnd at cityofboston.gov  Wed Oct 22 15:04:56 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Wed Oct 22 15:05:25 2008
Subject: [geos-devel] 3.0.3 To Do
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>
	<30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>

Didn't Mark Cave-Ayland already do that and say it worked?

________________________________

From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
Sent: Wed 10/22/2008 3:03 PM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do



You're right, the removal of strdup was in your patch already... so, I
guess we just need a Windoze volunteer to compile branch 3.0.

P.

On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> Wasn't the CLocalizer change in trunk already.  It should have been in my
> patch since I took the CLocalizer.cpp and .h from trunk since I couldn't get
> it to compile otherwise.  Or hmm I think I that was the one that I couldn't
> just add the header line.
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 2:57 PM
> To: GEOS Development List
> Subject: [geos-devel] 3.0.3 To Do
>
> Well, that was fast...
>
> I've applied Regina's patch so we should compile under new GCC and
> hopefully Windows too? We have a patch to CLocalizer that needs to go
> in and be tested on Windows.
>
> Sean, how about you commit the patch and then we can have the Windows
> people test off of SVN. If it's not working we can fix it up post
> facto.
>
> Is there anything else outstanding on the 3.0 branch standing in front
> of another point release?
>
> Paul
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel




-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081022/b183cc66/attachment-0001.html
From pramsey at cleverelephant.ca  Wed Oct 22 15:10:38 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 22 15:10:41 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>
	<30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
Message-ID: <30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>

No, I'm pretty sure he said he'd do it when he got time.

P

On Wed, Oct 22, 2008 at 12:04 PM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> Didn't Mark Cave-Ayland already do that and say it worked?
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 3:03 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> You're right, the removal of strdup was in your patch already... so, I
> guess we just need a Windoze volunteer to compile branch 3.0.
>
> P.
>
> On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina <robe.dnd@cityofboston.gov>
> wrote:
>> Wasn't the CLocalizer change in trunk already.  It should have been in my
>> patch since I took the CLocalizer.cpp and .h from trunk since I couldn't
>> get
>> it to compile otherwise.  Or hmm I think I that was the one that I
>> couldn't
>> just add the header line.
>> ________________________________
>> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
>> Sent: Wed 10/22/2008 2:57 PM
>> To: GEOS Development List
>> Subject: [geos-devel] 3.0.3 To Do
>>
>> Well, that was fast...
>>
>> I've applied Regina's patch so we should compile under new GCC and
>> hopefully Windows too? We have a patch to CLocalizer that needs to go
>> in and be tested on Windows.
>>
>> Sean, how about you commit the patch and then we can have the Windows
>> people test off of SVN. If it's not working we can fix it up post
>> facto.
>>
>> Is there anything else outstanding on the 3.0 branch standing in front
>> of another point release?
>>
>> Paul
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> ________________________________
>>
>> The substance of this message, including any attachments, may be
>> confidential, legally privileged and/or exempt from disclosure pursuant to
>> Massachusetts law. It is intended solely for the addressee. If you
>> received
>> this in error, please contact the sender and delete the material from any
>> computer.
>>
>> ________________________________
>>
>> Help make the earth a greener place. If at all possible resist printing
>> this
>> email and join us in saving paper.
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From rindahl at lrcwe.com  Wed Oct 22 15:15:27 2008
From: rindahl at lrcwe.com (Bruce Rindahl)
Date: Wed Oct 22 15:15:28 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>	<30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com>	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
	<30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
Message-ID: <48FF7BCF.9050800@lrcwe.com>

Where is the SVN?
I can give it a try on MingW/msys
Bruce

Paul Ramsey wrote:
> No, I'm pretty sure he said he'd do it when he got time.
>
> P
>
> On Wed, Oct 22, 2008 at 12:04 PM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
>   
>> Didn't Mark Cave-Ayland already do that and say it worked?
>> ________________________________
>> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
>> Sent: Wed 10/22/2008 3:03 PM
>> To: GEOS Development List
>> Subject: Re: [geos-devel] 3.0.3 To Do
>>
>> You're right, the removal of strdup was in your patch already... so, I
>> guess we just need a Windoze volunteer to compile branch 3.0.
>>
>> P.
>>
>> On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina <robe.dnd@cityofboston.gov>
>> wrote:
>>     
>>> Wasn't the CLocalizer change in trunk already.  It should have been in my
>>> patch since I took the CLocalizer.cpp and .h from trunk since I couldn't
>>> get
>>> it to compile otherwise.  Or hmm I think I that was the one that I
>>> couldn't
>>> just add the header line.
>>> ________________________________
>>> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
>>> Sent: Wed 10/22/2008 2:57 PM
>>> To: GEOS Development List
>>> Subject: [geos-devel] 3.0.3 To Do
>>>
>>> Well, that was fast...
>>>
>>> I've applied Regina's patch so we should compile under new GCC and
>>> hopefully Windows too? We have a patch to CLocalizer that needs to go
>>> in and be tested on Windows.
>>>
>>> Sean, how about you commit the patch and then we can have the Windows
>>> people test off of SVN. If it's not working we can fix it up post
>>> facto.
>>>
>>> Is there anything else outstanding on the 3.0 branch standing in front
>>> of another point release?
>>>
>>> Paul
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>>> ________________________________
>>>
>>> The substance of this message, including any attachments, may be
>>> confidential, legally privileged and/or exempt from disclosure pursuant to
>>> Massachusetts law. It is intended solely for the addressee. If you
>>> received
>>> this in error, please contact the sender and delete the material from any
>>> computer.
>>>
>>> ________________________________
>>>
>>> Help make the earth a greener place. If at all possible resist printing
>>> this
>>> email and join us in saving paper.
>>>
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>>>       
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> ________________________________
>>
>> The substance of this message, including any attachments, may be
>> confidential, legally privileged and/or exempt from disclosure pursuant to
>> Massachusetts law. It is intended solely for the addressee. If you received
>> this in error, please contact the sender and delete the material from any
>> computer.
>>
>> ________________________________
>>
>> Help make the earth a greener place. If at all possible resist printing this
>> email and join us in saving paper.
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>     
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081022/62c2dbf2/attachment.html
From pramsey at cleverelephant.ca  Wed Oct 22 15:16:20 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Wed Oct 22 15:22:56 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <48FF7BCF.9050800@lrcwe.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob>
	<30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
	<30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
	<48FF7BCF.9050800@lrcwe.com>
Message-ID: <30fe546d0810221216g2d5ea226n328606af2964cbb7@mail.gmail.com>

http://svn.osgeo.org/geos/branches/3.0

On Wed, Oct 22, 2008 at 12:15 PM, Bruce Rindahl <rindahl@lrcwe.com> wrote:
> Where is the SVN?
> I can give it a try on MingW/msys
> Bruce
>
> Paul Ramsey wrote:
>
> No, I'm pretty sure he said he'd do it when he got time.
>
> P
>
> On Wed, Oct 22, 2008 at 12:04 PM, Obe, Regina <robe.dnd@cityofboston.gov>
> wrote:
>
>
> Didn't Mark Cave-Ayland already do that and say it worked?
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 3:03 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> You're right, the removal of strdup was in your patch already... so, I
> guess we just need a Windoze volunteer to compile branch 3.0.
>
> P.
>
> On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina <robe.dnd@cityofboston.gov>
> wrote:
>
>
> Wasn't the CLocalizer change in trunk already.  It should have been in my
> patch since I took the CLocalizer.cpp and .h from trunk since I couldn't
> get
> it to compile otherwise.  Or hmm I think I that was the one that I
> couldn't
> just add the header line.
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 2:57 PM
> To: GEOS Development List
> Subject: [geos-devel] 3.0.3 To Do
>
> Well, that was fast...
>
> I've applied Regina's patch so we should compile under new GCC and
> hopefully Windows too? We have a patch to CLocalizer that needs to go
> in and be tested on Windows.
>
> Sean, how about you commit the patch and then we can have the Windows
> people test off of SVN. If it's not working we can fix it up post
> facto.
>
> Is there anything else outstanding on the 3.0 branch standing in front
> of another point release?
>
> Paul
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you
> received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing
> this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure pursuant to
> Massachusetts law. It is intended solely for the addressee. If you received
> this in error, please contact the sender and delete the material from any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist printing this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From robe.dnd at cityofboston.gov  Wed Oct 22 15:26:17 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Wed Oct 22 15:26:21 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob><30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
	<30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204E8C918@ZDND.DND.boston.cob>

Paul,

You're going to miss some minor dramas if you keep on sleeping like this
:)

He did test on mingw but not Visual C++.  Think we need a Visual C++
tester.  I presume it should compile in that.  I would myself, but
haven't quite figured out how that side of Visual Studio works.

http://postgis.refractions.net/pipermail/postgis-devel/2008-October/0039
67.html

Though he did say GeoJSON regression test fails.

 

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: Wednesday, October 22, 2008 3:11 PM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do

No, I'm pretty sure he said he'd do it when he got time.

P

On Wed, Oct 22, 2008 at 12:04 PM, Obe, Regina
<robe.dnd@cityofboston.gov> wrote:
> Didn't Mark Cave-Ayland already do that and say it worked?
> ________________________________
> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> Sent: Wed 10/22/2008 3:03 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> You're right, the removal of strdup was in your patch already... so, I
> guess we just need a Windoze volunteer to compile branch 3.0.
>
> P.
>
> On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina
<robe.dnd@cityofboston.gov>
> wrote:
>> Wasn't the CLocalizer change in trunk already.  It should have been
in my
>> patch since I took the CLocalizer.cpp and .h from trunk since I
couldn't
>> get
>> it to compile otherwise.  Or hmm I think I that was the one that I
>> couldn't
>> just add the header line.
>> ________________________________
>> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
>> Sent: Wed 10/22/2008 2:57 PM
>> To: GEOS Development List
>> Subject: [geos-devel] 3.0.3 To Do
>>
>> Well, that was fast...
>>
>> I've applied Regina's patch so we should compile under new GCC and
>> hopefully Windows too? We have a patch to CLocalizer that needs to go
>> in and be tested on Windows.
>>
>> Sean, how about you commit the patch and then we can have the Windows
>> people test off of SVN. If it's not working we can fix it up post
>> facto.
>>
>> Is there anything else outstanding on the 3.0 branch standing in
front
>> of another point release?
>>
>> Paul
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> ________________________________
>>
>> The substance of this message, including any attachments, may be
>> confidential, legally privileged and/or exempt from disclosure
pursuant to
>> Massachusetts law. It is intended solely for the addressee. If you
>> received
>> this in error, please contact the sender and delete the material from
any
>> computer.
>>
>> ________________________________
>>
>> Help make the earth a greener place. If at all possible resist
printing
>> this
>> email and join us in saving paper.
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> ________________________________
>
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure
pursuant to
> Massachusetts law. It is intended solely for the addressee. If you
received
> this in error, please contact the sender and delete the material from
any
> computer.
>
> ________________________________
>
> Help make the earth a greener place. If at all possible resist
printing this
> email and join us in saving paper.
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From hartmut.kaiser at gmail.com  Wed Oct 22 15:55:01 2008
From: hartmut.kaiser at gmail.com (Hartmut Kaiser)
Date: Wed Oct 22 15:55:17 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204E8C918@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob><30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>	<30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8C918@ZDND.DND.boston.cob>
Message-ID: <48ff8522.24015a0a.2434.ffffffbe@mx.google.com>

> You're going to miss some minor dramas if you keep on sleeping like
> this
> :)
> 
> He did test on mingw but not Visual C++.  Think we need a Visual C++
> tester.  I presume it should compile in that.  I would myself, but
> haven't quite figured out how that side of Visual Studio works.
> 
> http://postgis.refractions.net/pipermail/postgis-devel/2008-
> October/0039
> 67.html

I can do that later today.
Regards Hartmut

> Though he did say GeoJSON regression test fails.
> 
> 
> 
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> Sent: Wednesday, October 22, 2008 3:11 PM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
> 
> No, I'm pretty sure he said he'd do it when he got time.
> 
> P
> 
> On Wed, Oct 22, 2008 at 12:04 PM, Obe, Regina
> <robe.dnd@cityofboston.gov> wrote:
> > Didn't Mark Cave-Ayland already do that and say it worked?
> > ________________________________
> > From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> > Sent: Wed 10/22/2008 3:03 PM
> > To: GEOS Development List
> > Subject: Re: [geos-devel] 3.0.3 To Do
> >
> > You're right, the removal of strdup was in your patch already... so,
> I
> > guess we just need a Windoze volunteer to compile branch 3.0.
> >
> > P.
> >
> > On Wed, Oct 22, 2008 at 11:58 AM, Obe, Regina
> <robe.dnd@cityofboston.gov>
> > wrote:
> >> Wasn't the CLocalizer change in trunk already.  It should have been
> in my
> >> patch since I took the CLocalizer.cpp and .h from trunk since I
> couldn't
> >> get
> >> it to compile otherwise.  Or hmm I think I that was the one that I
> >> couldn't
> >> just add the header line.
> >> ________________________________
> >> From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
> >> Sent: Wed 10/22/2008 2:57 PM
> >> To: GEOS Development List
> >> Subject: [geos-devel] 3.0.3 To Do
> >>
> >> Well, that was fast...
> >>
> >> I've applied Regina's patch so we should compile under new GCC and
> >> hopefully Windows too? We have a patch to CLocalizer that needs to
> go
> >> in and be tested on Windows.
> >>
> >> Sean, how about you commit the patch and then we can have the
> Windows
> >> people test off of SVN. If it's not working we can fix it up post
> >> facto.
> >>
> >> Is there anything else outstanding on the 3.0 branch standing in
> front
> >> of another point release?
> >>
> >> Paul
> >> _______________________________________________
> >> geos-devel mailing list
> >> geos-devel@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/geos-devel
> >>
> >> ________________________________
> >>
> >> The substance of this message, including any attachments, may be
> >> confidential, legally privileged and/or exempt from disclosure
> pursuant to
> >> Massachusetts law. It is intended solely for the addressee. If you
> >> received
> >> this in error, please contact the sender and delete the material
> from
> any
> >> computer.
> >>
> >> ________________________________
> >>
> >> Help make the earth a greener place. If at all possible resist
> printing
> >> this
> >> email and join us in saving paper.
> >>
> >> _______________________________________________
> >> geos-devel mailing list
> >> geos-devel@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/geos-devel
> >>
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> > ________________________________
> >
> > The substance of this message, including any attachments, may be
> > confidential, legally privileged and/or exempt from disclosure
> pursuant to
> > Massachusetts law. It is intended solely for the addressee. If you
> received
> > this in error, please contact the sender and delete the material from
> any
> > computer.
> >
> > ________________________________
> >
> > Help make the earth a greener place. If at all possible resist
> printing this
> > email and join us in saving paper.
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> -----------------------------------------
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure
> pursuant to Massachusetts law. It is intended
> solely for the addressee. If you received this in error, please
> contact the sender and delete the material from any computer.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

From warmerdam at pobox.com  Wed Oct 22 16:21:15 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Oct 22 16:21:47 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204E8C918@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCA@ZDND.DND.boston.cob><30fe546d0810221203q1ceaadedh45bef1c664b72434@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFCB@ZDND.DND.boston.cob>
	<30fe546d0810221210u236102d2lcb59dff2fd0f3ad5@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8C918@ZDND.DND.boston.cob>
Message-ID: <48FF8B3B.4060909@pobox.com>

Obe, Regina wrote:
> Paul,
> 
> You're going to miss some minor dramas if you keep on sleeping like this
> :)
> 
> He did test on mingw but not Visual C++.  Think we need a Visual C++
> tester.  I presume it should compile in that.  I would myself, but
> haven't quite figured out how that side of Visual Studio works.

Folks,

I have built GEOS from SVN on MSVC 9 (express edition).  It works,
though I had to commit a change in source/makefile.vc adding the
new CLocalizer.cpp module.

So, thumbs up for MSVC builds.

PS. I've uploaded the new build as the official OSGeo4W GEOS
package.  I've also observed that there are precision results with
the geostest output on MSVC and it makes the results differ enough
to make the tests useless.  Is this expected?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From roxyknox at yahoo.co.uk  Thu Oct 23 04:53:07 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Thu Oct 23 04:53:11 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <503875.71853.qm@web28608.mail.ukl.yahoo.com>

I seem to have the issue below when building Geos 3.0.2 with Cygwin.
Is there a solution to this problem of double inclusion, or do I need to install an older version 
of Geos (I am reluctant to do this as I have a recent version of GCC, which requires a 
recent version of the source code to build).

Many thanks for your help - sorry I can't work this out for myself but only just starting to build
things myself!

Regards

Stephen

On Mon Aug 7 17:44:41 EDT 2006, Charlie Savage wrote:
Yes, there is inline.o and inlines.lo.

Not sure I understand though.? From inlines.cpp:

// Only do something if GEOS_INLINE is defined
// Otherwise we'll end up with duplicated symbols
#ifdef GEOS_INLINE

// Undefine GEOS_INLINE so that .inl files
// will be ready for an implementation file
#undef
GEOS_INLINE

#include <geos/inline.h>
#include <geos/io/WKTReader.inl>
#include <geos/io/ByteOrderDataInStream.inl>
#include <geos/operation/overlay/MinimalEdgeRing.inl>
...

#end



If GEOS_INLINE is defined it looks like all the files get included. Then if you look at, say WKTReader.inl: 
#ifdef GEOS_INLINE
# include <geos/io/WKTReader.inl>
#endif

Looks like this also would always be called when:

CXXFLAGS = -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long

Anyway, whatever is supposed to happen does not appear to be on MingW.

Charlie

strk@xxxxxxxxxxxxxxx wrote:

On Fri, Aug 04, 2006 at 05:20:49PM -0600, Charlie Savage wrote:

Okay, I've looked at this a bit more and don't see any obvious problems. I did a clean checkout and compiled normally (./configure, make). In the generated make files I see: 
CXXFLAGS = -g -O2 -DGEOS_INLINE -Wall -ansi -pedantic -Wno-long-long

However, it looks like the *.inl files are being included twice.

Suggestions?

When GEOS_INLINE is defined the inlines.cpp file should include no
files, so the problem seems there. Check build line for inlines.o.

--strk;


Charlie


Charlie Savage wrote:

Anything else missing before releasing 3.0.0rc1 ?

I'd like to see MingW work.

I fixed up a autoconf issue (the line feed one) and checked in a couple changes yesterday so geos would compile. However, it doesn't link (errors below). I'll try to investigate further this weekend. Other than that, I'm happy. 
Charlie


------------------
.libs/libgeos.lax/libalgorithm.a/MCPointInRing.o: In function `ZN4geos9algorithm13MCPointInRing10MCSelecterD1Ev':C:/Development/msys/src/geos/trunk/source/algorithm/../../source/headers/geos/algorithm/PointInRing.h:(.text$_ZN4geos4geom11LineSegmentD1Ev[__ZN4geos4geom11LineSegmentD1Ev]+0x0): multiple definition of `geos::geom::LineSegment::~LineSegment()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/LineSegment.inl:51: first defined here .libs/libgeos.lax/libalgorithm.a/MCPointInRing.o: In function `ZN4geos9algorithm13MCPointInRing10MCSelecterD1Ev':C:/Development/msys/src/geos/trunk/source/algorithm/../../source/headers/geos/algorithm/PointInRing.h:(.text$_ZN4geos4geom11LineSegmentD0Ev[__ZN4geos4geom11LineSegmentD0Ev]+0x0): multiple definition of `geos::geom::LineSegment::~LineSegment()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/LineSegment.inl:51: first defined here
 .libs/libgeos.lax/libalgorithm.a/PointLocator.o: In function `ZNSt8_Rb_treeIPKN4geos4geom10LineStringESt4pairIKS4_PNS0_9geomgraph4EdgeEESt10_Select1stISA_ESt4lessIS4_ESaISA_EE8_M_eraseEPSt13_Rb_tree_nodeISA_E':C:/Development/msys/src/geos/trunk/source/algorithm/PointLocator.cpp:(.text$_ZN4geos9geomgraph13GeometryGraphD0Ev[__ZN4geos9geomgraph13GeometryGraphD0Ev]+0x0): multiple definition of `geos::geomgraph::GeometryGraph::~GeometryGraph()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geomgraph/GeometryGraph.inl:46: first defined here .libs/libgeos.lax/libalgorithm.a/PointLocator.o: In function `ZNSt8_Rb_treeIPKN4geos4geom10LineStringESt4pairIKS4_PNS0_9geomgraph4EdgeEESt10_Select1stISA_ESt4lessIS4_ESaISA_EE8_M_eraseEPSt13_Rb_tree_nodeISA_E':C:/Development/msys/src/geos/trunk/source/algorithm/PointLocator.cpp:(.text$_ZN4geos9geomgraph13GeometryGraphD1Ev[__ZN4geos9geomgraph13GeometryGraphD1Ev]+0x0): multiple definition
 of `geos::geomgraph::GeometryGraph::~GeometryGraph()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geomgraph/GeometryGraph.inl:46: first defined here .libs/libgeos.lax/libgeom.a/CoordinateArraySequenceFactory.o: In function `ZN4geos4geom30CoordinateArraySequenceFactoryD0Ev':C:/Development/msys/src/geos/trunk/source/geom/CoordinateArraySequenceFactory.cpp:27: multiple definition of `geos::geom::CoordinateArraySequenceFactory::create(std::vector<geos::geom::Coordinate, std::allocator<geos::geom::Coordinate> >*) const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/CoordinateArraySequenceFactory.inl:28: first defined here .libs/libgeos.lax/libgeom.a/CoordinateArraySequenceFactory.o: In function `ZN4geos4geom30CoordinateArraySequenceFactoryD0Ev':C:/Development/msys/src/geos/trunk/source/geom/CoordinateArraySequenceFactory.cpp:27: multiple definition of
 `geos::geom::CoordinateArraySequenceFactory::create(unsigned int, unsigned int) const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/CoordinateArraySequenceFactory.inl:42: first defined here .libs/libgeos.lax/libgeom.a/MultiLineString.o: In function `ZNSt8_Rb_treeIPKN4geos4geom10LineStringESt4pairIKS4_PNS0_9geomgraph4EdgeEESt10_Select1stISA_ESt4lessIS4_ESaISA_EE8_M_eraseEPSt13_Rb_tree_nodeISA_E':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/stl_vector.h:(.text$_ZNK4geos4geom15MultiLineString5cloneEv[__ZNK4geos4geom15MultiLineString5cloneEv]+0x0): multiple definition of `geos::geom::MultiLineString::clone() const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/MultiLineString.inl:36: first defined here .libs/libgeos.lax/libgeom.a/MultiPolygon.o: In function
 `ZNSt6vectorIPN4geos4geom8GeometryESaIS3_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS3_S5_EERKS3_':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/ext/new_allocator.h:(.text$_ZNK4geos4geom12MultiPolygon5cloneEv[__ZNK4geos4geom12MultiPolygon5cloneEv]+0x0): multiple definition of `geos::geom::MultiPolygon::clone() const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/geom/MultiPolygon.inl:34: first defined here .libs/libgeos.lax/libio.a/WKBReader.o: In function `ZSt6fill_nIPPN4geos4geom8GeometryEjS3_ET_S5_T0_RKT1_':C:/Development/msys/src/geos/trunk/source/io/WKBReader.cpp:(.text$_ZN4geos2io21ByteOrderDataInStream7readIntEv[__ZN4geos2io21ByteOrderDataInStream7readIntEv]+0x0): multiple definition of `geos::io::ByteOrderDataInStream::readInt()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/io/ByteOrderDataInStream.inl:66: first defined here
 .libs/libgeos.lax/libnoding.a/MCIndexNoder.o: In function `ZNSt6vectorIPN4geos5index5chain13MonotoneChainESaIS4_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS4_S6_EERKS4_':C:/Development/msys/src/geos/trunk/source/noding/MCIndexNoder.cpp:(.text$_ZNK4geos6noding12MCIndexNoder18getNodedSubstringsEv[__ZNK4geos6noding12MCIndexNoder18getNodedSubstringsEv]+0x0): multiple definition of `geos::noding::MCIndexNoder::getNodedSubstrings() const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/noding/MCIndexNoder.inl:35: first defined here .libs/libgeos.lax/libnoding.a/MCIndexSnapRounder.o: In function `ZN4geos6noding9snapround18MCIndexSnapRounderD1Ev':C:/Development/msys/src/geos/trunk/source/noding/snapround/MCIndexSnapRounder.cpp:(.text$_ZNK4geos6noding9snapround18MCIndexSnapRounder18getNodedSubstringsEv[__ZNK4geos6noding9snapround18MCIndexSnapRounder18getNodedSubstringsEv]+0x0): multiple definition of
 `geos::noding::snapround::MCIndexSnapRounder::getNodedSubstrings() const' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/noding/snapround/MCIndexSnapRounder.inl:32: first defined here .libs/libgeos.lax/liboperation.a/ConnectedInteriorTester.o: In function `ZNSt6vectorIPN4geos9geomgraph8EdgeRingESaIS3_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS3_S5_EERKS3_':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/vector.tcc:(.text$_ZN4geos9operation7overlay15MinimalEdgeRing11setEdgeRingEPNS_9geomgraph12DirectedEdgeEPNS3_8EdgeRingE[__ZN4geos9operation7overlay15MinimalEdgeRing11setEdgeRingEPNS_9geomgraph12DirectedEdgeEPNS3_8EdgeRingE]+0x0): multiple definition of `geos::operation::overlay::MinimalEdgeRing::setEdgeRing(geos::geomgraph::DirectedEdge*, geos::geomgraph::EdgeRing*)'
 .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:31: first defined here .libs/libgeos.lax/liboperation.a/ConnectedInteriorTester.o: In function `ZNSt6vectorIPN4geos9geomgraph8EdgeRingESaIS3_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS3_S5_EERKS3_':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/vector.tcc:(.text$_ZN4geos9operation7overlay15MinimalEdgeRing7getNextEPNS_9geomgraph12DirectedEdgeE[__ZN4geos9operation7overlay15MinimalEdgeRing7getNextEPNS_9geomgraph12DirectedEdgeE]+0x0): multiple definition of `geos::operation::overlay::MinimalEdgeRing::getNext(geos::geomgraph::DirectedEdge*)' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:37: first defined here .libs/libgeos.lax/liboperation.a/ConnectedInteriorTester.o: In function
 `ZNSt6vectorIPN4geos9geomgraph8EdgeRingESaIS3_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS3_S5_EERKS3_':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/vector.tcc:(.text$_ZN4geos9operation7overlay15MinimalEdgeRingD1Ev[__ZN4geos9operation7overlay15MinimalEdgeRingD1Ev]+0x0): multiple definition of `geos::operation::overlay::MinimalEdgeRing::~MinimalEdgeRing()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:43: first defined here .libs/libgeos.lax/liboperation.a/ConnectedInteriorTester.o: In function `ZNSt6vectorIPN4geos9geomgraph8EdgeRingESaIS3_EE13_M_insert_auxEN9__gnu_cxx17__normal_iteratorIPS3_S5_EERKS3_':c:/Development/MinGW/bin/../lib/gcc/mingw32/3.4.5/../../../../include/c++/3.4.5/bits/vector.tcc:(.text$_ZN4geos9operation7overlay15MinimalEdgeRingD0Ev[__ZN4geos9operation7overlay15MinimalEdgeRingD0Ev]+0x0): multiple definition of
 `geos::operation::overlay::MinimalEdgeRing::~MinimalEdgeRing()' .libs/inlines.o:C:/Development/msys/src/geos/trunk/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:43: first defined here 
make[2]: *** [libgeos.la] Error 1
make[1]: *** [all-recursive] Error 1
make: *** [all-recursive] Error 1



------------------------------------------------------------------------

_______________________________________________
geos-devel mailing list
geos-devel@xxxxxxxxxxxxxxxxxxxx
http://geos.refractions.net/mailman/listinfo/geos-devel



_______________________________________________
geos-devel mailing list
geos-devel@xxxxxxxxxxxxxxxxxxxx
http://geos.refractions.net/mailman/listinfo/geos-devel


 smime.p7s
Description: S/MIME Cryptographic Signature
_______________________________________________
geos-devel mailing list
geos-devel@xxxxxxxxxxxxxxxxxxxx
http://geos.refractions.net/mailman/listinfo/geos-devel


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/1580b664/attachment-0001.html
From geosanak at gmail.com  Thu Oct 23 07:33:26 2008
From: geosanak at gmail.com (Sanak)
Date: Thu Oct 23 07:33:28 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
Message-ID: <5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos-branches-3.0-build-msvc80.patch
Type: application/octet-stream
Size: 2014 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/e6d0be3c/geos-branches-3.0-build-msvc80.obj
From Denise.MacLeod at ingres.com  Thu Oct 23 10:06:41 2008
From: Denise.MacLeod at ingres.com (Denise MacLeod)
Date: Thu Oct 23 10:06:43 2008
Subject: [geos-devel] Proposed fix for #169 - memory leak
Message-ID: <ABB90CDC9A08FF49851AC42557795A18030602FF@USINVMAILB01.ingres.prv>

Hi all -

I'm relatively new to GEOS, and decided to poke around at some of the outstanding issues to get better acquainted.  I started with the memory leak from http://trac.osgeo.org/geos/ticket/169

Here's what was causing the leak:
-  GEOSisValid calls IsValidOp::isValid() and IsValidOp::getValidationError().
-  Both of these methods call IsValidOp::checkValid(const Geometry *g)
-  The first time IsValidOp::checkValid is called, isChecked is false and validErr is NULL. An error is found, a new TopologyValidationError object is created and assigned to validErr, but isChecked is still false.
- Subsequent calls to IsValidOp::checkValid, isChecked is still false, validErr is assigned NULL, losing the previous TopologyValidationError object. A new TVE object is later allocated and assigned to validErr, isChecked is still false.

The fix:
- at the end of IsValidOp::checkValid(const Geometry *g), set isChecked to true. validErr is either still NULL (if no error was found) or it may point to a TVE object.

I did not originally download the svn trunk version, so I can't create a proper patch, but here is my diff from the geos-3.0.0 version that I downloaded in Sept.  The change is on line 129.

[denise@localhost valid]$ diff -C5 IsValidOp.cpp.orig IsValidOp.cpp
*** IsValidOp.cpp.orig  2008-10-22 14:02:31.000000000 -0400
--- IsValidOp.cpp       2008-10-23 09:54:46.000000000 -0400
***************
*** 124,133 ****
--- 124,134 ----
        else if (typeid(*g)==typeid(Polygon)) checkValid((Polygon*)g);
        else if (typeid(*g)==typeid(MultiPolygon)) checkValid((MultiPolygon*)g);
        else if ((gc=dynamic_cast<const GeometryCollection *>(g)))
                checkValid(gc);
        else throw util::UnsupportedOperationException();
+       isChecked=true;
  }

  /*
   * Checks validity of a Point.
   */


Thanks,
Denise
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/cf4dbdbb/attachment.html
From robe.dnd at cityofboston.gov  Thu Oct 23 10:30:21 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Thu Oct 23 10:30:33 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>

I tried Sanak's patch on my Visual Studio 2005 Professional install, and
it seemed to fix my compile problems.
 
Also ran the tests and they all seemed to pass - test output below in
case I misread something.
 
I know Frank already tested on Visual C++ Express (which is basically
Visual 2008 Express) and got some test fail errors.  Do we have a
solution file for that (or would people just use the msvc80 solution
file for that if they wanted to use a solution) .
 
I have another box in my office that has VS 2008 Professional on it (and
I think I loaded VC++ on it) that I can test later on in the day.  Just
not sure if to use the msvc80 solution or if have to use the makefile.vc
that Frank patched which I have no clue how to use.
 
As far as the solution file - I couldn't test the geos_ruby since I
don't have that installed - so maybe someone can test that out.  The
geos_python seemed to compile fine too.
 
Thanks,
Regina
 
 	Linking...
   Creating library
D:\SVNProjects\geos\3.0\build\msvc80\Debug\geos_unitd.lib and object
D:\SVNProjects\geos\3.0\build\msvc80\Debug\geos_unitd.exp
Embedding manifest...
Running regression tests using geos_unitd.exe...
===============================
  GEOS Test Suite Application
===============================
capi::GEOSCoordSeq: ..... 5
capi::GEOSSimplify: . 1
geos::algorithm::CGAlgorithms::computeOrientation: .. 2
geos::algorithm::CGAlgorithms::isCCW: ... 3
geos::algorithm::CGAlgorithms::isPointInRing: .. 2
geos::algorithm::ConvexHull: ....... 7
geos::algorithm::PointLocator: .... 4
geos::geom::Coordinate: ......... 9
geos::geom::CoordinateArraySequence: ............... 15
geos::geom::CoordinateArraySequenceFactory: .... 4
geos::geom::CoordinateList: . 1
geos::geom::Dimension: ..... 5
geos::geom::Envelope: ......... 9
geos::geom::Geometry::covers: ... 3
geos::geom::Geometry::isRectangle: ....... 7
geos::geom::GeometryFactory: ................................... 35
geos::geom::IntersectionMatrix: ............................. 29
geos::geom::LineSegment: ...... 6
geos::geom::LineString: ......................... 25
geos::geom::LinearRing: .............................. 30
geos::geom::Location: ... 3
geos::geom::MultiLineString: . 1
geos::geom::MultiPoint: ............................ 28
geos::geom::MultiPolygon: . 1
geos::geom::Point: ....................................... 39
geos::geom::Polygon: ..................................... 37
geos::geom::Triangle: ..... 5
geos::index::quadtree::DoubleBits: . 1
geos::io::ByteOrderValues: ... 3
geos::io::WKBReader: ....... 7
geos::noding::SegmentNode: . 1
geos::noding::SegmentPointComparator: . 1
geos::noding::SegmentString: .... 4
geos::operation::IsSimpleOp: ... 3
geos::operation::distance::DistanceOp: ................ 16
geos::operation::overlay::FuzzyPointLocator: ....... 7
geos::operation::overlay::OffsetPointGenerator: ..... 5
geos::operation::overlay::OverlayResultValidator: ...... 6
geos::precision::GeometrySnapper: .. 2
geos::precision::LineStringSnapper: .. 2
geos::precision::SimpleGeometryPrecisionReducer: ....... 7
geos::simplify::DouglasPeuckerSimplifier: .......... 10
geos::simplify::TopologyPreservingSimplifier: .......... 10
geos::util::UniqueCoordinateArrayFilter: . 1
Tests summary:
 - passed: 402


________________________________

From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Sanak
Sent: Thursday, October 23, 2008 7:33 AM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do


CLocalizer source/header needs in /build/msvc80/geos_lib/geos_lib.vcproj
file.
Please refer the attach file(geos-branches-3.0-build-msvc80.patch).

Regards,


2008/10/23 Paul Ramsey <pramsey@cleverelephant.ca>


	Well, that was fast...
	
	I've applied Regina's patch so we should compile under new GCC
and
	hopefully Windows too? We have a patch to CLocalizer that needs
to go
	in and be tested on Windows.
	
	Sean, how about you commit the patch and then we can have the
Windows
	people test off of SVN. If it's not working we can fix it up
post
	facto.
	
	Is there anything else outstanding on the 3.0 branch standing in
front
	of another point release?
	
	Paul
	_______________________________________________
	geos-devel mailing list
	geos-devel@lists.osgeo.org
	http://lists.osgeo.org/mailman/listinfo/geos-devel
	




-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/58b7f1d4/attachment.html
From warmerdam at pobox.com  Thu Oct 23 10:42:47 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Oct 23 10:43:03 2008
Subject: [geos-devel] Proposed fix for #169 - memory leak
In-Reply-To: <ABB90CDC9A08FF49851AC42557795A18030602FF@USINVMAILB01.ingres.prv>
References: <ABB90CDC9A08FF49851AC42557795A18030602FF@USINVMAILB01.ingres.prv>
Message-ID: <49008D67.8000503@pobox.com>

Denise MacLeod wrote:
> Hi all -
> 
> I'm relatively new to GEOS, and decided to poke around at some of the 
> outstanding issues to get better acquainted.  I started with the memory 
> leak from http://trac.osgeo.org/geos/ticket/169


Denise,

Your analysis looks good.  I would strongly encourage you to attach your
analysis to the ticket itself and add yourself to the cc: list.

I'll take the ticket and try to reproduce and apply your fix.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Oct 23 11:36:48 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Oct 23 11:37:07 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
Message-ID: <49009A10.2030903@pobox.com>

Obe, Regina wrote:
> I know Frank already tested on Visual C++ Express (which is basically 
> Visual 2008 Express) and got some test fail errors.  Do we have a 
> solution file for that (or would people just use the msvc80 solution 
> file for that if they wanted to use a solution) .
...
> Running regression tests using geos_unitd.exe...
> ===============================
>   GEOS Test Suite Application
> ===============================
> capi::GEOSCoordSeq: ..... 5
> capi::GEOSSimplify: . 1

Folks,

I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
against capi/test.wkt and compared to capi/test.expected.  If I get
back to my windows build I'll look into the geos_unitd.exe which I wasn't
aware of.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From geosanak at gmail.com  Thu Oct 23 13:52:58 2008
From: geosanak at gmail.com (Sanak)
Date: Thu Oct 23 13:53:20 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <49009A10.2030903@pobox.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
Message-ID: <5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos-branches-3.0-build-msvc80_add_geostest.patch
Type: application/octet-stream
Size: 8065 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081024/b5365a18/geos-branches-3.0-build-msvc80_add_geostest.obj
From robe.dnd at cityofboston.gov  Thu Oct 23 20:05:20 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Thu Oct 23 20:05:27 2008
Subject: [geos-devel] 3.0.3 To Do
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD0@ZDND.DND.boston.cob>

Sorry it took so long to test on VC9 (VS 2008 Professional on Vista).  Before Sanak's patch and after upgrading solution to 2008 doesn't compile, but after applying Sanak's patch and upgrading solution to 2008 - it compiles.

The geos_test compiles and after running against the CAPI/test.wkt and doing a diff compare between the test.out and what I got, I see no difference.

HOWEVER:  Why does it say - GEOS version 3.0.0rc4-CAPI-1.3.3  -- shouldn't we change that version. To I don't know something like 3.0.3

The geos_unit doesn't give any errors either.

One thing I did notice is a lot of warnings about how Wp64 is deprecated and will be removed in a future release.  I don't recall getting that when compiling under VC8.  Get same when compiling against trunk.

also just a lot of somewhat scary looking warnings - which I'm sure everyone on the GEOS team is aware of (I wasn't paying too much attention when compiling under VC8, so they were probably there too).

So for 3.0 branch
geos_lib - 0 error(s), 371 warning(s)

For Trunk
1>geos_lib - 0 error(s), 453 warning(s)

3.0  Warnings:
lots of  "assignment operator could not be generated"
lots of unreferenced parameters (no big deal)
lot of conversion from 'size_t' to 'int', possible loss of data - assume no big deal
There was a warning about int64 being cast to long - can't remember whether that was in trunk or branch.


Trunk warnings:
Things like - lots of  "assignment operator could not be generated"
 "'geos::io::WKTReader' : type name first seen using 'class' now seen using 'struct'"
monotonechainbuilder.cpp(103) : warning C4018: '>=' : signed/unsigned mismatch
nodedsegmentstring.h(88) : warning C4018: '<' : signed/unsigned mismatch
conversion from 'size_t' to 'int', possible loss of data (assume no big deal)

The geos_test is not in trunk for vc8, do we want it there or do we not even care to have this test at all for VC?

Anyrate I guess the moral is for 3.1 we should probably cleanup some of these warnings since its hard to tell which warnings are important and which are not. But Paul already stated the obvious before, I'm just restating it.

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org on behalf of Sanak
Sent: Thu 10/23/2008 1:52 PM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do
 
Ok, I had added geostest project to msvc80 solution file.
Please see the attach
file(geos-branches-3.0-build-msvc80_add_geostest.patch).
geostest.vcproj will generate capi/test.out.

I think that the cause of difference between generated test.out and
test.expected is precision of floating point, but I don't know details.

And another Visual C++ specific problem may be capi version.(capi/
geos_c.h.in)
---
Index: geos_c.h.in
===================================================================
--- geos_c.h.in    (revision 2208)
+++ geos_c.h.in    (working copy)
@@ -51,9 +51,9 @@
 #if defined(_MSC_VER)
 #include <geos/version.h>
 #define GEOS_CAPI_VERSION_MAJOR 1
-#define GEOS_CAPI_VERSION_MINOR 3
+#define GEOS_CAPI_VERSION_MINOR 4
 #define GEOS_CAPI_VERSION_PATCH 3
-#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
+#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
 #else
 #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
 #define GEOS_VERSION_MINOR @VERSION_MINOR@
---

Regards,

2008/10/24 Frank Warmerdam <warmerdam@pobox.com>

> Obe, Regina wrote:
>
>> I know Frank already tested on Visual C++ Express (which is basically
>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>> file for that (or would people just use the msvc80 solution file for that if
>> they wanted to use a solution) .
>>
> ...
>
>> Running regression tests using geos_unitd.exe...
>> ===============================
>>  GEOS Test Suite Application
>> ===============================
>> capi::GEOSCoordSeq: ..... 5
>> capi::GEOSSimplify: . 1
>>
>
> Folks,
>
> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
> against capi/test.wkt and compared to capi/test.expected.  If I get
> back to my windows build I'll look into the geos_unitd.exe which I wasn't
> aware of.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>















-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/d1cc4ab1/attachment-0001.html
From pramsey at cleverelephant.ca  Thu Oct 23 23:41:45 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Thu Oct 23 23:41:48 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
Message-ID: <30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>

I couldn't apply this patch cleanly, could someone else try?

P.

On Thu, Oct 23, 2008 at 10:52 AM, Sanak <geosanak@gmail.com> wrote:
> Ok, I had added geostest project to msvc80 solution file.
> Please see the attach
> file(geos-branches-3.0-build-msvc80_add_geostest.patch).
> geostest.vcproj will generate capi/test.out.
>
> I think that the cause of difference between generated test.out and
> test.expected is precision of floating point, but I don't know details.
>
> And another Visual C++ specific problem may be capi
> version.(capi/geos_c.h.in)
> ---
> Index: geos_c.h.in
> ===================================================================
> --- geos_c.h.in    (revision 2208)
> +++ geos_c.h.in    (working copy)
> @@ -51,9 +51,9 @@
>  #if defined(_MSC_VER)
>  #include <geos/version.h>
>  #define GEOS_CAPI_VERSION_MAJOR 1
> -#define GEOS_CAPI_VERSION_MINOR 3
> +#define GEOS_CAPI_VERSION_MINOR 4
>  #define GEOS_CAPI_VERSION_PATCH 3
> -#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
> +#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
>  #else
>  #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
>  #define GEOS_VERSION_MINOR @VERSION_MINOR@
> ---
>
> Regards,
>
> 2008/10/24 Frank Warmerdam <warmerdam@pobox.com>
>>
>> Obe, Regina wrote:
>>>
>>> I know Frank already tested on Visual C++ Express (which is basically
>>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>>> file for that (or would people just use the msvc80 solution file for that if
>>> they wanted to use a solution) .
>>
>> ...
>>>
>>> Running regression tests using geos_unitd.exe...
>>> ===============================
>>>  GEOS Test Suite Application
>>> ===============================
>>> capi::GEOSCoordSeq: ..... 5
>>> capi::GEOSSimplify: . 1
>>
>> Folks,
>>
>> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
>> against capi/test.wkt and compared to capi/test.expected.  If I get
>> back to my windows build I'll look into the geos_unitd.exe which I wasn't
>> aware of.
>>
>> Best regards,
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From robe.dnd at cityofboston.gov  Thu Oct 23 23:54:11 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Thu Oct 23 23:54:35 2008
Subject: [geos-devel] 3.0.3 To Do
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD2@ZDND.DND.boston.cob>


What sort of error did you run into?

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
Sent: Thu 10/23/2008 11:41 PM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do
 
I couldn't apply this patch cleanly, could someone else try?

P.

On Thu, Oct 23, 2008 at 10:52 AM, Sanak <geosanak@gmail.com> wrote:
> Ok, I had added geostest project to msvc80 solution file.
> Please see the attach
> file(geos-branches-3.0-build-msvc80_add_geostest.patch).
> geostest.vcproj will generate capi/test.out.
>
> I think that the cause of difference between generated test.out and
> test.expected is precision of floating point, but I don't know details.
>
> And another Visual C++ specific problem may be capi
> version.(capi/geos_c.h.in)
> ---
> Index: geos_c.h.in
> ===================================================================
> --- geos_c.h.in    (revision 2208)
> +++ geos_c.h.in    (working copy)
> @@ -51,9 +51,9 @@
>  #if defined(_MSC_VER)
>  #include <geos/version.h>
>  #define GEOS_CAPI_VERSION_MAJOR 1
> -#define GEOS_CAPI_VERSION_MINOR 3
> +#define GEOS_CAPI_VERSION_MINOR 4
>  #define GEOS_CAPI_VERSION_PATCH 3
> -#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
> +#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
>  #else
>  #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
>  #define GEOS_VERSION_MINOR @VERSION_MINOR@
> ---
>
> Regards,
>
> 2008/10/24 Frank Warmerdam <warmerdam@pobox.com>
>>
>> Obe, Regina wrote:
>>>
>>> I know Frank already tested on Visual C++ Express (which is basically
>>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>>> file for that (or would people just use the msvc80 solution file for that if
>>> they wanted to use a solution) .
>>
>> ...
>>>
>>> Running regression tests using geos_unitd.exe...
>>> ===============================
>>>  GEOS Test Suite Application
>>> ===============================
>>> capi::GEOSCoordSeq: ..... 5
>>> capi::GEOSSimplify: . 1
>>
>> Folks,
>>
>> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
>> against capi/test.wkt and compared to capi/test.expected.  If I get
>> back to my windows build I'll look into the geos_unitd.exe which I wasn't
>> aware of.
>>
>> Best regards,
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel



-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081023/7e5674ff/attachment.html
From robe.dnd at cityofboston.gov  Fri Oct 24 00:48:11 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 24 00:48:17 2008
Subject: [geos-devel] 3.0.3 To Do
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>

Paul,

Actually which patch are you referring to.  The version one or the big patch.  I just redownloaded the msvc80 folder from svn that has your version patch and then reapplied Sanak's patch and didn't run into any conflicts.

Only problem is now it reads 3.0.2 (well its hard-coded but I guess there is not much we can do about that).  I assume we'll change this yet again when we release 3.0.3.

Is it because the patch includes new files for the SVN geostest that is causing part of the problem.  If that's the case - if I gave you the patch as 2 separate patches, would that help out?

I would gladly try to help you out if I had commit access.

Thanks,
Regina





-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org on behalf of Paul Ramsey
Sent: Thu 10/23/2008 11:41 PM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do
 
I couldn't apply this patch cleanly, could someone else try?

P.

On Thu, Oct 23, 2008 at 10:52 AM, Sanak <geosanak@gmail.com> wrote:
> Ok, I had added geostest project to msvc80 solution file.
> Please see the attach
> file(geos-branches-3.0-build-msvc80_add_geostest.patch).
> geostest.vcproj will generate capi/test.out.
>
> I think that the cause of difference between generated test.out and
> test.expected is precision of floating point, but I don't know details.
>
> And another Visual C++ specific problem may be capi
> version.(capi/geos_c.h.in)
> ---
> Index: geos_c.h.in
> ===================================================================
> --- geos_c.h.in    (revision 2208)
> +++ geos_c.h.in    (working copy)
> @@ -51,9 +51,9 @@
>  #if defined(_MSC_VER)
>  #include <geos/version.h>
>  #define GEOS_CAPI_VERSION_MAJOR 1
> -#define GEOS_CAPI_VERSION_MINOR 3
> +#define GEOS_CAPI_VERSION_MINOR 4
>  #define GEOS_CAPI_VERSION_PATCH 3
> -#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
> +#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
>  #else
>  #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
>  #define GEOS_VERSION_MINOR @VERSION_MINOR@
> ---
>
> Regards,
>
> 2008/10/24 Frank Warmerdam <warmerdam@pobox.com>
>>
>> Obe, Regina wrote:
>>>
>>> I know Frank already tested on Visual C++ Express (which is basically
>>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>>> file for that (or would people just use the msvc80 solution file for that if
>>> they wanted to use a solution) .
>>
>> ...
>>>
>>> Running regression tests using geos_unitd.exe...
>>> ===============================
>>>  GEOS Test Suite Application
>>> ===============================
>>> capi::GEOSCoordSeq: ..... 5
>>> capi::GEOSSimplify: . 1
>>
>> Folks,
>>
>> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
>> against capi/test.wkt and compared to capi/test.expected.  If I get
>> back to my windows build I'll look into the geos_unitd.exe which I wasn't
>> aware of.
>>
>> Best regards,
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel







-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081024/b0a953b5/attachment.html
From pramsey at cleverelephant.ca  Fri Oct 24 11:38:38 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 24 11:38:40 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>
Message-ID: <30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com>

On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> Actually which patch are you referring to.  The version one or the big
> patch.  I just redownloaded the msvc80 folder from svn that has your version
> patch and then reapplied Sanak's patch and didn't run into any conflicts.

this one
geos-branches-3.0-build-msvc80_add_geostest.patch

should I be doing the earlier one?

P
From robe.dnd at cityofboston.gov  Fri Oct 24 11:46:02 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 24 11:46:07 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com><30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>
	<30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>

Paul,

The earlier one doesn't add any new files so may be more appropriate.
This one adds a new geostest folder to the msvc80 and geostest to the
solution to add the test that Frank was running using make.vc (that does
the test.wkt compare thing).

Note:  this geostest isn't even in trunk so I'm questioning if we really
want to include it in the geos 3.0 branch. If we do we should include it
in trunk to be consistent.

Since we already have a unit test for VC and the unit test is much
easier to use than the geostest, I question the value of adding this
extra project to the solution.

Thanks,
Regina

 

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: Friday, October 24, 2008 11:39 AM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do

On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina <robe.dnd@cityofboston.gov>
wrote:
> Actually which patch are you referring to.  The version one or the big
> patch.  I just redownloaded the msvc80 folder from svn that has your
version
> patch and then reapplied Sanak's patch and didn't run into any
conflicts.

this one
geos-branches-3.0-build-msvc80_add_geostest.patch

should I be doing the earlier one?

P
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-----------------------------------------
The substance of this message, including any attachments, may be
confidential, legally privileged and/or exempt from disclosure
pursuant to Massachusetts law. It is intended
solely for the addressee. If you received this in error, please
contact the sender and delete the material from any computer.
From pramsey at cleverelephant.ca  Fri Oct 24 11:50:26 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 24 11:50:29 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>
	<30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>
Message-ID: <30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>

I tried the earlier one and that didn't work either. I'm suspecting my
OS/X patch is (a) first stripping the CRs from the dos-generated patch
and then (b) not finding any matches in the dos-formatted target file.
I think someone else with a cygwin sandbox should apply this patch.

P.

On Fri, Oct 24, 2008 at 8:46 AM, Obe, Regina <robe.dnd@cityofboston.gov> wrote:
> Paul,
>
> The earlier one doesn't add any new files so may be more appropriate.
> This one adds a new geostest folder to the msvc80 and geostest to the
> solution to add the test that Frank was running using make.vc (that does
> the test.wkt compare thing).
>
> Note:  this geostest isn't even in trunk so I'm questioning if we really
> want to include it in the geos 3.0 branch. If we do we should include it
> in trunk to be consistent.
>
> Since we already have a unit test for VC and the unit test is much
> easier to use than the geostest, I question the value of adding this
> extra project to the solution.
>
> Thanks,
> Regina
>
>
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> Sent: Friday, October 24, 2008 11:39 AM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina <robe.dnd@cityofboston.gov>
> wrote:
>> Actually which patch are you referring to.  The version one or the big
>> patch.  I just redownloaded the msvc80 folder from svn that has your
> version
>> patch and then reapplied Sanak's patch and didn't run into any
> conflicts.
>
> this one
> geos-branches-3.0-build-msvc80_add_geostest.patch
>
> should I be doing the earlier one?
>
> P
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> -----------------------------------------
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure
> pursuant to Massachusetts law. It is intended
> solely for the addressee. If you received this in error, please
> contact the sender and delete the material from any computer.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From robe.dnd at cityofboston.gov  Fri Oct 24 11:58:23 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 24 11:58:27 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com><30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob><30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>
	<30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204EB9A27@ZDND.DND.boston.cob>

Paul,
Hmm I would have thought you would have similar problems with my patch
since I generated it on Windows via Tortoise SVN.  Wonder if I repackage
the patch it would help. 

So I guess just need to know whether to include geostest or not.

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: Friday, October 24, 2008 11:50 AM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do

I tried the earlier one and that didn't work either. I'm suspecting my
OS/X patch is (a) first stripping the CRs from the dos-generated patch
and then (b) not finding any matches in the dos-formatted target file.
I think someone else with a cygwin sandbox should apply this patch.

P.

On Fri, Oct 24, 2008 at 8:46 AM, Obe, Regina <robe.dnd@cityofboston.gov>
wrote:
> Paul,
>
> The earlier one doesn't add any new files so may be more appropriate.
> This one adds a new geostest folder to the msvc80 and geostest to the
> solution to add the test that Frank was running using make.vc (that
does
> the test.wkt compare thing).
>
> Note:  this geostest isn't even in trunk so I'm questioning if we
really
> want to include it in the geos 3.0 branch. If we do we should include
it
> in trunk to be consistent.
>
> Since we already have a unit test for VC and the unit test is much
> easier to use than the geostest, I question the value of adding this
> extra project to the solution.
>
> Thanks,
> Regina
>
>
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> Sent: Friday, October 24, 2008 11:39 AM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina
<robe.dnd@cityofboston.gov>
> wrote:
>> Actually which patch are you referring to.  The version one or the
big
>> patch.  I just redownloaded the msvc80 folder from svn that has your
> version
>> patch and then reapplied Sanak's patch and didn't run into any
> conflicts.
>
> this one
> geos-branches-3.0-build-msvc80_add_geostest.patch
>
> should I be doing the earlier one?
>
> P
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> -----------------------------------------
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure
> pursuant to Massachusetts law. It is intended
> solely for the addressee. If you received this in error, please
> contact the sender and delete the material from any computer.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
From sgillies at frii.com  Fri Oct 24 12:35:09 2008
From: sgillies at frii.com (Sean Gillies)
Date: Fri Oct 24 12:35:16 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>	<49009A10.2030903@pobox.com>	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
Message-ID: <4901F93D.5080009@frii.com>

According to

http://trac.osgeo.org/geos/log/branches/3.0/capi/geos_c.cpp

The C API hasn't changed since the 3.0 branch was made, so a change of
the API version number isn't warranted.

Sean

Paul Ramsey wrote:
> I couldn't apply this patch cleanly, could someone else try?
> 
> P.
> 
> On Thu, Oct 23, 2008 at 10:52 AM, Sanak <geosanak@gmail.com> wrote:
>> Ok, I had added geostest project to msvc80 solution file.
>> Please see the attach
>> file(geos-branches-3.0-build-msvc80_add_geostest.patch).
>> geostest.vcproj will generate capi/test.out.
>>
>> I think that the cause of difference between generated test.out and
>> test.expected is precision of floating point, but I don't know details.
>>
>> And another Visual C++ specific problem may be capi
>> version.(capi/geos_c.h.in)
>> ---
>> Index: geos_c.h.in
>> ===================================================================
>> --- geos_c.h.in    (revision 2208)
>> +++ geos_c.h.in    (working copy)
>> @@ -51,9 +51,9 @@
>>  #if defined(_MSC_VER)
>>  #include <geos/version.h>
>>  #define GEOS_CAPI_VERSION_MAJOR 1
>> -#define GEOS_CAPI_VERSION_MINOR 3
>> +#define GEOS_CAPI_VERSION_MINOR 4
>>  #define GEOS_CAPI_VERSION_PATCH 3
>> -#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
>> +#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
>>  #else
>>  #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
>>  #define GEOS_VERSION_MINOR @VERSION_MINOR@
>> ---
>>
>> Regards,
>>
>> 2008/10/24 Frank Warmerdam <warmerdam@pobox.com>
>>> Obe, Regina wrote:
>>>> I know Frank already tested on Visual C++ Express (which is basically
>>>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>>>> file for that (or would people just use the msvc80 solution file for that if
>>>> they wanted to use a solution) .
>>> ...
>>>> Running regression tests using geos_unitd.exe...
>>>> ===============================
>>>>  GEOS Test Suite Application
>>>> ===============================
>>>> capi::GEOSCoordSeq: ..... 5
>>>> capi::GEOSSimplify: . 1
>>> Folks,
>>>
>>> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
>>> against capi/test.wkt and compared to capi/test.expected.  If I get
>>> back to my windows build I'll look into the geos_unitd.exe which I wasn't
>>> aware of.
>>>
>>> Best regards,
>>> --
>>>
>>> ---------------------------------------+--------------------------------------
>>> I set the clouds in motion - turn up   | Frank Warmerdam,
>>> warmerdam@pobox.com
>>> light and sound - activate the windows | http://pobox.com/~warmerdam
>>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>>
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> 

From pramsey at cleverelephant.ca  Fri Oct 24 12:54:39 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 24 12:54:41 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <4901F93D.5080009@frii.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
	<4901F93D.5080009@frii.com>
Message-ID: <30fe546d0810240954v3a262643qafc638aed7477476@mail.gmail.com>

My change merely reflects the numbers that the non-Windows GEOS users
are seeing, via the macro-based versions. I think HOWTORelease
describes the logic behind increments.

P

On Fri, Oct 24, 2008 at 9:35 AM, Sean Gillies <sgillies@frii.com> wrote:
> According to
>
> http://trac.osgeo.org/geos/log/branches/3.0/capi/geos_c.cpp
>
> The C API hasn't changed since the 3.0 branch was made, so a change of
> the API version number isn't warranted.
>
> Sean
>
> Paul Ramsey wrote:
>> I couldn't apply this patch cleanly, could someone else try?
>>
>> P.
>>
>> On Thu, Oct 23, 2008 at 10:52 AM, Sanak <geosanak@gmail.com> wrote:
>>> Ok, I had added geostest project to msvc80 solution file.
>>> Please see the attach
>>> file(geos-branches-3.0-build-msvc80_add_geostest.patch).
>>> geostest.vcproj will generate capi/test.out.
>>>
>>> I think that the cause of difference between generated test.out and
>>> test.expected is precision of floating point, but I don't know details.
>>>
>>> And another Visual C++ specific problem may be capi
>>> version.(capi/geos_c.h.in)
>>> ---
>>> Index: geos_c.h.in
>>> ===================================================================
>>> --- geos_c.h.in    (revision 2208)
>>> +++ geos_c.h.in    (working copy)
>>> @@ -51,9 +51,9 @@
>>>  #if defined(_MSC_VER)
>>>  #include <geos/version.h>
>>>  #define GEOS_CAPI_VERSION_MAJOR 1
>>> -#define GEOS_CAPI_VERSION_MINOR 3
>>> +#define GEOS_CAPI_VERSION_MINOR 4
>>>  #define GEOS_CAPI_VERSION_PATCH 3
>>> -#define GEOS_CAPI_VERSION "3.0.0rc4-CAPI-1.3.3"
>>> +#define GEOS_CAPI_VERSION "3.0.3-CAPI-1.4.3"
>>>  #else
>>>  #define GEOS_VERSION_MAJOR @VERSION_MAJOR@
>>>  #define GEOS_VERSION_MINOR @VERSION_MINOR@
>>> ---
>>>
>>> Regards,
>>>
>>> 2008/10/24 Frank Warmerdam <warmerdam@pobox.com>
>>>> Obe, Regina wrote:
>>>>> I know Frank already tested on Visual C++ Express (which is basically
>>>>> Visual 2008 Express) and got some test fail errors.  Do we have a solution
>>>>> file for that (or would people just use the msvc80 solution file for that if
>>>>> they wanted to use a solution) .
>>>> ...
>>>>> Running regression tests using geos_unitd.exe...
>>>>> ===============================
>>>>>  GEOS Test Suite Application
>>>>> ===============================
>>>>> capi::GEOSCoordSeq: ..... 5
>>>>> capi::GEOSSimplify: . 1
>>>> Folks,
>>>>
>>>> I would note that I wasn't running geos_unitd.exe, I ran geostest.exe
>>>> against capi/test.wkt and compared to capi/test.expected.  If I get
>>>> back to my windows build I'll look into the geos_unitd.exe which I wasn't
>>>> aware of.
>>>>
>>>> Best regards,
>>>> --
>>>>
>>>> ---------------------------------------+--------------------------------------
>>>> I set the clouds in motion - turn up   | Frank Warmerdam,
>>>> warmerdam@pobox.com
>>>> light and sound - activate the windows | http://pobox.com/~warmerdam
>>>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>>>
>>>> _______________________________________________
>>>> geos-devel mailing list
>>>> geos-devel@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>>> _______________________________________________
>>> geos-devel mailing list
>>> geos-devel@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From robe.dnd at cityofboston.gov  Fri Oct 24 16:07:26 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Fri Oct 24 16:07:30 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><5f9be0a0810230433y5d90b6d7xc595306e350b0ca3@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com><30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob><30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>
	<30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204EB9DE5@ZDND.DND.boston.cob>

Paul,

Can you try applying this revised attached patch.  I ran into the same
issues you described when trying to apply the tortoise generated patch
to my OpenSUSE VM install.

I used the original patch he sent since didn't want to fuss with
updating trunk and I really don't want geos 3.0 having stuff that trunk
doesn't have.

As a workaround I
1) checked out  geos 3.0 on both OpenSUSE VM and windows
2) patched my windows using tortoise svn with Sanak's patch
3) uploaded changed files to OpenSuse VM
4) Did a svn diff on my OpenSUSE to generate this new patch 

5) To test I wiped out my msvc8 on windows did svn checkout and applied
the patch I created in OpenSuse  and then did a build in VS8 to make
sure it worked.

6) Also did the same thing in OpenSuse

I'm sure there is a more elegant way to do this, but that's the best I
could do with my limited skill set :(. 

Thanks,
Regina

-----Original Message-----
From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
Sent: Friday, October 24, 2008 11:50 AM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do

I tried the earlier one and that didn't work either. I'm suspecting my
OS/X patch is (a) first stripping the CRs from the dos-generated patch
and then (b) not finding any matches in the dos-formatted target file.
I think someone else with a cygwin sandbox should apply this patch.

P.

On Fri, Oct 24, 2008 at 8:46 AM, Obe, Regina <robe.dnd@cityofboston.gov>
wrote:
> Paul,
>
> The earlier one doesn't add any new files so may be more appropriate.
> This one adds a new geostest folder to the msvc80 and geostest to the
> solution to add the test that Frank was running using make.vc (that
does
> the test.wkt compare thing).
>
> Note:  this geostest isn't even in trunk so I'm questioning if we
really
> want to include it in the geos 3.0 branch. If we do we should include
it
> in trunk to be consistent.
>
> Since we already have a unit test for VC and the unit test is much
> easier to use than the geostest, I question the value of adding this
> extra project to the solution.
>
> Thanks,
> Regina
>
>
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> Sent: Friday, October 24, 2008 11:39 AM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina
<robe.dnd@cityofboston.gov>
> wrote:
>> Actually which patch are you referring to.  The version one or the
big
>> patch.  I just redownloaded the msvc80 folder from svn that has your
> version
>> patch and then reapplied Sanak's patch and didn't run into any
> conflicts.
>
> this one
> geos-branches-3.0-build-msvc80_add_geostest.patch
>
> should I be doing the earlier one?
>
> P
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
> -----------------------------------------
> The substance of this message, including any attachments, may be
> confidential, legally privileged and/or exempt from disclosure
> pursuant to Massachusetts law. It is intended
> solely for the addressee. If you received this in error, please
> contact the sender and delete the material from any computer.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos_msvc80.diff
Type: application/octet-stream
Size: 2002 bytes
Desc: geos_msvc80.diff
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081024/63d2ec11/geos_msvc80.obj
From mark.cave-ayland at ilande.co.uk  Sun Oct 26 17:25:25 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Sun Oct 26 17:28:42 2008
Subject: [geos-devel] Fw: 3.0?
In-Reply-To: <503875.71853.qm@web28608.mail.ukl.yahoo.com>
References: <503875.71853.qm@web28608.mail.ukl.yahoo.com>
Message-ID: <1225056325.13178.6.camel@mca-desktop>

On Thu, 2008-10-23 at 08:53 +0000, S Knox wrote:
> I seem to have the issue below when building Geos 3.0.2 with Cygwin.
> Is there a solution to this problem of double inclusion, or do I need
> to install an older version 
> of Geos (I am reluctant to do this as I have a recent version of GCC,
> which requires a 
> recent version of the source code to build).
> 
> Many thanks for your help - sorry I can't work this out for myself but
> only just starting to build
> things myself!
> 
> Regards
> 
> Stephen


Hi Stephen,

This is exactly the same problem experienced on MingW with the
DLL_EXPORT stubs causing the inlines to be defined twice at link time.
There is already a fix for this in the current source code for MingW, so
in theory all we have to do is expand the check to suppress the
duplicates when compiling with cygwin GCC as well as MingW.

Please try the attached patch to see if will allow you to compile on
cygwin - I've confirmed that the changes still allow GEOS to compile on
MingW without any problems.


HTH,

Mark.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos-cygwin.patch
Type: text/x-patch
Size: 813 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081026/cbdf76bb/geos-cygwin.bin
From Denise.MacLeod at ingres.com  Mon Oct 27 09:28:38 2008
From: Denise.MacLeod at ingres.com (Denise MacLeod)
Date: Mon Oct 27 09:28:40 2008
Subject: [geos-devel] Creating an invalid geometry
Message-ID: <ABB90CDC9A08FF49851AC42557795A180306030B@USINVMAILB01.ingres.prv>

Hi all -

I am trying to work on issue #170, a memory leak when performing the intersection of a valid and an invalid polygon. My question is: how do I get an invalid polygon?  I have one in a file in WKT format, but when reading it in, GEOSGeomFromWKT detects that's invalid and returns a NULL pointer. Likewise, the WKB function has similar logic. It's too robust  :-)

Is there anyway quick way around this, without changing the source to skip the validation step in GEOSGeomFromWKT?

Thanks,
Denise

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081027/765f84a0/attachment.html
From warmerdam at pobox.com  Mon Oct 27 09:49:11 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Oct 27 09:49:35 2008
Subject: [geos-devel] Creating an invalid geometry
In-Reply-To: <ABB90CDC9A08FF49851AC42557795A180306030B@USINVMAILB01.ingres.prv>
References: <ABB90CDC9A08FF49851AC42557795A180306030B@USINVMAILB01.ingres.prv>
Message-ID: <4905C6D7.5030401@pobox.com>

Denise MacLeod wrote:
> Hi all -
> 
> I am trying to work on issue #170, a memory leak when performing the 
> intersection of a valid and an invalid polygon. My question is: how do I 
> get an invalid polygon?  I have one in a file in WKT format, but when 
> reading it in, GEOSGeomFromWKT detects that's invalid and returns a NULL 
> pointer. Likewise, the WKB function has similar logic. It's too robust  :-)
> 
> Is there anyway quick way around this, without changing the source to 
> skip the validation step in GEOSGeomFromWKT?

Denise,

Presumably you can create the invalid geometries the direct geometry
creation methods:


extern GEOSGeometry GEOS_DLL *GEOSGeom_createPoint(GEOSCoordSequence* s);
extern GEOSGeometry GEOS_DLL *GEOSGeom_createLinearRing(GEOSCoordSequence* s);
extern GEOSGeometry GEOS_DLL *GEOSGeom_createLineString(GEOSCoordSequence* s);

/*
  * Second argument is an array of GEOSGeometry* objects.
  * The caller remains owner of the array, but pointed-to
  * objects become ownership of the returned GEOSGeometry.
  */
extern GEOSGeometry GEOS_DLL *GEOSGeom_createPolygon(GEOSGeometry* shell,
	GEOSGeometry** holes, unsigned int nholes);
extern GEOSGeometry GEOS_DLL *GEOSGeom_createCollection(int type,
	GEOSGeometry* *geoms, unsigned int ngeoms);

extern GEOSGeometry GEOS_DLL *GEOSGeom_clone(const GEOSGeometry* g);

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From geosanak at gmail.com  Mon Oct 27 10:42:34 2008
From: geosanak at gmail.com (Sanak)
Date: Mon Oct 27 10:42:37 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <53F9CF533E1AA14EA1F8C5C08ABC08D204EB9DE5@ZDND.DND.boston.cob>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob>
	<49009A10.2030903@pobox.com>
	<5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com>
	<30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob>
	<30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob>
	<30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com>
	<53F9CF533E1AA14EA1F8C5C08ABC08D204EB9DE5@ZDND.DND.boston.cob>
Message-ID: <5f9be0a0810270742u56b2951cn37d5c3562a20a2db@mail.gmail.com>

Paul, Regina

Sorry, I am a Windows person, and have few knowledge of *nix and Mac
environment.
So please check Regina's modified patch. Thanks Regina.

On another note, I am a developer of GEOS COM Wrapper(
http://sourceforge.jp/projects/geos-com/) project.
Currently, the geos-com api interface is flat, and sample is VB6 only,
but in the future, I want to apply swig-com(
http://code.google.com/soc/2008/swig/appinfo.html?csaid=39B8865043331AF)
based api,
and add browser sample(use IE + OpenLayers, and has "JTS Test Builder"-like
user interface).
Please look forward to it!

Regards,

2008/10/25 Obe, Regina <robe.dnd@cityofboston.gov>

> Paul,
>
> Can you try applying this revised attached patch.  I ran into the same
> issues you described when trying to apply the tortoise generated patch
> to my OpenSUSE VM install.
>
> I used the original patch he sent since didn't want to fuss with
> updating trunk and I really don't want geos 3.0 having stuff that trunk
> doesn't have.
>
> As a workaround I
> 1) checked out  geos 3.0 on both OpenSUSE VM and windows
> 2) patched my windows using tortoise svn with Sanak's patch
> 3) uploaded changed files to OpenSuse VM
> 4) Did a svn diff on my OpenSUSE to generate this new patch
>
> 5) To test I wiped out my msvc8 on windows did svn checkout and applied
> the patch I created in OpenSuse  and then did a build in VS8 to make
> sure it worked.
>
> 6) Also did the same thing in OpenSuse
>
> I'm sure there is a more elegant way to do this, but that's the best I
> could do with my limited skill set :(.
>
> Thanks,
> Regina
>
> -----Original Message-----
> From: geos-devel-bounces@lists.osgeo.org
> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> Sent: Friday, October 24, 2008 11:50 AM
> To: GEOS Development List
> Subject: Re: [geos-devel] 3.0.3 To Do
>
> I tried the earlier one and that didn't work either. I'm suspecting my
> OS/X patch is (a) first stripping the CRs from the dos-generated patch
> and then (b) not finding any matches in the dos-formatted target file.
> I think someone else with a cygwin sandbox should apply this patch.
>
> P.
>
> On Fri, Oct 24, 2008 at 8:46 AM, Obe, Regina <robe.dnd@cityofboston.gov>
> wrote:
> > Paul,
> >
> > The earlier one doesn't add any new files so may be more appropriate.
> > This one adds a new geostest folder to the msvc80 and geostest to the
> > solution to add the test that Frank was running using make.vc (that
> does
> > the test.wkt compare thing).
> >
> > Note:  this geostest isn't even in trunk so I'm questioning if we
> really
> > want to include it in the geos 3.0 branch. If we do we should include
> it
> > in trunk to be consistent.
> >
> > Since we already have a unit test for VC and the unit test is much
> > easier to use than the geostest, I question the value of adding this
> > extra project to the solution.
> >
> > Thanks,
> > Regina
> >
> >
> >
> > -----Original Message-----
> > From: geos-devel-bounces@lists.osgeo.org
> > [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul Ramsey
> > Sent: Friday, October 24, 2008 11:39 AM
> > To: GEOS Development List
> > Subject: Re: [geos-devel] 3.0.3 To Do
> >
> > On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina
> <robe.dnd@cityofboston.gov>
> > wrote:
> >> Actually which patch are you referring to.  The version one or the
> big
> >> patch.  I just redownloaded the msvc80 folder from svn that has your
> > version
> >> patch and then reapplied Sanak's patch and didn't run into any
> > conflicts.
> >
> > this one
> > geos-branches-3.0-build-msvc80_add_geostest.patch
> >
> > should I be doing the earlier one?
> >
> > P
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> > -----------------------------------------
> > The substance of this message, including any attachments, may be
> > confidential, legally privileged and/or exempt from disclosure
> > pursuant to Massachusetts law. It is intended
> > solely for the addressee. If you received this in error, please
> > contact the sender and delete the material from any computer.
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081027/1dbea4da/attachment.html
From robe.dnd at cityofboston.gov  Mon Oct 27 10:56:00 2008
From: robe.dnd at cityofboston.gov (Obe, Regina)
Date: Mon Oct 27 10:56:04 2008
Subject: [geos-devel] 3.0.3 To Do
In-Reply-To: <5f9be0a0810270742u56b2951cn37d5c3562a20a2db@mail.gmail.com>
References: <30fe546d0810221157l3230a5adhec1a8d39d088e145@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204E8CD15@ZDND.DND.boston.cob><49009A10.2030903@pobox.com><5f9be0a0810231052x6cbcae57kd79555a7df7efbfa@mail.gmail.com><30fe546d0810232041l29cb7b33w6380d0e52f127e8a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204D7EFD3@ZDND.DND.boston.cob><30fe546d0810240838i72e3b9a0n47d53f42fe23832a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204EB99FC@ZDND.DND.boston.cob><30fe546d0810240850t7800835chdbe5bc28430f1f1a@mail.gmail.com><53F9CF533E1AA14EA1F8C5C08ABC08D204EB9DE5@ZDND.DND.boston.cob>
	<5f9be0a0810270742u56b2951cn37d5c3562a20a2db@mail.gmail.com>
Message-ID: <53F9CF533E1AA14EA1F8C5C08ABC08D204EBA1CB@ZDND.DND.boston.cob>

Sanak,
 
Sounds great.  Actually Paul has already applied the patch to geos 3.0
branch.  We left out the geos_test part though since it wasn't in trunk
so used just the original patch you sent.
 
Feel free to test it out.  
 
Paul,
 
 When are you going to release a geos 3.0.3.  Maybe we should make it
geos 3.0.3 RC1 since if we continue going at this rate we'll catch up to
3.1 and then we'll be forced to release 3.1  :).
 
Thanks,
Regina

________________________________

From: geos-devel-bounces@lists.osgeo.org
[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Sanak
Sent: Monday, October 27, 2008 10:43 AM
To: GEOS Development List
Subject: Re: [geos-devel] 3.0.3 To Do


Paul, Regina

Sorry, I am a Windows person, and have few knowledge of *nix and Mac
environment.
So please check Regina's modified patch. Thanks Regina.

On another note, I am a developer of GEOS COM
Wrapper(http://sourceforge.jp/projects/geos-com/) project.
Currently, the geos-com api interface is flat, and sample is VB6 only,
but in the future, I want to apply
swig-com(http://code.google.com/soc/2008/swig/appinfo.html?csaid=39B8865
043331AF) based api, 
and add browser sample(use IE + OpenLayers, and has "JTS Test
Builder"-like user interface).
Please look forward to it!

Regards,


2008/10/25 Obe, Regina <robe.dnd@cityofboston.gov>


	Paul,
	
	Can you try applying this revised attached patch.  I ran into
the same
	issues you described when trying to apply the tortoise generated
patch
	to my OpenSUSE VM install.
	
	I used the original patch he sent since didn't want to fuss with
	updating trunk and I really don't want geos 3.0 having stuff
that trunk
	doesn't have.
	
	As a workaround I
	1) checked out  geos 3.0 on both OpenSUSE VM and windows
	2) patched my windows using tortoise svn with Sanak's patch
	3) uploaded changed files to OpenSuse VM
	4) Did a svn diff on my OpenSUSE to generate this new patch
	
	5) To test I wiped out my msvc8 on windows did svn checkout and
applied
	the patch I created in OpenSuse  and then did a build in VS8 to
make
	sure it worked.
	
	6) Also did the same thing in OpenSuse
	
	I'm sure there is a more elegant way to do this, but that's the
best I
	could do with my limited skill set :(.
	

	Thanks,
	Regina
	
	-----Original Message-----
	From: geos-devel-bounces@lists.osgeo.org
	[mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul
Ramsey
	
	Sent: Friday, October 24, 2008 11:50 AM
	To: GEOS Development List
	Subject: Re: [geos-devel] 3.0.3 To Do
	
	I tried the earlier one and that didn't work either. I'm
suspecting my
	OS/X patch is (a) first stripping the CRs from the dos-generated
patch
	and then (b) not finding any matches in the dos-formatted target
file.
	I think someone else with a cygwin sandbox should apply this
patch.
	
	P.
	
	On Fri, Oct 24, 2008 at 8:46 AM, Obe, Regina
<robe.dnd@cityofboston.gov>
	wrote:
	> Paul,
	>
	> The earlier one doesn't add any new files so may be more
appropriate.
	> This one adds a new geostest folder to the msvc80 and geostest
to the
	> solution to add the test that Frank was running using make.vc
(that
	does
	> the test.wkt compare thing).
	>
	> Note:  this geostest isn't even in trunk so I'm questioning if
we
	really
	> want to include it in the geos 3.0 branch. If we do we should
include
	it
	> in trunk to be consistent.
	>
	> Since we already have a unit test for VC and the unit test is
much
	> easier to use than the geostest, I question the value of
adding this
	> extra project to the solution.
	>
	> Thanks,
	> Regina
	>
	>
	>
	> -----Original Message-----
	> From: geos-devel-bounces@lists.osgeo.org
	> [mailto:geos-devel-bounces@lists.osgeo.org] On Behalf Of Paul
Ramsey
	> Sent: Friday, October 24, 2008 11:39 AM
	> To: GEOS Development List
	> Subject: Re: [geos-devel] 3.0.3 To Do
	>
	> On Thu, Oct 23, 2008 at 9:48 PM, Obe, Regina
	<robe.dnd@cityofboston.gov>
	> wrote:
	>> Actually which patch are you referring to.  The version one
or the
	big
	>> patch.  I just redownloaded the msvc80 folder from svn that
has your
	> version
	>> patch and then reapplied Sanak's patch and didn't run into
any
	> conflicts.
	>
	> this one
	> geos-branches-3.0-build-msvc80_add_geostest.patch
	>
	> should I be doing the earlier one?
	>
	> P
	> _______________________________________________
	> geos-devel mailing list
	> geos-devel@lists.osgeo.org
	> http://lists.osgeo.org/mailman/listinfo/geos-devel
	> -----------------------------------------
	> The substance of this message, including any attachments, may
be
	> confidential, legally privileged and/or exempt from disclosure
	> pursuant to Massachusetts law. It is intended
	> solely for the addressee. If you received this in error,
please
	> contact the sender and delete the material from any computer.
	> _______________________________________________
	> geos-devel mailing list
	> geos-devel@lists.osgeo.org
	> http://lists.osgeo.org/mailman/listinfo/geos-devel
	>
	_______________________________________________
	geos-devel mailing list
	geos-devel@lists.osgeo.org
	http://lists.osgeo.org/mailman/listinfo/geos-devel
	

	_______________________________________________
	geos-devel mailing list
	geos-devel@lists.osgeo.org
	http://lists.osgeo.org/mailman/listinfo/geos-devel
	



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081027/ab2112c7/attachment-0001.html
From pramsey at cleverelephant.ca  Mon Oct 27 12:13:15 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon Oct 27 12:13:17 2008
Subject: [geos-devel] 3.0.3rc1
Message-ID: <30fe546d0810270913n3555da5cjdc80f49830ef0035@mail.gmail.com>

Per request, here's an RC prior to release. Should build on various
new flavours of GCC and (perhaps?) windows too.
One patch outstanding, the cygwin patch Mark posted a day ago, I'm
waiting to hear back if that helped.

P.
From pramsey at cleverelephant.ca  Tue Oct 28 00:20:37 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Tue Oct 28 00:20:39 2008
Subject: [geos-devel] Fw: 3.0?
In-Reply-To: <1225056325.13178.6.camel@mca-desktop>
References: <503875.71853.qm@web28608.mail.ukl.yahoo.com>
	<1225056325.13178.6.camel@mca-desktop>
Message-ID: <30fe546d0810272120i4080ba2fp3835fe361013ea7f@mail.gmail.com>

Stephen,

Can you confirm the patch helps? This is the last item pre-3.0.3 I
have to close off.

Thanks,

P.

On Sun, Oct 26, 2008 at 2:25 PM, Mark Cave-Ayland
<mark.cave-ayland@ilande.co.uk> wrote:
> On Thu, 2008-10-23 at 08:53 +0000, S Knox wrote:
>> I seem to have the issue below when building Geos 3.0.2 with Cygwin.
>> Is there a solution to this problem of double inclusion, or do I need
>> to install an older version
>> of Geos (I am reluctant to do this as I have a recent version of GCC,
>> which requires a
>> recent version of the source code to build).
>>
>> Many thanks for your help - sorry I can't work this out for myself but
>> only just starting to build
>> things myself!
>>
>> Regards
>>
>> Stephen
>
>
> Hi Stephen,
>
> This is exactly the same problem experienced on MingW with the
> DLL_EXPORT stubs causing the inlines to be defined twice at link time.
> There is already a fix for this in the current source code for MingW, so
> in theory all we have to do is expand the check to suppress the
> duplicates when compiling with cygwin GCC as well as MingW.
>
> Please try the attached patch to see if will allow you to compile on
> cygwin - I've confirmed that the changes still allow GEOS to compile on
> MingW without any problems.
>
>
> HTH,
>
> Mark.
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From geos-trac at osgeo.org  Tue Oct 28 18:26:31 2008
From: geos-trac at osgeo.org (GEOS)
Date: Tue Oct 28 18:26:32 2008
Subject: [geos-devel] [GEOS] #213: geos_c.h should always include stddef.h
Message-ID: <046.122abeefe466858f66b8fd6ef6300562@osgeo.org>

#213: geos_c.h should always include stddef.h
------------------------+---------------------------------------------------
 Reporter:  slinkp      |       Owner:  geos-devel@lists.osgeo.org
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:                            
Component:  Default     |     Version:                            
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 geos_c.h contains these lines:
 {{{
 #ifndef __cplusplus
 # include <stddef.h> /* for size_t definition */
 #endif
 }}}

 I don't know squat about C++, but I'm told by a coworker that the
 conditional is wrong.
 It usually happens to work because we have probably already included
 stddef.h from elsewhere.
 It should really just be:

 {{{
 # include <stddef.h> /* for size_t definition */
 }}}

 We discovered this while trying to use the h2xml.py script from ctypeslib
 on geos_c.h... that script in turn uses gccxml.  After making the above
 change, it works.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/213>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From roxyknox at yahoo.co.uk  Wed Oct 29 05:43:21 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Wed Oct 29 05:43:24 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <837323.39816.qm@web28612.mail.ukl.yahoo.com>

Mark,

Sorry for the late reply, but a personal issue came up, so haven't had a lot of time recently. After some searching, I found the following post, and followed the instructions within to see if it would compile: http://lists.refractions.net/pipermail/geos-devel/2007-January/002766.html

After changing the headers as suggested in the patch, it seemed to compile OK. Unfortunately I can't test the new patch right now, but should be able to in about 10 hours or so when I get home.

Many thanks for your help & I'll report back later

Regards

Stephen Knox




________________________________
From: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>
To: GEOS Development List <geos-devel@lists.osgeo.org>
Cc: S Knox <roxyknox@yahoo.co.uk>
Sent: Sunday, 26 October, 2008 21:25:25
Subject: Re: [geos-devel] Fw: 3.0?

On Thu, 2008-10-23 at 08:53 +0000, S Knox wrote:
> I seem to have the issue below when building Geos 3.0.2 with Cygwin.
> Is there a solution to this problem of double inclusion, or do I need
> to install an older version 
> of Geos (I am reluctant to do this as I have a recent version of GCC,
> which requires a 
> recent version of the source code to build).
> 
> Many thanks for your help - sorry I can't work this out for myself but
> only just starting to build
> things myself!
> 
> Regards
> 
> Stephen


Hi Stephen,

This is exactly the same problem experienced on MingW with the
DLL_EXPORT stubs causing the inlines to be defined twice at link time.
There is already a fix for this in the current source code for MingW, so
in theory all we have to do is expand the check to suppress the
duplicates when compiling with cygwin GCC as well as MingW.

Please try the attached patch to see if will allow you to compile on
cygwin - I've confirmed that the changes still allow GEOS to compile on
MingW without any problems.


HTH,

Mark.


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081029/e3ab1fa9/attachment.html
From mark.cave-ayland at ilande.co.uk  Wed Oct 29 06:20:04 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Wed Oct 29 06:20:07 2008
Subject: [geos-devel] Fw: 3.0?
In-Reply-To: <837323.39816.qm@web28612.mail.ukl.yahoo.com>
References: <837323.39816.qm@web28612.mail.ukl.yahoo.com>
Message-ID: <41535.81.187.123.11.1225275604.squirrel@www.ilande.co.uk>

> Mark,
>
> Sorry for the late reply, but a personal issue came up, so haven't had a
lot of time recently. After some searching, I found the following post,
and followed the instructions within to see if it would compile:
http://lists.refractions.net/pipermail/geos-devel/2007-January/002766.html
>
> After changing the headers as suggested in the patch, it seemed to
compile
> OK. Unfortunately I can't test the new patch right now, but should be
able
> to in about 10 hours or so when I get home.
>
> Many thanks for your help & I'll report back later
>
> Regards
>
> Stephen Knox


Hi Stephen,

Yeah that's exactly how the previously attached patch works, by expanding
the #if to include cygwin as well as MingW. I see that Paul has applied
the patch to 3.0 branch SVN, so you could try that or download 3.0.3RC1
and apply the patch there. If it works, I think it's minimally invasive
enough to make the 3.0.3 final release.


ATB,

Mark.





From roxyknox at yahoo.co.uk  Wed Oct 29 21:29:46 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Wed Oct 29 21:29:49 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <601484.79857.qm@web28604.mail.ukl.yahoo.com>

Dear all,

I tried running compiling using the latest geos-svn.tar.gz (yesterday evening) which contained the modification mentioned below. Unfortunately it gave the same errors as before i.e:

....... multiple definition of`geos::operation::overlay
::MinimalEdgeRing::~MinimalEdgeRing()'
.libs/inlines.o:/home/Stevo/geos-3.1.0/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:43: first defined here
Creating library file: .libs/libgeos.dll.a
collect2: ld returned 1 exit status
make[2]: *** [libgeos.la] Error 1
make[2]: Leaving directory `/home/Stevo/geos-3.1.0/source'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/Stevo/geos-3.1.0/source'


So not sure how I got it to work on my system, looks like I've got beginners luck!

Sorry I can't help

Regards

Stephen


________________________________
From: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>
To: S Knox <roxyknox@yahoo.co.uk>
Cc: GEOS Development List <geos-devel@lists.osgeo.org>
Sent: Wednesday, 29 October, 2008 10:20:04
Subject: Re: [geos-devel] Fw: 3.0?

> Mark,
>
> Sorry for the late reply, but a personal issue came up, so haven't had a
lot of time recently. After some searching, I found the following post,
and followed the instructions within to see if it would compile:
http://lists.refractions.net/pipermail/geos-devel/2007-January/002766.html
>
> After changing the headers as suggested in the patch, it seemed to
compile
> OK. Unfortunately I can't test the new patch right now, but should be
able
> to in about 10 hours or so when I get home.
>
> Many thanks for your help & I'll report back later
>
> Regards
>
> Stephen Knox


Hi Stephen,

Yeah that's exactly how the previously attached patch works, by expanding
the #if to include cygwin as well as MingW. I see that Paul has applied
the patch to 3.0 branch SVN, so you could try that or download 3.0.3RC1
and apply the patch there. If it works, I think it's minimally invasive
enough to make the 3.0.3 final release.


ATB,

Mark.


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081030/979dca8c/attachment.html
From mark.cave-ayland at ilande.co.uk  Thu Oct 30 10:53:14 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Thu Oct 30 10:53:16 2008
Subject: [geos-devel] Fw: 3.0?
In-Reply-To: <601484.79857.qm@web28604.mail.ukl.yahoo.com>
References: <601484.79857.qm@web28604.mail.ukl.yahoo.com>
Message-ID: <43211.81.187.123.11.1225378394.squirrel@www.ilande.co.uk>

> Dear all,
>
> I tried running compiling using the latest geos-svn.tar.gz (yesterday
> evening) which contained the modification mentioned below. Unfortunately
> it gave the same errors as before i.e:
>
> ....... multiple definition of`geos::operation::overlay
> ::MinimalEdgeRing::~MinimalEdgeRing()'
> .libs/inlines.o:/home/Stevo/geos-3.1.0/source/../source/headers/geos/operation/overlay/MinimalEdgeRing.inl:43:
> first defined here
> Creating library file: .libs/libgeos.dll.a
> collect2: ld returned 1 exit status
> make[2]: *** [libgeos.la] Error 1
> make[2]: Leaving directory `/home/Stevo/geos-3.1.0/source'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory `/home/Stevo/geos-3.1.0/source'
>
>
> So not sure how I got it to work on my system, looks like I've got
> beginners luck!
>
> Sorry I can't help
>
> Regards
>
> Stephen


Hi Stephen,

Hmmmm that's a pain. You mentioned that you'd altered the headers
according to one of my earlier emails and the compilation worked? So in
that case what is the difference between the version you did manage to
compile, and what is currently in SVN?


ATB,

Mark.


From geos-trac at osgeo.org  Thu Oct 30 14:42:56 2008
From: geos-trac at osgeo.org (GEOS)
Date: Thu Oct 30 14:42:58 2008
Subject: [geos-devel] [GEOS] #214: Exception in 404  page
Message-ID: <046.2a12a5c1e5b2bd31622471d2d3c29671@osgeo.org>

#214: Exception in 404  page
------------------------+---------------------------------------------------
 Reporter:  slinkp      |       Owner:  geos-devel@lists.osgeo.org
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:                            
Component:  Default     |     Version:                            
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 {{{
 2008-10-30T14:16:56 ERROR SiteError Exception while rendering view on
 exception
 Traceback (most recent call last):
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.app.publication-3.4.3-py2.4.egg/zope/app/publication/zopepublication.py",
 line 334, in handleException
     body = mapply(view, (), request)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.publisher-3.4.2-py2.4.egg/zope/publisher/publish.py", line 108,
 in mapply
     return debug_call(obj, args)
    - __traceback_info__: <opengeo.almanac.error.NotFoundView object at
 0x404bbf8>
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.publisher-3.4.2-py2.4.egg/zope/publisher/publish.py", line 114,
 in debug_call
     return obj(*args)
   File "/home/pw/builds/geo/almanac/develop-eggs/grok-0.13-
 py2.4.egg/grok/components.py", line 172, in __call__
     return self._render_template()
   File "/home/pw/builds/geo/almanac/develop-eggs/grok-0.13-
 py2.4.egg/grok/components.py", line 176, in _render_template
     return self.template.render(self)
   File "/home/pw/builds/geo/almanac/develop-eggs/grok-0.13-
 py2.4.egg/grok/components.py", line 381, in render
     return template.pt_render(namespace)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.pagetemplate-3.4.0-py2.4.egg/zope/pagetemplate/pagetemplate.py",
 line 115, in pt_render
     strictinsert=0, sourceAnnotations=sourceAnnotations)()
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 271, in
 __call__
     self.interpret(self.program)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 346, in
 interpret
     handlers[opcode](self, args)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 891, in
 do_useMacro
     self.interpret(macro)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 346, in
 interpret
     handlers[opcode](self, args)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 536, in
 do_optTag_tal
     self.do_optTag(stuff)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 521, in
 do_optTag
     return self.no_tag(start, program)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 516, in
 no_tag
     self.interpret(program)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 346, in
 interpret
     handlers[opcode](self, args)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tal-3.4.1-py2.4.egg/zope/tal/talinterpreter.py", line 586, in
 do_setLocal_tal
     self.engine.setLocal(name, self.engine.evaluateValue(expr))
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tales-3.4.0-py2.4.egg/zope/tales/tales.py", line 696, in
 evaluate
     return expression(self)
    -
 /home/pw/builds/geo/almanac/src/CommunityAlmanac/opengeo/almanac/templates/maintemplate.pt
    - Line 30, Column 2
    - Expression: <PathExpr standard:u'view/application_url|default'>
    - Names:
       {'args': (),
        'context': <zope.traversing.namespace.view object at 0x2e9b5f8>,
        'default': <object object at 0x2b3969aa4518>,
        'loop': {},
        'nothing': None,
        'options': {},
        'repeat': {},
        'request': <zc.resourcelibrary.publication.Request instance
 URL=http://localhost:8181/@@view/index.html>,
        'static': <grok.components.DirectoryResource object at 0x404bb38>,
        'template': <grok.components.TrustedFilePageTemplate object at
 0x4464d78>,
        'view': <opengeo.almanac.error.NotFoundView object at 0x404bbf8>}
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tales-3.4.0-py2.4.egg/zope/tales/expressions.py", line 217, in
 __call__
     return self._eval(econtext)
   File "/home/pw/builds/geo/almanac/develop-
 eggs/zope.tales-3.4.0-py2.4.egg/zope/tales/expressions.py", line 211, in
 _eval
     return ob()
   File "/home/pw/builds/geo/almanac/develop-eggs/grok-0.13-
 py2.4.egg/grok/components.py", line 236, in application_url
     obj = obj.__parent__
 AttributeError: 'view' object has no attribute '__parent__'

 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/214>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Thu Oct 30 14:43:22 2008
From: geos-trac at osgeo.org (GEOS)
Date: Thu Oct 30 14:43:23 2008
Subject: [geos-devel] Re: [GEOS] #214: Exception in 404  page
In-Reply-To: <046.2a12a5c1e5b2bd31622471d2d3c29671@osgeo.org>
References: <046.2a12a5c1e5b2bd31622471d2d3c29671@osgeo.org>
Message-ID: <055.49b51bd1fab9a3900d50d9f938c8bedf@osgeo.org>

#214: Exception in 404  page
------------------------+---------------------------------------------------
 Reporter:  slinkp      |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect      |       Status:  closed                    
 Priority:  major       |    Milestone:                            
Component:  Default     |      Version:                            
 Severity:  Unassigned  |   Resolution:  invalid                   
 Keywords:              |  
------------------------+---------------------------------------------------
Changes (by slinkp):

  * status:  new => closed
  * resolution:  => invalid

Comment:

 Very sorry - wrong Trac!

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/214#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From roxyknox at yahoo.co.uk  Thu Oct 30 20:51:53 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Thu Oct 30 20:51:57 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <135727.66589.qm@web28601.mail.ukl.yahoo.com>

Skipped content of type multipart/alternative-------------- next part --------------
/**********************************************************************
 * $Id: inlines.cpp 1975 2007-02-26 10:46:12Z strk $
 *
 * GEOS - Geometry Engine Open Source
 * http://geos.refractions.net
 *
 * Copyright (C) 2005-2006 Refractions Research Inc.
 *
 * This is free software; you can redistribute and/or modify it under
 * the terms of the GNU Lesser General Public Licence as published
 * by the Free Software Foundation. 
 * See the COPYING file for more information.
 *
 **********************************************************************
 *
 * This file is here to make all inlined functions also 
 * available as non-inlines when building with GEOS_INLINES defined.
 *
 **********************************************************************/


// Only do something if GEOS_INLINE is defined
// Otherwise we'll end up with duplicated symbols
#ifdef GEOS_INLINE

// If using MingW with GEOS_INLINE to build a DLL then MingW's gcc
// has already generated the stubs for the contents of this file. 
// Hence we need to supress it to avoid "multiple definition" errors
// during the final link phase
#if defined(__MINGW32__) && !defined(DLL_EXPORT)


// Undefine GEOS_INLINE so that .inl files
// will be ready for an implementation file
#undef GEOS_INLINE 
@@ -50,4 +57,7 @@
#include <geos/inline.h>

#include <geos/io/WKTReader.inl>
#include <geos/io/ByteOrderDataInStream.inl>
#include <geos/operation/overlay/MinimalEdgeRing.inl>
#include <geos/geomgraph/DirectedEdge.inl>
#include <geos/geomgraph/GeometryGraph.inl>
#include <geos/algorithm/ConvexHull.inl>
#include <geos/geom/GeometryCollection.inl>
#include <geos/geom/LineSegment.inl>
#include <geos/geom/PrecisionModel.inl>
#include <geos/geom/Geometry.inl>
#include <geos/geom/Envelope.inl>
#include <geos/geom/Coordinate.inl>
#include <geos/geom/GeometryFactory.inl>
#include <geos/geom/MultiLineString.inl>
#include <geos/geom/MultiPolygon.inl>
#include <geos/geom/CoordinateArraySequenceFactory.inl>
#include <geos/noding/SegmentString.inl>
#include <geos/noding/snapround/HotPixel.inl>
#include <geos/noding/snapround/MCIndexSnapRounder.inl>
#include <geos/noding/MCIndexNoder.inl>


#endif // defined __MINGW32__ and !defined DLL_EXPORT

#endif // defined GEOS_INLINE
From roxyknox at yahoo.co.uk  Fri Oct 31 04:26:45 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Fri Oct 31 04:26:48 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <717450.11644.qm@web28616.mail.ukl.yahoo.com>

Skipped content of type multipart/alternative-------------- next part --------------
/**********************************************************************
 * $Id$
 *
 * GEOS - Geometry Engine Open Source
 * http://geos.refractions.net
 *
 * Copyright (C) 2001-2002 Vivid Solutions Inc.
 * Copyright (C) 2005 Refractions Research Inc.
 *
 * This is free software; you can redistribute and/or modify it under
 * the terms of the GNU Lesser General Public Licence as published
 * by the Free Software Foundation. 
 * See the COPYING file for more information.
 *
 **********************************************************************
 *
 * Last port: algorithm/HCoordinate.java rev. 1.17 (JTS-1.7)
 *
 **********************************************************************/

#include <geos/algorithm/HCoordinate.h>
#include <geos/algorithm/NotRepresentableException.h>
#include <geos/geom/Coordinate.h>
#include <geos/platform.h>

#include <memory>
#include <cmath> // for finite()
#include <iostream>
#include <iomanip>

// For MingW builds with __STRICT_ANSI__ (-ansi)
// See: http://geos.refractions.net/pipermail/geos-devel/2006-June/002342.html
#if defined(__GNUC__) && defined(_WIN32)
int __cdecl _finite (double);
#define finite(x) _finite(x)
#endif

#ifndef GEOS_DEBUG
#define GEOS_DEBUG 0
#endif

// Define to make -ffloat-store be effective for this class
//#define STORE_INTERMEDIATE_COMPUTATION_VALUES 1

using namespace std;
using namespace geos::geom;

namespace geos {
namespace algorithm { // geos.algorithm

/*public static*/
void
HCoordinate::intersection(const Coordinate &p1, const Coordinate &p2,
	const Coordinate &q1, const Coordinate &q2, Coordinate &ret)
{

#if GEOS_DEBUG
	cerr << __FUNCTION__ << ":" << endl
	     << setprecision(20)
	     << " p1: " << p1 << endl
	     << " p2: " << p2 << endl
	     << " q1: " << q1 << endl
	     << " q2: " << q2 << endl;
#endif

        HCoordinate hc1p1(p1);

#if GEOS_DEBUG
	cerr << "HCoordinate(p1): "
	     << hc1p1 << endl;
#endif

        HCoordinate hc1p2(p2);

#if GEOS_DEBUG
	cerr << "HCoordinate(p2): "
	     << hc1p2 << endl;
#endif

        HCoordinate l1(hc1p1, hc1p2);

#if GEOS_DEBUG
	cerr << "L1 - HCoordinate(HCp1, HCp2): "
	     << l1 << endl;
#endif

        HCoordinate hc2q1(q1);

#if GEOS_DEBUG
	cerr << "HCoordinate(q1): "
	     << hc2q1 << endl;
#endif

        HCoordinate hc2q2(q2);

#if GEOS_DEBUG
	cerr << "HCoordinate(q2): "
	     << hc2q2 << endl;
#endif

        HCoordinate l2(hc2q1, hc2q2);

#if GEOS_DEBUG
	cerr << "L2 - HCoordinate(HCq1, HCq2): "
	     << l2 << endl;
#endif

        HCoordinate intHCoord(l1, l2);

#if GEOS_DEBUG
	cerr << "HCoordinate(L1, L2): "
	     << intHCoord << endl;
#endif

        intHCoord.getCoordinate(ret);

}

/*public*/
HCoordinate::HCoordinate()
	:
	x(0.0),
	y(0.0),
	w(1.0)
{
}

/*public*/
HCoordinate::HCoordinate(long double _x, long double _y, long double _w)
	:
	x(_x),
	y(_y),
	w(_w)
{
}

/*public*/
HCoordinate::HCoordinate(const Coordinate& p)
	:
	x(p.x),
	y(p.y),
	w(1.0)
{
}

/*public*/
#ifndef STORE_INTERMEDIATE_COMPUTATION_VALUES

HCoordinate::HCoordinate(const HCoordinate &p1, const HCoordinate &p2)
	:
	x( p1.y*p2.w - p2.y*p1.w ),
	y( p2.x*p1.w - p1.x*p2.w ),
	w( p1.x*p2.y - p2.x*p1.y )
{
}

#else // def STORE_INTERMEDIATE_COMPUTATION_VALUES

HCoordinate::HCoordinate(const HCoordinate &p1, const HCoordinate &p2)
{
        long double xf1 = p1.y*p2.w;
        long double xf2 = p2.y*p1.w;
        x = xf1 - xf2;

        long double yf1 = p2.x*p1.w;
        long double yf2 = p1.x*p2.w;
        y = yf1 - yf2;

        long double wf1 = p1.x*p2.y;
        long double wf2 = p2.x*p1.y;
        w = wf1 - wf2;

#if GEOS_DEBUG
        cerr
             << " xf1: " << xf1 << endl
             << " xf2: " << xf2 << endl
             << " yf1: " << yf1 << endl
             << " yf2: " << yf2 << endl
             << " wf1: " << wf1 << endl
             << " wf2: " << wf2 << endl
             << "   x: " << x << endl
             << "   y: " << y << endl
             << "   w: " << w << endl;
#endif // def GEOS_DEBUG
}
#endif // def STORE_INTERMEDIATE_COMPUTATION_VALUES

/*public*/
long double
HCoordinate::getX() const
{
	long double a = x/w;

	// finite() also checks for NaN
	if ( ! finite(a) )
	{
		throw  NotRepresentableException();
	}
	return a;
}

/*public*/
long double
HCoordinate::getY() const
{
	long double a = y/w;

	// finite() also checks for NaN
	if ( ! finite(a) )
	{
		throw  NotRepresentableException();
	}
	return a;
}

/*public*/
void
HCoordinate::getCoordinate(Coordinate &ret) const
{
	ret=Coordinate(getX(), getY());
}

std::ostream& operator<< (std::ostream& o, const HCoordinate& c)
{
	return o << "(" << c.x << ", "
	         << c.y << ") [w: " << c.w << "]";
}

} // namespace geos.algorithm
} // namespace geos

/**********************************************************************
 * $Log$
 * Revision 1.24  2006/06/27 15:59:36  strk
 * * source/algorithm/HCoordinate.cpp: added support for MingW -ansi builds.
 *
 * Revision 1.23  2006/04/20 14:27:40  strk
 * HCoordinate class changed to use long double types internally, in order to improve computation precision
 *
 * Revision 1.22  2006/04/20 11:11:57  strk
 * source/algorithm/HCoordinate.cpp: added compile time define to force storage of intermediate computation values to variables (in order to make the -ffloat-store gcc switch effective). Disabled by default.
 *
 * Revision 1.21  2006/04/14 09:02:16  strk
 * Hadded output operator and debugging prints for HCoordinate.
 *
 * Revision 1.20  2006/04/04 11:37:00  strk
 * Port information + initialization lists in ctors
 *
 * Revision 1.19  2006/04/04 11:28:12  strk
 * NotRepresentable condition detected using finite() from <cmath>
 * rather then using FINITE() macro. Made ::intersection() body
 * more readable.
 *
 * Revision 1.18  2006/03/21 11:12:23  strk
 * Cleanups: headers inclusion and Log section
 *
 * Revision 1.17  2006/03/09 16:46:45  strk
 * geos::geom namespace definition, first pass at headers split
 **********************************************************************/

From mark.cave-ayland at ilande.co.uk  Fri Oct 31 10:14:59 2008
From: mark.cave-ayland at ilande.co.uk (Mark Cave-Ayland)
Date: Fri Oct 31 10:15:01 2008
Subject: [geos-devel] Fw: 3.0?
In-Reply-To: <717450.11644.qm@web28616.mail.ukl.yahoo.com>
References: <717450.11644.qm@web28616.mail.ukl.yahoo.com>
Message-ID: <41594.81.187.123.11.1225462499.squirrel@www.ilande.co.uk>

> Sorry, forgot to mention that HCoordinate.cpp changed as well in order to
> be able to compile on Cygwin, as per last post. Here's the file I used>
>
> Regards
>
> Stephen Knox


Hi Stephen,

Okay, it's a little difficult to work out the changes from the complete
files. Would you be able post a diff between your geos-svn directory tree
that does compile, and the one you have changed? Something like:

diff -cr geos-svn.orig geos-svn.compiles

Also, can you try compiling using a proper SVN checkout from GEOS 3.0
branch? This is really just to make sure that the tarball is being updated
correctly.


Many thanks,

Mark.


From gdt at ir.bbn.com  Fri Oct 31 13:04:00 2008
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri Oct 31 13:04:02 2008
Subject: [geos-devel] 3.0.3rc1
In-Reply-To: <30fe546d0810270913n3555da5cjdc80f49830ef0035@mail.gmail.com>
	(Paul Ramsey's message of "Mon, 27 Oct 2008 09:13:15 -0700")
References: <30fe546d0810270913n3555da5cjdc80f49830ef0035@mail.gmail.com>
Message-ID: <rmi7i7o7l33.fsf@fnord.ir.bbn.com>


I ran make check on 3.0.3rc1 on a NetBSD 4.0_STABLE sparc64 machine.  It
failed, but I think it's because my resource limits allow only 256M of
data segment (the machine is old and only has 512M total).  Is 'make
check' expected to need such a vast amount of RAM?

my log if anyone wants to look at it:

http://www.lexort.com/software/geos/geos-3.0.3rc1-make-check-NetBSD-sparc64
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 193 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20081031/f2c370be/attachment.bin
From roxyknox at yahoo.co.uk  Fri Oct 31 13:06:01 2008
From: roxyknox at yahoo.co.uk (S Knox)
Date: Fri Oct 31 13:06:03 2008
Subject: [geos-devel] Fw: 3.0?
Message-ID: <229077.55117.qm@web28605.mail.ukl.yahoo.com>

Yes, I'll try and do that this weekend, but it will be towards the end, as am away for the weekend.

Regarding the SVN checkout - I tried this, however I noticed that the files required for configure to work are not present. [You might have to make some allowances for my inexperience here!!]. I take it this is normal, and one should use autogen.sh I tried this, however it didn't work and I got some error messages, which I can't remember off the top of my head so I had to use the tarball.

Have a good weekend

Stephen




________________________________
From: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>
To: GEOS Development List <geos-devel@lists.osgeo.org>
Sent: Friday, 31 October, 2008 14:14:59
Subject: Re: [geos-devel] Fw: 3.0?

> Sorry, forgot to mention that HCoordinate.cpp changed as well in order to
> be able to compile on Cygwin, as per last post. Here's the file I used>
>
> Regards
>
> Stephen Knox


Hi Stephen,

Okay, it's a little difficult to work out the changes from the complete
files. Would you be able post a diff between your geos-svn directory tree
that does compile, and the one you have changed? Something like:

diff -cr geos-svn.orig geos-svn.compiles

Also, can you try compiling using a proper SVN checkout from GEOS 3.0
branch? This is really just to make sure that the tarball is being updated
correctly.


Many thanks,

Mark.


_______________________________________________
geos-devel mailing list
geos-devel@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/geos-devel



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20081031/0c9e9e6c/attachment.html
From pramsey at cleverelephant.ca  Fri Oct 31 13:10:00 2008
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Fri Oct 31 13:10:02 2008
Subject: [geos-devel] 3.0.3rc1
In-Reply-To: <rmi7i7o7l33.fsf@fnord.ir.bbn.com>
References: <30fe546d0810270913n3555da5cjdc80f49830ef0035@mail.gmail.com>
	<rmi7i7o7l33.fsf@fnord.ir.bbn.com>
Message-ID: <30fe546d0810311010m10c5b036o8a30fed137730dda@mail.gmail.com>

There are a couple tests, some big buffers, I think, that do use a
fair amount of RAM...

P

On Fri, Oct 31, 2008 at 10:04 AM, Greg Troxel <gdt@ir.bbn.com> wrote:
> I ran make check on 3.0.3rc1 on a NetBSD 4.0_STABLE sparc64 machine.  It
> failed, but I think it's because my resource limits allow only 256M of
> data segment (the machine is old and only has 512M total).  Is 'make
> check' expected to need such a vast amount of RAM?
>
> my log if anyone wants to look at it:
>
> http://www.lexort.com/software/geos/geos-3.0.3rc1-make-check-NetBSD-sparc64
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
