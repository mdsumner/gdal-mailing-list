From sean.gillies at gmail.com  Mon Feb  1 05:04:39 2010
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon Feb  1 05:04:44 2010
Subject: [geos-devel] Questions about linear referencing
Message-ID: <70610220-EC62-4D10-B7D0-C064107532F1@gmail.com>

The GEOSProject function returns a numerical value when passed a line  
string and a point not on the line. If the point is beyond (in some  
sense) the line's starting point, you get 0.0 (normalized). If the  
point is past (in some sense) the line's end point, you get 1.0  
(normalized to the line's length). If the point is otherwise off of  
the line but not past one of its ends in that sense, you get a value  
between 0 and 1.

Is this intended? The behavior seems like it could get rather  
unpredictable for anything other than a perfectly straight line.

--
Sean

From novalis at novalis.org  Mon Feb  1 10:31:38 2010
From: novalis at novalis.org (David Turner)
Date: Mon Feb  1 10:34:26 2010
Subject: [geos-devel] Questions about linear referencing
In-Reply-To: <70610220-EC62-4D10-B7D0-C064107532F1@gmail.com>
References: <70610220-EC62-4D10-B7D0-C064107532F1@gmail.com>
Message-ID: <1265038298.1089.23.camel@cory>

On Mon, 2010-02-01 at 11:04 +0100, Sean Gillies wrote:
> The GEOSProject function returns a numerical value when passed a line  
> string and a point not on the line. If the point is beyond (in some  
> sense) the line's starting point, you get 0.0 (normalized). If the  
> point is past (in some sense) the line's end point, you get 1.0  
> (normalized to the line's length). If the point is otherwise off of  
> the line but not past one of its ends in that sense, you get a value  
> between 0 and 1.
> 
> Is this intended? The behavior seems like it could get rather  
> unpredictable for anything other than a perfectly straight line.

This comes from the LengthIndexedLine::project method.  That method
finds the closest point along the geometry to the input point.  That
closest point could be one of the end points.  Why is this
unpredictable?

From geos-trac at osgeo.org  Mon Feb  1 10:37:47 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  1 10:37:49 2010
Subject: [geos-devel] [GEOS] #325: there is no destroy function for
	CoordinateSequence
Message-ID: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>

#325: there is no destroy function for CoordinateSequence
------------------------+---------------------------------------------------
 Reporter:  aharon      |       Owner:  geos-devel@lists.osgeo.org
     Type:  task        |      Status:  new                       
 Priority:  blocker     |   Milestone:                            
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 we can create CoordinateSequence by CoordinateSequenceFactory::Creae
 but, there is no way to distroy the creaed CoordinteSequence.
 also there is no way to create/distroy std::vector<Geomtry> .

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/325>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  1 10:47:20 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  1 10:47:22 2010
Subject: [geos-devel] Re: [GEOS] #325: there is no destroy function for
	CoordinateSequence
In-Reply-To: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
References: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
Message-ID: <055.4b84f8396bb023426c82d58089c43210@osgeo.org>

#325: there is no destroy function for CoordinateSequence
------------------------+---------------------------------------------------
 Reporter:  aharon      |        Owner:  geos-devel@lists.osgeo.org
     Type:  task        |       Status:  new                       
 Priority:  blocker     |    Milestone:                            
Component:  Default     |      Version:  svn-trunk                 
 Severity:  Unassigned  |   Resolution:                            
 Keywords:              |  
------------------------+---------------------------------------------------
Comment (by aharon):

 we can create Coordinate Sequence by CoordinateSequenceFactory::Creae but,
 there is no way to distroy the creaed Coordinte Sequence. also there is no
 way to create/distroy std::vector<Geomtry> .

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/325#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From sean.gillies at gmail.com  Mon Feb  1 11:20:46 2010
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon Feb  1 11:20:54 2010
Subject: [geos-devel] Questions about linear referencing
In-Reply-To: <1265038298.1089.23.camel@cory>
References: <70610220-EC62-4D10-B7D0-C064107532F1@gmail.com>
	<1265038298.1089.23.camel@cory>
Message-ID: <EA321C0F-E5A0-4BB0-83D5-6BBDBC69D7A5@gmail.com>


On Feb 1, 2010, at 4:31 PM, David Turner wrote:

> On Mon, 2010-02-01 at 11:04 +0100, Sean Gillies wrote:
>> The GEOSProject function returns a numerical value when passed a line
>> string and a point not on the line. If the point is beyond (in some
>> sense) the line's starting point, you get 0.0 (normalized). If the
>> point is past (in some sense) the line's end point, you get 1.0
>> (normalized to the line's length). If the point is otherwise off of
>> the line but not past one of its ends in that sense, you get a value
>> between 0 and 1.
>>
>> Is this intended? The behavior seems like it could get rather
>> unpredictable for anything other than a perfectly straight line.
>
> This comes from the LengthIndexedLine::project method.  That method
> finds the closest point along the geometry to the input point.  That
> closest point could be one of the end points.  Why is this
> unpredictable?

That does seem predictable. I just couldn't tell from the code or docs  
what the intent of the function exactly was. If it's intent is the  
same as ST_line_locate_point from PostGIS, I'm clear.

Thanks,

--
Sean

From mbdavis at refractions.net  Mon Feb  1 12:48:57 2010
From: mbdavis at refractions.net (Martin Davis)
Date: Mon Feb  1 12:45:55 2010
Subject: [geos-devel] rgeos interface to R classes (sp, others)
In-Reply-To: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
References: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
Message-ID: <4B671409.5070707@refractions.net>

Roger,

The technique of using buffer(0) to union polygons is now deprecated in 
favour of using Unary Union (Geometry.union() - not sure what the exact 
GEOS signature is).  Unary Union is usually faster and more robust than 
the previous technique.  You might want to check this out.

Martin

Roger Bivand wrote:
> Hi,
>
> I've felt that I've been making reasonable progress with interfacing 
> GEOS geometries and methods for the R language (cran.r-project.org), 
> in a draft contributed package rgeos:
>
> https://r-forge.r-project.org/projects/rgeos/
>
> However, I encountered a problem that I do not understand, and would 
> be very grateful if I could be put back on track. The specific problem 
> is that an R function uses the C API to dissolve polygon borders for 
> adjacent polygons sharing a category given as its second argument.
>
> I've used the buffer technique from the JTS documentation, and all was 
> well until I tried to dissolve borders between touching squares when 
> the coordinate measures were small (square side 0.1). When the squares 
> are 100 units, all is well, and GEOMTouches is TRUE. But for 0.1, 
> GEOMTouches is FALSE, and no dissolving takes place.
>
> This can be reproduced (I'm on RHEL5, x86_64) by installing R, 
> contributed packages sp and maptools from CRAN, GEOS (3.1.1 or 3.2.0), 
> and installing rgeos from R-Forge. Start R, say
>
> library(rgeos) example(unionSpatialPolygonsGEOS)
>
> and look for undissolved borders in:
>
> image(grd, axes=TRUE)
> plot(spol1, add=TRUE)
>
> but dissolved in:
>
> image(grdx, axes=TRUE)
> plot(spol1x, add=TRUE)
>
> I started on an alternative implementation using GEOMTouches in 
> unionSpatialPolygonsGEOS(..., buffer=FALSE) output to console, where 
> one sees in the example output:
>
>> spol1F <- unionSpatialPolygonsGEOS(as(spol, "SpatialPolygons"),
> +   as.character(spol$xvs), buffer=FALSE)
> # 4 squares within (0,0), (0.2,0.2) NE, NW, SW share category, SE doesn't
> npls: 3, nnpls: 3
> type[0] Polygon
> i: 0, j: 1, touches: 0
> i: 0, j: 2, touches: 0
> type[1] Polygon
> i: 1, j: 2, touches: 0
> type[2] Polygon
> out of function
> npls: 1, nnpls: 1
> type[0] Polygon
> out of function
>> spol1xF <- unionSpatialPolygonsGEOS(as(spolx, "SpatialPolygons"),
> +   as.character(spolx$xvs), buffer=FALSE)
> # 4 squares within (0,0), (200,200), same categories
> npls: 3, nnpls: 3
> type[0] Polygon
> i: 0, j: 1, touches: 1
> i: 0, j: 2, touches: 1
> type[1] Polygon
> i: 1, j: 2, touches: 1
> type[2] Polygon
> out of function
> npls: 1, nnpls: 1
> type[0] Polygon
> out of function
>
> The C code is in:
>
> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/src/rgeos_sp.c?rev=44&root=rgeos&view=log 
>
>
> around line 466 rgeos_SpatialPolygonsUnion(), calling 
> rgeos_plspairUnion() - desperate test framework, or 
> rgeos_plsbufUnion() which I had thought worked, but which clearly 
> doesn't dissolve small squares.
>
> Very grateful for any help, this is a show-stopper, and I had hoped to 
> release rgeos before February (small chance now!)
>
> Roger
>

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From geos-trac at osgeo.org  Mon Feb  1 12:51:57 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  1 12:51:58 2010
Subject: [geos-devel] Re: [GEOS] #325: there is no destroy function for
	CoordinateSequence
In-Reply-To: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
References: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
Message-ID: <055.f4d734cd74f803f0d150ddce78848deb@osgeo.org>

#325: there is no destroy function for CoordinateSequence
------------------------+---------------------------------------------------
 Reporter:  aharon      |        Owner:  geos-devel@lists.osgeo.org
     Type:  task        |       Status:  new                       
 Priority:  blocker     |    Milestone:                            
Component:  Default     |      Version:  svn-trunk                 
 Severity:  Unassigned  |   Resolution:                            
 Keywords:              |  
------------------------+---------------------------------------------------
Comment (by mloskot):

 I can confirm there is not named destructor provided for the
 CoordinateSequence and related types. Amazingly, I have no idea myself why
 it's missing or even how it is supposed to be designed.

 Sandro, Paul, is it intentional?

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/325#comment:2>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From Roger.Bivand at nhh.no  Mon Feb  1 13:19:59 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon Feb  1 13:18:35 2010
Subject: [geos-devel] rgeos interface to R classes (sp, others)
In-Reply-To: <4B671409.5070707@refractions.net>
References: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
	<4B671409.5070707@refractions.net>
Message-ID: <alpine.LRH.2.00.1002011906570.13477@reclus.nhh.no>

On Mon, 1 Feb 2010, Martin Davis wrote:

> Roger,
>
> The technique of using buffer(0) to union polygons is now deprecated in 
> favour of using Unary Union (Geometry.union() - not sure what the exact GEOS 
> signature is).  Unary Union is usually faster and more robust than the 
> previous technique.  You might want to check this out.

Martin,

Thanks, I've replaced buffer(0) by GEOSUnionCascaded (C API). But the 
artefact remains. For input MULTIPOLYGON:

---------
|   |   |
|   |   |
|--------
|   |
|   |
-----

I still get the same MultiPolygon out when the bounding box is 
(0,0)(0.2,0.2), but correctly Polygon:

---------
|       |
|       |
|   -----
|   |
|   |
-----

when the bounding box is (0,0)(200,200). May this be related to the input 
Polygon objects only having 5 coordinates (4 corners and closure)? The 
generating code is inserting exactly the same doubles into the 
coordinates.

Anyway, I'm sure that Unary Union is a better solution than buffer(0) in 
general, so thanks for that!

Roger


>
> Martin
>
> Roger Bivand wrote:
>> Hi,
>> 
>> I've felt that I've been making reasonable progress with interfacing GEOS 
>> geometries and methods for the R language (cran.r-project.org), in a draft 
>> contributed package rgeos:
>> 
>> https://r-forge.r-project.org/projects/rgeos/
>> 
>> However, I encountered a problem that I do not understand, and would be 
>> very grateful if I could be put back on track. The specific problem is that 
>> an R function uses the C API to dissolve polygon borders for adjacent 
>> polygons sharing a category given as its second argument.
>> 
>> I've used the buffer technique from the JTS documentation, and all was well 
>> until I tried to dissolve borders between touching squares when the 
>> coordinate measures were small (square side 0.1). When the squares are 100 
>> units, all is well, and GEOMTouches is TRUE. But for 0.1, GEOMTouches is 
>> FALSE, and no dissolving takes place.
>> 
>> This can be reproduced (I'm on RHEL5, x86_64) by installing R, contributed 
>> packages sp and maptools from CRAN, GEOS (3.1.1 or 3.2.0), and installing 
>> rgeos from R-Forge. Start R, say
>> 
>> library(rgeos) example(unionSpatialPolygonsGEOS)
>> 
>> and look for undissolved borders in:
>> 
>> image(grd, axes=TRUE)
>> plot(spol1, add=TRUE)
>> 
>> but dissolved in:
>> 
>> image(grdx, axes=TRUE)
>> plot(spol1x, add=TRUE)
>> 
>> I started on an alternative implementation using GEOMTouches in 
>> unionSpatialPolygonsGEOS(..., buffer=FALSE) output to console, where one 
>> sees in the example output:
>> 
>>> spol1F <- unionSpatialPolygonsGEOS(as(spol, "SpatialPolygons"),
>> +   as.character(spol$xvs), buffer=FALSE)
>> # 4 squares within (0,0), (0.2,0.2) NE, NW, SW share category, SE doesn't
>> npls: 3, nnpls: 3
>> type[0] Polygon
>> i: 0, j: 1, touches: 0
>> i: 0, j: 2, touches: 0
>> type[1] Polygon
>> i: 1, j: 2, touches: 0
>> type[2] Polygon
>> out of function
>> npls: 1, nnpls: 1
>> type[0] Polygon
>> out of function
>>> spol1xF <- unionSpatialPolygonsGEOS(as(spolx, "SpatialPolygons"),
>> +   as.character(spolx$xvs), buffer=FALSE)
>> # 4 squares within (0,0), (200,200), same categories
>> npls: 3, nnpls: 3
>> type[0] Polygon
>> i: 0, j: 1, touches: 1
>> i: 0, j: 2, touches: 1
>> type[1] Polygon
>> i: 1, j: 2, touches: 1
>> type[2] Polygon
>> out of function
>> npls: 1, nnpls: 1
>> type[0] Polygon
>> out of function
>> 
>> The C code is in:
>> 
>> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/src/rgeos_sp.c?rev=44&root=rgeos&view=log 
>> 
>> around line 466 rgeos_SpatialPolygonsUnion(), calling rgeos_plspairUnion() 
>> - desperate test framework, or rgeos_plsbufUnion() which I had thought 
>> worked, but which clearly doesn't dissolve small squares.
>> 
>> Very grateful for any help, this is a show-stopper, and I had hoped to 
>> release rgeos before February (small chance now!)
>> 
>> Roger
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From mbdavis at refractions.net  Mon Feb  1 13:26:57 2010
From: mbdavis at refractions.net (Martin Davis)
Date: Mon Feb  1 13:23:56 2010
Subject: [geos-devel] rgeos interface to R classes (sp, others)
In-Reply-To: <alpine.LRH.2.00.1002011906570.13477@reclus.nhh.no>
References: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
	<4B671409.5070707@refractions.net>
	<alpine.LRH.2.00.1002011906570.13477@reclus.nhh.no>
Message-ID: <4B671CF1.306@refractions.net>

Can you post the WKT/WKB of your test case? 

Roger Bivand wrote:
> On Mon, 1 Feb 2010, Martin Davis wrote:
>
>> Roger,
>>
>> The technique of using buffer(0) to union polygons is now deprecated 
>> in favour of using Unary Union (Geometry.union() - not sure what the 
>> exact GEOS signature is).  Unary Union is usually faster and more 
>> robust than the previous technique.  You might want to check this out.
>
> Martin,
>
> Thanks, I've replaced buffer(0) by GEOSUnionCascaded (C API). But the 
> artefact remains. For input MULTIPOLYGON:
>
> ---------
> |   |   |
> |   |   |
> |--------
> |   |
> |   |
> -----
>
> I still get the same MultiPolygon out when the bounding box is 
> (0,0)(0.2,0.2), but correctly Polygon:
>
> ---------
> |       |
> |       |
> |   -----
> |   |
> |   |
> -----
>
> when the bounding box is (0,0)(200,200). May this be related to the 
> input Polygon objects only having 5 coordinates (4 corners and 
> closure)? The generating code is inserting exactly the same doubles 
> into the coordinates.
>
> Anyway, I'm sure that Unary Union is a better solution than buffer(0) 
> in general, so thanks for that!
>
> Roger
>
>
>>
>> Martin
>>
>> Roger Bivand wrote:
>>> Hi,
>>>
>>> I've felt that I've been making reasonable progress with interfacing 
>>> GEOS geometries and methods for the R language (cran.r-project.org), 
>>> in a draft contributed package rgeos:
>>>
>>> https://r-forge.r-project.org/projects/rgeos/
>>>
>>> However, I encountered a problem that I do not understand, and would 
>>> be very grateful if I could be put back on track. The specific 
>>> problem is that an R function uses the C API to dissolve polygon 
>>> borders for adjacent polygons sharing a category given as its second 
>>> argument.
>>>
>>> I've used the buffer technique from the JTS documentation, and all 
>>> was well until I tried to dissolve borders between touching squares 
>>> when the coordinate measures were small (square side 0.1). When the 
>>> squares are 100 units, all is well, and GEOMTouches is TRUE. But for 
>>> 0.1, GEOMTouches is FALSE, and no dissolving takes place.
>>>
>>> This can be reproduced (I'm on RHEL5, x86_64) by installing R, 
>>> contributed packages sp and maptools from CRAN, GEOS (3.1.1 or 
>>> 3.2.0), and installing rgeos from R-Forge. Start R, say
>>>
>>> library(rgeos) example(unionSpatialPolygonsGEOS)
>>>
>>> and look for undissolved borders in:
>>>
>>> image(grd, axes=TRUE)
>>> plot(spol1, add=TRUE)
>>>
>>> but dissolved in:
>>>
>>> image(grdx, axes=TRUE)
>>> plot(spol1x, add=TRUE)
>>>
>>> I started on an alternative implementation using GEOMTouches in 
>>> unionSpatialPolygonsGEOS(..., buffer=FALSE) output to console, where 
>>> one sees in the example output:
>>>
>>>> spol1F <- unionSpatialPolygonsGEOS(as(spol, "SpatialPolygons"),
>>> +   as.character(spol$xvs), buffer=FALSE)
>>> # 4 squares within (0,0), (0.2,0.2) NE, NW, SW share category, SE 
>>> doesn't
>>> npls: 3, nnpls: 3
>>> type[0] Polygon
>>> i: 0, j: 1, touches: 0
>>> i: 0, j: 2, touches: 0
>>> type[1] Polygon
>>> i: 1, j: 2, touches: 0
>>> type[2] Polygon
>>> out of function
>>> npls: 1, nnpls: 1
>>> type[0] Polygon
>>> out of function
>>>> spol1xF <- unionSpatialPolygonsGEOS(as(spolx, "SpatialPolygons"),
>>> +   as.character(spolx$xvs), buffer=FALSE)
>>> # 4 squares within (0,0), (200,200), same categories
>>> npls: 3, nnpls: 3
>>> type[0] Polygon
>>> i: 0, j: 1, touches: 1
>>> i: 0, j: 2, touches: 1
>>> type[1] Polygon
>>> i: 1, j: 2, touches: 1
>>> type[2] Polygon
>>> out of function
>>> npls: 1, nnpls: 1
>>> type[0] Polygon
>>> out of function
>>>
>>> The C code is in:
>>>
>>> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/src/rgeos_sp.c?rev=44&root=rgeos&view=log 
>>>
>>> around line 466 rgeos_SpatialPolygonsUnion(), calling 
>>> rgeos_plspairUnion() - desperate test framework, or 
>>> rgeos_plsbufUnion() which I had thought worked, but which clearly 
>>> doesn't dissolve small squares.
>>>
>>> Very grateful for any help, this is a show-stopper, and I had hoped 
>>> to release rgeos before February (small chance now!)
>>>
>>> Roger
>>>
>>
>>
>

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From Roger.Bivand at nhh.no  Mon Feb  1 15:27:31 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon Feb  1 15:26:09 2010
Subject: [geos-devel] rgeos interface to R classes (sp, others)
In-Reply-To: <4B671CF1.306@refractions.net>
References: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
	<4B671409.5070707@refractions.net>
	<alpine.LRH.2.00.1002011906570.13477@reclus.nhh.no>
	<4B671CF1.306@refractions.net>
Message-ID: <alpine.LRH.2.00.1002012117280.14080@reclus.nhh.no>

On Mon, 1 Feb 2010, Martin Davis wrote:

> Can you post the WKT/WKB of your test case?

If this is WKT, then:

> SP2WKT(spol0)
[1] "MULTIPOLYGON(((0 0.1,0 0.2,0.1 0.2,0.1 0.1,0 0.1)),
   ((0.1 0.1,0.1 0.2,0.2 0.2,0.2 0.1,0.1 0.1)),
   ((0 0,0 0.1,0.1 0.1,0.1 0,0 0)))"
> SP2WKT(spolx0)
[1] "MULTIPOLYGON(((0 100,0 200,100 200,100 100,0 100)),
   ((100 100,100 200,200 200,200 100,100 100)),
   ((0 0,0 100,100 100,100 0,0 0)))"
>

I don't think that there is an OGR driver, is there? So this is a text 
representation for the two objects, each with 3 Polygon members, and only 
differing in scale (the coordinates of the second are 1000 times those of 
the first). I see the same difference on GEOS 3.2.0/C API 1.6.0 on x86_64 
RHEL5 and with an MSYS-built GEOS 3.2.0/C API 1.6.0 on Win 32 R.

Hope this is good enough, grateful for any ideas,

Roger


> Roger Bivand wrote:
>> On Mon, 1 Feb 2010, Martin Davis wrote:
>> 
>>> Roger,
>>> 
>>> The technique of using buffer(0) to union polygons is now deprecated in 
>>> favour of using Unary Union (Geometry.union() - not sure what the exact 
>>> GEOS signature is).  Unary Union is usually faster and more robust than 
>>> the previous technique.  You might want to check this out.
>> 
>> Martin,
>> 
>> Thanks, I've replaced buffer(0) by GEOSUnionCascaded (C API). But the 
>> artefact remains. For input MULTIPOLYGON:
>> 
>> ---------
>> |   |   |
>> |   |   |
>> |--------
>> |   |
>> |   |
>> -----
>> 
>> I still get the same MultiPolygon out when the bounding box is 
>> (0,0)(0.2,0.2), but correctly Polygon:
>> 
>> ---------
>> |       |
>> |       |
>> |   -----
>> |   |
>> |   |
>> -----
>> 
>> when the bounding box is (0,0)(200,200). May this be related to the input 
>> Polygon objects only having 5 coordinates (4 corners and closure)? The 
>> generating code is inserting exactly the same doubles into the coordinates.
>> 
>> Anyway, I'm sure that Unary Union is a better solution than buffer(0) in 
>> general, so thanks for that!
>> 
>> Roger
>> 
>> 
>>> 
>>> Martin
>>> 
>>> Roger Bivand wrote:
>>>> Hi,
>>>> 
>>>> I've felt that I've been making reasonable progress with interfacing GEOS 
>>>> geometries and methods for the R language (cran.r-project.org), in a 
>>>> draft contributed package rgeos:
>>>> 
>>>> https://r-forge.r-project.org/projects/rgeos/
>>>> 
>>>> However, I encountered a problem that I do not understand, and would be 
>>>> very grateful if I could be put back on track. The specific problem is 
>>>> that an R function uses the C API to dissolve polygon borders for 
>>>> adjacent polygons sharing a category given as its second argument.
>>>> 
>>>> I've used the buffer technique from the JTS documentation, and all was 
>>>> well until I tried to dissolve borders between touching squares when the 
>>>> coordinate measures were small (square side 0.1). When the squares are 
>>>> 100 units, all is well, and GEOMTouches is TRUE. But for 0.1, GEOMTouches 
>>>> is FALSE, and no dissolving takes place.
>>>> 
>>>> This can be reproduced (I'm on RHEL5, x86_64) by installing R, 
>>>> contributed packages sp and maptools from CRAN, GEOS (3.1.1 or 3.2.0), 
>>>> and installing rgeos from R-Forge. Start R, say
>>>> 
>>>> library(rgeos) example(unionSpatialPolygonsGEOS)
>>>> 
>>>> and look for undissolved borders in:
>>>> 
>>>> image(grd, axes=TRUE)
>>>> plot(spol1, add=TRUE)
>>>> 
>>>> but dissolved in:
>>>> 
>>>> image(grdx, axes=TRUE)
>>>> plot(spol1x, add=TRUE)
>>>> 
>>>> I started on an alternative implementation using GEOMTouches in 
>>>> unionSpatialPolygonsGEOS(..., buffer=FALSE) output to console, where one 
>>>> sees in the example output:
>>>> 
>>>>> spol1F <- unionSpatialPolygonsGEOS(as(spol, "SpatialPolygons"),
>>>> +   as.character(spol$xvs), buffer=FALSE)
>>>> # 4 squares within (0,0), (0.2,0.2) NE, NW, SW share category, SE doesn't
>>>> npls: 3, nnpls: 3
>>>> type[0] Polygon
>>>> i: 0, j: 1, touches: 0
>>>> i: 0, j: 2, touches: 0
>>>> type[1] Polygon
>>>> i: 1, j: 2, touches: 0
>>>> type[2] Polygon
>>>> out of function
>>>> npls: 1, nnpls: 1
>>>> type[0] Polygon
>>>> out of function
>>>>> spol1xF <- unionSpatialPolygonsGEOS(as(spolx, "SpatialPolygons"),
>>>> +   as.character(spolx$xvs), buffer=FALSE)
>>>> # 4 squares within (0,0), (200,200), same categories
>>>> npls: 3, nnpls: 3
>>>> type[0] Polygon
>>>> i: 0, j: 1, touches: 1
>>>> i: 0, j: 2, touches: 1
>>>> type[1] Polygon
>>>> i: 1, j: 2, touches: 1
>>>> type[2] Polygon
>>>> out of function
>>>> npls: 1, nnpls: 1
>>>> type[0] Polygon
>>>> out of function
>>>> 
>>>> The C code is in:
>>>> 
>>>> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/src/rgeos_sp.c?rev=44&root=rgeos&view=log 
>>>> around line 466 rgeos_SpatialPolygonsUnion(), calling 
>>>> rgeos_plspairUnion() - desperate test framework, or rgeos_plsbufUnion() 
>>>> which I had thought worked, but which clearly doesn't dissolve small 
>>>> squares.
>>>> 
>>>> Very grateful for any help, this is a show-stopper, and I had hoped to 
>>>> release rgeos before February (small chance now!)
>>>> 
>>>> Roger
>>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From pramsey at cleverelephant.ca  Mon Feb  1 17:08:44 2010
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon Feb  1 17:08:47 2010
Subject: [geos-devel] FOSS4G 2010 Call for Papers
Message-ID: <30fe546d1002011408haf97a1aw50f563f3f015d051@mail.gmail.com>

We are pleased to announce the Call for Abstract for the FOSS4G (Free
and Open Source Software for Geospatial) 2010 conference, being held
September 6-9, in beautiful Barcelona, Spain.

Held annually, FOSS4G is the premier conference for the open source
geospatial community, providing a full-immersion experience in
established and leading edge geospatial technologies for developers,
users, and people new to open source geospatial.

  http://2010.foss4g.org

FOSS4G 2010 presentations are 25 minute talks, with 5 minute question
and answer sessions at the end. Presentations cover the use or
development of open source geospatial software. Anyone can can submit
a presentation proposal and take part in the conference as a
presenter.

Some topics of interest for this year are:

* Case Studies: Relate the experiences of you and your organization
using open source geospatial. Where do things work well? Poorly? What
problems did you solve, and at what cost? What do you recommend for
others? Why?
* Benchmarks: Comparisons between pieces of geospatial software. How
do features compare? Speed? Ease of use? What do you recommend for
others?
* Visualization: Tell about your tips and tricks for effective
visualization. How do you present information in a compelling way? 3D?
Cartographic tricks? Labelling and naming ideas? Graphs and hybrid
map/data combinations?
* Development: What are the new developments in your open source
geospatial software product? How does it work, how do people use it,
what are the technical issues you are running into?
* Hacks and Mashing: Have you put together something novel or cool
this year? What did you stick together, how did it work, show us your
gizmo!
* Collaboration: What techniques are you using to improve
collaboration between organizations and between individuals. Public
geodata, collaborative data collection, data sharing, open standards,
de facto standards, and more!

If you have an open source geospatial story to tell, we want to hear it!

For more information, see the FOSS4G site:

  http://2010.foss4g.org/presentations.php

The deadline for abstract submissions is April 1, 2010. Submit early,
submit often!

== Academic Track ==

The FOSS4G 2010 academic track aims to bringing together researchers,
developers, users and practitioners carrying out research and
development in the geospatial and the free and open source fields and
willing to share original and recent research developments and
experiences.

The academic track will act as an inventory of current research
topics, but the major goal is to promote cooperative research between
OSGeo developers and the academia. The academic track is the right
forum to highlight the most important research challenges and trends
in the domain, and let them became the basis for an informal OSGeo
research agenda. It will foster interdisciplinary discussions in all
aspects of the geospatial and free and open source domains. It will be
organized in a way to promote networking between the participants, to
initiate and favour discussions regarding cutting-edge technologies in
the field, to exchange research ideas and to promote international
collaboration.

== Submission Guidelines ==

All submissions to the academic track must be original unpublished
work written in English. Papers should not exceed the 6000 words
limit. Formatting guidelines will be available soon. Submitted papers
will be thoroughly reviewed by three members of the international
scientific committee and refereed for their quality, originality and
relevance.

Submission deadline (full paper for the academic track) - May, 31th, 2010

== Upcoming Milestones ==

15 Jan 2010, Call for Workshops/Tutorials opens
30 Jan 2010, Call for Workshops/Tutorials closes
1 Feb 2010, Call for Abstracts opens
16 Feb 2010, Notification of acceptance for workshops/tutorials
22 Feb 2010, Registration for workshop and tutorials opens
1 Apr 2010, Abstract submission deadline
1 May 2010, Presenters notified of acceptance for talks
15 Jun 2010, Author/Early registration deadline
15 Jul 2010 Full article submission deadline
Aug 2010, Completed program available
6-7 Sep 2010, FOSS4G Workshops
7-9 Sep 2010, FOSS4G Presentations and Tutorials
10 Sep 2010, FOSS4G Code Sprint
From geos-trac at osgeo.org  Tue Feb  2 02:24:14 2010
From: geos-trac at osgeo.org (GEOS)
Date: Tue Feb  2 02:24:23 2010
Subject: [geos-devel] Re: [GEOS] #325: there is no destroy function for
	CoordinateSequence
In-Reply-To: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
References: <046.b2be582d96d11e073c955dc57d37ee61@osgeo.org>
Message-ID: <055.8b5fc4880934d448cd857d9eeb3ae1e1@osgeo.org>

#325: there is no destroy function for CoordinateSequence
------------------------+---------------------------------------------------
 Reporter:  aharon      |        Owner:  geos-devel@lists.osgeo.org
     Type:  task        |       Status:  new                       
 Priority:  blocker     |    Milestone:                            
Component:  Default     |      Version:  svn-trunk                 
 Severity:  Unassigned  |   Resolution:                            
 Keywords:              |  
------------------------+---------------------------------------------------
Comment (by aharon):

 I think that it suppose to be in CoordinateSequenceFactory like
 it is in GeometryFactory.
 GeometryFactory has createGeometry and also distroyGeometry.

 what about creator for std::vector<Geometry>? it is strongly necessary.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/325#comment:3>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Tue Feb  2 18:19:47 2010
From: geos-trac at osgeo.org (GEOS)
Date: Tue Feb  2 18:19:49 2010
Subject: [geos-devel] Re: [GEOS] #299:
 geos::geom::CoordinateArraySequenceFactory unit test failing
In-Reply-To: <047.d99b68335c5950ad504ff227278ead4a@osgeo.org>
References: <047.d99b68335c5950ad504ff227278ead4a@osgeo.org>
Message-ID: <056.7497005adc1b0dfe23339dddc23e4aeb@osgeo.org>

#299: geos::geom::CoordinateArraySequenceFactory unit test failing
----------------------------+-----------------------------------------------
 Reporter:  pramsey         |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect          |       Status:  new                       
 Priority:  major           |    Milestone:  3.3.0                     
Component:  Unit Tests      |      Version:  svn-trunk                 
 Severity:  Unassigned      |   Resolution:                            
 Keywords:  mac,macosx,osx  |  
----------------------------+-----------------------------------------------
Changes (by mloskot):

  * keywords:  => mac,macosx,osx

Comment:

 Duplicated as #328

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/299#comment:18>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From strk at keybit.net  Wed Feb  3 03:14:29 2010
From: strk at keybit.net (strk)
Date: Wed Feb  3 03:14:38 2010
Subject: [geos-devel] [#317] Build configuration for CMake build system
In-Reply-To: <4B63B01E.3050803@loskot.net>
References: <4B54D32E.1050806@loskot.net> <20100119184338.GG489@keybit.net>
	<4B578C44.6010506@loskot.net> <20100121081526.GB21632@keybit.net>
	<4B5A5396.7090909@loskot.net>
	<1af0b2b21001240827q65f6a00bib108ace3fe8f67e4@mail.gmail.com>
	<4B60BA99.6030005@loskot.net> <20100128204102.GW89012@keybit.net>
	<4B63B01E.3050803@loskot.net>
Message-ID: <20100203081429.GA73092@keybit.net>

On Sat, Jan 30, 2010 at 04:05:50AM +0000, Mateusz Loskot wrote:

> The geostest no longer exists in tests/unit
> I presume you are have old source tree nodes still in your copy.

I tried with r2901 on a debian 5.0.3 (sorry if I'm following up
with different systems, just I can't find the time to be single
threaded). Here the cmake build succeeds, but make check fails
(fails tests, not build):

Scanning dependencies of target check
Start processing tests
Test project /usr/src/geos/cmake
  1/  2 Testing geos_unit                        Passed
  2/  2 Testing xmltester                     ***Failed

50% tests passed, 1 tests failed out of 2

The following tests FAILED:
          2 - xmltester (Failed)
Errors while running CTest
make[3]: *** [CMakeFiles/check] Error 8
make[2]: *** [CMakeFiles/check.dir/all] Error 2
make[1]: *** [CMakeFiles/check.dir/rule] Error 2
make: *** [check] Error 2



--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Wed Feb  3 03:17:15 2010
From: strk at keybit.net (strk)
Date: Wed Feb  3 03:17:18 2010
Subject: [geos-devel] cmake build on ubuntu-8.04
In-Reply-To: <4B63B01E.3050803@loskot.net>
References: <4B54D32E.1050806@loskot.net> <20100119184338.GG489@keybit.net>
	<4B578C44.6010506@loskot.net> <20100121081526.GB21632@keybit.net>
	<4B5A5396.7090909@loskot.net>
	<1af0b2b21001240827q65f6a00bib108ace3fe8f67e4@mail.gmail.com>
	<4B60BA99.6030005@loskot.net> <20100128204102.GW89012@keybit.net>
	<4B63B01E.3050803@loskot.net>
Message-ID: <20100203081715.GB73092@keybit.net>

Ubuntu 8.04 cmake build attempt:

$ cmake ../trunk
CMake Error at CMakeLists.txt:220 (if):
  if had incorrect arguments: ${CMAKE_VERSION} VERSION_LESS "2.8.0" (Unknown
  arguments specified).
...

$ cmake --version
cmake version 2.6-patch 0

What's the min version supported ?

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Wed Feb  3 13:28:50 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb  3 13:27:34 2010
Subject: [geos-devel] rgeos interface to R classes (sp, others)
In-Reply-To: <4B685B95.8070300@refractions.net>
References: <alpine.LRH.2.00.1001312026350.10139@reclus.nhh.no>
	<4B671409.5070707@refractions.net>
	<alpine.LRH.2.00.1002011906570.13477@reclus.nhh.no>
	<4B671CF1.306@refractions.net>
	<alpine.LRH.2.00.1002012117280.14080@reclus.nhh.no>
	<4B6740B7.3030902@refractions.net>
	<alpine.LRH.2.00.1002021047030.16338@reclus.nhh.no>
	<4B685B95.8070300@refractions.net>
Message-ID: <alpine.LRH.2.00.1002031917250.22179@reclus.nhh.no>

(reverting to list - link to test C code below).

On Tue, 2 Feb 2010, Martin Davis wrote:

> Roger,
>> 
>> 
>> Thanks for checking. In my coding using GEOS C API they do not, leading to 
>> my puzzlement. I guess it isn't GEOS, so must be my coding, but I can't see 
>> where - nothing I do (I think) is scale-dependent.
> Very strange.  It sounds like it might be a Precision Model problem - but I'm 
> guessing you're just using the default precision model, which is floating 
> point and should handle this test case fine.
>
> GEOS gets extremely well tested via its heritage in JTS and by its use in 
> PostGIS, so the problem is almost certainly in how it is being called, or in 
> some issue with the input data.  I suggest printing out the input and results 
> immediately before and after the GEOS calls, to see if something is going 
> wrong there.
>
> I've tried looking at your code a bit more, but I have to confess that I get 
> lost in the mixture of  function calls to both R and GEOS.  Perhaps you could 
> try and make a simple test program using only GEOS calls?  That will be 
> needed in any case if there is truly a GEOS bug.

Martin:

I've put a small test program on:

http://spatial.nhh.no/misc/test.c

which doesn't reproduce the problem exactly, but obviously isn't right. It 
may be a validity problem, with:

Duplicate Rings at or near point 0 0
type MultiPolygon, valid: 0
reason: Duplicate Rings[0 0]

in (now) both cases, even though I don't see that the three polygons in 
the multipolygon duplicate anything. I now get Polygon objects that are 
not disjoint and have 0 distance not touching. Here UnionCascaded also 
breaks down (probably because of the validity problem). The data are 
hard-coded (and may be wrong too?), rather than brought in from WKT.

Roger

>> 
>>> 
>>> But perhaps your problem lies elsewhere?  I don't understand your 
>>> reference to GEOMTouches in the first email - perhaps this is not 
>>> producing the right result, or is being used incorrectly?
>> 
>> Trying to find out if it was my coding, I tried sequential GEOMTouches 
>> among the polygons in the multipolygon. Again, with a 0.1 x 0.1 square, 
>> they do not touch, but with 100 x 100 they do. I found the problem after 
>> giving advice on the R-sig-geo list about how to create a vector patch map 
>> from a raster (dissolve borders between contiguous vectorised cells), and 
>> was most surprised to see the toy example fail.
> Ah, ok, I understand.
>> 
>> The underlying motivation is to provide R/GEOS integration without Java - 
>> one contributed R package (cshapes) does bundle JTS through Java, but 
>> exchanges data by writing and reading shapefiles (R doesn't fit Java well 
>> installation-wise). In addition, the port of GPC to R that I've used for 
>> this before has serious license problems, and JTS/GEOS are both more 
>> general and license-wise clean.
> That makes perfect sense.  It's always nicer to have a library that is native 
> to the platform you're working on.    (I'm amazed that someone actually 
> interfaced to JTS via files and presumably system calls - but I guess when 
> all you have is a hammer...)
>
>
>
>> 
>> Roger
>> 
>>> 
>>> 
>>> Roger Bivand wrote:
>>>> On Mon, 1 Feb 2010, Martin Davis wrote:
>>>> 
>>>>> Can you post the WKT/WKB of your test case?
>>>> 
>>>> If this is WKT, then:
>>>> 
>>>>> SP2WKT(spol0)
>>>> [1] "MULTIPOLYGON(((0 0.1,0 0.2,0.1 0.2,0.1 0.1,0 0.1)),
>>>>   ((0.1 0.1,0.1 0.2,0.2 0.2,0.2 0.1,0.1 0.1)),
>>>>   ((0 0,0 0.1,0.1 0.1,0.1 0,0 0)))"
>>>>> SP2WKT(spolx0)
>>>> [1] "MULTIPOLYGON(((0 100,0 200,100 200,100 100,0 100)),
>>>>   ((100 100,100 200,200 200,200 100,100 100)),
>>>>   ((0 0,0 100,100 100,100 0,0 0)))"
>>>>> 
>>>> 
>>>> I don't think that there is an OGR driver, is there? So this is a text 
>>>> representation for the two objects, each with 3 Polygon members, and only 
>>>> differing in scale (the coordinates of the second are 1000 times those of 
>>>> the first). I see the same difference on GEOS 3.2.0/C API 1.6.0 on x86_64 
>>>> RHEL5 and with an MSYS-built GEOS 3.2.0/C API 1.6.0 on Win 32 R.
>>>> 
>>>> Hope this is good enough, grateful for any ideas,
>>>> 
>>>> Roger
>>>> 
>>>> 
>>>>> Roger Bivand wrote:
>>>>>> On Mon, 1 Feb 2010, Martin Davis wrote:
>>>>>> 
>>>>>>> Roger,
>>>>>>> 
>>>>>>> The technique of using buffer(0) to union polygons is now deprecated 
>>>>>>> in favour of using Unary Union (Geometry.union() - not sure what the 
>>>>>>> exact GEOS signature is).  Unary Union is usually faster and more 
>>>>>>> robust than the previous technique.  You might want to check this out.
>>>>>> 
>>>>>> Martin,
>>>>>> 
>>>>>> Thanks, I've replaced buffer(0) by GEOSUnionCascaded (C API). But the 
>>>>>> artefact remains. For input MULTIPOLYGON:
>>>>>> 
>>>>>> ---------
>>>>>> |   |   |
>>>>>> |   |   |
>>>>>> |--------
>>>>>> |   |
>>>>>> |   |
>>>>>> -----
>>>>>> 
>>>>>> I still get the same MultiPolygon out when the bounding box is 
>>>>>> (0,0)(0.2,0.2), but correctly Polygon:
>>>>>> 
>>>>>> ---------
>>>>>> |       |
>>>>>> |       |
>>>>>> |   -----
>>>>>> |   |
>>>>>> |   |
>>>>>> -----
>>>>>> 
>>>>>> when the bounding box is (0,0)(200,200). May this be related to the 
>>>>>> input Polygon objects only having 5 coordinates (4 corners and 
>>>>>> closure)? The generating code is inserting exactly the same doubles 
>>>>>> into the coordinates.
>>>>>> 
>>>>>> Anyway, I'm sure that Unary Union is a better solution than buffer(0) 
>>>>>> in general, so thanks for that!
>>>>>> 
>>>>>> Roger
>>>>>> 
>>>>>> 
>>>>>>> 
>>>>>>> Martin
>>>>>>> 
>>>>>>> Roger Bivand wrote:
>>>>>>>> Hi,
>>>>>>>> 
>>>>>>>> I've felt that I've been making reasonable progress with interfacing 
>>>>>>>> GEOS geometries and methods for the R language (cran.r-project.org), 
>>>>>>>> in a draft contributed package rgeos:
>>>>>>>> 
>>>>>>>> https://r-forge.r-project.org/projects/rgeos/
>>>>>>>> 
>>>>>>>> However, I encountered a problem that I do not understand, and would 
>>>>>>>> be very grateful if I could be put back on track. The specific 
>>>>>>>> problem is that an R function uses the C API to dissolve polygon 
>>>>>>>> borders for adjacent polygons sharing a category given as its second 
>>>>>>>> argument.
>>>>>>>> 
>>>>>>>> I've used the buffer technique from the JTS documentation, and all 
>>>>>>>> was well until I tried to dissolve borders between touching squares 
>>>>>>>> when the coordinate measures were small (square side 0.1). When the 
>>>>>>>> squares are 100 units, all is well, and GEOMTouches is TRUE. But for 
>>>>>>>> 0.1, GEOMTouches is FALSE, and no dissolving takes place.
>>>>>>>> 
>>>>>>>> This can be reproduced (I'm on RHEL5, x86_64) by installing R, 
>>>>>>>> contributed packages sp and maptools from CRAN, GEOS (3.1.1 or 
>>>>>>>> 3.2.0), and installing rgeos from R-Forge. Start R, say
>>>>>>>> 
>>>>>>>> library(rgeos) example(unionSpatialPolygonsGEOS)
>>>>>>>> 
>>>>>>>> and look for undissolved borders in:
>>>>>>>> 
>>>>>>>> image(grd, axes=TRUE)
>>>>>>>> plot(spol1, add=TRUE)
>>>>>>>> 
>>>>>>>> but dissolved in:
>>>>>>>> 
>>>>>>>> image(grdx, axes=TRUE)
>>>>>>>> plot(spol1x, add=TRUE)
>>>>>>>> 
>>>>>>>> I started on an alternative implementation using GEOMTouches in 
>>>>>>>> unionSpatialPolygonsGEOS(..., buffer=FALSE) output to console, where 
>>>>>>>> one sees in the example output:
>>>>>>>> 
>>>>>>>>> spol1F <- unionSpatialPolygonsGEOS(as(spol, "SpatialPolygons"),
>>>>>>>> +   as.character(spol$xvs), buffer=FALSE)
>>>>>>>> # 4 squares within (0,0), (0.2,0.2) NE, NW, SW share category, SE 
>>>>>>>> doesn't
>>>>>>>> npls: 3, nnpls: 3
>>>>>>>> type[0] Polygon
>>>>>>>> i: 0, j: 1, touches: 0
>>>>>>>> i: 0, j: 2, touches: 0
>>>>>>>> type[1] Polygon
>>>>>>>> i: 1, j: 2, touches: 0
>>>>>>>> type[2] Polygon
>>>>>>>> out of function
>>>>>>>> npls: 1, nnpls: 1
>>>>>>>> type[0] Polygon
>>>>>>>> out of function
>>>>>>>>> spol1xF <- unionSpatialPolygonsGEOS(as(spolx, "SpatialPolygons"),
>>>>>>>> +   as.character(spolx$xvs), buffer=FALSE)
>>>>>>>> # 4 squares within (0,0), (200,200), same categories
>>>>>>>> npls: 3, nnpls: 3
>>>>>>>> type[0] Polygon
>>>>>>>> i: 0, j: 1, touches: 1
>>>>>>>> i: 0, j: 2, touches: 1
>>>>>>>> type[1] Polygon
>>>>>>>> i: 1, j: 2, touches: 1
>>>>>>>> type[2] Polygon
>>>>>>>> out of function
>>>>>>>> npls: 1, nnpls: 1
>>>>>>>> type[0] Polygon
>>>>>>>> out of function
>>>>>>>> 
>>>>>>>> The C code is in:
>>>>>>>> 
>>>>>>>> https://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/src/rgeos_sp.c?rev=44&root=rgeos&view=log 
>>>>>>>> around line 466 rgeos_SpatialPolygonsUnion(), calling 
>>>>>>>> rgeos_plspairUnion() - desperate test framework, or 
>>>>>>>> rgeos_plsbufUnion() which I had thought worked, but which clearly 
>>>>>>>> doesn't dissolve small squares.
>>>>>>>> 
>>>>>>>> Very grateful for any help, this is a show-stopper, and I had hoped 
>>>>>>>> to release rgeos before February (small chance now!)
>>>>>>>> 
>>>>>>>> Roger
>>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>> 
>>>>> 
>>>>> 
>>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From pramsey at opengeo.org  Thu Feb  4 13:16:55 2010
From: pramsey at opengeo.org (Paul Ramsey)
Date: Thu Feb  4 13:16:59 2010
Subject: [geos-devel] PostGIS 1.5.0 Released
Message-ID: <30fe546d1002041016v2d44159x16704d71c34b3cf7@mail.gmail.com>

February 4, 2010

The PostGIS development team has, after a long course of reflection
and a detailed self-examination of our various personal failings,
decided to release PostGIS 1.5.0 to the public.

  http://postgis.org/download/postgis-1.5.0.tar.gz

This new version of PostGIS includes a new "geography" type for
managing geodetic (lat/lon) data, performance-enhanced distance
calculations, GML and KML format readers, an improved shape loading
GUI, and other new features as well.

Especial thanks to:

* Dave Skea for algorithms and mathematics necessary to support
spherical geometry
* Nicklas Av?n for the new performance enhanced distance calculations
and other distance-related functions
* Sandro Santilli for new buffering features (end caps and style options)
* Olivier Courtin for GML/KML input functions
* Guillaume Lelarge for support for the upcoming PgSQL 9.0
* George Silva for an example implementation of history tables
* Vincent Picavet for Hausdorff distance calculations
* The maintainers of GEOS, Proj4, and LibXML, without whom we would
have less of a spatial database

Love, the PostGIS project steering committee,

Mark Cave-Ayland
Kevin Neufeld
Regina Obe
Paul Ramsey


----- Release Notes ----

PostGIS 1.5.0
2010/02/04

  * Important Changes *

  - =~ operator now indicates bounding box equality, not feature equality
  - GEOS 3.1 is now the minimum accepted version of GEOS
  - GEOS 3.2 is needed if you want to use enhanced buffering features
    and ST_HausdorffDistance
  - GEOS, LibXML2, and Proj4 are now mandatory dependencies

  * New Features *

  - Added Hausdorff distance calculations (#209) (Vincent Picavet)
  - Added parameters argument to ST_Buffer operation to support one-sided
    buffering and other buffering styles (Sandro Santilli)
  - Performance improvements to ST_Distance (Nicklas Av?n)
  - Addition of other Distance related visualization and analysis
    functions (Nicklas Av?n)
    - ST_ClosestPoint
    - ST_DFullyWithin
    - ST_LongestLine
    - ST_MaxDistance
    - ST_ShortestLine
  - KML, GML input via ST_GeomFromGML and ST_GeomFromKML (Olivier Courtin)
  - Extract homogeneous collection with ST_CollectionExtract (Paul Ramsey)
  - Add measure values to existing linestring with ST_AddMeasure (Paul Ramsey)
  - History table implementation in utils (George Silva)
  - Win32 support and improvement of core shp2pgsql-gui (Mark Cave-Ayland)
  - In place 'make check' support (Paul Ramsey)
  - Geography type and supporting functions
    - Spherical algorithms from Dave Skea
    - Object/index implementation from Paul Ramsey
    - Selectivitiy implementation from Mark Cave-Ayland
    - Serializations (KML, GML, JSON) from Olivier Courtin
    - ST_Area, ST_Distance, ST_DWithin, ST_GeogFromText, ST_GeogFromWKB,
      ST_Intersects, ST_Covers, ST_Buffer
  - Documentation updates and improvements (Regina Obe, Kevin Neufeld)
  - Testing and quality control (Regina Obe)
  - PostGIS 1.5 support PostgreSQL 8.5 trunk (Guillaume Lelarge)
   - Many many other changes:
    http://trac.osgeo.org/postgis/query?status=closed&milestone=PostGIS+1.5.0
From strk at keybit.net  Thu Feb  4 15:00:13 2010
From: strk at keybit.net (strk)
Date: Thu Feb  4 15:00:28 2010
Subject: [geos-devel] cmake: geos-config
Message-ID: <20100204200013.GJ92802@keybit.net>

cmake based installation results in a broken geos-config
script. geos-config --ldflags, which is used by postgis,
returns '-L'.

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From mateusz at loskot.net  Thu Feb  4 18:38:15 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Feb  4 18:38:21 2010
Subject: [geos-devel] Re: cmake: geos-config
In-Reply-To: <20100204200013.GJ92802@keybit.net>
References: <20100204200013.GJ92802@keybit.net>
Message-ID: <4B6B5A67.4080709@loskot.net>

strk wrote:
> cmake based installation results in a broken geos-config
> script. geos-config --ldflags, which is used by postgis,
> returns '-L'.

Sandro,

Thanks for catching it. Fixed in trunk.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Thu Feb  4 18:56:17 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Feb  4 18:56:23 2010
Subject: [geos-devel] [#317] Build configuration for CMake build system
In-Reply-To: <20100203081429.GA73092@keybit.net>
References: <4B54D32E.1050806@loskot.net> <20100119184338.GG489@keybit.net>
	<4B578C44.6010506@loskot.net> <20100121081526.GB21632@keybit.net>
	<4B5A5396.7090909@loskot.net>
	<1af0b2b21001240827q65f6a00bib108ace3fe8f67e4@mail.gmail.com>
	<4B60BA99.6030005@loskot.net> <20100128204102.GW89012@keybit.net>
	<4B63B01E.3050803@loskot.net> <20100203081429.GA73092@keybit.net>
Message-ID: <4B6B5EA1.3080801@loskot.net>

strk wrote:
> On Sat, Jan 30, 2010 at 04:05:50AM +0000, Mateusz Loskot wrote:
> 
>> The geostest no longer exists in tests/unit
>> I presume you are have old source tree nodes still in your copy.
> 
> I tried with r2901 on a debian 5.0.3 (sorry if I'm following up
> with different systems, just I can't find the time to be single
> threaded). Here the cmake build succeeds, but make check fails
> (fails tests, not build):
> 
> Scanning dependencies of target check
> Start processing tests
> Test project /usr/src/geos/cmake
>   1/  2 Testing geos_unit                        Passed
>   2/  2 Testing xmltester                     ***Failed
> 
> 50% tests passed, 1 tests failed out of 2
> 
> The following tests FAILED:
>           2 - xmltester (Failed)
> Errors while running CTest
> make[3]: *** [CMakeFiles/check] Error 8
> make[2]: *** [CMakeFiles/check.dir/all] Error 2
> make[1]: *** [CMakeFiles/check.dir/rule] Error 2
> make: *** [check] Error 2

The xmltester tests is a still an experiment and it executes
xmltester with only one xml test file as input.
It is exactly this:

mloskot@dog:~/dev/geos/_svn/build$ ./tests/xmltester/xmltester
../trunk/tests/xmltester/tests/TestBigNastyBuffer.xml
symDiffArea frac: 0.682742 tolerated 0.001
isSymDiffAreaInTolerance failed
BufferResultMatcher FAILED
Files: 1
Tests: 1
Failed: 1
Succeeded:

I'm not sure why it fails, but I suppose it may be related to
float-point nightmare and compilation flags

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From strk at keybit.net  Fri Feb  5 03:27:57 2010
From: strk at keybit.net (strk)
Date: Fri Feb  5 03:28:07 2010
Subject: [geos-devel] Unary Union (was: rgeos interface to R classes)
Message-ID: <20100205082757.GL92802@keybit.net>

On Mon, Feb 01, 2010 at 09:48:57AM -0800, Martin Davis wrote:

> The technique of using buffer(0) to union polygons is now deprecated in 
> favour of using Unary Union (Geometry.union() - not sure what the exact 
> GEOS signature is).  Unary Union is usually faster and more robust than 
> the previous technique.  You might want to check this out.

Uhm, I might have missed this in my last port (either completely
or just the outer interface). Is the JTS repository finally landed
so to take a look ? I'm interested in evaluating its use for "geometry
cleanup" purposes (http://trac.osgeo.org/postgis/ticket/399)

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Fri Feb  5 03:38:24 2010
From: strk at keybit.net (strk)
Date: Fri Feb  5 03:38:30 2010
Subject: [geos-devel] Re: cmake: geos-config
In-Reply-To: <4B6B5A67.4080709@loskot.net>
References: <20100204200013.GJ92802@keybit.net> <4B6B5A67.4080709@loskot.net>
Message-ID: <20100205083824.GN92802@keybit.net>

On Thu, Feb 04, 2010 at 11:38:15PM +0000, Mateusz Loskot wrote:
> strk wrote:
> > cmake based installation results in a broken geos-config
> > script. geos-config --ldflags, which is used by postgis,
> > returns '-L'.
> 
> Sandro,
> 
> Thanks for catching it. Fixed in trunk.

Excellent.
Did you reintroduce or still haven't fixed this ?

 CMake Error at CMakeLists.txt:220 (if):
  if had incorrect arguments: ${CMAKE_VERSION} VERSION_LESS "2.8.0" (Unknown
  arguments specified).

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Fri Feb  5 06:29:24 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Feb  5 06:28:02 2010
Subject: [geos-devel] Unary Union (was: rgeos interface to R classes)
In-Reply-To: <20100205082757.GL92802@keybit.net>
References: <20100205082757.GL92802@keybit.net>
Message-ID: <alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>

On Fri, 5 Feb 2010, strk wrote:

> On Mon, Feb 01, 2010 at 09:48:57AM -0800, Martin Davis wrote:
>
>> The technique of using buffer(0) to union polygons is now deprecated in
>> favour of using Unary Union (Geometry.union() - not sure what the exact
>> GEOS signature is).  Unary Union is usually faster and more robust than
>> the previous technique.  You might want to check this out.
>
> Uhm, I might have missed this in my last port (either completely
> or just the outer interface). Is the JTS repository finally landed
> so to take a look ? I'm interested in evaluating its use for "geometry
> cleanup" purposes (http://trac.osgeo.org/postgis/ticket/399)

Seems to be in the 3.2.0/1.6.0 C API as GEOSUnionCascaded(), and works 
like the buffer trick for me (except for my unsolved scale problem).

Roger

>
> --strk;
>
>  ()   Free GIS & Flash consultant/developer
>  /\   http://foo.keybit.net/~strk/services.html
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Fri Feb  5 07:58:14 2010
From: strk at keybit.net (Sandro Santilli)
Date: Fri Feb  5 07:58:18 2010
Subject: [geos-devel] Unary Union (was: rgeos interface to R classes)
In-Reply-To: <alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>
References: <20100205082757.GL92802@keybit.net>
	<alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>
Message-ID: <1af0b2b21002050458o5492f11bu5883a4d4a5099b4e@mail.gmail.com>

On Fri, Feb 5, 2010 at 12:29 PM, Roger Bivand <Roger.Bivand@nhh.no> wrote:
> On Fri, 5 Feb 2010, strk wrote:
>
>> On Mon, Feb 01, 2010 at 09:48:57AM -0800, Martin Davis wrote:
>>
>>> The technique of using buffer(0) to union polygons is now deprecated in
>>> favour of using Unary Union (Geometry.union() - not sure what the exact
>>> GEOS signature is).  Unary Union is usually faster and more robust than
>>> the previous technique.  You might want to check this out.
>>
>> Uhm, I might have missed this in my last port (either completely
>> or just the outer interface). Is the JTS repository finally landed
>> so to take a look ? I'm interested in evaluating its use for "geometry
>> cleanup" purposes (http://trac.osgeo.org/postgis/ticket/399)
>
> Seems to be in the 3.2.0/1.6.0 C API as GEOSUnionCascaded(), and works like
> the buffer trick for me (except for my unsolved scale problem).

I've checked the GEOS code. It's actually NOT the same classes being
used for CascadedUnion and UnaryUnion. Dunno about the actual
output characteristic, but it's surely documented (in JTS) to be different
from the buffer trick.


--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Fri Feb  5 08:28:20 2010
From: strk at keybit.net (Sandro Santilli)
Date: Fri Feb  5 08:28:25 2010
Subject: [geos-devel] Unary Union (was: rgeos interface to R classes)
In-Reply-To: <1af0b2b21002050458o5492f11bu5883a4d4a5099b4e@mail.gmail.com>
References: <20100205082757.GL92802@keybit.net>
	<alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>
	<1af0b2b21002050458o5492f11bu5883a4d4a5099b4e@mail.gmail.com>
Message-ID: <20100205132820.GA42990@keybit.net>

On Fri, Feb 05, 2010 at 01:58:14PM +0100, Sandro Santilli wrote:
> On Fri, Feb 5, 2010 at 12:29 PM, Roger Bivand <Roger.Bivand@nhh.no> wrote:

> > Seems to be in the 3.2.0/1.6.0 C API as GEOSUnionCascaded(), and works like
> > the buffer trick for me (except for my unsolved scale problem).
> 
> I've checked the GEOS code. It's actually NOT the same classes being
> used for CascadedUnion and UnaryUnion. Dunno about the actual
> output characteristic, but it's surely documented (in JTS) to be different
> from the buffer trick.

Oope, you were right. At least for polygons, it's the same
of UnionCascaded.

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Fri Feb  5 08:38:35 2010
From: strk at keybit.net (Sandro Santilli)
Date: Fri Feb  5 08:38:40 2010
Subject: [geos-devel] Unary Union (was: rgeos interface to R classes)
In-Reply-To: <20100205132820.GA42990@keybit.net>
References: <20100205082757.GL92802@keybit.net>
	<alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>
	<1af0b2b21002050458o5492f11bu5883a4d4a5099b4e@mail.gmail.com>
	<20100205132820.GA42990@keybit.net>
Message-ID: <20100205133835.GB42990@keybit.net>

On Fri, Feb 05, 2010 at 02:28:20PM +0100, Sandro Santilli wrote:
> On Fri, Feb 05, 2010 at 01:58:14PM +0100, Sandro Santilli wrote:
> > On Fri, Feb 5, 2010 at 12:29 PM, Roger Bivand <Roger.Bivand@nhh.no> wrote:
> 
> > > Seems to be in the 3.2.0/1.6.0 C API as GEOSUnionCascaded(), and works like
> > > the buffer trick for me (except for my unsolved scale problem).
> > 
> > I've checked the GEOS code. It's actually NOT the same classes being
> > used for CascadedUnion and UnaryUnion. Dunno about the actual
> > output characteristic, but it's surely documented (in JTS) to be different
> > from the buffer trick.
> 
> Oope, you were right. At least for polygons, it's the same
> of UnionCascaded.

... except postgis just returns the input geometry w/out even asking
GEOS to do anything with it (for single-geometry inputs) ...

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From mbdavis at refractions.net  Fri Feb  5 11:37:08 2010
From: mbdavis at refractions.net (Martin Davis)
Date: Fri Feb  5 11:33:38 2010
Subject: [geos-devel] Unary Union
In-Reply-To: <20100205133835.GB42990@keybit.net>
References: <20100205082757.GL92802@keybit.net>	<alpine.LRH.2.00.1002051228050.28786@reclus.nhh.no>	<1af0b2b21002050458o5492f11bu5883a4d4a5099b4e@mail.gmail.com>	<20100205132820.GA42990@keybit.net>
	<20100205133835.GB42990@keybit.net>
Message-ID: <4B6C4934.5090904@refractions.net>

Note that UnaryUnion does NOT "clean" geometry in the same way that 
buffer(0) can.  If there are invalid geometries in the input to 
UnaryUnion, it will probably fail.  It also might be a bit more subject 
to robustness failures (eg two polygons with almost coincident segments).

But UnaryUnion should be faster and more accurate than buffer(0) when it 
does work (which should be almost always for valid input.

Also, UnaryUnion works for LineString and Point input, and general 
GeometryCollections.

Sandro Santilli wrote:
> On Fri, Feb 05, 2010 at 02:28:20PM +0100, Sandro Santilli wrote:
>   
>> On Fri, Feb 05, 2010 at 01:58:14PM +0100, Sandro Santilli wrote:
>>     
>>> On Fri, Feb 5, 2010 at 12:29 PM, Roger Bivand <Roger.Bivand@nhh.no> wrote:
>>>       
>>>> Seems to be in the 3.2.0/1.6.0 C API as GEOSUnionCascaded(), and works like
>>>> the buffer trick for me (except for my unsolved scale problem).
>>>>         
>>> I've checked the GEOS code. It's actually NOT the same classes being
>>> used for CascadedUnion and UnaryUnion. Dunno about the actual
>>> output characteristic, but it's surely documented (in JTS) to be different
>>> from the buffer trick.
>>>       
>> Oope, you were right. At least for polygons, it's the same
>> of UnionCascaded.
>>     
>
> ... except postgis just returns the input geometry w/out even asking
> GEOS to do anything with it (for single-geometry inputs) ...
>
> -

-- 
Martin Davis
Senior Technical Architect
Refractions Research, Inc.
(250) 383-3022

From mateusz at loskot.net  Fri Feb  5 16:33:45 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Feb  5 16:33:51 2010
Subject: [geos-devel] Re: cmake: geos-config
In-Reply-To: <20100205083824.GN92802@keybit.net>
References: <20100204200013.GJ92802@keybit.net> <4B6B5A67.4080709@loskot.net>
	<20100205083824.GN92802@keybit.net>
Message-ID: <4B6C8EB9.7090801@loskot.net>

strk wrote:
> On Thu, Feb 04, 2010 at 11:38:15PM +0000, Mateusz Loskot wrote:
>> strk wrote:
>>> cmake based installation results in a broken geos-config
>>> script. geos-config --ldflags, which is used by postgis,
>>> returns '-L'.
>> Sandro,
>>
>> Thanks for catching it. Fixed in trunk.
> 
> Excellent.
> Did you reintroduce or still haven't fixed this ?
> 
>  CMake Error at CMakeLists.txt:220 (if):
>   if had incorrect arguments: ${CMAKE_VERSION} VERSION_LESS "2.8.0" (Unknown
>   arguments specified).

OK, should be fixed now:

http://trac.osgeo.org/geos/ticket/317#comment:29

Thanks for testing!

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From strk at keybit.net  Fri Feb  5 18:03:17 2010
From: strk at keybit.net (strk)
Date: Fri Feb  5 18:03:22 2010
Subject: [geos-devel] Re: cmake: geos-config
In-Reply-To: <4B6C8EB9.7090801@loskot.net>
References: <20100204200013.GJ92802@keybit.net> <4B6B5A67.4080709@loskot.net>
	<20100205083824.GN92802@keybit.net> <4B6C8EB9.7090801@loskot.net>
Message-ID: <20100205230317.GI48563@keybit.net>

On Fri, Feb 05, 2010 at 09:33:45PM +0000, Mateusz Loskot wrote:
> strk wrote:
> > On Thu, Feb 04, 2010 at 11:38:15PM +0000, Mateusz Loskot wrote:
> >> strk wrote:
> >>> cmake based installation results in a broken geos-config
> >>> script. geos-config --ldflags, which is used by postgis,
> >>> returns '-L'.
> >> Sandro,
> >>
> >> Thanks for catching it. Fixed in trunk.
> > 
> > Excellent.
> > Did you reintroduce or still haven't fixed this ?
> > 
> >  CMake Error at CMakeLists.txt:220 (if):
> >   if had incorrect arguments: ${CMAKE_VERSION} VERSION_LESS "2.8.0" (Unknown
> >   arguments specified).
> 
> OK, should be fixed now:
> 
> http://trac.osgeo.org/geos/ticket/317#comment:29

Nice. Works here. Thanks.
Time to move on improving 'make check' now :)

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Sat Feb  6 15:35:58 2010
From: strk at keybit.net (strk)
Date: Sat Feb  6 15:37:17 2010
Subject: [geos-devel] cmake: distclean-like ? out of source tree build ?
Message-ID: <20100206203558.GV48563@keybit.net>

Mat, is there a 'cleanup' command for cmake-prepared build trees ?
I start to suspect my source tree was 'infected' by cmake things :)
Like:

build$ cmake ../trunk # does things but *build* dir is empty
build$ cd ../trunk
trunk$ cmake . && make
...
CMakeFiles/geos_unit.dir/geostest2.cpp.o: In function `main':
/usr/src/geos/trunk/tests/unit/geostest2.cpp:56: multiple definition of `main'
CMakeFiles/geos_unit.dir/geos_unit.cpp.o:/usr/src/geos/trunk/tests/unit/geos_unit.cpp:56: first defined here

Didn't you fix the last error ? (which is what makes me think there might
be something old around).

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From mateusz at loskot.net  Sat Feb  6 16:12:18 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Feb  6 16:12:26 2010
Subject: [geos-devel] Re: cmake: distclean-like ? out of source tree build ?
In-Reply-To: <20100206203558.GV48563@keybit.net>
References: <20100206203558.GV48563@keybit.net>
Message-ID: <4B6DDB32.2070103@loskot.net>

strk wrote:
> Mat, is there a 'cleanup' command for cmake-prepared build trees ?
> I start to suspect my source tree was 'infected' by cmake things :)
> Like:
> 
> build$ cmake ../trunk # does things but *build* dir is empty

This is strange. It perfectly works for me:

mloskot@dog:~/dev/geos/_svn/build$ ls
mloskot@dog:~/dev/geos/_svn/build$ cmake ../trunk
-- The C compiler identification is GNU
-- The CXX compiler identification is GNU
-- Check for working C compiler: /usr/bin/gcc
-- Check for working C compiler: /usr/bin/gcc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Setting GEOS version 3.3.0 as port of JTS 1.10.0
-- Setting GEOS C API version 1.6.1
-- Setting GEOS build type - Debug
-- Forcing IEEE 754 using flag -ffloat-store - ON
-- Setting GEOS compilation with small functions inlining - ON
-- Setting GEOS compilation with assert() macro enabled - OFF
-- Check for STD namespace
-- Check for STD namespace - found
-- Looking for include files HAVE_STDINT_H
-- Looking for include files HAVE_STDINT_H - found
-- Looking for include files HAVE_INTTYPES_H
-- Looking for include files HAVE_INTTYPES_H - found
-- Looking for include files HAVE_IEEEFP_H
-- Looking for include files HAVE_IEEEFP_H - not found.
-- Looking for sys/types.h
-- Looking for sys/types.h - found
-- Looking for stddef.h
-- Looking for stddef.h - found
-- Check size of int64_t
-- Check size of int64_t - done
-- Performing Test HAVE_STD_ISNAN
-- Performing Test HAVE_STD_ISNAN - Success
-- Performing Test HAVE_STD_ISFINITE
-- Performing Test HAVE_STD_ISFINITE - Failed
-- Looking for isfinite
-- Looking for isfinite - found
-- Enable GEOS Unit Tests build - ON
-- Enable GEOS XML Tester build - ON
-- CMake 2.8.0 successfully configured geos using Unix Makefiles generator
-- Configuring done
-- Generating done
-- Build files have been written to: /home/mloskot/dev/geos/_svn/build
mloskot@dog:~/dev/geos/_svn/build$ ls
capi CMakeFiles CTestTestfile.cmake include src tests CMakeCache.txt
cmake_install.cmake DartConfiguration.tcl Makefile Testing tools
mloskot@dog:~/dev/geos/_svn/build$

> build$ cd ../trunk
> trunk$ cmake . && make

I never do build in-tree. In fact, I was going to disable this option,
so CMake would detect that was executed in trunk and would fail.

> CMakeFiles/geos_unit.dir/geostest2.cpp.o: In function `main':
> /usr/src/geos/trunk/tests/unit/geostest2.cpp:56: multiple definition of `main'
> CMakeFiles/geos_unit.dir/geos_unit.cpp.o:/usr/src/geos/trunk/tests/unit/geos_unit.cpp:56: first defined here

mloskot@dog:~/dev/geos/_svn/trunk$ svn-clean
unlink include/geos/platform.h.disabled

mloskot@dog:~/dev/geos/_svn/trunk$ svn up
At revision 2906.

mloskot@dog:~/dev/geos/_svn/trunk$ cmake .
-- The C compiler identification is GNU
...
-- Build files have been written to: /home/mloskot/dev/geos/_svn/trunk
mloskot@dog:~/dev/geos/_svn/trunk$ make

...and everything builds and tests for me with success.


> Didn't you fix the last error ? (which is what makes me think there might
> be something old around).

I'm not sure which error you mean.
Last fixes were for the file macro commands RENAME/REMOVE issue

http://trac.osgeo.org/geos/changeset/2905

and making XMLTester to run well:

http://trac.osgeo.org/geos/changeset/2906

Regarding distclean, there is no such feature because of no need:

# CMake does not generate a "make distclean" target. Why?
http://www.vtk.org/Wiki/CMake_FAQ

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Sat Feb  6 16:13:46 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Feb  6 16:13:51 2010
Subject: [geos-devel] Re: cmake: distclean-like ? out of source tree build
	?
In-Reply-To: <4B6DDB32.2070103@loskot.net>
References: <20100206203558.GV48563@keybit.net> <4B6DDB32.2070103@loskot.net>
Message-ID: <4B6DDB8A.6090302@loskot.net>

Mateusz Loskot wrote:
> mloskot@dog:~/dev/geos/_svn/trunk$ svn-clean

By the way, if you are suspicious about some remaining garbage in the
source tree, just run svn-clean and confirm you have trunk up-to-date
with nothing reported by svn status.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From geos-trac at osgeo.org  Mon Feb  8 15:53:40 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 15:53:41 2010
Subject: [geos-devel] [GEOS] #329: Improve formatting for IsValidReason
Message-ID: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>

#329: Improve formatting for IsValidReason
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |       Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |      Status:  new                       
 Priority:  minor        |   Milestone:                            
Component:  Default      |     Version:  3.2.0                     
 Severity:  Unassigned   |    Keywords:                            
-------------------------+--------------------------------------------------
 A message from PostGIS's ST_IsValidReason(geometry) shows the message:
 {{{
 Self-intersection[523991 6.5222e+06]
 }}}
 to describe a point with Easting/Northing coordinates. What I find odd is
 the mixed conventional numeric and exponential forms.

 I can't find the source code for this, but I'm certain there is a "%g %g"
 formatting code somewhere in there. Although %g is usually a nice
 formatter, it is unfortunate that it happens to change to exponential form
 at numbers >=1e+06, which is the range of many projected (i.e., UTM)
 coordinates (particularly northern ones). [Note, this is probably
 compiler/platform dependent.]

 To make consistent formatting of these coordinates across platforms, and
 to make it show projected coordinates nicely, I suggest using the
 formatting code: "%.7g %.7g"

 This will use exponential form for numbers >=1e+07, which most earth-based
 Easting/Northing coordinates fall within.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  8 16:08:15 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 16:08:17 2010
Subject: [geos-devel] Re: [GEOS] #329: Improve formatting for IsValidReason
In-Reply-To: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
References: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
Message-ID: <056.7bdfe0f1d0865fef465fdb44a0ae0938@osgeo.org>

#329: Improve formatting for IsValidReason
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  closed                    
 Priority:  minor        |    Milestone:                            
Component:  Default      |      Version:  3.2.0                     
 Severity:  Unassigned   |   Resolution:  invalid                   
 Keywords:               |  
-------------------------+--------------------------------------------------
Changes (by strk):

  * status:  new => closed
  * resolution:  => invalid

Comment:

 ST_isValidReason is a PostGIS function, not GEOS... should file the ticket
 in there.

 Look, I've good news for you:
 http://trac.osgeo.org/postgis/changeset/5204

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  8 16:40:26 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 16:40:28 2010
Subject: [geos-devel] Re: [GEOS] #329: Improve formatting for IsValidReason
In-Reply-To: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
References: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
Message-ID: <056.fdd136b414b5eca62a49097068ef60c7@osgeo.org>

#329: Improve formatting for IsValidReason
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  closed                    
 Priority:  minor        |    Milestone:                            
Component:  Default      |      Version:  3.2.0                     
 Severity:  Unassigned   |   Resolution:  invalid                   
 Keywords:               |  
-------------------------+--------------------------------------------------
Comment (by mwtoews):

 Ah, that's why I couldn't find it. I had a few bad hints to lead me to
 think it was a GEOS issue:
  * The NEWS item "IsValidReason added to CAPI" for
 [http://svn.osgeo.org/geos/trunk/NEWS GEOS 3.1.0]
  * "{{{elog(ERROR,"GEOS isvalidreason() threw an error!");}}}" in
 PostGIS's lwgeom_geos.c

 I'm not sure if these were mixups between projects or what.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329#comment:2>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  8 16:54:02 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 16:54:03 2010
Subject: [geos-devel] Re: [GEOS] #329: Improve formatting for
	GEOSisValidReason_r
In-Reply-To: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
References: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
Message-ID: <056.48a7dcee8e123b70bcc56fb4145885a0@osgeo.org>

#329: Improve formatting for GEOSisValidReason_r
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  reopened                  
 Priority:  minor        |    Milestone:                            
Component:  Default      |      Version:  3.2.0                     
 Severity:  Unassigned   |   Resolution:                            
 Keywords:               |  
-------------------------+--------------------------------------------------
Changes (by strk):

  * status:  closed => reopened
  * resolution:  invalid =>
  * summary:  Improve formatting for IsValidReason => Improve formatting
              for GEOSisValidReason_r

Comment:

 It *is* a mix of the two, as PostGIS's ST_isValid* functions all use GEOS
 internally.
 What I was pointing out is that a string for a point is not the best thing
 to have
 in return..

 Anyway yes, your report is actually valid I guess, so I reopen.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329#comment:3>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  8 17:00:32 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 17:00:35 2010
Subject: [geos-devel] Re: [GEOS] #329: Improve formatting for
	GEOSisValidReason_r
In-Reply-To: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
References: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
Message-ID: <056.85004cce29b405ae568a816b78feb2c0@osgeo.org>

#329: Improve formatting for GEOSisValidReason_r
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  closed                    
 Priority:  minor        |    Milestone:                            
Component:  Default      |      Version:  3.2.0                     
 Severity:  Unassigned   |   Resolution:  wontfix                   
 Keywords:               |  
-------------------------+--------------------------------------------------
Changes (by strk):

  * status:  reopened => closed
  * resolution:  => wontfix

Comment:

 But still.. why fix when there's a better alternative ? :)
 (GEOSIsValidDetail_r)

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329#comment:4>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Feb  8 19:49:38 2010
From: geos-trac at osgeo.org (GEOS)
Date: Mon Feb  8 19:49:41 2010
Subject: [geos-devel] Re: [GEOS] #329: Improve formatting for
	GEOSisValidReason_r
In-Reply-To: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
References: <047.ff7137bb00dbc82d94d2ec7c0b620f8c@osgeo.org>
Message-ID: <056.c3faaba905f5c6e41f282e2142066e16@osgeo.org>

#329: Improve formatting for GEOSisValidReason_r
-------------------------+--------------------------------------------------
 Reporter:  mwtoews      |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement  |       Status:  reopened                  
 Priority:  minor        |    Milestone:  3.2.1                     
Component:  Default      |      Version:  3.2.0                     
 Severity:  Unassigned   |   Resolution:                            
 Keywords:               |  
-------------------------+--------------------------------------------------
Changes (by pramsey):

  * status:  closed => reopened
  * resolution:  wontfix =>
  * milestone:  => 3.2.1

Comment:

 It's not in PostGIS, actually, it's in GEOS. PostGIS just consumes the
 string produced by GEOS.

 http://trac.osgeo.org/geos/browser/trunk/capi/geos_ts_c.cpp#L607

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/329#comment:5>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Tue Feb  9 01:48:43 2010
From: geos-trac at osgeo.org (GEOS)
Date: Tue Feb  9 01:48:44 2010
Subject: [geos-devel] [GEOS] #330: cmake puts geos_c.h into include/geos
Message-ID: <047.b6c28d6c99032ce1450e698e4286f089@osgeo.org>

#330: cmake puts geos_c.h into include/geos
-----------------------+----------------------------------------------------
 Reporter:  mwtoews    |       Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |      Status:  new                       
 Priority:  minor      |   Milestone:                            
Component:  Default    |     Version:  svn-trunk                 
 Severity:  Annoyance  |    Keywords:                            
-----------------------+----------------------------------------------------
 Testing the latest SVN, CMake installs geos_c.h into {{{include/geos}}}
 rather than in {{{include}}} (as with previous versions <=3.2). However,
 the header file still refers to children header files in a {{{geos}}}
 subdirectory, e.g.:
 {{{
 #include <geos/export.h>
 }}}
 and the configuration utility points where it should, but there is not
 header file there:
 {{{
 $ geos-config --includes
 /usr/local/include
 }}}
 This gives errors and grief for configuring PostGIS. The quick-fix is:
 {{{
 mv geos_c.h ..
 }}}
 ... but this is still a defect due to manual intervention for the install.

 Other info:
 {{{
 $ cmake --version
 cmake version 2.6-patch 0
 $ g++ --version
 g++ (Debian 4.3.2-1.1) 4.3.2
 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/330>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Tue Feb  9 01:56:30 2010
From: geos-trac at osgeo.org (GEOS)
Date: Tue Feb  9 01:56:35 2010
Subject: [geos-devel] [GEOS] #331: Geos build fails on linking on Solaris
Message-ID: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>

#331: Geos build fails on linking on Solaris
-----------------------+----------------------------------------------------
 Reporter:  sandy2010  |       Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |      Status:  new                       
 Priority:  major      |   Milestone:                            
Component:  Default    |     Version:  3.1.1                     
 Severity:  Critical   |    Keywords:                            
-----------------------+----------------------------------------------------
 I'm building geos-3.1.1 on Solaris (5.9 sparc and 5.10 x86) and used all
 the 3 patches uploaded by rroliver in ticket #224.

 and I get some issue during link time with multiple symbol definitions.
 When I provide --disable-inline during configure, it gives me the
 following error on linking:

 CC -G -zdefs -hlibgeos-3.1.1.so -o .libs/libgeos-3.1.1.so
 .libs/inlines.o -Qoption ld -z -Qoption ld
 allextract,algorithm/.libs/libalgorithm.a,geom/.libs/libgeom.a,geomgraph/.libs/libgeomgraph.a,index/.libs/libindex.a,io/.libs/libio.a,noding/.libs/libnoding.a,operation/.libs/liboperation.a,planargraph/.libs/libplanargraph.a,precision/.libs/libprecision.a,simplify/.libs/libsimplify.a,util/.libs/libutil.a
 -Qoption ld -z -Qoption ld defaultextract  -lCstd -lCrun -lc

 Undefined                       first referenced
  symbol                             in file

 cos
 operation/.libs/liboperation.a(OffsetCurveBuilder.o)
 log                                 geom/.libs/libgeom.a(PrecisionModel.o)
 pow                                 index/.libs/libindex.a(DoubleBits.o)
 sin
 operation/.libs/liboperation.a(OffsetCurveBuilder.o)
 ceil                                geom/.libs/libgeom.a(PrecisionModel.o)
 fabs
 algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
 sqrt
 algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
 atan2                               geom/.libs/libgeom.a(LineSegment.o)
 floor
 algorithm/.libs/libalgorithm.a(RobustDeterminant.o)
 __fabsl
 algorithm/.libs/libalgorithm.a(HCoordinate.o)
 ld: fatal: Symbol referencing errors. No output written to
 .libs/libgeos-3.1.1.so
 make[2]: *** [libgeos.la] Error 1
 make[2]: Leaving directory `/opt/geos-3.1.1/source'
 make[1]: *** [all-recursive] Error 1
 make[1]: Leaving directory `/opt/geos-3.1.1/source'
 make: *** [all-recursive] Error 1

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/331>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Tue Feb  9 02:34:20 2010
From: geos-trac at osgeo.org (GEOS)
Date: Tue Feb  9 02:34:22 2010
Subject: [geos-devel] Re: [GEOS] #330: cmake puts geos_c.h into include/geos
In-Reply-To: <047.b6c28d6c99032ce1450e698e4286f089@osgeo.org>
References: <047.b6c28d6c99032ce1450e698e4286f089@osgeo.org>
Message-ID: <056.c96c46d28f19aff81af7be160b757c4f@osgeo.org>

#330: cmake puts geos_c.h into include/geos
-----------------------+----------------------------------------------------
 Reporter:  mwtoews    |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect     |       Status:  new                       
 Priority:  minor      |    Milestone:                            
Component:  Default    |      Version:  svn-trunk                 
 Severity:  Annoyance  |   Resolution:                            
 Keywords:             |  
-----------------------+----------------------------------------------------
Comment (by pmeems):

 We've got the same issue when compiling MapWindow GIS with GEOS.
 It would be better/nice to have all include files in the same place.
 After compiling GEOS we move all include files to a common include folder
 and that is working for all libraries (GDAL, etc) we use except for this
 file.
 Thanks.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/330#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From Roger.Bivand at nhh.no  Wed Feb 10 04:46:33 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb 10 04:45:10 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection (CAPI)
	do?
Message-ID: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>

Continuing to try to interface R and GEOS (CAPI), I am puzzled that 
GEOSSymDifference() and GEOSIntersection() seem to require input objects 
to be "Geometry must be a Point or LineString".

When MULTIPOLYGON or POLYGON objects are degraded to LINEARRING, 
GEOSSymDifference() returns MULTILINESTRING and GEOSIntersection() returns 
MULTIPOINT objects. Are these functions not intended to take at least 
POLYGON inputs, and then return POLYGON output? The cryptic notes in

http://geos.refractions.net/ro/doxygen_docs/html/classgeos_1_1geom_1_1Geometry.html

suggest that they don't:

"intersection (const Geometry *other) const Returns a Geometry 
representing the points shared by this Geometry and other."

"symDifference (const Geometry *other) const Returns a set combining the 
points in this Geometry not in other, and the points in other not in this 
Geometry."

If this is all the functions do by design, how should the POLYGON objects 
be reconstructed, since the distinction between exterior and interior 
rings has been lost? Is there example code anywhere? The code in OGR 
doesn't help here, I'm afraid. Is this the OGC SFS understanding of these 
functions - is that the ontological problem that I'm having coming from 
the outside?

I'm running GEOS 3.2.0, built locally on RHEL5 x86_64.

For union, UnionCascaded of a MULTIPOLYGON returns a POLYGON or 
MULTIPOLYGON, as one would expect.

Grateful for advice,

Roger

PS. the previous thread that I opened is still unresolved, and GEOS in R 
(if it is submitted at all), will be published with a big question mark 
about precision and scaling with regard to the dissolving of contiguous 
polygons.

For now establishing whether GEOS can do geometry operations on 
(multi)-polygons is crucial. GEOS ought to be able to deliver, but I need 
to be shown how - example code, proper documentation of the C API (saying 
what can be used as arguments to functions as a start without having to 
delve through arcane C++ documentation which may or may not apply to the C 
API) - I should proceed.

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Wed Feb 10 05:44:57 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 05:45:03 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
Message-ID: <20100210104457.GG37036@keybit.net>

On Wed, Feb 10, 2010 at 10:46:33AM +0100, Roger Bivand wrote:
> Continuing to try to interface R and GEOS (CAPI), I am puzzled that 
> GEOSSymDifference() and GEOSIntersection() seem to require input objects 
> to be "Geometry must be a Point or LineString".

Sounds like an horrible bug, if confirmed.
Could you file a ticket with accompaining smallest C testcase showing it ?

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Wed Feb 10 06:00:31 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb 10 05:59:08 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <20100210104457.GG37036@keybit.net>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
Message-ID: <alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>

On Wed, 10 Feb 2010, strk wrote:

> On Wed, Feb 10, 2010 at 10:46:33AM +0100, Roger Bivand wrote:
>> Continuing to try to interface R and GEOS (CAPI), I am puzzled that
>> GEOSSymDifference() and GEOSIntersection() seem to require input objects
>> to be "Geometry must be a Point or LineString".
>
> Sounds like an horrible bug, if confirmed.
> Could you file a ticket with accompaining smallest C testcase showing it ?

Sorry, as before, I'm working on interfacing to R, so GEOM objects are 
created and validated from there. If there is a workhorse main() providing 
a way of reading input or taking input from hardcoded WKT strings, I'll 
use it, but I'd prefer not to write it - last time the testcase I wrote 
was worse than and did not cover the problem. Just a simple boilerplate so 
that my coding of it isn't the problem, if you see what I mean.

I've got quite a long way with the interface, but am hitting things I just 
don't grasp. I think that the error message is stale in my 
__errorHandler() - but cannot see why, so the error message may be 
distracting. GEOSSymDifference() certainly bailed out when passed two 
MULTIPOLYGON objects, same with two POLYGON objects, and does process with 
two LINEARRING objects.

I've tried to go through GEOSPolygonize() to put the MULTILINESTRING 
together again, and am analysing what has happened, but think that the 
output has lost hole attributions, so needs running through GEOSContains 
or similar.

Thanks!

Roger

>
> --strk;
>
>  ()   Free GIS & Flash consultant/developer
>  /\   http://foo.keybit.net/~strk/services.html
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Wed Feb 10 06:02:51 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 06:02:54 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
Message-ID: <20100210110251.GI37036@keybit.net>

On Wed, Feb 10, 2010 at 12:00:31PM +0100, Roger Bivand wrote:
> On Wed, 10 Feb 2010, strk wrote:
> 
> >On Wed, Feb 10, 2010 at 10:46:33AM +0100, Roger Bivand wrote:
> >>Continuing to try to interface R and GEOS (CAPI), I am puzzled that
> >>GEOSSymDifference() and GEOSIntersection() seem to require input objects
> >>to be "Geometry must be a Point or LineString".
> >
> >Sounds like an horrible bug, if confirmed.
> >Could you file a ticket with accompaining smallest C testcase showing it ?
> 
> Sorry, as before, I'm working on interfacing to R, so GEOM objects are 
> created and validated from there. If there is a workhorse main() providing 
> a way of reading input or taking input from hardcoded WKT strings, I'll 
> use it, but I'd prefer not to write it - last time the testcase I wrote 
> was worse than and did not cover the problem. Just a simple boilerplate so 
> that my coding of it isn't the problem, if you see what I mean.

Sure, we have an XML format for testcases targetting the C++ interface
(xmltester), and a framework for C-API too (see tests/unit/capi/*).

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Wed Feb 10 06:04:18 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 06:04:22 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
Message-ID: <20100210110418.GJ37036@keybit.net>

On Wed, Feb 10, 2010 at 12:00:31PM +0100, Roger Bivand wrote:

> I've tried to go through GEOSPolygonize() to put the MULTILINESTRING 
> together again, and am analysing what has happened, but think that the 
> output has lost hole attributions, so needs running through GEOSContains 
> or similar.

Oh, if your goal is building an area you may consider
moving the algorithm implemented by PostGIS's ST_BuildArea
code down into the C-API (from the postgis geos wrapper).
I belive it would be useful in general...

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Wed Feb 10 06:35:46 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb 10 06:34:23 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <20100210110251.GI37036@keybit.net>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
	<20100210110251.GI37036@keybit.net>
Message-ID: <alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>

On Wed, 10 Feb 2010, strk wrote:

> On Wed, Feb 10, 2010 at 12:00:31PM +0100, Roger Bivand wrote:
>> On Wed, 10 Feb 2010, strk wrote:
>>
>>> On Wed, Feb 10, 2010 at 10:46:33AM +0100, Roger Bivand wrote:
>>>> Continuing to try to interface R and GEOS (CAPI), I am puzzled that
>>>> GEOSSymDifference() and GEOSIntersection() seem to require input objects
>>>> to be "Geometry must be a Point or LineString".
>>>
>>> Sounds like an horrible bug, if confirmed.
>>> Could you file a ticket with accompaining smallest C testcase showing it ?
>>
>> Sorry, as before, I'm working on interfacing to R, so GEOM objects are
>> created and validated from there. If there is a workhorse main() providing
>> a way of reading input or taking input from hardcoded WKT strings, I'll
>> use it, but I'd prefer not to write it - last time the testcase I wrote
>> was worse than and did not cover the problem. Just a simple boilerplate so
>> that my coding of it isn't the problem, if you see what I mean.

Thanks. Could you please clarify:

Are GEOSSymDifference() and GEOSIntersection() intended to take at least 
POLYGON inputs, and then return POLYGON output, or not?

>
> Sure, we have an XML format for testcases targetting the C++ interface
> (xmltester), and a framework for C-API too (see tests/unit/capi/*).

As far as I can see, all the files there are C++, not C. I need C, not 
C++, please. Just the #include, main(), and a place in the main to put the 
data (say as WKT strings) and the function call, and a place to put the 
output to screen. I did meet Bjarne Stroustrup in 1987, but that was 
enough! Just setting up initGEOS(), etc., portably is hard.

Sorry not to be up to speed!

Roger

PS. I'll look at the PostGIS code you mention - for now for two 
intersecting linear rings, GEOSSymDifference() returns all the LINESTRING 
objects which Poligonizer makes into the parts that are not shared (OK) 
and all the intersecting parts (not OK).



>
> --strk;
>
>  ()   Free GIS & Flash consultant/developer
>  /\   http://foo.keybit.net/~strk/services.html
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Wed Feb 10 08:05:47 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 08:06:29 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
	<20100210110251.GI37036@keybit.net>
	<alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>
Message-ID: <20100210130547.GK37036@keybit.net>

On Wed, Feb 10, 2010 at 12:35:46PM +0100, Roger Bivand wrote:

> Are GEOSSymDifference() and GEOSIntersection() intended to take at least 
> POLYGON inputs, and then return POLYGON output, or not?

No. They are supposed to work also on linear and puntual geometries.

> As far as I can see, all the files there are C++, not C. I need C, not 
> C++, please. Just the #include, main(), and a place in the main to put the 
> data (say as WKT strings) and the function call, and a place to put the 
> output to screen. I did meet Bjarne Stroustrup in 1987, but that was 
> enough! Just setting up initGEOS(), etc., portably is hard.

I completely understand your point of view.
That's why I push hard for the C-API in the first place :)

Just, as a matter of fact, the actual workhorse is written
in C++, so *if* a bug is found, the usual place to start
for figuring out the culprint it is in object-oriented-land.

In any case, the xmltester script takes XML files as input
so you need no C++ nor C to prepare a testcase for your
situation. Doing so would tell you if Difference and Intersection
functions are broken at the low level.

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Wed Feb 10 08:44:44 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb 10 08:43:21 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <20100210130547.GK37036@keybit.net>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
	<20100210110251.GI37036@keybit.net>
	<alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>
	<20100210130547.GK37036@keybit.net>
Message-ID: <alpine.LRH.2.00.1002101428290.3457@reclus.nhh.no>

On Wed, 10 Feb 2010, strk wrote:

> On Wed, Feb 10, 2010 at 12:35:46PM +0100, Roger Bivand wrote:
>
>> Are GEOSSymDifference() and GEOSIntersection() intended to take at least
>> POLYGON inputs, and then return POLYGON output, or not?
>
> No. They are supposed to work also on linear and puntual geometries.

Clearer please, your "also" confuses me. Do they work on POLYGON or 
MULTIPOLYGON at all? They do work on LINESTRING and LINEARRING, I've 
tried.

>
>> As far as I can see, all the files there are C++, not C. I need C, not
>> C++, please. Just the #include, main(), and a place in the main to put the
>> data (say as WKT strings) and the function call, and a place to put the
>> output to screen. I did meet Bjarne Stroustrup in 1987, but that was
>> enough! Just setting up initGEOS(), etc., portably is hard.
>
> I completely understand your point of view.
> That's why I push hard for the C-API in the first place :)
>

The ST_BuildArea code looks useful, although I'm afraid that my 
PARANOIA_LEVEL is >> 1! Debugging C is simply so much easier under layers 
of other software (for me).

I'm trying a work-around using GEOSSymDifference() for setdiff and 
intersection operations, and would value advice on what "pat" in 
GEOSRelatePattern(GCA, GCC2, pat); should be declared as (neither const 
char pat[9] nor char pat[9] work). Maybe I can work out from the entrails 
of which output POLYGON objects built by Polygonizer belong to which input 
MULTIPOLYGON or POLYGON objects, and retain the ones needed for setdiff 
and intersect.

> Just, as a matter of fact, the actual workhorse is written
> in C++, so *if* a bug is found, the usual place to start
> for figuring out the culprint it is in object-oriented-land.
>
> In any case, the xmltester script takes XML files as input
> so you need no C++ nor C to prepare a testcase for your
> situation. Doing so would tell you if Difference and Intersection
> functions are broken at the low level.

Whether they are broken or not isn't my immediate problem; my problem is 
how to use them in accord with their design intentions. There are very 
many wrong trees to bark up here!

Roger

PS. Once I understand more, I'll try to write a C boilerplate that works.

>
> --strk;
>
>  ()   Free GIS & Flash consultant/developer
>  /\   http://foo.keybit.net/~strk/services.html
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Wed Feb 10 10:24:15 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 10:24:41 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <alpine.LRH.2.00.1002101428290.3457@reclus.nhh.no>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
	<20100210110251.GI37036@keybit.net>
	<alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>
	<20100210130547.GK37036@keybit.net>
	<alpine.LRH.2.00.1002101428290.3457@reclus.nhh.no>
Message-ID: <20100210152415.GA86316@keybit.net>

On Wed, Feb 10, 2010 at 02:44:44PM +0100, Roger Bivand wrote:
> On Wed, 10 Feb 2010, strk wrote:
> 
> >On Wed, Feb 10, 2010 at 12:35:46PM +0100, Roger Bivand wrote:
> >
> >>Are GEOSSymDifference() and GEOSIntersection() intended to take at least
> >>POLYGON inputs, and then return POLYGON output, or not?
> >
> >No. They are supposed to work also on linear and puntual geometries.
> 
> Clearer please, your "also" confuses me. Do they work on POLYGON or 
> MULTIPOLYGON at all? They do work on LINESTRING and LINEARRING, I've 
> tried.

Yes, if given POLYGONS or MULTIPOLYGONS they *may* return POLYGONS
or MULTIPOLYGONS or LINESTRINGS or MULTILINESTRINGS or POINTS or
MULTIPOINGS (depending on the way the POLYGONs you passed in relate
to each other)

> The ST_BuildArea code looks useful, although I'm afraid that my 
> PARANOIA_LEVEL is >> 1! Debugging C is simply so much easier under layers 
> of other software (for me).
> 
> I'm trying a work-around using GEOSSymDifference() for setdiff and 
> intersection operations,

That's exactly what BuildArea does in postgis (after Polygonize):
         * Iteratively invoke symdifference on outer rings
         * as suggested by Carl Anderson:
         * postgis-devel/2005-December/001805.html

> and would value advice on what "pat" in 
> GEOSRelatePattern(GCA, GCC2, pat); should be declared as (neither const 
> char pat[9] nor char pat[9] work).

Takes a 'const char *' and doesn't refuse a 'char *'.

Use the source, Luke:

 (GEOS C-API header):
http://trac.osgeo.org/geos/browser/trunk/capi/geos_c.h.in

 (Postgis [C code] use of GEOS C-API):
http://trac.osgeo.org/postgis/browser/trunk/postgis/lwgeom_geos.c

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From strk at keybit.net  Wed Feb 10 10:29:19 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 10:29:22 2010
Subject: [geos-devel] Re: cmake: distclean-like ? out of source tree build
	?
In-Reply-To: <4B6DDB8A.6090302@loskot.net>
References: <20100206203558.GV48563@keybit.net> <4B6DDB32.2070103@loskot.net>
	<4B6DDB8A.6090302@loskot.net>
Message-ID: <20100210152919.GB86316@keybit.net>

On Sat, Feb 06, 2010 at 09:13:46PM +0000, Mateusz Loskot wrote:
> Mateusz Loskot wrote:
> > mloskot@dog:~/dev/geos/_svn/trunk$ svn-clean
> 
> By the way, if you are suspicious about some remaining garbage in the
> source tree, just run svn-clean and confirm you have trunk up-to-date
> with nothing reported by svn status.

svn-clean doesn't seem to be part of 'svn' package, do you confirm ?

On an OpenSUSE I'm prompted to install kde-related things ?!

 The program 'svn-clean' can be found in following packages:
   * kdesdk3 [ path: /opt/kde3/bin/svn-clean, repository: zypp (ARKANIS_openSUSE_11.1_1) ]
   * kdesdk4-scripts [ path: /usr/bin/svn-clean, repository: zypp (ARKANIS_openSUSE_11.1_1) ]

 Try installing with: sudo zypper install kdesdk3


--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From Roger.Bivand at nhh.no  Wed Feb 10 11:01:27 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Feb 10 11:00:10 2010
Subject: [geos-devel] What do GEOSSymDifference and GEOSIntersection
	(CAPI) do?
In-Reply-To: <20100210152415.GA86316@keybit.net>
References: <alpine.LRH.2.00.1002101017330.3457@reclus.nhh.no>
	<20100210104457.GG37036@keybit.net>
	<alpine.LRH.2.00.1002101149280.3457@reclus.nhh.no>
	<20100210110251.GI37036@keybit.net>
	<alpine.LRH.2.00.1002101222440.3457@reclus.nhh.no>
	<20100210130547.GK37036@keybit.net>
	<alpine.LRH.2.00.1002101428290.3457@reclus.nhh.no>
	<20100210152415.GA86316@keybit.net>
Message-ID: <alpine.LRH.2.00.1002101652560.3457@reclus.nhh.no>

On Wed, 10 Feb 2010, strk wrote:

> On Wed, Feb 10, 2010 at 02:44:44PM +0100, Roger Bivand wrote:
>> On Wed, 10 Feb 2010, strk wrote:
>>
>>> On Wed, Feb 10, 2010 at 12:35:46PM +0100, Roger Bivand wrote:
>>>
>>>> Are GEOSSymDifference() and GEOSIntersection() intended to take at least
>>>> POLYGON inputs, and then return POLYGON output, or not?
>>>
>>> No. They are supposed to work also on linear and puntual geometries.
>>
>> Clearer please, your "also" confuses me. Do they work on POLYGON or
>> MULTIPOLYGON at all? They do work on LINESTRING and LINEARRING, I've
>> tried.
>
> Yes, if given POLYGONS or MULTIPOLYGONS they *may* return POLYGONS
> or MULTIPOLYGONS or LINESTRINGS or MULTILINESTRINGS or POINTS or
> MULTIPOINGS (depending on the way the POLYGONs you passed in relate
> to each other)

Barfing for me with POLYGON and MULTIPOLYGON, returning the error 
message: "Geometry must be a Point or LineString". I'll try to give a test 
case.

>
>> The ST_BuildArea code looks useful, although I'm afraid that my
>> PARANOIA_LEVEL is >> 1! Debugging C is simply so much easier under layers
>> of other software (for me).
>>
>> I'm trying a work-around using GEOSSymDifference() for setdiff and
>> intersection operations,
>
> That's exactly what BuildArea does in postgis (after Polygonize):
>         * Iteratively invoke symdifference on outer rings
>         * as suggested by Carl Anderson:
>         * postgis-devel/2005-December/001805.html
>

Yes, thanks. I'm using GEOSPointOnSurface to generate a point from the 
POLYGON objects returned by GEOSPolygonize from the GEOSSymDifference 
output to see which are in/out of the input objects to choose setdiff or 
intersection. So far some progress, but light in the tunnel is usually an 
approaching train. This avoids iterating on the output.

>> and would value advice on what "pat" in
>> GEOSRelatePattern(GCA, GCC2, pat); should be declared as (neither const
>> char pat[9] nor char pat[9] work).
>
> Takes a 'const char *' and doesn't refuse a 'char *'.

Yes, thanks, got there. One gives GEOSRelatePattern a pattern like 
"TFTFTFTF*" - I thought I could get a full analysis out at one shot, 
returned in pat - another wrong tree. It is an input argument, not a 
container for output.

Roger

>
> Use the source, Luke:
>
> (GEOS C-API header):
> http://trac.osgeo.org/geos/browser/trunk/capi/geos_c.h.in
>
> (Postgis [C code] use of GEOS C-API):
> http://trac.osgeo.org/postgis/browser/trunk/postgis/lwgeom_geos.c
>
> --strk;
>
>  ()   Free GIS & Flash consultant/developer
>  /\   http://foo.keybit.net/~strk/services.html
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Wed Feb 10 18:26:51 2010
From: strk at keybit.net (strk)
Date: Wed Feb 10 18:26:56 2010
Subject: [geos-devel] deprecate non-thread-safe CAPI interfaces
Message-ID: <20100210232651.GC89717@keybit.net>

I'd like to deprecate non-thread-safe version
of CAPI interface in next release, and stop providing
them for new methods.

If anyone sees a reason not to do that please scream
before it's too late (you've plenty of time).

--strk; 

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From hobu.inc at gmail.com  Wed Feb 10 22:42:56 2010
From: hobu.inc at gmail.com (Howard Butler)
Date: Wed Feb 10 22:55:14 2010
Subject: [geos-devel] deprecate non-thread-safe CAPI interfaces
In-Reply-To: <20100210232651.GC89717@keybit.net>
References: <20100210232651.GC89717@keybit.net>
Message-ID: <99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>


On Feb 10, 2010, at 5:26 PM, strk wrote:

> I'd like to deprecate non-thread-safe version
> of CAPI interface in next release, and stop providing
> them for new methods.
> 
> If anyone sees a reason not to do that please scream
> before it's too late (you've plenty of time).

The proposal would be to stop providing new methods and method updates for the non-thread-safe API, correct?  While I'm generally in support of this, I think it is one release too early.  I think that people are just now undertaking the development efforts to use the thread safe API in their software, and we should give folks a bit more time before we pull the rug out.  Let's wait until 3.4 instead of doing it in 3.3.

Howard


From Roger.Bivand at nhh.no  Thu Feb 11 02:07:04 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu Feb 11 02:05:44 2010
Subject: [geos-devel] deprecate non-thread-safe CAPI interfaces
In-Reply-To: <99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>
References: <20100210232651.GC89717@keybit.net>
	<99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>
Message-ID: <alpine.LRH.2.00.1002110754010.9661@reclus.nhh.no>

On Wed, 10 Feb 2010, Howard Butler wrote:

>
> On Feb 10, 2010, at 5:26 PM, strk wrote:
>
>> I'd like to deprecate non-thread-safe version
>> of CAPI interface in next release, and stop providing
>> them for new methods.
>>
>> If anyone sees a reason not to do that please scream
>> before it's too late (you've plenty of time).
>
> The proposal would be to stop providing new methods and method updates 
> for the non-thread-safe API, correct?  While I'm generally in support of 
> this, I think it is one release too early.  I think that people are just 
> now undertaking the development efforts to use the thread safe API in 
> their software, and we should give folks a bit more time before we pull 
> the rug out.  Let's wait until 3.4 instead of doing it in 3.3.

My understanding is that MSYS builds for Win 32 (and maybe 64) do not have 
or use pthreads. R is not thread safe and will never be (compute threads 
are handled differently by say threaded BLAS or coarse-grained partition 
of tasks into sections for parallel computation). I think that GDAL 
provides a MUTEX_NONE stub which I see kicking in on MSYS.

On Linux and OSX, this probably isn't an issue, but building static GEOS 
for Windows necessarily using the R build train (MinGW, MSYS) is fragile, 
and could be broken by hasty changes. The potential R install base for 
GEOS functionality is at least in the thousands, mostly Windows users 
(sorry), who rely on the developers providing packaged binaries through 
CRAN.

If you could push this a little forward in time, and let me try with the 
development version to make sure that any transition can be managed, I'd 
be grateful. As I've said before, the motivation for rgeos is to provide 
an alternative to non-free GPC that has been interfaced to R.

I realise that GEOS usually goes in at the base of the software stack, and 
usually interfaces GIS-type systems, so this case is somewhat atypical.

Roger

>
> Howard
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From strk at keybit.net  Thu Feb 11 12:36:29 2010
From: strk at keybit.net (strk)
Date: Thu Feb 11 12:36:33 2010
Subject: [geos-devel] deprecate non-thread-safe CAPI interfaces
In-Reply-To: <99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>
References: <20100210232651.GC89717@keybit.net>
	<99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>
Message-ID: <20100211173629.GF89717@keybit.net>

On Wed, Feb 10, 2010 at 09:42:56PM -0600, Howard Butler wrote:
> 
> On Feb 10, 2010, at 5:26 PM, strk wrote:
> 
> > I'd like to deprecate non-thread-safe version
> > of CAPI interface in next release, and stop providing
> > them for new methods.
> > 
> > If anyone sees a reason not to do that please scream
> > before it's too late (you've plenty of time).
> 
> The proposal would be to stop providing new methods and method updates for the non-thread-safe API, correct? 

What I mean is that when *new* interfaces are added,
only the version taking GEOSContextHandler would be provided.

And (I meant) all other ones not taking that handler would
be marked with "deprecated" attribute so warnings come
out at build time (only for GCC I know how..).

Can still wait for the second part (deprecation), but I
think it makes sense for the first part (stop *adding*
the bare ones).

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://foo.keybit.net/~strk/services.html
From hobu.inc at gmail.com  Thu Feb 11 13:03:35 2010
From: hobu.inc at gmail.com (Howard Butler)
Date: Thu Feb 11 13:08:21 2010
Subject: [geos-devel] deprecate non-thread-safe CAPI interfaces
In-Reply-To: <20100211173629.GF89717@keybit.net>
References: <20100210232651.GC89717@keybit.net>
	<99A2A8A6-9462-4B42-A887-E059AFA8F4D8@gmail.com>
	<20100211173629.GF89717@keybit.net>
Message-ID: <55460804-6427-46A7-9ED5-CFF9B3235E37@gmail.com>


On Feb 11, 2010, at 11:36 AM, strk wrote:

> On Wed, Feb 10, 2010 at 09:42:56PM -0600, Howard Butler wrote:
>> 
>> On Feb 10, 2010, at 5:26 PM, strk wrote:
>> 
>>> I'd like to deprecate non-thread-safe version
>>> of CAPI interface in next release, and stop providing
>>> them for new methods.
>>> 
>>> If anyone sees a reason not to do that please scream
>>> before it's too late (you've plenty of time).
>> 
>> The proposal would be to stop providing new methods and method updates for the non-thread-safe API, correct? 
> 
> What I mean is that when *new* interfaces are added,
> only the version taking GEOSContextHandler would be provided.
> 
> And (I meant) all other ones not taking that handler would
> be marked with "deprecated" attribute so warnings come
> out at build time (only for GCC I know how..).
> 
> Can still wait for the second part (deprecation), but I
> think it makes sense for the first part (stop *adding*
> the bare ones).

Ok, that's maybe a good carrot, but we should still take care to treat the C API(s) very conservatively with respect to marking something deprecated.  I'd rather let the the non-threadsafe get decrepit through inattention than work too hard to pull the rug out from under someone.  Our promise with the C API is to do our best not to break your code by changing stuff.  We changed stuff (in parallel), but we're still going to support you for a while (undetermined amount of time).  Otherwise we risk being able to push out frequent-but-relatively-harmless updates/releases.

Howard
From geos-trac at osgeo.org  Fri Feb 12 10:29:15 2010
From: geos-trac at osgeo.org (GEOS)
Date: Fri Feb 12 10:29:17 2010
Subject: [geos-devel] Re: [GEOS] #224: Need to compile the libGeos using Sun
 Studio12 on Solaris10
In-Reply-To: <049.909aa59ac32d43fdfa8bd453ff6587cb@osgeo.org>
References: <049.909aa59ac32d43fdfa8bd453ff6587cb@osgeo.org>
Message-ID: <058.f323f9caf1c59aa7012f8de206b0644f@osgeo.org>

#224: Need to compile the libGeos using Sun Studio12 on Solaris10
-------------------------------+--------------------------------------------
 Reporter:  satyajitt          |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement        |       Status:  new                       
 Priority:  blocker            |    Milestone:  3.3.0                     
Component:  Core               |      Version:  svn-trunk                 
 Severity:  Significant        |   Resolution:                            
 Keywords:  sun,solaris,sparc  |  
-------------------------------+--------------------------------------------
Changes (by mloskot):

  * keywords:  => sun,solaris,sparc

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/224#comment:20>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Fri Feb 12 10:29:32 2010
From: geos-trac at osgeo.org (GEOS)
Date: Fri Feb 12 10:29:33 2010
Subject: [geos-devel] Re: [GEOS] #331: Geos build fails on linking on Solaris
In-Reply-To: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
References: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
Message-ID: <058.61941f5d9227303b5cfdc70243bb1925@osgeo.org>

#331: Geos build fails on linking on Solaris
-------------------------------+--------------------------------------------
 Reporter:  sandy2010          |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect             |       Status:  new                       
 Priority:  major              |    Milestone:                            
Component:  Default            |      Version:  3.1.1                     
 Severity:  Critical           |   Resolution:                            
 Keywords:  sun,solaris,sparc  |  
-------------------------------+--------------------------------------------
Changes (by mloskot):

  * keywords:  => sun,solaris,sparc

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/331#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Fri Feb 12 10:31:16 2010
From: geos-trac at osgeo.org (GEOS)
Date: Fri Feb 12 10:31:17 2010
Subject: [geos-devel] Re: [GEOS] #331: Geos build fails on linking on Solaris
In-Reply-To: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
References: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
Message-ID: <058.3b9eef54df477ca8d7695c59a440d000@osgeo.org>

#331: Geos build fails on linking on Solaris
-------------------------------+--------------------------------------------
 Reporter:  sandy2010          |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect             |       Status:  new                       
 Priority:  major              |    Milestone:                            
Component:  Default            |      Version:  3.1.1                     
 Severity:  Critical           |   Resolution:                            
 Keywords:  sun,solaris,sparc  |  
-------------------------------+--------------------------------------------
Old description:

> I'm building geos-3.1.1 on Solaris (5.9 sparc and 5.10 x86) and used all
> the 3 patches uploaded by rroliver in ticket #224.
>
> and I get some issue during link time with multiple symbol definitions.
> When I provide --disable-inline during configure, it gives me the
> following error on linking:
>
> CC -G -zdefs -hlibgeos-3.1.1.so -o .libs/libgeos-3.1.1.so
> .libs/inlines.o -Qoption ld -z -Qoption ld
> allextract,algorithm/.libs/libalgorithm.a,geom/.libs/libgeom.a,geomgraph/.libs/libgeomgraph.a,index/.libs/libindex.a,io/.libs/libio.a,noding/.libs/libnoding.a,operation/.libs/liboperation.a,planargraph/.libs/libplanargraph.a,precision/.libs/libprecision.a,simplify/.libs/libsimplify.a,util/.libs/libutil.a
> -Qoption ld -z -Qoption ld defaultextract  -lCstd -lCrun -lc
>
> Undefined                       first referenced
>  symbol                             in file
>
> cos
> operation/.libs/liboperation.a(OffsetCurveBuilder.o)
> log
> geom/.libs/libgeom.a(PrecisionModel.o)
> pow                                 index/.libs/libindex.a(DoubleBits.o)
> sin
> operation/.libs/liboperation.a(OffsetCurveBuilder.o)
> ceil
> geom/.libs/libgeom.a(PrecisionModel.o)
> fabs
> algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
> sqrt
> algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
> atan2                               geom/.libs/libgeom.a(LineSegment.o)
> floor
> algorithm/.libs/libalgorithm.a(RobustDeterminant.o)
> __fabsl
> algorithm/.libs/libalgorithm.a(HCoordinate.o)
> ld: fatal: Symbol referencing errors. No output written to
> .libs/libgeos-3.1.1.so
> make[2]: *** [libgeos.la] Error 1
> make[2]: Leaving directory `/opt/geos-3.1.1/source'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory `/opt/geos-3.1.1/source'
> make: *** [all-recursive] Error 1

New description:

 I'm building geos-3.1.1 on Solaris (5.9 sparc and 5.10 x86) and used all
 the 3 patches uploaded by rroliver in ticket #224.

 and I get some issue during link time with multiple symbol definitions.
 When I provide --disable-inline during configure, it gives me the
 following error on linking:

 {{{
 CC -G -zdefs -hlibgeos-3.1.1.so -o .libs/libgeos-3.1.1.so
 .libs/inlines.o -Qoption ld -z -Qoption ld
 allextract,algorithm/.libs/libalgorithm.a,geom/.libs/libgeom.a,geomgraph/.libs/libgeomgraph.a,index/.libs/libindex.a,io/.libs/libio.a,noding/.libs/libnoding.a,operation/.libs/liboperation.a,planargraph/.libs/libplanargraph.a,precision/.libs/libprecision.a,simplify/.libs/libsimplify.a,util/.libs/libutil.a
 -Qoption ld -z -Qoption ld defaultextract  -lCstd -lCrun -lc

 Undefined                       first referenced
  symbol                             in file

 cos    operation/.libs/liboperation.a(OffsetCurveBuilder.o)
 log    geom/.libs/libgeom.a(PrecisionModel.o)
 pow      index/.libs/libindex.a(DoubleBits.o)
 sin      operation/.libs/liboperation.a(OffsetCurveBuilder.o)
 ceil     geom/.libs/libgeom.a(PrecisionModel.o)
 fabs     algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
 sqrt     algorithm/.libs/libalgorithm.a(CGAlgorithms.o)
 atan2    geom/.libs/libgeom.a(LineSegment.o)
 floor    algorithm/.libs/libalgorithm.a(RobustDeterminant.o)
 __fabsl  algorithm/.libs/libalgorithm.a(HCoordinate.o)
 ld: fatal: Symbol referencing errors. No output written to
 .libs/libgeos-3.1.1.so
 make[2]: *** [libgeos.la] Error 1
 make[2]: Leaving directory `/opt/geos-3.1.1/source'
 make[1]: *** [all-recursive] Error 1
 make[1]: Leaving directory `/opt/geos-3.1.1/source'
 make: *** [all-recursive] Error 1
 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/331#comment:2>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Fri Feb 12 10:32:30 2010
From: geos-trac at osgeo.org (GEOS)
Date: Fri Feb 12 10:32:31 2010
Subject: [geos-devel] Re: [GEOS] #224: Need to compile the libGeos using Sun
 Studio12 on Solaris10
In-Reply-To: <049.909aa59ac32d43fdfa8bd453ff6587cb@osgeo.org>
References: <049.909aa59ac32d43fdfa8bd453ff6587cb@osgeo.org>
Message-ID: <058.d1092dc1d7a3e4ac1bae4941d625b26f@osgeo.org>

#224: Need to compile the libGeos using Sun Studio12 on Solaris10
-------------------------------+--------------------------------------------
 Reporter:  satyajitt          |        Owner:  geos-devel@lists.osgeo.org
     Type:  enhancement        |       Status:  new                       
 Priority:  blocker            |    Milestone:  3.3.0                     
Component:  Core               |      Version:  svn-trunk                 
 Severity:  Significant        |   Resolution:                            
 Keywords:  sun,solaris,sparc  |  
-------------------------------+--------------------------------------------
Old description:

> We are trying to compile the libGeos using Sun Studio12 (thats the need).
> Any help with the below would be appreciated. Thanks in advance.
>
> In ConvexHull.cpp:
>
> 1) Line 272, sort(pts.begin(), pts.end(), RadiallyLessThen(pts[0]));
> Name-space std missing std::sort(pts.begin(), pts.end(),
> RadiallyLessThen(pts[0]));
>
> 2) Line 167, dest.erase( unique(dest.begin(),dest.end()), dest.end() );
> Name-space std missing dest.erase( std::unique(dest.begin(),dest.end()),
> dest.end() );
>
> 3) After these changes, the following error appears:
>
> CC: Warning: Option -Wall passed to ld, if ld is invoked, ignored
> otherwise
> CC: Warning: Option -ansi passed to ld, if ld is invoked, ignored
> otherwise
> CC: Warning: Option -pedantic passed to ld, if ld is invoked, ignored
> otherwise
> CC: Warning: Option -Wno-long-long passed to ld, if ld is invoked,
> ignored otherwise
> "../../source/headers/geos/platform.h", line 59: Warning: #warning "Could
> not find 64bit integer definition!".
> "../../source/headers/geos/geom/Coordinate.inl", line 140: Warning: Shift
> count is too large.
> "ConvexHull.cpp", line 122: Warning: inputPts hides
> geos::algorithm::ConvexHull::inputPts.
> "ConvexHull.cpp", line 161: Warning: inputPts hides
> geos::algorithm::ConvexHull::inputPts.
> "ConvexHull.cpp", line 210: Error: Could not find a match for
> std::vector<const
> geos::geom::Coordinate*>::assign(__rwstd::__rb_tree<const
> geos::geom::Coordinate*, const geos::geom::Coordinate*,
> __rwstd::__ident<const geos::geom::Coordinate*, const
> geos::geom::Coordinate*>, geos::geom::CoordinateLessThen,
> std::allocator<const geos::geom::Coordinate*>>::const_iterator,
> __rwstd::__rb_tree<const geos::geom::Coordinate*, const
> geos::geom::Coordinate*, __rwstd::__ident<const geos::geom::Coordinate*,
> const geos::geom::Coordinate*>, geos::geom::CoordinateLessThen,
> std::allocator<const geos::geom::Coordinate*>>::const_iterator) needed in
> geos::algorithm::ConvexHull::reduce(std::vector<const
> geos::geom::Coordinate*>&).
> 1 Error(s) and 4 Warning(s) detected.
> *** Error code 1
> make: Fatal error: Command failed for target `ConvexHull.lo'
>
> Unable to build on either x86, amd64 or SPARC

New description:

 We are trying to compile the libGeos using Sun Studio12 (thats the need).
 Any help with the below would be appreciated. Thanks in advance.

 In ConvexHull.cpp:

 1) Line 272,
 {{{
 sort(pts.begin(), pts.end(), RadiallyLessThen(pts[0]));
 }}}
 Name-space std missing
 {{{
 std::sort(pts.begin(), pts.end(), RadiallyLessThen(pts[0]));
 }}}

 2) Line 167,
 {{{
 dest.erase( unique(dest.begin(),dest.end()), dest.end() );
 }}}
 Name-space std missing
 {{{
 dest.erase( std::unique(dest.begin(),dest.end()), dest.end() );
 }}}

 3) After these changes, the following error appears:

 {{{
 CC: Warning: Option -Wall passed to ld, if ld is invoked, ignored
 otherwise
 CC: Warning: Option -ansi passed to ld, if ld is invoked, ignored
 otherwise
 CC: Warning: Option -pedantic passed to ld, if ld is invoked, ignored
 otherwise
 CC: Warning: Option -Wno-long-long passed to ld, if ld is invoked, ignored
 otherwise
 "../../source/headers/geos/platform.h", line 59: Warning: #warning "Could
 not find 64bit integer definition!".
 "../../source/headers/geos/geom/Coordinate.inl", line 140: Warning: Shift
 count is too large.
 "ConvexHull.cpp", line 122: Warning: inputPts hides
 geos::algorithm::ConvexHull::inputPts.
 "ConvexHull.cpp", line 161: Warning: inputPts hides
 geos::algorithm::ConvexHull::inputPts.
 "ConvexHull.cpp", line 210: Error: Could not find a match for
 std::vector<const
 geos::geom::Coordinate*>::assign(__rwstd::__rb_tree<const
 geos::geom::Coordinate*, const geos::geom::Coordinate*,
 __rwstd::__ident<const geos::geom::Coordinate*, const
 geos::geom::Coordinate*>, geos::geom::CoordinateLessThen,
 std::allocator<const geos::geom::Coordinate*>>::const_iterator,
 __rwstd::__rb_tree<const geos::geom::Coordinate*, const
 geos::geom::Coordinate*, __rwstd::__ident<const geos::geom::Coordinate*,
 const geos::geom::Coordinate*>, geos::geom::CoordinateLessThen,
 std::allocator<const geos::geom::Coordinate*>>::const_iterator) needed in
 geos::algorithm::ConvexHull::reduce(std::vector<const
 geos::geom::Coordinate*>&).
 1 Error(s) and 4 Warning(s) detected.
 *** Error code 1
 make: Fatal error: Command failed for target `ConvexHull.lo'
 }}}

 Unable to build on either x86, amd64 or SPARC

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/224#comment:21>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Fri Feb 12 10:34:40 2010
From: geos-trac at osgeo.org (GEOS)
Date: Fri Feb 12 10:34:41 2010
Subject: [geos-devel] Re: [GEOS] #331: Geos build fails on linking on Solaris
In-Reply-To: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
References: <049.98f1d508c969b170ee478eb81a910cf0@osgeo.org>
Message-ID: <058.e781b894b3d2d535ed52b96f86a32f7e@osgeo.org>

#331: Geos build fails on linking on Solaris
-------------------------------+--------------------------------------------
 Reporter:  sandy2010          |        Owner:  geos-devel@lists.osgeo.org
     Type:  defect             |       Status:  new                       
 Priority:  major              |    Milestone:                            
Component:  Default            |      Version:  3.1.1                     
 Severity:  Critical           |   Resolution:                            
 Keywords:  sun,solaris,sparc  |  
-------------------------------+--------------------------------------------
Comment (by mloskot):

 Note, the patches from #224 have not been incorporated to GEOS source
 base, so they are not supported as a part of GEOS.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/331#comment:3>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From mateusz at loskot.net  Fri Feb 12 16:14:18 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Feb 12 16:14:23 2010
Subject: [geos-devel] Re: cmake: distclean-like ? out of source tree build
	?
In-Reply-To: <20100210152919.GB86316@keybit.net>
References: <20100206203558.GV48563@keybit.net>
	<4B6DDB32.2070103@loskot.net>	<4B6DDB8A.6090302@loskot.net>
	<20100210152919.GB86316@keybit.net>
Message-ID: <4B75C4AA.3090708@loskot.net>

strk wrote:
> On Sat, Feb 06, 2010 at 09:13:46PM +0000, Mateusz Loskot wrote:
>> Mateusz Loskot wrote:
>>> mloskot@dog:~/dev/geos/_svn/trunk$ svn-clean
>> By the way, if you are suspicious about some remaining garbage in the
>> source tree, just run svn-clean and confirm you have trunk up-to-date
>> with nothing reported by svn status.
> 
> svn-clean doesn't seem to be part of 'svn' package, do you confirm ?

Yes, it is not. I install it from separate package on Debian

http://packages.debian.org/lenny/subversion-tools

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mickamusset at gmail.com  Sat Feb 13 07:47:12 2010
From: mickamusset at gmail.com (Michael musset)
Date: Sat Feb 13 07:53:20 2010
Subject: [geos-devel] geos + editor
Message-ID: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>

Hi,

I'm wondering if there is already an editor (open source if that is possible
) for building object in 3D and store it in opengis+GEOS


thanks for the answer ;)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100213/e8b061cf/attachment.html
From mickamusset at gmail.com  Sat Feb 13 10:12:39 2010
From: mickamusset at gmail.com (Michael musset)
Date: Sat Feb 13 10:12:43 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>
Message-ID: <928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>

Hi,


is there a sample code ?
is there a tutorial ?


I would like to know what can i do with this library.
is it possible to build an editor ?
is it possible to show a 3D object with opengl + opengis + geos ?


Thx,



On Sat, Feb 13, 2010 at 1:47 PM, Michael musset <mickamusset@gmail.com>wrote:

> Hi,
>
> I'm wondering if there is already an editor (open source if that is
> possible ) for building object in 3D and store it in opengis+GEOS
>
>
> thanks for the answer ;)
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100213/fa9c55bc/attachment.html
From jrepetto at free.fr  Sat Feb 13 13:41:25 2010
From: jrepetto at free.fr (Jean-Claude REPETTO)
Date: Sat Feb 13 13:41:38 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>
	<928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>
Message-ID: <4B76F255.50107@free.fr>

Michael musset a ?crit :
> Hi, 
> 
> 
> is there a sample code ?
> is there a tutorial ?
> 
> 
> I would like to know what can i do with this library.
> is it possible to build an editor ?
> is it possible to show a 3D object with opengl + opengis + geos ?
> 
> 
> Thx,
> 

Hi,

What library are you talking about ?

Jean-Claude
From mickamusset at gmail.com  Sat Feb 13 13:43:27 2010
From: mickamusset at gmail.com (Michael musset)
Date: Sat Feb 13 13:43:30 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <4B76F255.50107@free.fr>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>
	<928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>
	<4B76F255.50107@free.fr>
Message-ID: <928a55c51002131043l108a7c6cqbfa554093a58b609@mail.gmail.com>

this one :

http://trac.osgeo.org/geos/

thanks !

On Sat, Feb 13, 2010 at 7:41 PM, Jean-Claude REPETTO <jrepetto@free.fr>wrote:

> Michael musset a ?crit :
>
>  Hi,
>>
>> is there a sample code ?
>> is there a tutorial ?
>>
>>
>> I would like to know what can i do with this library.
>> is it possible to build an editor ?
>> is it possible to show a 3D object with opengl + opengis + geos ?
>>
>>
>> Thx,
>>
>>
> Hi,
>
> What library are you talking about ?
>
> Jean-Claude
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100213/8a00f6aa/attachment.html
From mateusz at loskot.net  Sat Feb 13 14:04:46 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Feb 13 14:04:52 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <928a55c51002131043l108a7c6cqbfa554093a58b609@mail.gmail.com>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>	<928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>	<4B76F255.50107@free.fr>
	<928a55c51002131043l108a7c6cqbfa554093a58b609@mail.gmail.com>
Message-ID: <4B76F7CE.30407@loskot.net>

Michael musset wrote:
> this one :
> 
> http://trac.osgeo.org/geos/
>
> is there a sample code ?

Yes, there is.

> is there a tutorial ?

No, there seems to be no tutorial.

> I would like to know what can i do with this library.

It would be easier to tell if you asked what you need to do.

http://download.osgeo.org/geos/doxygen/namespaces.html

> is it possible to build an editor ?

Yes, it is.

> is it possible to show a 3D object with opengl + opengis + geos ?

I'm unsure what you mean as opengis  opengl and geos.
If you mean opengis as OpenGIS (aka OGC), opengl as OpenGL
and geos as GEOS. (If you do, please use correct spelling next time)
I presume there should be no conflict or obstacle in doing that.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mickamusset at gmail.com  Sat Feb 13 14:06:34 2010
From: mickamusset at gmail.com (Michael musset)
Date: Sat Feb 13 14:06:37 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <4B76F7CE.30407@loskot.net>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>
	<928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>
	<4B76F255.50107@free.fr>
	<928a55c51002131043l108a7c6cqbfa554093a58b609@mail.gmail.com>
	<4B76F7CE.30407@loskot.net>
Message-ID: <928a55c51002131106q16223285pffabbd8f4eecf0cc@mail.gmail.com>

Yes, and i'm sorry, but how can i use GEOS ?
is there somewhere some example ?

Thanks,

On Sat, Feb 13, 2010 at 8:04 PM, Mateusz Loskot <mateusz@loskot.net> wrote:

> Michael musset wrote:
> > this one :
> >
> > http://trac.osgeo.org/geos/
> >
> > is there a sample code ?
>
> Yes, there is.
>
> > is there a tutorial ?
>
> No, there seems to be no tutorial.
>
> > I would like to know what can i do with this library.
>
> It would be easier to tell if you asked what you need to do.
>
> http://download.osgeo.org/geos/doxygen/namespaces.html
>
> > is it possible to build an editor ?
>
> Yes, it is.
>
> > is it possible to show a 3D object with opengl + opengis + geos ?
>
> I'm unsure what you mean as opengis  opengl and geos.
> If you mean opengis as OpenGIS (aka OGC), opengl as OpenGL
> and geos as GEOS. (If you do, please use correct spelling next time)
> I presume there should be no conflict or obstacle in doing that.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100213/b280e679/attachment.html
From mateusz at loskot.net  Sat Feb 13 14:20:30 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Feb 13 14:20:36 2010
Subject: [geos-devel] Re: geos + editor
In-Reply-To: <928a55c51002131106q16223285pffabbd8f4eecf0cc@mail.gmail.com>
References: <928a55c51002130447n2f20db67id591b5a4620f7d8c@mail.gmail.com>	<928a55c51002130712w62f536a3ia59a1275599187f1@mail.gmail.com>	<4B76F255.50107@free.fr>	<928a55c51002131043l108a7c6cqbfa554093a58b609@mail.gmail.com>	<4B76F7CE.30407@loskot.net>
	<928a55c51002131106q16223285pffabbd8f4eecf0cc@mail.gmail.com>
Message-ID: <4B76FB7E.6030302@loskot.net>

Michael musset wrote:
> Yes, and i'm sorry, but how can i use GEOS ?
> is there somewhere some example ?

The only best option I can suggest myself is to look at example programs
in the test unit packages:

http://trac.osgeo.org/geos/browser/trunk/tests/unit

By reading these simple test cases, you can learn how to perform
elementary operations. You will also have to learn about basics of
OGC Simple Feature Specification to grasp the idea of geometry
model, etc.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From gavin.heavyside at gmail.com  Sun Feb 21 08:52:31 2010
From: gavin.heavyside at gmail.com (Gavin Heavyside)
Date: Sun Feb 21 08:58:31 2010
Subject: [geos-devel] CMake, with GEOS as a dependency of a project
Message-ID: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>

I like to build dependencies of my projects as subprojects using CMake.  To
do this for GEOS I do the following from my main project CMakeLists.txt:

# GEOS
set(GEOS_ENABLE_TESTS off CACHE INTERNAL "")
add_subdirectory(vendor/osgeo/geos EXCLUDE_FROM_ALL)


This means that GEOS will be built whenever a binary from my main project
specifies GEOS as a dependency.  I use this technique successfully with
boost, googlemock and others.

For this to work properly, the subproject CMake configuration must not
assume that its directory is also the global project root.  The following
patch makes building as a subproject work correctly, and to the best of my
knowledge does not alter the behaviour when building GEOS in isolation.

diff --git a/CMakeLists.txt b/CMakeLists.txt
index ec589e7..21a6c50 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -19,7 +19,7 @@ if(NOT CMAKE_VERSION)
 endif()

 # Location of custom CMake modules with macros used by GEOS
-set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake/modules")
+set(CMAKE_MODULE_PATH "${geos_SOURCE_DIR}/cmake/modules")

 #################################################################################
 # Setup GEOS version


I tried to add this a ticket, but after creating an osgeo ID it isn't yet
recognised by Trac.

Thanks very much,

Gavin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100221/a7232c4d/attachment.html
From mateusz at loskot.net  Sun Feb 21 09:51:49 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Feb 21 09:52:54 2010
Subject: [geos-devel] CMake, with GEOS as a dependency of a project
In-Reply-To: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>
References: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>
Message-ID: <3b7a94b2c3412f5235a164e75f2a5918.squirrel@loskot.net>

Gavin Heavyside wrote:
> I like to build dependencies of my projects as subprojects using CMake.
> To
> do this for GEOS I do the following from my main project CMakeLists.txt:
>
> # GEOS
> set(GEOS_ENABLE_TESTS off CACHE INTERNAL "")
> add_subdirectory(vendor/osgeo/geos EXCLUDE_FROM_ALL)
>
> This means that GEOS will be built whenever a binary from my main project
> specifies GEOS as a dependency.  I use this technique successfully with
> boost, googlemock and others.

Gavin, interesting idea.

> For this to work properly, the subproject CMake configuration must not
> assume that its directory is also the global project root.  The following
> patch makes building as a subproject work correctly, and to the best of my
> knowledge does not alter the behaviour when building GEOS in isolation.
>
> diff --git a/CMakeLists.txt b/CMakeLists.txt
> index ec589e7..21a6c50 100644
> --- a/CMakeLists.txt
> +++ b/CMakeLists.txt
> @@ -19,7 +19,7 @@ if(NOT CMAKE_VERSION)
>  endif()
>
>  # Location of custom CMake modules with macros used by GEOS
> -set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake/modules")
> +set(CMAKE_MODULE_PATH "${geos_SOURCE_DIR}/cmake/modules")


Applied to trunk, thanks!

http://trac.osgeo.org/geos/changeset/2916

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From gavin.heavyside at gmail.com  Sun Feb 21 10:55:36 2010
From: gavin.heavyside at gmail.com (Gavin Heavyside)
Date: Sun Feb 21 10:55:39 2010
Subject: [geos-devel] CMake, with GEOS as a dependency of a project
In-Reply-To: <3b7a94b2c3412f5235a164e75f2a5918.squirrel@loskot.net>
References: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>
	<3b7a94b2c3412f5235a164e75f2a5918.squirrel@loskot.net>
Message-ID: <f4d3e2a21002210755h64b2bc24jac0da8e7bcad84a7@mail.gmail.com>

2010/2/21 Mateusz Loskot <mateusz@loskot.net>

> Gavin Heavyside wrote:
> > This means that GEOS will be built whenever a binary from my main project
> > specifies GEOS as a dependency.  I use this technique successfully with
> > boost, googlemock and others.
>
> Gavin, interesting idea.
>
> It works well for me, as I build projects on multiple machines with
different architectures, and building dependencies as part of the project
means I can upgrade dependencies or change their configuration in a single
place.  The strategy is the one described in the boost CMake docs:

http://sodium.resophonic.com/boost-cmake/current-docs/exported_targets.html#with-boost-source-in-a-subdirectory-of-your-source


> Applied to trunk, thanks!
>

As I've investigated further, there are a couple more places that need
changing:

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 21a6c50..020dc3b 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -206,13 +206,13 @@ endif()
 #################################################################################

 # for including GEOS C++ API headers
-include_directories(${CMAKE_SOURCE_DIR}/include)
+include_directories(${geos_SOURCE_DIR}/include)

 # for including build-specific GEOS C API headers
-include_directories(${CMAKE_BINARY_DIR}/capi)
+include_directories(${geos_BINARY_DIR}/capi)

 # for including build-specific version.h, platform.h and geos_c.h
-include_directories(${CMAKE_BINARY_DIR}/include)
+include_directories(${geos_BINARY_DIR}/include)

 #################################################################################
 # Setup checks and generate config headers



With the above patch, and after adding relevant include dirs to my main
CMakeFiles.txt, I can successfully build and link against GEOS from my main
project, with GEOS being built correctly as a dependency.

Thanks,

Gavin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100221/18261287/attachment.html
From mateusz at loskot.net  Sun Feb 21 12:14:01 2010
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Feb 21 12:14:06 2010
Subject: [geos-devel] CMake, with GEOS as a dependency of a project
In-Reply-To: <f4d3e2a21002210755h64b2bc24jac0da8e7bcad84a7@mail.gmail.com>
References: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>	<3b7a94b2c3412f5235a164e75f2a5918.squirrel@loskot.net>
	<f4d3e2a21002210755h64b2bc24jac0da8e7bcad84a7@mail.gmail.com>
Message-ID: <4B8169D9.6040501@loskot.net>

Gavin Heavyside wrote:
> 2010/2/21 Mateusz Loskot <mateusz@loskot.net>
> 
>> Gavin Heavyside wrote:
>>> This means that GEOS will be built whenever a binary from my main project
>>> specifies GEOS as a dependency.  I use this technique successfully with
>>> boost, googlemock and others.
>> Gavin, interesting idea.
>
> It works well for me, as I build projects on multiple machines with
> different architectures, and building dependencies as part of the project
> means I can upgrade dependencies or change their configuration in a single
> place.  The strategy is the one described in the boost CMake docs:
> 
> http://sodium.resophonic.com/boost-cmake/current-docs/exported_targets.html#with-boost-source-in-a-subdirectory-of-your-source

I use the Troy's ideas for Boost quite often but I have missed this
trick. Thanks.

> As I've investigated further, there are a couple more places that need
> changing:
> 
> diff --git a/CMakeLists.txt b/CMakeLists.txt
> index 21a6c50..020dc3b 100644
> --- a/CMakeLists.txt
> +++ b/CMakeLists.txt
> @@ -206,13 +206,13 @@ endif()
>  #################################################################################
> 
>  # for including GEOS C++ API headers
> -include_directories(${CMAKE_SOURCE_DIR}/include)
> +include_directories(${geos_SOURCE_DIR}/include)
> 
>  # for including build-specific GEOS C API headers
> -include_directories(${CMAKE_BINARY_DIR}/capi)
> +include_directories(${geos_BINARY_DIR}/capi)
> 
>  # for including build-specific version.h, platform.h and geos_c.h
> -include_directories(${CMAKE_BINARY_DIR}/include)
> +include_directories(${geos_BINARY_DIR}/include)
> 
>  #################################################################################
>  # Setup checks and generate config headers

Applied to trunk. Thanks!

By the way, I'm going to hack 'make uninstall' target soon.
I know general CMake approaches for this but perhaps you would
have some helpful tricks how to do it neatly for GEOS?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From gavin.heavyside at gmail.com  Sun Feb 21 13:08:32 2010
From: gavin.heavyside at gmail.com (Gavin Heavyside)
Date: Sun Feb 21 13:08:35 2010
Subject: [geos-devel] CMake, with GEOS as a dependency of a project
In-Reply-To: <4B8169D9.6040501@loskot.net>
References: <f4d3e2a21002210552yf6be9f5qb0bc487ea761f27e@mail.gmail.com>
	<3b7a94b2c3412f5235a164e75f2a5918.squirrel@loskot.net>
	<f4d3e2a21002210755h64b2bc24jac0da8e7bcad84a7@mail.gmail.com>
	<4B8169D9.6040501@loskot.net>
Message-ID: <f4d3e2a21002211008p497eefbdq37768dcc2904e010@mail.gmail.com>

On 21 February 2010 17:14, Mateusz Loskot <mateusz@loskot.net> wrote:

>
> Applied to trunk. Thanks!
>
>
Thanks Mateusz.


> By the way, I'm going to hack 'make uninstall' target soon.
> I know general CMake approaches for this but perhaps you would
> have some helpful tricks how to do it neatly for GEOS?


Nothing specific to suggest at the moment, I'm a fairly recent convert to
CMake.  If I think of anything as I work with GEOS, I'll be sure to let you
know.

Thanks,

Gavin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20100221/119889f0/attachment.html
