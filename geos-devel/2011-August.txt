From oyvind.idland at gmail.com  Wed Aug  3 07:19:05 2011
From: oyvind.idland at gmail.com (Oyvind Idland)
Date: Wed Aug  3 21:22:22 2011
Subject: [geos-devel] WkbReader and Z-geometries
Message-ID: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>

Hello,

i am trying to read WKB chunks based on the iso SQL/MM part3 spec. However,
this doesn't seem to work.

>From the WkbReader source code doc:
"This implementation supports the extended WKB standard for representing
3-dimensional coordinates. The presence of 3D coordinates is signified by
setting the high bit of the wkbType word."

Which extended WKB standard is being refered to here ?



For example, In the SQL/MM spec, various point types are defined as the
following unsigned values (not hex):

<wkbpoint>     1
<wkbpointz>   3000001
<wkbpointzm> 2000001
<wkbpointm>   4000001

However, in the WkbReader.cpp the following logic is used:

    int typeInt = dis.readInt();
    int geometryType = typeInt & 0xff;
    ......
    bool hasZ = ((typeInt & 0x80000000) != 0);
    if (hasZ) inputDimension = 3;
    else inputDimension = 2; // doesn't handle M currently




Is there any plans to implement support for SQL/MM ?  (I can volunteer for a
patch, if desired)


-- Oyvind
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110803/57fb06a0/attachment.html
From geos-trac at osgeo.org  Wed Aug  3 19:05:05 2011
From: geos-trac at osgeo.org (GEOS)
Date: Thu Aug  4 09:47:36 2011
Subject: [geos-devel] [GEOS] #464: Clone Does Not Honor SRID
Message-ID: <044.927d11aa2442e11356d5de68ac02aa7c@osgeo.org>

#464: Clone Does Not Honor SRID
------------------------+---------------------------------------------------
 Reporter:  cfis        |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  3.3.0                     
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 When geometries are cloned, their SRID values are not copied over.   Thus
 the cloned geometry is not the same as the original.

 Could this be added to the library?

 Thanks - Charlie

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/464>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From mtnclimb at telus.net  Wed Aug  3 20:24:32 2011
From: mtnclimb at telus.net (Martin Davis)
Date: Thu Aug  4 11:12:05 2011
Subject: [geos-devel] WkbReader and Z-geometries
In-Reply-To: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
References: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
Message-ID: <4E39E6C0.9010403@telus.net>

The EWKB that JTS and GEOS implement is based on the PostGIS EWKB 
specification (which predates the SQL/MM spec, I think.)

I don't have a good reference for the PostGIS spec - it would be nice if 
there was one online somewhere (hint, hint).

It might be nice if JTS/GEOS supported the SQL/MM spec as well.  Do you 
have a reference available for the spec?

Martin

On 8/3/2011 4:19 AM, Oyvind Idland wrote:
> Hello,
>
> i am trying to read WKB chunks based on the iso SQL/MM part3 spec. 
> However, this doesn't seem to work.
>
> From the WkbReader source code doc:
> "This implementation supports the extended WKB standard for 
> representing 3-dimensional coordinates. The presence of 3D coordinates 
> is signified by setting the high bit of the wkbType word."
>
> Which extended WKB standard is being refered to here ?
>
>
>
> For example, In the SQL/MM spec, various point types are defined as 
> the following unsigned values (not hex):
>
> <wkbpoint>     1
> <wkbpointz>   3000001
> <wkbpointzm> 2000001
> <wkbpointm>   4000001
>
> However, in the WkbReader.cpp the following logic is used:
>
>     int typeInt = dis.readInt();
>     int geometryType = typeInt & 0xff;
>     ......
>     bool hasZ = ((typeInt & 0x80000000) != 0);
>     if (hasZ) inputDimension = 3;
>     else inputDimension = 2; // doesn't handle M currently
>
>
>
>
> Is there any plans to implement support for SQL/MM ?  (I can volunteer 
> for a patch, if desired)
>
>
> -- Oyvind
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> No virus found in this message.
> Checked by AVG - www.avg.com <http://www.avg.com>
> Version: 10.0.1390 / Virus Database: 1518/3807 - Release Date: 08/03/11
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110803/f9f717ad/attachment.html
From woodbri at swoodbridge.com  Wed Aug  3 20:53:52 2011
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu Aug  4 11:47:16 2011
Subject: [geos-devel] WkbReader and Z-geometries
In-Reply-To: <4E39E6C0.9010403@telus.net>
References: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
	<4E39E6C0.9010403@telus.net>
Message-ID: <4E39EDA0.50807@swoodbridge.com>

On 8/3/2011 8:24 PM, Martin Davis wrote:
> SQL/MM spec

Martin,

Do either of these help?

http://www.opengeospatial.org/standards/sfs

http://www.google.com/#q=SQL/MM+spec
http://www.google.com/#q=SQL/MM+spec+ogc
http://www.google.com/#q=SQL/MM+spec+postgis

I thought I saw a SQL/MM PostGIS spec at one time, but I could not find 
it either. All that I came up with is references to SQL/MM functions in 
PostGIS.

-Steve
From oyvind.idland at gmail.com  Thu Aug  4 01:46:39 2011
From: oyvind.idland at gmail.com (Oyvind Idland)
Date: Thu Aug  4 16:51:33 2011
Subject: [geos-devel] WkbReader and Z-geometries
In-Reply-To: <4E39E6C0.9010403@telus.net>
References: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
	<4E39E6C0.9010403@telus.net>
Message-ID: <CAEVk4t0+Zy53q1f6WSeR4qKvhjT7tsRP+i_+zWbRvWidhaZTSg@mail.gmail.com>

Oh.. sweet chaos!

The lack of a WKB-spec with Z (and M) ordinates seems to have triggered a
bunch of WKB-flavours, such as
- OGR's "Two-and-a-half-D extensions for Simple Features"
- FDO's FGF-format
- Postgis EWKB

I found the EWKB proposal here, but probably not the latest:
http://postgis.refractions.net/pipermail/postgis-devel/2004-December/000710.html

As far as I can see, it is fairly similar in structure as the SQL/MM, except
for the optional SRID. The object-type ID's are of course not the same.

In addition, SQL/MM specifies CircularString/CurvePolygon/CompundCurve etc
aswell, would be nice to have these implemented in GEOS aswell (PostGIS has
done some work here, not sure what)

I got two versions of the SQL/MM spec in PDF, the earliest (2nd edtion)
dates from 2002. I'll send you the newest right away.

For now, I'll try to make a simple hack on the existing WkbReader.

Would be nice with a more united WKB-world...


-- Oyvind





On Thu, Aug 4, 2011 at 2:24 AM, Martin Davis <mtnclimb@telus.net> wrote:

> **
> The EWKB that JTS and GEOS implement is based on the PostGIS EWKB
> specification (which predates the SQL/MM spec, I think.)
>
> I don't have a good reference for the PostGIS spec - it would be nice if
> there was one online somewhere (hint, hint).
>
> It might be nice if JTS/GEOS supported the SQL/MM spec as well.  Do you
> have a reference available for the spec?
>
> Martin
>
>
> On 8/3/2011 4:19 AM, Oyvind Idland wrote:
>
> Hello,
>
> i am trying to read WKB chunks based on the iso SQL/MM part3 spec. However,
> this doesn't seem to work.
>
> From the WkbReader source code doc:
> "This implementation supports the extended WKB standard for representing
> 3-dimensional coordinates. The presence of 3D coordinates is signified by
> setting the high bit of the wkbType word."
>
> Which extended WKB standard is being refered to here ?
>
>
>
> For example, In the SQL/MM spec, various point types are defined as the
> following unsigned values (not hex):
>
> <wkbpoint>     1
> <wkbpointz>   3000001
> <wkbpointzm> 2000001
> <wkbpointm>   4000001
>
> However, in the WkbReader.cpp the following logic is used:
>
>     int typeInt = dis.readInt();
>     int geometryType = typeInt & 0xff;
>     ......
>     bool hasZ = ((typeInt & 0x80000000) != 0);
>     if (hasZ) inputDimension = 3;
>     else inputDimension = 2; // doesn't handle M currently
>
>
>
>
> Is there any plans to implement support for SQL/MM ?  (I can volunteer for
> a patch, if desired)
>
>
> -- Oyvind
>
>
> _______________________________________________
> geos-devel mailing listgeos-devel@lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1390 / Virus Database: 1518/3807 - Release Date: 08/03/11
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110804/c5057d27/attachment.html
From strk at keybit.net  Thu Aug  4 17:22:45 2011
From: strk at keybit.net (Sandro Santilli)
Date: Fri Aug  5 09:19:49 2011
Subject: [geos-devel] WkbReader and Z-geometries
In-Reply-To: <CAEVk4t0+Zy53q1f6WSeR4qKvhjT7tsRP+i_+zWbRvWidhaZTSg@mail.gmail.com>
References: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
	<4E39E6C0.9010403@telus.net>
	<CAEVk4t0+Zy53q1f6WSeR4qKvhjT7tsRP+i_+zWbRvWidhaZTSg@mail.gmail.com>
Message-ID: <20110804212245.GD2873@gnash>

On Thu, Aug 04, 2011 at 07:46:39AM +0200, Oyvind Idland wrote:
> Oh.. sweet chaos!
> 
> The lack of a WKB-spec with Z (and M) ordinates seems to have triggered a
> bunch of WKB-flavours, such as
> - OGR's "Two-and-a-half-D extensions for Simple Features"
> - FDO's FGF-format
> - Postgis EWKB
> 
> I found the EWKB proposal here, but probably not the latest:
> http://postgis.refractions.net/pipermail/postgis-devel/2004-December/000710.html
> 
> As far as I can see, it is fairly similar in structure as the SQL/MM, except
> for the optional SRID. The object-type ID's are of course not the same.
> 
> In addition, SQL/MM specifies CircularString/CurvePolygon/CompundCurve etc
> aswell, would be nice to have these implemented in GEOS aswell (PostGIS has
> done some work here, not sure what)
> 
> I got two versions of the SQL/MM spec in PDF, the earliest (2nd edtion)
> dates from 2002. I'll send you the newest right away.
> 
> For now, I'll try to make a simple hack on the existing WkbReader.
> 
> Would be nice with a more united WKB-world...

Please use an enum for different WKB types, it's the best we can have.
I confirm any extension support comes from PostGIS EWKB, which is
documented in doc/ZMSgeoms.txt, which is the document submitted as
proposal to the OGC (not sure about the outcome of that).

--strk;

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html
From oyvind.idland at gmail.com  Fri Aug  5 04:30:20 2011
From: oyvind.idland at gmail.com (Oyvind Idland)
Date: Fri Aug  5 21:04:33 2011
Subject: [geos-devel] WkbReader and Z-geometries
In-Reply-To: <20110804212245.GD2873@gnash>
References: <CAEVk4t3ai3G0ymyRkThY10SixVcukncpb+abY0xu8k1ju9F6CA@mail.gmail.com>
	<4E39E6C0.9010403@telus.net>
	<CAEVk4t0+Zy53q1f6WSeR4qKvhjT7tsRP+i_+zWbRvWidhaZTSg@mail.gmail.com>
	<20110804212245.GD2873@gnash>
Message-ID: <CAEVk4t2PhHziOHniMp=H5CpD9LON1LH7zpPyCrSa6CsoXxzo9Q@mail.gmail.com>

On Thu, Aug 4, 2011 at 11:22 PM, Sandro Santilli <strk@keybit.net> wrote:

> On Thu, Aug 04, 2011 at 07:46:39AM +0200, Oyvind Idland wrote:
> > Oh.. sweet chaos!
> >
> > The lack of a WKB-spec with Z (and M) ordinates seems to have triggered a
> > bunch of WKB-flavours, such as
> > - OGR's "Two-and-a-half-D extensions for Simple Features"
> > - FDO's FGF-format
> > - Postgis EWKB
> >
> > I found the EWKB proposal here, but probably not the latest:
> >
> http://postgis.refractions.net/pipermail/postgis-devel/2004-December/000710.html
> >
> > As far as I can see, it is fairly similar in structure as the SQL/MM,
> except
> > for the optional SRID. The object-type ID's are of course not the same.
> >
> > In addition, SQL/MM specifies CircularString/CurvePolygon/CompundCurve
> etc
> > aswell, would be nice to have these implemented in GEOS aswell (PostGIS
> has
> > done some work here, not sure what)
> >
> > I got two versions of the SQL/MM spec in PDF, the earliest (2nd edtion)
> > dates from 2002. I'll send you the newest right away.
> >
> > For now, I'll try to make a simple hack on the existing WkbReader.
> >
> > Would be nice with a more united WKB-world...
>
> Please use an enum for different WKB types, it's the best we can have.
> I confirm any extension support comes from PostGIS EWKB, which is
> documented in doc/ZMSgeoms.txt, which is the document submitted as
> proposal to the OGC (not sure about the outcome of that).
>
> --strk;
>
>
OGC is currently working on harmonization with ISO, and they will probably
adopt SQL-mm part 3 (3D coordinates, WKB, etc):

http://www.opengeospatial.org/projects/groups/sfswg


-- Oyvind
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110805/9b8e2a6a/attachment.html
From oyvind.idland at gmail.com  Wed Aug 10 05:52:25 2011
From: oyvind.idland at gmail.com (Oyvind Idland)
Date: Thu Aug 11 05:06:57 2011
Subject: [geos-devel] A little performance test: NTS VS GEOS
Message-ID: <CAEVk4t0OutyB62_xE5WG+6==xnjB1dPTu9yTMgQpUmqRuQPZ1w@mail.gmail.com>

Hello,

I did a little performance test just to test GEOS vs NTS. I have made a
C++/CLI wrapper for .NET, and the tests was
run using PreparedGeometries in GEOS (NTS does not have this feature yet).

In all tests i have done, NTS outperformed GEOS in the total summary.
The reason ? WkbReader. On the pure geometry operations (Overlaps,
Intersects etc), GEOS is at least twice as
fast (possibly faster too in some cases). In my case, I do WKB --> Geometry
on the fly, and the actual conversion
perfomance is a bit disappointing.

Below there are two testresult outputs: Both is executed against a dataset
containing 10721 polygons, where one
uses a LineString operand, the other a Polygon operand. The result shows the
operand being used, the time for WKB
conversion and operand times.

I believe there are potential here...


-- Oyvind





------------------------------------------------------------------------------------------------------------------------
Operand:POLYGON ((538213.275331 6544838.215101, 538312.712452
6545313.648834, 538940.409276 6545621.282426, 540152.299185 6545394.441495,
540261.058536 6544841.322511, 54
0192.695515 6544493.292588, 539574.320921 6544362.781367, 539235.613228
6544213.625686, 538617.238634 6544431.144388, 537467.496926 6544201.196046,
538213.275331 6544838.
215101))

Results from GEOS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
MaxY=6554152 width=27573 , height=23208]
Feature count: 10721
Crosses Count: 0
Intersects Count: 978
Covers Count: 128
Contains Count: 850
Time used for WKB: 824 millis
Time used for operand: 217 millis
Total time: 1041 millis


Results from NTS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
MaxY=6554152 width=27573 , height=23208]
Feature count: 10721
Crosses Count: 0
Intersects Count: 978
Covers Count: 128
Contains Count: 850
Time used for WKB: 172 millis
Time used for operand: 527 millis
Total time: 699 millis
------------------------------------------------------------------------------------------------------------------------



------------------------------------------------------------------------------------------------------------------------
Operand:LINESTRING (538616.04842 6542972.503409, 539659.659719
6543126.67326, 540134.028491 6543049.588335, 540424.579364 6542883.559264,
540673.622969 6542658.234098, 54
0976.033062 6542770.896681, 541029.399549 6542978.433019, 541385.176128
6542782.7559, 541628.290123 6542338.035176)


Results from GEOS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
MaxY=6554152 width=27573 , height=23208]
Feature count: 10721
Crosses Count: 54
Intersects Count: 54
Covers Count: 0
Contains Count: 0
Time used for WKB: 850 millis
Time used for operand: 110 millis
Total time: 960 millis

Results from NTS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
MaxY=6554152 width=27573 , height=23208]
Feature count: 10721
Crosses Count: 54
Intersects Count: 54
Covers Count: 0
Contains Count: 0
Time used for WKB: 174 millis
Time used for operand: 247 millis
Total time: 421 millis
------------------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110810/066b7ac4/attachment.html
From strk at keybit.net  Tue Aug 16 06:16:47 2011
From: strk at keybit.net (Sandro Santilli)
Date: Wed Aug 17 13:27:01 2011
Subject: [geos-devel] A little performance test: NTS VS GEOS
In-Reply-To: <CAEVk4t0OutyB62_xE5WG+6==xnjB1dPTu9yTMgQpUmqRuQPZ1w@mail.gmail.com>
References: <CAEVk4t0OutyB62_xE5WG+6==xnjB1dPTu9yTMgQpUmqRuQPZ1w@mail.gmail.com>
Message-ID: <20110816101647.GB22122@gnash>

Thanks Oyvind for the profiling.
Yeah, WKB parser wasn't a priority as main user of the library (PostGIS)
is using direct construction (via Points).

Nonetheless it's annoying to be slower than a .NET thing, so if anyone
is willing to fund a WKB parser speedup improvement I'll be glad to
work on it ;)

--strk;

On Wed, Aug 10, 2011 at 11:52:25AM +0200, Oyvind Idland wrote:
> Hello,
> 
> I did a little performance test just to test GEOS vs NTS. I have made a
> C++/CLI wrapper for .NET, and the tests was
> run using PreparedGeometries in GEOS (NTS does not have this feature yet).
> 
> In all tests i have done, NTS outperformed GEOS in the total summary.
> The reason ? WkbReader. On the pure geometry operations (Overlaps,
> Intersects etc), GEOS is at least twice as
> fast (possibly faster too in some cases). In my case, I do WKB --> Geometry
> on the fly, and the actual conversion
> perfomance is a bit disappointing.
> 
> Below there are two testresult outputs: Both is executed against a dataset
> containing 10721 polygons, where one
> uses a LineString operand, the other a Polygon operand. The result shows the
> operand being used, the time for WKB
> conversion and operand times.
> 
> I believe there are potential here...
> 
> 
> -- Oyvind
> 
> 
> 
> 
> 
> ------------------------------------------------------------------------------------------------------------------------
> Operand:POLYGON ((538213.275331 6544838.215101, 538312.712452
> 6545313.648834, 538940.409276 6545621.282426, 540152.299185 6545394.441495,
> 540261.058536 6544841.322511, 54
> 0192.695515 6544493.292588, 539574.320921 6544362.781367, 539235.613228
> 6544213.625686, 538617.238634 6544431.144388, 537467.496926 6544201.196046,
> 538213.275331 6544838.
> 215101))
> 
> Results from GEOS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
> MaxY=6554152 width=27573 , height=23208]
> Feature count: 10721
> Crosses Count: 0
> Intersects Count: 978
> Covers Count: 128
> Contains Count: 850
> Time used for WKB: 824 millis
> Time used for operand: 217 millis
> Total time: 1041 millis
> 
> 
> Results from NTS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
> MaxY=6554152 width=27573 , height=23208]
> Feature count: 10721
> Crosses Count: 0
> Intersects Count: 978
> Covers Count: 128
> Contains Count: 850
> Time used for WKB: 172 millis
> Time used for operand: 527 millis
> Total time: 699 millis
> ------------------------------------------------------------------------------------------------------------------------
> 
> 
> 
> ------------------------------------------------------------------------------------------------------------------------
> Operand:LINESTRING (538616.04842 6542972.503409, 539659.659719
> 6543126.67326, 540134.028491 6543049.588335, 540424.579364 6542883.559264,
> 540673.622969 6542658.234098, 54
> 0976.033062 6542770.896681, 541029.399549 6542978.433019, 541385.176128
> 6542782.7559, 541628.290123 6542338.035176)
> 
> 
> Results from GEOS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
> MaxY=6554152 width=27573 , height=23208]
> Feature count: 10721
> Crosses Count: 54
> Intersects Count: 54
> Covers Count: 0
> Contains Count: 0
> Time used for WKB: 850 millis
> Time used for operand: 110 millis
> Total time: 960 millis
> 
> Results from NTS tester, extent=[MinX=517365, MinY=6530944, MaxX=544938,
> MaxY=6554152 width=27573 , height=23208]
> Feature count: 10721
> Crosses Count: 54
> Intersects Count: 54
> Covers Count: 0
> Contains Count: 0
> Time used for WKB: 174 millis
> Time used for operand: 247 millis
> Total time: 421 millis
> ------------------------------------------------------------------------------------------------------------------------

> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel


-- 

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html
From chdemars at ucdavis.edu  Thu Aug 18 18:44:49 2011
From: chdemars at ucdavis.edu (Christopher DeMars)
Date: Sat Aug 20 05:12:58 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and buffer():
 "Assertion
 failed: (0), function query, file AbstractSTRtree.cpp, line 286"
In-Reply-To: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
Message-ID: <CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>

Since the ticket upload function is limited to 256Kb, I thought I
would try to send an example file via this list.

Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
valid functions. I can supply water2 and/or either file as wkt.

Thank you for any help you can offer,
--Christopher


---------- Forwarded message ----------
From: GEOS <geos-trac@osgeo.org>
Date: Thu, Aug 18, 2011 at 3:08 PM
Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
failed: (0), function query, file AbstractSTRtree.cpp, line 286"
To:


#468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
query, file AbstractSTRtree.cpp, line 286"
------------------------+---------------------------------------------------
?Reporter: ?chdemars ? ?| ? ? ? Owner: ?strk
? ? Type: ?defect ? ? ?| ? ? ?Status: ?new
?Priority: ?major ? ? ? | ? Milestone: ?3.3.1
Component: ?Core ? ? ? ?| ? ? Version: ?3.3.0
?Severity: ?Unassigned ?| ? ?Keywords:
------------------------+---------------------------------------------------
?GEOS is pretty far down in the software stack I'm using, but it looks like
?my program stopping error lies there.

?Software being used:
?geos-config --version 3.3.0
?I'm using GeoDjango and PostGIS on top of GEOS with development taking
?place on Mac OSX

?Geometry source:
?original source is:
?http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip

?After loading that (and the other DWR land use files) into my
?PostGIS/GeoDjango database I extracted all the water features using:
?water = DWRlanduse.objects.filter(class1__contains='NW',
?survey_area__contains='BUTTE COUNTY').collect()

?I have attached the wkb and wkt output of the above with water1 using
?.unionagg() and water2 using .collect() to produce a MultiPolygon and
?GeometryCollection respectively. Both produce failure.

?If I try to use .buffer() or .valid() functions on either water1 or water2
?I get the same failure:
?Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
?which says one of the 'childBoundables' is of an unsupported type.
?Functions like area or centroid work fine.

?I would like to know if the error is a problem with GEOS and/or a problem
?with the geometry. Regardless of the source of error, I would also like to
?know how to go about fixing it.

?Thank you for your time and efforts,
?--Christopher

--
Ticket URL: <http://trac.osgeo.org/geos/ticket/468>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java
Topology Suite (JTS).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: water1.wkb
Type: application/octet-stream
Size: 1628419 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20110818/f8a39397/water1-0001.obj
From mtnclimb at telus.net  Thu Aug 18 23:43:58 2011
From: mtnclimb at telus.net (Martin Davis)
Date: Sat Aug 20 10:29:35 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer():
	"Assertion failed: (0), function query, file AbstractSTRtree.cpp,
	line 286"
In-Reply-To: <CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
Message-ID: <4E4DDBFE.7070505@telus.net>

I have tested this in JTS 1.12, and can confirm that both isValid and 
buffer work correctly.  The buffer operation does take quite a while and 
requires a significant amount of memory.

So the geometry is fine.  There may be some issues with GEOS.

On 8/18/2011 3:44 PM, Christopher DeMars wrote:
> Since the ticket upload function is limited to 256Kb, I thought I
> would try to send an example file via this list.
>
> Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
> valid functions. I can supply water2 and/or either file as wkt.
>
> Thank you for any help you can offer,
> --Christopher
>
>
> ---------- Forwarded message ----------
> From: GEOS<geos-trac@osgeo.org>
> Date: Thu, Aug 18, 2011 at 3:08 PM
> Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
> failed: (0), function query, file AbstractSTRtree.cpp, line 286"
> To:
>
>
> #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
> query, file AbstractSTRtree.cpp, line 286"
> ------------------------+---------------------------------------------------
>   Reporter:  chdemars    |       Owner:  strk
>      Type:  defect      |      Status:  new
>   Priority:  major       |   Milestone:  3.3.1
> Component:  Core        |     Version:  3.3.0
>   Severity:  Unassigned  |    Keywords:
> ------------------------+---------------------------------------------------
>   GEOS is pretty far down in the software stack I'm using, but it looks like
>   my program stopping error lies there.
>
>   Software being used:
>   geos-config --version 3.3.0
>   I'm using GeoDjango and PostGIS on top of GEOS with development taking
>   place on Mac OSX
>
>   Geometry source:
>   original source is:
>   http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>
>   After loading that (and the other DWR land use files) into my
>   PostGIS/GeoDjango database I extracted all the water features using:
>   water = DWRlanduse.objects.filter(class1__contains='NW',
>   survey_area__contains='BUTTE COUNTY').collect()
>
>   I have attached the wkb and wkt output of the above with water1 using
>   .unionagg() and water2 using .collect() to produce a MultiPolygon and
>   GeometryCollection respectively. Both produce failure.
>
>   If I try to use .buffer() or .valid() functions on either water1 or water2
>   I get the same failure:
>   Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
>   which says one of the 'childBoundables' is of an unsupported type.
>   Functions like area or centroid work fine.
>
>   I would like to know if the error is a problem with GEOS and/or a problem
>   with the geometry. Regardless of the source of error, I would also like to
>   know how to go about fixing it.
>
>   Thank you for your time and efforts,
>   --Christopher
>
> --
> Ticket URL:<http://trac.osgeo.org/geos/ticket/468>
> GEOS<http://geos.refractions.net/>
> GEOS (Geometry Engine - Open Source) is a C++ port of the Java
> Topology Suite (JTS).
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110818/7da11722/attachment.html
From mtnclimb at telus.net  Thu Aug 18 23:53:44 2011
From: mtnclimb at telus.net (Martin Davis)
Date: Sat Aug 20 11:10:04 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer():
	"Assertion failed: (0), function query, file AbstractSTRtree.cpp,
	line 286"
In-Reply-To: <4E4DDBFE.7070505@telus.net>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net>
Message-ID: <4E4DDE48.5010607@telus.net>

Incidentally, this is one of those cases where buffering by unioning the 
buffers of the components far outperforms the straight buffer (for 
distance = 100, 10 s vs 70 s).

This is something you might be able to try, if your data model permits 
it.  Split the geometry into its components, and process them all 
separately.  This should give better performance, and may avoid the GEOS 
issues.

On 8/18/2011 8:43 PM, Martin Davis wrote:
> I have tested this in JTS 1.12, and can confirm that both isValid and 
> buffer work correctly.  The buffer operation does take quite a while 
> and requires a significant amount of memory.
>
> So the geometry is fine.  There may be some issues with GEOS.
>
> On 8/18/2011 3:44 PM, Christopher DeMars wrote:
>> Since the ticket upload function is limited to 256Kb, I thought I
>> would try to send an example file via this list.
>>
>> Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
>> valid functions. I can supply water2 and/or either file as wkt.
>>
>> Thank you for any help you can offer,
>> --Christopher
>>
>>
>> ---------- Forwarded message ----------
>> From: GEOS<geos-trac@osgeo.org>
>> Date: Thu, Aug 18, 2011 at 3:08 PM
>> Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
>> failed: (0), function query, file AbstractSTRtree.cpp, line 286"
>> To:
>>
>>
>> #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
>> query, file AbstractSTRtree.cpp, line 286"
>> ------------------------+---------------------------------------------------
>>   Reporter:  chdemars    |       Owner:  strk
>>      Type:  defect      |      Status:  new
>>   Priority:  major       |   Milestone:  3.3.1
>> Component:  Core        |     Version:  3.3.0
>>   Severity:  Unassigned  |    Keywords:
>> ------------------------+---------------------------------------------------
>>   GEOS is pretty far down in the software stack I'm using, but it looks like
>>   my program stopping error lies there.
>>
>>   Software being used:
>>   geos-config --version 3.3.0
>>   I'm using GeoDjango and PostGIS on top of GEOS with development taking
>>   place on Mac OSX
>>
>>   Geometry source:
>>   original source is:
>>   http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>>
>>   After loading that (and the other DWR land use files) into my
>>   PostGIS/GeoDjango database I extracted all the water features using:
>>   water = DWRlanduse.objects.filter(class1__contains='NW',
>>   survey_area__contains='BUTTE COUNTY').collect()
>>
>>   I have attached the wkb and wkt output of the above with water1 using
>>   .unionagg() and water2 using .collect() to produce a MultiPolygon and
>>   GeometryCollection respectively. Both produce failure.
>>
>>   If I try to use .buffer() or .valid() functions on either water1 or water2
>>   I get the same failure:
>>   Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
>>   which says one of the 'childBoundables' is of an unsupported type.
>>   Functions like area or centroid work fine.
>>
>>   I would like to know if the error is a problem with GEOS and/or a problem
>>   with the geometry. Regardless of the source of error, I would also like to
>>   know how to go about fixing it.
>>
>>   Thank you for your time and efforts,
>>   --Christopher
>>
>> --
>> Ticket URL:<http://trac.osgeo.org/geos/ticket/468>
>> GEOS<http://geos.refractions.net/>
>> GEOS (Geometry Engine - Open Source) is a C++ port of the Java
>> Topology Suite (JTS).
>>
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>
>> -----
>> No virus found in this message.
>> Checked by AVG -www.avg.com
>> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
> No virus found in this message.
> Checked by AVG - www.avg.com <http://www.avg.com>
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110818/ac1d6258/attachment.html
From chdemars at ucdavis.edu  Fri Aug 19 10:03:25 2011
From: chdemars at ucdavis.edu (Christopher DeMars)
Date: Fri Aug 19 10:19:39 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query,
	file AbstractSTRtree.cpp, line 286"
In-Reply-To: <4E4DDE48.5010607@telus.net>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
Message-ID: <CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>

Thank you Mr. Davis for your attention,

I tried your suggestion of buffering elements individually then
merging the buffers. I buffered several elements without issue, then
got the same program stopping error message as before. On the plus
side, I did isolate a polygon that was crashing things. Attached is
the wkt and wkb of that polygon.

--Christopher


On Thu, Aug 18, 2011 at 8:53 PM, Martin Davis <mtnclimb@telus.net> wrote:
> Incidentally, this is one of those cases where buffering by unioning the
> buffers of the components far outperforms the straight buffer (for distance
> = 100, 10 s vs 70 s).
>
> This is something you might be able to try, if your data model permits it.
> Split the geometry into its components, and process them all separately.
> This should give better performance, and may avoid the GEOS issues.
>
> On 8/18/2011 8:43 PM, Martin Davis wrote:
>
> I have tested this in JTS 1.12, and can confirm that both isValid and buffer
> work correctly.? The buffer operation does take quite a while and requires a
> significant amount of memory.
>
> So the geometry is fine.? There may be some issues with GEOS.
>
> On 8/18/2011 3:44 PM, Christopher DeMars wrote:
>
> Since the ticket upload function is limited to 256Kb, I thought I
> would try to send an example file via this list.
>
> Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
> valid functions. I can supply water2 and/or either file as wkt.
>
> Thank you for any help you can offer,
> --Christopher
>
>
> ---------- Forwarded message ----------
> From: GEOS <geos-trac@osgeo.org>
> Date: Thu, Aug 18, 2011 at 3:08 PM
> Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
> failed: (0), function query, file AbstractSTRtree.cpp, line 286"
> To:
>
>
> #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
> query, file AbstractSTRtree.cpp, line 286"
> ------------------------+---------------------------------------------------
> ?Reporter: ?chdemars ? ?| ? ? ? Owner: ?strk
> ? ? Type: ?defect ? ? ?| ? ? ?Status: ?new
> ?Priority: ?major ? ? ? | ? Milestone: ?3.3.1
> Component: ?Core ? ? ? ?| ? ? Version: ?3.3.0
> ?Severity: ?Unassigned ?| ? ?Keywords:
> ------------------------+---------------------------------------------------
> ?GEOS is pretty far down in the software stack I'm using, but it looks like
> ?my program stopping error lies there.
>
> ?Software being used:
> ?geos-config --version 3.3.0
> ?I'm using GeoDjango and PostGIS on top of GEOS with development taking
> ?place on Mac OSX
>
> ?Geometry source:
> ?original source is:
> ?http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>
> ?After loading that (and the other DWR land use files) into my
> ?PostGIS/GeoDjango database I extracted all the water features using:
> ?water = DWRlanduse.objects.filter(class1__contains='NW',
> ?survey_area__contains='BUTTE COUNTY').collect()
>
> ?I have attached the wkb and wkt output of the above with water1 using
> ?.unionagg() and water2 using .collect() to produce a MultiPolygon and
> ?GeometryCollection respectively. Both produce failure.
>
> ?If I try to use .buffer() or .valid() functions on either water1 or water2
> ?I get the same failure:
> ?Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
> ?which says one of the 'childBoundables' is of an unsupported type.
> ?Functions like area or centroid work fine.
>
> ?I would like to know if the error is a problem with GEOS and/or a problem
> ?with the geometry. Regardless of the source of error, I would also like to
> ?know how to go about fixing it.
>
> ?Thank you for your time and efforts,
> ?--Christopher
>
> --
> Ticket URL: <http://trac.osgeo.org/geos/ticket/468>
> GEOS <http://geos.refractions.net/>
> GEOS (Geometry Engine - Open Source) is a C++ port of the Java
> Topology Suite (JTS).
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fubargeom.wkb
Type: application/octet-stream
Size: 566 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20110819/db6b408e/fubargeom.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: fubargeom.wkt
Type: application/octet-stream
Size: 1717 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20110819/db6b408e/fubargeom-0001.obj
From mtnclimb at telus.net  Fri Aug 19 11:24:16 2011
From: mtnclimb at telus.net (Martin Davis)
Date: Fri Aug 19 12:27:43 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer():
	"Assertion failed: (0), function query, file AbstractSTRtree.cpp,
	line 286"
In-Reply-To: <CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
Message-ID: <4E4E8020.1000503@telus.net>

Good to have the problem narrowed down.

There's nothing obviously wrong with the polygon, at least from the JTS 
perspective.  Perhaps Sandro can shed some light on the issue...

On 8/19/2011 7:03 AM, Christopher DeMars wrote:
> Thank you Mr. Davis for your attention,
>
> I tried your suggestion of buffering elements individually then
> merging the buffers. I buffered several elements without issue, then
> got the same program stopping error message as before. On the plus
> side, I did isolate a polygon that was crashing things. Attached is
> the wkt and wkb of that polygon.
>
> --Christopher
>
>
> On Thu, Aug 18, 2011 at 8:53 PM, Martin Davis<mtnclimb@telus.net>  wrote:
>> Incidentally, this is one of those cases where buffering by unioning the
>> buffers of the components far outperforms the straight buffer (for distance
>> = 100, 10 s vs 70 s).
>>
>> This is something you might be able to try, if your data model permits it.
>> Split the geometry into its components, and process them all separately.
>> This should give better performance, and may avoid the GEOS issues.
>>
>> On 8/18/2011 8:43 PM, Martin Davis wrote:
>>
>> I have tested this in JTS 1.12, and can confirm that both isValid and buffer
>> work correctly.  The buffer operation does take quite a while and requires a
>> significant amount of memory.
>>
>> So the geometry is fine.  There may be some issues with GEOS.
>>
>> On 8/18/2011 3:44 PM, Christopher DeMars wrote:
>>
>> Since the ticket upload function is limited to 256Kb, I thought I
>> would try to send an example file via this list.
>>
>> Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
>> valid functions. I can supply water2 and/or either file as wkt.
>>
>> Thank you for any help you can offer,
>> --Christopher
>>
>>
>> ---------- Forwarded message ----------
>> From: GEOS<geos-trac@osgeo.org>
>> Date: Thu, Aug 18, 2011 at 3:08 PM
>> Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
>> failed: (0), function query, file AbstractSTRtree.cpp, line 286"
>> To:
>>
>>
>> #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
>> query, file AbstractSTRtree.cpp, line 286"
>> ------------------------+---------------------------------------------------
>>   Reporter:  chdemars    |       Owner:  strk
>>      Type:  defect      |      Status:  new
>>   Priority:  major       |   Milestone:  3.3.1
>> Component:  Core        |     Version:  3.3.0
>>   Severity:  Unassigned  |    Keywords:
>> ------------------------+---------------------------------------------------
>>   GEOS is pretty far down in the software stack I'm using, but it looks like
>>   my program stopping error lies there.
>>
>>   Software being used:
>>   geos-config --version 3.3.0
>>   I'm using GeoDjango and PostGIS on top of GEOS with development taking
>>   place on Mac OSX
>>
>>   Geometry source:
>>   original source is:
>>   http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>>
>>   After loading that (and the other DWR land use files) into my
>>   PostGIS/GeoDjango database I extracted all the water features using:
>>   water = DWRlanduse.objects.filter(class1__contains='NW',
>>   survey_area__contains='BUTTE COUNTY').collect()
>>
>>   I have attached the wkb and wkt output of the above with water1 using
>>   .unionagg() and water2 using .collect() to produce a MultiPolygon and
>>   GeometryCollection respectively. Both produce failure.
>>
>>   If I try to use .buffer() or .valid() functions on either water1 or water2
>>   I get the same failure:
>>   Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
>>   which says one of the 'childBoundables' is of an unsupported type.
>>   Functions like area or centroid work fine.
>>
>>   I would like to know if the error is a problem with GEOS and/or a problem
>>   with the geometry. Regardless of the source of error, I would also like to
>>   know how to go about fixing it.
>>
>>   Thank you for your time and efforts,
>>   --Christopher
>>
>> --
>> Ticket URL:<http://trac.osgeo.org/geos/ticket/468>
>> GEOS<http://geos.refractions.net/>
>> GEOS (Geometry Engine - Open Source) is a C++ port of the Java
>> Topology Suite (JTS).
>>
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> -----
>> No virus found in this message.
>> Checked by AVG - www.avg.com
>> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>>
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>> No virus found in this message.
>> Checked by AVG - www.avg.com
>> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>
>>
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>>
>>
>> -----
>> No virus found in this message.
>> Checked by AVG - www.avg.com
>> Version: 10.0.1392 / Virus Database: 1520/3844 - Release Date: 08/19/11
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110819/9c912d07/attachment.html
From chdemars at ucdavis.edu  Fri Aug 19 12:45:04 2011
From: chdemars at ucdavis.edu (Christopher DeMars)
Date: Fri Aug 19 13:09:56 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query,
	file AbstractSTRtree.cpp, line 286"
In-Reply-To: <4E4E8020.1000503@telus.net>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
	<4E4E8020.1000503@telus.net>
Message-ID: <CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>

I initially wasn't sure if the failure was caused by a particular
geometry formation or due to the size of the dataset. I have since
tried other county layers from the same source (California Department
of Water Resources) and got the same error after processing a small
number of polygons, so whatever the polygon encoding issue, it is
fairly common in this dataset. I can extract other example polygons if
anyone is interested.

--Christopher

On Fri, Aug 19, 2011 at 8:24 AM, Martin Davis <mtnclimb@telus.net> wrote:
> Good to have the problem narrowed down.
>
> There's nothing obviously wrong with the polygon, at least from the JTS
> perspective.? Perhaps Sandro can shed some light on the issue...
>
> On 8/19/2011 7:03 AM, Christopher DeMars wrote:
>
> Thank you Mr. Davis for your attention,
>
> I tried your suggestion of buffering elements individually then
> merging the buffers. I buffered several elements without issue, then
> got the same program stopping error message as before. On the plus
> side, I did isolate a polygon that was crashing things. Attached is
> the wkt and wkb of that polygon.
>
> --Christopher
>
>
> On Thu, Aug 18, 2011 at 8:53 PM, Martin Davis <mtnclimb@telus.net> wrote:
>
> Incidentally, this is one of those cases where buffering by unioning the
> buffers of the components far outperforms the straight buffer (for distance
> = 100, 10 s vs 70 s).
>
> This is something you might be able to try, if your data model permits it.
> Split the geometry into its components, and process them all separately.
> This should give better performance, and may avoid the GEOS issues.
>
> On 8/18/2011 8:43 PM, Martin Davis wrote:
>
> I have tested this in JTS 1.12, and can confirm that both isValid and buffer
> work correctly.? The buffer operation does take quite a while and requires a
> significant amount of memory.
>
> So the geometry is fine.? There may be some issues with GEOS.
>
> On 8/18/2011 3:44 PM, Christopher DeMars wrote:
>
> Since the ticket upload function is limited to 256Kb, I thought I
> would try to send an example file via this list.
>
> Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
> valid functions. I can supply water2 and/or either file as wkt.
>
> Thank you for any help you can offer,
> --Christopher
>
>
> ---------- Forwarded message ----------
> From: GEOS <geos-trac@osgeo.org>
> Date: Thu, Aug 18, 2011 at 3:08 PM
> Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
> failed: (0), function query, file AbstractSTRtree.cpp, line 286"
> To:
>
>
> #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
> query, file AbstractSTRtree.cpp, line 286"
> ------------------------+---------------------------------------------------
> ?Reporter: ?chdemars ? ?| ? ? ? Owner: ?strk
> ? ? Type: ?defect ? ? ?| ? ? ?Status: ?new
> ?Priority: ?major ? ? ? | ? Milestone: ?3.3.1
> Component: ?Core ? ? ? ?| ? ? Version: ?3.3.0
> ?Severity: ?Unassigned ?| ? ?Keywords:
> ------------------------+---------------------------------------------------
> ?GEOS is pretty far down in the software stack I'm using, but it looks like
> ?my program stopping error lies there.
>
> ?Software being used:
> ?geos-config --version 3.3.0
> ?I'm using GeoDjango and PostGIS on top of GEOS with development taking
> ?place on Mac OSX
>
> ?Geometry source:
> ?original source is:
> ?http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>
> ?After loading that (and the other DWR land use files) into my
> ?PostGIS/GeoDjango database I extracted all the water features using:
> ?water = DWRlanduse.objects.filter(class1__contains='NW',
> ?survey_area__contains='BUTTE COUNTY').collect()
>
> ?I have attached the wkb and wkt output of the above with water1 using
> ?.unionagg() and water2 using .collect() to produce a MultiPolygon and
> ?GeometryCollection respectively. Both produce failure.
>
> ?If I try to use .buffer() or .valid() functions on either water1 or water2
> ?I get the same failure:
> ?Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
> ?which says one of the 'childBoundables' is of an unsupported type.
> ?Functions like area or centroid work fine.
>
> ?I would like to know if the error is a problem with GEOS and/or a problem
> ?with the geometry. Regardless of the source of error, I would also like to
> ?know how to go about fixing it.
>
> ?Thank you for your time and efforts,
> ?--Christopher
>
> --
> Ticket URL: <http://trac.osgeo.org/geos/ticket/468>
> GEOS <http://geos.refractions.net/>
> GEOS (Geometry Engine - Open Source) is a C++ port of the Java
> Topology Suite (JTS).
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
>
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1392 / Virus Database: 1520/3844 - Release Date: 08/19/11
>
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From strk at keybit.net  Sat Aug 20 07:41:30 2011
From: strk at keybit.net (Sandro Santilli)
Date: Sat Aug 20 09:09:56 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query, file
	AbstractSTRtree.cpp, line 286"
In-Reply-To: <CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
	<4E4E8020.1000503@telus.net>
	<CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>
Message-ID: <20110820113744.GA14245@gnash>

Please upload the smallest geometry with which you can
reproduce the issue to the bug item you opened already.

The error reveals a bogus use of the library.
Since all code is internal to the library, this should never happen.
I can think of two possibilities:
 1) memory corruption (valgrind could help you figure that out)
 2) bogus compilation (any warnings at build time?)

I'm assuming it'll work for me, but didn't really test.

BTW: make sure to include version in your ticket, and if you didn't
make sure to test with latest GEOS release, and possibly with SVN too
(I know I'm asking a lot, but that's what I'd do if I had time to deal
with this).

Oh, last thing: JTS does not have the consistency check (that a
childBoundable is either an AbstractNode or an ItemBoundable) but
just lets go in that case. It could explain why it doesn't error
out (but doesn't explain what ended up in the childBoundables...).

--strk;

On Fri, Aug 19, 2011 at 09:45:04AM -0700, Christopher DeMars wrote:
> I initially wasn't sure if the failure was caused by a particular
> geometry formation or due to the size of the dataset. I have since
> tried other county layers from the same source (California Department
> of Water Resources) and got the same error after processing a small
> number of polygons, so whatever the polygon encoding issue, it is
> fairly common in this dataset. I can extract other example polygons if
> anyone is interested.
> 
> --Christopher
> 
> On Fri, Aug 19, 2011 at 8:24 AM, Martin Davis <mtnclimb@telus.net> wrote:
> > Good to have the problem narrowed down.
> >
> > There's nothing obviously wrong with the polygon, at least from the JTS
> > perspective.? Perhaps Sandro can shed some light on the issue...
> >
> > On 8/19/2011 7:03 AM, Christopher DeMars wrote:
> >
> > Thank you Mr. Davis for your attention,
> >
> > I tried your suggestion of buffering elements individually then
> > merging the buffers. I buffered several elements without issue, then
> > got the same program stopping error message as before. On the plus
> > side, I did isolate a polygon that was crashing things. Attached is
> > the wkt and wkb of that polygon.
> >
> > --Christopher
> >
> >
> > On Thu, Aug 18, 2011 at 8:53 PM, Martin Davis <mtnclimb@telus.net> wrote:
> >
> > Incidentally, this is one of those cases where buffering by unioning the
> > buffers of the components far outperforms the straight buffer (for distance
> > = 100, 10 s vs 70 s).
> >
> > This is something you might be able to try, if your data model permits it.
> > Split the geometry into its components, and process them all separately.
> > This should give better performance, and may avoid the GEOS issues.
> >
> > On 8/18/2011 8:43 PM, Martin Davis wrote:
> >
> > I have tested this in JTS 1.12, and can confirm that both isValid and buffer
> > work correctly.? The buffer operation does take quite a while and requires a
> > significant amount of memory.
> >
> > So the geometry is fine.? There may be some issues with GEOS.
> >
> > On 8/18/2011 3:44 PM, Christopher DeMars wrote:
> >
> > Since the ticket upload function is limited to 256Kb, I thought I
> > would try to send an example file via this list.
> >
> > Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
> > valid functions. I can supply water2 and/or either file as wkt.
> >
> > Thank you for any help you can offer,
> > --Christopher
> >
> >
> > ---------- Forwarded message ----------
> > From: GEOS <geos-trac@osgeo.org>
> > Date: Thu, Aug 18, 2011 at 3:08 PM
> > Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
> > failed: (0), function query, file AbstractSTRtree.cpp, line 286"
> > To:
> >
> >
> > #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
> > query, file AbstractSTRtree.cpp, line 286"
> > ------------------------+---------------------------------------------------
> > ?Reporter: ?chdemars ? ?| ? ? ? Owner: ?strk
> > ? ? Type: ?defect ? ? ?| ? ? ?Status: ?new
> > ?Priority: ?major ? ? ? | ? Milestone: ?3.3.1
> > Component: ?Core ? ? ? ?| ? ? Version: ?3.3.0
> > ?Severity: ?Unassigned ?| ? ?Keywords:
> > ------------------------+---------------------------------------------------
> > ?GEOS is pretty far down in the software stack I'm using, but it looks like
> > ?my program stopping error lies there.
> >
> > ?Software being used:
> > ?geos-config --version 3.3.0
> > ?I'm using GeoDjango and PostGIS on top of GEOS with development taking
> > ?place on Mac OSX
> >
> > ?Geometry source:
> > ?original source is:
> > ?http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
> >
> > ?After loading that (and the other DWR land use files) into my
> > ?PostGIS/GeoDjango database I extracted all the water features using:
> > ?water = DWRlanduse.objects.filter(class1__contains='NW',
> > ?survey_area__contains='BUTTE COUNTY').collect()
> >
> > ?I have attached the wkb and wkt output of the above with water1 using
> > ?.unionagg() and water2 using .collect() to produce a MultiPolygon and
> > ?GeometryCollection respectively. Both produce failure.
> >
> > ?If I try to use .buffer() or .valid() functions on either water1 or water2
> > ?I get the same failure:
> > ?Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
> > ?which says one of the 'childBoundables' is of an unsupported type.
> > ?Functions like area or centroid work fine.
> >
> > ?I would like to know if the error is a problem with GEOS and/or a problem
> > ?with the geometry. Regardless of the source of error, I would also like to
> > ?know how to go about fixing it.
> >
> > ?Thank you for your time and efforts,
> > ?--Christopher
> >
> > --
> > Ticket URL: <http://trac.osgeo.org/geos/ticket/468>
> > GEOS <http://geos.refractions.net/>
> > GEOS (Geometry Engine - Open Source) is a C++ port of the Java
> > Topology Suite (JTS).
> >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> > -----
> > No virus found in this message.
> > Checked by AVG - www.avg.com
> > Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
> >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> > No virus found in this message.
> > Checked by AVG - www.avg.com
> > Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> >
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> > -----
> > No virus found in this message.
> > Checked by AVG - www.avg.com
> > Version: 10.0.1392 / Virus Database: 1520/3844 - Release Date: 08/19/11
> >
> > _______________________________________________
> > geos-devel mailing list
> > geos-devel@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/geos-devel
> >
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel

-- 

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html
From chdemars at ucdavis.edu  Sat Aug 20 10:11:09 2011
From: chdemars at ucdavis.edu (Christopher DeMars)
Date: Sat Aug 20 11:47:34 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query,
	file AbstractSTRtree.cpp, line 286"
In-Reply-To: <20110820113744.GA14245@gnash>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
	<4E4E8020.1000503@telus.net>
	<CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>
	<20110820113744.GA14245@gnash>
Message-ID: <CAGu-AB2z3JyWVVNrknZ3cykvJUkSBH5FYMuRgep60u_ZYM2qRA@mail.gmail.com>

I have uploaded to the ticket (and to this list) a single multipolygon
that consistently causes a crash.

Other multipolygons from the same dataset also cause the same issue.
On the other hand, there are other ones that buffer fine, so GEOS is
working.

I will try installing the SVN branch of GEOS soon and running it
again. I'll let you know if there is any compile errors or if things
work after the upgrade or not. I've never used valgrind before, so it
might take a bit of time to get up to speed using it, but I'll see
what I can do.

Thanks for any attention you can give the issue,
--Christopher

On Sat, Aug 20, 2011 at 4:41 AM, Sandro Santilli <strk@keybit.net> wrote:
> Please upload the smallest geometry with which you can
> reproduce the issue to the bug item you opened already.
>
> The error reveals a bogus use of the library.
> Since all code is internal to the library, this should never happen.
> I can think of two possibilities:
> ?1) memory corruption (valgrind could help you figure that out)
> ?2) bogus compilation (any warnings at build time?)
>
> I'm assuming it'll work for me, but didn't really test.
>
> BTW: make sure to include version in your ticket, and if you didn't
> make sure to test with latest GEOS release, and possibly with SVN too
> (I know I'm asking a lot, but that's what I'd do if I had time to deal
> with this).
>
> Oh, last thing: JTS does not have the consistency check (that a
> childBoundable is either an AbstractNode or an ItemBoundable) but
> just lets go in that case. It could explain why it doesn't error
> out (but doesn't explain what ended up in the childBoundables...).
>
> --strk;
>
> On Fri, Aug 19, 2011 at 09:45:04AM -0700, Christopher DeMars wrote:
>> I initially wasn't sure if the failure was caused by a particular
>> geometry formation or due to the size of the dataset. I have since
>> tried other county layers from the same source (California Department
>> of Water Resources) and got the same error after processing a small
>> number of polygons, so whatever the polygon encoding issue, it is
>> fairly common in this dataset. I can extract other example polygons if
>> anyone is interested.
>>
>> --Christopher
>>
>> On Fri, Aug 19, 2011 at 8:24 AM, Martin Davis <mtnclimb@telus.net> wrote:
>> > Good to have the problem narrowed down.
>> >
>> > There's nothing obviously wrong with the polygon, at least from the JTS
>> > perspective.? Perhaps Sandro can shed some light on the issue...
>> >
>> > On 8/19/2011 7:03 AM, Christopher DeMars wrote:
>> >
>> > Thank you Mr. Davis for your attention,
>> >
>> > I tried your suggestion of buffering elements individually then
>> > merging the buffers. I buffered several elements without issue, then
>> > got the same program stopping error message as before. On the plus
>> > side, I did isolate a polygon that was crashing things. Attached is
>> > the wkt and wkb of that polygon.
>> >
>> > --Christopher
>> >
>> >
>> > On Thu, Aug 18, 2011 at 8:53 PM, Martin Davis <mtnclimb@telus.net> wrote:
>> >
>> > Incidentally, this is one of those cases where buffering by unioning the
>> > buffers of the components far outperforms the straight buffer (for distance
>> > = 100, 10 s vs 70 s).
>> >
>> > This is something you might be able to try, if your data model permits it.
>> > Split the geometry into its components, and process them all separately.
>> > This should give better performance, and may avoid the GEOS issues.
>> >
>> > On 8/18/2011 8:43 PM, Martin Davis wrote:
>> >
>> > I have tested this in JTS 1.12, and can confirm that both isValid and buffer
>> > work correctly.? The buffer operation does take quite a while and requires a
>> > significant amount of memory.
>> >
>> > So the geometry is fine.? There may be some issues with GEOS.
>> >
>> > On 8/18/2011 3:44 PM, Christopher DeMars wrote:
>> >
>> > Since the ticket upload function is limited to 256Kb, I thought I
>> > would try to send an example file via this list.
>> >
>> > Attached is water1.wkb, a multipolygon that fubars GEOS buffer or
>> > valid functions. I can supply water2 and/or either file as wkt.
>> >
>> > Thank you for any help you can offer,
>> > --Christopher
>> >
>> >
>> > ---------- Forwarded message ----------
>> > From: GEOS <geos-trac@osgeo.org>
>> > Date: Thu, Aug 18, 2011 at 3:08 PM
>> > Subject: [GEOS] #468: Geometry breaks valid() and buffer(): "Assertion
>> > failed: (0), function query, file AbstractSTRtree.cpp, line 286"
>> > To:
>> >
>> >
>> > #468: Geometry breaks valid() and buffer(): "Assertion failed: (0), function
>> > query, file AbstractSTRtree.cpp, line 286"
>> > ------------------------+---------------------------------------------------
>> > ?Reporter: ?chdemars ? ?| ? ? ? Owner: ?strk
>> > ? ? Type: ?defect ? ? ?| ? ? ?Status: ?new
>> > ?Priority: ?major ? ? ? | ? Milestone: ?3.3.1
>> > Component: ?Core ? ? ? ?| ? ? Version: ?3.3.0
>> > ?Severity: ?Unassigned ?| ? ?Keywords:
>> > ------------------------+---------------------------------------------------
>> > ?GEOS is pretty far down in the software stack I'm using, but it looks like
>> > ?my program stopping error lies there.
>> >
>> > ?Software being used:
>> > ?geos-config --version 3.3.0
>> > ?I'm using GeoDjango and PostGIS on top of GEOS with development taking
>> > ?place on Mac OSX
>> >
>> > ?Geometry source:
>> > ?original source is:
>> > ?http://www.water.ca.gov/landwateruse/docs/landusedata/shapes/04bu.zip
>> >
>> > ?After loading that (and the other DWR land use files) into my
>> > ?PostGIS/GeoDjango database I extracted all the water features using:
>> > ?water = DWRlanduse.objects.filter(class1__contains='NW',
>> > ?survey_area__contains='BUTTE COUNTY').collect()
>> >
>> > ?I have attached the wkb and wkt output of the above with water1 using
>> > ?.unionagg() and water2 using .collect() to produce a MultiPolygon and
>> > ?GeometryCollection respectively. Both produce failure.
>> >
>> > ?If I try to use .buffer() or .valid() functions on either water1 or water2
>> > ?I get the same failure:
>> > ?Assertion failed: (0), function query, file AbstractSTRtree.cpp, line 286
>> > ?which says one of the 'childBoundables' is of an unsupported type.
>> > ?Functions like area or centroid work fine.
>> >
>> > ?I would like to know if the error is a problem with GEOS and/or a problem
>> > ?with the geometry. Regardless of the source of error, I would also like to
>> > ?know how to go about fixing it.
>> >
>> > ?Thank you for your time and efforts,
>> > ?--Christopher
>> >
>> > --
>> > Ticket URL: <http://trac.osgeo.org/geos/ticket/468>
>> > GEOS <http://geos.refractions.net/>
>> > GEOS (Geometry Engine - Open Source) is a C++ port of the Java
>> > Topology Suite (JTS).
>> >
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> > -----
>> > No virus found in this message.
>> > Checked by AVG - www.avg.com
>> > Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>> >
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> > No virus found in this message.
>> > Checked by AVG - www.avg.com
>> > Version: 10.0.1392 / Virus Database: 1520/3842 - Release Date: 08/18/11
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> >
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> > -----
>> > No virus found in this message.
>> > Checked by AVG - www.avg.com
>> > Version: 10.0.1392 / Virus Database: 1520/3844 - Release Date: 08/19/11
>> >
>> > _______________________________________________
>> > geos-devel mailing list
>> > geos-devel@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/geos-devel
>> >
>> _______________________________________________
>> geos-devel mailing list
>> geos-devel@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
> --
>
> ?() ? Free GIS & Flash consultant/developer
> ?/\ ? http://strk.keybit.net/services.html
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>
From geos-trac at osgeo.org  Sat Aug 20 16:54:15 2011
From: geos-trac at osgeo.org (GEOS)
Date: Sat Aug 20 18:52:31 2011
Subject: [geos-devel] Re: [GEOS] #464: Clone Does Not Honor SRID
In-Reply-To: <044.927d11aa2442e11356d5de68ac02aa7c@osgeo.org>
References: <044.927d11aa2442e11356d5de68ac02aa7c@osgeo.org>
Message-ID: <053.5cd7bfb4517f4f564c9a470eebfc7d96@osgeo.org>

#464: Clone Does Not Honor SRID
------------------------+---------------------------------------------------
 Reporter:  cfis        |        Owner:  geos-devel@?              
     Type:  defect      |       Status:  closed                    
 Priority:  major       |    Milestone:  3.3.1                     
Component:  Default     |      Version:  3.3.0                     
 Severity:  Unassigned  |   Resolution:  fixed                     
 Keywords:              |  
------------------------+---------------------------------------------------
Changes (by strk):

  * status:  new => closed
  * resolution:  => fixed


Comment:

 Fixed in r3464

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/464#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Sat Aug 20 17:05:51 2011
From: geos-trac at osgeo.org (GEOS)
Date: Sat Aug 20 19:04:46 2011
Subject: [geos-devel] Re: [GEOS] #464: Clone Does Not Honor SRID
In-Reply-To: <044.927d11aa2442e11356d5de68ac02aa7c@osgeo.org>
References: <044.927d11aa2442e11356d5de68ac02aa7c@osgeo.org>
Message-ID: <053.097ac446697a0b2b16417577c8b07c88@osgeo.org>

#464: Clone Does Not Honor SRID
------------------------+---------------------------------------------------
 Reporter:  cfis        |        Owner:  geos-devel@?              
     Type:  defect      |       Status:  closed                    
 Priority:  major       |    Milestone:  3.3.1                     
Component:  Default     |      Version:  3.3.0                     
 Severity:  Unassigned  |   Resolution:  fixed                     
 Keywords:              |  
------------------------+---------------------------------------------------

Comment(by strk):

 for the record: r3461 is the fix in trunk

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/464#comment:2>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 13:02:18 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 17:27:18 2011
Subject: [geos-devel] [GEOS] #469: testrunner fail
Message-ID: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 Hi,
 testing the last svn version of geos.
 When try the "make check"
 I see this error:

 I work on a RedHat ES6 - 64 bit.

 {{{
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 Making check in xmltester
 make[2]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make  check-TESTS
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 Runner: testrunner created
 lt-XMLTester: GeometryComponentFilter.cpp:35: virtual void
 geos::geom::GeometryComponentFilter::filter_ro(const
 geos::geom::Geometry*): Assertion `0' failed.
 ./testrunner: line 2: 21747 Aborted                 (core dumped)
 ./XMLTester -v --test-valid-output ./tests/testLeaksBig.xml
 ./tests/split.xml ./tests/hexwkb.xml ./tests/test.xml
 ./tests/linemerge.xml ./tests/TestIsValid.xml ./tests/robustness.xml
 ./tests/buffer.xml ./tests/singlesidedbuffer.xml ./tests/ticket/bug176.xml
 ./tests/ticket/bug188.xml ./tests/ticket/bug244.xml
 ./tests/ticket/bug275.xml ./tests/ticket/bug350.xml
 ./tests/ticket/bug356.xml ./tests/ticket/bug358.xml
 ./tests/ticket/bug360.xml ./tests/ticket/bug366.xml
 ./tests/ticket/bug392.xml ./tests/ticket/bug398.xml
 ./tests/ticket/bug434.xml ./tests/general/TestBoundary.xml
 ./tests/general/TestBuffer.xml ./tests/general/TestBufferMitredJoin.xml
 ./tests/general/TestCentroid.xml ./tests/general/TestConvexHull.xml
 ./tests/general/TestConvexHull-big.xml ./tests/general/TestDistance.xml
 ./tests/general/TestFunctionAAPrec.xml ./tests/general/TestFunctionAA.xml
 ./tests/general/TestFunctionLAPrec.xml ./tests/general/TestFunctionLA.xml
 ./tests/general/TestFunctionLLPrec.xml ./tests/general/TestFunctionLL.xml
 ./tests/general/TestFunctionPA.xml ./tests/general/TestFunctionPLPrec.xml
 ./tests/general/TestFunctionPL.xml ./tests/general/TestFunctionPP.xml
 ./tests/general/TestInteriorPoint.xml
 ./tests/general/TestRectanglePredicate.xml
 ./tests/general/TestRelateAA.xml ./tests/general/TestRelateLA.xml
 ./tests/general/TestRelateLL.xml ./tests/general/TestRelatePL.xml
 ./tests/general/TestRelateAC.xml ./tests/general/TestRelateLC.xml
 ./tests/general/TestRelatePA.xml ./tests/general/TestRelatePP.xml
 ./tests/general/TestSimple.xml ./tests/general/TestUnaryUnion.xml
 ./tests/general/TestValid.xml ./tests/general/TestValid2.xml
 ./tests/general/TestValid2-big.xml ./tests/general/TestWithinDistance.xml
 ./tests/stmlf/stmlf-cases-20061020.xml ./tests/stmlf/stmlf-cases-20061020
 -invalid-output.xml ./tests/stmlf/stmlf-cases-20070119.xml
 ./tests/robust/TestRobustOverlayFixed.xml
 ./tests/robust/TestRobustRelate.xml ./tests/fme.xml
 ./tests/TestBufferExternal.xml ./tests/TestBufferExternal2.xml
 ./tests/heisenbugs.xml ./tests/badguy3.xml ./tests/hole_from_shell.xml
 ./tests/hole_red.xml ./tests/safe/16595.xml ./tests/safe/16596.xml
 FAIL: testrunner
 ==================
 1 of 1 test failed
 ==================
 make[3]: *** [check-TESTS] Error 1
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make[2]: *** [check-am] Error 2
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make[1]: *** [check-recursive] Error 1
 make[1]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests'
 make: *** [check-recursive] Error 1
 [postgres@artu geos-svn]$

 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 13:44:56 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 18:12:13 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.533116094484974034de2454ee8b73a9@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by strk):

 Can you obtain a backtrace ?
 If you edit 'testrunner' (it's a shell script) you can add a 'gdb --args'
 prefix to the ./XMLTester call, the enter 'bt'<enter> when you get the
 assertion

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 14:14:46 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 18:43:51 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.dfc7900e00e4f7c5020f0203fa4fc301@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 I'm not sure to execute well your prescriptions.

 I try:

 gdb --args ./XMLTester -v --test-valid-output ./tests/testLeaksBig.xml
 .....

 after execution it enter in gdb .
 I type
 bt,
 but it report:
 'no stack'

 To give more information,
 I report also the last part of messages from console..

 ......
 Making check in tests
 make[1]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests'
 Making check in bigtest
 make[2]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make  bug234 TestSweepLineSpeed
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make[3]: `bug234' is up to date.
 make[3]: `TestSweepLineSpeed' is up to date.
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 Making check in xmltester
 make[2]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make  check-TESTS
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make[3]: Warning: File `testrunner' has modification time 21 s in the
 future
 GNU gdb (GDB) Red Hat Enterprise Linux (7.2-48.el6)
 Copyright (C) 2010 Free Software Foundation, Inc.
 License GPLv3+: GNU GPL version 3 or later
 <http://gnu.org/licenses/gpl.html>
 This is free software: you are free to change and redistribute it.
 There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
 and "show warranty" for details.
 This GDB was configured as "x86_64-redhat-linux-gnu".
 For bug reporting instructions, please see:
 <http://www.gnu.org/software/gdb/bugs/>...
 "/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester/XMLTester": not in executable format: File format not
 recognized
 (gdb) bt
 No stack.
 (gdb)

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:2>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 14:21:38 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 18:51:12 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.dede3055557279e7d50bca550c340582@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 Hi,
 I have obtain some result from gdb.

 after an execution it report this
 I'm not sure if it is really useful :)

 {{{
 make  check-TESTS
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/unit'
 ===============================
   GEOS Test Suite Application
 ===============================

 capi::GEOSBuffer: ....................
 capi::GEOSContains: ...
 capi::GEOSCoordSeq: ......lt-geos_unit: GeometryComponentFilter.cpp:35:
 virtual void geos::geom::GeometryComponentFilter::filter_ro(const
 geos::geom::Geometry*): Assertion `0' failed.
 /bin/sh: line 5: 23596 Aborted                 (core dumped) ${dir}$tst
 FAIL: geos_unit
 ==================
 1 of 1 test failed
 ==================
 make[3]: *** [check-TESTS] Error 1
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/unit'
 make[2]: *** [check-am] Error 2
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/unit'
 make[1]: *** [check-recursive] Error 1
 make[1]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests'
 make: *** [check-recursive] Error 1
 [postgres@artu geos-svn]$


 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:3>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 14:56:01 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 19:27:29 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.458318ce043e5b492df1db5ac0e906cf@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by strk):

 Oops, XMLTester is a libtool script, you'll need:

 libtool --mode=execute gdb --args ./XMLTester ....

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:4>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From chdemars at ucdavis.edu  Mon Aug 22 14:58:44 2011
From: chdemars at ucdavis.edu (Christopher DeMars)
Date: Mon Aug 22 19:30:21 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query,
	file AbstractSTRtree.cpp, line 286"
In-Reply-To: <CAGu-AB2z3JyWVVNrknZ3cykvJUkSBH5FYMuRgep60u_ZYM2qRA@mail.gmail.com>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
	<4E4E8020.1000503@telus.net>
	<CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>
	<20110820113744.GA14245@gnash>
	<CAGu-AB2z3JyWVVNrknZ3cykvJUkSBH5FYMuRgep60u_ZYM2qRA@mail.gmail.com>
Message-ID: <CAGu-AB2mzcichOe_V9W8pGjK8VmTU2M0czUB67-M8gbaGvjV0Q@mail.gmail.com>

I'm thinking that there must be some sort of conflict between the GEOS
and geodjango. Has the API changed significantly lately?

After installing the latest SVN release (3.4.0dev-CAPI-1.8.0), things
got worse, not better. Now no geometry will buffer, even super simple
example geometries from wikipedia's wkt entry.

Using two geometries from my dataset (attached as wkt), I ran through
the geodjango geos api.

Operations that seemed to work:
.empty
.geom_type
.num_coords
.num_geom
.hasz
.ring
.simple
.srid
.json
.ewkt
.hex
.hexewkb
.geojson
.ogr
.ewkb
.wkb
.contains(w2)
.crosses(w2)
.disjoint(w2)
.equals(w2)
.equals_exact(w2)
.intersects(w2)
.overlaps(w2)
.touches(w2)
.within(w2)
.relate(w2)
.boundary
.centroid
.convex_hull
.envelope
.area
.clone
.length
.prepared
.srs


Worked, but returned a bogus answer
In [17]: w1.distance(w2)
Out[17]: 1.7976931348623157e+308


Type errors:
.kml
GEOS_ERROR: Argument is not a Polygon
GEOS_ERROR: Argument is not a Polygon
w1.difference(w2)
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom12MultiPolygonE
 w1.intersection(w2)
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom12MultiPolygonE
w1.sym_difference(w2)
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom12MultiPolygonE
 w1.union(w2)
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom12MultiPolygonE
w1.point_on_surface
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom10LineStringE
GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
*): unknown geometry type: N4geos4geom10LineStringE
w1.extent
GEOS_ERROR: Geometry must be a Point or LineString
GEOS_ERROR: Geometry must be a Point or LineString
w1.coords
GEOS_ERROR: Argument is not a Polygon
GEOS_ERROR: Argument is not a Polygon


Segfault:
w1.simplify()
Segmentation fault
w1.valid
Segmentation fault
w1.valid_reason
Segmentation fault
w1.buffer(20)
Segmentation fault


I guess I'll go bitch at the GeoDjango folks for a while until I can
get an exact reason why things are going fubar when translating from
django to geos.

Thanks for your time,
--Christopher
-------------- next part --------------
A non-text attachment was scrubbed...
Name: w1fubar.wkt
Type: application/octet-stream
Size: 517 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20110822/0efb49c8/w1fubar-0001.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: w2fubar.wkt
Type: application/octet-stream
Size: 1067 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/geos-devel/attachments/20110822/0efb49c8/w2fubar-0001.obj
From geos-trac at osgeo.org  Mon Aug 22 16:58:19 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 21:36:48 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.0ec26cafa59a9032743c56b1afa82e28@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 I tested..
 this is the result.


 {{{
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 g++ -DHAVE_CONFIG_H -I. -I../../include -I../../include/geos
 -I../../include -I../../src/io/markup   -DGEOS_INLINE  -pedantic -Wall
 -ansi -Wno-long-long  -ffloat-store -g -O2 -MT bug234.o -MD -MP -MF
 .deps/bug234.Tpo -c -o bug234.o bug234.cpp
 mv -f .deps/bug234.Tpo .deps/bug234.Po
 /bin/sh ../../libtool --tag=CXX   --mode=link g++ -DGEOS_INLINE  -pedantic
 -Wall -ansi -Wno-long-long  -ffloat-store -g -O2  -lstdc++ -o bug234
 bug234.o ../../src/libgeos.la ../../src/libgeos.la
 libtool: link: g++ -DGEOS_INLINE -pedantic -Wall -ansi -Wno-long-long
 -ffloat-store -g -O2 -o .libs/bug234 bug234.o  -lstdc++
 ../../src/.libs/libgeos.so -Wl,-rpath -Wl,/usr/local/lib
 g++ -DHAVE_CONFIG_H -I. -I../../include -I../../include/geos
 -I../../include -I../../src/io/markup   -DGEOS_INLINE  -pedantic -Wall
 -ansi -Wno-long-long  -ffloat-store -g -O2 -MT TestSweepLineSpeed.o -MD
 -MP -MF .deps/TestSweepLineSpeed.Tpo -c -o TestSweepLineSpeed.o
 TestSweepLineSpeed.cpp
 mv -f .deps/TestSweepLineSpeed.Tpo .deps/TestSweepLineSpeed.Po
 g++ -DHAVE_CONFIG_H -I. -I../../include -I../../include/geos
 -I../../include -I../../src/io/markup   -DGEOS_INLINE  -pedantic -Wall
 -ansi -Wno-long-long  -ffloat-store -g -O2 -MT GeometryTestFactory.o -MD
 -MP -MF .deps/GeometryTestFactory.Tpo -c -o GeometryTestFactory.o
 GeometryTestFactory.cpp
 mv -f .deps/GeometryTestFactory.Tpo .deps/GeometryTestFactory.Po
 /bin/sh ../../libtool --tag=CXX   --mode=link g++ -DGEOS_INLINE  -pedantic
 -Wall -ansi -Wno-long-long  -ffloat-store -g -O2  -lstdc++ -o
 TestSweepLineSpeed TestSweepLineSpeed.o GeometryTestFactory.o
 ../../src/libgeos.la ../../src/libgeos.la
 libtool: link: g++ -DGEOS_INLINE -pedantic -Wall -ansi -Wno-long-long
 -ffloat-store -g -O2 -o .libs/TestSweepLineSpeed TestSweepLineSpeed.o
 GeometryTestFactory.o  -lstdc++ ../../src/.libs/libgeos.so -Wl,-rpath
 -Wl,/usr/local/lib
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 Making check in xmltester
 make[2]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make  check-TESTS
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make[3]: Warning: File `testrunner.sh' has modification time 26 s in the
 future
 Runner: testrunner created
 GNU gdb (GDB) Red Hat Enterprise Linux (7.2-48.el6)
 Copyright (C) 2010 Free Software Foundation, Inc.
 License GPLv3+: GNU GPL version 3 or later
 <http://gnu.org/licenses/gpl.html>
 This is free software: you are free to change and redistribute it.
 There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
 and "show warranty" for details.
 This GDB was configured as "x86_64-redhat-linux-gnu".
 For bug reporting instructions, please see:
 <http://www.gnu.org/software/gdb/bugs/>...
 Reading symbols from /home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester/.libs/lt-XMLTester...done.
 (gdb) bt
 No stack.
 (gdb)

 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:5>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 17:16:36 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 21:56:11 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.18c9117f9dc39ced0435108cf38777bc@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 Hi,
 finally I found how execute the program :)

 This is the result of execution with gdb:


 {{{
 make[3]: `bug234' is up to date.
 make[3]: `TestSweepLineSpeed' is up to date.
 make[3]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 make[2]: Leaving directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/bigtest'
 Making check in xmltester
 make[2]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 make  check-TESTS
 make[3]: Entering directory `/home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester'
 GNU gdb (GDB) Red Hat Enterprise Linux (7.2-48.el6)
 Copyright (C) 2010 Free Software Foundation, Inc.
 License GPLv3+: GNU GPL version 3 or later
 <http://gnu.org/licenses/gpl.html>
 This is free software: you are free to change and redistribute it.
 There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
 and "show warranty" for details.
 This GDB was configured as "x86_64-redhat-linux-gnu".
 For bug reporting instructions, please see:
 <http://www.gnu.org/software/gdb/bugs/>...
 Reading symbols from /home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester/.libs/lt-XMLTester...done.
 (gdb) start
 Temporary breakpoint 1 at 0x40e290: file XMLTester.cpp, line 1458.
 Starting program: /home/archivio/postgres/software/geos/geos-
 svn/tests/xmltester/.libs/lt-XMLTester -v --test-valid-output
 ./tests/testLeaksBig.xml ./tests/split.xml ./tests/hexwkb.xml
 ./tests/test.xml ./tests/linemerge.xml ./tests/TestIsValid.xml
 ./tests/robustness.xml ./tests/buffer.xml ./tests/singlesidedbuffer.xml
 ./tests/ticket/bug176.xml ./tests/ticket/bug188.xml
 ./tests/ticket/bug244.xml ./tests/ticket/bug275.xml
 ./tests/ticket/bug350.xml ./tests/ticket/bug356.xml
 ./tests/ticket/bug358.xml ./tests/ticket/bug360.xml
 ./tests/ticket/bug366.xml ./tests/ticket/bug392.xml
 ./tests/ticket/bug398.xml ./tests/ticket/bug434.xml
 ./tests/general/TestBoundary.xml ./tests/general/TestBuffer.xml
 ./tests/general/TestBufferMitredJoin.xml ./tests/general/TestCentroid.xml
 ./tests/general/TestConvexHull.xml ./tests/general/TestConvexHull-big.xml
 ./tests/general/TestDistance.xml ./tests/general/TestFunctionAAPrec.xml
 ./tests/general/TestFunctionAA.xml ./tests/general/TestFunctionLAPrec.xml
 ./tests/general/TestFunctionLA.xml ./tests/general/TestFunctionLLPrec.xml
 ./tests/general/TestFunctionLL.xml ./tests/general/TestFunctionPA.xml
 ./tests/general/TestFunctionPLPrec.xml ./tests/general/TestFunctionPL.xml
 ./tests/general/TestFunctionPP.xml ./tests/general/TestInteriorPoint.xml
 ./tests/general/TestRectanglePredicate.xml
 ./tests/general/TestRelateAA.xml ./tests/general/TestRelateLA.xml
 ./tests/general/TestRelateLL.xml ./tests/general/TestRelatePL.xml
 ./tests/general/TestRelateAC.xml ./tests/general/TestRelateLC.xml
 ./tests/general/TestRelatePA.xml ./tests/general/TestRelatePP.xml
 ./tests/general/TestSimple.xml ./tests/general/TestUnaryUnion.xml
 ./tests/general/TestValid.xml ./tests/general/TestValid2.xml
 ./tests/general/TestValid2-big.xml ./tests/general/TestWithinDistance.xml
 ./tests/stmlf/stmlf-cases-20061020.xml ./tests/stmlf/stmlf-cases-20061020
 -invalid-output.xml ./tests/stmlf/stmlf-cases-20070119.xml
 ./tests/robust/TestRobustOverlayFixed.xml
 ./tests/robust/TestRobustRelate.xml ./tests/fme.xml
 ./tests/TestBufferExternal.xml ./tests/TestBufferExternal2.xml
 ./tests/heisenbugs.xml ./tests/badguy3.xml ./tests/hole_from_shell.xml
 ./tests/hole_red.xml ./tests/safe/16595.xml ./tests/safe/16596.xml

 Temporary breakpoint 1, main (argC=71, argV=0x7fffffffd838)
     at XMLTester.cpp:1458
 1458    {
 Missing separate debuginfos, use: debuginfo-install
 glibc-2.12-1.25.el6_1.3.x86_64 libgcc-4.4.5-6.el6.x86_64
 libstdc++-4.4.5-6.el6.x86_64
 (gdb) libstdc++-4.4.5-6.el6.x86_64

 }}}

 and this is the result of bt command:


 {{{
 #0  main (argC=71, argV=0x7fffffffd838) at XMLTester.cpp:1458

 }}}

 Regards,

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:6>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 17:19:59 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 21:59:47 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.442c06fda32e560e8afaf39744bd2885@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 Hi,
 sorry for my slow steps forward, but I'm no skill with gdb.

 this is the final result of backtrace :


 {{{

 Temporary breakpoint 1, main (argC=71, argV=0x7fffffffd838)
     at XMLTester.cpp:1458
 1458    {
 Missing separate debuginfos, use: debuginfo-install
 glibc-2.12-1.25.el6_1.3.x86_64 libgcc-4.4.5-6.el6.x86_64
 libstdc++-4.4.5-6.el6.x86_64
 (gdb) libstdc++-4.4.5-6.el6.x86_64
 Undefined command: "libstdc++-4".  Try "help".
 (gdb) bt
 #0  main (argC=71, argV=0x7fffffffd838) at XMLTester.cpp:1458
 (gdb) q
 A debugging session is active.

         Inferior 1 [process 31527] will be killed.

 Quit anyway? (y or n) n
 Not confirmed.
 (gdb) continue
 Continuing.
 lt-XMLTester: GeometryComponentFilter.cpp:35: virtual void
 geos::geom::GeometryComponentFilter::filter_ro(const
 geos::geom::Geometry*): Assertion `0' failed.

 Program received signal SIGABRT, Aborted.
 0x00007ffff746d905 in raise () from /lib64/libc.so.6
 (gdb) bt
 #0  0x00007ffff746d905 in raise () from /lib64/libc.so.6
 #1  0x00007ffff746f0e5 in abort () from /lib64/libc.so.6
 #2  0x00007ffff74669be in __assert_fail_base () from /lib64/libc.so.6
 #3  0x00007ffff7466a80 in __assert_fail () from /lib64/libc.so.6
 #4  0x00007ffff7afcb13 in geos::geom::GeometryComponentFilter::filter_ro (
     this=<value optimized out>, geom=<value optimized out>)
     at GeometryComponentFilter.cpp:35
 #5  0x00007ffff7b631c5 in getLines (this=0x7fffffffc7f0)
     at ../../../include/geos/geom/util/LinearComponentExtracter.h:57
 #6  geos::operation::distance::DistanceOp::computeFacetDistance (
     this=0x7fffffffc7f0) at DistanceOp.cpp:396
 #7  0x00007ffff7b63871 in geos::operation::distance::DistanceOp::distance
 (
     this=0x7fffffffc7f0) at DistanceOp.cpp:148
 #8  0x00007ffff7b63b50 in geos::operation::distance::DistanceOp::distance
 (
     g0=<value optimized out>, g1=<value optimized out>) at
 DistanceOp.cpp:63
 #9  0x000000000040cc46 in XMLTester::parseTest (this=0x7fffffffd610,
     node=<value optimized out>) at XMLTester.cpp:1375
 #10 0x000000000040d41b in XMLTester::parseCase (this=0x7fffffffd610,
     node=<value optimized out>) at XMLTester.cpp:644
 #11 0x000000000040da23 in XMLTester::parseRun (this=0x7fffffffd610,
     node=<value optimized out>) at XMLTester.cpp:449
 #12 0x000000000040df99 in XMLTester::run (this=0x7fffffffd610, source=
     "./tests/general/TestDistance.xml") at XMLTester.cpp:399
 #13 0x000000000040e41a in main (argC=71, argV=<value optimized out>)
     at XMLTester.cpp:1507
 (gdb)

 }}}

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:7>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Mon Aug 22 17:53:57 2011
From: geos-trac at osgeo.org (GEOS)
Date: Mon Aug 22 22:35:34 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.9d9c36bba6ed980c00210d3d9226f928@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  major       |   Milestone:  3.3.1                     
Component:  Default     |     Version:  svn-trunk                 
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------

Comment(by aperi2007):

 Hi,
 changing the configure phase in this mode it seem work.

 CFLAGS="-m64" CPPFLAGS="-m64" CXXFLAGS="-m64" LDFLAGS="-m64" FFLAGS="-m64"
 LDFLAGS="-L/usr/lib64/" ./configure --enable-python

 Now the "make check" start and end without any error.

 it only report some strange notice like these:


 {{{
 capi::GEOSBuffer: ....................
 capi::GEOSContains: ...
 capi::GEOSCoordSeq: ......
 capi::GEOSDistance: .
 capi::GEOSGeomFromWKB: .....
 capi::GEOSGeomToWKT: .............
 capi::GEOSGeom_create: .......
 capi::GEOSGeom_extractUniquePoints: ...
 capi::GEOSIntersects: ...NOTICE: IllegalArgumentException:
 RobustDeterminant encountered non-finite numbers
 .NOTICE: IllegalArgumentException: RobustDeterminant encountered non-
 finite numbers
 .
 capi::GEOSLineStringPoint: ...
 capi::GEOSOffsetCurve: ......
 capi::GEOSOrientationIndex: ...........
 capi::GEOSPolygonizeGetCutEdges: ..
 capi::GEOSPreparedGeometry: ......
 capi::GEOSRelateBoundaryNodeRule: .......NOTICE: Invalid boundary node
 rule 5
 .
 capi::GEOSRelatePatternMatch: .....NOTICE: IllegalArgumentException:
 Geometry is not lineal

 capi::GEOSSharedPaths: ..NOTICE: IllegalArgumentException: Geometry is not
 lineal
 .
 capi::GEOSSimplify: .
 capi::GEOSSnap: ....
 capi::GEOSUnaryUnion: ........
 capi::GEOSWithin: ...
 capi::GEOSisValidDetail: ......
 geos::algorithm::Angle: ....
 geos::algorithm::CGAlgorithms::computeOrientation: ..
 geos::algorithm::CGAlgorithms::isCCW: .....
 geos::algorithm::CGAlgorithms::isPointInRing: ..
 geos::algorithm::CGAlgorithms::signedArea: ...
 geos::algorithm::ConvexHull: .......
 geos::algorithm::PointLocator: ....
 geos::algorithm::RobustLineIntersection: ..
 geos::algorithm::RobustLineIntersector: .............
 geos::algorithm::distace::DiscreteHausdorffDistance: ....
 geos::geom::Coordinate: .........
 geos::geom::CoordinateArraySequence: .................
 geos::geom::CoordinateArraySequenceFactory: ....
 geos::geom::CoordinateList: ..
 geos::geom::Dimension: .....
 geos::geom::Envelope: .........
 geos::geom::Geometry::clone: .......
 geos::geom::Geometry::covers: ...
 geos::geom::Geometry::isRectangle: .......
 geos::geom::GeometryFactory: ....................................
 geos::geom::IntersectionMatrix: .............................
 geos::geom::LineSegment: ......
 geos::geom::LineString: .........................
 geos::geom::LinearRing: ..............................
 geos::geom::Location: ...
 geos::geom::MultiLineString: .
 geos::geom::MultiPoint: ............................
 geos::geom::MultiPolygon: .
 geos::geom::Point: ........................................
 geos::geom::Polygon: .....................................
 geos::geom::PrecisionModel: .........
 geos::geom::Triangle: .....
 geos::geom::prep::PreparedGeometryFactory: .............................
 geos::geom::util::GeometryExtracter: ..
 geos::index::quadtree::DoubleBits: .
 geos::io::ByteOrderValues: ...
 geos::io::WKBReader: .......
 geos::io::WKBWriter: ...
 geos::io::WKTReader: ......
 geos::io::WKTWriter: .....
 geos::linearref::LocationIndexedLine: ........................
 geos::noding::BasicSegmentString: ....
 geos::noding::NodedSegmentString: .....
 geos::noding::SegmentNode: ....
 geos::noding::SegmentPointComparator: .....
 geos::operation::IsSimpleOp: ...
 geos::operation::buffer::BufferOp: .........
 geos::operation::distance::DistanceOp: ...................
 geos::operation::geounion::CascadedPolygonUnion: .
 geos::operation::geounion::UnaryUnionOp: .....
 geos::operation::linemerge::LineMerger: ......
 geos::operation::linemerge::LineSequencer: ............
 geos::operation::overlay::snap::GeometrySnapper: ..
 geos::operation::overlay::snap::LineStringSnapper: .......
 geos::operation::overlay::validate::FuzzyPointLocator: .......
 geos::operation::overlay::validate::OffsetPointGenerator: .....
 geos::operation::overlay::validate::OverlayResultValidator: ......
 geos::operation::polygonize::Polygonizer: ..
 geos::operation::sharedpaths::SharedPathsOp: .....................
 geos::operation::valid::IsValidOp: .
 geos::operation::valid::ValidClosedRing: .....
 geos::operation::valid::ValidSelfTouchingRingFormingHole: .......
 geos::precision::SimpleGeometryPrecisionReducer: .......
 geos::simplify::DouglasPeuckerSimplifier: ..........
 geos::simplify::TopologyPreservingSimplifier: ..........
 geos::util::UniqueCoordinateArrayFilter: .

 tests summary: ok:732
 PASS: geos_unit
 =============
 1 test passed
 =============

 }}}

 I don't know if these are serious errors .

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:8>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Wed Aug 24 07:33:02 2011
From: geos-trac at osgeo.org (GEOS)
Date: Wed Aug 24 08:41:04 2011
Subject: [geos-devel] [GEOS] #470: Fix warnings on MSVC 2008 64 Bit
Message-ID: <047.f5c67bf90a17cf18964d36230ba2038e@osgeo.org>

#470: Fix warnings on MSVC 2008 64 Bit
------------------------+---------------------------------------------------
 Reporter:  bgp2000     |       Owner:  geos-devel@?              
     Type:  defect      |      Status:  new                       
 Priority:  trivial     |   Milestone:  3.3.1                     
Component:  Default     |     Version:  3.3.0                     
 Severity:  Unassigned  |    Keywords:                            
------------------------+---------------------------------------------------
 This patch fixes a couple of warnings:

 C4512:"assignment operator could not be generated" for class
 OffsetSegmentGenerator.

 C4150:"deletion of pointer to incomplete type 'type'; no destructor
 called" when using std::auto_ptr<> with forward declared types.

 The patch does not address the hundreds of warnings for C4267:"conversion
 from 'size_t' to 'type', possible loss of data"

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/470>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From strk at keybit.net  Wed Aug 24 10:46:04 2011
From: strk at keybit.net (Sandro Santilli)
Date: Wed Aug 24 12:04:43 2011
Subject: [geos-devel] RE: [GEOS] #468: Geometry breaks valid() and
	buffer(): "Assertion failed: (0), function query, file
	AbstractSTRtree.cpp, line 286"
In-Reply-To: <CAGu-AB2mzcichOe_V9W8pGjK8VmTU2M0czUB67-M8gbaGvjV0Q@mail.gmail.com>
References: <048.2d84241cda459a9db7a73825846afd8c@osgeo.org>
	<CAGu-AB257wV8R1e=2LKc2yOKVG-A0byT8cuJEaJsX76FRLZozg@mail.gmail.com>
	<4E4DDBFE.7070505@telus.net> <4E4DDE48.5010607@telus.net>
	<CAGu-AB0nFL0M+Q4eTCZjKT7U7j9vPpXYhqWL7piKX3tcpEfw8Q@mail.gmail.com>
	<4E4E8020.1000503@telus.net>
	<CAGu-AB3+r34k+ZYJkT_YOmVrX_rFmqst_yqBUSovhbGV4Rtr8w@mail.gmail.com>
	<20110820113744.GA14245@gnash>
	<CAGu-AB2z3JyWVVNrknZ3cykvJUkSBH5FYMuRgep60u_ZYM2qRA@mail.gmail.com>
	<CAGu-AB2mzcichOe_V9W8pGjK8VmTU2M0czUB67-M8gbaGvjV0Q@mail.gmail.com>
Message-ID: <20110824144604.GA3992@gnash>

I guess GeoDjango is using the C++ API ?
Ahi ahi ahi ...

(yes, it changed, see NEWS file)

--strk;

On Mon, Aug 22, 2011 at 11:58:44AM -0700, Christopher DeMars wrote:
> I'm thinking that there must be some sort of conflict between the GEOS
> and geodjango. Has the API changed significantly lately?
> 
> After installing the latest SVN release (3.4.0dev-CAPI-1.8.0), things
> got worse, not better. Now no geometry will buffer, even super simple
> example geometries from wikipedia's wkt entry.
> 
> Using two geometries from my dataset (attached as wkt), I ran through
> the geodjango geos api.
> 
> Operations that seemed to work:
> .empty
> .geom_type
> .num_coords
> .num_geom
> .hasz
> .ring
> .simple
> .srid
> .json
> .ewkt
> .hex
> .hexewkb
> .geojson
> .ogr
> .ewkb
> .wkb
> .contains(w2)
> .crosses(w2)
> .disjoint(w2)
> .equals(w2)
> .equals_exact(w2)
> .intersects(w2)
> .overlaps(w2)
> .touches(w2)
> .within(w2)
> .relate(w2)
> .boundary
> .centroid
> .convex_hull
> .envelope
> .area
> .clone
> .length
> .prepared
> .srs
> 
> 
> Worked, but returned a bogus answer
> In [17]: w1.distance(w2)
> Out[17]: 1.7976931348623157e+308
> 
> 
> Type errors:
> .kml
> GEOS_ERROR: Argument is not a Polygon
> GEOS_ERROR: Argument is not a Polygon
> w1.difference(w2)
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom12MultiPolygonE
>  w1.intersection(w2)
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom12MultiPolygonE
> w1.sym_difference(w2)
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom12MultiPolygonE
>  w1.union(w2)
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom12MultiPolygonE
> w1.point_on_surface
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom10LineStringE
> GEOS_ERROR: UnsupportedOperationException: GeometryGraph::add(Geometry
> *): unknown geometry type: N4geos4geom10LineStringE
> w1.extent
> GEOS_ERROR: Geometry must be a Point or LineString
> GEOS_ERROR: Geometry must be a Point or LineString
> w1.coords
> GEOS_ERROR: Argument is not a Polygon
> GEOS_ERROR: Argument is not a Polygon
> 
> 
> Segfault:
> w1.simplify()
> Segmentation fault
> w1.valid
> Segmentation fault
> w1.valid_reason
> Segmentation fault
> w1.buffer(20)
> Segmentation fault
> 
> 
> I guess I'll go bitch at the GeoDjango folks for a while until I can
> get an exact reason why things are going fubar when translating from
> django to geos.
> 
> Thanks for your time,
> --Christopher



> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel


-- 

  ()   Free GIS & Flash consultant/developer
  /\   http://strk.keybit.net/services.html
From geos-trac at osgeo.org  Wed Aug 24 10:50:24 2011
From: geos-trac at osgeo.org (GEOS)
Date: Wed Aug 24 12:09:00 2011
Subject: [geos-devel] Re: [GEOS] #469: testrunner fail
In-Reply-To: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
References: <049.006c60b80cbdff3c636c4c54c892fcd4@osgeo.org>
Message-ID: <058.7b7d08855bbd18cd1091d94701e7479f@osgeo.org>

#469: testrunner fail
------------------------+---------------------------------------------------
 Reporter:  aperi2007   |        Owner:  geos-devel@?              
     Type:  defect      |       Status:  closed                    
 Priority:  major       |    Milestone:  3.3.1                     
Component:  Default     |      Version:  svn-trunk                 
 Severity:  Unassigned  |   Resolution:  invalid                   
 Keywords:              |  
------------------------+---------------------------------------------------
Changes (by strk):

  * status:  new => closed
  * resolution:  => invalid


Comment:

 Great to know there's finally no problem building geos.
 The notices are expected.

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/469#comment:9>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From geos-trac at osgeo.org  Wed Aug 24 10:56:46 2011
From: geos-trac at osgeo.org (GEOS)
Date: Wed Aug 24 12:15:46 2011
Subject: [geos-devel] Re: [GEOS] #470: Fix warnings on MSVC 2008 64 Bit
In-Reply-To: <047.f5c67bf90a17cf18964d36230ba2038e@osgeo.org>
References: <047.f5c67bf90a17cf18964d36230ba2038e@osgeo.org>
Message-ID: <056.bc7694b52cdc066a5fd9b5ac1013d150@osgeo.org>

#470: Fix warnings on MSVC 2008 64 Bit
------------------------+---------------------------------------------------
 Reporter:  bgp2000     |        Owner:  geos-devel@?              
     Type:  defect      |       Status:  closed                    
 Priority:  trivial     |    Milestone:  3.3.1                     
Component:  Default     |      Version:  3.3.0                     
 Severity:  Unassigned  |   Resolution:  fixed                     
 Keywords:              |  
------------------------+---------------------------------------------------
Changes (by strk):

  * status:  new => closed
  * resolution:  => fixed


Comment:

 Thanks, committed as r3462 and r3463

-- 
Ticket URL: <http://trac.osgeo.org/geos/ticket/470#comment:1>
GEOS <http://geos.refractions.net/>
GEOS (Geometry Engine - Open Source) is a C++ port of the Java Topology Suite (JTS).
From gamejihou at hotmail.com  Wed Aug 24 17:39:25 2011
From: gamejihou at hotmail.com (Gery .)
Date: Wed Aug 24 19:21:47 2011
Subject: [geos-devel] xmltester problem - GEOS installation in cygwin
Message-ID: <DUB111-W135F674CF764203770959C9B0110@phx.gbl>



Dear users,



I'm trying to install the GEOS (http://trac.osgeo.org/geos/)

application in my cygwin, but I'm getting a problem apparently with

the tinyxml.cpp, this is the error message:



===========================

...

...

...

Making check in swig

make[1]: Entering directory `/usr/local/geos-3.2.2/swig'

make[2]: Entering directory `/usr/local/geos-3.2.2/swig'

make[2]: Nothing to be done for `check-am'.

make[2]: Leaving directory `/usr/local/geos-3.2.2/swig'

make[1]: Leaving directory `/usr/local/geos-3.2.2/swig'

Making check in tests

make[1]: Entering directory `/usr/local/geos-3.2.2/tests'

Making check in bigtest

make[2]: Entering directory `/usr/local/geos-3.2.2/tests/bigtest'

make  bug234.exe TestSweepLineSpeed.exe

make[3]: Entering directory `/usr/local/geos-3.2.2/tests/bigtest'

make[3]: `bug234.exe' is up to date.

make[3]: `TestSweepLineSpeed.exe' is up to date.

make[3]: Leaving directory `/usr/local/geos-3.2.2/tests/bigtest'

make[2]: Leaving directory `/usr/local/geos-3.2.2/tests/bigtest'

Making check in xmltester

make[2]: Entering directory `/usr/local/geos-3.2.2/tests/xmltester'

g++ -DHAVE_CONFIG_H -I. -I../../source/headers -I../../source/headers/

geos -I../../source/headers -I../../source/io/tinyxml -

DTIXML_USE_STL    -g -O2 -DGEOS_INLINE  -pedantic -Wall -ansi -Wno-

long-long  -ffloat-store -MT tinyxml.o -MD -MP -MF .deps/tinyxml.Tpo -

c -o tinyxml.o `test -f 'tinyxml/tinyxml.cpp' || echo './'`tinyxml/

tinyxml.cpp

tinyxml/tinyxml.cpp: In static member function `static void

TiXmlBase::EncodeString(const std::string&, std::string*)':

tinyxml/tinyxml.cpp:114: error: `snprintf' undeclared (first use this

function)

tinyxml/tinyxml.cpp:114: error: (Each undeclared identifier is

reported only once for each function it appears in.)

tinyxml/tinyxml.cpp: In member function `void

TiXmlElement::SetAttribute(const char*, int)':

tinyxml/tinyxml.cpp:687: error: `snprintf' undeclared (first use this

function)

tinyxml/tinyxml.cpp: In member function `void

TiXmlElement::SetDoubleAttribute(const char*, double)':

tinyxml/tinyxml.cpp:709: error: `snprintf' undeclared (first use this

function)

tinyxml/tinyxml.cpp: In member function `void

TiXmlAttribute::SetIntValue(int)':

tinyxml/tinyxml.cpp:1258: error: `snprintf' undeclared (first use this

function)

tinyxml/tinyxml.cpp: In member function `void

TiXmlAttribute::SetDoubleValue(double)':

tinyxml/tinyxml.cpp:1269: error: `snprintf' undeclared (first use this

function)

make[2]: *** [tinyxml.o] Error 1

make[2]: Leaving directory `/usr/local/geos-3.2.2/tests/xmltester'

make[1]: *** [check-recursive] Error 1

make[1]: Leaving directory `/usr/local/geos-3.2.2/tests'

make: *** [check-recursive] Error 1

===========================



I have:



CYGWIN_NT-5.1 gery 1.5.25(0.156/4/2) 2008-06-12 19:34 i686 Cygwin



So, please, is there a way to solve this problem without uninstalling

my current cygwin version and upgrading to the current 1.7 version of

Cygwin?



Any hints are very welcome, thanks in advance.



Best regards,



Gery
  		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/geos-devel/attachments/20110824/28177b75/attachment.html
From lacrymology at gmail.com  Fri Aug 26 11:50:03 2011
From: lacrymology at gmail.com (Tomas Neme)
Date: Fri Aug 26 15:51:11 2011
Subject: [geos-devel] distance
Message-ID: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>

I'm looking at the geos API and I don't undestand what units are the
distance parameters supposed to be..

I'm trying to use buffer, to create a 1km circle around a Point
defined in SRID=22186, and.. I have no clue how to do this.

Thanks

Tomas

-- 
"The whole of Japan is pure invention. There is no such country, there
are no such people" --Oscar Wilde

|_|0|_|
|_|_|0|
|0|0|0|

(\__/)
(='.'=)This is Bunny. Copy and paste bunny
(")_(") to help him gain world domination.
From sean.gillies at gmail.com  Fri Aug 26 13:38:41 2011
From: sean.gillies at gmail.com (Sean Gillies)
Date: Fri Aug 26 17:45:02 2011
Subject: [geos-devel] distance
In-Reply-To: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>
References: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>
Message-ID: <CAOodmJr4sxNT--TuP-72V0ZNZ7Yag1JM_xGO7K=aK2AeD4HdEA@mail.gmail.com>

On Fri, Aug 26, 2011 at 9:50 AM, Tomas Neme <lacrymology@gmail.com> wrote:
> I'm looking at the geos API and I don't undestand what units are the
> distance parameters supposed to be..
>
> I'm trying to use buffer, to create a 1km circle around a Point
> defined in SRID=22186, and.. I have no clue how to do this.
>
> Thanks
>
> Tomas

Hi Tomas,

All the GEOS operations are done in a unitless Cartesian space.
Distance is unitless. For example, the distance between a point at (0,
0) and (1, 1) is sqrt(2). 22186 has units of meters, right? As long as
your distances are in meters (1000 in your case), you'll be fine.

Regards,

-- 
Sean
From lacrymology at gmail.com  Fri Aug 26 14:42:23 2011
From: lacrymology at gmail.com (Tomas Neme)
Date: Fri Aug 26 18:52:32 2011
Subject: [geos-devel] distance
In-Reply-To: <CAOodmJr4sxNT--TuP-72V0ZNZ7Yag1JM_xGO7K=aK2AeD4HdEA@mail.gmail.com>
References: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>
	<CAOodmJr4sxNT--TuP-72V0ZNZ7Yag1JM_xGO7K=aK2AeD4HdEA@mail.gmail.com>
Message-ID: <CA+8r0=z-LSuBu=FWQFQEPsLFM0ezFKhVw=k1jXJDMi5uWOP34A@mail.gmail.com>

> Hi Tomas,
>
> All the GEOS operations are done in a unitless Cartesian space.
> Distance is unitless. For example, the distance between a point at (0,
> 0) and (1, 1) is sqrt(2). 22186 has units of meters, right? As long as
> your distances are in meters (1000 in your case), you'll be fine.

I thought so, but.. how do I know this?

http://www.spatialreference.org/ref/epsg/22186/

this is all the info I could get on 22186, it doesn't say anything
about units. we use meters in AR, so I guess you must be right, but
not the point.. finding info on this subject is very hard =/


-- 
"The whole of Japan is pure invention. There is no such country, there
are no such people" --Oscar Wilde

|_|0|_|
|_|_|0|
|0|0|0|

(\__/)
(='.'=)This is Bunny. Copy and paste bunny
(")_(") to help him gain world domination.
From warmerdam at pobox.com  Fri Aug 26 14:46:27 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 26 18:56:24 2011
Subject: [geos-devel] distance
In-Reply-To: <CA+8r0=z-LSuBu=FWQFQEPsLFM0ezFKhVw=k1jXJDMi5uWOP34A@mail.gmail.com>
References: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>
	<CAOodmJr4sxNT--TuP-72V0ZNZ7Yag1JM_xGO7K=aK2AeD4HdEA@mail.gmail.com>
	<CA+8r0=z-LSuBu=FWQFQEPsLFM0ezFKhVw=k1jXJDMi5uWOP34A@mail.gmail.com>
Message-ID: <CA+YzLBc2r=39hKUw2EwGyu8OUsM+4v8nhuP3TQA-=fP1UD=jRg@mail.gmail.com>

Tomas,

If you dig into one of the representations, such as "well known text as HTML"
you can see the units.  In the WKT it is:

PROJCS["POSGAR 94 / Argentina 6",
    GEOGCS["POSGAR 94",
        DATUM["Posiciones_Geodesicas_Argentinas_1994",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6694"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.01745329251994328,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4694"]],
    UNIT["metre",1,   <<<<<<<< ***************** UNITS *****************
        AUTHORITY["EPSG","9001"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",-90],
    PARAMETER["central_meridian",-57],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",6500000],
    PARAMETER["false_northing",0],
    AUTHORITY["EPSG","22186"],
    AXIS["Y",EAST],
    AXIS["X",NORTH]]


On Fri, Aug 26, 2011 at 11:42 AM, Tomas Neme <lacrymology@gmail.com> wrote:
>> Hi Tomas,
>>
>> All the GEOS operations are done in a unitless Cartesian space.
>> Distance is unitless. For example, the distance between a point at (0,
>> 0) and (1, 1) is sqrt(2). 22186 has units of meters, right? As long as
>> your distances are in meters (1000 in your case), you'll be fine.
>
> I thought so, but.. how do I know this?
>
> http://www.spatialreference.org/ref/epsg/22186/
>
> this is all the info I could get on 22186, it doesn't say anything
> about units. we use meters in AR, so I guess you must be right, but
> not the point.. finding info on this subject is very hard =/
>
>
> --
> "The whole of Japan is pure invention. There is no such country, there
> are no such people" --Oscar Wilde
>
> |_|0|_|
> |_|_|0|
> |0|0|0|
>
> (\__/)
> (='.'=)This is Bunny. Copy and paste bunny
> (")_(") to help him gain world domination.
> _______________________________________________
> geos-devel mailing list
> geos-devel@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/geos-devel
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up?? | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush? ? | Geospatial Software Developer
From lacrymology at gmail.com  Fri Aug 26 14:49:12 2011
From: lacrymology at gmail.com (Tomas Neme)
Date: Fri Aug 26 18:59:39 2011
Subject: [geos-devel] distance
In-Reply-To: <CA+YzLBc2r=39hKUw2EwGyu8OUsM+4v8nhuP3TQA-=fP1UD=jRg@mail.gmail.com>
References: <CA+8r0=xFnN80Acgu8MmJgDpnBG+T6v8a482OQv3aMOzsQCDsfg@mail.gmail.com>
	<CAOodmJr4sxNT--TuP-72V0ZNZ7Yag1JM_xGO7K=aK2AeD4HdEA@mail.gmail.com>
	<CA+8r0=z-LSuBu=FWQFQEPsLFM0ezFKhVw=k1jXJDMi5uWOP34A@mail.gmail.com>
	<CA+YzLBc2r=39hKUw2EwGyu8OUsM+4v8nhuP3TQA-=fP1UD=jRg@mail.gmail.com>
Message-ID: <CA+8r0=zswYt_mh9QNkXWvqRwvOJqkcRokpOTM3EVc25HWqR=mQ@mail.gmail.com>

> If you dig into one of the representations, such as "well known text as HTML"
> you can see the units. ?In the WKT it is:
> ...
> ? ?UNIT["metre",1, ? <<<<<<<< ***************** UNITS *****************

=D

thanks


-- 
"The whole of Japan is pure invention. There is no such country, there
are no such people" --Oscar Wilde

|_|0|_|
|_|_|0|
|0|0|0|

(\__/)
(='.'=)This is Bunny. Copy and paste bunny
(")_(") to help him gain world domination.
