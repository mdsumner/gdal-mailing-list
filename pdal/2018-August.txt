From laasunde at hotmail.com  Mon Aug 13 05:15:48 2018
From: laasunde at hotmail.com (Lars)
Date: Mon, 13 Aug 2018 12:15:48 +0000
Subject: [pdal] GDAL Writer artifacts along edge of tile
Message-ID: <HE1PR03MB13389213BE946B5C852F93E6CA390@HE1PR03MB1338.eurprd03.prod.outlook.com>

Hello,


We have created a pipeline using pgpointcloud reader and gdal writer (see attached file).


Using the pipeline to create a full raster for an area works great. However if we tile the same area we are seeing some 'artifacts' along the edge of the raster (band 5, Count). The count is different along the edges of the tiled raster compared with a full raster (see attached screenshot taken from QGis showing band 5 of rasters).


We use the 'where' option in the reader.pgpointcloud to provide points that is writer.gdal.bounds + margin.


We would like to know why these 'artifacts' occur and how to prevent them from happening?


kind regards, Lars

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180813/e23854bf/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pipeline.json
Type: application/json
Size: 347 bytes
Desc: pipeline.json
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180813/e23854bf/attachment.json>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: raster_full.jpg
Type: image/jpeg
Size: 3486 bytes
Desc: raster_full.jpg
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180813/e23854bf/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: raster_tiled.jpg
Type: image/jpeg
Size: 3440 bytes
Desc: raster_tiled.jpg
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180813/e23854bf/attachment-0001.jpg>

From andrew.bell.ia at gmail.com  Mon Aug 13 06:32:07 2018
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 13 Aug 2018 09:32:07 -0400
Subject: [pdal] GDAL Writer artifacts along edge of tile
In-Reply-To: <HE1PR03MB13389213BE946B5C852F93E6CA390@HE1PR03MB1338.eurprd03.prod.outlook.com>
References: <HE1PR03MB13389213BE946B5C852F93E6CA390@HE1PR03MB1338.eurprd03.prod.outlook.com>
Message-ID: <CACJ51z2CLyx0h749reR2V=gXOc_vA-9dBV8y=56PpPB4ME4Ptg@mail.gmail.com>

Hi,

I'm not sure that there's enough information here for me to help you.
You'll have to be specific about how the counts are different than you
expect, how you're creating your tiles and reassembling them.  Keep in mind
that points outside the provided bounds aren't considered when making the
raster.  This typically means that some points that would be considered as
contributing to a cell will get discarded when that cell is on the edge of
the raster.  You're probably better off making the bounds one cell larger
than you need (depending on the radius argument), and then trimming those
edge cells away with GDAL or some such.  This is behavior that could be
changed, but I believe that when I wrote the code, I was trying to keep it
consistent with points2grid, which was the software that PDAL originally
used to create rasters.

Hope that helps,


On Mon, Aug 13, 2018 at 8:15 AM, Lars <laasunde at hotmail.com> wrote:

> Hello,
>
>
> We have created a pipeline using pgpointcloud reader and gdal writer (see
> attached file).
>
>
> Using the pipeline to create a full raster for an area works great.
> However if we tile the same area we are seeing some 'artifacts' along the
> edge of the raster (band 5, Count). The count is different along the edges
> of the tiled raster compared with a full raster (see attached screenshot
> taken from QGis showing band 5 of rasters).
>
>
> We use the 'where' option in the reader.pgpointcloud to provide points
> that is writer.gdal.bounds + margin.
>
>
> We would like to know why these 'artifacts' occur and how to prevent them
> from happening?
>
>
> kind regards, Lars
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180813/c727e3eb/attachment.html>

From laasunde at hotmail.com  Thu Aug 16 00:18:37 2018
From: laasunde at hotmail.com (Lars)
Date: Thu, 16 Aug 2018 07:18:37 +0000
Subject: [pdal] GDAL Writer artifacts along edge of tile
In-Reply-To: <CACJ51z2CLyx0h749reR2V=gXOc_vA-9dBV8y=56PpPB4ME4Ptg@mail.gmail.com>
References: <HE1PR03MB13389213BE946B5C852F93E6CA390@HE1PR03MB1338.eurprd03.prod.outlook.com>,
 <CACJ51z2CLyx0h749reR2V=gXOc_vA-9dBV8y=56PpPB4ME4Ptg@mail.gmail.com>
Message-ID: <HE1PR03MB13385D70550A0E411D3277FDCA3E0@HE1PR03MB1338.eurprd03.prod.outlook.com>

Andrew,

Thanks for the excellent feedback. We'll experiment with increasing the size of the raster and cropping it.

kind regards, Lars

________________________________
Fra: Andrew Bell <andrew.bell.ia at gmail.com>
Sendt: mandag 13. august 2018 15.32
Til: Lars
Kopi: pdal at lists.osgeo.org
Emne: Re: [pdal] GDAL Writer artifacts along edge of tile

Hi,

I'm not sure that there's enough information here for me to help you.  You'll have to be specific about how the counts are different than you expect, how you're creating your tiles and reassembling them.  Keep in mind that points outside the provided bounds aren't considered when making the raster.  This typically means that some points that would be considered as contributing to a cell will get discarded when that cell is on the edge of the raster.  You're probably better off making the bounds one cell larger than you need (depending on the radius argument), and then trimming those edge cells away with GDAL or some such.  This is behavior that could be changed, but I believe that when I wrote the code, I was trying to keep it consistent with points2grid, which was the software that PDAL originally used to create rasters.

Hope that helps,


On Mon, Aug 13, 2018 at 8:15 AM, Lars <laasunde at hotmail.com<mailto:laasunde at hotmail.com>> wrote:
Hello,


We have created a pipeline using pgpointcloud reader and gdal writer (see attached file).


Using the pipeline to create a full raster for an area works great. However if we tile the same area we are seeing some 'artifacts' along the edge of the raster (band 5, Count). The count is different along the edges of the tiled raster compared with a full raster (see attached screenshot taken from QGis showing band 5 of rasters).


We use the 'where' option in the reader.pgpointcloud to provide points that is writer.gdal.bounds + margin.


We would like to know why these 'artifacts' occur and how to prevent them from happening?


kind regards, Lars


_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180816/6a913761/attachment.html>

From j.murray3 at lancaster.ac.uk  Mon Aug 20 05:49:52 2018
From: j.murray3 at lancaster.ac.uk (Murray, Jon)
Date: Mon, 20 Aug 2018 12:49:52 +0000
Subject: [pdal] DSM and DTM mismatch.
Message-ID: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>

Hello PDAL users,

This is my first post to you all, having just joined the mailing list, so I hope this post is appropriate. I have a problem that I hope there is a PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It all works well, however there is a slight mismatch in output file sizes.

The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same input.las file. This prevents the CHM from being created (GDAL side now) as of course, the dimensions must match. I have tried reprocessing the DSM/DTM and changing grid sizes x/y, but no success.

Can anyone recommend a solution to this problem please? In short what can I do to make the DTM/DSM sizes match?

Many thanks,

Jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/5ba3bdb6/attachment.html>

From andrew.bell.ia at gmail.com  Mon Aug 20 05:57:54 2018
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 20 Aug 2018 08:57:54 -0400
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>

You should post pipelines to show how exactly you're creating the files.

On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk>
wrote:

> Hello PDAL users,
>
>
>
> This is my first post to you all, having just joined the mailing list, so
> I hope this post is appropriate. I have a problem that I hope there is a
> PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM
> from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It
> all works well, however there is a slight mismatch in output file sizes.
>
>
>
> The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same
> input.las file. This prevents the CHM from being created (GDAL side now) as
> of course, the dimensions must match. I have tried reprocessing the DSM/DTM
> and changing grid sizes x/y, but no success.
>
>
>
> Can anyone recommend a solution to this problem please? In short what can
> I do to make the DTM/DSM sizes match?
>
>
>
> Many thanks,
>
>
>
> Jon.
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/e00c7c51/attachment.html>

From j.murray3 at lancaster.ac.uk  Mon Aug 20 06:09:50 2018
From: j.murray3 at lancaster.ac.uk (Murray, Jon)
Date: Mon, 20 Aug 2018 13:09:50 +0000
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
Message-ID: <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>

Ah – apologies. My first post as I explained. As below:

DSM:

{
    "pipeline":[
        "input1.las",

        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.range",
            "limits":"returnnumber[1:1]"
        },
        {
            "type":"writers.p2g",
            "filename":"dsm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5,
            "radius":5
        }

    ]
}

DTM
{
    "pipeline":[
         "input1.las",
        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.ground",
            "approximate":true,
            "max_window_size":10,
            "slope":1.0,
            "max_distance":1,
            "initial_distance":0.15,
            "cell_size":1.0,
            "extract":true,
            "classify":false
        },
        {
            "type":"writers.p2g",
            "filename":"dtm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5
        }
    ]
}

And the CHM:

gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile chm1.tif –overwrite

Regards,

Jon.

From: Andrew Bell <andrew.bell.ia at gmail.com>
Sent: 20 August 2018 13:58
To: Murray, Jon <j.murray3 at lancaster.ac.uk>
Cc: pdal at lists.osgeo.org
Subject: Re: [pdal] DSM and DTM mismatch.

You should post pipelines to show how exactly you're creating the files.

On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>> wrote:
Hello PDAL users,

This is my first post to you all, having just joined the mailing list, so I hope this post is appropriate. I have a problem that I hope there is a PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It all works well, however there is a slight mismatch in output file sizes.

The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same input.las file. This prevents the CHM from being created (GDAL side now) as of course, the dimensions must match. I have tried reprocessing the DSM/DTM and changing grid sizes x/y, but no success.

Can anyone recommend a solution to this problem please? In short what can I do to make the DTM/DSM sizes match?

Many thanks,

Jon.

_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/474fc735/attachment-0001.html>

From howard at hobu.co  Mon Aug 20 06:18:14 2018
From: howard at hobu.co (Howard Butler)
Date: Mon, 20 Aug 2018 08:18:14 -0500
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
 <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <E8E2EC21-5307-401D-B536-B5ADDC5660E0@hobu.co>

I see "writers.p2g". Which version of PDAL are you using? We have refactored writers.p2g to something now called writers.gdal [1], which has many more features and probably some bug fixes. writers.gdal supports setting of an explicit bounds.

[1] https://pdal.io/stages/writers.gdal.html <https://pdal.io/stages/writers.gdal.html>

> On Aug 20, 2018, at 8:09 AM, Murray, Jon <j.murray3 at lancaster.ac.uk> wrote:
> 
> Ah – apologies. My first post as I explained. As below:
> 
> DSM:
> 
> {
>     "pipeline":[
>         "input1.las",
> 
>         {
>             "type":"filters.reprojection",
>             "in_srs":"EPSG:27700",
>             "out_srs":"EPSG:27700"
>         },
>                 {
>             "type":"filters.range",
>             "limits":"returnnumber[1:1]"
>         },
>         {
>             "type":"writers.p2g",
>             "filename":"dsm1",
>             "output_type":"idw",
>             "output_format":"tif",
>             "grid_dist_x":0.5,
>             "grid_dist_y":0.5,
>             "radius":5
>         }
> 
>     ]
> }
> 
> DTM
> {
>     "pipeline":[
>          "input1.las",
>         {
>             "type":"filters.reprojection",
>             "in_srs":"EPSG:27700",
>             "out_srs":"EPSG:27700"
>         },
>                 {
>             "type":"filters.ground",
>             "approximate":true,
>             "max_window_size":10,
>             "slope":1.0,
>             "max_distance":1,
>             "initial_distance":0.15,
>             "cell_size":1.0,
>             "extract":true,
>             "classify":false
>         },
>         {
>             "type":"writers.p2g",
>             "filename":"dtm1",
>             "output_type":"idw",
>             "output_format":"tif",
>             "grid_dist_x":0.5,
>             "grid_dist_y":0.5
>         }
>     ]
> }
> 
> And the CHM:
> 
> gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile chm1.tif –overwrite
> 
> Regards,
> 
> Jon.
> 
> From: Andrew Bell <andrew.bell.ia at gmail.com>
> Sent: 20 August 2018 13:58
> To: Murray, Jon <j.murray3 at lancaster.ac.uk>
> Cc: pdal at lists.osgeo.org
> Subject: Re: [pdal] DSM and DTM mismatch.
> 
> You should post pipelines to show how exactly you're creating the files.
> 
> On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk <mailto:j.murray3 at lancaster.ac.uk>> wrote:
> Hello PDAL users,
> 
> This is my first post to you all, having just joined the mailing list, so I hope this post is appropriate. I have a problem that I hope there is a PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It all works well, however there is a slight mismatch in output file sizes.
> 
> The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same input.las file. This prevents the CHM from being created (GDAL side now) as of course, the dimensions must match. I have tried reprocessing the DSM/DTM and changing grid sizes x/y, but no success.
> 
> Can anyone recommend a solution to this problem please? In short what can I do to make the DTM/DSM sizes match?
> 
> Many thanks,
> 
> Jon.
> 
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/pdal <https://lists.osgeo.org/mailman/listinfo/pdal>
> 
> 
> 
> --
> Andrew Bell
> andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>_______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/6e8ae2b6/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 528 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/6e8ae2b6/attachment-0001.sig>

From andrew.bell.ia at gmail.com  Mon Aug 20 06:24:30 2018
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 20 Aug 2018 09:24:30 -0400
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
 <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <CACJ51z1VD937jwEHr-mn0SxrGqeWiETF0ZQLSG=fjLzpMmGFkw@mail.gmail.com>

Hi,

We haven't supported the p2g writer since version 1.5.  You should use
writers.gdal instead.  Also, you're reprojection filter is a no-op, as the
input and output SRSs are identical.  If you're wanting to override the SRS
of the input, you can use the "--readers.las.spatialreference" option.

Best,


On Mon, Aug 20, 2018 at 9:09 AM, Murray, Jon <j.murray3 at lancaster.ac.uk>
wrote:

> Ah – apologies. My first post as I explained. As below:
>
>
>
> DSM:
>
>
>
> {
>
>     "pipeline":[
>
>         "input1.las",
>
>
>
>         {
>
>             "type":"filters.reprojection",
>
>             "in_srs":"EPSG:27700",
>
>             "out_srs":"EPSG:27700"
>
>         },
>
>                 {
>
>             "type":"filters.range",
>
>             "limits":"returnnumber[1:1]"
>
>         },
>
>         {
>
>             "type":"writers.p2g",
>
>             "filename":"dsm1",
>
>             "output_type":"idw",
>
>             "output_format":"tif",
>
>             "grid_dist_x":0.5,
>
>             "grid_dist_y":0.5,
>
>             "radius":5
>
>         }
>
>
>
>     ]
>
> }
>
>
>
> DTM
>
> {
>
>     "pipeline":[
>
>          "input1.las",
>
>         {
>
>             "type":"filters.reprojection",
>
>             "in_srs":"EPSG:27700",
>
>             "out_srs":"EPSG:27700"
>
>         },
>
>                 {
>
>             "type":"filters.ground",
>
>             "approximate":true,
>
>             "max_window_size":10,
>
>             "slope":1.0,
>
>             "max_distance":1,
>
>             "initial_distance":0.15,
>
>             "cell_size":1.0,
>
>             "extract":true,
>
>             "classify":false
>
>         },
>
>         {
>
>             "type":"writers.p2g",
>
>             "filename":"dtm1",
>
>             "output_type":"idw",
>
>             "output_format":"tif",
>
>             "grid_dist_x":0.5,
>
>             "grid_dist_y":0.5
>
>         }
>
>     ]
>
> }
>
>
>
> And the CHM:
>
>
>
> gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile
> chm1.tif –overwrite
>
>
>
> Regards,
>
>
>
> Jon.
>
>
>
> *From:* Andrew Bell <andrew.bell.ia at gmail.com>
> *Sent:* 20 August 2018 13:58
> *To:* Murray, Jon <j.murray3 at lancaster.ac.uk>
> *Cc:* pdal at lists.osgeo.org
> *Subject:* Re: [pdal] DSM and DTM mismatch.
>
>
>
> You should post pipelines to show how exactly you're creating the files.
>
>
>
> On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk>
> wrote:
>
> Hello PDAL users,
>
>
>
> This is my first post to you all, having just joined the mailing list, so
> I hope this post is appropriate. I have a problem that I hope there is a
> PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM
> from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It
> all works well, however there is a slight mismatch in output file sizes.
>
>
>
> The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same
> input.las file. This prevents the CHM from being created (GDAL side now) as
> of course, the dimensions must match. I have tried reprocessing the DSM/DTM
> and changing grid sizes x/y, but no success.
>
>
>
> Can anyone recommend a solution to this problem please? In short what can
> I do to make the DTM/DSM sizes match?
>
>
>
> Many thanks,
>
>
>
> Jon.
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
>
>
> --
>
> Andrew Bell
> andrew.bell.ia at gmail.com
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/276c42f8/attachment.html>

From j.murray3 at lancaster.ac.uk  Mon Aug 20 06:30:25 2018
From: j.murray3 at lancaster.ac.uk (Murray, Jon)
Date: Mon, 20 Aug 2018 13:30:25 +0000
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <E8E2EC21-5307-401D-B536-B5ADDC5660E0@hobu.co>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
 <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <E8E2EC21-5307-401D-B536-B5ADDC5660E0@hobu.co>
Message-ID: <LO2P265MB118259D8DD1555EED371E87DE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>

OK thanks for the comments. I’ll update the pdal (yes, older version) and look at using the witers.gdal to see how I get on. Many thanks for your input.

Jon.

From: Howard Butler <howard at hobu.co>
Sent: 20 August 2018 14:18
To: Murray, Jon <j.murray3 at lancaster.ac.uk>
Cc: Andrew Bell <andrew.bell.ia at gmail.com>; pdal at lists.osgeo.org
Subject: Re: [pdal] DSM and DTM mismatch.

I see "writers.p2g". Which version of PDAL are you using? We have refactored writers.p2g to something now called writers.gdal [1], which has many more features and probably some bug fixes. writers.gdal supports setting of an explicit bounds.

[1] https://pdal.io/stages/writers.gdal.html

On Aug 20, 2018, at 8:09 AM, Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>> wrote:

Ah – apologies. My first post as I explained. As below:

DSM:

{
    "pipeline":[
        "input1.las",

        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.range",
            "limits":"returnnumber[1:1]"
        },
        {
            "type":"writers.p2g",
            "filename":"dsm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5,
            "radius":5
        }

    ]
}

DTM
{
    "pipeline":[
         "input1.las",
        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.ground",
            "approximate":true,
            "max_window_size":10,
            "slope":1.0,
            "max_distance":1,
            "initial_distance":0.15,
            "cell_size":1.0,
            "extract":true,
            "classify":false
        },
        {
            "type":"writers.p2g",
            "filename":"dtm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5
        }
    ]
}

And the CHM:

gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile chm1.tif –overwrite

Regards,

Jon.

From: Andrew Bell <andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>>
Sent: 20 August 2018 13:58
To: Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>>
Cc: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
Subject: Re: [pdal] DSM and DTM mismatch.

You should post pipelines to show how exactly you're creating the files.

On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>> wrote:
Hello PDAL users,

This is my first post to you all, having just joined the mailing list, so I hope this post is appropriate. I have a problem that I hope there is a PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It all works well, however there is a slight mismatch in output file sizes.

The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same input.las file. This prevents the CHM from being created (GDAL side now) as of course, the dimensions must match. I have tried reprocessing the DSM/DTM and changing grid sizes x/y, but no success.

Can anyone recommend a solution to this problem please? In short what can I do to make the DTM/DSM sizes match?

Many thanks,

Jon.

_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/0fd393ed/attachment-0001.html>

From doug_newcomb at fws.gov  Mon Aug 20 06:36:30 2018
From: doug_newcomb at fws.gov (Doug Newcomb)
Date: Mon, 20 Aug 2018 09:36:30 -0400
Subject: [pdal] [EXTERNAL] Re:  DSM and DTM mismatch.
In-Reply-To: <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
 <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <CALQGVr3Wom135LBWK1rbUMTKsJjh2TPf3FebRd_RKM1rYs+=bQ@mail.gmail.com>

Jon,
Try getting an xy extent of the 1st returns vsan xy extent of  just the
ground points.  It may be that the extent of the 1st returns is larger than
that of the ground returns at the 0.5 (m? ft?) scale.

Doug

On Mon, Aug 20, 2018 at 9:10 AM Murray, Jon <j.murray3 at lancaster.ac.uk>
wrote:

> Ah – apologies. My first post as I explained. As below:
>
>
>
> DSM:
>
>
>
> {
>
>     "pipeline":[
>
>         "input1.las",
>
>
>
>         {
>
>             "type":"filters.reprojection",
>
>             "in_srs":"EPSG:27700",
>
>             "out_srs":"EPSG:27700"
>
>         },
>
>                 {
>
>             "type":"filters.range",
>
>             "limits":"returnnumber[1:1]"
>
>         },
>
>         {
>
>             "type":"writers.p2g",
>
>             "filename":"dsm1",
>
>             "output_type":"idw",
>
>             "output_format":"tif",
>
>             "grid_dist_x":0.5,
>
>             "grid_dist_y":0.5,
>
>             "radius":5
>
>         }
>
>
>
>     ]
>
> }
>
>
>
> DTM
>
> {
>
>     "pipeline":[
>
>          "input1.las",
>
>         {
>
>             "type":"filters.reprojection",
>
>             "in_srs":"EPSG:27700",
>
>             "out_srs":"EPSG:27700"
>
>         },
>
>                 {
>
>             "type":"filters.ground",
>
>             "approximate":true,
>
>             "max_window_size":10,
>
>             "slope":1.0,
>
>             "max_distance":1,
>
>             "initial_distance":0.15,
>
>             "cell_size":1.0,
>
>             "extract":true,
>
>             "classify":false
>
>         },
>
>         {
>
>             "type":"writers.p2g",
>
>             "filename":"dtm1",
>
>             "output_type":"idw",
>
>             "output_format":"tif",
>
>             "grid_dist_x":0.5,
>
>             "grid_dist_y":0.5
>
>         }
>
>     ]
>
> }
>
>
>
> And the CHM:
>
>
>
> gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile
> chm1.tif –overwrite
>
>
>
> Regards,
>
>
>
> Jon.
>
>
>
> *From:* Andrew Bell <andrew.bell.ia at gmail.com>
> *Sent:* 20 August 2018 13:58
> *To:* Murray, Jon <j.murray3 at lancaster.ac.uk>
> *Cc:* pdal at lists.osgeo.org
> *Subject:* Re: [pdal] DSM and DTM mismatch.
>
>
>
> You should post pipelines to show how exactly you're creating the files.
>
>
>
> On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk>
> wrote:
>
> Hello PDAL users,
>
>
>
> This is my first post to you all, having just joined the mailing list, so
> I hope this post is appropriate. I have a problem that I hope there is a
> PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM
> from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It
> all works well, however there is a slight mismatch in output file sizes.
>
>
>
> The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same
> input.las file. This prevents the CHM from being created (GDAL side now) as
> of course, the dimensions must match. I have tried reprocessing the DSM/DTM
> and changing grid sizes x/y, but no success.
>
>
>
> Can anyone recommend a solution to this problem please? In short what can
> I do to make the DTM/DSM sizes match?
>
>
>
> Many thanks,
>
>
>
> Jon.
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
>
>
> --
>
> Andrew Bell
> andrew.bell.ia at gmail.com
>


-- 
Doug Newcomb - Cartographer
USFWS
551F Pylon Dr
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------

*NOTE: This email correspondence and any attachments to and from this
sender is subject to the Freedom of Information Act (FOIA) and may be
disclosed to third parties.*​
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/fb86da1d/attachment.html>

From j.murray3 at lancaster.ac.uk  Mon Aug 20 06:37:27 2018
From: j.murray3 at lancaster.ac.uk (Murray, Jon)
Date: Mon, 20 Aug 2018 13:37:27 +0000
Subject: [pdal] DSM and DTM mismatch.
In-Reply-To: <CACJ51z1VD937jwEHr-mn0SxrGqeWiETF0ZQLSG=fjLzpMmGFkw@mail.gmail.com>
References: <LO2P265MB11827C994ED59C18493BBA0FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z0Ta=oR788D7ksZrPTQEoHPLMPJU423tqsL7wHSD9Zd2g@mail.gmail.com>
 <LO2P265MB1182C82629CF35D0F8EF9671E0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>
 <CACJ51z1VD937jwEHr-mn0SxrGqeWiETF0ZQLSG=fjLzpMmGFkw@mail.gmail.com>
Message-ID: <LO2P265MB1182FE5F83B598A1E8BDB68FE0320@LO2P265MB1182.GBRP265.PROD.OUTLOOK.COM>

Many thanks for your help.

Jon.

From: Andrew Bell <andrew.bell.ia at gmail.com>
Sent: 20 August 2018 14:25
To: Murray, Jon <j.murray3 at lancaster.ac.uk>
Cc: pdal at lists.osgeo.org
Subject: Re: [pdal] DSM and DTM mismatch.

Hi,

We haven't supported the p2g writer since version 1.5.  You should use writers.gdal instead.  Also, you're reprojection filter is a no-op, as the input and output SRSs are identical.  If you're wanting to override the SRS of the input, you can use the "--readers.las.spatialreference" option.

Best,


On Mon, Aug 20, 2018 at 9:09 AM, Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>> wrote:
Ah – apologies. My first post as I explained. As below:

DSM:

{
    "pipeline":[
        "input1.las",

        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.range",
            "limits":"returnnumber[1:1]"
        },
        {
            "type":"writers.p2g",
            "filename":"dsm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5,
            "radius":5
        }

    ]
}

DTM
{
    "pipeline":[
         "input1.las",
        {
            "type":"filters.reprojection",
            "in_srs":"EPSG:27700",
            "out_srs":"EPSG:27700"
        },
                {
            "type":"filters.ground",
            "approximate":true,
            "max_window_size":10,
            "slope":1.0,
            "max_distance":1,
            "initial_distance":0.15,
            "cell_size":1.0,
            "extract":true,
            "classify":false
        },
        {
            "type":"writers.p2g",
            "filename":"dtm1",
            "output_type":"idw",
            "output_format":"tif",
            "grid_dist_x":0.5,
            "grid_dist_y":0.5
        }
    ]
}

And the CHM:

gdal_calc.py -A dtm1.idw.tif -B dsm1.idw.tif --calc="B-A" --outfile chm1.tif –overwrite

Regards,

Jon.

From: Andrew Bell <andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>>
Sent: 20 August 2018 13:58
To: Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>>
Cc: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
Subject: Re: [pdal] DSM and DTM mismatch.

You should post pipelines to show how exactly you're creating the files.

On Mon, Aug 20, 2018 at 8:49 AM, Murray, Jon <j.murray3 at lancaster.ac.uk<mailto:j.murray3 at lancaster.ac.uk>> wrote:
Hello PDAL users,

This is my first post to you all, having just joined the mailing list, so I hope this post is appropriate. I have a problem that I hope there is a PDAL (or possibly GDAL) based solution for. I have created both DSM and DTM from LiDAR (.las) data, using the appropriate PDAL filters/writers etc. It all works well, however there is a slight mismatch in output file sizes.

The DSM comes out at (3069,1094) and the DTM at (3069,1092), from the same input.las file. This prevents the CHM from being created (GDAL side now) as of course, the dimensions must match. I have tried reprocessing the DSM/DTM and changing grid sizes x/y, but no success.

Can anyone recommend a solution to this problem please? In short what can I do to make the DTM/DSM sizes match?

Many thanks,

Jon.

_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/f7e656d4/attachment-0001.html>

From jgrn307 at gmail.com  Mon Aug 20 16:18:09 2018
From: jgrn307 at gmail.com (Jonathan Greenberg)
Date: Mon, 20 Aug 2018 16:18:09 -0700
Subject: [pdal] Setting all points to a single class?
Message-ID: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>

PDALers:

I'm still a bit new to the command line interface.  I'd like to do the
following: set all point classifications in a .las file to "101".  I tried
a pipeline like:

{
"pipeline":[
  "P001_E1_clip.las",
  {
      "type":"filters.assign",
      "assignment" : "Classification(0:255]=101"
  },
  {
  "filename":"P001_E1_clip_tclass.las"
  }
]
}

But this doesn't appear to be working -- any ideas?

--j
-- 
-- 
Jonathan A. Greenberg, PhD
Randall Endowed Professor and Associate Professor of Remote Sensing
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Natural Resources & Environmental Science
University of Nevada, Reno
1664 N Virginia St MS/0186
Reno, NV 89557
Phone: 415-763-5476
http://www.unr.edu/nres
Gchat: jgrn307 at gmail.com, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/9b12d4ac/attachment.html>

From andrew.bell.ia at gmail.com  Mon Aug 20 16:52:13 2018
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 20 Aug 2018 19:52:13 -0400
Subject: [pdal] Setting all points to a single class?
In-Reply-To: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
References: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
Message-ID: <CACJ51z06TgehUb8BgfuODiPHLG5SRbe3-iPv1MOAor7fMx8kDQ@mail.gmail.com>

It's hard to know without seeing output.

What do you get when you run:

pdal info --filters.stats.enumerate=Classification
--filters.stats.dimensions=Classification

on the result (P001_E1_clip_class.las)
?

Also, you can set the value of all points with the syntax:
"Classification[:]=101" for the "assignment" option.  In your case, you're
excluding points with the value 0 and greater than 255, which may not be
what you want.

On Mon, Aug 20, 2018 at 7:18 PM, Jonathan Greenberg <jgrn307 at gmail.com>
wrote:

> PDALers:
>
> I'm still a bit new to the command line interface.  I'd like to do the
> following: set all point classifications in a .las file to "101".  I
> tried a pipeline like:
>
> {
> "pipeline":[
>   "P001_E1_clip.las",
>   {
>       "type":"filters.assign",
>       "assignment" : "Classification(0:255]=101"
>   },
>   {
>   "filename":"P001_E1_clip_tclass.las"
>   }
> ]
> }
>
>
> --j
> --
> --
> Jonathan A. Greenberg, PhD
> Randall Endowed Professor and Associate Professor of Remote Sensing
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Natural Resources & Environmental Science
> University of Nevada, Reno
> 1664 N Virginia St MS/0186
> Reno, NV 89557
> Phone: 415-763-5476
> http://www.unr.edu/nres
> Gchat: jgrn307 at gmail.com, Skype: jgrn3007
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180820/7253a40b/attachment.html>

From luipir at gmail.com  Tue Aug 21 01:43:05 2018
From: luipir at gmail.com (Luigi Pirelli)
Date: Tue, 21 Aug 2018 10:43:05 +0200
Subject: [pdal] Setting all points to a single class?
In-Reply-To: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
References: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
Message-ID: <CAFO80_pEtMCtU-aRb==wTNGSGfRAaN-QLoYCTgobXek3rTyLAA@mail.gmail.com>

I suppose You don't have any classification within [0:255)

Luigi Pirelli

**************************************************************************************************
* LinkedIn: https://www.linkedin.com/in/luigipirelli
* Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
* GitHub: https://github.com/luipir
* Mastering QGIS 2nd Edition:
*
https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
* Hire me: http://goo.gl/BYRQKg
**************************************************************************************************


On Tue, 21 Aug 2018 at 01:18, Jonathan Greenberg <jgrn307 at gmail.com> wrote:

> PDALers:
>
> I'm still a bit new to the command line interface.  I'd like to do the
> following: set all point classifications in a .las file to "101".  I
> tried a pipeline like:
>
> {
> "pipeline":[
>   "P001_E1_clip.las",
>   {
>       "type":"filters.assign",
>       "assignment" : "Classification(0:255]=101"
>   },
>   {
>   "filename":"P001_E1_clip_tclass.las"
>   }
> ]
> }
>
> But this doesn't appear to be working -- any ideas?
>
> --j
> --
> --
> Jonathan A. Greenberg, PhD
> Randall Endowed Professor and Associate Professor of Remote Sensing
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Natural Resources & Environmental Science
> University of Nevada, Reno
> 1664 N Virginia St MS/0186
> Reno, NV 89557
> Phone: 415-763-5476
> http://www.unr.edu/nres
> Gchat: jgrn307 at gmail.com, Skype: jgrn3007
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180821/4e5e6f24/attachment.html>

From brad.chambers at gmail.com  Tue Aug 21 03:30:48 2018
From: brad.chambers at gmail.com (Bradley Chambers)
Date: Tue, 21 Aug 2018 06:30:48 -0400
Subject: [pdal] Setting all points to a single class?
In-Reply-To: <CAFO80_pEtMCtU-aRb==wTNGSGfRAaN-QLoYCTgobXek3rTyLAA@mail.gmail.com>
References: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
 <CAFO80_pEtMCtU-aRb==wTNGSGfRAaN-QLoYCTgobXek3rTyLAA@mail.gmail.com>
Message-ID: <CAJyqqPxoepT2oz5f0n2USL4OWRjCMNQX+ZLte6TzBU2bJOooog@mail.gmail.com>

This is a good point, and if you really want all points classified as 101,
the assignment can be "Classification [:]=101".

On Tue, Aug 21, 2018, 4:43 AM Luigi Pirelli <luipir at gmail.com> wrote:

> I suppose You don't have any classification within [0:255)
>
> Luigi Pirelli
>
>
> **************************************************************************************************
> * LinkedIn: https://www.linkedin.com/in/luigipirelli
> * Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
> * GitHub: https://github.com/luipir
> * Mastering QGIS 2nd Edition:
> *
> https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
> * Hire me: http://goo.gl/BYRQKg
>
> **************************************************************************************************
>
>
> On Tue, 21 Aug 2018 at 01:18, Jonathan Greenberg <jgrn307 at gmail.com>
> wrote:
>
>> PDALers:
>>
>> I'm still a bit new to the command line interface.  I'd like to do the
>> following: set all point classifications in a .las file to "101".  I
>> tried a pipeline like:
>>
>> {
>> "pipeline":[
>>   "P001_E1_clip.las",
>>   {
>>       "type":"filters.assign",
>>       "assignment" : "Classification(0:255]=101"
>>   },
>>   {
>>   "filename":"P001_E1_clip_tclass.las"
>>   }
>> ]
>> }
>>
>> But this doesn't appear to be working -- any ideas?
>>
>> --j
>> --
>> --
>> Jonathan A. Greenberg, PhD
>> Randall Endowed Professor and Associate Professor of Remote Sensing
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Natural Resources & Environmental Science
>> University of Nevada, Reno
>> 1664 N Virginia St MS/0186
>> Reno, NV 89557
>> Phone: 415-763-5476
>> http://www.unr.edu/nres
>> Gchat: jgrn307 at gmail.com, Skype: jgrn3007
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180821/7efea891/attachment-0001.html>

From jgrn307 at gmail.com  Tue Aug 21 08:38:33 2018
From: jgrn307 at gmail.com (Jonathan Greenberg)
Date: Tue, 21 Aug 2018 08:38:33 -0700
Subject: [pdal] Setting all points to a single class?
In-Reply-To: <CAJyqqPxoepT2oz5f0n2USL4OWRjCMNQX+ZLte6TzBU2bJOooog@mail.gmail.com>
References: <CABG0rfsCgBxaScjPu6FMfPEjP3MyK5hEtw_o=qnh0jjkynkZJA@mail.gmail.com>
 <CAFO80_pEtMCtU-aRb==wTNGSGfRAaN-QLoYCTgobXek3rTyLAA@mail.gmail.com>
 <CAJyqqPxoepT2oz5f0n2USL4OWRjCMNQX+ZLte6TzBU2bJOooog@mail.gmail.com>
Message-ID: <CABG0rftgrN0M3QBZTAfyN8i560EEtpMCkgEVJy5xgc_otizR7A@mail.gmail.com>

That was the trick!  Thanks!  Solution:

"pipeline":[
  "P001_E1_clip.las",
  {
      "type":"filters.assign",
      "assignment" : "Classification[:]=101"
  },
  {
  "filename":"P001_E1_clip_tclass.las"
  }
]
}

pdal pipeline reclasspipe.json

--j

On Tue, Aug 21, 2018 at 3:31 AM Bradley Chambers <brad.chambers at gmail.com>
wrote:

> This is a good point, and if you really want all points classified as 101,
> the assignment can be "Classification [:]=101".
>
> On Tue, Aug 21, 2018, 4:43 AM Luigi Pirelli <luipir at gmail.com> wrote:
>
>> I suppose You don't have any classification within [0:255)
>>
>> Luigi Pirelli
>>
>>
>> **************************************************************************************************
>> * LinkedIn: https://www.linkedin.com/in/luigipirelli
>> * Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
>> * GitHub: https://github.com/luipir
>> * Mastering QGIS 2nd Edition:
>> *
>> https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
>> * Hire me: http://goo.gl/BYRQKg
>>
>> **************************************************************************************************
>>
>>
>> On Tue, 21 Aug 2018 at 01:18, Jonathan Greenberg <jgrn307 at gmail.com>
>> wrote:
>>
>>> PDALers:
>>>
>>> I'm still a bit new to the command line interface.  I'd like to do the
>>> following: set all point classifications in a .las file to "101".  I
>>> tried a pipeline like:
>>>
>>> {
>>> "pipeline":[
>>>   "P001_E1_clip.las",
>>>   {
>>>       "type":"filters.assign",
>>>       "assignment" : "Classification(0:255]=101"
>>>   },
>>>   {
>>>   "filename":"P001_E1_clip_tclass.las"
>>>   }
>>> ]
>>> }
>>>
>>> But this doesn't appear to be working -- any ideas?
>>>
>>> --j
>>> --
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Randall Endowed Professor and Associate Professor of Remote Sensing
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Natural Resources & Environmental Science
>>> University of Nevada, Reno
>>> 1664 N Virginia St
>>> <https://maps.google.com/?q=1664+N+Virginia+St&entry=gmail&source=g>
>>> MS/0186
>>> Reno, NV 89557
>>> Phone: 415-763-5476 <(415)%20763-5476>
>>> http://www.unr.edu/nres
>>> Gchat: jgrn307 at gmail.com, Skype: jgrn3007
>>> _______________________________________________
>>> pdal mailing list
>>> pdal at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
> --
-- 
Jonathan A. Greenberg, PhD
Randall Endowed Professor and Associate Professor of Remote Sensing
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Natural Resources & Environmental Science
University of Nevada, Reno
1664 N Virginia St MS/0186
Reno, NV 89557
Phone: 415-763-5476
http://www.unr.edu/nres
Gchat: jgrn307 at gmail.com, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180821/e8767ec2/attachment.html>

From jgrn307 at gmail.com  Tue Aug 21 10:44:48 2018
From: jgrn307 at gmail.com (Jonathan Greenberg)
Date: Tue, 21 Aug 2018 10:44:48 -0700
Subject: [pdal] Conversion and alignment of voxels...
Message-ID: <CABG0rfvxtEU3zq-hEZBVkq28PdqyMm39OCy=4w_oC=x6_rq8Jw@mail.gmail.com>

Folks:

I would like to do a voxelgrid type downsampling, but with the following
tweaks and was hoping to see if PDAL could help:

1) Store the voxel center rather than the centroid of the points inside of
it
2) Store stats on the points in a given voxel (e.g. count of points in a
voxel)
3) Be able to set the origin point of the voxel rather than (what I am
assuming) is e.g. the min x,y,z so I can "align" two different point clouds.

The goal of this is to create the framework for looking at change detection
within a given voxel.

--j
-- 
-- 
Jonathan A. Greenberg, PhD
Randall Endowed Professor and Associate Professor of Remote Sensing
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Natural Resources & Environmental Science
University of Nevada, Reno
1664 N Virginia St MS/0186
Reno, NV 89557
Phone: 415-763-5476
http://www.unr.edu/nres
Gchat: jgrn307 at gmail.com, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180821/e365ba0d/attachment.html>

From david.serret at eigendynamics.com  Tue Aug 28 03:49:51 2018
From: david.serret at eigendynamics.com (David Serret Mayer)
Date: Tue, 28 Aug 2018 12:49:51 +0200
Subject: [pdal] C++ api questions
Message-ID: <CABo9JLmV4Yd_L6E6PugJORz2zuv3X0fubZ9ehMzMBgvMkaHeMA@mail.gmail.com>

I have two questions ,I am trying to use PDAL with the c++ API.


First, Is there a way to "parse" json directly into a stagefactory. That
would be great!


Second, how do I collect the output from the filter in this program


#include <pdal/PointView.hpp>
#include <pdal/PointTable.hpp>
#include <pdal/Dimension.hpp>
#include <pdal/Options.hpp>
#include <pdal/StageFactory.hpp>
#include <pdal/Filter.hpp>
#include <pdal/filters/ChipperFilter.hpp>
#include <pdal/filters/RandomizeFilter.hpp>
#include <pdal/filters/ApproximateCoplanarFilter.hpp>


#include <io/BufferReader.hpp>

#include <vector>

void fillView(pdal::PointViewPtr view)
{
    struct Point
    {
        double x;
        double y;
        double z;
    };

    for (int i = 0; i < 1000; ++i)
    {
        Point p;

        p.x = -93.0 + i*1;
        p.y = 42.0 + i*0.1;
        p.z = 106.0 + i;

        view->setField(pdal::Dimension::Id::X, i, p.x);
        view->setField(pdal::Dimension::Id::Y, i, p.y);
        view->setField(pdal::Dimension::Id::Z, i, p.z);
    }
}


int main(int argc, char* argv[])
{
    using namespace pdal;


    PointTable table;
    table.layout()->registerDim(Dimension::Id::X);
    table.layout()->registerDim(Dimension::Id::Y);
    table.layout()->registerDim(Dimension::Id::Z);

    PointViewPtr view(new PointView(table));

    fillView(view);

    ChipperFilter appr;
    Options options;

    options.add("knn",8);
    options.add("thresh1",25);
    options.add("thresh2",6);

    StageFactory factory;


    Stage *filter =  new( ApproximateCoplanarFilter );

    filter->setInput(appr);
    filter->setOptions(options);
    filter->prepare(table);
    filter->execute(table);

    PointViewPtr view2(new PointView(table));
    fillView(view2);

    std::cout << view2->size() << std::endl; // still 1000...
}



Thank you very much!

-- 
*David Serret *- R&D Engineer at Eigen Dynamics SL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180828/b384f0e9/attachment.html>

From howard at hobu.co  Tue Aug 28 08:05:43 2018
From: howard at hobu.co (Howard Butler)
Date: Tue, 28 Aug 2018 10:05:43 -0500
Subject: [pdal] C++ api questions
In-Reply-To: <CABo9JLmV4Yd_L6E6PugJORz2zuv3X0fubZ9ehMzMBgvMkaHeMA@mail.gmail.com>
References: <CABo9JLmV4Yd_L6E6PugJORz2zuv3X0fubZ9ehMzMBgvMkaHeMA@mail.gmail.com>
Message-ID: <46BB905C-7D93-4B01-8D7A-DDAC20F3C3C5@hobu.co>


> On Aug 28, 2018, at 5:49 AM, David Serret Mayer <david.serret at eigendynamics.com> wrote:
> 
> I have two questions ,I am trying to use PDAL with the c++ API.
> 
> 
> First, Is there a way to "parse" json directly into a stagefactory. That would be great!

There's a PipelineExecutor class that wraps thins up and makes it convenient to simply pass a pipeline to PDAL and get its output.


> Second, how do I collect the output from the filter in this program


Check out PipelineExecutor and see if that doesn't give you what you require for a high level API.

Howard

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 528 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180828/04fe6b51/attachment.sig>

From howard at hobu.co  Tue Aug 28 09:14:19 2018
From: howard at hobu.co (Howard Butler)
Date: Tue, 28 Aug 2018 11:14:19 -0500
Subject: [pdal] Conversion and alignment of voxels...
In-Reply-To: <CABG0rfvxtEU3zq-hEZBVkq28PdqyMm39OCy=4w_oC=x6_rq8Jw@mail.gmail.com>
References: <CABG0rfvxtEU3zq-hEZBVkq28PdqyMm39OCy=4w_oC=x6_rq8Jw@mail.gmail.com>
Message-ID: <a4bcda6b-8907-1a22-1b49-9eb3c4688000@hobu.co>



On 8/21/18 12:44 PM, Jonathan Greenberg wrote:
> Folks:
>
> I would like to do a voxelgrid type downsampling, but with the following
> tweaks and was hoping to see if PDAL could help:
>
> 1) Store the voxel center rather than the centroid of the points inside of
> it
> 2) Store stats on the points in a given voxel (e.g. count of points in a
> voxel)
> 3) Be able to set the origin point of the voxel rather than (what I am
> assuming) is e.g. the min x,y,z so I can "align" two different point clouds.
>
> The goal of this is to create the framework for looking at change detection
> within a given voxel.
>

Jonathan,

There isn't really anything specifically in PDAL to be able to do this,
but I have made some recent additions to the PDAL Python extension that
should make it possible for you to prototype and develop these kinds of
things yourself in that environment.


The PDAL 1.8.0 release (coming in September) will include the following
Python enhancements:


* Python extension will be able to pass numpy arrays to invoke in PDAL
pipelines for execution
* Python extension advertises PDAL's dimension types
https://pdal.io/dimensions.html
* Python readers.numpy can programmatically take in a reference to a
numpy array


Howard

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 528 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180828/f1e57c5b/attachment.sig>

From david.serret at eigendynamics.com  Wed Aug 29 06:29:29 2018
From: david.serret at eigendynamics.com (David Serret Mayer)
Date: Wed, 29 Aug 2018 15:29:29 +0200
Subject: [pdal] Using the pgpointcloud plugin.
Message-ID: <CABo9JLnDvH_jiR2NNCcNHZYhmTb6B6KNtcPH=jPWWFP9cFLEZA@mail.gmail.com>

Hello again,

I am now trying to use the PgReader and PgWriter. But I have also two
problems.


The first one is that the headers of PgReader and PgWriter (any of the
plugins really) are not installed with pdal, so I am sourcing them from the
folder where the project was cloned *for now*

The second one is configuring the CMakeLists file. The project uses a macro
but I can't figure out how to make it work.

Simply importing the file gives me a lot of compilation errors:

such as #include "libpq-fe.h" not found
and if I correct that with the proper <postgres/pq..... > header it gives
me some more errors about libxml

The tests of Pgwriter does indeed work btw.

#include <pdal/filters/ChipperFilter.hpp>
#include <io/BufferReader.hpp>
#include "~/db/pdal/plugins/pgpointcloud/io/PgCommon.hpp"
#include "~/db/pdal/plugins/pgpointcloud/io/PgWriter.hpp"


int main()
{
    using namespace pdal;
}

This is the Cmake I am using:

cmake_minimum_required(VERSION 2.8.12)
project(WritingTutorial)

find_package(PDAL 1.0.0 REQUIRED CONFIG)

link_directories( /usr/local/)
set(CMAKE_CXX_FLAGS "-std=c++11")
include_directories(
    ${PDAL_INCLUDE_DIRS}
    ${PDAL_INCLUDE_DIRS}/pdal
    /usr/include/jsoncpp)

add_executable(chipper chipper.cpp)
target_link_libraries(chipper
  ${PDAL_LIBRARIES}
  )


add_executable(database db.cpp)
target_link_libraries(database
  ${PDAL_LIBRARIES}
  )


It is obvious that is is not designed to work like this.
Thank you for your help guys!








-- 
*David Serret *- R&D Engineer at Eigen Dynamics SL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180829/26562b59/attachment.html>

From howard at hobu.co  Wed Aug 29 07:27:26 2018
From: howard at hobu.co (Howard Butler)
Date: Wed, 29 Aug 2018 09:27:26 -0500
Subject: [pdal] Using the pgpointcloud plugin.
In-Reply-To: <CABo9JLnDvH_jiR2NNCcNHZYhmTb6B6KNtcPH=jPWWFP9cFLEZA@mail.gmail.com>
References: <CABo9JLnDvH_jiR2NNCcNHZYhmTb6B6KNtcPH=jPWWFP9cFLEZA@mail.gmail.com>
Message-ID: <de565c65-e9a1-f56d-a627-9898227bc1d6@hobu.co>



On 8/29/18 8:29 AM, David Serret Mayer wrote:
> Hello again,
>
> I am now trying to use the PgReader and PgWriter. But I have also two
> problems.

Is there a reason you want to use the concrete implementations rather
than PipelineManager and a JSON-specified pipeline? The latter is going
to be *way* easier and more flexible, and you'll be swimming with the
current rather than against it.

> The first one is that the headers of PgReader and PgWriter (any of the
> plugins really) are not installed with pdal, so I am sourcing them from the
> folder where the project was cloned *for now*

Headers from plugins are not installed generally.

> It is obvious that is is not designed to work like this.
> Thank you for your help guys!

Things are designed so you generally shouldn't have to use the concrete
implementation classes at all. Was there a specific reason you were
headed down this path, or did you end up here because our docs missed
telling you this somewhere along the way?


Howard




-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 528 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180829/67cef806/attachment.sig>

From david.serret at eigendynamics.com  Thu Aug 30 06:51:01 2018
From: david.serret at eigendynamics.com (David Serret Mayer)
Date: Thu, 30 Aug 2018 15:51:01 +0200
Subject: [pdal] One last follow up.
Message-ID: <CABo9JLnjnXu_jmBbDKOZ_GcV=hB2EXObc9ANjXdJ9XyUyWoNUw@mail.gmail.com>

Hey there!

Hopefully this will be my last question, let see if I can finally get it
right.
I tried today to use the Pipeline manager as recommended. But I cant figure
out how to make it work with an reader.buffer type as input.

If I put the JSON like this:
{
  "pipeline":[
    {
      "type":"readers.buffer"
    },
    {
      "type":"filters.chipper",
      "capacity":"400"
    },
    {
      "type":"writers.pgpointcloud",
      "connection":"dbname='lidar' user='user'"
    }
  ]
}

I get the error:  Couldn't create reader stage of type 'readers.buffer'.


If I stage the buffer as seen on SmoothKernel.cpp y get the same error.
....
    PipelineManager mgr;
    mgr.readPipeline("../p.json");


        BufferReader& bufferReader =
                dynamic_cast<BufferReader&>(mgr.makeReader("",
"readers.buffer"));
                        bufferReader.addView(view);
      mgr.prepare();
    mgr.execute();
....

This is the program I am working on right now:

#include <pdal/filters/ChipperFilter.hpp>
#include <io/BufferReader.hpp>
#include <io/BufferReader.hpp>

#include <pdal/Kernel.hpp>
#include <pdal/pdal_export.hpp>
#include <pdal/util/FileUtils.hpp>

#include<pdal/PipelineReaderJSON.hpp>
//#include <pdal/plugins/pgpointcloud/io/PgCommon.hpp">

#include <memory>
#include <vector>

#include <pdal/PDALUtils.hpp>
#include <pdal/StageFactory.hpp>
#include <pdal/PipelineExecutor.hpp>
#include <pdal/util/FileUtils.hpp>

void fillView(pdal::PointViewPtr view)
{
    struct Point
    {
        double x;
        double y;
        double z;
    };

    for (float i = 0; i < 10000; i += 1.0)
    {
        Point p;

        p.x = -93.0 + i*0.00000001*i;
        p.y = 42.0 + i*0.00001*i*i;
        p.z = 106.0 + i;

        view->setField(pdal::Dimension::Id::X, i, p.x);
        view->setField(pdal::Dimension::Id::Y, i, p.y);
        view->setField(pdal::Dimension::Id::Z, i, p.z);
    }
}


int main()
{
    using namespace pdal;


    PointTable table;
    table.layout()->registerDim(Dimension::Id::X);
    table.layout()->registerDim(Dimension::Id::Y);
    table.layout()->registerDim(Dimension::Id::Z);

    PointViewPtr view(new PointView(table));
    fillView(view);
    BufferReader r;
    r.addView(view);


    PipelineManager mgr;
    mgr.readPipeline("../p.json");


    mgr.prepare();
    mgr.execute();
}

p.json is:

{
  "pipeline":[
    {"type":"readers.buffer"           <-wrong
    },
    {
      "type":"filters.chipper",
      "capacity":"400"
    },
    {
      "type":"writers.pgpointcloud",
      "connection":"dbname='lidar' user='user'"
    }
  ]
}

Again, thanks in advance for your help.



-- 
*David Serret *- R&D Engineer at Eigen Dynamics SL
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20180830/986c626c/attachment.html>

