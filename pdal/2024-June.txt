From patrick.rennich at aloftsensing.com  Sat Jun  1 08:45:23 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Sat, 1 Jun 2024 15:45:23 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Message-ID: <SN7PR20MB5239E9355BB827E5BAE6991083FD2@SN7PR20MB5239.namprd20.prod.outlook.com>

Hello,

I?m having trouble compiling PDAL from source on Mac OS when turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without this, but when I execute cmake as follows:

cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..

I get the following error message:

CMake Error at cmake/matlab.cmake:4 (find_library):
  Could not find Matlab using the following names:
Call Stack (most recent call first):
  plugins/matlab/CMakeLists.txt:3 (include)

Any help is much appreciated. Thanks.

Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240601/07eea91c/attachment.htm>

From patrick.rennich at aloftsensing.com  Mon Jun  3 06:41:05 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Mon, 3 Jun 2024 13:41:05 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Message-ID: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>

Hello,

I?m having trouble compiling PDAL from source on Mac OS when turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without this, but when I execute cmake as follows:

cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..

I get the following error message:

CMake Error at cmake/matlab.cmake:4 (find_library):
  Could not find Matlab using the following names:
Call Stack (most recent call first):
  plugins/matlab/CMakeLists.txt:3 (include)

Let me know if there?s any other info I can provide, and any help is much appreciated. Thanks.


Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/b6a8a327/attachment.htm>

From andrew.bell.ia at gmail.com  Mon Jun  3 06:48:27 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 3 Jun 2024 09:48:27 -0400
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
Message-ID: <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>

I have no access to Matlab and I don't know who does at this point.

Looking at the FindMatlab file, you might try just setting Matlab_ROOT_DIR
and lose the defines for the specific libraries. :shrug:

On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal <
pdal at lists.osgeo.org> wrote:

> Hello,
>
>
>
> I?m having trouble compiling PDAL from source on Mac OS when turning on
> the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without this, but when I
> execute cmake as follows:
>
>
>
> cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
> -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..
>
>
>
> I get the following error message:
>
>
>
> CMake Error at cmake/matlab.cmake:4 (find_library):
>
>   Could not find Matlab using the following names:
>
> Call Stack (most recent call first):
>
>   plugins/matlab/CMakeLists.txt:3 (include)
>
>
>
> Let me know if there?s any other info I can provide, and any help is much
> appreciated. Thanks.
>
>
>
>
>
> Patrick
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/1814e384/attachment-0001.htm>

From howard at hobu.co  Mon Jun  3 07:34:47 2024
From: howard at hobu.co (Howard Butler)
Date: Mon, 3 Jun 2024 09:34:47 -0500
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
Message-ID: <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>

I also no longer have access to Matlab but I remember the Find logic being extra finicky on MacOS with the frameworks and weird OSXisms that are possible. It might also be worth it to track down a more recent FindMatlab.cmake file out there.

> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal <pdal at lists.osgeo.org> wrote:
> 
> I have no access to Matlab and I don't know who does at this point.
> 
> Looking at the FindMatlab file, you might try just setting Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
> 
> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
>> Hello,
>> 
>>  
>> 
>> I?m having trouble compiling PDAL from source on Mac OS when turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without this, but when I execute cmake as follows:
>> 
>>  
>> 
>> cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64 -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..
>> 
>>  
>> 
>> I get the following error message:
>> 
>>  
>> 
>> CMake Error at cmake/matlab.cmake:4 (find_library):
>> 
>>   Could not find Matlab using the following names:
>> 
>> Call Stack (most recent call first):
>> 
>>   plugins/matlab/CMakeLists.txt:3 (include)
>> 
>>  
>> 
>> Let me know if there?s any other info I can provide, and any help is much appreciated. Thanks.
>> 
>>  
>> 
>>  
>> 
>> Patrick
>> 
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/pdal
> 
> 
> --
> Andrew Bell
> andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>_______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/63d94e98/attachment.htm>

From charles.karney at gmail.com  Mon Jun  3 07:49:19 2024
From: charles.karney at gmail.com (Charles Karney)
Date: Mon, 3 Jun 2024 10:49:19 -0400
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
Message-ID: <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>

Note well that the error is occurring in find_library(Matlab REQUIRED)
before it gets to find_package.  (But I don't know why find_library
is needed in addition to find_package.)

On 6/3/24 10:34, Howard Butler via pdal wrote:
> I also no longer have access to Matlab but I remember the Find logic 
> being extra finicky on MacOS with the frameworks and weird OSXisms that 
> are possible. It might also be worth it to track down a more recent 
> FindMatlab.cmake file out there.
> 
>> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal 
>> <pdal at lists.osgeo.org> wrote:
>>
>> I have no access to Matlab and I don't know who does at this point.
>>
>> Looking at the FindMatlab file, you might try just setting 
>> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
>>
>> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal 
>> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
>>
>>     Hello,____
>>
>>     ____
>>
>>     I?m having trouble compiling PDAL from source on Mac OS when
>>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
>>     this, but when I execute cmake as follows:____
>>
>>     ____
>>
>>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
>>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
>>
>>     ____
>>
>>     I get the following error message:____
>>
>>     ____
>>
>>     CMake Error at cmake/matlab.cmake:4 (find_library):____
>>
>>     ? Could not find Matlab using the following names:____
>>
>>     Call Stack (most recent call first):____
>>
>>     ? plugins/matlab/CMakeLists.txt:3 (include)____
>>
>>     ____
>>
>>     Let me know if there?s any other info I can provide, and any help
>>     is much appreciated. Thanks.____
>>
>>     __ __
>>
>>     __ __
>>
>>     Patrick

From patrick.rennich at aloftsensing.com  Mon Jun  3 08:06:39 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Mon, 3 Jun 2024 15:06:39 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
Message-ID: <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>

Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.

Patrick

From: pdal <pdal-bounces at lists.osgeo.org> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org>
Date: Monday, June 3, 2024 at 10:50?AM
To: pdal at lists.osgeo.org <pdal at lists.osgeo.org>
Cc: Charles Karney <charles.karney at gmail.com>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Note well that the error is occurring in find_library(Matlab REQUIRED)
before it gets to find_package.  (But I don't know why find_library
is needed in addition to find_package.)

On 6/3/24 10:34, Howard Butler via pdal wrote:
> I also no longer have access to Matlab but I remember the Find logic
> being extra finicky on MacOS with the frameworks and weird OSXisms that
> are possible. It might also be worth it to track down a more recent
> FindMatlab.cmake file out there.
>
>> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
>> <pdal at lists.osgeo.org> wrote:
>>
>> I have no access to Matlab and I don't know who does at this point.
>>
>> Looking at the FindMatlab file, you might try just setting
>> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
>>
>> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
>> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
>>
>>     Hello,____
>>
>>     ____
>>
>>     I?m having trouble compiling PDAL from source on Mac OS when
>>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
>>     this, but when I execute cmake as follows:____
>>
>>     ____
>>
>>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
>>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
>>
>>     ____
>>
>>     I get the following error message:____
>>
>>     ____
>>
>>     CMake Error at cmake/matlab.cmake:4 (find_library):____
>>
>>       Could not find Matlab using the following names:____
>>
>>     Call Stack (most recent call first):____
>>
>>       plugins/matlab/CMakeLists.txt:3 (include)____
>>
>>     ____
>>
>>     Let me know if there?s any other info I can provide, and any help
>>     is much appreciated. Thanks.____
>>
>>     __ __
>>
>>     __ __
>>
>>     Patrick
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/90053154/attachment-0001.htm>

From howard at hobu.co  Mon Jun  3 08:08:50 2024
From: howard at hobu.co (Howard Butler)
Date: Mon, 3 Jun 2024 10:08:50 -0500
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
Message-ID: <AC5652ED-7C9C-4A51-89A7-2E4178E2AD57@hobu.co>

You can sometimes figure out what's going on by adding --debug-find to your CMake invocation (caution that it's noisy!)

> On Jun 3, 2024, at 10:06?AM, Patrick Rennich via pdal <pdal at lists.osgeo.org> wrote:
> 
> Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.
>  
> Patrick
>  
> From: pdal <pdal-bounces at lists.osgeo.org> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org>
> Date: Monday, June 3, 2024 at 10:50?AM
> To: pdal at lists.osgeo.org <pdal at lists.osgeo.org>
> Cc: Charles Karney <charles.karney at gmail.com>
> Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
> 
> Note well that the error is occurring in find_library(Matlab REQUIRED)
> before it gets to find_package.  (But I don't know why find_library
> is needed in addition to find_package.)
> 
> On 6/3/24 10:34, Howard Butler via pdal wrote:
> > I also no longer have access to Matlab but I remember the Find logic 
> > being extra finicky on MacOS with the frameworks and weird OSXisms that 
> > are possible. It might also be worth it to track down a more recent 
> > FindMatlab.cmake file out there.
> > 
> >> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
> >> <pdal at lists.osgeo.org> wrote:
> >>
> >> I have no access to Matlab and I don't know who does at this point.
> >>
> >> Looking at the FindMatlab file, you might try just setting 
> >> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
> >>
> >> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
> >> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
> >>
> >>     Hello,____
> >>
> >>     ____
> >>
> >>     I?m having trouble compiling PDAL from source on Mac OS when
> >>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
> >>     this, but when I execute cmake as follows:____
> >>
> >>     ____
> >>
> >>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
> >>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
> >>
> >>     ____
> >>
> >>     I get the following error message:____
> >>
> >>     ____
> >>
> >>     CMake Error at cmake/matlab.cmake:4 (find_library):____
> >>
> >>       Could not find Matlab using the following names:____
> >>
> >>     Call Stack (most recent call first):____
> >>
> >>       plugins/matlab/CMakeLists.txt:3 (include)____
> >>
> >>     ____
> >>
> >>     Let me know if there?s any other info I can provide, and any help
> >>     is much appreciated. Thanks.____
> >>
> >>     __ __
> >>
> >>     __ __
> >>
> >>     Patrick
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/93737b9e/attachment.htm>

From andrew.bell.ia at gmail.com  Mon Jun  3 08:45:17 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 3 Jun 2024 11:45:17 -0400
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
Message-ID: <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>

This doesn't seem to have anything to do with PDAL, so I would do the
normal debug process of making a simple reproducer. In this case that means
using the most basic CMakeLists.txt that requires matlab and debug that. If
you can recreate the error with something simple, you should be able to ask
questions elsewhere to resolve the issue of go through it until you can
figure it out.

On Mon, Jun 3, 2024 at 11:07?AM Patrick Rennich via pdal <
pdal at lists.osgeo.org> wrote:

> Thanks for the pointers. I pulled the latest FindMatlab.cmake from the
> cmake repository. This latest file has updates for Matlab 2024a which is
> what I?m using, but it doesn?t seem to help. I still get the same error.
>
>
>
> Patrick
>
>
>
> *From: *pdal <pdal-bounces at lists.osgeo.org> on behalf of Charles Karney
> via pdal <pdal at lists.osgeo.org>
> *Date: *Monday, June 3, 2024 at 10:50?AM
> *To: *pdal at lists.osgeo.org <pdal at lists.osgeo.org>
> *Cc: *Charles Karney <charles.karney at gmail.com>
> *Subject: *Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
>
> Note well that the error is occurring in find_library(Matlab REQUIRED)
> before it gets to find_package.  (But I don't know why find_library
> is needed in addition to find_package.)
>
> On 6/3/24 10:34, Howard Butler via pdal wrote:
> > I also no longer have access to Matlab but I remember the Find logic
> > being extra finicky on MacOS with the frameworks and weird OSXisms that
> > are possible. It might also be worth it to track down a more recent
> > FindMatlab.cmake file out there.
> >
> >> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
> >> <pdal at lists.osgeo.org> wrote:
> >>
> >> I have no access to Matlab and I don't know who does at this point.
> >>
> >> Looking at the FindMatlab file, you might try just setting
> >> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
> >>
> >> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
> >> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org
> <pdal at lists.osgeo.org>>> wrote:
> >>
> >>     Hello,____
> >>
> >>     ____
> >>
> >>     I?m having trouble compiling PDAL from source on Mac OS when
> >>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
> >>     this, but when I execute cmake as follows:____
> >>
> >>     ____
> >>
> >>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
> >>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>
> -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
> >>
> >>     ____
> >>
> >>     I get the following error message:____
> >>
> >>     ____
> >>
> >>     CMake Error at cmake/matlab.cmake:4 (find_library):____
> >>
> >>       Could not find Matlab using the following names:____
> >>
> >>     Call Stack (most recent call first):____
> >>
> >>       plugins/matlab/CMakeLists.txt:3 (include)____
> >>
> >>     ____
> >>
> >>     Let me know if there?s any other info I can provide, and any help
> >>     is much appreciated. Thanks.____
> >>
> >>     __ __
> >>
> >>     __ __
> >>
> >>     Patrick
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/8a366e19/attachment-0001.htm>

From patrick.rennich at aloftsensing.com  Mon Jun  3 08:55:27 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Mon, 3 Jun 2024 15:55:27 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>
Message-ID: <SN7PR20MB523977ECD2DDEE4A69B607C583FF2@SN7PR20MB5239.namprd20.prod.outlook.com>

Makes sense. I?ll debug on my end and report back when fixed.

From: Andrew Bell <andrew.bell.ia at gmail.com>
Date: Monday, June 3, 2024 at 11:45?AM
To: Patrick Rennich <patrick.rennich at aloftsensing.com>
Cc: karney at alum.mit.edu <karney at alum.mit.edu>, pdal at lists.osgeo.org <pdal at lists.osgeo.org>, Charles Karney <charles.karney at gmail.com>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
This doesn't seem to have anything to do with PDAL, so I would do the normal debug process of making a simple reproducer. In this case that means using the most basic CMakeLists.txt that requires matlab and debug that. If you can recreate the error with something simple, you should be able to ask questions elsewhere to resolve the issue of go through it until you can figure it out.

On Mon, Jun 3, 2024 at 11:07?AM Patrick Rennich via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.

Patrick

From: pdal <pdal-bounces at lists.osgeo.org<mailto:pdal-bounces at lists.osgeo.org>> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Date: Monday, June 3, 2024 at 10:50?AM
To: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Cc: Charles Karney <charles.karney at gmail.com<mailto:charles.karney at gmail.com>>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Note well that the error is occurring in find_library(Matlab REQUIRED)
before it gets to find_package.  (But I don't know why find_library
is needed in addition to find_package.)

On 6/3/24 10:34, Howard Butler via pdal wrote:
> I also no longer have access to Matlab but I remember the Find logic
> being extra finicky on MacOS with the frameworks and weird OSXisms that
> are possible. It might also be worth it to track down a more recent
> FindMatlab.cmake file out there.
>
>> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
>>
>> I have no access to Matlab and I don't know who does at this point.
>>
>> Looking at the FindMatlab file, you might try just setting
>> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
>>
>> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <mailto:pdal at lists.osgeo.org>> wrote:
>>
>>     Hello,____
>>
>>     ____
>>
>>     I?m having trouble compiling PDAL from source on Mac OS when
>>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
>>     this, but when I execute cmake as follows:____
>>
>>     ____
>>
>>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
>>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
>>
>>     ____
>>
>>     I get the following error message:____
>>
>>     ____
>>
>>     CMake Error at cmake/matlab.cmake:4 (find_library):____
>>
>>       Could not find Matlab using the following names:____
>>
>>     Call Stack (most recent call first):____
>>
>>       plugins/matlab/CMakeLists.txt:3 (include)____
>>
>>     ____
>>
>>     Let me know if there?s any other info I can provide, and any help
>>     is much appreciated. Thanks.____
>>
>>     __ __
>>
>>     __ __
>>
>>     Patrick
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal


--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240603/3920e839/attachment.htm>

From patrick.rennich at aloftsensing.com  Tue Jun  4 08:00:57 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Tue, 4 Jun 2024 15:00:57 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <SN7PR20MB523977ECD2DDEE4A69B607C583FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>
 <SN7PR20MB523977ECD2DDEE4A69B607C583FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
Message-ID: <SN7PR20MB52393FA4A514B301081BE16483F82@SN7PR20MB5239.namprd20.prod.outlook.com>

Ok, so here?s what I had to do to get things to compile with BUILD_PLUGIN_MATLAB=ON on macOS:


  1.  In matlab.cmake, I commented out the find_library(Matlab REQUIRED) directive.
  2.  Replaced FindMatlab.cmake with the latest version from https://github.com/Kitware/CMake/
  3.  Added FindPackageHandleStandardArgs.cmake and FindPackageMessage.cmake also from https://github.com/Kitware/CMake/

The command

% cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON ..

now finds and configures things properly, and ninja builds the executables. I tested by modifying the ?Reading data from EPT? tutorial to write to a MAT file instead of a GeoTIFF and then loaded this file into Matlab.

Success!

Patrick

From: Patrick Rennich <patrick.rennich at aloftsensing.com>
Date: Monday, June 3, 2024 at 11:55?AM
To: pdal at lists.osgeo.org <pdal at lists.osgeo.org>
Cc: karney at alum.mit.edu <karney at alum.mit.edu>, Charles Karney <charles.karney at gmail.com>, Andrew Bell <andrew.bell.ia at gmail.com>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Makes sense. I?ll debug on my end and report back when fixed.

From: Andrew Bell <andrew.bell.ia at gmail.com>
Date: Monday, June 3, 2024 at 11:45?AM
To: Patrick Rennich <patrick.rennich at aloftsensing.com>
Cc: karney at alum.mit.edu <karney at alum.mit.edu>, pdal at lists.osgeo.org <pdal at lists.osgeo.org>, Charles Karney <charles.karney at gmail.com>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
This doesn't seem to have anything to do with PDAL, so I would do the normal debug process of making a simple reproducer. In this case that means using the most basic CMakeLists.txt that requires matlab and debug that. If you can recreate the error with something simple, you should be able to ask questions elsewhere to resolve the issue of go through it until you can figure it out.

On Mon, Jun 3, 2024 at 11:07?AM Patrick Rennich via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.

Patrick

From: pdal <pdal-bounces at lists.osgeo.org<mailto:pdal-bounces at lists.osgeo.org>> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Date: Monday, June 3, 2024 at 10:50?AM
To: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Cc: Charles Karney <charles.karney at gmail.com<mailto:charles.karney at gmail.com>>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Note well that the error is occurring in find_library(Matlab REQUIRED)
before it gets to find_package.  (But I don't know why find_library
is needed in addition to find_package.)

On 6/3/24 10:34, Howard Butler via pdal wrote:
> I also no longer have access to Matlab but I remember the Find logic
> being extra finicky on MacOS with the frameworks and weird OSXisms that
> are possible. It might also be worth it to track down a more recent
> FindMatlab.cmake file out there.
>
>> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
>>
>> I have no access to Matlab and I don't know who does at this point.
>>
>> Looking at the FindMatlab file, you might try just setting
>> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
>>
>> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <mailto:pdal at lists.osgeo.org>> wrote:
>>
>>     Hello,____
>>
>>     ____
>>
>>     I?m having trouble compiling PDAL from source on Mac OS when
>>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
>>     this, but when I execute cmake as follows:____
>>
>>     ____
>>
>>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
>>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
>>
>>     ____
>>
>>     I get the following error message:____
>>
>>     ____
>>
>>     CMake Error at cmake/matlab.cmake:4 (find_library):____
>>
>>       Could not find Matlab using the following names:____
>>
>>     Call Stack (most recent call first):____
>>
>>       plugins/matlab/CMakeLists.txt:3 (include)____
>>
>>     ____
>>
>>     Let me know if there?s any other info I can provide, and any help
>>     is much appreciated. Thanks.____
>>
>>     __ __
>>
>>     __ __
>>
>>     Patrick
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal


--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240604/fb056115/attachment-0001.htm>

From howard at hobu.co  Tue Jun  4 08:04:42 2024
From: howard at hobu.co (Howard Butler)
Date: Tue, 4 Jun 2024 10:04:42 -0500
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <SN7PR20MB52393FA4A514B301081BE16483F82@SN7PR20MB5239.namprd20.prod.outlook.com>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>
 <SN7PR20MB523977ECD2DDEE4A69B607C583FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <SN7PR20MB52393FA4A514B301081BE16483F82@SN7PR20MB5239.namprd20.prod.outlook.com>
Message-ID: <08B6155E-5FDF-4B94-9CE8-34336014772F@hobu.co>

Patrick,

Can you please roll up a pull request with everything you needed to get Matlab going? The next person who comes along will very much appreciate it.

Howard

> On Jun 4, 2024, at 10:00?AM, Patrick Rennich via pdal <pdal at lists.osgeo.org> wrote:
> 
> Ok, so here?s what I had to do to get things to compile with BUILD_PLUGIN_MATLAB=ON on macOS:
>  
> In matlab.cmake, I commented out the find_library(Matlab REQUIRED) directive.
> Replaced FindMatlab.cmake with the latest version fromhttps://github.com/Kitware/CMake/
> Added FindPackageHandleStandardArgs.cmake and FindPackageMessage.cmake also from https://github.com/Kitware/CMake/
>  
> The command 
>  
> % cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON ..
>  
> now finds and configures things properly, and ninja builds the executables. I tested by modifying the ?Reading data from EPT? tutorial to write to a MAT file instead of a GeoTIFF and then loaded this file into Matlab.
>  
> Success!
>  
> Patrick
>  
> From: Patrick Rennich <patrick.rennich at aloftsensing.com <mailto:patrick.rennich at aloftsensing.com>>
> Date: Monday, June 3, 2024 at 11:55?AM
> To: pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>>
> Cc: karney at alum.mit.edu <mailto:karney at alum.mit.edu> <karney at alum.mit.edu <mailto:karney at alum.mit.edu>>, Charles Karney <charles.karney at gmail.com <mailto:charles.karney at gmail.com>>, Andrew Bell <andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>>
> Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
> 
> Makes sense. I?ll debug on my end and report back when fixed.
>  
> From: Andrew Bell <andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>>
> Date: Monday, June 3, 2024 at 11:45?AM
> To: Patrick Rennich <patrick.rennich at aloftsensing.com <mailto:patrick.rennich at aloftsensing.com>>
> Cc: karney at alum.mit.edu <mailto:karney at alum.mit.edu> <karney at alum.mit.edu <mailto:karney at alum.mit.edu>>, pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org><pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>>, Charles Karney <charles.karney at gmail.com <mailto:charles.karney at gmail.com>>
> Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
> 
> This doesn't seem to have anything to do with PDAL, so I would do the normal debug process of making a simple reproducer. In this case that means using the most basic CMakeLists.txt that requires matlab and debug that. If you can recreate the error with something simple, you should be able to ask questions elsewhere to resolve the issue of go through it until you can figure it out.
>  
> On Mon, Jun 3, 2024 at 11:07?AM Patrick Rennich via pdal <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
> Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.
>  
> Patrick
>  
> From: pdal <pdal-bounces at lists.osgeo.org <mailto:pdal-bounces at lists.osgeo.org>> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>>
> Date: Monday, June 3, 2024 at 10:50?AM
> To: pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>>
> Cc: Charles Karney <charles.karney at gmail.com <mailto:charles.karney at gmail.com>>
> Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
> 
> Note well that the error is occurring in find_library(Matlab REQUIRED)
> before it gets to find_package.  (But I don't know why find_library
> is needed in addition to find_package.)
> 
> On 6/3/24 10:34, Howard Butler via pdal wrote:
> > I also no longer have access to Matlab but I remember the Find logic 
> > being extra finicky on MacOS with the frameworks and weird OSXisms that 
> > are possible. It might also be worth it to track down a more recent 
> > FindMatlab.cmake file out there.
> > 
> >> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
> >> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>> wrote:
> >>
> >> I have no access to Matlab and I don't know who does at this point.
> >>
> >> Looking at the FindMatlab file, you might try just setting 
> >> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
> >>
> >> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
> >> <pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org> <mailto:pdal at lists.osgeo.org>> wrote:
> >>
> >>     Hello,____
> >>
> >>     ____
> >>
> >>     I?m having trouble compiling PDAL from source on Mac OS when
> >>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
> >>     this, but when I execute cmake as follows:____
> >>
> >>     ____
> >>
> >>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
> >>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
> >>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
> >>
> >>     ____
> >>
> >>     I get the following error message:____
> >>
> >>     ____
> >>
> >>     CMake Error at cmake/matlab.cmake:4 (find_library):____
> >>
> >>       Could not find Matlab using the following names:____
> >>
> >>     Call Stack (most recent call first):____
> >>
> >>       plugins/matlab/CMakeLists.txt:3 (include)____
> >>
> >>     ____
> >>
> >>     Let me know if there?s any other info I can provide, and any help
> >>     is much appreciated. Thanks.____
> >>
> >>     __ __
> >>
> >>     __ __
> >>
> >>     Patrick
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/pdal
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/pdal
> 
>  
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>_______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org <mailto:pdal at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240604/aab57698/attachment-0001.htm>

From patrick.rennich at aloftsensing.com  Tue Jun  4 09:33:35 2024
From: patrick.rennich at aloftsensing.com (Patrick Rennich)
Date: Tue, 4 Jun 2024 16:33:35 +0000
Subject: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
In-Reply-To: <08B6155E-5FDF-4B94-9CE8-34336014772F@hobu.co>
References: <SN7PR20MB5239BF9873AA54564D54B77A83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z1KH7X_PkcWGE7xDAMP3-HykcD3SY=cHC8KXcmGHA6SEg@mail.gmail.com>
 <FE2386E3-FB92-422F-8B28-59CA97625139@hobu.co>
 <d9555b1e-b987-40e4-be4d-d0a1df686969@alum.mit.edu>
 <SN7PR20MB523986F3520FADF72A851F4F83FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <CACJ51z2kkuGngGOUTtKuzP_Sh9mFL2ZfpVJJxcMda11oe+d2CA@mail.gmail.com>
 <SN7PR20MB523977ECD2DDEE4A69B607C583FF2@SN7PR20MB5239.namprd20.prod.outlook.com>
 <SN7PR20MB52393FA4A514B301081BE16483F82@SN7PR20MB5239.namprd20.prod.outlook.com>
 <08B6155E-5FDF-4B94-9CE8-34336014772F@hobu.co>
Message-ID: <SN7PR20MB52393DD0EFDAAF2254DF589383F82@SN7PR20MB5239.namprd20.prod.outlook.com>

Happy to do it, but I may need a bit of hand holding. I?m not a software developer or computer scientist, and I?ve never done a ?pull request? before. I?ve just now read up on the Contributing and Pull Requests pages, so I?ll make a topic branch and then go from there?

Patrick

From: Howard Butler <howard at hobu.co>
Date: Tuesday, June 4, 2024 at 11:05?AM
To: Patrick Rennich <patrick.rennich at aloftsensing.com>
Cc: pdal at lists.osgeo.org <pdal at lists.osgeo.org>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Patrick,

Can you please roll up a pull request with everything you needed to get Matlab going? The next person who comes along will very much appreciate it.

Howard


On Jun 4, 2024, at 10:00?AM, Patrick Rennich via pdal <pdal at lists.osgeo.org> wrote:

Ok, so here?s what I had to do to get things to compile with BUILD_PLUGIN_MATLAB=ON on macOS:


  1.  In matlab.cmake, I commented out the find_library(Matlab REQUIRED) directive.
  2.  Replaced FindMatlab.cmake with the latest version fromhttps://github.com/Kitware/CMake/
  3.  Added FindPackageHandleStandardArgs.cmake and FindPackageMessage.cmake also from https://github.com/Kitware/CMake/

The command

% cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON ..

now finds and configures things properly, and ninja builds the executables. I tested by modifying the ?Reading data from EPT? tutorial to write to a MAT file instead of a GeoTIFF and then loaded this file into Matlab.

Success!

Patrick

From: Patrick Rennich <patrick.rennich at aloftsensing.com<mailto:patrick.rennich at aloftsensing.com>>
Date: Monday, June 3, 2024 at 11:55?AM
To: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Cc: karney at alum.mit.edu<mailto:karney at alum.mit.edu> <karney at alum.mit.edu<mailto:karney at alum.mit.edu>>, Charles Karney <charles.karney at gmail.com<mailto:charles.karney at gmail.com>>, Andrew Bell <andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Makes sense. I?ll debug on my end and report back when fixed.

From: Andrew Bell <andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>>
Date: Monday, June 3, 2024 at 11:45?AM
To: Patrick Rennich <patrick.rennich at aloftsensing.com<mailto:patrick.rennich at aloftsensing.com>>
Cc: karney at alum.mit.edu<mailto:karney at alum.mit.edu> <karney at alum.mit.edu<mailto:karney at alum.mit.edu>>, pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org><pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>, Charles Karney <charles.karney at gmail.com<mailto:charles.karney at gmail.com>>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
This doesn't seem to have anything to do with PDAL, so I would do the normal debug process of making a simple reproducer. In this case that means using the most basic CMakeLists.txt that requires matlab and debug that. If you can recreate the error with something simple, you should be able to ask questions elsewhere to resolve the issue of go through it until you can figure it out.

On Mon, Jun 3, 2024 at 11:07?AM Patrick Rennich via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
Thanks for the pointers. I pulled the latest FindMatlab.cmake from the cmake repository. This latest file has updates for Matlab 2024a which is what I?m using, but it doesn?t seem to help. I still get the same error.

Patrick

From: pdal <pdal-bounces at lists.osgeo.org<mailto:pdal-bounces at lists.osgeo.org>> on behalf of Charles Karney via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Date: Monday, June 3, 2024 at 10:50?AM
To: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>>
Cc: Charles Karney <charles.karney at gmail.com<mailto:charles.karney at gmail.com>>
Subject: Re: [pdal] Trouble compiling PDAL with MATLAB Plugin on Mac OS
Note well that the error is occurring in find_library(Matlab REQUIRED)
before it gets to find_package.  (But I don't know why find_library
is needed in addition to find_package.)

On 6/3/24 10:34, Howard Butler via pdal wrote:
> I also no longer have access to Matlab but I remember the Find logic
> being extra finicky on MacOS with the frameworks and weird OSXisms that
> are possible. It might also be worth it to track down a more recent
> FindMatlab.cmake file out there.
>
>> On Jun 3, 2024, at 8:48?AM, Andrew Bell via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
>>
>> I have no access to Matlab and I don't know who does at this point.
>>
>> Looking at the FindMatlab file, you might try just setting
>> Matlab_ROOT_DIR and lose the defines for the specific libraries. :shrug:
>>
>> On Mon, Jun 3, 2024 at 9:41?AM Patrick Rennich via pdal
>> <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org> <mailto:pdal at lists.osgeo.org>> wrote:
>>
>>     Hello,____
>>
>>     ____
>>
>>     I?m having trouble compiling PDAL from source on Mac OS when
>>     turning on the BUILD_MATLAB_PLUGIN=ON. PDAL compiles fine without
>>     this, but when I execute cmake as follows:____
>>
>>     ____
>>
>>     cmake -G Ninja -DBUILD_PLUGIN_MATLAB=ON
>>     -DMatlab_MX_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_MAT_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_ENG_LIBRARY=/Applications/MATLAB_R2024a.app/bin/maca64
>>     -DMatlab_INCLUDE_DIRS=/Applications/MATLAB_R2024a.app/extern/include ..____
>>
>>     ____
>>
>>     I get the following error message:____
>>
>>     ____
>>
>>     CMake Error at cmake/matlab.cmake:4 (find_library):____
>>
>>       Could not find Matlab using the following names:____
>>
>>     Call Stack (most recent call first):____
>>
>>       plugins/matlab/CMakeLists.txt:3 (include)____
>>
>>     ____
>>
>>     Let me know if there?s any other info I can provide, and any help
>>     is much appreciated. Thanks.____
>>
>>     __ __
>>
>>     __ __
>>
>>     Patrick
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal


--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240604/0d1fabe9/attachment-0001.htm>

From syefimov at ptfs.com  Fri Jun  7 14:33:06 2024
From: syefimov at ptfs.com (Sergey Yefimov)
Date: Fri, 7 Jun 2024 21:33:06 +0000
Subject: [pdal] las to geotif
Message-ID: <PH7PR10MB63108F8963542A23542B432BB0FB2@PH7PR10MB6310.namprd10.prod.outlook.com>

Hi,
I try to convert las to geotiff using this pipeline

"pipeline":[
??????{"type" : "readers.las",
??????"filename":"C:\\KVData\\source\\las\\test.las"
??????},
??????{
????????????"type":"writers.gdal",
????????????"filename":"C:/KVData/source/tiff/ttest.tif",
????????????"resolution":1.0,
????????????"output_type":"all",
????????????"gdaldriver":"GTiff"
??????}
    ]

After conversion invalid 2 KB tiff file created. las info:

{
  "file_size": 137422487,
  "filename": "C:\\KVData\\source\\las\\test.las",
  "now": "2024-06-07T17:09:19-0400",
  "pdal_version": "2.7.1 (git-version: Release)",
  "reader": "readers.las",
  "stats":
  {
    "bbox":
    {
      "EPSG:4326":
      {
        "bbox":
        {
          "maxx": -75.606374,
          "maxy": 35.9592838,
          "maxz": 29.71,
          "minx": -75.6350255,
          "miny": 35.942234,
          "minz": -11.88
        },
        "boundary": { "type": "Polygon", "coordinates": [ [ [ -75.6350255, 35.942234, -11.88 ], [ -75.6350255, 35.9592838, -11.88 ], [ -75.606374, 35.9592838, 29.71 ], [ -75.606374, 35.942234, 29.71 ], [ -75.6350255, 35.942234, -11.88 ] ] ] }
      }, ..
"statistic":
    [
      {
        "average": -75.62226764,
        "count": 4907929,
        "maximum": -75.606374,
        "minimum": -75.6350255,
        "name": "X",
        "position": 0,
        "stddev": 0.005315505055,
        "variance": 2.825459399e-05
      },
      {
        "average": 35.95136764,
        "count": 4907929,
        "maximum": 35.9592838,
        "minimum": 35.942234,
        "name": "Y",
        "position": 1,
        "stddev": 0.002706953159,
        "variance": 7.327595404e-06
      },..
}






| P | T | F | S |

Empowering Content

1801 Research Blvd

Suite 310

Rockville, MD  20850

301 654 8088 Ext 131

www.ptfs.com<http://www.ptfs.com/>

syefimov at ptfs.com<mailto:udoh at ptfs.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240607/81519d50/attachment-0001.htm>

From adam.d.steer at gmail.com  Fri Jun  7 16:22:39 2024
From: adam.d.steer at gmail.com (Adam Steer)
Date: Sat, 8 Jun 2024 09:22:39 +1000
Subject: [pdal] las to geotif
In-Reply-To: <PH7PR10MB63108F8963542A23542B432BB0FB2@PH7PR10MB6310.namprd10.prod.outlook.com>
References: <PH7PR10MB63108F8963542A23542B432BB0FB2@PH7PR10MB6310.namprd10.prod.outlook.com>
Message-ID: <CAFORoyiP3vJr3LJ-E8-2LCoW5h=qQ=FLPbyGFiwLquUQjwWW1A@mail.gmail.com>

Hi Sergey - try reprojecting your source las file into a projected (in
metres) system and running again.

PDAL/GDAL pass projections through. Your input data are in degrees, your
output resolution is interpreted as the same unit, so resolution 1.0 is
interpreted as '1 degree'.

Hope that helps,

Adam

--
Dr Adam Steer
https://spatialised.net
Available for consulting/open for headhunting

On Sat, Jun 8, 2024, 07:33 Sergey Yefimov via pdal <pdal at lists.osgeo.org>
wrote:

> Hi,
> I try to convert las to geotiff using this pipeline
>
> "pipeline":[
> {"type" : "readers.las",
> "filename":"C:\\KVData\\source\\las\\test.las"
> },
> {
> "type":"writers.gdal",
> "filename":"C:/KVData/source/tiff/ttest.tif",
> "resolution":1.0,
> "output_type":"all",
> "gdaldriver":"GTiff"
> }
>     ]
>
> After conversion invalid 2 KB tiff file created. las info:
>
> {
>   "file_size": 137422487,
>   "filename": "C:\\KVData\\source\\las\\test.las",
>   "now": "2024-06-07T17:09:19-0400",
>   "pdal_version": "2.7.1 (git-version: Release)",
>   "reader": "readers.las",
>   "stats":
>   {
>     "bbox":
>     {
>       "EPSG:4326":
>       {
>         "bbox":
>         {
>           "maxx": -75.606374,
>           "maxy": 35.9592838,
>           "maxz": 29.71,
>           "minx": -75.6350255,
>           "miny": 35.942234,
>           "minz": -11.88
>         },
>         "boundary": { "type": "Polygon", "coordinates": [ [ [ -75.6350255,
> 35.942234, -11.88 ], [ -75.6350255, 35.9592838, -11.88 ], [ -75.606374,
> 35.9592838, 29.71 ], [ -75.606374, 35.942234, 29.71 ], [ -75.6350255,
> 35.942234, -11.88 ] ] ] }
>       }, ..
> "statistic":
>     [
>       {
>         "average": -75.62226764,
>         "count": 4907929,
>         "maximum": -75.606374,
>         "minimum": -75.6350255,
>         "name": "X",
>         "position": 0,
>         "stddev": 0.005315505055,
>         "variance": 2.825459399e-05
>       },
>       {
>         "average": 35.95136764,
>         "count": 4907929,
>         "maximum": 35.9592838,
>         "minimum": 35.942234,
>         "name": "Y",
>         "position": 1,
>         "stddev": 0.002706953159,
>         "variance": 7.327595404e-06
>       },..
> }
>
>
>
>
>
> *|** P **|** T **|** F **|** S **|*
>
> Empowering Content
>
> 1801 Research Blvd
>
> Suite 310
>
> Rockville, MD  20850
>
> 301 654 8088 Ext 131
>
> www.ptfs.com
>
> syefimov at ptfs.com <udoh at ptfs.com>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240608/8571862c/attachment.htm>

From syefimov at ptfs.com  Fri Jun  7 18:17:02 2024
From: syefimov at ptfs.com (Sergey Yefimov)
Date: Sat, 8 Jun 2024 01:17:02 +0000
Subject: [pdal] las to geotif
In-Reply-To: <CAFORoyiP3vJr3LJ-E8-2LCoW5h=qQ=FLPbyGFiwLquUQjwWW1A@mail.gmail.com>
References: <PH7PR10MB63108F8963542A23542B432BB0FB2@PH7PR10MB6310.namprd10.prod.outlook.com>
 <CAFORoyiP3vJr3LJ-E8-2LCoW5h=qQ=FLPbyGFiwLquUQjwWW1A@mail.gmail.com>
Message-ID: <PH7PR10MB6310015FC78D78EC6EEBEA29B0C42@PH7PR10MB6310.namprd10.prod.outlook.com>

It helps. Thank you very much.
________________________________
From: Adam Steer <adam.d.steer at gmail.com>
Sent: Friday, June 7, 2024 7:22 PM
To: Sergey Yefimov <syefimov at ptfs.com>
Cc: pdal at lists.osgeo.org <pdal at lists.osgeo.org>
Subject: Re: [pdal] las to geotif

THIS EMAIL IS FROM AN UNTRUSTED EMAIL PROVIDER.


Hi Sergey - try reprojecting your source las file into a projected (in metres) system and running again.

PDAL/GDAL pass projections through. Your input data are in degrees, your output resolution is interpreted as the same unit, so resolution 1.0 is interpreted as '1 degree'.

Hope that helps,

Adam

--
Dr Adam Steer
https://spatialised.net<https://spatialised.net/>
Available for consulting/open for headhunting

On Sat, Jun 8, 2024, 07:33 Sergey Yefimov via pdal <pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>> wrote:
Hi,
I try to convert las to geotiff using this pipeline

"pipeline":[
??????{"type" : "readers.las",
??????"filename":"C:\\KVData\\source\\las\\test.las"
??????},
??????{
????????????"type":"writers.gdal",
????????????"filename":"C:/KVData/source/tiff/ttest.tif",
????????????"resolution":1.0,
????????????"output_type":"all",
????????????"gdaldriver":"GTiff"
??????}
    ]

After conversion invalid 2 KB tiff file created. las info:

{
  "file_size": 137422487,
  "filename": "C:\\KVData\\source\\las\\test.las",
  "now": "2024-06-07T17:09:19-0400",
  "pdal_version": "2.7.1 (git-version: Release)",
  "reader": "readers.las",
  "stats":
  {
    "bbox":
    {
      "EPSG:4326":
      {
        "bbox":
        {
          "maxx": -75.606374,
          "maxy": 35.9592838,
          "maxz": 29.71,
          "minx": -75.6350255,
          "miny": 35.942234,
          "minz": -11.88
        },
        "boundary": { "type": "Polygon", "coordinates": [ [ [ -75.6350255, 35.942234, -11.88 ], [ -75.6350255, 35.9592838, -11.88 ], [ -75.606374, 35.9592838, 29.71 ], [ -75.606374, 35.942234, 29.71 ], [ -75.6350255, 35.942234, -11.88 ] ] ] }
      }, ..
"statistic":
    [
      {
        "average": -75.62226764,
        "count": 4907929,
        "maximum": -75.606374,
        "minimum": -75.6350255,
        "name": "X",
        "position": 0,
        "stddev": 0.005315505055,
        "variance": 2.825459399e-05
      },
      {
        "average": 35.95136764,
        "count": 4907929,
        "maximum": 35.9592838,
        "minimum": 35.942234,
        "name": "Y",
        "position": 1,
        "stddev": 0.002706953159,
        "variance": 7.327595404e-06
      },..
}






| P | T | F | S |

Empowering Content

1801 Research Blvd

Suite 310

Rockville, MD  20850

301 654 8088 Ext 131

www.ptfs.com<http://www.ptfs.com/>

syefimov at ptfs.com<mailto:udoh at ptfs.com>

_______________________________________________
pdal mailing list
pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240608/9ff72c1d/attachment-0001.htm>

From j1 at jimenezshaw.com  Sat Jun  8 11:39:29 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Sat, 8 Jun 2024 20:39:29 +0200
Subject: [pdal] las to geotif
In-Reply-To: <PH7PR10MB6310015FC78D78EC6EEBEA29B0C42@PH7PR10MB6310.namprd10.prod.outlook.com>
References: <PH7PR10MB63108F8963542A23542B432BB0FB2@PH7PR10MB6310.namprd10.prod.outlook.com>
 <CAFORoyiP3vJr3LJ-E8-2LCoW5h=qQ=FLPbyGFiwLquUQjwWW1A@mail.gmail.com>
 <PH7PR10MB6310015FC78D78EC6EEBEA29B0C42@PH7PR10MB6310.namprd10.prod.outlook.com>
Message-ID: <CADRrdKt7rFTfr+7ZjPTzduDRg=ipprL2JG9oNdjx0J=_n-7X+A@mail.gmail.com>

I have seen point clouds in WGS84, and GeoTIFFs also in WGS84. Does it mean
that a point cloud in geographic coordinates is conceptually wrong? I find
it strange, but is it wrong? Why does PDAL care?

On Sat, 8 Jun 2024 at 03:17, Sergey Yefimov via pdal <pdal at lists.osgeo.org>
wrote:

> It helps. Thank you very much.
> ------------------------------
> *From:* Adam Steer <adam.d.steer at gmail.com>
> *Sent:* Friday, June 7, 2024 7:22 PM
> *To:* Sergey Yefimov <syefimov at ptfs.com>
> *Cc:* pdal at lists.osgeo.org <pdal at lists.osgeo.org>
> *Subject:* Re: [pdal] las to geotif
>
> THIS EMAIL IS FROM AN * UNTRUSTED* EMAIL PROVIDER.
>
> Hi Sergey - try reprojecting your source las file into a projected (in
> metres) system and running again.
>
> PDAL/GDAL pass projections through. Your input data are in degrees, your
> output resolution is interpreted as the same unit, so resolution 1.0 is
> interpreted as '1 degree'.
>
> Hope that helps,
>
> Adam
>
> --
> Dr Adam Steer
> https://spatialised.net
> Available for consulting/open for headhunting
>
> On Sat, Jun 8, 2024, 07:33 Sergey Yefimov via pdal <pdal at lists.osgeo.org>
> wrote:
>
> Hi,
> I try to convert las to geotiff using this pipeline
>
> "pipeline":[
> {"type" : "readers.las",
> "filename":"C:\\KVData\\source\\las\\test.las"
> },
> {
> "type":"writers.gdal",
> "filename":"C:/KVData/source/tiff/ttest.tif",
> "resolution":1.0,
> "output_type":"all",
> "gdaldriver":"GTiff"
> }
>     ]
>
> After conversion invalid 2 KB tiff file created. las info:
>
> {
>   "file_size": 137422487,
>   "filename": "C:\\KVData\\source\\las\\test.las",
>   "now": "2024-06-07T17:09:19-0400",
>   "pdal_version": "2.7.1 (git-version: Release)",
>   "reader": "readers.las",
>   "stats":
>   {
>     "bbox":
>     {
>       "EPSG:4326":
>       {
>         "bbox":
>         {
>           "maxx": -75.606374,
>           "maxy": 35.9592838,
>           "maxz": 29.71,
>           "minx": -75.6350255,
>           "miny": 35.942234,
>           "minz": -11.88
>         },
>         "boundary": { "type": "Polygon", "coordinates": [ [ [ -75.6350255,
> 35.942234, -11.88 ], [ -75.6350255, 35.9592838, -11.88 ], [ -75.606374,
> 35.9592838, 29.71 ], [ -75.606374, 35.942234, 29.71 ], [ -75.6350255,
> 35.942234, -11.88 ] ] ] }
>       }, ..
> "statistic":
>     [
>       {
>         "average": -75.62226764,
>         "count": 4907929,
>         "maximum": -75.606374,
>         "minimum": -75.6350255,
>         "name": "X",
>         "position": 0,
>         "stddev": 0.005315505055,
>         "variance": 2.825459399e-05
>       },
>       {
>         "average": 35.95136764,
>         "count": 4907929,
>         "maximum": 35.9592838,
>         "minimum": 35.942234,
>         "name": "Y",
>         "position": 1,
>         "stddev": 0.002706953159,
>         "variance": 7.327595404e-06
>       },..
> }
>
>
>
>
>
> *|** P **|** T **|** F **|** S **|*
>
> Empowering Content
>
> 1801 Research Blvd
>
> Suite 310
>
> Rockville, MD  20850
>
> 301 654 8088 Ext 131
>
> www.ptfs.com
>
> syefimov at ptfs.com <udoh at ptfs.com>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240608/f726709f/attachment.htm>

From michael.smith.erdc at gmail.com  Sat Jun  8 12:21:08 2024
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Sat, 8 Jun 2024 15:21:08 -0400
Subject: [pdal] las to geotif
In-Reply-To: <CADRrdKt7rFTfr+7ZjPTzduDRg=ipprL2JG9oNdjx0J=_n-7X+A@mail.gmail.com>
References: <CADRrdKt7rFTfr+7ZjPTzduDRg=ipprL2JG9oNdjx0J=_n-7X+A@mail.gmail.com>
Message-ID: <2AD28C8E-5663-464C-8B13-EF22AE01F1BB@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240608/537b0f10/attachment.htm>

From raul.casado at eez.csic.es  Thu Jun 20 01:17:18 2024
From: raul.casado at eez.csic.es (=?UTF-8?Q?Ra=C3=BAl_Casado_Barbero?=)
Date: Thu, 20 Jun 2024 10:17:18 +0200
Subject: [pdal] Calculation of the difference between DSM and DTM
Message-ID: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>

Hi,

my aim is to calculate the fitovolume of a shrub vegetation area. To do 
that I calculate the DSM, classify a point cloud with ground (2) and low 
vegetation (3) and then create a DTM.

I use 2 different pipelines (see below) to do that modified from this 
post <https://github.com/manaakiwhenua/pycrown/issues/18>. But I have 2 
issues:

  * When I calculate the difference between DSM and DTM I get negative
    values
  * The pixels of the DTM are horizontally displaced with respect to the
    DSM by half a pixel.

Does anyone know why I am getting these negative values using this 
pipelines? Is anything wrong in the pipelines I`m using?


Ra?l.

Pipeline for DSM:

[
 ?? ?"nubeRecortadaPdal_1.laz",
 ?? ?{
 ?? ???? "type": "filters.range",
 ?? ???? "limits":"returnnumber[1:1]"
 ?? ?},
 ?? ?{
 ?? ???? "type": "writers.gdal",
 ?? ???? "filename": "nubeRecortadaPdal_1_mds.tif",
 ??????? "output_type": "idw",
 ?? ???? "gdaldriver": "GTiff",
 ?? ???? "resolution": 0.05,
 ?? ???? "nodata": -9999,
 ?? ???? "radius": 0.07,
 ?? ???? "window_size": 50,
 ?? ???? "data_type": "float32"
 ?? ?}
]

Pipeline for DTM:

[
 ?? ?"nubeRecortadaPdal_1.laz",
 ?? ?{
 ?? ???? "type":"filters.overlay",
 ?? ???? "dimension":"Classification",
 ?? ???? "datasource":"D:/Datos/clasificadasVector.gpkg",
 ?? ???? "layer":"ndviRandomForest",
 ?? ???? "column":"Id"
 ?? ?},
 ?? ?{
 ?? ???? "type":"filters.range",
 ?? ???? "limits":"Classification[2:2]"
 ?? ?},
 ?? ?{
 ?? ???? "type": "writers.gdal",
 ?? ???? "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
 ??????? "output_type": "idw",
 ?? ???? "gdaldriver": "GTiff",
 ?? ???? "resolution": 0.05,
 ?? ???? "nodata": -9999,
 ?? ???? "radius": 0.07,
 ?? ???? "window_size": 100,
 ?? ???? "data_type": "float32"
 ?? ?}
]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240620/441fdbcf/attachment.htm>

From andrew.bell.ia at gmail.com  Thu Jun 20 04:45:37 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 20 Jun 2024 07:45:37 -0400
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
Message-ID: <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>

Hi Raul,

You should set the origin on writers.gdal in order to get the consistency
you desire. Without this, the origin is set according to the first point
processed, which may differ between pipelines.

On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <
pdal at lists.osgeo.org> wrote:

> Hi,
>
> my aim is to calculate the fitovolume of a shrub vegetation area. To do
> that I calculate the DSM, classify a point cloud with ground (2) and low
> vegetation (3) and then create a DTM.
>
> I use 2 different pipelines (see below) to do that modified from this post
> <https://github.com/manaakiwhenua/pycrown/issues/18>. But I have 2 issues:
>
>    - When I calculate the difference between DSM and DTM I get negative
>    values
>    - The pixels of the DTM are horizontally displaced with respect to the
>    DSM by half a pixel.
>
> Does anyone know why I am getting these negative values using this
> pipelines? Is anything wrong in the pipelines I`m using?
>
>
> Ra?l.
>
> Pipeline for DSM:
>
> [
>     "nubeRecortadaPdal_1.laz",
>     {
>         "type": "filters.range",
>         "limits":"returnnumber[1:1]"
>     },
>     {
>         "type": "writers.gdal",
>         "filename": "nubeRecortadaPdal_1_mds.tif",
>         "output_type": "idw",
>         "gdaldriver": "GTiff",
>         "resolution": 0.05,
>         "nodata": -9999,
>         "radius": 0.07,
>         "window_size": 50,
>         "data_type": "float32"
>     }
> ]
>
> Pipeline for DTM:
>
> [
>     "nubeRecortadaPdal_1.laz",
>     {
>         "type":"filters.overlay",
>         "dimension":"Classification",
>         "datasource":"D:/Datos/clasificadasVector.gpkg",
>         "layer":"ndviRandomForest",
>         "column":"Id"
>     },
>     {
>         "type":"filters.range",
>         "limits":"Classification[2:2]"
>     },
>     {
>         "type": "writers.gdal",
>         "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>         "output_type": "idw",
>         "gdaldriver": "GTiff",
>         "resolution": 0.05,
>         "nodata": -9999,
>         "radius": 0.07,
>         "window_size": 100,
>         "data_type": "float32"
>     }
> ]
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240620/2b97d7dd/attachment.htm>

From raul.casado at eez.csic.es  Thu Jun 20 06:35:49 2024
From: raul.casado at eez.csic.es (=?UTF-8?Q?Ra=C3=BAl_Casado_Barbero?=)
Date: Thu, 20 Jun 2024 15:35:49 +0200
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
Message-ID: <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>

Hi Andrew and thaks for your answer.

I'm pretty new with pdal just now and I'm tryingn to understand the 
logic of pipelines... What do you mean with set the origin on writers.gdal?


Ra?l.

El 20/06/2024 a las 13:45, Andrew Bell escribi?:
> Hi Raul,
>
> You should set the origin on writers.gdal in order to get the 
> consistency you desire. Without this, the origin is set according to 
> the first point processed, which may differ between pipelines.
>
> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal 
> <pdal at lists.osgeo.org> wrote:
>
>     Hi,
>
>     my aim is to calculate the fitovolume of a shrub vegetation area.
>     To do that I calculate the DSM, classify a point cloud with ground
>     (2) and low vegetation (3) and then create a DTM.
>
>     I use 2 different pipelines (see below) to do that modified from
>     this post <https://github.com/manaakiwhenua/pycrown/issues/18>.
>     But I have 2 issues:
>
>       * When I calculate the difference between DSM and DTM I get
>         negative values
>       * The pixels of the DTM are horizontally displaced with respect
>         to the DSM by half a pixel.
>
>     Does anyone know why I am getting these negative values using this
>     pipelines? Is anything wrong in the pipelines I`m using?
>
>
>     Ra?l.
>
>     Pipeline for DSM:
>
>     [
>     ?? ?"nubeRecortadaPdal_1.laz",
>     ?? ?{
>     ?? ???? "type": "filters.range",
>     ?? ???? "limits":"returnnumber[1:1]"
>     ?? ?},
>     ?? ?{
>     ?? ???? "type": "writers.gdal",
>     ?? ???? "filename": "nubeRecortadaPdal_1_mds.tif",
>     ??????? "output_type": "idw",
>     ?? ???? "gdaldriver": "GTiff",
>     ?? ???? "resolution": 0.05,
>     ?? ???? "nodata": -9999,
>     ?? ???? "radius": 0.07,
>     ?? ???? "window_size": 50,
>     ?? ???? "data_type": "float32"
>     ?? ?}
>     ]
>
>     Pipeline for DTM:
>
>     [
>     ?? ?"nubeRecortadaPdal_1.laz",
>     ?? ?{
>     ?? ???? "type":"filters.overlay",
>     ?? ???? "dimension":"Classification",
>     ?? ???? "datasource":"D:/Datos/clasificadasVector.gpkg",
>     ?? ???? "layer":"ndviRandomForest",
>     ?? ???? "column":"Id"
>     ?? ?},
>     ?? ?{
>     ?? ???? "type":"filters.range",
>     ?? ???? "limits":"Classification[2:2]"
>     ?? ?},
>     ?? ?{
>     ?? ???? "type": "writers.gdal",
>     ?? ???? "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>     ??????? "output_type": "idw",
>     ?? ???? "gdaldriver": "GTiff",
>     ?? ???? "resolution": 0.05,
>     ?? ???? "nodata": -9999,
>     ?? ???? "radius": 0.07,
>     ?? ???? "window_size": 100,
>     ?? ???? "data_type": "float32"
>     ?? ?}
>     ]
>
>
>     _______________________________________________
>     pdal mailing list
>     pdal at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com

-- 
Ra?l Casado Barbero
Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
Estacion Experimental del Zaidin, CSIC
Calle Profesor Albareda 1, 18008 Granada, Spain
Phone: +34 958181600 VolP CSIC 439186
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240620/b5e1f740/attachment-0001.htm>

From connor at hobu.co  Thu Jun 20 07:51:04 2024
From: connor at hobu.co (Connor Manning)
Date: Thu, 20 Jun 2024 09:51:04 -0500
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
Message-ID: <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>

For general information on how pipelines work:
https://pdal.io/en/2.7-maintenance/pipeline.html
And here is the information on the GDAL writer specifically, take a
look at origin_x and origin_y:
https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal

For your pipelines, the GDAL writer is independently choosing its own
grid each time since you have not specified an origin, so the pixels
don't line up between the two outputs.  You want to explicitly set the
same origin, via the above options, for both of your writers.gdal
outputs to make sure they line up.

- Connor

On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
<pdal at lists.osgeo.org> wrote:
>
> Hi Andrew and thaks for your answer.
>
> I'm pretty new with pdal just now and I'm tryingn to understand the logic of pipelines... What do you mean with set the origin on writers.gdal?
>
>
> Ra?l.
>
> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
>
> Hi Raul,
>
> You should set the origin on writers.gdal in order to get the consistency you desire. Without this, the origin is set according to the first point processed, which may differ between pipelines.
>
> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <pdal at lists.osgeo.org> wrote:
>>
>> Hi,
>>
>> my aim is to calculate the fitovolume of a shrub vegetation area. To do that I calculate the DSM, classify a point cloud with ground (2) and low vegetation (3) and then create a DTM.
>>
>> I use 2 different pipelines (see below) to do that modified from this post. But I have 2 issues:
>>
>> When I calculate the difference between DSM and DTM I get negative values
>> The pixels of the DTM are horizontally displaced with respect to the DSM by half a pixel.
>>
>> Does anyone know why I am getting these negative values using this pipelines? Is anything wrong in the pipelines I`m using?
>>
>>
>> Ra?l.
>>
>> Pipeline for DSM:
>>
>> [
>>     "nubeRecortadaPdal_1.laz",
>>     {
>>         "type": "filters.range",
>>         "limits":"returnnumber[1:1]"
>>     },
>>     {
>>         "type": "writers.gdal",
>>         "filename": "nubeRecortadaPdal_1_mds.tif",
>>         "output_type": "idw",
>>         "gdaldriver": "GTiff",
>>         "resolution": 0.05,
>>         "nodata": -9999,
>>         "radius": 0.07,
>>         "window_size": 50,
>>         "data_type": "float32"
>>     }
>> ]
>>
>> Pipeline for DTM:
>>
>> [
>>     "nubeRecortadaPdal_1.laz",
>>     {
>>         "type":"filters.overlay",
>>         "dimension":"Classification",
>>         "datasource":"D:/Datos/clasificadasVector.gpkg",
>>         "layer":"ndviRandomForest",
>>         "column":"Id"
>>     },
>>     {
>>         "type":"filters.range",
>>         "limits":"Classification[2:2]"
>>     },
>>     {
>>         "type": "writers.gdal",
>>         "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>>         "output_type": "idw",
>>         "gdaldriver": "GTiff",
>>         "resolution": 0.05,
>>         "nodata": -9999,
>>         "radius": 0.07,
>>         "window_size": 100,
>>         "data_type": "float32"
>>     }
>> ]
>>
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
> --
> Ra?l Casado Barbero
> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
> Estacion Experimental del Zaidin, CSIC
> Calle Profesor Albareda 1, 18008 Granada, Spain
> Phone: +34 958181600 VolP CSIC 439186
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal

From dmullins78 at gmail.com  Fri Jun 21 16:46:46 2024
From: dmullins78 at gmail.com (Dan Mullins)
Date: Fri, 21 Jun 2024 15:46:46 -0800
Subject: [pdal] Entwine Build vs Merge
Message-ID: <CAHCKpobSFAKh5vHBGExxBBqy-RpZS1d4ywOWSQ5PFyK-9FJQkA@mail.gmail.com>

When building a pointcloud with Entwine, I can call build multiple times or
use merge. They both seem to do the same thing, are there advantages to
using one vs the other?

Dan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240621/b36d0e57/attachment.htm>

From dmullins78 at gmail.com  Fri Jun 21 17:15:45 2024
From: dmullins78 at gmail.com (Dan Mullins)
Date: Fri, 21 Jun 2024 16:15:45 -0800
Subject: [pdal] Entwine Build vs Merge
In-Reply-To: <CAHCKpobSFAKh5vHBGExxBBqy-RpZS1d4ywOWSQ5PFyK-9FJQkA@mail.gmail.com>
References: <CAHCKpobSFAKh5vHBGExxBBqy-RpZS1d4ywOWSQ5PFyK-9FJQkA@mail.gmail.com>
Message-ID: <CAHCKpoaeycc=2ctW0SU4O1VbZs=_FgxbavB58s5qXTgnrJfM4Q@mail.gmail.com>

I found this issue right after I posted. Looks like it answers my question.
In my case, as we add data to the cloud I should be calling "build"
multiple times.

https://github.com/connormanning/entwine/issues/316


On Fri, Jun 21, 2024 at 3:46?PM Dan Mullins <dmullins78 at gmail.com> wrote:

> When building a pointcloud with Entwine, I can call build multiple times
> or use merge. They both seem to do the same thing, are there advantages to
> using one vs the other?
>
> Dan
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240621/761aa8d4/attachment.htm>

From raul.casado at eez.csic.es  Mon Jun 24 23:09:46 2024
From: raul.casado at eez.csic.es (=?UTF-8?Q?Ra=C3=BAl_Casado_Barbero?=)
Date: Tue, 25 Jun 2024 08:09:46 +0200
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
Message-ID: <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>

Hi,

thank you both. Imodified the pipeline adding origin_x, origin_y, width 
and height and now I get consistency inthe new rasters.

The problem is that I still get negative values when I substract the MDT 
to MDS. Could it be due to interpolation in the calculation of MDT? If I 
get this raster by filtering the vegetation, could it be that values 
lower than MDS appear in areas where there is vegetation?


Greetings.

El 20/06/2024 a las 16:51, Connor Manning escribi?:
> For general information on how pipelines work:
> https://pdal.io/en/2.7-maintenance/pipeline.html
> And here is the information on the GDAL writer specifically, take a
> look at origin_x and origin_y:
> https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
>
> For your pipelines, the GDAL writer is independently choosing its own
> grid each time since you have not specified an origin, so the pixels
> don't line up between the two outputs.  You want to explicitly set the
> same origin, via the above options, for both of your writers.gdal
> outputs to make sure they line up.
>
> - Connor
>
> On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
> <pdal at lists.osgeo.org> wrote:
>> Hi Andrew and thaks for your answer.
>>
>> I'm pretty new with pdal just now and I'm tryingn to understand the logic of pipelines... What do you mean with set the origin on writers.gdal?
>>
>>
>> Ra?l.
>>
>> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
>>
>> Hi Raul,
>>
>> You should set the origin on writers.gdal in order to get the consistency you desire. Without this, the origin is set according to the first point processed, which may differ between pipelines.
>>
>> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <pdal at lists.osgeo.org> wrote:
>>> Hi,
>>>
>>> my aim is to calculate the fitovolume of a shrub vegetation area. To do that I calculate the DSM, classify a point cloud with ground (2) and low vegetation (3) and then create a DTM.
>>>
>>> I use 2 different pipelines (see below) to do that modified from this post. But I have 2 issues:
>>>
>>> When I calculate the difference between DSM and DTM I get negative values
>>> The pixels of the DTM are horizontally displaced with respect to the DSM by half a pixel.
>>>
>>> Does anyone know why I am getting these negative values using this pipelines? Is anything wrong in the pipelines I`m using?
>>>
>>>
>>> Ra?l.
>>>
>>> Pipeline for DSM:
>>>
>>> [
>>>      "nubeRecortadaPdal_1.laz",
>>>      {
>>>          "type": "filters.range",
>>>          "limits":"returnnumber[1:1]"
>>>      },
>>>      {
>>>          "type": "writers.gdal",
>>>          "filename": "nubeRecortadaPdal_1_mds.tif",
>>>          "output_type": "idw",
>>>          "gdaldriver": "GTiff",
>>>          "resolution": 0.05,
>>>          "nodata": -9999,
>>>          "radius": 0.07,
>>>          "window_size": 50,
>>>          "data_type": "float32"
>>>      }
>>> ]
>>>
>>> Pipeline for DTM:
>>>
>>> [
>>>      "nubeRecortadaPdal_1.laz",
>>>      {
>>>          "type":"filters.overlay",
>>>          "dimension":"Classification",
>>>          "datasource":"D:/Datos/clasificadasVector.gpkg",
>>>          "layer":"ndviRandomForest",
>>>          "column":"Id"
>>>      },
>>>      {
>>>          "type":"filters.range",
>>>          "limits":"Classification[2:2]"
>>>      },
>>>      {
>>>          "type": "writers.gdal",
>>>          "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>>>          "output_type": "idw",
>>>          "gdaldriver": "GTiff",
>>>          "resolution": 0.05,
>>>          "nodata": -9999,
>>>          "radius": 0.07,
>>>          "window_size": 100,
>>>          "data_type": "float32"
>>>      }
>>> ]
>>>
>>>
>>> _______________________________________________
>>> pdal mailing list
>>> pdal at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>>
>> --
>> Andrew Bell
>> andrew.bell.ia at gmail.com
>>
>> --
>> Ra?l Casado Barbero
>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>> Estacion Experimental del Zaidin, CSIC
>> Calle Profesor Albareda 1, 18008 Granada, Spain
>> Phone: +34 958181600 VolP CSIC 439186
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal

-- 
Ra?l Casado Barbero
Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
Estacion Experimental del Zaidin, CSIC
Calle Profesor Albareda 1, 18008 Granada, Spain
Phone: +34 958181600 VolP CSIC 439186


From andrew.bell.ia at gmail.com  Tue Jun 25 06:58:08 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 25 Jun 2024 09:58:08 -0400
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
Message-ID: <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>

Hi Raul,

Are you sure you're not seeing places where you have NODATA in one raster
or the other?

On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero <raul.casado at eez.csic.es>
wrote:

> Hi,
>
> thank you both. Imodified the pipeline adding origin_x, origin_y, width
> and height and now I get consistency inthe new rasters.
>
> The problem is that I still get negative values when I substract the MDT
> to MDS. Could it be due to interpolation in the calculation of MDT? If I
> get this raster by filtering the vegetation, could it be that values
> lower than MDS appear in areas where there is vegetation?
>
>
> Greetings.
>
> El 20/06/2024 a las 16:51, Connor Manning escribi?:
> > For general information on how pipelines work:
> > https://pdal.io/en/2.7-maintenance/pipeline.html
> > And here is the information on the GDAL writer specifically, take a
> > look at origin_x and origin_y:
> > https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
> >
> > For your pipelines, the GDAL writer is independently choosing its own
> > grid each time since you have not specified an origin, so the pixels
> > don't line up between the two outputs.  You want to explicitly set the
> > same origin, via the above options, for both of your writers.gdal
> > outputs to make sure they line up.
> >
> > - Connor
> >
> > On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
> > <pdal at lists.osgeo.org> wrote:
> >> Hi Andrew and thaks for your answer.
> >>
> >> I'm pretty new with pdal just now and I'm tryingn to understand the
> logic of pipelines... What do you mean with set the origin on writers.gdal?
> >>
> >>
> >> Ra?l.
> >>
> >> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
> >>
> >> Hi Raul,
> >>
> >> You should set the origin on writers.gdal in order to get the
> consistency you desire. Without this, the origin is set according to the
> first point processed, which may differ between pipelines.
> >>
> >> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <
> pdal at lists.osgeo.org> wrote:
> >>> Hi,
> >>>
> >>> my aim is to calculate the fitovolume of a shrub vegetation area. To
> do that I calculate the DSM, classify a point cloud with ground (2) and low
> vegetation (3) and then create a DTM.
> >>>
> >>> I use 2 different pipelines (see below) to do that modified from this
> post. But I have 2 issues:
> >>>
> >>> When I calculate the difference between DSM and DTM I get negative
> values
> >>> The pixels of the DTM are horizontally displaced with respect to the
> DSM by half a pixel.
> >>>
> >>> Does anyone know why I am getting these negative values using this
> pipelines? Is anything wrong in the pipelines I`m using?
> >>>
> >>>
> >>> Ra?l.
> >>>
> >>> Pipeline for DSM:
> >>>
> >>> [
> >>>      "nubeRecortadaPdal_1.laz",
> >>>      {
> >>>          "type": "filters.range",
> >>>          "limits":"returnnumber[1:1]"
> >>>      },
> >>>      {
> >>>          "type": "writers.gdal",
> >>>          "filename": "nubeRecortadaPdal_1_mds.tif",
> >>>          "output_type": "idw",
> >>>          "gdaldriver": "GTiff",
> >>>          "resolution": 0.05,
> >>>          "nodata": -9999,
> >>>          "radius": 0.07,
> >>>          "window_size": 50,
> >>>          "data_type": "float32"
> >>>      }
> >>> ]
> >>>
> >>> Pipeline for DTM:
> >>>
> >>> [
> >>>      "nubeRecortadaPdal_1.laz",
> >>>      {
> >>>          "type":"filters.overlay",
> >>>          "dimension":"Classification",
> >>>          "datasource":"D:/Datos/clasificadasVector.gpkg",
> >>>          "layer":"ndviRandomForest",
> >>>          "column":"Id"
> >>>      },
> >>>      {
> >>>          "type":"filters.range",
> >>>          "limits":"Classification[2:2]"
> >>>      },
> >>>      {
> >>>          "type": "writers.gdal",
> >>>          "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
> >>>          "output_type": "idw",
> >>>          "gdaldriver": "GTiff",
> >>>          "resolution": 0.05,
> >>>          "nodata": -9999,
> >>>          "radius": 0.07,
> >>>          "window_size": 100,
> >>>          "data_type": "float32"
> >>>      }
> >>> ]
> >>>
> >>>
> >>> _______________________________________________
> >>> pdal mailing list
> >>> pdal at lists.osgeo.org
> >>> https://lists.osgeo.org/mailman/listinfo/pdal
> >>
> >>
> >> --
> >> Andrew Bell
> >> andrew.bell.ia at gmail.com
> >>
> >> --
> >> Ra?l Casado Barbero
> >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >> Estacion Experimental del Zaidin, CSIC
> >> Calle Profesor Albareda 1, 18008 Granada, Spain
> >> Phone: +34 958181600 VolP CSIC 439186
> >>
> >> _______________________________________________
> >> pdal mailing list
> >> pdal at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/pdal
>
> --
> Ra?l Casado Barbero
> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> Estacion Experimental del Zaidin, CSIC
> Calle Profesor Albareda 1, 18008 Granada, Spain
> Phone: +34 958181600 VolP CSIC 439186
>
>

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240625/68f2a2df/attachment.htm>

From raul.casado at eez.csic.es  Tue Jun 25 07:30:21 2024
From: raul.casado at eez.csic.es (=?UTF-8?Q?Ra=C3=BAl_Casado_Barbero?=)
Date: Tue, 25 Jun 2024 16:30:21 +0200
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
 <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
Message-ID: <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>

Hello Andrew,

yes I'm sure. In fact I have some specific nodata pixels in DTM but the 
negative values in the difference cover almost the entire image.

I'm using QGIS to substract both rasters using Raster calculator and 
GDAL Raster calculator but I get identical result.


El 25/06/2024 a las 15:58, Andrew Bell escribi?:
> Hi Raul,
>
> Are you sure you're not seeing places where you have NODATA in one 
> raster or the other?
>
> On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero 
> <raul.casado at eez.csic.es> wrote:
>
>     Hi,
>
>     thank you both. Imodified the pipeline adding origin_x, origin_y,
>     width
>     and height and now I get consistency inthe new rasters.
>
>     The problem is that I still get negative values when I substract
>     the MDT
>     to MDS. Could it be due to interpolation in the calculation of
>     MDT? If I
>     get this raster by filtering the vegetation, could it be that values
>     lower than MDS appear in areas where there is vegetation?
>
>
>     Greetings.
>
>     El 20/06/2024 a las 16:51, Connor Manning escribi?:
>     > For general information on how pipelines work:
>     > https://pdal.io/en/2.7-maintenance/pipeline.html
>     > And here is the information on the GDAL writer specifically, take a
>     > look at origin_x and origin_y:
>     >
>     https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
>     >
>     > For your pipelines, the GDAL writer is independently choosing
>     its own
>     > grid each time since you have not specified an origin, so the pixels
>     > don't line up between the two outputs.? You want to explicitly
>     set the
>     > same origin, via the above options, for both of your writers.gdal
>     > outputs to make sure they line up.
>     >
>     > - Connor
>     >
>     > On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
>     > <pdal at lists.osgeo.org> wrote:
>     >> Hi Andrew and thaks for your answer.
>     >>
>     >> I'm pretty new with pdal just now and I'm tryingn to understand
>     the logic of pipelines... What do you mean with set the origin on
>     writers.gdal?
>     >>
>     >>
>     >> Ra?l.
>     >>
>     >> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
>     >>
>     >> Hi Raul,
>     >>
>     >> You should set the origin on writers.gdal in order to get the
>     consistency you desire. Without this, the origin is set according
>     to the first point processed, which may differ between pipelines.
>     >>
>     >> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal
>     <pdal at lists.osgeo.org> wrote:
>     >>> Hi,
>     >>>
>     >>> my aim is to calculate the fitovolume of a shrub vegetation
>     area. To do that I calculate the DSM, classify a point cloud with
>     ground (2) and low vegetation (3) and then create a DTM.
>     >>>
>     >>> I use 2 different pipelines (see below) to do that modified
>     from this post. But I have 2 issues:
>     >>>
>     >>> When I calculate the difference between DSM and DTM I get
>     negative values
>     >>> The pixels of the DTM are horizontally displaced with respect
>     to the DSM by half a pixel.
>     >>>
>     >>> Does anyone know why I am getting these negative values using
>     this pipelines? Is anything wrong in the pipelines I`m using?
>     >>>
>     >>>
>     >>> Ra?l.
>     >>>
>     >>> Pipeline for DSM:
>     >>>
>     >>> [
>     >>>? ? ? "nubeRecortadaPdal_1.laz",
>     >>>? ? ? {
>     >>>? ? ? ? ? "type": "filters.range",
>     >>>? ? ? ? ? "limits":"returnnumber[1:1]"
>     >>>? ? ? },
>     >>>? ? ? {
>     >>>? ? ? ? ? "type": "writers.gdal",
>     >>>? ? ? ? ? "filename": "nubeRecortadaPdal_1_mds.tif",
>     >>>? ? ? ? ? "output_type": "idw",
>     >>>? ? ? ? ? "gdaldriver": "GTiff",
>     >>>? ? ? ? ? "resolution": 0.05,
>     >>>? ? ? ? ? "nodata": -9999,
>     >>>? ? ? ? ? "radius": 0.07,
>     >>>? ? ? ? ? "window_size": 50,
>     >>>? ? ? ? ? "data_type": "float32"
>     >>>? ? ? }
>     >>> ]
>     >>>
>     >>> Pipeline for DTM:
>     >>>
>     >>> [
>     >>>? ? ? "nubeRecortadaPdal_1.laz",
>     >>>? ? ? {
>     >>>? ? ? ? ? "type":"filters.overlay",
>     >>>? ? ? ? ? "dimension":"Classification",
>     >>> "datasource":"D:/Datos/clasificadasVector.gpkg",
>     >>>? ? ? ? ? "layer":"ndviRandomForest",
>     >>>? ? ? ? ? "column":"Id"
>     >>>? ? ? },
>     >>>? ? ? {
>     >>>? ? ? ? ? "type":"filters.range",
>     >>>? ? ? ? ? "limits":"Classification[2:2]"
>     >>>? ? ? },
>     >>>? ? ? {
>     >>>? ? ? ? ? "type": "writers.gdal",
>     >>>? ? ? ? ? "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>     >>>? ? ? ? ? "output_type": "idw",
>     >>>? ? ? ? ? "gdaldriver": "GTiff",
>     >>>? ? ? ? ? "resolution": 0.05,
>     >>>? ? ? ? ? "nodata": -9999,
>     >>>? ? ? ? ? "radius": 0.07,
>     >>>? ? ? ? ? "window_size": 100,
>     >>>? ? ? ? ? "data_type": "float32"
>     >>>? ? ? }
>     >>> ]
>     >>>
>     >>>
>     >>> _______________________________________________
>     >>> pdal mailing list
>     >>> pdal at lists.osgeo.org
>     >>> https://lists.osgeo.org/mailman/listinfo/pdal
>     >>
>     >>
>     >> --
>     >> Andrew Bell
>     >> andrew.bell.ia at gmail.com
>     >>
>     >> --
>     >> Ra?l Casado Barbero
>     >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de
>     Agrosistemas Mediterr?neos
>     >> Estacion Experimental del Zaidin, CSIC
>     >> Calle Profesor Albareda 1, 18008 Granada, Spain
>     >> Phone: +34 958181600 VolP CSIC 439186
>     >>
>     >> _______________________________________________
>     >> pdal mailing list
>     >> pdal at lists.osgeo.org
>     >> https://lists.osgeo.org/mailman/listinfo/pdal
>
>     -- 
>     Ra?l Casado Barbero
>     Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
>     Mediterr?neos
>     Estacion Experimental del Zaidin, CSIC
>     Calle Profesor Albareda 1, 18008 Granada, Spain
>     Phone: +34 958181600 VolP CSIC 439186
>
>
>
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com

-- 
Ra?l Casado Barbero
Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
Estacion Experimental del Zaidin, CSIC
Calle Profesor Albareda 1, 18008 Granada, Spain
Phone: +34 958181600 VolP CSIC 439186
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240625/bf2b4f99/attachment-0001.htm>

From connor at hobu.co  Tue Jun 25 07:38:03 2024
From: connor at hobu.co (Connor Manning)
Date: Tue, 25 Jun 2024 09:38:03 -0500
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
 <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
 <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>
Message-ID: <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>

Can you provide the file nubeRecortadaPdal_1.laz?

On Tue, Jun 25, 2024 at 9:30?AM Ra?l Casado Barbero
<raul.casado at eez.csic.es> wrote:
>
> Hello Andrew,
>
> yes I'm sure. In fact I have some specific nodata pixels in DTM but the negative values in the difference cover almost the entire image.
>
> I'm using QGIS to substract both rasters using Raster calculator and GDAL Raster calculator but I get identical result.
>
>
> El 25/06/2024 a las 15:58, Andrew Bell escribi?:
>
> Hi Raul,
>
> Are you sure you're not seeing places where you have NODATA in one raster or the other?
>
> On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero <raul.casado at eez.csic.es> wrote:
>>
>> Hi,
>>
>> thank you both. Imodified the pipeline adding origin_x, origin_y, width
>> and height and now I get consistency inthe new rasters.
>>
>> The problem is that I still get negative values when I substract the MDT
>> to MDS. Could it be due to interpolation in the calculation of MDT? If I
>> get this raster by filtering the vegetation, could it be that values
>> lower than MDS appear in areas where there is vegetation?
>>
>>
>> Greetings.
>>
>> El 20/06/2024 a las 16:51, Connor Manning escribi?:
>> > For general information on how pipelines work:
>> > https://pdal.io/en/2.7-maintenance/pipeline.html
>> > And here is the information on the GDAL writer specifically, take a
>> > look at origin_x and origin_y:
>> > https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
>> >
>> > For your pipelines, the GDAL writer is independently choosing its own
>> > grid each time since you have not specified an origin, so the pixels
>> > don't line up between the two outputs.  You want to explicitly set the
>> > same origin, via the above options, for both of your writers.gdal
>> > outputs to make sure they line up.
>> >
>> > - Connor
>> >
>> > On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
>> > <pdal at lists.osgeo.org> wrote:
>> >> Hi Andrew and thaks for your answer.
>> >>
>> >> I'm pretty new with pdal just now and I'm tryingn to understand the logic of pipelines... What do you mean with set the origin on writers.gdal?
>> >>
>> >>
>> >> Ra?l.
>> >>
>> >> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
>> >>
>> >> Hi Raul,
>> >>
>> >> You should set the origin on writers.gdal in order to get the consistency you desire. Without this, the origin is set according to the first point processed, which may differ between pipelines.
>> >>
>> >> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <pdal at lists.osgeo.org> wrote:
>> >>> Hi,
>> >>>
>> >>> my aim is to calculate the fitovolume of a shrub vegetation area. To do that I calculate the DSM, classify a point cloud with ground (2) and low vegetation (3) and then create a DTM.
>> >>>
>> >>> I use 2 different pipelines (see below) to do that modified from this post. But I have 2 issues:
>> >>>
>> >>> When I calculate the difference between DSM and DTM I get negative values
>> >>> The pixels of the DTM are horizontally displaced with respect to the DSM by half a pixel.
>> >>>
>> >>> Does anyone know why I am getting these negative values using this pipelines? Is anything wrong in the pipelines I`m using?
>> >>>
>> >>>
>> >>> Ra?l.
>> >>>
>> >>> Pipeline for DSM:
>> >>>
>> >>> [
>> >>>      "nubeRecortadaPdal_1.laz",
>> >>>      {
>> >>>          "type": "filters.range",
>> >>>          "limits":"returnnumber[1:1]"
>> >>>      },
>> >>>      {
>> >>>          "type": "writers.gdal",
>> >>>          "filename": "nubeRecortadaPdal_1_mds.tif",
>> >>>          "output_type": "idw",
>> >>>          "gdaldriver": "GTiff",
>> >>>          "resolution": 0.05,
>> >>>          "nodata": -9999,
>> >>>          "radius": 0.07,
>> >>>          "window_size": 50,
>> >>>          "data_type": "float32"
>> >>>      }
>> >>> ]
>> >>>
>> >>> Pipeline for DTM:
>> >>>
>> >>> [
>> >>>      "nubeRecortadaPdal_1.laz",
>> >>>      {
>> >>>          "type":"filters.overlay",
>> >>>          "dimension":"Classification",
>> >>>          "datasource":"D:/Datos/clasificadasVector.gpkg",
>> >>>          "layer":"ndviRandomForest",
>> >>>          "column":"Id"
>> >>>      },
>> >>>      {
>> >>>          "type":"filters.range",
>> >>>          "limits":"Classification[2:2]"
>> >>>      },
>> >>>      {
>> >>>          "type": "writers.gdal",
>> >>>          "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>> >>>          "output_type": "idw",
>> >>>          "gdaldriver": "GTiff",
>> >>>          "resolution": 0.05,
>> >>>          "nodata": -9999,
>> >>>          "radius": 0.07,
>> >>>          "window_size": 100,
>> >>>          "data_type": "float32"
>> >>>      }
>> >>> ]
>> >>>
>> >>>
>> >>> _______________________________________________
>> >>> pdal mailing list
>> >>> pdal at lists.osgeo.org
>> >>> https://lists.osgeo.org/mailman/listinfo/pdal
>> >>
>> >>
>> >> --
>> >> Andrew Bell
>> >> andrew.bell.ia at gmail.com
>> >>
>> >> --
>> >> Ra?l Casado Barbero
>> >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>> >> Estacion Experimental del Zaidin, CSIC
>> >> Calle Profesor Albareda 1, 18008 Granada, Spain
>> >> Phone: +34 958181600 VolP CSIC 439186
>> >>
>> >> _______________________________________________
>> >> pdal mailing list
>> >> pdal at lists.osgeo.org
>> >> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>> --
>> Ra?l Casado Barbero
>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>> Estacion Experimental del Zaidin, CSIC
>> Calle Profesor Albareda 1, 18008 Granada, Spain
>> Phone: +34 958181600 VolP CSIC 439186
>>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
> --
> Ra?l Casado Barbero
> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
> Estacion Experimental del Zaidin, CSIC
> Calle Profesor Albareda 1, 18008 Granada, Spain
> Phone: +34 958181600 VolP CSIC 439186

From andrew.bell.ia at gmail.com  Tue Jun 25 10:11:42 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 25 Jun 2024 13:11:42 -0400
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
 <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
 <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>
 <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>
Message-ID: <CACJ51z1Fvkmj7gY=-ApFeg6DFEOAPqY5HkaMCQYH8yrSegBsvw@mail.gmail.com>

The window size is different between pipelines. Don't know if that matters.

Also, there's nothing that prevents ground points above some first return
points in a cell. Maybe you want "min" mode for ground points and "max"
mode for first returns? Also, there's nothing here that matches up points
-- you could be using a first return from one location and a ground return
from another. Not sure what that would yield. Perhaps this needs something
more complex.

On Tue, Jun 25, 2024 at 10:38?AM Connor Manning <connor at hobu.co> wrote:

> Can you provide the file nubeRecortadaPdal_1.laz?
>
> On Tue, Jun 25, 2024 at 9:30?AM Ra?l Casado Barbero
> <raul.casado at eez.csic.es> wrote:
> >
> > Hello Andrew,
> >
> > yes I'm sure. In fact I have some specific nodata pixels in DTM but the
> negative values in the difference cover almost the entire image.
> >
> > I'm using QGIS to substract both rasters using Raster calculator and
> GDAL Raster calculator but I get identical result.
> >
> >
> > El 25/06/2024 a las 15:58, Andrew Bell escribi?:
> >
> > Hi Raul,
> >
> > Are you sure you're not seeing places where you have NODATA in one
> raster or the other?
> >
> > On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero <
> raul.casado at eez.csic.es> wrote:
> >>
> >> Hi,
> >>
> >> thank you both. Imodified the pipeline adding origin_x, origin_y, width
> >> and height and now I get consistency inthe new rasters.
> >>
> >> The problem is that I still get negative values when I substract the MDT
> >> to MDS. Could it be due to interpolation in the calculation of MDT? If I
> >> get this raster by filtering the vegetation, could it be that values
> >> lower than MDS appear in areas where there is vegetation?
> >>
> >>
> >> Greetings.
> >>
> >> El 20/06/2024 a las 16:51, Connor Manning escribi?:
> >> > For general information on how pipelines work:
> >> > https://pdal.io/en/2.7-maintenance/pipeline.html
> >> > And here is the information on the GDAL writer specifically, take a
> >> > look at origin_x and origin_y:
> >> >
> https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
> >> >
> >> > For your pipelines, the GDAL writer is independently choosing its own
> >> > grid each time since you have not specified an origin, so the pixels
> >> > don't line up between the two outputs.  You want to explicitly set the
> >> > same origin, via the above options, for both of your writers.gdal
> >> > outputs to make sure they line up.
> >> >
> >> > - Connor
> >> >
> >> > On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
> >> > <pdal at lists.osgeo.org> wrote:
> >> >> Hi Andrew and thaks for your answer.
> >> >>
> >> >> I'm pretty new with pdal just now and I'm tryingn to understand the
> logic of pipelines... What do you mean with set the origin on writers.gdal?
> >> >>
> >> >>
> >> >> Ra?l.
> >> >>
> >> >> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
> >> >>
> >> >> Hi Raul,
> >> >>
> >> >> You should set the origin on writers.gdal in order to get the
> consistency you desire. Without this, the origin is set according to the
> first point processed, which may differ between pipelines.
> >> >>
> >> >> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <
> pdal at lists.osgeo.org> wrote:
> >> >>> Hi,
> >> >>>
> >> >>> my aim is to calculate the fitovolume of a shrub vegetation area.
> To do that I calculate the DSM, classify a point cloud with ground (2) and
> low vegetation (3) and then create a DTM.
> >> >>>
> >> >>> I use 2 different pipelines (see below) to do that modified from
> this post. But I have 2 issues:
> >> >>>
> >> >>> When I calculate the difference between DSM and DTM I get negative
> values
> >> >>> The pixels of the DTM are horizontally displaced with respect to
> the DSM by half a pixel.
> >> >>>
> >> >>> Does anyone know why I am getting these negative values using this
> pipelines? Is anything wrong in the pipelines I`m using?
> >> >>>
> >> >>>
> >> >>> Ra?l.
> >> >>>
> >> >>> Pipeline for DSM:
> >> >>>
> >> >>> [
> >> >>>      "nubeRecortadaPdal_1.laz",
> >> >>>      {
> >> >>>          "type": "filters.range",
> >> >>>          "limits":"returnnumber[1:1]"
> >> >>>      },
> >> >>>      {
> >> >>>          "type": "writers.gdal",
> >> >>>          "filename": "nubeRecortadaPdal_1_mds.tif",
> >> >>>          "output_type": "idw",
> >> >>>          "gdaldriver": "GTiff",
> >> >>>          "resolution": 0.05,
> >> >>>          "nodata": -9999,
> >> >>>          "radius": 0.07,
> >> >>>          "window_size": 50,
> >> >>>          "data_type": "float32"
> >> >>>      }
> >> >>> ]
> >> >>>
> >> >>> Pipeline for DTM:
> >> >>>
> >> >>> [
> >> >>>      "nubeRecortadaPdal_1.laz",
> >> >>>      {
> >> >>>          "type":"filters.overlay",
> >> >>>          "dimension":"Classification",
> >> >>>          "datasource":"D:/Datos/clasificadasVector.gpkg",
> >> >>>          "layer":"ndviRandomForest",
> >> >>>          "column":"Id"
> >> >>>      },
> >> >>>      {
> >> >>>          "type":"filters.range",
> >> >>>          "limits":"Classification[2:2]"
> >> >>>      },
> >> >>>      {
> >> >>>          "type": "writers.gdal",
> >> >>>          "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
> >> >>>          "output_type": "idw",
> >> >>>          "gdaldriver": "GTiff",
> >> >>>          "resolution": 0.05,
> >> >>>          "nodata": -9999,
> >> >>>          "radius": 0.07,
> >> >>>          "window_size": 100,
> >> >>>          "data_type": "float32"
> >> >>>      }
> >> >>> ]
> >> >>>
> >> >>>
> >> >>> _______________________________________________
> >> >>> pdal mailing list
> >> >>> pdal at lists.osgeo.org
> >> >>> https://lists.osgeo.org/mailman/listinfo/pdal
> >> >>
> >> >>
> >> >> --
> >> >> Andrew Bell
> >> >> andrew.bell.ia at gmail.com
> >> >>
> >> >> --
> >> >> Ra?l Casado Barbero
> >> >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >> >> Estacion Experimental del Zaidin, CSIC
> >> >> Calle Profesor Albareda 1, 18008 Granada, Spain
> >> >> Phone: +34 958181600 VolP CSIC 439186
> >> >>
> >> >> _______________________________________________
> >> >> pdal mailing list
> >> >> pdal at lists.osgeo.org
> >> >> https://lists.osgeo.org/mailman/listinfo/pdal
> >>
> >> --
> >> Ra?l Casado Barbero
> >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >> Estacion Experimental del Zaidin, CSIC
> >> Calle Profesor Albareda 1, 18008 Granada, Spain
> >> Phone: +34 958181600 VolP CSIC 439186
> >>
> >
> >
> > --
> > Andrew Bell
> > andrew.bell.ia at gmail.com
> >
> > --
> > Ra?l Casado Barbero
> > Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> > Estacion Experimental del Zaidin, CSIC
> > Calle Profesor Albareda 1, 18008 Granada, Spain
> > Phone: +34 958181600 VolP CSIC 439186
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240625/3590e97c/attachment-0001.htm>

From raul.casado at eez.csic.es  Wed Jun 26 00:01:44 2024
From: raul.casado at eez.csic.es (=?UTF-8?Q?Ra=C3=BAl_Casado_Barbero?=)
Date: Wed, 26 Jun 2024 09:01:44 +0200
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
 <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
 <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>
 <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>
Message-ID: <48825047-ffc1-410a-83b5-73af72daac84@eez.csic.es>

Hello,

sure, here it is.

https://drive.google.com/file/d/1u0OxHek6NqRO4g396xOlBT_CGwFCyplN/view?usp=sharing


El 25/06/2024 a las 16:38, Connor Manning escribi?:
> Can you provide the file nubeRecortadaPdal_1.laz?
>
> On Tue, Jun 25, 2024 at 9:30?AM Ra?l Casado Barbero
> <raul.casado at eez.csic.es> wrote:
>> Hello Andrew,
>>
>> yes I'm sure. In fact I have some specific nodata pixels in DTM but the negative values in the difference cover almost the entire image.
>>
>> I'm using QGIS to substract both rasters using Raster calculator and GDAL Raster calculator but I get identical result.
>>
>>
>> El 25/06/2024 a las 15:58, Andrew Bell escribi?:
>>
>> Hi Raul,
>>
>> Are you sure you're not seeing places where you have NODATA in one raster or the other?
>>
>> On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero <raul.casado at eez.csic.es> wrote:
>>> Hi,
>>>
>>> thank you both. Imodified the pipeline adding origin_x, origin_y, width
>>> and height and now I get consistency inthe new rasters.
>>>
>>> The problem is that I still get negative values when I substract the MDT
>>> to MDS. Could it be due to interpolation in the calculation of MDT? If I
>>> get this raster by filtering the vegetation, could it be that values
>>> lower than MDS appear in areas where there is vegetation?
>>>
>>>
>>> Greetings.
>>>
>>> El 20/06/2024 a las 16:51, Connor Manning escribi?:
>>>> For general information on how pipelines work:
>>>> https://pdal.io/en/2.7-maintenance/pipeline.html
>>>> And here is the information on the GDAL writer specifically, take a
>>>> look at origin_x and origin_y:
>>>> https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
>>>>
>>>> For your pipelines, the GDAL writer is independently choosing its own
>>>> grid each time since you have not specified an origin, so the pixels
>>>> don't line up between the two outputs.  You want to explicitly set the
>>>> same origin, via the above options, for both of your writers.gdal
>>>> outputs to make sure they line up.
>>>>
>>>> - Connor
>>>>
>>>> On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
>>>> <pdal at lists.osgeo.org> wrote:
>>>>> Hi Andrew and thaks for your answer.
>>>>>
>>>>> I'm pretty new with pdal just now and I'm tryingn to understand the logic of pipelines... What do you mean with set the origin on writers.gdal?
>>>>>
>>>>>
>>>>> Ra?l.
>>>>>
>>>>> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
>>>>>
>>>>> Hi Raul,
>>>>>
>>>>> You should set the origin on writers.gdal in order to get the consistency you desire. Without this, the origin is set according to the first point processed, which may differ between pipelines.
>>>>>
>>>>> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <pdal at lists.osgeo.org> wrote:
>>>>>> Hi,
>>>>>>
>>>>>> my aim is to calculate the fitovolume of a shrub vegetation area. To do that I calculate the DSM, classify a point cloud with ground (2) and low vegetation (3) and then create a DTM.
>>>>>>
>>>>>> I use 2 different pipelines (see below) to do that modified from this post. But I have 2 issues:
>>>>>>
>>>>>> When I calculate the difference between DSM and DTM I get negative values
>>>>>> The pixels of the DTM are horizontally displaced with respect to the DSM by half a pixel.
>>>>>>
>>>>>> Does anyone know why I am getting these negative values using this pipelines? Is anything wrong in the pipelines I`m using?
>>>>>>
>>>>>>
>>>>>> Ra?l.
>>>>>>
>>>>>> Pipeline for DSM:
>>>>>>
>>>>>> [
>>>>>>       "nubeRecortadaPdal_1.laz",
>>>>>>       {
>>>>>>           "type": "filters.range",
>>>>>>           "limits":"returnnumber[1:1]"
>>>>>>       },
>>>>>>       {
>>>>>>           "type": "writers.gdal",
>>>>>>           "filename": "nubeRecortadaPdal_1_mds.tif",
>>>>>>           "output_type": "idw",
>>>>>>           "gdaldriver": "GTiff",
>>>>>>           "resolution": 0.05,
>>>>>>           "nodata": -9999,
>>>>>>           "radius": 0.07,
>>>>>>           "window_size": 50,
>>>>>>           "data_type": "float32"
>>>>>>       }
>>>>>> ]
>>>>>>
>>>>>> Pipeline for DTM:
>>>>>>
>>>>>> [
>>>>>>       "nubeRecortadaPdal_1.laz",
>>>>>>       {
>>>>>>           "type":"filters.overlay",
>>>>>>           "dimension":"Classification",
>>>>>>           "datasource":"D:/Datos/clasificadasVector.gpkg",
>>>>>>           "layer":"ndviRandomForest",
>>>>>>           "column":"Id"
>>>>>>       },
>>>>>>       {
>>>>>>           "type":"filters.range",
>>>>>>           "limits":"Classification[2:2]"
>>>>>>       },
>>>>>>       {
>>>>>>           "type": "writers.gdal",
>>>>>>           "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
>>>>>>           "output_type": "idw",
>>>>>>           "gdaldriver": "GTiff",
>>>>>>           "resolution": 0.05,
>>>>>>           "nodata": -9999,
>>>>>>           "radius": 0.07,
>>>>>>           "window_size": 100,
>>>>>>           "data_type": "float32"
>>>>>>       }
>>>>>> ]
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> pdal mailing list
>>>>>> pdal at lists.osgeo.org
>>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>>>>
>>>>> --
>>>>> Andrew Bell
>>>>> andrew.bell.ia at gmail.com
>>>>>
>>>>> --
>>>>> Ra?l Casado Barbero
>>>>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>>>>> Estacion Experimental del Zaidin, CSIC
>>>>> Calle Profesor Albareda 1, 18008 Granada, Spain
>>>>> Phone: +34 958181600 VolP CSIC 439186
>>>>>
>>>>> _______________________________________________
>>>>> pdal mailing list
>>>>> pdal at lists.osgeo.org
>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>> --
>>> Ra?l Casado Barbero
>>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>>> Estacion Experimental del Zaidin, CSIC
>>> Calle Profesor Albareda 1, 18008 Granada, Spain
>>> Phone: +34 958181600 VolP CSIC 439186
>>>
>>
>> --
>> Andrew Bell
>> andrew.bell.ia at gmail.com
>>
>> --
>> Ra?l Casado Barbero
>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
>> Estacion Experimental del Zaidin, CSIC
>> Calle Profesor Albareda 1, 18008 Granada, Spain
>> Phone: +34 958181600 VolP CSIC 439186

-- 
Ra?l Casado Barbero
Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas Mediterr?neos
Estacion Experimental del Zaidin, CSIC
Calle Profesor Albareda 1, 18008 Granada, Spain
Phone: +34 958181600 VolP CSIC 439186


From andrew.bell.ia at gmail.com  Wed Jun 26 06:10:54 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 26 Jun 2024 09:10:54 -0400
Subject: [pdal] Calculation of the difference between DSM and DTM
In-Reply-To: <48825047-ffc1-410a-83b5-73af72daac84@eez.csic.es>
References: <1119a858-775e-43e9-be3e-b6b1c91dd136@eez.csic.es>
 <CACJ51z0+hZmJ-SNL0MLtPTQGByY7U4KY8zSfm9xiZQrmsKfVHQ@mail.gmail.com>
 <b23c633a-41be-469f-a3d1-a88257a19814@eez.csic.es>
 <CAO=FyjKZdHrwzT-KWpBCeEboyT46kL7F2b250wfmyO08MpcUoQ@mail.gmail.com>
 <beae6766-1bdf-485e-9e27-3e8803abd368@eez.csic.es>
 <CACJ51z0Yq1DQSWJ5fOTEYDXywZq9M=dnmEmMOUTOFhG9g8uNEQ@mail.gmail.com>
 <44f6b695-dce2-4e44-98d1-2dc6a427c23c@eez.csic.es>
 <CAO=Fyj+vcpmf343aRVFX3P2EktCy0V-46mV_Ebtsier_A5Vzbg@mail.gmail.com>
 <48825047-ffc1-410a-83b5-73af72daac84@eez.csic.es>
Message-ID: <CACJ51z28F2S4aKRo_==k6riSXDP+A4R9wr-1V7aDU17Akxfnig@mail.gmail.com>

I don't think it's reasonable to debug this as present. I would do a few
things to make progress:

1. Find a cell that you think is in error.
2. Filter the data to only contain points in that cell.
3. Make sure the results from the overlay filter are what you expect.
4. Look at statistics for the points and verify the behavior by hand.

On Wed, Jun 26, 2024 at 3:01?AM Ra?l Casado Barbero <raul.casado at eez.csic.es>
wrote:

> Hello,
>
> sure, here it is.
>
>
> https://drive.google.com/file/d/1u0OxHek6NqRO4g396xOlBT_CGwFCyplN/view?usp=sharing
>
>
> El 25/06/2024 a las 16:38, Connor Manning escribi?:
> > Can you provide the file nubeRecortadaPdal_1.laz?
> >
> > On Tue, Jun 25, 2024 at 9:30?AM Ra?l Casado Barbero
> > <raul.casado at eez.csic.es> wrote:
> >> Hello Andrew,
> >>
> >> yes I'm sure. In fact I have some specific nodata pixels in DTM but the
> negative values in the difference cover almost the entire image.
> >>
> >> I'm using QGIS to substract both rasters using Raster calculator and
> GDAL Raster calculator but I get identical result.
> >>
> >>
> >> El 25/06/2024 a las 15:58, Andrew Bell escribi?:
> >>
> >> Hi Raul,
> >>
> >> Are you sure you're not seeing places where you have NODATA in one
> raster or the other?
> >>
> >> On Tue, Jun 25, 2024 at 2:09?AM Ra?l Casado Barbero <
> raul.casado at eez.csic.es> wrote:
> >>> Hi,
> >>>
> >>> thank you both. Imodified the pipeline adding origin_x, origin_y, width
> >>> and height and now I get consistency inthe new rasters.
> >>>
> >>> The problem is that I still get negative values when I substract the
> MDT
> >>> to MDS. Could it be due to interpolation in the calculation of MDT? If
> I
> >>> get this raster by filtering the vegetation, could it be that values
> >>> lower than MDS appear in areas where there is vegetation?
> >>>
> >>>
> >>> Greetings.
> >>>
> >>> El 20/06/2024 a las 16:51, Connor Manning escribi?:
> >>>> For general information on how pipelines work:
> >>>> https://pdal.io/en/2.7-maintenance/pipeline.html
> >>>> And here is the information on the GDAL writer specifically, take a
> >>>> look at origin_x and origin_y:
> >>>>
> https://pdal.io/en/2.7-maintenance/stages/writers.gdal.html#writers-gdal
> >>>>
> >>>> For your pipelines, the GDAL writer is independently choosing its own
> >>>> grid each time since you have not specified an origin, so the pixels
> >>>> don't line up between the two outputs.  You want to explicitly set the
> >>>> same origin, via the above options, for both of your writers.gdal
> >>>> outputs to make sure they line up.
> >>>>
> >>>> - Connor
> >>>>
> >>>> On Thu, Jun 20, 2024 at 8:36?AM Ra?l Casado Barbero via pdal
> >>>> <pdal at lists.osgeo.org> wrote:
> >>>>> Hi Andrew and thaks for your answer.
> >>>>>
> >>>>> I'm pretty new with pdal just now and I'm tryingn to understand the
> logic of pipelines... What do you mean with set the origin on writers.gdal?
> >>>>>
> >>>>>
> >>>>> Ra?l.
> >>>>>
> >>>>> El 20/06/2024 a las 13:45, Andrew Bell escribi?:
> >>>>>
> >>>>> Hi Raul,
> >>>>>
> >>>>> You should set the origin on writers.gdal in order to get the
> consistency you desire. Without this, the origin is set according to the
> first point processed, which may differ between pipelines.
> >>>>>
> >>>>> On Thu, Jun 20, 2024 at 4:24?AM Ra?l Casado Barbero via pdal <
> pdal at lists.osgeo.org> wrote:
> >>>>>> Hi,
> >>>>>>
> >>>>>> my aim is to calculate the fitovolume of a shrub vegetation area.
> To do that I calculate the DSM, classify a point cloud with ground (2) and
> low vegetation (3) and then create a DTM.
> >>>>>>
> >>>>>> I use 2 different pipelines (see below) to do that modified from
> this post. But I have 2 issues:
> >>>>>>
> >>>>>> When I calculate the difference between DSM and DTM I get negative
> values
> >>>>>> The pixels of the DTM are horizontally displaced with respect to
> the DSM by half a pixel.
> >>>>>>
> >>>>>> Does anyone know why I am getting these negative values using this
> pipelines? Is anything wrong in the pipelines I`m using?
> >>>>>>
> >>>>>>
> >>>>>> Ra?l.
> >>>>>>
> >>>>>> Pipeline for DSM:
> >>>>>>
> >>>>>> [
> >>>>>>       "nubeRecortadaPdal_1.laz",
> >>>>>>       {
> >>>>>>           "type": "filters.range",
> >>>>>>           "limits":"returnnumber[1:1]"
> >>>>>>       },
> >>>>>>       {
> >>>>>>           "type": "writers.gdal",
> >>>>>>           "filename": "nubeRecortadaPdal_1_mds.tif",
> >>>>>>           "output_type": "idw",
> >>>>>>           "gdaldriver": "GTiff",
> >>>>>>           "resolution": 0.05,
> >>>>>>           "nodata": -9999,
> >>>>>>           "radius": 0.07,
> >>>>>>           "window_size": 50,
> >>>>>>           "data_type": "float32"
> >>>>>>       }
> >>>>>> ]
> >>>>>>
> >>>>>> Pipeline for DTM:
> >>>>>>
> >>>>>> [
> >>>>>>       "nubeRecortadaPdal_1.laz",
> >>>>>>       {
> >>>>>>           "type":"filters.overlay",
> >>>>>>           "dimension":"Classification",
> >>>>>>           "datasource":"D:/Datos/clasificadasVector.gpkg",
> >>>>>>           "layer":"ndviRandomForest",
> >>>>>>           "column":"Id"
> >>>>>>       },
> >>>>>>       {
> >>>>>>           "type":"filters.range",
> >>>>>>           "limits":"Classification[2:2]"
> >>>>>>       },
> >>>>>>       {
> >>>>>>           "type": "writers.gdal",
> >>>>>>           "filename": "nubeRecortadaPdal_1_mdt_ndviRf.tif",
> >>>>>>           "output_type": "idw",
> >>>>>>           "gdaldriver": "GTiff",
> >>>>>>           "resolution": 0.05,
> >>>>>>           "nodata": -9999,
> >>>>>>           "radius": 0.07,
> >>>>>>           "window_size": 100,
> >>>>>>           "data_type": "float32"
> >>>>>>       }
> >>>>>> ]
> >>>>>>
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> pdal mailing list
> >>>>>> pdal at lists.osgeo.org
> >>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
> >>>>>
> >>>>> --
> >>>>> Andrew Bell
> >>>>> andrew.bell.ia at gmail.com
> >>>>>
> >>>>> --
> >>>>> Ra?l Casado Barbero
> >>>>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >>>>> Estacion Experimental del Zaidin, CSIC
> >>>>> Calle Profesor Albareda 1, 18008 Granada, Spain
> >>>>> Phone: +34 958181600 VolP CSIC 439186
> >>>>>
> >>>>> _______________________________________________
> >>>>> pdal mailing list
> >>>>> pdal at lists.osgeo.org
> >>>>> https://lists.osgeo.org/mailman/listinfo/pdal
> >>> --
> >>> Ra?l Casado Barbero
> >>> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >>> Estacion Experimental del Zaidin, CSIC
> >>> Calle Profesor Albareda 1, 18008 Granada, Spain
> >>> Phone: +34 958181600 VolP CSIC 439186
> >>>
> >>
> >> --
> >> Andrew Bell
> >> andrew.bell.ia at gmail.com
> >>
> >> --
> >> Ra?l Casado Barbero
> >> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> >> Estacion Experimental del Zaidin, CSIC
> >> Calle Profesor Albareda 1, 18008 Granada, Spain
> >> Phone: +34 958181600 VolP CSIC 439186
>
> --
> Ra?l Casado Barbero
> Servicio de Evaluaci?n, Restauraci?n y Protecci?n de Agrosistemas
> Mediterr?neos
> Estacion Experimental del Zaidin, CSIC
> Calle Profesor Albareda 1, 18008 Granada, Spain
> Phone: +34 958181600 VolP CSIC 439186
>
>

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240626/3b005b9c/attachment-0001.htm>

From irvine.ford at gmail.com  Wed Jun 26 14:29:16 2024
From: irvine.ford at gmail.com (James Ford)
Date: Thu, 27 Jun 2024 09:29:16 +1200
Subject: [pdal] PDAL Python + Geopandas
Message-ID: <CAJwPz14gLkithUHV_BT3BLzfx8rNtSQF6w9xnrBzd=UvdA9wjw@mail.gmail.com>

Hello,

I am using the PDAL python bindings to read point clouds into geopandas
GeoDataFrames and then write them back to disc.

The approach I have works, but is slow. Is there a faster way of doing this?

The slowest part is converting from a GeoDataFrame back to a structured
numpy array.

Code below.

Thanks,

James

import pdal
import numpy as np
import pandas as pd
import geopandas as gpd

input_point_cloud_filepath = "..."

output_point_cloud_filepath = "..."

crs = "..."

#################### Read PC into Memory and convert to GeoDataFrame
####################

pipeline_stages = [
    pdal.Reader.copc(input_point_cloud_filepath),
    pdal.Filter.hag_nn()
]

pipeline = pdal.Pipeline(pipeline_stages)

_ = pipeline.execute()

pointcloud_dtype = pipeline.arrays[0].dtype

pointcloud_df = pipeline.get_dataframe(0)

pointcloud_gdf = gpd.GeoDataFrame(
    pointcloud_df,
    geometry=gpd.points_from_xy(pointcloud_df["X"], pointcloud_df["Y"],
pointcloud_df["Z"]),
    crs= crs ,
)

_ = pointcloud_gdf.sindex

########################## Manipulate PC via geopandas & numpy
##########################

# Do stuff here


########################### GeoDataFrame -> numpy -> pipeline
###########################

pointcloud_arr = np.array(
    (
        pointcloud_gdf
        .drop(columns=["geometry"])
        .apply(tuple, axis=1)
    ),
    dtype=pointcloud_dtype
)

output_pipeline = pdal.Filter.stats().pipeline(pointcloud_arr)

output_pipeline |= pdal.Writer.copc(
    output_point_cloud_filepath,
    forward="all",
    a_srs=crs,
)

_ = output_pipeline.execute()
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240627/6c687351/attachment.htm>

From schultz48 at yahoo.com  Wed Jun 26 03:08:18 2024
From: schultz48 at yahoo.com (Schultz Schultz)
Date: Wed, 26 Jun 2024 10:08:18 +0000 (UTC)
Subject: [pdal] HeightAboveGround
References: <726436405.5684626.1719396498549.ref@mail.yahoo.com>
Message-ID: <726436405.5684626.1719396498549@mail.yahoo.com>

Hello,
I am a beginner in pdal, python or any code based programs. I have worked with LiDAR point cloud but under terrascan/microstation in the past. Recently I have discovered this tool (PDAL) and I would like to learn to use it and to be able to create a complete classification pipeline. I have a problem though. I cannot understand how or where HeightAboveGround dimension is created. No matter what I did I could not see this dimension in a *.las file. Is it a virtual attribute(dimension)?, *.las file is not appropriate file type?...I have no idea. Hope that the question is not completely stupid. Any enlightenment will be well received. Thank you.
Regards,S
 
This is written on pdal website

filters.hag_delaunay?

The Height Above Ground Delaunay filter takes as input a point cloud withClassification set to 2 for ground points. It creates a new dimension,HeightAboveGround, that contains the normalized height values.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240626/1de32d50/attachment.htm>

From andrew.bell.ia at gmail.com  Thu Jun 27 06:00:36 2024
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 27 Jun 2024 09:00:36 -0400
Subject: [pdal] HeightAboveGround
In-Reply-To: <726436405.5684626.1719396498549@mail.yahoo.com>
References: <726436405.5684626.1719396498549.ref@mail.yahoo.com>
 <726436405.5684626.1719396498549@mail.yahoo.com>
Message-ID: <CACJ51z3-b=uuq+5E_ndVJ8Sir5Wy6PbAO2uGOqv=befm1DX2Dg@mail.gmail.com>

Hi,

The dimension is created by the filter you reference using an algorithm. It
can be written to a LAS file using the "extra dimension" support of that
file format. See the "extra_dims" option here:
https://pdal.io/en/latest/stages/writers.las.html



On Thu, Jun 27, 2024 at 8:05?AM Schultz Schultz via pdal <
pdal at lists.osgeo.org> wrote:

> Hello,
>
> I am a beginner in pdal, python or any code based programs. I have worked
> with LiDAR point cloud but under terrascan/microstation in the past.
> Recently I have discovered this tool (PDAL) and I would like to learn to
> use it and to be able to create a complete classification pipeline. I have
> a problem though. I cannot understand how or where HeightAboveGround
> dimension is created. No matter what I did I could not see this dimension
> in a *.las file. Is it a virtual attribute(dimension)?, *.las file is not
> appropriate file type?...I have no idea. Hope that the question is not
> completely stupid. Any enlightenment will be well received. Thank you.
>
> Regards,
> S
>
> This is written on pdal website
> filters.hag_delaunay?
> <https://pdal.io/en/2.7-maintenance/stages/filters.hag_delaunay.html#filters-hag-delaunay>
>
> The *Height Above Ground Delaunay filter* takes as input a point cloud
> with Classification set to 2 for ground points. It creates a new
> dimension, HeightAboveGround, that contains the normalized height values.
>
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240627/44ddcafe/attachment.htm>

From irvine.ford at gmail.com  Thu Jun 27 13:47:04 2024
From: irvine.ford at gmail.com (James Ford)
Date: Fri, 28 Jun 2024 08:47:04 +1200
Subject: [pdal] PDAL Python + Geopandas
In-Reply-To: <CAJwPz14gLkithUHV_BT3BLzfx8rNtSQF6w9xnrBzd=UvdA9wjw@mail.gmail.com>
References: <CAJwPz14gLkithUHV_BT3BLzfx8rNtSQF6w9xnrBzd=UvdA9wjw@mail.gmail.com>
Message-ID: <CAJwPz17cRY3-Qd7y-b5P0Wr+kgX3Gf4kc4m-CHqeN2rA8bL_9Q@mail.gmail.com>

Found what I was looking for in the current PDAL python bindings source
code.



Pipeline array -> pandas DataFrame:

Adapted from
https://github.com/PDAL/python/blob/main/src/pdal/pipeline.py#L48

pipeline = ...

_ = pipeline.execute()

idx = 0

arr = pipeline.arrays[idx]

df = pd.DataFrame(arr)



Pandas DataFrame / Geopandas GeoDataFrame -> pipeline:

gdf = ...

df = gdf.drop(columns=["geometry"])

arr = df.to_records()

pipeline = pdal.pipeline.Pipeline(arr)

On Thu, 27 Jun 2024 at 09:29, James Ford <irvine.ford at gmail.com> wrote:

> Hello,
>
> I am using the PDAL python bindings to read point clouds into geopandas
> GeoDataFrames and then write them back to disc.
>
> The approach I have works, but is slow. Is there a faster way of doing
> this?
>
> The slowest part is converting from a GeoDataFrame back to a structured
> numpy array.
>
> Code below.
>
> Thanks,
>
> James
>
> import pdal
> import numpy as np
> import pandas as pd
> import geopandas as gpd
>
> input_point_cloud_filepath = "..."
>
> output_point_cloud_filepath = "..."
>
> crs = "..."
>
> #################### Read PC into Memory and convert to GeoDataFrame
> ####################
>
> pipeline_stages = [
>     pdal.Reader.copc(input_point_cloud_filepath),
>     pdal.Filter.hag_nn()
> ]
>
> pipeline = pdal.Pipeline(pipeline_stages)
>
> _ = pipeline.execute()
>
> pointcloud_dtype = pipeline.arrays[0].dtype
>
> pointcloud_df = pipeline.get_dataframe(0)
>
> pointcloud_gdf = gpd.GeoDataFrame(
>     pointcloud_df,
>     geometry=gpd.points_from_xy(pointcloud_df["X"], pointcloud_df["Y"],
> pointcloud_df["Z"]),
>     crs= crs ,
> )
>
> _ = pointcloud_gdf.sindex
>
> ########################## Manipulate PC via geopandas & numpy
> ##########################
>
> # Do stuff here
>
>
> ########################### GeoDataFrame -> numpy -> pipeline
> ###########################
>
> pointcloud_arr = np.array(
>     (
>         pointcloud_gdf
>         .drop(columns=["geometry"])
>         .apply(tuple, axis=1)
>     ),
>     dtype=pointcloud_dtype
> )
>
> output_pipeline = pdal.Filter.stats().pipeline(pointcloud_arr)
>
> output_pipeline |= pdal.Writer.copc(
>     output_point_cloud_filepath,
>     forward="all",
>     a_srs=crs,
> )
>
> _ = output_pipeline.execute()
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20240628/7b2eded7/attachment.htm>

From howard at hobu.co  Fri Jun 28 06:31:21 2024
From: howard at hobu.co (Howard Butler)
Date: Fri, 28 Jun 2024 08:31:21 -0500
Subject: [pdal] PDAL 2.7.2 Released
Message-ID: <30C41D99-8804-49E8-9FD8-9AF93A69FED7@hobu.co>

All,

I have issued PDAL 2.7.2 which is a bug fix and documentation update maintenance release. 

See https://github.com/PDAL/PDAL/releases/tag/2.7.2 for details and expect builds via Conda throughout the next day or two.

Howard

