From stephen at smathermather.com  Wed Feb 15 10:04:51 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Wed, 15 Feb 2017 13:04:51 -0500
Subject: [pdal] poisson plus data
Message-ID: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>

Hi All,

I want to use poisson to filter my data but ideally I'd also retain all the
other original data (GPS time, Classification, etc.). What's the best way
to do this? It all gets dropped, even if I specify output_dims.

Thanks,
Best,
Steve
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/35b5b807/attachment.html>

From stephen at smathermather.com  Wed Feb 15 10:17:12 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Wed, 15 Feb 2017 13:17:12 -0500
Subject: [pdal] poisson plus data
In-Reply-To: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
Message-ID: <CAPkJWLXZkdXsJ_p1nUNO3HFE71tGcg1Xd59ZjjKuZm_AkZBnyg@mail.gmail.com>

For context, these are the data I'm trying to filter:
ftp://pamap.pasda.psu.edu/pamap_lidar/cycle1/LAS/South/2007/20000000/20001800PAS.zip

Cheers,
Best,
Steve



On Wed, Feb 15, 2017 at 1:04 PM, Stephen Mather <stephen at smathermather.com>
wrote:

> Hi All,
>
> I want to use poisson to filter my data but ideally I'd also retain all
> the other original data (GPS time, Classification, etc.). What's the best
> way to do this? It all gets dropped, even if I specify output_dims.
>
> Thanks,
> Best,
> Steve
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/e2e526d4/attachment.html>

From andrew.bell.ia at gmail.com  Wed Feb 15 10:20:56 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 15 Feb 2017 12:20:56 -0600
Subject: [pdal] poisson plus data
In-Reply-To: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
Message-ID: <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>

Can you please provide the pipeline and/or command line you're using in
this process?

On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <stephen at smathermather.com>
wrote:

> Hi All,
>
> I want to use poisson to filter my data but ideally I'd also retain all
> the other original data (GPS time, Classification, etc.). What's the best
> way to do this? It all gets dropped, even if I specify output_dims.
>
> Thanks,
> Best,
> Steve
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/fc5aa63d/attachment.html>

From stephen at smathermather.com  Wed Feb 15 10:25:07 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Wed, 15 Feb 2017 13:25:07 -0500
Subject: [pdal] poisson plus data
In-Reply-To: <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
 <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
Message-ID: <CAPkJWLUW2B81zjUSb6=4tX=3CU8OaiyFQ=dDqi-H_yNPviBpsA@mail.gmail.com>

Sure. This happens with the command and with the pipeline file, and
irrespective of output type (attempted with LAS and BPF). pdal translate
with the poisson filter specified is adequate to replicate though:

```docker run -v $(pwd)/data:/data pdal/pdal:1.4 pdal translate
/data/20001800PAS.las /data/resampled.las poisson```

Cheers,
Best,
Steve



On Wed, Feb 15, 2017 at 1:20 PM, Andrew Bell <andrew.bell.ia at gmail.com>
wrote:

> Can you please provide the pipeline and/or command line you're using in
> this process?
>
> On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <
> stephen at smathermather.com> wrote:
>
>> Hi All,
>>
>> I want to use poisson to filter my data but ideally I'd also retain all
>> the other original data (GPS time, Classification, etc.). What's the best
>> way to do this? It all gets dropped, even if I specify output_dims.
>>
>> Thanks,
>> Best,
>> Steve
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/d6622d0c/attachment.html>

From brad.chambers at gmail.com  Wed Feb 15 10:25:54 2017
From: brad.chambers at gmail.com (Bradley Chambers)
Date: Wed, 15 Feb 2017 18:25:54 +0000
Subject: [pdal] poisson plus data
In-Reply-To: <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
 <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
Message-ID: <CAJyqqPw3mfVGSg5aXp8DYgzLKbEswwfgQgkC0LPYLW_pJWtEkw@mail.gmail.com>

Steve,

If you are using http://www.pdal.io/stages/filters.sample.html, you should
be good. The original Poisson sampling method was funneled through PCL and
would drop dimensions in the conversion between PDAL and PCL, but that
should no longer be a problem with filters.sample.

Brad

On Wed, Feb 15, 2017 at 1:21 PM Andrew Bell <andrew.bell.ia at gmail.com>
wrote:

> Can you please provide the pipeline and/or command line you're using in
> this process?
>
> On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <
> stephen at smathermather.com> wrote:
>
> Hi All,
>
> I want to use poisson to filter my data but ideally I'd also retain all
> the other original data (GPS time, Classification, etc.). What's the best
> way to do this? It all gets dropped, even if I specify output_dims.
>
> Thanks,
> Best,
> Steve
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/b5f7a642/attachment.html>

From stephen at smathermather.com  Wed Feb 15 10:33:38 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Wed, 15 Feb 2017 13:33:38 -0500
Subject: [pdal] poisson plus data
In-Reply-To: <CAJyqqPw3mfVGSg5aXp8DYgzLKbEswwfgQgkC0LPYLW_pJWtEkw@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
 <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
 <CAJyqqPw3mfVGSg5aXp8DYgzLKbEswwfgQgkC0LPYLW_pJWtEkw@mail.gmail.com>
Message-ID: <CAPkJWLXniRLGGZGmt31HQikHtnYib8eONBnWTbsm=S4P19j0DQ@mail.gmail.com>

Ace. That fixes it. Thanks!

On Wed, Feb 15, 2017 at 1:25 PM, Bradley Chambers <brad.chambers at gmail.com>
wrote:

> Steve,
>
> If you are using http://www.pdal.io/stages/filters.sample.html, you
> should be good. The original Poisson sampling method was funneled through
> PCL and would drop dimensions in the conversion between PDAL and PCL, but
> that should no longer be a problem with filters.sample.
>
> Brad
>
> On Wed, Feb 15, 2017 at 1:21 PM Andrew Bell <andrew.bell.ia at gmail.com>
> wrote:
>
>> Can you please provide the pipeline and/or command line you're using in
>> this process?
>>
>> On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <
>> stephen at smathermather.com> wrote:
>>
>> Hi All,
>>
>> I want to use poisson to filter my data but ideally I'd also retain all
>> the other original data (GPS time, Classification, etc.). What's the best
>> way to do this? It all gets dropped, even if I specify output_dims.
>>
>> Thanks,
>> Best,
>> Steve
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>>
>>
>>
>> --
>> Andrew Bell
>> andrew.bell.ia at gmail.com
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/32a8d6f0/attachment-0001.html>

From brad.chambers at gmail.com  Wed Feb 15 10:36:03 2017
From: brad.chambers at gmail.com (Bradley Chambers)
Date: Wed, 15 Feb 2017 18:36:03 +0000
Subject: [pdal] poisson plus data
In-Reply-To: <CAPkJWLUW2B81zjUSb6=4tX=3CU8OaiyFQ=dDqi-H_yNPviBpsA@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
 <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
 <CAPkJWLUW2B81zjUSb6=4tX=3CU8OaiyFQ=dDqi-H_yNPviBpsA@mail.gmail.com>
Message-ID: <CAJyqqPygJfPf+abgdEpaitMGULE8gyUqQu0Z9yynC82vBqjpbA@mail.gmail.com>

Also, and we need to clear this up in the docs, even though filters.sample
is performing Poisson sampling, it should not be confused with the Poisson
filter that you invoked, which is Poisson surface reconstruction (
http://www.pdal.io/stages/filters.poisson.html).

On Wed, Feb 15, 2017 at 1:33 PM Stephen Mather <stephen at smathermather.com>
wrote:

> Sure. This happens with the command and with the pipeline file, and
> irrespective of output type (attempted with LAS and BPF). pdal translate
> with the poisson filter specified is adequate to replicate though:
>
> ```docker run -v $(pwd)/data:/data pdal/pdal:1.4 pdal translate
> /data/20001800PAS.las /data/resampled.las poisson```
>
> Cheers,
> Best,
> Steve
>
>
>
> On Wed, Feb 15, 2017 at 1:20 PM, Andrew Bell <andrew.bell.ia at gmail.com>
> wrote:
>
> Can you please provide the pipeline and/or command line you're using in
> this process?
>
> On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <
> stephen at smathermather.com> wrote:
>
> Hi All,
>
> I want to use poisson to filter my data but ideally I'd also retain all
> the other original data (GPS time, Classification, etc.). What's the best
> way to do this? It all gets dropped, even if I specify output_dims.
>
> Thanks,
> Best,
> Steve
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/a641ac5b/attachment.html>

From stephen at smathermather.com  Wed Feb 15 10:47:28 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Wed, 15 Feb 2017 13:47:28 -0500
Subject: [pdal] poisson plus data
In-Reply-To: <CAJyqqPygJfPf+abgdEpaitMGULE8gyUqQu0Z9yynC82vBqjpbA@mail.gmail.com>
References: <CAPkJWLXZi9Kd4Pi4tv8AVfjHD8hZWVAqHeYWKBTpbz=Y=yaZSg@mail.gmail.com>
 <CACJ51z08JLzsDJFrCNO-fuS-Gvpd1Gqo8PCcGfvjk4mb2=vEzg@mail.gmail.com>
 <CAPkJWLUW2B81zjUSb6=4tX=3CU8OaiyFQ=dDqi-H_yNPviBpsA@mail.gmail.com>
 <CAJyqqPygJfPf+abgdEpaitMGULE8gyUqQu0Z9yynC82vBqjpbA@mail.gmail.com>
Message-ID: <CAPkJWLV-UJmugiOZy40U7LmV6gaOdwta6HOhg+-MV9mHraxfDw@mail.gmail.com>

Ah yes, I was confused about that. If only I had read the first line of the
documentation "The Poisson filter passes data through the Point Cloud
Library (PCL <http://www.pointclouds.org>) Poisson surface reconstruction
algorithm."

:)

Cheers,
Best,
Steve



On Wed, Feb 15, 2017 at 1:36 PM, Bradley Chambers <brad.chambers at gmail.com>
wrote:

> Also, and we need to clear this up in the docs, even though filters.sample
> is performing Poisson sampling, it should not be confused with the Poisson
> filter that you invoked, which is Poisson surface reconstruction (
> http://www.pdal.io/stages/filters.poisson.html).
>
> On Wed, Feb 15, 2017 at 1:33 PM Stephen Mather <stephen at smathermather.com>
> wrote:
>
>> Sure. This happens with the command and with the pipeline file, and
>> irrespective of output type (attempted with LAS and BPF). pdal translate
>> with the poisson filter specified is adequate to replicate though:
>>
>> ```docker run -v $(pwd)/data:/data pdal/pdal:1.4 pdal translate
>> /data/20001800PAS.las /data/resampled.las poisson```
>>
>> Cheers,
>> Best,
>> Steve
>>
>>
>>
>> On Wed, Feb 15, 2017 at 1:20 PM, Andrew Bell <andrew.bell.ia at gmail.com>
>> wrote:
>>
>> Can you please provide the pipeline and/or command line you're using in
>> this process?
>>
>> On Wed, Feb 15, 2017 at 12:04 PM, Stephen Mather <
>> stephen at smathermather.com> wrote:
>>
>> Hi All,
>>
>> I want to use poisson to filter my data but ideally I'd also retain all
>> the other original data (GPS time, Classification, etc.). What's the best
>> way to do this? It all gets dropped, even if I specify output_dims.
>>
>> Thanks,
>> Best,
>> Steve
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>>
>>
>>
>> --
>> Andrew Bell
>> andrew.bell.ia at gmail.com
>>
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170215/fe2cc84b/attachment.html>

From stephen at smathermather.com  Fri Feb 17 20:25:43 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Fri, 17 Feb 2017 23:25:43 -0500
Subject: [pdal] pdal pipeline filters.reprojection
Message-ID: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>

Trying to process data from 2011-2012 USACE NCMP Topobathy Lidar: Lake Erie
<https://coast.noaa.gov/htdata/lidar1_z/geoid12a/data/3662/> (specifically
this tile
<https://coast.noaa.gov/htdata/lidar1_z/geoid12a/data/3662/20110802_2012_NCMP_OH_Erie_24_GeoClassified_LAS_NAVD88.laz>
).

JSON:

{

  "pipeline":[

    "/data/20001800PAS.las",

    {

      "type":"readers.las",

      "spatialreference":"EPSG:4269",

      "filename":"/data/20001800PAS.las"

    },

    {

      "type":"filters.reprojection",

      "out_srs":"EPSG:3734"

    },

    {

      "type":"filters.sample",

      "radius":"5"

    },

    {

      "type":"writers.las",

      "filename":"/data/poisson_8-16.las"

    }

  ]

}

docker run -v $(pwd)/data:/data pdal/pdal:1.4 pdal pipeline
/data/pipeline.json --readers.las.filename=/data/lakefront.laz
--writers.las.filename=/data/filtered.laz

I get the following error:

(pdal pipeline filters.reprojection Error: 0): GDAL failure (1) failed to
load datum shift file

I was hoping by specifying the input spatialreference I could dodge this
error, but alas... .

AFAIK, these are the same datums (data?):
http://spatialreference.org/ref/epsg/4269/
http://spatialreference.org/ref/epsg/3734/

What am I missing?
Thanks in advance,
Best,
Steve
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170217/05a7bccc/attachment.html>

From howard at hobu.co  Fri Feb 17 20:59:32 2017
From: howard at hobu.co (Howard Butler)
Date: Fri, 17 Feb 2017 22:59:32 -0600
Subject: [pdal] pdal pipeline filters.reprojection
In-Reply-To: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
References: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
Message-ID: <0F2EFE92-D708-466E-96A4-3622608FA22A@hobu.co>

You need the datum files added to your docker image. I shut that off because they were quite heavy and we were trying to put our docker image on a diet.

Make a new Dockerfile with the following (commented out at the moment in https://github.com/PDAL/PDAL/blob/master/scripts/docker/dependencies/Dockerfile#L248)

> FROM pdal/pdal:1.4
> MAINTAINER Howard Butler <howard at hobu.co>
> 
> 
> RUN apt-get update && apt-get install -y --fix-missing --no-install-recommends \
>         wget \
>     && rm -rf /var/lib/apt/lists/*
> 
> RUN mkdir /vdatum \
>     && cd /vdatum \
>     && wget http://download.osgeo.org/proj/vdatum/usa_geoid2012.zip && unzip -j -u usa_geoid2012.zip -d /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/usa_geoid2009.zip && unzip -j -u usa_geoid2009.zip -d /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/usa_geoid2003.zip && unzip -j -u usa_geoid2003.zip -d /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/usa_geoid1999.zip && unzip -j -u usa_geoid1999.zip -d /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/vertcon/vertconc.gtx && mv vertconc.gtx /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/vertcon/vertcone.gtx && mv vertcone.gtx /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/vertcon/vertconw.gtx && mv vertconw.gtx /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/egm96_15/egm96_15.gtx && mv egm96_15.gtx /usr/share/proj \
>     && wget http://download.osgeo.org/proj/vdatum/egm08_25/egm08_25.gtx && mv egm08_25.gtx /usr/share/proj \
>     && rm -rf /vdatum
> 


Then go build a new container:

> docker build -t pdal/datum  - < Dockerfile


The GeoTIFF info in that file does look ok, but if you wanted to hammer it, you might do so like this:

> {
>   "pipeline":[
>     {
>       "type":"readers.las",
>       "spatialreference":"EPSG:4269+5703",
>       "filename":"/data/20110802_2012_NCMP_OH_Erie_24_GeoClassified_LAS_NAVD88.laz"
>     },
>     {
>       "type":"filters.reprojection",
>       "out_srs":"EPSG:3734"
>     },
>     {
>       "type":"filters.sample",
>       "radius":"5"
>     },
>     {
>       "type":"writers.las",
>       "filename":"/data/poisson_8-16.las"
>     }
>   ]
> }

Finally, run your docker environment with the noise turned up to see GDAL/Proj.4 doing your datum transform:

> docker run --env CPL_DEBUG=ON --env PROJ_DEBUG=ON -v `pwd`:/data pdal/datum pdal pipeline /data/erie.json

Hope this helps,

Howard

> On Feb 17, 2017, at 10:25 PM, Stephen Mather <stephen at smathermather.com> wrote:
> 
> Trying to process data from 2011-2012 USACE NCMP Topobathy Lidar: Lake Erie (specifically this tile).
> 
> JSON:
> {
>   "pipeline":[
>     "/data/20001800PAS.las",
>     {
>       "type":"readers.las",
>       "spatialreference":"EPSG:4269",
>       "filename":"/data/20001800PAS.las"
>     },
>     {
>       "type":"filters.reprojection",
>       "out_srs":"EPSG:3734"
>     },
>     {
>       "type":"filters.sample",
>       "radius":"5"
>     },
>     {
>       "type":"writers.las",
>       "filename":"/data/poisson_8-16.las"
>     }
>   ]
> }
> 
> docker run -v $(pwd)/data:/data pdal/pdal:1.4 pdal pipeline /data/pipeline.json --readers.las.filename=/data/lakefront.laz --writers.las.filename=/data/filtered.laz
> 
> I get the following error:
> 
> (pdal pipeline filters.reprojection Error: 0): GDAL failure (1) failed to load datum shift file
> 
> I was hoping by specifying the input spatialreference I could dodge this error, but alas... .
> 
> AFAIK, these are the same datums (data?):
> http://spatialreference.org/ref/epsg/4269/
> http://spatialreference.org/ref/epsg/3734/
> 
> What am I missing?
> Thanks in advance,
> Best,
> Steve
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal


From howard at hobu.co  Sat Feb 18 17:39:22 2017
From: howard at hobu.co (Howard Butler)
Date: Sat, 18 Feb 2017 19:39:22 -0600
Subject: [pdal] pdal pipeline filters.reprojection
In-Reply-To: <CAPkJWLXzOV_wx=jsKy6qNJDTRzZyXg3wcM_DCF8RikTA7W1i-g@mail.gmail.com>
References: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
 <0F2EFE92-D708-466E-96A4-3622608FA22A@hobu.co>
 <CAPkJWLUaRedrm1Vg2n7NdSjcZvfr2H2L5JsHtpB_2QbRkKb91w@mail.gmail.com>
 <CAPkJWLXzOV_wx=jsKy6qNJDTRzZyXg3wcM_DCF8RikTA7W1i-g@mail.gmail.com>
Message-ID: <22E62EC7-3A75-4213-98E4-5C7EED4635FB@hobu.co>


> On Feb 18, 2017, at 7:08 PM, Stephen Mather <stephen at smathermather.com> wrote:
> 
> https://smathermather.com/2017/02/18/taking-slices-from-lidar-data-part-viii/

You might use another filters.range to toss out high absolute scan angles, and then sample from the set you have left. This will bias your sampling to get keep more nadir'y points, which may or may not be what you're going after.

Howard

From stephen at smathermather.com  Sat Feb 18 19:23:37 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Sat, 18 Feb 2017 22:23:37 -0500
Subject: [pdal] pdal pipeline filters.reprojection
In-Reply-To: <22E62EC7-3A75-4213-98E4-5C7EED4635FB@hobu.co>
References: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
 <0F2EFE92-D708-466E-96A4-3622608FA22A@hobu.co>
 <CAPkJWLUaRedrm1Vg2n7NdSjcZvfr2H2L5JsHtpB_2QbRkKb91w@mail.gmail.com>
 <CAPkJWLXzOV_wx=jsKy6qNJDTRzZyXg3wcM_DCF8RikTA7W1i-g@mail.gmail.com>
 <22E62EC7-3A75-4213-98E4-5C7EED4635FB@hobu.co>
Message-ID: <CAPkJWLUSyJDFaKp0aRD2CKrNDA_V3q_S=bAMRNDicw+Q4vCYDg@mail.gmail.com>

Excellent idea, but I don't think this dataset includes scan angle:
https://gist.github.com/anonymous/3f5f5bbb9a3d55affea168620fbde6f1

"average": 0,
"count": 58768299,
"maximum": 0,
"minimum": 0,
"name": "ScanAngleRank",
"position": 9,
"stddev": 0,
"variance": 0


On Sat, Feb 18, 2017 at 8:39 PM, Howard Butler <howard at hobu.co> wrote:

>
> > On Feb 18, 2017, at 7:08 PM, Stephen Mather <stephen at smathermather.com>
> wrote:
> >
> > https://smathermather.com/2017/02/18/taking-slices-from-
> lidar-data-part-viii/
>
> You might use another filters.range to toss out high absolute scan angles,
> and then sample from the set you have left. This will bias your sampling to
> get keep more nadir'y points, which may or may not be what you're going
> after.
>
> Howard
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170218/115eff39/attachment.html>

From howard at hobu.co  Sat Feb 18 19:29:51 2017
From: howard at hobu.co (Howard Butler)
Date: Sat, 18 Feb 2017 21:29:51 -0600
Subject: [pdal] pdal pipeline filters.reprojection
In-Reply-To: <CAPkJWLUSyJDFaKp0aRD2CKrNDA_V3q_S=bAMRNDicw+Q4vCYDg@mail.gmail.com>
References: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
 <0F2EFE92-D708-466E-96A4-3622608FA22A@hobu.co>
 <CAPkJWLUaRedrm1Vg2n7NdSjcZvfr2H2L5JsHtpB_2QbRkKb91w@mail.gmail.com>
 <CAPkJWLXzOV_wx=jsKy6qNJDTRzZyXg3wcM_DCF8RikTA7W1i-g@mail.gmail.com>
 <22E62EC7-3A75-4213-98E4-5C7EED4635FB@hobu.co>
 <CAPkJWLUSyJDFaKp0aRD2CKrNDA_V3q_S=bAMRNDicw+Q4vCYDg@mail.gmail.com>
Message-ID: <9D863FCD-8E77-43E2-9890-96D03CD6958F@hobu.co>

Are the overlap areas classified? The stats for Classification indicate a range of values...

> On Feb 18, 2017, at 9:23 PM, Stephen Mather <stephen at smathermather.com> wrote:
> 
> Excellent idea, but I don't think this dataset includes scan angle:
> https://gist.github.com/anonymous/3f5f5bbb9a3d55affea168620fbde6f1
> 
>         "average": 0,
>         "count": 58768299,
>         "maximum": 0,
>         "minimum": 0,
>         "name": "ScanAngleRank",
>         "position": 9,
>         "stddev": 0,
>         "variance": 0
> 
> 
>> On Sat, Feb 18, 2017 at 8:39 PM, Howard Butler <howard at hobu.co> wrote:
>> 
>> > On Feb 18, 2017, at 7:08 PM, Stephen Mather <stephen at smathermather.com> wrote:
>> >
>> > https://smathermather.com/2017/02/18/taking-slices-from-lidar-data-part-viii/
>> 
>> You might use another filters.range to toss out high absolute scan angles, and then sample from the set you have left. This will bias your sampling to get keep more nadir'y points, which may or may not be what you're going after.
>> 
>> Howard
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170218/d1cd2e6d/attachment-0001.html>

From stephen at smathermather.com  Sat Feb 18 20:10:22 2017
From: stephen at smathermather.com (Stephen Mather)
Date: Sat, 18 Feb 2017 23:10:22 -0500
Subject: [pdal] pdal pipeline filters.reprojection
In-Reply-To: <9D863FCD-8E77-43E2-9890-96D03CD6958F@hobu.co>
References: <CAPkJWLVnObSg1UBmsbweoC9-5fvekeQh8JMOVbMzbKHXStcV5w@mail.gmail.com>
 <0F2EFE92-D708-466E-96A4-3622608FA22A@hobu.co>
 <CAPkJWLUaRedrm1Vg2n7NdSjcZvfr2H2L5JsHtpB_2QbRkKb91w@mail.gmail.com>
 <CAPkJWLXzOV_wx=jsKy6qNJDTRzZyXg3wcM_DCF8RikTA7W1i-g@mail.gmail.com>
 <22E62EC7-3A75-4213-98E4-5C7EED4635FB@hobu.co>
 <CAPkJWLUSyJDFaKp0aRD2CKrNDA_V3q_S=bAMRNDicw+Q4vCYDg@mail.gmail.com>
 <9D863FCD-8E77-43E2-9890-96D03CD6958F@hobu.co>
Message-ID: <CAPkJWLVNy2VwaaDuzpKt96BGzc1tkxcqFfaWewBv1np0f5qcsw@mail.gmail.com>

Maxes out at 11... . No overlap.

On Sat, Feb 18, 2017 at 10:29 PM, Howard Butler <howard at hobu.co> wrote:

> Are the overlap areas classified? The stats for Classification indicate a
> range of values...
>
> On Feb 18, 2017, at 9:23 PM, Stephen Mather <stephen at smathermather.com>
> wrote:
>
> Excellent idea, but I don't think this dataset includes scan angle:
> https://gist.github.com/anonymous/3f5f5bbb9a3d55affea168620fbde6f1
>
> "average": 0,
> "count": 58768299,
> "maximum": 0,
> "minimum": 0,
> "name": "ScanAngleRank",
> "position": 9,
> "stddev": 0,
> "variance": 0
>
>
> On Sat, Feb 18, 2017 at 8:39 PM, Howard Butler <howard at hobu.co> wrote:
>
>>
>> > On Feb 18, 2017, at 7:08 PM, Stephen Mather <stephen at smathermather.com>
>> wrote:
>> >
>> > https://smathermather.com/2017/02/18/taking-slices-from-lida
>> r-data-part-viii/
>>
>> You might use another filters.range to toss out high absolute scan
>> angles, and then sample from the set you have left. This will bias your
>> sampling to get keep more nadir'y points, which may or may not be what
>> you're going after.
>>
>> Howard
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170218/e95079f4/attachment.html>

From Adam.Steer at anu.edu.au  Thu Feb 23 17:17:33 2017
From: Adam.Steer at anu.edu.au (Adam Steer)
Date: Fri, 24 Feb 2017 01:17:33 +0000
Subject: [pdal] tindex creating empty geometry column
Message-ID: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>

I’m making tile indexes for a set of LAS tiles, and getting no geometry column:

# pdal tindex act_8ppm_index4326.sqlite "LAS/AHD/*.las" -f "SQLite" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary

# sqlite3 act_8ppm_index4326.sqlite

sqlite> PRAGMA table_info(pdal);
0|OGC_FID|INTEGER|0||1
1|GEOMETRY|BLOB|0||0
2|location|VARCHAR(254)|0||0
3|srs|VARCHAR(254)|0||0
4|modified|TIMESTAMP|0||0
5|created|TIMESTAMP|0||0

sqlite> select * from pdal;
34||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6886100_55_0002_0002.las|EPSG:4326|2016-11-25T01:08:31|2017-02-07T00:02:54
35||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6866076_55_0002_0002.las|EPSG:4326|2016-11-25T00:53:45|2017-02-07T00:02:54
…

…here, the second column GEOMETRY is empty - it should contain a blob of geometry data.

Where have I gone astray?

On this topic - do hooks exist in the tindex system to extract these data (tile boundaries) from a postGIS store?

Thanks

Adam


From howard at hobu.co  Fri Feb 24 11:25:56 2017
From: howard at hobu.co (Howard Butler)
Date: Fri, 24 Feb 2017 13:25:56 -0600
Subject: [pdal] tindex creating empty geometry column
In-Reply-To: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
Message-ID: <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>

Adam,

We're just using OGR to write the SQLite file, which I think defaults to using spatialite, but I'm not exactly sure.

You might try writing to a shapefile or something to see if it is merely the OGR driver falling over:

> $ pdal tindex act_8ppm_index4326.shp  "LAS/AHD/*.las" -f "ESRI Shapefile" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary

Hope this helps,

Howard

> On Feb 23, 2017, at 7:17 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
> 
> I’m making tile indexes for a set of LAS tiles, and getting no geometry column:
> 
> # pdal tindex act_8ppm_index4326.sqlite "LAS/AHD/*.las" -f "SQLite" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
> 
> # sqlite3 act_8ppm_index4326.sqlite
> 
> sqlite> PRAGMA table_info(pdal);
> 0|OGC_FID|INTEGER|0||1
> 1|GEOMETRY|BLOB|0||0
> 2|location|VARCHAR(254)|0||0
> 3|srs|VARCHAR(254)|0||0
> 4|modified|TIMESTAMP|0||0
> 5|created|TIMESTAMP|0||0
> 
> sqlite> select * from pdal;
> 34||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6886100_55_0002_0002.las|EPSG:4326|2016-11-25T01:08:31|2017-02-07T00:02:54
> 35||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6866076_55_0002_0002.las|EPSG:4326|2016-11-25T00:53:45|2017-02-07T00:02:54
> …
> 
> …here, the second column GEOMETRY is empty - it should contain a blob of geometry data.
> 
> Where have I gone astray?
> 
> On this topic - do hooks exist in the tindex system to extract these data (tile boundaries) from a postGIS store?
> 
> Thanks
> 
> Adam
> 
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal


From andrew.bell.ia at gmail.com  Fri Feb 24 11:32:20 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 24 Feb 2017 13:32:20 -0600
Subject: [pdal] tindex creating empty geometry column
In-Reply-To: <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
Message-ID: <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>

On Fri, Feb 24, 2017 at 1:25 PM, Howard Butler <howard at hobu.co> wrote:

> Adam,
>
> We're just using OGR to write the SQLite file, which I think defaults to
> using spatialite, but I'm not exactly sure.
>
> You might try writing to a shapefile or something to see if it is merely
> the OGR driver falling over:
>
> > $ pdal tindex act_8ppm_index4326.shp  "LAS/AHD/*.las" -f "ESRI
> Shapefile" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
>
> Hope this helps,
>
> Howard
>
> > On Feb 23, 2017, at 7:17 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
> >
> > I’m making tile indexes for a set of LAS tiles, and getting no geometry
> column:
> >
> > # pdal tindex act_8ppm_index4326.sqlite "LAS/AHD/*.las" -f "SQLite"
> --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
> >
> > # sqlite3 act_8ppm_index4326.sqlite
> >
> > sqlite> PRAGMA table_info(pdal);
> > 0|OGC_FID|INTEGER|0||1
> > 1|GEOMETRY|BLOB|0||0
> > 2|location|VARCHAR(254)|0||0
> > 3|srs|VARCHAR(254)|0||0
> > 4|modified|TIMESTAMP|0||0
> > 5|created|TIMESTAMP|0||0
> >
> > sqlite> select * from pdal;
> > 34||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-
> AHD_6886100_55_0002_0002.las|EPSG:4326|2016-11-25T01:08:31|
> 2017-02-07T00:02:54
> > 35||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-
> AHD_6866076_55_0002_0002.las|EPSG:4326|2016-11-25T00:53:45|
> 2017-02-07T00:02:54
> > …
> >
> > …here, the second column GEOMETRY is empty - it should contain a blob of
> geometry data.
> >
> > Where have I gone astray?
> >
> > On this topic - do hooks exist in the tindex system to extract these
> data (tile boundaries) from a postGIS store?
> >
> > Thanks
> >
> > Adam
> >
> > _______________________________________________
> > pdal mailing list
> > pdal at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/pdal
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>

You might also try running with the log level turned up:

pdal tindex --verbose=Debug ...

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170224/5831ea26/attachment.html>

From Adam.Steer at anu.edu.au  Mon Feb 27 20:31:26 2017
From: Adam.Steer at anu.edu.au (Adam Steer)
Date: Tue, 28 Feb 2017 04:31:26 +0000
Subject: [pdal] tindex creating empty geometry column. Index creation
 makes an index, but PDAL: readers.tindex: Unexpected argument 'merge'.
In-Reply-To: <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
 <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
Message-ID: <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>

Thanks Andrew, Howard.

I can create geometries which can be loaded into QGIS - so clearly the lack of some binary blob symbol in sqlite’s 'select * from…’ is not a real issue.

It appears the OGR drivers are working, and I’ve learned a lot in the past two days - nearly answering my own question about PostGIS. Short summary: OGR has a method for injecting data straight into a postgres store - but PDAL seems to want a filename to write to. I’ll revisit that later.

So why is merging inside a clipping polygon from a tindex failing then? Following this example: https://www.pdal.io/stages/readers.tindex.html

I get: 
PDAL: readers.tindex: Unexpected argument 'merge’.

..with the pipeline below (mostly copy and paste from one which used to work).

What's the current way of of passing a clipping polygon over a tile index? Happy to write into readers.tindex docs and make a pull request once working :)

Thanks

Adam



--
{
 "pipeline":[
   {
     "type": "readers.tindex",
     "sql": "SELECT * from pdal",
     "filename":"/data/act_8ppm.sqlite",
     "where":"location LIKE \"%ACT2015_8ppm-C3-AHD%\" ",
     "wkt":"POLYGON((149.0896224975586 -35.25812600834376,149.08790588378906 -35.26485397359959,149.08721923828125 -35.27326314463213,149.08653259277344 -35.27942931528233,149.0899658203125 -35.284193761969895,149.09820556640625 -35.28363325338022,149.10472869873047 -35.28111091671122,149.10438537597656 -35.27046018460613,149.10850524902344 -35.26933897343947,149.1126251220703 -35.26289170810056,149.10747528076172 -35.25980805202397,149.09889221191406 -35.260368725492896,149.0896224975586 -35.25812600834376))",
     "merge": "true"
   },
   {
     "type":"writers.las",
     "filename":"/data/outputfile.laz"
   }
 ]
}






> On 25 Feb 2017, at 6:32 am, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> 
> On Fri, Feb 24, 2017 at 1:25 PM, Howard Butler <howard at hobu.co> wrote:
> Adam,
> 
> We're just using OGR to write the SQLite file, which I think defaults to using spatialite, but I'm not exactly sure.
> 
> You might try writing to a shapefile or something to see if it is merely the OGR driver falling over:
> 
> > $ pdal tindex act_8ppm_index4326.shp  "LAS/AHD/*.las" -f "ESRI Shapefile" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
> 
> Hope this helps,
> 
> Howard
> 
> > On Feb 23, 2017, at 7:17 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
> >
> > I’m making tile indexes for a set of LAS tiles, and getting no geometry column:
> >
> > # pdal tindex act_8ppm_index4326.sqlite "LAS/AHD/*.las" -f "SQLite" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
> >
> > # sqlite3 act_8ppm_index4326.sqlite
> >
> > sqlite> PRAGMA table_info(pdal);
> > 0|OGC_FID|INTEGER|0||1
> > 1|GEOMETRY|BLOB|0||0
> > 2|location|VARCHAR(254)|0||0
> > 3|srs|VARCHAR(254)|0||0
> > 4|modified|TIMESTAMP|0||0
> > 5|created|TIMESTAMP|0||0
> >
> > sqlite> select * from pdal;
> > 34||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6886100_55_0002_0002.las|EPSG:4326|2016-11-25T01:08:31|2017-02-07T00:02:54
> > 35||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6866076_55_0002_0002.las|EPSG:4326|2016-11-25T00:53:45|2017-02-07T00:02:54
> > …
> >
> > …here, the second column GEOMETRY is empty - it should contain a blob of geometry data.
> >
> > Where have I gone astray?
> >
> > On this topic - do hooks exist in the tindex system to extract these data (tile boundaries) from a postGIS store?
> >
> > Thanks
> >
> > Adam
> >
> > _______________________________________________
> > pdal mailing list
> > pdal at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/pdal
> 
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
> 
> You might also try running with the log level turned up:
> 
> pdal tindex --verbose=Debug ...
> 
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com


From howard at hobu.co  Mon Feb 27 22:11:38 2017
From: howard at hobu.co (Howard Butler)
Date: Tue, 28 Feb 2017 00:11:38 -0600
Subject: [pdal] tindex creating empty geometry column. Index creation
 makes an index, but PDAL: readers.tindex: Unexpected argument 'merge'.
In-Reply-To: <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
 <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
 <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>
Message-ID: <FC6C182E-901F-4A47-9190-F2A898617EB4@hobu.co>


> On Feb 27, 2017, at 10:31 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
> 
> Thanks Andrew, Howard.
> 
> I can create geometries which can be loaded into QGIS - so clearly the lack of some binary blob symbol in sqlite’s 'select * from…’ is not a real issue.
> 
> It appears the OGR drivers are working, and I’ve learned a lot in the past two days - nearly answering my own question about PostGIS. Short summary: OGR has a method for injecting data straight into a postgres store - but PDAL seems to want a filename to write to. I’ll revisit that later.

I think you mean the ExecuteSQL method of OGR datasource, and no we don't expose that to the readers.tindex at the moment. 


> 
> So why is merging inside a clipping polygon from a tindex failing then? Following this example: https://www.pdal.io/stages/readers.tindex.html
> 
> I get: 
> PDAL: readers.tindex: Unexpected argument 'merge’.

hmm, something must be broken here. I would expect this to work..

> 
> ..with the pipeline below (mostly copy and paste from one which used to work).
> 
> What's the current way of of passing a clipping polygon over a tile index? Happy to write into readers.tindex docs and make a pull request once working :)
> 
> Thanks
> 
> Adam
> 
> 
> 
> --
> {
> "pipeline":[
>   {
>     "type": "readers.tindex",
>     "sql": "SELECT * from pdal",
>     "filename":"/data/act_8ppm.sqlite",
>     "where":"location LIKE \"%ACT2015_8ppm-C3-AHD%\" ",
>     "wkt":"POLYGON((149.0896224975586 -35.25812600834376,149.08790588378906 -35.26485397359959,149.08721923828125 -35.27326314463213,149.08653259277344 -35.27942931528233,149.0899658203125 -35.284193761969895,149.09820556640625 -35.28363325338022,149.10472869873047 -35.28111091671122,149.10438537597656 -35.27046018460613,149.10850524902344 -35.26933897343947,149.1126251220703 -35.26289170810056,149.10747528076172 -35.25980805202397,149.09889221191406 -35.260368725492896,149.0896224975586 -35.25812600834376))",
>     "merge": "true"
>   },
>   {
>     "type":"writers.las",
>     "filename":"/data/outputfile.laz"
>   }
> ]
> }
> 
> 
> 
> 
> 
> 
>> On 25 Feb 2017, at 6:32 am, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
>> 
>> On Fri, Feb 24, 2017 at 1:25 PM, Howard Butler <howard at hobu.co> wrote:
>> Adam,
>> 
>> We're just using OGR to write the SQLite file, which I think defaults to using spatialite, but I'm not exactly sure.
>> 
>> You might try writing to a shapefile or something to see if it is merely the OGR driver falling over:
>> 
>>> $ pdal tindex act_8ppm_index4326.shp  "LAS/AHD/*.las" -f "ESRI Shapefile" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
>> 
>> Hope this helps,
>> 
>> Howard
>> 
>>> On Feb 23, 2017, at 7:17 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
>>> 
>>> I’m making tile indexes for a set of LAS tiles, and getting no geometry column:
>>> 
>>> # pdal tindex act_8ppm_index4326.sqlite "LAS/AHD/*.las" -f "SQLite" --lyr_name "pdal" --t_srs "EPSG:4326" —fast_boundary
>>> 
>>> # sqlite3 act_8ppm_index4326.sqlite
>>> 
>>> sqlite> PRAGMA table_info(pdal);
>>> 0|OGC_FID|INTEGER|0||1
>>> 1|GEOMETRY|BLOB|0||0
>>> 2|location|VARCHAR(254)|0||0
>>> 3|srs|VARCHAR(254)|0||0
>>> 4|modified|TIMESTAMP|0||0
>>> 5|created|TIMESTAMP|0||0
>>> 
>>> sqlite> select * from pdal;
>>> 34||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6886100_55_0002_0002.las|EPSG:4326|2016-11-25T01:08:31|2017-02-07T00:02:54
>>> 35||/mnt/pointcloud/act_all/8ppm/LAS/AHD/ACT2015_8ppm-C3-AHD_6866076_55_0002_0002.las|EPSG:4326|2016-11-25T00:53:45|2017-02-07T00:02:54
>>> …
>>> 
>>> …here, the second column GEOMETRY is empty - it should contain a blob of geometry data.
>>> 
>>> Where have I gone astray?
>>> 
>>> On this topic - do hooks exist in the tindex system to extract these data (tile boundaries) from a postGIS store?
>>> 
>>> Thanks
>>> 
>>> Adam
>>> 
>>> _______________________________________________
>>> pdal mailing list
>>> pdal at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/pdal
>> 
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>> 
>> You might also try running with the log level turned up:
>> 
>> pdal tindex --verbose=Debug ...
>> 
>> -- 
>> Andrew Bell
>> andrew.bell.ia at gmail.com
> 


From andrew.bell.ia at gmail.com  Tue Feb 28 10:41:11 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 28 Feb 2017 12:41:11 -0600
Subject: [pdal] tindex creating empty geometry column. Index creation
 makes an index, but PDAL: readers.tindex: Unexpected argument 'merge'.
In-Reply-To: <FC6C182E-901F-4A47-9190-F2A898617EB4@hobu.co>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
 <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
 <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>
 <FC6C182E-901F-4A47-9190-F2A898617EB4@hobu.co>
Message-ID: <CACJ51z2fqUtjA7yUEr14RYk6QxstobMNHH+mtjkaFeTfLVBGsg@mail.gmail.com>

On Tue, Feb 28, 2017 at 12:11 AM, Howard Butler <howard at hobu.co> wrote:

>
> > On Feb 27, 2017, at 10:31 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:
> >
> > Thanks Andrew, Howard.
> >
> > I can create geometries which can be loaded into QGIS - so clearly the
> lack of some binary blob symbol in sqlite’s 'select * from…’ is not a real
> issue.
> >
> > It appears the OGR drivers are working, and I’ve learned a lot in the
> past two days - nearly answering my own question about PostGIS. Short
> summary: OGR has a method for injecting data straight into a postgres store
> - but PDAL seems to want a filename to write to. I’ll revisit that later.
>
> I think you mean the ExecuteSQL method of OGR datasource, and no we don't
> expose that to the readers.tindex at the moment.
>
>
> >
> > So why is merging inside a clipping polygon from a tindex failing then?
> Following this example: https://www.pdal.io/stages/readers.tindex.html
> >
> > I get:
> > PDAL: readers.tindex: Unexpected argument 'merge’.
>
> hmm, something must be broken here. I would expect this to work..


The error is correct.  The example in the documentation is wrong.  You
should probably use the kernel to extract data based on the index.  It
builds a pipeline and invokes the stage "readers.tindex" automatically.
I'll try to update the documentation.

>From your previous tindex creation I think it should be something like:

pdal tindex --merge --tindex "/data/act_8ppm.sqlite" --lyr_name pdal
--filename "/data/outputfile.laz" --polygon "POLYGON((149.0896224975586
-35.25812600834376,149.08790588378906 -35.26485397359959,149.08721923828125
-35.27326314463213,149.08653259277344 -35.27942931528233,149.0899658203125
-35.284193761969895,149.09820556640625
-35.28363325338022,149.10472869873047 -35.28111091671122,149.10438537597656
-35.27046018460613,149.10850524902344 -35.26933897343947,149.1126251220703
-35.26289170810056,149.10747528076172 -35.25980805202397,149.09889221191406
-35.260368725492896,149.0896224975586 -35.25812600834376))"

If you want to filter the layer, you'll have to add --readers.tindex.where
"location LIKE \"%ACT2015_8ppm-C3-AHD%\"

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170228/65842cfb/attachment.html>

From Adam.Steer at anu.edu.au  Tue Feb 28 14:21:43 2017
From: Adam.Steer at anu.edu.au (Adam Steer)
Date: Tue, 28 Feb 2017 22:21:43 +0000
Subject: [pdal] tindex creating empty geometry column. Index creation
 makes an index, but PDAL: readers.tindex: Unexpected argument 'merge'.
In-Reply-To: <CACJ51z2fqUtjA7yUEr14RYk6QxstobMNHH+mtjkaFeTfLVBGsg@mail.gmail.com>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
 <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
 <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>
 <FC6C182E-901F-4A47-9190-F2A898617EB4@hobu.co>
 <CACJ51z2fqUtjA7yUEr14RYk6QxstobMNHH+mtjkaFeTfLVBGsg@mail.gmail.com>
Message-ID: <97E19C26-AC28-4944-BB78-42F57983A630@anu.edu.au>


Interesting. This conflicts with an earlier suggestion from Howard [1], which worked - and most importantly fit into the PDAL pipeline workflow.

> From your previous tindex creation I think it should be something like:
> 
> pdal tindex --merge --tindex "/data/act_8ppm.sqlite" --lyr_name pdal --filespec "/data/outputfile.laz" --polygon "POLYGON((149.0896224975586 -35.25812600834376,149.08790588378906 -35.26485397359959,149.08721923828125 -35.27326314463213,149.08653259277344 -35.27942931528233,149.0899658203125 -35.284193761969895,149.09820556640625 -35.28363325338022,149.10472869873047 -35.28111091671122,149.10438537597656 -35.27046018460613,149.10850524902344 -35.26933897343947,149.1126251220703 -35.26289170810056,149.10747528076172 -35.25980805202397,149.09889221191406 -35.260368725492896,149.0896224975586 -35.25812600834376))"
> 
> If you want to filter the layer, you'll have to add --readers.tindex.where "location LIKE \"%ACT2015_8ppm-C3-AHD%\”

I’ve got a PDAL 1.3 instance lurking around, I’ll do some testing with that,  since that’s where the pipeline approach last worked.

My testing in the last few days has been in the dockerised PDAL 1.4 on MacOS, and PDAL built from source on CentOS, pulled about two weeks ago.

Thanks again

Adam

[1] https://lists.osgeo.org/pipermail/pdal/2016-October/001077.html


From andrew.bell.ia at gmail.com  Tue Feb 28 15:11:01 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 28 Feb 2017 17:11:01 -0600
Subject: [pdal] tindex creating empty geometry column. Index creation
 makes an index, but PDAL: readers.tindex: Unexpected argument 'merge'.
In-Reply-To: <97E19C26-AC28-4944-BB78-42F57983A630@anu.edu.au>
References: <D767FDC1-B5EE-4A22-A6D4-18B2C68AC01E@anu.edu.au>
 <BA7AC0EA-EC98-402C-B392-DC49CFD51A59@hobu.co>
 <CACJ51z1QbAwL1krss6_Z+so2naSFYeAbSoKt3mHWfqGXwak67A@mail.gmail.com>
 <4F4C0D9A-1FC8-4AFC-9F2F-AE1DBAFF6F01@anu.edu.au>
 <FC6C182E-901F-4A47-9190-F2A898617EB4@hobu.co>
 <CACJ51z2fqUtjA7yUEr14RYk6QxstobMNHH+mtjkaFeTfLVBGsg@mail.gmail.com>
 <97E19C26-AC28-4944-BB78-42F57983A630@anu.edu.au>
Message-ID: <CACJ51z2QRMFM9-QQGjp6EYPbQ45QZMQaE6M20Z9Xe-=gE=gdWg@mail.gmail.com>

There's nothing wrong with the other method.  I was trying to give you
something that might be easier to use.  There's a bunch of overlap in
functionality.  The command line method will allow you to do this kind of
thing without building a separate pipeline file, which is useful to many.

On Tue, Feb 28, 2017 at 4:21 PM, Adam Steer <Adam.Steer at anu.edu.au> wrote:

>
> Interesting. This conflicts with an earlier suggestion from Howard [1],
> which worked - and most importantly fit into the PDAL pipeline workflow.


> > From your previous tindex creation I think it should be something like:
> >
> > pdal tindex --merge --tindex "/data/act_8ppm.sqlite" --lyr_name pdal
> --filespec "/data/outputfile.laz" --polygon "POLYGON((149.0896224975586
> -35.25812600834376,149.08790588378906 -35.26485397359959,149.08721923828125
> -35.27326314463213,149.08653259277344 -35.27942931528233,149.0899658203125
> -35.284193761969895,149.09820556640625 -35.28363325338022,149.10472869873047
> -35.28111091671122,149.10438537597656 -35.27046018460613,149.10850524902344
> -35.26933897343947,149.1126251220703 -35.26289170810056,149.10747528076172
> -35.25980805202397,149.09889221191406 -35.260368725492896,149.0896224975586
> -35.25812600834376))"
> >
> > If you want to filter the layer, you'll have to add
> --readers.tindex.where "location LIKE \"%ACT2015_8ppm-C3-AHD%\”
>
> I’ve got a PDAL 1.3 instance lurking around, I’ll do some testing with
> that,  since that’s where the pipeline approach last worked.
>
> My testing in the last few days has been in the dockerised PDAL 1.4 on
> MacOS, and PDAL built from source on CentOS, pulled about two weeks ago.
>
> Thanks again
>
> Adam
>
> [1] https://lists.osgeo.org/pipermail/pdal/2016-October/001077.html
>
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170228/9ec8c633/attachment.html>

