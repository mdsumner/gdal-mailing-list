From howard at hobu.co  Fri Aug  5 11:58:38 2022
From: howard at hobu.co (Howard Butler)
Date: Fri, 5 Aug 2022 13:58:38 -0500
Subject: [pdal] PDAL 2.4.3 Released
Message-ID: <18EA503F-F50A-44C2-95FB-9BA5DAC3485C@hobu.co>

All,

The PDAL development team is pleased to announce that PDAL 2.4.3 is released. Conda packages and other binaries should be updated in upcoming days.

> # Changes of Note
> 
> - A significant memory leak in LAZ decompression was fixed #3814 
> - PDAL's website is migrating to @readthedocs Thanks @j9ac9k! #3782 
> 
> # Enhancements
> 
> - `writers.copc` remote file writing was added #3819 
> - `filters.overlay` `bounds` option added #3815 
> - [laz-perf](github.com/hobuinc/laz-perf/) vendored code updated to 3.1.0 release #3821 
> - Arbiter credentials now support profiles #3792 
> 
> 
> # Bug Fixes
> 
> - Significant LAZ decompression memory leak #3814 
> - `filters.normal` was using an invalid LogPtr #3781 
> - `readers.las.nosrs` did not work correctly #3818 
> - Windows unicode filename fixes and enhancements #3824 
> - No longer warn when encountering GDAL 64bit integer #3802 
> - Export `pdal::StageExtensions::defaultReader` #3806 

https://github.com/PDAL/PDAL/releases/tag/2.4.3

Howard

From vnandigam at ucsd.edu  Fri Aug  5 13:33:02 2022
From: vnandigam at ucsd.edu (Nandigam, Viswanath)
Date: Fri, 5 Aug 2022 20:33:02 +0000
Subject: [pdal] PDAL pipeline issues with large datasets
In-Reply-To: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
References: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
Message-ID: <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>

Hi All,
I?m trying to get pdal pipeline working with the latest install of pdal via conda. It works for very small areas but is erroring out on larger selections.

The pipeline.json file is

{
  "pipeline": [{
    "type": "readers.ept",
    "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json",
    "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"
  },
  {
    "type":"filters.reprojection",
    "in_srs":"EPSG:3857",
    "out_srs":"EPSG:32616"
  },{
    "type" : "writers.las",
    "filename": "points.laz",
    "a_srs": "EPSG:32616"
  }]}


The version of pdal (via conda) is

pdal --version
-----------------------------------------------------
pdal 2.4.2 (git-version: e4772e)
-----------------------------------------------------

I have tried it on two machines with both Ubuntu 22.04 LTS and Ubuntu 18.04.
It seems to work with PDAL version 2.4.1.

I see the following error:
PDAL: readers.las: VLR 1(SF/0) size too large -- flows into point data.

Maybe I?m missing something. Is anyone else having this issue? Can anyone please advice?
Thank you!
- Vishu

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220805/1e62ba51/attachment.htm>

From howard at hobu.co  Fri Aug  5 13:34:04 2022
From: howard at hobu.co (Howard Butler)
Date: Fri, 5 Aug 2022 15:34:04 -0500
Subject: [pdal] PDAL pipeline issues with large datasets
In-Reply-To: <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>
References: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
 <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>
Message-ID: <E763904A-2C35-4FFA-ACA0-E1F2C8703C88@hobu.co>



> On Aug 5, 2022, at 3:33 PM, Nandigam, Viswanath <vnandigam at ucsd.edu> wrote:
> 
> Hi All,
> I?m trying to get pdal pipeline working with the latest install of pdal via conda. It works for very small areas but is erroring out on larger selections.
> 
> The pipeline.json file is
> 
> {
>   "pipeline": [{
>     "type": "readers.ept",
>     "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json",
>     "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"
>   },
>   {
>     "type":"filters.reprojection",
>     "in_srs":"EPSG:3857",
>     "out_srs":"EPSG:32616"
>   },{
>     "type" : "writers.las",
>     "filename": "points.laz",
>     "a_srs": "EPSG:32616"
>   }]}
> 
> 
> The version of pdal (via conda) is
> 
> pdal --version
> -----------------------------------------------------
> pdal 2.4.2 (git-version: e4772e)
> -----------------------------------------------------
> 
> I have tried it on two machines with both Ubuntu 22.04 LTS and Ubuntu 18.04.
> It seems to work with PDAL version 2.4.1.
> 
> I see the following error:
>> PDAL: readers.las: VLR 1(SF/0) size too large -- flows into point data.
> 
> Maybe I?m missing something. Is anyone else having this issue? Can anyone please advice? 
> Thank you!

I think the issue is one of the LAZ tiles in that EPT is bad.


From vnandigam at ucsd.edu  Fri Aug  5 14:44:09 2022
From: vnandigam at ucsd.edu (Nandigam, Viswanath)
Date: Fri, 5 Aug 2022 21:44:09 +0000
Subject: [pdal] PDAL pipeline issues with large datasets
In-Reply-To: <E763904A-2C35-4FFA-ACA0-E1F2C8703C88@hobu.co>
References: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
 <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>
 <E763904A-2C35-4FFA-ACA0-E1F2C8703C88@hobu.co>
Message-ID: <C3E464C1-5C8B-4FB3-99F7-87B70E6B0218@ucsd.edu>

Hi Howard,
It looks like an issue with other datasets as well. This works fine in the 2.4.1 version of PDAL but fails with 2.4.2.
For example this pipeline file also has the same issue:

{
    "pipeline": [{
        "type": "readers.ept",
        "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/NC_HurricaneFlorence_4_2020/ept.json",
        "bounds": "([-8726998.51984671, -8723414.496106366], [4353500.799531042,4356350.524642287])"
    },
    {
        "type":"filters.reprojection",
        "in_srs":"EPSG:3857",
        "out_srs":"EPSG:32617"
    },{
        "type" : "writers.las",
        "filename": "points.laz",
        "a_srs": "EPSG:32617"
    }]}


But a smaller area works fine with PDAL 2.4.2:

{
    "pipeline": [{
        "type": "readers.ept",
        "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/NC_HurricaneFlorence_4_2020/ept.json",
        "bounds": "([-8726177.25654457, -8725958.025231255], [4354975.9833829915,4355134.666378456])"
    },
    {
        "type":"filters.reprojection",
        "in_srs":"EPSG:3857",
        "out_srs":"EPSG:32617"
    },{
        "type" : "writers.las",
        "filename": "points.laz",
        "a_srs": "EPSG:32617"
    }]}

- Vishu



> On Aug 5, 2022, at 1:34 PM, Howard Butler <howard at hobu.co> wrote:
> 
> 
> 
>> On Aug 5, 2022, at 3:33 PM, Nandigam, Viswanath <vnandigam at ucsd.edu> wrote:
>> 
>> Hi All,
>> I?m trying to get pdal pipeline working with the latest install of pdal via conda. It works for very small areas but is erroring out on larger selections.
>> 
>> The pipeline.json file is
>> 
>> {
>>  "pipeline": [{
>>    "type": "readers.ept",
>>    "filename": "https://urldefense.com/v3/__https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json__;!!Mih3wA!C2u_-GeGjgNG7WYj-fL-7YiN55JN5s1fZEfp9-22Vq_zIzMwsYv5lr7ZlNk0tC77Bfthm_OiC_uB0pom$ ",
>>    "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"
>>  },
>>  {
>>    "type":"filters.reprojection",
>>    "in_srs":"EPSG:3857",
>>    "out_srs":"EPSG:32616"
>>  },{
>>    "type" : "writers.las",
>>    "filename": "points.laz",
>>    "a_srs": "EPSG:32616"
>>  }]}
>> 
>> 
>> The version of pdal (via conda) is
>> 
>> pdal --version
>> -----------------------------------------------------
>> pdal 2.4.2 (git-version: e4772e)
>> -----------------------------------------------------
>> 
>> I have tried it on two machines with both Ubuntu 22.04 LTS and Ubuntu 18.04.
>> It seems to work with PDAL version 2.4.1.
>> 
>> I see the following error:
>>> PDAL: readers.las: VLR 1(SF/0) size too large -- flows into point data.
>> 
>> Maybe I?m missing something. Is anyone else having this issue? Can anyone please advice? 
>> Thank you!
> 
> I think the issue is one of the LAZ tiles in that EPT is bad.
> 


From michael.smith.erdc at gmail.com  Fri Aug  5 14:55:05 2022
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Fri, 05 Aug 2022 17:55:05 -0400
Subject: [pdal] PDAL pipeline issues with large datasets
Message-ID: <DCF84818-F2BB-4CD5-8F2B-51D771ECBC68@gmail.com>

Vishu,

 

I just ran this slightly modified successfully:

{

? "pipeline": [{

??? "type": "readers.ept",

??? "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json",

??? "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"

? },

? {

??? "type":"filters.reprojection",

??? "in_srs":"EPSG:3857",

??? "out_srs":"EPSG:32616"

? },{

??? "type" : "writers.las",

??? "filename": "points.laz",

??? "forward": "all"

? }]}

 

 

pdal pipeline test_pipe.json -v 8

(PDAL Debug) Debugging...

(pdal pipeline readers.ept Debug) Query bounds: ([-9666713.882998705, -9662911.140841518], [4283077.817410117, 4287281.853965801], [-1.797693134862316e+308, 1.797693134862316e+308])

Threads: 15

(pdal pipeline Debug) Executing pipeline in stream mode.

(pdal pipeline writers.las Debug) Wrote 64357942 points to the LAS file

 

 

pdal info points.laz --metadata

{

? "file_size": 365318431,

? "filename": "points.laz",

? "metadata":

? {

??? "comp_spatialreference": "PROJCS[\"WGS 84 / UTM zone 16N

 

 

-- 

Michael Smith

US Army Corps / Remote Sensing GIS Center

 

 

 

From: pdal <pdal-bounces at lists.osgeo.org> on behalf of "Nandigam, Viswanath" <vnandigam at ucsd.edu>
Date: Friday, August 5, 2022 at 4:33 PM
To: "pdal at lists.osgeo.org" <pdal at lists.osgeo.org>
Subject: [pdal] PDAL pipeline issues with large datasets

 

Hi All,

I?m trying to get pdal pipeline working with the latest install of pdal via conda. It works for very small areas but is erroring out on larger selections.

 

The pipeline.json file is

 

{

  "pipeline": [{

    "type": "readers.ept",

    "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json",

    "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"

  },

  {

    "type":"filters.reprojection",

    "in_srs":"EPSG:3857",

    "out_srs":"EPSG:32616"

  },{

    "type" : "writers.las",

    "filename": "points.laz",

    "a_srs": "EPSG:32616"

  }]}

 

 

The version of pdal (via conda) is

 

pdal --version
-----------------------------------------------------
pdal 2.4.2 (git-version: e4772e)
----------------------------------------------------- 

 

I have tried it on two machines with both Ubuntu 22.04 LTS and Ubuntu 18.04.

It seems to work with PDAL version 2.4.1.

 

I see the following error:

PDAL: readers.las: VLR 1(SF/0) size too large -- flows into point data.



Maybe I?m missing something. Is anyone else having this issue? Can anyone please advice? 

Thank you!

- Vishu




_______________________________________________ pdal mailing list pdal at lists.osgeo.org https://lists.osgeo.org/mailman/listinfo/pdal 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220805/e09b5652/attachment.htm>

From michael.smith.erdc at gmail.com  Fri Aug  5 14:56:45 2022
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Fri, 05 Aug 2022 17:56:45 -0400
Subject: [pdal] PDAL pipeline issues with large datasets
Message-ID: <1BB28762-07B7-4DCF-A3A0-A5518AC6D091@gmail.com>

Also, the conda version of 2.4.2 should show 

 

pdal --version

------------------------------------------------------------------------------------------------------------------------------------------------------

pdal 2.4.2 (git-version: Release)

 

 

Maybe you need to recreate your conda install or use the conda version of pdal if you are not. 

 

Mike

 

 

-- 

Michael Smith

US Army Corps / Remote Sensing GIS Center

 

 

 

From: pdal <pdal-bounces at lists.osgeo.org> on behalf of "Nandigam, Viswanath" <vnandigam at ucsd.edu>
Date: Friday, August 5, 2022 at 4:33 PM
To: "pdal at lists.osgeo.org" <pdal at lists.osgeo.org>
Subject: [pdal] PDAL pipeline issues with large datasets

 

Hi All,

I?m trying to get pdal pipeline working with the latest install of pdal via conda. It works for very small areas but is erroring out on larger selections.

 

The pipeline.json file is

 

{

  "pipeline": [{

    "type": "readers.ept",

    "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/USGS_LPC_TN_Middle_B2_2018_LAS_2019/ept.json",

    "bounds": "([-9666713.882998705, -9662911.140841518], [4283077.817410117,4287281.853965801])"

  },

  {

    "type":"filters.reprojection",

    "in_srs":"EPSG:3857",

    "out_srs":"EPSG:32616"

  },{

    "type" : "writers.las",

    "filename": "points.laz",

    "a_srs": "EPSG:32616"

  }]}

 

 

The version of pdal (via conda) is

 

pdal --version
-----------------------------------------------------
pdal 2.4.2 (git-version: e4772e)
----------------------------------------------------- 

 

I have tried it on two machines with both Ubuntu 22.04 LTS and Ubuntu 18.04.

It seems to work with PDAL version 2.4.1.

 

I see the following error:

PDAL: readers.las: VLR 1(SF/0) size too large -- flows into point data.



Maybe I?m missing something. Is anyone else having this issue? Can anyone please advice? 

Thank you!

- Vishu




_______________________________________________ pdal mailing list pdal at lists.osgeo.org https://lists.osgeo.org/mailman/listinfo/pdal 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220805/e788f548/attachment.htm>

From Karl.Keller at kci.com  Sun Aug  7 06:03:39 2022
From: Karl.Keller at kci.com (Karl Keller)
Date: Sun, 7 Aug 2022 13:03:39 +0000
Subject: [pdal] Full PDAL Pipeline - RANSAC and ICP
Message-ID: <SJ1PR12MB6026405654768AC51304F8EEF7609@SJ1PR12MB6026.namprd12.prod.outlook.com>

Just a follow up on my point cloud processing effort.  I settled on using Open3D's global+refinement for registration and use that transformation to convert the registered target cloud to a file using filters.transformation.

That makes for about a 7 step process of registration, transformation, cleaning, merge, decimation, normals processing, and mesh generation.  Code is in python using PDAL API to drive the pipeline execution.  There's a nice example of a multi-dimensional 'add_dimension' when computing the new dimensions with vector (np) math.  Worked beautifully - although I (perhaps like many others) fumbled over math.sqrt vs np.sqrt in the implementation before getting my vector hat on squarely.  Scalar habits die hard.

Thanks for the initial guidance into Open3D for that registration step.  Would be nice to see FGR and RANSAC make it into the PDAL filters pipeline of course.  I tested both and settled on RANSAC + IPL (point-to-plane).  ICP point-to-point is just a tough haul, especially in giant clouds with many alignments generating the target RMSE. 

- Karl

-----Original Message-----
From: Karl Keller 
Sent: Wednesday, July 20, 2022 1:15 PM
To: Howard Butler <howard at hobu.co>; pdal at lists.osgeo.org
Subject: RE: [pdal] Hello Intro

I came across the point reduction approach on the Matlab site initially, saw it a couple of other places, and put other elements of PDAL to good use slicing and dicing my source and target scan worlds.  It's certainly fast enough - we typically have 50-100 scan worlds to align and those registrations were very fast.  So, hope was in full bloom!  I was planning on getting the transformation from the first, low density registration and then apply it to create a transformed dense target, use that transformed dense scan as source for the next registration, etc.  The transformations surprised me.  In the metadata I was getting a lot of non-converged registrations that were close but not close enough - fitness of ~.5.  Also, the transformations had multiple x,y,z components in the transformation attribute of the meta file.  I made the assumption this was the non-converged aspect of the solution, played around with it a bit to transform the dense clouds but all were bad alignments.  Anyway, I'm willing to admit that perhaps 50% of this is user error and the other 50% wrong expectations.

The vision was to have the daisy-chained registrations feeding into pipelines for producing a joined mesh, using EPT/Potree to visualize, and then get on with the analysis tasks on the merged cloud.  Parallelism seemed like a non-starter in this although I did consider doing a task breakdown with autoscaling similar to the ODM/OpenSFM approach.  For instance, register individual rows of scans in parallel, then join up the head and tail scans. But truthfully, if the whole thing took 7 hrs and was unaided - that would have been a big win.

-----Original Message-----
From: Howard Butler <howard at hobu.co> 
Sent: Wednesday, July 20, 2022 10:19 AM
To: pdal at lists.osgeo.org
Cc: Karl Keller <Karl.Keller at kci.com>
Subject: Re: [pdal] Hello Intro

Karl,

You also don't probably need full density data to compute the transforms. A common approach to this is to divide and conquer by running ICP over smaller patches. Both EPT and COPC would allow you to have a data source that is amenable to controlling how to process across all of the data.

As always, parallelization is not PDAL's prerogative. Running PDAL filters with computational complexities that vary widely based on their settings is tough. PDAL doesn't know your data and cant do that adaptation in parallel. 

Howard

> On Jul 20, 2022, at 7:22 AM, Andrew Bell <andrew.bell.ia at gmail.com> wrote:
> 
> ICP for 20M points is likely to take a really, really long time. You will probably have to do something else. You're only getting out a single transformation anyway. Perhaps you should look at the various methods provided by Open3D:
> 
> http://www.open3d.org/docs/release/tutorial/pipelines/index.html
> 
> On Tue, Jul 19, 2022 at 10:54 AM Karl Keller <Karl.Keller at kci.com> wrote:
> Hello PDAL community members.  Not sure how to get started so I?ll tell you about my interest in PDAL.
> 
>  
> 
> I?m using PDAL with the aim of building pipelines for various LIDAR processing workflows.  As a first step, I?ve been trying to use ICP registration without a lot of luck.  I?ve spent time following PJHartzell?s work on this to try and get a leg up.  If anyone has guidance in fast ways to automatically register relatively dense clouds in the 20M point range, I would be grateful.  Right now, I use sampling before registration to get a transform (quickly) and apply it to the full cloud.  Unfortunately, I?m not achieving < 300 mm accuracy and have yet to get convergence.
> 
>  
> 
> Looking forward to interacting with this group.
> 
>  
> 
> 	? Karl
>  
> 
> Karl S Keller
> 
> Senior Systems Engineer
> 
>  
> 
> <image001.png> 
> 
>  
> 
> KCI TECHNOLOGIES INC.
> 
> 936 Ridgebrook Road | Sparks, MD | 21152
> 
> Karl.Keller at kci.com
> 
> m: 540-827-7786
> 
> http://www.kci.com
> 
>  
> 
> <image002.jpg>
> 
>  
> 
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
> 
> 
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal


From howard at hobu.co  Sun Aug  7 09:02:12 2022
From: howard at hobu.co (Howard Butler)
Date: Sun, 7 Aug 2022 11:02:12 -0500
Subject: [pdal] PDAL pipeline issues with large datasets
In-Reply-To: <C3E464C1-5C8B-4FB3-99F7-87B70E6B0218@ucsd.edu>
References: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
 <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>
 <E763904A-2C35-4FFA-ACA0-E1F2C8703C88@hobu.co>
 <C3E464C1-5C8B-4FB3-99F7-87B70E6B0218@ucsd.edu>
Message-ID: <EA25C688-761A-460B-B3C5-F182B9B55A1F@hobu.co>

This seems to be working just fine for me with PDAL 2.4.3 that's available on Conda Forge. Can you easily try that one?

Howard

> pdal pipeline --debug --verbose 7 vishu.json
> (PDAL Debug) Debugging...
> (pdal pipeline readers.ept Debug) Query bounds: ([-8726998.519846709, -8723414.496106366], [4353500.799531042, 4356350.524642287], [-1.797693134862316e+308, 1.797693134862316e+308])
> Threads: 15
> (pdal pipeline Debug) Executing pipeline in stream mode.
> (pdal pipeline readers.ept Warning) 193323331 will be downloaded
> (pdal pipeline writers.las Debug) Wrote 182125216 points to the LAS file



> On Aug 5, 2022, at 4:44 PM, Nandigam, Viswanath <vnandigam at ucsd.edu> wrote:
> 
> It looks like an issue with other datasets as well. This works fine in the 2.4.1 version of PDAL but fails with 2.4.2.
> For example this pipeline file also has the same issue:
> 
> {
> "pipeline": [{
> "type": "readers.ept",
> "filename": "https://s3-us-west-2.amazonaws.com/usgs-lidar-public/NC_HurricaneFlorence_4_2020/ept.json",
> "bounds": "([-8726998.51984671, -8723414.496106366], [4353500.799531042,4356350.524642287])"
> },
> {
> "type":"filters.reprojection",
> "in_srs":"EPSG:3857",
> "out_srs":"EPSG:32617"
> },{
> "type" : "writers.las",
> "filename": "points.laz",
> "a_srs": "EPSG:32617"
> }]}


From vnandigam at ucsd.edu  Sun Aug  7 18:28:20 2022
From: vnandigam at ucsd.edu (Nandigam, Viswanath)
Date: Mon, 8 Aug 2022 01:28:20 +0000
Subject: [pdal] PDAL pipeline issues with large datasets
In-Reply-To: <EA25C688-761A-460B-B3C5-F182B9B55A1F@hobu.co>
References: <EE20D540-B247-49BE-BA91-EF58BE52E159@ucsd.edu>
 <0B13307F-61AF-40E0-88CB-B670FF9C8E04@ucsd.edu>
 <E763904A-2C35-4FFA-ACA0-E1F2C8703C88@hobu.co>
 <C3E464C1-5C8B-4FB3-99F7-87B70E6B0218@ucsd.edu>
 <EA25C688-761A-460B-B3C5-F182B9B55A1F@hobu.co>
Message-ID: <56732D99-BCD9-4661-BE0A-CA0918F1DECE@ucsd.edu>

Hi Howard,
Thanks! Updating to PDAL 2.4.3 (git-version: 7d56ee via conda) seems to have fixed the issue. Thank you for pushing that out! Much appreciated!
- Vishu



> On Aug 7, 2022, at 9:02 AM, Howard Butler <howard at hobu.co> wrote:
> 
> This seems to be working just fine for me with PDAL 2.4.3 that's available on Conda Forge. Can you easily try that one?
> 
> Howard
> 
>> pdal pipeline --debug --verbose 7 vishu.json
>> (PDAL Debug) Debugging...
>> (pdal pipeline readers.ept Debug) Query bounds: ([-8726998.519846709, -8723414.496106366], [4353500.799531042, 4356350.524642287], [-1.797693134862316e+308, 1.797693134862316e+308])
>> Threads: 15
>> (pdal pipeline Debug) Executing pipeline in stream mode.
>> (pdal pipeline readers.ept Warning) 193323331 will be downloaded
>> (pdal pipeline writers.las Debug) Wrote 182125216 points to the LAS file
> 
> 
> 
>> On Aug 5, 2022, at 4:44 PM, Nandigam, Viswanath <vnandigam at ucsd.edu> wrote:
>> 
>> It looks like an issue with other datasets as well. This works fine in the 2.4.1 version of PDAL but fails with 2.4.2.
>> For example this pipeline file also has the same issue:
>> 
>> {
>> "pipeline": [{
>> "type": "readers.ept",
>> "filename": "https://urldefense.com/v3/__https://s3-us-west-2.amazonaws.com/usgs-lidar-public/NC_HurricaneFlorence_4_2020/ept.json__;!!Mih3wA!DIBrmOdVyqNPrEXWVv27tMIEM6NqrMUUzF-9LbTXoBz3fb98VTazY1I4QMgt3xAH034fK8Fx5Gur3BEO$ ",
>> "bounds": "([-8726998.51984671, -8723414.496106366], [4353500.799531042,4356350.524642287])"
>> },
>> {
>> "type":"filters.reprojection",
>> "in_srs":"EPSG:3857",
>> "out_srs":"EPSG:32617"
>> },{
>> "type" : "writers.las",
>> "filename": "points.laz",
>> "a_srs": "EPSG:32617"
>> }]}
> 


From bkgelder at iastate.edu  Mon Aug 15 10:53:38 2022
From: bkgelder at iastate.edu (Gelder, Brian K [A&BE])
Date: Mon, 15 Aug 2022 17:53:38 +0000
Subject: [pdal] Python pipeline not reading ept.json
Message-ID: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>

Hello,
I'm a pdal newbie and I'm trying to figure out how to successfully read ept.json files. I have pdal 2.4.2 installed via Conda on Python 3.9 on Win 10 and am able to use the pipeline to process local datasets like interesting.las in the tutorials. However, when I try to read EPT web resources, like in https://pdal.io/en/latest/tutorial/iowa-entwine.html, I receive the following error:

Traceback (most recent call last):
  File "<pyshell#15>", line 1, in <module>
    pipeline2.validate()
  File "C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pdal-testing-env\lib\site-packages\pdal\pipeline.py", line 43, in validate
    return self.p.validate()
  File "libpdalpython.pyx", line 185, in pdal.libpdalpython.PyPipeline.validate
RuntimeError: readers.ept: Could not read from s3-us-west-2.amazonaws.com/usgs-lidar-public/IA_FullState/ept.json

I get similar failure when I tried to query the smaller Hurricane Florence dataset Vishu wrote about last week. I can view the ept.json files in Firefox. Is there a firewall setting I'm missing?

Thank you,
Brian

Brian K. Gelder, PhD
Manager Research for "Mud" (Soil and Water Research), Ag & Biosystems Engr. Dept.
Daily Erosion Project<https://www.dailyerosion.org/> & Agricultural Conservation Planning Framework<https://acpf4watersheds.org/>
Adjunct Assistant Professor, ABE, CRP & Agronomy Dept.
Instructor, CRP 454/554 and 456/556
3321 Elings Hall, Iowa State University
515-294-3144
My schedule<https://outlook.office365.com/owa/calendar/9f43d0598b5d4a798c1592542919c740 at iastate.edu/4ad84c683cf643cf9b46844d5e9bae3d7421382923026391208/calendar.html>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220815/da8a6c13/attachment.htm>

From howard at hobu.co  Mon Aug 15 12:26:22 2022
From: howard at hobu.co (Howard Butler)
Date: Mon, 15 Aug 2022 14:26:22 -0500
Subject: [pdal] Python pipeline not reading ept.json
In-Reply-To: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>
References: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>
Message-ID: <5CB00D78-07E0-4202-92C3-5F46A56413B3@hobu.co>



> On Aug 15, 2022, at 12:53 PM, Gelder, Brian K [A&BE] <bkgelder at iastate.edu> wrote:
> 
> Hello,
> I?m a pdal newbie and I?m trying to figure out how to successfully read ept.json files. I have pdal 2.4.2 installed via Conda on Python 3.9 on Win 10 and am able to use the pipeline to process local datasets like interesting.las in the tutorials. However, when I try to read EPT web resources, like in https://pdal.io/en/latest/tutorial/iowa-entwine.html, I receive the following error:
>  
> Traceback (most recent call last):
>   File "<pyshell#15>", line 1, in <module>
>     pipeline2.validate()
>   File "C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pdal-testing-env\lib\site-packages\pdal\pipeline.py", line 43, in validate
>     return self.p.validate()
>   File "libpdalpython.pyx", line 185, in pdal.libpdalpython.PyPipeline.validate
> RuntimeError: readers.ept: Could not read from s3-us-west-2.amazonaws.com/usgs-lidar-public/IA_FullState/ept.json
>  
> I get similar failure when I tried to query the smaller Hurricane Florence dataset Vishu wrote about last week. I can view the ept.json files in Firefox. Is there a firewall setting I?m missing?

Brian,

The first thing to do is to try a pipeline with 'pdal pipeline' and take Python out of it. Another thing to check is pull a new environment with PDAL 2.4.3 and see if that works. There was a big memory leak of the LAZ decompression in 2.4.0-2.4.2 that you won't want if you're doing things in Python.

Hope this helps,

Howard


From tsvibar at gmail.com  Mon Aug 15 23:44:49 2022
From: tsvibar at gmail.com (Micha Silver)
Date: Tue, 16 Aug 2022 09:44:49 +0300
Subject: [pdal] Removing dimensions
Message-ID: <22fb6c55-44e2-e96d-391f-05f9cbfd54e4@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220816/78e94f0c/attachment.htm>

From andrew.bell.ia at gmail.com  Tue Aug 16 03:47:05 2022
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 16 Aug 2022 06:47:05 -0400
Subject: [pdal] Removing dimensions
In-Reply-To: <22fb6c55-44e2-e96d-391f-05f9cbfd54e4@gmail.com>
References: <22fb6c55-44e2-e96d-391f-05f9cbfd54e4@gmail.com>
Message-ID: <CACJ51z3uHL9SFfpm1E7dXAL6hNjLx49+rqRWGkO-cB2ZnirfAQ@mail.gmail.com>

You should review the LAS specification and learn about the point formats.
The dimensions are predetermined by the point format, though you can add
extra dimensions to the base set.

On Tue, Aug 16, 2022, 2:44 AM Micha Silver <tsvibar at gmail.com> wrote:

> Is there a possibility to run a pdal pipeline to remove certain
> (unnecessary/unused) dimensions?
>
> This works fine:
>
> pdal translate -i HavatEden_2_pointcloud.las -o pointcloud.laz
>
>
> but:
>
> pdal translate -i HavatEden_2_pointcloud.las -o pointcloud.laz --dims
> intensity,return_number,number_of_returns,classification
> PDAL: kernels.translate: Unexpected argument 'dims'.
>
>
> I also tried a few options in a json pipeline file but nothing was
> recognized. Is there a filter type that recognizes the "dimensions"
> argument?
>
>
> Thanks
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220816/5928af02/attachment.htm>

From tsvibar at gmail.com  Tue Aug 16 07:45:14 2022
From: tsvibar at gmail.com (Micha Silver)
Date: Tue, 16 Aug 2022 17:45:14 +0300
Subject: [pdal] Removing dimensions
In-Reply-To: <CACJ51z3uHL9SFfpm1E7dXAL6hNjLx49+rqRWGkO-cB2ZnirfAQ@mail.gmail.com>
References: <22fb6c55-44e2-e96d-391f-05f9cbfd54e4@gmail.com>
 <CACJ51z3uHL9SFfpm1E7dXAL6hNjLx49+rqRWGkO-cB2ZnirfAQ@mail.gmail.com>
Message-ID: <CAObswFDEyo1wAP4N+_5Thgf9tpiG9c_R09Ap1T1AcE5XQ1qJxg@mail.gmail.com>

Thanks for clarifying.

On Tue, Aug 16, 2022, 13:47 Andrew Bell <andrew.bell.ia at gmail.com> wrote:

> You should review the LAS specification and learn about the point formats.
> The dimensions are predetermined by the point format, though you can add
> extra dimensions to the base set.
>
> On Tue, Aug 16, 2022, 2:44 AM Micha Silver <tsvibar at gmail.com> wrote:
>
>> Is there a possibility to run a pdal pipeline to remove certain
>> (unnecessary/unused) dimensions?
>>
>> This works fine:
>>
>> pdal translate -i HavatEden_2_pointcloud.las -o pointcloud.laz
>>
>>
>> but:
>>
>> pdal translate -i HavatEden_2_pointcloud.las -o pointcloud.laz --dims
>> intensity,return_number,number_of_returns,classification
>> PDAL: kernels.translate: Unexpected argument 'dims'.
>>
>>
>> I also tried a few options in a json pipeline file but nothing was
>> recognized. Is there a filter type that recognizes the "dimensions"
>> argument?
>>
>>
>> Thanks
>>
>> --
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220816/06fa8437/attachment.htm>

From bkgelder at iastate.edu  Fri Aug 19 04:11:56 2022
From: bkgelder at iastate.edu (Gelder, Brian K [A&BE])
Date: Fri, 19 Aug 2022 11:11:56 +0000
Subject: [pdal] Python pipeline not reading ept.json
In-Reply-To: <5CB00D78-07E0-4202-92C3-5F46A56413B3@hobu.co>
References: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>
 <5CB00D78-07E0-4202-92C3-5F46A56413B3@hobu.co>
Message-ID: <DM6PR04MB68575AC27BD5334CD2690804CB6C9@DM6PR04MB6857.namprd04.prod.outlook.com>

Howard,
Thanks for your tip; should have thought of that myself. It does appear to be an issue with Python and not pdal directly. I'm guessing it has to do with the fact that I am using ArcGIS Pro 3.0 for my Python 3.9 install. I installed Pro, cloned the default Python install, and then installed via "conda install -c conda-forge pdal" Does anyone have suggestions on how make these two play nicely together?

I can run pipelines directly from the command line but not through Python. If I run the following pdal command inside my ArcGIS Pro configured Python command prompt "pdal pipeline iowa.json --debug"

The pipeline then runs successfully. However if I try to run "pdal --drivers" at the same command line I get the following error messages. After acknowledging the errors it then proceeds to print the drivers and I can still run pipelines.

"pdal.exe - Entry Point No Found"

"The procedure entry point ?mergeMode at Filter@pdal@@EEBA?AW4WhereMergeMode at State@2 at XZ could not be located in the dynamic link library C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-env\lib\site_packages\bin\libpdal_plugin_filter_numpy.dll"

"The procedure entry point ?mergeMode at Reader@pdal@@EEBA?AW4WhereMergeMode at State@2 at XZ could not be located in the dynamic link library C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-env\lib\site_packages\bin\libpdal_plugin_reader_numpy.dll"

Additionally - if I try to import pdal within a .py script file I receive the following warning about a circular import. I do not receive this when I import pdal in the IDLE shell. 

"Traceback (most recent call last):
  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 4, in <module>
    import pdal
  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 16, in <module>
    pipeline = pdal.Pipeline(json)
AttributeError: partially initialized module 'pdal' has no attribute 'Pipeline' (most likely due to a circular import)"

I've also been trying to update pdal to 2.4.3 but not having luck due to listed conflicts. I've tried "conda update pdal" and "conda install -c conda-forge pdal=2.4.3"

Thank you,
Brian

-----Original Message-----
From: Howard Butler <howard at hobu.co> 
Sent: Monday, August 15, 2022 2:26 PM
To: Gelder, Brian K [A&BE] <bkgelder at iastate.edu>
Cc: pdal at lists.osgeo.org
Subject: Re: [pdal] Python pipeline not reading ept.json



> On Aug 15, 2022, at 12:53 PM, Gelder, Brian K [A&BE] <bkgelder at iastate.edu> wrote:
> 
> Hello,
> I?m a pdal newbie and I?m trying to figure out how to successfully read ept.json files. I have pdal 2.4.2 installed via Conda on Python 3.9 on Win 10 and am able to use the pipeline to process local datasets like interesting.las in the tutorials. However, when I try to read EPT web resources, like in https://pdal.io/en/latest/tutorial/iowa-entwine.html, I receive the following error:
>  
> Traceback (most recent call last):
>   File "<pyshell#15>", line 1, in <module>
>     pipeline2.validate()
>   File "C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pdal-testing-env\lib\site-packages\pdal\pipeline.py", line 43, in validate
>     return self.p.validate()
>   File "libpdalpython.pyx", line 185, in pdal.libpdalpython.PyPipeline.validate
> RuntimeError: readers.ept: Could not read from s3-us-west-2.amazonaws.com/usgs-lidar-public/IA_FullState/ept.json
>  
> I get similar failure when I tried to query the smaller Hurricane Florence dataset Vishu wrote about last week. I can view the ept.json files in Firefox. Is there a firewall setting I?m missing?

Brian,

The first thing to do is to try a pipeline with 'pdal pipeline' and take Python out of it. Another thing to check is pull a new environment with PDAL 2.4.3 and see if that works. There was a big memory leak of the LAZ decompression in 2.4.0-2.4.2 that you won't want if you're doing things in Python.

Hope this helps,

Howard


From howard at hobu.co  Fri Aug 19 05:46:28 2022
From: howard at hobu.co (Howard Butler)
Date: Fri, 19 Aug 2022 07:46:28 -0500
Subject: [pdal] Python pipeline not reading ept.json
In-Reply-To: <DM6PR04MB68575AC27BD5334CD2690804CB6C9@DM6PR04MB6857.namprd04.prod.outlook.com>
References: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>
 <5CB00D78-07E0-4202-92C3-5F46A56413B3@hobu.co>
 <DM6PR04MB68575AC27BD5334CD2690804CB6C9@DM6PR04MB6857.namprd04.prod.outlook.com>
Message-ID: <03F8C625-4643-4737-823B-84D265A70D02@hobu.co>

Howard

Ah, ArcGIS conda environments. That's an entirely different bucket of eels. 

I would suggest trying to operate in a clean non-ArcGIS environment that's known to work. We are available for a support contract if being inside ArcGIS is a hard requirement for you, but it's not something that's usually simple to address.

I wish ArcGIS used the principle of "small environments", but unfortunately, their default environment installs the universe and then users are stuck waiting for it to never solve or end up with linking conflicts like these. 

Howard



> On Aug 19, 2022, at 6:11 AM, Gelder, Brian K [A&BE] <bkgelder at iastate.edu> wrote:
> 
> Howard,
> Thanks for your tip; should have thought of that myself. It does appear to be an issue with Python and not pdal directly. I'm guessing it has to do with the fact that I am using ArcGIS Pro 3.0 for my Python 3.9 install. I installed Pro, cloned the default Python install, and then installed via "conda install -c conda-forge pdal" Does anyone have suggestions on how make these two play nicely together?
> 
> I can run pipelines directly from the command line but not through Python. If I run the following pdal command inside my ArcGIS Pro configured Python command prompt "pdal pipeline iowa.json --debug"
> 
> The pipeline then runs successfully. However if I try to run "pdal --drivers" at the same command line I get the following error messages. After acknowledging the errors it then proceeds to print the drivers and I can still run pipelines.
> 
> "pdal.exe - Entry Point No Found"
> 
> "The procedure entry point ?mergeMode at Filter@pdal@@EEBA?AW4WhereMergeMode at State@2 at XZ could not be located in the dynamic link library C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-env\lib\site_packages\bin\libpdal_plugin_filter_numpy.dll"
> 
> "The procedure entry point ?mergeMode at Reader@pdal@@EEBA?AW4WhereMergeMode at State@2 at XZ could not be located in the dynamic link library C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-env\lib\site_packages\bin\libpdal_plugin_reader_numpy.dll"
> 
> Additionally - if I try to import pdal within a .py script file I receive the following warning about a circular import. I do not receive this when I import pdal in the IDLE shell. 
> 
> "Traceback (most recent call last):
>  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 4, in <module>
>    import pdal
>  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 16, in <module>
>    pipeline = pdal.Pipeline(json)
> AttributeError: partially initialized module 'pdal' has no attribute 'Pipeline' (most likely due to a circular import)"
> 
> I've also been trying to update pdal to 2.4.3 but not having luck due to listed conflicts. I've tried "conda update pdal" and "conda install -c conda-forge pdal=2.4.3"
> 
> Thank you,
> Brian
> 
> -----Original Message-----
> From: Howard Butler <howard at hobu.co> 
> Sent: Monday, August 15, 2022 2:26 PM
> To: Gelder, Brian K [A&BE] <bkgelder at iastate.edu>
> Cc: pdal at lists.osgeo.org
> Subject: Re: [pdal] Python pipeline not reading ept.json
> 
> 
> 
>> On Aug 15, 2022, at 12:53 PM, Gelder, Brian K [A&BE] <bkgelder at iastate.edu> wrote:
>> 
>> Hello,
>> I?m a pdal newbie and I?m trying to figure out how to successfully read ept.json files. I have pdal 2.4.2 installed via Conda on Python 3.9 on Win 10 and am able to use the pipeline to process local datasets like interesting.las in the tutorials. However, when I try to read EPT web resources, like in https://pdal.io/en/latest/tutorial/iowa-entwine.html, I receive the following error:
>> 
>> Traceback (most recent call last):
>>  File "<pyshell#15>", line 1, in <module>
>>    pipeline2.validate()
>>  File "C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pdal-testing-env\lib\site-packages\pdal\pipeline.py", line 43, in validate
>>    return self.p.validate()
>>  File "libpdalpython.pyx", line 185, in pdal.libpdalpython.PyPipeline.validate
>> RuntimeError: readers.ept: Could not read from s3-us-west-2.amazonaws.com/usgs-lidar-public/IA_FullState/ept.json
>> 
>> I get similar failure when I tried to query the smaller Hurricane Florence dataset Vishu wrote about last week. I can view the ept.json files in Firefox. Is there a firewall setting I?m missing?
> 
> Brian,
> 
> The first thing to do is to try a pipeline with 'pdal pipeline' and take Python out of it. Another thing to check is pull a new environment with PDAL 2.4.3 and see if that works. There was a big memory leak of the LAZ decompression in 2.4.0-2.4.2 that you won't want if you're doing things in Python.
> 
> Hope this helps,
> 
> Howard
> 


From calba at lillemetropole.fr  Fri Aug 19 07:15:56 2022
From: calba at lillemetropole.fr (=?iso-8859-1?Q?ALBA_Cl=E9ment?=)
Date: Fri, 19 Aug 2022 14:15:56 +0000
Subject: [pdal] Some news about pdal-parallelizer !
Message-ID: <e99a7a0f71394342944b46b8049acd1e@lillemetropole.fr>

Hi,

New features have been added to pdal-parallelizer !

You can now :
- Use any reader format
- Process single files in any format with the parameters previously limited to copc
- Use buffers in single file processing
- Specify bounding box to limit input processing
- Do dry runs to test your parameters
- Get a memory usage graph after an execution

There is also some updates in the use of the tool. Now, there is just one function called process-pipelines with more options than before.

You can read the doc and consult the code of pdal-parallelizer at : https://github.com/meldig/pdal-parallelizer

Regards,

Cl?ment Alba
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220819/0d193f8b/attachment-0001.htm>

From bkgelder at iastate.edu  Fri Aug 19 08:43:51 2022
From: bkgelder at iastate.edu (Gelder, Brian K [A&BE])
Date: Fri, 19 Aug 2022 15:43:51 +0000
Subject: [pdal] Python pipeline not reading ept.json
In-Reply-To: <03F8C625-4643-4737-823B-84D265A70D02@hobu.co>
References: <DM6PR04MB685729EEF66BF73192C2CAF9CB689@DM6PR04MB6857.namprd04.prod.outlook.com>
 <5CB00D78-07E0-4202-92C3-5F46A56413B3@hobu.co>
 <DM6PR04MB68575AC27BD5334CD2690804CB6C9@DM6PR04MB6857.namprd04.prod.outlook.com>
 <03F8C625-4643-4737-823B-84D265A70D02@hobu.co>
Message-ID: <DM6PR04MB6857A6B19AF8388DB25ECDE4CB6C9@DM6PR04MB6857.namprd04.prod.outlook.com>

Thank you for the advice Howard. I was guessing that was the problem - I had tried pdal before and given up back when I used ArcMap 10.3 as that was even less friendly towards adding packages. I'll set up a clean non-ArcGIS Python environment for my pdal work.

I'll add a little more detail on what I'm planning in case anyone else comes across this thread (or others can give me advice on better ways to implement this). What I do is run a parent script in a recent version of Python and then use the Python subprocess module to launch child scripts from the command line where I can specify which Python interpreter/environment I want to use to launch each specific Python file. I pass general process input and output names via command line arguments and thus the next Python child program picks up where the previous Python child program ended. This does create some complications when debugging but I can manage that.

I do this currently using the Python executable from ArcMap 10.3 with Background Geoprocessing for some raster work as arcpy was still fast for raster processing since it still used ESRI GRIDs natively. Other, newer processes have been moved to Pro and use the cloned environment/interpreter executable I've set up there to do that processing. I'm just going to add another non-ArcGIS Python environment/interpreter to call so I can use pdal to process my pipeline JSON.

Thanks for supporting this great product!
Brian

Brian K. Gelder, PhD
?Mud? Research Manager (Soil and Water Research), Ag & Biosystems Engr. Dept.
Daily Erosion Project & Agricultural Conservation Planning Framework
Adjunct Assistant Professor, ABE, CRP & Agronomy Dept.
Instructor, CRP 454/554/LA 554 and CRP 456/556/ABE 556
3321 Elings Hall, Iowa State University
515-294-3144
My schedule

> -----Original Message-----
> From: Howard Butler <howard at hobu.co>
> Sent: Friday, August 19, 2022 07:46
> To: Gelder, Brian K [A&BE] <bkgelder at iastate.edu>
> Cc: pdal at lists.osgeo.org
> Subject: Re: [pdal] Python pipeline not reading ept.json
> 
> Howard
> 
> Ah, ArcGIS conda environments. That's an entirely different bucket of eels.
> 
> I would suggest trying to operate in a clean non-ArcGIS environment that's
> known to work. We are available for a support contract if being inside ArcGIS
> is a hard requirement for you, but it's not something that's usually simple to
> address.
> 
> I wish ArcGIS used the principle of "small environments", but unfortunately,
> their default environment installs the universe and then users are stuck
> waiting for it to never solve or end up with linking conflicts like these.
> 
> Howard
> 
> 
> 
> > On Aug 19, 2022, at 6:11 AM, Gelder, Brian K [A&BE]
> <bkgelder at iastate.edu> wrote:
> >
> > Howard,
> > Thanks for your tip; should have thought of that myself. It does appear to
> be an issue with Python and not pdal directly. I'm guessing it has to do with
> the fact that I am using ArcGIS Pro 3.0 for my Python 3.9 install. I installed
> Pro, cloned the default Python install, and then installed via "conda install -c
> conda-forge pdal" Does anyone have suggestions on how make these two
> play nicely together?
> >
> > I can run pipelines directly from the command line but not through
> Python. If I run the following pdal command inside my ArcGIS Pro configured
> Python command prompt "pdal pipeline iowa.json --debug"
> >
> > The pipeline then runs successfully. However if I try to run "pdal --drivers"
> at the same command line I get the following error messages. After
> acknowledging the errors it then proceeds to print the drivers and I can still
> run pipelines.
> >
> > "pdal.exe - Entry Point No Found"
> >
> > "The procedure entry point
> ?mergeMode at Filter@pdal@@EEBA?AW4WhereMergeMode at State@2 at XZ
> could not be located in the dynamic link library
> C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-
> env\lib\site_packages\bin\libpdal_plugin_filter_numpy.dll"
> >
> > "The procedure entry point
> ?mergeMode at Reader@pdal@@EEBA?AW4WhereMergeMode at State@2@
> XZ could not be located in the dynamic link library
> C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pda-testing-
> env\lib\site_packages\bin\libpdal_plugin_reader_numpy.dll"
> >
> > Additionally - if I try to import pdal within a .py script file I receive the
> following warning about a circular import. I do not receive this when I
> import pdal in the IDLE shell.
> >
> > "Traceback (most recent call last):
> >  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 4, in <module>
> >    import pdal
> >  File "C:\Users\bkgelder\Box\Scripts\pdal.py", line 16, in <module>
> >    pipeline = pdal.Pipeline(json)
> > AttributeError: partially initialized module 'pdal' has no attribute 'Pipeline'
> (most likely due to a circular import)"
> >
> > I've also been trying to update pdal to 2.4.3 but not having luck due to
> listed conflicts. I've tried "conda update pdal" and "conda install -c conda-
> forge pdal=2.4.3"
> >
> > Thank you,
> > Brian
> >
> > -----Original Message-----
> > From: Howard Butler <howard at hobu.co>
> > Sent: Monday, August 15, 2022 2:26 PM
> > To: Gelder, Brian K [A&BE] <bkgelder at iastate.edu>
> > Cc: pdal at lists.osgeo.org
> > Subject: Re: [pdal] Python pipeline not reading ept.json
> >
> >
> >
> >> On Aug 15, 2022, at 12:53 PM, Gelder, Brian K [A&BE]
> <bkgelder at iastate.edu> wrote:
> >>
> >> Hello,
> >> I?m a pdal newbie and I?m trying to figure out how to successfully read
> ept.json files. I have pdal 2.4.2 installed via Conda on Python 3.9 on Win 10
> and am able to use the pipeline to process local datasets like interesting.las
> in the tutorials. However, when I try to read EPT web resources, like in
> https://pdal.io/en/latest/tutorial/iowa-entwine.html, I receive the following
> error:
> >>
> >> Traceback (most recent call last):
> >>  File "<pyshell#15>", line 1, in <module>
> >>    pipeline2.validate()
> >>  File "C:\Users\bkgelder\AppData\Local\ESRI\conda\envs\pdal-testing-
> env\lib\site-packages\pdal\pipeline.py", line 43, in validate
> >>    return self.p.validate()
> >>  File "libpdalpython.pyx", line 185, in
> pdal.libpdalpython.PyPipeline.validate
> >> RuntimeError: readers.ept: Could not read from s3-us-west-
> 2.amazonaws.com/usgs-lidar-public/IA_FullState/ept.json
> >>
> >> I get similar failure when I tried to query the smaller Hurricane Florence
> dataset Vishu wrote about last week. I can view the ept.json files in Firefox.
> Is there a firewall setting I?m missing?
> >
> > Brian,
> >
> > The first thing to do is to try a pipeline with 'pdal pipeline' and take Python
> out of it. Another thing to check is pull a new environment with PDAL 2.4.3
> and see if that works. There was a big memory leak of the LAZ
> decompression in 2.4.0-2.4.2 that you won't want if you're doing things in
> Python.
> >
> > Hope this helps,
> >
> > Howard
> >


From Karl.Keller at kci.com  Sat Aug 20 08:19:52 2022
From: Karl.Keller at kci.com (Karl Keller)
Date: Sat, 20 Aug 2022 15:19:52 +0000
Subject: [pdal] filters.python failure
Message-ID: <SJ1PR12MB602647C90EA14D4374BF7839F76F9@SJ1PR12MB6026.namprd12.prod.outlook.com>

Hello,

A previously working filters.python pipeline running in Windows suddenly failing on a different Windows machine.  Running a lot of other filters in this pipeline successfully.  Unfortunately, this is my next to last filter.

I ran into what looks like a fault (python just drops to the command line) while running a pdal pipeline with filters.python.  It neither validates nor executes the pipeline.  All other pipelines are validating and executing.

Details:
Running python 3.8.13 (on previous machine I was on 3.8.8)
Using conda 4.12.0 for environment mgmt and installs
Installed python-pdal == 2.3.7 which installed pdal 2.4.0 (previous machine shows pdal 2.2.0)
pdal -drivers shows filters.python
[cid:image003.png at 01D8B486.61602D60]

All I can assume is that a path, somewhere, isn't establishing the location of that plugin.

Any help much appreciated.

Karl S Keller
Senior Systems Engineer

[cid:image001.png at 01D8B485.409E35F0]

KCI TECHNOLOGIES INC.
936 Ridgebrook Road | Sparks, MD | 21152
Karl.Keller at kci.com<mailto:Karl.Keller at kci.com>
m: 540-827-7786
www.kci.com<http://www.kci.com/>

[cid:image002.jpg at 01D8B485.409E35F0]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220820/f27a86fe/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 2100 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220820/f27a86fe/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 2025 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220820/f27a86fe/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 17700 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220820/f27a86fe/attachment-0003.png>

From Karl.Keller at kci.com  Tue Aug 23 04:43:52 2022
From: Karl.Keller at kci.com (Karl Keller)
Date: Tue, 23 Aug 2022 11:43:52 +0000
Subject: [pdal] filters.python failure
In-Reply-To: <SJ1PR12MB602647C90EA14D4374BF7839F76F9@SJ1PR12MB6026.namprd12.prod.outlook.com>
References: <SJ1PR12MB602647C90EA14D4374BF7839F76F9@SJ1PR12MB6026.namprd12.prod.outlook.com>
Message-ID: <SJ1PR12MB6026949236C5188A87CD397BF7709@SJ1PR12MB6026.namprd12.prod.outlook.com>

Update on the non-running validation steps.  After researching various paths, like PDAL_DRIVER_PATH and _CONDA_SET_PDAL_PYTHON_DRIVER.  Paths appeared to be pointing to the filters.python executable.  Since that appeared to be correct, I just installed PDAL 2.2.0 over the python-pdal installation of PDAL already existing.  Processing proceeded as normal afterwards, so it's just part of my build process now.

On a different note, I'm noticing a rather lengthy step in transformation application to clouds of approximately 20M points.  Upwards of 5 minutes per file on a large box (128 GB ram, 1 GPU/1GB, fast drive).  Just curious if this is normal or suggestive of a problem.  Others have the same experience?

Thanks!

From: Karl Keller
Sent: Saturday, August 20, 2022 11:20 AM
To: pdal at lists.osgeo.org
Subject: filters.python failure

Hello,

A previously working filters.python pipeline running in Windows suddenly failing on a different Windows machine.  Running a lot of other filters in this pipeline successfully.  Unfortunately, this is my next to last filter.

I ran into what looks like a fault (python just drops to the command line) while running a pdal pipeline with filters.python.  It neither validates nor executes the pipeline.  All other pipelines are validating and executing.

Details:
Running python 3.8.13 (on previous machine I was on 3.8.8)
Using conda 4.12.0 for environment mgmt and installs
Installed python-pdal == 2.3.7 which installed pdal 2.4.0 (previous machine shows pdal 2.2.0)
pdal -drivers shows filters.python
[cid:image003.png at 01D8B6C3.A318F770]

All I can assume is that a path, somewhere, isn't establishing the location of that plugin.

Any help much appreciated.

Karl S Keller
Senior Systems Engineer

[cid:image004.png at 01D8B6C3.A318F770]

KCI TECHNOLOGIES INC.
936 Ridgebrook Road | Sparks, MD | 21152
Karl.Keller at kci.com<mailto:Karl.Keller at kci.com>
m: 540-827-7786
www.kci.com<http://www.kci.com/>

[cid:image005.jpg at 01D8B6C3.A318F770]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220823/7dbb9ae6/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 17700 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220823/7dbb9ae6/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 2100 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220823/7dbb9ae6/attachment-0003.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.jpg
Type: image/jpeg
Size: 2025 bytes
Desc: image005.jpg
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20220823/7dbb9ae6/attachment-0001.jpg>

