From tom.van.tilburg at gmail.com  Thu Aug  3 00:38:59 2017
From: tom.van.tilburg at gmail.com (Tom van Tilburg)
Date: Thu, 3 Aug 2017 09:38:59 +0200
Subject: [pdal] filters.normal giving odd results
Message-ID: <CAP3PPDhbiPRsEVT_jLz12=-HU+5pXoH7=E9nWq=6iixK5=kqgQ@mail.gmail.com>

Hi,

This question is also on stackexchange:
https://gis.stackexchange.com/questions/250810/erratic-results-from-filters-normal-in-pdal
---

Given this roof structure:

[image: roofpointcloud]

I get the following output for the normalx, after using

    {
      "type":"filters.range",
      "limits":"Classification[6:6],ReturnNumber[1:1]"
    },
    {
        "type":"filters.eigenvalues",
        "knn":8
    },
     {
         "type":"filters.normal",
         "knn":8
     },

[image: point normalx]
(orange to purple : -1 to 1)

Comparable situation for normaly and normalz

Where I was expecting homogeneous colored roofplanes, I get a mixed-up
situation, where the values appear to be sometimes flipped to the negative.

It seems to me there are some artifacts here based on the laser scan-line,
considering the flipping of the normal on the same roof plane.

I cannot wrap my head around what happens here. Anybody ideas? The purpose
of this work is to get the slope and aspect from the roofplanes. I can get
the slope correct by taking the absolute values of normalz (slope will
never pass the 90 degrees) but this is not an option for calculating the
aspect it seems. The resulting pointset can be downloaded here
<http://research.geodan.nl/sites/tomt/output.las>

Best,

 Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/a338c01f/attachment.html>

From brad.chambers at gmail.com  Thu Aug  3 07:31:27 2017
From: brad.chambers at gmail.com (Bradley Chambers)
Date: Thu, 03 Aug 2017 14:31:27 +0000
Subject: [pdal] filters.normal giving odd results
In-Reply-To: <CAP3PPDhbiPRsEVT_jLz12=-HU+5pXoH7=E9nWq=6iixK5=kqgQ@mail.gmail.com>
References: <CAP3PPDhbiPRsEVT_jLz12=-HU+5pXoH7=E9nWq=6iixK5=kqgQ@mail.gmail.com>
Message-ID: <CAJyqqPwHUax1DS2p19PfrTNbGaLBGVod1brVf_4bqjZMyep2WA@mail.gmail.com>

Tom,

Glad to see that you found a solution/workaround as posted to SO.

I do believe that we need to add some functionality to the filter to do the
flipping. It's easy math, just need to work out the details of how to
expose this to users. I'll create a ticket for this on GitHub.

Brad

On Thu, Aug 3, 2017 at 3:39 AM Tom van Tilburg <tom.van.tilburg at gmail.com>
wrote:

> Hi,
>
> This question is also on stackexchange:
> https://gis.stackexchange.com/questions/250810/erratic-results-from-filters-normal-in-pdal
> ---
>
> Given this roof structure:
>
> [image: roofpointcloud]
>
> I get the following output for the normalx, after using
>
>     {
>       "type":"filters.range",
>       "limits":"Classification[6:6],ReturnNumber[1:1]"
>     },
>     {
>         "type":"filters.eigenvalues",
>         "knn":8
>     },
>      {
>          "type":"filters.normal",
>          "knn":8
>      },
>
> [image: point normalx]
> (orange to purple : -1 to 1)
>
> Comparable situation for normaly and normalz
>
> Where I was expecting homogeneous colored roofplanes, I get a mixed-up
> situation, where the values appear to be sometimes flipped to the negative.
>
> It seems to me there are some artifacts here based on the laser scan-line,
> considering the flipping of the normal on the same roof plane.
>
> I cannot wrap my head around what happens here. Anybody ideas? The purpose
> of this work is to get the slope and aspect from the roofplanes. I can get
> the slope correct by taking the absolute values of normalz (slope will
> never pass the 90 degrees) but this is not an option for calculating the
> aspect it seems. The resulting pointset can be downloaded here
> <http://research.geodan.nl/sites/tomt/output.las>
>
> Best,
>
>  Tom
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/5587c4a3/attachment.html>

From lluna.nova at gmail.com  Thu Aug  3 07:45:49 2017
From: lluna.nova at gmail.com (=?UTF-8?B?UG9sIE1vbnPDsyBQdXJ0w60=?=)
Date: Thu, 3 Aug 2017 16:45:49 +0200
Subject: [pdal] Unexpected argument out_srs
Message-ID: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>

Hello everyone,

I'm just gettings started with PDAL and I wanted to try setting the SRS of
a las following the example [here](https://www.pdal.io/tutorial/las.html)

I'm on Ubuntu 14.04, using pdal 1.5 installed with docker.

pdal info does work, but when I run the example pipeline, I get the
following error:

```
$ docker run -v /home/user/data:/data pdal/pdal:1.5 pdal pipeline
/data/setproj.json
PDAL: writers.las: Unexpected argument 'out_srs'.
```

Is there something additional I have to install so that `writers.las`
understand the `out_srs` tag?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/ec482cdd/attachment.html>

From lluna.nova at gmail.com  Thu Aug  3 07:45:49 2017
From: lluna.nova at gmail.com (=?UTF-8?B?UG9sIE1vbnPDsyBQdXJ0w60=?=)
Date: Thu, 3 Aug 2017 16:45:49 +0200
Subject: [pdal] Unexpected argument out_srs
Message-ID: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>

Hello everyone,

I'm just gettings started with PDAL and I wanted to try setting the SRS of
a las following the example [here](https://www.pdal.io/tutorial/las.html)

I'm on Ubuntu 14.04, using pdal 1.5 installed with docker.

pdal info does work, but when I run the example pipeline, I get the
following error:

```
$ docker run -v /home/user/data:/data pdal/pdal:1.5 pdal pipeline
/data/setproj.json
PDAL: writers.las: Unexpected argument 'out_srs'.
```

Is there something additional I have to install so that `writers.las`
understand the `out_srs` tag?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/ec482cdd/attachment-0001.html>

From andrew.bell.ia at gmail.com  Thu Aug  3 07:48:38 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 3 Aug 2017 10:48:38 -0400
Subject: [pdal] Unexpected argument out_srs
In-Reply-To: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>
References: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>
Message-ID: <CACJ51z1+Vr7NWScPnBu14sdjPr7_vrrfSisROmc-1gbPMEeQ8w@mail.gmail.com>

The option is called "a_srs".  I'll fix the documentation.  Sorry for the
confusion.

On Thu, Aug 3, 2017 at 10:45 AM, Pol Monsó Purtí <lluna.nova at gmail.com>
wrote:

> Hello everyone,
>
> I'm just gettings started with PDAL and I wanted to try setting the SRS of
> a las following the example [here](https://www.pdal.io/tutorial/las.html)
>
> I'm on Ubuntu 14.04, using pdal 1.5 installed with docker.
>
> pdal info does work, but when I run the example pipeline, I get the
> following error:
>
> ```
> $ docker run -v /home/user/data:/data pdal/pdal:1.5 pdal pipeline
> /data/setproj.json
> PDAL: writers.las: Unexpected argument 'out_srs'.
> ```
>
> Is there something additional I have to install so that `writers.las`
> understand the `out_srs` tag?
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/77f3341c/attachment-0001.html>

From lluna.nova at gmail.com  Thu Aug  3 08:01:35 2017
From: lluna.nova at gmail.com (=?UTF-8?B?UG9sIE1vbnPDsyBQdXJ0w60=?=)
Date: Thu, 3 Aug 2017 17:01:35 +0200
Subject: [pdal] Unexpected argument out_srs
In-Reply-To: <CACJ51z1+Vr7NWScPnBu14sdjPr7_vrrfSisROmc-1gbPMEeQ8w@mail.gmail.com>
References: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>
 <CACJ51z1+Vr7NWScPnBu14sdjPr7_vrrfSisROmc-1gbPMEeQ8w@mail.gmail.com>
Message-ID: <CALAZn4g6A6-AYp5cxssEOO5uV8NkAMp=4J7YccJsCnET+1H=cg@mail.gmail.com>

That works, thanks!

The `filters.reprojection`, thought, understands `out_srs`

On Thu, Aug 3, 2017 at 4:48 PM, Andrew Bell <andrew.bell.ia at gmail.com>
wrote:

> The option is called "a_srs".  I'll fix the documentation.  Sorry for the
> confusion.
>
> On Thu, Aug 3, 2017 at 10:45 AM, Pol Monsó Purtí <lluna.nova at gmail.com>
> wrote:
>
>> Hello everyone,
>>
>> I'm just gettings started with PDAL and I wanted to try setting the SRS
>> of a las following the example [here](https://www.pdal.io/tut
>> orial/las.html)
>>
>> I'm on Ubuntu 14.04, using pdal 1.5 installed with docker.
>>
>> pdal info does work, but when I run the example pipeline, I get the
>> following error:
>>
>> ```
>> $ docker run -v /home/user/data:/data pdal/pdal:1.5 pdal pipeline
>> /data/setproj.json
>> PDAL: writers.las: Unexpected argument 'out_srs'.
>> ```
>>
>> Is there something additional I have to install so that `writers.las`
>> understand the `out_srs` tag?
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/3124e556/attachment.html>

From andrew.bell.ia at gmail.com  Thu Aug  3 08:35:24 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 3 Aug 2017 11:35:24 -0400
Subject: [pdal] Unexpected argument out_srs
In-Reply-To: <CALAZn4g6A6-AYp5cxssEOO5uV8NkAMp=4J7YccJsCnET+1H=cg@mail.gmail.com>
References: <CALAZn4hvTbDj5krQEfjzgATyFgb4-n8hmvMvwdq+xWAsWa+e+w@mail.gmail.com>
 <CACJ51z1+Vr7NWScPnBu14sdjPr7_vrrfSisROmc-1gbPMEeQ8w@mail.gmail.com>
 <CALAZn4g6A6-AYp5cxssEOO5uV8NkAMp=4J7YccJsCnET+1H=cg@mail.gmail.com>
Message-ID: <CACJ51z1q1yTCTzArcZDFbz9A5+QTdDL20LXUzdMz8HUX8ESgpg@mail.gmail.com>

On Thu, Aug 3, 2017 at 11:01 AM, Pol Monsó Purtí <lluna.nova at gmail.com>
wrote:

> That works, thanks!
>
> The `filters.reprojection`, thought, understands `out_srs`
>
> On Thu, Aug 3, 2017 at 4:48 PM, Andrew Bell <andrew.bell.ia at gmail.com>
> wrote:
>
>> The option is called "a_srs".  I'll fix the documentation.  Sorry for the
>> confusion.
>>
>
Yes.  I noticed this.  I'm not sure of the history.  Perhaps we can make
things consistent going forward.

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170803/0ace6dc8/attachment.html>

From andrew.bell.ia at gmail.com  Fri Aug  4 14:13:27 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 4 Aug 2017 17:13:27 -0400
Subject: [pdal] Threading and PDAL
In-Reply-To: <CAMcxSMvu-=HRTa5dv=1Ot2mki_7+yu+DKmp5uvp1OU_xktSFVw@mail.gmail.com>
References: <CAMcxSMu3FdeWAgrkzeryWDH=trwzfrrns1QF+RNGBmacpDHtsw@mail.gmail.com>
 <CACJ51z30nJk6OCB8pewkocVjbP1bkmg1FOhwDTO26j-sMe_QVQ@mail.gmail.com>
 <CAMcxSMujXEunzsrCXZN9ahvfNbOWmS7i5=u+XyKVbeuHpq5TWw@mail.gmail.com>
 <CAO=FyjL5Cm2OZhjjmGP_xTUz1aJL9y1_R-zK1UEisC5O-B3X+Q@mail.gmail.com>
 <CAMcxSMuEr7CnQ9WyGOhivoifrSQ+78TOoHzsRu6Evzd-VQFdRg@mail.gmail.com>
 <CAO=Fyj+yDNcZ7wEWPcNvBSOBABrmaPv_LanENr0e-PDFGgyzog@mail.gmail.com>
 <CAMcxSMvu-=HRTa5dv=1Ot2mki_7+yu+DKmp5uvp1OU_xktSFVw@mail.gmail.com>
Message-ID: <CACJ51z2b5wGxyvxVQ+9RSj9HPdTYLaZ2UPV6WBkhv4xF-wWb-w@mail.gmail.com>

Hi Jason,

I pushed a change today that should eliminate the corruption that you were
seeing when using preview/prepare with stages in multiple threads.  You
should be able to remove the locks that you added in your application.
That said, we've never advertised PDAL as being threadsafe.  But the
problem exhibited by your test program (thank you) has been addressed.

On Thu, Jul 20, 2017 at 4:03 PM, Jason Beverage <jasonbeverage at gmail.com>
wrote:

> You're awesome!  Locking around prepare and preview appear to work.  I'm
> going to see if I can take some of the other locks out as well.
>
> I'm assuming that the SpatialReference locks are due to GDAL's lack of
> thread safety.  Would it be possible to just have an internal lock in PDAL
> around the SpatialReference class?
>
> We have to do the same thing in our osgEarth project with respect to GDAL.
>
> Jason
>
>
>
> On Thu, Jul 20, 2017 at 3:36 PM Connor Manning <connor at hobu.co> wrote:
>
>> You'll need a lock around anywhere a `pdal::SpatialReference` is
>> created.  For Entwine, prepare and preview are the main places that
>> happens, but you'll also need to lock if you're explicitly going to create
>> one.
>>
>> On Thu, Jul 20, 2017 at 2:21 PM, Jason Beverage <jasonbeverage at gmail.com>
>> wrote:
>>
>>> Thanks Connor, I just took a look at the executor.cpp.
>>>
>>> I see locking around stage creation which I already have.  I also see
>>> explicit locking around the prepare call and the preview, which I'm not
>>> doing so I will try adding that.
>>>
>>> Is there anything else that you can think of I might be missing?
>>>
>>> Jason
>>>
>>> On Thu, Jul 20, 2017 at 3:08 PM Connor Manning <connor at hobu.co> wrote:
>>>
>>>> Entwine is multi-threaded.  Most of the PDAL-locking in Entwine happens
>>>> in `entwine/util/executor.cpp` and `hpp`.
>>>>
>>>> On Thu, Jul 20, 2017 at 2:02 PM, Jason Beverage <
>>>> jasonbeverage at gmail.com> wrote:
>>>>
>>>>> Hi Andrew,
>>>>>
>>>>> Basically I have a bunch of jobs that read from input files using
>>>>> PDAL, do something on them, and then write some resulting points out to an
>>>>> LAZ file.  I've got all Stage creation wrapped in a mutex and I was hoping
>>>>> that the stage pipelines for each job could run independently without a
>>>>> lock.  I'm getting random access violations in PDAL.  I'm going to try to
>>>>> build pdal in debug and see if I can figure out what is going on.  If I
>>>>> globally mutex any access at all to PDAL things run just fine (although not
>>>>> in parallel :) ).
>>>>>
>>>>> Does Entwine use threading or is it a strictly multiprocess setup?
>>>>>
>>>>> Jason
>>>>>
>>>>>
>>>>> On Thu, Jul 20, 2017 at 10:17 AM Andrew Bell <andrew.bell.ia at gmail.com>
>>>>> wrote:
>>>>>
>>>>>> The stage creation code through the PluginManager and StageManager is
>>>>>> believed to be threadsafe.  Nothing else is guaranteed.  We rely on many
>>>>>> libraries which may or may not be threadsafe.  If you need thread safety,
>>>>>> you need to implement your own locking.
>>>>>>
>>>>>> If you're getting thread-related crashes in PluginManager or
>>>>>> StageManager, please open a ticket.
>>>>>>
>>>>>> That said, there is probably a lot you can get away with -- we don't
>>>>>> rely much on constructs that are inherently non-threadsafe.  I'm willing to
>>>>>> look at issues up to a point, but we're not going to work hard to make
>>>>>> things threadsafe.  I'd need to know more about specific problems to be
>>>>>> helpful.
>>>>>>
>>>>>>
>>>>>> On Thu, Jul 20, 2017 at 10:06 AM, Jason Beverage <
>>>>>> jasonbeverage at gmail.com> wrote:
>>>>>>
>>>>>>> I'm running into some threading issues with PDAL that I could use
>>>>>>> some help with.  I'm running into some random crashing using PDAL in a
>>>>>>> multithreaded manner.  I understand that PDAL isn't entirely threadsafe,
>>>>>>> but do you have some info on what is and isn't threadsafe?
>>>>>>>
>>>>>>> Basically what I'm trying to do is multiple threads are creating
>>>>>>> Stages using a shared StageFactory and each thread is running it's own
>>>>>>> independent pipeline.  The only thing that is shared is the StageFactory
>>>>>>> which is static for the application.  I've got access to the StageFactory
>>>>>>> protected by my own mutex since I was getting crashes accessing it from
>>>>>>> multiple threads.  I tried creating a StageFactory per thread but that
>>>>>>> caused other issues like stages randomly not being able to be able to be
>>>>>>> created and it not loading my plugins all the time.
>>>>>>>
>>>>>>> Right now I'm using the OSGEO4W 64 bit package to get PDAL and all
>>>>>>> of it's dependencies and building my application against that.  It looks
>>>>>>> like the pdal version is 1.5.0 which is the latest release.
>>>>>>>
>>>>>>> Thanks!
>>>>>>>
>>>>>>> Jason
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> pdal mailing list
>>>>>>> pdal at lists.osgeo.org
>>>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> --
>>>>>> Andrew Bell
>>>>>> andrew.bell.ia at gmail.com
>>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> pdal mailing list
>>>>> pdal at lists.osgeo.org
>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>>>>
>>>>
>>>>
>>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170804/76904019/attachment.html>

From jasonbeverage at gmail.com  Fri Aug  4 14:27:40 2017
From: jasonbeverage at gmail.com (Jason Beverage)
Date: Fri, 04 Aug 2017 21:27:40 +0000
Subject: [pdal] Threading and PDAL
In-Reply-To: <CACJ51z2b5wGxyvxVQ+9RSj9HPdTYLaZ2UPV6WBkhv4xF-wWb-w@mail.gmail.com>
References: <CAMcxSMu3FdeWAgrkzeryWDH=trwzfrrns1QF+RNGBmacpDHtsw@mail.gmail.com>
 <CACJ51z30nJk6OCB8pewkocVjbP1bkmg1FOhwDTO26j-sMe_QVQ@mail.gmail.com>
 <CAMcxSMujXEunzsrCXZN9ahvfNbOWmS7i5=u+XyKVbeuHpq5TWw@mail.gmail.com>
 <CAO=FyjL5Cm2OZhjjmGP_xTUz1aJL9y1_R-zK1UEisC5O-B3X+Q@mail.gmail.com>
 <CAMcxSMuEr7CnQ9WyGOhivoifrSQ+78TOoHzsRu6Evzd-VQFdRg@mail.gmail.com>
 <CAO=Fyj+yDNcZ7wEWPcNvBSOBABrmaPv_LanENr0e-PDFGgyzog@mail.gmail.com>
 <CAMcxSMvu-=HRTa5dv=1Ot2mki_7+yu+DKmp5uvp1OU_xktSFVw@mail.gmail.com>
 <CACJ51z2b5wGxyvxVQ+9RSj9HPdTYLaZ2UPV6WBkhv4xF-wWb-w@mail.gmail.com>
Message-ID: <CAMcxSMteY-q0qzQYaPyU5SEO5cOUuOdGVzLKndtDVM6=zi6f4g@mail.gmail.com>

Thanks Andrew!   I'll check it out next week and let you know how it goes.

On Fri, Aug 4, 2017, 5:13 PM Andrew Bell <andrew.bell.ia at gmail.com> wrote:

> Hi Jason,
>
> I pushed a change today that should eliminate the corruption that you were
> seeing when using preview/prepare with stages in multiple threads.  You
> should be able to remove the locks that you added in your application.
> That said, we've never advertised PDAL as being threadsafe.  But the
> problem exhibited by your test program (thank you) has been addressed.
>
> On Thu, Jul 20, 2017 at 4:03 PM, Jason Beverage <jasonbeverage at gmail.com>
> wrote:
>
>> You're awesome!  Locking around prepare and preview appear to work.  I'm
>> going to see if I can take some of the other locks out as well.
>>
>> I'm assuming that the SpatialReference locks are due to GDAL's lack of
>> thread safety.  Would it be possible to just have an internal lock in PDAL
>> around the SpatialReference class?
>>
>> We have to do the same thing in our osgEarth project with respect to GDAL.
>>
>> Jason
>>
>>
>>
>> On Thu, Jul 20, 2017 at 3:36 PM Connor Manning <connor at hobu.co> wrote:
>>
>>> You'll need a lock around anywhere a `pdal::SpatialReference` is
>>> created.  For Entwine, prepare and preview are the main places that
>>> happens, but you'll also need to lock if you're explicitly going to create
>>> one.
>>>
>>> On Thu, Jul 20, 2017 at 2:21 PM, Jason Beverage <jasonbeverage at gmail.com
>>> > wrote:
>>>
>>>> Thanks Connor, I just took a look at the executor.cpp.
>>>>
>>>> I see locking around stage creation which I already have.  I also see
>>>> explicit locking around the prepare call and the preview, which I'm not
>>>> doing so I will try adding that.
>>>>
>>>> Is there anything else that you can think of I might be missing?
>>>>
>>>> Jason
>>>>
>>>> On Thu, Jul 20, 2017 at 3:08 PM Connor Manning <connor at hobu.co> wrote:
>>>>
>>>>> Entwine is multi-threaded.  Most of the PDAL-locking in Entwine
>>>>> happens in `entwine/util/executor.cpp` and `hpp`.
>>>>>
>>>>> On Thu, Jul 20, 2017 at 2:02 PM, Jason Beverage <
>>>>> jasonbeverage at gmail.com> wrote:
>>>>>
>>>>>> Hi Andrew,
>>>>>>
>>>>>> Basically I have a bunch of jobs that read from input files using
>>>>>> PDAL, do something on them, and then write some resulting points out to an
>>>>>> LAZ file.  I've got all Stage creation wrapped in a mutex and I was hoping
>>>>>> that the stage pipelines for each job could run independently without a
>>>>>> lock.  I'm getting random access violations in PDAL.  I'm going to try to
>>>>>> build pdal in debug and see if I can figure out what is going on.  If I
>>>>>> globally mutex any access at all to PDAL things run just fine (although not
>>>>>> in parallel :) ).
>>>>>>
>>>>>> Does Entwine use threading or is it a strictly multiprocess setup?
>>>>>>
>>>>>> Jason
>>>>>>
>>>>>>
>>>>>> On Thu, Jul 20, 2017 at 10:17 AM Andrew Bell <
>>>>>> andrew.bell.ia at gmail.com> wrote:
>>>>>>
>>>>>>> The stage creation code through the PluginManager and StageManager
>>>>>>> is believed to be threadsafe.  Nothing else is guaranteed.  We rely on many
>>>>>>> libraries which may or may not be threadsafe.  If you need thread safety,
>>>>>>> you need to implement your own locking.
>>>>>>>
>>>>>>> If you're getting thread-related crashes in PluginManager or
>>>>>>> StageManager, please open a ticket.
>>>>>>>
>>>>>>> That said, there is probably a lot you can get away with -- we don't
>>>>>>> rely much on constructs that are inherently non-threadsafe.  I'm willing to
>>>>>>> look at issues up to a point, but we're not going to work hard to make
>>>>>>> things threadsafe.  I'd need to know more about specific problems to be
>>>>>>> helpful.
>>>>>>>
>>>>>>>
>>>>>>> On Thu, Jul 20, 2017 at 10:06 AM, Jason Beverage <
>>>>>>> jasonbeverage at gmail.com> wrote:
>>>>>>>
>>>>>>>> I'm running into some threading issues with PDAL that I could use
>>>>>>>> some help with.  I'm running into some random crashing using PDAL in a
>>>>>>>> multithreaded manner.  I understand that PDAL isn't entirely threadsafe,
>>>>>>>> but do you have some info on what is and isn't threadsafe?
>>>>>>>>
>>>>>>>> Basically what I'm trying to do is multiple threads are creating
>>>>>>>> Stages using a shared StageFactory and each thread is running it's own
>>>>>>>> independent pipeline.  The only thing that is shared is the StageFactory
>>>>>>>> which is static for the application.  I've got access to the StageFactory
>>>>>>>> protected by my own mutex since I was getting crashes accessing it from
>>>>>>>> multiple threads.  I tried creating a StageFactory per thread but that
>>>>>>>> caused other issues like stages randomly not being able to be able to be
>>>>>>>> created and it not loading my plugins all the time.
>>>>>>>>
>>>>>>>> Right now I'm using the OSGEO4W 64 bit package to get PDAL and all
>>>>>>>> of it's dependencies and building my application against that.  It looks
>>>>>>>> like the pdal version is 1.5.0 which is the latest release.
>>>>>>>>
>>>>>>>> Thanks!
>>>>>>>>
>>>>>>>> Jason
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> pdal mailing list
>>>>>>>> pdal at lists.osgeo.org
>>>>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Andrew Bell
>>>>>>> andrew.bell.ia at gmail.com
>>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> pdal mailing list
>>>>>> pdal at lists.osgeo.org
>>>>>> https://lists.osgeo.org/mailman/listinfo/pdal
>>>>>>
>>>>>
>>>>>
>>>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170804/5c7fa226/attachment-0001.html>

From fransinn at msn.com  Mon Aug  7 08:37:40 2017
From: fransinn at msn.com (Es Kay)
Date: Mon, 7 Aug 2017 15:37:40 +0000
Subject: [pdal] PDAL and PCL
Message-ID: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>

Hi guys,


I'm relatively new to PDAL and PCL. What I want to do:

- read arbitrary point clouds e.g. LAS-files

- process them in PCL.


I used the "Writing with PDAL" tutorial (https://www.pdal.io/tutorial/writing.html) to create*.txt, *.ply files from las-files, which works fine. However, when write


Stage *writer = factory.createStage("writers.pcd");


I get a bad alloc when setting the input (writer->setInput(reader);)
std::_Vector_alloc<std::_Vec_base_types<pdal::Stage * __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat 0x78 zurückgegeben


When I type in pdal --drivers, the pcd writers and readers do not appear, although dll-files exist in the bin-folder (the drivers appear when navigated to bin folder in powershell). (I compiled PDAL with PCL support following the official documentation). The approriate lib-files (e.g. libpdal_plugin_writer_pcd.lib) exist as well, which I include in the VS2015 solution.

Any hints would be appreciated.

Thanks!

My Configuration:
Windows 10, 64 BIt
PDAL 1.5.0, PCL 1.8.0 compiled with MSVC 14.0


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170807/1699165e/attachment.html>

From andrew.bell.ia at gmail.com  Tue Aug  8 05:47:05 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 8 Aug 2017 08:47:05 -0400
Subject: [pdal] PDAL and PCL
In-Reply-To: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>
References: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>
Message-ID: <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>

On Mon, Aug 7, 2017 at 11:37 AM, Es Kay <fransinn at msn.com> wrote:

> Hi guys,
>
> Stage *writer = factory.createStage("writers.pcd");
>
>
> I get a bad alloc when setting the input (writer->setInput(reader);)
> std::_Vector_alloc<std::_Vec_base_types<pdal::Stage *
> __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat 0x78
> zurückgegeben
>
>
> When I type in pdal --drivers, the pcd writers and readers do not appear,
> although dll-files exist in the bin-folder (the drivers appear when
> navigated to bin folder in powershell).
>

If the drivers aren't shown with pdal --drivers, they can't be found by the
plugin manager.  My assumption is that createStage() is returning 0.  You
can run pdal --debug to show information about the plugin loading process
and verify which directories are being searched for plugins.  You can also
set the environment variable PDAL_DRIVER_PATH to override the default
locations ( ".", "./lib", "../lib", "./bin", "../bin")

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170808/5ac002ba/attachment.html>

From andrew.bell.ia at gmail.com  Tue Aug  8 08:30:13 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 8 Aug 2017 11:30:13 -0400
Subject: [pdal] PDAL and PCL
In-Reply-To: <DB5PR07MB09849406940351E5EC66D18EC48A0@DB5PR07MB0984.eurprd07.prod.outlook.com>
References: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>
 <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>
 <DB5PR07MB09849406940351E5EC66D18EC48A0@DB5PR07MB0984.eurprd07.prod.outlook.com>
Message-ID: <CACJ51z0oYqOW1_m=WQ55F3N8Tngib1cve+VAEEvGK0AQ_qyebw@mail.gmail.com>

Are there dll's in the directory C:/Scratch/Libraries/pdal/lib as well as
the .lib's?  .libs aren't loadable.  The build process should create
.dll files suitable for use as plugins.

On Tue, Aug 8, 2017 at 9:48 AM, Es Kay <fransinn at msn.com> wrote:

> Thanks Andrew!
>
>
> Indeed, createStage() returns a NULL-pointer.
>
> The output of pdal --debug is:
>
>
> (PDAL Debug) Loading plugins from directory .
> (PDAL Debug) Loading plugins from directory C:/Scratch/Libraries/pdal/lib
>    - kernels.delta
>    - kernels.diff
>    - kernels.ground
>    - kernels.hausdorff
>    - kernels.info
>    - kernels.merge
>    - kernels.pipeline
>    - kernels.random
>    - kernels.sort
>    - kernels.split
>    - kernels.tindex
>    - kernels.translate
>
> and the listed directory contains following lib-files:
>
>
> libpdal_plugin_filter_greedyprojection.lib
> libpdal_plugin_filter_gridprojection.lib
> libpdal_plugin_filter_hexbin.lib
> libpdal_plugin_filter_icp.lib
> libpdal_plugin_filter_movingleastsquares.lib
> libpdal_plugin_filter_pclblock.lib
> libpdal_plugin_filter_poisson.lib
> libpdal_plugin_filter_voxelgrid.lib
> libpdal_plugin_kernel_density.lib
> libpdal_plugin_kernel_pcl.lib
> libpdal_plugin_kernel_smooth.lib
> libpdal_plugin_reader_greyhound.lib
> libpdal_plugin_reader_nitf.lib
> libpdal_plugin_reader_oci.lib
> libpdal_plugin_reader_pcd.lib
> libpdal_plugin_reader_pgpointcloud.lib
> libpdal_plugin_reader_sqlite.lib
> libpdal_plugin_writer_nitf.lib
> libpdal_plugin_writer_oci.lib
> libpdal_plugin_writer_pcd.lib
> libpdal_plugin_writer_pgpointcloud.lib
> libpdal_plugin_writer_sqlite.lib
> pdal_arbiter.lib
> pdal_boost.lib
> pdal_jsoncpp.lib
> pdal_util.lib
> pdalcpp.lib
>
> So to me, it seems okay so far, right? Interestingly, pdal --drivers is
> missing some others as well, e.g. *.oci, *.pgpointcloud, *.poisson etc.
> However, it is listed when I navigate to the pdal bin folder.
>
>
>
> ------------------------------
> *Von:* Andrew Bell <andrew.bell.ia at gmail.com>
> *Gesendet:* Dienstag, 08. August 2017 12:47:05
> *An:* Es Kay
> *Cc:* pdal at lists.osgeo.org
> *Betreff:* Re: [pdal] PDAL and PCL
>
> On Mon, Aug 7, 2017 at 11:37 AM, Es Kay <fransinn at msn.com> wrote:
>
>> Hi guys,
>>
>> Stage *writer = factory.createStage("writers.pcd");
>>
>>
>> I get a bad alloc when setting the input (writer->setInput(reader);)
>> std::_Vector_alloc<std::_Vec_base_types<pdal::Stage *
>> __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat 0x78
>> zurückgegeben
>>
>>
>> When I type in pdal --drivers, the pcd writers and readers do not appear,
>> although dll-files exist in the bin-folder (the drivers appear when
>> navigated to bin folder in powershell).
>>
>
> If the drivers aren't shown with pdal --drivers, they can't be found by
> the plugin manager.  My assumption is that createStage() is returning 0.
> You can run pdal --debug to show information about the plugin loading
> process and verify which directories are being searched for plugins.  You
> can also set the environment variable PDAL_DRIVER_PATH to override the
> default locations ( ".", "./lib", "../lib", "./bin", "../bin")
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170808/a56e728b/attachment-0001.html>

From fransinn at msn.com  Tue Aug  8 06:48:21 2017
From: fransinn at msn.com (Es Kay)
Date: Tue, 8 Aug 2017 13:48:21 +0000
Subject: [pdal] PDAL and PCL
In-Reply-To: <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>
References: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>,
 <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>
Message-ID: <DB5PR07MB09849406940351E5EC66D18EC48A0@DB5PR07MB0984.eurprd07.prod.outlook.com>

Thanks Andrew!


Indeed, createStage() returns a NULL-pointer.

The output of pdal --debug is:


(PDAL Debug) Loading plugins from directory .
(PDAL Debug) Loading plugins from directory C:/Scratch/Libraries/pdal/lib
   - kernels.delta
   - kernels.diff
   - kernels.ground
   - kernels.hausdorff
   - kernels.info
   - kernels.merge
   - kernels.pipeline
   - kernels.random
   - kernels.sort
   - kernels.split
   - kernels.tindex
   - kernels.translate

and the listed directory contains following lib-files:


libpdal_plugin_filter_greedyprojection.lib
libpdal_plugin_filter_gridprojection.lib
libpdal_plugin_filter_hexbin.lib
libpdal_plugin_filter_icp.lib
libpdal_plugin_filter_movingleastsquares.lib
libpdal_plugin_filter_pclblock.lib
libpdal_plugin_filter_poisson.lib
libpdal_plugin_filter_voxelgrid.lib
libpdal_plugin_kernel_density.lib
libpdal_plugin_kernel_pcl.lib
libpdal_plugin_kernel_smooth.lib
libpdal_plugin_reader_greyhound.lib
libpdal_plugin_reader_nitf.lib
libpdal_plugin_reader_oci.lib
libpdal_plugin_reader_pcd.lib
libpdal_plugin_reader_pgpointcloud.lib
libpdal_plugin_reader_sqlite.lib
libpdal_plugin_writer_nitf.lib
libpdal_plugin_writer_oci.lib
libpdal_plugin_writer_pcd.lib
libpdal_plugin_writer_pgpointcloud.lib
libpdal_plugin_writer_sqlite.lib
pdal_arbiter.lib
pdal_boost.lib
pdal_jsoncpp.lib
pdal_util.lib
pdalcpp.lib


So to me, it seems okay so far, right? Interestingly, pdal --drivers is missing some others as well, e.g. *.oci, *.pgpointcloud, *.poisson etc. However, it is listed when I navigate to the pdal bin folder.



________________________________
Von: Andrew Bell <andrew.bell.ia at gmail.com>
Gesendet: Dienstag, 08. August 2017 12:47:05
An: Es Kay
Cc: pdal at lists.osgeo.org
Betreff: Re: [pdal] PDAL and PCL

On Mon, Aug 7, 2017 at 11:37 AM, Es Kay <fransinn at msn.com<mailto:fransinn at msn.com>> wrote:

Hi guys,

Stage *writer = factory.createStage("writers.pcd");


I get a bad alloc when setting the input (writer->setInput(reader);)
std::_Vector_alloc<std::_Vec_base_types<pdal::Stage * __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat 0x78 zurückgegeben


When I type in pdal --drivers, the pcd writers and readers do not appear, although dll-files exist in the bin-folder (the drivers appear when navigated to bin folder in powershell).

If the drivers aren't shown with pdal --drivers, they can't be found by the plugin manager.  My assumption is that createStage() is returning 0.  You can run pdal --debug to show information about the plugin loading process and verify which directories are being searched for plugins.  You can also set the environment variable PDAL_DRIVER_PATH to override the default locations ( ".", "./lib", "../lib", "./bin", "../bin")

--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170808/77c21eb9/attachment.html>

From jasonbeverage at gmail.com  Fri Aug 11 08:14:36 2017
From: jasonbeverage at gmail.com (Jason Beverage)
Date: Fri, 11 Aug 2017 15:14:36 +0000
Subject: [pdal] Reading/Writing to a memory stream
Message-ID: <CAMcxSMsmJQ9NK+QGjMUtTAyVk5K2NMtskQq9LSLs68+0WbEv+w@mail.gmail.com>

Hi all!

Is there any way to have PDAL read or write LAZ format from/to a memory
stream or would the best way be to read and write to a file and then just
load the data into memory myself.

For example, say I wanted to store laz tiles in an sqlite database instead
of on disk similar to how mbtiles works.

I'm just doing some experiments now and was curious if there was any built
in capability for this.

Jason
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170811/01f1a62a/attachment.html>

From andrew.bell.ia at gmail.com  Fri Aug 11 09:24:40 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 11 Aug 2017 12:24:40 -0400
Subject: [pdal] Reading/Writing to a memory stream
In-Reply-To: <CAMcxSMsmJQ9NK+QGjMUtTAyVk5K2NMtskQq9LSLs68+0WbEv+w@mail.gmail.com>
References: <CAMcxSMsmJQ9NK+QGjMUtTAyVk5K2NMtskQq9LSLs68+0WbEv+w@mail.gmail.com>
Message-ID: <CACJ51z2D-oxxLMvnP+BbBr6dthYO4_Nyz1vJHeXJ1UziYZjP-g@mail.gmail.com>

Hi Jason,

It depends exactly what you want.  Our entwine software writes points in
LAZ format in blocks using the compressor that's part of PDAL.  However,
it's not writing straight LAZ files.  It's just writing the point data, not
the header or the VLRs, etc.  Take a look at https://github.com/
connormanning/entwine/blob/master/entwine/util/compression.cpp

We write points to databases natively, if that's what you want, but not LAZ
tiles, as such.

If you want to write the entire LAZ file to a database, I don't know that
we have anything that allows this directly.  You can certainly write a
file, mmap the file and then just do a direct copy of the memory to
whatever output source you'd like.  Most of the time, the OS won't even
flush to physical disk unless you're short memory or force it with some
flush()/sync() call, so there isn't much overhead.  Internally, the LAS/LAZ
writer uses a std::ostream, which you could theoretically carve out of heap
if you knew the size in advance (you don't, unless you want to be really
pessimistic).  LAZ typically is written in chunks of points, so the memory
can be limited, but if you want a ton of points written out without
worrying about the LAZ chunking and such, you might have to allocate a
bunch of memory.  Sometimes we do this on other formats because we have no
choice, but that may not fit with your plan.

On Fri, Aug 11, 2017 at 11:14 AM, Jason Beverage <jasonbeverage at gmail.com>
wrote:

> Hi all!
>
> Is there any way to have PDAL read or write LAZ format from/to a memory
> stream or would the best way be to read and write to a file and then just
> load the data into memory myself.
>
> For example, say I wanted to store laz tiles in an sqlite database instead
> of on disk similar to how mbtiles works.
>
> I'm just doing some experiments now and was curious if there was any built
> in capability for this.
>
> Jason
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170811/2501d53e/attachment.html>

From andrew.bell.ia at gmail.com  Wed Aug 16 04:14:23 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 16 Aug 2017 07:14:23 -0400
Subject: [pdal] PDAL and PCL
In-Reply-To: <VI1PR0701MB2975EE9F2549C7E93610DA0BC4820@VI1PR0701MB2975.eurprd07.prod.outlook.com>
References: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>
 <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>
 <DB5PR07MB09849406940351E5EC66D18EC48A0@DB5PR07MB0984.eurprd07.prod.outlook.com>
 <CACJ51z0oYqOW1_m=WQ55F3N8Tngib1cve+VAEEvGK0AQ_qyebw@mail.gmail.com>
 <VI1PR0701MB2975EE9F2549C7E93610DA0BC4820@VI1PR0701MB2975.eurprd07.prod.outlook.com>
Message-ID: <CACJ51z3pHU=9z66dqaWQWdEA39mAuRBT=W2m+5c4C7KXxLzEZA@mail.gmail.com>

Yes. Take a look at the code in plugins/pcl/filters/PCLBlock.cpp and
plugins/pcl/PCLConversions.hpp

On Wed, Aug 16, 2017 at 5:34 AM, Es Kay <fransinn at msn.com> wrote:

> I had no dll files in my lib folder. So I copied them from the bin to the
> lib folder and now it works.
> Thanks for that.
>
>
> Instead of converting a binary las to a pcd file, I was wondering if pdal
> provides any tools to convert a pdal point view to a pcl point cloud
> pointer directly inside the c++ application.
>
>
> Best regards
>
> fransinn
>
>
> ------------------------------
> *Von:* Andrew Bell <andrew.bell.ia at gmail.com>
> *Gesendet:* Dienstag, 08. August 2017 15:30:13
> *An:* Es Kay
> *Cc:* pdal at lists.osgeo.org
> *Betreff:* Re: [pdal] PDAL and PCL
>
> Are there dll's in the directory C:/Scratch/Libraries/pdal/lib as well as
> the .lib's?  .libs aren't loadable.  The build process should create
> .dll files suitable for use as plugins.
>
> On Tue, Aug 8, 2017 at 9:48 AM, Es Kay <fransinn at msn.com> wrote:
>
>> Thanks Andrew!
>>
>>
>> Indeed, createStage() returns a NULL-pointer.
>>
>> The output of pdal --debug is:
>>
>>
>> (PDAL Debug) Loading plugins from directory .
>> (PDAL Debug) Loading plugins from directory C:/Scratch/Libraries/pdal/lib
>>    - kernels.delta
>>    - kernels.diff
>>    - kernels.ground
>>    - kernels.hausdorff
>>    - kernels.info
>>    - kernels.merge
>>    - kernels.pipeline
>>    - kernels.random
>>    - kernels.sort
>>    - kernels.split
>>    - kernels.tindex
>>    - kernels.translate
>>
>> and the listed directory contains following lib-files:
>>
>>
>> libpdal_plugin_filter_greedyprojection.lib
>> libpdal_plugin_filter_gridprojection.lib
>> libpdal_plugin_filter_hexbin.lib
>> libpdal_plugin_filter_icp.lib
>> libpdal_plugin_filter_movingleastsquares.lib
>> libpdal_plugin_filter_pclblock.lib
>> libpdal_plugin_filter_poisson.lib
>> libpdal_plugin_filter_voxelgrid.lib
>> libpdal_plugin_kernel_density.lib
>> libpdal_plugin_kernel_pcl.lib
>> libpdal_plugin_kernel_smooth.lib
>> libpdal_plugin_reader_greyhound.lib
>> libpdal_plugin_reader_nitf.lib
>> libpdal_plugin_reader_oci.lib
>> libpdal_plugin_reader_pcd.lib
>> libpdal_plugin_reader_pgpointcloud.lib
>> libpdal_plugin_reader_sqlite.lib
>> libpdal_plugin_writer_nitf.lib
>> libpdal_plugin_writer_oci.lib
>> libpdal_plugin_writer_pcd.lib
>> libpdal_plugin_writer_pgpointcloud.lib
>> libpdal_plugin_writer_sqlite.lib
>> pdal_arbiter.lib
>> pdal_boost.lib
>> pdal_jsoncpp.lib
>> pdal_util.lib
>> pdalcpp.lib
>>
>> So to me, it seems okay so far, right? Interestingly, pdal --drivers is
>> missing some others as well, e.g. *.oci, *.pgpointcloud, *.poisson etc.
>> However, it is listed when I navigate to the pdal bin folder.
>>
>>
>>
>> ------------------------------
>> *Von:* Andrew Bell <andrew.bell.ia at gmail.com>
>> *Gesendet:* Dienstag, 08. August 2017 12:47:05
>> *An:* Es Kay
>> *Cc:* pdal at lists.osgeo.org
>> *Betreff:* Re: [pdal] PDAL and PCL
>>
>> On Mon, Aug 7, 2017 at 11:37 AM, Es Kay <fransinn at msn.com> wrote:
>>
>>> Hi guys,
>>>
>>> Stage *writer = factory.createStage("writers.pcd");
>>>
>>>
>>> I get a bad alloc when setting the input (writer->setInput(reader);)
>>> std::_Vector_alloc<std::_Vec_base_types<pdal::Stage *
>>> __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat
>>> 0x78 zurückgegeben
>>>
>>>
>>> When I type in pdal --drivers, the pcd writers and readers do not
>>> appear, although dll-files exist in the bin-folder (the drivers appear when
>>> navigated to bin folder in powershell).
>>>
>>
>> If the drivers aren't shown with pdal --drivers, they can't be found by
>> the plugin manager.  My assumption is that createStage() is returning 0.
>> You can run pdal --debug to show information about the plugin loading
>> process and verify which directories are being searched for plugins.  You
>> can also set the environment variable PDAL_DRIVER_PATH to override the
>> default locations ( ".", "./lib", "../lib", "./bin", "../bin")
>>
>> --
>> Andrew Bell
>> andrew.bell.ia at gmail.com
>>
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170816/552339a5/attachment.html>

From fransinn at msn.com  Wed Aug 16 02:34:09 2017
From: fransinn at msn.com (Es Kay)
Date: Wed, 16 Aug 2017 09:34:09 +0000
Subject: [pdal] PDAL and PCL
In-Reply-To: <CACJ51z0oYqOW1_m=WQ55F3N8Tngib1cve+VAEEvGK0AQ_qyebw@mail.gmail.com>
References: <DB5PR07MB09841D7D7ACE6D669306D06DC4B50@DB5PR07MB0984.eurprd07.prod.outlook.com>
 <CACJ51z0FBq3BzLV=zVmafKRkyB7iksx0eZeeK2veV+hcme6_eQ@mail.gmail.com>
 <DB5PR07MB09849406940351E5EC66D18EC48A0@DB5PR07MB0984.eurprd07.prod.outlook.com>,
 <CACJ51z0oYqOW1_m=WQ55F3N8Tngib1cve+VAEEvGK0AQ_qyebw@mail.gmail.com>
Message-ID: <VI1PR0701MB2975EE9F2549C7E93610DA0BC4820@VI1PR0701MB2975.eurprd07.prod.outlook.com>

I had no dll files in my lib folder. So I copied them from the bin to the lib folder and now it works.
Thanks for that.


Instead of converting a binary las to a pcd file, I was wondering if pdal provides any tools to convert a pdal point view to a pcl point cloud pointer directly inside the c++ application.


Best regards

fransinn


________________________________
Von: Andrew Bell <andrew.bell.ia at gmail.com>
Gesendet: Dienstag, 08. August 2017 15:30:13
An: Es Kay
Cc: pdal at lists.osgeo.org
Betreff: Re: [pdal] PDAL and PCL

Are there dll's in the directory C:/Scratch/Libraries/pdal/lib as well as the .lib's?  .libs aren't loadable.  The build process should create .dll files suitable for use as plugins.

On Tue, Aug 8, 2017 at 9:48 AM, Es Kay <fransinn at msn.com<mailto:fransinn at msn.com>> wrote:

Thanks Andrew!


Indeed, createStage() returns a NULL-pointer.

The output of pdal --debug is:


(PDAL Debug) Loading plugins from directory .
(PDAL Debug) Loading plugins from directory C:/Scratch/Libraries/pdal/lib
   - kernels.delta
   - kernels.diff
   - kernels.ground
   - kernels.hausdorff
   - kernels.info<http://kernels.info>
   - kernels.merge
   - kernels.pipeline
   - kernels.random
   - kernels.sort
   - kernels.split
   - kernels.tindex
   - kernels.translate

and the listed directory contains following lib-files:


libpdal_plugin_filter_greedyprojection.lib
libpdal_plugin_filter_gridprojection.lib
libpdal_plugin_filter_hexbin.lib
libpdal_plugin_filter_icp.lib
libpdal_plugin_filter_movingleastsquares.lib
libpdal_plugin_filter_pclblock.lib
libpdal_plugin_filter_poisson.lib
libpdal_plugin_filter_voxelgrid.lib
libpdal_plugin_kernel_density.lib
libpdal_plugin_kernel_pcl.lib
libpdal_plugin_kernel_smooth.lib
libpdal_plugin_reader_greyhound.lib
libpdal_plugin_reader_nitf.lib
libpdal_plugin_reader_oci.lib
libpdal_plugin_reader_pcd.lib
libpdal_plugin_reader_pgpointcloud.lib
libpdal_plugin_reader_sqlite.lib
libpdal_plugin_writer_nitf.lib
libpdal_plugin_writer_oci.lib
libpdal_plugin_writer_pcd.lib
libpdal_plugin_writer_pgpointcloud.lib
libpdal_plugin_writer_sqlite.lib
pdal_arbiter.lib
pdal_boost.lib
pdal_jsoncpp.lib
pdal_util.lib
pdalcpp.lib


So to me, it seems okay so far, right? Interestingly, pdal --drivers is missing some others as well, e.g. *.oci, *.pgpointcloud, *.poisson etc. However, it is listed when I navigate to the pdal bin folder.



________________________________
Von: Andrew Bell <andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>>
Gesendet: Dienstag, 08. August 2017 12:47:05
An: Es Kay
Cc: pdal at lists.osgeo.org<mailto:pdal at lists.osgeo.org>
Betreff: Re: [pdal] PDAL and PCL

On Mon, Aug 7, 2017 at 11:37 AM, Es Kay <fransinn at msn.com<mailto:fransinn at msn.com>> wrote:

Hi guys,

Stage *writer = factory.createStage("writers.pcd");


I get a bad alloc when setting the input (writer->setInput(reader);)
std::_Vector_alloc<std::_Vec_base_types<pdal::Stage * __ptr64,std::allocator<pdal::Stage * __ptr64> > >::_Mylast(...) hat 0x78 zurückgegeben


When I type in pdal --drivers, the pcd writers and readers do not appear, although dll-files exist in the bin-folder (the drivers appear when navigated to bin folder in powershell).

If the drivers aren't shown with pdal --drivers, they can't be found by the plugin manager.  My assumption is that createStage() is returning 0.  You can run pdal --debug to show information about the plugin loading process and verify which directories are being searched for plugins.  You can also set the environment variable PDAL_DRIVER_PATH to override the default locations ( ".", "./lib", "../lib", "./bin", "../bin")

--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>



--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170816/343e5e92/attachment-0001.html>

From ppark31 at gmail.com  Fri Aug 25 13:09:03 2017
From: ppark31 at gmail.com (Paul Sung-Pyo Park)
Date: Fri, 25 Aug 2017 16:09:03 -0400
Subject: [pdal] LAS to PCD Translate Error Uint16
Message-ID: <CANKgJ5+_Xw05hBmB_4g1rRVX9UGmxRdY+3swFVPynzefNnqnJw@mail.gmail.com>

Hello,

I have been trying to convert a LAS file to PCD using PDAL and have had
this error pop up:
"RuntimeError: Unable to fetch data and convert as requested:
Red:uint16_t(50490) -> unsigned char"

I am very new to PDAL as well as programming in general. Would there be a
simple line I can add to my JSON pipeline file to filter uint16 to uint8?
My current thought is to find a way to divide the input LAS by 65,535 then
multiply by 255. However, not sure how I should implement this with my
shallow knowledge. I am currently using Python with JSON inside the script
as the pipeline.
Thank You.

-- 
*Paul Park*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170825/6fa9014b/attachment.html>

From andrew.bell.ia at gmail.com  Fri Aug 25 13:48:36 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 25 Aug 2017 16:48:36 -0400
Subject: [pdal] LAS to PCD Translate Error Uint16
In-Reply-To: <CANKgJ5+_Xw05hBmB_4g1rRVX9UGmxRdY+3swFVPynzefNnqnJw@mail.gmail.com>
References: <CANKgJ5+_Xw05hBmB_4g1rRVX9UGmxRdY+3swFVPynzefNnqnJw@mail.gmail.com>
Message-ID: <CACJ51z0MWj7N_P68bsC5r3fzt3TurC0u80qWq9JkqtSwviJwog@mail.gmail.com>

You should be able to divide the values by 256 (right shift 8 bits) in your
python script.

There is a similar example here:
https://www.pdal.io/stages/filters.programmable.html

Hope that helps.

On Fri, Aug 25, 2017 at 4:09 PM, Paul Sung-Pyo Park <ppark31 at gmail.com>
wrote:

> Hello,
>
> I have been trying to convert a LAS file to PCD using PDAL and have had
> this error pop up:
> "RuntimeError: Unable to fetch data and convert as requested:
> Red:uint16_t(50490) -> unsigned char"
>
> I am very new to PDAL as well as programming in general. Would there be a
> simple line I can add to my JSON pipeline file to filter uint16 to uint8?
> My current thought is to find a way to divide the input LAS by 65,535 then
> multiply by 255. However, not sure how I should implement this with my
> shallow knowledge. I am currently using Python with JSON inside the script
> as the pipeline.
> Thank You.
>
> --
> *Paul Park*
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170825/9465f035/attachment.html>

From carl.anderson at vadose.org  Wed Aug 30 19:35:34 2017
From: carl.anderson at vadose.org (Carl Anderson)
Date: Wed, 30 Aug 2017 22:35:34 -0400
Subject: [pdal] filter.range and dimensions with numerics in their name
Message-ID: <CAAuwKSyK1T5vZjHsVfpXKqRGUza+Q6t0MCSaBhS8+2WPfPbXfA@mail.gmail.com>

Hello list,

I am having issues building a pipeline with

    {
      "type":"filters.normal",
      "tag":"curvature_32",
      "knn":"7"
    },
    {
      "type":"filters.eigenvalues",
      "tag":"eigen",
      "knn":"6"
    },
    {
      "type":"filters.range",
      "tag":"postfilter",
      "limits":"Eigenvalue0[0.0:6.5]",
      "limits":"Curvature[0.0:0.04]"
    },

The pipeline fails with
PDAL: filters.range: Invalid 'limits' option: 'Eigenvalue0[:6.5]': Missing
'(' or '['.

When I remove the dimension Eigenvalue0, the pipeline executes.

Before digging into the source, is this likely to be a dimension name issue?

TIA

C.

Carl Anderson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170830/968139b8/attachment.html>

From brad.chambers at gmail.com  Wed Aug 30 19:52:47 2017
From: brad.chambers at gmail.com (Bradley Chambers)
Date: Thu, 31 Aug 2017 02:52:47 +0000
Subject: [pdal] filter.range and dimensions with numerics in their name
In-Reply-To: <CAAuwKSyK1T5vZjHsVfpXKqRGUza+Q6t0MCSaBhS8+2WPfPbXfA@mail.gmail.com>
References: <CAAuwKSyK1T5vZjHsVfpXKqRGUza+Q6t0MCSaBhS8+2WPfPbXfA@mail.gmail.com>
Message-ID: <CAJyqqPyi+zUcSB1sxA9HG5SGhf+qWsa9gezEWw_Nu6b_DfNmDg@mail.gmail.com>

This appears to be a legitimate issue with the way we are parsing the
limits. I've filed a ticket at https://github.com/PDAL/PDAL/issues/1659.

On Wed, Aug 30, 2017 at 10:35 PM Carl Anderson <carl.anderson at vadose.org>
wrote:

> Hello list,
>
> I am having issues building a pipeline with
>
>     {
>       "type":"filters.normal",
>       "tag":"curvature_32",
>       "knn":"7"
>     },
>     {
>       "type":"filters.eigenvalues",
>       "tag":"eigen",
>       "knn":"6"
>     },
>     {
>       "type":"filters.range",
>       "tag":"postfilter",
>       "limits":"Eigenvalue0[0.0:6.5]",
>       "limits":"Curvature[0.0:0.04]"
>     },
>
> The pipeline fails with
> PDAL: filters.range: Invalid 'limits' option: 'Eigenvalue0[:6.5]': Missing
> '(' or '['.
>
> When I remove the dimension Eigenvalue0, the pipeline executes.
>
> Before digging into the source, is this likely to be a dimension name
> issue?
>
> TIA
>
> C.
>
> Carl Anderson
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170831/429e31e6/attachment.html>

From andrew.bell.ia at gmail.com  Thu Aug 31 05:29:14 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 31 Aug 2017 08:29:14 -0400
Subject: [pdal] filter.range and dimensions with numerics in their name
In-Reply-To: <CAJyqqPyi+zUcSB1sxA9HG5SGhf+qWsa9gezEWw_Nu6b_DfNmDg@mail.gmail.com>
References: <CAAuwKSyK1T5vZjHsVfpXKqRGUza+Q6t0MCSaBhS8+2WPfPbXfA@mail.gmail.com>
 <CAJyqqPyi+zUcSB1sxA9HG5SGhf+qWsa9gezEWw_Nu6b_DfNmDg@mail.gmail.com>
Message-ID: <CACJ51z0TV_ei_nPNJhxwTMjqpOaEP8U_4KcAoChoNpHb84WPFA@mail.gmail.com>

We changed the rules for dimension names some time ago, but this instance
didn't get updated.  I changed the code so that the appropriate function is
called to parse the dimension name.  See the above-referenced ticket for
details.

On Wed, Aug 30, 2017 at 10:52 PM, Bradley Chambers <brad.chambers at gmail.com>
wrote:

> This appears to be a legitimate issue with the way we are parsing the
> limits. I've filed a ticket at https://github.com/PDAL/PDAL/issues/1659.
>
> On Wed, Aug 30, 2017 at 10:35 PM Carl Anderson <carl.anderson at vadose.org>
> wrote:
>
>> Hello list,
>>
>> I am having issues building a pipeline with
>>
>>     {
>>       "type":"filters.normal",
>>       "tag":"curvature_32",
>>       "knn":"7"
>>     },
>>     {
>>       "type":"filters.eigenvalues",
>>       "tag":"eigen",
>>       "knn":"6"
>>     },
>>     {
>>       "type":"filters.range",
>>       "tag":"postfilter",
>>       "limits":"Eigenvalue0[0.0:6.5]",
>>       "limits":"Curvature[0.0:0.04]"
>>     },
>>
>> The pipeline fails with
>> PDAL: filters.range: Invalid 'limits' option: 'Eigenvalue0[:6.5]':
>> Missing '(' or '['.
>>
>> When I remove the dimension Eigenvalue0, the pipeline executes.
>>
>> Before digging into the source, is this likely to be a dimension name
>> issue?
>>
>> TIA
>>
>> C.
>>
>> Carl Anderson
>>
>> _______________________________________________
>> pdal mailing list
>> pdal at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/pdal
>
>
> _______________________________________________
> pdal mailing list
> pdal at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/pdal
>



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/pdal/attachments/20170831/47c470d4/attachment.html>

