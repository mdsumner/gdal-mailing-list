From landis at isciences.com  Mon Jul 12 05:39:16 2010
From: landis at isciences.com (Matthew Landis)
Date: Mon, 12 Jul 2010 08:39:16 -0400
Subject: [Proj] T62 Gaussian grid
Message-ID: <4C3B0CF4.1000808@isciences.com>

Dear Proj list,

I'm trying to incorporate some climate data into a model.  Most of our 
data is on a regular lat-lon grid, but the climate data uses a T62 
Gaussian grid.  I'm new to these; apparently they are commonly used in 
climate models (see http://en.wikipedia.org/wiki/Gaussian_grid). The 
distinguishing feature is that they are not regular grids in that the 
size of the latitude grid cells varies with latitude.   I'd like to be 
able to interpolate them to a regular grid (I'm working in R using 
rgdal), but I haven't been able to find a proj.4 string to help specify 
the interpolation. 

In the meantime, I have  a workaround by simply changing the latitude 
coordinates at the poles slightly to fit on a regular grid.  This should 
be OK, but for the sake of appearances I'd like to do it the proper way.

Many thanks for any thoughts. 

Sincerely,

Matt

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~



From ckarney at Sarnoff.com  Tue Jul 13 14:36:48 2010
From: ckarney at Sarnoff.com (Karney, Charles)
Date: Tue, 13 Jul 2010 17:36:48 -0400
Subject: [Proj] Wallis 1 transverse Mercator
Message-ID: <CED6B4B383C5F0418DAFEA443A0033C2F90E27955C@MALIBU.sarnoff.internal>

> From: strebe at aol.com
> Sent: Sunday, February 01, 2009 04:23
> 
> I've posted here and image of yet another ellipsoidal transverse
> Mercator variation:
>      http://www.mapthematics.com/Wallis1TransverseMercator.tif
> 
> This one's properties are:
>      Conformal (of course)
>      Straight central meridian (of course)
>      Parallels are equally spaced.
> 
> The importance of this last property is that the projection then may
> be squeezed through the rectifying latitude calculation as applied to
> the complex plane, and out pops Gauß-Krüger. I generated the map using
> the same eccentricity in your examples so that the 81st meridian (and
> 99th) will run into the singularities. The graticule is 9°. The
> projection is cropped at a distance of 4 arc seconds around the
> singularities; in point of fact the projection is infinite in extent.

There's a depiction of your "Wallis 1" projection in

    R. Koenig and K. H. Weise,
    Mathematische Grundlagen der Hoeheren Geodaesie und Kartographie,
    (Springer-Verlag, 1951), Vol 1.

See figure 16b on page 88.  They call this the "complex latitude plane"
(B-Ebene).

	--Charles

--
Charles Karney <ckarney at sarnoff.com>
Sarnoff Corporation, Princeton, NJ 08543-5300

Tel: +1 609 734 2312
Fax: +1 609 734 2662


From strebe at aol.com  Wed Jul 14 18:56:27 2010
From: strebe at aol.com (strebe)
Date: Wed, 14 Jul 2010 18:56:27 -0700
Subject: [Proj] Wallis 1 transverse Mercator
In-Reply-To: <CED6B4B383C5F0418DAFEA443A0033C2F90E27955C@MALIBU.sarnoff.internal>
Message-ID: <ACAD4E7A.B712.4F9A.ABF1.B36E87E16101@aol.com>


Charles:

Thank you very much for this reference, which I had not heard of. Now I can be less surprised that the variant has been overlooked! I will add the “complex latitude transverse Mercator” as a synonym in Geocart’s literature and try to acquire a copy of the paper.

Regards,
— daan Strebe


On Jul 13, 2010, at 2:36:48 PM, "Karney, Charles" <ckarney at Sarnoff.com> wrote:

From:   "Karney, Charles" <ckarney at Sarnoff.com>
Subject:    Wallis 1 transverse Mercator
Date:   July 13, 2010 2:36:48 PM PDT
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>, "strebe at aol.com" <strebe at aol.com>
> From: strebe at aol.com
> Sent: Sunday, February 01, 2009 04:23
> 
> I've posted here and image of yet another ellipsoidal transverse
> Mercator variation:
>      http://www.mapthematics.com/Wallis1TransverseMercator.tif
> 
> This one's properties are:
>      Conformal (of course)
>      Straight central meridian (of course)
>      Parallels are equally spaced.
> 
> The importance of this last property is that the projection then may
> be squeezed through the rectifying latitude calculation as applied to
> the complex plane, and out pops Gauß-Krüger. I generated the map using
> the same eccentricity in your examples so that the 81st meridian (and
> 99th) will run into the singularities. The graticule is 9°. The
> projection is cropped at a distance of 4 arc seconds around the
> singularities; in point of fact the projection is infinite in extent.

There's a depiction of your "Wallis 1" projection in

    R. Koenig and K. H. Weise,
    Mathematische Grundlagen der Hoeheren Geodaesie und Kartographie,
    (Springer-Verlag, 1951), Vol 1.

See figure 16b on page 88.  They call this the "complex latitude plane"
(B-Ebene).

    --Charles

--
Charles Karney <ckarney at sarnoff.com>
Sarnoff Corporation, Princeton, NJ 08543-5300

Tel: +1 609 734 2312
Fax: +1 609 734 2662
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100714/87cdccca/attachment.html>

From haileyeckstrand at gmail.com  Wed Jul 21 13:12:15 2010
From: haileyeckstrand at gmail.com (Hailey Eckstrand)
Date: Wed, 21 Jul 2010 13:12:15 -0700
Subject: [Proj] proj4 definition for transverse mercator projection from
	RegCM3 model for North America
Message-ID: <AANLkTin6GWIFnaIChTjLOWMRntkw-Ub9BgdcqJ60etzl@mail.gmail.com>

Hello all,
I am trying to create the proj4 string for a netcdf file with the following
coordinate information:

variables:
        char Transverse_Mercator ;
                Transverse_Mercator:grid_mapping_name =
"transverse_mercator" ;
                Transverse_Mercator:longitude_of_central_meridian = -97. ;
                Transverse_Mercator:latitude_of_projection_origin = 47.5 ;
                Transverse_Mercator:scale_factor_at_central_meridian = 1. ;
                Transverse_Mercator:false_easting = 3925000. ;
                Transverse_Mercator:false_northing = 3175000. ;
        double lat(yc, xc) ;
                lat:units = "degrees_north" ;
                lat:long_name = "latitude" ;
                lat:standard_name = "latitude" ;
                lat:axis = "Y" ;
        double lon(yc, xc) ;
                lon:units = "degrees_east" ;
                lon:long_name = "longitude" ;
                lon:standard_name = "longitude" ;
                lon:axis = "X" ;
        double xc(xc) ;
                xc:long_name = "x-coordinate in Cartesian system" ;
                xc:standard_name = "projection_x_coordinate" ;
                xc:units = "m" ;
                xc:axis = "X" ;
        double yc(yc) ;
                yc:long_name = "y-coordinate in Cartesian system" ;
                yc:standard_name = "projection_y_coordinate" ;
                yc:units = "m" ;
                yc:axis = "Y" ;


The file gives the coordinates in their native projected coordinates as well
as the lat & lon coordinates.

>From this information, I created the following proj4 string:
+proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=-97.0 +k_0=1.0
+units=m +ellps=sphere

(The sphere ellipsoid is a guess as they didn't provide the geographic
coordinate system.)
So when I test out this proj4 string, these are the results I get:

proj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0
+lon_0=-97.0 +k_0=1.0 +units=m +ellps=sphere
in> -126.0869 19.61229
in> -125.6792 19.77242
in> -125.2703 19.93048

out> 773317.154904   359897.643377
out> 824089.485710   370794.986195
out> 874706.342446   381466.440468

the projection coordinates should be:
600000   600000
650000   600000
700000   600000

and then the opposite transformation:

invproj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0
+lon_0=263 +k_0=1.0 +ellps=sphere
in>  600000 600000
in>  650000 600000
in>  700000 600000

out>  -127.929260     -21.210147
out>  -127.514502     -21.293413
out>  -127.097731     -21.375966

and the coordinates should be:
-126.0869 19.61229
-125.6792 19.77242
-125.2703 19.93048

The longitude are at least in the ballpark, but the latitudes are completely
off.

If it helps, this data has been downloaded from NARCCAP, and it is the
RegCM3 model.
Any help would really be appreciated.
Thanks in advance,
Hailey
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100721/17dbddc2/attachment.html>

From support.mn at elisanet.fi  Thu Jul 22 00:51:40 2010
From: support.mn at elisanet.fi (support.mn at elisanet.fi)
Date: Thu, 22 Jul 2010 10:51:40 +0300 (EEST)
Subject: [Proj] proj4 definition for transverse mercator projection from
 RegCM3 model for North America
Message-ID: <1073288.471001279785100886.JavaMail.support.mn@elisanet.fi>

Hello,

You have different lon_0 ??!!

fwd: +lon_0=-97.0
inv: +lon_0=263

Are you sure your parameters are correct??

Regards: Janne.

=====================================

Hailey Eckstrand [haileyeckstrand at gmail.com] kirjoitti: 
> Hello all,
> I am trying to create the proj4 string for a netcdf file with the following
> coordinate information:
> 
> variables:
>         char Transverse_Mercator ;
>                 Transverse_Mercator:grid_mapping_name =
> "transverse_mercator" ;
>                 Transverse_Mercator:longitude_of_central_meridian = -97. ;
>                 Transverse_Mercator:latitude_of_projection_origin = 47.5 ;
>                 Transverse_Mercator:scale_factor_at_central_meridian = 1. ;
>                 Transverse_Mercator:false_easting = 3925000. ;
>                 Transverse_Mercator:false_northing = 3175000. ;
>         double lat(yc, xc) ;
>                 lat:units = "degrees_north" ;
>                 lat:long_name = "latitude" ;
>                 lat:standard_name = "latitude" ;
>                 lat:axis = "Y" ;
>         double lon(yc, xc) ;
>                 lon:units = "degrees_east" ;
>                 lon:long_name = "longitude" ;
>                 lon:standard_name = "longitude" ;
>                 lon:axis = "X" ;
>         double xc(xc) ;
>                 xc:long_name = "x-coordinate in Cartesian system" ;
>                 xc:standard_name = "projection_x_coordinate" ;
>                 xc:units = "m" ;
>                 xc:axis = "X" ;
>         double yc(yc) ;
>                 yc:long_name = "y-coordinate in Cartesian system" ;
>                 yc:standard_name = "projection_y_coordinate" ;
>                 yc:units = "m" ;
>                 yc:axis = "Y" ;
> 
> 
> The file gives the coordinates in their native projected coordinates as well
> as the lat & lon coordinates.
> 
> From this information, I created the following proj4 string:
> +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=-97.0 +k_0=1.0
> +units=m +ellps=sphere
> 
> (The sphere ellipsoid is a guess as they didn't provide the geographic
> coordinate system.)
> So when I test out this proj4 string, these are the results I get:
> 
> proj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0
> +lon_0=-97.0 +k_0=1.0 +units=m +ellps=sphere
> in> -126.0869 19.61229
> in> -125.6792 19.77242
> in> -125.2703 19.93048
> 
> out> 773317.154904   359897.643377
> out> 824089.485710   370794.986195
> out> 874706.342446   381466.440468
> 
> the projection coordinates should be:
> 600000   600000
> 650000   600000
> 700000   600000
> 
> and then the opposite transformation:
> 
> invproj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0
> +lon_0=263 +k_0=1.0 +ellps=sphere
> in>  600000 600000
> in>  650000 600000
> in>  700000 600000
> 
> out>  -127.929260     -21.210147
> out>  -127.514502     -21.293413
> out>  -127.097731     -21.375966
> 
> and the coordinates should be:
> -126.0869 19.61229
> -125.6792 19.77242
> -125.2703 19.93048
> 
> The longitude are at least in the ballpark, but the latitudes are completely
> off.
> 
> If it helps, this data has been downloaded from NARCCAP, and it is the
> RegCM3 model.
> Any help would really be appreciated.
> Thanks in advance,
> Hailey
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From haileyeckstrand at gmail.com  Thu Jul 22 09:32:34 2010
From: haileyeckstrand at gmail.com (Hailey Eckstrand)
Date: Thu, 22 Jul 2010 16:32:34 +0000 (UTC)
Subject: [Proj] proj4 definition for transverse mercator projection from
	RegCM3 model for North America
References: <1073288.471001279785100886.JavaMail.support.mn@elisanet.fi>
Message-ID: <loom.20100722T180712-594@post.gmane.org>

Hi,
Looks like I pasted in the wrong statement. Sorry! I was just testing out
different ideas. It doesn't make a different though, as lon_0=-97 & lon_0=263
both output the same result:

proj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=-97.0
+k_0=1.0 +units=m +ellps=sphere
in> -126.0869 19.61229
in> -125.6792 19.77242
in> -125.2703 19.93048

out> 773317.154904   359897.643377
out> 824089.485710   370794.986195
out> 874706.342446   381466.440468

proj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=263
+k_0=1.0 +units=m +ellps=sphere
in> -126.0869 19.61229
in> -125.6792 19.77242
in> -125.2703 19.93048

out> 773317.154904   359897.643377
out> 824089.485710   370794.986195
out> 874706.342446   381466.440468

invproj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=263
+k_0=1.0 +ellps=sphere 
in> 600000 600000
in> 650000 600000
in> 700000 600000

out> -127.929260     -21.210147
out> -127.514502     -21.293413
out> -127.097731     -21.375966

invproj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=-97
+k_0=1.0 +ellps=sphere 
in> 600000 600000
in> 650000 600000
in> 700000 600000

out> -127.929260     -21.210147
out> -127.514502     -21.293413
out> -127.097731     -21.375966

Hailey 





From support.mn at elisanet.fi  Fri Jul 23 14:52:37 2010
From: support.mn at elisanet.fi (support.mn at elisanet.fi)
Date: Sat, 24 Jul 2010 00:52:37 +0300 (EEST)
Subject: [Proj] proj4 definition for transverse mercator projection from
 RegCM3 model for North America
Message-ID: <6059212.539451279921957759.JavaMail.support.mn@elisanet.fi>

Hello,

> The sphere ellipsoid is a guess as they didn't provide the geographic coordinate system

check your parameters, especially if the assumption about the sphere is correct and if the
sphere is of a right size? Test with the normal NAD83, NAD27, WGS84 datums with their
correct ellipsoids Clarke 1866,  GRS 80 and WGS84 etx.

http://en.wikipedia.org/wiki/North_American_Datum

http://en.wikipedia.org/wiki/World_Geodetic_System

Janne.



From mkennedy2 at earthlink.net  Sun Jul 25 17:28:42 2010
From: mkennedy2 at earthlink.net (Melita Kennedy)
Date: Sun, 25 Jul 2010 17:28:42 -0700 (GMT-07:00)
Subject: [Proj] proj4 definition for transverse mercator projection from
 RegCM3 model for North America
Message-ID: <27671997.1280104122461.JavaMail.root@elwamui-darkeyed.atl.sa.earthlink.net>




-----Original Message-----

>Date: Sat, 24 Jul 2010 00:52:37 +0300 (EEST)
>From: support.mn at elisanet.fi
>Subject: Re: [Proj] proj4 definition for transverse mercator
>	projection from RegCM3 model for North America
>To: "PROJ.4 and general Projections Discussions"
>	<proj at lists.maptools.org>
>
>Hello,
>
>> The sphere ellipsoid is a guess as they didn't provide the geographic coordinate system
>
>check your parameters, especially if the assumption about the sphere is correct and if the
>sphere is of a right size? Test with the normal NAD83, NAD27, WGS84 datums with their
>correct ellipsoids Clarke 1866,  GRS 80 and WGS84 etx.
>
>http://en.wikipedia.org/wiki/North_American_Datum
>
>http://en.wikipedia.org/wiki/World_Geodetic_System
>
>Janne.

I just looked through some of the RegCM3 source code. I did find a 6371229.0 value in the projection section of terrain.f. It doesn't list transverse Mercator as an option, rather it's a rotated (oblique) Mercator. The equations for this and the other projections are definitely sphere-based with no sign that the incoming terrain data (ex. USGS LULC) is being converted from the ellipsoid-based datum to the sphere. 

Melita

Melita


From geronik444 at gmail.com  Mon Jul 26 23:39:33 2010
From: geronik444 at gmail.com (Nikos Gerontidis)
Date: Tue, 27 Jul 2010 09:39:33 +0300
Subject: [Proj] transformation wrong results from ESPG:4326 to ESPG:2100
Message-ID: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>

Hello list

I want to transform coordinates from a projection with ESPG:4326 to
a projection ESPG:2100, but some problems exist. In more details I am trying
to
use the proj4 library so the problem is related with function : *
pj_transform*(..) :

Here are the parameters used for ESPG:2100

*ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600 +x_0=500000
+y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0 +units=m +no_defs
"
ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*

Code is included inside the attached file.

the projection parameters are a copy paste from PostGis.
And another thing, is it possible to use directly the ESPG codes  inside *
pj_transform*("Something like+ESPG:2100","ESPG:4326")

Any ideas? Am I doing something wrong?
Thanks in advance.

-- 
Best Regards
Nikos Gerontidis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/c410df1e/attachment.html>
-------------- next part --------------
char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600", "x_0=500000", "y_0=0", "ellps=GRS80", "towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};

if (!(pj_merc = pj_init(3,params)))
	return;
if (!(pj_latlong = pj_init_plus("+proj=latlong +ellps=WGS84 +datum=WGS84 +no_defs")))
	return;
double x = 0.69241249012994599;
double y = 0.39130891160970277;

qint32 code = pj_transform(pj_latlong, pj_merc, 1, 1, &x, &y, NULL );

// Output coordinates

// x equals to 1744633.9435213772
// y equals to 2545764.3957969979



From ericnico.david at gmail.com  Tue Jul 27 00:18:36 2010
From: ericnico.david at gmail.com (nicolas david)
Date: Tue, 27 Jul 2010 09:18:36 +0200
Subject: [Proj] transformation wrong results from ESPG:4326 to ESPG:2100
In-Reply-To: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
Message-ID: <AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>

Hello

1-) about your code :

char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600",
"x_0=500000", "y_0=0", "ellps=GRS80",
"towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};

if (!(pj_merc = pj_init(3,params)))
	return;

I think that "3" is a wrong argument, in your case it must be "11", the
number of argument that your params variable contains.

2-) to use EPSG code you could use pj_init_plus and the "+init" parameters.

if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;



Nicolas DAVID

2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>

>
> Hello list
>
> I want to transform coordinates from a projection with ESPG:4326 to
> a projection ESPG:2100, but some problems exist. In more details I am
> trying to
> use the proj4 library so the problem is related with function : *
> pj_transform*(..) :
>
> Here are the parameters used for ESPG:2100
>
> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600 +x_0=500000
> +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0 +units=m +no_defs
> "
> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>
> Code is included inside the attached file.
>
> the projection parameters are a copy paste from PostGis.
> And another thing, is it possible to use directly the ESPG codes  inside *
> pj_transform*("Something like+ESPG:2100","ESPG:4326")
>
> Any ideas? Am I doing something wrong?
> Thanks in advance.
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/12e1715b/attachment.html>

From geronik444 at gmail.com  Tue Jul 27 00:37:17 2010
From: geronik444 at gmail.com (Nikos Gerontidis)
Date: Tue, 27 Jul 2010 10:37:17 +0300
Subject: [Proj] Fwd: transformation wrong results from ESPG:4326 to ESPG:2100
In-Reply-To: <AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
Message-ID: <AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>

Thanks for your help

1. You were write about the number of parameters, so I changed the number to
10 and also to 11 and neither one of them worked.
    It seems that the problem is related to the scale factor, namely the
parameter *"k=0.999600". *When I am not including the scale factor in the
parameters list is working
    but of course the output coordinates are wrong.*

*2. Also the use of ESPG codes returns and error:

if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;

Could that be related to a missing header or library?
Thanks again.

---------- Forwarded message ----------
From: nicolas david <ericnico.david at gmail.com>
Date: Tue, Jul 27, 2010 at 10:18 AM
Subject: Re: [Proj] transformation wrong results from ESPG:4326 to ESPG:2100
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>


Hello

1-) about your code :

char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600",
"x_0=500000", "y_0=0", "ellps=GRS80",
"towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};

if (!(pj_merc = pj_init(3,params)))
	return;

I think that "3" is a wrong argument, in your case it must be "11", the
number of argument that your params variable contains.

2-) to use EPSG code you could use pj_init_plus and the "+init" parameters.

if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;



Nicolas DAVID

2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>

>
> Hello list
>
> I want to transform coordinates from a projection with ESPG:4326 to
> a projection ESPG:2100, but some problems exist. In more details I am
> trying to
> use the proj4 library so the problem is related with function : *
> pj_transform*(..) :
>
> Here are the parameters used for ESPG:2100
>
> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600 +x_0=500000
> +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0 +units=m +no_defs
> "
> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>
> Code is included inside the attached file.
>
> the projection parameters are a copy paste from PostGis.
> And another thing, is it possible to use directly the ESPG codes  inside *
> pj_transform*("Something like+ESPG:2100","ESPG:4326")
>
> Any ideas? Am I doing something wrong?
> Thanks in advance.
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



-- 
Best Regards
Nikos Gerontidis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/4abafe99/attachment.html>

From ericnico.david at gmail.com  Tue Jul 27 00:51:40 2010
From: ericnico.david at gmail.com (nicolas david)
Date: Tue, 27 Jul 2010 09:51:40 +0200
Subject: [Proj] Fwd: transformation wrong results from ESPG:4326 to
	ESPG:2100
In-Reply-To: <AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
	<AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
Message-ID: <AANLkTilHQ8Qz_24ZORkxo8u9LNj-omiEnYoImytCNcUd@mail.gmail.com>

    It seems that the problem is related to the scale factor, namely the
> parameter *"k=0.999600". *When I am not including the scale factor in the
> parameters list is working
> *
>
> *

perhaps you could try with "k_0" and not "k"


> **2. Also the use of ESPG codes returns and error:
>
>
> if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;
>
> Could that be related to a missing header or library?
>

you probably don't have the correct settings for  PROJ_LIB environnent
variable. PROJ_LIB must be the directory where the epsg file is located on
our computer. ( on which OS are you trying to compile ? windows / mac /
linux ?)
for debugging purpose you could also set PROJ_DEBUG to a more verbose mode.




> Thanks again.
>
>
> ---------- Forwarded message ----------
> From: nicolas david <ericnico.david at gmail.com>
> Date: Tue, Jul 27, 2010 at 10:18 AM
> Subject: Re: [Proj] transformation wrong results from ESPG:4326 to
> ESPG:2100
> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
>
>
> Hello
>
> 1-) about your code :
>
> char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600", "x_0=500000", "y_0=0", "ellps=GRS80", "towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};
>
>
> if (!(pj_merc = pj_init(3,params)))
> 	return;
>
> I think that "3" is a wrong argument, in your case it must be "11", the
> number of argument that your params variable contains.
>
> 2-) to use EPSG code you could use pj_init_plus and the "+init" parameters.
>
>
> if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;
>
>
>
> Nicolas DAVID
>
> 2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>
>
>>
>> Hello list
>>
>> I want to transform coordinates from a projection with ESPG:4326 to
>> a projection ESPG:2100, but some problems exist. In more details I am
>> trying to
>> use the proj4 library so the problem is related with function : *
>> pj_transform*(..) :
>>
>> Here are the parameters used for ESPG:2100
>>
>> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600
>> +x_0=500000 +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0
>> +units=m +no_defs "
>> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>>
>> Code is included inside the attached file.
>>
>> the projection parameters are a copy paste from PostGis.
>> And another thing, is it possible to use directly the ESPG codes  inside
>> *pj_transform*("Something like+ESPG:2100","ESPG:4326")
>>
>> Any ideas? Am I doing something wrong?
>> Thanks in advance.
>>
>> --
>> Best Regards
>> Nikos Gerontidis
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/67618c7e/attachment.html>

From geronik444 at gmail.com  Tue Jul 27 00:52:27 2010
From: geronik444 at gmail.com (Nikos Gerontidis)
Date: Tue, 27 Jul 2010 10:52:27 +0300
Subject: [Proj] Fwd: transformation wrong results from ESPG:4326 to ESPG:2100
In-Reply-To: <AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
	<AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
Message-ID: <AANLkTikh748_dj_Y2PN8P6V4JXJAm5yV_BJ7HPQJ35ay@mail.gmail.com>

Strange..

I changed the scale factor from *"k=0.9996" to "k=0,9996"* , namely replaced
the dot with a comma value, and it is working.
I guess it could be related with the localization, which in my case is
Greek. The problem is that if there is an issue with the localization
I have to check all the other parameters that use double values..
I ll try to change the localization to US and post again.

---------- Forwarded message ----------
From: Nikos Gerontidis <geronik444 at gmail.com>
Date: Tue, Jul 27, 2010 at 10:37 AM
Subject: Fwd: [Proj] transformation wrong results from ESPG:4326 to
ESPG:2100
To: proj at lists.maptools.org


Thanks for your help

1. You were write about the number of parameters, so I changed the number to
10 and also to 11 and neither one of them worked.
    It seems that the problem is related to the scale factor, namely the
parameter *"k=0.999600". *When I am not including the scale factor in the
parameters list is working
    but of course the output coordinates are wrong.*

*2. Also the use of ESPG codes returns and error:


if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;

Could that be related to a missing header or library?
Thanks again.


---------- Forwarded message ----------
From: nicolas david <ericnico.david at gmail.com>
Date: Tue, Jul 27, 2010 at 10:18 AM
Subject: Re: [Proj] transformation wrong results from ESPG:4326 to ESPG:2100
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>


Hello

1-) about your code :

char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600",
"x_0=500000", "y_0=0", "ellps=GRS80",
"towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};


if (!(pj_merc = pj_init(3,params)))
	return;

I think that "3" is a wrong argument, in your case it must be "11", the
number of argument that your params variable contains.

2-) to use EPSG code you could use pj_init_plus and the "+init" parameters.

if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;



Nicolas DAVID

2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>

>
> Hello list
>
> I want to transform coordinates from a projection with ESPG:4326 to
> a projection ESPG:2100, but some problems exist. In more details I am
> trying to
> use the proj4 library so the problem is related with function : *
> pj_transform*(..) :
>
> Here are the parameters used for ESPG:2100
>
> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600 +x_0=500000
> +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0 +units=m +no_defs
> "
> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>
> Code is included inside the attached file.
>
> the projection parameters are a copy paste from PostGis.
> And another thing, is it possible to use directly the ESPG codes  inside *
> pj_transform*("Something like+ESPG:2100","ESPG:4326")
>
> Any ideas? Am I doing something wrong?
> Thanks in advance.
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



-- 
Best Regards
Nikos Gerontidis



-- 
Best Regards
Nikos Gerontidis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/05659ed0/attachment.html>

From geronik444 at gmail.com  Tue Jul 27 01:05:17 2010
From: geronik444 at gmail.com (Nikos Gerontidis)
Date: Tue, 27 Jul 2010 11:05:17 +0300
Subject: [Proj] Fwd: Fwd: transformation wrong results from ESPG:4326 to
	ESPG:2100
In-Reply-To: <AANLkTilHQ8Qz_24ZORkxo8u9LNj-omiEnYoImytCNcUd@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
	<AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
	<AANLkTilHQ8Qz_24ZORkxo8u9LNj-omiEnYoImytCNcUd@mail.gmail.com>
Message-ID: <AANLkTinpzFRV2reFEFaF9m+JPJ-GMp6-rtPpwO8HDiYY@mail.gmail.com>

I changed the localization and a solution is found, but is it possible that
proj4 could have an issue with the localization?
To be more specific a double number for Greek locale uses comma values to
separate the decimal value while others use the dot e.g.
Greek : 0,1
Us      : 0.1


About the environment variables I am using Gnu Mandriva Linux 32bit
distribution, so I ll try to add the variable to the PATH.

---------- Forwarded message ----------
From: nicolas david <ericnico.david at gmail.com>
Date: Tue, Jul 27, 2010 at 10:51 AM
Subject: Re: [Proj] Fwd: transformation wrong results from ESPG:4326 to
ESPG:2100
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>




    It seems that the problem is related to the scale factor, namely the
> parameter *"k=0.999600". *When I am not including the scale factor in the
> parameters list is working
> *
>
> *

perhaps you could try with "k_0" and not "k"


> **2. Also the use of ESPG codes returns and error:
>
>
> if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;
>
> Could that be related to a missing header or library?
>

you probably don't have the correct settings for  PROJ_LIB environnent
variable. PROJ_LIB must be the directory where the epsg file is located on
our computer. ( on which OS are you trying to compile ? windows / mac /
linux ?)
for debugging purpose you could also set PROJ_DEBUG to a more verbose mode.




> Thanks again.
>
>
> ---------- Forwarded message ----------
> From: nicolas david <ericnico.david at gmail.com>
> Date: Tue, Jul 27, 2010 at 10:18 AM
> Subject: Re: [Proj] transformation wrong results from ESPG:4326 to
> ESPG:2100
> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
>
>
> Hello
>
> 1-) about your code :
>
> char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600", "x_0=500000", "y_0=0", "ellps=GRS80", "towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};
>
>
>
> if (!(pj_merc = pj_init(3,params)))
> 	return;
>
> I think that "3" is a wrong argument, in your case it must be "11", the
> number of argument that your params variable contains.
>
> 2-) to use EPSG code you could use pj_init_plus and the "+init" parameters.
>
>
> if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;
>
>
>
> Nicolas DAVID
>
> 2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>
>
>>
>> Hello list
>>
>> I want to transform coordinates from a projection with ESPG:4326 to
>> a projection ESPG:2100, but some problems exist. In more details I am
>> trying to
>> use the proj4 library so the problem is related with function : *
>> pj_transform*(..) :
>>
>> Here are the parameters used for ESPG:2100
>>
>> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600
>> +x_0=500000 +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0
>> +units=m +no_defs "
>> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>>
>> Code is included inside the attached file.
>>
>> the projection parameters are a copy paste from PostGis.
>> And another thing, is it possible to use directly the ESPG codes  inside
>> *pj_transform*("Something like+ESPG:2100","ESPG:4326")
>>
>> Any ideas? Am I doing something wrong?
>> Thanks in advance.
>>
>> --
>> Best Regards
>> Nikos Gerontidis
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



-- 
Best Regards
Nikos Gerontidis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/968a402c/attachment.html>

From ericnico.david at gmail.com  Tue Jul 27 01:27:05 2010
From: ericnico.david at gmail.com (nicolas david)
Date: Tue, 27 Jul 2010 10:27:05 +0200
Subject: [Proj] Fwd: Fwd: transformation wrong results from ESPG:4326 to
	ESPG:2100
In-Reply-To: <AANLkTinpzFRV2reFEFaF9m+JPJ-GMp6-rtPpwO8HDiYY@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
	<AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
	<AANLkTilHQ8Qz_24ZORkxo8u9LNj-omiEnYoImytCNcUd@mail.gmail.com>
	<AANLkTinpzFRV2reFEFaF9m+JPJ-GMp6-rtPpwO8HDiYY@mail.gmail.com>
Message-ID: <AANLkTinqZADxC7ncCM9yCabY3EqnXHdv543Gjawc1PzB@mail.gmail.com>

2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>

> I changed the localization and a solution is found, but is it possible that
> proj4 could have an issue with the localization?
>

yes, it's on the documentation :
http://trac.osgeo.org/proj/wiki/FAQ#DoesPROJ.4workindifferentinternationalnumericlocales

To be more specific a double number for Greek locale uses comma values to
> separate the decimal value while others use the dot e.g.
> Greek : 0,1
> Us      : 0.1
>
>
> same in french, we use comma


> About the environment variables I am using Gnu Mandriva Linux 32bit
> distribution, so I ll try to add the variable to the PATH.
>

just before launching your programm on the command line try :

export LC_NUMERIC=C # for local setting
export PROJ_LIB="your/path/to/proj4/nad/files"
export PROJ_DEBUG=1


>
> ---------- Forwarded message ----------
> From: nicolas david <ericnico.david at gmail.com>
> Date: Tue, Jul 27, 2010 at 10:51 AM
> Subject: Re: [Proj] Fwd: transformation wrong results from ESPG:4326 to
> ESPG:2100
> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
>
>
>
>
>     It seems that the problem is related to the scale factor, namely the
>> parameter *"k=0.999600". *When I am not including the scale factor in the
>> parameters list is working
>> *
>>
>> *
>
> perhaps you could try with "k_0" and not "k"
>
>
>> **2. Also the use of ESPG codes returns and error:
>>
>>
>> if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;
>>
>> Could that be related to a missing header or library?
>>
>
> you probably don't have the correct settings for  PROJ_LIB environnent
> variable. PROJ_LIB must be the directory where the epsg file is located on
> our computer. ( on which OS are you trying to compile ? windows / mac /
> linux ?)
> for debugging purpose you could also set PROJ_DEBUG to a more verbose mode.
>
>
>
>
>> Thanks again.
>>
>>
>> ---------- Forwarded message ----------
>> From: nicolas david <ericnico.david at gmail.com>
>> Date: Tue, Jul 27, 2010 at 10:18 AM
>> Subject: Re: [Proj] transformation wrong results from ESPG:4326 to
>> ESPG:2100
>> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org
>> >
>>
>>
>> Hello
>>
>> 1-) about your code :
>>
>> char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600", "x_0=500000", "y_0=0", "ellps=GRS80", "towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};
>>
>>
>>
>>
>> if (!(pj_merc = pj_init(3,params)))
>> 	return;
>>
>> I think that "3" is a wrong argument, in your case it must be "11", the
>> number of argument that your params variable contains.
>>
>> 2-) to use EPSG code you could use pj_init_plus and the "+init"
>> parameters.
>>
>> if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;
>>
>>
>>
>> Nicolas DAVID
>>
>> 2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>
>>
>>>
>>> Hello list
>>>
>>> I want to transform coordinates from a projection with ESPG:4326 to
>>> a projection ESPG:2100, but some problems exist. In more details I am
>>> trying to
>>> use the proj4 library so the problem is related with function : *
>>> pj_transform*(..) :
>>>
>>> Here are the parameters used for ESPG:2100
>>>
>>> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600
>>> +x_0=500000 +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0
>>> +units=m +no_defs "
>>> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>>>
>>> Code is included inside the attached file.
>>>
>>> the projection parameters are a copy paste from PostGis.
>>> And another thing, is it possible to use directly the ESPG codes  inside
>>> *pj_transform*("Something like+ESPG:2100","ESPG:4326")
>>>
>>> Any ideas? Am I doing something wrong?
>>> Thanks in advance.
>>>
>>> --
>>> Best Regards
>>> Nikos Gerontidis
>>>
>>> _______________________________________________
>>> Proj mailing list
>>> Proj at lists.maptools.org
>>> http://lists.maptools.org/mailman/listinfo/proj
>>>
>>
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>>
>>
>> --
>> Best Regards
>> Nikos Gerontidis
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/8fa60219/attachment.html>

From geronik444 at gmail.com  Tue Jul 27 01:34:17 2010
From: geronik444 at gmail.com (Nikos Gerontidis)
Date: Tue, 27 Jul 2010 11:34:17 +0300
Subject: [Proj] Fwd: Fwd: Fwd: transformation wrong results from ESPG:4326
	to ESPG:2100
In-Reply-To: <AANLkTinqZADxC7ncCM9yCabY3EqnXHdv543Gjawc1PzB@mail.gmail.com>
References: <AANLkTik6qf-tPdwaow=5TeO0dwG8qKy01nz6_3tZvu-2@mail.gmail.com>
	<AANLkTikvyvSuQQPUYwVhXqdR90f9Zp84bIAQv-WnXg2t@mail.gmail.com>
	<AANLkTinhyJFpT2Yg4USd=O9kt7OTB8euX7Dh_j60QfLg@mail.gmail.com>
	<AANLkTilHQ8Qz_24ZORkxo8u9LNj-omiEnYoImytCNcUd@mail.gmail.com>
	<AANLkTinpzFRV2reFEFaF9m+JPJ-GMp6-rtPpwO8HDiYY@mail.gmail.com>
	<AANLkTinqZADxC7ncCM9yCabY3EqnXHdv543Gjawc1PzB@mail.gmail.com>
Message-ID: <AANLkTinwaOn9jZOn5G+UJL7s3d-mqzgd68SKsxA8p9cw@mail.gmail.com>

Ops, thanks Nicolas, rtfm could also be included in your answer. I should
have red better the manual.


---------- Forwarded message ----------
From: nicolas david <ericnico.david at gmail.com>
Date: Tue, Jul 27, 2010 at 11:27 AM
Subject: Re: [Proj] Fwd: Fwd: transformation wrong results from ESPG:4326 to
ESPG:2100
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>




2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>

> I changed the localization and a solution is found, but is it possible that
> proj4 could have an issue with the localization?
>

yes, it's on the documentation :
http://trac.osgeo.org/proj/wiki/FAQ#DoesPROJ.4workindifferentinternationalnumericlocales

To be more specific a double number for Greek locale uses comma values to
> separate the decimal value while others use the dot e.g.
> Greek : 0,1
> Us      : 0.1
>
>
> same in french, we use comma


> About the environment variables I am using Gnu Mandriva Linux 32bit
> distribution, so I ll try to add the variable to the PATH.
>

just before launching your programm on the command line try :

export LC_NUMERIC=C # for local setting
export PROJ_LIB="your/path/to/proj4/nad/files"
export PROJ_DEBUG=1


>
> ---------- Forwarded message ----------
> From: nicolas david <ericnico.david at gmail.com>
> Date: Tue, Jul 27, 2010 at 10:51 AM
> Subject: Re: [Proj] Fwd: transformation wrong results from ESPG:4326 to
> ESPG:2100
> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
>
>
>
>
>     It seems that the problem is related to the scale factor, namely the
>> parameter *"k=0.999600". *When I am not including the scale factor in the
>> parameters list is working
>> *
>>
>> *
>
> perhaps you could try with "k_0" and not "k"
>
>
>> **2. Also the use of ESPG codes returns and error:
>>
>>
>> if (! (pj_merc = pj_init_plus("+init=EPSG:*2100*") ) ) return ;
>>
>> Could that be related to a missing header or library?
>>
>
> you probably don't have the correct settings for  PROJ_LIB environnent
> variable. PROJ_LIB must be the directory where the epsg file is located on
> our computer. ( on which OS are you trying to compile ? windows / mac /
> linux ?)
> for debugging purpose you could also set PROJ_DEBUG to a more verbose mode.
>
>
>
>
>> Thanks again.
>>
>>
>> ---------- Forwarded message ----------
>> From: nicolas david <ericnico.david at gmail.com>
>> Date: Tue, Jul 27, 2010 at 10:18 AM
>> Subject: Re: [Proj] transformation wrong results from ESPG:4326 to
>> ESPG:2100
>> To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org
>> >
>>
>>
>> Hello
>>
>> 1-) about your code :
>>
>> char *params[] = { "proj=merc", "lat_0=0", "lon_0=24", "k=0.999600", "x_0=500000", "y_0=0", "ellps=GRS80", "towgs84=-199.87,74.79,246.62,0,0,0,0", "units=m", "no_defs"};
>>
>>
>>
>>
>>
>> if (!(pj_merc = pj_init(3,params)))
>> 	return;
>>
>> I think that "3" is a wrong argument, in your case it must be "11", the
>> number of argument that your params variable contains.
>>
>> 2-) to use EPSG code you could use pj_init_plus and the "+init"
>> parameters.
>>
>> if (! (pj_merc = pj_init_plus("+init=EPSG:2100") ) ) return ;
>>
>>
>>
>> Nicolas DAVID
>>
>> 2010/7/27 Nikos Gerontidis <geronik444 at gmail.com>
>>
>>>
>>> Hello list
>>>
>>> I want to transform coordinates from a projection with ESPG:4326 to
>>> a projection ESPG:2100, but some problems exist. In more details I am
>>> trying to
>>> use the proj4 library so the problem is related with function : *
>>> pj_transform*(..) :
>>>
>>> Here are the parameters used for ESPG:2100
>>>
>>> *ESPG: 2100----->  "+proj=tmerc +lat_0=0 +lon_0=24 +k=0.999600
>>> +x_0=500000 +y_0=0 +ellps=GRS80 +towgs84=-199.87,74.79,246.62,0,0,0,0
>>> +units=m +no_defs "
>>> ESPG:4326------> "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs "*
>>>
>>> Code is included inside the attached file.
>>>
>>> the projection parameters are a copy paste from PostGis.
>>> And another thing, is it possible to use directly the ESPG codes  inside
>>> *pj_transform*("Something like+ESPG:2100","ESPG:4326")
>>>
>>> Any ideas? Am I doing something wrong?
>>> Thanks in advance.
>>>
>>> --
>>> Best Regards
>>> Nikos Gerontidis
>>>
>>> _______________________________________________
>>> Proj mailing list
>>> Proj at lists.maptools.org
>>> http://lists.maptools.org/mailman/listinfo/proj
>>>
>>
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>>
>>
>> --
>> Best Regards
>> Nikos Gerontidis
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> --
> Best Regards
> Nikos Gerontidis
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



-- 
Best Regards
Nikos Gerontidis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100727/76ad37b6/attachment.html>

From hamish_b at yahoo.com  Tue Jul 27 02:17:42 2010
From: hamish_b at yahoo.com (Hamish)
Date: Tue, 27 Jul 2010 02:17:42 -0700 (PDT)
Subject: [Proj] Fwd: transformation wrong results from ESPG:4326 to
	ESPG:2100
Message-ID: <194825.20368.qm@web110015.mail.gq1.yahoo.com>

Nikos Gerontidis wrote:
> I changed the scale factor from "k=0.9996" to "k=0,9996" , namely
> replaced the dot with a comma value, and it is working.
> I guess it could be related with the localization, which in my case is
> Greek. The problem is that if there is an issue with the localization
>
> I have to check all the other parameters that use double values..
> I ll try to change the localization to US and post again.

try adding

#include <locale.h>
setlocale(LC_ALL, "");
setlocale(LC_NUMERIC, "C");


Hamish


      


From haileyeckstrand at gmail.com  Tue Jul 27 13:39:04 2010
From: haileyeckstrand at gmail.com (Hailey Eckstrand)
Date: Tue, 27 Jul 2010 20:39:04 +0000 (UTC)
Subject: [Proj] proj4 definition for transverse mercator projection from
	RegCM3 model for North America
References: <27671997.1280104122461.JavaMail.root@elwamui-darkeyed.atl.sa.earthlink.net>
Message-ID: <loom.20100727T222513-636@post.gmane.org>


> >
> >Hello,
> >
> >> The sphere ellipsoid is a guess as they didn't provide the geographic
coordinate system
> >
> >check your parameters, especially if the assumption about the sphere is
correct and if the
> >sphere is of a right size? Test with the normal NAD83, NAD27, WGS84 datums
with their
> >correct ellipsoids Clarke 1866,  GRS 80 and WGS84 etx.
> >
> >http://en.wikipedia.org/wiki/North_American_Datum
> >
> >http://en.wikipedia.org/wiki/World_Geodetic_System
> >
> >Janne.
> 
> I just looked through some of the RegCM3 source code. I did find a 6371229.0
value in the projection section
> of terrain.f. It doesn't list transverse Mercator as an option, rather it's a
rotated (oblique)
> Mercator. The equations for this and the other projections are definitely
sphere-based with no sign that
> the incoming terrain data (ex. USGS LULC) is being converted from the
ellipsoid-based datum to the
> sphere. 
> 
> Melita
> 
> Melita
> _______________________________________________
> Proj mailing list
> Proj <at> lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 
> 

I also saw that it doesn't list transverse Mercator as an option. If they used
the rotated (oblique) Mercator option, and entered in 90 degrees as the rotation
parameter, would that be the equivalent of a transverse Mercator projection?  If
it was a rotated Mercator projection.. which proj4 projection do you think it
would be if it wasn't transverse mercator?
Hotine Oblique Mercator?
Laborde Oblique Mercator?
Oblique Mercator?
Swiss Oblique Mercator?
Rosenmund Oblique Mercator?


Also, I tried the proj4 string with the sphere radius defined:
proj -f "%f" +proj=tmerc +lat_0=47.5 +y_0=3175000.0 +x_0=3925000.0 +lon_0=-97.0
+k_0=1.0 +units=m +r=6371229.0 << EOF
-126.0869 19.61229
-125.6792 19.77242
-125.2703 19.93048
EOF
767826.309246   368215.750221
818695.246887   379008.554862
869407.646780   389577.252864

the output is supposed to be:
600000 600000
650000 600000
700000 600000

If I am understanding this correctly, I don't think that I have the correct or a
complete description of the parameters. Does that sound accurate?




From Joel_Cusick at nps.gov  Wed Jul 28 14:48:02 2010
From: Joel_Cusick at nps.gov (Joel_Cusick at nps.gov)
Date: Wed, 28 Jul 2010 13:48:02 -0800
Subject: [Proj] ESRIs new coordinate systems and transforms - Is Proj4
 library linked somehow?
Message-ID: <OF5D81BD6F.2E29DF1D-ON8925776E.00769E6A-8925776E.0077C145@nps.gov>


Hello List,
Melita Kennedy (Projection Lead for ESRI ArcGIS software) informs me that
ArcGIS 10 (released this month) will have new CORS96-based coordinate
systems and transformations.  Prior to this addition, it was not possible
to assign CORS96 to "NAD83" based coordinate systems (like UTM) unless you
defined a new prj yourself.  This effects those users that were using
high-end submeter mapping grade and survey grade systems and holding NGS
CORS station NAD83 (CORS96) EPOCH 2002/2003 in postprocessing environments.
Not to repeat Melita's text, i have included her thread below.

My question to this esteemed group expresses my ignorance on how new
projections get defined....

Is your proj4 library linked somehow to these new codes that ESRI has
determined?
If not, is it up to some panel to insert these codes?

thank you for your time. First time submitter, long time listener.


Melita wrote:

We have added a CORS96 datum and gcs. The full gcs name is
"GCS_NAD_1983_CORS96". I'll use "CORS96","HARN", and "NSRS2007" as short
forms of the names! We also added 4 transformations for CORS96:

108148: CORS96 to HARN (zeroes for parameters)
108149: CORS96 to NSRS2007 (zeroes for parameters)
108150: ITRF00 to CORS96 (dx = 0.9956)
108151: WGS84 to CORS96 (dx = 0.9956)

For projected Coordinates systems (pcs), we've added CORS96-based ones for

Alaska Albers
UTM Zones 59N,60N,1N - 19N
SPCS Alaska 1-10 (meters)

******************************************************
Joel Cusick
National Park Service/Alaska Regional Office
240 West. 5th Avenue, Anchorage, AK - 99501
(907) 644-3549  joel_cusick at nps.gov
+61°13.0213', -149°53.1763', (NAD83 CORS96)
6VUN4499490383 USNG
******************************************************



From hamish_b at yahoo.com  Wed Jul 28 21:40:24 2010
From: hamish_b at yahoo.com (Hamish)
Date: Thu, 29 Jul 2010 16:40:24 +1200
Subject: [Proj] quoting +nadgrids ?
Message-ID: <20100729164024.14be3687.hamish_b@yahoo.com>

Hi,

we've run into a problem whereas the nad/conus grid file has been
installed under C:\Program Files\ (which contains a space), and the
pj_get_def(pjinfo.pj, 0) string doesn't quote the filename of the
+nadgrids=/full/path/and/filename parameter. So when this string is
passed as a CRS to cs2cs it only reads as far as the "C:\Program" part
for the grid file and all goes downhill fast from there.


any recommendations on how to handle this? i.e. should the "quotes" be
added by pj_get_def(), or via some ugly string munging in our app? (which
currently fprints those terms verbatim to stdout)


thanks,
Hamish


From gdt at ir.bbn.com  Thu Jul 29 05:29:13 2010
From: gdt at ir.bbn.com (Greg Troxel)
Date: Thu, 29 Jul 2010 08:29:13 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <20100729164024.14be3687.hamish_b@yahoo.com> (Hamish's message of
	"Thu, 29 Jul 2010 16:40:24 +1200")
References: <20100729164024.14be3687.hamish_b@yahoo.com>
Message-ID: <rmiy6cucvza.fsf@fnord.ir.bbn.com>


Hamish <hamish_b at yahoo.com> writes:

> Hi,
>
> we've run into a problem whereas the nad/conus grid file has been
> installed under C:\Program Files\ (which contains a space), and the
> pj_get_def(pjinfo.pj, 0) string doesn't quote the filename of the
> +nadgrids=/full/path/and/filename parameter. So when this string is
> passed as a CRS to cs2cs it only reads as far as the "C:\Program" part
> for the grid file and all goes downhill fast from there.
>
> any recommendations on how to handle this? i.e. should the "quotes" be
> added by pj_get_def(), or via some ugly string munging in our app? (which
> currently fprints those terms verbatim to stdout)

Perhaps the installation should just error out on paths with spaces.

Are you having trouble with shell quoting or with argument parsing?  If
you put quotes around the whole def string, does it work?  Are you
printing a command line and then invoking it with a shell?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100729/bcc411b9/attachment.sig>

From hamish_b at yahoo.com  Thu Jul 29 18:46:46 2010
From: hamish_b at yahoo.com (Hamish)
Date: Thu, 29 Jul 2010 18:46:46 -0700 (PDT)
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <rmiy6cucvza.fsf@fnord.ir.bbn.com>
Message-ID: <827486.53924.qm@web110005.mail.gq1.yahoo.com>

Hamish:
> > we've run into a problem whereas the nad/conus grid file has
> > been installed under C:\Program Files\ (which contains a
> > space), and the pj_get_def(pjinfo.pj, 0) string doesn't
> > quote the filename of the +nadgrids=/full/path/and/filename
> > parameter. So when this string is passed as a CRS to cs2cs
> > it only reads as far as the "C:\Program" part for the grid
> > file and all goes downhill fast from there.

Greg wrote:
> Perhaps the installation should just error out on paths
> with spaces.

that's no good for a few reasons:
1) it's not friendly to the user / not a good look. 2) some
users are stuck with a locked down system with no ability to
install to the C:\ of their choosing. and 3) that would be
admitting defeat :-)

> Are you having trouble with shell quoting or with argument
> parsing?

with some shell script magic from Glynn and a small bugfix from
Paul we've now got it sussed I think as far as cs2cs goes.
(trade spaces with '+'s after them for newlines, 'single quote'
all +proj terms, reassemble into a single line)

> If you put quotes around the whole def string, does it work?

yes for gdalwarp, no for cs2cs. so 'single quoting' all +proj
terms and sending them as individual argv's works for cs2cs,
but I don't see a solution for `gdalwarp -t_srs` which takes
all +proj terms within a single "quoted list".

that quoted list does not like individual terms quoted within
it. e.g. this fails with a proj term parsing error:

gdalwarp -t_srs "'+proj=longlat' '+datum=nad83' '+nadgrids=c:\Program Files\GRASS\etc\nad\conus'" input.tif output.tif

so no way to quote the +nadgrids pathname for gdalwarp AFAICT.


thanks,
Hamish



      


From jbinpg at shaw.ca  Thu Jul 29 21:23:11 2010
From: jbinpg at shaw.ca (Jack Bowling)
Date: Thu, 29 Jul 2010 21:23:11 -0700
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
Message-ID: <1280463791.6228.4.camel@lucky.ca.shawcable.net>

On Thu, 2010-07-29 at 18:46 -0700, Hamish wrote:
> Hamish:
> > > we've run into a problem whereas the nad/conus grid file has
> > > been installed under C:\Program Files\ (which contains a
> > > space), and the pj_get_def(pjinfo.pj, 0) string doesn't
> > > quote the filename of the +nadgrids=/full/path/and/filename
> > > parameter. So when this string is passed as a CRS to cs2cs
> > > it only reads as far as the "C:\Program" part for the grid
> > > file and all goes downhill fast from there.
> 
> Greg wrote:
> > Perhaps the installation should just error out on paths
> > with spaces.
> 
> that's no good for a few reasons:
> 1) it's not friendly to the user / not a good look. 2) some
> users are stuck with a locked down system with no ability to
> install to the C:\ of their choosing. and 3) that would be
> admitting defeat :-)
> 
> > Are you having trouble with shell quoting or with argument
> > parsing?
> 
> with some shell script magic from Glynn and a small bugfix from
> Paul we've now got it sussed I think as far as cs2cs goes.
> (trade spaces with '+'s after them for newlines, 'single quote'
> all +proj terms, reassemble into a single line)
> 
> > If you put quotes around the whole def string, does it work?
> 
> yes for gdalwarp, no for cs2cs. so 'single quoting' all +proj
> terms and sending them as individual argv's works for cs2cs,
> but I don't see a solution for `gdalwarp -t_srs` which takes
> all +proj terms within a single "quoted list".
> 
> that quoted list does not like individual terms quoted within
> it. e.g. this fails with a proj term parsing error:
> 
> gdalwarp -t_srs "'+proj=longlat' '+datum=nad83' '+nadgrids=c:\Program Files\GRASS\etc\nad\conus'" input.tif output.tif
> 
> so no way to quote the +nadgrids pathname for gdalwarp AFAICT.

Maybe it is time to admit Windows inadequacies and install a unix
emulator. I would suggest the lightweight GOW rather than something like
Cygwin:

http://wiki.github.com/bmatzelle/gow/

Bash and many other useful apps are in there.

Jack



From gdt at ir.bbn.com  Fri Jul 30 04:51:33 2010
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 30 Jul 2010 07:51:33 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <827486.53924.qm@web110005.mail.gq1.yahoo.com> (Hamish's message
	of "Thu, 29 Jul 2010 18:46:46 -0700 (PDT)")
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
Message-ID: <rmik4odkx16.fsf@fnord.ir.bbn.com>


  > If you put quotes around the whole def string, does it work?

  yes for gdalwarp, no for cs2cs. so 'single quoting' all +proj
  terms and sending them as individual argv's works for cs2cs,

I wonder why it's necessary to quote if you place things in a single
argument, unless cs2cs tries to split arguments on spaces.

  but I don't see a solution for `gdalwarp -t_srs` which takes
  all +proj terms within a single "quoted list".

  that quoted list does not like individual terms quoted within
  it. e.g. this fails with a proj term parsing error:

  gdalwarp -t_srs "'+proj=longlat' '+datum=nad83' '+nadgrids=c:\Program Files\GRASS\etc\nad\conus'" input.tif output.tif

  so no way to quote the +nadgrids pathname for gdalwarp AFAICT.

I don't think this is fixable, absent teaching gdalwarp about quoting.
Using spaces to separate arguments and using spaces in file names are
just incompatible practices.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20100730/9a6beba7/attachment.sig>

From warmerdam at pobox.com  Fri Jul 30 07:24:28 2010
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 30 Jul 2010 10:24:28 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
Message-ID: <4C52E09C.3050904@pobox.com>

Hamish,

My understanding is that this thread is really about weaknesses in the
DOS cmd.exe shell interpreter, right?  I think it would be counter productive
to add escaping rules within the proj.4 definition parser just to make up for
challenges in passing arguments with spaces under cmd.exe.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From hamish_b at yahoo.com  Fri Jul 30 16:02:17 2010
From: hamish_b at yahoo.com (Hamish)
Date: Fri, 30 Jul 2010 16:02:17 -0700 (PDT)
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <4C52E09C.3050904@pobox.com>
Message-ID: <69986.98242.qm@web110006.mail.gq1.yahoo.com>

Frank wrote:
> My understanding is that this thread is really about
> weaknesses in the DOS cmd.exe shell interpreter, right?

nope. (although it could be uglier there as AFAIK cmd.exe does
not like 'single quotes', only "double" ones, which limits your
ability to nest quotes a bit).

fwiw I'm running this in an MSys/MinGW bash shell in their rxvt
window. (native GRASS w/ Msys terminal) I haven't tried it from
cmd.exe.

> I think it would be counter productive to add escaping rules
> within the proj.4 definition parser just to make up for
> challenges in passing arguments with spaces under cmd.exe.

The challenge has evolved into getting gdalwarp to accept a
-t_srs +nadgrids term which has a space (or any special char)
in the path or file name of the grid file, on any OS. (it just
jumps out immediately on Windows because of 'C:\Program Files\')

the nuts and bolts and why we aren't using pj_set_finder() is
better explained in this post:
 http://lists.osgeo.org/pipermail/grass-dev/2010-July/051394.html


regards,
Hamish



      


From hamish_b at yahoo.com  Fri Jul 30 16:21:56 2010
From: hamish_b at yahoo.com (Hamish)
Date: Fri, 30 Jul 2010 16:21:56 -0700 (PDT)
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <rmik4odkx16.fsf@fnord.ir.bbn.com>
Message-ID: <853822.15338.qm@web110011.mail.gq1.yahoo.com>

Greg wrote:
> I wonder why it's necessary to quote if you place things in
> a single argument, unless cs2cs tries to split arguments on
> spaces.

it's not, but it's easier (and harmless) to just quote all terms
instead of searching for ones with special chars in them and
just quoting those.

> >  so no way to quote the +nadgrids pathname for gdalwarp
> > AFAICT.
> 
> I don't think this is fixable, absent teaching gdalwarp
> about quoting.
> Using spaces to separate arguments and using spaces in file
> names are just incompatible practices.

I had come to the same conclusions, planned to do a bit more
testing on different platforms, and review the gdalwarp code
before filing it as gdal bug though.


regards,
Hamish



      


From warmerdam at pobox.com  Fri Jul 30 16:31:07 2010
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 30 Jul 2010 19:31:07 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <853822.15338.qm@web110011.mail.gq1.yahoo.com>
References: <853822.15338.qm@web110011.mail.gq1.yahoo.com>
Message-ID: <4C5360BB.2050400@pobox.com>

Hamish wrote:
> Greg wrote:
>> I wonder why it's necessary to quote if you place things in
>> a single argument, unless cs2cs tries to split arguments on
>> spaces.
> 
> it's not, but it's easier (and harmless) to just quote all terms
> instead of searching for ones with special chars in them and
> just quoting those.
> 
>>>   so no way to quote the +nadgrids pathname for gdalwarp
>>> AFAICT.
>> I don't think this is fixable, absent teaching gdalwarp
>> about quoting.
>> Using spaces to separate arguments and using spaces in file
>> names are just incompatible practices.
> 
> I had come to the same conclusions, planned to do a bit more
> testing on different platforms, and review the gdalwarp code
> before filing it as gdal bug though.

Hamish,

I concur that it is likely not possible to pass proj.4 arguments
with spaces in them to GDAL tools.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From glynn at gclements.plus.com  Sat Jul 31 05:40:32 2010
From: glynn at gclements.plus.com (Glynn Clements)
Date: Sat, 31 Jul 2010 13:40:32 +0100
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <4C52E09C.3050904@pobox.com>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
	<4C52E09C.3050904@pobox.com>
Message-ID: <19540.6592.798019.240944@cerise.gclements.plus.com>


Frank Warmerdam wrote:

> My understanding is that this thread is really about weaknesses in the
> DOS cmd.exe shell interpreter, right?

No.

The problem is that gdalwarp's -t_srs option expects a proj argument
*list* as a single string, which it then splits into individual proj
arguments using spaces as a seperator. That is problematic because
some of those arguments may be filenames, which can contain spaces
(particularly on Windows, where it's often impossible to create a file
without spaces in its pathname unless you have Administrator
privilege).

It may be possible to workaround this by using the 8.3 filename, i.e. 
"c:\progra~1\..." instead of "C:\Program Files". However, that fails
if the filename is being chosen via a GUI file selection dialog, which
will only offer the full name for a directory. Also, it's possible to
inhibit the creation of 8.3 filenames, and some security software
flags use of 8.3 filenames as suspicious behaviour (it's a common
tactic for bypassing filename-based access controls).

As far as actual solutions go:

One option is to provide a switch, e.g. -srs_sep, to allow a custom
separator to be specified, e.g.:

gdalwarp -srs_sep "|" -t_srs "+proj=longlat|+datum=nad83|+nadgrids=c:\Program Files\GRASS\etc\nad\conus"

Another option is to implement shell-style quoting and/or escaping
rules, similar to Python's shlex.split() function.

Yet another option is to provide alternative options which accept one
argument at a time, bypassing the splitting step altogether, e.g.:

gdalwarp -t_srs1 +proj=longlat -t_srs1 +datum=nad83 -t_srs1 "+nadgrids=c:\Program Files\GRASS\etc\nad\conus"

-- 
Glynn Clements <glynn at gclements.plus.com>


From warmerdam at pobox.com  Sat Jul 31 06:22:05 2010
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat, 31 Jul 2010 09:22:05 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <19540.6592.798019.240944@cerise.gclements.plus.com>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
	<4C52E09C.3050904@pobox.com>
	<19540.6592.798019.240944@cerise.gclements.plus.com>
Message-ID: <4C54237D.3010109@pobox.com>

Glynn Clements wrote:
> Frank Warmerdam wrote:
> 
>> My understanding is that this thread is really about weaknesses in the
>> DOS cmd.exe shell interpreter, right?
> 
> No.
> 
> The problem is that gdalwarp's -t_srs option expects a proj argument
> *list* as a single string, which it then splits into individual proj
> arguments using spaces as a seperator. That is problematic because
> some of those arguments may be filenames, which can contain spaces
> (particularly on Windows, where it's often impossible to create a file
> without spaces in its pathname unless you have Administrator
> privilege).

Glynn,

OK, I get the issue with the GDAL / PROJ.4 option.  I suppose I
am more concerned here (on the proj list) about the PROJ.4 library
and utilities itself.

> It may be possible to workaround this by using the 8.3 filename, i.e. 
> "c:\progra~1\..." instead of "C:\Program Files". However, that fails
> if the filename is being chosen via a GUI file selection dialog, which
> will only offer the full name for a directory. Also, it's possible to
> inhibit the creation of 8.3 filenames, and some security software
> flags use of 8.3 filenames as suspicious behaviour (it's a common
> tactic for bypassing filename-based access controls).
> 
> As far as actual solutions go:
> 
> One option is to provide a switch, e.g. -srs_sep, to allow a custom
> separator to be specified, e.g.:
> 
> gdalwarp -srs_sep "|" -t_srs "+proj=longlat|+datum=nad83|+nadgrids=c:\Program Files\GRASS\etc\nad\conus"

I would note that GDAL is going to throw away the +nadgrids
directive anyways.  GDAL converts things into WKT internally
and then later back to proj.4 format.  WKT does not support
declaration of grid shift files.

It is possible to add a +wkt_ext directive which tells GDAL
to embed the whole proj.4 definition literally in the WKT.
But when parsing the WKT the same issue with spaces in a
parameter will be encountered.

Based on this, I'm starting to think that the PROJ.4
parameter parser just ought to have a special escape
sequence for embedding a space.  Ideally something not
likely to "activate" other escape sequence parsers.
Something like:

+nadgrids=C:\Program@@@space@@@Files\GRASS...

If you would like me to incorporate such a change, let me know
via a proj.4 ticket and I'll proceed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From ckarney at Sarnoff.com  Sat Jul 31 06:45:57 2010
From: ckarney at Sarnoff.com (Karney, Charles)
Date: Sat, 31 Jul 2010 09:45:57 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <4C54237D.3010109@pobox.com>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
	<4C52E09C.3050904@pobox.com>
	<19540.6592.798019.240944@cerise.gclements.plus.com>,
	<4C54237D.3010109@pobox.com>
Message-ID: <CED6B4B383C5F0418DAFEA443A0033C2F90E2795D3@MALIBU.sarnoff.internal>

>From: Frank Warmerdam [warmerdam at pobox.com]
> Sent: Saturday, July 31, 2010 09:22

> Based on this, I'm starting to think that the PROJ.4
> parameter parser just ought to have a special escape
> sequence for embedding a space.  Ideally something not
> likely to "activate" other escape sequence parsers.
> Something like:
> 
> +nadgrids=C:\Program@@@space@@@Files\GRASS...
> 
> If you would like me to incorporate such a change, let me know
> via a proj.4 ticket and I'll proceed.

Here's a counter-proposal that might address the issues in a
sufficiently general way:

  gdalwarp -t_srs "@file.txt"

with the understanding that an initial @ in an argument implies
indirection.  file.txt is opened, and the real argument is the result of
the first getline.

    --Charles

--
Charles Karney <ckarney at sarnoff.com>
Sarnoff Corporation, Princeton, NJ 08543-5300

Tel: +1 609 734 2312
Fax: +1 609 734 2662


From warmerdam at pobox.com  Sat Jul 31 07:06:00 2010
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat, 31 Jul 2010 10:06:00 -0400
Subject: [Proj] quoting +nadgrids ?
In-Reply-To: <CED6B4B383C5F0418DAFEA443A0033C2F90E2795D3@MALIBU.sarnoff.internal>
References: <827486.53924.qm@web110005.mail.gq1.yahoo.com>
	<4C52E09C.3050904@pobox.com>
	<19540.6592.798019.240944@cerise.gclements.plus.com>,
	<4C54237D.3010109@pobox.com>
	<CED6B4B383C5F0418DAFEA443A0033C2F90E2795D3@MALIBU.sarnoff.internal>
Message-ID: <4C542DC8.1000703@pobox.com>

Karney, Charles wrote:
>> From: Frank Warmerdam [warmerdam at pobox.com]
>> Sent: Saturday, July 31, 2010 09:22
> 
>> Based on this, I'm starting to think that the PROJ.4
>> parameter parser just ought to have a special escape
>> sequence for embedding a space.  Ideally something not
>> likely to "activate" other escape sequence parsers.
>> Something like:
>>
>> +nadgrids=C:\Program@@@space@@@Files\GRASS...
>>
>> If you would like me to incorporate such a change, let me know
>> via a proj.4 ticket and I'll proceed.
> 
> Here's a counter-proposal that might address the issues in a
> sufficiently general way:
> 
>   gdalwarp -t_srs "@file.txt"
> 
> with the understanding that an initial @ in an argument implies
> indirection.  file.txt is opened, and the real argument is the result of
> the first getline.

Charles,

It does not solve the problem I noted with GDAL turning proj.4
definitions into WKT and then needing to reparse/split them from there.

I would add that GDAL aleady has a mechanism for reading arguments from
a file, the --optfile directive.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



