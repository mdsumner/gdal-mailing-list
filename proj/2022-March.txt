From kristianevers at gmail.com  Tue Mar  1 10:51:31 2022
From: kristianevers at gmail.com (Kristian Evers)
Date: Tue, 1 Mar 2022 19:51:31 +0100
Subject: [PROJ] PROJ 9.0.0RC2 & PROJ-data 1.9RC2
In-Reply-To: <6bc16db4-2bd1-6f01-e0f5-3d65f2df2a0e@spatialys.com>
References: <8EC5E56A-10B5-4881-B926-99D108D958F8@gmail.com>
 <6bc16db4-2bd1-6f01-e0f5-3d65f2df2a0e@spatialys.com>
Message-ID: <AEF6896B-DEB1-458E-B12D-BE792B563C15@gmail.com>

With +1s from 

Kristian
Thomas
Charles
Even

I declare the motion passed.

Release announcement will follow shortly.

/Kristian

> On 28 Feb 2022, at 18:13, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> +1 Even
> 
> Le 23/02/2022 ? 20:04, Kristian Evers a ?crit :
>> All,
>> 
>> After a round of feedback on the first release candidates a new set of RCs are available.
>> 
>> For the PROJ release candidate, the SOVERSION have been modified to now be aligned
>> with the version number and tests that require access to the internet are only run if access
>> is available.
>> 
>> The new PROJ-data release candidate fixes a few spelling errors in the READMEs.
>> 
>> Download the archives here:
>> 
>> https://download.osgeo.org/proj/proj-9.0.0RC2.tar.gz
>> https://download.osgeo.org/proj/proj-9.0.0RC2.zip
>> 
>> https://download.osgeo.org/proj/proj-data-1.9RC2.tar.gz
>> https://download.osgeo.org/proj/proj-data-1.9RC2.zip
>> 
>> I hope this set of RCs will be the last but don?t hesitate to report any issues may
>> stumble upon.
>> 
>> /Kristian
>> 
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 


From kristianevers at gmail.com  Tue Mar  1 11:24:38 2022
From: kristianevers at gmail.com (Kristian Evers)
Date: Tue, 1 Mar 2022 20:24:38 +0100
Subject: [PROJ] PROJ 9.0.0 & PROJ-data 1.9
Message-ID: <4B888121-9868-4264-B05C-3B4915FD7C81@gmail.com>

On behalf of the PROJ development team I am happy to announce the
release of PROJ 9.0.0 and PROJ-data 1.9. 

The PROJ release includes a number of updates and bug fixes as well
the discontinuation of the Autotools build system. From now on CMake
is the only supported build system in PROJ.See the detailed release 
notes below. 
The PROJ-data packages includes new grids for the Polish ETRF2000-PL, 
Norwegian chart datum grids and the Belgian hBG18 geoid model.
Get the packages here:

http://download.osgeo.org/proj/proj-9.0.0.tar.gz <http://download.osgeo.org/proj/proj-9.0.0.tar.gz>
http://download.osgeo.org/proj/proj-9.0.0.zip <http://download.osgeo.org/proj/proj-9.0.0.zip>


http://download.osgeo.org/proj/proj-data-1.9.tar.gz <http://download.osgeo.org/proj/proj-data-1.9.tar.gz>
http://download.osgeo.org/proj/proj-data-1.9.zip <http://download.osgeo.org/proj/proj-data-1.9.zip>


/Kristian
??????????

9.0.0 Release Notes
-------------------

Breaking Changes
----------------

o Support for the autotools build system has been removed (#3027)
See RFC7 for details: https://proj.org/community/rfc/rfc-7.html

Updates
--------

o Database updates:

+ ESRI projection engine db to version 12.9 (#2943)

+ EPSG v10.054 (#3051)

+ Vertical grid files for PL-geoid-2011, Polish geoid model (#2960)

+ Belgian geoid model hBG18 to grid alternatives (#3044)

o Add new option to proj_create_crs_to_crs_from_pj method to force +over on
transformation operations (#2914)

o Specify CMAKE_INSTALL_RPATH for macOS; use -rpath LDFLAGS for tests (#3009)

o Implement Geographic3D to Depth/Geog2D+Depth as used by ETRS89 to CD Norway
depth (#3010)

o Allow PROJ_LIB paths wrapped with double quotes (#3031)

o Use external gtest by default when possible (#3035)

o CMake: make BUILD_SHARED_LIBS=ON the default even on Windows (#3042)

o proj.ini: add a 'ca_bundle_path' variable (#3049)


Bug fixes
----------

o Fix extremely long parsing time on hostile PROJ strings (#2968)

o CMake: fix warning with external googletest (#2980)

o proj_get_crs_info_list_from_database(): report PJ_TYPE_GEODETIC_CRS for
IAU_2015 -ocentric geodetic CRS (#3013)

o peirce_q: rename +type parameter wrongly introduced in 8.2.1 to +shape (#3014)

o Set more precise error code for parsing errors in proj_create() (#3037)

o createOperations(): fix transformations from/to a BoundCRS of a
DerivedGeographicCRS coming from WKT (#3046)

o Better deal with importing strings like '+init=epsg:XXXX +over' (#3055)

o Fix importing CRS definition with +proj=peirce_q and +shape different from
square or diamond (#3057)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220301/1d163e6a/attachment.html>

From kristianevers at gmail.com  Tue Mar  1 11:53:04 2022
From: kristianevers at gmail.com (Kristian Evers)
Date: Tue, 1 Mar 2022 20:53:04 +0100
Subject: [PROJ] Release schedule for the next year
Message-ID: <F720F10D-26F3-42CA-AC75-7298B12C945B@gmail.com>

All

I?ve updated the release schedule over at https://github.com/OSGeo/PROJ/milestones <https://github.com/OSGeo/PROJ/milestones>.
The releases planned are:

9.0.1: June 8th 2022
9.1.0: September 1st 2022
9.1.1: December 1st 2022
9.2.0: March 1st 2023

As you might notice I?ve reduced the frequency of releases from having a release
every two months to every three months. I am on vacation June 1st hence the
release date of June 8th for 9.0.1. 

In case a severe bug shows up and an urgent fix is necessary we may issue an
ad hoc patch release.

Contrary to the last five years we will NOT have a new major version release on 
March 1st 2023. We?ve worked our way through all the big changes that required
bumping the major version numbers. I expect the 9.x branch of PROJ to live on
for at least five years. Time will tell if that holds true or not.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220301/419b3f14/attachment.html>

From j1 at jimenezshaw.com  Tue Mar  1 12:27:23 2022
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 1 Mar 2022 21:27:23 +0100
Subject: [PROJ] CRS explorer
In-Reply-To: <CADRrdKvX0Vt3rVEGC1BqTbrqwN06eP7McK57vbUKyUE_d1ybqA@mail.gmail.com>
References: <CADRrdKsOchzH6sJLBvCq+ThbpMEB4LiT_ekp6_VsiP8cpMnbcQ@mail.gmail.com>
 <CAH0YoEP=3XS0knnaJtuGiG1PkDG0iO5wXAqseFJAHFVVs2BTWQ@mail.gmail.com>
 <CADRrdKufSe-aq39ViHu8Q1ZKyii0umacBQx9caWFuL9BgRP_5A@mail.gmail.com>
 <AM0P192MB04827B7BE0E14E36DA0144A8EF6B9@AM0P192MB0482.EURP192.PROD.OUTLOOK.COM>
 <CADRrdKvX0Vt3rVEGC1BqTbrqwN06eP7McK57vbUKyUE_d1ybqA@mail.gmail.com>
Message-ID: <CADRrdKvTWP8Ha1EAUt6YTNxeYTDX_S5xAywTH1ceH5a89-b+8Q@mail.gmail.com>

Hi PROJ community

https://jjimenezshaw.github.io/crs-explorer is now updated to PROJ 9.0.0

It also includes some improvements (some of them suggested by you), like:
 - Single table, having a column with the type.
 - WKT 1&2 links to plain text urls (I made that way to easily link to the
wkt files from anywhere just knowing the code). It also tries to display it
as a tooltip, if the browser doesn't bother too much.
 - Persistent URL while you update the filters: makes easy to share your
selection.
 - Direct link to epsg.org description of each crs (well, this change is a
bit older).

It now has 12869 systems (enable them all with
https://jjimenezshaw.github.io/crs-explorer/?all=true ).

I hope it become more useful.

Cheers,
Javier.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Sun, 5 Dec 2021 at 11:18, Javier Jimenez Shaw <j1 at jimenezshaw.com> wrote:

>
> On Sat, 4 Dec 2021 at 13:54, Lesparre, Jochem <Jochem.Lesparre at kadaster.nl>
> wrote:
>
>> Hi Javier,
>>
>>
>>
> Jochem, Thanks for you answer and suggestions.
>
> Thanks for the nice improvements. I like the name filtering! It could be
>> useful to be able to use this for other columns too, like the area of use
>> and code.
>>
> I thought about that, but finally decided not doing it. When you search
> for the code, you want a single result (you don't want to "filter"): Ctrl+F
> does that much better ;) About the area of use, their names are really
> confusing sometimes. And it may collide with the CRS name. Picking a point
> in the map would be better IMO.
> BTW, the filter field tries to work like many search engines: use
> double-quotes (") for searches with spaces, and a dash (-) to implement a
> "not" filter... and combine as many as you want. It is explained in the
> info (i) link.
>
>>
>>
>> I was wondering: Since you give the option to sort on a column, why do
>> you present the CRS types (Projected, Geographic, Geocentric etc.) in
>> separate tables? If you add a column for the CRS type in the table, then
>> you could present everything in a single table and an user can still sort
>> on CRS type if needed. The advantage would be that the user can also sort
>> on other columns for all CRS types at once.
>>
> Yes, it was also in the backlog of ideas. I would give the option to
> display one way or the other, but may take some time to implement (yes, I
> like giving options to the user... and later they ask what does it do ;).
>
>>
>>
>> What does the option Sticky map do?
>>
> "Sticks" the map to the top of the viewport when you scroll down due to a
> large table. See next answer.
>
> What function does the checkbox in the column Area of use have?
>>
> Displays a green rectangle in the map with the area(s) of use selected.
> Just hovering with the mouse shows an orange rectangle. Now you understand
> why you need the sticky map option.
>
>
>>
>> Regards, Jochem
>>
>>
>>
>>
>>
> Cheers,
> Javier.
>
>>
>> ------------------------------
>>
>> *From:* PROJ <proj-bounces at lists.osgeo.org> on behalf of Javier Jimenez
>> Shaw <j1 at jimenezshaw.com>
>> *Sent:* Friday, 3 December 2021, 16:01
>> *To:* proj
>> *Subject:* Re: [PROJ] CRS explorer
>>
>>
>>
>> Hi all
>>
>>
>>
>> Sorry for the late update to PROJ 8.2.0. I have been implementing it with
>> GitHub Actions. But now it is available.
>>
>> https://jjimenezshaw.github.io/crs-explorer/
>>
>> Some features were added, like filtering by name, column ordering, better
>> performance...
>>
>>
>>
>> I was thinking on adding links to static pages with the WKT1 of each CRS.
>> Do you think it is useful?
>>
>>
>>
>> Cheers,
>>
>> Javier
>>
>>
>>
>> PS: I found some new astronomical CRSs (IAU_2015) that are type "other"
>> in proj.db. What is that?
>>
>> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
>> Entre dos pensamientos racionales
>> hay infinitos pensamientos irracionales.
>>
>>
>>
>>
>>
>> On Thu, 14 Oct 2021 at 12:57, Thomas Knudsen <knudsen.thomas at gmail.com>
>> wrote:
>>
>> Javier,
>>
>>
>>
>> Thanks for developing this - it seems to be extremely useful!
>>
>>
>>
>> /Thomas
>>
>>
>>
>> Den tor. 14. okt. 2021 kl. 12.03 skrev Javier Jimenez Shaw <
>> j1 at jimenezshaw.com>:
>>
>> Hi
>>
>>
>>
>> I have developed a simple webpage to search coordinate reference systems
>> based on PROJ data. It includes a map where you can click a location,
>> filtering the systems that has this location in their area of use.
>>
>>
>>
>> https://jjimenezshaw.github.io/crs-explorer/
>>
>>
>>
>> There are a couple of ideas to add in the backlog. But I hope it is
>> already useful.
>>
>>
>>
>> Cheers,
>>
>> Javier.
>>
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj
>>
>>
>>
>>
>> Disclaimer:
>> De inhoud van deze e-mail is vertrouwelijk en uitsluitend bestemd voor de
>> geadresseerde(n).
>> Gebruik, openbaarmaking, vermenigvuldiging, verspreiding en/of
>> verstrekking van deze informatie aan derden is niet toegestaan.
>> Op al onze producten en diensten zijn onze algemene leveringsvoorwaarden
>> van toepassing
>> [https://www.kadaster.nl/algemene-leveringsvoorwaarden].
>>
>> Disclaimer:
>> This email and any files transmitted with it are confidential and
>> intended solely for the use of the individual or entity to whom they are
>> addressed.
>> If you are not the intended recipient, you are notified that disclosing,
>> copying, distributing or taking any action in reliance on the contents of
>> this information is strictly prohibited.
>> Our general terms and conditions of delivery apply to all our products
>> and services
>> [https://www.kadaster.com/general-terms-and-conditions].
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220301/8a9a4b08/attachment.html>

From martin.desruisseaux at geomatys.com  Mon Mar  7 01:31:08 2022
From: martin.desruisseaux at geomatys.com (Martin Desruisseaux)
Date: Mon, 7 Mar 2022 10:31:08 +0100
Subject: [PROJ] 1 day left to register to OGC/OSGeo/ASF code sprint
Message-ID: <4abf89a4-d668-cfdd-de6a-862270b20636@geomatys.com>

Hello all

This is a reminder that registration for OGC/OSGeo/ASF code sprint 
closes in about 24 hours.

  * Schedule and QGIS tutorials are announced at [1].
  * Registration at [2] (it is free).
  * Application for funding at [3].
  * Proposals relevant to both Apache SIS and PROJ at [4] and [5].

Martin

[1]https://github.com/opengeospatial/developer-events/wiki/2022-Joint-OGC-%E2%80%93-OSGeo-%E2%80%93-ASF-Code-Sprint
[2]https://portal.ogc.org/public_ogc/register/220225asf_codesprint.php
[3]https://t.co/zxoN70sKLF
[4]https://github.com/opengeospatial/developer-events/tree/master/2022/Joint-OGC-OSGeo-ASF-Code-Sprint%202022/ideas/GGXF
[5]https://github.com/opengeospatial/developer-events/tree/master/2022/Joint-OGC-OSGeo-ASF-Code-Sprint%202022/ideas/GIGS
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220307/17302671/attachment.html>

From even.rouault at spatialys.com  Mon Mar  7 02:00:44 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 7 Mar 2022 11:00:44 +0100
Subject: [PROJ] Issue with SQLite 3.38.0
Message-ID: <7f2dae13-bfcd-f518-c604-c390b0574e81@spatialys.com>

Hi,

just to notify people that there's a known issue with released versions 
of PROJ that trigger a bug in SQLite 3.38.0 which causes PROJ to not be 
able to find appropriate some coordinate operations, in particular the 
ones that require looking for intermediate CRS to chain known 
transformations. A workaround is implemented by 
https://github.com/OSGeo/PROJ/pull/3089 . Updating to SQLite 3.38.1 when 
it will be released will be the recommended resolution (as the issue 
affects also PROJ < 9.0)

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jmckenna at gatewaygeomatics.com  Sun Mar 13 04:33:29 2022
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sun, 13 Mar 2022 08:33:29 -0300
Subject: [PROJ] Issue with SQLite 3.38.0
In-Reply-To: <7f2dae13-bfcd-f518-c604-c390b0574e81@spatialys.com>
References: <7f2dae13-bfcd-f518-c604-c390b0574e81@spatialys.com>
Message-ID: <4161e104-505e-1979-f8a1-3f42a8f73e3a@gatewaygeomatics.com>

SQLite 3.38.1 release is now available.

-jeff



On 2022-03-07 6:00 a.m., Even Rouault wrote:
> Hi,
> 
> just to notify people that there's a known issue with released versions 
> of PROJ that trigger a bug in SQLite 3.38.0 which causes PROJ to not be 
> able to find appropriate some coordinate operations, in particular the 
> ones that require looking for intermediate CRS to chain known 
> transformations. A workaround is implemented by 
> https://github.com/OSGeo/PROJ/pull/3089 . Updating to SQLite 3.38.1 when 
> it will be released will be the recommended resolution (as the issue 
> affects also PROJ < 9.0)
> 
> Even
> 


-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, MapServer Consulting and Training
co-founder of FOSS4G
http://gatewaygeo.com/

From erixen at cesium.com  Wed Mar 16 09:09:47 2022
From: erixen at cesium.com (Erixen Cruz)
Date: Wed, 16 Mar 2022 12:09:47 -0400
Subject: [PROJ] Krovak S-JTSK centimeter accuracy
Message-ID: <CABG=M1M=7n9xjsTsKvxn++iSc8Dxc7=rhhM2bZBVbReSSZggsQ@mail.gmail.com>

Hello,
We want to use Proj to transform from EPSG:4979 to EPSG:5513+5705 (Krovak
S-JTSK + Baltic height). The CZ government has published how to go from
ETRF2000 (which I believe Proj approximates with WGS84) to S-JTSK with
centimeter accuracy here
<https://www.cuzk.cz/Zememerictvi/Geodeticke-zaklady-na-uzemi-CR/GNSS/Nova-realizace-systemu-ETRS89-v-CR.aspx>
 (English
<https://www-cuzk-cz.translate.goog/Zememerictvi/Geodeticke-zaklady-na-uzemi-CR/GNSS/Nova-realizace-systemu-ETRS89-v-CR.aspx?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=wapp>).
We can observe that Proj does not apply any grid shift files and relies on
a helmert transform and Krovak projection only:
$ OSGeo/PROJ/build/bin/projinfo -s EPSG:4979 -t EPSG:5513+5705 -o PROJ
...
PROJ string:
+proj=pipeline
 +step +proj=axisswap +order=2,1
 +step +proj=unitconvert +xy_in=deg +xy_out=rad
 +step +proj=push +v_3
 +step +proj=cart +ellps=WGS84
 +step +inv +proj=helmert +x=589 +y=76 +z=480
 +step +inv +proj=cart +ellps=bessel
 +step +proj=pop +v_3
 +step +proj=krovak +axis=swu +lat_0=49.5 +lon_0=24.8333333333333
       +alpha=30.2881397527778 +k=0.9999 +x_0=0 +y_0=0 +ellps=bessel

The PDF from the CZ gov't suggests that after the Krovak coordinate
operation, the horizontal grid shift from the provided file be applied in
this projected frame.

First question:
Does Proj support this local coordinate grid shift? Looking through the
documentation, the shift you can get with `xyzgridshift` expects geocentric
coordinates, so it isn't appropriate here I think. `hgridshift` expects
geodetic coordinates (lat/lon), so it isn't appropriate either.

Second question:
The Czech Technical University in Prague has a page about using Proj to
transform to/from S-JTSK here
<http://freegis.fsv.cvut.cz/gwiki/S-JTSK_/_Grid> (English
<https://freegis-fsv-cvut-cz.translate.goog/gwiki/S-JTSK_/_Grid?_x_tr_sch=http&_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=wapp>).
It suggests using grid shift files from some CZ researchers with the old
`nadgrids` and `geoidgrids` paradigm. We can confirm that this leads to
sub-10cm accuracy. Is there anything wrong with going with this method, and
would Proj accept a PR for adding these grid shift files to get the better
accuracy?

Thanks for reading, and thanks for any advice you can offer.
Sincerely,
Erixen Cruz
3D Software Developer, Cesium <https://cesium.com/>
erixen at cesium.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220316/8a93afb8/attachment.html>

From even.rouault at spatialys.com  Wed Mar 16 11:07:14 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Mar 2022 19:07:14 +0100
Subject: [PROJ] Krovak S-JTSK centimeter accuracy
In-Reply-To: <CABG=M1M=7n9xjsTsKvxn++iSc8Dxc7=rhhM2bZBVbReSSZggsQ@mail.gmail.com>
References: <CABG=M1M=7n9xjsTsKvxn++iSc8Dxc7=rhhM2bZBVbReSSZggsQ@mail.gmail.com>
Message-ID: <78954826-fa7b-9e96-5a4c-69b1c5543276@spatialys.com>


> First question:
> Does Proj support this local coordinate grid shift?

What do you mean by local: a grid that deal with projected coordinates ? 
Is it really the case here ? (sorry didn't have time to read thoroughly 
your links). We've had instances where the data producer originally 
provided grids referenced to projected coordinates, like the OSGB15 
geoid model, and the contributor to PROJ-data reprojected them to 
geographic coordinates to make them more usable by PROJ. Of course this 
only worked for a geoid model. If the content of the grid itself is 
shifts in eastings, northings, then a more complex transformation has to 
be done. Otherwise PROJ would need a few changes to deal with grids that 
would operate on projected coordinates.


>
> Second question:
> The Czech Technical University?in Prague has a page about using Proj 
> to transform to/from S-JTSK here 
> <http://freegis.fsv.cvut.cz/gwiki/S-JTSK_/_Grid>?(English 
> <https://freegis-fsv-cvut-cz.translate.goog/gwiki/S-JTSK_/_Grid?_x_tr_sch=http&_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=wapp>). 
> It suggests using grid shift files from some CZ researchers with the 
> old `nadgrids` and `geoidgrids` paradigm.
OK, so "standard grids" here. Are they the same you referred too 
previously ?
> would Proj accept a PR for adding these grid shift?files to get the 
> better accuracy?

I would strongly suggest that you, or more appropriately the Czech 
geodesic authority register those grids with IOGP in the EPSG dataset. 
That's the main source of geodesic data for PROJ. Otherwise we need to 
add custom entries, and this adds a maintenance burden to the project. 
If you'd want those grid(s) to be included in 
https://github.com/OSGeo/PROJ-data/, you'll have also to make sure that 
they are licensed under an open data license such as the ones listed in 
https://github.com/OSGeo/PROJ-data/#about-the-data-package. It can take 
some time of discussion with the data producer so 1) they are aware 
about the existence of licenses 2) they are willing to distribute under 
an open data license.

Even

>
> Thanks for reading, and thanks for any advice you can offer.
> Sincerely,
> Erixen Cruz
> 3D Software Developer, Cesium <https://cesium.com/>
> erixen at cesium.com
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220316/d97dafae/attachment.html>

From erixen at cesium.com  Wed Mar 16 11:30:07 2022
From: erixen at cesium.com (Erixen Cruz)
Date: Wed, 16 Mar 2022 14:30:07 -0400
Subject: [PROJ] Krovak S-JTSK centimeter accuracy
In-Reply-To: <78954826-fa7b-9e96-5a4c-69b1c5543276@spatialys.com>
References: <CABG=M1M=7n9xjsTsKvxn++iSc8Dxc7=rhhM2bZBVbReSSZggsQ@mail.gmail.com>
 <78954826-fa7b-9e96-5a4c-69b1c5543276@spatialys.com>
Message-ID: <CABG=M1Povh2FNSV9fc=sh=ab2EqNRNL=okNRGotLHvUDgmrt-g@mail.gmail.com>

>
> What do you mean by local: a grid that deal with projected coordinates ?
> Is it really the case here ?
>
Yes, it is in projected coordinates with corrections in the X and Y
directions (easing, northing). I was thinking of reprojecting to geodetic
coordinates to be able to use `hgridshift`, but there is nuance/complexity
like you mentioned.

OK, so "standard grids" here. Are they the same you referred too previously
> ?
>
They are different from the published files mentioned previously that are
in projected coordinates. These are grids that PROJ knows how to handle.

I would strongly suggest that you, or more appropriately the Czech geodesic
> authority register those grids with IOGP in the EPSG dataset.
>
That makes sense. These "standard grids" come from researchers from Czech
universities, and the most accurate one has an MIT-like (open) license. We
can just use it by adding it to the PROJ_LIB directory with the rest of the
other files that come with proj-data.

Thanks for your insight, Even.
Sincerely, Erixen


On Wed, Mar 16, 2022 at 2:07 PM Even Rouault <even.rouault at spatialys.com>
wrote:

>
> First question:
> Does Proj support this local coordinate grid shift?
>
> What do you mean by local: a grid that deal with projected coordinates ?
> Is it really the case here ? (sorry didn't have time to read thoroughly
> your links). We've had instances where the data producer originally
> provided grids referenced to projected coordinates, like the OSGB15 geoid
> model, and the contributor to PROJ-data reprojected them to geographic
> coordinates to make them more usable by PROJ. Of course this only worked
> for a geoid model. If the content of the grid itself is shifts in eastings,
> northings, then a more complex transformation has to be done. Otherwise
> PROJ would need a few changes to deal with grids that would operate on
> projected coordinates.
>
>
> Second question:
> The Czech Technical University in Prague has a page about using Proj to
> transform to/from S-JTSK here
> <http://freegis.fsv.cvut.cz/gwiki/S-JTSK_/_Grid> (English
> <https://freegis-fsv-cvut-cz.translate.goog/gwiki/S-JTSK_/_Grid?_x_tr_sch=http&_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=wapp>).
> It suggests using grid shift files from some CZ researchers with the old
> `nadgrids` and `geoidgrids` paradigm.
>
> OK, so "standard grids" here. Are they the same you referred too
> previously ?
>
> would Proj accept a PR for adding these grid shift files to get the better
> accuracy?
>
> I would strongly suggest that you, or more appropriately the Czech
> geodesic authority register those grids with IOGP in the EPSG dataset.
> That's the main source of geodesic data for PROJ. Otherwise we need to add
> custom entries, and this adds a maintenance burden to the project. If you'd
> want those grid(s) to be included in https://github.com/OSGeo/PROJ-data/,
> you'll have also to make sure that they are licensed under an open data
> license such as the ones listed in
> https://github.com/OSGeo/PROJ-data/#about-the-data-package. It can take
> some time of discussion with the data producer so 1) they are aware about
> the existence of licenses 2) they are willing to distribute under an open
> data license.
>
> Even
>
>
> Thanks for reading, and thanks for any advice you can offer.
> Sincerely,
> Erixen Cruz
> 3D Software Developer, Cesium <https://cesium.com/>
> erixen at cesium.com
>
> _______________________________________________
> PROJ mailing listPROJ at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/proj
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220316/f83f19ac/attachment-0001.html>

From Jochem.Lesparre at kadaster.nl  Thu Mar 17 03:26:10 2022
From: Jochem.Lesparre at kadaster.nl (Lesparre, Jochem)
Date: Thu, 17 Mar 2022 10:26:10 +0000
Subject: [PROJ] Krovak S-JTSK centimeter accuracy
In-Reply-To: <CABG=M1Povh2FNSV9fc=sh=ab2EqNRNL=okNRGotLHvUDgmrt-g@mail.gmail.com>
References: <CABG=M1M=7n9xjsTsKvxn++iSc8Dxc7=rhhM2bZBVbReSSZggsQ@mail.gmail.com>
 <78954826-fa7b-9e96-5a4c-69b1c5543276@spatialys.com>
 <CABG=M1Povh2FNSV9fc=sh=ab2EqNRNL=okNRGotLHvUDgmrt-g@mail.gmail.com>
Message-ID: <AM0P192MB0482AEEA9CB015AF3785DB9BEF129@AM0P192MB0482.EURP192.PROD.OUTLOOK.COM>

>> What do you mean by local: a grid that deal with projected coordinates ? Is it really the case here ? (sorry didn't have time to read thoroughly your links). We've had instances where the data producer originally provided grids referenced to projected coordinates, like the OSGB15 geoid model, and the contributor to PROJ-data reprojected them to geographic coordinates to make them more usable by PROJ. Of course this only worked for a geoid model. If the content of the grid itself is shifts in eastings, northings, then a more complex transformation has to be done. Otherwise PROJ would need a few changes to deal with grids that would operate on projected coordinates.
> Yes, it is in projected coordinates with corrections in the X and Y directions (easing, northing). I was thinking of reprojecting to geodetic coordinates to be able to use `hgridshift`, but there is nuance/complexity like you mentioned.

>> I would strongly suggest that you, or more appropriately the Czech geodesic authority register those grids with IOGP in the EPSG dataset.

A horizontal grid on projected coordinates is not supported ISO, EPSG and GIS software packages, right? In the Netherlands we tried for some years to find other European countries to team up for a lobby to get it supported, without success. So in the end we decided to convert the horizontal grid for our national CRS.

Converting a horizontal grid from projected corrections to ellipsoidal corrections is not too difficult. A problem (1) is that you never get transformation to give exactly the same results due to the resampling of the grid. Because it is common in PROJ (and required by ISO, EPSG and GIS software packages) to include the datum transformation in the ellipsoidal grid, you?ll get two additional problems. (2) The datum transformation becomes 2D instead of 3D. This is convenient for many users, but it introduces horizontal differences between the 3D and the 2D datum transformation that depend on the height. (3) No datum transformation is applied outside the grid, limiting the area where the transformation can be used or causing a discontinuity at the grid edge.

As an official workaround with PROJ, we use a fixed height (43 m in ETRS89 / 0 m in national CRS) for a 3D Helmert datum transformation next to a horizontal grid to get the same results as a grid that includes the datum transformation. This approach also gives results outside the grid, without discontinuities on the grid edge (since the values of our grid fade-out to zero at the grid edge):

+proj=pipeline
+step +proj=unitconvert +xy_in=deg +xy_out=rad
+step +proj=axisswap +order=2,1
+step +proj=push +v_3
+step +proj=set +v_3=43 +omit_inv
+step +proj=cart +ellps=GRS80
+step +proj=helmert +x=-565.7346 +y=-50.4058 +z=-465.2895 +rx=-0.395023 +ry=0.330776 +rz=-1.876073 +s=-4.07242 +convention=coordinate_frame +exact
+step +proj=cart +inv +ellps=bessel
+step +proj=hgridshift +inv +grids=rdcorr2018.tif,null
+step +proj=sterea +lat_0=52.156160556 +lon_0=5.387638889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
+step +proj=set +v_3=0 +omit_fwd
+step +proj=pop +v_3

Regards, Jochem






Disclaimer:
De inhoud van deze e-mail is vertrouwelijk en uitsluitend bestemd voor de geadresseerde(n).
Gebruik, openbaarmaking, vermenigvuldiging, verspreiding en/of verstrekking van deze informatie aan derden is niet toegestaan.
Op al onze producten en diensten zijn onze algemene leveringsvoorwaarden van toepassing
[https://www.kadaster.nl/algemene-leveringsvoorwaarden].

Disclaimer:
This email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed.
If you are not the intended recipient, you are notified that disclosing, copying, distributing or taking any action in reliance on the contents of this information is strictly prohibited.
Our general terms and conditions of delivery apply to all our products and services
[https://www.kadaster.com/general-terms-and-conditions].
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220317/9a345d73/attachment.html>

From even.rouault at spatialys.com  Thu Mar 24 08:50:22 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Mar 2022 16:50:22 +0100
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
Message-ID: <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>

Steve,

(adding proj mailing list since it's actually purely a PROJ topic

> Does the fact that there isn?t a consensus mean 3126 & 3127 aren?t 
> going to end up in a PROJ release?
>

Did you try them to confirm they help ? Maybe if you want to weight in 
the PRs (if they actually help) that could change the balance.

> I read through the PR?s. Are you thinking my issue is that a vertical 
> shift is being introduced because of a transformation to WGS84 (from 
> NAD83(CSRS)) to look up the geoid separation value?
>
That's probably an issue with the wrong interpolation CRS being used, 
but I can't generally predict how this complex code works without 
launching a debugger and step-by-step tracing what happens.
>
> PROJ4_GRIDS provided a way to specify exactly which geoid file(s) to 
> use.? Some vertical datums, such as NAVD88, only have a single EPSG 
> code for multiple geoids ? what?s the replacement for PROJ4_GRIDS in 
> PROJ9? ?If I could switch to WKT2 strings (not sure that?s really 
> feasible) does it fix these problems?
>
WKT2 hardly helps for that. The closest equivalent is the GEOIDMODEL[] 
sub node of a VERTCRS[] 
(http://docs.opengeospatial.org/is/18-010r7/18-010r7.html#83). But 
that's something that refer to an existing transformation . And in a 
VRTCRS[] you can actually have several GEOIDMODEL[] listed (e.g. for 
NAVD88, all the geoid models), since that's more a definition of the 
VertCRS than which particular geoid model to use. So that's not 
nominally appropriate for a "random" grid not known of PROJ, although we 
have a bit bent the concept to allow a GEOIDMODEL["PROJ 
name_of_the_grid_dot_tif_or_gtx"]. But I would suspect that in that 
situation the ambiguity with the geographic / interpolation CRS to use 
would be similar to WKT1 PROJ4_GRIDS.
>
> Thanks,
>
> steve
>
> *From:* Even Rouault <even.rouault at spatialys.com>
> *Sent:* Wednesday, March 23, 2022 6:06 PM
> *To:* Steve Riddell <sriddell at geocue.com>; gdal-dev at lists.osgeo.org
> *Subject:* Re: OGRCreateCoordinateTransformation()
>
> Steve,
>
> you may try PR https://github.com/OSGeo/PROJ/pull/3126 or 
> https://github.com/OSGeo/PROJ/pull/3127, that might potentially help, 
> but they don't make consensus (see discussions of those PRs). 
> Basically it is a nightmare to deal with the old TOWGS84 / PROJ4_GRIDS 
> approach, that poorly specifies some elements of transformations 
> (especially the vertical part), and doesn't fit well in the ISO-19111 
> model used by newer PROJ (we use and abuse the BoundCRS approach in 
> complex ways). One of the issue too is that we've realized late in the 
> process that we didn't emulate some aspects of the old transformation 
> pipeline, and there isn't general enthusiasm to change that now.
>
> Even
>
> Le 23/03/2022 ? 23:42, Steve Riddell a ?crit?:
>
>     Hi Even,
>
>     I tried the fix with the CRS?s I sent, and it worked. But as I
>     mentioned, my real target CRS is a custom projected system
>     (below), and it still fails with what seems to be the same error
>     as in my original email.
>
>     COMPD_CS["TempTM + CGVD28 height - HT2_0",
>
>     ??? PROJCS["Custom",
>
>     ??????? GEOGCS["NAD83(CSRS)",
>
>     DATUM["NAD83_Canadian_Spatial_Reference_System",
>
>     ??????????????? SPHEROID["GRS 1980",6378137,298.257222101,
>
>     AUTHORITY["EPSG","7019"]],
>
>     ??????????????? TOWGS84[0,0,0,0,0,0,0],
>
>     AUTHORITY["EPSG","6140"]],
>
>     ??????????? PRIMEM["Greenwich",0,
>
>     AUTHORITY["EPSG","8901"]],
>
>     UNIT["degree",0.0174532925199433,
>
>     AUTHORITY["EPSG","9122"]],
>
>     ??????????? AUTHORITY["EPSG","4617"]],
>
>     PROJECTION["Transverse_Mercator"],
>
>     PARAMETER["latitude_of_origin",49.351346659616],
>
>     PARAMETER["central_meridian",-123.20266499149],
>
>     ??????? PARAMETER["scale_factor",1],
>
>     PARAMETER["false_easting",15307.188],
>
>     PARAMETER["false_northing",6540.975],
>
>     ??????? UNIT["Meters",1],
>
>     ??????? AXIS["Easting",EAST],
>
>     ??????? AXIS["Northing",NORTH]],
>
>     ??? VERT_CS["CGVD28 height - HT2_0",
>
>     ??????? VERT_DATUM["Canadian Geodetic Vertical Datum of 1928",2005,
>
>     EXTENSION["PROJ4_GRIDS","HT2_0.gtx"],
>
>     ??????????? AUTHORITY["EPSG","5114"]],
>
>     ??????? UNIT["metre",1,
>
>     ??????????? AUTHORITY["EPSG","9001"]],
>
>     ??????? AXIS["Gravity-related height",UP],
>
>     ??????? AUTHORITY["EPSG","5713"]]]
>
>     Experimenting, I removed the ?TOWGS84? directive from BOTH the
>     source and target systems, and I do get an answer instead of an error:
>
>     For test point: (49.351346658, -123.202664992, 289.809)
>
>     I get: (15307.1880,6540.9748,307.744)
>
>     But since geoid separation at the test point is -18.238, Z should
>     be 308.047.? In fact, if I code up the following pipeline and
>     initialize a transform object:
>
>     strPipe ="+proj=pipeline\
>
>     ??????? +step +proj=axisswap +order=2, 1\
>
>     ??????? +step +proj=unitconvert +xy_in=deg +xy_out=rad\
>
>     ??????? +step +inv +proj=vgridshift +grids=HT2_0.gtx +multiplier=1\
>
>     ??????? +step +proj=tmerc +lat_0=49.351346659616
>     +lon_0=-123.20266499149 +k=1\
>
>     ??????? +x_0=15307.188 +y_0=6540.975 +ellps=GRS80";
>
>     The call to Transform() gives: (15307.1880, 6540.9748, 308.042)??
>     -- XY matches above, but now I get the expected Z (-0.005).
>     ?However, I?d like to avoid assembling pipelines for every
>     conversion/transform.
>
>     Any arrows left in your quiver?
>
>     Thanks,
>
>     Steve
>
>     *From:* Steve Riddell
>     *Sent:* Friday, March 18, 2022 6:17 PM
>     *To:* Even Rouault <even.rouault at spatialys.com>
>     <mailto:even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
>     *Subject:* RE: OGRCreateCoordinateTransformation()
>
>     Thanks very much, Even.? For reporting the problem, I ?packaged
>     up? a case with CRS?s with EPGS codes. For the actual problem I?m
>     working, the target CRS is a custom projection ?no EPSG.
>
>     *From:* Even Rouault <even.rouault at spatialys.com>
>     *Sent:* Friday, March 18, 2022 5:05 PM
>     *To:* Steve Riddell <sriddell at geocue.com>; gdal-dev at lists.osgeo.org
>     *Subject:* Re: OGRCreateCoordinateTransformation()
>
>     Steve,
>
>     Fix in PROJ queued in https://github.com/OSGeo/PROJ/pull/3123
>
>     The complexity of dealing with legacy features TOWGS84[] and
>     PROJ4_GRIDS is highly stressing PROJ pipeline computation engine.
>
>     Using the plain EPSG codes? EPSG:4955 -> EPSG:4617+5713 would be
>     much preferable here
>
>     Even
>
>     Le 18/03/2022 ? 21:14, Steve Riddell a ?crit?:
>
>         Hi,
>
>         I?m getting an error (below) using GDAL trying to set up a
>         transformation between NAD83(CSRS) geodetic, w/ ellipsoidal
>         heights, and NAD83(CSRS) geodetic, CGVD28 heights. Similar
>         transformations work fine on some datums,? but fail on others.
>         ?Hope someone can offer some insight.? Note the if I don't use
>         the PROJ4_GRIDS extension, I don't get the error, but I don't
>         get the geoid adjustment either.
>
>         COMPD_CS["NAD83(CSRS) + Ellipsoid (Meters)",
>
>         ??? GEOGCS["NAD83(CSRS)",
>
>         DATUM["NAD83_Canadian_Spatial_Reference_System",
>
>         ??????????? SPHEROID["GRS 1980",6378137,298.257222101,
>
>         AUTHORITY["EPSG","7019"]],
>
>         ??????????? TOWGS84[0,0,0,0,0,0,0],
>
>         ??????????? AUTHORITY["EPSG","6140"]],
>
>         ??????? PRIMEM["Greenwich",0,
>
>         ??????????? AUTHORITY["EPSG","8901"]],
>
>         UNIT["degree",0.0174532925199433,
>
>         ??????????? AUTHORITY["EPSG","9122"]],
>
>         ??????? AUTHORITY["EPSG","4617"]],
>
>         ??? VERT_CS["Ellipsoid (Meters)",
>
>         ??????? VERT_DATUM["Ellipsoid",2002],
>
>         ??????? UNIT["metre",1,
>
>         ??????????? AUTHORITY["EPSG","9001"]],
>
>         ??????? AXIS["ellipsoidal height",UP]]]
>
>         COMPD_CS["NAD83(CSRS) + CGVD28 height - HT2_0",
>
>         ??? GEOGCS["NAD83(CSRS)",
>
>         DATUM["NAD83_Canadian_Spatial_Reference_System",
>
>         ??????????? SPHEROID["GRS 1980",6378137,298.257222101,
>
>         AUTHORITY["EPSG","7019"]],
>
>         ??????????? TOWGS84[0,0,0,0,0,0,0],
>
>         ??????????? AUTHORITY["EPSG","6140"]],
>
>         ??????? PRIMEM["Greenwich",0,
>
>         ??????????? AUTHORITY["EPSG","8901"]],
>
>         UNIT["degree",0.0174532925199433,
>
>         ??????????? AUTHORITY["EPSG","9122"]],
>
>         ??????? AUTHORITY["EPSG","4617"]],
>
>         ??? VERT_CS["CGVD28 height - HT2_0",
>
>         ??????? VERT_DATUM["Canadian Geodetic Vertical Datum of
>         1928",2005,
>
>         EXTENSION["PROJ4_GRIDS","HT2_0.gtx"],
>
>         ??????????? AUTHORITY["EPSG","5114"]],
>
>         ??????? UNIT["metre",1,
>
>         ??????????? AUTHORITY["EPSG","9001"]],
>
>         ??????? AXIS["Gravity-related height",UP],
>
>         ??????? AUTHORITY["EPSG","5713"]]]
>
>         ERROR 6: Cannot find coordinate operations from `EPSG:4955' to
>         `COMPOUNDCRS["NAD83(CSRS) + CGVD28 height -
>         HT2_0",BOUNDCRS[SOURCECRS[GEOGCRS["NAD83(CSRS)",DATUM["NAD83
>         Canadian Spatial Reference System",ELLIPSOID["GRS
>         1980",6378137,298.257222101,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,2],AXIS["geodetic
>         latitude
>         (Lat)",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["geodetic
>         longitude
>         (Lon)",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4617]]],TARGETCRS[GEOGCRS["WGS
>         84",DATUM["World Geodetic System 1984",ELLIPSOID["WGS
>         84",6378137,298.257223563,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,2],AXIS["latitude",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["longitude",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]]],ABRIDGEDTRANSFORMATION["Transformation
>         from NAD83(CSRS) to WGS84",METHOD["Position Vector
>         transformation (geog2D
>         domain)",ID["EPSG",9606]],PARAMETER["X-axis
>         translation",0,ID["EPSG",8605]],PARAMETER["Y-axis
>         translation",0,ID["EPSG",8606]],PARAMETER["Z-axis
>         translation",0,ID["EPSG",8607]],PARAMETER["X-axis
>         rotation",0,ID["EPSG",8608]],PARAMETER["Y-axis
>         rotation",0,ID["EPSG",8609]],PARAMETER["Z-axis
>         rotation",0,ID["EPSG",8610]],PARAMETER["Scale
>         difference",1,ID["EPSG",8611]]]],BOUNDCRS[SOURCECRS[VERTCRS["CGVD28
>         height - HT2_0",VDATUM["Canadian Geodetic Vertical Datum of
>         1928"],CS[vertical,1],AXIS["gravity-related
>         height",up,LENGTHUNIT["metre",1]],ID["EPSG",5713]]],TARGETCRS[GEOGCRS["WGS
>         84",DATUM["World Geodetic System 1984",ELLIPSOID["WGS
>         84",6378137,298.257223563,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,3],AXIS["latitude",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["longitude",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],AXIS["ellipsoidal
>         height",up,ORDER[3],LENGTHUNIT["metre",1]],ID["EPSG",4979]]],ABRIDGEDTRANSFORMATION["CGVD28
>         height - HT2_0 to WGS84 ellipsoidal
>         height",METHOD["GravityRelatedHeight to
>         Geographic3D"],PARAMETERFILE["Geoid (height correction) model
>         file","HT2_0.gtx",ID["EPSG",8666]]]]]'
>
>           
>
>         Thanks in advance for any assistance!
>
>         Best regards,
>
>         Steve
>
>         Steve Riddell
>
>         Software Engineering
>
>         *GeoCue Group, Inc.*
>
>         520 6th Street | Madison, AL 35756 USA
>
>         *Phone:*256.461.8289 | *Fax:* 256.461.8249
>
>         /LIDAR/Drone Mapping Software & Services //? True View? 3D
>         Imaging Sensors //?Image/LIDAR Data Management Solutions/
>
>         www.geocue.com <http://www.geocue.com/>support.geocue.com
>         <https://support.geocue.com/>
>
>     -- 
>
>     http://www.spatialys.com
>
>     My software is free, but my time generally not.
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220324/87ccbf45/attachment-0001.html>

From erixen at cesium.com  Thu Mar 24 10:36:26 2022
From: erixen at cesium.com (Erixen Cruz)
Date: Thu, 24 Mar 2022 13:36:26 -0400
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
Message-ID: <CABG=M1Pb9E4mue1YtcDjDPCXfb=XL62y1v0K4g5AY=T-YX3z6w@mail.gmail.com>

>
> PROJ4_GRIDS provided a way to specify exactly which geoid file(s) to use.
> Some vertical datums, such as NAVD88, only have a single EPSG code for
> multiple geoids ? what?s the replacement for PROJ4_GRIDS in PROJ9?  If I
> could switch to WKT2 strings (not sure that?s really feasible) does it fix
> these problems?
>
>  WKT2 hardly helps for that.


There is one way to get WKT2 to do just this. Here's the start of the
thread about that:
https://lists.osgeo.org/pipermail/proj/2019-December/009142.html. TLDR you
use a BOUNDCRS with an ABRIDGEDTRANSFORMATION. Thanks again, Even, for
pointing us in this direction.

This is not ideal though. Like Even said, this (mis)use of BOUNDCRS doesn't
fit very cleanly in PROJ9 at the moment.

Sincerely, Erixen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220324/820aa9c8/attachment.html>

From even.rouault at spatialys.com  Thu Mar 24 10:54:44 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Mar 2022 18:54:44 +0100
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <CABG=M1Pb9E4mue1YtcDjDPCXfb=XL62y1v0K4g5AY=T-YX3z6w@mail.gmail.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
 <CABG=M1Pb9E4mue1YtcDjDPCXfb=XL62y1v0K4g5AY=T-YX3z6w@mail.gmail.com>
Message-ID: <1ae9d38a-c4d1-e9ef-8335-2ebee25fea1a@spatialys.com>


Le 24/03/2022 ? 18:36, Erixen Cruz a ?crit?:
>
>>     PROJ4_GRIDS provided a way to specify exactly which geoid file(s)
>>     to use.? Some vertical datums, such as NAVD88, only have a single
>>     EPSG code for multiple geoids ? what?s the replacement for
>>     PROJ4_GRIDS in PROJ9?? If I could switch to WKT2 strings (not
>>     sure that?s really feasible) does it fix these problems?
>>
>     ?WKT2 hardly helps for that.
>
>
> There is one way to get WKT2 to do just this. Here's the start of the 
> thread about that: 
> https://lists.osgeo.org/pipermail/proj/2019-December/009142.html. TLDR 
> you use a BOUNDCRS with an ABRIDGEDTRANSFORMATION. Thanks again, Even, 
> for pointing us in this direction.
>
> This is not ideal though. Like Even said, this (mis)use of BOUNDCRS 
> doesn't fit very cleanly in PROJ9 at the moment.

yeah, that can be used in PROJ (and that's exactly how a WKT1 with a 
TOWGS84 or PROJ4_GRIDS, or a PROJ.4 strings with 
+towgs84/+nadgrids/+geoidgrids end up being represented), but 
pedantically a BOUNDCRS[] is not a CRS. PROJ does accept is as a CRS 
(such as a COMPOUNDCRS of BOUNDCRS[]) because there was no other 
convenient way of modeling those legacy features in ISO19111:2019 / 
WKT2:2019, but this is an extension, and strictly conforming other 
implementations would reject that.

And the ABRIDGEDTRANSFORMATION[]? syntax cannot be used for vertical 
transformations where the geographic CRS would not be the interpolation CRS.


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220324/b08cef76/attachment.html>

From even.rouault at spatialys.com  Thu Mar 24 14:18:53 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Mar 2022 22:18:53 +0100
Subject: [PROJ] [gdal-dev]  OGRCreateCoordinateTransformation()
In-Reply-To: <1ae9d38a-c4d1-e9ef-8335-2ebee25fea1a@spatialys.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
 <CABG=M1Pb9E4mue1YtcDjDPCXfb=XL62y1v0K4g5AY=T-YX3z6w@mail.gmail.com>
 <1ae9d38a-c4d1-e9ef-8335-2ebee25fea1a@spatialys.com>
Message-ID: <699708be-972c-3e2a-b473-bba08089930f@spatialys.com>

Actually my below statement is not completely true
>
> And the ABRIDGEDTRANSFORMATION[]? syntax cannot be used for vertical 
> transformations where the geographic CRS would not be the 
> interpolation CRS.
>
https://github.com/OSGeo/PROJ/pull/3134 should improve this, by using 
the approach used in the EPSG database using a PARAMETER["EPSG code for 
Interpolation CRS",7886]

So something like below could be used to convey the interpolation CRS

BOUNDCRS[
 ??? SOURCECRS[
 ??????? VERTCRS["unknown",
 ??????????? VDATUM["unknown using geoidgrids=@foo.gtx"],
 ??????????? CS[vertical,1],
 ??????????????? AXIS["gravity-related height (H)",up,
 ??????????????????? LENGTHUNIT["metre",1,
 ??????????????????????? ID["EPSG",9001]]]]],
 ??? TARGETCRS[
 ??????? GEOGCRS["WGS 84",
 ??????????? DATUM["World Geodetic System 1984",
 ??????????????? ELLIPSOID["WGS 84",6378137,298.257223563,
 ??????????????????? LENGTHUNIT["metre",1]]],
 ??????????? PRIMEM["Greenwich",0,
 ??????????????? ANGLEUNIT["degree",0.0174532925199433]],
 ??????????? CS[ellipsoidal,3],
 ??????????????? AXIS["latitude",north,
 ??????????????????? ORDER[1],
 ??????????????????? ANGLEUNIT["degree",0.0174532925199433]],
 ??????????????? AXIS["longitude",east,
 ??????????????????? ORDER[2],
 ??????????????????? ANGLEUNIT["degree",0.0174532925199433]],
 ??????????????? AXIS["ellipsoidal height",up,
 ??????????????????? ORDER[3],
 ??????????????????? LENGTHUNIT["metre",1]],
 ??????????? ID["EPSG",4979]]],
 ??? ABRIDGEDTRANSFORMATION["unknown to WGS84 ellipsoidal height",
 ??????? METHOD["GravityRelatedHeight to Geographic3D"],
 ??????? PARAMETERFILE["Geoid (height correction) model file","@foo.gtx",
 ??????????? ID["EPSG",8666]],
 ??????? PARAMETER["EPSG code for Interpolation CRS",7886]]]

Even

>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sriddell at geocue.com  Mon Mar 28 11:37:08 2022
From: sriddell at geocue.com (Steve Riddell)
Date: Mon, 28 Mar 2022 18:37:08 +0000
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
Message-ID: <BN6PR01MB2404D7E7315F6F52B450745AA61D9@BN6PR01MB2404.prod.exchangelabs.com>

Hi Even,
Sorry for the delay, but I?ve now tested with PR3216, alone, and then with PR3127.  I?m getting the same behavior as I reported below.   Perhaps my best chance at getting this to work is to either directly make proj calls, or construct the pipeline myself and pass through gdal?
Steve


From: Even Rouault <even.rouault at spatialys.com>
Sent: Thursday, March 24, 2022 10:50 AM
To: Steve Riddell <sriddell at geocue.com>; proj <proj at lists.osgeo.org>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: OGRCreateCoordinateTransformation()


Steve,

(adding proj mailing list since it's actually purely a PROJ topic


Does the fact that there isn?t a consensus mean 3126 & 3127 aren?t going to end up in a PROJ release?



Did you try them to confirm they help ? Maybe if you want to weight in the PRs (if they actually help) that could change the balance.

I read through the PR?s. Are you thinking my issue is that a vertical shift is being introduced because of a transformation to WGS84 (from NAD83(CSRS)) to look up the geoid separation value?
That's probably an issue with the wrong interpolation CRS being used, but I can't generally predict how this complex code works without launching a debugger and step-by-step tracing what happens.


PROJ4_GRIDS provided a way to specify exactly which geoid file(s) to use.  Some vertical datums, such as NAVD88, only have a single EPSG code for multiple geoids ? what?s the replacement for PROJ4_GRIDS in PROJ9?  If I could switch to WKT2 strings (not sure that?s really feasible) does it fix these problems?
WKT2 hardly helps for that. The closest equivalent is the GEOIDMODEL[] sub node of a VERTCRS[] (http://docs.opengeospatial.org/is/18-010r7/18-010r7.html#83). But that's something that refer to an existing transformation . And in a VRTCRS[] you can actually have several GEOIDMODEL[] listed (e.g. for NAVD88, all the geoid models), since that's more a definition of the VertCRS than which particular geoid model to use. So that's not nominally appropriate for a "random" grid not known of PROJ, although we have a bit bent the concept to allow a GEOIDMODEL["PROJ name_of_the_grid_dot_tif_or_gtx"]. But I would suspect that in that situation the ambiguity with the geographic / interpolation CRS to use would be similar to WKT1 PROJ4_GRIDS.


Thanks,
steve

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, March 23, 2022 6:06 PM
To: Steve Riddell <sriddell at geocue.com><mailto:sriddell at geocue.com>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: OGRCreateCoordinateTransformation()


Steve,

you may try PR https://github.com/OSGeo/PROJ/pull/3126 or https://github.com/OSGeo/PROJ/pull/3127, that might potentially help, but they don't make consensus (see discussions of those PRs). Basically it is a nightmare to deal with the old TOWGS84 / PROJ4_GRIDS approach, that poorly specifies some elements of transformations (especially the vertical part), and doesn't fit well in the ISO-19111 model used by newer PROJ (we use and abuse the BoundCRS approach in complex ways). One of the issue too is that we've realized late in the process that we didn't emulate some aspects of the old transformation pipeline, and there isn't general enthusiasm to change that now.

Even
Le 23/03/2022 ? 23:42, Steve Riddell a ?crit :
Hi Even,

I tried the fix with the CRS?s I sent, and it worked. But as I mentioned, my real target CRS is a custom projected system (below), and it still fails with what seems to be the same error as in my original email.

COMPD_CS["TempTM + CGVD28 height - HT2_0",
    PROJCS["Custom",
        GEOGCS["NAD83(CSRS)",
            DATUM["NAD83_Canadian_Spatial_Reference_System",
                SPHEROID["GRS 1980",6378137,298.257222101,
                    AUTHORITY["EPSG","7019"]],
                TOWGS84[0,0,0,0,0,0,0],
                AUTHORITY["EPSG","6140"]],
            PRIMEM["Greenwich",0,
                AUTHORITY["EPSG","8901"]],
            UNIT["degree",0.0174532925199433,
                AUTHORITY["EPSG","9122"]],
            AUTHORITY["EPSG","4617"]],
        PROJECTION["Transverse_Mercator"],
        PARAMETER["latitude_of_origin",49.351346659616],
        PARAMETER["central_meridian",-123.20266499149],
        PARAMETER["scale_factor",1],
        PARAMETER["false_easting",15307.188],
        PARAMETER["false_northing",6540.975],
        UNIT["Meters",1],
        AXIS["Easting",EAST],
        AXIS["Northing",NORTH]],
    VERT_CS["CGVD28 height - HT2_0",
        VERT_DATUM["Canadian Geodetic Vertical Datum of 1928",2005,
            EXTENSION["PROJ4_GRIDS","HT2_0.gtx"],
            AUTHORITY["EPSG","5114"]],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["Gravity-related height",UP],
        AUTHORITY["EPSG","5713"]]]

Experimenting, I removed the ?TOWGS84? directive from BOTH the source and target systems, and I do get an answer instead of an error:

For test point: (49.351346658, -123.202664992, 289.809)
I get: (15307.1880,6540.9748,307.744)

But since geoid separation at the test point is -18.238, Z should be 308.047.  In fact, if I code up the following pipeline and initialize a transform object:

strPipe = "+proj=pipeline\
        +step +proj=axisswap +order=2, 1\
        +step +proj=unitconvert +xy_in=deg +xy_out=rad\
        +step +inv +proj=vgridshift +grids=HT2_0.gtx +multiplier=1\
        +step +proj=tmerc +lat_0=49.351346659616 +lon_0=-123.20266499149 +k=1\
        +x_0=15307.188 +y_0=6540.975 +ellps=GRS80";

The call to Transform() gives: (15307.1880, 6540.9748, 308.042)   -- XY matches above, but now I get the expected Z (-0.005).  However, I?d like to avoid assembling pipelines for every conversion/transform.

Any arrows left in your quiver?

Thanks,
Steve



From: Steve Riddell
Sent: Friday, March 18, 2022 6:17 PM
To: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: RE: OGRCreateCoordinateTransformation()

Thanks very much, Even.  For reporting the problem, I ?packaged up? a case with CRS?s with EPGS codes. For the actual problem I?m working, the target CRS is a custom projection ?no EPSG.

From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Sent: Friday, March 18, 2022 5:05 PM
To: Steve Riddell <sriddell at geocue.com<mailto:sriddell at geocue.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: OGRCreateCoordinateTransformation()


Steve,

Fix in PROJ queued in https://github.com/OSGeo/PROJ/pull/3123

The complexity of dealing with legacy features TOWGS84[] and PROJ4_GRIDS is highly stressing PROJ pipeline computation engine.

Using the plain EPSG codes  EPSG:4955 -> EPSG:4617+5713 would be much preferable here

Even
Le 18/03/2022 ? 21:14, Steve Riddell a ?crit :
Hi,

I?m getting an error (below) using GDAL trying to set up a transformation between NAD83(CSRS) geodetic, w/ ellipsoidal heights, and NAD83(CSRS) geodetic, CGVD28 heights. Similar transformations work fine on some datums,  but fail on others.  Hope someone can offer some insight.  Note the if I don't use the PROJ4_GRIDS extension, I don't get the error, but I don't get the geoid adjustment either.

COMPD_CS["NAD83(CSRS) + Ellipsoid (Meters)",
    GEOGCS["NAD83(CSRS)",
        DATUM["NAD83_Canadian_Spatial_Reference_System",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6140"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4617"]],
    VERT_CS["Ellipsoid (Meters)",
        VERT_DATUM["Ellipsoid",2002],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["ellipsoidal height",UP]]]

COMPD_CS["NAD83(CSRS) + CGVD28 height - HT2_0",
    GEOGCS["NAD83(CSRS)",
        DATUM["NAD83_Canadian_Spatial_Reference_System",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6140"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4617"]],
    VERT_CS["CGVD28 height - HT2_0",
        VERT_DATUM["Canadian Geodetic Vertical Datum of 1928",2005,
            EXTENSION["PROJ4_GRIDS","HT2_0.gtx"],
            AUTHORITY["EPSG","5114"]],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["Gravity-related height",UP],
        AUTHORITY["EPSG","5713"]]]


ERROR 6: Cannot find coordinate operations from `EPSG:4955' to `COMPOUNDCRS["NAD83(CSRS) + CGVD28 height - HT2_0",BOUNDCRS[SOURCECRS[GEOGCRS["NAD83(CSRS)",DATUM["NAD83 Canadian Spatial Reference System",ELLIPSOID["GRS 1980",6378137,298.257222101,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,2],AXIS["geodetic latitude (Lat)",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["geodetic longitude (Lon)",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4617]]],TARGETCRS[GEOGCRS["WGS 84",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,2],AXIS["latitude",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["longitude",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]]],ABRIDGEDTRANSFORMATION["Transformation from NAD83(CSRS) to WGS84",METHOD["Position Vector transformation (geog2D domain)",ID["EPSG",9606]],PARAMETER["X-axis translation",0,ID["EPSG",8605]],PARAMETER["Y-axis translation",0,ID["EPSG",8606]],PARAMETER["Z-axis translation",0,ID["EPSG",8607]],PARAMETER["X-axis rotation",0,ID["EPSG",8608]],PARAMETER["Y-axis rotation",0,ID["EPSG",8609]],PARAMETER["Z-axis rotation",0,ID["EPSG",8610]],PARAMETER["Scale difference",1,ID["EPSG",8611]]]],BOUNDCRS[SOURCECRS[VERTCRS["CGVD28 height - HT2_0",VDATUM["Canadian Geodetic Vertical Datum of 1928"],CS[vertical,1],AXIS["gravity-related height",up,LENGTHUNIT["metre",1]],ID["EPSG",5713]]],TARGETCRS[GEOGCRS["WGS 84",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,3],AXIS["latitude",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["longitude",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],AXIS["ellipsoidal height",up,ORDER[3],LENGTHUNIT["metre",1]],ID["EPSG",4979]]],ABRIDGEDTRANSFORMATION["CGVD28 height - HT2_0 to WGS84 ellipsoidal height",METHOD["GravityRelatedHeight to Geographic3D"],PARAMETERFILE["Geoid (height correction) model file","HT2_0.gtx",ID["EPSG",8666]]]]]'



Thanks in advance for any assistance!

Best regards,

Steve



Steve Riddell
Software Engineering
GeoCue Group, Inc.
520 6th Street | Madison, AL 35756 USA
Phone: 256.461.8289 | Fax: 256.461.8249
LIDAR/Drone Mapping Software & Services ? True View? 3D Imaging Sensors ? Image/LIDAR Data Management Solutions
 www.geocue.com<http://www.geocue.com/>  support.geocue.com<https://support.geocue.com/>





--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220328/fd7290bd/attachment-0001.html>

From even.rouault at spatialys.com  Mon Mar 28 13:15:01 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Mar 2022 22:15:01 +0200
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <BN6PR01MB2404D7E7315F6F52B450745AA61D9@BN6PR01MB2404.prod.exchangelabs.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
 <BN6PR01MB2404D7E7315F6F52B450745AA61D9@BN6PR01MB2404.prod.exchangelabs.com>
Message-ID: <548ada2a-f1b0-b17c-191f-c62003779d7b@spatialys.com>

Steve,

> Sorry for the delay, but I?ve now tested with PR3216, alone, and then 
> with PR3127.? I?m getting the same behavior as I reported below.? 
> ?Perhaps my best chance at getting this to work is to either directly 
> make proj calls, or construct the pipeline myself and pass through gdal?
>
That was indeed an entirely different issue. Fix queued in 
https://github.com/OSGeo/PROJ/pull/3147

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220328/1152e4cf/attachment.html>

From sriddell at geocue.com  Mon Mar 28 14:02:44 2022
From: sriddell at geocue.com (Steve Riddell)
Date: Mon, 28 Mar 2022 21:02:44 +0000
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <548ada2a-f1b0-b17c-191f-c62003779d7b@spatialys.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
 <BN6PR01MB2404D7E7315F6F52B450745AA61D9@BN6PR01MB2404.prod.exchangelabs.com>
 <548ada2a-f1b0-b17c-191f-c62003779d7b@spatialys.com>
Message-ID: <BN6PR01MB240475B478471A0E9C641FA3A61D9@BN6PR01MB2404.prod.exchangelabs.com>

Hi Even,
It?s working now, for my two test cases, --- as long as there?s a TOWGS84[0, 0, 0, 0, 0, 0, 0] field in the WKT w/ the geoid grid. I?m guessing that ties the grid to the datum/geogcs of the containing compound CRS?
Thanks!
Steve

From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, March 28, 2022 3:15 PM
To: Steve Riddell <sriddell at geocue.com>; proj <proj at lists.osgeo.org>
Cc: Suresh Jakka <sjakka at geocue.com>
Subject: Re: OGRCreateCoordinateTransformation()


Steve,
Sorry for the delay, but I?ve now tested with PR3216, alone, and then with PR3127.  I?m getting the same behavior as I reported below.   Perhaps my best chance at getting this to work is to either directly make proj calls, or construct the pipeline myself and pass through gdal?

That was indeed an entirely different issue. Fix queued in https://github.com/OSGeo/PROJ/pull/3147

Even
--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220328/78586d0d/attachment.html>

From even.rouault at spatialys.com  Mon Mar 28 14:07:24 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Mar 2022 23:07:24 +0200
Subject: [PROJ] OGRCreateCoordinateTransformation()
In-Reply-To: <BN6PR01MB240475B478471A0E9C641FA3A61D9@BN6PR01MB2404.prod.exchangelabs.com>
References: <BN6PR01MB2404FCA6CCDEA6EC80A54C1DA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <d252d733-fd7d-bf6a-9ea4-b87577281b08@spatialys.com>
 <BN6PR01MB2404EB72D07D505A7311929AA6139@BN6PR01MB2404.prod.exchangelabs.com>
 <CY4PR01MB2406A2CE96E342DD7E5D795FA6189@CY4PR01MB2406.prod.exchangelabs.com>
 <69912c61-97a2-c404-9280-2ed71298af37@spatialys.com>
 <BN6PR01MB2404D77116699E1C7F55B982A6199@BN6PR01MB2404.prod.exchangelabs.com>
 <79889ab4-7ae3-7395-4fa8-117f5cb61859@spatialys.com>
 <BN6PR01MB2404D7E7315F6F52B450745AA61D9@BN6PR01MB2404.prod.exchangelabs.com>
 <548ada2a-f1b0-b17c-191f-c62003779d7b@spatialys.com>
 <BN6PR01MB240475B478471A0E9C641FA3A61D9@BN6PR01MB2404.prod.exchangelabs.com>
Message-ID: <22dc6aa9-6469-73ef-2861-0ab5e216055c@spatialys.com>


Le 28/03/2022 ? 23:02, Steve Riddell a ?crit?:
>
> Hi Even,
>
> It?s working now, for my two test cases, --- as long as there?s a 
> TOWGS84[0, 0, 0, 0, 0, 0, 0] field in the WKT w/ the geoid grid. I?m 
> guessing that ties the grid to the datum/geogcs of the containing 
> compound CRS?
>
yes. That works also for me if there's no TOWGS84[], but then PROJ will 
issue a more complicated pipeline doing a non-null horizontal datum 
shift from NAD83(CSRS) to WGS 84, since (without PR3216/3217), it 
assumes that the vertical grid is referenced to WGS 84.
>
> Thanks!
> Steve
>
> *From:* Even Rouault <even.rouault at spatialys.com>
> *Sent:* Monday, March 28, 2022 3:15 PM
> *To:* Steve Riddell <sriddell at geocue.com>; proj <proj at lists.osgeo.org>
> *Cc:* Suresh Jakka <sjakka at geocue.com>
> *Subject:* Re: OGRCreateCoordinateTransformation()
>
> Steve,
>
>     Sorry for the delay, but I?ve now tested with PR3216, alone, and
>     then with PR3127.? I?m getting the same behavior as I reported
>     below.? ?Perhaps my best chance at getting this to work is to
>     either directly make proj calls, or construct the pipeline myself
>     and pass through gdal?
>
> That was indeed an entirely different issue. Fix queued in 
> https://github.com/OSGeo/PROJ/pull/3147
>
> Even
>
> -- 
>
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20220328/f74ba843/attachment.html>

