From charles.karney at gmail.com  Fri Mar  1 02:30:48 2024
From: charles.karney at gmail.com (Charles Karney)
Date: Fri, 1 Mar 2024 05:30:48 -0500
Subject: [PROJ] PROJ 9.4.0RC1 & PROJ-data 1.17RC1
In-Reply-To: <CAGybdFSkvFMj05NgTkQJKzBw4Udb0Pq81ZuOoKUCdAA+hb3gAA@mail.gmail.com>
References: <038B89B2-C56C-477E-B49B-A287B0A1133B@gmail.com>
 <430C18F1-A4A6-41A9-B685-E2042C974EE6@gmail.com>
 <CAH0YoEN3S4fqz-2fyOi6Kc+pUbZewx63JzVzEERcC8pFu4o5ag@mail.gmail.com>
 <CAGybdFSkvFMj05NgTkQJKzBw4Udb0Pq81ZuOoKUCdAA+hb3gAA@mail.gmail.com>
Message-ID: <fe1c7176-fcd7-4cac-ab39-f2399cd74d27@alum.mit.edu>

+1 Charles

On 2/29/24 21:32, Alan Snow via PROJ wrote:
> +1 Alan
> 
> On Thu, Feb 29, 2024, 1:15 PM Thomas Knudsen via PROJ 
> <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>> wrote:
> 
>     +1 /Thomas
> 
>     Den tors. 29. feb. 2024 kl. 18.50 skrev Kristian Evers via PROJ
>     <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>>:
> 
>         PSC Members,
> 
>         Apart from the bonus files from my Mac having found their way
>         into PROJ-data release candidates 1-3 no problems with the
>         release candidates seem to have been reported. With PROJ-data
>         1.17-RC4 being okay I motion that both the PROJ and PROJ-data
>         release candidates be promoted to final versions.
> 
>         I?ll start with my +1
> 
>         /Kristian
> 
>          > On 26 Feb 2024, at 17.29, Kristian Evers
>         <kristianevers at gmail.com <mailto:kristianevers at gmail.com>> wrote:
>          >
>          > All,
>          >
>          > in preparation for a new round of PROJ and PROJ-data release
>         I have uploaded release candidates for both packages.
>          >
>          > Download the archives here:
>          >
>          > https://download.osgeo.org/proj/proj-9.4.0RC1.tar.gz
>         <https://download.osgeo.org/proj/proj-9.4.0RC1.tar.gz>
>          > https://download.osgeo.org/proj/proj-9.4.0RC1.zip
>         <https://download.osgeo.org/proj/proj-9.4.0RC1.zip>
>          >
>          > https://download.osgeo.org/proj/proj-data-1.17RC1.tar.gz
>         <https://download.osgeo.org/proj/proj-data-1.17RC1.tar.gz>
>          > https://download.osgeo.org/proj/proj-data-1.17RC1.zip
>         <https://download.osgeo.org/proj/proj-data-1.17RC1.zip>
>          >
>          > The PROJ release includes various updates and bug fixes. See
>         the release notes below.
>          >
>          > The PROJ-data release comes with the following changes:
>          >
>          > * New revisions of chartdatum Norway v2023b
>          > * Added fr_ign_RAC23.tif grid for France-Corsica NGF-IGN 1978
>         to RGF93-2b
>          > * New DVR90 grids added to reflect recent EPSG-changes that
>         now supports all realizations of the Danish height system
>          > * Added Czech geoid model CR-2005
>          > * Added Portuguese geoid model GeodPT08
>          >
>          > Please test the release candidates and report any issues you
>         may find with them.
>          > Either here on the mailing list or on GitHub.
>          >
>          > /Kristian
>          >
>          > ?????????????
>          >
>          > 9.4.0 Release Notes
>          > -------------------
>          >
>          > Updates
>          > -------
>          >
>          > o Add support for transformations involving coordinate epoch
>         changes
>          >? ?(PointMotionOperation), specifically for Canadian
>         NAD83(CSRS)(#3884)
>          >
>          > o SSL_OPTIONS: set SSL options on Curl library (#3936)
>          >
>          > o Add support for unity builds (#3962)
>          >
>          > o Added ability to install *.tif if present in data (#3970)
>          >
>          > o createOperationsCompoundToGeog(): tune selection logic
>          >? ?when --grid-check known_available is specified (#3990)
>          >
>          > o Increase CMake minimum version from 3.9 to 3.16 (#3997)
>          >
>          > o CMake: use FetchContent to get googletest-1.12.1 (#4006)
>          >
>          > o CMake: Replace custom FindSqlite3 with FindSQLite3 built-in
>         (#4007)
>          >
>          > o tpeqd: use numerically stable formula for computing the
>         central angle
>          >? ?from (phi_1, lam_1) to (phi_2, lam_2) (#4009)
>          >
>          > o Move content of proj_experimental.h to proj.h (#4019)
>          >
>          > o Add +proj=mod_krovak projection method for Modified Krovak that
>          >? ?applies to S-JTSK/05 in the Czech Republic (#4021)
>          >
>          > o PROJString formatter optimizer: simplify pipelines doing
>          >? ?[Modified]Krovak (South West) <--> [Modified]Krovak (East
>         North)
>          >? ?by just doing an axis swap (#4034)
>          >
>          > o +proj=gridshift: enhance to support grids referenced in
>         projected CRS,
>          >? ?and with easting_offset/northing_offset corrections (#4038)
>          >
>          > o Tune concatenated operation instanciation, reference CR2005
>         geoid for
>          >? ?Czechia and add (disabled by default) records for Czechia
>         S-JTSK/05 based
>          >? ?transformations (#4044)
>          >
>          > o Database: update to EPSG v11.004 (#4062)
>          >
>          > Bug fixes
>          > ---------
>          >
>          > o Fix missing symbols at link time for Windows target in
>         Visual Studio (#3984)
>          >
>          > o Improve error message in axisswap (#3975)
>          >
>          > o Avoid convergence errors in +proj=gridshift when using
>         biquadratic
>          >? ? interpolation (#3985)
>          >
> 
>         _______________________________________________
>         PROJ mailing list
>         PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>         https://lists.osgeo.org/mailman/listinfo/proj
>         <https://lists.osgeo.org/mailman/listinfo/proj>
> 
>     _______________________________________________
>     PROJ mailing list
>     PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/proj
>     <https://lists.osgeo.org/mailman/listinfo/proj>
> 
> 
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
Charles Karney <karney at alum.mit.edu>
702 Prospect Ave
Princeton, NJ 08540-4037

From kristianevers at gmail.com  Fri Mar  1 08:11:57 2024
From: kristianevers at gmail.com (Kristian Evers)
Date: Fri, 1 Mar 2024 17:11:57 +0100
Subject: [PROJ] PROJ 9.4.0RC1 & PROJ-data 1.17RC1
In-Reply-To: <fe1c7176-fcd7-4cac-ab39-f2399cd74d27@alum.mit.edu>
References: <038B89B2-C56C-477E-B49B-A287B0A1133B@gmail.com>
 <430C18F1-A4A6-41A9-B685-E2042C974EE6@gmail.com>
 <CAH0YoEN3S4fqz-2fyOi6Kc+pUbZewx63JzVzEERcC8pFu4o5ag@mail.gmail.com>
 <CAGybdFSkvFMj05NgTkQJKzBw4Udb0Pq81ZuOoKUCdAA+hb3gAA@mail.gmail.com>
 <fe1c7176-fcd7-4cac-ab39-f2399cd74d27@alum.mit.edu>
Message-ID: <4552C9A3-07DE-494A-A8B5-3B55F5F13A74@gmail.com>

I declare the motion passed with +1?s from

Kristian
Even
Thomas
Javier
Alan
Charles

Expect a release announcement within the next couple of hours.

/Kristian



> On 1 Mar 2024, at 11.30, Charles Karney via PROJ <proj at lists.osgeo.org> wrote:
> 
> +1 Charles
> 
> On 2/29/24 21:32, Alan Snow via PROJ wrote:
>> +1 Alan
>> On Thu, Feb 29, 2024, 1:15 PM Thomas Knudsen via PROJ <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>> wrote:
>>    +1 /Thomas
>>    Den tors. 29. feb. 2024 kl. 18.50 skrev Kristian Evers via PROJ
>>    <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>>:
>>        PSC Members,
>>        Apart from the bonus files from my Mac having found their way
>>        into PROJ-data release candidates 1-3 no problems with the
>>        release candidates seem to have been reported. With PROJ-data
>>        1.17-RC4 being okay I motion that both the PROJ and PROJ-data
>>        release candidates be promoted to final versions.
>>        I?ll start with my +1
>>        /Kristian
>>         > On 26 Feb 2024, at 17.29, Kristian Evers
>>        <kristianevers at gmail.com <mailto:kristianevers at gmail.com>> wrote:
>>         >
>>         > All,
>>         >
>>         > in preparation for a new round of PROJ and PROJ-data release
>>        I have uploaded release candidates for both packages.
>>         >
>>         > Download the archives here:
>>         >
>>         > https://download.osgeo.org/proj/proj-9.4.0RC1.tar.gz
>>        <https://download.osgeo.org/proj/proj-9.4.0RC1.tar.gz>
>>         > https://download.osgeo.org/proj/proj-9.4.0RC1.zip
>>        <https://download.osgeo.org/proj/proj-9.4.0RC1.zip>
>>         >
>>         > https://download.osgeo.org/proj/proj-data-1.17RC1.tar.gz
>>        <https://download.osgeo.org/proj/proj-data-1.17RC1.tar.gz>
>>         > https://download.osgeo.org/proj/proj-data-1.17RC1.zip
>>        <https://download.osgeo.org/proj/proj-data-1.17RC1.zip>
>>         >
>>         > The PROJ release includes various updates and bug fixes. See
>>        the release notes below.
>>         >
>>         > The PROJ-data release comes with the following changes:
>>         >
>>         > * New revisions of chartdatum Norway v2023b
>>         > * Added fr_ign_RAC23.tif grid for France-Corsica NGF-IGN 1978
>>        to RGF93-2b
>>         > * New DVR90 grids added to reflect recent EPSG-changes that
>>        now supports all realizations of the Danish height system
>>         > * Added Czech geoid model CR-2005
>>         > * Added Portuguese geoid model GeodPT08
>>         >
>>         > Please test the release candidates and report any issues you
>>        may find with them.
>>         > Either here on the mailing list or on GitHub.
>>         >
>>         > /Kristian
>>         >
>>         > ?????????????
>>         >
>>         > 9.4.0 Release Notes
>>         > -------------------
>>         >
>>         > Updates
>>         > -------
>>         >
>>         > o Add support for transformations involving coordinate epoch
>>        changes
>>         >   (PointMotionOperation), specifically for Canadian
>>        NAD83(CSRS)(#3884)
>>         >
>>         > o SSL_OPTIONS: set SSL options on Curl library (#3936)
>>         >
>>         > o Add support for unity builds (#3962)
>>         >
>>         > o Added ability to install *.tif if present in data (#3970)
>>         >
>>         > o createOperationsCompoundToGeog(): tune selection logic
>>         >   when --grid-check known_available is specified (#3990)
>>         >
>>         > o Increase CMake minimum version from 3.9 to 3.16 (#3997)
>>         >
>>         > o CMake: use FetchContent to get googletest-1.12.1 (#4006)
>>         >
>>         > o CMake: Replace custom FindSqlite3 with FindSQLite3 built-in
>>        (#4007)
>>         >
>>         > o tpeqd: use numerically stable formula for computing the
>>        central angle
>>         >   from (phi_1, lam_1) to (phi_2, lam_2) (#4009)
>>         >
>>         > o Move content of proj_experimental.h to proj.h (#4019)
>>         >
>>         > o Add +proj=mod_krovak projection method for Modified Krovak that
>>         >   applies to S-JTSK/05 in the Czech Republic (#4021)
>>         >
>>         > o PROJString formatter optimizer: simplify pipelines doing
>>         >   [Modified]Krovak (South West) <--> [Modified]Krovak (East
>>        North)
>>         >   by just doing an axis swap (#4034)
>>         >
>>         > o +proj=gridshift: enhance to support grids referenced in
>>        projected CRS,
>>         >   and with easting_offset/northing_offset corrections (#4038)
>>         >
>>         > o Tune concatenated operation instanciation, reference CR2005
>>        geoid for
>>         >   Czechia and add (disabled by default) records for Czechia
>>        S-JTSK/05 based
>>         >   transformations (#4044)
>>         >
>>         > o Database: update to EPSG v11.004 (#4062)
>>         >
>>         > Bug fixes
>>         > ---------
>>         >
>>         > o Fix missing symbols at link time for Windows target in
>>        Visual Studio (#3984)
>>         >
>>         > o Improve error message in axisswap (#3975)
>>         >
>>         > o Avoid convergence errors in +proj=gridshift when using
>>        biquadratic
>>         >    interpolation (#3985)
>>         >
>>        _______________________________________________
>>        PROJ mailing list
>>        PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>>        https://lists.osgeo.org/mailman/listinfo/proj
>>        <https://lists.osgeo.org/mailman/listinfo/proj>
>>    _______________________________________________
>>    PROJ mailing list
>>    PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>>    https://lists.osgeo.org/mailman/listinfo/proj
>>    <https://lists.osgeo.org/mailman/listinfo/proj>
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj
> 
> -- 
> Charles Karney <karney at alum.mit.edu>
> 702 Prospect Ave
> Princeton, NJ 08540-4037
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj


From kristianevers at gmail.com  Fri Mar  1 09:21:01 2024
From: kristianevers at gmail.com (Kristian Evers)
Date: Fri, 1 Mar 2024 18:21:01 +0100
Subject: [PROJ] PROJ 9.4.0 & PROJ-data 1.17
Message-ID: <35306D70-863E-409A-9913-B9E6B3E412C7@gmail.com>

I'm happy to announce the release of PROJ 9.4.0 and PROJ-data 1.17!

The PROJ release includes a number of updates to the both functionality and
the database contents, as well as a few bug fixes. See the release notes
below.

The PROJ-data release includes the following updates:

* New revisions of chartdatum Norway v2023b
* Added fr_ign_RAC23.tif grid for France-Corsica NGF-IGN 1978 to RGF93-2b
* New DVR90 grids added to reflect recent EPSG-changes that now supports all realizations of the Danish height system
* Added Czech geoid model CR-2005

Download the archives here:

https://download.osgeo.org/proj/proj-9.4.0.tar.gz
https://download.osgeo.org/proj/proj-9.4.0.zip

https://download.osgeo.org/proj/proj-data-1.17.tar.gz
https://download.osgeo.org/proj/proj-data-1.17.zip

/Kristian

??????????????????????

9.4.0 Release Notes
-------------------

Updates
-------

o Add support for transformations involving coordinate epoch changes
  (PointMotionOperation), specifically for Canadian NAD83(CSRS)(#3884)

o SSL_OPTIONS: set SSL options on Curl library (#3936)

o Add support for unity builds (#3962)

o Added ability to install *.tif if present in data (#3970)

o createOperationsCompoundToGeog(): tune selection logic
  when --grid-check known_available is specified (#3990)

o Increase CMake minimum version from 3.9 to 3.16 (#3997)

o CMake: use FetchContent to get googletest-1.12.1 (#4006)

o CMake: Replace custom FindSqlite3 with FindSQLite3 built-in (#4007)

o tpeqd: use numerically stable formula for computing the central angle
  from (phi_1, lam_1) to (phi_2, lam_2) (#4009)

o Move content of proj_experimental.h to proj.h (#4019)

o Add +proj=mod_krovak projection method for Modified Krovak that
  applies to S-JTSK/05 in the Czech Republic (#4021)

o PROJString formatter optimizer: simplify pipelines doing
  [Modified]Krovak (South West) <--> [Modified]Krovak (East North)
  by just doing an axis swap (#4034)

o +proj=gridshift: enhance to support grids referenced in projected CRS,
  and with easting_offset/northing_offset corrections (#4038)

o Tune concatenated operation instanciation, reference CR2005 geoid for
  Czechia and add (disabled by default) records for Czechia S-JTSK/05 based
  transformations (#4044)

o Database: update to EPSG v11.004 (#4062)

Bug fixes
---------

o Fix missing symbols at link time for Windows target in Visual Studio (#3984)

o Improve error message in axisswap (#3975)

o Avoid convergence errors in +proj=gridshift when using biquadratic
   interpolation (#3985)

From j1 at jimenezshaw.com  Fri Mar  1 12:29:21 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Fri, 1 Mar 2024 21:29:21 +0100
Subject: [PROJ] PROJ 9.4.0 & PROJ-data 1.17
In-Reply-To: <35306D70-863E-409A-9913-B9E6B3E412C7@gmail.com>
References: <35306D70-863E-409A-9913-B9E6B3E412C7@gmail.com>
Message-ID: <CADRrdKsixain3ViSiqXZsti2rEP4F5wnxtT1zdkC4rYdOS3m6w@mail.gmail.com>

Thank you Kristian!

https://crs-explorer.proj.org/ and https://spatialreference.org/ were also
updated to PROJ 9.4.0
Related to that, there is a trick to inspect the changes in EPSG between
PROJ releases: Check the changes in the file "crslist.json"
In this case in this commit: (load the diff of crslist.json. It is quite
large)
https://github.com/OSGeo/PROJ-CRS-Explorer/commit/99f808ad37c752b25b4d2d5bda9b3d472d578dfc
(Having those tags of crslist.json in GitHub, the webpage allows you to go
back up to PROJ 8.2.1 with a combo-box)

Yes, the diff can be large, specially if they change an area of use that
affects many CRSs. But I find useful to see the added CRSs, or some other
changes.
This time I found a few new German systems that I was not expecting (but I
was missing ;)

Notice that this is only about CRS defintions, not about transformations.

Cheers,
Javier.

PS. PROJ-data 1.17 also adds the Portuguese geoid model GeodPT08

On Fri, 1 Mar 2024 at 18:21, Kristian Evers via PROJ <proj at lists.osgeo.org>
wrote:

> I'm happy to announce the release of PROJ 9.4.0 and PROJ-data 1.17!
>
> The PROJ release includes a number of updates to the both functionality and
> the database contents, as well as a few bug fixes. See the release notes
> below.
>
> The PROJ-data release includes the following updates:
>
> * New revisions of chartdatum Norway v2023b
> * Added fr_ign_RAC23.tif grid for France-Corsica NGF-IGN 1978 to RGF93-2b
> * New DVR90 grids added to reflect recent EPSG-changes that now supports
> all realizations of the Danish height system
> * Added Czech geoid model CR-2005
>
> Download the archives here:
>
> https://download.osgeo.org/proj/proj-9.4.0.tar.gz
> https://download.osgeo.org/proj/proj-9.4.0.zip
>
> https://download.osgeo.org/proj/proj-data-1.17.tar.gz
> https://download.osgeo.org/proj/proj-data-1.17.zip
>
> /Kristian
>
> ??????????????????????
>
> 9.4.0 Release Notes
> -------------------
>
> Updates
> -------
>
> o Add support for transformations involving coordinate epoch changes
>   (PointMotionOperation), specifically for Canadian NAD83(CSRS)(#3884)
>
> o SSL_OPTIONS: set SSL options on Curl library (#3936)
>
> o Add support for unity builds (#3962)
>
> o Added ability to install *.tif if present in data (#3970)
>
> o createOperationsCompoundToGeog(): tune selection logic
>   when --grid-check known_available is specified (#3990)
>
> o Increase CMake minimum version from 3.9 to 3.16 (#3997)
>
> o CMake: use FetchContent to get googletest-1.12.1 (#4006)
>
> o CMake: Replace custom FindSqlite3 with FindSQLite3 built-in (#4007)
>
> o tpeqd: use numerically stable formula for computing the central angle
>   from (phi_1, lam_1) to (phi_2, lam_2) (#4009)
>
> o Move content of proj_experimental.h to proj.h (#4019)
>
> o Add +proj=mod_krovak projection method for Modified Krovak that
>   applies to S-JTSK/05 in the Czech Republic (#4021)
>
> o PROJString formatter optimizer: simplify pipelines doing
>   [Modified]Krovak (South West) <--> [Modified]Krovak (East North)
>   by just doing an axis swap (#4034)
>
> o +proj=gridshift: enhance to support grids referenced in projected CRS,
>   and with easting_offset/northing_offset corrections (#4038)
>
> o Tune concatenated operation instanciation, reference CR2005 geoid for
>   Czechia and add (disabled by default) records for Czechia S-JTSK/05 based
>   transformations (#4044)
>
> o Database: update to EPSG v11.004 (#4062)
>
> Bug fixes
> ---------
>
> o Fix missing symbols at link time for Windows target in Visual Studio
> (#3984)
>
> o Improve error message in axisswap (#3975)
>
> o Avoid convergence errors in +proj=gridshift when using biquadratic
>    interpolation (#3985)
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240301/a8d12c4a/attachment.htm>

From yportiercgg at gmail.com  Sat Mar  2 06:45:16 2024
From: yportiercgg at gmail.com (Yannick Portier)
Date: Sat, 2 Mar 2024 15:45:16 +0100
Subject: [PROJ] Create a custom CRS using EPSG transform method 9666 (P6
 I=J+90 seismic bin grid coordinate operation) with pyproj
Message-ID: <CACNkoYxhAU8uaBcZVJ+-YQj+3SPC=hprObr8A8x9+y+4SFeCHg@mail.gmail.com>

Hello all,

I tried asking this question on SO but failed to get an answer, so here
it is again:

I am trying to recreate the [EPSG example of georeferencing I=J+90 local
bin grid](
https://epsg.org/transformation_6918/EPSG-example-of-georeferencing-I-J-90-local-bin-grid.html)
using the `P6 I=J+90 seismic bin grid coordinate operation` (EPSG code
`9666`) but the resulting CRS can't be used to transform coordinates.
`xform = Transformer.from_crs('EPSG:25832', my_crs)` fails with `ProjError:
Input is not a transformation.`

Here is the `wkt` string I'm using to create the crs with `my_crs =
crs.CRS.from_wkt(wkt)`.

    DERIVEDPROJCRS["seismic survey bin grid",
        BASEPROJCRS["WGS 84 / UTM zone 31N",
            BASEGEOGCRS["WGS 84",
                ENSEMBLE["World Geodetic System 1984 ensemble",
                    MEMBER["World Geodetic System 1984 (Transit)"],
                    MEMBER["World Geodetic System 1984 (G730)"],
                    MEMBER["World Geodetic System 1984 (G873)"],
                    MEMBER["World Geodetic System 1984 (G1150)"],
                    MEMBER["World Geodetic System 1984 (G1674)"],
                    MEMBER["World Geodetic System 1984 (G1762)"],
                    MEMBER["World Geodetic System 1984 (G2139)"],
                    ELLIPSOID["WGS 84",6378137,298.257223563,
                        LENGTHUNIT["metre",1]],
                    ENSEMBLEACCURACY[2.0]],
                PRIMEM["Greenwich",0,
                    ANGLEUNIT["degree",0.0174532925199433]]],
            CONVERSION["UTM zone 31N",
                METHOD["Transverse Mercator",
                    ID["EPSG",9807]],
                PARAMETER["Latitude of natural origin",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8801]],
                PARAMETER["Longitude of natural origin",3,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8802]],
                PARAMETER["Scale factor at natural origin",0.9996,
                    SCALEUNIT["unity",1],
                    ID["EPSG",8805]],
                PARAMETER["False easting",500000,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8806]],
                PARAMETER["False northing",0,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8807]]]],
        DERIVINGCONVERSION["seismic survey bin grid",
            METHOD["P6 I=J+90 seismic bin grid coordinate operation",
                ID["EPSG",9666]],
            PARAMETER["Bin grid origin I",1,
                SCALEUNIT["Bin",1],
                ID["EPSG",8733]],
            PARAMETER["Bin grid origin J",1,
                SCALEUNIT["Bin",1],
                ID["EPSG",8734]],
            PARAMETER["Bin grid origin Easting",456781,
                LENGTHUNIT["metre",1],
                ID["EPSG",8735]],
            PARAMETER["Bin grid origin Northing",5836723,
                LENGTHUNIT["metre",1],
                ID["EPSG",8736]],
            PARAMETER["Scale factor of bin grid",0.99984,
                SCALEUNIT["Unity",1],
                ID["EPSG",8737]],
            PARAMETER["Bin width on I-axis",25,
                LENGTHUNIT["metre",1],
                ID["EPSG",8738]],
            PARAMETER["Bin width on J-axis",12.5,
                LENGTHUNIT["metre",1],
                ID["EPSG",8739]],
            PARAMETER["Map grid bearing of bin grid J-axis",20,
                ANGLEUNIT["degree",0.0174532925199433],
                ID["EPSG",8740]],
            PARAMETER["Bin node increment on I-axis",1,
                SCALEUNIT["Bin",1],
                ID["EPSG",8741]],
            PARAMETER["Bin node increment on J-axis",1,
                SCALEUNIT["Bin",1],
                ID["EPSG",8742]]],
        CS[ordinal,2],
            AXIS["inline (I)",eastSouthEast,
                ORDER[1],
                SCALEUNIT["Bin",1]],
            AXIS["crossline (J)",northNorthEast,
                ORDER[2],
                SCALEUNIT["Bin",1]],
        USAGE[
            SCOPE["Navigation and medium accuracy spatial referencing."],
            AREA["Between 0?E and 6?E, northern hemisphere between equator
and 84?N, onshore and offshore. Algeria. Andorra. Belgium. Benin. Burkina
Faso. Denmark - North Sea. France. Germany - North Sea. Ghana. Luxembourg.
Mali. Netherlands. Niger. Nigeria. Norway. Spain. Togo. United Kingdom (UK)
- North Sea."],
            BBOX[0,0,84,6]]]

What's wrong ?

Many thanks,
YeO
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240302/9b88e987/attachment.htm>

From even.rouault at spatialys.com  Sat Mar  2 07:12:47 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 2 Mar 2024 16:12:47 +0100
Subject: [PROJ] Create a custom CRS using EPSG transform method 9666 (P6
 I=J+90 seismic bin grid coordinate operation) with pyproj
In-Reply-To: <CACNkoYxhAU8uaBcZVJ+-YQj+3SPC=hprObr8A8x9+y+4SFeCHg@mail.gmail.com>
References: <CACNkoYxhAU8uaBcZVJ+-YQj+3SPC=hprObr8A8x9+y+4SFeCHg@mail.gmail.com>
Message-ID: <e4e12be0-9e8d-4a37-9c21-5be58446c07e@spatialys.com>

Yannick,

While PROJ can parse any valid WKT (by the way the SCALEUNIT[] inside 
the AXIS[] are normally not allowed for a ordinal CS, but that's not 
critical here), it can't necessarily always make practical use of it. In 
that instance, the underlying maths for `P6 I=J+90 seismic bin grid 
coordinate operation` (EPSG code `9666`) is not currently implemented in 
PROJ. Quickly looking at the formulas documented in the EPSG guidance 
note 7-2, it looks at first glance to boil down to just an affine 
transformation once you've compacted all the formulas, so you could 
potentially use a PROJ pipeline using the +proj=affine operator, or 
rewrite your WKT using the formalism of the Affine Parametric 
Transformation (EPSG:9624) implemented by PROJ.

Even

Le 02/03/2024 ? 15:45, Yannick Portier via PROJ a ?crit?:
> Hello all,
>
> I tried asking this question on SO but failed to get an?answer, so 
> here it?is again:
>
> I am trying to recreate the [EPSG example of georeferencing I=J+90 
> local bin 
> grid](https://epsg.org/transformation_6918/EPSG-example-of-georeferencing-I-J-90-local-bin-grid.html) 
> using the `P6 I=J+90 seismic bin grid coordinate operation` (EPSG code 
> `9666`) but the resulting CRS can't be used to transform coordinates.
> `xform = Transformer.from_crs('EPSG:25832', my_crs)` fails with 
> `ProjError: Input is not a transformation.`
>
> Here is the `wkt` string I'm using to create the crs with `my_crs = 
> crs.CRS.from_wkt(wkt)`.
>
> ? ? DERIVEDPROJCRS["seismic survey bin grid",
> ? ? ? ? BASEPROJCRS["WGS 84 / UTM zone 31N",
> ? ? ? ? ? ? BASEGEOGCRS["WGS 84",
> ? ? ? ? ? ? ? ? ENSEMBLE["World Geodetic System 1984 ensemble",
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (Transit)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G730)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G873)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G1150)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G1674)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G1762)"],
> ? ? ? ? ? ? ? ? ? ? MEMBER["World Geodetic System 1984 (G2139)"],
> ? ? ? ? ? ? ? ? ? ? ELLIPSOID["WGS 84",6378137,298.257223563,
> ? ? ? ? ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1]],
> ? ? ? ? ? ? ? ? ? ? ENSEMBLEACCURACY[2.0]],
> ? ? ? ? ? ? ? ? PRIMEM["Greenwich",0,
> ? ? ? ? ? ? ? ? ? ? ANGLEUNIT["degree",0.0174532925199433]]],
> ? ? ? ? ? ? CONVERSION["UTM zone 31N",
> ? ? ? ? ? ? ? ? METHOD["Transverse Mercator",
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",9807]],
> ? ? ? ? ? ? ? ? PARAMETER["Latitude of natural origin",0,
> ? ? ? ? ? ? ? ? ? ? ANGLEUNIT["degree",0.0174532925199433],
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",8801]],
> ? ? ? ? ? ? ? ? PARAMETER["Longitude of natural origin",3,
> ? ? ? ? ? ? ? ? ? ? ANGLEUNIT["degree",0.0174532925199433],
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",8802]],
> ? ? ? ? ? ? ? ? PARAMETER["Scale factor at natural origin",0.9996,
> ? ? ? ? ? ? ? ? ? ? SCALEUNIT["unity",1],
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",8805]],
> ? ? ? ? ? ? ? ? PARAMETER["False easting",500000,
> ? ? ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",8806]],
> ? ? ? ? ? ? ? ? PARAMETER["False northing",0,
> ? ? ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ? ? ID["EPSG",8807]]]],
> ? ? ? ? DERIVINGCONVERSION["seismic survey bin grid",
> ? ? ? ? ? ? METHOD["P6 I=J+90 seismic bin grid coordinate operation",
> ? ? ? ? ? ? ? ? ID["EPSG",9666]],
> ? ? ? ? ? ? PARAMETER["Bin grid origin I",1,
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8733]],
> ? ? ? ? ? ? PARAMETER["Bin grid origin J",1,
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8734]],
> ? ? ? ? ? ? PARAMETER["Bin grid origin Easting",456781,
> ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8735]],
> ? ? ? ? ? ? PARAMETER["Bin grid origin Northing",5836723,
> ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8736]],
> ? ? ? ? ? ? PARAMETER["Scale factor of bin grid",0.99984,
> ? ? ? ? ? ? ? ? SCALEUNIT["Unity",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8737]],
> ? ? ? ? ? ? PARAMETER["Bin width on I-axis",25,
> ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8738]],
> ? ? ? ? ? ? PARAMETER["Bin width on J-axis",12.5,
> ? ? ? ? ? ? ? ? LENGTHUNIT["metre",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8739]],
> ? ? ? ? ? ? PARAMETER["Map grid bearing of bin grid J-axis",20,
> ? ? ? ? ? ? ? ? ANGLEUNIT["degree",0.0174532925199433],
> ? ? ? ? ? ? ? ? ID["EPSG",8740]],
> ? ? ? ? ? ? PARAMETER["Bin node increment on I-axis",1,
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8741]],
> ? ? ? ? ? ? PARAMETER["Bin node increment on J-axis",1,
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1],
> ? ? ? ? ? ? ? ? ID["EPSG",8742]]],
> ? ? ? ? CS[ordinal,2],
> ? ? ? ? ? ? AXIS["inline (I)",eastSouthEast,
> ? ? ? ? ? ? ? ? ORDER[1],
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1]],
> ? ? ? ? ? ? AXIS["crossline (J)",northNorthEast,
> ? ? ? ? ? ? ? ? ORDER[2],
> ? ? ? ? ? ? ? ? SCALEUNIT["Bin",1]],
> ? ? ? ? USAGE[
> ? ? ? ? ? ? SCOPE["Navigation and medium accuracy spatial referencing."],
> ? ? ? ? ? ? AREA["Between 0?E and 6?E, northern hemisphere between 
> equator and 84?N, onshore and offshore. Algeria. Andorra. Belgium. 
> Benin. Burkina Faso. Denmark - North Sea. France. Germany - North Sea. 
> Ghana. Luxembourg. Mali. Netherlands. Niger. Nigeria. Norway. Spain. 
> Togo. United Kingdom (UK) - North Sea."],
> ? ? ? ? ? ? BBOX[0,0,84,6]]]
>
> What's wrong ?
>
> Many thanks,
> YeO
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From yportiercgg at gmail.com  Sun Mar  3 11:55:33 2024
From: yportiercgg at gmail.com (Yannick Portier)
Date: Sun, 3 Mar 2024 20:55:33 +0100
Subject: [PROJ] Create a custom CRS using EPSG transform method 9666 (P6
 I=J+90 seismic bin grid coordinate operation) with pyproj
In-Reply-To: <e4e12be0-9e8d-4a37-9c21-5be58446c07e@spatialys.com>
References: <CACNkoYxhAU8uaBcZVJ+-YQj+3SPC=hprObr8A8x9+y+4SFeCHg@mail.gmail.com>
 <e4e12be0-9e8d-4a37-9c21-5be58446c07e@spatialys.com>
Message-ID: <CACNkoYygwxRGpaDE8MR2PB4CK5=N=Xoq_gOp-K5YiETcn3jSHQ@mail.gmail.com>

Hi Even,
Indeed it's just an affine projection and I can define it with EPSG 9624 -
that's currently how I'm doing it actually.
It would have been nice to define it straight with EPSG:9666 but I guess
seismic bin grids are a bit of a niche and may not be worth the effort
implementing.
At any rate, many thanks for your feedback,
Yannick

On Sat, Mar 2, 2024 at 4:12?PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Yannick,
>
> While PROJ can parse any valid WKT (by the way the SCALEUNIT[] inside
> the AXIS[] are normally not allowed for a ordinal CS, but that's not
> critical here), it can't necessarily always make practical use of it. In
> that instance, the underlying maths for `P6 I=J+90 seismic bin grid
> coordinate operation` (EPSG code `9666`) is not currently implemented in
> PROJ. Quickly looking at the formulas documented in the EPSG guidance
> note 7-2, it looks at first glance to boil down to just an affine
> transformation once you've compacted all the formulas, so you could
> potentially use a PROJ pipeline using the +proj=affine operator, or
> rewrite your WKT using the formalism of the Affine Parametric
> Transformation (EPSG:9624) implemented by PROJ.
>
> Even
>
> Le 02/03/2024 ? 15:45, Yannick Portier via PROJ a ?crit :
> > Hello all,
> >
> > I tried asking this question on SO but failed to get an answer, so
> > here it is again:
> >
> > I am trying to recreate the [EPSG example of georeferencing I=J+90
> > local bin
> > grid](
> https://epsg.org/transformation_6918/EPSG-example-of-georeferencing-I-J-90-local-bin-grid.html)
>
> > using the `P6 I=J+90 seismic bin grid coordinate operation` (EPSG code
> > `9666`) but the resulting CRS can't be used to transform coordinates.
> > `xform = Transformer.from_crs('EPSG:25832', my_crs)` fails with
> > `ProjError: Input is not a transformation.`
> >
> > Here is the `wkt` string I'm using to create the crs with `my_crs =
> > crs.CRS.from_wkt(wkt)`.
> >
> >     DERIVEDPROJCRS["seismic survey bin grid",
> >         BASEPROJCRS["WGS 84 / UTM zone 31N",
> >             BASEGEOGCRS["WGS 84",
> >                 ENSEMBLE["World Geodetic System 1984 ensemble",
> >                     MEMBER["World Geodetic System 1984 (Transit)"],
> >                     MEMBER["World Geodetic System 1984 (G730)"],
> >                     MEMBER["World Geodetic System 1984 (G873)"],
> >                     MEMBER["World Geodetic System 1984 (G1150)"],
> >                     MEMBER["World Geodetic System 1984 (G1674)"],
> >                     MEMBER["World Geodetic System 1984 (G1762)"],
> >                     MEMBER["World Geodetic System 1984 (G2139)"],
> >                     ELLIPSOID["WGS 84",6378137,298.257223563,
> >                         LENGTHUNIT["metre",1]],
> >                     ENSEMBLEACCURACY[2.0]],
> >                 PRIMEM["Greenwich",0,
> >                     ANGLEUNIT["degree",0.0174532925199433]]],
> >             CONVERSION["UTM zone 31N",
> >                 METHOD["Transverse Mercator",
> >                     ID["EPSG",9807]],
> >                 PARAMETER["Latitude of natural origin",0,
> >                     ANGLEUNIT["degree",0.0174532925199433],
> >                     ID["EPSG",8801]],
> >                 PARAMETER["Longitude of natural origin",3,
> >                     ANGLEUNIT["degree",0.0174532925199433],
> >                     ID["EPSG",8802]],
> >                 PARAMETER["Scale factor at natural origin",0.9996,
> >                     SCALEUNIT["unity",1],
> >                     ID["EPSG",8805]],
> >                 PARAMETER["False easting",500000,
> >                     LENGTHUNIT["metre",1],
> >                     ID["EPSG",8806]],
> >                 PARAMETER["False northing",0,
> >                     LENGTHUNIT["metre",1],
> >                     ID["EPSG",8807]]]],
> >         DERIVINGCONVERSION["seismic survey bin grid",
> >             METHOD["P6 I=J+90 seismic bin grid coordinate operation",
> >                 ID["EPSG",9666]],
> >             PARAMETER["Bin grid origin I",1,
> >                 SCALEUNIT["Bin",1],
> >                 ID["EPSG",8733]],
> >             PARAMETER["Bin grid origin J",1,
> >                 SCALEUNIT["Bin",1],
> >                 ID["EPSG",8734]],
> >             PARAMETER["Bin grid origin Easting",456781,
> >                 LENGTHUNIT["metre",1],
> >                 ID["EPSG",8735]],
> >             PARAMETER["Bin grid origin Northing",5836723,
> >                 LENGTHUNIT["metre",1],
> >                 ID["EPSG",8736]],
> >             PARAMETER["Scale factor of bin grid",0.99984,
> >                 SCALEUNIT["Unity",1],
> >                 ID["EPSG",8737]],
> >             PARAMETER["Bin width on I-axis",25,
> >                 LENGTHUNIT["metre",1],
> >                 ID["EPSG",8738]],
> >             PARAMETER["Bin width on J-axis",12.5,
> >                 LENGTHUNIT["metre",1],
> >                 ID["EPSG",8739]],
> >             PARAMETER["Map grid bearing of bin grid J-axis",20,
> >                 ANGLEUNIT["degree",0.0174532925199433],
> >                 ID["EPSG",8740]],
> >             PARAMETER["Bin node increment on I-axis",1,
> >                 SCALEUNIT["Bin",1],
> >                 ID["EPSG",8741]],
> >             PARAMETER["Bin node increment on J-axis",1,
> >                 SCALEUNIT["Bin",1],
> >                 ID["EPSG",8742]]],
> >         CS[ordinal,2],
> >             AXIS["inline (I)",eastSouthEast,
> >                 ORDER[1],
> >                 SCALEUNIT["Bin",1]],
> >             AXIS["crossline (J)",northNorthEast,
> >                 ORDER[2],
> >                 SCALEUNIT["Bin",1]],
> >         USAGE[
> >             SCOPE["Navigation and medium accuracy spatial referencing."],
> >             AREA["Between 0?E and 6?E, northern hemisphere between
> > equator and 84?N, onshore and offshore. Algeria. Andorra. Belgium.
> > Benin. Burkina Faso. Denmark - North Sea. France. Germany - North Sea.
> > Ghana. Luxembourg. Mali. Netherlands. Niger. Nigeria. Norway. Spain.
> > Togo. United Kingdom (UK) - North Sea."],
> >             BBOX[0,0,84,6]]]
> >
> > What's wrong ?
> >
> > Many thanks,
> > YeO
> >
> > _______________________________________________
> > PROJ mailing list
> > PROJ at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/proj
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240303/fb6b2806/attachment.htm>

From j1 at jimenezshaw.com  Tue Mar  5 08:33:23 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 5 Mar 2024 17:33:23 +0100
Subject: [PROJ] Formats that use WKT
Message-ID: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>

Hi

For a presentation in FOSSGIS about WKT2 I would like to tell different
"storage formats" that use WKT1 or WKT2 (or none but should ;)
Do you know any?

Not so many come to my mind
- LAS 1.4 (WKT1)
- SHP using the esri variant
- GeoTIFF is using its own tags, not WKT
- Geopackage with this extension
https://www.geopackage.org/guidance/extensions/wkt_for_crs.html
- PAM file in GDAL, but that is cheating ;)

See that I am looking for formats that store some geo-data, and use WKT to
define the CRS (inside or next to it)

Bonus for a "storage format" that uses/supports WKT2!

Thanks!

.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240305/c6ad6c65/attachment.htm>

From martin.desruisseaux at geomatys.com  Tue Mar  5 08:52:28 2024
From: martin.desruisseaux at geomatys.com (Martin Desruisseaux)
Date: Tue, 5 Mar 2024 17:52:28 +0100
Subject: [PROJ] Formats that use WKT
In-Reply-To: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
References: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
Message-ID: <1e3ff282-b4ef-4a98-b266-51ca40253075@geomatys.com>

Le 2024-03-05 ? 17 h 33, Javier Jimenez Shaw via PROJ a ?crit?:

> For a presentation in FOSSGIS about WKT2 I would like to tell 
> different "storage formats" that use WKT1 or WKT2 (or none but should ;)
> Do you know any?
CRS-Gridded-Geodetic-data-eXchange-Format

From martin.desruisseaux at geomatys.com  Tue Mar  5 08:54:57 2024
From: martin.desruisseaux at geomatys.com (Martin Desruisseaux)
Date: Tue, 5 Mar 2024 17:54:57 +0100
Subject: [PROJ] Formats that use WKT
In-Reply-To: <1e3ff282-b4ef-4a98-b266-51ca40253075@geomatys.com>
References: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
 <1e3ff282-b4ef-4a98-b266-51ca40253075@geomatys.com>
Message-ID: <94bacdc9-82a1-44b7-986a-feffb7d8050f@geomatys.com>

Oups! Sorry, accidentally clicked on "sent" (button too close to 
"edition" menu).

GGXF : Gridded Geodetic data eXchange Format
https://github.com/opengeospatial/CRS-Gridded-Geodetic-data-eXchange-Format/

This is the replacement of NADCON, NTv2 and other datum shift formats 
which has been developed as an OGC standard.

I think, if I remember right, that NetCDF-CF conventions also has an 
attribute for WKT in netCDF files.

 ??? Martin



From even.rouault at spatialys.com  Tue Mar  5 09:00:27 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 5 Mar 2024 18:00:27 +0100
Subject: [PROJ] Formats that use WKT
In-Reply-To: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
References: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
Message-ID: <490bc73e-178e-407a-b324-a0adbead2fae@spatialys.com>

Hi Javier,
>
> - GeoTIFF is using its own tags, not WKT
 ??? ==> ESRI has actually an extension (supported by GDAL) where they 
feed ESRI WKT in the PCSCitationGeoKey tag. cf 
https://github.com/opengeospatial/geotiff/issues/56#issuecomment-451130281
> - Geopackage with this extension 
> https://www.geopackage.org/guidance/extensions/wkt_for_crs.html
 ??? ==> WKT1 is part of the core standard. The extension is for 
additional WKT:2015 support . And the latest GeoPackage 1.4 spec also 
allows WKT:2019
> - PAM file in GDAL, but that is cheating ;)

 ??? ==> almost an industry standard. It has been supported by ArcGIS 
for decades 
(https://desktop.arcgis.com/fr/arcmap/latest/manage-data/raster-and-images/auxiliary-files.htm).

"grep -r exportToWkt frmts ogr/ogrsf_frmts" in GDAL also shows:

- netCDF. crs_wkt attribute to the CF CRS encoding
- PDF: in GeoPDF (I don't remember if it is the ISO or OGC Best Practice 
encoding. but it is the ESRI WKT variant I believe)
- ArcInfo ASCII Grid: ESRI WKT in a .prj
- Oracle GeoRaster: in their spatial_ref_sys table or equivalent. Oracle 
WKT: an antique & unique sub-dialect of WKT1
- BAG
- SAGA
- Erdas Imagine. ESRI WKT
- TileDB. WKT1 if PROJJSON not available in a (likely GDAL specific) 
attribute
- MySQL. WKT1 in spatial_ref_sys table
- PostGIS. WKT1 in spatial_ref_sys table
- ESRI FileGeodatabase: ESRI WKT

>
> See that I am looking for formats that store some geo-data, and use 
> WKT to define the CRS (inside or next to it)
>
> Bonus for a "storage format" that uses/supports WKT2!

- FlatGeoBuf, although I realize the spec at 
https://github.com/flatgeobuf/flatgeobuf/blob/master/src/fbs/header.fbs#L63 
isn't super explicit, but GDAL writes WKT:2019 into it

- Zarr. in a GDAL's extension for CRS support

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240305/22318b2d/attachment.htm>

From erik.sorngard at gl-instrumenter.no  Tue Mar  5 11:27:29 2024
From: erik.sorngard at gl-instrumenter.no (=?iso-8859-1?Q?Erik_S=F8rng=E5rd?=)
Date: Tue, 5 Mar 2024 19:27:29 +0000
Subject: [PROJ] Formats that use WKT
In-Reply-To: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
References: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
Message-ID: <SVAP279MB0174E8E633AC8DCB4BAD043ADA222@SVAP279MB0174.NORP279.PROD.OUTLOOK.COM>

Hello,

LandXML contains a CoordinateSystem element with an optional "ogcWktCode" attribute.


Best regards,



Erik S?rng?rd | R&D Manager | Gundersen & L?ken AS




________________________________
From: PROJ <proj-bounces at lists.osgeo.org> on behalf of Javier Jimenez Shaw via PROJ <proj at lists.osgeo.org>
Sent: Tuesday, March 5, 2024 17:33
To: proj <PROJ at lists.osgeo.org>
Subject: [PROJ] Formats that use WKT

Hi

For a presentation in FOSSGIS about WKT2 I would like to tell different "storage formats" that use WKT1 or WKT2 (or none but should ;)
Do you know any?

Not so many come to my mind
- LAS 1.4 (WKT1)
- SHP using the esri variant
- GeoTIFF is using its own tags, not WKT
- Geopackage with this extension https://www.geopackage.org/guidance/extensions/wkt_for_crs.html
- PAM file in GDAL, but that is cheating ;)

See that I am looking for formats that store some geo-data, and use WKT to define the CRS (inside or next to it)

Bonus for a "storage format" that uses/supports WKT2!

Thanks!

.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240305/be23b3f5/attachment-0001.htm>

From j1 at jimenezshaw.com  Tue Mar  5 14:19:25 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 5 Mar 2024 23:19:25 +0100
Subject: [PROJ] Formats that use WKT
In-Reply-To: <490bc73e-178e-407a-b324-a0adbead2fae@spatialys.com>
References: <CADRrdKs4NGPDVOcPovObDgB1t8VCqaSWXkruztrp=spSKfwZyw@mail.gmail.com>
 <490bc73e-178e-407a-b324-a0adbead2fae@spatialys.com>
Message-ID: <CADRrdKucLK6+7EyKNCJ5BKYyG9WQk=-04R4pRofWpcOFHiMFHQ@mail.gmail.com>

Thank you!

On Tue, 5 Mar 2024, 18:00 Even Rouault, <even.rouault at spatialys.com> wrote:

> Hi Javier,
>
>
> - GeoTIFF is using its own tags, not WKT
>
>     ==> ESRI has actually an extension (supported by GDAL) where they feed
> ESRI WKT in the PCSCitationGeoKey tag. cf
> https://github.com/opengeospatial/geotiff/issues/56#issuecomment-451130281
>
> - Geopackage with this extension
> https://www.geopackage.org/guidance/extensions/wkt_for_crs.html
>
>     ==> WKT1 is part of the core standard. The extension is for additional
> WKT:2015 support . And the latest GeoPackage 1.4 spec also allows WKT:2019
>
> - PAM file in GDAL, but that is cheating ;)
>
>     ==> almost an industry standard. It has been supported by ArcGIS for
> decades (
> https://desktop.arcgis.com/fr/arcmap/latest/manage-data/raster-and-images/auxiliary-files.htm
> ).
>
> "grep -r exportToWkt frmts ogr/ogrsf_frmts" in GDAL also shows:
>
> - netCDF. crs_wkt attribute to the CF CRS encoding
> - PDF: in GeoPDF (I don't remember if it is the ISO or OGC Best Practice
> encoding. but it is the ESRI WKT variant I believe)
> - ArcInfo ASCII Grid: ESRI WKT in a .prj
> - Oracle GeoRaster: in their spatial_ref_sys table or equivalent. Oracle
> WKT: an antique & unique sub-dialect of WKT1
> - BAG
> - SAGA
> - Erdas Imagine. ESRI WKT
> - TileDB. WKT1 if PROJJSON not available in a (likely GDAL specific)
> attribute
> - MySQL. WKT1 in spatial_ref_sys table
> - PostGIS. WKT1 in spatial_ref_sys table
> - ESRI FileGeodatabase: ESRI WKT
>
>
> See that I am looking for formats that store some geo-data, and use WKT to
> define the CRS (inside or next to it)
>
> Bonus for a "storage format" that uses/supports WKT2!
>
> - FlatGeoBuf, although I realize the spec at
> https://github.com/flatgeobuf/flatgeobuf/blob/master/src/fbs/header.fbs#L63
> isn't super explicit, but GDAL writes WKT:2019 into it
>
> - Zarr. in a GDAL's extension for CRS support
>
> Even
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240305/c24198ed/attachment.htm>

From codetympan at edf.fr  Wed Mar  6 06:27:35 2024
From: codetympan at edf.fr (CODETYMPAN)
Date: Wed, 6 Mar 2024 14:27:35 +0000
Subject: [PROJ] Support request for using PROJ in CMake projects
Message-ID: <PR0P264MB0395476FF1ADFC89A19AE8F59B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>

"I apologize, I had sent this message with email jean.ripolles at edf.fr<mailto:jean.ripolles at edf.fr> by mistake".

Hello,

We're trying to integrate PROJ in an opensource project using CMake.

Following strictly this page :
https://proj.org/en/9.3/development/cmake.html

CMake does find PROJ but we fall on this error message :

"CMake Error: File C:/projects/poc-ign-geopf/cmake/proj_config.cmake.in does not exist.
CMake Error at C:/dev/PROJ/cmake/ProjConfig.cmake:54 (configure_file):
  configure_file Problem configuring file"

Are we missing something ?

We attach the CMakeLists.txt file to this mail.

If necessary, we can push this project on an experimental branch, knowing that it depends on Qt5.15.2 MSVC2019.

Thanks in advance for your help.
Kind regards,
Jean.





Ce message et toutes les pi?ces jointes (ci-apr?s le 'Message') sont ?tablis ? l'intention exclusive des destinataires et les informations qui y figurent sont strictement confidentielles. Toute utilisation de ce Message non conforme ? sa destination, toute diffusion ou toute publication totale ou partielle, est interdite sauf autorisation expresse.

Si vous n'?tes pas le destinataire de ce Message, il vous est interdit de le copier, de le faire suivre, de le divulguer ou d'en utiliser tout ou partie. Si vous avez re?u ce Message par erreur, merci de le supprimer de votre syst?me, ainsi que toutes ses copies, et de n'en garder aucune trace sur quelque support que ce soit. Nous vous remercions ?galement d'en avertir imm?diatement l'exp?diteur par retour du message.

Il est impossible de garantir que les communications par messagerie ?lectronique arrivent en temps utile, sont s?curis?es ou d?nu?es de toute erreur ou virus.
____________________________________________________

This message and any attachments (the 'Message') are intended solely for the addressees. The information contained in this Message is confidential. Any use of information contained in this Message not in accord with its purpose, any dissemination or disclosure, either whole or partial, is prohibited except formal approval.

If you are not the addressee, you may not copy, forward, disclose or use any part of it. If you have received this message in error, please delete it and all copies from your system and notify the sender immediately by return message.

E-mail communication cannot be guaranteed to be timely secure, error or virus-free.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240306/e7c9e4c7/attachment-0001.htm>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: CMakeLists.txt
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240306/e7c9e4c7/attachment-0001.txt>

From erixen_cruz at earthbrain.com  Wed Mar  6 07:24:31 2024
From: erixen_cruz at earthbrain.com (Erixen Cruz)
Date: Wed, 6 Mar 2024 15:24:31 +0000
Subject: [PROJ] Support request for using PROJ in CMake projects
In-Reply-To: <PR0P264MB0395476FF1ADFC89A19AE8F59B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
References: <PR0P264MB0395476FF1ADFC89A19AE8F59B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
Message-ID: <TYWP286MB26345ED4BA70EF7A9B832CF5E5212@TYWP286MB2634.JPNP286.PROD.OUTLOOK.COM>

Did you install PROJ? https://proj.org/en/9.3/install.html#install

Other options are using vcpkg or conan to handle downloading, building, caching PROJ for you.
https://vcpkg.io/en/
https://conan.io/

Sincerely, Erixen
________________________________
From: PROJ <proj-bounces at lists.osgeo.org> on behalf of CODETYMPAN via PROJ <proj at lists.osgeo.org>
Sent: Wednesday, March 6, 2024 9:27 AM
To: proj at lists.osgeo.org <proj at lists.osgeo.org>
Subject: [PROJ] Support request for using PROJ in CMake projects


?I apologize, I had sent this message with email jean.ripolles at edf.fr<mailto:jean.ripolles at edf.fr> by mistake?.



Hello,



We?re trying to integrate PROJ in an opensource project using CMake.



Following strictly this page :

https://proj.org/en/9.3/development/cmake.html



CMake does find PROJ but we fall on this error message :



?CMake Error: File C:/projects/poc-ign-geopf/cmake/proj_config.cmake.in does not exist.

CMake Error at C:/dev/PROJ/cmake/ProjConfig.cmake:54 (configure_file):

  configure_file Problem configuring file?



Are we missing something ?



We attach the CMakeLists.txt file to this mail.



If necessary, we can push this project on an experimental branch, knowing that it depends on Qt5.15.2 MSVC2019.



Thanks in advance for your help.

Kind regards,

Jean.





Ce message et toutes les pi?ces jointes (ci-apr?s le 'Message') sont ?tablis ? l'intention exclusive des destinataires et les informations qui y figurent sont strictement confidentielles. Toute utilisation de ce Message non conforme ? sa destination, toute diffusion ou toute publication totale ou partielle, est interdite sauf autorisation expresse.

Si vous n'?tes pas le destinataire de ce Message, il vous est interdit de le copier, de le faire suivre, de le divulguer ou d'en utiliser tout ou partie. Si vous avez re?u ce Message par erreur, merci de le supprimer de votre syst?me, ainsi que toutes ses copies, et de n'en garder aucune trace sur quelque support que ce soit. Nous vous remercions ?galement d'en avertir imm?diatement l'exp?diteur par retour du message.

Il est impossible de garantir que les communications par messagerie ?lectronique arrivent en temps utile, sont s?curis?es ou d?nu?es de toute erreur ou virus.
____________________________________________________

This message and any attachments (the 'Message') are intended solely for the addressees. The information contained in this Message is confidential. Any use of information contained in this Message not in accord with its purpose, any dissemination or disclosure, either whole or partial, is prohibited except formal approval.

If you are not the addressee, you may not copy, forward, disclose or use any part of it. If you have received this message in error, please delete it and all copies from your system and notify the sender immediately by return message.

E-mail communication cannot be guaranteed to be timely secure, error or virus-free.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240306/987bf19e/attachment.htm>

From codetympan at edf.fr  Wed Mar  6 08:20:51 2024
From: codetympan at edf.fr (CODETYMPAN)
Date: Wed, 6 Mar 2024 16:20:51 +0000
Subject: [PROJ] Support request for using PROJ in CMake projects
In-Reply-To: <TYWP286MB26345ED4BA70EF7A9B832CF5E5212@TYWP286MB2634.JPNP286.PROD.OUTLOOK.COM>
References: <PR0P264MB0395476FF1ADFC89A19AE8F59B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
 <TYWP286MB26345ED4BA70EF7A9B832CF5E5212@TYWP286MB2634.JPNP286.PROD.OUTLOOK.COM>
Message-ID: <PR0P264MB0395C1D7FC3CF8FEDE4F3C389B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>

Thank you very much for your quick reply.
Yes I've installed PROJ using miniconda, as I already had it installed on my computer, it was easier.
But unfortunately, I got the same error message.

And I am a bit annoyed having to install PROJ, I just want to use some features of PROJ in our opensource project.
I have QGIS installed on my computer, so PROJ is already installed.

Moreover, we're using appveyor for our CI, and PROJ does not seem to be pre-installed on appveyor windows images :
https://www.appveyor.com/docs/windows-images-software/

Does it mean we'll have to install PROJ on appveyor machine for every build of the CI ?

If you have an example of an opensource project using PROJ with CMake and CI, I'm interesting to have its reference.
And if not, I can push on an experimental branch in order to reproduce behaviour.

Thank in advance for your help.
Sincerely,
Jean.

De : erixen_cruz at earthbrain.com <erixen_cruz at earthbrain.com>
Envoy? : mercredi 6 mars 2024 16:25
? : proj at lists.osgeo.org; CODETYMPAN <codetympan at edf.fr>
Objet : Re: Support request for using PROJ in CMake projects

Did you install PROJ? https://proj.org/en/9.3/install.html#install

Other options are using vcpkg or conan to handle downloading, building, caching PROJ for you.
https://vcpkg.io/en/
https://conan.io/

Sincerely, Erixen
________________________________
From: PROJ <proj-bounces at lists.osgeo.org<mailto:proj-bounces at lists.osgeo.org>> on behalf of CODETYMPAN via PROJ <proj at lists.osgeo.org<mailto:proj at lists.osgeo.org>>
Sent: Wednesday, March 6, 2024 9:27 AM
To: proj at lists.osgeo.org<mailto:proj at lists.osgeo.org> <proj at lists.osgeo.org<mailto:proj at lists.osgeo.org>>
Subject: [PROJ] Support request for using PROJ in CMake projects


"I apologize, I had sent this message with email jean.ripolles at edf.fr<mailto:jean.ripolles at edf.fr> by mistake".



Hello,



We're trying to integrate PROJ in an opensource project using CMake.



Following strictly this page :

https://proj.org/en/9.3/development/cmake.html



CMake does find PROJ but we fall on this error message :



"CMake Error: File C:/projects/poc-ign-geopf/cmake/proj_config.cmake.in does not exist.

CMake Error at C:/dev/PROJ/cmake/ProjConfig.cmake:54 (configure_file):

  configure_file Problem configuring file"



Are we missing something ?



We attach the CMakeLists.txt file to this mail.



If necessary, we can push this project on an experimental branch, knowing that it depends on Qt5.15.2 MSVC2019.



Thanks in advance for your help.

Kind regards,

Jean.





Ce message et toutes les pi?ces jointes (ci-apr?s le 'Message') sont ?tablis ? l'intention exclusive des destinataires et les informations qui y figurent sont strictement confidentielles. Toute utilisation de ce Message non conforme ? sa destination, toute diffusion ou toute publication totale ou partielle, est interdite sauf autorisation expresse.

Si vous n'?tes pas le destinataire de ce Message, il vous est interdit de le copier, de le faire suivre, de le divulguer ou d'en utiliser tout ou partie. Si vous avez re?u ce Message par erreur, merci de le supprimer de votre syst?me, ainsi que toutes ses copies, et de n'en garder aucune trace sur quelque support que ce soit. Nous vous remercions ?galement d'en avertir imm?diatement l'exp?diteur par retour du message.

Il est impossible de garantir que les communications par messagerie ?lectronique arrivent en temps utile, sont s?curis?es ou d?nu?es de toute erreur ou virus.
____________________________________________________

This message and any attachments (the 'Message') are intended solely for the addressees. The information contained in this Message is confidential. Any use of information contained in this Message not in accord with its purpose, any dissemination or disclosure, either whole or partial, is prohibited except formal approval.

If you are not the addressee, you may not copy, forward, disclose or use any part of it. If you have received this message in error, please delete it and all copies from your system and notify the sender immediately by return message.

E-mail communication cannot be guaranteed to be timely secure, error or virus-free.



Ce message et toutes les pi?ces jointes (ci-apr?s le 'Message') sont ?tablis ? l'intention exclusive des destinataires et les informations qui y figurent sont strictement confidentielles. Toute utilisation de ce Message non conforme ? sa destination, toute diffusion ou toute publication totale ou partielle, est interdite sauf autorisation expresse.

Si vous n'?tes pas le destinataire de ce Message, il vous est interdit de le copier, de le faire suivre, de le divulguer ou d'en utiliser tout ou partie. Si vous avez re?u ce Message par erreur, merci de le supprimer de votre syst?me, ainsi que toutes ses copies, et de n'en garder aucune trace sur quelque support que ce soit. Nous vous remercions ?galement d'en avertir imm?diatement l'exp?diteur par retour du message.

Il est impossible de garantir que les communications par messagerie ?lectronique arrivent en temps utile, sont s?curis?es ou d?nu?es de toute erreur ou virus.
____________________________________________________

This message and any attachments (the 'Message') are intended solely for the addressees. The information contained in this Message is confidential. Any use of information contained in this Message not in accord with its purpose, any dissemination or disclosure, either whole or partial, is prohibited except formal approval.

If you are not the addressee, you may not copy, forward, disclose or use any part of it. If you have received this message in error, please delete it and all copies from your system and notify the sender immediately by return message.

E-mail communication cannot be guaranteed to be timely secure, error or virus-free.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240306/2afbbab2/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Mar  6 08:35:23 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Mar 2024 17:35:23 +0100
Subject: [PROJ] Support request for using PROJ in CMake projects
In-Reply-To: <PR0P264MB0395C1D7FC3CF8FEDE4F3C389B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
References: <PR0P264MB0395476FF1ADFC89A19AE8F59B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
 <TYWP286MB26345ED4BA70EF7A9B832CF5E5212@TYWP286MB2634.JPNP286.PROD.OUTLOOK.COM>
 <PR0P264MB0395C1D7FC3CF8FEDE4F3C389B212@PR0P264MB0395.FRAP264.PROD.OUTLOOK.COM>
Message-ID: <b12da739-c005-442f-bc4f-161f3d785deb@spatialys.com>

Jean,


> Thank you very much for your quick reply.
>
> Yes I?ve installed PROJ using miniconda, as I already had it installed 
> on my computer, it was easier.
>
> But unfortunately, I got the same error message.
>
> And I am a bit annoyed having to install PROJ, I just want to use some 
> features of PROJ in our opensource project.
>
> I have QGIS installed on my computer, so PROJ is already installed.
>
> Moreover, we?re using appveyor for our CI, and PROJ does not seem to 
> be pre-installed on appveyor windows images :
>
> https://www.appveyor.com/docs/windows-images-software/
>
Yes, too specialized to be on generic purposes CI images
>
> Does it mean we?ll have to install PROJ on appveyor machine for every 
> build of the CI ?
>
yes
>
> If you have an example of an opensource project using PROJ with CMake 
> and CI, I?m interesting to have its reference.
>
GDAL, QGIS, etc.

Use a package manager as suggested to install PROJ on your CI: vcpkg, 
conda, etc.

For example 
https://github.com/OSGeo/gdal/blob/master/.github/workflows/cmake_builds.yml#L425

Or potentially use 
https://cmake.org/cmake/help/latest/module/ExternalProject.html, but 
you'll likely have the same issues with PROJ's dependencies: curl, libtiff

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240306/ec9168e1/attachment.htm>

From j1 at jimenezshaw.com  Sun Mar 10 03:02:27 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Sun, 10 Mar 2024 11:02:27 +0100
Subject: [PROJ] Rename NEWS and HOWTO-RELEASE to *.md
Message-ID: <CADRrdKucLRdJ_izharnFJ9VLpUyxkVY63oLmfxrCx4ySYySREA@mail.gmail.com>

Hi people (specially packagers)

In this PR I am suggesting to rename some "documentation" files, adding
".md" extension as they are Markdown compatible:
https://github.com/OSGeo/PROJ/pull/4066

There are some doubts about the impact on packagers. Could you give your
opinion in the PR?
Jeff McKenna (Windows) already did, and liked it.

Thanks!

.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240310/1fadf773/attachment.htm>

From j1 at jimenezshaw.com  Wed Mar 13 13:21:51 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 13 Mar 2024 21:21:51 +0100
Subject: [PROJ] Release 9.4.0 in zenodo
Message-ID: <CADRrdKuoyau9tztWMUL1Du15Lbowmcj04en1bRj27L88Vu-EGw@mail.gmail.com>

Hi

I guess the release 9.4.0 was not published in zenodo:
https://zenodo.org/records/7296365

I usually get a notification on my orcid, and this time I haven't.

Cheers
Javier.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240313/4a5feda5/attachment.htm>

From even.rouault at spatialys.com  Wed Mar 13 13:25:34 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Mar 2024 21:25:34 +0100
Subject: [PROJ] Release 9.4.0 in zenodo
In-Reply-To: <CADRrdKuoyau9tztWMUL1Du15Lbowmcj04en1bRj27L88Vu-EGw@mail.gmail.com>
References: <CADRrdKuoyau9tztWMUL1Du15Lbowmcj04en1bRj27L88Vu-EGw@mail.gmail.com>
Message-ID: <f036f66b-b943-497f-8d3b-8c4db2844f27@spatialys.com>

The latest releases of GDAL and GRASS have also had the same issue. 
Peter L?we coordinates with the Zenodo team about that

Le 13/03/2024 ? 21:21, Javier Jimenez Shaw via PROJ a ?crit?:
> Hi
>
> I guess the release 9.4.0 was not published in zenodo:
> https://zenodo.org/records/7296365
>
> I usually get a notification on my orcid, and this time I haven't.
>
> Cheers
> Javier.
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From peter.loewe at gmx.de  Thu Mar 14 12:19:29 2024
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Thu, 14 Mar 2024 20:19:29 +0100
Subject: [PROJ] Release 9.4.0 in zenodo (Even Rouault)
In-Reply-To: <mailman.11.1710442802.26942.proj@lists.osgeo.org>
References: <mailman.11.1710442802.26942.proj@lists.osgeo.org>
Message-ID: <trinity-9646b1e2-eac5-4929-b43a-214880eacfca-1710443969053@3c-app-gmx-bap22>

Hi all,

release 9.4.0 is now available on zenodo: https://zenodo.org/records/7296365

Feedback from Zenodo on why the GDAL and PROJ repos were disabled (Github-sided I assume):

"Both the repositories have been updated successfully with the latest releases. We will investigate the issue on why the repositories were disabled, I can assure you this is not a common occurrence."

Best,
Peter


<peter.loewe at gmx.de>


> Gesendet: Donnerstag, 14. M?rz 2024 um 20:00 Uhr
> Von: proj-request at lists.osgeo.org
> An: proj at lists.osgeo.org
> Betreff: PROJ Digest, Vol 65, Issue 10
>
> Send PROJ mailing list submissions to
> 	proj at lists.osgeo.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://lists.osgeo.org/mailman/listinfo/proj
> or, via email, send a message with subject or body 'help' to
> 	proj-request at lists.osgeo.org
> 
> You can reach the person managing the list at
> 	proj-owner at lists.osgeo.org
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of PROJ digest..."
> 
> 
> Today's Topics:
> 
>    1. Release 9.4.0 in zenodo (Javier Jimenez Shaw)
>    2. Re: Release 9.4.0 in zenodo (Even Rouault)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Wed, 13 Mar 2024 21:21:51 +0100
> From: Javier Jimenez Shaw <j1 at jimenezshaw.com>
> To: proj <PROJ at lists.osgeo.org>
> Subject: [PROJ] Release 9.4.0 in zenodo
> Message-ID:
> 	<CADRrdKuoyau9tztWMUL1Du15Lbowmcj04en1bRj27L88Vu-EGw at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
> 
> Hi
> 
> I guess the release 9.4.0 was not published in zenodo:
> https://zenodo.org/records/7296365
> 
> I usually get a notification on my orcid, and this time I haven't.
> 
> Cheers
> Javier.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240313/4a5feda5/attachment-0001.htm>
> 
> ------------------------------
> 
> Message: 2
> Date: Wed, 13 Mar 2024 21:25:34 +0100
> From: Even Rouault <even.rouault at spatialys.com>
> To: Javier Jimenez Shaw <j1 at jimenezshaw.com>, proj
> 	<PROJ at lists.osgeo.org>
> Subject: Re: [PROJ] Release 9.4.0 in zenodo
> Message-ID: <f036f66b-b943-497f-8d3b-8c4db2844f27 at spatialys.com>
> Content-Type: text/plain; charset=UTF-8; format=flowed
> 
> The latest releases of GDAL and GRASS have also had the same issue. 
> Peter L?we coordinates with the Zenodo team about that
> 
> Le 13/03/2024 ? 21:21, Javier Jimenez Shaw via PROJ a ?crit?:
> > Hi
> >
> > I guess the release 9.4.0 was not published in zenodo:
> > https://zenodo.org/records/7296365
> >
> > I usually get a notification on my orcid, and this time I haven't.
> >
> > Cheers
> > Javier.
> >
> > _______________________________________________
> > PROJ mailing list
> > PROJ at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/proj
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> 
> 
> ------------------------------
> 
> Subject: Digest Footer
> 
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
> 
> 
> ------------------------------
> 
> End of PROJ Digest, Vol 65, Issue 10
> ************************************
>

From ulisesmartinibarra at gmail.com  Thu Mar 14 22:27:13 2024
From: ulisesmartinibarra at gmail.com (Ulises Ibarra)
Date: Thu, 14 Mar 2024 23:27:13 -0600
Subject: [PROJ] What is the syntax for a vertical datum change?
Message-ID: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>

Hello:
I am trying to change the vertical datum of a LIDAR LAS file. But first I
must understand the syntax of proj, but I can't understand it.

If I use the following expression:
echo 747194.732 2307402.892 2037.133 | proj +proj=vgridshift
+grids=C:/clouds/geoids/GGM10_GEO.gtx

I get:
Rel. 9.3.1, December 1st, 2023
<proj>:
can't initialize operations that produce angular output coordinates
program abnormally terminated

So I try to try an operation that seems to be simpler:
>cs2cs +proj=utm +zone=13 +north +ellps=WGS84 +units=m +no_defs
+ellps=wgs84 +to +proj=tmerc +lon_0=-102.624373 +ellps=wgs84

And the result is:
cannot instantiate target coordinate system
program abnormally terminated

I thank you for your kind attention.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240314/128334d0/attachment.htm>

From even.rouault at spatialys.com  Fri Mar 15 00:42:27 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Mar 2024 08:42:27 +0100
Subject: [PROJ] What is the syntax for a vertical datum change?
In-Reply-To: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
References: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
Message-ID: <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>


Le 15/03/2024 ? 06:27, Ulises Ibarra via PROJ a ?crit?:
> Hello:
> I am trying to change the vertical datum of a LIDAR LAS file. But 
> first I must understand the syntax of proj, but I can't understand it.
>
> If I use the following expression:
> echo 747194.732 2307402.892 2037.133 | proj +proj=vgridshift 
> +grids=C:/clouds/geoids/GGM10_GEO.gtx

"proj" is a legacy tool only for 2D cartographic projections. You want 
to use cct instead: https://proj.org/en/9.4/apps/cct.html

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240315/df98eb2d/attachment.htm>

From ulisesmartinibarra at gmail.com  Fri Mar 15 09:51:55 2024
From: ulisesmartinibarra at gmail.com (Ulises Ibarra)
Date: Fri, 15 Mar 2024 10:51:55 -0600
Subject: [PROJ] What is the syntax for a vertical datum change?
In-Reply-To: <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>
References: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
 <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>
Message-ID: <CAP=Ak6ioX0KWAy8zgCkTsiaceBciPLAvPnqQ_ZSMDza7p3hVsQ@mail.gmail.com>

Mr. Even, thanks You very much.

El vie, 15 de mar de 2024, 1:42 a. m., Even Rouault <
even.rouault at spatialys.com> escribi?:

>
> Le 15/03/2024 ? 06:27, Ulises Ibarra via PROJ a ?crit :
>
> Hello:
> I am trying to change the vertical datum of a LIDAR LAS file. But first I
> must understand the syntax of proj, but I can't understand it.
>
> If I use the following expression:
> echo 747194.732 2307402.892 2037.133 | proj +proj=vgridshift
> +grids=C:/clouds/geoids/GGM10_GEO.gtx
>
> "proj" is a legacy tool only for 2D cartographic projections. You want to
> use cct instead: https://proj.org/en/9.4/apps/cct.html
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240315/b4ad5683/attachment.htm>

From oss at behrisch.de  Mon Mar 18 01:26:08 2024
From: oss at behrisch.de (Michael Behrisch)
Date: Mon, 18 Mar 2024 09:26:08 +0100
Subject: [PROJ] error several objects matching this name
Message-ID: <782a8513-754e-4b59-b60f-b491d4962f8c@behrisch.de>

Hi,
I try to convert data from the Gauss-Krueger-System using pyproj.
This worked well until pyproj 3.2.1 using code like prj = 
pyproj.Proj("GK4"). Newer versions give me the error as mentioned in the 
subject (pyproj 3.3.0) or even "unrecognized format / unknown name" 
(pyproj 3.6.0). Since I get the error from the subject also when using 
projinfo (9.1.1 on ubuntu 22.04) I decided to ask here whether there are 
any means to get a fallback to the old behavior?

Thank you for providing this very useful library!

Best regards,
Michael

From even.rouault at spatialys.com  Mon Mar 18 05:45:16 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Mar 2024 13:45:16 +0100
Subject: [PROJ] error several objects matching this name
In-Reply-To: <782a8513-754e-4b59-b60f-b491d4962f8c@behrisch.de>
References: <782a8513-754e-4b59-b60f-b491d4962f8c@behrisch.de>
Message-ID: <3e780556-0053-4be5-8957-f9e70fa9279f@spatialys.com>

Hi,

Approximate name matching was voluntarily restricted in 9.2.0 per 
https://github.com/OSGeo/PROJ/commit/15a7cbeb124096b38e40f33202c5ba38f8e13a02 
to avoid false positives in certain cases. I'm not sure why you get here 
starting with 9.1.1 though

Trying with 9.1.0, I see

$ ~/proj/install-proj-9.1.0/bin/projinfo GK4
input string: parsing of user string failed: several objects matching 
this name: Pulkovo 1995 / Gauss-Kruger CM 45E, Pulkovo 1942 / 
Gauss-Kruger CM 45E, Pulkovo 1942 / 3-degree Gauss-Kruger CM 42E, 
Pulkovo 1942 / 3-degree Gauss-Kruger CM 45E, Pulkovo 1942 / 3-degree 
Gauss-Kruger CM 48E, ...

I'm not even sure to understand how that would match GK4...

Perhaps try with "Gauss-Kruger" or "Gauss-Kruger CM 4"

Even

Le 18/03/2024 ? 09:26, Michael Behrisch via PROJ a ?crit?:
> Hi,
> I try to convert data from the Gauss-Krueger-System using pyproj.
> This worked well until pyproj 3.2.1 using code like prj = 
> pyproj.Proj("GK4"). Newer versions give me the error as mentioned in 
> the subject (pyproj 3.3.0) or even "unrecognized format / unknown 
> name" (pyproj 3.6.0). Since I get the error from the subject also when 
> using projinfo (9.1.1 on ubuntu 22.04) I decided to ask here whether 
> there are any means to get a fallback to the old behavior?
>
> Thank you for providing this very useful library!
>
> Best regards,
> Michael
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From peter.loewe at gmx.de  Wed Mar 20 00:40:09 2024
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Wed, 20 Mar 2024 08:40:09 +0100
Subject: [PROJ] PROJ: Scientific citations 2022 - 2024 overview
Message-ID: <trinity-f2ee5b86-f43f-4121-be3c-bbe88ee6c16f-1710920409161@3c-app-gmx-bs15>

Hello PROJL community,

this is an update and preliminary summary about references to the GDAL project (and developer community) within scientific publications since 2022.

In 2022, a Digital Object Identifier (DOI) was registered for the PROJ project. Since then, each new release of PROJ receives a DOI an is being long term preserved in the scientific Open Access Repository Zenodo (https://doi.org/10.5281/zenodo.5884394), which is connected the DOI registration process.

Many persons from the PROJ developer team have connected their personal ORCID IDs (Open Researcher and Contributor ID) with the PROJ DOI. PROJ was the first OSGeo project to achieve this. The automated ORCI-DOI connection ensures that the ORCID accounts of the PROJ developers will receive automated updates (due scientfic credit) whenever a new PROJ release is published.

The DOI infrastructure allows to reference either the PROJ project as a whole or a particular PROJ version in scientific literature.

The PROJ project has become an early adopter regarding DOI use within OSGeo.

While there are still sometimes technical glitches in the PROJ-Zenodo-DOI workflows, there is now tangible proof of the resulting benefits:

Whenever PROJ software is referenced by DOI in a scientic journal (which uses the CrossRef infrastructure for bibliographic citations), this can now be tracked down and reported.

A listing of the publications citing PROJ in this manner is available here: https://wiki.osgeo.org/wiki/DOI#PROJ

PROJ has been referenced in publications from IEEE, Springer, American Geophysical Society, MDPI and other publishers.

Since 2022, five publications were reported (2022: 3 publications, 2023: 2 publications, 2024: pending).

While these numbers might appear small, this is a very interesting development about the recognition of open source software as a part of open science.

Congratulations & best regards,
Peter

PS: There are actually many more publications citing PROJ either traditionally or by DOI, such as the FOSS4G proceedings, but they are not connected to the CrossRef bibliography infrastructure (yet).



<peter.loewe at gmx.de>


From ulisesmartinibarra at gmail.com  Fri Mar 22 12:24:45 2024
From: ulisesmartinibarra at gmail.com (Ulises Ibarra)
Date: Fri, 22 Mar 2024 13:24:45 -0600
Subject: [PROJ] What is the syntax for a vertical datum change?
In-Reply-To: <CAP=Ak6ioX0KWAy8zgCkTsiaceBciPLAvPnqQ_ZSMDza7p3hVsQ@mail.gmail.com>
References: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
 <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>
 <CAP=Ak6ioX0KWAy8zgCkTsiaceBciPLAvPnqQ_ZSMDza7p3hVsQ@mail.gmail.com>
Message-ID: <CAP=Ak6htX4L+t1jiQ73_8pvFnoXK0-jz9GPA_3Gf-s_=CuScSw@mail.gmail.com>

Hello:
Continuing with the attempt to change from ellipsoidal heights to
orthometric heights. I executed the instruction:

echo 578174.247 3593725.312 1295.083 2010.0 | cct +proj=pipeline +step +inv
+proj=utm +zone=11 +ellps=WGS84 +step +proj=utm +zone=11 +ellps=WGS84
+proj=vgridshift +grids=/nubes/geoides/GGM10_GEO.gtx
  578174.2470   3593725.3120     1295.0830     2010.0000

But there is no change in heights. Could you tell me what I'm doing wrong,
please?

The file GGM10_GEO.gtx is the Mexican Gravimetric Geoid of 2010.
I don't know what the current era of the ellipsoid would be, for this
reason I assumed one: 2010.0

El vie, 15 mar 2024 a las 10:51, Ulises Ibarra (<
ulisesmartinibarra at gmail.com>) escribi?:

> Mr. Even, thanks You very much.
>
> El vie, 15 de mar de 2024, 1:42 a. m., Even Rouault <
> even.rouault at spatialys.com> escribi?:
>
>>
>> Le 15/03/2024 ? 06:27, Ulises Ibarra via PROJ a ?crit :
>>
>> Hello:
>> I am trying to change the vertical datum of a LIDAR LAS file. But first I
>> must understand the syntax of proj, but I can't understand it.
>>
>> If I use the following expression:
>> echo 747194.732 2307402.892 2037.133 | proj +proj=vgridshift
>> +grids=C:/clouds/geoids/GGM10_GEO.gtx
>>
>> "proj" is a legacy tool only for 2D cartographic projections. You want to
>> use cct instead: https://proj.org/en/9.4/apps/cct.html
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240322/ff489e87/attachment.htm>

From even.rouault at spatialys.com  Fri Mar 22 12:30:20 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Mar 2024 20:30:20 +0100
Subject: [PROJ] What is the syntax for a vertical datum change?
In-Reply-To: <CAP=Ak6htX4L+t1jiQ73_8pvFnoXK0-jz9GPA_3Gf-s_=CuScSw@mail.gmail.com>
References: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
 <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>
 <CAP=Ak6ioX0KWAy8zgCkTsiaceBciPLAvPnqQ_ZSMDza7p3hVsQ@mail.gmail.com>
 <CAP=Ak6htX4L+t1jiQ73_8pvFnoXK0-jz9GPA_3Gf-s_=CuScSw@mail.gmail.com>
Message-ID: <b5f84cce-e0c8-4bcb-8268-8753de2e9c93@spatialys.com>


Le 22/03/2024 ? 20:24, Ulises Ibarra via PROJ a ?crit?:
> Hello:
> Continuing with the attempt to change from ellipsoidal heights to 
> orthometric heights. I executed the instruction:
>
> echo 578174.247 3593725.312 1295.083 2010.0 | cct +proj=pipeline +step 
> +inv +proj=utm +zone=11 +ellps=WGS84 +step +proj=utm +zone=11 
> +ellps=WGS84 +proj=vgridshift +grids=/nubes/geoides/GGM10_GEO.gtx
> ? 578174.2470 ? 3593725.3120 ? ? 1295.0830 ? ? 2010.0000

Steps 2 and 3 should be inverted, and here's a missing +step keyword. It 
should rather be something like

+proj=pipeline +step +inv +proj=utm +zone=11 +ellps=WGS84 +step 
+proj=vgridshift +grids=/nubes/geoides/GGM10_GEO.gtx +step +proj=utm 
+zone=11 +ellps=WGS84


Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240322/66ca817f/attachment.htm>

From ulisesmartinibarra at gmail.com  Fri Mar 22 12:57:21 2024
From: ulisesmartinibarra at gmail.com (Ulises Ibarra)
Date: Fri, 22 Mar 2024 13:57:21 -0600
Subject: [PROJ] What is the syntax for a vertical datum change?
In-Reply-To: <b5f84cce-e0c8-4bcb-8268-8753de2e9c93@spatialys.com>
References: <CAP=Ak6jMWbpffcC7R+PXuv2BsynVdYRBCzTx00KySB-phocE8g@mail.gmail.com>
 <12e98784-91b7-4954-a364-5b92057fe86e@spatialys.com>
 <CAP=Ak6ioX0KWAy8zgCkTsiaceBciPLAvPnqQ_ZSMDza7p3hVsQ@mail.gmail.com>
 <CAP=Ak6htX4L+t1jiQ73_8pvFnoXK0-jz9GPA_3Gf-s_=CuScSw@mail.gmail.com>
 <b5f84cce-e0c8-4bcb-8268-8753de2e9c93@spatialys.com>
Message-ID: <CAP=Ak6hGNpKq4ORV2ERfO8-Y8onp-mheP-A6SxnvRs3=ii6-Ug@mail.gmail.com>

Thank you very much Even, it seems to work perfectly:

echo 578174.247 3593725.312 1295.083 2010.0 | cct +proj=pipeline +step +inv
+proj=utm +zone=11 +ellps=WGS84 +step +proj=vgridshift
+grids=/nubes/geoides/GGM10_GEO.gtx +step +proj=utm +zone=11 +ellps=WGS84
  578174.2470   3593725.3120     1329.6219     2010.0000

Ulises

El vie, 22 mar 2024 a las 13:30, Even Rouault (<even.rouault at spatialys.com>)
escribi?:

>
> Le 22/03/2024 ? 20:24, Ulises Ibarra via PROJ a ?crit :
>
> Hello:
> Continuing with the attempt to change from ellipsoidal heights to
> orthometric heights. I executed the instruction:
>
> echo 578174.247 3593725.312 1295.083 2010.0 | cct +proj=pipeline +step
> +inv +proj=utm +zone=11 +ellps=WGS84 +step +proj=utm +zone=11 +ellps=WGS84
> +proj=vgridshift +grids=/nubes/geoides/GGM10_GEO.gtx
>   578174.2470   3593725.3120     1295.0830     2010.0000
>
> Steps 2 and 3 should be inverted, and here's a missing +step keyword. It
> should rather be something like
>
> +proj=pipeline +step +inv +proj=utm +zone=11 +ellps=WGS84 +step
> +proj=vgridshift +grids=/nubes/geoides/GGM10_GEO.gtx +step +proj=utm
> +zone=11 +ellps=WGS84
>
> Even
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240322/a315a595/attachment.htm>

From roger.oberholtzer at gmail.com  Mon Mar 25 00:44:46 2024
From: roger.oberholtzer at gmail.com (Roger Oberholtzer)
Date: Mon, 25 Mar 2024 08:44:46 +0100
Subject: [PROJ] Meridian convergence
Message-ID: <CANkOqwNH_MQpq11ncQhDJ7d3HHxO-TxVwQT0GYCT=utj4mVpWA@mail.gmail.com>

I have been using proj_factors() to get the meridian convergence for a
given point. It has been working great. We need this when projecting LiDAR
points that involve multiple rotations. The code is something like this:

       PJ_FACTORS factors;
       PJ_COORD vals;

       vals.lp.lam = DegreesToRadians(point->LONGITUDE);
       vals.lp.phi = DegreesToRadians(point->LATITUDE);

       factors = proj_factors(tinfo->Meridian, vals);

       return(RadiansToDegrees(factors.meridian_convergence));

I have been using it with Sweref99 (EPSG:4326).

I have two questions:

Is proj_factors() the fastest way to get this information? A look at the
code shows that it is calculating other things as well. Is there is a
faster way? When generating point clouds, each contains 10s of millions of
points, and we generated 10s of thousands of these over a summer. Needless
to say, we are always looking for speedups.

Would this method work for all 'standard' projections? By 'standard' I mean
the typical ones used in, say, European countries. Would we need to
consider anything when extending this to something other than EPSG:4326?

-- 
Roger Oberholtzer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240325/775dd965/attachment.htm>

From kristianevers at gmail.com  Mon Mar 25 02:10:30 2024
From: kristianevers at gmail.com (Kristian Evers)
Date: Mon, 25 Mar 2024 10:10:30 +0100
Subject: [PROJ] Meridian convergence
In-Reply-To: <CANkOqwNH_MQpq11ncQhDJ7d3HHxO-TxVwQT0GYCT=utj4mVpWA@mail.gmail.com>
References: <CANkOqwNH_MQpq11ncQhDJ7d3HHxO-TxVwQT0GYCT=utj4mVpWA@mail.gmail.com>
Message-ID: <78DC98FF-BFC7-47D9-859A-F25191484CED@gmail.com>

Roger,

I believe using proj_factors() is the fastest way, yes. The current implementation has its roots in the very early days of PROJ.
If we were to implement the same functionality from scratch today they would likely be split into more smaller functions with
one purpose each. You could always implement your own custom version of it based on the PROJ code. Start here: 
https://github.com/OSGeo/PROJ/blob/master/src/factors.cpp

I doubt that your code is particularly useful, to be honest. If your are indeed using EPSG:4326 I believe you will get a meridian
convergence of 0.0 no matter what the input. The reason being that EPSG:4326 is not a projected CRS and hence you haven?t
got a grid north that can deviate from true north. Also, EPSG:4326 is not SWEREF99 - it is the WGS84 datum ensemble given
in geodetic coordinates. You are probably looking for one of the SWEREF99 TM CRS?s.

The meridian convergence calculation should work for most, if not any, projected CRS.

/Kristian

> On 25 Mar 2024, at 08.44, Roger Oberholtzer via PROJ <proj at lists.osgeo.org> wrote:
> 
> I have been using proj_factors() to get the meridian convergence for a given point. It has been working great. We need this when projecting LiDAR points that involve multiple rotations. The code is something like this:
> 
>        PJ_FACTORS factors; 
>        PJ_COORD vals;
> 
>        vals.lp.lam = DegreesToRadians(point->LONGITUDE); 
>        vals.lp.phi = DegreesToRadians(point->LATITUDE); 
>         
>        factors = proj_factors(tinfo->Meridian, vals); 
> 
>        return(RadiansToDegrees(factors.meridian_convergence));
> 
> I have been using it with Sweref99 (EPSG:4326).
> 
> I have two questions:
> 
> Is proj_factors() the fastest way to get this information? A look at the code shows that it is calculating other things as well. Is there is a faster way? When generating point clouds, each contains 10s of millions of points, and we generated 10s of thousands of these over a summer. Needless to say, we are always looking for speedups.
> 
> Would this method work for all 'standard' projections? By 'standard' I mean the typical ones used in, say, European countries. Would we need to consider anything when extending this to something other than EPSG:4326?
> 
> --
> Roger Oberholtzer
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240325/6d9529dc/attachment.htm>

From roger.oberholtzer at gmail.com  Mon Mar 25 03:15:15 2024
From: roger.oberholtzer at gmail.com (Roger Oberholtzer)
Date: Mon, 25 Mar 2024 11:15:15 +0100
Subject: [PROJ] Meridian convergence
In-Reply-To: <78DC98FF-BFC7-47D9-859A-F25191484CED@gmail.com>
References: <CANkOqwNH_MQpq11ncQhDJ7d3HHxO-TxVwQT0GYCT=utj4mVpWA@mail.gmail.com>
 <78DC98FF-BFC7-47D9-859A-F25191484CED@gmail.com>
Message-ID: <CANkOqwNBsjtwwxL30dd+EU8fbhG14nN1A7f7xXmtqNGv=_i=JA@mail.gmail.com>

On Mon, Mar 25, 2024 at 10:10?AM Kristian Evers <kristianevers at gmail.com>
wrote:

> Roger,
>
> I believe using proj_factors() is the fastest way, yes. The current
> implementation has its roots in the very early days of PROJ.
> If we were to implement the same functionality from scratch today they
> would likely be split into more smaller functions with
> one purpose each. You could always implement your own custom version of it
> based on the PROJ code. Start here:
> https://github.com/OSGeo/PROJ/blob/master/src/factors.cpp
>

I think I originally looked there when looking for a solution. IIRC it
wasn't obvious to me which bits to pick out for a potentially quicker
calculation. I may revisit this.


> I doubt that your code is particularly useful, to be honest. If your are
> indeed using EPSG:4326 I believe you will get a meridian
> convergence of 0.0 no matter what the input. The reason being that
> EPSG:4326 is not a projected CRS and hence you haven?t
> got a grid north that can deviate from true north. Also, EPSG:4326 is not
> SWEREF99 - it is the WGS84 datum ensemble given
> in geodetic coordinates. You are probably looking for one of the SWEREF99
> TM CRS?s.
>

In fact I do get a value. And it has a significant impact on our results.
We have two high resolution LiDAR units at 90 degrees to each other. If one
looks at something like a lamp post that was measured by both, without the
convergence value, the lamp post appears to split in two towards the top.
That is because we use the orientation from the GPS IMU for the point
rotations. Without the convergence, we are trying to use orientations with
a different origin (GPS IMU vs Sweref99 projection). We are very happy with
the results after we sorted this 'minor detail'.

The convergence sign matches the location of the GPS receiver's location
relative to the origin of Sweref99. Negative on one side, and positive on
the other. So there is even observable validity of the values.

The meridian convergence calculation should work for most, if not any,
> projected CRS.
>

Great!

-- 
Roger Oberholtzer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240325/20fc4902/attachment.htm>

From j1 at jimenezshaw.com  Tue Mar 26 07:34:05 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 26 Mar 2024 15:34:05 +0100
Subject: [PROJ] geoid model from a geographic 2D
Message-ID: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>

Hi

I am trying to add a geoid model for Singapore to my proj.db.
The problem is that the "source crs", SVY21 (EPSG:4757), is only defined as
Geographic 2D in EPSG
https://spatialreference.org/ref/?search=SVY21

If I add something like this (copied from other cases in
grid_transformation_custom.sql)

INSERT INTO "grid_transformation" VALUES(
    'PROJ','EPSG_4757_TO_EPSG_6916','SVY21 to SHD height',
    NULL,
    'EPSG','9665','Geographic3D to GravityRelatedHeight (gtx)',
    'EPSG','4757', -- source CRS (SVY21)
    'EPSG','6916', -- target CRS (SHD height)
    NULL,
    'EPSG','8666','Geoid (height correction) model file','SGeoid09.tif',
    NULL,NULL,NULL,NULL,NULL,NULL,NULL,0);

I get an error:
One grid_transformation with Geographic3D to GravityRelatedHeight or Geog3D
to Geog2D+XXX has not its source_crs in geodetic_crs table with type =
'geographic 3D'

I am using the method 9665 ... just because I am used to it. I could use a
different one. But I see that all available methods are expecting a
geographic 3D as source... that will trigger the same error.

Is there any way to workaround this condition?

Asking SLA to add a 3D system to EPSG is one way... but I would like to
have a solution earlier (or in case they just don't do it).

Thanks,
Javier.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240326/e6b939bd/attachment.htm>

From even.rouault at spatialys.com  Tue Mar 26 07:43:10 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Mar 2024 15:43:10 +0100
Subject: [PROJ] geoid model from a geographic 2D
In-Reply-To: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>
References: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>
Message-ID: <55a8942f-11bd-49f6-acdf-31abd2283913@spatialys.com>

Javier,
> I am trying to add a geoid model for Singapore to my proj.db.
> The problem is that the "source crs", SVY21 (EPSG:4757), is only 
> defined as Geographic 2D in EPSG
> https://spatialreference.org/ref/?search=SVY21
>
> If I add something like this (copied from other cases in 
> grid_transformation_custom.sql)
>
> INSERT INTO "grid_transformation" VALUES(
> ? ? 'PROJ','EPSG_4757_TO_EPSG_6916','SVY21 to SHD height',
> ? ? NULL,
> ? ? 'EPSG','9665','Geographic3D to GravityRelatedHeight (gtx)',
> ? ? 'EPSG','4757', -- source CRS (SVY21)
> ? ? 'EPSG','6916', -- target CRS (SHD height)
> ? ? NULL,
> ? ? 'EPSG','8666','Geoid (height correction) model file','SGeoid09.tif',
> ? ? NULL,NULL,NULL,NULL,NULL,NULL,NULL,0);
>
> I get an error:
> One grid_transformation with Geographic3D to GravityRelatedHeight or 
> Geog3D to Geog2D+XXX has not its source_crs in geodetic_crs table with 
> type = 'geographic 3D'
>
> I am using the method 9665 ... just because I am used to it. I could 
> use a different one. But I see that all available methods are 
> expecting a geographic 3D as source... that will trigger the same error.
Geoid models make only sense between a Geographic 3D CRS? and a Vertical 
CRS or Geog 2D CRS + Vertical CRS, so the check here is relevant. You 
need an ellipsoidal height at the source end. You could try to remove 
the check, but I don't think that's a good idea. I'm pretty sure there's 
logic in different places of the code that expect a Geographic 3D CRS in 
that situation.
>
> Is there any way to workaround this condition?
>
> Asking SLA to add a 3D system to EPSG is one way... but I would like 
> to have a solution earlier (or in case they just don't do it).

Would be the preferred solution, and also a record for their geoid model

Your workaround pending that is to add an entry in the geodetic_crs 
table (under the PROJ authority for now) to create a Geographic 3D CRS 
companion to EPSG:4757.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Tue Mar 26 09:15:09 2024
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 26 Mar 2024 12:15:09 -0400
Subject: [PROJ] geoid model from a geographic 2D
In-Reply-To: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>
 (Javier Jimenez Shaw via PROJ's message of "Tue, 26 Mar 2024 15:34:05
 +0100")
References: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>
Message-ID: <rmi4jct6kc2.fsf@s1.lexort.com>

Javier Jimenez Shaw via PROJ <proj at lists.osgeo.org> writes:

> I am trying to add a geoid model for Singapore to my proj.db.
> The problem is that the "source crs", SVY21 (EPSG:4757), is only defined as
> Geographic 2D in EPSG
> https://spatialreference.org/ref/?search=SVY21

What does it mean to have a geoid model for a 2D CRS?

It looks like the model is for SVY21 to some national orthometric height.

Is it that the CRS SVY21, is in reality a lat/lon/HAE system, but that
it is miscoded in EPSG as 2D (or only the projection to 2D is listed)?

Do you in fact have HAE that are in SVY21?


All that said, manually loading a CRS into your DB that is what
"Singapore Geodetic Survey" should have asked EPSG to add, makes sense
to me.

From j1 at jimenezshaw.com  Wed Mar 27 09:14:31 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 27 Mar 2024 17:14:31 +0100
Subject: [PROJ] geoid model from a geographic 2D
In-Reply-To: <55a8942f-11bd-49f6-acdf-31abd2283913@spatialys.com>
References: <CADRrdKvJirByq-+UDn_oJ8Azm-td3B45ZZLML_+1c++vi9Guaw@mail.gmail.com>
 <55a8942f-11bd-49f6-acdf-31abd2283913@spatialys.com>
Message-ID: <CADRrdKs_SDXv9rxEQ5GdaHy8y=YPzeW5zxwebe7X_Fviyz=o3Q@mail.gmail.com>

Thanks Even.

Until I move this with the SLA, the workaround of a new entry in
geodetic_crs works fine (and the corresponding in usage)

On Tue, 26 Mar 2024 at 15:43, Even Rouault <even.rouault at spatialys.com>
wrote:

> Javier,
> > I am trying to add a geoid model for Singapore to my proj.db.
> > The problem is that the "source crs", SVY21 (EPSG:4757), is only
> > defined as Geographic 2D in EPSG
> > https://spatialreference.org/ref/?search=SVY21
> >
> > If I add something like this (copied from other cases in
> > grid_transformation_custom.sql)
> >
> > INSERT INTO "grid_transformation" VALUES(
> >     'PROJ','EPSG_4757_TO_EPSG_6916','SVY21 to SHD height',
> >     NULL,
> >     'EPSG','9665','Geographic3D to GravityRelatedHeight (gtx)',
> >     'EPSG','4757', -- source CRS (SVY21)
> >     'EPSG','6916', -- target CRS (SHD height)
> >     NULL,
> >     'EPSG','8666','Geoid (height correction) model file','SGeoid09.tif',
> >     NULL,NULL,NULL,NULL,NULL,NULL,NULL,0);
> >
> > I get an error:
> > One grid_transformation with Geographic3D to GravityRelatedHeight or
> > Geog3D to Geog2D+XXX has not its source_crs in geodetic_crs table with
> > type = 'geographic 3D'
> >
> > I am using the method 9665 ... just because I am used to it. I could
> > use a different one. But I see that all available methods are
> > expecting a geographic 3D as source... that will trigger the same error.
> Geoid models make only sense between a Geographic 3D CRS  and a Vertical
> CRS or Geog 2D CRS + Vertical CRS, so the check here is relevant. You
> need an ellipsoidal height at the source end. You could try to remove
> the check, but I don't think that's a good idea. I'm pretty sure there's
> logic in different places of the code that expect a Geographic 3D CRS in
> that situation.
> >
> > Is there any way to workaround this condition?
> >
> > Asking SLA to add a 3D system to EPSG is one way... but I would like
> > to have a solution earlier (or in case they just don't do it).
>
> Would be the preferred solution, and also a record for their geoid model
>
> Your workaround pending that is to add an entry in the geodetic_crs
> table (under the PROJ authority for now) to create a Geographic 3D CRS
> companion to EPSG:4757.
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240327/2d2541a8/attachment.htm>

From simon.eves at heavy.ai  Wed Mar 27 19:06:18 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Wed, 27 Mar 2024 19:06:18 -0700
Subject: [PROJ] Unexpected CRS Validation Error
Message-ID: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>

When trying to import this Shapefile bundle into our system with GDAL...

https://drive.google.com/file/d/13Mwhnugcy8HrnGlc81gyroxnp9s15Skt/view?usp=sharing

...we get an *OGRERR_CORRUPT_DATA* from *OGRSpatialReference::Validate()*
on the SR obtained from the first feature.

Tracing through the GDAL and PROJ code, this appears to be because the PROJ
import of that CRS results in the following WKT Import Error from PROJ...


*Coordinate system of GeographicCRS in the WKT definition is different from
the one of the authority. Unsetting the identifier to avoid confusion*

...and any WKT Import Error makes GDAL report that error code.

The PROJ code throws this in *WKTParser::Private::buildGeodeticCRS*
(io.cpp:3229 in 9.3.0) which is old code (although the second branch which
can throw the same error was seemingly added between 8.2 and 9.3 in
https://github.com/OSGeo/PROJ/pull/3274 ...but it's the first branch that's
triggering in this case).

*ogrinfo* on the Shapefile reports no errors or warnings, although it does
report a CRS ID of 9001 even though it reports WGS84 elsewhere in the CRS
block.

I was able to trivially *ogr2ogr* it to GeoJSON, also with no errors or
warnings, and that imports with no issue.

Is there an actual problem (a bad file) here, or are we doing something
wrong?

Thanks, as ever, in advance.

-- 
Simon Eves
Senior Rendering Engineer
+1 (415) 902-1996
simon.eves at heavy.ai

<http://www.heavy.ai>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240327/c1cfd638/attachment.htm>

From j1 at jimenezshaw.com  Wed Mar 27 23:55:29 2024
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Thu, 28 Mar 2024 07:55:29 +0100
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
Message-ID: <CADRrdKs0BO39vL26_pz_spC4+2Zoo1wyYF5VGjmq2dzh6eWLUw@mail.gmail.com>

The definition of the CRS is in the .prj file of the shapefile, as plain
text. In this case:

GEOGCS["WGS84(DD)", DATUM["WGS84", SPHEROID["WGS84", 6378137.0,
298.257223563]], PRIMEM["Greenwich", 0.0], UNIT["degree",
0.017453292519943295], AXIS["Geodetic longitude", EAST], AXIS["Geodetic
latitude", NORTH], AUTHORITY["EPSG","4326"]]

That formal definition of EPSG:4326 is northing-easting, and that WKT is
saying easting-northing. So there is an inconsistency in the definition of
the system, because at the end it says that the authority is EPSG:4326
You can either remove the axis or the final authority (the error message
says that proj is removing the authority ;)

The axis order I think is not used to read the coordinates in a shp file,
so the outputs should be the same.

The actual definition of EPSG:4326 in ESRI (from
https://spatialreference.org/ref/epsg/4326/esriwkt.txt)
GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]

In case anybody needs an equivalent to EPSG:4326 but easting-northing in
other context, there is https://spatialreference.org/ref/ogc/CRS84/

Cheers,
Javier

On Thu, 28 Mar 2024 at 03:06, Simon Eves via PROJ <proj at lists.osgeo.org>
wrote:

> When trying to import this Shapefile bundle into our system with GDAL...
>
>
> https://drive.google.com/file/d/13Mwhnugcy8HrnGlc81gyroxnp9s15Skt/view?usp=sharing
>
> ...we get an *OGRERR_CORRUPT_DATA* from *OGRSpatialReference::Validate()*
> on the SR obtained from the first feature.
>
> Tracing through the GDAL and PROJ code, this appears to be because the
> PROJ import of that CRS results in the following WKT Import Error from
> PROJ...
>
>
> *Coordinate system of GeographicCRS in the WKT definition is different
> from the one of the authority. Unsetting the identifier to avoid confusion*
>
> ...and any WKT Import Error makes GDAL report that error code.
>
> The PROJ code throws this in *WKTParser::Private::buildGeodeticCRS*
> (io.cpp:3229 in 9.3.0) which is old code (although the second branch which
> can throw the same error was seemingly added between 8.2 and 9.3 in
> https://github.com/OSGeo/PROJ/pull/3274 ...but it's the first branch
> that's triggering in this case).
>
> *ogrinfo* on the Shapefile reports no errors or warnings, although it
> does report a CRS ID of 9001 even though it reports WGS84 elsewhere in the
> CRS block.
>
> I was able to trivially *ogr2ogr* it to GeoJSON, also with no errors or
> warnings, and that imports with no issue.
>
> Is there an actual problem (a bad file) here, or are we doing something
> wrong?
>
> Thanks, as ever, in advance.
>
> --
> Simon Eves
> Senior Rendering Engineer
> +1 (415) 902-1996
> simon.eves at heavy.ai
>
> <http://www.heavy.ai>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240328/c0de0704/attachment.htm>

From even.rouault at spatialys.com  Thu Mar 28 08:10:23 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Mar 2024 16:10:23 +0100
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
Message-ID: <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>

Hi,

just a few complements to Javier's analysis:

- what you observe and what Javier mentioned applies if you import 
directly the .prj WKT content, but the GDAL shapefile driver actually 
replaces this not pretty WKT with a cleaned version of EPSG:4326 (at 
least with GDAL+PROJ master), so if you use the high level GDAL API, 
things should work smoothly

- the 9001 ID you observe when looking at the WKT2 output of the result 
of the ingestion of the .prj? is *not* a CRS ID. It is the ID of the 
ellipsoid's lengthunit=metre. You can have several IDs in a WKT 
definition: for the CRS, datum, ellipsoid, projection method, projection 
parameter, units, etc. They only apply to the node to which they are 
applied to. In some contexts, they are advised to be omitted. The 
general rule is "if you know the id of a top-level object, you can omit 
the IDs of its child elements, except in several cases". All gory 
details at https://www.ogc.org/standard/wkt-crs/

So all in all, to me things are working as expected. It is mostly you 
deal with a a slightly non-compliant .prj file

Even

Le 28/03/2024 ? 03:06, Simon Eves via PROJ a ?crit?:
> When trying to import this Shapefile bundle into our system with GDAL...
>
> https://drive.google.com/file/d/13Mwhnugcy8HrnGlc81gyroxnp9s15Skt/view?usp=sharing
>
> ...we get an *OGRERR_CORRUPT_DATA* from 
> *OGRSpatialReference::Validate()* on the SR obtained from the first 
> feature.
>
> Tracing through the GDAL and PROJ code, this appears to be because the 
> PROJ import of that CRS results in the following WKT Import Error from 
> PROJ...
>
> /Coordinate system of GeographicCRS in the WKT definition is different 
> from the one of the authority. Unsetting the identifier to avoid confusion
> /
>
> ...and any WKT Import Error makes GDAL report that error code.
>
> The PROJ code throws this in *WKTParser::Private::buildGeodeticCRS* 
> (io.cpp:3229 in 9.3.0) which is old code (although the second branch 
> which can throw the same error was seemingly added between 8.2 and 9.3 
> in https://github.com/OSGeo/PROJ/pull/3274 ...but it's the first 
> branch that's triggering in this case).
>
> *ogrinfo* on the Shapefile reports no errors or warnings, although it 
> does report a CRS ID of 9001?even though it reports WGS84 elsewhere in 
> the CRS block.
>
> I was able to trivially *ogr2ogr* it to GeoJSON, also with no errors 
> or warnings, and that imports?with no issue.
>
> Is there an actual problem (a bad file) here, or are we doing 
> something wrong?
>
> Thanks, as ever, in advance.
>
> -- 
> Simon Eves
> Senior Rendering Engineer
> +1 (415) 902-1996
> simon.eves at heavy.ai
>
> <http://www.heavy.ai>
>
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240328/a04459f3/attachment.htm>

From simon.eves at heavy.ai  Thu Mar 28 09:35:53 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Thu, 28 Mar 2024 09:35:53 -0700
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
 <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>
Message-ID: <CAJf0KTSkLFhNSoKPxvG87gaXF-3Lz3UNPrCrYfP=mP-1tvt1Bw@mail.gmail.com>

Thanks for this, chaps. That certainly explains the original of the issue.

My remaining question, if GDAL is going to declare the resulting SR as
invalid, is whether that is grounds for rejecting the file completely,
given that GDAL does not expose those warnings when converting it to
another format. In other words, should we actually bother calling
*Validate()* at all, or just keep our head in the sand and continue with
the import anyway?

That said, I note that the PROJ code calls *emitRecoverableWarning()* in
this case, and yet the resulting string ends up in *m_wktImportErrors* in
GDAL and thus triggers the hard error. Surely if it's a warning, the string
should end up in *m_wktImportWarnings*, which would be *CPLDebug*'d but NOT
trigger the hard error.

Simon

On Thu, Mar 28, 2024 at 8:10?AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> just a few complements to Javier's analysis:
>
> - what you observe and what Javier mentioned applies if you import
> directly the .prj WKT content, but the GDAL shapefile driver actually
> replaces this not pretty WKT with a cleaned version of EPSG:4326 (at least
> with GDAL+PROJ master), so if you use the high level GDAL API, things
> should work smoothly
>
> - the 9001 ID you observe when looking at the WKT2 output of the result of
> the ingestion of the .prj  is *not* a CRS ID. It is the ID of the
> ellipsoid's lengthunit=metre. You can have several IDs in a WKT definition:
> for the CRS, datum, ellipsoid, projection method, projection parameter,
> units, etc. They only apply to the node to which they are applied to. In
> some contexts, they are advised to be omitted. The general rule is "if you
> know the id of a top-level object, you can omit the IDs of its child
> elements, except in several cases". All gory details at
> https://www.ogc.org/standard/wkt-crs/
>
> So all in all, to me things are working as expected. It is mostly you deal
> with a a slightly non-compliant .prj file
>
> Even
> Le 28/03/2024 ? 03:06, Simon Eves via PROJ a ?crit :
>
> When trying to import this Shapefile bundle into our system with GDAL...
>
>
> https://drive.google.com/file/d/13Mwhnugcy8HrnGlc81gyroxnp9s15Skt/view?usp=sharing
>
> ...we get an *OGRERR_CORRUPT_DATA* from *OGRSpatialReference::Validate()*
> on the SR obtained from the first feature.
>
> Tracing through the GDAL and PROJ code, this appears to be because the
> PROJ import of that CRS results in the following WKT Import Error from
> PROJ...
>
>
> *Coordinate system of GeographicCRS in the WKT definition is different
> from the one of the authority. Unsetting the identifier to avoid confusion *
>
> ...and any WKT Import Error makes GDAL report that error code.
>
> The PROJ code throws this in *WKTParser::Private::buildGeodeticCRS*
> (io.cpp:3229 in 9.3.0) which is old code (although the second branch which
> can throw the same error was seemingly added between 8.2 and 9.3 in
> https://github.com/OSGeo/PROJ/pull/3274 ...but it's the first branch
> that's triggering in this case).
>
> *ogrinfo* on the Shapefile reports no errors or warnings, although it
> does report a CRS ID of 9001 even though it reports WGS84 elsewhere in the
> CRS block.
>
> I was able to trivially *ogr2ogr* it to GeoJSON, also with no errors or
> warnings, and that imports with no issue.
>
> Is there an actual problem (a bad file) here, or are we doing something
> wrong?
>
> Thanks, as ever, in advance.
>
> --
> Simon Eves
> Senior Rendering Engineer
> +1 (415) 902-1996
> simon.eves at heavy.ai
>
> <http://www.heavy.ai>
>
> _______________________________________________
> PROJ mailing listPROJ at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/proj
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240328/39aae6fc/attachment-0001.htm>

From simon.eves at heavy.ai  Thu Mar 28 09:47:03 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Thu, 28 Mar 2024 09:47:03 -0700
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <CAJf0KTSkLFhNSoKPxvG87gaXF-3Lz3UNPrCrYfP=mP-1tvt1Bw@mail.gmail.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
 <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>
 <CAJf0KTSkLFhNSoKPxvG87gaXF-3Lz3UNPrCrYfP=mP-1tvt1Bw@mail.gmail.com>
Message-ID: <CAJf0KTR0VG-aztR2Dq=gcmh6NDrv=tj8KN4_MJEu+rv5M_E-2Q@mail.gmail.com>

Seems like whether a PROJ warning is reported as an error or warning
depends on whether it has "Default it to" in the text. This one does not,
and is returned as an error. The logic here is unclear to me.

On Thu, Mar 28, 2024 at 9:35?AM Simon Eves <simon.eves at heavy.ai> wrote:

> Thanks for this, chaps. That certainly explains the original of the issue.
>
> My remaining question, if GDAL is going to declare the resulting SR as
> invalid, is whether that is grounds for rejecting the file completely,
> given that GDAL does not expose those warnings when converting it to
> another format. In other words, should we actually bother calling
> *Validate()* at all, or just keep our head in the sand and continue with
> the import anyway?
>
> That said, I note that the PROJ code calls *emitRecoverableWarning()* in
> this case, and yet the resulting string ends up in *m_wktImportErrors* in
> GDAL and thus triggers the hard error. Surely if it's a warning, the string
> should end up in *m_wktImportWarnings*, which would be *CPLDebug*'d but
> NOT trigger the hard error.
>
> Simon
>
> On Thu, Mar 28, 2024 at 8:10?AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> just a few complements to Javier's analysis:
>>
>> - what you observe and what Javier mentioned applies if you import
>> directly the .prj WKT content, but the GDAL shapefile driver actually
>> replaces this not pretty WKT with a cleaned version of EPSG:4326 (at least
>> with GDAL+PROJ master), so if you use the high level GDAL API, things
>> should work smoothly
>>
>> - the 9001 ID you observe when looking at the WKT2 output of the result
>> of the ingestion of the .prj  is *not* a CRS ID. It is the ID of the
>> ellipsoid's lengthunit=metre. You can have several IDs in a WKT definition:
>> for the CRS, datum, ellipsoid, projection method, projection parameter,
>> units, etc. They only apply to the node to which they are applied to. In
>> some contexts, they are advised to be omitted. The general rule is "if you
>> know the id of a top-level object, you can omit the IDs of its child
>> elements, except in several cases". All gory details at
>> https://www.ogc.org/standard/wkt-crs/
>>
>> So all in all, to me things are working as expected. It is mostly you
>> deal with a a slightly non-compliant .prj file
>>
>> Even
>> Le 28/03/2024 ? 03:06, Simon Eves via PROJ a ?crit :
>>
>> When trying to import this Shapefile bundle into our system with GDAL...
>>
>>
>> https://drive.google.com/file/d/13Mwhnugcy8HrnGlc81gyroxnp9s15Skt/view?usp=sharing
>>
>> ...we get an *OGRERR_CORRUPT_DATA* from *OGRSpatialReference::Validate()*
>> on the SR obtained from the first feature.
>>
>> Tracing through the GDAL and PROJ code, this appears to be because the
>> PROJ import of that CRS results in the following WKT Import Error from
>> PROJ...
>>
>>
>> *Coordinate system of GeographicCRS in the WKT definition is different
>> from the one of the authority. Unsetting the identifier to avoid confusion *
>>
>> ...and any WKT Import Error makes GDAL report that error code.
>>
>> The PROJ code throws this in *WKTParser::Private::buildGeodeticCRS*
>> (io.cpp:3229 in 9.3.0) which is old code (although the second branch which
>> can throw the same error was seemingly added between 8.2 and 9.3 in
>> https://github.com/OSGeo/PROJ/pull/3274 ...but it's the first branch
>> that's triggering in this case).
>>
>> *ogrinfo* on the Shapefile reports no errors or warnings, although it
>> does report a CRS ID of 9001 even though it reports WGS84 elsewhere in the
>> CRS block.
>>
>> I was able to trivially *ogr2ogr* it to GeoJSON, also with no errors or
>> warnings, and that imports with no issue.
>>
>> Is there an actual problem (a bad file) here, or are we doing something
>> wrong?
>>
>> Thanks, as ever, in advance.
>>
>> --
>> Simon Eves
>> Senior Rendering Engineer
>> +1 (415) 902-1996
>> simon.eves at heavy.ai
>>
>> <http://www.heavy.ai>
>>
>> _______________________________________________
>> PROJ mailing listPROJ at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/proj
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240328/e30ccf19/attachment.htm>

From even.rouault at spatialys.com  Thu Mar 28 10:51:58 2024
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Mar 2024 18:51:58 +0100
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <CAJf0KTR0VG-aztR2Dq=gcmh6NDrv=tj8KN4_MJEu+rv5M_E-2Q@mail.gmail.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
 <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>
 <CAJf0KTSkLFhNSoKPxvG87gaXF-3Lz3UNPrCrYfP=mP-1tvt1Bw@mail.gmail.com>
 <CAJf0KTR0VG-aztR2Dq=gcmh6NDrv=tj8KN4_MJEu+rv5M_E-2Q@mail.gmail.com>
Message-ID: <dff28e63-0e1a-4565-8763-885d1b3d2ed4@spatialys.com>


Le 28/03/2024 ? 17:47, Simon Eves a ?crit?:
> Seems like whether a PROJ warning is reported as an error or warning 
> depends on whether it has "Default it to" in the text. This one does 
> not, and is returned as an error. The logic here is unclear to me.

yes, there was indeed a discrepancy between the documented behavior of 
the PROJ C API and what the PROJ C++ API offered to fulfill it. That 
should be solved by https://github.com/OSGeo/PROJ/pull/4108

However as noted in the updated documentation, the distinction between 
warnings and errors is probably not that much relevant, and the mapping 
to the OSRValidate() API that dates backs to well before the complete 
revanp done in PROJ 6+GDAL 3 is even more arbitrary. The bottom line is 
that if OSRValidate() returns a non-OGRERR_NONE code, there's something 
that is non nominal, and human expertise is required to assess if it can 
be ignored or not.


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From simon.eves at heavy.ai  Thu Mar 28 11:21:54 2024
From: simon.eves at heavy.ai (Simon Eves)
Date: Thu, 28 Mar 2024 11:21:54 -0700
Subject: [PROJ] Unexpected CRS Validation Error
In-Reply-To: <dff28e63-0e1a-4565-8763-885d1b3d2ed4@spatialys.com>
References: <CAJf0KTRMn_LrVKq78CPQjWU4cKDByuhbnpJESe2N+XdxT+e6XA@mail.gmail.com>
 <1e49d43d-42f8-4c87-aed3-3800f20d6e00@spatialys.com>
 <CAJf0KTSkLFhNSoKPxvG87gaXF-3Lz3UNPrCrYfP=mP-1tvt1Bw@mail.gmail.com>
 <CAJf0KTR0VG-aztR2Dq=gcmh6NDrv=tj8KN4_MJEu+rv5M_E-2Q@mail.gmail.com>
 <dff28e63-0e1a-4565-8763-885d1b3d2ed4@spatialys.com>
Message-ID: <CAJf0KTTmj3WwtfMhtUg4FFepzYyq2BHtFQ3f_MAV+UCG-yY8NQ@mail.gmail.com>

OK, thanks.

Unfortunately, in our case, an error from *OSRValidate()* aborts the import
completely. At the GDAL API level, there is no way to tell if it could be
ignored or not, as it all gets collapsed into a single error code.

Presumably if the CRS was truly bad, the subsequent
*OGRCreateCoordinateTransformation(bad_sr_from_file,
desired_good_sr)* would fail, which we would obviously also abort on.

Sounds like we should just remove the *OSRValidate()* test, which would
allow this file to import, but ones that were "more bad" would still be
rejected later.

Simon


On Thu, Mar 28, 2024 at 10:51?AM Even Rouault <even.rouault at spatialys.com>
wrote:

>
> Le 28/03/2024 ? 17:47, Simon Eves a ?crit :
> > Seems like whether a PROJ warning is reported as an error or warning
> > depends on whether it has "Default it to" in the text. This one does
> > not, and is returned as an error. The logic here is unclear to me.
>
> yes, there was indeed a discrepancy between the documented behavior of
> the PROJ C API and what the PROJ C++ API offered to fulfill it. That
> should be solved by https://github.com/OSGeo/PROJ/pull/4108
>
> However as noted in the updated documentation, the distinction between
> warnings and errors is probably not that much relevant, and the mapping
> to the OSRValidate() API that dates backs to well before the complete
> revanp done in PROJ 6+GDAL 3 is even more arbitrary. The bottom line is
> that if OSRValidate() returns a non-OGRERR_NONE code, there's something
> that is non nominal, and human expertise is required to assess if it can
> be ignored or not.
>
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240328/87495f35/attachment.htm>

From mircea at neacsu.net  Sat Mar 30 15:46:05 2024
From: mircea at neacsu.net (mircea at neacsu.net)
Date: Sat, 30 Mar 2024 18:46:05 -0400
Subject: [PROJ] Sndyer Map Projections Manual in HTML form
Message-ID: <002c01da82f4$12b2cdb0$38186910$@neacsu.net>

Hello,

 ?

My work of converting Snyder ? Map Projection Manual <https://neacsu.net/docs/geodesy/snyder/>  to HTML is almost finished. Probably the most interesting part are the numerical examples <https://neacsu.net/docs/geodesy/snyder/numerics/> , implemented using JavaScript. All formulas can be recalculated, and one can see all the intermediate steps and the result of those calculations. 

 ?

I would very much like to hear your comments. Given the number of formulas, I?m sure there are many errors that have slipped through, and I will be grateful if you will point those out.

 ?

Thank you,

-- 

  

Mircea Neacsu

 ?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20240330/4ed8a718/attachment.htm>

