From charles.karney at sri.com  Wed Dec  7 06:10:56 2011
From: charles.karney at sri.com (Charles Karney)
Date: Wed, 7 Dec 2011 09:10:56 -0500
Subject: [Proj] Earth gravity (and magnetic) models in GeographicLib
Message-ID: <20191.29680.466764.646427@puffin.sarnoff.com>

I've added earth gravity models to GeographicLib.  This allows you to
compute quantities like the gravitational field, the deflections of the
vertical, and the geoid height directly from the EGM2008 (or EGM96 or
EGM84) model coefficients.  For details see

  http://geographiclib.sourceforge.net/html/gravity.html

My development of this capability in GeographicLib relied, in part, on
the code for EGM_Geoid_CalculatorClass by Mathieu Peyréga.

GeographicLib is able to reproduce accurately the gridded data for
EGM2008 published by the NGA.  Single point calculations for EGM2008 are
rather slow (78 ms for the geoid height).  However the computations can
be sped up by a factor of 800 by computing several points on a circle of
latitude and by using, for example, OpenMP, for parallel processing.
Thus, on my 8-processor desktop machine I can compute the global 1' grid
of geoid heights in 40 mins (i.e., about 10 us per point).

P.S. Magnetic models are also supported, see

  http://geographiclib.sourceforge.net/html/magnetic.html

-- 
Charles Karney <charles.karney at sri.com>
SRI International, Princeton, NJ 08543-5300

Tel: +1 609 734 2312
Fax: +1 609 734 2662


From c.bondue at hotmail.com  Wed Dec  7 12:58:35 2011
From: c.bondue at hotmail.com (Cyril Bondue)
Date: Wed, 7 Dec 2011 20:58:35 +0000
Subject: [Proj] Proj4js, cs2cs and pj_transform
Message-ID: <BAY151-W53E39FD30BEA6C3AB63A8395BB0@phx.gbl>


Hello fellow coders!

I'm writing to ask for your help. I need to convert data from NTF (Paris) / Lambert Centre France (epsg 27562) to WGS84 (epsg 4326). To test Proj4 I used the web interface Proj4js, and i could do the conversion without much troubles. Here are the two projPj I used, and working :
 - source : +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs
 - dest : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
Good! But I need to do the conversion in a C++ program, so I downloaded the source, downloaded the NAD for France (who were already in the archive BTW), compiled with MinGW (i'm doing a Windows software), compilation runs without problems, great!

Now, troubles ^^
Here is my code :

projPJ source = pj_init_plus("+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs");
projPJ dest = pj_init_plus("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs");

double x = 535003.285368d;
double y = 200358.358412d;
pj_transform(source, dest, 1, 1, &x, &y, NULL);

pj_transform returns 0 (OK), but x and y are wrong. I have x=0.0259181 and y=0.816814 while the correct results are 1.485 and 46.8 (rounded up), results that Proj4Js confirms.
I also tried the same transformation on cs2cs :
cs2cs.exe +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356 515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs +to +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
535003.285368 200358.358412
Results are different and also wrong (or i can't read them right) x=1d29'6"E, y=46d48'N 44.005

I have taken care of settings PROJ_LIB with the nad folder. So i must do something wrong, i've tried many things but i don't understand what happens, so here I am, asking you for some assistance. Can you see what's going on?

Thank you in advance!

Cyril
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20111207/d9e830b8/attachment.html>

From ericnico.david at gmail.com  Wed Dec  7 13:57:43 2011
From: ericnico.david at gmail.com (nicolas david)
Date: Wed, 7 Dec 2011 22:57:43 +0100
Subject: [Proj] Proj4js, cs2cs and pj_transform
In-Reply-To: <BAY151-W53E39FD30BEA6C3AB63A8395BB0@phx.gbl>
References: <BAY151-W53E39FD30BEA6C3AB63A8395BB0@phx.gbl>
Message-ID: <CACuRz0twKV4wHMY9OXRy6de--kmeRaQB3OGUCH=csuE6DhvZUQ@mail.gmail.com>

Hi

pj_transform use lat/long coordinate in radian. So you have to convert them
to degree with  "RAD_TO_DEG "  defined at the value  57.29577951308232 in
proj_api.h

Nicolas

2011/12/7 Cyril Bondue <c.bondue at hotmail.com>

>  Hello fellow coders!
>
> I'm writing to ask for your help. I need to convert data from NTF (Paris)
> / Lambert Centre France (epsg 27562) to WGS84 (epsg 4326). To test Proj4 I
> used the web interface Proj4js, and i could do the conversion without much
> troubles. Here are the two projPj I used, and working :
>  - source : +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742
> +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515
> +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs
>  - dest : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> Good! But I need to do the conversion in a C++ program, so I downloaded
> the source, downloaded the NAD for France (who were already in the archive
> BTW), compiled with MinGW (i'm doing a Windows software), compilation runs
> without problems, great!
>
> Now, troubles ^^
> Here is my code :
>
> projPJ source = pj_init_plus("+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0
> +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515
> +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs");
> projPJ dest = pj_init_plus("+proj=longlat +ellps=WGS84 +datum=WGS84
> +no_defs");
>
> double x = 535003.285368d;
> double y = 200358.358412d;
> pj_transform(source, dest, 1, 1, &x, &y, NULL);
>
> pj_transform returns 0 (OK), but x and y are wrong. I have x=0.0259181 and
> y=0.816814 while the correct results are 1.485 and 46.8 (rounded up),
> results that Proj4Js confirms.
> I also tried the same transformation on cs2cs :
> cs2cs.exe +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742
> +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356 515
> +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs +to +proj=longlat
> +ellps=WGS84 +datum=WGS84 +no_defs
> 535003.285368 200358.358412
> Results are different and also wrong (or i can't read them right)
> x=1d29'6"E, y=46d48'N 44.005
>
> I have taken care of settings PROJ_LIB with the nad folder. So i must do
> something wrong, i've tried many things but i don't understand what
> happens, so here I am, asking you for some assistance. Can you see what's
> going on?
>
> Thank you in advance!
>
> Cyril
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20111207/f79dab27/attachment.html>

From jrepetto at free.fr  Thu Dec  8 00:35:57 2011
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Thu, 08 Dec 2011 09:35:57 +0100
Subject: [Proj] Proj4js, cs2cs and pj_transform
In-Reply-To: <BAY151-W53E39FD30BEA6C3AB63A8395BB0@phx.gbl>
References: <BAY151-W53E39FD30BEA6C3AB63A8395BB0@phx.gbl>
Message-ID: <4EE076ED.9090208@free.fr>

Le 07/12/2011 21:58, Cyril Bondue a écrit :

> Correct results are 1.485 and 46.8 (rounded
> up), results that Proj4Js confirms.

> I also tried the same transformation on cs2cs :
> cs2cs.exe +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742
> +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356 515
> +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs +to
> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> 535003.285368 200358.358412
> Results are different and also wrong (or i can't read them right)
> x=1d29'6"E, y=46d48'N 44.005"

No, these results are correct.

Jean-Claude



From roger at opq.se  Thu Dec  8 03:37:11 2011
From: roger at opq.se (Roger Oberholtzer)
Date: Thu, 08 Dec 2011 12:37:11 +0100
Subject: [Proj] Projection advice
Message-ID: <1323344231.7350.57.camel@acme.pacific>

I have a system that starts with WGS84 lat/long, projects them so as to
obtain northings/eastings, does some fiddling with the locations, and
then converts them back in to WGS84 lat/long. The conversion from/to
lat/long is done by proj. The fiddling with the northings/eastings is
done based on some INS that provides relative movement information in
meters. Only the WGS84 lat/longs are kept.

Currently, I use a projection for the local region. The thought was that
this would best 'match' the INS movements, which are of course always
local. I would like to generalize this solution by perhaps not using a
local projection. Instead use a generic projection everywhere. It seems
reasonable to do this as (1) the projection will not be kept, and (2)
the movements applied to the projections are relative.

My question is; is there a 'best' projection to use for such a
procedure?


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From ndzinn at comcast.net  Thu Dec  8 04:41:23 2011
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Thu, 8 Dec 2011 06:41:23 -0600
Subject: [Proj] Projection advice
In-Reply-To: <1323344231.7350.57.camel@acme.pacific>
References: <1323344231.7350.57.camel@acme.pacific>
Message-ID: <5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>

Roger,

Presumably you want a conformal projection so that the scale distortion is 
uniform in all directions.  Does the INS fiddling in Northings/Easting 
account for scale distortion (point scale factor) at all, or does it presume 
there is no scale distortion?  If the latter, then the larger the area your 
generic projection covers, the greater the scale distortion your INS 
fiddling will ignore.  That may not be a good change from your current, 
local-projection procedure.

Noel

Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)

-----Original Message----- 
From: Roger Oberholtzer
Sent: Thursday, December 08, 2011 5:37 AM
To: proj at lists.maptools.org
Subject: [Proj] Projection advice

I have a system that starts with WGS84 lat/long, projects them so as to
obtain northings/eastings, does some fiddling with the locations, and
then converts them back in to WGS84 lat/long. The conversion from/to
lat/long is done by proj. The fiddling with the northings/eastings is
done based on some INS that provides relative movement information in
meters. Only the WGS84 lat/longs are kept.

Currently, I use a projection for the local region. The thought was that
this would best 'match' the INS movements, which are of course always
local. I would like to generalize this solution by perhaps not using a
local projection. Instead use a generic projection everywhere. It seems
reasonable to do this as (1) the projection will not be kept, and (2)
the movements applied to the projections are relative.

My question is; is there a 'best' projection to use for such a
procedure?


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj 




From roger at opq.se  Thu Dec  8 07:10:39 2011
From: roger at opq.se (Roger Oberholtzer)
Date: Thu, 08 Dec 2011 16:10:39 +0100
Subject: [Proj] Projection advice
In-Reply-To: <5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>
References: <1323344231.7350.57.camel@acme.pacific>
	<5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>
Message-ID: <1323357039.7350.66.camel@acme.pacific>

On Thu, 2011-12-08 at 06:41 -0600, Noel Zinn (cc) wrote:
> Roger,
> 
> Presumably you want a conformal projection so that the scale distortion is 
> uniform in all directions.  

Yes.

> Does the INS fiddling in Northings/Easting 
> account for scale distortion (point scale factor) at all, or does it presume 
> there is no scale distortion?  If the latter, then the larger the area your 
> generic projection covers, the greater the scale distortion your INS 
> fiddling will ignore.  That may not be a good change from your current, 
> local-projection procedure.

The INS is comprised of 3D gyroscopes, multi-axis accelerometers, a
wheel pulse transducer, and in some cases inclinometers. From these is
obtained very accurate relative movement information. Drift is minimal
over the distances it is expected to be used. These devices are scaled
and offset against a well-defined surface in the general area (within
the same country...) as they are used. Gravitational and surface curve
effects are minimal over the short distances they are used. At least
that is our working model.


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From ndzinn at comcast.net  Thu Dec  8 10:28:44 2011
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Thu, 8 Dec 2011 12:28:44 -0600
Subject: [Proj] Projection advice
In-Reply-To: <1323357039.7350.66.camel@acme.pacific>
References: <1323344231.7350.57.camel@acme.pacific><5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>
	<1323357039.7350.66.camel@acme.pacific>
Message-ID: <50CDEFE2A0B74BB982D1E3352B90AF01@NoelHmPC>

GPS, too?  Anyway, I take your response as an affirmative (i.e. scale 
accounted for).  Nevertheless, I'd advise sticking with local (and 
disposable) projections, e.g. an oblique stereographic centered in your 
(small) work area with (probably) a scale of unity at the center.  The 
"best" wide-area projection may not be good enough for some (or many) work 
areas.  -Noel

Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)

-----Original Message----- 
From: Roger Oberholtzer
Sent: Thursday, December 08, 2011 9:10 AM
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] Projection advice

On Thu, 2011-12-08 at 06:41 -0600, Noel Zinn (cc) wrote:
> Roger,
>
> Presumably you want a conformal projection so that the scale distortion is
> uniform in all directions.

Yes.

> Does the INS fiddling in Northings/Easting
> account for scale distortion (point scale factor) at all, or does it 
> presume
> there is no scale distortion?  If the latter, then the larger the area 
> your
> generic projection covers, the greater the scale distortion your INS
> fiddling will ignore.  That may not be a good change from your current,
> local-projection procedure.

The INS is comprised of 3D gyroscopes, multi-axis accelerometers, a
wheel pulse transducer, and in some cases inclinometers. From these is
obtained very accurate relative movement information. Drift is minimal
over the distances it is expected to be used. These devices are scaled
and offset against a well-defined surface in the general area (within
the same country...) as they are used. Gravitational and surface curve
effects are minimal over the short distances they are used. At least
that is our working model.


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se 




From roger at opq.se  Thu Dec  8 12:33:50 2011
From: roger at opq.se (Roger Oberholtzer)
Date: Thu, 08 Dec 2011 21:33:50 +0100
Subject: [Proj] Projection advice
In-Reply-To: <50CDEFE2A0B74BB982D1E3352B90AF01@NoelHmPC>
References: <1323344231.7350.57.camel@acme.pacific>
	<5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>
	<1323357039.7350.66.camel@acme.pacific>
	<50CDEFE2A0B74BB982D1E3352B90AF01@NoelHmPC>
Message-ID: <1323376430.13613.5.camel@barracuda.pacific>

On Thu, 2011-12-08 at 12:28 -0600, Noel Zinn (cc) wrote:
> GPS, too?  Anyway, I take your response as an affirmative (i.e. scale 
> accounted for).  Nevertheless, I'd advise sticking with local (and 
> disposable) projections, e.g. an oblique stereographic centered in your 
> (small) work area with (probably) a scale of unity at the center.  The 
> "best" wide-area projection may not be good enough for some (or many) work 
> areas.  -Noel


GPS is always the tricky part. When is it really good? A Kahlman filter
is the best practical solution. For that we use systems like those from
Oxford Technical Solutions. In the case I am discussing here, we are
messing around a bit. 

But how to make this projection choice automatic? That is what I am
trying to accomplish.


-- 

Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se



From ndzinn at comcast.net  Thu Dec  8 13:28:16 2011
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Thu, 8 Dec 2011 15:28:16 -0600
Subject: [Proj] Projection advice
In-Reply-To: <1323376430.13613.5.camel@barracuda.pacific>
References: <1323344231.7350.57.camel@acme.pacific><5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC><1323357039.7350.66.camel@acme.pacific><50CDEFE2A0B74BB982D1E3352B90AF01@NoelHmPC>
	<1323376430.13613.5.camel@barracuda.pacific>
Message-ID: <C9C750DD1BDF460DAAE8F1EE3D6A4D28@NoelHmPC>

> But how to make this projection choice automatic?

GPS would solve that, of course.  Once you have a position in your area, you 
define that as the central point of an oblique stereographic, for example. 
If no GPS, then perhaps an atlas!  BTW, thanks for the OxTS lead.  -Noel

Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)

-----Original Message----- 
From: Roger Oberholtzer
Sent: Thursday, December 08, 2011 2:33 PM
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] Projection advice

On Thu, 2011-12-08 at 12:28 -0600, Noel Zinn (cc) wrote:
> GPS, too?  Anyway, I take your response as an affirmative (i.e. scale
> accounted for).  Nevertheless, I'd advise sticking with local (and
> disposable) projections, e.g. an oblique stereographic centered in your
> (small) work area with (probably) a scale of unity at the center.  The
> "best" wide-area projection may not be good enough for some (or many) work
> areas.  -Noel


GPS is always the tricky part. When is it really good? A Kahlman filter
is the best practical solution. For that we use systems like those from
Oxford Technical Solutions. In the case I am discussing here, we are
messing around a bit.

But how to make this projection choice automatic? That is what I am
trying to accomplish.


-- 

Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se

_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj 




From roger at opq.se  Thu Dec  8 14:36:31 2011
From: roger at opq.se (Roger Oberholtzer)
Date: Thu, 08 Dec 2011 23:36:31 +0100
Subject: [Proj] Projection advice
In-Reply-To: <C9C750DD1BDF460DAAE8F1EE3D6A4D28@NoelHmPC>
References: <1323344231.7350.57.camel@acme.pacific>
	<5226C0C6803642AC99C36DEE57BB39F8@NoelHmPC>
	<1323357039.7350.66.camel@acme.pacific>
	<50CDEFE2A0B74BB982D1E3352B90AF01@NoelHmPC>
	<1323376430.13613.5.camel@barracuda.pacific>
	<C9C750DD1BDF460DAAE8F1EE3D6A4D28@NoelHmPC>
Message-ID: <1323383791.13613.27.camel@barracuda.pacific>

On Thu, 2011-12-08 at 15:28 -0600, Noel Zinn (cc) wrote:
> > But how to make this projection choice automatic?
> 
> GPS would solve that, of course.  Once you have a position in your area, you 
> define that as the central point of an oblique stereographic, for example. 

Time to do some research. I see.

> If no GPS, then perhaps an atlas!  BTW, thanks for the OxTS lead.  -Noel

They are nice to work with. Very responsive. A similar product is
Applanix. But I think Applanix are overpriced for what you get.


-- 

Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se



From warmerdam at pobox.com  Tue Dec 13 17:40:39 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 13 Dec 2011 17:40:39 -0800
Subject: [Proj] HEALPix & rHEALPix projections patch
In-Reply-To: <4EE7C07E.2000908@landcareresearch.co.nz>
References: <4EE7C07E.2000908@landcareresearch.co.nz>
Message-ID: <CA+YzLBcuX=p5=OCob9dUsReS9HpQpYHOr967K0CPAEf61RAagg@mail.gmail.com>

Michael,

I have committed the changes in trunk:

  http://trac.osgeo.org/proj/changeset/2125

I still need to regenerate src/Makefile.in at home for everything to be just
right, but I'm pleased with the test integration.  Lacking other
places to easily
document a new projection, you might want to pretend everyone is asking and
add it to the FAQ:

  http://trac.osgeo.org/proj/wiki/FAQ

Best regards,
Frank

On Tue, Dec 13, 2011 at 1:15 PM, Michael Speth
<spethm at landcareresearch.co.nz> wrote:
> Hello Frank,
>   I've created a patch this morning (Dec 14th +13 GMT) for the HEALPix and
> rHEALPix projections.  I have attached the patch here.  The patch contains
> updates to the build configuration and the PJ_healpix.c which has the
> HEALPix and rHEALPix projection implementations.
>
> I've also attached a document that contains our detailed test plan and
> results.
>
> Please let me know if you have any questions or comments.
>
> Thanks
>
> --
> Michael Speth
> Research Systems Developer
> Landcare Research



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From dkomisar at mak.com  Wed Dec 14 08:27:27 2011
From: dkomisar at mak.com (Daniel Komisar)
Date: Wed, 14 Dec 2011 16:27:27 +0000 (UTC)
Subject: [Proj] Vertical Datum Shift
Message-ID: <loom.20111214T172431-274@post.gmane.org>

I'm having trouble figuring out how to the the +geoidgrids option. I'm trying to 
convert EGM96 values to WGS84 with cs2cs (I will eventually be converting a dted 
file but first I'm trying to just get this to work) and I cannot get it to alter 
the values so I'm doing something wrong. Using 4.7.1.

cs2cs +proj=latlong +ellps=WGS84 +datum=WGS84 +geoidgrids=egm96_15.gtx +to 
+proj=latlong +ellps=WGS84 +datum=WGS84

It always outputs the exact same numbers I put in.

Thanks.




From martin.raspaud at smhi.se  Tue Dec 20 01:30:15 2011
From: martin.raspaud at smhi.se (Martin Raspaud)
Date: Tue, 20 Dec 2011 10:30:15 +0100
Subject: [Proj] Geos projection with flipped axis
Message-ID: <4EF055A7.8090303@smhi.se>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi all,

I'm having a discussion with someone working on the GOES-R satellite,
and the differences with the Meteosat series satellites.
The native projection of the image captured by the Meteosat satellite is
described in the CGMS'03 and is implemented in proj.4 as the "geos"
projection. Looking at the details, the Meteosat imager rotates first in
the horizontal plane then rotates up or down. The GOES-R satellite
however rotates first in the vertical plane and then rotates east or west.
Now, the two projection are very similar I think, it's just a matter of
swapping two axis. However, it looks like the +axis parameter is not
implemented in the geos projection.
Am I mistaken ? Or would it be possible to implement +axis for geos ? Or
is there another way to do what I describe using the geos projection ?

Best regards,
Martin
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.14 (GNU/Linux)
Comment: Using GnuPG with Red Hat - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJO8FWnAAoJEBdvyODiyJI4GRYH/2pWwXgwfRSFmb/iZLJeu1tc
eYRHGrHYHavpn1vc4gPryy3ZQL0ywjobSfucIUeap7hi83eaIUqxZjD8YTGtMbHd
lbAdtauDNhNakc1isv+zXj89Vf+DEV3CYMFliW504KP0ONNkHSFcajk7ZTDa5eec
YaOoyImUiKmhsoU7zMWkwCJmNKFUWAgYPWAo2f14qMVDDngeXHMvZGDq6421DYzV
MtO95wCm6G67FEmn5C7sO0CFOAe1eAEiWiqWeUpXtyUO9k7tzn24+GEyhFY2FbC0
hIOcM8DmoGTAY56OZ80xLQHgN333xC7GkFsZQYORRC9knC3PBcwKtHG/HgDCXhM=
=Ru94
-----END PGP SIGNATURE-----
-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 293 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20111220/71b35ca4/attachment.vcf>

From jmfluis at gmail.com  Wed Dec 21 17:49:44 2011
From: jmfluis at gmail.com (J. Luis)
Date: Thu, 22 Dec 2011 01:49:44 +0000
Subject: [Proj] Build fails on Windows
Message-ID: <4EF28CB8.9010505@gmail.com>

Hi,

On Windows (VS2010) the build errors after the addition of the the 
healpix projection

Joaquim Luis

PJ_healpix.c(149) : error C2057: expected constant expression
PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
PJ_healpix.c(222) : warning C4048: different array subscripts : 'double 
(*)[1]' and 'double [18][18]'
PJ_healpix.c(238) : warning C4048: different array subscripts : 'double 
(*)[1]' and 'double [12][12]'
PJ_healpix.c(572) : error C2143: syntax error : missing ';' before 'type'
PJ_healpix.c(573) : error C2143: syntax error : missing ';' before 'type'
PJ_healpix.c(575) : error C2065: 'x' : undeclared identifier
PJ_healpix.c(575) : error C2065: 'y' : undeclared identifier
PJ_healpix.c(588) : error C2061: syntax error : identifier 
's_healpix_inverse'
PJ_healpix.c(588) : error C2059: syntax error : ';'
PJ_healpix.c(588) : error C2059: syntax error : 'type'
PJ_healpix.c(652) : error C2065: 's_healpix_inverse' : undeclared identifier

I also get this warnings that are independent of the above problem

pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape 
sequence
pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape 
sequence
pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape 
sequence
pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape 
sequence
pj_open_lib.c(46) : warning C4129: 'V' : unrecognized character escape 
sequence
pj_open_lib.c(46) : warning C4129: 'S' : unrecognized character escape 
sequence


From SpethM at landcareresearch.co.nz  Wed Dec 21 18:46:45 2011
From: SpethM at landcareresearch.co.nz (Michael Speth)
Date: Thu, 22 Dec 2011 15:46:45 +1300
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF28CB8.9010505@gmail.com>
References: <4EF28CB8.9010505@gmail.com>
Message-ID: <F37ECF2E306E7341BB91475D10A759920FA4D7FAB6@donkey.landcare.ad.landcareresearch.co.nz>

Greetings,
  I am away from the office today, but I'll look into this first thing tomorrow morning.  I did not test building in windows, only on a 64-bit Ubuntu system.

Thanks

________________________________________
From: proj-bounces at lists.maptools.org [proj-bounces at lists.maptools.org] On Behalf Of J. Luis [jmfluis at gmail.com]
Sent: Thursday, 22 December 2011 2:49 p.m.
To: proj at lists.maptools.org
Subject: [Proj] Build fails on Windows

Hi,

On Windows (VS2010) the build errors after the addition of the the
healpix projection

Joaquim Luis

PJ_healpix.c(149) : error C2057: expected constant expression
PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
PJ_healpix.c(222) : warning C4048: different array subscripts : 'double
(*)[1]' and 'double [18][18]'
PJ_healpix.c(238) : warning C4048: different array subscripts : 'double
(*)[1]' and 'double [12][12]'
PJ_healpix.c(572) : error C2143: syntax error : missing ';' before 'type'
PJ_healpix.c(573) : error C2143: syntax error : missing ';' before 'type'
PJ_healpix.c(575) : error C2065: 'x' : undeclared identifier
PJ_healpix.c(575) : error C2065: 'y' : undeclared identifier
PJ_healpix.c(588) : error C2061: syntax error : identifier
's_healpix_inverse'
PJ_healpix.c(588) : error C2059: syntax error : ';'
PJ_healpix.c(588) : error C2059: syntax error : 'type'
PJ_healpix.c(652) : error C2065: 's_healpix_inverse' : undeclared identifier

I also get this warnings that are independent of the above problem

pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
sequence
pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
sequence
pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
sequence
pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
sequence
pj_open_lib.c(46) : warning C4129: 'V' : unrecognized character escape
sequence
pj_open_lib.c(46) : warning C4129: 'S' : unrecognized character escape
sequence
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

Please consider the environment before printing this email
Warning:  This electronic message together with any attachments is confidential. If you receive it in error: (i) you must not read, use, disclose, copy or retain it; (ii) please contact the sender immediately by reply email and then delete the emails.
The views expressed in this email may not be those of Landcare Research New Zealand Limited. http://www.landcareresearch.co.nz


From mateusz at loskot.net  Thu Dec 22 03:16:31 2011
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Thu, 22 Dec 2011 11:16:31 +0000
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF28CB8.9010505@gmail.com>
References: <4EF28CB8.9010505@gmail.com>
Message-ID: <CABUeae9-DV6uGVy9a=qsY2949GSeqzsQTMoqOD9j0zeciiQx6w@mail.gmail.com>

On 22 December 2011 01:49, J. Luis <jmfluis at gmail.com> wrote:
> PJ_healpix.c(149) : error C2057: expected constant expression
> PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
> PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
> PJ_healpix.c(222) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [18][18]'
> PJ_healpix.c(238) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [12][12]'

This code uses variable-length arrays as specified in C99.
Visual C++ compiler does not support C99.
This code needs to be rewritten, I'm afraid.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net


From spethm at landcareresearch.co.nz  Thu Dec 22 12:59:17 2011
From: spethm at landcareresearch.co.nz (Michael Speth)
Date: Fri, 23 Dec 2011 09:59:17 +1300
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF28CB8.9010505@gmail.com>
References: <4EF28CB8.9010505@gmail.com>
Message-ID: <4EF39A25.8000108@landcareresearch.co.nz>

Greetings,
   Has anyone cross-compiled proj.4 from a GNU/Linux system to a Windows 
Binary?  If so, can you help me set this up so that I can test?

Thanks

On 22/12/11 14:49, J. Luis wrote:
> Hi,
>
> On Windows (VS2010) the build errors after the addition of the the
> healpix projection
>
> Joaquim Luis
>
> PJ_healpix.c(149) : error C2057: expected constant expression
> PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
> PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
> PJ_healpix.c(222) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [18][18]'
> PJ_healpix.c(238) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [12][12]'
> PJ_healpix.c(572) : error C2143: syntax error : missing ';' before 'type'
> PJ_healpix.c(573) : error C2143: syntax error : missing ';' before 'type'
> PJ_healpix.c(575) : error C2065: 'x' : undeclared identifier
> PJ_healpix.c(575) : error C2065: 'y' : undeclared identifier
> PJ_healpix.c(588) : error C2061: syntax error : identifier
> 's_healpix_inverse'
> PJ_healpix.c(588) : error C2059: syntax error : ';'
> PJ_healpix.c(588) : error C2059: syntax error : 'type'
> PJ_healpix.c(652) : error C2065: 's_healpix_inverse' : undeclared identifier
>
> I also get this warnings that are independent of the above problem
>
> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'V' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'S' : unrecognized character escape
> sequence
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


-- 
Michael Speth
Research Systems Developer
Landcare Research



From spethm at landcareresearch.co.nz  Thu Dec 22 13:10:25 2011
From: spethm at landcareresearch.co.nz (Michael Speth)
Date: Fri, 23 Dec 2011 10:10:25 +1300
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF28CB8.9010505@gmail.com>
References: <4EF28CB8.9010505@gmail.com>
Message-ID: <4EF39CC1.7030000@landcareresearch.co.nz>

Hello,
   Why is proj.4 being compiled with a C++ compiler?  Variable length 
arrays are valid C language constructs but are not in C++.  So does 
proj.4 need to be both C and C++ compiler compliant?

Regards

On 22/12/11 14:49, J. Luis wrote:
> Hi,
>
> On Windows (VS2010) the build errors after the addition of the the
> healpix projection
>
> Joaquim Luis
>
> PJ_healpix.c(149) : error C2057: expected constant expression
> PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
> PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
> PJ_healpix.c(222) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [18][18]'
> PJ_healpix.c(238) : warning C4048: different array subscripts : 'double
> (*)[1]' and 'double [12][12]'
> PJ_healpix.c(572) : error C2143: syntax error : missing ';' before 'type'
> PJ_healpix.c(573) : error C2143: syntax error : missing ';' before 'type'
> PJ_healpix.c(575) : error C2065: 'x' : undeclared identifier
> PJ_healpix.c(575) : error C2065: 'y' : undeclared identifier
> PJ_healpix.c(588) : error C2061: syntax error : identifier
> 's_healpix_inverse'
> PJ_healpix.c(588) : error C2059: syntax error : ';'
> PJ_healpix.c(588) : error C2059: syntax error : 'type'
> PJ_healpix.c(652) : error C2065: 's_healpix_inverse' : undeclared identifier
>
> I also get this warnings that are independent of the above problem
>
> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'V' : unrecognized character escape
> sequence
> pj_open_lib.c(46) : warning C4129: 'S' : unrecognized character escape
> sequence
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


-- 
Michael Speth
Research Systems Developer
Landcare Research



From mateusz at loskot.net  Thu Dec 22 13:50:40 2011
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Thu, 22 Dec 2011 21:50:40 +0000
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF39CC1.7030000@landcareresearch.co.nz>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39CC1.7030000@landcareresearch.co.nz>
Message-ID: <CABUeae_Vokd7xyLNr4DRZWx+8o5qsXKJrg44tqqvQ-OLmK8mzQ@mail.gmail.com>

On 22 December 2011 21:10, Michael Speth <spethm at landcareresearch.co.nz> wrote:
>   Why is proj.4 being compiled with a C++ compiler?  Variable length
> arrays are valid C language constructs but are not in C++.  So does
> proj.4 need to be both C and C++ compiler compliant?

This has nothing to do with compiling as C++.
AFAIU, PROJ.4 is supposed to build with Visual C++.
Visual C++ does support C but only C89, not C99.

But, due to the fact that C++03 standard includes C89,
while using Visual C++, you can compile C sources as C++
without problems, as long as C source is C89.
C99 source code will not compile regardless of C or C++ mode,
because Visual C++ does not implement C99 standard.

Some of features of C99 are included in most recent C++11 standard, but not VLA

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
Member of ACCU, http://accu.org


From mateusz at loskot.net  Thu Dec 22 13:52:29 2011
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Thu, 22 Dec 2011 21:52:29 +0000
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF39A25.8000108@landcareresearch.co.nz>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39A25.8000108@landcareresearch.co.nz>
Message-ID: <CABUeae-cGWe8GnQVF_WS+h1-4YdBa3DH0wb_4NittCs+orwKBA@mail.gmail.com>

On 22 December 2011 20:59, Michael Speth <spethm at landcareresearch.co.nz> wrote:
> Greetings,
>   Has anyone cross-compiled proj.4 from a GNU/Linux system to a Windows
> Binary?  If so, can you help me set this up so that I can test?

You don't need to test building on or for Windows.
Just compile PROJ.4 using GCC with -ansi -std=c89 options
and you will get C89 compatibility mode.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
Member of ACCU, http://accu.org


From warmerdam at pobox.com  Thu Dec 22 14:00:13 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 22 Dec 2011 14:00:13 -0800
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF39CC1.7030000@landcareresearch.co.nz>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39CC1.7030000@landcareresearch.co.nz>
Message-ID: <CA+YzLBc2nfF2+w88E=sDvTurP+DDg_q_chZAVXc_uvOqVcovew@mail.gmail.com>

On Thu, Dec 22, 2011 at 1:10 PM, Michael Speth
<spethm at landcareresearch.co.nz> wrote:
> Hello,
>   Why is proj.4 being compiled with a C++ compiler?  Variable length
> arrays are valid C language constructs but are not in C++.  So does
> proj.4 need to be both C and C++ compiler compliant?
>

Michael,

This will need to be corrected before we release.  I endevour
to have PROJ.4 and related projects compilable with a wide
variety of compilers.  If you are willing to do it, great.  If not
I'll try and/or disable healpix.

With libtiff 4 released, and GDAL 1.9 close to release I might
just make a real push to get PROJ.4 4.9.0 out over the holidays.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From EMiller at dfg.ca.gov  Thu Dec 22 14:22:05 2011
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Thu, 22 Dec 2011 14:22:05 -0800
Subject: [Proj] Build fails on Windows
In-Reply-To: <4EF39CC1.7030000@landcareresearch.co.nz>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39CC1.7030000@landcareresearch.co.nz>
Message-ID: <4EF33D0D.95FD.00E4.1@dfg.ca.gov>

Visual C++ (cl.exe) compiles both C and C++.  It has switches for forcing different behaviors as well as guessing by file extension (*.c vs. *.cpp).  But, Microsoft has basically said they aren't interested in implementing C99.  Some C99 features may make it into future versions of Visual C++ via the C++11 standard which Microsoft claims they plan to fully implement.
-- 

Eric G. Miller
Software Developer
CA Dept. of Fish & Game


>>> On 12/22/2011 at  1:10 PM, Michael Speth <spethm at landcareresearch.co.nz>
wrote:
> Hello,
>    Why is proj.4 being compiled with a C++ compiler?  Variable length 
> arrays are valid C language constructs but are not in C++.  So does 
> proj.4 need to be both C and C++ compiler compliant?
> 
> Regards
> 
> On 22/12/11 14:49, J. Luis wrote:
>> Hi,
>>
>> On Windows (VS2010) the build errors after the addition of the the
>> healpix projection
>>
>> Joaquim Luis
>>
>> PJ_healpix.c(149) : error C2057: expected constant expression
>> PJ_healpix.c(149) : error C2466: cannot allocate an array of constant size 0
>> PJ_healpix.c(149) : error C2087: 'vert' : missing subscript
>> PJ_healpix.c(222) : warning C4048: different array subscripts : 'double
>> (*)[1]' and 'double [18][18]'
>> PJ_healpix.c(238) : warning C4048: different array subscripts : 'double
>> (*)[1]' and 'double [12][12]'
>> PJ_healpix.c(572) : error C2143: syntax error : missing ';' before 'type'
>> PJ_healpix.c(573) : error C2143: syntax error : missing ';' before 'type'
>> PJ_healpix.c(575) : error C2065: 'x' : undeclared identifier
>> PJ_healpix.c(575) : error C2065: 'y' : undeclared identifier
>> PJ_healpix.c(588) : error C2061: syntax error : identifier
>> 's_healpix_inverse'
>> PJ_healpix.c(588) : error C2059: syntax error : ';'
>> PJ_healpix.c(588) : error C2059: syntax error : 'type'
>> PJ_healpix.c(652) : error C2065: 's_healpix_inverse' : undeclared identifier
>>
>> I also get this warnings that are independent of the above problem
>>
>> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
>> sequence
>> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
>> sequence
>> pj_open_lib.c(46) : warning C4129: 'p' : unrecognized character escape
>> sequence
>> pj_open_lib.c(46) : warning C4129: 'c' : unrecognized character escape
>> sequence
>> pj_open_lib.c(46) : warning C4129: 'V' : unrecognized character escape
>> sequence
>> pj_open_lib.c(46) : warning C4129: 'S' : unrecognized character escape
>> sequence
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org 
>> http://lists.maptools.org/mailman/listinfo/proj 
> 




From mateusz at loskot.net  Thu Dec 22 14:50:05 2011
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Thu, 22 Dec 2011 22:50:05 +0000
Subject: [Proj] Build fails on Windows
In-Reply-To: <CA+YzLBc2nfF2+w88E=sDvTurP+DDg_q_chZAVXc_uvOqVcovew@mail.gmail.com>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39CC1.7030000@landcareresearch.co.nz>
	<CA+YzLBc2nfF2+w88E=sDvTurP+DDg_q_chZAVXc_uvOqVcovew@mail.gmail.com>
Message-ID: <CABUeae9GkYErGo+uPmjHC1d-cifSTwx60PtvbEig4EQO_+YW2Q@mail.gmail.com>

On 22 December 2011 22:00, Frank Warmerdam <warmerdam at pobox.com> wrote:
> On Thu, Dec 22, 2011 at 1:10 PM, Michael Speth
> <spethm at landcareresearch.co.nz> wrote:
>> Hello,
>>   Why is proj.4 being compiled with a C++ compiler?  Variable length
>> arrays are valid C language constructs but are not in C++.  So does
>> proj.4 need to be both C and C++ compiler compliant?
>>
>
> Michael,
>
> This will need to be corrected before we release.

Quick patch proposal attached.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
-------------- next part --------------
A non-text attachment was scrubbed...
Name: compile-fixes-for-msvc.patch
Type: application/octet-stream
Size: 8399 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20111222/9bd6739c/attachment.obj>

From spethm at landcareresearch.co.nz  Thu Dec 22 14:53:12 2011
From: spethm at landcareresearch.co.nz (Michael Speth)
Date: Fri, 23 Dec 2011 11:53:12 +1300
Subject: [Proj] Build fails on Windows
In-Reply-To: <CA+YzLBc2nfF2+w88E=sDvTurP+DDg_q_chZAVXc_uvOqVcovew@mail.gmail.com>
References: <4EF28CB8.9010505@gmail.com>
	<4EF39CC1.7030000@landcareresearch.co.nz>
	<CA+YzLBc2nfF2+w88E=sDvTurP+DDg_q_chZAVXc_uvOqVcovew@mail.gmail.com>
Message-ID: <4EF3B4D8.20604@landcareresearch.co.nz>

That clears things up for me.  I'll work on making HEALPix & rHEALPix 
C89 compliant.  Thank you for the help!  I'll post a patch once its 
completed ... hopefully before x-mass.

Regards

On 23/12/11 11:00, Frank Warmerdam wrote:
> On Thu, Dec 22, 2011 at 1:10 PM, Michael Speth
> <spethm at landcareresearch.co.nz>  wrote:
>> Hello,
>>    Why is proj.4 being compiled with a C++ compiler?  Variable length
>> arrays are valid C language constructs but are not in C++.  So does
>> proj.4 need to be both C and C++ compiler compliant?
>>
> Michael,
>
> This will need to be corrected before we release.  I endevour
> to have PROJ.4 and related projects compilable with a wide
> variety of compilers.  If you are willing to do it, great.  If not
> I'll try and/or disable healpix.
>
> With libtiff 4 released, and GDAL 1.9 close to release I might
> just make a real push to get PROJ.4 4.9.0 out over the holidays.
>
> Best regards,


-- 
Michael Speth
Research Systems Developer
Landcare Research



From wilson.andrew.j at gmail.com  Fri Dec 23 08:50:54 2011
From: wilson.andrew.j at gmail.com (Andy Wilson)
Date: Fri, 23 Dec 2011 10:50:54 -0600
Subject: [Proj] VERTCON datum shifts scaled 1000x?
Message-ID: <CAPpTVmqAZavQNyvdspFTfDA-nn8iuDEHh255fAwnG33itOGCTg@mail.gmail.com>

Hi.

I'm using the trunk version of proj to do calculate vertical datum
shifts between NGVD 29 and NAVD 88 using the vertcon files here:
http://download.osgeo.org/proj/vdatum/vertcon/

This works:

> ./src/cs2cs +proj=latlong +datum=WGS84 +to +proj=latlong +datum=WGS84 +geoidgrids=vertconc.gtx,vertcone.gtx,vertconw.gtx
-102 38
102dW	38dN -416.785
-97 29
97dW	29dN 37.597
-109 37
109dW	37dN -884.167


But the output seems to be off by a factor of 1000; these output z
values are actually millimeters. The same thing happens with feet:


> ./src/cs2cs +proj=latlong +datum=WGS84 +to +proj=latlong +datum=WGS84 +geoidgrids=vertconc.gtx,vertcone.gtx,vertconw.gtx +vunits=us-ft
-102 38
102dW	38dN -1367.401
-97 29
97dW	29dN 123.349
-109 37
109dW	37dN -2900.806


These output z values are in 1/1000 ft (millifeet?). It is trivial to
correct for this by scaling these z values down by 1000, but maybe not
the expected behavior.


For comparison, the NGS has this VERTCON site:
http://www.ngs.noaa.gov/TOOLS/Vertcon/vertcon.html
and a web form for finding datum shifts at specific lat/long:
http://www.ngs.noaa.gov/cgi-bin/VERTCON/vert_con.prl


btw, thanks for adding vertical datums to proj.4  - this is easily
most convenient way to do this sort of thing.

-andy


From wilson.andrew.j at gmail.com  Fri Dec 23 09:57:19 2011
From: wilson.andrew.j at gmail.com (Andy Wilson)
Date: Fri, 23 Dec 2011 11:57:19 -0600
Subject: [Proj] Vertical Datum Shift
Message-ID: <CAPpTVmo77fVhSL17D39+x9Nhc3fnMb1isrCXSyGJBsa0s62H5Q@mail.gmail.com>

Hi Daniel.

I just joined the mailing list today so I don't think I can reply to
your message directly, but here goes.


You can get some useful information if you run cs2cs with debugging turned on:

PROJ_DEBUG=ON  cs2cs +proj=latlong +ellps=WGS84 +datum=WGS84
+geoidgrids=egm96_15.gtx +to +proj=latlong +ellps=WGS84 +datum=WGS84


It might be that that proj isn't finding your .gtx file, which needs
to be in PROJ_LIB which is likely /usr/share/proj/ or
/usr/local/share/proj/. I think the exact location is output when you
compile proj.






> I'm having trouble figuring out how to the the +geoidgrids option. I'm trying to
> convert EGM96 values to WGS84 with cs2cs (I will eventually be converting a dted
> file but first I'm trying to just get this to work) and I cannot get it to alter
> the values so I'm doing something wrong. Using 4.7.1.
>
> cs2cs +proj=latlong +ellps=WGS84 +datum=WGS84 +geoidgrids=egm96_15.gtx +to
> +proj=latlong +ellps=WGS84 +datum=WGS84
>
> It always outputs the exact same numbers I put in.
>
> Thanks.


