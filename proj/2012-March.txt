From nhv at cape.com  Sat Mar  3 16:51:52 2012
From: nhv at cape.com (Norman Vine)
Date: Sat, 3 Mar 2012 19:51:52 -0500
Subject: [Proj] Natural Earth projection
In-Reply-To: <BE77C179-6E25-4EC0-B4EE-58A3E6E21CAC@geo.oregonstate.edu>
References: <BE77C179-6E25-4EC0-B4EE-58A3E6E21CAC@geo.oregonstate.edu>
Message-ID: <B8F510FB-C7E6-4017-9074-D56416BDED80@cape.com>


On Feb 24, 2012, at 6:02 PM, Bernhard Jenny wrote:

> I would like to suggest the inclusion of the Natural Earth projection in PROJ.4. Natural Earth is a new projection for small-scale world maps. Here is more information on the projection:
> http://www.shadedrelief.com/NE_proj/
> 
> This recent article in Cartography and Geographic Information Science describes the development of the projection and its equations:
> http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf
> 
> Here is C code ready to be included in PROJ.4:
> http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip 
> 
> I suggest the following entry for pj_list.h:
> PROJ_HEAD(natearth, "Natural Earth")
> 
> Best regards,
> Bernie
> 
> Bernhard Jenny
> Assistant Professor
> Cartography and Geovisualization
> Oregon State University
> jennyb at geo.oregonstate.edu
> http://cartography.oregonstate.edu/

Bernie

Frank has added this projection see
http://trac.osgeo.org/proj/changeset/2182

Perhaps you could add some documentation to 
http://trac.osgeo.org/proj/wiki/ProjList

Thanks

Norman

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120303/11de73a2/attachment.html>

From geraldi.evenden at gmail.com  Sat Mar  3 17:44:41 2012
From: geraldi.evenden at gmail.com (Gerald I. Evenden)
Date: Sat, 3 Mar 2012 20:44:41 -0500
Subject: [Proj] Natural Earth projection
In-Reply-To: <B8F510FB-C7E6-4017-9074-D56416BDED80@cape.com>
References: <BE77C179-6E25-4EC0-B4EE-58A3E6E21CAC@geo.oregonstate.edu>
	<B8F510FB-C7E6-4017-9074-D56416BDED80@cape.com>
Message-ID: <CAOM4zCzQ+ru7Q7nfZKXfX8i1GgwfWcL630hvfgiwd_jxwYT8DA@mail.gmail.com>

My interest in projections has waned and I only get this email list because
I am too lazy to cut it off.  However this projection caught my eye for a
couple of reasons: 1) it is only a slight and insignificant rehash of
existing projections but, more importantly, 2) the presumptuousness of
calling it the "Natural Earth." Oh please!!

Alas.

On Sat, Mar 3, 2012 at 7:51 PM, Norman Vine <nhv at cape.com> wrote:

>
> On Feb 24, 2012, at 6:02 PM, Bernhard Jenny wrote:
>
> I would like to suggest the inclusion of the Natural Earth projection in
> PROJ.4. Natural Earth is a new projection for small-scale world maps. Here
> is more information on the projection:
> http://www.shadedrelief.com/NE_proj/
>
> This recent article in Cartography and Geographic Information Science
> describes the development of the projection and its equations:
>
> http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf
>
> Here is C code ready to be included in PROJ.4:
> http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip
>
> I suggest the following entry for pj_list.h:
> PROJ_HEAD(natearth, "Natural Earth")
>
> Best regards,
> Bernie
>
> Bernhard Jenny
> Assistant Professor
> Cartography and Geovisualization
> Oregon State University
> jennyb at geo.oregonstate.edu
> http://cartography.oregonstate.edu/
>
>
> Bernie
>
> Frank has added this projection see
> http://trac.osgeo.org/proj/changeset/2182
>
> Perhaps you could add some documentation to
> http://trac.osgeo.org/proj/wiki/ProjList
>
> Thanks
>
> Norman
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 

"Religion is regarded by the common people as true,

by the wise as false, and by rulers as useful." Seneca
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120303/6341d766/attachment.html>

From ovv at hetnet.nl  Sun Mar  4 08:33:22 2012
From: ovv at hetnet.nl (OvV_HN)
Date: Sun, 4 Mar 2012 17:33:22 +0100
Subject: [Proj] Natural Earth projection
Message-ID: <D870F1D8833C43B89C46E94DA2CF55FF@PCHP>

In Reply to:

Bernhard Jenny jennyb at geo.oregonstate.edu
Fri Feb 24 18:02:22 EST 2012

I would like to suggest the inclusion of the Natural Earth projection in 
PROJ.4. Natural Earth is a new projection for small-scale world maps. Here 
is more information on the projection:
http://www.shadedrelief.com/NE_proj/

etc.


Could be my error, but as closer I get to a pole, the more inaccurate the 
inverse gets.
The error amounts to several degrees. Useless!

Examples:

R = 6371008.7714 m

lat, lon = 70.0, 120.0
-> x,y = 8746490.08803389, 7638351.973962101
inverse, back to lat, lon: 69.99209, 119.99120

lat, lon = 80.0, 120.0
-> x,y = 7857518.066663387, 8518264.078952862
inverse, back to lat, lon: 79.86806, 119.79482

lat, lon = 85.0, 120.0
-> x,y = 7268396.11454517, 8868081.540119916
inverse, back to lat, lon: 84.39404, 118.66044

lat, lon = 89.0, 120.0
-> x,y = 6604995.340672151, 9042363.459174621
inverse, back to lat, lon: 86.95668, 113.64953

I used the JavaScript code.


Oscar van Vlijmen





From Mikael.Rittri at carmenta.com  Mon Mar  5 04:40:48 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Mon, 5 Mar 2012 12:40:48 +0000
Subject: [Proj] Natural Earth projection
In-Reply-To: <CAOM4zCzQ+ru7Q7nfZKXfX8i1GgwfWcL630hvfgiwd_jxwYT8DA@mail.gmail.com>
References: <BE77C179-6E25-4EC0-B4EE-58A3E6E21CAC@geo.oregonstate.edu>
	<B8F510FB-C7E6-4017-9074-D56416BDED80@cape.com>
	<CAOM4zCzQ+ru7Q7nfZKXfX8i1GgwfWcL630hvfgiwd_jxwYT8DA@mail.gmail.com>
Message-ID: <06F49888-3CE8-4263-85E4-8F51B7F7206D@carmenta.com>

Hello Gerald. Nice to hear from you again.

I agree that NE looks very much like Robinson or Winkel triple.

However, I think you read the name out of context.
It refers to (alludes to?) the free dataset Natural Earth,
see http://www.naturalearthdata.com

Regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

4 mar 2012 kl. 03:02 skrev "Gerald I. Evenden" <geraldi.evenden at gmail.com<mailto:geraldi.evenden at gmail.com>>:

My interest in projections has waned and I only get this email list because I am too lazy to cut it off.  However this projection caught my eye for a couple of reasons: 1) it is only a slight and insignificant rehash of existing projections but, more importantly, 2) the presumptuousness of calling it the "Natural Earth." Oh please!!

Alas.

On Sat, Mar 3, 2012 at 7:51 PM, Norman Vine <<mailto:nhv at cape.com>nhv at cape.com<mailto:nhv at cape.com>> wrote:

On Feb 24, 2012, at 6:02 PM, Bernhard Jenny wrote:

I would like to suggest the inclusion of the Natural Earth projection in PROJ.4. Natural Earth is a new projection for small-scale world maps. Here is more information on the projection:
<http://www.shadedrelief.com/NE_proj/>http://www.shadedrelief.com/NE_proj/

This recent article in Cartography and Geographic Information Science describes the development of the projection and its equations:
<http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf>http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf

Here is C code ready to be included in PROJ.4:
<http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip>http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip

I suggest the following entry for pj_list.h:
PROJ_HEAD(natearth, "Natural Earth")

Best regards,
Bernie

Bernhard Jenny
Assistant Professor
Cartography and Geovisualization
Oregon State University
<mailto:jennyb at geo.oregonstate.edu>jennyb at geo.oregonstate.edu<mailto:jennyb at geo.oregonstate.edu>
<http://cartography.oregonstate.edu/>http://cartography.oregonstate.edu/

Bernie

Frank has added this projection see
<http://trac.osgeo.org/proj/changeset/2182>http://trac.osgeo.org/proj/changeset/2182

Perhaps you could add some documentation to
<http://trac.osgeo.org/proj/wiki/ProjList>http://trac.osgeo.org/proj/wiki/ProjList

Thanks

Norman


_______________________________________________
Proj mailing list
<mailto:Proj at lists.maptools.org>Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
<http://lists.maptools.org/mailman/listinfo/proj>http://lists.maptools.org/mailman/listinfo/proj



--

"Religion is regarded by the common people as true,

by the wise as false, and by rulers as useful." Seneca

_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120305/3590092c/attachment.html>

From geraldi.evenden at gmail.com  Mon Mar  5 06:56:52 2012
From: geraldi.evenden at gmail.com (Gerald I. Evenden)
Date: Mon, 5 Mar 2012 09:56:52 -0500
Subject: [Proj] Natural Earth projection
In-Reply-To: <06F49888-3CE8-4263-85E4-8F51B7F7206D@carmenta.com>
References: <BE77C179-6E25-4EC0-B4EE-58A3E6E21CAC@geo.oregonstate.edu>
	<B8F510FB-C7E6-4017-9074-D56416BDED80@cape.com>
	<CAOM4zCzQ+ru7Q7nfZKXfX8i1GgwfWcL630hvfgiwd_jxwYT8DA@mail.gmail.com>
	<06F49888-3CE8-4263-85E4-8F51B7F7206D@carmenta.com>
Message-ID: <CAOM4zCyvE9JkJU5TRniCpfPzfoaRbFxYS1gM20vEKboyb_bsgQ@mail.gmail.com>

Perhaps a knee jerk reaction on my part because terms like "natural," like
"organic," become overused these days. As you describe it, "Natural
Earth's" projection would be more appropriate but this leaves the
projection without a direct designation. However, "natural" as a name has a
lot of nonsense baggage.

An issue that I do not remember seeing discussed with the projection is its
property of being equal area. I feel that for general thematic mapping it
is far more important for a map to be equal area to help the viewer have a
better "feel" of the information presented.

On Mon, Mar 5, 2012 at 7:40 AM, Mikael Rittri <Mikael.Rittri at carmenta.com>wrote:

> Hello Gerald. Nice to hear from you again.
>
> I agree that NE looks very much like Robinson or Winkel triple.
>
> However, I think you read the name out of context.
> It refers to (alludes to?) the free dataset Natural Earth,
> see http://www.naturalearthdata.com
>
> Regards,
>
> Mikael Rittri
> Carmenta
> Sweden
> http://www.carmenta.com
>
> 4 mar 2012 kl. 03:02 skrev "Gerald I. Evenden" <geraldi.evenden at gmail.com
> >:
>
> My interest in projections has waned and I only get this email list
> because I am too lazy to cut it off.  However this projection caught my eye
> for a couple of reasons: 1) it is only a slight and insignificant rehash of
> existing projections but, more importantly, 2) the presumptuousness of
> calling it the "Natural Earth." Oh please!!
>
> Alas.
>
> On Sat, Mar 3, 2012 at 7:51 PM, Norman Vine < <nhv at cape.com>nhv at cape.com>wrote:
>
>>
>> On Feb 24, 2012, at 6:02 PM, Bernhard Jenny wrote:
>>
>> I would like to suggest the inclusion of the Natural Earth projection in
>> PROJ.4. Natural Earth is a new projection for small-scale world maps. Here
>> is more information on the projection:
>>  <http://www.shadedrelief.com/NE_proj/>
>> http://www.shadedrelief.com/NE_proj/
>>
>> This recent article in Cartography and Geographic Information Science
>> describes the development of the projection and its equations:
>> <http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf>
>> http://cartography.oregonstate.edu/pdf/2011_Savric_etal_PolynomialNaturalEarth.pdf
>>
>> Here is C code ready to be included in PROJ.4:
>>  <http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip>
>> http://www.shadedrelief.com/NE_proj/natural_earth_proj.zip
>>
>> I suggest the following entry for pj_list.h:
>> PROJ_HEAD(natearth, "Natural Earth")
>>
>> Best regards,
>> Bernie
>>
>> Bernhard Jenny
>> Assistant Professor
>> Cartography and Geovisualization
>> Oregon State University
>> <jennyb at geo.oregonstate.edu>jennyb at geo.oregonstate.edu
>>  <http://cartography.oregonstate.edu/>http://cartography.oregonstate.edu/
>>
>>
>> Bernie
>>
>> Frank has added this projection see
>>  <http://trac.osgeo.org/proj/changeset/2182>
>> http://trac.osgeo.org/proj/changeset/2182
>>
>> Perhaps you could add some documentation to
>> <http://trac.osgeo.org/proj/wiki/ProjList>
>> http://trac.osgeo.org/proj/wiki/ProjList
>>
>> Thanks
>>
>> Norman
>>
>>
>> _______________________________________________
>> Proj mailing list
>>  <Proj at lists.maptools.org>Proj at lists.maptools.org
>>  <http://lists.maptools.org/mailman/listinfo/proj>
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
>
> --
>
> "Religion is regarded by the common people as true,
>
> by the wise as false, and by rulers as useful." Seneca
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 

"Religion is regarded by the common people as true,

by the wise as false, and by rulers as useful." Seneca
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120305/c955a801/attachment.html>

From ovv at hetnet.nl  Mon Mar  5 07:37:56 2012
From: ovv at hetnet.nl (OvV_HN)
Date: Mon, 5 Mar 2012 16:37:56 +0100
Subject: [Proj] Natural Earth projection
Message-ID: <7A9F1216E5D6434EA4604AD2A3A6BCA3@PCHP>

In reply to:

Gerald I. Evenden geraldi.evenden at gmail.com 
Mon Mar 5 09:56:52 EST 2012 


Perhaps a knee jerk reaction ..............

An issue that I do not remember seeing discussed with the projection is its
property of being equal area. I feel that for general thematic mapping it
is far more important for a map to be equal area to help the viewer have a
better "feel" of the information presented.


Reply:

The natural earth projection is neither conformal nor equal area.
This is discussed in the Savric paper mentioned earlier.
In this paper we can also find a discussion of the distortion.


Oscar van Vlijmen





From garret.duffy at nuigalway.ie  Mon Mar  5 08:27:10 2012
From: garret.duffy at nuigalway.ie (insyzygy)
Date: Mon, 5 Mar 2012 08:27:10 -0800 (PST)
Subject: [Proj] Ortho Projection Question
In-Reply-To: <1612FB018DB27B449265FE30F163AF5D05872093@EVS1.ac.nuigalway.ie>
References: <CAKWaz4tMZN37+_jY-HxinFh3-gV4m0TMvUM4jbzk7G4S0YJahg@mail.gmail.com>
	<5256593E-A0A9-4927-B6B9-E2275AD6176C@carmenta.com>
	<1612FB018DB27B449265FE30F163AF5D05872093@EVS1.ac.nuigalway.ie>
Message-ID: <1330964830544-4548298.post@n6.nabble.com>

Just poking about this request that equates proj's +ortho flag with ESRI's
"Local Projection"

I would like to know if the +ortho flag supports rotation angles beween 0
and 180 so I can effectively rotate the cartesian axes so that the top of
the projected map is not necessarily North.

If so, which version?

Thanks, Garret

--
View this message in context: http://osgeo-org.1560.n6.nabble.com/Ortho-Projection-Question-tp3841014p4548298.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From strebe at aol.com  Mon Mar  5 19:55:19 2012
From: strebe at aol.com (strebe at aol.com)
Date: Mon, 5 Mar 2012 22:55:19 -0500 (EST)
Subject: [Proj] Happy birthday Mercator! -- oops
In-Reply-To: <7A9F1216E5D6434EA4604AD2A3A6BCA3@PCHP>
References: <7A9F1216E5D6434EA4604AD2A3A6BCA3@PCHP>
Message-ID: <8CEC964153E8507-DAC-6EA0@webmail-m094.sysops.aol.com>

 
The German post office was excited enough to issue a stamp commemorating Mercator’s birth. They goofed. See:

http://mapthematics.com/forums/viewtopic.php?f=8&t=249

Regards,
— daan Strebe

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120305/7eb11d42/attachment.html>

From noorcs22 at gmail.com  Tue Mar  6 02:12:16 2012
From: noorcs22 at gmail.com (Mustafa646)
Date: Tue, 6 Mar 2012 02:12:16 -0800 (PST)
Subject: [Proj] Changing projection of base layer
Message-ID: <1331028736241-4550776.post@n6.nabble.com>

Hi list,

normally we change projection of vector data for displaying it over google
base map. Similarly is it possible to change the projection of base image
tiles map? if yes, how we can do that, any reference or code example will be
appreciated. 

--
View this message in context: http://osgeo-org.1560.n6.nabble.com/Changing-projection-of-base-layer-tp4550776p4550776.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From Mikael.Rittri at carmenta.com  Tue Mar  6 05:38:03 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Tue, 6 Mar 2012 13:38:03 +0000
Subject: [Proj] Trouble georeferencing data stored in a spherical projection.
Message-ID: <E4AB3DD44D22854B819908379DE4AD49390EC6EA@SETHNWS023.carmenta.se>

Hello, (I hope this is approximately the right forum).


I have had some trouble with meteorological GeoTIFF data, stored in stereographic
based on a GEOGCS called "NinJo sphere", without any EPSG code, using a sphere
with radius 6378137 m.

The main problem wasn't the lack of an ordinary geodetic datum, since the most detailed
file had the resolution 4.6 km, much more than the typical difference between datums.

What bothers me more, with spherical data, is that it seems impossible to know if the
spherical latitude should be interpreted as identical to WGS84 latitude (geodetic latitude),
or if it should be interpreted as geocentric latitude that needs conversion to WGS84.
The difference between the two interpretations can be up to 21 km, which can be
significant even when the datum choice isn't.

I was hoping to find that one of the alternatives was a de facto standard, but
instead I found evidence that both of them are in use.

Spherical latitude = geodetic latitude is used by:

      Data in Web Mercator, like Open Street Map,

      Meteorological data in any of the models WRF, MM5 and NinJo.

Spherical latitude = geocentric latitude is used by:

      MISR Regional UAE2 Imagery (from NASA Earth Data).



In an old post, Melita Kennedy has written that it is "probably more correct" to use the
second convention; maybe she has experience with data like MISR.

The Proj.4 FAQ discusses Web Mercator and mentions "many other datasets ... such as
many NASA datasets" as using the same convention, so maybe NASA is not consistent
in its choice of convention.



Anyway, what I would like is some standard way to tag the metadata, in GeoTIFF in
my case but more generally in WKT, to specify which convention is used.
Of course, the problem is already solved in Proj.4, as the FAQ says, since we can use

     +nadgrids=@null

for the first convention, and

     +towgs84=0,0,0

for the second one.

In GeoTiff, specifying TOWGS84[0,0,0] in the same way will be possible as soon
as the proposal http://trac.osgeo.org/geotiff/wiki/TOWGS84GeoKey is supported,
but there will still be no way to specify the first convention.

In WKT, too, only the second convention can be specified.

So I wonder, is there already some discussion going on about how the first convention
could be specified? (Perhaps within OGC or EPSG.)  If not, can we start it?

Best regards

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com<http://www.carmenta.com/>



REFERENCES:

The way to interpret WRF and MM5 data: http://www.ie.unc.edu/cempd/projects/mims/spatial/grids_ellipsoids_map_proj.html

The way to interpret NinJo data: personal trial-and-error.

The way to interpret MISR UAE2 data: http://eosweb.larc.nasa.gov/PRODOCS/misr/uae/imagery/regional/map_projection.html

Melita Kennedy's post: http://lists.osgeo.org/pipermail/metacrs/2008-August/000144.html

Proj.4 FAQ: http://trac.osgeo.org/proj/wiki/FAQ#ChangingEllipsoidWhycantIconvertfromWGS84toGoogleEarthVirtualGlobeMercator










-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120306/515963ad/attachment.html>

From ndzinn at comcast.net  Tue Mar  6 06:42:50 2012
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Tue, 6 Mar 2012 08:42:50 -0600
Subject: [Proj] Trouble georeferencing data stored in a spherical
	projection.
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49390EC6EA@SETHNWS023.carmenta.se>
References: <E4AB3DD44D22854B819908379DE4AD49390EC6EA@SETHNWS023.carmenta.se>
Message-ID: <CA2382870218498C97146ED34BA93B58@NoelHmPC>

Mikael,



Here's another way of looking at the problem.  Our Web Mercator discussion a few years ago turned out to be about a (new, though some have commented that it was around before Google) non-conformal map projection (Web Mercator) and NOT about the differences between an ellipsoidal and a spherical earth.  Your situation may be the same.



You say your data are stored in stereographic, but stereographic using spherical or ellipsoidal equations?  Do you know?  Probably spherical (and I'd guess there's no difference between Snyder and Double Stereographic for the sphere) because if ellipsoidal then you'd have to be using an eccentricity and your reference surface would be an ellipsoid (probably WGS84) and not the NinJo sphere.  



If so, then we have just defined the Web Stereographic map projection, spherical stereographic equations applied to ellipsoidal WGS84 coordinates, probably non-conformal.  You can work out the distortions (scale and convergence) and you're done.  



Noel


Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)


From: Mikael Rittri 
Sent: Tuesday, March 06, 2012 7:38 AM
To: proj at lists.maptools.org 
Subject: [Proj] Trouble georeferencing data stored in a spherical projection.

Hello, (I hope this is approximately the right forum).

 

I have had some trouble with meteorological GeoTIFF data, stored in stereographic
based on a GEOGCS called “NinJo sphere”, without any EPSG code, using a sphere
with radius 6378137 m.

The main problem wasn’t the lack of an ordinary geodetic datum, since the most detailed
file had the resolution 4.6 km, much more than the typical difference between datums. 

What bothers me more, with spherical data, is that it seems impossible to know if the
spherical latitude should be interpreted as identical to WGS84 latitude (geodetic latitude),
or if it should be interpreted as geocentric latitude that needs conversion to WGS84.
The difference between the two interpretations can be up to 21 km, which can be
significant even when the datum choice isn’t. 

I was hoping to find that one of the alternatives was a de facto standard, but
instead I found evidence that both of them are in use.

Spherical latitude = geodetic latitude is used by:

      Data in Web Mercator, like Open Street Map,

      Meteorological data in any of the models WRF, MM5 and NinJo.

Spherical latitude = geocentric latitude is used by:

      MISR Regional UAE2 Imagery (from NASA Earth Data).

 

In an old post, Melita Kennedy has written that it is “probably more correct” to use the
second convention; maybe she has experience with data like MISR. 

The Proj.4 FAQ discusses Web Mercator and mentions “many other datasets … such as
many NASA datasets” as using the same convention, so maybe NASA is not consistent
in its choice of convention.  

 

Anyway, what I would like is some standard way to tag the metadata, in GeoTIFF in
my case but more generally in WKT, to specify which convention is used. 
Of course, the problem is already solved in Proj.4, as the FAQ says, since we can use

     +nadgrids=@null

for the first convention, and

     +towgs84=0,0,0

for the second one.

In GeoTiff, specifying TOWGS84[0,0,0] in the same way will be possible as soon
as the proposal http://trac.osgeo.org/geotiff/wiki/TOWGS84GeoKey is supported,
but there will still be no way to specify the first convention.

In WKT, too, only the second convention can be specified.

So I wonder, is there already some discussion going on about how the first convention
could be specified? (Perhaps within OGC or EPSG.)  If not, can we start it? 

Best regards

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

 

REFERENCES:

The way to interpret WRF and MM5 data: http://www.ie.unc.edu/cempd/projects/mims/spatial/grids_ellipsoids_map_proj.html

The way to interpret NinJo data: personal trial-and-error.

The way to interpret MISR UAE2 data: http://eosweb.larc.nasa.gov/PRODOCS/misr/uae/imagery/regional/map_projection.html

Melita Kennedy’s post: http://lists.osgeo.org/pipermail/metacrs/2008-August/000144.html

Proj.4 FAQ: http://trac.osgeo.org/proj/wiki/FAQ#ChangingEllipsoidWhycantIconvertfromWGS84toGoogleEarthVirtualGlobeMercator

 

 

     

 

 



--------------------------------------------------------------------------------
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120306/27a0565e/attachment.html>

From warmerdam at pobox.com  Tue Mar  6 22:08:57 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 6 Mar 2012 22:08:57 -0800
Subject: [Proj] (no subject)
Message-ID: <CA+YzLBe1X=upg4VgDJFsJ1_yksFKA+i0nu=SMcZO+DHm6nkfTg@mail.gmail.com>

Folks,

I have cleared all the issues I considered to be release critical for the
4.8.0 release and I now have a release candidate available at:

  http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
  http://download.osgeo.org/proj/proj-4.8.0RC1.zip

Changes since the Beta include:

2012-03-06  Frank Warmerdam  <warmerdam at pobox.com>

	* Preparing 4.8.0 release candidate.

	* nad/epsg: regenerate with +no_uoff for hotine oblique mercator (#104)

	* src/PJ_sconics.c: Fix missing P->sig term in pconic forward
	projection equation (#148).

2012-03-03  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_omerc.c: Support +no_uoff and +no_off  (#128)

	* src/PJ_stere.c: Cleanup odd code construct (#147)

2012-02-26  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
	to the test suite (#146)

	* nad/CH: added swiss datum related definitions from strk (#145)

	* src/Makefile.am, src/mutltistresstest.c: provide for building
	multistresstest in the makefile, and slightly improve it.

2012-02-25  Frank Warmerdam  <warmerdam at pobox.com>

	* nad/epsg: regenerate with +datum (#122)


The full NEWS file is available at:

  http://svn.osgeo.org/metacrs/proj/trunk/proj/NEWS

I would appreciate folks to try this release candidate and file tickets
for issues, particularly highlighting regressions since 4.7.0.  If I hear
of no issues before the weekend, I'll feel free to promote this release
to final.

I have created a 4.8 branch in anticipation of the release.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From warmerdam at pobox.com  Tue Mar  6 22:09:50 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 6 Mar 2012 22:09:50 -0800
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
Message-ID: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>

Folks,

(Again with a subject line!)

I have cleared all the issues I considered to be release critical for the
4.8.0 release and I now have a release candidate available at:

  http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
  http://download.osgeo.org/proj/proj-4.8.0RC1.zip

Changes since the Beta include:

2012-03-06  Frank Warmerdam  <warmerdam at pobox.com>

	* Preparing 4.8.0 release candidate.

	* nad/epsg: regenerate with +no_uoff for hotine oblique mercator (#104)

	* src/PJ_sconics.c: Fix missing P->sig term in pconic forward
	projection equation (#148).

2012-03-03  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_omerc.c: Support +no_uoff and +no_off  (#128)

	* src/PJ_stere.c: Cleanup odd code construct (#147)

2012-02-26  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
	to the test suite (#146)

	* nad/CH: added swiss datum related definitions from strk (#145)

	* src/Makefile.am, src/mutltistresstest.c: provide for building
	multistresstest in the makefile, and slightly improve it.

2012-02-25  Frank Warmerdam  <warmerdam at pobox.com>

	* nad/epsg: regenerate with +datum (#122)


The full NEWS file is available at:

  http://svn.osgeo.org/metacrs/proj/trunk/proj/NEWS

I would appreciate folks to try this release candidate and file tickets
for issues, particularly highlighting regressions since 4.7.0.  If I hear
of no issues before the weekend, I'll feel free to promote this release
to final.

I have created a 4.8 branch in anticipation of the release.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From sisyphus1 at optusnet.com.au  Wed Mar  7 03:53:21 2012
From: sisyphus1 at optusnet.com.au (Sisyphus)
Date: Wed, 7 Mar 2012 22:53:21 +1100
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
Message-ID: <AAEE1B3502BE45FA9183E0B58322E02C@desktop2>


----- Original Message ----- 
From: "Frank Warmerdam" <warmerdam at pobox.com>
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
Sent: Wednesday, March 07, 2012 5:09 PM
Subject: [Proj] PROJ 4.8.0 Release Candidate 1


> Folks,
>
> (Again with a subject line!)
>
> I have cleared all the issues I considered to be release critical for the
> 4.8.0 release and I now have a release candidate available at:
>
>  http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
>  http://download.osgeo.org/proj/proj-4.8.0RC1.zip
>

No significant issues with this on MS Windows, building in the MSYS shell 
with MinGW.

I built with both a 32-bit gcc-4.5.2 (from mingw.org) and a 64-bit gcc-4.7.0 
(from mingw64.sf).
In both instances 'make check' passed its tests.

As regards the 64-bit build, I find this in my notes that I kept from the 
4.7.0 build:

"There's a conflict between winreg.h and projects.h in that both define a 
PVALUE type. (Only matters when
perl gets involved, and only then with x64.) So I replaced the PVALUE in 
projects.h and pj_param.c with _P_VALUE.)"

I expect this 64-bit-only issue still exists for me with 4.8.0, though I 
haven't actually tested.
If someone wants to circumvent the problem for me, that would be nice. 
Otherwise I'll just apply the same fix if needed ... it's not really a 
problem :-)

For anyone who is curious about the reference to perl, "perl gets involved" 
when I build the "PDL" perl extension.

Cheers,
Rob 



From peifer at gmx.eu  Wed Mar  7 06:05:16 2012
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed, 07 Mar 2012 15:05:16 +0100
Subject: [Proj] Trouble georeferencing data stored in a spherical
	projection.
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49390EC6EA@SETHNWS023.carmenta.se>
References: <E4AB3DD44D22854B819908379DE4AD49390EC6EA@SETHNWS023.carmenta.se>
Message-ID: <4F576B1C.7030806@gmx.eu>

On 06/03/2012 14:38, Mikael Rittri wrote:
> Of course, the problem is already solved in Proj.4, as the FAQ says,
> since we can use
>
> +nadgrids=@null
>
> for the first convention, and
>

Just to add that the FAQ is a bit outdated in this respect as in more 
recent versions of PROJ, the so-called "strategic addition of 
+nadgrids=@null to the spherical projection definition" isn't needed 
anymore.

Hermann


$ echo 50 50 | cs2cs -v +proj=latlong +a=6378137 +to +proj=latlong 
+datum=WGS84

# ---- From Coordinate System ----
#Lat/long (Geodetic alias)
#
# +proj=latlong +a=6378137
# ---- To Coordinate System ----
#Lat/long (Geodetic alias)
#
# +proj=latlong +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
50dE    50dN 0.000


$ echo 50 50 | cs2cs -v +proj=latlong +a=6378137 +towgs84=0,0,0 +to 
+proj=latlong +datum=WGS84

# ---- From Coordinate System ----
#Lat/long (Geodetic alias)
#
# +proj=latlong +a=6378137 +towgs84=0,0,0
# ---- To Coordinate System ----
#Lat/long (Geodetic alias)
#
# +proj=latlong +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
50dE    50d11'20.459"N 12575.088


From gdt at ir.bbn.com  Wed Mar  7 18:54:42 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Wed, 07 Mar 2012 21:54:42 -0500
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
Message-ID: <rmid38n94zx.fsf@fnord.ir.bbn.com>


My experience trying to update pkgsrc with this:

* datumgrid 1.5 doesn't have a .tar.gz, only zip.

For no good reason, it's awkward in pkgsrc to have a package built from
distfiles with different prefixes.  So I'm using datumgrid 1.4 still.
Since that's not part of proj proper, it shouldn't affect 'make check'.

* test failure

Rel. 4.8.0, 6 March 2012
<cs2cs>: while processing file: <stdin>, line 4
pj_transform(): failed to load datum shift file
diff td_out with td_out.dist
18,25c18,25
< -5.5 52.0     *       * 0.000000000000
< -5.5000000000001 52.0000000000001     *       * 0.000000000000
< -5.4999 51.9999       *       * 0.000000000000
< -5.5001 52.0  *       * 0.000000000000
< -5.5 52.0     *       * 0.000000000000
< -5.5000000000001 52.0000000000001     *       * 0.000000000000
< -5.4999 51.9999       *       * 0.000000000000
< -5.5001 52.0  *       * 0.000000000000
---
> -5.5 52.0     -5.501106465528 51.999890470284 0.000000000000
> -5.5000000000001 52.0000000000001     -5.501106465529 51.999890470284 0.000000000000
> -5.4999 51.9999       -5.501006458305 51.999790470257 0.000000000000
> -5.5001 52.0  -5.500100000000 52.000000000000 0.000000000000
> -5.5 52.0     -5.498893534472 52.000109529716 0.000000000000
> -5.5000000000001 52.0000000000001     -5.498893534472 52.000109529717 0.000000000000
> -5.4999 51.9999       -5.498793541695 52.000009529743 0.000000000000
> -5.5001 52.0  -5.500100000000 52.000000000000 0.000000000000

PROBLEMS HAVE OCCURED
test file td_out saved

* missing files

not a problem, but please confirm that:

  nad2nad is no more
  nad_list.h and projects.h is withdrawn

Neither are listed in NEWS.  Also, the addition of proj.pc probably
merits inclusion in NEWS.

--- PLIST       2010-03-14 12:26:22.000000000 -0400
+++ A   2012-03-07 17:54:30.000000000 -0500
@@ -1,19 +1,16 @@
- at comment $NetBSD: PLIST,v 1.1.1.1 2010/03/14 16:26:22 wiz Exp $
+ at comment $NetBSD$
 bin/cs2cs
 bin/geod
 bin/invgeod
 bin/invproj
 bin/nad2bin
-bin/nad2nad
 bin/proj
-include/nad_list.h
 include/org_proj4_Projections.h
 include/proj_api.h
-include/projects.h
 lib/libproj.la
+lib/pkgconfig/proj.pc
 man/man1/cs2cs.1
 man/man1/geod.1
-man/man1/nad2nad.1
 man/man1/proj.1
 man/man3/pj_init.3
 share/proj/FL

* postgis

I built postgis (svn trunk) against an installed proj-4.8.0 package
(built and packaged from the RC1 tarball).  It built fine, and passed
regression tests.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120307/5158ed2a/attachment.sig>

From warmerdam at pobox.com  Thu Mar  8 00:09:56 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 8 Mar 2012 00:09:56 -0800
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <rmid38n94zx.fsf@fnord.ir.bbn.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<rmid38n94zx.fsf@fnord.ir.bbn.com>
Message-ID: <CA+YzLBemOtkBgSFyHMQnD7GPzerz_xXaVuRNHwLdWyH3AZivhw@mail.gmail.com>

On Wed, Mar 7, 2012 at 6:54 PM, Greg Troxel <gdt at ir.bbn.com> wrote:
>
> My experience trying to update pkgsrc with this:
>
> * datumgrid 1.5 doesn't have a .tar.gz, only zip.
>
> For no good reason, it's awkward in pkgsrc to have a package built from
> distfiles with different prefixes.  So I'm using datumgrid 1.4 still.
> Since that's not part of proj proper, it shouldn't affect 'make check'.
>
> * test failure
>
> Rel. 4.8.0, 6 March 2012
> <cs2cs>: while processing file: <stdin>, line 4
> pj_transform(): failed to load datum shift file
> diff td_out with td_out.dist
> 18,25c18,25
> < -5.5 52.0     *       * 0.000000000000
> < -5.5000000000001 52.0000000000001     *       * 0.000000000000
> < -5.4999 51.9999       *       * 0.000000000000
> < -5.5001 52.0  *       * 0.000000000000
> < -5.5 52.0     *       * 0.000000000000
> < -5.5000000000001 52.0000000000001     *       * 0.000000000000
> < -5.4999 51.9999       *       * 0.000000000000
> < -5.5001 52.0  *       * 0.000000000000
> ---
>> -5.5 52.0     -5.501106465528 51.999890470284 0.000000000000
>> -5.5000000000001 52.0000000000001     -5.501106465529 51.999890470284 0.000000000000
>> -5.4999 51.9999       -5.501006458305 51.999790470257 0.000000000000
>> -5.5001 52.0  -5.500100000000 52.000000000000 0.000000000000
>> -5.5 52.0     -5.498893534472 52.000109529716 0.000000000000
>> -5.5000000000001 52.0000000000001     -5.498893534472 52.000109529717 0.000000000000
>> -5.4999 51.9999       -5.498793541695 52.000009529743 0.000000000000
>> -5.5001 52.0  -5.500100000000 52.000000000000 0.000000000000
>
> PROBLEMS HAVE OCCURED
> test file td_out saved

I'm presuming the above failure is related to using the wrong set
of datum files.  The test suite is unfortunately not as flexible as I
would like if not provided provided with the datum shift files.

> * missing files
>
> not a problem, but please confirm that:
>
>  nad2nad is no more
>  nad_list.h and projects.h is withdrawn

nad2nad is no more. I see nad_list.h still exists - I'm not too clear
on what it is/was for, and I don't believe it should be installed or used.
If you file a ticket I'll try to cleanup nad_list.h.

projects.h continues to exist, but we are avoiding installing it.  It
is treated as a private interface now.

> Neither are listed in NEWS.

Ahem, yes, the removal of nad2nad should have been noted.
Also the step to not treat projects.h as a public include file.

> Also, the addition of proj.pc probably merits inclusion in NEWS.

Well, perhaps we can agree to disagree on how important the addition
of proj.pc is.  I do try to keep NEWS to major items. ChangeLog is for
all the details.  (IMHO)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From warmerdam at pobox.com  Thu Mar  8 00:12:31 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 8 Mar 2012 00:12:31 -0800
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <AAEE1B3502BE45FA9183E0B58322E02C@desktop2>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<AAEE1B3502BE45FA9183E0B58322E02C@desktop2>
Message-ID: <CA+YzLBcLn7PgkyT+fGw2c9UAxc+--1OdijGuKw20WFgQt8wmZA@mail.gmail.com>

On Wed, Mar 7, 2012 at 3:53 AM, Sisyphus <sisyphus1 at optusnet.com.au> wrote:
> As regards the 64-bit build, I find this in my notes that I kept from the
> 4.7.0 build:
>
> "There's a conflict between winreg.h and projects.h in that both define a
> PVALUE type. (Only matters when
> perl gets involved, and only then with x64.) So I replaced the PVALUE in
> projects.h and pj_param.c with _P_VALUE.)"
>
> I expect this 64-bit-only issue still exists for me with 4.8.0, though I
> haven't actually tested.
> If someone wants to circumvent the problem for me, that would be nice.
> Otherwise I'll just apply the same fix if needed ... it's not really a
> problem :-)

Rob,

The conflict of projects.h with winreg.h (or at least some windows include
files) is well known and is part of the reason that projects.h is not considered
a public include file.  I'm a bit surprised you are running into a problem
with building on win64.  Normally PROJ itself does not include any windows
include files so it should build clean.

I don't think this is a regression for 4.8 so it should be sufficient if you
could file a ticket with details and this can be fixed post 4.8.0.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From Mikael.Rittri at carmenta.com  Thu Mar  8 00:33:46 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Thu, 8 Mar 2012 08:33:46 +0000
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49390ECEA4@SETHNWS023.carmenta.se>


Hello Frank.

I think the upgrade of omerc should be mentioned in the NEWS.
It is mentioned in the Changelog, but I think the breaking change
needs to be highlighted. Something like this:

o The implementation of omerc (Hotine Oblique Mercator) has been
  completely replaced by code from Gerald Evenden's libproj4.
  The new interface is more similar to the EPSG design, but
  a breaking change is that the +rot_conv flag is gone. This 
  flag used to be necessary to implement Malaysian instances 
  of omerc; now, these need a +gamma parameter instead.
  The +gamma is what EPSG calls "Angle from Rectified to Skew Grid",
  and is known as "rectified_grid_angle" in WKT.
  To indicate Variant A, omerc now accepts either +no_uoff (for
  backwards compatibility) or +no_off (for compatibility with libproj4).
  
(Well, I tend to be longwinded; maybe parts of this ought to be in
 the FAQ instead of the NEWS.)

By the way, I haven't tried the release candidate, but with an older
version, I just noticed that the verbose option erroneously complains that
the +no_off (or +no_uoff) flag doesn't exist.

>proj +proj=omerc +lat_0=4 +lonc=115 +alpha=53.31580995 +k=0.99984 +x_0=0
+y_0=0 +gamma=53.13010236111111 +ellps=GRS80 +units=m +no_off +no_defs -V
#Oblique Mercator
#       Cyl, Sph&Ell no_rot
#       alpha= [gamma=] [no_off] lonc= or
#        lon_1= lat_1= lon_2= lat_2=
# +proj=omerc +lat_0=4 +lonc=115 +alpha=53.31580995 +k=0.99984 +x_0=0 +y_0=0
# +gamma=53.13010236111111 +ellps=GRS80 +units=m +no_defs
#--- following specified but NOT used
# +no_off
#Final Earth figure: ellipsoid
#  Major axis (a): 6378137.000
#  1/flattening: 298.257222
#  squared eccentricity: 0.006694380023

This is confusing but not critical, I think, and perhaps it has been fixed
in the release candidate.

Regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

-----Original Message-----
From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Frank Warmerdam
Sent: Wednesday, March 07, 2012 7:10 AM
To: PROJ.4 and general Projections Discussions
Subject: [Proj] PROJ 4.8.0 Release Candidate 1

Folks,

(Again with a subject line!)

I have cleared all the issues I considered to be release critical for the
4.8.0 release and I now have a release candidate available at:

  http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
  http://download.osgeo.org/proj/proj-4.8.0RC1.zip

Changes since the Beta include:

2012-03-06  Frank Warmerdam  <warmerdam at pobox.com>

	* Preparing 4.8.0 release candidate.

	* nad/epsg: regenerate with +no_uoff for hotine oblique mercator (#104)

	* src/PJ_sconics.c: Fix missing P->sig term in pconic forward
	projection equation (#148).

2012-03-03  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_omerc.c: Support +no_uoff and +no_off  (#128)

	* src/PJ_stere.c: Cleanup odd code construct (#147)

2012-02-26  Frank Warmerdam  <warmerdam at pobox.com>

	* src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
	to the test suite (#146)

	* nad/CH: added swiss datum related definitions from strk (#145)

	* src/Makefile.am, src/mutltistresstest.c: provide for building
	multistresstest in the makefile, and slightly improve it.

2012-02-25  Frank Warmerdam  <warmerdam at pobox.com>

	* nad/epsg: regenerate with +datum (#122)


The full NEWS file is available at:

  http://svn.osgeo.org/metacrs/proj/trunk/proj/NEWS

I would appreciate folks to try this release candidate and file tickets
for issues, particularly highlighting regressions since 4.7.0.  If I hear
of no issues before the weekend, I'll feel free to promote this release
to final.

I have created a 4.8 branch in anticipation of the release.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From support.mn at elisanet.fi  Thu Mar  8 01:14:24 2012
From: support.mn at elisanet.fi (support.mn at elisanet.fi)
Date: Thu, 8 Mar 2012 11:14:24 +0200 (EET)
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
Message-ID: <19218287.2877981331198064618.JavaMail.support.mn@elisanet.fi>

Hello Frank,

could you exclude or separate change log entries to their own files
or groups so that different parts of the package could be seen.
We are only using the proj.4 library part (not nad2nad, cs2cs, etc.) and
we are having difficulty to figure out if there was any changes.

regards: Janne.

---------------------------------------------------------

Frank Warmerdam [warmerdam at pobox.com] kirjoitti: 
> Folks,
> 
> (Again with a subject line!)
> 
> I have cleared all the issues I considered to be release critical for the
> 4.8.0 release and I now have a release candidate available at:
> 
>   http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
>   http://download.osgeo.org/proj/proj-4.8.0RC1.zip
> 
> Changes since the Beta include: ..................




From martin.raspaud at smhi.se  Thu Mar  8 02:43:03 2012
From: martin.raspaud at smhi.se (Martin Raspaud)
Date: Thu, 8 Mar 2012 11:43:03 +0100
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
Message-ID: <4F588D37.7050108@smhi.se>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 07/03/12 07:09, Frank Warmerdam wrote:
> * src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS to
> the test suite (#146)

Hi Frank,

I talked further with the people involved in the new sweep option, and
it seems agreed that the default axis and flipped axis should be reversed.

Should I send the patch for this here or should I reopen the trac
ticket and put the patch there ?

Best regards,
Martin
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.14 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJPWI03AAoJEBdvyODiyJI4i6YIAOEHAtsu9lLjX16nqB2HUNKp
4grB/6C8B8uoQqONtX5qIwsVSW24SMshA251bvLdh1Hh/kzWYZZRjEGHeGjAD8ix
AZ2rptHCv4j0+oOT6eTsNm+rQsGauFoL+3JHWtEZQxJvPzKNCtyfoGXX1855N9T6
nzVmMuFlHQaMAFYCWcVPpeI++/LgnXNmTouWU2ezQ7nScOCrUkcqsPoFgLivIBya
lYg9BPidYlwV/dJqj1baPSfP8JiDXFTYLsLyqtlc0ki0r1vsxqKPmRCGVcvtSQD0
f9FUt7CivxOnc6QkmDt7zjgd3zbeTjSmqxQZ7p06DtMQMc2ufcF2Vah8wg7Lm6g=
=09F9
-----END PGP SIGNATURE-----
-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 303 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120308/aec71124/attachment.vcf>

From gdt at ir.bbn.com  Thu Mar  8 08:41:33 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Thu, 08 Mar 2012 11:41:33 -0500
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBemOtkBgSFyHMQnD7GPzerz_xXaVuRNHwLdWyH3AZivhw@mail.gmail.com>
	(Frank Warmerdam's message of "Thu, 8 Mar 2012 00:09:56 -0800")
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<rmid38n94zx.fsf@fnord.ir.bbn.com>
	<CA+YzLBemOtkBgSFyHMQnD7GPzerz_xXaVuRNHwLdWyH3AZivhw@mail.gmail.com>
Message-ID: <rmi8vjbqc3m.fsf@fnord.ir.bbn.com>


[will reply about the grid file issue later; I need to look in README to
see if the requirement to use a particular one is clearly stated.   If
you could post a .tar.gz of the proper version that would be helpful.]


  >  nad2nad is no more
  >  nad_list.h and projects.h is withdrawn

  nad2nad is no more. I see nad_list.h still exists - I'm not too clear
  on what it is/was for, and I don't believe it should be installed or used.
  If you file a ticket I'll try to cleanup nad_list.h.

  projects.h continues to exist, but we are avoiding installing it.  It
  is treated as a private interface now.

  > Neither are listed in NEWS.

  Ahem, yes, the removal of nad2nad should have been noted.
  Also the step to not treat projects.h as a public include file.

Sounds good - I gather that postgis has run into this.

  > Also, the addition of proj.pc probably merits inclusion in NEWS.

  Well, perhaps we can agree to disagree on how important the addition
  of proj.pc is.  I do try to keep NEWS to major items. ChangeLog is for
  all the details.  (IMHO)

Your call, of course.  I see NEWS as user-visible changes.  Part of the
issue is that proj is both a library and a user program, and from the
library view this is somewhat important.  On the other hand, what really
matters is that when it becomes reasonable for depending programs to say
"this only works with proj >= 4.8.0" then they can switch to only using
pkg-config to find it.  Which means that the addition is not
particularly noteworthy or urgent.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120308/86794763/attachment.sig>

From jennyb at geo.oregonstate.edu  Thu Mar  8 15:46:20 2012
From: jennyb at geo.oregonstate.edu (Bernhard Jenny)
Date: Thu, 8 Mar 2012 15:46:20 -0800
Subject: [Proj] Natural Earth projection
In-Reply-To: <D870F1D8833C43B89C46E94DA2CF55FF@PCHP>
References: <D870F1D8833C43B89C46E94DA2CF55FF@PCHP>
Message-ID: <77B5FF42-A2DF-4609-82E0-94B325BE046C@geo.oregonstate.edu>

In Reply to:
Oscar van Vlijmen ovv at hetnet.nl
Mar 4, 2012, at 8:33 AM

> Could be my error, but as closer I get to a pole, the more inaccurate the 
> inverse gets.
> The error amounts to several degrees. Useless!
> 
> Examples:
> 
> R = 6371008.7714 m

…

> lat, lon = 89.0, 120.0
> -> x,y = 6604995.340672151, 9042363.459174621
> inverse, back to lat, lon: 86.95668, 113.64953


I'm unable to reproduce the problem. Below is the code I use (JavaScript from http://www.shadedrelief.com/NE_proj/code.html  embedded in a HTML file). I apologize for posting JavaScript and HTML on this list.

Bernie


<html>
<head>

<script type="text/javascript">
var MAX_Y = 0.8707 * 0.52 * Math.PI;

function forward(lon, lat, xy) {
	var lat2 = lat * lat;
	var lat4 = lat2 * lat2;
	xy[0] = lon * (0.8707 - 0.131979 * lat2 + lat4 * (-0.013791 + lat4 * (0.003971 * lat2 - 0.001529 * lat4)));
	xy[1] = lat * (1.007226 + lat2 * (0.015085 + lat4 * (-0.044475 + 0.028874 * lat2 - 0.005916 * lat4)));
};

function inverse(x, y, lonlat) {
	var yc, tol, y2, y4, f, fder;

	if(y > MAX_Y) {
		y = MAX_Y;
	} else if(y < -MAX_Y) {
		y = -MAX_Y;
	}

	// Newton's method
	yc = y;
	for(; ; ) {
		y2 = yc * yc;
		y4 = y2 * y2;
		f = (yc * (1.007226 + y2 * (0.015085 + y4 * (-0.044475 + 0.028874 * y2 - 0.005916 * y4)))) - y;
		fder = 1.007226 + y2 * (0.015085 * 3 + y4 * (-0.044475 * 7 + 0.028874 * 9 * y2 - 0.005916 * 11 * y4));
		yc -= tol = f / fder;
		if(Math.abs(tol) < 0.0000000001) {
			break;
		}
	}
	lonlat[1] = yc;
	y2 = yc * yc;
	lonlat[0] = x / (0.8707 + y2 * (-0.131979 + y2 * (-0.013791 + y2 * y2 * y2 * (0.003971 - 0.001529 * y2))));
};
</script>
</head>

<body>

<script type="text/javascript">
	var R = 6371008.7714;
	var lat = 89 / 180 * Math.PI, lon = 120 / 180 * Math.PI;
	var xy = [];
	
	forward (lon, lat, xy);
	document.write((xy[0] * R).toFixed(10) + " / " + (xy[1] * R).toFixed(10) + "<br>");
	inverse (xy[0], xy[1], xy);
	document.write((xy[0] / Math.PI * 180).toFixed(10) + " / " + (xy[1] / Math.PI * 180).toFixed(10));
</script>

</body>

From martin.raspaud at smhi.se  Fri Mar  9 00:24:42 2012
From: martin.raspaud at smhi.se (Martin Raspaud)
Date: Fri, 9 Mar 2012 09:24:42 +0100
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F588D37.7050108@smhi.se>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F588D37.7050108@smhi.se>
Message-ID: <4F59BE4A.6010104@smhi.se>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 08/03/12 11:43, Martin Raspaud wrote:
> On 07/03/12 07:09, Frank Warmerdam wrote:
>> * src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
>> to the test suite (#146)
> 
> Hi Frank,
> 
> I talked further with the people involved in the new sweep option,
> and it seems agreed that the default axis and flipped axis should
> be reversed.
> 
> Should I send the patch for this here or should I reopen the trac 
> ticket and put the patch there ?

Hi again,

Here is the patch.

Best regards,
Martin
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.14 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJPWb5KAAoJEBdvyODiyJI4bxMIALmtbuUqwqOtSIl6cdzdjPxc
6NvebFdCZhn2Tw08FfgShKPsub13lXKz1Z5KbCW5F70S2qPDV1X6Cz76HWi/wKVF
iuLRkra6xC+8G6LFJwuNDpYlRhhmvGz2rQnHlWWziLbluOM402UBCfTQ1rOOIm1l
/wEGiCqXHUKPKSenEPpLcAG2N5V7wXOIiHcBoJBOV6qy660NpZ/UUpzVAw7isig1
5rja8r8ndonFwG+wzRK1aDZjrrThS7ixnjwV197Wro9yvnKPsgHW7tA6QKV0uVRf
krQCfbQfPeN8yHUlryYVUziJI9yO3hpQYM+KZPKTDVhC0tmwhH0GjQd0NLOTuA8=
=iGD2
-----END PGP SIGNATURE-----
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: geos-xy.patch
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120309/e71babc6/attachment.ksh>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: geos-xy.patch.sig
Type: application/pgp-signature
Size: 287 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120309/e71babc6/attachment.sig>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 303 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120309/e71babc6/attachment.vcf>

From ovv at hetnet.nl  Fri Mar  9 03:23:20 2012
From: ovv at hetnet.nl (OvV_HN)
Date: Fri, 9 Mar 2012 12:23:20 +0100
Subject: [Proj]  Natural Earth projection
Message-ID: <905B47B6D8A6499CA6A8AB60A3B1F859@PCHP>

[Proj] Natural Earth projection
Bernhard Jenny jennyb at geo.oregonstate.edu
Thu Mar 8 18:46:20 EST 2012


Hi Berhard,

Regarding a possible error in the inverse projection function Natural Earth:

Thanks for looking into this problem!
Luckily it was my fault, excuses for that.

The problem was not quite standard (JavaScript) code in the original, which 
I cleaned up. In this process a small typographic error was made, with large 
consequences.
Your code will undoubtedly pass many JavaScript interpreters, but not all.
Especially the following two constructs are likely to give somewhere a 
problem:
    for(; ; )
and
    yc -= tol = f / fder;

My corrected code now goes all the way up to the poles, for instance:

R = 6371008.7714;
lat = 90.0d, lon = 120.0d
gives x = 6394608.652918302, y = 9062062.394736718
back to lat, lon: 90.00000000000014, 120.00000000000055 d
in 7 Newton iteration steps.

If someone could check the provided PROJ C-code, the Natural Earth 
projection code could be added to the PROJ package, if so desired!

Oscar van Vlijmen








From support.mn at elisanet.fi  Fri Mar  9 06:13:06 2012
From: support.mn at elisanet.fi (support.mn at elisanet.fi)
Date: Fri, 9 Mar 2012 16:13:06 +0200 (EET)
Subject: [Proj] UNPP optimizations - was Re:   Natural Earth projection
Message-ID: <23838063.8880541331302387048.JavaMail.support.mn@elisanet.fi>

Hello,

I started to be interested about the number of iteration steps
in the inverse (iterative) conversion.. we all need maximum
speed.. so:

you could call it (Usually Near the Previous Point)
UNPP optimization - what does it mean? Simply the code could
assume that the next point is very close the previous point converted
and since this is mostly the case speed up the inverse iteration..
so it could assume that the inverse is the previous inverse
calculated (what ever that was) and so lessen the number of
iteration steps.

I do not know if this optimization is already used but I am sure it
might be worth testing - at least in our systems the converted
points are usually very close each other? This could be behind
a switch for cases where the normal method would be faster (if
ever)?

regards: Janne.

--------------------------------------------------------------------------




OvV_HN [ovv at hetnet.nl] kirjoitti: 
> [Proj] Natural Earth projection
> Bernhard Jenny jennyb at geo.oregonstate.edu
> Thu Mar 8 18:46:20 EST 2012
> 
> 
> Hi Berhard,
> 
> Regarding a possible error in the inverse projection function Natural Earth:
> 
> Thanks for looking into this problem!
> Luckily it was my fault, excuses for that.
> 
> The problem was not quite standard (JavaScript) code in the original, which 
> I cleaned up. In this process a small typographic error was made, with large 
> consequences.
> Your code will undoubtedly pass many JavaScript interpreters, but not all.
> Especially the following two constructs are likely to give somewhere a 
> problem:
>     for(; ; )
> and
>     yc -= tol = f / fder;
> 
> My corrected code now goes all the way up to the poles, for instance:
> 
> R = 6371008.7714;
> lat = 90.0d, lon = 120.0d
> gives x = 6394608.652918302, y = 9062062.394736718
> back to lat, lon: 90.00000000000014, 120.00000000000055 d
> in 7 Newton iteration steps.
> 
> If someone could check the provided PROJ C-code, the Natural Earth 
> projection code could be added to the PROJ package, if so desired!
> 
> Oscar van Vlijmen
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 



From ovv at hetnet.nl  Fri Mar  9 06:57:31 2012
From: ovv at hetnet.nl (OvV_HN)
Date: Fri, 9 Mar 2012 15:57:31 +0100
Subject: [Proj]  UNPP optimizations - was Re: Natural Earth projection
Message-ID: <F50527BB88924EAF9F8FD9E0EEC2E295@PCHP>

[Proj] UNPP optimizations - was Re: Natural Earth projection
support.mn at elisanet.fi support.mn at elisanet.fi
Fri Mar 9 09:13:06 EST 2012

Re:
I started to be interested about the number of iteration steps
in the inverse (iterative) conversion.. we all need maximum
speed.. so:
you could call it (Usually Near the Previous Point)
UNPP optimization ................

Reply (for what it's worth, probably 2 cents):

In the case of the Natural Earth projection the number of iteration steps 
seems to be low.
Some examples:
R = 6371008.7714 m
lat, lon = 70.0,120.0; inverse needs 4 iterations
lat, lon = 80.0,120.0; inverse needs 4 iterations
lat, lon = 85.0,120.0; inverse needs 5 iterations
lat, lon = 89.0,120.0; inverse needs 7 iterations
lat, lon = 90.0,120.0; inverse needs 7 iterations

Note that the iteration loop only has a couple of multiplications and one 
division.
The polynomial is efficiently calculated with a Horner scheme.
A UNPP optimized code could be quite involved. Calculating from the previous 
point will certainly involve some math, but probably no time consuming 
divisions or transcendentals. But after a series of points an original 
calculation has to be done in order to retain accuracy. Decision tests have 
to be made and these could cost some time.

I wonder if such an optimization will lead to a significant reduction in 
time for very simple iterative procedures which are looped less than say 10 
times.
But for relatively time consuming loops that have to be done 40 times or so 
until convergence, times 10 million pixels........ optimization should be 
investigated!


Oscar van Vlijmen





From gdt at ir.bbn.com  Fri Mar  9 18:01:10 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 09 Mar 2012 21:01:10 -0500
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <rmid38n94zx.fsf@fnord.ir.bbn.com> (Greg Troxel's message of
	"Wed, 07 Mar 2012 21:54:42 -0500")
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<rmid38n94zx.fsf@fnord.ir.bbn.com>
Message-ID: <rmi8vj9kye1.fsf@fnord.ir.bbn.com>


Thanks for the datumgrid version explanation.
I got proj-datumgrid-1.5 and with that the test suite passes.

Would it be possible to get proj-datumgrid-1.5.tar.gz on the download
server?  That seems to be the only file available in zip but not .tar.gz.

Also, proj-datumgrid-1.5 lacks a clear license.  Are all of those files
public domain?


The README does not explain that proj-datumgrid-1.5 is needed; patch:

--- README.~1~	2010-12-05 11:06:32.000000000 -0500
+++ README	2012-03-09 20:55:09.000000000 -0500
@@ -40,6 +40,13 @@
 
 The install target will create, if necessary, all required sub-directories.
 
+To test, execute:
+
+	make check
+
+Note that you must have installed proj-datumgrid-1.5 in nad prior to
+building; the test suite includes grid shift tests.
+
 Windows Build
 -------------
 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120309/bd41e122/attachment.sig>

From jmckenna at gatewaygeomatics.com  Tue Mar 13 08:46:51 2012
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 13 Mar 2012 12:46:51 -0300
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
Message-ID: <4F5F6BEB.3000902@gatewaygeomatics.com>

RC1 looks good here on Windows with MSVC.

Question for someone: for an x64 build on Windows, I don't see any x64
switches in nmake.opt or makefile.vc - so am I correct that there are no
special steps for compiling PROJ for x64?  (in other words, actual
Winx64 PROJ builds are not possible to produce?)

Thanks.

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






On 12-03-07 2:09 AM, Frank Warmerdam wrote:
> Folks,
> 
> (Again with a subject line!)
> 
> I have cleared all the issues I considered to be release critical for the
> 4.8.0 release and I now have a release candidate available at:
> 
>   http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
>   http://download.osgeo.org/proj/proj-4.8.0RC1.zip
> 
> Changes since the Beta include:
> 
> 2012-03-06  Frank Warmerdam  <warmerdam at pobox.com>
> 
> 	* Preparing 4.8.0 release candidate.
> 
> 	* nad/epsg: regenerate with +no_uoff for hotine oblique mercator (#104)
> 
> 	* src/PJ_sconics.c: Fix missing P->sig term in pconic forward
> 	projection equation (#148).
> 
> 2012-03-03  Frank Warmerdam  <warmerdam at pobox.com>
> 
> 	* src/PJ_omerc.c: Support +no_uoff and +no_off  (#128)
> 
> 	* src/PJ_stere.c: Cleanup odd code construct (#147)
> 
> 2012-02-26  Frank Warmerdam  <warmerdam at pobox.com>
> 
> 	* src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
> 	to the test suite (#146)
> 
> 	* nad/CH: added swiss datum related definitions from strk (#145)
> 
> 	* src/Makefile.am, src/mutltistresstest.c: provide for building
> 	multistresstest in the makefile, and slightly improve it.
> 
> 2012-02-25  Frank Warmerdam  <warmerdam at pobox.com>
> 
> 	* nad/epsg: regenerate with +datum (#122)
> 
> 
> The full NEWS file is available at:
> 
>   http://svn.osgeo.org/metacrs/proj/trunk/proj/NEWS
> 
> I would appreciate folks to try this release candidate and file tickets
> for issues, particularly highlighting regressions since 4.7.0.  If I hear
> of no issues before the weekend, I'll feel free to promote this release
> to final.
> 
> I have created a 4.8 branch in anticipation of the release.
> 
> Best regards,
> 



From EMiller at dfg.ca.gov  Tue Mar 13 09:26:26 2012
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Tue, 13 Mar 2012 09:26:26 -0700
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F5F6BEB.3000902@gatewaygeomatics.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F5F6BEB.3000902@gatewaygeomatics.com>
Message-ID: <4F5F12C2.95FD.00E4.1@dfg.ca.gov>

Jeff,

I believe it's a matter of configuring the MSVC environment. For instance,

C:\proj-4.8.0>"\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" amd64
C:\proj-4.8.0>nmake /f makefile.vc

See, http://msdn.microsoft.com/en-us/library/x4d2c09s%28v=vs.100%29.aspx

You'll need a 64-bit MSVC compiler, though.  Apparently that isn't shipped with the free Visual C++ Express.
-- 

Eric G. Miller
Software Developer
CA Dept. of Fish & Game


>>> On 3/13/2012 at  8:46 AM, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> RC1 looks good here on Windows with MSVC.
> 
> Question for someone: for an x64 build on Windows, I don't see any x64
> switches in nmake.opt or makefile.vc - so am I correct that there are no
> special steps for compiling PROJ for x64?  (in other words, actual
> Winx64 PROJ builds are not possible to produce?)
> 
> Thanks.
> 
> -jeff
> 
> 
> 




From warmerdam at pobox.com  Tue Mar 13 09:44:11 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 13 Mar 2012 09:44:11 -0700
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F5F12C2.95FD.00E4.1@dfg.ca.gov>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F5F6BEB.3000902@gatewaygeomatics.com>
	<4F5F12C2.95FD.00E4.1@dfg.ca.gov>
Message-ID: <CA+YzLBf1H8gFmt88Ypb6TGZ0mLV2ewFhyFrQNmofeuCd3ggf5A@mail.gmail.com>

On Tue, Mar 13, 2012 at 9:26 AM, Eric Miller <EMiller at dfg.ca.gov> wrote:
> Jeff,
>
> I believe it's a matter of configuring the MSVC environment. For instance,
>
> C:\proj-4.8.0>"\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" amd64
> C:\proj-4.8.0>nmake /f makefile.vc
>
> See, http://msdn.microsoft.com/en-us/library/x4d2c09s%28v=vs.100%29.aspx
>
> You'll need a 64-bit MSVC compiler, though.  Apparently that isn't shipped with the free Visual C++ Express.

Eric / Jeff,

Right, you should be able to use the makefile.vc though you may
need to fiddle with the OPTFLAGS or other settings in
proj\nmake.opt for 64bit.  I haven't tried it on win64 myself so if
anyone has a chance to try it that would be helpful.

BTW, I'm hoping to promote the release to final today.  I will likely
add a few items to the NEWS file first but not otherwise change
the package.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From jmckenna at gatewaygeomatics.com  Tue Mar 13 09:44:20 2012
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 13 Mar 2012 13:44:20 -0300
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F5F12C2.95FD.00E4.1@dfg.ca.gov>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F5F6BEB.3000902@gatewaygeomatics.com>
	<4F5F12C2.95FD.00E4.1@dfg.ca.gov>
Message-ID: <4F5F7964.3030800@gatewaygeomatics.com>

Thanks Eric.  Yup I already run the MSVC x64 commandline compiler - I
was just looking for the Win64 switch that is common in other makefiles
(such as GDAL).  From your answer I guess there is none, so I'll plow
onward :)

-jeff



On 12-03-13 1:26 PM, Eric Miller wrote:
> Jeff,
> 
> I believe it's a matter of configuring the MSVC environment. For instance,
> 
> C:\proj-4.8.0>"\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" amd64
> C:\proj-4.8.0>nmake /f makefile.vc
> 
> See, http://msdn.microsoft.com/en-us/library/x4d2c09s%28v=vs.100%29.aspx
> 
> You'll need a 64-bit MSVC compiler, though.  Apparently that isn't shipped with the free Visual C++ Express.


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From jmfluis at gmail.com  Tue Mar 13 09:44:50 2012
From: jmfluis at gmail.com (J Luis)
Date: Tue, 13 Mar 2012 16:44:50 +0000
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F5F6BEB.3000902@gatewaygeomatics.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F5F6BEB.3000902@gatewaygeomatics.com>
Message-ID: <CAE_VgzNooJS4ZOq144Cm4_roCghcjM_SaLmGy6TWxVPiTo1p6g@mail.gmail.com>

Jeff,

I build 32 and 64 version with no problem. The only thing I change is if I
run the make from a shell previously 'loaded' with the 32 or 64 bit
versions argument to vcvarsall.bat

Joaquim

On Tue, Mar 13, 2012 at 3:46 PM, Jeff McKenna <jmckenna at gatewaygeomatics.com
> wrote:

> RC1 looks good here on Windows with MSVC.
>
> Question for someone: for an x64 build on Windows, I don't see any x64
> switches in nmake.opt or makefile.vc - so am I correct that there are no
> special steps for compiling PROJ for x64?  (in other words, actual
> Winx64 PROJ builds are not possible to produce?)
>
> Thanks.
>
> -jeff
>
>
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> http://www.gatewaygeomatics.com/
>
>
>
>
>
>
> On 12-03-07 2:09 AM, Frank Warmerdam wrote:
> > Folks,
> >
> > (Again with a subject line!)
> >
> > I have cleared all the issues I considered to be release critical for the
> > 4.8.0 release and I now have a release candidate available at:
> >
> >   http://download.osgeo.org/proj/proj-4.8.0RC1.tar.gz
> >   http://download.osgeo.org/proj/proj-4.8.0RC1.zip
> >
> > Changes since the Beta include:
> >
> > 2012-03-06  Frank Warmerdam  <warmerdam at pobox.com>
> >
> >       * Preparing 4.8.0 release candidate.
> >
> >       * nad/epsg: regenerate with +no_uoff for hotine oblique mercator
> (#104)
> >
> >       * src/PJ_sconics.c: Fix missing P->sig term in pconic forward
> >       projection equation (#148).
> >
> > 2012-03-03  Frank Warmerdam  <warmerdam at pobox.com>
> >
> >       * src/PJ_omerc.c: Support +no_uoff and +no_off  (#128)
> >
> >       * src/PJ_stere.c: Cleanup odd code construct (#147)
> >
> > 2012-02-26  Frank Warmerdam  <warmerdam at pobox.com>
> >
> >       * src/PJ_geos.c, nad/testvarious: Added GEOS +sweep and add GEOS
> >       to the test suite (#146)
> >
> >       * nad/CH: added swiss datum related definitions from strk (#145)
> >
> >       * src/Makefile.am, src/mutltistresstest.c: provide for building
> >       multistresstest in the makefile, and slightly improve it.
> >
> > 2012-02-25  Frank Warmerdam  <warmerdam at pobox.com>
> >
> >       * nad/epsg: regenerate with +datum (#122)
> >
> >
> > The full NEWS file is available at:
> >
> >   http://svn.osgeo.org/metacrs/proj/trunk/proj/NEWS
> >
> > I would appreciate folks to try this release candidate and file tickets
> > for issues, particularly highlighting regressions since 4.7.0.  If I hear
> > of no issues before the weekend, I'll feel free to promote this release
> > to final.
> >
> > I have created a 4.8 branch in anticipation of the release.
> >
> > Best regards,
> >
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120313/0894dff8/attachment.html>

From warmerdam at pobox.com  Tue Mar 13 16:25:26 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 13 Mar 2012 16:25:26 -0700
Subject: [Proj] PROJ 4.8.0 Released
Message-ID: <CA+YzLBfvU0LONOWmBhHvay6BPDHkg1MpgcJCfALz47pnYA5YrQ@mail.gmail.com>

Folks,

I am pleased to announce the release of PROJ 4.8.0.  This is a
major new feature release and collects all the work done since
the PROJ 4.7.0 release in September 2009.  The NEWS file includes
these major items:

 * Added the Natural Earth projection.
 * Added HEALPIX, rHEALPIX and Icosahedral Snyder Equal Area projections.
 * nad2bin now produces "CTable2" format grid shift files by default which
   are platform independent.
 * nad2nad removed, use cs2cs for datum shift operations.
 * projects.h no longer installed as a public include file.  Please try to
    only use proj_api.h.
 * Add pj_get_spheroid_defn() accessor.
 * Added an alternate version of pj_init() that takes a projCtx (execution
    context) structure to address multithreading issues with error management
    and to provide a support for application hookable error reporting and
    logging.
 * Upgrade to EPSG 7.9.  Some changes in ideal datum selection.
 * JNI bindings reworked, org.proj4.Projections deprecated in favor of
    org.proj4.PJ.
 * Added preliminary vertical datum support.
 * Fix various multithreading issues, particular in datum grid handling code.
 * Added support for the +axis= option for alternate axis orientations as
    part of a coordinate system (used for TM South Orientated support).
 * +proj=omerc implementatioin replaced with code from libproj4.  +rot_conv
    flag no longer works, and some coordinate systems (ie. Malaysian) will
    need to use +gamma instead.  "epsg" init file updated accordingly.

More detailed information on work can be found in the ChangeLog file at:

  http://svn.osgeo.org/metacrs/proj/tags/4.8.0/proj/ChangeLog

The source code can be found at:

  http://download.osgeo.org/proj/proj-4.8.0.tar.gz
  http://download.osgeo.org/proj/proj-4.8.0.zip

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From martin.raspaud at smhi.se  Tue Mar 13 23:50:47 2012
From: martin.raspaud at smhi.se (Martin Raspaud)
Date: Wed, 14 Mar 2012 07:50:47 +0100
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F59BE4A.6010104@smhi.se>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F588D37.7050108@smhi.se> <4F59BE4A.6010104@smhi.se>
Message-ID: <4F603FC7.5040406@smhi.se>

On 09/03/12 09:24, Martin Raspaud wrote:

> 
> Hi again,
> 
> Here is the patch.

Hi Frank,

Nice that you release proj 4.8.0. Did you get chance to update with the
patch I sent you ? Otherwise I'll have to accomodate in the documentation...

Best regards,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 303 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120314/703559b5/attachment.vcf>

From warmerdam at pobox.com  Wed Mar 14 00:19:15 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 14 Mar 2012 00:19:15 -0700
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <4F603FC7.5040406@smhi.se>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F588D37.7050108@smhi.se> <4F59BE4A.6010104@smhi.se>
	<4F603FC7.5040406@smhi.se>
Message-ID: <CA+YzLBf-4miiih9bHdkq1yBC+ZobC_BX1-9jdS6=OOZTBRYrhg@mail.gmail.com>

On Tue, Mar 13, 2012 at 11:50 PM, Martin Raspaud <martin.raspaud at smhi.se> wrote:
> On 09/03/12 09:24, Martin Raspaud wrote:
>
>>
>> Hi again,
>>
>> Here is the patch.
>
> Hi Frank,
>
> Nice that you release proj 4.8.0. Did you get chance to update with the
> patch I sent you ? Otherwise I'll have to accomodate in the documentation...

Martin,

The only change I made from the RC1 was extending the NEWS
file a bit.  I'd appreciate it if you could file your patch in Trac so it
does not get lost.  I'll try to incorporate it in trunk as soon as practical.
Also, try to describe the nature of the issue in the ticket, so we can
decide if it also belongs in the 4.8 branch.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From martin.raspaud at smhi.se  Wed Mar 14 02:29:36 2012
From: martin.raspaud at smhi.se (Martin Raspaud)
Date: Wed, 14 Mar 2012 10:29:36 +0100
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBf-4miiih9bHdkq1yBC+ZobC_BX1-9jdS6=OOZTBRYrhg@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F588D37.7050108@smhi.se> <4F59BE4A.6010104@smhi.se>
	<4F603FC7.5040406@smhi.se>
	<CA+YzLBf-4miiih9bHdkq1yBC+ZobC_BX1-9jdS6=OOZTBRYrhg@mail.gmail.com>
Message-ID: <4F606500.4020000@smhi.se>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 14/03/12 08:19, Frank Warmerdam wrote:
> On Tue, Mar 13, 2012 at 11:50 PM, Martin Raspaud
> <martin.raspaud at smhi.se> wrote:
>> On 09/03/12 09:24, Martin Raspaud wrote:
>> 
>>> 
>>> Hi again,
>>> 
>>> Here is the patch.
>> 
>> Hi Frank,
>> 
>> Nice that you release proj 4.8.0. Did you get chance to update
>> with the patch I sent you ? Otherwise I'll have to accomodate in
>> the documentation...
> 
> Martin,
> 
> The only change I made from the RC1 was extending the NEWS file a
> bit.  I'd appreciate it if you could file your patch in Trac so it 
> does not get lost.  I'll try to incorporate it in trunk as soon as
> practical. Also, try to describe the nature of the issue in the
> ticket, so we can decide if it also belongs in the 4.8 branch.

Hi Franck,

I reopened the the ticket (geos +sweep) about a week ago and attached
the patch. I added a small description now on the nature of the
change. Tell me if it isn't clear, I'll enhance it.

Too bad it didn't make it in 4.8.0...

Best regards,
Martin
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.14 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQEcBAEBAgAGBQJPYGUAAAoJEBdvyODiyJI4q6YH/3aTCZSrEHIpHkfDBKsvnByA
SMnUugRYj7cpthijo/BgtnK7g/0FhtumM1ydFxDBvWOnrjGyoAAa+9EiDRkD8iIb
HcsOvJB2DGs1ZH/NP6yjJO3o7XsEvoq/7EWfqH7Ry1/foggXy1mfuaMGyAQDvQr4
p7lduwNBbx63CnruVBvUEQU63jTcwrt5Pw9F08HjGXQuJitHUdcZV2PMSohJFpsd
0x+OZ2jZo4D+sq8JqnaoeP6yODN85ltlvyvxVuI85/AKP/d1QB44wzcAv+ow6ksd
rrQt6hSuByOpWdwidkFYfgYdkaHzOGQBcslYHlDCjL3nnbo2anlkogo80Kt/WSY=
=OR5Q
-----END PGP SIGNATURE-----
-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 303 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120314/0921c48b/attachment.vcf>

From jmckenna at gatewaygeomatics.com  Wed Mar 14 08:02:15 2012
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 14 Mar 2012 12:02:15 -0300
Subject: [Proj] PROJ 4.8.0 Release Candidate 1
In-Reply-To: <CA+YzLBf1H8gFmt88Ypb6TGZ0mLV2ewFhyFrQNmofeuCd3ggf5A@mail.gmail.com>
References: <CA+YzLBctQyr2kgJkJCfmEKC9VjEFvSnTt6W9RPzr1M=046d0-w@mail.gmail.com>
	<4F5F6BEB.3000902@gatewaygeomatics.com>
	<4F5F12C2.95FD.00E4.1@dfg.ca.gov>
	<CA+YzLBf1H8gFmt88Ypb6TGZ0mLV2ewFhyFrQNmofeuCd3ggf5A@mail.gmail.com>
Message-ID: <4F60B2F7.9090605@gatewaygeomatics.com>

On 12-03-13 1:44 PM, Frank Warmerdam wrote:
> 
> Right, you should be able to use the makefile.vc though you may
> need to fiddle with the OPTFLAGS or other settings in
> proj\nmake.opt for 64bit.  I haven't tried it on win64 myself so if
> anyone has a chance to try it that would be helpful.

I tested win64 with PROJ 4.8.0, I didn't have to make any settings
changes in makefile.vc/nmake.opt - works great, thanks!

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From noorcs22 at gmail.com  Wed Mar 14 10:00:40 2012
From: noorcs22 at gmail.com (Mustafa646)
Date: Wed, 14 Mar 2012 10:00:40 -0700 (PDT)
Subject: [Proj] Custom projection in GeoWebCache
Message-ID: <1331744440582-4579003.post@n6.nabble.com>

i have defined a custom projection (EPSG 3008) in geowebcache and assign a
WMS layer (third party image tile world imagery) to this projection which is
coming from WMS server (Geoserver). In geoserver, that layer is defined in
EPSG 4326 projection. when i will render the map (third party imagery) from
geowebcache in web application, then in which projection, the layer will be
shown, in EPSG 4326 or EPSG 3008?
 
Is geowebcache will change the projection from EPSG 4326 to EPSG 3008 ? or
something else will happen? 

--
View this message in context: http://osgeo-org.1560.n6.nabble.com/Custom-projection-in-GeoWebCache-tp4579003p4579003.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From mauceri at actgate.com  Wed Mar 14 10:32:21 2012
From: mauceri at actgate.com (Calogero Mauceri)
Date: Wed, 14 Mar 2012 18:32:21 +0100
Subject: [Proj] Problems with /Op option used to compile proj in Microsoft
 Visual Studio
Message-ID: <4F60D625.2040008@actgate.com>

I've been struggling since a few days to understand a very odd behavior 
with proj.
I have 2 versions of proj libraries and utils, one compiled with 
Microsoft Visual C++ 2008 (Express Edition) and another one compiled 
with Microsoft Visual C++ 2003.

Analyzing some strange results in our processes, I found out that 
executing some transformations using the two proj libraries return two 
(very) different results.
Here is an example of a transformation that is giving me problems using 
the cs2cs utility.

cs2cs -f "%.5f" +proj=tpeqd +a=2440e3 +b=2440e3 +lat_1=-22.960070000 
+lon_1=65.546300000 +lat_2=-22.959730000 +lon_2=65.546160000 +no_defs 
+to +proj=longlat +a=2440e3 +b=2440e3 +lon_0=0 +no_defs
-2385.33232 0.00000

On the cs2cs compiled with Microsoft Visual C++ 2008 that transformation 
returns a meaningful result
65.56780        -23.01227 0.00000
while in the version compiled with Microsoft Visual C++ 2003, it returns
*       * 0.00000

The same result happens with other (few) sets of coordinates.
Looking at the error returned in the latter case, the pj_transform exits 
with error
-19: acos/asin: |arg| >1.+1e-14

The error happens in the aacos function: in the first case 
0.999999999999996 is passed to the function while in the other case the 
number passed to the aacos is 1.000000000000012.

Now, looking (by chance) at the compilation options of the proj, I 
noticed that between the options passed to the cl compiler there is the 
consistency floating point option " /Op". As stated in the "Microsoft 
Visual Floating-Point Optimization" 
http://msdn.microsoft.com/en-us/library/aa289157(v=vs.71).aspx 
<http://msdn.microsoft.com/en-us/library/aa289157%28v=vs.71%29.aspx>

"The consistency model can seriously reduce efficiency while 
simultaneously providing no guarantee of increased accuracy. To serious 
numerical programmers, this doesn't seem like a very good tradeoff and 
is the primary reason that the model is not generally well received."

Disabling that option, the result returned in the version of proj 
compiled with Microsoft Visual C++ 2003 is more consistent.
Is there any reason why the /Op option is used to compile the proj?

Regards,
     Calogero

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120314/764ebca4/attachment.html>

From support.mn at elisanet.fi  Wed Mar 14 23:22:53 2012
From: support.mn at elisanet.fi (support.mn at elisanet.fi)
Date: Thu, 15 Mar 2012 08:22:53 +0200 (EET)
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
Message-ID: <15386475.2013951331792573961.JavaMail.support.mn@elisanet.fi>

Hello,

Calogero Mauceri [mauceri at actgate.com] kirjoitti: 

> Disabling that option, the result returned in the version of proj 
> compiled with Microsoft Visual C++ 2003 is more consistent.
> Is there any reason why the /Op option is used to compile the proj?
> 

I think that the /Op option only works with the 2003 version and what it does is as follows
(text from MSDN):


"This option improves the consistency of floating-point tests for equality and inequality by disabling optimizations that could change the precision of floating-point calculations.

By default, the compiler uses the coprocessor's 80-bit registers to hold the intermediate results of floating-point calculations. This increases program speed and decreases program size. However, because the calculation involves floating-point data types that are represented in memory by less than 80 bits, carrying the extra bits of precision (80 bits minus the number of bits in a smaller floating-point type) through a lengthy calculation can produce inconsistent results."

http://msdn.microsoft.com/en-us/library/aa984742(v=vs.71).aspx


So it is rather obvious that MS compilers use the full 80 bit FPP registers in PC processors by default and in most cases and the reason for using that switch in the first place must be the idea to have similar performance with other ANSI compiler environments? I am not sure if this answered the question?

regards: Janne.





From mauceri at actgate.com  Thu Mar 15 01:05:35 2012
From: mauceri at actgate.com (Calogero Mauceri)
Date: Thu, 15 Mar 2012 09:05:35 +0100
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <15386475.2013951331792573961.JavaMail.support.mn@elisanet.fi>
References: <15386475.2013951331792573961.JavaMail.support.mn@elisanet.fi>
Message-ID: <4F61A2CF.4070705@actgate.com>

Hi Janne,

>> Disabling that option, the result returned in the version of proj
>> compiled with Microsoft Visual C++ 2003 is more consistent.
>> Is there any reason why the /Op option is used to compile the proj?
>>
> I think that the /Op option only works with the 2003 version and what it does is as follows
> (text from MSDN):
>
>
> "This option improves the consistency of floating-point tests for equality and inequality by disabling optimizations that could change the precision of floating-point calculations.
>
> By default, the compiler uses the coprocessor's 80-bit registers to hold the intermediate results of floating-point calculations. This increases program speed and decreases program size. However, because the calculation involves floating-point data types that are represented in memory by less than 80 bits, carrying the extra bits of precision (80 bits minus the number of bits in a smaller floating-point type) through a lengthy calculation can produce inconsistent results."
>
> http://msdn.microsoft.com/en-us/library/aa984742(v=vs.71).aspx
>
>
> So it is rather obvious that MS compilers use the full 80 bit FPP registers in PC processors by default and in most cases and the reason for using that switch in the first place must be the idea to have similar performance with other ANSI compiler environments? I am not sure if this answered the question?
>
> regards: Janne.
>

Ok, the /Op option seems to be used to produce consistent and repeatable 
results.
The problem is that the cost of tha//t repeatability is that the 
intermidiate results in computations *lose accuracy*.
That explains the problem proj (compiled with Visual Studio 2003) is 
having in the conversion I stated before.


It is well explained here (text from MSDN)

http://msdn.microsoft.com/en-us/library/aa289157%28v=vs.71%29.aspx

"Many C++ compilers offer a "consistency" floating-point model, (through 
a /Op or /fltconsistency switch) which enables a developer to create 
programs compliant with strict floating-point semantics. When engaged, 
this model prevents the compiler from using most optimizations on 
floating-point computations [...]. The consistency model, however, has a 
dark-side. In order to return predictable results on different FPU 
architectures, nearly all implementations of /Op round intermediate 
expressions to the user specified precision; for example, consider the 
following expression:

float a, b, c, d, e;
. . .
a = b*c + d*e;

In order to produce consistent and repeatable results under /Op, this expression gets evaluated as if it were implemented as follows:


float x = b*c;
float y = d*e;
a = x+y;

The final result now suffers from single-precision rounding errors  /at each step in evaluating the expression/. Although this interpretation doesn't strictly break any C++ semantics rules, it's almost never the best way to evaluate floating-point expressions. It is generally more desirable to/  compute the intermediate results in as high as precision as is practical/. For instance, it would be better to compute the expression a=b*c+d*e in a higher precision as in,

double x = b*c;
double y = d*e;
double z = x+y;
a = (float)z;


or better yet

long double x = b*c;
long double y = d*e
long double z = x+y;
a = (float)z;


When computing the intermediate results in a higher precision, the final 
result is *significantly more accurate*. Ironically, by adopting a 
consistency model, the likelihood of error is increased precisely when 
the user is trying to reduce error by disabling unsafe optimizations. 
Thus the consistency model can seriously reduce efficiency while 
simultaneously providing no guarantee of increased accuracy. To serious 
numerical programmers, this doesn't seem like a very good tradeoff and 
is the primary reason that the model is not generally well received.
"

 From Visual C++ 2005 they are suggesting to use other kind of options 
fp:precise, fp:fast or fp:strict.

"Under*fp:precise*, only safe optimizations are performed on 
floating-point code and, unlike /Op, intermediate computations are 
consistently performed at the highest/practical/precision."

Calogero
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120315/7e013000/attachment.html>

From Mikael.Rittri at carmenta.com  Thu Mar 15 02:59:34 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Thu, 15 Mar 2012 09:59:34 +0000
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F61A2CF.4070705@actgate.com>
References: <15386475.2013951331792573961.JavaMail.support.mn@elisanet.fi>
	<4F61A2CF.4070705@actgate.com>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49390EDFFF@SETHNWS023.carmenta.se>

Here is an interesting article:

David Monniaux.
The pitfalls of verifying floating-point computations.
ACM Transactions on Programming Languages and Systems 30, 3 (2008) 12.
http://hal.archives-ouvertes.fr/hal-00128124

Best regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

________________________________
From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Calogero Mauceri
Sent: Thursday, March 15, 2012 9:06 AM
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] Problems with /Op option used to compile proj in Microsoft Visual Studio

Hi Janne,



Disabling that option, the result returned in the version of proj

compiled with Microsoft Visual C++ 2003 is more consistent.

Is there any reason why the /Op option is used to compile the proj?





I think that the /Op option only works with the 2003 version and what it does is as follows

(text from MSDN):





"This option improves the consistency of floating-point tests for equality and inequality by disabling optimizations that could change the precision of floating-point calculations.



By default, the compiler uses the coprocessor's 80-bit registers to hold the intermediate results of floating-point calculations. This increases program speed and decreases program size. However, because the calculation involves floating-point data types that are represented in memory by less than 80 bits, carrying the extra bits of precision (80 bits minus the number of bits in a smaller floating-point type) through a lengthy calculation can produce inconsistent results."



http://msdn.microsoft.com/en-us/library/aa984742(v=vs.71).aspx





So it is rather obvious that MS compilers use the full 80 bit FPP registers in PC processors by default and in most cases and the reason for using that switch in the first place must be the idea to have similar performance with other ANSI compiler environments? I am not sure if this answered the question?



regards: Janne.



Ok, the /Op option seems to be used to produce consistent and repeatable results.
The problem is that the cost of that repeatability is that the intermidiate results in computations *lose accuracy*.
That explains the problem proj (compiled with Visual Studio 2003) is having in the conversion I stated before.


It is well explained here (text from MSDN)

http://msdn.microsoft.com/en-us/library/aa289157%28v=vs.71%29.aspx

"Many C++ compilers offer a "consistency" floating-point model, (through a /Op or /fltconsistency switch) which enables a developer to create programs compliant with strict floating-point semantics. When engaged, this model prevents the compiler from using most optimizations on floating-point computations [...]. The consistency model, however, has a dark-side. In order to return predictable results on different FPU architectures, nearly all implementations of /Op round intermediate expressions to the user specified precision; for example, consider the following expression:



float a, b, c, d, e;

. . .

a = b*c + d*e;



In order to produce consistent and repeatable results under /Op, this expression gets evaluated as if it were implemented as follows:



float x = b*c;

float y = d*e;

a = x+y;



The final result now suffers from single-precision rounding errors at each step in evaluating the expression. Although this interpretation doesn't strictly break any C++ semantics rules, it's almost never the best way to evaluate floating-point expressions. It is generally more desirable to compute the intermediate results in as high a s precis ion as is practical. For instance, it would be better to compute the expression a=b*c+d*e in a higher precision as in,

double x = b*c;

double y = d*e;

double z = x+y;

a = (float)z;

or better yet



long double x = b*c;

long double y = d*e

long double z = x+y;

a = (float)z;


When computing the intermediate results in a higher precision, the final result is *significantly more accurate*. Ironically, by adopting a consistency model, the likelihood of error is increased precisely when the user is trying to reduce error by disabling unsafe optimizations. Thus the consistency model can seriously reduce efficiency while simultaneously providing no guarantee of increased accuracy. To serious numerical programmers, this doesn't seem like a very good tradeoff and is the primary reason that the model is not generally well received.
"

>From Visual C++ 2005 they are suggesting to use other kind of options fp:precise, fp:fast or fp:strict.

"Under fp:precise, only safe optimizations are performed on floating-point code and, unlike /Op, intermediate computations are consistently performed at the highest practical precision."

Calogero
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120315/eb53f35b/attachment.html>

From glynn at gclements.plus.com  Thu Mar 15 06:53:53 2012
From: glynn at gclements.plus.com (Glynn Clements)
Date: Thu, 15 Mar 2012 13:53:53 +0000
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F60D625.2040008@actgate.com>
References: <4F60D625.2040008@actgate.com>
Message-ID: <20321.62577.832643.959284@cerise.gclements.plus.com>


Calogero Mauceri wrote:

> The same result happens with other (few) sets of coordinates.
> Looking at the error returned in the latter case, the pj_transform exits 
> with error
> -19: acos/asin: |arg| >1.+1e-14
> 
> The error happens in the aacos function: in the first case 
> 0.999999999999996 is passed to the function while in the other case the 
> number passed to the aacos is 1.000000000000012.

Calculating the arcsine or arccosine of a value very close to 1 is
bound to be numerically unstable.

Discussion of compiler optimisations is something of a red herring
here. If the calculation is relying upon the 80-bit extended
floating-point support in the x87 FPU, it won't work on architectures
which "only" use 64 bits. Similarly, just about any change to the way
that the compiler generates code may produce a different result, as
may changes to the FPU state or the system's math library.

Ultimately, I suspect that the calculation for the two-point
equidistant projection just wasn't designed for the case where the two
points are around one arc-second apart (approx. 15 metres; would be
approx. 40 metres on Earth).

-- 
Glynn Clements <glynn at gclements.plus.com>


From mauceri at actgate.com  Thu Mar 15 08:09:02 2012
From: mauceri at actgate.com (Calogero Mauceri)
Date: Thu, 15 Mar 2012 16:09:02 +0100
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <20321.62577.832643.959284@cerise.gclements.plus.com>
References: <4F60D625.2040008@actgate.com>
	<20321.62577.832643.959284@cerise.gclements.plus.com>
Message-ID: <4F62060E.50209@actgate.com>

Glynn Clements wrote:
> Ultimately, I suspect that the calculation for the two-point
> equidistant projection just wasn't designed for the case where the two
> points are around one arc-second apart (approx. 15 metres; would be
> approx. 40 metres on Earth).

Glynn, so you are suggesting that more than in the float number 
approximations, the problem is in why the number passed to the aacos is 
so close to 1.
Well, then my question is, which are the cases where the two point 
equidistant projection could not behave well? Is it a problem of the two 
point equidistant definition or a problem of the way it is implemented 
in proj lib?

I can provide a long set of cases where the conversion from tpeqd to 
longlat fails, I just need a bit of time to run some data processing.

Thanks,
     Calogero




From warmerdam at pobox.com  Thu Mar 15 11:01:04 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 15 Mar 2012 11:01:04 -0700
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F62060E.50209@actgate.com>
References: <4F60D625.2040008@actgate.com>
	<20321.62577.832643.959284@cerise.gclements.plus.com>
	<4F62060E.50209@actgate.com>
Message-ID: <CA+YzLBfDENbZDKG9kQMKeiL9B=WnHCXwBf_TxxuK0srU2gBFbA@mail.gmail.com>

On Thu, Mar 15, 2012 at 8:09 AM, Calogero Mauceri <mauceri at actgate.com> wrote:
> Well, then my question is, which are the cases where the two point
> equidistant projection could not behave well? Is it a problem of the two
> point equidistant definition or a problem of the way it is implemented
> in proj lib?

Calogero,

I don't claim to understand the tpeqd projection well, but your parameters:

 +lat_1=-22.960070000 +lon_1=65.546300000
 +lat_2=-22.959730000 +lon_2=65.546160000

seem suspect to me in that they are so close.  Do you find similar
stability issues when the two points used are not so very close
together?

My must admit, I'm not sure why /Op is used and I suspect it is not
really all that appropriate as a default for PROJ.4.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From strebe at aol.com  Thu Mar 15 12:56:48 2012
From: strebe at aol.com (strebe at aol.com)
Date: Thu, 15 Mar 2012 15:56:48 -0400 (EDT)
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F62060E.50209@actgate.com>
References: <4F60D625.2040008@actgate.com><20321.62577.832643.959284@cerise.gclements.plus.com>
	<4F62060E.50209@actgate.com>
Message-ID: <8CED0FCE4641FE1-189C-247F9@webmail-d087.sysops.aol.com>


 

Well, then my question is, which are the cases where the two point equidistant projection could not behave well? Is it a problem of the two point equidistant definition or a problem of the way it is implemented in proj lib?


The problem is in implementation. These cases are properly dealt with by reformulating and series expansion. The question is whether it’s worth the bother.

Regards,
— daan Strebe

 

 

-----Original Message-----
From: Calogero Mauceri <mauceri at actgate.com>
To: proj <proj at lists.maptools.org>
Sent: Thu, Mar 15, 2012 8:14 am
Subject: Re: [Proj] Problems with /Op option used to compile proj in Microsoft Visual Studio


Glynn Clements wrote:
> Ultimately, I suspect that the calculation for the two-point
> equidistant projection just wasn't designed for the case where the two
> points are around one arc-second apart (approx. 15 metres; would be
> approx. 40 metres on Earth).

Glynn, so you are suggesting that more than in the float number 
approximations, the problem is in why the number passed to the aacos is 
so close to 1.
Well, then my question is, which are the cases where the two point 
equidistant projection could not behave well? Is it a problem of the two 
point equidistant definition or a problem of the way it is implemented 
in proj lib?

I can provide a long set of cases where the conversion from tpeqd to 
longlat fails, I just need a bit of time to run some data processing.

Thanks,
     Calogero


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120315/d8a9fa42/attachment.html>

From glynn at gclements.plus.com  Thu Mar 15 21:59:10 2012
From: glynn at gclements.plus.com (Glynn Clements)
Date: Fri, 16 Mar 2012 04:59:10 +0000
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F62060E.50209@actgate.com>
References: <4F60D625.2040008@actgate.com>
	<20321.62577.832643.959284@cerise.gclements.plus.com>
	<4F62060E.50209@actgate.com>
Message-ID: <20322.51358.3978.827395@cerise.gclements.plus.com>


Calogero Mauceri wrote:

> > Ultimately, I suspect that the calculation for the two-point
> > equidistant projection just wasn't designed for the case where the two
> > points are around one arc-second apart (approx. 15 metres; would be
> > approx. 40 metres on Earth).
> 
> Glynn, so you are suggesting that more than in the float number 
> approximations, the problem is in why the number passed to the aacos is 
> so close to 1.
> Well, then my question is, which are the cases where the two point 
> equidistant projection could not behave well? Is it a problem of the two 
> point equidistant definition or a problem of the way it is implemented 
> in proj lib?

It's presumably possible to reformulate the calculation to be more
numerically stable, the question is whether it's worthwhile. AFAICT,
the projection seems to be more common at larger scales.

>From the information you provided, I'm assuming that it's failing at
either:

	lp.phi = aacos(hypot(P->thz0 * s, d) * P->rhshz0);
or:
	P->z02 = aacos(P->sp1 * P->sp2 + P->cp1 * P->cp2 * cos(P->dlam2));

Looking at how those parameters are derived:

	P->dlam2 = adjlon(lam_2 - lam_1);

	P->cp1 = cos(phi_1);
	P->cp2 = cos(phi_2);
	P->sp1 = sin(phi_1);
	P->sp2 = sin(phi_2);

	P->z02 = aacos(P->sp1 * P->sp2 + P->cp1 * P->cp2 * cos(P->dlam2));
	P->hz0 = .5 * P->z02;

	P->thz0 = tan(P->hz0);
	P->rhshz0 = .5 / sin(P->hz0);

	cz1 = cos(hypot(xy.y, xy.x + P->hz0));
	cz2 = cos(hypot(xy.y, xy.x - P->hz0));
	s = cz1 + cz2;
	d = cz1 - cz2;

When lam_1 ~= lam_2 and phi_1 ~= phi_2, then:

	P->dlam2 ~=0
	P->cp1 ~= P->cp2
	P->sp1 ~= P->sp2
	P->sp1 * P->sp2 + P->cp1 * P->cp2 * cos(P->dlam2) ~= sin²(phi) + cos²(phi) ~= 1
	cos(P->dlam2) ~= cos(0) ~= 1
	P->z02 ~= aacos(1) ~= 0

So the calculation of P->z02 is likely to be numerically unstable.

Also: cz1 ~= cz2, so d will have poor relative accuracy.

IOW, the formulation used is going to be unstable when the angle
between the reference points is small.

More generally, any arccosine calculation should be seen as a warning
sign regarding numerical stability, as the derivative approaches
infinity as the result approaches zero, meaning that you get the
greatest error magnification at the point where you can least afford
it.

-- 
Glynn Clements <glynn at gclements.plus.com>


From gdt at ir.bbn.com  Fri Mar 16 08:06:43 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 16 Mar 2012 11:06:43 -0400
Subject: [Proj] PROJ 4.8.0 Released
In-Reply-To: <CA+YzLBfvU0LONOWmBhHvay6BPDHkg1MpgcJCfALz47pnYA5YrQ@mail.gmail.com>
	(Frank Warmerdam's message of "Tue, 13 Mar 2012 16:25:26 -0700")
References: <CA+YzLBfvU0LONOWmBhHvay6BPDHkg1MpgcJCfALz47pnYA5YrQ@mail.gmail.com>
Message-ID: <rmisjh8egak.fsf@fnord.ir.bbn.com>


  I am pleased to announce the release of PROJ 4.8.0.

I have:

  updated the proj entry in pkgsrc to 4.8.0 (and proj-datumgrid-1.5).

  verified that proj's regression tests pass (on NetBSD/i386 5.1ish)

  verified that postgis 1.5.3's regression tests pass with proj 4.8.0

  verified that postgis trunk's regression tests (including raster and
  topology) pass with proj 4.8.0

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120316/fbde38b5/attachment.sig>

From mauceri at actgate.com  Tue Mar 20 10:09:13 2012
From: mauceri at actgate.com (Calogero Mauceri)
Date: Tue, 20 Mar 2012 18:09:13 +0100
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <20322.51358.3978.827395@cerise.gclements.plus.com>
References: <4F60D625.2040008@actgate.com>
	<20321.62577.832643.959284@cerise.gclements.plus.com>
	<4F62060E.50209@actgate.com>
	<20322.51358.3978.827395@cerise.gclements.plus.com>
Message-ID: <4F68B9B9.8080604@actgate.com>

Sorry for replying so late, but I've been quite busy lately.

Frank Warmerdam wrote:
> I don't claim to understand the tpeqd projection well, but your parameters:
>
>   +lat_1=-22.960070000 +lon_1=65.546300000
>   +lat_2=-22.959730000 +lon_2=65.546160000
>
> seem suspect to me in that they are so close.  Do you find similar
> stability issues when the two points used are not so very close
> together?

Unfortunately we are mostly using the tpeqd projection with the two 
points very close. We need minimal distortion between the reference points.


Glynn Clements wrote:
> IOW, the formulation used is going to be unstable when the angle
> between the reference points is small.

Glynn, thank you very much for your explanation. So the smaller is the 
distance between the two points of the tpeqd, then the less accurate are 
the conversions. Those are really bad news :(.


Calogero


From charles.karney at sri.com  Tue Mar 20 14:32:48 2012
From: charles.karney at sri.com (Charles Karney)
Date: Tue, 20 Mar 2012 17:32:48 -0400
Subject: [Proj] Problems with /Op option used to compile proj in
 Microsoft Visual Studio
In-Reply-To: <4F68B9B9.8080604@actgate.com>
References: <4F60D625.2040008@actgate.com>
	<20321.62577.832643.959284@cerise.gclements.plus.com>
	<4F62060E.50209@actgate.com>
	<20322.51358.3978.827395@cerise.gclements.plus.com>
	<4F68B9B9.8080604@actgate.com>
Message-ID: <4F68F780.1000803@sri.com>

On 03/20/12 13:09, Calogero Mauceri wrote:
> Glynn, thank you very much for your explanation. So the smaller is the
> distance between the two points of the tpeqd, then the less accurate are
> the conversions. Those are really bad news:(.

In the limit where the distance between the two central points AB
vanishes tpeqd degenerates to the azimuthal equidistant projection (the
spherical variety because tpeqd is only implemented for a sphere).  So
if you're projecting a point C and CA >> AB and CB >> AB, you might get
more accurate results using aeqd.

   --Charles


From mabrand at mabrand.nl  Mon Mar 26 01:05:36 2012
From: mabrand at mabrand.nl (Mark Brand)
Date: Mon, 26 Mar 2012 10:05:36 +0200
Subject: [Proj] [patch] add missing projects.h
Message-ID: <4F702350.1060107@mabrand.nl>


Hi,

This patch applies to
http://trac.osgeo.org/proj/changeset/2198
and adds another missing file.

regards,

Mark
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0002-add-missing-projects.h.patch
Type: text/x-patch
Size: 729 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20120326/42973b46/attachment.bin>

From gdt at ir.bbn.com  Mon Mar 26 03:18:42 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Mon, 26 Mar 2012 06:18:42 -0400
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <4F702350.1060107@mabrand.nl> (Mark Brand's message of "Mon, 26
	Mar 2012 10:05:36 +0200")
References: <4F702350.1060107@mabrand.nl>
Message-ID: <rmimx73d5rx.fsf@fnord.ir.bbn.com>


I had the impression that not installing projects.h was a conscious
choice in 4.8.0.   So perhaps it belongs in noinst_include_HEADERS, but
your patch seems to revert the planned withdrawal, as noted in NEWS.


From mateusz at loskot.net  Mon Mar 26 03:35:42 2012
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 26 Mar 2012 11:35:42 +0100
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <rmimx73d5rx.fsf@fnord.ir.bbn.com>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
Message-ID: <CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>

On 26 March 2012 11:18, Greg Troxel <gdt at ir.bbn.com> wrote:
>
> I had the impression that not installing projects.h was a conscious
> choice in 4.8.0.   So perhaps it belongs in noinst_include_HEADERS, but
> your patch seems to revert the planned withdrawal, as noted in NEWS.

Indeed, projects.h is a private header, not part of public API.
Why and where does this decision come from?

http://trac.osgeo.org/proj/ticket/98
http://trac.osgeo.org/osgeo4w/ticket/34
http://trac.osgeo.org/postgis/ticket/126

Thus, the patch should not be applied.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net


From martin.desruisseaux at geomatys.fr  Mon Mar 26 03:54:08 2012
From: martin.desruisseaux at geomatys.fr (Martin Desruisseaux)
Date: Mon, 26 Mar 2012 12:54:08 +0200
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
	<CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
Message-ID: <4F704AD0.9030903@geomatys.fr>

"projects.h" was wrongly included by "jniproj.c", because I didn't knew it was a 
private file. I will replace the include by "proj_api.h" and test the build.


Le 26/03/12 12:35, Mateusz Loskot a écrit :
> On 26 March 2012 11:18, Greg Troxel<gdt at ir.bbn.com>  wrote:
>> I had the impression that not installing projects.h was a conscious
>> choice in 4.8.0.   So perhaps it belongs in noinst_include_HEADERS, but
>> your patch seems to revert the planned withdrawal, as noted in NEWS.
> Indeed, projects.h is a private header, not part of public API.
> Why and where does this decision come from?
>
> http://trac.osgeo.org/proj/ticket/98
> http://trac.osgeo.org/osgeo4w/ticket/34
> http://trac.osgeo.org/postgis/ticket/126
>
> Thus, the patch should not be applied.
>
> Best regards,



From Heiko.Klein at met.no  Mon Mar 26 04:10:57 2012
From: Heiko.Klein at met.no (Heiko Klein)
Date: Mon, 26 Mar 2012 13:10:57 +0200
Subject: [Proj] How to access projection-factors in 4.8 (without projects.h)?
Message-ID: <4F704EC1.6080502@met.no>

Hi,

I just read that the projects.h header is no longer available (publicly).

Currently, I use projects.h to calculate the factors.k from the 
polar-stereographic projection. Polar-stereographic projections can be 
defined by 'lat_ts' or by 'k', and up to 4.7, I was able to access those 
easily, e.g. when translating from a proj-projection to a projection in 
FGDC:

att["scale_factor_at_projection_origin"] = factors.k;


This functionality is available in 'proj -V' (which still requires 
projects.h) but not in the public API proj_api.h

I think, as long as the commmand-line interface still requires 
'projects.h', not all necessary functionality is included in proj_api.h

Best regards,

Heiko


From martin.desruisseaux at geomatys.fr  Mon Mar 26 04:24:10 2012
From: martin.desruisseaux at geomatys.fr (Martin Desruisseaux)
Date: Mon, 26 Mar 2012 13:24:10 +0200
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <4F704AD0.9030903@geomatys.fr>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
	<CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
	<4F704AD0.9030903@geomatys.fr>
Message-ID: <4F7051DA.3010109@geomatys.fr>

Le 26/03/12 12:54, Martin Desruisseaux a écrit :
> "projects.h" was wrongly included by "jniproj.c", because I didn't knew it was a
> private file. I will replace the include by "proj_api.h" and test the build.

Sorry for the confusion. I though that the error report was about the building 
Proj.4 from the sources. I noticed that the source files from 
"http://download.osgeo.org/proj/proj-4.8.0.zip" contain "projects.h", so my 
above comment doesn't apply.

As a side note, I noticed that some source files use #include <projects.h> while 
some other files (namely cs2cs.c, gen_cheb.c, geod.c, geod_for.c, geod_inv.c, 
geod_set.c, jniproj.c, p_series.c, pj_deriv.c, pj_ellps.c, pj_list.c, 
pj_strerrno.c, proj.c) use #include "projects.h". Is there a policy about which 
form should be used?

     Martin



From molnar at sas.elte.hu  Mon Mar 26 04:49:29 2012
From: molnar at sas.elte.hu (molnar at sas.elte.hu)
Date: Mon, 26 Mar 2012 13:49:29 +0200
Subject: [Proj] Dear Professor Rosenmund and Brigadier Hotine :-)
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
	<BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
Message-ID: <1674e4fdafaafc99ce43e7c48d36318e.squirrel@sas.elte.hu>

Dear list members,
I am looking for digital version of these publications:

Max Rosenmund: Die Aenderung des Projektionssystems der schweizerischen
Landesvermessung (Projektionssystem der schweizerischen Landesvermessung).
Verlag der Abteilung für Landestopographie, Bern, 1903.

Hotine Martin: The Orthomorphic Projection of the Spheroid. Empire Survey
Review, Vol. 8 and 9, Nr. 62-66, 1946-47.

If anybody has a scanned copy of these publications I kindly ask him or
her to reply on this email on mailing list to avoid multiple unnecessary
effort and ask him or her to send it to me in a private email.

Thanks in advance,
Gabor Molnar
molnar(at)sas.elte.hu


From gdt at ir.bbn.com  Mon Mar 26 05:01:34 2012
From: gdt at ir.bbn.com (Greg Troxel)
Date: Mon, 26 Mar 2012 08:01:34 -0400
Subject: [Proj] How to access projection-factors in 4.8 (without
	projects.h)?
In-Reply-To: <4F704EC1.6080502@met.no> (Heiko Klein's message of "Mon, 26 Mar
	2012 13:10:57 +0200")
References: <4F704EC1.6080502@met.no>
Message-ID: <rmir4wfa7vl.fsf@fnord.ir.bbn.com>


Heiko Klein <Heiko.Klein at met.no> writes:

> Hi,
>
> I just read that the projects.h header is no longer available (publicly).
>
> Currently, I use projects.h to calculate the factors.k from the 
> polar-stereographic projection. Polar-stereographic projections can be 
> defined by 'lat_ts' or by 'k', and up to 4.7, I was able to access those 
> easily, e.g. when translating from a proj-projection to a projection in 
> FGDC:
>
> att["scale_factor_at_projection_origin"] = factors.k;
>
>
> This functionality is available in 'proj -V' (which still requires 
> projects.h) but not in the public API proj_api.h
>
> I think, as long as the commmand-line interface still requires 
> 'projects.h', not all necessary functionality is included in proj_api.h

If projects.h really is going to be a private header, it would seem to
be a bug that the command-line program proj uses it.  It's not strictly
a bug, but it should be possible write programs like proj with only the
public headers/library, so it's a clue.


From sisyphus1 at optusnet.com.au  Mon Mar 26 17:01:17 2012
From: sisyphus1 at optusnet.com.au (Sisyphus)
Date: Tue, 27 Mar 2012 11:01:17 +1100
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
	<CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
Message-ID: <5C152703F0044DA0A38F456652726494@desktop2>


----- Original Message ----- 
From: "Mateusz Loskot" <mateusz at loskot.net>
To: "PROJ.4 and general Projections Discussions" <proj at lists.maptools.org>
Cc: "Mark Brand" <mabrand at mabrand.nl>
Sent: Monday, March 26, 2012 9:35 PM
Subject: Re: [Proj] [patch] add missing projects.h


> On 26 March 2012 11:18, Greg Troxel <gdt at ir.bbn.com> wrote:
>>
>> I had the impression that not installing projects.h was a conscious
>> choice in 4.8.0. So perhaps it belongs in noinst_include_HEADERS, but
>> your patch seems to revert the planned withdrawal, as noted in NEWS.
>
> Indeed, projects.h is a private header, not part of public API.

Oh ... so I guess our programs should no longer begin with:

#include <projects.h>

But if we delete that inclusion, will the programs still build ok against 
4.7.0 and earlier ?

I recently updated from 4.7.0 to 4.8.0 and found a program (that began by 
including projects.h) no longer built - the build failed with an error about 
the unknown projCtx_t type. The projCtx_t type is defined in the 4.8.0 
projects.h, but not the 4.7.0 projects.h (which was the projects.h that got 
loaded).
Naturally, I fixed the error by replacing that 4.7.0 projects.h with a copy 
of the projects.h from the 4.8.0 source :-))
(I did wonder why 'make install' had not done that for me .... )

This particular program will likely be built in various places by various 
people using different versions of the proj library, so the code needs to be 
portable.

Cheers,
Rob 



From warmerdam at pobox.com  Mon Mar 26 17:29:53 2012
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 26 Mar 2012 17:29:53 -0700
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <5C152703F0044DA0A38F456652726494@desktop2>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
	<CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
	<5C152703F0044DA0A38F456652726494@desktop2>
Message-ID: <CA+YzLBfh2LoH8t6U2_4YoVD5PkB_7dz7k-jrRwKrhJfQOWfNBQ@mail.gmail.com>

On Mon, Mar 26, 2012 at 5:01 PM, Sisyphus <sisyphus1 at optusnet.com.au> wrote:
>> Indeed, projects.h is a private header, not part of public API.
>
> Oh ... so I guess our programs should no longer begin with:
>
> #include <projects.h>

Rob,

Right, for several versions proj_api.h has been preferred to use
of projects.h.

> But if we delete that inclusion, will the programs still build ok against
> 4.7.0 and earlier ?

The proj_api.h has existed for several versions; however, if you go
back far enough there would be problems.  Checking back I see it
was introduced 11 years ago.  I'm not exactly sure what version that
would be but surely it is long enough for the deprecation of projects.h
to finally result in it being removed from public installs.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


From sisyphus1 at optusnet.com.au  Mon Mar 26 18:23:20 2012
From: sisyphus1 at optusnet.com.au (Sisyphus)
Date: Tue, 27 Mar 2012 12:23:20 +1100
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <CA+YzLBfh2LoH8t6U2_4YoVD5PkB_7dz7k-jrRwKrhJfQOWfNBQ@mail.gmail.com>
References: <4F702350.1060107@mabrand.nl>
	<rmimx73d5rx.fsf@fnord.ir.bbn.com><CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com><5C152703F0044DA0A38F456652726494@desktop2>
	<CA+YzLBfh2LoH8t6U2_4YoVD5PkB_7dz7k-jrRwKrhJfQOWfNBQ@mail.gmail.com>
Message-ID: <1B5AF08CB6E34C058C813EDF3B45A745@desktop2>


----- Original Message ----- 
From: "Frank Warmerdam"

> The proj_api.h has existed for several versions; however, if you go
> back far enough there would be problems.  Checking back I see it
> was introduced 11 years ago.  I'm not exactly sure what version that
> would be but surely it is long enough for the deprecation of projects.h
> to finally result in it being removed from public installs.

The code I'm looking at begins:

#include "projects.h"
#include "proj_api.h"

so it's obviously intended to work only with those versions of the proj 
library that contain proj_api.h.

I gather that projects.h became deprecated when proj_api.h was added, and 
that including *both* files should *never* have been necessary.

That being so, the removal of projects.h from that code is clearly the right 
thing to do - something that could have been done long ago.

(Btw, the code I'm referring to is part of the source of perl's PDL module - 
specifically PDL::GIS::Proj4.)

Thanks, Frank.

Cheers,
Rob



From Heiko.Klein at met.no  Wed Mar 28 01:54:20 2012
From: Heiko.Klein at met.no (Heiko Klein)
Date: Wed, 28 Mar 2012 10:54:20 +0200
Subject: [Proj] [patch] add missing projects.h
In-Reply-To: <CA+YzLBfh2LoH8t6U2_4YoVD5PkB_7dz7k-jrRwKrhJfQOWfNBQ@mail.gmail.com>
References: <4F702350.1060107@mabrand.nl> <rmimx73d5rx.fsf@fnord.ir.bbn.com>
	<CABUeae-gwVdZCLtGAa0ZjHvmvwQAg_9b5VpLf-f3p8OsYRLuCQ@mail.gmail.com>
	<5C152703F0044DA0A38F456652726494@desktop2>
	<CA+YzLBfh2LoH8t6U2_4YoVD5PkB_7dz7k-jrRwKrhJfQOWfNBQ@mail.gmail.com>
Message-ID: <4F72D1BC.406@met.no>

Hi Frank,

I agree that 11 years of deprecation are more than enough, but 
deprecation usually means that the functionality is available elsewhere. 
 From projects.h, e.g. pj_factors, is still not available through proj_api.h

What should I do with those functions which don't have an equivalent in 
proj_api.h?

Heiko

On 2012-03-27 02:29, Frank Warmerdam wrote:
>
> Right, for several versions proj_api.h has been preferred to use
> of projects.h.
>
> The proj_api.h has existed for several versions; however, if you go
> back far enough there would be problems.  Checking back I see it
> was introduced 11 years ago.  I'm not exactly sure what version that
> would be but surely it is long enough for the deprecation of projects.h
> to finally result in it being removed from public installs.
>


From roger at opq.se  Fri Mar 30 02:48:53 2012
From: roger at opq.se (Roger Oberholtzer)
Date: Fri, 30 Mar 2012 11:48:53 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <46F29A71.4000603@pobox.com>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de>  <46F29A71.4000603@pobox.com>
Message-ID: <1333100933.5866.50.camel@acme.pacific>

A while back, the following discussion took place here:


> On Thu, 2007-09-20 at 12:06 -0400, Frank Warmerdam wrote:
> Oliver Eichler wrote:
> >> I do have a coordinate in easting/northing [m] from a raster map  using
> >> Gauss Krüger projection and Potsdam datum. Now I would like to get the
> >> lon/lat coordinate on a WGS84 ellipsoid. And vice versa. I would like to
> >> use the proj4 C API not the command line.
> > 
> > Ok, further investigations condensed into something like:
> > 
> > pjgaukru = pj_init_plus("+init=epsg:31467");
> > pjwgs84 = pj_init_plus("+init=epsg:4326");
> > 
> > // easting / northing to lon / lat
> > pt = pj_inv(pt,pjgaukru)
> > 
> > //???
> > double z = 0;
> > 
> > pj_datum_transform(pjgaukru, pjwgs84, 1, 0, &pt.u, &pt.v, &z);
> > 
> > However the result is still several minutes away from the expected
> > coordinate. What do I miss?
> 
> Oliver,
> 
> How about:
> 
> pjgaukru = pj_init_plus("+init=epsg:31467");
> pjwgs84 = pj_init_plus("+init=epsg:4326");
> 
> //???
> double z = 0;
> 
> pj_datum_transform(pjgaukru, pjwgs84, 1, 0, &pt.u, &pt.v, &z);
> 
> Don't forget that the output is pt.u with the longitude in
> radians, and pt.v with the latitude in radians.  The call
> you make to pj_inv() is duplicating work that is done by
> pj_transform() (corrupting really).
> 
> I would add that epsg:31467 expands as:
> 
> +proj=tmerc +lat_0=0 +lon_0=9 +k=1.000000 +x_0=3500000 +y_0=0 +ellps=bessel 
> +datum=potsdam +units=m +no_defs
> 
> Note that this definition is using +datum=potsdam which expands to:
> 
>    +ellps=bessel +towgs84=606.0,23.0,413.0
> 
> This may or may not be the best datum shift parameters for your area of
> work.  You may need to research a better local shift.


I find myself needing the exact same thing. So, I thought I would
implement this in the C API, where I usually do these sorts of things. I
usually use pj_transform() instead of pj_datum_transform(). But as the
recipe uses pj_datum_transform(), I thought I would too.

The problem is that the values I get back from pj_datum_transform() are
infinite values (as expressed by printf). If I use pj_transform() the
locations are incorrect - they are located in central Asia.

I am testing with a sample set of coordinates provided later in the
quoted thread:

> it seems to work. A reference point of:
> 
> x = 4459750 m  y = 5448182 m
> 
> is converted to
> 
> E11.446588 N49.169494


If I use pj_transform(), I get:
 
  21.982946, 48.433278

So, perhaps pj_datum_transform() provides the correct calculation. But
as I get infinite values, I can't tell.

I am running proj 4.7.0 on Linux. It works for all other uses I have.

In addition to following the recipe, above I have also tried specifying
the values more directly as:

toProj = pj_init_plus(
                "+proj=tmerc "                  // Projection
                "+ellps=bessel "                // Spheroid
                "+k=1.0 "                       // Scale factor at central meridian
                "+x_0=3500000 "                 // False easting
                "+y_0=0 "                       // False northing
                "+lon_0=9.0 "                   // Longitude of central meridian
                "+lat_0=0.0 "                   // Latitude of origin
                "+towgs84=606.0,23.0,413.0 "    // Datum
                "+units=m "
                "+no_defs");

fromProj = pj_init_plus(
                "+proj=latlong "
                "+datum=WGS84");

double  le = 4459750, // easting,
        ln = 5448182, // northing,
        la = 0.0;     // altitude;

pj_transform(toProj,
             fromProj,
             1, 0,
             &le, &ln, &la)

LONG  = le / DEGREE_TO_RADIAN;
LAT   = ln / DEGREE_TO_RADIAN;
ALT   = la;


In the real code, all return values are checked, and there are no
errors.

My goal is to convert these values to/from WGS84 latitude and
longitudes.

Any useful suggestions are greatly appreciated.

TIA



Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From roger at opq.se  Fri Mar 30 03:23:03 2012
From: roger at opq.se (Roger Oberholtzer)
Date: Fri, 30 Mar 2012 12:23:03 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <1333100933.5866.50.camel@acme.pacific>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de>  <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
Message-ID: <1333102983.5866.65.camel@acme.pacific>

Bad form to reply to my own post, but...

> > I would add that epsg:31467 expands as:
> > 
> > +proj=tmerc +lat_0=0 +lon_0=9 +k=1.000000 +x_0=3500000 +y_0=0 +ellps=bessel 
> > +datum=potsdam +units=m +no_defs

> > it seems to work. A reference point of:
> > 
> > x = 4459750 m  y = 5448182 m
> > 
> > is converted to
> > 
> > E11.446588 N49.169494
> 
> 
> If I use pj_transform(), I get:
>  
>   21.982946, 48.433278

I see that cs2cs gives the same incorrect result I get, and not the
expected result:

cs2cs +init=epsg:31467 +to +init=epsg:4326
4459750 5448182
21d58'58.607"E  48d25'59.803"N -15.126


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From peifer at gmx.eu  Fri Mar 30 03:48:12 2012
From: peifer at gmx.eu (Hermann Peifer)
Date: Fri, 30 Mar 2012 12:48:12 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <1333102983.5866.65.camel@acme.pacific>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de> <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
Message-ID: <4F758F6C.3030907@gmx.eu>

On 30/03/2012 12:23, Roger Oberholtzer wrote:
> I see that cs2cs gives the same incorrect result I get, and not the
> expected result:
>
> cs2cs +init=epsg:31467 +to +init=epsg:4326
> 4459750 5448182
> 21d58'58.607"E  48d25'59.803"N -15.126
>
>

If your x-value starts with a 4, shouldn't it then be GK zone 4 = 
epsg:31468 ?

$ echo "4459750 5448182" | cs2cs +init=epsg:31468 +to +init=epsg:4326
11d26'47.703"E  49d10'10.159"N 50.082

Hermann



From Mikael.Rittri at carmenta.com  Fri Mar 30 04:38:29 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Fri, 30 Mar 2012 11:38:29 +0000
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <1333102983.5866.65.camel@acme.pacific>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de>  <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>

Hello Roger,

Actually, I do believe that E 21.982946, N 48.433278 is the correct
result, or at least more correct than E 11.446588, N 49.169494.

Here is how I convinced myself:

Since x = 4459750 m and the False Easting is 3500000,
the point is 4459750 - 3500000 = 959750 m east of the
central meridian which is 9° E. 

At the equator, there are about 111120 meters
per degree, so if we were at the equator we would 
be 959750 / 111120 = 8.64° east of the central
meridian.  But at the approximate latitude 49° N, the
meridians are closer together by a factor cos(49°),
so we are really about 8.64°/cos(49°) = 13.17° degrees
east of the central meridian, which is 22.17° east 
of Greenwich. 

This is of course just a rough calculation, ignoring
the changing local scale of the projection etc, but
I think it shows that the longitude should be nearer
22°E than 11°E. 

I don't know what's wrong with the original test example.

(For a while, I was thinking it had to do with the axis order,
 since in EPSG:31467, x should be northing and y easting.
 But 4459750 m cannot be a northing here, since it would
 be too far south, somewhere in south Italy.
 So I suppose your test example does use the mathematical
 convention after all, with x as easting and y as northing.)

Best regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

-----Original Message-----
From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Roger Oberholtzer
Sent: Friday, March 30, 2012 12:23 PM
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] DHDN / Gauss Krueger to WGS84

Bad form to reply to my own post, but...

> > I would add that epsg:31467 expands as:
> > 
> > +proj=tmerc +lat_0=0 +lon_0=9 +k=1.000000 +x_0=3500000 +y_0=0 +ellps=bessel 
> > +datum=potsdam +units=m +no_defs

> > it seems to work. A reference point of:
> > 
> > x = 4459750 m  y = 5448182 m
> > 
> > is converted to
> > 
> > E11.446588 N49.169494
> 
> 
> If I use pj_transform(), I get:
>  
>   21.982946, 48.433278

I see that cs2cs gives the same incorrect result I get, and not the
expected result:

cs2cs +init=epsg:31467 +to +init=epsg:4326
4459750 5448182
21d58'58.607"E  48d25'59.803"N -15.126


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From peifer at gmx.eu  Fri Mar 30 05:09:37 2012
From: peifer at gmx.eu (Hermann Peifer)
Date: Fri, 30 Mar 2012 14:09:37 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de> <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
	<E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>
Message-ID: <4F75A281.9050703@gmx.eu>

On 30/03/2012 13:38, Mikael Rittri wrote:
> Hello Roger,
>
> Actually, I do believe that E 21.982946, N 48.433278 is the correct
> result, or at least more correct than E 11.446588, N 49.169494.
>
> Here is how I convinced myself...

Here is how I convinced myself that the opposite is true:

- DHDN = Deutsches_Hauptdreiecksnetz, a Datum used in Germany, i.e. not 
used at E 21.982946
- in a coordinate system based on 3-degree zones, it doesn't make much 
sense to have x-values which are 959750 m east of any central meridian
- at school, I learned: if the leading digit of the x-value is 4, than 
you are in 3-degree Gauss-Kruger zone 4 (nowadays also known as epsg:31468)
- GK3 zone 4 has a central meridian of 12 degrees East and a false 
easting of 4500000m, see also [1]

Given the above, you end up with:

echo "4459750 5448182" | cs2cs -f "%.6f" +init=epsg:31468 +to 
+init=epsg:4326
11.446584       49.169489 50.081973

(i.e. some 100+ km north of Munich)

Hermann

[1] 
http://upload.wikimedia.org/wikipedia/de/1/12/Gau%C3%9F-Kr%C3%BCger-Raster_Deutschland.png


From Mikael.Rittri at carmenta.com  Fri Mar 30 05:32:00 2012
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Fri, 30 Mar 2012 12:32:00 +0000
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <4F75A281.9050703@gmx.eu>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de>  <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
	<E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>
	<4F75A281.9050703@gmx.eu>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49391B219D@SETHNWS023.carmenta.se>

Hermann, 
you are right, of course.

In the original thread, DHDN zone 3 was mentioned,
but the discussion was mainly about the datum shift. 

Later in the thread, the test point was given, but without 
a zone number. (I suppose all German GIS people know that 
the leading digit of the Easting is the zone number.)

Thanks,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

-----Original Message-----
From: Hermann Peifer [mailto:peifer at gmx.eu] 
Sent: Friday, March 30, 2012 2:10 PM
To: PROJ.4 and general Projections Discussions
Cc: Mikael Rittri
Subject: Re: DHDN / Gauss Krueger to WGS84

On 30/03/2012 13:38, Mikael Rittri wrote:
> Hello Roger,
>
> Actually, I do believe that E 21.982946, N 48.433278 is the correct
> result, or at least more correct than E 11.446588, N 49.169494.
>
> Here is how I convinced myself...

Here is how I convinced myself that the opposite is true:

- DHDN = Deutsches_Hauptdreiecksnetz, a Datum used in Germany, i.e. not 
used at E 21.982946
- in a coordinate system based on 3-degree zones, it doesn't make much 
sense to have x-values which are 959750 m east of any central meridian
- at school, I learned: if the leading digit of the x-value is 4, than 
you are in 3-degree Gauss-Kruger zone 4 (nowadays also known as epsg:31468)
- GK3 zone 4 has a central meridian of 12 degrees East and a false 
easting of 4500000m, see also [1]

Given the above, you end up with:

echo "4459750 5448182" | cs2cs -f "%.6f" +init=epsg:31468 +to 
+init=epsg:4326
11.446584       49.169489 50.081973

(i.e. some 100+ km north of Munich)

Hermann

[1] 
http://upload.wikimedia.org/wikipedia/de/1/12/Gau%C3%9F-Kr%C3%BCger-Raster_Deutschland.png


From roger at opq.se  Fri Mar 30 06:37:35 2012
From: roger at opq.se (Roger Oberholtzer)
Date: Fri, 30 Mar 2012 15:37:35 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49391B219D@SETHNWS023.carmenta.se>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de>  <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
	<E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>
	<4F75A281.9050703@gmx.eu>
	<E4AB3DD44D22854B819908379DE4AD49391B219D@SETHNWS023.carmenta.se>
Message-ID: <1333114655.5866.80.camel@acme.pacific>

On Fri, 2012-03-30 at 12:32 +0000, Mikael Rittri wrote:
> Hermann, 
> you are right, of course.

After further investigation, I have found that the epsg:31468 in proj is
incorrect.

The proper (meaning it works for coordinates used by BASt, which is my
requirement) definition should be (Zone 4):

+proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0 +ellps=bessel +towgs84=582,105,414,1.04,0.35,-3.08,8.3 +units=m +no_defs

The definition of +datum=potsdam as

	+ellps=bessel +towgs84=606.0,23.0,413.0

seems to be the core problem. When I changed that to what is shown
above, I get reasonable values for my test data.

Ignore the fact that my original post had +x_0=3500000 and +lon_0=9.0
instead of +x_0=4500000 and +lon_0=12. I had been trying many
combinations and only posted the most recent. It was only the change to
+towgs94 that made any difference.


Here is another mystery:

I updated my epsg file to my preferred definition. Then, when I use
+init=epgs:13468 in the C API, I get locations that are 10 meters or so
away from when I specify the same values 'by hand' in the C API. My
entry in the file is:

<31468> +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0 +ellps=bessel +towgs84=582,105,414,1.04,0.35,-3.08,8.3 +units=m +no_defs <>

Curious, no?


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From peifer at gmx.eu  Fri Mar 30 07:23:44 2012
From: peifer at gmx.eu (Hermann Peifer)
Date: Fri, 30 Mar 2012 16:23:44 +0200
Subject: [Proj] DHDN / Gauss Krueger to WGS84
In-Reply-To: <1333114655.5866.80.camel@acme.pacific>
References: <46F24873.20304@dspsolutions.de>
	<46F27F97.2070102@dspsolutions.de> <46F29A71.4000603@pobox.com>
	<1333100933.5866.50.camel@acme.pacific>
	<1333102983.5866.65.camel@acme.pacific>
	<E4AB3DD44D22854B819908379DE4AD49391B210A@SETHNWS023.carmenta.se>
	<4F75A281.9050703@gmx.eu>
	<E4AB3DD44D22854B819908379DE4AD49391B219D@SETHNWS023.carmenta.se>
	<1333114655.5866.80.camel@acme.pacific>
Message-ID: <4F75C1F0.9090803@gmx.eu>

On 30/03/2012 15:37, Roger Oberholtzer wrote:

>
> <31468>  +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0 +ellps=bessel +towgs84=582,105,414,1.04,0.35,-3.08,8.3 +units=m +no_defs<>
>

I am not sure about the 10 metres difference, but I suggest that for 
achieving more accurate results, you make use of the grid shift 
transformation:

+nadgrids=path/to//BETA2007.gsb


Hermann


