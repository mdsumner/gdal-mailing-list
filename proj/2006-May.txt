From EMiller at dfg.ca.gov  Thu May  4 11:34:19 2006
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Thu, 04 May 2006 11:34:19 -0700
Subject: [Proj] MGRS/USNG support?
Message-ID: <s459e6c2.062@dfg.ca.gov>

How difficult would it be to support the Military Grid Reference System (and U.S. National Grid)?  They're basically UTM but as a single alphanumeric string.  It seems it'd be a bit tricky since most of library and console programs act on coordinate pairs.  Basically, support would have to preprocess inputs and postprocess outputs somehow.  I'd imagine there would need to be a flag controlling desired output precision. (unless an existing flag can serve that purpose -w/n/ ?)

Are people:

1) Opposed
2) Supportive
3) Ambivalent
4) Don't care

???

I guess, for this to work the UTM handling would have to change.  Currently, you have to specify +zone= and +south (as appropriate), but the library should be able to figure that out and report it back in the output.  The user should have the option of forcing a zone or allowing the library to determine it.  Perhaps this is too deep a change?  I don't think it is an uncommon problem that folks might not know what zone a coordinate will fall into.  At least, not until it has been transformed to geodetic coordinates on the same datum/ellipsoid.  Then it's pretty easy to figure out.  So, why can't the library do that for the user?



Eric G. Miller
GIS Analyst
Biogeographic Data Branch
Department of Fish and Game




From warmerdam at pobox.com  Thu May  4 12:26:42 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 04 May 2006 15:26:42 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <s459e6c2.062@dfg.ca.gov>
References: <s459e6c2.062@dfg.ca.gov>
Message-ID: <445A5572.8000807@pobox.com>

Eric Miller wrote:
> How difficult would it be to support the Military Grid Reference System
> (and U.S. National Grid)?  They're basically UTM but as a single
> alphanumeric string.  It seems it'd be a bit tricky since most of library
> and console programs act on coordinate pairs.  Basically, support would
> have to preprocess inputs and postprocess outputs somehow.  I'd imagine
> there would need to be a flag controlling desired output precision. (unless
> an existing flag can serve that purpose -w/n/ ?)
> 
> Are people:
> 
> 1) Opposed 2) Supportive 3) Ambivalent 4) Don't care

Eric,

I'm ... not supportive but opposed would be a bit strong.

I looked over this problem a while ago, and came to the conclusion that
MGRS just doesn't fit into the scheme of the PROJ.4 API with x/y (and
sometimes z) coordinates and an associated coordinate system.

So I think if we offered MGRS support in PROJ.4 it would be a special
"layered service", and not built into pj_inv(), pj_fwd() and pj_transform().

For this reason, when I needed MGRS handling in GDAL I just hacked to
together local handling for it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From cjmce at lsu.edu  Thu May  4 12:28:43 2006
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Thu, 4 May 2006 14:28:43 -0500
Subject: [Proj] MGRS support? HELL NO!
Message-ID: <OF3150F5DB.C7C308E9-ON86257164.006AFFEF-86257164.006B0000@lsu.edu>





I am vehememtly OPPOSED to any non-U.S.Military software package attempting
to implement the MGRS outside of the United States.  OK with me for the
U.S., but any slight or minor screw-up elsewhere can serve as the root
cause of "Friendly Fire" accidents that maim or kill our own sons and
daughters in uniform.  Yes, it has already happened before.

I say stay the hell away from its use outside of the U.S.

Clifford J. Mugnier, C.P., C.M.S.
National Director (2006-2008),
Photogrammetric Applications Division
American Society for Photogrammetry and Remote Sensing
and
Chief of Geodesy,
CENTER FOR GEOINFORMATICS
Department of Civil Engineering
CEBA 3223A
LOUISIANA STATE UNIVERSITY
Baton Rouge, LA  70803
Voice and Facsimile:  (225) 578-8536 [Academic]
Voice and Facsimile:  (225) 578-4474 [Research]
Honorary Life Member of the
Louisiana Society of Professional Surveyors
======================================================
http://www.asprs.org/resources/GRIDS/
http://appl003.lsu.edu/eng/ceeweb.nsf/$Content/Mugnier
======================================================




How difficult would it be to support the Military Grid Reference System
(and U.S. National Grid)?  They're basically UTM but as a single
alphanumeric string.  It seems it'd be a bit tricky since most of library
and console programs act on coordinate pairs.  Basically, support would
have to preprocess inputs and postprocess outputs somehow.  I'd imagine
there would need to be a flag controlling desired output precision. (unless
an existing flag can serve that purpose -w/n/ ?)

Are people:

1) Opposed
2) Supportive
3) Ambivalent
4) Don't care

???

I guess, for this to work the UTM handling would have to change.
Currently, you have to specify +zone= and +south (as appropriate), but the
library should be able to figure that out and report it back in the output.
The user should have the option of forcing a zone or allowing the library
to determine it.  Perhaps this is too deep a change?  I don't think it is
an uncommon problem that folks might not know what zone a coordinate will
fall into.  At least, not until it has been transformed to geodetic
coordinates on the same datum/ellipsoid.  Then it's pretty easy to figure
out.  So, why can't the library do that for the user?



Eric G. Miller
GIS Analyst
Biogeographic Data Branch
Department of Fish and Game


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



From dagnew at ucsd.edu  Thu May  4 12:46:35 2006
From: dagnew at ucsd.edu (Duncan Agnew)
Date: Thu, 4 May 2006 12:46:35 -0700
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <s459e6c2.062@dfg.ca.gov>
References: <s459e6c2.062@dfg.ca.gov>
Message-ID: <c956404bc539dbfaddce0706923a987a@ucsd.edu>

I've made this point before, but again: MGRS and other location codes 
are different things from
the coordinates PROJ works with. The coordinates describe a point, the 
codes describe an area
(to variable precision depending on code length).

Not to say there wouldn't be room for a separate routine that converted 
UTM zone, E, and N, to
MGRS or equivalent (there is no reverse mapping)--but it should be 
separate.

Duncan Agnew



From gerald.evenden at verizon.net  Thu May  4 13:15:31 2006
From: gerald.evenden at verizon.net (Gerald I. Evenden)
Date: Thu, 04 May 2006 16:15:31 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <c956404bc539dbfaddce0706923a987a@ucsd.edu>
References: <s459e6c2.062@dfg.ca.gov>
	<c956404bc539dbfaddce0706923a987a@ucsd.edu>
Message-ID: <200605041615.31120.gerald.evenden@verizon.net>

On Thursday 04 May 2006 3:46 pm, Duncan Agnew wrote:
> I've made this point before, but again: MGRS and other location codes
> are different things from
> the coordinates PROJ works with. The coordinates describe a point, the
> codes describe an area
> (to variable precision depending on code length).
>
> Not to say there wouldn't be room for a separate routine that converted
> UTM zone, E, and N, to
> MGRS or equivalent (there is no reverse mapping)--but it should be
> separate.

The zone concept was my impression when I looked at the problem
several years ago.  Proj in it various forms deals with a point coordinate
and not a surface region.  That is, as I recall, the length of  the military
grid system string also determined the size of the cell referred to.

I think this is an apples-oranges issue.

Also, what is meant by the "U.S. National Grid?"

-- 
Jerry and the low-riders: Daisy Mae and Joshua
"Cogito cogito ergo cogito sum"
   Ambrose Bierce, The Devil's Dictionary


From dagnew at ucsd.edu  Thu May  4 14:06:25 2006
From: dagnew at ucsd.edu (Duncan Agnew)
Date: Thu, 4 May 2006 14:06:25 -0700
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <200605041615.31120.gerald.evenden@verizon.net>
References: <s459e6c2.062@dfg.ca.gov>
	<c956404bc539dbfaddce0706923a987a@ucsd.edu>
	<200605041615.31120.gerald.evenden@verizon.net>
Message-ID: <981ec69777a9a52292e1747525fe492f@ucsd.edu>

To answer Gerald's question, USNG is MGRS inside the US (near as I can 
make out): they look the same but go by different names because 
different agencies promulgate them. Online and downloadable
computation is available at http://www.ngs.noaa.gov/TOOLS/usng.html



From EMiller at dfg.ca.gov  Thu May  4 15:51:18 2006
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Thu, 04 May 2006 15:51:18 -0700
Subject: [Proj] MGRS/USNG support?
Message-ID: <s45a2313.028@dfg.ca.gov>

Yea, the more I think about it the more I think it'd be really hard to shoehorn in.  The "layered service" approach is probably the right way.  

>>> warmerdam at pobox.com 5/4/2006 12:26 PM >>>

Eric,

I'm ... not supportive but opposed would be a bit strong.

I looked over this problem a while ago, and came to the conclusion that
MGRS just doesn't fit into the scheme of the PROJ.4 API with x/y (and
sometimes z) coordinates and an associated coordinate system.

So I think if we offered MGRS support in PROJ.4 it would be a special
"layered service", and not built into pj_inv(), pj_fwd() and pj_transform().

For this reason, when I needed MGRS handling in GDAL I just hacked to
together local handling for it.





From erich.sadlowski at gmx.de  Fri May  5 03:32:37 2006
From: erich.sadlowski at gmx.de (Erich Sadlowski)
Date: Fri, 5 May 2006 10:32:37 +0000 (UTC)
Subject: [Proj] value of PROJ_LIB variable
Message-ID: <loom.20060505T103825-752@post.gmane.org>

Hello,

I'm using the libproj.a in my application.

When "feeding" the pj_init_plus with an "+init=epsg:xxxxx" definition I get a
problem: the epsg file could'nt be found. When debugging the code I detect that
in pj_open_lib a getenv("PROJ_LIB") is made ... and I'm surprised to see that it
has a value although at the system prompt an echo $PROJ_LIB results in an empty
string. So: Where is this environment variable set??

It seems to me that the value of it is the path where the project originally was
compiled an published (on our server). Unfortunately this directory is moved to
an other place (where at least I bind the libproj.a from).

Can anybody explain this behaviour?

Greetings
Erich



From ovv at hetnet.nl  Fri May  5 06:09:00 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Fri, 05 May 2006 15:09:00 +0200
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <s459e6c2.062@dfg.ca.gov>
Message-ID: <C0811B0C.6F02%ovv@hetnet.nl>

>From Eric G. Miller:

> I guess, for this to work the UTM handling would have to change.  Currently,
> you have to specify +zone= and +south (as appropriate), but the library should
> be able to figure that out and report it back in the output.  The user should
> have the option of forcing a zone or allowing the library to determine it.
> Perhaps this is too deep a change?

>From my remarks, April 26:

> Let the projection code calculate what the nearest central meridian is,
> merely based on the input of the longitude of each point.
> But: can (lib)proj do that?

Is it really that obtrusive to change tmerc/utm so, that it calculates the
nearest central meridian itself, if no zone or CM is supplied?
Indeed, processing MGRS strings should be a pre/postprocessor task.






From warmerdam at pobox.com  Fri May  5 06:46:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 05 May 2006 09:46:17 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <C0811B0C.6F02%ovv@hetnet.nl>
References: <C0811B0C.6F02%ovv@hetnet.nl>
Message-ID: <445B5729.2080509@pobox.com>

Oscar van Vlijmen wrote:
>>From Eric G. Miller:
> 
>> I guess, for this to work the UTM handling would have to change.  Currently,
>> you have to specify +zone= and +south (as appropriate), but the library should
>> be able to figure that out and report it back in the output.  The user should
>> have the option of forcing a zone or allowing the library to determine it.
>> Perhaps this is too deep a change?
> 
>>From my remarks, April 26:
> 
>> Let the projection code calculate what the nearest central meridian is,
>> merely based on the input of the longitude of each point.
>> But: can (lib)proj do that?
> 
> Is it really that obtrusive to change tmerc/utm so, that it calculates the
> nearest central meridian itself, if no zone or CM is supplied?

Oscar,

Well, this could certainly be done for the geographic to projected
transformation as a special case.  But it isn't at all clear to me
that this would be useful.  You would get back projected UTM coordinates
without knowing which UTM zone they are in.  And of course, there is no
way of doing the same thing when going the other way.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From warmerdam at pobox.com  Fri May  5 06:52:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 05 May 2006 09:52:18 -0400
Subject: [Proj] value of PROJ_LIB variable
In-Reply-To: <loom.20060505T103825-752@post.gmane.org>
References: <loom.20060505T103825-752@post.gmane.org>
Message-ID: <445B5892.3090006@pobox.com>

Erich Sadlowski wrote:
> Hello,
> 
> I'm using the libproj.a in my application.
> 
> When "feeding" the pj_init_plus with an "+init=epsg:xxxxx" definition I get a
> problem: the epsg file could'nt be found. When debugging the code I detect that
> in pj_open_lib a getenv("PROJ_LIB") is made ... and I'm surprised to see that it
> has a value although at the system prompt an echo $PROJ_LIB results in an empty
> string. So: Where is this environment variable set??

Erich,

I am not aware of anywhere in PROJ.4 that sets this enviroment variable. But
PROJ.4 does have a few methods of finding the support files beside this
environment variable.

A default build on Unix-like systems will define the PROJ_LIB macro to be the
default install directory in pj_open_lib.c.  This is often
/usr/local/share/proj.

You can also use the pj_set_finder() and pj_set_searchpath() functions
programatically to override how the files are found.

I would guess that in your case it is the PROJ_LIB *macro* that is getting
used.

> It seems to me that the value of it is the path where the project originally was
> compiled an published (on our server). Unfortunately this directory is moved to
> an other place (where at least I bind the libproj.a from).
> 
> Can anybody explain this behaviour?

Normally when you are building your own application that will "knows" about
it's environment, such as where it's support files are placed, it would
use pj_set_finder() or pj_set_searchpath() to tell PROJ where to find them.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From Tim.Loesch at dnr.state.mn.us  Fri May  5 06:54:06 2006
From: Tim.Loesch at dnr.state.mn.us (Tim Loesch)
Date: Fri, 05 May 2006 08:54:06 -0500
Subject: [Proj] 
	Re: Proj Digest, Vol 24, Issue 1 (NOTICE - Out of the office)
Message-ID: <s45b12ce.086@co5.dnr.state.mn.us>

I'm out of the office and will return Monday May 8th. If this is a GIS technical related issue contact Chris Pouliot or Mike Tronrud.





From gerald.evenden at verizon.net  Fri May  5 07:06:11 2006
From: gerald.evenden at verizon.net (Gerald I. Evenden)
Date: Fri, 05 May 2006 10:06:11 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <C0811B0C.6F02%ovv@hetnet.nl>
References: <C0811B0C.6F02%ovv@hetnet.nl>
Message-ID: <200605051006.12002.gerald.evenden@verizon.net>

On Friday 05 May 2006 9:09 am, Oscar van Vlijmen wrote:
> >From Eric G. Miller:
> >
> > I guess, for this to work the UTM handling would have to change. 
> > Currently, you have to specify +zone= and +south (as appropriate), but
> > the library should be able to figure that out and report it back in the
> > output.  The user should have the option of forcing a zone or allowing
> > the library to determine it. Perhaps this is too deep a change?
> >
> >From my remarks, April 26:
> >
> > Let the projection code calculate what the nearest central meridian is,
> > merely based on the input of the longitude of each point.
> > But: can (lib)proj do that?
>
> Is it really that obtrusive to change tmerc/utm so, that it calculates the
> nearest central meridian itself, if no zone or CM is supplied?
> Indeed, processing MGRS strings should be a pre/postprocessor task.

Yes it is!

UTM allows for a 1/2 degree overlap or extension beyond its normal
longitude range.  Given that factor, how do you know which CM to use?

Similarly, if the point lies exactly on the division between zones, which
CM do you use?

Also, some zones in the Scandinavian region extend beyond the normal
+/-3 degree limit, so again, explicit specification of the zone is required.

Sorry.
-- 
Jerry and the low-riders: Daisy Mae and Joshua
"Cogito cogito ergo cogito sum"
   Ambrose Bierce, The Devil's Dictionary


From hamish_nospam at yahoo.com  Fri May  5 08:34:59 2006
From: hamish_nospam at yahoo.com (Hamish)
Date: Sat, 6 May 2006 03:34:59 +1200
Subject: [Proj] value of PROJ_LIB variable
In-Reply-To: <445B5892.3090006@pobox.com>
References: <loom.20060505T103825-752@post.gmane.org>
	<445B5892.3090006@pobox.com>
Message-ID: <20060506033459.22057d9a.hamish_nospam@yahoo.com>

> A default build on Unix-like systems will define the PROJ_LIB macro to
> be the default install directory in pj_open_lib.c.  This is often
> /usr/local/share/proj.
> 
> You can also use the pj_set_finder() and pj_set_searchpath() functions
> programatically to override how the files are found.


Is there a way to figure out what this has been set to after the binary
is made? e.g. something analogous to gdal-config.

In GRASS we'd like to auto-locate & parse the EPSG file for quickly
defining new projects from the startup screen if given a valid code.
Usually libproj is found in the LD search path so our ./configure
hasn't been told where to look. Knowing --prefix would be enough I
think, but PROJ_LIB is the path we want to know.

?

thanks,
Hamish


From warmerdam at pobox.com  Fri May  5 09:45:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 05 May 2006 12:45:51 -0400
Subject: [Proj] value of PROJ_LIB variable
In-Reply-To: <20060506033459.22057d9a.hamish_nospam@yahoo.com>
References: <loom.20060505T103825-752@post.gmane.org>	<445B5892.3090006@pobox.com>
	<20060506033459.22057d9a.hamish_nospam@yahoo.com>
Message-ID: <445B813F.803@pobox.com>

Hamish wrote:
>> A default build on Unix-like systems will define the PROJ_LIB macro to
>> be the default install directory in pj_open_lib.c.  This is often
>> /usr/local/share/proj.
>>
>> You can also use the pj_set_finder() and pj_set_searchpath() functions
>> programatically to override how the files are found.
> 
> 
> Is there a way to figure out what this has been set to after the binary
> is made? e.g. something analogous to gdal-config.

Hamish,

There is currently no way to find out the hardcoded location that
proj will search for support files.

> In GRASS we'd like to auto-locate & parse the EPSG file for quickly
> defining new projects from the startup screen if given a valid code.
> Usually libproj is found in the LD search path so our ./configure
> hasn't been told where to look. Knowing --prefix would be enough I
> think, but PROJ_LIB is the path we want to know.

Understood.  If you would like to file a request for a proj-config, I
will try to add it at some point, but it won't help you for quite a while.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From ovv at hetnet.nl  Fri May  5 11:25:19 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Fri, 05 May 2006 20:25:19 +0200
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <200605051006.12002.gerald.evenden@verizon.net>
Message-ID: <C081652F.6F0D%ovv@hetnet.nl>

>>> Let the projection code calculate what the nearest central meridian is,
>>> merely based on the input of the longitude of each point.

> From: Gerald I. Evenden
> UTM allows for a 1/2 degree overlap or extension beyond its normal
> longitude range.  Given that factor, how do you know which CM to use?
That's a shortcoming, but to calculate a 'regular' CM would be the best
thing to do.

> Similarly, if the point lies exactly on the division between zones, which
> CM do you use?
This is a matter of choosing one and documenting what the code does.
I believe the usual choice is zone 1 for lon=-180, zone 2 for lon=-172, ...
zone 31 for lon=0, zone 32 for lon=6, etcetera.

> Also, some zones in the Scandinavian region extend beyond the normal
> +/-3 degree limit, so again, explicit specification of the zone is required.
This is NOT required! It can be done based on latitude and longitude alone.
Others have done it, I have done it, so it can be done again.

Admittedly, usage of tmerc/utm in this fashion would be rare, but it
certainly is requested every now and then.
Some people do have lat/lon data without zone designations. If the UTM or GK
setup of a mutizonal region is highly regular -- without overlaps,
ambiguities, singularities etcetera -- an algorithmically derived CM can be
used without any problem.

> From: Frank Warmerdam
> And of course, there is no
> way of doing the same thing when going the other way.

This conversion is of course asymmetrical.



From gerald.evenden at verizon.net  Fri May  5 16:59:20 2006
From: gerald.evenden at verizon.net (Gerald I. Evenden)
Date: Fri, 05 May 2006 19:59:20 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <C081652F.6F0D%ovv@hetnet.nl>
References: <C081652F.6F0D%ovv@hetnet.nl>
Message-ID: <200605051959.21005.gerald.evenden@verizon.net>

On Friday 05 May 2006 2:25 pm, Oscar van Vlijmen wrote:
> >>> Let the projection code calculate what the nearest central meridian is,
> >>> merely based on the input of the longitude of each point.
> >
> > From: Gerald I. Evenden
> > UTM allows for a 1/2 degree overlap or extension beyond its normal
> > longitude range.  Given that factor, how do you know which CM to use?
>
> That's a shortcoming, but to calculate a 'regular' CM would be the best
> thing to do.
>
> > Similarly, if the point lies exactly on the division between zones, which
> > CM do you use?
>
> This is a matter of choosing one and documenting what the code does.
> I believe the usual choice is zone 1 for lon=-180, zone 2 for lon=-172, ...
> zone 31 for lon=0, zone 32 for lon=6, etcetera.
>
> > Also, some zones in the Scandinavian region extend beyond the normal
> > +/-3 degree limit, so again, explicit specification of the zone is
> > required.
>
> This is NOT required! It can be done based on latitude and longitude alone.
> Others have done it, I have done it, so it can be done again.

Using the argument that "others have done" holds no weight.

> Admittedly, usage of tmerc/utm in this fashion would be rare, but it
> certainly is requested every now and then.
> Some people do have lat/lon data without zone designations. If the UTM or
> GK setup of a mutizonal region is highly regular -- without overlaps,
> ambiguities, singularities etcetera -- an algorithmically derived CM can be
> used without any problem.

I am afraid that I am adamantly against doing any such "conversion" and using
the name UTM in the same breath.  One of the nice things about UTM is
that it is a standard, a good standard, and does not need any tweeking.
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-- 
Jerry and the low-riders: Daisy Mae and Joshua
"Cogito cogito ergo cogito sum"
   Ambrose Bierce, The Devil's Dictionary


From george.percivall at verizon.net  Thu May  4 14:19:32 2006
From: george.percivall at verizon.net (George Percivall)
Date: Thu, 04 May 2006 17:19:32 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <981ec69777a9a52292e1747525fe492f@ucsd.edu>
References: <s459e6c2.062@dfg.ca.gov>
	<c956404bc539dbfaddce0706923a987a@ucsd.edu>
	<200605041615.31120.gerald.evenden@verizon.net>
	<981ec69777a9a52292e1747525fe492f@ucsd.edu>
Message-ID: <3BB57AD2-1401-4C57-99F1-EE8DD51E916C@verizon.net>


USNG is an FGDC standard:
http://www.fgdc.gov/standards/projects/FGDC-standards-projects/usng/ 
fgdc_std_011_2001_usng.pdf



On May 4, 2006, at 5:06 PM, Duncan Agnew wrote:

> To answer Gerald's question, USNG is MGRS inside the US (near as I  
> can make out): they look the same but go by different names because  
> different agencies promulgate them. Online and downloadable
> computation is available at http://www.ngs.noaa.gov/TOOLS/usng.html
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



George Percivall
Open Geospatial Consortium
http://www.opengeospatial.org/
E-mail: percivall at opengeospatial.org
Voice: 1+301-560-6439



************************************************************************ 
****
This communication, including attachments, is for the exclusive use  
of addressee(s). If you are not the intended recipient, any use,  
copying, disclosure, dissemination or distribution is strictly  
prohibited. If you are not the intended recipient, please notify the  
sender immediately by return email and delete this communication and  
destroy all copies.
************************************************************************ 
****





From neteler at itc.it  Sat May  6 09:21:23 2006
From: neteler at itc.it (Markus Neteler)
Date: Sat, 6 May 2006 18:21:23 +0200
Subject: [Proj] value of PROJ_LIB variable
In-Reply-To: <445B813F.803@pobox.com>
References: <loom.20060505T103825-752@post.gmane.org>
	<445B5892.3090006@pobox.com>
	<20060506033459.22057d9a.hamish_nospam@yahoo.com>
	<445B813F.803@pobox.com>
Message-ID: <20060506162123.GE1701@bartok.itc.it>

On Fri, May 05, 2006 at 12:45:51PM -0400, Frank Warmerdam wrote:
> Hamish wrote:
> >>A default build on Unix-like systems will define the PROJ_LIB macro to
> >>be the default install directory in pj_open_lib.c.  This is often
> >>/usr/local/share/proj.
> >>
> >>You can also use the pj_set_finder() and pj_set_searchpath() functions
> >>programatically to override how the files are found.
> >
> >
> >Is there a way to figure out what this has been set to after the binary
> >is made? e.g. something analogous to gdal-config.
> 
> Hamish,
> 
> There is currently no way to find out the hardcoded location that
> proj will search for support files.
> 
> >In GRASS we'd like to auto-locate & parse the EPSG file for quickly
> >defining new projects from the startup screen if given a valid code.
> >Usually libproj is found in the LD search path so our ./configure
> >hasn't been told where to look. Knowing --prefix would be enough I
> >think, but PROJ_LIB is the path we want to know.
> 
> Understood.  If you would like to file a request for a proj-config, I
> will try to add it at some point, but it won't help you for quite a while.
> 

Probably we can only loop over common directories and check
if the epsg file is there unless a new proj-config becomes
available and distributed?

Markus


From cjmce at lsu.edu  Sun May  7 11:02:46 2006
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Sun, 7 May 2006 13:02:46 -0500
Subject: [Proj] MGRS/USNG support?
Message-ID: <OF85F263A8.018ADAF1-ON86257167.00632161-86257167.00632178@lsu.edu>





Such as it may be for the United States, a minor glitch won't necessarily
mean the difference between life and death.  Once this gets extended
world-wide the permanent damage is done if the slightest error is included
in the code.

Who wants the responsibility for the loss of life of an American Soldier
sometime in the future for a "little ole goof in software?"  The USNG has a
theoretical justification in that it "will be used in the future for rescue
operations."  Maybe so, maybe no.  It certainly was NOT used for Katrina
because there's a UTM Zone change in the middle of the city of New Orleans.

Mice and men folks; the USNG is a dog and civilian implementation of the
MGRS will eventually get some young men killed.  Within the U.S., some may
remember the Twenty-nine Palms incident - that was only an entire U.S. town
that almost got bombed with live ordinance ... thank goodness for a break
in the clouds and not the MGRS!

I think it's a stupid idea (USNG), and I have said so publically for over a
decade since its original publication.  But what do I know about the use of
coordinate systems, anyway?

Clifford J. Mugnier, C.P., C.M.S.
National Director (2006-2008),
Photogrammetric Applications Division
American Society for Photogrammetry and Remote Sensing
and
Chief of Geodesy,
CENTER FOR GEOINFORMATICS
Department of Civil Engineering
CEBA 3223A
LOUISIANA STATE UNIVERSITY
Baton Rouge, LA  70803
Voice and Facsimile:  (225) 578-8536 [Academic]
Voice and Facsimile:  (225) 578-4474 [Research]
Honorary Life Member of the
Louisiana Society of Professional Surveyors
======================================================
http://www.asprs.org/resources/GRIDS/
http://appl003.lsu.edu/eng/ceeweb.nsf/$Content/Mugnier
======================================================


USNG is an FGDC standard:
http://www.fgdc.gov/standards/projects/FGDC-standards-projects/usng/
fgdc_std_011_2001_usng.pdf



On May 4, 2006, at 5:06 PM, Duncan Agnew wrote:

> To answer Gerald's question, USNG is MGRS inside the US (near as I
> can make out): they look the same but go by different names because
> different agencies promulgate them. Online and downloadable
> computation is available at http://www.ngs.noaa.gov/TOOLS/usng.html
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



George Percivall
Open Geospatial Consortium
http://www.opengeospatial.org/
E-mail: percivall at opengeospatial.org
Voice: 1+301-560-6439



************************************************************************
****
This communication, including attachments, is for the exclusive use
of addressee(s). If you are not the intended recipient, any use,
copying, disclosure, dissemination or distribution is strictly
prohibited. If you are not the intended recipient, please notify the
sender immediately by return email and delete this communication and
destroy all copies.
************************************************************************
****



_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



From gpercivall at opengeospatial.org  Sun May  7 13:13:47 2006
From: gpercivall at opengeospatial.org (George Percivall)
Date: Sun, 7 May 2006 16:13:47 -0400
Subject: [Proj] MGRS/USNG support?
In-Reply-To: <OF85F263A8.018ADAF1-ON86257167.00632161-86257167.00632178@lsu.edu>
References: <OF85F263A8.018ADAF1-ON86257167.00632161-86257167.00632178@lsu.edu>
Message-ID: <EC8F55C7-B8FB-4976-A958-5708AF781554@opengeospatial.org>

Clifford

I was going to urge your that your comments be sent to FGDC.
But perhaps that already happened some time ago.

George


On May 7, 2006, at 2:02 PM, Clifford J Mugnier wrote:

>
>
>
>
> Such as it may be for the United States, a minor glitch won't  
> necessarily
> mean the difference between life and death.  Once this gets extended
> world-wide the permanent damage is done if the slightest error is  
> included
> in the code.
>
> Who wants the responsibility for the loss of life of an American  
> Soldier
> sometime in the future for a "little ole goof in software?"  The  
> USNG has a
> theoretical justification in that it "will be used in the future  
> for rescue
> operations."  Maybe so, maybe no.  It certainly was NOT used for  
> Katrina
> because there's a UTM Zone change in the middle of the city of New  
> Orleans.
>
> Mice and men folks; the USNG is a dog and civilian implementation  
> of the
> MGRS will eventually get some young men killed.  Within the U.S.,  
> some may
> remember the Twenty-nine Palms incident - that was only an entire  
> U.S. town
> that almost got bombed with live ordinance ... thank goodness for a  
> break
> in the clouds and not the MGRS!
>
> I think it's a stupid idea (USNG), and I have said so publically  
> for over a
> decade since its original publication.  But what do I know about  
> the use of
> coordinate systems, anyway?
>
> Clifford J. Mugnier, C.P., C.M.S.
> National Director (2006-2008),
> Photogrammetric Applications Division
> American Society for Photogrammetry and Remote Sensing
> and
> Chief of Geodesy,
> CENTER FOR GEOINFORMATICS
> Department of Civil Engineering
> CEBA 3223A
> LOUISIANA STATE UNIVERSITY
> Baton Rouge, LA  70803
> Voice and Facsimile:  (225) 578-8536 [Academic]
> Voice and Facsimile:  (225) 578-4474 [Research]
> Honorary Life Member of the
> Louisiana Society of Professional Surveyors
> ======================================================
> http://www.asprs.org/resources/GRIDS/
> http://appl003.lsu.edu/eng/ceeweb.nsf/$Content/Mugnier
> ======================================================
>
>
> USNG is an FGDC standard:
> http://www.fgdc.gov/standards/projects/FGDC-standards-projects/usng/
> fgdc_std_011_2001_usng.pdf
>
>
>
> On May 4, 2006, at 5:06 PM, Duncan Agnew wrote:
>
>> To answer Gerald's question, USNG is MGRS inside the US (near as I
>> can make out): they look the same but go by different names because
>> different agencies promulgate them. Online and downloadable
>> computation is available at http://www.ngs.noaa.gov/TOOLS/usng.html
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> George Percivall
> Open Geospatial Consortium
> http://www.opengeospatial.org/
> E-mail: percivall at opengeospatial.org
> Voice: 1+301-560-6439
>
>
>
> ********************************************************************** 
> **
> ****
> This communication, including attachments, is for the exclusive use
> of addressee(s). If you are not the intended recipient, any use,
> copying, disclosure, dissemination or distribution is strictly
> prohibited. If you are not the intended recipient, please notify the
> sender immediately by return email and delete this communication and
> destroy all copies.
> ********************************************************************** 
> **
> ****
>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

George Percivall
Open Geospatial Consortium
http://www.opengeospatial.org/
E-mail: percivall at opengeospatial.org
Voice: 1+301-560-6439



************************************************************************ 
****
This communication, including attachments, is for the exclusive use  
of addressee(s). If you are not the intended recipient, any use,  
copying, disclosure, dissemination or distribution is strictly  
prohibited. If you are not the intended recipient, please notify the  
sender immediately by return email and delete this communication and  
destroy all copies.
************************************************************************ 
****





From erich.sadlowski at gmx.de  Mon May  8 21:32:41 2006
From: erich.sadlowski at gmx.de (Erich Sadlowski)
Date: Tue, 9 May 2006 04:32:41 +0000 (UTC)
Subject: [Proj] Re: value of PROJ_LIB variable
References: <loom.20060505T103825-752@post.gmane.org>
	<445B5892.3090006@pobox.com>
Message-ID: <loom.20060509T062347-483@post.gmane.org>


Frank Warmerdam <warmerdam <at> pobox.com> writes:


> 
> I am not aware of anywhere in PROJ.4 that sets this enviroment variable. But
> PROJ.4 does have a few methods of finding the support files beside this
> environment variable.
> 
> A default build on Unix-like systems will define the PROJ_LIB macro to be the
> default install directory in pj_open_lib.c.  This is often
> /usr/local/share/proj.
> 


Hello Frank,

Thanks for your answer!

Yes, in the meantime I found out, that the variable is set in the (generated)
Makefile and transfered to the library via the "-D" define flag.

Now I use your suggested pj_set_searchpath() and it works fine.

Again: Thanks a lot!

Best regards
   Erich




From vincent.troisi at colorado.edu  Fri May 12 07:40:22 2006
From: vincent.troisi at colorado.edu (Vincent J. Troisi)
Date: Fri, 12 May 2006 08:40:22 -0600
Subject: [Proj] updated epsg file in proj distribution
Message-ID: <44649E56.1040108@colorado.edu>

I have imagery in a polar stereographic projection. However,
the latitude of the standard parallel is 71 degrees. I noticed
code 3031 in the current epsg database defines this projection,
but the code does not exist in the current proj releases. Are
there any plans to update the epsg file in the proj release to
the latest version of the epsg database?

Vince



From warmerdam at pobox.com  Sun May 14 17:56:27 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun, 14 May 2006 20:56:27 -0400
Subject: [Proj] updated epsg file in proj distribution
In-Reply-To: <44649E56.1040108@colorado.edu>
References: <44649E56.1040108@colorado.edu>
Message-ID: <4467D1BB.9090601@pobox.com>

Vincent J. Troisi wrote:
> I have imagery in a polar stereographic projection. However,
> the latitude of the standard parallel is 71 degrees. I noticed
> code 3031 in the current epsg database defines this projection,
> but the code does not exist in the current proj releases. Are
> there any plans to update the epsg file in the proj release to
> the latest version of the epsg database?

Vince,

You should try PROJ 4.5.0 beta 1 which was updated to a recent (but no longer
the most recent) EPSG database.  I do periodically update to a more recent
database.

In any event, if it is not there, you can just manually edit the appropriate
definitions into /usr/local/share/proj/epsg.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From jgw at alpinegeophysics.com  Mon May 15 14:18:15 2006
From: jgw at alpinegeophysics.com (James G Wilkinson)
Date: Mon, 15 May 2006 14:18:15 -0700
Subject: [Proj] Datum Conversions
Message-ID: <4468F017.7010007@alpinegeophysics.com>

PROJ4 community,

This is my first post to this list.  I am looking for some help to 
prepare the
necessary files for a three point or seven point datum conversion for use
with PROJ4.  In my line of work (meteorological and air quality modeling),
I rountinely need to perform a geographic-NAD83 (or NAD27) to Lambert
Conformal Conic-datumless (earth as a sphere) conversion and LCC-NAD83
(NAD27) to geographic-datumless conversion.

I suspect that developing these files is by no means routine, but I am 
at least
willing to make an attempt.  Anything that I might develop will be gladly
shared with the community.  Can anyone provide a literature base (web 
pointers
preferred, but I do have access to decent University libraries) on how to
estimate these parameters?

Regards,

Jim



From sergioantoun at gmail.com  Tue May 16 12:45:43 2006
From: sergioantoun at gmail.com (Sergio Orlando Antoun Netto)
Date: Tue, 16 May 2006 16:45:43 -0300
Subject: [Proj] PROJ.4
Message-ID: <f50f761f0605161245i8455372yd8d40d6b302c5a7@mail.gmail.com>

My name is Sergio. I'm brasilian student (MSc) of Rio de Janeiro State
University (UERJ). I want to know how can I add a new projection, ellipsoid
and datum in Proj.4 library?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060516/85f28964/attachment.html>

From craig at millerfam.net  Tue May 16 13:22:25 2006
From: craig at millerfam.net (Craig Miller)
Date: Tue, 16 May 2006 13:22:25 -0700
Subject: [Proj] PROJ.4
In-Reply-To: <f50f761f0605161245i8455372yd8d40d6b302c5a7@mail.gmail.com>
Message-ID: <000001c67926$74079550$0401a8c0@vaio>

One way is to just create a well known text string that includes the
definitions, then just pass the string via the constructor.
 
--Craig
 

  _____  

From: proj-bounces at lists.maptools.org
[mailto:proj-bounces at lists.maptools.org] On Behalf Of Sergio Orlando Antoun
Netto
Sent: Tuesday, May 16, 2006 12:46 PM
To: proj at lists.maptools.org
Subject: [Proj] PROJ.4


 
My name is Sergio. I'm brasilian student (MSc) of Rio de Janeiro State
University (UERJ). I want to know how can I add a new projection, ellipsoid
and datum in Proj.4 library?
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060516/b31d5e36/attachment.html>

From simonom at gmail.com  Tue May 16 21:49:12 2006
From: simonom at gmail.com (Simon O'Malley)
Date: Wed, 17 May 2006 16:49:12 +1200
Subject: [Proj] NZGD2000 to NZGD49
Message-ID: <e3a3ae450605162149n7f5a3d1dnc54c76509bc0edd4@mail.gmail.com>

Hi

I am trying to test the datum shift (using nzgd2kgrid0005.gsb file) for
conversions between NZGD2000 and NZGD49(NZMG).

I have downloaded the proj-datumgrid-1.3.zip file, and extracted everything
under the nad directory.

configured, make, and make install. However the gsb file does not get copied
to /usr/local/share/proj

I copied it across but postgis does not appear to use it i.e. my transformed
coordinates are not correct, as verified by the linz website and other
software that uses the grid file.

I then tried to use cs2cs to validate it but all attempts at specifying the
projections and datums gave me errors.

I have tried multiple versions of:

cs2cs +proj=latlong +datum=nzgd2000 +nadgrids=nzgd2kgrid0005 +to +proj=nzmg
+datum=nzgd49

After setting PROJ_DEBUG I get:

pj_open_lib(proj_def.dat): call fopen(/usr/local/share/proj/proj_def.dat) -
succeeded
Using from definition: proj=latlong datum=nzgd2000 nadgrids=nzgd2kgrid0005
Rel. 4.4.9, 29 Oct 2004
<cs2cs>:
projection initialization failure
cause: unknown elliptical parameter name
program abnormally terminated

Tried upper and lower case NZGD2000, NZGD49, NZMG, latlong, longlat, without
nadgrids???
Do I have to add an ellipsoid to the projection definitions for cs2cs?

The grid shift file does not appear to mentioned in any of the files in
/usr/local/share/proj is that normal?

Some pointers would be appreciated.

Simon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060517/f02e1457/attachment.html>

From AnthonyD at rocketmail.com  Tue May 16 22:15:21 2006
From: AnthonyD at rocketmail.com (Anthony Dunk)
Date: Tue, 16 May 2006 22:15:21 -0700 (PDT)
Subject: [Proj] NZGD2000 to NZGD49
In-Reply-To: <e3a3ae450605162149n7f5a3d1dnc54c76509bc0edd4@mail.gmail.com>
Message-ID: <20060517051521.49174.qmail@web50814.mail.yahoo.com>

Hi Simon,

I think the problem is that NZ datums are not defined in PROJ (I found
the same was true of Australian datums). You will need to provide the
ellipsoid parameters for these datums instead. i.e. +a=6378388.0
+rf=297.0 for NZGD49 and +a=6378137.0 +rf=298.257222 for NZGD2000.

So, to convert from NZGD200 Lat/Lon to NZGD49 Lat/Lon try this:

cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=latlong
+a=6378388.0 +rf=297.0 +nadgrids=nzgd2kgrid0005 

Anthony.

--- Simon O'Malley <simonom at gmail.com> wrote:

> Hi
> 
> I am trying to test the datum shift (using nzgd2kgrid0005.gsb file)
> for
> conversions between NZGD2000 and NZGD49(NZMG).
> 
> I have downloaded the proj-datumgrid-1.3.zip file, and extracted
> everything
> under the nad directory.
> 
> configured, make, and make install. However the gsb file does not get
> copied
> to /usr/local/share/proj
> 
> I copied it across but postgis does not appear to use it i.e. my
> transformed
> coordinates are not correct, as verified by the linz website and
> other
> software that uses the grid file.
> 
> I then tried to use cs2cs to validate it but all attempts at
> specifying the
> projections and datums gave me errors.
> 
> I have tried multiple versions of:
> 
> cs2cs +proj=latlong +datum=nzgd2000 +nadgrids=nzgd2kgrid0005 +to
> +proj=nzmg
> +datum=nzgd49
> 
> After setting PROJ_DEBUG I get:
> 
> pj_open_lib(proj_def.dat): call
> fopen(/usr/local/share/proj/proj_def.dat) -
> succeeded
> Using from definition: proj=latlong datum=nzgd2000
> nadgrids=nzgd2kgrid0005
> Rel. 4.4.9, 29 Oct 2004
> <cs2cs>:
> projection initialization failure
> cause: unknown elliptical parameter name
> program abnormally terminated
> 
> Tried upper and lower case NZGD2000, NZGD49, NZMG, latlong, longlat,
> without
> nadgrids???
> Do I have to add an ellipsoid to the projection definitions for
> cs2cs?
> 
> The grid shift file does not appear to mentioned in any of the files
> in
> /usr/local/share/proj is that normal?
> 
> Some pointers would be appreciated.
> 
> Simon
> > _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj




__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From simonom at gmail.com  Tue May 16 23:51:36 2006
From: simonom at gmail.com (Simon O'Malley)
Date: Wed, 17 May 2006 18:51:36 +1200
Subject: [Proj] NZGD2000 to NZGD49
In-Reply-To: <20060517051521.49174.qmail@web50814.mail.yahoo.com>
References: <e3a3ae450605162149n7f5a3d1dnc54c76509bc0edd4@mail.gmail.com>
	<20060517051521.49174.qmail@web50814.mail.yahoo.com>
Message-ID: <e3a3ae450605162351y7ddeb880wb28bc759e01b255a@mail.gmail.com>

Hi Anthony

Thanks for the tips.

I checked the epsg file and also read the man page for cs2cs which I should
have done first.

Using cs2cs -lp and -ld showed that nzgd49 and nzmg were available but
nzgd2000 was conspicuous by it's absence.

The epsg file had  the following for nzgd2000:

+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs

So I then tried the following:

cs2cs +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs +to
+proj=nzmg +datum=nzgd49 +nadgrids=nzgd2kgrid0005

Which seemed to work (the first set of coordinates entered get droppped, but
I think I saw a bug logged for that already).

Using the following coordinates:

175.232739997 -37.3476467750

Gave me:

2708093.01      6425845.96

Whereas the LINZ site (
http://www.linz.govt.nz/rcs/linz/pub/web/root/core/SurveySystem/GeodeticInfo/CoordinateConversions/coordinateconversions/index.jsp

Gave me the following for the conversion:

175.232739997 -37.347646775         2708091.7091 6425845.7365

Which is 2 meters different in the x coordinate.

I then set PROJ_DEBUG to see what was going on and it said it couldn't open
/usr/local/share/proj/nzgd2kgrid0005, so I changed the command to add in the
.gsb on the end and got the correct answer (saw somehwre on the net with the
.gsb dropped off so incorrectly thought it was not needed).

cs2cs +proj=longlat +ellps=GRS80 +a=6378137 +rf=298.257222101 +to +proj=nzmg
+datum=nzgd49 +nadgrids=nzgd2kgrid0005.gsb
pj_open_lib(proj_def.dat): call fopen(/usr/local/share/proj/proj_def.dat) -
succeeded
pj_open_lib(proj_def.dat): call fopen(/usr/local/share/proj/proj_def.dat) -
succeeded

pj_open_lib(nzgd2kgrid0005.gsb): call
fopen(/usr/local/share/proj/nzgd2kgrid0005.gsb) - succeeded
NTv2 NZNAT    141x141: LL=(166,-48) UR=(180,-34)
pj_apply_gridshift(): failed to find a grid shift table for
                      location (0.0000000dW,0.0000000dN)
   tried: nzgd2kgrid0005.gsb
*       * 0.00
175.232739997 -37.3476467750
NTv2 - loading grid NZNAT
pj_open_lib(nzgd2kgrid0005.gsb): call
fopen(/usr/local/share/proj/nzgd2kgrid0005.gsb) - succeeded
pj_apply_gridshift(): used NZNAT
2708091.71      6425845.74 -0.00

Success, thank you.

I mainly use postgres and have data stored in NZGD2000/latlong(SRID=4167),
which I need to convert to  NZMG (SRID=27200)

How do I set up proj so that it uses the grid shift for this transform. Do I
have to add something somewhere to make it use it?
Postgres doco states if it is there it will use it but how???? cs2cs had a
lot of trouble, and using transform in postgres gives the same result as
cs2cs not finding the gsb file.

Simon

On 5/17/06, Anthony Dunk <AnthonyD at rocketmail.com> wrote:
>
> Hi Simon,
>
> I think the problem is that NZ datums are not defined in PROJ (I found
> the same was true of Australian datums). You will need to provide the
> ellipsoid parameters for these datums instead. i.e. +a=6378388.0
> +rf=297.0 for NZGD49 and +a=6378137.0 +rf=298.257222 for NZGD2000.
>
> So, to convert from NZGD200 Lat/Lon to NZGD49 Lat/Lon try this:
>
> cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=latlong
> +a=6378388.0 +rf=297.0 +nadgrids=nzgd2kgrid0005
>
> Anthony.
>
> --- Simon O'Malley <simonom at gmail.com> wrote:
>
> > Hi
> >
> > I am trying to test the datum shift (using nzgd2kgrid0005.gsb file)
> > for
> > conversions between NZGD2000 and NZGD49(NZMG).
> >
> > I have downloaded the proj-datumgrid-1.3.zip file, and extracted
> > everything
> > under the nad directory.
> >
> > configured, make, and make install. However the gsb file does not get
> > copied
> > to /usr/local/share/proj
> >
> > I copied it across but postgis does not appear to use it i.e. my
> > transformed
> > coordinates are not correct, as verified by the linz website and
> > other
> > software that uses the grid file.
> >
> > I then tried to use cs2cs to validate it but all attempts at
> > specifying the
> > projections and datums gave me errors.
> >
> > I have tried multiple versions of:
> >
> > cs2cs +proj=latlong +datum=nzgd2000 +nadgrids=nzgd2kgrid0005 +to
> > +proj=nzmg
> > +datum=nzgd49
> >
> > After setting PROJ_DEBUG I get:
> >
> > pj_open_lib(proj_def.dat): call
> > fopen(/usr/local/share/proj/proj_def.dat) -
> > succeeded
> > Using from definition: proj=latlong datum=nzgd2000
> > nadgrids=nzgd2kgrid0005
> > Rel. 4.4.9, 29 Oct 2004
> > <cs2cs>:
> > projection initialization failure
> > cause: unknown elliptical parameter name
> > program abnormally terminated
> >
> > Tried upper and lower case NZGD2000, NZGD49, NZMG, latlong, longlat,
> > without
> > nadgrids???
> > Do I have to add an ellipsoid to the projection definitions for
> > cs2cs?
> >
> > The grid shift file does not appear to mentioned in any of the files
> > in
> > /usr/local/share/proj is that normal?
> >
> > Some pointers would be appreciated.
> >
> > Simon
> > > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
>
>
>
>
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around
> http://mail.yahoo.com
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060517/eb39d7c1/attachment.html>

From AnthonyD at rocketmail.com  Wed May 17 00:06:39 2006
From: AnthonyD at rocketmail.com (Anthony Dunk)
Date: Wed, 17 May 2006 00:06:39 -0700 (PDT)
Subject: [Proj] NZGD2000 to NZGD49
In-Reply-To: <e3a3ae450605162351y7ddeb880wb28bc759e01b255a@mail.gmail.com>
Message-ID: <20060517070639.89923.qmail@web50812.mail.yahoo.com>

Hi Simon,

I'm glad my email was of some help. I forgot to mention you should
include the ".gsb" on the end of the grid file name though.

I am no familiar with postgres, but the way the PROJ library finds the
grid shift files is by looking in the folder pointed to by the PROJ_LIB
environment variable if this is set. Otherwise it looks in a default
directory which is precompiled in - and varies depending on the build.

So, I suggest you try setting PROJ_LIB to the directory where your grid
shift files live and see if that works for you.

Anthony.

--- Simon O'Malley <simonom at gmail.com> wrote:

> Hi Anthony
> 
> Thanks for the tips.
> 
> I checked the epsg file and also read the man page for cs2cs which I
> should
> have done first.
> 
> Using cs2cs -lp and -ld showed that nzgd49 and nzmg were available
> but
> nzgd2000 was conspicuous by it's absence.
> 
> The epsg file had  the following for nzgd2000:
> 
> +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs
> 
> So I then tried the following:
> 
> cs2cs +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs +to
> +proj=nzmg +datum=nzgd49 +nadgrids=nzgd2kgrid0005
> 
> Which seemed to work (the first set of coordinates entered get
> droppped, but
> I think I saw a bug logged for that already).
> 
> Using the following coordinates:
> 
> 175.232739997 -37.3476467750
> 
> Gave me:
> 
> 2708093.01      6425845.96
> 
> Whereas the LINZ site (
>
http://www.linz.govt.nz/rcs/linz/pub/web/root/core/SurveySystem/GeodeticInfo/CoordinateConversions/coordinateconversions/index.jsp
> 
> Gave me the following for the conversion:
> 
> 175.232739997 -37.347646775         2708091.7091 6425845.7365
> 
> Which is 2 meters different in the x coordinate.
> 
> I then set PROJ_DEBUG to see what was going on and it said it
> couldn't open
> /usr/local/share/proj/nzgd2kgrid0005, so I changed the command to add
> in the
> .gsb on the end and got the correct answer (saw somehwre on the net
> with the
> .gsb dropped off so incorrectly thought it was not needed).
> 
> cs2cs +proj=longlat +ellps=GRS80 +a=6378137 +rf=298.257222101 +to
> +proj=nzmg
> +datum=nzgd49 +nadgrids=nzgd2kgrid0005.gsb
> pj_open_lib(proj_def.dat): call
> fopen(/usr/local/share/proj/proj_def.dat) -
> succeeded
> pj_open_lib(proj_def.dat): call
> fopen(/usr/local/share/proj/proj_def.dat) -
> succeeded
> 
> pj_open_lib(nzgd2kgrid0005.gsb): call
> fopen(/usr/local/share/proj/nzgd2kgrid0005.gsb) - succeeded
> NTv2 NZNAT    141x141: LL=(166,-48) UR=(180,-34)
> pj_apply_gridshift(): failed to find a grid shift table for
>                       location (0.0000000dW,0.0000000dN)
>    tried: nzgd2kgrid0005.gsb
> *       * 0.00
> 175.232739997 -37.3476467750
> NTv2 - loading grid NZNAT
> pj_open_lib(nzgd2kgrid0005.gsb): call
> fopen(/usr/local/share/proj/nzgd2kgrid0005.gsb) - succeeded
> pj_apply_gridshift(): used NZNAT
> 2708091.71      6425845.74 -0.00
> 
> Success, thank you.
> 
> I mainly use postgres and have data stored in
> NZGD2000/latlong(SRID=4167),
> which I need to convert to  NZMG (SRID=27200)
> 
> How do I set up proj so that it uses the grid shift for this
> transform. Do I
> have to add something somewhere to make it use it?
> Postgres doco states if it is there it will use it but how???? cs2cs
> had a
> lot of trouble, and using transform in postgres gives the same result
> as
> cs2cs not finding the gsb file.
> 
> Simon
> 
> On 5/17/06, Anthony Dunk <AnthonyD at rocketmail.com> wrote:
> >
> > Hi Simon,
> >
> > I think the problem is that NZ datums are not defined in PROJ (I
> found
> > the same was true of Australian datums). You will need to provide
> the
> > ellipsoid parameters for these datums instead. i.e. +a=6378388.0
> > +rf=297.0 for NZGD49 and +a=6378137.0 +rf=298.257222 for NZGD2000.
> >
> > So, to convert from NZGD200 Lat/Lon to NZGD49 Lat/Lon try this:
> >
> > cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=latlong
> > +a=6378388.0 +rf=297.0 +nadgrids=nzgd2kgrid0005
> >
> > Anthony.
> >
> > --- Simon O'Malley <simonom at gmail.com> wrote:
> >
> > > Hi
> > >
> > > I am trying to test the datum shift (using nzgd2kgrid0005.gsb
> file)
> > > for
> > > conversions between NZGD2000 and NZGD49(NZMG).
> > >
> > > I have downloaded the proj-datumgrid-1.3.zip file, and extracted
> > > everything
> > > under the nad directory.
> > >
> > > configured, make, and make install. However the gsb file does not
> get
> > > copied
> > > to /usr/local/share/proj
> > >
> > > I copied it across but postgis does not appear to use it i.e. my
> > > transformed
> > > coordinates are not correct, as verified by the linz website and
> > > other
> > > software that uses the grid file.
> > >
> > > I then tried to use cs2cs to validate it but all attempts at
> > > specifying the
> > > projections and datums gave me errors.
> > >
> > > I have tried multiple versions of:
> > >
> > > cs2cs +proj=latlong +datum=nzgd2000 +nadgrids=nzgd2kgrid0005 +to
> > > +proj=nzmg
> > > +datum=nzgd49
> > >
> > > After setting PROJ_DEBUG I get:
> > >
> > > pj_open_lib(proj_def.dat): call
> > > fopen(/usr/local/share/proj/proj_def.dat) -
> > > succeeded
> > > Using from definition: proj=latlong datum=nzgd2000
> > > nadgrids=nzgd2kgrid0005
> > > Rel. 4.4.9, 29 Oct 2004
> > > <cs2cs>:
> > > projection initialization failure
> > > cause: unknown elliptical parameter name
> > > program abnormally terminated
> > >
> > > Tried upper and lower case NZGD2000, NZGD49, NZMG, latlong,
> longlat,
> > > without
> > > nadgrids???
> > > Do I have to add an ellipsoid to the projection definitions for
> > > cs2cs?
> > >
> > > The grid shift file does not appear to mentioned in any of the
> files
> > > in
> > > /usr/local/share/proj is that normal?
> > >
> > > Some pointers would be appreciated.
> > >
> > > Simon
> > > > _______________________________________________
> > > Proj mailing list
> > > Proj at lists.maptools.org
> > > http://lists.maptools.org/mailman/listinfo/proj
> >
> >
> >
> >
> > __________________________________________________
> > Do You Yahoo!?
> > Tired of spam?  Yahoo! Mail has the best spam protection around
> > http://mail.yahoo.com
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> >
> > _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj




__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From hamish_nospam at yahoo.com  Wed May 17 01:41:10 2006
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed, 17 May 2006 20:41:10 +1200
Subject: [Proj] NZGD2000 to NZGD49
In-Reply-To: <20060517070639.89923.qmail@web50812.mail.yahoo.com>
References: <e3a3ae450605162351y7ddeb880wb28bc759e01b255a@mail.gmail.com>
	<20060517070639.89923.qmail@web50812.mail.yahoo.com>
Message-ID: <20060517204110.64296e34.hamish_nospam@yahoo.com>

> I am trying to test the datum shift (using nzgd2kgrid0005.gsb file)
> for conversions between NZGD2000 and NZGD49(NZMG).


Greetings from Dunedin,

I use PROJ transforms of NZGD2k+NZTM, NZGD49+NZMG, and LatLon WGS84
almost every day- have been doing so since we worked this all out for
GRASS GIS about 2 years ago. nzgd2k and nzgd49 are defined in GRASS as
datums for setting up new locations. If you try GRASS 6.1 I recommend
the "m.proj" module as a simple frontend to cs2cs to automatically set
up the +proj parms.


NZGD2k is pretty much just WGS84 with a slightly different flattening
parm, only difference will be about 10cm in the vertical, IIRC.
The filename of the grid file reminds me that it is really for NZGD49->
NZGD2k, not WGS84, but as above this doesn't really matter.

NZGD49 will need to use the NTv2 .gsb transform grid to get within about
10-30cm horizontal accuracy*. The 7 term +towgs84 transform will get you
within approx 4m. If you use the 3 term +towgs84 it will be even worse.
If you fail to define a datum for NZMG, it will be about 150m off.
Mind that some of the terms in the 7-term list may be negative vs. LINZ
published values; this is because a different convention is used. Also
note the NTv2 .gsb grid doesn't extend very far off-shore.

[*] That is until earthquakes like today's move the plates about!
      http://earthquake.usgs.gov/eqcenter/recenteqsww/
    But less than 1m for NZMG is non-meaningful anyway.

put the grid file in with the other ones in /usr/share/proj/ or local
equivalent.



PROJ.4 parms:
 (from GRASS's `g.proj -jf`, [latlong swapped, mind the x,y input order!])


NZGD2k + lat/lon:
+proj=longlat +a=6378137 +rf=298.257222101 +no_defs +towgs84=0.000,0.000,0.000

NZGD2k + NZTM:
+proj=tmerc +lat_0=0.0000000000 +lon_0=173.0000000000 +k_0=0.9996000000 +x_0=1600000.0000000000 +y_0=10000000.0000000000 +a=6378137 +rf=298.257222101 +no_defs +towgs84=0.000,0.000,0.000


NZGD49 + NZMG: (NTv2 grid)
+proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs +nadgrids=nzgd2kgrid0005.gsb

NZGD49 + NZMG: (7parm)
+proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs +towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993

NZGD49 + NZMG: (3parm)
+proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs +towgs84=54.400,-20.100,183.100



Proj 	Datum 	EPSG Code
NZMG 	NZGD49 	27200
NZTM 	NZGD2k 	2193
Lat/Lon WGS84 	4326



luck,
Hamish


From zhonghaiw at gmail.com  Wed May 17 05:34:24 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed, 17 May 2006 14:34:24 +0200
Subject: [Proj] reproject batch command
Message-ID: <2534c4120605170534h29172d11p48d32083ed3c5dbe@mail.gmail.com>

Hi All,

I have a subfolder with ESRI shapefiles, and now I want to reproject the
shapefile, are there any batch commands to do this?

thanks in advance

zhonghai

17.05.2006
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060517/78017db0/attachment.html>

From EMiller at dfg.ca.gov  Wed May 17 08:08:53 2006
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Wed, 17 May 2006 08:08:53 -0700
Subject: [Proj] reproject batch command
Message-ID: <s46ada25.073@dfg.ca.gov>

In the contrib directory for Frank's shapelib is a utility called "shpproj" which supposedly will reproject a single shapefile.  You'd have to build it; the "shpproj.c" file has a command line for GCC in the comments near the top.  To batch it, you'd need to write a shell script or some other kind of script.  No idea if the program works correctly...

>>> zhonghaiw at gmail.com 5/17/2006 5:34 AM >>>
Hi All,

I have a subfolder with ESRI shapefiles, and now I want to reproject the
shapefile, are there any batch commands to do this?

thanks in advance

zhonghai

17.05.2006




From werchowyna at epf.pl  Wed May 17 15:01:11 2006
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Thu, 18 May 2006 00:01:11 +0200
Subject: [Proj] reproject batch command
In-Reply-To: <2534c4120605170534h29172d11p48d32083ed3c5dbe@mail.gmail.com>
References: <2534c4120605170534h29172d11p48d32083ed3c5dbe@mail.gmail.com>
Message-ID: <20060518000111.a7c3199d.werchowyna@epf.pl>

On Wed, 17 May 2006 14:34:24 +0200
"Zhonghai Wang" <zhonghaiw at gmail.com> wrote:

> Hi All,
> 
> I have a subfolder with ESRI shapefiles, and now I want to reproject
> the shapefile, are there any batch commands to do this?
> 
> thanks in advance
> 
> zhonghai
> 
> 17.05.2006

If on unix+bash, something like this will work (modify accordingly):

#!/bin/bash

LISTA=$(ls $HOME/gis/dane/pani/mapy | grep -i ".shp")

for PLIK in $LISTA;
do

echo
echo Konwertuje plik: $PLIK
PLIK_LOW=`echo $PLIK | tr A-Z a-z`

ogr2ogr -s_srs epsg:2180 -t_srs epsg:32633
$HOME/tmp/hydro_ds_shp/$PLIK_LOW $PLIK

done

--------------------
W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko najlepsze z nich!
http://katalog.panoramainternetu.pl/



From simonom at gmail.com  Wed May 17 16:00:57 2006
From: simonom at gmail.com (Simon O'Malley)
Date: Thu, 18 May 2006 11:00:57 +1200
Subject: [Proj] NZGD2000 to NZGD49
In-Reply-To: <20060517204110.64296e34.hamish_nospam@yahoo.com>
References: <e3a3ae450605162351y7ddeb880wb28bc759e01b255a@mail.gmail.com>
	<20060517070639.89923.qmail@web50812.mail.yahoo.com>
	<20060517204110.64296e34.hamish_nospam@yahoo.com>
Message-ID: <e3a3ae450605171600j2670ccedme33a7a138a3fd3cf@mail.gmail.com>

Hi Hamish

Thanks for the info.

Haven't used grass in ages but should have another look.

I updated the projection definition in postgis to contain the gsb file and
it all works fine now. One thing crossed off the list.

Simon





On 5/17/06, Hamish <hamish_nospam at yahoo.com> wrote:
>
> > I am trying to test the datum shift (using nzgd2kgrid0005.gsb file)
> > for conversions between NZGD2000 and NZGD49(NZMG).
>
>
> Greetings from Dunedin,
>
> I use PROJ transforms of NZGD2k+NZTM, NZGD49+NZMG, and LatLon WGS84
> almost every day- have been doing so since we worked this all out for
> GRASS GIS about 2 years ago. nzgd2k and nzgd49 are defined in GRASS as
> datums for setting up new locations. If you try GRASS 6.1 I recommend
> the "m.proj" module as a simple frontend to cs2cs to automatically set
> up the +proj parms.
>
>
> NZGD2k is pretty much just WGS84 with a slightly different flattening
> parm, only difference will be about 10cm in the vertical, IIRC.
> The filename of the grid file reminds me that it is really for NZGD49->
> NZGD2k, not WGS84, but as above this doesn't really matter.
>
> NZGD49 will need to use the NTv2 .gsb transform grid to get within about
> 10-30cm horizontal accuracy*. The 7 term +towgs84 transform will get you
> within approx 4m. If you use the 3 term +towgs84 it will be even worse.
> If you fail to define a datum for NZMG, it will be about 150m off.
> Mind that some of the terms in the 7-term list may be negative vs. LINZ
> published values; this is because a different convention is used. Also
> note the NTv2 .gsb grid doesn't extend very far off-shore.
>
> [*] That is until earthquakes like today's move the plates about!
>       http://earthquake.usgs.gov/eqcenter/recenteqsww/
>     But less than 1m for NZMG is non-meaningful anyway.
>
> put the grid file in with the other ones in /usr/share/proj/ or local
> equivalent.
>
>
>
> PROJ.4 parms:
> (from GRASS's `g.proj -jf`, [latlong swapped, mind the x,y input order!])
>
>
> NZGD2k + lat/lon:
> +proj=longlat +a=6378137 +rf=298.257222101 +no_defs +towgs84=0.000,0.000,
> 0.000
>
> NZGD2k + NZTM:
> +proj=tmerc +lat_0=0.0000000000 +lon_0=173.0000000000 +k_0=0.9996000000+x_0=
> 1600000.0000000000 +y_0=10000000.0000000000 +a=6378137 +rf=298.257222101+no_defs +towgs84=
> 0.000,0.000,0.000
>
>
> NZGD49 + NZMG: (NTv2 grid)
> +proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=
> 2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs
> +nadgrids=nzgd2kgrid0005.gsb
>
> NZGD49 + NZMG: (7parm)
> +proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=
> 2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs
> +towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993
>
> NZGD49 + NZMG: (3parm)
> +proj=nzmg +lat_0=-41.0000000000 +lon_0=173.0000000000 +x_0=
> 2510000.0000000000 +y_0=6023150.0000000000 +a=6378388 +rf=297 +no_defs
> +towgs84=54.400,-20.100,183.100
>
>
>
> Proj    Datum   EPSG Code
> NZMG    NZGD49  27200
> NZTM    NZGD2k  2193
> Lat/Lon WGS84   4326
>
>
>
> luck,
> Hamish
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060518/5c0b887f/attachment.html>

From maovieira at gmail.com  Thu May 18 05:55:59 2006
From: maovieira at gmail.com (marco vieira)
Date: Thu, 18 May 2006 09:55:59 -0300
Subject: [Proj] reproject batch command
In-Reply-To: <20060518000111.a7c3199d.werchowyna@epf.pl>
References: <2534c4120605170534h29172d11p48d32083ed3c5dbe@mail.gmail.com>
	<20060518000111.a7c3199d.werchowyna@epf.pl>
Message-ID: <5becacd20605180555g3e79a0bame47ac1a2464b33b5@mail.gmail.com>

Also you can do it on unix+bash by one command line:
find . -name "*.shp" -maxdepth 1 -exec ogr2ogr -s_srs epsg:2180 -t_srs
epsg:32633 ../dest/{} {} \;

In window$ you can use this commands with the package
http://unxutils.sourceforge.net/ + FWtools

Regards.
-- 
Marco Vieira
+55 21 9499-6800
e-mail: maovieira at gmail.com

2006/5/17, Maciek Sieczka <werchowyna at epf.pl>:
>
> On Wed, 17 May 2006 14:34:24 +0200
> "Zhonghai Wang" <zhonghaiw at gmail.com> wrote:
>
> > Hi All,
> >
> > I have a subfolder with ESRI shapefiles, and now I want to reproject
> > the shapefile, are there any batch commands to do this?
> >
> > thanks in advance
> >
> > zhonghai
> >
> > 17.05.2006
>
> If on unix+bash, something like this will work (modify accordingly):
>
> #!/bin/bash
>
> LISTA=$(ls $HOME/gis/dane/pani/mapy | grep -i ".shp")
>
> for PLIK in $LISTA;
> do
>
> echo
> echo Konwertuje plik: $PLIK
> PLIK_LOW=`echo $PLIK | tr A-Z a-z`
>
> ogr2ogr -s_srs epsg:2180 -t_srs epsg:32633
> $HOME/tmp/hydro_ds_shp/$PLIK_LOW $PLIK
>
> done
>
> --------------------
> W polskim Internecie s? setki milion?w stron. My przekazujemy Tobie tylko
> najlepsze z nich!
> http://katalog.panoramainternetu.pl/
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20060518/fce243e5/attachment.html>

From warmerdam at pobox.com  Thu May 18 07:16:36 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 18 May 2006 10:16:36 -0400
Subject: [Proj] PROJ.4
In-Reply-To: <f50f761f0605161245i8455372yd8d40d6b302c5a7@mail.gmail.com>
References: <f50f761f0605161245i8455372yd8d40d6b302c5a7@mail.gmail.com>
Message-ID: <446C81C4.7060501@pobox.com>

Sergio Orlando Antoun Netto wrote:
>  
> My name is Sergio. I'm brasilian student (MSc) of Rio de Janeiro State 
> University (UERJ). I want to know how can I add a new projection, 
> ellipsoid and datum in Proj.4 library?

Sergio,

New projection methods are somewhat involved to add.  If you feel you
must, then look at the many existing examples, and try to replicate
them sensibly.

New ellipsoid names can be added in src/pj_ellps.c.

New datum names can be added pj_datums.c.

Note that new ellipsoids and datums are just defined in terms of the
low level directives such as +a, +b, +towgs84 and so forth.  So there is
generally no critical need to define an associated name in order to use
particular ellipsoids and datums.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org



From AnthonyD at rocketmail.com  Thu May 18 17:42:12 2006
From: AnthonyD at rocketmail.com (Anthony Dunk)
Date: Thu, 18 May 2006 17:42:12 -0700 (PDT)
Subject: [Proj] Still trying to get SPCS Alaska Zone 1 working!
Message-ID: <20060519004212.19913.qmail@web50814.mail.yahoo.com>

Hi,

Can anyone explain to me why the US Govt document on NAD83 State Plane
Coordinate System (see link below) says that the origin for Alaska Zone
1 is lat=57N lon=133'40W or Easting=5,000,000, Northing=-5,000,000, but
when I run the Corpscon program with the appropriate setup it projects
this lat/lon to Easting=818676.713, Northing=575097.689 ? I also found
that MapInfo projects it to exactly the same Easting/Northing as
Corpscon.

If I use PROJ's cs2cs command (Rel 4.4.7 31 March 2003) to convert
these lat/lon coordinates using the following command:

cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
+lonc=-133.6666666667 +lat_0=57 +alpha=-36.8698976458 +k=0.9999
+x_0=5000000 +y_0=-5000000  +a=6378137 +rf=298.257222101

Then I get Easting=4999999.80 Northing=-5000000.0.

So, the PROJ command gives results which agree with the NAD83 SPCS
document, but both Corpscon and MapInfo give a consistent but different
result. What is going on, and who is correct ??!

Thanks,
Anthony.

NAD83 SPCS document:
http://www.ngs.noaa.gov/PUBS_LIB/ManualNOSNGS5.pdf



__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From AnthonyD at rocketmail.com  Thu May 18 20:02:19 2006
From: AnthonyD at rocketmail.com (Anthony Dunk)
Date: Thu, 18 May 2006 20:02:19 -0700 (PDT)
Subject: [Proj] Still trying to get SPCS Alaska Zone 1 working!
In-Reply-To: <20060519004212.19913.qmail@web50814.mail.yahoo.com>
Message-ID: <20060519030219.43553.qmail@web50813.mail.yahoo.com>


I found the answer to my own question - finally...

I found that I needed to add the +no_uoff parameter to get the same
results as Corpscon and Mapinfo.

The new command string is:

cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
+a=6378137.0 +rf=298.257222 +lat_0=57d00'00.000N +lonc=133d40'00.000W
+alpha=-36.8698976458 +k_0=0.9999 +no_uoff +x_0=5000000 +y_0=-5000000

If I enter lon=133d40'00.000"W and lat=57N, now I get Easting=818676.73
and Northing=575097.69.

According to one of Gerald Evenden's documents "In some cases, an
offset in the pre-rotated axis may need to be suppressed with the
+no_uoff option.". Its gobbledegook to me - but hey it works!

Anthony.


--- Anthony Dunk <AnthonyD at rocketmail.com> wrote:

> Hi,
> 
> Can anyone explain to me why the US Govt document on NAD83 State
> Plane
> Coordinate System (see link below) says that the origin for Alaska
> Zone
> 1 is lat=57N lon=133'40W or Easting=5,000,000, Northing=-5,000,000,
> but
> when I run the Corpscon program with the appropriate setup it
> projects
> this lat/lon to Easting=818676.713, Northing=575097.689 ? I also
> found
> that MapInfo projects it to exactly the same Easting/Northing as
> Corpscon.
> 
> If I use PROJ's cs2cs command (Rel 4.4.7 31 March 2003) to convert
> these lat/lon coordinates using the following command:
> 
> cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
> +lonc=-133.6666666667 +lat_0=57 +alpha=-36.8698976458 +k=0.9999
> +x_0=5000000 +y_0=-5000000  +a=6378137 +rf=298.257222101
> 
> Then I get Easting=4999999.80 Northing=-5000000.0.
> 
> So, the PROJ command gives results which agree with the NAD83 SPCS
> document, but both Corpscon and MapInfo give a consistent but
> different
> result. What is going on, and who is correct ??!
> 
> Thanks,
> Anthony.
> 
> NAD83 SPCS document:
> http://www.ngs.noaa.gov/PUBS_LIB/ManualNOSNGS5.pdf
> 
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around 
> http://mail.yahoo.com 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 




__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From gerald.evenden at verizon.net  Fri May 19 06:56:25 2006
From: gerald.evenden at verizon.net (Gerald I. Evenden)
Date: Fri, 19 May 2006 09:56:25 -0400
Subject: [Proj] Still trying to get SPCS Alaska Zone 1 working!
In-Reply-To: <20060519030219.43553.qmail@web50813.mail.yahoo.com>
References: <20060519030219.43553.qmail@web50813.mail.yahoo.com>
Message-ID: <200605190956.25978.gerald.evenden@verizon.net>

Hey. its all gobblydegook to me too.  Omerc is the most messed up
projection alive and each CS has their own little "twist."  I tried to embrace
the plethora of variations with the several "switches" within omerc.

Blame Hotine.  ;-)

On Thursday 18 May 2006 11:02 pm, Anthony Dunk wrote:
> I found the answer to my own question - finally...
>
> I found that I needed to add the +no_uoff parameter to get the same
> results as Corpscon and Mapinfo.
>
> The new command string is:
>
> cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
> +a=6378137.0 +rf=298.257222 +lat_0=57d00'00.000N +lonc=133d40'00.000W
> +alpha=-36.8698976458 +k_0=0.9999 +no_uoff +x_0=5000000 +y_0=-5000000
>
> If I enter lon=133d40'00.000"W and lat=57N, now I get Easting=818676.73
> and Northing=575097.69.
>
> According to one of Gerald Evenden's documents "In some cases, an
> offset in the pre-rotated axis may need to be suppressed with the
> +no_uoff option.". Its gobbledegook to me - but hey it works!
>
> Anthony.
>
> --- Anthony Dunk <AnthonyD at rocketmail.com> wrote:
> > Hi,
> >
> > Can anyone explain to me why the US Govt document on NAD83 State
> > Plane
> > Coordinate System (see link below) says that the origin for Alaska
> > Zone
> > 1 is lat=57N lon=133'40W or Easting=5,000,000, Northing=-5,000,000,
> > but
> > when I run the Corpscon program with the appropriate setup it
> > projects
> > this lat/lon to Easting=818676.713, Northing=575097.689 ? I also
> > found
> > that MapInfo projects it to exactly the same Easting/Northing as
> > Corpscon.
> >
> > If I use PROJ's cs2cs command (Rel 4.4.7 31 March 2003) to convert
> > these lat/lon coordinates using the following command:
> >
> > cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
> > +lonc=-133.6666666667 +lat_0=57 +alpha=-36.8698976458 +k=0.9999
> > +x_0=5000000 +y_0=-5000000  +a=6378137 +rf=298.257222101
> >
> > Then I get Easting=4999999.80 Northing=-5000000.0.
> >
> > So, the PROJ command gives results which agree with the NAD83 SPCS
> > document, but both Corpscon and MapInfo give a consistent but
> > different
> > result. What is going on, and who is correct ??!
> >
> > Thanks,
> > Anthony.
> >
> > NAD83 SPCS document:
> > http://www.ngs.noaa.gov/PUBS_LIB/ManualNOSNGS5.pdf
> >
> >
> >
> > __________________________________________________
> > Do You Yahoo!?
> > Tired of spam?  Yahoo! Mail has the best spam protection around
> > http://mail.yahoo.com
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
>
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around
> http://mail.yahoo.com
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-- 
Jerry and the low-riders: Daisy Mae and Joshua
"Cogito cogito ergo cogito sum"
   Ambrose Bierce, The Devil's Dictionary


From adrian.holovaty at wpni.com  Fri May 19 11:04:04 2006
From: adrian.holovaty at wpni.com (Adrian Holovaty)
Date: Fri, 19 May 2006 13:04:04 -0500
Subject: [Proj] Error compiling proj on Solaris: Undefined symbol
Message-ID: <200605191304.04537.adrian.holovaty@wpni.com>

Hello,

I'm trying to install proj on Solaris so I can use it with PostGIS, but it 
won't compile. Here's the relevant error I get when I run "make".

================================

gcc -g -O2 -o .libs/proj proj.o gen_cheb.o p_series.o  ./.libs/libproj.so -lm 
-R/usr/local/lib
Undefined                       first referenced
 symbol                             in file
.LLC4                               ./.libs/libproj.so
.LLC8                               ./.libs/libproj.so
ld: fatal: Symbol referencing errors. No output written to .libs/proj
collect2: ld returned 1 exit status
make[2]: *** [proj] Error 1
make[2]: Leaving directory `/home/holovatya/proj-4.4.9/src'
make[1]: *** [all] Error 2
make[1]: Leaving directory `/home/holovatya/proj-4.4.9/src'
make: *** [all-recursive] Error 1

================================

The same error has been pointed out here:

    http://lists.maptools.org/pipermail/proj/2006-April/002193.html
    http://lists.maptools.org/pipermail/proj/2006-February/002090.html

Those threads suggested a couple of solutions, all of which I've tried.

I've tried removing the C_NAMESPACE qualifiers, as suggested here:

    http://bugzilla.remotesensing.org/show_bug.cgi?id=298#c4

I've tried setting CFLAGS, as suggested here:

    http://bugzilla.remotesensing.org/show_bug.cgi?id=298#c6

I've tried using a custom version of libtool, as suggested here:

    http://lists.maptools.org/pipermail/proj/2006-February/002093.html

The same compilation error happens every time with each of those suggested 
fixes.

I'm using:

    proj 4.4.9
    Solaris 9
    GCC 3.2
    make 3.80

Please help me get proj to compile. Thanks for any and all help, and let me 
know if I left any important information out of this report.

Adrian

-- 
Adrian Holovaty
washingtonpost.com


From mkennedy2 at earthlink.net  Fri May 19 16:56:15 2006
From: mkennedy2 at earthlink.net (Melita Kennedy)
Date: Fri, 19 May 2006 19:56:15 -0400 (EDT)
Subject: [Proj] Re: Still trying to get SPCS Alaska Zone 1 working!
Message-ID: <26817278.1148082975986.JavaMail.root@elwamui-hybrid.atl.sa.earthlink.net>


>Date: Thu, 18 May 2006 17:42:12 -0700 (PDT)
>From: Anthony Dunk <AnthonyD at rocketmail.com>
>Subject: [Proj] Still trying to get SPCS Alaska Zone 1 working!
>To: Proj at lists.maptools.org
>
>Hi,
>
>Can anyone explain to me why the US Govt document on NAD83 State Plane
>Coordinate System (see link below) says that the origin for Alaska Zone
>1 is lat=57N lon=133'40W or Easting=5,000,000, Northing=-5,000,000, but
>when I run the Corpscon program with the appropriate setup it projects
>this lat/lon to Easting=818676.713, Northing=575097.689 ? I also found
>that MapInfo projects it to exactly the same Easting/Northing as
>Corpscon.
>
>If I use PROJ's cs2cs command (Rel 4.4.7 31 March 2003) to convert
>these lat/lon coordinates using the following command:
>
>cs2cs +proj=latlong +a=6378137.0 +rf=298.257222 +to +proj=omerc
>+lonc=-133.6666666667 +lat_0=57 +alpha=-36.8698976458 +k=0.9999
>+x_0=5000000 +y_0=-5000000  +a=6378137 +rf=298.257222101
>
>Then I get Easting=4999999.80 Northing=-5000000.0.
>
>So, the PROJ command gives results which agree with the NAD83 SPCS
>document, but both Corpscon and MapInfo give a consistent but different
>result. What is going on, and who is correct ??!
>
>Thanks,
>Anthony.
>
>NAD83 SPCS document:
>http://www.ngs.noaa.gov/PUBS_LIB/ManualNOSNGS5.pdf

Hi Anthony,

The version of Oblique Mercator that's used for Alaska zone 1 doesn't have a grid
origin at the defining projection parameters. Instead, the grid origin is approximately 
where the central line crosses the equator (technically the aposphere's equator). 
It's around longitude = -101.51384, latitude = -0.25527276. 

You should believe Corpscon, MapInfo, ArcGIS, and the National Geodetic Survey's
SPC program (http://www.ngs.noaa.gov/cgi-bin/spc_getpc.prl). 

State Plane zones were defined so that positions within the zone have positive 
values. The y0 = -5000000 makes sure that the y values aren't too large. 

Other countries that use oblique Mercator usually do 'recenter' the projection 
so that the 0,0 point is at the defining angular parameters.

Melita 

Melita Kennedy
ESRI Product Specialist


From ovv at hetnet.nl  Sun May 21 21:50:02 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Mon, 22 May 2006 06:50:02 +0200
Subject: [Proj] Re: Still trying to get SPCS Alaska Zone 1 working!
In-Reply-To: <26817278.1148082975986.JavaMail.root@elwamui-hybrid.atl.sa.earthlink.net>
Message-ID: <C0970F9A.70AE%ovv@hetnet.nl>

I found another amusing tidbit about the Alaska Zone 1 SPCS projection.

A test point not on the central line:
lat = 58.5; lon = -135; (decimal degrees, longitude is west)
Datum: NAD83.

The 'official' NGS calculator
http://www.ngs.noaa.gov/cgi-bin/spc_getpc.prl
produced an easting, northing of:
740933.648, 742902.522 meters

The formulae and data mentioned in:
NOAA Manual NOS NGS 5, State Plane coordinate system of 1983
gave me an easting, northing of:
740933.6477, 742902.5217

The NGS 5 manual specifies a false easting, northing of:
x0 = 5e6; y0 = -5e6; (meters)

My omerc version at first gave the wrong answer, but the correct answer
emerged when I set the no_ofs flag, as was mentioned earlier:
740933.6477, 742902.5217

Now a surprise.
The PROJ.4 file "nad83" has for the false easting, northing of this region:
x_0=818676.7344011233 y_0=575097.6888751927
With these I can use omerc in the regular manner, without specifying a
no_ofs.
The resulting easting, northing I got were:
740933.6485, 742902.5220

These 'offset' values of x0, y0 can also be found in the file "nad1983." in
the USGS GCTP Fortran distribution. How they are derived, I don't know.
The numbers have something to do with the 1e7 m shifted easting, northing of
the lat0, lon0 on the aposphere. I can reproduce the numbers, but don't ask
me about the theory...

It's nonetheless interesting to know that in this case (Alaska 5001) still
the regular omerc can be used!



From holl at gdf-hannover.de  Mon May 22 00:42:38 2006
From: holl at gdf-hannover.de (Stephan Holl)
Date: Mon, 22 May 2006 09:42:38 +0200
Subject: [Proj] Re: Proj Digest, Vol 24, Issue 13
In-Reply-To: <200605201602.k4KG1V54019224@duke.maptools.org>
References: <200605201602.k4KG1V54019224@duke.maptools.org>
Message-ID: <20060522094238.71d9cd60@butan.gdf-hannover.de>

Hello proj-request at lists.maptools.org,

On Sat, 20 May 2006 12:02:10 -0400 proj-request at lists.maptools.org
wrote:

I reduced the optimization which made it working on Solaris.

See thread

    http://bugzilla.remotesensing.org/show_bug.cgi?id=298#c6


That cured your described problems.

HTH
	Stephan


From adrian.holovaty at wpni.com  Mon May 22 11:29:17 2006
From: adrian.holovaty at wpni.com (Adrian Holovaty)
Date: Mon, 22 May 2006 13:29:17 -0500
Subject: [Proj] Re: Error compiling proj on Solaris: Undefined symbol
Message-ID: <200605221329.17757.adrian.holovaty@wpni.com>

I wrote:
> I'm trying to install proj on Solaris so I can use it with PostGIS, but it 
> won't compile. Here's the relevant error I get when I run "make".

Thanks to Stephan for pointing me in the right direction. I finally got proj 
to compile on Solaris. Here are the exact commands I used, for future 
reference:

wget ftp://ftp.remotesensing.org/proj/proj-4.4.9.tar.gz
gunzip -c proj-4.4.9.tar.gz | tar xvf -
cd proj-4.4.9
CFLAGS="-g" ./configure --prefix=/usr/local
make
sudo make install

Adrian


From pennyb at btex.co.uk  Tue May 23 06:24:18 2006
From: pennyb at btex.co.uk (Penny Bamborough)
Date: Tue, 23 May 2006 14:24:18 +0100
Subject: [Proj] Proj4 transform from WGS84 to UK Northings and Eastings help
 needed ...
Message-ID: <7.0.1.0.2.20060523140525.03168c00@btex.co.uk>

Hiya all

I have some Navteq data, which I believe is in WGS84 decimal degrees. 
I am using an ESRI product (which uses proj4) to project the data 
into british national grid northings and eastings. However, when I 
project the data, the coordinates appear to be between 100 to 200m 
out from where I would expect. I use the following settings for the 
proj4 translation:

proj=tmerc
a=6378137.0
b=6356752.3141
k_0=0.9996012717
ellps=airy
lat_0=49d0n
lon_0=2d0w
x_0=400000
y_0=-100000

Would anyone have any suggestions as to why we receive this position 
offset error ?

Penny



From phm4 at kent.ac.uk  Tue May 23 06:48:13 2006
From: phm4 at kent.ac.uk (Philipp H. Mohr)
Date: Tue, 23 May 2006 14:48:13 +0100 (BST)
Subject: [Proj] Proj4 transform from WGS84 to UK Northings and Eastings
	help needed ...
In-Reply-To: <7.0.1.0.2.20060523140525.03168c00@btex.co.uk>
References: <7.0.1.0.2.20060523140525.03168c00@btex.co.uk>
Message-ID: <Pine.GSO.4.58.0605231447260.7518@myrtle.ukc.ac.uk>

Hello,

On Tue, 23 May 2006, Penny Bamborough wrote:

> Would anyone have any suggestions as to why we receive this position
> offset error ?

I use the following and it works fine for me:

cs2cs -r +proj=latlong +ellps=WGS84 +towgs84=0,0,0 +nodefs +to +proj=tmerc
+lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy
+towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 +units=m
+no_defs < gps.out > gps.in


hth Phil


From cjmce at lsu.edu  Tue May 23 07:04:41 2006
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Tue, 23 May 2006 09:04:41 -0500
Subject: [Proj] Proj4 transform from WGS84 to UK Northings and Eastings
	help needed ...
Message-ID: <OF56576C72.40C900A6-ON86257177.004D555F-86257177.004D5571@lsu.edu>





Dear Ms. Bamborough,

The parameters you  have used appear to be correct for WGS84 Datum
coordinates with respect to the ellipsoid dimensions, but WGS84 does NOT
reference the Airy ellipsoid.  However, the British National Grid is NOT on
the WGS84 Datum; it is on the Ordnance Survey of Great Britain Datum of
1936 (OSGB36), which indeed IS on the Airy ellipsoid.  You will need to
FIRST perform a "datum shift" of the WGS84 coordinates such that they will
then match (and fit) the datum that the remainder of your data is on, which
I presume is OSGB36.

Consider a bit of reading with some of my past columns on this topic, you
can obtain free pdf downloads from the "ASPRS" url listed below my
signature block.  Note my October 2003 column; it's on Great Britain.

Good luck,

Clifford J. Mugnier C.P.,C.M.S.
National Director (2006-2008)
Photogrammetric Applications Division
AMERICAN SOCIETY FOR PHOTOGRAMMETRY AND REMOTE SENSING
and
Chief of Geodesy
Center for GeoInformatics
LOUISIANA STATE UNIVERSITY
Dept. of Civil Engineering
CEBA 3223A
Baton Rouge, LA  70810
Facsimile   (225) 578-8652
Voice       (225) 578-8536
------------------------------------------------------------
http://www.ASPRS.org/resources/GRIDS
http://www.cee.lsu.edu/facultyStaff/mugnier/index.html
------------------------------------------------------------


Hiya all

I have some Navteq data, which I believe is in WGS84 decimal degrees.
I am using an ESRI product (which uses proj4) to project the data
into british national grid northings and eastings. However, when I
project the data, the coordinates appear to be between 100 to 200m
out from where I would expect. I use the following settings for the
proj4 translation:

proj=tmerc
a=6378137.0
b=6356752.3141
k_0=0.9996012717
ellps=airy
lat_0=49d0n
lon_0=2d0w
x_0=400000
y_0=-100000

Would anyone have any suggestions as to why we receive this position
offset error ?

Penny



From Hugo.Tyson at cpslocates.com  Tue May 23 07:43:21 2006
From: Hugo.Tyson at cpslocates.com (Hugo Tyson)
Date: Tue, 23 May 2006 15:43:21 +0100
Subject: [Proj] Proj4 transform from WGS84 to UK Northings and Eastings
	help needed ...
Message-ID: <DA84911DC41E2041AC4998F54C3E24FB491808@cps-ex1.cps.local>

Hi Penny,

proj-bounces at lists.maptools.org <> wrote:
> I have some Navteq data, which I believe is in WGS84 decimal degrees.
> I am using an ESRI product (which uses proj4) to project the data
> into british national grid northings and eastings. However, when I
> project the data, the coordinates appear to be between 100 to 200m
> out from where I would expect. <SNIP>

I was doing the same in November 2005, and I ended up writing what
follows to the proj and qgis mailing lists.  Frank suggested using
OSGB36 as the name of the datum, which is fine, so please read the
below with that change in mind, "osgb36" not "airy".  Hope it helps,

	- Hugo

Change Request/FAQ candidate: Using OSGB36 UK grid

Apologies if this is posted in the wrong place -
the audience is intended to be users and developers
of both PROJ and QGIS.

Versions in use: proj-4.4.9; qgis-0.7.0

Using QGIS and cs2cs (proj4), we were unable to convert
from WGS84 Lat/Long to OSGB36 grid references matching
the Ordnance Survey's own website:
http://www.gps.gov.uk/convert.asp
(You have to register/log-in to use the converter)

Best we got was results roughly matching web OSGB tools
that don't do datum conversion, just projection (meaning
from OSGB36 datum Lat/Long to UK grid).

So we worked out that to get cs2cs to do the conversion
completely correctly, we had to tell it about the Airy
or OSGB 1936 *datum* as well as the Airy ellipse that 
it already knows about.  To do this you need to add a line
to the datums data (sic) definition table in pj_datums.c
and re-build/re-install. The table starts:
C_NAMESPACE struct PJ_DATUMS pj_datums[] = {
/* id       definition                               ellipse  comments */
/* --       ----------                               -------  -------- */
"WGS84",    "towgs84=0,0,0",                         "WGS84", "",

and the extra line (anywhere in that table) needs to be:

"airy", "towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894", "airy", "Airy 1830",

The numbers for the 7-value Helmert transformation came from the 
OS web document http://www.gps.gov.uk/guidecontents.asp
which gives the values for converting *to* OSGB36 - proj requires
the inverse of that: "towgs84=...".  This definition isn't exactly
the inverse, it just has the signs flipped.  Given the nature of 
the transformation that's good enough.

To use this datum in cs2cs, the runes to cast are these:
  cs2cs +proj=latlong +to +proj=tmerc +lat_0=49 +lon_0=-2
        +k=0.999601 +x_0=400000 +y_0=-100000 +ellps=airy
        +datum=airy +units=m +no_defs
which gives results within a couple of metres of the Ordnance
Survey's converter.  "+datum=airy" is the new bit.

PROJ-REQUEST: proj people, please include this datum in future
proj releases.

[QGIS-specifics snipped - this msg also in QGIS forum]

Thanks are due to proj and qgis authors et al for providing these
excellent tools in the first place.  We are using them just for
demo purposes, we're not in the GIS business at all, so they've
provided a very easy and useful way to start working in the
GIS world.

Thanks again and best regards,

	- Hugo

-- 
Hugo Tyson
Cambridge Positioning Systems Ltd
http://www.cpslocates.com/
=************************************************************
Matrix Everywhere 

CPS To Strengthen Presence In Japan As Demand For Its Location Solutions Grows

More information: http://www.cpslocates.com/cps/news_detail.asp?ID=169

********************************************************************************
This email and any attachments are confidential. They have been checked for viruses but it is your 
responsibility to conduct your own virus checks.
Cambridge Positioning Systems Limited, 62-64 Hills Road, Cambridge, CB2 1LA, is registered in England 
under company number 2808344.
********************************************************************************




From EMiller at dfg.ca.gov  Tue May 23 08:24:50 2006
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Tue, 23 May 2006 08:24:50 -0700
Subject: [Proj] Proj4 transform from WGS84 to UK Northings and
	Eastings help needed ...
Message-ID: <s472c6e7.018@dfg.ca.gov>

I'd be surprised if any ESRI product used PROJ.4.  They've been pretty adamant that their projection libraries are not based on PROJ.4.

>>> pennyb at btex.co.uk 5/23/2006 6:24:18 AM >>>
Hiya all

I have some Navteq data, which I believe is in WGS84 decimal degrees. 
I am using an ESRI product (which uses proj4) to project the data 
[snip]




From ed at topozone.com  Tue May 23 12:11:21 2006
From: ed at topozone.com (Ed McNierney)
Date: Tue, 23 May 2006 15:11:21 -0400
Subject: [Proj] Default nadgrids handling for NAD27 <-> NAD83 conversions
Message-ID: <4BF377919225F449BB097CB76FFE9BC83DDDC2@ptolemy.topozone.com>

Folks -

I finally chased down and fixed a nagging old bug in our NAD27/NAD83
processing.  We're using MapServer as an OGC WMS server and requesting
raster topo images.  Customers can request output as UTM NAD27 or UTM
NAD83; we specify the output projection using the EPSG code.  This
normally works fine, but requests for UTM NAD27 output in Puerto Rico
were failing.

If I requested an output image as EPSG:26919 (UTM Zone 19 North, NAD83)
everything worked fine; if I requested EPSG:26719 (UTM Zone 19 North,
NAD27), I got nothing.  All relevant grid shift files were properly
installed on the machine doing the processing.  Since the WMS interface
uses EPSG codes as shorthand for full PROJ definitions, I was not
specifying a +nadgrids parameter, but I always got the right result in
other cases.

I discovered that the "fix" was that pj_datums.c (line 87) uses a
default list of grid shift files, and the prvi grid shift file (the one
I needed) was not included in the default list.  The conus and alaska
files, along with the Canadian ones, are used by default, while the
hawaii, prvi, and Bering Sea islands are not.  The comments indicate
that Frank added this default list about three years ago to eliminate
the need for a +nadgrids parameter all the time.

This was a little hard to figure out, because it worked most of the
time.  I'm trying to figure out the best way to handle this situation,
specifically for users using EPSG codes who do not normally specify or
think about +nadgrids parameters.

One fix is to list all the common/known grid shift files in the
pj_datums.c code, at least where there is no conflict between files.
Another would be to edit the EPSG text file to explicitly include the
+nadgrids parameter for all projections that could possibly use it,
specifying only those grid shift files relevant to that projection.  I
don't know why a subset of the grid shift files (from the standard
distribution) is included in pj_datums.c, so I'm not sure of the best
way to handle this.  Suggestions would be welcome - thanks!

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed at topozone.com
(978) 251-4242 



From mkennedy2 at earthlink.net  Tue May 23 20:05:37 2006
From: mkennedy2 at earthlink.net (Melita Kennedy)
Date: Tue, 23 May 2006 20:05:37 -0700 (GMT-07:00)
Subject: [Proj] Re: Proj Digest, Vol 24, Issue 15
Message-ID: <20597984.1148439937812.JavaMail.root@elwamui-wigeon.atl.sa.earthlink.net>

-----Original Message-----

Date: Tue, 23 May 2006 08:24:50 -0700
From: "Eric Miller" <EMiller at dfg.ca.gov>
Subject: Re: [Proj] Proj4 transform from WGS84 to UK Northings and
	Eastings help needed ...
To: <proj at lists.maptools.org>

I'd be surprised if any ESRI product used PROJ.4.  They've been pretty adamant that
their projection libraries are not based on PROJ.4.

>>> pennyb at btex.co.uk 5/23/2006 6:24:18 AM >>>
Hiya all

I have some Navteq data, which I believe is in WGS84 decimal degrees. 
I am using an ESRI product (which uses proj4) to project the data 
[snip]

------------------------------

As far as I know, we aren't, or at least, no one's asked me about it. Software that we've
acquired might be using PROJ.4, rather than the in-house projection enigne library, and
there are a few other instances where something else is being used (ArcInfo workstation, 
ArcView GIS, MapObjects Java) but I know it's not PROJ.4. 

Melita Kennedy
ESRI Product Specialist


