From strebe at aol.com  Thu Jan  1 13:38:09 2015
From: strebe at aol.com (strebe at aol.com)
Date: Thu, 1 Jan 2015 16:38:09 -0500
Subject: [Proj] Jacobi + Guyou projections;
	conformal map of ellipsoid to sphere
In-Reply-To: <54A30325.3020702@sri.com>
References: <549588D0.7080603@sri.com>
	<E8B848BE704B4B9FB8871058E5B10E16@NoelDellPC>
	<54A30325.3020702@sri.com>
Message-ID: <8D1F4225EB9BDE9-AF4-9923B@webmail-vm086.sysops.aol.com>

Hello Charles. Good stuff; thanks.

Do you know of any literature around triaxial-to-spherical mappings in general (including other techniques to preserve conformality, as well as ones to preserve other traits such as equivalence)?

 

 — daan


-----Original Message-----
From: Charles Karney <charles.karney at sri.com>
To: proj <proj at lists.maptools.org>
Sent: Thu, Jan 1, 2015 1:20 pm
Subject: [Proj] Jacobi + Guyou projections; conformal map of ellipsoid to sphere


I've updated my notes on Jacobi's conformal projection of a triaxial
ellipsoid; see

   http://geographiclib.sourceforge.net/1.41/jacobi.html

New stuff:

* the limits, ellipsoid of revolution and sphere, are easily obtained;

* the Guyou projection (and hence the Peirce quincuncial projection) are
   special cases of Jacobi's projection (which predates both of these);

* Jacobi + Guyou can be used to map a triaxial ellipsoid conformally
   onto a sphere.

   --Charles


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20150101/3226fa87/attachment.html>

From charles.karney at sri.com  Thu Jan  1 15:12:33 2015
From: charles.karney at sri.com (Charles Karney)
Date: Thu, 1 Jan 2015 18:12:33 -0500
Subject: [Proj] Jacobi + Guyou projections;
 conformal map of ellipsoid to sphere
In-Reply-To: <8D1F4225EB9BDE9-AF4-9923B@webmail-vm086.sysops.aol.com>
References: <549588D0.7080603@sri.com>	<E8B848BE704B4B9FB8871058E5B10E16@NoelDellPC>	<54A30325.3020702@sri.com>
	<8D1F4225EB9BDE9-AF4-9923B@webmail-vm086.sysops.aol.com>
Message-ID: <54A5D461.9010605@sri.com>

Other than Nyrstov https://dx.doi.org/10.1007/978-3-642-32618-9_17 ,
there's

   http://geocnt.geonet.ru/en/3_axial
   J. P. Snyder, Survey Review 38(217), 130-148 (1985)
   and references therein

but Snyder's method seems to be much more complicated that Jacobi's
projection (converted into elliptic integrals).  I'm not aware of
any work talking about mapping a trixial ellipsoid to a sphere.
However, once you've mapped the ellipsoid to a rectangle, the
mapping to a sphere is straightforward.

BTW, what does "equivalence" mean in this context?

   --Charles

On 01/01/2015 04:38 PM, strebe at aol.com wrote:
> Hello Charles. Good stuff; thanks.
>
> Do you know of any literature around triaxial-to-spherical mappings in
> general (including other techniques to preserve conformality, as well as
> ones to preserve other traits such as equivalence)?
>
> — daan
>
> -----Original Message-----
> From: Charles Karney <charles.karney at sri.com>
> To: proj <proj at lists.maptools.org>
> Sent: Thu, Jan 1, 2015 1:20 pm
> Subject: [Proj] Jacobi + Guyou projections; conformal map of ellipsoid
> to sphere
>
> I've updated my notes on Jacobi's conformal projection of a triaxial
> ellipsoid; see
>
>     http://geographiclib.sourceforge.net/1.41/jacobi.html
>
> New stuff:
>
> * the limits, ellipsoid of revolution and sphere, are easily obtained;
>
> * the Guyou projection (and hence the Peirce quincuncial projection) are
>     special cases of Jacobi's projection (which predates both of these);
>
> * Jacobi + Guyou can be used to map a triaxial ellipsoid conformally
>     onto a sphere.
>
>     --Charles
>
\


From strebe at aol.com  Thu Jan  1 15:21:57 2015
From: strebe at aol.com (strebe at aol.com)
Date: Thu, 1 Jan 2015 18:21:57 -0500
Subject: [Proj] Jacobi + Guyou projections;
	conformal map of ellipsoid to sphere
In-Reply-To: <54A5D461.9010605@sri.com>
References: <549588D0.7080603@sri.com>	<E8B848BE704B4B9FB8871058E5B10E16@NoelDellPC>	<54A30325.3020702@sri.com>
	<8D1F4225EB9BDE9-AF4-9923B@webmail-vm086.sysops.aol.com>
	<54A5D461.9010605@sri.com>
Message-ID: <8D1F430DF4D8F0F-AF4-997F3@webmail-vm086.sysops.aol.com>

Thanks, Charles. Equivalence is the equal-area property.
 

 — daan


 

-----Original Message-----
From: Charles Karney <charles.karney at sri.com>
To: proj <proj at lists.maptools.org>
Sent: Thu, Jan 1, 2015 3:18 pm
Subject: Re: [Proj] Jacobi + Guyou projections; conformal map of ellipsoid to sphere


Other than Nyrstov https://dx.doi.org/10.1007/978-3-642-32618-9_17 ,
there's

   http://geocnt.geonet.ru/en/3_axial
   J. P. Snyder, Survey Review 38(217), 130-148 (1985)
   and references therein

but Snyder's method seems to be much more complicated that Jacobi's
projection (converted into elliptic integrals).  I'm not aware of
any work talking about mapping a trixial ellipsoid to a sphere.
However, once you've mapped the ellipsoid to a rectangle, the
mapping to a sphere is straightforward.

BTW, what does "equivalence" mean in this context?

   --Charles

On 01/01/2015 04:38 PM, strebe at aol.com wrote:
> Hello Charles. Good stuff; thanks.
>
> Do you know of any literature around triaxial-to-spherical mappings in
> general (including other techniques to preserve conformality, as well as
> ones to preserve other traits such as equivalence)?
>
> — daan
>
> -----Original Message-----
> From: Charles Karney <charles.karney at sri.com>
> To: proj <proj at lists.maptools.org>
> Sent: Thu, Jan 1, 2015 1:20 pm
> Subject: [Proj] Jacobi + Guyou projections; conformal map of ellipsoid
> to sphere
>
> I've updated my notes on Jacobi's conformal projection of a triaxial
> ellipsoid; see
>
>     http://geographiclib.sourceforge.net/1.41/jacobi.html
>
> New stuff:
>
> * the limits, ellipsoid of revolution and sphere, are easily obtained;
>
> * the Guyou projection (and hence the Peirce quincuncial projection) are
>     special cases of Jacobi's projection (which predates both of these);
>
> * Jacobi + Guyou can be used to map a triaxial ellipsoid conformally
>     onto a sphere.
>
>     --Charles
>
\
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20150101/763806a2/attachment.html>

From ccrook at linz.govt.nz  Mon Jan  5 00:01:25 2015
From: ccrook at linz.govt.nz (Chris Crook)
Date: Mon, 5 Jan 2015 21:01:25 +1300
Subject: [Proj] Time dependent coordinate transformations
Message-ID: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>

I'm wanting open a discussion around how to handle time dependent coordinate transformations.  These are becoming far more relevant to GIS data sets and positioning than they have historically been.

This is a growing issue for which I'd like to find the right forums and process to ultimately have have widely supported in coordinate transformation implementations, so please suggest or forward other appropriate forums.

I'm posting initially to the PROJ list as PROJ underlies much of the coordinate system transformations in the open source GIS stack, and does include datum transformations as well as projections.  However this is clearly a wider issue .. as I suggest below I think this affects the definition of spatial features generally - so I'd welcome suggestions for more appropriate or additional forums.


The background
==============

Coordinate systems are based on geodetic datums.  These are generally either international datums, such as WGS84 or ITRF realisation, or national datums defined by a country's geodetic authority.

Within international datums apparently fixed features (such as buildings) are moving due to plate tectonics at rates of typically 5 cm/year.  This means that the WGS84 coordinate of a "fixed" point in 2000 would now miss that point by 75cm.

National datums are generally referenced to fixed marks within the country and provide a stable coordinate system, such that the coordinates of fixed marks are constant.

Obviously the conversion between international datums and national datums cannot be done without taking account of when the coordinates are applicable.

Typically GIS systems are in terms of national coordinate systems.  Generally they contain spatial definitions in terms of the national datum, with no timestamp, and assume that this provides a consistent coordinate system for comparing coordinates and performing the various spatial analyses that characterise GIS systems.  Features are generally assumed to be fixed, and operations such as testing overlaps and adjacency assume that the spatial defintions are in a common spatial reference frame.

Historically most data has been derived by observations relative to the national coordinate system and this has worked.

Now however precise point positioning systems are increasingly generating data in terms of international reference frames.  Similarly global systems such as satellite based remote sensing will generate data in terms of international reference frames.

How are these data to be brought to a common system and used within GIS systems?

Clearly this cannot be accomplished to sub-metre accuracy without time dependent transformations that account for tectonic movement.

What do the time dependent transformations look like?

On stable continents they are simply an extension of the Bursa-Wolf 7 parameter transformation in which each parameter also has an additional term representing its rate of change. Also there is a further parameter which is the reference date at which the time dependent component is zero.

However many countries also include deforming areas near tectonic plate boundaries which require more special treatment.  For example North America has the HTDP model which describes the deformation of the western edge of the continent on the North American/Pacific plate boundary lies.  In New Zealand the entire country straddles a plate boundary, and so the national datum is related to ITRF96 by a complex deformation model including a gridded velocity model, and gridded components for significant earthquakes.

The issues for the GIS software stack
=====================================

I believe there are two issues facing GIS systems in handling time based transformations.

1) Where are the parameters of time based transformations defined

2) When transforming a coordinate how is the time parameter included in the transformation API

It seems fairly straightforward to expand the definitions of coordinate systems in PROJ and the EPSG registry to include additional parameters.  The to_wgs84 parameters could readily be extended to include the 14 parameter plus reference epoch time dependent Bursa Wolf transformation.  Some datum transformations already include nested grids, so extending this to include grids with associated time functions also seems feasible.

However to be widely supported this will need appropriate standards to be defined for the common parameter sets of time dependent transformations.  (There may also a question of what reference datum the transformations are defined in terms of, if any.  The to_wgs84 parameters implies a WGS84 based reference datum, but in fact WGS84 is a series of datum realisations)

The second question is how a time parameter is supplied to a transformation function.  Logically this is associated with a feature.  Where the feature is not fixed in terms of the coordinate system it is not really meaningful to define coordinates without specifying an epoch at which they apply.  For example the ITRF2008 coordinates of a survey mark on a tectonic plate are correct only at the time at which they are measured.  So properly the time is part of the coordinate definition of a feature.

Where a feature is considered to be fixed in terms of a coordinate system the time can be discarded - this is the case for nearly all features in GIS systems today.  Because the feature is considered fixed, any time can be associated with the spatial definition for the purposes of transforming to another coordinate system.

I suspect that providing for a time coordinate as part of the spatial definition of features would involve modifying the OGC standard defining spatial features, as well as the various software stacks using them.

Summary
=======

So to paraphrase:

* coordinate transformations between international and local datums at sub-metre accuracy requires time dependent transformations
* coordinate system definitions therefore need to be expanded to allow defining time dependent parameterization in standard ways that can be widely implemented
* spatial definitions of features need to be expanded to include a time component, again so that this can be accessed in a standard way

Does this conclusion seem correct, and if so what is the process of making this happen?

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.


From even.rouault at spatialys.com  Mon Jan  5 03:31:32 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 Jan 2015 12:31:32 +0100
Subject: [Proj] Time dependent coordinate transformations
In-Reply-To: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>
References: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <201501051231.32794.even.rouault@spatialys.com>

Chris,

> This is a growing issue for which I'd like to find the right forums
> and
> process to ultimately have have widely supported in coordinate
> transformation implementations, so please suggest or forward other
> appropriate forums.

I can imagine MetaCRS (http://trac.osgeo.org/metacrs / 
http://lists.osgeo.org/pipermail/metacrs) could also be associated

> 
> The background
> ==============
> 

> National datums are generally referenced to fixed marks within the country
> and provide a stable coordinate system, such that the coordinates of fixed
> marks are constant.
> 
[...]
> However many countries also include deforming areas near tectonic plate
> boundaries which require more special treatment.

When you mention those national datums with fixed marks, how does NAD83 and its 
multiple realisations work with that ? I'm clearly not a geodesist,  but 
looking a bit on various sites, it seems that the coordinates of a fixed mark 
vary between the different NAD83 realisations, so can we speak of a national 
datum for the US (or New Zealand) ?

> For example North
> America has the HTDP model which describes the deformation of the western
> edge of the continent on the North American/Pacific plate boundary lies. 
> In New Zealand the entire country straddles a plate boundary, and so the
> national datum is related to ITRF96 by a complex deformation model
> including a gridded velocity model, and gridded components for significant
> earthquakes.

Regarding HDTP, Frank Warmerdam had implemented a tool to make them available 
for proj.4 use : https://trac.osgeo.org/proj/wiki/HTDPGrids . But this is 
clearly more a ad-hoc solution than the more general/automated solution you're 
looking for.

> 
> The issues for the GIS software stack
> =====================================
> 
> I believe there are two issues facing GIS systems in handling time based
> transformations.
> 
> 1) Where are the parameters of time based transformations defined
> 
> 2) When transforming a coordinate how is the time parameter included in the
> transformation API
> 
> It seems fairly straightforward to expand the definitions of coordinate
> systems in PROJ and the EPSG registry to include additional parameters. 
> The to_wgs84 parameters could readily be extended to include the 14
> parameter plus reference epoch time dependent Bursa Wolf transformation. 
> Some datum transformations already include nested grids, so extending this
> to include grids with associated time functions also seems feasible.

Agreed although in the case of HTDP, the production of grids result from the 
result of a (apparently complex) computation process where you have to provide 
src_crs, src_crs_date, dst_crs and dst_crs_date. Regarding proj.4 one could 
have a fixed (dst_crs, dst_crs_date) by convention, but one would still have 
varying src_crs_date for a given src_crs. Perhaps pre-generate grids for each 
year and linearly interpolate between them ?

> 
> However to be widely supported this will need appropriate standards to be
> defined for the common parameter sets of time dependent transformations. 
> (There may also a question of what reference datum the transformations are
> defined in terms of, if any.  The to_wgs84 parameters implies a WGS84
> based reference datum, but in fact WGS84 is a series of datum
> realisations)

I can imagine that the "pivot" WGS84 could be an arbitrarily chosen WGS84 
realization (hoping that the use of 2 successive shifts will not harm too much 
precision)

> 
> The second question is how a time parameter is supplied to a transformation
> function.  Logically this is associated with a feature. 

Yes, if you consider that a dataset can contain a collection of features whose 
coordinates have been collected at different times. But one could also assume 
that within a dataset, they all refer to the same time (this would be similar 
to considering that in a dataset you don't mix features with coordinates in 
different SRS, which is the usual practice), couldn't we ? In which case the 
time parameter could be a property of the SRS, or presumably next to the SRS 
(since SRS can be transported by codes, and you can't code each different 
time).

There's also the topic of raster maps (for high precision mapping) that could 
also be affected by time dependant transformations. But in that case it is 
obvious that a single time must be considered for the whole map.

> Where the feature
> is not fixed in terms of the coordinate system it is not really meaningful
> to define coordinates without specifying an epoch at which they apply. 
> For example the ITRF2008 coordinates of a survey mark on a tectonic plate
> are correct only at the time at which they are measured.  So properly the
> time is part of the coordinate definition of a feature.
> 
> Where a feature is considered to be fixed in terms of a coordinate system
> the time can be discarded - this is the case for nearly all features in
> GIS systems today.  Because the feature is considered fixed, any time can
> be associated with the spatial definition for the purposes of transforming
> to another coordinate system.
> 
> I suspect that providing for a time coordinate as part of the spatial
> definition of features would involve modifying the OGC standard defining
> spatial features, as well as the various software stacks using them.

If we include it in WKT/WKB representation of geometries yes. I'd note that 
currently WKT/WKB doesn't even include SRS ID, but PostGIS extended variants 
do.

Which brings also the interesting topic of how existing GIS formats could 
transport the time information...

> 
> Summary
> =======
> 
> So to paraphrase:
> 
> * coordinate transformations between international and local datums at
> sub-metre accuracy requires time dependent transformations * coordinate
> system definitions therefore need to be expanded to allow defining time
> dependent parameterization in standard ways that can be widely implemented
> * spatial definitions of features need to be expanded to include a time
> component, again so that this can be accessed in a standard way
> 
> Does this conclusion seem correct, and if so what is the process of making
> this happen?

Perhaps approaching the various OGC working groups of the related standards to 
see if there have been thoughts/work related to that ?

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


From ccrook at linz.govt.nz  Mon Jan  5 12:13:36 2015
From: ccrook at linz.govt.nz (Chris Crook)
Date: Tue, 6 Jan 2015 09:13:36 +1300
Subject: [Proj] Time dependent coordinate transformations
In-Reply-To: <201501051231.32794.even.rouault@spatialys.com>
References: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>
	<201501051231.32794.even.rouault@spatialys.com>
Message-ID: <666FB8D75E95AE42965A0E76A5E5337E14DDDAC56E@prdlsmmsg01.ad.linz.govt.nz>

Even

Thanks for the quick response and thanks for the suggestion of the MetaCRS list.

Comments below...

> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Tuesday, 6 January 2015 12:32 a.m.
> To: proj at lists.maptools.org
> Cc: Chris Crook
> Subject: Re: [Proj] Time dependent coordinate transformations
>
> Chris,
>
> > This is a growing issue for which I'd like to find the right forums
> > and process to ultimately have have widely supported in coordinate
> > transformation implementations, so please suggest or forward other
> > appropriate forums.
>
> I can imagine MetaCRS (http://trac.osgeo.org/metacrs /
> http://lists.osgeo.org/pipermail/metacrs) could also be associated
>
> >
> > The background
> > ==============
> >
>
> > National datums are generally referenced to fixed marks within the
> > country and provide a stable coordinate system, such that the
> > coordinates of fixed marks are constant.
> >
> [...]
> > However many countries also include deforming areas near tectonic
> > plate boundaries which require more special treatment.
>
> When you mention those national datums with fixed marks, how does
> NAD83 and its multiple realisations work with that ? I'm clearly not a
> geodesist,  but looking a bit on various sites, it seems that the coordinates of
> a fixed mark vary between the different NAD83 realisations, so can we speak
> of a national datum for the US (or New Zealand) ?

Sorry - the "with fixed marks" was a bit simplistic.

There certainly is an issue with versions  of datums, and this is another area which I'm not sure is
well handled with the current coordinate system registries.

For example in New Zealand each update of the deformation model (which relates
NZGD2000 to ITRF96) effectively defines a new version of NZGD2000.  Should this be treated as a new
coordinate system in EPSG and other registries.  If so, then all 30+ projections based on NZGD2000 will
also need to be recreated.   For most users of NZGD2000 this would just be a nuisance, but for some
it would be preferred I think.

> > For example North
> > America has the HTDP model which describes the deformation of the
> > western edge of the continent on the North American/Pacific plate
> boundary lies.
> > In New Zealand the entire country straddles a plate boundary, and so
> > the national datum is related to ITRF96 by a complex deformation model
> > including a gridded velocity model, and gridded components for
> > significant earthquakes.
>
> Regarding HDTP, Frank Warmerdam had implemented a tool to make them
> available for proj.4 use : https://trac.osgeo.org/proj/wiki/HTDPGrids . But
> this is clearly more a ad-hoc solution than the more general/automated
> solution you're looking for.

I have seen that, and a similar approach could be used for one-off transformations
in New Zealand.  However that doesn't feel like the right approach in the long term.
On the other hand any systematic change to handle time dependent transformations
will doubtless take a long time to be widely implemented, so it is great to have work
arounds in the mean time!

> >
> > The issues for the GIS software stack
> > =====================================
> >
> > I believe there are two issues facing GIS systems in handling time based
> > transformations.
> >
> > 1) Where are the parameters of time based transformations defined
> >
> > 2) When transforming a coordinate how is the time parameter included in
> the
> > transformation API
> >
> > It seems fairly straightforward to expand the definitions of coordinate
> > systems in PROJ and the EPSG registry to include additional parameters.
> > The to_wgs84 parameters could readily be extended to include the 14
> > parameter plus reference epoch time dependent Bursa Wolf
> transformation.
> > Some datum transformations already include nested grids, so extending
> this
> > to include grids with associated time functions also seems feasible.
>
> Agreed although in the case of HTDP, the production of grids result from the
> result of a (apparently complex) computation process where you have to
> provide
> src_crs, src_crs_date, dst_crs and dst_crs_date. Regarding proj.4 one could
> have a fixed (dst_crs, dst_crs_date) by convention, but one would still have
> varying src_crs_date for a given src_crs. Perhaps pre-generate grids for each
> year and linearly interpolate between them ?

I believe that there is just one one date for these transformations.  This is not
about predicting where a feature might be at another time, it is about transforming
between coordinate systems which are related by a time dependent function.  Of
course if the feature is considered to be fixed in one of those coordinate systems then
the effect of transforming at different dates is to track it's trajectory in the other.

Also many national datums (including New Zealand) are defined in terms of a reference
epoch, so calculating coordinates in terms of that datum can be thought of as
converting coordinates to that epoch.   In New Zealand that is how we have described
NZGD2000 until recently.

I think that is a bit misleading though - after we may be defining the coordinates of
a building that did not even exist at the reference epoch.    And clearly it is not possible to
access the features at any time other than the present.

I believe it is more correct to think of the reference epoch as a time at which the
national coordinate system coincided with some international system it was defined
in terms of.  However at other times it is offset from the international system by an
approximately known amount representing the total movement of the tectonic plate
on which the nation lies.  Hence the time dependent transformation.

> >
> > However to be widely supported this will need appropriate standards to be
> > defined for the common parameter sets of time dependent
> transformations.
> > (There may also a question of what reference datum the transformations
> are
> > defined in terms of, if any.  The to_wgs84 parameters implies a WGS84
> > based reference datum, but in fact WGS84 is a series of datum
> > realisations)
>
> I can imagine that the "pivot" WGS84 could be an arbitrarily chosen WGS84
> realization (hoping that the use of 2 successive shifts will not harm too much
> precision)

I think an approach like this is possibly the best that can be done practically.
There are multiple published relationships between different international datums, and
between them and national datums, which means that the relationships are not
unambiguously defined.  I'm not sure how this could usefully be included in coordinate
system registries and transformations.

> >
> > The second question is how a time parameter is supplied to a
> transformation
> > function.  Logically this is associated with a feature.
>
> Yes, if you consider that a dataset can contain a collection of features whose
> coordinates have been collected at different times. But one could also
> assume
> that within a dataset, they all refer to the same time (this would be similar
> to considering that in a dataset you don't mix features with coordinates in
> different SRS, which is the usual practice), couldn't we ? In which case the
> time parameter could be a property of the SRS, or presumably next to the
> SRS
> (since SRS can be transported by codes, and you can't code each different
> time).
>
> There's also the topic of raster maps (for high precision mapping) that could
> also be affected by time dependant transformations. But in that case it is
> obvious that a single time must be considered for the whole map.

I'm not thinking that datasets will generally have different times (even if the data
were originally collected that way).  More that the transformation API's ultimately
work on coordinates.  So even if a feature's coordinates are not stored with a time,
the dataset time could be assigned to the feature in preparation for the transformation
(in the same way as we might set a SRS id to a feature).

The question here is whether to have a separate API for transformations that require
a time, or whether to use the same API and embed the time within the
feature/coordinate being transformed.

In terms of implementation I guess there will be efficiencies in preparing a transformation
for a specific epoch - in effect defining a transformation object which is used for transformations
and which can cache prepared transformations.  I'm not sure how this will sit with existing API's.

I'm not familiar with transforming raster maps, though I imagine the process would be
to transform a set of reference coordinates that are used to morph the raster?

> > Where the feature
> > is not fixed in terms of the coordinate system it is not really meaningful
> > to define coordinates without specifying an epoch at which they apply.
> > For example the ITRF2008 coordinates of a survey mark on a tectonic plate
> > are correct only at the time at which they are measured.  So properly the
> > time is part of the coordinate definition of a feature.
> >
> > Where a feature is considered to be fixed in terms of a coordinate system
> > the time can be discarded - this is the case for nearly all features in
> > GIS systems today.  Because the feature is considered fixed, any time can
> > be associated with the spatial definition for the purposes of transforming
> > to another coordinate system.
> >
> > I suspect that providing for a time coordinate as part of the spatial
> > definition of features would involve modifying the OGC standard defining
> > spatial features, as well as the various software stacks using them.
>
> If we include it in WKT/WKB representation of geometries yes. I'd note that
> currently WKT/WKB doesn't even include SRS ID, but PostGIS extended
> variants
> do.
>
> Which brings also the interesting topic of how existing GIS formats could
> transport the time information...
>
> >
> > Summary
> > =======
> >
> > So to paraphrase:
> >
> > * coordinate transformations between international and local datums at
> > sub-metre accuracy requires time dependent transformations * coordinate
> > system definitions therefore need to be expanded to allow defining time
> > dependent parameterization in standard ways that can be widely
> implemented
> > * spatial definitions of features need to be expanded to include a time
> > component, again so that this can be accessed in a standard way
> >
> > Does this conclusion seem correct, and if so what is the process of making
> > this happen?
>
> Perhaps approaching the various OGC working groups of the related
> standards to
> see if there have been thoughts/work related to that ?
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.


From even.rouault at spatialys.com  Mon Jan  5 13:23:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 Jan 2015 22:23:50 +0100
Subject: [Proj] Time dependent coordinate transformations
In-Reply-To: <666FB8D75E95AE42965A0E76A5E5337E14DDDAC56E@prdlsmmsg01.ad.linz.govt.nz>
References: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>
	<201501051231.32794.even.rouault@spatialys.com>
	<666FB8D75E95AE42965A0E76A5E5337E14DDDAC56E@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <201501052223.50639.even.rouault@spatialys.com>

Le lundi 05 janvier 2015 21:13:36, Chris Crook a écrit :
> Even
> 
> Thanks for the quick response and thanks for the suggestion of the MetaCRS
> list.
> 
> Comments below...
> 
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: Tuesday, 6 January 2015 12:32 a.m.
> > To: proj at lists.maptools.org
> > Cc: Chris Crook
> > Subject: Re: [Proj] Time dependent coordinate transformations
> > 
> > Chris,
> > 
> > > This is a growing issue for which I'd like to find the right forums
> > > and process to ultimately have have widely supported in coordinate
> > > transformation implementations, so please suggest or forward other
> > > appropriate forums.
> > 
> > I can imagine MetaCRS (http://trac.osgeo.org/metacrs /
> > http://lists.osgeo.org/pipermail/metacrs) could also be associated
> > 
> > > The background
> > > ==============
> > > 
> > > 
> > > National datums are generally referenced to fixed marks within the
> > > country and provide a stable coordinate system, such that the
> > > coordinates of fixed marks are constant.
> > 
> > [...]
> > 
> > > However many countries also include deforming areas near tectonic
> > > plate boundaries which require more special treatment.
> > 
> > When you mention those national datums with fixed marks, how does
> > NAD83 and its multiple realisations work with that ? I'm clearly not a
> > geodesist,  but looking a bit on various sites, it seems that the
> > coordinates of a fixed mark vary between the different NAD83
> > realisations, so can we speak of a national datum for the US (or New
> > Zealand) ?
> 
> Sorry - the "with fixed marks" was a bit simplistic.
> 
> There certainly is an issue with versions  of datums, and this is another
> area which I'm not sure is well handled with the current coordinate system
> registries.
> 
> For example in New Zealand each update of the deformation model (which
> relates NZGD2000 to ITRF96) effectively defines a new version of NZGD2000.
>  Should this be treated as a new coordinate system in EPSG and other
> registries.  If so, then all 30+ projections based on NZGD2000 will also
> need to be recreated.   For most users of NZGD2000 this would just be a
> nuisance, but for some it would be preferred I think.

https://confluence.qps.nl/pages/viewpage.action?pageId=29855153 shows that 
there are 5 EPSG codes for the various NAD83 realizations in geodetic 
projections. Not sure that they all have associated corresponding projected 
systems though.

> I have seen that, and a similar approach could be used for one-off
> transformations in New Zealand.  However that doesn't feel like the right
> approach in the long term. On the other hand any systematic change to
> handle time dependent transformations will doubtless take a long time to
> be widely implemented, so it is great to have work arounds in the mean
> time!

Agreed...

> 
> > > The issues for the GIS software stack
> > > =====================================
> > > 
> > > I believe there are two issues facing GIS systems in handling time
> > > based transformations.
> > > 
> > > 1) Where are the parameters of time based transformations defined
> > > 
> > > 2) When transforming a coordinate how is the time parameter included in
> > 
> > the
> > 
> > > transformation API
> > > 
> > > It seems fairly straightforward to expand the definitions of coordinate
> > > systems in PROJ and the EPSG registry to include additional parameters.
> > > The to_wgs84 parameters could readily be extended to include the 14
> > > parameter plus reference epoch time dependent Bursa Wolf
> > 
> > transformation.
> > 
> > > Some datum transformations already include nested grids, so extending
> > 
> > this
> > 
> > > to include grids with associated time functions also seems feasible.
> > 
> > Agreed although in the case of HTDP, the production of grids result from
> > the result of a (apparently complex) computation process where you have
> > to provide
> > src_crs, src_crs_date, dst_crs and dst_crs_date. Regarding proj.4 one
> > could have a fixed (dst_crs, dst_crs_date) by convention, but one would
> > still have varying src_crs_date for a given src_crs. Perhaps
> > pre-generate grids for each year and linearly interpolate between them ?
> 
> I believe that there is just one one date for these transformations. 

I meant that for HTDP, my impression with my limited testing is that you can 
actually specify one date for each of the both CRS and it will use each one, 
presumably using some pivot as a reference, to generate the final grid.

Transforming from NAD83(2011) at T=2014.0 into WGS84(G730) at T=1991.0 gives a 
different result from NAD83(2011) at T=2011.0 into WGS84(G730) at T=1991.0, and 
different from NAD83(2011) at T=2014.0 into WGS84(G730) at T=1986.0

> This
> is not about predicting where a feature might be at another time, it is
> about transforming between coordinate systems which are related by a time
> dependent function.  Of course if the feature is considered to be fixed in
> one of those coordinate systems then the effect of transforming at
> different dates is to track it's trajectory in the other.
> 
> Also many national datums (including New Zealand) are defined in terms of a
> reference epoch, so calculating coordinates in terms of that datum can be
> thought of as converting coordinates to that epoch.   In New Zealand that
> is how we have described NZGD2000 until recently.
> 
> I think that is a bit misleading though - after we may be defining the
> coordinates of a building that did not even exist at the reference epoch. 
>   And clearly it is not possible to access the features at any time other
> than the present.
> 
> I believe it is more correct to think of the reference epoch as a time at
> which the national coordinate system coincided with some international
> system it was defined in terms of.  However at other times it is offset
> from the international system by an approximately known amount
> representing the total movement of the tectonic plate on which the nation
> lies.  Hence the time dependent transformation.
> 
> > > However to be widely supported this will need appropriate standards to
> > > be defined for the common parameter sets of time dependent
> > 
> > transformations.
> > 
> > > (There may also a question of what reference datum the transformations
> > 
> > are
> > 
> > > defined in terms of, if any.  The to_wgs84 parameters implies a WGS84
> > > based reference datum, but in fact WGS84 is a series of datum
> > > realisations)
> > 
> > I can imagine that the "pivot" WGS84 could be an arbitrarily chosen WGS84
> > realization (hoping that the use of 2 successive shifts will not harm too
> > much precision)
> 
> I think an approach like this is possibly the best that can be done
> practically. There are multiple published relationships between different
> international datums, and between them and national datums, which means
> that the relationships are not unambiguously defined.  I'm not sure how
> this could usefully be included in coordinate system registries and
> transformations.
> 
> > > The second question is how a time parameter is supplied to a
> > 
> > transformation
> > 
> > > function.  Logically this is associated with a feature.
> > 
> > Yes, if you consider that a dataset can contain a collection of features
> > whose coordinates have been collected at different times. But one could
> > also assume
> > that within a dataset, they all refer to the same time (this would be
> > similar to considering that in a dataset you don't mix features with
> > coordinates in different SRS, which is the usual practice), couldn't we
> > ? In which case the time parameter could be a property of the SRS, or
> > presumably next to the SRS
> > (since SRS can be transported by codes, and you can't code each different
> > time).
> > 
> > There's also the topic of raster maps (for high precision mapping) that
> > could also be affected by time dependant transformations. But in that
> > case it is obvious that a single time must be considered for the whole
> > map.
> 
> I'm not thinking that datasets will generally have different times (even if
> the data were originally collected that way).  More that the
> transformation API's ultimately work on coordinates.  So even if a
> feature's coordinates are not stored with a time, the dataset time could
> be assigned to the feature in preparation for the transformation (in the
> same way as we might set a SRS id to a feature).
> 
> The question here is whether to have a separate API for transformations
> that require a time, or whether to use the same API and embed the time
> within the feature/coordinate being transformed.

Regarding proj4, there wouldn't be any particular difficulty to extend its API, 
being a string, to include a "+time=XXXX.YY" parameter. The difficulty would be 
more in the logic to make something usefull with that time parameter. For 
Bursa-Wolf with derivatives, this should be easy. For grids, less obvious.

> 
> In terms of implementation I guess there will be efficiencies in preparing
> a transformation for a specific epoch - in effect defining a
> transformation object which is used for transformations and which can
> cache prepared transformations.  I'm not sure how this will sit with
> existing API's.
> 
> I'm not familiar with transforming raster maps, though I imagine the
> process would be to transform a set of reference coordinates that are used
> to morph the raster?

The naive way of transforming/warping a raster dataset is to consider the 
coordinate of the center of each pixel and to transform it into the target 
reference coordinate and build an image from that, which is an already solved 
problem. So if we know how to do a time-dependant transform for a feature, no 
particular difficulty transposing that to the raster side. But I just wanted to 
mention it for the sake of completeness as a "user" of such transforms.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


From gdt at ir.bbn.com  Tue Jan  6 16:13:27 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Tue, 06 Jan 2015 19:13:27 -0500
Subject: [Proj] Time dependent coordinate transformations
In-Reply-To: <666FB8D75E95AE42965A0E76A5E5337E14DDDAC56E@prdlsmmsg01.ad.linz.govt.nz>
	(Chris Crook's message of "Tue, 6 Jan 2015 09:13:36 +1300")
References: <666FB8D75E95AE42965A0E76A5E5337E14DE0520A4@prdlsmmsg01.ad.linz.govt.nz>
	<201501051231.32794.even.rouault@spatialys.com>
	<666FB8D75E95AE42965A0E76A5E5337E14DDDAC56E@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <rmia91v4fdk.fsf@fnord.ir.bbn.com>


Chris Crook <ccrook at linz.govt.nz> writes:

I only read geodesy texts as a hobby, but let me say that I think your
outline of the issues is spot on.

> The question here is whether to have a separate API for transformations that require
> a time, or whether to use the same API and embed the time within the
> feature/coordinate being transformed.

I think there are actually three ways to do this:

  1) put time in the coordinates for each point

  2) construct an object which is a pair: "(datum, time)", and use that
  instead of using datum

  3) manage time out of band, and add time values in transformation
  procedures

I find (2) to be the closest match to the world; people will still have
coordinates in a datum (be it crust-fixed or ITRF), but we'll be clear
about the epoch of the coordinates.  I would expect that (left coast
aside) the same values in NAD83 as of 2010 and NAD83 as of 2014 to
transform to almost zero difference in WGS84 or ITRF, but for the epoch
of the global frames to make a bigger difference.

It may be that 2 vs 3 is a distinction without a real difference in
changing a small number of procedures.

Another issue is horizontal datums vs 3D datums, which raises the issue
of time-dependent height transforms as well.  But presumably those fit
within the 15-parameter transforms you describe.   It does seem like an
extra source of complexity if a point is described by both a 2D and a
vertical datum, and one wants WGS84.  But, I've convinced myself that
there aren't vastly tricky additional time-dependent issues because of
that.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20150106/bde9a770/attachment.sig>

