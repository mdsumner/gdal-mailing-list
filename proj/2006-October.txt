From ovv at hetnet.nl  Sun Oct  1 15:34:08 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Mon, 02 Oct 2006 00:34:08 +0200
Subject: [Proj] Left- or right-handed rotation convention: which is which?
In-Reply-To: <24790336.1159633272325.JavaMail.tomcat@pne-ps4-sn2>
Message-ID: <C1460F00.818A%ovv@hetnet.nl>

> From: <mikael.rittri at telia.com>
> Date: Sat, 30 Sep 2006 18:21:12 +0200 (MEST)
> Subject: [Proj] Left- or right-handed rotation convention: which is which?
> 
> Hello,
> I am confused. 
> At my work, I have tried to document the rotation convention used by
> our software for seven-parameter datum shifts.  Since it was originally
> based on publications from the Swedish Land Survey, it uses the
> rotation convention of USA/Sweden/Luxembourg/Australia, as opposed to
> the opposite European/IAG/ISO19111 convention.
....
> Well, I suppose that everyone wants to be right, and no one wants to
> be left!  But are there any simple, unambiguous names for these two
> conventions?  Would the following be correct:
> American convention = "coordinate frame rotation";
> European convention = "position vector transformation".

Probably the best way to document a rotation method is: use the accepted
terms "coordinate frame" and "position vector".
These terms are also used in other disciplines like kinematics (robotics).
But there are more difficulties.

One datum transformation method is laid down in the ISO 19111 standard. This
is an approximated 7-parameter Helmert transformation with position vector
rotation. See also ISO/IEC 18026 - Annex B.
PROJ uses about the same method, only the scaling method differs. PROJ does
a scalar multiplication, ISO a matrix multiplication.
With the commonly used parameter ranges, the differences between the scaling
methods are less than microns, so not important.

As far as I know, the Bursa-Wolfe transform is an approximation to the
Helmert transform. The Helmert transform has sines and cosines in the
rotation matrices, whereas Bursa-Wolfe (and ISO 19111) use the angles
themselves (since sin(a) ~ a, sin(a)*sin(b) ~ 0, and cos(a) ~ 1 for small
angles).

If you read section B.6 of ISO/IEC 18026, then you'll notice that a
Bursa-Wolfe transform can be done with a position vector rotation model OR
with a coordinate frame rotation model. Just what one likes the best; be
sure to use the correct sign of the rotation angles. Therefore: Bursa-Wolfe
is NOT equivalent with this or that rotation model.

A well known expert repeatedly states that the Australians use the same
datum transform rotation model as the Americans.
This is NOT true!
The order of the rotations differs (XYZ vs. ZYX). See the Australian GDA
Technical Manual. By the way, if the rotations are approximated, then the
order is not important.
Again, the differences in rotation order for real life numbers are literally
microscopic.

This, and your (mr. Rittri) remarks merely demonstrate how silly it is to
refer to a datum transformation method as an American, Australian, European,
whatever regional model.

If you want to document the way for instance an application transforms, give
the complete formulae, not just an ill-defined name.

Why not referring to the EPSG coordinate transformation method numbers?
These clearly define the most used datum transformation methods and
projection methods.




From cjmce at lsu.edu  Sun Oct  1 19:10:09 2006
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Sun, 1 Oct 2006 21:10:09 -0500
Subject: [Proj] Left- or right-handed rotation convention: which is which?
Message-ID: <OF4E03CEF3.763ECA59-ON862571FB.000BEA89-862571FB.000BEAA6@lsu.edu>





Of course, my way is correct and everyone else is wrong!  :-)

Dr. Tomas Soler of the U.S. National Geodetic Survey gave an elaborate
exposition in Bulletin Geodesique regarding the left-handed vs.
right-handed rotations of the various transforms.  Apparently, somebody
misunderstood the distinction in Paris, and ergo, the "European" way of
doing things.  All of this became possible because of the American SECOR,
then TRANSIT, and currently NAVSTAR (GPS)geodetic satellite systems.  If
the Americans that invented the contraptions and put the stuff into orbit
for everyone else to get access to define it a particular way ... guess
which way is correct?

Whether it's infinitessimal rotations with arc seconds, radians, or
whatever ... there's two basic 7-parameter datum transformations - the
Molodensky that uses the geocentric coordinates of the datum origin and the
Bursa-Wolfe that does not use the datum origin.  The sign of the rotations
is right-handed as the Americans do it or left-handed as the continental
Europeans do it.

As long as a test point is published, it's pretty easy to distinguish what
the sign of the rotations are.  Without a test point, you're going to have
to rely on the nomenclature whether you like it or not.

C. Mugnier
LSU

>
> Hello,
> I am confused.
> At my work, I have tried to document the rotation convention used by
> our software for seven-parameter datum shifts.  Since it was originally
> based on publications from the Swedish Land Survey, it uses the
> rotation convention of USA/Sweden/Luxembourg/Australia, as opposed to
> the opposite European/IAG/ISO19111 convention.
....
> Well, I suppose that everyone wants to be right, and no one wants to
> be left!  But are there any simple, unambiguous names for these two
> conventions?  Would the following be correct:
> American convention = "coordinate frame rotation";
> European convention = "position vector transformation".

Probably the best way to document a rotation method is: use the accepted
terms "coordinate frame" and "position vector".
These terms are also used in other disciplines like kinematics (robotics).
But there are more difficulties.

One datum transformation method is laid down in the ISO 19111 standard.
This
is an approximated 7-parameter Helmert transformation with position vector
rotation. See also ISO/IEC 18026 - Annex B.
PROJ uses about the same method, only the scaling method differs. PROJ does
a scalar multiplication, ISO a matrix multiplication.
With the commonly used parameter ranges, the differences between the
scaling
methods are less than microns, so not important.

As far as I know, the Bursa-Wolfe transform is an approximation to the
Helmert transform. The Helmert transform has sines and cosines in the
rotation matrices, whereas Bursa-Wolfe (and ISO 19111) use the angles
themselves (since sin(a) ~ a, sin(a)*sin(b) ~ 0, and cos(a) ~ 1 for small
angles).

If you read section B.6 of ISO/IEC 18026, then you'll notice that a
Bursa-Wolfe transform can be done with a position vector rotation model OR
with a coordinate frame rotation model. Just what one likes the best; be
sure to use the correct sign of the rotation angles. Therefore: Bursa-Wolfe
is NOT equivalent with this or that rotation model.

A well known expert repeatedly states that the Australians use the same
datum transform rotation model as the Americans.
This is NOT true!
The order of the rotations differs (XYZ vs. ZYX). See the Australian GDA
Technical Manual. By the way, if the rotations are approximated, then the
order is not important.
Again, the differences in rotation order for real life numbers are
literally
microscopic.

This, and your (mr. Rittri) remarks merely demonstrate how silly it is to
refer to a datum transformation method as an American, Australian,
European,
whatever regional model.

If you want to document the way for instance an application transforms,
give
the complete formulae, not just an ill-defined name.

Why not referring to the EPSG coordinate transformation method numbers?
These clearly define the most used datum transformation methods and
projection methods.


_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj



From ollerery at engr.orst.edu  Tue Oct  3 15:56:58 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Tue, 03 Oct 2006 15:56:58 -0700
Subject: [Proj] Proj 4 error: no system list, errno: 2]
Message-ID: <4522EABA.9050405@engr.orst.edu>


-------------- next part --------------
An embedded message was scrubbed...
From: Ryan Ollerenshaw <ollerery at engr.orst.edu>
Subject: [UMN_MAPSERVER-USERS] Proj 4 error: no system list, errno: 2
Date: Tue, 3 Oct 2006 15:46:06 -0700
Size: 4050
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061003/91eba739/attachment.mht>

From sandeepkumar.jakkaraju at gmail.com  Thu Oct  5 23:51:53 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Fri, 6 Oct 2006 12:21:53 +0530
Subject: [Proj] pj_transform function
Message-ID: <c653c98f0610052351m696475acv2fd2290c16ea5a4c@mail.gmail.com>

Hi All


I want to transform ... this lat/lon 39.739/-104.985...

to world mercator project ..with the defintition


World Mercator <54004> +proj=merc +latts=0 +lon0=0 +k=1.000000 +x0=0 +y0=0
+ellps=WGS84 +datum=WGS84 +units=m no_defs <>

 but the method gives an "error"....

this method works fine if i give lat/lon say 42.4182,-74.2643

can some one help me ... Doesnt this pj_transform always work !!!



Thanx

Sandeep Jakkaraju

Senior Software Engineer

ACL-Wireless Research and Development Group.

Noida, India.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061006/7817dcbb/attachment.html>

From Hugo.Tyson at cpslocates.com  Fri Oct  6 01:38:01 2006
From: Hugo.Tyson at cpslocates.com (Hugo Tyson)
Date: Fri, 6 Oct 2006 09:38:01 +0100
Subject: [Proj] pj_transform function
Message-ID: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>

proj-bounces at lists.maptools.org <> wrote:
> I want to transform ... this lat/lon 39.739/-104.985...
> to world mercator project ..with the defintition
> 
> World Mercator <54004> +proj=merc +latts=0 +lon0=0
> +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
> 
> but the method gives an "error"....
> 
> this method works fine if i give lat/lon say 42.4182,-74.2643

I've not heard of "world mercator", but looking at the parameters
it's projecting into a plane tangent to the sphere at lat 0, lon 0.
So it only works for longitudes from -90 to +90 (though these map
to infinities in the projected plane).

Your example of -104 longitude is around the back of the earth,
on the "far side" from the projection plane.   Therefore a
line from the origin through the point never intersects the
projection plane, so no result can be calculated.  Hence your
error.  Lon -74 is in range, so it's OK.

HTH,
	- Huge


-- 
Hugo Tyson, Cambridge Positioning Systems Ltd
=************************************************************
********************************************************************************
This email and any attachments are confidential. They have been checked for viruses but it is your 
responsibility to conduct your own virus checks.
Cambridge Positioning Systems Limited, 62-64 Hills Road, Cambridge, CB2 1LA, is registered in England 
under company number 2808344.
********************************************************************************




From sandeepkumar.jakkaraju at gmail.com  Fri Oct  6 01:57:04 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Fri, 6 Oct 2006 14:27:04 +0530
Subject: [Proj] pj_transform function
In-Reply-To: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
References: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
Message-ID: <c653c98f0610060157n1c61a8c9xf969f01b3c8beee9@mail.gmail.com>

Hi Hugo

Thanx for your reply.

So what should be the  projection definition then .. to make it general..???

I am trying to convert the geographical co-ordinates to screen co-ordinates
..
so i require to convert the lat/lon to some projection and the convert that
X,Y to pixels...
hope this is correct ...

or is there some function in proj4/or anywhere else which does this ....??

Thanx again

sandeep



On 10/6/06, Hugo Tyson <Hugo.Tyson at cpslocates.com> wrote:
>
> proj-bounces at lists.maptools.org <> wrote:
> > I want to transform ... this lat/lon 39.739/-104.985...
> > to world mercator project ..with the defintition
> >
> > World Mercator <54004> +proj=merc +latts=0 +lon0=0
> > +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
> >
> > but the method gives an "error"....
> >
> > this method works fine if i give lat/lon say 42.4182,-74.2643
>
> I've not heard of "world mercator", but looking at the parameters
> it's projecting into a plane tangent to the sphere at lat 0, lon 0.
> So it only works for longitudes from -90 to +90 (though these map
> to infinities in the projected plane).
>
> Your example of -104 longitude is around the back of the earth,
> on the "far side" from the projection plane.   Therefore a
> line from the origin through the point never intersects the
> projection plane, so no result can be calculated.  Hence your
> error.  Lon -74 is in range, so it's OK.
>
> HTH,
>        - Huge
>
>
> --
> Hugo Tyson, Cambridge Positioning Systems Ltd
> =************************************************************
>
> ********************************************************************************
> This email and any attachments are confidential. They have been checked
> for viruses but it is your
> responsibility to conduct your own virus checks.
> Cambridge Positioning Systems Limited, 62-64 Hills Road, Cambridge, CB2
> 1LA, is registered in England
> under company number 2808344.
>
> ********************************************************************************
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Sandeep Kumar Jakkaraju
WeBlog:
http://jakkarajus.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061006/22427a16/attachment.html>

From Hugo.Tyson at cpslocates.com  Fri Oct  6 02:15:20 2006
From: Hugo.Tyson at cpslocates.com (Hugo Tyson)
Date: Fri, 6 Oct 2006 10:15:20 +0100
Subject: [Proj] pj_transform function
Message-ID: <DA84911DC41E2041AC4998F54C3E24FB7299FD@cps-ex1>

Sandeep Kumar Jakkaraju [sandeepkumar.jakkaraju at gmail.com] wrote:
> So what should be the  projection definition then .. to make
> it general..???
> 
> I am trying to convert the geographical co-ordinates to
> screen co-ordinates ..
> so i require to convert the lat/lon to some projection and
> the convert that X,Y to pixels...
> hope this is correct ...

Ah.  So you just want like a map of the whole world, as 
a rectangle, sort of thing?  That's not a "projection"
in the proj4 sense, as I understand it.

How about
	double x = (lon + 180.0)/360.0 * pixelswidth;
	double y = (lat +  90.0)/180.0 * pixelsheight;
of course that'll be ugly at far north and south,
but at least it maps the whole space.

> or is there some function in proj4/or anywhere else which
> does this ....??

I don't think this is the sort of thing that proj is for.

Alternatively if you're mapping a small areas of the world
into one page or bitmap, you need to pick a proj4 projection
that works for that small area.

	- Huge

PS I was mistaken in what I wrote before, mercator maps to a
half-cylinder wrapped around the globe.  Your example touches
at long 0.0, so it's still true that your long -104 is "around
the back".


> On 10/6/06, Hugo Tyson <Hugo.Tyson at cpslocates.com> wrote:
> 
> 	proj-bounces at lists.maptools.org <> wrote:
> 	> I want to transform ... this lat/lon 39.739/-104.985...
> 	> to world mercator project ..with the defintition 	>
> 	> World Mercator <54004> +proj=merc +latts=0 +lon0=0
> 	> +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs
> 	<> >
> 	> but the method gives an "error"....
> 	>
> 	> this method works fine if i give lat/lon say 42.4182,-74.2643
> 
> 	I've not heard of "world mercator", but looking at the parameters
> 	it's projecting into a plane tangent to the sphere at
> lat 0, lon 0.
> 	So it only works for longitudes from -90 to +90 (though
> these map
> 	to infinities in the projected plane).
> 
> 	Your example of -104 longitude is around the back of the earth,
> 	on the "far side" from the projection plane.   Therefore a
> 	line from the origin through the point never intersects the
> 	projection plane, so no result can be calculated.  Hence your
> 	error.  Lon -74 is in range, so it's OK.

-- 
Hugo Tyson, Cambridge Positioning Systems Ltd
=************************************************************
********************************************************************************
This email and any attachments are confidential. They have been checked for viruses but it is your 
responsibility to conduct your own virus checks.
Cambridge Positioning Systems Limited, 62-64 Hills Road, Cambridge, CB2 1LA, is registered in England 
under company number 2808344.
********************************************************************************




From sandeepkumar.jakkaraju at gmail.com  Fri Oct  6 02:58:49 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Fri, 6 Oct 2006 15:28:49 +0530
Subject: [Proj] pj_transform function
In-Reply-To: <DA84911DC41E2041AC4998F54C3E24FB7299FD@cps-ex1>
References: <DA84911DC41E2041AC4998F54C3E24FB7299FD@cps-ex1>
Message-ID: <c653c98f0610060258u629fbaf5kc7dfe3d316aea2e8@mail.gmail.com>

Hi Huge

Thanx again for your reply.

How will I know which projection to use for say Albany,NY when I want to
project my shapefile which is unprojected in lat/lon to some projection like
Mercator or anything else ?

I am trying to convert the geographical co-ordinates to screen co-ordinates
..
so i require to convert the lat/lon to some projection and then convert that
X,Y to pixels...
(hope this is correct ...!!)

I am using projected co-ordiantes of Albany using the projection definition

World Mercator <54004> +proj=merc +latts=0 +lon0=0
+k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs

but when i convert this projected X,Y in pixels
there is error of 2/3 pixels in X and 8/10 pixels in Y.
so this is not the right projection ....

It would be great if you could help me with this ...

Thanks

Sandeep
Senior Software Engineer
ACL-Wireless
Noida, India.





On 10/6/06, Hugo Tyson <Hugo.Tyson at cpslocates.com> wrote:
>
> Sandeep Kumar Jakkaraju [sandeepkumar.jakkaraju at gmail.com] wrote:
> > So what should be the  projection definition then .. to make
> > it general..???
> >
> > I am trying to convert the geographical co-ordinates to
> > screen co-ordinates ..
> > so i require to convert the lat/lon to some projection and
> > the convert that X,Y to pixels...
> > hope this is correct ...
>
> Ah.  So you just want like a map of the whole world, as
> a rectangle, sort of thing?  That's not a "projection"
> in the proj4 sense, as I understand it.
>
> How about
>        double x = (lon + 180.0)/360.0 * pixelswidth;
>        double y = (lat +  90.0)/180.0 * pixelsheight;
> of course that'll be ugly at far north and south,
> but at least it maps the whole space.
>
> > or is there some function in proj4/or anywhere else which
> > does this ....??
>
> I don't think this is the sort of thing that proj is for.
>
> Alternatively if you're mapping a small areas of the world
> into one page or bitmap, you need to pick a proj4 projection
> that works for that small area.
>
>        - Huge
>
> PS I was mistaken in what I wrote before, mercator maps to a
> half-cylinder wrapped around the globe.  Your example touches
> at long 0.0, so it's still true that your long -104 is "around
> the back".
>
>
> > On 10/6/06, Hugo Tyson <Hugo.Tyson at cpslocates.com> wrote:
> >
> >       proj-bounces at lists.maptools.org <> wrote:
> >       > I want to transform ... this lat/lon 39.739/-104.985...
> >       > to world mercator project ..with the defintition      >
> >       > World Mercator <54004> +proj=merc +latts=0 +lon0=0
> >       > +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m
> no_defs
> >       <> >
> >       > but the method gives an "error"....
> >       >
> >       > this method works fine if i give lat/lon say 42.4182,-74.2643
> >
> >       I've not heard of "world mercator", but looking at the parameters
> >       it's projecting into a plane tangent to the sphere at
> > lat 0, lon 0.
> >       So it only works for longitudes from -90 to +90 (though
> > these map
> >       to infinities in the projected plane).
> >
> >       Your example of -104 longitude is around the back of the earth,
> >       on the "far side" from the projection plane.   Therefore a
> >       line from the origin through the point never intersects the
> >       projection plane, so no result can be calculated.  Hence your
> >       error.  Lon -74 is in range, so it's OK.
>
> --
> Hugo Tyson, Cambridge Positioning Systems Ltd
> =************************************************************
>
> ********************************************************************************
> This email and any attachments are confidential. They have been checked
> for viruses but it is your
> responsibility to conduct your own virus checks.
> Cambridge Positioning Systems Limited, 62-64 Hills Road, Cambridge, CB2
> 1LA, is registered in England
> under company number 2808344.
>
> ********************************************************************************
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Sandeep Kumar Jakkaraju
WeBlog:
http://jakkarajus.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061006/47edac85/attachment.html>

From warmerdam at pobox.com  Fri Oct  6 08:03:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 06 Oct 2006 11:03:06 -0400
Subject: [Proj] pj_transform function
In-Reply-To: <c653c98f0610052351m696475acv2fd2290c16ea5a4c@mail.gmail.com>
References: <c653c98f0610052351m696475acv2fd2290c16ea5a4c@mail.gmail.com>
Message-ID: <4526702A.7020504@pobox.com>

Sandeep Kumar Jakkaraju wrote:
> Hi All
>  
>  
> I want to transform ... this lat/lon 39.739/-104.985...
>  
> to world mercator project ..with the defintition
>  
> 
> World Mercator <54004> +proj=merc +latts=0 +lon0=0 +k=1.000000 +x0=0 
> +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
> 
>  but the method gives an "error"....
> 
> this method works fine if i give lat/lon say 42.4182,-74.2643
> 
> can some one help me ... Doesnt this pj_transform always work !!!

Sandeep,

I expect the problem has to do with axis order.  By default proj
expects geographic locations in "longitude latitude" order.  So
you need to pass -104.985 39.729.

If -104 is treated as a latitude it will be beyond the legal range
(-90 to 90).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From gerald.evenden at verizon.mail  Fri Oct  6 08:26:11 2006
From: gerald.evenden at verizon.mail (Gerald I. Evenden)
Date: Fri, 06 Oct 2006 11:26:11 -0400
Subject: [Proj] pj_transform function
In-Reply-To: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
References: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
Message-ID: <200610061126.11181.gerald.evenden@verizon.mail>

On Friday 06 October 2006 4:38 am, Hugo Tyson wrote:
> proj-bounces at lists.maptools.org <> wrote:
> > I want to transform ... this lat/lon 39.739/-104.985...
> > to world mercator project ..with the defintition
> >
> > World Mercator <54004> +proj=merc +latts=0 +lon0=0
> > +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
> >
> > but the method gives an "error"....
> >
> > this method works fine if i give lat/lon say 42.4182,-74.2643
>
> I've not heard of "world mercator", but looking at the parameters
> it's projecting into a plane tangent to the sphere at lat 0, lon 0.
> So it only works for longitudes from -90 to +90 (though these map
> to infinities in the projected plane).
>
> Your example of -104 longitude is around the back of the earth,
> on the "far side" from the projection plane.   Therefore a
> line from the origin through the point never intersects the
> projection plane, so no result can be calculated.  Hence your
> error.  Lon -74 is in range, so it's OK.

Excuse me for jumping into the middle of this discussion, but Mercator and 
normal proj functioning span the range of +-180 degrees longitude.  The plane 
of the cylindrical projection projection is "unwrapped" from a cut on the 
projection cylinder opposite the longitude of the central meridian (CM) or 
180 degrees from the CM.  There is no such thing as the '"far side"' of the 
projection.

The following is an example:

gie at charon:~$ lproj +proj=merc +ellps=WGS84
-104.985 39.739
-11686876.74    4800765.45
-74.2643 42.4182
-8267064.06     5195000.64
gie at charon:~$

All the other parameters in the original problem are superfluous as they are 
default values of proj/lproj.  The datum option is not part of the proj/lproj 
system.


From romain.cherchi at gmail.com  Fri Oct  6 08:28:23 2006
From: romain.cherchi at gmail.com (Romain Cherchi)
Date: Fri, 6 Oct 2006 17:28:23 +0200
Subject: [Proj] What projections arguments to specify a custom ellipsoid ?
Message-ID: <2908808b0610060828o3965efceja2d6b925e2c1ff34@mail.gmail.com>

Hello,

I'm trying to add a line in the PostGIS SPATIAL_REF_SYS Table.

My SRS WKT is:
PROJCS["NTF_Lambert_II_étendu",
    GEOGCS["GCS_NTF",
        DATUM["Nouvelle_Triangulation_Francaise",
            SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433]],
    PROJECTION["Lambert_Conformal_Conic_1SP"],
    PARAMETER["False_Easting",600000.0],
    PARAMETER["False_Northing",2200000.0],
    PARAMETER["Central_Meridian",2.3372291667],
    PARAMETER["Standard_Parallel_1",45.8989188889],
    PARAMETER["Standard_Parallel_2",47.6960144444],
    PARAMETER["Scale_Factor",1.0],
    PARAMETER["Latitude_Of_Origin",46.8],
    UNIT["Meter",1.0]]

And I'm trying to figure out what is the corresponding proj4text:
+proj=lcc    +x_0=600000
                  +y_0=2200000
                  +lon_0=2.3372291667
                  +lat_1=45.8989188889
                  +lat_2=47.6960144444
                  +k_0=1
                  +lat_0=46.8
                  +units=m
                  +a=6378249.2
                  +towgs84=-168,-60,320,0,0,0,0
                  +pm=greenwich

However, I've some problems finding information about projections arguments,
especially about spheroid information.

SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],

I guess I can use "+a" for 6378249.2 but what is  the argument for
293.46602 ?

NB: I already tryied :
$ proj -le | grep clrk80
   clrk80 a=6378249.145    rf=293.4663      Clarke 1880 mod.

But it seam that I can't use the +ellps=clrk80 because the values don't
match exactly with mine.

May I use +rf=293.46602 ?

What about this UNIT["Degree",0.0174532925199433]], ?



Thanks in advance


Best regards
-- 
Romain CHERCHI
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061006/028fada1/attachment.html>

From warmerdam at pobox.com  Fri Oct  6 08:57:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 06 Oct 2006 11:57:53 -0400
Subject: [Proj] What projections arguments to specify a custom ellipsoid ?
In-Reply-To: <2908808b0610060828o3965efceja2d6b925e2c1ff34@mail.gmail.com>
References: <2908808b0610060828o3965efceja2d6b925e2c1ff34@mail.gmail.com>
Message-ID: <45267D01.3090206@pobox.com>

Romain Cherchi wrote:
> Hello,
> 
> I'm trying to add a line in the PostGIS SPATIAL_REF_SYS Table.
> 
> My SRS WKT is:
> PROJCS["NTF_Lambert_II_étendu",
>     GEOGCS["GCS_NTF",
>         DATUM["Nouvelle_Triangulation_Francaise",
>             SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],
>         PRIMEM["Greenwich",0.0],
>         UNIT["Degree",0.0174532925199433]],
>     PROJECTION["Lambert_Conformal_Conic_1SP"],
>     PARAMETER["False_Easting",600000.0],
>     PARAMETER["False_Northing",2200000.0],
>     PARAMETER["Central_Meridian",2.3372291667],
>     PARAMETER["Standard_Parallel_1", 45.8989188889],
>     PARAMETER["Standard_Parallel_2",47.6960144444],
>     PARAMETER["Scale_Factor",1.0],
>     PARAMETER["Latitude_Of_Origin",46.8],
>     UNIT["Meter",1.0]]
> 
> And I'm trying to figure out what is the corresponding proj4text:
> +proj=lcc    +x_0=600000
>                   +y_0=2200000
>                   +lon_0=2.3372291667
>                   +lat_1=45.8989188889
>                   +lat_2= 47.6960144444
>                   +k_0=1
>                   +lat_0=46.8
>                   +units=m
>                   +a=6378249.2
>                   +towgs84=-168,-60,320,0,0,0,0
>                   +pm=greenwich
> 
> However, I've some problems finding information about projections 
> arguments, especially about spheroid information.
> 
> SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],
> 
> I guess I can use "+a" for 6378249.2 but what is  the argument for  
> 293.46602 ?
> 
> NB: I already tryied :
> $ proj -le | grep clrk80
>    clrk80 a=6378249.145    rf=293.4663      Clarke 1880 mod.
 >
> But it seam that I can't use the +ellps=clrk80 because the values don't 
> match exactly with mine.
> 
> May I use +rf=293.46602 ?

I would suggest explicitly listing the +a and +rf values instead of
trying to use a predefined ellipsoid since there doesn't seem to
be an exact match.

> What about this UNIT["Degree",0.0174532925199433]], ?

This doesn't have any application to the PROJ.4 string.  The angular values
are already implicitly in decimal degrees.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From gerald.evenden at verizon.mail  Fri Oct  6 10:08:57 2006
From: gerald.evenden at verizon.mail (Gerald I. Evenden)
Date: Fri, 06 Oct 2006 13:08:57 -0400
Subject: [Proj] What projections arguments to specify a custom ellipsoid ?
In-Reply-To: <2908808b0610060828o3965efceja2d6b925e2c1ff34@mail.gmail.com>
References: <2908808b0610060828o3965efceja2d6b925e2c1ff34@mail.gmail.com>
Message-ID: <200610061308.57454.gerald.evenden@verizon.mail>

On Friday 06 October 2006 11:28 am, Romain Cherchi wrote:
> Hello,
>
> I'm trying to add a line in the PostGIS SPATIAL_REF_SYS Table.
>
> My SRS WKT is:
> PROJCS["NTF_Lambert_II_étendu",
>     GEOGCS["GCS_NTF",
>         DATUM["Nouvelle_Triangulation_Francaise",
>             SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],

Suggest:
gie at charon:~$ lproj -le | grep Clarke
   clrk66 a=6378206.4      b=6356583.8      Clarke 1866
  clrk66M a=6378693.704    b=6357069.451    Clarke 1866 Michigan
   clrk80 a=6378249.145    b=6356514.960    Clarke 1880 (Arc)
  clrk80M a=6378249.139    rf=293.4663      Clarke 1880
  clrk80B a=6378300.79     b=6356566.43     Clarke 1880 (Benoit)
  clrk80I a=6378249.2      rf=293.46602     Clarke 1880 (IGN)
  clrk80R a=6378249.145    rf=293.465       Clarke 1880 (RGS)
  clrk80S a=6378249.2      rf=293.46598     Clarke 1880 (SGA 1922)
gie at charon:~$
Thus it is apparent that the proj option (third from bottom)
   +ellps=clrk80I
would be appropriate for matching specified projection.  You were a little too 
selective in your grep search.

>         PRIMEM["Greenwich",0.0],
>         UNIT["Degree",0.0174532925199433]],

Pi/180 or value to multiply degrees by to get radians.  I wonder what the use 
is as the angular values in the specs appear to be degrees.

>     PROJECTION["Lambert_Conformal_Conic_1SP"],
>     PARAMETER["False_Easting",600000.0],
>     PARAMETER["False_Northing",2200000.0],
>     PARAMETER["Central_Meridian",2.3372291667],
>     PARAMETER["Standard_Parallel_1",45.8989188889],
>     PARAMETER["Standard_Parallel_2",47.6960144444],
>     PARAMETER["Scale_Factor",1.0],
>     PARAMETER["Latitude_Of_Origin",46.8],
>     UNIT["Meter",1.0]]
>
> And I'm trying to figure out what is the corresponding proj4text:
> +proj=lcc    +x_0=600000
>                   +y_0=2200000
>                   +lon_0=2.3372291667
>                   +lat_1=45.8989188889
>                   +lat_2=47.6960144444
>                   +k_0=1
>                   +lat_0=46.8
>                   +units=m
>                   +a=6378249.2
>                   +towgs84=-168,-60,320,0,0,0,0
>                   +pm=greenwich
>
> However, I've some problems finding information about projections
> arguments, especially about spheroid information.
>
> SPHEROID["Clarke_1880_IGN",6378249.2,293.46602]],
>
> I guess I can use "+a" for 6378249.2 but what is  the argument for
> 293.46602 ?
>
> NB: I already tryied :
> $ proj -le | grep clrk80
>    clrk80 a=6378249.145    rf=293.4663      Clarke 1880 mod.
>
> But it seam that I can't use the +ellps=clrk80 because the values don't
> match exactly with mine.
>
> May I use +rf=293.46602 ?
>
> What about this UNIT["Degree",0.0174532925199433]], ?
>
>
>
> Thanks in advance
>
>
> Best regards



From jjholt at hiwaay.net  Fri Oct  6 10:28:45 2006
From: jjholt at hiwaay.net (jjholt at hiwaay.net)
Date: Fri, 06 Oct 2006 12:28:45 -0500 (CDT)
Subject: [Proj] proj deployment question 
Message-ID: <1160155725.4526924d67593@webmail.hiwaay.net>


I have created a VC++ COM component that our application uses for projection
services. It links with proj as a static Win32 library to do the actual projection.

It works great, but I'm wondering about deployment issues. Normally I thought
the proj library requires some files - eg "nad" directory and maybe others.
However my component seems to work even on systems without any other proj files
on it.

We only do relatively simple stuff - geographics to/from UTM, geographic to from
Mercator, and UTM zone to zone. Is that why? Maybe "nad" is only needed for
"datum shifts"? I don't know what a "datum" is, let alone how to shift one :-)

I suppose another way to put it is: what capabilities won't work without
external proj files?

Thanks,
Jeff





From warmerdam at pobox.com  Fri Oct  6 11:01:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 06 Oct 2006 14:01:57 -0400
Subject: [Proj] proj deployment question
In-Reply-To: <1160155725.4526924d67593@webmail.hiwaay.net>
References: <1160155725.4526924d67593@webmail.hiwaay.net>
Message-ID: <45269A15.6050304@pobox.com>

jjholt at hiwaay.net wrote:
> I have created a VC++ COM component that our application uses for projection
> services. It links with proj as a static Win32 library to do the actual projection.
> 
> It works great, but I'm wondering about deployment issues. Normally I thought
> the proj library requires some files - eg "nad" directory and maybe others.
> However my component seems to work even on systems without any other proj files
> on it.
> 
> We only do relatively simple stuff - geographics to/from UTM, geographic to from
> Mercator, and UTM zone to zone. Is that why? Maybe "nad" is only needed for
> "datum shifts"? I don't know what a "datum" is, let alone how to shift one :-)
> 
> I suppose another way to put it is: what capabilities won't work without
> external proj files?

Jeff,

Without the contents of the nad directory you won't be able to use the
init files (eg. +init=epsg:4326) or do grid shift based datum shifts
(ie. NAD27 -> NAD83).  Also the default values found in proj_def.dat won't
be in play - so you may need to be explicit about things like ellipsoid
for instance.

If you are careful to fully define your coordinate systems, the only real
capability you should be missing is the grid shift datum shifting.  Note
that +towgs84 datum shifting will still work.

PS. There is a modest COM component now found in proj/com.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From jjholt at hiwaay.net  Fri Oct  6 12:09:45 2006
From: jjholt at hiwaay.net (jjholt at hiwaay.net)
Date: Fri, 06 Oct 2006 14:09:45 -0500 (CDT)
Subject: [Proj] proj deployment question
In-Reply-To: <45269A15.6050304@pobox.com>
References: <1160155725.4526924d67593@webmail.hiwaay.net>
	<45269A15.6050304@pobox.com>
Message-ID: <1160161785.4526a9f935403@webmail.hiwaay.net>


Thanks for the response, I think I understand the issues now. I always specify
an ellipse in the init string, so it sounds like I'm OK!

Jeff


Quoting Frank Warmerdam <warmerdam at pobox.com>:

> jjholt at hiwaay.net wrote:
> > I have created a VC++ COM component that our application uses for
> projection
> > services. It links with proj as a static Win32 library to do the
> actual projection.
> > 
> > It works great, but I'm wondering about deployment issues. Normally I
> thought
> > the proj library requires some files - eg "nad" directory and maybe
> others.
> > However my component seems to work even on systems without any other
> proj files
> > on it.
> > 
> > We only do relatively simple stuff - geographics to/from UTM,
> geographic to from
> > Mercator, and UTM zone to zone. Is that why? Maybe "nad" is only
> needed for
> > "datum shifts"? I don't know what a "datum" is, let alone how to shift
> one :-)
> > 
> > I suppose another way to put it is: what capabilities won't work
> without
> > external proj files?
> 
> Jeff,
> 
> Without the contents of the nad directory you won't be able to use the
> init files (eg. +init=epsg:4326) or do grid shift based datum shifts
> (ie. NAD27 -> NAD83).  Also the default values found in proj_def.dat
> won't
> be in play - so you may need to be explicit about things like ellipsoid
> for instance.
> 
> If you are careful to fully define your coordinate systems, the only
> real
> capability you should be missing is the grid shift datum shifting. 
> Note
> that +towgs84 datum shifting will still work.
> 
> PS. There is a modest COM component now found in proj/com.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo,
> http://osgeo.org
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 


From fabriceyarel at hotmail.com  Thu Oct  5 14:30:40 2006
From: fabriceyarel at hotmail.com (fabrice leray)
Date: Thu, 05 Oct 2006 21:30:40 +0000
Subject: [Proj] desperate with proj4
Message-ID: <BAY121-F14224E5F27C97B1D8E025ED4120@phx.gbl>

Hi,

I had this problem too: the thing is that you do not jave to install proj4 
by yourself you MUST use the library delivered Deegree. So make a search to 
your .dll (or .so depending on what OS you are) and point to that path.

I hope this help...


Nevertheless, I have another problem with the projection feature (again):

with example GetMap delivered with Deegree, nothing appears and  I have this 
stack trace:

Using: defaultChannelName=deegree, 
mailNotificationAddress=administrator at localhost, 
mailSessionName=mail/DefaultSession, log.mail.active=false
Using Logging Class: org.deegree.framework.log.Log4JLogger
[23:17:17]  INFO: Starting deegree version 2.0.0 (2006/07/26 16:26 
official-b1) on server: Apache Tomcat/5.5.20 / Java version: 1.5.0_08
[23:17:17]  INFO: Initializing OGC services in context deegree WMS  - 2st 
preRelease for V. 2.0 and real path C:\Program Files\Apache Software 
Foundation\Tomcat 5.5\temp\0-deegree2\index.jsp
[23:17:17]  INFO: - Initializing WMS -
[23:17:17]  INFO: Reading configuration for WMS from URL: 'file:/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/conf/wms/wms_configuration.xml'.
[23:17:19]  INFO: Parsing (mapped) GML application schema file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/conf/wms/featuretypes/Philosopher.xsd'.
[23:17:20]  INFO: Parsing (mapped) GML application schema file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/conf/wms/featuretypes/SGID024_Springs.xsd'.
[23:17:20]  INFO: Opening dbf file 
'../../../data/utah/vector/SGID024_Springs'.
[23:17:20]  INFO: Successfully opened dbf file 
'../../../data/utah/vector/SGID024_Springs' and retrieved the property 
columns.
[23:17:20]  INFO: Retrieved feature type information from the attached 
schema.
[23:17:20]  INFO: Validating the column names in the dbf file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/data/utah/vector/SGID024_Springs' with the 
declared feature type properties.
[23:17:20]  INFO: Validation successful.
[23:17:20]  INFO: Parsing (mapped) GML application schema file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/conf/wms/featuretypes/SGID024_StateBoundary.xsd'.
[23:17:20]  INFO: Opening dbf file 
'../../../data/utah/vector/SGID024_StateBoundary'.
[23:17:20]  INFO: Successfully opened dbf file 
'../../../data/utah/vector/SGID024_StateBoundary' and retrieved the property 
columns.
[23:17:20]  INFO: Retrieved feature type information from the attached 
schema.
[23:17:20]  INFO: Validating the column names in the dbf file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/data/utah/vector/SGID024_StateBoundary' with the 
declared feature type properties.
[23:17:20]  INFO: Validation successful.
[23:17:20]  INFO: Parsing (mapped) GML application schema file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/conf/wms/featuretypes/SGID100_RailroadsDLG100.xsd'.
[23:17:20]  INFO: Opening dbf file 
'../../../data/utah/vector/SGID100_RailroadsDLG100'.
[23:17:20]  INFO: Successfully opened dbf file 
'../../../data/utah/vector/SGID100_RailroadsDLG100' and retrieved the 
property columns.
[23:17:20]  INFO: Retrieved feature type information from the attached 
schema.
[23:17:20]  INFO: Validating the column names in the dbf file '/C:/Program 
Files/Apache Software Foundation/Tomcat 
5.5/temp/0-deegree2/WEB-INF/data/utah/vector/SGID100_RailroadsDLG100' with 
the declared feature type properties.
[23:17:20]  INFO: Validation successful.
[23:17:20]  INFO: Creating WFService instance.
[23:17:21]  INFO: Creating WFService instance.
[23:17:21]  INFO: Creating WFService instance.
[23:17:21]  INFO: <DataDirectoryList> evaluation is not suporrted yet
[23:17:21]  INFO: deegree wms (1.1.1) service pool initialized.
[23:17:21]  INFO: WMS successfully initialized.
[23:17:21]  INFO: Installed OGC services: WMS on server:
[23:17:21]  INFO: - IP: 192.168.1.64
[23:17:21]  INFO: - Host name: falcon
[23:17:21]  INFO: - Domain name: 192.168.1.64
[23:17:47]  INFO: Incoming request from 127.0.0.1/127.0.0.1 - 1160083067109
[23:17:47]  INFO: requested server address: 
http://127.0.0.1:8080/deegree2/ogcwebservice
[Fatal Error] :1:1: Content is not allowed in prolog.
[23:17:47]  INFO: Request could not be parsed as XML, trying to handle it as 
KVP encoded now.
[23:17:47]  INFO: Handling request '2' from '127.0.0.1' to service: 'WMS'
java.lang.NullPointerException
	at java.io.File.<init>(Unknown Source)
	at org.deegree.model.proj4.Projections.readDefinition(Projections.java:160)
	at org.deegree.model.proj4.Projections.<init>(Projections.java:146)
	at org.deegree.model.proj4.Others.<init>(Others.java:65)
	at org.deegree.model.proj4.Projections.create(Projections.java:127)
	at 
org.deegree.model.crs.CoordinateSystem.getAsProjection(CoordinateSystem.java:174)
	at 
org.deegree.model.crs.CoordinateSystem.getUnits(CoordinateSystem.java:221)
	at org.deegree.framework.util.MapUtil.calcScale(MapUtil.java:95)
	at 
org.deegree.ogcwebservices.wms.DefaultGetMapHandler.performGetMap(DefaultGetMapHandler.java:182)
	at org.deegree.ogcwebservices.wms.WMService.doService(WMService.java:126)
	at org.deegree.enterprise.servlet.WMSHandler.perform(WMSHandler.java:170)
	at 
org.deegree.enterprise.servlet.OGCServletController.doService(OGCServletController.java:150)
	at 
org.deegree.enterprise.servlet.OGCServletController.doGet(OGCServletController.java:244)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at 
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
	at 
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
	at 
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
	at 
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)
	at 
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)
	at 
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
	at 
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
	at 
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
	at 
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
	at 
org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
	at 
org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
	at 
org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
	at 
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
	at java.lang.Thread.run(Unknown Source)
[23:17:47]  INFO: OGC WMS scale: 0.0
[23:17:47] ERROR: null is not a valid CRS
org.deegree.model.crs.CRSTransformationException: null is not a valid CRS
	at org.deegree.model.crs.GeoTransformer.<init>(GeoTransformer.java:96)
	at 
org.deegree.ogcwebservices.wms.DefaultGetMapHandler.validate(DefaultGetMapHandler.java:574)
	at 
org.deegree.ogcwebservices.wms.DefaultGetMapHandler.invokeNamedLayer(DefaultGetMapHandler.java:296)
	at 
org.deegree.ogcwebservices.wms.DefaultGetMapHandler.performGetMap(DefaultGetMapHandler.java:216)
	at org.deegree.ogcwebservices.wms.WMService.doService(WMService.java:126)
	at org.deegree.enterprise.servlet.WMSHandler.perform(WMSHandler.java:170)
	at 
org.deegree.enterprise.servlet.OGCServletController.doService(OGCServletController.java:150)
	at 
org.deegree.enterprise.servlet.OGCServletController.doGet(OGCServletController.java:244)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at 
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
	at 
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
	at 
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
	at 
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)
	at 
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)
	at 
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
	at 
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
	at 
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
	at 
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
	at 
org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
	at 
org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
	at 
org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
	at 
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
	at java.lang.Thread.run(Unknown Source)
Caused by: org.deegree.model.proj4.Proj4Exception: null is not a valid CRS
	at org.deegree.model.proj4.Projections.<init>(Projections.java:150)
	at org.deegree.model.proj4.Others.<init>(Others.java:65)
	at org.deegree.model.proj4.Projections.create(Projections.java:127)
	at 
org.deegree.model.crs.CoordinateSystem.getAsProjection(CoordinateSystem.java:174)
	at org.deegree.model.crs.GeoTransformer.<init>(GeoTransformer.java:94)
	... 23 more
java.lang.NullPointerException
	at 
org.deegree.enterprise.servlet.WMSHandler.writeServiceExceptionReport(WMSHandler.java:445)
	at 
org.deegree.enterprise.servlet.WMSHandler.handleResponse(WMSHandler.java:192)
	at org.deegree.enterprise.servlet.WMSHandler.perform(WMSHandler.java:175)
	at 
org.deegree.enterprise.servlet.OGCServletController.doService(OGCServletController.java:150)
	at 
org.deegree.enterprise.servlet.OGCServletController.doGet(OGCServletController.java:244)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at 
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
	at 
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
	at 
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
	at 
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)
	at 
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)
	at 
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
	at 
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
	at 
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
	at 
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
	at 
org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
	at 
org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
	at 
org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
	at 
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
	at java.lang.Thread.run(Unknown Source)
[23:17:47] ERROR:
java.lang.NullPointerException
	at 
org.deegree.enterprise.servlet.WMSHandler.writeServiceExceptionReport(WMSHandler.java:445)
	at 
org.deegree.enterprise.servlet.WMSHandler.handleResponse(WMSHandler.java:192)
	at org.deegree.enterprise.servlet.WMSHandler.perform(WMSHandler.java:175)
	at 
org.deegree.enterprise.servlet.OGCServletController.doService(OGCServletController.java:150)
	at 
org.deegree.enterprise.servlet.OGCServletController.doGet(OGCServletController.java:244)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at 
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
	at 
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
	at 
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
	at 
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)
	at 
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)
	at 
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
	at 
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
	at 
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
	at 
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
	at 
org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
	at 
org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
	at 
org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
	at 
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
	at java.lang.Thread.run(Unknown Source)
[23:17:47] ERROR: null
java.lang.NullPointerException
	at 
org.deegree.enterprise.servlet.WMSHandler.writeServiceExceptionReport(WMSHandler.java:445)
	at 
org.deegree.enterprise.servlet.WMSHandler.handleResponse(WMSHandler.java:192)
	at org.deegree.enterprise.servlet.WMSHandler.perform(WMSHandler.java:175)
	at 
org.deegree.enterprise.servlet.OGCServletController.doService(OGCServletController.java:150)
	at 
org.deegree.enterprise.servlet.OGCServletController.doGet(OGCServletController.java:244)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at 
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)
	at 
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)
	at 
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)
	at 
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)
	at 
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)
	at 
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)
	at 
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)
	at 
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)
	at 
org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)
	at 
org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)
	at 
org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)
	at 
org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)
	at 
org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)
	at java.lang.Thread.run(Unknown Source)
[23:17:47]  INFO: nullnull
org.deegree.enterprise.ServiceException
org.deegree.enterprise.servlet.OGCServletController 
OGCServletController.java doService(165)
org.deegree.enterprise.servlet.OGCServletController 
OGCServletController.java doGet(244)
javax.servlet.http.HttpServlet HttpServlet.java service(689)
javax.servlet.http.HttpServlet HttpServlet.java service(802)
org.apache.catalina.core.ApplicationFilterChain ApplicationFilterChain.java 
internalDoFilter(252)
org.apache.catalina.core.ApplicationFilterChain ApplicationFilterChain.java 
doFilter(173)

[23:17:47]  INFO: java.lang.ClassCastException: 
org.deegree.ogcwebservices.OGCWebServiceException




It seems to have a recognition problem with my request.

pb. seems to come from:
"org.deegree.model.proj4.Projections.readDefinition" method...


:(
If anybody can help.... Thanks in advance.





============
Deegree seems to do fabulous job  but what a pity to configure... Nevermind, 
I'll keep hanging on... ;)




From sandeepkumar.jakkaraju at gmail.com  Fri Oct  6 22:24:41 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Sat, 7 Oct 2006 10:54:41 +0530
Subject: [Proj] pj_transform function
In-Reply-To: <200610061126.11181.gerald.evenden@verizon.mail>
References: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
	<200610061126.11181.gerald.evenden@verizon.mail>
Message-ID: <c653c98f0610062224k13f0802bl57d7b6f4bca7e34b@mail.gmail.com>

Hi

I am doing this ....

I have lat/lon of Top Left Corner of the Map and  Bottom Right Corner of The
Map
iam converting them to projected X,Y using this projection defintion

World Mercator <54004> +proj=merc +latts=0 +lon0=0 +k=1.000000 +x0=0
+y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>

( I have found on some site that Google Maps use this projection !!)


For example:

       tl_lat = 42.8483;
       tl_lon = -74.2935;
       br_lat = 42.3813;
       br_lon = -73.6509;


using pj_transform of proj4.. iam converting them to X,Y.


top left xy

-8270314.5893 , 5259843.0071

btm right xy

-8198780.6845 , 5189458.4882

I calculate the Centre cX,cY using the top left X,Y and Btm right X,Y...

The Size of the Image I have generated from the Map is (1031,801)...

width = absolute value of (btm right X - top left X)

height = absolute value of (btm right Y - top left Y)

Now I am trying to get the pixel x,y from the projected X,Y using this
formula

       px = 515.5 +  (1031/width)*(X-cX);
       py = 400.5  -  (801/height)*(Y-cY);

This gives correct pixels if i give top left or bottom right or the centre
X,Y...

But for some point inside the Image ...

the calcualted pixel X is some 2/3 pixels away from actual pixel X

the calcualted pixel Y is some 8/10 pixels away from actual pixel Y

where am I going wrong ... is the projection iam using correct for such
calculations ..???



Thanks in advance.

sandeep


On 10/6/06, Gerald I. Evenden <gerald.evenden at verizon.mail> wrote:
>
> On Friday 06 October 2006 4:38 am, Hugo Tyson wrote:
> > proj-bounces at lists.maptools.org <> wrote:
> > > I want to transform ... this lat/lon 39.739/-104.985...
> > > to world mercator project ..with the defintition
> > >
> > > World Mercator <54004> +proj=merc +latts=0 +lon0=0
> > > +k=1.000000 +x0=0 +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
> > >
> > > but the method gives an "error"....
> > >
> > > this method works fine if i give lat/lon say 42.4182,-74.2643
> >
> > I've not heard of "world mercator", but looking at the parameters
> > it's projecting into a plane tangent to the sphere at lat 0, lon 0.
> > So it only works for longitudes from -90 to +90 (though these map
> > to infinities in the projected plane).
> >
> > Your example of -104 longitude is around the back of the earth,
> > on the "far side" from the projection plane.   Therefore a
> > line from the origin through the point never intersects the
> > projection plane, so no result can be calculated.  Hence your
> > error.  Lon -74 is in range, so it's OK.
>
> Excuse me for jumping into the middle of this discussion, but Mercator and
> normal proj functioning span the range of +-180 degrees longitude.  The
> plane
> of the cylindrical projection projection is "unwrapped" from a cut on the
> projection cylinder opposite the longitude of the central meridian (CM) or
> 180 degrees from the CM.  There is no such thing as the '"far side"' of
> the
> projection.
>
> The following is an example:
>
> gie at charon:~$ lproj +proj=merc +ellps=WGS84
> -104.985 39.739
> -11686876.74    4800765.45
> -74.2643 42.4182
> -8267064.06     5195000.64
> gie at charon:~$
>
> All the other parameters in the original problem are superfluous as they
> are
> default values of proj/lproj.  The datum option is not part of the
> proj/lproj
> system.
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Sandeep Kumar Jakkaraju
WeBlog:
http://jakkarajus.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061007/18228931/attachment.html>

From gerald.evenden at verizon.mail  Sat Oct  7 07:12:46 2006
From: gerald.evenden at verizon.mail (Gerald I. Evenden)
Date: Sat, 07 Oct 2006 10:12:46 -0400
Subject: [Proj] pj_transform function
In-Reply-To: <c653c98f0610062224k13f0802bl57d7b6f4bca7e34b@mail.gmail.com>
References: <DA84911DC41E2041AC4998F54C3E24FB7299F4@cps-ex1>
	<200610061126.11181.gerald.evenden@verizon.mail>
	<c653c98f0610062224k13f0802bl57d7b6f4bca7e34b@mail.gmail.com>
Message-ID: <200610071012.46199.gerald.evenden@verizon.mail>

On Saturday 07 October 2006 1:24 am, Sandeep Kumar Jakkaraju wrote:
> Hi
>
> I am doing this ....
>
> I have lat/lon of Top Left Corner of the Map and  Bottom Right Corner of
> The Map
> iam converting them to projected X,Y using this projection defintion
>
> World Mercator <54004> +proj=merc +latts=0 +lon0=0 +k=1.000000 +x0=0
> +y0=0 +ellps=WGS84 +datum=WGS84 +units=m no_defs <>
>
> ( I have found on some site that Google Maps use this projection !!)
>
>
> For example:
>
>        tl_lat = 42.8483;
>        tl_lon = -74.2935;
>        br_lat = 42.3813;
>        br_lon = -73.6509;

I agree with these values-- for lat_ts=0.  No such option as "latts=0" above.  
But fortunately, the default value is 0 anyway.

> using pj_transform of proj4.. iam converting them to X,Y.
>
>
> top left xy
>
> -8270314.5893 , 5259843.0071
>
> btm right xy
>
> -8198780.6845 , 5189458.4882
>
> I calculate the Centre cX,cY using the top left X,Y and Btm right X,Y...
>
> The Size of the Image I have generated from the Map is (1031,801)...
>
> width = absolute value of (btm right X - top left X)
>
> height = absolute value of (btm right Y - top left Y)
>
> Now I am trying to get the pixel x,y from the projected X,Y using this
> formula
>
>        px = 515.5 +  (1031/width)*(X-cX);
>        py = 400.5  -  (801/height)*(Y-cY);
>
> This gives correct pixels if i give top left or bottom right or the centre
> X,Y...
>
> But for some point inside the Image ...
>
> the calcualted pixel X is some 2/3 pixels away from actual pixel X
>
> the calcualted pixel Y is some 8/10 pixels away from actual pixel Y
>
> where am I going wrong ... is the projection iam using correct for such
> calculations ..???

I have no idea other than the selected projection is in error *or* the lat_ts 
value is not 0.  None of the other options would produce errors if the corner 
values compute correctly.


From hamish_nospam at yahoo.com  Sat Oct  7 20:04:52 2006
From: hamish_nospam at yahoo.com (Hamish)
Date: Sun, 8 Oct 2006 16:04:52 +1300
Subject: [Proj] proj deployment question
In-Reply-To: <1160155725.4526924d67593@webmail.hiwaay.net>
References: <1160155725.4526924d67593@webmail.hiwaay.net>
Message-ID: <20061008160452.4100a1f8.hamish_nospam@yahoo.com>

> I don't know what a "datum" is, let alone how to shift one :-)

here's some bedtime reading:

  http://grass.gdf-hannover.de/wiki/Gis_Concepts#Background_material

"An introduction to geodetic datums" by Peter Dana
  http://www.colorado.edu/geography/gcraft/notes/datum/datum.html



Hamish


From ron at russfam.freeserve.co.uk  Sun Oct  8 01:56:20 2006
From: ron at russfam.freeserve.co.uk (Ron Russell)
Date: Sun, 8 Oct 2006 09:56:20 +0100
Subject: [Proj] proj deployment question
In-Reply-To: <20061008160452.4100a1f8.hamish_nospam@yahoo.com>
Message-ID: <000001c6eab7$9fecd150$465c4554@DELL3000>

I always thought

http://www.ordnancesurvey.co.uk/oswebsite/gps/information/coordinatesystemsi
nfo/guidecontents/index.html

was a good description, at my sort of level.

Ron
-----Original Message-----
From: proj-bounces at lists.maptools.org
[mailto:proj-bounces at lists.maptools.org] On Behalf Of Hamish
Sent: 08 October 2006 04:05
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] proj deployment question

> I don't know what a "datum" is, let alone how to shift one :-)

here's some bedtime reading:

  http://grass.gdf-hannover.de/wiki/Gis_Concepts#Background_material

"An introduction to geodetic datums" by Peter Dana
  http://www.colorado.edu/geography/gcraft/notes/datum/datum.html



Hamish
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj






From hamish_nospam at yahoo.com  Sun Oct  8 03:35:24 2006
From: hamish_nospam at yahoo.com (Hamish)
Date: Sun, 8 Oct 2006 23:35:24 +1300
Subject: [Proj] proj deployment question
In-Reply-To: <000001c6eab7$9fecd150$465c4554@DELL3000>
References: <20061008160452.4100a1f8.hamish_nospam@yahoo.com>
	<000001c6eab7$9fecd150$465c4554@DELL3000>
Message-ID: <20061008233524.4ea21273.hamish_nospam@yahoo.com>

Ron Russell wrote:
> 
> I always thought
> 
> http://www.ordnancesurvey.co.uk/oswebsite/gps/information/coordinatesystemsi
> nfo/guidecontents/index.html
> 
> was a good description, at my sort of level.


thanks, link added to the wiki page,
 http://grass.gdf-hannover.de/wiki/Gis_Concepts#Background_material


Hamish


From dssmailing at yahoo.com  Mon Oct  9 11:51:23 2006
From: dssmailing at yahoo.com (Dan Scheirer)
Date: Mon, 9 Oct 2006 11:51:23 -0700 (PDT)
Subject: [Proj] MAX_LINE limit increase?
Message-ID: <20061009185123.70125.qmail@web36813.mail.mud.yahoo.com>

I use proj within applications of the
Generic Mapping Tools (GMT), where it is very
helpful to pass long control-lines (proj -t)
along with the spatial data.

In numerous cases, I run up against the 200
character MAX_LINE limit in {proj,nad2nad,cs2cs}.c
(a.k.a. MAXLINE in geod.c), where the programs
silently truncate longer lines to 200 characters.
I've tweaked the source (4.4.9) to increase that to 
1000 characters without encoutering adverse effects.

Would the developers consider increasing this
hard-wired 200 character value?  I'm not savvy
enough of a programmer to know if there might be
non-beneficial ramifications of this within the
proj or among related software suites.

I'm a newbie to this list, and did not find reference
to this issue with an initial perusal.  Thanks for the
consideration.

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 


From warmerdam at pobox.com  Tue Oct 10 08:24:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 10 Oct 2006 11:24:40 -0400
Subject: [Proj] MAX_LINE limit increase?
In-Reply-To: <20061009185123.70125.qmail@web36813.mail.mud.yahoo.com>
References: <20061009185123.70125.qmail@web36813.mail.mud.yahoo.com>
Message-ID: <452BBB38.8040102@pobox.com>

Dan Scheirer wrote:
> I use proj within applications of the
> Generic Mapping Tools (GMT), where it is very
> helpful to pass long control-lines (proj -t)
> along with the spatial data.
> 
> In numerous cases, I run up against the 200
> character MAX_LINE limit in {proj,nad2nad,cs2cs}.c
> (a.k.a. MAXLINE in geod.c), where the programs
> silently truncate longer lines to 200 characters.
> I've tweaked the source (4.4.9) to increase that to 
> 1000 characters without encoutering adverse effects.
> 
> Would the developers consider increasing this
> hard-wired 200 character value?  I'm not savvy
> enough of a programmer to know if there might be
> non-beneficial ramifications of this within the
> proj or among related software suites.
> 
> I'm a newbie to this list, and did not find reference
> to this issue with an initial perusal.  Thanks for the
> consideration.

Dan,

I see no problem with this change, and I have applied it in CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From hi_ono2001 at ybb.ne.jp  Fri Oct 13 03:04:09 2006
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Fri, 13 Oct 2006 19:04:09 +0900 (JST)
Subject: [Proj] About Proj_api.dll for VB
Message-ID: <20061013100409.52180.qmail@web10708.mail.bbt.yahoo.co.jp>

Hello.

 I've tried to download your VB wrapper dll, and tried MS
ACCESS's example.mdb with putting this dll in the same
directory.

 However ACCESS said it couldn't find proj_api.dll,
although it exists in same directory. I've tried to put
this dll into "\windows\system", but no luck.

 And I also tried to run example.vba on Visual basic with
some modifications. But this result was same above.


 Could you teach me how to solve this problem?


 Regards.



From turek2 at poczta.fm  Fri Oct 13 13:54:28 2006
From: turek2 at poczta.fm (turek2)
Date: Fri, 13 Oct 2006 22:54:28 +0200
Subject: [Proj] Stereographic North Pole - EMEP Grid
Message-ID: <452FFD04.6090100@poczta.fm>

Hi,
Has anyone defined EMEP coordinate system properly under GRASS?
Any hints are welcome!
Thanks,
maciek


From ovv at hetnet.nl  Sat Oct 14 06:28:10 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Sat, 14 Oct 2006 15:28:10 +0200
Subject: [Proj] Stereographic North Pole - EMEP Grid
In-Reply-To: <452FFD04.6090100@poczta.fm>
Message-ID: <C156B28A.837F%ovv@hetnet.nl>

> From: turek2 <turek2-poczta.fm>
> Date: Fri, 13 Oct 2006 22:54:28 +0200
> Subject: [Proj] Stereographic North Pole - EMEP Grid

> Has anyone defined EMEP coordinate system properly under GRASS?
> Any hints are welcome!

I can't give any PROJ/GRASS details, but I can give some clues.

With some preprocessing and postprocessing the spherical form of the PROJ
projection stere can be used.

The EMEP radius of the spherical earth = 6370000 m.
There are 3 different EMEP grids; let's concentrate on the 50 km official
one.
The following projection parameters should be used in this case:
lat0=90; lon0=-32; x0=8*50000; y0=110*50000; k0=1; lat_ts=60;
The x0 and y0 are defined in kilometers, the grid cell space is 50 km, hence
the multiplication factor of 50000.
For a
lat=15; lon=17;
degrees, the stere projection should produce something like:
easting = 7283626.857; northing = -483845.535;
These values have to be converted to EMEP grid coordinates ei,ej.
First divide them by 50000:
This gives values around: 145.6725, -9.6769
Then round to integers with the nint function to get cell numbers:
-> ei = 146; ej = -10.

It can be done without postprocessing by setting the radius of the sphere to
6370000/50000 m and keeping the x0,y0 in km:
lat0=90; lon0=-32; x0=8; y0=110; k0=1; lat_ts=60;
Libproj's stere then gives for lat=15, lon=17 an x,y of 145.6725, -9.6769
which still has to be rounded with a nint function if EMEP cell numbers are
required.

Read more about EMEP at:
<http://www.emep.int/grid/index.html>



From mfinn at usgs.gov  Sat Oct 14 14:01:32 2006
From: mfinn at usgs.gov (Michael P Finn)
Date: Sat, 14 Oct 2006 16:01:32 -0500
Subject: [Proj] Michael P Finn of the USGS/ National Geospatial Technical
 Operations Center is out of the office.
Message-ID: <OF3C51D46B.0EDB6026-ON86257207.00737F6A-86257207.00737F6B@usgs.gov>


I will be out of the office starting  10/14/2006 and will not return until
10/23/2006.

I will be unable to check e-mail regularly while I am out. If I can't
respond to your message while I am out, then I will when I return. If you
have anything that cannot wait, please contact my colleague, Mr. Michael
Williams, at mswilliams at usgs.gov.     Mike



From turek2 at poczta.fm  Thu Oct 12 22:56:11 2006
From: turek2 at poczta.fm (turek2 at poczta.fm)
Date: 13 Oct 2006 07:56:11 +0200
Subject: [Proj] EMEP Stereographic North Pole
Message-ID: <20061013055611.C77FC466961@poczta.interia.pl>

Hi,
Did anyone define EMEP coordinate system properly under GRASS?
Any hints are welcome!
Thanks,
maciek


----------------------------------------------------------------------
Jestes kierowca? To poczytaj! >>> http://link.interia.pl/f199e



From hi_ono2001 at yahoo.co.jp  Fri Oct 13 02:38:29 2006
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Fri, 13 Oct 2006 18:38:29 +0900 (JST)
Subject: [Proj] About Proj_api.dll for VB
Message-ID: <20061013093829.98308.qmail@web10713.mail.bbt.yahoo.co.jp>

Hello.

 I've tried to download your VB wrapper dll, and tried MS
ACCESS's example.mdb with putting this dll in the same
directory.

 However ACCESS said it couldn't find proj_api.dll,
although it exists in same directory. I've tried to put
this dll into "\windows\system", but no luck.

 And I also tried to run example.vba on Visual basic with
some modifications. But this result was same above.


 Could you teach me how to solve this problem?


 Regards.
  


From mateusz at loskot.net  Sat Oct 14 16:18:14 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 15 Oct 2006 01:18:14 +0200
Subject: [Proj] EMEP Stereographic North Pole
In-Reply-To: <20061013055611.C77FC466961@poczta.interia.pl>
References: <20061013055611.C77FC466961@poczta.interia.pl>
Message-ID: <45317036.2040203@loskot.net>

turek2 at poczta.fm wrote:
> Hi,
> Did anyone define EMEP coordinate system properly under GRASS?
> Any hints are welcome!
> Thanks,
> maciek

You question has been already answered:

http://lists.maptools.org/pipermail/proj/2006-October/002525.html

Please, don't post the same questions multiple times. As I see,
you've also asked it 3-4 times on GRASS users group.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From turek2 at poczta.fm  Sun Oct 15 10:06:14 2006
From: turek2 at poczta.fm (turek2)
Date: Sun, 15 Oct 2006 19:06:14 +0200
Subject: [Proj] Stereographic North Pole - EMEP Grid
In-Reply-To: <C156B28A.837F%ovv@hetnet.nl>
References: <C156B28A.837F%ovv@hetnet.nl>
Message-ID: <45326A86.8040603@poczta.fm>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061015/dbba26c7/attachment.html>

From mateusz at loskot.net  Sun Oct 15 13:45:24 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 15 Oct 2006 22:45:24 +0200
Subject: [Proj] EMEP Stereographic North Pole
In-Reply-To: <45317036.2040203@loskot.net>
References: <20061013055611.C77FC466961@poczta.interia.pl>
	<45317036.2040203@loskot.net>
Message-ID: <45329DE4.4080902@loskot.net>

Mateusz Loskot wrote:
> turek2 at poczta.fm wrote:
>> Hi,
>> Did anyone define EMEP coordinate system properly under GRASS?
>> Any hints are welcome!
>> Thanks,
>> maciek
> 
> You question has been already answered:
> 
> http://lists.maptools.org/pipermail/proj/2006-October/002525.html
> 
> Please, don't post the same questions multiple times. As I see,
> you've also asked it 3-4 times on GRASS users group.

Maciej (turek2),

I appologize I've taken you as a a troll-like poster :-)
I hope everything has been clarified now (out of the list).

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From gheysen.t at gmail.com  Sun Oct 15 23:50:09 2006
From: gheysen.t at gmail.com (Gheysen Thibaut)
Date: Mon, 16 Oct 2006 08:50:09 +0200
Subject: [Proj] About Proj_api.dll for VB
In-Reply-To: <20061013100409.52180.qmail@web10708.mail.bbt.yahoo.co.jp>
References: <20061013100409.52180.qmail@web10708.mail.bbt.yahoo.co.jp>
Message-ID: <94e91cde0610152350x1d1b080bvf3294be81970a88d@mail.gmail.com>

Hello.

Copy "proj_api.dll" and "proj.dll" (from proj.4 library,
ftp://ftp.remotesensing.org/proj/proj446_win32_bin.zip) into
"\windows\system".

Thibaut.

2006/10/13, Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
>
> Hello.
>
> I've tried to download your VB wrapper dll, and tried MS
> ACCESS's example.mdb with putting this dll in the same
> directory.
>
> However ACCESS said it couldn't find proj_api.dll,
> although it exists in same directory. I've tried to put
> this dll into "\windows\system", but no luck.
>
> And I also tried to run example.vba on Visual basic with
> some modifications. But this result was same above.
>
>
> Could you teach me how to solve this problem?
>
>
> Regards.
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061016/e42cd5a2/attachment.html>

From pbander at cavtel.net  Mon Oct 16 10:06:48 2006
From: pbander at cavtel.net (Paul B. Anderson)
Date: Mon, 16 Oct 2006 13:06:48 -0400
Subject: [Proj] A Gallery of Map Projections
References: <20061013055611.C77FC466961@poczta.interia.pl><45317036.2040203@loskot.net>
	<45329DE4.4080902@loskot.net>
Message-ID: <003101c6f145$774e1080$1d2a1042@ISUCONNECT>

- Hi Everyone,

This is just a note to let you know that I have moved my Map Projection 
Graphics web site from Illinois State University to
http://www.galleryofmapprojections.com/.

- Thanks for reading.

Paul B. Anderson FCCS (USN, Retired)
Kingsport, TN native living in Norfolk, VA




From warmerdam at pobox.com  Tue Oct 17 13:41:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 17 Oct 2006 16:41:49 -0400
Subject: [Proj] PROJ 4.5.0 beta (and Krovak!)
In-Reply-To: <200609141043.02376.gerald.evenden@verizon.mail>
References: <931f8ea90609140626w131932ecx68d8b9eff17b2c65@mail.gmail.com>	<Pine.LNX.4.62.0609141442120.10969@agrippa.ukshells.co.uk>
	<200609141043.02376.gerald.evenden@verizon.mail>
Message-ID: <4535400D.5030708@pobox.com>

Gerald I. Evenden wrote:
> I do not particularly care what the projection is called but I would 
> appreciate some communications as to using the 'kocc' designation so I could 
> at least change my releases of libproj4 to conform with external usage.

Gerald,

OK, I've gone back over this, thinking to modify PROJ.4 to support either
name (proj=krovak or proj=kocc) similarly.  However, I've come to the
conclusion there must be some other differences in the defaults, orientation
or something for these two implementations of the projection.

In particular, for a test point at 10E, 45N, lproj seems to fail:

warmerda at gdal2200[917]% ./lproj +proj=kocc +ellps=bessel
10 45
nan     -inf

While proj produces results, though I don't know how correct they are:

warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
10 45
-1164802.15     -1546506.69

I don't really know any test points for Krovak or even what options
are required in the two implementations.

For now, I'll stick with the existing Krovak code for the 4.5.0 release,
but if there are things we can do to make the two implementations
compatible with the aim of a seamless transition to use of libproj4
in the future, I'd be all for that!

PS. I see PJ_krovak was checked in sometime in 2002.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From jachym.cepicky at centrum.cz  Tue Oct 17 13:59:28 2006
From: jachym.cepicky at centrum.cz (Jachym Cepicky)
Date: Tue, 17 Oct 2006 22:59:28 +0200
Subject: [Proj] PROJ 4.5.0 beta (and Krovak!)
In-Reply-To: <4535400D.5030708@pobox.com>
References: <931f8ea90609140626w131932ecx68d8b9eff17b2c65@mail.gmail.com>
	<Pine.LNX.4.62.0609141442120.10969@agrippa.ukshells.co.uk>
	<200609141043.02376.gerald.evenden@verizon.mail>
	<4535400D.5030708@pobox.com>
Message-ID: <20061017205928.GB7234@localdomain>

Hallo,
On Tue, Oct 17, 2006 at 04:41:49PM -0400, Frank Warmerdam wrote:
> Gerald I. Evenden wrote:
> >I do not particularly care what the projection is called but I would 
> >appreciate some communications as to using the 'kocc' designation so I 
> >could at least change my releases of libproj4 to conform with external 
> >usage.
> 
> Gerald,
> 
> While proj produces results, though I don't know how correct they are:
> 
> warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
> 10 45
> -1164802.15     -1546506.69

i can confirm this result, same for me and should be correct

> 
> I don't really know any test points for Krovak or even what options
> are required in the two implementations.

try this one:
echo "12d48'25.15992  49d27'8.14571" | cs2cs +proj=latlong +datum=WGS84 \
+to +proj=krovak +ellps=bessel +no_defs \
+towgs84=570.8,85.7,462.8,4.998,1.587,5.261,3.56

-868208.53      -1095793.57 -46.96

(from 
http://grass.fsv.cvut.cz/wiki/index.php/S-JTSK#Praktick.C3.A1_uk.C3.A1zka )

> 
> For now, I'll stick with the existing Krovak code for the 4.5.0 release,
> but if there are things we can do to make the two implementations
> compatible with the aim of a seamless transition to use of libproj4
> in the future, I'd be all for that!
> 
> PS. I see PJ_krovak was checked in sometime in 2002.
> 
> Best regards,
> --

hope, this helps a bit

jachym

-- 
Jachym Cepicky
e-mail: jachym.cepicky at centrum.cz
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/gnupg_public_key/jachym_cepicky-gpg_public_key.asc
-----------------------------------------   
OFFICE:                                     
Department of Geoinformation Technologies 
Zemedelska 3
613 00, Brno
Czech Republick
e-mail: xcepicky at node.mendelu.cz
URL:    http://mapserver.mendelu.cz
Tel.:   +420 545 134 514
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 191 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061017/8018c2d9/attachment.sig>

From tomtor at xs4all.nl  Tue Oct 17 02:35:53 2006
From: tomtor at xs4all.nl (tvijlbrief)
Date: Tue, 17 Oct 2006 02:35:53 -0700 (PDT)
Subject: [Proj] proj and Dutch RD
In-Reply-To: <1137050988.28660.9.camel@acme.pacific>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl> <s3c4d97e.085@dfg.ca.gov>
	<20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific>
	<s3c4fd79.006@dfg.ca.gov> <20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific>
Message-ID: <6851595.post@talk.nabble.com>


Much confusion, but the following definition will work! I submitted this
as a patch for the epsg file to the libproj maintainers.

<28992> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
+towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772 +units=m 
+no_defs  <>

For some reason Oscar van Vlijmen's conversion:

Transformation from Bessel 1841 to WGS84:
dx=565.040; dy=49.910; dz=465.840; rx=0.40939; ry=-0.35971; rz=1.86849;
ds=4.0772;

had the sign of rx,ry and rz reversed!

Tom

====================

Roger Oberholtzer wrote:
> 
> On Thu, 2006-01-12 at 00:17 +0200, Martin Vermeer wrote:
>> On Wed, Jan 11, 2006 at 12:43:13PM -0800, Eric Miller wrote:
>> > I think Martin's comment is a little to brief.
>> > 
>> > Your source coordinate system is geodetic coordinates using the WGS84
>> Datum (implies WGS84 ellipsoid)
>> > In cs2cs terms:  +proj=latlong +datum=WGS84
>> > 
>> > Your destination coordinate system is RD (new)
>> > In cs2cs terms: +proj=sterea +lat_0=52.15616055555555
>> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>> +ellps=bessel +units=m +towgs84=593,26,478
>> > 
>> > I'm not sure about the signs for the towgs84 parameters (dx,dy,dz),
>> maybe they're supposed to be negative.  Anyway, the +towgs84 tells cs2cs
>> how to transform the WGS84 coordinates (in XYZ space) to whatever the
>> output datum for RD is.  The +towgs84 or +datum for a different target
>> coordinate systems will likely be different.  But, your source definition
>> would stay the same.  If you have some reference coordinates, you can
>> probably work out whether the towgs84 numbers are supposed to be positive
>> or negative (provided those are good values).
>> > 
>> > Clear as mud?
>> 
>> This is precisely what I meant. Thanks!
> 
> But the 'fix' was to change the description of the source lat/longs from
> 
> 	+proj=latlong +ellps=WGS84
> to
> 	+proj=latlong +ellps=bessel
> 
> After the '+to' I always had +ellps=bessel to describe the desired
> result. That was not changed.
> 
> Confusion here continues...
> 
>> 
>> So play around with those +towgs84 parms, until you can reproduce your
>> reference values. There must be decimetre precision shift values
>> somewhere too, as I know the triangulation to be that precise. They must
>> know at the cadastral survey in Apeldoorn. Here is their on-line
>> transformer:
>> 
>> https://RDinfo.kadaster.nl/rd/transformator.html
> 
> I have looked at that. In summary, the conversion that does the best
> (almost identical values) is:
> 
> +proj=latlong +ellps=bessel +to
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> 
> The one that was off by at least 60 meters was:
> 
> +proj=latlong +ellps=wgs84 +to
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> 
> -- 
> Roger Oberholtzer
> OPQ Systems AB
> 
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 
> 

-- 
View this message in context: http://www.nabble.com/proj-and-Dutch-RD-tf895401.html#a6851595
Sent from the PROJ.4 mailing list archive at Nabble.com.



From warmerdam at pobox.com  Tue Oct 17 22:35:36 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 18 Oct 2006 01:35:36 -0400
Subject: [Proj] PROJ 4.5.0 beta4 
Message-ID: <4535BD28.4080904@pobox.com>

Folks,

OK, I somewhat botched the last release numbering, so I've lept ahead
to beta4 assuming the last was really beta3.  This beta includes
the Roussilhe Stereographic projection (copied from libproj4), as well as
an update to EPSG 6.11.1 (at Markus Neteler's request).

If this does not have any glaring problems I'd like to declare it the
official 4.5.0 soon.

I've also remembered how to get stuff on the ftp site, so:

   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From roger at opq.se  Tue Oct 17 23:21:30 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Wed, 18 Oct 2006 08:21:30 +0200
Subject: [Proj] proj and Dutch RD
In-Reply-To: <6851595.post@talk.nabble.com>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl>
	<s3c4d97e.085@dfg.ca.gov> <20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific> <s3c4fd79.006@dfg.ca.gov>
	<20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific> <6851595.post@talk.nabble.com>
Message-ID: <1161152490.20472.6.camel@acme>

On Tue, 2006-10-17 at 02:35 -0700, tvijlbrief wrote:
> Much confusion, but the following definition will work! I submitted this
> as a patch for the epsg file to the libproj maintainers.
> 
> <28992> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772 +units=m 
> +no_defs  <>

Is the
"+towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772" the
same as "+proj=latlong +ellps=WGS84" ?

I have an RD conversion and all mine is the same except for this.

> 
> For some reason Oscar van Vlijmen's conversion:
> 
> Transformation from Bessel 1841 to WGS84:
> dx=565.040; dy=49.910; dz=465.840; rx=0.40939; ry=-0.35971; rz=1.86849;
> ds=4.0772;
> 
> had the sign of rx,ry and rz reversed!
> 
> Tom
> 
> ====================
> 
> Roger Oberholtzer wrote:
> > 
> > On Thu, 2006-01-12 at 00:17 +0200, Martin Vermeer wrote:
> >> On Wed, Jan 11, 2006 at 12:43:13PM -0800, Eric Miller wrote:
> >> > I think Martin's comment is a little to brief.
> >> > 
> >> > Your source coordinate system is geodetic coordinates using the WGS84
> >> Datum (implies WGS84 ellipsoid)
> >> > In cs2cs terms:  +proj=latlong +datum=WGS84
> >> > 
> >> > Your destination coordinate system is RD (new)
> >> > In cs2cs terms: +proj=sterea +lat_0=52.15616055555555
> >> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> >> +ellps=bessel +units=m +towgs84=593,26,478
> >> > 
> >> > I'm not sure about the signs for the towgs84 parameters (dx,dy,dz),
> >> maybe they're supposed to be negative.  Anyway, the +towgs84 tells cs2cs
> >> how to transform the WGS84 coordinates (in XYZ space) to whatever the
> >> output datum for RD is.  The +towgs84 or +datum for a different target
> >> coordinate systems will likely be different.  But, your source definition
> >> would stay the same.  If you have some reference coordinates, you can
> >> probably work out whether the towgs84 numbers are supposed to be positive
> >> or negative (provided those are good values).
> >> > 
> >> > Clear as mud?
> >> 
> >> This is precisely what I meant. Thanks!
> > 
> > But the 'fix' was to change the description of the source lat/longs from
> > 
> > 	+proj=latlong +ellps=WGS84
> > to
> > 	+proj=latlong +ellps=bessel
> > 
> > After the '+to' I always had +ellps=bessel to describe the desired
> > result. That was not changed.
> > 
> > Confusion here continues...
> > 
> >> 
> >> So play around with those +towgs84 parms, until you can reproduce your
> >> reference values. There must be decimetre precision shift values
> >> somewhere too, as I know the triangulation to be that precise. They must
> >> know at the cadastral survey in Apeldoorn. Here is their on-line
> >> transformer:
> >> 
> >> https://RDinfo.kadaster.nl/rd/transformator.html
> > 
> > I have looked at that. In summary, the conversion that does the best
> > (almost identical values) is:
> > 
> > +proj=latlong +ellps=bessel +to
> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> > 
> > The one that was off by at least 60 meters was:
> > 
> > +proj=latlong +ellps=wgs84 +to
> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> > 
> > -- 
> > Roger Oberholtzer
> > OPQ Systems AB
> > 
> > 
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> > 
> > 
> 
-- 
Roger Oberholtzer

OPQ Systems AB
Ramböll Sverige AB
Kapellgränd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Tel: Int +46 8-615 60 20
Fax: Int +46 8-31 42 23



From tutey at o2.pl  Wed Oct 18 00:34:55 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed, 18 Oct 2006 09:34:55 +0200
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <4535BD28.4080904@pobox.com>
References: <4535BD28.4080904@pobox.com>
Message-ID: <4535D91F.4060500@o2.pl>

Frank Warmerdam wrote:

>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz

Frank,

I noticed epsg files included in the package above miss codes
2172-2175, which are:

# Pulkovo 1942(58) / Poland zone II
<2172> +proj=sterea +lat_0=53.00194444444445 +lon_0=21.50277777777778
+k=0.999800 +x_0=4603000 +y_0=5806000 +ellps=krass
+towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
# Pulkovo 1942(58) / Poland zone III
<2173> +proj=sterea +lat_0=53.58333333333334 +lon_0=17.00833333333333
+k=0.999800 +x_0=3501000 +y_0=5999000 +ellps=krass
+towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
# Pulkovo 1942(58) / Poland zone IV
<2174> +proj=sterea +lat_0=51.67083333333333 +lon_0=16.67222222222222
+k=0.999800 +x_0=3703000 +y_0=5627000 +ellps=krass
+towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
# Pulkovo 1942(58) / Poland zone V
<2175> +proj=tmerc +lat_0=0 +lon_0=18.95833333333333 +k=0.999983
+x_0=237000 +y_0=-4700000 +ellps=krass
+towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>

Those *are* included in my proj 4.4.9 CVS 2006-07-12. Will that be
fixed in proj 4.5?

Maciek


From tomtor at xs4all.nl  Wed Oct 18 03:52:36 2006
From: tomtor at xs4all.nl (tvijlbrief)
Date: Wed, 18 Oct 2006 03:52:36 -0700 (PDT)
Subject: [Proj] proj and Dutch RD
In-Reply-To: <1161152490.20472.6.camel@acme>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl> <s3c4d97e.085@dfg.ca.gov>
	<20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific>
	<s3c4fd79.006@dfg.ca.gov> <20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific>
	<6851595.post@talk.nabble.com> <1161152490.20472.6.camel@acme>
Message-ID: <6873672.post@talk.nabble.com>


No, it is not the same.

 "+proj=latlong +ellps=WGS84" will give incorrect results because there is
no conversion
from the Bessel to the WGS84 spheroid!

You can compare the results by trying both:

tom at giant:~$ cs2cs +init=epsg:4326 +to +init=epsg:28992
6 53
196139.44       557179.10 -41.78
tom at giant:~$ cs2cs +init=epsg:4326 +to +proj=sterea +lat_0=52.15616055555555
+lon_0=5.38763888888889+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=WGS84
+units=m +nodefs
6 53
196114.10       557077.21 0.00

The error is about 25 meters!!

Tom



Roger Oberholtzer wrote:
> 
> On Tue, 2006-10-17 at 02:35 -0700, tvijlbrief wrote:
>> Much confusion, but the following definition will work! I submitted this
>> as a patch for the epsg file to the libproj maintainers.
>> 
>> <28992> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
>> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
>> +towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772 +units=m 
>> +no_defs  <>
> 
> Is the
> "+towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772" the
> same as "+proj=latlong +ellps=WGS84" ?
> 
> I have an RD conversion and all mine is the same except for this.
> 
>> 
>> For some reason Oscar van Vlijmen's conversion:
>> 
>> Transformation from Bessel 1841 to WGS84:
>> dx=565.040; dy=49.910; dz=465.840; rx=0.40939; ry=-0.35971; rz=1.86849;
>> ds=4.0772;
>> 
>> had the sign of rx,ry and rz reversed!
>> 
>> Tom
>> 
>> ====================
>> 
>> Roger Oberholtzer wrote:
>> > 
>> > On Thu, 2006-01-12 at 00:17 +0200, Martin Vermeer wrote:
>> >> On Wed, Jan 11, 2006 at 12:43:13PM -0800, Eric Miller wrote:
>> >> > I think Martin's comment is a little to brief.
>> >> > 
>> >> > Your source coordinate system is geodetic coordinates using the
>> WGS84
>> >> Datum (implies WGS84 ellipsoid)
>> >> > In cs2cs terms:  +proj=latlong +datum=WGS84
>> >> > 
>> >> > Your destination coordinate system is RD (new)
>> >> > In cs2cs terms: +proj=sterea +lat_0=52.15616055555555
>> >> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>> >> +ellps=bessel +units=m +towgs84=593,26,478
>> >> > 
>> >> > I'm not sure about the signs for the towgs84 parameters (dx,dy,dz),
>> >> maybe they're supposed to be negative.  Anyway, the +towgs84 tells
>> cs2cs
>> >> how to transform the WGS84 coordinates (in XYZ space) to whatever the
>> >> output datum for RD is.  The +towgs84 or +datum for a different target
>> >> coordinate systems will likely be different.  But, your source
>> definition
>> >> would stay the same.  If you have some reference coordinates, you can
>> >> probably work out whether the towgs84 numbers are supposed to be
>> positive
>> >> or negative (provided those are good values).
>> >> > 
>> >> > Clear as mud?
>> >> 
>> >> This is precisely what I meant. Thanks!
>> > 
>> > But the 'fix' was to change the description of the source lat/longs
>> from
>> > 
>> > 	+proj=latlong +ellps=WGS84
>> > to
>> > 	+proj=latlong +ellps=bessel
>> > 
>> > After the '+to' I always had +ellps=bessel to describe the desired
>> > result. That was not changed.
>> > 
>> > Confusion here continues...
>> > 
>> >> 
>> >> So play around with those +towgs84 parms, until you can reproduce your
>> >> reference values. There must be decimetre precision shift values
>> >> somewhere too, as I know the triangulation to be that precise. They
>> must
>> >> know at the cadastral survey in Apeldoorn. Here is their on-line
>> >> transformer:
>> >> 
>> >> https://RDinfo.kadaster.nl/rd/transformator.html
>> > 
>> > I have looked at that. In summary, the conversion that does the best
>> > (almost identical values) is:
>> > 
>> > +proj=latlong +ellps=bessel +to
>> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
>> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
>> > 
>> > The one that was off by at least 60 meters was:
>> > 
>> > +proj=latlong +ellps=wgs84 +to
>> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
>> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
>> > 
>> > -- 
>> > Roger Oberholtzer
>> > OPQ Systems AB
>> > 
>> > 
>> > _______________________________________________
>> > Proj mailing list
>> > Proj at lists.maptools.org
>> > http://lists.maptools.org/mailman/listinfo/proj
>> > 
>> > 
>> 
> -- 
> Roger Oberholtzer
> 
> OPQ Systems AB
> Ramböll Sverige AB
> Kapellgränd 7
> P.O. Box 4205
> SE-102 65 Stockholm, Sweden
> 
> Tel: Int +46 8-615 60 20
> Fax: Int +46 8-31 42 23
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 

-- 
View this message in context: http://www.nabble.com/proj-and-Dutch-RD-tf895401.html#a6873672
Sent from the PROJ.4 mailing list archive at Nabble.com.




From ovv at hetnet.nl  Wed Oct 18 05:21:35 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Wed, 18 Oct 2006 14:21:35 +0200
Subject: [Proj] proj and Dutch RD
In-Reply-To: <6851595.post@talk.nabble.com>
Message-ID: <C15BE8EF.8428%ovv@hetnet.nl>

> From: tvijlbrief
> Date: Tue, 17 Oct 2006 02:35:53 -0700 (PDT)
> To: proj at lists.maptools.org
> Subject: Re: [Proj] proj and Dutch RD
> 
> 
> Much confusion, but the following definition will work! I submitted this
> as a patch for the epsg file to the libproj maintainers.
> 
> <28992> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
> +towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772 +units=m
> +no_defs  <>
> 
> For some reason Oscar van Vlijmen's conversion:
> 
> Transformation from Bessel 1841 to WGS84:
> dx=565.040; dy=49.910; dz=465.840; rx=0.40939; ry=-0.35971; rz=1.86849;
> ds=4.0772;
> 
> had the sign of rx,ry and rz reversed!
> 
> Tom

My posting with subject "Re: [Proj] OSGB36", dated 2006-01-13, contained the
following addendum:

"
By the way, in my previous email with subject "Re: [Proj] proj and Dutch RD"
I forgot to mention that the datum transformation parameters are coordinate
frame parameters, so the signs of the r's should be reversed if you want to
use the parameters for a position vector transform like PROJ.4's.
"

Sorry, some information comes in parts, even not 'thread safe'!






From ovv at hetnet.nl  Wed Oct 18 05:21:48 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Wed, 18 Oct 2006 14:21:48 +0200
Subject: [Proj] PROJ 4.5.0 beta4 
In-Reply-To: <4535BD28.4080904@pobox.com>
Message-ID: <C15BE8FC.8428%ovv@hetnet.nl>

> From: Frank Warmerdam
> Date: Wed, 18 Oct 2006 01:35:36 -0400
> Subject: [Proj] PROJ 4.5.0 beta4
> 
> Folks,
> 
> OK, I somewhat botched the last release numbering, so I've lept ahead
> to beta4 assuming the last was really beta3.  This beta includes
> the Roussilhe Stereographic projection (copied from libproj4),

....

Just an irritating remark:
This is not the Roussilhe quasi-stereographic projection to be used in
Poland for Uklad 1965.
Example:

lat=52; lon=19; // in Strefa I
lat0="50s 37m 30s"; lon0="21d 5m";
x0=5467000; y0=4637000; m0=0.9998;
// Krasowski 1940 ellipsoid

The real Polish Roussilhe gives:
5621984.4676, 4493939.5305 m
(x,y are interchanged, as are x0,y0; no grid interpolation)

By comparison, the original Roussilhe from libproj gives:
5621984.4747, 4493939.5261
and sterea gives:
5621984.4718, 4493939.5312

Judge for yourself whether these differences are significant.





From mateusz at loskot.net  Wed Oct 18 05:36:09 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 18 Oct 2006 14:36:09 +0200
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <4535BD28.4080904@pobox.com>
References: <4535BD28.4080904@pobox.com>
Message-ID: <45361FB9.7030609@loskot.net>

Frank Warmerdam wrote:
> Folks,
> 
> OK, I somewhat botched the last release numbering, so I've lept ahead
> to beta4 assuming the last was really beta3.  This beta includes
> the Roussilhe Stereographic projection (copied from libproj4), as well as
> an update to EPSG 6.11.1 (at Markus Neteler's request).
> 
> If this does not have any glaring problems I'd like to declare it the
> official 4.5.0 soon.
> 
> I've also remembered how to get stuff on the ftp site, so:
> 
>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz

Frank,

By the way of this release, can we try to import changes
I made for Windows CE port of PROJ.4 into the CVS?

Here is the big patch that shows what changes I made:

http://mateusz.loskot.net/tmp/windowsce-port-big-patch-mloskot-20050330.patch.gz

The complete PROJ.4 for WinCE source is here:

http://mateusz.loskot.net/projects/proj4/

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From sandeepkumar.jakkaraju at gmail.com  Wed Oct 18 05:58:09 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Wed, 18 Oct 2006 18:28:09 +0530
Subject: [Proj] Any method to convert lat lon to screen pixel coordinates
Message-ID: <c653c98f0610180558x5993b512odd164b99231aaf2c@mail.gmail.com>

Is there Any method in proj4  to convert lat lon to screen pixel coordinates..??


From mateusz at loskot.net  Wed Oct 18 06:06:21 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 18 Oct 2006 15:06:21 +0200
Subject: [Proj] Any method to convert lat lon to screen pixel coordinates
In-Reply-To: <c653c98f0610180558x5993b512odd164b99231aaf2c@mail.gmail.com>
References: <c653c98f0610180558x5993b512odd164b99231aaf2c@mail.gmail.com>
Message-ID: <453626CD.900@loskot.net>

Sandeep Kumar Jakkaraju wrote:
> Is there Any method in proj4  to convert lat lon to screen pixel
> coordinates..??

Check this:

http://www.codeproject.com/useritems/Calibrator.asp

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From warmerdam at pobox.com  Wed Oct 18 06:50:00 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 18 Oct 2006 09:50:00 -0400
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <4535D91F.4060500@o2.pl>
References: <4535BD28.4080904@pobox.com> <4535D91F.4060500@o2.pl>
Message-ID: <45363108.3050808@pobox.com>

Maciej Sieczka wrote:
> Frank Warmerdam wrote:
> 
>>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
>>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz
> 
> Frank,
> 
> I noticed epsg files included in the package above miss codes
> 2172-2175, which are:
> 
> # Pulkovo 1942(58) / Poland zone II
> <2172> +proj=sterea +lat_0=53.00194444444445 +lon_0=21.50277777777778
> +k=0.999800 +x_0=4603000 +y_0=5806000 +ellps=krass
> +towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
> # Pulkovo 1942(58) / Poland zone III
> <2173> +proj=sterea +lat_0=53.58333333333334 +lon_0=17.00833333333333
> +k=0.999800 +x_0=3501000 +y_0=5999000 +ellps=krass
> +towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
> # Pulkovo 1942(58) / Poland zone IV
> <2174> +proj=sterea +lat_0=51.67083333333333 +lon_0=16.67222222222222
> +k=0.999800 +x_0=3703000 +y_0=5627000 +ellps=krass
> +towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
> # Pulkovo 1942(58) / Poland zone V
> <2175> +proj=tmerc +lat_0=0 +lon_0=18.95833333333333 +k=0.999983
> +x_0=237000 +y_0=-4700000 +ellps=krass
> +towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84 +units=m +no_defs  <>
> 
> Those *are* included in my proj 4.4.9 CVS 2006-07-12. Will that be
> fixed in proj 4.5?

Maciek,

I built the epsg file from the EPSG 6.11.1 Postgres SQL dump.  I have
scanned the raw SQL for this and there does not seem to be any projected
coordinate system definition for 2172-2175 even though some of the underlying
coordinate operations do seem to exist (eg. epsg_coordoperation includes
record id 18282 for Poland Zone II).

I think this is either an error upstream in the EPSG database or a deliberate
policy decision on their part.  For the most part I try to have the epsg file
reflect the original EPSG database as closely as possible, so I'd encourage
you to take this up with the folks maintaining the EPSG database.  I do notice
they have marked 2171 (Pulkovo 1942(58) / Poland zone I) as deprecated.

In the meantime, I'll hack these definitions into the EPSG PROJ.4 definition
file for the 4.5.0 release.  But they will be lost next time it is
regenerated.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From roger at opq.se  Wed Oct 18 06:57:45 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Wed, 18 Oct 2006 15:57:45 +0200
Subject: [Proj] proj and Dutch RD
In-Reply-To: <6873672.post@talk.nabble.com>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl>
	<s3c4d97e.085@dfg.ca.gov> <20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific> <s3c4fd79.006@dfg.ca.gov>
	<20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific> <6851595.post@talk.nabble.com>
	<1161152490.20472.6.camel@acme>  <6873672.post@talk.nabble.com>
Message-ID: <1161179865.23734.15.camel@acme>

On Wed, 2006-10-18 at 03:52 -0700, tvijlbrief wrote:
> No, it is not the same.
> 
>  "+proj=latlong +ellps=WGS84" will give incorrect results because there is
> no conversion
> from the Bessel to the WGS84 spheroid!

Isn't this part of the spec controlling what the source data is?
>From Bessel to wgs84? If my source data IS wgs84, why would I do this? 

I program from the C API where the specification of the source and the
specification of the destination are explicitly stated. Perhaps this is
why there is confusion on my part.

My code for RD is:

fromProj = pj_init_plus("+proj=latlong +ellps=WGS84");

toProj   = pj_init_plus("+proj=sterea +lat_0=52.15616055555555
				+lon_0=5.38763888888889
				+k=0.9999079 +x_0=155000 +y_0=463000
				+ellps=bessel +units=m +no_defs");

Then I use 

	lng = LONG * DEGREE_TO_RADIAN;
        lat = LAT  * DEGREE_TO_RADIAN;
        alt = 0; // We do not give this a height

        pj_transform(fromProj, toProj, 1, 0, &lng, &lat, &alt);

        local_easting = lng;
        local_northing = lat;

All with proper error checking.

> 
> You can compare the results by trying both:
> 
> tom at giant:~$ cs2cs +init=epsg:4326 +to +init=epsg:28992
> 6 53
> 196139.44       557179.10 -41.78
> tom at giant:~$ cs2cs +init=epsg:4326 +to +proj=sterea +lat_0=52.15616055555555
> +lon_0=5.38763888888889+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=WGS84
> +units=m +nodefs
> 6 53
> 196114.10       557077.21 0.00
> 
> The error is about 25 meters!!
> 
> Tom
> 
> 
> 
> Roger Oberholtzer wrote:
> > 
> > On Tue, 2006-10-17 at 02:35 -0700, tvijlbrief wrote:
> >> Much confusion, but the following definition will work! I submitted this
> >> as a patch for the epsg file to the libproj maintainers.
> >> 
> >> <28992> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> >> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> >> +towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772 +units=m 
> >> +no_defs  <>
> > 
> > Is the
> > "+towgs84=565.040,49.910,465.840,-0.40939,0.35971,-1.86849,4.0772" the
> > same as "+proj=latlong +ellps=WGS84" ?
> > 
> > I have an RD conversion and all mine is the same except for this.
> > 
> >> 
> >> For some reason Oscar van Vlijmen's conversion:
> >> 
> >> Transformation from Bessel 1841 to WGS84:
> >> dx=565.040; dy=49.910; dz=465.840; rx=0.40939; ry=-0.35971; rz=1.86849;
> >> ds=4.0772;
> >> 
> >> had the sign of rx,ry and rz reversed!
> >> 
> >> Tom
> >> 
> >> ====================
> >> 
> >> Roger Oberholtzer wrote:
> >> > 
> >> > On Thu, 2006-01-12 at 00:17 +0200, Martin Vermeer wrote:
> >> >> On Wed, Jan 11, 2006 at 12:43:13PM -0800, Eric Miller wrote:
> >> >> > I think Martin's comment is a little to brief.
> >> >> > 
> >> >> > Your source coordinate system is geodetic coordinates using the
> >> WGS84
> >> >> Datum (implies WGS84 ellipsoid)
> >> >> > In cs2cs terms:  +proj=latlong +datum=WGS84
> >> >> > 
> >> >> > Your destination coordinate system is RD (new)
> >> >> > In cs2cs terms: +proj=sterea +lat_0=52.15616055555555
> >> >> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
> >> >> +ellps=bessel +units=m +towgs84=593,26,478
> >> >> > 
> >> >> > I'm not sure about the signs for the towgs84 parameters (dx,dy,dz),
> >> >> maybe they're supposed to be negative.  Anyway, the +towgs84 tells
> >> cs2cs
> >> >> how to transform the WGS84 coordinates (in XYZ space) to whatever the
> >> >> output datum for RD is.  The +towgs84 or +datum for a different target
> >> >> coordinate systems will likely be different.  But, your source
> >> definition
> >> >> would stay the same.  If you have some reference coordinates, you can
> >> >> probably work out whether the towgs84 numbers are supposed to be
> >> positive
> >> >> or negative (provided those are good values).
> >> >> > 
> >> >> > Clear as mud?
> >> >> 
> >> >> This is precisely what I meant. Thanks!
> >> > 
> >> > But the 'fix' was to change the description of the source lat/longs
> >> from
> >> > 
> >> > 	+proj=latlong +ellps=WGS84
> >> > to
> >> > 	+proj=latlong +ellps=bessel
> >> > 
> >> > After the '+to' I always had +ellps=bessel to describe the desired
> >> > result. That was not changed.
> >> > 
> >> > Confusion here continues...
> >> > 
> >> >> 
> >> >> So play around with those +towgs84 parms, until you can reproduce your
> >> >> reference values. There must be decimetre precision shift values
> >> >> somewhere too, as I know the triangulation to be that precise. They
> >> must
> >> >> know at the cadastral survey in Apeldoorn. Here is their on-line
> >> >> transformer:
> >> >> 
> >> >> https://RDinfo.kadaster.nl/rd/transformator.html
> >> > 
> >> > I have looked at that. In summary, the conversion that does the best
> >> > (almost identical values) is:
> >> > 
> >> > +proj=latlong +ellps=bessel +to
> >> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> >> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> >> > 
> >> > The one that was off by at least 60 meters was:
> >> > 
> >> > +proj=latlong +ellps=wgs84 +to
> >> > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> >> > +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs
> >> > 
> >> > -- 
> >> > Roger Oberholtzer
> >> > OPQ Systems AB
> >> > 
> >> > 
> >> > _______________________________________________
> >> > Proj mailing list
> >> > Proj at lists.maptools.org
> >> > http://lists.maptools.org/mailman/listinfo/proj
> >> > 
> >> > 
> >> 
> > -- 
> > Roger Oberholtzer
> > 
> > OPQ Systems AB
> > Ramböll Sverige AB
> > Kapellgränd 7
> > P.O. Box 4205
> > SE-102 65 Stockholm, Sweden
> > 
> > Tel: Int +46 8-615 60 20
> > Fax: Int +46 8-31 42 23
> > 
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> > 
> 
-- 
Roger Oberholtzer

OPQ Systems AB
Ramböll Sverige AB
Kapellgränd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Tel: Int +46 8-615 60 20
Fax: Int +46 8-31 42 23



From warmerdam at pobox.com  Wed Oct 18 07:03:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 18 Oct 2006 10:03:32 -0400
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <45361FB9.7030609@loskot.net>
References: <4535BD28.4080904@pobox.com> <45361FB9.7030609@loskot.net>
Message-ID: <45363434.3060803@pobox.com>

Mateusz Loskot wrote:
  > Frank,
> 
> By the way of this release, can we try to import changes
> I made for Windows CE port of PROJ.4 into the CVS?
> 
> Here is the big patch that shows what changes I made:
> 
> http://mateusz.loskot.net/tmp/windowsce-port-big-patch-mloskot-20050330.patch.gz
> 
> The complete PROJ.4 for WinCE source is here:
> 
> http://mateusz.loskot.net/projects/proj4/

Mateusz,

Per our discussion on IRC, I think it is best for the patch to be refactored
to touch less files, and that we hold this for PROJ 4.5.1 to avoid delaying
4.5.0 (already theoretically in beta for many months since I keep forgetting
about it after issuing a beta).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From mateusz at loskot.net  Wed Oct 18 07:04:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 18 Oct 2006 16:04:37 +0200
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <45361FB9.7030609@loskot.net>
References: <4535BD28.4080904@pobox.com> <45361FB9.7030609@loskot.net>
Message-ID: <45363475.1050600@loskot.net>

Mateusz Loskot wrote:
> Frank Warmerdam wrote:
>> Folks,
>>
>> OK, I somewhat botched the last release numbering, so I've lept ahead
>> to beta4 assuming the last was really beta3.  This beta includes
>> the Roussilhe Stereographic projection (copied from libproj4), as well as
>> an update to EPSG 6.11.1 (at Markus Neteler's request).
>>
>> If this does not have any glaring problems I'd like to declare it the
>> official 4.5.0 soon.
>>
>> I've also remembered how to get stuff on the ftp site, so:
>>
>>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
>>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz
> 
> Frank,
> 
> By the way of this release, can we try to import changes
> I made for Windows CE port of PROJ.4 into the CVS?
> 
> Here is the big patch that shows what changes I made:
> 
> http://mateusz.loskot.net/tmp/windowsce-port-big-patch-mloskot-20050330.patch.gz

Frank,

As we've discussed on the #gdal, I'm delaying merging this port into
CVS untill 4.5.1. So, I have a chance to clean and refactor this
big-ugly patch.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From tutey at o2.pl  Wed Oct 18 07:17:48 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed, 18 Oct 2006 16:17:48 +0200
Subject: [Proj] PROJ 4.5.0 beta4
In-Reply-To: <45363108.3050808@pobox.com>
References: <4535BD28.4080904@pobox.com> <4535D91F.4060500@o2.pl>
	<45363108.3050808@pobox.com>
Message-ID: <4536378C.70508@o2.pl>

Frank Warmerdam wrote:

> I built the epsg file from the EPSG 6.11.1 Postgres SQL dump.  I have
> scanned the raw SQL for this and there does not seem to be any projected
> coordinate system definition for 2172-2175 even though some of the
> underlying
> coordinate operations do seem to exist (eg. epsg_coordoperation includes
> record id 18282 for Poland Zone II).

> I think this is either an error upstream in the EPSG database or a
> deliberate policy decision on their part.

I doubt the latter. They very very hesitate to remove anything.
Especially that I can see no reason for removing any of these.
Definitions 2172-2175 are all OK, and still these systems are widely
used in Poland. Propably some error on EPSG side.

> For the most part I try to have the epsg file reflect the original EPSG database as closely as possible, so I'd encourage
> you to take this up with the folks maintaining the EPSG database.

Will do.

> I do notice they have marked 2171 (Pulkovo 1942(58) / Poland zone I)
as deprecated.

They did that at my request, cause there was a huge error in false
northing (5647000 instead of 5467000). The correct code for Polish
Uklad 65 zone I is now 3120. I asked EPSG just to correct this within
the 2171, but they said they never do that and that they prefer to
deprecate the invalid code and create a brand new one instead (that's
why I suppose they wouldn't be keen on removing 2172-2175 alltogether
either).

> In the meantime, I'll hack these definitions into the EPSG PROJ.4
> definition file for the 4.5.0 release.

This will be highly appreciated. Thanks in the name of Polish PROJ4 users!

>  But they will be lost next time it is regenerated.

I hope EPSG will correct this issue. I'll keep you posted.

Maciek


From tomtor at xs4all.nl  Wed Oct 18 07:56:22 2006
From: tomtor at xs4all.nl (tvijlbrief)
Date: Wed, 18 Oct 2006 07:56:22 -0700 (PDT)
Subject: [Proj] proj and Dutch RD
In-Reply-To: <1161179865.23734.15.camel@acme>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl> <s3c4d97e.085@dfg.ca.gov>
	<20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific>
	<s3c4fd79.006@dfg.ca.gov> <20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific>
	<6851595.post@talk.nabble.com> <1161152490.20472.6.camel@acme>
	<6873672.post@talk.nabble.com> <1161179865.23734.15.camel@acme>
Message-ID: <6878111.post@talk.nabble.com>




>Isn't this part of the spec controlling what the source data is?
>>From Bessel to wgs84? If my source data IS wgs84, why would I do this? 

Because RD is defined in Bessel, not in WGS84! 

So the conversion code needs to convert from WGS84 to Bessel, and it will
use the inverse of the towgs specification, if it can find it in the toProj
specification...

Your code is ok, just add the +towgs specification to toProj.

Tom
=====================

I program from the C API where the specification of the source and the
specification of the destination are explicitly stated. Perhaps this is
why there is confusion on my part.

My code for RD is:

fromProj = pj_init_plus("+proj=latlong +ellps=WGS84");

toProj   = pj_init_plus("+proj=sterea +lat_0=52.15616055555555
				+lon_0=5.38763888888889
				+k=0.9999079 +x_0=155000 +y_0=463000
				+ellps=bessel +units=m +no_defs");

Then I use 

	lng = LONG * DEGREE_TO_RADIAN;
        lat = LAT  * DEGREE_TO_RADIAN;
        alt = 0; // We do not give this a height

        pj_transform(fromProj, toProj, 1, 0, &lng, &lat, &alt);

        local_easting = lng;
        local_northing = lat;

All with proper error checking.

> 
> You can compare the results by trying both:
> 
> tom at giant:~$ cs2cs +init=epsg:4326 +to +init=epsg:28992
> 6 53
> 196139.44       557179.10 -41.78
> tom at giant:~$ cs2cs +init=epsg:4326 +to +proj=sterea
> +lat_0=52.15616055555555
> +lon_0=5.38763888888889+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=WGS84
> +units=m +nodefs
> 6 53
> 196114.10       557077.21 0.00
> 
> The error is about 25 meters!!
> 
> Tom
> 
> 

-- 
View this message in context: http://www.nabble.com/proj-and-Dutch-RD-tf895401.html#a6878111
Sent from the PROJ.4 mailing list archive at Nabble.com.



From gerald.evenden at verizon.mail  Wed Oct 18 08:43:38 2006
From: gerald.evenden at verizon.mail (Gerald I. Evenden)
Date: Wed, 18 Oct 2006 11:43:38 -0400
Subject: Fwd: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)
Message-ID: <200610181143.38956.gerald.evenden@verizon.mail>

I did not do a "reply all" so only Frank got the original reply.

----------  Forwarded Message  ----------

Subject: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)
Date: Wednesday 18 October 2006 11:38 am
From: "Gerald I. Evenden" <gerald.evenden at verizon.mail>
To: Frank Warmerdam <warmerdam at pobox.com>

On Tuesday 17 October 2006 4:41 pm, you wrote:
> Gerald I. Evenden wrote:
> > I do not particularly care what the projection is called but I would
> > appreciate some communications as to using the 'kocc' designation so I
> > could at least change my releases of libproj4 to conform with external
> > usage.

I thought I had previously apologized for my senior moment about the 'krovak'
designation and that +proj=kocc is in libproj4.

> Gerald,
>
> OK, I've gone back over this, thinking to modify PROJ.4 to support either
> name (proj=krovak or proj=kocc) similarly.  However, I've come to the
> conclusion there must be some other differences in the defaults,
> orientation or something for these two implementations of the projection.
>
> In particular, for a test point at 10E, 45N, lproj seems to fail:
>
> warmerda at gdal2200[917]% ./lproj +proj=kocc +ellps=bessel
> 10 45
> nan     -inf

Indeed, I get the same answers with the above run line.

> While proj produces results, though I don't know how correct they are:
>
> warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
> 10 45
> -1164802.15     -1546506.69
>
> I don't really know any test points for Krovak or even what options
> are required in the two implementations.
>
> For now, I'll stick with the existing Krovak code for the 4.5.0 release,
> but if there are things we can do to make the two implementations
> compatible with the aim of a seamless transition to use of libproj4
> in the future, I'd be all for that!
>
> PS. I see PJ_krovak was checked in sometime in 2002.
>
> Best regards,

I inserted the 10 45 number into an old script:

#!/bin/sh
# This is a test script to check the correct execution
# of the Krovak projection
cat <<EOF >temp
35d42'35.2147 48d7'46.2973
10 45
EOF
echo "forward projection\n"
../lproj +proj=kocc +ellps=bessel +czech temp \
     +lon_0=42d30 +lat_0=49d30 \
     +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999
../lproj +proj=kocc +ellps=bessel +czech -o temp \
     +lon_0=42d30 +lat_0=49d30 \
     +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999 \

| ../lproj -I +proj=kocc +ellps=bessel +czech -i \

     +lon_0=42d30 +lat_0=49d30 \
     +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999 -W6
#
echo "above should agree with input of\n"
cat temp
rm temp

which produces the results:

forward projection\n
-16643462.09	2422822.35
-15043707.84	7571503.40
35d42'35.214700"E	48d07'46.297300"N
10d00'00.000000"E	45d00'00.000000"N
above should agree with input of\n
35d42'35.2147 48d7'46.2973
10 45

--
Mythology is what grownups believe,
folklore is what they tell children and religion is both.
-- Cedric Whitman (1969),

-------------------------------------------------------


From gerald.evenden at verizon.mail  Wed Oct 18 08:47:21 2006
From: gerald.evenden at verizon.mail (Gerald I. Evenden)
Date: Wed, 18 Oct 2006 11:47:21 -0400
Subject: [Proj] Any method to convert lat lon to screen pixel coordinates
In-Reply-To: <c653c98f0610180558x5993b512odd164b99231aaf2c@mail.gmail.com>
References: <c653c98f0610180558x5993b512odd164b99231aaf2c@mail.gmail.com>
Message-ID: <200610181147.21488.gerald.evenden@verizon.mail>

On Wednesday 18 October 2006 8:58 am, Sandeep Kumar Jakkaraju wrote:
> Is there Any method in proj4  to convert lat lon to screen pixel
> coordinates..?? _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

This is a graphic operation to be performed on "projected" data and not a 
projection.  That is, use [lib]proj to transform lat-lon to Cartesian data 
and then input into a scaling/conversion software to output to screen pixels.

-- 
Mythology is what grownups believe,
folklore is what they tell children and religion is both.
-- Cedric Whitman (1969),


From warmerdam at pobox.com  Wed Oct 18 10:04:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 18 Oct 2006 13:04:32 -0400
Subject: Fwd: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)
In-Reply-To: <200610181143.38956.gerald.evenden@verizon.mail>
References: <200610181143.38956.gerald.evenden@verizon.mail>
Message-ID: <45365EA0.40804@pobox.com>

Gerald I. Evenden wrote:
 >Frank Warmerdam wrote:
>> warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
>> 10 45
>> -1164802.15     -1546506.69
>>
>> I don't really know any test points for Krovak or even what options
>> are required in the two implementations.
>>
>> For now, I'll stick with the existing Krovak code for the 4.5.0 release,
>> but if there are things we can do to make the two implementations
>> compatible with the aim of a seamless transition to use of libproj4
>> in the future, I'd be all for that!

Gerald I. Evenden wrote:
> I inserted the 10 45 number into an old script:
> 
> #!/bin/sh
> # This is a test script to check the correct execution
> # of the Krovak projection
> cat <<EOF >temp
> 35d42'35.2147 48d7'46.2973
> 10 45
> EOF
> echo "forward projection\n"
> ../lproj +proj=kocc +ellps=bessel +czech temp \
>      +lon_0=42d30 +lat_0=49d30 \
>      +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999
> ../lproj +proj=kocc +ellps=bessel +czech -o temp \
>      +lon_0=42d30 +lat_0=49d30 \
>      +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999 \
> 
> | ../lproj -I +proj=kocc +ellps=bessel +czech -i \
> 
>      +lon_0=42d30 +lat_0=49d30 \
>      +lat_t=59d42\'42.69689 +lat_1=78d30 +k_0=.9999 -W6
> #
> echo "above should agree with input of\n"
> cat temp
> rm temp
> 
> which produces the results:
> 
> forward projection\n
> -16643462.09	2422822.35
> -15043707.84	7571503.40
> 35d42'35.214700"E	48d07'46.297300"N
> 10d00'00.000000"E	45d00'00.000000"N
> above should agree with input of\n
> 35d42'35.2147 48d7'46.2973
> 10 45

Gerald,

OK, this leaves me with the impression that the PJ_krovak.c that was
contributed to me includes built in defaults that are compatible with
common use in the Czech Republic while, perhaps, yours (kocc) uses standard
defaults (ie. lon_0=0, lat_0=0, lat_t=0, lat_1=0?)

Do you have a suggestion on how we can align the two implementations so they
work the same from the commandline?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From ovv at hetnet.nl  Wed Oct 18 11:21:41 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Wed, 18 Oct 2006 20:21:41 +0200
Subject: [Proj] PROJ 4.5.0 beta (and Krovak!)
In-Reply-To: <200610181143.38956.gerald.evenden@verizon.mail>
Message-ID: <C15C3D55.8448%ovv@hetnet.nl>

> From: "Gerald I. Evenden"
> Date: Wed, 18 Oct 2006 11:43:38 -0400
> Subject: Fwd: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)

>> While proj produces results, though I don't know how correct they are:
>> warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
>> 10 45
>> -1164802.15     -1546506.69

For lat=45, lon=10, wrt Greenwich, I got:
1546506.69219, 1164802.14778
Keep in mind that Krovak is South/West oriented.
The axis called X-axis runs from north to south, the Y-axis runs from east
to west.
 
>> I don't really know any test points for Krovak or even what options
>> are required in the two implementations.

There are two reasonably trustworthy test points published.

Test point from the EPSG Guidance Note 7.2:
lat="50 12 32.4416"; lon="16 50 59.1790"; // wrt Greenwich, d m s format
y,x: 1050538.64314, 568990.99673
published values: 1050538.643, 568990.997 m

Test point from "Krovak Projection", B. Veverka, Czech Technical University
- Department of Mapping and Cartography:
The coordinates are with respect to Ferro at -17d 40m (wrt Greenwich).
lat="48 7 46.2973"; lon="35 42 35.2147";
y,x: 1289068.72401, 504691.67509
published values: 1289068.724, 504691.675 m



From roger at opq.se  Wed Oct 18 13:21:30 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Wed, 18 Oct 2006 22:21:30 +0200
Subject: [Proj] proj and Dutch RD
In-Reply-To: <6878111.post@talk.nabble.com>
References: <1136989892.11608.43.camel@acme.pacific>
	<200601111056.45437.gerald.evenden@verizon.net>
	<1136996263.11608.74.camel@acme.pacific>
	<200601111206.19040.gerald.evenden@verizon.net>
	<43C546BF.8040707@uva.nl>
	<s3c4d97e.085@dfg.ca.gov> <20060111193232.GA21689@geo9.hut.fi>
	<1137010868.9588.16.camel@shark.pacific> <s3c4fd79.006@dfg.ca.gov>
	<20060111221746.GA22702@geo9.hut.fi>
	<1137050988.28660.9.camel@acme.pacific> <6851595.post@talk.nabble.com>
	<1161152490.20472.6.camel@acme> <6873672.post@talk.nabble.com>
	<1161179865.23734.15.camel@acme>  <6878111.post@talk.nabble.com>
Message-ID: <1161202891.3869.5.camel@shark.pacific>

On Wed, 2006-10-18 at 07:56 -0700, tvijlbrief wrote:
> 
> 
> >Isn't this part of the spec controlling what the source data is?
> >>From Bessel to wgs84? If my source data IS wgs84, why would I do this? 
> 
> Because RD is defined in Bessel, not in WGS84! 
> 
> So the conversion code needs to convert from WGS84 to Bessel, and it will
> use the inverse of the towgs specification, if it can find it in the toProj
> specification...
> 
> Your code is ok, just add the +towgs specification to toProj.

OK. But I thought the fromProj in my code was referring to the source
data only. The ellps=WGS84 there said I have WGS84. 

Then, in the toProj part, I thought the ellps=bessel handled the fact
that RD is Bessel. Stating Bessel as a property of the source data seems
odd. Stating it as a property of the desired calculated data makes
sense. To me.

I will of course try your suggestion and see what I get.


> 
> Tom
> =====================
> 
> I program from the C API where the specification of the source and the
> specification of the destination are explicitly stated. Perhaps this is
> why there is confusion on my part.
> 
> My code for RD is:
> 
> fromProj = pj_init_plus("+proj=latlong +ellps=WGS84");
> 
> toProj   = pj_init_plus("+proj=sterea +lat_0=52.15616055555555
> 				+lon_0=5.38763888888889
> 				+k=0.9999079 +x_0=155000 +y_0=463000
> 				+ellps=bessel +units=m +no_defs");
> 
> Then I use 
> 
> 	lng = LONG * DEGREE_TO_RADIAN;
>         lat = LAT  * DEGREE_TO_RADIAN;
>         alt = 0; // We do not give this a height
> 
>         pj_transform(fromProj, toProj, 1, 0, &lng, &lat, &alt);
> 
>         local_easting = lng;
>         local_northing = lat;
> 
> All with proper error checking.
> 
> > 
> > You can compare the results by trying both:
> > 
> > tom at giant:~$ cs2cs +init=epsg:4326 +to +init=epsg:28992
> > 6 53
> > 196139.44       557179.10 -41.78
> > tom at giant:~$ cs2cs +init=epsg:4326 +to +proj=sterea
> > +lat_0=52.15616055555555
> > +lon_0=5.38763888888889+k=0.9999079 +x_0=155000 +y_0=463000 +ellps=WGS84
> > +units=m +nodefs
> > 6 53
> > 196114.10       557077.21 0.00
> > 
> > The error is about 25 meters!!
> > 
> > Tom
> > 
> > 
> 



From mkennedy2 at earthlink.net  Wed Oct 18 15:04:42 2006
From: mkennedy2 at earthlink.net (Melita Kennedy)
Date: Wed, 18 Oct 2006 15:04:42 -0700 (GMT-07:00)
Subject: [Proj] Re: Krovak test points
Message-ID: <2485319.1161209082740.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>


>----------------------------------------------------------------------
>
>Date: Tue, 17 Oct 2006 16:41:49 -0400
>From: Frank Warmerdam <warmerdam at pobox.com>
>Subject: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)
>To: gerald.evenden at verizon.net,	"PROJ.4 and general Projections
>	Discussions" <proj at lists.maptools.org>
>
[contents snipped]
>
>I don't really know any test points for Krovak or even what options
>are required in the two implementations.

While we were implementing Krovak for ESRI software, we were sent 
7 test points. I don't know how official these are, as the source is 
unclear. Two of the points show up in another document sent by the 
ESRI distributor in  the Czech Republic. The longitudes are Greenwich-based, 
Bessel 1841 and the XY axes are south-west oriented, rather than east-north. 
The sample you posted is EN. When using the SW version, I got 

x = 1546506.6922  y = 1164802.1478

longitude,latitude,x,y
16 50 59.17900, 50 12 32.44160, 1050538.6433, 568990.9967
12 50 23.78945, 49 50 35.78965, 1053301.0476, 859084.7000
22 19 38.87658, 49 50 35.78965, 1117926.6680, 180241.3620
22 19 38.87658, 48 38 23.46592, 1251684.1815, 184607.1409
12 50 23.78945, 48 38 23.46592, 1185471.9460, 880118.0569
16 50 59.17900, 50 12 32.44140, 1050538.6494, 568990.9974
17 25 51.17920, 50 15 30.70080, 1049221.1899, 527189.1948

Melita Kennedy
ESRI Product Specialist



From cjmce at lsu.edu  Wed Oct 18 16:05:23 2006
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Wed, 18 Oct 2006 18:05:23 -0500
Subject: [Proj] PROJ 4.5.0 beta (and Krovak!)
Message-ID: <OF85EC6C42.009A24F4-ON8625720B.007ED604-8625720B.007ED61E@lsu.edu>





"Historical Military Mapping of Czech Lands - Positional Accuracy of Old
Maps" by Zimova, Pestak, and Veverks is in the current (October 2006) issue
of "GIM International" magazine, pp 21-23.

Nice article, but no test points - just examples of the magnitudes of the
errors.

Cliff Mugnier
LSU
---------------------------------
> From: "Gerald I. Evenden"
> Date: Wed, 18 Oct 2006 11:43:38 -0400
> Subject: Fwd: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)

>> While proj produces results, though I don't know how correct they are:
>> warmerda at gdal2200[1926]% ./proj +proj=krovak +ellps=bessel
>> 10 45
>> -1164802.15     -1546506.69

For lat=45, lon=10, wrt Greenwich, I got:
1546506.69219, 1164802.14778
Keep in mind that Krovak is South/West oriented.
The axis called X-axis runs from north to south, the Y-axis runs from east
to west.

>> I don't really know any test points for Krovak or even what options
>> are required in the two implementations.

There are two reasonably trustworthy test points published.

Test point from the EPSG Guidance Note 7.2:
lat="50 12 32.4416"; lon="16 50 59.1790"; // wrt Greenwich, d m s format
y,x: 1050538.64314, 568990.99673
published values: 1050538.643, 568990.997 m

Test point from "Krovak Projection", B. Veverka, Czech Technical University
- Department of Mapping and Cartography:
The coordinates are with respect to Ferro at -17d 40m (wrt Greenwich).
lat="48 7 46.2973"; lon="35 42 35.2147";
y,x: 1289068.72401, 504691.67509
published values: 1289068.724, 504691.675 m



From landa.martin at gmail.com  Thu Oct 19 01:00:28 2006
From: landa.martin at gmail.com (Martin Landa)
Date: Thu, 19 Oct 2006 10:00:28 +0200
Subject: [Proj] Re: Krovak test points
In-Reply-To: <2485319.1161209082740.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
References: <2485319.1161209082740.JavaMail.root@elwamui-cypress.atl.sa.earthlink.net>
Message-ID: <f8fe65c40610190100i47f6bc5fv489c91d5aeebc1d9@mail.gmail.com>

Hi all,

just one example (from [1])

1) WGS-84 -> S-JTSK
12d48'25.15992	49d27'8.14571 -> 868208.52 1095793.96

echo "12d48'25.15992  49d27'8.14571" | cs2cs +proj=latlong +datum=WGS84 \
+to +proj=krovak +ellps=bessel +no_defs \
+towgs84=570.8,85.7,462.8,4.998,1.587,5.261,3.56

-868208.53      -1095793.57 -46.96

dy=1cm, dx=39cm (~ bessel -> wgs-84, OK)

2) Bessel (Ferro) -> S-JTSK
32d05'39.77584 50d05'11.32822 -> 742455.8799 1043259.9773

echo "32d05'39.77584 50d05'11.32822" | cs2cs +proj=latlong
+ellps=bessel +pm=ferro +to +proj=krovak +ellps=bessel +no_defs
-742455.88      -1043259.98 0.00

-> OK!

Hope it helps...

Best regards, Martin

[1] http://grass.fsv.cvut.cz/wiki/index.php/S-JTSK#Praktick.C3.A1_uk.C3.A1zka

2006/10/19, Melita Kennedy <mkennedy2 at earthlink.net>:
>
> >----------------------------------------------------------------------
> >
> >Date: Tue, 17 Oct 2006 16:41:49 -0400
> >From: Frank Warmerdam <warmerdam at pobox.com>
> >Subject: Re: [Proj] PROJ 4.5.0 beta (and Krovak!)
> >To: gerald.evenden at verizon.net,        "PROJ.4 and general Projections
> >       Discussions" <proj at lists.maptools.org>
> >
> [contents snipped]
> >
> >I don't really know any test points for Krovak or even what options
> >are required in the two implementations.
>
> While we were implementing Krovak for ESRI software, we were sent
> 7 test points. I don't know how official these are, as the source is
> unclear. Two of the points show up in another document sent by the
> ESRI distributor in  the Czech Republic. The longitudes are Greenwich-based,
> Bessel 1841 and the XY axes are south-west oriented, rather than east-north.
> The sample you posted is EN. When using the SW version, I got
>
> x = 1546506.6922  y = 1164802.1478
>
> longitude,latitude,x,y
> 16 50 59.17900, 50 12 32.44160, 1050538.6433, 568990.9967
> 12 50 23.78945, 49 50 35.78965, 1053301.0476, 859084.7000
> 22 19 38.87658, 49 50 35.78965, 1117926.6680, 180241.3620
> 22 19 38.87658, 48 38 23.46592, 1251684.1815, 184607.1409
> 12 50 23.78945, 48 38 23.46592, 1185471.9460, 880118.0569
> 16 50 59.17900, 50 12 32.44140, 1050538.6494, 568990.9974
> 17 25 51.17920, 50 15 30.70080, 1049221.1899, 527189.1948
>
> Melita Kennedy
> ESRI Product Specialist
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


-- 
Martin Landa <landa.martin at gmail.com> * http://gama.fsv.cvut.cz/~landa *


From mateusz at loskot.net  Thu Oct 19 05:32:20 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 19 Oct 2006 14:32:20 +0200
Subject: [Proj] [BB] Compilation fail on Windows
Message-ID: <45377054.4060806@loskot.net>

Hi,

I'm not sure where is the problem, but PROJ.4 buildbot (yeah,
we have one :-)) reports that PROJ.4 building with
Visual C++ 2005 fails.

Here is the builder #40:

http://198.202.74.219:8502/p4_winxp_full/builds/40

and here is compilation failure report:

http://198.202.74.219:8502/p4_winxp_full/builds/40/step-compile/0

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From EMiller at dfg.ca.gov  Thu Oct 19 07:49:23 2006
From: EMiller at dfg.ca.gov (Eric Miller)
Date: Thu, 19 Oct 2006 07:49:23 -0700
Subject: [Proj] [BB] Compilation fail on Windows
Message-ID: <s5372e12.022@dfg.ca.gov>

Looks to me like the new Roussilhe Stereographic projection source file
wasn't added to the makefile.vc.  But I'm just guessing since I don't
have a copy of the beta4 sources yet.

>>> mateusz at loskot.net 10/19/2006 5:32 AM >>>
Hi,

I'm not sure where is the problem, but PROJ.4 buildbot (yeah,
we have one :-)) reports that PROJ.4 building with
Visual C++ 2005 fails.

Here is the builder #40:

http://198.202.74.219:8502/p4_winxp_full/builds/40 

and here is compilation failure report:

http://198.202.74.219:8502/p4_winxp_full/builds/40/step-compile/0 

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net 
_______________________________________________
Proj mailing list
Proj at lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/proj


From warmerdam at pobox.com  Thu Oct 19 07:52:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 19 Oct 2006 10:52:58 -0400
Subject: [Proj] Re: PROJ 4.5.0 beta4
In-Reply-To: <4535BD28.4080904@pobox.com>
References: <4535BD28.4080904@pobox.com>
Message-ID: <4537914A.7080003@pobox.com>

Frank Warmerdam wrote:
> Folks,
> 
> OK, I somewhat botched the last release numbering, so I've lept ahead
> to beta4 assuming the last was really beta3.  This beta includes
> the Roussilhe Stereographic projection (copied from libproj4), as well as
> an update to EPSG 6.11.1 (at Markus Neteler's request).
> 
> If this does not have any glaring problems I'd like to declare it the
> official 4.5.0 soon.
> 
> I've also remembered how to get stuff on the ftp site, so:
> 
>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.zip
>   ftp://ftp.remotesensing.org/proj/proj-4.5.0b4.tar.gz
> 
> Best regards,

Folks,

I botched this ... I forgot to update the windows makefiles. I have replaced
the above files on the ftp site.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From mateusz at loskot.net  Thu Oct 19 08:01:13 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 19 Oct 2006 17:01:13 +0200
Subject: [Proj] [BB] Compilation fail on Windows
In-Reply-To: <s5372e12.022@dfg.ca.gov>
References: <s5372e12.022@dfg.ca.gov>
Message-ID: <45379339.4010101@loskot.net>

Eric Miller wrote:
> Looks to me like the new Roussilhe Stereographic projection source file
> wasn't added to the makefile.vc.  But I'm just guessing since I don't
> have a copy of the beta4 sources yet.

Eric,

It's been fixed already, by Frank:

http://198.202.74.219:8502/

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From ch.panel at free.fr  Fri Oct 20 13:10:33 2006
From: ch.panel at free.fr (cp)
Date: Fri, 20 Oct 2006 22:10:33 +0200
Subject: [Proj] grid shifting
Message-ID: <ehbafs$h26$1@sea.gmane.org>

Firts, excuse me for my poor english.

Just a question to see if I have understood the mechanism of grid shifting 
in proj lib....
The grid shifting is a correction of phi and lambda in a particular point on 
the ellipsoid : this corection is made by a matrix which is unique in a 
"step" of longitude and latitude. Isn't it ?

So datum transformation can be schematized as :

Plane Coordinates A => Geodetic Coordinates A => Grid Shifting => Geodetic 
coordinates B => Plane Coordinates B


So it is not possible (except by modifying code) to make a correction for 
these cases :

1) We have a grid of correction that represents differents values of 3D 
shifts for geocentric coordinates
like this :
Plane Coordinates A => Geotetic coordinate A => Geocentric cartesian 
coordinates A => Grid shifting => Geocentric cartesian coordinates B => 
Plane Coordinates B

2) We have a grid of correction that represents differents values of plane 
shifts
like this
Plane Coordinates A => Grid shifting (matrix : grid is based on planes 
coordinates and no more on geodesic coordinates) => Plane Coordinates B

Isn't it ?

We have to do this because of increasing accuracy of transformation beetween 
systems ( the grids could be experimental calculations)

thanks a lot for reply 





From HeinrichSchewe at web.de  Fri Oct 20 14:08:26 2006
From: HeinrichSchewe at web.de (Heinrich Schewe)
Date: Fri, 20 Oct 2006 23:08:26 +0200
Subject: [Proj] rotated ellipsoid (towgs84)
Message-ID: <ehbds8$sjc$2@sea.gmane.org>

I try the following datum transformation from WGS84 to a rotated Bessel
ellipsoid. The back-transformation gives a height difference of 0.01 m.

Is this due to the approximate rotation computation (assuming cos = 1,
sin = rad and sin*sin = 0) ?
Are these rotation values too big?
What can I do to get the same values or smaller differences for the
back-transformation?

Heinrich

cs2cs +proj=latlong +datum=WGS84 +to +proj=latlong
+towgs84=0,0,0,6,3,-7,0 +ellps=bessel
48 9 0
48d0'7.982"E    8d59'56.866"N 738.150

cs2cs -I +proj=latlong +datum=WGS84 +to +proj=latlong
+towgs84=0,0,0,6,3,-7,0 +ellps=bessel
48d0'7.982"E    8d59'56.866"N 738.150
48dE    9dN 0.010





From ovv at hetnet.nl  Fri Oct 20 16:13:10 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Sat, 21 Oct 2006 01:13:10 +0200
Subject: [Proj] rotated ellipsoid (towgs84)
In-Reply-To: <ehbds8$sjc$2@sea.gmane.org>
Message-ID: <C15F24A6.849F%ovv@hetnet.nl>

> From: Heinrich Schewe
> Date: Fri, 20 Oct 2006 23:08:26 +0200
> Subject: [Proj] rotated ellipsoid (towgs84)
> 
> I try the following datum transformation from WGS84 to a rotated Bessel
> ellipsoid. The back-transformation gives a height difference of 0.01 m.
> 
> Is this due to the approximate rotation computation (assuming cos = 1,
> sin = rad and sin*sin = 0) ?

Short answer: yes.

Long answer:
I have no idea if I understand the cs2cs command line correctly, but going
from wgs84 to bessel 1841 gives with my software (set to approximate
position vector rotation), starting from
lat=9, lon=48, h=0
the following bessel coordinates:
09d 00m 01.8004s, 47d 59m 52.0176s, 738.30632 m
and back with the same procedure:
09d 00m 00.0002s, 48d 00m 00.0000s, 0.01023 m

If I use the mathematically exact to/from transform (position vector
rotation, order of the rotation XYZ), then I get:
to bessel:
09d 00m 01.8002s, 47d 59m 52.0176s, 738.30120 m
back to wgs:
09d 00m 00.0000s, 48d 00m 00.0000s, 1.05e-9 m

This shows anyway that you can expect a 1 cm difference in height using PROJ
in this case.

> Are these rotation values too big?
Normal rotations are some tenths of an arcsecond.
But there are exceptions with tens of arcseconds. See e.g.
NEA74_Noumea_To_WGS_1984_1

> What can I do to get the same values or smaller differences for the
> back-transformation?
Use other software.
But....
The Helmert transform on an ellipsoid is merely a first order approximation.
The procedure is exact for a sphere, but even using the mathematically exact
spherical rotations on an ellipsoid is a bit silly.
Furthermore it is rather unlikely that transformation parameters can be
measured so accurately that a geocentric rotation (Helmert transform) or
even a local rotation (Molodensky-Badekas transform) will produce centimeter
accuracies.



From massimodisasha at yahoo.it  Sat Oct 21 10:41:47 2006
From: massimodisasha at yahoo.it (massimodisasha)
Date: Sat, 21 Oct 2006 19:41:47 +0200
Subject: [Proj] new 7 parameters  
Message-ID: <442893BD-21A9-4F88-B003-FAB1FB874297@yahoo.it>

hi,
i've 45 point of the (igm95) national italian grid of double points  
in (wgs84 - gauss boaga R40)
(IGM is the italian's geographical military institute)

all my points are distribuited in a small italian region.

i've done a little algoritms in matlab language  for resolve the  
Helmert linear sistem....
...now i've a new set of 7 parameters for do a trasformation beetween  
WGS and GB-R40.

how can i use this new parameters in Grass ?
can i use it in the (r.proj/v.proj) grass command?

how can i add in the proj library this new 7 parameters ? is it  
possible?
i've look at proj documentation, but  in the cs2cs doc (section  
towgs) i've found the instruction for translate a single  
point.   .....    my targhet is a coordinate translation that works  
with a raster file (image)

thanks!
Massimo


From richard.greenwood at gmail.com  Sun Oct 22 05:49:18 2006
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sun, 22 Oct 2006 06:49:18 -0600
Subject: [Proj] new 7 parameters
In-Reply-To: <442893BD-21A9-4F88-B003-FAB1FB874297@yahoo.it>
References: <442893BD-21A9-4F88-B003-FAB1FB874297@yahoo.it>
Message-ID: <ae9185aa0610220549n20591c86l30de557b401fa9be@mail.gmail.com>

On 10/21/06, massimodisasha <massimodisasha at yahoo.it> wrote:
> hi,
> i've 45 point of the (igm95) national italian grid of double points
> in (wgs84 - gauss boaga R40)
> (IGM is the italian's geographical military institute)
>
> all my points are distribuited in a small italian region.
>
> i've done a little algoritms in matlab language  for resolve the
> Helmert linear sistem....
> ...now i've a new set of 7 parameters for do a trasformation beetween
> WGS and GB-R40.
>
> how can i use this new parameters in Grass ?
> can i use it in the (r.proj/v.proj) grass command?
>
> how can i add in the proj library this new 7 parameters ? is it
> possible?
> i've look at proj documentation, but  in the cs2cs doc (section
> towgs) i've found the instruction for translate a single
> point.   .....    my targhet is a coordinate translation that works
> with a raster file (image)
>
> thanks!
> Massimo

Try addding a new entry to the "EPSG" file and then cretate a new
location from EPSG code.

-- 
Richard Greenwood
richard.greenwood at gmail.com
www.greenwoodmap.com


From neteler at itc.it  Sun Oct 22 10:33:59 2006
From: neteler at itc.it (Markus Neteler)
Date: Sun, 22 Oct 2006 19:33:59 +0200
Subject: [Proj] new 7 parameters
In-Reply-To: <442893BD-21A9-4F88-B003-FAB1FB874297@yahoo.it>
References: <442893BD-21A9-4F88-B003-FAB1FB874297@yahoo.it>
Message-ID: <20061022173359.GA15779@bartok.itc.it>

On Sat, Oct 21, 2006 at 07:41:47PM +0200, massimodisasha wrote:
> hi,
> i've 45 point of the (igm95) national italian grid of double points  
> in (wgs84 - gauss boaga R40)
> (IGM is the italian's geographical military institute)
> 
> all my points are distribuited in a small italian region.
> 
> i've done a little algoritms in matlab language  for resolve the  
> Helmert linear sistem....
> ...now i've a new set of 7 parameters for do a trasformation beetween  
> WGS and GB-R40.
> 
> how can i use this new parameters in Grass ?

When you define a new "location" (GRASS project), then
select 
D Other projection
to go into the user defined dialog.

Then select

Please specify projection name
Enter 'list' for the list of available projections
Hit RETURN to cancel request
>tmerc
Do you wish to specify a geodetic datum for this location?(y/n) [y]

Please specify datum name
Enter 'list' for the list of available datums
or 'custom' if you wish to enter custom parameters
Hit RETURN to cancel request
>custom                                 <<<<--- !!

Please specify ellipsoid name
Enter 'list' for the list of available ellipsoids
Hit RETURN to cancel request
>international

Please specify datum transformation parameters in PROJ.4 syntax. Examples:
        towgs84=dx,dy,dz        (3-parameter transformation)
        towgs84=dx,dy,dz,rx,ry,rz,m     (7-parameter transformation)
        nadgrids=alaska (Tables-based grid-shifting transformation)
Hit RETURN to cancel request
>towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68
Parameters to be used are:
"towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"
Is this correct?(y/n) [y]

Enter Scale Factor at the Central Meridian  [1.0000000000]: 0.9996
[...]



> can i use it in the (r.proj/v.proj) grass command?

Like this r.proj/v.proj use the datum.

Shortcut: If you want to modify an existing location (not
sure if that's a good idea since your data need to be reprojected),
simply edit
grassdata/<location>/PERMANENT/PROJ_INFO
and substitute the old datum parameters with

datum: rome40
datumparams: towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68

My PROJ_INFO looks like this:
name: Transverse Mercator
datum: rome40
datumparams: towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68
proj: tmerc
ellps: international
a: 6378388.0000000000
es: 0.0067226700
f: 297.0000000000
lat_0: 0.0000000000
lon_0: 9.0
k_0: 0.9996000000
x_0: 1500000.0000000000

Hope this helps,
Markus


From hamish_nospam at yahoo.com  Sun Oct 22 18:58:53 2006
From: hamish_nospam at yahoo.com (Hamish)
Date: Mon, 23 Oct 2006 14:58:53 +1300
Subject: [Proj] grid shifting
In-Reply-To: <ehbafs$h26$1@sea.gmane.org>
References: <ehbafs$h26$1@sea.gmane.org>
Message-ID: <20061023145853.6dbba228.hamish_nospam@yahoo.com>

cp wrote:
> Firts, excuse me for my poor english.
> 
> Just a question to see if I have understood the mechanism of grid
> shifting  in proj lib....
> The grid shifting is a correction of phi and lambda in a particular
> point on  the ellipsoid : this corection is made by a matrix which is
> unique in a  "step" of longitude and latitude. Isn't it ?
> 
> So datum transformation can be schematized as :
> 
> Plane Coordinates A => Geodetic Coordinates A => Grid Shifting =>
> Geodetic  coordinates B => Plane Coordinates B
> 
> 
> So it is not possible (except by modifying code) to make a correction
> for  these cases :
> 
> 1) We have a grid of correction that represents differents values of
> 3D  shifts for geocentric coordinates
> like this :
> Plane Coordinates A => Geotetic coordinate A => Geocentric cartesian 
> coordinates A => Grid shifting => Geocentric cartesian coordinates B
> =>  Plane Coordinates B
> 
> 2) We have a grid of correction that represents differents values of
> plane  shifts like this
> Plane Coordinates A => Grid shifting (matrix : grid is based on planes
> 
> coordinates and no more on geodesic coordinates) => Plane Coordinates
> B
> 
> Isn't it ?
> 
> We have to do this because of increasing accuracy of transformation
> beetween  systems ( the grids could be experimental calculations)


maybe this helps:
  http://www.stjohnspoint.co.uk/gis/france.htm

The deep IGN links seem to be broken now, but grid file for France and
instructions are there..


good luck,
Hamish


From warmerdam at pobox.com  Sun Oct 22 21:02:50 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 23 Oct 2006 00:02:50 -0400
Subject: [Proj] 4.5.0 Release Finalized
Message-ID: <453C3EEA.6000500@pobox.com>

Folks,

I have issued PROJ 4.5.0 final packages since there didn't seem to be any
serious problem with beta4.  The source can be found at:

   ftp://ftp.remotesensing.org/proj/proj-4.5.0.tar.gz
   ftp://ftp.remotesensing.org/proj/proj-4.5.0.zip

 From the NEWS file:

4.5.0 Release Notes
-------------------

  o Microsoft Visual Studio 8 compatibility changes.

  o Upgraded to EPSG 6.11.1 database.

  o Several bug fixes to pj_transform() to handle transient errors properly.

  o Fix Krovak projection (include +czech flag)

  o Added Roussilhe Stereographic projection from libproj4 (proj=rouss).

  o Added experimental +lon_wrap flag for alternate pj_transform() longitude
    wrapping behavior on output.


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From paul-grass at stjohnspoint.co.uk  Mon Oct 23 10:33:43 2006
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Mon, 23 Oct 2006 18:33:43 +0100 (BST)
Subject: [Proj] grid shifting
In-Reply-To: <20061023145853.6dbba228.hamish_nospam@yahoo.com>
References: <ehbafs$h26$1@sea.gmane.org>
	<20061023145853.6dbba228.hamish_nospam@yahoo.com>
Message-ID: <Pine.LNX.4.62.0610231823450.12491@agrippa.ukshells.co.uk>

Hello

On Mon, 23 Oct 2006, Hamish wrote:

> cp wrote:
>> Firts, excuse me for my poor english.
>>
>> Just a question to see if I have understood the mechanism of grid
>> shifting  in proj lib....
>> The grid shifting is a correction of phi and lambda in a particular
>> point on  the ellipsoid : this corection is made by a matrix which is
>> unique in a  "step" of longitude and latitude. Isn't it ?

That is how the Canadian NTv2 gridshift file format (as used by PROJ.4) 
works, yes. But it's not the only (nor necessarily the best) way.

>> So datum transformation can be schematized as :
>>
>> Plane Coordinates A => Geodetic Coordinates A => Grid Shifting =>
>> Geodetic  coordinates B => Plane Coordinates B

Yes, internal to PROJ.4 that is how datum shifting with +nadgrids=xxxxx
parameters works.

>> So it is not possible (except by modifying code) to make a correction
>> for  these cases :
>>
>> 1) We have a grid of correction that represents differents values of
>> 3D  shifts for geocentric coordinates
>> like this :
>> Plane Coordinates A => Geotetic coordinate A => Geocentric cartesian
>> coordinates A => Grid shifting => Geocentric cartesian coordinates B
>> =>  Plane Coordinates B

Internal to PROJ.4 that is how datum shifting with +towgs84=x,x,x,... 
parameters works.
Note that you can go straight from plane co-ordinates to Geocentric 
cartesian co-ordinates in PROJ.4: use the "fake" projection +proj=geocent.
So it *is* possible to do a transformation this way.

>> 2) We have a grid of correction that represents differents values of
>> plane  shifts like this
>> Plane Coordinates A => Grid shifting (matrix : grid is based on planes
>>
>> coordinates and no more on geodesic coordinates) => Plane Coordinates
>> B
>>
>> Isn't it ?

You could convert the matrix into a grid in NTv2 format that can be read 
by PROJ.4 - it needs some logical thinking and a bit of GIS work but it is 
quite easily possible and with accurate results too - see the page on my 
website below as Hamish has suggested.

>> We have to do this because of increasing accuracy of transformation
>> beetween  systems ( the grids could be experimental calculations)
>
>
> maybe this helps:
>  http://www.stjohnspoint.co.uk/gis/france.htm
>
> The deep IGN links seem to be broken now, but grid file for France and
> instructions are there..

They weren't working for a while but I fixed them to account for the 
updated IGN site in July so all should be fine now... ;)


Paul



From j.l.h.hartmann at uva.nl  Tue Oct 24 07:40:16 2006
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Tue, 24 Oct 2006 16:40:16 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table
In-Reply-To: <94e91cde0608081035i34c6d5bfx2ab7c50f3e8804f9@mail.gmail.com>
References: <94e91cde0608080112t2cfcb55ep8c7f1c4192d92a3a@mail.gmail.com>	<C0FE93DD.7A37%ovv@hetnet.nl>
	<94e91cde0608081035i34c6d5bfx2ab7c50f3e8804f9@mail.gmail.com>
Message-ID: <453E25D0.5090502@uva.nl>

Hi,

I was wondering whether Datum shift parameters (+towgs84=..) should be 
officially part of the epsg file that comes with PROJ. I computed the 
values for the Dutch and Belgian national grids (EPSG 28992 and 31370), see:

http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.html 


and

http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.html

At the moment, these have to be put manually in the epsg-file and in the 
spatial_ref_sys table of PostGIS.

Are these parameters to be included into a future release of PROJ? I 
know Gerald Evenden has always been against mixing projections and datum 
shifts.


Jan





From warmerdam at pobox.com  Tue Oct 24 08:45:11 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 24 Oct 2006 11:45:11 -0400
Subject: [Proj] Datum shifts in PROJ's EPSG table
In-Reply-To: <453E25D0.5090502@uva.nl>
References: <94e91cde0608080112t2cfcb55ep8c7f1c4192d92a3a@mail.gmail.com>	<C0FE93DD.7A37%ovv@hetnet.nl>	<94e91cde0608081035i34c6d5bfx2ab7c50f3e8804f9@mail.gmail.com>
	<453E25D0.5090502@uva.nl>
Message-ID: <453E3507.2040207@pobox.com>

Jan Hartmann wrote:
> Hi,
> 
> I was wondering whether Datum shift parameters (+towgs84=..) should be 
> officially part of the epsg file that comes with PROJ. I computed the 
> values for the Dutch and Belgian national grids (EPSG 28992 and 31370), 
> see:
> 
> http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.html 
> 
> 
> and
> 
> http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.html 
> 
> 
> At the moment, these have to be put manually in the epsg-file and in the 
> spatial_ref_sys table of PostGIS.

Jan,

The scripts I use to translate the EPSG database into PROJ.4 format already
attempts to identify datum shift values if they are present in the EPSG
database.  However, if there is more than one choice (which is quite common
for important datums) the script gives up and uses none of them since any
selection would be arbitrary.

So, one thing we could do is try and capture the EPSG datum shifts better.

The other thing I have been doing is that I have inserted an "override"
step in my translation from EPSG to PROJ.4 format that allows forcing a
datum shift solution for particular datums.  So when folks submit requests
to use a particular datum shift for a given datum, I apply it via this
override mechanism.  Of course, soon I'll no doubt get into the problem of
different people wanting different overrides for the same datum (applicable
to different regions) and then I will be back in the same problem of not
knowing which to choose.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From mdusaire at umn.edu  Tue Oct 24 10:55:57 2006
From: mdusaire at umn.edu (Martin du Saire)
Date: Tue, 24 Oct 2006 12:55:57 -0500
Subject: [Proj] Compiling in Cygwin: make error
Message-ID: <7.0.1.0.0.20061024125057.01b7bc30@umn.edu>

Hi,

I am trying to compile Proj4.5 in Cygwin2.5, but I think I am running 
into problems with "make".

configure doesn't report any errors, but when I run make, it seems to 
get stuck on:

if /bin/sh ../libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. 
-I. -I. -DPROJ_LIB=\"/usr/local/share/proj\"     -g -O2 -MT 
PJ_loxim.lo -MD -MP -MF ".deps/PJ_loxim.Tpo" -c -o PJ_loxim.lo PJ_loxim.c; \
	then mv -f ".deps/PJ_loxim.Tpo" ".deps/PJ_loxim.Plo"; else rm -f 
".deps/PJ_loxim.Tpo"; exit 1; fi
  gcc -DHAVE_CONFIG_H -I. -I. -I. 
-DPROJ_LIB=\"/usr/local/share/proj\" -g -O2 -MT PJ_loxim.lo -MD -MP 
-MF .deps/PJ_loxim.Tpo -c PJ_loxim.c  -DPIC -o .libs/PJ_loxim.o
  gcc -DHAVE_CONFIG_H -I. -I. -I. 
-DPROJ_LIB=\"/usr/local/share/proj\" -g -O2 -MT PJ_loxim.lo -MD -MP 
-MF .deps/PJ_loxim.Tpo -c PJ_loxim.c -o PJ_loxim.o >/dev/null 2>&1


ad infinitum.  Is this normal, should I just let it run its course?

Thanks.

Martin



From warmerdam at pobox.com  Tue Oct 24 21:04:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 25 Oct 2006 00:04:32 -0400
Subject: [Proj] Compiling in Cygwin: make error
In-Reply-To: <7.0.1.0.0.20061024125057.01b7bc30@umn.edu>
References: <7.0.1.0.0.20061024125057.01b7bc30@umn.edu>
Message-ID: <453EE250.3010209@pobox.com>

Martin du Saire wrote:
> Hi,
> 
> I am trying to compile Proj4.5 in Cygwin2.5, but I think I am running 
> into problems with "make".
> 
> configure doesn't report any errors, but when I run make, it seems to 
> get stuck on:
> 
> if /bin/sh ../libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. 
> -I. -I. -DPROJ_LIB=\"/usr/local/share/proj\"     -g -O2 -MT PJ_loxim.lo 
> -MD -MP -MF ".deps/PJ_loxim.Tpo" -c -o PJ_loxim.lo PJ_loxim.c; \
>     then mv -f ".deps/PJ_loxim.Tpo" ".deps/PJ_loxim.Plo"; else rm -f 
> ".deps/PJ_loxim.Tpo"; exit 1; fi
>  gcc -DHAVE_CONFIG_H -I. -I. -I. -DPROJ_LIB=\"/usr/local/share/proj\" -g 
> -O2 -MT PJ_loxim.lo -MD -MP -MF .deps/PJ_loxim.Tpo -c PJ_loxim.c  -DPIC 
> -o .libs/PJ_loxim.o
>  gcc -DHAVE_CONFIG_H -I. -I. -I. -DPROJ_LIB=\"/usr/local/share/proj\" -g 
> -O2 -MT PJ_loxim.lo -MD -MP -MF .deps/PJ_loxim.Tpo -c PJ_loxim.c -o 
> PJ_loxim.o >/dev/null 2>&1
> 
> 
> ad infinitum.  Is this normal, should I just let it run its course?

Martin,

I just tried the proj 4.5.0 tar file on my cygwin and it built fine.
I am using a Cygwin for which uname reports a date of Jan10 2006.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From sandeepkumar.jakkaraju at gmail.com  Tue Oct 24 23:05:34 2006
From: sandeepkumar.jakkaraju at gmail.com (Sandeep Kumar Jakkaraju)
Date: Wed, 25 Oct 2006 11:35:34 +0530
Subject: [Proj] Is there any Java compatibility ??
Message-ID: <c653c98f0610242305k4310a7aaj1a52a9ce4558119c@mail.gmail.com>

Is there any Java compatibility  ??

Can I use proj4 lib functions in a Java program ??


-- 
Sandeep Kumar Jakkaraju
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061025/1982b6c2/attachment.html>

From craig at millerfam.net  Tue Oct 24 23:16:25 2006
From: craig at millerfam.net (Craig Miller)
Date: Tue, 24 Oct 2006 23:16:25 -0700
Subject: [Proj] Is there any Java compatibility ??
In-Reply-To: <c653c98f0610242305k4310a7aaj1a52a9ce4558119c@mail.gmail.com>
Message-ID: <01d901c6f7fd$19b6e140$3301a8c0@vaio>

There used to be a proj4j project.  Not sure of the current status though.
 
--Craig
 

  _____  

From: proj-bounces at lists.maptools.org
[mailto:proj-bounces at lists.maptools.org] On Behalf Of Sandeep Kumar
Jakkaraju
Sent: Tuesday, October 24, 2006 11:06 PM
To: PROJ.4 and general Projections Discussions
Subject: [Proj] Is there any Java compatibility ??



Is there any Java compatibility  ??
 
Can I use proj4 lib functions in a Java program ??
 

-- 
Sandeep Kumar Jakkaraju 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061024/ebbf928e/attachment.html>

From martin.vermeer at hut.fi  Tue Oct 24 23:40:15 2006
From: martin.vermeer at hut.fi (Martin Vermeer)
Date: Wed, 25 Oct 2006 09:40:15 +0300
Subject: [Proj] Datum shifts in PROJ's EPSG table
In-Reply-To: <453E3507.2040207@pobox.com>
References: <94e91cde0608080112t2cfcb55ep8c7f1c4192d92a3a@mail.gmail.com>
	<C0FE93DD.7A37%ovv@hetnet.nl>
	<94e91cde0608081035i34c6d5bfx2ab7c50f3e8804f9@mail.gmail.com>
	<453E25D0.5090502@uva.nl>  <453E3507.2040207@pobox.com>
Message-ID: <1161758415.28034.9.camel@geo9.hut.fi>

On Tue, 2006-10-24 at 11:45 -0400, Frank Warmerdam wrote:
> Jan Hartmann wrote:
> > Hi,
> > 
> > I was wondering whether Datum shift parameters (+towgs84=..) should be 
> > officially part of the epsg file that comes with PROJ. I computed the 
> > values for the Dutch and Belgian national grids (EPSG 28992 and 31370), 
> > see:
> > 
> > http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.html 
> > 
> > 
> > and
> > 
> > http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.html 
> > 
> > 
> > At the moment, these have to be put manually in the epsg-file and in the 
> > spatial_ref_sys table of PostGIS.
> 
> Jan,
> 
> The scripts I use to translate the EPSG database into PROJ.4 format already
> attempts to identify datum shift values if they are present in the EPSG
> database.  However, if there is more than one choice (which is quite common
> for important datums) the script gives up and uses none of them since any
> selection would be arbitrary.
> 
> So, one thing we could do is try and capture the EPSG datum shifts better.
> 
> The other thing I have been doing is that I have inserted an "override"
> step in my translation from EPSG to PROJ.4 format that allows forcing a
> datum shift solution for particular datums.  So when folks submit requests
> to use a particular datum shift for a given datum, I apply it via this
> override mechanism.  Of course, soon I'll no doubt get into the problem of
> different people wanting different overrides for the same datum (applicable
> to different regions) and then I will be back in the same problem of not
> knowing which to choose.

Both of these mechanisms, while better than their absence, seem
arbitrary. 

Has there been thinking on how to support more than one datum shift if
available? What would that require? Could the EPSG labels be modified
inside Proj.4, e.g. <4123:1>, <4123:2> etc? Or is this issue bigger than
Proj.4?

(If we are talking about slightly different +towgs84 for different parts
of one datum target area, the use of a shift grid could be an
alternative solution)

- Martin

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061025/7d47396d/attachment.sig>

From roger at opq.se  Wed Oct 25 03:58:14 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Wed, 25 Oct 2006 12:58:14 +0200
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
Message-ID: <1161773894.32076.38.camel@acme>


I use the C API to do transformations. I am converting from GPS values
in WGS84 to OSTN02 for the United Kingdom. My current code is:

       fromProj = pj_init_plus(
                "+proj=latlong "
                "+ellps=WGS84 "
                "+towgs84=0,0,0 "
                "+nodefs")

        toProj   = pj_init_plus(
                "+proj=tmerc "
                "+lat_0=49 "
                "+lon_0=-2 "
                "+k=0.9996012717 "
                "+x_0=400000 "
                "+y_0=-100000 "
                "+ellps=airy "
                "+nadgrids=gb.gsb "
                "+units=m "
                "+no_defs")

Note that I do a grid shift, using data provided by a kind member of
this list.

My question is, how can I use the GRS80 ellipsoid instead of Airy? 


-- 
Roger Oberholtzer

OPQ Systems AB
Ramböll Sverige AB
Kapellgränd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Tel: Int +46 8-615 60 20
Fax: Int +46 8-31 42 23



From warmerdam at pobox.com  Wed Oct 25 04:52:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 25 Oct 2006 07:52:12 -0400
Subject: [Proj] Is there any Java compatibility ??
In-Reply-To: <c653c98f0610242305k4310a7aaj1a52a9ce4558119c@mail.gmail.com>
References: <c653c98f0610242305k4310a7aaj1a52a9ce4558119c@mail.gmail.com>
Message-ID: <453F4FEC.6020604@pobox.com>

Sandeep Kumar Jakkaraju wrote:
> 
> Is there any Java compatibility  ??
>  
> Can I use proj4 lib functions in a Java program ??

Sandeep,

The PROJ source tree includes JNI based Java bindings.  I have
attached the README from proj/jniwrap, but basically if you configure
with the --with-jni option properly, you should get jni wrappers.

The GeoTools projects also includes pure Java projections classes if
a JNI wrapped PROJ seems inconvenient.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: README
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061025/866b356d/attachment.ksh>

From ovv at hetnet.nl  Wed Oct 25 07:15:25 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Wed, 25 Oct 2006 16:15:25 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table
In-Reply-To: <1161758415.28034.9.camel@geo9.hut.fi>
Message-ID: <C1653E1D.8562%ovv@hetnet.nl>

> From: Martin Vermeer
> Date: Wed, 25 Oct 2006 09:40:15 +0300
> Subject: Re: [Proj] Datum shifts in PROJ's EPSG table
> 
> On Tue, 2006-10-24 at 11:45 -0400, Frank Warmerdam wrote:
>> Jan Hartmann wrote:
>>> Hi,
>>> 
>>> I was wondering whether Datum shift parameters (+towgs84=..) should be
>>> officially part of the epsg file that comes with PROJ. I computed the
>>> values for the Dutch and Belgian national grids (EPSG 28992 and 31370),

....

> Has there been thinking on how to support more than one datum shift if
> available? What would that require? Could the EPSG labels be modified
> inside Proj.4, e.g. <4123:1>, <4123:2> etc? Or is this issue bigger than
> Proj.4?

Also interesting: for the Dutch RD there are two sets for the transformation
between Bessel 1841 and WGS84. One is for the direction Bessel 1841 ->
WGS84, and another, slightly different set, is for WGS84 -> Bessel 1841.
I reported this with references in my posting "Re: [Proj] proj and Dutch
RD", dated 2006-01-12.
Using different sets for the to-from directions enhances the accuracy
somewhat.




From warmerdam at pobox.com  Wed Oct 25 07:47:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 25 Oct 2006 10:47:44 -0400
Subject: [Proj] Datum shifts in PROJ's EPSG table
In-Reply-To: <1161758415.28034.9.camel@geo9.hut.fi>
References: <94e91cde0608080112t2cfcb55ep8c7f1c4192d92a3a@mail.gmail.com>	<C0FE93DD.7A37%ovv@hetnet.nl>	<94e91cde0608081035i34c6d5bfx2ab7c50f3e8804f9@mail.gmail.com>	<453E25D0.5090502@uva.nl>
	<453E3507.2040207@pobox.com> <1161758415.28034.9.camel@geo9.hut.fi>
Message-ID: <453F7910.8070800@pobox.com>

Martin Vermeer wrote:
> Both of these mechanisms, while better than their absence, seem
> arbitrary. 

Martin,

True

> Has there been thinking on how to support more than one datum shift if
> available? What would that require? Could the EPSG labels be modified
> inside Proj.4, e.g. <4123:1>, <4123:2> etc? Or is this issue bigger than
> Proj.4?

For any given datum EPSG keeps a list of ways of transforming to other
datums - usually to wgs84, and often with detailed notes on where they
are most applicable.

The idea would be for us to offer all of these in some fashion and let
the user select.  The proposed approach (names like <4123:1>) would work,
but gives the user little clue about which is more appropriate.  It is also
annoying that we would need per-datum-shift-value options for every
projected coordinate system based on the datum.

> (If we are talking about slightly different +towgs84 for different parts
> of one datum target area, the use of a shift grid could be an
> alternative solution)

I don't see this as a direct analog though it is a possibility.

I will say that I have no plans for a systematic approach to dealing with
this whole many-datum-shift-options issue.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From massimodisasha at yahoo.it  Wed Oct 25 20:23:41 2006
From: massimodisasha at yahoo.it (massimodisasha)
Date: Thu, 26 Oct 2006 05:23:41 +0200
Subject: [Proj] Re: new 7 parameters
In-Reply-To: <200610231602.k9NG1pwB022328@duke.maptools.org>
References: <200610231602.k9NG1pwB022328@duke.maptools.org>
Message-ID: <578D668D-1892-4868-8631-CABADBB09E0C@yahoo.it>

wow !
great!
this is what i need :-) ,
thanks for your help !!!

Massimo.

Il giorno 23/ott/06, alle ore 18:02, proj-request at lists.maptools.org  
ha scritto:

> On Sat, Oct 21, 2006 at 07:41:47PM +0200, massimodisasha wrote:
>> hi,
>> i've 45 point of the (igm95) national italian grid of double points
>> in (wgs84 - gauss boaga R40)
>> (IGM is the italian's geographical military institute)
>>
>> all my points are distribuited in a small italian region.
>>
>> i've done a little algoritms in matlab language  for resolve the
>> Helmert linear sistem....
>> ...now i've a new set of 7 parameters for do a trasformation beetween
>> WGS and GB-R40.
>>
>> how can i use this new parameters in Grass ?
>
> When you define a new "location" (GRASS project), then
> select
> D Other projection
> to go into the user defined dialog.
>
> Then select
>
> Please specify projection name
> Enter 'list' for the list of available projections
> Hit RETURN to cancel request
>> tmerc
> Do you wish to specify a geodetic datum for this location?(y/n) [y]
>
> Please specify datum name
> Enter 'list' for the list of available datums
> or 'custom' if you wish to enter custom parameters
> Hit RETURN to cancel request
>> custom                                 <<<<--- !!
>
> Please specify ellipsoid name
> Enter 'list' for the list of available ellipsoids
> Hit RETURN to cancel request
>> international
>
> Please specify datum transformation parameters in PROJ.4 syntax.  
> Examples:
>         towgs84=dx,dy,dz        (3-parameter transformation)
>         towgs84=dx,dy,dz,rx,ry,rz,m     (7-parameter transformation)
>         nadgrids=alaska (Tables-based grid-shifting transformation)
> Hit RETURN to cancel request
>> towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68
> Parameters to be used are:
> "towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"
> Is this correct?(y/n) [y]
>
> Enter Scale Factor at the Central Meridian  [1.0000000000]: 0.9996
> [...]
>
>
>
>> can i use it in the (r.proj/v.proj) grass command?
>
> Like this r.proj/v.proj use the datum.
>
> Shortcut: If you want to modify an existing location (not
> sure if that's a good idea since your data need to be reprojected),
> simply edit
> grassdata/<location>/PERMANENT/PROJ_INFO
> and substitute the old datum parameters with
>
> datum: rome40
> datumparams: towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68
>
> My PROJ_INFO looks like this:
> name: Transverse Mercator
> datum: rome40
> datumparams: towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68
> proj: tmerc
> ellps: international
> a: 6378388.0000000000
> es: 0.0067226700
> f: 297.0000000000
> lat_0: 0.0000000000
> lon_0: 9.0
> k_0: 0.9996000000
> x_0: 1500000.0000000000
>
> Hope this helps,
> Markus

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20061026/c703ba17/attachment.html>

From j.l.h.hartmann at uva.nl  Thu Oct 26 02:20:34 2006
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 26 Oct 2006 11:20:34 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
	Belgium)
Message-ID: <45407DE2.6070904@uva.nl>

Frank Warmerdam wrote:

 > So when folks submit requests to use a particular datum shift for a
 > given datum, I apply it via this override mechanism.


In that case I would like to submit the Datum shifts for the Netherlands 
and Belgium for inclusion in the epsg table. They are described in the 
following postings:

http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.html 

http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.html 


The Dutch parameters have been confirmed by the cadastral service; the 
Belgian one has at least been tested once. See the thread starting with:
http://postgis.refractions.net/pipermail/postgis-users/2006-October/013565.html

Thanks!

Jan


From mdusaire at umn.edu  Thu Oct 26 06:05:43 2006
From: mdusaire at umn.edu (Martin du Saire)
Date: Thu, 26 Oct 2006 08:05:43 -0500
Subject: [Proj] Compiling in Cygwin: make error
Message-ID: <7.0.1.0.0.20061025164151.01ae5e18@umn.edu>

Well,

For what it's worth, I'm using the kernel version:  2006-07-30

Any thoughts on what make is trying to tell me, I don't know how to 
interpret the output, yet?

Thanks.

M



From warmerdam at pobox.com  Thu Oct 26 06:48:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 26 Oct 2006 09:48:49 -0400
Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
	Belgium)
In-Reply-To: <45407DE2.6070904@uva.nl>
References: <45407DE2.6070904@uva.nl>
Message-ID: <4540BCC1.6090600@pobox.com>

Jan Hartmann wrote:
> Frank Warmerdam wrote:
> 
>  > So when folks submit requests to use a particular datum shift for a
>  > given datum, I apply it via this override mechanism.
> 
> 
> In that case I would like to submit the Datum shifts for the Netherlands 
> and Belgium for inclusion in the epsg table. They are described in the 
> following postings:
> 
> http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.html 
> 
> http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.html 
> 
> 
> The Dutch parameters have been confirmed by the cadastral service; the 
> Belgian one has at least been tested once. See the thread starting with:
> http://postgis.refractions.net/pipermail/postgis-users/2006-October/013565.html 

Jan,

Datum 4289 (Amersfoort) has already been incorporated for the PROJ 4.5.0
release.  Please submit a bugzilla bug report for the Belgium request with
any supporting information and I'll apply it.  (well ok, the change is already
in my local copy now - just waiting for a bug report # to reference).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From ovv at hetnet.nl  Thu Oct 26 07:17:20 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Thu, 26 Oct 2006 16:17:20 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
	Belgium)
In-Reply-To: <45407DE2.6070904@uva.nl>
Message-ID: <C1669010.859A%ovv@hetnet.nl>

> From: Jan Hartmann
> Date: Thu, 26 Oct 2006 11:20:34 +0200
> Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
> Belgium)

> In that case I would like to submit the Datum shifts for the Netherlands
> and Belgium for inclusion in the epsg table. They are described in the
> following postings:
> http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894.ht
> ml 
> http://postgis.refractions.net/pipermail/postgis-users/2006-October/013570.htm
> l 
> The Dutch parameters have been confirmed by the cadastral service;
...

Thanks for mentioning this. I still used the post-2000, but pre-2004
parameters which are no longer valid since 2006-01-01.
<https://rdinfo.kadaster.nl/?inhoud=/rd/nieuws-bericht.asp%3FId%3D6%26Id_Cat
egorie%3D1&navig=/rd/nav_serverside.html%3Fscript%3D1>

The EPSG database itself has the Dutch RD 2004 transformation parameters
under coordinate operation 15739. For some reason they were not converted to
the PROJ epsg file, but Frank just mentioned epsg number 4289. Here the
translation figures are rounded to 3 decimals.

I did a bit of web searching and it appears to me that the Dutch Kadaster
doesn't want the new transformation procedures and parameters from
RDNAPTRANS 2004 to be published.
You can download a file rdnaptrans.zip with code, grid data, tests and
explanations from the download page at <http://www.rdnap.nl/> but you'll
have to ask for a password to deflate the zip file.
The Transformator from the Kadaster still uses the old stuff.
<https://RDinfo.kadaster.nl/rd/transformator.html>
All non-protected information pages still describe the old procedures &
parameters; for instance:
"Coördinaattransformaties en kaartprojecties", Ministerie van Verkeer en
Waterstaat, Meetkundige Dienst
<http://www.rdnap.nl/download/coor-en-proj.zip>

Apparently this reservedness serves some purpose.

I suppose the "confirmed" transformation:

<quote>
a more accurate definition for the Dutch system is:
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
+k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel  +units=m
+towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.87
03473836068,4.0812 
+no_defs +to +proj=latlong +datum=WGS84
</quote>

mentioned on:
<http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894
.html>
is derived from the RDNAPTRANS 2004 procedures.





From mdusaire at umn.edu  Thu Oct 26 09:57:12 2006
From: mdusaire at umn.edu (Martin du Saire)
Date: Thu, 26 Oct 2006 16:57:12 +0000 (UTC)
Subject: [Proj] Re: Compiling in Cygwin: make error
References: <7.0.1.0.0.20061024125057.01b7bc30@umn.edu>
	<453EE250.3010209@pobox.com>
Message-ID: <loom.20061026T184932-542@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> 
> Martin du Saire wrote
> >  gcc -DHAVE_CONFIG_H -I. -I. -I. -DPROJ_LIB=\"/usr/local/share/proj\" -g 
> > -O2 -MT PJ_loxim.lo -MD -MP -MF .deps/PJ_loxim.Tpo -c PJ_loxim.c -o 
> > PJ_loxim.o >/dev/null 2>&1
> > 
> > 
> > ad infinitum.  Is this normal, should I just let it run its course?
> 
> Martin,
> 
> I just tried the proj 4.5.0 tar file on my cygwin and it built fine.
> I am using a Cygwin for which uname reports a date of Jan10 2006.
> 
> Best regards,
> 

Resolved I think.  The problem was that all that text wizzing by scared the
be-windows out of me.  Sorry for the unnecessary post.  I would still like to
know what it all means though...

Thanks.

M





From j.l.h.hartmann at uva.nl  Fri Oct 27 02:24:40 2006
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 27 Oct 2006 11:24:40 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
	Belgium)
Message-ID: <4541D058.5000601@uva.nl>

Hi Oscar,

The Datum shifts were derived from the EPSG database, version 6.11, nr 
55; rotations are converted from radians to arc-seconds and 
sign-reversed. This transformation supersedes nr 53, which is the one 
you use and the one mentioned in the publications on the RDNAP website. 
  The EPSG database mentions as source for 55: "Nederlandse Commissie 
voor Geodesie (NCG)". This seems to be:

A. de Bruijne, J. van Buren, A. Kösters and H. van der Marel, "De 
geodetische referentiestelsels van Nederland; Definitie en vastlegging 
van ETRS89, RD en NAP en hun onderlinge relatie". Delft: Nederlandse 
Commissie voor Geodesie (NCG), to be published in 2005

Regards,

Jan


Oscar van Vlijmen wrote:

 > Thanks for mentioning this. I still used the post-2000, but pre-2004
 > parameters which are no longer valid since 2006-01-01.
 > 
<https://rdinfo.kadaster.nl/?inhoud=/rd/nieuws-bericht.asp%3FId%3D6%26Id_Cat
egorie%3D1&navig=/rd/nav_serverside.html%3Fscript%3D1>
 >
 > The EPSG database itself has the Dutch RD 2004 transformation
 > parameters under coordinate operation 15739. For some reason they were
 > not converted to the PROJ epsg file, but Frank just mentioned epsg
 > number 4289. Here the translation figures are rounded to 3 decimals.

 > I did a bit of web searching and it appears to me that the Dutch
 > Kadaster doesn't want the new transformation procedures and parameters
 > from RDNAPTRANS 2004 to be published. You can download a file
 > rdnaptrans.zip with code, grid data, tests and explanations from the
 > download page at <http://www.rdnap.nl/> but you'll have to ask for a
 > password to deflate the zip file. The Transformator from the Kadaster
 > still uses the old stuff.
 > <https://RDinfo.kadaster.nl/rd/transformator.html>
 > All non-protected information pages still describe the old procedures
 > & parameters; for instance:
 > "Coördinaattransformaties en kaartprojecties", Ministerie van Verkeer
 > en Waterstaat, Meetkundige Dienst
 > <http://www.rdnap.nl/download/coor-en-proj.zip>

 > Apparently this reservedness serves some purpose.

 > I suppose the "confirmed" transformation:

 > <quote>
 > a more accurate definition for the Dutch system is:
 > +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
 > +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel  +units=m
 > 
+towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.87
 > 03473836068,4.0812
 > +no_defs +to +proj=latlong +datum=WGS84
 > </quote>

 > mentioned on:
 > 
<http://postgis.refractions.net/pipermail/postgis-users/2005-November/009894
.html>
 > is derived from the RDNAPTRANS 2004 procedures.


From ovv at hetnet.nl  Fri Oct 27 04:30:01 2006
From: ovv at hetnet.nl (Oscar van Vlijmen)
Date: Fri, 27 Oct 2006 13:30:01 +0200
Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
	Belgium)
In-Reply-To: <4541D058.5000601@uva.nl>
Message-ID: <C167BA59.85C7%ovv@hetnet.nl>

> From: Jan Hartmann
> Date: Fri, 27 Oct 2006 11:24:40 +0200
> Subject: [Proj] Datum shifts in PROJ's EPSG table (The Netherlands and
> Belgium)
> 
> Hi Oscar,
> 
> The Datum shifts were derived from the EPSG database, version 6.11, nr
> 55; rotations are converted from radians to arc-seconds and
> sign-reversed. This transformation supersedes nr 53, which is the one
> you use and the one mentioned in the publications on the RDNAP website.
> The EPSG database mentions as source for 55: "Nederlandse Commissie
> voor Geodesie (NCG)". This seems to be:
> 
> A. de Bruijne, J. van Buren, A. Kösters and H. van der Marel, "De
> geodetische referentiestelsels van Nederland; Definitie en vastlegging
> van ETRS89, RD en NAP en hun onderlinge relatie". Delft: Nederlandse
> Commissie voor Geodesie (NCG), to be published in 2005

Thanks for taking the time to shed some light on the matter of
transformation parameters for NL & BE.
I've already seen the publication from De Bruijne et alii.
http://www.ncg.knaw.nl/Publicaties/Groen/43Bruijne.html
One can buy a hardcopy or download a free PDF. It's a bilingual publication:
Dutch & English.
English title: "Geodetic reference frames in the Netherlands, Definition and
specification of ETRS89, RD and NAP, and their mutual relationships."
The new RD2004 is mentioned, but no actual transformation parameters are
given.
Currently the best freely available internet source for the problem at hand
seems to be the EPSG database.







From peter.bogaert at skynet.be  Mon Oct 30 01:36:58 2006
From: peter.bogaert at skynet.be (Peter Bogaert)
Date: Mon, 30 Oct 2006 09:36:58 +0000 (UTC)
Subject: [Proj] Ellipsoide
Message-ID: <loom.20061030T103204-536@post.gmane.org>

Deal all,

I have a small question concerning the proj4 library.
When i convert data from eg. a Belgian Lambert 72 coördinate system (ellipsoide
International 1924) to a UTM coördinate system (ellipsoide WGS84), does cs2cs
take into account the different ellipsoïdes? Does the proj4 take into account
the different ellipsoides or not? Do i have to program a convertion for the
lat/lon coordinate shift between different ellipsoides or not?

Kind Regards
Peter Bogaert

Ghent University
Belgium
peter.bogaert at skynet.be



From j.l.h.hartmann at uva.nl  Mon Oct 30 04:01:10 2006
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Mon, 30 Oct 2006 13:01:10 +0100
Subject: [Proj] Ellipsoide
In-Reply-To: <loom.20061030T103204-536@post.gmane.org>
References: <loom.20061030T103204-536@post.gmane.org>
Message-ID: <4545E986.9090408@uva.nl>

Hi Peter,

De subject has been discussed recently on the PostGIS list, starting with

http://postgis.refractions.net/pipermail/postgis-users/2006-October/013565.html

Currently, PROJ does *NOT* by default take into account the datum shift 
between ellipsoides for Belgium (it will do so in a next release). To 
get the proper conversion, use the following parameter string:

+proj=lcc +lat_1=51.16666723333333 +lat_2=49.8333339 +lat_0=90
+lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl
+towgs84=106.868628,-52.297783,103.723893,0.336570,-0.456955,1.842183,1.0000012747
+units=m +no_defs

The towgs84 numbers are from: http://www.ngi.be/NL/NL4-4.shtm

Regards,

Jan Hartmann
Department of Geography
University of Amsterdam


Peter Bogaert wrote:
> Deal all,
> 
> I have a small question concerning the proj4 library.
> When i convert data from eg. a Belgian Lambert 72 coördinate system (ellipsoide
> International 1924) to a UTM coördinate system (ellipsoide WGS84), does cs2cs
> take into account the different ellipsoïdes? Does the proj4 take into account
> the different ellipsoides or not? Do i have to program a convertion for the
> lat/lon coordinate shift between different ellipsoides or not?
> 
> Kind Regards
> Peter Bogaert
> 
> Ghent University
> Belgium
> peter.bogaert at skynet.be
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 



From roger at opq.se  Mon Oct 30 07:34:08 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Mon, 30 Oct 2006 16:34:08 +0100
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <1161773894.32076.38.camel@acme>
References: <1161773894.32076.38.camel@acme>
Message-ID: <1162222448.21950.30.camel@acme>

No takers on this one?

On Wed, 2006-10-25 at 12:58 +0200, Roger Oberholtzer wrote:
> I use the C API to do transformations. I am converting from GPS values
> in WGS84 to OSTN02 for the United Kingdom. My current code is:
> 
>        fromProj = pj_init_plus(
>                 "+proj=latlong "
>                 "+ellps=WGS84 "
>                 "+towgs84=0,0,0 "
>                 "+nodefs")
> 
>         toProj   = pj_init_plus(
>                 "+proj=tmerc "
>                 "+lat_0=49 "
>                 "+lon_0=-2 "
>                 "+k=0.9996012717 "
>                 "+x_0=400000 "
>                 "+y_0=-100000 "
>                 "+ellps=airy "
>                 "+nadgrids=gb.gsb "
>                 "+units=m "
>                 "+no_defs")
> 
> Note that I do a grid shift, using data provided by a kind member of
> this list.
> 
> My question is, how can I use the GRS80 ellipsoid instead of Airy? 
> 
> 
-- 
Roger Oberholtzer

OPQ Systems AB
Ramböll Sverige AB
Kapellgränd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Tel: Int +46 8-615 60 20
Fax: Int +46 8-31 42 23



From paul-grass at stjohnspoint.co.uk  Mon Oct 30 08:04:43 2006
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Mon, 30 Oct 2006 16:04:43 +0000 (GMT)
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <1162222448.21950.30.camel@acme>
References: <1161773894.32076.38.camel@acme> <1162222448.21950.30.camel@acme>
Message-ID: <Pine.LNX.4.62.0610301602250.4104@agrippa.ukshells.co.uk>

On Mon, 30 Oct 2006, Roger Oberholtzer wrote:

> No takers on this one?
>
> On Wed, 2006-10-25 at 12:58 +0200, Roger Oberholtzer wrote:
>> I use the C API to do transformations. I am converting from GPS values
>> in WGS84 to OSTN02 for the United Kingdom. My current code is:
>>
>>        fromProj = pj_init_plus(
>>                 "+proj=latlong "
>>                 "+ellps=WGS84 "
>>                 "+towgs84=0,0,0 "
>>                 "+nodefs")
>>
>>         toProj   = pj_init_plus(
>>                 "+proj=tmerc "
>>                 "+lat_0=49 "
>>                 "+lon_0=-2 "
>>                 "+k=0.9996012717 "
>>                 "+x_0=400000 "
>>                 "+y_0=-100000 "
>>                 "+ellps=airy "
>>                 "+nadgrids=gb.gsb "
>>                 "+units=m "
>>                 "+no_defs")
>>
>> Note that I do a grid shift, using data provided by a kind member of
>> this list.

Hmm, that might have been me. The file was huge though - around 20MB IIRC? 
I would need to look into using different resolutions for the latitude and 
longitude before making it more viable for distribution I think.

>> My question is, how can I use the GRS80 ellipsoid instead of Airy?

Well if both projections are on the same ellipsoid then there is no need 
for any of the datum transform stuff. So just delete all mention of 
towgs84 and nadgrids parameters and set both ellipsoids to GRS80.

Paul


From roger at opq.se  Mon Oct 30 09:48:44 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Mon, 30 Oct 2006 18:48:44 +0100
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <Pine.LNX.4.62.0610301602250.4104@agrippa.ukshells.co.uk>
References: <1161773894.32076.38.camel@acme> <1162222448.21950.30.camel@acme>
	<Pine.LNX.4.62.0610301602250.4104@agrippa.ukshells.co.uk>
Message-ID: <1162230525.21950.37.camel@acme>

On Mon, 2006-10-30 at 16:04 +0000, Paul Kelly wrote:
> On Mon, 30 Oct 2006, Roger Oberholtzer wrote:
> 
> > No takers on this one?
> >
> > On Wed, 2006-10-25 at 12:58 +0200, Roger Oberholtzer wrote:
> >> I use the C API to do transformations. I am converting from GPS values
> >> in WGS84 to OSTN02 for the United Kingdom. My current code is:
> >>
> >>        fromProj = pj_init_plus(
> >>                 "+proj=latlong "
> >>                 "+ellps=WGS84 "
> >>                 "+towgs84=0,0,0 "
> >>                 "+nodefs")
> >>
> >>         toProj   = pj_init_plus(
> >>                 "+proj=tmerc "
> >>                 "+lat_0=49 "
> >>                 "+lon_0=-2 "
> >>                 "+k=0.9996012717 "
> >>                 "+x_0=400000 "
> >>                 "+y_0=-100000 "
> >>                 "+ellps=airy "
> >>                 "+nadgrids=gb.gsb "
> >>                 "+units=m "
> >>                 "+no_defs")
> >>
> >> Note that I do a grid shift, using data provided by a kind member of
> >> this list.
> 
> Hmm, that might have been me. The file was huge though - around 20MB IIRC? 
> I would need to look into using different resolutions for the latitude and 
> longitude before making it more viable for distribution I think.

I did get the file from you a while back. Again, many thanks. While I
have your attention, what is the size of the grid in the file?

> >> My question is, how can I use the GRS80 ellipsoid instead of Airy?
> 
> Well if both projections are on the same ellipsoid then there is no need 
> for any of the datum transform stuff. So just delete all mention of 
> towgs84 and nadgrids parameters and set both ellipsoids to GRS80.

I thought OSTN02 required BOTH the GRS80 ellipsoid and the grid shift.

I am confused how, if I set the ellipsoid in both statements to GRS80,
that the library will know that my source data are WGS84?

-- 
Roger Oberholtzer

OPQ Systems AB
Ramböll Sverige AB
Kapellgränd 7
P.O. Box 4205
SE-102 65 Stockholm, Sweden

Tel: Int +46 8-615 60 20
Fax: Int +46 8-31 42 23



From warmerdam at pobox.com  Mon Oct 30 12:04:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 30 Oct 2006 15:04:40 -0500
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <1162222448.21950.30.camel@acme>
References: <1161773894.32076.38.camel@acme> <1162222448.21950.30.camel@acme>
Message-ID: <45465AD8.8080201@pobox.com>

Roger Oberholtzer wrote:
> No takers on this one?
> 
> On Wed, 2006-10-25 at 12:58 +0200, Roger Oberholtzer wrote:
>> I use the C API to do transformations. I am converting from GPS values
>> in WGS84 to OSTN02 for the United Kingdom. My current code is:
>>
>>        fromProj = pj_init_plus(
>>                 "+proj=latlong "
>>                 "+ellps=WGS84 "
>>                 "+towgs84=0,0,0 "
>>                 "+nodefs")
>>
>>         toProj   = pj_init_plus(
>>                 "+proj=tmerc "
>>                 "+lat_0=49 "
>>                 "+lon_0=-2 "
>>                 "+k=0.9996012717 "
>>                 "+x_0=400000 "
>>                 "+y_0=-100000 "
>>                 "+ellps=airy "
>>                 "+nadgrids=gb.gsb "
>>                 "+units=m "
>>                 "+no_defs")
>>
>> Note that I do a grid shift, using data provided by a kind member of
>> this list.
>>
>> My question is, how can I use the GRS80 ellipsoid instead of Airy? 

Roger,

Well, you would just change +ellps=airy to +ellps=GRS80.

But perhaps your question was more subtle?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From roger at opq.se  Mon Oct 30 13:25:08 2006
From: roger at opq.se (Roger Oberholtzer)
Date: Mon, 30 Oct 2006 22:25:08 +0100
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <45465AD8.8080201@pobox.com>
References: <1161773894.32076.38.camel@acme>
	<1162222448.21950.30.camel@acme>  <45465AD8.8080201@pobox.com>
Message-ID: <1162243509.7030.5.camel@shark.pacific>

On Mon, 2006-10-30 at 15:04 -0500, Frank Warmerdam wrote:
> Roger Oberholtzer wrote:
> > No takers on this one?
> > 
> > On Wed, 2006-10-25 at 12:58 +0200, Roger Oberholtzer wrote:
> >> I use the C API to do transformations. I am converting from GPS values
> >> in WGS84 to OSTN02 for the United Kingdom. My current code is:
> >>
> >>        fromProj = pj_init_plus(
> >>                 "+proj=latlong "
> >>                 "+ellps=WGS84 "
> >>                 "+towgs84=0,0,0 "
> >>                 "+nodefs")
> >>
> >>         toProj   = pj_init_plus(
> >>                 "+proj=tmerc "
> >>                 "+lat_0=49 "
> >>                 "+lon_0=-2 "
> >>                 "+k=0.9996012717 "
> >>                 "+x_0=400000 "
> >>                 "+y_0=-100000 "
> >>                 "+ellps=airy "
> >>                 "+nadgrids=gb.gsb "
> >>                 "+units=m "
> >>                 "+no_defs")
> >>
> >> Note that I do a grid shift, using data provided by a kind member of
> >> this list.
> >>
> >> My question is, how can I use the GRS80 ellipsoid instead of Airy? 
> 
> Roger,
> 
> Well, you would just change +ellps=airy to +ellps=GRS80.
> 
> But perhaps your question was more subtle?

Or not. If I change the +ellps=airy to +ellps=grs80, leaving all else
the same, I see no difference at all.

Ad an example, for lat=50.34180000 lng=-4.82595000, I get
Easting=199020.37000 Northing=52918.58000 for both airy and grs80.

It could be that these should be the same. But I thought grs80 would
result in some small difference.

--
Roger Oberholtzer





From paul-grass at stjohnspoint.co.uk  Mon Oct 30 13:46:32 2006
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Mon, 30 Oct 2006 21:46:32 +0000 (GMT)
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <1162243509.7030.5.camel@shark.pacific>
References: <1161773894.32076.38.camel@acme> <1162222448.21950.30.camel@acme>
	<45465AD8.8080201@pobox.com>
	<1162243509.7030.5.camel@shark.pacific>
Message-ID: <Pine.LNX.4.62.0610302143500.1017@agrippa.ukshells.co.uk>

Hello Roger

On Mon, 30 Oct 2006, Roger Oberholtzer wrote:

>
> Or not. If I change the +ellps=airy to +ellps=grs80, leaving all else
> the same, I see no difference at all.

Are you sure you removed the towgs84 and nadgrids parameters as well? 
There should definitely be a difference there. GRS80 and WGS84 are 
essentially the same thing at mapping-level scales - that is why there is 
no need for datum transformation. My earlier message was a little 
confusing, sorry.

Not sure which machine I developed that OSGB36 grid file on so can't check 
I'm afraid - it may have been on machine that I no longer have access to.

Paul



From warmerdam at pobox.com  Mon Oct 30 17:11:52 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 30 Oct 2006 20:11:52 -0500
Subject: [Proj] OSTN02 question: GRS80 instead of Airy.
In-Reply-To: <1162243509.7030.5.camel@shark.pacific>
References: <1161773894.32076.38.camel@acme>	<1162222448.21950.30.camel@acme>
	<45465AD8.8080201@pobox.com>
	<1162243509.7030.5.camel@shark.pacific>
Message-ID: <4546A2D8.8060604@pobox.com>

Roger Oberholtzer wrote:
> Or not. If I change the +ellps=airy to +ellps=grs80, leaving all else
> the same, I see no difference at all.
> 
> Ad an example, for lat=50.34180000 lng=-4.82595000, I get
> Easting=199020.37000 Northing=52918.58000 for both airy and grs80.
> 
> It could be that these should be the same. But I thought grs80 would
> result in some small difference.

Roger,

I agree.  The conversion from geographic coordinates on the destination
ellipsoid to projected coordinates on the destination ellipsoid should
be different when the ellipsoid is different.  The shapes of Airy and
GRS80 are noticably different (by over 500m on the semi-major axis) so
I'd expect the difference to be noticable.

I'd suggest isolating this to small steps on the commandline.

When I isolate this one step via the proj command I get:

warmerda at gdal2200[198]% proj +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 
+x_0=400000 +y_0=-100000 +ellps=airy  +units=m +no_defs
-4.82 50.34
199361.89       52768.58

warmerda at gdal2200[199]% proj +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 
+x_0=400000 +y_0=-100000 +ellps=GRS80 +units=m +no_defs
-4.82 50.34
199342.42       52781.88

So yes, it seems you should see a difference on the order of 20 meters in
X and Y.

If I use cs2cs (which calls pj_transform()) for something close to your
case, bug using +towgs84 since I don't have gb.gsb, I also see differences
though in this case the transformation from ellipsoid to ellipsoid has
a substantial effect.

warmerda at gdal2200[202]% cs2cs +proj=latlong +datum=WGS84 +to +proj=tmerc 
+lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy 
+units=m +towgs84=0,0,0 +no_defs
-4.82 50.34
199358.98       52691.74 527.32

warmerda at gdal2200[200]% cs2cs +proj=latlong +datum=WGS84 +to +proj=tmerc 
+lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=GRS80 
+units=m +towgs84=0,0,0 +no_defs
-4.82 50.34
199342.42       52781.88 0.00

Are you sure you are having no effect?  Perhaps you could provide gb.gsb
for us to use for a test?


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From peter.bogaert at ugent.be  Mon Oct 30 04:45:17 2006
From: peter.bogaert at ugent.be (Peter Bogaert)
Date: Mon, 30 Oct 2006 13:45:17 +0100
Subject: [Proj] Re: Ellipsoide
Message-ID: <20061030124138.895F1415E98@tarzan.ugent.be>

Many thanks for your fast and good answer

Kind regards
Peter

"Jan Hartmann" <j.l.h.hartmann at uva.nl> wrote in message
news:<4545E986.9090408 at uva.nl>...
Hi Peter,

De subject has been discussed recently on the PostGIS list, starting with

http://postgis.refractions.net/pipermail/postgis-users/2006-October/013565.h
tml

Currently, PROJ does *NOT* by default take into account the datum shift 
between ellipsoides for Belgium (it will do so in a next release). To 
get the proper conversion, use the following parameter string:

+proj=lcc +lat_1=51.16666723333333 +lat_2=49.8333339 +lat_0=90
+lon_0=4.367486666666666 +x_0=150000.013 +y_0=5400088.438 +ellps=intl
+towgs84=106.868628,-52.297783,103.723893,0.336570,-0.456955,1.842183,1.0000
012747
+units=m +no_defs

The towgs84 numbers are from: http://www.ngi.be/NL/NL4-4.shtm

Regards,

Jan Hartmann
Department of Geography
University of Amsterdam


Peter Bogaert wrote:
> Deal all,
> 
> I have a small question concerning the proj4 library.
> When i convert data from eg. a Belgian Lambert 72 coördinate system
(ellipsoide
> International 1924) to a UTM coördinate system (ellipsoide WGS84), does
cs2cs
> take into account the different ellipsoïdes? Does the proj4 take into
account
> the different ellipsoides or not? Do i have to program a convertion for
the
> lat/lon coordinate shift between different ellipsoides or not?
> 
> Kind Regards
> Peter Bogaert
> 
> Ghent University
> Belgium
> peter.bogaert at skynet.be
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 

_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

----------

-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.

 




