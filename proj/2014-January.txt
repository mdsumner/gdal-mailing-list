From charles.karney at sri.com  Wed Jan  1 07:16:00 2014
From: charles.karney at sri.com (Charles Karney)
Date: Wed, 1 Jan 2014 10:16:00 -0500
Subject: [Proj] Wikipedia page on geodesics
Message-ID: <52C43130.6010903@sri.com>

Happy New Year everyone!

Readers of the list may be interested in the Wikipedia page on geodesics

   https://en.wikipedia.org/wiki/Geodesics_on_an_ellipsoid

Because this is Wikipedia, if you see something wrong with the article,
you can fix it yourself!

   --Charles


From woodbri at swoodbridge.com  Wed Jan  1 08:47:38 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Wed, 01 Jan 2014 11:47:38 -0500
Subject: [Proj] Mapserver Projection Issue
Message-ID: <52C446AA.30700@swoodbridge.com>

Hi All,

I'm trying to run down a mapserver projection issue that is starting to 
look like it might be the version of proj4. Sorry for the cross posting.

Situation:

I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS and world 
maps on the Ubuntu system projected to Spherical Mercator are messed up 
and worked fine on Debian. I get the same issue using mapserver 6.2.1 or 
5.6.8 and the big difference other than the OS and packages is that 
Ubuntu is using proj4-4.8.0 and the older Debian system is using proj4-4.6.0

Is this a known issue? I can make the data mapfile available if that helps.

System details below.

Any help would be appreciated.

Thanks,
   -Steve

Ubuntu system:

http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550

/u/www/cgi-bin/mapserv -v
MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG SUPPORTS=PROJ 
SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO 
SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER 
SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT 
SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI 
SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS INPUT=OGR 
INPUT=GDAL INPUT=SHAPEFILE

libproj-dev/precise uptodate 4.8.0-3~precise2
libproj0/precise uptodate 4.8.0-3~precise2
proj-bin/precise uptodate 4.8.0-3~precise2
proj-data/precise uptodate 4.8.0-3~precise2

# Spherical Mercator projection
<900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
+x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>


cgi-mapserver/precise uptodate 6.2.1-2~precise3
libmapserver/precise uptodate 6.2.1-2~precise3
mapserver-bin/precise uptodate 6.2.1-2~precise3

Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct 24 16:28:06 
UTC 2013 x86_64 x86_64 x86_64 GNU/Linux

I also get the same result from:

/u/www/cgi-bin/mapserv-56 -v
MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP 
OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=ICONV 
SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT 
SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR INPUT=GDAL 
INPUT=SHAPEFILE

which was built from source also using the libproj packages above.

Debian Lenny system:

http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550

proj/lenny uptodate 4.6.0-2

# Spherical Mercator - Google
<900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
+x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>


Linux gis.leaddog.com 2.6.32-042stab081.8 #1 SMP Wed Oct 23 16:32:28 MSK 
2013 x86_64 GNU/Linux

I built mapserver from source and I also get the same result from 
mapserver-5.6.8 built from source.



From mj10777 at googlemail.com  Thu Jan  2 00:36:50 2014
From: mj10777 at googlemail.com (Mark Johnson)
Date: Thu, 2 Jan 2014 09:36:50 +0100
Subject: [Proj] Proj Digest, Vol 115, Issue 10
In-Reply-To: <mailman.1.1388509203.32748.proj@lists.maptools.org>
References: <mailman.1.1388509203.32748.proj@lists.maptools.org>
Message-ID: <CAEEbjBjb06qWQN3hf+y6YNf51U+YdN=sTFmYfH25crD3mwjLyg@mail.gmail.com>

2013/12/31 <proj-request at lists.maptools.org>

> Send Proj mailing list submissions to
>         proj at lists.maptools.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.maptools.org/mailman/listinfo/proj
> or, via email, send a message with subject or body 'help' to
>         proj-request at lists.maptools.org
>
> You can reach the person managing the list at
>         proj-owner at lists.maptools.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Proj digest..."
>
>
> Today's Topics:
>
>    1. Map projection of Portugal (Jose Gon?alves)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 31 Dec 2013 00:39:03 +0000
> From: Jose Gon?alves <jagoncal at gmail.com>
> Subject: [Proj] Map projection of Portugal
> To: "PROJ.4 and general Projections Discussions"
>         <Proj at lists.maptools.org>
> Message-ID:
>         <
> CALHLaOSDza9Ec3N4++gGvhjigXSMrY7JGGSTEcLPXUsnvoiQTg at mail.gmail.com>
> Content-Type: text/plain; charset="windows-1252"
>
> Dear members of the list
>
> I would like to put some questions related to map projections being used in
> Europe. Most of the European countries are now using map coordinate systems
> based on the ETRS89 datum. The Portuguese Geographical Institute has
> adopted in 2006, for the continental Portugal, a projection, called
> ?PT-TM06? (EPSG code 3763), similar to the ones used before with older
> geodetic datums (Datum Lisboa and Datum 73). It has, in my opinion, some
> annoying characteristics that make users loose time, and even make errors
> with costly consequences.
>

We have a similar situation in Berlin.
On the 29.12.1879 Prussia introduced 40 Soldner Systems, which until then
were mainly used in Bavaria, Württemberg and Baden-Baden.
Most of these Systems were replaced by the 'Gauss-Krüger' System between
1900 and 1935.

Berlin however retained the 'Soldner 18' system since the city is on the
border between zone 4 and 5 (13 30').
Since the Central-Point was based at the 'Müggelberg', which is in the
South/East portion of 'Greater Berlin', as it was called after 1920- so
that 90% of this area have negative values for the East/West positions and
positive value for the North/South positions.

Since each (before 1920 cities) district was responsible for the creation
their maps, each decided for themselves how the negative values would be
shown.  Most showed only positive numbers that increased from East to West.
In 1885 the first high scale Maps of the then city of Berlin (1:4000
Straube) were introduced where a 'Soldner Rathausnetz' was used, bases on
'Soldner 18' with x = -14741.77 and y = 11288.28.
This point was the flag post on the City Hall, so that North/East of the
Town Hall had positive numbers and South/West had negative numbers.
The, then cities, surrounding Berlin stilled used 'Soldner 18' with Spandau
using 'Solder 19'.
Only in 1949 was 'Soldner 18' used in the whole City.

At some point a 'Fiktive Punkt' was decided upon.
This Imaginary point was 40.000 meters West and 10.000 Meters South of the
'Soldner 18' point.
(PARAMETER["false_easting",40000],PARAMETER["false_northing",10000],UNIT["Meter",1])
- this insured that all values were positive and different from the
formally use positions.
This System is called 'Soldner Berlin' (EPSG:3068).

But again each decided for themselves what would be used.
There is a 1988 Map of Berlin (West), showing territorial exchanges, where
the North/South positions are in 'Solder 18' and the West/ East are in
'Soldner Berlin'.

Starting last year, new data created is no longer created using 'Soldner
Berlin', but in the Brandenburg System(s) based on ETRS_1989_UTM_Zone_33N
of which there are 3 - the others being:
- ETRS89_UTM_Zone33_BB_6 - False_Easting = 500000 (same as
ETRS_1989_UTM_Zone_33N)
- ETRS89_UTM_Zone33_BB_7 - False_Easting = 3500000
- ETRS89_UTM_Zone33_BB_8 - False_Easting = 33500000

As to whether this will simplify matters, well I have my doubts....

Mark Johnson, Berlin Germany


>
> The projection is a transverse Mercator, with a central point in the centre
> of the country, no scale change, i.e. k_0=1, and no false easting/northing,
> so coordinates can be positive or negative. Some old coordinate systems in
> other countries also had the origin inside the country or region, but I
> think that now, most of them do not have this situation. So, my first
> question is if anyone knows of map coordinate systems in use, for
> topographic surveying and cadastre, which have negative coordinates.
>
> The second bad aspect of our new coordinate system is that, being the
> projection similar to the older ones, coordinates are also very similar.
> Differences are in general smaller than 6 meters, so when one looks at a
> coordinate pair it is not obvious if it is EPSG:3763 or older systems
> (datum 73, EPSG:27493 or datum Lisboa, EPSG:20791). For many years people
> will have to deal with data in the older systems, so making mistakes
> becomes very easy. The reasonable approach would have been to add a big
> shift so that coordinates are not mistaken, as I think most countries do.
> This leads to my second question: does anyone know of similar situations of
> very close coordinate systems?
> I know that in Belgium a projection was established for ETRS89 (Belge 2005,
> EPSG:3447) which had coordinates similar to an older system (EPSG:31300).
> Meanwhile a new system was defined with new false easting/northing (Belge
> 2008, EPSG:3812). Was the change motivated by users?
>
> Regards and a happy new year
>
> Jose? Gon?alves
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL:
> http://lists.maptools.org/pipermail/proj/attachments/20131231/56ca87a7/attachment.html
>
> ------------------------------
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
> End of Proj Digest, Vol 115, Issue 10
> *************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20140102/90c5ca31/attachment.html>

From richard.greenwood at gmail.com  Thu Jan  2 06:13:05 2014
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Thu, 2 Jan 2014 07:13:05 -0700
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <52C446AA.30700@swoodbridge.com>
References: <52C446AA.30700@swoodbridge.com>
Message-ID: <CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>

Are you sure that it's finding and using the correct epsg file? You could
specify the full path to an epsg file in either the mapfile or the apache
conf, or paste the proj parameters into the PROJ block in the mapfile and
do away wit the epsg file completely.

Rich


On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
<woodbri at swoodbridge.com>wrote:

> Hi All,
>
> I'm trying to run down a mapserver projection issue that is starting to
> look like it might be the version of proj4. Sorry for the cross posting.
>
> Situation:
>
> I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS and world
> maps on the Ubuntu system projected to Spherical Mercator are messed up
> and worked fine on Debian. I get the same issue using mapserver 6.2.1 or
> 5.6.8 and the big difference other than the OS and packages is that
> Ubuntu is using proj4-4.8.0 and the older Debian system is using
> proj4-4.6.0
>
> Is this a known issue? I can make the data mapfile available if that helps.
>
> System details below.
>
> Any help would be appreciated.
>
> Thanks,
>    -Steve
>
> Ubuntu system:
>
>
> http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>
> /u/www/cgi-bin/mapserv -v
> MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG SUPPORTS=PROJ
> SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
> SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER
> SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
> SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
> SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS INPUT=OGR
> INPUT=GDAL INPUT=SHAPEFILE
>
> libproj-dev/precise uptodate 4.8.0-3~precise2
> libproj0/precise uptodate 4.8.0-3~precise2
> proj-bin/precise uptodate 4.8.0-3~precise2
> proj-data/precise uptodate 4.8.0-3~precise2
>
> # Spherical Mercator projection
> <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
>
>
> cgi-mapserver/precise uptodate 6.2.1-2~precise3
> libmapserver/precise uptodate 6.2.1-2~precise3
> mapserver-bin/precise uptodate 6.2.1-2~precise3
>
> Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct 24 16:28:06
> UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
>
> I also get the same result from:
>
> /u/www/cgi-bin/mapserv-56 -v
> MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP
> OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=ICONV
> SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
> SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR INPUT=GDAL
> INPUT=SHAPEFILE
>
> which was built from source also using the libproj packages above.
>
> Debian Lenny system:
>
>
> http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>
> proj/lenny uptodate 4.6.0-2
>
> # Spherical Mercator - Google
> <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
>
>
> Linux gis.leaddog.com 2.6.32-042stab081.8 #1 SMP Wed Oct 23 16:32:28 MSK
> 2013 x86_64 GNU/Linux
>
> I built mapserver from source and I also get the same result from
> mapserver-5.6.8 built from source.
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Richard Greenwood
richard.greenwood at gmail.com
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20140102/918bd646/attachment.html>

From woodbri at swoodbridge.com  Thu Jan  2 06:43:29 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 02 Jan 2014 09:43:29 -0500
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>
References: <52C446AA.30700@swoodbridge.com>
	<CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>
Message-ID: <52C57B11.5050008@swoodbridge.com>

On 1/2/2014 9:13 AM, Richard Greenwood wrote:
> Are you sure that it's finding and using the correct epsg file? You
> could specify the full path to an epsg file in either the mapfile or the
> apache conf, or paste the proj parameters into the PROJ block in the
> mapfile and do away wit the epsg file completely.

It is a clean new system with only the Ubuntu package installed. I added 
900913 to the /usr/share/proj/epsg file. I also just modified the 
mapfile and entered the projection parameters in it directly as you 
suggested with the same result.

If you want to try this, download http://imaptools.com:8080/dl/world.tbz
It resides in directory /u/data/ on my system so you would need to 
adjust the paths appropriately.

I've now spent 3 days fussing with this and trying to debug it. I 
suppose the next thing to try is to build proj4-4.6.0 on the Ubuntu 
system and see if that resolves the issue.

Thanks,
   -Steve

Here is the mapfile:

MAP
   NAME "World_WMS"
   STATUS ON
   SIZE 800 800
   #EXTENT -180 -90 180 90
   EXTENT -20037508.34 -20037508.34  20037508.34  20037508.34
   UNITS DD
   SHAPEPATH "/u/data/world/"
   IMAGECOLOR "#80B1D3"
   FONTSET "/u/data/world/fontset.txt"
   IMAGETYPE "agg_qn"
   MAXSIZE 4000

   CONFIG MS_ERRORFILE "stderr"
   CONFIG ON_MISSING_DATA "IGNORE"
   #DEBUG 10

   OUTPUTFORMAT
     NAME "agg_qn"
     DRIVER "AGG/PNG"
     EXTENSION "png"
     MIMETYPE "image/png"
     IMAGEMODE RGB
     FORMATOPTION "INTERLACE=false"
     FORMATOPTION "QUANTIZE_NEW=ON"
     FORMATOPTION "QUANTIZE_FORCE=ON"
     FORMATOPTION "QUANTIZE_DITHER=OFF"
     FORMATOPTION "QUANTIZE_COLORS=256"
   END

   OUTPUTFORMAT
     NAME aggpng24
     DRIVER AGG/PNG
     MIMETYPE "image/png"
     IMAGEMODE RGB
     EXTENSION "png"
   END

   WEB
     METADATA
       "labelcache_map_edge_buffer" "-20"
       "ows_title" "World_WMS"
       "ows_onlineresource" 
"http://imaptools.com:8080/cgi-bin/mapserv?map=/u/data/world/world.map&"
       "ows_srs" "EPSG:4326 EPSG:900913 EPSG:4269 EPSG:3857"
       "ows_feature_info_mime_type" "text/html"
       "ows_enable_request" "GetMap"
       "ows_contactperson"     "Stephen Woodbridge"
       "ows_contactorganization" "iMaptools.com"
       "ows_contactposition"   "Owner"
       "ows_contactelectronicmailaddress" "info at imaptools.com"
       "ows_attribution_title"   "Data copyright by LeadDog Consulting."
     END
   END

#  PROJECTION "init=epsg:4326" END
   PROJECTION "+proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12 +lon_0=-102 
+x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs" END

   LAYER
     STATUS DEFAULT
     TYPE POLYGON
     PROJECTION "init=epsg:4326" END
     FEATURE
         POINTS -180 -90 -180 90 180 90 180 -90 -180 -90 END
     END
     CLASS
       STYLE
         COLOR "#80B1D3"
       END
     END
   END

   LAYER
     NAME "World"
     GROUP "cb"
     METADATA
       ows_title "World"
       ows_group_title "Land Mass"
     END
     STATUS ON
     PROJECTION "init=epsg:4326" END
     TYPE POLYGON
     DATA "world_dissolve"
     CLASS
       STYLE
         COLOR "#CACACA"
         OUTLINECOLOR "#888888"
       END
     END
   END

END


> Rich
>
>
> On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
> <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
>
>     Hi All,
>
>     I'm trying to run down a mapserver projection issue that is starting to
>     look like it might be the version of proj4. Sorry for the cross posting.
>
>     Situation:
>
>     I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS and world
>     maps on the Ubuntu system projected to Spherical Mercator are messed up
>     and worked fine on Debian. I get the same issue using mapserver 6.2.1 or
>     5.6.8 and the big difference other than the OS and packages is that
>     Ubuntu is using proj4-4.8.0 and the older Debian system is using
>     proj4-4.6.0
>
>     Is this a known issue? I can make the data mapfile available if that
>     helps.
>
>     System details below.
>
>     Any help would be appreciated.
>
>     Thanks,
>         -Steve
>
>     Ubuntu system:
>
>     http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>
>     /u/www/cgi-bin/mapserv -v
>     MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG SUPPORTS=PROJ
>     SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
>     SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER
>     SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
>     SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
>     SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS INPUT=OGR
>     INPUT=GDAL INPUT=SHAPEFILE
>
>     libproj-dev/precise uptodate 4.8.0-3~precise2
>     libproj0/precise uptodate 4.8.0-3~precise2
>     proj-bin/precise uptodate 4.8.0-3~precise2
>     proj-data/precise uptodate 4.8.0-3~precise2
>
>     # Spherical Mercator projection
>     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
>     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
>
>
>     cgi-mapserver/precise uptodate 6.2.1-2~precise3
>     libmapserver/precise uptodate 6.2.1-2~precise3
>     mapserver-bin/precise uptodate 6.2.1-2~precise3
>
>     Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct 24 16:28:06
>     UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
>
>     I also get the same result from:
>
>     /u/www/cgi-bin/mapserv-56 -v
>     MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP
>     OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=ICONV
>     SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
>     SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR INPUT=GDAL
>     INPUT=SHAPEFILE
>
>     which was built from source also using the libproj packages above.
>
>     Debian Lenny system:
>
>     http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>
>     proj/lenny uptodate 4.6.0-2
>
>     # Spherical Mercator - Google
>     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
>     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
>
>
>     Linux gis.leaddog.com <http://gis.leaddog.com> 2.6.32-042stab081.8
>     #1 SMP Wed Oct 23 16:32:28 MSK
>     2013 x86_64 GNU/Linux
>
>     I built mapserver from source and I also get the same result from
>     mapserver-5.6.8 built from source.
>
>     _______________________________________________
>     Proj mailing list
>     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     http://lists.maptools.org/mailman/listinfo/proj
>
>
>
>
> --
> Richard Greenwood
> richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> www.greenwoodmap.com <http://www.greenwoodmap.com>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



From richard.greenwood at gmail.com  Thu Jan  2 07:21:46 2014
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Thu, 2 Jan 2014 08:21:46 -0700
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <52C57B11.5050008@swoodbridge.com>
References: <52C446AA.30700@swoodbridge.com>
	<CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>
	<52C57B11.5050008@swoodbridge.com>
Message-ID: <CAHBySPZAvZgE8WgsiBZ=tLOs_aSdURCCw4PFK=i32z3c=28QPw@mail.gmail.com>

Steve,

Replying off list, for what it's worth I'm seeing the same issue with your
data on Ubutu 12.04, Proj 4.8, mapserv 6.2.1 built from source. I rarely
use web mercator in my work so I have limited experience with it and
limited data. I notice that ogrinfo on your world_disolve reports:
   Extent: (-180.000015, -90.000015) - (179.999985, 83.633385)
Have you tested with any other data?

Rich




On Thu, Jan 2, 2014 at 7:43 AM, Stephen Woodbridge
<woodbri at swoodbridge.com>wrote:

> On 1/2/2014 9:13 AM, Richard Greenwood wrote:
> > Are you sure that it's finding and using the correct epsg file? You
> > could specify the full path to an epsg file in either the mapfile or the
> > apache conf, or paste the proj parameters into the PROJ block in the
> > mapfile and do away wit the epsg file completely.
>
> It is a clean new system with only the Ubuntu package installed. I added
> 900913 to the /usr/share/proj/epsg file. I also just modified the
> mapfile and entered the projection parameters in it directly as you
> suggested with the same result.
>
> If you want to try this, download http://imaptools.com:8080/dl/world.tbz
> It resides in directory /u/data/ on my system so you would need to
> adjust the paths appropriately.
>
> I've now spent 3 days fussing with this and trying to debug it. I
> suppose the next thing to try is to build proj4-4.6.0 on the Ubuntu
> system and see if that resolves the issue.
>
> Thanks,
>    -Steve
>
> Here is the mapfile:
>
> MAP
>    NAME "World_WMS"
>    STATUS ON
>    SIZE 800 800
>    #EXTENT -180 -90 180 90
>    EXTENT -20037508.34 -20037508.34  20037508.34  20037508.34
>    UNITS DD
>    SHAPEPATH "/u/data/world/"
>    IMAGECOLOR "#80B1D3"
>    FONTSET "/u/data/world/fontset.txt"
>    IMAGETYPE "agg_qn"
>    MAXSIZE 4000
>
>    CONFIG MS_ERRORFILE "stderr"
>    CONFIG ON_MISSING_DATA "IGNORE"
>    #DEBUG 10
>
>    OUTPUTFORMAT
>      NAME "agg_qn"
>      DRIVER "AGG/PNG"
>      EXTENSION "png"
>      MIMETYPE "image/png"
>      IMAGEMODE RGB
>      FORMATOPTION "INTERLACE=false"
>      FORMATOPTION "QUANTIZE_NEW=ON"
>      FORMATOPTION "QUANTIZE_FORCE=ON"
>      FORMATOPTION "QUANTIZE_DITHER=OFF"
>      FORMATOPTION "QUANTIZE_COLORS=256"
>    END
>
>    OUTPUTFORMAT
>      NAME aggpng24
>      DRIVER AGG/PNG
>      MIMETYPE "image/png"
>      IMAGEMODE RGB
>      EXTENSION "png"
>    END
>
>    WEB
>      METADATA
>        "labelcache_map_edge_buffer" "-20"
>        "ows_title" "World_WMS"
>        "ows_onlineresource"
> "http://imaptools.com:8080/cgi-bin/mapserv?map=/u/data/world/world.map&"
>        "ows_srs" "EPSG:4326 EPSG:900913 EPSG:4269 EPSG:3857"
>        "ows_feature_info_mime_type" "text/html"
>        "ows_enable_request" "GetMap"
>        "ows_contactperson"     "Stephen Woodbridge"
>        "ows_contactorganization" "iMaptools.com"
>        "ows_contactposition"   "Owner"
>        "ows_contactelectronicmailaddress" "info at imaptools.com"
>        "ows_attribution_title"   "Data copyright by LeadDog Consulting."
>      END
>    END
>
> #  PROJECTION "init=epsg:4326" END
>    PROJECTION "+proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12 +lon_0=-102
> +x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs" END
>
>    LAYER
>      STATUS DEFAULT
>      TYPE POLYGON
>      PROJECTION "init=epsg:4326" END
>      FEATURE
>          POINTS -180 -90 -180 90 180 90 180 -90 -180 -90 END
>      END
>      CLASS
>        STYLE
>          COLOR "#80B1D3"
>        END
>      END
>    END
>
>    LAYER
>      NAME "World"
>      GROUP "cb"
>      METADATA
>        ows_title "World"
>        ows_group_title "Land Mass"
>      END
>      STATUS ON
>      PROJECTION "init=epsg:4326" END
>      TYPE POLYGON
>      DATA "world_dissolve"
>      CLASS
>        STYLE
>          COLOR "#CACACA"
>          OUTLINECOLOR "#888888"
>        END
>      END
>    END
>
> END
>
>
> > Rich
> >
> >
> > On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
> > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
> >
> >     Hi All,
> >
> >     I'm trying to run down a mapserver projection issue that is starting
> to
> >     look like it might be the version of proj4. Sorry for the cross
> posting.
> >
> >     Situation:
> >
> >     I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS and
> world
> >     maps on the Ubuntu system projected to Spherical Mercator are messed
> up
> >     and worked fine on Debian. I get the same issue using mapserver
> 6.2.1 or
> >     5.6.8 and the big difference other than the OS and packages is that
> >     Ubuntu is using proj4-4.8.0 and the older Debian system is using
> >     proj4-4.6.0
> >
> >     Is this a known issue? I can make the data mapfile available if that
> >     helps.
> >
> >     System details below.
> >
> >     Any help would be appreciated.
> >
> >     Thanks,
> >         -Steve
> >
> >     Ubuntu system:
> >
> >
> http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
> >
> >     /u/www/cgi-bin/mapserv -v
> >     MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
> SUPPORTS=PROJ
> >     SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
> >     SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI
> SUPPORTS=WMS_SERVER
> >     SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
> >     SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
> >     SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS INPUT=OGR
> >     INPUT=GDAL INPUT=SHAPEFILE
> >
> >     libproj-dev/precise uptodate 4.8.0-3~precise2
> >     libproj0/precise uptodate 4.8.0-3~precise2
> >     proj-bin/precise uptodate 4.8.0-3~precise2
> >     proj-data/precise uptodate 4.8.0-3~precise2
> >
> >     # Spherical Mercator projection
> >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
> >
> >
> >     cgi-mapserver/precise uptodate 6.2.1-2~precise3
> >     libmapserver/precise uptodate 6.2.1-2~precise3
> >     mapserver-bin/precise uptodate 6.2.1-2~precise3
> >
> >     Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct 24
> 16:28:06
> >     UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
> >
> >     I also get the same result from:
> >
> >     /u/www/cgi-bin/mapserv-56 -v
> >     MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG OUTPUT=WBMP
> >     OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE
> SUPPORTS=ICONV
> >     SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
> >     SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR INPUT=GDAL
> >     INPUT=SHAPEFILE
> >
> >     which was built from source also using the libproj packages above.
> >
> >     Debian Lenny system:
> >
> >
> http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
> >
> >     proj/lenny uptodate 4.6.0-2
> >
> >     # Spherical Mercator - Google
> >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null +no_defs  <>
> >
> >
> >     Linux gis.leaddog.com <http://gis.leaddog.com> 2.6.32-042stab081.8
> >     #1 SMP Wed Oct 23 16:32:28 MSK
> >     2013 x86_64 GNU/Linux
> >
> >     I built mapserver from source and I also get the same result from
> >     mapserver-5.6.8 built from source.
> >
> >     _______________________________________________
> >     Proj mailing list
> >     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
> >     http://lists.maptools.org/mailman/listinfo/proj
> >
> >
> >
> >
> > --
> > Richard Greenwood
> > richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> > www.greenwoodmap.com <http://www.greenwoodmap.com>
> >
> >
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> >
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Richard Greenwood
richard.greenwood at gmail.com
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20140102/fa22413e/attachment.html>

From woodbri at swoodbridge.com  Thu Jan  2 10:30:17 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 02 Jan 2014 13:30:17 -0500
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <CAHBySPZAvZgE8WgsiBZ=tLOs_aSdURCCw4PFK=i32z3c=28QPw@mail.gmail.com>
References: <52C446AA.30700@swoodbridge.com>	<CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>	<52C57B11.5050008@swoodbridge.com>
	<CAHBySPZAvZgE8WgsiBZ=tLOs_aSdURCCw4PFK=i32z3c=28QPw@mail.gmail.com>
Message-ID: <52C5B039.5070003@swoodbridge.com>

On 1/2/2014 10:21 AM, Richard Greenwood wrote:
> Steve,
>
> Replying off list, for what it's worth I'm seeing the same issue with
> your data on Ubutu 12.04, Proj 4.8, mapserv 6.2.1 built from source. I
> rarely use web mercator in my work so I have limited experience with it
> and limited data. I notice that ogrinfo on your world_disolve reports:
>     Extent: (-180.000015, -90.000015) - (179.999985, 83.633385)

Hmmm, these values might be a problem: -180.000015, -90.000015
I'll load that into postgis and see if I can fiddle with these and if 
that makes a difference.

Thank you for your time and effort.

> Have you tested with any other data?

I got similar results using the Natural Earth data.

Thanks,
   -Steve

>
> Rich
>
>
>
>
> On Thu, Jan 2, 2014 at 7:43 AM, Stephen Woodbridge
> <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
>
>     On 1/2/2014 9:13 AM, Richard Greenwood wrote:
>      > Are you sure that it's finding and using the correct epsg file? You
>      > could specify the full path to an epsg file in either the mapfile
>     or the
>      > apache conf, or paste the proj parameters into the PROJ block in the
>      > mapfile and do away wit the epsg file completely.
>
>     It is a clean new system with only the Ubuntu package installed. I added
>     900913 to the /usr/share/proj/epsg file. I also just modified the
>     mapfile and entered the projection parameters in it directly as you
>     suggested with the same result.
>
>     If you want to try this, download http://imaptools.com:8080/dl/world.tbz
>     It resides in directory /u/data/ on my system so you would need to
>     adjust the paths appropriately.
>
>     I've now spent 3 days fussing with this and trying to debug it. I
>     suppose the next thing to try is to build proj4-4.6.0 on the Ubuntu
>     system and see if that resolves the issue.
>
>     Thanks,
>         -Steve
>
>     Here is the mapfile:
>
>     MAP
>         NAME "World_WMS"
>         STATUS ON
>         SIZE 800 800
>         #EXTENT -180 -90 180 90
>         EXTENT -20037508.34 -20037508.34  20037508.34  20037508.34
>         UNITS DD
>         SHAPEPATH "/u/data/world/"
>         IMAGECOLOR "#80B1D3"
>         FONTSET "/u/data/world/fontset.txt"
>         IMAGETYPE "agg_qn"
>         MAXSIZE 4000
>
>         CONFIG MS_ERRORFILE "stderr"
>         CONFIG ON_MISSING_DATA "IGNORE"
>         #DEBUG 10
>
>         OUTPUTFORMAT
>           NAME "agg_qn"
>           DRIVER "AGG/PNG"
>           EXTENSION "png"
>           MIMETYPE "image/png"
>           IMAGEMODE RGB
>           FORMATOPTION "INTERLACE=false"
>           FORMATOPTION "QUANTIZE_NEW=ON"
>           FORMATOPTION "QUANTIZE_FORCE=ON"
>           FORMATOPTION "QUANTIZE_DITHER=OFF"
>           FORMATOPTION "QUANTIZE_COLORS=256"
>         END
>
>         OUTPUTFORMAT
>           NAME aggpng24
>           DRIVER AGG/PNG
>           MIMETYPE "image/png"
>           IMAGEMODE RGB
>           EXTENSION "png"
>         END
>
>         WEB
>           METADATA
>             "labelcache_map_edge_buffer" "-20"
>             "ows_title" "World_WMS"
>             "ows_onlineresource"
>     "http://imaptools.com:8080/cgi-bin/mapserv?map=/u/data/world/world.map&"
>             "ows_srs" "EPSG:4326 EPSG:900913 EPSG:4269 EPSG:3857"
>             "ows_feature_info_mime_type" "text/html"
>             "ows_enable_request" "GetMap"
>             "ows_contactperson"     "Stephen Woodbridge"
>             "ows_contactorganization" "iMaptools.com"
>             "ows_contactposition"   "Owner"
>             "ows_contactelectronicmailaddress" "info at imaptools.com
>     <mailto:info at imaptools.com>"
>             "ows_attribution_title"   "Data copyright by LeadDog
>     Consulting."
>           END
>         END
>
>     #  PROJECTION "init=epsg:4326" END
>         PROJECTION "+proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12 +lon_0=-102
>     +x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs" END
>
>         LAYER
>           STATUS DEFAULT
>           TYPE POLYGON
>           PROJECTION "init=epsg:4326" END
>           FEATURE
>               POINTS -180 -90 -180 90 180 90 180 -90 -180 -90 END
>           END
>           CLASS
>             STYLE
>               COLOR "#80B1D3"
>             END
>           END
>         END
>
>         LAYER
>           NAME "World"
>           GROUP "cb"
>           METADATA
>             ows_title "World"
>             ows_group_title "Land Mass"
>           END
>           STATUS ON
>           PROJECTION "init=epsg:4326" END
>           TYPE POLYGON
>           DATA "world_dissolve"
>           CLASS
>             STYLE
>               COLOR "#CACACA"
>               OUTLINECOLOR "#888888"
>             END
>           END
>         END
>
>     END
>
>
>      > Rich
>      >
>      >
>      > On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
>      > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>
>     <mailto:woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>>>
>     wrote:
>      >
>      >     Hi All,
>      >
>      >     I'm trying to run down a mapserver projection issue that is
>     starting to
>      >     look like it might be the version of proj4. Sorry for the
>     cross posting.
>      >
>      >     Situation:
>      >
>      >     I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS
>     and world
>      >     maps on the Ubuntu system projected to Spherical Mercator are
>     messed up
>      >     and worked fine on Debian. I get the same issue using
>     mapserver 6.2.1 or
>      >     5.6.8 and the big difference other than the OS and packages
>     is that
>      >     Ubuntu is using proj4-4.8.0 and the older Debian system is using
>      >     proj4-4.6.0
>      >
>      >     Is this a known issue? I can make the data mapfile available
>     if that
>      >     helps.
>      >
>      >     System details below.
>      >
>      >     Any help would be appreciated.
>      >
>      >     Thanks,
>      >         -Steve
>      >
>      >     Ubuntu system:
>      >
>      >
>     http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>      >
>      >     /u/www/cgi-bin/mapserv -v
>      >     MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
>     SUPPORTS=PROJ
>      >     SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
>      >     SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI
>     SUPPORTS=WMS_SERVER
>      >     SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
>      >     SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
>      >     SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS INPUT=OGR
>      >     INPUT=GDAL INPUT=SHAPEFILE
>      >
>      >     libproj-dev/precise uptodate 4.8.0-3~precise2
>      >     libproj0/precise uptodate 4.8.0-3~precise2
>      >     proj-bin/precise uptodate 4.8.0-3~precise2
>      >     proj-data/precise uptodate 4.8.0-3~precise2
>      >
>      >     # Spherical Mercator projection
>      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
>      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
>     +no_defs  <>
>      >
>      >
>      >     cgi-mapserver/precise uptodate 6.2.1-2~precise3
>      >     libmapserver/precise uptodate 6.2.1-2~precise3
>      >     mapserver-bin/precise uptodate 6.2.1-2~precise3
>      >
>      >     Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct
>     24 16:28:06
>      >     UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
>      >
>      >     I also get the same result from:
>      >
>      >     /u/www/cgi-bin/mapserv-56 -v
>      >     MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
>     OUTPUT=WBMP
>      >     OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE
>     SUPPORTS=ICONV
>      >     SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
>      >     SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR
>     INPUT=GDAL
>      >     INPUT=SHAPEFILE
>      >
>      >     which was built from source also using the libproj packages
>     above.
>      >
>      >     Debian Lenny system:
>      >
>      >
>     http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>      >
>      >     proj/lenny uptodate 4.6.0-2
>      >
>      >     # Spherical Mercator - Google
>      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
>      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
>     +no_defs  <>
>      >
>      >
>      >     Linux gis.leaddog.com <http://gis.leaddog.com>
>     <http://gis.leaddog.com> 2.6.32-042stab081.8
>      >     #1 SMP Wed Oct 23 16:32:28 MSK
>      >     2013 x86_64 GNU/Linux
>      >
>      >     I built mapserver from source and I also get the same result from
>      >     mapserver-5.6.8 built from source.
>      >
>      >     _______________________________________________
>      >     Proj mailing list
>      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     <mailto:Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>>
>      > http://lists.maptools.org/mailman/listinfo/proj
>      >
>      >
>      >
>      >
>      > --
>      > Richard Greenwood
>      > richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
>     <mailto:richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>>
>      > www.greenwoodmap.com <http://www.greenwoodmap.com>
>     <http://www.greenwoodmap.com>
>      >
>      >
>      > _______________________________________________
>      > Proj mailing list
>      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>      > http://lists.maptools.org/mailman/listinfo/proj
>      >
>
>     _______________________________________________
>     Proj mailing list
>     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     http://lists.maptools.org/mailman/listinfo/proj
>
>
>
>
> --
> Richard Greenwood
> richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> www.greenwoodmap.com <http://www.greenwoodmap.com>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



From richard.greenwood at gmail.com  Thu Jan  2 10:54:56 2014
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Thu, 2 Jan 2014 11:54:56 -0700
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <52C5B039.5070003@swoodbridge.com>
References: <52C446AA.30700@swoodbridge.com>
	<CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>
	<52C57B11.5050008@swoodbridge.com>
	<CAHBySPZAvZgE8WgsiBZ=tLOs_aSdURCCw4PFK=i32z3c=28QPw@mail.gmail.com>
	<52C5B039.5070003@swoodbridge.com>
Message-ID: <CAHBySPYDHUe0m_FV5FojnmzCOCcWxstR7seDuOrjvPUF9sbOkA@mail.gmail.com>

On Thu, Jan 2, 2014 at 11:30 AM, Stephen Woodbridge <woodbri at swoodbridge.com
> wrote:

> On 1/2/2014 10:21 AM, Richard Greenwood wrote:
> > Steve,
> >
> > Replying off list, for what it's worth I'm seeing the same issue with
> > your data on Ubutu 12.04, Proj 4.8, mapserv 6.2.1 built from source. I
> > rarely use web mercator in my work so I have limited experience with it
> > and limited data. I notice that ogrinfo on your world_disolve reports:
> >     Extent: (-180.000015, -90.000015) - (179.999985, 83.633385)
>
> Hmmm, these values might be a problem: -180.000015, -90.000015
> I'll load that into postgis and see if I can fiddle with these and if
> that makes a difference.
>
> Thank you for your time and effort.
>
> > Have you tested with any other data?
>
> I got similar results using the Natural Earth data.
>



Did you see my second reply (which actually was off list)? I think the
problem is in the data because with just the USA & Canada it rendered
correctly but adding Russia and Greenland caused the rendering issues to
reappear.

Keep us posted.

Rich



> On Thu, Jan 2, 2014 at 7:43 AM, Stephen Woodbridge

> > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
> >
> >     On 1/2/2014 9:13 AM, Richard Greenwood wrote:
> >      > Are you sure that it's finding and using the correct epsg file?
> You
> >      > could specify the full path to an epsg file in either the mapfile
> >     or the
> >      > apache conf, or paste the proj parameters into the PROJ block in
> the
> >      > mapfile and do away wit the epsg file completely.
> >
> >     It is a clean new system with only the Ubuntu package installed. I
> added
> >     900913 to the /usr/share/proj/epsg file. I also just modified the
> >     mapfile and entered the projection parameters in it directly as you
> >     suggested with the same result.
> >
> >     If you want to try this, download
> http://imaptools.com:8080/dl/world.tbz
> >     It resides in directory /u/data/ on my system so you would need to
> >     adjust the paths appropriately.
> >
> >     I've now spent 3 days fussing with this and trying to debug it. I
> >     suppose the next thing to try is to build proj4-4.6.0 on the Ubuntu
> >     system and see if that resolves the issue.
> >
> >     Thanks,
> >         -Steve
> >
> >     Here is the mapfile:
> >
> >     MAP
> >         NAME "World_WMS"
> >         STATUS ON
> >         SIZE 800 800
> >         #EXTENT -180 -90 180 90
> >         EXTENT -20037508.34 -20037508.34  20037508.34  20037508.34
> >         UNITS DD
> >         SHAPEPATH "/u/data/world/"
> >         IMAGECOLOR "#80B1D3"
> >         FONTSET "/u/data/world/fontset.txt"
> >         IMAGETYPE "agg_qn"
> >         MAXSIZE 4000
> >
> >         CONFIG MS_ERRORFILE "stderr"
> >         CONFIG ON_MISSING_DATA "IGNORE"
> >         #DEBUG 10
> >
> >         OUTPUTFORMAT
> >           NAME "agg_qn"
> >           DRIVER "AGG/PNG"
> >           EXTENSION "png"
> >           MIMETYPE "image/png"
> >           IMAGEMODE RGB
> >           FORMATOPTION "INTERLACE=false"
> >           FORMATOPTION "QUANTIZE_NEW=ON"
> >           FORMATOPTION "QUANTIZE_FORCE=ON"
> >           FORMATOPTION "QUANTIZE_DITHER=OFF"
> >           FORMATOPTION "QUANTIZE_COLORS=256"
> >         END
> >
> >         OUTPUTFORMAT
> >           NAME aggpng24
> >           DRIVER AGG/PNG
> >           MIMETYPE "image/png"
> >           IMAGEMODE RGB
> >           EXTENSION "png"
> >         END
> >
> >         WEB
> >           METADATA
> >             "labelcache_map_edge_buffer" "-20"
> >             "ows_title" "World_WMS"
> >             "ows_onlineresource"
> >     "
> http://imaptools.com:8080/cgi-bin/mapserv?map=/u/data/world/world.map&"
> >             "ows_srs" "EPSG:4326 EPSG:900913 EPSG:4269 EPSG:3857"
> >             "ows_feature_info_mime_type" "text/html"
> >             "ows_enable_request" "GetMap"
> >             "ows_contactperson"     "Stephen Woodbridge"
> >             "ows_contactorganization" "iMaptools.com"
> >             "ows_contactposition"   "Owner"
> >             "ows_contactelectronicmailaddress" "info at imaptools.com
> >     <mailto:info at imaptools.com>"
> >             "ows_attribution_title"   "Data copyright by LeadDog
> >     Consulting."
> >           END
> >         END
> >
> >     #  PROJECTION "init=epsg:4326" END
> >         PROJECTION "+proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12
> +lon_0=-102
> >     +x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs" END
> >
> >         LAYER
> >           STATUS DEFAULT
> >           TYPE POLYGON
> >           PROJECTION "init=epsg:4326" END
> >           FEATURE
> >               POINTS -180 -90 -180 90 180 90 180 -90 -180 -90 END
> >           END
> >           CLASS
> >             STYLE
> >               COLOR "#80B1D3"
> >             END
> >           END
> >         END
> >
> >         LAYER
> >           NAME "World"
> >           GROUP "cb"
> >           METADATA
> >             ows_title "World"
> >             ows_group_title "Land Mass"
> >           END
> >           STATUS ON
> >           PROJECTION "init=epsg:4326" END
> >           TYPE POLYGON
> >           DATA "world_dissolve"
> >           CLASS
> >             STYLE
> >               COLOR "#CACACA"
> >               OUTLINECOLOR "#888888"
> >             END
> >           END
> >         END
> >
> >     END
> >
> >
> >      > Rich
> >      >
> >      >
> >      > On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
> >      > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>
> >     <mailto:woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>>>
> >     wrote:
> >      >
> >      >     Hi All,
> >      >
> >      >     I'm trying to run down a mapserver projection issue that is
> >     starting to
> >      >     look like it might be the version of proj4. Sorry for the
> >     cross posting.
> >      >
> >      >     Situation:
> >      >
> >      >     I'm upgrading my server from Debian Lenny to Ubuntu 12.04 LTS
> >     and world
> >      >     maps on the Ubuntu system projected to Spherical Mercator are
> >     messed up
> >      >     and worked fine on Debian. I get the same issue using
> >     mapserver 6.2.1 or
> >      >     5.6.8 and the big difference other than the OS and packages
> >     is that
> >      >     Ubuntu is using proj4-4.8.0 and the older Debian system is
> using
> >      >     proj4-4.6.0
> >      >
> >      >     Is this a known issue? I can make the data mapfile available
> >     if that
> >      >     helps.
> >      >
> >      >     System details below.
> >      >
> >      >     Any help would be appreciated.
> >      >
> >      >     Thanks,
> >      >         -Steve
> >      >
> >      >     Ubuntu system:
> >      >
> >      >
> >
> http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
> >      >
> >      >     /u/www/cgi-bin/mapserv -v
> >      >     MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
> >     SUPPORTS=PROJ
> >      >     SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
> >      >     SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI
> >     SUPPORTS=WMS_SERVER
> >      >     SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER SUPPORTS=WFS_CLIENT
> >      >     SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
> >      >     SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG INPUT=POSTGIS
> INPUT=OGR
> >      >     INPUT=GDAL INPUT=SHAPEFILE
> >      >
> >      >     libproj-dev/precise uptodate 4.8.0-3~precise2
> >      >     libproj0/precise uptodate 4.8.0-3~precise2
> >      >     proj-bin/precise uptodate 4.8.0-3~precise2
> >      >     proj-data/precise uptodate 4.8.0-3~precise2
> >      >
> >      >     # Spherical Mercator projection
> >      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
> +lon_0=0.0
> >      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
> >     +no_defs  <>
> >      >
> >      >
> >      >     cgi-mapserver/precise uptodate 6.2.1-2~precise3
> >      >     libmapserver/precise uptodate 6.2.1-2~precise3
> >      >     mapserver-bin/precise uptodate 6.2.1-2~precise3
> >      >
> >      >     Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP Thu Oct
> >     24 16:28:06
> >      >     UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
> >      >
> >      >     I also get the same result from:
> >      >
> >      >     /u/www/cgi-bin/mapserv-56 -v
> >      >     MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
> >     OUTPUT=WBMP
> >      >     OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE
> >     SUPPORTS=ICONV
> >      >     SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
> >      >     SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR
> >     INPUT=GDAL
> >      >     INPUT=SHAPEFILE
> >      >
> >      >     which was built from source also using the libproj packages
> >     above.
> >      >
> >      >     Debian Lenny system:
> >      >
> >      >
> >
> http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
> >      >
> >      >     proj/lenny uptodate 4.6.0-2
> >      >
> >      >     # Spherical Mercator - Google
> >      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
> +lon_0=0.0
> >      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
> >     +no_defs  <>
> >      >
> >      >
> >      >     Linux gis.leaddog.com <http://gis.leaddog.com>
> >     <http://gis.leaddog.com> 2.6.32-042stab081.8
> >      >     #1 SMP Wed Oct 23 16:32:28 MSK
> >      >     2013 x86_64 GNU/Linux
> >      >
> >      >     I built mapserver from source and I also get the same result
> from
> >      >     mapserver-5.6.8 built from source.
> >      >
> >      >     _______________________________________________
> >      >     Proj mailing list
> >      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
> >     <mailto:Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>>
> >      > http://lists.maptools.org/mailman/listinfo/proj
> >      >
> >      >
> >      >
> >      >
> >      > --
> >      > Richard Greenwood
> >      > richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> >     <mailto:richard.greenwood at gmail.com
> >     <mailto:richard.greenwood at gmail.com>>
> >      > www.greenwoodmap.com <http://www.greenwoodmap.com>
> >     <http://www.greenwoodmap.com>
> >      >
> >      >
> >      > _______________________________________________
> >      > Proj mailing list
> >      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
> >      > http://lists.maptools.org/mailman/listinfo/proj
> >      >
> >
> >     _______________________________________________
> >     Proj mailing list
> >     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
> >     http://lists.maptools.org/mailman/listinfo/proj
> >
> >
> >
> >
> > --
> > Richard Greenwood
> > richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> > www.greenwoodmap.com <http://www.greenwoodmap.com>
> >
> >
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> >
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Richard Greenwood
richard.greenwood at gmail.com
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20140102/1bf99b2d/attachment.html>

From woodbri at swoodbridge.com  Thu Jan  2 13:28:04 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 02 Jan 2014 16:28:04 -0500
Subject: [Proj] Mapserver Projection Issue
In-Reply-To: <CAHBySPYDHUe0m_FV5FojnmzCOCcWxstR7seDuOrjvPUF9sbOkA@mail.gmail.com>
References: <52C446AA.30700@swoodbridge.com>	<CAHBySPY7Pv+pxkpmt=xCTRYeCMQocgtju+0x2nQYDCZAYGqk=Q@mail.gmail.com>	<52C57B11.5050008@swoodbridge.com>	<CAHBySPZAvZgE8WgsiBZ=tLOs_aSdURCCw4PFK=i32z3c=28QPw@mail.gmail.com>	<52C5B039.5070003@swoodbridge.com>
	<CAHBySPYDHUe0m_FV5FojnmzCOCcWxstR7seDuOrjvPUF9sbOkA@mail.gmail.com>
Message-ID: <52C5D9E4.6090204@swoodbridge.com>

Ok, I fix this by loading the shapefile into postgis and running this query:

  update world set geom=st_intersection(geom, 
st_transform(st_setsrid('POLYGON((-20037508.34 -20037508.34,-20037508.34 
20037508.34,20037508.34 20037508.34,20037508.34 
-20037508.34,-20037508.34 -20037508.34))'::geometry, 3857), 4326)) where 
gid in (220,222,235);

It turns out that these three polygons had extents that exceeded lat 
and/or long maximum extents for spherical Mercator:

world=# select gid, st_astext(geom) from ( select gid, 
st_astext(st_extent(geom)
  gid |
-----+--------------------------------------------------------------------------
  220 | POLYGON((-180.000014999871 -90.0000149996579,-180.000014999871 
-60.492514 ...
  222 | POLYGON((-180.000014999871 -21.0273150004093,-180.000014999871 
-12.457514 ...
  235 | POLYGON((-180.000014999871 41.1888849995916,-180.000014999871 
81.86168499 ...
(3 rows)

It is not clear why this worked on 4.6.0 and not on 4.8.0 !!!

http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550

Works after intersecting with the max bbox for spherical Mercator and 
dumping it back to a shapefile.

Thanks to Richard for his help debugging this.

-Steve

On 1/2/2014 1:54 PM, Richard Greenwood wrote:
>
> On Thu, Jan 2, 2014 at 11:30 AM, Stephen Woodbridge
> <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
>
>     On 1/2/2014 10:21 AM, Richard Greenwood wrote:
>      > Steve,
>      >
>      > Replying off list, for what it's worth I'm seeing the same issue with
>      > your data on Ubutu 12.04, Proj 4.8, mapserv 6.2.1 built from
>     source. I
>      > rarely use web mercator in my work so I have limited experience
>     with it
>      > and limited data. I notice that ogrinfo on your world_disolve
>     reports:
>      >     Extent: (-180.000015, -90.000015) - (179.999985, 83.633385)
>
>     Hmmm, these values might be a problem: -180.000015, -90.000015
>     I'll load that into postgis and see if I can fiddle with these and if
>     that makes a difference.
>
>     Thank you for your time and effort.
>
>      > Have you tested with any other data?
>
>     I got similar results using the Natural Earth data.
>
>
>
> Did you see my second reply (which actually was off list)? I think the
> problem is in the data because with just the USA & Canada it rendered
> correctly but adding Russia and Greenland caused the rendering issues to
> reappear.
>
> Keep us posted.
>
> Rich
>
>
>
>  > On Thu, Jan 2, 2014 at 7:43 AM, Stephen Woodbridge
>
>      > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>
>     <mailto:woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>>>
>     wrote:
>      >
>      >     On 1/2/2014 9:13 AM, Richard Greenwood wrote:
>      >      > Are you sure that it's finding and using the correct epsg
>     file? You
>      >      > could specify the full path to an epsg file in either the
>     mapfile
>      >     or the
>      >      > apache conf, or paste the proj parameters into the PROJ
>     block in the
>      >      > mapfile and do away wit the epsg file completely.
>      >
>      >     It is a clean new system with only the Ubuntu package
>     installed. I added
>      >     900913 to the /usr/share/proj/epsg file. I also just modified the
>      >     mapfile and entered the projection parameters in it directly
>     as you
>      >     suggested with the same result.
>      >
>      >     If you want to try this, download
>     http://imaptools.com:8080/dl/world.tbz
>      >     It resides in directory /u/data/ on my system so you would
>     need to
>      >     adjust the paths appropriately.
>      >
>      >     I've now spent 3 days fussing with this and trying to debug it. I
>      >     suppose the next thing to try is to build proj4-4.6.0 on the
>     Ubuntu
>      >     system and see if that resolves the issue.
>      >
>      >     Thanks,
>      >         -Steve
>      >
>      >     Here is the mapfile:
>      >
>      >     MAP
>      >         NAME "World_WMS"
>      >         STATUS ON
>      >         SIZE 800 800
>      >         #EXTENT -180 -90 180 90
>      >         EXTENT -20037508.34 -20037508.34  20037508.34  20037508.34
>      >         UNITS DD
>      >         SHAPEPATH "/u/data/world/"
>      >         IMAGECOLOR "#80B1D3"
>      >         FONTSET "/u/data/world/fontset.txt"
>      >         IMAGETYPE "agg_qn"
>      >         MAXSIZE 4000
>      >
>      >         CONFIG MS_ERRORFILE "stderr"
>      >         CONFIG ON_MISSING_DATA "IGNORE"
>      >         #DEBUG 10
>      >
>      >         OUTPUTFORMAT
>      >           NAME "agg_qn"
>      >           DRIVER "AGG/PNG"
>      >           EXTENSION "png"
>      >           MIMETYPE "image/png"
>      >           IMAGEMODE RGB
>      >           FORMATOPTION "INTERLACE=false"
>      >           FORMATOPTION "QUANTIZE_NEW=ON"
>      >           FORMATOPTION "QUANTIZE_FORCE=ON"
>      >           FORMATOPTION "QUANTIZE_DITHER=OFF"
>      >           FORMATOPTION "QUANTIZE_COLORS=256"
>      >         END
>      >
>      >         OUTPUTFORMAT
>      >           NAME aggpng24
>      >           DRIVER AGG/PNG
>      >           MIMETYPE "image/png"
>      >           IMAGEMODE RGB
>      >           EXTENSION "png"
>      >         END
>      >
>      >         WEB
>      >           METADATA
>      >             "labelcache_map_edge_buffer" "-20"
>      >             "ows_title" "World_WMS"
>      >             "ows_onlineresource"
>      >
>     "http://imaptools.com:8080/cgi-bin/mapserv?map=/u/data/world/world.map&"
>      >             "ows_srs" "EPSG:4326 EPSG:900913 EPSG:4269 EPSG:3857"
>      >             "ows_feature_info_mime_type" "text/html"
>      >             "ows_enable_request" "GetMap"
>      >             "ows_contactperson"     "Stephen Woodbridge"
>      >             "ows_contactorganization" "iMaptools.com"
>      >             "ows_contactposition"   "Owner"
>      >             "ows_contactelectronicmailaddress"
>     "info at imaptools.com <mailto:info at imaptools.com>
>      >     <mailto:info at imaptools.com <mailto:info at imaptools.com>>"
>      >             "ows_attribution_title"   "Data copyright by LeadDog
>      >     Consulting."
>      >           END
>      >         END
>      >
>      >     #  PROJECTION "init=epsg:4326" END
>      >         PROJECTION "+proj=lcc +lat_1=17.5 +lat_2=29.5 +lat_0=12
>     +lon_0=-102
>      >     +x_0=2500000 +y_0=0 +datum=WGS84 +units=m +no_defs" END
>      >
>      >         LAYER
>      >           STATUS DEFAULT
>      >           TYPE POLYGON
>      >           PROJECTION "init=epsg:4326" END
>      >           FEATURE
>      >               POINTS -180 -90 -180 90 180 90 180 -90 -180 -90 END
>      >           END
>      >           CLASS
>      >             STYLE
>      >               COLOR "#80B1D3"
>      >             END
>      >           END
>      >         END
>      >
>      >         LAYER
>      >           NAME "World"
>      >           GROUP "cb"
>      >           METADATA
>      >             ows_title "World"
>      >             ows_group_title "Land Mass"
>      >           END
>      >           STATUS ON
>      >           PROJECTION "init=epsg:4326" END
>      >           TYPE POLYGON
>      >           DATA "world_dissolve"
>      >           CLASS
>      >             STYLE
>      >               COLOR "#CACACA"
>      >               OUTLINECOLOR "#888888"
>      >             END
>      >           END
>      >         END
>      >
>      >     END
>      >
>      >
>      >      > Rich
>      >      >
>      >      >
>      >      > On Wed, Jan 1, 2014 at 9:47 AM, Stephen Woodbridge
>      >      > <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>
>     <mailto:woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>>
>      >     <mailto:woodbri at swoodbridge.com
>     <mailto:woodbri at swoodbridge.com> <mailto:woodbri at swoodbridge.com
>     <mailto:woodbri at swoodbridge.com>>>>
>      >     wrote:
>      >      >
>      >      >     Hi All,
>      >      >
>      >      >     I'm trying to run down a mapserver projection issue
>     that is
>      >     starting to
>      >      >     look like it might be the version of proj4. Sorry for the
>      >     cross posting.
>      >      >
>      >      >     Situation:
>      >      >
>      >      >     I'm upgrading my server from Debian Lenny to Ubuntu
>     12.04 LTS
>      >     and world
>      >      >     maps on the Ubuntu system projected to Spherical
>     Mercator are
>      >     messed up
>      >      >     and worked fine on Debian. I get the same issue using
>      >     mapserver 6.2.1 or
>      >      >     5.6.8 and the big difference other than the OS and
>     packages
>      >     is that
>      >      >     Ubuntu is using proj4-4.8.0 and the older Debian
>     system is using
>      >      >     proj4-4.6.0
>      >      >
>      >      >     Is this a known issue? I can make the data mapfile
>     available
>      >     if that
>      >      >     helps.
>      >      >
>      >      >     System details below.
>      >      >
>      >      >     Any help would be appreciated.
>      >      >
>      >      >     Thanks,
>      >      >         -Steve
>      >      >
>      >      >     Ubuntu system:
>      >      >
>      >      >
>      >
>     http://imaptools.com:8080/cgi-bin/mapserv?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>      >      >
>      >      >     /u/www/cgi-bin/mapserv -v
>      >      >     MapServer version 6.2.1 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
>      >     SUPPORTS=PROJ
>      >      >     SUPPORTS=GD SUPPORTS=AGG SUPPORTS=FREETYPE SUPPORTS=CAIRO
>      >      >     SUPPORTS=SVG_SYMBOLS SUPPORTS=ICONV SUPPORTS=FRIBIDI
>      >     SUPPORTS=WMS_SERVER
>      >      >     SUPPORTS=WMS_CLIENT SUPPORTS=WFS_SERVER
>     SUPPORTS=WFS_CLIENT
>      >      >     SUPPORTS=WCS_SERVER SUPPORTS=SOS_SERVER SUPPORTS=FASTCGI
>      >      >     SUPPORTS=THREADS SUPPORTS=GEOS INPUT=JPEG
>     INPUT=POSTGIS INPUT=OGR
>      >      >     INPUT=GDAL INPUT=SHAPEFILE
>      >      >
>      >      >     libproj-dev/precise uptodate 4.8.0-3~precise2
>      >      >     libproj0/precise uptodate 4.8.0-3~precise2
>      >      >     proj-bin/precise uptodate 4.8.0-3~precise2
>      >      >     proj-data/precise uptodate 4.8.0-3~precise2
>      >      >
>      >      >     # Spherical Mercator projection
>      >      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
>     +lon_0=0.0
>      >      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
>      >     +no_defs  <>
>      >      >
>      >      >
>      >      >     cgi-mapserver/precise uptodate 6.2.1-2~precise3
>      >      >     libmapserver/precise uptodate 6.2.1-2~precise3
>      >      >     mapserver-bin/precise uptodate 6.2.1-2~precise3
>      >      >
>      >      >     Linux mappy 3.8.0-33-generic #48~precise1-Ubuntu SMP
>     Thu Oct
>      >     24 16:28:06
>      >      >     UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
>      >      >
>      >      >     I also get the same result from:
>      >      >
>      >      >     /u/www/cgi-bin/mapserv-56 -v
>      >      >     MapServer version 5.6.8 OUTPUT=GIF OUTPUT=PNG OUTPUT=JPEG
>      >     OUTPUT=WBMP
>      >      >     OUTPUT=SVG SUPPORTS=PROJ SUPPORTS=AGG SUPPORTS=FREETYPE
>      >     SUPPORTS=ICONV
>      >      >     SUPPORTS=FRIBIDI SUPPORTS=WMS_SERVER SUPPORTS=WMS_CLIENT
>      >      >     SUPPORTS=WFS_SERVER INPUT=EPPL7 INPUT=POSTGIS INPUT=OGR
>      >     INPUT=GDAL
>      >      >     INPUT=SHAPEFILE
>      >      >
>      >      >     which was built from source also using the libproj
>     packages
>      >     above.
>      >      >
>      >      >     Debian Lenny system:
>      >      >
>      >      >
>      >
>     http://gis.imaptools.com/cgi-bin/mapserv-6.2?MAP=%2Fu%2Fdata%2Fworld%2Fworld.map&FORMAT=image%2Fpng&LAYERS=World_WMS&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&STYLES=&EXCEPTIONS=application%2Fvnd.ogc.se_inimage&SRS=EPSG%3A900913&BBOX=-27395030.9325,-21524667.16125,27395030.9325,21524667.16125&WIDTH=700&HEIGHT=550
>      >      >
>      >      >     proj/lenny uptodate 4.6.0-2
>      >      >
>      >      >     # Spherical Mercator - Google
>      >      >     <900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
>     +lon_0=0.0
>      >      >     +x_0=0.0 +y_0=0 +k=1.0 +units=m +over +nadgrids=@null
>      >     +no_defs  <>
>      >      >
>      >      >
>      >      >     Linux gis.leaddog.com <http://gis.leaddog.com>
>     <http://gis.leaddog.com>
>      >     <http://gis.leaddog.com> 2.6.32-042stab081.8
>      >      >     #1 SMP Wed Oct 23 16:32:28 MSK
>      >      >     2013 x86_64 GNU/Linux
>      >      >
>      >      >     I built mapserver from source and I also get the same
>     result from
>      >      >     mapserver-5.6.8 built from source.
>      >      >
>      >      >     _______________________________________________
>      >      >     Proj mailing list
>      >      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     <mailto:Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>>
>      >     <mailto:Proj at lists.maptools.org
>     <mailto:Proj at lists.maptools.org> <mailto:Proj at lists.maptools.org
>     <mailto:Proj at lists.maptools.org>>>
>      >      > http://lists.maptools.org/mailman/listinfo/proj
>      >      >
>      >      >
>      >      >
>      >      >
>      >      > --
>      >      > Richard Greenwood
>      >      > richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>
>     <mailto:richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>>
>      >     <mailto:richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>
>      >     <mailto:richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>>>
>      >      > www.greenwoodmap.com <http://www.greenwoodmap.com>
>     <http://www.greenwoodmap.com>
>      >     <http://www.greenwoodmap.com>
>      >      >
>      >      >
>      >      > _______________________________________________
>      >      > Proj mailing list
>      >      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     <mailto:Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>>
>      >      > http://lists.maptools.org/mailman/listinfo/proj
>      >      >
>      >
>      >     _______________________________________________
>      >     Proj mailing list
>      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     <mailto:Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>>
>      > http://lists.maptools.org/mailman/listinfo/proj
>      >
>      >
>      >
>      >
>      > --
>      > Richard Greenwood
>      > richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
>     <mailto:richard.greenwood at gmail.com
>     <mailto:richard.greenwood at gmail.com>>
>      > www.greenwoodmap.com <http://www.greenwoodmap.com>
>     <http://www.greenwoodmap.com>
>      >
>      >
>      > _______________________________________________
>      > Proj mailing list
>      > Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>      > http://lists.maptools.org/mailman/listinfo/proj
>      >
>
>     _______________________________________________
>     Proj mailing list
>     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     http://lists.maptools.org/mailman/listinfo/proj
>
>
>
>
> --
> Richard Greenwood
> richard.greenwood at gmail.com <mailto:richard.greenwood at gmail.com>
> www.greenwoodmap.com <http://www.greenwoodmap.com>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



From kyle at pobox.com  Thu Jan  2 19:00:23 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Thu, 2 Jan 2014 20:00:23 -0700
Subject: [Proj] Parsing Lambert Conformal Conic in GDAL
Message-ID: <CAJ0mEz1=Ob5f_aaDYfAO_QnKGrFMOd2EwysMh89+zb3UwGss9A@mail.gmail.com>

Hi,

I've come across a proj.4 projection (lcc) that may not be parsed
correctly by GDAL/OGR.  If I roundtrip EPSG:3979 through gdalsrsinfo,
I lose a standard parallel (forgive the clutter):

kyle at kyle-hp-laptop:gdal$ gdalsrsinfo -o proj4 EPSG:3979
'+proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs '

kyle at kyle-hp-laptop:gdal$ gdalsrsinfo -o wkt '+proj=lcc +lat_1=49
+lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0 +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs '
PROJCS["unnamed",GEOGCS["GRS 1980(IUGG,
1980)",DATUM["unknown",SPHEROID["GRS80",6378137,298.257222101],TOWGS84[0,0,0,0,0,0,0]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic_1SP"],PARAMETER["latitude_of_origin",49],PARAMETER["central_meridian",-95],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]]

So, is:

+proj=lcc +lat_1=49 +lat_2=77 +lat_0=49 +lon_0=-95 +x_0=0 +y_0=0
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs

a completely valid proj.4 string?  Is it okay to set a lat_1=lat_0,
and also specify lat_2.  I suspect it is, but I haven't found any
concrete definition on limits (and I don't really think there are,
within reason).

Thought I'd consult the pros on the list to be sure.

There is a ticket on gdal trac at: http://trac.osgeo.org/gdal/ticket/5191

Thanks.

-- 
Kyle


From andre+joost at nurfuerspam.de  Fri Jan  3 07:49:39 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 03 Jan 2014 16:49:39 +0100
Subject: [Proj] Parsing Lambert Conformal Conic in GDAL
In-Reply-To: <CAJ0mEz1=Ob5f_aaDYfAO_QnKGrFMOd2EwysMh89+zb3UwGss9A@mail.gmail.com>
References: <CAJ0mEz1=Ob5f_aaDYfAO_QnKGrFMOd2EwysMh89+zb3UwGss9A@mail.gmail.com>
Message-ID: <la6mj0$4g2$1@ger.gmane.org>

Am 03.01.2014 04:00, schrieb Kyle Shannon:
> Is it okay to set a lat_1=lat_0,
> and also specify lat_2.  I suspect it is, but I haven't found any
> concrete definition on limits (and I don't really think there are,
> within reason).
>
> Thought I'd consult the pros on the list to be sure.
>

In the formulas given by Snyder, a single parallel LCC projection is 
defined by lat_1=lat_2, but he makes no special treatment for lat_0 (the 
latitude of origin) is equivalent to lat_1 or lat_2 or not.

Reading older proj trac tickets, I gathered that lat_0=lat_1 is 
misinterpreted in proj4 as lcc single parallel projection. This does not 
coincide with the WKT projection strings supplied by ESRI and others.

Greetings,
André Joost



From kyle at pobox.com  Fri Jan  3 08:54:16 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 3 Jan 2014 09:54:16 -0700
Subject: [Proj] Parsing Lambert Conformal Conic in GDAL
In-Reply-To: <la6mj0$4g2$1@ger.gmane.org>
References: <CAJ0mEz1=Ob5f_aaDYfAO_QnKGrFMOd2EwysMh89+zb3UwGss9A@mail.gmail.com>
	<la6mj0$4g2$1@ger.gmane.org>
Message-ID: <CAJ0mEz1NBBs1r3_-cDACwFSx2xXFYHwa8pPPQ+q2F5udysScdQ@mail.gmail.com>

Andre,

On Fri, Jan 3, 2014 at 8:49 AM, Andre Joost <andre+joost at nurfuerspam.de> wrote:
> Am 03.01.2014 04:00, schrieb Kyle Shannon:
>> Is it okay to set a lat_1=lat_0,
>> and also specify lat_2.  I suspect it is, but I haven't found any
>> concrete definition on limits (and I don't really think there are,
>> within reason).
>>
>> Thought I'd consult the pros on the list to be sure.
>>
>
> In the formulas given by Snyder, a single parallel LCC projection is
> defined by lat_1=lat_2, but he makes no special treatment for lat_0 (the
> latitude of origin) is equivalent to lat_1 or lat_2 or not.
>

Right, I feel that lat_0 shouldn't really be considered in this logic.

> Reading older proj trac tickets, I gathered that lat_0=lat_1 is
> misinterpreted in proj4 as lcc single parallel projection. This does not
> coincide with the WKT projection strings supplied by ESRI and others.

Correct.  It may be a LCC 1SP, but it doesn't *have* to be.  It
depends on the presence of lat_2.

>
> Greetings,
> André Joost
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

My interpretation is that lat_1 must always be specified.  Whether or
not it is equal to lat_0 seems irrelevant.  If lat_1 == lat_2, then it
is a LCC 1SP.

BTW, are you referring to 'Map Projections: A Working Manual' or
another Snyder publication.

kss

-- 
Kyle


From andre+joost at nurfuerspam.de  Fri Jan  3 09:59:52 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 03 Jan 2014 18:59:52 +0100
Subject: [Proj] Parsing Lambert Conformal Conic in GDAL
In-Reply-To: <CAJ0mEz1NBBs1r3_-cDACwFSx2xXFYHwa8pPPQ+q2F5udysScdQ@mail.gmail.com>
References: <CAJ0mEz1=Ob5f_aaDYfAO_QnKGrFMOd2EwysMh89+zb3UwGss9A@mail.gmail.com>
	<la6mj0$4g2$1@ger.gmane.org>
	<CAJ0mEz1NBBs1r3_-cDACwFSx2xXFYHwa8pPPQ+q2F5udysScdQ@mail.gmail.com>
Message-ID: <la6ttd$tlh$1@ger.gmane.org>

Am 03.01.2014 17:54, schrieb Kyle Shannon:

>
> BTW, are you referring to 'Map Projections: A Working Manual' or
> another Snyder publication.


Yes, that should be the bible for projections ;-)

Greetings,
André Joost



From mat.and.wawa at gmail.com  Tue Jan  7 10:23:17 2014
From: mat.and.wawa at gmail.com (Mateusz Andrzej)
Date: Tue, 7 Jan 2014 19:23:17 +0100
Subject: [Proj] EASE Grid Projection
Message-ID: <CAKgqAq8L+vERoEU9V9ZdYvxgi_faUzy5OxSxJiVWfF7oKx-A9g@mail.gmail.com>

Hello,

could you tell me if there's any plans to support EASE-Grid (
http://nsidc.org/data/ease/) projection by PROJ project, please?

Best regards,
Mat
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20140107/1c4e7aba/attachment.html>

From tharan at nsidc.org  Tue Jan  7 10:57:15 2014
From: tharan at nsidc.org (Terry Haran)
Date: Tue, 07 Jan 2014 11:57:15 -0700
Subject: [Proj] EASE Grid Projection
In-Reply-To: <CAKgqAq8L+vERoEU9V9ZdYvxgi_faUzy5OxSxJiVWfF7oKx-A9g@mail.gmail.com>
References: <CAKgqAq8L+vERoEU9V9ZdYvxgi_faUzy5OxSxJiVWfF7oKx-A9g@mail.gmail.com>
Message-ID: <52CC4E0B.5010703@nsidc.org>

Hi Mateusz:

PROJ.4 does support EASE-Grid:

EASE-Grid North  - EPSG 3408 http://nsidc.org/data/atlas/epsg_3408.html
EASE-Grid South  - EPSG 3409 http://nsidc.org/data/atlas/epsg_3409.html
EASE-Grid Global - EPSG 3410 http://nsidc.org/data/atlas/epsg_3410.html

PROJ.4 also supports EASE-Grid 2.0 (see http://www.mdpi.com/2220-9964/1/1/32):

EASE-Grid 2.0 North  - EPSG 3973 http://nsidc.org/data/atlas/epsg_3973.html
EASE-Grid 2.0 South  - EPSG 3974 http://nsidc.org/data/atlas/epsg_3974.html
EASE-Grid 2.0 Global - EPSG 3975 http://nsidc.org/data/atlas/epsg_3975.html
Note that PROJ 4.8.0 or higher is required for EASE-Grid 2.0 Global due to a bug 
in earlier versions of PROJ.

Please contact NSIDC User Services at nsidc at nsidc.org if you have any additional 
questions regarding EASE_Grid or EASE-Grid 2.0.

Thanks,
--Terry


--

On 01/07/2014 11:23 AM, Mateusz Andrzej wrote:
> Hello,
>
> could you tell me if there's any plans to support EASE-Grid
> (http://nsidc.org/data/ease/) projection by PROJ project, please?
>
> Best regards,
> Mat
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


-- 
Terence (Terry) Haran          National Snow & Ice Data Center
tharan at nsidc.org               University of Colorado
voice: 303-492-1847            449 UCB
fax:   303-492-2468            Boulder, CO 80309-0449


From jmfluis at gmail.com  Thu Jan  9 16:28:17 2014
From: jmfluis at gmail.com (J. Luis)
Date: Fri, 10 Jan 2014 00:28:17 +0000
Subject: [Proj] puzzled with +towgs84=... being ignored
Message-ID: <52CF3EA1.3070707@gmail.com>

Hi,

I'm very lost with this results where setting the +towgs84 is ignored 
unless I set "+datum=WGS84"
Why so? and why is the source "+ellps=WGS84" ignored as well?

cs2cs +proj=latlong +to +proj=sterea +lat_0=52.15616055555555 
+lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 
+ellps=bessel 
+towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812 
+units=m +no_defs
4.5 62
108156.39       1561986.31 0.00

cs2cs +proj=latlong +to +proj=sterea +lat_0=52.15616055555555 
+lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 
+ellps=bessel +units=m +no_defs
4.5 62
108156.39       1561986.31 0.00

********** Now explicitly set the source ellipsoid (but nothing changes) 
**********
cs2cs +proj=latlong +ellps=WGS84 +to +proj=sterea 
+lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 
+x_0=155000 +y_0=463000 +ellps=bessel 
+towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812 
+units=m +no_defs
4.5 62
108156.39       1561986.31 0.00

That is in ALL above cases the 'towgs84' seams to have been ignored. 
However, if I use "+datum=WGS84" than the result changes

cs2cs +proj=latlong +datum=WGS84 +to +proj=sterea 
+lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 
+x_0=155000 +y_0=463000 +ellps=bessel 
+towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812 
+units=m +no_defs
4.5 62
108163.14       1562220.06 -39.17

Joaquim


From andre+joost at nurfuerspam.de  Thu Jan  9 20:55:05 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 10 Jan 2014 05:55:05 +0100
Subject: [Proj] puzzled with +towgs84=... being ignored
In-Reply-To: <52CF3EA1.3070707@gmail.com>
References: <52CF3EA1.3070707@gmail.com>
Message-ID: <lanugg$g18$1@ger.gmane.org>

Am 10.01.2014 01:28, schrieb J. Luis:
>
> I'm very lost with this results where setting the +towgs84 is ignored
> unless I set "+datum=WGS84"
> Why so? and why is the source "+ellps=WGS84" ignored as well?
>

This is the usual behaviour: +towgs84 is only used when a datum shift is 
defined on both sides (from and to), either by specifying

+datum=...
+nadgrids=...
+towgs84=...

HTH,
Andre Joost




From just at justobjects.nl  Fri Jan 10 02:54:11 2014
From: just at justobjects.nl (Just van den Broecke)
Date: Fri, 10 Jan 2014 11:54:11 +0100
Subject: [Proj] puzzled with +towgs84=... being ignored
In-Reply-To: <lanugg$g18$1@ger.gmane.org>
References: <52CF3EA1.3070707@gmail.com> <lanugg$g18$1@ger.gmane.org>
Message-ID: <52CFD153.8040703@justobjects.nl>

Hi,

I agree with Andre. One remark. Looking at the parameters, I presume you 
try to transform to Dutch, EPSG:28992. Your +towgs84 parms seem have an 
"unusual" value, maybe outdated, or perhaps on purpose. The others are ok.

Your value:
+towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812 


Proj 4.8.0 value:
+towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 (see 
<28992> entry in http://trac.osgeo.org/proj/browser/trunk/proj/nad/epsg)

I've seen slight differences in, and even omission of, +towgs84 for 
EPSG:28992 here and there, as there has been some confusion over the 
years, but the Proj 4.8.0  value is now settled on (e.g. found in 
PostGIS 2.x as well).

best,

Just van den Broecke
The Netherlands

On 10-01-14 05:55, Andre Joost wrote:
> Am 10.01.2014 01:28, schrieb J. Luis:
>>
>> I'm very lost with this results where setting the +towgs84 is ignored
>> unless I set "+datum=WGS84"
>> Why so? and why is the source "+ellps=WGS84" ignored as well?
>>
>
> This is the usual behaviour: +towgs84 is only used when a datum shift is
> defined on both sides (from and to), either by specifying
>
> +datum=...
> +nadgrids=...
> +towgs84=...
>
> HTH,
> Andre Joost
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>







From jmfluis at gmail.com  Fri Jan 10 03:58:21 2014
From: jmfluis at gmail.com (J. Luis)
Date: Fri, 10 Jan 2014 11:58:21 +0000
Subject: [Proj] puzzled with +towgs84=... being ignored
In-Reply-To: <52CFD153.8040703@justobjects.nl>
References: <52CF3EA1.3070707@gmail.com> <lanugg$g18$1@ger.gmane.org>
	<52CFD153.8040703@justobjects.nl>
Message-ID: <52CFE05D.6000403@gmail.com>

OK, thanks though before this I would be ready to swear that I had used 
in past only by specifying the +towgs84 in one side only (and get the 
correct conversion)

Regarding Just's remark on the on the +towgs84 parameters, well I was 
trying to help someone who sent them to me but I'm cc-ing him this mail 
so he can correct. Thanks

Joaquim

> Hi,
>
> I agree with Andre. One remark. Looking at the parameters, I presume you
> try to transform to Dutch, EPSG:28992. Your +towgs84 parms seem have an
> "unusual" value, maybe outdated, or perhaps on purpose. The others are ok.
>
> Your value:
> +towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812
>
>
> Proj 4.8.0 value:
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 (see
> <28992>  entry in http://trac.osgeo.org/proj/browser/trunk/proj/nad/epsg)
>
> I've seen slight differences in, and even omission of, +towgs84 for
> EPSG:28992 here and there, as there has been some confusion over the
> years, but the Proj 4.8.0  value is now settled on (e.g. found in
> PostGIS 2.x as well).
>
> best,
>
> Just van den Broecke
> The Netherlands
>
> On 10-01-14 05:55, Andre Joost wrote:
>> Am 10.01.2014 01:28, schrieb J. Luis:
>>> I'm very lost with this results where setting the +towgs84 is ignored
>>> unless I set "+datum=WGS84"
>>> Why so? and why is the source "+ellps=WGS84" ignored as well?
>>>
>> This is the usual behaviour: +towgs84 is only used when a datum shift is
>> defined on both sides (from and to), either by specifying
>>
>> +datum=...
>> +nadgrids=...
>> +towgs84=...
>>
>> HTH,
>> Andre Joost
>>
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From andre+joost at nurfuerspam.de  Fri Jan 10 07:13:39 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 10 Jan 2014 16:13:39 +0100
Subject: [Proj] puzzled with +towgs84=... being ignored
In-Reply-To: <52CFD153.8040703@justobjects.nl>
References: <52CF3EA1.3070707@gmail.com> <lanugg$g18$1@ger.gmane.org>
	<52CFD153.8040703@justobjects.nl>
Message-ID: <lap2r7$7ju$1@ger.gmane.org>

Am 10.01.2014 11:54, schrieb Just van den Broecke:
> Hi,
>
> I agree with Andre. One remark. Looking at the parameters, I presume you
> try to transform to Dutch, EPSG:28992. Your +towgs84 parms seem have an
> "unusual" value, maybe outdated, or perhaps on purpose. The others are ok.
>
> Your value:
> +towgs84=593.0297,26.0038,478.7534,0.40685733032239757,-0.3507326765425626,1.8703473836067959,4.0812
>
>
> Proj 4.8.0 value:
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 (see
> <28992>  entry in http://trac.osgeo.org/proj/browser/trunk/proj/nad/epsg)
>

The 565.417,... is the correct one. The other parameter set is for 
rotation around Amersfoort instead of the ellipsoid center as used by Proj.

See http://trac.osgeo.org/geotiff/ticket/22 and the attached excel sheet 
supplied by Jan Hartmann evaluating the different parameter sets.

Greetings,
André Joost




From peifer at gmx.eu  Fri Jan 10 11:14:09 2014
From: peifer at gmx.eu (Hermann Peifer)
Date: Fri, 10 Jan 2014 20:14:09 +0100
Subject: [Proj] puzzled with +towgs84=... being ignored
In-Reply-To: <52CFE05D.6000403@gmail.com>
References: <52CF3EA1.3070707@gmail.com>
	<lanugg$g18$1@ger.gmane.org>	<52CFD153.8040703@justobjects.nl>
	<52CFE05D.6000403@gmail.com>
Message-ID: <52D04681.3000908@gmx.eu>

On 2014-01-10 12:58, J. Luis wrote:
> OK, thanks though before this I would be ready to swear that I had used
> in past only by specifying the +towgs84 in one side only (and get the
> correct conversion)
>

The default datum application behavior changed with the 4.6.0 release.., 
  see the FAQ at 
http://trac.osgeo.org/proj/wiki/FAQ#WhydoIgetdifferentresultswith4.5.0and4.6.0

Hermann




From Alain.Orsoni at ign.fr  Mon Jan 27 01:47:48 2014
From: Alain.Orsoni at ign.fr (Alain Orsoni)
Date: Mon, 27 Jan 2014 09:47:48 +0000
Subject: [Proj] Google maps <3857> datum
Message-ID: <E6C39577-9D4D-4FF0-8C26-9576FE77646C@ign.fr>

Hi,

I have to implement the 3857 projection in a software.
My problem is the following : it seems that when a point on earth having long1 and lat1 coordinates in WGS84 datum is projection in this direct mercator projection based on a spheric ellipsoid (I could say directly a sphere), this point is considered by proj4 to have the same lon1 and lat1 coordinates on the sphere. After the transform to Mercator occurs.
I noticed this because when I transform from WGS84 datum to Google sphere (the +a=6378137 +b=6378137 sphere given in 3857 description) I get lon2 and lat2 coordinates for our point where lon2=lon1 and lat2 not equal lat1 (except for lat=0 or 90). This is normal but doesn't seem to be the process applied by proj4.

When I consider lon1 and lat1 being the coordinates of the point on the sphere (saying that I don"t transform from WGS84 to the sphere), I get the same Marcator coordinates than the ones I get through proj4 transform from WGS84 to 3857.

Could someone confirm or document this particular application of the transform done for 3857 datum.

Hopping my problem is clearly expressed, and waiting to ear from you.

Alain ORSONI
Institut Géographique National, FRANCE



From ndzinn at comcast.net  Mon Jan 27 05:20:59 2014
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Mon, 27 Jan 2014 07:20:59 -0600
Subject: [Proj] Google maps <3857> datum
In-Reply-To: <E6C39577-9D4D-4FF0-8C26-9576FE77646C@ign.fr>
References: <E6C39577-9D4D-4FF0-8C26-9576FE77646C@ign.fr>
Message-ID: <EFB4EDAAEC2F48B8B51A36D1108B25CB@NoelDellPC>

There is no ellipsoid-to-sphere transformation involved in the EPSG 3857 
(Web Mercator) map projection.  EPSG 3857 is a conversion from WGS84 
ellipsoidal (lat/lon) to grid Easting/Northing using spherical Mercator 
equations, but there is no intervening sphere.  It's just another map 
projection (though it has its own distortions that are not the same as 
either the ellipsoidal Mercator or the Spherical Mercator).  It is 
completely reversible LL <=> EN.

More about the distortions at:
http://www.hydrometronics.com/downloads/Web%20Mercator%20-%20Non-Conformal,%20Non-Mercator%20(notes).pdf

Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)

-----Original Message----- 
From: Alain Orsoni
Sent: Monday, January 27, 2014 3:47 AM
To: proj at lists.maptools.org
Subject: [Proj] Google maps  datum

Hi,

I have to implement the 3857 projection in a software.
My problem is the following : it seems that when a point on earth having 
long1 and lat1 coordinates in WGS84 datum is projection in this direct 
mercator projection based on a spheric ellipsoid (I could say directly a 
sphere), this point is considered by proj4 to have the same lon1 and lat1 
coordinates on the sphere. After the transform to Mercator occurs.
I noticed this because when I transform from WGS84 datum to Google sphere 
(the +a=6378137 +b=6378137 sphere given in 3857 description) I get lon2 and 
lat2 coordinates for our point where lon2=lon1 and lat2 not equal lat1 
(except for lat=0 or 90). This is normal but doesn't seem to be the process 
applied by proj4.

When I consider lon1 and lat1 being the coordinates of the point on the 
sphere (saying that I don"t transform from WGS84 to the sphere), I get the 
same Marcator coordinates than the ones I get through proj4 transform from 
WGS84 to 3857.

Could someone confirm or document this particular application of the 
transform done for 3857 datum.

Hopping my problem is clearly expressed, and waiting to ear from you.

Alain ORSONI
Institut Géographique National, FRANCE

_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj 



