From kreve at sdfe.dk  Thu Feb  1 07:53:47 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Thu, 1 Feb 2018 15:53:47 +0000
Subject: [Proj] Let's get this thing rolling
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEBFD09B@S000014.PROD.SITAD.DK>

All,

This morning the final bit of code needed for the 5.0.0 release was merged [0]. So, finally, it is time to issue the first release candidate of PROJ version 5.0.0.

Howard,

In [1] I have done the steps 1 to 7 (apart from 4.5) in the updated HOWTO-RELEASE. I haven't got the right permissions to carry out the last bit of the release process. So would you please take over from here with the release process?

Cheers,
Kristian



[0] https://github.com/OSGeo/proj.4/pull/731
[1] https://github.com/OSGeo/proj.4/pull/736
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180201/e219a6f6/attachment.html>

From kreve at sdfe.dk  Fri Feb  2 07:02:26 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Fri, 2 Feb 2018 15:02:26 +0000
Subject: [Proj] PROJ 5.0.0RC1 Released
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEBFFAFD@S000014.PROD.SITAD.DK>

All,

I have prepared the first release candidate of PROJ 5.0.0. See the release notes below. Since this release brings many substantial changes I expect that we will be going through a number of RCs before the final release is ready. We are aiming for a March 1st final release.

Please test the release candidate where ever you depend on it and report back your findings.

Download it here:

http://download.osgeo.org/proj/proj-5.0.0RC1.tar.gz  (http://download.osgeo.org/proj/proj-5.0.0RC1.tar.gz.md5)
http://download.osgeo.org/proj/proj-5.0.0RC1.zip       (http://download.osgeo.org/proj/proj-5.0.0RC1.zip.md5)


/Kristian


5.0.0 Release Notes
-------------------

This version of PROJ introduces some significant extensions and
improvements to (primarily) the geodetic functionality of the system.

The main driver for introducing the new features is the emergence of
dynamic reference frames, the increasing use of high accuracy GNNS,
and the related growing demand for accurate coordinate
transformations.  While older versions of PROJ included some geodetic
functionality, the new framework lays the foundation for turning PROJ
into a generic geospatial coordinate transformation engine.

The core of the library is still the well established projection code.
The new functionality is primarily exposed in a new programming
interface and a new command line utility, "cct" (for "Coordinate
Conversion and Transformation").  The old programming interface is
still available and can - to some extent - use the new geodetic
transformation features.

The internal architecture has also seen many changes and much
improvement.  So far, these improvements respect the existing
programming interface. But the process has revealed a need to simplify
and reduce the code base, in order to support sustained active
development.

!!!
!!! Therefore we have scheduled regular releases over the coming years
!!! which will gradually remove the old programming interface.
!!!
!!! This will cause breaking changes with the next two major version
!!! releases, which will affect all projects that depend on PROJ
!!! (cf. section "deprecations" below).
!!!

The decision to break the existing API has not been easy, but has
ultimately been deemed necessary to ensure the long term survival of
the project. Not only by improving the maintainability immensely, but
also by extending the potential user (and hence developer) community.

The end goal is to deliver a generic coordinate transformation
software package with a clean and concise code base appealing to
both users and developers.


VERSIONING AND NAMING
---------------------

For the first time in more than 25 years the major version number of
the software is changed. The decision to do this is based on the many
new features and new API. While backwards compatibility remains -
except in a few rare corner cases - the addition of a new and improved
programming interface warrants a new major release.

The new major version number unfortunately leaves the project in a bit
of a conundrum regarding the name. For the majority of the life-time
of the product it has been known as PROJ.4, but since we have now
reached version 5 the name is no longer aligned with the version
number.

Hence we have decided to decouple the name from the version number and
from this version and onwards the product will simply be called PROJ.

In recognition of the history of the software we are keeping PROJ.4 as
the *name of the organizing project*. The same project team also
produces the datum-grid package.

In summary:

o The PROJ.4 project provides the product PROJ, which is now at
  version 5.0.0.

o The foundational component of PROJ is the library libproj.

o Other PROJ components include the application proj, which provides
  a command line interface to libproj.

o The PROJ.4 project also distributes the datum-grid package,
  which at the time of writing is at version 1.6.0.


UPDATES
-------

o Introduced new API in proj.h.
   - The new API is orthogonal to the existing proj_api.h API and the
     internally used projects.h API.
   - The new API adds the ability to transform spatiotemporal (4D)
     coordinates.
   - Functions in the new API use the "proj_" namespace.
   - Data types in the new API use the "PJ_" namespace, with a few
     historic exceptions such as XY, XYZ, LP and LPZ.

o Introduced the concept of "transformation pipelines" that makes it
   possible to do complex geodetic transformations of spatiotemporal
   coordinates by daisy chaining simple coordinate operations.

o Introduced cct, the Coordinate Conversion and Transformation
   application.

o Introduced gie, the Geospatial Integrity Investigation Environment.
   - Selftest invoked by -C flag in proj has been removed
   - Ported approx. 1300 built-in selftests to gie format
   - Ported approx. 1000 tests from the gigs test framework
   - Added approx. 200 new tests

o Adopted terminology from the OGC/ISO-19100 geospatial standards
   series. Key definitions are:
   - At the most generic level, a *coordinate operation* is a change
     of coordinates, based on a one-to-one relationship, from one
     coordinate reference system to another.
   - A *transformation* is a coordinate operation in which the two
     coordinate reference systems are based on different datums, e.g.
     a change from a global reference frame to a regional frame.
   - A *conversion* is a coordinate operation in which both
     coordinate reference systems are based on the same datum,
     e.g. change of units of coordinates.
   - A *projection* is a coordinate conversion from an ellipsoidal
     coordinate system to a plane. Although projections are simply
     conversions according to the standard, they are treated as
     separate entities in PROJ as they make up the vast majority
     of operations in the library.

o New operations:
   - The pipeline operator (pipeline)
   - Transformations:
     + Helmert transform (helmert)
     + Horner real and complex polynomial evaluation (horner)
     + Horizontal gridshift (hgridshift)
     + Vertical gridshift (vgridshift)
     + Molodensky transform (molodensky)
     + Kinematic gridshift with deformation model (deformation)
   - Conversions:
     + Unit conversion (unitconvert)
     + Axis swap (axisswap)
   - Projections:
     + Central Conic projection (ccon)

o Significant documentation updates, including
   - Overhaul of the structure of the documentation
   - A better introduction to the use of PROJ
   - A complete reference to the new proj.h API
   - a complete rewrite of the section on geodesic calculations
   - Figures for all projections

o New "free format" option for operation definitions, which
   permits separating tokens by whitespace when specifying key/value-
   pairs, e.g. "proj = merc lat_0 = 45".

o Added metadata to init-files that can be read with the
   proj_init_info() function in the new proj.h API.

o Added ITRF2000, ITRF2008 and ITRF2014 init-files with ITRF
   transformation parameters, including plate motion model
   parameters.

o Added ellipsoid parameters for GSK2011, PZ90 and "danish". The
   latter is similar to the already supported andrae ellipsoid,
   but has a slightly different semimajor axis.

o Added Copenhagen prime meridian.

o Updated EPSG database to version 9.2.0.

o Geodesic library updated to version 1.49.1-c.

o Support for analytical partial derivatives has been removed.

o Improved performance in Winkel Tripel and Aitoff.

o Introduced pj_has_inverse() function to proj_api.h. Checks if an
   operation has an inverse. Use this instead of checking whether
   P->inv exists, since that can no longer be relied on.

o Removed support for Windows CE.

o Removed the VB6 COM interface.

BUG FIXES
------------

All bug fix numbers refer to issues indexed at
https://github.com/OSGeo/proj.4/issues/

o Fixed incorrect convergence calculation in Lambert Conformal
   Conic. #16.

o Handle ellipsoid parameters correctly when using +nadgrids=@null.
   #22.

o Return correct latitude when using negative northings in
   Transverse Mercator (tmerc). #138.

o Return correct result at origin in inverse Mod. Stererographic
   of Alaska. #161.

o Return correct result at origin in inverse Mod. Stererographic
   of 48 U.S. #162.

o Return correct result at origin in inverse Mod. Stererographic
   of 50 U.S. #163.

o Return correct result at origin in inverse Lee Oblated
   Stereographic. #164.

o Return correct result at origin in inverse Miller Oblated
   Stereographic. #164.

o Fixed scaling and wrap-around issues in Oblique Cylindrical
   Equal Area. #166.

o Corrected a coefficient error in inverse Transverse Mercator. #174.

o Respect -r flag when calling proj with -V. #184.

o Remove multiplication by 2 at the equator error in Stereographic
   projection. #194.

o Allow +alpha=0 and +gamma=0 when using Oblique Mercator. #195.

o Return correct result of inverse Oblique Mercator when alpha is
   between 90 and 270. #331.

o Avoid segmentation fault when accessing point outside grid. #369.

o Avoid segmentation fault on NaN input in Robin inverse. #463.

o Very verbose use of proj (-V) on Windows is fixed. #484.

o Fixed memory leak in General Oblique Transformation. #497.

o Equations for meridian convergence and partial derivatives have
   been corrected for non-conformal projections. #526.

o Fixed scaling of cartesian coordiantes in pj_transform(). #726.

o Additional bug fixes courtesy of Googles OSS-Fuzz program:
   https://bugs.chromium.org/p/oss-fuzz/issues/list?can=1&q=proj4


DEPRECATIONS
------------

o The projects.h header and the functions related to it is
   considered deprecated from version 5.0.0 and onwards.


    !!!     PROJECTS.H WILL BE REMOVED FROM THE LIBRARY     !!!
    !!!                 WITH VERSION 6.0.0                  !!!

o The nmake build system on Windows will not be supported from
   version 6.0.0 on onwards. Use CMake instead.

    !!! NMAKE BUILD SYSTEM WILL BE REMOVED FROM THE LIBRARY !!!
    !!!                 WITH VERSION 6.0.0                  !!!

o The proj_api.h header and the functions related to it is
   consided deprecated from version 5.0.0 and onwards.

    !!!     PROJ_API.H WILL BE REMOVED FROM THE LIBRARY     !!!
    !!!                 WITH VERSION 7.0.0                  !!!


THANKS TO
------------

Version 5.0.0 is made possible by the following contributors:

    Lukasz Komsta
    Maxim Churilin
    edechaux
    dusanjovic
    Zoltan Siki
    Tom Fili
    Nicolas David
    Mike Toews
    Micah Cochran
    Luke Campbell
    Ilya Oshchepkov
    Adam Wulkiewicz
    Jonas Tittmann
    Mateusz Loskot
    Etienne Jacques
    Bas Couwenberg
    Elliott Sales de Andrade
    Charles Karney
    Aaron Puchert
    Julien Moquet
    Charles Karney
    Howard Butler
    Even Rouault
    Thomas Knudsen
    Kristian Evers


From jicrbuh1 at gmail.com  Sun Feb  4 04:08:01 2018
From: jicrbuh1 at gmail.com (Chen Barnoy)
Date: Sun, 4 Feb 2018 14:08:01 +0200
Subject: [Proj] Converting between true north, grid north,
	and magnetic north
In-Reply-To: <CACmBxyv0LMeR2+FdS2SLo5DsfaDZzqbBHY6t8GxWojSzHzdE+g@mail.gmail.com>
References: <CAKF-jtJyCYxnyaNJR3qXbMOq2xUpYMbOMrXrpkfUv4Ogaadp6w@mail.gmail.com>
	<de5ccb7c-30ee-4e49-2e54-37a6d395003f@sri.com>
	<CACmBxyv0LMeR2+FdS2SLo5DsfaDZzqbBHY6t8GxWojSzHzdE+g@mail.gmail.com>
Message-ID: <CAKF-jtLkUrSg_Ny00yGqq=BNQ-_BQLwDV7ZaW0RUm_QeQpBpFA@mail.gmail.com>

Thanks!

And is there a similar library to convert between grid\UTM north to true
north?

2018-01-30 23:59 GMT+02:00 Kurt Schwehr <schwehr at gmail.com>:

> Be aware that the magnetic field is time varying.  It can change pretty
> quickly near the magnetic poles.
>
> Yet another source... igrf.py
>
> https://earthref.org/PmagPy/cookbook/#x1-1190005.2.54
>

On Tue, Jan 30, 2018 at 7:03 AM, Charles Karney <charles.karney at sri.com>
wrote:

> GeographicLib https://geographiclib.sourceforge.io provides access to
> several magnetic models via the MagneticField utility.  E.g.,
>
>    echo 42.363 -71.006 | MagneticField -t now
>
> =>
>
>    -14.67 67.08 20228.0 19569.1 -5121.1 47840.0 51940.7
>
> The first number is the current magnetic declination at Boston Logan
> Airport using the wmm2015 magnetic model.
>
> The magnetic models need to be downloaded separately from the
> GeographicLib library using
>
>    geographiclib-get-magnetic
>
> On 01/30/18 06:42, Chen Barnoy wrote:
> > Hi,
> >
> > Is there a way to convert between grid north, true north and magnetic
> > north in Proj4 or another library?
> >
> > Cheers,
> > Chen
> >
> >
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> >
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180204/1a76ec65/attachment.html>

From knudsen.thomas at gmail.com  Sun Feb  4 05:44:54 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Sun, 4 Feb 2018 14:44:54 +0100
Subject: [Proj] Converting between true north, grid north,
	and magnetic north
In-Reply-To: <CAKF-jtLkUrSg_Ny00yGqq=BNQ-_BQLwDV7ZaW0RUm_QeQpBpFA@mail.gmail.com>
References: <CAKF-jtJyCYxnyaNJR3qXbMOq2xUpYMbOMrXrpkfUv4Ogaadp6w@mail.gmail.com>
	<de5ccb7c-30ee-4e49-2e54-37a6d395003f@sri.com>
	<CACmBxyv0LMeR2+FdS2SLo5DsfaDZzqbBHY6t8GxWojSzHzdE+g@mail.gmail.com>
	<CAKF-jtLkUrSg_Ny00yGqq=BNQ-_BQLwDV7ZaW0RUm_QeQpBpFA@mail.gmail.com>
Message-ID: <CAH0YoENAK_ijBROQxDSh8aRB=oogZ1p+ZYhKdRE_pDp1K4Xq4g@mail.gmail.com>

libproj, the library behind proj, provides what you need, but you'll have
to do some coding yourself. If you're using the new API in te brand new
PROJ 5.0.0 release candidate, just announced, use the proj_factors(PJ, LP)
function - the convergence is in the PJ_FACTORS.meridian_convergence
element. In the old API, use pj_factors, and get what you need from the
struct FACTORS.conv element.

For smaller amounts of data, you can use proj to provide what you need, as
outlined in my previous reply (which actually used UTM as example).

/thomas



2018-02-04 13:08 GMT+01:00 Chen Barnoy <jicrbuh1 at gmail.com>:

> Thanks!
>
> And is there a similar library to convert between grid\UTM north to true
> north?
>
> 2018-01-30 23:59 GMT+02:00 Kurt Schwehr <schwehr at gmail.com>:
>
>> Be aware that the magnetic field is time varying.  It can change pretty
>> quickly near the magnetic poles.
>>
>> Yet another source... igrf.py
>>
>> https://earthref.org/PmagPy/cookbook/#x1-1190005.2.54
>>
>
> On Tue, Jan 30, 2018 at 7:03 AM, Charles Karney <charles.karney at sri.com>
> wrote:
>
>> GeographicLib https://geographiclib.sourceforge.io provides access to
>> several magnetic models via the MagneticField utility.  E.g.,
>>
>>    echo 42.363 -71.006 | MagneticField -t now
>>
>> =>
>>
>>    -14.67 67.08 20228.0 19569.1 -5121.1 47840.0 51940.7
>>
>> The first number is the current magnetic declination at Boston Logan
>> Airport using the wmm2015 magnetic model.
>>
>> The magnetic models need to be downloaded separately from the
>> GeographicLib library using
>>
>>    geographiclib-get-magnetic
>>
>> On 01/30/18 06:42, Chen Barnoy wrote:
>> > Hi,
>> >
>> > Is there a way to convert between grid north, true north and magnetic
>> > north in Proj4 or another library?
>> >
>> > Cheers,
>> > Chen
>> >
>> >
>> > _______________________________________________
>> > Proj mailing list
>> > Proj at lists.maptools.org
>> > http://lists.maptools.org/mailman/listinfo/proj
>> >
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
>
> --
> --
> http://schwehr.org
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180204/69ad3bde/attachment.html>

From charles at karney.com  Sun Feb  4 07:07:39 2018
From: charles at karney.com (Charles Karney)
Date: Sun, 4 Feb 2018 10:07:39 -0500
Subject: [Proj] Converting between true north, grid north,
 and magnetic north
In-Reply-To: <CAKF-jtLkUrSg_Ny00yGqq=BNQ-_BQLwDV7ZaW0RUm_QeQpBpFA@mail.gmail.com>
References: <CAKF-jtJyCYxnyaNJR3qXbMOq2xUpYMbOMrXrpkfUv4Ogaadp6w@mail.gmail.com>
	<de5ccb7c-30ee-4e49-2e54-37a6d395003f@sri.com>
	<CACmBxyv0LMeR2+FdS2SLo5DsfaDZzqbBHY6t8GxWojSzHzdE+g@mail.gmail.com>
	<CAKF-jtLkUrSg_Ny00yGqq=BNQ-_BQLwDV7ZaW0RUm_QeQpBpFA@mail.gmail.com>
Message-ID: <b4f7efb1-4a57-2917-a032-465cdf88cbc3@karney.com>

You can also use GeographicLib to compute the meridian convergence (the
bearing of grid north measured clockwise from true north) for the UTM
system.  Continuing with the Boston Logan Airport example:

     echo 42.363 -71.006 | GeoConvert -u => 19n 334812 4692030

     echo 42.363 -71.006 | GeoConvert -c => -1.35200 0.9999357

The first command gives you the UTM coordinates and the second the
meridian convergence and scale.

On 02/04/2018 07:08 AM, Chen Barnoy wrote:
> Thanks!
> 
> And is there a similar library to convert between grid\UTM north to true 
> north?
> 
> 2018-01-30 23:59 GMT+02:00 Kurt Schwehr <schwehr at gmail.com 
> <mailto:schwehr at gmail.com>>:
> 
>     Be aware that the magnetic field is time varying.  It can change
>     pretty quickly near the magnetic poles.
> 
>     Yet another source... igrf.py
> 
>     https://earthref.org/PmagPy/cookbook/#x1-1190005.2.54
>     <https://earthref.org/PmagPy/cookbook/#x1-1190005.2.54>
> 
> 
> On Tue, Jan 30, 2018 at 7:03 AM, Charles Karney <charles.karney at sri.com 
> <mailto:charles.karney at sri.com>> wrote:
> 
>     GeographicLib https://geographiclib.sourceforge.io
>     <https://geographiclib.sourceforge.io> provides access to
>     several magnetic models via the MagneticField utility.  E.g.,
> 
>         echo 42.363 -71.006 <tel:42.363%20-71.006> | MagneticField -t now
> 
>     =>
> 
>         -14.67 67.08 20228.0 19569.1 -5121.1 47840.0 51940.7
> 
>     The first number is the current magnetic declination at Boston Logan
>     Airport using the wmm2015 magnetic model.
> 
>     The magnetic models need to be downloaded separately from the
>     GeographicLib library using
> 
>         geographiclib-get-magnetic
> 
>     On 01/30/18 06:42, Chen Barnoy wrote:
>      > Hi,
>      >
>      > Is there a way to convert between grid north, true north and magnetic
>      > north in Proj4 or another library?
>      >
>      > Cheers,
>      > Chen


From moquet.julien at gmail.com  Mon Feb  5 14:08:34 2018
From: moquet.julien at gmail.com (Julien Moquet)
Date: Mon, 5 Feb 2018 23:08:34 +0100
Subject: [Proj] PROJ 5.0.0RC1 Released
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEBFFAFD@S000014.PROD.SITAD.DK>
References: <2E885BB293AF0448A0181138489E9A0EAEBFFAFD@S000014.PROD.SITAD.DK>
Message-ID: <CANigTqV8NqD7zdw_=gNcVKDOsvAjgcryW8SLpOaVsk8RY+qC2w@mail.gmail.com>

Hi Kristian,

I've got an improvement :

THANKS TO
------------

Version 5.0.0 is made possible by the following contributors:

    Lukasz Komsta
    Maxim Churilin
    edechaux
    dusanjovic
    Zoltan Siki
    Tom Fili
    Nicolas David
    Mike Toews
    Micah Cochran
    Luke Campbell
    Ilya Oshchepkov
    Adam Wulkiewicz
    Jonas Tittmann
    Mateusz Loskot
    Etienne Jacques
    Bas Couwenberg
    Elliott Sales de Andrade
    Charles Karney
    Aaron Puchert
    Julien Moquet
    Charles Karney
    Howard Butler
    Even Rouault
    Thomas Knudsen
    Kristian Evers

You forgot yourself.

Well done !

Regards,





2018-02-02 16:02 GMT+01:00 Kristian Evers <kreve at sdfe.dk>:

> All,
>
> I have prepared the first release candidate of PROJ 5.0.0. See the release
> notes below. Since this release brings many substantial changes I expect
> that we will be going through a number of RCs before the final release is
> ready. We are aiming for a March 1st final release.
>
> Please test the release candidate where ever you depend on it and report
> back your findings.
>
> Download it here:
>
> http://download.osgeo.org/proj/proj-5.0.0RC1.tar.gz  (
> http://download.osgeo.org/proj/proj-5.0.0RC1.tar.gz.md5)
> http://download.osgeo.org/proj/proj-5.0.0RC1.zip       (
> http://download.osgeo.org/proj/proj-5.0.0RC1.zip.md5)
>
>
> /Kristian
>
>
> 5.0.0 Release Notes
> -------------------
>
> This version of PROJ introduces some significant extensions and
> improvements to (primarily) the geodetic functionality of the system.
>
> The main driver for introducing the new features is the emergence of
> dynamic reference frames, the increasing use of high accuracy GNNS,
> and the related growing demand for accurate coordinate
> transformations.  While older versions of PROJ included some geodetic
> functionality, the new framework lays the foundation for turning PROJ
> into a generic geospatial coordinate transformation engine.
>
> The core of the library is still the well established projection code.
> The new functionality is primarily exposed in a new programming
> interface and a new command line utility, "cct" (for "Coordinate
> Conversion and Transformation").  The old programming interface is
> still available and can - to some extent - use the new geodetic
> transformation features.
>
> The internal architecture has also seen many changes and much
> improvement.  So far, these improvements respect the existing
> programming interface. But the process has revealed a need to simplify
> and reduce the code base, in order to support sustained active
> development.
>
> !!!
> !!! Therefore we have scheduled regular releases over the coming years
> !!! which will gradually remove the old programming interface.
> !!!
> !!! This will cause breaking changes with the next two major version
> !!! releases, which will affect all projects that depend on PROJ
> !!! (cf. section "deprecations" below).
> !!!
>
> The decision to break the existing API has not been easy, but has
> ultimately been deemed necessary to ensure the long term survival of
> the project. Not only by improving the maintainability immensely, but
> also by extending the potential user (and hence developer) community.
>
> The end goal is to deliver a generic coordinate transformation
> software package with a clean and concise code base appealing to
> both users and developers.
>
>
> VERSIONING AND NAMING
> ---------------------
>
> For the first time in more than 25 years the major version number of
> the software is changed. The decision to do this is based on the many
> new features and new API. While backwards compatibility remains -
> except in a few rare corner cases - the addition of a new and improved
> programming interface warrants a new major release.
>
> The new major version number unfortunately leaves the project in a bit
> of a conundrum regarding the name. For the majority of the life-time
> of the product it has been known as PROJ.4, but since we have now
> reached version 5 the name is no longer aligned with the version
> number.
>
> Hence we have decided to decouple the name from the version number and
> from this version and onwards the product will simply be called PROJ.
>
> In recognition of the history of the software we are keeping PROJ.4 as
> the *name of the organizing project*. The same project team also
> produces the datum-grid package.
>
> In summary:
>
> o The PROJ.4 project provides the product PROJ, which is now at
>   version 5.0.0.
>
> o The foundational component of PROJ is the library libproj.
>
> o Other PROJ components include the application proj, which provides
>   a command line interface to libproj.
>
> o The PROJ.4 project also distributes the datum-grid package,
>   which at the time of writing is at version 1.6.0.
>
>
> UPDATES
> -------
>
> o Introduced new API in proj.h.
>    - The new API is orthogonal to the existing proj_api.h API and the
>      internally used projects.h API.
>    - The new API adds the ability to transform spatiotemporal (4D)
>      coordinates.
>    - Functions in the new API use the "proj_" namespace.
>    - Data types in the new API use the "PJ_" namespace, with a few
>      historic exceptions such as XY, XYZ, LP and LPZ.
>
> o Introduced the concept of "transformation pipelines" that makes it
>    possible to do complex geodetic transformations of spatiotemporal
>    coordinates by daisy chaining simple coordinate operations.
>
> o Introduced cct, the Coordinate Conversion and Transformation
>    application.
>
> o Introduced gie, the Geospatial Integrity Investigation Environment.
>    - Selftest invoked by -C flag in proj has been removed
>    - Ported approx. 1300 built-in selftests to gie format
>    - Ported approx. 1000 tests from the gigs test framework
>    - Added approx. 200 new tests
>
> o Adopted terminology from the OGC/ISO-19100 geospatial standards
>    series. Key definitions are:
>    - At the most generic level, a *coordinate operation* is a change
>      of coordinates, based on a one-to-one relationship, from one
>      coordinate reference system to another.
>    - A *transformation* is a coordinate operation in which the two
>      coordinate reference systems are based on different datums, e.g.
>      a change from a global reference frame to a regional frame.
>    - A *conversion* is a coordinate operation in which both
>      coordinate reference systems are based on the same datum,
>      e.g. change of units of coordinates.
>    - A *projection* is a coordinate conversion from an ellipsoidal
>      coordinate system to a plane. Although projections are simply
>      conversions according to the standard, they are treated as
>      separate entities in PROJ as they make up the vast majority
>      of operations in the library.
>
> o New operations:
>    - The pipeline operator (pipeline)
>    - Transformations:
>      + Helmert transform (helmert)
>      + Horner real and complex polynomial evaluation (horner)
>      + Horizontal gridshift (hgridshift)
>      + Vertical gridshift (vgridshift)
>      + Molodensky transform (molodensky)
>      + Kinematic gridshift with deformation model (deformation)
>    - Conversions:
>      + Unit conversion (unitconvert)
>      + Axis swap (axisswap)
>    - Projections:
>      + Central Conic projection (ccon)
>
> o Significant documentation updates, including
>    - Overhaul of the structure of the documentation
>    - A better introduction to the use of PROJ
>    - A complete reference to the new proj.h API
>    - a complete rewrite of the section on geodesic calculations
>    - Figures for all projections
>
> o New "free format" option for operation definitions, which
>    permits separating tokens by whitespace when specifying key/value-
>    pairs, e.g. "proj = merc lat_0 = 45".
>
> o Added metadata to init-files that can be read with the
>    proj_init_info() function in the new proj.h API.
>
> o Added ITRF2000, ITRF2008 and ITRF2014 init-files with ITRF
>    transformation parameters, including plate motion model
>    parameters.
>
> o Added ellipsoid parameters for GSK2011, PZ90 and "danish". The
>    latter is similar to the already supported andrae ellipsoid,
>    but has a slightly different semimajor axis.
>
> o Added Copenhagen prime meridian.
>
> o Updated EPSG database to version 9.2.0.
>
> o Geodesic library updated to version 1.49.1-c.
>
> o Support for analytical partial derivatives has been removed.
>
> o Improved performance in Winkel Tripel and Aitoff.
>
> o Introduced pj_has_inverse() function to proj_api.h. Checks if an
>    operation has an inverse. Use this instead of checking whether
>    P->inv exists, since that can no longer be relied on.
>
> o Removed support for Windows CE.
>
> o Removed the VB6 COM interface.
>
> BUG FIXES
> ------------
>
> All bug fix numbers refer to issues indexed at
> https://github.com/OSGeo/proj.4/issues/
>
> o Fixed incorrect convergence calculation in Lambert Conformal
>    Conic. #16.
>
> o Handle ellipsoid parameters correctly when using +nadgrids=@null.
>    #22.
>
> o Return correct latitude when using negative northings in
>    Transverse Mercator (tmerc). #138.
>
> o Return correct result at origin in inverse Mod. Stererographic
>    of Alaska. #161.
>
> o Return correct result at origin in inverse Mod. Stererographic
>    of 48 U.S. #162.
>
> o Return correct result at origin in inverse Mod. Stererographic
>    of 50 U.S. #163.
>
> o Return correct result at origin in inverse Lee Oblated
>    Stereographic. #164.
>
> o Return correct result at origin in inverse Miller Oblated
>    Stereographic. #164.
>
> o Fixed scaling and wrap-around issues in Oblique Cylindrical
>    Equal Area. #166.
>
> o Corrected a coefficient error in inverse Transverse Mercator. #174.
>
> o Respect -r flag when calling proj with -V. #184.
>
> o Remove multiplication by 2 at the equator error in Stereographic
>    projection. #194.
>
> o Allow +alpha=0 and +gamma=0 when using Oblique Mercator. #195.
>
> o Return correct result of inverse Oblique Mercator when alpha is
>    between 90 and 270. #331.
>
> o Avoid segmentation fault when accessing point outside grid. #369.
>
> o Avoid segmentation fault on NaN input in Robin inverse. #463.
>
> o Very verbose use of proj (-V) on Windows is fixed. #484.
>
> o Fixed memory leak in General Oblique Transformation. #497.
>
> o Equations for meridian convergence and partial derivatives have
>    been corrected for non-conformal projections. #526.
>
> o Fixed scaling of cartesian coordiantes in pj_transform(). #726.
>
> o Additional bug fixes courtesy of Googles OSS-Fuzz program:
>    https://bugs.chromium.org/p/oss-fuzz/issues/list?can=1&q=proj4
>
>
> DEPRECATIONS
> ------------
>
> o The projects.h header and the functions related to it is
>    considered deprecated from version 5.0.0 and onwards.
>
>
>     !!!     PROJECTS.H WILL BE REMOVED FROM THE LIBRARY     !!!
>     !!!                 WITH VERSION 6.0.0                  !!!
>
> o The nmake build system on Windows will not be supported from
>    version 6.0.0 on onwards. Use CMake instead.
>
>     !!! NMAKE BUILD SYSTEM WILL BE REMOVED FROM THE LIBRARY !!!
>     !!!                 WITH VERSION 6.0.0                  !!!
>
> o The proj_api.h header and the functions related to it is
>    consided deprecated from version 5.0.0 and onwards.
>
>     !!!     PROJ_API.H WILL BE REMOVED FROM THE LIBRARY     !!!
>     !!!                 WITH VERSION 7.0.0                  !!!
>
>
> THANKS TO
> ------------
>
> Version 5.0.0 is made possible by the following contributors:
>
>     Lukasz Komsta
>     Maxim Churilin
>     edechaux
>     dusanjovic
>     Zoltan Siki
>     Tom Fili
>     Nicolas David
>     Mike Toews
>     Micah Cochran
>     Luke Campbell
>     Ilya Oshchepkov
>     Adam Wulkiewicz
>     Jonas Tittmann
>     Mateusz Loskot
>     Etienne Jacques
>     Bas Couwenberg
>     Elliott Sales de Andrade
>     Charles Karney
>     Aaron Puchert
>     Julien Moquet
>     Charles Karney
>     Howard Butler
>     Even Rouault
>     Thomas Knudsen
>     Kristian Evers
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180205/607dd790/attachment.html>

From thy at 42.dk  Mon Feb  5 23:39:43 2018
From: thy at 42.dk (Kristian Thy)
Date: Tue, 6 Feb 2018 08:39:43 +0100
Subject: [Proj] PROJ 5.0.0RC1 Released
In-Reply-To: <CANigTqV8NqD7zdw_=gNcVKDOsvAjgcryW8SLpOaVsk8RY+qC2w@mail.gmail.com>
References: <2E885BB293AF0448A0181138489E9A0EAEBFFAFD@S000014.PROD.SITAD.DK>
	<CANigTqV8NqD7zdw_=gNcVKDOsvAjgcryW8SLpOaVsk8RY+qC2w@mail.gmail.com>
Message-ID: <20180206073943.GB15273@42.dk>

He's right at the bottom. And I see Charles Karney made so many
contributions he's listed twice ;)

On Mon, Feb 05, Julien Moquet wrote:
> Hi Kristian,
> 
> I've got an improvement :
> 
> THANKS TO
> ------------
> 
> Version 5.0.0 is made possible by the following contributors:
> 
>     Lukasz Komsta
>     Maxim Churilin
>     edechaux
>     dusanjovic
>     Zoltan Siki
>     Tom Fili
>     Nicolas David
>     Mike Toews
>     Micah Cochran
>     Luke Campbell
>     Ilya Oshchepkov
>     Adam Wulkiewicz
>     Jonas Tittmann
>     Mateusz Loskot
>     Etienne Jacques
>     Bas Couwenberg
>     Elliott Sales de Andrade
>     Charles Karney
>     Aaron Puchert
>     Julien Moquet
>     Charles Karney
>     Howard Butler
>     Even Rouault
>     Thomas Knudsen
>     Kristian Evers
> 
> You forgot yourself.
> 
> Well done !


From kreve at sdfe.dk  Tue Feb  6 00:54:02 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 6 Feb 2018 08:54:02 +0000
Subject: [Proj] PROJ 5.0.0RC1 Released
In-Reply-To: <20180206073943.GB15273@42.dk>
References: <2E885BB293AF0448A0181138489E9A0EAEBFFAFD@S000014.PROD.SITAD.DK>
	<CANigTqV8NqD7zdw_=gNcVKDOsvAjgcryW8SLpOaVsk8RY+qC2w@mail.gmail.com>
	<20180206073943.GB15273@42.dk>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC06FA4@S000014.PROD.SITAD.DK>

> And I see Charles Karney made so many contributions he's listed twice ;)

Some animals are more equal than others :-)

The list was made from a summary of git authors between 4.9.3 and some recent commit. Some authors get listed several times because they have used different email addresses for their commits. I'll update the list before the final release goes out. 

In other news, Bas has been very active in the bug-finding department and has reported (and fixed) many issues from RC1. Thanks for that. We still have a few issues to sort out but I expect to send out RC2 within this week.

/Kristian 


-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af Kristian Thy
Sendt: 6. februar 2018 08:40
Til: PROJ.4 and general Projections Discussions <proj at lists.maptools.org>
Emne: Re: [Proj] PROJ 5.0.0RC1 Released

He's right at the bottom. And I see Charles Karney made so many
contributions he's listed twice ;)

On Mon, Feb 05, Julien Moquet wrote:
> Hi Kristian,
> 
> I've got an improvement :
> 
> THANKS TO
> ------------
> 
> Version 5.0.0 is made possible by the following contributors:
> 
>     Lukasz Komsta
>     Maxim Churilin
>     edechaux
>     dusanjovic
>     Zoltan Siki
>     Tom Fili
>     Nicolas David
>     Mike Toews
>     Micah Cochran
>     Luke Campbell
>     Ilya Oshchepkov
>     Adam Wulkiewicz
>     Jonas Tittmann
>     Mateusz Loskot
>     Etienne Jacques
>     Bas Couwenberg
>     Elliott Sales de Andrade
>     Charles Karney
>     Aaron Puchert
>     Julien Moquet
>     Charles Karney
>     Howard Butler
>     Even Rouault
>     Thomas Knudsen
>     Kristian Evers
> 
> You forgot yourself.
> 
> Well done !
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From kreve at sdfe.dk  Wed Feb  7 13:07:29 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 7 Feb 2018 21:07:29 +0000
Subject: [Proj] PROJ 5.0.0RC2
Message-ID: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>

All,

The first batch of reported issues with RC1 have been fixed. So here’s the second release candidate. Grab it here:

http://download.osgeo.org/proj/proj-5.0.0RC2.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC2.tar.gz.md5)
http://download.osgeo.org/proj/proj-5.0.0RC2.zip (http://download.osgeo.org/proj/proj-5.0.0RC2.zip.md5 )

Please test and report any problems you may find. Either here or on GitHub. In the unlikely case no issues are discovered I will push the final release two weeks from now.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180207/3b576820/attachment.html>

From idan at miara.com  Thu Feb  8 23:15:49 2018
From: idan at miara.com (Idan Miara)
Date: Fri, 9 Feb 2018 09:15:49 +0200
Subject: [Proj] geodesic calculations on v5
In-Reply-To: <CAEDrt383KYr5-NfNr_da=D1Yct35qjCA3E++OkVvVYu6qK+F6g@mail.gmail.com>
References: <CAEDrt38-wiXrp7MnnsNtYCXTW03z0jjRfGHNA569W83Dux4-0w@mail.gmail.com>
	<CAEDrt3_AHy__E4hQj3rPqfzoxV46yGhn1a9URbtnXQ2qnbyF4A@mail.gmail.com>
	<CAEDrt38BcHSx9LhFm3ydC5TuxuzhmqExXv_QgMAnpODHi7Okcw@mail.gmail.com>
	<CAEDrt3-2bkRhGw8q5Nt12YtuVqqjcuT2d5U-Ehv5mrtcdG9jOw@mail.gmail.com>
	<CAEDrt39k343pZRiZJaFEZDnZU3vKsp41Fb0k1bwZa62J6EJZeQ@mail.gmail.com>
	<CAEDrt3-wvdv0aRLfMBfXR=AcVgpbLgO+sqMzbw7_Np-sL-T7jQ@mail.gmail.com>
	<CAEDrt38RE=03VqrvDE9Y66wVJ9y2ijtKj8kB0admLZECDD5YKQ@mail.gmail.com>
	<CAEDrt39P6M8RXJO6Er-6qFRwfD5sw2WvdZyKjcV9W-xeczuFUA@mail.gmail.com>
	<CAEDrt3-w9tLOCHYEELs4Av7KoqU+EkStborSLaiTq30unZGZmg@mail.gmail.com>
	<CAEDrt3_z9Grjn25S=uQ2Wa8m2ks-CG0tNQhBrtYi=fAnULjEQA@mail.gmail.com>
	<CAEDrt383KYr5-NfNr_da=D1Yct35qjCA3E++OkVvVYu6qK+F6g@mail.gmail.com>
Message-ID: <CAEDrt3_L1UoYixXxjJQrpz6R_knm0R-vXRDXRKqmDryfT6jFqA@mail.gmail.com>

Hi,

I read that there was a complete rewrite of the documentation section on
geodesic calculations.

Were all the changes in v5 regarding coordinate transformations?
Or was there any change in API or in performance of geodesic calculations
in v5?

Regards,
Idan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180209/2d1e0220/attachment.html>

From charles at karney.com  Fri Feb  9 00:57:37 2018
From: charles at karney.com (Charles Karney)
Date: Fri, 9 Feb 2018 03:57:37 -0500
Subject: [Proj] geodesic calculations on v5
In-Reply-To: <CAEDrt3_L1UoYixXxjJQrpz6R_knm0R-vXRDXRKqmDryfT6jFqA@mail.gmail.com>
References: <CAEDrt38-wiXrp7MnnsNtYCXTW03z0jjRfGHNA569W83Dux4-0w@mail.gmail.com>
	<CAEDrt3_AHy__E4hQj3rPqfzoxV46yGhn1a9URbtnXQ2qnbyF4A@mail.gmail.com>
	<CAEDrt38BcHSx9LhFm3ydC5TuxuzhmqExXv_QgMAnpODHi7Okcw@mail.gmail.com>
	<CAEDrt3-2bkRhGw8q5Nt12YtuVqqjcuT2d5U-Ehv5mrtcdG9jOw@mail.gmail.com>
	<CAEDrt39k343pZRiZJaFEZDnZU3vKsp41Fb0k1bwZa62J6EJZeQ@mail.gmail.com>
	<CAEDrt3-wvdv0aRLfMBfXR=AcVgpbLgO+sqMzbw7_Np-sL-T7jQ@mail.gmail.com>
	<CAEDrt38RE=03VqrvDE9Y66wVJ9y2ijtKj8kB0admLZECDD5YKQ@mail.gmail.com>
	<CAEDrt39P6M8RXJO6Er-6qFRwfD5sw2WvdZyKjcV9W-xeczuFUA@mail.gmail.com>
	<CAEDrt3-w9tLOCHYEELs4Av7KoqU+EkStborSLaiTq30unZGZmg@mail.gmail.com>
	<CAEDrt3_z9Grjn25S=uQ2Wa8m2ks-CG0tNQhBrtYi=fAnULjEQA@mail.gmail.com>
	<CAEDrt383KYr5-NfNr_da=D1Yct35qjCA3E++OkVvVYu6qK+F6g@mail.gmail.com>
	<CAEDrt3_L1UoYixXxjJQrpz6R_knm0R-vXRDXRKqmDryfT6jFqA@mail.gmail.com>
Message-ID: <8b0f5833-7134-fa40-d626-52e14f41f642@karney.com>

The new write-up on the geodesic calculations is available at

   http://proj4.org/geodesic.html

This just gives a general discussion of the geodesic problem.
Detailed documentation of the API is at

   https://geographiclib.sourceforge.io/1.49/C/geodesic_8h.html

proj 5.0 introduces no changes to this API on in the performance
of the geodesic code.

   --Charles

On 02/09/2018 02:15 AM, Idan Miara wrote:
> Hi,
> 
> I read that there was a complete rewrite of the documentation section on 
> geodesic calculations.
> 
> Were all the changes in v5 regarding coordinate transformations?
> Or was there any change in API or in performance of geodesic 
> calculations in v5?
> 
> Regards,
> Idan
> 


From sebastic at xs4all.nl  Fri Feb  9 01:26:32 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 9 Feb 2018 10:26:32 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
Message-ID: <c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>

On 02/07/2018 10:07 PM, Kristian Evers wrote:
> Please test and report any problems you may find. Either here or on GitHub. In the unlikely case no issues are discovered I will push the final release two weeks from now.

Is there still room before the final release for API changes?

I'm currently rebuilding all Debian packages that depend on proj, and
this has uncovered some issues in Perl packages: Geo::Proj4 & PDL. They
both include projects.h which contains a UV typedef that conflicts with
a Perl header that contains a UV typedef too.

The related issues are:

 * Geo::Proj4
   https://github.com/markov2/perl5-Geo-Proj4/issues/1
 * PDL
   https://sourceforge.net/p/pdl/bugs/444/

The Geo::Proj4 issues describes (one of) the reasons to include
projects.h instead of relying on the public APIs:

"
 Looking back at the code, my memory tells me that it only has to do
 with being able to get names defined in the library:

  struct PJ_LIST pj_get_list_ref()
  struct PJ_ELLPS pj_get_ellps_ref()
  struct PJ_UNITS pj_get_units_ref()
  struct PJ_DATUM pj_get_datums_ref()

 Access to these tables is very useful to be able to give some help to
 the users. For instance, to create option menus in graphical
 applications. I have no idea whether anyone is using it for real.

 I see that PDL::GIS::Proj also does this:

  my @a = split(/\n/, `echo | proj -v $params`);

 to get some info.
"

What options are there to accommodate the needs of these Perl project in
their use of proj?

Kind Regards,

Bas


From kreve at sdfe.dk  Fri Feb  9 02:35:10 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Fri, 9 Feb 2018 10:35:10 +0000
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
Message-ID: <EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>

In principle we shouldn’t do API changes now, but on the other hand this is the first time the code is properly tested against other libraries so some adjustments can be necessary.

First off, the new API has the following functions:

const PJ_OPERATIONS *proj_list_operations(void);
const PJ_ELLPS *proj_list_ellps(void);
const PJ_UNITS *proj_list_units(void);
const PJ_PRIME_MERIDIANS *proj_list_prime_meridians(void);

Which does the same thing as the pj_get_*_ref() functions you mention. Except that there is no function for getting the list of datums. The reason being that the +datum parameter is “classic” PROJ functionality which will be phased out eventually (we are moving away from the WGS84 hub datum which +datum is based on).

So the simple answer is to use the new API. Unfortunately you will have the same problem since we also have a UV typedef in the new API. So at least I think we should change that in order to not clash with other libraries. Unless there is any objections to this, I will rename the types XY, LP, UV, XXYZ, LPZ, UVZ to PJ_XY, PJ_LP, PJ_UV, PJ_XYZ, PJ_LPZ, PJ_UVZ.

Another solution to the problem would be to move the mentioned functions to proj_api.h. I am reluctant to do that. I want an incentive to move to the new API so the transition happens as fast as possible.

How does that work for you?

/Kristian 

> On 9 Feb 2018, at 10:26, Sebastiaan Couwenberg <sebastic at xs4all.nl> wrote:
> 
> On 02/07/2018 10:07 PM, Kristian Evers wrote:
>> Please test and report any problems you may find. Either here or on GitHub. In the unlikely case no issues are discovered I will push the final release two weeks from now.
> 
> Is there still room before the final release for API changes?
> 
> I'm currently rebuilding all Debian packages that depend on proj, and
> this has uncovered some issues in Perl packages: Geo::Proj4 & PDL. They
> both include projects.h which contains a UV typedef that conflicts with
> a Perl header that contains a UV typedef too.
> 
> The related issues are:
> 
> * Geo::Proj4
>   https://github.com/markov2/perl5-Geo-Proj4/issues/1
> * PDL
>   https://sourceforge.net/p/pdl/bugs/444/
> 
> The Geo::Proj4 issues describes (one of) the reasons to include
> projects.h instead of relying on the public APIs:
> 
> "
> Looking back at the code, my memory tells me that it only has to do
> with being able to get names defined in the library:
> 
>  struct PJ_LIST pj_get_list_ref()
>  struct PJ_ELLPS pj_get_ellps_ref()
>  struct PJ_UNITS pj_get_units_ref()
>  struct PJ_DATUM pj_get_datums_ref()
> 
> Access to these tables is very useful to be able to give some help to
> the users. For instance, to create option menus in graphical
> applications. I have no idea whether anyone is using it for real.
> 
> I see that PDL::GIS::Proj also does this:
> 
>  my @a = split(/\n/, `echo | proj -v $params`);
> 
> to get some info.
> "
> 
> What options are there to accommodate the needs of these Perl project in
> their use of proj?
> 
> Kind Regards,
> 
> Bas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From sebastic at xs4all.nl  Fri Feb  9 02:58:25 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 9 Feb 2018 11:58:25 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
Message-ID: <c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>

On 02/09/2018 11:35 AM, Kristian Evers wrote:
> In principle we shouldn’t do API changes now, but on the other hand this is the first time the code is properly tested against other libraries so some adjustments can be necessary.
> 
> First off, the new API has the following functions:
> 
> const PJ_OPERATIONS *proj_list_operations(void);
> const PJ_ELLPS *proj_list_ellps(void);
> const PJ_UNITS *proj_list_units(void);
> const PJ_PRIME_MERIDIANS *proj_list_prime_meridians(void);
> 
> Which does the same thing as the pj_get_*_ref() functions you mention. Except that there is no function for getting the list of datums. The reason being that the +datum parameter is “classic” PROJ functionality which will be phased out eventually (we are moving away from the WGS84 hub datum which +datum is based on).
> 
> So the simple answer is to use the new API. Unfortunately you will have the same problem since we also have a UV typedef in the new API. So at least I think we should change that in order to not clash with other libraries. Unless there is any objections to this, I will rename the types XY, LP, UV, XXYZ, LPZ, UVZ to PJ_XY, PJ_LP, PJ_UV, PJ_XYZ, PJ_LPZ, PJ_UVZ.
> 
> Another solution to the problem would be to move the mentioned functions to proj_api.h. I am reluctant to do that. I want an incentive to move to the new API so the transition happens as fast as possible.
> 
> How does that work for you?

Prefixing the typedefs with 'PJ_' sounds good.

I've forwarded your reply to the perl5-Geo-Proj4 issue and will proxy
back any reply from the developer.

Kind Regards,

Bas


From kreve at sdfe.dk  Fri Feb  9 03:03:42 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Fri, 9 Feb 2018 11:03:42 +0000
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
Message-ID: <35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>



On 9 Feb 2018, at 11:58, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:

On 02/09/2018 11:35 AM, Kristian Evers wrote:
In principle we shouldn’t do API changes now, but on the other hand this is the first time the code is properly tested against other libraries so some adjustments can be necessary.

First off, the new API has the following functions:

const PJ_OPERATIONS *proj_list_operations(void);
const PJ_ELLPS *proj_list_ellps(void);
const PJ_UNITS *proj_list_units(void);
const PJ_PRIME_MERIDIANS *proj_list_prime_meridians(void);

Which does the same thing as the pj_get_*_ref() functions you mention. Except that there is no function for getting the list of datums. The reason being that the +datum parameter is “classic” PROJ functionality which will be phased out eventually (we are moving away from the WGS84 hub datum which +datum is based on).

So the simple answer is to use the new API. Unfortunately you will have the same problem since we also have a UV typedef in the new API. So at least I think we should change that in order to not clash with other libraries. Unless there is any objections to this, I will rename the types XY, LP, UV, XXYZ, LPZ, UVZ to PJ_XY, PJ_LP, PJ_UV, PJ_XYZ, PJ_LPZ, PJ_UVZ.

Another solution to the problem would be to move the mentioned functions to proj_api.h. I am reluctant to do that. I want an incentive to move to the new API so the transition happens as fast as possible.

How does that work for you?

Prefixing the typedefs with 'PJ_' sounds good.

I've forwarded your reply to the perl5-Geo-Proj4 issue and will proxy
back any reply from the developer.


Thanks.

By the way, this is no a new issue, right? It seems that it would also have been a problem with previous versions as well.

Kind Regards,

Bas
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180209/05e3f8d6/attachment.html>

From sebastic at xs4all.nl  Fri Feb  9 03:36:44 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 9 Feb 2018 12:36:44 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
	<35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
Message-ID: <94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>

On 02/09/2018 12:03 PM, Kristian Evers wrote:
> By the way, this is no a new issue, right? It seems that it would also have been a problem with previous versions as well.

Both PDL & Geo::Proj4 built successfully with previous proj versions.

Looking at the history of perl.h the typedef was introduced there 19
years ago.

The typedef was introduced in projects.h in proj 5.0.0-rc1.

Kind Regards,

Bas


From knudsen.thomas at gmail.com  Fri Feb  9 04:17:49 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Fri, 9 Feb 2018 13:17:49 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
	<35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
	<94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>
Message-ID: <CAH0YoENgGfnQzP6aM9Z2xqOV+fitNED_zQWrQ7T8v0c2S_SyuA@mail.gmail.com>

 > The typedef was introduced in projects.h in proj 5.0.0-rc1.

It has actually been part of PROJ forever. For a number of releases,
however, it has been deffed away as, iirc, projUV: Part of a hack for
making all of XY, LP and UV look alike (I have never understood why it was
necessary, and it broke the classic PROJ pj_init/pj_fwd/pj_inv/pj_free API).

It took major code surgery to step between all the tripwires the projNN
deffing had created, so be careful when touching it, and note that renaming
datatypes will break backward compatibility for everyone.
UV was hardly ever used, so perhaps it is way easier to just rename UV,
which is mostly a PROJ internal type.

This would also open an opportunity to consider eliminating the projection
approximation subsystem (gen_cheb.c, mk_cheby.c, biveval.c etc.) - a nice
milestone for release 6 or 7 :-)

/thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180209/965070ab/attachment.html>

From kristianevers at gmail.com  Fri Feb  9 04:29:26 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Fri, 9 Feb 2018 13:29:26 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <CAH0YoENgGfnQzP6aM9Z2xqOV+fitNED_zQWrQ7T8v0c2S_SyuA@mail.gmail.com>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
	<35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
	<94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>
	<CAH0YoENgGfnQzP6aM9Z2xqOV+fitNED_zQWrQ7T8v0c2S_SyuA@mail.gmail.com>
Message-ID: <58DD229D-C1CA-48FC-A2D8-D9945C8AA9C4@gmail.com>

My ideas was to only rename the datatypes in proj.h, so not breaking backwards compatibility. I am quickly realising that it is
not so simple as I thought. I am sure it is possible and I think it is worth the hassle to make sure we don’t clash with other
libraries in the future.

One change I believe we can do to fix the immediate problem is to remove the following two lines from projects.h (line 161-162): 

typedef struct { double u, v; }        UV;
typedef struct { double u, v, w; }     UVW;

The build completes and UV/UVW doesn’t get in the way of anything else. Have I overlooked something that hinders this idea?

/Kristian

> On 9 Feb 2018, at 13:17, Thomas Knudsen <knudsen.thomas at gmail.com> wrote:
> 
> > The typedef was introduced in projects.h in proj 5.0.0-rc1. 
> 
> It has actually been part of PROJ forever. For a number of releases, however, it has been deffed away as, iirc, projUV: Part of a hack for making all of XY, LP and UV look alike (I have never understood why it was necessary, and it broke the classic PROJ pj_init/pj_fwd/pj_inv/pj_free API).
> 
> It took major code surgery to step between all the tripwires the projNN deffing had created, so be careful when touching it, and note that renaming datatypes will break backward compatibility for everyone.
> UV was hardly ever used, so perhaps it is way easier to just rename UV, which is mostly a PROJ internal type.
> 
> This would also open an opportunity to consider eliminating the projection approximation subsystem (gen_cheb.c, mk_cheby.c, biveval.c etc.) - a nice milestone for release 6 or 7 :-)
> 
> /thomas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180209/4c1a9382/attachment.html>

From kristianevers at gmail.com  Fri Feb  9 04:50:24 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Fri, 9 Feb 2018 13:50:24 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <58DD229D-C1CA-48FC-A2D8-D9945C8AA9C4@gmail.com>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
	<35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
	<94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>
	<CAH0YoENgGfnQzP6aM9Z2xqOV+fitNED_zQWrQ7T8v0c2S_SyuA@mail.gmail.com>
	<58DD229D-C1CA-48FC-A2D8-D9945C8AA9C4@gmail.com>
Message-ID: <6EFC908A-6078-4931-8E4D-B8C7667D4C59@gmail.com>

I think the changes in this PR solves the problem: https://github.com/OSGeo/proj.4/pull/781/files <https://github.com/OSGeo/proj.4/pull/781/files>


> On 9 Feb 2018, at 13:29, Kristian Evers <kristianevers at gmail.com> wrote:
> 
> My ideas was to only rename the datatypes in proj.h, so not breaking backwards compatibility. I am quickly realising that it is
> not so simple as I thought. I am sure it is possible and I think it is worth the hassle to make sure we don’t clash with other
> libraries in the future.
> 
> One change I believe we can do to fix the immediate problem is to remove the following two lines from projects.h (line 161-162): 
> 
> typedef struct { double u, v; }        UV;
> typedef struct { double u, v, w; }     UVW;
> 
> The build completes and UV/UVW doesn’t get in the way of anything else. Have I overlooked something that hinders this idea?
> 
> /Kristian
> 
>> On 9 Feb 2018, at 13:17, Thomas Knudsen <knudsen.thomas at gmail.com <mailto:knudsen.thomas at gmail.com>> wrote:
>> 
>> > The typedef was introduced in projects.h in proj 5.0.0-rc1. 
>> 
>> It has actually been part of PROJ forever. For a number of releases, however, it has been deffed away as, iirc, projUV: Part of a hack for making all of XY, LP and UV look alike (I have never understood why it was necessary, and it broke the classic PROJ pj_init/pj_fwd/pj_inv/pj_free API).
>> 
>> It took major code surgery to step between all the tripwires the projNN deffing had created, so be careful when touching it, and note that renaming datatypes will break backward compatibility for everyone.
>> UV was hardly ever used, so perhaps it is way easier to just rename UV, which is mostly a PROJ internal type.
>> 
>> This would also open an opportunity to consider eliminating the projection approximation subsystem (gen_cheb.c, mk_cheby.c, biveval.c etc.) - a nice milestone for release 6 or 7 :-)
>> 
>> /thomas
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>> http://lists.maptools.org/mailman/listinfo/proj
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180209/b9184df5/attachment.html>

From idan at miara.com  Sat Feb 10 00:30:25 2018
From: idan at miara.com (Idan Miara)
Date: Sat, 10 Feb 2018 10:30:25 +0200
Subject: [Proj] geodesic calculations on v5
In-Reply-To: <8b0f5833-7134-fa40-d626-52e14f41f642@karney.com>
References: <CAEDrt38-wiXrp7MnnsNtYCXTW03z0jjRfGHNA569W83Dux4-0w@mail.gmail.com>
	<CAEDrt3_AHy__E4hQj3rPqfzoxV46yGhn1a9URbtnXQ2qnbyF4A@mail.gmail.com>
	<CAEDrt38BcHSx9LhFm3ydC5TuxuzhmqExXv_QgMAnpODHi7Okcw@mail.gmail.com>
	<CAEDrt3-2bkRhGw8q5Nt12YtuVqqjcuT2d5U-Ehv5mrtcdG9jOw@mail.gmail.com>
	<CAEDrt39k343pZRiZJaFEZDnZU3vKsp41Fb0k1bwZa62J6EJZeQ@mail.gmail.com>
	<CAEDrt3-wvdv0aRLfMBfXR=AcVgpbLgO+sqMzbw7_Np-sL-T7jQ@mail.gmail.com>
	<CAEDrt38RE=03VqrvDE9Y66wVJ9y2ijtKj8kB0admLZECDD5YKQ@mail.gmail.com>
	<CAEDrt39P6M8RXJO6Er-6qFRwfD5sw2WvdZyKjcV9W-xeczuFUA@mail.gmail.com>
	<CAEDrt3-w9tLOCHYEELs4Av7KoqU+EkStborSLaiTq30unZGZmg@mail.gmail.com>
	<CAEDrt3_z9Grjn25S=uQ2Wa8m2ks-CG0tNQhBrtYi=fAnULjEQA@mail.gmail.com>
	<CAEDrt383KYr5-NfNr_da=D1Yct35qjCA3E++OkVvVYu6qK+F6g@mail.gmail.com>
	<CAEDrt3_L1UoYixXxjJQrpz6R_knm0R-vXRDXRKqmDryfT6jFqA@mail.gmail.com>
	<8b0f5833-7134-fa40-d626-52e14f41f642@karney.com>
Message-ID: <CAEDrt39ARKL6vNxTcEO7KVbSoEf94-gT+YukuWNYpfHQVTO6gw@mail.gmail.com>

Thanks for the pointers!

On 9 Feb 2018 10:57 am, "Charles Karney" <charles at karney.com> wrote:

> The new write-up on the geodesic calculations is available at
>
>   http://proj4.org/geodesic.html
>
> This just gives a general discussion of the geodesic problem.
> Detailed documentation of the API is at
>
>   https://geographiclib.sourceforge.io/1.49/C/geodesic_8h.html
>
> proj 5.0 introduces no changes to this API on in the performance
> of the geodesic code.
>
>   --Charles
>
> On 02/09/2018 02:15 AM, Idan Miara wrote:
>
>> Hi,
>>
>> I read that there was a complete rewrite of the documentation section on
>> geodesic calculations.
>>
>> Were all the changes in v5 regarding coordinate transformations?
>> Or was there any change in API or in performance of geodesic calculations
>> in v5?
>>
>> Regards,
>> Idan
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180210/94f2214f/attachment.html>

From knudsen.thomas at gmail.com  Sat Feb 10 01:19:03 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Sat, 10 Feb 2018 10:19:03 +0100
Subject: [Proj] geodesic calculations on v5
In-Reply-To: <CAEDrt39ARKL6vNxTcEO7KVbSoEf94-gT+YukuWNYpfHQVTO6gw@mail.gmail.com>
References: <CAEDrt38-wiXrp7MnnsNtYCXTW03z0jjRfGHNA569W83Dux4-0w@mail.gmail.com>
	<CAEDrt3_AHy__E4hQj3rPqfzoxV46yGhn1a9URbtnXQ2qnbyF4A@mail.gmail.com>
	<CAEDrt38BcHSx9LhFm3ydC5TuxuzhmqExXv_QgMAnpODHi7Okcw@mail.gmail.com>
	<CAEDrt3-2bkRhGw8q5Nt12YtuVqqjcuT2d5U-Ehv5mrtcdG9jOw@mail.gmail.com>
	<CAEDrt39k343pZRiZJaFEZDnZU3vKsp41Fb0k1bwZa62J6EJZeQ@mail.gmail.com>
	<CAEDrt3-wvdv0aRLfMBfXR=AcVgpbLgO+sqMzbw7_Np-sL-T7jQ@mail.gmail.com>
	<CAEDrt38RE=03VqrvDE9Y66wVJ9y2ijtKj8kB0admLZECDD5YKQ@mail.gmail.com>
	<CAEDrt39P6M8RXJO6Er-6qFRwfD5sw2WvdZyKjcV9W-xeczuFUA@mail.gmail.com>
	<CAEDrt3-w9tLOCHYEELs4Av7KoqU+EkStborSLaiTq30unZGZmg@mail.gmail.com>
	<CAEDrt3_z9Grjn25S=uQ2Wa8m2ks-CG0tNQhBrtYi=fAnULjEQA@mail.gmail.com>
	<CAEDrt383KYr5-NfNr_da=D1Yct35qjCA3E++OkVvVYu6qK+F6g@mail.gmail.com>
	<CAEDrt3_L1UoYixXxjJQrpz6R_knm0R-vXRDXRKqmDryfT6jFqA@mail.gmail.com>
	<8b0f5833-7134-fa40-d626-52e14f41f642@karney.com>
	<CAEDrt39ARKL6vNxTcEO7KVbSoEf94-gT+YukuWNYpfHQVTO6gw@mail.gmail.com>
Message-ID: <CAH0YoEMJ4ddmv1RFWOynThWitLML7euzrW5Ak3x_ZYEpML1Lfw@mail.gmail.com>

Idan,

For the part of your question relating to the API: There are two new API
calls:

double proj_lp_dist (const PJ *P, PJ_LP a, PJ_LP b)

and

double proj_lpz_dist (const PJ *P, PJ_LPZ a, PJ_LPZ b)

The first returns the geodesic distance between points aand b, the second
the length of the hypothenusis of a right angled triangle with base length
proj_lp_dist (a,b), and height a.z-b.z, i.e. "the distance between the
points if the Earth was flat".

The functions are intended for transformation accuracy assessment, and *do
not introduce* anything new: Basically, they are calls to Charles' code,
with some syntactic sugar, and discarding the two azimuths from the result,
just returning the distance.

But while writing this (and in the view of the material merged yesterday,
renaming the old style coordinate types by moving them to the PJ_ name
space), I notice that these call signatures are actually buggy: Along with
two additional distance functions, they are the only place where the old
style coordinates pop to the top of the new style API.

I will file an issue regarding this, and if the other developers agree you
will probably see these signatures in the final 5.0.0:

double proj_lp_dist (const PJ *P, PJ_COORD a, PJ_COORD b)

and

double proj_lpz_dist (const PJ *P, PJ_COORD a, PJ_COORD b)






2018-02-10 9:30 GMT+01:00 Idan Miara <idan at miara.com>:

> Thanks for the pointers!
>
> On 9 Feb 2018 10:57 am, "Charles Karney" <charles at karney.com> wrote:
>
>> The new write-up on the geodesic calculations is available at
>>
>>   http://proj4.org/geodesic.html
>>
>> This just gives a general discussion of the geodesic problem.
>> Detailed documentation of the API is at
>>
>>   https://geographiclib.sourceforge.io/1.49/C/geodesic_8h.html
>>
>> proj 5.0 introduces no changes to this API on in the performance
>> of the geodesic code.
>>
>>   --Charles
>>
>> On 02/09/2018 02:15 AM, Idan Miara wrote:
>>
>>> Hi,
>>>
>>> I read that there was a complete rewrite of the documentation section on
>>> geodesic calculations.
>>>
>>> Were all the changes in v5 regarding coordinate transformations?
>>> Or was there any change in API or in performance of geodesic
>>> calculations in v5?
>>>
>>> Regards,
>>> Idan
>>>
>>>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180210/0d9ed168/attachment.html>

From sebastic at xs4all.nl  Sat Feb 10 03:33:39 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 10 Feb 2018 12:33:39 +0100
Subject: [Proj] PROJ 5.0.0RC2
In-Reply-To: <6EFC908A-6078-4931-8E4D-B8C7667D4C59@gmail.com>
References: <72533D3B-CA57-45FC-96D4-D370D43E80F3@sdfe.dk>
	<c65f8e12-53d7-2bb3-23c5-cb25051eb9bc@xs4all.nl>
	<EDF05655-854F-43D4-8591-9AE897103A84@sdfe.dk>
	<c82f4b54-f5ed-6857-571d-a7f3ea292c05@xs4all.nl>
	<35D45DDB-513B-4326-BF65-CD3489D19810@sdfe.dk>
	<94730fbd-b4ae-697c-5f11-2848a6196b71@xs4all.nl>
	<CAH0YoENgGfnQzP6aM9Z2xqOV+fitNED_zQWrQ7T8v0c2S_SyuA@mail.gmail.com>
	<58DD229D-C1CA-48FC-A2D8-D9945C8AA9C4@gmail.com>
	<6EFC908A-6078-4931-8E4D-B8C7667D4C59@gmail.com>
Message-ID: <450d4dcc-83d7-041b-ecd3-f9ee3db3ea4c@xs4all.nl>

On 02/09/2018 01:50 PM, Kristian Evers wrote:
> I think the changes in this PR solves the problem: https://github.com/OSGeo/proj.4/pull/781/files <https://github.com/OSGeo/proj.4/pull/781/files>

I've included that change as patch in the Debian package, and confirmed
that Geo::Proj4 & PDL now build successfully again.

Kind Regards,

Bas


From olli.raisa at trimble.com  Mon Feb 12 00:36:01 2018
From: olli.raisa at trimble.com (=?UTF-8?B?T2xsaSBSw6Rpc8Ok?=)
Date: Mon, 12 Feb 2018 10:36:01 +0200
Subject: [Proj] Cct, proj_create_crs_to_crs and towgs84 parameters
Message-ID: <CAC8C3=g9_vx3mBgV6n-7A4iH1+KALv=3hby+Y3QGuM106F2xnw@mail.gmail.com>

Hello,

Proj-5.0.0RC2 cct outputs appear to differ from cs2cs outputs, when a
coordinate reference system has non-zero towgs84 parameters.

An example:

bin\cs2cs +init=epsg:2393 +to +init=epsg:3879
3500000 6650000 0
25611546.42     6651551.63 25.30

bin\cct -t0 +proj=pipeline +step +init=epsg:2393 +inv +step +init=epsg:3879
3500000 6650000 0
25611608.8193   6651462.4308      340.2153        0.0000

Looking at proj_create_crs_to_crs function code, I assumed that these
commands produce the same results (within some tolerance).

Regards,
Olli Räisä
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180212/7ddf92a1/attachment.html>

From kreve at sdfe.dk  Mon Feb 12 01:16:55 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Mon, 12 Feb 2018 09:16:55 +0000
Subject: [Proj] Cct, proj_create_crs_to_crs and towgs84 parameters
In-Reply-To: <CAC8C3=g9_vx3mBgV6n-7A4iH1+KALv=3hby+Y3QGuM106F2xnw@mail.gmail.com>
References: <CAC8C3=g9_vx3mBgV6n-7A4iH1+KALv=3hby+Y3QGuM106F2xnw@mail.gmail.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC164C1@S000014.PROD.SITAD.DK>

Hi Olli,

Thanks for reporting this. You assume correct. The issue has already been reported and mostly fixed. See the discussion here: https://github.com/OSGeo/proj.4/issues/783.

This should be fixed in RC3.

/Kristian

Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af Olli Räisä
Sendt: 12. februar 2018 09:36
Til: proj at lists.maptools.org
Emne: [Proj] Cct, proj_create_crs_to_crs and towgs84 parameters

Hello,

Proj-5.0.0RC2 cct outputs appear to differ from cs2cs outputs, when a coordinate reference system has non-zero towgs84 parameters.

An example:

bin\cs2cs +init=epsg:2393 +to +init=epsg:3879
3500000 6650000 0
25611546.42     6651551.63 25.30

bin\cct -t0 +proj=pipeline +step +init=epsg:2393 +inv +step +init=epsg:3879
3500000 6650000 0
25611608.8193   6651462.4308      340.2153        0.0000

Looking at proj_create_crs_to_crs function code, I assumed that these commands produce the same results (within some tolerance).

Regards,
Olli Räisä

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180212/cb1adca6/attachment.html>

From knudsen.thomas at gmail.com  Mon Feb 12 01:53:26 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Mon, 12 Feb 2018 10:53:26 +0100
Subject: [Proj] Cct, proj_create_crs_to_crs and towgs84 parameters
In-Reply-To: <CAC8C3=g9_vx3mBgV6n-7A4iH1+KALv=3hby+Y3QGuM106F2xnw@mail.gmail.com>
References: <CAC8C3=g9_vx3mBgV6n-7A4iH1+KALv=3hby+Y3QGuM106F2xnw@mail.gmail.com>
Message-ID: <CAH0YoEMhOoBv95hXmuEjd4C5=LEEDyV47zeOi4XubYsTCSzLCw@mail.gmail.com>

Hello Olli,

Thanks for testing and reporting! Your report probably relates to a bug
which has been fixed
in pull request #793 over at https://github.com/OSGeo/proj.4/pull/793

Unfortunately, the build fails, due to something which *may* be a bug in
cppcheck (the code
compiles cleanly on all platforms, but cppcheck reports a syntax error).
I'll have to look into
this before merging the PR.

Running locally, my current build reports the following on your test
material:

$ echo 3500000 6650000 0 | bin\Debug\cs2cs_d +init=epsg:2393 +to
+init=epsg:3879
25611546.42     6651551.63 25.30

$ echo 3500000 6650000 0 | bin\Debug\cct_d -t0 +proj=pipeline +step
+init=epsg:2393 +inv +step +init=epsg:3879
25611546.4190   6651551.6301       25.2952        0.0000

/Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180212/c0a4c967/attachment.html>

From kreve at sdfe.dk  Wed Feb 14 01:55:01 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 14 Feb 2018 09:55:01 +0000
Subject: [Proj] PROJ 5.0.0RC3
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC1A3FE@S000014.PROD.SITAD.DK>

All,

Last night the third release candidate for version 5.0.0 was released. Get it here:

http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz.md5)

http://download.osgeo.org/proj/proj-5.0.0RC3.zip (http://download.osgeo.org/proj/proj-5.0.0RC3.zip.md5)

In the previous two candidates many errors have been corrected so hopefully we are getting closer to the final release.
The Linux builds are starting to look solid. There has still not been any reports of serious testing on Windows. Now is the
time do so. The plan is still to have a final release around March 1st.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180214/f290e012/attachment.html>

From charles at karney.com  Wed Feb 14 05:50:23 2018
From: charles at karney.com (Charles Karney)
Date: Wed, 14 Feb 2018 08:50:23 -0500
Subject: [Proj] PROJ 5.0.0RC3
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC1A3FE@S000014.PROD.SITAD.DK>
References: <2E885BB293AF0448A0181138489E9A0EAEC1A3FE@S000014.PROD.SITAD.DK>
Message-ID: <0bd16815-e162-176a-d9fe-c3b95026077f@karney.com>

When you update the date (currently "15 february 2018") in
src/pj_release.c, remember that, in English, month names are
capitalized.

On 02/14/2018 04:55 AM, Kristian Evers wrote:
> All,
> 
> Last night the third release candidate for version 5.0.0 was released. 
> Get it here:
> 
> http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz 
> (http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz.md5)
> 
> http://download.osgeo.org/proj/proj-5.0.0RC3.zip 
> (http://download.osgeo.org/proj/proj-5.0.0RC3.zip.md5)
> 
> In the previous two candidates many errors have been corrected so 
> hopefully we are getting closer to the final release.
> 
> The Linux builds are starting to look solid. There has still not been 
> any reports of serious testing on Windows. Now is the
> 
> time do so. The plan is still to have a final release around March 1^st .
> 
> /Kristian
> 
> 
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


From kreve at sdfe.dk  Wed Feb 14 06:02:07 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 14 Feb 2018 14:02:07 +0000
Subject: [Proj] PROJ 5.0.0RC3
In-Reply-To: <0bd16815-e162-176a-d9fe-c3b95026077f@karney.com>
References: <2E885BB293AF0448A0181138489E9A0EAEC1A3FE@S000014.PROD.SITAD.DK>
	<0bd16815-e162-176a-d9fe-c3b95026077f@karney.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC1A722@S000014.PROD.SITAD.DK>

Good point, thanks Charles. Here in Denmark we don't capitalize month names so I tend to forget. At some point I will try to automate things like this in the release procedure.


-----Oprindelig meddelelse-----
Fra: Charles Karney [mailto:charles.karney at gmail.com] På vegne af Charles Karney
Sendt: 14. februar 2018 14:50
Til: PROJ.4 and general Projections Discussions <proj at lists.maptools.org>; Kristian Evers <kreve at sdfe.dk>
Emne: Re: [Proj] PROJ 5.0.0RC3

When you update the date (currently "15 february 2018") in
src/pj_release.c, remember that, in English, month names are
capitalized.

On 02/14/2018 04:55 AM, Kristian Evers wrote:
> All,
> 
> Last night the third release candidate for version 5.0.0 was released. 
> Get it here:
> 
> http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz 
> (http://download.osgeo.org/proj/proj-5.0.0RC3.tar.gz.md5)
> 
> http://download.osgeo.org/proj/proj-5.0.0RC3.zip 
> (http://download.osgeo.org/proj/proj-5.0.0RC3.zip.md5)
> 
> In the previous two candidates many errors have been corrected so 
> hopefully we are getting closer to the final release.
> 
> The Linux builds are starting to look solid. There has still not been 
> any reports of serious testing on Windows. Now is the
> 
> time do so. The plan is still to have a final release around March 1^st .
> 
> /Kristian
> 
> 
> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>


From mateusz at loskot.net  Wed Feb 14 06:57:02 2018
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 14 Feb 2018 15:57:02 +0100
Subject: [Proj] PROJ 5.0.0RC3
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC1A722@S000014.PROD.SITAD.DK>
References: <2E885BB293AF0448A0181138489E9A0EAEC1A3FE@S000014.PROD.SITAD.DK>
	<0bd16815-e162-176a-d9fe-c3b95026077f@karney.com>
	<2E885BB293AF0448A0181138489E9A0EAEC1A722@S000014.PROD.SITAD.DK>
Message-ID: <CABUeae8rTxVqLNdi8pf4zkrKGQa6BbYjuf-wqZt_otL2HY=9mQ@mail.gmail.com>

On 14 February 2018 at 15:02, Kristian Evers <kreve at sdfe.dk> wrote:
> At some point I will try to automate things like this in the release procedure.

With CMake 3.7 [1] or later, it is possible to generate the date with TIMESTAMP

string(TIMESTAMP RELEASE_DATE "%d %b %Y")

The date could be also added to project-config-version.cmake.in

With CMake 3.10 [2] or later there should be the %B for long month
name available.

I'm not sure if that would help for source package generation though.

Alternatively, at release point, generate VERSION and RELEASED text
one-liner files which are read by CMake and all config header etc. is generated.

[1] https://cmake.org/cmake/help/v3.9/release/3.7.html
[3] https://gitlab.kitware.com/cmake/cmake/merge_requests/1228

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net


From matthias.gabriel at etit.tu-chemnitz.de  Mon Feb 19 07:07:49 2018
From: matthias.gabriel at etit.tu-chemnitz.de (Matthias Gabriel)
Date: Mon, 19 Feb 2018 16:07:49 +0100
Subject: [Proj] Problem understanding the new API
Message-ID: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>

Hi,

I've been using the old proj4 API successfully an did understand that by 
specifying source and target systems i could transform my coordinates. 
Now I tried to use the new API (proj.h) which seems to be much cleaner 
and easier to use. I checked the manual and found:

"the fundamental concept of transformations in PROJ are now handled in a 
single transformation object (PJ) and not by stating the source and 
destination systems as previously."

Ok, fine.. understood. Unfortunately my problem definition is still the 
same: given a set of coordinates in source system A I want to calculate 
their representation in system B. ..

So before it was straight-forward: I specified what I had and what I 
wanted, but now I don't know how to get the required "direct 
transformation" from A to B using the new API?! I tried to use a 
cs2cs-style string with the "+to" specifier  but that didn't work. 
proj_create_crs_to_crs would be an option but doesn't quite suit my 
problem (we don't use EPSG codes etm).

Could you please give me a hint on how to proceed here?

Best Regards,
Matthias


From knudsen.thomas at gmail.com  Mon Feb 19 09:44:03 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Mon, 19 Feb 2018 18:44:03 +0100
Subject: [Proj] Problem understanding the new API
In-Reply-To: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
Message-ID: <CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>

Matthias,

Note that the old API is still available - the new, however, introduces
methods that are needed in order to obtain high accuracy transformations.

The world view represented by the old API is always sufficient if all you
care about is meter level accuracy - and in many cases it will provide much
higher accuracy than that. But the view that “WGS84 is the *true*
foundation of the world, and everything else can be transformed natively to
and from WGS84” is inherently flawed.

First and foremost because any time WGS84 is mentioned, you should ask
yourself “Which of the six WGS84 realizations are we talking about here?”.

Second, because for many (especially legacy) systems, it may not be
straightforward to transform to WGS84 (or actually ITRF-something,
ETRS-something or NAD-something which appear to be the practical meaning of
the term WGS84 in everyday PROJ related work), while centimeter-level
accurate transformations may exist between pairs of older systems.

The concept of a pivot reference frame (“datum”) is not inherently bad, but
in many cases you need to handle and select that datum with more care than
the old API allows. The primary aim of the new API is to allow just that.
And to do that, you must realize that the world is inherently 4
dimensional. You may in many cases assume one or more of the coordinates to
be constant, but basically, to obtain geodetic accuracy transformations,
you need to work in 4 dimensions.

Now, having described the background for introducing the new API, I (being
the architect and primary - but certainly not sole - implementer of the new
API) should probably also try to reply to your request for a hint about how
to use it.

First note that in order to go from system A to system B, the old API
starts by doing an INVERSE transformation from system A to WGS84, then does
a FORWARD transformation from WGS84 to system B.

With cs2cs being the command line interface to the old API, and cct being
the same for the new, I think this example of doing the same thing in both
world views will probably be ample hinting for you:

$ echo 300000 6100000 | cs2cs_d +proj=utm +zone=33 +ellps=GRS80 +to
+proj=utm +zone=32 +ellps=GRS80

683687.87       6099299.66 0.00

$ echo 300000 6100000 0 0 | cct +proj=pipeline +step +inv +proj=utm
+zone=33 +ellps=GRS80 +step +proj=utm +zone=32 +ellps=GRS80

683687.8667   6099299.6624    0.0000    0.0000


(lookout for the "+inv" in the first +step, indicating an inverse
transform).

/Thomas


2018-02-19 16:07 GMT+01:00 Matthias Gabriel <
matthias.gabriel at etit.tu-chemnitz.de>:

> Hi,
>
> I've been using the old proj4 API successfully an did understand that by
> specifying source and target systems i could transform my coordinates.
> Now I tried to use the new API (proj.h) which seems to be much cleaner
> and easier to use. I checked the manual and found:
>
> "the fundamental concept of transformations in PROJ are now handled in a
> single transformation object (PJ) and not by stating the source and
> destination systems as previously."
>
> Ok, fine.. understood. Unfortunately my problem definition is still the
> same: given a set of coordinates in source system A I want to calculate
> their representation in system B. ..
>
> So before it was straight-forward: I specified what I had and what I
> wanted, but now I don't know how to get the required "direct
> transformation" from A to B using the new API?! I tried to use a
> cs2cs-style string with the "+to" specifier  but that didn't work.
> proj_create_crs_to_crs would be an option but doesn't quite suit my
> problem (we don't use EPSG codes etm).
>
> Could you please give me a hint on how to proceed here?
>
> Best Regards,
> Matthias
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180219/9ed165df/attachment.html>

From stevejking at talktalk.net  Mon Feb 19 11:26:45 2018
From: stevejking at talktalk.net (stevejking)
Date: Mon, 19 Feb 2018 12:26:45 -0700 (MST)
Subject: [Proj] Problem understanding the new API
In-Reply-To: <CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
Message-ID: <1519068405858-0.post@n6.nabble.com>

Thomas,
Thanks for explaining the +inv bit.

Great to see Proj being brought up to date, fit for the future. And free!

Worth mentioning the pipeline string I believe can be stored in a init file,
rather than baking it into code.

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From matthias.gabriel at etit.tu-chemnitz.de  Mon Feb 19 12:16:22 2018
From: matthias.gabriel at etit.tu-chemnitz.de (Matthias Gabriel)
Date: Mon, 19 Feb 2018 21:16:22 +0100
Subject: [Proj] Problem understanding the new API
In-Reply-To: <CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
Message-ID: <B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>

Hi Thomas,

thank your for your fast and very helpful answer! indeed that makes it much clearer... Maybe that usecase could be part of the upcoming documentation as I believe it's very common...

I got one follow up question: In which coordinate system is the"result" of the first part of your pipeline, the"inverse" utm projection, defined? I understand that the transformation is "taking" a utm coordinate pair as argument but what does it actually calculate?

Again: thanks a lot, your answer was very helpful!

Regards,
Matthias

On 19 February 2018 18:44:03 CET, Thomas Knudsen <knudsen.thomas at gmail.com> wrote:
>Matthias,
>
>Note that the old API is still available - the new, however, introduces
>methods that are needed in order to obtain high accuracy
>transformations.
>
>The world view represented by the old API is always sufficient if all
>you
>care about is meter level accuracy - and in many cases it will provide
>much
>higher accuracy than that. But the view that “WGS84 is the *true*
>foundation of the world, and everything else can be transformed
>natively to
>and from WGS84” is inherently flawed.
>
>First and foremost because any time WGS84 is mentioned, you should ask
>yourself “Which of the six WGS84 realizations are we talking about
>here?”.
>
>Second, because for many (especially legacy) systems, it may not be
>straightforward to transform to WGS84 (or actually ITRF-something,
>ETRS-something or NAD-something which appear to be the practical
>meaning of
>the term WGS84 in everyday PROJ related work), while centimeter-level
>accurate transformations may exist between pairs of older systems.
>
>The concept of a pivot reference frame (“datum”) is not inherently bad,
>but
>in many cases you need to handle and select that datum with more care
>than
>the old API allows. The primary aim of the new API is to allow just
>that.
>And to do that, you must realize that the world is inherently 4
>dimensional. You may in many cases assume one or more of the
>coordinates to
>be constant, but basically, to obtain geodetic accuracy
>transformations,
>you need to work in 4 dimensions.
>
>Now, having described the background for introducing the new API, I
>(being
>the architect and primary - but certainly not sole - implementer of the
>new
>API) should probably also try to reply to your request for a hint about
>how
>to use it.
>
>First note that in order to go from system A to system B, the old API
>starts by doing an INVERSE transformation from system A to WGS84, then
>does
>a FORWARD transformation from WGS84 to system B.
>
>With cs2cs being the command line interface to the old API, and cct
>being
>the same for the new, I think this example of doing the same thing in
>both
>world views will probably be ample hinting for you:
>
>$ echo 300000 6100000 | cs2cs_d +proj=utm +zone=33 +ellps=GRS80 +to
>+proj=utm +zone=32 +ellps=GRS80
>
>683687.87       6099299.66 0.00
>
>$ echo 300000 6100000 0 0 | cct +proj=pipeline +step +inv +proj=utm
>+zone=33 +ellps=GRS80 +step +proj=utm +zone=32 +ellps=GRS80
>
>683687.8667   6099299.6624    0.0000    0.0000
>
>
>(lookout for the "+inv" in the first +step, indicating an inverse
>transform).
>
>/Thomas
>
>
>2018-02-19 16:07 GMT+01:00 Matthias Gabriel <
>matthias.gabriel at etit.tu-chemnitz.de>:
>
>> Hi,
>>
>> I've been using the old proj4 API successfully an did understand that
>by
>> specifying source and target systems i could transform my
>coordinates.
>> Now I tried to use the new API (proj.h) which seems to be much
>cleaner
>> and easier to use. I checked the manual and found:
>>
>> "the fundamental concept of transformations in PROJ are now handled
>in a
>> single transformation object (PJ) and not by stating the source and
>> destination systems as previously."
>>
>> Ok, fine.. understood. Unfortunately my problem definition is still
>the
>> same: given a set of coordinates in source system A I want to
>calculate
>> their representation in system B. ..
>>
>> So before it was straight-forward: I specified what I had and what I
>> wanted, but now I don't know how to get the required "direct
>> transformation" from A to B using the new API?! I tried to use a
>> cs2cs-style string with the "+to" specifier  but that didn't work.
>> proj_create_crs_to_crs would be an option but doesn't quite suit my
>> problem (we don't use EPSG codes etm).
>>
>> Could you please give me a hint on how to proceed here?
>>
>> Best Regards,
>> Matthias
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj

--
M.Sc. Matthias Gabriel
Fakultät für Elektrotechnik und Informationstechnik

Technische Universität Chemnitz
Reichenhainer Straße 70 | R. W440
09126 Chemnitz
Germany

Tel: +49 371 531-34458
Fax: +49 371 531-834458 

matthias.gabriel at etit.tu-chemnitz.de www.tu-chemnitz.de
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180219/c878d9fb/attachment.html>

From stevejking at talktalk.net  Mon Feb 19 13:49:46 2018
From: stevejking at talktalk.net (stevejking)
Date: Mon, 19 Feb 2018 14:49:46 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
Message-ID: <1519076986468-0.post@n6.nabble.com>

Hi 
When using cs2cs I don’t need to specify the path to gridfile (eg nadgrids
and geoidgrids). 
But with the new cct I find I get “cct: Bad transformation arguments -
(failed to load datum shift file)” unless I give full path. 
Using Windows 7 64 bit

Proj installed to 
C:\proj-5.0.0RC3\proj-5.0.0
Grids present in nad sub folder

Grids Also copied in
C:\proj\nad


Regards
Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kristianevers at gmail.com  Mon Feb 19 14:03:03 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Mon, 19 Feb 2018 23:03:03 +0100
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519076986468-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
Message-ID: <00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>

HI Steve,

If you start by setting the PROJ_LIB variable you should be fine:

	set PROJ_LIB=C:\proj-5.0.0-RC3\proj-5.0.0\nad
	cct +proj=…

At least that should let you work around this for now. You can also define it properly in the Windows settings as a persistent environment variable if you don’t want to set it on the command line each time you open a new terminal-window.

I will investigate why cct doesn’t find the grids. It seems odd to me.

/Kristian


> On 19 Feb 2018, at 22:49, stevejking <stevejking at talktalk.net> wrote:
> 
> Hi 
> When using cs2cs I don’t need to specify the path to gridfile (eg nadgrids
> and geoidgrids). 
> But with the new cct I find I get “cct: Bad transformation arguments -
> (failed to load datum shift file)” unless I give full path. 
> Using Windows 7 64 bit
> 
> Proj installed to 
> C:\proj-5.0.0RC3\proj-5.0.0
> Grids present in nad sub folder
> 
> Grids Also copied in
> C:\proj\nad
> 
> 
> Regards
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From knudsen.thomas at gmail.com  Mon Feb 19 14:12:40 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Mon, 19 Feb 2018 23:12:40 +0100
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
Message-ID: <CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>

Steve,

Could you provide a few samples of full actual invocations, indicating
which succeed and which fail?

Also please check whether Kristan's suggestion of setting PROJ_LIB helps.

/Thomas

Den 19. feb. 2018 11.04 PM skrev "Kristian Evers" <kristianevers at gmail.com>:

> HI Steve,
>
> If you start by setting the PROJ_LIB variable you should be fine:
>
>         set PROJ_LIB=C:\proj-5.0.0-RC3\proj-5.0.0\nad
>         cct +proj=…
>
> At least that should let you work around this for now. You can also define
> it properly in the Windows settings as a persistent environment variable if
> you don’t want to set it on the command line each time you open a new
> terminal-window.
>
> I will investigate why cct doesn’t find the grids. It seems odd to me.
>
> /Kristian
>
>
> > On 19 Feb 2018, at 22:49, stevejking <stevejking at talktalk.net> wrote:
> >
> > Hi
> > When using cs2cs I don’t need to specify the path to gridfile (eg
> nadgrids
> > and geoidgrids).
> > But with the new cct I find I get “cct: Bad transformation arguments -
> > (failed to load datum shift file)” unless I give full path.
> > Using Windows 7 64 bit
> >
> > Proj installed to
> > C:\proj-5.0.0RC3\proj-5.0.0
> > Grids present in nad sub folder
> >
> > Grids Also copied in
> > C:\proj\nad
> >
> >
> > Regards
> > Steve
> >
> >
> >
> > --
> > Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180219/1cbe1c43/attachment.html>

From kreve at sdfe.dk  Mon Feb 19 15:04:26 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Mon, 19 Feb 2018 23:04:26 +0000
Subject: [Proj] Problem understanding the new API
In-Reply-To: <B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
	<B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>
Message-ID: <3D20E619-98BD-40C6-86C7-580F95CA1809@sdfe.dk>

Matthias,

Let me try to answer on Thomas’ behalf:

> On 19 Feb 2018, at 21:16, Matthias Gabriel <matthias.gabriel at etit.tu-chemnitz.de> wrote:
> 
> Hi Thomas,
> 
> thank your for your fast and very helpful answer! indeed that makes it much clearer... Maybe that usecase could be part of the upcoming documentation as I believe it's very common…
> 

I have added Thomas’ answer to the API migration guide. See a preview of the 5.0.0 docs here: https://kbevers.github.io/development/migration.html


> I got one follow up question: In which coordinate system is the"result" of the first part of your pipeline, the"inverse" utm projection, defined?

The coordinate system in the first part is just UTM Zone 33 on the GRS80 ellipsoid. In Thomas’ example there is not any datum attached to the coordinate system, which I think is what you are really asking. UTM is just a projection that converts coordinates on the sphere/ellipsoid onto the plane. That’s it. Thomas’ example though, is also a good explanation  of what happens in the old API, if we say that the thing that the input coordinates are converted to is WGS84 geodetic coordinates. WGS84 is used as the hub-datum in cs2cs and pj_transform() from the old API. The last step of the pipeline-example converts of course from WGS84 to UTM32. Of course with the old API it is also possible to use parameters such as +towgs84 that defines a set of parameters for a Helmert transformation going from whatever datum your coordinates are in TO WGS84. Depending on whether the proj-string is used as the source og destination system.


> I understand that the transformation is "taking" a utm coordinate pair as argument but what does it actually calculate?
> 

So in summation, the transformation calculates the corresponding geodetic coordinate of that particular UTM coordinate. The next step converts the geodetic coordinate to UTM again, albeit a different zone this time.

Thomas and I wrote a paper about this concept last year in which we go into some more details about how the pipeline setup works. It might be of interest to you: http://www.fig.net/resources/proceedings/fig_proceedings/fig2017/papers/iss6b/ISS6B_evers_knudsen_9156.pdf

/Kristian

> Again: thanks a lot, your answer was very helpful!
> 
> Regards,
> Matthias
> 
> On 19 February 2018 18:44:03 CET, Thomas Knudsen <knudsen.thomas at gmail.com> wrote:
> 
> Matthias,
> 
> Note that the old API is still available - the new, however, introduces methods that are needed in order to obtain high accuracy transformations.
> 
> The world view represented by the old API is always sufficient if all you care about is meter level accuracy - and in many cases it will provide much higher accuracy than that. But the view that “WGS84 is the *true* foundation of the world, and everything else can be transformed natively to and from WGS84” is inherently flawed.
> 
> First and foremost because any time WGS84 is mentioned, you should ask yourself “Which of the six WGS84 realizations are we talking about here?”.
> 
> Second, because for many (especially legacy) systems, it may not be straightforward to transform to WGS84 (or actually ITRF-something, ETRS-something or NAD-something which appear to be the practical meaning of the term WGS84 in everyday PROJ related work), while centimeter-level accurate transformations may exist between pairs of older systems.
> 
> The concept of a pivot reference frame (“datum”) is not inherently bad, but in many cases you need to handle and select that datum with more care than the old API allows. The primary aim of the new API is to allow just that. And to do that, you must realize that the world is inherently 4 dimensional. You may in many cases assume one or more of the coordinates to be constant, but basically, to obtain geodetic accuracy transformations, you need to work in 4 dimensions.
> 
> Now, having described the background for introducing the new API, I (being the architect and primary - but certainly not sole - implementer of the new API) should probably also try to reply to your request for a hint about how to use it.
> 
> First note that in order to go from system A to system B, the old API starts by doing an INVERSE transformation from system A to WGS84, then does a FORWARD transformation from WGS84 to system B.
> 
> With cs2cs being the command line interface to the old API, and cct being the same for the new, I think this example of doing the same thing in both world views will probably be ample hinting for you:
> 
> $ echo 300000 6100000 | cs2cs_d +proj=utm +zone=33 +ellps=GRS80 +to +proj=utm +zone=32 +ellps=GRS80
> 
> 683687.87       6099299.66 0.00
>       
> $ echo 300000 6100000 0 0 | cct +proj=pipeline +step +inv +proj=utm +zone=33 +ellps=GRS80 +step +proj=utm +zone=32 +ellps=GRS80
> 
> 683687.8667   6099299.6624    0.0000    0.0000
> 
> 
> (lookout for the "+inv" in the first +step, indicating an inverse transform).
> 
> /Thomas
> 
> 
> 2018-02-19 16:07 GMT+01:00 Matthias Gabriel <matthias.gabriel at etit.tu-chemnitz.de>:
> Hi,
> 
> I've been using the old proj4 API successfully an did understand that by
> specifying source and target systems i could transform my coordinates.
> Now I tried to use the new API (proj.h) which seems to be much cleaner
> and easier to use. I checked the manual and found:
> 
> "the fundamental concept of transformations in PROJ are now handled in a
> single transformation object (PJ) and not by stating the source and
> destination systems as previously."
> 
> Ok, fine.. understood. Unfortunately my problem definition is still the
> same: given a set of coordinates in source system A I want to calculate
> their representation in system B. ..
> 
> So before it was straight-forward: I specified what I had and what I
> wanted, but now I don't know how to get the required "direct
> transformation" from A to B using the new API?! I tried to use a
> cs2cs-style string with the "+to" specifier  but that didn't work.
> proj_create_crs_to_crs would be an option but doesn't quite suit my
> problem (we don't use EPSG codes etm).
> 
> Could you please give me a hint on how to proceed here?
> 
> Best Regards,
> Matthias
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> 
> 
> --
> M.Sc. Matthias Gabriel
> Fakultät für Elektrotechnik und Informationstechnik
> 
> Technische Universität Chemnitz
> Reichenhainer Straße 70 | R. W440
> 09126 Chemnitz
> Germany
> 
> Tel: +49 371 531-34458
> Fax: +49 371 531-834458 
> 
> matthias.gabriel at etit.tu-chemnitz.de www.tu-chemnitz.de_______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From idan at miara.com  Mon Feb 19 21:21:30 2018
From: idan at miara.com (Idan Miara)
Date: Tue, 20 Feb 2018 07:21:30 +0200
Subject: [Proj] Problem understanding the new API
In-Reply-To: <3D20E619-98BD-40C6-86C7-580F95CA1809@sdfe.dk>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
	<B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>
	<3D20E619-98BD-40C6-86C7-580F95CA1809@sdfe.dk>
Message-ID: <CAEDrt3-OFBM9q7J70zwJ_uzq4PK7++g3d-0rOUgPC909mjKEXA@mail.gmail.com>

Hi,

Which CRS is exactly the hub in the old API? Is it WGS84 lat/lon or
geocentric?
Should it be more accurate or faster to use the new API to transform WGS84
lat/lon to WGS84 UTM,  will it use any different transformation path?

Thanks.

On 20 Feb 2018 01:10, "Kristian Evers" <kreve at sdfe.dk> wrote:

> Matthias,
>
> Let me try to answer on Thomas’ behalf:
>
> > On 19 Feb 2018, at 21:16, Matthias Gabriel <matthias.gabriel at etit.tu-
> chemnitz.de> wrote:
> >
> > Hi Thomas,
> >
> > thank your for your fast and very helpful answer! indeed that makes it
> much clearer... Maybe that usecase could be part of the upcoming
> documentation as I believe it's very common…
> >
>
> I have added Thomas’ answer to the API migration guide. See a preview of
> the 5.0.0 docs here: https://kbevers.github.io/development/migration.html
>
>
> > I got one follow up question: In which coordinate system is the"result"
> of the first part of your pipeline, the"inverse" utm projection, defined?
>
> The coordinate system in the first part is just UTM Zone 33 on the GRS80
> ellipsoid. In Thomas’ example there is not any datum attached to the
> coordinate system, which I think is what you are really asking. UTM is just
> a projection that converts coordinates on the sphere/ellipsoid onto the
> plane. That’s it. Thomas’ example though, is also a good explanation  of
> what happens in the old API, if we say that the thing that the input
> coordinates are converted to is WGS84 geodetic coordinates. WGS84 is used
> as the hub-datum in cs2cs and pj_transform() from the old API. The last
> step of the pipeline-example converts of course from WGS84 to UTM32. Of
> course with the old API it is also possible to use parameters such as
> +towgs84 that defines a set of parameters for a Helmert transformation
> going from whatever datum your coordinates are in TO WGS84. Depending on
> whether the proj-string is used as the source og destination system.
>
>
> > I understand that the transformation is "taking" a utm coordinate pair
> as argument but what does it actually calculate?
> >
>
> So in summation, the transformation calculates the corresponding geodetic
> coordinate of that particular UTM coordinate. The next step converts the
> geodetic coordinate to UTM again, albeit a different zone this time.
>
> Thomas and I wrote a paper about this concept last year in which we go
> into some more details about how the pipeline setup works. It might be of
> interest to you: http://www.fig.net/resources/proceedings/fig_proceedings/
> fig2017/papers/iss6b/ISS6B_evers_knudsen_9156.pdf
>
> /Kristian
>
> > Again: thanks a lot, your answer was very helpful!
> >
> > Regards,
> > Matthias
> >
> > On 19 February 2018 18:44:03 CET, Thomas Knudsen <
> knudsen.thomas at gmail.com> wrote:
> >
> > Matthias,
> >
> > Note that the old API is still available - the new, however, introduces
> methods that are needed in order to obtain high accuracy transformations.
> >
> > The world view represented by the old API is always sufficient if all
> you care about is meter level accuracy - and in many cases it will provide
> much higher accuracy than that. But the view that “WGS84 is the *true*
> foundation of the world, and everything else can be transformed natively to
> and from WGS84” is inherently flawed.
> >
> > First and foremost because any time WGS84 is mentioned, you should ask
> yourself “Which of the six WGS84 realizations are we talking about here?”.
> >
> > Second, because for many (especially legacy) systems, it may not be
> straightforward to transform to WGS84 (or actually ITRF-something,
> ETRS-something or NAD-something which appear to be the practical meaning of
> the term WGS84 in everyday PROJ related work), while centimeter-level
> accurate transformations may exist between pairs of older systems.
> >
> > The concept of a pivot reference frame (“datum”) is not inherently bad,
> but in many cases you need to handle and select that datum with more care
> than the old API allows. The primary aim of the new API is to allow just
> that. And to do that, you must realize that the world is inherently 4
> dimensional. You may in many cases assume one or more of the coordinates to
> be constant, but basically, to obtain geodetic accuracy transformations,
> you need to work in 4 dimensions.
> >
> > Now, having described the background for introducing the new API, I
> (being the architect and primary - but certainly not sole - implementer of
> the new API) should probably also try to reply to your request for a hint
> about how to use it.
> >
> > First note that in order to go from system A to system B, the old API
> starts by doing an INVERSE transformation from system A to WGS84, then does
> a FORWARD transformation from WGS84 to system B.
> >
> > With cs2cs being the command line interface to the old API, and cct
> being the same for the new, I think this example of doing the same thing in
> both world views will probably be ample hinting for you:
> >
> > $ echo 300000 6100000 | cs2cs_d +proj=utm +zone=33 +ellps=GRS80 +to
> +proj=utm +zone=32 +ellps=GRS80
> >
> > 683687.87       6099299.66 0.00
> >
> > $ echo 300000 6100000 0 0 | cct +proj=pipeline +step +inv +proj=utm
> +zone=33 +ellps=GRS80 +step +proj=utm +zone=32 +ellps=GRS80
> >
> > 683687.8667   6099299.6624    0.0000    0.0000
> >
> >
> > (lookout for the "+inv" in the first +step, indicating an inverse
> transform).
> >
> > /Thomas
> >
> >
> > 2018-02-19 16:07 GMT+01:00 Matthias Gabriel <matthias.gabriel at etit.tu-
> chemnitz.de>:
> > Hi,
> >
> > I've been using the old proj4 API successfully an did understand that by
> > specifying source and target systems i could transform my coordinates.
> > Now I tried to use the new API (proj.h) which seems to be much cleaner
> > and easier to use. I checked the manual and found:
> >
> > "the fundamental concept of transformations in PROJ are now handled in a
> > single transformation object (PJ) and not by stating the source and
> > destination systems as previously."
> >
> > Ok, fine.. understood. Unfortunately my problem definition is still the
> > same: given a set of coordinates in source system A I want to calculate
> > their representation in system B. ..
> >
> > So before it was straight-forward: I specified what I had and what I
> > wanted, but now I don't know how to get the required "direct
> > transformation" from A to B using the new API?! I tried to use a
> > cs2cs-style string with the "+to" specifier  but that didn't work.
> > proj_create_crs_to_crs would be an option but doesn't quite suit my
> > problem (we don't use EPSG codes etm).
> >
> > Could you please give me a hint on how to proceed here?
> >
> > Best Regards,
> > Matthias
> > _______________________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
> >
> >
> > --
> > M.Sc. Matthias Gabriel
> > Fakultät für Elektrotechnik und Informationstechnik
> >
> > Technische Universität Chemnitz
> > Reichenhainer Straße 70 | R. W440
> > 09126 Chemnitz
> > Germany
> >
> > Tel: +49 371 531-34458
> > Fax: +49 371 531-834458
> >
> > matthias.gabriel at etit.tu-chemnitz.de www.tu-chemnitz.de____________
> ___________________________________
> > Proj mailing list
> > Proj at lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/proj
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180220/418adafe/attachment.html>

From kreve at sdfe.dk  Mon Feb 19 22:44:27 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 20 Feb 2018 06:44:27 +0000
Subject: [Proj] Problem understanding the new API
In-Reply-To: <CAEDrt3-OFBM9q7J70zwJ_uzq4PK7++g3d-0rOUgPC909mjKEXA@mail.gmail.com>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
	<B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>
	<3D20E619-98BD-40C6-86C7-580F95CA1809@sdfe.dk>
	<CAEDrt3-OFBM9q7J70zwJ_uzq4PK7++g3d-0rOUgPC909mjKEXA@mail.gmail.com>
Message-ID: <34B05F96-345B-4A57-A440-207D0137DB0B@sdfe.dk>



> On 20 Feb 2018, at 06:21, Idan Miara <idan at miara.com> wrote:
> 
> Hi,
> 
> Which CRS is exactly the hub in the old API? Is it WGS84 lat/lon or geocentric?

WGS84 lat/lon, although if necessary the coordinates are passed through a geocentric WGS84 (when using +towgs84).

> Should it be more accurate or faster to use the new API to transform WGS84 lat/lon to WGS84 UTM,  will it use any different transformation path?
> 

Well… It can be more accurate if you know which WGS84 realisation you are working in,  you have timestamps for your data AND you define your own custom transformation. Otherwise the accuracy will be the same. If you don’t know anything about your data then assume that the uncertainty of the transformation is 2m. If it is faster will depend on what you are doing. Initial testing show that the old and new APIs perform more or less the same for similar transformations. In general transformations will probably be slightly slower since more complicated transformations can be done now.

You CAN use a different transformation path if you want - and know how to - otherwise no, the transformation path will be the same for now, for example if you are using the epss-init file with the proj_create_crs_to_crs function. At the moment using a different transformation path requires you to set up a transformation pipeline that does what you want. In the future we will improve the situation such that at least the epsg transformations uses the optimal transformation path in a given situation.

> Thanks. 
> 


From idan at miara.com  Mon Feb 19 22:51:40 2018
From: idan at miara.com (Idan Miara)
Date: Tue, 20 Feb 2018 08:51:40 +0200
Subject: [Proj] Problem understanding the new API
In-Reply-To: <34B05F96-345B-4A57-A440-207D0137DB0B@sdfe.dk>
References: <fb22fba0-46d0-76bc-e450-3a7abe9ea3a3@etit.tu-chemnitz.de>
	<CAH0YoEMVhkYbJMBce83RM+19d8t_Ymy4b=ATOPLFdXBKhaHD8A@mail.gmail.com>
	<B177D0BD-EBE3-454D-8056-362038B17D54@etit.tu-chemnitz.de>
	<3D20E619-98BD-40C6-86C7-580F95CA1809@sdfe.dk>
	<CAEDrt3-OFBM9q7J70zwJ_uzq4PK7++g3d-0rOUgPC909mjKEXA@mail.gmail.com>
	<34B05F96-345B-4A57-A440-207D0137DB0B@sdfe.dk>
Message-ID: <CAEDrt3-tnxN-TZPU1Pn1UwQHF0WWosJX--M70WLA3Nsmz5dB2Q@mail.gmail.com>

Thanks.
I appreciate your detailed answer!

On 20 Feb 2018 08:46, "Kristian Evers" <kreve at sdfe.dk> wrote:

>
>
> > On 20 Feb 2018, at 06:21, Idan Miara <idan at miara.com> wrote:
> >
> > Hi,
> >
> > Which CRS is exactly the hub in the old API? Is it WGS84 lat/lon or
> geocentric?
>
> WGS84 lat/lon, although if necessary the coordinates are passed through a
> geocentric WGS84 (when using +towgs84).
>
> > Should it be more accurate or faster to use the new API to transform
> WGS84 lat/lon to WGS84 UTM,  will it use any different transformation path?
> >
>
> Well… It can be more accurate if you know which WGS84 realisation you are
> working in,  you have timestamps for your data AND you define your own
> custom transformation. Otherwise the accuracy will be the same. If you
> don’t know anything about your data then assume that the uncertainty of the
> transformation is 2m. If it is faster will depend on what you are doing.
> Initial testing show that the old and new APIs perform more or less the
> same for similar transformations. In general transformations will probably
> be slightly slower since more complicated transformations can be done now.
>
> You CAN use a different transformation path if you want - and know how to
> - otherwise no, the transformation path will be the same for now, for
> example if you are using the epss-init file with the proj_create_crs_to_crs
> function. At the moment using a different transformation path requires you
> to set up a transformation pipeline that does what you want. In the future
> we will improve the situation such that at least the epsg transformations
> uses the optimal transformation path in a given situation.
>
> > Thanks.
> >
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180220/d4e076d5/attachment.html>

From stevejking at talktalk.net  Mon Feb 19 23:48:04 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 20 Feb 2018 00:48:04 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
Message-ID: <1519112884763-0.post@n6.nabble.com>

Hi Thomas & Kristian,
Thanks for the replies.

Yes, setting PROJ-LIB works as a temporary fix.

I've uploaded the cs2cs and cct strings, grid files and a couple of
coordinate pairs. In a bit of a hurry this morning.
https://1drv.ms/f/s!AvBQ7Pt73oO6iGeGDh4livK-EKAJ Hope that helps.

The cs2cs one works fine, the cct one has the above error, but works if the
full path to gridfiles is given. 

Steve




--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Tue Feb 20 00:33:16 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 20 Feb 2018 08:33:16 +0000
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519112884763-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC4396D@S000014.PROD.SITAD.DK>

Steve,

I haven't looked into why you have a problem, but I immediately notice that with the way you use cct, you might as well just use cs2cs. At least for this this transformation - I appreciate the interest in using the new tools though. So for the sake of demonstration I wanted to show how the "correct" way to do the transformation in question cct is:

You now have:

cs2cs +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +to +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +units=m +no_defs

which you then try to replicate with ctt:

cct -t0 +proj=pipeline +step +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +inv +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +units=m +no_defs

There's a few things that can be simplified.

1. you don't need the first +proj=longlat (remember, we are not describing the input and output, but the recipe to go from input to output)
2. The +no_defs are unnecessary unless you use aea, lcc or the lagrng projections.
3. the +nadgrids and +geoidgrids are now considered deprecated - instead +proj=hgridshift and +proj=vgridshift should be used as individual steps in a pipeline

So with that in mind, here's how I would set up the transformation with cct:

Cct -t0 +proj=pipeline +step +proj=hgridshift +grids=OSTN15_NTv2_OSGBtoETRS.gsb \
                                        +step +proj=vgridshift +grids=OSGM15_GTX_OSGBtoGRS80.gtx \
                                        +step +proj=tmerc ++lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy

So first I ignore the input system you originally defined since it is basically a no-op using +proj=latlong. Afther that I define two steps that handle the datumshift by means of horizontal and vertical grids. In the last step I apply the transverse Mercator projection.

I hope this gives a better understanding of the differences between the two approaches to transformations in PROJ.

/Kristian

Ps. The above is untested - it might contain some errors but the general idea should be clear I think.

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
Sendt: 20. februar 2018 08:48
Til: proj at lists.maptools.org
Emne: Re: [Proj] Proj-5.0.0 cct path to gridfiles

Hi Thomas & Kristian,
Thanks for the replies.

Yes, setting PROJ-LIB works as a temporary fix.

I've uploaded the cs2cs and cct strings, grid files and a couple of
coordinate pairs. In a bit of a hurry this morning.
https://1drv.ms/f/s!AvBQ7Pt73oO6iGeGDh4livK-EKAJ Hope that helps.

The cs2cs one works fine, the cct one has the above error, but works if the
full path to gridfiles is given. 

Steve




--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From kreve at sdfe.dk  Tue Feb 20 03:02:22 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 20 Feb 2018 11:02:22 +0000
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519112884763-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>

Steve,

I have looked into this a bit further and I still don't understand what's going on. Can you describe in more details how you've compiled and installed PROJ? I need a complete walkthrough of the commands you've issued to come the conclusion that cct doesn't find the grids.

Thanks,
Kristian

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
Sendt: 20. februar 2018 08:48
Til: proj at lists.maptools.org
Emne: Re: [Proj] Proj-5.0.0 cct path to gridfiles

Hi Thomas & Kristian,
Thanks for the replies.

Yes, setting PROJ-LIB works as a temporary fix.

I've uploaded the cs2cs and cct strings, grid files and a couple of
coordinate pairs. In a bit of a hurry this morning.
https://1drv.ms/f/s!AvBQ7Pt73oO6iGeGDh4livK-EKAJ Hope that helps.

The cs2cs one works fine, the cct one has the above error, but works if the
full path to gridfiles is given. 

Steve




--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From stevejking at talktalk.net  Tue Feb 20 08:20:48 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 20 Feb 2018 09:20:48 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
Message-ID: <1519143648395-0.post@n6.nabble.com>

Thanks for to suggestions, but the grids are lat/long grids realised on the
Airy ellipsoid and go from OSGB lat/long to Etrs lat/long and height. So
think I’d need to apply the grids in the reverse direction/reverse sign (if
that’s possible in the api) to first get Airy ellipsoid lat longs, then step
to my final projection. They work with cs2cs so that fine for now.

I’ll try to summarise the steps I did, as I’m not likely at my computer
today.

I installed RC3 using visual studio 2017 community edition. From a VS prompt
(I’d need to check, maybe re install as can’t recall if it was 32 or 64 bit
prompt, or might have a check in Dependency Walker). I used the soon to
depreciate nmake commands listed in the readme (two or three lines).

I used a regular command prompt, navigated to the bin directory, then typed
the cs2cs and cct strings as you list above.

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From stevejking at talktalk.net  Tue Feb 20 08:41:31 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 20 Feb 2018 09:41:31 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519143648395-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
	<1519143648395-0.post@n6.nabble.com>
Message-ID: <1519144891525-0.post@n6.nabble.com>

Actually reversing the sign would not work as the grid is still on the airy
ellipsoid.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Tue Feb 20 09:31:15 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 20 Feb 2018 17:31:15 +0000
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519143648395-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
	<1519143648395-0.post@n6.nabble.com>
Message-ID: <21915F81-72E5-4F3D-9815-5D14DCA8655C@sdfe.dk>



> On 20 Feb 2018, at 17:20, stevejking <stevejking at talktalk.net> wrote:
> 
> Thanks for to suggestions, but the grids are lat/long grids realised on the
> Airy ellipsoid and go from OSGB lat/long to Etrs lat/long and height. So
> think I’d need to apply the grids in the reverse direction/reverse sign (if
> that’s possible in the api) to first get Airy ellipsoid lat longs, then step
> to my final projection. They work with cs2cs so that fine for now.


When doing gridshifts PROJ does not care what ellipsoid your coordinates relate to.
It is simply offsetting the coordinate by whatever value(s) is at a the corresponding grid cell.
This is independent of the API that is used (hint: they use the same functions internally).

The general idea I have expressed in the previous mail is correct. Or, at least it replicates what you’ve
done with cs2cs. If you disagree I am afraid you’ve misunderstood how cs2cs works, which is
totally understandable as it is in no way transparent what is happening. This is one of the reasons
why the pipeline framework is superior - it communicates better what is happening in a transformation.

> I’ll try to summarise the steps I did, as I’m not likely at my computer
> today.
> 
> I installed RC3 using visual studio 2017 community edition. From a VS prompt
> (I’d need to check, maybe re install as can’t recall if it was 32 or 64 bit
> prompt, or might have a check in Dependency Walker). I used the soon to
> depreciate nmake commands listed in the readme (two or three lines).
> 

I have tried replicating this now. If I don’t have PROJ_LIB set to a directory with proj_def.dat, various
init and grid files I can’t do anything. Which make sense cause how would PROJ know where to look?
On Unix-based systems things are a bit simpler as PROJ always looks in /usr/local/share/proj for
what it needs and grids are installed there by default. No such thing exists on Windows. SO, the
solution is to make sure PROJ_LIB points towards your grids folder. I’ll add that to the README.


> I used a regular command prompt, navigated to the bin directory, then typed
> the cs2cs and cct strings as you list above.
> 
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From stevejking at talktalk.net  Tue Feb 20 12:55:24 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 20 Feb 2018 13:55:24 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <21915F81-72E5-4F3D-9815-5D14DCA8655C@sdfe.dk>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
	<1519143648395-0.post@n6.nabble.com>
	<21915F81-72E5-4F3D-9815-5D14DCA8655C@sdfe.dk>
Message-ID: <1519160124507-0.post@n6.nabble.com>

Kristian,
Definitely the ellipsoid the grids use is important. You won’t be able to
replicate the transformations otherwise. The official transformation tool is
here

https://www.ordnancesurvey.co.uk/gps/transformation/

Cs2cs gets the correct result using these grids, which are latitude
longitude grids of shifts realised on the Airy ellipsoid. The GTX comprises
shifts in metres to the GRS80 ellipsoid. Whilst the GSB file comprises sets
of 4 values for each grid point. These are latitude shift, longitude shift
both in arc seconds, and two values indicating error. The previous versions
of proj applied these shifts after first transforming the projection to
latitude longitude on its own ellipsoid, and the resulting latitude and
longitudes were then by definition wgs84 (which etrs is standing in for in
this case).

Steve





--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kristianevers at gmail.com  Tue Feb 20 13:28:51 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Tue, 20 Feb 2018 22:28:51 +0100
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <1519160124507-0.post@n6.nabble.com>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC43DAC@S000014.PROD.SITAD.DK>
	<1519143648395-0.post@n6.nabble.com>
	<21915F81-72E5-4F3D-9815-5D14DCA8655C@sdfe.dk>
	<1519160124507-0.post@n6.nabble.com>
Message-ID: <D9B20FC0-9118-4BC7-AEDB-078CC9586423@gmail.com>


> On 20 Feb 2018, at 21:55, stevejking <stevejking at talktalk.net> wrote:
> 
> Kristian,
> Definitely the ellipsoid the grids use is important. You won’t be able to
> replicate the transformations otherwise. The official transformation tool is
> here
> 
> https://www.ordnancesurvey.co.uk/gps/transformation/
> 

A few example transformations with cs2cs:

$ echo -3.5 55 0 |cs2cs -f %.10f +proj=latlong +nadgrids=null +to +proj=latlong +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +ellps=GRS80
-3.4986556560	54.9999433768 -53.2179254054
$ echo -3.5 55 0 |cs2cs -f %.10f +proj=latlong +nadgrids=null +to +proj=latlong +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +ellps=bessel
-3.4986556560	54.9999433768 -53.2179254054
$ echo -3.5 55 0 |cs2cs -f %.10f +proj=latlong +nadgrids=null +to +proj=latlong +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +ellps=airy
-3.4986556560	54.9999433768 -53.2179254054

Do you believe me now when I say that grid shifts doesn’t take note of the ellipsoid you specify?
In your original case the ellipsoid specification is applied when the geodetic coordinates are projected with tmerc.
The projection is the last step in the transformation, which is why I only added the ellipsoid definition for the last
step in my cct pipeline demo.


> Cs2cs gets the correct result using these grids, which are latitude
> longitude grids of shifts realised on the Airy ellipsoid. The GTX comprises
> shifts in metres to the GRS80 ellipsoid. Whilst the GSB file comprises sets
> of 4 values for each grid point. These are latitude shift, longitude shift
> both in arc seconds, and two values indicating error.
> The previous versions
> of proj applied these shifts after first transforming the projection to
> latitude longitude on its own ellipsoid, and the resulting latitude and
> longitudes were then by definition wgs84 (which etrs is standing in for in
> this case).

This is still the case with cs2cs.

> 
> Steve
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From kreve at sdfe.dk  Tue Feb 20 13:44:22 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 20 Feb 2018 21:44:22 +0000
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC4396D@S000014.PROD.SITAD.DK>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC4396D@S000014.PROD.SITAD.DK>
Message-ID: <68D988C0-91F1-40BA-A9D6-779BBC2D7D73@sdfe.dk>

To wrap this up I’ve replicated your original cs2cs call with cct:

$ cat stevejking.sh
echo -3.5 55 0 | ./cs2cs -f %.4f +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs \
    +to +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy \
    +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +units=m +no_defs


echo -3.5 55 0 | ./cct +proj=pipeline \
    +step +proj=hgridshift +grids=OSTN15_NTv2_OSGBtoETRS.gsb +inv \
    +step +proj=vgridshift +grids=OSGM15_GTX_OSGBtoGRS80.gtx \
    +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy

$ ./stevejking.sh
304146.0646	568298.2999 -53.2179
  304146.0646    568298.2999      -53.2179        0.0000

/Kristian


> On 20 Feb 2018, at 09:33, Kristian Evers <kreve at sdfe.dk> wrote:
> 
> Steve,
> 
> I haven't looked into why you have a problem, but I immediately notice that with the way you use cct, you might as well just use cs2cs. At least for this this transformation - I appreciate the interest in using the new tools though. So for the sake of demonstration I wanted to show how the "correct" way to do the transformation in question cct is:
> 
> You now have:
> 
> cs2cs +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +to +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +units=m +no_defs
> 
> which you then try to replicate with ctt:
> 
> cct -t0 +proj=pipeline +step +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +inv +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +nadgrids=OSTN15_NTv2_OSGBtoETRS.gsb +geoidgrids=OSGM15_GTX_OSGBtoGRS80.gtx +units=m +no_defs
> 
> There's a few things that can be simplified.
> 
> 1. you don't need the first +proj=longlat (remember, we are not describing the input and output, but the recipe to go from input to output)
> 2. The +no_defs are unnecessary unless you use aea, lcc or the lagrng projections.
> 3. the +nadgrids and +geoidgrids are now considered deprecated - instead +proj=hgridshift and +proj=vgridshift should be used as individual steps in a pipeline
> 
> So with that in mind, here's how I would set up the transformation with cct:
> 
> Cct -t0 +proj=pipeline +step +proj=hgridshift +grids=OSTN15_NTv2_OSGBtoETRS.gsb \
>                                        +step +proj=vgridshift +grids=OSGM15_GTX_OSGBtoGRS80.gtx \
>                                        +step +proj=tmerc ++lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy
> 
> So first I ignore the input system you originally defined since it is basically a no-op using +proj=latlong. Afther that I define two steps that handle the datumshift by means of horizontal and vertical grids. In the last step I apply the transverse Mercator projection.
> 
> I hope this gives a better understanding of the differences between the two approaches to transformations in PROJ.
> 
> /Kristian
> 
> Ps. The above is untested - it might contain some errors but the general idea should be clear I think.
> 
> -----Oprindelig meddelelse-----
> Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
> Sendt: 20. februar 2018 08:48
> Til: proj at lists.maptools.org
> Emne: Re: [Proj] Proj-5.0.0 cct path to gridfiles
> 
> Hi Thomas & Kristian,
> Thanks for the replies.
> 
> Yes, setting PROJ-LIB works as a temporary fix.
> 
> I've uploaded the cs2cs and cct strings, grid files and a couple of
> coordinate pairs. In a bit of a hurry this morning.
> https://1drv.ms/f/s!AvBQ7Pt73oO6iGeGDh4livK-EKAJ Hope that helps.
> 
> The cs2cs one works fine, the cct one has the above error, but works if the
> full path to gridfiles is given. 
> 
> Steve
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From stevejking at talktalk.net  Tue Feb 20 14:38:01 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 20 Feb 2018 15:38:01 -0700 (MST)
Subject: [Proj] Proj-5.0.0 cct path to gridfiles
In-Reply-To: <68D988C0-91F1-40BA-A9D6-779BBC2D7D73@sdfe.dk>
References: <1519076986468-0.post@n6.nabble.com>
	<00C04333-E0F0-440D-B542-FB433013A45E@gmail.com>
	<CAH0YoEMaScS00xfUH6oGz3_Bfa2T=V6OQ+hTacs7yx76cpVp9w@mail.gmail.com>
	<1519112884763-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC4396D@S000014.PROD.SITAD.DK>
	<68D988C0-91F1-40BA-A9D6-779BBC2D7D73@sdfe.dk>
Message-ID: <1519166281109-0.post@n6.nabble.com>

Kristian,

Thanks ever so much for taking the time and trouble to look into this. 
I've now set my PROJ_LIB environment variable in Windows.

Thanks also for spelling out the cct equivalent.
>From the inputs of -3 55
With RC3 I get 336128.9296 567726.4842 -52.4708
which match the Ordnance Survey transformation tool results exactly.

Steve








--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Wed Feb 21 08:27:19 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 16:27:19 +0000
Subject: [Proj] PROJ 5.0.0RC4
Message-ID: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>

All,

I have just prepared PROJ 5.0.0RC4. Downloads are here:


http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz.md5)

http://download.osgeo.org/proj/proj-5.0.0RC4.zip (http://download.osgeo.org/proj/proj-5.0.0RC4.zip.md5)

Changes from RC3 are minor. The PostGIS guys found a bug related to error-reporting otherwise no functional changes.
RC3 has also seen more testing on Windows via the prerelease package added to OSGeo4W. I expect this to be the final
release candidate. I will call for a vote for promotion to final release on the 27th. Unless serious issues are discovered in the
mean time.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180221/52e4e723/attachment.html>

From sebastic at xs4all.nl  Wed Feb 21 09:19:05 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 21 Feb 2018 18:19:05 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
Message-ID: <6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>

On 02/21/2018 05:27 PM, Kristian Evers wrote:
> Changes from RC3 are minor. The PostGIS guys found a bug related to error-reporting otherwise no functional changes.
> RC3 has also seen more testing on Windows via the prerelease package added to OSGeo4W. I expect this to be the final
> release candidate. I will call for a vote for promotion to final release on the 27th. Unless serious issues are discovered in the
> mean time.

The nad/BETA2007.gsb file is still not included in proj-5.0.0RC4. Since
it is included in proj-datumgrid, a new release (1.7RC1?) of
proj-datumgrid should be published so that the new grids can be included
alongside in proj packages alongside the 5.0.0 code changes.

Kind Regards,

Bas


From kreve at sdfe.dk  Wed Feb 21 09:58:13 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 17:58:13 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
Message-ID: <1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>

Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make 
sure that the two packages get updated at the same time.

/Kristian

> On 21 Feb 2018, at 18:19, Sebastiaan Couwenberg <sebastic at xs4all.nl> wrote:
> 
> On 02/21/2018 05:27 PM, Kristian Evers wrote:
>> Changes from RC3 are minor. The PostGIS guys found a bug related to error-reporting otherwise no functional changes.
>> RC3 has also seen more testing on Windows via the prerelease package added to OSGeo4W. I expect this to be the final
>> release candidate. I will call for a vote for promotion to final release on the 27th. Unless serious issues are discovered in the
>> mean time.
> 
> The nad/BETA2007.gsb file is still not included in proj-5.0.0RC4. Since
> it is included in proj-datumgrid, a new release (1.7RC1?) of
> proj-datumgrid should be published so that the new grids can be included
> alongside in proj packages alongside the 5.0.0 code changes.
> 
> Kind Regards,
> 
> Bas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From sebastic at xs4all.nl  Wed Feb 21 10:08:12 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 21 Feb 2018 19:08:12 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
Message-ID: <0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>

On 02/21/2018 06:58 PM, Kristian Evers wrote:
> Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
> Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
> I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make 
> sure that the two packages get updated at the same time.

An RC should be done to ensure that no additions to
CPACK_SOURCE_IGNORE_FILES are required.

The downside of CPack is that it includes everything in the source
directory which is not explicitly excluded. This is the opposite of
autotools which only includes which is explicitly configured.

If the build is done on OSX the .DS_Store and similar files will need to
be excluded as well. There is no HOW-TO-RELEASE for proj-datumgrid (yet)
which documents the procedure, so issues like this are possible to be
missed.

Kind Regards,

Bas


From kreve at sdfe.dk  Wed Feb 21 10:30:43 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 18:30:43 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
Message-ID: <139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>


> On 21 Feb 2018, at 19:08, Sebastiaan Couwenberg <sebastic at xs4all.nl> wrote:
> 
> On 02/21/2018 06:58 PM, Kristian Evers wrote:
>> Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
>> Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
>> I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make 
>> sure that the two packages get updated at the same time.
> 
> An RC should be done to ensure that no additions to
> CPACK_SOURCE_IGNORE_FILES are required.
> 

Okay, I’ll prepare an RC then.

> The downside of CPack is that it includes everything in the source
> directory which is not explicitly excluded. This is the opposite of
> autotools which only includes which is explicitly configured.
> 
> If the build is done on OSX the .DS_Store and similar files will need to
> be excluded as well. There is no HOW-TO-RELEASE for proj-datumgrid (yet)
> which documents the procedure, so issues like this are possible to be
> missed.
> 

Thanks for the heads up. I am on doing this on a Mac.

I’ll add a HOWTORELEASE and I think also combine the GRIDS.md and README.DATUMGRID files in a general README.md.
I might have a few questions one I’ve given this a go.

> Kind Regards,
> 
> Bas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From sebastic at xs4all.nl  Wed Feb 21 10:45:00 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 21 Feb 2018 19:45:00 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
	<139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
Message-ID: <b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>

On 02/21/2018 07:30 PM, Kristian Evers wrote:
>> On 21 Feb 2018, at 19:08, Sebastiaan Couwenberg <sebastic at xs4all.nl> wrote:
>> On 02/21/2018 06:58 PM, Kristian Evers wrote:
>>> Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
>>> Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
>>> I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make 
>>> sure that the two packages get updated at the same time.
>>
>> An RC should be done to ensure that no additions to
>> CPACK_SOURCE_IGNORE_FILES are required.
> 
> Okay, I’ll prepare an RC then.
> 
>> The downside of CPack is that it includes everything in the source
>> directory which is not explicitly excluded. This is the opposite of
>> autotools which only includes which is explicitly configured.
>>
>> If the build is done on OSX the .DS_Store and similar files will need to
>> be excluded as well. There is no HOW-TO-RELEASE for proj-datumgrid (yet)
>> which documents the procedure, so issues like this are possible to be
>> missed.
> 
> Thanks for the heads up. I am on doing this on a Mac.
> 
> I’ll add a HOWTORELEASE and I think also combine the GRIDS.md and README.DATUMGRID files in a general README.md.
> I might have a few questions one I’ve given this a go.

Also important, because nad2bin is executed to convert the .lla files,
the build should be preformed on a system that has at least proj 4.9.3
installed, to avoid changing the binary files unnecessarily. Prior
releases did not zero pad the ID field making the result of nad2bin
unreproducible, see:

 http://lists.maptools.org/pipermail/proj/2016-October/007544.html

Due to the lack of version information in nad2bin, the FindNAD2BIN.cmake
cannot enforce the version requirement.

Kind Regards,

Bas


From kreve at sdfe.dk  Wed Feb 21 10:59:05 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 18:59:05 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
	<139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
	<b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>
Message-ID: <96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>


On 21 Feb 2018, at 19:45, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:

On 02/21/2018 07:30 PM, Kristian Evers wrote:
On 21 Feb 2018, at 19:08, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:
On 02/21/2018 06:58 PM, Kristian Evers wrote:
Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make
sure that the two packages get updated at the same time.

An RC should be done to ensure that no additions to
CPACK_SOURCE_IGNORE_FILES are required.

Okay, I’ll prepare an RC then.

The downside of CPack is that it includes everything in the source
directory which is not explicitly excluded. This is the opposite of
autotools which only includes which is explicitly configured.

If the build is done on OSX the .DS_Store and similar files will need to
be excluded as well. There is no HOW-TO-RELEASE for proj-datumgrid (yet)
which documents the procedure, so issues like this are possible to be
missed.

Thanks for the heads up. I am on doing this on a Mac.

I’ll add a HOWTORELEASE and I think also combine the GRIDS.md and README.DATUMGRID files in a general README.md.
I might have a few questions one I’ve given this a go.

Also important, because nad2bin is executed to convert the .lla files,
the build should be preformed on a system that has at least proj 4.9.3
installed, to avoid changing the binary files unnecessarily. Prior
releases did not zero pad the ID field making the result of nad2bin
unreproducible, see:

http://lists.maptools.org/pipermail/proj/2016-October/007544.html

Due to the lack of version information in nad2bin, the FindNAD2BIN.cmake
cannot enforce the version requirement.


I’ve got that covered.

I have never used CPack before. Can you give a rough guide on how to produce the package?
I ran cmake in a dedicated build dir and then cpack. It produces an empty tar.gz archive. I must
have missed something.

Kind Regards,

Bas
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180221/d54b0924/attachment.html>

From kreve at sdfe.dk  Wed Feb 21 11:07:48 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 19:07:48 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
	<139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
	<b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>
	<96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>
Message-ID: <C4A833C4-943D-4C1F-89B9-934359851569@sdfe.dk>



On 21 Feb 2018, at 19:59, Kristian Evers <kreve at sdfe.dk<mailto:kreve at sdfe.dk>> wrote:


On 21 Feb 2018, at 19:45, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:

On 02/21/2018 07:30 PM, Kristian Evers wrote:
On 21 Feb 2018, at 19:08, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:
On 02/21/2018 06:58 PM, Kristian Evers wrote:
Sorry, I failed to mentioned that. It is my plan to also make a new release of the datumgrid package at the same time as PROJ 5.0.0.
Now that both the BETA2007 grid, the Australian and Danish grids have been added we should definitely put out a new version.
I had not thought of doing a release candidate though. If you feel that is important, Bas, I will publish one. Otherwise I’ll just make
sure that the two packages get updated at the same time.

An RC should be done to ensure that no additions to
CPACK_SOURCE_IGNORE_FILES are required.

Okay, I’ll prepare an RC then.

The downside of CPack is that it includes everything in the source
directory which is not explicitly excluded. This is the opposite of
autotools which only includes which is explicitly configured.

If the build is done on OSX the .DS_Store and similar files will need to
be excluded as well. There is no HOW-TO-RELEASE for proj-datumgrid (yet)
which documents the procedure, so issues like this are possible to be
missed.

Thanks for the heads up. I am on doing this on a Mac.

I’ll add a HOWTORELEASE and I think also combine the GRIDS.md and README.DATUMGRID files in a general README.md.
I might have a few questions one I’ve given this a go.

Also important, because nad2bin is executed to convert the .lla files,
the build should be preformed on a system that has at least proj 4.9.3
installed, to avoid changing the binary files unnecessarily. Prior
releases did not zero pad the ID field making the result of nad2bin
unreproducible, see:

http://lists.maptools.org/pipermail/proj/2016-October/007544.html

Due to the lack of version information in nad2bin, the FindNAD2BIN.cmake
cannot enforce the version requirement.


I’ve got that covered.

I have never used CPack before. Can you give a rough guide on how to produce the package?
I ran cmake in a dedicated build dir and then cpack. It produces an empty tar.gz archive. I must
have missed something.

Never mind, I figured it out. “make dist”.


Kind Regards,

Bas
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180221/722c6f46/attachment.html>

From sebastic at xs4all.nl  Wed Feb 21 11:13:18 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Wed, 21 Feb 2018 20:13:18 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
	<139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
	<b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>
	<96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>
Message-ID: <925b728c-b721-e868-6d3e-8e712a39111f@xs4all.nl>

On 02/21/2018 07:59 PM, Kristian Evers wrote:
> I’ve got that covered.

I figured as much, but it was worth noting for the record.

> I have never used CPack before. Can you give a rough guide on how to produce the package?
> I ran cmake in a dedicated build dir and then cpack. It produces an empty tar.gz archive. I must
> have missed something.

CMake uses the package_source target to create archives, as a
convenience I added the dist target to have the build behave more like
autotools.

The process comes down to:

 # Create proj-datumgrid tarball & zipfile
 mkdir build
 cd build
 cmake ..
 make dist

 # Check repo status for grid changes
 git status

 # Check tarball & zipfile content
 tar tavf proj-datumgrid-1.7alpha1.tar.gz
 unzip -l proj-datumgrid-1.7alpha1.zip

 # Copy archives to elsewhere
 cp proj-datumgrid-1.7alpha1.* <elsewhere>

 # Cleanup
 cd ..
 rm -rf build

Kind Regards,

Bas


From kreve at sdfe.dk  Wed Feb 21 12:01:52 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 20:01:52 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <925b728c-b721-e868-6d3e-8e712a39111f@xs4all.nl>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<6b6547f8-bb85-d8f1-a832-a84f3979ea73@xs4all.nl>
	<1941E6EB-6D9D-4F42-B289-AF7454CAF910@sdfe.dk>
	<0bb02e1b-4585-14b2-0cc7-1768d0047c6c@xs4all.nl>
	<139C3CC6-E654-4AB4-AA20-DB0954575D62@sdfe.dk>
	<b626ccfe-49b1-ac88-cdcc-1bdd11a077c8@xs4all.nl>
	<96E9B460-426F-4351-8E90-6818316A2C83@sdfe.dk>
	<925b728c-b721-e868-6d3e-8e712a39111f@xs4all.nl>
Message-ID: <D0C48AE3-5F4F-4DB5-BAB7-FF3C66F25CEE@sdfe.dk>

Thanks Bas, that was very helpful. I’ve added a HOWTORELEASE and created README.md
from GRIDS.md and README.DATUMGRID in this pull request:

https://github.com/OSGeo/proj-datumgrid/pull/11

I have prepared a release candidate with the above changes. It seems to be fine and I will upload
it soon and announce it here on the list once it is ready.

/Kristian

On 21 Feb 2018, at 20:13, Sebastiaan Couwenberg <sebastic at xs4all.nl<mailto:sebastic at xs4all.nl>> wrote:

On 02/21/2018 07:59 PM, Kristian Evers wrote:
I’ve got that covered.

I figured as much, but it was worth noting for the record.

I have never used CPack before. Can you give a rough guide on how to produce the package?
I ran cmake in a dedicated build dir and then cpack. It produces an empty tar.gz archive. I must
have missed something.

CMake uses the package_source target to create archives, as a
convenience I added the dist target to have the build behave more like
autotools.

The process comes down to:

# Create proj-datumgrid tarball & zipfile
mkdir build
cd build
cmake ..
make dist

# Check repo status for grid changes
git status

# Check tarball & zipfile content
tar tavf proj-datumgrid-1.7alpha1.tar.gz
unzip -l proj-datumgrid-1.7alpha1.zip

# Copy archives to elsewhere
cp proj-datumgrid-1.7alpha1.* <elsewhere>

# Cleanup
cd ..
rm -rf build

Kind Regards,

Bas
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180221/03e19c49/attachment.html>

From stevejking at talktalk.net  Wed Feb 21 13:18:00 2018
From: stevejking at talktalk.net (stevejking)
Date: Wed, 21 Feb 2018 14:18:00 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
Message-ID: <1519247880383-0.post@n6.nabble.com>

Is it possible to use a +init pipeline file in reverse?

For example, with some explanation from Kristian, I now have two
transformations:

# OSGB1936 to ETRS89(2)
<7709-3D>                  -t0 +proj=pipeline \
                      +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
+x_0=400000 +y_0=-100000 +ellps=airy +inv \                     
                      +step +proj=vgridshift
+grids=OSGM15_GTX_OSGBtoGRS80.gtx +inv \
                      +step +proj=hgridshift
+grids=OSTN15_NTv2_OSGBtoETRS.gsb

# ETRS89 to OSGB1936
<7709-3D-Reverse>     -t0 +proj=pipeline \                    
                      +step +proj=hgridshift
+grids=OSTN15_NTv2_OSGBtoETRS.gsb +inv \ 
                      +step +proj=vgridshift
+grids=OSGM15_GTX_OSGBtoGRS80.gtx \ 
                      +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
+x_0=400000 +y_0=-100000 +ellps=airy


The only difference between the two is the reverse order and swapping the
+inv and 'no inv blanks' on the end of each line. I'm wondering if I need
two separate transformations?

If not is it a sensible future development? +init=<...> +reverse ?

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Wed Feb 21 13:35:15 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 21:35:15 +0000
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519247880383-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
Message-ID: <E4554F85-24B9-4C93-89DC-1DAE05202BA4@sdfe.dk>

Steve,

> On 21 Feb 2018, at 22:18, stevejking <stevejking at talktalk.net> wrote:
> 
> Is it possible to use a +init pipeline file in reverse?
> 

Yes. Well, mostly anyway. As long as a reverse path through pipeline exists. Some projections are only defined in the
forward direction, but that is not a problem for you here.

Below I assume you init-file is called “transforms”. You have several options:

1. Do an inverse transformation with cct:

	cct -i +init=transforms:7709-3D

2. Reverse the pipeline by using a global +inv flag:

<7709-3D>   +proj=pipeline +inv \
                     +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717+x_0=400000 +y_0=-100000 +ellps=airy +inv \                     
                     +step +proj=vgridshift +grids=OSGM15_GTX_OSGBtoGRS80.gtx +inv \
                     +step +proj=hgridshift +grids=OSTN15_NTv2_OSGBtoETRS.gsb

Note the “+inv” in the first line. Any parameters specified AFTER proj=pipeline and BEFORE the first +step are global
and are added internally to each individual step in the pipeline. This is often useful for ellipsoid specification for instance.
If you +inv a step that is already +inv’ed you effectively get a double-negation which is just the forward operation. This
works for any number of +inv’s. An odd number of +inv’s results in a reverse step, and even number results in a forward
step.

3. Create a reverse entry that self-references the init-file:

<7709-3D_reverse>  +proj=pipeline +step +init=transforms:7709-3D +inv

You probably just want to go with the first option, but depending on your use case 2 and 3 can be useful as well.

/Kristian

> For example, with some explanation from Kristian, I now have two
> transformations:
> 
> # OSGB1936 to ETRS89(2)
> <7709-3D>                  -t0 +proj=pipeline \
>                      +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
> +x_0=400000 +y_0=-100000 +ellps=airy +inv \                     
>                      +step +proj=vgridshift
> +grids=OSGM15_GTX_OSGBtoGRS80.gtx +inv \
>                      +step +proj=hgridshift
> +grids=OSTN15_NTv2_OSGBtoETRS.gsb
> 
> # ETRS89 to OSGB1936
> <7709-3D-Reverse>     -t0 +proj=pipeline \                    
>                      +step +proj=hgridshift
> +grids=OSTN15_NTv2_OSGBtoETRS.gsb +inv \ 
>                      +step +proj=vgridshift
> +grids=OSGM15_GTX_OSGBtoGRS80.gtx \ 
>                      +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
> +x_0=400000 +y_0=-100000 +ellps=airy
> 
> 
> The only difference between the two is the reverse order and swapping the
> +inv and 'no inv blanks' on the end of each line. I'm wondering if I need
> two separate transformations?
> 
> If not is it a sensible future development? +init=<...> +reverse ?
> 
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From knudsen.thomas at gmail.com  Wed Feb 21 13:45:04 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Wed, 21 Feb 2018 22:45:04 +0100
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519247880383-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
Message-ID: <CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>

use
    +init=blabla +inv

For cct, there's also the -I switch:

    cct -I +init=blabla

/Thomas

2018-02-21 22:18 GMT+01:00 stevejking <stevejking at talktalk.net>:

> Is it possible to use a +init pipeline file in reverse?
>
> For example, with some explanation from Kristian, I now have two
> transformations:
>
> # OSGB1936 to ETRS89(2)
> <7709-3D>                  -t0 +proj=pipeline \
>                       +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
> +x_0=400000 +y_0=-100000 +ellps=airy +inv \
>                       +step +proj=vgridshift
> +grids=OSGM15_GTX_OSGBtoGRS80.gtx +inv \
>                       +step +proj=hgridshift
> +grids=OSTN15_NTv2_OSGBtoETRS.gsb
>
> # ETRS89 to OSGB1936
> <7709-3D-Reverse>     -t0 +proj=pipeline \
>                       +step +proj=hgridshift
> +grids=OSTN15_NTv2_OSGBtoETRS.gsb +inv \
>                       +step +proj=vgridshift
> +grids=OSGM15_GTX_OSGBtoGRS80.gtx \
>                       +step +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717
> +x_0=400000 +y_0=-100000 +ellps=airy
>
>
> The only difference between the two is the reverse order and swapping the
> +inv and 'no inv blanks' on the end of each line. I'm wondering if I need
> two separate transformations?
>
> If not is it a sensible future development? +init=<...> +reverse ?
>
> Steve
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180221/22d965ef/attachment.html>

From mateusz at loskot.net  Wed Feb 21 13:51:02 2018
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 21 Feb 2018 22:51:02 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
Message-ID: <CABUeae8pQaz9YLfHDHFkjX=a_=j=o3ymN2eobN=003nF66YeHA@mail.gmail.com>

On 21 February 2018 at 17:27, Kristian Evers <kreve at sdfe.dk> wrote:
> All,
>
> I have just prepared PROJ 5.0.0RC4. Downloads are here:
>
>
> http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz
> (http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz.md5)
>
> http://download.osgeo.org/proj/proj-5.0.0RC4.zip
> (http://download.osgeo.org/proj/proj-5.0.0RC4.zip.md5)
>
> Changes from RC3 are minor. The PostGIS guys found a bug related to
> error-reporting otherwise no functional changes.
> RC3 has also seen more testing on Windows via the prerelease package added
> to OSGeo4W.

I've checked build & install of the RC4 on using VS2017 15.5.7

mkdir _build.vs2017x64 (or _build.vs2017x32 for 32-bit target)
cd _build.vs2017x64

cmake -G "Visual Studio 15 2017 Win64"
-DCMAKE_INSTALL_PREFIX:PATH=%CD%\_install.x64 ..
or
cmake -G "Visual Studio 15 2017"
-DCMAKE_INSTALL_PREFIX:PATH=%CD%\_install.x32 ..

cmake --build . --config Release --target install
ctest -C Release .


For both, 32 and 64 bit builds, this Builtins2 test is failing:

test 3
      Start  3: Builtins2

3: Test command:
D:\tmp\proj-5.0.0rc4\_build.vs2017x32\bin\Release\gie.exe
"D:/tmp/proj-5.0.0rc4/test/gie/more_builtins.gie"
3: Test timeout computed to be: 1500
3: -------------------------------------------------------------------------------
3: Reading file 'D:/tmp/proj-5.0.0rc4/test/gie/more_builtins.gie'
3: pj_cart_selftest fails with 64
3: -------------------------------------------------------------------------------
3: total: 44 tests succeeded,  4 tests skipped,  1 tests FAILED!
3: -------------------------------------------------------------------------------
 3/25 Test  #3: Builtins2 ........................***Failed    0.21 sec

Is this expected?

BTW, I noticed the AppVeyor does not build with VS2017, is it intentional?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net


From kreve at sdfe.dk  Wed Feb 21 13:59:45 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 21 Feb 2018 21:59:45 +0000
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <CABUeae8pQaz9YLfHDHFkjX=a_=j=o3ymN2eobN=003nF66YeHA@mail.gmail.com>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<CABUeae8pQaz9YLfHDHFkjX=a_=j=o3ymN2eobN=003nF66YeHA@mail.gmail.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC4944C@S000014.PROD.SITAD.DK>

Hi Mateuz,

No, that is not intentional. The specific test looks for the null grid. Have you set PROJ_LIB to point to a folder with the grids in the datumgrid package? The same test has been acting up before when a different grid was used, so I am not too worried about this one not passing.

The reason why appveyor isn't using VS2017 is probably because the configuration was set up before VS2017 was a thing. You are welcome to add it in a PR :-)

/Kristian

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af Mateusz Loskot
Sendt: 21. februar 2018 22:51
Til: PROJ.4 and general Projections Discussions <proj at lists.maptools.org>
Emne: Re: [Proj] PROJ 5.0.0RC4

On 21 February 2018 at 17:27, Kristian Evers <kreve at sdfe.dk> wrote:
> All,
>
> I have just prepared PROJ 5.0.0RC4. Downloads are here:
>
>
> http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz
> (http://download.osgeo.org/proj/proj-5.0.0RC4.tar.gz.md5)
>
> http://download.osgeo.org/proj/proj-5.0.0RC4.zip
> (http://download.osgeo.org/proj/proj-5.0.0RC4.zip.md5)
>
> Changes from RC3 are minor. The PostGIS guys found a bug related to
> error-reporting otherwise no functional changes.
> RC3 has also seen more testing on Windows via the prerelease package added
> to OSGeo4W.

I've checked build & install of the RC4 on using VS2017 15.5.7

mkdir _build.vs2017x64 (or _build.vs2017x32 for 32-bit target)
cd _build.vs2017x64

cmake -G "Visual Studio 15 2017 Win64"
-DCMAKE_INSTALL_PREFIX:PATH=%CD%\_install.x64 ..
or
cmake -G "Visual Studio 15 2017"
-DCMAKE_INSTALL_PREFIX:PATH=%CD%\_install.x32 ..

cmake --build . --config Release --target install
ctest -C Release .


For both, 32 and 64 bit builds, this Builtins2 test is failing:

test 3
      Start  3: Builtins2

3: Test command:
D:\tmp\proj-5.0.0rc4\_build.vs2017x32\bin\Release\gie.exe
"D:/tmp/proj-5.0.0rc4/test/gie/more_builtins.gie"
3: Test timeout computed to be: 1500
3: -------------------------------------------------------------------------------
3: Reading file 'D:/tmp/proj-5.0.0rc4/test/gie/more_builtins.gie'
3: pj_cart_selftest fails with 64
3: -------------------------------------------------------------------------------
3: total: 44 tests succeeded,  4 tests skipped,  1 tests FAILED!
3: -------------------------------------------------------------------------------
 3/25 Test  #3: Builtins2 ........................***Failed    0.21 sec

Is this expected?

BTW, I noticed the AppVeyor does not build with VS2017, is it intentional?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


From mateusz at loskot.net  Wed Feb 21 14:21:24 2018
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 21 Feb 2018 23:21:24 +0100
Subject: [Proj] PROJ 5.0.0RC4
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC4944C@S000014.PROD.SITAD.DK>
References: <137D3812-520D-41E8-A7A4-F445ED7CF612@sdfe.dk>
	<CABUeae8pQaz9YLfHDHFkjX=a_=j=o3ymN2eobN=003nF66YeHA@mail.gmail.com>
	<2E885BB293AF0448A0181138489E9A0EAEC4944C@S000014.PROD.SITAD.DK>
Message-ID: <CABUeae9h=msF=Why0BNiFQQyVnYY+ZVX6HA3o9OHhuyiBdB23Q@mail.gmail.com>

On 21 February 2018 at 22:59, Kristian Evers <kreve at sdfe.dk> wrote:
> Have you set PROJ_LIB to point to a folder with the grids in the datumgrid package?

Initially, I did not set PROJ_LIB

Then I realised there is this comment in CMakeLists.txt

#TODO
# for data install testing the PROJ_LIB envVar

And, I set the env and re-run tests, no difference.

> The same test has been acting up before when a different grid was used, so I am not too worried about this one not passing.

OK

> The reason why appveyor isn't using VS2017 is probably because the configuration was set up before VS2017 was a thing. You are welcome to add it in a PR :-)

Sure, and I'm eager to add one, let's see how it goes :-)

https://github.com/OSGeo/proj.4/pull/810

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net


From stevejking at talktalk.net  Thu Feb 22 00:04:36 2018
From: stevejking at talktalk.net (stevejking)
Date: Thu, 22 Feb 2018 01:04:36 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
Message-ID: <1519286676646-0.post@n6.nabble.com>

Thanks Kristian and Thomas
I’ll give these a try on RC4

cct +init = blabla +inv
Doesn’t work on RC3 if it’s supposed to.
But I’m sure
cct -i +init = blabla
and the others will work

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Thu Feb 22 00:20:47 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Thu, 22 Feb 2018 08:20:47 +0000
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519286676646-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>

+inv is only valid within a pipeline. That's why my last example was

	<7709-3D_reverse>  +proj=pipeline +step +init=transforms:7709-3D +inv

even though it is a pipeline with a single step, it is necessary because otherwise the +inv
would not have an effect. This stuff is also in the documentation for the next release:
https://kbevers.github.io/usage/operations/pipeline.html (preliminary address until PROJ 5 is released).

/Kristian

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
Sendt: 22. februar 2018 09:05
Til: proj at lists.maptools.org
Emne: Re: [Proj] Pipeline +init files, inverse

Thanks Kristian and Thomas
I’ll give these a try on RC4

cct +init = blabla +inv
Doesn’t work on RC3 if it’s supposed to.
But I’m sure
cct -i +init = blabla
and the others will work

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

From kreve at sdfe.dk  Thu Feb 22 08:35:37 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Thu, 22 Feb 2018 16:35:37 +0000
Subject: [Proj] proj-datumgrid 1.7RC1
Message-ID: <F72C4D0B-BD8B-4D8E-95FA-F01AE10B1613@sdfe.dk>

All,

As requested, a release candidate for the next version of the proj-datumgrid package.
The final release of the package will coincide with the release of PROJ 5.0.0 scheduled for March 1st.

Downloads here:

http://download.osgeo.org/proj/proj-datumgrid-1.7RC1.tar.gz
http://download.osgeo.org/proj/proj-datumgrid-1.7RC1.zip

This version adds grids that are valid in the following countries:

Australia:

* A66_National_13_09_01.gsb
* National_84_02_07_01.gsb
* GDA94_GDA2020_conformal.gsb
* GDA94_GDA2020_conformal_and_distortion.gsb

Germany:

* BETA2007.gsb

Denmark:

* dvr90.gtx

Faroe Islands:

* fvr09.gtx

Greenland:

* gvr2016.gtx

More info on the grids can be found in README.DATUMGRIDS included in the package.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180222/67e4e956/attachment.html>

From stevejking at talktalk.net  Thu Feb 22 14:02:19 2018
From: stevejking at talktalk.net (stevejking)
Date: Thu, 22 Feb 2018 15:02:19 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
Message-ID: <1519336939191-0.post@n6.nabble.com>

Hi Kristian & Thomas,

I've tested reversing a pipeline, Using test coordinates -3 55 100, with
RC4, and the methods you've both described in this thread. On Windows 7.
Referencing Kristian's 3 cases:

case 1) do an inverse with cct
eg. cct -I +init=OSGBtrans:7709-3D
Works as expected, but is case sensitive, it must be capital -I as in
Thomas' reply.
-i generates error
Invalid option "i"


case 2) Init file Global +inv flag before the first + step
eg. <case2>    -t0 +proj=pipeline +inv +step ....

generates error
# Record 0 TRANSFORMATION ERROR: -3 55 100 
 <invalid x or y>


case 3) Init file reverse entry that self-references the init file, 
eg. <7709-3D_reverse>  +proj=pipeline +step +init=transforms:7709-3D +inv

generates error
cct: Bad transformationarguments - (malformed pipeline)
	'cct - h' for help

The init file and gridfiles can be found here:
https://1drv.ms/f/s!AvBQ7Pt73oO6iHV1WJ-n-lqLu_9r


Regards,
Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From stevejking at talktalk.net  Thu Feb 22 14:07:53 2018
From: stevejking at talktalk.net (stevejking)
Date: Thu, 22 Feb 2018 15:07:53 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519336939191-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
Message-ID: <1519337273686-0.post@n6.nabble.com>

Forgot to say all 3 cases tested using cct.
Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Thu Feb 22 14:11:13 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Thu, 22 Feb 2018 22:11:13 +0000
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519336939191-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
Message-ID: <055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>

Steve,

You have “-t0” in all the various transformation definitions in your init file.
“-t” is a parameter that you can use with cct, not a valid parameter in a proj-string.
Remove those and let us know how things go. Parameters with a + controls
The transformation setup, parameters with a - are specific to the command line
utilities in PROJ.

/Kristian

On 22 Feb 2018, at 23:02, stevejking <stevejking at talktalk.net<mailto:stevejking at talktalk.net>> wrote:

https://1drv.ms/f/s!AvBQ7Pt73oO6iHV1WJ-n-lqLu_9r

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180222/7e263fb2/attachment.html>

From stevejking at talktalk.net  Thu Feb 22 14:31:47 2018
From: stevejking at talktalk.net (stevejking)
Date: Thu, 22 Feb 2018 15:31:47 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
Message-ID: <1519338707608-0.post@n6.nabble.com>

Thanks Kristian,
I’ll try tomorrow

Double checking on my phone

Case 3 I’ve missed the +step out in the init file

Maybe I’ve cocked up case 2? I’ll try tomorrow if I can these two without
the -t0 and with the +step in 3)

Cheers

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kristianevers at gmail.com  Thu Feb 22 14:42:57 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Thu, 22 Feb 2018 23:42:57 +0100
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519338707608-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
	<1519338707608-0.post@n6.nabble.com>
Message-ID: <C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>

Yeah, it’s easy to get things wrong. Trust me, I’ve done that plenty of times :)

What you are working on seems to be of a similar vein to the transformation definiitions
we are working on establishing within the Nordic Geodetic Commision. You might find
interest and inspiration in our approach. Have a look here:

https://github.com/NordicGeodesy/NordicTransformations <https://github.com/NordicGeodesy/NordicTransformations>

At the moment this is probably the most elaborate use of the new PROJ features. It
is my hope that it is a good showcase of all the work that has gone into the new
version of PROJ. Until we get things properly documented it is also the best
resource for getting hints about what's possible with init-files and pipelines.

/Kristian

> On 22 Feb 2018, at 23:31, stevejking <stevejking at talktalk.net> wrote:
> 
> Thanks Kristian,
> I’ll try tomorrow
> 
> Double checking on my phone
> 
> Case 3 I’ve missed the +step out in the init file
> 
> Maybe I’ve cocked up case 2? I’ll try tomorrow if I can these two without
> the -t0 and with the +step in 3)
> 
> Cheers
> 
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180222/db141dea/attachment.html>

From stevejking at talktalk.net  Thu Feb 22 23:46:58 2018
From: stevejking at talktalk.net (stevejking)
Date: Fri, 23 Feb 2018 00:46:58 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
	<1519338707608-0.post@n6.nabble.com>
	<C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>
Message-ID: <1519372018052-0.post@n6.nabble.com>

Kristian,
Thanks for the reply, I'll take a look at the link.

For the moment, I've added the missing +step to case 3, and it now works :)
I also removed the command line -t0's which I had in error put in the init
file.

Unfortunately case 2 is still giving the error. I even tried removing the
breakline \'s.

Will look more when time allows.

...

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From knudsen.thomas at gmail.com  Fri Feb 23 02:00:44 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Fri, 23 Feb 2018 11:00:44 +0100
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <1519372018052-0.post@n6.nabble.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
	<1519338707608-0.post@n6.nabble.com>
	<C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>
	<1519372018052-0.post@n6.nabble.com>
Message-ID: <CAH0YoEPZFg5mG+Zy6kCY_rd51_6vjVReE_wCz-JrjDT+PMeM=A@mail.gmail.com>

Steve,

Essentially (leaving out the double inversions), your "case 2" does this:

<case2>
proj=pipeline
step proj=tmerc lat_0=49 lon_0=-2 k=0.9996012717
                          x_0=400000 y_0=-100000 ellps=airy
step proj=vgridshift grids=OSGM15_GTX_OSGBtoGRS80.gtx
step proj=hgridshift grids=OSTN15_NTv2_OSGBtoETRS.gsb inv

But your grid is given in geographic coordinates, not transverse mercator
(cf. gdalinfo output [1] below), so starting your pipeline going from geo
to transverse mercator takes you way outside the grid coverage.

So start doing the gridshifts, then do the projection. When doing that, you
get this:

$ echo -3 55 100 | cct -t0 +init=OSGBtrans:case2
  335948.6065    567743.2288       47.5270        0.0000

/Thomas




[1]  gdalinfo OSGM15_GTX_OSGBtoGRS80.gtx

Driver: GTX/NOAA Vertical Datum .GTX
Files: OSGM15_GTX_OSGBtoGRS80.gtx
Size is 661, 1441
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Origin = (-9.008333333333329,61.004166666666627)
Pixel Size = (0.016666666666667,-0.008333333333333)
Corner Coordinates:
Upper Left  (  -9.0083333,  61.0041667) (  9d 0'30.00"W, 61d 0'15.00"N)
Lower Left  (  -9.0083333,  48.9958333) (  9d 0'30.00"W, 48d59'45.00"N)
Upper Right (   2.0083333,  61.0041667) (  2d 0'30.00"E, 61d 0'15.00"N)
Lower Right (   2.0083333,  48.9958333) (  2d 0'30.00"E, 48d59'45.00"N)
Center      (  -3.5000000,  55.0000000) (  3d30' 0.00"W, 55d 0' 0.00"N)
Band 1 Block=661x1 Type=Float32, ColorInterp=Undefined
  NoData Value=-88.8888000000000034





2018-02-23 8:46 GMT+01:00 stevejking <stevejking at talktalk.net>:

> Kristian,
> Thanks for the reply, I'll take a look at the link.
>
> For the moment, I've added the missing +step to case 3, and it now works :)
> I also removed the command line -t0's which I had in error put in the init
> file.
>
> Unfortunately case 2 is still giving the error. I even tried removing the
> breakline \'s.
>
> Will look more when time allows.
>
> ...
>
> Steve
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180223/59336a2b/attachment.html>

From knudsen.thomas at gmail.com  Fri Feb 23 02:24:52 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Fri, 23 Feb 2018 11:24:52 +0100
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <CAH0YoEPZFg5mG+Zy6kCY_rd51_6vjVReE_wCz-JrjDT+PMeM=A@mail.gmail.com>
References: <1519247880383-0.post@n6.nabble.com>
	<CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
	<1519338707608-0.post@n6.nabble.com>
	<C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>
	<1519372018052-0.post@n6.nabble.com>
	<CAH0YoEPZFg5mG+Zy6kCY_rd51_6vjVReE_wCz-JrjDT+PMeM=A@mail.gmail.com>
Message-ID: <CAH0YoEPoAzgSKhDFrs66EiWbjr6KFwS2cK_HxWXgVBH39aC-ag@mail.gmail.com>

... following up to myself here, since I seem to have gotten the inversions
wrong.

If I read your original init file correctly, what you want to do is this:

<case2>
proj=pipeline
step proj=vgridshift grids=OSGM15_GTX_OSGBtoGRS80.gtx
step proj=hgridshift grids=OSTN15_NTv2_OSGBtoETRS.gsb inv
step proj=tmerc lat_0=49 lon_0=-2 k=0.9996012717
                x_0=400000 y_0=-100000 ellps=airy

i.e. the hgridshift inverted, the other steps forward.

Saying
    echo -3 55 100 | cct -t0 +init=OSGBtrans:case2

Now results in:
      336128.9296    567726.4842       47.5270        0.0000



2018-02-23 11:00 GMT+01:00 Thomas Knudsen <knudsen.thomas at gmail.com>:

> Steve,
>
> Essentially (leaving out the double inversions), your "case 2" does this:
>
> <case2>
> proj=pipeline
> step proj=tmerc lat_0=49 lon_0=-2 k=0.9996012717
>                           x_0=400000 y_0=-100000 ellps=airy
> step proj=vgridshift grids=OSGM15_GTX_OSGBtoGRS80.gtx
> step proj=hgridshift grids=OSTN15_NTv2_OSGBtoETRS.gsb inv
>
> But your grid is given in geographic coordinates, not transverse mercator
> (cf. gdalinfo output [1] below), so starting your pipeline going from geo
> to transverse mercator takes you way outside the grid coverage.
>
> So start doing the gridshifts, then do the projection. When doing that, you
> get this:
>
> $ echo -3 55 100 | cct -t0 +init=OSGBtrans:case2
>   335948.6065    567743.2288       47.5270        0.0000
>
> /Thomas
>
>
>
>
> [1]  gdalinfo OSGM15_GTX_OSGBtoGRS80.gtx
>
> Driver: GTX/NOAA Vertical Datum .GTX
> Files: OSGM15_GTX_OSGBtoGRS80.gtx
> Size is 661, 1441
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9122"]],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-9.008333333333329,61.004166666666627)
> Pixel Size = (0.016666666666667,-0.008333333333333)
> Corner Coordinates:
> Upper Left  (  -9.0083333,  61.0041667) (  9d 0'30.00"W, 61d 0'15.00"N)
> Lower Left  (  -9.0083333,  48.9958333) (  9d 0'30.00"W, 48d59'45.00"N)
> Upper Right (   2.0083333,  61.0041667) (  2d 0'30.00"E, 61d 0'15.00"N)
> Lower Right (   2.0083333,  48.9958333) (  2d 0'30.00"E, 48d59'45.00"N)
> Center      (  -3.5000000,  55.0000000) (  3d30' 0.00"W, 55d 0' 0.00"N)
> Band 1 Block=661x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=-88.8888000000000034
>
>
>
>
>
> 2018-02-23 8:46 GMT+01:00 stevejking <stevejking at talktalk.net>:
>
>> Kristian,
>> Thanks for the reply, I'll take a look at the link.
>>
>> For the moment, I've added the missing +step to case 3, and it now works
>> :)
>> I also removed the command line -t0's which I had in error put in the init
>> file.
>>
>> Unfortunately case 2 is still giving the error. I even tried removing the
>> breakline \'s.
>>
>> Will look more when time allows.
>>
>> ...
>>
>> Steve
>>
>>
>>
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180223/e732de6a/attachment.html>

From stevejking at talktalk.net  Fri Feb 23 04:19:01 2018
From: stevejking at talktalk.net (stevejking)
Date: Fri, 23 Feb 2018 05:19:01 -0700 (MST)
Subject: [Proj] Pipeline +init files, inverse
In-Reply-To: <CAH0YoEPoAzgSKhDFrs66EiWbjr6KFwS2cK_HxWXgVBH39aC-ag@mail.gmail.com>
References: <CAH0YoEMrEe-wcs8yKg92y3C4X6NuP=0u2s1cHUm_G1xHSo01CA@mail.gmail.com>
	<1519286676646-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC497C3@S000014.PROD.SITAD.DK>
	<1519336939191-0.post@n6.nabble.com>
	<055C8647-1C70-4C4E-B9B4-B4D55D7612B3@sdfe.dk>
	<1519338707608-0.post@n6.nabble.com>
	<C308D15F-CFEF-4693-B825-62DCF09E3DCD@gmail.com>
	<1519372018052-0.post@n6.nabble.com>
	<CAH0YoEPZFg5mG+Zy6kCY_rd51_6vjVReE_wCz-JrjDT+PMeM=A@mail.gmail.com>
	<CAH0YoEPoAzgSKhDFrs66EiWbjr6KFwS2cK_HxWXgVBH39aC-ag@mail.gmail.com>
Message-ID: <1519388341126-0.post@n6.nabble.com>

Thanks Thomas
I really should have seen that staring me in the face.

So to confirm, all 3 reverse pipeline / inverse cases set out by Kristian
earlier in this thread, do work, but the user needs to engage brain. 

Cheers
Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From Mikael.Rittri at carmenta.com  Fri Feb 23 05:27:52 2018
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Fri, 23 Feb 2018 13:27:52 +0000
Subject: [Proj] What is the expected Proj4 result when an input is out of
	range?
Message-ID: <E4AB3DD44D22854B819908379DE4AD493E36DBD8@SETHNWS023.carmenta.se>

Hello, list.

I am confused about the result I get from the Proj4 inverse projection of Lambert Azimuthal Equal Area,
when the original projected input point is outside the valid circle.

I thought that in cases like these, the result point should have coordinates that are HUGE_VAL ,  that is, 1e+300.
There seems to be code in pj_inv.c that checks error conditions and sets coordinates to HUGE_VAL, but these
checks aren't triggered in my example.
Instead, my debugger says that I get a point with coordinates  -nan(ind).
I suppose that is an Indefinite NaN.  I am not too familiar with the various flavours of NaN, but it's certainly different from 1e+300.

Here is a concrete example that I have run in the console application, using Proj 4.9.3 and EPSG:3035 which is ETRS89 / LAEA Europe:

C:\> proj -I +init=epsg:3035
4321000 3210000
10dE    52dN
16350000 -1090000
-2147483648d-2147483648'-1.#IO"E        -2147483648d-2147483648'-1.#IO"N

I think I remember that invalid coordinates are usually written as asterisks by the console application.

Avoiding the default DMS formatting of the output, I get the following instead:

C:\>proj -I +init=epsg:3035 -f "%.5f"
4321000 3210000
10.00000        52.00000
16350000 -1090000
-1.#IND0        -1.#IND0

So my question is, is this a kind of bug in the implementation of inverse LAEA, or is it to be expected that invalid coordinates
can be represented by either HUGE_VAL or NaN depending on the projection?

Best regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180223/62aa5364/attachment.html>

From kreve at sdfe.dk  Fri Feb 23 11:19:45 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Fri, 23 Feb 2018 19:19:45 +0000
Subject: [Proj] PROJ 5.0.0RC5
Message-ID: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>

All,

I have prepared PROJ 5.0.0RC5. Downloads are here:


http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)

http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)


Since RC4 problems with vertical grid installation, the Horner transformation and faulty polygon area calculation
in geodesic library has been fixed. Hopefully this will be the final release candidate. I will call for a vote for
promotion to final release on the 27th. Unless serious issues are discovered in the mean time.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180223/0f5ce8f2/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Feb 23 13:33:18 2018
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 23 Feb 2018 17:33:18 -0400
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
Message-ID: <df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>

Hi Kristian,

No problems here on Windows in the MS4W environment, but I'm running 
into odd errors when I have MapServer call PROJ 5 
(https://lists.osgeo.org/pipermail/mapserver-dev/2018-February/015347.html). 
  Obviously an issue downstream not here, but I thought I'd at least 
mention it here that I am testing RC5 as well :)

Thanks for pushing this release along.

-jeff




On 2018-02-23 3:19 PM, Kristian Evers wrote:
> All,
> 
> I have prepared PROJ 5.0.0RC5. Downloads are here:
> 
> 
> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
> 
> 
> Since RC4 problems with vertical grid installation, the Horner 
> transformation and faulty polygon area calculation
> in geodesic library has been fixed. Hopefully this will be the final 
> release candidate. I will call for a vote for
> promotion to final release on the 27th. Unless serious issues are 
> discovered in the mean time.
> 
> /Kristian
> 
> 


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/






From marco.atzeri at gmail.com  Sat Feb 24 08:59:54 2018
From: marco.atzeri at gmail.com (Marco Atzeri)
Date: Sat, 24 Feb 2018 17:59:54 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
Message-ID: <031929bc-da16-0e71-b12e-2304fbd15c95@gmail.com>

On 23/02/2018 20:19, Kristian Evers wrote:
> All,
> 
> I have prepared PROJ 5.0.0RC5. Downloads are here:
> 
> 
> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
> 
> 
> Since RC4 problems with vertical grid installation, the Horner 
> transformation and faulty polygon area calculation
> in geodesic library has been fixed. Hopefully this will be the final 
> release candidate. I will call for a vote for
> promotion to final release on the 27th. Unless serious issues are 
> discovered in the mean time.
> 
> /Kristian
> 

on cygwin 64 bit it passes most of the tests, except

-------------------------------------------------------------------------------
Reading file 
'/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/4D-API_cs2cs-style.gie'
-------------------------------------------------------------------------------
proj=latlong nadgrids=nzgd2kgrid0005.gsb ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 55:
        (null) (errno=PJD_ERR_UNKNOWN/0)
-------------------------------------------------------------------------------
proj=latlong geoidgrids=egm96_15.gtx ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 71:
        (null) (errno=PJD_ERR_UNKNOWN/0)
-------------------------------------------------------------------------------
proj=merc geoidgrids=egm96_15.gtx ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 84:
        (null) (errno=PJD_ERR_UNKNOWN/0)
-------------------------------------------------------------------------------
proj=latlong geoidgrids=egm96_15.gtx axis=neu ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 104:
        (null) (errno=PJD_ERR_UNKNOWN/0)
-------------------------------------------------------------------------------
proj=merc geoidgrids=egm96_15.gtx ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 124:
        (null) (errno=PJD_ERR_UNKNOWN/0)
-------------------------------------------------------------------------------
total:  4 tests succeeded,  7 tests skipped,  5 tests FAILED!

-------------------------------------------------------------------------------
PROJ_LIB=/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/nad 
../../src/gie 
/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/unitconvert.gie
-------------------------------------------------------------------------------
Reading file 
'/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/deformation.gie'
-------------------------------------------------------------------------------
total:  5 tests succeeded,  2 tests skipped,  2 tests FAILED!

-------------------------------------------------------------------------------
Reading file 
'/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/more_builtins.gie'
-------------------------------------------------------------------------------
proj=hgridshift grids=nzgd2kgrid0005.gsb ellps=GRS80
-------------------------------------------------------------------------------
Invalid operation definition in line no. 214:
        (null) (errno=PJD_ERR_UNKNOWN/0)
pj_cart_selftest fails with 64
-------------------------------------------------------------------------------
total: 44 tests succeeded,  2 tests skipped,  3 tests FAILED!
-------------------------------------------------------------------------------



From sebastic at xs4all.nl  Sat Feb 24 09:09:30 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 24 Feb 2018 18:09:30 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <031929bc-da16-0e71-b12e-2304fbd15c95@gmail.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<031929bc-da16-0e71-b12e-2304fbd15c95@gmail.com>
Message-ID: <84f7caf1-8bbc-02a5-5844-a49b12e8ac19@xs4all.nl>

On 02/24/2018 05:59 PM, Marco Atzeri wrote:
> on cygwin 64 bit it passes most of the tests, except
> 
> -------------------------------------------------------------------------------
> Reading file 
> '/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/4D-API_cs2cs-style.gie'
> -------------------------------------------------------------------------------
> proj=latlong nadgrids=nzgd2kgrid0005.gsb ellps=GRS80
> -------------------------------------------------------------------------------
> Invalid operation definition in line no. 55:
>         (null) (errno=PJD_ERR_UNKNOWN/0)

This is a known issue, see:

 https://github.com/OSGeo/proj.4/issues/819

The fix has been merged:

 https://github.com/OSGeo/proj.4/pull/820

Kind Regards,

Bas


From marco.atzeri at gmail.com  Sat Feb 24 09:43:51 2018
From: marco.atzeri at gmail.com (Marco Atzeri)
Date: Sat, 24 Feb 2018 18:43:51 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <84f7caf1-8bbc-02a5-5844-a49b12e8ac19@xs4all.nl>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<031929bc-da16-0e71-b12e-2304fbd15c95@gmail.com>
	<84f7caf1-8bbc-02a5-5844-a49b12e8ac19@xs4all.nl>
Message-ID: <2b9b0cb6-bf38-a0e0-6e5a-5521345b7f03@gmail.com>

On 24/02/2018 18:09, Sebastiaan Couwenberg wrote:
> On 02/24/2018 05:59 PM, Marco Atzeri wrote:
>> on cygwin 64 bit it passes most of the tests, except
>>
>> -------------------------------------------------------------------------------
>> Reading file
>> '/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/4D-API_cs2cs-style.gie'
>> -------------------------------------------------------------------------------
>> proj=latlong nadgrids=nzgd2kgrid0005.gsb ellps=GRS80
>> -------------------------------------------------------------------------------
>> Invalid operation definition in line no. 55:
>>          (null) (errno=PJD_ERR_UNKNOWN/0)
> 
> This is a known issue, see:
> 
>   https://github.com/OSGeo/proj.4/issues/819
> 
> The fix has been merged:
> 
>   https://github.com/OSGeo/proj.4/pull/820
> 
> Kind Regards,
> 
> Bas

Thanks Bas,
with that fix I see only one failure

-------------------------------------------------------------------------------
Reading file 
'/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.x86_64/src/proj-5.0.0/test/gie/more_builtins.gie'
pj_cart_selftest fails with 64
-------------------------------------------------------------------------------
total: 44 tests succeeded,  4 tests skipped,  1 tests FAILED!
-------------------------------------------------------------------------------

Not sure if this is due to test without datumgrid

Regards
Marco


From knudsen.thomas at gmail.com  Sat Feb 24 10:00:41 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Sat, 24 Feb 2018 19:00:41 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <2b9b0cb6-bf38-a0e0-6e5a-5521345b7f03@gmail.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<031929bc-da16-0e71-b12e-2304fbd15c95@gmail.com>
	<84f7caf1-8bbc-02a5-5844-a49b12e8ac19@xs4all.nl>
	<2b9b0cb6-bf38-a0e0-6e5a-5521345b7f03@gmail.com>
Message-ID: <CAH0YoEN0siGifHnE00RoPbRKe1ra0FbDrynY5BL5UPVvQRUR0w@mail.gmail.com>

Marco,

Thanks for testing! The error message you quote is the first test of
proj_grid_info(), so it very likely is due to missing grids.

/Thomas

2018-02-24 18:43 GMT+01:00 Marco Atzeri <marco.atzeri at gmail.com>:

> On 24/02/2018 18:09, Sebastiaan Couwenberg wrote:
> > On 02/24/2018 05:59 PM, Marco Atzeri wrote:
> >> on cygwin 64 bit it passes most of the tests, except
> >>
> >> ------------------------------------------------------------
> -------------------
> >> Reading file
> >> '/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.
> x86_64/src/proj-5.0.0/test/gie/4D-API_cs2cs-style.gie'
> >> ------------------------------------------------------------
> -------------------
> >> proj=latlong nadgrids=nzgd2kgrid0005.gsb ellps=GRS80
> >> ------------------------------------------------------------
> -------------------
> >> Invalid operation definition in line no. 55:
> >>          (null) (errno=PJD_ERR_UNKNOWN/0)
> >
> > This is a known issue, see:
> >
> >   https://github.com/OSGeo/proj.4/issues/819
> >
> > The fix has been merged:
> >
> >   https://github.com/OSGeo/proj.4/pull/820
> >
> > Kind Regards,
> >
> > Bas
>
> Thanks Bas,
> with that fix I see only one failure
>
> ------------------------------------------------------------
> -------------------
> Reading file
> '/cygdrive/e/cyg_pub/devel/proj/prova/proj-5.0.0-0.5a.
> x86_64/src/proj-5.0.0/test/gie/more_builtins.gie'
> pj_cart_selftest fails with 64
> ------------------------------------------------------------
> -------------------
> total: 44 tests succeeded,  4 tests skipped,  1 tests FAILED!
> ------------------------------------------------------------
> -------------------
>
> Not sure if this is due to test without datumgrid
>
> Regards
> Marco
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180224/d2ba7a80/attachment.html>

From jmckenna at gatewaygeomatics.com  Sat Feb 24 15:29:41 2018
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 24 Feb 2018 19:29:41 -0400
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
Message-ID: <51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>

Update: it seems many things were happening, causing me to look in wrong 
places.  But in the end MapServer was in fact reprojecting the points; 
what caused me total confusion was that I was testing with several 
MapServer-related applications that are part of MS4W (Mapbender, 
GeoMOOSE) and one application had a totally blank opening map image with 
PROJ v5.  In fact for some reason the old hardcoded map extents 
(displayed in EPSG:3857) no longer display the data (you have to now 
zoom out a bit to see the data, reprojected with PROJ v5).  I'll contact 
the GeoMOOSE team to let them dive into this (still, it could be my 
Windows environment, as no one else seems to be testing MapServer + PROJ 
v5 yet).

Very sorry for all this noise!

Short story: all is fine with RC5 here.

Thank you again Kristian for your passion driving this.

-jeff





On 2018-02-23 5:33 PM, Jeff McKenna wrote:
> Hi Kristian,
> 
> No problems here on Windows in the MS4W environment, but I'm running
> into odd errors when I have MapServer call PROJ 5
> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-February/015347.html).
>    Obviously an issue downstream not here, but I thought I'd at least
> mention it here that I am testing RC5 as well :)
> 
> Thanks for pushing this release along.
> 
> -jeff
> 
> 
> 
> 
> On 2018-02-23 3:19 PM, Kristian Evers wrote:
>> All,
>>
>> I have prepared PROJ 5.0.0RC5. Downloads are here:
>>
>>
>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
>>
>>
>> Since RC4 problems with vertical grid installation, the Horner
>> transformation and faulty polygon area calculation
>> in geodesic library has been fixed. Hopefully this will be the final
>> release candidate. I will call for a vote for
>> promotion to final release on the 27th. Unless serious issues are
>> discovered in the mean time.
>>
>> /Kristian
>>
>>


From kreve at sdfe.dk  Sun Feb 25 11:30:44 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Sun, 25 Feb 2018 19:30:44 +0000
Subject: [Proj] PROJ 5.0.0RC6
Message-ID: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>

All,

Yet another release candidate is ready. This time PROJ 5.0.0RC6. Downloads are here:


http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz.md5)

http://download.osgeo.org/proj/proj-5.0.0RC6.zip (http://download.osgeo.org/proj/proj-5.0.0RC6.zip.md5)


A few problems was discovered in the last RC. Mostly related to the testing system. Unless serious issues are
discovered with this RC I will call for a vote for promotion to final release on the 27th.

During the weekend it has been decided to split the datumgrids package into a core package and several
regional packages in order to keep file sizes tolerable for most users. This decision was made because of
the newly added Australian grids that are rather large compared to the rest of the grids in the package.
Tomorrow I will publish release candidates for the datumgrid packages.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180225/9bea80ab/attachment.html>

From kreve at sdfe.dk  Sun Feb 25 11:45:43 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Sun, 25 Feb 2018 19:45:43 +0000
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
	<51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
Message-ID: <19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>

Thanks for testing, Jeff. It is very appreciated. I hope you sort of your problems,
PROJ-related or not.

/Kristian

> On 25 Feb 2018, at 00:29, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> 
> Update: it seems many things were happening, causing me to look in wrong 
> places.  But in the end MapServer was in fact reprojecting the points; 
> what caused me total confusion was that I was testing with several 
> MapServer-related applications that are part of MS4W (Mapbender, 
> GeoMOOSE) and one application had a totally blank opening map image with 
> PROJ v5.  In fact for some reason the old hardcoded map extents 
> (displayed in EPSG:3857) no longer display the data (you have to now 
> zoom out a bit to see the data, reprojected with PROJ v5).  I'll contact 
> the GeoMOOSE team to let them dive into this (still, it could be my 
> Windows environment, as no one else seems to be testing MapServer + PROJ 
> v5 yet).
> 
> Very sorry for all this noise!
> 
> Short story: all is fine with RC5 here.
> 
> Thank you again Kristian for your passion driving this.
> 
> -jeff
> 
> 
> 
> 
> 
> On 2018-02-23 5:33 PM, Jeff McKenna wrote:
>> Hi Kristian,
>> 
>> No problems here on Windows in the MS4W environment, but I'm running
>> into odd errors when I have MapServer call PROJ 5
>> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-February/015347.html).
>>   Obviously an issue downstream not here, but I thought I'd at least
>> mention it here that I am testing RC5 as well :)
>> 
>> Thanks for pushing this release along.
>> 
>> -jeff
>> 
>> 
>> 
>> 
>> On 2018-02-23 3:19 PM, Kristian Evers wrote:
>>> All,
>>> 
>>> I have prepared PROJ 5.0.0RC5. Downloads are here:
>>> 
>>> 
>>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
>>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
>>> 
>>> 
>>> Since RC4 problems with vertical grid installation, the Horner
>>> transformation and faulty polygon area calculation
>>> in geodesic library has been fixed. Hopefully this will be the final
>>> release candidate. I will call for a vote for
>>> promotion to final release on the 27th. Unless serious issues are
>>> discovered in the mean time.
>>> 
>>> /Kristian
>>> 
>>> 
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From olli.raisa at trimble.com  Mon Feb 26 01:55:49 2018
From: olli.raisa at trimble.com (=?UTF-8?B?T2xsaSBSw6Rpc8Ok?=)
Date: Mon, 26 Feb 2018 11:55:49 +0200
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
Message-ID: <CAC8C3=ga8pniyD-BSLdGEO8rKm76P4d24v_kd8LfnHmweCUXSw@mail.gmail.com>

Hi,

These cct transformations should be identical, or am I missing something?

echo 13 52 0 | cct -t0 +proj=pipeline +step +init=epsg:4314 +inv +step
+init=epsg:4258
 12.9983317082   51.9986488216        0.0000        0.0000

echo 13 52 0 | cct -t0 +proj=pipeline +step +proj=longlat +datum=potsdam
+no_defs +inv +step +init=epsg:4258
 13.0000000000   52.0000000000        0.0000        0.0000

My PROJ_LIB directory is C:\PROJ\share that contains files from proj.4\nad
and proj-datumgrid-1.7RC1. These commands need epsg and BETA2007.gsb.

Definitions in epsg file:

# ETRS89
<4258> +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs  <>

# DHDN
<4314> +proj=longlat +datum=potsdam +no_defs  <>

Regards,
Olli

On 25 February 2018 at 21:30, Kristian Evers <kreve at sdfe.dk> wrote:

> All,
>
> Yet another release candidate is ready. This time PROJ 5.0.0RC6. Downloads
> are here:
>
>
> http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz (htt
> p://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz.md5)
>
> http://download.osgeo.org/proj/proj-5.0.0RC6.zip (http:/
> /download.osgeo.org/proj/proj-5.0.0RC6.zip.md5)
>
>
> A few problems was discovered in the last RC. Mostly related to the
> testing system. Unless serious issues are
> discovered with this RC I will call for a vote for promotion to final
> release on the 27th.
>
> During the weekend it has been decided to split the datumgrids package
> into a core package and several
> regional packages in order to keep file sizes tolerable for most users.
> This decision was made because of
> the newly added Australian grids that are rather large compared to the
> rest of the grids in the package.
> Tomorrow I will publish release candidates for the datumgrid packages.
>
> /Kristian
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/f1e2b8e9/attachment.html>

From knudsen.thomas at gmail.com  Mon Feb 26 06:27:53 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Mon, 26 Feb 2018 15:27:53 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <CAC8C3=ga8pniyD-BSLdGEO8rKm76P4d24v_kd8LfnHmweCUXSw@mail.gmail.com>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<CAC8C3=ga8pniyD-BSLdGEO8rKm76P4d24v_kd8LfnHmweCUXSw@mail.gmail.com>
Message-ID: <CAH0YoEOLFg72yF9sP8saj8QWV=Dd+E+2ttVB7QhVJmBec+oyqQ@mail.gmail.com>

Hi Olli,

Thanks for testing RC6! What you have found is really more a matter of
missing documentation than a bug in the handling of +datum.

The thing is that the support for cs2cs style datum definitions are for use
in init-files only: It was introduced in order to be able to use the
current epsg-file with the new API. It will (presumably) be removed once we
have a streamlined way of producing pipeline style versions of EPSG data.

So the brief message is that except for init files, cs2cs style modifiers
are for use in cs2cs only.

The somewhat longer background story:

In cs2cs, the command line input is split at “+to” before handling the two
parts using two separate calls to pj_init(). From pj_init(), +datum is
expanded through a call to pj_datum_set(), which stomps on the parameter
list, adding the expansion from hardcoded values in pj_datums.c.

But the initial splitting of the command line at “+to” implies that a
+datum definition in the “from” part will not spill over to the “to” part,
while the opposite is true in your pipeline example, which actually expands
to:

proj=pipeline no_defs step proj=longlat datum=potsdam inv step
init=epsg:4258 ellps=bessel nadgrids=@BETA2007.gsb

And due to unfortunate (but hard to avoid - the full tale is complicated)
interference between old and new syntax, the expansion of +datum=potsdam
(i.e. the two tokens ellps=bessel nadgrids=@BETA2007.gsb) takes effect in
*both* steps of the pipeline, essentially meaning that what you do is this:

proj=pipeline step proj=latlong datum=potsdam inv step proj=latlong
datum=potsdam

i.e. a back-and-forth dance on the spot.

Why does this not happen in the first case (i.e. the one with two
init-calls)? It does not happen because inits in pipelines are *not*
expanded by pj_init() but by the pipeline setup code in PJ_pipeline.c (see
pj_init.c around line 540 for the ugly details), where each pipeline step
is handled in a separate pj_init() call, much like in the cs2cs case.

Finally, 4 take home points:

1)

Do not use cs2cs style modifiers anywhere else than in cs2cs and in init
files.

2)

Even in init files: Avoid them and write a pipeline instead.

3)

The +init=epsg:4258 step in your pipeline (which defines the output system
as ETRS89) is necessary in the declarative cs2cs style, but superfluous in
the cct imperative style, where you can get away with

cct -I +init=epsg:4314

or

cct +proj=hgridshift +grids=BETA2007.gsb

Note the missing “-I” in the last case: The grid shift file takes us FROM
the Potsdam datum TO ETRS89, while the epsg:4314 entry (in loose terms)
“defines” the Potsdam datum in terms of ETRS89.

Essentially it is a matter of sign conventions, which can give rise to much
confusion. So...

4)

Geodesy is often hard to grasp, but not always due to complex mathematical
and geophysical reasoning.


/Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/6801032d/attachment.html>

From Roger.Bivand at nhh.no  Mon Feb 26 07:09:28 2018
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Feb 2018 08:09:28 -0700 (MST)
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
Message-ID: <1519657768595-0.post@n6.nabble.com>

Hi,

RC6 is OK for the R packages sf and rgdal, and we can filter out 5.0.0
specific bits (like the change in PJ_UNITS) satisfactorily.

Thanks very much for reaching a sensible way of handling the size of
nadgrids; the new grids are all useful, but not all of them for every user.
Looking forward to the RC!

Roger



-----
Roger Bivand
NHH Norwegian School of Economics, Bergen, Norway
--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From olli.raisa at trimble.com  Mon Feb 26 10:04:48 2018
From: olli.raisa at trimble.com (=?UTF-8?B?T2xsaSBSw6Rpc8Ok?=)
Date: Mon, 26 Feb 2018 20:04:48 +0200
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <CAH0YoEOLFg72yF9sP8saj8QWV=Dd+E+2ttVB7QhVJmBec+oyqQ@mail.gmail.com>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<CAC8C3=ga8pniyD-BSLdGEO8rKm76P4d24v_kd8LfnHmweCUXSw@mail.gmail.com>
	<CAH0YoEOLFg72yF9sP8saj8QWV=Dd+E+2ttVB7QhVJmBec+oyqQ@mail.gmail.com>
Message-ID: <CAC8C3=hRr9H5ykwzBN5TtbgMzaSwY3ci=8mUE0rYwgWRKSreoA@mail.gmail.com>

Thomas,

Thank you for the explanation. These parameter expansions appear to be more
complicated than I had assumed.

What do you think about checking old-style parameter compatibility in
pipeline setup, and handling unsupported cases as errors? This being not a
suggestion for 5.0.0, but for future development.

Regards,
Olli


On 26 February 2018 at 16:27, Thomas Knudsen <knudsen.thomas at gmail.com>
wrote:

>
> Hi Olli,
>
> Thanks for testing RC6! What you have found is really more a matter of
> missing documentation than a bug in the handling of +datum.
>
> The thing is that the support for cs2cs style datum definitions are for
> use in init-files only: It was introduced in order to be able to use the
> current epsg-file with the new API. It will (presumably) be removed once we
> have a streamlined way of producing pipeline style versions of EPSG data.
>
> So the brief message is that except for init files, cs2cs style modifiers
> are for use in cs2cs only.
>
> The somewhat longer background story:
>
> In cs2cs, the command line input is split at “+to” before handling the two
> parts using two separate calls to pj_init(). From pj_init(), +datum is
> expanded through a call to pj_datum_set(), which stomps on the parameter
> list, adding the expansion from hardcoded values in pj_datums.c.
>
> But the initial splitting of the command line at “+to” implies that a
> +datum definition in the “from” part will not spill over to the “to” part,
> while the opposite is true in your pipeline example, which actually expands
> to:
>
> proj=pipeline no_defs step proj=longlat datum=potsdam inv step
> init=epsg:4258 ellps=bessel nadgrids=@BETA2007.gsb
>
> And due to unfortunate (but hard to avoid - the full tale is complicated)
> interference between old and new syntax, the expansion of +datum=potsdam
> (i.e. the two tokens ellps=bessel nadgrids=@BETA2007.gsb) takes effect in
> *both* steps of the pipeline, essentially meaning that what you do is this:
>
> proj=pipeline step proj=latlong datum=potsdam inv step proj=latlong
> datum=potsdam
>
> i.e. a back-and-forth dance on the spot.
>
> Why does this not happen in the first case (i.e. the one with two
> init-calls)? It does not happen because inits in pipelines are *not*
> expanded by pj_init() but by the pipeline setup code in PJ_pipeline.c (see
> pj_init.c around line 540 for the ugly details), where each pipeline step
> is handled in a separate pj_init() call, much like in the cs2cs case.
>
> Finally, 4 take home points:
>
> 1)
>
> Do not use cs2cs style modifiers anywhere else than in cs2cs and in init
> files.
>
> 2)
>
> Even in init files: Avoid them and write a pipeline instead.
>
> 3)
>
> The +init=epsg:4258 step in your pipeline (which defines the output system
> as ETRS89) is necessary in the declarative cs2cs style, but superfluous in
> the cct imperative style, where you can get away with
>
> cct -I +init=epsg:4314
>
> or
>
> cct +proj=hgridshift +grids=BETA2007.gsb
>
> Note the missing “-I” in the last case: The grid shift file takes us FROM
> the Potsdam datum TO ETRS89, while the epsg:4314 entry (in loose terms)
> “defines” the Potsdam datum in terms of ETRS89.
>
> Essentially it is a matter of sign conventions, which can give rise to
> much confusion. So...
>
> 4)
>
> Geodesy is often hard to grasp, but not always due to complex mathematical
> and geophysical reasoning.
>
>
> /Thomas
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/a20a97af/attachment.html>

From kreve at sdfe.dk  Mon Feb 26 13:12:43 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Mon, 26 Feb 2018 21:12:43 +0000
Subject: [Proj] Proj-datumgrid release candidate(s)
Message-ID: <AC0AF266-AD97-4FDE-AC58-F5D12DBD6819@sdfe.dk>

All,

As mentioned in the PROJ 5.0.0RC6 announcement, it has been deemed necessary to
split the proj-datumgrid package into several distributions. This was sparked by the
recently  added grids from Australia which are rather large compared to the rest of the
grids in the package. Therefore it was decided to instead distribute several packages:
A “core” package [1] with the bare necessities for a usable installation of PROJ and several
regional  packages. So far packages with PROJ resources (some packages include
init-files as well) covering Europe [2], North America [3] and Oceania [4] have been
created. If needed other packages can be added in the future.
See [1], [2], [3] and [4] for details on the various packages.

The division into several packages allow users of PROJ to only include the resources they
need, while also letting projects like QGIS include all the available grids by simply stating
that all the available grid packages are dependencies for the software. It is my hope that
this solution fits as many users needs as possible.

The resource package release candidates can be downloaded here:

http://download.osgeo.org/proj/proj-datumgrid-1.7RC2.tar.gz || http://download.osgeo.org/proj/proj-datumgrid-1.7RC2.zip

http://download.osgeo.org/proj/proj-datumgrid-europe-1.0RC1.tar.gz || http://download.osgeo.org/proj/proj-datumgrid-europe-1.0RC1.zip
http://download.osgeo.org/proj/proj-datumgrid-north-america-1.0RC1.tar.gz || http://download.osgeo.org/proj/proj-datumgrid-north-america-1.0RC1.zip
http://download.osgeo.org/proj/proj-datumgrid-oceania-1.0RC1.tar.gz || http://download.osgeo.org/proj/proj-datumgrid-oceania-1.0RC1.zip

Unless serious problems are found in the above packages they will be released as final
versions on March 1st alongside PROJ 5.0.0.

Please have patience with the downloads - due to the recent QGIS3 release the
servers are under heavy load at the moment.


/Kristian

[0] Some of the packages also include init-files.
[1] https://github.com/OSGeo/proj-datumgrid
[2] https://github.com/OSGeo/proj-datumgrid/tree/master/europe
[3] https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
[4] https://github.com/OSGeo/proj-datumgrid/tree/master/oceania

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/e8e9d50d/attachment.html>

From gdt at lexort.com  Mon Feb 26 17:57:44 2018
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 26 Feb 2018 20:57:44 -0500
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk> (Kristian Evers's
	message of "Sun, 25 Feb 2018 19:30:44 +0000")
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
Message-ID: <smur2p742jr.fsf@linuxpal.mit.edu>


Kristian Evers <kreve at sdfe.dk> writes:

> Yet another release candidate is ready. This time PROJ 5.0.0RC6. Downloads are here:
>
> http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz.md5)

I am the maintainer for the pkgsrc package of proj, and have been a bit
distracted, so this is the first RC I tested.

A nit is that it unpacks to proj-5.0.0 instead of proj-5.0.0RC6, but
that's unimportant and will vanish with the release.

I used the configure method on NetBSD 7 amd64 (because that's how 4 was
built).  It built without errors, and passed the tests.  The set of
installed files changed, but in ways that are not surprising.

I built and tested with the older proj-datumgrids-1.5, because that is
what the previous build worked with.

NEWS does not clearly say that the shlib major version is changing in
this release. There is a lot of talk about API changing, but a total ABI
break should be mentioned, not because it is bad or unexpected to me,
but because it means that users and packaging systems have to arrange to
rebuild everything that depends on proj.  That's actually a core
function of packaging systems, to keep track of this and arrange for it.
This is not actually bothering me, since I know, and it should be fairly
obvious given the tone of the text, but adding functions does not
require a shlib bump, only withdrawing them, and I did not see what is
being withdrawn.

> During the weekend it has been decided to split the datumgrids package into a core package and several
> regional packages in order to keep file sizes tolerable for most users. This decision was made because of
> the newly added Australian grids that are rather large compared to the rest of the grids in the package.
> Tomorrow I will publish release candidates for the datumgrid packages.

The NEWS file says that proj-datumgrids version is 1.6.0, but it does
not explain how that should be used in terms of extracting and
installing, whether it should be part of a proj package (in a packaging
system), or in a separate proj-datumgrid package (or packages).   There
is some implication from the past that the datumgrids must be present to
run regression tests, but this is not clear.

The README does not explain how to run tests.  The patch at end helps,
but is silent on the question of datumgrids.


Finally, for an update of this magnitude, my total time to test and and
nitpick is very small, so I congratulate you all on an excellent job.




$NetBSD: patch-README,v 1.2 2015/09/13 23:22:23 gdt Exp $

Sent upstream by email 20120309.

--- README.orig	2018-02-25 19:20:40.000000000 +0000
+++ README
@@ -101,3 +101,12 @@ conversion grid files is also available.
 distributed under the name `proj-datumgrid-x.y.zip`, where "x" is the
 major release version and "y" the minor release version numbers.
 The grid package can be downloaded from the PROJ.4 website.
+
+## Testing
+
+To test, execute:
+
+        make check
+
+Note that you must have installed proj-datumgrid-1.5 in nad prior to
+building; the test suite includes grid shift tests.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/d99e1346/attachment.sig>

From gdt at lexort.com  Mon Feb 26 18:03:23 2018
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 26 Feb 2018 21:03:23 -0500
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <smur2p742jr.fsf@linuxpal.mit.edu> (Greg Troxel's message of
	"Mon, 26 Feb 2018 20:57:44 -0500")
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
Message-ID: <smumuzv42ac.fsf@linuxpal.mit.edu>


Greg Troxel <gdt at lexort.com> writes:

> The NEWS file says that proj-datumgrids version is 1.6.0, but it does
> not explain how that should be used in terms of extracting and
> installing, whether it should be part of a proj package (in a packaging
> system), or in a separate proj-datumgrid package (or packages).   There
> is some implication from the past that the datumgrids must be present to
> run regression tests, but this is not clear.

I was unable to download the 1.6.0 mentioned in the NEWS file.  Looking
at http://download.osgeo.org/proj/ I can see why :-)

I am left unclear on which of the following I should package and how.
Judging by timestamps, it looks like all 4 are appropriate for a
world-wide distribution, and I would guess that 1.7 includes other than
EU/NA/Oceania.  But, I don't get why the others aren't also 1.7 if they
go together.

proj-datumgrid-1.7RC2
proj-datumgrid-europe-1.0RC1
proj-datumgrid-northamerica-1.0RC1
proj-datumgrid-oceania-1.0RC1


I see docs from 2007, but not from 5.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180226/4343febb/attachment.sig>

From sebastic at xs4all.nl  Mon Feb 26 22:16:23 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Tue, 27 Feb 2018 07:16:23 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <smur2p742jr.fsf@linuxpal.mit.edu>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
Message-ID: <350e07b8-16b0-cdd2-d2ee-ae6066a6a698@xs4all.nl>

On 02/27/2018 02:57 AM, Greg Troxel wrote:
> I built and tested with the older proj-datumgrids-1.5, because that is
> what the previous build worked with.

You should have updated to proj-datumgrid-1.6 with proj 4.9.3 for the
ctable2 format grids, no need to build the .lla files with nad2bin any
more as ctable2 is architecture independent.

Kind Regards,

Bas

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180227/633fb472/attachment.sig>

From sebastic at xs4all.nl  Mon Feb 26 22:27:03 2018
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Tue, 27 Feb 2018 07:27:03 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <smumuzv42ac.fsf@linuxpal.mit.edu>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu> <smumuzv42ac.fsf@linuxpal.mit.edu>
Message-ID: <a636a321-b5b2-9144-17b5-4f1a03817c24@xs4all.nl>

On 02/27/2018 03:03 AM, Greg Troxel wrote:
> Greg Troxel <gdt at lexort.com> writes:
> 
>> The NEWS file says that proj-datumgrids version is 1.6.0, but it does
>> not explain how that should be used in terms of extracting and
>> installing, whether it should be part of a proj package (in a packaging
>> system), or in a separate proj-datumgrid package (or packages).   There
>> is some implication from the past that the datumgrids must be present to
>> run regression tests, but this is not clear.

The grids in proj-datumgrid are used in the proj testsuite, hence
unpacking the content of that archive into the nad/ directory of the
proj source as packagers have done for many years is still highly
recommended.

The grids from proj-datumgrid are optional for the proj build, though.
Since proj 4.9 the build system was updated to no longer fail if the
grids are not present, allowing the grids to be unpackaged into
/usr/share/proj after installation (using a separate package for example).

> I was unable to download the 1.6.0 mentioned in the NEWS file.  Looking
> at http://download.osgeo.org/proj/ I can see why :-)

The proj-datumgrid RCs were published after the proj RCs, this still
needs to be reflected in the proj documentation.

> I am left unclear on which of the following I should package and how.
> Judging by timestamps, it looks like all 4 are appropriate for a
> world-wide distribution, and I would guess that 1.7 includes other than
> EU/NA/Oceania.  But, I don't get why the others aren't also 1.7 if they
> go together.
> 
> proj-datumgrid-1.7RC2

You should at least include this as its the successor of the previous
proj-datumgrid-1.5 & 1.6 releases, which packagers have included in proj
for many years.

> proj-datumgrid-europe-1.0RC1
> proj-datumgrid-northamerica-1.0RC1
> proj-datumgrid-oceania-1.0RC1

There are optional. Ideally they are packaged separately to allow users
in those regions to easily install those grids.

Personally I'm not going to package those releases for Debian until
users actually request packages for those.

> I see docs from 2007, but not from 5.

Docs are still a work in progress, see:

 https://github.com/OSGeo/proj.4/pull/577

Kind Regards,

Bas

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180227/bf82be14/attachment.sig>

From stevejking at talktalk.net  Mon Feb 26 23:43:09 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 27 Feb 2018 00:43:09 -0700 (MST)
Subject: [Proj] Understanding deformation model usage
Message-ID: <1519717389403-0.post@n6.nabble.com>

Kristian,
I think I follow your (in development) user guide example here. Very useful
thanks.
https://kbevers.github.io/usage/operations/transformations/deformation.html

But if the velocity shifts are tied to Cartesian coordinates, surely this is
only the average velocities at the coordinate at a moment in time. There is
no parameter to specify a *grids_epoch.

Eg. What to do If my grid is Cartesian coordinates and velocities at epoch
2010.0, t_obs=2000.0 and t_epoch=2017.0?
Perhaps this is achieved by ensuring in individual steps that t_obs or
t_epoch always equals *grids_epoch ? I think that’s what your example does?

*grids_epoch is a made up function to illustrate.

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From stevejking at talktalk.net  Tue Feb 27 00:33:55 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 27 Feb 2018 01:33:55 -0700 (MST)
Subject: [Proj] Understanding deformation model usage
In-Reply-To: <1519717389403-0.post@n6.nabble.com>
References: <1519717389403-0.post@n6.nabble.com>
Message-ID: <1519720435628-0.post@n6.nabble.com>

I can see t_obs is always the *grid_epoch, except when you do an inverse (by
swapping t_epoch and t_obs).



stevejking wrote
> Kristian,
> I think I follow your (in development) user guide example here. Very
> useful
> thanks.
> https://kbevers.github.io/usage/operations/transformations/deformation.html
> 
> But if the velocity shifts are tied to Cartesian coordinates, surely this
> is
> only the average velocities at the coordinate at a moment in time. There
> is
> no parameter to specify a *grids_epoch.
> 
> Eg. What to do If my grid is Cartesian coordinates and velocities at epoch
> 2010.0, t_obs=2000.0 and t_epoch=2017.0?
> Can be achieved by ensuring in individual steps that t_obs or
> t_epoch always equals *grids_epoch ? I think that’s what your example
> does?
> 
> *grids_epoch is a made up option to illustrate.
> 
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj





--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Tue Feb 27 01:35:49 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 27 Feb 2018 09:35:49 +0000
Subject: [Proj] Understanding deformation model usage
In-Reply-To: <1519720435628-0.post@n6.nabble.com>
References: <1519717389403-0.post@n6.nabble.com>
	<1519720435628-0.post@n6.nabble.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC56DDB@S000014.PROD.SITAD.DK>

Steve,

I was considering just calling them t_a and t_b or something like that to illustrate that what really matters is the difference between the two since it is all relative. Which t comes first dictates how the grid is applied (added or subtracted). 
The way I think about it is that we are moving a coordinate at time t_obs backwards or forwards in time to t_epoch. In the example in the docs the last step is applying the deformation model on a coordinate at t_obs=2000.0 which we want to move back in time to t_epoch=1994.704 (which is the epoch of the Danish ETRS89 realisation). After the deformation model has been applied we have subtracted ~5 years' worth of land uplift.

I hope that helps you understand this better.

/Kristian

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
Sendt: 27. februar 2018 09:34
Til: proj at lists.maptools.org
Emne: Re: [Proj] Understanding deformation model usage

I can see t_obs is always the *grid_epoch, except when you do an inverse (by
swapping t_epoch and t_obs).



stevejking wrote
> Kristian,
> I think I follow your (in development) user guide example here. Very
> useful
> thanks.
> https://kbevers.github.io/usage/operations/transformations/deformation.html
> 
> But if the velocity shifts are tied to Cartesian coordinates, surely this
> is
> only the average velocities at the coordinate at a moment in time. There
> is
> no parameter to specify a *grids_epoch.
> 
> Eg. What to do If my grid is Cartesian coordinates and velocities at epoch
> 2010.0, t_obs=2000.0 and t_epoch=2017.0?
> Can be achieved by ensuring in individual steps that t_obs or
> t_epoch always equals *grids_epoch ? I think that’s what your example
> does?
> 
> *grids_epoch is a made up option to illustrate.
> 
> Steve
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj





--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

From kreve at sdfe.dk  Tue Feb 27 02:20:23 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Tue, 27 Feb 2018 10:20:23 +0000
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <smur2p742jr.fsf@linuxpal.mit.edu>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>

Thanks for you feedback, Greg. It is very appreciated.

I think Bas has commented on most issues already so I'll skip that. I have updated
the NEWS and README files to take your comments into account:

https://github.com/OSGeo/proj.4/pull/828

Let me know if I've missed something or described things in an unclear way.

/Kristian

-----Oprindelig meddelelse-----
Fra: Greg Troxel [mailto:gdt at lexort.com] 
Sendt: 27. februar 2018 02:58
Til: Kristian Evers <kreve at sdfe.dk>
Cc: PROJ.4 and general Projections Discussions <proj at lists.maptools.org>
Emne: Re: [Proj] PROJ 5.0.0RC6


Kristian Evers <kreve at sdfe.dk> writes:

> Yet another release candidate is ready. This time PROJ 5.0.0RC6. Downloads are here:
>
> http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC6.tar.gz.md5)

I am the maintainer for the pkgsrc package of proj, and have been a bit
distracted, so this is the first RC I tested.

A nit is that it unpacks to proj-5.0.0 instead of proj-5.0.0RC6, but
that's unimportant and will vanish with the release.

I used the configure method on NetBSD 7 amd64 (because that's how 4 was
built).  It built without errors, and passed the tests.  The set of
installed files changed, but in ways that are not surprising.

I built and tested with the older proj-datumgrids-1.5, because that is
what the previous build worked with.

NEWS does not clearly say that the shlib major version is changing in
this release. There is a lot of talk about API changing, but a total ABI
break should be mentioned, not because it is bad or unexpected to me,
but because it means that users and packaging systems have to arrange to
rebuild everything that depends on proj.  That's actually a core
function of packaging systems, to keep track of this and arrange for it.
This is not actually bothering me, since I know, and it should be fairly
obvious given the tone of the text, but adding functions does not
require a shlib bump, only withdrawing them, and I did not see what is
being withdrawn.

> During the weekend it has been decided to split the datumgrids package into a core package and several
> regional packages in order to keep file sizes tolerable for most users. This decision was made because of
> the newly added Australian grids that are rather large compared to the rest of the grids in the package.
> Tomorrow I will publish release candidates for the datumgrid packages.

The NEWS file says that proj-datumgrids version is 1.6.0, but it does
not explain how that should be used in terms of extracting and
installing, whether it should be part of a proj package (in a packaging
system), or in a separate proj-datumgrid package (or packages).   There
is some implication from the past that the datumgrids must be present to
run regression tests, but this is not clear.

The README does not explain how to run tests.  The patch at end helps,
but is silent on the question of datumgrids.


Finally, for an update of this magnitude, my total time to test and and
nitpick is very small, so I congratulate you all on an excellent job.




$NetBSD: patch-README,v 1.2 2015/09/13 23:22:23 gdt Exp $

Sent upstream by email 20120309.

--- README.orig	2018-02-25 19:20:40.000000000 +0000
+++ README
@@ -101,3 +101,12 @@ conversion grid files is also available.
 distributed under the name `proj-datumgrid-x.y.zip`, where "x" is the
 major release version and "y" the minor release version numbers.
 The grid package can be downloaded from the PROJ.4 website.
+
+## Testing
+
+To test, execute:
+
+        make check
+
+Note that you must have installed proj-datumgrid-1.5 in nad prior to
+building; the test suite includes grid shift tests.


From stevejking at talktalk.net  Tue Feb 27 05:47:59 2018
From: stevejking at talktalk.net (stevejking)
Date: Tue, 27 Feb 2018 06:47:59 -0700 (MST)
Subject: [Proj] Understanding deformation model usage
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC56DDB@S000014.PROD.SITAD.DK>
References: <1519717389403-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC56DDB@S000014.PROD.SITAD.DK>
Message-ID: <1519739279217-0.post@n6.nabble.com>

Yes better understood now。Thanks Kristian



Kristian Evers-2 wrote
> Steve,
> 
> I was considering just calling them t_a and t_b or something like that to
> illustrate that what really matters is the difference between the two
> since it is all relative. Which t comes first dictates how the grid is
> applied (added or subtracted). 
> The way I think about it is that we are moving a coordinate at time t_obs
> backwards or forwards in time to t_epoch. In the example in the docs the
> last step is applying the deformation model on a coordinate at
> t_obs=2000.0 which we want to move back in time to t_epoch=1994.704 (which
> is the epoch of the Danish ETRS89 realisation). After the deformation
> model has been applied we have subtracted ~5 years' worth of land uplift.
> 
> I hope that helps you understand this better.
> 
> /Kristian
> 
> -----Oprindelig meddelelse-----
> Fra: 

> proj-bounces at .maptools

>  [mailto:

> proj-bounces at .maptools

> ] På vegne af stevejking
> Sendt: 27. februar 2018 09:34
> Til: 

> proj at .maptools

> Emne: Re: [Proj] Understanding deformation model usage
> 
> I can see t_obs is always the *grid_epoch, except when you do an inverse
> (by
> swapping t_epoch and t_obs).
> 
> 
> 
> stevejking wrote
>> Kristian,
>> I think I follow your (in development) user guide example here. Very
>> useful
>> thanks.
>> https://kbevers.github.io/usage/operations/transformations/deformation.html
>> 
>> But if the velocity shifts are tied to Cartesian coordinates, surely this
>> is
>> only the average velocities at the coordinate at a moment in time. There
>> is
>> no parameter to specify a *grids_epoch.
>> 
>> Eg. What to do If my grid is Cartesian coordinates and velocities at
>> epoch
>> 2010.0, t_obs=2000.0 and t_epoch=2017.0?
>> Can be achieved by ensuring in individual steps that t_obs or
>> t_epoch always equals *grids_epoch ? I think that’s what your example
>> does?
>> 
>> *grids_epoch is a made up option to illustrate.
>> 
>> Steve
>> 
>> 
>> 
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
>> _______________________________________________
>> Proj mailing list
>> 

> Proj at .maptools

>> http://lists.maptools.org/mailman/listinfo/proj
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
> _______________________________________________
> Proj mailing list

> Proj at .maptools

> http://lists.maptools.org/mailman/listinfo/proj
> _______________________________________________
> Proj mailing list

> Proj at .maptools

> http://lists.maptools.org/mailman/listinfo/proj





--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From gdt at lexort.com  Tue Feb 27 06:11:11 2018
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 27 Feb 2018 09:11:11 -0500
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	(Kristian Evers's message of "Tue, 27 Feb 2018 10:20:23 +0000")
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
Message-ID: <smu8tbe4j5s.fsf@linuxpal.mit.edu>


Kristian Evers <kreve at sdfe.dk> writes:

> Thanks for you feedback, Greg. It is very appreciated.
>
> I think Bas has commented on most issues already so I'll skip that. I have updated
> the NEWS and README files to take your comments into account:
>
> https://github.com/OSGeo/proj.4/pull/828
>
> Let me know if I've missed something or described things in an unclear way.

Thanks - that almost entirely addresses things.


A further comment, and I don't mean to suggest that the release be held
up:

The text talks about how the regional ones are not essential but could
be useful.  That seems fair.  But, as a user, how do I find out what is
in them, or what I need, other than by downloading them and inspecting
them?

As a packager, what should I do?  For now, I will include the main file
in the package, following tradition, and not worry about the new ones.
I am guessing that this means the grids for the important datums are
still in the main file, even if they are a North American Datum, and the
north-america file contains only more obscure datums that were not
previously available.  I originally had the impression that all North
American grids were demoted from the main file to the regional file.

I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and I
see that this added two files compared to 1.5 (which I should have
updated but didn't), and did not withdraw any.

So I have convinced myself that using the main file for the package, and
deferring thinking about the new files is a good approach.


So it might help to add

  All grids that were in proj-datumgrids-1.6 remain in
  proj-datumgrids-1.7; the regional datumgrid files contain grids for
  datums not previously supported.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180227/26c2657e/attachment.sig>

From gdt at lexort.com  Tue Feb 27 06:14:58 2018
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 27 Feb 2018 09:14:58 -0500
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <a636a321-b5b2-9144-17b5-4f1a03817c24@xs4all.nl> (Sebastiaan
	Couwenberg's message of "Tue, 27 Feb 2018 07:27:03 +0100")
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu> <smumuzv42ac.fsf@linuxpal.mit.edu>
	<a636a321-b5b2-9144-17b5-4f1a03817c24@xs4all.nl>
Message-ID: <smu4lm24izh.fsf@linuxpal.mit.edu>


Sebastiaan Couwenberg <sebastic at xs4all.nl> writes:

> The grids in proj-datumgrid are used in the proj testsuite, hence
> unpacking the content of that archive into the nad/ directory of the
> proj source as packagers have done for many years is still highly
> recommended.
>
> The grids from proj-datumgrid are optional for the proj build, though.
> Since proj 4.9 the build system was updated to no longer fail if the
> grids are not present, allowing the grids to be unpackaged into
> /usr/share/proj after installation (using a separate package for example).

Thanks.  Given that proj with proj-datumgrids is 7 MB installed, I am
not inclined to try to split it (especially since the tests need thme)
unless somebody complains.

>> I am left unclear on which of the following I should package and how.
>> Judging by timestamps, it looks like all 4 are appropriate for a
>> world-wide distribution, and I would guess that 1.7 includes other than
>> EU/NA/Oceania.  But, I don't get why the others aren't also 1.7 if they
>> go together.
>> 
>> proj-datumgrid-1.7RC2
>
> You should at least include this as its the successor of the previous
> proj-datumgrid-1.5 & 1.6 releases, which packagers have included in proj
> for many years.

Thanks, and done in my draft 5.0.0 package.

>> proj-datumgrid-europe-1.0RC1
>> proj-datumgrid-northamerica-1.0RC1
>> proj-datumgrid-oceania-1.0RC1
>
> There are optional. Ideally they are packaged separately to allow users
> in those regions to easily install those grids.
>
> Personally I'm not going to package those releases for Debian until
> users actually request packages for those.

Now that I understand that they are new bits not previously offered, and
not a reorganization of the existing bits into regions, I agree with
your approach and will follow it also.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180227/5e5b2d9f/attachment.sig>

From sebastic at xs4all.nl  Tue Feb 27 07:49:00 2018
From: sebastic at xs4all.nl (Bas Couwenberg)
Date: Tue, 27 Feb 2018 16:49:00 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <smu8tbe4j5s.fsf@linuxpal.mit.edu>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
Message-ID: <f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>

On 2018-02-27 15:11, Greg Troxel wrote:
> Kristian Evers <kreve at sdfe.dk> writes:
> 
>> Thanks for you feedback, Greg. It is very appreciated.
>> 
>> I think Bas has commented on most issues already so I'll skip that. I 
>> have updated
>> the NEWS and README files to take your comments into account:
>> 
>> https://github.com/OSGeo/proj.4/pull/828
>> 
>> Let me know if I've missed something or described things in an unclear 
>> way.
> 
> Thanks - that almost entirely addresses things.
> 
> 
> A further comment, and I don't mean to suggest that the release be held
> up:
> 
> The text talks about how the regional ones are not essential but could
> be useful.  That seems fair.  But, as a user, how do I find out what is
> in them, or what I need, other than by downloading them and inspecting
> them?

Use the source, Luke. :-)

  https://github.com/OSGeo/proj-datumgrid

Specific subdirectories for the regional packages:

  https://github.com/OSGeo/proj-datumgrid/tree/master/europe
  https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
  https://github.com/OSGeo/proj-datumgrid/tree/master/oceania

> As a packager, what should I do?  For now, I will include the main file
> in the package, following tradition, and not worry about the new ones.
> I am guessing that this means the grids for the important datums are
> still in the main file, even if they are a North American Datum, and 
> the
> north-america file contains only more obscure datums that were not
> previously available.  I originally had the impression that all North
> American grids were demoted from the main file to the regional file.

proj-datumgrid-north-america includes grids for Greenland.

The "old" NAD grids for North America are still included in the core 
proj-datumgrid package as they have been since pretty much forever.

The filename and content of the proj-datumgrid was explicitly kept the 
same to not require any changes from packagers other than the version 
number.

That is also why the .zip format was kept, and in addition a .tar.gz is 
available as well.

> I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and I
> see that this added two files compared to 1.5 (which I should have
> updated but didn't), and did not withdraw any.
> 
> So I have convinced myself that using the main file for the package, 
> and
> deferring thinking about the new files is a good approach.
> 
> 
> So it might help to add
> 
>   All grids that were in proj-datumgrids-1.6 remain in
>   proj-datumgrids-1.7; the regional datumgrid files contain grids for
>   datums not previously supported.

Where do you suggest to add this?

Kind Regards,

Bas


From gdt at lexort.com  Tue Feb 27 15:50:55 2018
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 27 Feb 2018 18:50:55 -0500
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl> (Bas Couwenberg's
	message of "Tue, 27 Feb 2018 16:49:00 +0100")
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
Message-ID: <smuwoyy0z6o.fsf@linuxpal.mit.edu>


Bas Couwenberg <sebastic at xs4all.nl> writes:

> On 2018-02-27 15:11, Greg Troxel wrote:
>> So it might help to add
>> 
>>   All grids that were in proj-datumgrids-1.6 remain in
>>   proj-datumgrids-1.7; the regional datumgrid files contain grids for
>>   datums not previously supported.
>
> Where do you suggest to add this?

On whatever the main page is for the proj-datumgrids distribution, plus
anyplace that talks about where to get grids.  And probably it belongs
in the NEWS file with the datumgrid distribution.   But I meant in
proj's README, at the end  of this paragraph:

  In addition to the PROJ software package, a distribution of datum
  conversion grid files is also available. The grid package is
  distributed under the name `proj-datumgrid-x.y.zip`, where "x" is the
  major release version and "y" the minor release version numbers.
  The grid package can be downloaded from the PROJ.4 website.


I certainly get it that I can figure all this out from looking at source
repos.  My only point was that we have just moved from a world where
there used to be "the grid distribution file" and now there are 4, and
it's not obvious from the names.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 162 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180227/a2d9746e/attachment.sig>

From matthias.gabriel at etit.tu-chemnitz.de  Wed Feb 28 00:12:30 2018
From: matthias.gabriel at etit.tu-chemnitz.de (Matthias Gabriel)
Date: Wed, 28 Feb 2018 09:12:30 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
Message-ID: <d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>

Hi,

I still have a problem using proj4 RC6 on Windows... I try to calculate 
the "round-trip" from WGS84 ->  UTM -> WGS84 using the following two 
pipelines in a unit-test:

+proj=pipeline +step +inv
+proj=lonlat +datum=WGS84 +ellps=WGS84
+step
+proj=utm +zone=33

and its inverse:

+proj=pipeline +step +inv
+proj=utm +zone=33
+step
+proj=lonlat +datum=WGS84 +ellps=WGS84

My test-values are 12.0° 50.0° 306m - of course they are converted into 
radians before. I apply the first projection, get an intermediate (UTM) 
result and then immediately apply the second pipeline and get again 
lonlat in WGS84. Then I compare both WGS84.

On Linux x64 and aarch64 that unit-test succeeds and the result of 
applying both pipelines is again 12° and 50°. On Windows VS 15 2017 
amd64 its not the case. It seems that the second a application of the 
pipeline has no effect, the PJ_COORD still contains the UTM coordinates. 
Not even an error is raised (proj_errno equals 0 for the projection ptr) 
and of course my unittest fails.

I'm not an expert on projections but as this test succeeds on linux I 
find it rather strange...

Regards,
Matthias



On 27/02/18 16:49, Bas Couwenberg wrote:
> On 2018-02-27 15:11, Greg Troxel wrote:
>> Kristian Evers <kreve at sdfe.dk> writes:
>>
>>> Thanks for you feedback, Greg. It is very appreciated.
>>>
>>> I think Bas has commented on most issues already so I'll skip that. I
>>> have updated
>>> the NEWS and README files to take your comments into account:
>>>
>>> https://github.com/OSGeo/proj.4/pull/828
>>>
>>> Let me know if I've missed something or described things in an unclear
>>> way.
>> Thanks - that almost entirely addresses things.
>>
>>
>> A further comment, and I don't mean to suggest that the release be held
>> up:
>>
>> The text talks about how the regional ones are not essential but could
>> be useful.  That seems fair.  But, as a user, how do I find out what is
>> in them, or what I need, other than by downloading them and inspecting
>> them?
> Use the source, Luke. :-)
>
>    https://github.com/OSGeo/proj-datumgrid
>
> Specific subdirectories for the regional packages:
>
>    https://github.com/OSGeo/proj-datumgrid/tree/master/europe
>    https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
>    https://github.com/OSGeo/proj-datumgrid/tree/master/oceania
>
>> As a packager, what should I do?  For now, I will include the main file
>> in the package, following tradition, and not worry about the new ones.
>> I am guessing that this means the grids for the important datums are
>> still in the main file, even if they are a North American Datum, and
>> the
>> north-america file contains only more obscure datums that were not
>> previously available.  I originally had the impression that all North
>> American grids were demoted from the main file to the regional file.
> proj-datumgrid-north-america includes grids for Greenland.
>
> The "old" NAD grids for North America are still included in the core
> proj-datumgrid package as they have been since pretty much forever.
>
> The filename and content of the proj-datumgrid was explicitly kept the
> same to not require any changes from packagers other than the version
> number.
>
> That is also why the .zip format was kept, and in addition a .tar.gz is
> available as well.
>
>> I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and I
>> see that this added two files compared to 1.5 (which I should have
>> updated but didn't), and did not withdraw any.
>>
>> So I have convinced myself that using the main file for the package,
>> and
>> deferring thinking about the new files is a good approach.
>>
>>
>> So it might help to add
>>
>>    All grids that were in proj-datumgrids-1.6 remain in
>>    proj-datumgrids-1.7; the regional datumgrid files contain grids for
>>    datums not previously supported.
> Where do you suggest to add this?
>
> Kind Regards,
>
> Bas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-- 
M.Sc. Matthias Gabriel
Fakultät für Elektrotechnik und Informationstechnik

Technische Universität Chemnitz
Reichenhainer Straße 70 | R. W440
09126 Chemnitz
Germany

Tel:    +49 371 531-34458
Fax:    +49 371 531-834458

matthias.gabriel at etit.tu-chemnitz.de
www.tu-chemnitz.de



From kreve at sdfe.dk  Wed Feb 28 00:58:15 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 28 Feb 2018 08:58:15 +0000
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
	<d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC5A247@S000014.PROD.SITAD.DK>

Hi Matthias,

I just tried reproducing your problem:

echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=lonlat +datum=WGS84 +ellps=WGS84
 12.0000000005   49.9999999996      306.0000        0.0000

Without any luck. This is on Windows, so I am not sure what is causing your problem. 

Really though, what you are trying to do is not really recommended. Instead of writing a long explanation, I'll just link to what
Thomas wrote the other day about using cs2cs modifiers such as +datum in pipelines:

	http://lists.maptools.org/pipermail/proj/2018-February/008055.html

TL;DR: Don't do that, unless invoked from a init-file.

In your specific case there's a much simpler solution:

	+proj=utm +zone=33

The reason being that "+proj=lonlat +datum=WGS84 +ellps=WGS84" in the context of pipelines is just a no operation that
passes through whatever comes in unchanged.  See for yourself:

	λ echo 12 55 0 0|cct.exe +proj=lonlat +datum=WGS84 +ellps=WGS84
	 12.0000000000   55.0000000000        0.0000        0.0000

Hope that clears things up a bit.

/Kristian

PS. You don't need +ellps=WGS84 when setting +datum=WGS84 

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af Matthias Gabriel
Sendt: 28. februar 2018 09:13
Til: proj at lists.maptools.org
Emne: Re: [Proj] PROJ 5.0.0RC6

Hi,

I still have a problem using proj4 RC6 on Windows... I try to calculate 
the "round-trip" from WGS84 ->  UTM -> WGS84 using the following two 
pipelines in a unit-test:

+proj=pipeline +step +inv
+proj=lonlat +datum=WGS84 +ellps=WGS84
+step
+proj=utm +zone=33

and its inverse:

+proj=pipeline +step +inv
+proj=utm +zone=33
+step
+proj=lonlat +datum=WGS84 +ellps=WGS84

My test-values are 12.0° 50.0° 306m - of course they are converted into 
radians before. I apply the first projection, get an intermediate (UTM) 
result and then immediately apply the second pipeline and get again 
lonlat in WGS84. Then I compare both WGS84.

On Linux x64 and aarch64 that unit-test succeeds and the result of 
applying both pipelines is again 12° and 50°. On Windows VS 15 2017 
amd64 its not the case. It seems that the second a application of the 
pipeline has no effect, the PJ_COORD still contains the UTM coordinates. 
Not even an error is raised (proj_errno equals 0 for the projection ptr) 
and of course my unittest fails.

I'm not an expert on projections but as this test succeeds on linux I 
find it rather strange...

Regards,
Matthias



On 27/02/18 16:49, Bas Couwenberg wrote:
> On 2018-02-27 15:11, Greg Troxel wrote:
>> Kristian Evers <kreve at sdfe.dk> writes:
>>
>>> Thanks for you feedback, Greg. It is very appreciated.
>>>
>>> I think Bas has commented on most issues already so I'll skip that. I
>>> have updated
>>> the NEWS and README files to take your comments into account:
>>>
>>> https://github.com/OSGeo/proj.4/pull/828
>>>
>>> Let me know if I've missed something or described things in an unclear
>>> way.
>> Thanks - that almost entirely addresses things.
>>
>>
>> A further comment, and I don't mean to suggest that the release be held
>> up:
>>
>> The text talks about how the regional ones are not essential but could
>> be useful.  That seems fair.  But, as a user, how do I find out what is
>> in them, or what I need, other than by downloading them and inspecting
>> them?
> Use the source, Luke. :-)
>
>    https://github.com/OSGeo/proj-datumgrid
>
> Specific subdirectories for the regional packages:
>
>    https://github.com/OSGeo/proj-datumgrid/tree/master/europe
>    https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
>    https://github.com/OSGeo/proj-datumgrid/tree/master/oceania
>
>> As a packager, what should I do?  For now, I will include the main file
>> in the package, following tradition, and not worry about the new ones.
>> I am guessing that this means the grids for the important datums are
>> still in the main file, even if they are a North American Datum, and
>> the
>> north-america file contains only more obscure datums that were not
>> previously available.  I originally had the impression that all North
>> American grids were demoted from the main file to the regional file.
> proj-datumgrid-north-america includes grids for Greenland.
>
> The "old" NAD grids for North America are still included in the core
> proj-datumgrid package as they have been since pretty much forever.
>
> The filename and content of the proj-datumgrid was explicitly kept the
> same to not require any changes from packagers other than the version
> number.
>
> That is also why the .zip format was kept, and in addition a .tar.gz is
> available as well.
>
>> I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and I
>> see that this added two files compared to 1.5 (which I should have
>> updated but didn't), and did not withdraw any.
>>
>> So I have convinced myself that using the main file for the package,
>> and
>> deferring thinking about the new files is a good approach.
>>
>>
>> So it might help to add
>>
>>    All grids that were in proj-datumgrids-1.6 remain in
>>    proj-datumgrids-1.7; the regional datumgrid files contain grids for
>>    datums not previously supported.
> Where do you suggest to add this?
>
> Kind Regards,
>
> Bas
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj

-- 
M.Sc. Matthias Gabriel
Fakultät für Elektrotechnik und Informationstechnik

Technische Universität Chemnitz
Reichenhainer Straße 70 | R. W440
09126 Chemnitz
Germany

Tel:    +49 371 531-34458
Fax:    +49 371 531-834458

matthias.gabriel at etit.tu-chemnitz.de
www.tu-chemnitz.de

_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

From matthias.gabriel at etit.tu-chemnitz.de  Wed Feb 28 02:33:15 2018
From: matthias.gabriel at etit.tu-chemnitz.de (Matthias Gabriel)
Date: Wed, 28 Feb 2018 11:33:15 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC5A247@S000014.PROD.SITAD.DK>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
	<d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>
	<2E885BB293AF0448A0181138489E9A0EAEC5A247@S000014.PROD.SITAD.DK>
Message-ID: <A7D084FA-EA7E-439E-A4B6-62F4A8FA3531@etit.tu-chemnitz.de>

Hi Kristian,

thank you for your answer..

I run your command on my Windows Installation and unfortunately it produces:

echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=lonlat +datum=WGS84 +ellps=WGS84
cct.exe: Bad transformation arguments - (major axis or radius = 0 or not given)
    'cct.exe -h' for help

The error stems from the second pipeline. If I remove it I get the proper UTM coordinates, but the second part fails:

echo 285015.7633 5542944.0186 306.0000 0.0000 | cct.exe +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=latlong +datum=WGS84
cct.exe: Bad transformation arguments - (major axis or radius = 0 or not given)
    'cct.exe -h' for help

About the +datum modifier: I don't really understand, what are cs2cs modifiers and what not... Why is it implied that +proj=utm +zone=33 would assume "WGS84" long-lat coordinates as input? According to an earlier email I thought to have read that the assumption to be able to use WGS84 as an universal reference in proj4 is flawed and that this is the motivation for new API?!

Thank you for your help, Regards,
Matthias

On 28 February 2018 09:58:15 CET, Kristian Evers <kreve at sdfe.dk> wrote:
>Hi Matthias,
>
>I just tried reproducing your problem:
>
>echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat
>+datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe
>+proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=lonlat
>+datum=WGS84 +ellps=WGS84
> 12.0000000005   49.9999999996      306.0000        0.0000
>
>Without any luck. This is on Windows, so I am not sure what is causing
>your problem. 
>
>Really though, what you are trying to do is not really recommended.
>Instead of writing a long explanation, I'll just link to what
>Thomas wrote the other day about using cs2cs modifiers such as +datum
>in pipelines:
>
>	http://lists.maptools.org/pipermail/proj/2018-February/008055.html
>
>TL;DR: Don't do that, unless invoked from a init-file.
>
>In your specific case there's a much simpler solution:
>
>	+proj=utm +zone=33
>
>The reason being that "+proj=lonlat +datum=WGS84 +ellps=WGS84" in the
>context of pipelines is just a no operation that
>passes through whatever comes in unchanged.  See for yourself:
>
>	λ echo 12 55 0 0|cct.exe +proj=lonlat +datum=WGS84 +ellps=WGS84
>	 12.0000000000   55.0000000000        0.0000        0.0000
>
>Hope that clears things up a bit.
>
>/Kristian
>
>PS. You don't need +ellps=WGS84 when setting +datum=WGS84 
>
>-----Oprindelig meddelelse-----
>Fra: proj-bounces at lists.maptools.org
>[mailto:proj-bounces at lists.maptools.org] På vegne af Matthias Gabriel
>Sendt: 28. februar 2018 09:13
>Til: proj at lists.maptools.org
>Emne: Re: [Proj] PROJ 5.0.0RC6
>
>Hi,
>
>I still have a problem using proj4 RC6 on Windows... I try to calculate
>
>the "round-trip" from WGS84 ->  UTM -> WGS84 using the following two 
>pipelines in a unit-test:
>
>+proj=pipeline +step +inv
>+proj=lonlat +datum=WGS84 +ellps=WGS84
>+step
>+proj=utm +zone=33
>
>and its inverse:
>
>+proj=pipeline +step +inv
>+proj=utm +zone=33
>+step
>+proj=lonlat +datum=WGS84 +ellps=WGS84
>
>My test-values are 12.0° 50.0° 306m - of course they are converted into
>
>radians before. I apply the first projection, get an intermediate (UTM)
>
>result and then immediately apply the second pipeline and get again 
>lonlat in WGS84. Then I compare both WGS84.
>
>On Linux x64 and aarch64 that unit-test succeeds and the result of 
>applying both pipelines is again 12° and 50°. On Windows VS 15 2017 
>amd64 its not the case. It seems that the second a application of the 
>pipeline has no effect, the PJ_COORD still contains the UTM
>coordinates. 
>Not even an error is raised (proj_errno equals 0 for the projection
>ptr) 
>and of course my unittest fails.
>
>I'm not an expert on projections but as this test succeeds on linux I 
>find it rather strange...
>
>Regards,
>Matthias
>
>
>
>On 27/02/18 16:49, Bas Couwenberg wrote:
>> On 2018-02-27 15:11, Greg Troxel wrote:
>>> Kristian Evers <kreve at sdfe.dk> writes:
>>>
>>>> Thanks for you feedback, Greg. It is very appreciated.
>>>>
>>>> I think Bas has commented on most issues already so I'll skip that.
>I
>>>> have updated
>>>> the NEWS and README files to take your comments into account:
>>>>
>>>> https://github.com/OSGeo/proj.4/pull/828
>>>>
>>>> Let me know if I've missed something or described things in an
>unclear
>>>> way.
>>> Thanks - that almost entirely addresses things.
>>>
>>>
>>> A further comment, and I don't mean to suggest that the release be
>held
>>> up:
>>>
>>> The text talks about how the regional ones are not essential but
>could
>>> be useful.  That seems fair.  But, as a user, how do I find out what
>is
>>> in them, or what I need, other than by downloading them and
>inspecting
>>> them?
>> Use the source, Luke. :-)
>>
>>    https://github.com/OSGeo/proj-datumgrid
>>
>> Specific subdirectories for the regional packages:
>>
>>    https://github.com/OSGeo/proj-datumgrid/tree/master/europe
>>    https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
>>    https://github.com/OSGeo/proj-datumgrid/tree/master/oceania
>>
>>> As a packager, what should I do?  For now, I will include the main
>file
>>> in the package, following tradition, and not worry about the new
>ones.
>>> I am guessing that this means the grids for the important datums are
>>> still in the main file, even if they are a North American Datum, and
>>> the
>>> north-america file contains only more obscure datums that were not
>>> previously available.  I originally had the impression that all
>North
>>> American grids were demoted from the main file to the regional file.
>> proj-datumgrid-north-america includes grids for Greenland.
>>
>> The "old" NAD grids for North America are still included in the core
>> proj-datumgrid package as they have been since pretty much forever.
>>
>> The filename and content of the proj-datumgrid was explicitly kept
>the
>> same to not require any changes from packagers other than the version
>> number.
>>
>> That is also why the .zip format was kept, and in addition a .tar.gz
>is
>> available as well.
>>
>>> I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and
>I
>>> see that this added two files compared to 1.5 (which I should have
>>> updated but didn't), and did not withdraw any.
>>>
>>> So I have convinced myself that using the main file for the package,
>>> and
>>> deferring thinking about the new files is a good approach.
>>>
>>>
>>> So it might help to add
>>>
>>>    All grids that were in proj-datumgrids-1.6 remain in
>>>    proj-datumgrids-1.7; the regional datumgrid files contain grids
>for
>>>    datums not previously supported.
>> Where do you suggest to add this?
>>
>> Kind Regards,
>>
>> Bas
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>
>-- 
>M.Sc. Matthias Gabriel
>Fakultät für Elektrotechnik und Informationstechnik
>
>Technische Universität Chemnitz
>Reichenhainer Straße 70 | R. W440
>09126 Chemnitz
>Germany
>
>Tel:    +49 371 531-34458
>Fax:    +49 371 531-834458
>
>matthias.gabriel at etit.tu-chemnitz.de
>www.tu-chemnitz.de
>
>_______________________________________________
>Proj mailing list
>Proj at lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/proj
>_______________________________________________
>Proj mailing list
>Proj at lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180228/52f5cbc7/attachment.html>

From knudsen.thomas at gmail.com  Wed Feb 28 03:00:21 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Wed, 28 Feb 2018 12:00:21 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <A7D084FA-EA7E-439E-A4B6-62F4A8FA3531@etit.tu-chemnitz.de>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
	<d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>
	<2E885BB293AF0448A0181138489E9A0EAEC5A247@S000014.PROD.SITAD.DK>
	<A7D084FA-EA7E-439E-A4B6-62F4A8FA3531@etit.tu-chemnitz.de>
Message-ID: <CAH0YoEOFWk2OCiU3yzr8=mkHqvscH4dSUxFTPieV_U8t-4kJGQ@mail.gmail.com>

proj=utm zone=33 does not assume input data are in a WGS84 *reference
frame* (datum).

But it picks up  the *WGS84 ellipsoid* as default from the proj_def.dat
file,
if your PROJ_LIB environment variable points to the directory where it
resides.
The error message you get could mean that this is not the case.

It has been proposed (and I happen to agree) that the proj_def.dat file
creates
more problems than it solves. This is evidently one of them.

Also note that the proj=longlat steps in your pipelines are essentially
no-ops.
So the entire roundtrip thing can be done using just one cct call:

cct +proj=pipeline +step +proj=utm +zone=33 +ellps=GRS80 +step  +inv
+proj=utm +zone=33 +ellps=GRS80

Which, due to the feature of "pipeline global settings" can even be
abbreviated to:

cct +proj=pipeline +proj=utm +zone=33 +ellps=GRS80 +step +step +inv

/Thomas

2018-02-28 11:33 GMT+01:00 Matthias Gabriel <
matthias.gabriel at etit.tu-chemnitz.de>:

> Hi Kristian,
>
> thank you for your answer..
>
> I run your command on my Windows Installation and unfortunately it
> produces:
>
> echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat
> +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe +proj=pipeline
> +step +inv +proj=utm +zone=33 +step +proj=lonlat +datum=WGS84 +ellps=WGS84
> cct.exe: Bad transformation arguments - (major axis or radius = 0 or not
> given)
>     'cct.exe -h' for help
>
> The error stems from the second pipeline. If I remove it I get the proper
> UTM coordinates, but the second part fails:
>
> echo 285015.7633 5542944.0186 306.0000 0.0000 | cct.exe +proj=pipeline
> +step +inv +proj=utm +zone=33 +step +proj=latlong +datum=WGS84
> cct.exe: Bad transformation arguments - (major axis or radius = 0 or not
> given)
>     'cct.exe -h' for help
>
> About the +datum modifier: I don't really understand, what are cs2cs
> modifiers and what not... Why is it implied that +proj=utm +zone=33 would
> assume "WGS84" long-lat coordinates as input? According to an earlier email
> I thought to have read that the assumption to be able to use WGS84 as an
> universal reference in proj4 is flawed and that this is the motivation for
> new API?!
>
> Thank you for your help, Regards,
> Matthias
>
> On 28 February 2018 09:58:15 CET, Kristian Evers <kreve at sdfe.dk> wrote:
>
>> Hi Matthias,
>>
>> I just tried reproducing your problem:
>>
>> echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=lonlat +datum=WGS84 +ellps=WGS84
>>  12.0000000005   49.9999999996      306.0000        0.0000
>>
>> Without any luck. This is on Windows, so I am not sure what is causing your problem.
>>
>> Really though, what you are trying to do is not really recommended. Instead of writing a long explanation, I'll just link to what
>> Thomas wrote the other day about using cs2cs modifiers such as +datum in pipelines:
>>
>> 	http://lists.maptools.org/pipermail/proj/2018-February/008055.html
>>
>> TL;DR: Don't do that, unless invoked from a init-file.
>>
>> In your specific case there's a much simpler solution:
>>
>> 	+proj=utm +zone=33
>>
>> The reason being that "+proj=lonlat +datum=WGS84 +ellps=WGS84" in the context of pipelines is just a no operation that
>> passes through whatever comes in unchanged.  See for yourself:
>>
>> 	λ echo 12 55 0 0|cct.exe +proj=lonlat +datum=WGS84 +ellps=WGS84
>> 	 12.0000000000   55.0000000000        0.0000        0.0000
>>
>> Hope that clears things up a bit.
>>
>> /Kristian
>>
>> PS. You don't need +ellps=WGS84 when setting +datum=WGS84
>>
>> -----Oprindelig meddelelse-----
>> Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af Matthias Gabriel
>> Sendt: 28. februar 2018 09:13
>> Til: proj at lists.maptools.org
>> Emne: Re: [Proj] PROJ 5.0.0RC6
>>
>> Hi,
>>
>> I still have a problem using proj4 RC6 on Windows... I try to calculate
>> the "round-trip" from WGS84 ->  UTM -> WGS84 using the following two
>> pipelines in a unit-test:
>>
>> +proj=pipeline +step +inv
>> +proj=lonlat +datum=WGS84 +ellps=WGS84
>> +step
>> +proj=utm +zone=33
>>
>> and its inverse:
>>
>> +proj=pipeline +step +inv
>> +proj=utm +zone=33
>> +step
>> +proj=lonlat +datum=WGS84 +ellps=WGS84
>>
>> My test-values are 12.0° 50.0° 306m - of course they are converted into
>> radians before. I apply the first projection, get an intermediate (UTM)
>> result and then immediately apply the second pipeline and get again
>> lonlat in WGS84. Then I compare both WGS84.
>>
>> On Linux x64 and aarch64 that unit-test succeeds and the result of
>> applying both pipelines is again 12° and 50°. On Windows VS 15 2017
>> amd64 its not the case. It seems that the second a application of the
>> pipeline has no effect, the PJ_COORD still contains the UTM coordinates.
>> Not even an error is raised (proj_errno equals 0 for the projection ptr)
>> and of course my unittest fails.
>>
>> I'm not an expert on projections but as this test succeeds on linux I
>> find it rather strange...
>>
>> Regards,
>> Matthias
>>
>>
>>
>> On 27/02/18 16:49, Bas Couwenberg wrote:
>>
>>>  On 2018-02-27 15:11, Greg Troxel wrote:
>>>
>>>>  Kristian Evers <kreve at sdfe.dk> writes:
>>>>
>>>>  Thanks for you feedback, Greg. It is very appreciated.
>>>>>
>>>>>  I think Bas has commented on most issues already so I'll skip that. I
>>>>>  have updated
>>>>>  the NEWS and README files to take your comments into account:
>>>>>
>>>>>  https://github.com/OSGeo/proj.4/pull/828
>>>>>
>>>>>  Let me know if I've missed something or described things in an unclear
>>>>>  way.
>>>>>
>>>>  Thanks - that almost entirely addresses things.
>>>>
>>>>
>>>>  A further comment, and I don't mean to suggest that the release be held
>>>>  up:
>>>>
>>>>  The text talks about how the regional ones are not essential but could
>>>>  be useful.  That seems fair.  But, as a user, how do I find out what is
>>>>  in them, or what I need, other than by downloading them and inspecting
>>>>  them?
>>>>
>>>  Use the source, Luke. :-)
>>>
>>>     https://github.com/OSGeo/proj-datumgrid
>>>
>>>  Specific subdirectories for the regional packages:
>>>
>>>     https://github.com/OSGeo/proj-datumgrid/tree/master/europe
>>>     https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
>>>     https://github.com/OSGeo/proj-datumgrid/tree/master/oceania
>>>
>>>  As a packager, what should I do?  For now, I will include the main file
>>>>  in the package, following tradition, and not worry about the new ones.
>>>>  I am guessing that this means the grids for the important datums are
>>>>  still in the main file, even if they are a North American Datum, and
>>>>  the
>>>>  north-america file contains only more obscure datums that were not
>>>>  previously available.  I originally had the impression that all North
>>>>  American grids were demoted from the main file to the regional file.
>>>>
>>>  proj-datumgrid-north-america includes grids for Greenland.
>>>
>>>  The "old" NAD grids for North America are still included in the core
>>>  proj-datumgrid package as they have been since pretty much forever.
>>>
>>>  The filename and content of the proj-datumgrid was explicitly kept the
>>>  same to not require any changes from packagers other than the version
>>>  number.
>>>
>>>  That is also why the .zip format was kept, and in addition a .tar.gz is
>>>  available as well.
>>>
>>>  I updated my draft 5.0.0 package to use proj-datumgrids-1.7RC2, and I
>>>>  see that this added two files compared to 1.5 (which I should have
>>>>  updated but didn't), and did not withdraw any.
>>>>
>>>>  So I have convinced myself that using the main file for the package,
>>>>  and
>>>>  deferring thinking about the new files is a good approach.
>>>>
>>>>
>>>>  So it might help to add
>>>>
>>>>     All grids that were in proj-datumgrids-1.6 remain in
>>>>     proj-datumgrids-1.7; the regional datumgrid files contain grids for
>>>>     datums not previously supported.
>>>>
>>>  Where do you suggest to add this?
>>>
>>>  Kind Regards,
>>>
>>>  Bas
>>> ------------------------------
>>>
>>>  Proj mailing list
>>>  Proj at lists.maptools.org
>>>  http://lists.maptools.org/mailman/listinfo/proj
>>>
>>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180228/2fc89d80/attachment.html>

From stevejking at talktalk.net  Wed Feb 28 03:28:59 2018
From: stevejking at talktalk.net (stevejking)
Date: Wed, 28 Feb 2018 04:28:59 -0700 (MST)
Subject: [Proj] Understanding deformation model usage
In-Reply-To: <1519739279217-0.post@n6.nabble.com>
References: <1519717389403-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC56DDB@S000014.PROD.SITAD.DK>
	<1519739279217-0.post@n6.nabble.com>
Message-ID: <1519817339898-0.post@n6.nabble.com>

Kristian,
A follow up question, related to usage,

Are the Cartesian deformation grids tied to a particular TRF ? I was not
expecting them to be. The reason I ask is that on this website:
http://www.epncb.oma.be/_productsservices/coordinates/index.php
Station positions (I assume Cartesian) and velocities are given using three
different reference frames. Drop down list top right you can select
individual stations. Class A have average velocities (to GPS week 1950). And
although the Cartesian coordinates from each TRF don’t differ that much, the
average velocities do?

In the proj documentation example I think it assumes the deformation grids
are not tied to a particular TRF.

Thanks again

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html


From kreve at sdfe.dk  Wed Feb 28 04:35:35 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 28 Feb 2018 12:35:35 +0000
Subject: [Proj] Understanding deformation model usage
In-Reply-To: <1519817339898-0.post@n6.nabble.com>
References: <1519717389403-0.post@n6.nabble.com>
	<2E885BB293AF0448A0181138489E9A0EAEC56DDB@S000014.PROD.SITAD.DK>
	<1519739279217-0.post@n6.nabble.com>
	<1519817339898-0.post@n6.nabble.com>
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC5A38D@S000014.PROD.SITAD.DK>

Steve,

> Are the Cartesian deformation grids tied to a particular TRF ? I was not
> expecting them to be.

At least for the use case that I developed this for, yes, the grids are tied to a
particular frame.  In case of the Nordic ITRFyy(yy) -> ETRS89 transformations
that frame is ETRF00. That is, it is co-rotating with the Eurasian continental
plate.

The EPN velocities you have linked to are relative to the various frames
in the list. So the ITRF velocities includes the rotation velocity
of the continent but the ETRF velocities doesn't (since the frame itself is defined
as co-rotating with the continent).

Does that make sense to you?

/Kristian

-----Oprindelig meddelelse-----
Fra: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] På vegne af stevejking
Sendt: 28. februar 2018 12:29
Til: proj at lists.maptools.org
Emne: Re: [Proj] Understanding deformation model usage

Kristian,
A follow up question, related to usage,

Are the Cartesian deformation grids tied to a particular TRF ? I was not
expecting them to be. The reason I ask is that on this website:
http://www.epncb.oma.be/_productsservices/coordinates/index.php
Station positions (I assume Cartesian) and velocities are given using three
different reference frames. Drop down list top right you can select
individual stations. Class A have average velocities (to GPS week 1950). And
although the Cartesian coordinates from each TRF don’t differ that much, the
average velocities do?

In the proj documentation example I think it assumes the deformation grids
are not tied to a particular TRF.

Thanks again

Steve



--
Sent from: http://osgeo-org.1560.x6.nabble.com/PROJ-4-f3840930.html
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj

From kreve at sdfe.dk  Wed Feb 28 06:57:36 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 28 Feb 2018 14:57:36 +0000
Subject: [Proj] HTPD
Message-ID: <2E885BB293AF0448A0181138489E9A0EAEC5A4E3@S000014.PROD.SITAD.DK>

All,

In the PROJ documentation we currently have a page about using HTPD (Horizontal Time Dependent Positioning):

http://proj4.org/htpd.html

I'd like remove that, since it is basically documenting usage of a script from GDAL. The script produces
grids that can be used with PROJ so keeping it around can be justified. In version 5 of PROJ there are
better ways to do this since we now support time-varying transformations as well.

Is this something that is still in use? Are there any objections to removing this from the PROJ documentation?

/Kristian


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180228/d7affcd5/attachment.html>

From matthias.gabriel at etit.tu-chemnitz.de  Wed Feb 28 10:17:33 2018
From: matthias.gabriel at etit.tu-chemnitz.de (Matthias Gabriel)
Date: Wed, 28 Feb 2018 19:17:33 +0100
Subject: [Proj] PROJ 5.0.0RC6
In-Reply-To: <CAH0YoEOFWk2OCiU3yzr8=mkHqvscH4dSUxFTPieV_U8t-4kJGQ@mail.gmail.com>
References: <5B6818DB-0428-47F3-8666-C078BA108585@sdfe.dk>
	<smur2p742jr.fsf@linuxpal.mit.edu>
	<2E885BB293AF0448A0181138489E9A0EAEC56E7A@S000014.PROD.SITAD.DK>
	<smu8tbe4j5s.fsf@linuxpal.mit.edu>
	<f7deb6a5864b4fc6feacb2029b35a1d0@xs4all.nl>
	<d927e6a6-4bc0-5b47-9ab8-5e395b5f9827@etit.tu-chemnitz.de>
	<2E885BB293AF0448A0181138489E9A0EAEC5A247@S000014.PROD.SITAD.DK>
	<A7D084FA-EA7E-439E-A4B6-62F4A8FA3531@etit.tu-chemnitz.de>
	<CAH0YoEOFWk2OCiU3yzr8=mkHqvscH4dSUxFTPieV_U8t-4kJGQ@mail.gmail.com>
Message-ID: <d178024b-9e1a-ca0e-9923-9221d77e6d4b@etit.tu-chemnitz.de>

Thank you Thomas!

its true that PROJ_LIB has not been found on Windows and thats why my 
tests failed... a warning or something like that would be useful, 
because it kind of fails silently.. Also I didn't even know about this 
file and about its functionality of setting a certain "global default". 
I agree that it doesn't really make things easier to understand in the 
beginning...

Thank you again for your help!


On 28/02/18 12:00, Thomas Knudsen wrote:
> proj=utm zone=33 does not assume input data are in a WGS84 *reference 
> frame* (datum).
>
> But it picks up  the *WGS84 ellipsoid* as default from the 
> proj_def.dat file,
> if your PROJ_LIB environment variable points to the directory where it 
> resides.
> The error message you get could mean that this is not the case.
>
> It has been proposed (and I happen to agree) that the proj_def.dat 
> file creates
> more problems than it solves. This is evidently one of them.
>
> Also note that the proj=longlat steps in your pipelines are 
> essentially no-ops.
> So the entire roundtrip thing can be done using just one cct call:
>
> cct +proj=pipeline +step +proj=utm +zone=33 +ellps=GRS80 +step  +inv 
> +proj=utm +zone=33 +ellps=GRS80
>
> Which, due to the feature of "pipeline global settings" can even be 
> abbreviated to:
>
> cct +proj=pipeline +proj=utm +zone=33 +ellps=GRS80 +step +step +inv
>
> /Thomas
>
> 2018-02-28 11:33 GMT+01:00 Matthias Gabriel 
> <matthias.gabriel at etit.tu-chemnitz.de 
> <mailto:matthias.gabriel at etit.tu-chemnitz.de>>:
>
>     Hi Kristian,
>
>     thank you for your answer..
>
>     I run your command on my Windows Installation and unfortunately it
>     produces:
>
>     echo 12 50 306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat
>     +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe
>     +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=lonlat
>     +datum=WGS84 +ellps=WGS84
>     cct.exe: Bad transformation arguments - (major axis or radius = 0
>     or not given)
>         'cct.exe -h' for help
>
>     The error stems from the second pipeline. If I remove it I get the
>     proper UTM coordinates, but the second part fails:
>
>     echo 285015.7633 5542944.0186 306.0000 0.0000 | cct.exe
>     +proj=pipeline +step +inv +proj=utm +zone=33 +step +proj=latlong
>     +datum=WGS84
>     cct.exe: Bad transformation arguments - (major axis or radius = 0
>     or not given)
>         'cct.exe -h' for help
>
>     About the +datum modifier: I don't really understand, what are
>     cs2cs modifiers and what not... Why is it implied that +proj=utm
>     +zone=33 would assume "WGS84" long-lat coordinates as input?
>     According to an earlier email I thought to have read that the
>     assumption to be able to use WGS84 as an universal reference in
>     proj4 is flawed and that this is the motivation for new API?!
>
>     Thank you for your help, Regards,
>     Matthias
>
>     On 28 February 2018 09:58:15 CET, Kristian Evers <kreve at sdfe.dk
>     <mailto:kreve at sdfe.dk>> wrote:
>
>         Hi Matthias, I just tried reproducing your problem: echo 12 50
>         306 0 | cct.exe +proj=pipeline +step +inv +proj=lonlat
>         +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 | cct.exe
>         +proj=pipeline +step +inv +proj=utm +zone=33 +step
>         +proj=lonlat +datum=WGS84 +ellps=WGS84 12.0000000005
>         49.9999999996 306.0000 0.0000 Without any luck. This is on
>         Windows, so I am not sure what is causing your problem. Really
>         though, what you are trying to do is not really recommended.
>         Instead of writing a long explanation, I'll just link to what
>         Thomas wrote the other day about using cs2cs modifiers such as
>         +datum in pipelines:
>         http://lists.maptools.org/pipermail/proj/2018-February/008055.html
>         <http://lists.maptools.org/pipermail/proj/2018-February/008055.html>
>         TL;DR: Don't do that, unless invoked from a init-file. In your
>         specific case there's a much simpler solution: +proj=utm
>         +zone=33 The reason being that "+proj=lonlat +datum=WGS84
>         +ellps=WGS84" in the context of pipelines is just a no
>         operation that passes through whatever comes in unchanged. See
>         for yourself: λ echo 12 55 0 0|cct.exe +proj=lonlat
>         +datum=WGS84 +ellps=WGS84 12.0000000000 55.0000000000 0.0000
>         0.0000 Hope that clears things up a bit. /Kristian PS. You
>         don't need +ellps=WGS84 when setting +datum=WGS84
>         -----Oprindelig meddelelse----- Fra:
>         proj-bounces at lists.maptools.org
>         <mailto:proj-bounces at lists.maptools.org>
>         [mailto:proj-bounces at lists.maptools.org
>         <mailto:proj-bounces at lists.maptools.org>] På vegne af Matthias
>         Gabriel Sendt: 28. februar 2018 09:13 Til:
>         proj at lists.maptools.org <mailto:proj at lists.maptools.org> Emne:
>         Re: [Proj] PROJ 5.0.0RC6 Hi, I still have a problem using
>         proj4 RC6 on Windows... I try to calculate the "round-trip"
>         from WGS84 ->  UTM -> WGS84 using the following two pipelines
>         in a unit-test: +proj=pipeline +step +inv +proj=lonlat
>         +datum=WGS84 +ellps=WGS84 +step +proj=utm +zone=33 and its
>         inverse: +proj=pipeline +step +inv +proj=utm +zone=33 +step
>         +proj=lonlat +datum=WGS84 +ellps=WGS84 My test-values are
>         12.0° 50.0° 306m - of course they are converted into radians
>         before. I apply the first projection, get an intermediate
>         (UTM) result and then immediately apply the second pipeline
>         and get again lonlat in WGS84. Then I compare both WGS84. On
>         Linux x64 and aarch64 that unit-test succeeds and the result
>         of applying both pipelines is again 12° and 50°. On Windows VS
>         15 2017 amd64 its not the case. It seems that the second a
>         application of the pipeline has no effect, the PJ_COORD still
>         contains the UTM coordinates. Not even an error is raised
>         (proj_errno equals 0 for the projection ptr) and of course my
>         unittest fails. I'm not an expert on projections but as this
>         test succeeds on linux I find it rather strange... Regards,
>         Matthias On 27/02/18 16:49, Bas Couwenberg wrote:
>
>             On 2018-02-27 15:11, Greg Troxel wrote:
>
>                 Kristian Evers <kreve at sdfe.dk <mailto:kreve at sdfe.dk>>
>                 writes:
>
>                     Thanks for you feedback, Greg. It is very
>                     appreciated. I think Bas has commented on most
>                     issues already so I'll skip that. I have updated
>                     the NEWS and README files to take your comments
>                     into account:
>                     https://github.com/OSGeo/proj.4/pull/828
>                     <https://github.com/OSGeo/proj.4/pull/828> Let me
>                     know if I've missed something or described things
>                     in an unclear way. 
>
>                 Thanks - that almost entirely addresses things. A
>                 further comment, and I don't mean to suggest that the
>                 release be held up: The text talks about how the
>                 regional ones are not essential but could be useful.
>                 That seems fair. But, as a user, how do I find out
>                 what is in them, or what I need, other than by
>                 downloading them and inspecting them? 
>
>             Use the source, Luke. :-)
>             https://github.com/OSGeo/proj-datumgrid
>             <https://github.com/OSGeo/proj-datumgrid> Specific
>             subdirectories for the regional packages:
>             https://github.com/OSGeo/proj-datumgrid/tree/master/europe
>             <https://github.com/OSGeo/proj-datumgrid/tree/master/europe>
>             https://github.com/OSGeo/proj-datumgrid/tree/master/north-america
>             <https://github.com/OSGeo/proj-datumgrid/tree/master/north-america>
>             https://github.com/OSGeo/proj-datumgrid/tree/master/oceania
>             <https://github.com/OSGeo/proj-datumgrid/tree/master/oceania>
>
>                 As a packager, what should I do? For now, I will
>                 include the main file in the package, following
>                 tradition, and not worry about the new ones. I am
>                 guessing that this means the grids for the important
>                 datums are still in the main file, even if they are a
>                 North American Datum, and the north-america file
>                 contains only more obscure datums that were not
>                 previously available. I originally had the impression
>                 that all North American grids were demoted from the
>                 main file to the regional file. 
>
>             proj-datumgrid-north-america includes grids for Greenland.
>             The "old" NAD grids for North America are still included
>             in the core proj-datumgrid package as they have been since
>             pretty much forever. The filename and content of the
>             proj-datumgrid was explicitly kept the same to not require
>             any changes from packagers other than the version number.
>             That is also why the .zip format was kept, and in addition
>             a .tar.gz is available as well.
>
>                 I updated my draft 5.0.0 package to use
>                 proj-datumgrids-1.7RC2, and I see that this added two
>                 files compared to 1.5 (which I should have updated but
>                 didn't), and did not withdraw any. So I have convinced
>                 myself that using the main file for the package, and
>                 deferring thinking about the new files is a good
>                 approach. So it might help to add All grids that were
>                 in proj-datumgrids-1.6 remain in proj-datumgrids-1.7;
>                 the regional datumgrid files contain grids for datums
>                 not previously supported. 
>
>             Where do you suggest to add this? Kind Regards, Bas
>             ------------------------------------------------------------------------
>             Proj mailing list Proj at lists.maptools.org
>             <mailto:Proj at lists.maptools.org>
>             http://lists.maptools.org/mailman/listinfo/proj
>             <http://lists.maptools.org/mailman/listinfo/proj> 
>
>
>     _______________________________________________
>     Proj mailing list
>     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     http://lists.maptools.org/mailman/listinfo/proj
>     <http://lists.maptools.org/mailman/listinfo/proj>
>
>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180228/fddf8c65/attachment.html>

From dagnew at ucsd.edu  Wed Feb 28 10:49:10 2018
From: dagnew at ucsd.edu (Duncan Agnew)
Date: Wed, 28 Feb 2018 10:49:10 -0800
Subject: [Proj] HTPD
In-Reply-To: <2E885BB293AF0448A0181138489E9A0EAEC5A4E3@S000014.PROD.SITAD.DK>
References: <2E885BB293AF0448A0181138489E9A0EAEC5A4E3@S000014.PROD.SITAD.DK>
Message-ID: <CAG6Em0CCXMpagpRdHgQVyW_MuhN28eL24DHL3Ngq02RUYFvjHw@mail.gmail.com>

Kristian:

If I understand the material about deformation grids correctly (and I may
not) these describe velocities only.
HTDP includes velocities, but also the episodic deformation associated with
earthquakes: which earthquakes
of course depends on the two time epochs. This could all be done using the
pipeline system by providing
displacement grids for each earthquake, though the user would have to chose
which ones to chain together.
HDTP hides all these complications, in keeping with its original goal of
providing an easily-used black box
for surveyors who had data from a number of different epochs. Initially it
was intended for use only for
California and environs, though over the years it has been extended--I see
that It now includes postglacial
rebound for the Eastern US.

But if there is a way to provide the same functionality without HTDP I can
see that this would be cleaner.

Thanks
Duncan Agnew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180228/f2f170ff/attachment.html>

From kristianevers at gmail.com  Wed Feb 28 11:39:09 2018
From: kristianevers at gmail.com (Kristian Evers)
Date: Wed, 28 Feb 2018 20:39:09 +0100
Subject: [Proj] HTPD
In-Reply-To: <CAG6Em0CCXMpagpRdHgQVyW_MuhN28eL24DHL3Ngq02RUYFvjHw@mail.gmail.com>
References: <2E885BB293AF0448A0181138489E9A0EAEC5A4E3@S000014.PROD.SITAD.DK>
	<CAG6Em0CCXMpagpRdHgQVyW_MuhN28eL24DHL3Ngq02RUYFvjHw@mail.gmail.com>
Message-ID: <1D04F23B-5756-4C40-ADAC-88106AC51738@gmail.com>

Hi Duncan, 

There’s clearly more to HTPD than I had realized. From what you describe it is
definitely useful to American PROJ users. The modelling of displacement after seismic events is not
something we can do in a smart way in PROJ, so HTPD can not be replaced by PROJ. Yet anyway :-)

The current doc page, however, is still primarily documenting a tool from GDAL, which ideally would be
taken care of in the GDAL docs. For now I’ll keep the information in the PROJ docs as well although in a less
prominent space (somewhere in the grids-section instead of a chapter by itself).

Thanks for your feedback.

/Kristian


> On 28 Feb 2018, at 19:49, Duncan Agnew <dagnew at ucsd.edu> wrote:
> 
> Kristian:
> 
> If I understand the material about deformation grids correctly (and I may not) these describe velocities only.
> HTDP includes velocities, but also the episodic deformation associated with earthquakes: which earthquakes
> of course depends on the two time epochs. This could all be done using the pipeline system by providing
> displacement grids for each earthquake, though the user would have to chose which ones to chain together.
> HDTP hides all these complications, in keeping with its original goal of providing an easily-used black box
> for surveyors who had data from a number of different epochs. Initially it was intended for use only for
> California and environs, though over the years it has been extended--I see that It now includes postglacial
> rebound for the Eastern US.
> 
> But if there is a way to provide the same functionality without HTDP I can see that this would be cleaner.
> 
> Thanks
> Duncan Agnew
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj



From jmckenna at gatewaygeomatics.com  Wed Feb 28 15:38:18 2018
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 28 Feb 2018 19:38:18 -0400
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
	<51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
	<19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>
Message-ID: <150961d6-0b98-f5a1-50d7-288ccff3e260@gatewaygeomatics.com>

Update: I never heard back from anyone else about testing PROJ v5 + 
MapServer (and GDAL), so in fact I may be the only person to test this 
combination so far.  Because this is a PROJ mailing list I first give 
some more feedback with PROJ utilities, then later will list results 
from other software for anyone interested.  (in reality I first noticed 
the problem in MapServer but then each test in GDAL then PROJ failed as 
well, on Windows with PROJ 5.0.0-RC6)

cs2cs
=====

I wanted to test PROJ v5 by using a point 
(487147.594520173,4934316.46263998) in EPSG:26915 (UTM Zone 15) and 
reprojecting that to EPSG:3857 (Google's Mercator).

with PROJ 4.9.3
---------------

cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137 
+b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m 
+nadgrids=@null
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 
+y_0=0 +k=1.0
# +units=m +nadgrids=@null
487147.594520173 4934316.46263998

RESULT POINT: -10370728.80    5552839.74 -0.00

with PROJ 5.0.0-RC6
-------------------

 >cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137 
+b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m 
+nadgrids=@null
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 
+y_0=0 +k=1.0
# +units=m +nadgrids=@null
487147.594520173 4934316.46263998

RESULT POINT: -10370728.80    5522830.15 -10484.03

Discussion
----------

PROJ 4.9.3 returns the correct value (I've confirmed this with many 
other tools including QGIS).  Can someone explain why those 2 results 
are different? (I have reproduced this problem on Windows and also 
Ubuntu 14.94)

GDAL
====

I wanted to test PROJ v5 by using that same test point (as a shapefile) 
in EPSG:26915 (UTM Zone 15) and reprojecting that to EPSG:3857 (Google's 
Mercator), using GDAL's ogr2ogr command.  (data used: 
https://www.gatewaygeomatics.com/dl/parcels-proj-v5-test.zip )  Below I 
have used the ogr2ogr command (included in the "commands.txt" file in 
that data download) and then ogrinfo on the reprojected file to output:

with PROJ 4.9.3
---------------

POINT (-10370728.7959208 5552839.74177463)

with PROJ 5.0.0-RC6
-------------------

POINT (-10370728.7959208 5522830.1464459)

Discussion
----------

PROJ 4.9.3 compiled into GDAL 2.2.3 returns the correct point value, but 
returns a different point value with PROJ 5.0.0-RC6

MapServer
=========

Same problems as GDAL (reprojected layer has different extents with PROJ 
5.0.0-RC6, causing problems to display the reprojected layer in a map 
image).


If you made it this far in my long email, thanks for listening (I am 
totally stumped on this one, again ha).

-jeff





On 2018-02-25 3:45 PM, Kristian Evers wrote:
> Thanks for testing, Jeff. It is very appreciated. I hope you sort of your problems,
> PROJ-related or not.
> 
> /Kristian
> 
>> On 25 Feb 2018, at 00:29, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
>>
>> Update: it seems many things were happening, causing me to look in wrong
>> places.  But in the end MapServer was in fact reprojecting the points;
>> what caused me total confusion was that I was testing with several
>> MapServer-related applications that are part of MS4W (Mapbender,
>> GeoMOOSE) and one application had a totally blank opening map image with
>> PROJ v5.  In fact for some reason the old hardcoded map extents
>> (displayed in EPSG:3857) no longer display the data (you have to now
>> zoom out a bit to see the data, reprojected with PROJ v5).  I'll contact
>> the GeoMOOSE team to let them dive into this (still, it could be my
>> Windows environment, as no one else seems to be testing MapServer + PROJ
>> v5 yet).
>>
>> Very sorry for all this noise!
>>
>> Short story: all is fine with RC5 here.
>>
>> Thank you again Kristian for your passion driving this.
>>
>> -jeff
>>
>>
>>
>>
>>
>> On 2018-02-23 5:33 PM, Jeff McKenna wrote:
>>> Hi Kristian,
>>>
>>> No problems here on Windows in the MS4W environment, but I'm running
>>> into odd errors when I have MapServer call PROJ 5
>>> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-February/015347.html).
>>>    Obviously an issue downstream not here, but I thought I'd at least
>>> mention it here that I am testing RC5 as well :)
>>>
>>> Thanks for pushing this release along.
>>>
>>> -jeff
>>>
>>>
>>>
>>>
>>> On 2018-02-23 3:19 PM, Kristian Evers wrote:
>>>> All,
>>>>
>>>> I have prepared PROJ 5.0.0RC5. Downloads are here:
>>>>
>>>>
>>>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
>>>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
>>>>
>>>>
>>>> Since RC4 problems with vertical grid installation, the Horner
>>>> transformation and faulty polygon area calculation
>>>> in geodesic library has been fixed. Hopefully this will be the final
>>>> release candidate. I will call for a vote for
>>>> promotion to final release on the 27th. Unless serious issues are
>>>> discovered in the mean time.
>>>>
>>>> /Kristian
>>>>
>>>>


From knudsen.thomas at gmail.com  Wed Feb 28 22:58:22 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Thu, 1 Mar 2018 07:58:22 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <150961d6-0b98-f5a1-50d7-288ccff3e260@gatewaygeomatics.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
	<51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
	<19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>
	<150961d6-0b98-f5a1-50d7-288ccff3e260@gatewaygeomatics.com>
Message-ID: <CAH0YoEMrboneuOajeEi-e3fLJo3Bt6YK5xj9u8NKnhmrsSoDqw@mail.gmail.com>

Jeff,

That's interesting (although annoying!)

When I leave out the final nadgrids=@null, I get the correct result from
PROJ v5RC6. Can you reproduce that?

Note, I'm not implying that this should be considered a solution or
workaround, merely trying to narrow in on the
problem, which seems to be related to datum handling.

/Thomas





2018-03-01 0:38 GMT+01:00 Jeff McKenna <jmckenna at gatewaygeomatics.com>:

> Update: I never heard back from anyone else about testing PROJ v5 +
> MapServer (and GDAL), so in fact I may be the only person to test this
> combination so far.  Because this is a PROJ mailing list I first give
> some more feedback with PROJ utilities, then later will list results
> from other software for anyone interested.  (in reality I first noticed
> the problem in MapServer but then each test in GDAL then PROJ failed as
> well, on Windows with PROJ 5.0.0-RC6)
>
> cs2cs
> =====
>
> I wanted to test PROJ v5 by using a point
> (487147.594520173,4934316.46263998) in EPSG:26915 (UTM Zone 15) and
> reprojecting that to EPSG:3857 (Google's Mercator).
>
> with PROJ 4.9.3
> ---------------
>
> cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
> +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
> +nadgrids=@null
> # ---- From Coordinate System ----
> #Universal Transverse Mercator (UTM)
> #       Cyl, Sph
> #       zone= south
> # +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
> # ---- To Coordinate System ----
> #Mercator
> #       Cyl, Sph&Ell
> #       lat_ts=
> # +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
> +y_0=0 +k=1.0
> # +units=m +nadgrids=@null
> 487147.594520173 4934316.46263998
>
> RESULT POINT: -10370728.80    5552839.74 -0.00
>
> with PROJ 5.0.0-RC6
> -------------------
>
>  >cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
> +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
> +nadgrids=@null
> # ---- From Coordinate System ----
> #Universal Transverse Mercator (UTM)
> #       Cyl, Sph
> #       zone= south
> # +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
> # ---- To Coordinate System ----
> #Mercator
> #       Cyl, Sph&Ell
> #       lat_ts=
> # +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
> +y_0=0 +k=1.0
> # +units=m +nadgrids=@null
> 487147.594520173 4934316.46263998
>
> RESULT POINT: -10370728.80    5522830.15 -10484.03
>
> Discussion
> ----------
>
> PROJ 4.9.3 returns the correct value (I've confirmed this with many
> other tools including QGIS).  Can someone explain why those 2 results
> are different? (I have reproduced this problem on Windows and also
> Ubuntu 14.94)
>
> GDAL
> ====
>
> I wanted to test PROJ v5 by using that same test point (as a shapefile)
> in EPSG:26915 (UTM Zone 15) and reprojecting that to EPSG:3857 (Google's
> Mercator), using GDAL's ogr2ogr command.  (data used:
> https://www.gatewaygeomatics.com/dl/parcels-proj-v5-test.zip )  Below I
> have used the ogr2ogr command (included in the "commands.txt" file in
> that data download) and then ogrinfo on the reprojected file to output:
>
> with PROJ 4.9.3
> ---------------
>
> POINT (-10370728.7959208 5552839.74177463)
>
> with PROJ 5.0.0-RC6
> -------------------
>
> POINT (-10370728.7959208 5522830.1464459)
>
> Discussion
> ----------
>
> PROJ 4.9.3 compiled into GDAL 2.2.3 returns the correct point value, but
> returns a different point value with PROJ 5.0.0-RC6
>
> MapServer
> =========
>
> Same problems as GDAL (reprojected layer has different extents with PROJ
> 5.0.0-RC6, causing problems to display the reprojected layer in a map
> image).
>
>
> If you made it this far in my long email, thanks for listening (I am
> totally stumped on this one, again ha).
>
> -jeff
>
>
>
>
>
> On 2018-02-25 3:45 PM, Kristian Evers wrote:
> > Thanks for testing, Jeff. It is very appreciated. I hope you sort of
> your problems,
> > PROJ-related or not.
> >
> > /Kristian
> >
> >> On 25 Feb 2018, at 00:29, Jeff McKenna <jmckenna at gatewaygeomatics.com>
> wrote:
> >>
> >> Update: it seems many things were happening, causing me to look in wrong
> >> places.  But in the end MapServer was in fact reprojecting the points;
> >> what caused me total confusion was that I was testing with several
> >> MapServer-related applications that are part of MS4W (Mapbender,
> >> GeoMOOSE) and one application had a totally blank opening map image with
> >> PROJ v5.  In fact for some reason the old hardcoded map extents
> >> (displayed in EPSG:3857) no longer display the data (you have to now
> >> zoom out a bit to see the data, reprojected with PROJ v5).  I'll contact
> >> the GeoMOOSE team to let them dive into this (still, it could be my
> >> Windows environment, as no one else seems to be testing MapServer + PROJ
> >> v5 yet).
> >>
> >> Very sorry for all this noise!
> >>
> >> Short story: all is fine with RC5 here.
> >>
> >> Thank you again Kristian for your passion driving this.
> >>
> >> -jeff
> >>
> >>
> >>
> >>
> >>
> >> On 2018-02-23 5:33 PM, Jeff McKenna wrote:
> >>> Hi Kristian,
> >>>
> >>> No problems here on Windows in the MS4W environment, but I'm running
> >>> into odd errors when I have MapServer call PROJ 5
> >>> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-
> February/015347.html).
> >>>    Obviously an issue downstream not here, but I thought I'd at least
> >>> mention it here that I am testing RC5 as well :)
> >>>
> >>> Thanks for pushing this release along.
> >>>
> >>> -jeff
> >>>
> >>>
> >>>
> >>>
> >>> On 2018-02-23 3:19 PM, Kristian Evers wrote:
> >>>> All,
> >>>>
> >>>> I have prepared PROJ 5.0.0RC5. Downloads are here:
> >>>>
> >>>>
> >>>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (
> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
> >>>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (
> http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
> >>>>
> >>>>
> >>>> Since RC4 problems with vertical grid installation, the Horner
> >>>> transformation and faulty polygon area calculation
> >>>> in geodesic library has been fixed. Hopefully this will be the final
> >>>> release candidate. I will call for a vote for
> >>>> promotion to final release on the 27th. Unless serious issues are
> >>>> discovered in the mean time.
> >>>>
> >>>> /Kristian
> >>>>
> >>>>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180301/c25c4390/attachment.html>

From knudsen.thomas at gmail.com  Wed Feb 28 23:15:47 2018
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Thu, 1 Mar 2018 08:15:47 +0100
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <CAH0YoEMrboneuOajeEi-e3fLJo3Bt6YK5xj9u8NKnhmrsSoDqw@mail.gmail.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
	<51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
	<19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>
	<150961d6-0b98-f5a1-50d7-288ccff3e260@gatewaygeomatics.com>
	<CAH0YoEMrboneuOajeEi-e3fLJo3Bt6YK5xj9u8NKnhmrsSoDqw@mail.gmail.com>
Message-ID: <CAH0YoEPjFL=K_Y4jaM6Ue_CnqxHZabObK+59CGr0TNnpd8h-Nw@mail.gmail.com>

Actually, it seems related to handling of the null grid specificly: When
using the conus grid, the 10 km jump into the lithosphere is avoided
(although we get the 2D correction we ask for, but really don't want):

$ echo 487147.594520173 4934316.46263998 0 | cs2cs -f %.16f %FROM% +to
+proj=latlong +datun=NAD83 | cs2cs +proj=latlong +datum=NAD83 +to
+proj=merc +R=6378137 +nadgrids=conus

> -10370704.71    5552845.16    -0.00

Note: Height set to negative zero... not sure yet whether this is a hint






2018-03-01 7:58 GMT+01:00 Thomas Knudsen <knudsen.thomas at gmail.com>:

> Jeff,
>
> That's interesting (although annoying!)
>
> When I leave out the final nadgrids=@null, I get the correct result from
> PROJ v5RC6. Can you reproduce that?
>
> Note, I'm not implying that this should be considered a solution or
> workaround, merely trying to narrow in on the
> problem, which seems to be related to datum handling.
>
> /Thomas
>
>
>
>
>
> 2018-03-01 0:38 GMT+01:00 Jeff McKenna <jmckenna at gatewaygeomatics.com>:
>
>> Update: I never heard back from anyone else about testing PROJ v5 +
>> MapServer (and GDAL), so in fact I may be the only person to test this
>> combination so far.  Because this is a PROJ mailing list I first give
>> some more feedback with PROJ utilities, then later will list results
>> from other software for anyone interested.  (in reality I first noticed
>> the problem in MapServer but then each test in GDAL then PROJ failed as
>> well, on Windows with PROJ 5.0.0-RC6)
>>
>> cs2cs
>> =====
>>
>> I wanted to test PROJ v5 by using a point
>> (487147.594520173,4934316.46263998) in EPSG:26915 (UTM Zone 15) and
>> reprojecting that to EPSG:3857 (Google's Mercator).
>>
>> with PROJ 4.9.3
>> ---------------
>>
>> cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
>> +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
>> +nadgrids=@null
>> # ---- From Coordinate System ----
>> #Universal Transverse Mercator (UTM)
>> #       Cyl, Sph
>> #       zone= south
>> # +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
>> # ---- To Coordinate System ----
>> #Mercator
>> #       Cyl, Sph&Ell
>> #       lat_ts=
>> # +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
>> +y_0=0 +k=1.0
>> # +units=m +nadgrids=@null
>> 487147.594520173 4934316.46263998
>>
>> RESULT POINT: -10370728.80    5552839.74 -0.00
>>
>> with PROJ 5.0.0-RC6
>> -------------------
>>
>>  >cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
>> +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
>> +nadgrids=@null
>> # ---- From Coordinate System ----
>> #Universal Transverse Mercator (UTM)
>> #       Cyl, Sph
>> #       zone= south
>> # +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
>> # ---- To Coordinate System ----
>> #Mercator
>> #       Cyl, Sph&Ell
>> #       lat_ts=
>> # +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
>> +y_0=0 +k=1.0
>> # +units=m +nadgrids=@null
>> 487147.594520173 4934316.46263998
>>
>> RESULT POINT: -10370728.80    5522830.15 -10484.03
>>
>> Discussion
>> ----------
>>
>> PROJ 4.9.3 returns the correct value (I've confirmed this with many
>> other tools including QGIS).  Can someone explain why those 2 results
>> are different? (I have reproduced this problem on Windows and also
>> Ubuntu 14.94)
>>
>> GDAL
>> ====
>>
>> I wanted to test PROJ v5 by using that same test point (as a shapefile)
>> in EPSG:26915 (UTM Zone 15) and reprojecting that to EPSG:3857 (Google's
>> Mercator), using GDAL's ogr2ogr command.  (data used:
>> https://www.gatewaygeomatics.com/dl/parcels-proj-v5-test.zip )  Below I
>> have used the ogr2ogr command (included in the "commands.txt" file in
>> that data download) and then ogrinfo on the reprojected file to output:
>>
>> with PROJ 4.9.3
>> ---------------
>>
>> POINT (-10370728.7959208 5552839.74177463)
>>
>> with PROJ 5.0.0-RC6
>> -------------------
>>
>> POINT (-10370728.7959208 5522830.1464459)
>>
>> Discussion
>> ----------
>>
>> PROJ 4.9.3 compiled into GDAL 2.2.3 returns the correct point value, but
>> returns a different point value with PROJ 5.0.0-RC6
>>
>> MapServer
>> =========
>>
>> Same problems as GDAL (reprojected layer has different extents with PROJ
>> 5.0.0-RC6, causing problems to display the reprojected layer in a map
>> image).
>>
>>
>> If you made it this far in my long email, thanks for listening (I am
>> totally stumped on this one, again ha).
>>
>> -jeff
>>
>>
>>
>>
>>
>> On 2018-02-25 3:45 PM, Kristian Evers wrote:
>> > Thanks for testing, Jeff. It is very appreciated. I hope you sort of
>> your problems,
>> > PROJ-related or not.
>> >
>> > /Kristian
>> >
>> >> On 25 Feb 2018, at 00:29, Jeff McKenna <jmckenna at gatewaygeomatics.com>
>> wrote:
>> >>
>> >> Update: it seems many things were happening, causing me to look in
>> wrong
>> >> places.  But in the end MapServer was in fact reprojecting the points;
>> >> what caused me total confusion was that I was testing with several
>> >> MapServer-related applications that are part of MS4W (Mapbender,
>> >> GeoMOOSE) and one application had a totally blank opening map image
>> with
>> >> PROJ v5.  In fact for some reason the old hardcoded map extents
>> >> (displayed in EPSG:3857) no longer display the data (you have to now
>> >> zoom out a bit to see the data, reprojected with PROJ v5).  I'll
>> contact
>> >> the GeoMOOSE team to let them dive into this (still, it could be my
>> >> Windows environment, as no one else seems to be testing MapServer +
>> PROJ
>> >> v5 yet).
>> >>
>> >> Very sorry for all this noise!
>> >>
>> >> Short story: all is fine with RC5 here.
>> >>
>> >> Thank you again Kristian for your passion driving this.
>> >>
>> >> -jeff
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> On 2018-02-23 5:33 PM, Jeff McKenna wrote:
>> >>> Hi Kristian,
>> >>>
>> >>> No problems here on Windows in the MS4W environment, but I'm running
>> >>> into odd errors when I have MapServer call PROJ 5
>> >>> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-Februa
>> ry/015347.html).
>> >>>    Obviously an issue downstream not here, but I thought I'd at least
>> >>> mention it here that I am testing RC5 as well :)
>> >>>
>> >>> Thanks for pushing this release along.
>> >>>
>> >>> -jeff
>> >>>
>> >>>
>> >>>
>> >>>
>> >>> On 2018-02-23 3:19 PM, Kristian Evers wrote:
>> >>>> All,
>> >>>>
>> >>>> I have prepared PROJ 5.0.0RC5. Downloads are here:
>> >>>>
>> >>>>
>> >>>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (
>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
>> >>>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (
>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
>> >>>>
>> >>>>
>> >>>> Since RC4 problems with vertical grid installation, the Horner
>> >>>> transformation and faulty polygon area calculation
>> >>>> in geodesic library has been fixed. Hopefully this will be the final
>> >>>> release candidate. I will call for a vote for
>> >>>> promotion to final release on the 27th. Unless serious issues are
>> >>>> discovered in the mean time.
>> >>>>
>> >>>> /Kristian
>> >>>>
>> >>>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180301/d97ea4a9/attachment.html>

From kreve at sdfe.dk  Wed Feb 28 23:39:26 2018
From: kreve at sdfe.dk (Kristian Evers)
Date: Thu, 1 Mar 2018 07:39:26 +0000
Subject: [Proj] PROJ 5.0.0RC5
In-Reply-To: <CAH0YoEPjFL=K_Y4jaM6Ue_CnqxHZabObK+59CGr0TNnpd8h-Nw@mail.gmail.com>
References: <7BE0C5E2-310B-432F-99EF-AB3F6844E7E3@sdfe.dk>
	<df0f271c-75ba-f188-4418-933fe0577508@gatewaygeomatics.com>
	<51f2ea7c-95fe-91e2-c688-e7956ae18853@gatewaygeomatics.com>
	<19FD79C9-9167-4B90-99BB-89ECF5DFAF34@sdfe.dk>
	<150961d6-0b98-f5a1-50d7-288ccff3e260@gatewaygeomatics.com>
	<CAH0YoEMrboneuOajeEi-e3fLJo3Bt6YK5xj9u8NKnhmrsSoDqw@mail.gmail.com>
	<CAH0YoEPjFL=K_Y4jaM6Ue_CnqxHZabObK+59CGr0TNnpd8h-Nw@mail.gmail.com>
Message-ID: <8F946A83-CD84-4DA8-B5CD-3233F3648A90@sdfe.dk>

I am not sure that is correct, Thomas. See the following output:

$ echo 487147.594520173 4934316.46263998 | ./cs2cs -v +proj=utm +zone=15 +to +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +ellps=WGS84
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0
# +units=m +nadgrids=@null
-10370728.80    5552839.74 0.00

$ echo 487147.594520173 4934316.46263998 | ./cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0
# +units=m
-10370728.80    5552839.74 0.0

It seems to be the combination of +datum=NAD83 in the input system and +nadgrids=@null in the output system.
When only one (either one) of them is present the transformation is fine. They are supposed to be treated as being
the same datum, but isn’t. I have an idea where to fix this.

/Kristian

On 1 Mar 2018, at 08:15, Thomas Knudsen <knudsen.thomas at gmail.com<mailto:knudsen.thomas at gmail.com>> wrote:

Actually, it seems related to handling of the null grid specificly: When using the conus grid, the 10 km jump into the lithosphere is avoided (although we get the 2D correction we ask for, but really don't want):

$ echo 487147.594520173 4934316.46263998 0 | cs2cs -f %.16f %FROM% +to +proj=latlong +datun=NAD83 | cs2cs +proj=latlong +datum=NAD83 +to +proj=merc +R=6378137 +nadgrids=conus

> -10370704.71    5552845.16    -0.00

Note: Height set to negative zero... not sure yet whether this is a hint






2018-03-01 7:58 GMT+01:00 Thomas Knudsen <knudsen.thomas at gmail.com<mailto:knudsen.thomas at gmail.com>>:
Jeff,

That's interesting (although annoying!)

When I leave out the final nadgrids=@null, I get the correct result from PROJ v5RC6. Can you reproduce that?

Note, I'm not implying that this should be considered a solution or workaround, merely trying to narrow in on the
problem, which seems to be related to datum handling.

/Thomas





2018-03-01 0:38 GMT+01:00 Jeff McKenna <jmckenna at gatewaygeomatics.com<mailto:jmckenna at gatewaygeomatics.com>>:
Update: I never heard back from anyone else about testing PROJ v5 +
MapServer (and GDAL), so in fact I may be the only person to test this
combination so far.  Because this is a PROJ mailing list I first give
some more feedback with PROJ utilities, then later will list results
from other software for anyone interested.  (in reality I first noticed
the problem in MapServer but then each test in GDAL then PROJ failed as
well, on Windows with PROJ 5.0.0-RC6)

cs2cs
=====

I wanted to test PROJ v5 by using a point
(487147.594520173,4934316.46263998) in EPSG:26915 (UTM Zone 15) and
reprojecting that to EPSG:3857 (Google's Mercator).

with PROJ 4.9.3
---------------

cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
+b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
+nadgrids=@null
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
+y_0=0 +k=1.0
# +units=m +nadgrids=@null
487147.594520173 4934316.46263998

RESULT POINT: -10370728.80    5552839.74 -0.00

with PROJ 5.0.0-RC6
-------------------

 >cs2cs -v +proj=utm +zone=15 +datum=NAD83 +to +proj=merc +a=6378137
+b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
+nadgrids=@null
# ---- From Coordinate System ----
#Universal Transverse Mercator (UTM)
#       Cyl, Sph
#       zone= south
# +proj=utm +zone=15 +datum=NAD83 +ellps=GRS80 +towgs84=0,0,0
# ---- To Coordinate System ----
#Mercator
#       Cyl, Sph&Ell
#       lat_ts=
# +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
+y_0=0 +k=1.0
# +units=m +nadgrids=@null
487147.594520173 4934316.46263998

RESULT POINT: -10370728.80    5522830.15 -10484.03

Discussion
----------

PROJ 4.9.3 returns the correct value (I've confirmed this with many
other tools including QGIS).  Can someone explain why those 2 results
are different? (I have reproduced this problem on Windows and also
Ubuntu 14.94)

GDAL
====

I wanted to test PROJ v5 by using that same test point (as a shapefile)
in EPSG:26915 (UTM Zone 15) and reprojecting that to EPSG:3857 (Google's
Mercator), using GDAL's ogr2ogr command.  (data used:
https://www.gatewaygeomatics.com/dl/parcels-proj-v5-test.zip )  Below I
have used the ogr2ogr command (included in the "commands.txt" file in
that data download) and then ogrinfo on the reprojected file to output:

with PROJ 4.9.3
---------------

POINT (-10370728.7959208 5552839.74177463)

with PROJ 5.0.0-RC6
-------------------

POINT (-10370728.7959208 5522830.1464459)

Discussion
----------

PROJ 4.9.3 compiled into GDAL 2.2.3 returns the correct point value, but
returns a different point value with PROJ 5.0.0-RC6

MapServer
=========

Same problems as GDAL (reprojected layer has different extents with PROJ
5.0.0-RC6, causing problems to display the reprojected layer in a map
image).


If you made it this far in my long email, thanks for listening (I am
totally stumped on this one, again ha).

-jeff





On 2018-02-25 3:45 PM, Kristian Evers wrote:
> Thanks for testing, Jeff. It is very appreciated. I hope you sort of your problems,
> PROJ-related or not.
>
> /Kristian
>
>> On 25 Feb 2018, at 00:29, Jeff McKenna <jmckenna at gatewaygeomatics.com<mailto:jmckenna at gatewaygeomatics.com>> wrote:
>>
>> Update: it seems many things were happening, causing me to look in wrong
>> places.  But in the end MapServer was in fact reprojecting the points;
>> what caused me total confusion was that I was testing with several
>> MapServer-related applications that are part of MS4W (Mapbender,
>> GeoMOOSE) and one application had a totally blank opening map image with
>> PROJ v5.  In fact for some reason the old hardcoded map extents
>> (displayed in EPSG:3857) no longer display the data (you have to now
>> zoom out a bit to see the data, reprojected with PROJ v5).  I'll contact
>> the GeoMOOSE team to let them dive into this (still, it could be my
>> Windows environment, as no one else seems to be testing MapServer + PROJ
>> v5 yet).
>>
>> Very sorry for all this noise!
>>
>> Short story: all is fine with RC5 here.
>>
>> Thank you again Kristian for your passion driving this.
>>
>> -jeff
>>
>>
>>
>>
>>
>> On 2018-02-23 5:33 PM, Jeff McKenna wrote:
>>> Hi Kristian,
>>>
>>> No problems here on Windows in the MS4W environment, but I'm running
>>> into odd errors when I have MapServer call PROJ 5
>>> (https://lists.osgeo.org/pipermail/mapserver-dev/2018-February/015347.html).
>>>    Obviously an issue downstream not here, but I thought I'd at least
>>> mention it here that I am testing RC5 as well :)
>>>
>>> Thanks for pushing this release along.
>>>
>>> -jeff
>>>
>>>
>>>
>>>
>>> On 2018-02-23 3:19 PM, Kristian Evers wrote:
>>>> All,
>>>>
>>>> I have prepared PROJ 5.0.0RC5. Downloads are here:
>>>>
>>>>
>>>> http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz (http://download.osgeo.org/proj/proj-5.0.0RC5.tar.gz.md5)
>>>> http://download.osgeo.org/proj/proj-5.0.0RC5.zip (http://download.osgeo.org/proj/proj-5.0.0RC5.zip.md5)
>>>>
>>>>
>>>> Since RC4 problems with vertical grid installation, the Horner
>>>> transformation and faulty polygon area calculation
>>>> in geodesic library has been fixed. Hopefully this will be the final
>>>> release candidate. I will call for a vote for
>>>> promotion to final release on the 27th. Unless serious issues are
>>>> discovered in the mean time.
>>>>
>>>> /Kristian
>>>>
>>>>
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj


_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20180301/c030c4a6/attachment.html>

