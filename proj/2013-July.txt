From drescampbell at googlemail.com  Tue Jul  2 11:24:19 2013
From: drescampbell at googlemail.com (Ed Campbell)
Date: Tue, 2 Jul 2013 19:24:19 +0100
Subject: [Proj] Virtual File Access
Message-ID: <CAEiHszXL1piafNqkuVGO0H_L7jX6Z9OnzFDENGjNT+O1AwacnQ@mail.gmail.com>

On 25 June 2013 08:21, Frank Warmerdam <warmerdam at pobox.com> wrote:
> Phil,
>
> I'm not taking any action on Robinson relates issues currently.  Is there an
> open ticket?  Proposed patches?
>

The open ticket number for the issue with the Robinson projection is
#113 http://trac.osgeo.org/proj/ticket/113 see my email
http://article.gmane.org/gmane.comp.gis.proj-4.devel/6039

I have a patch. Should I post it here?

Ed Campbell PhD
UK Met Office
Iris & Cartopy - http://scitools.org.uk/


From warmerdam at pobox.com  Tue Jul  2 14:10:05 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 2 Jul 2013 14:10:05 -0700
Subject: [Proj] Virtual File Access
In-Reply-To: <CAEiHszXL1piafNqkuVGO0H_L7jX6Z9OnzFDENGjNT+O1AwacnQ@mail.gmail.com>
References: <CAEiHszXL1piafNqkuVGO0H_L7jX6Z9OnzFDENGjNT+O1AwacnQ@mail.gmail.com>
Message-ID: <CA+YzLBd-UXpfxOejaeFyxiYsedDuH1+EsKp0gELEpJRAOKKVhw@mail.gmail.com>

Ed,

I've applied your coefficients in trunk and they should appear in 4.9.0.

Thanks!

Best regards,
Frank


On Tue, Jul 2, 2013 at 11:24 AM, Ed Campbell <drescampbell at googlemail.com>wrote:

> On 25 June 2013 08:21, Frank Warmerdam <warmerdam at pobox.com> wrote:
> > Phil,
> >
> > I'm not taking any action on Robinson relates issues currently.  Is
> there an
> > open ticket?  Proposed patches?
> >
>
> The open ticket number for the issue with the Robinson projection is
> #113 http://trac.osgeo.org/proj/ticket/113 see my email
> http://article.gmane.org/gmane.comp.gis.proj-4.devel/6039
>
> I have a patch. Should I post it here?
>
> Ed Campbell PhD
> UK Met Office
> Iris & Cartopy - http://scitools.org.uk/
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130702/5f4bb8f5/attachment.html>

From warmerdam at pobox.com  Wed Jul  3 07:42:09 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 3 Jul 2013 07:42:09 -0700
Subject: [Proj] PROJ 4.9.0 Beta1
Message-ID: <CA+YzLBfXQ=pPh1NkPy3Jn6V7qHHV0D2X8UJmg1HmS-1oFab3ew@mail.gmail.com>

Folks,

I have prepared a 4.9.0 Beta 1 release file at:

  http://download.osgeo.org/proj/proj-4.9.0b1.tar.gz
  http://download.osgeo.org/proj/proj-4.9.0b1.zip

The NEWS file reports:
 o Implement new virtual file api (projFileAPI) so that all access to grid
   shift and init files can be hooked.

 o Replace geodesic implementation with one from Charles Karney and add a
   supported public interface (geod_interface.h).

 o Upgraded to EPSG 8.0.

 o Removed old (deprecated) Java bindings in favor of the new api introduced
   in 4.8.0.

 o Various bug fixes and cleanup.

There is still time to fix additional problems before a final release
though as usual it is helpful to supply patches in the tickets.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130703/f9c23497/attachment.html>

From mauceri at actgate.com  Fri Jul  5 09:07:44 2013
From: mauceri at actgate.com (Calogero Mauceri)
Date: Fri, 05 Jul 2013 18:07:44 +0200
Subject: [Proj] How to get the list of projections available
Message-ID: <51D6EF50.4020007@actgate.com>

Hi all,

is there a way in proj lib to get the list of projections available, 
programmatically?
I just need the name of all projections available to populate a table to 
expose to the user, similar to what the proj utility does with -l option 
(proj -l).
The proj utility is using the pj_get_list_ref() function, but it does 
not seem to be exposed in the proj_api.h file.

Is there any other way to get that info?
Thanks in advance for your help.
     Calogero

-- 
Calogero Mauceri
Software Engineer

Applied Coherent Technology Corporation (ACT)
www.actgate.com




From netr at caramail.com  Thu Jul 11 11:00:47 2013
From: netr at caramail.com (netr)
Date: Thu, 11 Jul 2013 11:00:47 -0700 (PDT)
Subject: [Proj] Compilation on AIX64
Message-ID: <1373565647996-5065849.post@n6.nabble.com>

Hello,

First, please excuse my english, I didn't practice for a long time.

I'm currently developing a component using the libproj.a on AIX. But it
doesn't link the libproj.a that I previously generate on the same
environement.


For my component I use "gcc -maix64" to compile, but, to obtain the
libproj.a, I followed the instruction and used the makefile autogenerated by
proj4. However, it used "gcc". So, I changed, the token CC=gcc -maix64 in
the makfile, but I still have an issuein the liking.

Do you have any idea, I'm lost...indeed, I'm a JAVA developper not a C
expert ;-)

Thanks by advance for any help.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Compilation-on-AIX64-tp5065849.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From warmerdam at pobox.com  Thu Jul 11 11:24:44 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 11 Jul 2013 11:24:44 -0700
Subject: [Proj] Compilation on AIX64
In-Reply-To: <1373565647996-5065849.post@n6.nabble.com>
References: <1373565647996-5065849.post@n6.nabble.com>
Message-ID: <CA+YzLBdArTDbVDv6LrcaG1qycOFQLRn=87J3WNSL68jjnk=MVQ@mail.gmail.com>

Netr,

If you want to use a different compiler the usual practice is to do
something like:

export CC="gcc -maix64"
./configure
make

I don't know an particulars about your system or AIX specific issues, but
if you have a followup email on this problem you are more likely to get
asistance if you include the resulting link command in the build and the
error produced.

Best regards,
Frank



On Thu, Jul 11, 2013 at 11:00 AM, netr <netr at caramail.com> wrote:

> Hello,
>
> First, please excuse my english, I didn't practice for a long time.
>
> I'm currently developing a component using the libproj.a on AIX. But it
> doesn't link the libproj.a that I previously generate on the same
> environement.
>
>
> For my component I use "gcc -maix64" to compile, but, to obtain the
> libproj.a, I followed the instruction and used the makefile autogenerated
> by
> proj4. However, it used "gcc". So, I changed, the token CC=gcc -maix64 in
> the makfile, but I still have an issuein the liking.
>
> Do you have any idea, I'm lost...indeed, I'm a JAVA developper not a C
> expert ;-)
>
> Thanks by advance for any help.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Compilation-on-AIX64-tp5065849.html
> Sent from the PROJ.4 mailing list archive at Nabble.com.
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130711/21a04132/attachment.html>

From netr at caramail.com  Mon Jul 15 02:45:36 2013
From: netr at caramail.com (netr)
Date: Mon, 15 Jul 2013 02:45:36 -0700 (PDT)
Subject: [Proj] Compilation on AIX64
In-Reply-To: <1373565647996-5065849.post@n6.nabble.com>
References: <1373565647996-5065849.post@n6.nabble.com>
Message-ID: <1373881536272-5066395.post@n6.nabble.com>

Hello everybody,

I finally mange to compile it as a 64bit file by using :

NM="nm -B -X 64" LDFLAGS="-maix64" LIBS="-lpthread" AR"ar -X 64" CC="gcc
-maix64" ./configure

Then lauching the make.

However, the libproj I obtain is not a COFF file and I can't integrate it in
my programm...the liking doesn't work.

Do you know how I could obtain a COFF file?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Compilation-on-AIX64-tp5065849p5066395.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From charles.karney at sri.com  Sun Jul 21 08:46:25 2013
From: charles.karney at sri.com (Charles Karney)
Date: Sun, 21 Jul 2013 11:46:25 -0400
Subject: [Proj] Bugs and enhancements to etmerc
In-Reply-To: <CA+YzLBfXQ=pPh1NkPy3Jn6V7qHHV0D2X8UJmg1HmS-1oFab3ew@mail.gmail.com>
References: <CA+YzLBfXQ=pPh1NkPy3Jn6V7qHHV0D2X8UJmg1HmS-1oFab3ew@mail.gmail.com>
Message-ID: <51EC0251.4000303@sri.com>

I've just submitted a patch to the etmerc projection to address
3 issues:

(1) Two terms in the series for converting from conformal
latitude to geographic latitude were wrong.  They now match
Engsager and Poder (2007).  These errors were in the n^5
coefficients and introduced small (about 1 um) errors into the
inverse mapping.

(2) A forthcoming revision of DMA Technical Manual TM8358.2 "The
Universal Grids: UTM and UPS" will recommend the Krueger series
(the same as used by Engsager and Poder) extended to sixth order
in n.  Thus it's a good time to make the upgrade to etmerc to
sixth order.

(3) I've fixed some of the expressions in etmerc to avoid
accumulating round-off errors, e.g.,

   sinh(x) instead of (exp(x) - exp(-x))/2,
   f = e^2 / (1 + sqrt(1 - e^2)) instead of 1 - sqrt(1 - e^2).

   --Charles



From gdt at ir.bbn.com  Thu Jul 25 16:55:07 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Thu, 25 Jul 2013 19:55:07 -0400
Subject: [Proj] Virtual File Access
In-Reply-To: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	(Frank Warmerdam's message of "Sat, 22 Jun 2013 10:32:48 -0700")
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
Message-ID: <rmiy58unqjo.fsf@fnord.ir.bbn.com>


Frank Warmerdam <warmerdam at pobox.com> writes:

> Folks,
>
> To smooth out deployment of PROJ.4 at my workplace, I have made some
> changes so that all file access can go through a virtual layer. This
> virtual file
> api looks like the following, and is associated with a "context" (projCtx).
>
> typedef struct projFileAPI_t {
>     PAFile  (*FOpen)(projCtx ctx, const char *filename, const char *access);
>     size_t  (*FRead)(void *buffer, size_t size, size_t nmemb, PAFile file);
>     int     (*FSeek)(PAFile file, long offset, int whence);
>     long    (*FTell)(PAFile file);
>     void    (*FClose)(PAFile);
> } projFileAPI;
>
> I have reworked the the init file and grid shift file access goes through
> this
> and provided a default "stdio" based implementation.  These changes are
> now available in svn and I have yet to actually try it out beyond use of the
> stdio based implementation, but I'm interested in if anyone sees this as
> useful or has thoughts on how it ought to be done better.
>
> I'm also contemplating an optional build mechanism that will build grid
> shift files and init files right into the shared library for easy deployment
> though I'm not sure exactly how I'll do that yet.

This strikes me as adding extra complexity into proj and implementing
features that really belong as a separate package.  I'm guessing that
there is something broken about the environment that you are working in
that installing a package to a standard path that has a binary or
library and data files is just too awkward.  Is that a windows-only
issue?

If this sort of thing really is needed, it seems better to have a
package that supports building and accessing files from within a library
as a function that can be hooked into any library's build.   PROJ.4 is
not special in needing to read data files.

Has anyone else had this problem?  On what OS?
What do people do about window installers, in terms of interacting with
(surely there must be) the native packaging system?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130725/0c2747b5/attachment.sig>

From gdt at ir.bbn.com  Thu Jul 25 17:01:37 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Thu, 25 Jul 2013 20:01:37 -0400
Subject: [Proj] [osgeo4w-dev] Using cmake of osgeo projects?
In-Reply-To: <51CF8955.7@sri.com> (Charles Karney's message of "Sat, 29 Jun
	2013 21:26:45 -0400")
References: <51CE0B90.6070109@sri.com>
	<CABUeae-u=P9JpwieXrDY1QA=_ss8crkMEtu+xXfbcPPVKUcvSw@mail.gmail.com>
	<51CEEAEB.9080208@sri.com>
	<CABUeae__1m-sHM8pivN8muOTyffD=DN1iMg8ivjzJzVHGumk_A@mail.gmail.com>
	<51CF8955.7@sri.com>
Message-ID: <rmitxjinq8u.fsf@fnord.ir.bbn.com>


Charles Karney <charles.karney at sri.com> writes:

> On 06/29/2013 09:05 PM, Mateusz Loskot wrote:
>> I don't know what's typical, regarding developer's reaction on CMake adoption
>> proposal, but as a big fan of CMake, I wouldn't paint it in pink colours only.
>>
>> Thus, I understand, for example, Frank's experience may be very different.
>>
>> Finally, if a software has a build system that is usable and works on
>> all supported
>> platforms, I also understand a team may go for lean approach: don't change it.
>>
>
> I basically agree.  However, let's not forget those users who need, for
> one reason or another, to compile these packages themselves.

I find it odd to talk about how one can't compiile packages oneself when
they use autoconf.

Is this really about accomodating windows without using cygwin?  I have
found that autoconf/automake/libtool is really quite workable.

Does cmake support

   building in an objdir, with a read-only srcdir

   cross-compiling

   the equivalent of 'make dist' and 'make distcheck'

   building on a system not previously known to the build system, as
   long as feature tests are doable

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130725/d0c496b3/attachment.sig>

From warmerdam at pobox.com  Thu Jul 25 17:36:27 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 25 Jul 2013 17:36:27 -0700
Subject: [Proj] Virtual File Access
In-Reply-To: <rmiy58unqjo.fsf@fnord.ir.bbn.com>
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
Message-ID: <CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>

On Thu, Jul 25, 2013 at 4:55 PM, Greg Troxel <gdt at ir.bbn.com> wrote:

>
> Frank Warmerdam <warmerdam at pobox.com> writes:
>
> > Folks,
> >
> > To smooth out deployment of PROJ.4 at my workplace, I have made some
> > changes so that all file access can go through a virtual layer. This
> > virtual file
> > api looks like the following, and is associated with a "context"
> (projCtx).
> ...
>
> This strikes me as adding extra complexity into proj and implementing
> features that really belong as a separate package.  I'm guessing that
> there is something broken about the environment that you are working in
> that installing a package to a standard path that has a binary or
> library and data files is just too awkward.  Is that a windows-only
> issue?
>

Greg,

Quite possibly there are many things broken about the environment I work
in, but running things on windows is certainly not one of them.


> If this sort of thing really is needed, it seems better to have a
> package that supports building and accessing files from within a library
> as a function that can be hooked into any library's build.   PROJ.4 is
> not special in needing to read data files.


It might possibly be nice to have a generic cross platform way for software
to hook stdio so as to redirect file access, but that does not seem to be
part of the standard C libraries.  I'm sure there are libraries which could
offer an appropriate indirection api, but I'm hesitant to add dependencies
to PROJ.4 without a large need.

But the point I'd like to stress is that I believe it is generally a good
practice for low level libraries to provide a way to hook IO so that
applications can do a variety of things around file access.  Libraries like
libtiff, GDAL, shapelib and libpng have done this for a long time.  I'm
extending it to PROJ.4.


> Has anyone else had this problem?  On what OS?

What do people do about window installers, in terms of interacting with
> (surely there must be) the native packaging system?
>

I'm not clear exactly what information you are looking for.  Normal
practice with applications installers using PROJ.4 would be to install the
files somewhere in the file system, and to call pj_set_searchpath()  to
look in the directory in which things were installed from their application
initialization.  The pj_set_searchpath() and pj_set_finder() were intended
to make finding the data files tractable in cases where applications didn't
mind writing them to disk.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130725/e5b9e160/attachment.html>

From charles.karney at sri.com  Fri Jul 26 03:29:37 2013
From: charles.karney at sri.com (Charles Karney)
Date: Fri, 26 Jul 2013 06:29:37 -0400
Subject: [Proj] [osgeo4w-dev] Using cmake of osgeo projects?
In-Reply-To: <rmitxjinq8u.fsf@fnord.ir.bbn.com>
References: <51CE0B90.6070109@sri.com>
	<CABUeae-u=P9JpwieXrDY1QA=_ss8crkMEtu+xXfbcPPVKUcvSw@mail.gmail.com>
	<51CEEAEB.9080208@sri.com>
	<CABUeae__1m-sHM8pivN8muOTyffD=DN1iMg8ivjzJzVHGumk_A@mail.gmail.com>
	<51CF8955.7@sri.com> <rmitxjinq8u.fsf@fnord.ir.bbn.com>
Message-ID: <51F24F91.4020700@sri.com>

On 07/25/2013 08:01 PM, Greg Troxel wrote:
>
> Charles Karney <charles.karney at sri.com> writes:
>
>> On 06/29/2013 09:05 PM, Mateusz Loskot wrote:
>>> I don't know what's typical, regarding developer's reaction on CMake adoption
>>> proposal, but as a big fan of CMake, I wouldn't paint it in pink colours only.
>>>
>>> Thus, I understand, for example, Frank's experience may be very different.
>>>
>>> Finally, if a software has a build system that is usable and works on
>>> all supported
>>> platforms, I also understand a team may go for lean approach: don't change it.
>>>
>>
>> I basically agree.  However, let's not forget those users who need, for
>> one reason or another, to compile these packages themselves.
>
> I find it odd to talk about how one can't compile packages oneself when
> they use autoconf.
>
> Is this really about accommodating windows without using cygwin?  I have
> found that autoconf/automake/libtool is really quite workable.

Windows support is the important issue for some users.  CMakes's other
big advantage relative to autoconf is that it provides a more systematic
way of discovering dependent packages.

I agree that, as a user of a package, autoconf on non-Windows systems
works well.  However, for the developer of a package, autoconf seems
like an ugly hacked-together mess, which I would not recommend to anyone
starting on a new package.  Nevertheless, I concede that the issue gets
more complicated for large packages which already have autoconf support.

> Does cmake support
>
>     building in an objdir, with a read-only srcdir
>
>     cross-compiling
>
>     the equivalent of 'make dist' and 'make distcheck'
>
>     building on a system not previously known to the build system, as
>     long as feature tests are doable

The answer to these is yes.  In particular, building outside the source
tree is the standard procedure with cmake.


From jeremy.boecker at gmail.com  Fri Jul 26 05:22:48 2013
From: jeremy.boecker at gmail.com (jdawg)
Date: Fri, 26 Jul 2013 05:22:48 -0700 (PDT)
Subject: [Proj] So close -- Lat / Long to Pennsylvania State Plane North
	NAD27
In-Reply-To: <1374774086619-5068774.post@n6.nabble.com>
References: <1374774086619-5068774.post@n6.nabble.com>
Message-ID: <1374841368374-5068943.post@n6.nabble.com>

sorry...bumping this message to get it on the mailing list... :)



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/So-close-Lat-Long-to-Pennsylvania-State-Plane-North-NAD27-tp5068774p5068943.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From gdt at ir.bbn.com  Fri Jul 26 06:00:16 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 26 Jul 2013 09:00:16 -0400
Subject: [Proj] Virtual File Access
In-Reply-To: <CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
	(Frank Warmerdam's message of "Thu, 25 Jul 2013 17:36:27 -0700")
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
	<CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
Message-ID: <rmi8v0to4rj.fsf@fnord.ir.bbn.com>


Frank Warmerdam <warmerdam at pobox.com> writes:

Perhaps I am totally misunderstanding what you are doing.   Is this
about letting IO done on behalf of a user to read and write the user's
data (not grid shift files, which are part of the library) to come from
different places?  Or is it about grid shift files, but the goal is
because the user has them in RAM rather than on the filesystem?   I had
the impression that this was about a way to bundle the standard grid
shift/etc. files into the library so that one could have just a single
library file and not the ancilliary files, because managing mulitple
files was somehow too hard.

> Quite possibly there are many things broken about the environment I work
> in, but running things on windows is certainly not one of them.

I'm glad to hear that :-).

So what motivates you to add this code, rather than just installing the
files in the right place?  What is the essence of the problem?

> But the point I'd like to stress is that I believe it is generally a good
> practice for low level libraries to provide a way to hook IO so that
> applications can do a variety of things around file access.  Libraries like
> libtiff, GDAL, shapelib and libpng have done this for a long time.  I'm
> extending it to PROJ.4.

I find that notion unusual and surprising.  I was completely unaware of
those libraries adding what feels like a custom VFS layer.  I looked at
  http://www.libtiff.org/libtiff.html
and found no mention of it.

> I'm not clear exactly what information you are looking for.  Normal
> practice with applications installers using PROJ.4 would be to install the
> files somewhere in the file system, and to call pj_set_searchpath()  to
> look in the directory in which things were installed from their application
> initialization.  The pj_set_searchpath() and pj_set_finder() were intended
> to make finding the data files tractable in cases where applications didn't
> mind writing them to disk.

Where I'm coming from is that I install proj via pkgsrc (and am the
package maintainer).  So it's "pkg_add proj-4.8.0.tar.gz" and then the
library is in /usr/pkg/lib, and the files in /usr/pkg/share/proj (plus
programs in /usr/pkg/bin, man pages...).  I expect it's the same for all
other packaging systems, modulo prefix.  The path to the files is set
via PROJ_LIB at build time to $(pkgdatadir).  So I view it as a bug to
have to set search paths.  There is a single correct place for the grid
files, and they are part of the package (or a depending package if one
wants to split things).

Also, I'd suggest that you consider putting this facility on a branch
instead of in a release until there's both a useful extension
(presumably reading files that were crunched into the library) and
broader consensus that it's a good addition (on the benefit/complexity
tradeoff).

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/4c421e01/attachment.sig>

From richard.greenwood at gmail.com  Fri Jul 26 06:26:54 2013
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Fri, 26 Jul 2013 07:26:54 -0600
Subject: [Proj] So close -- Lat / Long to Pennsylvania State Plane North
	NAD27
In-Reply-To: <1374841368374-5068943.post@n6.nabble.com>
References: <1374774086619-5068774.post@n6.nabble.com>
	<1374841368374-5068943.post@n6.nabble.com>
Message-ID: <CAHBySPZszH8kc7sQu_1twJxXSj_usURgevrpu6r56VaEE=oCzA@mail.gmail.com>

Is your source lon/lat NAD27 or WGS84? If NAD27 then:

echo -75.921819 41.295735 | cs2cs -v +init=epsg:4267 +to +init=epsg:32028

or if WGS84 the:

echo -75.921819 41.295735 | cs2cs -v +init=epsg:4326 +to +init=epsg:32028

Rich



On Fri, Jul 26, 2013 at 6:22 AM, jdawg <jeremy.boecker at gmail.com> wrote:

> sorry...bumping this message to get it on the mailing list... :)
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/So-close-Lat-Long-to-Pennsylvania-State-Plane-North-NAD27-tp5068774p5068943.html
> Sent from the PROJ.4 mailing list archive at Nabble.com.
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



-- 
Richard Greenwood
richard.greenwood at gmail.com
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/008650e8/attachment.html>

From paul-grass at stjohnspoint.co.uk  Fri Jul 26 07:32:22 2013
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Fri, 26 Jul 2013 16:32:22 +0200
Subject: [Proj] Virtual File Access
In-Reply-To: <rmi8v0to4rj.fsf@fnord.ir.bbn.com>
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
	<CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
	<rmi8v0to4rj.fsf@fnord.ir.bbn.com>
Message-ID: <51F28876.9090308@stjohnspoint.co.uk>

Greg Troxel wrote:
>
> Frank Warmerdam <warmerdam at pobox.com> writes:
>
> Perhaps I am totally misunderstanding what you are doing.   Is this
> about letting IO done on behalf of a user to read and write the user's
> data (not grid shift files, which are part of the library) to come from
> different places?
[...]
> The path to the files is set
> via PROJ_LIB at build time to $(pkgdatadir).  So I view it as a bug to
> have to set search paths.  There is a single correct place for the grid
> files, and they are part of the package (or a depending package if one
> wants to split things).

What's to say a gridshift file might not also be user-supplied? What do 
you do then if you want to use a grid file you've created yourself (e.g. 
as I did a few years ago: 
<http://www.stjohnspoint.co.uk/gis/france.htm>), or got from an external 
source, and don't have root access to install it in the "single correct 
place"?

Or what if you're running PROJ.4 on some obscure embedded system that 
doesn't have the concept of a conventional filesystem and you need to 
access the gridshift data over a network connection, or even embed it in 
the binary?

The solution Frank has implemented looks to me flexible enough to handle 
any such unusual situations, as long as you write the necessary 
interface functions to make whatever way you've stored the gridshift 
data appears to the PROJ.4 library as if its seeking around in a file. 
Seems to me a lot more elegant than the old pj_set_finder() solution - 
although for simple cases of the gridshift files being stored in a 
non-standard directory that's obviously simpler to use.

Paul


From gdt at ir.bbn.com  Fri Jul 26 07:52:03 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 26 Jul 2013 10:52:03 -0400
Subject: [Proj] Virtual File Access
In-Reply-To: <51F28876.9090308@stjohnspoint.co.uk> (Paul Kelly's message of
	"Fri, 26 Jul 2013 16:32:22 +0200")
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
	<CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
	<rmi8v0to4rj.fsf@fnord.ir.bbn.com>
	<51F28876.9090308@stjohnspoint.co.uk>
Message-ID: <rmimwp9l6gc.fsf@fnord.ir.bbn.com>


Paul Kelly <paul-grass at stjohnspoint.co.uk> writes:

> What's to say a gridshift file might not also be user-supplied? What do 
> you do then if you want to use a grid file you've created yourself (e.g. 
> as I did a few years ago: 
> <http://www.stjohnspoint.co.uk/gis/france.htm>), or got from an external 
> source, and don't have root access to install it in the "single correct 
> place"?

Well, if you don't have root, you can build and install proj in your own
directory with a coherent prefix, and you'll have to do that anyway for
various things you want that the system doesn't have..  And proj lets
you set a search path or environment variable.  That's easier than
configuring the faux VFS layer.  So I don't see how this mechanism is
needed or even useful for the use case you describe.

> Or what if you're running PROJ.4 on some obscure embedded system that 
> doesn't have the concept of a conventional filesystem and you need to 
> access the gridshift data over a network connection, or even embed it in 
> the binary?

Probably such systems have some sort of in-ram pseudofileystem, because
the issue of needing to read files is hardly unique to proj.  (The
notion of an embedded system with an os without a filesystem that is
then going to load grid-shift files over the net sounds highly contrived
to me.)  If someone actually has an issue like that, it would be
interesting to hear from them.  But if feels like post hoc positing of
odd situations.

> The solution Frank has implemented looks to me flexible enough to handle 
> any such unusual situations, as long as you write the necessary 
> interface functions to make whatever way you've stored the gridshift 
> data appears to the PROJ.4 library as if its seeking around in a file. 
> Seems to me a lot more elegant than the old pj_set_finder() solution - 
> although for simple cases of the gridshift files being stored in a 
> non-standard directory that's obviously simpler to use.

What I don't like about it is that if feels like reinventing the VFS
layer in a program-specific way.   But I'm not involved enough in proj
to have my opinion count for much, so I'll be quiet now unless I have
something actually new to say
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/b33cd13e/attachment.sig>

From andre+joost at nurfuerspam.de  Fri Jul 26 07:53:01 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 26 Jul 2013 16:53:01 +0200
Subject: [Proj] So close -- Lat / Long to Pennsylvania State Plane North
	NAD27
In-Reply-To: <1374841368374-5068943.post@n6.nabble.com>
References: <1374774086619-5068774.post@n6.nabble.com>
	<1374841368374-5068943.post@n6.nabble.com>
Message-ID: <ksu2hl$jjo$1@ger.gmane.org>

Am 26.07.2013 14:22, schrieb jdawg:
> sorry...bumping this message to get it on the mailing list... :)
>
>

Unfortunately, your first message did not get to the mailing list, only
to nabble readers. For the record, I paste it below.

I did some tests with the following commands on GDAL 1.10.0:
@echo off

echo WGS84-NAD27 >out.txt
cs2cs +init=epsg:4326 +to +init=epsg:4267 WGS84.txt >>out.txt
echo WGS84-NAD27PAft>>out.txt
cs2cs +init=epsg:4326 +to +init=epsg:32028 WGS84.txt >>out.txt
echo NAD27-NAD27PAft>>out.txt
cs2cs +init=epsg:4267 +to +init=epsg:32028 WGS84.txt >>out.txt

with the follwoing input file WGS84.txt:
-75.921819 41.295735

and got those results:

WGS84-NAD27
75d55'19.837"W	41d17'44.355"N 0.000
WGS84-NAD27PAft
2502234.97	416637.87 0.00
NAD27-NAD27PAft
2502332.66	416669.38 0.00

So you get the first result if the input is regarded as WGS84 degrees, 
and the second if the input is regarded as NAD27 degrees (EPSG:4267).

HTH,
André Joost


Original message:

> This is my first time using Proj.4, and I'm struggling with
> converting Lat/Lon in decimal degrees to Pennsylvania State Plane
> North NAD27. I'm very unfamiliar with coordinate system terminology.
> Here's what I'm expecting based on what our mapping system tells me
> are the coordinates between the two systems:
>
> -75.921819, 41.295735
>
> should return
>
> 2502235.76228      416637.89162
>
> when I convert it using cs2cs. (I'm expecting these values because
> when I use ArcMap to convert the coordinate system using the
> transformation called "NAD_1927_To_WGS_1984_79_CONUS", I get those
> values.) But what I'm getting from cs2cs is:
>
> 2502332.66      416669.38
>
> This is the command line syntax I'm using, along with the output:
>
> C:\proj\bin>cs2cs -v +proj=latlong +datum=NAD27 +ellps=clrk66
> +nadgrids=conus,nt v1_can.dat +to +init=epsg:32028 # ---- From
> Coordinate System ---- #Lat/long (Geodetic) # # +proj=latlong
> +datum=NAD27 +ellps=clrk66 +nadgrids=conus,ntv1_can.dat #---
> following specified but NOT used # +ellps=clrk66
> +nadgrids=conus,ntv1_can.dat # ---- To Coordinate System ----
> #Lambert Conformal Conic #       Conic, Sph&Ell #       lat_1= and
> lat_2= or lat_0 # +init=epsg:32028 +proj=lcc +lat_1=40.88333333333333
> +lat_2=41.95 # +lat_0=40.16666666666666 +lon_0=-77.75
> +x_0=609601.2192024384 +y_0=0 # +ellps=clrk66 +datum=NAD27
> +to_meter=0.3048006096012192 +no_defs # +nadgrids=conus,ntv1_can.dat
> #--- following specified but NOT used # +ellps=clrk66 -75.921819
> 41.295735 2502332.66      416669.38 0.000
>
>
> The values are so close, but not close enough, and I can't figure out
> where the discrepancy is! Can any of you gurus advise me in this
> matter?? Thanks very much!!
>
> Jeremy





From warmerdam at pobox.com  Fri Jul 26 09:15:23 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 26 Jul 2013 09:15:23 -0700
Subject: [Proj] Virtual File Access
In-Reply-To: <rmi8v0to4rj.fsf@fnord.ir.bbn.com>
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
	<CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
	<rmi8v0to4rj.fsf@fnord.ir.bbn.com>
Message-ID: <CA+YzLBdVVSrwR84dJJ6ja9Trh-QpmcyaXFq+B-4RQ8aJ=h7ePQ@mail.gmail.com>

On Fri, Jul 26, 2013 at 6:00 AM, Greg Troxel <gdt at ir.bbn.com> wrote:

>
> Frank Warmerdam <warmerdam at pobox.com> writes:
>
> Perhaps I am totally misunderstanding what you are doing.   Is this
> about letting IO done on behalf of a user to read and write the user's
> data (not grid shift files, which are part of the library) to come from
> different places?  Or is it about grid shift files, but the goal is
> because the user has them in RAM rather than on the filesystem?   I had
> the impression that this was about a way to bundle the standard grid
> shift/etc. files into the library so that one could have just a single
> library file and not the ancilliary files, because managing mulitple
> files was somehow too hard.
>

Greg,

It is about the grid shift and init files, not user input.  PROJ.4 the
library doesn't accept user input directly.



> > Quite possibly there are many things broken about the environment I work
> > in, but running things on windows is certainly not one of them.
>
> I'm glad to hear that :-).
>
> So what motivates you to add this code, rather than just installing the
> files in the right place?  What is the essence of the problem?
>

The details involve aspects of security and methodology that I am
discouraged from discussing in public without explicit permission by my
employer.

Suffice it to say that there are other contexts in which deployments of
PROJ.4 would have been significantly easier and problem free if I could
just have the data files delivered directly in the .so file, and no need
for special installation rules, etc.

> But the point I'd like to stress is that I believe it is generally a good
> practice for low level libraries to provide a way to hook IO so that
> applications can do a variety of things around file access.  Libraries
like
> libtiff, GDAL, shapelib and libpng have done this for a long time.  I'm
> extending it to PROJ.4.

 I find that notion unusual and surprising.  I was completely unaware of
> those libraries adding what feels like a custom VFS layer.  I looked at
>   http://www.libtiff.org/libtiff.html
> and found no mention of it.
>

If you look at the TIFFClientOpen() call, it includes mechanisms to pass in
what is essentially a virtual file access api.
 http://www.libtiff.org/man/TIFFOpen.3t.html

To some extent my introduction of similar capabilities into GDAL, Shapelib,
and now PROJ.4 mirrors what I saw in libtiff, libpng and libjpeg.


> > I'm not clear exactly what information you are looking for.  Normal
> > practice with applications installers using PROJ.4 would be to install
> the
> > files somewhere in the file system, and to call pj_set_searchpath()  to
> > look in the directory in which things were installed from their
> application
> > initialization.  The pj_set_searchpath() and pj_set_finder() were
> intended
> > to make finding the data files tractable in cases where applications
> didn't
> > mind writing them to disk.
>
> Where I'm coming from is that I install proj via pkgsrc (and am the
> package maintainer).  So it's "pkg_add proj-4.8.0.tar.gz" and then the
> library is in /usr/pkg/lib, and the files in /usr/pkg/share/proj (plus
> programs in /usr/pkg/bin, man pages...).  I expect it's the same for all
> other packaging systems, modulo prefix.  The path to the files is set
> via PROJ_LIB at build time to $(pkgdatadir).  So I view it as a bug to
> have to set search paths.  There is a single correct place for the grid
> files, and they are part of the package (or a depending package if one
> wants to split things).
>

As a packager installer files is no problem for you.  That's great. There
are other deployment scenarios.


> Also, I'd suggest that you consider putting this facility on a branch
> instead of in a release until there's both a useful extension
> (presumably reading files that were crunched into the library) and
> broader consensus that it's a good addition (on the benefit/complexity
> tradeoff).
>
>
I don't recall a concern from anyone else.  If you feel this is a serious
issue you could request I write this up as an RFC and put it to a vote on
the metacrs project steering committee.  I'm a bit surprised at the concern
since in normal situations the introduction of this file indirection won't
affect PROJ.4 library users.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/50b47c29/attachment.html>

From gdt at ir.bbn.com  Fri Jul 26 09:43:24 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Fri, 26 Jul 2013 12:43:24 -0400
Subject: [Proj] Virtual File Access
In-Reply-To: <CA+YzLBdVVSrwR84dJJ6ja9Trh-QpmcyaXFq+B-4RQ8aJ=h7ePQ@mail.gmail.com>
	(Frank Warmerdam's message of "Fri, 26 Jul 2013 09:15:23 -0700")
References: <CA+YzLBf7OtLdbgKmkqO7KR+NStUpR_8V+n=pQvBpY6zFsrvw+A@mail.gmail.com>
	<rmiy58unqjo.fsf@fnord.ir.bbn.com>
	<CA+YzLBehoQomZaOAevQyLTAuVwyMkiak0oXJPV6jGY-KJ6rCoQ@mail.gmail.com>
	<rmi8v0to4rj.fsf@fnord.ir.bbn.com>
	<CA+YzLBdVVSrwR84dJJ6ja9Trh-QpmcyaXFq+B-4RQ8aJ=h7ePQ@mail.gmail.com>
Message-ID: <rmi8v0tjmqb.fsf@fnord.ir.bbn.com>


Frank Warmerdam <warmerdam at pobox.com> writes:

> Suffice it to say that there are other contexts in which deployments of
> PROJ.4 would have been significantly easier and problem free if I could
> just have the data files delivered directly in the .so file, and no need
> for special installation rules, etc.

I can see that.

> If you look at the TIFFClientOpen() call, it includes mechanisms to pass in
> what is essentially a virtual file access api.
>  http://www.libtiff.org/man/TIFFOpen.3t.html

I see - I had not realized that.

> To some extent my introduction of similar capabilities into GDAL, Shapelib,
> and now PROJ.4 mirrors what I saw in libtiff, libpng and libjpeg.

But that's about user data coming from/going to places other than files,
vs. loading issues for things like grid shift.

> I don't recall a concern from anyone else.  If you feel this is a serious
> issue you could request I write this up as an RFC and put it to a vote on
> the metacrs project steering committee.  I'm a bit surprised at the concern
> since in normal situations the introduction of this file indirection won't
> affect PROJ.4 library users.

No, it's certainly not serious enough for me to try to drag this through
a PSC.  My concern is simply an achitectural cleanliness objection, in
that extra mechanisms that arne't necessary are just extra complexity
and sources of potential bugs.  If I'm the only one who has a concern,
you should discount my opinion.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/42bb4466/attachment.sig>

From jeremy.boecker at gmail.com  Fri Jul 26 11:50:02 2013
From: jeremy.boecker at gmail.com (Jeremy Boecker)
Date: Fri, 26 Jul 2013 14:50:02 -0400
Subject: [Proj] So close -- Lat / Long to Pennsylvania State Plane North
	NAD27
In-Reply-To: <ksu2hl$jjo$1@ger.gmane.org>
References: <1374774086619-5068774.post@n6.nabble.com>
	<1374841368374-5068943.post@n6.nabble.com>
	<ksu2hl$jjo$1@ger.gmane.org>
Message-ID: <CAAqeVVDB0jzqMkb13gHZ4reWPHPOLu80+ai6NZu=YNyY8pWiYw@mail.gmail.com>

Thank you, I tried what you said, and what I'm getting as output is as
follows when I run the same batch file:

WGS84-NAD27
*       * 0.000
WGS84-NAD27PAft
*       * 0.000
NAD27-NAD27PAft
2502332.66      416669.38 0.000

I'm thinking my EPSG definitions might be messed up somehow... but I also
tried copying from spatialreference.org, and still I get the same output.
(It seems like the 4326 EPSG is not working... )  Any further ideas? Your
second result is the correct and expected conversion result... not sure why
I'm getting asterisks and zeros for the same command! :/ Thanks again for
your help!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130726/e0a420f4/attachment.html>

From Mikael.Rittri at carmenta.com  Sun Jul 28 15:03:55 2013
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Sun, 28 Jul 2013 22:03:55 +0000
Subject: [Proj] So close -- Lat / Long to Pennsylvania State Plane
	North	NAD27
In-Reply-To: <CAAqeVVDB0jzqMkb13gHZ4reWPHPOLu80+ai6NZu=YNyY8pWiYw@mail.gmail.com>
References: <1374774086619-5068774.post@n6.nabble.com>
	<1374841368374-5068943.post@n6.nabble.com>
	<ksu2hl$jjo$1@ger.gmane.org>,
	<CAAqeVVDB0jzqMkb13gHZ4reWPHPOLu80+ai6NZu=YNyY8pWiYw@mail.gmail.com>
Message-ID: <8B19D265-FE59-418F-AD66-15DE784F1B76@carmenta.com>

I think you don't have the grid shift files that are required for
the Proj.4 default datum shift between NAD27 and WGS84.
The files are called alaska and conus, and NTv2.gsb for
Canada, and should be in the "nad" directory I think.
The US files can require an extra manual command to
generate, if you build Proj.4 yourself.

You can read more about this on the Proj.4 FAQ.

Best regards,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

26 jul 2013 kl. 20:50 skrev "Jeremy Boecker" <jeremy.boecker at gmail.com<mailto:jeremy.boecker at gmail.com>>:

Thank you, I tried what you said, and what I'm getting as output is as follows when I run the same batch file:

WGS84-NAD27
*       * 0.000
WGS84-NAD27PAft
*       * 0.000
NAD27-NAD27PAft
2502332.66      416669.38 0.000

I'm thinking my EPSG definitions might be messed up somehow... but I also tried copying from <http://spatialreference.org> spatialreference.org<http://spatialreference.org>, and still I get the same output. (It seems like the 4326 EPSG is not working... )  Any further ideas? Your second result is the correct and expected conversion result... not sure why I'm getting asterisks and zeros for the same command! :/ Thanks again for your help!!
_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130728/c09fac82/attachment.html>

From baas at speerit.nl  Tue Jul 30 01:49:35 2013
From: baas at speerit.nl (Jelmer Baas)
Date: Tue, 30 Jul 2013 08:49:35 +0000
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
Message-ID: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>

Hello,



For a new project we need to convert coordinates from EPSG 28992 to EPSG 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a custom DLL, Proj4js). The problem we are having is that we're seeing some shifted coordinates.



First test point (in the Netherlands)

Origin               135745.924           517131.216

Proj4js              236345.39474983042   5839505.550959114

Postgis(1)           236345.390264227     5839505.55017783

Postgis(2)           236345.394817119     5839505.55055913

MapInfo              236345.47            5839504.058

CS2CSN               236345.39            5839505.55

DLL old(4)            236345.396465174     5839505.54496813

DLL new(3)           236345.390259674     5839505.55009311

Oracle               236345.49107424      5839504.12246656



Test point (in Germany)

Origin              254870.45            415123.56

MapInfo             350265.960           5731670.259

Postgis(1)          350263.4072329       5731667.880

Postgis(2)           350263.4132521       5731667.880

DLL new(3)           350263.407243136     5731667.88019826

DLL old(4)           350263.403514925     5731667.88565864

Oracle(5)           350265.967728329     5731670.33312477

CS2CS                350263.41            5731667.88 43.92     cs2cs +init=EPSG:28992 +to +init=EPSG:3044



It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based products. I don't know which are "right", meaning I also don't know which ones are wrong - let alone find the fault.



Hopefully someone can help me with this problem, or at least point me in the right direction.



(1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs "

(2) Another server where I updated the spatial_ref_system: "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs no_defs"

(3) A custom built DLL for usage in VB6. "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs <>"

(4) Same DLL. "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs  <>"

(5) select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)', 90112),25832)  from dual;

(5b) The Oracle definition contains some  tags I don't see anywhere in Proj.4 (like the Bessel 1841 part):

PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", DATUM ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 299.1528128]], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree", 0.01745329251994330]], PROJECTION ["Stereographic"], PARAMETER ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 5.387639], PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER ["False_Easting", 155000.000000], PARAMETER ["False_Northing", 463000.000000], UNIT ["Meter", 1.000000000000]]



A side note is that transformation via my DLL doesn't work properly (i.e., coordinates are shifted tens of meters), unless I *first* transform to WGS84 and then to 3044. I assume this is caused by an easy-to-fix error, but I don't know what that is.



P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.



Thanks for any help,



With kind regards,

Jelmer Baas


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/18ddf15c/attachment.html>

From j.l.h.hartmann at uva.nl  Tue Jul 30 02:09:26 2013
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Tue, 30 Jul 2013 11:09:26 +0200
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
Message-ID: <51F782C6.1090708@uva.nl>

Hi Jelmer,

The correct parameters for the grid shift from epsg:28992 to  WGS84 are 
described here:

http://trac.osgeo.org/geotiff/ticket/22#comment:3

There are several different formulas in the EPSG database, but the most 
recent one is your number 1 (= 4). It has been put in the PROJ4-database 
by Frank Warmerdam, as you can read in the posting above. Numbers 2 and 
3 are older definitions, although they deliver about the same results.  
They should be discarded, but will probably hang around yet for a long 
time in older software.

Groeten,

Jan

On 30-7-2013 10:49, Jelmer Baas wrote:
>
> Hello,
>
> For a new project we need to convert coordinates from EPSG 28992 to 
> EPSG 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a 
> custom DLL, Proj4js). The problem we are having is that we're seeing 
> some shifted coordinates.
>
> First test point (in the Netherlands)
>
> Origin               135745.924           517131.216
>
> Proj4js              236345.39474983042   5839505.550959114
>
> Postgis(1)           236345.390264227     5839505.55017783
>
> Postgis(2)           236345.394817119     5839505.55055913
>
> MapInfo              236345.47            5839504.058
>
> CS2CSN               236345.39            5839505.55
>
> DLL old(4)            236345.396465174     5839505.54496813
>
> DLL new(3)           236345.390259674     5839505.55009311
>
> Oracle               236345.49107424      5839504.12246656
>
> Test point (in Germany)
>
> Origin              254870.45            415123.56
>
> MapInfo             350265.960           5731670.259
>
> Postgis(1)          350263.4072329       5731667.880
>
> Postgis(2)           350263.4132521       5731667.880
>
> DLL new(3)           350263.407243136     5731667.88019826
>
> DLL old(4)           350263.403514925     5731667.88565864
>
> Oracle(5)           350265.967728329     5731670.33312477
>
> CS2CS                350263.41            5731667.88 43.92     cs2cs 
> +init=EPSG:28992 +to +init=EPSG:3044
>
> It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based 
> products. I don't know which are "right", meaning I also don't know 
> which ones are wrong -- let alone find the fault.
>
> Hopefully someone can help me with this problem, or at least point me 
> in the right direction.
>
> (1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs "
>
> (2) Another server where I updated the spatial_ref_system: 
> "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 
> +no_defs no_defs"
>
> (3) A custom built DLL for usage in VB6. "+proj=sterea 
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 
> +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 
> +no_defs <>"
>
> (4) Same DLL. "+proj=sterea +lat_0=52.15616055555555 
> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 
> +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs <>"
>
> (5)select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)', 
> 90112),25832)  from dual;
>
> (5b) The Oracle definition contains some  tags I don't see anywhere in 
> Proj.4 (like the Bessel 1841 part):
>
> PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", 
> DATUM ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 
> 299.1528128]], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal 
> Degree", 0.01745329251994330]], PROJECTION ["Stereographic"], 
> PARAMETER ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 
> 5.387639], PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER 
> ["False_Easting", 155000.000000], PARAMETER ["False_Northing", 
> 463000.000000], UNIT ["Meter", 1.000000000000]]
>
> A side note is that transformation via my DLL doesn't work properly 
> (i.e., coordinates are shifted tens of meters), unless I **first** 
> transform to WGS84 and then to 3044. I assume this is caused by an 
> easy-to-fix error, but I don't know what that is.
>
> P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.
>
> Thanks for any help,
>
> With kind regards,
>
> Jelmer Baas
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/8edf42dd/attachment.html>

From milovanderlinden at gmail.com  Tue Jul 30 02:57:28 2013
From: milovanderlinden at gmail.com (Milo van der Linden (gmail))
Date: Tue, 30 Jul 2013 11:57:28 +0200
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
Message-ID: <CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>

Hello Jelmer,

1. I would strongly advice to transform everything to wgs84 first.
2. wgs84 and etrs89 are based upon different spheroids/datums. Transforming
from wgs84 TO etrs89 will not be correct if your etrs89 definition does not
have +towgs84 defined. And by default I believe it isn't. Take a look at
this ticket: http://trac.osgeo.org/proj/ticket/15 and see if it is of any
help.

So, what I would do is:

epsg:28992 -> wgs84 (visual check) -> etrs89

Good luck!




2013/7/30 Jelmer Baas <baas at speerit.nl>

>  Hello,****
>
> ** **
>
> For a new project we need to convert coordinates from EPSG 28992 to EPSG
> 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a custom DLL,
> Proj4js). The problem we are having is that we're seeing some shifted
> coordinates.****
>
> ** **
>
> First test point (in the Netherlands)****
>
> Origin               135745.924           517131.216****
>
> Proj4js              236345.39474983042   5839505.550959114****
>
> Postgis(1)           236345.390264227     5839505.55017783****
>
> Postgis(2)           236345.394817119     5839505.55055913****
>
> MapInfo              236345.47            5839504.058****
>
> CS2CSN               236345.39            5839505.55****
>
> DLL old(4)            236345.396465174     5839505.54496813****
>
> DLL new(3)           236345.390259674     5839505.55009311****
>
> Oracle               236345.49107424      5839504.12246656****
>
> ** **
>
> Test point (in Germany)****
>
> Origin              254870.45            415123.56****
>
> MapInfo             350265.960           5731670.259****
>
> Postgis(1)          350263.4072329       5731667.880                ****
>
> Postgis(2)           350263.4132521       5731667.880                ****
>
> DLL new(3)           350263.407243136     5731667.88019826 ****
>
> DLL old(4)           350263.403514925     5731667.88565864 ****
>
> Oracle(5)           350265.967728329     5731670.33312477     ****
>
> CS2CS                350263.41            5731667.88 43.92     cs2cs
> +init=EPSG:28992 +to +init=EPSG:3044****
>
> ** **
>
> It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based
> products. I don’t know which are “right”, meaning I also don’t know which
> ones are wrong – let alone find the fault. ****
>
> ** **
>
> Hopefully someone can help me with this problem, or at least point me in
> the right direction.****
>
> ** **
>
> (1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m
> +no_defs "****
>
> (2) Another server where I updated the spatial_ref_system: "+proj=sterea
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000
> +y_0=463000 +ellps=bessel +units=m
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
> +no_defs no_defs"****
>
> (3) A custom built DLL for usage in VB6. "+proj=sterea
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000
> +y_0=463000 +ellps=bessel +units=m
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
> +no_defs <>"****
>
> (4) Same DLL. “+proj=sterea +lat_0=52.15616055555555
> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m
> +no_defs  <>”****
>
> (5) select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)',
> 90112),25832)  from dual;****
>
> (5b) The Oracle definition contains some  tags I don’t see anywhere in
> Proj.4 (like the Bessel 1841 part):  ****
>
> PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", DATUM
> ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 299.1528128]],
> PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
> 0.01745329251994330]], PROJECTION ["Stereographic"], PARAMETER
> ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 5.387639],
> PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER ["False_Easting",
> 155000.000000], PARAMETER ["False_Northing", 463000.000000], UNIT ["Meter",
> 1.000000000000]] ****
>
> ** **
>
> A side note is that transformation via my DLL doesn’t work properly (i.e.,
> coordinates are shifted tens of meters), unless I **first** transform to
> WGS84 and then to 3044. I assume this is caused by an easy-to-fix error,
> but I don’t know what that is.****
>
> ** **
>
> P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.****
>
> ** **
>
> Thanks for any help,****
>
> ** **
>
> With kind regards,****
>
> Jelmer Baas****
>
> ** **
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/0b4c008b/attachment.html>

From j.l.h.hartmann at uva.nl  Tue Jul 30 03:20:31 2013
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Tue, 30 Jul 2013 12:20:31 +0200
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
	<CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>
Message-ID: <51F7936F.6050309@uva.nl>

I don't think that that is the problem here. The differences are only a 
few centimeters, while errsors resulting from missing +towgs84 
parameters are in the order of 100 meters.

Jan

On 30-7-2013 11:57, Milo van der Linden (gmail) wrote:
> Hello Jelmer,
>
> 1. I would strongly advice to transform everything to wgs84 first.
> 2. wgs84 and etrs89 are based upon different spheroids/datums. 
> Transforming from wgs84 TO etrs89 will not be correct if your etrs89 
> definition does not have +towgs84 defined. And by default I believe it 
> isn't. Take a look at this ticket: 
> http://trac.osgeo.org/proj/ticket/15 and see if it is of any help.
>
> So, what I would do is:
>
> epsg:28992 -> wgs84 (visual check) -> etrs89
>
> Good luck!
>
>
>
>
> 2013/7/30 Jelmer Baas <baas at speerit.nl <mailto:baas at speerit.nl>>
>
>     Hello,
>
>     For a new project we need to convert coordinates from EPSG 28992
>     to EPSG 3044 with MapInfo, Oracle AND a few Proj.4 programs
>     (PostGIS, a custom DLL, Proj4js). The problem we are having is
>     that we're seeing some shifted coordinates.
>
>     First test point (in the Netherlands)
>
>     Origin               135745.924           517131.216
>
>     Proj4js              236345.39474983042   5839505.550959114
>
>     Postgis(1)           236345.390264227     5839505.55017783
>
>     Postgis(2)           236345.394817119     5839505.55055913
>
>     MapInfo              236345.47            5839504.058
>
>     CS2CSN               236345.39            5839505.55
>
>     DLL old(4)            236345.396465174     5839505.54496813
>
>     DLL new(3)           236345.390259674     5839505.55009311
>
>     Oracle               236345.49107424      5839504.12246656
>
>     Test point (in Germany)
>
>     Origin              254870.45            415123.56
>
>     MapInfo             350265.960           5731670.259
>
>     Postgis(1)          350263.4072329       5731667.880
>
>     Postgis(2)           350263.4132521       5731667.880
>
>     DLL new(3)           350263.407243136     5731667.88019826
>
>     DLL old(4)           350263.403514925     5731667.88565864
>
>     Oracle(5)           350265.967728329     5731670.33312477
>
>     CS2CS                350263.41            5731667.88 43.92    
>     cs2cs +init=EPSG:28992 +to +init=EPSG:3044
>
>     It seems MapInfo and Oracle more-or-less agree, as do all
>     Proj.4-based products. I don’t know which are “right”, meaning I
>     also don’t know which ones are wrong – let alone find the fault.
>
>     Hopefully someone can help me with this problem, or at least point
>     me in the right direction.
>
>     (1): "+proj=sterea +lat_0=52.15616055555555
>     +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>     +ellps=bessel
>     +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725
>     +units=m +no_defs "
>
>     (2) Another server where I updated the spatial_ref_system:
>     "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
>     +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m
>     +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
>     +no_defs no_defs"
>
>     (3) A custom built DLL for usage in VB6. "+proj=sterea
>     +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908
>     +x_0=155000 +y_0=463000 +ellps=bessel +units=m
>     +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
>     +no_defs <>"
>
>     (4) Same DLL. “+proj=sterea +lat_0=52.15616055555555
>     +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000
>     +ellps=bessel
>     +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725
>     +units=m +no_defs <>”
>
>     (5)select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45
>     415123.56)', 90112),25832)  from dual;
>
>     (5b) The Oracle definition contains some  tags I don’t see
>     anywhere in Proj.4 (like the Bessel 1841 part):
>
>     PROJCS["Netherlands National System", GEOGCS [ "Netherlands
>     Bessel", DATUM ["Netherlands Bessel", SPHEROID ["Bessel 1841",
>     6377397.155, 299.1528128]], PRIMEM [ "Greenwich", 0.000000 ], UNIT
>     ["Decimal Degree", 0.01745329251994330]], PROJECTION
>     ["Stereographic"], PARAMETER ["Scale_Factor", 0.999908], PARAMETER
>     ["Central_Meridian", 5.387639], PARAMETER ["Latitude_Of_Origin",
>     52.156161], PARAMETER ["False_Easting", 155000.000000], PARAMETER
>     ["False_Northing", 463000.000000], UNIT ["Meter", 1.000000000000]]
>
>     A side note is that transformation via my DLL doesn’t work
>     properly (i.e., coordinates are shifted tens of meters), unless I
>     **first** transform to WGS84 and then to 3044. I assume this is
>     caused by an easy-to-fix error, but I don’t know what that is.
>
>     P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.
>
>     Thanks for any help,
>
>     With kind regards,
>
>     Jelmer Baas
>
>
>     _______________________________________________
>     Proj mailing list
>     Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
>     http://lists.maptools.org/mailman/listinfo/proj
>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/025e6d7a/attachment.html>

From baas at speerit.nl  Tue Jul 30 03:27:38 2013
From: baas at speerit.nl (Jelmer Baas)
Date: Tue, 30 Jul 2013 10:27:38 +0000
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
	<CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>
Message-ID: <BC9747AD8551184D9B674A8310FE337B0C99E611@mailserver>

Milo, Jan,

Thanks for the suggestions so far. I tried to rule out the NL->DE step by first going to WGS84.

Even this transformation doesn’t go the same as Oracle/MapInfo:
Point        135745.924    517131.216
Oracle  5.10275163084204   52.6413240233221
MapInfo 5.102751           52.641323
PostGis 5.10274900325229   52.6413367842089
PostGi2 5.10274907007772   52.6413367898401
DLL 4   5.10274904569186   52.6413366577093
DLL 3   5.102749003361     52.6413367848006
DLL 2   5.10274903201512   52.6413367357724
DLL 1   5.10274900325279   52.6413367843563
DLL ORG 5.10274909884125   52.6413367414033

I tried these projection strings:
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs  <>
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs  no_defs <>
+proj=sterea +lat_0=52.156160556      +lon_0=5.387638889 +k=0.9999079 +x_0=155000 +y_0=463000 +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +ellps=bessel +units=m +no_defs  no_defs <>
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel  +units=m +towgs84=565.04,49.91,465.84,-0.409394387439237,0.359705195614311,-1.86849100035057,4.0772 +no_defs +to +proj=latlong +datum=WGS84
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs <>
+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.04,49.91,465.84,-1.9848,1.7439,-9.0587,4.0772 +units=m +no_defs

Met vriendelijke groet,
Jelmer Baas
Speer IT B.V.

From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Milo van der Linden (gmail)
Sent: Tuesday, July 30, 2013 11:57
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces shifted coordinates

Hello Jelmer,
1. I would strongly advice to transform everything to wgs84 first.
2. wgs84 and etrs89 are based upon different spheroids/datums. Transforming from wgs84 TO etrs89 will not be correct if your etrs89 definition does not have +towgs84 defined. And by default I believe it isn't. Take a look at this ticket: http://trac.osgeo.org/proj/ticket/15 and see if it is of any help.

So, what I would do is:
epsg:28992 -> wgs84 (visual check) -> etrs89
Good luck!


2013/7/30 Jelmer Baas <baas at speerit.nl<mailto:baas at speerit.nl>>

Hello,



For a new project we need to convert coordinates from EPSG 28992 to EPSG 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a custom DLL, Proj4js). The problem we are having is that we're seeing some shifted coordinates.



First test point (in the Netherlands)

Origin               135745.924           517131.216

Proj4js              236345.39474983042   5839505.550959114

Postgis(1)           236345.390264227     5839505.55017783

Postgis(2)           236345.394817119     5839505.55055913

MapInfo              236345.47            5839504.058

CS2CSN               236345.39            5839505.55

DLL old(4)            236345.396465174     5839505.54496813

DLL new(3)           236345.390259674     5839505.55009311

Oracle               236345.49107424      5839504.12246656



Test point (in Germany)

Origin              254870.45            415123.56

MapInfo             350265.960           5731670.259

Postgis(1)          350263.4072329       5731667.880

Postgis(2)           350263.4132521       5731667.880

DLL new(3)           350263.407243136     5731667.88019826

DLL old(4)           350263.403514925     5731667.88565864

Oracle(5)           350265.967728329     5731670.33312477

CS2CS                350263.41            5731667.88 43.92     cs2cs +init=EPSG:28992 +to +init=EPSG:3044



It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based products. I don’t know which are “right”, meaning I also don’t know which ones are wrong – let alone find the fault.



Hopefully someone can help me with this problem, or at least point me in the right direction.



(1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs "

(2) Another server where I updated the spatial_ref_system: "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs no_defs"

(3) A custom built DLL for usage in VB6. "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 +no_defs <>"

(4) Same DLL. “+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs  <>”

(5) select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)', 90112),25832)  from dual;

(5b) The Oracle definition contains some  tags I don’t see anywhere in Proj.4 (like the Bessel 1841 part):

PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", DATUM ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 299.1528128]], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree", 0.01745329251994330]], PROJECTION ["Stereographic"], PARAMETER ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 5.387639], PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER ["False_Easting", 155000.000000], PARAMETER ["False_Northing", 463000.000000], UNIT ["Meter", 1.000000000000]]



A side note is that transformation via my DLL doesn’t work properly (i.e., coordinates are shifted tens of meters), unless I *first* transform to WGS84 and then to 3044. I assume this is caused by an easy-to-fix error, but I don’t know what that is.



P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.



Thanks for any help,



With kind regards,

Jelmer Baas



_______________________________________________
Proj mailing list
Proj at lists.maptools.org<mailto:Proj at lists.maptools.org>
http://lists.maptools.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/148ee05c/attachment.html>

From jagoncal at gmail.com  Tue Jul 30 03:53:10 2013
From: jagoncal at gmail.com (=?ISO-8859-1?Q?Jose_Gon=E7alves?=)
Date: Tue, 30 Jul 2013 11:53:10 +0100
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>
Message-ID: <CALHLaOT9X9Ndy_Ou=ix8fdTC1U-AibW6sW8xktbwMMUha6Rw6g@mail.gmail.com>

Hello

There are a few possible reasons for the differences you find. In the
Oracle definition:

PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", DATUM
["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 299.1528128]],
PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
0.01745329251994330]], PROJECTION ["Stereographic"], PARAMETER
["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 5.387639],
PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER ["False_Easting",
155000.000000], PARAMETER ["False_Northing", 463000.000000], UNIT ["Meter",
1.000000000000]]

you have the central point (5.387639 E, 52.156161 N) rounded with 6 decimal
places. The sixth decimal place is 11 cm in latitude, so it may justify
differences of that order. The ellipsoid definition is correct, so it is no
reason for differences.
The projection you are using in PROJ.4 is "Oblique Stereographic
Alternative" (+proj=sterea). PROJECTION ["Stereographic"] probably
corresponds to +proj=stere, which is different.

Another possible reason are the datum transformation parameters. Check if
the parameters used by Mapinfo and Oracle in the Bursa-Wolf transformation
are the same you are using with cs2cs. Different sets of parameters justify
differences of a few meters.

Regards

José Gonçalves





2013/7/30 Jelmer Baas <baas at speerit.nl>

>  Hello,****
>
> ** **
>
> For a new project we need to convert coordinates from EPSG 28992 to EPSG
> 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a custom DLL,
> Proj4js). The problem we are having is that we're seeing some shifted
> coordinates.****
>
> ** **
>
> First test point (in the Netherlands)****
>
> Origin               135745.924           517131.216****
>
> Proj4js              236345.39474983042   5839505.550959114****
>
> Postgis(1)           236345.390264227     5839505.55017783****
>
> Postgis(2)           236345.394817119     5839505.55055913****
>
> MapInfo              236345.47            5839504.058****
>
> CS2CSN               236345.39            5839505.55****
>
> DLL old(4)            236345.396465174     5839505.54496813****
>
> DLL new(3)           236345.390259674     5839505.55009311****
>
> Oracle               236345.49107424      5839504.12246656****
>
> ** **
>
> Test point (in Germany)****
>
> Origin              254870.45            415123.56****
>
> MapInfo             350265.960           5731670.259****
>
> Postgis(1)          350263.4072329       5731667.880                ****
>
> Postgis(2)           350263.4132521       5731667.880                ****
>
> DLL new(3)           350263.407243136     5731667.88019826 ****
>
> DLL old(4)           350263.403514925     5731667.88565864 ****
>
> Oracle(5)           350265.967728329     5731670.33312477     ****
>
> CS2CS                350263.41            5731667.88 43.92     cs2cs
> +init=EPSG:28992 +to +init=EPSG:3044****
>
> ** **
>
> It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based
> products. I don’t know which are “right”, meaning I also don’t know which
> ones are wrong – let alone find the fault. ****
>
> ** **
>
> Hopefully someone can help me with this problem, or at least point me in
> the right direction.****
>
> ** **
>
> (1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m
> +no_defs "****
>
> (2) Another server where I updated the spatial_ref_system: "+proj=sterea
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000
> +y_0=463000 +ellps=bessel +units=m
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
> +no_defs no_defs"****
>
> (3) A custom built DLL for usage in VB6. "+proj=sterea
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000
> +y_0=463000 +ellps=bessel +units=m
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812
> +no_defs <>"****
>
> (4) Same DLL. “+proj=sterea +lat_0=52.15616055555555
> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m
> +no_defs  <>”****
>
> (5) select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)',
> 90112),25832)  from dual;****
>
> (5b) The Oracle definition contains some  tags I don’t see anywhere in
> Proj.4 (like the Bessel 1841 part):  ****
>
> PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", DATUM
> ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 299.1528128]],
> PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
> 0.01745329251994330]], PROJECTION ["Stereographic"], PARAMETER
> ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 5.387639],
> PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER ["False_Easting",
> 155000.000000], PARAMETER ["False_Northing", 463000.000000], UNIT ["Meter",
> 1.000000000000]] ****
>
> ** **
>
> A side note is that transformation via my DLL doesn’t work properly (i.e.,
> coordinates are shifted tens of meters), unless I **first** transform to
> WGS84 and then to 3044. I assume this is caused by an easy-to-fix error,
> but I don’t know what that is.****
>
> ** **
>
> P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.****
>
> ** **
>
> Thanks for any help,****
>
> ** **
>
> With kind regards,****
>
> Jelmer Baas****
>
> ** **
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/7e9e7e73/attachment.html>

From j.l.h.hartmann at uva.nl  Tue Jul 30 03:58:20 2013
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Tue, 30 Jul 2013 12:58:20 +0200
Subject: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) produces
 shifted coordinates
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B0C99E611@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B0C99E10C@mailserver>	<CANqqynmWF0nBvnfAQofeWoeir+Ye_+WpySADvOGTLFfBrXLdeQ@mail.gmail.com>
	<BC9747AD8551184D9B674A8310FE337B0C99E611@mailserver>
Message-ID: <51F79C4C.9090800@uva.nl>

It could be that MapInfo/Oracle do not use the 7 parameter Helmert 
formula, as used by PROJ, but a grid shift file. The small size of the 
deviations make this very probable. Until recently there was no usable 
grid shift available for PROJ, but the Dutch Topographical Service is 
working on a grid shift file in gsb-format. Nothing has been made public 
as yet, but  I'll ask them and let you know.

By the way, this grid shift file works only within the Netherlands. It 
will give false results if you try to align coordinates in the 
Netherlands and Germany.

Jan

On 30-7-2013 12:27, Jelmer Baas wrote:
>
> Milo, Jan,
>
> Thanks for the suggestions so far. I tried to rule out the NL->DE step 
> by first going to WGS84.
>
> Even this transformation doesn’t go the same as Oracle/MapInfo:
>
> Point        135745.924    517131.216
>
> Oracle  5.10275163084204   52.6413240233221
>
> MapInfo 5.102751           52.641323
>
> PostGis 5.10274900325229   52.6413367842089
>
> PostGi2 5.10274907007772   52.6413367898401
>
> DLL 4   5.10274904569186   52.6413366577093
>
> DLL 3   5.102749003361     52.6413367848006
>
> DLL 2   5.10274903201512   52.6413367357724
>
> DLL 1   5.10274900325279   52.6413367843563
>
> DLL ORG 5.10274909884125   52.6413367414033
>
> I tried these projection strings:
>
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs <>
>
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs  no_defs <>
>
> +proj=sterea +lat_0=52.156160556      +lon_0=5.387638889 +k=0.9999079 
> +x_0=155000 +y_0=463000 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +ellps=bessel +units=m +no_defs  no_defs <>
>
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel  +units=m 
> +towgs84=565.04,49.91,465.84,-0.409394387439237,0.359705195614311,-1.86849100035057,4.0772 
> +no_defs +to +proj=latlong +datum=WGS84
>
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 
> +no_defs <>
>
> +proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.04,49.91,465.84,-1.9848,1.7439,-9.0587,4.0772 +units=m 
> +no_defs
>
> Met vriendelijke groet,
>
> Jelmer Baas
>
> Speer IT B.V.
>
> *From:*proj-bounces at lists.maptools.org 
> [mailto:proj-bounces at lists.maptools.org] *On Behalf Of *Milo van der 
> Linden (gmail)
> *Sent:* Tuesday, July 30, 2013 11:57
> *To:* PROJ.4 and general Projections Discussions
> *Subject:* Re: [Proj] Netherlands RD (28992) to UTM Zone 32 (3044) 
> produces shifted coordinates
>
> Hello Jelmer,
>
> 1. I would strongly advice to transform everything to wgs84 first.
>
> 2. wgs84 and etrs89 are based upon different spheroids/datums. 
> Transforming from wgs84 TO etrs89 will not be correct if your etrs89 
> definition does not have +towgs84 defined. And by default I believe it 
> isn't. Take a look at this ticket: 
> http://trac.osgeo.org/proj/ticket/15 and see if it is of any help.
>
> So, what I would do is:
>
> epsg:28992 -> wgs84 (visual check) -> etrs89
>
> Good luck!
>
> 2013/7/30 Jelmer Baas <baas at speerit.nl <mailto:baas at speerit.nl>>
>
> Hello,
>
> For a new project we need to convert coordinates from EPSG 28992 to 
> EPSG 3044 with MapInfo, Oracle AND a few Proj.4 programs (PostGIS, a 
> custom DLL, Proj4js). The problem we are having is that we're seeing 
> some shifted coordinates.
>
> First test point (in the Netherlands)
>
> Origin               135745.924           517131.216
>
> Proj4js              236345.39474983042   5839505.550959114
>
> Postgis(1)           236345.390264227     5839505.55017783
>
> Postgis(2)           236345.394817119     5839505.55055913
>
> MapInfo              236345.47            5839504.058
>
> CS2CSN               236345.39            5839505.55
>
> DLL old(4)            236345.396465174     5839505.54496813
>
> DLL new(3)           236345.390259674     5839505.55009311
>
> Oracle               236345.49107424      5839504.12246656
>
> Test point (in Germany)
>
> Origin              254870.45            415123.56
>
> MapInfo             350265.960           5731670.259
>
> Postgis(1)          350263.4072329       5731667.880
>
> Postgis(2)           350263.4132521       5731667.880
>
> DLL new(3)           350263.407243136     5731667.88019826
>
> DLL old(4)           350263.403514925     5731667.88565864
>
> Oracle(5)           350265.967728329     5731670.33312477
>
> CS2CS                350263.41            5731667.88 43.92     cs2cs 
> +init=EPSG:28992 +to +init=EPSG:3044
>
> It seems MapInfo and Oracle more-or-less agree, as do all Proj.4-based 
> products. I don’t know which are “right”, meaning I also don’t know 
> which ones are wrong – let alone find the fault.
>
> Hopefully someone can help me with this problem, or at least point me 
> in the right direction.
>
> (1): "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs "
>
> (2) Another server where I updated the spatial_ref_system: 
> "+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 
> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 
> +no_defs no_defs"
>
> (3) A custom built DLL for usage in VB6. "+proj=sterea 
> +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 
> +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
> +towgs84=565.2369,50.0087,465.658,-0.406857330322398,0.350732676542563,-1.8703473836068,4.0812 
> +no_defs <>"
>
> (4) Same DLL. “+proj=sterea +lat_0=52.15616055555555 
> +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 
> +ellps=bessel 
> +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 
> +units=m +no_defs <>”
>
> (5)select sdo_cs.transform(SDO_GEOMETRY('POINT(254870.45 415123.56)', 
> 90112),25832)  from dual;
>
> (5b) The Oracle definition contains some  tags I don’t see anywhere in 
> Proj.4 (like the Bessel 1841 part):
>
> PROJCS["Netherlands National System", GEOGCS [ "Netherlands Bessel", 
> DATUM ["Netherlands Bessel", SPHEROID ["Bessel 1841", 6377397.155, 
> 299.1528128]], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal 
> Degree", 0.01745329251994330]], PROJECTION ["Stereographic"], 
> PARAMETER ["Scale_Factor", 0.999908], PARAMETER ["Central_Meridian", 
> 5.387639], PARAMETER ["Latitude_Of_Origin", 52.156161], PARAMETER 
> ["False_Easting", 155000.000000], PARAMETER ["False_Northing", 
> 463000.000000], UNIT ["Meter", 1.000000000000]]
>
> A side note is that transformation via my DLL doesn’t work properly 
> (i.e., coordinates are shifted tens of meters), unless I **first** 
> transform to WGS84 and then to 3044. I assume this is caused by an 
> easy-to-fix error, but I don’t know what that is.
>
> P.S.: PostGIS, Proj4JS and my epsg file are all up-to-date.
>
> Thanks for any help,
>
> With kind regards,
>
> Jelmer Baas
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org <mailto:Proj at lists.maptools.org>
> http://lists.maptools.org/mailman/listinfo/proj
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20130730/ab3660f2/attachment.html>

