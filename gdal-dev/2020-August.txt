From andrew at aitchison.me.uk  Sat Aug  1 02:44:45 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 1 Aug 2020 10:44:45 +0100 (BST)
Subject: [gdal-dev] GetSpatialRef, OGRSpatialReference and memory leaks ?
Message-ID: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>


I would like to define GetSpatialRef() for my raster driver as something like:

     const OGRSpatialReference* GetSpatialRef() const override {
         OGRSpatialReference* poSRS = new OGRSpatialReference();
         if (poSRS->importFromEPSGA(27700)!=OGRERR_NONE)
         {
             delete poSRS;
             poSRS = nullptr;
         }
         return poSRS;
     }

Unfortunately, valgrid reports that this leaks in the "new"
on the line
    OGRSpatialReference* poSRS = new OGRSpatialReference();

On the other hand,

     const OGRSpatialReference* GetSpatialRef() const override {
         return new OGRSpatialReference("EPSG:27700");
     }

is no better:
==117785==
==117785== HEAP SUMMARY:
==117785==     in use at exit: 5,764 bytes in 24 blocks
==117785==   total heap usage: 7,363 allocs, 7,339 frees, 1,213,218 bytes allocated
==117785==
==117785== Searching for pointers to 24 not-freed blocks
==117785== Checked 3,635,216 bytes
==117785==
==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely lost in loss record 14 of 16
==117785==    at 0x483BE63: operator new(unsigned long) (vg_replace_malloc.c:344)
==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
==117785==    by 0x4ED723A: GDALInfo (gdalinfo_lib.cpp:333)
==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
==117785==
==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely lost in loss record 15 of 16
==117785==    at 0x483BE63: operator new(unsigned long) (vg_replace_malloc.c:344)
==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
==117785==    by 0x4ED9203: GDALInfo (gdalinfo_lib.cpp:578)
==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
==117785==
==117785== LEAK SUMMARY:
==117785==    definitely lost: 32 bytes in 2 blocks
==117785==    indirectly lost: 1,160 bytes in 10 blocks
==117785==      possibly lost: 0 bytes in 0 blocks
==117785==    still reachable: 4,572 bytes in 12 blocks
==117785==         suppressed: 0 bytes in 0 blocks

This is with both gdal 3.0.4 and 3.1.2 on Ubunto 20.04.

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From andrew.bell.ia at gmail.com  Sat Aug  1 03:18:18 2020
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Sat, 1 Aug 2020 06:18:18 -0400
Subject: [gdal-dev] GetSpatialRef, OGRSpatialReference and memory leaks ?
In-Reply-To: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
References: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
Message-ID: <CACJ51z2sH6xLTGGCVGh=1RiuwUtp_uD4zBXV9V+pWirLFs0Ynw@mail.gmail.com>

Seems like it would depend on what you're doing with the pointer after you
return it.

On Sat, Aug 1, 2020, 5:50 AM Andrew C Aitchison <andrew at aitchison.me.uk>
wrote:

>
> I would like to define GetSpatialRef() for my raster driver as something
> like:
>
>      const OGRSpatialReference* GetSpatialRef() const override {
>          OGRSpatialReference* poSRS = new OGRSpatialReference();
>          if (poSRS->importFromEPSGA(27700)!=OGRERR_NONE)
>          {
>              delete poSRS;
>              poSRS = nullptr;
>          }
>          return poSRS;
>      }
>
> Unfortunately, valgrid reports that this leaks in the "new"
> on the line
>     OGRSpatialReference* poSRS = new OGRSpatialReference();
>
> On the other hand,
>
>      const OGRSpatialReference* GetSpatialRef() const override {
>          return new OGRSpatialReference("EPSG:27700");
>      }
>
> is no better:
> ==117785==
> ==117785== HEAP SUMMARY:
> ==117785==     in use at exit: 5,764 bytes in 24 blocks
> ==117785==   total heap usage: 7,363 allocs, 7,339 frees, 1,213,218 bytes
> allocated
> ==117785==
> ==117785== Searching for pointers to 24 not-freed blocks
> ==117785== Checked 3,635,216 bytes
> ==117785==
> ==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely
> lost in loss record 14 of 16
> ==117785==    at 0x483BE63: operator new(unsigned long)
> (vg_replace_malloc.c:344)
> ==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
> ==117785==    by 0x4ED723A: GDALInfo (gdalinfo_lib.cpp:333)
> ==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
> ==117785==
> ==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely
> lost in loss record 15 of 16
> ==117785==    at 0x483BE63: operator new(unsigned long)
> (vg_replace_malloc.c:344)
> ==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
> ==117785==    by 0x4ED9203: GDALInfo (gdalinfo_lib.cpp:578)
> ==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
> ==117785==
> ==117785== LEAK SUMMARY:
> ==117785==    definitely lost: 32 bytes in 2 blocks
> ==117785==    indirectly lost: 1,160 bytes in 10 blocks
> ==117785==      possibly lost: 0 bytes in 0 blocks
> ==117785==    still reachable: 4,572 bytes in 12 blocks
> ==117785==         suppressed: 0 bytes in 0 blocks
>
> This is with both gdal 3.0.4 and 3.1.2 on Ubunto 20.04.
>
> --
> Andrew C. Aitchison                                     Kendal, UK
>                         andrew at aitchison.me.uk
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200801/f78a34c5/attachment.html>

From andrew at aitchison.me.uk  Sat Aug  1 04:53:27 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 1 Aug 2020 12:53:27 +0100 (BST)
Subject: [gdal-dev] GetSpatialRef, OGRSpatialReference and memory leaks ?
In-Reply-To: <CACJ51z2sH6xLTGGCVGh=1RiuwUtp_uD4zBXV9V+pWirLFs0Ynw@mail.gmail.com>
References: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
 <CACJ51z2sH6xLTGGCVGh=1RiuwUtp_uD4zBXV9V+pWirLFs0Ynw@mail.gmail.com>
Message-ID: <alpine.DEB.2.23.453.2008011208540.121556@warden.aitchison.me.uk>

On Sat, 1 Aug 2020, Andrew Bell wrote:

Thanks for the hint.
I had assumed that the caller was taking responsibility for it.

> Seems like it would depend on what you're doing with the pointer after you
> return it.
>
> On Sat, Aug 1, 2020, 5:50 AM Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
>
>>
>> I would like to define GetSpatialRef() for my raster driver as something
>> like:
>>
>>      const OGRSpatialReference* GetSpatialRef() const override {
>>          OGRSpatialReference* poSRS = new OGRSpatialReference();
>>          if (poSRS->importFromEPSGA(27700)!=OGRERR_NONE)
>>          {
>>              delete poSRS;
>>              poSRS = nullptr;
>>          }
>>          return poSRS;
>>      }
>>
>> Unfortunately, valgrid reports that this leaks in the "new"
>> on the line
>>     OGRSpatialReference* poSRS = new OGRSpatialReference();
>>
>> On the other hand,
>>
>>      const OGRSpatialReference* GetSpatialRef() const override {
>>          return new OGRSpatialReference("EPSG:27700");
>>      }
>>
>> is no better:
>> ==117785==
>> ==117785== HEAP SUMMARY:
>> ==117785==     in use at exit: 5,764 bytes in 24 blocks
>> ==117785==   total heap usage: 7,363 allocs, 7,339 frees, 1,213,218 bytes
>> allocated
>> ==117785==
>> ==117785== Searching for pointers to 24 not-freed blocks
>> ==117785== Checked 3,635,216 bytes
>> ==117785==
>> ==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely
>> lost in loss record 14 of 16
>> ==117785==    at 0x483BE63: operator new(unsigned long)
>> (vg_replace_malloc.c:344)
>> ==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
>> ==117785==    by 0x4ED723A: GDALInfo (gdalinfo_lib.cpp:333)
>> ==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
>> ==117785==
>> ==117785== 596 (16 direct, 580 indirect) bytes in 1 blocks are definitely
>> lost in loss record 15 of 16
>> ==117785==    at 0x483BE63: operator new(unsigned long)
>> (vg_replace_malloc.c:344)
>> ==117785==    by 0x5E1D765: VRCDataset::GetSpatialRef() const (VRC.h:154)
>> ==117785==    by 0x4ED9203: GDALInfo (gdalinfo_lib.cpp:578)
>> ==117785==    by 0x10954D: main (gdalinfo_bin.cpp:213)
>> ==117785==
>> ==117785== LEAK SUMMARY:
>> ==117785==    definitely lost: 32 bytes in 2 blocks
>> ==117785==    indirectly lost: 1,160 bytes in 10 blocks
>> ==117785==      possibly lost: 0 bytes in 0 blocks
>> ==117785==    still reachable: 4,572 bytes in 12 blocks
>> ==117785==         suppressed: 0 bytes in 0 blocks
>>
>> This is with both gdal 3.0.4 and 3.1.2 on Ubunto 20.04.
>>
>> --
>> Andrew C. Aitchison                                     Kendal, UK
>>                         andrew at aitchison.me.uk
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From rupestre.campos at gmail.com  Sat Aug  1 04:58:35 2020
From: rupestre.campos at gmail.com (=?UTF-8?Q?Cain=C3=A3_K=2E_Campos?=)
Date: Sat, 1 Aug 2020 08:58:35 -0300
Subject: [gdal-dev] Query regarding using gdalwarp with cutlineSQL
In-Reply-To: <1596231636200-0.post@n6.nabble.com>
References: <CAJaf+gHX2sxfThXWYoOkGJ_0n+G94mf=F8L56nQQuX8CYZRN9A@mail.gmail.com>
 <1596231636200-0.post@n6.nabble.com>
Message-ID: <CAAvXUUozVLYff17JQ4eRyt4OPRqJyzKENYTJGaR_NgJp7bHT-Q@mail.gmail.com>

I believe that you should use either the cutlineWhere or the cutlineSQL.

When I want a single field selection, I use the cutlineWhere,
when it is more complex I use the cutlineSQL

On Fri, Jul 31, 2020 at 6:40 PM Luke <lukepinnerau at gmail.com> wrote:

> You need  single quotes around your string literal:
>
> cutlineWhere="name = 'first'"
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200801/734fa302/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug  3 02:26:16 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 3 Aug 2020 09:26:16 +0000
Subject: [gdal-dev] Making MITAB to recognize Extented MapInfo TAB
Message-ID: <342d835db8b44d45bc7c129a2174f01e@C119S212VM042.msvyvi.vaha.local>

Hi,

Might be good if the MITAB driver could recognize if TAB file is of the new Extented TAB format and show a meaningful error for the users. It could save troubles similar to  this one in gis.stackexchange https://gis.stackexchange.com/questions/369014/mapinfo-tab-files-with-largeint-cant-be-converted-to-qgis-or-any-other-format. I hope the new format has some magic number that stores the version.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200803/7bb7a4e8/attachment.html>

From even.rouault at spatialys.com  Mon Aug  3 03:01:45 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 03 Aug 2020 12:01:45 +0200
Subject: [gdal-dev] GetSpatialRef, OGRSpatialReference and memory leaks ?
In-Reply-To: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
References: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
Message-ID: <2138004.x5M9IrOcKY@even-i700>

On samedi 1 août 2020 10:44:45 CEST Andrew C Aitchison wrote:
> I would like to define GetSpatialRef() for my raster driver as something
> like:
> 
>      const OGRSpatialReference* GetSpatialRef() const override {
>          OGRSpatialReference* poSRS = new OGRSpatialReference();
>          if (poSRS->importFromEPSGA(27700)!=OGRERR_NONE)
>          {
>              delete poSRS;
>              poSRS = nullptr;
>          }
>          return poSRS;
>      }
> 
> Unfortunately, valgrid reports that this leaks in the "new"
> on the line
>     OGRSpatialReference* poSRS = new OGRSpatialReference();
> 
> On the other hand,
> 
>      const OGRSpatialReference* GetSpatialRef() const override {
>          return new OGRSpatialReference("EPSG:27700");
>      }

Andrew,

You should hold a OGRSpatialReference object as a member variable of the dataset object 
and return its address. The ownership of the object remains to the dataset object as 
indicated in the doc:


/**
 * \brief Fetch the spatial reference for this dataset.
 *
 * Same as the C function GDALGetSpatialRef().
 *
 * When a projection definition is not available, null is returned
 *
 * @since GDAL 3.0
 *
 * @return a pointer to an internal object. It should not be altered or freed.
 * Its lifetime will be the one of the dataset object, or until the next
 * call to this method.
 *
 * @see http://www.gdal.org/osr_tutorial.html
 */


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200803/c150aad2/attachment.html>

From even.rouault at spatialys.com  Mon Aug  3 03:06:46 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 03 Aug 2020 12:06:46 +0200
Subject: [gdal-dev] Making MITAB to recognize Extented MapInfo TAB
In-Reply-To: <342d835db8b44d45bc7c129a2174f01e@C119S212VM042.msvyvi.vaha.local>
References: <342d835db8b44d45bc7c129a2174f01e@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2490396.arYcUze2eM@even-i700>

On lundi 3 août 2020 09:26:16 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Might be good if the MITAB driver could recognize if TAB file is of the new
> Extented TAB format and show a meaningful error for the users. It could
> save troubles similar to  this one in gis.stackexchange
> https://gis.stackexchange.com/questions/369014/mapinfo-tab-files-with-large
> int-cant-be-converted-to-qgis-or-any-other-format. I hope the new format has
> some magic number that stores the version.

From a comment in the thread, it looks it might be something that could be addressed 
by MITAB with some extra work. We'd need a reproducer dataset to confirm.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200803/386da717/attachment.html>

From andrew at aitchison.me.uk  Mon Aug  3 03:16:14 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 3 Aug 2020 11:16:14 +0100 (BST)
Subject: [gdal-dev] GetSpatialRef, OGRSpatialReference and memory leaks ?
In-Reply-To: <2138004.x5M9IrOcKY@even-i700>
References: <alpine.DEB.2.23.453.2008010949090.114049@warden.aitchison.me.uk>
 <2138004.x5M9IrOcKY@even-i700>
Message-ID: <alpine.DEB.2.23.453.2008031110540.236857@warden.aitchison.me.uk>

On Mon, 3 Aug 2020, Even Rouault wrote:

> Andrew,
>
> You should hold a OGRSpatialReference object as a member variable of the dataset object
> and return its address. The ownership of the object remains to the dataset object as
> indicated in the doc:

Thanks. I figured that from Andrew Bell's hint.

> /**
> * \brief Fetch the spatial reference for this dataset.
> *
> * Same as the C function GDALGetSpatialRef().
> *
> * When a projection definition is not available, null is returned
> *
> * @since GDAL 3.0
> *
> * @return a pointer to an internal object. It should not be altered or freed.
> * Its lifetime will be the one of the dataset object, or until the next
> * call to this method.
> *
> * @see http://www.gdal.org/osr_tutorial.html
> */

That page redirects (301 Moved Permanently) to
 	https://gdal.org/osr_tutorial.html
which gives
 	404 Not Found

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From jmckenna at gatewaygeomatics.com  Mon Aug  3 14:46:11 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 3 Aug 2020 18:46:11 -0300
Subject: [gdal-dev] Fwd: NEXTGEN new release: SpatiaLite 5.0.0 RC1
In-Reply-To: <cf656445-5dce-dc32-4855-d59da40af285@gatewaygeomatics.com>
References: <cf656445-5dce-dc32-4855-d59da40af285@gatewaygeomatics.com>
Message-ID: <9cfa3dff-782b-a627-af66-204191db408f@gatewaygeomatics.com>

Forwarding this good news to the GDAL community...   (thank-you Sandro 
Furieri !!)



-------- Forwarded Message --------



Hi list,

I'm glad to announce that after a very long pause of about two years
a new Relase Candidate is finally available.

The wait was not in vain;this is certainly the most advanced and 
sophisticated
SpatiaLite version ever been released and supports many cool new features:
1. full rasterlite2 integration
2. ISO Topology support
3. supporting new PROJ 6/7
4. supporting Stored Procedures
... and many others

please check the documentation about 5.0 from here:
https://www.gaia-gis.it/fossil/libspatialite/wiki?name=5.0.0-doc

full documentation about all SQL functions supported by 5.0 is here:
http://www.gaia-gis.it/gaia-sins/spatialite-sql-5.0.0.html

source tarballs can be downloaded from here:
http://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.0.0-RC1.tar.gz
http://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.0.0-RC1.zip

http://www.gaia-gis.it/gaia-sins/spatialite-tools-5.0.0-RC1.tar.gz
http://www.gaia-gis.it/gaia-sins/spatialite-tools-5.0.0-RC1.zip

pre-built binaries for Windows are here:
http://www.gaia-gis.it/gaia-sins/windows-bin-NEXTGEN-x86
http://www.gaia-gis.it/gaia-sins/windows-bin-NEXTGEN-amd64

I'll give in a following post further detailed infos about the
current state of all other members of the family (freexl,
readosm, rasterlite2, virtualPG and the GUI tool).

Happy testing,
Sandro




_______________________________________________
QGIS-Developer mailing list
QGIS-Developer at lists.osgeo.org
List info: https://lists.osgeo.org/mailman/listinfo/qgis-developer
Unsubscribe: https://lists.osgeo.org/mailman/listinfo/qgis-developer

From ryan.proulx at safe.com  Tue Aug  4 08:45:59 2020
From: ryan.proulx at safe.com (Ryan Proulx)
Date: Tue, 4 Aug 2020 08:45:59 -0700
Subject: [gdal-dev] Making MITAB to recognize Extented MapInfo TAB
In-Reply-To: <2490396.arYcUze2eM@even-i700>
References: <342d835db8b44d45bc7c129a2174f01e@C119S212VM042.msvyvi.vaha.local>
 <2490396.arYcUze2eM@even-i700>
Message-ID: <CAKhU7Tkz2N9ZB90337icaQcnNdXX_GirLT1FQHJhN9745QpkTA@mail.gmail.com>

This should be relatively easy, given that the .TAB file header contains a
Table Type which is commonly NATIVE (old .TAB files readable by MITAB,
etc.) or NATIVEX (extended .TAB files), as well as a few other less popular
options. So the 'magic' identifier should be clearly spelled out in plain
text.

E.g.

> !table
> !version 1520
> !charset WindowsLatin1
> Definition Table
>   Type NATIVEX Charset "WindowsLatin1" Locale "en-US"
>   Fields 32 ...



*____________________________________________________Ryan Proulx* | Team
Lead, Principal Developer, Project Manager

Suite 1200 - 9639 137A Street, Surrey, BC Canada V3T 0M1

ryan.proulx at safe.com  |  www.safe.com <http://www.safe.com/>
*____________________________________________________*
[image: http://www.safe.com/emailsignature]
<http://www.safe.com/emailsignature>





On Mon, Aug 3, 2020 at 3:06 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On lundi 3 août 2020 09:26:16 CEST Rahkonen Jukka (MML) wrote:
>
> > Hi,
>
> >
>
> > Might be good if the MITAB driver could recognize if TAB file is of the
> new
>
> > Extented TAB format and show a meaningful error for the users. It could
>
> > save troubles similar to this one in gis.stackexchange
>
> >
> https://gis.stackexchange.com/questions/369014/mapinfo-tab-files-with-large
>
> > int-cant-be-converted-to-qgis-or-any-other-format. I hope the new format
> has
>
> > some magic number that stores the version.
>
>
>
> From a comment in the thread, it looks it might be something that could be
> addressed by MITAB with some extra work. We'd need a reproducer dataset to
> confirm.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200804/34baf36d/attachment.html>

From muro.hector at gmail.com  Wed Aug  5 02:15:06 2020
From: muro.hector at gmail.com (Hector muro)
Date: Wed, 5 Aug 2020 10:15:06 +0100
Subject: [gdal-dev] Specify ODBC PATH
Message-ID: <CAKdB_X631xU2N=ukwXEn_n8c4w0MkUtiFB1EEVb1fH34wkJJUg@mail.gmail.com>

Hi all,

I have successfully installed gdal (from source) with the MSSQLSpatial
driver in a couple servers (RHEL), but there is one that is resisting and I
think it's got to do with the ODBC installation.

If I do the following, cat /etc/odbcinst.ini

I obtain this:

[PostgreSQL]
Description=ODBC for PostgreSQL
Driver=/usr/lib/psqlodbcw.so
Setup=/usr/lib/libodbcpsqlS.so
Driver64=/usr/lib64/psqlodbcw.so
Setup64=/usr/lib64/libodbcpsqlS.so
FileUsage=1

[MySQL]
Description=ODBC for MySQL
Driver=/usr/lib/libmyodbc5.so
Setup=/usr/lib/libodbcmyS.so
Driver64=/usr/lib64/libmyodbc5.so
Setup64=/usr/lib64/libodbcmyS.so
FileUsage=1

[ODBC Driver 17 for SQL Server]
Description=Microsoft ODBC Driver 17 for SQL Server
Driver=/opt/microsoft/msodbcsql17/lib64/libmsodbcsql-17.5.so.2.1
UsageCount=1

So, using the configure with normal flags, does not configure the
installation for MSSQLSpatial, even adding the flag
"--enable-driver-mssqlspatial".

Then I tried with the following flag:
--with-odbc=/opt/microsoft/msodbcsql17, which made the configuration
prepare for odbc and mssqlspatial, but then, when running "make", I got the
following error:

In file included from cpl_odbc.cpp:32:0:
cpl_odbc.h:39:17: fatal error: sql.h: No such file or directory
 #include <sql.h>
                 ^
compilation terminated.
make[1]: *** [cpl_odbc.lo] Error 1
make: *** [port-target] Error 2

Any ideas about which configuration am I getting wrong to get that error?

Thanks and regards,

Hector
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200805/725bb9c0/attachment.html>

From even.rouault at spatialys.com  Wed Aug  5 03:52:14 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Aug 2020 12:52:14 +0200
Subject: [gdal-dev] [PROJ] Bug in unit conversion using cs2cs and
	transformations from registries?
In-Reply-To: <3005F0FD58AE03439837685371FBCB71FDFD8686@mailex1.ign.fr>
References: <3005F0FD58AE03439837685371FBCB71FDFD709B@mailex1.ign.fr>
 <1817986.avv6YtX2Jn@even-i700>
 <3005F0FD58AE03439837685371FBCB71FDFD8686@mailex1.ign.fr>
Message-ID: <24950976.EMQIEVjhVP@even-i700>

(Adding back the list in CC)

> 
> Thank you for your quick reply and valuable comments. I should have read the
> documentation more deeply, this is indeed written in the documentation of
> cs2cs at the end but I was so sure that cs2cs behaves as projinfo would
> tell that I missed it. * ***** ***** ** ** ***** ******* **** ***** ** ***
> **** **** *** ************** **** ******** lists.
> 
> Another questions, I did not find the answer in the documentation. In case
> of multiple available transformations, do I have a way with cs2cs to tell
> the one I want please? For example "projinfo -s EPSG:4326 -t ESRI:102586"
> provides two output transformations. Do I have the possibility to tell to
> cs2cs that I want the second one? If said differently, instead of giving
> input and ouput crs to cs2cs, can I provide only the transformation name or
> provide the transformation name in addition to the input and output CRS?
> Here "Inverse of NTF to WGS 84 (1) + NTF_Lambert_Zone_II" for example, the
> second field I got using --summary option (= WKT2 CONCATENATEDOPERATION
> name).

You have to use cct with the PROJ pipeline emitted by projinfo to control precisely which 
transformation you want to use

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200805/ac96f501/attachment.html>

From kmskavi at gmail.com  Wed Aug  5 04:28:47 2020
From: kmskavi at gmail.com (Kavitha K)
Date: Wed, 5 Aug 2020 16:58:47 +0530
Subject: [gdal-dev] GDAL is whether supported ASLR compile or not
Message-ID: <CACLbJJdtV+N_xzfy6mdAmShNbvkeYDpYxiuHbQJFZ7HpFFeC5A@mail.gmail.com>

Hi All,
 We are trying to compile the gdal 2.3.2 source with ASLR . But we are
seeing the
 Elf file type as EXEC (Executable file) instead DYN.

 Please help us whether gdal build is supported the compilation with "-Fpie
-pie -fPIC".

 Steps which we followed:

 cp gdalDevKits/gdal-2.3.2.tar.gz .

 tar -xvf gdal-2.3.2.tar.gz

 cd gdal-2.3.2

 env CFLAGS="-Fpie -pie -fPIC" ./configure

 make install

 cd /usr/local/bin

 readelf -l gdaltransform

 Elf file type is EXEC (Executable file)

 Entry point 0x40

Thanks,
Kavitha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200805/d2079a27/attachment.html>

From idan at miara.com  Wed Aug  5 23:01:08 2020
From: idan at miara.com (Idan Miara)
Date: Thu, 6 Aug 2020 09:01:08 +0300
Subject: [gdal-dev] Sparse GTiff with sparse index?
Message-ID: <CAEDrt38cqZwK92WqF2gObYNWAVyN4dAKwmVwjZaJ+b9rCUFmzA@mail.gmail.com>

Hi,

Is there an option to create a GTiff with a sparse index?

I'm creating a vrt with a large extent from a single small GTiff (that I am
using later as an overview for another raster)
The output is mostly nodata values as only a small part of it contains
actual data from the input tif.
The vrt itself works well but if I try to translate it to a GTiff (with
SPARSE=OK) I get a huge tif due to the huge tile index (creating a
non-sparse tif will be even much bigger than that).
A zip of the input is about the same size as a zip of the output file.
The output compresses so well because its tile index is essentially lots of
nulls.
The output tif is also significantly less responsive than the vrt in QGIS
(I guess due to its huge index).

Is there an option to eliminate this huge index or an alternative format
that I can translate the vrt into and will be with a reasonable size?

Kind regards,
Idan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200806/099764aa/attachment.html>

From kmskavi at gmail.com  Thu Aug  6 01:13:33 2020
From: kmskavi at gmail.com (Kavitha K)
Date: Thu, 6 Aug 2020 13:43:33 +0530
Subject: [gdal-dev] Information needed: GDAL is supported with ASLR built
 binaries(PIE enabled, ELF is DYN) on Red Hat Enterprise Linux Server 7.8
Message-ID: <CACLbJJcUJrBVTpYe6MoiKpKRj2-SMwV+78rvLP=UC2ASTUKSsQ@mail.gmail.com>

Hi All,

Please help us in the following.
We are using the gdal 2.3.2 version for our product.
we need to update the binaries with ASLR built'ones for security reasons.
which version of gdal is supported with PIE(ASLR) enabled binaries.

Please share with us the detailed steps to install it from the source.

build environment:
our OS is Red Hat Enterprise Linux Server 7.8

Thanks,
Kavitha

Detailed Steps which i tried today:
 we have downloaded the 3.1.0 from
https://gdal.org/download.html#development-source
 cd gdalDevKits
 export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
 tar -xvf gdal-3.1.0.tar.gz
 cd gdal-3.1.0
  ./configure
configure: Bash completions not requested
checking for PROJ >= 6 library... checking for proj_create_from_wkt in
-lproj... no
checking for internal_proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -linternalproj... no
configure: error: PROJ 6 symbols not found

After i did the search in google, i found that we need to use --with-proj.
but no luck on it.
   ./configure --with-proj=/usr/local
  configure: Bash completions not requested
checking for PROJ >= 6 library... checking for proj_create_from_wkt in
-lproj... no
checking for internal_proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -linternalproj... no
configure: error: PROJ 6 symbols not found


My linux OS is
 cat /etc/os-release
NAME="Red Hat Enterprise Linux Server"
VERSION="7.8 (Maipo)"
ID="rhel"
ID_LIKE="fedora"
VARIANT="Server"
VARIANT_ID="server"
VERSION_ID="7.8"
PRETTY_NAME="Red Hat Enterprise Linux Server 7.8 (Maipo)"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:redhat:enterprise_linux:7.8:GA:server"
HOME_URL="https://www.redhat.com/"
BUG_REPORT_URL="https://bugzilla.redhat.com/"

REDHAT_BUGZILLA_PRODUCT="Red Hat Enterprise Linux 7"
REDHAT_BUGZILLA_PRODUCT_VERSION=7.8
REDHAT_SUPPORT_PRODUCT="Red Hat Enterprise Linux"
REDHAT_SUPPORT_PRODUCT_VERSION="7.8"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200806/36b701a8/attachment.html>

From even.rouault at spatialys.com  Thu Aug  6 02:02:37 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 06 Aug 2020 11:02:37 +0200
Subject: [gdal-dev] Sparse GTiff with sparse index?
In-Reply-To: <CAEDrt38cqZwK92WqF2gObYNWAVyN4dAKwmVwjZaJ+b9rCUFmzA@mail.gmail.com>
References: <CAEDrt38cqZwK92WqF2gObYNWAVyN4dAKwmVwjZaJ+b9rCUFmzA@mail.gmail.com>
Message-ID: <2452648.g8NHFfphtx@even-i700>

Idan,

> Is there an option to create a GTiff with a sparse index?
[...] 
> Is there an option to eliminate this huge index

No, the index must be fully present in a TIFF file.

> or an alternative format
> that I can translate the vrt into and will be with a reasonable size?

The GeoPackage driver will not emit sparse tiles, but currently only with RGBA Byte data 
(when alpha=0 for a tile), or single-band Float32 (when data for a tile matches the nodata 
value)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200806/ca39db7a/attachment.html>

From rajeshreddy82 at gmail.com  Thu Aug  6 06:21:21 2020
From: rajeshreddy82 at gmail.com (MRRAJESH)
Date: Thu, 6 Aug 2020 06:21:21 -0700 (MST)
Subject: [gdal-dev] 100% CPU Usage and W3WP.exe suspended
Message-ID: <1596720081462-0.post@n6.nabble.com>

Developers,

We are using VRT file as input to GDALVectorTranslate in C++. Till 18 or 19
level, we are getting tiles. When we request for multiple 20th level tiles,
CPU reaching to 100% and w3wp.exe suspended (crashed). Here we are using vsi
memory buffer to store the tiles for each thread separately using UUID...
How to overcome this issue?

	vsibufPath = string("/vsimem/mvt-") + GetUUID();
        vsibuf = vsibufPath.c_str();

         const char *pszFilename = "C:\\Test\\MVT.vrt";
         hSrcDS = (GDALDatasetH *)GDALOpenEx(pszFilename, GDAL_OF_READONLY,
NULL,NULL, NULL);

         dst = (GDALDataset *)GDALVectorTranslate(vsibuf, NULL, 1, &hSrcDS,
opt,NULL);

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From julien.roy-sabourin.eccc at gccollaboration.ca  Thu Aug  6 06:37:41 2020
From: julien.roy-sabourin.eccc at gccollaboration.ca (Roy-Sabourin, Julien (ECCC))
Date: Thu, 6 Aug 2020 13:37:41 +0000
Subject: [gdal-dev] acess /vsimem files
Message-ID: <QB1PR01MB3409BF1B09A5B0E08F09F11AFC480@QB1PR01MB3409.CANPRD01.PROD.OUTLOOK.COM>

(pyton)
Hi, I'm using
driver.Create('/vsimem/file.tif', xsize, ysize, 1, gdal.GDT_Byte)
to make a tif file without writing on disk.
Then I associate data and statistics to the tiff and i what to return the raw bytes of the file.
How can i acces the memory file, i tired
VSIGetMemFileBuffer_unsafe('/vsimem/v.tif')
but there is praticlly no documentation for this method in python.

Thanks in advance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200806/0c6c09cb/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug  6 08:10:47 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 6 Aug 2020 08:10:47 -0700 (MST)
Subject: [gdal-dev] acess /vsimem files
In-Reply-To: <QB1PR01MB3409BF1B09A5B0E08F09F11AFC480@QB1PR01MB3409.CANPRD01.PROD.OUTLOOK.COM>
References: <QB1PR01MB3409BF1B09A5B0E08F09F11AFC480@QB1PR01MB3409.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <1596726647703-0.post@n6.nabble.com>

Hi,

Perhaps you could use the autotest
https://github.com/OSGeo/gdal/blob/master/autotest/gcore/tiff_read.py#L552
as an example.

-Jukka Rahkonen-




Roy-Sabourin, Julien (ECCC) wrote
> (pyton)
> Hi, I'm using
> driver.Create('/vsimem/file.tif', xsize, ysize, 1, gdal.GDT_Byte)
> to make a tif file without writing on disk.
> Then I associate data and statistics to the tiff and i what to return the
> raw bytes of the file.
> How can i acces the memory file, i tired
> VSIGetMemFileBuffer_unsafe('/vsimem/v.tif')
> but there is praticlly no documentation for this method in python.
> 
> Thanks in advance
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From antguz06 at gmail.com  Fri Aug  7 14:43:53 2020
From: antguz06 at gmail.com (=?UTF-8?B?Si4gQW50b25pbyBHdXptw6FuIFEu?=)
Date: Fri, 7 Aug 2020 15:43:53 -0600
Subject: [gdal-dev] Extracting a band with gdalmdimtranslate
Message-ID: <CAF4cKSsHa3NuT86_qcDM3bmQwTXPC7eoyfXhMGv0OBm3iWk+mg@mail.gmail.com>

Hi,

I am trying to extract a band (byte 3) from the Quality_Assurance SDS of
MODIS Cloud Mask swath product (MOD35-MYD35). Overall, I can not extract a
band or array using gdalwarp since the dimensions of the array seems to be
[Along, Across, Bytes] [2040x1354x10] and not [Bytes, Along, Across].
Therefore, I am trying to use gdalmdimtranslate to first transpose the
array (transpose=[2,0,1]) and then do the extraction as GTiff.

Despite this, I am not totally sure about code writing or logic for this;
maybe some of you can help me.

My code is the following for the enclosed file below

gdalmdimtranslate
HDF4_EOS:EOS_SWATH:MOD35_L2.A2017161.1525.061.2017315035809.hdf:mod35:Quality_Assurance
example.tif -scaleaxes 'QA_Dimension:mod35(3)'

I am running this from the cmd as a test using gdal 3.1.1. I always
get an ERROR 5:
GDALDataset::GetRasterBand(-1) - Illegal band

I also try to call the dimension in different ways out results. If you
have a different approach to extract the Byte 3 of this SDS that is
also welcome.

I also enclosed a .txt as a results of gdalinfo
MOD35_L2.A2017161.1525.061.2017315035809.hdf

Best regards,

https://drive.google.com/file/d/1fMZrfMLl18e_D6CjJbscwhLvoFFGORJp/view?usp=sharing
https://drive.google.com/file/d/1f7oda-N9YT_cyf7YRw80BNQZr2O0RUMe/view?usp=sharing

-- 
_______________________
J. Antonio Guzmán Q., *M.Sc*
Ph.D Candidate and Vanier Scholar
Earth and Atmospheric Sciences Department
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200807/ca212472/attachment.html>

From nelson.gerald.c at gmail.com  Fri Aug  7 17:35:54 2020
From: nelson.gerald.c at gmail.com (Gerald Nelson)
Date: Sat, 8 Aug 2020 00:35:54 +0000
Subject: [gdal-dev] how to completely remove gdal from Ubuntu 20.04 and
 install from scratch
Message-ID: <MW2PR16MB2172B23F704ABEF73084962CAD460@MW2PR16MB2172.namprd16.prod.outlook.com>



I have both a mac and a linux box with Ubuntu 20.04. gdal on the mac is installed through home brew. gdal on the linux box has been installed both from source with the usual configure, make, make install and with sudo apt-get install gdal-bin. Both completed successfully and sudo apt-get install gdal-bin returned GDAL 3.1.2, released 2020/07/07.

When I attempt to install or upgrade sf, rgdal, or terra I get similar error messages. They come after

** testing if installed package can be loaded from temporary location

The messages are

free(): invalid size

Aborted (core dumped).

Another thread suggested that there should not be multiple versions of gdal on a machine. I didn’t intend for there to be but I had GDAL 3.0.7 originally on the linux box before installing GDAL3.1.2 so it is possible that there may be bits of the older version around.

I can’t find any good directions for how to do a deep clean, or for that matter to install gdal on Ubuntu 20.04 so I was hoping to get some directions here.

Gerald C. Nelson
Professor Emeritus, UIUC
+1 217-390-7888 (cell)
+1 970-639-2079 (land line)
Skype: jerrynelson
http://bit.ly/1arho7d
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200808/3e5a3c6d/attachment.html>

From hyoklee at hdfgroup.org  Fri Aug  7 21:55:41 2020
From: hyoklee at hdfgroup.org (Joe Lee)
Date: Sat, 8 Aug 2020 04:55:41 +0000
Subject: [gdal-dev] Extracting a band with gdalmdimtranslate
In-Reply-To: <CAF4cKSsHa3NuT86_qcDM3bmQwTXPC7eoyfXhMGv0OBm3iWk+mg@mail.gmail.com>
References: <CAF4cKSsHa3NuT86_qcDM3bmQwTXPC7eoyfXhMGv0OBm3iWk+mg@mail.gmail.com>
Message-ID: <CY4PR17MB1239E5D424791FAC3C3D9921C2460@CY4PR17MB1239.namprd17.prod.outlook.com>

Hi,

Please try

$ gdalmdimtranslate -array "name=/swaths/mod35/Data Fields/Quality_Assurance,transpose=[2,1,0]" MOD35_L2.A2017161.1525.061.2017315035809.hdf test.tif

as shown in [1], which I updated it today for MOD35_L2.

[1] https://github.com/hdfeos/zoo/tree/master/gdal


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of J. Antonio Guzmán Q.
Sent: Friday, August 07, 2020 4:44 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Extracting a band with gdalmdimtranslate

Hi,

I am trying to extract a band (byte 3) from the Quality_Assurance SDS of MODIS Cloud Mask swath product (MOD35-MYD35). Overall, I can not extract a band or array using gdalwarp since the dimensions of the array seems to be [Along, Across, Bytes] [2040x1354x10] and not [Bytes, Along, Across]. Therefore, I am trying to use gdalmdimtranslate to first transpose the array (transpose=[2,0,1]) and then do the extraction as GTiff.

Despite this, I am not totally sure about code writing or logic for this; maybe some of you can help me.

My code is the following for the enclosed file below


gdalmdimtranslate HDF4_EOS:EOS_SWATH:MOD35_L2.A2017161.1525.061.2017315035809.hdf:mod35:Quality_Assurance example.tif -scaleaxes 'QA_Dimension:mod35(3)'

I am running this from the cmd as a test using gdal 3.1.1. I always get an ERROR 5:
GDALDataset::GetRasterBand(-1) - Illegal band

I also try to call the dimension in different ways out results. If you have a different approach to extract the Byte 3 of this SDS that is also welcome.

I also enclosed a .txt as a results of gdalinfo

MOD35_L2.A2017161.1525.061.2017315035809.hdf


Best regards,

https://drive.google.com/file/d/1fMZrfMLl18e_D6CjJbscwhLvoFFGORJp/view?usp=sharing
https://drive.google.com/file/d/1f7oda-N9YT_cyf7YRw80BNQZr2O0RUMe/view?usp=sharing

--
_______________________
J. Antonio Guzmán Q., M.Sc
Ph.D Candidate and Vanier Scholar
Earth and Atmospheric Sciences Department

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200808/4251534b/attachment-0001.html>

From sebastic at xs4all.nl  Fri Aug  7 23:45:53 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 8 Aug 2020 08:45:53 +0200
Subject: [gdal-dev] how to completely remove gdal from Ubuntu 20.04 and
 install from scratch
In-Reply-To: <MW2PR16MB2172B23F704ABEF73084962CAD460@MW2PR16MB2172.namprd16.prod.outlook.com>
References: <MW2PR16MB2172B23F704ABEF73084962CAD460@MW2PR16MB2172.namprd16.prod.outlook.com>
Message-ID: <b1a6bf8a-2ec1-fda8-4aae-02fa9618f2b2@xs4all.nl>

On 8/8/20 2:35 AM, Gerald Nelson wrote:
> I can’t find any good directions for how to do a deep clean, or for that matter to install gdal on Ubuntu 20.04 so I was hoping to get some directions here.

To get rid of the gdal package you can use:

 apt purge $(dpkg -l | grep gdal | awk '{print $2}' | xargs)

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From AThomas at thinkspatial.com.au  Sat Aug  8 05:58:37 2020
From: AThomas at thinkspatial.com.au (Alan Thomas)
Date: Sat, 8 Aug 2020 12:58:37 +0000
Subject: [gdal-dev] How can I use RawCodeValues in DXF driver?
In-Reply-To: <1596183618418-0.post@n6.nabble.com>
References: <1596183618418-0.post@n6.nabble.com>
Message-ID: <MEXPR01MB2087A1708FB588ACC9C8513BE0460@MEXPR01MB2087.ausprd01.prod.outlook.com>

RawCodeValues is generated by the DXF reader. The DXF writer has no logic to handle this field.

Alan

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of jlaegel
Sent: Friday, 31 July 2020 6:20 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] How can I use RawCodeValues in DXF driver?

Hello,

I create a new DXF file, and want to use the RawCodeValues field.
but I can't get it in the output DXF.

Procedure:
- MS-SQL-Server
- GDAL version 3.0.0

-a table on the SQL-Server with fields:
   layer AS nvarchar(max),
   RawCodeValues AS nvarchar(max),
   ogr_style AS nvarchar(max),
   blockname AS nvarchar(max),
   blockscale AS nvarchar(max),
   blockangle AS int,
   the_geom AS geometry

- input command line: (* replace the original input)

/ogr2ogr --config DXF_INCLUDE_RAW_CODE_VALUES TRUE -f DXF C:\***\***\***\test.dxf -dsco header=C:\ogr2ogr\gdal\bin\gdal-data\header.dxf -dsco trailer=C:\ogr2ogr\gdal\bin\gdal-data\trailer.dxf
"MSSQL:server=**.**.**.**;driver=SQL Server;database=****; Uid=***;Pwd=******; tables=dbo.*****(the_geom)"/

This procedure works itself for the DXF output with the values in "ogr_style" or "blockname".
But the value in the tablefield "RawCodeValues" is ignored.

Example of SQL-Table content: (line geometry)
layer|RawCodeValues|ogr_style|blockname|blockscale|blockangle
test|43=1.0|PEN(c:#cecece)|NULL|NULL|NULL

In this example i need *constant width* in line geometry.
In DXF, the line is available with color #cecece, but without constant width.

I have read that the content in "RawCodeValues" should be "code = value [, code = value]*".

Is my content/syntax for RawCodeValues in the tablefield correct?

Or what do I have to set so the output with RawCodeValues works?

The "Pen Width" in "ogr_style" isn't an option for me, because that is the weight in DXF and not all values are allowed.




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jonathan-lists at lightpear.com  Sat Aug  8 10:48:22 2020
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Sat, 8 Aug 2020 18:48:22 +0100
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
Message-ID: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>

Hi List,
I have a JP2 file I'm trying to process with Rasterio in Python. But I'm 
getting this error:

rasterio.errors.RasterioIOError: Read or write failed. FILENAME.jp2, 
band 1: IReadBlock failed at X offset 40, Y offset 90: opj_decode() failed

That error seems to come from GDAL. I've tried setting the driver to 
both "JPEG2000" and "JP2OpenJPEG" to no avail.

The file opens fine in QGIS, and I tried both gdal2tiles and rgb2pct 
(via the QGIS installation, which is different from the python/rasterio 
install): those both worked fine too, so clearly GDAL can read it when 
standalone.

Any suggestions?

Thanks,
Jonathan

p.s. -  Also tried the JP2ECW driver but couldn't figure out how to link 
it to GDAL. I mention it only because the links to the JP2ECW on 
https://gdal.org/drivers/raster/jp2ecw.html are now invalid. They seem 
to have moved stuff without using redirects. Seems to be here now: 
https://download.hexagongeospatial.com/search?keyword=&lang=en&product_family=29e5f4b2-f943-4710-9b4a-bd1d16525d1e&download_version=a0edddba-0ce6-4cfb-bbe4-95e59d3c87d2

gdalinfo output below:

Driver: JP2ECW/ERDAS JPEG2000 (SDK 5.3)
Files: FILENAME.jp2
Size is 132000, 248000
Coordinate System is:
PROJCS["British National Grid (ORD SURV GB)",
     GEOGCS["OSGB 1936",
         DATUM["OSGB_1936",
             SPHEROID["Airy 1830",6377563.396,299.3249612664951,
                 AUTHORITY["EPSG","7001"]],
             AUTHORITY["EPSG","6277"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4277"]],
     PROJECTION["Transverse_Mercator"],
     PARAMETER["latitude_of_origin",49],
     PARAMETER["central_meridian",-2],
     PARAMETER["scale_factor",0.9996012717],
     PARAMETER["false_easting",400000],
     PARAMETER["false_northing",-100000],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (0.000000000000000,1240000.000000000000000)
Pixel Size = (5.000000000000000,-5.000000000000000)
Metadata:
   COLORSPACE=RGB
   COMPRESSION_RATE_TARGET=0
Corner Coordinates:
Upper Left  (       0.000, 1240000.000) (  9d22'13.04"W, 60d50'27.04"N)
Lower Left  (   0.0000000,   0.0000000) (  7d33'23.21"W, 49d45'58.27"N)
Upper Right (  660000.000, 1240000.000) (  2d48'15.07"E, 60d57'26.43"N)
Lower Right (  660000.000,       0.000) (  1d37' 0.77"E, 49d50'35.22"N)
Center      (  330000.000,  620000.000) (  3d 6'26.52"W, 55d28' 7.68"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
   Description = Red
   Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2062
x3875, 1031x1937, 515x968, 257x484
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
   Description = Green
   Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2062
x3875, 1031x1937, 515x968, 257x484
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
   Description = Blue
   Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2062
x3875, 1031x1937, 515x968, 257x484



From antguz06 at gmail.com  Sat Aug  8 16:31:17 2020
From: antguz06 at gmail.com (=?UTF-8?B?Si4gQW50b25pbyBHdXptw6FuIFEu?=)
Date: Sat, 8 Aug 2020 17:31:17 -0600
Subject: [gdal-dev] Extracting a band with gdalmdimtranslate
In-Reply-To: <CY4PR17MB1239E5D424791FAC3C3D9921C2460@CY4PR17MB1239.namprd17.prod.outlook.com>
References: <CAF4cKSsHa3NuT86_qcDM3bmQwTXPC7eoyfXhMGv0OBm3iWk+mg@mail.gmail.com>
 <CY4PR17MB1239E5D424791FAC3C3D9921C2460@CY4PR17MB1239.namprd17.prod.outlook.com>
Message-ID: <CAF4cKSsnjowRYxmgGcP0eTC=ryiyTt7Hu_uP1z7iVrjSytitmA@mail.gmail.com>

Thanks Dr. Lee for you quick response,

I runned your example. It seems that it returns an output; however the
returned .tif does not contain information. I checked the tif file that you
uploaded in [1], but this also does not contain information.

I know that the Quality_Assurance SDS contains information about spectral
tests because I can see those using HDFView 3.1.1.

Do you know what is happening here?

Thanks in advance...

El vie., 7 ago. 2020 a las 22:55, Joe Lee (<hyoklee at hdfgroup.org>) escribió:

> Hi,
>
>
>
> Please try
>
>
>
> $ gdalmdimtranslate -array "name=/swaths/mod35/Data
> Fields/Quality_Assurance,transpose=[2,1,0]" MOD35_L2.A2017161.1525.061.2017315035809.hdf
> test.tif
>
>
>
> as shown in [1], which I updated it today for MOD35_L2.
>
>
>
> [1] https://github.com/hdfeos/zoo/tree/master/gdal
>
>
>
>
>
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> * On Behalf Of *J.
> Antonio Guzmán Q.
> *Sent:* Friday, August 07, 2020 4:44 PM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* [gdal-dev] Extracting a band with gdalmdimtranslate
>
>
>
> Hi,
>
>
>
> I am trying to extract a band (byte 3) from the Quality_Assurance SDS of
> MODIS Cloud Mask swath product (MOD35-MYD35). Overall, I can not extract a
> band or array using gdalwarp since the dimensions of the array seems to be
> [Along, Across, Bytes] [2040x1354x10] and not [Bytes, Along, Across].
> Therefore, I am trying to use gdalmdimtranslate to first transpose the
> array (transpose=[2,0,1]) and then do the extraction as GTiff.
>
>
>
> Despite this, I am not totally sure about code writing or logic for this;
> maybe some of you can help me.
>
>
>
> My code is the following for the enclosed file below
>
>
>
> gdalmdimtranslate HDF4_EOS:EOS_SWATH:MOD35_L2.A2017161.1525.061.2017315035809.hdf:mod35:Quality_Assurance example.tif -scaleaxes 'QA_Dimension:mod35(3)'
>
> I am running this from the cmd as a test using gdal 3.1.1. I always get an ERROR 5:
> GDALDataset::GetRasterBand(-1) - Illegal band
>
> I also try to call the dimension in different ways out results. If you have a different approach to extract the Byte 3 of this SDS that is also welcome.
>
> I also enclosed a .txt as a results of gdalinfo
>
> MOD35_L2.A2017161.1525.061.2017315035809.hdf
>
>
>
> Best regards,
>
>
>
>
> https://drive.google.com/file/d/1fMZrfMLl18e_D6CjJbscwhLvoFFGORJp/view?usp=sharing
>
>
> https://drive.google.com/file/d/1f7oda-N9YT_cyf7YRw80BNQZr2O0RUMe/view?usp=sharing
>
>
>
> --
>
> _______________________
> J. Antonio Guzmán Q., *M.Sc*
> Ph.D Candidate and Vanier Scholar
>
> Earth and Atmospheric Sciences Department
>
>
>


-- 
_______________________
J. Antonio Guzmán Q., *M.Sc*
Ph.D Candidate and Vanier Scholar
Earth and Atmospheric Sciences Department
University of Alberta, Canada
jaguzmanq.com
Look my work in Google Scholar
<https://scholar.google.es/citations?user=Ev3ofxwAAAAJ&hl=es> and/or
ResearchGate <https://www.researchgate.net/profile/J_Antonio_Guzman_Q>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200808/5ef6710a/attachment.html>

From even.rouault at spatialys.com  Sun Aug  9 03:14:35 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 09 Aug 2020 12:14:35 +0200
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
Message-ID: <2479634.Ol3L1e6iaf@even-i700>

Jonathan,

The GDAL build that comes with rasterio must have only JP2OpenJPEG enabled (the error 
with opj_decode() comes from that driver), whereas the GDAL build in QGIS has also JP2ECW, 
which is used in priority.

The file is large. It would be interesting to know if it is tiled. If you do "gdalinfo --format 
FILENAME.jp2 --config GDAL_SKIP JP2ECW", and look at the beginning of the output, you 
should see lines like

OPENJPEG: nTileW = XXXX
OPENJPEG: nTileH = XXXX

which values are reported ?

If it is tiled (values <= 2048 let's say), this should normally work. Openjpeg will have more 
difficulties with single-tile JPEG2000 files, although latest versions (2.3.1) have seen 
improvements in that regard

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200809/3061157e/attachment.html>

From jonathan-lists at lightpear.com  Sun Aug  9 04:47:33 2020
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Sun, 9 Aug 2020 12:47:33 +0100
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <2479634.Ol3L1e6iaf@even-i700>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <2479634.Ol3L1e6iaf@even-i700>
Message-ID: <d09aa9e1-eb44-0a7e-589f-cbf5b4ba8f91@lightpear.com>

Hi Even,
Thanks for getting back to me. I'm a little rusty with GDAL; it has 
probably been 5+ years since I last used it.

I can confirm my QGIS install version (OSGEO4W) does have the JP2ECW 
driver (`gdalinfo --formats`).

I'm using the Python GDAL build from 
https://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal - doesn't say it 
includes JP2ECW. I only have access to that GDAL build via Python but 
haven't managed to figure out what the Python API equivalent of 
"gdalinfo --formats" is (assuming there is one).

I don't seem to be able to force JP2OpenJPEG on the OSGeo4W one.
gdalinfo --config GDAL_SKIP JP2ECW FILENAME.jp2   = uses the MrSID driver
gdalinfo --config GDAL_SKIP JP2ECW --config GDAL_SKIP JP2MrSID 
FILENAME.jp2   = Goes back to JP2ECW
(Doesn't support the -if flag).

But I found `gdal.Info("FILENAME.jp2")` on the Python version, and that 
does use the JP2 OpenJPEG driver. No tile information on there:

     Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
     ...
     Image Structure Metadata:
       INTERLEAVE=PIXEL
     ...
     Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
       Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2063x3875, 1032x1938, 516x969, 258x485, 129x243, 65x122
       Overviews: arbitrary
       Image Structure Metadata:
         COMPRESSION=JPEG2000
     ...

I can't help but notice the block size and overview levels are reporting 
different info compared to the JP2ECW output (ECW one has different 
rounding <= 2062*3875):

     Band 1 Block=256x256 Type=Byte, ColorInterp=Red
       Description = Red
       Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2062
     x3875, 1031x1937, 515x968, 257x484

and JP2MrSID for comparison:
     Band 1 Block=1024x128 Type=Byte, ColorInterp=Red
   Min=168.000 Max=255.000
   Minimum=168.000, Maximum=255.000, Mean=243.359, StdDev=16.164
   Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2063
x3875, 1032x1938, 516x969, 258x485, 129x243, 65x122, 33x61
   Metadata:
     STATISTICS_APPROXIMATE=YES
     STATISTICS_MAXIMUM=255
     STATISTICS_MEAN=243.35889029004
     STATISTICS_MINIMUM=168
     STATISTICS_STDDEV=16.164314681862
     STATISTICS_VALID_PERCENT=100

All three report different Overview levels too. Odd but no idea if it is 
pertinent to this problem.

Cheers,
Jonathan

p.s. I was looking for Python API docs but it seems there aren't any. 
This page:
https://pypi.org/project/GDAL/#usage - has a link to 
http://www.gdal.org/gdal_tutorial.html, but that's a 404. I think it 
wants to be: https://gdal.org/tutorials/index.html



On 2020-08-09 11:14, Even Rouault wrote:
>
> Jonathan,
>
> The GDAL build that comes with rasterio must have only JP2OpenJPEG 
> enabled (the error with opj_decode() comes from that driver), whereas 
> the GDAL build in QGIS has also JP2ECW, which is used in priority.
>
> The file is large. It would be interesting to know if it is tiled. If 
> you do "gdalinfo --format FILENAME.jp2 --config GDAL_SKIP JP2ECW", and 
> look at the beginning of the output, you should see lines like
>
> OPENJPEG: nTileW = XXXX
>
> OPENJPEG: nTileH = XXXX
>
> which values are reported ?
>
> If it is tiled (values <= 2048 let's say), this should normally work. 
> Openjpeg will have more difficulties with single-tile JPEG2000 files, 
> although latest versions (2.3.1) have seen improvements in that regard
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>


From even.rouault at spatialys.com  Sun Aug  9 07:21:58 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 09 Aug 2020 16:21:58 +0200
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <d09aa9e1-eb44-0a7e-589f-cbf5b4ba8f91@lightpear.com>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <2479634.Ol3L1e6iaf@even-i700>
 <d09aa9e1-eb44-0a7e-589f-cbf5b4ba8f91@lightpear.com>
Message-ID: <4026341.AXfa6lVJvu@even-i700>

On dimanche 9 août 2020 12:47:33 CEST Jonathan Moules wrote:
> Hi Even,
> Thanks for getting back to me. I'm a little rusty with GDAL; it has
> probably been 5+ years since I last used it.
> 
> I can confirm my QGIS install version (OSGEO4W) does have the JP2ECW
> driver (`gdalinfo --formats`).
> 
> I'm using the Python GDAL build from
> https://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal - doesn't say it
> includes JP2ECW. I only have access to that GDAL build via Python but
> haven't managed to figure out what the Python API equivalent of
> "gdalinfo --formats" is (assuming there is one).
> 
> I don't seem to be able to force JP2OpenJPEG on the OSGeo4W one.
> gdalinfo --config GDAL_SKIP JP2ECW FILENAME.jp2   = uses the MrSID driver
> gdalinfo --config GDAL_SKIP JP2ECW --config GDAL_SKIP JP2MrSID
> FILENAME.jp2   = Goes back to JP2ECW

If you specify several times a configuration option, the last value for a given key will override 
the previous one(s). You can skip several drivers by using comma as a separator. And I forgot 
a very important switch for what I had in mind, "--debug on" instead of my buggy --format

So try:

gdalinfo --config GDAL_SKIP JP2ECW,JP2MrSID --debug on FILENAME.jp2 

> I can't help but notice the block size and overview levels are reporting
> different info compared to the JP2ECW output 

Yes, the various JPEG2000 driver have different logic (or arbitrariness...) to decide the block 
size. For the JP2OpenJPEG driver, 1024x1024 is either because it is the JPEG2000 tile size or 
as an arbitrary block size for a single tiled image. The --debug on will output lower level info.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200809/cf2d10e2/attachment.html>

From jonathan-lists at lightpear.com  Sun Aug  9 07:30:12 2020
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Sun, 9 Aug 2020 15:30:12 +0100
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <4026341.AXfa6lVJvu@even-i700>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <2479634.Ol3L1e6iaf@even-i700>
 <d09aa9e1-eb44-0a7e-589f-cbf5b4ba8f91@lightpear.com>
 <4026341.AXfa6lVJvu@even-i700>
Message-ID: <01f2371c-7a6e-4ee3-856a-e00f0daa14ca@lightpear.com>

Hi Even,

Ah, it's comma delimited. I tried spaces.

Here's the response, with with light editing to get rid of duplicate 
info (The bands are all the same). Nothing in the output with the string 
"tile".

Cheers,

Jonathan


OPENJPEG: info: Start to read j2k main header (0).
OPENJPEG: info: Main header has been correctly decoded.
OPENJPEG: SRGB color space
GDALJP2Metadata: Got projection from GeoJP2 (geotiff) box (0): 
PROJCS["British National Grid (ORD SURV GB)",GEOGCS["OSGB 
1936",DATUM["OSGB_1936",SPHEROID["Airy1830",6377563.396,299.3249612664951,AUTHORITY["EPSG","7001"]],AUTHORITY["EPSG","6277"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4277"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",49],PARAMETER["central_meridian",-2],PARAMETER["scale_factor",0.9996012717],PARAMETER["false_easting",400000],PARAMETER["false_northing",-100000],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
MDReaderPleiades: Not a Pleiades product
MDReaderPleiades: Not a Pleiades product
GDAL: GDALOpen(FILENAME.jp2, this=00000000060407F0) succeeds as JP2OpenJPEG.
Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
GDAL: GDALDefaultOverviews::OverviewScan()
Files: FILENAME.jp2
        FILENAME.jp2.aux.xml
...
Metadata:
   GEOTIFF_CHAR__GeogAngularUnitsGeoKey=Angular_Degree
   GEOTIFF_CHAR__GeogEllipsoidGeoKey=Ellipse_Airy_1830
   GEOTIFF_CHAR__GeogGeodeticDatumGeoKey=Datum_OSGB_1936
   GEOTIFF_CHAR__GeographicTypeGeoKey=GCS_OSGB_1936
   GEOTIFF_CHAR__GTModelTypeGeoKey=ModelTypeProjected
   GEOTIFF_CHAR__GTRasterTypeGeoKey=RasterPixelIsArea
   GEOTIFF_CHAR__ProjCoordTransGeoKey=CT_TransverseMercator
   GEOTIFF_CHAR__ProjectedCSTypeGeoKey=User-Defined
   GEOTIFF_CHAR__ProjectionGeoKey=User-Defined
   GEOTIFF_CHAR__ProjLinearUnitsGeoKey=Linear_Meter
   GEOTIFF_NUM__1024__GTModelTypeGeoKey=1
   GEOTIFF_NUM__1025__GTRasterTypeGeoKey=1
   GEOTIFF_NUM__1026__GTCitationGeoKey=British National Grid (ORD SURV GB)
   GEOTIFF_NUM__2048__GeographicTypeGeoKey=4277
   GEOTIFF_NUM__2049__GeogCitationGeoKey=OSGB 1936
   GEOTIFF_NUM__2050__GeogGeodeticDatumGeoKey=6277
   GEOTIFF_NUM__2054__GeogAngularUnitsGeoKey=9102
   GEOTIFF_NUM__2056__GeogEllipsoidGeoKey=7001
   GEOTIFF_NUM__2057__GeogSemiMajorAxisGeoKey=6377563.396000
   GEOTIFF_NUM__2059__GeogInvFlatteningGeoKey=299.324961
   GEOTIFF_NUM__3072__ProjectedCSTypeGeoKey=32767
   GEOTIFF_NUM__3074__ProjectionGeoKey=32767
   GEOTIFF_NUM__3075__ProjCoordTransGeoKey=1
   GEOTIFF_NUM__3076__ProjLinearUnitsGeoKey=9001
   GEOTIFF_NUM__3080__ProjNatOriginLongGeoKey=-2.000000
   GEOTIFF_NUM__3081__ProjNatOriginLatGeoKey=49.000000
   GEOTIFF_NUM__3082__ProjFalseEastingGeoKey=400000.000000
   GEOTIFF_NUM__3083__ProjFalseNorthingGeoKey=-100000.000000
   GEOTIFF_NUM__3092__ProjScaleAtNatOriginGeoKey=0.999601
Image Structure Metadata:
   INTERLEAVE=PIXEL
OGRCT: Source: +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 
+x_0=400000 +y_0=
-100000 +datum=OSGB36 +units=m +no_defs
OGRCT: Target: +proj=longlat +datum=OSGB36 +no_defs
Corner Coordinates:
...
Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
   Min=168.000 Max=255.000
   Minimum=168.000, Maximum=255.000, Mean=243.359, StdDev=16.164
   Overviews: 66000x124000, 33000x62000, 16500x31000, 8250x15500, 
4125x7750, 2062
x3875, 1031x1937, 515x968, 257x484, 128x242, 64x121
   Overviews: arbitrary
   Metadata:
     STATISTICS_APPROXIMATE=YES
     STATISTICS_MAXIMUM=255
     STATISTICS_MEAN=243.35889029004
     STATISTICS_MINIMUM=168
     STATISTICS_STDDEV=16.164314681862
     STATISTICS_VALID_PERCENT=100
   Image Structure Metadata:
     COMPRESSION=JPEG2000
...
GDAL: GDALClose(FILENAME.jp2,this=00000000060407F0)




On 2020-08-09 15:21, Even Rouault wrote:
>
> On dimanche 9 août 2020 12:47:33 CEST Jonathan Moules wrote:
>
> > Hi Even,
>
> > Thanks for getting back to me. I'm a little rusty with GDAL; it has
>
> > probably been 5+ years since I last used it.
>
> >
>
> > I can confirm my QGIS install version (OSGEO4W) does have the JP2ECW
>
> > driver (`gdalinfo --formats`).
>
> >
>
> > I'm using the Python GDAL build from
>
> > https://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal - doesn't say it
>
> > includes JP2ECW. I only have access to that GDAL build via Python but
>
> > haven't managed to figure out what the Python API equivalent of
>
> > "gdalinfo --formats" is (assuming there is one).
>
> >
>
> > I don't seem to be able to force JP2OpenJPEG on the OSGeo4W one.
>
> > gdalinfo --config GDAL_SKIP JP2ECW FILENAME.jp2   = uses the MrSID 
> driver
>
> > gdalinfo --config GDAL_SKIP JP2ECW --config GDAL_SKIP JP2MrSID
>
> > FILENAME.jp2   = Goes back to JP2ECW
>
> If you specify several times a configuration option, the last value 
> for a given key will override the previous one(s). You can skip 
> several drivers by using comma as a separator. And I forgot a very 
> important switch for what I had in mind, "--debug on" instead of my 
> buggy --format
>
> So try:
>
> gdalinfo --config GDAL_SKIP JP2ECW,JP2MrSID --debug on FILENAME.jp2
>
> > I can't help but notice the block size and overview levels are reporting
>
> > different info compared to the JP2ECW output
>
> Yes, the various JPEG2000 driver have different logic (or 
> arbitrariness...) to decide the block size. For the JP2OpenJPEG 
> driver, 1024x1024 is either because it is the JPEG2000 tile size or as 
> an arbitrary block size for a single tiled image. The --debug on will 
> output lower level info.
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>


From even.rouault at spatialys.com  Sun Aug  9 07:46:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 09 Aug 2020 16:46:55 +0200
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <01f2371c-7a6e-4ee3-856a-e00f0daa14ca@lightpear.com>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <4026341.AXfa6lVJvu@even-i700>
 <01f2371c-7a6e-4ee3-856a-e00f0daa14ca@lightpear.com>
Message-ID: <3879890.Q79EdMPzlL@even-i700>

On dimanche 9 août 2020 15:30:12 CEST Jonathan Moules wrote:
> Hi Even,
> 
> Ah, it's comma delimited. I tried spaces.
> 
> Here's the response, with with light editing to get rid of duplicate
> info (The bands are all the same). Nothing in the output with the string
> "tile".

Ah, sorry, I now see those debug traces aren't compiled in in release mode.

OK, so download
https://github.com/OSGeo/gdal/blob/master/gdal/swig/python/samples/dump_jp2.py

and run

python dump_jp2.py FILENAME.jp2 | grep Tsiz

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200809/8e82cd6f/attachment.html>

From jonathan-lists at lightpear.com  Sun Aug  9 12:34:28 2020
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Sun, 9 Aug 2020 20:34:28 +0100
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <3879890.Q79EdMPzlL@even-i700>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <4026341.AXfa6lVJvu@even-i700>
 <01f2371c-7a6e-4ee3-856a-e00f0daa14ca@lightpear.com>
 <3879890.Q79EdMPzlL@even-i700>
Message-ID: <c473e16f-29b8-33b2-f44d-1e24cfed027b@lightpear.com>

I guess this is what you want:

         <Field name="XTsiz" type="uint32">132000</Field>
         <Field name="YTsiz" type="uint32">248000</Field>

Which I'm assuming means it's not tile.

On 2020-08-09 15:46, Even Rouault wrote:
>
> On dimanche 9 août 2020 15:30:12 CEST Jonathan Moules wrote:
>
> > Hi Even,
>
> >
>
> > Ah, it's comma delimited. I tried spaces.
>
> >
>
> > Here's the response, with with light editing to get rid of duplicate
>
> > info (The bands are all the same). Nothing in the output with the string
>
> > "tile".
>
> Ah, sorry, I now see those debug traces aren't compiled in in release 
> mode.
>
> OK, so download
>
> https://github.com/OSGeo/gdal/blob/master/gdal/swig/python/samples/dump_jp2.py
>
> and run
>
> python dump_jp2.py FILENAME.jp2 | grep Tsiz
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>


From g.jaegy at imagine3d.fr  Mon Aug 10 01:36:41 2020
From: g.jaegy at imagine3d.fr (g.jaegy)
Date: Mon, 10 Aug 2020 08:36:41 +0000
Subject: [gdal-dev] OSM issue with a relation containing all fields from its
	children
In-Reply-To: <ed21364a54cd40fdb06cde780226d609@imagine3d.fr>
References: <311d51c681dc4757886b4ac9995a8781@imagine3d.fr>
 <ed21364a54cd40fdb06cde780226d609@imagine3d.fr>
Message-ID: <a1da524a91d54ea6adf0c9c23de0029b@imagine3d.fr>

Hi,

I'm not sure that the place to post support/bug report requests, so please excuse me if it's not the case.

I'm basically using GDAL/OGR to parse OSM files. I want to extract specific features, such as river and lakes.

I'm experiencing some issue with a specific relation.

The file (10MB) is available at the following url : http://www.imagine3d.fr/_temp/relation_8601362.osm


The relation is #8601362, see  https://www.openstreetmap.org/relation/8601362.

This relation has two members, #24338289 which is indeed a lake, and #532474841 which is not a lake.

However, when parsing that with GDAL, the relation is exported as multipolygon, with two polygons, however, the multipolygon feature contains the fields of the lake (natural=water, water=lake), while the relation itself should only contain type=boundary.

Any idea how I could fix this ?

I've uploaded a screenshot showing the issue when opened in in QGIS: http://www.imagine3d.fr/_temp/gdal_osm_02.jpg

Thanks a lot !

Regards,
Gregory




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200810/4e0c4680/attachment.html>

From sebastic at xs4all.nl  Mon Aug 10 03:07:01 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Mon, 10 Aug 2020 12:07:01 +0200
Subject: [gdal-dev] OSM issue with a relation containing all fields from
 its children
In-Reply-To: <a1da524a91d54ea6adf0c9c23de0029b@imagine3d.fr>
References: <311d51c681dc4757886b4ac9995a8781@imagine3d.fr>
 <ed21364a54cd40fdb06cde780226d609@imagine3d.fr>
 <a1da524a91d54ea6adf0c9c23de0029b@imagine3d.fr>
Message-ID: <ab35464e-470f-5398-c802-e1a56b014058@xs4all.nl>

On 8/10/20 10:36 AM, g.jaegy wrote:
> The relation is #8601362, see  https://www.openstreetmap.org/relation/8601362.
> 
> This relation has two members, #24338289 which is indeed a lake, and #532474841 which is not a lake.

The relation in OSM is invalid.

type=boundary without additional tags is already a sign.

Because the outer ways in the relation have descriptive tags themselves,
the relation could be considered old-style, but that's only for
type=multipolygon.

The member relation 5462089 is also invalid, it doesn't have a type and
it has touching outer rings.

You should probably ignore relations like this in your code, but the
data in OSM should also be fixed.

I would delete relation 8601362, move the tags from relation 5462089 to
way 577387272 and merge this with way 24338289 to become one larger
closed way. Then relation 5462089 can also be removed because the close
way already represents the lake, no need for a relation with a single
outer way (since the lake doesn't appear to have islands nor islets).

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From rajeshreddy82 at gmail.com  Mon Aug 10 05:04:01 2020
From: rajeshreddy82 at gmail.com (MRRAJESH)
Date: Mon, 10 Aug 2020 05:04:01 -0700 (MST)
Subject: [gdal-dev] VRT performance Improvement
In-Reply-To: <1595957410684-0.post@n6.nabble.com>
References: <1595930232624-0.post@n6.nabble.com>
 <1595957410684-0.post@n6.nabble.com>
Message-ID: <1597061041337-0.post@n6.nabble.com>

 Rahkonen and develoeprs,

We have used GeoPackage format, it is performing well. We have one more
issue, can you suggest us

We are using VRT file as input to GDALVectorTranslate in C++. Till 18 or 19
level, we are getting tiles. When we request for multiple 20th level tiles,
we have big area features,
CPU reaching to 100% and w3wp.exe suspended (crashed). Here we are using vsi
memory buffer to store the tiles for each thread separately using UUID...
How to overcome this issue? How to handle crash?

        vsibufPath = string("/vsimem/mvt-") + GetUUID();
        vsibuf = vsibufPath.c_str();

         const char *pszFilename = "C:\\Test\\MVT.vrt";
         hSrcDS = (GDALDatasetH *)GDALOpenEx(pszFilename, GDAL_OF_READONLY,
NULL,NULL, NULL);

         dst = (GDALDataset *)GDALVectorTranslate(vsibuf, NULL, 1, &hSrcDS,
opt,NULL);

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Aug 10 06:24:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Aug 2020 15:24:07 +0200
Subject: [gdal-dev] Reading a JP2 file - obj_decode() failed
In-Reply-To: <c473e16f-29b8-33b2-f44d-1e24cfed027b@lightpear.com>
References: <33f538c4-b579-ad60-f22b-a2e0f613984b@lightpear.com>
 <3879890.Q79EdMPzlL@even-i700>
 <c473e16f-29b8-33b2-f44d-1e24cfed027b@lightpear.com>
Message-ID: <1958507.LZW8SipzqF@even-i700>

On dimanche 9 août 2020 20:34:28 CEST Jonathan Moules wrote:
> I guess this is what you want:
> 
>          <Field name="XTsiz" type="uint32">132000</Field>
>          <Field name="YTsiz" type="uint32">248000</Field>
> 
> Which I'm assuming means it's not tile.

Indeed. Do you know which libopenjp2 version is used ?
Do you read a subset of the file ? Does the file appear immediately or after a 
few successful windowed reads ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200810/0ae30a7c/attachment.html>

From Dirk.Pispers at STADT-KOELN.DE  Mon Aug 10 23:55:48 2020
From: Dirk.Pispers at STADT-KOELN.DE (Dirk.Pispers at STADT-KOELN.DE)
Date: Tue, 11 Aug 2020 06:55:48 +0000
Subject: [gdal-dev] Calling ogr2ogr via proxy with ntlm authentication
Message-ID: <2d0339b9b3984d3cadce4c82e75dab91@STADT-KOELN.DE>

Dear GDAL-List,

we're trying to use an QGIS plugin called XPlanung which imports a gml-file into a PostgreSQL/PostGIS database using ogr2ogr.
On computers with an direct internet connection this works fine, but inside our corporate network all internet traffic runs through a proxy with ntlm authentication.
In this case the external references in the input gml-file can't be resolved.

The ogr2ogr call looks like this:
cmd.exe /C  ogr2ogr.exe -f PostgreSQL PG:"host=xplanung_test dbname=xplanung_test port=5436 user=xplanung_test_admin password=xxxxxxxxxxxxxxxxx" -s_srs EPSG:25832 -t_srs EPSG:25832 -lco SCHEMA=import_test -lco LAUNDER=NO -nlt CONVERT_TO_LINEAR -oo XSD=C:\Users\Pispers\AppData\Roaming\QGIS\QGIS3\profiles\default\python\plugins\xplanung\schema\5.2/XPlanGML.xsd -oo REMOVE_UNUSED_LAYERS=YES GMLAS:C:/Eigene/QGIS/XPlanung/FooBar03.gml

I'm using GDAL 3.0.4 inside QGIS 3.10.4 an Windows 10.
In the GDAL documentation I found gdal http options like GDAL_HTTP_PROXY and GDAL_PROXY_AUTH, but I couldn't find out in what way I can integrate them in my ogr2ogr call.

I hope anyone can give me a hint or posts an example call.

Thanks and best regard fron germany

Dirk Pispers


________________________________

Monatlich aktuelle Informationen Ihrer Stadtverwaltung in unserem Newsletter! Newsletter Anmeldung<https://www.stadt-koeln.de/service/onlinedienste/newsletter-anmeldung?para=allgemein>

________________________________

[https://styleguide.bundesregierung.de/resource/blob/72496/1760346/6d7f611945ca42908c50804510c5335b/breg-vorschaubild-01-unterstuetzt-842x595px-jpg-srgb-v01-data.png]<https://www.bundesregierung.de/breg-de/themen/corona-warn-app>

[https://www.stadt-koeln.de/images/footer_wahlhelferaufruf2020.jpg]<http://www.wahlhelfer.koeln/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200811/8ced445d/attachment.html>

From tobias.wendorff at tu-dortmund.de  Tue Aug 11 00:23:59 2020
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Tue, 11 Aug 2020 09:23:59 +0200
Subject: [gdal-dev] Calling ogr2ogr via proxy with ntlm authentication
In-Reply-To: <2d0339b9b3984d3cadce4c82e75dab91@STADT-KOELN.DE>
References: <2d0339b9b3984d3cadce4c82e75dab91@STADT-KOELN.DE>
Message-ID: <74DBE754-8A86-45E3-B3F2-076EC520633A@tu-dortmund.de>

I think you can use „--config GDAL_HTTP_PROXY your-ip“ here.

-- 
Von einem iPhone gesendet und wird daher Fehler enthalten.

> Am 11.08.2020 um 09:21 schrieb <Dirk.Pispers at stadt-koeln.de> <Dirk.Pispers at stadt-koeln.de>:
> 
> ﻿
> Dear GDAL-List,
>  
> we’re trying to use an QGIS plugin called XPlanung which imports a gml-file into a PostgreSQL/PostGIS database using ogr2ogr.
> On computers with an direct internet connection this works fine, but inside our corporate network all internet traffic runs through a proxy with ntlm authentication.
> In this case the external references in the input gml-file can’t be resolved.
>  
> The ogr2ogr call looks like this:
> cmd.exe /C  ogr2ogr.exe -f PostgreSQL PG:"host=xplanung_test dbname=xplanung_test port=5436 user=xplanung_test_admin password=xxxxxxxxxxxxxxxxx" -s_srs EPSG:25832 -t_srs EPSG:25832 -lco SCHEMA=import_test -lco LAUNDER=NO -nlt CONVERT_TO_LINEAR -oo XSD=C:\Users\Pispers\AppData\Roaming\QGIS\QGIS3\profiles\default\python\plugins\xplanung\schema\5.2/XPlanGML.xsd -oo REMOVE_UNUSED_LAYERS=YES GMLAS:C:/Eigene/QGIS/XPlanung/FooBar03.gml
>  
> I’m using GDAL 3.0.4 inside QGIS 3.10.4 an Windows 10.
> In the GDAL documentation I found gdal http options like GDAL_HTTP_PROXY and GDAL_PROXY_AUTH, but I couldn’t find out in what way I can integrate them in my ogr2ogr call.
>  
> I hope anyone can give me a hint or posts an example call.
>  
> Thanks and best regard fron germany
>  
> Dirk Pispers
>  
>  
> Monatlich aktuelle Informationen Ihrer Stadtverwaltung in unserem Newsletter! Newsletter Anmeldung
> 
>  
>  
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200811/e73af3b5/attachment.html>

From xavier.culos at eau-adour-garonne.fr  Tue Aug 11 02:38:30 2020
From: xavier.culos at eau-adour-garonne.fr (CULOS)
Date: Tue, 11 Aug 2020 09:38:30 +0000
Subject: [gdal-dev] A performance issue when connecting to pg through PgPool.
Message-ID: <6871282628139F43AF102581A39AB43768CE3A88@EXMAILBOX.dag.aeag.fr>

Hi,

is this the correct list for this issue ? It is about a problem of performence which concerns the couple GDAL / PgPool.
I am posting here because our other tools (talend, php, psycopg ...) which connect to the pool do not have this problem.

A trio of servers (pool, master, slave) have been working well so far, but...

under QGis, the following script launches a simple ogr.Open.

      import osgeo.ogr as ogr
      uri = "host=pool port=5432 dbname=dbname user=user password=password"
      QgsMessageLog.logMessage("CONNECT", 'perfs', level=Qgis.Info)
      conn = ogr.Open("PG:{}".format(uri))
      QgsMessageLog.logMessage("OK", 'perfs', level=Qgis.Info)

And the result : a connection that lasts 8s.
	2020-08-11T09:53:28     INFO    CONNECT
	(.. 8s ..)
	2020-08-11T09:53:36     INFO    OK

We find this delay of 8s when opening layers (first opened) in QGis. 9/10 times.

When you connect directly to the 'master' or to the 'slave', or when the pool is connected to only one node, the connection is immediate.

The ogrinfo command has the same behavior (ogrinfo -ro PG:"host=pool port=5432 dbname=my_db schemas=a_schema tables=a_table").

The pg servers logs are very different, depending on the case.
What is happening ? do you have an idea ?


Thanks,

Xavier.


----------------- Versions  ------------
Gdal: 3.0.4  pgpool-II 4.0.9 or 4.1.2  PostgreSQL 11.7 (Debian 11.7-0+deb10u1)

---------------- LOGS ------------------
# direct connection to slave or master (no delay)
09:33:50  (57920) [20671-1]  0.108 ms, instruction : set client_encoding to 'UNICODE'
09:33:50  (57920) [20671-2]  0.319 ms, analyse <unnamed> : SELECT version()
09:33:50  (57920) [20671-3]  0.072 ms, lien <unnamed> : SELECT version()
09:33:50  (57920) [20671-4]  0.015 ms  exécute <unnamed>: SELECT version()
09:33:50  (57920) [20671-5]  0.014 ms, analyse <unnamed> : SHOW standard_conforming_strings
09:33:50  (57920) [20671-6]  0.005 ms, lien <unnamed> : SHOW standard_conforming_strings
09:33:50  (57920) [20671-7]  0.023 ms  exécute <unnamed>: SHOW standard_conforming_strings
09:33:50  (57920) [20671-8]  0.386 ms, analyse <unnamed> : SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'
09:33:50  (57920) [20671-9]  0.724 ms, lien <unnamed> : SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'
09:33:50  (57920) [20671-10]  0.052 ms  exécute <unnamed>: SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'
09:33:50  (57920) [20671-11]  0.050 ms, analyse <unnamed> : SELECT postgis_version()
09:33:50  (57920) [20671-12]  46.468 ms, lien <unnamed> : SELECT postgis_version()
09:33:50  (57920) [20671-13]  0.026 ms  exécute <unnamed>: SELECT postgis_version()
09:33:50  (57920) [20671-14]  0.036 ms, analyse <unnamed> : SET ENABLE_SEQSCAN = ON
09:33:50  (57920) [20671-15]  0.007 ms, lien <unnamed> : SET ENABLE_SEQSCAN = ON
09:33:50  (57920) [20671-16]  0.034 ms  exécute <unnamed>: SET ENABLE_SEQSCAN = ON
09:33:50  (57920) [20671-17]  2.195 ms, analyse <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:33:50  (57920) [20671-18]  2.019 ms, lien <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:33:50  (57920) [20671-19]  1.823 ms  exécute <unnamed>: SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:33:50  (57920) [20671-20]  0.138 ms, analyse <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1
09:33:50  (57920) [20671-21]  0.520 ms, lien <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1
09:33:50  (57920) [20671-22]  0.866 ms  exécute <unnamed>: SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1
09:33:50  (57920) [20671-23]  0.201 ms, analyse <unnamed> : SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:33:50  (57920) [20671-24]  0.033 ms, lien <unnamed> : SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:33:50  (57920) [20671-25]  0.005 ms  exécute <unnamed>: SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:33:50  (57920) [20671-26]  0.053 ms, analyse <unnamed> : SELECT current_schema()
09:33:50  (57920) [20671-27]  0.022 ms, lien <unnamed> : SELECT current_schema()
09:33:50  (57920) [20671-28]  0.007 ms  exécute <unnamed>: SELECT current_schema()


# connection through the 'pool' (8s)
# some requests are sent to the 'master', others to the 'slave'

# master log
09:35:06  (38174) [3076-1]  0.105 ms, instruction : set client_encoding to 'UNICODE'
09:35:06  (38174) [3076-2]  0.652 ms, analyse pgpool2087 : SELECT count(*) from (SELECT has_function_privilege('saisie_qgis', 'pg_catalog.to_regclass(cstring)', 'execute') WHERE EXISTS(SELECT * FROM pg_catalog.pg_proc AS p WHERE p.proname = 'to_regclass')) AS s
09:35:06  (38174) [3076-3]  0.649 ms, lien pgpool2087/pgpool2087 : SELECT count(*) from (SELECT has_function_privilege('saisie_qgis', 'pg_catalog.to_regclass(cstring)', 'execute') WHERE EXISTS(SELECT * FROM pg_catalog.pg_proc AS p WHERE p.proname = 'to_regclass')) AS s
09:35:06  (38174) [3076-4]  0.042 ms  exécute pgpool2087/pgpool2087: SELECT count(*) from (SELECT has_function_privilege('saisie_qgis', 'pg_catalog.to_regclass(cstring)', 'execute') WHERE EXISTS(SELECT * FROM pg_catalog.pg_proc AS p WHERE p.proname = 'to_regclass')) AS s
09:35:06  (38174) [3076-5]  0.080 ms, analyse pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.relname = 'pg_namespace'
09:35:06  (38174) [3076-6]  0.166 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.relname = 'pg_namespace'
09:35:06  (38174) [3076-7]  0.048 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.relname = 'pg_namespace'
09:35:06  (38174) [3076-8]  0.541 ms, analyse pgpool2087 : SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"pg_type"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:06  (38174) [3076-9]  0.329 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"pg_type"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:06  (38174) [3076-10]  0.028 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"pg_type"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:06  (38174) [3076-11]  0.100 ms, analyse <unnamed> : SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'
09:35:06  (38174) [3076-12]  0.327 ms, lien <unnamed> : SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'
09:35:06  (38174) [3076-13]  0.050 ms  exécute <unnamed>: SELECT oid, typname FROM pg_type WHERE typname IN ('geometry', 'geography') AND typtype='b'

09:35:08  (38174) [3076-14]  0.047 ms, analyse <unnamed> : SET ENABLE_SEQSCAN = ON
09:35:08  (38174) [3076-15]  0.028 ms, lien <unnamed> : SET ENABLE_SEQSCAN = ON
09:35:08  (38174) [3076-16]  0.032 ms  exécute <unnamed>: SET ENABLE_SEQSCAN = ON
09:35:08  (38174) [3076-17]  0.164 ms, analyse pgpool2087 : SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"tables"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:08  (38174) [3076-18]  0.426 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"tables"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:08  (38174) [3076-19]  0.019 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_class AS c, pg_namespace AS n WHERE c.oid = pg_catalog.to_regclass('"tables"') AND c.relnamespace = n.oid AND n.nspname = 'pg_catalog'
09:35:08  (38174) [3076-20]  0.131 ms, analyse pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relistemp'
09:35:08  (38174) [3076-21]  0.470 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relistemp'
09:35:08  (38174) [3076-22]  0.062 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_catalog.pg_class AS c, pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relistemp'
09:35:08  (38174) [3076-23]  0.259 ms, analyse pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_namespace AS n WHERE c.relname = 'tables' AND c.relnamespace = n.oid AND n.nspname ~ '^pg_temp_'
09:35:08  (38174) [3076-24]  0.401 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_namespace AS n WHERE c.relname = 'tables' AND c.relnamespace = n.oid AND n.nspname ~ '^pg_temp_'
09:35:08  (38174) [3076-25]  0.407 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_catalog.pg_class AS c, pg_namespace AS n WHERE c.relname = 'tables' AND c.relnamespace = n.oid AND n.nspname ~ '^pg_temp_'
09:35:08  (38174) [3076-26]  0.066 ms, analyse pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_catalog.pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relpersistence'
09:35:08  (38174) [3076-27]  0.199 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c, pg_catalog.pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relpersistence'
09:35:08  (38174) [3076-28]  0.042 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_catalog.pg_class AS c, pg_catalog.pg_attribute AS a WHERE c.relname = 'pg_class' AND a.attrelid = c.oid AND a.attname = 'relpersistence'
09:35:08  (38174) [3076-29]  0.077 ms, analyse pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.oid = pg_catalog.to_regclass('"information_schema"."tables"') AND c.relpersistence = 'u'
09:35:08  (38174) [3076-30]  0.149 ms, lien pgpool2087/pgpool2087 : SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.oid = pg_catalog.to_regclass('"information_schema"."tables"') AND c.relpersistence = 'u'
09:35:08  (38174) [3076-31]  0.021 ms  exécute pgpool2087/pgpool2087: SELECT count(*) FROM pg_catalog.pg_class AS c WHERE c.oid = pg_catalog.to_regclass('"information_schema"."tables"') AND c.relpersistence = 'u'

# slave log
09:35:06  (42560) [21079-1]  0.116 ms, instruction : set client_encoding to 'UNICODE'
09:35:06  (42560) [21079-2]  0.372 ms, analyse <unnamed> : SELECT version()
09:35:06  (42560) [21079-3]  0.067 ms, lien <unnamed> : SELECT version()
09:35:06  (42560) [21079-4]  0.050 ms  exécute <unnamed>: SELECT version()
09:35:06  (42560) [21079-5]  0.016 ms, analyse <unnamed> : SHOW standard_conforming_strings
09:35:06  (42560) [21079-6]  0.006 ms, lien <unnamed> : SHOW standard_conforming_strings
09:35:06  (42560) [21079-7]  0.019 ms  exécute <unnamed>: SHOW standard_conforming_strings
09:35:06  (42560) [21079-8]  0.116 ms, analyse <unnamed> : SELECT postgis_version()
09:35:06  (42560) [21079-9]  42.548 ms, lien <unnamed> : SELECT postgis_version()
09:35:06  (42560) [21079-10]  0.014 ms  exécute <unnamed>: SELECT postgis_version()
09:35:06  (42560) [21079-11]  0.026 ms, analyse <unnamed> : SET ENABLE_SEQSCAN = ON
09:35:06  (42560) [21079-12]  0.008 ms, lien <unnamed> : SET ENABLE_SEQSCAN = ON
09:35:06  (42560) [21079-13]  0.031 ms  exécute <unnamed>: SET ENABLE_SEQSCAN = ON

09:35:09  (42560) [21079-14]  1.559 ms, analyse <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:35:09  (42560) [21079-15]  1.363 ms, lien <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:35:09  (42560) [21079-16]  1.261 ms  exécute <unnamed>: SELECT 1 FROM information_schema.tables WHERE table_name = 'geometry_columns' LIMIT 1
09:35:09  (42560) [21079-17]  0.130 ms, analyse <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1
09:35:09  (42560) [21079-18]  0.472 ms, lien <unnamed> : SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1
09:35:09  (42560) [21079-19]  0.711 ms  exécute <unnamed>: SELECT 1 FROM information_schema.tables WHERE table_name = 'spatial_ref_sys' LIMIT 1

09:35:12  (42560) [21079-20]  0.260 ms, analyse <unnamed> : SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:35:12  (42560) [21079-21]  0.050 ms, lien <unnamed> : SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:35:12  (42560) [21079-22]  0.008 ms  exécute <unnamed>: SELECT ST_Srid('POINT EMPTY'::GEOMETRY)
09:35:12  (42560) [21079-23]  0.050 ms, analyse <unnamed> : SELECT current_schema()
09:35:12  (42560) [21079-24]  0.018 ms, lien <unnamed> : SELECT current_schema()
09:35:12  (42560) [21079-25]  0.007 ms  exécute <unnamed>: SELECT current_schema()



From xavier.culos at eau-adour-garonne.fr  Tue Aug 11 05:58:08 2020
From: xavier.culos at eau-adour-garonne.fr (CULOS)
Date: Tue, 11 Aug 2020 12:58:08 +0000
Subject: [gdal-dev] A performance issue when connecting to pg through
	PgPool.
In-Reply-To: <6871282628139F43AF102581A39AB43768CE3A88@EXMAILBOX.dag.aeag.fr>
References: <6871282628139F43AF102581A39AB43768CE3A88@EXMAILBOX.dag.aeag.fr>
Message-ID: <6871282628139F43AF102581A39AB43768CE3ADF@EXMAILBOX.dag.aeag.fr>

a solution which seems to work: quite simply to use the variables PRELUDE_STATEMENTS, CLOSING_STATEMENTS.

The gdal doc mentions pg_bouncer, pgpool looks like it..

For QGis, add the following lines to the .env file:
   PRELUDE_STATEMENTS = "BEGIN;"
   CLOSING_STATEMENTS = "COMMIT;"

and to the .vars file:
   PRELUDE_STATEMENTS
   CLOSING_STATEMENTS

From Pyhon, : 
  gdal.SetConfigOption("PRELUDE_STATEMENTS", "BEGIN;")
  gdal.SetConfigOption("CLOSING_STATEMENTS", "COMMIT;")


do you confirm this?


-----Message d'origine-----
De : gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de CULOS
Envoyé : mardi 11 août 2020 11:39
À : 'gdal-dev at lists.osgeo.org'
Objet : [gdal-dev] A performance issue when connecting to pg through PgPool.

Hi,

is this the correct list for this issue ? It is about a problem of performence which concerns the couple GDAL / PgPool.
I am posting here because our other tools (talend, php, psycopg ...) which connect to the pool do not have this problem.

A trio of servers (pool, master, slave) have been working well so far, but...

under QGis, the following script launches a simple ogr.Open.

      import osgeo.ogr as ogr
      uri = "host=pool port=5432 dbname=dbname user=user password=password"
      QgsMessageLog.logMessage("CONNECT", 'perfs', level=Qgis.Info)
      conn = ogr.Open("PG:{}".format(uri))
      QgsMessageLog.logMessage("OK", 'perfs', level=Qgis.Info)

And the result : a connection that lasts 8s.
	2020-08-11T09:53:28     INFO    CONNECT
	(.. 8s ..)
	2020-08-11T09:53:36     INFO    OK

We find this delay of 8s when opening layers (first opened) in QGis. 9/10 times.

When you connect directly to the 'master' or to the 'slave', or when the pool is connected to only one node, the connection is immediate.

The ogrinfo command has the same behavior (ogrinfo -ro PG:"host=pool port=5432 dbname=my_db schemas=a_schema tables=a_table").

The pg servers logs are very different, depending on the case.
What is happening ? do you have an idea ?


Thanks,

Xavier.


From rajeshreddy82 at gmail.com  Tue Aug 11 09:59:25 2020
From: rajeshreddy82 at gmail.com (MRRAJESH)
Date: Tue, 11 Aug 2020 09:59:25 -0700 (MST)
Subject: [gdal-dev] clipping a vector with gdal.VectorTranslate
Message-ID: <1597165165310-0.post@n6.nabble.com>

Developers,

I am trying to set the "-clipsrc" in multiple ways in C# and C++, getting
"cannot load source clip geometry" error. Anything wrong here?

Ogr2ogr it is working fine (ogr2ogr -clipsrc
-9943693.00823441,5321545.9084732,-9943540.13417786,5321393.03441666 -f MVT
.......)

      "-dsco", "FORMAT=DIRECTORY",
      "-dsco", "TILE_EXTENSION=mvt",
      "-dsco", "COMPRESS=NO",
      "-dsco", "MINZOOM=18",
      "-dsco", "MAXZOOM=18",
      "-clipsrc",
"-9943693.00823441,5321545.9084732,-9943540.13417786,5321393.03441666"

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Tue Aug 11 10:54:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Aug 2020 19:54:55 +0200
Subject: [gdal-dev] clipping a vector with gdal.VectorTranslate
In-Reply-To: <1597165165310-0.post@n6.nabble.com>
References: <1597165165310-0.post@n6.nabble.com>
Message-ID: <7296721.8NN8qxMxFE@even-i700>

On mardi 11 août 2020 09:59:25 CEST MRRAJESH wrote:
> Developers,
> 
> I am trying to set the "-clipsrc" in multiple ways in C# and C++, getting
> "cannot load source clip geometry" error. Anything wrong here?
> 
> Ogr2ogr it is working fine (ogr2ogr -clipsrc
> -9943693.00823441,5321545.9084732,-9943540.13417786,5321393.03441666 -f MVT
> .......)

The doc indicates space separated values. I'm not sure why the above would work

> 
>       "-dsco", "FORMAT=DIRECTORY",
>       "-dsco", "TILE_EXTENSION=mvt",
>       "-dsco", "COMPRESS=NO",
>       "-dsco", "MINZOOM=18",
>       "-dsco", "MAXZOOM=18",
>       "-clipsrc",
> "-9943693.00823441,5321545.9084732,-9943540.13417786,5321393.03441666"

"-clipsrc",
"-9943693.00823441",
"5321545.9084732","
-9943540.13417786",
"5321393.03441666"


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200811/b2bb48d0/attachment.html>

From rajeshreddy82 at gmail.com  Tue Aug 11 11:26:42 2020
From: rajeshreddy82 at gmail.com (MRRAJESH)
Date: Tue, 11 Aug 2020 11:26:42 -0700 (MST)
Subject: [gdal-dev] clipping a vector with gdal.VectorTranslate
In-Reply-To: <7296721.8NN8qxMxFE@even-i700>
References: <1597165165310-0.post@n6.nabble.com> <7296721.8NN8qxMxFE@even-i700>
Message-ID: <1597170402728-0.post@n6.nabble.com>

You are right, its mistake from my end.

spaces should be there (ogr2ogr -clipsrc -9943695.99544 5321548.895035
-9943537.149741 5321390.049336 -f MVT....)

"-clipsrc" in C# is working fine with your code snippet.

Thanks.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From kelian.devillier at gmail.com  Wed Aug 12 05:58:01 2020
From: kelian.devillier at gmail.com (=?UTF-8?Q?K=C3=A9lian_Devillier?=)
Date: Wed, 12 Aug 2020 14:58:01 +0200
Subject: [gdal-dev] PDF generation on Linux
Message-ID: <CAGi2HFcBOdD0KT_xivm1QPZzLaamgvRh111_ojtw_gOiPWrgiA@mail.gmail.com>

Hello,

I'm trying to work with GeospatialPDF generation from an XML file on Linux.

Using Ubuntu 18.04, I compiled the sources from version 3.0.4 myself.

Unfortunately, when I tried to execute the Python script with my xml, I got
the following message :
ERROR 6: PDF node not supported due to PDF read support in this GDAL build

Is it due to the fact that I don't have any PDF viewer capable of reading
GeospatialPDF installed ?
And if that is the case, is there any way of bypassing the error, given
that I can just transfer the file to a Windows system to read it.

Thanks in advance.

Kélian D.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200812/7b715ef9/attachment.html>

From andrew at aitchison.me.uk  Wed Aug 12 06:53:41 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 12 Aug 2020 14:53:41 +0100 (BST)
Subject: [gdal-dev] PDF generation on Linux
In-Reply-To: <CAGi2HFcBOdD0KT_xivm1QPZzLaamgvRh111_ojtw_gOiPWrgiA@mail.gmail.com>
References: <CAGi2HFcBOdD0KT_xivm1QPZzLaamgvRh111_ojtw_gOiPWrgiA@mail.gmail.com>
Message-ID: <alpine.DEB.2.23.453.2008121442460.743993@warden.aitchison.me.uk>

On Wed, 12 Aug 2020, Kélian Devillier wrote:

> Hello,
>
> I'm trying to work with GeospatialPDF generation from an XML file on Linux.
>
> Using Ubuntu 18.04, I compiled the sources from version 3.0.4 myself.
>
> Unfortunately, when I tried to execute the Python script with my xml, I got
> the following message :
> ERROR 6: PDF node not supported due to PDF read support in this GDAL build
>
> Is it due to the fact that I don't have any PDF viewer capable of reading
> GeospatialPDF installed ?

No.

> And if that is the case, is there any way of bypassing the error, given
> that I can just transfer the file to a Windows system to read it.

What do
 	gdalinfo --formats |& grep -i pdf
and
 	ogrinfo --formats |& grep -i pdf
report ?
Does the system gdalinfo or ogrinfo (v2.?? IIRC) give a different answer ?

Did you include any of the configure options
 	--with-poppler=...
 	--with-podofo=...
 	--with-pdfium=...
 	--disable-driver-pdf
 	--enable-pdf-plugin
when you built gdal ?
The --with-... options may require a suitable path to the library.

I'm not sure whether all of these have PDF write support.


-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From even.rouault at spatialys.com  Wed Aug 12 09:51:20 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Aug 2020 18:51:20 +0200
Subject: [gdal-dev] PDF generation on Linux
In-Reply-To: <alpine.DEB.2.23.453.2008121442460.743993@warden.aitchison.me.uk>
References: <CAGi2HFcBOdD0KT_xivm1QPZzLaamgvRh111_ojtw_gOiPWrgiA@mail.gmail.com>
 <alpine.DEB.2.23.453.2008121442460.743993@warden.aitchison.me.uk>
Message-ID: <2231401.vA5p8K4BFc@even-i700>

On mercredi 12 août 2020 14:53:41 CEST Andrew C Aitchison wrote:
> On Wed, 12 Aug 2020, Kélian Devillier wrote:
> > Hello,
> > 
> > I'm trying to work with GeospatialPDF generation from an XML file on
> > Linux.
> > 
> > Using Ubuntu 18.04, I compiled the sources from version 3.0.4 myself.
> > 
> > Unfortunately, when I tried to execute the Python script with my xml, I
> > got
> > the following message :
> > ERROR 6: PDF node not supported due to PDF read support in this GDAL build
> > 
> > Is it due to the fact that I don't have any PDF viewer capable of reading
> > GeospatialPDF installed ?

I'd suggest installing the libpoppler-private-dev package from apt, and then building GDAL 
with ./configure --with-poppler
Make sure to "make clean" before building again.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200812/3b51ad98/attachment.html>

From richard.greenwood at gmail.com  Wed Aug 12 12:59:03 2020
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Wed, 12 Aug 2020 13:59:03 -0600
Subject: [gdal-dev] incorrect coordinate system with ogr2ogr -f "MapInfo
	file"
Message-ID: <CAHBySPaUzwfQ-MVuehULZM9UQkqpmCFW_TKneYnf_Bg1fcvBOw@mail.gmail.com>

I recently upgraded to gdal 3.0 and 3.1 on two computers. When using
ogr2ogr to create MapInfo files the coordinate system of the resulting
MapInfo files is incorrect. The coordinate system is epsg:3739 which uses
US Survey Feet. I used MapInfo to convert the native binary file to
MapInfo's external ASCII format to be able to see the coordinate system
definition. With gdal <3.0 the correct MapInfo definition is:
CoordSys Earth Projection 8, 74, "survey ft", -110.083333333333, 40.5,
0.9999375, 2624666.6666999999, 328083.3333 Bounds (-30000000, -15000000)
(30000000, 15000000)
With gdal 3.0 and 3.1 it is:
CoordSys Earth Projection 8, 74, "m", -110.083333333333, 40.5, 0.9999375,
2624666.6666999999, 328083.3333 Bounds (-27375333.3333, -14671916.6667)
(32624666.6667, 15328083.3333)

I'm running gdal on Linux, gdal 3.0 with proj 6.3 from the Ubuntu 20.04
distribution and gdal 3.1 with proj 7.1 built from source. Any suggestions
for other things to look at? I'm happy to dig into this more if anyone has
suggestions.

Thanks,
Rich

-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200812/2fc5e731/attachment.html>

From even.rouault at spatialys.com  Wed Aug 12 14:03:10 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Aug 2020 23:03:10 +0200
Subject: [gdal-dev] incorrect coordinate system with ogr2ogr -f "MapInfo
	file"
In-Reply-To: <CAHBySPaUzwfQ-MVuehULZM9UQkqpmCFW_TKneYnf_Bg1fcvBOw@mail.gmail.com>
References: <CAHBySPaUzwfQ-MVuehULZM9UQkqpmCFW_TKneYnf_Bg1fcvBOw@mail.gmail.com>
Message-ID: <4099269.mxmDbl6Y3G@even-i700>

On mercredi 12 août 2020 13:59:03 CEST Richard Greenwood wrote:
> I recently upgraded to gdal 3.0 and 3.1 on two computers. When using
> ogr2ogr to create MapInfo files the coordinate system of the resulting
> MapInfo files is incorrect. The coordinate system is epsg:3739 which uses
> US Survey Feet. I used MapInfo to convert the native binary file to
> MapInfo's external ASCII format to be able to see the coordinate system
> definition. With gdal <3.0 the correct MapInfo definition is:
> CoordSys Earth Projection 8, 74, "survey ft", -110.083333333333, 40.5,
> 0.9999375, 2624666.6666999999, 328083.3333 Bounds (-30000000, -15000000)
> (30000000, 15000000)
> With gdal 3.0 and 3.1 it is:
> CoordSys Earth Projection 8, 74, "m", -110.083333333333, 40.5, 0.9999375,
> 2624666.6666999999, 328083.3333 Bounds (-27375333.3333, -14671916.6667)
> (32624666.6667, 15328083.3333)
> 
> I'm running gdal on Linux, gdal 3.0 with proj 6.3 from the Ubuntu 20.04
> distribution and gdal 3.1 with proj 7.1 built from source. Any suggestions
> for other things to look at? I'm happy to dig into this more if anyone has
> suggestions.

Issue confirmed. I've just fixed in master and 3.1 branches

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200812/f6dbc81e/attachment.html>

From e.plassot at laposte.net  Wed Aug 12 14:25:24 2020
From: e.plassot at laposte.net (Eric Plassot)
Date: Wed, 12 Aug 2020 23:25:24 +0200
Subject: [gdal-dev] handle succes or failures with ogr2ogr
In-Reply-To: <d5251851-8b02-6291-67cf-36ea5830adda@laposte.net>
References: <d5251851-8b02-6291-67cf-36ea5830adda@laposte.net>
Message-ID: <aa2b6e1a-5851-e534-e0b5-e37bb854472a@laposte.net>

Hi,

I pass a command line in a batch and I would like to write the result in 
a text file to know if the multipolygon has been added.
here is what i tried :
"C:\Program Files\QGIS 2.18\OSGeo4W.bat" ogr2ogr.exe -f "PostgreSQL" 
PG:"host=xx.xxx.x.x user=xxx dbname=xxx schemas=xxx password=xx" -t_srs 
EPSG:2154 -append -nlt PROMOTE_TO_MULTI "kmlPath.kml" > "logPath.txt"

the log only contains OSGEO4W home is C: \ Program Files \ QGIS 2.18 \ 
and no more information
What can I do please to get this ?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200812/e1c1f687/attachment.html>

From g.jaegy at imagine3d.fr  Thu Aug 13 00:51:56 2020
From: g.jaegy at imagine3d.fr (g.jaegy)
Date: Thu, 13 Aug 2020 07:51:56 +0000
Subject: [gdal-dev] OSM issue with a relation containing all fields from its
	children
Message-ID: <3ea4d95cf30547bab0d2189501d40190@imagine3d.fr>

> The relation in OSM is invalid.

Thanks a lot for your answer. This is indeed what I thought, the lake is not related to the boundary in any way.


> The member relation 5462089 is also invalid, it doesn't have a type and

it has touching outer rings.



You should probably ignore relations like this in your code, but the

data in OSM should also be fixed.

The issue is that I need to extract all lakes from that dataset, ignoring the relation basically leads to the lake missing in the final result (5462089).

I'm not familiar with modifying OSM data, so I don't think that's something I could achieve at my level.

My point was to mention the fact that the lake 24338289 is being exposed by GDAL OSM driver as being part of the relation 8601362 only, but also that its attributes are fully lost during the reading process. So right now I have no way of detecting and filtering in that lake polygon. Not sure there is a way I can fix that issue, and support that data even if it's invalid ? Do I have any option other than waiting for the OSM database to be fixed ?

Thanks a lot !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200813/a37ab686/attachment.html>

From kmskavi at gmail.com  Thu Aug 13 05:00:32 2020
From: kmskavi at gmail.com (Kavitha K)
Date: Thu, 13 Aug 2020 17:30:32 +0530
Subject: [gdal-dev] https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries
 not updated for gdal 3.1.2 for RHEL install
Message-ID: <CACLbJJd5_F=Mk7W6o6v1H+EFc3OGS4+ad2=hiC8B30DXpKsZ5Q@mail.gmail.com>

Hi All,

We are looking for Gdal latest version 3.1.2 for RHEL.

https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries  not updated for
gdal  3.1.2 for RHEL install

This link is specified with "
Enterprise Linux GIS (ELGIS)
<https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries#EnterpriseLinuxGISELGIS>

The ELGIS <http://elgis.argeo.org/> effort provides RPMs of various GIS
applications for Enterprise Linux and derivatives (RHEL, CentOS, Scientific
Linux).
"
But the ELGIS link is missing with latest version under this description.
RHEL/CentOS/SL 6Stable

   - EL GIS 6 : x86_64
   <http://elgis.argeo.org/repos/6/elgis/x86_64/repoview/> i386
   <http://elgis.argeo.org/repos/6/elgis/i386/repoview/> sources
   <http://elgis.argeo.org/repos/6/elgis/SRPMS/repoview/>

kindly update this one.

One added suggestion: If there is dependency for the latest gdal version,
kindly include those dependency download location and detailed installation
procedure in RHEL.

Our OS is RHEL 7

Thanks,
Kavitha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200813/d4b644c3/attachment-0001.html>

From kmskavi at gmail.com  Thu Aug 13 05:08:05 2020
From: kmskavi at gmail.com (Kavitha K)
Date: Thu, 13 Aug 2020 17:38:05 +0530
Subject: [gdal-dev] gdal 3.1.2 installation in RHEL 7 ,
 stuck with dependency installation. kindly help
Message-ID: <CACLbJJcVwuOH6y8i61QGoukbcMF3QhOExJEPM7ynwx82uhL0cg@mail.gmail.com>

Hi All,
export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig

Step 1: gdal 3.1.2
[root at test-22 gdal-3.1.2]# ./configure
configure: Bash completions not requested
checking for PROJ >= 6 library... checking for proj_create_from_wkt in
-lproj... no
checking for internal_proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -linternalproj... no
configure: error: PROJ 6 symbols not found

  Step 2:    PROJ 6
[root at test-22 proj-6.3.2]#
checking for pkg-config... /usr/local/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for SQLITE3... configure: error: Package requirements (sqlite3 >=
3.11) were not met:

No package 'sqlite3' found

Consider adjusting the PKG_CONFIG_PATH environment variable if you
installed software in a non-standard prefix.

Alternatively, you may set the environment variables SQLITE3_CFLAGS
and SQLITE3_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details.

Step 3:
[root at pi-22 gdalDevKits]# pwd
/root/gdalDevKits
[root at pi-22 gdalDevKits]# ls |grep sql
sqlite-tools-linux-x86-3320300
sqlite-tools-linux-x86-3320300.zip
[root at pi-22 gdalDevKits]# cd sqlite-tools-linux-x86-3320300
[root at pi-22 sqlite-tools-linux-x86-3320300]# ls
sqldiff  sqlite3  sqlite3_analyzer
[root at pi-22 sqlite-tools-linux-x86-3320300]# cd /usr/local/bin
[root at pi-22 bin]# ls |grep sql
sqldiff
sqlite3
sqlite3_analyzer
[root at pi-22 bin]# pwd
/usr/local/bin
[root at pi-22 bin]# cd /usr/local/lib
[root at pi-22 lib]# ls | grep pk
pkgconfig
[root at pi-22 lib]#

Step 4:
Still we are hitting " No package 'sqlite3' found" while installing the
proj6

Kindly help.

Thanks,
Kavitha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200813/efdb422e/attachment.html>

From mateusz at loskot.net  Thu Aug 13 05:46:58 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 13 Aug 2020 14:46:58 +0200
Subject: [gdal-dev]
 https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries not updated for
 gdal 3.1.2 for RHEL install
In-Reply-To: <CACLbJJd5_F=Mk7W6o6v1H+EFc3OGS4+ad2=hiC8B30DXpKsZ5Q@mail.gmail.com>
References: <CACLbJJd5_F=Mk7W6o6v1H+EFc3OGS4+ad2=hiC8B30DXpKsZ5Q@mail.gmail.com>
Message-ID: <CABUeae-764vEpkcDT-zoSQ5kSxacWWq_kfPBYM+Rfi_2WeSYjA@mail.gmail.com>

On Thu, 13 Aug 2020 at 14:00, Kavitha K <kmskavi at gmail.com> wrote:
>
> But the ELGIS link is missing with latest version under this description.
>
> One added suggestion: If there is dependency for the latest gdal version, kindly include those dependency download location and detailed installation procedure in RHEL.

GDAL maintainers do not maintain (or are responsible for) binary
packages of GDAL.
Direct your questions/suggestions to
https://lists.osgeo.org/mailman/listinfo/el
Check this too https://wiki.osgeo.org/wiki/Enterprise_Linux_GIS

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Thu Aug 13 05:49:40 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 13 Aug 2020 14:49:40 +0200
Subject: [gdal-dev] gdal 3.1.2 installation in RHEL 7 ,
 stuck with dependency installation. kindly help
In-Reply-To: <CACLbJJcVwuOH6y8i61QGoukbcMF3QhOExJEPM7ynwx82uhL0cg@mail.gmail.com>
References: <CACLbJJcVwuOH6y8i61QGoukbcMF3QhOExJEPM7ynwx82uhL0cg@mail.gmail.com>
Message-ID: <CABUeae9qwVOFwJ6oxNO75bBkN9b9XJdCC8vLki9Xy6HWdVPwWg@mail.gmail.com>

On Thu, 13 Aug 2020 at 14:08, Kavitha K <kmskavi at gmail.com> wrote:
> checking for SQLITE3... configure: error: Package requirements (sqlite3 >= 3.11) were not met:
>
> No package 'sqlite3' found
>
> Consider adjusting the PKG_CONFIG_PATH environment variable if you
> installed software in a non-standard prefix.
>
> Alternatively, you may set the environment variables SQLITE3_CFLAGS
> and SQLITE3_LIBS to avoid the need to call pkg-config.
> See the pkg-config man page for more details.
> [...]
> [root at pi-22 sqlite-tools-linux-x86-3320300]# cd /usr/local/bin
> [root at pi-22 bin]# ls |grep sql
> sqldiff
> sqlite3
> sqlite3_analyzer

You need SQLite development package, with header(s) and library,
not just SQLite executable program(s).

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From kmskavi at gmail.com  Thu Aug 13 11:59:02 2020
From: kmskavi at gmail.com (Kavitha K)
Date: Fri, 14 Aug 2020 00:29:02 +0530
Subject: [gdal-dev] GDAL 3.1.2 whether supported the binary distribution for
 Red Hat Enterprise Linux 7
Message-ID: <CACLbJJc2KnHxiBxR4M_GPko28SDD1XPGCZA_CH+j3dLGPAHNMg@mail.gmail.com>

Hi All,
please confirm
GDAL 3.1.2 whether supported the binary distribution for Red Hat Enterprise
Linux 7

if yes, kindly share us the download location

Thanks,
Kavitha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200814/d34d4ee0/attachment.html>

From neteler at osgeo.org  Fri Aug 14 01:53:12 2020
From: neteler at osgeo.org (Markus Neteler)
Date: Fri, 14 Aug 2020 10:53:12 +0200
Subject: [gdal-dev] GDAL 3.1.2 whether supported the binary distribution
 for Red Hat Enterprise Linux 7
In-Reply-To: <CACLbJJc2KnHxiBxR4M_GPko28SDD1XPGCZA_CH+j3dLGPAHNMg@mail.gmail.com>
References: <CACLbJJc2KnHxiBxR4M_GPko28SDD1XPGCZA_CH+j3dLGPAHNMg@mail.gmail.com>
Message-ID: <CALFmHhuLALO2X4tX3QEj0V1819ew_3hHRsvwe+4paUfEzDkaLA@mail.gmail.com>

On Thu, Aug 13, 2020 at 8:59 PM Kavitha K <kmskavi at gmail.com> wrote:
>
> Hi All,
> please confirm
> GDAL 3.1.2 whether supported the binary distribution for Red Hat Enterprise Linux 7
>
> if yes, kindly share us the download location

In Fedora, frequently EPEL packages are made available as well:

https://src.fedoraproject.org/rpms/gdal/

However, currently it is gdal-3.0.4-5.el8 for EPEL 8.
The version for EPEL 7 isn't there because a volunteer needs to create
a compat package first (anyone?).

For Red Hat Enterprise, please contact their support.

Regards,
Markus

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug 17 02:42:15 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 17 Aug 2020 09:42:15 +0000
Subject: [gdal-dev] Rotation not found from ENVI header
Message-ID: <c2f16c83cfaf45efb6e42231fee1b561@C119S212VM042.msvyvi.vaha.local>

Hi,

See https://gis.stackexchange.com/questions/371579/geotiff-to-envi-gdal-translation-causes-rotation

I verified that GDAL 3.2.0dev gives an error for the test image "Warning 1: Geotransform matrix has non rotational terms".  However, the ENVI header has a line
map info = {Transverse Mercator, 1, 1, 32371999.5, 5679999.5, 1.95121951219512, 1.95121951219512, rotation=90}

Rotation is handled in https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/envidataset.cpp#L632 and it is tested in this autotest https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/envi.py#L312

In the data used for the test https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/data/envi/rotation.hdr the rotation appears on the last line
map info = { UTM , 1.000 , 1.000 , 736600.089 , 4078126.750 , 2.7000000000e+00 , 2.7000000000e+00 , 12 , North , WGS-84 , units=Meters , rotation=-66.00000000 }

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/3395a2ad/attachment.html>

From even.rouault at spatialys.com  Mon Aug 17 04:35:46 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Aug 2020 13:35:46 +0200
Subject: [gdal-dev] Rotation not found from ENVI header
In-Reply-To: <c2f16c83cfaf45efb6e42231fee1b561@C119S212VM042.msvyvi.vaha.local>
References: <c2f16c83cfaf45efb6e42231fee1b561@C119S212VM042.msvyvi.vaha.local>
Message-ID: <33288384.6zV2chKINQ@even-i700>

On lundi 17 août 2020 09:42:15 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> See
> https://gis.stackexchange.com/questions/371579/geotiff-to-envi-gdal-transla
> tion-causes-rotation
> 
> I verified that GDAL 3.2.0dev gives an error for the test image "Warning 1:
> Geotransform matrix has non rotational terms".  However, the ENVI header
> has a line map info = {Transverse Mercator, 1, 1, 32371999.5, 5679999.5,
> 1.95121951219512, 1.95121951219512, rotation=90}
> 
> Rotation is handled in
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/envidataset.cpp#L6
> 32 and it is tested in this autotest
> https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/envi.py#L312
> 
> In the data used for the test
> https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/data/envi/rotat
> ion.hdr the rotation appears on the last line map info = { UTM , 1.000 ,
> 1.000 , 736600.089 , 4078126.750 , 2.7000000000e+00 , 2.7000000000e+00 , 12
> , North , WGS-84 , units=Meters , rotation=-66.00000000 }

I've just fixed the issue. Was specific to south-up images / rotation=180

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/dbbc886c/attachment.html>

From j1 at jimenezshaw.com  Mon Aug 17 06:33:19 2020
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 17 Aug 2020 15:33:19 +0200
Subject: [gdal-dev] Usage of GDA_DATA in GDAL3
Message-ID: <CADRrdKsj3Wj42BtOEgTO27bhPyUSaiaihakJMFxFjchKWGk6uQ@mail.gmail.com>

Hi

When I was using GDAL2 (from C++), I had to set the GDAL_DATA variable with
something like
CPLSetConfigOption("GDAL_DATA", gdalDataPath.c_str());
to be able to use the SRS functions (using different coordinate reference
systems).

Now with GDAL3 (and PROJ7) I have to set instead the location of proj.db
with OSRSetPROJSearchPaths(...)

Do I need "GDAL_DATA" for anything else in GDAL3 ?

Thanks
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/d98da708/attachment.html>

From j1 at jimenezshaw.com  Mon Aug 17 09:07:07 2020
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 17 Aug 2020 18:07:07 +0200
Subject: [gdal-dev] OSRGetPROJSearchPaths unexpected behaviour
Message-ID: <CADRrdKvG4=+ZZxXoe1RbvsaPFwx1xXGZWYnM-wrY1QrDCrh4Sg@mail.gmail.com>

Hi

I have been using OSRSetPROJSearchPaths so far.
Now, to test if "anybody" changed those paths (like another library), I am
calling OSRGetPROJSearchPaths. However, even if I call one after the other,
I get something different from OSRGetPROJSearchPaths.

I guess OSRGetPROJSearchPaths is getting the data from proj_info, that
calls pj_get_default_ctx. So it is not updated with the data I set in
OSRSetPROJSearchPaths. Is that the case? If yes, is it intentional? I was
expecting exactly the values I had set one line above with
OSRSetPROJSearchPaths.

Thanks,
Javier
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/3e7635b9/attachment.html>

From even.rouault at spatialys.com  Mon Aug 17 10:17:15 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Aug 2020 19:17:15 +0200
Subject: [gdal-dev] OSRGetPROJSearchPaths unexpected behaviour
In-Reply-To: <CADRrdKvG4=+ZZxXoe1RbvsaPFwx1xXGZWYnM-wrY1QrDCrh4Sg@mail.gmail.com>
References: <CADRrdKvG4=+ZZxXoe1RbvsaPFwx1xXGZWYnM-wrY1QrDCrh4Sg@mail.gmail.com>
Message-ID: <2360182.Pp8fd7VioN@even-i700>

Javier,

> I have been using OSRSetPROJSearchPaths so far.
> Now, to test if "anybody" changed those paths (like another library), I am
> calling OSRGetPROJSearchPaths.

After the first call to OSRSetPROJSearchPaths(), other libraries cannot
mess up with the search paths set through GDAL since GDAL uses dedicated
PROJ contexts that use the value set by OSRSetPROJSearchPaths(),
so changing the paths of the default PROJ context will have no influence.

> However, even if I call one after the other,
> I get something different from OSRGetPROJSearchPaths.
> 
> I guess OSRGetPROJSearchPaths is getting the data from proj_info, that
> calls pj_get_default_ctx. So it is not updated with the data I set in
> OSRSetPROJSearchPaths. Is that the case? 

Correct

> If yes, is it intentional? I was
> expecting exactly the values I had set one line above with
> OSRSetPROJSearchPaths.

No not really intentional.
Fixed per https://github.com/OSGeo/gdal/commit/bf8355a7a29ade1d5fd60924c367c763dc27bd90

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/a638f75e/attachment-0001.html>

From robin at rtwilson.com  Mon Aug 17 11:54:12 2020
From: robin at rtwilson.com (Robin Wilson)
Date: Mon, 17 Aug 2020 19:54:12 +0100
Subject: [gdal-dev] Can you create a GeoPDF from an XML Composition File
 using the command-line tools?
Message-ID: <etPan.5f3ad254.271a6e0e.6cd8@rtwilson.com>

Hi,

I have successfully created an XML Composition File as documented at https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0, and created a GeoPDF from it using the gdal_create_pdf.py file (from https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/swig/python/samples/gdal_create_pdf.py).

However, for my particular application, it would be really useful to be able to create the PDF using the standard GDAL command-line tools (gdal_translate and so on), as we would rather not require Python on the system that we're deploying to.

Is there any way of creating a PDF from a composition XML file using just the standard command-line tools? The documentation states "The GDALCreate() API must be used with width = height = bands = 0 and datatype = GDT_Unknown and COMPOSITION_FILE must be the single creation option.", and I've tried playing with the options to various commands such as gdal_translate, but can't seem to get it to work. Is it possible?

Best regards,

Robin

Dr Robin Wilson
www.rtwilson.com



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/37a7da59/attachment.html>

From even.rouault at spatialys.com  Mon Aug 17 12:38:33 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Aug 2020 21:38:33 +0200
Subject: [gdal-dev] Can you create a GeoPDF from an XML Composition File
	using the command-line tools?
In-Reply-To: <etPan.5f3ad254.271a6e0e.6cd8@rtwilson.com>
References: <etPan.5f3ad254.271a6e0e.6cd8@rtwilson.com>
Message-ID: <10052099.LN9lyAI78F@even-i700>

Robin,

> I have successfully created an XML Composition File as documented
> at https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml
> -composition-file-gdal-3-0, and created a GeoPDF from it using the
> gdal_create_pdf.py file
> (from https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/swig/python/
> samples/gdal_create_pdf.py).
> 
> However, for my particular application, it would be really useful to be able
> to create the PDF using the standard GDAL command-line tools
> (gdal_translate and so on), as we would rather not require Python on the
> system that we're deploying to.
> 
> Is there any way of creating a PDF from a composition XML file using just
> the standard command-line tools? The documentation states "The GDALCreate()
> API must be used with width = height = bands = 0 and datatype = GDT_Unknown
> and COMPOSITION_FILE must be the single creation option.", and I've tried
> playing with the options to various commands such as gdal_translate, but
> can't seem to get it to work. Is it possible?

No, I don't think existing C/C++ based command line utilities will do, but you should be able 
to trivially convert gdal_create_pdf.py to C/C++ using GDALCreate()

See https://gdal.org/tutorials/raster_api_tut.html#using-create

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/ae6de939/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug 17 13:44:35 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 17 Aug 2020 20:44:35 +0000
Subject: [gdal-dev] Rotation not found from ENVI header
Message-ID: <5b8f297a64dd4f4a9c72a3659dc49d45@C119S212VM042.msvyvi.vaha.local>

Hi,

In the question at gis.stackexchange the rotation was 90 but I trust that the issue is the same.

-Jukka-


Lähettäjä: Even Rouault <even.rouault at spatialys.com>
Lähetetty: maanantai 17. elokuuta 2020 14.36
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Rotation not found from ENVI header


On lundi 17 août 2020 09:42:15 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

> See

> https://gis.stackexchange.com/questions/371579/geotiff-to-envi-gdal-transla

> tion-causes-rotation

>

> I verified that GDAL 3.2.0dev gives an error for the test image "Warning 1:

> Geotransform matrix has non rotational terms". However, the ENVI header

> has a line map info = {Transverse Mercator, 1, 1, 32371999.5, 5679999.5,

> 1.95121951219512, 1.95121951219512, rotation=90}

>

> Rotation is handled in

> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/raw/envidataset.cpp#L6

> 32 and it is tested in this autotest

> https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/envi.py#L312

>

> In the data used for the test

> https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/data/envi/rotat

> ion.hdr the rotation appears on the last line map info = { UTM , 1.000 ,

> 1.000 , 736600.089 , 4078126.750 , 2.7000000000e+00 , 2.7000000000e+00 , 12

> , North , WGS-84 , units=Meters , rotation=-66.00000000 }



I've just fixed the issue. Was specific to south-up images / rotation=180



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/b14a87a3/attachment.html>

From even.rouault at spatialys.com  Mon Aug 17 13:52:43 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Aug 2020 22:52:43 +0200
Subject: [gdal-dev] Rotation not found from ENVI header
In-Reply-To: <5b8f297a64dd4f4a9c72a3659dc49d45@C119S212VM042.msvyvi.vaha.local>
References: <5b8f297a64dd4f4a9c72a3659dc49d45@C119S212VM042.msvyvi.vaha.local>
Message-ID: <17955373.zq0WBAqcPd@even-i700>

On lundi 17 août 2020 20:44:35 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> In the question at gis.stackexchange the rotation was 90 but I trust that
> the issue is the same.

The mention of 90 in the stackexchange thread is confusing. I think it is a 
manual try, but the original GeoTIFF used for convertion, and which 
triggered the error message, has a positive value for the y-res / south-up 
orientation, so a 180 deg rotation

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/ee563531/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug 17 14:10:17 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 17 Aug 2020 21:10:17 +0000
Subject: [gdal-dev] Rotation not found from ENVI header
Message-ID: <b90a32abd4ea45f69a06b0d02eb26424@C119S212VM042.msvyvi.vaha.local>

Hi,

No, it was not a manual try. GDAL, before your fix, creates a  .hdr file that shows rotation=90 with command

gdal_translate -ot UInt16 -scale -of ENVI -outsize 1025 1025 dgm1_32372_5680_2_nw.tif dgm1_32372_5680_2_nw.raw

-Jukka-


Lähettäjä: Even Rouault <even.rouault at spatialys.com>
Lähetetty: maanantai 17. elokuuta 2020 23.53
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Rotation not found from ENVI header


On lundi 17 août 2020 20:44:35 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

> In the question at gis.stackexchange the rotation was 90 but I trust that

> the issue is the same.



The mention of 90 in the stackexchange thread is confusing. I think it is a manual try, but the original GeoTIFF used for convertion, and which triggered the error message, has a positive value for the y-res / south-up orientation, so a 180 deg rotation



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/ab435041/attachment-0001.html>

From shawn.gong at mdacorporation.com  Mon Aug 17 14:19:07 2020
From: shawn.gong at mdacorporation.com (Gong, Shawn)
Date: Mon, 17 Aug 2020 21:19:07 +0000
Subject: [gdal-dev] Calculating hollow polygon area
In-Reply-To: <2360182.Pp8fd7VioN@even-i700>
References: <CADRrdKvG4=+ZZxXoe1RbvsaPFwx1xXGZWYnM-wrY1QrDCrh4Sg@mail.gmail.com>,
 <2360182.Pp8fd7VioN@even-i700>
Message-ID: <a0d79b531c424816bb35bb3d70837579@mdacorporation.com>

Hi list,

I am looking for ways to calculate hollow polygon area.

Will the following code work?
for feature in layer:
    geom = feature.GetGeometryRef()
    area = geom.GetArea()


Thanks,
Shawn


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200817/d335277b/attachment.html>

From j1 at jimenezshaw.com  Tue Aug 18 01:27:21 2020
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 18 Aug 2020 10:27:21 +0200
Subject: [gdal-dev] Usage of GDA_DATA in GDAL3
In-Reply-To: <CADRrdKsj3Wj42BtOEgTO27bhPyUSaiaihakJMFxFjchKWGk6uQ@mail.gmail.com>
References: <CADRrdKsj3Wj42BtOEgTO27bhPyUSaiaihakJMFxFjchKWGk6uQ@mail.gmail.com>
Message-ID: <CADRrdKurH12=fC8N3r8Y4XaLt1dOF9nCXRZiyb+NP1uMv6cYnA@mail.gmail.com>

I see there are still *.wkt files in gdal/data. Is it still needed?
I would like to remove the call to CPLSetConfigOption("GDAL_DATA"...), but
now I am suspicious.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Mon, 17 Aug 2020 at 15:33, Javier Jimenez Shaw <j1 at jimenezshaw.com>
wrote:

> Hi
>
> When I was using GDAL2 (from C++), I had to set the GDAL_DATA variable
> with something like
> CPLSetConfigOption("GDAL_DATA", gdalDataPath.c_str());
> to be able to use the SRS functions (using different coordinate reference
> systems).
>
> Now with GDAL3 (and PROJ7) I have to set instead the location of proj.db
> with OSRSetPROJSearchPaths(...)
>
> Do I need "GDAL_DATA" for anything else in GDAL3 ?
>
> Thanks
> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200818/08e4f95c/attachment.html>

From even.rouault at spatialys.com  Tue Aug 18 02:48:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Aug 2020 11:48:55 +0200
Subject: [gdal-dev] Usage of GDA_DATA in GDAL3
In-Reply-To: <CADRrdKurH12=fC8N3r8Y4XaLt1dOF9nCXRZiyb+NP1uMv6cYnA@mail.gmail.com>
References: <CADRrdKsj3Wj42BtOEgTO27bhPyUSaiaihakJMFxFjchKWGk6uQ@mail.gmail.com>
 <CADRrdKurH12=fC8N3r8Y4XaLt1dOF9nCXRZiyb+NP1uMv6cYnA@mail.gmail.com>
Message-ID: <2111556.BnXmpW9vXq@even-i700>

On mardi 18 août 2020 10:27:21 CEST Javier Jimenez Shaw wrote:
> I see there are still *.wkt files in gdal/data. Is it still needed?
> I would like to remove the call to CPLSetConfigOption("GDAL_DATA"...), but
> now I am suspicious.

There are a number of resources in the data/ directory that are needed by some 
drivers. If you know exactly which drivers you are going to use, and you know 
they don't need resources in data/, then you might skip it.

The few .wkt files may be used by the ECW driver or importing State Plane 
definitions from ESRI (can be triggered when reading some GeoTIFF files coming 
from ESRI software)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200818/084daa91/attachment.html>

From martobluesalata at gmail.com  Tue Aug 18 21:31:25 2020
From: martobluesalata at gmail.com (marto salata)
Date: Wed, 19 Aug 2020 07:31:25 +0300
Subject: [gdal-dev] Create a network
Message-ID: <CAFTz8=-VYuJ5fZcgebG7zLBM9rxO3qUnrds-ebcDThWNCx7Q=A@mail.gmail.com>

dear GDAL team,
how  i can create a network using gnmmanage.exe from a polyline shapefile,
so i can perform a dijkstra with gnmanalyse.exe

best regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/14211762/attachment.html>

From bishop.dev at gmail.com  Wed Aug 19 01:25:00 2020
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Wed, 19 Aug 2020 11:25:00 +0300
Subject: [gdal-dev] Create a network
In-Reply-To: <CAFTz8=-VYuJ5fZcgebG7zLBM9rxO3qUnrds-ebcDThWNCx7Q=A@mail.gmail.com>
References: <CAFTz8=-VYuJ5fZcgebG7zLBM9rxO3qUnrds-ebcDThWNCx7Q=A@mail.gmail.com>
Message-ID: <a3701fab-1835-fe4f-4a30-ba1b8e9cc92f@gmail.com>

Hi,

You need to follow these steps:

1. Create empty network

 > gnmmanage.exe create -f GNMFile -t_srs "EPSG:4326" -dsco 
"net_name=my_network_1" C:\tmp\gnmnetwork

2. Load your data

 > gnmmanage.exe import lines.shp -l lines C:\tmp\gnmnetwork

Repeat for all your layers

3. Connect features to create network. Features identifiers set while 
importing your spatial data. Use ogrinfo to check them.

 > gnmmanage.exe connect 1 2 -1 C:\tmp\gnmnetwork

4. Perform shortest path using Dijkstra

 > gnmanalyse.exe dijkstra 1 2 -ds shortestpath.shp -f "ESRI Shapefile" 
-l shortestpath C:\tmp\gnmnetwork


Some links:

* https://trac.osgeo.org/gdal/wiki/geography_network_support

* https://nextgis.com/blog/gnm/ <https://nextgis.com/blog/gnm/>

* http://gsoc2014gnm.blogspot.com/

Best regards,
     Dmitry

19.08.2020 07:31, marto salata пишет:
> dear GDAL team,
> how  i can create a network using gnmmanage.exe from a polyline 
> shapefile, so i can perform a dijkstra with gnmanalyse.exe
>
> best regards
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/327696ff/attachment.html>

From palmerjnz at gmail.com  Wed Aug 19 03:07:39 2020
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Wed, 19 Aug 2020 20:07:39 +1000
Subject: [gdal-dev] OGR Informix driver status
Message-ID: <CAA5WJYkX1_1CGdaX3dHE3LpXndMz_RMxAYFLpYX=AYX_0nKAgQ@mail.gmail.com>

Hi All,


Does anyone know the status of this driver?
https://gdal.org/drivers/vector/idb.html. I see no test suite, but some
patches were applied back in 2017.


Is it still used in production by anyone of this list? Does it have any
known significant limitations? e.g catalog or layer metadata querying takes
a long time. I couldn't find much in the issues.


Cheers,

Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/66bac90c/attachment.html>

From bishop.dev at gmail.com  Wed Aug 19 06:02:56 2020
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Wed, 19 Aug 2020 16:02:56 +0300
Subject: [gdal-dev] Create a network
In-Reply-To: <CAFTz8=-NcMxTKJ5qNB1JbMe4BnyKCj8izN4wmMTJLiOUf1dfFA@mail.gmail.com>
References: <CAFTz8=-VYuJ5fZcgebG7zLBM9rxO3qUnrds-ebcDThWNCx7Q=A@mail.gmail.com>
 <a3701fab-1835-fe4f-4a30-ba1b8e9cc92f@gmail.com>
 <CAFTz8=-NcMxTKJ5qNB1JbMe4BnyKCj8izN4wmMTJLiOUf1dfFA@mail.gmail.com>
Message-ID: <fdacbaf4-c4f5-d2b6-f2e0-7ca2829f384e@gmail.com>

Hi,

In case of polylines (i.e. road segments, single layer) - each polyline 
is vertex and edge is pure virtual (so it identifier is -1).

There are different cases, for example:

1. Water network with pipes (vertices) and edges (valves)

2. Road network - each road segment is vertex, edges are virtual

3. Product supply chain - warehouses, shops are vertices, edges may be 
virtual or real roads.

Best regards,
     Dmitry

19.08.2020 14:38, marto salata пишет:
> Thank you very much for your fast reply.
> regarding step 2, i have a polyline shapefile, how to get the vertices 
> required in step 3 so i can connect them.
> i know the gfid in the imported shapefile, but from where i can get 
> the vertices?
>
> On Wed, Aug 19, 2020 at 11:25 AM Dmitry Baryshnikov 
> <bishop.dev at gmail.com <mailto:bishop.dev at gmail.com>> wrote:
>
>     Hi,
>
>     You need to follow these steps:
>
>     1. Create empty network
>
>     > gnmmanage.exe create -f GNMFile -t_srs "EPSG:4326" -dsco
>     "net_name=my_network_1" C:\tmp\gnmnetwork
>
>     2. Load your data
>
>     > gnmmanage.exe import lines.shp -l lines C:\tmp\gnmnetwork
>
>     Repeat for all your layers
>
>     3. Connect features to create network. Features identifiers set
>     while importing your spatial data. Use ogrinfo to check them.
>
>     > gnmmanage.exe connect 1 2 -1 C:\tmp\gnmnetwork
>
>     4. Perform shortest path using Dijkstra
>
>     > gnmanalyse.exe dijkstra 1 2 -ds shortestpath.shp -f "ESRI
>     Shapefile" -l shortestpath C:\tmp\gnmnetwork
>
>
>     Some links:
>
>     * https://trac.osgeo.org/gdal/wiki/geography_network_support
>
>     * https://nextgis.com/blog/gnm/ <https://nextgis.com/blog/gnm/>
>
>     * http://gsoc2014gnm.blogspot.com/
>
>     Best regards,
>          Dmitry
>
>     19.08.2020 07:31, marto salata пишет:
>>     dear GDAL team,
>>     how  i can create a network using gnmmanage.exe from a polyline
>>     shapefile, so i can perform a dijkstra with gnmanalyse.exe
>>
>>     best regards
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org  <mailto:gdal-dev at lists.osgeo.org>
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/52ea6a39/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 19 11:53:07 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 19 Aug 2020 18:53:07 +0000
Subject: [gdal-dev] SQLite attach database as open option
Message-ID: <cb5c353b80d643f1b64c06107e713bd7@C119S212VM042.msvyvi.vaha.local>

Hi,

I wonder if it a) might work and b) could have some practical use to implement an open option for attaching other SQLite databases to SQLite based datasources  https://www.sqlite.org/lang_attach.html. The usage could be something like -oo ATTACH=path/to/other.gpkg:alias, where "alias" part would be optional and give the value for AS in the attach database SQL command. At least it should make it easier to use SQL joins than with the SQL dialects.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/27e6abd3/attachment-0001.html>

From jdaniel at etresoft.com  Wed Aug 19 14:04:54 2020
From: jdaniel at etresoft.com (John Daniel)
Date: Wed, 19 Aug 2020 21:04:54 +0000
Subject: [gdal-dev] Required PROJ data in PROJ7
Message-ID: <8BDE910C-C477-4EA4-BC6F-F58226DF4E0E@etresoft.com>

Hello,
The old proj-datumgrid is divided into a small, 13 MB required dataset and a number of much larger optional regional datasets. The new proj-data doesn't seem to have this distinction. It is smaller overall, but still 500 MB. 

I am interested in using GDAL in mobile apps so I don't want to include that much data. Is there a smaller set of proj-data files that can be used instead? Which of those files are required and which can be omitted? For example, it is possible to split the data by region, but with the software work with only a partial set of files? Can the data files be downloaded at runtime, on demand? If so, I'm sure I will need to include a few of them by default.

It looks like PROJ 7 can still be used with the old data. Is PROJ 7 safe for use with other projects? I have seen some messages that suggested that this was a problem for some projects. I think Spatialite was one. I won't be distributing with GPL projects like GEOS or Spatialite, but I would still like to use them for local testing.

Thanks.

John Daniel
Etresoft, Inc.


From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 19 14:20:51 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 19 Aug 2020 14:20:51 -0700 (MST)
Subject: [gdal-dev] Required PROJ data in PROJ7
In-Reply-To: <8BDE910C-C477-4EA4-BC6F-F58226DF4E0E@etresoft.com>
References: <8BDE910C-C477-4EA4-BC6F-F58226DF4E0E@etresoft.com>
Message-ID: <1597872051582-0.post@n6.nabble.com>

Hi,

This question may belong rather to the Proj mailing list. There is already a
thread https://lists.osgeo.org/pipermail/proj/2020-July/009729.html.

-Jukka Rahkonen-



John Daniel-2 wrote
> Hello,
> The old proj-datumgrid is divided into a small, 13 MB required dataset and
> a number of much larger optional regional datasets. The new proj-data
> doesn't seem to have this distinction. It is smaller overall, but still
> 500 MB. 
> 
> I am interested in using GDAL in mobile apps so I don't want to include
> that much data. Is there a smaller set of proj-data files that can be used
> instead? Which of those files are required and which can be omitted? For
> example, it is possible to split the data by region, but with the software
> work with only a partial set of files? Can the data files be downloaded at
> runtime, on demand? If so, I'm sure I will need to include a few of them
> by default.
> 
> It looks like PROJ 7 can still be used with the old data. Is PROJ 7 safe
> for use with other projects? I have seen some messages that suggested that
> this was a problem for some projects. I think Spatialite was one. I won't
> be distributing with GPL projects like GEOS or Spatialite, but I would
> still like to use them for local testing.
> 
> Thanks.
> 
> John Daniel
> Etresoft, Inc.
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From michael.smith.erdc at gmail.com  Wed Aug 19 14:57:29 2020
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 19 Aug 2020 17:57:29 -0400
Subject: [gdal-dev] Required PROJ data in PROJ7
Message-ID: <586C85CB-EAAF-4D6A-A8B6-5ED73291AF1E@gmail.com>

John

New proj now adds support for geotiffs for datums, much smaller and can be accessed over net, subset, etc. There is a CDN for the data, cdn.prog.org as well as a utility for fetching data, https://proj.org/apps/projsync.html. 
You can use the online CDN to just fetch what a user needs at runtime and never download, or you can download ahead of time, whatever subsets you need.

Mike


-- 
Michael Smith
US Army Corps of Engineers
Remote Sensing/GIS Center


﻿On 8/19/20, 5:05 PM, "gdal-dev on behalf of John Daniel" <gdal-dev-bounces at lists.osgeo.org on behalf of jdaniel at etresoft.com> wrote:

    Hello,
    The old proj-datumgrid is divided into a small, 13 MB required dataset and a number of much larger optional regional datasets. The new proj-data doesn't seem to have this distinction. It is smaller overall, but still 500 MB. 

    I am interested in using GDAL in mobile apps so I don't want to include that much data. Is there a smaller set of proj-data files that can be used instead? Which of those files are required and which can be omitted? For example, it is possible to split the data by region, but with the software work with only a partial set of files? Can the data files be downloaded at runtime, on demand? If so, I'm sure I will need to include a few of them by default.

    It looks like PROJ 7 can still be used with the old data. Is PROJ 7 safe for use with other projects? I have seen some messages that suggested that this was a problem for some projects. I think Spatialite was one. I won't be distributing with GPL projects like GEOS or Spatialite, but I would still like to use them for local testing.

    Thanks.

    John Daniel
    Etresoft, Inc.

    _______________________________________________
    gdal-dev mailing list
    gdal-dev at lists.osgeo.org
    https://lists.osgeo.org/mailman/listinfo/gdal-dev



From changliao.climate at gmail.com  Wed Aug 19 15:40:38 2020
From: changliao.climate at gmail.com (Chang Liao)
Date: Wed, 19 Aug 2020 16:40:38 -0600
Subject: [gdal-dev] Crop tiff raster file with warp C++ API
Message-ID: <CAOkqVM35VcPSZftAd6rPxq3EMUHiyDY9=qBvTzxQffYdR+Tteg@mail.gmail.com>

Hi,

I need to crop a DEM raster file with a shapefile. This shapefile has many
polygons. I need to calculate several variables after the crop operation.
I do not need to write the warped result out to my disk and I intend to use
either VRT or MEM once the test is passed.

The shapefile has the same map projection with the raster.
I already obtained the vertex coordinates of each polygon and I passed as a
polygon using the cutline argument, but the operation has no effect so far.
In this way, I am constructing the geometry manually but I am not sure what
I have missed, maybe the spatial reference?

I assume I can also define the geometry through:
poGeometry = poFeature->GetGeometryRef(); but I need a filter to remove
unwanted features. These geometries are actually already in the shapefile.

The current output are exactly the same as the input raster file, so I
suspect the cutline, or hCutline option is not effective.

Some details are also discussed here:
https://gis.stackexchange.com/questions/371915/crop-raster-file-with-gdal-warp-c-api

Please provide some suggestions.

Thank you!

Best Regards!


*Chang Liao, PhD*
*Earth Scientist, Atmospheric Sciences & Global Change Division*
*Pacific Northwest National Laboratory, WA, USA.*
*Email: changliao.climate at gmail.com <changliao.climate at gmail.com>  or
 chang.liao at pnnl.gov <chang.liao at pnnl.gov>*
*Personal Website: http://www.changliao.us <http://www.changliao.us/>*
*Lab Website: www.pnnl.gov
<https://www.pnnl.gov/science/staff/staff_info.asp?staff_num=9326>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200819/5efaabea/attachment.html>

From stephenwoodbridge37 at gmail.com  Wed Aug 19 15:41:51 2020
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Wed, 19 Aug 2020 18:41:51 -0400
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT file
Message-ID: <250a38cf-4777-96cb-a054-40cc0ed46357@gmail.com>

Hi all,

I've been puzzling over a problem with trying to get a higher resolution 
images using a VRT file so low res data looks smoother in mapserver.

This is my source tif image:

gdalinfo  /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
Driver: GTiff/GeoTIFF
Files: /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
Size is 4500, 4251
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.080000000000000,-0.040000000000000)
Metadata:
   AREA_OR_POINT=Area
   [snip more metadata]
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -80.0400000) (180d 0' 0.00"W, 80d 2'24.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -80.0400000) (180d 0' 0.00"E, 80d 2'24.00"S)
Center      (   0.0000000,   4.9800000) (  0d 0' 0.01"E, 4d58'48.00"N)
Band 1 Block=4500x1 Type=Float32, ColorInterp=Gray
   NoData Value=1.2676506002282294e+30
   Overviews: 2250x2126, 1125x1063, 563x532, 282x266, 141x133, 71x67


I generate a VRT file as part of my processing and add a color table and 
increase the resolution. It looks like this:

gdalinfo  /maps/wms/data/HYCOM/HYCOM_today_mlt.vrt
Driver: VRT/Virtual Raster
Files: /maps/wms/data/HYCOM/HYCOM_today_mlt.vrt
        /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
Size is 72000, 68016
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.005000000000000,-0.002500000000000)
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -80.0400000) (180d 0' 0.00"W, 80d 2'24.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -80.0400000) (180d 0' 0.00"E, 80d 2'24.00"S)
Center      (   0.0000000,   4.9800000) (  0d 0' 0.01"E, 4d58'48.00"N)
Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
   Overviews: 36000x34016, 18000x17008, 9008x8512, 4512x4256, 2256x2128, 
1136x1072
   Color Table (RGB with 256 entries)
[snip color table]


And in my mapfile I have a layer defined like:

     LAYER
         NAME "mlt"
         STATUS ON
         TYPE RASTER
         PROJECTION "init=epsg:4326" END
         DATA "/maps/wms/data/HYCOM/HYCOM_today_mlt.vrt"
         PROCESSING "NODATA=1.2676506002282294e+30"
         PROCESSING "SCALE=0,250"
     END

This all seems like it should be working correctly, but in my OL app, 
the resolution is not changing. I would expect the with the higher 
resolution I would see smoother color transitions as I zoom in on the 
image and that the pixel blocks would appear smaller. Unfortunately, I'm 
not seeing a difference.

So I assume I've done something wrong somewhere, but I'm not see what :(

Any Ideas?

Thanks,
   -Steve

Oh and the VRT file looks like this:

<VRTDataset rasterXSize="72000" rasterYSize="68016">
   <SRS>GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4326"]]</SRS>
   <GeoTransform> -180.0 ,0.005 , 0 , 90.0 , 0 , -0.0025 </GeoTransform>
   <Metadata>
   </Metadata>
   <VRTRasterBand dataType="Byte" band="1">
     <ColorInterp>Palette</ColorInterp>
     <ColorTable>
       <Entry c1="0" c2="0" c3="0" c4="255"/>
       [snip color table entries]
       <Entry c1="255" c2="255" c3="255" c4="255"/>
     </ColorTable>
     <SimpleSource resample="bilinear">
       <SourceFilename 
relativeToVRT="1">HYCOM_today_mlt.tif</SourceFilename>
       <SourceBand>1</SourceBand>
       <SourceProperties RasterXSize="4500" RasterYSize="4251" 
DataType="Float32" BlockXSize="4500" BlockYSize="1" />
       <SrcRect xOff="0" yOff="0" xSize="4500" ySize="4251"/>
       <DstRect xOff="0" yOff="0" xSize="72000" ySize="68016"/>
     </SimpleSource>
   </VRTRasterBand>
</VRTDataset>


From apschwimmer at apmland.de  Thu Aug 20 02:44:23 2020
From: apschwimmer at apmland.de (APM)
Date: Thu, 20 Aug 2020 11:44:23 +0200
Subject: [gdal-dev] gdalbuildvrt could not use worldfile
Message-ID: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>

Hello list,


I'm a beginner with gdal and use Linux Debian testing as the OS.


I like to create a .vrt file to use a map.

The map comes with a worldfile .tfw:

1.2700000000
0.0000000000
0.0000000000
-1.2700000000
376279.1000000000
5679613.9199999999


If I try to build the .vrt by using


gdalbuildvrt map_1.vrt map_1.tif


The .vrt is present now.


But I can't use it in a mapviewer, which gives out a message, that the 
georeferences are not present.


gdalinfo map_1.tif
Driver: GTiff/GeoTIFF
Files: map_1.tif
        map_1.tfw
Size is 16252, 13444
Origin = (376278.464999999967404,5679614.554999999701977)
Pixel Size = (1.270000000000000,-1.270000000000000)
Image Structure Metadata:
   COMPRESSION=DEFLATE
   INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  376278.465, 5679614.555)
Lower Left  (  376278.465, 5662540.675)
Upper Right (  396918.505, 5679614.555)
Lower Right (  396918.505, 5662540.675)
Center      (  386598.485, 5671077.615)
Band 1 Block=128x128 Type=Byte, ColorInterp=Red
   NoData Value=0
Band 2 Block=128x128 Type=Byte, ColorInterp=Green
   NoData Value=0
Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
   NoData Value=0


gdalinfo map_1.vrt
Driver: VRT/Virtual Raster
Files: map_1.vrt
        map_1.tif
Size is 16252, 13444
Origin = (376278.464999999967404,5679614.554999999701977)
Pixel Size = (1.270000000000000,-1.270000000000000)
Corner Coordinates:
Upper Left  (  376278.465, 5679614.555)
Lower Left  (  376278.465, 5662540.675)
Upper Right (  396918.505, 5679614.555)
Lower Right (  396918.505, 5662540.675)
Center      (  386598.485, 5671077.615)
Band 1 Block=128x128 Type=Byte, ColorInterp=Red
   NoData Value=0
Band 2 Block=128x128 Type=Byte, ColorInterp=Green
   NoData Value=0
Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
   NoData Value=0


Can you give me a hint, please?


Thank you!


KR

Piet





From even.rouault at spatialys.com  Thu Aug 20 03:13:18 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Aug 2020 12:13:18 +0200
Subject: [gdal-dev] SQLite attach database as open option
In-Reply-To: <cb5c353b80d643f1b64c06107e713bd7@C119S212VM042.msvyvi.vaha.local>
References: <cb5c353b80d643f1b64c06107e713bd7@C119S212VM042.msvyvi.vaha.local>
Message-ID: <9747119.F0bf5XGNCD@even-i700>

On mercredi 19 août 2020 18:53:07 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I wonder if it a) might work and b) could have some practical use to
> implement an open option for attaching other SQLite databases to SQLite
> based datasources  https://www.sqlite.org/lang_attach.html. The usage could
> be something like -oo ATTACH=path/to/other.gpkg:alias, where "alias" part
> would be optional and give the value for AS in the attach database SQL
> command. At least it should make it easier to use SQL joins than with the
> SQL dialects.

Candidate implementation (using PRELUDE_STATEMENTS as for the PostgreSQL driver) 
in:
https://github.com/OSGeo/gdal/pull/2871

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200820/ac72e78e/attachment.html>

From even.rouault at spatialys.com  Thu Aug 20 03:16:23 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Aug 2020 12:16:23 +0200
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT
	file
In-Reply-To: <250a38cf-4777-96cb-a054-40cc0ed46357@gmail.com>
References: <250a38cf-4777-96cb-a054-40cc0ed46357@gmail.com>
Message-ID: <3161656.o43Z9JIhmS@even-i700>

On mercredi 19 août 2020 18:41:51 CEST Stephen Woodbridge wrote:
> Hi all,
> 
> I've been puzzling over a problem with trying to get a higher resolution
> images using a VRT file so low res data looks smoother in mapserver.
> 
> This is my source tif image:
> 
> gdalinfo  /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
> Driver: GTiff/GeoTIFF
> Files: /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
> Size is 4500, 4251
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-180.000000000000000,90.000000000000000)
> Pixel Size = (0.080000000000000,-0.040000000000000)
> Metadata:
>    AREA_OR_POINT=Area
>    [snip more metadata]
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
> Lower Left  (-180.0000000, -80.0400000) (180d 0' 0.00"W, 80d 2'24.00"S)
> Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> Lower Right ( 180.0000000, -80.0400000) (180d 0' 0.00"E, 80d 2'24.00"S)
> Center      (   0.0000000,   4.9800000) (  0d 0' 0.01"E, 4d58'48.00"N)
> Band 1 Block=4500x1 Type=Float32, ColorInterp=Gray
>    NoData Value=1.2676506002282294e+30
>    Overviews: 2250x2126, 1125x1063, 563x532, 282x266, 141x133, 71x67
> 
> 
> I generate a VRT file as part of my processing and add a color table and
> increase the resolution. It looks like this:
> 
> gdalinfo  /maps/wms/data/HYCOM/HYCOM_today_mlt.vrt
> Driver: VRT/Virtual Raster
> Files: /maps/wms/data/HYCOM/HYCOM_today_mlt.vrt
>         /maps/wms/data/HYCOM/HYCOM_today_mlt.tif
> Size is 72000, 68016
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-180.000000000000000,90.000000000000000)
> Pixel Size = (0.005000000000000,-0.002500000000000)
> Corner Coordinates:
> Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
> Lower Left  (-180.0000000, -80.0400000) (180d 0' 0.00"W, 80d 2'24.00"S)
> Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
> Lower Right ( 180.0000000, -80.0400000) (180d 0' 0.00"E, 80d 2'24.00"S)
> Center      (   0.0000000,   4.9800000) (  0d 0' 0.01"E, 4d58'48.00"N)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
>    Overviews: 36000x34016, 18000x17008, 9008x8512, 4512x4256, 2256x2128,
> 1136x1072
>    Color Table (RGB with 256 entries)
> [snip color table]
> 
> 
> And in my mapfile I have a layer defined like:
> 
>      LAYER
>          NAME "mlt"
>          STATUS ON
>          TYPE RASTER
>          PROJECTION "init=epsg:4326" END
>          DATA "/maps/wms/data/HYCOM/HYCOM_today_mlt.vrt"
>          PROCESSING "NODATA=1.2676506002282294e+30"
>          PROCESSING "SCALE=0,250"
>      END
> 
> This all seems like it should be working correctly, but in my OL app,
> the resolution is not changing. I would expect the with the higher
> resolution I would see smoother color transitions as I zoom in on the
> image and that the pixel blocks would appear smaller. Unfortunately, I'm
> not seeing a difference.
> 
> So I assume I've done something wrong somewhere, but I'm not see what :(

By default, VRT uses nearest resampling. You must specify something else.
Look for "A resampling attribute can be specified" in
https://gdal.org/drivers/raster/vrt.html

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200820/26e7ea7d/attachment-0001.html>

From idan at miara.com  Thu Aug 20 04:49:31 2020
From: idan at miara.com (Idan Miara)
Date: Thu, 20 Aug 2020 14:49:31 +0300
Subject: [gdal-dev] gdalbuildvrt could not use worldfile
In-Reply-To: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
References: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
Message-ID: <CAEDrt3-4jyco1r09QoX+KZoy4L_UuxWAp_OivepL6-nwuSQEyw@mail.gmail.com>

Hi,

According to gdalinfo your vrt looks fine, so it might be a problem with
the vrt support in mapviewer.
What are you trying to accomplish with this vrt? if you just want to
georeference your tif you could try:
gdal_translate -of GTiff input.tif ouput.tif
use "-co COMPRESS=DEFLATE -co TILED=YES -co BIGTIFF=IF_SAFER" or other
gtiff parameters as needed:
https://gdal.org/drivers/raster/gtiff.html

Idan


On Thu, 20 Aug 2020 at 12:49, APM <apschwimmer at apmland.de> wrote:

> Hello list,
>
>
> I'm a beginner with gdal and use Linux Debian testing as the OS.
>
>
> I like to create a .vrt file to use a map.
>
> The map comes with a worldfile .tfw:
>
> 1.2700000000
> 0.0000000000
> 0.0000000000
> -1.2700000000
> 376279.1000000000
> 5679613.9199999999
>
>
> If I try to build the .vrt by using
>
>
> gdalbuildvrt map_1.vrt map_1.tif
>
>
> The .vrt is present now.
>
>
> But I can't use it in a mapviewer, which gives out a message, that the
> georeferences are not present.
>
>
> gdalinfo map_1.tif
> Driver: GTiff/GeoTIFF
> Files: map_1.tif
>         map_1.tfw
> Size is 16252, 13444
> Origin = (376278.464999999967404,5679614.554999999701977)
> Pixel Size = (1.270000000000000,-1.270000000000000)
> Image Structure Metadata:
>    COMPRESSION=DEFLATE
>    INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  376278.465, 5679614.555)
> Lower Left  (  376278.465, 5662540.675)
> Upper Right (  396918.505, 5679614.555)
> Lower Right (  396918.505, 5662540.675)
> Center      (  386598.485, 5671077.615)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>    NoData Value=0
> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>    NoData Value=0
> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>    NoData Value=0
>
>
> gdalinfo map_1.vrt
> Driver: VRT/Virtual Raster
> Files: map_1.vrt
>         map_1.tif
> Size is 16252, 13444
> Origin = (376278.464999999967404,5679614.554999999701977)
> Pixel Size = (1.270000000000000,-1.270000000000000)
> Corner Coordinates:
> Upper Left  (  376278.465, 5679614.555)
> Lower Left  (  376278.465, 5662540.675)
> Upper Right (  396918.505, 5679614.555)
> Lower Right (  396918.505, 5662540.675)
> Center      (  386598.485, 5671077.615)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>    NoData Value=0
> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>    NoData Value=0
> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>    NoData Value=0
>
>
> Can you give me a hint, please?
>
>
> Thank you!
>
>
> KR
>
> Piet
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200820/dd5e22b7/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug 20 04:54:27 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 20 Aug 2020 04:54:27 -0700 (MST)
Subject: [gdal-dev] gdalbuildvrt could not use worldfile
In-Reply-To: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
References: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
Message-ID: <1597924467264-0.post@n6.nabble.com>

Hi,

I don't know your map viewer but perhaps it wants to know both the location
of your image (the coordinates) and in what coordinate reference system the
coordinates are. You have now the corner coordinates and pixel size but the
CRS is unknown. Run gdalbuildvrt with "-a_srs" for attaching it. I suppose
that you know the right CRS for you image.

-Jukka Rahkonen- 


APM wrote
> Hello list,
> 
> 
> I'm a beginner with gdal and use Linux Debian testing as the OS.
> 
> 
> I like to create a .vrt file to use a map.
> 
> The map comes with a worldfile .tfw:
> 
> 1.2700000000
> 0.0000000000
> 0.0000000000
> -1.2700000000
> 376279.1000000000
> 5679613.9199999999
> 
> 
> If I try to build the .vrt by using
> 
> 
> gdalbuildvrt map_1.vrt map_1.tif
> 
> 
> The .vrt is present now.
> 
> 
> But I can't use it in a mapviewer, which gives out a message, that the 
> georeferences are not present.
> 
> 
> gdalinfo map_1.tif
> Driver: GTiff/GeoTIFF
> Files: map_1.tif
>         map_1.tfw
> Size is 16252, 13444
> Origin = (376278.464999999967404,5679614.554999999701977)
> Pixel Size = (1.270000000000000,-1.270000000000000)
> Image Structure Metadata:
>    COMPRESSION=DEFLATE
>    INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  376278.465, 5679614.555)
> Lower Left  (  376278.465, 5662540.675)
> Upper Right (  396918.505, 5679614.555)
> Lower Right (  396918.505, 5662540.675)
> Center      (  386598.485, 5671077.615)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>    NoData Value=0
> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>    NoData Value=0
> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>    NoData Value=0
> 
> 
> gdalinfo map_1.vrt
> Driver: VRT/Virtual Raster
> Files: map_1.vrt
>         map_1.tif
> Size is 16252, 13444
> Origin = (376278.464999999967404,5679614.554999999701977)
> Pixel Size = (1.270000000000000,-1.270000000000000)
> Corner Coordinates:
> Upper Left  (  376278.465, 5679614.555)
> Lower Left  (  376278.465, 5662540.675)
> Upper Right (  396918.505, 5679614.555)
> Lower Right (  396918.505, 5662540.675)
> Center      (  386598.485, 5671077.615)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>    NoData Value=0
> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>    NoData Value=0
> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>    NoData Value=0
> 
> 
> Can you give me a hint, please?
> 
> 
> Thank you!
> 
> 
> KR
> 
> Piet
> 
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From apschwimmer at apmland.de  Thu Aug 20 05:11:38 2020
From: apschwimmer at apmland.de (APM)
Date: Thu, 20 Aug 2020 14:11:38 +0200
Subject: [gdal-dev] gdalbuildvrt could not use worldfile
In-Reply-To: <CAEDrt3-4jyco1r09QoX+KZoy4L_UuxWAp_OivepL6-nwuSQEyw@mail.gmail.com>
References: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
 <CAEDrt3-4jyco1r09QoX+KZoy4L_UuxWAp_OivepL6-nwuSQEyw@mail.gmail.com>
Message-ID: <7d78afa8-2b5c-d3d1-4a3b-dc76f0450151@apmland.de>

Dear Idan,


thank you for your input.


I use the .vrt step to assemble a group of tif's to one common file.

In a second step I use something like

gdal_translate -of GTiff -co COMPRESS=LZW -co tiled=yes maps.vrt maps.tiff

But the maps.tiff has no georeference data's as well.


This two steps works well with other Geotiff tiles, but maybe there's a 
more easy way to create one map from several tiles.


Kind regards


Piet





Am 20.08.20 um 13:49 schrieb Idan Miara:
> Hi,
>
> According to gdalinfo your vrt looks fine, so it might be a problem 
> with the vrt support in mapviewer.
> What are you trying to accomplish with this vrt? if you just want to 
> georeference your tif you could try:
> gdal_translate -of GTiff input.tif ouput.tif
> use "-co COMPRESS=DEFLATE -co TILED=YES -co BIGTIFF=IF_SAFER" or other 
> gtiff parameters as needed:
> https://gdal.org/drivers/raster/gtiff.html
>
> Idan
>
>
> On Thu, 20 Aug 2020 at 12:49, APM <apschwimmer at apmland.de 
> <mailto:apschwimmer at apmland.de>> wrote:
>
>     Hello list,
>
>
>     I'm a beginner with gdal and use Linux Debian testing as the OS.
>
>
>     I like to create a .vrt file to use a map.
>
>     The map comes with a worldfile .tfw:
>
>     1.2700000000
>     0.0000000000
>     0.0000000000
>     -1.2700000000
>     376279.1000000000
>     5679613.9199999999
>
>
>     If I try to build the .vrt by using
>
>
>     gdalbuildvrt map_1.vrt map_1.tif
>
>
>     The .vrt is present now.
>
>
>     But I can't use it in a mapviewer, which gives out a message, that
>     the
>     georeferences are not present.
>
>
>     gdalinfo map_1.tif
>     Driver: GTiff/GeoTIFF
>     Files: map_1.tif
>             map_1.tfw
>     Size is 16252, 13444
>     Origin = (376278.464999999967404,5679614.554999999701977)
>     Pixel Size = (1.270000000000000,-1.270000000000000)
>     Image Structure Metadata:
>        COMPRESSION=DEFLATE
>        INTERLEAVE=PIXEL
>     Corner Coordinates:
>     Upper Left  (  376278.465, 5679614.555)
>     Lower Left  (  376278.465, 5662540.675)
>     Upper Right (  396918.505, 5679614.555)
>     Lower Right (  396918.505, 5662540.675)
>     Center      (  386598.485, 5671077.615)
>     Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>        NoData Value=0
>     Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>        NoData Value=0
>     Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>        NoData Value=0
>
>
>     gdalinfo map_1.vrt
>     Driver: VRT/Virtual Raster
>     Files: map_1.vrt
>             map_1.tif
>     Size is 16252, 13444
>     Origin = (376278.464999999967404,5679614.554999999701977)
>     Pixel Size = (1.270000000000000,-1.270000000000000)
>     Corner Coordinates:
>     Upper Left  (  376278.465, 5679614.555)
>     Lower Left  (  376278.465, 5662540.675)
>     Upper Right (  396918.505, 5679614.555)
>     Lower Right (  396918.505, 5662540.675)
>     Center      (  386598.485, 5671077.615)
>     Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>        NoData Value=0
>     Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>        NoData Value=0
>     Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>        NoData Value=0
>
>
>     Can you give me a hint, please?
>
>
>     Thank you!
>
>
>     KR
>
>     Piet
>
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200820/53edf4ed/attachment.html>

From idan at miara.com  Thu Aug 20 05:19:33 2020
From: idan at miara.com (Idan Miara)
Date: Thu, 20 Aug 2020 15:19:33 +0300
Subject: [gdal-dev] gdalbuildvrt could not use worldfile
In-Reply-To: <7d78afa8-2b5c-d3d1-4a3b-dc76f0450151@apmland.de>
References: <4fef5e5d-2a84-8adf-8a90-b5f933c681c8@apmland.de>
 <CAEDrt3-4jyco1r09QoX+KZoy4L_UuxWAp_OivepL6-nwuSQEyw@mail.gmail.com>
 <7d78afa8-2b5c-d3d1-4a3b-dc76f0450151@apmland.de>
Message-ID: <CAEDrt3_AjEOSS4eXLGZvgQfMwiZZ7UAERHFcaPD+q-RUP1fzWA@mail.gmail.com>

It might indeed be the missing CRS info (world files include only the pixel
size and corner pixel).
Try to add the -a_srs parameter as Jukka suggested.
for instance, add "-a_srs EPSG:32632" (if you are using WGS84 / UTM Zone
32N https://epsg.io/32632 <https://epsg.io/32630>)

On Thu, 20 Aug 2020 at 15:11, APM <apschwimmer at apmland.de> wrote:

> Dear Idan,
>
>
> thank you for your input.
>
>
> I use the .vrt step to assemble a group of tif's to one common file.
>
> In a second step I use something like
>
> gdal_translate -of GTiff -co COMPRESS=LZW -co tiled=yes maps.vrt maps.tiff
>
> But the maps.tiff has no georeference data's as well.
>
>
> This two steps works well with other Geotiff tiles, but maybe there's a
> more easy way to create one map from several tiles.
>
>
> Kind regards
>
>
> Piet
>
>
>
>
>
> Am 20.08.20 um 13:49 schrieb Idan Miara:
>
> Hi,
>
> According to gdalinfo your vrt looks fine, so it might be a problem with
> the vrt support in mapviewer.
> What are you trying to accomplish with this vrt? if you just want to
> georeference your tif you could try:
> gdal_translate -of GTiff input.tif ouput.tif
> use "-co COMPRESS=DEFLATE -co TILED=YES -co BIGTIFF=IF_SAFER" or other
> gtiff parameters as needed:
> https://gdal.org/drivers/raster/gtiff.html
>
> Idan
>
>
> On Thu, 20 Aug 2020 at 12:49, APM <apschwimmer at apmland.de> wrote:
>
>> Hello list,
>>
>>
>> I'm a beginner with gdal and use Linux Debian testing as the OS.
>>
>>
>> I like to create a .vrt file to use a map.
>>
>> The map comes with a worldfile .tfw:
>>
>> 1.2700000000
>> 0.0000000000
>> 0.0000000000
>> -1.2700000000
>> 376279.1000000000
>> 5679613.9199999999
>>
>>
>> If I try to build the .vrt by using
>>
>>
>> gdalbuildvrt map_1.vrt map_1.tif
>>
>>
>> The .vrt is present now.
>>
>>
>> But I can't use it in a mapviewer, which gives out a message, that the
>> georeferences are not present.
>>
>>
>> gdalinfo map_1.tif
>> Driver: GTiff/GeoTIFF
>> Files: map_1.tif
>>         map_1.tfw
>> Size is 16252, 13444
>> Origin = (376278.464999999967404,5679614.554999999701977)
>> Pixel Size = (1.270000000000000,-1.270000000000000)
>> Image Structure Metadata:
>>    COMPRESSION=DEFLATE
>>    INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left  (  376278.465, 5679614.555)
>> Lower Left  (  376278.465, 5662540.675)
>> Upper Right (  396918.505, 5679614.555)
>> Lower Right (  396918.505, 5662540.675)
>> Center      (  386598.485, 5671077.615)
>> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>>    NoData Value=0
>> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>>    NoData Value=0
>> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>>    NoData Value=0
>>
>>
>> gdalinfo map_1.vrt
>> Driver: VRT/Virtual Raster
>> Files: map_1.vrt
>>         map_1.tif
>> Size is 16252, 13444
>> Origin = (376278.464999999967404,5679614.554999999701977)
>> Pixel Size = (1.270000000000000,-1.270000000000000)
>> Corner Coordinates:
>> Upper Left  (  376278.465, 5679614.555)
>> Lower Left  (  376278.465, 5662540.675)
>> Upper Right (  396918.505, 5679614.555)
>> Lower Right (  396918.505, 5662540.675)
>> Center      (  386598.485, 5671077.615)
>> Band 1 Block=128x128 Type=Byte, ColorInterp=Red
>>    NoData Value=0
>> Band 2 Block=128x128 Type=Byte, ColorInterp=Green
>>    NoData Value=0
>> Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
>>    NoData Value=0
>>
>>
>> Can you give me a hint, please?
>>
>>
>> Thank you!
>>
>>
>> KR
>>
>> Piet
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200820/3127aca1/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug 20 05:23:42 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 20 Aug 2020 05:23:42 -0700 (MST)
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT
	file
In-Reply-To: <3161656.o43Z9JIhmS@even-i700>
References: <250a38cf-4777-96cb-a054-40cc0ed46357@gmail.com>
 <3161656.o43Z9JIhmS@even-i700>
Message-ID: <1597926222174-0.post@n6.nabble.com>

Even Rouault-2 wrote
> ...
> By default, VRT uses nearest resampling. You must specify something else.
> Look for "A resampling attribute can be specified" in
> https://gdal.org/drivers/raster/vrt.html
> ...
> 
> -- 

Actually in the provided .vrt file I can see
 <SimpleSource resample="bilinear">

But isn't bilinear unsuitable for upsampling and some more blurring method
might work better?

-Jukka Rahkonen-



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Thu Aug 20 07:13:03 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 20 Aug 2020 14:13:03 +0000
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT
 file
Message-ID: <026c8323ec8e4918921e013b1e8432d3@C119S212VM042.msvyvi.vaha.local>

Hi,

Resampling is science that would be nice to understand. Unfortunately I don't but I think that this thread is worth reading osgeo-org.1560.x6.nabble.com/gdal-dev-downsampling-geotiff-with-a-low-pass-filter-td5385890.html. In this gis.SE question cubic spline was considered good https://gis.stackexchange.com/questions/30627/smoothing-reinterpolating-raster-with-gdal.

-Jukka-

-----Alkuperäinen viesti-----
Lähettäjä: Stephen Woodbridge <stephenwoodbridge37 at gmail.com> 
Lähetetty: torstai 20. elokuuta 2020 16.58
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] I have a problem getting higher resolution in a VRT file

Hi Jukka,

Any thoughts on what would be a better way to upsample and image using GDAL?

I assumed, maybe incorrectly, that if I’m up sampling between two pixels with values of say 1 and 2 that a new pixel 50% between them would get a value of 1.5 and at 25% would get a value 1.25 etc. using linear interpolation and bilinear would also account for rows above and below the current row. 

Even, I specified resampling=“bilinear” in the vrt file is this ignored?

Thanks, Steve 

Sent from my iPhone

> On Aug 20, 2020, at 8:23 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> ﻿Even Rouault-2 wrote
>> ...
>> By default, VRT uses nearest resampling. You must specify something else.
>> Look for "A resampling attribute can be specified" in 
>> https://gdal.org/drivers/raster/vrt.html
>> ...
>> 
>> --
> 
> Actually in the provided .vrt file I can see <SimpleSource 
> resample="bilinear">
> 
> But isn't bilinear unsuitable for upsampling and some more blurring 
> method might work better?
> 
> -Jukka Rahkonen-
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From stephenwoodbridge37 at gmail.com  Thu Aug 20 07:39:53 2020
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 20 Aug 2020 10:39:53 -0400
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT
 file
In-Reply-To: <026c8323ec8e4918921e013b1e8432d3@C119S212VM042.msvyvi.vaha.local>
References: <026c8323ec8e4918921e013b1e8432d3@C119S212VM042.msvyvi.vaha.local>
Message-ID: <ba53e3ec-b719-5b75-63d1-7642ec89511d@gmail.com>

Jukka,

Thanks those are great threads and very educational.
I solved my problem. I was using upsample="bilinear" rather than 
upsampling="bilinear" and fixing this gave the expected results. But if 
not for my stupid typo, I would not have had a chance to read those 
threads and google others regarding upsampling.

Thanks for the assist,
-Steve

On 8/20/2020 10:13 AM, Rahkonen Jukka (MML) wrote:
> Hi,
>
> Resampling is science that would be nice to understand. Unfortunately I don't but I think that this thread is worth reading osgeo-org.1560.x6.nabble.com/gdal-dev-downsampling-geotiff-with-a-low-pass-filter-td5385890.html. In this gis.SE question cubic spline was considered good https://gis.stackexchange.com/questions/30627/smoothing-reinterpolating-raster-with-gdal.
>
> -Jukka-
>
> -----Alkuperäinen viesti-----
> Lähettäjä: Stephen Woodbridge <stephenwoodbridge37 at gmail.com>
> Lähetetty: torstai 20. elokuuta 2020 16.58
> Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
> Aihe: Re: [gdal-dev] I have a problem getting higher resolution in a VRT file
>
> Hi Jukka,
>
> Any thoughts on what would be a better way to upsample and image using GDAL?
>
> I assumed, maybe incorrectly, that if I’m up sampling between two pixels with values of say 1 and 2 that a new pixel 50% between them would get a value of 1.5 and at 25% would get a value 1.25 etc. using linear interpolation and bilinear would also account for rows above and below the current row.
>
> Even, I specified resampling=“bilinear” in the vrt file is this ignored?
>
> Thanks, Steve
>
> Sent from my iPhone
>
>> On Aug 20, 2020, at 8:23 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
>>
>> ﻿Even Rouault-2 wrote
>>> ...
>>> By default, VRT uses nearest resampling. You must specify something else.
>>> Look for "A resampling attribute can be specified" in
>>> https://gdal.org/drivers/raster/vrt.html
>>> ...
>>>
>>> --
>> Actually in the provided .vrt file I can see <SimpleSource
>> resample="bilinear">
>>
>> But isn't bilinear unsuitable for upsampling and some more blurring
>> method might work better?
>>
>> -Jukka Rahkonen-
>>
>>
>>
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From changliao.climate at gmail.com  Sat Aug 22 22:07:55 2020
From: changliao.climate at gmail.com (Chang Liao)
Date: Sat, 22 Aug 2020 23:07:55 -0600
Subject: [gdal-dev] I have a problem getting higher resolution in a VRT
	file
In-Reply-To: <ba53e3ec-b719-5b75-63d1-7642ec89511d@gmail.com>
References: <026c8323ec8e4918921e013b1e8432d3@C119S212VM042.msvyvi.vaha.local>
 <ba53e3ec-b719-5b75-63d1-7642ec89511d@gmail.com>
Message-ID: <CAOkqVM1Ee9zuNdE-A1W4DAoKGURV2f58xkUT7BVMePjmyjK91Q@mail.gmail.com>

Has anyone looked into the so called regrid in Earth system model? How is
it different from GIS resampling?

Grid Remapping

ESMF has the option to build a standalone application, called *RegridWeightGen
<http://www.earthsystemcog.org/projects/regridweightgen>*, that can
generate interpolation weights in parallel. It's fast and can handle a wide
variety of grids and grid options. It's not necessary to use the rest of
ESMF to use it ... just provide grid files in a standard (netCDF-based)
format.

https://www.earthsystemcog.org/projects/esmf/

Thanks.



On Thu, Aug 20, 2020 at 8:40 AM Stephen Woodbridge <
stephenwoodbridge37 at gmail.com> wrote:

> Jukka,
>
>
>
> Thanks those are great threads and very educational.
>
> I solved my problem. I was using upsample="bilinear" rather than
>
> upsampling="bilinear" and fixing this gave the expected results. But if
>
> not for my stupid typo, I would not have had a chance to read those
>
> threads and google others regarding upsampling.
>
>
>
> Thanks for the assist,
>
> -Steve
>
>
>
> On 8/20/2020 10:13 AM, Rahkonen Jukka (MML) wrote:
>
> > Hi,
>
> >
>
> > Resampling is science that would be nice to understand. Unfortunately I
> don't but I think that this thread is worth reading
> osgeo-org.1560.x6.nabble.com/gdal-dev-downsampling-geotiff-with-a-low-pass-filter-td5385890.html.
> In this gis.SE question cubic spline was considered good
> https://gis.stackexchange.com/questions/30627/smoothing-reinterpolating-raster-with-gdal
> .
>
> >
>
> > -Jukka-
>
> >
>
> > -----Alkuperäinen viesti-----
>
> > Lähettäjä: Stephen Woodbridge <stephenwoodbridge37 at gmail.com>
>
> > Lähetetty: torstai 20. elokuuta 2020 16.58
>
> > Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi
> >
>
> > Aihe: Re: [gdal-dev] I have a problem getting higher resolution in a VRT
> file
>
> >
>
> > Hi Jukka,
>
> >
>
> > Any thoughts on what would be a better way to upsample and image using
> GDAL?
>
> >
>
> > I assumed, maybe incorrectly, that if I’m up sampling between two pixels
> with values of say 1 and 2 that a new pixel 50% between them would get a
> value of 1.5 and at 25% would get a value 1.25 etc. using linear
> interpolation and bilinear would also account for rows above and below the
> current row.
>
> >
>
> > Even, I specified resampling=“bilinear” in the vrt file is this ignored?
>
> >
>
> > Thanks, Steve
>
> >
>
> > Sent from my iPhone
>
> >
>
> >> On Aug 20, 2020, at 8:23 AM, jratike80 <
> jukka.rahkonen at maanmittauslaitos.fi> wrote:
>
> >>
>
> >> ﻿Even Rouault-2 wrote
>
> >>> ...
>
> >>> By default, VRT uses nearest resampling. You must specify something
> else.
>
> >>> Look for "A resampling attribute can be specified" in
>
> >>> https://gdal.org/drivers/raster/vrt.html
>
> >>> ...
>
> >>>
>
> >>> --
>
> >> Actually in the provided .vrt file I can see <SimpleSource
>
> >> resample="bilinear">
>
> >>
>
> >> But isn't bilinear unsuitable for upsampling and some more blurring
>
> >> method might work better?
>
> >>
>
> >> -Jukka Rahkonen-
>
> >>
>
> >>
>
> >>
>
> >> --
>
> >> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
> >> _______________________________________________
>
> >> gdal-dev mailing list
>
> >> gdal-dev at lists.osgeo.org
>
> >> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
>
> gdal-dev mailing list
>
> gdal-dev at lists.osgeo.org
>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 

Best Regards!

Chang Liao,PhD
Earth Scientist, Atmospheric Sciences & Global Change Division
Pacific Northwest National Laboratory, WA, USA.
Email: changliao.climate at gmail.com  or  chang.liao at pnnl.gov
Personal Website: http://www.changliao.us
Skype: changliao1025
Lab Website: www.pnnl.gov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200822/59ebf0aa/attachment.html>

From marston.s.ward at nasa.gov  Mon Aug 24 04:26:02 2020
From: marston.s.ward at nasa.gov (Ward, Marston S. (GSFC-610.2)[ADNET SYSTEMS INC])
Date: Mon, 24 Aug 2020 11:26:02 +0000
Subject: [gdal-dev] [EXTERNAL] Re: I have a problem getting higher
 resolution in a VRT file
In-Reply-To: <CAOkqVM1Ee9zuNdE-A1W4DAoKGURV2f58xkUT7BVMePjmyjK91Q@mail.gmail.com>
References: <026c8323ec8e4918921e013b1e8432d3@C119S212VM042.msvyvi.vaha.local>
 <ba53e3ec-b719-5b75-63d1-7642ec89511d@gmail.com>
 <CAOkqVM1Ee9zuNdE-A1W4DAoKGURV2f58xkUT7BVMePjmyjK91Q@mail.gmail.com>
Message-ID: <AD9D4989-B660-4098-9DE9-96A353FD0D07@ndc.nasa.gov>

I’ve used ESMF quite a lot during my post doc as part of NCL. It’s a very good regridding tool; simple to use with lots of functionality.
Generating the weights, if you need to use this method, take a little time to create and then you simply apply them like a cookie cutter.

Hope this helps.


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Chang Liao <changliao.climate at gmail.com>
Date: Sunday, August 23, 2020 at 1:08 AM
To: Stephen Woodbridge <stephenwoodbridge37 at gmail.com>
Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>, "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
Subject: [EXTERNAL] Re: [gdal-dev] I have a problem getting higher resolution in a VRT file

Has anyone looked into the so called regrid in Earth system model? How is it different from GIS resampling?

Grid Remapping

ESMF has the option to build a standalone application, called RegridWeightGen<https://urldefense.proofpoint.com/v2/url?u=http-3A__www.earthsystemcog.org_projects_regridweightgen&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=EFiJgIB5umvn8U9J6NTmmwOCMqomMKWHVJ2SfD2Frzw&e=>, that can generate interpolation weights in parallel. It's fast and can handle a wide variety of grids and grid options. It's not necessary to use the rest of ESMF to use it ... just provide grid files in a standard (netCDF-based) format.
https://www.earthsystemcog.org/projects/esmf/<https://urldefense.proofpoint.com/v2/url?u=https-3A__www.earthsystemcog.org_projects_esmf_&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=TV4fXf7pZBWLsEO2JXG9-NOHXJmBYltuaFB_ors565w&e=>


Thanks.



On Thu, Aug 20, 2020 at 8:40 AM Stephen Woodbridge <stephenwoodbridge37 at gmail.com<mailto:stephenwoodbridge37 at gmail.com>> wrote:
Jukka,



Thanks those are great threads and very educational.

I solved my problem. I was using upsample="bilinear" rather than

upsampling="bilinear" and fixing this gave the expected results. But if

not for my stupid typo, I would not have had a chance to read those

threads and google others regarding upsampling.



Thanks for the assist,

-Steve



On 8/20/2020 10:13 AM, Rahkonen Jukka (MML) wrote:

> Hi,

>

> Resampling is science that would be nice to understand. Unfortunately I don't but I think that this thread is worth reading osgeo-org.1560.x6.nabble.com/gdal-dev-downsampling-geotiff-with-a-low-pass-filter-td5385890.html<https://urldefense.proofpoint.com/v2/url?u=http-3A__osgeo-2Dorg.1560.x6.nabble.com_gdal-2Ddev-2Ddownsampling-2Dgeotiff-2Dwith-2Da-2Dlow-2Dpass-2Dfilter-2Dtd5385890.html&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=TXal_lZrArPU-zbwrfexbsf2Qvb2PdRg2gftiuDHXA0&e=>. In this gis.SE question cubic spline was considered good https://gis.stackexchange.com/questions/30627/smoothing-reinterpolating-raster-with-gdal<https://urldefense.proofpoint.com/v2/url?u=https-3A__gis.stackexchange.com_questions_30627_smoothing-2Dreinterpolating-2Draster-2Dwith-2Dgdal&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=KVyQa0XWkQle90WMihPdsRUOo7rGYd0bcO4iavrq0H4&e=>.

>

> -Jukka-

>

> -----Alkuperäinen viesti-----

> Lähettäjä: Stephen Woodbridge <stephenwoodbridge37 at gmail.com<mailto:stephenwoodbridge37 at gmail.com>>

> Lähetetty: torstai 20. elokuuta 2020 16.58

> Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>

> Aihe: Re: [gdal-dev] I have a problem getting higher resolution in a VRT file

>

> Hi Jukka,

>

> Any thoughts on what would be a better way to upsample and image using GDAL?

>

> I assumed, maybe incorrectly, that if I’m up sampling between two pixels with values of say 1 and 2 that a new pixel 50% between them would get a value of 1.5 and at 25% would get a value 1.25 etc. using linear interpolation and bilinear would also account for rows above and below the current row.

>

> Even, I specified resampling=“bilinear” in the vrt file is this ignored?

>

> Thanks, Steve

>

> Sent from my iPhone

>

>> On Aug 20, 2020, at 8:23 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

>>

>> Even Rouault-2 wrote

>>> ...

>>> By default, VRT uses nearest resampling. You must specify something else.

>>> Look for "A resampling attribute can be specified" in

>>> https://gdal.org/drivers/raster/vrt.html<https://urldefense.proofpoint.com/v2/url?u=https-3A__gdal.org_drivers_raster_vrt.html&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=DF6beu2jDviD7F7np_eKCTpVWKapdeyv6tP9vMiUgMI&e=>

>>> ...

>>>

>>> --

>> Actually in the provided .vrt file I can see <SimpleSource

>> resample="bilinear">

>>

>> But isn't bilinear unsuitable for upsampling and some more blurring

>> method might work better?

>>

>> -Jukka Rahkonen-

>>

>>

>>

>> --

>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html<https://urldefense.proofpoint.com/v2/url?u=http-3A__osgeo-2Dorg.1560.x6.nabble.com_GDAL-2DDev-2Df3742093.html&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=d6jyxN2ZrEBQFC__T8Sj1oYs-UlIf_IsN4-GlqyWSMs&e=>

>> _______________________________________________

>> gdal-dev mailing list

>> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

>> https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.proofpoint.com/v2/url?u=https-3A__lists.osgeo.org_mailman_listinfo_gdal-2Ddev&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=HYO2u9pVjsgZZdTsYzwmPnQjySGNLExwnPch7xzADEk&e=>



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.proofpoint.com/v2/url?u=https-3A__lists.osgeo.org_mailman_listinfo_gdal-2Ddev&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=HYO2u9pVjsgZZdTsYzwmPnQjySGNLExwnPch7xzADEk&e=>
--

Best Regards!

Chang Liao,PhD
Earth Scientist, Atmospheric Sciences & Global Change Division
Pacific Northwest National Laboratory, WA, USA.
Email: changliao.climate at gmail.com<https://urldefense.proofpoint.com/v2/url?u=http-3A__gmail.com&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=Daly4H0zoTYR6l714C4-xmuxXmbBdgvgEB6Q2Q1APik&e=>  or  chang.liao at pnnl.gov<https://urldefense.proofpoint.com/v2/url?u=http-3A__pnnl.gov&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=hvD2SncYX8BOZU4_p_tfZbj7HT_EhtW0-L3gygXDwTo&e=>
Personal Website: http://www.changliao.us<https://urldefense.proofpoint.com/v2/url?u=http-3A__www.changliao.us&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=i6nmco-w6hzW_6TrSwilbgHHHAK7C87GyXJgBKQ9yDs&e=>
Skype: changliao1025
Lab Website: www.pnnl.gov<https://urldefense.proofpoint.com/v2/url?u=http-3A__www.pnnl.gov&d=DwMFaQ&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=d9-Whdnf-TOkbqVja3ETyUOqHlFR1HbcWZvN0tb4JWU&m=gJ67R1rqmEZ1CNR6ZzSSdq0oVg69YSk0jOF6JHJUWqE&s=wEUuOfig7XjI1-Uem_tPSB9ZeYcmwgkXjVEmyFqO2EI&e=>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200824/6aebfb96/attachment-0001.html>

From aazmp at yandex.ru  Mon Aug 24 07:47:24 2020
From: aazmp at yandex.ru (=?utf-8?B?0J/QtdGB0L7RhtC60LjQuSDQnNCw0LrRgdC40Lw=?=)
Date: Mon, 24 Aug 2020 17:47:24 +0300
Subject: [gdal-dev] OGRCoordinateTransformation::Transform with multiple
	threads
Message-ID: <1286481598277151@mail.yandex.ru>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200824/edf76d37/attachment.html>

From even.rouault at spatialys.com  Tue Aug 25 02:03:05 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Aug 2020 11:03:05 +0200
Subject: [gdal-dev] OGRCoordinateTransformation::Transform with multiple
	threads
In-Reply-To: <1286481598277151@mail.yandex.ru>
References: <1286481598277151@mail.yandex.ru>
Message-ID: <5509520.LoF9ts5zxU@even-i700>

Maxim,

> my question is
> starting from gdal-3.x OGRCoordinateTransformation object (::Transform() in
> particular) is not intended to be used by multiple threads? With gdal-2.4
> it worked fine.

OGRCoordinateTransformation, as most objects in GDAL, instances have never 
been intended from being used by multiple threads. That it might have worked in 
2.4 was an implementation detail.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200825/4d01efe1/attachment.html>

From Mika.Heiskanen at fmi.fi  Tue Aug 25 03:04:10 2020
From: Mika.Heiskanen at fmi.fi (Heiskanen Mika (FMI))
Date: Tue, 25 Aug 2020 10:04:10 +0000
Subject: [gdal-dev] OGRCoordinateTransformation::Transform with
	multiple	threads
In-Reply-To: <5509520.LoF9ts5zxU@even-i700>
References: <1286481598277151@mail.yandex.ru>,<5509520.LoF9ts5zxU@even-i700>
Message-ID: <1598349850411.23192@fmi.fi>

?

> ?> my question is

> > starting from gdal-3.x OGRCoordinateTransformation object (::Transform() in

> > particular) is not intended to be used by multiple threads? With gdal-2.4

> > it worked fine.

> > OGRCoordinateTransformation, as most objects in GDAL, instances have never been

> intended from being used by multiple threads. That it might have worked in 2.4 was an implementation detail.

> > Even


The OGRCoordinateTransformation implementation class defines several (over 20) data members. Some of
them are altered during a transformation, and hence the implementation is not thread safe. At least the
variables used for reverse checking the result could be placed into the Transform method instead to improve
thread safety. However, since there were some many member variables I did not check them all.

Mika

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200825/c65ce89b/attachment.html>

From palmerjnz at gmail.com  Tue Aug 25 03:58:39 2020
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Tue, 25 Aug 2020 20:58:39 +1000
Subject: [gdal-dev] Linking error when building Informix OGR driver
Message-ID: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>

Hi All,

I'm getting linking issues trying to build the Informix driver.

I've installed the informix SDK and added the following libraries
to /etc/ld.so.conf.d/informix-client-sdk.conf and then run sudo ldconfig:

/opt/IBM/Informix_Client-SDK/lib
/opt/IBM/Informix_Client-SDK/lib/dmi
/opt/IBM/Informix_Client-SDK/lib/esql
/opt/IBM/Informix_Client-SDK/lib/c++

Then configured GDAL:

./configure \
    --with-hide-internal-symbols=yes \
    --with-libtiff=internal \
    --with-geotiff=internal \
    --with-rename-internal-libtiff-symbols=yes \
    --with-rename-internal-libgeotiff-symbols=yes \
    --with-threads \
    --with-jpeg12  \
    --with-webp \
    --with-armadillo=yes \
    --with-cfitsio=no \
    --with-charls \
    --with-curl \
    --with-ecw=no \
    --with-epsilon=/usr \
    --with-freexl=yes \
    --with-geos \
    --with-geotiff=yes \
    --with-grass=no \
    --with-libkml=yes \
    --with-liblzma=yes \
    --with-libtiff=internal \
    --with-mrsid=no \
    --with-mysql \
    --with-netcdf \
    --with-odbc \
    --with-ogdi \
    --with-openjpeg=yes \
    --with-pg \
    --with-poppler=yes \
    --with-sosi=yes \
    --with-spatialite=/usr \
    --with-sqlite3 \
    --with-xerces \
    --with-zstd \
    --with-dods-root=/usr \
    --with-proj \
    --with-python=python3.6 \
    --with-idb=/opt/ifx/informix

Then I run make which is ok until linking of app tools:

/bin/bash /home/informix/dev/gdal/gdal/libtool --mode=link --silent g++
 gdalinfo_bin.lo  /home/informix/dev/gdal/gdal/libgdal.la  -o gdalinfo
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`mi_cleanup'
... heaps of informix function references
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`_ifx_gl_mbsrchr'
collect2: error: ld returned 1 exit status
GNUmakefile:90: recipe for target 'gdalinfo' failed
make[1]: *** [gdalinfo] Error 1
make[1]: Leaving directory '/home/informix/dev/gdal/gdal/apps'
GNUmakefile:120: recipe for target 'apps-target' failed
make: *** [apps-target] Error 2

The creation of the main gdal library seems to include the correct informix
SDK library link options:

/bin/bash /home/informix/dev/gdal/gdal/libtool --mode=link --silent g++
-lIlmImf -lImath -lHalf -lIex -lIexMath -lIlmThread -lpthread -lcryptopp
-larmadillo -lpoppler -lfreexl -lgeos_c -lwebp -L/usr/lib -lepsilon -lodbc
-lodbcinst -lkmlbase -lkmldom -lkmlengine -lkmlxsd -lkmlregionator -lexpat
-lxerces-c -lpthread -lopenjp2 -L/usr/lib/x86_64-linux-gnu/hdf5/serial
-lnetcdf -lhdf5_hl -lhdf5 -lpthread -lsz -lz -ldl -lm -lcurl
-L/usr/lib/x86_64-linux-gnu/hdf5/serial -lhdf5 -lmfhdfalt -ldfalt -logdi
-lgif -lCharLS -ljpeg -lpng -lpq -lzstd -llzma  -lsqlite3 -lproj
-lsqlite3 -lz -lpthread -lm -lrt -ldl  -L/usr/lib -lspatialite -ldapclient
-ldapserver -ldap -lpcre   -lcurl       -lfyba -lfygm -lfyut     -lxml2
-lmysqlclient -lpthread -lz -lm -lrt -latomic -lssl -lcrypto -ldl
 -L/opt/IBM/Informix_Client-SDK/lib/
-L/opt/IBM/Informix_Client-SDK/lib/esql -lifsql -lifasf -lifgen -lifos
-lifgls -lifglx /opt/IBM/Informix_Client-SDK/lib/esql/checkapi.o
-L/opt/IBM/Informix_Client-SDK/lib/dmi -lifdmi
-L/opt/IBM/Informix_Client-SDK/lib/c++ -lifc++ -o libgdal.la \

I've checked all the references and they are located with
the /opt/IBM/Informix_Client-SDK libraries. e.g:

find /opt/IBM/Informix_Client-SDK/ -name '*.so*' -exec nm --print-file-name
--defined-only --dynamic {} \; | grep _ifx_gl_mbsrchr
/opt/IBM/Informix_Client-SDK/lib/esql/libifgls.so:0000000000028208 T
_ifx_gl_mbsrchr
/opt/IBM/Informix_Client-SDK/lib/esql/igl4a304.so:0000000000028208 T
_ifx_gl_mbsrchr
/opt/IBM/Informix_Client-SDK/lib/esql/libixgls.so:0000000000028208 T
_ifx_gl_mbsrchr

I'm compiling with:
* Ubuntu 18.04
* GDAL master
* IBM Informix Client-SDK 4.50.FC4W1 (
https://iwm.dhe.ibm.com/sdfdl/2v2/regs2/mstadm/informix/Xa.2/Xb.YBTN_DlRQlu95txYUUjNOjNrRzaQlAW03TtXUaXSBO8/Xc.ibm.csdk.4.50.FC4W1.LNX.tar/Xd./Xf.LPr.D1vk/Xg.10862767/Xi.ifxdl/XY.regsrvs/XZ.kFM8MiB-VbL9cNlfSPfj_mkY-YI/ibm.csdk.4.50.FC4W1.LNX.tar
)

Any help would be much appreciated.

Cheers
Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200825/0be579a4/attachment.html>

From mateusz at loskot.net  Tue Aug 25 04:11:36 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 25 Aug 2020 13:11:36 +0200
Subject: [gdal-dev] Linking error when building Informix OGR driver
In-Reply-To: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
References: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
Message-ID: <CABUeae9PUXDyQzs=V33RPTUwAj4J-wXf8doZZUBmAFLbSiUp3g@mail.gmail.com>

On Tue, 25 Aug 2020 at 12:58, Jeremy Palmer <palmerjnz at gmail.com> wrote:
>
> Then I run make which is ok until linking of app tools:
>
> /bin/bash /home/informix/dev/gdal/gdal/libtool --mode=link --silent g++  gdalinfo_bin.lo  /home/informix/dev/gdal/gdal/libgdal.la  -o gdalinfo
> /opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to `mi_cleanup'
> ... heaps of informix function references
> /opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to `_ifx_gl_mbsrchr'
> collect2: error: ld returned 1 exit status
> GNUmakefile:90: recipe for target 'gdalinfo' failed
> make[1]: *** [gdalinfo] Error 1
> make[1]: Leaving directory '/home/informix/dev/gdal/gdal/apps'
> GNUmakefile:120: recipe for target 'apps-target' failed
> make: *** [apps-target] Error 2

See this thread, and try the GitHub link at the bottom
https://lists.osgeo.org/pipermail/gdal-dev/2017-September/047275.html


Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From palmerjnz at gmail.com  Tue Aug 25 05:16:33 2020
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Tue, 25 Aug 2020 22:16:33 +1000
Subject: [gdal-dev] Linking error when building Informix OGR driver
In-Reply-To: <CABUeae9PUXDyQzs=V33RPTUwAj4J-wXf8doZZUBmAFLbSiUp3g@mail.gmail.com>
References: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
 <CABUeae9PUXDyQzs=V33RPTUwAj4J-wXf8doZZUBmAFLbSiUp3g@mail.gmail.com>
Message-ID: <CAA5WJY=9ictFRimuKJXV5kK9jWCo+AHi6TTKFTN0gMxNmZNvrQ@mail.gmail.com>

Thanks Mateusz.

I still get linking errors with that patch applied. However, the SDK
libraries are now in the linking tool arguments:

/bin/bash /home/informix/dev/gdal/gdal/libtool --mode=link --silent g++
 -L/opt/IBM/Informix_Client-SDK/lib/
-L/opt/IBM/Informix_Client-SDK/lib/esql -lifsql -lifasf -lifgen -lifos
-lifgls -lifglx /opt/IBM/Informix_Client-SDK/lib/esql/checkapi.o
-L/opt/IBM/Informix_Client-SDK/lib/dmi -lifdmi
-L/opt/IBM/Informix_Client-SDK/lib/c++ -lifc++ -lcrypt gdalinfo_bin.lo
 /home/informix/dev/gdal/gdal/libgdal.la  -o gdalinfo
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`mi_cleanup'
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`ifx_int8cvasc'
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`mi_typeid_is_distinct'
....
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`mi_lo_seek'
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`mi_typeid_is_constructor'
/opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
`_ifx_gl_mbsrchr'
collect2: error: ld returned 1 exit status
GNUmakefile:94: recipe for target 'gdalinfo' failed
make[1]: *** [gdalinfo] Error 1
make[1]: Leaving directory '/home/informix/dev/gdal/gdal/apps'
GNUmakefile:120: recipe for target 'apps-target' failed
make: *** [apps-target] Error 2


On Tue, Aug 25, 2020 at 9:10 PM Mateusz Loskot <mateusz at loskot.net> wrote:

> On Tue, 25 Aug 2020 at 12:58, Jeremy Palmer <palmerjnz at gmail.com> wrote:
> >
> > Then I run make which is ok until linking of app tools:
> >
> > /bin/bash /home/informix/dev/gdal/gdal/libtool --mode=link --silent g++
> gdalinfo_bin.lo  /home/informix/dev/gdal/gdal/libgdal.la  -o gdalinfo
> > /opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
> `mi_cleanup'
> > ... heaps of informix function references
> > /opt/IBM/Informix_Client-SDK/lib/c++/libifc++.so: undefined reference to
> `_ifx_gl_mbsrchr'
> > collect2: error: ld returned 1 exit status
> > GNUmakefile:90: recipe for target 'gdalinfo' failed
> > make[1]: *** [gdalinfo] Error 1
> > make[1]: Leaving directory '/home/informix/dev/gdal/gdal/apps'
> > GNUmakefile:120: recipe for target 'apps-target' failed
> > make: *** [apps-target] Error 2
>
> See this thread, and try the GitHub link at the bottom
> https://lists.osgeo.org/pipermail/gdal-dev/2017-September/047275.html
>
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200825/aae0e9f7/attachment-0001.html>

From mateusz at loskot.net  Tue Aug 25 05:39:23 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 25 Aug 2020 14:39:23 +0200
Subject: [gdal-dev] Linking error when building Informix OGR driver
In-Reply-To: <CAA5WJY=9ictFRimuKJXV5kK9jWCo+AHi6TTKFTN0gMxNmZNvrQ@mail.gmail.com>
References: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
 <CABUeae9PUXDyQzs=V33RPTUwAj4J-wXf8doZZUBmAFLbSiUp3g@mail.gmail.com>
 <CAA5WJY=9ictFRimuKJXV5kK9jWCo+AHi6TTKFTN0gMxNmZNvrQ@mail.gmail.com>
Message-ID: <CABUeae_LQYxVSsT=vdL+DqyGmyef26ZAcFLMc-8vcwndbv8GsQ@mail.gmail.com>

On Tue, 25 Aug 2020 at 14:16, Jeremy Palmer <palmerjnz at gmail.com> wrote:
>
> Thanks Mateusz.
>
> I still get linking errors with that patch applied.
> However, the SDK libraries are now in the linking tool arguments:

¯\_(ツ)_/¯

Try to completely clean and re-build, perhaps

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From palmerjnz at gmail.com  Tue Aug 25 19:23:52 2020
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Wed, 26 Aug 2020 12:23:52 +1000
Subject: [gdal-dev] Linking error when building Informix OGR driver
In-Reply-To: <CAA5WJY=-fjDcUub+sBMgGTS6Rj8dLay+pkoL7pohhWC=Nh42Ww@mail.gmail.com>
References: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
 <CABUeae9PUXDyQzs=V33RPTUwAj4J-wXf8doZZUBmAFLbSiUp3g@mail.gmail.com>
 <CAA5WJY=9ictFRimuKJXV5kK9jWCo+AHi6TTKFTN0gMxNmZNvrQ@mail.gmail.com>
 <CABUeae_LQYxVSsT=vdL+DqyGmyef26ZAcFLMc-8vcwndbv8GsQ@mail.gmail.com>
 <CAA5WJY=-fjDcUub+sBMgGTS6Rj8dLay+pkoL7pohhWC=Nh42Ww@mail.gmail.com>
Message-ID: <CAA5WJY=gBjaKDbf=cB+iTbkJ3c1buHisitvBw369n7J4HmT01g@mail.gmail.com>

I tried a full clean, configure, and make and I still get the same message.

I've also tried recording the libraries in the linking process
e.g -lifglx before and after  -lifdmi -lifsql -lifasf -lifgen -lifos
-lifgls and -lifglx before and after libgdal.so, but it still doesn't work.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200826/c88cb0b4/attachment.html>

From ian at planetmayo.com  Wed Aug 26 05:40:30 2020
From: ian at planetmayo.com (Ian Mayo)
Date: Wed, 26 Aug 2020 13:40:30 +0100
Subject: [gdal-dev] Can a GepPDF be generated using a Composition file from
	command line?
In-Reply-To: <CAHWjJFandWWrExbe=FQ54vfakHHMC9uA9CQ3yxfsTwWgWFCTgw@mail.gmail.com>
References: <CAHWjJFandWWrExbe=FQ54vfakHHMC9uA9CQ3yxfsTwWgWFCTgw@mail.gmail.com>
Message-ID: <CAHWjJFbAzQHNMeqknjKtFKmTg9vZh=-kZo8y0x-n-N7xxJ+BuA@mail.gmail.com>

The documentation page for PDF via GDAL includes the description for
using an XML Composition File:
https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0

But, the description only gives examples of the XML Composition file
being used from C++ or Python code.

Is it possible to use the XML Composition file directly from GDAL
commands on the command line?

(presumably the Composition file would be passed as a -co creation
option parameter)

Thanks,
Ian

From andrew at aitchison.me.uk  Wed Aug 26 05:50:41 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 26 Aug 2020 13:50:41 +0100 (BST)
Subject: [gdal-dev] Can a GepPDF be generated using a Composition file
 from command line?
In-Reply-To: <CAHWjJFbAzQHNMeqknjKtFKmTg9vZh=-kZo8y0x-n-N7xxJ+BuA@mail.gmail.com>
References: <CAHWjJFandWWrExbe=FQ54vfakHHMC9uA9CQ3yxfsTwWgWFCTgw@mail.gmail.com>
 <CAHWjJFbAzQHNMeqknjKtFKmTg9vZh=-kZo8y0x-n-N7xxJ+BuA@mail.gmail.com>
Message-ID: <alpine.DEB.2.23.453.2008261347410.1078733@warden.aitchison.me.uk>

On Wed, 26 Aug 2020, Ian Mayo wrote:

> The documentation page for PDF via GDAL includes the description for
> using an XML Composition File:
> https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0
>
> But, the description only gives examples of the XML Composition file
> being used from C++ or Python code.
>
> Is it possible to use the XML Composition file directly from GDAL
> commands on the command line?

That page links to
https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/swig/python/samples/gdal_create_pdf.py
which is a python script to do exactly that.

> (presumably the Composition file would be passed as a -co creation
> option parameter)

def Usage():
     print('Usage: gdal_create_pdf composition.xml out.pdf')
     return -1

... so you don't even need the "-co" argument.

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From ian at planetmayo.com  Wed Aug 26 06:03:47 2020
From: ian at planetmayo.com (Ian Mayo)
Date: Wed, 26 Aug 2020 14:03:47 +0100
Subject: [gdal-dev] Can a GepPDF be generated using a Composition file
 from command line?
In-Reply-To: <alpine.DEB.2.23.453.2008261347410.1078733@warden.aitchison.me.uk>
References: <CAHWjJFandWWrExbe=FQ54vfakHHMC9uA9CQ3yxfsTwWgWFCTgw@mail.gmail.com>
 <CAHWjJFbAzQHNMeqknjKtFKmTg9vZh=-kZo8y0x-n-N7xxJ+BuA@mail.gmail.com>
 <alpine.DEB.2.23.453.2008261347410.1078733@warden.aitchison.me.uk>
Message-ID: <CAHWjJFYh6vj9aBDKQw9f_OZf2d2r2Z+qzuskk7iFBOmcQwnFjQ@mail.gmail.com>

Hello Andrew,
thanks for the (very) prompt response.

I'm aware of the Python route - I referred to it in my posting.

My context is that I'd like to generate the PDF on a system that only
has GDAL installed.  Your strategy would involve distributing (and
maintaining) a python distribution too.

So, I guess my question remains:

"Is it possible to use the XML Composition file directly from GDAL
commands on the command line?"

Thanks for your support,
Ian

On Wed, 26 Aug 2020 at 13:50, Andrew C Aitchison <andrew at aitchison.me.uk> wrote:
>
> On Wed, 26 Aug 2020, Ian Mayo wrote:
>
> > The documentation page for PDF via GDAL includes the description for
> > using an XML Composition File:
> > https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0
> >
> > But, the description only gives examples of the XML Composition file
> > being used from C++ or Python code.
> >
> > Is it possible to use the XML Composition file directly from GDAL
> > commands on the command line?
>
> That page links to
> https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/swig/python/samples/gdal_create_pdf.py
> which is a python script to do exactly that.
>
> > (presumably the Composition file would be passed as a -co creation
> > option parameter)
>
> def Usage():
>      print('Usage: gdal_create_pdf composition.xml out.pdf')
>      return -1
>
> ... so you don't even need the "-co" argument.
>
> --
> Andrew C. Aitchison                                     Kendal, UK
>                         andrew at aitchison.me.uk



-- 
Ian Mayo
Deep Blue C Technology Ltd
- New technologies, implemented well

From rykovd at gmail.com  Wed Aug 26 09:18:39 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Wed, 26 Aug 2020 18:18:39 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading with
 specified resampling method
Message-ID: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>

I have remote *.vrt raster and *.vrt.ovr accessible through HTTP. When I
run the following script with rasterio:

with rasterio.open("http://*.vrt"") as src:
    image = src.read(indexes=[1, 2, 3], **{
        "window": Window(col_off=6961, row_off=105176, width=5671, height=5648),
        "resampling": Resampling.cubic,
        "boundless": True,
        "out_shape": (3, 383, 385),
        "masked": True
    })

depending on "resampling" algorithm GDAL sends different amounts of
requests to the server. In the case of "cubic" it doesn't take into account
overviews and sends requests directly to *.tif files (900 in my case). In
case of "nearest" everything is ok (only 60 requests, *.vrt.ovr is taken
into account).

Does GDAL check the resampling algorithm of overviews and in case it
differs from the option specified in read() method they are bypassed or it
works differently?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200826/c2f49e1f/attachment.html>

From ian at planetmayo.com  Wed Aug 26 12:16:35 2020
From: ian at planetmayo.com (Ian Mayo)
Date: Wed, 26 Aug 2020 20:16:35 +0100
Subject: [gdal-dev] Can a GepPDF be generated using a Composition file
 from command line?
In-Reply-To: <CAHWjJFYh6vj9aBDKQw9f_OZf2d2r2Z+qzuskk7iFBOmcQwnFjQ@mail.gmail.com>
References: <CAHWjJFandWWrExbe=FQ54vfakHHMC9uA9CQ3yxfsTwWgWFCTgw@mail.gmail.com>
 <CAHWjJFbAzQHNMeqknjKtFKmTg9vZh=-kZo8y0x-n-N7xxJ+BuA@mail.gmail.com>
 <alpine.DEB.2.23.453.2008261347410.1078733@warden.aitchison.me.uk>
 <CAHWjJFYh6vj9aBDKQw9f_OZf2d2r2Z+qzuskk7iFBOmcQwnFjQ@mail.gmail.com>
Message-ID: <CAHWjJFamYU5d8WW3c-SdUg2B95Beg8dC9OvJ-OGXyp4Rztuhdw@mail.gmail.com>

aah, a team member has directed me to where this question got asked (&
answered) a few days ago:
https://lists.osgeo.org/pipermail/gdal-dev/2020-August/052505.html

On Wed, 26 Aug 2020, 14:03 Ian Mayo, <ian at planetmayo.com> wrote:

> Hello Andrew,
> thanks for the (very) prompt response.
>
> I'm aware of the Python route - I referred to it in my posting.
>
> My context is that I'd like to generate the PDF on a system that only
> has GDAL installed.  Your strategy would involve distributing (and
> maintaining) a python distribution too.
>
> So, I guess my question remains:
>
> "Is it possible to use the XML Composition file directly from GDAL
> commands on the command line?"
>
> Thanks for your support,
> Ian
>
> On Wed, 26 Aug 2020 at 13:50, Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
> >
> > On Wed, 26 Aug 2020, Ian Mayo wrote:
> >
> > > The documentation page for PDF via GDAL includes the description for
> > > using an XML Composition File:
> > >
> https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0
> > >
> > > But, the description only gives examples of the XML Composition file
> > > being used from C++ or Python code.
> > >
> > > Is it possible to use the XML Composition file directly from GDAL
> > > commands on the command line?
> >
> > That page links to
> >
> https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/swig/python/samples/gdal_create_pdf.py
> > which is a python script to do exactly that.
> >
> > > (presumably the Composition file would be passed as a -co creation
> > > option parameter)
> >
> > def Usage():
> >      print('Usage: gdal_create_pdf composition.xml out.pdf')
> >      return -1
> >
> > ... so you don't even need the "-co" argument.
> >
> > --
> > Andrew C. Aitchison                                     Kendal, UK
> >                         andrew at aitchison.me.uk
>
>
>
> --
> Ian Mayo
> Deep Blue C Technology Ltd
> - New technologies, implemented well
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200826/8841f296/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 26 13:40:55 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 26 Aug 2020 20:40:55 +0000
Subject: [gdal-dev] Wrong sliding when AREA_OR_POINT metadata is edited?
Message-ID: <59550dff626c4a32b1ff8ad0aedcfa30@C119S212VM042.msvyvi.vaha.local>

Hi,

See this and find test data and example commands https://github.com/opengeospatial/OGC-API-Sprint-August-2020/issues/18.

If PixelIsPoint image has these GeoTIFF tags

Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (8,3):
         0                 0                 0
         -90               90                0
         1024              0                 0
         0                 90                0
         0                 1024              0
         -90               0                 0
         1024              1024              0
         0                 0                 0
      End_Of_Tags.
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeGeographic
      GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint

and PixelIsArea has the same tags except GTRasterTypeGeoKey (Short,1): RasterPixelIsArea

Now shouldn't the PixelIsPoint image slide half a pixel to the left and upwards compared to PixelIsArea image? If I run these images through gdalwarp the warped pixel_is_area image shows corner coordinates Upper Left  (-180.0000000,  90.0000000) and pixel_is_point image Upper Left  (-179.9560547,  89.9560547), so sliding happens to the right and downwards.

It is late and I feel fuzzy but shouldn't the pixel_is_point variant has smaller easting, greater northing instead, thus (-180,0439453, 90,04394531)?

The images are georeferenced with tiepoints/GCPs, perhaps it adds something to the soup?

-Jukka Rahkonen-




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200826/e21d7992/attachment.html>

From even.rouault at spatialys.com  Wed Aug 26 14:24:40 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Aug 2020 23:24:40 +0200
Subject: [gdal-dev] Wrong sliding when AREA_OR_POINT metadata is edited?
In-Reply-To: <59550dff626c4a32b1ff8ad0aedcfa30@C119S212VM042.msvyvi.vaha.local>
References: <59550dff626c4a32b1ff8ad0aedcfa30@C119S212VM042.msvyvi.vaha.local>
Message-ID: <3108753.iZApPFzVJy@even-i700>

Jukka,
> It is late and I feel fuzzy but shouldn't the pixel_is_point variant has
> smaller easting, greater northing instead, thus (-180,0439453,
> 90,04394531)?
> 
> The images are georeferenced with tiepoints/GCPs, perhaps it adds something
> to the soup?

I concur with your analysis. The compensation done by GDAL to report georeferencing in its 
usual way is done in the wrong direction here. This is specific to tiepoints (geotransform case 
is a different code path), and it appears that this wasn't tested in RFC33 implementation.

Pending fix per
https://github.com/OSGeo/gdal/pull/2892

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200826/e358bb8e/attachment.html>

From even.rouault at spatialys.com  Wed Aug 26 15:54:40 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Aug 2020 00:54:40 +0200
Subject: [gdal-dev] Linking error when building Informix OGR driver
In-Reply-To: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
References: <CAA5WJYkgkHB1fXscBHf2_YghQszJZWyyRQ5ExopvKFFmfKBiTQ@mail.gmail.com>
Message-ID: <2876461.Fvx1APAjl4@even-i700>

Jeremy,

> I'm getting linking issues trying to build the Informix driver.

Fixed per
https://github.com/OSGeo/gdal/commit/
91416c6c69ac6a768893bfc8d2a447c2e146b4ab

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/c417bec5/attachment-0001.html>

From rykovd at gmail.com  Thu Aug 27 03:41:23 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Thu, 27 Aug 2020 12:41:23 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading
 with specified resampling method
In-Reply-To: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
Message-ID: <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>

I was able to reproduce this issue with pure GDAL. When you read data with
boundless=True in rasterio it creates an intermediate VRT file. This is the
example of file that being created in my case:

<?xml version="1.0" encoding="UTF-8"?>
	<VRTDataset rasterXSize="40961" rasterYSize="139265">
		<SRS>PROJCS["WGS 84 / UTM zone 47N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",99],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32647"]]</SRS>
		<GeoTransform>443070.0,1.0,0.0,4366312.0,0.0,-1.0</GeoTransform>
		<VRTRasterBand band="1" dataType="Byte">
			<NoDataValue>0.0</NoDataValue>
			<ColorInterp>Red</ColorInterp>
			<ComplexSource>
				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
				<SourceBand>1</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<ScaleRatio>0</ScaleRatio>
				<ScaleOffset>0.0</ScaleOffset>
			</ComplexSource>
			<ComplexSource>
				<SourceFilename relativeToVRT="0"
shared="0">/vsicurl/https://*.vrt</SourceFilename>
				<SourceBand>1</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
				<NODATA>0.0</NODATA>
				<OpenOptions /> </ComplexSource>
		</VRTRasterBand>
		<VRTRasterBand band="2" dataType="Byte">
			<NoDataValue>0.0</NoDataValue>
			<ColorInterp>Green</ColorInterp>
			<ComplexSource>
				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
				<SourceBand>2</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<ScaleRatio>0</ScaleRatio>
				<ScaleOffset>0.0</ScaleOffset>
			</ComplexSource>
			<ComplexSource>
				<SourceFilename relativeToVRT="0"
shared="0">/vsicurl/https://*.vrt</SourceFilename>
				<SourceBand>2</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
				<NODATA>0.0</NODATA>
				<OpenOptions /> </ComplexSource>
		</VRTRasterBand>
		<VRTRasterBand band="3" dataType="Byte">
			<NoDataValue>0.0</NoDataValue>
			<ColorInterp>Blue</ColorInterp>
			<ComplexSource>
				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
				<SourceBand>3</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
				<ScaleRatio>0</ScaleRatio>
				<ScaleOffset>0.0</ScaleOffset>
			</ComplexSource>
			<ComplexSource>
				<SourceFilename relativeToVRT="0"
shared="0">/vsicurl/https://*.vrt</SourceFilename>
				<SourceBand>3</SourceBand>
				<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
				<NODATA>0.0</NODATA>
				<OpenOptions /> </ComplexSource>
		</VRTRasterBand>
		<MaskBand>
			<VRTRasterBand dataType="Byte">
				<SimpleSource>
					<SourceFilename relativeToVRT="0"
shared="0">/vsicurl/https://*.vrt</SourceFilename>
					<SourceBand>mask,1</SourceBand>
					<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
					<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
					<DstRect xOff="-6961.0" xSize="40960" yOff="-105176.0"
ySize="139264" /> </SimpleSource>
			</VRTRasterBand>
		</MaskBand>
	</VRTDataset>

If I read data from this file with gdal using
resample_alg=gdalconst.GRIORA_NearestNeighbour then GDAL takes into
account *.vrt.ovr file and sends very few HTTP requests to the server
(~30):

ds = gdal.OpenEx("/tmp/rasterio.vrt")
image = ds.ReadAsArray(xoff=0, yoff=0, xsize=5671, ysize=5648,
buf_xsize=383, buf_ysize=385,
resample_alg=gdalconst.GRIORA_NearestNeighbour

If I do the same but using resample_alg=gdalconst.GRIORA_Cubic then GDAL
sends a huge amount of requests to the server (~1k) because overviews are
not used:

ds = gdal.OpenEx("/tmp/rasterio.vrt")
image = ds.ReadAsArray(xoff=0, yoff=0, xsize=5671, ysize=5648,
buf_xsize=383, buf_ysize=385, resample_alg=gdalconst.GRIORA_Cubic

Is it expected or might there be something wrong with that VRT file? Thanks
in advance for any help.

On Wed, Aug 26, 2020 at 6:18 PM Denis Rykov <rykovd at gmail.com> wrote:

> I have remote *.vrt raster and *.vrt.ovr accessible through HTTP. When I
> run the following script with rasterio:
>
> with rasterio.open("http://*.vrt"") as src:
>     image = src.read(indexes=[1, 2, 3], **{
>         "window": Window(col_off=6961, row_off=105176, width=5671, height=5648),
>         "resampling": Resampling.cubic,
>         "boundless": True,
>         "out_shape": (3, 383, 385),
>         "masked": True
>     })
>
> depending on "resampling" algorithm GDAL sends different amounts of
> requests to the server. In the case of "cubic" it doesn't take into account
> overviews and sends requests directly to *.tif files (900 in my case). In
> case of "nearest" everything is ok (only 60 requests, *.vrt.ovr is taken
> into account).
>
> Does GDAL check the resampling algorithm of overviews and in case it
> differs from the option specified in read() method they are bypassed or it
> works differently?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/7b0fcdcd/attachment-0001.html>

From rykovd at gmail.com  Thu Aug 27 06:08:02 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Thu, 27 Aug 2020 15:08:02 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading
 with specified resampling method
In-Reply-To: <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
 <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
Message-ID: <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>

I found the culprit. If remove this section from each band definition in
VRT file then everything works fine:

<ComplexSource>
	<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
	<SourceBand>3</SourceBand>
	<SourceProperties BlockXSize="128" BlockYSize="128"
RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
	<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
	<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
	<ScaleRatio>0</ScaleRatio>
	<ScaleOffset>0.0</ScaleOffset></ComplexSource

Rasterio's code that builds this code was altered 2 years ago after
conversation in OSGeo/gdal#1135 <https://github.com/OSGeo/gdal/issues/1135>.
But it has this undesirable consequence I'm experiencing. Any ideas how to
overcome that?

On Thu, Aug 27, 2020 at 12:41 PM Denis Rykov <rykovd at gmail.com> wrote:

> I was able to reproduce this issue with pure GDAL. When you read data with
> boundless=True in rasterio it creates an intermediate VRT file. This is the
> example of file that being created in my case:
>
> <?xml version="1.0" encoding="UTF-8"?>
> 	<VRTDataset rasterXSize="40961" rasterYSize="139265">
> 		<SRS>PROJCS["WGS 84 / UTM zone 47N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",99],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32647"]]</SRS>
> 		<GeoTransform>443070.0,1.0,0.0,4366312.0,0.0,-1.0</GeoTransform>
> 		<VRTRasterBand band="1" dataType="Byte">
> 			<NoDataValue>0.0</NoDataValue>
> 			<ColorInterp>Red</ColorInterp>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
> 				<SourceBand>1</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<ScaleRatio>0</ScaleRatio>
> 				<ScaleOffset>0.0</ScaleOffset>
> 			</ComplexSource>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="0" shared="0">/vsicurl/https://*.vrt</SourceFilename>
> 				<SourceBand>1</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
> 				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
> 				<NODATA>0.0</NODATA>
> 				<OpenOptions /> </ComplexSource>
> 		</VRTRasterBand>
> 		<VRTRasterBand band="2" dataType="Byte">
> 			<NoDataValue>0.0</NoDataValue>
> 			<ColorInterp>Green</ColorInterp>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
> 				<SourceBand>2</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<ScaleRatio>0</ScaleRatio>
> 				<ScaleOffset>0.0</ScaleOffset>
> 			</ComplexSource>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="0" shared="0">/vsicurl/https://*.vrt</SourceFilename>
> 				<SourceBand>2</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
> 				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
> 				<NODATA>0.0</NODATA>
> 				<OpenOptions /> </ComplexSource>
> 		</VRTRasterBand>
> 		<VRTRasterBand band="3" dataType="Byte">
> 			<NoDataValue>0.0</NoDataValue>
> 			<ColorInterp>Blue</ColorInterp>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
> 				<SourceBand>3</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 				<ScaleRatio>0</ScaleRatio>
> 				<ScaleOffset>0.0</ScaleOffset>
> 			</ComplexSource>
> 			<ComplexSource>
> 				<SourceFilename relativeToVRT="0" shared="0">/vsicurl/https://*.vrt</SourceFilename>
> 				<SourceBand>3</SourceBand>
> 				<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 				<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
> 				<DstRect xOff="-6961.0" xSize="40960.0" yOff="-105176.0" ySize="139264.0" />
> 				<NODATA>0.0</NODATA>
> 				<OpenOptions /> </ComplexSource>
> 		</VRTRasterBand>
> 		<MaskBand>
> 			<VRTRasterBand dataType="Byte">
> 				<SimpleSource>
> 					<SourceFilename relativeToVRT="0" shared="0">/vsicurl/https://*.vrt</SourceFilename>
> 					<SourceBand>mask,1</SourceBand>
> 					<SourceProperties BlockXSize="128" BlockYSize="128" RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 					<SrcRect xOff="0" xSize="40960" yOff="0" ySize="139264" />
> 					<DstRect xOff="-6961.0" xSize="40960" yOff="-105176.0" ySize="139264" /> </SimpleSource>
> 			</VRTRasterBand>
> 		</MaskBand>
> 	</VRTDataset>
>
> If I read data from this file with gdal using resample_alg=gdalconst.GRIORA_NearestNeighbour then GDAL takes into account *.vrt.ovr file and sends very few HTTP requests to the server (~30):
>
> ds = gdal.OpenEx("/tmp/rasterio.vrt")
> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=5671, ysize=5648, buf_xsize=383, buf_ysize=385, resample_alg=gdalconst.GRIORA_NearestNeighbour
>
> If I do the same but using resample_alg=gdalconst.GRIORA_Cubic then GDAL
> sends a huge amount of requests to the server (~1k) because overviews are
> not used:
>
> ds = gdal.OpenEx("/tmp/rasterio.vrt")
> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=5671, ysize=5648, buf_xsize=383, buf_ysize=385, resample_alg=gdalconst.GRIORA_Cubic
>
> Is it expected or might there be something wrong with that VRT file?
> Thanks in advance for any help.
>
> On Wed, Aug 26, 2020 at 6:18 PM Denis Rykov <rykovd at gmail.com> wrote:
>
>> I have remote *.vrt raster and *.vrt.ovr accessible through HTTP. When I
>> run the following script with rasterio:
>>
>> with rasterio.open("http://*.vrt"") as src:
>>     image = src.read(indexes=[1, 2, 3], **{
>>         "window": Window(col_off=6961, row_off=105176, width=5671, height=5648),
>>         "resampling": Resampling.cubic,
>>         "boundless": True,
>>         "out_shape": (3, 383, 385),
>>         "masked": True
>>     })
>>
>> depending on "resampling" algorithm GDAL sends different amounts of
>> requests to the server. In the case of "cubic" it doesn't take into account
>> overviews and sends requests directly to *.tif files (900 in my case). In
>> case of "nearest" everything is ok (only 60 requests, *.vrt.ovr is taken
>> into account).
>>
>> Does GDAL check the resampling algorithm of overviews and in case it
>> differs from the option specified in read() method they are bypassed or it
>> works differently?
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/dac058ec/attachment-0001.html>

From even.rouault at spatialys.com  Thu Aug 27 07:08:29 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Aug 2020 16:08:29 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading
	with specified resampling method
In-Reply-To: <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
 <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
 <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>
Message-ID: <1904215.OrQFnTFj24@even-i700>

On jeudi 27 août 2020 15:08:02 CEST Denis Rykov wrote:
> I found the culprit. If remove this section from each band definition in
> VRT file then everything works fine:
> 
> <ComplexSource>
> 	<SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
> 	<SourceBand>3</SourceBand>
> 	<SourceProperties BlockXSize="128" BlockYSize="128"
> RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
> 	<SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 	<DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
> 	<ScaleRatio>0</ScaleRatio>
> 	<ScaleOffset>0.0</ScaleOffset></ComplexSource

I'm perhaps missing something, but the above snippet added by RasterIO doesn't make sense 
to me. It just sets the pixel at (0,0) to 0. I bet it is completely useless. It would make more 
sense to have xSize/ySize of DstRect to cover the whole raster. And as <NoDataValue> is set 
on the VRTRasterBand, this should be used to fill the target raster anyway.

As far as why overviews of the original VRT aren't used is concerned, I'm not sure why. I'd 
have expected it to work, but I must be missing something.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/3655a6f8/attachment.html>

From sean at mapbox.com  Thu Aug 27 09:38:39 2020
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 27 Aug 2020 10:38:39 -0600
Subject: [gdal-dev] Overviews are not taken into account while reading
 with specified resampling method
In-Reply-To: <1904215.OrQFnTFj24@even-i700>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
 <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
 <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>
 <1904215.OrQFnTFj24@even-i700>
Message-ID: <CADPhZXwSD+4Xp_E-ju+fnr0Dz-60B0T3_umbVKxWDR1t5cBJNQ@mail.gmail.com>

Hi Denis, Even,

On Thu, Aug 27, 2020 at 8:08 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 27 août 2020 15:08:02 CEST Denis Rykov wrote:
>
> > I found the culprit. If remove this section from each band definition in
>
> > VRT file then everything works fine:
>
> >
>
> > <ComplexSource>
>
> > <SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
>
> > <SourceBand>3</SourceBand>
>
> > <SourceProperties BlockXSize="128" BlockYSize="128"
>
> > RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
>
> > <SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
>
> > <DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
>
> > <ScaleRatio>0</ScaleRatio>
>
> > <ScaleOffset>0.0</ScaleOffset></ComplexSource
>
>
>
> I'm perhaps missing something, but the above snippet added by RasterIO
> doesn't make sense to me. It just sets the pixel at (0,0) to 0. I bet it is
> completely useless. It would make more sense to have xSize/ySize of DstRect
> to cover the whole raster. And as <NoDataValue> is set on the
> VRTRasterBand, this should be used to fill the target raster anyway.
>
>
>
> As far as why overviews of the original VRT aren't used is concerned, I'm
> not sure why. I'd have expected it to work, but I must be missing something.
>
>
>
> Even
>

That's a rasterio bug: the background "dummy.tif" source should be <DstRect
xOff="0" xSize="40961" yOff="0" ySize="139265" />. I'm working on a patch
for this.

This VRT background fill is different from nodata. The scale offset could
be different from the nodata value. BTW, It takes advantage of GDAL
shortcuts predicated on scale ratio. The "dummy.tif" file is never opened
and doesn't even exist.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/9ec4400b/attachment.html>

From rykovd at gmail.com  Thu Aug 27 10:30:14 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Thu, 27 Aug 2020 19:30:14 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading
 with specified resampling method
In-Reply-To: <CADPhZXwSD+4Xp_E-ju+fnr0Dz-60B0T3_umbVKxWDR1t5cBJNQ@mail.gmail.com>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
 <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
 <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>
 <1904215.OrQFnTFj24@even-i700>
 <CADPhZXwSD+4Xp_E-ju+fnr0Dz-60B0T3_umbVKxWDR1t5cBJNQ@mail.gmail.com>
Message-ID: <CAJbvKNpgimkTnWLiFPB4stC8XTcQC7JLCXoNrKts=0s=72HYxw@mail.gmail.com>

Hi Sean. I patched rasterio as you suggested and intermediate file now
looks like this (I'm trying now with a public dataset):
https://gist.github.com/drnextgis/3cbdbace7b5b8b80c3c6169b109bf9db

But when I read it with GDAL using non-nearest algorithm I'm getting
the following error:

>>> from osgeo import gdal>>> from osgeo.gdal import gdalconst>>> url = "/tmp/rasterio-boundless.vrt">>> ds = gdal.OpenEx(url)>>> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=64, ysize=64, buf_xsize=10, buf_ysize=10, resample_alg=gdalconst.GRIORA_Cubic)
ERROR 4: /tmp/dummy.tif: No such file or directory

but with NearestNeighbour it works without error:

>>> from osgeo import gdal>>> from osgeo.gdal import gdalconst>>> url = "/tmp/rasterio-boundless.vrt">>> ds = gdal.OpenEx(url)>>> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=64, ysize=64, buf_xsize=10, buf_ysize=10, resample_alg=gdalconst.GRIORA_NearestNeighbour)>>> image.shape(3, 10, 10)

I would be very appreciated if Even could explain why GDAL behaves
differently depending on resample_alg.

On Thu, Aug 27, 2020 at 6:39 PM Sean Gillies <sean at mapbox.com> wrote:

> Hi Denis, Even,
>
> On Thu, Aug 27, 2020 at 8:08 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On jeudi 27 août 2020 15:08:02 CEST Denis Rykov wrote:
>>
>> > I found the culprit. If remove this section from each band definition in
>>
>> > VRT file then everything works fine:
>>
>> >
>>
>> > <ComplexSource>
>>
>> > <SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
>>
>> > <SourceBand>3</SourceBand>
>>
>> > <SourceProperties BlockXSize="128" BlockYSize="128"
>>
>> > RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
>>
>> > <SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
>>
>> > <DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
>>
>> > <ScaleRatio>0</ScaleRatio>
>>
>> > <ScaleOffset>0.0</ScaleOffset></ComplexSource
>>
>>
>>
>> I'm perhaps missing something, but the above snippet added by RasterIO
>> doesn't make sense to me. It just sets the pixel at (0,0) to 0. I bet it is
>> completely useless. It would make more sense to have xSize/ySize of DstRect
>> to cover the whole raster. And as <NoDataValue> is set on the
>> VRTRasterBand, this should be used to fill the target raster anyway.
>>
>>
>>
>> As far as why overviews of the original VRT aren't used is concerned, I'm
>> not sure why. I'd have expected it to work, but I must be missing something.
>>
>>
>>
>> Even
>>
>
> That's a rasterio bug: the background "dummy.tif" source should
> be <DstRect xOff="0" xSize="40961" yOff="0" ySize="139265" />. I'm working
> on a patch for this.
>
> This VRT background fill is different from nodata. The scale offset could
> be different from the nodata value. BTW, It takes advantage of GDAL
> shortcuts predicated on scale ratio. The "dummy.tif" file is never opened
> and doesn't even exist.
>
> --
> Sean Gillies
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/d1a52d3e/attachment-0001.html>

From rykovd at gmail.com  Thu Aug 27 10:48:22 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Thu, 27 Aug 2020 19:48:22 +0200
Subject: [gdal-dev] Overviews are not taken into account while reading
 with specified resampling method
In-Reply-To: <CAJbvKNpgimkTnWLiFPB4stC8XTcQC7JLCXoNrKts=0s=72HYxw@mail.gmail.com>
References: <CAJbvKNrzV5qXfOzBF7eMDrFyhpXyZ4zJ3hjqOSh0QeVF+n2oGA@mail.gmail.com>
 <CAJbvKNp56sTD8+-9qHrpwOyHj0diV7khcmsoX+L4JipO3G6+4Q@mail.gmail.com>
 <CAJbvKNq3ACgvN7vcENCt3aHV6s8mPRCih9f6_ASWR+v5erBX2Q@mail.gmail.com>
 <1904215.OrQFnTFj24@even-i700>
 <CADPhZXwSD+4Xp_E-ju+fnr0Dz-60B0T3_umbVKxWDR1t5cBJNQ@mail.gmail.com>
 <CAJbvKNpgimkTnWLiFPB4stC8XTcQC7JLCXoNrKts=0s=72HYxw@mail.gmail.com>
Message-ID: <CAJbvKNrSXY8AKWX1oThoc3jVR+YD5cin5+2SZiy+YjX_Q0ZMgw@mail.gmail.com>

In GDAL 3.1 (previous example was done in GDAL 2.2.3) I can read data from
that VRT using "gdalconst.GRIORA_Cubic" but still overviews are not used:

>>> from osgeo import gdal
>>> from osgeo.gdal import gdalconst
>>> gdal.__version__
'3.1.0'
>>> url = "/vsicurl/https://gist.githubusercontent.com/drnextgis/3cbdbace7b5b8b80c3c6169b109bf9db/raw/7b61af41c698930a7f2da851a0684a15ddeb99a9/rasterio-boundless.vrt"
>>> ds = gdal.OpenEx(url)
>>> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=64, ysize=64, buf_xsize=10, buf_ysize=10, resample_alg=gdalconst.GRIORA_Cubic)
>>> image.shape
(3, 10, 10)


On Thu, Aug 27, 2020 at 7:30 PM Denis Rykov <rykovd at gmail.com> wrote:

> Hi Sean. I patched rasterio as you suggested and intermediate file now
> looks like this (I'm trying now with a public dataset):
> https://gist.github.com/drnextgis/3cbdbace7b5b8b80c3c6169b109bf9db
>
> But when I read it with GDAL using non-nearest algorithm I'm getting
> the following error:
>
> >>> from osgeo import gdal>>> from osgeo.gdal import gdalconst>>> url = "/tmp/rasterio-boundless.vrt">>> ds = gdal.OpenEx(url)>>> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=64, ysize=64, buf_xsize=10, buf_ysize=10, resample_alg=gdalconst.GRIORA_Cubic)
> ERROR 4: /tmp/dummy.tif: No such file or directory
>
> but with NearestNeighbour it works without error:
>
> >>> from osgeo import gdal>>> from osgeo.gdal import gdalconst>>> url = "/tmp/rasterio-boundless.vrt">>> ds = gdal.OpenEx(url)>>> image = ds.ReadAsArray(xoff=0, yoff=0, xsize=64, ysize=64, buf_xsize=10, buf_ysize=10, resample_alg=gdalconst.GRIORA_NearestNeighbour)>>> image.shape(3, 10, 10)
>
> I would be very appreciated if Even could explain why GDAL behaves
> differently depending on resample_alg.
>
> On Thu, Aug 27, 2020 at 6:39 PM Sean Gillies <sean at mapbox.com> wrote:
>
>> Hi Denis, Even,
>>
>> On Thu, Aug 27, 2020 at 8:08 AM Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> On jeudi 27 août 2020 15:08:02 CEST Denis Rykov wrote:
>>>
>>> > I found the culprit. If remove this section from each band definition
>>> in
>>>
>>> > VRT file then everything works fine:
>>>
>>> >
>>>
>>> > <ComplexSource>
>>>
>>> > <SourceFilename relativeToVRT="1" shared="0">dummy.tif</SourceFilename>
>>>
>>> > <SourceBand>3</SourceBand>
>>>
>>> > <SourceProperties BlockXSize="128" BlockYSize="128"
>>>
>>> > RasterXSize="40961" RasterYSize="139265" dataType="Byte" />
>>>
>>> > <SrcRect xOff="0" xSize="1" yOff="0" ySize="1" />
>>>
>>> > <DstRect xOff="0" xSize="1" yOff="0" ySize="1" />
>>>
>>> > <ScaleRatio>0</ScaleRatio>
>>>
>>> > <ScaleOffset>0.0</ScaleOffset></ComplexSource
>>>
>>>
>>>
>>> I'm perhaps missing something, but the above snippet added by RasterIO
>>> doesn't make sense to me. It just sets the pixel at (0,0) to 0. I bet it is
>>> completely useless. It would make more sense to have xSize/ySize of DstRect
>>> to cover the whole raster. And as <NoDataValue> is set on the
>>> VRTRasterBand, this should be used to fill the target raster anyway.
>>>
>>>
>>>
>>> As far as why overviews of the original VRT aren't used is concerned,
>>> I'm not sure why. I'd have expected it to work, but I must be missing
>>> something.
>>>
>>>
>>>
>>> Even
>>>
>>
>> That's a rasterio bug: the background "dummy.tif" source should
>> be <DstRect xOff="0" xSize="40961" yOff="0" ySize="139265" />. I'm working
>> on a patch for this.
>>
>> This VRT background fill is different from nodata. The scale offset could
>> be different from the nodata value. BTW, It takes advantage of GDAL
>> shortcuts predicated on scale ratio. The "dummy.tif" file is never opened
>> and doesn't even exist.
>>
>> --
>> Sean Gillies
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/93e91c61/attachment.html>

From phigginsca at yahoo.com  Thu Aug 27 12:57:55 2020
From: phigginsca at yahoo.com (Paul Higgins)
Date: Thu, 27 Aug 2020 19:57:55 +0000 (UTC)
Subject: [gdal-dev] Creating a KAP/BSB
References: <902743869.53054.1598558275673.ref@mail.yahoo.com>
Message-ID: <902743869.53054.1598558275673@mail.yahoo.com>

I have a process to create a KAP/BSB file as follows:- 1. Create a GIF- 2. >From the GIF Create a TIF- 3. From the TIF create a KAP- 4. Read the KAP into a Navigation program.
For the 2nd process I use a image processing routine called CXIMAGE which works well except if the GIF is very large then it fails trying to load it. So I decided to use "gdal_Translate input.gif ouput.tif". This seems to work except the resulting KAP is unreadable by the navigation program.  So there must be a difference in the TIF created by the CXIMAGE and gdal_translate.
Here is gdalinfo of the input GIF:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo _temp_SP_KAP_1598583387_.gifDriver: GTiff/GeoTIFFFiles: _temp_SP_KAP_1598583387_.gifSize is 2303, 2047Coordinate System is:LOCAL_CS["WGS 84 / Pseudo-Mercator",    UNIT["metre",1,        AUTHORITY["EPSG","9001"]]]GeoTransform =  1.262783522530797e+93, 3.8435366748478e-57, 8.467125104458958e+175  3.983892464727202e+252, 3.247326554715089e+35, 5.751476576395799e-153Metadata:  AREA_OR_POINT=AreaImage Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Left  (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Upper Right (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Right (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Center      (86661025444137435656987197915140107184203584661437290195769853134199773018014227072717855440328238110159594633364260498828087365985480139511225231151877437650550057809653138456576.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 100,96,52,255    1: 136,152,136,255    2: 60,120,96,255    3: 80,60,56,255

I did a gdalinfo of the tif created by the CXIMAGE program:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo "USING CXIMAGE_SP_KAP_1598534936_.tif"Driver: GTiff/GeoTIFFFiles: USING CXIMAGE_SP_KAP_1598534936_.tifSize is 2303, 2047Coordinate System is `'Metadata:  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)  TIFFTAG_XRESOLUTION=96  TIFFTAG_YRESOLUTION=96Image Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (    0.0,    0.0)Lower Left  (    0.0, 2047.0)Upper Right ( 2303.0,    0.0)Lower Right ( 2303.0, 2047.0)Center      ( 1151.5, 1023.5)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 8,0,8,255    1: 8,8,12,255
and a gdalinfo of the TIF created by gdal_translate:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo "USING GDAL_SP_KAP_1598538217_.tif"Driver: GTiff/GeoTIFFFiles: USING GDAL_SP_KAP_1598538217_.tifSize is 2303, 2047Coordinate System is:LOCAL_CS["WGS 84 / Pseudo-Mercator",    UNIT["metre",1,        AUTHORITY["EPSG","9001"]]]GeoTransform =  1.262783522530797e+93, 3.8435366748478e-57, 8.467125104458958e+175  3.983892464727202e+252, 3.247326554715089e+35, 5.751476576395799e-153Metadata:  AREA_OR_POINT=AreaImage Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Left  (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Upper Right (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Right (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Center      (86661025444137435656987197915140107184203584661437290195769853134199773018014227072717855440328238110159594633364260498828087365985480139511225231151877437650550057809653138456576.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 100,96,52,255    1: 136,152,136,255    2: 60,120,96,255    3: 80,60,56,255    4: 212,180,204,255
 have tried the following options to gdal_translate with no success:-- options = '-co PROFILE=BASELINE'-- options = '-b 1 -b 2 -b 3'-- options = '-co PHOTOMETRIC=CMYK'    -- options = '-co PHOTOMETRIC=MINISBLACK'   -- options = '-co PHOTOMETRIC=YCBCR'   CIELAB -- options = '-co PHOTOMETRIC=CIELAB'
Any help would be appreciate,






-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200827/78edfe7a/attachment.html>

From phigginsca at yahoo.com  Thu Aug 27 19:07:19 2020
From: phigginsca at yahoo.com (Paul Higgins)
Date: Fri, 28 Aug 2020 02:07:19 +0000 (UTC)
Subject: [gdal-dev] Creating a KAP/BSB
In-Reply-To: <902743869.53054.1598558275673@mail.yahoo.com>
References: <902743869.53054.1598558275673.ref@mail.yahoo.com>
 <902743869.53054.1598558275673@mail.yahoo.com>
Message-ID: <1364316914.185509.1598580439087@mail.yahoo.com>

 Please cancel this.  I found the problem. Nothing to do with GDAL.
Thanks
    On Friday, August 28, 2020, 03:57:55 a.m. GMT+8, Paul Higgins <phigginsca at yahoo.com> wrote:  
 
 I have a process to create a KAP/BSB file as follows:- 1. Create a GIF- 2. From the GIF Create a TIF- 3. From the TIF create a KAP- 4. Read the KAP into a Navigation program.
For the 2nd process I use a image processing routine called CXIMAGE which works well except if the GIF is very large then it fails trying to load it. So I decided to use "gdal_Translate input.gif ouput.tif". This seems to work except the resulting KAP is unreadable by the navigation program.  So there must be a difference in the TIF created by the CXIMAGE and gdal_translate.
Here is gdalinfo of the input GIF:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo _temp_SP_KAP_1598583387_.gifDriver: GTiff/GeoTIFFFiles: _temp_SP_KAP_1598583387_.gifSize is 2303, 2047Coordinate System is:LOCAL_CS["WGS 84 / Pseudo-Mercator",    UNIT["metre",1,        AUTHORITY["EPSG","9001"]]]GeoTransform =  1.262783522530797e+93, 3.8435366748478e-57, 8.467125104458958e+175  3.983892464727202e+252, 3.247326554715089e+35, 5.751476576395799e-153Metadata:  AREA_OR_POINT=AreaImage Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Left  (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Upper Right (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Right (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Center      (86661025444137435656987197915140107184203584661437290195769853134199773018014227072717855440328238110159594633364260498828087365985480139511225231151877437650550057809653138456576.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 100,96,52,255    1: 136,152,136,255    2: 60,120,96,255    3: 80,60,56,255

I did a gdalinfo of the tif created by the CXIMAGE program:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo "USING CXIMAGE_SP_KAP_1598534936_.tif"Driver: GTiff/GeoTIFFFiles: USING CXIMAGE_SP_KAP_1598534936_.tifSize is 2303, 2047Coordinate System is `'Metadata:  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)  TIFFTAG_XRESOLUTION=96  TIFFTAG_YRESOLUTION=96Image Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (    0.0,    0.0)Lower Left  (    0.0, 2047.0)Upper Right ( 2303.0,    0.0)Lower Right ( 2303.0, 2047.0)Center      ( 1151.5, 1023.5)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 8,0,8,255    1: 8,8,12,255
and a gdalinfo of the TIF created by gdal_translate:C:\SAT2CHART\SAT2CHART.Testing\temp>gdalinfo "USING GDAL_SP_KAP_1598538217_.tif"Driver: GTiff/GeoTIFFFiles: USING GDAL_SP_KAP_1598538217_.tifSize is 2303, 2047Coordinate System is:LOCAL_CS["WGS 84 / Pseudo-Mercator",    UNIT["metre",1,        AUTHORITY["EPSG","9001"]]]GeoTransform =  1.262783522530797e+93, 3.8435366748478e-57, 8.467125104458958e+175  3.983892464727202e+252, 3.247326554715089e+35, 5.751476576395799e-153Metadata:  AREA_OR_POINT=AreaImage Structure Metadata:  INTERLEAVE=BANDCorner Coordinates:Upper Left  (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Left  (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Upper Right (1262783522530796746737479706828132315251220510125960098188045561858895670625330307346101960704.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Lower Right (173322050888274871313974395830280214368407169322874580391539706268399546036028454145435710880656476220319189266728520997656174731970960279022450462303754875301100115619306276913152.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Center      (86661025444137435656987197915140107184203584661437290195769853134199773018014227072717855440328238110159594633364260498828087365985480139511225231151877437650550057809653138456576.000,3983892464727202554888960554269713030196205758904239846941521902545445025437834361819163746941457672362766848308926612078115418501685410889087779378869932632608114241119219770776413111973463633846695245205724734052201855595075165452848877534656742817792.000)Band 1 Block=2303x3 Type=Byte, ColorInterp=Palette  Color Table (RGB with 256 entries)    0: 100,96,52,255    1: 136,152,136,255    2: 60,120,96,255    3: 80,60,56,255    4: 212,180,204,255
 have tried the following options to gdal_translate with no success:-- options = '-co PROFILE=BASELINE'-- options = '-b 1 -b 2 -b 3'-- options = '-co PHOTOMETRIC=CMYK'    -- options = '-co PHOTOMETRIC=MINISBLACK'   -- options = '-co PHOTOMETRIC=YCBCR'   CIELAB -- options = '-co PHOTOMETRIC=CIELAB'
Any help would be appreciate,






  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200828/2a6a6481/attachment-0001.html>

From usha.n at nokia.com  Fri Aug 28 05:15:30 2020
From: usha.n at nokia.com (N, Usha (Nokia - IN/Bangalore))
Date: Fri, 28 Aug 2020 12:15:30 +0000
Subject: [gdal-dev] Support info about GDAL 1.11.2
In-Reply-To: <DB7PR07MB524464A1E070ADC2009C01AC98550@DB7PR07MB5244.eurprd07.prod.outlook.com>
References: <DB7PR07MB524464A1E070ADC2009C01AC98550@DB7PR07MB5244.eurprd07.prod.outlook.com>
Message-ID: <DB7PR07MB52442BEC1CFAEE8180F2E73F98520@DB7PR07MB5244.eurprd07.prod.outlook.com>

Hi,

We are using  Red Hat Enterprise Linux Server release 7.4 (Maipo).

As part of EPEL repo, we are getting gdal-1.11.2-1.x86_64.rpm and gdal-1.11.4-3.el7.x86_64.rpm . Out of these, we are using gdal-1.11.2

We would like to know if GDAL 1.11.2 has reached EOL..

If yes, please let us know which is the stable latest release which you would recommend us to use.

Thanks & Regards,
Usha N.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200828/98bdad8c/attachment.html>

From andrew at aitchison.me.uk  Fri Aug 28 07:34:02 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 28 Aug 2020 15:34:02 +0100 (BST)
Subject: [gdal-dev] Support info about GDAL 1.11.2
In-Reply-To: <DB7PR07MB52442BEC1CFAEE8180F2E73F98520@DB7PR07MB5244.eurprd07.prod.outlook.com>
References: <DB7PR07MB524464A1E070ADC2009C01AC98550@DB7PR07MB5244.eurprd07.prod.outlook.com>
 <DB7PR07MB52442BEC1CFAEE8180F2E73F98520@DB7PR07MB5244.eurprd07.prod.outlook.com>
Message-ID: <alpine.DEB.2.23.453.2008281501490.1241996@warden.aitchison.me.uk>

On Fri, 28 Aug 2020, N, Usha (Nokia - IN/Bangalore) wrote:

> Hi,
>
> We are using  Red Hat Enterprise Linux Server release 7.4 (Maipo).
>
> As part of EPEL repo, we are getting gdal-1.11.2-1.x86_64.rpm and
> gdal-1.11.4-3.el7.x86_64.rpm . Out of these, we are using
> gdal-1.11.2
>
> We would like to know if GDAL 1.11.2 has reached EOL..

GDAL-1.11.5 was the last 1. version
I think any fixes for gdal v1 would only go in 1.11.5,
but I believe that is EOL.

> If yes, please let us know which is the stable latest release which you
> would recommend us to use.

Tricky.

RHEL7 is older than most linux distributors would support (released Nov 2017)
but has several years of life remaining; full support until 31 May 2021
and free maintenance support until June 2024
(paid support for maybe another 4 years after that).

GDAL v2 is still supported, but distributions like Ubuntu 20.04
(which has long term support) currently have GDAL v3.
GDAL v3 uses a newer version of the proj library than v2 did.
Many users will notice this change.

Latest GDAL versions are v2.4.4 and v3.1.2; there isn't really a "stable"
release - if you want bleeding edge you go to the master source, otherwise
use the latest release of v2 or v3 - barring important bug fixes which 
merit a 0.0.1 release, a n.m release is current for a year.

If you had asked about RHEL 8 I would have recommended GDAL v3;
for RHEL7 I struggle to choose between v2 and v3.


-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From tom.drorschwartz at weizmann.ac.il  Sun Aug 30 07:02:36 2020
From: tom.drorschwartz at weizmann.ac.il (Tom Dror-Schwartz)
Date: Sun, 30 Aug 2020 14:02:36 +0000
Subject: [gdal-dev] gdal.open won't read short format
Message-ID: <AM0P191MB0802C1249F53D087E9002E98B1500@AM0P191MB0802.EURP191.PROD.OUTLOOK.COM>

Hello,
I'm trying to remap a layer from a NETCDF file (Cloud top height) from its native geostationary projection to a simple lat-lon projection, using gdal through python. I was successful so far, until the data format was changed from "Byte" to "short". Now the gdal.open command combined with .ReadAsArray returns the data only filled with the fill value.

I can't seem to convert the NETCFD file from short to byte, and would appreciate any help on how to tackle this issue.
** I tried to use gdal_translate in the command line, but I guess I didn't get the right syntax.

Thanks,
Tom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200830/3131848e/attachment.html>

From even.rouault at spatialys.com  Sun Aug 30 08:40:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 30 Aug 2020 17:40:07 +0200
Subject: [gdal-dev] gdal.open won't read short format
In-Reply-To: <AM0P191MB0802C1249F53D087E9002E98B1500@AM0P191MB0802.EURP191.PROD.OUTLOOK.COM>
References: <AM0P191MB0802C1249F53D087E9002E98B1500@AM0P191MB0802.EURP191.PROD.OUTLOOK.COM>
Message-ID: <799417925.XWWXVETn8H@even-i700>

Tom,

> I'm trying to remap a layer from a NETCDF file (Cloud top height) from its
> native geostationary projection to a simple lat-lon projection, using gdal
> through python. I was successful so far, until the data format was changed
> from "Byte" to "short". Now the gdal.open command combined with
> .ReadAsArray returns the data only filled with the fill value.
> 
> I can't seem to convert the NETCFD file from short to byte, and would
> appreciate any help on how to tackle this issue. ** I tried to use
> gdal_translate in the command line, but I guess I didn't get the right
> syntax.

Please provide a link to such a dataset, the version number of the GDAL you use and from 
which binary distribution it comes from.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200830/ac4d51f1/attachment.html>

From zhanli1986 at gmail.com  Sun Aug 30 15:11:54 2020
From: zhanli1986 at gmail.com (Zhan Li)
Date: Mon, 31 Aug 2020 00:11:54 +0200
Subject: [gdal-dev] gdal_translate into netCDF file will lose some important
 metadata items such as scale_factor and add_offset
In-Reply-To: <CAAMT6JOJAiuqe7vQS7RCyN9u3O-PYgxuirWH6oGHt1fLvqkW6g@mail.gmail.com>
References: <CAAMT6JOJAiuqe7vQS7RCyN9u3O-PYgxuirWH6oGHt1fLvqkW6g@mail.gmail.com>
Message-ID: <CAAMT6JPaUb3azJa1s628pTXN0gC5ZggEf=1CAzUdqCQ5YXNO5w@mail.gmail.com>

Hi, when I use gdal_translate to convert a raster file (e.g., either GTiff
or VRT) into netCDF format, it always loses some important metadata items
such as scale_factor, add_offset and etc. What am I doing it wrong? Can
anyone help me to solve this problem?

Here I'm using an example NetCDF file from NOAA
<ftp://ftp.cdc.noaa.gov/Datasets/cmap/std/precip.mon.mean.nc> called "
precip.mon.mean.nc " to demo the problem.
First convert one band of the netCDF file into a GTiff file.
$ gdal_translate -of GTiff -b 1 precip.mon.mean.nc precip.mon.mean.b1.tif
$ gdalinfo precip.mon.mean.b1.tif
It returns the following 16 metadata items for the band in the following,

Band 1 Block=144x14 Type=Float32, ColorInterp=Gray
  NoData Value=-9.96920996838686905e+36
  Unit Type: mm/day
  Metadata:
    actual_range={0,59.080002}
    add_offset=0
    dataset=CPC Merged Analysis of Precipitation Standard
    least_significant_digit=2
    level_desc=Surface
    long_name=Average Monthly Rate of Precipitation
    missing_value=-9.96921e+36
    NETCDF_DIM_time=1569072
    NETCDF_VARNAME=precip
    parent_stat=Mean
    precision=2
    scale_factor=1
    statistic=Mean
    units=mm/day
    valid_range={0,70}
    var_desc=Precipitation

Now convert the GTiff back into a netCDF file
$ gdal_translate -of netCDF precip.mon.mean.b1.tif precip.mon.mean.b1.nc
$ gdalinfo precip.mon.mean.b1.nc
Now it returns only 12 metadata items which miss some particular important
ones such as scale_factor, add_offset, and etc.

Band 1 Block=144x1 Type=Float32, ColorInterp=Undefined
  NoData Value=-9.96920996838686905e+36
  Unit Type: mm/day
  Metadata:
    actual_range={0,59.080002}
    dataset=CPC Merged Analysis of Precipitation Standard
    least_significant_digit=2
    level_desc=Surface
    long_name=Average Monthly Rate of Precipitation
    NETCDF_VARNAME=precip
    parent_stat=Mean
    precision=2
    statistic=Mean
    units=mm/day
    var_desc=Precipitation
    _FillValue=-9.96921e+36

Thanks,

Zhan.

-- 
Zhan Li <https://zhanlilz.github.io/>, 李展;
Google Scholar
<https://scholar.google.com/citations?user=JGNL9BoAAAAJ&hl=en>,
ORCID <https://orcid.org/0000-0001-6307-5200>, Github
<https://github.com/zhanlilz>,
Twitter <https://twitter.com/zhanlilz>, LinkedIn
<https://www.linkedin.com/in/zhanli/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/3efe75e9/attachment.html>

From skyking at ilikecarrots.com  Sun Aug 30 19:59:06 2020
From: skyking at ilikecarrots.com (skyking)
Date: Sun, 30 Aug 2020 22:59:06 -0400
Subject: [gdal-dev] featureCollection within a featureCollection
Message-ID: <b29474ad7ef5f87b2a69bfef916600c1@ilikecarrots.com>

Hello,

I'm having trouble parsing some GML via Python/ogr and would like some 
advice.

The GML has as the top level a FeatureCollection which has 3 
featureMembers.  However, each of those featureMembers contains a 
FeatureCollection within it containing any number of featureMembers.

While parsing, each of the featureMembers has a dict of elements, and 
the values of that featureMembers' keys is a list of the values of each 
of the "sub-featureMember"s attributes.  That's good so far, but I'm not 
able to retrieve the geometry for the sub-featureMembers.

How do I use Python ogr to parse a FeatureCollection within a 
FeatureCollection?  Does a ResetReading() somehow reset something so 
that the inner members get processed correctly?

Thank you,
Wendell

A sample of the nested xml components:

<?xml version="1.0" encoding="utf-8"?>
<wx:FeatureCollection gml:id="id0" ...>

  <wx:featureMember>
   <wx:Forecast gml:id="id1">

    <om:result>
     <wx:FeatureCollection gml:id="id5">

      <wx:featureMember>
       <wx:Contour gml:id="id6">
        <wx:geometry>
            ...
        </wx:geometry>
       </wx:Contour>
      </wx:featureMember>

      <wx:featureMember>
       <wx:Contour gml:id="id10">
        <wx:geometry>
            ...
        </wx:geometry>
       </wx:Contour>
      </wx:featureMember>

     </wx:FeatureCollection>
    </om:result>
   </wx:Forecast>
  </wx:featureMember>

  <wx:featureMember>
   <wx:Forecast gml:id="id1438">
    <om:result>
     <wx:FeatureCollection gml:id="id1442">
      <wx:featureMember>
          ...

From nyall.dawson at gmail.com  Sun Aug 30 20:09:24 2020
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Mon, 31 Aug 2020 13:09:24 +1000
Subject: [gdal-dev] UTF-8 and layer names
Message-ID: <CAB28AsgYh-grkK3ea1Sb2GqfNqCmbr2WtogQxT8epNtv2xC5bg@mail.gmail.com>

Hi list,

While looking into https://github.com/OSGeo/gdal/issues/2894 , I hit a
bit of confusion about the expected encoding of OGR dataset layer
names.

I've been looking over the related RFCS:
- https://gdal.org/development/rfc/rfc5_unicode.html
- https://gdal.org/development/rfc/rfc23_ogr_unicode.html
- https://gdal.org/development/rfc/rfc30_utf8_filenames.html

and I can't see any mention of how layer names should be encoded, and
whether or not UTF-8 layer names are supported in current GDAL
releases.

Is anyone able to supply some clarification on this, and how extended
characters could be/should be handled in GDAL drivers?

Nyall

From even.rouault at spatialys.com  Mon Aug 31 01:57:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Aug 2020 10:57:26 +0200
Subject: [gdal-dev] UTF-8 and layer names
In-Reply-To: <CAB28AsgYh-grkK3ea1Sb2GqfNqCmbr2WtogQxT8epNtv2xC5bg@mail.gmail.com>
References: <CAB28AsgYh-grkK3ea1Sb2GqfNqCmbr2WtogQxT8epNtv2xC5bg@mail.gmail.com>
Message-ID: <5873567.fy1Ubtgi63@even-i700>

Nyall,

The philosophy is that, as much as possible, all strings in GDAL should be UTF-8 encoded, and 
drivers do the work of recoding from/into it if necessary. Now, this is more a philosophy that 
something that can be strictly enforced because:
- not all drivers that could do that are implementing it (or they are partly implementing it)
- and some drivers/formats have no explicit text encoding.

Even

> 
> While looking into https://github.com/OSGeo/gdal/issues/2894 , I hit a
> bit of confusion about the expected encoding of OGR dataset layer
> names.
> 
> I've been looking over the related RFCS:
> - https://gdal.org/development/rfc/rfc5_unicode.html
> - https://gdal.org/development/rfc/rfc23_ogr_unicode.html
> - https://gdal.org/development/rfc/rfc30_utf8_filenames.html
> 
> and I can't see any mention of how layer names should be encoded, and
> whether or not UTF-8 layer names are supported in current GDAL
> releases.
> 
> Is anyone able to supply some clarification on this, and how extended
> characters could be/should be handled in GDAL drivers?
> 
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/d0006d76/attachment.html>

From even.rouault at spatialys.com  Mon Aug 31 02:00:42 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Aug 2020 11:00:42 +0200
Subject: [gdal-dev] featureCollection within a featureCollection
In-Reply-To: <b29474ad7ef5f87b2a69bfef916600c1@ilikecarrots.com>
References: <b29474ad7ef5f87b2a69bfef916600c1@ilikecarrots.com>
Message-ID: <8801891.9kGzJ35q0O@even-i700>

Wendell,

> I'm having trouble parsing some GML via Python/ogr and would like some
> advice.
> 
> The GML has as the top level a FeatureCollection which has 3
> featureMembers.  However, each of those featureMembers contains a
> FeatureCollection within it containing any number of featureMembers.
> 
> While parsing, each of the featureMembers has a dict of elements, and
> the values of that featureMembers' keys is a list of the values of each
> of the "sub-featureMember"s attributes.  That's good so far, but I'm not
> able to retrieve the geometry for the sub-featureMembers.
> 
> How do I use Python ogr to parse a FeatureCollection within a
> FeatureCollection?  Does a ResetReading() somehow reset something so
> that the inner members get processed correctly?

This is a so called "complex features" model. The GML driver cannot handle that natively. If 
this GML file has its associated XML schemas, I'd suggest you use the GMLAS driver instead:
https://gdal.org/drivers/vector/gmlas.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/63bb56cf/attachment-0001.html>

From even.rouault at spatialys.com  Mon Aug 31 02:06:32 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Aug 2020 11:06:32 +0200
Subject: [gdal-dev] gdal_translate into netCDF file will lose some
	important metadata items such as scale_factor and add_offset
In-Reply-To: <CAAMT6JPaUb3azJa1s628pTXN0gC5ZggEf=1CAzUdqCQ5YXNO5w@mail.gmail.com>
References: <CAAMT6JOJAiuqe7vQS7RCyN9u3O-PYgxuirWH6oGHt1fLvqkW6g@mail.gmail.com>
 <CAAMT6JPaUb3azJa1s628pTXN0gC5ZggEf=1CAzUdqCQ5YXNO5w@mail.gmail.com>
Message-ID: <5530248.VXYv0EBkLk@even-i700>

On lundi 31 août 2020 00:11:54 CEST Zhan Li wrote:
> Hi, when I use gdal_translate to convert a raster file (e.g., either GTiff
> or VRT) into netCDF format, it always loses some important metadata items
> such as scale_factor, add_offset and etc. What am I doing it wrong? Can
> anyone help me to solve this problem?

As scale_factor=1 and add_offset=0 in that dataset, they have no effect, and are 
thus not stored when converted to GeoTIFF.

valid_range is explicitly discarded from source metadata when converting into 
netCDF. I'm not completely sure of the rationale for that.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/ed22c8dc/attachment.html>

From even.rouault at spatialys.com  Mon Aug 31 11:32:13 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Aug 2020 20:32:13 +0200
Subject: [gdal-dev] gdal_translate into netCDF file will lose some
	important metadata items such as scale_factor and add_offset
In-Reply-To: <CAAMT6JPtghYmmDKc1xqALtBjEXk3SiDb5=KxG+ZpCcPB7MtZkg@mail.gmail.com>
References: <CAAMT6JOJAiuqe7vQS7RCyN9u3O-PYgxuirWH6oGHt1fLvqkW6g@mail.gmail.com>
 <5530248.VXYv0EBkLk@even-i700>
 <CAAMT6JPtghYmmDKc1xqALtBjEXk3SiDb5=KxG+ZpCcPB7MtZkg@mail.gmail.com>
Message-ID: <7186871.DMNQoomu6m@even-i700>

Zhan,

adding back the list

There was an issue in the writing code of the netCDF driver. It was supposed supposed to 
copy the offset and scale settings from the source dataset, but there was a logic error. Fixed 
per 
https://github.com/OSGeo/gdal/pull/2906

Even


> Hi Even,
> 
> Thanks a lot for your reply! Yes here in this example, scale_factor and
> add_offset do not matter. I put them here just for demo purposes. In my
> actual data (quite large), I'd like to use 1e-3 as scale factor but could
> not write scale_factor into the metadata of netCDF via gdal_translate. Even
> if I use VRT as an intermediate file and manually add scale_factor into the
> VRT per band through "<MDI key="scale_factor">1e-3</MDI>". It still does
> not work :(
> 
> But it sounds like the implementation of the netCDF driver in GDAL has some
> explicit tweak of metadata items? Like you said, valid_range is explicitly
> discarded. Maybe scale_factor and add_offset and such are also part of
> metadata items that the driver explicitly discards? In that case, I'll
> stick to scale_factor=1 and add_offset=0. Not ideal though. Otherwise, this
> loss of metadata items for netCDF files should count as a bug to be
> reported?
> 
> Zhan.
> 
> On Mon, Aug 31, 2020 at 11:06 AM Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > On lundi 31 août 2020 00:11:54 CEST Zhan Li wrote:
> > > Hi, when I use gdal_translate to convert a raster file (e.g., either
> > 
> > GTiff
> > 
> > > or VRT) into netCDF format, it always loses some important metadata
> > > items
> > > 
> > > such as scale_factor, add_offset and etc. What am I doing it wrong? Can
> > > 
> > > anyone help me to solve this problem?
> > 
> > As scale_factor=1 and add_offset=0 in that dataset, they have no effect,
> > and are thus not stored when converted to GeoTIFF.
> > 
> > 
> > 
> > valid_range is explicitly discarded from source metadata when converting
> > into netCDF. I'm not completely sure of the rationale for that.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/a56ac955/attachment.html>

From runette at gmail.com  Mon Aug 31 13:10:31 2020
From: runette at gmail.com (Paul Harwood)
Date: Mon, 31 Aug 2020 21:10:31 +0100
Subject: [gdal-dev] Using GdalOgrInCSharp on Mac/Linux
Message-ID: <CAE8nN5OQdqJ7W5ojWdcwFR-vrb7oC0y-WkBxrdPs_Oo2vfBcOA@mail.gmail.com>

Has anyone ever tried (and/or succeeded) to use GdalOgrInCSharp under MONO
on Mac and/or Linux?

The Wiki posts from Tamas
<https://trac.osgeo.org/gdal/wiki/GdalOgrInCsharp>suggest
that this is possible - but the direction from there is to look at BuildBot
- so that does not really help.

Google searches on the subject are eerily quite!

So - I thought I would see of there are any points (other than "here be
dragons") before I start .. ?

Thanks

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200831/d58fcc75/attachment.html>

