From even.rouault at spatialys.com  Thu Jul  1 02:01:09 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 1 Jul 2021 11:01:09 +0200
Subject: [gdal-dev] GDAL 3.0 on Debian 10
In-Reply-To: <a4bb9fc5-8933-916d-0ccf-27564011e919@lat-lon.de>
References: <a4bb9fc5-8933-916d-0ccf-27564011e919@lat-lon.de>
Message-ID: <67454616-e584-aade-4060-236f37cfec3f@spatialys.com>

Hi,

if you don't want to build from source, you could e.g.

- use a Docker image

- use a build from Conda

Even

Le 30/06/2021 ? 20:42, Dirk Stenger a ?crit?:
> Hi all,
>
> Currently, I am trying to install GDAL 3.0 on Debian 10.
>
> Unfortunately, the package manager just provides GDAL 2 and the hints 
> on https://gdal.org/download.html#debian do not tackle my case.
>
> What is the easiest way to install GDAL 3.0 on Debian 10? Are there 
> binaries available that I can use? Is there a manual describing how to 
> install GDAL 3.0 on Debian 10?
>
> Can anyone help me with those questions?
>
> Kind regards,
>
> Dirk
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Thu Jul  1 02:06:10 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 1 Jul 2021 11:06:10 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.1 RC1
Message-ID: <bc3ca9a4-b5ae-7ce7-15e4-2d1fbda3f455@spatialys.com>

Hi,

Having heard no issues being reported regarding RC1

Motion:

Adopt GDAL 3.3.1 RC1 as final 3.3.1 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From howard at hobu.co  Thu Jul  1 10:55:59 2021
From: howard at hobu.co (Howard Butler)
Date: Thu, 1 Jul 2021 12:55:59 -0500
Subject: [gdal-dev] Motion: promote GDAL 3.3.1 RC1
In-Reply-To: <bc3ca9a4-b5ae-7ce7-15e4-2d1fbda3f455@spatialys.com>
References: <bc3ca9a4-b5ae-7ce7-15e4-2d1fbda3f455@spatialys.com>
Message-ID: <37A18767-4B75-4736-A780-E19C81415C12@hobu.co>

+1 Howard

> On Jul 1, 2021, at 4:06 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> Having heard no issues being reported regarding RC1
> 
> Motion:
> 
> Adopt GDAL 3.3.1 RC1 as final 3.3.1 release
> 
> Starting with my +1
> 
> Even
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu Jul  1 12:05:19 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 1 Jul 2021 21:05:19 +0200
Subject: [gdal-dev] zarr driver PR
In-Reply-To: <CAOodmJo_sJs0o5OPi=N2MfwtDkRzjAtUvwW+BZa7HnH9xSUWZA@mail.gmail.com>
References: <CAOodmJo_sJs0o5OPi=N2MfwtDkRzjAtUvwW+BZa7HnH9xSUWZA@mail.gmail.com>
Message-ID: <2bf7d918-9d83-c3f2-cfdd-07da12721217@spatialys.com>

Hi all,

for those who have monitored the PR tracker lately, you may have noticed 
that I've been working in https://github.com/OSGeo/gdal/pull/3896 for an 
implementation of a Zarr driver. This is now feature complete and in a 
CI ready state. It follows a different approach than the one proposed in 
PR #3411 for the reasons I underlined in 
https://github.com/OSGeo/gdal/pull/3411#issuecomment-831259626

I've also filled the RFC template in 
https://github.com/OSGeo/gdal/pull/3896#issuecomment-872398856

Even


Le 01/02/2021 ? 16:45, Sean Gillies a ?crit?:
> Hi all,
>
> Also deep in our recent long thread about removing drivers from GDAL 
> is mention of a new PR for a "zarr" driver.
>
> https://github.com/OSGeo/gdal/pull/3411 
> <https://github.com/OSGeo/gdal/pull/3411>
>
> I'd like to see more discussion of the scope of this work and plans 
> for future development and support before a zarr driver is added to GDAL.
>
> Is the zarr driver not going to support version 2 of the zarr spec? I 
> that v2 would be difficult to implement as a GDAL driver as it is 
> extremely flexible and extensible. For example, I've written custom 
> compressor and storage for use in a project at work and can't imagine 
> how a driver written in C++ would understand it.
>
> Is the zarr driver based on 
> https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html 
> <https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html>? 
> That work seems not yet finished. Is it premature to add a driver to 
> GDAL for a format that isn't yet specified and may yet be changed? Or 
> should we expect only minor changes at this point?
>
> -- 
> Sean Gillies
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210701/2ca14601/attachment.html>

From pekka at gispo.fi  Thu Jul  1 23:52:26 2021
From: pekka at gispo.fi (Pekka Sarkola)
Date: Fri, 2 Jul 2021 09:52:26 +0300
Subject: [gdal-dev] Setting roles in PostGIS connection
Message-ID: <CANgLEnCK=doUUifaTGAha4AdCRBWG+jJUigymp0LLn1cBfYK8g@mail.gmail.com>

Hi!

We have a PostGIS database with login roles and group roles (like "admins",
"editors" and "viewers"). We have defined that only "admins" can create new
schemas and tables (among other privileges). My problem is that I'd like to
use ogr2ogr to bulk load some data to a PostGIS database using ogr2ogr
with a certain login role with "admins" role.

It seems that it is not possible to define roles in PostgreSQL connection
parameters (my first try) or in PostgreSQL driver options.

I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET ROLE
admins", but got warning "Warning 1: -doo ignored when creating the output
datasource."

Any solutions or suggestions?

There is also similar case in QGIS: Supporting "set role" when connecting
to a postgres database - https://github.com/qgis/QGIS/issues/42763

Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS 3.1

Rgs,

Pekka

Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
www.gispo.fi ? www.paikkatieto.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/aa00b188/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jul  2 04:40:22 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 2 Jul 2021 11:40:22 +0000
Subject: [gdal-dev] Setting roles in PostGIS connection
Message-ID: <734306a66bca46a389fa3847b973d653@maanmittauslaitos.fi>

Hi,

I wonder if writing the output into pgdump https://gdal.org/drivers/vector/pgdump.html and editing the SQL a bit could be used as a workaround. 

-Jukka Rahkonen-

Pekka Sarkola wrote:

> Hi!

> We have a PostGIS database with login roles and group roles (like "admins",
> "editors" and "viewers"). We have defined that only "admins" can create new
> schemas and tables (among other privileges). My problem is that I'd like to
> use ogr2ogr to bulk load some data to a PostGIS database using ogr2ogr
> with a certain login role with "admins" role.

> It seems that it is not possible to define roles in PostgreSQL connection
> parameters (my first try) or in PostgreSQL driver options.

> I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET ROLE
> admins", but got warning "Warning 1: -doo ignored when creating the output
> datasource."

> Any solutions or suggestions?

> There is also similar case in QGIS: Supporting "set role" when connecting
> to a postgres database - https://github.com/qgis/QGIS/issues/42763

> Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS 3.1

> Rgs,

> Pekka

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jul  2 05:51:28 2021
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 2 Jul 2021 12:51:28 +0000
Subject: [gdal-dev] Setting roles in PostGIS connection
Message-ID: <61d73264f1b3483d8c2aec57c27d5969@maanmittauslaitos.fi>

Hi again,

GDAL is using the standand libpg-connect https://www.postgresql.org/docs/12/libpq-connect.html and that does not have support for defining roles during connect.

Do I understand right that your user "Joe" does not have direct CREATEDB privileges but gets them through the admins role? And because CREATEDB has a special handling https://www.postgresql.org/docs/current/role-membership.html there is no other way to let Joe to create db that through SET ROLE ADMINS.

Making GDAL to support 
"-doo "PRELUDE_STATEMENTS=SET ROLE admins"
feels like a good idea but I have no idea about how difficult it would be to implement.

-Jukka Rahkonen-



-----Alkuper?inen viesti-----
L?hett?j?: Rahkonen Jukka (MML) 
L?hetetty: perjantai 2. hein?kuuta 2021 14.40
Vastaanottaja: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Aihe: Re: Setting roles in PostGIS connection

Hi,

I wonder if writing the output into pgdump https://gdal.org/drivers/vector/pgdump.html and editing the SQL a bit could be used as a workaround. 

-Jukka Rahkonen-

Pekka Sarkola wrote:

> Hi!

> We have a PostGIS database with login roles and group roles (like 
> "admins", "editors" and "viewers"). We have defined that only "admins" 
> can create new schemas and tables (among other privileges). My problem 
> is that I'd like to use ogr2ogr to bulk load some data to a PostGIS 
> database using ogr2ogr with a certain login role with "admins" role.

> It seems that it is not possible to define roles in PostgreSQL 
> connection parameters (my first try) or in PostgreSQL driver options.

> I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET 
> ROLE admins", but got warning "Warning 1: -doo ignored when creating 
> the output datasource."

> Any solutions or suggestions?

> There is also similar case in QGIS: Supporting "set role" when 
> connecting to a postgres database - 
> https://github.com/qgis/QGIS/issues/42763

> Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS 
> 3.1

> Rgs,

> Pekka

From even.rouault at spatialys.com  Fri Jul  2 07:25:49 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 2 Jul 2021 16:25:49 +0200
Subject: [gdal-dev] Setting roles in PostGIS connection
In-Reply-To: <CANgLEnCK=doUUifaTGAha4AdCRBWG+jJUigymp0LLn1cBfYK8g@mail.gmail.com>
References: <CANgLEnCK=doUUifaTGAha4AdCRBWG+jJUigymp0LLn1cBfYK8g@mail.gmail.com>
Message-ID: <0f7fb992-3294-f8b9-b3ac-a91e5884cf33@spatialys.com>

Pekka,

I suspect you use "ogr2ogr -f PostgreSQL PG:....."

If you use rather "ogr2ogr -update PG:...." you should be able to use 
-doo (not sure the SET ROLE will work properly in that context though)

Even

Le 02/07/2021 ? 08:52, Pekka Sarkola a ?crit?:
> Hi!
>
> We have a PostGIS database with login roles and group roles (like 
> "admins", "editors" and "viewers"). We have defined that only "admins" 
> can create new schemas and tables (among other privileges). My problem 
> is that I'd like to use ogr2ogr to bulk load some data to a PostGIS 
> database using ogr2ogr with?a certain login role with "admins" role.
>
> It seems that it is not possible to define roles in PostgreSQL 
> connection parameters (my first try) or in PostgreSQL driver options.
> I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET 
> ROLE admins", but got warning "Warning 1: -doo ignored when creating 
> the output datasource."
>
> Any solutions or suggestions?
>
> There is also similar case in QGIS: Supporting "set role" when 
> connecting to a postgres database - 
> https://github.com/qgis/QGIS/issues/42763 
> <https://github.com/qgis/QGIS/issues/42763>
>
> Versions:?GDAL 3.0.4, released 2020/01/28,?PostgreSQL 12.7, PostGIS 3.1
>
> Rgs,
>
> Pekka
>
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi <mailto:pekka.sarkola at gispo.fi>- GSM +358 
> 40?725 2042
> www.gispo.fi <http://www.gispo.fi/>? www.paikkatieto.com 
> <http://www.paikkatieto.com/>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/afd6ec35/attachment.html>

From David.Hill at oregonstate.edu  Fri Jul  2 11:06:36 2021
From: David.Hill at oregonstate.edu (Hill, David Foster)
Date: Fri, 2 Jul 2021 18:06:36 +0000
Subject: [gdal-dev] gdal_translate - unable to process srs definition....
Message-ID: <F622F875-F18D-434A-B7A5-6E31EC2256C5@oregonstate.edu>

Hi.

gdal_translate was working great for me for the past two weeks. I would do commands like:

?>fin="/nfs/depot/cce_u1/hill/dfh/op_snowmodel/wy_snowmodel/ctl_files/wo_assim/$STAMP.nc"
?>fout="/nfs/depot/cce_u1/hill/dfh/op_snowmodel/wy_snowmodel/ctl_files/wo_assim/$STAMP.tif"
?>gdal_translate -of GTiff -a_srs EPSG:32612 $fin $fout

from a bash script.

Now, it is not working. I get errors like:

?>Failed to process SRS definition: ESPG:32612

I don?t understand what happened. The version is: GDAL 1.11.4, released 2016/01/25

When I did printenv, I did not find that GDAL_DATA was set. So, I set it with this:

?>export GDAL_DATA=/usr/share/gdal

And, I now see that when I re-do printenv. But, I keep getting the same error? I have spent a lot of time looking for help online and can?t find anything other than making sure gdal_data is correctly set, which it now is.

Regards,


---------------------------------------------------
David F. Hill
Professor
Civil and Construction Engineering
Oregon State University
220 Owen Hall
Corvallis, OR 97331
541.737.4939
david.hill at oregonstate.edu
http://www.engr.oregonstate.edu/~dfh
---------------------------------------------------



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/36f5d480/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 1563 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/36f5d480/attachment-0001.bin>

From traviskirstine at gmail.com  Fri Jul  2 11:14:37 2021
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Fri, 2 Jul 2021 14:14:37 -0400
Subject: [gdal-dev] gdal_translate - unable to process srs definition....
In-Reply-To: <F622F875-F18D-434A-B7A5-6E31EC2256C5@oregonstate.edu>
References: <F622F875-F18D-434A-B7A5-6E31EC2256C5@oregonstate.edu>
Message-ID: <CALtm4h0Ua+mKuqQNYhCSyOorn7vps8N=byVAFUTWppj4s6FX1Q@mail.gmail.com>

Not sure but your error " Failed to process SRS definition: ESPG:32612 "
looks like a typo - should it be EPSG:32612

Regards

On Fri, 2 Jul 2021 at 14:06, Hill, David Foster <David.Hill at oregonstate.edu>
wrote:

> Hi.
>
> gdal_translate was working great for me for the past two weeks. I would do
> commands like:
>
>
> ?>fin="/nfs/depot/cce_u1/hill/dfh/op_snowmodel/wy_snowmodel/ctl_files/wo_assim/$STAMP.nc"
>
> ?>fout="/nfs/depot/cce_u1/hill/dfh/op_snowmodel/wy_snowmodel/ctl_files/wo_assim/$STAMP.tif"
> ?>gdal_translate -of GTiff -a_srs EPSG:32612 $fin $fout
>
> from a bash script.
>
> Now, it is not working. I get errors like:
>
> ?>Failed to process SRS definition: ESPG:32612
>
> I don?t understand what happened. The version is: GDAL 1.11.4, released
> 2016/01/25
>
> When I did printenv, I did not find that GDAL_DATA was set. So, I set it
> with this:
>
> ?>export GDAL_DATA=/usr/share/gdal
>
> And, I now see that when I re-do printenv. But, I keep getting the same
> error? I have spent a lot of time looking for help online and can?t find
> anything other than making sure gdal_data is correctly set, which it now is.
>
> Regards,
>
>
> ---------------------------------------------------
> David F. Hill
> Professor
> Civil and Construction Engineering
> Oregon State University
> 220 Owen Hall
> Corvallis, OR 97331
> 541.737.4939
> david.hill at oregonstate.edu
> http://www.engr.oregonstate.edu/~dfh
> ---------------------------------------------------
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/bb412739/attachment.html>

From me at jhkennedy.org  Fri Jul  2 14:58:11 2021
From: me at jhkennedy.org (Joseph H. Kennedy)
Date: Fri, 2 Jul 2021 13:58:11 -0800
Subject: [gdal-dev] gdal_utils on conda-forge
Message-ID: <CABYChRHO24jkCSWFnASuMytRVtx9YN5i=SFrt477K=rs=4yctw@mail.gmail.com>

Hi All,

Are there any current plans/efforts underway to provide gdal_utils on
conda-forge?

If so, fantastic! Any way I can help?

If not, I'd be happy to set up the conda-forge recipe and maintain it.
Would that be acceptable and is there anyone else I should add (or wants to
be added) as a maintainer? If/when I set up the recipe, I'll also reach out
to the @conda-forge/gdal team on github and see if any of them want to be
listed as well.

Thanks,

Joe

Joseph H Kennedy
Research Software Engineer
Alaska Satellite Facility
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210702/aee4df28/attachment.html>

From pekka at gispo.fi  Sun Jul  4 21:53:13 2021
From: pekka at gispo.fi (Pekka Sarkola)
Date: Mon, 5 Jul 2021 07:53:13 +0300
Subject: [gdal-dev] Setting roles in PostGIS connection
In-Reply-To: <61d73264f1b3483d8c2aec57c27d5969@maanmittauslaitos.fi>
References: <61d73264f1b3483d8c2aec57c27d5969@maanmittauslaitos.fi>
Message-ID: <CANgLEnA2D26LXK6qXCSJmYGX9tpuMgF_5XLQCJB==A=RQBCnPQ@mail.gmail.com>

Hi!

PGDump: that might be the solution, I need to check. Thank you!

Yes, libpg-connection doesn't have role parameters. Maybe it should? I
don't know how, but you can define role settings in pgAdmin connections

Rgs,

Pekka

Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
www.gispo.fi ? www.paikkatieto.com


pe 2. hein?k. 2021 klo 15.51 Rahkonen Jukka (MML) (
jukka.rahkonen at maanmittauslaitos.fi) kirjoitti:

> Hi again,
>
> GDAL is using the standand libpg-connect
> https://www.postgresql.org/docs/12/libpq-connect.html and that does not
> have support for defining roles during connect.
>
> Do I understand right that your user "Joe" does not have direct CREATEDB
> privileges but gets them through the admins role? And because CREATEDB has
> a special handling
> https://www.postgresql.org/docs/current/role-membership.html there is no
> other way to let Joe to create db that through SET ROLE ADMINS.
>
> Making GDAL to support
> "-doo "PRELUDE_STATEMENTS=SET ROLE admins"
> feels like a good idea but I have no idea about how difficult it would be
> to implement.
>
> -Jukka Rahkonen-
>
>
>
> -----Alkuper?inen viesti-----
> L?hett?j?: Rahkonen Jukka (MML)
> L?hetetty: perjantai 2. hein?kuuta 2021 14.40
> Vastaanottaja: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
> Aihe: Re: Setting roles in PostGIS connection
>
> Hi,
>
> I wonder if writing the output into pgdump
> https://gdal.org/drivers/vector/pgdump.html and editing the SQL a bit
> could be used as a workaround.
>
> -Jukka Rahkonen-
>
> Pekka Sarkola wrote:
>
> > Hi!
>
> > We have a PostGIS database with login roles and group roles (like
> > "admins", "editors" and "viewers"). We have defined that only "admins"
> > can create new schemas and tables (among other privileges). My problem
> > is that I'd like to use ogr2ogr to bulk load some data to a PostGIS
> > database using ogr2ogr with a certain login role with "admins" role.
>
> > It seems that it is not possible to define roles in PostgreSQL
> > connection parameters (my first try) or in PostgreSQL driver options.
>
> > I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET
> > ROLE admins", but got warning "Warning 1: -doo ignored when creating
> > the output datasource."
>
> > Any solutions or suggestions?
>
> > There is also similar case in QGIS: Supporting "set role" when
> > connecting to a postgres database -
> > https://github.com/qgis/QGIS/issues/42763
>
> > Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS
> > 3.1
>
> > Rgs,
>
> > Pekka
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210705/d358f012/attachment.html>

From pekka at gispo.fi  Sun Jul  4 21:55:24 2021
From: pekka at gispo.fi (Pekka Sarkola)
Date: Mon, 5 Jul 2021 07:55:24 +0300
Subject: [gdal-dev] Setting roles in PostGIS connection
In-Reply-To: <0f7fb992-3294-f8b9-b3ac-a91e5884cf33@spatialys.com>
References: <CANgLEnCK=doUUifaTGAha4AdCRBWG+jJUigymp0LLn1cBfYK8g@mail.gmail.com>
 <0f7fb992-3294-f8b9-b3ac-a91e5884cf33@spatialys.com>
Message-ID: <CANgLEnDyr4_U17O--hXj39VPCcOdTqTgSB3jLLv5bwRbA7Ww2w@mail.gmail.com>

Hi Even,

That's correct: I use ogr2ogr. At least I tested with "-overwrite", but I
will check how this works with "-update"

Rgs,

Pekka

Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
www.gispo.fi ? www.paikkatieto.com


pe 2. hein?k. 2021 klo 17.26 Even Rouault (even.rouault at spatialys.com)
kirjoitti:

> Pekka,
>
> I suspect you use "ogr2ogr -f PostgreSQL PG:....."
>
> If you use rather "ogr2ogr -update PG:...." you should be able to use -doo
> (not sure the SET ROLE will work properly in that context though)
>
> Even
> Le 02/07/2021 ? 08:52, Pekka Sarkola a ?crit :
>
> Hi!
>
> We have a PostGIS database with login roles and group roles (like
> "admins", "editors" and "viewers"). We have defined that only "admins" can
> create new schemas and tables (among other privileges). My problem is that
> I'd like to use ogr2ogr to bulk load some data to a PostGIS database using
> ogr2ogr with a certain login role with "admins" role.
>
> It seems that it is not possible to define roles in PostgreSQL connection
> parameters (my first try) or in PostgreSQL driver options.
>
> I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET ROLE
> admins", but got warning "Warning 1: -doo ignored when creating the output
> datasource."
>
> Any solutions or suggestions?
>
> There is also similar case in QGIS: Supporting "set role" when connecting
> to a postgres database - https://github.com/qgis/QGIS/issues/42763
>
> Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS 3.1
>
> Rgs,
>
> Pekka
>
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> www.gispo.fi ? www.paikkatieto.com
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210705/398cfb19/attachment.html>

From simone.dalmasso at gmail.com  Mon Jul  5 00:36:21 2021
From: simone.dalmasso at gmail.com (Simone Dalmasso)
Date: Mon, 5 Jul 2021 09:36:21 +0200
Subject: [gdal-dev] Fwd: gdaladdo fails on some images
In-Reply-To: <CAAHAC+es2N6jxHqtRLgFTzH4pU0z3=ZWNn9MBydfd-3yeTN4Qw@mail.gmail.com>
References: <CAAHAC+es2N6jxHqtRLgFTzH4pU0z3=ZWNn9MBydfd-3yeTN4Qw@mail.gmail.com>
Message-ID: <CAAHAC+cM9WrMG7DcSLBCzyy7s9Ye4DHEukNYRTMxg+8PeoRSAw@mail.gmail.com>

Dear list,
I'm running gdaladdo on some imagery, SPOT and Sentinel2.

But only on one S2 works fine, on the others stops with only "Overview
building failed".
My command is simply "gdaladdo -r nearest path".
I noticed that it will work if I specify to just up to 16 the OVR levels,
but as soon as I put 32 it fails. (as said on one S2 works fine)

GDAL version is 3.2.1, OS Focal64, the output with CPL_DEBUG ON is:

GTiff.
GTiff: ScanDirectories()
GTiff: Opened 6492x4548 overview.
GTiff: Opened 3246x2274 overview.
GTiff: Opened 1623x1137 overview.
GTiff: Opened 812x569 overview.
GTiff: Opened 406x285 overview.
GTiff: Opened 203x143 overview.
0GDAL: GDAL_CACHEMAX = 291 MB
...10...20...30...40...50...60...70...80...90...100 - done.
Overview building failed.
GDAL: Flushing dirty blocks:
0...10...20...30...40...50...60...70...80...90...100 - done.

etc etc

Thanks a lot for your support.

-- 
Simone
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210705/d738b759/attachment.html>

From even.rouault at spatialys.com  Mon Jul  5 04:47:29 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 Jul 2021 13:47:29 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.3.1 RC1
In-Reply-To: <bc3ca9a4-b5ae-7ce7-15e4-2d1fbda3f455@spatialys.com>
References: <bc3ca9a4-b5ae-7ce7-15e4-2d1fbda3f455@spatialys.com>
Message-ID: <9424aed9-594a-8ddf-126f-e809c3c1ebaa@spatialys.com>

I declare this motion passed with +1 from myself and HowardB.

Even

Le 01/07/2021 ? 11:06, Even Rouault a ?crit?:
> Hi,
>
> Having heard no issues being reported regarding RC1
>
> Motion:
>
> Adopt GDAL 3.3.1 RC1 as final 3.3.1 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Jul  5 05:18:37 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 Jul 2021 14:18:37 +0200
Subject: [gdal-dev] GDAL 3.3.1 is released
Message-ID: <60343324-2199-4fb0-73c9-a97d48e0eba8@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the
release of the GDAL/OGR 3.3.1 bug fix version.

Consult the release notes for the list of issues addressed :

 ? https://github.com/OSGeo/gdal/blob/v3.3.1/gdal/NEWS

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.3.1/gdal-3.3.1.tar.xz
 ??? https://download.osgeo.org/gdal/3.3.1/gdal-3.3.1.tar.gz
 ??? https://download.osgeo.org/gdal/3.3.1/gdal331.zip
 ??? https://download.osgeo.org/gdal/3.3.1/gdal-grass-3.3.1.tar.gz

Corresponding Docker images are being generated but they will take some 
time to build as I'm experimenting having amd64 and arm64 support.

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Jul  5 07:04:21 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 Jul 2021 16:04:21 +0200
Subject: [gdal-dev] libgeotiff 1.7.0 is released
Message-ID: <83cd25d6-48ec-a6be-e00f-8df6642a4fae@spatialys.com>

Hi,

Source packages can be found at:

http://download.osgeo.org/geotiff/libgeotiff/libgeotiff-1.7.0.tar.gz

http://download.osgeo.org/geotiff/libgeotiff/libgeotiff-1.7.0.zip

News is:

libgeotiff 1.7.0
----------------

* Add CoordinateEpochGeoKey = 5120 of type DOUBLE to store coordinate 
epoch of
 ? tie points / geotransform matrix for dynamic CRS.
 ? See https://github.com/opengeospatial/geotiff/pull/99
* geo_normalize.h/c: rename variables to please codespell
* GTIFGetGCSInfoEx(): use proj_crs_get_datum_forced() for PROJ >= 8 to 
avoid
 ? issues with datum ensembles (fixes #54)
* GTIFGetGCSInfoEx(): remove dead code (GDAL Coverity CID 1432690)
* geo_normalize.c: follow-up to e06625c4e5bcce9f9217d1d5a43dc6af73156283 
to avoid
 ? look up of user-defined GeogGeodeticDatumGeoKey that cause PROJ 
warnings (fixes #41)

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Jul  5 23:39:34 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 6 Jul 2021 08:39:34 +0200
Subject: [gdal-dev] Fwd: gdaladdo fails on some images
In-Reply-To: <CAAHAC+cM9WrMG7DcSLBCzyy7s9Ye4DHEukNYRTMxg+8PeoRSAw@mail.gmail.com>
References: <CAAHAC+es2N6jxHqtRLgFTzH4pU0z3=ZWNn9MBydfd-3yeTN4Qw@mail.gmail.com>
 <CAAHAC+cM9WrMG7DcSLBCzyy7s9Ye4DHEukNYRTMxg+8PeoRSAw@mail.gmail.com>
Message-ID: <5dfa11f0-aa1f-d015-dfa7-4353e82ef653@spatialys.com>

Simone,

we'd need to access one of dataset that fails.

Even

Le 05/07/2021 ? 09:36, Simone Dalmasso a ?crit?:
> Dear list,
> I'm running gdaladdo on some imagery, SPOT and Sentinel2.
>
> But only on one S2 works fine, on the others stops with only "Overview 
> building failed".
> My command is simply?"gdaladdo -r nearest path".
> I noticed that it will work if I specify to just up to 16 the OVR 
> levels, but as soon as I put 32 it fails. (as said on one S2 works fine)
>
> GDAL version is 3.2.1, OS Focal64, the output with?CPL_DEBUG ON is:
>
> GTiff.
> GTiff: ScanDirectories()
> GTiff: Opened 6492x4548 overview.
> GTiff: Opened 3246x2274 overview.
> GTiff: Opened 1623x1137 overview.
> GTiff: Opened 812x569 overview.
> GTiff: Opened 406x285 overview.
> GTiff: Opened 203x143 overview.
> 0GDAL: GDAL_CACHEMAX = 291 MB
> ...10...20...30...40...50...60...70...80...90...100 - done.
> Overview building failed.
> GDAL: Flushing dirty blocks: 
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> etc etc
>
> Thanks a lot for your support.
>
> -- 
> Simone
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210706/393e235d/attachment.html>

From pekka at gispo.fi  Mon Jul  5 23:42:16 2021
From: pekka at gispo.fi (Pekka Sarkola)
Date: Tue, 6 Jul 2021 09:42:16 +0300
Subject: [gdal-dev] Setting roles in PostGIS connection
In-Reply-To: <CANgLEnA2D26LXK6qXCSJmYGX9tpuMgF_5XLQCJB==A=RQBCnPQ@mail.gmail.com>
References: <61d73264f1b3483d8c2aec57c27d5969@maanmittauslaitos.fi>
 <CANgLEnA2D26LXK6qXCSJmYGX9tpuMgF_5XLQCJB==A=RQBCnPQ@mail.gmail.com>
Message-ID: <CANgLEnAp9-zU1bNHGivS_CPiny+X=FeFgyuqixqy=y6Rp_sCDA@mail.gmail.com>

Hi!

Just for records: PGDump is valid solution for this:
- First I created SQL file with ogr2ogr and "-f PGDump"-option
- Second, I uploaded result SQL file with psql: psql -t -q -c "SET ROLE
admins;" -f ./result.sql

So this is work-around to manage group roles.

Rgs,

Pekka

Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
www.gispo.fi ? www.paikkatieto.com


ma 5. hein?k. 2021 klo 7.53 Pekka Sarkola (pekka at gispo.fi) kirjoitti:

> Hi!
>
> PGDump: that might be the solution, I need to check. Thank you!
>
> Yes, libpg-connection doesn't have role parameters. Maybe it should? I
> don't know how, but you can define role settings in pgAdmin connections
>
> Rgs,
>
> Pekka
>
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> www.gispo.fi ? www.paikkatieto.com
>
>
> pe 2. hein?k. 2021 klo 15.51 Rahkonen Jukka (MML) (
> jukka.rahkonen at maanmittauslaitos.fi) kirjoitti:
>
>> Hi again,
>>
>> GDAL is using the standand libpg-connect
>> https://www.postgresql.org/docs/12/libpq-connect.html and that does not
>> have support for defining roles during connect.
>>
>> Do I understand right that your user "Joe" does not have direct CREATEDB
>> privileges but gets them through the admins role? And because CREATEDB has
>> a special handling
>> https://www.postgresql.org/docs/current/role-membership.html there is no
>> other way to let Joe to create db that through SET ROLE ADMINS.
>>
>> Making GDAL to support
>> "-doo "PRELUDE_STATEMENTS=SET ROLE admins"
>> feels like a good idea but I have no idea about how difficult it would be
>> to implement.
>>
>> -Jukka Rahkonen-
>>
>>
>>
>> -----Alkuper?inen viesti-----
>> L?hett?j?: Rahkonen Jukka (MML)
>> L?hetetty: perjantai 2. hein?kuuta 2021 14.40
>> Vastaanottaja: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
>> Aihe: Re: Setting roles in PostGIS connection
>>
>> Hi,
>>
>> I wonder if writing the output into pgdump
>> https://gdal.org/drivers/vector/pgdump.html and editing the SQL a bit
>> could be used as a workaround.
>>
>> -Jukka Rahkonen-
>>
>> Pekka Sarkola wrote:
>>
>> > Hi!
>>
>> > We have a PostGIS database with login roles and group roles (like
>> > "admins", "editors" and "viewers"). We have defined that only "admins"
>> > can create new schemas and tables (among other privileges). My problem
>> > is that I'd like to use ogr2ogr to bulk load some data to a PostGIS
>> > database using ogr2ogr with a certain login role with "admins" role.
>>
>> > It seems that it is not possible to define roles in PostgreSQL
>> > connection parameters (my first try) or in PostgreSQL driver options.
>>
>> > I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET
>> > ROLE admins", but got warning "Warning 1: -doo ignored when creating
>> > the output datasource."
>>
>> > Any solutions or suggestions?
>>
>> > There is also similar case in QGIS: Supporting "set role" when
>> > connecting to a postgres database -
>> > https://github.com/qgis/QGIS/issues/42763
>>
>> > Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS
>> > 3.1
>>
>> > Rgs,
>>
>> > Pekka
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210706/a5a9df93/attachment.html>

From pekka at gispo.fi  Mon Jul  5 23:46:42 2021
From: pekka at gispo.fi (Pekka Sarkola)
Date: Tue, 6 Jul 2021 09:46:42 +0300
Subject: [gdal-dev] Setting roles in PostGIS connection
In-Reply-To: <CANgLEnDyr4_U17O--hXj39VPCcOdTqTgSB3jLLv5bwRbA7Ww2w@mail.gmail.com>
References: <CANgLEnCK=doUUifaTGAha4AdCRBWG+jJUigymp0LLn1cBfYK8g@mail.gmail.com>
 <0f7fb992-3294-f8b9-b3ac-a91e5884cf33@spatialys.com>
 <CANgLEnDyr4_U17O--hXj39VPCcOdTqTgSB3jLLv5bwRbA7Ww2w@mail.gmail.com>
Message-ID: <CANgLEnA2gXmp4j6C=dBaY72z7OyQ5DoHxsAH1R5zX=Kg55PQKQ@mail.gmail.com>

Hi,

For records: "-doo "PRELUDE_STATEMENTS=SET ROLE admins" works with ogr2ogr
-append function. In my case, I need to update/overwrite several tables, so
I add small psql-query to remove existing tables from schema:

psql -t -c "SELECT
  'DROP TABLE IF EXISTS \"' || schemaname || '\". \"' || tablename || '\"
CASCADE;'
FROM
  pg_tables WHERE schemaname = 'my_schema';" | psql


Thanks for the advices,

Pekka

Pekka Sarkola
Gispo Oy
pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
www.gispo.fi ? www.paikkatieto.com


ma 5. hein?k. 2021 klo 7.55 Pekka Sarkola (pekka at gispo.fi) kirjoitti:

> Hi Even,
>
> That's correct: I use ogr2ogr. At least I tested with "-overwrite", but I
> will check how this works with "-update"
>
> Rgs,
>
> Pekka
>
> Pekka Sarkola
> Gispo Oy
> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
> www.gispo.fi ? www.paikkatieto.com
>
>
> pe 2. hein?k. 2021 klo 17.26 Even Rouault (even.rouault at spatialys.com)
> kirjoitti:
>
>> Pekka,
>>
>> I suspect you use "ogr2ogr -f PostgreSQL PG:....."
>>
>> If you use rather "ogr2ogr -update PG:...." you should be able to use
>> -doo (not sure the SET ROLE will work properly in that context though)
>>
>> Even
>> Le 02/07/2021 ? 08:52, Pekka Sarkola a ?crit :
>>
>> Hi!
>>
>> We have a PostGIS database with login roles and group roles (like
>> "admins", "editors" and "viewers"). We have defined that only "admins" can
>> create new schemas and tables (among other privileges). My problem is that
>> I'd like to use ogr2ogr to bulk load some data to a PostGIS database using
>> ogr2ogr with a certain login role with "admins" role.
>>
>> It seems that it is not possible to define roles in PostgreSQL connection
>> parameters (my first try) or in PostgreSQL driver options.
>>
>> I tried to use PREDUDE_STATEMENTS like: "-doo "PRELUDE_STATEMENTS=SET
>> ROLE admins", but got warning "Warning 1: -doo ignored when creating the
>> output datasource."
>>
>> Any solutions or suggestions?
>>
>> There is also similar case in QGIS: Supporting "set role" when connecting
>> to a postgres database - https://github.com/qgis/QGIS/issues/42763
>>
>> Versions: GDAL 3.0.4, released 2020/01/28, PostgreSQL 12.7, PostGIS 3.1
>>
>> Rgs,
>>
>> Pekka
>>
>> Pekka Sarkola
>> Gispo Oy
>> pekka.sarkola at gispo.fi   - GSM +358 40 725 2042
>> www.gispo.fi ? www.paikkatieto.com
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210706/e45c2107/attachment-0001.html>

From simone.dalmasso at gmail.com  Wed Jul  7 08:01:34 2021
From: simone.dalmasso at gmail.com (Simone Dalmasso)
Date: Wed, 7 Jul 2021 17:01:34 +0200
Subject: [gdal-dev] Fwd: gdaladdo fails on some images
In-Reply-To: <5dfa11f0-aa1f-d015-dfa7-4353e82ef653@spatialys.com>
References: <CAAHAC+es2N6jxHqtRLgFTzH4pU0z3=ZWNn9MBydfd-3yeTN4Qw@mail.gmail.com>
 <CAAHAC+cM9WrMG7DcSLBCzyy7s9Ye4DHEukNYRTMxg+8PeoRSAw@mail.gmail.com>
 <5dfa11f0-aa1f-d015-dfa7-4353e82ef653@spatialys.com>
Message-ID: <CAAHAC+egBHPV=jc-67X2PJPFgmpDWqSGFhszF5S-CjtUt2ev7Q@mail.gmail.com>

Dear Even,

thanks for the answer although I solved it by introducing rio-cogeo and
works fine.

Best!

Il giorno mar 6 lug 2021 alle ore 08:39 Even Rouault <
even.rouault at spatialys.com> ha scritto:

> Simone,
>
> we'd need to access one of dataset that fails.
>
> Even
> Le 05/07/2021 ? 09:36, Simone Dalmasso a ?crit :
>
> Dear list,
> I'm running gdaladdo on some imagery, SPOT and Sentinel2.
>
> But only on one S2 works fine, on the others stops with only "Overview
> building failed".
> My command is simply "gdaladdo -r nearest path".
> I noticed that it will work if I specify to just up to 16 the OVR levels,
> but as soon as I put 32 it fails. (as said on one S2 works fine)
>
> GDAL version is 3.2.1, OS Focal64, the output with CPL_DEBUG ON is:
>
> GTiff.
> GTiff: ScanDirectories()
> GTiff: Opened 6492x4548 overview.
> GTiff: Opened 3246x2274 overview.
> GTiff: Opened 1623x1137 overview.
> GTiff: Opened 812x569 overview.
> GTiff: Opened 406x285 overview.
> GTiff: Opened 203x143 overview.
> 0GDAL: GDAL_CACHEMAX = 291 MB
> ...10...20...30...40...50...60...70...80...90...100 - done.
> Overview building failed.
> GDAL: Flushing dirty blocks:
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> etc etc
>
> Thanks a lot for your support.
>
> --
> Simone
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
Simone
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210707/7bfdb7af/attachment.html>

From HonZhu at clarku.edu  Wed Jul  7 14:05:25 2021
From: HonZhu at clarku.edu (Hongmei Zhu)
Date: Wed, 7 Jul 2021 21:05:25 +0000
Subject: [gdal-dev] Idrisi driver in GDAL v3.3.1
Message-ID: <MN2PR03MB52323CF84F9E2CB9E2422214AC1A9@MN2PR03MB5232.namprd03.prod.outlook.com>

Hi Even,

Cylindrical equal area support was added in IDRISI driver, and the code was merged on April 27. But we still don't see the update in GDAL v3.3.1. Just wondering when it's available in GDAL official release. Thank you very much.

Best,
Hongmei

GIS Developer
Clark Labs
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210707/df51fa81/attachment.html>

From even.rouault at spatialys.com  Wed Jul  7 14:12:55 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 7 Jul 2021 23:12:55 +0200
Subject: [gdal-dev] Idrisi driver in GDAL v3.3.1
In-Reply-To: <MN2PR03MB52323CF84F9E2CB9E2422214AC1A9@MN2PR03MB5232.namprd03.prod.outlook.com>
References: <MN2PR03MB52323CF84F9E2CB9E2422214AC1A9@MN2PR03MB5232.namprd03.prod.outlook.com>
Message-ID: <6056ea09-7954-ca03-0937-6704e343c0ca@spatialys.com>

Hongmei,


It was added in master / 3.4.0 only as being a new feature. So this will 
land in the 3.4.0 release around beginning of november


Even


Le 07/07/2021 ? 23:05, Hongmei Zhu a ?crit?:
> Hi Even,
>
> Cylindrical equal area support was added in IDRISI driver, and the 
> code was merged on April 27. But we still don't see the update in GDAL 
> v3.3.1. Just wondering when it's available in GDAL official release. 
> Thank you very?much.
>
> Best,
> Hongmei
>
> GIS Developer
> Clark Labs
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210707/3d820d22/attachment.html>

From HonZhu at clarku.edu  Thu Jul  8 06:14:00 2021
From: HonZhu at clarku.edu (Hongmei Zhu)
Date: Thu, 8 Jul 2021 13:14:00 +0000
Subject: [gdal-dev] [EXT] Re:  Idrisi driver in GDAL v3.3.1
In-Reply-To: <6056ea09-7954-ca03-0937-6704e343c0ca@spatialys.com>
References: <MN2PR03MB52323CF84F9E2CB9E2422214AC1A9@MN2PR03MB5232.namprd03.prod.outlook.com>,
 <6056ea09-7954-ca03-0937-6704e343c0ca@spatialys.com>
Message-ID: <MN2PR03MB5232F26B8459AF4218B0FD5CAC199@MN2PR03MB5232.namprd03.prod.outlook.com>

Hi Even,

Thank you very much for letting me know.

Hongmei
________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, July 7, 2021 5:12 PM
To: Hongmei Zhu <HonZhu at clarku.edu>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [EXT] Re: [gdal-dev] Idrisi driver in GDAL v3.3.1


Hongmei,


It was added in master / 3.4.0 only as being a new feature. So this will land in the 3.4.0 release around beginning of november


Even


Le 07/07/2021 ? 23:05, Hongmei Zhu a ?crit :
Hi Even,

Cylindrical equal area support was added in IDRISI driver, and the code was merged on April 27. But we still don't see the update in GDAL v3.3.1. Just wondering when it's available in GDAL official release. Thank you very much.

Best,
Hongmei

GIS Developer
Clark Labs



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://nam10.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=04%7C01%7CHonZhu%40clarku.edu%7C8c1480cccb574b6e4e3608d9418bfee6%7Cb5b2263d68aa453eb972aa1421410f80%7C0%7C0%7C637612891799184493%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=qLDfxZZL3GsnjwcgFuidPNfT2jIlh1ANGujsXU6qLpc%3D&reserved=0>


--
http://www.spatialys.com<https://nam10.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=04%7C01%7CHonZhu%40clarku.edu%7C8c1480cccb574b6e4e3608d9418bfee6%7Cb5b2263d68aa453eb972aa1421410f80%7C0%7C0%7C637612891799184493%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=P6cInIt%2FIYKBQgzsck%2FJdNVH%2B56FgRgOg1Gh6O%2FwsmA%3D&reserved=0>
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/9d55dffd/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Thu Jul  8 08:53:19 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 8 Jul 2021 15:53:19 +0000
Subject: [gdal-dev] gdaladdo bigtiff err but --config BIGTIFF was used
In-Reply-To: <CAOM3y2in81k0Ukpz_EOK2OGuAC-THE71mW4dJwoJ3iX1Vx_pcA@mail.gmail.com>
References: <4dd8097926c14446b92cc72a11e773f5@yukon.ca>
 <CAOM3y2jnrGdwr15nPNHrV14BoioLuTz_BAhEDEYZ+O04edYVwA@mail.gmail.com>
 <1c2bd47049a44a21aa638a015e735225@yukon.ca>
 <35b032a0-74ef-8f90-bddd-c7e91e398177@spatialys.com>
 <065a999748334766a603af76ff368173@yukon.ca>
 <CAOM3y2in81k0Ukpz_EOK2OGuAC-THE71mW4dJwoJ3iX1Vx_pcA@mail.gmail.com>
Message-ID: <65dbd468d4e14429a557e59013deb78c@yukon.ca>

cogger v0.0.5 now supports .ovr external overviews. It will automatically set the output cog to bigtiff if required, so your use-case should now be covered.

Oh that?s great, thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/5632e7cd/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jul  8 09:17:34 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 8 Jul 2021 16:17:34 +0000
Subject: [gdal-dev] a flag for translate stop or abort on error?
Message-ID: <9c0e5788f9a14b88a1234aad7ffe7165@yukon.ca>

Hi,

Is there a flag or something to instruct gdal_translate to stop or abort when it encounters an error?


gdal_translate   -co compress=zstd   -co predictor=yes   -co level=17   -co bigtiff=yes   -of cog   -a_nodata 0 Finlayson9488_SP6_24Aug2016_150cm.rgb-nir.vrt out\Finlayson9488_SP6_24Aug2016_150cm.rgb-nir.tif

Input file size is 43101, 54192
0...10..ERROR 1: LZWDecode:Corrupted LZW table at scanline 0
ERROR 1: TIFFReadEncodedTile() failed.
ERROR 1: IReadBlock failed at X offset 0, Y offset 0: TIFFReadEncodedTile() failed.
ERROR 1: LZWDecode:Corrupted LZW table at scanline 0
ERROR 1: TIFFReadEncodedTile() failed.
...many repeats.

The next day, no changes made to files or environment:

gdal_translate   -co compress=zstd   -co predictor=yes   -co level=17   -co bigtiff=yes   -of cog   -a_nodata 0 Finlayson9488_SP6_24Aug2016_150cm.rgb-nir.vrt out\Finlayson9488_SP6_24Aug2016_150cm.rgb-nir.tif

Input file size is 43101, 54192
0...10...20...30...40...50... (still going)


The vrt being translated points to 4 other vrt which in turn are reading from a network share holding zip archives of the source imagery. (I'm taking 3 bands from an RGB-inzip and 1 band from a 3 band Infrared-RG-inzip and creating a single 4 band  RGB-I cloud geotiff.)

I suspect the problem has to do with a network timeout or something but really the cause doesn't matter for me here. I just want gdal_translate to stop or abort when something like this goes wrong. Is that possible?


Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/765faba4/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jul  8 09:32:10 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 8 Jul 2021 16:32:10 +0000
Subject: [gdal-dev] TIFFFetchDirectory:Sanity check on directory count failed
Message-ID: <d04d405cc862495c9267ea4b18f21733@yukon.ca>

Related to my previous question today, what is the nature of "TIFFFetchDirectory:Sanity check on directory count failed" error?

:: gdal_translate   -co compress=zstd   -co predictor=yes   -co level=17   -co bigtiff=yes   -of cog   -a_nodata 0 Finlayson9488_SP7_08Aug2017_150cm.rgb-nir.vrt out\Finlayson9488_SP7_08Aug2017_150cm.rgb-nir.tif
Input file size is 41114, 22580
0...10...20ERROR 1: TIFFFetchDirectory:Sanity check on directory count failed, this is probably not a valid IFD offset
ERROR 1: TIFFReadDirectory:Failed to read directory at offset 16879620
...30...40...50...60...70...80...90...100 - done.


The translate run finished successfully and `gdalinfo -mm ...` reports no errors on the output file structure. Visually the image appears intact. (Is scanning for minmax the best way to test for a valid file? I've been using it that way for years but maybe it's not best practice.)

Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/647551ea/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jul  8 10:08:58 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 8 Jul 2021 19:08:58 +0200
Subject: [gdal-dev] a flag for translate stop or abort on error?
In-Reply-To: <9c0e5788f9a14b88a1234aad7ffe7165@yukon.ca>
References: <9c0e5788f9a14b88a1234aad7ffe7165@yukon.ca>
Message-ID: <fc5f8be5-adf1-1222-8926-4465eb826c6f@spatialys.com>

Matt,

when you get the "TIFFReadEncodedTile() failed.", it is in a failure 
path of the geotiff driver, so the processing should stop immediately. I 
suspect something later in the stack (VRT driver?) doesn't, but without 
a reproducer to investigate what's going on exactly, hard to tell

Even

Le 08/07/2021 ? 18:17, Matt.Wilkie at yukon.ca a ?crit?:
> TIFFReadEncodedTile() fai

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/31414f76/attachment.html>

From even.rouault at spatialys.com  Thu Jul  8 10:17:09 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 8 Jul 2021 19:17:09 +0200
Subject: [gdal-dev] TIFFFetchDirectory:Sanity check on directory count
 failed
In-Reply-To: <d04d405cc862495c9267ea4b18f21733@yukon.ca>
References: <d04d405cc862495c9267ea4b18f21733@yukon.ca>
Message-ID: <e55ec21d-692a-03ec-c08a-6ad6a81422e3@spatialys.com>

Hum, this error comes from deep in libtiff: 
https://github.com/OSGeo/gdal/blob/fec15b146f8a750c23c5e765cac12ed5fc9c2b85/gdal/frmts/gtiff/libtiff/tif_dirread.c#L4802

It would indicate that a TIFF directory (image) has more than 4096 tags, 
which is highly unlikely for a valid image. The error is in a source 
TIFF image. It shouldn't affect the *structure* of the output TIFF file. 
It might be an overview of the source image that is corrupted. So it 
could potentially affect the content of the overviews of the target 
file, but likely not, as GDAL will likely skip the corrupted source 
overview and regenerate it.

Le 08/07/2021 ? 18:32, Matt.Wilkie at yukon.ca a ?crit?:
>
> Related to my previous question today, what is the nature of 
> ?TIFFFetchDirectory:Sanity check on directory count failed? error?
>
> :: gdal_translate?? -co compress=zstd?? -co predictor=yes?? -co 
> level=17 ??-co bigtiff=yes?? -of cog?? -a_nodata 0 
> Finlayson9488_SP7_08Aug2017_150cm.rgb-nir.vrt 
> out\Finlayson9488_SP7_08Aug2017_150cm.rgb-nir.tif
>
> Input file size is 41114, 22580
>
> 0...10...20ERROR 1: TIFFFetchDirectory:Sanity check on directory count 
> failed, this is probably not a valid IFD offset
>
> ERROR 1: TIFFReadDirectory:Failed to read directory at offset 16879620
>
> ...30...40...50...60...70...80...90...100 - done.
>
> The translate run finished successfully and `gdalinfo -mm ?` reports 
> no errors on the output file structure. Visually the image appears 
> intact. (Is scanning for minmax the best way to test for a valid file? 
> I?ve been using it that way for years but maybe it?s not best practice.)
>
> *Matt Wilkie*
>
> Geomatics Developer & Administrator
>
> Environment | Technology, Innovation and Mapping
>
> T 867-667-8133 | _Yukon.ca <http://yukon.ca/>_
>
> /Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away./
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/6b54d485/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jul  8 14:28:14 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 8 Jul 2021 21:28:14 +0000
Subject: [gdal-dev] TIFFFetchDirectory:Sanity check on directory count
 failed
In-Reply-To: <e55ec21d-692a-03ec-c08a-6ad6a81422e3@spatialys.com>
References: <d04d405cc862495c9267ea4b18f21733@yukon.ca>
 <e55ec21d-692a-03ec-c08a-6ad6a81422e3@spatialys.com>
Message-ID: <78e7acc1f9e04edcb20298b8fbe93d2e@yukon.ca>

Ah, okay. As nothing seems amiss with the translated file I'll just note the name and error and keep going.  Thanks for the info Even.

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/9c8c2217/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jul  8 14:31:31 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 8 Jul 2021 21:31:31 +0000
Subject: [gdal-dev] a flag for translate stop or abort on error?
In-Reply-To: <fc5f8be5-adf1-1222-8926-4465eb826c6f@spatialys.com>
References: <9c0e5788f9a14b88a1234aad7ffe7165@yukon.ca>
 <fc5f8be5-adf1-1222-8926-4465eb826c6f@spatialys.com>
Message-ID: <7ddc2154453742c9a23f3763b42434d2@yukon.ca>

Good to know, thanks.

For the rest of the set I'm going to unpack the archives first instead using /vsizip. I'm making several passes over the contents and some testing has shown that is slowing things down a lot. If I manage to find a reproducible set I'll let you know.

-Matt

From: Even Rouault <even.rouault at spatialys.com>

Matt,

when you get the "TIFFReadEncodedTile() failed.", it is in a failure path of the geotiff driver, so the processing should stop immediately. I suspect something later in the stack (VRT driver?) doesn't, but without a reproducer to investigate what's going on exactly, hard to tell

Even
Le 08/07/2021 ? 18:17, Matt.Wilkie at yukon.ca<mailto:Matt.Wilkie at yukon.ca> a ?crit :
TIFFReadEncodedTile() fai

--

http://www.spatialys.com<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=http%3a%2f%2fwww.spatialys.com&umid=0763D56F-C69F-B605-A36A-1A70FA6A0A31&auth=c132af8ee7c9d1278d61a701569070a095ce962e-9f7f02676c852557b250faa4e51fdba9dce73888>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210708/f04d840d/attachment.html>

From loridigia at gmail.com  Fri Jul  9 07:29:50 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Fri, 9 Jul 2021 16:29:50 +0200
Subject: [gdal-dev] Lost band name during merge
Message-ID: <CAERmyNQuqA-HvJuzoidx08mefr0vHVotTLdF8avnK18F+6aDmw@mail.gmail.com>

Hi, i have N netcdf OR N tiff.
I want merge them all in 1 tiff.
I do that using:
Either gdal_merge.py -separate -o ....
OR gdalbuildvrt AND gdal_translate ... Both approaches works but each band
has a name like "band_1", "band_2" ecc. the original band name is lost....
Is there a way to at least keep the band name like
"original_file_name_1"... Because the informations abouts the bands are
lost and are impossibile to know which bands coming from which file.
Thanks!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/8d4e4f3a/attachment.html>

From sayena79 at gmail.com  Fri Jul  9 07:31:41 2021
From: sayena79 at gmail.com (Sayena)
Date: Fri, 9 Jul 2021 09:31:41 -0500
Subject: [gdal-dev] Install GDAL on Arcmap 10.7
Message-ID: <CADkqvG5efJN+Y-jwG6UoAQwnSpYpOYweOKeWDZVDhQL4CMCcxw@mail.gmail.com>

Hello
I want to use Census data 2000 Urbanized area - They are in the ASCII
format and apparently need a translator to convert them to lines/ polylines.

I searched in the internet and found out about the GDAL that can do the
job. But just don't know how to use the graphic user interface with Arcmap
10.7

I do really appreciate your help

-- 
Sayena Farid Marandi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/dbc0d657/attachment.html>

From Matt.Wilkie at yukon.ca  Fri Jul  9 07:57:09 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Fri, 9 Jul 2021 14:57:09 +0000
Subject: [gdal-dev] Lost band name during merge
In-Reply-To: <CAERmyNQuqA-HvJuzoidx08mefr0vHVotTLdF8avnK18F+6aDmw@mail.gmail.com>
References: <CAERmyNQuqA-HvJuzoidx08mefr0vHVotTLdF8avnK18F+6aDmw@mail.gmail.com>
Message-ID: <c3af23d39cdb46cdabcec39bcd10e4ca@yukon.ca>

Hi Lorenzo,

Attached is a short python script to copy band info from one file to another. It?s not a solution but might be helpful. Usage is

gdal-copy-band-info [in_file] [band #] [out_file] [band #]


cheers,

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Lorenzo Di Giacomo
Sent: July 9, 2021 7:30 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Lost band name during merge


*** External email: Do not click on links or attachments except from trusted senders. ***

******************************************************************************************



Hi, i have N netcdf OR N tiff.
I want merge them all in 1 tiff.
I do that using:
Either gdal_merge.py -separate -o ....
OR gdalbuildvrt AND gdal_translate ... Both approaches works but each band has a name like "band_1", "band_2" ecc. the original band name is lost.... Is there a way to at least keep the band name like "original_file_name_1"... Because the informations abouts the bands are lost and are impossibile to know which bands coming from which file.
Thanks!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/8c93bbec/attachment-0001.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: gdal-copy-band-info.py.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/8c93bbec/attachment-0001.txt>

From Matt.Wilkie at yukon.ca  Fri Jul  9 08:06:12 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Fri, 9 Jul 2021 15:06:12 +0000
Subject: [gdal-dev] Install GDAL on Arcmap 10.7
In-Reply-To: <CADkqvG5efJN+Y-jwG6UoAQwnSpYpOYweOKeWDZVDhQL4CMCcxw@mail.gmail.com>
References: <CADkqvG5efJN+Y-jwG6UoAQwnSpYpOYweOKeWDZVDhQL4CMCcxw@mail.gmail.com>
Message-ID: <6c5346ab47e84cbcabd504d485264777@yukon.ca>

Hello Sayena,

Gdal doesn?t have a graphic interface, it?s all command line utilities and programmer libraries. However Qgis (https://qgis.org/) is very well integrated with Gdal and is similar to ArcMap in a lot of ways and the members of the Qgis Community<https://qgis.org/en/site/forusers/support.html> are generally helpful if the docs don?t cover your situation.

Also within ArcMap you may have access to the Data Interoperability extension<https://desktop.arcgis.com/en/arcmap/latest/extensions/data-interoperability/what-is-the-data-interoperability-extension-.htm>.

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Sayena
Sent: July 9, 2021 7:32 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Install GDAL on Arcmap 10.7


*** External email: Do not click on links or attachments except from trusted senders. ***

******************************************************************************************



Hello
I want to use Census data 2000 Urbanized area - They are in the ASCII format and apparently need a translator to convert them to lines/ polylines.

I searched in the internet and found out about the GDAL that can do the job. But just don't know how to use the graphic user interface with Arcmap 10.7

I do really appreciate your help

--
Sayena Farid Marandi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/eb6c7772/attachment.html>

From Matt.Wilkie at yukon.ca  Fri Jul  9 12:38:15 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Fri, 9 Jul 2021 19:38:15 +0000
Subject: [gdal-dev] DIMAP driver questions
Message-ID: <ecd85252498a48a487dd80a0334fe52d@yukon.ca>

Hi,

The DIMAP driver page<https://gdal.org/drivers/raster/dimap.html> lists names of the index files to look at. I don't have any of these filenames in our SPOT6 folder tree. Is the driver description page incomplete or perhaps I've been given a different DIMAP version?

METADATA.DIM (DIMAP 1),
VOL_PHR.XML (DIMAP 2) or
VOL_PNEO.XML (DIMAP 2 VHR-2020)

By pointing gdalinfo at the xml files I think I've determined that the index file name is of the pattern "DIM_SPOT6_MS_201508152008275_SEN_1.XML". Is this right?

The directory tree I have is:

```
$ tree
Folder PATH listing for volume Data
Volume serial number is C0000100 AEC2:FADE
D:.
????DS_SPOT6_201508152008275_LM1_LM1_LM1_LM1_W138N63_06499
    ????LIBRARY
    ????PROD_SPOT6_001
        ????LIBRARY
        ????VOL_SPOT6_001_A
            ????IMG_SPOT6_MS_001_A
            ?   ????LIBRARY
            ?   ????LINEAGE
            ?   ????MASKS
            ????IMG_SPOT6_P_001_A
            ?   ????LIBRARY
            ?   ????LINEAGE
            ?   ????MASKS
            ????LIBRARY
```

Gdalinfo report and filename listings attached.


The folders named "lineage" and "mask" have names that indicate useful info however gdalinfo report doesn't refer to them. Is there some other way to take advantage of them or is that the province of full blown remote sensing software?

I'm using GDAL Utilities v3.1.4 released 2020/10/20 via Qgis 3.18 on Windows.

Thanks in advance for your thoughts,

Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/75897bf3/attachment-0001.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: file-list.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/75897bf3/attachment-0003.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: gdalinfo-report.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/75897bf3/attachment-0004.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: xml-list.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210709/75897bf3/attachment-0005.txt>

From thomas.bonfort at gmail.com  Fri Jul  9 12:42:53 2021
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Fri, 9 Jul 2021 21:42:53 +0200
Subject: [gdal-dev] DIMAP driver questions
In-Reply-To: <ecd85252498a48a487dd80a0334fe52d@yukon.ca>
References: <ecd85252498a48a487dd80a0334fe52d@yukon.ca>
Message-ID: <CAOM3y2iTi0Ya3Tb_-4QfmXzkBMVk=i44teAGcfSyR57JwdjcoQ@mail.gmail.com>

You can open the DIM_*.XML files with gdal, those are the useful ones.

--
Thomas

On Fri, Jul 9, 2021 at 9:38 PM <Matt.Wilkie at yukon.ca> wrote:
>
> Hi,
>
>
>
> The DIMAP driver page lists names of the index files to look at. I don?t have any of these filenames in our SPOT6 folder tree. Is the driver description page incomplete or perhaps I?ve been given a different DIMAP version?
>
>
>
> METADATA.DIM (DIMAP 1),
>
> VOL_PHR.XML (DIMAP 2) or
>
> VOL_PNEO.XML (DIMAP 2 VHR-2020)
>
>
>
> By pointing gdalinfo at the xml files I think I?ve determined that the index file name is of the pattern ?DIM_SPOT6_MS_201508152008275_SEN_1.XML?. Is this right?
>
>
>
> The directory tree I have is:
>
>
>
> ```
>
> $ tree
>
> Folder PATH listing for volume Data
>
> Volume serial number is C0000100 AEC2:FADE
>
> D:.
>
> ????DS_SPOT6_201508152008275_LM1_LM1_LM1_LM1_W138N63_06499
>
>     ????LIBRARY
>
>     ????PROD_SPOT6_001
>
>         ????LIBRARY
>
>         ????VOL_SPOT6_001_A
>
>             ????IMG_SPOT6_MS_001_A
>
>             ?   ????LIBRARY
>
>             ?   ????LINEAGE
>
>             ?   ????MASKS
>
>             ????IMG_SPOT6_P_001_A
>
>             ?   ????LIBRARY
>
>             ?   ????LINEAGE
>
>             ?   ????MASKS
>
>             ????LIBRARY
>
> ```
>
>
>
> Gdalinfo report and filename listings attached.
>
>
>
>
>
> The folders named ?lineage? and ?mask? have names that indicate useful info however gdalinfo report doesn?t refer to them. Is there some other way to take advantage of them or is that the province of full blown remote sensing software?
>
>
>
> I?m using GDAL Utilities v3.1.4 released 2020/10/20 via Qgis 3.18 on Windows.
>
>
>
> Thanks in advance for your thoughts,
>
>
>
> Matt Wilkie
>
> Geomatics Developer & Administrator
>
> Environment | Technology, Innovation and Mapping
>
> T 867-667-8133 | Yukon.ca
>
> Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From Matt.Wilkie at yukon.ca  Mon Jul 12 11:48:36 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Mon, 12 Jul 2021 18:48:36 +0000
Subject: [gdal-dev] What is the gdal_translate scale exponent option for?
Message-ID: <1f9e9157f16042abad4ece7210c5f44e@yukon.ca>

Hi Folks,

gdal_translate has the option -exponent <exp_val><https://gdal.org/programs/gdal_translate.html#cmdoption-gdal_translate-exponent> to use in conjunction with -scale that will

apply non-linear scaling with a power function. exp_val is the exponent of the power function (must be positive).

This describes what the function does at the mechanical level but not why or when it might be a good idea. What are appropriate scenarios to use this feature? How is it useful and what does it accomplish?
Cross-posted to https://gis.stackexchange.com/questions/403776/what-is-the-gdal-translate-scale-exponent-option-for


Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210712/5ee7e465/attachment.html>

From even.rouault at spatialys.com  Mon Jul 12 11:51:46 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 Jul 2021 20:51:46 +0200
Subject: [gdal-dev] What is the gdal_translate scale exponent option for?
In-Reply-To: <1f9e9157f16042abad4ece7210c5f44e@yukon.ca>
References: <1f9e9157f16042abad4ece7210c5f44e@yukon.ca>
Message-ID: <cdb163f9-b4d4-2632-e218-509589d698e8@spatialys.com>


Le 12/07/2021 ? 20:48, Matt.Wilkie at yukon.ca a ?crit?:
>
> Hi Folks,
>
> |gdal_translate| has the option |-exponent <exp_val>| 
> <https://gdal.org/programs/gdal_translate.html#cmdoption-gdal_translate-exponent> 
> to use in conjunction with |-scale| that will
>
> /apply non-linear scaling with a power function. exp_val is the 
> exponent of the power function (must be positive)./
>
> This describes what the function does at the mechanical level but not 
> why or when it might be a good idea. What are appropriate scenarios to 
> use this feature? How is it useful and what does it accomplish?
>
For example to perform https://en.wikipedia.org/wiki/Gamma_correction

-- 

http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210712/9853ce3d/attachment.html>

From j1 at jimenezshaw.com  Tue Jul 13 04:57:05 2021
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 13 Jul 2021 13:57:05 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
Message-ID: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>

Hi

I am computing the overviews of a GeoTIFF on my own (using the GPU, much
faster), and I want to include them in the tif file (also in the ovr
sidecar file).
What is the best way to do it? Just creating a multipage TIFF (I guess with
the option APPEND_SUBDATASET=YES)? Is there anything else needed (metadata,
tiff tags, etc)?

So far I want to do it in RGBA 8 bit images. (In the future I want to do it
also in float32 images with nodata value and any number of bands, but no
hurry).

I am using GDAL 3.3.1

Any help is welcome.

Thanks.
Javier.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/a0947b59/attachment.html>

From even.rouault at spatialys.com  Tue Jul 13 05:04:12 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Jul 2021 14:04:12 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
Message-ID: <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>

Javier,

You can use the "NONE" resampling method in BuildOverviews() or gdaladdo 
to create the overviews IFD without allocating any storage, and then you 
can open the file in update mode to set whatever values you want. 
APPEND_SUBDATASET=YES will not set the appropriate value for the 
SubFileType TIFF tag, and thus such pages won't be recognized as overviews

Even

Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit?:
> Hi
>
> I am computing the overviews of a GeoTIFF on my own (using the GPU, 
> much faster), and I want to include them in the tif file (also in the 
> ovr sidecar file).
> What is the best way to do it? Just creating a multipage TIFF (I guess 
> with the option APPEND_SUBDATASET=YES)? Is there anything else needed 
> (metadata, tiff tags, etc)?
>
> So far I want to do it in RGBA 8 bit images. (In the future I want to 
> do it also in float32 images with nodata value and any number of 
> bands, but no hurry).
>
> I am using GDAL 3.3.1
>
> Any help is welcome.
>
> Thanks.
> Javier.
> .___ ._ ..._ .. . ._. .___ .. __ . _. . __..? ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/c97c7a40/attachment.html>

From thomas.bonfort at gmail.com  Tue Jul 13 05:15:28 2021
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Tue, 13 Jul 2021 14:15:28 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
Message-ID: <CAOM3y2jtasthG5EOLhRP0EzePz3dsewbd0Ju6mJ77Me9g8gxOQ@mail.gmail.com>

Javier,
You can use https://github.com/airbusgeo/cogger#advanced to do that,
provided that you have an internally tiled geotiff.

--
thomas

On Tue, Jul 13, 2021 at 2:04 PM Even Rouault <even.rouault at spatialys.com> wrote:
>
> Javier,
>
> You can use the "NONE" resampling method in BuildOverviews() or gdaladdo to create the overviews IFD without allocating any storage, and then you can open the file in update mode to set whatever values you want. APPEND_SUBDATASET=YES will not set the appropriate value for the SubFileType TIFF tag, and thus such pages won't be recognized as overviews
>
> Even
>
> Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit :
>
> Hi
>
> I am computing the overviews of a GeoTIFF on my own (using the GPU, much faster), and I want to include them in the tif file (also in the ovr sidecar file).
> What is the best way to do it? Just creating a multipage TIFF (I guess with the option APPEND_SUBDATASET=YES)? Is there anything else needed (metadata, tiff tags, etc)?
>
> So far I want to do it in RGBA 8 bit images. (In the future I want to do it also in float32 images with nodata value and any number of bands, but no hurry).
>
> I am using GDAL 3.3.1
>
> Any help is welcome.
>
> Thanks.
> Javier.
> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From j1 at jimenezshaw.com  Tue Jul 13 05:53:14 2021
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 13 Jul 2021 14:53:14 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <CAOM3y2jtasthG5EOLhRP0EzePz3dsewbd0Ju6mJ77Me9g8gxOQ@mail.gmail.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
 <CAOM3y2jtasthG5EOLhRP0EzePz3dsewbd0Ju6mJ77Me9g8gxOQ@mail.gmail.com>
Message-ID: <CADRrdKt980jUNCMJs6ATt8t=T8_9T=3bdPmQxG6=aYgbbZjRcA@mail.gmail.com>

Thanks Thomas and Even.

Thomas, about using cogger (that would be great), I forgot to mention that
I am doing it from a C++ library. Is there already a C/C++ API?

Cheers,
Javier
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Tue, 13 Jul 2021 at 14:15, thomas bonfort <thomas.bonfort at gmail.com>
wrote:

> Javier,
> You can use https://github.com/airbusgeo/cogger#advanced to do that,
> provided that you have an internally tiled geotiff.
>
> --
> thomas
>
> On Tue, Jul 13, 2021 at 2:04 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Javier,
> >
> > You can use the "NONE" resampling method in BuildOverviews() or gdaladdo
> to create the overviews IFD without allocating any storage, and then you
> can open the file in update mode to set whatever values you want.
> APPEND_SUBDATASET=YES will not set the appropriate value for the
> SubFileType TIFF tag, and thus such pages won't be recognized as overviews
> >
> > Even
> >
> > Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit :
> >
> > Hi
> >
> > I am computing the overviews of a GeoTIFF on my own (using the GPU, much
> faster), and I want to include them in the tif file (also in the ovr
> sidecar file).
> > What is the best way to do it? Just creating a multipage TIFF (I guess
> with the option APPEND_SUBDATASET=YES)? Is there anything else needed
> (metadata, tiff tags, etc)?
> >
> > So far I want to do it in RGBA 8 bit images. (In the future I want to do
> it also in float32 images with nodata value and any number of bands, but no
> hurry).
> >
> > I am using GDAL 3.3.1
> >
> > Any help is welcome.
> >
> > Thanks.
> > Javier.
> > .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> > Entre dos pensamientos racionales
> > hay infinitos pensamientos irracionales.
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > --
> > http://www.spatialys.com
> > My software is free, but my time generally not.
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/a3e52eec/attachment.html>

From thomas.bonfort at gmail.com  Tue Jul 13 05:55:40 2021
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Tue, 13 Jul 2021 14:55:40 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <CADRrdKt980jUNCMJs6ATt8t=T8_9T=3bdPmQxG6=aYgbbZjRcA@mail.gmail.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
 <CAOM3y2jtasthG5EOLhRP0EzePz3dsewbd0Ju6mJ77Me9g8gxOQ@mail.gmail.com>
 <CADRrdKt980jUNCMJs6ATt8t=T8_9T=3bdPmQxG6=aYgbbZjRcA@mail.gmail.com>
Message-ID: <CAOM3y2hzCMojGMxMNibv-cV9dGYfAML1QKMj6D=xDKgW6TLBZQ@mail.gmail.com>

https://www.mail-archive.com/gdal-dev at lists.osgeo.org/msg36305.html
:)

On Tue, Jul 13, 2021 at 2:53 PM Javier Jimenez Shaw <j1 at jimenezshaw.com> wrote:
>
> Thanks Thomas and Even.
>
> Thomas, about using cogger (that would be great), I forgot to mention that I am doing it from a C++ library. Is there already a C/C++ API?
>
> Cheers,
> Javier
> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
>
> On Tue, 13 Jul 2021 at 14:15, thomas bonfort <thomas.bonfort at gmail.com> wrote:
>>
>> Javier,
>> You can use https://github.com/airbusgeo/cogger#advanced to do that,
>> provided that you have an internally tiled geotiff.
>>
>> --
>> thomas
>>
>> On Tue, Jul 13, 2021 at 2:04 PM Even Rouault <even.rouault at spatialys.com> wrote:
>> >
>> > Javier,
>> >
>> > You can use the "NONE" resampling method in BuildOverviews() or gdaladdo to create the overviews IFD without allocating any storage, and then you can open the file in update mode to set whatever values you want. APPEND_SUBDATASET=YES will not set the appropriate value for the SubFileType TIFF tag, and thus such pages won't be recognized as overviews
>> >
>> > Even
>> >
>> > Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit :
>> >
>> > Hi
>> >
>> > I am computing the overviews of a GeoTIFF on my own (using the GPU, much faster), and I want to include them in the tif file (also in the ovr sidecar file).
>> > What is the best way to do it? Just creating a multipage TIFF (I guess with the option APPEND_SUBDATASET=YES)? Is there anything else needed (metadata, tiff tags, etc)?
>> >
>> > So far I want to do it in RGBA 8 bit images. (In the future I want to do it also in float32 images with nodata value and any number of bands, but no hurry).
>> >
>> > I am using GDAL 3.3.1
>> >
>> > Any help is welcome.
>> >
>> > Thanks.
>> > Javier.
>> > .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
>> > Entre dos pensamientos racionales
>> > hay infinitos pensamientos irracionales.
>> >
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>> > --
>> > http://www.spatialys.com
>> > My software is free, but my time generally not.
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev

From thomas.bonfort at gmail.com  Tue Jul 13 06:23:20 2021
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Tue, 13 Jul 2021 15:23:20 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <CAOM3y2hzCMojGMxMNibv-cV9dGYfAML1QKMj6D=xDKgW6TLBZQ@mail.gmail.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
 <CAOM3y2jtasthG5EOLhRP0EzePz3dsewbd0Ju6mJ77Me9g8gxOQ@mail.gmail.com>
 <CADRrdKt980jUNCMJs6ATt8t=T8_9T=3bdPmQxG6=aYgbbZjRcA@mail.gmail.com>
 <CAOM3y2hzCMojGMxMNibv-cV9dGYfAML1QKMj6D=xDKgW6TLBZQ@mail.gmail.com>
Message-ID: <CAOM3y2gfOQ+VQVqhanB4Dk6dS1bNaaozb_8f6Se=opxw2QMeyA@mail.gmail.com>

Here's a working c version:
https://gist.github.com/tbonfort/1e8630cf4b9bc82471c164e422c1cce7

On Tue, Jul 13, 2021 at 2:55 PM thomas bonfort <thomas.bonfort at gmail.com> wrote:
>
> https://www.mail-archive.com/gdal-dev at lists.osgeo.org/msg36305.html
> :)
>
> On Tue, Jul 13, 2021 at 2:53 PM Javier Jimenez Shaw <j1 at jimenezshaw.com> wrote:
> >
> > Thanks Thomas and Even.
> >
> > Thomas, about using cogger (that would be great), I forgot to mention that I am doing it from a C++ library. Is there already a C/C++ API?
> >
> > Cheers,
> > Javier
> > .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> > Entre dos pensamientos racionales
> > hay infinitos pensamientos irracionales.
> >
> >
> >
> > On Tue, 13 Jul 2021 at 14:15, thomas bonfort <thomas.bonfort at gmail.com> wrote:
> >>
> >> Javier,
> >> You can use https://github.com/airbusgeo/cogger#advanced to do that,
> >> provided that you have an internally tiled geotiff.
> >>
> >> --
> >> thomas
> >>
> >> On Tue, Jul 13, 2021 at 2:04 PM Even Rouault <even.rouault at spatialys.com> wrote:
> >> >
> >> > Javier,
> >> >
> >> > You can use the "NONE" resampling method in BuildOverviews() or gdaladdo to create the overviews IFD without allocating any storage, and then you can open the file in update mode to set whatever values you want. APPEND_SUBDATASET=YES will not set the appropriate value for the SubFileType TIFF tag, and thus such pages won't be recognized as overviews
> >> >
> >> > Even
> >> >
> >> > Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit :
> >> >
> >> > Hi
> >> >
> >> > I am computing the overviews of a GeoTIFF on my own (using the GPU, much faster), and I want to include them in the tif file (also in the ovr sidecar file).
> >> > What is the best way to do it? Just creating a multipage TIFF (I guess with the option APPEND_SUBDATASET=YES)? Is there anything else needed (metadata, tiff tags, etc)?
> >> >
> >> > So far I want to do it in RGBA 8 bit images. (In the future I want to do it also in float32 images with nodata value and any number of bands, but no hurry).
> >> >
> >> > I am using GDAL 3.3.1
> >> >
> >> > Any help is welcome.
> >> >
> >> > Thanks.
> >> > Javier.
> >> > .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> >> > Entre dos pensamientos racionales
> >> > hay infinitos pensamientos irracionales.
> >> >
> >> >
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev at lists.osgeo.org
> >> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> >
> >> > --
> >> > http://www.spatialys.com
> >> > My software is free, but my time generally not.
> >> >
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev at lists.osgeo.org
> >> > https://lists.osgeo.org/mailman/listinfo/gdal-dev

From j1 at jimenezshaw.com  Tue Jul 13 09:24:33 2021
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Tue, 13 Jul 2021 18:24:33 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
Message-ID: <CADRrdKsSeQYBhuGrMMDBU37kY_zLa4jjByw-rzN0v+xzBGLP5g@mail.gmail.com>

Sounds good.

My next question is how to write the overviews data efficiently.
I see that there is a method "GDALRasterBand * GDALRasterBand::GetOverview
( int i ) ", but for that I need to deinterlace the image (copying it), and
call it 4 times. Is there any trick I am missing while calling
GDALRasterBand::RasterIO? Maybe some black magic with the pixel and line
spaces? The images/overviews I get from the GPU are interlaced (RGBARGBA)
On the other side there is "GDALDataset::RasterIO(...)", but there is not
explicit way to set the overview level.

Thanks
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Tue, 13 Jul 2021 at 14:04, Even Rouault <even.rouault at spatialys.com>
wrote:

> Javier,
>
> You can use the "NONE" resampling method in BuildOverviews() or gdaladdo
> to create the overviews IFD without allocating any storage, and then you
> can open the file in update mode to set whatever values you want.
> APPEND_SUBDATASET=YES will not set the appropriate value for the
> SubFileType TIFF tag, and thus such pages won't be recognized as overviews
>
> Even
> Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit :
>
> Hi
>
> I am computing the overviews of a GeoTIFF on my own (using the GPU, much
> faster), and I want to include them in the tif file (also in the ovr
> sidecar file).
> What is the best way to do it? Just creating a multipage TIFF (I guess
> with the option APPEND_SUBDATASET=YES)? Is there anything else needed
> (metadata, tiff tags, etc)?
>
> So far I want to do it in RGBA 8 bit images. (In the future I want to do
> it also in float32 images with nodata value and any number of bands, but no
> hurry).
>
> I am using GDAL 3.3.1
>
> Any help is welcome.
>
> Thanks.
> Javier.
> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/b6f84911/attachment.html>

From even.rouault at spatialys.com  Tue Jul 13 09:34:43 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Jul 2021 18:34:43 +0200
Subject: [gdal-dev] Computing my overviews for GeoTIFF
In-Reply-To: <CADRrdKsSeQYBhuGrMMDBU37kY_zLa4jjByw-rzN0v+xzBGLP5g@mail.gmail.com>
References: <CADRrdKvTd4LwQzCYVOPNkhZ__5aH0bUzCmL_LXTyWzJS2sj8DA@mail.gmail.com>
 <9e5f7465-0adf-4feb-4f3a-9dcdadf2d61a@spatialys.com>
 <CADRrdKsSeQYBhuGrMMDBU37kY_zLa4jjByw-rzN0v+xzBGLP5g@mail.gmail.com>
Message-ID: <ef8ea2ca-864b-f56e-fd5e-93be87f9bcea@spatialys.com>


Le 13/07/2021 ? 18:24, Javier Jimenez Shaw a ?crit?:
> Sounds good.
>
> My next question is how to write the overviews data efficiently.
> I see that there is a method "GDALRasterBand * 
> GDALRasterBand::GetOverview ( int i ) ", but for that I need to 
> deinterlace the image (copying it), and call it 4 times. Is there any 
> trick I am missing while calling GDALRasterBand::RasterIO? Maybe some 
> black magic with the pixel and line spaces? The images/overviews I get 
> from the GPU are interlaced (RGBARGBA)
> On the other side there is "GDALDataset::RasterIO(...)", but there is 
> not explicit way to set the overview level.

You can call GetDataset() on the RasterBand returned by GetOverview(). 
Note that this will not necessarily return a non-NULL dataset for all 
drivers, but it will for GeoTIFF.

Internally though this will go through the GDAL block cache (per band), 
so there will be internal deinterlace & reinterlace, at least for 
internal overviews, that by default use pixel-interleaving (for external 
overviews, band interleaving is used)


>
> Thanks
> .___ ._ ..._ .. . ._. .___ .. __ . _. . __..? ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
>
> On Tue, 13 Jul 2021 at 14:04, Even Rouault <even.rouault at spatialys.com 
> <mailto:even.rouault at spatialys.com>> wrote:
>
>     Javier,
>
>     You can use the "NONE" resampling method in BuildOverviews() or
>     gdaladdo to create the overviews IFD without allocating any
>     storage, and then you can open the file in update mode to set
>     whatever values you want. APPEND_SUBDATASET=YES will not set the
>     appropriate value for the SubFileType TIFF tag, and thus such
>     pages won't be recognized as overviews
>
>     Even
>
>     Le 13/07/2021 ? 13:57, Javier Jimenez Shaw a ?crit?:
>>     Hi
>>
>>     I am computing the overviews of a GeoTIFF on my own (using the
>>     GPU, much faster), and I want to include them in the tif file
>>     (also in the ovr sidecar file).
>>     What is the best way to do it? Just creating a multipage TIFF (I
>>     guess with the option APPEND_SUBDATASET=YES)? Is there anything
>>     else needed (metadata, tiff tags, etc)?
>>
>>     So far I want to do it in RGBA 8 bit images. (In the future I
>>     want to do it also in float32 images with nodata value and any
>>     number of bands, but no hurry).
>>
>>     I am using GDAL 3.3.1
>>
>>     Any help is welcome.
>>
>>     Thanks.
>>     Javier.
>>     .___ ._ ..._ .. . ._.? .___ .. __ . _. . __..? ... .... ._ .__
>>     Entre dos pensamientos racionales
>>     hay infinitos pensamientos irracionales.
>>
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org  <mailto:gdal-dev at lists.osgeo.org>
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev  <https://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>     -- 
>     http://www.spatialys.com  <http://www.spatialys.com>
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/844e361e/attachment.html>

From cdelancy at blackfangtechnologies.com  Tue Jul 13 14:21:05 2021
From: cdelancy at blackfangtechnologies.com (Craig Delancy)
Date: Tue, 13 Jul 2021 21:21:05 +0000
Subject: [gdal-dev] Get bounds of object before reprojection?
Message-ID: <CH2PR17MB373398E36A2407373DE0C9E6C7149@CH2PR17MB3733.namprd17.prod.outlook.com>

Using the c++ API, how would I go about getting the bounds of a raster dataset, reprojected into another projection, without actually performing the reprojection first? Is there a way to do this, or do I have to do the reprojection to get this info?

I was thinking I could get the corners and reproject them as points, but I think this could give an incorrect answer depending on the target projection.

Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/eb9562f5/attachment.html>

From even.rouault at spatialys.com  Tue Jul 13 14:27:39 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Jul 2021 23:27:39 +0200
Subject: [gdal-dev] Get bounds of object before reprojection?
In-Reply-To: <CH2PR17MB373398E36A2407373DE0C9E6C7149@CH2PR17MB3733.namprd17.prod.outlook.com>
References: <CH2PR17MB373398E36A2407373DE0C9E6C7149@CH2PR17MB3733.namprd17.prod.outlook.com>
Message-ID: <aef47144-74b8-f405-53e0-9c42f7b61345@spatialys.com>

Craig,

you can for example use GDALAutoCreateWarpedVRT() to create a in-memory 
VRT (without reprojecting any pixel data) in the target projection and 
query its bounds

Even

Le 13/07/2021 ? 23:21, Craig Delancy a ?crit?:
>
> Using the c++ API, how would I go about getting the bounds of a raster 
> dataset, reprojected into another projection, without actually 
> performing the reprojection first? Is there a way to do this, or do I 
> have to do the reprojection to get this info?
>
> I was thinking I could get the corners and reproject them as points, 
> but I think this could give an incorrect answer depending on the 
> target projection.
>
> Thank you.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/d1535c1a/attachment.html>

From alansnow21 at gmail.com  Tue Jul 13 14:59:58 2021
From: alansnow21 at gmail.com (Alan Snow)
Date: Tue, 13 Jul 2021 16:59:58 -0500
Subject: [gdal-dev] Get bounds of object before reprojection?
In-Reply-To: <CH2PR17MB373398E36A2407373DE0C9E6C7149@CH2PR17MB3733.namprd17.prod.outlook.com>
References: <CH2PR17MB373398E36A2407373DE0C9E6C7149@CH2PR17MB3733.namprd17.prod.outlook.com>
Message-ID: <CAGybdFQTDdbOD-vnptdeGWR93ncHZqxGr0SagrTywLVKVtTC-g@mail.gmail.com>

This might be useful:

https://github.com/mapbox/rasterio/pull/2208

On Tue, Jul 13, 2021, 4:21 PM Craig Delancy <
cdelancy at blackfangtechnologies.com> wrote:

> Using the c++ API, how would I go about getting the bounds of a raster
> dataset, reprojected into another projection, without actually performing
> the reprojection first? Is there a way to do this, or do I have to do the
> reprojection to get this info?
>
> I was thinking I could get the corners and reproject them as points, but I
> think this could give an incorrect answer depending on the target
> projection.
>
>
>
> Thank you.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210713/7b570bce/attachment.html>

From loridigia at gmail.com  Wed Jul 14 06:58:13 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Wed, 14 Jul 2021 15:58:13 +0200
Subject: [gdal-dev] Lost band name during merge
In-Reply-To: <c3af23d39cdb46cdabcec39bcd10e4ca@yukon.ca>
References: <CAERmyNQuqA-HvJuzoidx08mefr0vHVotTLdF8avnK18F+6aDmw@mail.gmail.com>
 <c3af23d39cdb46cdabcec39bcd10e4ca@yukon.ca>
Message-ID: <CAERmyNRZRRxZPyNpe2oTpAvbMbU5iu82P8HdNVN4veXVTToN1g@mail.gmail.com>

Hi Matt, thanks but actually since i have more than 1 raster to merge and
each raster contains 1 band but with many levels, the script you pass me
doesn't do the trick. But yeah, what i need is to know during gdal_merge.py
(with -separate) if there is a way to bring in the output raster also the
bands properties.
Thanks!!!

Il giorno ven 9 lug 2021 alle ore 16:57 <Matt.Wilkie at yukon.ca> ha scritto:

> Hi Lorenzo,
>
>
>
> Attached is a short python script to copy band info from one file to
> another. It?s not a solution but might be helpful. Usage is
>
>
>
> gdal-copy-band-info [in_file] [band #] [out_file] [band #]
>
>
>
>
>
> cheers,
>
>
>
> -Matt
>
>
>
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Lorenzo
> Di Giacomo
> *Sent:* July 9, 2021 7:30 AM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* [gdal-dev] Lost band name during merge
>
>
>
> **** External email: Do not click on links or attachments except from trusted senders. ****
>
> ********************************************************************************************
>
>
>
> Hi, i have N netcdf OR N tiff.
> I want merge them all in 1 tiff.
> I do that using:
> Either gdal_merge.py -separate -o ....
> OR gdalbuildvrt AND gdal_translate ... Both approaches works but each
> band has a name like "band_1", "band_2" ecc. the original band name is
> lost.... Is there a way to at least keep the band name like
> "original_file_name_1"... Because the informations abouts the bands are
> lost and are impossibile to know which bands coming from which file.
> Thanks!!
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210714/fb40ee71/attachment-0001.html>

From howard at hobu.co  Wed Jul 14 12:15:29 2021
From: howard at hobu.co (Howard Butler)
Date: Wed, 14 Jul 2021 14:15:29 -0500
Subject: [gdal-dev] GDAL joins NumFOCUS Sponsored Projects
Message-ID: <B5E7697B-7773-402C-B86B-3094BF3D202D@hobu.co>

All,

As described in previous threads, the GDAL team has now completed the administrative tasks necessary to join NumFOCUS as a Sponsored Project. You can find the press release with a few more details at 

https://numfocus.medium.com/gdal-joins-numfocus-sponsored-projects-34189e3d8f92

NumFOCUS provides a nonprofit conduit for the project's sponsors https://gdal.org/sponsors/index.html to have a significant financial impact going forward. Thank you so much to our sponsors who have supported GDAL to make this leap. 

Howard

From loridigia at gmail.com  Wed Jul 14 12:37:46 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Wed, 14 Jul 2021 21:37:46 +0200
Subject: [gdal-dev] Metadata exceeding 32000 bytes cannot be written into
 GeoTIFF....
Message-ID: <CAERmyNTmb884u0gaVRf+mhDw17Ba=vDQ+KEGTYwXCWDwt6WYLQ@mail.gmail.com>

Hi i'm having a NetCDF (.nc) file, with N bands each of those have N levels.

My final goal would be have a single GEOTIFF with all the bands and levels
(since Geotiff dont support levels, all the levels will be a BAND)....

So my workflow would be: extract each band and its levels to 1 single tiff
each -> merge all tiffs in 1 final GeoTiff

But the problem, now, seems that i cant extract a band multi-level to a
single geotiff.
Using the command:

gdal_translate -a_srs EPSG:4326 -strict
NETCDF:MITO_20210713_20210713T00.nc:V -of GTiff
/Users/lollo/Desktop/TESTMITO/V.tiff

I actually have a GeoTiff with all the levels of the band "V" (in the
netcdf) as bands in the tiff... But there are not metadata, because i got a
WARNING:

Metadata exceeding 32000 bytes cannot be written into GeoTIFF. Transferred
to PAM instead.

How can i have 1 single tiff with all the metadata coming from the band in
netcdf? Thank you!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210714/aee5061d/attachment.html>

From even.rouault at spatialys.com  Wed Jul 14 13:24:05 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Jul 2021 22:24:05 +0200
Subject: [gdal-dev] Metadata exceeding 32000 bytes cannot be written
 into GeoTIFF....
In-Reply-To: <CAERmyNTmb884u0gaVRf+mhDw17Ba=vDQ+KEGTYwXCWDwt6WYLQ@mail.gmail.com>
References: <CAERmyNTmb884u0gaVRf+mhDw17Ba=vDQ+KEGTYwXCWDwt6WYLQ@mail.gmail.com>
Message-ID: <1b695a4f-e948-02d9-0f5d-4c68f5aa485b@spatialys.com>

Yes, there's this limitation to 32kb for the metadata stored in the 
GDAL_METADATA TIFF tag. I'm not sure where this comes from. I think this 
could probably be raised. Could you open a ticket about that ?

In the meantime, you could do

gdal_translate -a_srs EPSG:4326 -strict 
NETCDF:MITO_20210713_20210713T00.nc:V temp.vrt

then with a text editor edit temp.vrt to remove metadata items you don't 
need

and then

gdal_translate temp.vrt /Users/lollo/Desktop/TESTMITO/V.tiff


Le 14/07/2021 ? 21:37, Lorenzo Di Giacomo a ?crit?:
> Hi i'm having a NetCDF (.nc) file, with N bands each of those have N 
> levels.
>
> My final goal would be have a single?GEOTIFF with all the bands and 
> levels (since Geotiff dont?support levels, all the levels will be a 
> BAND)....
>
> So my workflow would be: extract each band and its levels to 1 single 
> tiff each -> merge all tiffs in 1 final GeoTiff
>
> But the problem, now, seems that i cant?extract a band multi-level to 
> a single geotiff.
> Using the command:
>
> gdal_translate -a_srs EPSG:4326 -strict 
> NETCDF:MITO_20210713_20210713T00.nc:V -of GTiff 
> /Users/lollo/Desktop/TESTMITO/V.tiff
>
> I actually have a GeoTiff with all the levels?of the band "V" (in the 
> netcdf) as bands in the tiff... But there are not metadata, because i 
> got a WARNING:
>
> Metadata exceeding 32000 bytes cannot be written into GeoTIFF. 
> Transferred to PAM instead.
>
> How can i have 1 single tiff with all the metadata coming from the 
> band in netcdf? Thank you!!
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210714/a9f20bf3/attachment.html>

From David.Hill at oregonstate.edu  Thu Jul 15 12:44:54 2021
From: David.Hill at oregonstate.edu (Hill, David Foster)
Date: Thu, 15 Jul 2021 19:44:54 +0000
Subject: [gdal-dev] gdal_translate from .nc --> .tif --- issue with
 coordinates
Message-ID: <FE187712-512C-4FD8-9EBC-19C7094F2597@oregonstate.edu>

Hello. I asked this question a few weeks ago, but I think my question was not complete enough, and I also think I did not attach the right files. So, I would like to try again, if that is ok.

I have a .nc file. When I do:

>>ncdump -c <file.nc> 

I can inspect the coordinates in the x and y directions. When I do this, it shows the x vector correctly as: 487200, 487300,?625300. And it shows the y vector correctly as 4690100, 4690200,?4937600. My file is in projected (EPSG:32612) coords.

Next, I use gdal_translate to change .tif. I do this as: 

gdal_translate -of GTiff <file.nc> <file.tif>

This is my question ?> after converting to tif, I can look at the header info with gdalinfo. When I do this, I see: 

****
Corner Coordinates:
Upper Left  (  486790.000, 4937650.000) 
Lower Left  (  486790.000, 4690050.000) 
Upper Right (  624990.000, 4937650.000) 
Lower Right (  624990.000, 4690050.000) 
Center      (  555890.000, 4813850.000) 
****

The y coord of lower left is 4690050?compare that to the info above about the .nc file. I think this is ok. It is 50m different. Presumably, ncdump is reporting on the coords of grid centers and gdalinfo is reporting on boundaries (1/2 a grid cell difference), so it is 50 m less. Fine. BUT, look at the x coord of the lower left grid cell. It is 486790, compared to 487200 in the netcdf file. In other words, the x coord of the tif file is like 410 m less than the netcdf file. I am very confused about the difference in the x coordinate vector between the .nc and the .tif files. 

Is there a different way that I should be using gdal_translate to avoid this 400 m ?offset?? I can certainly override the limits with -a_ullr, and that works fine, and gives me the expected coordinate values and 100 m grid resolution, etc. However, that does not seem like the most elegant solution. 

Dave.

files here: https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing <https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing> 

---------------------------------------------------
David F. Hill
Professor
Civil and Construction Engineering
Oregon State University
220 Owen Hall
Corvallis, OR 97331
541.737.4939
david.hill at oregonstate.edu
http://www.engr.oregonstate.edu/~dfh
---------------------------------------------------



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210715/c4d647fd/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 1563 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210715/c4d647fd/attachment.bin>

From David.Hill at oregonstate.edu  Thu Jul 15 12:44:55 2021
From: David.Hill at oregonstate.edu (Hill, David Foster)
Date: Thu, 15 Jul 2021 19:44:55 +0000
Subject: [gdal-dev] gdal_translate from .nc --> .tif --- issue with
 coordinates
Message-ID: <6D2DA4A9-ABEE-450F-AA5A-7FA60C71D5A5@oregonstate.edu>

Hello. I asked this question a few weeks ago, but I think my question was not complete enough, and I also think I did not attach the right files. So, I would like to try again, if that is ok.

I have a .nc file. When I do:

>>ncdump -c <file.nc> 

I can inspect the coordinates in the x and y directions. When I do this, it shows the x vector correctly as: 487200, 487300,?625300. And it shows the y vector correctly as 4690100, 4690200,?4937600. My file is in projected (EPSG:32612) coords.

Next, I use gdal_translate to change .tif. I do this as: 

gdal_translate -of GTiff <file.nc> <file.tif>

This is my question ?> after converting to tif, I can look at the header info with gdalinfo. When I do this, I see: 

****
Corner Coordinates:
Upper Left  (  486790.000, 4937650.000) 
Lower Left  (  486790.000, 4690050.000) 
Upper Right (  624990.000, 4937650.000) 
Lower Right (  624990.000, 4690050.000) 
Center      (  555890.000, 4813850.000) 
****

The y coord of lower left is 4690050?compare that to the info above about the .nc file. I think this is ok. It is 50m different. Presumably, ncdump is reporting on the coords of grid centers and gdalinfo is reporting on boundaries (1/2 a grid cell difference), so it is 50 m less. Fine. BUT, look at the x coord of the lower left grid cell. It is 486790, compared to 487200 in the netcdf file. In other words, the x coord of the tif file is like 410 m less than the netcdf file. I am very confused about the difference in the x coordinate vector between the .nc and the .tif files. 

Is there a different way that I should be using gdal_translate to avoid this 400 m ?offset?? I can certainly override the limits with -a_ullr, and that works fine, and gives me the expected coordinate values and 100 m grid resolution, etc. However, that does not seem like the most elegant solution. 

Dave.

files here: https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing <https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing> 

---------------------------------------------------
David F. Hill
Professor
Civil and Construction Engineering
Oregon State University
220 Owen Hall
Corvallis, OR 97331
541.737.4939
david.hill at oregonstate.edu <mailto:david.hill at oregonstate.edu>
http://www.engr.oregonstate.edu/~dfh
---------------------------------------------------



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210715/92d64d35/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 1563 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210715/92d64d35/attachment-0001.bin>

From andrew at aitchison.me.uk  Fri Jul 16 08:10:30 2021
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 16 Jul 2021 16:10:30 +0100 (BST)
Subject: [gdal-dev] gdal_translate from .nc --> .tif --- issue with
 coordinates
In-Reply-To: <6D2DA4A9-ABEE-450F-AA5A-7FA60C71D5A5@oregonstate.edu>
References: <6D2DA4A9-ABEE-450F-AA5A-7FA60C71D5A5@oregonstate.edu>
Message-ID: <ece1eda9-341d-d19c-ba12-118f113a917@aitchison.me.uk>

On Thu, 15 Jul 2021, Hill, David Foster wrote:

> Hello. I asked this question a few weeks ago, but I think my
> question was not complete enough, and I also think I did not attach
> the right files. So, I would like to try again, if that is ok.

I note that your earlier message said:
> The version is: GDAL 1.11.4, released 2016/01/25

I can reproduce your results with one of your files, with GDAL v1.11.5
but not with v1.9.2, v2.4.4 or 3.3.1.

Given that v1.anything is ancient, I suggest that you move to GDAL version 3.

> I have a .nc file. When I do:
>
>>> ncdump -c <file.nc>
>
> I can inspect the coordinates in the x and y directions. When I do
> this, it shows the x vector correctly as: 487200,
> 487300,???625300. And it shows the y vector correctly as 4690100,
> 4690200,???4937600. My file is in projected (EPSG:32612) coords.
>
> Next, I use gdal_translate to change .tif. I do this as:
>
> gdal_translate -of GTiff <file.nc> <file.tif>
>
> This is my question ???> after converting to tif, I can look at the header info with gdalinfo. When I do this, I see:
>
> ****
> Corner Coordinates:
> Upper Left  (  486790.000, 4937650.000)
> Lower Left  (  486790.000, 4690050.000)
> Upper Right (  624990.000, 4937650.000)
> Lower Right (  624990.000, 4690050.000)
> Center      (  555890.000, 4813850.000)
> ****
>
> The y coord of lower left is 4690050???compare that to the info above
> about the .nc file. I think this is ok. It is 50m
> different. Presumably, ncdump is reporting on the coords of grid
> centers and gdalinfo is reporting on boundaries (1/2 a grid cell
> difference), so it is 50 m less. Fine. BUT, look at the x coord of
> the lower left grid cell. It is 486790, compared to 487200 in the
> netcdf file. In other words, the x coord of the tif file is like 410
> m less than the netcdf file. I am very confused about the difference
> in the x coordinate vector between the .nc and the .tif files.
>
> Is there a different way that I should be using gdal_translate to
> avoid this 400 m ???offset???? I can certainly override the limits with
> -a_ullr, and that works fine, and gives me the expected coordinate
> values and 100 m grid resolution, etc. However, that does not seem
> like the most elegant solution.
>
> Dave.
>
> files here: https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing
> <https://drive.google.com/drive/folders/1CclJGBj_L_Z-9hq_Xkse0ARKDdnNvKZJ?usp=sharing>


-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From maxim.rylov at sap.com  Mon Jul 19 04:38:33 2021
From: maxim.rylov at sap.com (Rylov, Maxim)
Date: Mon, 19 Jul 2021 11:38:33 +0000
Subject: [gdal-dev] HANA driver proposal
Message-ID: <AM4PR02MB3123A11FB595552D31089E84F7E19@AM4PR02MB3123.eurprd02.prod.outlook.com>

Dear GDAL/OGR Project Steering Committee,

We, the SAP HANA Spatial Team, would like to add HANA support to the GDAL library.
SAP HANA<https://www.sap.com/products/hana.html> is an in-memory database with an OGC-compliant<http://www.opengeospatial.org/resource/products/details/?pid=1303> spatial engine<https://help.sap.com/viewer/cbbbfc20871e4559abfd45a78ad58c02/2.0.04/en-US/e1c934157bd14021a3b43b5822b2cbe9.html>.
A free community edition of SAP HANA is available here<https://www.sap.com/cmp/td/sap-hana-express-edition.html>.

GDAL/OGR supports a great variety of data formats and databases like PostgreSQL, MySQL,
MS SQL, Oracle, IBM DB2 etc. Therefore, the proposed HANA driver would complement
the list of currently supported databases.

The implementation of the new vector driver for HANA including tests and its integration
into the CI would be done by our team of course with some guidance from the GDAL community.
The driver's footprint in the code should be minimal, as the whole implementation will reside in
the subfolder https://github.com/OSGeo/gdal/tree/master/gdal/ogr/ogrsf_frmts/hana.

Our team already gathered some experience of working with open source communities.
A few months ago, we introduced support of HANA in QGIS<https://github.com/qgis/QGIS/pull/34988> and now we continue maintaining our
contribution<https://github.com/qgis/QGIS/pulls?q=is%3Apr+is%3Aclosed+HANA>. We keep tracking of new issues/bugs, CI runs, API changes, documentation improvements
related to HANA and make sure that they are fixed/implemented as soon as possible. We hope that this
information will minimize your concerns about the future maintenance of the driver.
Kind regards,
Maxim Rylov on behalf of the HANA Spatial Team

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210719/1a7654e2/attachment.html>

From even.rouault at spatialys.com  Mon Jul 19 12:26:50 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Jul 2021 21:26:50 +0200
Subject: [gdal-dev] HANA driver proposal
In-Reply-To: <AM4PR02MB3123A11FB595552D31089E84F7E19@AM4PR02MB3123.eurprd02.prod.outlook.com>
References: <AM4PR02MB3123A11FB595552D31089E84F7E19@AM4PR02MB3123.eurprd02.prod.outlook.com>
Message-ID: <b44320cb-6af8-fd1f-f220-22547d5ff071@spatialys.com>

Maxim,

thanks for the introduction.

I assume the driver would depend on the ODBC library, and would require 
users to build https://github.com/SAP/odbc-cpp-wrapper as the 
corresponding ODBC driver ?

As GDAL is an almost always growing beast, we need to be careful about 
what we accept in the upstream repository, and consider policies about 
how to retire things that are no longer useful, adequately maintained or 
becoming a nuisance for the overall project. I had quite a hard time a 
few months ago to do some spring cleanup (see the "Consider driver 
removal" thread in 
https://lists.osgeo.org/pipermail/gdal-dev/2021-January/date.html), and 
it would probably good to have a formal RFC covering the whole 
life-cycle of a driver, and not just how to get new code added.

Below a non-exhaustive lists of points that should be covered IMHO. A 
number of them are open questions where input from the community is welcome.

- criteria for acceptance:

 ??? * (obvious) source code contributed to the repository should follow 
its licensing terms

 ??? * is the driver of sufficient general interest ? For example, we'd 
likely don't want to accept drivers for a in-house file format of a 
company/organization that isn't distributed outside it.

 ??? * who will review the code ? That can be really problematic. I've 
just merged today the Zarr driver but nobody was available to review it 
unfortunately. When we will be able to use the sponsorship through 
NumFOCUS, we'll hopefully be in a better shape to have more reviewers, 
but I'm not sure we'd want to spend the sponsorship to review code for 
proprietary services. That should likely be the responsibility for the 
proprietary service to find an interested reviewer.

 ???? * should we require CI tests ? Some tests, especially ones relying 
on external services, can be flaky.

- each (at least, new) driver should have at least one name in front of 
it in the list in 
https://github.com/OSGeo/gdal/wiki/Maintainers-per-sub-system . What 
should we expect from the maintainer: monitoring of the mailing list and 
issue tracker (at least bi weekly ?), some form of handling of it 
(making sure the issue is well described, and some time frame to address 
it when relevant), reviewing pull requests in their "area of 
responsibility" (... and outside it. For example, I see a number of QGIS 
developers having reviewed your pull requests, but did you help 
reviewing their pull requests. I don't mean to pinpoint on anybody in 
particular, as it is a general pattern in most GDAL driver contributions 
too), participation to general / cross-driver maintenance tasks, ...

- if someone refactors GDAL internals, who is responsible for adjusting 
the various drivers to build and work properly ? Open question honestly, 
and from my experience, this is a really problematic one. I'd expect 
someone who wants to change some internal API (or enable a new class of 
compiler warnings, or use a new code analyzer, etc etc) to have perhaps 
interest and knowledge in 3 or 5 drivers and be willing to do the 
changes in them, but besides that, adjusting all the other drivers is a 
real burden (remainder: GDAL has > 250 drivers) and discourage such 
efforts. But even if we assumed that each driver would have a maintainer 
(the reality is more like 10% of the drivers have a maintainer), 
coordinating with 200 maintainers to gather patches from each of them 
have a working build isn't something that is going to work well.

- how can we get a sense of what is really used in GDAL ? Nobody really 
knows which parts of GDAL are used nowadays, except when we get bug 
reports or questions on them. Should we add some (opt-in) telemetry 
(that could potentially be enabled through GUI applications like QGIS) ?

- how do we decide if some code should be removed ?

 ??? * There are different situations according if the driver is for a 
file format (files can stay forever, and GDAL is in a number of cases 
the only opensource way of accessing them. But conversely older GDAL 
releases are there forever too, with some effort to build them), a 
database or a web-accessible service. And according to their nature: 
FOSS vs proprietary.

 ? ? * Code for which there's no longer any declared maintainer or it 
has been found unresponsive (how do we declare that a maintainer is 
unresponsive?)

 ??? * Code for which there are too many tickets unaddressed or is known 
(or assumed) to be broken ?

- how do we actually retire code ? A PSC mention outlining the reasons 
(among ones mentioned above) ? I like the experiment I did with the 
runtime deprecation of a few drivers (the 
GDALIsDriverDeprecatedForGDAL35StillEnabled() thing) to get some 
feedback when we're unsure about the real value of a driver before 
completely wiping it off (we recently get a ticket asking re-enabling of 
one of the drivers that was marked fro removal in 3.5), and perhaps this 
could be the norm when driver removal is considered

- I haven't looked at the procedures of the Linux kernel, but perhaps 
there's some interesting inspiration to be taken from there (at least 
for comparison)

Anyone wants to take the lead on such RFC ?

Even

Le 19/07/2021 ? 13:38, Rylov, Maxim via gdal-dev a ?crit?:
>
> Dear GDAL/OGR Project Steering Committee,
>
> We, the SAP HANA Spatial Team, would like to add HANA support to the 
> GDAL library.
> SAP HANA <https://www.sap.com/products/hana.html>?is an in-memory 
> database with an OGC-compliant 
> <http://www.opengeospatial.org/resource/products/details/?pid=1303>spatial 
> engine 
> <https://help.sap.com/viewer/cbbbfc20871e4559abfd45a78ad58c02/2.0.04/en-US/e1c934157bd14021a3b43b5822b2cbe9.html>.
> A free community edition of SAP HANA is available here 
> <https://www.sap.com/cmp/td/sap-hana-express-edition.html>.
>
> GDAL/OGR supports a great variety of data formats and databases like 
> PostgreSQL, MySQL,
> MS SQL, Oracle, IBM DB2 etc. Therefore, the proposed HANA driver would 
> complement
> the list of currently supported databases.
>
> The implementation of the new vector driver for HANA including tests 
> and its integration
> into the CI would be done by our team of course with some guidance 
> from the GDAL community.
> The driver?s footprint in the code should be minimal, as the whole 
> implementation will reside in
> the subfolder 
> https://github.com/OSGeo/gdal/tree/master/gdal/ogr/ogrsf_frmts/hana 
> <https://github.com/OSGeo/gdal/tree/master/gdal/ogr/ogrsf_frmts/hana>.
>
> Our team already gathered some experience of working with open source 
> communities.
> A few months ago, we introduced support of HANA in QGIS 
> <https://github.com/qgis/QGIS/pull/34988>and now we continue 
> maintaining our
> contribution 
> <https://github.com/qgis/QGIS/pulls?q=is%3Apr+is%3Aclosed+HANA>. We 
> keep tracking of new issues/bugs, CI runs, API changes, documentation 
> improvements
> related to HANA and make sure that they are fixed/implemented as soon 
> as possible. We hope that this
> information will minimize your concerns about the future maintenance 
> of the driver.
>
> Kind regards,
> Maxim Rylov on behalf of the HANA Spatial Team
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210719/6251ac46/attachment.html>

From even.rouault at spatialys.com  Mon Jul 19 19:47:11 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 20 Jul 2021 04:47:11 +0200
Subject: [gdal-dev] zarr driver PR
In-Reply-To: <2bf7d918-9d83-c3f2-cfdd-07da12721217@spatialys.com>
References: <CAOodmJo_sJs0o5OPi=N2MfwtDkRzjAtUvwW+BZa7HnH9xSUWZA@mail.gmail.com>
 <2bf7d918-9d83-c3f2-cfdd-07da12721217@spatialys.com>
Message-ID: <34d3cd45-6fca-f1e7-07ee-7882e664972a@spatialys.com>

FYI, the driver has now been merged into GDAL master and Docker images 
have been regenerated (use the ubuntu-full or alpine-normal ones to get 
support for all compression codecs supported by the driver)

Le 01/07/2021 ? 21:05, Even Rouault a ?crit?:
>
> Hi all,
>
> for those who have monitored the PR tracker lately, you may have 
> noticed that I've been working in 
> https://github.com/OSGeo/gdal/pull/3896 for an implementation of a 
> Zarr driver. This is now feature complete and in a CI ready state. It 
> follows a different approach than the one proposed in PR #3411 for the 
> reasons I underlined in 
> https://github.com/OSGeo/gdal/pull/3411#issuecomment-831259626
>
> I've also filled the RFC template in 
> https://github.com/OSGeo/gdal/pull/3896#issuecomment-872398856
>
> Even
>
>
> Le 01/02/2021 ? 16:45, Sean Gillies a ?crit?:
>> Hi all,
>>
>> Also deep in our recent long thread about removing drivers from GDAL 
>> is mention of a new PR for a "zarr" driver.
>>
>> https://github.com/OSGeo/gdal/pull/3411 
>> <https://github.com/OSGeo/gdal/pull/3411>
>>
>> I'd like to see more discussion of the scope of this work and plans 
>> for future development and support before a zarr driver is added to GDAL.
>>
>> Is the zarr driver not going to support version 2 of the zarr spec? I 
>> that v2 would be difficult to implement as a GDAL driver as it is 
>> extremely flexible and extensible. For example, I've written custom 
>> compressor and storage for use in a project at work and can't imagine 
>> how a driver written in C++ would understand it.
>>
>> Is the zarr driver based on 
>> https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html 
>> <https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html>? 
>> That work seems not yet finished. Is it premature to add a driver to 
>> GDAL for a format that isn't yet specified and may yet be changed? Or 
>> should we expect only minor changes at this point?
>>
>> -- 
>> Sean Gillies
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210720/4f726d31/attachment-0001.html>

From loridigia at gmail.com  Wed Jul 21 06:25:39 2021
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Wed, 21 Jul 2021 15:25:39 +0200
Subject: [gdal-dev] GDAL translate to NetCDF with aux
Message-ID: <CAERmyNSKu0X6uWxV7R5=PVEEMhRyT_Z9e=PSzWX3_6rhavnH+Q@mail.gmail.com>

Hi, i have a .TIFF file and a .AUX.XML file.
I'd like to create a NetCDF from .TIFF and .AUX.XML, is possible merge them
in a NetCDF?
The .AUX.XML come from the gdaltranslate operation NetCDF -> TIFF (since
the metadata are bigger than 32000 bytes).

To summarize the flow is:
NetCDF > TIFF + aux -> NetCDF

Thanks for your help!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210721/c8dde65d/attachment.html>

From chander.ganesan at gmail.com  Fri Jul 23 05:15:07 2021
From: chander.ganesan at gmail.com (Chander Ganesan)
Date: Fri, 23 Jul 2021 08:15:07 -0400
Subject: [gdal-dev] Alpine Linux GDAL Issues
Message-ID: <CAHRqD9xuGE35HzeyLU15J0uOvhoha3Nq7_F8mUFNut3ZfnSC=g@mail.gmail.com>

Hello,

I've been having some weird issues with GDAL and Alpine linux recently, and
hope ya'll can help me resolve it.

The example below illustrates the issue in a reproducible manner -
basically, a simple call to Transform results in a wierd error coming back
from SWIG/OGR.

As a side (but perhaps unrelated note) I also find some weird issues with
OGR (python) reading shapefiles - it sometimes gets the wrong projection
info (even though OGRinfo returns the correct data):


$ docker pull alpine:3.14
$ docker run -it alpine:3.14 ash
/ # apk update; apk add py3-gdal python3
/ #

*python3 -c "from osgeo import ogr, osr; epsg4326=osr.SpatialReference();
epsg3857=osr.SpatialReference(); epsg4326.ImportFromEPSG(4326);
epsg3857.ImportFromEPSG(3857);
c=ogr.CreateGeometryFromWkt('POLYGON((-161.9696 10.6918,-161.9696
60.6943,145.719 60.6943,145.719 10.6918,-161.9696 10.6918))');
c.Transform(epsg4326,epsg3857)"*
*g3857.ImportFromEPSG(3857);
c=ogr.CreateGeometryFromWkt('POLYGON((-161.9696 10.6918,-161.9696
60.6943,145.719 60.6943,145.719 10.6918,-161.9696 *
*10.6918))'); c.Transform(epsg4326,epsg3857)"*
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/usr/lib/python3.9/site-packages/osgeo/ogr.py", line 7796, in
Transform
    return _ogr.Geometry_Transform(self, *args)
NotImplementedError: Wrong number or type of arguments for overloaded
function 'Geometry_Transform'.

  Possible C/C++ prototypes are:
    OGRGeometryShadow::Transform(OSRCoordinateTransformationShadow *)



Thanks!

Chander
    OGRGeometryShadow::Transform(OGRGeomTransformerShadow *)

/ #
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210723/885f445d/attachment.html>

From maxim.rylov at sap.com  Mon Jul 26 08:54:29 2021
From: maxim.rylov at sap.com (Rylov, Maxim)
Date: Mon, 26 Jul 2021 15:54:29 +0000
Subject: [gdal-dev] HANA driver proposal
In-Reply-To: <b44320cb-6af8-fd1f-f220-22547d5ff071@spatialys.com>
References: <AM4PR02MB3123A11FB595552D31089E84F7E19@AM4PR02MB3123.eurprd02.prod.outlook.com>
 <b44320cb-6af8-fd1f-f220-22547d5ff071@spatialys.com>
Message-ID: <AM4PR02MB3123930CA96402ACE6F9CB6FF7E89@AM4PR02MB3123.eurprd02.prod.outlook.com>

Hi Even,

Thank you for your prompt reply.

> ?I assume the driver would depend on the ODBC library, and would require users to build https://github.com/SAP/odbc-cpp-wrapper as the corresponding ODBC driver ??

The odbc-cpp-wrapper library is going to be used only during the compilation phase and linked statically, thus end users will get only one dynamic/shared library of the HANA driver.  Hence, no additional actions are required from end users. For those who want to compile the GDAL sources with HANA support on their own, the sources of the odbc-cpp-wrapper are needed. However, this step can be omitted if we store a copy of the library in https://github.com/OSGeo/gdal/tree/master/gdal/third_party like we did in QGIS (see https://github.com/qgis/QGIS/tree/master/external/odbccpp).

Note, that any HANA plugin (GDAL/QGIS) also requires the SAP HANA Client (https://tools.hana.ondemand.com/#hanatools) to be able to connect an SAP HANA database.

> ?Below a non-exhaustive lists of points that should be covered IMHO. A number of them are open questions where input from the community is welcome.
- criteria for acceptance:
    * (obvious) source code contributed to the repository should follow its licensing terms?

The license will be X/MIT.

>   ?* is the driver of sufficient general interest ? For example, we'd likely don't want to accept drivers for a in-house file format of a company/organization that isn't distributed outside it.?

This is not the case for the HANA driver.
>  ?* should we require CI tests ? Some tests, especially ones relying on external services, can be flaky.?

We can consider adding CI tests either using a HANA instance in the cloud or in a docker container.

> ?- each (at least, new) driver should have at least one name in front of it in the list in https://github.com/OSGeo/gdal/wiki/Maintainers-per-sub-system . What should we expect from the maintainer: monitoring of the mailing list and issue tracker (at least bi weekly ?), some form of handling of it (making sure the issue is well described, and some time frame to address it when relevant), reviewing pull requests in their "area of responsibility" (... and outside it. For example, I see a number of QGIS developers having reviewed your pull requests, but did you help reviewing their pull requests. I don't mean to pinpoint on anybody in particular, as it is a general pattern in most GDAL driver contributions too), participation to general / cross-driver maintenance tasks, ...?
There will be a contact person at SAP responsible for the maintenance.

> ?- if someone refactors GDAL internals, who is responsible for adjusting the various drivers to build and work properly ? Open question honestly, and from my experience, this ???????.?

?Unfortunately, we are not able to answer the remaining raised points as they are beyond our expertise.
Perhaps they should be addressed in a separate dedicated discussion.

Kind regards,
Maxim Rylov on behalf of the HANA Spatial Team
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210726/de7e3385/attachment.html>

From MStefarov at esri.com  Wed Jul 28 00:28:28 2021
From: MStefarov at esri.com (Matvei Stefarov)
Date: Wed, 28 Jul 2021 07:28:28 +0000
Subject: [gdal-dev] Are ogr_geojson/libjson vulnerable to json-c CVEs?
Message-ID: <BYAPR05MB4054014E62EAE2152865765CDBEA9@BYAPR05MB4054.namprd05.prod.outlook.com>

Hello!  I am new to the list, I hope that this is the right place to ask.

GDAL's geojson driver uses libjson, which is a fork of json-c 0.11.  There have been a couple security vulnerabilities patched in json-c since version 0.11.  These vulnerabilities are:

- CVE-2013-6370 (buffer overflow if size_t is larger than int)
- CVE-2013-6371 (hash collision denial of service)
- CVE-2020-12762 (integer overflow and out-of-bounds write via a large JSON file)

The first two were patched in 0.12 by https://github.com/json-c/json-c/commit/64e36901a0614bf64a19bc3396469c66dcd0b015, and the last was patched by https://github.com/json-c/json-c/commit/31243e4d1204ef78be34b0fcae73221eee6b83be. I don't see similar changes applied to GDAL's fork of libjson, so it might still be vulnerable.

I discovered this potential problem because my GDAL-based software was flagged as vulnerable by static analysis tools (https://www.synopsys.com/software-integrity/security-testing/software-composition-analysis.html).  This tool works likely detected the presence of json_c_version/json_c_version_num functions, which currently return 0.11.

So my questions are:
- Does GDAL appear to be vulnerable to these CVEs out-of-the-box?
- Would it be practical to build GDAL against a newer version of json-c instead of the bundled libjson -- or are there significant modifications in the fork?

Cheers,
Matvei Stefarov


From even.rouault at spatialys.com  Wed Jul 28 07:48:15 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jul 2021 16:48:15 +0200
Subject: [gdal-dev] Are ogr_geojson/libjson vulnerable to json-c CVEs?
In-Reply-To: <BYAPR05MB4054014E62EAE2152865765CDBEA9@BYAPR05MB4054.namprd05.prod.outlook.com>
References: <BYAPR05MB4054014E62EAE2152865765CDBEA9@BYAPR05MB4054.namprd05.prod.outlook.com>
Message-ID: <27de505e-0e18-f022-e0d3-a227ddaec697@spatialys.com>

Matvei,

Hard to say if the use of json-c 0.11 by GDAL trigger those 
vulnerabilities, but you should assume they might be hit. I've filed 
https://github.com/OSGeo/gdal/issues/4143 about that.

But you should be able to build GDAL any external recent json-c. The 
internal copy has mostly changes to please our compiler warning changes, 
nothing significant.

Even

Le 28/07/2021 ? 09:28, Matvei Stefarov via gdal-dev a ?crit?:
> Hello!  I am new to the list, I hope that this is the right place to ask.
>
> GDAL's geojson driver uses libjson, which is a fork of json-c 0.11.  There have been a couple security vulnerabilities patched in json-c since version 0.11.  These vulnerabilities are:
>
> - CVE-2013-6370 (buffer overflow if size_t is larger than int)
> - CVE-2013-6371 (hash collision denial of service)
> - CVE-2020-12762 (integer overflow and out-of-bounds write via a large JSON file)
>
> The first two were patched in 0.12 by https://github.com/json-c/json-c/commit/64e36901a0614bf64a19bc3396469c66dcd0b015, and the last was patched by https://github.com/json-c/json-c/commit/31243e4d1204ef78be34b0fcae73221eee6b83be. I don't see similar changes applied to GDAL's fork of libjson, so it might still be vulnerable.
>
> I discovered this potential problem because my GDAL-based software was flagged as vulnerable by static analysis tools (https://www.synopsys.com/software-integrity/security-testing/software-composition-analysis.html).  This tool works likely detected the presence of json_c_version/json_c_version_num functions, which currently return 0.11.
>
> So my questions are:
> - Does GDAL appear to be vulnerable to these CVEs out-of-the-box?
> - Would it be practical to build GDAL against a newer version of json-c instead of the bundled libjson -- or are there significant modifications in the fork?
>
> Cheers,
> Matvei Stefarov
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From louis-philippe.rousseaulambert at ec.gc.ca  Wed Jul 28 08:08:19 2021
From: louis-philippe.rousseaulambert at ec.gc.ca (Rousseau Lambert,Louis-Philippe (ECCC))
Date: Wed, 28 Jul 2021 11:08:19 -0400
Subject: [gdal-dev] GDAL fails to read projection with: Unsupported
 conversion method: Polar_Stereographic
Message-ID: <375311e7-0d5e-44b4-5c3d-e982d5226753@ec.gc.ca>

Hi,

I'm trying to read a projection in proj4 string from a NetCDF and gdal / 
proj fails to recognize the /*conversion method: Polar_Stereographic*/.

The issue appears with any files in: 
https://dd.weather.gc.ca/model_riops/netcdf/forecast/polar_stereographic/2d/06/003/

example gdalinfo request:

/$ gdalinfo -proj4 input.nc//
//Driver: netCDF/Network Common Data Format//
//...//
//*ERROR 1: PROJ: proj_as_proj_string: Unsupported conversion method: 
Polar_Stereographic*//*
*//*PROJ.4 string is:*//*
*//*''*//
//Origin = (-2500.000000000000000,8047500.000000000000000)//
//Pixel Size = (5000.000000000000000,-5000.000000000000000)//
//...//
//? SRS=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]//
//? X_BAND=1//
//? X_DATASET=NETCDF:"dd_riops.nc":longitude//
//? Y_BAND=1//
//? Y_DATASET=NETCDF:"dd_riops.nc":latitude//
//Corner Coordinates://
//Upper Left? (?? -2500.000, 8047500.000)//
//Lower Left? (?? -2500.000,?? -2500.000)//
//Upper Right ( 8847500.000, 8047500.000)//
//Lower Right ( 8847500.000,?? -2500.000)//
//Center????? ( 4422500.000, 4022500.000)//
//.../

The gdal version I'm getting the error with: GDAL 3.1.3, and PROJ 
version: Rel. 7.2.0.

I know this command previsously worked fine, using gdal GDAL 2.4.4 and 
proj Rel. 4.8.0 and I was able to get the PROJ4 string: '+proj=stere 
+lat_0=90 +lat_ts=59.99993768695209 +lon_0=-100 +k=0.93301243 
+x_0=4245000 +y_0=5295000 +a=6371229 +b=6371229 +units=m +no_defs '

Also, if I try to reproject the file in EPSG:4326 with a gdalwarp (GDAL 
3.1.3) command, it fails, because it does not read the source srs, but 
if I specify it using the -s_srs flag it works fine, example:

|gdalwarp -of NetCDF -s_srs "+proj=stere +lat_0=90 
+lat_ts=59.99993768695209 +lon_0=-100 +x_0=4245000 +y_0=5295000 
+R=6371229 +units=m +no_defs" -t_srs EPSG:4326 input.nc output.nc|

Is this a bug in gdal / proj, or a parameter in the projection 
definition that is not supported anymore ?

Thanks

LP
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/1b39aeba/attachment.html>

From even.rouault at spatialys.com  Wed Jul 28 08:18:15 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jul 2021 17:18:15 +0200
Subject: [gdal-dev] GDAL fails to read projection with: Unsupported
 conversion method: Polar_Stereographic
In-Reply-To: <375311e7-0d5e-44b4-5c3d-e982d5226753@ec.gc.ca>
References: <375311e7-0d5e-44b4-5c3d-e982d5226753@ec.gc.ca>
Message-ID: <1018f005-1723-f60a-9db1-d4547299375c@spatialys.com>

Louis-Phillippe,

this sounds like a bug. Please file a ticket at 
https://github.com/OSGeo/gdal/issues/new with all the below details

Even

Le 28/07/2021 ? 17:08, Rousseau Lambert,Louis-Philippe (ECCC) a ?crit?:
>
> Hi,
>
> I'm trying to read a projection in proj4 string from a NetCDF and gdal 
> / proj fails to recognize the /*conversion method: Polar_Stereographic*/.
>
> The issue appears with any files in: 
> https://dd.weather.gc.ca/model_riops/netcdf/forecast/polar_stereographic/2d/06/003/
>
> example gdalinfo request:
>
> /$ gdalinfo -proj4 input.nc//
> //Driver: netCDF/Network Common Data Format//
> //...//
> //*ERROR 1: PROJ: proj_as_proj_string: Unsupported conversion method: 
> Polar_Stereographic*//*
> *//*PROJ.4 string is:*//*
> *//*''*//
> //Origin = (-2500.000000000000000,8047500.000000000000000)//
> //Pixel Size = (5000.000000000000000,-5000.000000000000000)//
> //...//
> //? SRS=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]//
> //? X_BAND=1//
> //? X_DATASET=NETCDF:"dd_riops.nc":longitude//
> //? Y_BAND=1//
> //? Y_DATASET=NETCDF:"dd_riops.nc":latitude//
> //Corner Coordinates://
> //Upper Left? (?? -2500.000, 8047500.000)//
> //Lower Left? (?? -2500.000,?? -2500.000)//
> //Upper Right ( 8847500.000, 8047500.000)//
> //Lower Right ( 8847500.000,?? -2500.000)//
> //Center????? ( 4422500.000, 4022500.000)//
> //.../
>
> The gdal version I'm getting the error with: GDAL 3.1.3, and PROJ 
> version: Rel. 7.2.0.
>
> I know this command previsously worked fine, using gdal GDAL 2.4.4 and 
> proj Rel. 4.8.0 and I was able to get the PROJ4 string: '+proj=stere 
> +lat_0=90 +lat_ts=59.99993768695209 +lon_0=-100 +k=0.93301243 
> +x_0=4245000 +y_0=5295000 +a=6371229 +b=6371229 +units=m +no_defs '
>
> Also, if I try to reproject the file in EPSG:4326 with a gdalwarp 
> (GDAL 3.1.3) command, it fails, because it does not read the source 
> srs, but if I specify it using the -s_srs flag it works fine, example:
>
> |gdalwarp -of NetCDF -s_srs "+proj=stere +lat_0=90 
> +lat_ts=59.99993768695209 +lon_0=-100 +x_0=4245000 +y_0=5295000 
> +R=6371229 +units=m +no_defs" -t_srs EPSG:4326 input.nc output.nc|
>
> Is this a bug in gdal / proj, or a parameter in the projection 
> definition that is not supported anymore ?
>
> Thanks
>
> LP
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/438e1ca4/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jul 28 10:37:44 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jul 2021 19:37:44 +0200
Subject: [gdal-dev] How to deal with security related bug reports?
Message-ID: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>

PSC,

We just got https://github.com/OSGeo/gdal/issues/4146 from someone 
trying to get in touch with a security issue. How do we want to deal 
with that ? Personally dealing with all the secrecy about security 
issues is not super appealing and my natural inclination would be to 
deal with them as any other issue.

An alternative, used by Mapserver, would be to setup a dedicated private 
github repository, where we would invite only users (but they are likely 
able to see all issues, not just theirs). Or perhaps just make a 
repository accessible to PSC / trusted developers, interact with the 
reporter through email (who wants to be in the email loop?) and paste 
there the report and updates, but that becomes cumbersome.

Another point, assuming we have a private issue tracker, is, assuming 
the issue is confirmed and we have a fix for it, how do we deal with it 
? My inclination would be to just commit the fix (the issue would become 
more or less public once a candidate pull request is issued) and not 
issue a dedicated release, but use our regular bugfix releases.

Thoughts ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From simon.eves at omnisci.com  Wed Jul 28 12:22:12 2021
From: simon.eves at omnisci.com (Simon Eves)
Date: Wed, 28 Jul 2021 12:22:12 -0700
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
Message-ID: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>

Dear All,

I am aware that some improvements were made in the 2.3 timeframe with
regards to dealing with large GeoJSON files, although even in 3.2, it's
still very slow and memory hungry.

Our system allows for aborting imports, but this only works reliably once
it has actually got to the stage of reading features from the file. With
the GeoJSON, it just sits in the GDALOpenEx call for ages.

My question, therefore, is whether it might be practical to run the
GDALOpenEx in a separate thread with a future to return the resulting
handle, such that it could be monitored and killed if necessary?

Mainly I would be concerned that killing the thread might trash some global
GDAL state that might then not be recoverable, or that the open relies on
some TLS for the process thread and therefore might not work properly.

We're going to try it anyway, but opinions welcomed, thanks!

Simon

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/049f0869/attachment.html>

From even.rouault at spatialys.com  Wed Jul 28 12:28:36 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jul 2021 21:28:36 +0200
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>
References: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>
Message-ID: <b3a63d9c-54d3-c65c-a87e-ce0874e705e5@spatialys.com>

Simon,

I don't think that killing a thread is a safe practice in general. It 
would likely result in memory leaks and maybe in some other inconsistent 
state that could crash the whole process.? An interesting enhancement 
for such cases would be to be able to provide a progress / abort callback.

Even

Le 28/07/2021 ? 21:22, Simon Eves a ?crit?:
> Dear All,
>
> I am aware that some improvements were made in the 2.3 timeframe with 
> regards to dealing with large GeoJSON files, although even in 3.2, 
> it's still very slow and memory hungry.
>
> Our system allows for aborting imports, but this only works reliably 
> once it has actually got to the stage of reading features from the 
> file. With the GeoJSON, it just sits in the GDALOpenEx call for ages.
>
> My question, therefore, is whether it might be practical to run the 
> GDALOpenEx in a separate thread with a future to return the resulting 
> handle, such that it could be monitored and killed if necessary?
>
> Mainly I would be concerned that killing the thread might trash some 
> global GDAL state that might then not be recoverable, or that the open 
> relies on some TLS for the process thread and therefore might not work 
> properly.
>
> We're going to try it anyway, but opinions welcomed, thanks!
>
> Simon
>
> -- 
> <http://www.omnisci.com/>
> 	
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>
>
> 	
> Email: simon.eves at omnisci.com <mailto:simon.eves at omnisci.com>?| Cell: 
> +1 (415) 902-1996
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/b7a90833/attachment.html>

From schwehr at gmail.com  Wed Jul 28 12:36:09 2021
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 28 Jul 2021 12:36:09 -0700
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
Message-ID: <CACmBxyszXNn2c47DbJ=oMbezCo6H3BjGRw8rzOiFWpjc=GK1Gw@mail.gmail.com>

My take is pretty much the same as Even's.  I suggest that we add a
SECURITY.md that says we do not currently treat security bugs in gdal
privately and that we don't generally do specific releases for security
issues.   I thought there used to be a statement somewhere in the files
that said that the code should not be considered secure / safe.  I think we
should bring something like that back that says something along the lines
of:

Some effort is made to ensure the code is safe, but analysis tools like
ossfuzz continually find issues in the code.  Data from untrusted sources
should be treated with caution.  When security is a major concern, consider
running GDAL or code using GDAL in a restricted sandbox environment.   If
someone wants to specifically fund a security effort, then we can consider
doing something more.


I'm one of those running gdal in a space where security is a huge issue.
We (Google) have GDAL running in a very restricted sandbox for any
untrusted data.

But, I'd definitely like to hear people with opposing views.

-kurt

On Wed, Jul 28, 2021 at 10:38 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> PSC,
>
> We just got https://github.com/OSGeo/gdal/issues/4146 from someone
> trying to get in touch with a security issue. How do we want to deal
> with that ? Personally dealing with all the secrecy about security
> issues is not super appealing and my natural inclination would be to
> deal with them as any other issue.
>
> An alternative, used by Mapserver, would be to setup a dedicated private
> github repository, where we would invite only users (but they are likely
> able to see all issues, not just theirs). Or perhaps just make a
> repository accessible to PSC / trusted developers, interact with the
> reporter through email (who wants to be in the email loop?) and paste
> there the report and updates, but that becomes cumbersome.
>
> Another point, assuming we have a private issue tracker, is, assuming
> the issue is confirmed and we have a fix for it, how do we deal with it
> ? My inclination would be to just commit the fix (the issue would become
> more or less public once a candidate pull request is issued) and not
> issue a dedicated release, but use our regular bugfix releases.
>
> Thoughts ?
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/5df76ae8/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Wed Jul 28 14:58:06 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 28 Jul 2021 21:58:06 +0000
Subject: [gdal-dev] Making use of SPOT imagery mask files
Message-ID: <7900a3e2908641779083c41c1b314440@yukon.ca>

I'm working with SPOT 6 and 7 imagery delivered in DIMAP format. I've figured out how to extract the multispectral and pan-chromatic bands into geotiff with gdal-translate so they're easier to work with.

((cross posted to https://gis.stackexchange.com/questions/405077/making-use-of-spot-imagery-mask-files))

In each archive there are a series of mask files in gml<https://gis.stackexchange.com/questions/tagged/gml> format, which I can read with ogrinfo and Qgis. However the mask files don't have a coordinate system so I can't use them with the images.

>From the ogrinfo report it appears the GML are using image row and column pixel dimensions. (The matching source image is 9652 x 57083.)

$ ogrinfo \SPOT6_sample_roi.gml maskfeature

INFO: Open of `\SPOT6_sample_roi.gml'

      using driver `GML' successful.

Metadata:

  NAME=Area of interest mask for product id SPOT6_MS_201308032015087_SEN_SPOT6_20160316_1601281mdxzlrvssw12_1



Layer name: MaskFeature

Geometry: Polygon

Feature Count: 1

Extent: (1.000000, 1.000000) - (9653.000000, 57084.000000)

Layer SRS WKT:

(unknown)

gml_id: String (0.0) NOT NULL

maskType: String (18.0)

OGRFeature(MaskFeature):0

  gml_id (String) = REGION_OF_INTEREST-0

  maskType (String) = REGION_OF_INTEREST

  POLYGON ((9645.1767578125 6.41328716278076,9645.162109375 5.32240867614746,9645.03125 4.30024194717407,9644.7841796875 3.2741334438324,9644.5390625 2.39344930648804,9644.181640625 1.72693908214569,9643.7666015625 1.20388793945312,9643.4931640625 1.0,8939.99609375 1.0,1.0 4.3671669960022,1.0 28542.5,1 57084,9653 57084,9653.0 45960.265625,9645.1767578125 6.41328716278076))

The gdalinfo report for the source image<https://gist.github.com/maphew/513404f56b956ef3f1379b70d1d5d87f> also shows pixel coordinates for the coordinate system:

Corner Coordinates:

Upper Left  (    0.0,    0.0)

Lower Left  (    0.0,57083.0)

Upper Right ( 9652.0,    0.0)

Lower Right ( 9652.0,57083.0)

Center      ( 4826.0,28541.5)

However it also has RPC metadata that seems to be enough to have Qgis and ArcMap/Pro display it in the right geographical location:

RPC Metadata:

  HEIGHT_OFF=500.0

  HEIGHT_SCALE=500.0

  LAT_OFF=64.90742355

  LAT_SCALE=1.71583845

  ...snip...

  SAMP_OFF=4825

  SAMP_SCALE=4826.0

Sample files at https://drive.google.com/drive/folders/119QEECJ42FKt0A9mq55rRmGsT9-5nSZq?usp=sharing (The image has been resized to 10% of it's original size.)

How might I marry the raster coordinate system info to the mask files so I can use them together?
Thanks in advance for your time and thoughts,

Matt Wilkie
A / Manager
(Geomatics Developer & Administrator)
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/54a11056/attachment.html>

From warmerdam at pobox.com  Wed Jul 28 15:21:44 2021
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 28 Jul 2021 18:21:44 -0400
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <CACmBxyszXNn2c47DbJ=oMbezCo6H3BjGRw8rzOiFWpjc=GK1Gw@mail.gmail.com>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
 <CACmBxyszXNn2c47DbJ=oMbezCo6H3BjGRw8rzOiFWpjc=GK1Gw@mail.gmail.com>
Message-ID: <CA+YzLBe82Ktmbte742uF4w=xMQ+9THud4AQSTtLOytYHJdkZhA@mail.gmail.com>

Even,

I agree with you and Kurt that we should try to avoid the overhead of
special security handling.  MapServer is intended to be web facing.  GDAL
is not.  That said, we should attempt to resolve security issues in the
normal course of bug fixing and releases.  If there is a strong case for a
different approach, hopefully it will be made by folks willing to pay for
the extra work (through sponsorship or other contributions).

Best regards,
Frank


On Wed, Jul 28, 2021 at 3:36 PM Kurt Schwehr <schwehr at gmail.com> wrote:

> My take is pretty much the same as Even's.  I suggest that we add a
> SECURITY.md that says we do not currently treat security bugs in gdal
> privately and that we don't generally do specific releases for security
> issues.   I thought there used to be a statement somewhere in the files
> that said that the code should not be considered secure / safe.  I think we
> should bring something like that back that says something along the lines
> of:
>
> Some effort is made to ensure the code is safe, but analysis tools like
> ossfuzz continually find issues in the code.  Data from untrusted sources
> should be treated with caution.  When security is a major concern, consider
> running GDAL or code using GDAL in a restricted sandbox environment.   If
> someone wants to specifically fund a security effort, then we can consider
> doing something more.
>
>
> I'm one of those running gdal in a space where security is a huge issue.
> We (Google) have GDAL running in a very restricted sandbox for any
> untrusted data.
>
> But, I'd definitely like to hear people with opposing views.
>
> -kurt
>
> On Wed, Jul 28, 2021 at 10:38 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> PSC,
>>
>> We just got https://github.com/OSGeo/gdal/issues/4146 from someone
>> trying to get in touch with a security issue. How do we want to deal
>> with that ? Personally dealing with all the secrecy about security
>> issues is not super appealing and my natural inclination would be to
>> deal with them as any other issue.
>>
>> An alternative, used by Mapserver, would be to setup a dedicated private
>> github repository, where we would invite only users (but they are likely
>> able to see all issues, not just theirs). Or perhaps just make a
>> repository accessible to PSC / trusted developers, interact with the
>> reporter through email (who wants to be in the email loop?) and paste
>> there the report and updates, but that becomes cumbersome.
>>
>> Another point, assuming we have a private issue tracker, is, assuming
>> the issue is confirmed and we have a fix for it, how do we deal with it
>> ? My inclination would be to just commit the fix (the issue would become
>> more or less public once a candidate pull request is issued) and not
>> issue a dedicated release, but use our regular bugfix releases.
>>
>> Thoughts ?
>>
>> Even
>>
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/476db9db/attachment.html>

From simon.eves at omnisci.com  Wed Jul 28 16:10:01 2021
From: simon.eves at omnisci.com (Simon Eves)
Date: Wed, 28 Jul 2021 16:10:01 -0700
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <b3a63d9c-54d3-c65c-a87e-ce0874e705e5@spatialys.com>
References: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>
 <b3a63d9c-54d3-c65c-a87e-ce0874e705e5@spatialys.com>
Message-ID: <CAJf0KTQwF=Ceb6evXKRcqq2A_L2GxR2zWG8vA8G58KDSXqsR+A@mail.gmail.com>

Agreed. Unfortunately, we're looking for a quick solution to a customer
complaint. I'll ponder it some more.

On Wed, Jul 28, 2021 at 12:28 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Simon,
>
> I don't think that killing a thread is a safe practice in general. It
> would likely result in memory leaks and maybe in some other inconsistent
> state that could crash the whole process.  An interesting enhancement for
> such cases would be to be able to provide a progress / abort callback.
>
> Even
> Le 28/07/2021 ? 21:22, Simon Eves a ?crit :
>
> Dear All,
>
> I am aware that some improvements were made in the 2.3 timeframe with
> regards to dealing with large GeoJSON files, although even in 3.2, it's
> still very slow and memory hungry.
>
> Our system allows for aborting imports, but this only works reliably once
> it has actually got to the stage of reading features from the file. With
> the GeoJSON, it just sits in the GDALOpenEx call for ages.
>
> My question, therefore, is whether it might be practical to run the
> GDALOpenEx in a separate thread with a future to return the resulting
> handle, such that it could be monitored and killed if necessary?
>
> Mainly I would be concerned that killing the thread might trash some
> global GDAL state that might then not be recoverable, or that the open
> relies on some TLS for the process thread and therefore might not work
> properly.
>
> We're going to try it anyway, but opinions welcomed, thanks!
>
> Simon
>
> --
> <http://www.omnisci.com/>
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>
>
> Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210728/9f44382d/attachment-0001.html>

From mflan at mflan.com  Thu Jul 29 06:49:30 2021
From: mflan at mflan.com (Mike Flannigan)
Date: Thu, 29 Jul 2021 08:49:30 -0500
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
Message-ID: <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>


I would like to hear more about large GeoJSON files.
How large are they?

My GeoJSON files contain linear features only.? My
largest one is 50.2 MB with 1,230,000 newlines in it.
Next biggest one is 12 MB with 280,000 newlines.? These
and about 140 other geojsons are open in the same project
and I have no problems.? In fact I converted from
SHP to geojson 2 years ago because I used to have problems
with SHP linear files.

I use QGIS 3.16.8 on Linux Mint.


Mike


On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org wrote:
> Date: Wed, 28 Jul 2021 12:22:12 -0700
> From: Simon Eves<simon.eves at omnisci.com>
> To:gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Large GeoJSONs and aborting file opening
> Message-ID:
> 	<CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Dear All,
>
> I am aware that some improvements were made in the 2.3 timeframe with
> regards to dealing with large GeoJSON files, although even in 3.2, it's
> still very slow and memory hungry.
>
> Our system allows for aborting imports, but this only works reliably once
> it has actually got to the stage of reading features from the file. With
> the GeoJSON, it just sits in the GDALOpenEx call for ages.
>
> My question, therefore, is whether it might be practical to run the
> GDALOpenEx in a separate thread with a future to return the resulting
> handle, such that it could be monitored and killed if necessary?
>
> Mainly I would be concerned that killing the thread might trash some global
> GDAL state that might then not be recoverable, or that the open relies on
> some TLS for the process thread and therefore might not work properly.
>
> We're going to try it anyway, but opinions welcomed, thanks!
>
> Simon



From doug_newcomb at fws.gov  Thu Jul 29 07:26:06 2021
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Thu, 29 Jul 2021 14:26:06 +0000
Subject: [gdal-dev] [EXTERNAL] Re: Large GeoJSONs and aborting file
 opening
In-Reply-To: <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>,
 <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
Message-ID: <BLAPR09MB67863EA3A999B2449D93657DF1EB9@BLAPR09MB6786.namprd09.prod.outlook.com>

https://github.com/microsoft/USBuildingFootprints
[https://opengraph.githubassets.com/225fd5de0d4b915c82edf14205ec82909692b31f97fa3453012808d51a8fd323/microsoft/USBuildingFootprints]<https://github.com/microsoft/USBuildingFootprints>
GitHub - microsoft/USBuildingFootprints: Computer generated building footprints for the United States<https://github.com/microsoft/USBuildingFootprints>
Introduction. Microsoft Maps is releasing country wide open building footprints datasets in United States. This dataset contains 129,591,852 computer generated building footprints derived using our computer vision algorithms on satellite imagery.
github.com
Texas is 2.38 GB , but you get a variety of other sizes

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Mike Flannigan <mflan at mflan.com>
Sent: Thursday, July 29, 2021 9:49 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [EXTERNAL] Re: [gdal-dev] Large GeoJSONs and aborting file opening



 This email has been received from outside of DOI - Use caution before clicking on links, opening attachments, or responding.



I would like to hear more about large GeoJSON files.
How large are they?

My GeoJSON files contain linear features only.  My
largest one is 50.2 MB with 1,230,000 newlines in it.
Next biggest one is 12 MB with 280,000 newlines.  These
and about 140 other geojsons are open in the same project
and I have no problems.  In fact I converted from
SHP to geojson 2 years ago because I used to have problems
with SHP linear files.

I use QGIS 3.16.8 on Linux Mint.


Mike


On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org wrote:
> Date: Wed, 28 Jul 2021 12:22:12 -0700
> From: Simon Eves<simon.eves at omnisci.com>
> To:gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Large GeoJSONs and aborting file opening
> Message-ID:
>       <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Dear All,
>
> I am aware that some improvements were made in the 2.3 timeframe with
> regards to dealing with large GeoJSON files, although even in 3.2, it's
> still very slow and memory hungry.
>
> Our system allows for aborting imports, but this only works reliably once
> it has actually got to the stage of reading features from the file. With
> the GeoJSON, it just sits in the GDALOpenEx call for ages.
>
> My question, therefore, is whether it might be practical to run the
> GDALOpenEx in a separate thread with a future to return the resulting
> handle, such that it could be monitored and killed if necessary?
>
> Mainly I would be concerned that killing the thread might trash some global
> GDAL state that might then not be recoverable, or that the open relies on
> some TLS for the process thread and therefore might not work properly.
>
> We're going to try it anyway, but opinions welcomed, thanks!
>
> Simon


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cdoug_newcomb%40fws.gov%7C4a700f32558543c33b2308d9529c3a35%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631653236424668%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=86Xw3QEVbY0bqUurcBL8iLFi9IVjl0vGyErJUclKFFg%3D&amp;reserved=0
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/b0eb1cc6/attachment.html>

From simon.eves at omnisci.com  Thu Jul 29 09:30:52 2021
From: simon.eves at omnisci.com (Simon Eves)
Date: Thu, 29 Jul 2021 09:30:52 -0700
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
 <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
Message-ID: <CAJf0KTRFYD2MWc0j1jTO=A=zqfgLmEQEqBp4G7MmGr1Xc5fu4A@mail.gmail.com>

The problematic one in this case is about 30GB, with ~5.9M features, of
property parcels in Florida, each with polygons with 5-10 vertices and 57
(!) other columns. Below is the first feature as printed by ogrinfo. It
appears to have originated as a Shapefile, which we have also converted to
regular GeoJSON (the 30GB one), and linear GeoJSONL/Seq.

The Shapefile version imports with no issues or obvious delays, with
features flowing basically immediately, and the overall process taking
about 7 minutes.

The regular GeoJSON version spends over 20 minutes in the GDALOpenEx call,
and another 10 minutes before features flow (haven't looked yet in what),
after which it takes about the same 7 minutes.

The GeoJSONL/Seq version spends about 12 minutes in GDALOpenEx and then the
same 10 minutes, and then the same 7 minutes.

Note that ogrinfo has the same initial delays (20 minutes and 12 minutes)
before it prints anything.

This is all with GDAL 3.2.2 on Ubuntu 20.04 on a quad i7 4.2 with 32GB and
SSD.

The 7 minutes of import is not the issue, and once features are flowing,
our code is able to be aborted. The issue is the 20-30 minutes where it
can't because it's (seemingly) stuck in GDAL calls.

Simon
______________________________

OGRFeature(fl_parcels):0
  CNTYNAME (String) = ESCAMBIA
  LINK (String) = 27-083S321301060003
  PARCELID (String) = 083S321301060003
  NPARNO (String) = 12-033-083S321301060003
  DORUC (String) = 000
  PAUC (String) = 1
  PARUSEDESC (String) = VACANT RESIDENTIAL
  SPASS_CD (String) = (null)
  IMPROVVAL (Integer) = 0
  LNDVAL (Integer64) = 1069
  JV (Integer64) = 1069
  JV_CHNG (Integer) = (null)
  JV_HMSTD (Integer) = (null)
  AV_SD (Integer64) = 1069
  AV_NSD (Integer64) = 1069
  AV_HMSTD (Integer) = (null)
  JV_CLASS_U (Integer) = (null)
  ONAME (String) = GRAF MABIE PARTNERSHIP
  OADDR1 (String) = 5544 BAKER RD
  OADDR2 (String) = (null)
  OCITY (String) = MILTON
  OSTATE (String) = FL
  OZIPCD (String) = 32570
  PHYADDR1 (String) = (null)
  PHYCITY (String) = PERDIDO KEY
  PHYZIP (String) = 32507
  SLEGAL (String) = LT 6 BLK 3 PERDIDO BAY COUNTRY
  ALTKEY (String) = 103002391
  ACTYRBLT (Integer) = (null)
  EFFYRBLT (Integer) = (null)
  TOTLVGAREA (Integer) = (null)
  NOBULDNG (Integer) = (null)
  NORESUNTS (Integer) = (null)
  PARSPLT (String) = (null)
  LNDSQFOOT (Real) = 14610.000000000000000
  CONSTCLASS (String) = (null)
  SALEPRC1 (Integer64) = (null)
  SALEYR1 (Integer) = (null)
  SALEMO1 (Integer) = (null)
  ORBOOK1 (String) = (null)
  ORPAGE1 (String) = (null)
  SALEPRC2 (Integer) = (null)
  SALEYR2 (Integer) = (null)
  SALEMO2 (Integer) = (null)
  NBRHDCD (String) = (null)
  PUBLICLND (String) = (null)
  TAXAUTHCD (String) = MSTU
  SEC (String) = 8
  TWN (String) = 03S
  RNG (String) = (null)
  CENSUSBK (String) = 12033002604
  SOURCEAGE (String) = ESCAMBIA COUNTY PROPERTY APPRAISER
  SOURCEDATE (Integer64) = 1506643200
  LAT_DD (Real) = 30.334948776670700
  LONG_DD (Real) = -87.417015732515793
  MGRS (String) = 16RDU5991555975
  ACRES (Real) = 0.335475404173654
  EXMPT (String) = (null)
  LU_RES (String) = (null)
  LUCODE (String) = 000
  GCID (Integer) = 3070217
  DESCRIPT (String) = VACANT RESIDENTIAL
  FLAG (String) = (null)
  FGDLAQDATE (Integer64) = 1509494400
  AUTOID (Integer) = 3070217
  Shape_Leng (Real) = 161.443473611912992
  Shape_Area (Real) = 1357.620793937390090
  POLYGON ((-87.4169063602653 30.3347107536787,-87.4169237108049
30.3346997733855,-87.4172722303389 30.3349846323649,-87.41724423478
23 30.3350359296124,-87.4172384512691 30.3351985804435,-87.4171183385966
30.335195856325,-87.4169790313658 30.3350555432658,-87.4167
283286418 30.3348031641612,-87.4167416558679
30.3347974225575,-87.4167635326352 30.3347875319118,-87.4167852417644
30.3347773059899,
-87.4168030952182 30.334768463082,-87.4168206972148
30.3347594525361,-87.4168382153925 30.3347501905331,-87.416855482113
30.33474067
7073,-87.4168725811955 30.3347309121558,-87.4168895964589
30.334720937691,-87.4169063602653 30.3347107536787))


On Thu, Jul 29, 2021 at 6:49 AM Mike Flannigan <mflan at mflan.com> wrote:

>
> I would like to hear more about large GeoJSON files.
> How large are they?
>
> My GeoJSON files contain linear features only.  My
> largest one is 50.2 MB with 1,230,000 newlines in it.
> Next biggest one is 12 MB with 280,000 newlines.  These
> and about 140 other geojsons are open in the same project
> and I have no problems.  In fact I converted from
> SHP to geojson 2 years ago because I used to have problems
> with SHP linear files.
>
> I use QGIS 3.16.8 on Linux Mint.
>
>
> Mike
>
>
> On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org wrote:
> > Date: Wed, 28 Jul 2021 12:22:12 -0700
> > From: Simon Eves<simon.eves at omnisci.com>
> > To:gdal-dev at lists.osgeo.org
> > Subject: [gdal-dev] Large GeoJSONs and aborting file opening
> > Message-ID:
> >       <
> CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>
> > Content-Type: text/plain; charset="utf-8"
> >
> > Dear All,
> >
> > I am aware that some improvements were made in the 2.3 timeframe with
> > regards to dealing with large GeoJSON files, although even in 3.2, it's
> > still very slow and memory hungry.
> >
> > Our system allows for aborting imports, but this only works reliably once
> > it has actually got to the stage of reading features from the file. With
> > the GeoJSON, it just sits in the GDALOpenEx call for ages.
> >
> > My question, therefore, is whether it might be practical to run the
> > GDALOpenEx in a separate thread with a future to return the resulting
> > handle, such that it could be monitored and killed if necessary?
> >
> > Mainly I would be concerned that killing the thread might trash some
> global
> > GDAL state that might then not be recoverable, or that the open relies on
> > some TLS for the process thread and therefore might not work properly.
> >
> > We're going to try it anyway, but opinions welcomed, thanks!
> >
> > Simon
>
>
>

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/ec3f74ee/attachment-0001.html>

From mflan at mflan.com  Thu Jul 29 09:36:42 2021
From: mflan at mflan.com (Mike Flannigan)
Date: Thu, 29 Jul 2021 11:36:42 -0500
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <BLAPR09MB67863EA3A999B2449D93657DF1EB9@BLAPR09MB6786.namprd09.prod.outlook.com>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
 <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
 <BLAPR09MB67863EA3A999B2449D93657DF1EB9@BLAPR09MB6786.namprd09.prod.outlook.com>
Message-ID: <858d8ea8-0550-185f-7293-4af407f47709@mflan.com>


Thank you.

These building outlines don't produce fields that are extremely wide
(lots of characters on a single line).? But I tend to store my geoj's
with each point on a single line, to prevent excessively wide lines.
It makes a BIG difference for QGIS with the geoj's I work with.
You might try that just to see if it makes a difference for you.

So you could replace "],[" with "],\n[" (\n being a newline).? The file
might get even bigger, but QGIS is much happier with the newlines than
with the wide rows.


Mike



On 7/29/21 9:26 AM, Newcomb, Doug wrote:
> https://github.com/microsoft/USBuildingFootprints 
> <https://github.com/microsoft/USBuildingFootprints>
> <https://github.com/microsoft/USBuildingFootprints>
> 	
> GitHub - microsoft/USBuildingFootprints: Computer generated building 
> footprints for the United States 
> <https://github.com/microsoft/USBuildingFootprints>
> Introduction. Microsoft Maps is releasing country wide open building 
> footprints datasets in United States. This dataset contains 
> 129,591,852 computer generated building footprints derived using our 
> computer vision algorithms on satellite imagery.
> github.com
>
> Texas is 2.38 GB , but you get a variety of other sizes
>
> ------------------------------------------------------------------------
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Mike 
> Flannigan <mflan at mflan.com>
> *Sent:* Thursday, July 29, 2021 9:49 AM
> *To:* gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
> *Subject:* [EXTERNAL] Re: [gdal-dev] Large GeoJSONs and aborting file 
> opening
>
>
> ?This email has been received from outside of DOI - Use caution before 
> clicking on links, opening attachments, or responding.
>
>
>
> I would like to hear more about large GeoJSON files.
> How large are they?
>
> My GeoJSON files contain linear features only.? My
> largest one is 50.2 MB with 1,230,000 newlines in it.
> Next biggest one is 12 MB with 280,000 newlines.? These
> and about 140 other geojsons are open in the same project
> and I have no problems.? In fact I converted from
> SHP to geojson 2 years ago because I used to have problems
> with SHP linear files.
>
> I use QGIS 3.16.8 on Linux Mint.
>
>
> Mike
>
>
> On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org wrote:
> > Date: Wed, 28 Jul 2021 12:22:12 -0700
> > From: Simon Eves<simon.eves at omnisci.com>
> > To:gdal-dev at lists.osgeo.org
> > Subject: [gdal-dev] Large GeoJSONs and aborting file opening
> > Message-ID:
> > <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>
> > Content-Type: text/plain; charset="utf-8"
> >
> > Dear All,
> >
> > I am aware that some improvements were made in the 2.3 timeframe with
> > regards to dealing with large GeoJSON files, although even in 3.2, it's
> > still very slow and memory hungry.
> >
> > Our system allows for aborting imports, but this only works reliably 
> once
> > it has actually got to the stage of reading features from the file. With
> > the GeoJSON, it just sits in the GDALOpenEx call for ages.
> >
> > My question, therefore, is whether it might be practical to run the
> > GDALOpenEx in a separate thread with a future to return the resulting
> > handle, such that it could be monitored and killed if necessary?
> >
> > Mainly I would be concerned that killing the thread might trash some 
> global
> > GDAL state that might then not be recoverable, or that the open 
> relies on
> > some TLS for the process thread and therefore might not work properly.
> >
> > We're going to try it anyway, but opinions welcomed, thanks!
> >
> > Simon
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cdoug_newcomb%40fws.gov%7C4a700f32558543c33b2308d9529c3a35%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631653236424668%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=86Xw3QEVbY0bqUurcBL8iLFi9IVjl0vGyErJUclKFFg%3D&amp;reserved=0 
> <https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cdoug_newcomb%40fws.gov%7C4a700f32558543c33b2308d9529c3a35%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631653236424668%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=86Xw3QEVbY0bqUurcBL8iLFi9IVjl0vGyErJUclKFFg%3D&amp;reserved=0>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/8ccd5a43/attachment.html>

From gdt at lexort.com  Thu Jul 29 10:05:36 2021
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 29 Jul 2021 13:05:36 -0400
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <CA+YzLBe82Ktmbte742uF4w=xMQ+9THud4AQSTtLOytYHJdkZhA@mail.gmail.com>
 (Frank Warmerdam's message of "Wed, 28 Jul 2021 18:21:44 -0400")
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
 <CACmBxyszXNn2c47DbJ=oMbezCo6H3BjGRw8rzOiFWpjc=GK1Gw@mail.gmail.com>
 <CA+YzLBe82Ktmbte742uF4w=xMQ+9THud4AQSTtLOytYHJdkZhA@mail.gmail.com>
Message-ID: <rmieebhxd7j.fsf@s1.lexort.com>


From the semi-outside, and packaging perspective, I can completely
understand not having a full-blown private security process.  It's
certainly a lot of work.

Some upstream packages have private reporting paths, and develop and
test patches in secret, even including packagers.  I have several times
tested patches and had them staged to update pkgsrc after an embargo
time is passed.  However, this is a huge extra amount of effort and
indeed nobody is showing up wanting this and writing checks.


I think the earlier disclaimer is a bit much.  I think it's perfectly
adequate to say that there's no special or private mechanism for
security problems.  As for creating point releases after a security
bugfix, I'd say there's no need to say if you will or you won't but if
there's a bug that leads to code execution from bad input, it's probably
best to snap a micro from the release branch, and with any luck that
will be quite infrequent.

It also seems clear that any program whose point it is to read a vast
number of formats is going to have issues at a rate proportional to
number of formats, to first order, so it might be useful to point out
for those that don't realize that:

  The purpose of GDAL is to read and write a very large number of data
  formats, and many of these are complex.  Therefore one should expect
  that errors exist in some of this code, including errors with security
  implications.

or something, to make the point without saying "we know it's terrible",
as my impression is that there isn't a huge rate of bug reports or a big
pile of open security bugs.    Really pretty much any program needs to
be used with suspicion, including things that process web content or
images, etc.


So in summary I think the proposed approach is fine.

greg


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/90d338d4/attachment.sig>

From even.rouault at spatialys.com  Thu Jul 29 10:20:07 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Jul 2021 19:20:07 +0200
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
Message-ID: <7db51f2f-f7ee-c684-f529-f697e74d87f7@spatialys.com>

I've created https://github.com/OSGeo/gdal/pull/4152 with a SECURITY.md 
that largely uses Kurt's proposal.

Even

Le 28/07/2021 ? 19:37, Even Rouault a ?crit?:
> PSC,
>
> We just got https://github.com/OSGeo/gdal/issues/4146 from someone 
> trying to get in touch with a security issue. How do we want to deal 
> with that ? Personally dealing with all the secrecy about security 
> issues is not super appealing and my natural inclination would be to 
> deal with them as any other issue.
>
> An alternative, used by Mapserver, would be to setup a dedicated 
> private github repository, where we would invite only users (but they 
> are likely able to see all issues, not just theirs). Or perhaps just 
> make a repository accessible to PSC / trusted developers, interact 
> with the reporter through email (who wants to be in the email loop?) 
> and paste there the report and updates, but that becomes cumbersome.
>
> Another point, assuming we have a private issue tracker, is, assuming 
> the issue is confirmed and we have a fix for it, how do we deal with 
> it ? My inclination would be to just commit the fix (the issue would 
> become more or less public once a candidate pull request is issued) 
> and not issue a dedicated release, but use our regular bugfix releases.
>
> Thoughts ?
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mflan at mflan.com  Thu Jul 29 10:28:54 2021
From: mflan at mflan.com (Mike Flannigan)
Date: Thu, 29 Jul 2021 12:28:54 -0500
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <CAJf0KTRFYD2MWc0j1jTO=A=zqfgLmEQEqBp4G7MmGr1Xc5fu4A@mail.gmail.com>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
 <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
 <CAJf0KTRFYD2MWc0j1jTO=A=zqfgLmEQEqBp4G7MmGr1Xc5fu4A@mail.gmail.com>
Message-ID: <50123dc5-c51a-878c-5039-1703f19dfcd8@mflan.com>


Yeah, there must be a way of breaking this up in Postgis or some other
method.? Maybe by county or city region, if that meets your workflow
needs.? I would break it up outside of QGIS, and then import the various
geoj's into QGIS.

I'm thinking these methods don't work on a geoj:
https://www.reddit.com/r/QGIS/comments/mbljrw/render_visible_layers_only/
https://gis.stackexchange.com/questions/111784/displaying-only-selected-features-on-map-in-qgis


Mike


On 7/29/21 11:30 AM, Simon Eves wrote:
> The problematic one in this case is about 30GB, with ~5.9M features, 
> of property parcels in Florida, each with polygons with 5-10 vertices 
> and 57 (!) other columns. Below is the first feature as printed by 
> ogrinfo. It appears to have originated as a Shapefile, which we have 
> also converted to regular GeoJSON (the 30GB one), and linear 
> GeoJSONL/Seq.
>
> The Shapefile version imports with no issues?or obvious delays, with 
> features flowing basically immediately, and the overall process taking 
> about 7 minutes.
>
> The regular GeoJSON version spends over 20 minutes in the GDALOpenEx 
> call, and another 10 minutes before features flow (haven't looked yet 
> in what), after which it takes about the same 7 minutes.
>
> The GeoJSONL/Seq version spends about 12 minutes in GDALOpenEx and 
> then the same 10 minutes, and then the same 7 minutes.
>
> Note that ogrinfo has the same initial delays (20 minutes and 12 
> minutes) before it prints anything.
>
> This is all with GDAL 3.2.2 on Ubuntu 20.04 on a quad i7 4.2 with 32GB 
> and SSD.
>
> The 7 minutes of import is not the issue, and once features are 
> flowing, our code is able to be aborted. The issue is the 20-30 
> minutes where it can't because it's (seemingly) stuck in GDAL calls.
>
> Simon
> ______________________________
>
> OGRFeature(fl_parcels):0
> ? CNTYNAME (String) = ESCAMBIA
> ? LINK (String) = 27-083S321301060003
> ? PARCELID (String) = 083S321301060003
> ? NPARNO (String) = 12-033-083S321301060003
> ? DORUC (String) = 000
> ? PAUC (String) = 1
> ? PARUSEDESC (String) = VACANT RESIDENTIAL
> ? SPASS_CD (String) = (null)
> ? IMPROVVAL (Integer) = 0
> ? LNDVAL (Integer64) = 1069
> ? JV (Integer64) = 1069
> ? JV_CHNG (Integer) = (null)
> ? JV_HMSTD (Integer) = (null)
> ? AV_SD (Integer64) = 1069
> ? AV_NSD (Integer64) = 1069
> ? AV_HMSTD (Integer) = (null)
> ? JV_CLASS_U (Integer) = (null)
> ? ONAME (String) = GRAF MABIE PARTNERSHIP
> ? OADDR1 (String) = 5544 BAKER RD
> ? OADDR2 (String) = (null)
> ? OCITY (String) = MILTON
> ? OSTATE (String) = FL
> ? OZIPCD (String) = 32570
> ? PHYADDR1 (String) = (null)
> ? PHYCITY (String) = PERDIDO KEY
> ? PHYZIP (String) = 32507
> ? SLEGAL (String) = LT 6 BLK 3 PERDIDO BAY COUNTRY
> ? ALTKEY (String) = 103002391
> ? ACTYRBLT (Integer) = (null)
> ? EFFYRBLT (Integer) = (null)
> ? TOTLVGAREA (Integer) = (null)
> ? NOBULDNG (Integer) = (null)
> ? NORESUNTS (Integer) = (null)
> ? PARSPLT (String) = (null)
> ? LNDSQFOOT (Real) = 14610.000000000000000
> ? CONSTCLASS (String) = (null)
> ? SALEPRC1 (Integer64) = (null)
> ? SALEYR1 (Integer) = (null)
> ? SALEMO1 (Integer) = (null)
> ? ORBOOK1 (String) = (null)
> ? ORPAGE1 (String) = (null)
> ? SALEPRC2 (Integer) = (null)
> ? SALEYR2 (Integer) = (null)
> ? SALEMO2 (Integer) = (null)
> ? NBRHDCD (String) = (null)
> ? PUBLICLND (String) = (null)
> ? TAXAUTHCD (String) = MSTU
> ? SEC (String) = 8
> ? TWN (String) = 03S
> ? RNG (String) = (null)
> ? CENSUSBK (String) = 12033002604
> ? SOURCEAGE (String) = ESCAMBIA COUNTY PROPERTY APPRAISER
> ? SOURCEDATE (Integer64) = 1506643200
> ? LAT_DD (Real) = 30.334948776670700
> ? LONG_DD (Real) = -87.417015732515793
> ? MGRS (String) = 16RDU5991555975
> ? ACRES (Real) = 0.335475404173654
> ? EXMPT (String) = (null)
> ? LU_RES (String) = (null)
> ? LUCODE (String) = 000
> ? GCID (Integer) = 3070217
> ? DESCRIPT (String) = VACANT RESIDENTIAL
> ? FLAG (String) = (null)
> ? FGDLAQDATE (Integer64) = 1509494400
> ? AUTOID (Integer) = 3070217
> ? Shape_Leng (Real) = 161.443473611912992
> ? Shape_Area (Real) = 1357.620793937390090
> ? POLYGON ((-87.4169063602653 30.3347107536787,-87.4169237108049 
> 30.3346997733855,-87.4172722303389 30.3349846323649,-87.41724423478
> 23 30.3350359296124,-87.4172384512691 
> 30.3351985804435,-87.4171183385966 30.335195856325,-87.4169790313658 
> 30.3350555432658,-87.4167
> 283286418 30.3348031641612,-87.4167416558679 
> 30.3347974225575,-87.4167635326352 30.3347875319118,-87.4167852417644 
> 30.3347773059899,
> -87.4168030952182 30.334768463082,-87.4168206972148 
> 30.3347594525361,-87.4168382153925 30.3347501905331,-87.416855482113 
> 30.33474067
> 7073,-87.4168725811955 30.3347309121558,-87.4168895964589 
> 30.334720937691,-87.4169063602653 30.3347107536787))
>
>
> On Thu, Jul 29, 2021 at 6:49 AM Mike Flannigan <mflan at mflan.com 
> <mailto:mflan at mflan.com>> wrote:
>
>
>     I would like to hear more about large GeoJSON files.
>     How large are they?
>
>     My GeoJSON files contain linear features only.? My
>     largest one is 50.2 MB with 1,230,000 newlines in it.
>     Next biggest one is 12 MB with 280,000 newlines.? These
>     and about 140 other geojsons are open in the same project
>     and I have no problems.? In fact I converted from
>     SHP to geojson 2 years ago because I used to have problems
>     with SHP linear files.
>
>     I use QGIS 3.16.8 on Linux Mint.
>
>
>     Mike
>
>
>     On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org
>     <mailto:gdal-dev-request at lists.osgeo.org> wrote:
>     > Date: Wed, 28 Jul 2021 12:22:12 -0700
>     > From: Simon Eves<simon.eves at omnisci.com
>     <mailto:simon.eves at omnisci.com>>
>     > To:gdal-dev at lists.osgeo.org <mailto:To%3Agdal-dev at lists.osgeo.org>
>     > Subject: [gdal-dev] Large GeoJSONs and aborting file opening
>     > Message-ID:
>     >? ? ?
>     ?<CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com
>     <mailto:CAJf0KTRsaskSOsPv8tbA%2BiTB%2BTqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>>
>     > Content-Type: text/plain; charset="utf-8"
>     >
>     > Dear All,
>     >
>     > I am aware that some improvements were made in the 2.3 timeframe
>     with
>     > regards to dealing with large GeoJSON files, although even in
>     3.2, it's
>     > still very slow and memory hungry.
>     >
>     > Our system allows for aborting imports, but this only works
>     reliably once
>     > it has actually got to the stage of reading features from the
>     file. With
>     > the GeoJSON, it just sits in the GDALOpenEx call for ages.
>     >
>     > My question, therefore, is whether it might be practical to run the
>     > GDALOpenEx in a separate thread with a future to return the
>     resulting
>     > handle, such that it could be monitored and killed if necessary?
>     >
>     > Mainly I would be concerned that killing the thread might trash
>     some global
>     > GDAL state that might then not be recoverable, or that the open
>     relies on
>     > some TLS for the process thread and therefore might not work
>     properly.
>     >
>     > We're going to try it anyway, but opinions welcomed, thanks!
>     >
>     > Simon
>
>
>
>
> -- 
> <http://www.omnisci.com/>
> 	
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>
>
> 	
> Email: simon.eves at omnisci.com <mailto:simon.eves at omnisci.com>?| Cell: 
> +1 (415) 902-1996
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/a8534971/attachment-0001.html>

From andrew.bell.ia at gmail.com  Thu Jul 29 11:09:32 2021
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Thu, 29 Jul 2021 14:09:32 -0400
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <CAJf0KTQwF=Ceb6evXKRcqq2A_L2GxR2zWG8vA8G58KDSXqsR+A@mail.gmail.com>
References: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>
 <b3a63d9c-54d3-c65c-a87e-ce0874e705e5@spatialys.com>
 <CAJf0KTQwF=Ceb6evXKRcqq2A_L2GxR2zWG8vA8G58KDSXqsR+A@mail.gmail.com>
Message-ID: <CACJ51z2TjZheW6tMdfztJ67uemPCAsL9YUWsGZn2CmV_Su1Hww@mail.gmail.com>

Not exactly what you asked, but can you simply avoid opening the file at
all if it's too large rather than start the process and then abort?

On Wed, Jul 28, 2021 at 7:10 PM Simon Eves <simon.eves at omnisci.com> wrote:

> Agreed. Unfortunately, we're looking for a quick solution to a customer
> complaint. I'll ponder it some more.
>
> On Wed, Jul 28, 2021 at 12:28 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Simon,
>>
>> I don't think that killing a thread is a safe practice in general. It
>> would likely result in memory leaks and maybe in some other inconsistent
>> state that could crash the whole process.  An interesting enhancement for
>> such cases would be to be able to provide a progress / abort callback.
>>
>> Even
>> Le 28/07/2021 ? 21:22, Simon Eves a ?crit :
>>
>> Dear All,
>>
>> I am aware that some improvements were made in the 2.3 timeframe with
>> regards to dealing with large GeoJSON files, although even in 3.2, it's
>> still very slow and memory hungry.
>>
>> Our system allows for aborting imports, but this only works reliably once
>> it has actually got to the stage of reading features from the file. With
>> the GeoJSON, it just sits in the GDALOpenEx call for ages.
>>
>> My question, therefore, is whether it might be practical to run the
>> GDALOpenEx in a separate thread with a future to return the resulting
>> handle, such that it could be monitored and killed if necessary?
>>
>> Mainly I would be concerned that killing the thread might trash some
>> global GDAL state that might then not be recoverable, or that the open
>> relies on some TLS for the process thread and therefore might not work
>> properly.
>>
>> We're going to try it anyway, but opinions welcomed, thanks!
>>
>> Simon
>>
>> --
>> <http://www.omnisci.com/>
>> Simon Eves
>> Senior Graphics Engineer, Rendering Group
>> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>>
>>
>> Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
>>
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
>
> --
> <http://www.omnisci.com/>
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>
>
> Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/135687fa/attachment.html>

From doug_newcomb at fws.gov  Thu Jul 29 11:16:53 2021
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Thu, 29 Jul 2021 18:16:53 +0000
Subject: [gdal-dev] [EXTERNAL] Re: Large GeoJSONs and aborting file
 opening
In-Reply-To: <50123dc5-c51a-878c-5039-1703f19dfcd8@mflan.com>
References: <mailman.7146.1627500982.1889.gdal-dev@lists.osgeo.org>
 <131123f5-0055-8d6e-0abf-b1bb24b0e51f@mflan.com>
 <CAJf0KTRFYD2MWc0j1jTO=A=zqfgLmEQEqBp4G7MmGr1Xc5fu4A@mail.gmail.com>,
 <50123dc5-c51a-878c-5039-1703f19dfcd8@mflan.com>
Message-ID: <BLAPR09MB67862D3ACCB3CC134793AB75F1EB9@BLAPR09MB6786.namprd09.prod.outlook.com>

I just converted them to geopackage layers and went from there.

Doug

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Mike Flannigan <mflan at mflan.com>
Sent: Thursday, July 29, 2021 1:28 PM
To: Simon Eves <simon.eves at omnisci.com>
Cc: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [EXTERNAL] Re: [gdal-dev] Large GeoJSONs and aborting file opening




 This email has been received from outside of DOI - Use caution before clicking on links, opening attachments, or responding.



Yeah, there must be a way of breaking this up in Postgis or some other
method.  Maybe by county or city region, if that meets your workflow
needs.  I would break it up outside of QGIS, and then import the various
geoj's into QGIS.

I'm thinking these methods don't work on a geoj:
https://www.reddit.com/r/QGIS/comments/mbljrw/render_visible_layers_only/<https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.reddit.com%2Fr%2FQGIS%2Fcomments%2Fmbljrw%2Frender_visible_layers_only%2F&data=04%7C01%7Cdoug_newcomb%40fws.gov%7C6ed70bff2fda471014ab08d952b9edc2%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631781801562533%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=0NB3OrZA5ngYcz8b6QqRy%2Fen%2BAAIk9jc6Uu0j0Fo3CA%3D&reserved=0>
https://gis.stackexchange.com/questions/111784/displaying-only-selected-features-on-map-in-qgis<https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F111784%2Fdisplaying-only-selected-features-on-map-in-qgis&data=04%7C01%7Cdoug_newcomb%40fws.gov%7C6ed70bff2fda471014ab08d952b9edc2%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631781801562533%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=CjG5lHGmA%2BK6plQuGhY2d2wZ0I97T7k2GR1SBM9i7nk%3D&reserved=0>


Mike


On 7/29/21 11:30 AM, Simon Eves wrote:
The problematic one in this case is about 30GB, with ~5.9M features, of property parcels in Florida, each with polygons with 5-10 vertices and 57 (!) other columns. Below is the first feature as printed by ogrinfo. It appears to have originated as a Shapefile, which we have also converted to regular GeoJSON (the 30GB one), and linear GeoJSONL/Seq.

The Shapefile version imports with no issues or obvious delays, with features flowing basically immediately, and the overall process taking about 7 minutes.

The regular GeoJSON version spends over 20 minutes in the GDALOpenEx call, and another 10 minutes before features flow (haven't looked yet in what), after which it takes about the same 7 minutes.

The GeoJSONL/Seq version spends about 12 minutes in GDALOpenEx and then the same 10 minutes, and then the same 7 minutes.

Note that ogrinfo has the same initial delays (20 minutes and 12 minutes) before it prints anything.

This is all with GDAL 3.2.2 on Ubuntu 20.04 on a quad i7 4.2 with 32GB and SSD.

The 7 minutes of import is not the issue, and once features are flowing, our code is able to be aborted. The issue is the 20-30 minutes where it can't because it's (seemingly) stuck in GDAL calls.

Simon
______________________________

OGRFeature(fl_parcels):0
  CNTYNAME (String) = ESCAMBIA
  LINK (String) = 27-083S321301060003
  PARCELID (String) = 083S321301060003
  NPARNO (String) = 12-033-083S321301060003
  DORUC (String) = 000
  PAUC (String) = 1
  PARUSEDESC (String) = VACANT RESIDENTIAL
  SPASS_CD (String) = (null)
  IMPROVVAL (Integer) = 0
  LNDVAL (Integer64) = 1069
  JV (Integer64) = 1069
  JV_CHNG (Integer) = (null)
  JV_HMSTD (Integer) = (null)
  AV_SD (Integer64) = 1069
  AV_NSD (Integer64) = 1069
  AV_HMSTD (Integer) = (null)
  JV_CLASS_U (Integer) = (null)
  ONAME (String) = GRAF MABIE PARTNERSHIP
  OADDR1 (String) = 5544 BAKER RD
  OADDR2 (String) = (null)
  OCITY (String) = MILTON
  OSTATE (String) = FL
  OZIPCD (String) = 32570
  PHYADDR1 (String) = (null)
  PHYCITY (String) = PERDIDO KEY
  PHYZIP (String) = 32507
  SLEGAL (String) = LT 6 BLK 3 PERDIDO BAY COUNTRY
  ALTKEY (String) = 103002391
  ACTYRBLT (Integer) = (null)
  EFFYRBLT (Integer) = (null)
  TOTLVGAREA (Integer) = (null)
  NOBULDNG (Integer) = (null)
  NORESUNTS (Integer) = (null)
  PARSPLT (String) = (null)
  LNDSQFOOT (Real) = 14610.000000000000000
  CONSTCLASS (String) = (null)
  SALEPRC1 (Integer64) = (null)
  SALEYR1 (Integer) = (null)
  SALEMO1 (Integer) = (null)
  ORBOOK1 (String) = (null)
  ORPAGE1 (String) = (null)
  SALEPRC2 (Integer) = (null)
  SALEYR2 (Integer) = (null)
  SALEMO2 (Integer) = (null)
  NBRHDCD (String) = (null)
  PUBLICLND (String) = (null)
  TAXAUTHCD (String) = MSTU
  SEC (String) = 8
  TWN (String) = 03S
  RNG (String) = (null)
  CENSUSBK (String) = 12033002604
  SOURCEAGE (String) = ESCAMBIA COUNTY PROPERTY APPRAISER
  SOURCEDATE (Integer64) = 1506643200
  LAT_DD (Real) = 30.334948776670700
  LONG_DD (Real) = -87.417015732515793
  MGRS (String) = 16RDU5991555975
  ACRES (Real) = 0.335475404173654
  EXMPT (String) = (null)
  LU_RES (String) = (null)
  LUCODE (String) = 000
  GCID (Integer) = 3070217
  DESCRIPT (String) = VACANT RESIDENTIAL
  FLAG (String) = (null)
  FGDLAQDATE (Integer64) = 1509494400
  AUTOID (Integer) = 3070217
  Shape_Leng (Real) = 161.443473611912992
  Shape_Area (Real) = 1357.620793937390090
  POLYGON ((-87.4169063602653 30.3347107536787,-87.4169237108049 30.3346997733855,-87.4172722303389 30.3349846323649,-87.41724423478
23 30.3350359296124,-87.4172384512691 30.3351985804435,-87.4171183385966 30.335195856325,-87.4169790313658 30.3350555432658,-87.4167
283286418 30.3348031641612,-87.4167416558679 30.3347974225575,-87.4167635326352 30.3347875319118,-87.4167852417644 30.3347773059899,
-87.4168030952182 30.334768463082,-87.4168206972148 30.3347594525361,-87.4168382153925 30.3347501905331,-87.416855482113 30.33474067
7073,-87.4168725811955 30.3347309121558,-87.4168895964589 30.334720937691,-87.4169063602653 30.3347107536787))


On Thu, Jul 29, 2021 at 6:49 AM Mike Flannigan <mflan at mflan.com<mailto:mflan at mflan.com>> wrote:

I would like to hear more about large GeoJSON files.
How large are they?

My GeoJSON files contain linear features only.  My
largest one is 50.2 MB with 1,230,000 newlines in it.
Next biggest one is 12 MB with 280,000 newlines.  These
and about 140 other geojsons are open in the same project
and I have no problems.  In fact I converted from
SHP to geojson 2 years ago because I used to have problems
with SHP linear files.

I use QGIS 3.16.8 on Linux Mint.


Mike


On 7/28/21 2:36 PM, gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org> wrote:
> Date: Wed, 28 Jul 2021 12:22:12 -0700
> From: Simon Eves<simon.eves at omnisci.com<mailto:simon.eves at omnisci.com>>
> To:gdal-dev at lists.osgeo.org<mailto:To%3Agdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] Large GeoJSONs and aborting file opening
> Message-ID:
>       <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com<mailto:CAJf0KTRsaskSOsPv8tbA%2BiTB%2BTqL_ui5y4n05WGLDw_3guRs4w at mail.gmail.com>>
> Content-Type: text/plain; charset="utf-8"
>
> Dear All,
>
> I am aware that some improvements were made in the 2.3 timeframe with
> regards to dealing with large GeoJSON files, although even in 3.2, it's
> still very slow and memory hungry.
>
> Our system allows for aborting imports, but this only works reliably once
> it has actually got to the stage of reading features from the file. With
> the GeoJSON, it just sits in the GDALOpenEx call for ages.
>
> My question, therefore, is whether it might be practical to run the
> GDALOpenEx in a separate thread with a future to return the resulting
> handle, such that it could be monitored and killed if necessary?
>
> Mainly I would be concerned that killing the thread might trash some global
> GDAL state that might then not be recoverable, or that the open relies on
> some TLS for the process thread and therefore might not work properly.
>
> We're going to try it anyway, but opinions welcomed, thanks!
>
> Simon




--
[http://www2.omnisci.com/l/298412/2018-09-18/3sqpg/298412/61753/OmniSci_Email_Header2.png]<https://gcc02.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.omnisci.com%2F&data=04%7C01%7Cdoug_newcomb%40fws.gov%7C6ed70bff2fda471014ab08d952b9edc2%7C0693b5ba4b184d7b9341f32f400a5494%7C0%7C0%7C637631781801572491%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=XYs9TEZeQyJhogwTVfjzY2DY%2FDeey7Flbeorpvmh%2FGw%3D&reserved=0>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com<mailto:simon.eves at omnisci.com> | Cell:    +1 (415) 902-1996



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/bce04803/attachment-0001.html>

From simon.eves at omnisci.com  Thu Jul 29 11:21:24 2021
From: simon.eves at omnisci.com (Simon Eves)
Date: Thu, 29 Jul 2021 11:21:24 -0700
Subject: [gdal-dev] Large GeoJSONs and aborting file opening
In-Reply-To: <CACJ51z2TjZheW6tMdfztJ67uemPCAsL9YUWsGZn2CmV_Su1Hww@mail.gmail.com>
References: <CAJf0KTRsaskSOsPv8tbA+iTB+TqL_ui5y4n05WGLDw_3guRs4w@mail.gmail.com>
 <b3a63d9c-54d3-c65c-a87e-ce0874e705e5@spatialys.com>
 <CAJf0KTQwF=Ceb6evXKRcqq2A_L2GxR2zWG8vA8G58KDSXqsR+A@mail.gmail.com>
 <CACJ51z2TjZheW6tMdfztJ67uemPCAsL9YUWsGZn2CmV_Su1Hww@mail.gmail.com>
Message-ID: <CAJf0KTQc_wxNa8yVaPAe=ARpoVywaOSx2EtRNAonx9KLHDp=Rw@mail.gmail.com>

We could, but it does import if you're willing to leave it long enough. I
guess we could throw an "are you sure?" if the file is large. However,
being able to kill it without bringing down the whole server is still
desirable!

On Thu, Jul 29, 2021 at 11:09 AM Andrew Bell <andrew.bell.ia at gmail.com>
wrote:

> Not exactly what you asked, but can you simply avoid opening the file at
> all if it's too large rather than start the process and then abort?
>
> On Wed, Jul 28, 2021 at 7:10 PM Simon Eves <simon.eves at omnisci.com> wrote:
>
>> Agreed. Unfortunately, we're looking for a quick solution to a customer
>> complaint. I'll ponder it some more.
>>
>> On Wed, Jul 28, 2021 at 12:28 PM Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> Simon,
>>>
>>> I don't think that killing a thread is a safe practice in general. It
>>> would likely result in memory leaks and maybe in some other inconsistent
>>> state that could crash the whole process.  An interesting enhancement for
>>> such cases would be to be able to provide a progress / abort callback.
>>>
>>> Even
>>> Le 28/07/2021 ? 21:22, Simon Eves a ?crit :
>>>
>>> Dear All,
>>>
>>> I am aware that some improvements were made in the 2.3 timeframe with
>>> regards to dealing with large GeoJSON files, although even in 3.2, it's
>>> still very slow and memory hungry.
>>>
>>> Our system allows for aborting imports, but this only works reliably
>>> once it has actually got to the stage of reading features from the file.
>>> With the GeoJSON, it just sits in the GDALOpenEx call for ages.
>>>
>>> My question, therefore, is whether it might be practical to run the
>>> GDALOpenEx in a separate thread with a future to return the resulting
>>> handle, such that it could be monitored and killed if necessary?
>>>
>>> Mainly I would be concerned that killing the thread might trash some
>>> global GDAL state that might then not be recoverable, or that the open
>>> relies on some TLS for the process thread and therefore might not work
>>> properly.
>>>
>>> We're going to try it anyway, but opinions welcomed, thanks!
>>>
>>> Simon
>>>
>>> --
>>> <http://www.omnisci.com/>
>>> Simon Eves
>>> Senior Graphics Engineer, Rendering Group
>>> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>>>
>>>
>>> Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> -- http://www.spatialys.com
>>> My software is free, but my time generally not.
>>>
>>>
>>
>> --
>> <http://www.omnisci.com/>
>> Simon Eves
>> Senior Graphics Engineer, Rendering Group
>> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>>
>>
>> Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>


-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  +1 (415) 902-1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/be6ebda2/attachment.html>

From gdal at stripfamily.net  Thu Jul 29 13:56:34 2021
From: gdal at stripfamily.net (David Strip)
Date: Thu, 29 Jul 2021 14:56:34 -0600
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <7db51f2f-f7ee-c684-f529-f697e74d87f7@spatialys.com>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
 <7db51f2f-f7ee-c684-f529-f697e74d87f7@spatialys.com>
Message-ID: <855470a9-5b17-3657-0885-7ef99d4359d5@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/cf13c98a/attachment.html>

From even.rouault at spatialys.com  Thu Jul 29 14:29:01 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Jul 2021 23:29:01 +0200
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <855470a9-5b17-3657-0885-7ef99d4359d5@stripfamily.net>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
 <7db51f2f-f7ee-c684-f529-f697e74d87f7@spatialys.com>
 <855470a9-5b17-3657-0885-7ef99d4359d5@stripfamily.net>
Message-ID: <182fb48c-75d3-0f68-4cbf-098a68042c5c@spatialys.com>


> I've read the security.md file and maybe I'm running a little slow 
> today, but I still don't understand how I would go about reporting a 
> serious security bug and what will happen afterwards.
> Let's say I find a really serious vulnerability, something that might 
> let me erase your file system, or perhaps to run some code as root. It 
> seems irresponsible to provide any level of detail about this in a 
> public issue tracker beyond saying "contact me, I've found a major 
> vulnerability". I realize this is a real problem for the development 
> team because you don't know if I've really found something or I'm a 
> troll out to waste your time. On the flip side, posting "the string 
> xxx in a file read by driver yyy will allow me to do <horrible thing>" 
> in a public issue tracker is just asking for trouble.
Fair point. I've added a commit with the following text "However please 
refrain from publicly posting exploits with harmful consequences (data 
destruction,
etc.). Only people with the github handles from the [Project Steering 
Committee](https://gdal.org/community/index.html#project-steering-committee)
(or people that they would explictly allow) are allowed to ask you 
privately for
such dangerous reproducers if that was needed."

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdal at stripfamily.net  Thu Jul 29 15:07:42 2021
From: gdal at stripfamily.net (David Strip)
Date: Thu, 29 Jul 2021 16:07:42 -0600
Subject: [gdal-dev] How to deal with security related bug reports?
In-Reply-To: <182fb48c-75d3-0f68-4cbf-098a68042c5c@spatialys.com>
References: <4a14d420-19d2-bc49-207e-ea7c09c0d911@spatialys.com>
 <7db51f2f-f7ee-c684-f529-f697e74d87f7@spatialys.com>
 <855470a9-5b17-3657-0885-7ef99d4359d5@stripfamily.net>
 <182fb48c-75d3-0f68-4cbf-098a68042c5c@spatialys.com>
Message-ID: <b85f8fd2-ca1f-cd18-a34e-8a8cc2e27999@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/4d1fe957/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jul 29 15:42:56 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 29 Jul 2021 22:42:56 +0000
Subject: [gdal-dev] Making use of SPOT imagery mask files
In-Reply-To: <b79335815e304a5fa8873439a6b5676d@yukon.ca>
References: <7900a3e2908641779083c41c1b314440@yukon.ca>
 <b79335815e304a5fa8873439a6b5676d@yukon.ca>
Message-ID: <50cf80ba237748e094e5860447ad04eb@yukon.ca>

Aha! A small bit of progress:



$ gdaltransform -rpc DS_SPOT6_201308032015087_LM1_FR1_FR1_FR1_W137N65_10315\PROD_SPOT6_001\VOL_SPOT6_001_A\IMG_SPOT6_MS_001_A\DIM_SPOT6_MS_201308032015087_SEN_1.XML

Enter column line values separated by space, and press Return.

0.0 57083.0

-137.766376889524 63.1915449659547 0

9652.0 0.0

-136.420879379204 66.6213864498263 0



These are the corner coordinates of the gdalinfo report, and they match the image as ArcMap displays it.



[cid:image002.jpg at 01D78490.652687E0]


So in python we could loop through the vertices of each GML polygon coordinate pair and transform using the above method, but it seems there should or could be a more straightforward path.

-Matt


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Matt.Wilkie at yukon.ca<mailto:Matt.Wilkie at yukon.ca>
Sent: July 28, 2021 2:58 PM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Making use of SPOT imagery mask files


I'm working with SPOT 6 and 7 imagery delivered in DIMAP format. I've figured out how to extract the multispectral and pan-chromatic bands into geotiff with gdal-translate so they're easier to work with.

((cross posted to https://gis.stackexchange.com/questions/405077/making-use-of-spot-imagery-mask-files))

In each archive there are a series of mask files in gml<https://gis.stackexchange.com/questions/tagged/gml> format, which I can read with ogrinfo and Qgis. However the mask files don't have a coordinate system so I can't use them with the images.

From the ogrinfo report it appears the GML are using image row and column pixel dimensions. (The matching source image is 9652 x 57083.)

$ ogrinfo \SPOT6_sample_roi.gml maskfeature

INFO: Open of `\SPOT6_sample_roi.gml'

      using driver `GML' successful.

Metadata:

  NAME=Area of interest mask for product id SPOT6_MS_201308032015087_SEN_SPOT6_20160316_1601281mdxzlrvssw12_1



Layer name: MaskFeature

Geometry: Polygon

Feature Count: 1

Extent: (1.000000, 1.000000) - (9653.000000, 57084.000000)

Layer SRS WKT:

(unknown)

gml_id: String (0.0) NOT NULL

maskType: String (18.0)

OGRFeature(MaskFeature):0

  gml_id (String) = REGION_OF_INTEREST-0

  maskType (String) = REGION_OF_INTEREST

  POLYGON ((9645.1767578125 6.41328716278076,9645.162109375 5.32240867614746,9645.03125 4.30024194717407,9644.7841796875 3.2741334438324,9644.5390625 2.39344930648804,9644.181640625 1.72693908214569,9643.7666015625 1.20388793945312,9643.4931640625 1.0,8939.99609375 1.0,1.0 4.3671669960022,1.0 28542.5,1 57084,9653 57084,9653.0 45960.265625,9645.1767578125 6.41328716278076))

The gdalinfo report for the source image<https://gist.github.com/maphew/513404f56b956ef3f1379b70d1d5d87f> also shows pixel coordinates for the coordinate system:

Corner Coordinates:

Upper Left  (    0.0,    0.0)

Lower Left  (    0.0,57083.0)

Upper Right ( 9652.0,    0.0)

Lower Right ( 9652.0,57083.0)

Center      ( 4826.0,28541.5)

However it also has RPC metadata that seems to be enough to have Qgis and ArcMap/Pro display it in the right geographical location:

RPC Metadata:

  HEIGHT_OFF=500.0

  HEIGHT_SCALE=500.0

  LAT_OFF=64.90742355

  LAT_SCALE=1.71583845

  ...snip...

  SAMP_OFF=4825

  SAMP_SCALE=4826.0

Sample files at https://drive.google.com/drive/folders/119QEECJ42FKt0A9mq55rRmGsT9-5nSZq?usp=sharing<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fdrive.google.com%2fdrive%2ffolders%2f119QEECJ42FKt0A9mq55rRmGsT9%2d5nSZq%3fusp%3dsharing&umid=DDB23C05-C836-5F05-8C43-D9C4E8793F41&auth=c132af8ee7c9d1278d61a701569070a095ce962e-8392e73310668c1bcd34a5a3858e847f80e42556> (The image has been resized to 10% of it's original size.)

How might I marry the raster coordinate system info to the mask files so I can use them together?
Thanks in advance for your time and thoughts,

Matt Wilkie
A / Manager
(Geomatics Developer & Administrator)
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=http%3a%2f%2fyukon.ca&umid=DDB23C05-C836-5F05-8C43-D9C4E8793F41&auth=c132af8ee7c9d1278d61a701569070a095ce962e-b4a5ffa0a5f9c86e6d2b5c3020b56a517356be74>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/cad18054/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 22376 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210729/cad18054/attachment-0001.jpg>

From j1 at jimenezshaw.com  Fri Jul 30 11:19:21 2021
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Fri, 30 Jul 2021 20:19:21 +0200
Subject: [gdal-dev] Downscaled geotiff with overviews
Message-ID: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>

Hi

I want to make a (power-of-two) downscaled version of a geotiff with
overviews efficiently with C++ (not from the console).

Let's say I have a geotiff with overviews (external or internal), and I
want a copy of it, but at 50% of the size. That is just removing the "base"
of the pyramid, but keeping all the other levels. Then voil?, there you
have the geotiff 50% smaller, with the overviews already there, almost
without any computation. The same for 25% (and any power of 2).

However I do not figure out how to do it efficiently in C++. If I
understand correctly, CreateCopy is producing an image with the same size.
So to downscale I have to create a new image, read downscaled (that will
use the overviews) and write. But later, I have to recreate the overviews
on the new image... that are already in the original image.

Is there any way to make it efficiently? (as we have the data there)

Thanks.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210730/8d3960bd/attachment.html>

From Matt.Wilkie at yukon.ca  Fri Jul 30 12:11:37 2021
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Fri, 30 Jul 2021 19:11:37 +0000
Subject: [gdal-dev] Downscaled geotiff with overviews
In-Reply-To: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
References: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
Message-ID: <a4ae62f1a20044a6bda54527aeaedd0f@yukon.ca>

Watching this thread with interest. I?ve wanted to do the same, but from python.

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Javier Jimenez Shaw
Sent: July 30, 2021 11:19 AM
To: gdal dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Downscaled geotiff with overviews

Hi

I want to make a (power-of-two) downscaled version of a geotiff with overviews efficiently with C++ (not from the console).

Let's say I have a geotiff with overviews (external or internal), and I want a copy of it, but at 50% of the size. That is just removing the "base" of the pyramid, but keeping all the other levels. Then voil?, there you have the geotiff 50% smaller, with the overviews already there, almost without any computation. The same for 25% (and any power of 2).

However I do not figure out how to do it efficiently in C++. If I understand correctly, CreateCopy is producing an image with the same size. So to downscale I have to create a new image, read downscaled (that will use the overviews) and write. But later, I have to recreate the overviews on the new image... that are already in the original image.

Is there any way to make it efficiently? (as we have the data there)

Thanks.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210730/10ee8503/attachment.html>

From even.rouault at spatialys.com  Fri Jul 30 12:33:18 2021
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Jul 2021 21:33:18 +0200
Subject: [gdal-dev] Downscaled geotiff with overviews
In-Reply-To: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
References: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
Message-ID: <3d6b39de-45cf-e63a-206d-75817ce0f4ed@spatialys.com>

If you initialize empty overviews ( BuildOverviews("NONE", ... ) ), then 
you can read the downscaled version of the original geotiff and put that 
in the target overviews. Of course you'll pay the price of 
decompression/recompression. By using directly the libtiff API, you 
could save that

Even

Le 30/07/2021 ? 20:19, Javier Jimenez Shaw a ?crit?:
> Hi
>
> I want to make a (power-of-two) downscaled version of a geotiff with 
> overviews efficiently with C++ (not from the console).
>
> Let's say I have a geotiff with overviews (external or internal), and 
> I want a copy of it, but at 50% of the size. That is just removing the 
> "base" of the pyramid, but keeping all the other levels. Then voil?, 
> there you have the geotiff 50% smaller, with the overviews already 
> there, almost without any computation. The same for 25% (and any power 
> of 2).
>
> However I do not figure out how to do it efficiently in C++. If I 
> understand correctly, CreateCopy is producing an image with the same 
> size. So to downscale I have to create a new image, read downscaled 
> (that will use the overviews) and write. But later, I have to recreate 
> the overviews on the new image... that are already in the original image.
>
> Is there any way to make it efficiently? (as we have the data there)
>
> Thanks.
> .___ ._ ..._ .. . ._. .___ .. __ . _. . __..? ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210730/b828a7e1/attachment.html>

From pschmitt at gmail.com  Sat Jul 31 07:12:16 2021
From: pschmitt at gmail.com (Peter Schmitt)
Date: Sat, 31 Jul 2021 08:12:16 -0600
Subject: [gdal-dev] Downscaled geotiff with overviews
In-Reply-To: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
References: <CADRrdKuUs6e2Z6TCPyw2XAw28PxTrrOzGX9m9j4ZPyO1jJHJDg@mail.gmail.com>
Message-ID: <CACkcqcU7Qa-xyA6krzQYdcnvLuqkb09nNaksdX4hnQrBuT_cww@mail.gmail.com>

On Fri, Jul 30, 2021 at 12:28 PM Javier Jimenez Shaw <j1 at jimenezshaw.com>
wrote:

> I want to make a (power-of-two) downscaled version of a geotiff with
> overviews efficiently with C++ (not from the console).
>

I know you said you want to do this from C++ and not the console. In case
you did want to do it from the console... there's an open option for
gdal_translate to pluck a particular overview level out, like so:

gdal_translate in.tif out.tif -oo OVERVIEW_LEVEL=1

You might be able to do this with cleverly named overviews, like so:

gdal_translate in.tif out.tif.ovr -oo OVERVIEW_LEVEL=2

gdal_translate in.tif out.tif.ovr.ovr -oo OVERVIEW_LEVEL=3

...


and then one final translate which uses all the overviews to a new final
TIF.

Cheers,
Pete
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20210731/4fefb1e8/attachment.html>

