From mateusz at loskot.net  Sat Jul  1 08:23:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] GML 3 support
In-Reply-To: <44A2D780.6080905@pobox.com>
References: <44A2A8D8.5010302@xs4all.nl> <44A2D780.6080905@pobox.com>
Message-ID: <44A6693A.3010307@loskot.net>

Frank Warmerdam wrote:
> Bart van den Eijnden (OSGIS) wrote:
>> Hi Frank, list,
>> 
>> is there a roadmap for adding GML 3 support in OGR?
>> 
>> I guess lots of parties must be interested in this, so maybe some 
>> co-funding could do the trick.
> 
> Bart,
> 
> There is no fixed plan for this, but Mateusz Loskot and I have been 
> discussing the possibility of his doing a brand new GML3 driver not 
> built on the same adhoc techniques currently used in the GML2 driver.
> 
> 
> I think it would be interesting to approach this as a two stage
> process, with the first stage being the "simple features" profile of
> GML3 that was recently approved by OGC, and then a second stage to
> move to a more full featured implementation.
> 
> One issue is that GML3 includes some sophisticated data modelling 
> capabilities not inherent in OGR.  So we might either have to upgrade
> OGR or recognise the limitations in the driver.
> 
> If anyone interested in potentially supporting such an effort would
> speak up, I could try and prepare a more formal proposal with Mateusz
> in the coming weeks.

Bart and Frank,

I confirm I'm ready for wider discussion and taking a part in GML 3
driver development.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Sat Jul  1 08:52:42 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] some questions about gdal for WinCE
In-Reply-To: <BAY101-F32D945B5EE66BEBB2FF084DD7E0@phx.gbl>
References: <BAY101-F32D945B5EE66BEBB2FF084DD7E0@phx.gbl>
Message-ID: <44A6701A.3050409@loskot.net>

guan hw wrote:
> All. I have a project about the application of remote sensing on
> WinCE. I find the GDAL can be compiled for wince , but without the
> raster data parsal code in it. I have added the geotiff format in the
> project(evc4 project).

Hi,

I've never tried to compile any raster support for GDAL,
so I'm not able to give you any good advice.
But have you tried to build and link with libtiif for Windows CE.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Sun Jul  2 16:18:36 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:14 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <44A1648D.7020704@ec.gc.ca>
References: <448D847F.7010504@ec.gc.ca> <44A1648D.7020704@ec.gc.ca>
Message-ID: <44A82A1C.1010907@pobox.com>

Alexandre Leroux wrote:
> 
> Hi list,
> 
> I haven't got any news from my cookie cutting challenge below. Anyone 
> has a clue to help me get started?
> 
> Thanks and cheers! :-)
> 
> Alex
> 
> 
>> Can someone tell me if I can do the following with OGR: I have two 
>> shapefiles and need to cookie cut one with the other while keeping the 
>> attributes of the first shapefile in the newly generated third shapefile.
>>
>> I saw there is OGRGeometry::Intersection which would allow me to do 
>> this, but I'd need to verify the intersection of all features from 
>> shapefile #1 with all features of shapefile #2, which would take days 
>> and days to compute with OGR (that's what my collegue which knows OGR 
>> way better told me). Is there a way to cookie cut shapefiles directly 
>> at the layer level?

Alex,

There is no built in support to do this conveniently.  You could do an
intersection of all features in layer one against each feature in layer
two, with a pretest to avoid intersection operations on features whose
BBOXes don't even intersect.  Even better would be to keep some sort of
spatial index in memory so you would only do bbox comparisons with
features that are relatively nearby.  But I will also warn that the
Intersection() operator is pretty expensive, partly because each OGR
geometry must be turned into a GEOS geometry internally.  So another
optimization would be to translate all your geometries into GEOS geometries
once, and do the intersection directly with geos.  That would avoid a lot
of re-conversion compared to a more ogr based approach.

But basically, any approach with OGR and GEOS is going to involve quite
a bit of scripting or programming work on your part.

You might want to look at options for doing this in GRASS.  I believe it
has some sort of layer overlay operation (perhaps done in the raster
domain?).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From matt.wilkie at gov.yk.ca  Tue Jul  4 12:08:49 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] ArcView binary raster support
In-Reply-To: <44A4F3B1.5010007@sarvision.nl>
References: <44A4F3B1.5010007@sarvision.nl>
Message-ID: <44AA9291.5000806@gov.yk.ca>

Hi Vincent and interested coders,

> Would it be possible to add support to gdal for native ArcView raster
>  files, including other datatypes than simple ints, and (basic) 
> projection support?
...
> BTW I send this message to the list rather than directly to Frank 
> because maybe others are interested too and willing to share the cost
> :-)

I think the ESRI format most likely to be recognised and utilised across
the widest range of versions of ArcView & ArcGIS is ArcInfo GRID (the 
'aig' driver to gdal).

I'm not in a position to offer sharing of costs but I can certainly 
provide GRID rasters across the range of int types and projections for 
anyone who is interested in developing an AIG write driver for gdal and 
needs sample data.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From aaronkoning at gmail.com  Tue Jul  4 12:14:49 2006
From: aaronkoning at gmail.com (Aaron Koning)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] FIXED - OGR can't handle Null values in a Date field
In-Reply-To: <44A4EBA0.7020400@loskot.net>
References: <1319fbba0606161402t240c8dd0u4f34c5e8148ef340@mail.gmail.com>
	<44A4EBA0.7020400@loskot.net>
Message-ID: <1319fbba0607040914p5d23e23ere6dcd8df8c67f93b@mail.gmail.com>

Thanks a ton! This is uber-helpful.

Aaron

On 6/30/06, Mateusz Loskot <mateusz@loskot.net> wrote:
>
> Aaron Koning wrote:
> > Is there anyway of getting OGR to output Null values into a Date
> > field when there is a Null value present in the input Date field?
>
> Hi,
>
> Last days, I fixed this issue but due to my Internet connection was
> broken, I could not commit it.
> So, now I can and I've committed my changes to CVS.
>
> Changes:
> - Fixed Shape driver - NULL/0 date value was converted to string without
> zero fill for year, e.g. 0/00/00 instead of 0000/00/00.
>
> - Fixed NULL handling in PG driver - now, if date field stores year of
> 0000, the value is considered as NULL, because there is no ZERO year
> (this follows PostgreSQL/MySQL dates handling behaviour, interesting
> reference:
>
> http://groups.google.pl/group/mailing.database.pgsql-sql/browse_frm/thread/1685953a3ebf48c1
>
> So, I was able to import Aaron's shapefile to PostgreSQL 8.1.4.
> Here are my commands:
>
> ogr2ogr -f PostgreSQL PG:dbname=gdal_nulldate bugs/null_date/dates.shp
>
> NOTE: I renamed Aaron's shapefile to dates.shp
> Here is what I got in my gdal_nulldate database:
>
> gdal_nulldate=# \dt
>         List of relations
> Schema | Name  | Type  |  Owner
> --------+-------+-------+---------
> public | dates | table | mloskot
> (1 row)
>
> gdal_nulldate=# \d dates
>                                   Table "public.dates"
>     Column    |     Type      |                        Modifiers
>
> --------------+---------------+---------------------------------------------------------
> ogc_fid      | integer       | not null default
> nextval('dates_ogc_fid_seq'::regclass)
> wkb_geometry | bytea         |
> dstrbedate   | date          |
> dstrbsdate   | date          |
> licenceid    | character(50) |
> permitid     | character(50) |
> blknmbr      | character(50) |
> Indexes:
>     "dates_pk" PRIMARY KEY, btree (ogc_fid)
>
> gdal_nulldate=# select dstrbedate, dstrbsdate from dates;
> dstrbedate | dstrbsdate
> ------------+------------
> 2001-02-07 | 2001-02-07
> 2001-02-08 | 2001-02-08
> 2002-02-01 | 2002-02-01
> 2002-01-05 | 2002-01-05
> 1999-01-06 | 1999-01-06
> 1997-12-24 | 1997-12-24
> 1999-03-03 | 1999-03-03
> 2001-11-01 | 2001-11-01
> 1998-12-21 | 1998-12-21
> 1998-09-10 | 1998-09-10
> 1998-02-04 | 1998-02-04
> 2001-01-08 | 2001-01-08
>             |
> 1996-12-23 | 1996-12-23
> 1992-11-13 | 1992-11-13
> 1996-01-05 | 1996-01-05
>             |
> 1990-01-01 | 1990-01-01
> (18 rows)
>
> gdal_nulldate=#
>
> NOTE: As you can see, two records store null dates, just as in the input
> shapefile.
>
> So, I assume this issue is fixed, but there are small things I'd like to
> explain/learn (regarding OGR Shape driver and dates).
> Please, see my comment marked with 'XXX - mloskot' in the
> ogr/ogrsf_frmts/shape/shape2ogr.cpp file.
>
> Cheers
> --
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>



-- 
+--------------------------------------------
|  Aaron Koning
|  Information Technologist
|  Prince George, BC, Canada.
+--------------------------------------------
|  http://datashare.gis.unbc.ca/fist/
|  http://datashare.gis.unbc.ca/gctp-js/
+--------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060704/761b0bf1/attachment.html
From MChapman at sanz.com  Tue Jul  4 13:09:12 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D11946506511666@mailman.san.com>

Alex,

There are two ways you can do this. I'm not sure what you want to do:

1.  You can do the overlaps (bbox) test first using OGR (without GEOS)
as Frank suggested, to eliminate all geometries who's envelopes don't
overlap, then you do another pass through the remaining geometries and
do a strict intersection test to eliminate those geometries that don't
exactly intersect.  I wrote the code at the bottom in java to do this
and I have the c++ port around somewhere if you want it, but this code
can be ported easily.  Point and LineString intersections can use the
same...slightly modified isPolyInPoly()...maybe create a
isLineStringInPoly() and isPointInPoly() function and so on to handle
all your geometry type cases.  By the way...it's very fast.

2.  If you actually want to clip intersecting geometries and reshape
them to your cookie cutter geometry then you need to use a library like
GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source
library is very simple to use and works great...and it's very fast.  If
you have problems using it let me know and I will help you out.  If
Frank W. is reading this posting I would urge him to consider including
GPC as part of OGR since it's small, fast, powerful, and easy to use.
LineString and Point clipping is easy and you should be able to find
algorithms on-line or come up with one yourself.  GPC also supports
difference, intersection, exclusive-or and union clip operations.  The
C++ code I use for GPC is listed below the java code.

Best regards,
Martin 


//////////////////////////JAVA 

private boolean isPolyInPoly(double[] X1Points,
                                 double[] Y1Points,
                                 double[] X2Points,
                                 double[] Y2Points)
    {
        try
        {
            int X1Length = X1Points.length;
            int X2Length = X2Points.length;

            for (int i = 0; i < X1Length; i++)
            {
                if (isPointInPoly(X2Length, X2Points, Y2Points,
X1Points[i], Y1Points[i]))
                {
                    return true;
                }
            }

            for (int j = 0; j < X2Length; j++)
            {
                if (isPointInPoly(X1Length, X1Points, Y1Points,
X2Points[j], Y2Points[j]))
                {
                    return true;
                }
            }

            Line2D.Double lineSegment = new Line2D.Double();
            for (int k = 0; k < X1Points.length - 1; k++)
            {
                lineSegment.x1 = X1Points[k];
                lineSegment.y1 = Y1Points[k];
                lineSegment.x2 = X1Points[k + 1];
                lineSegment.y2 = Y1Points[k + 1];

                if (isLineInPoly(lineSegment, X2Points, Y2Points))
                {
                    return true;
                }
            }
        }
        catch (Exception e)
        {
            //
        }

        return false;
    }

    private boolean isPointInPoly(int polySize, double[] XPoints,
double[] YPoints, double x, double y)
    {
        try
        {
            int j = polySize - 1;
            boolean isInside = false;

            for (int i = 0; i < polySize; j = i++)
            {
                if ( ( ( (YPoints[i] <= y) && (y < YPoints[j])) ||
                      ( (YPoints[j] <= y) && (y < YPoints[i]))) &&
                    (x < (XPoints[j] - XPoints[i]) *
                     (y - YPoints[i]) / (YPoints[j] - YPoints[i]) +
XPoints[i]))
                {
                    isInside = !isInside;
                }
            }

            return isInside;
        }
        catch (Exception e)
        {
            //
        }

        return false;
    }

    private boolean isLineInPoly(Line2D.Double pL, double[] XPoints,
double[] YPoints)
    {
        try
        {
            if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x1,
pL.y1))
            {
                return true;
            }

            if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x2,
pL.y2))
            {
                return true;
            }

            Line2D.Double lineSegment = new Line2D.Double();
            for (int i = 0; i < XPoints.length - 1; i++)
            {
                lineSegment.x1 = XPoints[i];
                lineSegment.y1 = YPoints[i];
                lineSegment.x2 = XPoints[i + 1];
                lineSegment.y2 = YPoints[i + 1];

                if (isLineInLine(pL, lineSegment))
                {
                    return true;
                }
            }
        }
        catch (Exception e)
        {
            //
        }

        return false;
    }

    private boolean isLineInLine(Line2D.Double pL1, Line2D.Double pL2)
    {
        try
        {
            if ( (pL1.x1 == pL2.x1 && pL1.y1 == pL2.y1) || (pL1.x1 ==
pL2.x2 && pL1.y1 == pL2.y2) ||
                (pL1.x2 == pL2.x1 && pL1.y2 == pL2.y1) || (pL1.x2 ==
pL2.x2 && pL1.y2 == pL2.y2))
            {
                return true;
            }

            isAngleCounterClockWise( (Point2D.Double) pL1.getP1(),
(Point2D.Double) pL1.getP2(), (Point2D.Double) pL2.getP1());
            return (boolean) ( (isAngleCounterClockWise(
(Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
(Point2D.Double) pL2.getP1()) !=
                                isAngleCounterClockWise(
(Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
(Point2D.Double) pL2.getP2())) &&
                              (isAngleCounterClockWise( (Point2D.Double)
pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double) pL1.getP1())
!=
                               isAngleCounterClockWise( (Point2D.Double)
pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double)
pL1.getP2())));
        }
        catch (Exception e)
        {
            //
        }

        return false;
    }

    private boolean isAngleCounterClockWise(Point2D.Double p1,
Point2D.Double p2, Point2D.Double p3)
    {
        try
        {
            double dx1 = 0.0, dx2 = 0.0, dy1 = 0.0, dy2 = 0.0;

            dx1 = p2.x - p1.x;
            dy1 = p2.y - p1.y;
            dx2 = p3.x - p2.x;
            dy2 = p3.y - p2.y;

            if ( (dx1 == 0 && dx2 == 0) || (dy1 == 0 && dy2 == 0))
            {
                return false;
            }

            if (dy1 * dx2 < dy2 * dx1)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
        catch (Exception e)
        {
            //
        }

        return false;
    }





//////////////////////////////////////// GPC

void CVPAlgorithms::GetIntersection(OGRGeometry* pGeometryA,
OGRGeometry* pGeometryB, OGRGeometry* pResult)
{
	try
	{
		if (!pGeometryA || !pGeometryB || !pResult) return;
		if (pGeometryA->Intersects(pGeometryB) == FALSE) return;

		gpc_polygon* pPolygonA = NULL;
		gpc_polygon* pPolygonB = NULL;

		// convert geometry A
		OGRwkbGeometryType geomTypeA =
pGeometryA->getGeometryType();
		if (geomTypeA == wkbPoint)
		{
		}
		else if (geomTypeA == wkbLineString)
		{
		}
		else if (geomTypeA == wkbPolygon)
		{
			OGRLinearRing* pLinearRing = NULL;
			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryA;
			pPolygonA = new gpc_polygon();

			pPolygonA->num_contours =
pPolygon->getNumInteriorRings() + 1;
			pPolygonA->hole = (int*) new
int[pPolygonA->num_contours];
			pPolygonA->contour = (gpc_vertex_list*) new
gpc_vertex_list[pPolygonA->num_contours];

			for (int c = 0; c < pPolygonA->num_contours;
c++)
			{
				if (c == 0)
					pLinearRing =
pPolygon->getExteriorRing();
				else
					pLinearRing =
pPolygon->getInteriorRing(c - 1);

				pPolygonA->contour[c].num_vertices =
pLinearRing->getNumPoints();
				pPolygonA->hole[c] = c == 0 ? FALSE :
TRUE;

				pPolygonA->contour[c].vertex = new
gpc_vertex[pPolygonA->contour[c].num_vertices];

				if (c == 0)
				{
					for (int v = 0; v <
pPolygonA->contour[c].num_vertices; v++)
					{
	
pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
	
pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
					}
				}
				else
				{
					for (int v =
pPolygonA->contour[c].num_vertices - 1; v >= 0; v--) 
					{
	
pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
	
pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
					}
				}
			}
		}
		else if (geomTypeA == wkbMultiPoint)
		{
		}
		else if (geomTypeA == wkbMultiLineString)
		{
		}
		else if (geomTypeA == wkbMultiPolygon)
		{
		}
		else
			throw "Unsupported geometry type for parameter
1.";

		// convert geometry B
		OGRwkbGeometryType geomTypeB =
pGeometryB->getGeometryType();
		if (geomTypeB == wkbPoint)
		{
		}
		else if (geomTypeB == wkbLineString)
		{
		}
		else if (geomTypeB == wkbPolygon)
		{
			OGRLinearRing* pLinearRing = NULL;
			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryB;
			pPolygonB = new gpc_polygon();

			pPolygonB->num_contours =
pPolygon->getNumInteriorRings() + 1;
			pPolygonB->hole = (int*) new
int[pPolygonB->num_contours];
			pPolygonB->contour = (gpc_vertex_list*) new
gpc_vertex_list[pPolygonB->num_contours];

			for (int c = 0; c < pPolygonB->num_contours;
c++)
			{
				if (c == 0)
					pLinearRing =
pPolygon->getExteriorRing();
				else
					pLinearRing =
pPolygon->getInteriorRing(c - 1);

				pPolygonB->contour[c].num_vertices =
pLinearRing->getNumPoints();
				pPolygonB->hole[c] = c == 0 ? FALSE :
TRUE;

				pPolygonB->contour[c].vertex = new
gpc_vertex[pPolygonB->contour[c].num_vertices];

				if (c == 0)
				{
					for (int v = 0; v <
pPolygonB->contour[c].num_vertices; v++)
					{
	
pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
	
pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
					}
				}
				else
				{
					for (int v =
pPolygonB->contour[c].num_vertices - 1; v >= 0; v--) 
					{
	
pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
	
pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
					}
				}
			}
		}
		else if (geomTypeB == wkbMultiPoint)
		{
		}
		else if (geomTypeB == wkbMultiLineString)
		{
		}
		else if (geomTypeB == wkbMultiPolygon)
		{
		}
		else
			throw "Unsupported geometry type for parameter
2.";

		// polygon to polygon
		if (geomTypeA == wkbPolygon && geomTypeB == wkbPolygon)
		{
			gpc_polygon* pGPCPolygon = new gpc_polygon();
			gpc_polygon_clip(GPC_INT, pPolygonA, pPolygonB,
pGPCPolygon);

			OGRPolygon* pOgrPolygon = (OGRPolygon*) pResult;
	
pOgrPolygon->assignSpatialReference(pGeometryA->getSpatialReference());

			gpc_vertex_list* pVertexList = NULL;
			for (int i = 0; i < pGPCPolygon->num_contours;
i++)
			{
				OGRLinearRing ogrLinearRing;
				
				pVertexList = pGPCPolygon->contour;
				int nNumPoints =
pVertexList->num_vertices;

				for (int n = 0; n < nNumPoints; n++) 
				{
					double nX =
pVertexList->vertex[n].x;
					double nY =
pVertexList->vertex[n].y;
					ogrLinearRing.addPoint(nX, nY);
				}

				pOgrPolygon->addRing(&ogrLinearRing);
			}

			if (pGPCPolygon)
			{
				for (int c = 0; c <
pGPCPolygon->num_contours; c++)
					delete []
pGPCPolygon->contour[c].vertex;

				delete [] pGPCPolygon->hole;
				delete [] pGPCPolygon->contour;
				delete pGPCPolygon;
				pGPCPolygon = NULL;
			}
		}

		// clean up
		if (pPolygonB)
		{
			for (int c = 0; c < pPolygonB->num_contours;
c++)
				delete [] pPolygonB->contour[c].vertex;

			delete [] pPolygonB->hole;
			delete [] pPolygonB->contour;
			delete pPolygonB;
			pPolygonB = NULL;
		}

		if (pPolygonA)
		{
			for (int c = 0; c < pPolygonA->num_contours;
c++)
				delete [] pPolygonA->contour[c].vertex;

			delete [] pPolygonA->hole;
			delete [] pPolygonA->contour;
			delete pPolygonA;
			pPolygonA = NULL;
		}

	}
	catch(exception e)	
		{throw e;}
	catch(char* e)	
		{throw e;}
	catch(...)	
		{throw "An unexpected error occurred in
CVPAlgorithms::GetIntersection().";}
}







-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Sunday, July 02, 2006 2:19 PM
To: Alexandre Leroux
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

Alexandre Leroux wrote:
> 
> Hi list,
> 
> I haven't got any news from my cookie cutting challenge below. Anyone 
> has a clue to help me get started?
> 
> Thanks and cheers! :-)
> 
> Alex
> 
> 
>> Can someone tell me if I can do the following with OGR: I have two 
>> shapefiles and need to cookie cut one with the other while keeping
the 
>> attributes of the first shapefile in the newly generated third
shapefile.
>>
>> I saw there is OGRGeometry::Intersection which would allow me to do 
>> this, but I'd need to verify the intersection of all features from 
>> shapefile #1 with all features of shapefile #2, which would take days

>> and days to compute with OGR (that's what my collegue which knows OGR

>> way better told me). Is there a way to cookie cut shapefiles directly

>> at the layer level?

Alex,

There is no built in support to do this conveniently.  You could do an
intersection of all features in layer one against each feature in layer
two, with a pretest to avoid intersection operations on features whose
BBOXes don't even intersect.  Even better would be to keep some sort of
spatial index in memory so you would only do bbox comparisons with
features that are relatively nearby.  But I will also warn that the
Intersection() operator is pretty expensive, partly because each OGR
geometry must be turned into a GEOS geometry internally.  So another
optimization would be to translate all your geometries into GEOS
geometries
once, and do the intersection directly with geos.  That would avoid a
lot
of re-conversion compared to a more ogr based approach.

But basically, any approach with OGR and GEOS is going to involve quite
a bit of scripting or programming work on your part.

You might want to look at options for doing this in GRASS.  I believe it
has some sort of layer overlay operation (perhaps done in the raster
domain?).

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From alexandre.leroux at ec.gc.ca  Tue Jul  4 13:31:20 2006
From: alexandre.leroux at ec.gc.ca (Alexandre Leroux)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <ED3A48B9840E594890A2BC172D11946506511666@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D11946506511666@mailman.san.com>
Message-ID: <44AAA5E8.8060602@ec.gc.ca>

Thanks a lot Martin & Frank,

It's funny because we coded a solution using GPC. We have a few bugs 
left (in our bindings?) that should be corrected very soon. Thanks a lot 
for your C code Martin, we'll compare it with ours right away! We are 
planning to share our resulting code with the ogr crowd :-)

Cheers!

Alex

Chapman, Martin wrote:
> Alex,
> 
> There are two ways you can do this. I'm not sure what you want to do:
> 
> 1.  You can do the overlaps (bbox) test first using OGR (without GEOS)
> as Frank suggested, to eliminate all geometries who's envelopes don't
> overlap, then you do another pass through the remaining geometries and
> do a strict intersection test to eliminate those geometries that don't
> exactly intersect.  I wrote the code at the bottom in java to do this
> and I have the c++ port around somewhere if you want it, but this code
> can be ported easily.  Point and LineString intersections can use the
> same...slightly modified isPolyInPoly()...maybe create a
> isLineStringInPoly() and isPointInPoly() function and so on to handle
> all your geometry type cases.  By the way...it's very fast.
> 
> 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source
> library is very simple to use and works great...and it's very fast.  If
> you have problems using it let me know and I will help you out.  If
> Frank W. is reading this posting I would urge him to consider including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.
> LineString and Point clipping is easy and you should be able to find
> algorithms on-line or come up with one yourself.  GPC also supports
> difference, intersection, exclusive-or and union clip operations.  The
> C++ code I use for GPC is listed below the java code.
> 
> Best regards,
> Martin 
> 
> 
> //////////////////////////JAVA 
> 
> private boolean isPolyInPoly(double[] X1Points,
>                                  double[] Y1Points,
>                                  double[] X2Points,
>                                  double[] Y2Points)
>     {
>         try
>         {
>             int X1Length = X1Points.length;
>             int X2Length = X2Points.length;
> 
>             for (int i = 0; i < X1Length; i++)
>             {
>                 if (isPointInPoly(X2Length, X2Points, Y2Points,
> X1Points[i], Y1Points[i]))
>                 {
>                     return true;
>                 }
>             }
> 
>             for (int j = 0; j < X2Length; j++)
>             {
>                 if (isPointInPoly(X1Length, X1Points, Y1Points,
> X2Points[j], Y2Points[j]))
>                 {
>                     return true;
>                 }
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int k = 0; k < X1Points.length - 1; k++)
>             {
>                 lineSegment.x1 = X1Points[k];
>                 lineSegment.y1 = Y1Points[k];
>                 lineSegment.x2 = X1Points[k + 1];
>                 lineSegment.y2 = Y1Points[k + 1];
> 
>                 if (isLineInPoly(lineSegment, X2Points, Y2Points))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isPointInPoly(int polySize, double[] XPoints,
> double[] YPoints, double x, double y)
>     {
>         try
>         {
>             int j = polySize - 1;
>             boolean isInside = false;
> 
>             for (int i = 0; i < polySize; j = i++)
>             {
>                 if ( ( ( (YPoints[i] <= y) && (y < YPoints[j])) ||
>                       ( (YPoints[j] <= y) && (y < YPoints[i]))) &&
>                     (x < (XPoints[j] - XPoints[i]) *
>                      (y - YPoints[i]) / (YPoints[j] - YPoints[i]) +
> XPoints[i]))
>                 {
>                     isInside = !isInside;
>                 }
>             }
> 
>             return isInside;
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInPoly(Line2D.Double pL, double[] XPoints,
> double[] YPoints)
>     {
>         try
>         {
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x1,
> pL.y1))
>             {
>                 return true;
>             }
> 
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x2,
> pL.y2))
>             {
>                 return true;
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int i = 0; i < XPoints.length - 1; i++)
>             {
>                 lineSegment.x1 = XPoints[i];
>                 lineSegment.y1 = YPoints[i];
>                 lineSegment.x2 = XPoints[i + 1];
>                 lineSegment.y2 = YPoints[i + 1];
> 
>                 if (isLineInLine(pL, lineSegment))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInLine(Line2D.Double pL1, Line2D.Double pL2)
>     {
>         try
>         {
>             if ( (pL1.x1 == pL2.x1 && pL1.y1 == pL2.y1) || (pL1.x1 ==
> pL2.x2 && pL1.y1 == pL2.y2) ||
>                 (pL1.x2 == pL2.x1 && pL1.y2 == pL2.y1) || (pL1.x2 ==
> pL2.x2 && pL1.y2 == pL2.y2))
>             {
>                 return true;
>             }
> 
>             isAngleCounterClockWise( (Point2D.Double) pL1.getP1(),
> (Point2D.Double) pL1.getP2(), (Point2D.Double) pL2.getP1());
>             return (boolean) ( (isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP1()) !=
>                                 isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP2())) &&
>                               (isAngleCounterClockWise( (Point2D.Double)
> pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double) pL1.getP1())
> !=
>                                isAngleCounterClockWise( (Point2D.Double)
> pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double)
> pL1.getP2())));
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isAngleCounterClockWise(Point2D.Double p1,
> Point2D.Double p2, Point2D.Double p3)
>     {
>         try
>         {
>             double dx1 = 0.0, dx2 = 0.0, dy1 = 0.0, dy2 = 0.0;
> 
>             dx1 = p2.x - p1.x;
>             dy1 = p2.y - p1.y;
>             dx2 = p3.x - p2.x;
>             dy2 = p3.y - p2.y;
> 
>             if ( (dx1 == 0 && dx2 == 0) || (dy1 == 0 && dy2 == 0))
>             {
>                 return false;
>             }
> 
>             if (dy1 * dx2 < dy2 * dx1)
>             {
>                 return true;
>             }
>             else
>             {
>                 return false;
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
> 
> 
> 
> 
> //////////////////////////////////////// GPC
> 
> void CVPAlgorithms::GetIntersection(OGRGeometry* pGeometryA,
> OGRGeometry* pGeometryB, OGRGeometry* pResult)
> {
> 	try
> 	{
> 		if (!pGeometryA || !pGeometryB || !pResult) return;
> 		if (pGeometryA->Intersects(pGeometryB) == FALSE) return;
> 
> 		gpc_polygon* pPolygonA = NULL;
> 		gpc_polygon* pPolygonB = NULL;
> 
> 		// convert geometry A
> 		OGRwkbGeometryType geomTypeA =
> pGeometryA->getGeometryType();
> 		if (geomTypeA == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryA;
> 			pPolygonA = new gpc_polygon();
> 
> 			pPolygonA->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonA->hole = (int*) new
> int[pPolygonA->num_contours];
> 			pPolygonA->contour = (gpc_vertex_list*) new
> gpc_vertex_list[pPolygonA->num_contours];
> 
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonA->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonA->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonA->contour[c].vertex = new
> gpc_vertex[pPolygonA->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonA->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonA->contour[c].num_vertices - 1; v >= 0; v--) 
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeA == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 1.";
> 
> 		// convert geometry B
> 		OGRwkbGeometryType geomTypeB =
> pGeometryB->getGeometryType();
> 		if (geomTypeB == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryB;
> 			pPolygonB = new gpc_polygon();
> 
> 			pPolygonB->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonB->hole = (int*) new
> int[pPolygonB->num_contours];
> 			pPolygonB->contour = (gpc_vertex_list*) new
> gpc_vertex_list[pPolygonB->num_contours];
> 
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonB->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonB->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonB->contour[c].vertex = new
> gpc_vertex[pPolygonB->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonB->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonB->contour[c].num_vertices - 1; v >= 0; v--) 
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeB == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 2.";
> 
> 		// polygon to polygon
> 		if (geomTypeA == wkbPolygon && geomTypeB == wkbPolygon)
> 		{
> 			gpc_polygon* pGPCPolygon = new gpc_polygon();
> 			gpc_polygon_clip(GPC_INT, pPolygonA, pPolygonB,
> pGPCPolygon);
> 
> 			OGRPolygon* pOgrPolygon = (OGRPolygon*) pResult;
> 	
> pOgrPolygon->assignSpatialReference(pGeometryA->getSpatialReference());
> 
> 			gpc_vertex_list* pVertexList = NULL;
> 			for (int i = 0; i < pGPCPolygon->num_contours;
> i++)
> 			{
> 				OGRLinearRing ogrLinearRing;
> 				
> 				pVertexList = pGPCPolygon->contour;
> 				int nNumPoints =
> pVertexList->num_vertices;
> 
> 				for (int n = 0; n < nNumPoints; n++) 
> 				{
> 					double nX =
> pVertexList->vertex[n].x;
> 					double nY =
> pVertexList->vertex[n].y;
> 					ogrLinearRing.addPoint(nX, nY);
> 				}
> 
> 				pOgrPolygon->addRing(&ogrLinearRing);
> 			}
> 
> 			if (pGPCPolygon)
> 			{
> 				for (int c = 0; c <
> pGPCPolygon->num_contours; c++)
> 					delete []
> pGPCPolygon->contour[c].vertex;
> 
> 				delete [] pGPCPolygon->hole;
> 				delete [] pGPCPolygon->contour;
> 				delete pGPCPolygon;
> 				pGPCPolygon = NULL;
> 			}
> 		}
> 
> 		// clean up
> 		if (pPolygonB)
> 		{
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 				delete [] pPolygonB->contour[c].vertex;
> 
> 			delete [] pPolygonB->hole;
> 			delete [] pPolygonB->contour;
> 			delete pPolygonB;
> 			pPolygonB = NULL;
> 		}
> 
> 		if (pPolygonA)
> 		{
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 				delete [] pPolygonA->contour[c].vertex;
> 
> 			delete [] pPolygonA->hole;
> 			delete [] pPolygonA->contour;
> 			delete pPolygonA;
> 			pPolygonA = NULL;
> 		}
> 
> 	}
> 	catch(exception e)	
> 		{throw e;}
> 	catch(char* e)	
> 		{throw e;}
> 	catch(...)	
> 		{throw "An unexpected error occurred in
> CVPAlgorithms::GetIntersection().";}
> }
> 
> 
> 
> 
> 
> 
> 
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
> Warmerdam
> Sent: Sunday, July 02, 2006 2:19 PM
> To: Alexandre Leroux
> Cc: gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR
> 
> Alexandre Leroux wrote:
>> Hi list,
>>
>> I haven't got any news from my cookie cutting challenge below. Anyone 
>> has a clue to help me get started?
>>
>> Thanks and cheers! :-)
>>
>> Alex
>>
>>
>>> Can someone tell me if I can do the following with OGR: I have two 
>>> shapefiles and need to cookie cut one with the other while keeping
> the 
>>> attributes of the first shapefile in the newly generated third
> shapefile.
>>> I saw there is OGRGeometry::Intersection which would allow me to do 
>>> this, but I'd need to verify the intersection of all features from 
>>> shapefile #1 with all features of shapefile #2, which would take days
> 
>>> and days to compute with OGR (that's what my collegue which knows OGR
> 
>>> way better told me). Is there a way to cookie cut shapefiles directly
> 
>>> at the layer level?
> 
> Alex,
> 
> There is no built in support to do this conveniently.  You could do an
> intersection of all features in layer one against each feature in layer
> two, with a pretest to avoid intersection operations on features whose
> BBOXes don't even intersect.  Even better would be to keep some sort of
> spatial index in memory so you would only do bbox comparisons with
> features that are relatively nearby.  But I will also warn that the
> Intersection() operator is pretty expensive, partly because each OGR
> geometry must be turned into a GEOS geometry internally.  So another
> optimization would be to translate all your geometries into GEOS
> geometries
> once, and do the intersection directly with geos.  That would avoid a
> lot
> of re-conversion compared to a more ogr based approach.
> 
> But basically, any approach with OGR and GEOS is going to involve quite
> a bit of scripting or programming work on your part.
> 
> You might want to look at options for doing this in GRASS.  I believe it
> has some sort of layer overlay operation (perhaps done in the raster
> domain?).
> 
> Best regards,

-- 
Alexandre Leroux, M.Sc., Ing.
Environnement Canada / Environment Canada
Centre m?t?orologique canadien / Canadian Meteorological Centre
Division de la r?ponse aux urgences environnementales /
Environmental Emergency Response Division
alexandre.leroux@ec.gc.ca

From Jean-Philippe.Gauthier at ec.gc.ca  Tue Jul  4 13:56:17 2006
From: Jean-Philippe.Gauthier at ec.gc.ca (Gauthier,Jean-Philippe [CMC])
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <DC5EBDBC1F9D2E40AF4BDF9FFFA2EFDF02C57B@eccmcmail1.cmc.ec.gc.ca>


 There is only one twist with the GPC library, it sometimes return the results of the operations with no specific hole/extern ring order. In specific case when the result of the operation returns multiple polygon with holes, this might be a problem when converting back to OGR structures.

 This is something I'm looking in right now.

	================================================================
	Jean-Philippe Gauthier Bilodeau		Direction des op?rations
	Analyste Programmeur Scientifique	      Centre M?t?orologique Canadien
	Tel : (514) 421-4642			      2121 Route Transcanadienne
	Fax: (514) 421-4679			      Dorval,Qu?bec
	Email: Jean-Philippe.Gauthier@ec.gc.ca	H9P 1J3




-----Original Message-----
From: Leroux,Alexandre [CMC] 
Sent: 04 July, 2006 13:31
To: Chapman, Martin
Cc: Frank Warmerdam; gdal-dev@lists.maptools.org; Gauthier,Jean-Philippe [CMC]
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR


Thanks a lot Martin & Frank,

It's funny because we coded a solution using GPC. We have a few bugs 
left (in our bindings?) that should be corrected very soon. Thanks a lot 
for your C code Martin, we'll compare it with ours right away! We are 
planning to share our resulting code with the ogr crowd :-)

Cheers!

Alex

Chapman, Martin wrote:
> Alex,
> 
> There are two ways you can do this. I'm not sure what you want to do:
> 
> 1.  You can do the overlaps (bbox) test first using OGR (without GEOS) 
> as Frank suggested, to eliminate all geometries who's envelopes don't 
> overlap, then you do another pass through the remaining geometries and 
> do a strict intersection test to eliminate those geometries that don't 
> exactly intersect.  I wrote the code at the bottom in java to do this 
> and I have the c++ port around somewhere if you want it, but this code 
> can be ported easily.  Point and LineString intersections can use the 
> same...slightly modified isPolyInPoly()...maybe create a
> isLineStringInPoly() and isPointInPoly() function and so on to handle 
> all your geometry type cases.  By the way...it's very fast.
> 
> 2.  If you actually want to clip intersecting geometries and reshape 
> them to your cookie cutter geometry then you need to use a library 
> like GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open 
> source library is very simple to use and works great...and it's very 
> fast.  If you have problems using it let me know and I will help you 
> out.  If Frank W. is reading this posting I would urge him to consider 
> including GPC as part of OGR since it's small, fast, powerful, and 
> easy to use. LineString and Point clipping is easy and you should be 
> able to find algorithms on-line or come up with one yourself.  GPC 
> also supports difference, intersection, exclusive-or and union clip 
> operations.  The
> C++ code I use for GPC is listed below the java code.
> 
> Best regards,
> Martin
> 
> 
> //////////////////////////JAVA
> 
> private boolean isPolyInPoly(double[] X1Points,
>                                  double[] Y1Points,
>                                  double[] X2Points,
>                                  double[] Y2Points)
>     {
>         try
>         {
>             int X1Length = X1Points.length;
>             int X2Length = X2Points.length;
> 
>             for (int i = 0; i < X1Length; i++)
>             {
>                 if (isPointInPoly(X2Length, X2Points, Y2Points, 
> X1Points[i], Y1Points[i]))
>                 {
>                     return true;
>                 }
>             }
> 
>             for (int j = 0; j < X2Length; j++)
>             {
>                 if (isPointInPoly(X1Length, X1Points, Y1Points, 
> X2Points[j], Y2Points[j]))
>                 {
>                     return true;
>                 }
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int k = 0; k < X1Points.length - 1; k++)
>             {
>                 lineSegment.x1 = X1Points[k];
>                 lineSegment.y1 = Y1Points[k];
>                 lineSegment.x2 = X1Points[k + 1];
>                 lineSegment.y2 = Y1Points[k + 1];
> 
>                 if (isLineInPoly(lineSegment, X2Points, Y2Points))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isPointInPoly(int polySize, double[] XPoints, 
> double[] YPoints, double x, double y)
>     {
>         try
>         {
>             int j = polySize - 1;
>             boolean isInside = false;
> 
>             for (int i = 0; i < polySize; j = i++)
>             {
>                 if ( ( ( (YPoints[i] <= y) && (y < YPoints[j])) ||
>                       ( (YPoints[j] <= y) && (y < YPoints[i]))) &&
>                     (x < (XPoints[j] - XPoints[i]) *
>                      (y - YPoints[i]) / (YPoints[j] - YPoints[i]) +
> XPoints[i]))
>                 {
>                     isInside = !isInside;
>                 }
>             }
> 
>             return isInside;
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInPoly(Line2D.Double pL, double[] XPoints, 
> double[] YPoints)
>     {
>         try
>         {
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x1,
> pL.y1))
>             {
>                 return true;
>             }
> 
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x2,
> pL.y2))
>             {
>                 return true;
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int i = 0; i < XPoints.length - 1; i++)
>             {
>                 lineSegment.x1 = XPoints[i];
>                 lineSegment.y1 = YPoints[i];
>                 lineSegment.x2 = XPoints[i + 1];
>                 lineSegment.y2 = YPoints[i + 1];
> 
>                 if (isLineInLine(pL, lineSegment))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInLine(Line2D.Double pL1, Line2D.Double pL2)
>     {
>         try
>         {
>             if ( (pL1.x1 == pL2.x1 && pL1.y1 == pL2.y1) || (pL1.x1 == 
> pL2.x2 && pL1.y1 == pL2.y2) ||
>                 (pL1.x2 == pL2.x1 && pL1.y2 == pL2.y1) || (pL1.x2 == 
> pL2.x2 && pL1.y2 == pL2.y2))
>             {
>                 return true;
>             }
> 
>             isAngleCounterClockWise( (Point2D.Double) pL1.getP1(),
> (Point2D.Double) pL1.getP2(), (Point2D.Double) pL2.getP1());
>             return (boolean) ( (isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP1()) !=
>                                 isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP2())) &&
>                               (isAngleCounterClockWise( 
> (Point2D.Double) pL2.getP1(), (Point2D.Double) pL2.getP2(), 
> (Point2D.Double) pL1.getP1()) !=
>                                isAngleCounterClockWise( 
> (Point2D.Double) pL2.getP1(), (Point2D.Double) pL2.getP2(), 
> (Point2D.Double) pL1.getP2())));
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isAngleCounterClockWise(Point2D.Double p1, 
> Point2D.Double p2, Point2D.Double p3)
>     {
>         try
>         {
>             double dx1 = 0.0, dx2 = 0.0, dy1 = 0.0, dy2 = 0.0;
> 
>             dx1 = p2.x - p1.x;
>             dy1 = p2.y - p1.y;
>             dx2 = p3.x - p2.x;
>             dy2 = p3.y - p2.y;
> 
>             if ( (dx1 == 0 && dx2 == 0) || (dy1 == 0 && dy2 == 0))
>             {
>                 return false;
>             }
> 
>             if (dy1 * dx2 < dy2 * dx1)
>             {
>                 return true;
>             }
>             else
>             {
>                 return false;
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
> 
> 
> 
> 
> //////////////////////////////////////// GPC
> 
> void CVPAlgorithms::GetIntersection(OGRGeometry* pGeometryA,
> OGRGeometry* pGeometryB, OGRGeometry* pResult)
> {
> 	try
> 	{
> 		if (!pGeometryA || !pGeometryB || !pResult) return;
> 		if (pGeometryA->Intersects(pGeometryB) == FALSE) return;
> 
> 		gpc_polygon* pPolygonA = NULL;
> 		gpc_polygon* pPolygonB = NULL;
> 
> 		// convert geometry A
> 		OGRwkbGeometryType geomTypeA =
> pGeometryA->getGeometryType();
> 		if (geomTypeA == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryA;
> 			pPolygonA = new gpc_polygon();
> 
> 			pPolygonA->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonA->hole = (int*) new
> int[pPolygonA->num_contours];
> 			pPolygonA->contour = (gpc_vertex_list*) new 
> gpc_vertex_list[pPolygonA->num_contours];
> 
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonA->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonA->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonA->contour[c].vertex = new 
> gpc_vertex[pPolygonA->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonA->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonA->contour[c].num_vertices - 1; v >= 0; v--)
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeA == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 1.";
> 
> 		// convert geometry B
> 		OGRwkbGeometryType geomTypeB =
> pGeometryB->getGeometryType();
> 		if (geomTypeB == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryB;
> 			pPolygonB = new gpc_polygon();
> 
> 			pPolygonB->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonB->hole = (int*) new
> int[pPolygonB->num_contours];
> 			pPolygonB->contour = (gpc_vertex_list*) new 
> gpc_vertex_list[pPolygonB->num_contours];
> 
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonB->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonB->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonB->contour[c].vertex = new 
> gpc_vertex[pPolygonB->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonB->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonB->contour[c].num_vertices - 1; v >= 0; v--)
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeB == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 2.";
> 
> 		// polygon to polygon
> 		if (geomTypeA == wkbPolygon && geomTypeB == wkbPolygon)
> 		{
> 			gpc_polygon* pGPCPolygon = new gpc_polygon();
> 			gpc_polygon_clip(GPC_INT, pPolygonA, pPolygonB, pGPCPolygon);
> 
> 			OGRPolygon* pOgrPolygon = (OGRPolygon*) pResult;
> 	
> pOgrPolygon->assignSpatialReference(pGeometryA->getSpatialReference())
> pOgrPolygon->;
> 
> 			gpc_vertex_list* pVertexList = NULL;
> 			for (int i = 0; i < pGPCPolygon->num_contours;
> i++)
> 			{
> 				OGRLinearRing ogrLinearRing;
> 				
> 				pVertexList = pGPCPolygon->contour;
> 				int nNumPoints =
> pVertexList->num_vertices;
> 
> 				for (int n = 0; n < nNumPoints; n++) 
> 				{
> 					double nX =
> pVertexList->vertex[n].x;
> 					double nY =
> pVertexList->vertex[n].y;
> 					ogrLinearRing.addPoint(nX, nY);
> 				}
> 
> 				pOgrPolygon->addRing(&ogrLinearRing);
> 			}
> 
> 			if (pGPCPolygon)
> 			{
> 				for (int c = 0; c <
> pGPCPolygon->num_contours; c++)
> 					delete []
> pGPCPolygon->contour[c].vertex;
> 
> 				delete [] pGPCPolygon->hole;
> 				delete [] pGPCPolygon->contour;
> 				delete pGPCPolygon;
> 				pGPCPolygon = NULL;
> 			}
> 		}
> 
> 		// clean up
> 		if (pPolygonB)
> 		{
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 				delete [] pPolygonB->contour[c].vertex;
> 
> 			delete [] pPolygonB->hole;
> 			delete [] pPolygonB->contour;
> 			delete pPolygonB;
> 			pPolygonB = NULL;
> 		}
> 
> 		if (pPolygonA)
> 		{
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 				delete [] pPolygonA->contour[c].vertex;
> 
> 			delete [] pPolygonA->hole;
> 			delete [] pPolygonA->contour;
> 			delete pPolygonA;
> 			pPolygonA = NULL;
> 		}
> 
> 	}
> 	catch(exception e)	
> 		{throw e;}
> 	catch(char* e)	
> 		{throw e;}
> 	catch(...)	
> 		{throw "An unexpected error occurred in 
> CVPAlgorithms::GetIntersection().";}
> }
> 
> 
> 
> 
> 
> 
> 
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank 
> Warmerdam
> Sent: Sunday, July 02, 2006 2:19 PM
> To: Alexandre Leroux
> Cc: gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR
> 
> Alexandre Leroux wrote:
>> Hi list,
>>
>> I haven't got any news from my cookie cutting challenge below. Anyone
>> has a clue to help me get started?
>>
>> Thanks and cheers! :-)
>>
>> Alex
>>
>>
>>> Can someone tell me if I can do the following with OGR: I have two
>>> shapefiles and need to cookie cut one with the other while keeping
> the
>>> attributes of the first shapefile in the newly generated third
> shapefile.
>>> I saw there is OGRGeometry::Intersection which would allow me to do
>>> this, but I'd need to verify the intersection of all features from 
>>> shapefile #1 with all features of shapefile #2, which would take days
> 
>>> and days to compute with OGR (that's what my collegue which knows 
>>> OGR
> 
>>> way better told me). Is there a way to cookie cut shapefiles 
>>> directly
> 
>>> at the layer level?
> 
> Alex,
> 
> There is no built in support to do this conveniently.  You could do an 
> intersection of all features in layer one against each feature in 
> layer two, with a pretest to avoid intersection operations on features 
> whose BBOXes don't even intersect.  Even better would be to keep some 
> sort of spatial index in memory so you would only do bbox comparisons 
> with features that are relatively nearby.  But I will also warn that 
> the
> Intersection() operator is pretty expensive, partly because each OGR
> geometry must be turned into a GEOS geometry internally.  So another
> optimization would be to translate all your geometries into GEOS
> geometries
> once, and do the intersection directly with geos.  That would avoid a
> lot
> of re-conversion compared to a more ogr based approach.
> 
> But basically, any approach with OGR and GEOS is going to involve 
> quite a bit of scripting or programming work on your part.
> 
> You might want to look at options for doing this in GRASS.  I believe 
> it has some sort of layer overlay operation (perhaps done in the 
> raster domain?).
> 
> Best regards,

-- 
Alexandre Leroux, M.Sc., Ing.
Environnement Canada / Environment Canada
Centre m?t?orologique canadien / Canadian Meteorological Centre Division de la r?ponse aux urgences environnementales / Environmental Emergency Response Division alexandre.leroux@ec.gc.ca


From perrygeo at gmail.com  Tue Jul  4 14:46:13 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <DC5EBDBC1F9D2E40AF4BDF9FFFA2EFDF02C57B@eccmcmail1.cmc.ec.gc.ca>
References: <DC5EBDBC1F9D2E40AF4BDF9FFFA2EFDF02C57B@eccmcmail1.cmc.ec.gc.ca>
Message-ID: <5383fa5e0607041146p5bb5c40dg92b24ceede90a546@mail.gmail.com>

On 7/4/06, Chapman, Martin <MChapman@sanz.com> wrote:
> 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ). ......  If
> Frank W. is reading this posting I would urge him to consider including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.

The GPC licensing might make that tricky:

 "You may not use this software, in whole or in part, in support of
any commercial product without the express consent of the author."

This would conflict with GDAL/OGR's license quite a bit.

-- 
Matt Perry
perrygeo@gmail.com
http://www.perrygeo.net

From mateusz at loskot.net  Tue Jul  4 15:53:14 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <5383fa5e0607041146p5bb5c40dg92b24ceede90a546@mail.gmail.com>
References: <DC5EBDBC1F9D2E40AF4BDF9FFFA2EFDF02C57B@eccmcmail1.cmc.ec.gc.ca>
	<5383fa5e0607041146p5bb5c40dg92b24ceede90a546@mail.gmail.com>
Message-ID: <44AAC72A.9010400@loskot.net>

Matthew Perry wrote:
> On 7/4/06, Chapman, Martin <MChapman@sanz.com> wrote:
>> 2.  If you actually want to clip intersecting geometries and 
>> reshape them to your cookie cutter geometry then you need to use a 
>> library like GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ). 
>> ......  If Frank W. is reading this posting I would urge him to 
>> consider including GPC as part of OGR since it's small, fast, 
>> powerful, and easy to use.
> 
> The GPC licensing might make that tricky:
> 
> "You may not use this software, in whole or in part, in support of 
> any commercial product without the express consent of the author."
> 
> This would conflict with GDAL/OGR's license quite a bit.

Matthew is right.
GPC is a kind of double-licensed software, similarly to QT.
It's free of charge for non-commercial projects.
So, I think GPC could be supported as a plugin or extension
but not included in GDAL for every user, e.g. for commercial users.

In my last company I worked for, we were using GPC with .NET apps
and we had to buy it.
Good news is that there is no price set, but you can pay as much as you
can (at least year ago when we were buying GPC).

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From MChapman at sanz.com  Tue Jul  4 16:09:01 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D11946506511667@mailman.san.com>

Alex,

GPC is a pretty good library as far as I can tell.  If you see bugs in my implementation please point them out.  I would really like your implementation when you are done if you don't mind sharing it.

Best regards,
Martin

-----Original Message-----
From: Alexandre Leroux [mailto:alexandre.leroux@ec.gc.ca] 
Sent: Tuesday, July 04, 2006 11:31 AM
To: Chapman, Martin
Cc: Frank Warmerdam; gdal-dev@lists.maptools.org; jean-philippe.gauthier@ec.gc.ca
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

Thanks a lot Martin & Frank,

It's funny because we coded a solution using GPC. We have a few bugs 
left (in our bindings?) that should be corrected very soon. Thanks a lot 
for your C code Martin, we'll compare it with ours right away! We are 
planning to share our resulting code with the ogr crowd :-)

Cheers!

Alex

Chapman, Martin wrote:
> Alex,
> 
> There are two ways you can do this. I'm not sure what you want to do:
> 
> 1.  You can do the overlaps (bbox) test first using OGR (without GEOS)
> as Frank suggested, to eliminate all geometries who's envelopes don't
> overlap, then you do another pass through the remaining geometries and
> do a strict intersection test to eliminate those geometries that don't
> exactly intersect.  I wrote the code at the bottom in java to do this
> and I have the c++ port around somewhere if you want it, but this code
> can be ported easily.  Point and LineString intersections can use the
> same...slightly modified isPolyInPoly()...maybe create a
> isLineStringInPoly() and isPointInPoly() function and so on to handle
> all your geometry type cases.  By the way...it's very fast.
> 
> 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source
> library is very simple to use and works great...and it's very fast.  If
> you have problems using it let me know and I will help you out.  If
> Frank W. is reading this posting I would urge him to consider including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.
> LineString and Point clipping is easy and you should be able to find
> algorithms on-line or come up with one yourself.  GPC also supports
> difference, intersection, exclusive-or and union clip operations.  The
> C++ code I use for GPC is listed below the java code.
> 
> Best regards,
> Martin 
> 
> 
> //////////////////////////JAVA 
> 
> private boolean isPolyInPoly(double[] X1Points,
>                                  double[] Y1Points,
>                                  double[] X2Points,
>                                  double[] Y2Points)
>     {
>         try
>         {
>             int X1Length = X1Points.length;
>             int X2Length = X2Points.length;
> 
>             for (int i = 0; i < X1Length; i++)
>             {
>                 if (isPointInPoly(X2Length, X2Points, Y2Points,
> X1Points[i], Y1Points[i]))
>                 {
>                     return true;
>                 }
>             }
> 
>             for (int j = 0; j < X2Length; j++)
>             {
>                 if (isPointInPoly(X1Length, X1Points, Y1Points,
> X2Points[j], Y2Points[j]))
>                 {
>                     return true;
>                 }
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int k = 0; k < X1Points.length - 1; k++)
>             {
>                 lineSegment.x1 = X1Points[k];
>                 lineSegment.y1 = Y1Points[k];
>                 lineSegment.x2 = X1Points[k + 1];
>                 lineSegment.y2 = Y1Points[k + 1];
> 
>                 if (isLineInPoly(lineSegment, X2Points, Y2Points))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isPointInPoly(int polySize, double[] XPoints,
> double[] YPoints, double x, double y)
>     {
>         try
>         {
>             int j = polySize - 1;
>             boolean isInside = false;
> 
>             for (int i = 0; i < polySize; j = i++)
>             {
>                 if ( ( ( (YPoints[i] <= y) && (y < YPoints[j])) ||
>                       ( (YPoints[j] <= y) && (y < YPoints[i]))) &&
>                     (x < (XPoints[j] - XPoints[i]) *
>                      (y - YPoints[i]) / (YPoints[j] - YPoints[i]) +
> XPoints[i]))
>                 {
>                     isInside = !isInside;
>                 }
>             }
> 
>             return isInside;
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInPoly(Line2D.Double pL, double[] XPoints,
> double[] YPoints)
>     {
>         try
>         {
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x1,
> pL.y1))
>             {
>                 return true;
>             }
> 
>             if (isPointInPoly(XPoints.length, XPoints, YPoints, pL.x2,
> pL.y2))
>             {
>                 return true;
>             }
> 
>             Line2D.Double lineSegment = new Line2D.Double();
>             for (int i = 0; i < XPoints.length - 1; i++)
>             {
>                 lineSegment.x1 = XPoints[i];
>                 lineSegment.y1 = YPoints[i];
>                 lineSegment.x2 = XPoints[i + 1];
>                 lineSegment.y2 = YPoints[i + 1];
> 
>                 if (isLineInLine(pL, lineSegment))
>                 {
>                     return true;
>                 }
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isLineInLine(Line2D.Double pL1, Line2D.Double pL2)
>     {
>         try
>         {
>             if ( (pL1.x1 == pL2.x1 && pL1.y1 == pL2.y1) || (pL1.x1 ==
> pL2.x2 && pL1.y1 == pL2.y2) ||
>                 (pL1.x2 == pL2.x1 && pL1.y2 == pL2.y1) || (pL1.x2 ==
> pL2.x2 && pL1.y2 == pL2.y2))
>             {
>                 return true;
>             }
> 
>             isAngleCounterClockWise( (Point2D.Double) pL1.getP1(),
> (Point2D.Double) pL1.getP2(), (Point2D.Double) pL2.getP1());
>             return (boolean) ( (isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP1()) !=
>                                 isAngleCounterClockWise(
> (Point2D.Double) pL1.getP1(), (Point2D.Double) pL1.getP2(),
> (Point2D.Double) pL2.getP2())) &&
>                               (isAngleCounterClockWise( (Point2D.Double)
> pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double) pL1.getP1())
> !=
>                                isAngleCounterClockWise( (Point2D.Double)
> pL2.getP1(), (Point2D.Double) pL2.getP2(), (Point2D.Double)
> pL1.getP2())));
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
>     private boolean isAngleCounterClockWise(Point2D.Double p1,
> Point2D.Double p2, Point2D.Double p3)
>     {
>         try
>         {
>             double dx1 = 0.0, dx2 = 0.0, dy1 = 0.0, dy2 = 0.0;
> 
>             dx1 = p2.x - p1.x;
>             dy1 = p2.y - p1.y;
>             dx2 = p3.x - p2.x;
>             dy2 = p3.y - p2.y;
> 
>             if ( (dx1 == 0 && dx2 == 0) || (dy1 == 0 && dy2 == 0))
>             {
>                 return false;
>             }
> 
>             if (dy1 * dx2 < dy2 * dx1)
>             {
>                 return true;
>             }
>             else
>             {
>                 return false;
>             }
>         }
>         catch (Exception e)
>         {
>             //
>         }
> 
>         return false;
>     }
> 
> 
> 
> 
> 
> //////////////////////////////////////// GPC
> 
> void CVPAlgorithms::GetIntersection(OGRGeometry* pGeometryA,
> OGRGeometry* pGeometryB, OGRGeometry* pResult)
> {
> 	try
> 	{
> 		if (!pGeometryA || !pGeometryB || !pResult) return;
> 		if (pGeometryA->Intersects(pGeometryB) == FALSE) return;
> 
> 		gpc_polygon* pPolygonA = NULL;
> 		gpc_polygon* pPolygonB = NULL;
> 
> 		// convert geometry A
> 		OGRwkbGeometryType geomTypeA =
> pGeometryA->getGeometryType();
> 		if (geomTypeA == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryA;
> 			pPolygonA = new gpc_polygon();
> 
> 			pPolygonA->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonA->hole = (int*) new
> int[pPolygonA->num_contours];
> 			pPolygonA->contour = (gpc_vertex_list*) new
> gpc_vertex_list[pPolygonA->num_contours];
> 
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonA->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonA->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonA->contour[c].vertex = new
> gpc_vertex[pPolygonA->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonA->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonA->contour[c].num_vertices - 1; v >= 0; v--) 
> 					{
> 	
> pPolygonA->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonA->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeA == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeA == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 1.";
> 
> 		// convert geometry B
> 		OGRwkbGeometryType geomTypeB =
> pGeometryB->getGeometryType();
> 		if (geomTypeB == wkbPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbPolygon)
> 		{
> 			OGRLinearRing* pLinearRing = NULL;
> 			OGRPolygon* pPolygon = (OGRPolygon*) pGeometryB;
> 			pPolygonB = new gpc_polygon();
> 
> 			pPolygonB->num_contours =
> pPolygon->getNumInteriorRings() + 1;
> 			pPolygonB->hole = (int*) new
> int[pPolygonB->num_contours];
> 			pPolygonB->contour = (gpc_vertex_list*) new
> gpc_vertex_list[pPolygonB->num_contours];
> 
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 			{
> 				if (c == 0)
> 					pLinearRing =
> pPolygon->getExteriorRing();
> 				else
> 					pLinearRing =
> pPolygon->getInteriorRing(c - 1);
> 
> 				pPolygonB->contour[c].num_vertices =
> pLinearRing->getNumPoints();
> 				pPolygonB->hole[c] = c == 0 ? FALSE :
> TRUE;
> 
> 				pPolygonB->contour[c].vertex = new
> gpc_vertex[pPolygonB->contour[c].num_vertices];
> 
> 				if (c == 0)
> 				{
> 					for (int v = 0; v <
> pPolygonB->contour[c].num_vertices; v++)
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 				else
> 				{
> 					for (int v =
> pPolygonB->contour[c].num_vertices - 1; v >= 0; v--) 
> 					{
> 	
> pPolygonB->contour[c].vertex[v].x = pLinearRing->getX(v);
> 	
> pPolygonB->contour[c].vertex[v].y = pLinearRing->getY(v);
> 					}
> 				}
> 			}
> 		}
> 		else if (geomTypeB == wkbMultiPoint)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiLineString)
> 		{
> 		}
> 		else if (geomTypeB == wkbMultiPolygon)
> 		{
> 		}
> 		else
> 			throw "Unsupported geometry type for parameter
> 2.";
> 
> 		// polygon to polygon
> 		if (geomTypeA == wkbPolygon && geomTypeB == wkbPolygon)
> 		{
> 			gpc_polygon* pGPCPolygon = new gpc_polygon();
> 			gpc_polygon_clip(GPC_INT, pPolygonA, pPolygonB,
> pGPCPolygon);
> 
> 			OGRPolygon* pOgrPolygon = (OGRPolygon*) pResult;
> 	
> pOgrPolygon->assignSpatialReference(pGeometryA->getSpatialReference());
> 
> 			gpc_vertex_list* pVertexList = NULL;
> 			for (int i = 0; i < pGPCPolygon->num_contours;
> i++)
> 			{
> 				OGRLinearRing ogrLinearRing;
> 				
> 				pVertexList = pGPCPolygon->contour;
> 				int nNumPoints =
> pVertexList->num_vertices;
> 
> 				for (int n = 0; n < nNumPoints; n++) 
> 				{
> 					double nX =
> pVertexList->vertex[n].x;
> 					double nY =
> pVertexList->vertex[n].y;
> 					ogrLinearRing.addPoint(nX, nY);
> 				}
> 
> 				pOgrPolygon->addRing(&ogrLinearRing);
> 			}
> 
> 			if (pGPCPolygon)
> 			{
> 				for (int c = 0; c <
> pGPCPolygon->num_contours; c++)
> 					delete []
> pGPCPolygon->contour[c].vertex;
> 
> 				delete [] pGPCPolygon->hole;
> 				delete [] pGPCPolygon->contour;
> 				delete pGPCPolygon;
> 				pGPCPolygon = NULL;
> 			}
> 		}
> 
> 		// clean up
> 		if (pPolygonB)
> 		{
> 			for (int c = 0; c < pPolygonB->num_contours;
> c++)
> 				delete [] pPolygonB->contour[c].vertex;
> 
> 			delete [] pPolygonB->hole;
> 			delete [] pPolygonB->contour;
> 			delete pPolygonB;
> 			pPolygonB = NULL;
> 		}
> 
> 		if (pPolygonA)
> 		{
> 			for (int c = 0; c < pPolygonA->num_contours;
> c++)
> 				delete [] pPolygonA->contour[c].vertex;
> 
> 			delete [] pPolygonA->hole;
> 			delete [] pPolygonA->contour;
> 			delete pPolygonA;
> 			pPolygonA = NULL;
> 		}
> 
> 	}
> 	catch(exception e)	
> 		{throw e;}
> 	catch(char* e)	
> 		{throw e;}
> 	catch(...)	
> 		{throw "An unexpected error occurred in
> CVPAlgorithms::GetIntersection().";}
> }
> 
> 
> 
> 
> 
> 
> 
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
> Warmerdam
> Sent: Sunday, July 02, 2006 2:19 PM
> To: Alexandre Leroux
> Cc: gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR
> 
> Alexandre Leroux wrote:
>> Hi list,
>>
>> I haven't got any news from my cookie cutting challenge below. Anyone 
>> has a clue to help me get started?
>>
>> Thanks and cheers! :-)
>>
>> Alex
>>
>>
>>> Can someone tell me if I can do the following with OGR: I have two 
>>> shapefiles and need to cookie cut one with the other while keeping
> the 
>>> attributes of the first shapefile in the newly generated third
> shapefile.
>>> I saw there is OGRGeometry::Intersection which would allow me to do 
>>> this, but I'd need to verify the intersection of all features from 
>>> shapefile #1 with all features of shapefile #2, which would take days
> 
>>> and days to compute with OGR (that's what my collegue which knows OGR
> 
>>> way better told me). Is there a way to cookie cut shapefiles directly
> 
>>> at the layer level?
> 
> Alex,
> 
> There is no built in support to do this conveniently.  You could do an
> intersection of all features in layer one against each feature in layer
> two, with a pretest to avoid intersection operations on features whose
> BBOXes don't even intersect.  Even better would be to keep some sort of
> spatial index in memory so you would only do bbox comparisons with
> features that are relatively nearby.  But I will also warn that the
> Intersection() operator is pretty expensive, partly because each OGR
> geometry must be turned into a GEOS geometry internally.  So another
> optimization would be to translate all your geometries into GEOS
> geometries
> once, and do the intersection directly with geos.  That would avoid a
> lot
> of re-conversion compared to a more ogr based approach.
> 
> But basically, any approach with OGR and GEOS is going to involve quite
> a bit of scripting or programming work on your part.
> 
> You might want to look at options for doing this in GRASS.  I believe it
> has some sort of layer overlay operation (perhaps done in the raster
> domain?).
> 
> Best regards,

-- 
Alexandre Leroux, M.Sc., Ing.
Environnement Canada / Environment Canada
Centre m?t?orologique canadien / Canadian Meteorological Centre
Division de la r?ponse aux urgences environnementales /
Environmental Emergency Response Division
alexandre.leroux@ec.gc.ca


From MChapman at sanz.com  Tue Jul  4 16:13:54 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D11946506511669@mailman.san.com>

Matt,

I see your point.  Couldn't it be handled the same way other third party
drivers are handled?  Like ArcSDE or MrSID.  Or is that different?

Martin

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matthew Perry
Sent: Tuesday, July 04, 2006 12:46 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

On 7/4/06, Chapman, Martin <MChapman@sanz.com> wrote:
> 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library
like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ). ......  If
> Frank W. is reading this posting I would urge him to consider
including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.

The GPC licensing might make that tricky:

 "You may not use this software, in whole or in part, in support of
any commercial product without the express consent of the author."

This would conflict with GDAL/OGR's license quite a bit.

-- 
Matt Perry
perrygeo@gmail.com
http://www.perrygeo.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From MChapman at sanz.com  Tue Jul  4 16:33:13 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D1194650651166A@mailman.san.com>

Mateusz,

Thanks for the information.  

Martin

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, July 04, 2006 1:53 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

Matthew Perry wrote:
> On 7/4/06, Chapman, Martin <MChapman@sanz.com> wrote:
>> 2.  If you actually want to clip intersecting geometries and 
>> reshape them to your cookie cutter geometry then you need to use a 
>> library like GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ). 
>> ......  If Frank W. is reading this posting I would urge him to 
>> consider including GPC as part of OGR since it's small, fast, 
>> powerful, and easy to use.
> 
> The GPC licensing might make that tricky:
> 
> "You may not use this software, in whole or in part, in support of 
> any commercial product without the express consent of the author."
> 
> This would conflict with GDAL/OGR's license quite a bit.

Matthew is right.
GPC is a kind of double-licensed software, similarly to QT.
It's free of charge for non-commercial projects.
So, I think GPC could be supported as a plugin or extension
but not included in GDAL for every user, e.g. for commercial users.

In my last company I worked for, we were using GPC with .NET apps
and we had to buy it.
Good news is that there is no price set, but you can pay as much as you
can (at least year ago when we were buying GPC).

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From jed.kaplan at ips.unibe.ch  Tue Jul  4 17:52:45 2006
From: jed.kaplan at ips.unibe.ch (Jed O. Kaplan)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Reducing geotiff colors to a standard LUT
Message-ID: <28B6E26D-E7B2-4054-849C-8B704FCD246D@ips.unibe.ch>

Hello all,

I have a series of geotiff files that are 8-bit paletted pseudocolor  
images. Unfortunately each separate image file has a different color  
table, though they are a sort of DRGs so the original scans have  
approximately all the same colors.

I would like to convert all the images to have a standard color  
table, so that, e.g., I can merge the files into a single image,  
perform GIS operations, etc.

Is there any way using GDAL tools or the API that I can give all of  
my individual images the same color table?  The image files are large  
(ca. 2000x3000 pixels), but I can convert them temporarily to full  
color rgb images and then reduce the colors.  I have a standard color  
table in another geotiff file.

I have tried to do this using the imagemagick tool: convert -map  
<file> <infile> <outfile> but this process is impossibly slow.

Any suggestions for (standardized, semi-automated) color reduction  
for DRG's would be much appreciated.

Thanks,

Jed Kaplan

From warmerdam at pobox.com  Tue Jul  4 22:22:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <ED3A48B9840E594890A2BC172D11946506511666@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D11946506511666@mailman.san.com>
Message-ID: <44AB227B.3030302@pobox.com>

Chapman, Martin wrote:
  > 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source
> library is very simple to use and works great...and it's very fast.  If
> you have problems using it let me know and I will help you out.  If
> Frank W. is reading this posting I would urge him to consider including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.
> LineString and Point clipping is easy and you should be able to find
> algorithms on-line or come up with one yourself.  GPC also supports
> difference, intersection, exclusive-or and union clip operations.  The
> C++ code I use for GPC is listed below the java code.

Martin,

What reasons do/did you have to use GPC instead of GEOS?  I can imagine it
is smaller, and faster.  As mentioned earlier GPC isn't open source, so
I would prefer to use GEOS but I wouldn't be opposed to having optional
GPC based implementation of some of the geometry operations if there was
a really substantial advantage to GPC.

Of course, using GPC outside OGR is already quite doable, so my integration
is not required ... at most a convenience.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jul  4 22:35:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] ArcView binary raster support
In-Reply-To: <44AA9291.5000806@gov.yk.ca>
References: <44A4F3B1.5010007@sarvision.nl> <44AA9291.5000806@gov.yk.ca>
Message-ID: <44AB255A.8000904@pobox.com>

Matt Wilkie wrote:
> Hi Vincent and interested coders,
> 
>> Would it be possible to add support to gdal for native ArcView raster
>>  files, including other datatypes than simple ints, and (basic) 
>> projection support?
> ...
>> BTW I send this message to the list rather than directly to Frank 
>> because maybe others are interested too and willing to share the cost
>> :-)
> 
> I think the ESRI format most likely to be recognised and utilised across
> the widest range of versions of ArcView & ArcGIS is ArcInfo GRID (the 
> 'aig' driver to gdal).
> 
> I'm not in a position to offer sharing of costs but I can certainly 
> provide GRID rasters across the range of int types and projections for 
> anyone who is interested in developing an AIG write driver for gdal and 
> needs sample data.

Vincent / Matt,

I imagine Arc/Info Binary Grids are the most natural way to provide
raster support for ArcView.  Unfortunately, a fairly valiant effort on
my part to implement write support for this format a few years ago failed.
The format is undocumented, and while I was able to deduce enough information
about it to read it effectively, I was never able to write valid files.  I
am not terribly inclined to revisit this issue, though someone keen could
start from the existing file format definition (and perhaps I have some code)
and try to implement it.

Another format that is fairly well supported by ArcView is the .HDR labelled
BIL.  I have done some improvements in recent months to this driver and
you may find it suitable for some purposes.  However, it does not seem
to be a very expressive way of describing the data type (float vs. integer
for instance) which can be a problem.

I am open to other advice on good ways of exporting raster data in a form
that is useful in ArcView.

As Vincent mentioned, things should be better with ArcGIS (and hopefully
getting better with each new version of ArcGIS).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Wed Jul  5 01:47:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: GDAL with JP2KAK
In-Reply-To: <44AB3D43.2060201@pobox.com>
References: <9337DFE5-9FF2-4AA3-824E-1B68E23D324A@mac.com>
	<44AB209F.4020801@pobox.com>
	<D42E8CFD-CEE6-4D30-B01D-122510B5CD47@mac.com>
	<44AB3D43.2060201@pobox.com>
Message-ID: <44AB5265.8040200@pobox.com>

Frank Warmerdam wrote:
> Greg,
> 
> I believe a week or two ago I build and ran GDAL with Kakadu 5.1 on 
> MacOS X.
> My configure line looked like:
> 
> ./configure --without-libtool --with-xerces=/usr/local 
> --with-kakadu=/Users/fwarmerdam/pkg/kakadu-5.1 --with-libtiff=/usr/local 
> --with-geotiff=internal --with-threads --with-ecw
> 
> I don't *recall* any special issues.
> 
> Best regards,

Greg,

I appologis ... it seems I had still been using Kakadu 4.2 without realizing
it.  I found I had to do the following "special" things:

  1) Add -fPIC into the Makefile-Darwin-Altivec-gcc compilation flags (both
     for coresys and apps).

  2) Manually install libkdu.a into /usr/local/lib (or even just move it up
     one directory) so it will be found.

  3) Run ranlib on libkdu.a.

  4) Use GDAL from CVS or manually add kdu_tiff.o and kdu_jpx.o to the
     gdal/frmts/jp2kak/GNUmakefile

With these changes everything seems to be ok.  Keep in mind that
--without-libtool listed above as well when configuring.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From zhonghaiw at gmail.com  Wed Jul  5 02:50:43 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Reducing geotiff colors to a standard LUT
In-Reply-To: <28B6E26D-E7B2-4054-849C-8B704FCD246D@ips.unibe.ch>
References: <28B6E26D-E7B2-4054-849C-8B704FCD246D@ips.unibe.ch>
Message-ID: <2534c4120607042350k1595710dxc27201b0bca7d2f5@mail.gmail.com>

Hi Jed,

I've got the same problem with my TIFFs, but in my case they are 24bit RGB
images. I tried to adjust the colors and then merge them. I even convert
them to 8bit images with LUTs, but I failed.

AFAIK, you can merge them together under the RGB model with the GDAL
commands like:

1. pct2rgb.py
2. gdal_merge.py
3. rgb2pct.py

but I don't know if this really works. IMO, you may get some troubles with
the command rgb2pct.py.

help this can help.

zhonghai

On 7/4/06, Jed O. Kaplan <jed.kaplan@ips.unibe.ch> wrote:
>
> Hello all,
>
> I have a series of geotiff files that are 8-bit paletted pseudocolor
> images. Unfortunately each separate image file has a different color
> table, though they are a sort of DRGs so the original scans have
> approximately all the same colors.
>
> I would like to convert all the images to have a standard color
> table, so that, e.g., I can merge the files into a single image,
> perform GIS operations, etc.
>
> Is there any way using GDAL tools or the API that I can give all of
> my individual images the same color table?  The image files are large
> (ca. 2000x3000 pixels), but I can convert them temporarily to full
> color rgb images and then reduce the colors.  I have a standard color
> table in another geotiff file.
>
> I have tried to do this using the imagemagick tool: convert -map
> <file> <infile> <outfile> but this process is impossibly slow.
>
> Any suggestions for (standardized, semi-automated) color reduction
> for DRG's would be much appreciated.
>
> Thanks,
>
> Jed Kaplan
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060705/6607c5e4/attachment.html
From neteler at itc.it  Wed Jul  5 07:58:31 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
In-Reply-To: <44A82A1C.1010907@pobox.com>
References: <448D847F.7010504@ec.gc.ca> <44A1648D.7020704@ec.gc.ca>
	<44A82A1C.1010907@pobox.com>
Message-ID: <20060705115831.GL2923@bartok.itc.it>

On Sun, Jul 02, 2006 at 04:18:36PM -0400, Frank Warmerdam wrote:
...
> You might want to look at options for doing this in GRASS.  I believe it
> has some sort of layer overlay operation (perhaps done in the raster
> domain?).

You can do it both in the raster or vector domain.
Since vector was asked:
 http://grass.itc.it/grass61/manuals/html61_user/v.overlay.html
 http://grass.itc.it/grass61/manuals/html61_user/v.select.html

Operators are
    and : also known as 'intersection' in GIS
    or :  also known as 'union' in GIS (only for atype=area)
    not : features from ainput not overlayed by features from binput
    xor : features from either ainput or binput but not those from ainput overlayed 
          by binput (only for atype=area)

As a script solution, you can put everything into a shell script which
internally launches GRASS:
- v.in.ogr: import
- v.overlay: operation
- v.out.ogr: export

For details, see
 http://grass.gdf-hannover.de/wiki/GRASS_and_Shell

Regards,

 Markus

From bclay at ball.com  Wed Jul  5 08:31:07 2006
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] ArcView binary raster support
Message-ID: <C482FF98AE985A47B8C982FD429C9E34FEF870@daytonmsg2k3.AERO.BALL.COM>

While it may not help for the current task, I heard at a recent
developers conference that ESRI is going to build GDAL support into an
upcoming release.  That may overcome the need for ESRI raster format
support.

Bruce

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Tuesday, July 04, 2006 10:35 PM
To: Matt Wilkie
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] ArcView binary raster support

Matt Wilkie wrote:
> Hi Vincent and interested coders,
> 
>> Would it be possible to add support to gdal for native ArcView raster
>>  files, including other datatypes than simple ints, and (basic) 
>> projection support?
> ...
>> BTW I send this message to the list rather than directly to Frank 
>> because maybe others are interested too and willing to share the cost
>> :-)
> 
> I think the ESRI format most likely to be recognised and utilised
across
> the widest range of versions of ArcView & ArcGIS is ArcInfo GRID (the 
> 'aig' driver to gdal).
> 
> I'm not in a position to offer sharing of costs but I can certainly 
> provide GRID rasters across the range of int types and projections for

> anyone who is interested in developing an AIG write driver for gdal
and 
> needs sample data.

Vincent / Matt,

I imagine Arc/Info Binary Grids are the most natural way to provide
raster support for ArcView.  Unfortunately, a fairly valiant effort on
my part to implement write support for this format a few years ago
failed.
The format is undocumented, and while I was able to deduce enough
information
about it to read it effectively, I was never able to write valid files.
I
am not terribly inclined to revisit this issue, though someone keen
could
start from the existing file format definition (and perhaps I have some
code)
and try to implement it.

Another format that is fairly well supported by ArcView is the .HDR
labelled
BIL.  I have done some improvements in recent months to this driver and
you may find it suitable for some purposes.  However, it does not seem
to be a very expressive way of describing the data type (float vs.
integer
for instance) which can be a problem.

I am open to other advice on good ways of exporting raster data in a
form
that is useful in ArcView.

As Vincent mentioned, things should be better with ArcGIS (and hopefully
getting better with each new version of ArcGIS).

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Wed Jul  5 10:08:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Is there a GetRasterBandasRGB?
In-Reply-To: <44A44FDF.4030704@noaa.gov>
References: <44A44FDF.4030704@noaa.gov>
Message-ID: <44ABC7EB.9020107@pobox.com>

Christopher Barker wrote:
> Hi all,
> 
> I've been starting to work with GDAL (mostly with the python bindings), 
> and I've been very impressed, it's a very nice piece of work. I'm 
> particularly thrilled with the BSB support.
> 
> What I need to do is be able to read any (ideally) form of 
> geo-referenced raster image that GDAL supports, and then get a 24 bit 
> RGB version of a given subset of the image.
> 
> I've found I can use GetRasterBand() to extract the data I want. 
> However, I found myself having to write different versions of the code, 
> depending on how the data was stored:
> 
> if is is a single band raster, with a ColorTable, I do one thing
> 
> If it's a three band raster, with RBG bands, I do another
> 
> etc.....
> 
> Those are the two I've supported so far, but then it downed on me that 
> my needs can not be unique! this must be a pretty common problem.
> 
> So the question is, have I missed a function that extracts a subsection 
> of the rasterdata, and converts it to RGB data for me? If it's not built 
> in to GDAL, has anyone written such a thing, and/or would this be the 
> kind of thing that you'd like to add, if I write it?

Chris,

I'm afraid you have not missed a function.  You basically need to do this
yourself.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jim.klassen at ci.stpaul.mn.us  Wed Jul  5 10:45:56 2006
From: jim.klassen at ci.stpaul.mn.us (Jim Klassen)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] help with adding a projection definition
In-Reply-To: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>
References: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>
Message-ID: <BE3996A6-0AFA-4F34-ABB6-C1CD80B6E0D7@ci.stpaul.mn.us>

I ran into this recently with UMN Mapserver as the application.

It appears that GDAL and PROJ both have a copy of the projection  
information. The solution was to add the well known text description  
of the coordinate system to epsg.wkt file (as well as the proj file)

Thanks to Frank W. for pointing this out to me on the Mapserver list.

As an example, I changed our epsg.wkt to read:

include esri_extra.wkt
include cubewerx_extra.wkt

200068,PROJCS["MN Ramsey County", GEOGCS["NAD83 (1986)", DATUM["GRS  
1980 + MN Ramsey Elevation", SPHEROID["Unknown", 
6378418.941,298.2572242549219]], PRIMEM["Greenwich",0], UNIT["Degree", 
0.017453292519943295]], PROJECTION["Lambert_Conformal_Conic_2SP"],  
PARAMETER["standard_parallel_1",45.13333333333333], PARAMETER 
["standard_parallel_2",44.88333333333333], PARAMETER 
["latitude_of_origin",44.79111111111111], PARAMETER 
["central_meridian",-93.38333333333334], PARAMETER["false_easting", 
500000], PARAMETER["false_northing",100000], UNIT["Foot_US", 
0.30480060960121924]]

And added the following to the epsg file for proj4:

<200068> +proj=lcc +lat_2=44.88333333333333 +lat_1=45.13333333333333  
+lat_0=44.79111111111111 +lon_0=-93.38333333333334 +x_0=152400.3048  
+y_0=30480.0610 +unit=sft +to_meter=0.30480060960122 +a=6378418.941  
+b=6357033.310 +no_defs <>


On Jun 30, 2006, at 4:40 PM, TC Haddad wrote:

> I'd like to use gdalwarp to reproject some large geotiffs, but
> apparently my projection of choice EPSG:4495 is not recognized by
> gdal.
>
> On a previous machine I had to edit an old version of proj4 to take
> this EPSG code, and was successful at that time. The parameters were
> as follows:
>
> # NAD83 / Oregon Lambert (Intl ft)
> <4495> +proj=lcc +lat_1=43 +lat_2=45.5 +lat_0=41.75 +lon_0=-120.5
> +x_0=400000.00000 +y_0=0 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048
> no_defs <>
>
> I'd like to do the same again, but I can't figure out where gdal is
> getting it's projection definitions from... what file name should I be
> looking for?
>
> My situation is FWtools 1.0.0b2 installed on WinXP sp2
>
> thanks for any help,
>
> Tanya
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

Jim Klassen
City of Saint Paul
Public Works Computer Services
(651) 266-6098



From bryan at geomega.com  Wed Jul  5 10:50:04 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] help with adding a projection definition
In-Reply-To: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>
References: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>
Message-ID: <44ABD19C.9000207@geomega.com>

Tanya,

In my FWtools installation I find the epsg definitions in this file:

<install directory>\FWTools1.0.0b2\proj_lib\epsg

<install directory> for me is c:\programs\  By default, it's probably 
c:\program files\

I also don't have 4495 in that file.

Hope that helps.

Bryan

TC Haddad wrote:
> I'd like to use gdalwarp to reproject some large geotiffs, but
> apparently my projection of choice EPSG:4495 is not recognized by
> gdal.
> 
> On a previous machine I had to edit an old version of proj4 to take
> this EPSG code, and was successful at that time. The parameters were
> as follows:
> 
> # NAD83 / Oregon Lambert (Intl ft)
> <4495> +proj=lcc +lat_1=43 +lat_2=45.5 +lat_0=41.75 +lon_0=-120.5
> +x_0=400000.00000 +y_0=0 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048
> no_defs <>
> 
> I'd like to do the same again, but I can't figure out where gdal is
> getting it's projection definitions from... what file name should I be
> looking for?
> 
> My situation is FWtools 1.0.0b2 installed on WinXP sp2
> 
> thanks for any help,
> 
> Tanya
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

From MChapman at sanz.com  Wed Jul  5 12:22:49 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D1194650651166E@mailman.san.com>

Frank,

The reason I use GPC is when I render projected maps that have a central
meridian that != 0 I have to partition the geometries that cross the new
edge of the map.  Also, I provide a clipping utility to clip small
vector sets from large datasets.  You are correct that there is really
no need other than convenience to add GPC to OGR.  I just thought it
would add some nice functionality to OGR without the overhead of GEOS.
I emailed the GPC people and they told me that all that is needed for a
commercial application is a one time donation to use it commercially.
Otherwise it's free of charge.  

Best regards,
Martin 

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] On Behalf Of Frank
Warmerdam
Sent: Tuesday, July 04, 2006 8:23 PM
To: Chapman, Martin
Cc: Alexandre Leroux; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

Chapman, Martin wrote:
  > 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library
like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source
> library is very simple to use and works great...and it's very fast.
If
> you have problems using it let me know and I will help you out.  If
> Frank W. is reading this posting I would urge him to consider
including
> GPC as part of OGR since it's small, fast, powerful, and easy to use.
> LineString and Point clipping is easy and you should be able to find
> algorithms on-line or come up with one yourself.  GPC also supports
> difference, intersection, exclusive-or and union clip operations.  The
> C++ code I use for GPC is listed below the java code.

Martin,

What reasons do/did you have to use GPC instead of GEOS?  I can imagine
it
is smaller, and faster.  As mentioned earlier GPC isn't open source, so
I would prefer to use GEOS but I wouldn't be opposed to having optional
GPC based implementation of some of the geometry operations if there was
a really substantial advantage to GPC.

Of course, using GPC outside OGR is already quite doable, so my
integration
is not required ... at most a convenience.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF,
http://osgeo.org



From MChapman at sanz.com  Wed Jul  5 12:23:43 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <ED3A48B9840E594890A2BC172D1194650651166F@mailman.san.com>

Thank you for the information Markus.  I will look into that.

Martin

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Markus Neteler
Sent: Wednesday, July 05, 2006 5:59 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

On Sun, Jul 02, 2006 at 04:18:36PM -0400, Frank Warmerdam wrote:
...
> You might want to look at options for doing this in GRASS.  I believe
it
> has some sort of layer overlay operation (perhaps done in the raster
> domain?).

You can do it both in the raster or vector domain.
Since vector was asked:
 http://grass.itc.it/grass61/manuals/html61_user/v.overlay.html
 http://grass.itc.it/grass61/manuals/html61_user/v.select.html

Operators are
    and : also known as 'intersection' in GIS
    or :  also known as 'union' in GIS (only for atype=area)
    not : features from ainput not overlayed by features from binput
    xor : features from either ainput or binput but not those from
ainput overlayed 
          by binput (only for atype=area)

As a script solution, you can put everything into a shell script which
internally launches GRASS:
- v.in.ogr: import
- v.overlay: operation
- v.out.ogr: export

For details, see
 http://grass.gdf-hannover.de/wiki/GRASS_and_Shell

Regards,

 Markus
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Wed Jul  5 12:49:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: endless loop
In-Reply-To: <ED1C24A2-2179-4EED-B431-976B5FCA5608@mac.com>
References: <9337DFE5-9FF2-4AA3-824E-1B68E23D324A@mac.com>
	<44AB209F.4020801@pobox.com>
	<D42E8CFD-CEE6-4D30-B01D-122510B5CD47@mac.com>
	<44AB3D43.2060201@pobox.com> <44AB5265.8040200@pobox.com>
	<ED1C24A2-2179-4EED-B431-976B5FCA5608@mac.com>
Message-ID: <44ABED8F.1000509@pobox.com>

Greg Coats wrote:
> I find that attempting to access http://www.gdal.org/dl places my web 
> brower in an endless loop, and accomplishes nothing useful.
> This worked for me last week.

Greg,

I've had an unfortunate problem with DNS that should be cleared up in a day
or two.  In the meantime, you can access:

   http://iweb.gdal.org/dl

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From kueda at nature.berkeley.edu  Wed Jul  5 18:43:18 2006
From: kueda at nature.berkeley.edu (Ken-ichi Ueda)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
Message-ID: <44AC4086.5080503@nature.berkeley.edu>

Hi Charlie et al.,

I just gave this another shot, this time on Ubuntu 6.06, and got exactly 
the same error:

(cd man; make install)
make[1]: Entering directory `/usr/local/src/gdal-cvs-2006.07.05/man'
/usr/local/src/gdal-cvs-2006.07.05/install-sh -d /usr/local/man/man1
for f in man1/gdaladdo.1 man1/gdal-config.1 man1/gdal_contour.1 
man1/gdalinfo.1 man1/gdal_merge.1 man1/gdal_rasterize.1 
man1/gdaltindex.1 man1/gdal_translate.1 man1/gdal_utilities.1 
man1/gdalwarp.1 man1/ogr2ogr.1 man1/ogrinfo.1 man1/ogrtindex.1 
man1/ogr_utilities.1 man1/pct2rgb.1 man1/rgb2pct.1 ; do 
/usr/local/src/gdal-cvs-2006.07.05/install-sh -c -m 0644 $f 
/usr/local/man/man1 ; done
make[1]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.05/man'
(cd swig; make install)
make[1]: Entering directory `/usr/local/src/gdal-cvs-2006.07.05/swig'
for dir in ruby ; do (cd $dir; make install ); done
make[2]: Entering directory `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
make -f RubyMakefile.mk install
make[3]: Entering directory `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
/bin/sh /usr/local/src/gdal-cvs-2006.07.05/libtool --mode=install 
/usr/local/src/gdal-cvs-2006.07.05/install-sh -c gdal.so ogr.so 
gdalconst.so osr.so /usr/local/lib/site_ruby/1.8/i486-linux/gdal
/usr/local/src/gdal-cvs-2006.07.05/install-sh -c gdal.so 
/usr/local/lib/site_ruby/1.8/i486-linux/gdal/gdal.so
install:  gdal.so does not exist
make[3]: *** [install] Error 1
make[3]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
make[2]: *** [install] Error 2
make[2]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
make[1]: *** [install] Error 2
make[1]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.05/swig'
make: *** [install-actions] Error 2


Again, it looks like gdal.so just isn't getting built.  So either I'm 
doing something dumb on OS X, Gentoo, and Ubuntu (a definite 
possibility), or there's a deeper problem.  I would definitely 
appreciate some help working through this, if you have the time.

-Ken-ichi

From mateusz at loskot.net  Wed Jul  5 19:39:43 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: GDAL Coding Guidelines
In-Reply-To: <447E04EB.20609@loskot.net>
References: <447D889A.4030607@loskot.net> <447DA6FD.9080903@pobox.com>
	<447E04EB.20609@loskot.net>
Message-ID: <44AC4DBF.6050900@loskot.net>

Hi Frank,

I'd have one more question regarding usage of C++ feaures.
Can I use C++ casting operators like static_cast, instead
of C-style casting (type)var ?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From Chris.Barker at noaa.gov  Wed Jul  5 20:14:30 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Is there a GetRasterBandasRGB?
In-Reply-To: <44ABE70E.1030408@pobox.com>
References: <44A44FDF.4030704@noaa.gov> <44ABC7EB.9020107@pobox.com>
	<44ABE0A7.2060702@noaa.gov> <44ABE70E.1030408@pobox.com>
Message-ID: <44AC55E6.8020606@noaa.gov>

Frank Warmerdam wrote:
> Christopher Barker wrote:
>> Darn. If we write such a thing in-house, would you be interested in 
>> having it contributed? For starters, we will probably only support the 
>> formats we happen to need, but with a framework in place, it should be 
>> fairly simple to support others.
> 
> Chris,
> 
> Well, I'm not sure where this would plug in.

I have no idea. I've just started playing with GDAL, and I've been doing 
it all in Python. I do have another coder working with me that is a 
C/C++ programmer that would probably actually write it.

I just found myself starting to write a base class that represents a 
raster map, and has methods for getting information about it, and one 
thing I need (because I'm using this for a mapping engine written in 
wxPython) is to be able to get a defined portion of the image as 8bit 
RGB data. So I've written two versions of a GetSubImage() method that is 
similar to ReadRaster(), excpet that it passes back the image as RGB 
data. At this point, it allocates new memeorty for it, even if the image 
is allready in that form.

Given that I'm using Python and wxPython, I end up making multiple 
copies of the data anyway, so that's not a big deal.

As I was doing this, it dawned on me that it might be a common need. 
Indeed, there could be a lot of uses where a user might not want to know 
at all about hte internal storage method of the data. Of course, I 
happen to need RBG (which is pretty common), but I suppose if you really 
wanted to be universal, you'd want to be able to pass in any of a lorge 
number of possible binary formats into a GetSubImage function, and that 
could be a LOT of code to write!

I should look at your conversion utilities to see how you do that now.

> Would it be a virtual dataset
> on top of an existing one?  Or a RasterIO_RGB() method on the dataset class
> that tries to interprete the dataset as best it can?

I think that's what I have in mind...

> In my experience, approaches start to vary a lot when you get to turning
> non-8bit data into RGB images (scaling variations and so forth).  I'm a
> bit nervous about setting a particular approach in concrete.

Well, no one would have to use it if they didn't want to, but I'm 
confused as to the complications you're referring to. If you have data 
in CMKY or something, I guess there's a trick, or 16 bit RGB, or.. but 
in on many cases, it's pretty straightforward. So far all I've needed to 
do is the palleted format in BSB maps, and colors are defined in RGB, so 
it's pretty simple.

> Nevertheless, if you were interested in doing it in a well integrated
> fashion, I think you would need to write up an RFC for the work item.
> That would give a variety of folks a chance to comment on the approach.

Good idea. What is most likely to happen is that we'd write something 
that would fill our needs, then post that for comments, and see if there 
was enough interest to work toward making it more universal.

I hope I'll be posting more about this later....

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From warmerdam at pobox.com  Wed Jul  5 22:15:29 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Is there a GetRasterBandasRGB?
In-Reply-To: <44AC55E6.8020606@noaa.gov>
References: <44A44FDF.4030704@noaa.gov> <44ABC7EB.9020107@pobox.com>
	<44ABE0A7.2060702@noaa.gov> <44ABE70E.1030408@pobox.com>
	<44AC55E6.8020606@noaa.gov>
Message-ID: <44AC7241.5020508@pobox.com>

Christopher Barker wrote:
>
>> In my experience, approaches start to vary a lot when you get to turning
>> non-8bit data into RGB images (scaling variations and so forth).  I'm a
>> bit nervous about setting a particular approach in concrete.
> 
> Well, no one would have to use it if they didn't want to, but I'm 
> confused as to the complications you're referring to. If you have data 
> in CMKY or something, I guess there's a trick, or 16 bit RGB, or.. but 
> in on many cases, it's pretty straightforward. So far all I've needed to 
> do is the palleted format in BSB maps, and colors are defined in RGB, so 
> it's pretty simple.

Christopher,

I was thinking of 16bit, floating point and other data that has no
obvious relationship to color.  Stuff like elevation, radar responses,
population density and so forth.


>> Nevertheless, if you were interested in doing it in a well integrated
>> fashion, I think you would need to write up an RFC for the work item.
>> That would give a variety of folks a chance to comment on the approach.
> 
> Good idea. What is most likely to happen is that we'd write something 
> that would fill our needs, then post that for comments, and see if there 
> was enough interest to work toward making it more universal.
> 
> I hope I'll be posting more about this later....

OK, sounds good.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From john.preston at uwimona.edu.jm  Wed Jul  5 10:13:47 2006
From: john.preston at uwimona.edu.jm (John Preston)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Using gdal_translate to translate from UInt32 to Byte
Message-ID: <1152108828.4618.16.camel@jgrass>

I'm trying to convert a tif with the following info:

Driver: GTiff/GeoTIFF
Size is 200, 200
Coordinate System is:
PROJCS["Lambert Conformal Conic | WGS 84 | Meters",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",18],
    PARAMETER["standard_parallel_2",18],
    PARAMETER["latitude_of_origin",18],
    PARAMETER["central_meridian",-77],
    PARAMETER["false_easting",750000],
    PARAMETER["false_northing",650000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (771000.000000,669000.000000)
Pixel Size = (1.00000000,-1.00000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_IMAGEDESCRIPTION=Created by GeoTiff Tiler (GUI) 1.4
  TIFFTAG_DATETIME=2002:09:20 20:21:28
  TIFFTAG_XRESOLUTION=1
  TIFFTAG_YRESOLUTION=1
  TIFFTAG_RESOLUTIONUNIT=1 (unitless)
Corner Coordinates:
Upper Left  (  771000.000,  669000.000) ( 76d48'5.46"W, 18d10'17.62"N)
Lower Left  (  771000.000,  668800.000) ( 76d48'5.47"W, 18d10'11.12"N)
Upper Right (  771200.000,  669000.000) ( 76d47'58.66"W, 18d10'17.62"N)
Lower Right (  771200.000,  668800.000) ( 76d47'58.66"W, 18d10'11.11"N)
Center      (  771100.000,  668900.000) ( 76d48'2.06"W, 18d10'14.37"N)
Band 1 Block=200x20 Type=UInt16, ColorInterp=Gray
Band 2 Block=200x20 Type=UInt16, ColorInterp=Undefined
Band 3 Block=200x20 Type=UInt16, ColorInterp=Undefined

to a standard jpeg  or png that can be viewed with any image viewer.
Each time I try gdal_translate -of JPEG xxx.tif xxx.jpg I get the
following error:

ERROR 6: JPEG driver doesn't support data type UInt16. Only eight bit
byte bands supported.

Is their any flag that I can use to read the UInt16 blocks and combine
them


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060705/41a24f31/attachment.html
From warmerdam at pobox.com  Wed Jul  5 23:03:31 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: GDAL Coding Guidelines
In-Reply-To: <44AC4DBF.6050900@loskot.net>
References: <447D889A.4030607@loskot.net>
	<447DA6FD.9080903@pobox.com>	<447E04EB.20609@loskot.net>
	<44AC4DBF.6050900@loskot.net>
Message-ID: <44AC7D83.5080908@pobox.com>

Mateusz Loskot wrote:
> Hi Frank,
> 
> I'd have one more question regarding usage of C++ feaures.
> Can I use C++ casting operators like static_cast, instead
> of C-style casting (type)var ?

Mateusz,

I don't see any problem with using static_cast.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Jean-Philippe.Gauthier at ec.gc.ca  Thu Jul  6 07:58:28 2006
From: Jean-Philippe.Gauthier at ec.gc.ca (Gauthier,Jean-Philippe [CMC])
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Cookie cutting shapefiles in OGR
Message-ID: <DC5EBDBC1F9D2E40AF4BDF9FFFA2EFDF02C57C@eccmcmail1.cmc.ec.gc.ca>


	If I may add on the GPC vs GEOS choice, since we used GPC also,

	Some of the processing we did used to take hours up to days
using GEOS and we can now do them in minutes using GPC, GEOS is very
nice and has useful other fonctionnalities but is 2 orders of magnitude
too slow.

	JP

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Chapman,
Martin
Sent: 05 July, 2006 12:23
To: Frank Warmerdam
Cc: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] Cookie cutting shapefiles in OGR


Frank,

The reason I use GPC is when I render projected maps that have a central
meridian that != 0 I have to partition the geometries that cross the new
edge of the map.  Also, I provide a clipping utility to clip small
vector sets from large datasets.  You are correct that there is really
no need other than convenience to add GPC to OGR.  I just thought it
would add some nice functionality to OGR without the overhead of GEOS. I
emailed the GPC people and they told me that all that is needed for a
commercial application is a one time donation to use it commercially.
Otherwise it's free of charge.  

Best regards,
Martin 

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] On Behalf Of Frank
Warmerdam
Sent: Tuesday, July 04, 2006 8:23 PM
To: Chapman, Martin
Cc: Alexandre Leroux; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Cookie cutting shapefiles in OGR

Chapman, Martin wrote:
  > 2.  If you actually want to clip intersecting geometries and reshape
> them to your cookie cutter geometry then you need to use a library
like
> GPC (http://www.cs.man.ac.uk/~toby/alan/software/ ).  This open source

> library is very simple to use and works great...and it's very fast.
If
> you have problems using it let me know and I will help you out.  If 
> Frank W. is reading this posting I would urge him to consider
including
> GPC as part of OGR since it's small, fast, powerful, and easy to use. 
> LineString and Point clipping is easy and you should be able to find 
> algorithms on-line or come up with one yourself.  GPC also supports 
> difference, intersection, exclusive-or and union clip operations.  The
> C++ code I use for GPC is listed below the java code.

Martin,

What reasons do/did you have to use GPC instead of GEOS?  I can imagine
it is smaller, and faster.  As mentioned earlier GPC isn't open source,
so I would prefer to use GEOS but I wouldn't be opposed to having
optional GPC based implementation of some of the geometry operations if
there was a really substantial advantage to GPC.

Of course, using GPC outside OGR is already quite doable, so my
integration is not required ... at most a convenience.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF,
http://osgeo.org


_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From sylvain_duclos at yahoo.com  Thu Jul  6 08:14:42 2006
From: sylvain_duclos at yahoo.com (s duclos)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
In-Reply-To: <44AC4086.5080503@nature.berkeley.edu>
Message-ID: <20060706121442.65633.qmail@web30705.mail.mud.yahoo.com>

Hi Ken-ichi,

Got the same problem as you!

I'm on Gentoo and the GDAL code is fron yesterday
CVS (05JUL2006).


Here is a patch that work for me:


$ cvs diff RubyMakefile.mk 
Index: RubyMakefile.mk
===================================================================
RCS file:
/cvs/maptools/cvsroot/gdal/swig/ruby/RubyMakefile.mk,v
retrieving revision 1.5
diff -r1.5 RubyMakefile.mk
44c44
< install: $(INSTALL_DIR)
---
> install: $(INSTALL_DIR) $(RUBY_MODULES)


rgds,


Sylvain.


--- Ken-ichi Ueda <kueda@nature.berkeley.edu> wrote:

> Hi Charlie et al.,
> 
> I just gave this another shot, this time on Ubuntu
> 6.06, and got exactly 
> the same error:
> 
> (cd man; make install)
> make[1]: Entering directory
> `/usr/local/src/gdal-cvs-2006.07.05/man'
> /usr/local/src/gdal-cvs-2006.07.05/install-sh -d
> /usr/local/man/man1
> for f in man1/gdaladdo.1 man1/gdal-config.1
> man1/gdal_contour.1 
> man1/gdalinfo.1 man1/gdal_merge.1
> man1/gdal_rasterize.1 
> man1/gdaltindex.1 man1/gdal_translate.1
> man1/gdal_utilities.1 
> man1/gdalwarp.1 man1/ogr2ogr.1 man1/ogrinfo.1
> man1/ogrtindex.1 
> man1/ogr_utilities.1 man1/pct2rgb.1 man1/rgb2pct.1 ;
> do 
> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c -m
> 0644 $f 
> /usr/local/man/man1 ; done
> make[1]: Leaving directory
> `/usr/local/src/gdal-cvs-2006.07.05/man'
> (cd swig; make install)
> make[1]: Entering directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig'
> for dir in ruby ; do (cd $dir; make install ); done
> make[2]: Entering directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> make -f RubyMakefile.mk install
> make[3]: Entering directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> /bin/sh /usr/local/src/gdal-cvs-2006.07.05/libtool
> --mode=install 
> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
> gdal.so ogr.so 
> gdalconst.so osr.so
> /usr/local/lib/site_ruby/1.8/i486-linux/gdal
> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
> gdal.so 
> /usr/local/lib/site_ruby/1.8/i486-linux/gdal/gdal.so
> install:  gdal.so does not exist
> make[3]: *** [install] Error 1
> make[3]: Leaving directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> make[2]: *** [install] Error 2
> make[2]: Leaving directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> make[1]: *** [install] Error 2
> make[1]: Leaving directory
> `/usr/local/src/gdal-cvs-2006.07.05/swig'
> make: *** [install-actions] Error 2
> 
> 
> Again, it looks like gdal.so just isn't getting
> built.  So either I'm 
> doing something dumb on OS X, Gentoo, and Ubuntu (a
> definite 
> possibility), or there's a deeper problem.  I would
> definitely 
> appreciate some help working through this, if you
> have the time.
> 
> -Ken-ichi
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From zhonghaiw at gmail.com  Thu Jul  6 11:45:45 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] the command tiffsplit.exe
Message-ID: <2534c4120607060845g76132d16y4fbd57419e5c3092@mail.gmail.com>

Hi Frank,

I noticed that there is a command "tiffsplit.exe" in the folder
\FWTools1.0.4\bin, I've played a little bit with this command, but I can not
realize what this really is used for. Does this command do exactly the same
things like the -co "TILED=YES" when performing the gdal commands?

I have now about 200 tifs, and each is 8750*6000 pixels, so if the tiffsplit
does the internal tile thing, it will be perfect for me.

thinks for your feedback.

best regards

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060706/e6855680/attachment.html
From warmerdam at pobox.com  Thu Jul  6 12:20:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Using gdal_translate to translate from UInt32 to Byte
In-Reply-To: <1152108828.4618.16.camel@jgrass>
References: <1152108828.4618.16.camel@jgrass>
Message-ID: <44AD385B.2060700@pobox.com>

John Preston wrote:
> Band 1 Block=200x20 Type=UInt16, ColorInterp=Gray
> Band 2 Block=200x20 Type=UInt16, ColorInterp=Undefined
> Band 3 Block=200x20 Type=UInt16, ColorInterp=Undefined
> 
> to a standard jpeg  or png that can be viewed with any image viewer. 
> Each time I try gdal_translate -of JPEG xxx.tif xxx.jpg I get the 
> following error:
> 
> ERROR 6: JPEG driver doesn't support data type UInt16. Only eight bit 
> byte bands supported.
> 
> Is their any flag that I can use to read the UInt16 blocks and combine them

John,

The "-ot Byte" flag will tell gdal_translate to convert to byte.  You will
also likely want to scale the data or else everything above 255 will be
clipped to 255.  For default scaling use:

  gdal_translate -of JPEG -scale -ot Byte xxx.tif xxx.jpg

By the way, gdal_translate options are described online in the utilities
documentation:

   http://iweb.gdal.org/gdal_translate.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Chris.Barker at noaa.gov  Thu Jul  6 12:25:02 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Is there a GetRasterBandasRGB?
In-Reply-To: <44AC7241.5020508@pobox.com>
References: <44A44FDF.4030704@noaa.gov> <44ABC7EB.9020107@pobox.com>
	<44ABE0A7.2060702@noaa.gov> <44ABE70E.1030408@pobox.com>
	<44AC55E6.8020606@noaa.gov> <44AC7241.5020508@pobox.com>
Message-ID: <44AD395E.9020403@noaa.gov>

Frank Warmerdam wrote:
> I was thinking of 16bit, floating point and other data that has no
> obvious relationship to color.  Stuff like elevation, radar responses,
> population density and so forth.

Ah!, of course, I was way to focused on my need at the moment, which is 
strictly visual maps.

I'm not much a purist, if someone tries to make an RGB image out of a 
population density raster, I don't' much care if it works or if they get 
garbage. We just need to make sure there's some error checking so it 
doesn't crash.

>> I hope I'll be posting more about this later....
> 
> OK, sounds good.

Hopefully soon I'll have something,

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From warmerdam at pobox.com  Thu Jul  6 12:33:22 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
Message-ID: <44AD3B52.4030406@pobox.com>

Folks,

I've attached a preliminary report from Daniele Romagnoli who as a Google
Summer of Code project is working on GDAL integration in Geotools and uDig.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org

-------------- next part --------------
An embedded message was scrubbed...
From: "Daniele Romagnoli" <dany.geotools@gmail.com>
Subject: [Geotools-devel] Google Summer Of Code
Date: Thu, 6 Jul 2006 18:17:27 +0200
Size: 10381
Url: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060706/b90ccf36/Geotools-develGoogleSummerOfCode.mht
From warmerdam at pobox.com  Thu Jul  6 12:36:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] the command tiffsplit.exe
In-Reply-To: <2534c4120607060845g76132d16y4fbd57419e5c3092@mail.gmail.com>
References: <2534c4120607060845g76132d16y4fbd57419e5c3092@mail.gmail.com>
Message-ID: <44AD3BF6.6010806@pobox.com>

Zhonghai Wang wrote:
> Hi Frank,
>  
> I noticed that there is a command "tiffsplit.exe" in the folder 
> \FWTools1.0.4\bin, I've played a little bit with this command, but I can 
> not realize what this really is used for. Does this command do exactly 
> the same things like the -co "TILED=YES" when performing the gdal commands?
>  
> I have now about 200 tifs, and each is 8750*6000 pixels, so if the 
> tiffsplit does the internal tile thing, it will be perfect for me.

Zhonghai,

TIFFs may contain multiple images in one file.  Often each image is a page
in a fax or something similar.  The tiffsplit program splits each image out
into a seperate file.

So, no, it won't help you in breaking images into smaller files, nor in
making them internally tiled.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Thu Jul  6 12:53:38 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <44AD3B52.4030406@pobox.com>
References: <44AD3B52.4030406@pobox.com>
Message-ID: <44AD4012.7090006@loskot.net>

Frank Warmerdam wrote:
> During the GDAL-SWIG-WINDOWS setup process I have encountered some
> difficults (during the building process) using Visual C++ Express
> Edition (and wasting a bit of time).
> Finally, I have installed Visual C++ 2003, tuned the makefile and now it
> works.

I'm interested in what problems Daniele encountered so she (forgive me
if I recognized the name incorrectly) is not able
to build with Visual C++ Express Edition.
I'm building GDAL with Visual C++ EE quite frequently without any problem.
I can give my hand to help with this.

Frank, what do you think?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Jul  6 12:55:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: GDAL Coding Guidelines
In-Reply-To: <44AC7D83.5080908@pobox.com>
References: <447D889A.4030607@loskot.net>
	<447DA6FD.9080903@pobox.com>	<447E04EB.20609@loskot.net>
	<44AC4DBF.6050900@loskot.net> <44AC7D83.5080908@pobox.com>
Message-ID: <44AD4089.9000300@loskot.net>

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Hi Frank,
>> 
>> I'd have one more question regarding usage of C++ feaures. Can I
>> use C++ casting operators like static_cast, instead of C-style
>> casting (type)var ?
> 
> Mateusz,
> 
> I don't see any problem with using static_cast.

Good, I'll use it.
This thread can be a kind of raw coding guidelines for other developers
looking such information. That's why I decided to ask my questions here.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dany.geotools at gmail.com  Thu Jul  6 13:38:55 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <44AD4012.7090006@loskot.net>
References: <44AD3B52.4030406@pobox.com> <44AD4012.7090006@loskot.net>
Message-ID: <7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>

Dear Mr Loskot,

I can quote one of the errors encountered during the building process:

------------------------------------------------------------------------------------------------------------------------

C:\gdal\frmts>cd gtiff   && nmake /NOLOGO /f makefile.vc   && cd ..
        cl /nologo /MD /EHsc /Zi /Fd..\..\gdal.pdb -I..\..\port -I..\..\ogr
-I..
\..\gcore  -I..\..\alg -Ilibtiff -Ilibgeotiff /c tifvsi.cpp
tifvsi.cpp
C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(41) : error
C2664
: '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
        Conversion from 'void*' to pointer to non-'void' requires an
explicit ca
st
C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(51) : error
C2664
: '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
        Conversion from 'void*' to pointer to non-'void' requires an
explicit ca
st
NMAKE : fatal error U1077: '"C:\Programmi\Microsoft Visual Studio
8\VC\BIN\cl.EX
E"' : return code '0x2'
-----------------------------------------------------------------------------------------------------------------------------

I dont remember how I have solved this error, but after compiling the SWIG
wrapped C++ files into DLLs using NMAKE ( makefile.vc needs a little edit),
I wasn't able to exploit the DLL from eclipse (although the
java.library.path was properly set) due to problems with the
MSVCRT80.dlllibrary.

Best Regards,
Daniele

(Daniele is an italian male name, while Daniela is a female name ^_^ )

On 7/6/06, Mateusz Loskot <mateusz@loskot.net> wrote:
>
> Frank Warmerdam wrote:
> > During the GDAL-SWIG-WINDOWS setup process I have encountered some
> > difficults (during the building process) using Visual C++ Express
> > Edition (and wasting a bit of time).
> > Finally, I have installed Visual C++ 2003, tuned the makefile and now it
>
> > works.
>
> I'm interested in what problems Daniele encountered so she (forgive me
> if I recognized the name incorrectly) is not able
> to build with Visual C++ Express Edition.
> I'm building GDAL with Visual C++ EE quite frequently without any problem.
>
> I can give my hand to help with this.
>
> Frank, what do you think?
>
> Cheers
> --
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060706/9c8bc713/attachment.html
From tchaddad at gmail.com  Thu Jul  6 13:46:09 2006
From: tchaddad at gmail.com (TC Haddad)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] help with adding a projection definition
In-Reply-To: <44ABD19C.9000207@geomega.com>
References: <25de2c7c0606301440j62104845kd02ea8c506953130@mail.gmail.com>
	<44ABD19C.9000207@geomega.com>
Message-ID: <25de2c7c0607061046r5622e6f7va21b2001c594fc99@mail.gmail.com>

thanks bryan, that did the trick,

Tanya

On 7/5/06, Bryan Keith <bryan@geomega.com> wrote:
> Tanya,
>
> In my FWtools installation I find the epsg definitions in this file:
>
> <install directory>\FWTools1.0.0b2\proj_lib\epsg
>
> <install directory> for me is c:\programs\  By default, it's probably
> c:\program files\
>
> I also don't have 4495 in that file.
>
> Hope that helps.
>
> Bryan
>
> TC Haddad wrote:
> > I'd like to use gdalwarp to reproject some large geotiffs, but
> > apparently my projection of choice EPSG:4495 is not recognized by
> > gdal.
> >
> > On a previous machine I had to edit an old version of proj4 to take
> > this EPSG code, and was successful at that time. The parameters were
> > as follows:
> >
> > # NAD83 / Oregon Lambert (Intl ft)
> > <4495> +proj=lcc +lat_1=43 +lat_2=45.5 +lat_0=41.75 +lon_0=-120.5
> > +x_0=400000.00000 +y_0=0 +ellps=GRS80 +datum=NAD83 +to_meter=0.3048
> > no_defs <>
> >
> > I'd like to do the same again, but I can't figure out where gdal is
> > getting it's projection definitions from... what file name should I be
> > looking for?
> >
> > My situation is FWtools 1.0.0b2 installed on WinXP sp2
> >
> > thanks for any help,
> >
> > Tanya
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
> >
>

From mateusz at loskot.net  Thu Jul  6 14:02:24 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>
References: <44AD3B52.4030406@pobox.com> <44AD4012.7090006@loskot.net>
	<7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>
Message-ID: <44AD5030.70705@loskot.net>

Hi Daniele,

Daniele Romagnoli wrote:
> Dear Mr Loskot,
> 
> I can quote one of the errors encountered during the building process:
> 
> ------------------------------------------------------------------------------------------------------------------------
> 
> C:\gdal\frmts>cd gtiff   && nmake /NOLOGO /f makefile.vc
> <http://makefile.vc>   && cd ..
>         cl /nologo /MD /EHsc /Zi /Fd..\..\gdal.pdb -I..\..\port
> -I..\..\ogr -I..
> \..\gcore  -I..\..\alg -Ilibtiff -Ilibgeotiff /c tifvsi.cpp
> tifvsi.cpp
> C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(41) :
> error C2664
> : '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
>         Conversion from 'void*' to pointer to non-'void' requires an
> explicit ca
> st
> C:\Programmi\Microsoft Visual Studio 8\VC\INCLUDE\swprintf.inl(51) :
> error C2664
> : '_vswprintf_c_l' : cannot convert parameter 4 from 'void *' to '_locale_t'
>         Conversion from 'void*' to pointer to non-'void' requires an
> explicit ca
> st
> NMAKE : fatal error U1077: '"C:\Programmi\Microsoft Visual Studio
> 8\VC\BIN\cl.EX
> E"' : return code '0x2'
> -----------------------------------------------------------------------------------------------------------------------------

Could you provide some details about your nmake.opt file?
Have you edited/customized this file for your needs?

> I dont remember how I have solved this error, but after compiling the
> SWIG wrapped C++ files into DLLs using NMAKE ( makefile.vc
> <http://makefile.vc> needs a little edit), I wasn't able to exploit the
> DLL from eclipse (although the java.library.path was properly set) due
> to problems with the MSVCRT80.dll library.

What you mean "problems with the MSVCRT80.dll" ?

Note, that with VC++ 2005 (no matter what edition) new policy has been
introduced, msvcrt80.dll named to msvcr80.dll etc.
So, you need to deploy all dependencies DLLs to machines you are going
to use your application/library.

See this thread:
http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=178742&SiteID=1

> 
> (Daniele is an italian male name, while Daniela is a female name ^_^ )

Forgive me my faux pas and thank you for the explanation.
BTW, Mateusz is polish male name :-)

p.s. I'd suggest to continue our discussion direcly on our e-mails,
out of the gdal-dev list.
So, please send your reply to me on mateusz@loskot.net

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Jul  6 14:33:35 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E81319A6@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E81319A6@bath.uk.rsinc.com>
Message-ID: <44AD577F.9020804@loskot.net>

Norman Barker wrote:
> Mateusz,
> 
> Can you keep me on the discussion about the Express Edition, I would be
> interested in getting it working this way (though like Daniele I have
> also upgraded to the full version of VC++).
> 
> Tomorrow I will try to post some comments on JNI, SWIG and GDAL, as
> Daniele and Simone will confirm this is something I have been looking
> into as well.

Norman,

Sure, so let's continue discussion here, on the gdal-dev list.
OK?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From nbarker at ittvis.com  Thu Jul  6 15:25:48 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E81319AA@bath.uk.rsinc.com>



-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Thursday, July 06, 2006 7:34 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]

Norman Barker wrote:
> Mateusz,
> 
> Can you keep me on the discussion about the Express Edition, I would
be
> interested in getting it working this way (though like Daniele I have
> also upgraded to the full version of VC++).
> 
> Tomorrow I will try to post some comments on JNI, SWIG and GDAL, as
> Daniele and Simone will confirm this is something I have been looking
> into as well.

Norman,

Sure, so let's continue discussion here, on the gdal-dev list.
OK?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

Thanks Mateusz,

Sorry I thought you suggested taking the previous discussion off list,
Visual C++ Express is actually quite good, and you can attach the
debugger to dlls which is perfect for Java JNI!

GDAL is stable and good software, and the SWIG binding does make it
accessible to Java, wrapping it behind ImageIO also makes sense (be
interested to see how you could make some of the creation options
available).

A typical java use case would be to use a GDAL dll in a servlet
environment (so GeoServer say), however the current implementation of
the Java classloader only allows one dll to be loaded for the whole JVM.
A single exception in GDAL or the underlying libraries in the c / c++
code will cause the JVM to exit and all users suffer :-). (do a google
on jni jvm crash)

A simple solution is to use the GDAL utility libraries and invoke them
in a separate process.  An alternative is to write a java client /
server socket scenario and invoke the server socket in a separate
process, this causes another JVM to start which is not ideal, but is
safe.

An ideal solution would be to implement a process manager in C++ as an
interface to GDAL and other libraries effectively making this JNI safe,
since this would have less overhead that starting up the JVM.

Just a couple of thoughts, quite happy to help on the SWIG / Java GDAL
development, just a bit snowed under for a couple of days.

Norman


From zhonghaiw at gmail.com  Fri Jul  7 02:39:21 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] the command tiffsplit.exe
In-Reply-To: <44AD3BF6.6010806@pobox.com>
References: <2534c4120607060845g76132d16y4fbd57419e5c3092@mail.gmail.com>
	<44AD3BF6.6010806@pobox.com>
Message-ID: <2534c4120607062339k6be4d3f1x3371907787689888@mail.gmail.com>

Frank,

thanks for your feedback, so it's not used for image tiling.

kind regards

zhonghai


On 7/6/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>
> Zhonghai Wang wrote:
> > Hi Frank,
> >
> > I noticed that there is a command "tiffsplit.exe" in the folder
> > \FWTools1.0.4\bin, I've played a little bit with this command, but I can
> > not realize what this really is used for. Does this command do exactly
> > the same things like the -co "TILED=YES" when performing the gdal
> commands?
> >
> > I have now about 200 tifs, and each is 8750*6000 pixels, so if the
> > tiffsplit does the internal tile thing, it will be perfect for me.
>
> Zhonghai,
>
> TIFFs may contain multiple images in one file.  Often each image is a page
> in a fax or something similar.  The tiffsplit program splits each image
> out
> into a seperate file.
>
> So, no, it won't help you in breaking images into smaller files, nor in
> making them internally tiled.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060707/d3e17014/attachment.html
From mateusz at loskot.net  Fri Jul  7 06:39:39 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <7221db410607061133p77775510s7984d04871955027@mail.gmail.com>
References: <44AD3B52.4030406@pobox.com> <44AD4012.7090006@loskot.net>	
	<7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>	
	<44AD5030.70705@loskot.net>
	<7221db410607061133p77775510s7984d04871955027@mail.gmail.com>
Message-ID: <44AE39EB.5070004@loskot.net>

Daniele Romagnoli wrote:
>     Could you provide some details about your nmake.opt file?
> 
> What flag or option are you interested in?

Did you set any options yourself?
Did you customized nmake.opt file?

As I understand, you can build GDAL with Visual C++ 2005 EE
but the problem is with using GDAL DLL.
Am I right?

>  
> 
>     Have you edited/customized this file for your needs?
> 
> Yes.

But GDAL builds, right?
If it does, then your settings are OK.


>     What you mean "problems with the MSVCRT80.dll" ?
> 
>     Note, that with VC++ 2005 (no matter what edition) new policy has been
>     introduced, msvcrt80.dll named to msvcr80.dll etc.
>     So, you need to deploy all dependencies DLLs to machines you are going
>     to use your application/library.
> 
> 
> 
> Mmm... I'm not expert at VC++ 2005 and I didn't know about the new
> policy. Actually I have uninstalled the VC++ 2005 and I can't try again.
> I dont remember if the problem was on the msvcrT80.dll or on msvcr80.dll. 

Hmm, so does it mean the problem disappeared?
I mean, I don't know what kind of help you needs now :-)

> Hovewer, the eclipse problem was something like "... unable to find
> msvcr80.dll"
> 

Did you try to use GDAL with Eclipse on the same machine it was built
with Visual C++ 2005 EE?
If you are getting error about missing DLL library,
then you need to check if:
1. library that is mentioned in the error message is available in the system
2. and it is available in the execution PATH, usually it mean:
- dll has to be installed to C:\Windows or C:\Windows\system
- OR the directory in which you have the missing DLL has to be added
to the PATH environment variable

Please, tell me if you need any further help, because now I'm not sure
if the problem is still present.
What kind of help do you need?

Cheers

-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Fri Jul  7 06:41:54 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E81319AA@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E81319AA@bath.uk.rsinc.com>
Message-ID: <44AE3A72.8080408@loskot.net>

Norman Barker wrote:
> Just a couple of thoughts, quite happy to help on the SWIG / Java
> GDAL development, just a bit snowed under for a couple of days.

Norman,

Unfortunately, I'm not a Java programmer so I can't help in tasks
directly related to Java.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From sy at perkins.net  Fri Jul  7 13:56:01 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <44AE39EB.5070004@loskot.net>
References: <44AD3B52.4030406@pobox.com>
	<44AD4012.7090006@loskot.net>		<7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>		<44AD5030.70705@loskot.net>	<7221db410607061133p77775510s7984d04871955027@mail.gmail.com>
	<44AE39EB.5070004@loskot.net>
Message-ID: <44AEA031.2060603@perkins.net>

Just wading in here late in the day and I missed the earlier part of 
this thread, but when you build GDAL on VS 2005, and use it in another 
project, you need to make sure you keep the gdal.dll.manifest file along 
with the gdal.dll library, in your path. Could that be the problem? For 
some obscure reason, when you build DLLs within the VS IDE, the manifest 
is embedded in the DLL, but when you build using nmake, it apepars as a 
separate file.

Cheers,

Sy


Mateusz Loskot wrote:
> Daniele Romagnoli wrote:
>   
>>     Could you provide some details about your nmake.opt file?
>>
>> What flag or option are you interested in?
>>     
>
> Did you set any options yourself?
> Did you customized nmake.opt file?
>
> As I understand, you can build GDAL with Visual C++ 2005 EE
> but the problem is with using GDAL DLL.
> Am I right?
>
>   
>>  
>>
>>     Have you edited/customized this file for your needs?
>>
>> Yes.
>>     
>
> But GDAL builds, right?
> If it does, then your settings are OK.
>
>
>   
>>     What you mean "problems with the MSVCRT80.dll" ?
>>
>>     Note, that with VC++ 2005 (no matter what edition) new policy has been
>>     introduced, msvcrt80.dll named to msvcr80.dll etc.
>>     So, you need to deploy all dependencies DLLs to machines you are going
>>     to use your application/library.
>>
>>
>>
>> Mmm... I'm not expert at VC++ 2005 and I didn't know about the new
>> policy. Actually I have uninstalled the VC++ 2005 and I can't try again.
>> I dont remember if the problem was on the msvcrT80.dll or on msvcr80.dll. 
>>     
>
> Hmm, so does it mean the problem disappeared?
> I mean, I don't know what kind of help you needs now :-)
>
>   
>> Hovewer, the eclipse problem was something like "... unable to find
>> msvcr80.dll"
>>
>>     
>
> Did you try to use GDAL with Eclipse on the same machine it was built
> with Visual C++ 2005 EE?
> If you are getting error about missing DLL library,
> then you need to check if:
> 1. library that is mentioned in the error message is available in the system
> 2. and it is available in the execution PATH, usually it mean:
> - dll has to be installed to C:\Windows or C:\Windows\system
> - OR the directory in which you have the missing DLL has to be added
> to the PATH environment variable
>
> Please, tell me if you need any further help, because now I'm not sure
> if the problem is still present.
> What kind of help do you need?
>
> Cheers
>
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060707/67ea8c2c/attachment.html
From warmerdam at pobox.com  Fri Jul  7 16:20:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] FWTools 1.0.5 Released
Message-ID: <44AEC205.4030600@pobox.com>

Folks,

I have prepared FWTools 1.0.5 binaries for Windows and Linux.  In addition
to the usual bug fixes and new features tracked from CVS, I have also:

  o Updated to GEOS 3.0.0rc1
  o Enabled GEOS support in MapServer (as well as OGR).
  o Enabled MrSID support (on Windows) by default, as opposed to as a plugin.

Due to a DNS glitch, the downloads should be at:

   http://iweb.gdal.org/dl/fwtools/FWTools105.exe             (Windows)
   http://iweb.gdal.org/dl/fwtools/FWTools-linux-1.0.5.tar.gz (Linux)

I hope to include MrSID support in the Linux builds in the future too, but
I didn't feel up to trying to deal with the gcc version issues this implies
at this time.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jul  7 16:30:20 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] inconsistent "worldfile=on" options
In-Reply-To: <44A57303.1070509@gov.yk.ca>
References: <44A57303.1070509@gov.yk.ca>
Message-ID: <44AEC45C.9010604@pobox.com>

Matt Wilkie wrote:
> Hi All,
> 
> Is there a particular reason why gdal_translate support "-co 
> worldfile=on" for jp2 jasper and jp2 mrsid but not jp2 ecw or kakadu?
> Or why png uses "-co worldfile=yes" instead of "on"?
> And the one I'm most curious about, why there isn't a global 
> worldile=yes option for all formats?

Matt,

I'm afraid there isn't that much rhyme or reason to worldfile handling in
GDAL.  It is basically added on a driver by driver basis, and no always
consistently.   Most WORLDFILE parameter checks should be using
CSLFetchBoolean() which would honour ON, TRUE, 1, or YES as valid positive
values.  I checked, and it seems the PNG driver should honour them all.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From doug.coward at 21csi.com  Fri Jul  7 17:08:16 2006
From: doug.coward at 21csi.com (Douglas Coward)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Question about retreving a image from a geodatabase
Message-ID: <WorldClient-F200607071608.AA08163081@21csi.com>

I'm sorry,
 I know this is a pretty fundamental question to ask on this list, but I 
need to ask anyway.
 I am trying to understand geodatabases and how to build an application to 
work with one. I have search the Web and read books like Web Mapping 
Illustrated.  I am famillar with using the GDAL libraries in an application 
to load a GeoTIFF image, I have used the utilities like GDAL_translate in a 
command line interface and I am very famillar with Shapefiles.
  But I still don't understand the interaction of a C++ windows application 
retreving a raster image
from a geodatabase and the role of the GDAL/OGR libraries in this kind of 
exchange.

  My question is can anyone give me an example of the queries and the 
responses when a 
visualization application starts with a geographical rectangle and wants to 
query a PostGIS database for a raster image trimmed to fit that rectangle 
and how the image is returned to the application ready to be displayed?
   Being more specific....
  Is a raster image, like a landsat image, actually stored in the database, 
or is the image stored local to application and represented in the database 
by a bounding rectangle and the local filename?
  What happens when the queried rectangle overlaps more than one database 
image? How are the pieces composited together into one image?
  My only assumption right now is that the process begins with the 
application sending an SQL query through OGR to the PostGIS libraries for 
the rectangle in question. Beyond that I'm lost.
 
  Any replies will be appreciated. And if there is a link to a nuts and 
bolts kind of tutorial, I would very much appreciate that also.
 Thank you for your time.
  --Doug
 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060707/74189f0b/attachment.html
From mateusz at loskot.net  Fri Jul  7 17:09:12 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <44AEA031.2060603@perkins.net>
References: <44AD3B52.4030406@pobox.com>
	<44AD4012.7090006@loskot.net>		<7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>		<44AD5030.70705@loskot.net>	<7221db410607061133p77775510s7984d04871955027@mail.gmail.com>
	<44AE39EB.5070004@loskot.net> <44AEA031.2060603@perkins.net>
Message-ID: <44AECD78.8030302@loskot.net>

Simon Perkins wrote:
> Just wading in here late in the day and I missed the earlier part of
> this thread, but when you build GDAL on VS 2005, and use it in another
> project, you need to make sure you keep the gdal.dll.manifest file along
> with the gdal.dll library, in your path. Could that be the problem? For
> some obscure reason, when you build DLLs within the VS IDE, the manifest
> is embedded in the DLL, but when you build using nmake, it apepars as a
> separate file.

Yes, you're right.
Manifest can be embedded or generated as a separate file but it's required.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From rkanne at ara.com  Fri Jul  7 09:47:43 2006
From: rkanne at ara.com (Roy Kanne ARA/SED)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Texture mapping on multipatches in shapefiles?
Message-ID: <B3CB5AFD4126584AB4CF3DD45B267A53022E6A79@thorin.ara.wan>

I am investigating whether it is possible to add textures to shapefiles
so that they are mapped to the surfaces of multipatches. I have been
doing this for layer files exported using the ArcGIS API, but I would
like to use GDAL to export 3D shapes with textures into shapefiles.

 

Thanks,

Roy K

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060707/f1deb9a6/attachment.html
From chantain.c.greer at hotmail.com  Fri Jul  7 13:46:00 2006
From: chantain.c.greer at hotmail.com (chantain greer)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] gdalwarp and gdal_translate question
Message-ID: <BAY101-F134590B5447ABA58A7DE6EDD740@phx.gbl>

Hi,
I wanted to ask is there a techniqal difference between the way gdalwarp and 
gdal_translate scales the resolution of a file in pixels.

gdalwarp uses the -ts option to set output file size in pixels and lines but 
gdal_translate uses -outsize to set the size of the output file.

I wanted to find out if the output file would be the same if you used either 
technique.
Thank you.



From dany.geotools at gmail.com  Fri Jul  7 17:28:46 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] [Fwd: [Geotools-devel] Google Summer Of Code]
In-Reply-To: <44AEA031.2060603@perkins.net>
References: <44AD3B52.4030406@pobox.com> <44AD4012.7090006@loskot.net>
	<7221db410607061038r5f42239do1bfa3178815d3736@mail.gmail.com>
	<44AD5030.70705@loskot.net>
	<7221db410607061133p77775510s7984d04871955027@mail.gmail.com>
	<44AE39EB.5070004@loskot.net> <44AEA031.2060603@perkins.net>
Message-ID: <7221db410607071428q37fbb767jb9ec9beedffcb3cb@mail.gmail.com>

Hi Simon

On 7/7/06, Simon Perkins <sy@perkins.net> wrote:
>
>  Just wading in here late in the day and I missed the earlier part of this
> thread, but when you build GDAL on VS 2005, and use it in another project,
> you need to make sure you keep the gdal.dll.manifest file along with the
> gdal.dll library, in your path.
>

I did it :)

Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060707/9ebb6e08/attachment.html
From warmerdam at pobox.com  Fri Jul  7 21:57:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] gdalwarp and gdal_translate question
In-Reply-To: <BAY101-F134590B5447ABA58A7DE6EDD740@phx.gbl>
References: <BAY101-F134590B5447ABA58A7DE6EDD740@phx.gbl>
Message-ID: <44AF10F4.4040700@pobox.com>

chantain greer wrote:
> Hi,
> I wanted to ask is there a techniqal difference between the way gdalwarp 
> and gdal_translate scales the resolution of a file in pixels.
> 
> gdalwarp uses the -ts option to set output file size in pixels and lines 
> but gdal_translate uses -outsize to set the size of the output file.
> 
> I wanted to find out if the output file would be the same if you used 
> either technique.

Chantain,

In theory gdalwarp with the nearest neighbour resampling (the default)
should give similar results to gdal_translate when doing downsampling.
In practice there might be an "off by one" issue that would result in
picking different pixels for the downsampling.  Basically gdalwarp
tries to be very precise about all the sampling while gdal_translate
tries to be fast and a bit careless of the details when changing
resolution.

Note that only gdalwarp includes other resampling kernels like
bilinear and bicubic.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Fri Jul  7 21:58:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Question about retreving a image from a geodatabase
In-Reply-To: <WorldClient-F200607071608.AA08163081@21csi.com>
References: <WorldClient-F200607071608.AA08163081@21csi.com>
Message-ID: <44AF1130.8010906@pobox.com>

Douglas Coward wrote:
...
>   My question is can anyone give me an example of the queries and the 
> responses when a
> visualization application starts with a geographical rectangle and wants 
> to query a PostGIS database for a raster image trimmed to fit that 
> rectangle and how the image is returned to the application ready to be 
> displayed?
>    Being more specific....
>   Is a raster image, like a landsat image, actually stored in the 
> database, or is the image stored local to application and represented in 
> the database by a bounding rectangle and the local filename?
>   What happens when the queried rectangle overlaps more than one 
> database image? How are the pieces composited together into one image?
>   My only assumption right now is that the process begins with the 
> application sending an SQL query through OGR to the PostGIS libraries 
> for the rectangle in question. Beyond that I'm lost.

Douglas,

GDAL does not support rasters in Postgres or an ArcGIS Personal Geodatabase.
So I can't provide examples.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From josegomez at gmx.net  Sat Jul  8 12:52:38 2006
From: josegomez at gmx.net (Jose Luis Gomez Dans)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Resampling rasters with GDAL
Message-ID: <20060708165238.213580@gmx.net>

Hi!
This is a basic question, but I am getting confused. I have a number of raster masks (integer values) that I want to apply to some other different images. To do this, I require the images to have the same extent and resolution, as well as being in the same projection. Normally, the images are bit offset due to acquisition issues, and do not cover the same extent, whereas my masks cover a larger area to be able to deal with this.

What I want to do is to produce a new raster (derived from my original masks) that can be applied in a pixel-by-pixel basis, to the images. Usually, projection is not a problem (we always use the same), and resolution is no issue. However, the extent and required resampling (using nearest neighbour) is a problem. I have tried to use gdal_translate or gdalwarp, but it is not obvious to get the target's extent for the resampling (it is in meters, not pixels). With gdalwarp, there's the "-te" option, but it doesn't produce the results I want.

Also, in some cases, the images might have an extent which is larger than that of the masks. Apart from "cutting" the excess in the images, it would be nice to avoid this step, and to produce a resampled mask with all those pixels outside the original mask's extent set to NODATA. As I understand it, GDAL cannot do this.

So what is the best way to automatically produce these masks using either the GDAL tools or the library?

Any pointers welcomed!
Thanks!
Jose
-- 


"Feel free" ? 10 GB Mailbox, 100 FreeSMS/Monat ...
Jetzt GMX TopMail testen: http://www.gmx.net/de/go/topmail

From warmerdam at pobox.com  Sat Jul  8 14:29:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Resampling rasters with GDAL
In-Reply-To: <20060708165238.213580@gmx.net>
References: <20060708165238.213580@gmx.net>
Message-ID: <44AFF998.609@pobox.com>

Jose Luis Gomez Dans wrote:
...
> What I want to do is to produce a new raster (derived from my original
> masks) that can be applied in a pixel-by-pixel basis, to the images.
> Usually, projection is not a problem (we always use the same), and
> resolution is no issue. However, the extent and required resampling (using
> nearest neighbour) is a problem. I have tried to use gdal_translate or
> gdalwarp, but it is not obvious to get the target's extent for the
> resampling (it is in meters, not pixels). With gdalwarp, there's the "-te"
> option, but it doesn't produce the results I want.

Jose,

Can you indicate in what regard -te doesn't do what you want?

> Also, in some cases, the images might have an extent which is larger than
> that of the masks. Apart from "cutting" the excess in the images, it would
> be nice to avoid this step, and to produce a resampled mask with all those
> pixels outside the original mask's extent set to NODATA. As I understand
> it, GDAL cannot do this.

If you use the -dstnodata flag with gdalwarp, and -te to set extents larger
than the source mask (to match your target image) it should be possible
to produce a ready to use result, with nodata set in the regions not available
from the source mask.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Sat Jul  8 14:51:55 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Texture mapping on multipatches in shapefiles?
In-Reply-To: <B3CB5AFD4126584AB4CF3DD45B267A53022E6A79@thorin.ara.wan>
References: <B3CB5AFD4126584AB4CF3DD45B267A53022E6A79@thorin.ara.wan>
Message-ID: <44AFFECB.2030902@pobox.com>

Roy Kanne ARA/SED wrote:
> I am investigating whether it is possible to add textures to shapefiles 
> so that they are mapped to the surfaces of multipatches. I have been 
> doing this for layer files exported using the ArcGIS API, but I would 
> like to use GDAL to export 3D shapes with textures into shapefiles.

Roy,

I don't know what ArcGIS does to represent textures on multipatches.  But
if you could provide a modest sized example of what the results are like
I might be able to provide suggestions on how it could be accomplished with
GDAL and OGR.  However, there is nothing specific in GDAL/OGR to handle this
now so you would definately end up having to do some sort of customization.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From sylvain_duclos at yahoo.com  Sun Jul  9 07:10:44 2006
From: sylvain_duclos at yahoo.com (s duclos)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
In-Reply-To: <1185ABAF-643F-4FC6-A6DF-97A92E8D990E@nature.berkeley.edu>
Message-ID: <20060709111044.36389.qmail@web30714.mail.mud.yahoo.com>

Hi,

I don't have osX here but from what I gather you could
try -dynamic instead or else no flags at all since
gcc will default to that any way.

Build it by hand and then restart the make so that
the build process can finish its job ..


Sorry if this sound like shoting in the dark :/


best luck !


Sylvain.



--- Ken-ichi Ueda <kenichi.ueda@gmail.com> wrote:

> Cool, thanks Sylvain.  I can confirm that this fixes
> the problem in  
> Gentoo.  However, in Mac OS X I'm encountering a
> different, and  
> probably unrelated problem upon make install:
> 
> g++ -shared gdal_wrap.o -o .libs/gdal.so
> -Wl,-bind_at_load  -L/usr/ 
> darwinports/lib -L/usr/local/src/gdal-1.3.2
> /usr/local/src/ 
> gdal-1.3.2/.libs/libgdal.dylib -lz -ldl -lruby
> powerpc-apple-darwin8-g++-4.0.0: unrecognized option
> '-shared'
> /usr/bin/ld: Undefined symbols:
> _main
> collect2: ld returned 1 exit status
> make[3]: *** [gdal.so] Error 1
> make[2]: *** [install] Error 2
> make[1]: *** [install] Error 2
> make: *** [install-actions] Error 2
> 
> 
> Any thoughts?
> 
> -Ken-ichi
> 
> 
> 
> On Jul 6, 2006, at 5:14 AM, s duclos wrote:
> 
> > Hi Ken-ichi,
> >
> > Got the same problem as you!
> >
> > I'm on Gentoo and the GDAL code is fron yesterday
> > CVS (05JUL2006).
> >
> >
> > Here is a patch that work for me:
> >
> >
> > $ cvs diff RubyMakefile.mk
> > Index: RubyMakefile.mk
> >
>
===================================================================
> > RCS file:
> >
>
/cvs/maptools/cvsroot/gdal/swig/ruby/RubyMakefile.mk,v
> > retrieving revision 1.5
> > diff -r1.5 RubyMakefile.mk
> > 44c44
> > < install: $(INSTALL_DIR)
> > ---
> >> install: $(INSTALL_DIR) $(RUBY_MODULES)
> >
> >
> > rgds,
> >
> >
> > Sylvain.
> >
> >
> > --- Ken-ichi Ueda <kueda@nature.berkeley.edu>
> wrote:
> >
> >> Hi Charlie et al.,
> >>
> >> I just gave this another shot, this time on
> Ubuntu
> >> 6.06, and got exactly
> >> the same error:
> >>
> >> (cd man; make install)
> >> make[1]: Entering directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/man'
> >> /usr/local/src/gdal-cvs-2006.07.05/install-sh -d
> >> /usr/local/man/man1
> >> for f in man1/gdaladdo.1 man1/gdal-config.1
> >> man1/gdal_contour.1
> >> man1/gdalinfo.1 man1/gdal_merge.1
> >> man1/gdal_rasterize.1
> >> man1/gdaltindex.1 man1/gdal_translate.1
> >> man1/gdal_utilities.1
> >> man1/gdalwarp.1 man1/ogr2ogr.1 man1/ogrinfo.1
> >> man1/ogrtindex.1
> >> man1/ogr_utilities.1 man1/pct2rgb.1
> man1/rgb2pct.1 ;
> >> do
> >> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
> -m
> >> 0644 $f
> >> /usr/local/man/man1 ; done
> >> make[1]: Leaving directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/man'
> >> (cd swig; make install)
> >> make[1]: Entering directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig'
> >> for dir in ruby ; do (cd $dir; make install );
> done
> >> make[2]: Entering directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> >> make -f RubyMakefile.mk install
> >> make[3]: Entering directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> >> /bin/sh
> /usr/local/src/gdal-cvs-2006.07.05/libtool
> >> --mode=install
> >> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
> >> gdal.so ogr.so
> >> gdalconst.so osr.so
> >> /usr/local/lib/site_ruby/1.8/i486-linux/gdal
> >> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
> >> gdal.so
> >>
> /usr/local/lib/site_ruby/1.8/i486-linux/gdal/gdal.so
> >> install:  gdal.so does not exist
> >> make[3]: *** [install] Error 1
> >> make[3]: Leaving directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> >> make[2]: *** [install] Error 2
> >> make[2]: Leaving directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
> >> make[1]: *** [install] Error 2
> >> make[1]: Leaving directory
> >> `/usr/local/src/gdal-cvs-2006.07.05/swig'
> >> make: *** [install-actions] Error 2
> >>
> >>
> >> Again, it looks like gdal.so just isn't getting
> >> built.  So either I'm
> >> doing something dumb on OS X, Gentoo, and Ubuntu
> (a
> >> definite
> >> possibility), or there's a deeper problem.  I
> would
> >> definitely
> >> appreciate some help working through this, if you
> >> have the time.
> >>
> >> -Ken-ichi
> >> _______________________________________________
> >> Gdal-dev mailing list
> >> Gdal-dev@lists.maptools.org
> >>
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> >>
> >
> >
> > __________________________________________________
> > Do You Yahoo!?
> > Tired of spam?  Yahoo! Mail has the best spam
> protection around
> > http://mail.yahoo.com
> 
> 


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From gdal-dev at ostertag.name  Sun Jul  9 08:42:14 2006
From: gdal-dev at ostertag.name (Joerg Ostertag)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] symlinks in debian package
Message-ID: <200607091442.15334.gdal-dev@ostertag.name>

Hi,

I'm just trying to compile gpsdrive and link it against gdal. In the 
Makefile.am (of gpsdrive) there currently is a dependency against gdal1.3.1.l 
But I get some complaints from gpsdrive-users which only have gdal (debian 
stable i think) installed. So my Idea was to change the dependency to gdal 
and have a symlink to always point to the most recent version of gdal.
Does anyone see a chance that the gdal-debian packages can contain these 
links?


-- 
Joerg

http://www.ostertag.name/

From tutey at o2.pl  Sun Jul  9 12:36:44 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
Message-ID: <20060709183644.2ab42014@sorbus>

Hi,

Today's (2006.07.09) GDAL CVS fails to build at ogrinfo.

Ubuntu Dapper (6.06 LTS)

$ geos-config --version
2.2.3

$ g++ --version
g++ (GCC) 4.0.3 (Ubuntu 4.0.3-1ubuntu5)

./configure --with-hdf4=/usr/local/lib --with-libz=internal
--with-png=internal --with-libtiff=internal --with-geotiff=internal
--with-jpeg=internal --with-gif=internal --with-geos=yes
--with-pg=/usr/bin/pg_config --with-sqlite



GDAL's last words:

g++ ogrinfo.o
-o .libs/ogrinfo  /home/shoofi/src/straight/gdal/.libs/libgdal.so
-L/usr/local//lib -L/usr/local/lib -lmfhdf -ldf -L/usr/lib -lpq -lrt
-ldl -lpthread -Wl,--rpath
-Wl,/usr/local//lib /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSBoundary' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSCrosses' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSConvexHull' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSOverlaps' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSGetCentroid' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSDistance' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSDifference' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSWithin' /home/shoofi/src/straight/gdal/.libs/libgdal.so: undefined
reference to
`GEOSIntersects' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`initGEOS' /home/shoofi/src/straight/gdal/.libs/libgdal.so: undefined
reference to
`GEOSGeomToWKB_buf' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSIntersection' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSTouches' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSSymDifference' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSGeom_destroy' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSGeomFromWKB_buf' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to
`GEOSBuffer' /home/shoofi/src/straight/gdal/.libs/libgdal.so: undefined
reference to
`GEOSUnion' /home/shoofi/src/straight/gdal/.libs/libgdal.so: undefined
reference to
`GEOSContains' /home/shoofi/src/straight/gdal/.libs/libgdal.so:
undefined reference to `GEOSDisjoint' collect2: ld returned 1 exit
status make[1]: *** [ogrinfo] B??d 1 make[1]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr' make: *** [ogr-apps] B??d 2

Maciek

From parrott.sarah at googlemail.com  Sun Jul  9 14:26:48 2006
From: parrott.sarah at googlemail.com (Sarah Parrott)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] cannot make gdal - built in delete error
Message-ID: <23c59e280607091126m4fdf9233h6cc635bc1537b9e5@mail.gmail.com>

Hi,

 I had gdal installed fine last week, but now I want to add support for
mysql.

I used ./configure
--with-mysql=/usr/local/mysql-standard-5.0.22-linux-i686/bin/mysql_config
and that was fine.

When I issue make, I get errors. This is the end of the output from make:

g++ ogrinfo.o -o .libs/ogrinfo  /usr/local/gdal-1.3.2/.libs/libgdal.so -lpng
-lrt -ldl -L/usr/local/lib -L/usr/local/mysql-standard-5.0.22-linux-i686/lib
-lmysqlclient -lz -lcrypt -lnsl -lnss_files -lnss_dns -lresolv
/usr/local/gdal-1.3.2/.libs/libgdal.so: undefined reference to
`__builtin_delete'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/usr/local/gdal-1.3.2/ogr'
make: *** [ogr-apps] Error 2

After this I tried deleted everyting gdal and ogr related from usr/local/bin
but got the same result. I also tried doing make clean first but again the
same error.

The only thing I changed for this install was the mysql stuff.

Can anyone tell me what this error means?

Thanks,
Sparrott
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060709/f61c66fc/attachment.html
From mateusz at loskot.net  Sun Jul  9 18:07:00 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <20060709183644.2ab42014@sorbus>
References: <20060709183644.2ab42014@sorbus>
Message-ID: <44B17E04.9050400@loskot.net>

Maciej Sieczka wrote:
> Hi,
> 
> Today's (2006.07.09) GDAL CVS fails to build at ogrinfo.
> 
> Ubuntu Dapper (6.06 LTS)
> 
> $ geos-config --version
> 2.2.3
> 
> $ g++ --version
> g++ (GCC) 4.0.3 (Ubuntu 4.0.3-1ubuntu5)
> 
> ./configure --with-hdf4=/usr/local/lib --with-libz=internal
> --with-png=internal --with-libtiff=internal --with-geotiff=internal
> --with-jpeg=internal --with-gif=internal --with-geos=yes
> --with-pg=/usr/bin/pg_config --with-sqlite
> 
> [...]

FYI, recently, OGR has been ported to GEOS C API, so GEOS >= 2.2.0
version is required.

Please, try to pass complete path to geos-config in
--with-geos=/path/to/geos-config
instead of giving simple yes.

Maybe ./configure is finding old geos-config somewhere in your filesystem.

I'm building GDAL a few times a day and it works.

If full path to geos-config won't help, please give me a note
because I'm supposed to fix this bug ;-) as I ported OGR to GEOS C API.

cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From sieczka at biol.uni.wroc.pl  Sun Jul  9 19:44:45 2006
From: sieczka at biol.uni.wroc.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B17E04.9050400@loskot.net>
References: <20060709183644.2ab42014@sorbus>
	<44B17E04.9050400@loskot.net>
Message-ID: <20060710014445.6a029645@sorbus>

Dnia Mon, 10 Jul 2006 00:07:00 +0200
Mateusz Loskot <mateusz@loskot.net> napisa?(a):

> Maciej Sieczka wrote:

> > Today's (2006.07.09) GDAL CVS fails to build at ogrinfo.
> > 
> > Ubuntu Dapper (6.06 LTS)
> > 
> > $ geos-config --version
> > 2.2.3
> > 
> > $ g++ --version
> > g++ (GCC) 4.0.3 (Ubuntu 4.0.3-1ubuntu5)
> > 
> > ./configure --with-hdf4=/usr/local/lib --with-libz=internal
> > --with-png=internal --with-libtiff=internal --with-geotiff=internal
> > --with-jpeg=internal --with-gif=internal --with-geos=yes
> > --with-pg=/usr/bin/pg_config --with-sqlite
> > 
> > [...]
 
> FYI, recently, OGR has been ported to GEOS C API, so GEOS >= 2.2.0
> version is required.

I'm using 2.2.3 here, as you can read above.

> Please, try to pass complete path to geos-config in
> --with-geos=/path/to/geos-config
> instead of giving simple yes.

Done. No avail. Fails at the same stage.

> Maybe ./configure is finding old geos-config somewhere in your
> filesystem.

I don't think it is possible. I only had 2.1.4 from Dapper's
universe repo installed for a while, but I uninstalled and purged it
before building and installing 2.2.3 from source.

See:

$ which geos-config
/usr/local/bin/geos-config

$ geos-config --version
2.2.3

> I'm building GDAL a few times a day and it works.

For a test, I purged 2.2.3 and installed Dapper's 2.1.4 back. Now GDAL
build fails too.

For "--with-geos=yes":

g++ -Wall -O2 -Iogrsf_frmts -I. -I/home/shoofi/src/straight/gdal/port
-I/home/shoofi/src/straight/gdal/gcore
-I/home/shoofi/src/straight/gdal/alg
-I/home/shoofi/src/straight/gdal/ogr
-I/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1
-I/usr/include -DOGR_ENABLED -I/home/shoofi/src/straight/gdal/port -c
ogrgeometryfactory.cpp  -fPIC -DPIC -o .libs/ogrgeometryfactory.o In
file included from ogrgeometryfactory.cpp:130: ogr_geos.h:48:22: error:
geos_c.h: No such file or directory ogrgeometryfactory.cpp: In static
member function 'static OGRGeometry*
OGRGeometryFactory::createFromGEOS(GEOSGeom_t*)':
ogrgeometryfactory.cpp:843: error: 'GEOSGeomToWKB_buf' was not declared
in this scope make[1]: *** [ogrgeometryfactory.o] B??d 1 make[1]:
Opuszczenie katalogu `/home/shoofi/src/straight/gdal/ogr' make: ***
[ogr-target] B??d 2



And for "--with-geos=/usr/bin/geos-config":

g++ -Wall -O2 -I/home/shoofi/src/straight/gdal/port
-I/home/shoofi/src/straight/gdal/gcore
-I/home/shoofi/src/straight/gdal/alg
-I/home/shoofi/src/straight/gdal/ogr
-I/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts -I -DOGR_ENABLED
-I/home/shoofi/src/straight/gdal/port -c ogrpgdriver.cpp  -fPIC -DPIC
-o ../o/.libs/ogrpgdriver.o In file included from ogrpgdriver.cpp:48:
ogr_pg.h:126:22: error: libpq-fe.h: No such file or directory
ogr_pg.h:152: error: 'Oid' does not name a type ogr_pg.h:153: error:
expected ';' before '(' token ogr_pg.h:160: error: ISO C++ forbids
declaration of 'PGresult' with no type ogr_pg.h:160: error: expected
';' before '*' token ogr_pg.h:276: error: ISO C++ forbids declaration
of 'PGresult' with no type ogr_pg.h:276: error: expected ';' before '*'
token ogr_pg.h:283: error: 'PGresult' has not been declared
ogr_pg.h:317: error: ISO C++ forbids declaration of 'PGconn' with no
type ogr_pg.h:317: error: expected ';' before '*' token ogr_pg.h:321:
error: 'Oid' does not name a type ogr_pg.h:340: error: ISO C++ forbids
declaration of 'PGconn' with no type ogr_pg.h:340: error: expected ';'
before '*' token ogr_pg.h:342: error: expected `;' before 'int'
ogr_pg.h:367: error: 'Oid' does not name a type make[3]: ***
[../o/ogrpgdriver.o] B??d 1 make[3]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts/pg' make[2]: ***
[pg-target] B??d 2 make[2]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts' make[1]: *** [sublibs]
B??d 2 make[1]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr' make: *** [ogr-target] B??d 2



I *did* remember to "make distclean" before rebuilding, if you are
going to ask :).

Updating GDAL from CVS doesn't make any difference (there were no
changes in CVS since my problem begun).  What GEOS version are you
using? I tend to use latest stable (which is 2.2.3 now), when I'm not
following a given software development closer (while for those which I
follow more closely I prefer latest and gratest from CVS, eg. GDAL or
GRASS). What version of GEOS would you recommend for current GDAL CVS?

Best,
Maciek

From tutey at o2.pl  Sun Jul  9 20:05:33 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B17E04.9050400@loskot.net>
References: <20060709183644.2ab42014@sorbus>
	<44B17E04.9050400@loskot.net>
Message-ID: <20060710020533.3f5428a8@sorbus>

Dnia Mon, 10 Jul 2006 00:07:00 +0200
Mateusz Loskot <mateusz@loskot.net> napisa?(a):

> Maciej Sieczka wrote:

> > Today's (2006.07.09) GDAL CVS fails to build at ogrinfo.
> > 
> > Ubuntu Dapper (6.06 LTS)
> > 
> > $ geos-config --version
> > 2.2.3
> > 
> > $ g++ --version
> > g++ (GCC) 4.0.3 (Ubuntu 4.0.3-1ubuntu5)
> > 
> > ./configure --with-hdf4=/usr/local/lib --with-libz=internal
> > --with-png=internal --with-libtiff=internal --with-geotiff=internal
> > --with-jpeg=internal --with-gif=internal --with-geos=yes
> > --with-pg=/usr/bin/pg_config --with-sqlite
> > 
> > [...]
 
> FYI, recently, OGR has been ported to GEOS C API, so GEOS >= 2.2.0
> version is required.

I'm using 2.2.3 here, as you can read above.

> Please, try to pass complete path to geos-config in
> --with-geos=/path/to/geos-config
> instead of giving simple yes.

Done. No avail. Fails at the same stage.

> Maybe ./configure is finding old geos-config somewhere in your
> filesystem.

I don't think it is possible. I only had 2.1.4 from Dapper's
universe repo installed for a while, but I uninstalled and purged it
before building and installing 2.2.3 from source.

See:

$ which geos-config
/usr/local/bin/geos-config

$ geos-config --version
2.2.3

> I'm building GDAL a few times a day and it works.

For a test, I purged 2.2.3 and installed Dapper's 2.1.4 back. Now GDAL
build fails too.

For "--with-geos=yes":

g++ -Wall -O2 -Iogrsf_frmts -I. -I/home/shoofi/src/straight/gdal/port
-I/home/shoofi/src/straight/gdal/gcore
-I/home/shoofi/src/straight/gdal/alg
-I/home/shoofi/src/straight/gdal/ogr
-I/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1
-I/usr/include -DOGR_ENABLED -I/home/shoofi/src/straight/gdal/port -c
ogrgeometryfactory.cpp  -fPIC -DPIC -o .libs/ogrgeometryfactory.o In
file included from ogrgeometryfactory.cpp:130: ogr_geos.h:48:22: error:
geos_c.h: No such file or directory ogrgeometryfactory.cpp: In static
member function 'static OGRGeometry*
OGRGeometryFactory::createFromGEOS(GEOSGeom_t*)':
ogrgeometryfactory.cpp:843: error: 'GEOSGeomToWKB_buf' was not declared
in this scope make[1]: *** [ogrgeometryfactory.o] B??d 1 make[1]:
Opuszczenie katalogu `/home/shoofi/src/straight/gdal/ogr' make: ***
[ogr-target] B??d 2



And for "--with-geos=/usr/bin/geos-config":

g++ -Wall -O2 -I/home/shoofi/src/straight/gdal/port
-I/home/shoofi/src/straight/gdal/gcore
-I/home/shoofi/src/straight/gdal/alg
-I/home/shoofi/src/straight/gdal/ogr
-I/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts -I -DOGR_ENABLED
-I/home/shoofi/src/straight/gdal/port -c ogrpgdriver.cpp  -fPIC -DPIC
-o ../o/.libs/ogrpgdriver.o In file included from ogrpgdriver.cpp:48:
ogr_pg.h:126:22: error: libpq-fe.h: No such file or directory
ogr_pg.h:152: error: 'Oid' does not name a type ogr_pg.h:153: error:
expected ';' before '(' token ogr_pg.h:160: error: ISO C++ forbids
declaration of 'PGresult' with no type ogr_pg.h:160: error: expected
';' before '*' token ogr_pg.h:276: error: ISO C++ forbids declaration
of 'PGresult' with no type ogr_pg.h:276: error: expected ';' before '*'
token ogr_pg.h:283: error: 'PGresult' has not been declared
ogr_pg.h:317: error: ISO C++ forbids declaration of 'PGconn' with no
type ogr_pg.h:317: error: expected ';' before '*' token ogr_pg.h:321:
error: 'Oid' does not name a type ogr_pg.h:340: error: ISO C++ forbids
declaration of 'PGconn' with no type ogr_pg.h:340: error: expected ';'
before '*' token ogr_pg.h:342: error: expected `;' before 'int'
ogr_pg.h:367: error: 'Oid' does not name a type make[3]: ***
[../o/ogrpgdriver.o] B??d 1 make[3]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts/pg' make[2]: ***
[pg-target] B??d 2 make[2]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr/ogrsf_frmts' make[1]: *** [sublibs]
B??d 2 make[1]: Opuszczenie katalogu
`/home/shoofi/src/straight/gdal/ogr' make: *** [ogr-target] B??d 2



I *did* remember to "make distclean" before rebuilding, if you are
going to ask :).

Updating GDAL from CVS doesn't make any difference (there were no
changes in CVS since my problem begun).  What GEOS version are you
using? I tend to use latest stable (which is 2.2.3 now), when I'm not
following a given software development closer (while for those which I
follow more closely I prefer latest and gratest from CVS, eg. GDAL or
GRASS). What version of GEOS would you recommend for current GDAL CVS?

Best,
Maciek

From kenichi.ueda at gmail.com  Sat Jul  8 15:00:50 2006
From: kenichi.ueda at gmail.com (Ken-ichi Ueda)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Re: ruby bindings not compiling from CVS
In-Reply-To: <20060706121442.65633.qmail@web30705.mail.mud.yahoo.com>
References: <20060706121442.65633.qmail@web30705.mail.mud.yahoo.com>
Message-ID: <1185ABAF-643F-4FC6-A6DF-97A92E8D990E@nature.berkeley.edu>

Cool, thanks Sylvain.  I can confirm that this fixes the problem in  
Gentoo.  However, in Mac OS X I'm encountering a different, and  
probably unrelated problem upon make install:

g++ -shared gdal_wrap.o -o .libs/gdal.so -Wl,-bind_at_load  -L/usr/ 
darwinports/lib -L/usr/local/src/gdal-1.3.2 /usr/local/src/ 
gdal-1.3.2/.libs/libgdal.dylib -lz -ldl -lruby
powerpc-apple-darwin8-g++-4.0.0: unrecognized option '-shared'
/usr/bin/ld: Undefined symbols:
_main
collect2: ld returned 1 exit status
make[3]: *** [gdal.so] Error 1
make[2]: *** [install] Error 2
make[1]: *** [install] Error 2
make: *** [install-actions] Error 2


Any thoughts?

-Ken-ichi



On Jul 6, 2006, at 5:14 AM, s duclos wrote:

> Hi Ken-ichi,
>
> Got the same problem as you!
>
> I'm on Gentoo and the GDAL code is fron yesterday
> CVS (05JUL2006).
>
>
> Here is a patch that work for me:
>
>
> $ cvs diff RubyMakefile.mk
> Index: RubyMakefile.mk
> ===================================================================
> RCS file:
> /cvs/maptools/cvsroot/gdal/swig/ruby/RubyMakefile.mk,v
> retrieving revision 1.5
> diff -r1.5 RubyMakefile.mk
> 44c44
> < install: $(INSTALL_DIR)
> ---
>> install: $(INSTALL_DIR) $(RUBY_MODULES)
>
>
> rgds,
>
>
> Sylvain.
>
>
> --- Ken-ichi Ueda <kueda@nature.berkeley.edu> wrote:
>
>> Hi Charlie et al.,
>>
>> I just gave this another shot, this time on Ubuntu
>> 6.06, and got exactly
>> the same error:
>>
>> (cd man; make install)
>> make[1]: Entering directory
>> `/usr/local/src/gdal-cvs-2006.07.05/man'
>> /usr/local/src/gdal-cvs-2006.07.05/install-sh -d
>> /usr/local/man/man1
>> for f in man1/gdaladdo.1 man1/gdal-config.1
>> man1/gdal_contour.1
>> man1/gdalinfo.1 man1/gdal_merge.1
>> man1/gdal_rasterize.1
>> man1/gdaltindex.1 man1/gdal_translate.1
>> man1/gdal_utilities.1
>> man1/gdalwarp.1 man1/ogr2ogr.1 man1/ogrinfo.1
>> man1/ogrtindex.1
>> man1/ogr_utilities.1 man1/pct2rgb.1 man1/rgb2pct.1 ;
>> do
>> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c -m
>> 0644 $f
>> /usr/local/man/man1 ; done
>> make[1]: Leaving directory
>> `/usr/local/src/gdal-cvs-2006.07.05/man'
>> (cd swig; make install)
>> make[1]: Entering directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig'
>> for dir in ruby ; do (cd $dir; make install ); done
>> make[2]: Entering directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
>> make -f RubyMakefile.mk install
>> make[3]: Entering directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
>> /bin/sh /usr/local/src/gdal-cvs-2006.07.05/libtool
>> --mode=install
>> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
>> gdal.so ogr.so
>> gdalconst.so osr.so
>> /usr/local/lib/site_ruby/1.8/i486-linux/gdal
>> /usr/local/src/gdal-cvs-2006.07.05/install-sh -c
>> gdal.so
>> /usr/local/lib/site_ruby/1.8/i486-linux/gdal/gdal.so
>> install:  gdal.so does not exist
>> make[3]: *** [install] Error 1
>> make[3]: Leaving directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
>> make[2]: *** [install] Error 2
>> make[2]: Leaving directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig/ruby'
>> make[1]: *** [install] Error 2
>> make[1]: Leaving directory
>> `/usr/local/src/gdal-cvs-2006.07.05/swig'
>> make: *** [install-actions] Error 2
>>
>>
>> Again, it looks like gdal.so just isn't getting
>> built.  So either I'm
>> doing something dumb on OS X, Gentoo, and Ubuntu (a
>> definite
>> possibility), or there's a deeper problem.  I would
>> definitely
>> appreciate some help working through this, if you
>> have the time.
>>
>> -Ken-ichi
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/gdal-dev
>>
>
>
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around
> http://mail.yahoo.com


From mateusz at loskot.net  Mon Jul 10 02:49:07 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <20060710014445.6a029645@sorbus>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>
	<20060710014445.6a029645@sorbus>
Message-ID: <44B1F863.8000900@loskot.net>

Maciej Sieczka wrote:
> Dnia Mon, 10 Jul 2006 00:07:00 +0200
> Mateusz Loskot <mateusz@loskot.net> napisa?(a):
>> Maciej Sieczka wrote:
> 
>> FYI, recently, OGR has been ported to GEOS C API, so GEOS >= 2.2.0
>> version is required.
> 
> I'm using 2.2.3 here, as you can read above.


Maciej,

Yes, I understand I just mentioned it FYI :-)
Indeed, there is a problem with building GDAL CVS with GEOS 2.2.3,
I also encountered it when trying on clean checkout of GDAL and GEOS 2.2.3.
See at the end of this message for more details.


>> Maybe ./configure is finding old geos-config somewhere in your
>> filesystem.
> 
> I don't think it is possible. I only had 2.1.4 from Dapper's
> universe repo installed for a while, but I uninstalled and purged it
> before building and installing 2.2.3 from source.
> 
> See:
> 
> $ which geos-config
> /usr/local/bin/geos-config
> 
> $ geos-config --version
> 2.2.3


OK, it's clear.


>> I'm building GDAL a few times a day and it works.

It works because I'm building using CVS version of GDAL and GEOS
with small adjustments of autotools scripts.
And it seems I've forgot to commit them to GDAL CVS.

> I *did* remember to "make distclean" before rebuilding, if you are
> going to ask :).

OK :)


> Updating GDAL from CVS doesn't make any difference (there were no
> changes in CVS since my problem begun).  What GEOS version are you
> using? 

I use GEOS CVS and GDAL CVS, but not that I use them for development.

> I tend to use latest stable (which is 2.2.3 now), when I'm not
> following a given software development closer (while for those which I
> follow more closely I prefer latest and gratest from CVS, eg. GDAL or
> GRASS). What version of GEOS would you recommend for current GDAL CVS?

Every version equal or above to GEOS 2.2.0 is recommended.


OK, let's get back to the GDAL + GEOS building problem.
As I said, I tested it with fresh copies of GDAL CVS and GEOS 2.2.3
and you're right, there is a problem.
Linker can't find GEOS C API functions:

/home/mloskot/tmp/gdal-cvs/gdal/.libs/libgdal.so: undefined reference to
`GEOSBoundary'
/home/mloskot/tmp/gdal-cvs/gdal/.libs/libgdal.so: undefined reference to
`GEOSCrosses'
/home/mloskot/tmp/gdal-cvs/gdal/.libs/libgdal.so: undefined reference to
`GEOSConvexHull'
...

The problem is that GDAL CVS includes old version of ./configure script.
I mean old, because it does not include latest changes I made in
autotools macro m4/geos.m4 and ./configure.in template.



Fast fix:

Maciej, to re-generate ./configure script yourself with new changes
included, you need to run ./autogen.sh in GDAL CVS root sources dir
(without any parameters).

Then, you will get new version of ./configure that should work well.


Frank,
Could you generate new version of ./configure?


LAST MINUTE NOTE:
I've just notice there is some problem with GEOS itself.
OGR utilities can't link with success because of undefined references in
libgeos_c:

/bin/sh /home/mloskot/tmp/gdal-cvs/gdal/libtool --mode=link     g++
ogrinfo.o /home/mloskot/tmp/gdal-cvs/gdal/libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo
/home/mloskot/tmp/gdal-cvs/gdal/.libs/libgdal.so -L/usr/local/lib
-L/usr/lib -lpq -lrt -ldl -lpthread
/usr/local/lib/libgeos_c.so.1: undefined reference to
`geos::WKBReader::read(std::basic_istream<char, std::char_traits<char> >&)'
/usr/local/lib/libgeos_c.so.1: undefined reference to
`geos::WKBWriter::write(geos::Geometry const&, std::basic_ostream<char,
std::char_traits<char> >&)'
/usr/local/lib/libgeos_c.so.1: undefined reference to
`geos::Point::getCoordinatesRO() const'
/usr/local/lib/libgeos_c.so.1: undefined reference to
`geos::WKBWriter::WKBWriter(int, int)'
collect2: ld returned 1 exit status
make: *** [ogrinfo] Error 1


I'll report it to strk as soon as I meet him.
I suppose this problem can be solved with GEOS' ./configure switches
to enable/disable inline expansion of functions.

Maciej, could you try to build GDAL + GEOS on your box and see
if you will get errors listed above about undefined references in libgeos_c?

I'll try to fix/explain the libgeos_c issues very soon.
I'm sorry for those problems and thanks for reporting them!

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Mon Jul 10 03:23:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B1F863.8000900@loskot.net>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>	<20060710014445.6a029645@sorbus>
	<44B1F863.8000900@loskot.net>
Message-ID: <44B20079.8040801@loskot.net>

Mateusz Loskot wrote:
> I'll report it to strk as soon as I meet him.
> I suppose this problem can be solved with GEOS' ./configure switches
> to enable/disable inline expansion of functions.
> 
> Maciej, could you try to build GDAL + GEOS on your box and see
> if you will get errors listed above about undefined references in libgeos_c?
> 
> I'll try to fix/explain the libgeos_c issues very soon.
> I'm sorry for those problems and thanks for reporting them!

I posted a message about this issue to GEOS list.
Here it is in the archive:

http://geos.refractions.net/pipermail/geos-devel/2006-July/002432.html

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From hydromap at gmail.com  Mon Jul 10 06:32:26 2006
From: hydromap at gmail.com (Shoaib Burq)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
Message-ID: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>

Hi, I was just wondering if there is a way to programatically convert
proj4 or wkt to and EPSG code in OSR?

thanks heaps
shoaib

From mateusz at loskot.net  Mon Jul 10 06:53:05 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
In-Reply-To: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>
References: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>
Message-ID: <44B23191.8070605@loskot.net>

Shoaib Burq wrote:
> Hi, I was just wondering if there is a way to programatically convert
> proj4 or wkt to and EPSG code in OSR?

One of possibilities I see is to import SRS to OGRSpatialReference:

char* pszWkt = "..."; // put here your SRS WKT definition

OGRSpatialReference srs;
srs.exportToWkt( &pszWkt );

const char* pszTarget = 0;
const char* pszAuthName = 0;
const char* pszAuthCode = 0;

if (srs.IsProjected())
   pszTarget = "PROJCS";
else
   pszTarget = "GEOGCS";

pszAuthName = srs.GetAuthorityName( pszTarget );
if( NULL != pszAuthName )
{
   if( EQUAL( pszAuthName, "EPSG" ) )
   {
      pszAuthCode = srs.GetAuthorityCode( pszTarget );
      if( NULL != pszAuthCode )
      {
           // XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
           // Here is the epsg code
           int epsg = atoi(pszAuthCode);
      }
   }
}

Similarly, you should be able to import SRS from PROJ.4 definition using
OGRSpatialReference::importFromProj4().

I've not compiled this code above, it is a copy&paste with small
modifications from ogr/ogr2gmlgeometry.cpp file, starting from line 235
where I retrieve EPSG code to save it as a value of srsName - GML
attribute.


I hope it helps or may be anyone knows a better way?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Mon Jul 10 09:18:44 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B20079.8040801@loskot.net>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>	<20060710014445.6a029645@sorbus>	<44B1F863.8000900@loskot.net>
	<44B20079.8040801@loskot.net>
Message-ID: <44B253B4.8030006@loskot.net>

Mateusz Loskot wrote:
> Mateusz Loskot wrote:
>> I'll report it to strk as soon as I meet him.
>> I suppose this problem can be solved with GEOS' ./configure switches
>> to enable/disable inline expansion of functions.
>>
>> Maciej, could you try to build GDAL + GEOS on your box and see
>> if you will get errors listed above about undefined references in libgeos_c?
>>
>> I'll try to fix/explain the libgeos_c issues very soon.
>> I'm sorry for those problems and thanks for reporting them!
> 
> I posted a message about this issue to GEOS list.
> Here it is in the archive:
> 
> http://geos.refractions.net/pipermail/geos-devel/2006-July/002432.html

The problem with "undefined references" in libgeos_c is on the GDAL side.
Long story is here:
http://geos.refractions.net/pipermail/geos-devel/2006-July/002436.html

Unfortunately I have no idea why libtool can't link GDAL with GEOS
if used.

Frank,
Do you have any idea?

Maciej,

As you can read in my post on the GEOS list, use --without-libtool when
building GDAL:

./configure --without-libtool ...rest of your options.

This change is transparent for you, I mean you won't notice any
changes in GDAL behaviour or you won't need to take any further steps
to build it. Just pass it and build as usually: make, make install.
It should work. I tested it today with GDAL CVS and GEOS 2.2.3.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Mon Jul 10 09:20:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
In-Reply-To: <44B23191.8070605@loskot.net>
References: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>
	<44B23191.8070605@loskot.net>
Message-ID: <44B25428.3010905@pobox.com>

Mateusz Loskot wrote:
> Shoaib Burq wrote:
>> Hi, I was just wondering if there is a way to programatically convert
>> proj4 or wkt to and EPSG code in OSR?
> 
> One of possibilities I see is to import SRS to OGRSpatialReference:
> 
> char* pszWkt = "..."; // put here your SRS WKT definition
> 
> OGRSpatialReference srs;
> srs.exportToWkt( &pszWkt );
> 
> const char* pszTarget = 0;
> const char* pszAuthName = 0;
> const char* pszAuthCode = 0;
> 
> if (srs.IsProjected())
>    pszTarget = "PROJCS";
> else
>    pszTarget = "GEOGCS";
> 
> pszAuthName = srs.GetAuthorityName( pszTarget );
> if( NULL != pszAuthName )
> {
>    if( EQUAL( pszAuthName, "EPSG" ) )
>    {
>       pszAuthCode = srs.GetAuthorityCode( pszTarget );
>       if( NULL != pszAuthCode )
>       {
>            // XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
>            // Here is the epsg code
>            int epsg = atoi(pszAuthCode);
>       }
>    }
> }
> 
> Similarly, you should be able to import SRS from PROJ.4 definition using
> OGRSpatialReference::importFromProj4().
> 
> I've not compiled this code above, it is a copy&paste with small
> modifications from ogr/ogr2gmlgeometry.cpp file, starting from line 235
> where I retrieve EPSG code to save it as a value of srsName - GML
> attribute.

Mateusz / Shoaib,

The above will work if there is an ESPG authority code in the WKT.
Unfortunately, if you import a definition from PROJ.4 there is no
indication of the epsg code, so there will be no epsg authority codes
in the WKT representation.

Generally speaking there is no good way to go from PROJ.4 to EPSG codes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Mon Jul 10 09:30:33 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
In-Reply-To: <44B25428.3010905@pobox.com>
References: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>
	<44B23191.8070605@loskot.net> <44B25428.3010905@pobox.com>
Message-ID: <44B25679.6050203@loskot.net>

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Shoaib Burq wrote:
>>> Hi, I was just wondering if there is a way to programatically convert
>>> proj4 or wkt to and EPSG code in OSR?
>>
>> One of possibilities I see is to import SRS to OGRSpatialReference:
>>
>> char* pszWkt = "..."; // put here your SRS WKT definition
>>
>> OGRSpatialReference srs;
>> srs.exportToWkt( &pszWkt );
>>
>> const char* pszTarget = 0;
>> const char* pszAuthName = 0;
>> const char* pszAuthCode = 0;
>>
>> if (srs.IsProjected())
>>    pszTarget = "PROJCS";
>> else
>>    pszTarget = "GEOGCS";
>>
>> pszAuthName = srs.GetAuthorityName( pszTarget );
>> if( NULL != pszAuthName )
>> {
>>    if( EQUAL( pszAuthName, "EPSG" ) )
>>    {
>>       pszAuthCode = srs.GetAuthorityCode( pszTarget );
>>       if( NULL != pszAuthCode )
>>       {
>>            // XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
>>            // Here is the epsg code
>>            int epsg = atoi(pszAuthCode);
>>       }
>>    }
>> }
>>
>> Similarly, you should be able to import SRS from PROJ.4 definition using
>> OGRSpatialReference::importFromProj4().
>>
>> I've not compiled this code above, it is a copy&paste with small
>> modifications from ogr/ogr2gmlgeometry.cpp file, starting from line 235
>> where I retrieve EPSG code to save it as a value of srsName - GML
>> attribute.
> 
> Mateusz / Shoaib,
> 
> The above will work if there is an ESPG authority code in the WKT.
> Unfortunately, if you import a definition from PROJ.4 there is no
> indication of the epsg code, so there will be no epsg authority codes
> in the WKT representation.
> 
> Generally speaking there is no good way to go from PROJ.4 to EPSG codes.

Frank,

Thank you for your explanation.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From kueda at nature.berkeley.edu  Mon Jul 10 12:57:28 2006
From: kueda at nature.berkeley.edu (Ken-ichi Ueda)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] build problems in ubuntu
Message-ID: <44B286F8.4070603@nature.berkeley.edu>

Hi all,

I've been trying to get GDAL compiled in Ubuntu (Dapper) without much 
success.  Here's what I've been getting with the CVS version from 7.10.06:

./configure

[configures normally]

make

[compiles ok for a while, then a bunch of gdal_wrap.c errors, ending in]

gdal_wrap.c: In function 'init_gdal':
gdal_wrap.c:12040: error: 'PyObject' undeclared (first use in this function)
gdal_wrap.c:12040: error: 'm' undeclared (first use in this function)
gdal_wrap.c:12040: error: 'd' undeclared (first use in this function)
gdal_wrap.c:12040: warning: left-hand operand of comma expression has no 
effect
gdal_wrap.c:12040: warning: statement with no effect
gdal_wrap.c:12042: warning: implicit declaration of function 'Py_InitModule'
gdal_wrap.c:12043: warning: implicit declaration of function 
'PyModule_GetDict'
make[1]: *** [gdal_wrap.o] Error 1
make[1]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.10/pymod'
make: *** [py-module] Error 2




./configure --without-python

[configure normally]

make

[compiles ok]

make install

[installs ok]




./configure --without-python --with-ruby

[configures normally]

make

[compiles ok with recent patch by Sylvain]

make install

[does alright, then tons of errors with gdal_wrap.cpp, ending in]

gdal_wrap.cpp:8726: error: expected primary-expression before ')' token
gdal_wrap.cpp:8726: error: expected `)' before '_wrap_get_driver'
gdal_wrap.cpp:8727: error: expected primary-expression before ')' token
gdal_wrap.cpp:8727: error: expected `)' before '_wrap_open'
gdal_wrap.cpp:8728: error: expected primary-expression before ')' token
gdal_wrap.cpp:8728: error: expected `)' before '_wrap_open_shared'
gdal_wrap.cpp:8729: error: expected primary-expression before ')' token
gdal_wrap.cpp:8729: error: expected `)' before 
'_wrap_auto_create_warped_vrt'
gdal_wrap.cpp: At global scope:
gdal_wrap.cpp:1488: warning: 'RubyArrayToXMLTree' defined but not used
make[3]: *** [gdal_wrap.o] Error 1
make[3]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.10/swig/ruby'
make[2]: *** [install] Error 2
make[2]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.10/swig/ruby'
make[1]: *** [install] Error 2
make[1]: Leaving directory `/usr/local/src/gdal-cvs-2006.07.10/swig'
make: *** [install-actions] Error 2



I'm not really sure what's going on here, especially with Python not 
working.  I have Python 2.4.3 and Ruby 1.8.4 installed.  I don't know if 
anyone can explain what's going on, but I figured I'd document these issues.

-- 
Ken-ichi Ueda
Kelly Research and Outreach Lab (http://kellylab.berkeley.edu)
University of California, Berkeley
Environmental Science, Policy, and Management
Berkeley, CA 94720
tel: 510.642.8322
fax: 510.642.1477
e-mail: kueda@nature.berkeley.edu

From warmerdam at pobox.com  Mon Jul 10 13:36:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] build problems in ubuntu
In-Reply-To: <44B286F8.4070603@nature.berkeley.edu>
References: <44B286F8.4070603@nature.berkeley.edu>
Message-ID: <44B29023.6030500@pobox.com>

Ken-ichi Ueda wrote:
> Hi all,
> 
> I've been trying to get GDAL compiled in Ubuntu (Dapper) without much 
> success.  Here's what I've been getting with the CVS version from 7.10.06:
...
> [does alright, then tons of errors with gdal_wrap.cpp, ending in]
> 
> gdal_wrap.cpp:8726: error: expected primary-expression before ')' token
...
> I'm not really sure what's going on here, especially with Python not 
> working.  I have Python 2.4.3 and Ruby 1.8.4 installed.  I don't know if 
> anyone can explain what's going on, but I figured I'd document these 
> issues.

Ken-ichi,


Generally speaking it is the first error that matters most.  I *suspect*
it will be a report about Python.h not being found.  Is it possible that
you don't have a python-dev package installed?  The python include files
are required to build GDAL's Python bindings.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From brauplists at gmail.com  Mon Jul 10 14:46:49 2006
From: brauplists at gmail.com (Bruce Raup)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] How to access 2-D arrays returned by GDALRasterIO?
Message-ID: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>

Hi all,

I'm building a simple application using GDAL for image I/O.  I want to
extract different subsets from an image band, and for each subset, do
math with each of the elements within.  Ideally I would like to do
this in the natural syntax subset[i][j], rather than subset[j*ncol+i].

I am using GDALRasterIO to retrieve the subsets, putting the result in
dynamically allocated memory, obtained using CPLMalloc.  I'm using
CPLMalloc because it's in the GDAL examples, but I really don't know
what its advantages are, as I haven't found docs on it.  So my
questions are:

1.  Where is the documentation on CPLMalloc and related functions?
2.  Do CPLMalloc or GDAL provide for ease of access into image data
using 2-D indexing?
3.  Or should I be using the list-of-pointers method for 2-D indexing
as described in, say, Numerical Recipes?

Thanks,
Bruce

-- 
Bruce Raup
http://cires.colorado.edu/~braup/

From kueda at nature.berkeley.edu  Mon Jul 10 15:08:36 2006
From: kueda at nature.berkeley.edu (Ken-ichi Ueda)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] build problems in ubuntu
In-Reply-To: <44B29023.6030500@pobox.com>
References: <44B286F8.4070603@nature.berkeley.edu> <44B29023.6030500@pobox.com>
Message-ID: <44B2A5B4.5080303@nature.berkeley.edu>

Ah, thank you!  Installing python-dev and ruby-dev took care of my 
problems.  Still getting used to Ubuntu here, didn't even think to look 
for additional packages containing headers.

Ken-ichi Ueda
Kelly Research and Outreach Lab (http://kellylab.berkeley.edu)
University of California, Berkeley
Environmental Science, Policy, and Management
Berkeley, CA 94720
tel: 510.642.8322
fax: 510.642.1477
e-mail: kueda@nature.berkeley.edu


Frank Warmerdam wrote:
> Ken-ichi Ueda wrote:
>> Hi all,
>>
>> I've been trying to get GDAL compiled in Ubuntu (Dapper) without much 
>> success.  Here's what I've been getting with the CVS version from 
>> 7.10.06:
> ...
>> [does alright, then tons of errors with gdal_wrap.cpp, ending in]
>>
>> gdal_wrap.cpp:8726: error: expected primary-expression before ')' token
> ...
>> I'm not really sure what's going on here, especially with Python not 
>> working.  I have Python 2.4.3 and Ruby 1.8.4 installed.  I don't know 
>> if anyone can explain what's going on, but I figured I'd document 
>> these issues.
> 
> Ken-ichi,
> 
> 
> Generally speaking it is the first error that matters most.  I *suspect*
> it will be a report about Python.h not being found.  Is it possible that
> you don't have a python-dev package installed?  The python include files
> are required to build GDAL's Python bindings.
> 
> Best regards,

From warmerdam at pobox.com  Mon Jul 10 15:48:55 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] How to access 2-D arrays returned by GDALRasterIO?
In-Reply-To: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>
References: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>
Message-ID: <44B2AF27.3090207@pobox.com>

Bruce Raup wrote:
> Hi all,
> 
> I'm building a simple application using GDAL for image I/O.  I want to
> extract different subsets from an image band, and for each subset, do
> math with each of the elements within.  Ideally I would like to do
> this in the natural syntax subset[i][j], rather than subset[j*ncol+i].
> 
> I am using GDALRasterIO to retrieve the subsets, putting the result in
> dynamically allocated memory, obtained using CPLMalloc.  I'm using
> CPLMalloc because it's in the GDAL examples, but I really don't know
> what its advantages are, as I haven't found docs on it.  So my
> questions are:
> 
> 1.  Where is the documentation on CPLMalloc and related functions?

Bruce,

The docs can be found at:

   http://iweb.gdal.org/cpl__conv_8h.html#b2d43d9ea4c2c7ad7d5c9b218a9dee5a

Generally speaking CPLMalloc() is just a small cover over malloc() that
issues a fatal error if an out of memory condition occurs.  You can also
use VSIMalloc() which just does a normal malloc() and returns NULL on
failure.   Using CPLMalloc() and VSIMalloc() also has the advantage that
you know the allocation occurs in the GDAL heap, rather than the
application or some other heap (on win32).

Generally speaking you can find CPL function documentation by "Files"
tab of the GDAL web site, and selecting the include file the functions
are declared in.  Not all CPL functions are properly documented though.

> 2.  Do CPLMalloc or GDAL provide for ease of access into image data
> using 2-D indexing?

CPLMalloc() does not really help with this.

> 3.  Or should I be using the list-of-pointers method for 2-D indexing
> as described in, say, Numerical Recipes?

That is one functional approach.

To be honest, I always access 2D arrays in C/C++ using the [i+j*xsize]
syntax, so I'm not sure what "real 2D" alternatives exist.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Chris.Barker at noaa.gov  Mon Jul 10 20:13:51 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] How to access 2-D arrays returned by GDALRasterIO?
In-Reply-To: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>
References: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>
Message-ID: <44B2ED3F.3070008@noaa.gov>

Bruce Raup wrote:
>   So my
> questions are:
> 
> 1.  Where is the documentation on CPLMalloc and related functions?
> 2.  Do CPLMalloc or GDAL provide for ease of access into image data
> using 2-D indexing?
> 3.  Or should I be using the list-of-pointers method for 2-D indexing
> as described in, say, Numerical Recipes?

Bruce, You're a Pythonista aren't you? You can pull a RasterBand out of 
GDAL and put it in a numpy array, and then manipulate it as 2-d data to 
your hearts content.

Indeed, there are python wrappers in progress that will use numpy arrays 
by default, but I've been doing it by hand so far.

IF you really can't do Python, I'd look into Blitz++ or some of the 
Boost libs for array classes you could use.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From hydromap at gmail.com  Mon Jul 10 23:06:09 2006
From: hydromap at gmail.com (Shoaib Burq)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
In-Reply-To: <44B25428.3010905@pobox.com>
References: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>
	<44B23191.8070605@loskot.net> <44B25428.3010905@pobox.com>
Message-ID: <60c6835d0607102006k6846bbb9v52290e46afb89298@mail.gmail.com>

Thanks Mateusz/Frank that explains a lot.

I used gdalwarp to reproject a dataset using proj4 directives. When
looking at its WKT it appears very scant and doesn't contain AUTHORITY
attribute.

This might be a dumb question but do you know if WCS specification and
its Mapserver implementation only allow EPSG codes for the
GetCoverage() request and not Proj4?

thanks heaps
shoaib

> The above will work if there is an ESPG authority code in the WKT.
> Unfortunately, if you import a definition from PROJ.4 there is no
> indication of the epsg code, so there will be no epsg authority codes
> in the WKT representation.
>
> Generally speaking there is no good way to go from PROJ.4 to EPSG codes.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From warmerdam at pobox.com  Mon Jul 10 23:16:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] proj4/wkt --> epsg
In-Reply-To: <60c6835d0607102006k6846bbb9v52290e46afb89298@mail.gmail.com>
References: <60c6835d0607100332s5915b84ehb4c914c6646e5f1e@mail.gmail.com>	
	<44B23191.8070605@loskot.net> <44B25428.3010905@pobox.com>
	<60c6835d0607102006k6846bbb9v52290e46afb89298@mail.gmail.com>
Message-ID: <44B317F9.70902@pobox.com>

Shoaib Burq wrote:
> Thanks Mateusz/Frank that explains a lot.
> 
> I used gdalwarp to reproject a dataset using proj4 directives. When
> looking at its WKT it appears very scant and doesn't contain AUTHORITY
> attribute.
> 
> This might be a dumb question but do you know if WCS specification and
> its Mapserver implementation only allow EPSG codes for the
> GetCoverage() request and not Proj4?

Shoaib,

I believe that a WCS GetCoverage request must include an EPSG code (real
or fake).  But actual layer PROJECTION blocks in your map file don't need
to have an associated EPSG code though commonly they do.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From neteler at itc.it  Tue Jul 11 12:05:08 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] Reading GPCP rainfall data?
Message-ID: <20060711160508.GA14310@bartok.itc.it>

Hi,

I would be very interested to read these data sets

 Global Daily Merged Precipitation Analyses of the GPCP 
 http://precip.gsfc.nasa.gov/
 (see Daily Data at page bottom)

The Format is:
http://precip.gsfc.nasa.gov/gpcp_daily_comb.html
(at bottom)
"The data set archive consists of unformatted REAL*4 binary files with ASCII headers. Each file holds 28-31 daily fields. Each file occupies about 8 MB. The grid on which each field of values is presented is a 1??x1?? latitude--longitude (Cylindrical Equal Distance) global array of points. It is size 360x180, with X (longitude) incrementing most rapidly West to East from the Prime Meridian, and then Y (latitude) incrementing North to South. Whole- and half-degree values are at grid edges:

First point center = (89.5??N,0.5??E)
Second point center = (89.5??N,1.5??E)
Last point center = (89.5??S,0.5??W)

Missing values are denoted by the value -99999., and the units are mm/day. 
"

Does anyone has experience? Or (cough) a script based on GDAL?

thanks,

 Markus


From andrew.nelson at jrc.it  Tue Jul 11 12:13:30 2006
From: andrew.nelson at jrc.it (Andrew Nelson)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] gdal_rasterize
Message-ID: <44B3CE2A.40401@jrc.it>

Hi all,

I'm experimenting with gdal_rasterize and I can't get it to work with
compressed GTiffs (using either LZW or DEFLATE).  Of course it works
perfectly with uncompressed images.   

Any ideas why this is so? Do compressed files not support 'update mode access'?

I'm using GDAL1.3.2 from FWTools1.0.0 on Windows.

thanks!

Andy

-- 

*Andy Nelson*
Post-Doctoral Fellow - African Observatory / Geoland Project
Global Environment Monitoring Unit (GEM)
Institute for Environment and Sustainability (IES)
Joint Research Centre of the European Commission
TP 440, Via Enrico Fermi 1, I-21020 Ispra (VA), Italy

e: andrew.nelson@jrc.it <mailto:andrew.nelson@jrc.it>  w: http://www-gem.jrc.it/tem
t: +39 0332 786744       f: +39 0332 789073

Disclaimer required under the terms and conditions of use of the 
Internet and electronic mail from Commission equipment: "The views 
expressed are purely those of the writer and may not in any 
circumstances be regarded as stating an official position of the 
European Commission."


From warmerdam at pobox.com  Tue Jul 11 12:37:14 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:15 2007
Subject: [Gdal-dev] gdal_rasterize
In-Reply-To: <44B3CE2A.40401@jrc.it>
References: <44B3CE2A.40401@jrc.it>
Message-ID: <44B3D3BA.8060803@pobox.com>

Andrew Nelson wrote:
> Hi all,
> 
> I'm experimenting with gdal_rasterize and I can't get it to work with
> compressed GTiffs (using either LZW or DEFLATE).  Of course it works
> perfectly with uncompressed images.  
> Any ideas why this is so? Do compressed files not support 'update mode 
> access'?

Andrew,

That is exactly the problem.  Generally speaking compressed files do
not support update mode.  If the error reports are not sufficiently
clear on what is going wrong, please feel free to file a bug report
with the details.

Best regards,

> I'm using GDAL1.3.2 from FWTools1.0.0 on Windows.
> 
> thanks!
> 
> Andy
> 


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jul 11 13:25:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Reading GPCP rainfall data?
In-Reply-To: <20060711160508.GA14310@bartok.itc.it>
References: <20060711160508.GA14310@bartok.itc.it>
Message-ID: <44B3DEF2.4020008@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> I would be very interested to read these data sets
> 
>  Global Daily Merged Precipitation Analyses of the GPCP 
>  http://precip.gsfc.nasa.gov/
>  (see Daily Data at page bottom)
> 
> The Format is:
> http://precip.gsfc.nasa.gov/gpcp_daily_comb.html
> (at bottom)
> "The data set archive consists of unformatted REAL*4 binary files with ASCII headers. Each file holds 28-31 daily fields. Each file occupies about 8 MB. The grid on which each field of values is presented is a 1??x1?? latitude--longitude (Cylindrical Equal Distance) global array of points. It is size 360x180, with X (longitude) incrementing most rapidly West to East from the Prime Meridian, and then Y (latitude) incrementing North to South. Whole- and half-degree values are at grid edges:
> 
> First point center = (89.5??N,0.5??E)
> Second point center = (89.5??N,1.5??E)
> Last point center = (89.5??S,0.5??W)
> 
> Missing values are denoted by the value -99999., and the units are mm/day. 
> "
> 
> Does anyone has experience? Or (cough) a script based on GDAL?

Markus,

I have attached a VRT that would reference one of these files.   You could
likely produce these from a template with filename substitution in a script
pretty easily.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org

-------------- next part --------------
<VRTDataset rasterXSize="360" rasterYSize="180">
  <Geotransform>0,1,0,90, 0,-1</Geotransform>
  <SRS>WGS84</SRS>
  <VRTRasterBand dataType="Float32" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>1440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="2" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>260640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="3" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>519840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="4" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>779040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="5" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>1038240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="6" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>1297440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="7" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>1556640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="8" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>1815840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="9" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>2075040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="10" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>2334240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="11" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>2593440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="12" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>2852640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="13" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>3111840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="14" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>3371040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="15" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>3630240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="16" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>3889440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="17" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>4148640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="18" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>4407840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="19" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>4667040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="20" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>4926240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="21" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>5185440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="22" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>5444640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="23" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>5703840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="24" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>5963040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="25" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>6222240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="26" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>6481440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="27" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>6740640</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="28" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>6999840</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="29" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>7259040</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="30" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>7518240</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="31" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">gpcp_1dd_p1d.199610</SourceFilename>
    <ByteOrder>MSB</ByteOrder>
    <ImageOffset>7777440</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>1440</LineOffset>
  </VRTRasterBand>
</VRTDataset>
From danmitchell at mail.utexas.edu  Tue Jul 11 15:07:49 2006
From: danmitchell at mail.utexas.edu (Daniel Mitchell)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] How to propose patches?
Message-ID: <200607111407.50384.danmitchell@mail.utexas.edu>

I'd like to propose a few patches to the GDAL code base; what are the proper 
channels for doing so?

D.

From warmerdam at pobox.com  Tue Jul 11 15:34:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] How to propose patches?
In-Reply-To: <200607111407.50384.danmitchell@mail.utexas.edu>
References: <200607111407.50384.danmitchell@mail.utexas.edu>
Message-ID: <44B3FD2F.3080102@pobox.com>

Daniel Mitchell wrote:
> I'd like to propose a few patches to the GDAL code base; what are the proper 
> channels for doing so?

Daniel,

I would suggest submitting each as a bugzilla entry.  Depending on the
impact of the patches, it may be desirable to write up an RFC for the
consideration of the PSC, but if it is just routine bug fixes or feature
improvements within the current architecture that should not be necessary.

Please try to provide the patches against the current CVS development
version, and include pointers to test data where applicable.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dylan.beaudette at gmail.com  Tue Jul 11 16:11:08 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] specifiying the correct SRID when sending polygons to
	PostGIS
Message-ID: <200607111311.08100.dylan.beaudette@gmail.com>

Hi everyone,

I have just noticed that when importing some polygons data into PostGIS with 
ogr2ogr:

ogr2ogr -nln mapunit -update -append -t_srs '+proj=aea +x_0=0.0 +y_0=0 
+lon_0=-96 +lat_0=40.0 +lat_1=20 +lat_2=60.0 +datum=NAD83' -f "PostgreSQL" 
PG:"dbname=ssurgo_combined user=postgres password=xxx host=xxx" file.shp


... the SRID of the wkb_geometry column is set to 32767. Could this be due to 
the fact that the ourput projection that I am specifying via proj4 style 
syntax is not in the proj/epsg file? Is there anyway to manually specify the 
SRID that I want PostGIS to enforce on this geometry, something like an 
option: -force-srid 9001 . where 9001 is a custom SRID that I have added to 
PostGIS ? 

Thanks in advance!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From neteler at itc.it  Tue Jul 11 16:56:10 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Reading GPCP rainfall data?
In-Reply-To: <44B3DEF2.4020008@pobox.com>
References: <20060711160508.GA14310@bartok.itc.it> <44B3DEF2.4020008@pobox.com>
Message-ID: <20060711205609.GA15477@bartok.itc.it>

On Tue, Jul 11, 2006 at 01:25:06PM -0400, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >Hi,
> >
> >I would be very interested to read these data sets
> >
> > Global Daily Merged Precipitation Analyses of the GPCP
> > http://precip.gsfc.nasa.gov/
> > (see Daily Data at page bottom)
...
>
> Markus,
>
> I have attached a VRT that would reference one of these files.   You could
> likely produce these from a template with filename substitution in a script
> pretty easily.
>

Frank,

world best time! Works like a charm. To autogenerate it
is in fact easy.

Thanks a lot!

 Markus

From warmerdam at pobox.com  Tue Jul 11 17:03:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] specifiying the correct SRID when sending polygons
	to	PostGIS
In-Reply-To: <200607111311.08100.dylan.beaudette@gmail.com>
References: <200607111311.08100.dylan.beaudette@gmail.com>
Message-ID: <44B4121D.2060801@pobox.com>

Dylan Beaudette wrote:
> Hi everyone,
> 
> I have just noticed that when importing some polygons data into PostGIS with 
> ogr2ogr:
> 
> ogr2ogr -nln mapunit -update -append -t_srs '+proj=aea +x_0=0.0 +y_0=0 
> +lon_0=-96 +lat_0=40.0 +lat_1=20 +lat_2=60.0 +datum=NAD83' -f "PostgreSQL" 
> PG:"dbname=ssurgo_combined user=postgres password=xxx host=xxx" file.shp
> 
> 
> ... the SRID of the wkb_geometry column is set to 32767. Could this be due to 
> the fact that the ourput projection that I am specifying via proj4 style 
> syntax is not in the proj/epsg file? Is there anyway to manually specify the 
> SRID that I want PostGIS to enforce on this geometry, something like an 
> option: -force-srid 9001 . where 9001 is a custom SRID that I have added to 
> PostGIS ? 

Dylan,

There is currently no option to force use of a particular SRID by SRID.
What OGR does is search for an entry in spatial_ref_sys that has a WKT
value exactly matching the one you have associated with the layer being
created.  So if you have associated WKT for SRID 9001 in the spatial_ref_sys
table, then you should be able to force ogr2ogr to use that entry by
using the same WKT.  For instance, save it to a text file called 9001.wkt
and then do

ogr2ogr ... -a_srs ./9001.wkt

Hopefully that will result in a match and use of SRID 9001.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Tue Jul 11 17:33:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GDALDatasetComputeStatistics()
Message-ID: <44B41941.1040503@pobox.com>

Folks,

A client is running into an issue where they need to be able to cancel
the computation of image statistics on very large files.  I am loath to
change the signature of GDALRasterBand::GetStatistics(), so my suggestion
was to call that first with bForce=FALSE.  This means it should return
if there aren't any stored statistics available.  Then they should invoke
a function to compute the statistics that uses a progress function to
allow for cancelling out.

Well, it turns out there is no proper function for this.   So I'm proposing
to implement:

   virtual CPLErr
   GDALRasterBand::ComputeStatistics( int bApproxOK,
                                      double *pdfMin, double *pdfMax,
                                      double *pdfMean, double *padfStdDev,
                                      GDALProgressFunc, void *pProgressData );

This will compute all the statistics that would normally be returned
by GetStatistics(), and then use SetStatistics() to apply it back to the
band (saving it as metadata normally).  This would essentially use the
existing code from GetStatistics() which will be changed to call
ComputeStatistics().  There will also be a corresponding C function.

Does anyone have any concerns or suggestions about this?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From zhonghaiw at gmail.com  Wed Jul 12 06:19:39 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] definition in the EPSG file
Message-ID: <2534c4120607120319n2e28011bq54d2cfbb7891b183@mail.gmail.com>

Hi guys,

I noticed that some definitions for the EPSG codes in the epsg file is not
so clear, which means there are no parameters for the epsg codes, for
example:

# ETRS89 / UTM zone 32N
<25832> +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs  <>

the EPSG code for this one is 25832, but there are no other parameters any
more, such as longitude, latitude, central meridian, false northing, false
easting.....

and also this one:

# NAD83(HARN)
<4152> +proj=longlat +ellps=GRS80 +no_defs  <>


if the epsg code is defined like this, does it mean that the the EPSG code
is not valid for use or is not defined?

a little bit confused.

kind regards

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060712/28e83d48/attachment.html
From ILucena at clarku.edu  Wed Jul 12 07:27:29 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GDALDatasetComputeStatistics()
In-Reply-To: <44B41941.1040503@pobox.com>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C967F@Iris.ad.clarku.edu>

Frank,

That is great!

But don't forget to add it to the Python API. 

I personally don't see the need to call "ComputeStatistics" because I
can do it in my own process loop, but I will love to use "SetStatistics"
(that is not in the C API either).

My suggestion is to pass Min, Max, Mean, and StdDev as address and use
NULL as an indicator of NODATA. So, people like me will send only Min
and Max.

You probably remember this function signature from another open
architecture:

"""
(Dlls_and_IFDs.pdf)
long LayerScalarStatisticsWrite(
	void* layerHandle,
	double* minimum,
	double* maximum,
	double* mean,
	double* median,
	double* mode,
	double* stddev
)
...
	The LayerScalarStatisticsWrite function should write the
relevant statistical information to the layer indicated by layerHandle,
**ignoring any parameters it is unable to save**."""

Thanks,

Ivan


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: 11 July 2006 17:34
To: gdal-dev
Subject: [Gdal-dev] GDALDatasetComputeStatistics ()

Folks,

A client is running into an issue where they need to be able to cancel
the computation of image statistics on very large files.  I am loath to
change the signature of GDALRasterBand::GetStatistics(), so my
suggestion
was to call that first with bForce=FALSE.  This means it should return
if there aren't any stored statistics available.  Then they should
invoke
a function to compute the statistics that uses a progress function to
allow for cancelling out.

Well, it turns out there is no proper function for this.   So I'm
proposing
to implement:

   virtual CPLErr
   GDALRasterBand::ComputeStatistics( int bApproxOK,
                                      double *pdfMin, double *pdfMax,
                                      double *pdfMean, double
*padfStdDev,
                                      GDALProgressFunc, void
*pProgressData );

This will compute all the statistics that would normally be returned
by GetStatistics(), and then use SetStatistics() to apply it back to the
band (saving it as metadata normally).  This would essentially use the
existing code from GetStatistics() which will be changed to call
ComputeStatistics().  There will also be a corresponding C function.

Does anyone have any concerns or suggestions about this?

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From ILucena at clarku.edu  Wed Jul 12 10:56:05 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] import from HDF4 Modis (Help!)
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C96ED@Iris.ad.clarku.edu>

Hi there,

	If I understood the HDF4 driver documentation correctly there is
a two step approach to extract data from those files.	First use
gdalinfo to check the files subdataset names:

/**************
*
*/
C:/Data> gdalinfo MOD13A2_A2002049_h13v13_004_2003206105134.hdf
Driver: HDF4/Hierarchical Data Format Release 4
Size is 512, 512
Coordinate System is `'
...
...
...
Subdatasets:
 
SUBDATASET_1_NAME=HDF4_EOS:EOS_GRID:"MOD13A2_A2002049_h13v13_004_2003206
105134.hdf":MODIS_Grid_16DAY_1km_VI:1 km 16 days NDVI
  SUBDATASET_1_DESC=[1200x1200] 1 km 16 days NDVI (16-bit integer)
 
SUBDATASET_2_NAME=HDF4_EOS:EOS_GRID:"MOD13A2_A2002049_h13v13_004_2003206
105134.hdf":MODIS_Grid_16DAY_1km_VI:1 km 16 days EVI
  SUBDATASET_2_DESC=[1200x1200] 1 km 16 days EVI (16-bit integer)
 
SUBDATASET_3_NAME=HDF4_EOS:EOS_GRID:"MOD13A2_A2002049_h13v13_004_2003206
105134.hdf":MODIS_Grid_16DAY_1km_VI:1 km 16 days NDVI Quality
  SUBDATASET_3_DESC=[1200x1200] 1 km 16 days NDVI Quality (16-bit
unsigned integer)
...
 
SUBDATASET_11_NAME=HDF4_EOS:EOS_GRID:"MOD13A2_A2002049_h13v13_004_200320
6105134.hdf":MODIS_Grid_16DAY_1km_VI:1 km 16 days average relative
azimuth angle
  SUBDATASET_11_DESC=[1200x1200] 1 km 16 days average relative azimuth
angle (16-bit integer)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)
/*
 *
 **************/

	And then select the subdataset to be read by gdalinfo or
gdaltranslate, possibly by gdalwarp too I guess.

/**************
*
*/
C:/Data> gdalinfo
HDF4_EOS:EOS_GRID:"MOD13A2_A2002049_h13v13_004_20032061
05134.hdf":MODIS_Grid_16DAY_1km_VI:1
Driver: HDF4Image/HDF4 Dataset
Size is 0, 0
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["Unknown datum based upon the custom spheroid",
        DATUM["Not specified (based on custom spheroid)",
            SPHEROID["Custom spheroid",6371007.181,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Sinusoidal"],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (-5559752.598333,-4447802.078667)
Pixel Size = (926.62543306,-926.62543306)
...
...
...
Corner Coordinates:
Upper Left  (-5559752.598,-4447802.079)
Lower Left  (-5559752.598,-4447802.079)
Upper Right (-5559752.598,-4447802.079)
Lower Right (-5559752.598,-4447802.079)
Center      (-5559752.598,-4447802.079)

C:\Data>gdal_translate -of gtiff
HDF4_EOS:EOS_GRID:MOD13A2_A2002049_h13v13_004_2003206105134.hdf:MODIS_Gr
id_16DAY_1km_VI:1 test.tif
Input file size is 0, 0
-srcwin 0 0 0 0 falls outside raster size of 0x0
or is otherwise illegal.
/*
 *
 **************/

	The good news is that gdalinfo recognized the projection system,
but the bad one is that gdal_translate doesn't get it at all. I tried to
inform -srcwin 0 0 1200 1200, but it doesn't help.

	Let's check the inconstancies here.	It looks like there is
something wrong going on in the HDF4 Driver, because it can not
differentiate the subdataset name, they are all coming as
"MODIS_Grid_16DAY_1km_VI:1".

	If you use the Pedro Vincent's HDFExplorer
(http://www.space-research.org) you can see that there is 11 subdatasets
by the name of

1 Km 16 days NDVI
1 Kn 16 days EVI
1 Km 16 days NDVI Quality
1 Kn 16 days EVI Quality
1 Km 16 days red reflectance
1 Kn 16 days NIR reflectance
1 Km 16 days blue reflectance
1 Kn 16 days MIR reflectance
1 Km 16 days average view zenith angle
1 Km 16 days average sun zenith angle
1 Km 16 days average relative zenith angle

	Does anybody have a clue of how to make it work? Is there
anything that I am doing that is wrong or is there any workaround a know
problem?

	I will really appreciate any idea even to make changes in the
code. I can do that too if that is the case.

Thanks,

Ivan


From warmerdam at pobox.com  Wed Jul 12 17:15:23 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] import from HDF4 Modis (Help!)
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455018C96ED@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455018C96ED@Iris.ad.clarku.edu>
Message-ID: <44B5666B.1020202@pobox.com>

Ivan Lucena wrote:
> 	Let's check the inconstancies here.	It looks like there is
> something wrong going on in the HDF4 Driver, because it can not
> differentiate the subdataset name, they are all coming as
> "MODIS_Grid_16DAY_1km_VI:1".

Ivan,

This does seem to be a bug.  Can you provide a pointer to the modis
dataset in question?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Wed Jul 12 17:29:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] definition in the EPSG file
In-Reply-To: <2534c4120607120319n2e28011bq54d2cfbb7891b183@mail.gmail.com>
References: <2534c4120607120319n2e28011bq54d2cfbb7891b183@mail.gmail.com>
Message-ID: <44B569C9.6090609@pobox.com>

Zhonghai Wang wrote:
> Hi guys,
>  
> I noticed that some definitions for the EPSG codes in the epsg file is 
> not so clear, which means there are no parameters for the epsg codes, 
> for example:
>  
> # ETRS89 / UTM zone 32N
> <25832> +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs  <>
>  
> the EPSG code for this one is 25832, but there are no other parameters 
> any more, such as longitude, latitude, central meridian, false northing, 
> false easting.....

Zhonghai,

I'm not sure what is wrong with the above definition.  It is the preferred
way of expressing UTM coordinate systems in PROJ.4, and is generally more
readable than the full "transverse mercator with parameters" definition
we see in WKT.

> and also this one:
>  
> # NAD83(HARN)
> <4152> +proj=longlat +ellps=GRS80 +no_defs  <>
>  
> if the epsg code is defined like this, does it mean that the the EPSG 
> code is not valid for use or is not defined?

In this case we don't really understand what to do about the HARN datum
so we fallback to expressing things in terms of the underlying ellipsoid.

It can be used, but it won't do HARN specific datum corrections for you.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jim at nrel.colostate.edu  Wed Jul 12 12:59:53 2006
From: jim at nrel.colostate.edu (Jim Graham)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GDAL-OGR reporting failed to load NAD27-83 correction
	file
Message-ID: <KMEALPELCPHDCAHBLPGGEEFACMAA.jim@nrel.colostate.edu>

I have the GDAL library transforming between various projections without a
problem but when I try to transform between NAD27 and NAD83 I get the
"failed to load NAD27-83 correction file".  I have the PROJ_LIB
environmental variable set and the Proj4 library can see the "conus.dat"
file.  Any ideas?  Anyone?

Thanks,
Jim

System:
- Windows 2000
- Visual C++.NET
- GDAL Version 1.3.1


From tutey at o2.pl  Wed Jul 12 17:44:54 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B253B4.8030006@loskot.net>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>	<20060710014445.6a029645@sorbus>	<44B1F863.8000900@loskot.net>	<44B20079.8040801@loskot.net>
	<44B253B4.8030006@loskot.net>
Message-ID: <44B56D56.90608@o2.pl>

Mateusz Loskot napisa?(a):

> Maciej,
> 
> As you can read in my post on the GEOS list, use --without-libtool when
> building GDAL:
> 
> ./configure --without-libtool ...rest of your options.
> 
> This change is transparent for you, I mean you won't notice any
> changes in GDAL behaviour or you won't need to take any further steps
> to build it. Just pass it and build as usually: make, make install.
> It should work. I tested it today with GDAL CVS and GEOS 2.2.3.

Sorry I couldn't come back to you earlier.

Thanks for "--without-libtool" tip. However, I have fetched GDAL CVS few
minutes ago and tried if I really need that, still having GEOS 2.2.3
installed. And, this time, no problems during make, in spite of not
using "--without-libtool". GDAL built and installed just fine. Whatever
the reason. Letting you know. Strange?

Maciek

From warmerdam at pobox.com  Wed Jul 12 18:16:42 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B56D56.90608@o2.pl>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>	<20060710014445.6a029645@sorbus>	<44B1F863.8000900@loskot.net>	<44B20079.8040801@loskot.net>	<44B253B4.8030006@loskot.net>
	<44B56D56.90608@o2.pl>
Message-ID: <44B574CA.3040306@pobox.com>

Maciej Sieczka wrote:
> Mateusz Loskot napisa?(a):
> 
>> Maciej,
>>
>> As you can read in my post on the GEOS list, use --without-libtool when
>> building GDAL:
>>
>> ./configure --without-libtool ...rest of your options.
>>
>> This change is transparent for you, I mean you won't notice any
>> changes in GDAL behaviour or you won't need to take any further steps
>> to build it. Just pass it and build as usually: make, make install.
>> It should work. I tested it today with GDAL CVS and GEOS 2.2.3.
> 
> Sorry I couldn't come back to you earlier.
> 
> Thanks for "--without-libtool" tip. However, I have fetched GDAL CVS few
> minutes ago and tried if I really need that, still having GEOS 2.2.3
> installed. And, this time, no problems during make, in spite of not
> using "--without-libtool". GDAL built and installed just fine. Whatever
> the reason. Letting you know. Strange?

Maciek,

That's because Mateusz fixed GDAL!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From vdharan2001 at gmail.com  Fri Jul  7 09:02:04 2006
From: vdharan2001 at gmail.com (Vidhiyadharan Nadarajah)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Error while writing to .shp file.
Message-ID: <FJEAJLIJBMFCHFKGDAGKEEFPCCAA.vdharan2001@gmail.com>

Hi,

I want to add a feature to an existing polygon layer. Iam getting errors as
follows.

ERROR 3: Error in fseek() or fwrite() writing object to .shp file.
ERROR 4: Failure writing .shp header.

Please find below the code Iam using and indicate me what is wrong.

*********** start********

#include "stdafx.h"
#include "ogrsf_frmts.h"


int main()

{

	OGRRegisterAll();
    OGRDataSource       *poDS;
    poDS =
GRSFDriverRegistrar::Open( "C:\\Projects\\Test\\GDALTest\\shp\\india_ds.shp"
, FALSE );
    if( poDS == NULL )
    {
        printf( "Open failed.\n%s" );
        exit( 1 );
    }

    OGRLayer  *poLayer;
    poLayer = poDS->GetLayerByName( "india_ds" );

    poLayer->ResetReading();
	if (NULL == poLayer)
	 {
		 printf("Layer not found\n");
		 OGRDataSource::DestroyDataSource(poDS);
		 return -1;
	}


    OGRFeature *poFeature = new OGRFeature( poLayer->GetLayerDefn() );

	// set the field
    poFeature->SetField( "State", "123" );

	OGRPoint *poPoint = new OGRPoint();

	OGRLinearRing *poLinearRing = new OGRLinearRing() ;
	poLinearRing->setNumPoints(4);

    poPoint->setX( 13 );
    poPoint->setY( 64 );
	poLinearRing->setPoint(0,poPoint);

    poPoint->setX( 13 );
    poPoint->setY( 66 );
	poLinearRing->setPoint(1,poPoint);

    poPoint->setX( 15 );
    poPoint->setY( 66 );
	poLinearRing->setPoint(2,poPoint);

    poPoint->setX( 15 );
    poPoint->setY( 64 );
	poLinearRing->setPoint(3,poPoint);

	poLinearRing->closeRings();


	OGRPolygon *poOGRPolygon = new OGRPolygon();
	poOGRPolygon->addRingDirectly(poLinearRing);


    if(poFeature->SetGeometryDirectly( poOGRPolygon ) != OGRERR_NONE )
	{
       printf( "Failed to Set Geometry.\n" );
       exit( 1 );

	}

    if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )
    {
       printf( "Failed to create feature in shapefile.\n" );
       exit( 1 );
    }

    delete poFeature;

    OGRDataSource::DestroyDataSource( poDS );

	return 0;
}

*********** END********

Best Regards,
N.Vidhiyadharan

--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.394 / Virus Database: 268.9.10/385 - Release Date: 11/07/2006


From zhonghaiw at gmail.com  Thu Jul 13 03:41:20 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] definition in the EPSG file
In-Reply-To: <44B569C9.6090609@pobox.com>
References: <2534c4120607120319n2e28011bq54d2cfbb7891b183@mail.gmail.com>
	<44B569C9.6090609@pobox.com>
Message-ID: <2534c4120607130041t14d70be1s69ff8336d4361b24@mail.gmail.com>

Hi Frank,

the epsg definition is totally correct, sorry for a question like this. I've
read some references, and if we said UTM ZONE 32N with the GRS80 ellipsoid,
all the other parameter will set default.

thanks frank.

zhonghai


On 7/12/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>
> Zhonghai Wang wrote:
> > Hi guys,
> >
> > I noticed that some definitions for the EPSG codes in the epsg file is
> > not so clear, which means there are no parameters for the epsg codes,
> > for example:
> >
> > # ETRS89 / UTM zone 32N
> > <25832> +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs  <>
> >
> > the EPSG code for this one is 25832, but there are no other parameters
> > any more, such as longitude, latitude, central meridian, false northing,
> > false easting.....
>
> Zhonghai,
>
> I'm not sure what is wrong with the above definition.  It is the preferred
> way of expressing UTM coordinate systems in PROJ.4, and is generally more
> readable than the full "transverse mercator with parameters" definition
> we see in WKT.
>
> > and also this one:
> >
> > # NAD83(HARN)
> > <4152> +proj=longlat +ellps=GRS80 +no_defs  <>
> >
> > if the epsg code is defined like this, does it mean that the the EPSG
> > code is not valid for use or is not defined?
>
> In this case we don't really understand what to do about the HARN datum
> so we fallback to expressing things in terms of the underlying ellipsoid.
>
> It can be used, but it won't do HARN specific datum corrections for you.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/6e8c37af/attachment.html
From dany.geotools at gmail.com  Thu Jul 13 06:08:15 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Problem with HDF4 samples
Message-ID: <7221db410607130308v7eb05084p97f3911c603b6fbf@mail.gmail.com>

Hi list,
I'm trying to exploit the HDF4 files provided in the GDAL samples download
area:
http://dl.maptools.org/dl/gdal/data/hdf4 or
ftp://ftp.remotesensing.org/gdal/data/hdf4


However, when trying to open them (as an instance, by using gdalinfo in
order to check available datasets), I get this error:

ERROR 4:
`d:\DatiPlugin\MO36MW14.chlor_MODIS.ADD2001089.004.2002186190207.hdf'
not recognised as a supported file format.

Someone can help me?

If the 2 files aren't valid samples, where I can find some working HDF4
sample to use with GDAL?

Thx a lot.
-- 
Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/03c7d0d5/attachment.html
From dany.geotools at gmail.com  Thu Jul 13 06:20:19 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Re: Problem with HDF4 samples
In-Reply-To: <7221db410607130308v7eb05084p97f3911c603b6fbf@mail.gmail.com>
References: <7221db410607130308v7eb05084p97f3911c603b6fbf@mail.gmail.com>
Message-ID: <7221db410607130320t626417b8l12325379e4ed3a5f@mail.gmail.com>

Ok...
Stupid question :)

Now I'm downloading the HDF4 library.

I'm sorry...

On 7/13/06, Daniele Romagnoli <dany.geotools@gmail.com> wrote:
>
> Hi list,
> I'm trying to exploit the HDF4 files provided in the GDAL samples download
> area:
> http://dl.maptools.org/dl/gdal/data/hdf4 or
> ftp://ftp.remotesensing.org/gdal/data/hdf4
>
>
> However, when trying to open them (as an instance, by using gdalinfo in
> order to check available datasets), I get this error:
>
> ERROR 4:
> `d:\DatiPlugin\MO36MW14.chlor_MODIS.ADD2001089.004.2002186190207.hdf'
> not recognised as a supported file format.
>
> Someone can help me?
>
> If the 2 files aren't valid samples, where I can find some working HDF4
> sample to use with GDAL?
>
> Thx a lot.
> --
> Best Regards,
> Daniele
>



-- 
Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/cc4750c1/attachment.html
From nbarker at ittvis.com  Thu Jul 13 06:40:26 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Problem with HDF4 samples
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E81319DD@bath.uk.rsinc.com>

 

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Daniele
Romagnoli
Sent: Thursday, July 13, 2006 11:08 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Problem with HDF4 samples

 

Hi list,
I'm trying to exploit the HDF4 files provided in the GDAL samples
download area:
http://dl.maptools.org/dl/gdal/data/hdf4 or
ftp://ftp.remotesensing.org/gdal/data/hdf4


However, when trying to open them (as an instance, by using gdalinfo in
order to check available datasets), I get this error:

ERROR 4:
`d:\DatiPlugin\MO36MW14.chlor_MODIS.ADD2001089.004.2002186190207.hdf' 
not recognised as a supported file format. 

Someone can help me?

If the 2 files aren't valid samples, where I can find some working HDF4
sample to use with GDAL?

Thx a lot.
-- 
Best Regards,
Daniele 

 

Daniele,

 

Run gdalinfo -formats to see if you have the driver installed, you are
using the gdal you build with c++ on windows recently I guess?

 

The driver info is here
http://www.remotesensing.org/gdal/gdal_building.html#gdal_building_libra
ries

 

Norman

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/e39986f0/attachment.html
From dany.geotools at gmail.com  Thu Jul 13 06:50:24 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Problem with HDF4 samples
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E81319DD@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E81319DD@bath.uk.rsinc.com>
Message-ID: <7221db410607130350v24c9079bsa71ac56fd0a8413@mail.gmail.com>

> Daniele,
>
>
>
> Run gdalinfo ?formats to see if you have the driver installed, you are
> using the gdal you build with c++ on windows recently I guess?
>
>
>
> The driver info is here
> http://www.remotesensing.org/gdal/gdal_building.html#gdal_building_libraries
>
>
>
> Norman
>

Hi Norman,


13 minutes after my first email, I have written a second one (^_^) :
-----------------------------------------------------------------
Ok...
Stupid question :)

Now I'm downloading the HDF4 library.

I'm sorry...
------------------------------------------------------------------

Thank you.

Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/4ab645a7/attachment.html
From dany.geotools at gmail.com  Thu Jul 13 07:18:03 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Problem with HDF4 samples
In-Reply-To: <7221db410607130350v24c9079bsa71ac56fd0a8413@mail.gmail.com>
References: <B67A5FB7A8114B47A70517C9C0D102E81319DD@bath.uk.rsinc.com>
	<7221db410607130350v24c9079bsa71ac56fd0a8413@mail.gmail.com>
Message-ID: <7221db410607130418r40727a29tf53cfe577b30b39d@mail.gmail.com>

Ok. Now I have downloaded the library required to build GDAL with HDF4
support.

But now I have another question.

The HDF42r1 folder contains two subdirectories:
    DLL which contains:
          hd421m.dll
          hd421m.lib
          hm421m.dll
          hm421m.lib

and LIB which contains:
          hd421.lib
          hm421.lib

How I need to configure the NMAKE.OPT?
I'm talking about the second options of the HDF4 support section (HDF4_LIB).



# Uncomment the following and update to enable NCSA HDF Release 4 support.
HDF4_DIR =    c:\work\HDF42r1
HDF4_LIB =    /LIBPATH:$(HDF4_DIR)\lib Ws2_32.lib



There is no Ws2_32.lib in the HDF42r1's lib directory.
Which of the previously introduced *.lib I need to set in this option?

Thanks a lot.

-- 
Best Regards,
Daniele

On 7/13/06, Daniele Romagnoli <dany.geotools@gmail.com> wrote:
>
>
> Daniele,
> >
> >
> >
> > Run gdalinfo ?formats to see if you have the driver installed, you are
> > using the gdal you build with c++ on windows recently I guess?
> >
> >
> >
> > The driver info is here
> > http://www.remotesensing.org/gdal/gdal_building.html#gdal_building_libraries
> >
> >
> >
> > Norman
> >
>
> Hi Norman,
>
>
> 13 minutes after my first email, I have written a second one (^_^) :
> -----------------------------------------------------------------
>
> Ok...
> Stupid question :)
>
> Now I'm downloading the HDF4 library.
>
> I'm sorry...
> ------------------------------------------------------------------
>
> Thank you.
>
> Best Regards,
> Daniele
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/776dc319/attachment.html
From warmerdam at pobox.com  Thu Jul 13 09:19:00 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Problem with HDF4 samples
In-Reply-To: <7221db410607130418r40727a29tf53cfe577b30b39d@mail.gmail.com>
References: <B67A5FB7A8114B47A70517C9C0D102E81319DD@bath.uk.rsinc.com>	<7221db410607130350v24c9079bsa71ac56fd0a8413@mail.gmail.com>
	<7221db410607130418r40727a29tf53cfe577b30b39d@mail.gmail.com>
Message-ID: <44B64844.8050502@pobox.com>

Daniele Romagnoli wrote:
> Ok. Now I have downloaded the library required to build GDAL with HDF4 
> support.
> 
> But now I have another question.
> 
> The HDF42r1 folder contains two subdirectories:
>     DLL which contains:
>           hd421m.dll
>           hd421m.lib
>           hm421m.dll
>           hm421m.lib
> 
> and LIB which contains:
>           hd421.lib
>           hm421.lib
> 
> How I need to configure the NMAKE.OPT?
> I'm talking about the second options of the HDF4 support section 
> (HDF4_LIB).
> 
> 
> 
> # Uncomment the following and update to enable NCSA HDF Release 4 support.
> HDF4_DIR =    c:\work\HDF42r1
> HDF4_LIB =    /LIBPATH:$(HDF4_DIR)\lib Ws2_32.lib
> 
> 
> 
> There is no Ws2_32.lib in the HDF42r1's lib directory.
> Which of the previously introduced *.lib I need to set in this option?

Daniele,

The WS2_32.LIB library is a visual studio provided library, not part of
HDF4 itself.  I can't remember exactly what it provides, possibly the
byte swapping functions.   So just listing the library, as done above,
should be fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From zhonghaiw at gmail.com  Thu Jul 13 10:14:00 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
Message-ID: <2534c4120607130714g517f2b50keed82763a3f9135b@mail.gmail.com>

Hi guys,

I need a tool to reproject my TIF images, either free or non-free software.
I've tried with the GDAL utilities, sure I can do the reprojection, but the
coordinates seems not correct, there are serveral hundert meters
displacement according to the my base maps.

thanks for your info.

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/4e3c245b/attachment.html
From MChapman at sanz.com  Thu Jul 13 11:44:48 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <2534c4120607130714g517f2b50keed82763a3f9135b@mail.gmail.com>
Message-ID: <ED3A48B9840E594890A2BC172D119465065116A2@mailman.san.com>

http://www.ossim.org

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Zhonghai Wang
Sent: Thursday, July 13, 2006 8:14 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] need tools for TIF image reprojection

 

Hi guys,

 

I need a tool to reproject my TIF images, either free or non-free
software.

I've tried with the GDAL utilities, sure I can do the reprojection, but
the coordinates seems not correct, there are serveral hundert meters
displacement according to the my base maps. 

 

thanks for your info.

 

zhonghai

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060713/1ec4c5f4/attachment.html
From blackhole at lobianco.org  Thu Jul 13 12:06:53 2006
From: blackhole at lobianco.org (Antonello Lobianco (Sylvaticus))
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] gdal.Open() crash my python script..
Message-ID: <1152806813.4385.28.camel@LobiancoLx>

Hello all.. I'm just switching a program to python form C++, so I am
quite newbie about python..

This code produce the script to exit, without any apparent error:

mapFilename =  "../data/gis/colliEsini/c00_100m.tiff"
poDataset = gdal.Open(mapFilename, gdal.GA_ReadOnly)
if poDataset is None:
    print "*** ERROR, opening of the map dataset didn't success"

The problem is "_obj = _gdal.GDALOpen(file,access)" on gdal.py and the
only message I can get is a 
"<terminated, exit value: 139>regmasNoGui.py" message..

if the mapFilename is wrong I have correctly a message that the file do
not exist..



/sylvaticus




From sgillies at frii.com  Thu Jul 13 13:00:16 2006
From: sgillies at frii.com (Sean Gillies)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] gdal.Open() crash my python script..
In-Reply-To: <1152806813.4385.28.camel@LobiancoLx>
References: <1152806813.4385.28.camel@LobiancoLx>
Message-ID: <23B62F5D-8CBC-4DD0-80CC-E2AA86ECA755@frii.com>

On Jul 13, 2006, at 9:06 AM, Antonello Lobianco (Sylvaticus) wrote:

> Hello all.. I'm just switching a program to python form C++, so I am
> quite newbie about python..
>
> This code produce the script to exit, without any apparent error:
>
> mapFilename =  "../data/gis/colliEsini/c00_100m.tiff"
> poDataset = gdal.Open(mapFilename, gdal.GA_ReadOnly)
> if poDataset is None:
>     print "*** ERROR, opening of the map dataset didn't success"
>
> The problem is "_obj = _gdal.GDALOpen(file,access)" on gdal.py and the
> only message I can get is a
> "<terminated, exit value: 139>regmasNoGui.py" message..
>
> if the mapFilename is wrong I have correctly a message that the  
> file do
> not exist..
>
>
>
> /sylvaticus

Try using methods of the os module to test your input file before  
opening it with GDAL. These will raise clear exceptions in the case  
of inadequate permissions, etc.

cheers,
Sean

---
Sean Gillies
http://zcologia.com




From mateusz at loskot.net  Thu Jul 13 13:23:24 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] "collect2: ld returned 1 exit status" building ogrinfo
In-Reply-To: <44B56D56.90608@o2.pl>
References: <20060709183644.2ab42014@sorbus>	<44B17E04.9050400@loskot.net>	<20060710014445.6a029645@sorbus>	<44B1F863.8000900@loskot.net>	<44B20079.8040801@loskot.net>
	<44B253B4.8030006@loskot.net> <44B56D56.90608@o2.pl>
Message-ID: <44B6818C.3080306@loskot.net>

Maciej Sieczka wrote:
> Mateusz Loskot napisa?(a):
> 
>> Maciej,
>>
>> As you can read in my post on the GEOS list, use --without-libtool when
>> building GDAL:
>>
>> ./configure --without-libtool ...rest of your options.
>>
>> This change is transparent for you, I mean you won't notice any
>> changes in GDAL behaviour or you won't need to take any further steps
>> to build it. Just pass it and build as usually: make, make install.
>> It should work. I tested it today with GDAL CVS and GEOS 2.2.3.
> 
> Sorry I couldn't come back to you earlier.

Maciej,

No problem.

> Thanks for "--without-libtool" tip. However, I have fetched GDAL CVS few
> minutes ago and tried if I really need that, still having GEOS 2.2.3
> installed. And, this time, no problems during make, in spite of not
> using "--without-libtool". GDAL built and installed just fine. Whatever
> the reason. Letting you know. Strange?

It's expected behaviour.
2 days ago GDAL building scripts was fixed, so it should work now.


Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Jul 13 13:37:09 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] cannot make gdal - built in delete error
In-Reply-To: <23c59e280607091126m4fdf9233h6cc635bc1537b9e5@mail.gmail.com>
References: <23c59e280607091126m4fdf9233h6cc635bc1537b9e5@mail.gmail.com>
Message-ID: <44B684C5.9040100@loskot.net>

Sarah Parrott wrote:
> Hi,
> 
>  I had gdal installed fine last week, but now I want to add support for
> mysql.
> 
> I used ./configure
> --with-mysql=/usr/local/mysql-standard-5.0.22-linux-i686/bin/mysql_config
> and that was fine.
> 
> When I issue make, I get errors. This is the end of the output from make:
> 
> g++ ogrinfo.o -o .libs/ogrinfo  /usr/local/gdal-1.3.2/.libs/libgdal.so
> -lpng -lrt -ldl -L/usr/local/lib
> -L/usr/local/mysql-standard-5.0.22-linux-i686/lib -lmysqlclient -lz
> -lcrypt -lnsl -lnss_files -lnss_dns -lresolv
> /usr/local/gdal-1.3.2/.libs/libgdal.so: undefined reference to
> `__builtin_delete'
> collect2: ld returned 1 exit status
> make[1]: *** [ogrinfo] Error 1
> make[1]: Leaving directory `/usr/local/gdal-1.3.2/ogr'
> make: *** [ogr-apps] Error 2
> 
> After this I tried deleted everyting gdal and ogr related from
> usr/local/bin but got the same result. I also tried doing make clean
> first but again the same error.
> 
> The only thing I changed for this install was the mysql stuff.
> 
> Can anyone tell me what this error means?

Sarah,

I'd speculate that this error message you're getting comes is caused by
MySQL. As I understand you downloaded package described as "Linux (x86,
glibc-2.2, "standard" is static, gcc)"
The problem is that the package you are
using - mysql-standard-5.0.22-linux-i686 - is static.

Please, try to download and install mysql package
described as "Linux (x86)" (below the "static" one
and see if you can compile GDAL with success.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Jul 13 13:42:34 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GDAL-OGR reporting failed to load NAD27-83 correction
	file
In-Reply-To: <KMEALPELCPHDCAHBLPGGEEFACMAA.jim@nrel.colostate.edu>
References: <KMEALPELCPHDCAHBLPGGEEFACMAA.jim@nrel.colostate.edu>
Message-ID: <44B6860A.2070001@pobox.com>

Jim Graham wrote:
> I have the GDAL library transforming between various projections without a
> problem but when I try to transform between NAD27 and NAD83 I get the
> "failed to load NAD27-83 correction file".  I have the PROJ_LIB
> environmental variable set and the Proj4 library can see the "conus.dat"
> file.  Any ideas?  Anyone?

Jim,

Is your file actually called "conus.dat"?  I think it is supposed to be
called just "conus" with no extension.  If it is conus.lla then it is the
unprocessed ascii version and needs to be run through nad2bin.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Thu Jul 13 14:23:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GDALDatasetComputeStatistics()
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455018C967F@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455018C967F@Iris.ad.clarku.edu>
Message-ID: <44B68F96.2080706@pobox.com>

Ivan Lucena wrote:
> Frank,
> 
> That is great!
> 
> But don't forget to add it to the Python API. 
> 
> I personally don't see the need to call "ComputeStatistics" because I
> can do it in my own process loop, but I will love to use "SetStatistics"
> (that is not in the C API either).

Ivan,

I have added SetStatistics() and GetStatistics() to the NG bindings.
I haven't added ComputeStatistics() since I don't know what to do with
the progress function, and without the progress function ComputeStatistics()
isn't much different than GetStatistics() with bForce=TRUE.

> My suggestion is to pass Min, Max, Mean, and StdDev as address and use
> NULL as an indicator of NODATA. So, people like me will send only Min
> and Max.

Well, the SetStatistics() call was already defined, and I'm loath to change
it.  So currently there is no mechanism to set partial statistics.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Thu Jul 13 14:23:30 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Error while writing to .shp file.
In-Reply-To: <FJEAJLIJBMFCHFKGDAGKEEFPCCAA.vdharan2001@gmail.com>
References: <FJEAJLIJBMFCHFKGDAGKEEFPCCAA.vdharan2001@gmail.com>
Message-ID: <44B68FA2.2080309@loskot.net>

Vidhiyadharan Nadarajah wrote:
> Hi,
> 
> I want to add a feature to an existing polygon layer. Iam getting errors as
> follows.
> 
> ERROR 3: Error in fseek() or fwrite() writing object to .shp file.
> ERROR 4: Failure writing .shp header.

Hi,

The problem is that you're opening datasource in read-only mode.


> Please find below the code Iam using and indicate me what is wrong.
> 
> *********** start********
> 
> #include "stdafx.h"
> #include "ogrsf_frmts.h"
> 
> 
> int main()
> 
> {
> 
> 	OGRRegisterAll();
>     OGRDataSource       *poDS;
>     poDS =
> GRSFDriverRegistrar::Open( "C:\\Projects\\Test\\GDALTest\\shp\\india_ds.shp"
> , FALSE );

Note 1: There is no class called GRSFDriverRegistrar  but
OGRSFDriverRegistrar.

Note 2: Change the second parameter from FALSE to TRUE.


>     if( poDS == NULL )
>     {
>         printf( "Open failed.\n%s" );
>         exit( 1 );
>     }
> 
>     OGRLayer  *poLayer;
>     poLayer = poDS->GetLayerByName( "india_ds" );
> 
>     poLayer->ResetReading();
> 	if (NULL == poLayer)
> 	 {
> 		 printf("Layer not found\n");
> 		 OGRDataSource::DestroyDataSource(poDS);
> 		 return -1;
> 	}
> 
> 
>     OGRFeature *poFeature = new OGRFeature( poLayer->GetLayerDefn() );
> 
> 	// set the field
>     poFeature->SetField( "State", "123" );
> 
> 	OGRPoint *poPoint = new OGRPoint();


Remember to destroy the OGRPoint object pointed by poPoint
to avoid memory leak.

The member function
void OGRLineString::setPoint( int iPoint, OGRPoint * poPoint )
does not transfer ownership to point passed in.
Honestly, for better understanding this prototype should look as:
void OGRLineString::setPoint( int iPoint, const OGRPoint * poPoint )
because the poPoint is read-only inside the setPoint() function.


> 	OGRLinearRing *poLinearRing = new OGRLinearRing() ;
> 	poLinearRing->setNumPoints(4);
> 
>     poPoint->setX( 13 );
>     poPoint->setY( 64 );
> 	poLinearRing->setPoint(0,poPoint);
> 
>     poPoint->setX( 13 );
>     poPoint->setY( 66 );
> 	poLinearRing->setPoint(1,poPoint);
> 
>     poPoint->setX( 15 );
>     poPoint->setY( 66 );
> 	poLinearRing->setPoint(2,poPoint);
> 
>     poPoint->setX( 15 );
>     poPoint->setY( 64 );
> 	poLinearRing->setPoint(3,poPoint);


So, here is the deallocation:

delete poPoint;


> 	poLinearRing->closeRings();
> 
> 
> 	OGRPolygon *poOGRPolygon = new OGRPolygon();
> 	poOGRPolygon->addRingDirectly(poLinearRing);
> 
> 
>     if(poFeature->SetGeometryDirectly( poOGRPolygon ) != OGRERR_NONE )
> 	{
>        printf( "Failed to Set Geometry.\n" );
>        exit( 1 );
> 
> 	}
> 
>     if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )
>     {
>        printf( "Failed to create feature in shapefile.\n" );
>        exit( 1 );
>     }
> 
>     delete poFeature;
> 
>     OGRDataSource::DestroyDataSource( poDS );
> 
> 	return 0;
> }


Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From bryan at geomega.com  Thu Jul 13 15:50:39 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?
Message-ID: <44B6A40F.6090109@geomega.com>

I have a Float32 tif (see gdalinfo below) that I translate to a Float32 
AAIGrid (see gdal_translate below).  After the translation gdalinfo 
reports the dataset as Int16 and reports the grid maximum vastly 
different than it was before (see gdalinfo below).  The output aaigrid 
file is indeed floating point (see head output below) even though 
gdalinfo says it's int16.  When I translate this aaigrid back to a tif, 
then the new gdalinfo tif report is the same as the gdalinfo aaigrid (I 
didn't paste this stuff).  When I translate the aaigrid to an ArcInfo 
binary grid (AIG) using ArcInfo, then the output is the same as the 
original tif.  The gdalinfo report for the AIG dataset is the same as 
the original tif.  So it appears that the aaigrid writer is working 
correctly, but the aaigrid reader isn't working as expected.

A bug or am I doing something wrong?

Bryan

 >gdalinfo elkw_g.tif -mm
Driver: GTiff/GeoTIFF
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x11 Type=Float32, ColorInterp=Gray
     Computed Min/Max=1523.000,3385.788
   NoData Value=-99999

 >gdal_translate -of AAIGrid -ot Float32 elkw_g.tif elkw_g.asc
Input file size is 174, 225
0...10...20...30...40...50...60...70...80...90...100 - done.

 >gdalinfo elkw_g.asc -mm
Driver: AAIGrid/Arc/Info ASCII Grid
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x1 Type=Int16, ColorInterp=Undefined
     Computed Min/Max=1523.000,31073.000
   NoData Value=-99999

 >head -n 7 elkw_g.asc
ncols        174
nrows        225
xllcorner    683628.000000000000
yllcorner    1911258.125000000000
cellsize     1640.000000000000
NODATA_value -99999
  -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9
9999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9999
9 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -
99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -999
99 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999
-99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -99
999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -99999
  -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9
9999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9999
9 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -
99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -999
99 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
1928.612915039
0625 1965.587158203125 1994.283447265625 2013.431396484375 
1997.0623779296875 21
11.51416015625 2196.006103515625 2292.074951171875 2427.913818359375 
2483.550048
828125 2456.762939453125 2558.080322265625 2680.93896484375 
2807.83984375 2850.4
55810546875 3076.365234375 3124.860107421875 2905.718017578125 
2704.766845703125
  2457.794189453125 2327.631591796875 2239.057861328125 2135.4072265625 
2071.9897
4609375 2032.28515625 1985.5416259765625 1948.4173583984375 
1905.1170654296875 1
875.913818359375 1839.749755859375 1824.07958984375 1820.505126953125 
1806.35302
734375 1767.8443603515625 -99999 -99999 -99999 -99999 -99999

Bryan Keith
GIS Specialist
Geomega, Inc.
Boulder, CO, USA

From awilliams at rapidmap.com.au  Thu Jul 13 19:24:44 2006
From: awilliams at rapidmap.com.au (Andrew Williams)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
Message-ID: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>

zhonghai,
I've litterally translated hundereds of TIF's from all over the world from multiple projections to multiple projections. I have also had "failures". However, in every case, it was either my fault in specifying the -s_srs or -t_srs. In some cases the fault lay in the original image. The TIFF itself was supplied with incorrect georefernceing information and so it was never going to work.
 
Have you got a dump from GDALINFO that we can see and the GDALwarp command line you've used?
 
regards
Andrew

	-----Original Message----- 
	From: Zhonghai Wang [mailto:zhonghaiw@gmail.com] 
	Sent: Fri 7/14/2006 12:14 AM 
	To: gdal-dev@lists.maptools.org 
	Cc: 
	Subject: [Gdal-dev] need tools for TIF image reprojection
	
	
	Hi guys,
	 
	I need a tool to reproject my TIF images, either free or non-free software.
	I've tried with the GDAL utilities, sure I can do the reprojection, but the coordinates seems not correct, there are serveral hundert meters displacement according to the my base maps. 
	 
	thanks for your info.
	 
	zhonghai
	 
	 



From vdharan2001 at gmail.com  Fri Jul  7 16:20:05 2006
From: vdharan2001 at gmail.com (Vidhiyadharan Nadarajah)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Error while writing to .shp file.
In-Reply-To: <44B68FA2.2080309@loskot.net>
Message-ID: <FJEAJLIJBMFCHFKGDAGKMEGECCAA.vdharan2001@gmail.com>

Hi,
Thanks for your suggestions. Now iam able to write to shapefile.

Best Regards,
N.Vidhiyadharan

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org]On Behalf Of Mateusz Loskot
Sent: Thursday, July 13, 2006 11:54 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Error while writing to .shp file.


Vidhiyadharan Nadarajah wrote:
> Hi,
>
> I want to add a feature to an existing polygon layer. Iam getting errors
as
> follows.
>
> ERROR 3: Error in fseek() or fwrite() writing object to .shp file.
> ERROR 4: Failure writing .shp header.

Hi,

The problem is that you're opening datasource in read-only mode.


> Please find below the code Iam using and indicate me what is wrong.
>
> *********** start********
>
> #include "stdafx.h"
> #include "ogrsf_frmts.h"
>
>
> int main()
>
> {
>
> 	OGRRegisterAll();
>     OGRDataSource       *poDS;
>     poDS =
>
RSFDriverRegistrar::Open( "C:\\Projects\\Test\\GDALTest\\shp\\india_ds.shp"
> , FALSE );

Note 1: There is no class called GRSFDriverRegistrar  but
OGRSFDriverRegistrar.

Note 2: Change the second parameter from FALSE to TRUE.


>     if( poDS == NULL )
>     {
>         printf( "Open failed.\n%s" );
>         exit( 1 );
>     }
>
>     OGRLayer  *poLayer;
>     poLayer = poDS->GetLayerByName( "india_ds" );
>
>     poLayer->ResetReading();
> 	if (NULL == poLayer)
> 	 {
> 		 printf("Layer not found\n");
> 		 OGRDataSource::DestroyDataSource(poDS);
> 		 return -1;
> 	}
>
>
>     OGRFeature *poFeature = new OGRFeature( poLayer->GetLayerDefn() );
>
> 	// set the field
>     poFeature->SetField( "State", "123" );
>
> 	OGRPoint *poPoint = new OGRPoint();


Remember to destroy the OGRPoint object pointed by poPoint
to avoid memory leak.

The member function
void OGRLineString::setPoint( int iPoint, OGRPoint * poPoint )
does not transfer ownership to point passed in.
Honestly, for better understanding this prototype should look as:
void OGRLineString::setPoint( int iPoint, const OGRPoint * poPoint )
because the poPoint is read-only inside the setPoint() function.


> 	OGRLinearRing *poLinearRing = new OGRLinearRing() ;
> 	poLinearRing->setNumPoints(4);
>
>     poPoint->setX( 13 );
>     poPoint->setY( 64 );
> 	poLinearRing->setPoint(0,poPoint);
>
>     poPoint->setX( 13 );
>     poPoint->setY( 66 );
> 	poLinearRing->setPoint(1,poPoint);
>
>     poPoint->setX( 15 );
>     poPoint->setY( 66 );
> 	poLinearRing->setPoint(2,poPoint);
>
>     poPoint->setX( 15 );
>     poPoint->setY( 64 );
> 	poLinearRing->setPoint(3,poPoint);


So, here is the deallocation:

delete poPoint;


> 	poLinearRing->closeRings();
>
>
> 	OGRPolygon *poOGRPolygon = new OGRPolygon();
> 	poOGRPolygon->addRingDirectly(poLinearRing);
>
>
>     if(poFeature->SetGeometryDirectly( poOGRPolygon ) != OGRERR_NONE )
> 	{
>        printf( "Failed to Set Geometry.\n" );
>        exit( 1 );
>
> 	}
>
>     if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )
>     {
>        printf( "Failed to create feature in shapefile.\n" );
>        exit( 1 );
>     }
>
>     delete poFeature;
>
>     OGRDataSource::DestroyDataSource( poDS );
>
> 	return 0;
> }


Best regards
--
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev
--
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.1.394 / Virus Database: 268.9.10/385 - Release Date: 11/07/2006

--
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.394 / Virus Database: 268.9.10/385 - Release Date: 11/07/2006


From zhonghaiw at gmail.com  Fri Jul 14 03:52:54 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>
References: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>
Message-ID: <2534c4120607140052k738c4ca6r452631138991a0dd@mail.gmail.com>

Hi Andrew,

you are right, in the most cases the GDAL utilities work well, and I've also
use the GDAL utilities for a long time, especially the FWTools made by
Frank, we should all thank Frank for such a wonderful GIS toolkit.

I've check again and again with the GDALWARP, but things are not going in
the right way. I am trying to translate the TIF images from the coordinate
system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and there
are always  some displacement with the base maps, I am sure that the base
map and the original coordinate info for the TIF is correct. and here is an
example:

(the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE 32N)

the TIF image coordinate Info (*.tif): (Swiss National System)
 0.500000
 0.000000
 0.000000
 -0.500000
 598125.250000
199999.750000

If I transform the coordinate to WGS84 with GDAL, the value is:

0.0000059839
0.0000000000
0.0000000000
-0.0000059839
7.4149523128
46.9529994915

but the lon/lat of the upper left corner should be:

7.41401039348263
46.9510762167473

I would say that this is already big difference, because If I use this
lon/lat to get the UTM coordinate, this small difference will be propagated,
and will cause a displacement about hundreds meters.

I am trying to find the source code, which does this coordinate
transformation, so that I can check if the transformation parameters are
correct, but unfortunately I can not find the source for this.


If someone has done something similar, please point me out how to fix this
problem, especially the GIS people in Switzerland. I would really appreciate
it.

zhonghai

On 7/14/06, Andrew Williams <awilliams@rapidmap.com.au> wrote:
>
> zhonghai,
> I've litterally translated hundereds of TIF's from all over the world from
> multiple projections to multiple projections. I have also had "failures".
> However, in every case, it was either my fault in specifying the -s_srs or
> -t_srs. In some cases the fault lay in the original image. The TIFF itself
> was supplied with incorrect georefernceing information and so it was never
> going to work.
>
> Have you got a dump from GDALINFO that we can see and the GDALwarp command
> line you've used?
>
> regards
> Andrew
>
>        -----Original Message-----
>        From: Zhonghai Wang [mailto:zhonghaiw@gmail.com]
>        Sent: Fri 7/14/2006 12:14 AM
>        To: gdal-dev@lists.maptools.org
>        Cc:
>        Subject: [Gdal-dev] need tools for TIF image reprojection
>
>
>        Hi guys,
>
>        I need a tool to reproject my TIF images, either free or non-free
> software.
>        I've tried with the GDAL utilities, sure I can do the reprojection,
> but the coordinates seems not correct, there are serveral hundert meters
> displacement according to the my base maps.
>
>        thanks for your info.
>
>        zhonghai
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060714/78275b46/attachment.html
From packalen at cs.joensuu.fi  Fri Jul 14 08:31:58 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <2534c4120607140052k738c4ca6r452631138991a0dd@mail.gmail.com>
References: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>
	<2534c4120607140052k738c4ca6r452631138991a0dd@mail.gmail.com>
Message-ID: <Pine.GSO.4.61.0607141520070.8620@cs.joensuu.fi>

Hi,

This just a guess: what version of GDAL are you using? I had similar kind 
of problem about one month ago before I left to summer holiday. I 
downloaded the newest FWTools version and when I tried to transform some 
images from Finnish kkj to EUREF FIN coordinate system datum shift was not 
applied. EUREF FIN is basically ETRS89 / UTM 35N. When I revert back to 
FTTools alpha 6 everything worked propely. I don't remember what was 
actual gdal versions in these FWTools releases. Please try FWTools a6 if 
possible.

I didn't remember to fill a bug report. I will look at it later when I 
come back to office.

Best regards,
Petteri

On Fri, 14 Jul 2006, Zhonghai Wang wrote:

> Hi Andrew,
>
> you are right, in the most cases the GDAL utilities work well, and I've also
> use the GDAL utilities for a long time, especially the FWTools made by
> Frank, we should all thank Frank for such a wonderful GIS toolkit.
>
> I've check again and again with the GDALWARP, but things are not going in
> the right way. I am trying to translate the TIF images from the coordinate
> system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and there
> are always  some displacement with the base maps, I am sure that the base
> map and the original coordinate info for the TIF is correct. and here is an
> example:
>
> (the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE 32N)
>
> the TIF image coordinate Info (*.tif): (Swiss National System)
> 0.500000
> 0.000000
> 0.000000
> -0.500000
> 598125.250000
> 199999.750000
>
> If I transform the coordinate to WGS84 with GDAL, the value is:
>
> 0.0000059839
> 0.0000000000
> 0.0000000000
> -0.0000059839
> 7.4149523128
> 46.9529994915
>
> but the lon/lat of the upper left corner should be:
>
> 7.41401039348263
> 46.9510762167473
>
> I would say that this is already big difference, because If I use this
> lon/lat to get the UTM coordinate, this small difference will be propagated,
> and will cause a displacement about hundreds meters.
>
> I am trying to find the source code, which does this coordinate
> transformation, so that I can check if the transformation parameters are
> correct, but unfortunately I can not find the source for this.
>
>
> If someone has done something similar, please point me out how to fix this
> problem, especially the GIS people in Switzerland. I would really appreciate
> it.
>
> zhonghai
>
> On 7/14/06, Andrew Williams <awilliams@rapidmap.com.au> wrote:
>> 
>> zhonghai,
>> I've litterally translated hundereds of TIF's from all over the world from
>> multiple projections to multiple projections. I have also had "failures".
>> However, in every case, it was either my fault in specifying the -s_srs or
>> -t_srs. In some cases the fault lay in the original image. The TIFF itself
>> was supplied with incorrect georefernceing information and so it was never
>> going to work.
>> 
>> Have you got a dump from GDALINFO that we can see and the GDALwarp command
>> line you've used?
>> 
>> regards
>> Andrew
>> 
>>        -----Original Message-----
>>        From: Zhonghai Wang [mailto:zhonghaiw@gmail.com]
>>        Sent: Fri 7/14/2006 12:14 AM
>>        To: gdal-dev@lists.maptools.org
>>        Cc:
>>        Subject: [Gdal-dev] need tools for TIF image reprojection
>> 
>> 
>>        Hi guys,
>> 
>>        I need a tool to reproject my TIF images, either free or non-free
>> software.
>>        I've tried with the GDAL utilities, sure I can do the reprojection,
>> but the coordinates seems not correct, there are serveral hundert meters
>> displacement according to the my base maps.
>> 
>>        thanks for your info.
>> 
>>        zhonghai
>> 
>> 
>> 
>> 
>

From packalen at cs.joensuu.fi  Fri Jul 14 08:57:16 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <2534c4120607140541x7f077a55g4af4eeb3922f6224@mail.gmail.com>
References: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>
	<2534c4120607140052k738c4ca6r452631138991a0dd@mail.gmail.com> 
	<Pine.GSO.4.61.0607141520070.8620@cs.joensuu.fi>
	<2534c4120607140541x7f077a55g4af4eeb3922f6224@mail.gmail.com>
Message-ID: <Pine.GSO.4.61.0607141554560.8620@cs.joensuu.fi>

Hi,

http://iweb.gdal.org/dl/fwtools/

and then download a6 version according your OS. I used Windows version.

Best regards,
Petteri

On Fri, 14 Jul 2006, Zhonghai Wang wrote:

> Hi Petteri,
>
> I am using the latest version FWTools1.0.5, which version do you mean?
> FWTools a6? never heard.
>
> if possible, can you give me a link for the version you mentioned?
>
> thanks a lot
>
> zhonghai
>
> On 7/14/06, Petteri Packalen <packalen@cs.joensuu.fi> wrote:
>> 
>> Hi,
>> 
>> This just a guess: what version of GDAL are you using? I had similar kind
>> of problem about one month ago before I left to summer holiday. I
>> downloaded the newest FWTools version and when I tried to transform some
>> images from Finnish kkj to EUREF FIN coordinate system datum shift was not
>> applied. EUREF FIN is basically ETRS89 / UTM 35N. When I revert back to
>> FTTools alpha 6 everything worked propely. I don't remember what was
>> actual gdal versions in these FWTools releases. Please try FWTools a6 if
>> possible.
>> 
>> I didn't remember to fill a bug report. I will look at it later when I
>> come back to office.
>> 
>> Best regards,
>> Petteri
>> 
>> On Fri, 14 Jul 2006, Zhonghai Wang wrote:
>> 
>> > Hi Andrew,
>> >
>> > you are right, in the most cases the GDAL utilities work well, and I've
>> also
>> > use the GDAL utilities for a long time, especially the FWTools made by
>> > Frank, we should all thank Frank for such a wonderful GIS toolkit.
>> >
>> > I've check again and again with the GDALWARP, but things are not going
>> in
>> > the right way. I am trying to translate the TIF images from the
>> coordinate
>> > system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and
>> there
>> > are always  some displacement with the base maps, I am sure that the
>> base
>> > map and the original coordinate info for the TIF is correct. and here is
>> an
>> > example:
>> >
>> > (the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE 32N)
>> >
>> > the TIF image coordinate Info (*.tif): (Swiss National System)
>> > 0.500000
>> > 0.000000
>> > 0.000000
>> > -0.500000
>> > 598125.250000
>> > 199999.750000
>> >
>> > If I transform the coordinate to WGS84 with GDAL, the value is:
>> >
>> > 0.0000059839
>> > 0.0000000000
>> > 0.0000000000
>> > -0.0000059839
>> > 7.4149523128
>> > 46.9529994915
>> >
>> > but the lon/lat of the upper left corner should be:
>> >
>> > 7.41401039348263
>> > 46.9510762167473
>> >
>> > I would say that this is already big difference, because If I use this
>> > lon/lat to get the UTM coordinate, this small difference will be
>> propagated,
>> > and will cause a displacement about hundreds meters.
>> >
>> > I am trying to find the source code, which does this coordinate
>> > transformation, so that I can check if the transformation parameters are
>> > correct, but unfortunately I can not find the source for this.
>> >
>> >
>> > If someone has done something similar, please point me out how to fix
>> this
>> > problem, especially the GIS people in Switzerland. I would really
>> appreciate
>> > it.
>> >
>> > zhonghai
>> >
>> > On 7/14/06, Andrew Williams <awilliams@rapidmap.com.au> wrote:
>> >>
>> >> zhonghai,
>> >> I've litterally translated hundereds of TIF's from all over the world
>> from
>> >> multiple projections to multiple projections. I have also had
>> "failures".
>> >> However, in every case, it was either my fault in specifying the -s_srs
>> or
>> >> -t_srs. In some cases the fault lay in the original image. The TIFF
>> itself
>> >> was supplied with incorrect georefernceing information and so it was
>> never
>> >> going to work.
>> >>
>> >> Have you got a dump from GDALINFO that we can see and the GDALwarp
>> command
>> >> line you've used?
>> >>
>> >> regards
>> >> Andrew
>> >>
>> >>        -----Original Message-----
>> >>        From: Zhonghai Wang [mailto:zhonghaiw@gmail.com]
>> >>        Sent: Fri 7/14/2006 12:14 AM
>> >>        To: gdal-dev@lists.maptools.org
>> >>        Cc:
>> >>        Subject: [Gdal-dev] need tools for TIF image reprojection
>> >>
>> >>
>> >>        Hi guys,
>> >>
>> >>        I need a tool to reproject my TIF images, either free or
>> non-free
>> >> software.
>> >>        I've tried with the GDAL utilities, sure I can do the
>> reprojection,
>> >> but the coordinates seems not correct, there are serveral hundert
>> meters
>> >> displacement according to the my base maps.
>> >>
>> >>        thanks for your info.
>> >>
>> >>        zhonghai
>> >>
>> >>
>> >>
>> >>
>> >
>> 
>

From zhonghaiw at gmail.com  Fri Jul 14 09:12:32 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <2534c4120607140601s1d4da8b8u3a12de25cda8a01e@mail.gmail.com>
References: <CFE1D6CAE2D44343BF58E308C1C7EC646DEE57@rmg-server03.rmg.local>
	<2534c4120607140052k738c4ca6r452631138991a0dd@mail.gmail.com>
	<Pine.GSO.4.61.0607141520070.8620@cs.joensuu.fi>
	<2534c4120607140541x7f077a55g4af4eeb3922f6224@mail.gmail.com>
	<Pine.GSO.4.61.0607141554560.8620@cs.joensuu.fi>
	<2534c4120607140601s1d4da8b8u3a12de25cda8a01e@mail.gmail.com>
Message-ID: <2534c4120607140612w209571bfv9641823317f3088c@mail.gmail.com>

Hi Petteri,

unfortunately not, the reprojected tif image has always the same
displacement. I think the problem occurs between the transformation from
Swiss National System (CH1903) to WGS84 system.

thanks you for your advice

Best Regards

zhonghai


On 7/14/06, Zhonghai Wang <zhonghaiw@gmail.com> wrote:
>
>  Hi Petteri,
>
> I hope the old version will work fine for the reprojection. I am going to
> try it now. Thanks for this important info.
>
> kind regards
>
> zhonghai
>
>
> On 7/14/06, Petteri Packalen <packalen@cs.joensuu.fi> wrote:
> >
> > Hi,
> >
> > http://iweb.gdal.org/dl/fwtools/
> >
> > and then download a6 version according your OS. I used Windows version.
> >
> > Best regards,
> > Petteri
> >
> > On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> >
> > > Hi Petteri,
> > >
> > > I am using the latest version FWTools1.0.5, which version do you mean?
> > > FWTools a6? never heard.
> > >
> > > if possible, can you give me a link for the version you mentioned?
> > >
> > > thanks a lot
> > >
> > > zhonghai
> > >
> > > On 7/14/06, Petteri Packalen < packalen@cs.joensuu.fi> wrote:
> > >>
> > >> Hi,
> > >>
> > >> This just a guess: what version of GDAL are you using? I had similar
> > kind
> > >> of problem about one month ago before I left to summer holiday. I
> > >> downloaded the newest FWTools version and when I tried to transform
> > some
> > >> images from Finnish kkj to EUREF FIN coordinate system datum shift
> > was not
> > >> applied. EUREF FIN is basically ETRS89 / UTM 35N. When I revert back
> > to
> > >> FTTools alpha 6 everything worked propely. I don't remember what was
> > >> actual gdal versions in these FWTools releases. Please try FWTools a6
> > if
> > >> possible.
> > >>
> > >> I didn't remember to fill a bug report. I will look at it later when
> > I
> > >> come back to office.
> > >>
> > >> Best regards,
> > >> Petteri
> > >>
> > >> On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> > >>
> > >> > Hi Andrew,
> > >> >
> > >> > you are right, in the most cases the GDAL utilities work well, and
> > I've
> > >> also
> > >> > use the GDAL utilities for a long time, especially the FWTools made
> > by
> > >> > Frank, we should all thank Frank for such a wonderful GIS toolkit.
> > >> >
> > >> > I've check again and again with the GDALWARP, but things are not
> > going
> > >> in
> > >> > the right way. I am trying to translate the TIF images from the
> > >> coordinate
> > >> > system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and
> > >> there
> > >> > are always  some displacement with the base maps, I am sure that
> > the
> > >> base
> > >> > map and the original coordinate info for the TIF is correct. and
> > here is
> > >> an
> > >> > example:
> > >> >
> > >> > (the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE
> > 32N)
> > >> >
> > >> > the TIF image coordinate Info (*.tif): (Swiss National System)
> > >> > 0.500000
> > >> > 0.000000
> > >> > 0.000000
> > >> > -0.500000
> > >> > 598125.250000
> > >> > 199999.750000
> > >> >
> > >> > If I transform the coordinate to WGS84 with GDAL, the value is:
> > >> >
> > >> > 0.0000059839
> > >> > 0.0000000000
> > >> > 0.0000000000
> > >> > -0.0000059839
> > >> > 7.4149523128
> > >> > 46.9529994915
> > >> >
> > >> > but the lon/lat of the upper left corner should be:
> > >> >
> > >> > 7.41401039348263
> > >> > 46.9510762167473
> > >> >
> > >> > I would say that this is already big difference, because If I use
> > this
> > >> > lon/lat to get the UTM coordinate, this small difference will be
> > >> propagated,
> > >> > and will cause a displacement about hundreds meters.
> > >> >
> > >> > I am trying to find the source code, which does this coordinate
> > >> > transformation, so that I can check if the transformation
> > parameters are
> > >> > correct, but unfortunately I can not find the source for this.
> > >> >
> > >> >
> > >> > If someone has done something similar, please point me out how to
> > fix
> > >> this
> > >> > problem, especially the GIS people in Switzerland. I would really
> > >> appreciate
> > >> > it.
> > >> >
> > >> > zhonghai
> > >> >
> > >> > On 7/14/06, Andrew Williams < awilliams@rapidmap.com.au> wrote:
> > >> >>
> > >> >> zhonghai,
> > >> >> I've litterally translated hundereds of TIF's from all over the
> > world
> > >> from
> > >> >> multiple projections to multiple projections. I have also had
> > >> "failures".
> > >> >> However, in every case, it was either my fault in specifying the
> > -s_srs
> > >> or
> > >> >> -t_srs. In some cases the fault lay in the original image. The
> > TIFF
> > >> itself
> > >> >> was supplied with incorrect georefernceing information and so it
> > was
> > >> never
> > >> >> going to work.
> > >> >>
> > >> >> Have you got a dump from GDALINFO that we can see and the GDALwarp
> > >> command
> > >> >> line you've used?
> > >> >>
> > >> >> regards
> > >> >> Andrew
> > >> >>
> > >> >>        -----Original Message-----
> > >> >>        From: Zhonghai Wang [mailto: zhonghaiw@gmail.com]
> > >> >>        Sent: Fri 7/14/2006 12:14 AM
> > >> >>        To: gdal-dev@lists.maptools.org
> > >> >>        Cc:
> > >> >>        Subject: [Gdal-dev] need tools for TIF image reprojection
> > >> >>
> > >> >>
> > >> >>        Hi guys,
> > >> >>
> > >> >>        I need a tool to reproject my TIF images, either free or
> > >> non-free
> > >> >> software.
> > >> >>        I've tried with the GDAL utilities, sure I can do the
> > >> reprojection,
> > >> >> but the coordinates seems not correct, there are serveral hundert
> > >> meters
> > >> >> displacement according to the my base maps.
> > >> >>
> > >> >>        thanks for your info.
> > >> >>
> > >> >>        zhonghai
> > >> >>
> > >> >>
> > >> >>
> > >> >>
> > >> >
> > >>
> > >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060714/6b7e01dd/attachment.html
From Charles.Wivell at dnr.state.mn.us  Fri Jul 14 09:32:22 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
Message-ID: <s4b756b7.031@co5.dnr.state.mn.us>

Hi Zhonghai;

Doing some quick calculations, the Latitude error is about 200 meters and the longitude error is about 100 meters. These errors look like the type and magnitude of errors you'd get if you didn't correctly convert from one datum to another.

So, make sure when you go from the Swiss National System to Geographic (lat, lon in Bessel 1841), you must then convert (transform) those lat, lons to ETRS89 lat, lons then project those lat, lons to UTM Zone 32N projection coord.s


Chuck Wivell



>>> "Zhonghai Wang" <zhonghaiw@gmail.com> 7/14/2006 8:12 AM >>>
Hi Petteri,

unfortunately not, the reprojected tif image has always the same
displacement. I think the problem occurs between the transformation from
Swiss National System (CH1903) to WGS84 system.

thanks you for your advice

Best Regards

zhonghai


On 7/14/06, Zhonghai Wang <zhonghaiw@gmail.com> wrote:
>
>  Hi Petteri,
>
> I hope the old version will work fine for the reprojection. I am going to
> try it now. Thanks for this important info.
>
> kind regards
>
> zhonghai
>
>
> On 7/14/06, Petteri Packalen <packalen@cs.joensuu.fi> wrote:
> >
> > Hi,
> >
> > http://iweb.gdal.org/dl/fwtools/ 
> >
> > and then download a6 version according your OS. I used Windows version.
> >
> > Best regards,
> > Petteri
> >
> > On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> >
> > > Hi Petteri,
> > >
> > > I am using the latest version FWTools1.0.5, which version do you mean?
> > > FWTools a6? never heard.
> > >
> > > if possible, can you give me a link for the version you mentioned?
> > >
> > > thanks a lot
> > >
> > > zhonghai
> > >
> > > On 7/14/06, Petteri Packalen < packalen@cs.joensuu.fi> wrote:
> > >>
> > >> Hi,
> > >>
> > >> This just a guess: what version of GDAL are you using? I had similar
> > kind
> > >> of problem about one month ago before I left to summer holiday. I
> > >> downloaded the newest FWTools version and when I tried to transform
> > some
> > >> images from Finnish kkj to EUREF FIN coordinate system datum shift
> > was not
> > >> applied. EUREF FIN is basically ETRS89 / UTM 35N. When I revert back
> > to
> > >> FTTools alpha 6 everything worked propely. I don't remember what was
> > >> actual gdal versions in these FWTools releases. Please try FWTools a6
> > if
> > >> possible.
> > >>
> > >> I didn't remember to fill a bug report. I will look at it later when
> > I
> > >> come back to office.
> > >>
> > >> Best regards,
> > >> Petteri
> > >>
> > >> On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> > >>
> > >> > Hi Andrew,
> > >> >
> > >> > you are right, in the most cases the GDAL utilities work well, and
> > I've
> > >> also
> > >> > use the GDAL utilities for a long time, especially the FWTools made
> > by
> > >> > Frank, we should all thank Frank for such a wonderful GIS toolkit.
> > >> >
> > >> > I've check again and again with the GDALWARP, but things are not
> > going
> > >> in
> > >> > the right way. I am trying to translate the TIF images from the
> > >> coordinate
> > >> > system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and
> > >> there
> > >> > are always  some displacement with the base maps, I am sure that
> > the
> > >> base
> > >> > map and the original coordinate info for the TIF is correct. and
> > here is
> > >> an
> > >> > example:
> > >> >
> > >> > (the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE
> > 32N)
> > >> >
> > >> > the TIF image coordinate Info (*.tif): (Swiss National System)
> > >> > 0.500000
> > >> > 0.000000
> > >> > 0.000000
> > >> > -0.500000
> > >> > 598125.250000
> > >> > 199999.750000
> > >> >
> > >> > If I transform the coordinate to WGS84 with GDAL, the value is:
> > >> >
> > >> > 0.0000059839
> > >> > 0.0000000000
> > >> > 0.0000000000
> > >> > -0.0000059839
> > >> > 7.4149523128
> > >> > 46.9529994915
> > >> >
> > >> > but the lon/lat of the upper left corner should be:
> > >> >
> > >> > 7.41401039348263
> > >> > 46.9510762167473
> > >> >
> > >> > I would say that this is already big difference, because If I use
> > this
> > >> > lon/lat to get the UTM coordinate, this small difference will be
> > >> propagated,
> > >> > and will cause a displacement about hundreds meters.
> > >> >
> > >> > I am trying to find the source code, which does this coordinate
> > >> > transformation, so that I can check if the transformation
> > parameters are
> > >> > correct, but unfortunately I can not find the source for this.
> > >> >
> > >> >
> > >> > If someone has done something similar, please point me out how to
> > fix
> > >> this
> > >> > problem, especially the GIS people in Switzerland. I would really
> > >> appreciate
> > >> > it.
> > >> >
> > >> > zhonghai
> > >> >
> > >> > On 7/14/06, Andrew Williams < awilliams@rapidmap.com.au> wrote:
> > >> >>
> > >> >> zhonghai,
> > >> >> I've litterally translated hundereds of TIF's from all over the
> > world
> > >> from
> > >> >> multiple projections to multiple projections. I have also had
> > >> "failures".
> > >> >> However, in every case, it was either my fault in specifying the
> > -s_srs
> > >> or
> > >> >> -t_srs. In some cases the fault lay in the original image. The
> > TIFF
> > >> itself
> > >> >> was supplied with incorrect georefernceing information and so it
> > was
> > >> never
> > >> >> going to work.
> > >> >>
> > >> >> Have you got a dump from GDALINFO that we can see and the GDALwarp
> > >> command
> > >> >> line you've used?
> > >> >>
> > >> >> regards
> > >> >> Andrew
> > >> >>
> > >> >>        -----Original Message-----
> > >> >>        From: Zhonghai Wang [mailto: zhonghaiw@gmail.com] 
> > >> >>        Sent: Fri 7/14/2006 12:14 AM
> > >> >>        To: gdal-dev@lists.maptools.org 
> > >> >>        Cc:
> > >> >>        Subject: [Gdal-dev] need tools for TIF image reprojection
> > >> >>
> > >> >>
> > >> >>        Hi guys,
> > >> >>
> > >> >>        I need a tool to reproject my TIF images, either free or
> > >> non-free
> > >> >> software.
> > >> >>        I've tried with the GDAL utilities, sure I can do the
> > >> reprojection,
> > >> >> but the coordinates seems not correct, there are serveral hundert
> > >> meters
> > >> >> displacement according to the my base maps.
> > >> >>
> > >> >>        thanks for your info.
> > >> >>
> > >> >>        zhonghai
> > >> >>
> > >> >>
> > >> >>
> > >> >>
> > >> >
> > >>
> > >
> >
>
>


From zhonghaiw at gmail.com  Fri Jul 14 09:55:56 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
In-Reply-To: <s4b756b7.030@co5.dnr.state.mn.us>
References: <s4b756b7.030@co5.dnr.state.mn.us>
Message-ID: <2534c4120607140655t39965a02v4d4f3474f3ee19f2@mail.gmail.com>

 Hi Charles,

you are right, the errors are somehow like that.

acturally, the transformation process can be done a little bit simple:

Swiss National System -> WGS84 -> ETRS89 / UTM 32N

talking about WGS84 and ETRS89, they are almost the same, so there is no
need to make any transformtion between them.

BTW, this info may be useful for you, it's a official document:

http://www.swisstopo.ch/en/online/calculation/index
http://www.swisstopo.ch/pub/down/basics/geo/system/ch1903_wgs84_en.pdf


kind regards

zhonghai


On 7/14/06, Charles Wivell <Charles.Wivell@dnr.state.mn.us> wrote:
>
> Hi Zhonghai;
>
> Doing some quick calculations, the Latitude error is about 200 meters and
> the longitude error is about 100 meters. These errors look like the type and
> magnitude of errors you'd get if you didn't correctly convert from one datum
> to another.
>
> So, make sure when you go from the Swiss National System to Geographic
> (lat, lon in Bessel 1841), you must then convert (transform) those lat, lons
> to ETRS89 lat, lons then project those lat, lons to UTM Zone 32N projection
> coord.s
>
>
> Chuck Wivell
>
>
>
> >>> "Zhonghai Wang" <zhonghaiw@gmail.com> 7/14/2006 8:12 AM >>>
> Hi Petteri,
>
> unfortunately not, the reprojected tif image has always the same
> displacement. I think the problem occurs between the transformation from
> Swiss National System (CH1903) to WGS84 system.
>
> thanks you for your advice
>
> Best Regards
>
> zhonghai
>
>
> On 7/14/06, Zhonghai Wang <zhonghaiw@gmail.com> wrote:
> >
> >  Hi Petteri,
> >
> > I hope the old version will work fine for the reprojection. I am going
> to
> > try it now. Thanks for this important info.
> >
> > kind regards
> >
> > zhonghai
> >
> >
> > On 7/14/06, Petteri Packalen <packalen@cs.joensuu.fi> wrote:
> > >
> > > Hi,
> > >
> > > http://iweb.gdal.org/dl/fwtools/
> > >
> > > and then download a6 version according your OS. I used Windows
> version.
> > >
> > > Best regards,
> > > Petteri
> > >
> > > On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> > >
> > > > Hi Petteri,
> > > >
> > > > I am using the latest version FWTools1.0.5, which version do you
> mean?
> > > > FWTools a6? never heard.
> > > >
> > > > if possible, can you give me a link for the version you mentioned?
> > > >
> > > > thanks a lot
> > > >
> > > > zhonghai
> > > >
> > > > On 7/14/06, Petteri Packalen < packalen@cs.joensuu.fi> wrote:
> > > >>
> > > >> Hi,
> > > >>
> > > >> This just a guess: what version of GDAL are you using? I had
> similar
> > > kind
> > > >> of problem about one month ago before I left to summer holiday. I
> > > >> downloaded the newest FWTools version and when I tried to transform
> > > some
> > > >> images from Finnish kkj to EUREF FIN coordinate system datum shift
> > > was not
> > > >> applied. EUREF FIN is basically ETRS89 / UTM 35N. When I revert
> back
> > > to
> > > >> FTTools alpha 6 everything worked propely. I don't remember what
> was
> > > >> actual gdal versions in these FWTools releases. Please try FWTools
> a6
> > > if
> > > >> possible.
> > > >>
> > > >> I didn't remember to fill a bug report. I will look at it later
> when
> > > I
> > > >> come back to office.
> > > >>
> > > >> Best regards,
> > > >> Petteri
> > > >>
> > > >> On Fri, 14 Jul 2006, Zhonghai Wang wrote:
> > > >>
> > > >> > Hi Andrew,
> > > >> >
> > > >> > you are right, in the most cases the GDAL utilities work well,
> and
> > > I've
> > > >> also
> > > >> > use the GDAL utilities for a long time, especially the FWTools
> made
> > > by
> > > >> > Frank, we should all thank Frank for such a wonderful GIS
> toolkit.
> > > >> >
> > > >> > I've check again and again with the GDALWARP, but things are not
> > > going
> > > >> in
> > > >> > the right way. I am trying to translate the TIF images from the
> > > >> coordinate
> > > >> > system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N,
> and
> > > >> there
> > > >> > are always  some displacement with the base maps, I am sure that
> > > the
> > > >> base
> > > >> > map and the original coordinate info for the TIF is correct. and
> > > here is
> > > >> an
> > > >> > example:
> > > >> >
> > > >> > (the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM
> ZONE
> > > 32N)
> > > >> >
> > > >> > the TIF image coordinate Info (*.tif): (Swiss National System)
> > > >> > 0.500000
> > > >> > 0.000000
> > > >> > 0.000000
> > > >> > -0.500000
> > > >> > 598125.250000
> > > >> > 199999.750000
> > > >> >
> > > >> > If I transform the coordinate to WGS84 with GDAL, the value is:
> > > >> >
> > > >> > 0.0000059839
> > > >> > 0.0000000000
> > > >> > 0.0000000000
> > > >> > -0.0000059839
> > > >> > 7.4149523128
> > > >> > 46.9529994915
> > > >> >
> > > >> > but the lon/lat of the upper left corner should be:
> > > >> >
> > > >> > 7.41401039348263
> > > >> > 46.9510762167473
> > > >> >
> > > >> > I would say that this is already big difference, because If I use
> > > this
> > > >> > lon/lat to get the UTM coordinate, this small difference will be
> > > >> propagated,
> > > >> > and will cause a displacement about hundreds meters.
> > > >> >
> > > >> > I am trying to find the source code, which does this coordinate
> > > >> > transformation, so that I can check if the transformation
> > > parameters are
> > > >> > correct, but unfortunately I can not find the source for this.
> > > >> >
> > > >> >
> > > >> > If someone has done something similar, please point me out how to
> > > fix
> > > >> this
> > > >> > problem, especially the GIS people in Switzerland. I would really
> > > >> appreciate
> > > >> > it.
> > > >> >
> > > >> > zhonghai
> > > >> >
> > > >> > On 7/14/06, Andrew Williams < awilliams@rapidmap.com.au> wrote:
> > > >> >>
> > > >> >> zhonghai,
> > > >> >> I've litterally translated hundereds of TIF's from all over the
> > > world
> > > >> from
> > > >> >> multiple projections to multiple projections. I have also had
> > > >> "failures".
> > > >> >> However, in every case, it was either my fault in specifying the
> > > -s_srs
> > > >> or
> > > >> >> -t_srs. In some cases the fault lay in the original image. The
> > > TIFF
> > > >> itself
> > > >> >> was supplied with incorrect georefernceing information and so it
> > > was
> > > >> never
> > > >> >> going to work.
> > > >> >>
> > > >> >> Have you got a dump from GDALINFO that we can see and the
> GDALwarp
> > > >> command
> > > >> >> line you've used?
> > > >> >>
> > > >> >> regards
> > > >> >> Andrew
> > > >> >>
> > > >> >>        -----Original Message-----
> > > >> >>        From: Zhonghai Wang [mailto: zhonghaiw@gmail.com]
> > > >> >>        Sent: Fri 7/14/2006 12:14 AM
> > > >> >>        To: gdal-dev@lists.maptools.org
> > > >> >>        Cc:
> > > >> >>        Subject: [Gdal-dev] need tools for TIF image reprojection
> > > >> >>
> > > >> >>
> > > >> >>        Hi guys,
> > > >> >>
> > > >> >>        I need a tool to reproject my TIF images, either free or
> > > >> non-free
> > > >> >> software.
> > > >> >>        I've tried with the GDAL utilities, sure I can do the
> > > >> reprojection,
> > > >> >> but the coordinates seems not correct, there are serveral
> hundert
> > > >> meters
> > > >> >> displacement according to the my base maps.
> > > >> >>
> > > >> >>        thanks for your info.
> > > >> >>
> > > >> >>        zhonghai
> > > >> >>
> > > >> >>
> > > >> >>
> > > >> >>
> > > >> >
> > > >>
> > > >
> > >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060714/0c371cd2/attachment.html
From condit at sdsc.edu  Fri Jul 14 10:53:51 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?
In-Reply-To: <44B6A40F.6090109@geomega.com>
Message-ID: <845AADAC1106E44996327D62097E4C6B9B8EC5@et.ad.sdsc.edu>

Hi Bryan-
I think that GDAL uses a shortcut to decide on the AAIGrid data type.
Namely: scanning the first 100 bytes only and looking for any decimal
places.  In your case it appears that the first line in all NODATA
(integers).  I think if you change the first one of those to -99999.0
you should see a change in how the driver handles the file.

-Chris

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Bryan Keith
Sent: Thursday, July 13, 2006 12:51 PM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?

I have a Float32 tif (see gdalinfo below) that I translate to a Float32 
AAIGrid (see gdal_translate below).  After the translation gdalinfo 
reports the dataset as Int16 and reports the grid maximum vastly 
different than it was before (see gdalinfo below).  The output aaigrid 
file is indeed floating point (see head output below) even though 
gdalinfo says it's int16.  When I translate this aaigrid back to a tif, 
then the new gdalinfo tif report is the same as the gdalinfo aaigrid (I 
didn't paste this stuff).  When I translate the aaigrid to an ArcInfo 
binary grid (AIG) using ArcInfo, then the output is the same as the 
original tif.  The gdalinfo report for the AIG dataset is the same as 
the original tif.  So it appears that the aaigrid writer is working 
correctly, but the aaigrid reader isn't working as expected.

A bug or am I doing something wrong?

Bryan

 >gdalinfo elkw_g.tif -mm
Driver: GTiff/GeoTIFF
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x11 Type=Float32, ColorInterp=Gray
     Computed Min/Max=1523.000,3385.788
   NoData Value=-99999

 >gdal_translate -of AAIGrid -ot Float32 elkw_g.tif elkw_g.asc
Input file size is 174, 225
0...10...20...30...40...50...60...70...80...90...100 - done.

 >gdalinfo elkw_g.asc -mm
Driver: AAIGrid/Arc/Info ASCII Grid
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x1 Type=Int16, ColorInterp=Undefined
     Computed Min/Max=1523.000,31073.000
   NoData Value=-99999

 >head -n 7 elkw_g.asc
ncols        174
nrows        225
xllcorner    683628.000000000000
yllcorner    1911258.125000000000
cellsize     1640.000000000000
NODATA_value -99999
  -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9
9999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9999
9 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -
99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -999
99 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999

-99999
-99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -99
999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -99999
  -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9
9999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -9999
9 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -
99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
-99999 -999
99 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 -99999 
1928.612915039
0625 1965.587158203125 1994.283447265625 2013.431396484375 
1997.0623779296875 21
11.51416015625 2196.006103515625 2292.074951171875 2427.913818359375 
2483.550048
828125 2456.762939453125 2558.080322265625 2680.93896484375 
2807.83984375 2850.4
55810546875 3076.365234375 3124.860107421875 2905.718017578125 
2704.766845703125
  2457.794189453125 2327.631591796875 2239.057861328125 2135.4072265625 
2071.9897
4609375 2032.28515625 1985.5416259765625 1948.4173583984375 
1905.1170654296875 1
875.913818359375 1839.749755859375 1824.07958984375 1820.505126953125 
1806.35302
734375 1767.8443603515625 -99999 -99999 -99999 -99999 -99999

Bryan Keith
GIS Specialist
Geomega, Inc.
Boulder, CO, USA
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Fri Jul 14 11:22:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?
In-Reply-To: <845AADAC1106E44996327D62097E4C6B9B8EC5@et.ad.sdsc.edu>
References: <845AADAC1106E44996327D62097E4C6B9B8EC5@et.ad.sdsc.edu>
Message-ID: <44B7B6A3.1010506@loskot.net>

Christopher Condit wrote:
> Hi Bryan-
> I think that GDAL uses a shortcut to decide on the AAIGrid data type.
> Namely: scanning the first 100 bytes only and looking for any decimal
> places.  In your case it appears that the first line in all NODATA
> (integers).  I think if you change the first one of those to -99999.0
> you should see a change in how the driver handles the file.

Christopher,

After Bug 1071
(http://bugzilla.remotesensing.org/show_bug.cgi?id=1071)
has been fixed, the AAIGrid driver scans the whole file
to search for floatpoint values.
So, now it should be no difference if the float-point value is in the
first 100 bytes or after this junk.

Bryan,

What version of GDAL are you using?
Have you tested with latest 1.3.2 or CVS?

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From Charles.Wivell at dnr.state.mn.us  Fri Jul 14 11:23:15 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] need tools for TIF image reprojection
Message-ID: <s4b770b7.046@co5.dnr.state.mn.us>

Hi Zhonghai;

Yup, I just found that document myself (but thanks). Pretty simple even though I don't read Swiss (but math is universal).

The equations shown are approximations of the full transform (pretty good ones to about 1 meter). But they assume some original datum. Maybe the images you have are not in this original datum (most likely they are ok, but might be worth checking). When you compare the original tiffs to a reference in the Swiss National System, are they accurate? If they are accurate, then the original datum is ok and there is something wrong with the transforming software.

I write custom code (MS VS C++) and it would take me about a day to write a ditty (scientific name for quick program) to convert your tiffs, but I'd need example tiffs and a reference (to make sure I got it right). 

Did you try using the individual point transform calculations on those web sites to see if GDAL matches the results from them?

Have you done a full re-projection of an image and checked its accuracy? The upper left corner values might be different if there is any rotation between the two map projections. The software either has to pad the image or cut off part of image so the image fits in the frame if there is rotation (or other non-linear differences betweent the projections).

Chuck Wivell

P.S. Sorry if you know all this already....




>>> "Zhonghai Wang" <zhonghaiw@gmail.com> 7/14/2006 8:53 AM >>>
Hi Charles,

you are right, the errors are somehow like that.

acturally, the transformation process can be done a little bit simple:

Swiss National System -> WGS84 -> ETRS89 / UTM 32N

talking about WGS84 and ETRS89, they are almost the same, so there is no
need to make any transformtion between them.

BTW, this info may be useful for you, it's a official document:

http://www.swisstopo.ch/en/online/calculation/index 
http://www.swisstopo.ch/pub/down/basics/geo/system/ch1903_wgs84_en.pdf 


kind regards

zhonghai


>>> "Zhonghai Wang" <zhonghaiw@gmail.com> 7/14/2006 2:52 AM >>>
Hi Andrew,

you are right, in the most cases the GDAL utilities work well, and I've also
use the GDAL utilities for a long time, especially the FWTools made by
Frank, we should all thank Frank for such a wonderful GIS toolkit.

I've check again and again with the GDALWARP, but things are not going in
the right way. I am trying to translate the TIF images from the coordinate
system CH1903 (Swiss National System) to ETRS89 / UTM ZONE 32N, and there
are always  some displacement with the base maps, I am sure that the base
map and the original coordinate info for the TIF is correct. and here is an
example:

(the transforming process is : CH1903 -> WGS84 -> ETRS89 / UTM ZONE 32N)

the TIF image coordinate Info (*.tif): (Swiss National System)
 0.500000
 0.000000
 0.000000
 -0.500000
 598125.250000
199999.750000

If I transform the coordinate to WGS84 with GDAL, the value is:

0.0000059839
0.0000000000
0.0000000000
-0.0000059839
7.4149523128
46.9529994915

but the lon/lat of the upper left corner should be:

7.41401039348263
46.9510762167473

I would say that this is already big difference, because If I use this
lon/lat to get the UTM coordinate, this small difference will be propagated,
and will cause a displacement about hundreds meters.

I am trying to find the source code, which does this coordinate
transformation, so that I can check if the transformation parameters are
correct, but unfortunately I can not find the source for this.


If someone has done something similar, please point me out how to fix this
problem, especially the GIS people in Switzerland. I would really appreciate
it.

zhonghai

On 7/14/06, Andrew Williams <awilliams@rapidmap.com.au> wrote:
>
> zhonghai,
> I've litterally translated hundereds of TIF's from all over the world from
> multiple projections to multiple projections. I have also had "failures".
> However, in every case, it was either my fault in specifying the -s_srs or
> -t_srs. In some cases the fault lay in the original image. The TIFF itself
> was supplied with incorrect georefernceing information and so it was never
> going to work.
>
> Have you got a dump from GDALINFO that we can see and the GDALwarp command
> line you've used?
>
> regards
> Andrew
>
>        -----Original Message-----
>        From: Zhonghai Wang [mailto:zhonghaiw@gmail.com] 
>        Sent: Fri 7/14/2006 12:14 AM
>        To: gdal-dev@lists.maptools.org 
>        Cc:
>        Subject: [Gdal-dev] need tools for TIF image reprojection
>
>
>        Hi guys,
>
>        I need a tool to reproject my TIF images, either free or non-free
> software.
>        I've tried with the GDAL utilities, sure I can do the reprojection,
> but the coordinates seems not correct, there are serveral hundert meters
> displacement according to the my base maps.
>
>        thanks for your info.
>
>        zhonghai
>
>
>
>


From bryan at geomega.com  Fri Jul 14 12:36:02 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?
In-Reply-To: <44B7B6A3.1010506@loskot.net>
References: <845AADAC1106E44996327D62097E4C6B9B8EC5@et.ad.sdsc.edu>
	<44B7B6A3.1010506@loskot.net>
Message-ID: <44B7C7F2.8050305@geomega.com>



Mateusz Loskot wrote:
> Christopher Condit wrote:
>> Hi Bryan-
>> I think that GDAL uses a shortcut to decide on the AAIGrid data type.
>> Namely: scanning the first 100 bytes only and looking for any decimal
>> places.  In your case it appears that the first line in all NODATA
>> (integers).  I think if you change the first one of those to -99999.0
>> you should see a change in how the driver handles the file.
> 
> Christopher,
> 
> After Bug 1071
> (http://bugzilla.remotesensing.org/show_bug.cgi?id=1071)
> has been fixed, the AAIGrid driver scans the whole file
> to search for floatpoint values.
> So, now it should be no difference if the float-point value is in the
> first 100 bytes or after this junk.
> 
> Bryan,
> 
> What version of GDAL are you using?

Mateusz,

 >gdalinfo --version
GDAL 1.3.2.0, FWTools 1.0.0, released 2006/05/05

> Have you tested with latest 1.3.2 or CVS?

I have not tested with CVS.

I read on bugzilla that this issue has been fixed, but it's unclear to 
me which version has the fix.  Should I be seeing the fixed version with 
the version I'm using?

Bryan

> 
> Best regards

From bryan at geomega.com  Fri Jul 14 13:39:19 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] gdalwarp and nodata values (float v int)
Message-ID: <44B7D6C7.1040609@geomega.com>

Hello again,

In the last couple days I've posted some messages regarding the AAIGrid 
driver reading integers v. floats.  That problem's not quite resolved, 
but I've done a little testing and found the following peculiarity with 
how gdalwarp handles nodata values.

I probably noticed the AAIGrid driver problem because I was using an 
integer for my nodata value in a floating point grid.  So I decided to 
test it using a floating point value (which I still haven't done yet). 
However, I get unexpected results with gdalwarp and non-integer nodata 
values.

Consider the following examples.  I start with test.tif 
(Min/Max=1508.000,3413.000) and use gdalwarp 3 different times with only 
changing the -dstnodata value.  The first time I use -dstnodata 
-3.40282e+038 (the same as my -srcnodata) and end up with 
Min/Max=-340282001837565600000000000000000000000.000,3385.788  Then I 
use -dstnodata -99999 and get the expected Min/Max=1523.000,3385.788 
Then I use -dstnodata -99999.1 and get Min/Max=-99999.102,3385.788

What's going on here?

Bryan

 >gdalinfo test.tif -mm
Driver: GTiff/GeoTIFF
Size is 1201, 1201
Coordinate System is:
Origin = (-116.000417,41.000417)
Pixel Size = (0.00083333,-0.00083333)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (-116.0004167,  41.0004167) (116d 0'1.50"W, 41d 0'1.50"N)
Lower Left  (-116.0004167,  39.9995833) (116d 0'1.50"W, 39d59'58.50"N)
Upper Right (-114.9995833,  41.0004167) (114d59'58.50"W, 41d 0'1.50"N)
Lower Right (-114.9995833,  39.9995833) (114d59'58.50"W, 39d59'58.50"N)
Center      (-115.5000000,  40.5000000) (115d30'0.00"W, 40d30'0.00"N)
Band 1 Block=1201x1 Type=Float32, ColorInterp=Gray
     Computed Min/Max=1508.000,3413.000
   NoData Value=-3.40282e+038

 >gdalwarp -s_srs EPSG:4322 -t_srs EPSG:32008 -tr 1640 1640 -te 683628 
1911258.125 968988.0 2280258.125 -rb -srcnodata -3.40282e+038 -dstnodata 
-3.40282e+038 test.tif testw.tif
Creating output file that is 174P x 225L.
Processing input file test.tif.
:0...10...20...30...40...50...60...70...80...90...100 - done.
Open GDAL Datasets:
   1 N DriverIsNULL 512x512x0

 >gdalinfo testw.tif -mm
Driver: GTiff/GeoTIFF
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x11 Type=Float32, ColorInterp=Gray
     Computed Min/Max=-340282001837565600000000000000000000000.000,3385.788
   NoData Value=-3.40282e+038

 >gdalwarp -s_srs EPSG:4322 -t_srs EPSG:32008 -tr 1640 1640 -te 683628 
1911258.125 968988.0 2280258.125 -rb -srcnodata -3.40282e+038 -dstnodata 
-99999 test.tif testw.tif
Creating output file that is 174P x 225L.
Processing input file test.tif.
:0...10...20...30...40...50...60...70...80...90...100 - done.
Open GDAL Datasets:
   1 N DriverIsNULL 512x512x0

 >gdalinfo testw.tif -mm
Driver: GTiff/GeoTIFF
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x11 Type=Float32, ColorInterp=Gray
     Computed Min/Max=1523.000,3385.788
   NoData Value=-99999

 >gdalwarp -s_srs EPSG:4322 -t_srs EPSG:32008 -tr 1640 1640 -te 683628 
1911258.125 968988.0 2280258.125 -rb -srcnodata -3.40282e+038 -dstnodata 
-99999.1 test.tif testw.tif
Creating output file that is 174P x 225L.
Processing input file test.tif.
:0...10...20...30...40...50...60...70...80...90...100 - done.
Open GDAL Datasets:
   1 N DriverIsNULL 512x512x0

 >gdalinfo testw.tif -mm
Driver: GTiff/GeoTIFF
Size is 174, 225
Coordinate System is:
Origin = (683628.000000,2280258.125000)
Pixel Size = (1640.00000000,-1640.00000000)
Metadata:
   AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  683628.000, 2280258.125) (116d 0'4.59"W, 41d 0'38.27"N)
Lower Left  (  683628.000, 1911258.125) (116d 0'40.36"W, 39d59'51.82"N)
Upper Right (  968988.000, 2280258.125) (114d58'3.19"W, 41d 0'0.09"N)
Lower Right (  968988.000, 1911258.125) (114d59'34.47"W, 39d59'14.98"N)
Center      (  826308.000, 2095758.125) (115d29'35.81"W, 40d30'0.47"N)
Band 1 Block=174x11 Type=Float32, ColorInterp=Gray
     Computed Min/Max=-99999.102,3385.788
   NoData Value=-99999.1

Bryan Keith
GIS Specialist
Geomega, Inc.
Boulder, CO, USA

From mateusz at loskot.net  Fri Jul 14 14:04:48 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AAIGrid driver reading Floating points incorrectly?
In-Reply-To: <44B7C7F2.8050305@geomega.com>
References: <845AADAC1106E44996327D62097E4C6B9B8EC5@et.ad.sdsc.edu>
	<44B7B6A3.1010506@loskot.net> <44B7C7F2.8050305@geomega.com>
Message-ID: <44B7DCC0.10602@loskot.net>

Bryan Keith wrote:
> Mateusz Loskot wrote:
>>
>> What version of GDAL are you using?
> 
> Mateusz,
> 
>>gdalinfo --version
> GDAL 1.3.2.0, FWTools 1.0.0, released 2006/05/05
> 
>> Have you tested with latest 1.3.2 or CVS?
> 
> I have not tested with CVS.
> 
> I read on bugzilla that this issue has been fixed, but it's unclear to
> me which version has the fix.  Should I be seeing the fixed version with
> the version I'm using?

Bryan,

The AAIGrid fix was release a few days after 1.3.2 release was
published, that's why it is not available in the version you're using.
So, you need to use GDAL from CVS or latest night snapshot.

If you'll have any problem with building/installing GDAL from sources,
just give me a note and I'll try to help you in this.
Sorry for this inconvenience.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Fri Jul 14 14:38:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] gdalwarp and nodata values (float v int)
In-Reply-To: <44B7D6C7.1040609@geomega.com>
References: <44B7D6C7.1040609@geomega.com>
Message-ID: <44B7E49A.4090708@pobox.com>

Bryan Keith wrote:
> Hello again,
> 
> In the last couple days I've posted some messages regarding the AAIGrid 
> driver reading integers v. floats.  That problem's not quite resolved, 
> but I've done a little testing and found the following peculiarity with 
> how gdalwarp handles nodata values.
> 
> I probably noticed the AAIGrid driver problem because I was using an 
> integer for my nodata value in a floating point grid.  So I decided to 
> test it using a floating point value (which I still haven't done yet). 
> However, I get unexpected results with gdalwarp and non-integer nodata 
> values.
> 
> Consider the following examples.  I start with test.tif 
> (Min/Max=1508.000,3413.000) and use gdalwarp 3 different times with only 
> changing the -dstnodata value.  The first time I use -dstnodata 
> -3.40282e+038 (the same as my -srcnodata) and end up with 
> Min/Max=-340282001837565600000000000000000000000.000,3385.788  Then I 
> use -dstnodata -99999 and get the expected Min/Max=1523.000,3385.788 
> Then I use -dstnodata -99999.1 and get Min/Max=-99999.102,3385.788
> 
> What's going on here?

Bryan,

I believe the problem is that some double precision values can't be
represented exactly as float32 values, and so comparisons fail.  GDAL
generally tries to pass around nodata values as double's, but of course
when they are applied to a float32 channel they will be truncated somewhat.
When the float32 values are cast back to double and compared to the
original double value they don't match.

There are things I can do to avoid some of this.  For instance, the min/max
algorithm could cast the double value to float before comparing it to
the float values from the band.

If you want to isolate particular situations where things are going wrong
and submit a bug report I can work on fixing them.  But generally, if you
are going to work with floating point channels, I would suggest picking a
nodata value that is exactly representable in floating point.  For instance,
I think powers of two would be ok, so -0.5 can be exactly represented.

I hope this helps.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From tfagin at coordinatesolutions.com  Fri Jul 14 15:16:03 2006
From: tfagin at coordinatesolutions.com (Todd Fagin)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] another gdalwarp and no data values question
Message-ID: <001201c6a779$f8d26fe0$640ba8c0@TFD620>

Greetings list.  

 

I also have a question about gdalwarp and NoData values.  

 

I am currently warping a three-band GTiff from UTM Zone 14 to Albers Equal
Area using gdal-1.3.2.  I set both the source and destination NoData values
to 0 and everything seems to run fine.  When I do gdalinfo, for instance, it
shows that 0 is the NoData value for all three bands.  However, when I view
the image with third-party software (e.g. ESRI), it does not recognize 0 as
NoData (or anything as NoData for that matter).

 

Does anyone know why this is and a possible work around for it.  

 

Todd Fagin

 

Coordinate Solutions, Inc.

501 N.E. 15th St.

Oklahoma City, OK 73104

405.246.9396 (Voice)

405.227.0781 (Fax)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060714/288495a0/attachment.html
From warmerdam at pobox.com  Fri Jul 14 15:50:30 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] another gdalwarp and no data values question
In-Reply-To: <001201c6a779$f8d26fe0$640ba8c0@TFD620>
References: <001201c6a779$f8d26fe0$640ba8c0@TFD620>
Message-ID: <44B7F586.6080809@pobox.com>

Todd Fagin wrote:
> Greetings list. 
> 
>  
> 
> I also have a question about gdalwarp and NoData values. 
> 
>  
> 
> I am currently warping a three-band GTiff from UTM Zone 14 to Albers 
> Equal Area using gdal-1.3.2.  I set both the source and destination 
> NoData values to 0 and everything seems to run fine.  When I do 
> gdalinfo, for instance, it shows that 0 is the NoData value for all 
> three bands.  However, when I view the image with third-party software 
> (e.g. ESRI), it does not recognize 0 as NoData (or anything as NoData 
> for that matter).
> 
> Does anyone know why this is and a possible work around for it. 

Todd,

There is no official way of designating nodata values in GeoTIFF, so I
have implemented a GDAL specific extension to handle it.  It may be
supported in some future version of ArcGIS.  I think the "native" way
that ArcGIS keeps track of nodata values for GeoTIFFs is in an .aux file
and currently GDAL does not know how to write an aux file that marks
the nodata values.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From perrygeo at gmail.com  Fri Jul 14 15:55:46 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] another gdalwarp and no data values question
In-Reply-To: <001201c6a779$f8d26fe0$640ba8c0@TFD620>
References: <001201c6a779$f8d26fe0$640ba8c0@TFD620>
Message-ID: <5383fa5e0607141255w6c73a1d6ra1f6b0b183eaf325@mail.gmail.com>

Todd,

On 7/14/06, Todd Fagin <tfagin@coordinatesolutions.com> wrote:
> I am currently warping a three-band GTiff from UTM Zone 14 to Albers Equal
> Area using gdal-1.3.2.  I set both the source and destination NoData values
> to 0 and everything seems to run fine.  When I do gdalinfo, for instance, it
> shows that 0 is the NoData value for all three bands.  However, when I view
> the image with third-party software (e.g. ESRI), it does not recognize 0 as
> NoData (or anything as NoData for that matter).
>

I've found that ESRI products don't really recognize some of the
GeoTIFF tags written by GDAL. I've had better luck with .img files
(HFA format) and ascii grids (AAIGrid) for this purpose.

-- 
Matt Perry
perrygeo@gmail.com
http://www.perrygeo.net

From mlepage at pyxisinnovation.com  Fri Jul 14 15:56:33 2006
From: mlepage at pyxisinnovation.com (Marc Lepage)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] gdalwarp and nodata values (float v int)
In-Reply-To: <44B7E49A.4090708@pobox.com>
Message-ID: <8B5901C2B9E9094AA4028CF5E33980D703E997@aristotle.PyxisInnovation.local>

Frank said:
There are things I can do to avoid some of this.  For instance, the
min/max
algorithm could cast the double value to float before comparing it to
the float values from the band.


Be warned that I have seen this comparison fail on Windows (VC7) as the
compiler still generated code to compare a double to a float (even with
the cast).


From ishalomo at yahoo.com  Fri Jul 14 23:21:32 2006
From: ishalomo at yahoo.com (Inessa Shalomov)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
Message-ID: <20060715032132.13772.qmail@web30612.mail.mud.yahoo.com>

Has anyone tried to extract specific metadata fields from an HDF file format with GDAL? 
   
  I am trying to use GDAL and its HDF file format support to extract specific metadata fields from an HDF file. The GetMetadataItem() call is not recognizing the metadata keys I am passing in, although according to the spec I am using, the keys are valid.
   
  I used the following code to 
  GDALDataset *poDataset;
  GDALAllRegister();
  poDataset = (GDALDataset *) GDALOpen (pszFilename, GA_ReadOnly);
  const char* retval = poDataset->GetMetadataItem(?PRODUCT_UL_CORNER_LAT?, NULL);
   
  Am I not making the right API calls for HDF? Are there any additional method calls to retrieving the metadata?
   
  Any help would be greatly appreciated.

Thanks
 		
---------------------------------
Yahoo! Messenger with Voice. Make PC-to-Phone Calls to the US (and 30+ countries) for 2?/min or less.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060714/1a4a8767/attachment.html
From danmitchell at mail.utexas.edu  Sat Jul 15 12:58:56 2006
From: danmitchell at mail.utexas.edu (Daniel Mitchell)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Re: How to propose patches?
In-Reply-To: <200607111951.k6BJpRlA010483@duke.maptools.org>
References: <200607111951.k6BJpRlA010483@duke.maptools.org>
Message-ID: <200607151158.57184.danmitchell@mail.utexas.edu>

Done. See bugs #1233 and #1234.

D.

> Daniel Mitchell wrote:
> > I'd like to propose a few patches to the GDAL code base; what are the
> > proper channels for doing so?
>
> Daniel,
>
> I would suggest submitting each as a bugzilla entry.  Depending on the
> impact of the patches, it may be desirable to write up an RFC for the
> consideration of the PSC, but if it is just routine bug fixes or feature
> improvements within the current architecture that should not be necessary.
>
> Please try to provide the patches against the current CVS development
> version, and include pointers to test data where applicable.
>
> Best regards,
> --
> ---------------------------------------+-----------------------------------
>--- I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com light and sound - activate the windows |
> http://pobox.com/~warmerdam and watch the world go round - Rush    |
> President OSGF, http://osgeo.org

From crane_ba at yahoo.com  Mon Jul 17 08:33:12 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Introducing myself and obtaining MBR geometry for TAB
	files
Message-ID: <20060717123312.97673.qmail@web52814.mail.yahoo.com>

Hello all,

Just subscribed to this list after using PHP_PGR
within Mapserver. What a great library that is! Of
course I do have a question or two:

Question 1: I am reading MapInfo TAB files. So far so
good, I can read the geometry and create SVG files
from it. One thing I cannot do is get the MBR (Minimum
Bounding Rectangle) of the data. I need to know what
geometry frames the data so I can use it within SVG as
part of the viewbox command. Does anyone know of the
PHP class/function that can pick up how much "space"
(ie, min x,y - max x,y of the dataset) the TAB vector
data actually takes up?

Question 1: A bit of a mixer. I want to use AJAX
technology to pass values back to a PHP script update
the TAB file without needing the page refreshed (page
refresh is optional so that the user can make several
edits and then refresh all at once rather than having
to refresh after every update)...I could use a
seperate PHP script, but wondered whether it would
work?

Thank you,

Ben

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From mikel_maron at yahoo.com  Mon Jul 17 09:47:37 2006
From: mikel_maron at yahoo.com (Mikel Maron)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GeoRSS
Message-ID: <20060717134737.37649.qmail@web30805.mail.mud.yahoo.com>

Hi GDAL-ists

More and more often, I'm getting requests for a tool to translate ShapeFiles into GeoRSS. 

I know it wouldn't always be appropriate for every ShapeFile, but many cases such a translator would be very useful. 

There's been discussion before, on the GeoRSS list, about adding GeoRSS support into OGR. Myself, I've simply experimented with raw text OGR output, using Perl to build GeoRSS (for in fact, the map on the front page of http://worldkit.org/).

With GeoRSS heading towards approval by various standards bodies (OGC, W3C), perhaps the time is right to add support. Any plans for this? I've looked into myself, but haven't had time to become immersed in the OGR codebase to make it happen.

Best,
Mikel



From warmerdam at pobox.com  Mon Jul 17 09:55:14 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Introducing myself and obtaining MBR geometry for
	TAB	files
In-Reply-To: <20060717123312.97673.qmail@web52814.mail.yahoo.com>
References: <20060717123312.97673.qmail@web52814.mail.yahoo.com>
Message-ID: <44BB96C2.5050606@pobox.com>

Ben Crane wrote:
> Hello all,
> 
> Just subscribed to this list after using PHP_PGR
> within Mapserver. What a great library that is! Of
> course I do have a question or two:
> 
> Question 1: I am reading MapInfo TAB files. So far so
> good, I can read the geometry and create SVG files
> from it. One thing I cannot do is get the MBR (Minimum
> Bounding Rectangle) of the data. I need to know what
> geometry frames the data so I can use it within SVG as
> part of the viewbox command. Does anyone know of the
> PHP class/function that can pick up how much "space"
> (ie, min x,y - max x,y of the dataset) the TAB vector
> data actually takes up?

Ben,

The OGRLayer class has a GetExtent() method.  I'm not certain
if that is exposed in the PHP bindings or not.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dmorissette at mapgears.com  Mon Jul 17 10:06:19 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Introducing myself and obtaining MBR geometry for
	TAB	files
In-Reply-To: <20060717123312.97673.qmail@web52814.mail.yahoo.com>
References: <20060717123312.97673.qmail@web52814.mail.yahoo.com>
Message-ID: <44BB995B.1080404@mapgears.com>

Ben Crane wrote:
> 
> Question 1: I am reading MapInfo TAB files. So far so
> good, I can read the geometry and create SVG files
> from it. One thing I cannot do is get the MBR (Minimum
> Bounding Rectangle) of the data. I need to know what
> geometry frames the data so I can use it within SVG as
> part of the viewbox command. Does anyone know of the
> PHP class/function that can pick up how much "space"
> (ie, min x,y - max x,y of the dataset) the TAB vector
> data actually takes up?
> 

You should be able to get that with OGR_L_GetExtent(), see:
http://gdal.maptools.org/ogr/ogr__api_8h.html#a150


> Question 1: A bit of a mixer. I want to use AJAX
> technology to pass values back to a PHP script update
> the TAB file without needing the page refreshed (page
> refresh is optional so that the user can make several
> edits and then refresh all at once rather than having
> to refresh after every update)...I could use a
> seperate PHP script, but wondered whether it would
> work?
> 

Calling a PHP script without refreshing the page should be possible with 
AJAX, but note that the TAB driver doesn't support update of existing 
files: your PHP script would have to create a new dataset, copy the old 
features from the original file to it, and then add the new/updated 
features.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From warmerdam at pobox.com  Mon Jul 17 10:28:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] GeoRSS
In-Reply-To: <20060717134737.37649.qmail@web30805.mail.mud.yahoo.com>
References: <20060717134737.37649.qmail@web30805.mail.mud.yahoo.com>
Message-ID: <44BB9E8C.6050808@pobox.com>

Mikel Maron wrote:
> Hi GDAL-ists
> 
> More and more often, I'm getting requests for a tool to translate
> ShapeFiles into GeoRSS.
> 
> I know it wouldn't always be appropriate for every ShapeFile, but many
> cases such a translator would be very useful.
> 
> There's been discussion before, on the GeoRSS list, about adding GeoRSS
> support into OGR. Myself, I've simply experimented with raw text OGR
> output, using Perl to build GeoRSS (for in fact, the map on the front page
> of http://worldkit.org/).
> 
> With GeoRSS heading towards approval by various standards bodies (OGC,
> W3C), perhaps the time is right to add support. Any plans for this? I've
> looked into myself, but haven't had time to become immersed in the OGR
> codebase to make it happen.

Mikel,

I too would like to see GeoRSS support in OGR, but haven't had time to
work on a driver.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Mon Jul 17 10:46:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
In-Reply-To: <20060715032132.13772.qmail@web30612.mail.mud.yahoo.com>
References: <20060715032132.13772.qmail@web30612.mail.mud.yahoo.com>
Message-ID: <44BBA2C4.8000902@pobox.com>

Inessa Shalomov wrote:
> Has anyone tried to extract specific metadata fields from an HDF file 
> format with GDAL?
>  
> I am trying to use GDAL and its HDF file format support to extract 
> specific metadata fields from an HDF file. The GetMetadataItem() call is 
> not recognizing the metadata keys I am passing in, although according to 
> the spec I am using, the keys are valid.
>  
> I used the following code to
> GDALDataset *poDataset;
> GDALAllRegister();
> poDataset = (GDALDataset *) GDALOpen (pszFilename, GA_ReadOnly);
> const char* retval = poDataset->GetMetadataItem(?PRODUCT_UL_CORNER_LAT?, 
> NULL);
>  
> Am I not making the right API calls for HDF? Are there any additional 
> method calls to retrieving the metadata?
>  
> Any help would be greatly appreciated.

Inessa,

The HDF driver will return various kinds of metadata depending on the
product and other factors.  But the best way to explore what is available
is to use gdalinfo.  The metadata support is not necessarily comprehensive.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dron at ak4719.spb.edu  Mon Jul 17 10:10:16 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
In-Reply-To: <20060715032132.13772.qmail@web30612.mail.mud.yahoo.com>
References: <20060715032132.13772.qmail@web30612.mail.mud.yahoo.com>
Message-ID: <20060717141016.GA31402@ak4719.spb.edu>

On Fri, Jul 14, 2006 at 08:21:32PM -0700, Inessa Shalomov wrote:
>   I am trying to use GDAL and its HDF file format support to extract
>   specific metadata fields from an HDF file. The GetMetadataItem()
>   call is not recognizing the metadata keys I am passing in, although
>   according to the spec I am using, the keys are valid.
>    
>   I used the following code to 
>   GDALDataset *poDataset;
>   GDALAllRegister();
>   poDataset = (GDALDataset *) GDALOpen (pszFilename, GA_ReadOnly);
>   const char* retval = poDataset->GetMetadataItem(?PRODUCT_UL_CORNER_LAT?, NULL);
>    
>   Am I not making the right API calls for HDF? Are there any
>   additional method calls to retrieving the metadata?

Inessa,

That should work in case there is "PRODUCT_UL_CORNER_LAT" record in the
metadata of your HDF file. Are you sure that your file actually contains
this record? Have you tried gdalinfo on that file? Are you opening
proper subdataset instead of the main HDF file (look here for details on
HDF subdatasets: http://www.remotesensing.org/gdal/frmt_hdf4.html)?

Regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517

From ILucena at clarku.edu  Mon Jul 17 11:50:06 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
In-Reply-To: <20060717141016.GA31402@ak4719.spb.edu>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C9AC7@Iris.ad.clarku.edu>

Hi there,

I have my last fight with HDF recently, so I would like to suggest one
or two things:

Based in some source of documentation from NASA, I guess that Inessa is
probably sure of what "product" is this HDF and that the
"PRODUCT_UL_CORNER_LAT" must be present.
 
So, my suggestion is to use HDFExplorer (there is free version available
at www.space-research.org) and open the "CoreMetadata.0" that have the
Metadata in a complete text mode.

The other suggestion is to try to read this file in some GIS that reads
LandSat7 Hierarchical Data Format (file extensions .L1*), because this
format has "PRODUCT_UL_CORNER_LAT". I goggle for "HDF
PRODUCT_UL_CORNER_LAT" and it gives me more LandSat7-HDF then HDF-EOS
file format references.

The best luck,

Ivan


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Andrey Kiselev
Sent: 17 July 2006 10:10
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Extracting HDF metadata

On Fri, Jul 14, 2006 at 08:21:32PM -0700, Inessa Shalomov wrote:
>   I am trying to use GDAL and its HDF file format support to extract
>   specific metadata fields from an HDF file. The GetMetadataItem()
>   call is not recognizing the metadata keys I am passing in, although
>   according to the spec I am using, the keys are valid.
>    
>   I used the following code to 
>   GDALDataset *poDataset;
>   GDALAllRegister();
>   poDataset = (GDALDataset *) GDALOpen (pszFilename, GA_ReadOnly);
>   const char* retval =
poDataset->GetMetadataItem("PRODUCT_UL_CORNER_LAT", NULL);
>    
>   Am I not making the right API calls for HDF? Are there any
>   additional method calls to retrieving the metadata?

Inessa,

That should work in case there is "PRODUCT_UL_CORNER_LAT" record in the
metadata of your HDF file. Are you sure that your file actually contains
this record? Have you tried gdalinfo on that file? Are you opening
proper subdataset instead of the main HDF file (look here for details on
HDF subdatasets: http://www.remotesensing.org/gdal/frmt_hdf4.html)?

Regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From C.Strobl at dlr.de  Mon Jul 17 12:01:16 2006
From: C.Strobl at dlr.de (C.Strobl@dlr.de)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] ogr and vpf
Message-ID: <9773EFADA4FF6C43A49824D50B1539A7014A8663@exbe04.intra.dlr.de>

 
hello all,
is there vpf-support with ogr for windows possible. i found with google
some hints but nothing which goes further. i tested ogr with fwd and
ms4w but i didn't find anything.
greetings from munich
christian
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060717/b0c6e6e0/attachment.html
From warmerdam at pobox.com  Mon Jul 17 13:13:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] ogr and vpf
In-Reply-To: <9773EFADA4FF6C43A49824D50B1539A7014A8663@exbe04.intra.dlr.de>
References: <9773EFADA4FF6C43A49824D50B1539A7014A8663@exbe04.intra.dlr.de>
Message-ID: <44BBC556.5060509@pobox.com>

C.Strobl@dlr.de wrote:
>  
> hello all,
> is there vpf-support with ogr for windows possible. i found with google 
> some hints but nothing which goes further. i tested ogr with fwd and 
> ms4w but i didn't find anything.
> greetings from munich
://lists.maptools.org/mailman/listinfo/gdal-dev

Christian,

The FWTools builds should include VPF support via the OGR-OGDI driver.
However, this is rather involved to use.

If you were using a VMap 0 dataset, the dataset name might look something
like:

   ogrinfo -ro gltp:/vrf/c:/v0noa/vmaplv0/noamer

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From ishalomo at yahoo.com  Mon Jul 17 16:18:47 2006
From: ishalomo at yahoo.com (Inessa Shalomov)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
In-Reply-To: <20060717141016.GA31402@ak4719.spb.edu>
Message-ID: <20060717201847.9235.qmail@web30613.mail.mud.yahoo.com>

Hello,
   
  Thanks for the info. I am not sure whether this specific file that I have contains this key  -- I'll need to get more info about this product. I was given a few HDF file formats and asked to retrieve specific fields, but I am not sure whether the products correspond to the spec I am using.
   
  I did try to use gdalinfo on the file, as well as on it's subdatasets. A lot of data was outputted, but nothing close to the field I am interested in. So, given that fact, can I conclude that the field is not available in that file? Does gdalinfo and getMetadata return all the possible metadata in that product? 
   
  Thanks,
  Inessa

Andrey Kiselev <dron@ak4719.spb.edu> wrote:
  On Fri, Jul 14, 2006 at 08:21:32PM -0700, Inessa Shalomov wrote:
> I am trying to use GDAL and its HDF file format support to extract
> specific metadata fields from an HDF file. The GetMetadataItem()
> call is not recognizing the metadata keys I am passing in, although
> according to the spec I am using, the keys are valid.
> 
> I used the following code to 
> GDALDataset *poDataset;
> GDALAllRegister();
> poDataset = (GDALDataset *) GDALOpen (pszFilename, GA_ReadOnly);
> const char* retval = poDataset->GetMetadataItem(?PRODUCT_UL_CORNER_LAT?, NULL);
> 
> Am I not making the right API calls for HDF? Are there any
> additional method calls to retrieving the metadata?

Inessa,

That should work in case there is "PRODUCT_UL_CORNER_LAT" record in the
metadata of your HDF file. Are you sure that your file actually contains
this record? Have you tried gdalinfo on that file? Are you opening
proper subdataset instead of the main HDF file (look here for details on
HDF subdatasets: http://www.remotesensing.org/gdal/frmt_hdf4.html)?

Regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


 		
---------------------------------
Groups are talking. We?re listening. Check out the handy changes to Yahoo! Groups. 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060717/207b88ee/attachment.html
From Chris.Barker at noaa.gov  Mon Jul 17 18:09:58 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] How do I make an OGRSpatialReference from this?
Message-ID: <44BC0AB6.1080601@noaa.gov>

Hi all,

In the long term, I need to be able to read a variety of geo-referenced 
raster maps, and be able to map lat/long to pixel and back again. I've 
gone through osr_tutorial.html, and been playing around with GDAL, all 
with Python. I can read the images and display them and I can get the 
sample code in the osr tutorial to work. However, for my two test data 
sets, I can't figure out how to set up an OGRSpatialReference.

My first data set is a NOAA Raster Nautical chart (BSB). when I run 
gdalinfo on it, I get:

Driver: BSB/Maptech BSB Nautical Charts
Size is 10877, 9391
Coordinate System is `'
GCP Projection = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG",7030]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG",6326]],PRIMEM["Greenwich",0,AUTHORITY["EPSG",8901]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG",9108]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG",4326]]
GCP[  0]: Id=GCP_1, Info=
           (248,8558) -> (-89.55,28.7669,0)
GCP[  1]: Id=GCP_2, Info=
           (248,483) -> (-89.55,29.3502,0)
GCP[  2]: Id=GCP_3, Info=
           (10587,483) -> (-88.7,29.3502,0)
.
.
.
<and a bunch more ...>
.
.
.
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 9391.0)
Upper Right (10877.0,    0.0)
Lower Right (10877.0, 9391.0)
Center      ( 5438.5, 4695.5)
Band 1 Block=10877x1 Type=Byte, ColorInterp=Palette
   Color Table (RGB with 12 entries)
     0: 0,0,0,255
.
.
.
It seems that the WKT is defining the datums (data?), but not the 
projection. How do i set the projection? Do I need to calculate it from 
the 50! GCPs?

My other example is a geotiff, dumped out of ESRI ArcMap. Here's what I 
get for that:

Driver: GTiff/GeoTIFF
Size is 644, 526
Coordinate System is `'
Origin = (-95.395352,29.952230)
Pixel Size = (0.00080067,-0.00080067)
Metadata:
   TIFFTAG_XRESOLUTION=96
   TIFFTAG_YRESOLUTION=96
   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Corner Coordinates:
Upper Left  ( -95.3953516,  29.9522296)
Lower Left  ( -95.3953516,  29.5310747)
Upper Right ( -94.8797171,  29.9522296)
Lower Right ( -94.8797171,  29.5310747)
Center      ( -95.1375343,  29.7416522)
Band 1 Block=644x8 Type=Byte, ColorInterp=Red
Band 2 Block=644x8 Type=Byte, ColorInterp=Green
Band 3 Block=644x8 Type=Byte, ColorInterp=Blue


For this one, I don't have a WKT, or anything else I can interpret as a 
datum or projection. I could just interpolate from the corners -- is 
that what I'm supposed to do? Is there a way to create a 
SpatialReference from this data?

As is probably clear, I'm very new to all this!

Thanks,
-Chris






-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From zhangbin at ev-image.com  Mon Jul 17 04:00:48 2006
From: zhangbin at ev-image.com (=?gb2312?B?1cWx8w==?=)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] about read Tiff File's coordinate
Message-ID: <200607171600419539288@ev-image.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: man_009.gif
Type: image/gif
Size: 1931 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060717/e7a8d4d7/man_009.gif
From zbcumtdx at 163.com  Mon Jul 17 04:02:26 2006
From: zbcumtdx at 163.com (zbcumtdx)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] About Read Tiff
Message-ID: <200607171601404685241@163.com>

hello 
    I will read a GeoTiff File. I want to know the left_top' Geo_coordinate,including longitude and latitude. Can you tell me how to read ths using gdal. It's best to give a Sample Code. thanks 

bin zhang  china 




zbcumtdx
2006-07-17
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060717/429d0a18/attachment.html
From zhonghaiw at gmail.com  Tue Jul 18 02:43:21 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] About Read Tiff
In-Reply-To: <200607171601404685241@163.com>
References: <200607171601404685241@163.com>
Message-ID: <2534c4120607172343q1d4bba4an51559585cce4b432@mail.gmail.com>

Hi,

try listgeo command, it may help you to get what you want.

kind regards

zhonghai


On 7/17/06, zbcumtdx <zbcumtdx@163.com> wrote:
>
>   hello
>     I will read a GeoTiff File. I want to know the left_top'
> Geo_coordinate,including longitude and latitude. Can you tell me how to read
> ths using gdal. It's best to give a Sample Code. thanks
>
> bin zhang  china
>
>  ------------------------------
>  zbcumtdx
> 2006-07-17
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060718/680f5614/attachment.html
From crane_ba at yahoo.com  Tue Jul 18 04:00:08 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Additional questions regarding MBR and TAB/SHP file
	update
In-Reply-To: <44BB995B.1080404@mapgears.com>
Message-ID: <20060718080008.63021.qmail@web52810.mail.yahoo.com>

Thanx you all for the response, I have a few more
questions from working on it last night if you
guys/gals don't mind?

Question 1:
Okay, so if I loaded a TAB file into the php script,
made a physical copy of it (using php copy command),
renamed it-would I be able to edit the copied file? Or
would I need to go through the php_ogr code to create
a new layer and copy the data across? I am trying to
reduce the number of calculations being performed by
the script to aid speed.

Question 2: 
Does the SHP driver allow update/write of existing
files? I don't mind making a copy of the file to work
on, but I'd rather not...I can work in SHP or TAB file
format.

Question 3: 
I have tried to use OGR_L_GetExtents. I had no idea
what it meant by "psExtent - the structure in which
the extent value will be returned." so I used a
standard variable (since it just indicated it needed a
container?) in it's place. It did return an object,
but how do I actually access the 2 coordinate sets?

Question 4:
Question 3 brings me to another point. Is there any
additional information on functions and their
parameters? Some of very simple, but there are some
where I don't quite understand what the functions are
actually looking for? I have the php code that comes
with ms4w-very helpful in many cases, but doesn't have
code for some of the smaller, less used functions.

Question 5:
I currently do not have an internet connection at
home. Is there a downloadable copy of all the OGR API
information found on the DOxygen website?

Thanx
Ben

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From schut at sarvision.nl  Tue Jul 18 04:34:57 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] How do I make an OGRSpatialReference from this?
In-Reply-To: <44BC0AB6.1080601@noaa.gov>
References: <44BC0AB6.1080601@noaa.gov>
Message-ID: <44BC9D31.6070500@sarvision.nl>

See comments inline

-------- Original Message --------
From: Christopher Barker <Chris.Barker@noaa.gov>
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] How do I make an OGRSpatialReference from this?
Date: 07/18/2006 12:09 AM
> Hi all,
>
> In the long term, I need to be able to read a variety of
> geo-referenced raster maps, and be able to map lat/long to pixel and
> back again. I've gone through osr_tutorial.html, and been playing
> around with GDAL, all with Python. I can read the images and display
> them and I can get the sample code in the osr tutorial to work.
> However, for my two test data sets, I can't figure out how to set up
> an OGRSpatialReference.
>
> My first data set is a NOAA Raster Nautical chart (BSB). when I run
> gdalinfo on it, I get:
>
> Driver: BSB/Maptech BSB Nautical Charts
> Size is 10877, 9391
> Coordinate System is `'
> GCP Projection = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG",7030]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG",6326]],PRIMEM["Greenwich",0,AUTHORITY["EPSG",8901]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG",9108]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG",4326]]
>
> GCP[  0]: Id=GCP_1, Info=
>           (248,8558) -> (-89.55,28.7669,0)
> GCP[  1]: Id=GCP_2, Info=
>           (248,483) -> (-89.55,29.3502,0)
> GCP[  2]: Id=GCP_3, Info=
>           (10587,483) -> (-88.7,29.3502,0)
> .
> .
> .
> <and a bunch more ...>
> .
> .
> .
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 9391.0)
> Upper Right (10877.0,    0.0)
> Lower Right (10877.0, 9391.0)
> Center      ( 5438.5, 4695.5)
> Band 1 Block=10877x1 Type=Byte, ColorInterp=Palette
>   Color Table (RGB with 12 entries)
>     0: 0,0,0,255
> .
> .
> .
> It seems that the WKT is defining the datums (data?), but not the
> projection. How do i set the projection? Do I need to calculate it
> from the 50! GCPs?
This file is unprojected, but the georeferencing is defined by those
gcp's. Each gcp is a known georeferenced coordinate in a projected CRS
for a certain pixel. Using these gcp's, you can warp your file into a
projected raster. You can use gdalwarp for that, it comes with gdal. See
the help page on gdalwarp for more info on how to use it. But probably
it's just as simple as 'gdalwarp infile outfile' as gdalwarp will
recognize your input file's gcp's and their projection, and probably
(I'm not sure about this one) default to warping it to the projection
for which the gcps are defined. You can of course warp to another
projection. Depending on the type of file you have you might need to
specify a different order of warping, or maybe the special rubber sheet
warping which is especially good for gcp-georeferenced files sometimes.
Some trial and error might be needed.
The resulting output file will have a projection and correct corner
coordinates if you run gdalinfo on it.
>
> My other example is a geotiff, dumped out of ESRI ArcMap. Here's what
> I get for that:
>
> Driver: GTiff/GeoTIFF
> Size is 644, 526
> Coordinate System is `'
> Origin = (-95.395352,29.952230)
> Pixel Size = (0.00080067,-0.00080067)
> Metadata:
>   TIFFTAG_XRESOLUTION=96
>   TIFFTAG_YRESOLUTION=96
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Corner Coordinates:
> Upper Left  ( -95.3953516,  29.9522296)
> Lower Left  ( -95.3953516,  29.5310747)
> Upper Right ( -94.8797171,  29.9522296)
> Lower Right ( -94.8797171,  29.5310747)
> Center      ( -95.1375343,  29.7416522)
> Band 1 Block=644x8 Type=Byte, ColorInterp=Red
> Band 2 Block=644x8 Type=Byte, ColorInterp=Green
> Band 3 Block=644x8 Type=Byte, ColorInterp=Blue
>
>
> For this one, I don't have a WKT, or anything else I can interpret as
> a datum or projection. I could just interpolate from the corners -- is
> that what I'm supposed to do? Is there a way to create a
> SpatialReference from this data?
So this file has some coordinates, but lacks projection info. You cannot
create projection information out of the blue, but we could do an
estimated guess. Looking at the coordinates I'd say it is in deegrees,
not in meters. If you know what area your file should contain, you can
check this. Then I'd try a simple unprojected geographic 'projection',
which is actually a simple linear mapping from lon/lat values to pixels.
I think you can add projection info using gdal_translate (the -a_srs
option). Easiest is to use 'EPSG:4326' as srs, which is a shortcut for
geographic latlong. so: 'gdal_translate -a_srs "EPSG:4326" infile
outfile'. This will give you a new file with the projection info added.
You can then check using a GIS or other reference data if the output
file's projection matches the real world situation.

Hope this helps,

Vincent.
>
> As is probably clear, I'm very new to all this!
>
> Thanks,
> -Chris
>
>
>
>
>
>



From dron at ak4719.spb.edu  Tue Jul 18 06:02:33 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Extracting HDF metadata
In-Reply-To: <20060717201847.9235.qmail@web30613.mail.mud.yahoo.com>
References: <20060717141016.GA31402@ak4719.spb.edu>
	<20060717201847.9235.qmail@web30613.mail.mud.yahoo.com>
Message-ID: <20060718100233.GA3215@ak4719.spb.edu>

On Mon, Jul 17, 2006 at 01:18:47PM -0700, Inessa Shalomov wrote:
>   Thanks for the info. I am not sure whether this specific file that I
>   have contains this key  -- I'll need to get more info about this
>   product. I was given a few HDF file formats and asked to retrieve
>   specific fields, but I am not sure whether the products correspond
>   to the spec I am using.
>    
>   I did try to use gdalinfo on the file, as well as on it's
>   subdatasets. A lot of data was outputted, but nothing close to the
>   field I am interested in. So, given that fact, can I conclude that
>   the field is not available in that file? Does gdalinfo and
>   getMetadata return all the possible metadata in that product? 

Well, it should, but bugs are possible, of course. Try the third party
viewers to manually explore the metadata records (I am using hdfview or
hdflook).

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From nbarker at ittvis.com  Tue Jul 18 10:02:27 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>

Hi,

 

I have built gdal using the Microsoft .Net SDK, and this works fine, all
the binaries -  gdalinfo, gdal_translate,  everything works ok.  

 

I then proceeded to build the swig java libraries (I have done this on
linux - works fine, just need to test on windows), these also build
fine.  However when I run 

 

java -Djava.library.path -cp .;gdal.jar;apps gdalinfo 

 

I get the exception msvcr80.dll not found - which is true it isn't!  The
assembly version in the manifest files doesn't match any in
C:\WINDOWS\WinSxS however it works fine with the main GDAL build.  Does
anyone have any ideas on how to fix this?  If I could make it point to a
different assembly I might be ok. 

Thanks,

 

Norman

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060718/50620c0c/attachment.html
From ILucena at clarku.edu  Tue Jul 18 10:11:21 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C9BDC@Iris.ad.clarku.edu>

Remove "/MD" from nmake.opt, OPTFLAGS.

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Norman Barker
Sent: 18 July 2006 10:02
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors

 

Hi,

 

I have built gdal using the Microsoft .Net SDK, and this works fine, all
the binaries -  gdalinfo, gdal_translate,  everything works ok.  

 

I then proceeded to build the swig java libraries (I have done this on
linux - works fine, just need to test on windows), these also build
fine.  However when I run 

 

java -Djava.library.path -cp .;gdal.jar;apps gdalinfo 

 

I get the exception msvcr80.dll not found - which is true it isn't!  The
assembly version in the manifest files doesn't match any in
C:\WINDOWS\WinSxS however it works fine with the main GDAL build.  Does
anyone have any ideas on how to fix this?  If I could make it point to a
different assembly I might be ok. 

Thanks,

 

Norman

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060718/5ce873e5/attachment.html
From mateusz at loskot.net  Tue Jul 18 10:19:38 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
Message-ID: <44BCEDFA.2060605@loskot.net>

Norman Barker wrote:
> Hi,
> 
> I have built gdal using the Microsoft .Net SDK, and this works fine, all
> the binaries -  gdalinfo, gdal_translate,  everything works ok. 
> 
> I then proceeded to build the swig java libraries (I have done this on
> linux - works fine, just need to test on windows), these also build
> fine.  However when I run
> 
> java ?Djava.library.path ?cp .;gdal.jar;apps gdalinfo
> 
> I get the exception msvcr80.dll not found ? which is true it isn?t!  The
> assembly version in the manifest files doesn?t match any in
> C:\WINDOWS\WinSxS however it works fine with the main GDAL build.  Does
> anyone have any ideas on how to fix this?  If I could make it point to a

Have you read these posts?

http://lists.maptools.org/pipermail/gdal-dev/2005-December/007534.html
http://lists.maptools.org/pipermail/gdal-dev/2005-December/007535.html

and this one:
http://forums.microsoft.com/msdn/showpost.aspx?postid=15218&siteid=1

You should be able to find solution there.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From duncan.clarkson at ed.ac.uk  Tue Jul 18 10:52:28 2006
From: duncan.clarkson at ed.ac.uk (Duncan Clarkson)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] AutoCAD DXF/DWG - Large File Support
Message-ID: <44BCF5AC.5010306@ed.ac.uk>

DWGdirect Version 1.14.02
GDAL 1.3.2
Ubuntu Linux 6.06

Hi,

I'm having trouble with DXF conversions on large files using the ODA 
DWGdirect libs:

$ ogr2ogr -f "DXF" output England_low_soa_2001.gml
terminate called after throwing an instance of 'std::bad_alloc'
  what():  St9bad_alloc

This file is 645Mb. I've tried running the conversion several times with 
no luck. My machine also grinds to nearly a complete standstill after 
10-15mins of heavy duty processing. I ran 'top' to look at system usage 
and my 2Gb RAM and a 4Gb swap partition were maxed out and CPU usage was 
around 98%. I tried using 'nice' to relieve pressure a bit but it didn't 
help much.

I've had success with smaller files, around 1.8Mb and find that these 
conversions are very quick.

Does anyone have any ideas?

Regards,

Duncan Clarkson



From nbarker at ittvis.com  Tue Jul 18 11:17:04 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131A01@bath.uk.rsinc.com>



-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, July 18, 2006 3:20 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] swig - gdal msvcr80.dll errors

Norman Barker wrote:
> Hi,
> 
> I have built gdal using the Microsoft .Net SDK, and this works fine,
all
> the binaries -  gdalinfo, gdal_translate,  everything works ok. 
> 
> I then proceeded to build the swig java libraries (I have done this on
> linux - works fine, just need to test on windows), these also build
> fine.  However when I run
> 
> java -Djava.library.path -cp .;gdal.jar;apps gdalinfo
> 
> I get the exception msvcr80.dll not found - which is true it isn't!
The
> assembly version in the manifest files doesn't match any in
> C:\WINDOWS\WinSxS however it works fine with the main GDAL build.
Does
> anyone have any ideas on how to fix this?  If I could make it point to
a

Have you read these posts?

http://lists.maptools.org/pipermail/gdal-dev/2005-December/007534.html
http://lists.maptools.org/pipermail/gdal-dev/2005-December/007535.html

and this one:
http://forums.microsoft.com/msdn/showpost.aspx?postid=15218&siteid=1

You should be able to find solution there.

Best regards
-- 
Mateusz Loskot


Thanks for your help, I have seen these posts and the manifest files are
with the dlls / exes.  I think the important thing here is the main
executables work it is just the swig part.  Do you have any other ideas?

Thanks,

Norman


From mateusz at loskot.net  Tue Jul 18 11:25:39 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E8131A01@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E8131A01@bath.uk.rsinc.com>
Message-ID: <44BCFD73.7050207@loskot.net>

Norman Barker wrote:
>> Mateusz Loskot wrote:
>> 
>> Have you read these posts?
>> 
>> http://lists.maptools.org/pipermail/gdal-dev/2005-December/007534.html
>> http://lists.maptools.org/pipermail/gdal-dev/2005-December/007535.html
>> 
>> and this one: 
>> http://forums.microsoft.com/msdn/showpost.aspx?postid=15218&siteid=1
>> 
>> You should be able to find solution there.
> 
> 
> Thanks for your help, I have seen these posts and the manifest files
> are with the dlls / exes.  I think the important thing here is the
> main executables work it is just the swig part.  Do you have any 
> other ideas?

I understand but sorry I have no idea what's going wrong.
I've never used SWIG on Windows, so I'm not able to help you.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From nbarker at ittvis.com  Tue Jul 18 12:33:01 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] swig - gdal msvcr80.dll errors
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131A02@bath.uk.rsinc.com>



-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, July 18, 2006 4:26 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] swig - gdal msvcr80.dll errors

Norman Barker wrote:
>> Mateusz Loskot wrote:
>> 
>> Have you read these posts?
>> 
>>
http://lists.maptools.org/pipermail/gdal-dev/2005-December/007534.html
>>
http://lists.maptools.org/pipermail/gdal-dev/2005-December/007535.html
>> 
>> and this one: 
>> http://forums.microsoft.com/msdn/showpost.aspx?postid=15218&siteid=1
>> 
>> You should be able to find solution there.
> 
> 
> Thanks for your help, I have seen these posts and the manifest files
> are with the dlls / exes.  I think the important thing here is the
> main executables work it is just the swig part.  Do you have any 
> other ideas?

I understand but sorry I have no idea what's going wrong.
I've never used SWIG on Windows, so I'm not able to help you.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________


Thanks anyway for your help, why can't everything be as simple on
windows as on linux :-).  Probably why I like java, ant makes life easy.

To make the swig part build and run, I created project files in vc++
express (the other free distro), and linked against gdal.lib, and build
each jni dll in turn.  Works well now, hopefully this will help anyone
else who has the same problem.

Thanks,

Norman


From byhisdeeds at gmail.com  Tue Jul 18 13:58:36 2006
From: byhisdeeds at gmail.com (John Preston)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Using gdal_merge to set pixels to transparent where
	nodata exists
Message-ID: <14320c890607181058m78850a17s716b61c114381638@mail.gmail.com>

I'm using gdal_merge.py to combine a number of images into one. In
some cases there will be empty spaces in the output image, which I
wish to have set as transparent. Is there a way to set the pixels of
the output image to transparent before the merging starts, I'm
thinking some sort of -co NAME=PARAM option.

John

From ishalomo at yahoo.com  Tue Jul 18 15:19:51 2006
From: ishalomo at yahoo.com (Inessa Shalomov)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] LANDSAT 7 ETM+ HDF file
Message-ID: <20060718191951.7896.qmail@web30605.mail.mud.yahoo.com>

Hello Everyone,
   
  Thank you so much for all the help and answers. As a result of the couple forum discussions, I am beginning to question the following:
   
  Does GDAL HDF support LANDSAT 7 ETM+ HDF file formats? 
   
  Thanks,
  Inessa

 		
---------------------------------
Do you Yahoo!?
 Everyone is raving about the  all-new Yahoo! Mail Beta.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060718/77ccb64c/attachment.html
From Charles.Wivell at dnr.state.mn.us  Tue Jul 18 15:33:47 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] LANDSAT 7 ETM+ HDF file
Message-ID: <s4bcf169.096@co5.dnr.state.mn.us>

Hi;

Why would you want Landsat 7 ETM+ data in the Huge Dumb Format. When I was at EROS I fought hard so that users could order the data in other more standard formats, such as GeoTiff.

Chuck

=====================================
Charles Wivell
MN DNR Forestry/Resource Assessment
413 SE 13th Street
Grand Rapids, MN 55744
218-327-4449 x 233
=====================================

>>> Inessa Shalomov <ishalomo@yahoo.com> 7/18/2006 2:19 PM >>>
Hello Everyone,
   
  Thank you so much for all the help and answers. As a result of the couple forum discussions, I am beginning to question the following:
   
  Does GDAL HDF support LANDSAT 7 ETM+ HDF file formats? 
   
  Thanks,
  Inessa

 		
---------------------------------
Do you Yahoo!?
 Everyone is raving about the  all-new Yahoo! Mail Beta.



From Martin.Spott at mgras.net  Tue Jul 18 17:08:12 2006
From: Martin.Spott at mgras.net (Martin Spott)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] ogr2ogr issues for vmap0 on Ubuntu Breezy
References: <8A141D7E-2E54-4762-8471-15A2AB4C27DB@sauder.ubc.ca>
Message-ID: <e9jijr$10dc$1@osprey.mgras.de>

"Putler, Dan" wrote:

> On a related note, if someone has copies of the shapefile versions of  
> the political boundaries, allowing me to obtain them from you would  
> be greatly appreciated (yes, it is giving a man a fish, not teaching  
> him to fish, but it solves my short term problem).

Try this one and see if it's complete enough for your purpose:

  ftp://ftp.ihg.uni-duisburg.de/FlightGear/TGShapes/landmass_default.tar.bz2

Cheers,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------

From warmerdam at pobox.com  Tue Jul 18 17:47:00 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Using gdal_merge to set pixels to transparent where
	nodata exists
In-Reply-To: <14320c890607181058m78850a17s716b61c114381638@mail.gmail.com>
References: <14320c890607181058m78850a17s716b61c114381638@mail.gmail.com>
Message-ID: <44BD56D4.5050501@pobox.com>

John Preston wrote:
> I'm using gdal_merge.py to combine a number of images into one. In
> some cases there will be empty spaces in the output image, which I
> wish to have set as transparent. Is there a way to set the pixels of
> the output image to transparent before the merging starts, I'm
> thinking some sort of -co NAME=PARAM option.

John,

This does not currently exist, and *could* be added.  But I'm hesitant
to wedge too many more features into gdal_merge.py which I'm trying to
superceed with gdalwarp.

But if you feel the need, it should be relatively easy to add a pass
over the file, setting it to some initial nodata value after it's
creation.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From cfis at savagexi.com  Tue Jul 18 20:50:33 2006
From: cfis at savagexi.com (Charlie Savage)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Re: swig - gdal msvcr80.dll errors
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
References: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
Message-ID: <44BD81D9.9090109@savagexi.com>

This is the best explanation I've seen on how unmanaged assemblies work 
(which is what you build with VC 2005).

http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm

Charlie

Norman Barker wrote:
> Hi,
> 
>  
> 
> I have built gdal using the Microsoft .Net SDK, and this works fine, all 
> the binaries -  gdalinfo, gdal_translate,  everything works ok. 
> 
>  
> 
> I then proceeded to build the swig java libraries (I have done this on 
> linux - works fine, just need to test on windows), these also build 
> fine.  However when I run
> 
>  
> 
> java ?Djava.library.path ?cp .;gdal.jar;apps gdalinfo
> 
>  
> 
> I get the exception msvcr80.dll not found ? which is true it isn?t!  The 
> assembly version in the manifest files doesn?t match any in 
> C:\WINDOWS\WinSxS however it works fine with the main GDAL build.  Does 
> anyone have any ideas on how to fix this?  If I could make it point to a 
> different assembly I might be ok.
> 
> Thanks,
> 
>  
> 
> Norman
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From wolfgang.qual at gmx.net  Wed Jul 19 03:27:09 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Black border (null value) after changing projection:
	possible to remove this?
Message-ID: <200607190927.10482.wolfgang.qual@gmx.net>

Hi gdal-list,
Recently, I had to change the projection of some satellite tiles. I used 
gdalwarp for this purpose and it worked perfectly. 
The only thing is: as the tiles were rotated a little bit, black triangles 
(representing null-values) appear because of the rotation).
When I load these tiles in one view or a mapserver map, these black triangles 
overlay adjacent tiles a little bit. 
Therefore my question:
Is there a possiblity to remove these "triangles" resp.: can I define them as 
transparent? I would like to put them into a mapserver map using gdaltindex.

I would be grateful for some comments about this.

Best regards,
Wolfgang




From schut at sarvision.nl  Wed Jul 19 04:22:39 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] Black border (null value) after changing projection:
	possible to remove this?
In-Reply-To: <200607190927.10482.wolfgang.qual@gmx.net>
References: <200607190927.10482.wolfgang.qual@gmx.net>
Message-ID: <44BDEBCF.9010706@sarvision.nl>

-------- Original Message --------
From: wqual <wolfgang.qual@gmx.net>
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Black border (null value) after changing
projection:    possible to remove this?
Date: 07/19/2006 09:27 AM
> Hi gdal-list,
> Recently, I had to change the projection of some satellite tiles. I used 
> gdalwarp for this purpose and it worked perfectly. 
> The only thing is: as the tiles were rotated a little bit, black triangles 
> (representing null-values) appear because of the rotation).
> When I load these tiles in one view or a mapserver map, these black triangles 
> overlay adjacent tiles a little bit. 
> Therefore my question:
> Is there a possiblity to remove these "triangles" resp.: can I define them as 
> transparent? I would like to put them into a mapserver map using gdaltindex.
>
> I would be grateful for some comments about this.
>   
You can do this in mapserver by defining an OFFSITE <rgb color>
parameter in your raster layers in your mapfile. This works as long as
those triangles are really constant of color, or in other words: they'd
better not be jpegs because the jpeg compression will add noise to your
nice black areas. We've been using this trick extensively to overlay
raster imagery (landsat scenes, etc) on other data using mapserver,
including raster on raster. It works perfectly. See the mapserver
mapfile documentation (layer object, offsite parameter) for more info.

Regards,
Vincent.
> Best regards,
> Wolfgang
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>   



From zhonghaiw at gmail.com  Wed Jul 19 05:40:15 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:16 2007
Subject: [Gdal-dev] about the geotifcp.exe and tiffset.exe
Message-ID: <2534c4120607190240t1b646480r346ca826ab18aad2@mail.gmail.com>

Hi Frank,

I am using your latest version FWTools, and it's helping me do perfect job.
Now I am trying to process my raster tif images with the utilities in the
bin folder.

Since the tiepoint info is written in the file header, I use the command
geotifcp.exe to overwrite the tiepoint information with the option "-e", but
there is one problem here, I use the listgeo command to get the tiff
information, and here is the differences between the source file and the
destination file:

Source file:

  Tagged_Information:
     ModelTiepointTag (2,3):
        0                0                0
        379331.313       5201160.5        0
     ModelPixelScaleTag (1,3):
        0.499941386      0.499941386      0
     End_Of_Tags.

Destination file:

  Tagged_Information:
     ModelTiepointTag (2,3):
        0.5              0.5              0
        379255.02        5200948.64       0
     ModelPixelScaleTag (1,3):
        0.5              0.5              0
   End_Of_Tags.

The worldfile I used for the update:

0.500000000000
0.000000000000
0.000000000000
-0.500000000000
379255.019591209250
5200948.639273808300

Usually, the ModelTiepointTag info should like (in my opinions):

ModelTiepointTag (2,3):
        0              0              0
        379255.02        5200948.64       0

but the destination file gives another information.

after the update, I can not open the updated tif image any more, therefore I
am wondering if the tiepoint info causes this problem.

I found the tiffset.exe information here:

http://www.remotesensing.org/libtiff/man/tiffset.1.html

but there is no such a command in the FWTools. I've tried to compile the
tiff library downloaded from :
http://dl.maptools.org/dl/libtiff/

unfortunately, I did not get it.

is there any other way to modify the tif header? or to force the tif images
to use a existing tfw file?

thanks for any hints to solve the problem.

kind regards

zhonghai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060719/e7b41c24/attachment.html
From dron at ak4719.spb.edu  Wed Jul 19 05:52:38 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] LANDSAT 7 ETM+ HDF file
In-Reply-To: <20060718191951.7896.qmail@web30605.mail.mud.yahoo.com>
References: <20060718191951.7896.qmail@web30605.mail.mud.yahoo.com>
Message-ID: <20060719095238.GA8193@ak4719.spb.edu>

On Tue, Jul 18, 2006 at 12:19:51PM -0700, Inessa Shalomov wrote:
>   Thank you so much for all the help and answers. As a result of the
>   couple forum discussions, I am beginning to question the following:
>    
>   Does GDAL HDF support LANDSAT 7 ETM+ HDF file formats? 

Inessa,

Generally speaking, GDAL supports any HDF format. In case of HDF-EOS
formats the level of support depends on product type. In any case, all
metadata should be read and reported, in some cases they can be
unparsed, but reported anyway (in "raw" form).

Also I am agree with Charles and recomment avoid HDF based products if
it is possible. For Landsat there are GeoTIFF and raw ASCII labeled
options exist.

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mateusz at loskot.net  Wed Jul 19 06:55:00 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Re: swig - gdal msvcr80.dll errors
In-Reply-To: <44BD81D9.9090109@savagexi.com>
References: <B67A5FB7A8114B47A70517C9C0D102E8131A00@bath.uk.rsinc.com>
	<44BD81D9.9090109@savagexi.com>
Message-ID: <44BE0F84.2000206@loskot.net>

Charlie Savage wrote:
> This is the best explanation I've seen on how unmanaged assemblies
> work (which is what you build with VC 2005).
> 
> http://www.grimes.demon.co.uk/workshops/fusWSThirteen.htm

Charlie,

Thanks!
This is gread explanation indeed.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ILucena at clarku.edu  Wed Jul 19 07:27:30 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] LANDSAT 7 ETM+ HDF file
In-Reply-To: <20060718191951.7896.qmail@web30605.mail.mud.yahoo.com>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455018C9CE2@Iris.ad.clarku.edu>

Inessa,

 

The USGS Landsat Project at
http://landsat.usgs.gov/data_products/sample_products.php names some of
Landsat image products as HDF, like:

 

Enhanced Thematic Mapper Plus (ETM+) Data Products:

 

Product

Format

Download

Level 0Rp

HDF

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L0Rp>  |
gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L0Rp.tar.gz>
(295.81 MB)

Level 1R

HDF

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L1R>  |
gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L1R.tar.gz>
(368.08 MB)

Level 1G

HDF

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L1G_HDF>  |
gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L1G_HDF.tar.gz
>  (271.36 MB)

 

GeoTiff

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L1G_tif>  |
gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L1G_tif.tar.gz
>  (271.52 MB)

 

Fast-L7A

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L1G_fast>
|  gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L1G_fast.tar.g
z> (133.58 MB)

 

NDF

 ftp <ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/slc_on/single/L1G_NDF>  |
gzip
<ftp://edclpdsftp.cr.usgs.gov/SAMPLE/DATA/files/on_single_L1G_NDF.tar.gz
>  (261.52 MB)

 

But that is just an identity mistake. In this case HDF means
Hierarchical Data Format, but the internal binary data structure is not
the same as in a HDF-EOS version 4 or 5, that GDAL supports.

 

If you download one o those "HDF" above you end up with a bunch of files
with names like: 

 

L71039037_03720030325_B10.L1R

L71039037_03720030325_B20.L1R

L71039037_03720030325_B30.L1R

L71039037_03720030325_B40.L1R

L71039037_03720030325_B50.L1R

L71039037_03720030325_B61.L1R

L71039037_03720030325_CAL.L1R

L71039037_03720030325_GEO.L1R

L71039037_03720030325_HDF.L1R

L71039037_03720030325_MSD.L1R

L71039037_03720030325_MTA.L1R

L71039037_03720030325_MTL.L1R

L71039037_03720030325_PCD.L1R

L71039037_03720030325_SLO.L1R

L72039037_03720030325_B62.L1R

L72039037_03720030325_B70.L1R

L72039037_03720030325_B80.L1R

L72039037_03720030325_CAL.L1R

L72039037_03720030325_MTA.L1R

L72039037_03720030325_SLO.L1R

L72039037_03720030917_B62.L1R

L72039037_03720030917_B70.L1R

L72039037_03720030917_B80.L1R

L72039037_03720030917_CAL.L1R

 

You can read those files in a commercial GIS like Idrisi or Envi or in a
free GIS like Spring or Grass. All of then have an old but good Landsat
import functionality that in most of the cases will ask the user which
format of Landsat are they talking about, HDF, NDF, GeoTiff... I calling
it old because they precede the existence of HDF-EOS 4 satellite images,
like those from Modis, Aqua or Aster.

 

But to make matter worst, the individual file
L71039037_03720030325_HDF.L1R in this example is a truly HDF! But it's
used just as a header file, as a directory of the real thing that comes
in the bands files (_B10.LR1, _B20,LR2). GDAL's gdalinfo can read the
sub-dataset list from that "HDF" but that is all. By the way, the
metadata is on _MTA.L1R, but it doesn't seams useful.

 

So I agree with Andrey's advice that you should get a GeoTiff version of
that data and GDAL will handle it.

 

CASE CLOSED, I guess.

 

But for a GDAL development perspective, I don't think is worth to
investigate it, but I think that once you call the hdf and hdf-eos
libraries you probably should be able to ask for the data anyway even if
it's in another companion file. As an experiment, I tried to open the
file L71039037_03720030325_HDF.L1R as an HDF-EOS in Idrisi and import
some of the bands, and it work. And I know that the code is just calling
the NCSA/NASA library to get the data. The same think happens with
HDFExplorer, I can confirm with Pedro, because I don't have access to
his code. What I am saying is that it could be a bug in the HDF4 driver.
BTW the html for HDF5 is replicating the HDF4 address.

 

Ivan Lucena

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Inessa
Shalomov
Sent: 18 July 2006 15:20
To: Gdal-dev@lists.maptools.org
Subject: [Gdal-dev] LANDSAT 7 ETM+ HDF file

 

Hello Everyone,

 

Thank you so much for all the help and answers. As a result of the
couple forum discussions, I am beginning to question the following:

 

Does GDAL HDF support LANDSAT 7 ETM+ HDF file formats? 

 

Thanks,

Inessa

  

________________________________

Do you Yahoo!?
Everyone is raving about the all-new Yahoo! Mail Beta.
<http://us.rd.yahoo.com/evt=42297/*http:/advision.webevents.yahoo.com/ha
ndraisers> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060719/100c988a/attachment.html
From wolfgang.qual at gmx.net  Wed Jul 19 08:20:30 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] *solved*: Black border after changing projection:
	possible to remove this?
In-Reply-To: <44BDEBCF.9010706@sarvision.nl>
References: <200607190927.10482.wolfgang.qual@gmx.net>
	<44BDEBCF.9010706@sarvision.nl>
Message-ID: <200607191420.31725.wolfgang.qual@gmx.net>

Hello Vincent!
Thank you very much for your message. This trick works perfect! Great!

Best regards,
Wolfgang

----8<-----------------------
Am Mittwoch 19 Juli 2006 pH:22:10 vormittags schrieb Vincent Schut:
> -------- Original Message --------
> From: wqual <wolfgang.qual@gmx.net>
> To: gdal-dev@lists.maptools.org
> Subject: [Gdal-dev] Black border (null value) after changing
> projection:    possible to remove this?
> Date: 07/19/2006 09:27 AM
>
> > Hi gdal-list,
> > Recently, I had to change the projection of some satellite tiles. I used
> > gdalwarp for this purpose and it worked perfectly.
> > The only thing is: as the tiles were rotated a little bit, black
> > triangles (representing null-values) appear because of the rotation).
> > When I load these tiles in one view or a mapserver map, these black
> > triangles overlay adjacent tiles a little bit.
> > Therefore my question:
> > Is there a possiblity to remove these "triangles" resp.: can I define
> > them as transparent? I would like to put them into a mapserver map using
> > gdaltindex.
> >
> > I would be grateful for some comments about this.
>
> You can do this in mapserver by defining an OFFSITE <rgb color>
> parameter in your raster layers in your mapfile. This works as long as
> those triangles are really constant of color, or in other words: they'd
> better not be jpegs because the jpeg compression will add noise to your
> nice black areas. We've been using this trick extensively to overlay
> raster imagery (landsat scenes, etc) on other data using mapserver,
> including raster on raster. It works perfectly. See the mapserver
> mapfile documentation (layer object, offsite parameter) for more info.
>
> Regards,
> Vincent.
>
> > Best regards,
> > Wolfgang
> >
> >
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

From nbarker at ittvis.com  Wed Jul 19 08:51:21 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GDAL swig - allregister()
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131A09@bath.uk.rsinc.com>


Hi,

This is such a minor change, but is it possible to add
gdal.AllRegister() in swig gdal_java.i

%pragma(java) jniclasscode=%{
  private static boolean available = false;

  static {
    try {
      System.loadLibrary("gdaljni");
      gdal.AllRegister();
      available = true;
    } catch (UnsatisfiedLinkError e) {
      available = false;
      System.err.println("Native library load failed.");
      System.err.println(e);
    }
  }
  
  public static boolean isAvailable() {
    return available;
  }
%}

This makes it possible to call gdal from multiple java threads.

Thanks,

Norman


From collinsb at mitre.org  Wed Jul 19 10:26:01 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GDAL swig - allregister()
In-Reply-To: <B67A5FB7A8114B47A70517C9C0D102E8131A09@bath.uk.rsinc.com>
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92C0107C6EC@IMCSRV1.MITRE.ORG>


>-----Original Message-----
>From: gdal-dev-bounces@lists.maptools.org 
>[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Norman
Barker
>Sent: Wednesday, July 19, 2006 8:51 AM
>To: gdal-dev@lists.maptools.org
>Subject: [Gdal-dev] GDAL swig - allregister()
>
>
>Hi,
>
>This is such a minor change, but is it possible to add
>gdal.AllRegister() in swig gdal_java.i
>
>%pragma(java) jniclasscode=%{
>  private static boolean available = false;
>
>  static {
>    try {
>      System.loadLibrary("gdaljni");
>      gdal.AllRegister();
>      available = true;
>    } catch (UnsatisfiedLinkError e) {
>      available = false;
>      System.err.println("Native library load failed.");
>      System.err.println(e);
>    }
>  }
>  
>  public static boolean isAvailable() {
>    return available;
>  }
>%}
>
>This makes it possible to call gdal from multiple java threads.
>
Norman,

It is possible that one may want to access constants without
registering all drivers.  Also, the step may take some time, and so the
programmer may want to delay it for lazy loading.  In whatever class
you are writing, you could also have a static initializer that does the
RegisterAll() call, too.  I know that the apps I'm working with are
large enough that we want to avoid _all_ startup costs possible.

--
Ben Collins


From arlo.borras at dryade.net  Wed Jul 19 12:37:22 2006
From: arlo.borras at dryade.net (Arlo)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal 1.2.6 and postgis 0.9.2 OK - gdal 1.3.1 and postgis
	1.1.3 KO
Message-ID: <44BE5FC2.9020008@dryade.net>

Hi All,

I'm dealing now with a big issue on my project.
I use GDAL in my c++ code to connect to a custom database wich contains
a few geometrics data like this

CREATE TABLE arc
(
  id_arc int8 NOT NULL,
    ...
  geo_general geometry,
  geo_sectoriel geometry,
  geo_troncon geometry,
  geo_modele geometry,
  CONSTRAINT arc_pkey PRIMARY KEY (id_arc),
    ....
  CONSTRAINT enforce_geotype_geo_general CHECK
(geometrytype(geo_general) = 'LINESTRING'::text OR geo_general IS NULL),
  CONSTRAINT enforce_geotype_geo_modele CHECK (geometrytype(geo_modele)
= 'LINESTRING'::text OR geo_modele IS NULL),
  CONSTRAINT enforce_geotype_geo_sectoriel CHECK
(geometrytype(geo_sectoriel) = 'LINESTRING'::text OR geo_sectoriel IS NULL),
  CONSTRAINT enforce_geotype_geo_troncon CHECK
(geometrytype(geo_troncon) = 'LINESTRING'::text OR geo_troncon IS NULL),
  CONSTRAINT enforce_srid_geo_general CHECK (srid(geo_general) = -1),
  CONSTRAINT enforce_srid_geo_modele CHECK (srid(geo_modele) = -1),
  CONSTRAINT enforce_srid_geo_sectoriel CHECK (srid(geo_sectoriel) = -1),
  CONSTRAINT enforce_srid_geo_troncon CHECK (srid(geo_troncon) = -1)
)
WITH OIDS;

Everything works fine as long as i used gdal 1.2.6 and postgis 0.9.2,
but i need to install my project on a new platform which contains
postgis 1.1.3.

My first try with a updated postgis was'nt sucessful. My c++ code fail
on getting the geometry of my feature (feature->GetGeometryRef() = NULL)

I thought that gdal 1.2.6 isn't compatible with postgis >= 1 (new
postgresql binary stockage of geometry ?), so i try gdal 1.3.2 without
more success

Symtoms are :

    * the new orginfo (1.3.1) are silent about the two databases i test
      (postgis 0.9.2 and 1.1.3 ). It just say

./ogrinfo -al  "PG:dbname=...host=192.168.0.129 user=...password=..."
INFO: Open of `PG:dbname=...host=192.168.0.129 user=sytadin password=...'
using driver `PostgreSQL' successful.

with orginfo (1.2.6) i got tons of info displayed .

    * got NULL when i try to OGRSFDriverRegistrar::Open(
      PG:dbname=...host=192.168.0.129 user=...password=...",FALSE ) in
      my c++ program

If anyone has an idea on whats going wrong... ?

Arlo from France



From warmerdam at pobox.com  Wed Jul 19 13:11:14 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal 1.2.6 and postgis 0.9.2 OK - gdal 1.3.1 and
	postgis 1.1.3 KO
In-Reply-To: <44BE5FC2.9020008@dryade.net>
References: <44BE5FC2.9020008@dryade.net>
Message-ID: <44BE67B2.4070809@pobox.com>

Arlo wrote:
> Hi All,
> 
> I'm dealing now with a big issue on my project.
> I use GDAL in my c++ code to connect to a custom database wich contains
> a few geometrics data like this
...
> Everything works fine as long as i used gdal 1.2.6 and postgis 0.9.2,
> but i need to install my project on a new platform which contains
> postgis 1.1.3.
> 
> My first try with a updated postgis was'nt sucessful. My c++ code fail
> on getting the geometry of my feature (feature->GetGeometryRef() = NULL)
> 
> I thought that gdal 1.2.6 isn't compatible with postgis >= 1 (new
> postgresql binary stockage of geometry ?), so i try gdal 1.3.2 without
> more success
> 
> Symtoms are :
> 
>    * the new orginfo (1.3.1) are silent about the two databases i test
>      (postgis 0.9.2 and 1.1.3 ). It just say
> 
> ./ogrinfo -al  "PG:dbname=...host=192.168.0.129 user=...password=..."
> INFO: Open of `PG:dbname=...host=192.168.0.129 user=sytadin password=...'
> using driver `PostgreSQL' successful.

Arlo,

Are your layers properly registered in the GEOMETRY_COLUMNS table?
I think that at some point in history, the OGR PG driver was changed
to only treat tables listed in GEOMETRY_COLUMNS as layers.

I'm not surprised that GDAL 1.2.6 doesn't work against PostGIS 1.0+.
I'm currently using PostGIS 1.0.x, so it is possible there are some
issues with 1.1.x but I would expect them to be debilitating or I
would have heard quite a bit about it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From jeff at propertykey.com  Wed Jul 19 14:39:16 2006
From: jeff at propertykey.com (Jeff Hoffmann)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] using gdaladdo with tiled tifs
Message-ID: <44BE7C54.5020807@propertykey.com>

I have a question about the best way to create overviews in tiled tifs. 
    I've created my tifs with a block size of 512x512 with the 
understanding that this should help with performance if I'm pulling 
small blocks (say 500 x 500 pixels) from much larger images (say 20k x 
20k pixels).  So when I created that tif, I passed a bunch of command 
line configuration options to gdal_translate to get the tiling I 
selected, but when I did overviews, I just did a plain "gdaladdo my.tif 
2 4 8 16 32" without any options.  Should I be telling gdaladdo all of 
the same tiling options as when I created the tif?  Or does it just know 
to use the same configuration as when it was created?  Or doesn't it 
matter?  Also, I've chosen to compress the original tif because most of 
the usage will come from the overviews.  Do I need to tell it not to 
compress the overviews or is that the default and I actually have to 
tell it to compress the overviews?

-- 
Jeff Hoffmann
Head Plate Spinner
PropertyKey.com

From warmerdam at pobox.com  Wed Jul 19 15:56:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] using gdaladdo with tiled tifs
In-Reply-To: <44BE7C54.5020807@propertykey.com>
References: <44BE7C54.5020807@propertykey.com>
Message-ID: <44BE8E83.7070804@pobox.com>

Jeff Hoffmann wrote:
> I have a question about the best way to create overviews in tiled tifs. 
>    I've created my tifs with a block size of 512x512 with the 
> understanding that this should help with performance if I'm pulling 
> small blocks (say 500 x 500 pixels) from much larger images (say 20k x 
> 20k pixels).  So when I created that tif, I passed a bunch of command 
> line configuration options to gdal_translate to get the tiling I 
> selected, but when I did overviews, I just did a plain "gdaladdo my.tif 
> 2 4 8 16 32" without any options.  Should I be telling gdaladdo all of 
> the same tiling options as when I created the tif?  

Jeff,

I don't think you have much control over options used to create the
overviews.  I believe GDAL by default uses a 256x256 tile size for
overviews which should be ok in your situation.

 > Or does it just know
> to use the same configuration as when it was created?  Or doesn't it 
> matter?  Also, I've chosen to compress the original tif because most of 
> the usage will come from the overviews.  Do I need to tell it not to 
> compress the overviews or is that the default and I actually have to 
> tell it to compress the overviews?

I *think* GDAL uses the same compression type for overviews as for the
main image which should be OK, though if you prefer not to have the overviews
compressed, I'm not sure that provides a way of controlling it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From nharding at extendthereach.com  Wed Jul 19 17:45:37 2006
From: nharding at extendthereach.com (Ned Harding)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Exceptions/Win32
Message-ID: <3B6819E719271748B923CE3CDBD4EC98914F24@srcmail1.extendthereach.com>

FYI - we found a very annoying and subtle bug recently in OGR when your
custom error handling throws an exception (in VC 7.1).  The default
project is built with /EHsc, and for a variety of reasons the exception
is not handled properly by the compiler and Mutex's don't properly
unlock, creating a deadlock condition later on.  Needless to say, this
was not fun to debug.  So anyway, if you throw an exception from the
function you registered in CPLSetErrorHandler, make sure that you
compile GDAL/OGR with /EHa instead of /EHsc and all will be well.
 
Ned
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060719/ada05814/attachment.html
From jeff at propertykey.com  Wed Jul 19 18:55:23 2006
From: jeff at propertykey.com (Jeff Hoffmann)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] using gdaladdo with tiled tifs
In-Reply-To: <44BE8E83.7070804@pobox.com>
References: <44BE7C54.5020807@propertykey.com> <44BE8E83.7070804@pobox.com>
Message-ID: <44BEB85B.4070904@propertykey.com>

Frank Warmerdam wrote:
> Jeff Hoffmann wrote:
> 
>> I have a question about the best way to create overviews in tiled 
>> tifs.    I've created my tifs with a block size of 512x512 with the 
>> understanding that this should help with performance if I'm pulling 
>> small blocks (say 500 x 500 pixels) from much larger images (say 20k x 
>> 20k pixels).  So when I created that tif, I passed a bunch of command 
>> line configuration options to gdal_translate to get the tiling I 
>> selected, but when I did overviews, I just did a plain "gdaladdo 
>> my.tif 2 4 8 16 32" without any options.  Should I be telling gdaladdo 
>> all of the same tiling options as when I created the tif?  
> 
> 
> Jeff,
> 
> I don't think you have much control over options used to create the
> overviews.  I believe GDAL by default uses a 256x256 tile size for
> overviews which should be ok in your situation.

Thanks for the quick reply, Frank.  I've made up a few files like I said 
& the performance seems fine that way, I was just wondering if I should 
be doing anything else before going off and processing several hundred 
GBs of tifs.

>  > Or does it just know
> 
>> to use the same configuration as when it was created?  Or doesn't it 
>> matter?  Also, I've chosen to compress the original tif because most 
>> of the usage will come from the overviews.  Do I need to tell it not 
>> to compress the overviews or is that the default and I actually have 
>> to tell it to compress the overviews?
> 
> 
> I *think* GDAL uses the same compression type for overviews as for the
> main image which should be OK, though if you prefer not to have the 
> overviews
> compressed, I'm not sure that provides a way of controlling it.

Actually, I guess with fairly small tiles compressed overviews may not 
be such a bad thing since I won't be particularly CPU-constrained and 
they should decompress pretty quickly.  Maybe some benchmarking might be 
in order.  I think the thing that got me wondering this is that you 
don't really see much information about the overviews other than their 
size so I guess I just always assumed they replicated the settings of 
the original image.

-- 
Jeff Hoffmann
Head Plate Spinner
PropertyKey.com

From warmerdam at pobox.com  Wed Jul 19 21:28:20 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] using gdaladdo with tiled tifs
In-Reply-To: <44BEB85B.4070904@propertykey.com>
References: <44BE7C54.5020807@propertykey.com> <44BE8E83.7070804@pobox.com>
	<44BEB85B.4070904@propertykey.com>
Message-ID: <44BEDC34.907@pobox.com>

Jeff Hoffmann wrote:
> Actually, I guess with fairly small tiles compressed overviews may not 
> be such a bad thing since I won't be particularly CPU-constrained and 
> they should decompress pretty quickly.  Maybe some benchmarking might be 
> in order.  I think the thing that got me wondering this is that you 
> don't really see much information about the overviews other than their 
> size so I guess I just always assumed they replicated the settings of 
> the original image.

Jeff,

You can see details about them with the tiffinfo application if needed.
It is part of libtiff, but can be found in FWTools.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From arlo.borras at dryade.net  Thu Jul 20 03:50:39 2006
From: arlo.borras at dryade.net (Arlo)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal 1.2.6 and postgis 0.9.2 OK - gdal 1.3.1 and
	postgis 1.1.3 KO
In-Reply-To: <44BE67B2.4070809@pobox.com>
References: <44BE5FC2.9020008@dryade.net> <44BE67B2.4070809@pobox.com>
Message-ID: <44BF35CF.3010507@dryade.net>


Frank Warmerdam a ?crit :
> Arlo wrote:
>> Hi All,
>>
>> I'm dealing now with a big issue on my project.
>> I use GDAL in my c++ code to connect to a custom database wich contains
>> a few geometrics data like this
> ...
>> Everything works fine as long as i used gdal 1.2.6 and postgis 0.9.2,
>> but i need to install my project on a new platform which contains
>> postgis 1.1.3.
>>
>> My first try with a updated postgis was'nt sucessful. My c++ code fail
>> on getting the geometry of my feature (feature->GetGeometryRef() = NULL)
>>
>> I thought that gdal 1.2.6 isn't compatible with postgis >= 1 (new
>> postgresql binary stockage of geometry ?), so i try gdal 1.3.2 without
>> more success
>>
>> Symtoms are :
>>
>>    * the new orginfo (1.3.1) are silent about the two databases i test
>>      (postgis 0.9.2 and 1.1.3 ). It just say
>>
>> ./ogrinfo -al  "PG:dbname=...host=192.168.0.129 user=...password=..."
>> INFO: Open of `PG:dbname=...host=192.168.0.129 user=sytadin 
>> password=...'
>> using driver `PostgreSQL' successful.
>
> Arlo,
>
> Are your layers properly registered in the GEOMETRY_COLUMNS table?
> I think that at some point in history, the OGR PG driver was changed
> to only treat tables listed in GEOMETRY_COLUMNS as layers.
>
> I'm not surprised that GDAL 1.2.6 doesn't work against PostGIS 1.0+.
> I'm currently using PostGIS 1.0.x, so it is possible there are some
> issues with 1.1.x but I would expect them to be debilitating or I
> would have heard quite a bit about it.
>
> Best regards,

Frank,

You've just given me the right way. Indeed, i've never registered my 
layers in the GEOMETRY_COLUMNS table.
So, i just insert information about by layer like this :

insert into geometry_columns 
values('','public','theme_arc_general','the_geom',2,27582,'LINESTRING');
insert into geometry_columns 
values('','public','theme_arc_general_fond','the_geom',2,27582,'LINESTRING');
insert into geometry_columns 
values('','public','theme_arc_sectoriel','the_geom',2,27582,'LINESTRING');
...

After that, my programs works now perfectly

Many thanks for your helpfull response.

Arlo



From trale at centrum.cz  Thu Jul 20 07:26:55 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] creating georegistered geotiff in geographic
Message-ID: <200607201326.8938@centrum.cz>

Hello list,

I am a newbie in GDAL and want to create georergistered getiff in geographic coords. Can you help me with this effort? Also, is this a good place to post such questions?

Thanks a lot,
Nick



From jeff at propertykey.com  Thu Jul 20 10:49:24 2006
From: jeff at propertykey.com (Jeff Hoffmann)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] using gdaladdo with tiled tifs
In-Reply-To: <44BEDC34.907@pobox.com>
References: <44BE7C54.5020807@propertykey.com> <44BE8E83.7070804@pobox.com>
	<44BEB85B.4070904@propertykey.com> <44BEDC34.907@pobox.com>
Message-ID: <44BF97F4.7060204@propertykey.com>

Frank Warmerdam wrote:
> Jeff Hoffmann wrote:
> 
>> Actually, I guess with fairly small tiles compressed overviews may not 
>> be such a bad thing since I won't be particularly CPU-constrained and 
>> they should decompress pretty quickly.  Maybe some benchmarking might 
>> be in order.  I think the thing that got me wondering this is that you 
>> don't really see much information about the overviews other than their 
>> size so I guess I just always assumed they replicated the settings of 
>> the original image.
> 
> 
> Jeff,
> 
> You can see details about them with the tiffinfo application if needed.
> It is part of libtiff, but can be found in FWTools.

Wow, if I would have known about that program I wouldn't have had to ask 
my question.  Turns out you were close on the overviews.  The block size 
is 128x128 not 256x256, but I wasn't able to change it using --config 
options to gdaladdo.  Also, the compression does seem to carry over to 
the overviews.  I wasn't able to create uncompressed overviews from 
compressed source (it crashed), nor was I able to add compressed 
overviews to an uncompressed source (even though the documentation seems 
to suggest you can).

-- 
Jeff Hoffmann
Head Plate Spinner
PropertyKey.com

From nbarker at ittvis.com  Thu Jul 20 12:41:54 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] java swig create options
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131A18@bath.uk.rsinc.com>

Hi,

When I use createCopy from Java and pass in a vector of create options,
where each option in the vector is expressed as a string name=value, it
has no effect on the output image.

However using gdal_translate .. -CO "NAME=VALUE" and I get the desired
result. Is this a bug, or is there a slightly different way of passing
in create options from Java?

Thanks,

Norman


From dmorissette at mapgears.com  Fri Jul 21 07:17:55 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Link to RFCs on gdal.ogr
Message-ID: <44C0B7E3.2020202@mapgears.com>

Frank,

I was looking for a link to the GDAL RFCs on gdal.org and didn't find 
it. Is there a link to a list of RFCs somewhere on the website? If not 
then perhaps one should be added to the homepage.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From mateusz at loskot.net  Fri Jul 21 07:46:27 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Broken links report
Message-ID: <44C0BE93.9000309@loskot.net>

Hi,

Yesterday, I found broken in the OGRSFDriver API docs.
The link is pointing to the old domain velocet.ca.
So, I decided to find where velocet.ca is used else.
Here is the report with questions:

1. gdal/frmts/gxf/gxf.dox

Files linked:
ftp://gdal.velocet.ca/pub/outgoing/gxf3_1_0.tar.gz
ftp://gdal.velocet.ca/pub/outgoing/gxf3_1_0.zip

Where these files live now?

2. gdal/frmts/sdts/sdts_main.dox

Files linked:
http://gdal.velocet.ca/projects/iso8211/index.html
ftp://gdal.velocet.ca/pub/outgoing/sdts_1_3.tar.gz
ftp://gdal.velocet.ca/pub/outgoing/sdts_1_3.zip

And where these files are now?

3. gdal/ogr/sfc_tutorial.dox

Files linked:
http://gdal.velocet.ca/projects/opengis/src/sfcdump.cpp

And this one?


Last question, there are many links pointing to velocet.ca in the API
manual in gdal/ogr/ogrsf_frmts/ogrsf_frmts.dox
Is this file used to generate docs available on the
http://www.gdal.org/ogr website?
And is this reasonable to update it?

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Fri Jul 21 09:05:29 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Broken links report
In-Reply-To: <44C0BE93.9000309@loskot.net>
References: <44C0BE93.9000309@loskot.net>
Message-ID: <44C0D119.8000109@pobox.com>

Mateusz Loskot wrote:
> Hi,
> 
> Yesterday, I found broken in the OGRSFDriver API docs.
> The link is pointing to the old domain velocet.ca.
> So, I decided to find where velocet.ca is used else.
> Here is the report with questions:
> 
> 1. gdal/frmts/gxf/gxf.dox
> 
> Files linked:
> ftp://gdal.velocet.ca/pub/outgoing/gxf3_1_0.tar.gz
> ftp://gdal.velocet.ca/pub/outgoing/gxf3_1_0.zip
> 
> Where these files live now?
> 
> 2. gdal/frmts/sdts/sdts_main.dox
> 
> Files linked:
> http://gdal.velocet.ca/projects/iso8211/index.html
> ftp://gdal.velocet.ca/pub/outgoing/sdts_1_3.tar.gz
> ftp://gdal.velocet.ca/pub/outgoing/sdts_1_3.zip
> 
> And where these files are now?

Mateusz,

Generally speaking gdal.velocet.ca is now known as home.gdal.org.
It *used* to be my home machine, but since my move I can't get
to my home machine from the outside world, so it is just another
virtual host on www.gdal.org.  But it doesn't include the ftp
site that was on my home machine, so there is no direct analog
to the ftp urls.

I'll take a look at updating all these.

> 3. gdal/ogr/sfc_tutorial.dox
> 
> Files linked:
> http://gdal.velocet.ca/projects/opengis/src/sfcdump.cpp
> 
> And this one?
> 
> 
> Last question, there are many links pointing to velocet.ca in the API
> manual in gdal/ogr/ogrsf_frmts/ogrsf_frmts.dox
> Is this file used to generate docs available on the
> http://www.gdal.org/ogr website?
> And is this reasonable to update it?

The GDAL web site is regenerated at least daily from CVS, including
the ogrsf_frmts.dox file.  So yes, updating it should be reflected in
the web site within 24 hours (I think more like every 6 hours).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From nicolasgabarron at yahoo.fr  Fri Jul 21 09:38:16 2006
From: nicolasgabarron at yahoo.fr (NicoSIG)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] problem with netcdf file and mercator projection
Message-ID: <5433800.post@talk.nabble.com>


Hello,

I'm working with mapserver and netcdf files.

I've two layers in my mapfile :
- a shapefile of the countries (projection latlong WGS84)
- a netcdf file (projection mercator)

here is my mapfile :

MAP
  NAME "demo"
  STATUS ON
  SIZE 800 600
  EXTENT -20037508 -12880000 20037508 17000000
  UNITS meters
  IMAGETYPE     png

  PROJECTION
      "proj=merc"
    "ellps=WGS84"
  END

  LAYER
    NAME "monde"
    DATA
"/home7/gromeo/users/ngabarro/GABARRON/Data_test/Shapefile/Cntry00.shp"
    STATUS   DEFAULT
    TYPE     LINE
    TRANSPARENCY 50

    PROJECTION
#            "+proj=merc"
        "+proj=latlong +datum=WGS84"
    END

    CLASS
      COLOR  0 0 250
    END

  END

  LAYER
     NAME "coriolis"
     DATA
'NETCDF:"/home/alboran/logiciels/apache/htdocs/mtreguer/cartoweb3/projects/sextant_test/server_conf/sextant/data/OA_20050518.nc":temperature'
     TYPE RASTER
     STATUS DEFAULT
#     EXTENT -179.5 -77.01048 180 77.01048
#      UNITS DD

     EXTENT -19981848.60 -13817585.23 20037708.34 13817585.23
     UNITS METERS

     PROJECTION
#    "proj=merc"
     "+proj=latlong"
    END

   CLASS
     NAME "C1"
      EXPRESSION ([pixel] < 20000)
      COLOR 255 0 0
   END

  END

END


If I write netcdf layer with "proj=merc", the layer doesn't appear.
If I write netcdf layer with "proj=latlong", the layer appear, but he
doesn't match with the shapefile layer (see attachment img_netcdf.jpg).
If I write EXTENT with degrees, it doesn't change.

what's the problem ?

Thanks for your help,

Best Regards, 

http://www.nabble.com/user-files/68/img_netcdf.jpg 
http://www.nabble.com/user-files/68/img_netcdf.jpg 
-- 
View this message in context: http://www.nabble.com/problem-with-netcdf-file-and-mercator-projection-tf1980293.html#a5433800
Sent from the GDAL - Dev forum at Nabble.com.


From maik.troemel at weather-consult.com  Tue Jul 18 07:40:52 2006
From: maik.troemel at weather-consult.com (=?ISO-8859-1?Q?Maik_Tr=F6mel?=)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
Message-ID: <44BCC8C4.4000004@weather-consult.com>

Hello list,

i'm searching for a documentation how to work with GDAL/OGR with python.
Probably somebody nows a link.

Thanks for help.

Greetings Maik

From maik.troemel at weather-consult.com  Tue Jul 18 07:41:53 2006
From: maik.troemel at weather-consult.com (=?ISO-8859-1?Q?Maik_Tr=F6mel?=)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
Message-ID: <44BCC901.2080209@weather-consult.com>

Hello list,

i'm searching for a documentation how to work with GDAL/OGR with python.
Probably somebody nows a link.

Thanks for help.

Greetings Maik

From maik.troemel at weather-consult.com  Tue Jul 18 07:54:08 2006
From: maik.troemel at weather-consult.com (=?ISO-8859-1?Q?Maik_Tr=F6mel?=)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
Message-ID: <44BCCBE0.3030308@weather-consult.com>

Hello list,

i'm searching for a documentation how to work with GDAL/OGR with python.
Probably somebody nows a link.

Thanks for help.

Greetings Maik

From nikk.g at perseusgst.com  Tue Jul 18 10:32:37 2006
From: nikk.g at perseusgst.com (Nikk Gotthardt-Mills)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] How to convert an 3d pointcloud txt file to an ESRI
Message-ID: <163AD1239B60284ABF4C037310B41D4F028C22@perseuscentral.Perseus.int>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 2556 bytes
Desc: image002.jpg
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060718/bdc952d6/attachment.jpe
From mateusz at loskot.net  Fri Jul 21 10:53:10 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
In-Reply-To: <44BCC8C4.4000004@weather-consult.com>
References: <44BCC8C4.4000004@weather-consult.com>
Message-ID: <44C0EA56.7020804@loskot.net>

Maik Tr?mel wrote:
> Hello list,
> 
> i'm searching for a documentation how to work with GDAL/OGR with python.
> Probably somebody nows a link.

There is no API reference for Python
but I usually generate one myself using epydoc
(http://epydoc.sourceforge.net/)

You should find hepful samples in the gdal/pymod/samples
directory on the CVS.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From hydromap at gmail.com  Fri Jul 21 11:15:05 2006
From: hydromap at gmail.com (Shoaib Burq)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
In-Reply-To: <44BCC901.2080209@weather-consult.com>
References: <44BCC901.2080209@weather-consult.com>
Message-ID: <60c6835d0607210815g54ef4df6n1aeb6a4a6135b479@mail.gmail.com>

Maik

have a look at gdalautotest. There are plenty of examples under ogr dir
http://www.gdal.org/dl/gdalautotest-1.3.2.tar.gz

also there's some stuff here http://gdal.maptools.org/ogr/
generally speaking you can all the c++ api applies to python as well.
The convention in Python is that function names start with uppercase.

HTH
shoaib

On 7/18/06, Maik Tr?mel <maik.troemel@weather-consult.com> wrote:
> Hello list,
>
> i'm searching for a documentation how to work with GDAL/OGR with python.
> Probably somebody nows a link.
>
> Thanks for help.
>
> Greetings Maik
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


From trale at centrum.cz  Fri Jul 21 12:07:55 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] cutting an image
Message-ID: <200607211807.14050@centrum.cz>

Hi list,
is there some tool tocut an geotiff image into tiles ?

Nick



From sgillies at frii.com  Fri Jul 21 12:24:20 2006
From: sgillies at frii.com (Sean Gillies)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Python API
In-Reply-To: <60c6835d0607210815g54ef4df6n1aeb6a4a6135b479@mail.gmail.com>
References: <44BCC901.2080209@weather-consult.com>
	<60c6835d0607210815g54ef4df6n1aeb6a4a6135b479@mail.gmail.com>
Message-ID: <7BE6CC13-5A7A-4806-8888-8B940DDC27E8@frii.com>

There's also good stuff at

http://hobu.biz/software/OSGIS_Hacks/index_html

On Jul 21, 2006, at 9:15 AM, Shoaib Burq wrote:

> Maik
>
> have a look at gdalautotest. There are plenty of examples under ogr  
> dir
> http://www.gdal.org/dl/gdalautotest-1.3.2.tar.gz
>
> also there's some stuff here http://gdal.maptools.org/ogr/
> generally speaking you can all the c++ api applies to python as well.
> The convention in Python is that function names start with uppercase.
>

No, the Python convention is that function names start with  
lowercase. Uppercase function names is a GDAL convention.

cheers,
Sean

> HTH
> shoaib
>
> On 7/18/06, Maik Tr?mel <maik.troemel@weather-consult.com> wrote:
>> Hello list,
>>
>> i'm searching for a documentation how to work with GDAL/OGR with  
>> python.
>> Probably somebody nows a link.
>>
>> Thanks for help.
>>
>> Greetings Maik

---
Sean Gillies
http://zcologia.com





From dylan.beaudette at gmail.com  Fri Jul 21 13:42:27 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] How to convert an 3d pointcloud txt file to an ESRI
In-Reply-To: <163AD1239B60284ABF4C037310B41D4F028C22@perseuscentral.Perseus.int>
References: <163AD1239B60284ABF4C037310B41D4F028C22@perseuscentral.Perseus.int>
Message-ID: <200607211042.28074.dylan.beaudette@gmail.com>

GRASS

On Tuesday 18 July 2006 07:32, Nikk Gotthardt-Mills wrote:
> Hi there,
>
>
>
> I saw your message "How to convert an Oracle Spatial Layer to an ESRI
> Shapefile" browsing the net for a file converter. I am trying to convert
> 3d point cloud data into an ESRI Shapefile, do you know of any such
> converters?
>
>
>
> Many thanks in advance
>
>
>
> Nikk
>
>
>
>
>
>
>
>
>
> Nikk Gotthardt-Mills
>
> Technical Analyst
>
>
>
>
>
>
>
> Perseus (Global Security Technologies) Limited
>
> The Surrey Technology Centre
>
> 40 Occam Road
>
> The Surrey Research Park
>
> Guildford
>
> Surrey  GU2 7YG
>
> United Kingdom
>
>
>
> ** +44 (0) 1483 685 489
>
> ** +44 (0) 1483 685 483
>
> ** +44 (0) 7738 801 187
>
> nikk.g@perseusgst.com <mailto:nikk.g@perseusgst.com>
>
> www.perseusgst.com <http://www.perseusgst.com/>
>
>
>
> ************************************************************************
> ***********
>
> Disclaimer:
>
> This e-mail is the property of Perseus (Global Security Technologies)
> Ltd.
>
> The message and any associated files are intended for the use of the
> recipient only, and may contain information that is confidential,
> subject to copyright or may be legally privileged.  If you are not the
> intended recipient of the message you must not use, disclose,
> distribute, copy or print any of this communication or the information
> therein.
>
> If you have received this message as a result of an addressing or
> transmission error, please notify the author by reply e-mail.
>
> Internet communications cannot be guaranteed to be secure or error-free
> as information could be intercepted, corrupted, lost, destroyed, arrive
> late or incomplete, or contain viruses.  Therefore we do not accept any
> responsibility for any omissions or errors present in the communication.
>
> Any views or opinions herein are solely those of the author, and do not
> necessarily represent those of the company.
>
> Perseus (GST) Ltd reserves the right monitor emails in accordance with
> the Telecommunications Lawful Business Practice - Interception of
> Communications Regulations 2000.

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From warmerdam at pobox.com  Fri Jul 21 13:38:34 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] cutting an image
In-Reply-To: <200607211807.14050@centrum.cz>
References: <200607211807.14050@centrum.cz>
Message-ID: <44C1111A.9050709@pobox.com>

trale@centrum.cz wrote:
> Hi list,
> is there some tool tocut an geotiff image into tiles ?

Nick,

I'm not aware of one that does it all for you.  You can use gdal_translate
to cut out a tile from a bigger image, but to auto-tile an image you
would need to write a script around that.

I think example programs for this may have been submitted previously on
this (or perhaps the mapserver-users) list so you might want to do some
searching.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From trale at centrum.cz  Fri Jul 21 14:07:15 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] cutting an image
In-Reply-To: <44C1111A.9050709@pobox.com>
References: 200607211807.14050@centrum.cz> <200607211807.14050@centrum.cz>
	<44C1111A.9050709@pobox.com>
Message-ID: <200607212007.27217@centrum.cz>


Frank,

if I gdal_translate with TILED=YES and then use splittiff from the FWTools, will that results in individual tiif tiles?

______________________________________________________________
> Od: warmerdam@pobox.com
> Komu: trale@centrum.cz
> CC: gdal-dev <gdal-dev@lists.maptools.org>
> Datum: 21.07.2006 19:37
> P?edm?t: Re: [Gdal-dev] cutting an image
>
>trale@centrum.cz wrote:
 >> Hi list,
 >> is there some tool tocut an geotiff image into tiles ?
 >
 >Nick,
 >
 >I'm not aware of one that does it all for you. ?You can use gdal_translate
 >to cut out a tile from a bigger image, but to auto-tile an image you
 >would need to write a script around that.
 >
 >I think example programs for this may have been submitted previously on
 >this (or perhaps the mapserver-users) list so you might want to do some
 >searching.
 >
 >Best regards,
 >-- 
 >---------------------------------------+--------------------------------------
 >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 >light and sound - activate the windows | http://pobox.com/~warmerdam
 >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 >
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060721/cd2c5fd9/attachment.html
From warmerdam at pobox.com  Fri Jul 21 15:04:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] cutting an image
In-Reply-To: <200607212007.27217@centrum.cz>
References: 200607211807.14050@centrum.cz>
	<200607211807.14050@centrum.cz>	<44C1111A.9050709@pobox.com>
	<200607212007.27217@centrum.cz>
Message-ID: <44C1254D.60408@pobox.com>

trale@centrum.cz wrote:
> Frank,
> 
> if I gdal_translate with TILED=YES and then use splittiff from the 
> FWTools, will that results in individual tiif tiles?

No, I'm afraid not.  I assume you mean tiffsplit, but it just splits
separate "pages" into individual files.  It doesn't split based on tile
or strip boundaries in the TIFF file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From Chris.Barker at noaa.gov  Fri Jul 21 15:54:05 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] How do i create a Mercator Projection from a BSB file?
Message-ID: <44C130DD.9010008@noaa.gov>

Hi all,

I'm trying to figure out how to map from pixel coords to lat-long (and 
back again) from a noaa raster nautical chart (BSB). gdalinfo gives this 
data that's relevant:

Driver: BSB/Maptech BSB Nautical Charts
Size is 10877, 9391
Coordinate System is `'
GCP Projection = GEOGCS["WGS 84",
DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG",7030]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG",6326]],PRIMEM["Greenwich",0,AUTHORITY["EPSG",8901]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG",9108]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG",4326]]
GCP[  0]: Id=GCP_1, Info=
           (248,8558) -> (-89.55,28.7669,0)
GCP[  1]: Id=GCP_2, Info=
           (248,483) -> (-89.55,29.3502,0)
< and a bunch more GCPs >

Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 9391.0)
Upper Right (10877.0,    0.0)
Lower Right (10877.0, 9391.0)
Center      ( 5438.5, 4695.5)


As far as I can tell, there is only Geographic Coordinate System info in 
the WKT. Here it is expanded for easier reading:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG",7030]],
         TOWGS84[0,0,0,0,0,0,0],
             AUTHORITY["EPSG",6326]],
     PRIMEM["Greenwich",0,AUTHORITY["EPSG",8901]],
     UNIT["degree",0.0174532925199433,AUTHORITY["EPSG",9108]],
     AXIS["Lat",NORTH],
     AXIS["Long",EAST],
     AUTHORITY["EPSG",4326]]

There doesn't seem to be any projection info anywhere. Except maybe 
where it says:

UNIT["degree",0.0174532925199433,AUTHORITY["EPSG",9108]]

What does the number after "degree" mean?

However, there is more data in the top of the *.kap file, that the 
driver doesn't seem to extract:

PTC/Maptech,KAPLib V5.0.0.4,12/20/2005
BSB/NA=MISSISSIPPI RIVER DELTA,NU=57,RA=10877,9391,DU=254
KNP/SC=80000,GD=NAD83,PR=MERCATOR,PP=29.133,PI=10.000,SP=Louisiana 
South,40000
     SK=0.0000000,TA=90.0000000,UN=FEET,SD=MEAN LOWER LOW 
WATER,DX=8.00,DY=8.00
KNQ/EC=RF,GD=NARC,VC=UNKNOWN,SC=MLLW,PC=MC,P1=UNKNOWN,P2=29.133
     P3=NOT_APPLICABLE,P4=NOT_APPLICABLE,GC=KK,RM=POLYNOMIAL
CED/SE=72,RE=1,ED=10/01/2004
NTM/NE=72.63,ND=12/17/2005,BF=OFF,BD=10/01/2004

Here's what I recognise and think is relevant from that:

Scale:80000
Projection: PR=MERCATOR
Reference Latitude: 29.133

Now I've dug into the osr.py, and found that SetMercator requires:

SetMercator( self, clat, clong, scale, fe, fn )

Which I think means:

#  which I think means;
#  	clat --- Latitude of the projection origin.
#       clong --- Longitude of the projection origin (central meridian?)
#	scale --- Scale factor applies to the projection origin.
#	fe --- False easting.
#	fn --- False northing."""

So where to I get that data from the above?

I think I got clat from there: 29.133
clong, I have no idea.

Scale is given as 80000, and that's the scale of the paper cahrt, but I 
don't know how to convert that to pixel coords.

Is there a False easting or False northing for this chart?

Any help would be appreciated.

Also, it seems that the BSB driver could be extracting more info than it 
does -- is there a reason for that? or does someone just need to write 
the code? If the later, than if someone can tell me what fields in 
GDALDataset should be filled with what from the *.kap[ file, I could 
probably submit a patch.

By the way, is there an easier way to do this? It seems a common need to 
create an OGRSpatialReference from the data in a GDALDataset. Is there 
an existing method to do that?

thanks,

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From trale at centrum.cz  Sat Jul 22 09:47:30 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] cutting an image
In-Reply-To: <44C1254D.60408@pobox.com>
References: 00607211807.14050@centrum.cz> <200607211807.14050@centrum.cz>
	<200607212007.27217@centrum.cz> <44C1254D.60408@pobox.com>
Message-ID: <200607221547.29485@centrum.cz>


Hi Frank,

I ended up with modifying the gdal_translate to autotile the image. The API is more user friendly then I expected. 

Thanks,

regards,
Nick

______________________________________________________________
> Od: warmerdam@pobox.com
> Komu: trale@centrum.cz
> CC: gdal-dev@lists.maptools.org
> Datum: 21.07.2006 21:03
> P?edm?t: Re: [Gdal-dev] cutting an image
>
>trale@centrum.cz wrote:
 >> Frank,
 >> 
 >> if I gdal_translate with TILED=YES and then use splittiff from the 
 >> FWTools, will that results in individual tiif tiles?
 >
 >No, I'm afraid not. ?I assume you mean tiffsplit, but it just splits
 >separate "pages" into individual files. ?It doesn't split based on tile
 >or strip boundaries in the TIFF file.
 >
 >Best regards,
 >-- 
 >---------------------------------------+--------------------------------------
 >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 >light and sound - activate the windows | http://pobox.com/~warmerdam
 >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 >
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060722/35dd5b43/attachment.html
From tutey at o2.pl  Mon Jul 24 10:08:56 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdalinfo vs Grass issues
Message-ID: <44C4D478.8040603@o2.pl>

Using todays' GDAL and GRASS CVS, gdal-grass 1.3.1.2.


Problems:

A. gdalinfo -mm reports Min/Max=nan,nan for any Grass raster exported
with r.out.gdal, [1], which is wrong - see [2] for actuall value range.

B. Also using the GDAL Grass driver wrong value is calculated, moreover
gdalinfo issues ERROR 6 twice and segfaults in the end [3].

C. ERROR 6 and segfault on gdalinfo take place for Grass rasters even if
-mm is not used [4].



Backtrace is attached.



[1]

$ r.out.gdal input=exp format=GTiff type=Float32 output=exp.tif
$ gdalinfo -mm exp.tif
Driver: GTiff/GeoTIFF
Size is 2181, 2187
Coordinate System is `'
Origin = (2009.000000,4493.000000)
Pixel Size = (1.00000000,-1.00000000)
Corner Coordinates:
Upper Left  (    2009.000,    4493.000)
Lower Left  (    2009.000,    2306.000)
Upper Right (    4190.000,    4493.000)
Lower Right (    4190.000,    2306.000)
Center      (    3099.500,    3399.500)
Band 1 Block=2181x1 Type=Float32, ColorInterp=Gray
    Computed Min/Max=nan,nan

                       	^
                      WRONG !!!

  NoData Value=nan
  Metadata:
    COLOR_TABLE_RULES_COUNT=0



[2]

$ r.info -t exp
datatype=DCELL

$ r.info -r exp
min=1.000000
max=9.999998



[3]

$ gdalinfo -mm /home/grassdata/xy/nic/cellhd/exp
Driver: GRASS/GRASS Database Rasters (5.7+)
Size is 2181, 2187
Coordinate System is `'
Origin = (2009.000000,4493.000000)
Pixel Size = (1.00000000,-1.00000000)
Corner Coordinates:
Upper Left  (    2009.000,    4493.000)
Lower Left  (    2009.000,    2306.000)
Upper Right (    4190.000,    4493.000)
Lower Right (    4190.000,    2306.000)
Center      (    3099.500,    3399.500)
Band 1 Block=2181x1 Type=Float64, ColorInterp=Gray
  Min=1.000 Max=10.000   Computed Min/Max=nan,nan

                                             ^
                                          WRONG !!!

  NoData Value=nan
  Metadata:
    COLOR_TABLE_RULES_COUNT=0
ERROR 6: SetDefaultRAT() not implemented for this format.
ERROR 6: SetDefaultRAT() not implemented for this format.
Segmentation fault (core dumped)



[4]

$ gdalinfo /home/grassdata/xy/nic/cellhd/exp
Driver: GRASS/GRASS Database Rasters (5.7+)
Size is 2181, 2187
Coordinate System is `'
Origin = (2009.000000,4493.000000)
Pixel Size = (1.00000000,-1.00000000)
Corner Coordinates:
Upper Left  (    2009.000,    4493.000)
Lower Left  (    2009.000,    2306.000)
Upper Right (    4190.000,    4493.000)
Lower Right (    4190.000,    2306.000)
Center      (    3099.500,    3399.500)
Band 1 Block=2181x1 Type=Float64, ColorInterp=Gray
  Min=1.000 Max=10.000
  NoData Value=nan
  Metadata:
    COLOR_TABLE_RULES_COUNT=0
ERROR 6: SetDefaultRAT() not implemented for this format.
ERROR 6: SetDefaultRAT() not implemented for this format.
Segmentation fault (core dumped)



Maciek
-------------- next part --------------
$ gdb gdalinfo core
GNU gdb 6.4-debian
Copyright 2005 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i486-linux-gnu"...Using host libthread_db library "/lib/tls/i686/cmov/libthread_db.so.1".

Core was generated by `gdalinfo /home/grassdata/xy/nic/cellhd/exp'.
Program terminated with signal 11, Segmentation fault.

warning: Can't read pathname for load map: Input/output error.
Reading symbols from /usr/local/lib/libgdal.so.1...done.
Loaded symbols for /usr/local//lib/libgdal.so.1
Reading symbols from /usr/lib/libpq.so.4...done.
Loaded symbols for /usr/lib/libpq.so.4
Reading symbols from /lib/tls/i686/cmov/librt.so.1...done.
Loaded symbols for /lib/tls/i686/cmov/librt.so.1
Reading symbols from /lib/tls/i686/cmov/libdl.so.2...done.
Loaded symbols for /lib/tls/i686/cmov/libdl.so.2
Reading symbols from /usr/lib/libstdc++.so.6...done.
Loaded symbols for /usr/lib/libstdc++.so.6
Reading symbols from /lib/tls/i686/cmov/libm.so.6...done.
Loaded symbols for /lib/tls/i686/cmov/libm.so.6
Reading symbols from /lib/libgcc_s.so.1...done.
Loaded symbols for /lib/libgcc_s.so.1
Reading symbols from /lib/tls/i686/cmov/libc.so.6...done.
Loaded symbols for /lib/tls/i686/cmov/libc.so.6
Reading symbols from /usr/local/lib/libgeos.so.2...done.
Loaded symbols for /usr/local//lib/libgeos.so.2
Reading symbols from /usr/local/lib/libgeos_c.so.1...done.
Loaded symbols for /usr/local//lib/libgeos_c.so.1
Reading symbols from /usr/lib/i686/cmov/libssl.so.0.9.8...done.
Loaded symbols for /usr/lib/i686/cmov/libssl.so.0.9.8
Reading symbols from /usr/lib/i686/cmov/libcrypto.so.0.9.8...done.
Loaded symbols for /usr/lib/i686/cmov/libcrypto.so.0.9.8
Reading symbols from /usr/lib/libkrb5.so.3...done.
Loaded symbols for /usr/lib/libkrb5.so.3
Reading symbols from /usr/lib/libk5crypto.so.3...done.
Loaded symbols for /usr/lib/libk5crypto.so.3
Reading symbols from /lib/libcom_err.so.2...done.
Loaded symbols for /lib/libcom_err.so.2
Reading symbols from /lib/tls/i686/cmov/libcrypt.so.1...done.
Loaded symbols for /lib/tls/i686/cmov/libcrypt.so.1
Reading symbols from /lib/tls/i686/cmov/libresolv.so.2...done.
Loaded symbols for /lib/tls/i686/cmov/libresolv.so.2
Reading symbols from /lib/tls/i686/cmov/libnsl.so.1...done.
Loaded symbols for /lib/tls/i686/cmov/libnsl.so.1
Reading symbols from /lib/tls/i686/cmov/libpthread.so.0...done.
Loaded symbols for /lib/tls/i686/cmov/libpthread.so.0
Reading symbols from /lib/ld-linux.so.2...done.
Loaded symbols for /lib/ld-linux.so.2
Reading symbols from /usr/lib/libz.so.1...done.
Loaded symbols for /usr/lib/libz.so.1
Reading symbols from /usr/lib/libkrb5support.so.0...done.
Loaded symbols for /usr/lib/libkrb5support.so.0
Reading symbols from /usr/local/lib/gdalplugins/gdal_GRASS.so...done.
Loaded symbols for /usr/local/lib/gdalplugins/gdal_GRASS.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_I.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_I.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_vask.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_vask.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_gmath.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_gmath.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_gis.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_gis.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_datetime.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_datetime.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_gproj.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_gproj.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_vect.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_vect.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_dbmibase.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_dbmibase.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_dbmiclient.so...done.Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_dbmiclient.so
Reading symbols from /usr/lib/libfftw3.so.3...done.
Loaded symbols for /usr/lib/libfftw3.so.3
Reading symbols from /lib/libncurses.so.5...done.
Loaded symbols for /lib/libncurses.so.5
Reading symbols from /usr/local/lib/libproj.so.0...done.
Loaded symbols for /usr/local//lib/libproj.so.0
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_dig2.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_dig2.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_dgl.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_dgl.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_rtree.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_rtree.so
Reading symbols from /usr/local/grass-6.1.cvs/lib/libgrass_linkm.so...done.
Loaded symbols for /usr/local/grass-6.1.cvs/lib/libgrass_linkm.so
#0  0xb7c7874a in GDALRasterAttributeTable::Serialize ()
   from /usr/local//lib/libgdal.so.1
(gdb) bt
#0  0xb7c7874a in GDALRasterAttributeTable::Serialize ()
   from /usr/local//lib/libgdal.so.1
#1  0xb7c78bb6 in GDALRasterAttributeTable::DumpReadable ()
   from /usr/local//lib/libgdal.so.1
#2  0xb7c78c2a in GDALRATDumpReadable () from /usr/local//lib/libgdal.so.1
#3  0x0804a450 in main ()
(gdb) quit
From jordi.inglada at cnes.fr  Mon Jul 24 10:14:27 2006
From: jordi.inglada at cnes.fr (Jordi Inglada)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] ORFEO Toolbox
Message-ID: <200607241415.k6OEFXI16840@cnes.fr>

Dear all,

In behalf of CNES, I have the pleasure to announce the availability of
the ORFEO Toolbox, OTB, version 1.0.

OTB is a library of remote sensing image processing algorithms developed
by CNES in the
frame of the ORFEO Accompaniment Program. It is distributed as C++
source code under a free software licence: 
<http://www.cecill.info/licences/Licence_CeCILL_V2-en.html>.

OTB is based on the medical image processing library ITK and offers
particular functionnalities for remote sensing image processing in
general and for high spatial resolution images in particular.

In this first version, OTB provides:

- image access: optimized read/write access for most of remote sensing
image formats (thanks to GDAL), meta-data access, simple visualization;
- filtering: blurring, denoising, enhancement;
- feature extraction: interest points, alignments, lines;
- image segmentation: region growing, watershed, level sets;
- classification: K-means, SVM, Markov random fields; 
- change detection.

Many of these functionnalities are provided by ITK and have been tested
and documented for the use with remote sensing data.

In order to download OTB v.1.0, go to the ORFEO web site:

http://smsc.cnes.fr/PLEIADES/A_prog_accomp.htm

and follow the "ORFEO Toolbox" link. You will have access to the OTB
source code and to the Software User's Guide. Your are invited to
download those and to read the Introduction chapter before proceeding to
the software installation.

We have tested the OTB on a several configurations (Linux, Windows, Sun
Solaris) in order to ensure the code portability. We have also developed
an automatic procedure for the configuration/installation which should
allow to compile OTB on most platforms. However, some difficulties can
appear for some specific software/hardware combinations. Do not hesitate
to give us feed-back about installation issues in order for us to
correct those.

The main information source is the OTB Software Guide. It contains
tenths of commented examples which should be a good starting point for
any new OTB user. The code source for these examples is distributed with
the toolbox. Another information source is the on-line API
documentation.

We can assist you in the installation and use of the OTB. We are also
very interested in getting feed-back on the use of the software. A
discussion group has been set up for information exchange. The details
about subscription are given in the user's guide.

Your comments and suggestions will help us improving the OTB. Do not
hesitate to express yourselves, either on the user's group or by writing
to me: jordi.inglada@cnes.fr

Finally, I would like to thank the OTB team at "Communications &
Syst?mes" for their good work.

Sincerely,

J. Inglada
-- 
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel. +33.(0)5.61.27.33.97 - Fax. +33.(0)5.61.28.31.09 




From Chris.Barker at noaa.gov  Mon Jul 24 16:12:54 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Bug in osr.py CoordinateTransformation for mercator
	projection?
Message-ID: <44C529C6.7060209@noaa.gov>

Hi all,

I'm struggling with trying to figure out how to convert pixels to 
lat/long for a raster nautical chart in BSB format.

Part of why I'm having trouble is that there is either a bug in 
osr.CoordinateTransformation, or i am missing something important in how 
it's supposed to work.

I'm trying to set up a Mercator projection with:
osr.SpatialReference.SetMercator, like so:

proj = osr.SpatialReference()
proj.SetWellKnownGeogCS( "WGS84" )
proj.SetMercator(clat = 0,
                  clong= 0,
                  scale=1,
                  fe=30,
                  fn=30,
                  )

While I'm not sure what all the parameters should be from the BSB file, 
I do have some idea. Most of the parameters behave as I suspect, except 
that the "scale" parameter seems to do nothing. It's kind of critical 
for my needs, however. Despite the value of the scale parameter not 
effecting the results, if I pass in a zero, I get an error (which I 
would expect), so it looks like the value is being passed to Proj4. What 
am I missing?

I've enclosed a little test script that does a transformation with 
different scale values, and there is no difference in the output.

Or do I need to do the scaling my self?

By the way, is there a better list to ask this on? this is the third 
related question I've asked, with nary a reply -- maybe I'm on teh wrong 
list.

-thanks,
-Chris






-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
-------------- next part --------------
A non-text attachment was scrubbed...
Name: MercatorTest.py
Type: text/x-python
Size: 1594 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060724/d48d1817/MercatorTest.py
From tutey at o2.pl  Mon Jul 24 17:58:41 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdalinfo vs Grass issues
In-Reply-To: <44C4D478.8040603@o2.pl>
References: <44C4D478.8040603@o2.pl>
Message-ID: <44C54291.9090203@o2.pl>

Maciej Sieczka napisa?(a):
> Using todays' GDAL and GRASS CVS, gdal-grass 1.3.1.2.
> 
> 
> Problems:
> 
> A. gdalinfo -mm reports Min/Max=nan,nan for any Grass raster exported
> with r.out.gdal, [1], which is wrong - see [2] for actuall value range.
> 
> B. Also using the GDAL Grass driver wrong value is calculated, moreover
> gdalinfo issues ERROR 6 twice and segfaults in the end [3].
> 
> C. ERROR 6 and segfault on gdalinfo take place for Grass rasters even if
> -mm is not used [4].

Dear All,

Forget the segfault! It was my fault - I didn't rebuild gdal-grass after
building new Grass and GDAL. Doing that fixed the ERROR 6 and segfault
(thanks to Markus Neteler for a reminder).

However, point A. and partially B. are still valid. Ie. gdalinfo -mm
reports Computed Min/Max=nan,nan for any r.out.gdal output that contains
nulls and for Grass rasters themselfs, see:

$ gdalinfo /home/grassdata/xy/nic/cellhd/exp -mm
Driver: GRASS/GRASS Database Rasters (5.7+)
Size is 2181, 2187
Coordinate System is `'
Origin = (2009.000000,4493.000000)
Pixel Size = (1.00000000,-1.00000000)
Corner Coordinates:
Upper Left  (    2009.000,    4493.000)
Lower Left  (    2009.000,    2306.000)
Upper Right (    4190.000,    4493.000)
Lower Right (    4190.000,    2306.000)
Center      (    3099.500,    3399.500)
Band 1 Block=2181x1 Type=Float64, ColorInterp=Gray
  Min=1.000 Max=10.000   Computed Min/Max=nan,nan
  NoData Value=nan
  Metadata:
    COLOR_TABLE_RULES_COUNT=0



Could this be fixed?

Maciek

From brauplists at gmail.com  Tue Jul 25 00:03:27 2006
From: brauplists at gmail.com (Bruce Raup)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] How to access 2-D arrays returned by GDALRasterIO?
In-Reply-To: <44B2ED3F.3070008@noaa.gov>
References: <1464295a0607101146kc78cea1g30a7fa545c373baa@mail.gmail.com>
	<44B2ED3F.3070008@noaa.gov>
Message-ID: <1464295a0607242103m62fd48edoce20958933099603@mail.gmail.com>

Hi Chris,

> Bruce, You're a Pythonista aren't you? You can pull a RasterBand out of
> GDAL and put it in a numpy array, and then manipulate it as 2-d data to
> your hearts content.

Good suggestion, but I've only scratched the surface in Python so far.
 So for this project, I'm writing in C.  I'm simply using the
array[i+num_x*j] style of indexing, which (I think) gcc optimizes for
anyway.

Cheers,
Bruce

-- 
Bruce Raup
http://cires.colorado.edu/~braup/

From michele.sturma at tellus.it  Tue Jul 25 06:51:56 2006
From: michele.sturma at tellus.it (Michele Sturma)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Gdalwarp: From Virtual Earth Tiles to Spherical
	projection
Message-ID: <44C5F7CC.3060702@tellus.it>

Hi,

I want to convert with gdalwarp an image (tile) downloaded with Virtual 
Earth to spherical projection.

The image is stored in png format (but no problem converting in other 
formats)

Which are the correct command line that I have to pass?


Thanks
Michele Sturma


From bartvde at xs4all.nl  Wed Jul 26 03:20:26 2006
From: bartvde at xs4all.nl (Bart van den Eijnden (OSGIS))
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GML to shapefile
Message-ID: <21195.145.50.39.8.1153898426.squirrel@webmail.xs4all.nl>

Hi list,

a while ago I reported a problem with Mapserver GML to shapefile
conversion using ogr2ogr, the dbf column names are ms:XXXX.

Has this been fixed (ie the namespace removed from the attribute name)?

Should I open up a bug report?

Best regards,
Bart


From mateusz at loskot.net  Wed Jul 26 04:37:02 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GML to shapefile
In-Reply-To: <21195.145.50.39.8.1153898426.squirrel@webmail.xs4all.nl>
References: <21195.145.50.39.8.1153898426.squirrel@webmail.xs4all.nl>
Message-ID: <44C729AE.7050104@loskot.net>

Bart van den Eijnden (OSGIS) wrote:
> Hi list,
> 
> a while ago I reported a problem with Mapserver GML to shapefile
> conversion using ogr2ogr, the dbf column names are ms:XXXX.
> 
> Has this been fixed (ie the namespace removed from the attribute name)?
> 
> Should I open up a bug report?

Hi Bart,

Obviously, I've forgot about this problem, I'm sorry.
So, please, file a bug with sample GML files attached then it won't be
forgotten.

AFAIR from our e-mails exchange you were going to file a bug with
sample data files:
http://lists.maptools.org/pipermail/gdal-dev/2006-May/008944.html

and here is your last response I got about this problem:

Bart van den Eijnden (OSGIS) wrote:
> Hi Mateusz,
>
> I have the file at work, will open up a bug on Monday and attach it to it.
>
> Best regards,
> Bart
>
> Mateusz Loskot wrote:
>
>> Bart van den Eijnden (OSGIS) wrote:
>>
>>
>>> Hi Frank, Mateusz,
>>>
>>> I am not saying it is invalid GML, I am saying the values are wrong.
>>>
>>> XMIN and YMIN in the Mapserver GML are:
>>>
>>> 192519.015625
>>> 320687.375000
>>>
>>> But in OGR's output they are both 0.
>>>
>>> I will file some bugs on Monday.
>>>
>>
>> Hi,
>>
>> Strange.
>> I have a sample of GML 2.0 file with
>>
>> <gml:boundedBy>
>> <gml:Box>
>> <gml:coordinates>
>> 278653.100,187444.800 279095.300,187898.250
>> </gml:coordinates>
>> </gml:Box>
>> </gml:boundedBy>
>>
>> and after I run
>> ogr2ogr -f "GML" test.gml MySampleGML.gml
>> the output is changed but correct:
>>
>> <gml:boundedBy>
>> <gml:Box>
>> <gml:coord><gml:X>278653.1</gml:X><gml:Y>187444.8</gml:Y></gml:coord>
>> <gml:coord><gml:X>279095.3</gml:X><gml:Y>187898.25</gml:Y></gml:coord>
>> </gml:Box>
>> </gml:boundedBy>
>>
>> I'd need to test using your GML file. Is it possible send me one?
>>
>> Cheers


-- 
Mateusz Loskot
http://mateusz.loskot.net

From dany.geotools at gmail.com  Wed Jul 26 05:11:33 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
Message-ID: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>

Hi list,

when using the command "gdalinfo --formats"
it returns a sequence of supported formats, as well as the specific driver
capabilities which are symbolized by some initials: (ro), (rw) and (rw+).

I think that (ro) means readonly while (rw) means read-write capabilities

If I'm right, what is the difference between (rw) and (rw+)?

The difference is related to Create and CreateCopy methods?

Thx a lot.

Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060726/249b4c30/attachment.html
From bartvde at xs4all.nl  Wed Jul 26 05:18:31 2006
From: bartvde at xs4all.nl (Bart van den Eijnden (OSGIS))
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GML to shapefile
In-Reply-To: <44C729AE.7050104@loskot.net>
References: <21195.145.50.39.8.1153898426.squirrel@webmail.xs4all.nl>
	<44C729AE.7050104@loskot.net>
Message-ID: <6804.145.50.39.8.1153905511.squirrel@webmail.xs4all.nl>

Hi Mateusz,

oops, my fault :-) I had forgotten to do so.

I have now opened a bug for the ms: attribute name in dbf issue:

http://bugzilla.remotesensing.org/show_bug.cgi?id=1250

Thanks in advance foor looking into this.

Best regards,
Bart

> Bart van den Eijnden (OSGIS) wrote:
>> Hi list,
>>
>> a while ago I reported a problem with Mapserver GML to shapefile
>> conversion using ogr2ogr, the dbf column names are ms:XXXX.
>>
>> Has this been fixed (ie the namespace removed from the attribute name)?
>>
>> Should I open up a bug report?
>
> Hi Bart,
>
> Obviously, I've forgot about this problem, I'm sorry.
> So, please, file a bug with sample GML files attached then it won't be
> forgotten.
>
> AFAIR from our e-mails exchange you were going to file a bug with
> sample data files:
> http://lists.maptools.org/pipermail/gdal-dev/2006-May/008944.html
>
> and here is your last response I got about this problem:
>
> Bart van den Eijnden (OSGIS) wrote:
>> Hi Mateusz,
>>
>> I have the file at work, will open up a bug on Monday and attach it to
>> it.
>>
>> Best regards,
>> Bart
>>
>> Mateusz Loskot wrote:
>>
>>> Bart van den Eijnden (OSGIS) wrote:
>>>
>>>
>>>> Hi Frank, Mateusz,
>>>>
>>>> I am not saying it is invalid GML, I am saying the values are wrong.
>>>>
>>>> XMIN and YMIN in the Mapserver GML are:
>>>>
>>>> 192519.015625
>>>> 320687.375000
>>>>
>>>> But in OGR's output they are both 0.
>>>>
>>>> I will file some bugs on Monday.
>>>>
>>>
>>> Hi,
>>>
>>> Strange.
>>> I have a sample of GML 2.0 file with
>>>
>>> <gml:boundedBy>
>>> <gml:Box>
>>> <gml:coordinates>
>>> 278653.100,187444.800 279095.300,187898.250
>>> </gml:coordinates>
>>> </gml:Box>
>>> </gml:boundedBy>
>>>
>>> and after I run
>>> ogr2ogr -f "GML" test.gml MySampleGML.gml
>>> the output is changed but correct:
>>>
>>> <gml:boundedBy>
>>> <gml:Box>
>>> <gml:coord><gml:X>278653.1</gml:X><gml:Y>187444.8</gml:Y></gml:coord>
>>> <gml:coord><gml:X>279095.3</gml:X><gml:Y>187898.25</gml:Y></gml:coord>
>>> </gml:Box>
>>> </gml:boundedBy>
>>>
>>> I'd need to test using your GML file. Is it possible send me one?
>>>
>>> Cheers
>
>
> --
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>



From crane_ba at yahoo.com  Wed Jul 26 05:23:07 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Additional questions regarding PHP_OGR (Not sure if it
	went through)
Message-ID: <20060726092307.33206.qmail@web52813.mail.yahoo.com>

Hi all, I'm resending this in case it didn't get
through...

Thanx you all for the response, I have a few more
questions from working on it last night if you
guys/gals don't mind?

Question 1:
Okay, so if I loaded a TAB file into the php script,
made a physical copy of it (using php copy command),
renamed it-would I be able to edit the copied file? Or
would I need to go through the php_ogr code to create
a new layer and copy the data across? I am trying to
reduce the number of calculations being performed by
the script to aid speed.

Question 2: 
Does the SHP driver allow update/write of existing
files? I don't mind making a copy of the file to work
on, but I'd rather not...I can work in SHP or TAB file
format.

Question 3: 
I have tried to use OGR_L_GetExtents. I had no idea
what it meant by "psExtent - the structure in which
the extent value will be returned." so I used a
standard variable (since it just indicated it needed a
container?) in it's place. It did return an object,
but how do I actually access the 2 coordinate sets?

Question 4:
Question 3 brings me to another point. Is there any
additional information on functions and their
parameters? Some of very simple, but there are some
where I don't quite understand what the functions are
actually looking for? I have the php code that comes
with ms4w-very helpful in many cases, but doesn't have
code for some of the smaller, less used functions.

Question 5:
I currently do not have an internet connection at
home. Is there a downloadable copy of all the OGR API
information found on the DOxygen website?

Thanx
Ben


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From mateusz at loskot.net  Wed Jul 26 06:11:05 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
In-Reply-To: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
References: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
Message-ID: <44C73FB9.7030607@loskot.net>

Daniele Romagnoli wrote:
> Hi list,
>  
> when using the command "gdalinfo --formats"
> it returns a sequence of supported formats, as well as the specific
> driver capabilities which are symbolized by some initials: (ro), (rw)
> and (rw+).
>
> I think that (ro) means readonly while (rw) means read-write capabilities
>  
> If I'm right, what is the difference between (rw) and (rw+)?
>  
> The difference is related to Create and CreateCopy methods?

Yes, that's the difference.
ro - read-only dataset support
rw - create support (Create)
rw+ - create copy support (CreateCopy)

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dmorissette at mapgears.com  Wed Jul 26 06:28:51 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Additional questions regarding PHP_OGR (Not sure if
	it	went through)
In-Reply-To: <20060726092307.33206.qmail@web52813.mail.yahoo.com>
References: <20060726092307.33206.qmail@web52813.mail.yahoo.com>
Message-ID: <44C743E3.9070909@mapgears.com>

Ben Crane wrote:
> Hi all, I'm resending this in case it didn't get
> through...
> 

Yes, your original message got through and I meant to reply but then I 
forgot.

> Thanx you all for the response, I have a few more
> questions from working on it last night if you
> guys/gals don't mind?
> 
> Question 1:
> Okay, so if I loaded a TAB file into the php script,
> made a physical copy of it (using php copy command),
> renamed it-would I be able to edit the copied file? Or
> would I need to go through the php_ogr code to create
> a new layer and copy the data across? I am trying to
> reduce the number of calculations being performed by
> the script to aid speed.
> 

No, just copying the file won't help. It is really that MITAB only 
supports reading existing files *OR* creating new files, but it doesn't 
support opening existing files for update.


> Question 2: 
> Does the SHP driver allow update/write of existing
> files? I don't mind making a copy of the file to work
> on, but I'd rather not...I can work in SHP or TAB file
> format.
> 

I believe it does, will let Frank confirm that.

> Question 3: 
> I have tried to use OGR_L_GetExtents. I had no idea
> what it meant by "psExtent - the structure in which
> the extent value will be returned." so I used a
> standard variable (since it just indicated it needed a
> container?) in it's place. It did return an object,
> but how do I actually access the 2 coordinate sets?
> 

do a 'print_r(psExtent);' ... it's a PHP object with 4 member variables: 
minx, miny, maxx, maxy... or is it xmin, ymin, xmax, ymax? I don't 
remember but you'll find out with print_r().

> Question 4:
> Question 3 brings me to another point. Is there any
> additional information on functions and their
> parameters? Some of very simple, but there are some
> where I don't quite understand what the functions are
> actually looking for? I have the php code that comes
> with ms4w-very helpful in many cases, but doesn't have
> code for some of the smaller, less used functions.
> 

The API docs at http://gdal.maptools.org/ogr/ogr__api_8h.html is really 
it I think.

> Question 5:
> I currently do not have an internet connection at
> home. Is there a downloadable copy of all the OGR API
> information found on the DOxygen website?
> 

I don't know if a copy is available for download somewhere, perhaps 
check in the GDAL source package. If it's not there then you should be 
able to generate a local copy of all the docs using the 'make docs' GDAL 
makefile target (which uses doxygen).

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From dany.geotools at gmail.com  Wed Jul 26 06:30:42 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
In-Reply-To: <44C73FB9.7030607@loskot.net>
References: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
	<44C73FB9.7030607@loskot.net>
Message-ID: <7221db410607260330o49d6909ej64b6d4806d690ef6@mail.gmail.com>

Thank you very much for the answer.

Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060726/53f96f90/attachment.html
From mateusz at loskot.net  Wed Jul 26 07:15:39 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GML to shapefile
In-Reply-To: <6804.145.50.39.8.1153905511.squirrel@webmail.xs4all.nl>
References: <21195.145.50.39.8.1153898426.squirrel@webmail.xs4all.nl>
	<44C729AE.7050104@loskot.net>
	<6804.145.50.39.8.1153905511.squirrel@webmail.xs4all.nl>
Message-ID: <44C74EDB.6070504@loskot.net>

Bart van den Eijnden (OSGIS) wrote:
> Hi Mateusz,
> 
> oops, my fault :-) I had forgotten to do so.
> 
> I have now opened a bug for the ms: attribute name in dbf issue:
> 
> http://bugzilla.remotesensing.org/show_bug.cgi?id=1250
> 
> Thanks in advance foor looking into this.

Hi Bart,

I've just fixed this bug, so you should have it after updating your
sandbox. Please, check my last comment to the bug report to see my
control output and details about fix.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Wed Jul 26 11:08:59 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Additional questions regarding PHP_OGR (Not sure if
	it	went through)
In-Reply-To: <44C743E3.9070909@mapgears.com>
References: <20060726092307.33206.qmail@web52813.mail.yahoo.com>
	<44C743E3.9070909@mapgears.com>
Message-ID: <44C7858B.7070802@pobox.com>

Daniel Morissette wrote:
>> Question 2: Does the SHP driver allow update/write of existing
>> files? I don't mind making a copy of the file to work
>> on, but I'd rather not...I can work in SHP or TAB file
>> format.
>>
> 
> I believe it does, will let Frank confirm that.

Ben,

I can confirm that the OGR shapefile driver supports "random update"
of features, including deletion.  You may find you need to repack
the dataset occationally as some space may be lost track of when
deleting or rewriting features.  Hopefully the shapefile driver page
addresses the repack option, otherwise drop me a line.

>> Question 5:
>> I currently do not have an internet connection at
>> home. Is there a downloadable copy of all the OGR API
>> information found on the DOxygen website?
>>
> 
> I don't know if a copy is available for download somewhere, perhaps 
> check in the GDAL source package. If it's not there then you should be 
> able to generate a local copy of all the docs using the 'make docs' GDAL 
> makefile target (which uses doxygen).

I also try to prepare a downloadable copy of the documentation / website
for each release, so you can grab:

   http://www.gdal.org/dl/gdal132doc.zip

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From ugeni79 at gmail.com  Wed Jul 26 11:11:16 2006
From: ugeni79 at gmail.com (ugeni79@gmail.com)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Sponsorship of WFS support for OGR
Message-ID: <7b3af6610607260811w4ee3f7a3l3669c5fc8c80a1f1@mail.gmail.com>

Hi list,
I am in the process of trying to get my employer to sponsor the development
of a read/write WFS datasource for OGR.  Is there anyone here who would be
willing to share the cost of this development?

The rough quote that I have from Frank is $6k for read/write support and the
development could begin in October.

Please let me know if anyone is interested.

Eugene
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060726/ad9e3c89/attachment.html
From warmerdam at pobox.com  Wed Jul 26 11:10:46 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
In-Reply-To: <44C73FB9.7030607@loskot.net>
References: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
	<44C73FB9.7030607@loskot.net>
Message-ID: <44C785F6.2040803@pobox.com>

Mateusz Loskot wrote:
> Daniele Romagnoli wrote:
>> Hi list,
>>  
>> when using the command "gdalinfo --formats"
>> it returns a sequence of supported formats, as well as the specific
>> driver capabilities which are symbolized by some initials: (ro), (rw)
>> and (rw+).
>>
>> I think that (ro) means readonly while (rw) means read-write capabilities
>>  
>> If I'm right, what is the difference between (rw) and (rw+)?
>>  
>> The difference is related to Create and CreateCopy methods?
> 
> Yes, that's the difference.
> ro - read-only dataset support
> rw - create support (Create)
> rw+ - create copy support (CreateCopy)

Daniele / Mateusz,

A slight variation on this.

ro is read-only
rw is read or write (ie. supports CreateCopy)
rw+ is read, write and update (ie. supports Create)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From mateusz at loskot.net  Wed Jul 26 11:33:33 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
In-Reply-To: <44C785F6.2040803@pobox.com>
References: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
	<44C73FB9.7030607@loskot.net> <44C785F6.2040803@pobox.com>
Message-ID: <44C78B4D.3080803@loskot.net>

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Daniele Romagnoli wrote:
>>> Hi list,
>>>  
>>> when using the command "gdalinfo --formats"
>>> it returns a sequence of supported formats, as well as the specific
>>> driver capabilities which are symbolized by some initials: (ro), (rw)
>>> and (rw+).
>>>
>>> I think that (ro) means readonly while (rw) means read-write
>>> capabilities
>>>  
>>> If I'm right, what is the difference between (rw) and (rw+)?
>>>  
>>> The difference is related to Create and CreateCopy methods?
>>
>> Yes, that's the difference.
>> ro - read-only dataset support
>> rw - create support (Create)
>> rw+ - create copy support (CreateCopy)
> 
> Daniele / Mateusz,
> 
> A slight variation on this.
> 
> ro is read-only
> rw is read or write (ie. supports CreateCopy)
> rw+ is read, write and update (ie. supports Create)

Daniele,

I'm sorry, my fault, I misinform you about rw and rw+.
My explanations should be inversed: rw -> CreateCopy and rw+ -> Create.
Frank is right.

Frank,

Thank you for correction.

Best regards
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Wed Jul 26 12:23:37 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Link to RFCs on gdal.ogr
In-Reply-To: <44C0B7E3.2020202@mapgears.com>
References: <44C0B7E3.2020202@mapgears.com>
Message-ID: <44C79709.30806@pobox.com>

Daniel Morissette wrote:
> Frank,
> 
> I was looking for a link to the GDAL RFCs on gdal.org and didn't find 
> it. Is there a link to a list of RFCs somewhere on the website? If not 
> then perhaps one should be added to the homepage.
> 
> Daniel

Daniel,

I think I neglected to respond to this.   The RFCs can be found at:

   http://www.gdal.org/rfc_list.html

This is linked from the "Related Pages" tab, and from the Governance and
Community Participation pages.

In CVS the RFCs live in the gdal/rfc directory.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From trale at centrum.cz  Wed Jul 26 14:04:34 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
Message-ID: <200607262004.26219@centrum.cz>

Hi list,

I am having troubles with building gdal with kakadu support - under Windows. I have edited the nmake.opt file and set the KAKDIR to the folder of my kakadu installation. The build brakes on the kakadu partr since it can not find some files. Any idea or help ?

Thanks a lot
Nick



From warmerdam at pobox.com  Wed Jul 26 17:19:27 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <200607262004.26219@centrum.cz>
References: <200607262004.26219@centrum.cz>
Message-ID: <44C7DC5F.5090606@pobox.com>

trale@centrum.cz wrote:
> Hi list,
> 
> I am having troubles with building gdal with kakadu support - under
> Windows. I have edited the nmake.opt file and set the KAKDIR to the folder
> of my kakadu installation. The build brakes on the kakadu partr since it
> can not find some files. Any idea or help ?

Nick,

It would be helpful to know what versions of GDAL and Kakadu you are using.

Did you already build all of Kakadu?

I would suggest quoting the errors here for better support.

Best regards,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From trale at centrum.cz  Wed Jul 26 17:30:59 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <44C7DC5F.5090606@pobox.com>
References: 200607262004.26219@centrum.cz> <200607262004.26219@centrum.cz>
	<44C7DC5F.5090606@pobox.com>
Message-ID: <200607262330.27274@centrum.cz>


Hi Frank,

I figure that out somehow. I have kakadu 4_2_1_00336C with gdal13 working now. There is other issue that worried me more. I have this output on gdalwarp.- it used to work. Any idea or workaround ? here is the dump:

C:\ ...... >gdalwarp -t_srs WGS84 mosaic.tif geomosiac.tif
ERROR 1: Too many points (441 out of 441). failed to transform, unable to compute output bounds 

mosaic.tif is in UTM and it is ok, based on globalmapper


______________________________________________________________
> Od: warmerdam@pobox.com
> Komu: trale@centrum.cz
> CC: gdal-dev@lists.maptools.org
> Datum: 26.07.2006 23:20
> P?edm?t: Re: [Gdal-dev] building gdal with kakadu
>
>trale@centrum.cz wrote:
 >> Hi list,
 >> 
 >> I am having troubles with building gdal with kakadu support - under
 >> Windows. I have edited the nmake.opt file and set the KAKDIR to the folder
 >> of my kakadu installation. The build brakes on the kakadu partr since it
 >> can not find some files. Any idea or help ?
 >
 >Nick,
 >
 >It would be helpful to know what versions of GDAL and Kakadu you are using.
 >
 >Did you already build all of Kakadu?
 >
 >I would suggest quoting the errors here for better support.
 >
 >Best regards,
 >
 >---------------------------------------+--------------------------------------
 >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 >light and sound - activate the windows | http://pobox.com/~warmerdam
 >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 >
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060726/341b90d8/attachment.html
From warmerdam at pobox.com  Wed Jul 26 18:40:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <200607262330.27274@centrum.cz>
References: 200607262004.26219@centrum.cz>
	<200607262004.26219@centrum.cz>	<44C7DC5F.5090606@pobox.com>
	<200607262330.27274@centrum.cz>
Message-ID: <44C7EF70.2050809@pobox.com>

trale@centrum.cz wrote:
> Hi Frank,
> 
> I figure that out somehow. I have kakadu 4_2_1_00336C with gdal13 
> working now. 

Nick,

Well referring to GDAL 1.3 is a bit non-specific since it encompasses
3 releaes (1.3.0 through 1.3.2) over roughly a year.  In any event,
I guess it doesn't matter since you got past that.


 > There is other issue that worried me more. I have this
> output on gdalwarp.- it used to work. Any idea or workaround ? here is 
> the dump:
 >
> C:\ ...... >gdalwarp -t_srs WGS84 mosaic.tif geomosiac.tif
> ERROR 1: Too many points (441 out of 441). failed to transform, unable 
> to compute output bounds
> 
> mosaic.tif is in UTM and it is ok, based on globalmapper

Likely issues include:
   o PROJ.4 DLL not being found, so no reprojection works.
   o Different and incompatible datums.
   o Or perhaps missing datum shift files.

It would be helpful to have the gdalinfo report on the input file.
In fact, if the gdalinfo report file does not report lat/long bounds
as well, that means there is something fundamental broken with regard
to projections.   In that case, one option might be to use FWTools for
the warping since all the projection related stuff is properly setup
with it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From trale at centrum.cz  Thu Jul 27 03:14:20 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <44C7EF70.2050809@pobox.com>
References: 00607262004.26219@centrum.cz> <200607262004.26219@centrum.cz>
	<200607262330.27274@centrum.cz> <44C7EF70.2050809@pobox.com>
Message-ID: <200607270914.19030@centrum.cz>


Hi Frank,

the warping issue is happening with the FW Tools. I can post the image somewhere if you would like to have a look. Both datums are WGS84. This is kind of critical for the application I am working on. Any help is highly welcome ...

Thanks a lot

Nick

______________________________________________________________
> Od: warmerdam@pobox.com
> Komu: trale@centrum.cz
> CC: gdal-dev@lists.maptools.org
> Datum: 27.07.2006 00:42
> P?edm?t: Re: [Gdal-dev] building gdal with kakadu
>
>trale@centrum.cz wrote:
 >> Hi Frank,
 >> 
 >> I figure that out somehow. I have kakadu 4_2_1_00336C with gdal13 
 >> working now. 
 >
 >Nick,
 >
 >Well referring to GDAL 1.3 is a bit non-specific since it encompasses
 >3 releaes (1.3.0 through 1.3.2) over roughly a year. ?In any event,
 >I guess it doesn't matter since you got past that.
 >
 >
 > > There is other issue that worried me more. I have this
 >> output on gdalwarp.- it used to work. Any idea or workaround ? here is 
 >> the dump:
 > >
 >> C:\ ...... >gdalwarp -t_srs WGS84 mosaic.tif geomosiac.tif
 >> ERROR 1: Too many points (441 out of 441). failed to transform, unable 
 >> to compute output bounds
 >> 
 >> mosaic.tif is in UTM and it is ok, based on globalmapper
 >
 >Likely issues include:
 > ? o PROJ.4 DLL not being found, so no reprojection works.
 > ? o Different and incompatible datums.
 > ? o Or perhaps missing datum shift files.
 >
 >It would be helpful to have the gdalinfo report on the input file.
 >In fact, if the gdalinfo report file does not report lat/long bounds
 >as well, that means there is something fundamental broken with regard
 >to projections. ? In that case, one option might be to use FWTools for
 >the warping since all the projection related stuff is properly setup
 >with it.
 >
 >Best regards,
 >-- 
 >---------------------------------------+--------------------------------------
 >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 >light and sound - activate the windows | http://pobox.com/~warmerdam
 >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 >
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060727/258ef7d7/attachment.html
From crane_ba at yahoo.com  Thu Jul 27 04:04:04 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Additional questions regarding PHP_OGR (Not sure if it
	went through)
In-Reply-To: <44C7858B.7070802@pobox.com>
Message-ID: <20060727080404.11398.qmail@web52812.mail.yahoo.com>

Frank,

Brillant! Thank you. I will use SHP instead of TAB for
rendering and edits...they're all much of a muchness
really. Besides, I can always write the data into a
new TAB file once a user decides to log out...so the
facility is there.
 
As for the documentation, thank you as well, very
thoughtful! 

If I have any probs, I'll let you know. In the
meantime, time to play :)

Cheers,
Ben


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From wolfgang.qual at gmx.net  Thu Jul 27 05:00:02 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Georeferencing an image using gdalwarp: format of GCPs?
Message-ID: <200607271100.03078.wolfgang.qual@gmx.net>

Hi list,
I have several scanned maps that I would like to give real coordinates using 
gdalwarp: after creating a GCS-file (a text file with four columns x_image 
y_image, east_coordinates, north_coordinates), I tried the following command:

wqual@standalone:~$ gdalwarp -t_srs /home/wqual/karte_GCP.txt Input_1.jpg 
output.tif

But the only thing I get is:
ERROR 1: Translating source or target SRS failed:
/home/wqual/karte_GCP.txt

Question therefore: what is the correct format of a GCS-file which can be read 
by gdalwarp? I would be glad to receive any comments on this.

Best regards,
Wolfgang

From warmerdam at pobox.com  Thu Jul 27 07:41:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Georeferencing an image using gdalwarp: format of GCPs?
In-Reply-To: <200607271100.03078.wolfgang.qual@gmx.net>
References: <200607271100.03078.wolfgang.qual@gmx.net>
Message-ID: <44C8A677.1010208@pobox.com>

wqual wrote:
> Hi list,
> I have several scanned maps that I would like to give real coordinates using 
> gdalwarp: after creating a GCS-file (a text file with four columns x_image 
> y_image, east_coordinates, north_coordinates), I tried the following command:
> 
> wqual@standalone:~$ gdalwarp -t_srs /home/wqual/karte_GCP.txt Input_1.jpg 
> output.tif
> 
> But the only thing I get is:
> ERROR 1: Translating source or target SRS failed:
> /home/wqual/karte_GCP.txt
> 
> Question therefore: what is the correct format of a GCS-file which can be read 
> by gdalwarp? I would be glad to receive any comments on this.

Wolfgang,

I don't believe gdalwarp supports having gcps supplied on the commandline.
So you end up having to use gdal_translate first to add gcps to a file.

eg.
gdal_translate -gcp 0 0 -117.25 33.0     -gcp 1000 0 -117 33.0 \
                -gcp 0 1000 -117.25 32.75 -gcp 1000 1000 -117 32.75 \
                Input_1.jpg Input_1_gcps.tif
gdalwarp Input_1_gcps.tif output.tif

You can also place the gcps in a file, and use the --optfile switch to
reference the file.  For instance if your karte_GCP.txt contained:

-gcp 0 0 -117.25 33.0
-gcp 1000 0 -117 33.0
-gcp 0 1000 -117.25 32.75
-gcp 1000 1000 -117 32.75

then you could do:

gdal_translate --optfile karte_GCP.txt Input_1.jpg Input_1_gcps.tif

Keep in mind that the gcp arguments are "pixel line geo_x geo_y".

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From warmerdam at pobox.com  Thu Jul 27 07:52:29 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <200607270914.19030@centrum.cz>
References: 00607262004.26219@centrum.cz> <200607262004.26219@centrum.cz>
	<200607262330.27274@centrum.cz> <44C7EF70.2050809@pobox.com>
	<200607270914.19030@centrum.cz>
Message-ID: <44C8A8FD.2020009@pobox.com>

trale@centrum.cz wrote:
> Hi Frank,
> 
> the warping issue is happening with the FW Tools. I can post the image 
> somewhere if you would like to have a look. Both datums are WGS84. This 
> is kind of critical for the application I am working on. Any help is 
> highly welcome ...

Nick,

If you can post a bug report on your problem, and make datasets available
I will try to take a look today.

Small datasets (< 1MB) can be added to the bug report directly.  Big ones
should be staged somewhere for me to http or ftp download.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From trale at centrum.cz  Thu Jul 27 08:20:22 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <44C8A8FD.2020009@pobox.com>
References: 0607262004.26219@centrum.cz> <200607262004.26219@centrum.cz>
	<200607262330.27274@centrum.cz> <44C7EF70.2050809@pobox.com>
	<200607270914.19030@centrum.cz> <44C8A8FD.2020009@pobox.com>
Message-ID: <200607271420.6350@centrum.cz>


Hi Frank,

can you give me some gudiance how to post a bug report? Also, the file is 10MB - can I just email it to you. Please let me know

Thank you
Nick

______________________________________________________________
> Od: warmerdam@pobox.com
> Komu: trale@centrum.cz
> CC: gdal-dev@lists.maptools.org
> Datum: 27.07.2006 13:53
> P?edm?t: Re: [Gdal-dev] building gdal with kakadu
>
>trale@centrum.cz wrote:
 >> Hi Frank,
 >> 
 >> the warping issue is happening with the FW Tools. I can post the image 
 >> somewhere if you would like to have a look. Both datums are WGS84. This 
 >> is kind of critical for the application I am working on. Any help is 
 >> highly welcome ...
 >
 >Nick,
 >
 >If you can post a bug report on your problem, and make datasets available
 >I will try to take a look today.
 >
 >Small datasets (< 1MB) can be added to the bug report directly. ?Big ones
 >should be staged somewhere for me to http or ftp download.
 >
 >Best regards,
 >-- 
 >---------------------------------------+--------------------------------------
 >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 >light and sound - activate the windows | http://pobox.com/~warmerdam
 >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 >
 >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060727/47370b0a/attachment.html
From wolfgang.qual at gmx.net  Thu Jul 27 11:35:35 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Georeferencing an image using gdalwarp: format of GCPs?
In-Reply-To: <44C8A677.1010208@pobox.com>
References: <200607271100.03078.wolfgang.qual@gmx.net>
	<44C8A677.1010208@pobox.com>
Message-ID: <200607271735.36331.wolfgang.qual@gmx.net>

Hi Frank,
thank you very much for this helpful advice! It worked very well. The only 
thing I need to find out was, were the origo of the image was (upper left 
corner of the image) and that qgis y-coordinates were negative (but must be 
positive).

Image in qgis:

0/0-------------------------------------------100/0
|                                                  |
|                                                  |
0/-100---------------------------------------100/-100

and has to be 0/0, 100/0, 0/100, 100/100...

Best regards
Wolfgang

Am Donnerstag 27 Juli 2006 pH:41:13 nachmittags/abends schrieb Frank 
Warmerdam:
> wqual wrote:
> > Hi list,
> > I have several scanned maps that I would like to give real coordinates
> > using gdalwarp: after creating a GCS-file (a text file with four columns
> > x_image y_image, east_coordinates, north_coordinates), I tried the
> > following command:
> >
> > wqual@standalone:~$ gdalwarp -t_srs /home/wqual/karte_GCP.txt Input_1.jpg
> > output.tif
> >
> > But the only thing I get is:
> > ERROR 1: Translating source or target SRS failed:
> > /home/wqual/karte_GCP.txt
> >
> > Question therefore: what is the correct format of a GCS-file which can be
> > read by gdalwarp? I would be glad to receive any comments on this.
>
> Wolfgang,
>
> I don't believe gdalwarp supports having gcps supplied on the commandline.
> So you end up having to use gdal_translate first to add gcps to a file.
>
> eg.
> gdal_translate -gcp 0 0 -117.25 33.0     -gcp 1000 0 -117 33.0 \
>                 -gcp 0 1000 -117.25 32.75 -gcp 1000 1000 -117 32.75 \
>                 Input_1.jpg Input_1_gcps.tif
> gdalwarp Input_1_gcps.tif output.tif
>
> You can also place the gcps in a file, and use the --optfile switch to
> reference the file.  For instance if your karte_GCP.txt contained:
>
> -gcp 0 0 -117.25 33.0
> -gcp 1000 0 -117 33.0
> -gcp 0 1000 -117.25 32.75
> -gcp 1000 1000 -117 32.75
>
> then you could do:
>
> gdal_translate --optfile karte_GCP.txt Input_1.jpg Input_1_gcps.tif
>
> Keep in mind that the gcp arguments are "pixel line geo_x geo_y".
>
> Best regards,

From trale at centrum.cz  Thu Jul 27 12:46:44 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] building gdal with kakadu
In-Reply-To: <200607271420.6350@centrum.cz>
References: 607262004.26219@centrum.cz> <200607262004.26219@centrum.cz>
	<200607262330.27274@centrum.cz> <44C7EF70.2050809@pobox.com>
	<200607270914.19030@centrum.cz> <44C8A8FD.2020009@pobox.com>
	<200607271420.6350@centrum.cz>
Message-ID: <200607271846.17912@centrum.cz>


not sure this email went thru. so i? am resedning

______________________________________________________________
> Od: trale@centrum.cz
> Komu: <warmerdam@pobox.com>, <trale@centrum.cz>
> CC: <gdal-dev@lists.maptools.org>
> Datum: 27.07.2006 14:20
> P?edm?t: Re: [Gdal-dev] building gdal with kakadu
>
>Hi Frank,
 >
 >can you give me some gudiance how to post a bug report? Also, the file is 10MB - can I just email it to you. Please let me know
 >
 >Thank you
 >Nick
 >
 >______________________________________________________________
 >> Od: warmerdam@pobox.com
 >> Komu: trale@centrum.cz
 >> CC: gdal-dev@lists.maptools.org
 >> Datum: 27.07.2006 13:53
 >> P?edm?t: Re: [Gdal-dev] building gdal with kakadu
 >>
 >>trale@centrum.cz wrote:
 > >> Hi Frank,
 > >> 
 > >> the warping issue is happening with the FW Tools. I can post the image 
 > >> somewhere if you would like to have a look. Both datums are WGS84. This 
 > >> is kind of critical for the application I am working on. Any help is 
 > >> highly welcome ...
 > >
 > >Nick,
 > >
 > >If you can post a bug report on your problem, and make datasets available
 > >I will try to take a look today.
 > >
 > >Small datasets (< 1MB) can be added to the bug report directly. ?Big ones
 > >should be staged somewhere for me to http or ftp download.
 > >
 > >Best regards,
 > >-- 
 > >---------------------------------------+--------------------------------------
 > >I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
 > >light and sound - activate the windows | http://pobox.com/~warmerdam
 > >and watch the world go round - Rush ? ?| President OSGF, http://osgeo.org
 > >
 > > > > >

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060727/e3ee7bac/attachment.html
From condit at sdsc.edu  Thu Jul 27 18:56:57 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal java bindings
In-Reply-To: <44C79709.30806@pobox.com>
Message-ID: <845AADAC1106E44996327D62097E4C6BA268C6@et.ad.sdsc.edu>

Does anyone have experience with the GDAL Java bindings?  I'm trying to
use them for raster access and can't seem to get the raw data.

The key problem seems to me that band.GetOffset, GetScale, and
GetNoDataValue are failing. They all return void in the Double[]. Am I
calling them wrong? getXSize/getYsize works fine.

Here's the function:
void dump()
	{
		Band band = image.GetRasterBand(1);
		int x = band.getXSize();
		int y = band.getYSize();
		ByteBuffer data = ByteBuffer.allocateDirect(x * y);

		band.ReadRaster_Direct(0, 0, x, y, x, y,
band.getDataType(), data);
		Double[] offset = new Double[1], scale = new Double[1],
nodata = new Double[1];
		band.GetOffset(offset);
		band.GetScale(scale);
		band.GetNoDataValue(nodata);
		double min = 1000;
		double max = -1000;
		while (data.hasRemaining())
		{
			double val = (data.get() * scale[0]) +
offset[0];				
			if (val < min)
				min = val;
			if (val > max)
				max = val;			
		}	
		System.out.println(min + " " + max);
	}

Thanks,

Chris


From dany.geotools at gmail.com  Fri Jul 28 04:44:06 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] "gdalinfo --formats" output
In-Reply-To: <44C78B4D.3080803@loskot.net>
References: <7221db410607260211o65af8cb5u37654dc764630572@mail.gmail.com>
	<44C73FB9.7030607@loskot.net> <44C785F6.2040803@pobox.com>
	<44C78B4D.3080803@loskot.net>
Message-ID: <7221db410607280144o4d787042o8b518266ead24197@mail.gmail.com>

On 7/26/06, Mateusz Loskot <mateusz@loskot.net> wrote:
>
>
>
> Daniele,
>
> I'm sorry, my fault, I misinform you about rw and rw+.


 Dont worry about this :)


> Frank is right.
>
> Frank,
>
> Thank you for correction.



Thank you Frank.


-- 
Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060728/92afabe7/attachment.html
From condit at sdsc.edu  Fri Jul 28 06:52:05 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal java bindings
In-Reply-To: <7221db410607280135r1685e582mebe6d304bdcde360@mail.gmail.com>
Message-ID: <845AADAC1106E44996327D62097E4C6BA268F8@et.ad.sdsc.edu>

Hi Daniele-

No, I'm not sure that it does. But here's the thing that bugs me: when I
run my Java code it concludes that

Min=-128

Max = 127

 

However, when I run gdalinfo on the file, I get the following
information:

 

Driver: JPEG/JPEG JFIF

Size is 2592, 1296

Band 1 Block=2592x1 Type=Byte, ColorInterp=Red

    Computed Min/Max=0.000,235.000

Band 2 Block=2592x1 Type=Byte, ColorInterp=Green

    Computed Min/Max=0.000,228.000

Band 3 Block=2592x1 Type=Byte, ColorInterp=Blue

    Computed Min/Max=0.000,238.000

 

So I thought I might be reading the ByteBuffer incorrectly.

 

Thanks,

 

Chris

 

________________________________

From: Daniele Romagnoli [mailto:dany.geotools@gmail.com] 
Sent: Friday, July 28, 2006 1:36 AM
To: Christopher Condit
Subject: Re: [Gdal-dev] gdal java bindings

 

Hi Cris.

Are you sure that the rasterBand of your sample file contains the Offset
and Scale values?
They are optional properties of a RasterBand. 

I have used your code with my HDF format samples and it works fine. 

Maybe your sample has no information about this.

regards, Daniele

On 7/28/06, Christopher Condit <condit@sdsc.edu > wrote:

Does anyone have experience with the GDAL Java bindings?  I'm trying to 
use them for raster access and can't seem to get the raw data.

The key problem seems to me that band.GetOffset, GetScale, and
GetNoDataValue are failing. They all return void in the Double[]. Am I
calling them wrong? getXSize/getYsize works fine. 

Here's the function:
void dump()
        {
                Band band = image.GetRasterBand(1);
                int x = band.getXSize();
                int y = band.getYSize();
                ByteBuffer data = ByteBuffer.allocateDirect(x * y);

                band.ReadRaster_Direct(0, 0, x, y, x, y,
band.getDataType(), data);
                Double[] offset = new Double[1], scale = new Double[1],
nodata = new Double[1]; 
                band.GetOffset(offset);
                band.GetScale(scale);
                band.GetNoDataValue(nodata);
                double min = 1000;
                double max = -1000;
                while ( data.hasRemaining())
                {
                        double val = (data.get() * scale[0]) +
offset[0];
                        if (val < min)
                                min = val;
                        if (val > max) 
                                max = val;
                }
                System.out.println(min + " " + max);
        }

Thanks,

Chris

_______________________________________________ 
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060728/1a2a9d89/attachment.html
From collinsb at mitre.org  Fri Jul 28 10:42:57 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] gdal java bindings
In-Reply-To: <845AADAC1106E44996327D62097E4C6BA268C6@et.ad.sdsc.edu>
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92C010F17F9@IMCSRV1.MITRE.ORG>

>-----Original Message-----
>From: gdal-dev-bounces@lists.maptools.org 
>[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of 
>Christopher Condit
>Sent: Thursday, July 27, 2006 6:57 PM
>To: gdal-dev
>Subject: [Gdal-dev] gdal java bindings
>
>Does anyone have experience with the GDAL Java bindings?  I'm trying
to
>use them for raster access and can't seem to get the raw data.
>
>The key problem seems to me that band.GetOffset, GetScale, and
>GetNoDataValue are failing. They all return void in the Double[]. Am I
>calling them wrong? getXSize/getYsize works fine.
>

A few notes...

Unless you are sure that your data is in byte format, the buffer
allocation of "x * y" is a bad idea as it may under-allocate if your
data has more than one byte per pixel.  Use something like: 
(x * y) * (gdal.GetDataTypeSize(band.getDataType()) / 8);

I looked into the GDAL Docs, and it seems that it is not guaranteed
that scale and offset are going to be set.  In that case, they could be
null or undefined.  Also, you could make sure that you are getting the
number of pixels you expect, and are executing that loop once for each
pixel.  Other than that, I have always had success getting data from
RasterIO.

Sorry I could not help more...feel free to send me the test file that
you were using.
--
Ben



From dylan.beaudette at gmail.com  Sat Jul 29 23:29:00 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Re: [GRASS-user] Little experiment: comparison of vector
	projection OGR and ArcGIS
In-Reply-To: <44CC1DEA.80604@pobox.com>
References: <3c5546140607291914r2aaf80bam1a93feca0720141d@mail.gmail.com>
	<44CC1DEA.80604@pobox.com>
Message-ID: <3c5546140607292029h5e8d0f6rbfa60c3863971ab0@mail.gmail.com>

Hi Frank,

Yes. The only discrepancy is with the default, and oddly named,
'NAD_1927_To_NAD_1983_6' "transform" present in ArcGIS 9.0. The NADCON
approach in ArcGIS matches the output from OGR which matches the
output from  the NGS NADCON webpage.

Thanks for your hard work!

Dylan

On 7/29/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Dylan Beaudette wrote:
> > A while back I was wondering if ArcGIS and OGR would produce the same
> > output from the same projection operation...  Results where identical
> > for operations within the same datum, using a GCS -> UTM projection.
> >
> > A couple days ago I did another experiment, this time incorporating a
> > datum shift: GCS NAD83 --> UTM NAD27. I have summarized the results
> > here:
> >
> > http://casoilresource.lawr.ucdavis.edu/drupal/node/259
> >
> > of note:
> >
> > - the default tranform in ArcGIS does not produce the correct results.
> > - the 'NADCON' transform in ArcGIS produces the same results as OGR.
> >
> >
> > Any comments on some of the questions posed are welcomed.
>
> Dylan,
>
> I read over your post quickly, and my understanding is that the outstanding
> question relates to the different methods in ArcGIS, is that right?  And
> that OGR (and cs2cs) match the results of using ArcGIS with the NADCON
> method?   I'm just making sure there isn't an issue I need to be looking
> into.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>

From cemehehko at mail.ru  Sun Jul 30 08:29:39 2006
From: cemehehko at mail.ru (cemehehko@mail.ru)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] ArcGIS
Message-ID: <1053238062.20060730162939@mail.ru>

Hello gdal-dev,

I'm in happy with new 1.3.2 release. I see a new driver for ArcSDE and
ESRI Personal GeoDatabase.
This drivers is read only. And this is correct. There are no need to
try it in write access.


For write, and change ArcSDE&Personal GDB I use ESRI ArgGIS(ArcMap)
CPPAPI.

It is cool to create another driver for read/write/create access to
ArcGIS data in any ESRI format (shapefiles,SDE,Personal GDB and other)
with ArcMap installed on target machine name like ArcGIS API.
The advantage of this API that it is easy and uses 'ESRI'(??????) API
to data access. This API executes neccesary COM extensions of
ArcWorkspace on feature layers.

I attach the files:
1. sdk_windows.h - corrected by me
2. main.cpp - my test program (this can help you)

I can provide more correctly code if you need.


-- 
Best regards,
 cemehehko                          mailto:cemehehko@mail.ru
-------------- next part --------------

#ifndef __ESRI__ARCSDK_COM_SDK_WINDOWS_H__
#define __ESRI__ARCSDK_COM_SDK_WINDOWS_H__

#define STRICT
#define _WIN32_WINNT 0x400
#define _ATL_APARTMENT_THREADED
#define EXT_CLASS _declspec(dllexport)

#define WIN32_LEAN_AND_MEAN             // Exclude rarely-used stuff from Windows headers

#include <windows.h>
#include <ocidl.h>

#include <atlbase.h>

// raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")

#import<esriSystem.olb>                 raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriSystemUI.olb>               raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGeometry.olb>               raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriEditor.olb>                 raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriDisplay.olb>                raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriServer.olb>                 raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriOutput.olb>                 raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGeoDatabase.olb>            raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGeoDatabaseUi.olb>            raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGISClient.olb>              raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriDataSourcesFile.olb>        raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriDataSourcesGDB.olb>         raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriDataSourcesOleDB.olb>       raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriDataSourcesRaster.olb>      raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGeoDatabaseDistributed.olb> raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriCarto.olb>                  raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriLocation.olb>               raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriNetworkAnalysis.olb>        raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriArcMap.olb>        raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriArcMapUi.olb>        raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriFramework.olb>        raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
//#import<esriNetworkAnalyst.olb>         raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGeoAnalyst.olb>             raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esri3DAnalyst.olb>              raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
#import<esriGlobeCore.olb>              raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
//#import<esriSpatialAnalyst.olb>         raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")
//#import<esriGeoStatisticalAnalyst.olb>  raw_interfaces_only raw_native_types no_namespace named_guids exclude("OLE_COLOR", "OLE_HANDLE", "ICursorPtr", "VARTYPE")

/* API REDEFINITIONS */

#define AoInitialize   CoInitialize
#define AoUninitialize CoUninitialize

#define AoCreateObject CoCreateInstance

#define AoAllocBSTR    SysAllocString
#define AoFreeBSTR     SysFreeString

#define AoExit         exit

#endif /* __ESRI__ARCSDK_COM_SDK_WINDOWS_H__ */

-------------- next part --------------
#include <iostream>
using namespace std;

.... 

#define ESRI_WINDOWS
#include "ArcSDK.h"

#define MSG(x) You message poster


int main(int argc,char *argv[])
{


  // This for Personal Geodatabase
  /* 
  IPropertySetPtr pProperty(CLSID_PropertySet);
  IWorkspaceNamePtr pWorkspaceName;

  IWorkspaceFactoryPtr pWorksapceFactory(CLSID_AccessWorkspaceFactory);
  pWorksapceFactory->Create(L".",L"mydb",pProperty,0,&pWorkspaceName);*/

  // This for ArcSDE 
  // QI, WorkspaceName implements both IWorkspaceName and
  IPropertySetPtr property(CLSID_PropertySet);

  VARIANT v;
  v.vt=VT_BSTR;
  v.bstrVal=::SysAllocString(L"ANDREW");
  property->SetProperty(CComBSTR(_T("Server")),v);
  v.bstrVal=::SysAllocString(L"5151");
  property->SetProperty(CComBSTR(_T("Instance")),v);
  v.bstrVal=::SysAllocString(L"sde");
  property->SetProperty(CComBSTR(_T("USER")),v);
  v.bstrVal=::SysAllocString(L"sde");
  property->SetProperty(CComBSTR(_T("password")),v);
  property->SetProperty(CComBSTR(_T("Database")),v);
  v.bstrVal=::SysAllocString(L"sde.DEFAULT");
  property->SetProperty(CComBSTR(_T("version")),v);

  IWorkspacePtr ipWorkspace;
  IWorkspaceFactoryPtr factory(CLSID_SdeWorkspaceFactory);
  cerr<<factory->Open(property,0,&ipWorkspace)<<endl;

  if(!ipWorkspace)
  {
    MSG(app.tr("Can't open database"));
    return 1;
  }
  IFeatureWorkspacePtr ws(ipWorkspace);
  if(!ws)
  {
    MSG(app.tr("Can't open database"));
    return 1;
  }

  IWorkspaceEditPtr edit(ws);
  if(!edit)
  {
    MSG(app.tr("Can't edit"));
    return 1;
  }
  if(edit->StartEditing(VARIANT_FALSE)!=S_OK)
  {
    MSG(app.tr("Can't start edit"));
    return 1;
  }

  // Try to open a layer
  IFeatureClassPtr featureClass;
  ws->OpenFeatureClass(L"LayerName",&featureClass);
  if(!featureClass)
  {
    MSG(app.tr("Layer not found"));
    return 1;
  }
  CComBSTR str;
  featureClass->get_AliasName(&str);

  /*
  if(FALSE) // Delete example
  {
    cerr<<"start delete"<<endl;
    edit->StartEditOperation();
    IQueryFilterPtr filter(CLSID_QueryFilter);
    IFeatureCursorPtr cursor;
    featureClass->Search(filter,FALSE,&cursor);
    if(cursor)
    {
      IFeaturePtr feature;
      cursor->NextFeature(&feature);
      int count=0;
      while(feature)
      {
        count++;
        IFeaturePtr delFeature=feature;
        cursor->NextFeature(&feature);

        delFeature->Delete();
      }
      cerr<<"deleted="<<count<<endl;
    }
    edit->StopEditOperation();
  }

  edit->StopEditing(VARIANT_TRUE);
  if(edit->StartEditing(VARIANT_FALSE)!=S_OK)
  {
    MSG(app.tr("????? ??????????????"));
    return 1;
  }
  */



  int count=0;
  int at=0;
  //  lyr is my Biomap layer
  //  P.S. Biomap is not interesing GIS
  while(lyr.nextFeature(FALSE))
  {
    at++;
    if(lyr.featureDeleted())
    {
      continue;
    }

    QList<CPoint> plist=lyr.featureCoordList();
    plist.append(plist[0]);

    edit->StartEditOperation();
    IFeaturePtr feature;
    if(featureClass->CreateFeature(&feature)!=S_OK)
    {
      cerr<<"error"<<featureClass->CreateFeature(&feature)<<endl;
    }

    if(feature)
    {
      IPointCollectionPtr pc(CLSID_Polygon);
      {
        IPointPtr p(CLSID_Point);
        foreach(CPoint pnt,plist)
        {
          p->PutCoords(pnt.x,pnt.y);
          pc->AddPoint(p);
        }
        //cerr<<"pts:"<<plist.count()<<endl;
      }

      IGeometryPtr geom(pc);
      if(feature->putref_Shape(geom)!=S_OK)
      {
        cerr<<"Error in shape"<<endl;
      }
      long oid;
      feature->get_OID(&oid);

      cerr<<count<<"("<<at*100/lyr.getMaxCode()<<"%): "<<lyr.featureAt()<<endl;
    }else
    {
      MSG(app.tr("Can't create a feature"));
      return 1;
    }

    HRESULT er=feature->Store();
    //cerr<<feature->Store()<<endl;
    if(er!=S_OK)
    {
      cerr<<"Not stored: "<<er<<endl;
    }
    edit->StopEditOperation();
    count++;
  }
  edit->StopEditing(VARIANT_TRUE);

  cerr<<"appended="<<count<<endl;


  //AoUninitialize();

  return 0;
}
From dylan.beaudette at gmail.com  Sat Jul 29 22:14:45 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Little experiment: comparison of vector projection OGR
	and ArcGIS
Message-ID: <3c5546140607291914r2aaf80bam1a93feca0720141d@mail.gmail.com>

A while back I was wondering if ArcGIS and OGR would produce the same
output from the same projection operation...  Results where identical
for operations within the same datum, using a GCS -> UTM projection.

A couple days ago I did another experiment, this time incorporating a
datum shift: GCS NAD83 --> UTM NAD27. I have summarized the results
here:

http://casoilresource.lawr.ucdavis.edu/drupal/node/259

of note:

- the default tranform in ArcGIS does not produce the correct results.
- the 'NADCON' transform in ArcGIS produces the same results as OGR.


Any comments on some of the questions posed are welcomed.


Cheers,

Dylan

From woklist at kyngchaos.com  Sat Jul 29 14:11:25 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] Mac OS X frameworks beta 2
Message-ID: <7AD2E2F5-A92B-42CB-B537-042D6204D506@kyngchaos.com>

Fine tuned a few things.  For all frameworks, they should work in  
Panther now (10.3.9).  It was simpler than I made it sound ^_^  I  
also switched to disk images for distribution because I was having  
problems with Apple's zipping.

The GEOS framework includes both normal C++ and C APIs in one.  So,  
saying -framework GEOS is the same as saying -lgeos -lgeos_c, like I  
do with the UnixImageIO framework.

For the UnixImageIO framework, I linked the unix/lib/*.dylib's to the  
framework itself instead of the internal libraries, so no messing  
around with configure scripts should be needed now.  And that  
effectively hides the internal libraries.

Curl was added internally to the GDAL framework for the Panther  
compatibility.

I may have broken something else, and there may still be other issues  
to work out, but it's beta.


To go along with this (sorry for the cross-posting on this), another  
GRASS.app beta.  It now should work in Panther (but I haven't tested  
it much there).  I made it automatically start X11 if not running  
already.  Updated to today's CVS snapshot.


As an example to use the frameworks, here's part of my GRASS  
configure line:

./configure --enable-sysv --with-freetype --with-freetype-includes="/ 
Library/Frameworks/FreeType.framework/Headers/freetype2 \
/Library/Frameworks/FreeType.framework/Headers" \
--with-freetype-libs=/Library/Frameworks/FreeType.framework/unix/lib \
--with-gdal=/Library/Frameworks/GDAL.framework/Programs/gdal-config \
--with-proj --with-proj-includes=/Library/Frameworks/PROJ.framework/ 
Headers \
--with-proj-libs=/Library/Frameworks/PROJ.framework/unix/lib \
--with-proj-share=/Library/Frameworks/PROJ.framework/Resources/proj \
--with-jpeg-includes=/Library/Frameworks/UnixImageIO.framework/Headers \
--with-jpeg-libs=/Library/Frameworks/UnixImageIO.framework/unix/lib \
--with-png-includes=/Library/Frameworks/UnixImageIO.framework/Headers \
--with-png-libs=/Library/Frameworks/UnixImageIO.framework/unix/lib \
--with-tiff-includes=/Library/Frameworks/UnixImageIO.framework/Headers \
--with-tiff-libs=/Library/Frameworks/UnixImageIO.framework/unix/lib \
--with-cxx --with-sqlite \
--with-sqlite-libs=/Library/Frameworks/SQLite3.framework/unix/lib \
--with-sqlite-includes=/Library/Frameworks/SQLite3.framework/Headers \
--with-fftw-includes=/Library/Frameworks/FFTW3.framework/Headers \
--with-fftw-libs=/Library/Frameworks/FFTW3.framework/unix/lib \
--with-tcltk-includes=/usr/local/grasslibs/include \
--with-tcltk-libs=/usr/local/grasslibs/lib \
--with-x --without-motif --without-glw --with-opengl=x11

The Tcl/Tk libs are an X11 build.  I left out the various DB options,  
you would use those as you normally would.

Notice how the includes point to the Headers folder in the  
frameworks, and the libs point to the unix/lib in the frameworks.   
Since the actual binary of the library is the framework name, the  
unix/lib has a normal lib*.dylib symlinked to the framework binary,  
so detecting and using -lfoo works.

If a *-config script is used, like for GDAL, the script will give you  
the correct -framework and include flags to use.

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

"Oh, look, I seem to have fallen down a deep, dark hole.  Now what  
does that remind me of?  Ah, yes - life."

- Marvin


From henrik at johome.net  Sat Jul 29 07:24:55 2006
From: henrik at johome.net (Henrik Johansson)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] GDAL driver for Magellan topo format
Message-ID: <200607291324.55305.henrik@johome.net>

Hi,

About 3 years ago I released a python program that could read and write the 
topography data format used by Magellan GPS devices (called BLX). But there 
were problem with that code, people has reported artifacts in the decoded 
data. Another problem was that since it was written in Python it was very 
slow for large data sets.

I recently decided to give it another shot and implemented a GDAL driver for 
the format written in C. The new version doesn't have the bug that produced 
the artifacts. 
Here's a list of what the driver can do so far:
* Read and write BLX files
* The inherent overview levels in the BLX format are supported by the driver
* Geo referencing works (fixed to WGS84)
And what's missing:
* For writes, the projection in the source file should be checked that it's 
WGS84
* The progress function is not called as it should in the rasterband read 
function
* Probably lot's of other things

If anyone would like to try it out there is a patch to the CVS version of GDAL 
that can be downloaded from here 
http://rigel.johome.net/blx/blx_gdaldriver.diff .

To build:
./configure --with-blx
make

This is the initial release so it's probably full of nasty bugs so use it with 
care.

/Henrik

From michele.sturma at tellus.it  Mon Jul 31 03:08:32 2006
From: michele.sturma at tellus.it (Michele Sturma)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] From mercator to spherical/ellipsoide projection
Message-ID: <44CDAC70.10708@tellus.it>

Hi,

I have a jpg in mercator projection, 400 pixel x 400 pixel.
I used  gdaltranslate to create a tif. Now if I launch gdalinfo i find 
this information about my TIF

C:\Programmi\FWTools1.0.5\bin>gdalinfo michele.tif
Driver: GTiff/GeoTIFF
Size is 464, 324
Coordinate System is `'
Origin = (-23.730469,64.997939)
Pixel Size = (0.15166271,-0.15166271)
Corner Coordinates:
Upper Left  ( -23.7304688,  64.9979392)
Lower Left  ( -23.7304688,  15.8592207)
Upper Right (  46.6410293,  64.9979392)
Lower Right (  46.6410293,  15.8592207)
Center      (  11.4552803,  40.4285800)
Band 1 Block=464x17 Type=Byte, ColorInterp=Red
Band 2 Block=464x17 Type=Byte, ColorInterp=Green
Band 3 Block=464x17 Type=Byte, ColorInterp=Blue

Upper and lower corners are right, but the center not. I don't know how 
to tell to gdaltranslate that my source is in mercator projection.

I want also to know how can I convert this image in spherical/ellipsoide 
projection.

Thanks!
Michele Sturma


From C.Strobl at dlr.de  Mon Jul 31 05:01:22 2006
From: C.Strobl at dlr.de (C.Strobl@dlr.de)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] converting lines to polygones with ogr
Message-ID: <9773EFADA4FF6C43A49824D50B1539A70156A5BF@exbe04.intra.dlr.de>

hi all,
 
is there a possibility to convert with ogr lines to polygones, for example like
 
ogr2ogr -f  "ESRI Shapefile" -nlt POLYGON c:\home\dat_poly.shp c:\home\dat_line.shp
 
or does somebody know another open source solution for this task.
 
thanks for your help and greetings from munich
christian
 
 


From warmerdam at pobox.com  Mon Jul 31 09:28:56 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:17 2007
Subject: [Gdal-dev] converting lines to polygones with ogr
In-Reply-To: <9773EFADA4FF6C43A49824D50B1539A70156A5BF@exbe04.intra.dlr.de>
References: <9773EFADA4FF6C43A49824D50B1539A70156A5BF@exbe04.intra.dlr.de>
Message-ID: <44CE0598.7060903@pobox.com>

C.Strobl@dlr.de wrote:
> hi all,
>  
> is there a possibility to convert with ogr lines to polygones, for example like
>  
> ogr2ogr -f  "ESRI Shapefile" -nlt POLYGON c:\home\dat_poly.shp c:\home\dat_line.shp
>  
> or does somebody know another open source solution for this task.
>  
> thanks for your help and greetings from munich
> christian

Christian,

There is no direct way to convert lines to polygons with ogr2ogr.
However, there is a demonstration python script for doing this at:

   http://www.gdal.org/srctree/pymod/samples/assemblepoly.py

This particular example assumes polygons are being built from a bunch
of edges.  In your case you are presumably building them from a single
linestring.  So basically you would only want to pass one linestring in
the argument to BuildPolygonsFromEdges.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From condit at sdsc.edu  Mon Jul 31 13:26:11 2006
From: condit at sdsc.edu (Christopher Condit)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] gdal java bindings
In-Reply-To: <8D27E2CDAF11D34F97E7445BCCCDB92C010F17F9@IMCSRV1.MITRE.ORG>
Message-ID: <845AADAC1106E44996327D62097E4C6BA269F6@et.ad.sdsc.edu>

OK - I got it.  I was concerned about the -128 to 127 value range, and I
realized that Java is problematic because it lacks unsigned types. So in
the case of "Byte" types, the code should actually look like this:
int actualValue = 0xFF & data.get(); //where data is your ByteBuffer

In the event of wider data types, you'll have to do the above
calculation and then bitwise or the results together in the proper byte
order.

-Chris

-----Original Message-----
From: Collins, Benjamin [mailto:collinsb@mitre.org] 
Sent: Friday, July 28, 2006 7:43 AM
To: Christopher Condit; gdal-dev
Subject: RE: [Gdal-dev] gdal java bindings

>-----Original Message-----
>From: gdal-dev-bounces@lists.maptools.org 
>[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of 
>Christopher Condit
>Sent: Thursday, July 27, 2006 6:57 PM
>To: gdal-dev
>Subject: [Gdal-dev] gdal java bindings
>
>Does anyone have experience with the GDAL Java bindings?  I'm trying
to
>use them for raster access and can't seem to get the raw data.
>
>The key problem seems to me that band.GetOffset, GetScale, and
>GetNoDataValue are failing. They all return void in the Double[]. Am I
>calling them wrong? getXSize/getYsize works fine.
>

A few notes...

Unless you are sure that your data is in byte format, the buffer
allocation of "x * y" is a bad idea as it may under-allocate if your
data has more than one byte per pixel.  Use something like: 
(x * y) * (gdal.GetDataTypeSize(band.getDataType()) / 8);

I looked into the GDAL Docs, and it seems that it is not guaranteed
that scale and offset are going to be set.  In that case, they could be
null or undefined.  Also, you could make sure that you are getting the
number of pixels you expect, and are executing that loop once for each
pixel.  Other than that, I have always had success getting data from
RasterIO.

Sorry I could not help more...feel free to send me the test file that
you were using.
--
Ben



From mhanson at photon.com  Mon Jul 31 15:53:53 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] Building on Windows
Message-ID: <0719BE42F22E0A46857DF72644EC5D702EBFF3@pj-exchange.photon.com>

Hi,

I'm trying to compile GDAL using the provided makefile.vc files, and I get the same error right at the beginning.  In doing some google searches I found some posts in the GDAL archive from some chap that had the same problem a couple years ago....that chap turned out to be me!     However, back then I did resolve the issue somehow, but it wasn't resolved with any list help so there's no record of what I did.    This is a different computer, and the newest version of Visual Studio so the fact that I'm the only one to ever have this problem I find rather surprising.   Anyway any suggestions to help me remember what I did?  

Much thanks!  Here's the error:

***********************************************
$ nmake -f makefile.vc

Microsoft (R) Program Maintenance Utility Version 8.00.50727.42
Copyright (C) Microsoft Corporation.  All rights reserved.

        cd port
        nmake /nologo /f makefile.vc
        cl /nologo /MD /EHsc /Zi /Fd..\gdal.pdb -I..\port -I..\ogr -I..\gcore  -I..\alg  /c cpl_conv.cpp
cpl_conv.cpp
cpl_conv.cpp(1313) : error C3861: 'snprintf': identifier not found
NMAKE : fatal error U1077: '"c:\Program Files\Microsoft Visual Studio 8\VC\BIN\cl.EXE"' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files\Microsoft Visual Studio 8\VC\BIN\nmake.EXE"' : return code '0x2'
Stop.
*********************************************



Matt Hanson

 

Photon Research Associates, Inc.

A Raytheon Company

155 Fleet Street, Suite 13

Portsmouth, NH 03801

(603) 570-4854


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060731/2549b8f3/attachment.html
From dylan.beaudette at gmail.com  Mon Jul 31 16:41:03 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] issue warning to user when performing datum shift (OGR,
	GDAL)
Message-ID: <3c5546140607311341g251c2148s18fb332a210665dd@mail.gmail.com>

Hi everyone,


In light of some recent thought, experimentation, and discussion [1] I
am wondering if it would be at all possible or even desirable to warn
the user when a datum shift operation is about to be performed. Within
the US, and assumming that the NADCON grid was installed with Proj4,
transforming between NAD27 and NAD83 should work just as expected.
However, in other parts of the world, this may not be the case.
Therefore, it might be a good idea to follow the model used in GRASS,
where the user is specifically prompted for datum transform parameters
whenever defining a new locatio, in these situations.

Any thoughts / reasons not to do this?

Cheers,

1. http://casoilresource.lawr.ucdavis.edu/drupal/node/259


Dylan

From warmerdam at pobox.com  Mon Jul 31 16:58:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] issue warning to user when performing datum shift
	(OGR,	GDAL)
In-Reply-To: <3c5546140607311341g251c2148s18fb332a210665dd@mail.gmail.com>
References: <3c5546140607311341g251c2148s18fb332a210665dd@mail.gmail.com>
Message-ID: <44CE6F0D.4000602@pobox.com>

Dylan Beaudette wrote:
> Hi everyone,
> 
> 
> In light of some recent thought, experimentation, and discussion [1] I
> am wondering if it would be at all possible or even desirable to warn
> the user when a datum shift operation is about to be performed. Within
> the US, and assumming that the NADCON grid was installed with Proj4,
> transforming between NAD27 and NAD83 should work just as expected.
> However, in other parts of the world, this may not be the case.
> Therefore, it might be a good idea to follow the model used in GRASS,
> where the user is specifically prompted for datum transform parameters
> whenever defining a new locatio, in these situations.
> 
> Any thoughts / reasons not to do this?

Dylan,

Well, the most obvious reason not to do it is that the GDAL utilities
are not interactive.  So there is no opportunity to ask.

I think it would be very nice if there was a mechanism to ask stuff
like ogr2ogr to describe what it will do in a transformation but even doing
that would be pretty challenging.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGF, http://osgeo.org


From dylan.beaudette at gmail.com  Mon Jul 31 17:38:28 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] issue warning to user when performing datum shift (OGR,
	=?iso-8859-1?q?=09GDAL?=)
In-Reply-To: <44CE6F0D.4000602@pobox.com>
References: <3c5546140607311341g251c2148s18fb332a210665dd@mail.gmail.com>
	<44CE6F0D.4000602@pobox.com>
Message-ID: <200607311438.28901.dylan.beaudette@gmail.com>

On Monday 31 July 2006 13:58, Frank Warmerdam wrote:
> Dylan Beaudette wrote:
> > Hi everyone,
> >
> >
> > In light of some recent thought, experimentation, and discussion [1] I
> > am wondering if it would be at all possible or even desirable to warn
> > the user when a datum shift operation is about to be performed. Within
> > the US, and assumming that the NADCON grid was installed with Proj4,
> > transforming between NAD27 and NAD83 should work just as expected.
> > However, in other parts of the world, this may not be the case.
> > Therefore, it might be a good idea to follow the model used in GRASS,
> > where the user is specifically prompted for datum transform parameters
> > whenever defining a new locatio, in these situations.
> >
> > Any thoughts / reasons not to do this?
>
> Dylan,
>
> Well, the most obvious reason not to do it is that the GDAL utilities
> are not interactive.  So there is no opportunity to ask.
>
> I think it would be very nice if there was a mechanism to ask stuff
> like ogr2ogr to describe what it will do in a transformation but even doing
> that would be pretty challenging.
>
> Best regards,

Hi Frank,

Thanks for the quick reply. I suppose that this is a no-brainer issue for 
those that fully understand their data. Perhaps a warning message to STDERR 
when datum shifting ?

Cheers,

Dylan



-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From ed at topozone.com  Mon Jul 31 20:10:54 2006
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] issue warning to user when performing datum shift (OGR,
	GDAL)
Message-ID: <4BF377919225F449BB097CB76FFE9BC83DDFE3@ptolemy.topozone.com>

Dylan -

I understand the concern, but I agree with Frank on the implementation
issues.  May I suggest that another approach would be to avoid the
"default" behavior and require an explicit statement by the user of the
datum shift method to be used?  I realize that backward compatibility
requires accepting current transformations "as is", but a statement
like:

ogr2ogr -s_srs 'prj=latlong datum=NAD83' -t_srs '+proj=utm +zone=11
+datum=NAD27 +method=NADCON' output.shp input.shp

Might help avoid any mystery about what "default" behavior is.  A
compile-time "strict" option might be required to turn this feature on.

I don't think that a command like the one above should warn the user
that a datum shift is being performed, any more than the user should be
warned that the coordinates of the points will be projected.  The
command line asks for a datum shift, so the user shouldn't be surprised
if one is performed.

	- Ed


Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 (978) 251-4242
Fax: +1 (978) 251-1396
ed@topozone.com

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Dylan
Beaudette
Sent: Monday, July 31, 2006 4:41 PM
To: gdal-dev
Subject: [Gdal-dev] issue warning to user when performing datum shift
(OGR,GDAL)

Hi everyone,


In light of some recent thought, experimentation, and discussion [1] I
am wondering if it would be at all possible or even desirable to warn
the user when a datum shift operation is about to be performed. Within
the US, and assumming that the NADCON grid was installed with Proj4,
transforming between NAD27 and NAD83 should work just as expected.
However, in other parts of the world, this may not be the case.
Therefore, it might be a good idea to follow the model used in GRASS,
where the user is specifically prompted for datum transform parameters
whenever defining a new locatio, in these situations.

Any thoughts / reasons not to do this?

Cheers,

1. http://casoilresource.lawr.ucdavis.edu/drupal/node/259


Dylan
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From dylan.beaudette at gmail.com  Mon Jul 31 20:43:28 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:18 2007
Subject: [Gdal-dev] issue warning to user when performing datum shift (OGR,
	GDAL)
In-Reply-To: <4BF377919225F449BB097CB76FFE9BC83DDFE3@ptolemy.topozone.com>
References: <4BF377919225F449BB097CB76FFE9BC83DDFE3@ptolemy.topozone.com>
Message-ID: <200607311743.28219.dylan.beaudette@gmail.com>

Ed - 

I agree completely - The user is responsible for how he/she chooses to 
use/mis-use the software. 

Perhaps I as asking for something (that most of us don't want for the stated 
reasons) but which is worth mentioning when someone is getting started. Maybe 
a couple good mistakes are a better reminder than a casual notice from  the 
software.

Cheers,

Dylan

On Monday 31 July 2006 17:10, Ed McNierney wrote:
> Dylan -
>
> I understand the concern, but I agree with Frank on the implementation
> issues.  May I suggest that another approach would be to avoid the
> "default" behavior and require an explicit statement by the user of the
> datum shift method to be used?  I realize that backward compatibility
> requires accepting current transformations "as is", but a statement
> like:
>
> ogr2ogr -s_srs 'prj=latlong datum=NAD83' -t_srs '+proj=utm +zone=11
> +datum=NAD27 +method=NADCON' output.shp input.shp
>
> Might help avoid any mystery about what "default" behavior is.  A
> compile-time "strict" option might be required to turn this feature on.
>
> I don't think that a command like the one above should warn the user
> that a datum shift is being performed, any more than the user should be
> warned that the coordinates of the points will be projected.  The
> command line asks for a datum shift, so the user shouldn't be surprised
> if one is performed.
>
> 	- Ed
>
>
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA  01863
> Phone: +1 (978) 251-4242
> Fax: +1 (978) 251-1396
> ed@topozone.com
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Dylan
> Beaudette
> Sent: Monday, July 31, 2006 4:41 PM
> To: gdal-dev
> Subject: [Gdal-dev] issue warning to user when performing datum shift
> (OGR,GDAL)
>
> Hi everyone,
>
>
> In light of some recent thought, experimentation, and discussion [1] I
> am wondering if it would be at all possible or even desirable to warn
> the user when a datum shift operation is about to be performed. Within
> the US, and assumming that the NADCON grid was installed with Proj4,
> transforming between NAD27 and NAD83 should work just as expected.
> However, in other parts of the world, this may not be the case.
> Therefore, it might be a good idea to follow the model used in GRASS,
> where the user is specifically prompted for datum transform parameters
> whenever defining a new locatio, in these situations.
>
> Any thoughts / reasons not to do this?
>
> Cheers,
>
> 1. http://casoilresource.lawr.ucdavis.edu/drupal/node/259
>
>
> Dylan
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

