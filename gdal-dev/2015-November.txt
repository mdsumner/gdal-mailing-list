From even.rouault at spatialys.com  Sun Nov  1 07:21:00 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 16:21:00 +0100
Subject: [gdal-dev] Warning-free builds :-)
In-Reply-To: <201510291808.12742.even.rouault@spatialys.com>
References: <201510291751.17604.even.rouault@spatialys.com>
 <rmioafhehkn.fsf@fnord.ir.bbn.com>
 <201510291808.12742.even.rouault@spatialys.com>
Message-ID: <201511011621.01007.even.rouault@spatialys.com>

Le jeudi 29 octobre 2015 18:08:12, Even Rouault a écrit :
> Le jeudi 29 octobre 2015 17:59:52, Greg Troxel a écrit :
> > Even Rouault <even.rouault at spatialys.com> writes:
> > > Hi,
> > > 
> > > We've achieved an important and symbolic milestone that will mean
> > > something to developers: most of our (Unix) builds are warning free
> > > (for the library + utilities) ! That is they pass with -Wall -Wextra
> > > -Werror compiler options. Not bad for a ~ 400 K effective line of code
> > > project ( ~ 800 K, with white lines + comments).
> > 
> > On which platforms and which CPU types?
> 
> Some answers at the bottom of my first email
> 
> > Hopefully this includes a build
> > on each of the 4 common BSDs and Illumos and perhaps OS X, and not only
> > i386 and amd64 but also a few things like sparc64 and arm.
> 
> OS X as mentionned in my email, but I haven't tested other BSDs or Illumos
> (do people actually still use that beast...). Anyway people are welcome to
> test and provide fixes if there found issues. The Android build is a ARM
> one.

I've also added a big endian target with the armeb-linux-gnueabihf linaro 
cross compilation chain :
https://github.com/rouault/gdal_coverage/blob/trunk_big_endian/.travis.yml

Only cross compilation tested.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Nov  1 07:37:42 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 16:37:42 +0100
Subject: [gdal-dev] Unable to compile Gdal under Cygwin
In-Reply-To: <22068.65035.266000.93905@woitok.gmail.com>
References: <22039.61358.657000.718699@woitok.gmail.com>
 <201510111657.05772.even.rouault@spatialys.com>
 <22068.65035.266000.93905@woitok.gmail.com>
Message-ID: <201511011637.42407.even.rouault@spatialys.com>

Le samedi 31 octobre 2015 18:44:43, Dr Rainer Woitok a écrit :
> Even,
> 
> it took me a while to get back to my Gdal project ...
> 
> On Sunday, 2015-10-11 16:57:05 +0200, you wrote:
> > ...
> > Ah, yes I guess it comes from latest proj version where the soname was
> > bumped. Well you can safely rename/copy cygproj-10.dll as cygproj-0.dll
> > to please what is currently hardcoded in ogr/ogrct.cpp
> 
> Going on with testing I found another file using the wrong library name,
> causing me to locally apply the following patch:
> 
> diff --git a/autotest/osr/osr_proj4.py b/autotest/osr/osr_proj4.py
> --- a/autotest/osr/osr_proj4.py
> +++ b/autotest/osr/osr_proj4.py
> @@ -58,13 +58,13 @@
>          return have_proj480_flag
> 
>      handle = None
> -    for name in ["libproj.so", "proj.dll",  "libproj-0.dll",
> "libproj.dylib"]: +    for name in ["cygproj-10.dll", "libproj.so",
> "proj.dll",  "libproj-0.dll", "libproj.dylib"]: try:
>              handle = ctypes.cdll.LoadLibrary(name)
>          except:
>              pass
>      if handle is None:
> -        print('cannot load libproj.so, proj.dll, libproj-0.dll or
> libproj.dylib') +        print('cannot load cygproj-10.dll, libproj.so,
> proj.dll, libproj-0.dll or libproj.dylib') have_proj480_flag = False
>          return have_proj480_flag

I've intergrated the above

> 
> diff --git a/ogr/ogrct.cpp b/ogr/ogrct.cpp
> --- a/ogr/ogrct.cpp
> +++ b/ogr/ogrct.cpp
> @@ -95,7 +95,7 @@
>  // components were buit in the same way.
>  #  define LIBNAME      "libproj-0.dll"
>  #elif defined(__CYGWIN__)
> -#  define LIBNAME      "cygproj-0.dll"
> +#  define LIBNAME      "cygproj-10.dll"
>  #elif defined(__APPLE__)
>  #  define LIBNAME      "libproj.dylib"
>  #else
> 
> Mind that this is NOT a suggestion as to how this  should be patched up-
> stream!  This should probably be dealt with somewhere in "configure".

As I said before, I'd rather suggest you use --with-static-proj4 instead, 
which contrary to what its name suggest, does classic library linking (dynamic 
or static depending on what is available)

The LIBNAME might depend on the proj version. cygproj-10.dll must be for proj 
4.9.1 (or 4.9.2). Older should be cygproj-0.dll. You can also define the PROJSO 
environment variable to point to the actual filename.

> 
> Next problem: file "autotest/GNUmakefile" suggests "Run 'make -j test'".
> Generally speaking I would never use "make -j" without "-O".   But apart
> from that  the Gdal test suite  started with  "make -C autotest -j test"
> (with or  without "-O")  almost drove me crazy :-)  yielding irreproduc-
> ible results as in:

Yes parallel make in autotest is unreliable. Was mostly an experiment but some 
tests have interferences.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at ir.bbn.com  Sun Nov  1 08:29:02 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 11:29:02 -0500
Subject: [gdal-dev] results from building with -Werror on NetBSD
Message-ID: <rmitwp54rap.fsf@fnord.ir.bbn.com>


(I just checked out svn trunk and have built on NetBSD 6 i386, with only
a few small issues.   I'm not entirely clear on whether I should be
filing bugs as some of the issues are a bit confusing.  I'm sending
separate mails as the issues are unrelated.   The good news is that I
didn't find any format-string warnings about types.)

The first issue is that in cpl_conv.cc, I got an error about atoll not
being defined.  This surprised me, because stdlib.h was included.
However there are a lot of namespacing includes in there; atoll is from
C99.  A simple test program builds fine.

Building gdal results in a complain that atoll was not declared (log at
end).

The following patch resolves the issue.  I don't understand the strategy
for turning on/off the namespacing defines, but clearly something is
going on because I normally don't see _XOPEN_SOURCE defined.

Index: port/cpl_conv.cpp
===================================================================
--- port/cpl_conv.cpp	(revision 31282)
+++ port/cpl_conv.cpp	(working copy)
@@ -31,6 +31,9 @@
 // For uselocale
 #define _XOPEN_SOURCE 700 
 
+// For atoll
+#define _ISOC99_SOURCE
+
 #ifdef MSVC_USE_VLD
 #include <vld.h>
 #endif


----------------------------------------
[The following test program compiles warning-free with -Wall with both
gcc and clang, with as gcc main.c or g++ main.cc]

#include <stdlib.h>

int main()
{
  long long i;

  i = atoll("1234");

  return 0;
}
----------------------------------------
[log from gdal without my change]

gmake[1]: Entering directory '/usr/home/gdt/SOFTWARE/GEO/gdal/port'
/bin/ksh /home/gdt/SOFTWARE/GEO/gdal/libtool --mode=compile --tag=CXX g++ -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g -O2  -Wall -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wno-clobbered -Wmissing-declarations  -DOGR_ENABLED -I/usr/pkg/include -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include  -DGDAL_COMPILATION	-I/usr/pkg/include  -DHAVE_CURL -DHAVE_LIBZ -I/usr/pkg/include/libxml2 -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c -o cpl_conv.lo cpl_conv.cpp
libtool: compile:  g++ -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g -O2 -Wall -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wno-clobbered -Wmissing-declarations -DOGR_ENABLED -I/usr/pkg/include -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include -DGDAL_COMPILATION -I/usr/pkg/include -DHAVE_CURL -DHAVE_LIBZ -I/usr/pkg/include/libxml2 -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c cpl_conv.cpp  -fPIC -DPIC -o .libs/cpl_conv.o
cpl_conv.cpp: In function 'GUIntBig CPLScanUIntBig(const char*, int)':
cpl_conv.cpp:915:30: error: 'atoll' was not declared in this scope
cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBig(const char*)':
cpl_conv.cpp:941:29: error: 'atoll' was not declared in this scope
cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBigEx(const char*, int, int*)':
cpl_conv.cpp:994:29: error: 'atoll' was not declared in this scope
cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBig(const char*)':
cpl_conv.cpp:945:1: warning: control reaches end of non-void function
../GDALmake.opt:653: recipe for target 'cpl_conv.lo' failed
gmake[1]: *** [cpl_conv.lo] Error 1
gmake[1]: Leaving directory '/usr/home/gdt/SOFTWARE/GEO/gdal/port'
GNUmakefile:70: recipe for target 'port-target' failed
gmake: *** [port-target] Error 2
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/62f46860/attachment.sig>

From gdt at ir.bbn.com  Sun Nov  1 08:43:35 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 11:43:35 -0500
Subject: [gdal-dev] SIGPIPE missing due to not including signal.h
Message-ID: <rmioafd4qmg.fsf@fnord.ir.bbn.com>


I am building on netbsd-6 i386 with gcc 4.5.3.

I got an error about SIGPIPE being undefined.  The man page says that
signal.h is required to be included, and posix agrees:

  http://pubs.opengroup.org/onlinepubs/9699919799/functions/signal.html

I couldn't find an include of signal.h; the following patch resolves the
error.

Index: port/cpl_port.h
===================================================================
--- port/cpl_port.h	(revision 31282)
+++ port/cpl_port.h	(working copy)
@@ -125,6 +125,7 @@
 /*      Standard include files.                                         */
 /* ==================================================================== */
 
+#include <signal.h>
 #include <stdio.h>
 #include <stdlib.h>
 #include <math.h>



gmake[1]: Entering directory '/usr/home/gdt/SOFTWARE/GEO/gdal/apps'
/bin/ksh /home/gdt/SOFTWARE/GEO/gdal/libtool --mode=compile --tag=CC gcc -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g -O2  -Wall -Wdeclaration-after-statement -Wextra -Winit-self -Wunused-parameter -Wmissing-prototypes -Wmissing-declarations -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wdeclaration-after-statement -Wno-clobbered  -I/home/gdt/SOFTWARE/GEO/gdal/frmts/vrt -DOGR_ENABLED -I/usr/pkg/include -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include  -DGDAL_COMPILATION -I/usr/pkg/include/json-c -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts/geojson -DHAVE_GEOS=1 -I/usr/pkg/include -c -o gdalserver.lo gdalserver.c
libtool: compile:  gcc -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g -O2 -Wall -Wdeclaration-after-statement -Wextra -Winit-self -Wunused-parameter -Wmissing-prototypes -Wmissing-declarations -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wdeclaration-after-statement -Wno-clobbered -I/home/gdt/SOFTWARE/GEO/gdal/frmts/vrt -DOGR_ENABLED -I/usr/pkg/include -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include -DGDAL_COMPILATION -I/usr/pkg/include/json-c -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts/geojson -DHAVE_GEOS=1 -I/usr/pkg/include -c gdalserver.c  -fPIC -DPIC -o .libs/gdalserver.o
gdalserver.c: In function 'RunServer':
gdalserver.c:428:9: warning: implicit declaration of function 'signal'
gdalserver.c:428:16: error: 'SIGPIPE' undeclared (first use in this function)
gdalserver.c:428:16: note: each undeclared identifier is reported only once for each function it appears in
gdalserver.c:428:25: error: 'SIG_IGN' undeclared (first use in this function)
../GDALmake.opt:650: recipe for target 'gdalserver.lo' failed
gmake[1]: *** [gdalserver.lo] Error 1
gmake[1]: Leaving directory '/usr/home/gdt/SOFTWARE/GEO/gdal/apps'
GNUmakefile:93: recipe for target 'apps-target' failed
gmake: *** [apps-target] Error 2

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/8b668caf/attachment.sig>

From gdt at ir.bbn.com  Sun Nov  1 08:47:12 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 11:47:12 -0500
Subject: [gdal-dev] aclocal.m4 checked in
Message-ID: <rmik2q14qgf.fsf@fnord.ir.bbn.com>


Running 'svn status' after building. I see aclocal.m4 is modified.  The
changes are small, but it seems that generated files shouldn't be
checked in, and configure isn't, so I would suggest svn rm aclocal.m4.
However, it was updated recently so perhaps this is intended.

diff for amusement:

Index: aclocal.m4
===================================================================
--- aclocal.m4	(revision 31282)
+++ aclocal.m4	(working copy)
@@ -1,7 +1,7 @@
-# generated automatically by aclocal 1.11 -*- Autoconf -*-
+# generated automatically by aclocal 1.15 -*- Autoconf -*-
 
-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
-# 2005, 2006, 2007, 2008, 2009  Free Software Foundation, Inc.
+# Copyright (C) 1996-2014 Free Software Foundation, Inc.
+
 # This file is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -11,6 +11,7 @@
 # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 # PARTICULAR PURPOSE.
 
+m4_ifndef([AC_CONFIG_MACRO_DIRS], [m4_defun([_AM_CONFIG_MACRO_DIRS], [])m4_defun([AC_CONFIG_MACRO_DIRS], [_AM_CONFIG_MACRO_DIRS($@)])])
 m4_include([m4/acinclude.m4])
 m4_include([m4/ax_cflags_warn_all.m4])
 m4_include([m4/ax_check_compile_flag.m4])
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/5966af11/attachment.sig>

From even.rouault at spatialys.com  Sun Nov  1 08:50:08 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 17:50:08 +0100
Subject: [gdal-dev] results from building with -Werror on NetBSD
In-Reply-To: <rmitwp54rap.fsf@fnord.ir.bbn.com>
References: <rmitwp54rap.fsf@fnord.ir.bbn.com>
Message-ID: <201511011750.08230.even.rouault@spatialys.com>

Le dimanche 01 novembre 2015 17:29:02, Greg Troxel a écrit :
> (I just checked out svn trunk and have built on NetBSD 6 i386, with only
> a few small issues.   I'm not entirely clear on whether I should be
> filing bugs as some of the issues are a bit confusing.  I'm sending
> separate mails as the issues are unrelated.   The good news is that I
> didn't find any format-string warnings about types.)
> 
> The first issue is that in cpl_conv.cc, I got an error about atoll not
> being defined.  This surprised me, because stdlib.h was included.
> However there are a lot of namespacing includes in there; atoll is from
> C99.  A simple test program builds fine.
> 
> Building gdal results in a complain that atoll was not declared (log at
> end).
> 
> The following patch resolves the issue.  I don't understand the strategy
> for turning on/off the namespacing defines, but clearly something is
> going on because I normally don't see _XOPEN_SOURCE defined.
> 
> Index: port/cpl_conv.cpp
> ===================================================================
> --- port/cpl_conv.cpp	(revision 31282)
> +++ port/cpl_conv.cpp	(working copy)
> @@ -31,6 +31,9 @@
>  // For uselocale
>  #define _XOPEN_SOURCE 700
> 
> +// For atoll
> +#define _ISOC99_SOURCE
> +
>  #ifdef MSVC_USE_VLD
>  #include <vld.h>
>  #endif

Applied in r31284. Thanks. For other fixes, you might want to create a ticket 
in Trac with one or several patches.

> 
> 
> ----------------------------------------
> [The following test program compiles warning-free with -Wall with both
> gcc and clang, with as gcc main.c or g++ main.cc]
> 
> #include <stdlib.h>
> 
> int main()
> {
>   long long i;
> 
>   i = atoll("1234");
> 
>   return 0;
> }
> ----------------------------------------
> [log from gdal without my change]
> 
> gmake[1]: Entering directory '/usr/home/gdt/SOFTWARE/GEO/gdal/port'
> /bin/ksh /home/gdt/SOFTWARE/GEO/gdal/libtool --mode=compile --tag=CXX g++
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore
> -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts
> -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g
> -O2  -Wall -Wextra -Winit-self -Wunused-parameter -Wformat
> -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wno-clobbered
> -Wmissing-declarations  -DOGR_ENABLED -I/usr/pkg/include
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include 
> -DGDAL_COMPILATION	-I/usr/pkg/include  -DHAVE_CURL -DHAVE_LIBZ
> -I/usr/pkg/include/libxml2 -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c -o
> cpl_conv.lo cpl_conv.cpp libtool: compile:  g++
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore
> -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts
> -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g
> -O2 -Wall -Wextra -Winit-self -Wunused-parameter -Wformat
> -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wno-clobbered
> -Wmissing-declarations -DOGR_ENABLED -I/usr/pkg/include
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include -DGDAL_COMPILATION
> -I/usr/pkg/include -DHAVE_CURL -DHAVE_LIBZ -I/usr/pkg/include/libxml2
> -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c cpl_conv.cpp  -fPIC -DPIC -o
> .libs/cpl_conv.o cpl_conv.cpp: In function 'GUIntBig CPLScanUIntBig(const
> char*, int)': cpl_conv.cpp:915:30: error: 'atoll' was not declared in this
> scope cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBig(const char*)':
> cpl_conv.cpp:941:29: error: 'atoll' was not declared in this scope
> cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBigEx(const char*, int,
> int*)': cpl_conv.cpp:994:29: error: 'atoll' was not declared in this scope
> cpl_conv.cpp: In function 'GIntBig CPLAtoGIntBig(const char*)':
> cpl_conv.cpp:945:1: warning: control reaches end of non-void function
> ../GDALmake.opt:653: recipe for target 'cpl_conv.lo' failed
> gmake[1]: *** [cpl_conv.lo] Error 1
> gmake[1]: Leaving directory '/usr/home/gdt/SOFTWARE/GEO/gdal/port'
> GNUmakefile:70: recipe for target 'port-target' failed
> gmake: *** [port-target] Error 2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Nov  1 08:51:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 17:51:50 +0100
Subject: [gdal-dev] SIGPIPE missing due to not including signal.h
In-Reply-To: <rmioafd4qmg.fsf@fnord.ir.bbn.com>
References: <rmioafd4qmg.fsf@fnord.ir.bbn.com>
Message-ID: <201511011751.50287.even.rouault@spatialys.com>

Le dimanche 01 novembre 2015 17:43:35, vous avez écrit :
> I am building on netbsd-6 i386 with gcc 4.5.3.
> 
> I got an error about SIGPIPE being undefined.  The man page says that
> signal.h is required to be included, and posix agrees:
> 
>   http://pubs.opengroup.org/onlinepubs/9699919799/functions/signal.html
> 
> I couldn't find an include of signal.h; the following patch resolves the
> error.

Couldn't you try to include signal.h in gdalserver.c only so as to avoid 
growing cpl_port.h ?

> 
> Index: port/cpl_port.h
> ===================================================================
> --- port/cpl_port.h	(revision 31282)
> +++ port/cpl_port.h	(working copy)
> @@ -125,6 +125,7 @@
>  /*      Standard include files.                                         */
>  /* ==================================================================== */
> 
> +#include <signal.h>
>  #include <stdio.h>
>  #include <stdlib.h>
>  #include <math.h>
> 
> 
> 
> gmake[1]: Entering directory '/usr/home/gdt/SOFTWARE/GEO/gdal/apps'
> /bin/ksh /home/gdt/SOFTWARE/GEO/gdal/libtool --mode=compile --tag=CC gcc
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore
> -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts
> -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g
> -O2  -Wall -Wdeclaration-after-statement -Wextra -Winit-self
> -Wunused-parameter -Wmissing-prototypes -Wmissing-declarations -Wformat
> -Werror=format-security -Wno-format-nonliteral -Werror=vla
> -Wdeclaration-after-statement -Wno-clobbered 
> -I/home/gdt/SOFTWARE/GEO/gdal/frmts/vrt -DOGR_ENABLED -I/usr/pkg/include
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include  -DGDAL_COMPILATION
> -I/usr/pkg/include/json-c
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts/geojson -DHAVE_GEOS=1
> -I/usr/pkg/include -c -o gdalserver.lo gdalserver.c libtool: compile:  gcc
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/home/gdt/SOFTWARE/GEO/gdal/gcore
> -I/home/gdt/SOFTWARE/GEO/gdal/alg -I/home/gdt/SOFTWARE/GEO/gdal/ogr
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts
> -I/home/gdt/SOFTWARE/GEO/gdal/gnm -I/home/gdt/SOFTWARE/GEO/gdal/apps -g
> -O2 -Wall -Wdeclaration-after-statement -Wextra -Winit-self
> -Wunused-parameter -Wmissing-prototypes -Wmissing-declarations -Wformat
> -Werror=format-security -Wno-format-nonliteral -Werror=vla
> -Wdeclaration-after-statement -Wno-clobbered
> -I/home/gdt/SOFTWARE/GEO/gdal/frmts/vrt -DOGR_ENABLED -I/usr/pkg/include
> -I/home/gdt/SOFTWARE/GEO/gdal/port -I/usr/pkg/include -DGDAL_COMPILATION
> -I/usr/pkg/include/json-c
> -I/home/gdt/SOFTWARE/GEO/gdal/ogr/ogrsf_frmts/geojson -DHAVE_GEOS=1
> -I/usr/pkg/include -c gdalserver.c  -fPIC -DPIC -o .libs/gdalserver.o
> gdalserver.c: In function 'RunServer':
> gdalserver.c:428:9: warning: implicit declaration of function 'signal'
> gdalserver.c:428:16: error: 'SIGPIPE' undeclared (first use in this
> function) gdalserver.c:428:16: note: each undeclared identifier is
> reported only once for each function it appears in gdalserver.c:428:25:
> error: 'SIG_IGN' undeclared (first use in this function)
> ../GDALmake.opt:650: recipe for target 'gdalserver.lo' failed
> gmake[1]: *** [gdalserver.lo] Error 1
> gmake[1]: Leaving directory '/usr/home/gdt/SOFTWARE/GEO/gdal/apps'
> GNUmakefile:93: recipe for target 'apps-target' failed
> gmake: *** [apps-target] Error 2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at ir.bbn.com  Sun Nov  1 08:53:22 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 11:53:22 -0500
Subject: [gdal-dev] json-c configure.in seems too complicated
Message-ID: <rmifv0p4q65.fsf@fnord.ir.bbn.com>


I am building on a machine where most dependencies are built with
--prefix=/usr/pkg; a few are in the base system with --prefix=/usr.  I
have json-c installed in /usr/pkg.

With svn trunk, configure found -ljson-c (because I had passed LDFLAGS
and CPPFLAGS to configure), and found many other things (geos, jpeg,
etc.).   But, it didn't find the json-c header file, apparently because
it was looking in specific pathnames instead of trying to compile a
program that includes the header.  I don't understand why explicitly
finding the header is necessary; I would just expect to have code that
needs it do #include and then if it wasn't found to add the internal
implementation to CPPFLAGS.

(Actually, I don't understand why there is an internal implementation,
but that may be about windows.)

I worked around this with --with-libjson-c=/usr/pkg, but it would be
nice if this weren't necessary.

I'm not sure a "this seems too complicated" is fair for a ticket, and
there's probably some intent here I'm unaware of, so maybe just a
comment is in order.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/03a87406/attachment.sig>

From even.rouault at spatialys.com  Sun Nov  1 08:55:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 17:55:24 +0100
Subject: [gdal-dev] aclocal.m4 checked in
In-Reply-To: <rmik2q14qgf.fsf@fnord.ir.bbn.com>
References: <rmik2q14qgf.fsf@fnord.ir.bbn.com>
Message-ID: <201511011755.24508.even.rouault@spatialys.com>

Le dimanche 01 novembre 2015 17:47:12, Greg Troxel a écrit :
> Running 'svn status' after building. I see aclocal.m4 is modified.  The
> changes are small, but it seems that generated files shouldn't be
> checked in, and configure isn't, so I would suggest svn rm aclocal.m4.
> However, it was updated recently so perhaps this is intended.

Did you run autogen.sh or aclocal ? If so, that's not necessary since the 
generated files are put in svn, for the worse or the better. 

> 
> diff for amusement:
> 
> Index: aclocal.m4
> ===================================================================
> --- aclocal.m4	(revision 31282)
> +++ aclocal.m4	(working copy)
> @@ -1,7 +1,7 @@
> -# generated automatically by aclocal 1.11 -*- Autoconf -*-
> +# generated automatically by aclocal 1.15 -*- Autoconf -*-
> 
> -# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
> -# 2005, 2006, 2007, 2008, 2009  Free Software Foundation, Inc.
> +# Copyright (C) 1996-2014 Free Software Foundation, Inc.
> +
>  # This file is free software; the Free Software Foundation
>  # gives unlimited permission to copy and/or distribute it,
>  # with or without modifications, as long as this notice is preserved.
> @@ -11,6 +11,7 @@
>  # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
>  # PARTICULAR PURPOSE.
> 
> +m4_ifndef([AC_CONFIG_MACRO_DIRS], [m4_defun([_AM_CONFIG_MACRO_DIRS],
> [])m4_defun([AC_CONFIG_MACRO_DIRS], [_AM_CONFIG_MACRO_DIRS($@)])])
> m4_include([m4/acinclude.m4])
>  m4_include([m4/ax_cflags_warn_all.m4])
>  m4_include([m4/ax_check_compile_flag.m4])

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at ir.bbn.com  Sun Nov  1 09:03:12 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 12:03:12 -0500
Subject: [gdal-dev] aclocal.m4 checked in
In-Reply-To: <201511011755.24508.even.rouault@spatialys.com> (Even Rouault's
 message of "Sun, 1 Nov 2015 17:55:24 +0100")
References: <rmik2q14qgf.fsf@fnord.ir.bbn.com>
 <201511011755.24508.even.rouault@spatialys.com>
Message-ID: <rmi7fm14ppr.fsf@fnord.ir.bbn.com>


Even Rouault <even.rouault at spatialys.com> writes:

> Le dimanche 01 novembre 2015 17:47:12, Greg Troxel a écrit :
>> Running 'svn status' after building. I see aclocal.m4 is modified.  The
>> changes are small, but it seems that generated files shouldn't be
>> checked in, and configure isn't, so I would suggest svn rm aclocal.m4.
>> However, it was updated recently so perhaps this is intended.
>
> Did you run autogen.sh or aclocal ? If so, that's not necessary since the 
> generated files are put in svn, for the worse or the better. 

I ran autogen.sh, because I saw it was present and that seemed normal.
It never occured to me that I could skip it because I expected generated
files not to be in svn.  Amazingly my regen of it matches byte-for-byte
what's checked in, so I didn't even notice that configure is in the
repo.

And I should say that while I'm all complaints this morning, they are
all easily fixed nits and I'm impressed at how little issues I am
finding!
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/9d6d4522/attachment.sig>

From gdt at ir.bbn.com  Sun Nov  1 09:04:11 2015
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sun, 01 Nov 2015 12:04:11 -0500
Subject: [gdal-dev] SIGPIPE missing due to not including signal.h
In-Reply-To: <201511011751.50287.even.rouault@spatialys.com> (Even Rouault's
 message of "Sun, 1 Nov 2015 17:51:50 +0100")
References: <rmioafd4qmg.fsf@fnord.ir.bbn.com>
 <201511011751.50287.even.rouault@spatialys.com>
Message-ID: <rmi37wp4po4.fsf@fnord.ir.bbn.com>


Even Rouault <even.rouault at spatialys.com> writes:

> Le dimanche 01 novembre 2015 17:43:35, vous avez écrit :
>> I am building on netbsd-6 i386 with gcc 4.5.3.
>> 
>> I got an error about SIGPIPE being undefined.  The man page says that
>> signal.h is required to be included, and posix agrees:
>> 
>>   http://pubs.opengroup.org/onlinepubs/9699919799/functions/signal.html
>> 
>> I couldn't find an include of signal.h; the following patch resolves the
>> error.
>
> Couldn't you try to include signal.h in gdalserver.c only so as to avoid 
> growing cpl_port.h ?

Yes, that works too.  I filed a ticket with a patch.

https://trac.osgeo.org/gdal/ticket/6193
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/26dcacac/attachment.sig>

From even.rouault at spatialys.com  Sun Nov  1 09:04:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 1 Nov 2015 18:04:46 +0100
Subject: [gdal-dev] json-c configure.in seems too complicated
In-Reply-To: <rmifv0p4q65.fsf@fnord.ir.bbn.com>
References: <rmifv0p4q65.fsf@fnord.ir.bbn.com>
Message-ID: <201511011804.46221.even.rouault@spatialys.com>

Le dimanche 01 novembre 2015 17:53:22, Greg Troxel a écrit :
> I am building on a machine where most dependencies are built with
> --prefix=/usr/pkg; a few are in the base system with --prefix=/usr.  I
> have json-c installed in /usr/pkg.
> 
> With svn trunk, configure found -ljson-c (because I had passed LDFLAGS
> and CPPFLAGS to configure), and found many other things (geos, jpeg,
> etc.).   But, it didn't find the json-c header file, apparently because
> it was looking in specific pathnames instead of trying to compile a
> program that includes the header.  I don't understand why explicitly
> finding the header is necessary; I would just expect to have code that
> needs it do #include and then if it wasn't found to add the internal
> implementation to CPPFLAGS.
> 
> (Actually, I don't understand why there is an internal implementation,
> but that may be about windows.)

Yes, at the origin, there was only the internal implementation. The 
possibility to link to external libjson-c was later added.

> 
> I worked around this with --with-libjson-c=/usr/pkg, but it would be
> nice if this weren't necessary.
> 
> I'm not sure a "this seems too complicated" is fair for a ticket, and
> there's probably some intent here I'm unaware of, so maybe just a
> comment is in order.

You're welcome to improve the test to try in standard locations too. It 
appears I wrote this detection test and I'm definitely not good at configure 
stuff. I guess one issue must be that the code does stuff #include "json-c.h" 
instead of #include "json-c/json-c.h" which might make it impractical to rely 
on standard include locations?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Sun Nov  1 09:48:11 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sun, 1 Nov 2015 09:48:11 -0800
Subject: [gdal-dev] SIGPIPE missing due to not including signal.h
In-Reply-To: <rmi37wp4po4.fsf@fnord.ir.bbn.com>
References: <rmioafd4qmg.fsf@fnord.ir.bbn.com>
 <201511011751.50287.even.rouault@spatialys.com>
 <rmi37wp4po4.fsf@fnord.ir.bbn.com>
Message-ID: <CACmBxysQtk-qzhREPQWxTj2n=kxaeBuj+Y1i9G0EmccyLtoJbA@mail.gmail.com>

Patch applied: https://trac.osgeo.org/gdal/changeset/31286

On Sun, Nov 1, 2015 at 9:04 AM, Greg Troxel <gdt at ir.bbn.com> wrote:

>
> Even Rouault <even.rouault at spatialys.com> writes:
>
> > Le dimanche 01 novembre 2015 17:43:35, vous avez écrit :
> >> I am building on netbsd-6 i386 with gcc 4.5.3.
> >>
> >> I got an error about SIGPIPE being undefined.  The man page says that
> >> signal.h is required to be included, and posix agrees:
> >>
> >>   http://pubs.opengroup.org/onlinepubs/9699919799/functions/signal.html
> >>
> >> I couldn't find an include of signal.h; the following patch resolves the
> >> error.
> >
> > Couldn't you try to include signal.h in gdalserver.c only so as to avoid
> > growing cpl_port.h ?
>
> Yes, that works too.  I filed a ticket with a patch.
>
> https://trac.osgeo.org/gdal/ticket/6193
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151101/c8ab5030/attachment.html>

From rainer.woitok at gmail.com  Mon Nov  2 01:56:40 2015
From: rainer.woitok at gmail.com (Dr Rainer Woitok)
Date: Mon, 2 Nov 2015 10:56:40 +0100
Subject: [gdal-dev] Unable to compile Gdal under Cygwin
In-Reply-To: Msg <201511011637.42407.even.rouault@spatialys.com> of 2015-11-01
 16:37:42 +0100 from even.rouault@spatialys.com
References: <22039.61358.657000.718699@woitok.gmail.com>
 <201510111657.05772.even.rouault@spatialys.com>
 <22068.65035.266000.93905@woitok.gmail.com>
 <201511011637.42407.even.rouault@spatialys.com>
Message-ID: <22071.13144.992000.941075@woitok.gmail.com>

Even,

On Sunday, 2015-11-01 16:37:42 +0100, you wrote:

> ...
> As I said before, I'd rather suggest you use --with-static-proj4 instead, 
> which contrary to what its name suggest, does classic library linking (dynamic 
> or static depending on what is available)

Am I understanding that correctly:  I just should run

   configure ... --with-static-proj4=/home/Rainer/.../cygproj-10.dll

and then the wrong LIBNAME in file  "ogr/ogrct.cpp" just wouldn't matter
anymore?  In that case I think an update to  "configure --help" would be
in order,  pointing out that the library type  specified here determines
dynamic or static linking.   And perhaps the "-static"  sould be removed
from this option's name altogether.   I'll give it a try  later with the
next update of Gdal, but for the time being I'll use my current version.

> ...
> Yes parallel make in autotest is unreliable. Was mostly an experiment but some 
> tests have interferences.

By the way,  why isn't there a "test"  target in  the toplevel makefile?
Why do people have to hunt for it?

You didn't comment on the tests that failed for my installation.  Should
I worry?

Sincerely,
  Rainer

 ----------------------------------------------------------------------
| Rainer M Woitok                | Phone : (+49 60 93) 487 95 95       |
| Kolpingstraße 3                | Mobile: (+49 172) 813 6 831         |
| D-63846 Laufach                | Mail  : Rainer.Woitok at Gmail.Com     |
| Germany                        |                                     |
 ----------------------------------------------------------------------

From even.rouault at spatialys.com  Mon Nov  2 02:14:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Nov 2015 11:14:37 +0100
Subject: [gdal-dev] Unable to compile Gdal under Cygwin
In-Reply-To: <22071.13144.992000.941075@woitok.gmail.com>
References: <22039.61358.657000.718699@woitok.gmail.com>
 <201511011637.42407.even.rouault@spatialys.com>
 <22071.13144.992000.941075@woitok.gmail.com>
Message-ID: <201511021114.37902.even.rouault@spatialys.com>

Le lundi 02 novembre 2015 10:56:40, Dr Rainer Woitok a écrit :
> Even,
> 
> On Sunday, 2015-11-01 16:37:42 +0100, you wrote:
> > ...
> > As I said before, I'd rather suggest you use --with-static-proj4 instead,
> > which contrary to what its name suggest, does classic library linking
> > (dynamic or static depending on what is available)
> 
> Am I understanding that correctly:  I just should run
> 
>    configure ... --with-static-proj4=/home/Rainer/.../cygproj-10.dll

No, you should point to the directory where "make install"  has put the files, 
ie the one that has include and lib subdirectories

> 
> and then the wrong LIBNAME in file  "ogr/ogrct.cpp" just wouldn't matter
> anymore?  In that case I think an update to  "configure --help" would be
> in order,  pointing out that the library type  specified here determines
> dynamic or static linking.   And perhaps the "-static"  sould be removed
> from this option's name altogether.   I'll give it a try  later with the
> next update of Gdal, but for the time being I'll use my current version.
> 
> > ...
> > Yes parallel make in autotest is unreliable. Was mostly an experiment but
> > some tests have interferences.
> 
> By the way,  why isn't there a "test"  target in  the toplevel makefile?
> Why do people have to hunt for it?

I don't know

> 
> You didn't comment on the tests that failed for my installation.  Should
> I worry?

Difficult to say without further investigation. Some tests might be sensitive to 
particular version of third party libraries, compiler version & flags, etc...

> 
> Sincerely,
>   Rainer
> 
>  ----------------------------------------------------------------------
> 
> | Rainer M Woitok                | Phone : (+49 60 93) 487 95 95       |
> | Kolpingstraße 3                | Mobile: (+49 172) 813 6 831         |
> | D-63846 Laufach                | Mail  : Rainer.Woitok at Gmail.Com     |
> | Germany                        |                                     |
> 
>  ----------------------------------------------------------------------

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert.coup at koordinates.com  Mon Nov  2 04:43:34 2015
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 2 Nov 2015 12:43:34 +0000
Subject: [gdal-dev] aclocal.m4 checked in
In-Reply-To: <rmi7fm14ppr.fsf@fnord.ir.bbn.com>
References: <rmik2q14qgf.fsf@fnord.ir.bbn.com>
 <201511011755.24508.even.rouault@spatialys.com>
 <rmi7fm14ppr.fsf@fnord.ir.bbn.com>
Message-ID: <CAFLLRpLmfMSUp=G7WD0fc-9mHwrO59x6Y-joUXOwcS+rNOL91Q@mail.gmail.com>

I think keeping configure/aclocal.m4/etc in svn is a reasonably pragmatic
approach, autotools can be weird at times and is a barrier to people
getting started compiling with an extra driver or a patch or something.

We have SWIG bindings too, the same principle applies except it's 10x worse
than autotools in practise :)

"If you need it you'll know" or something...?

Rob.

On 1 November 2015 at 17:03, Greg Troxel <gdt at ir.bbn.com> wrote:

>
> Even Rouault <even.rouault at spatialys.com> writes:
>
> > Le dimanche 01 novembre 2015 17:47:12, Greg Troxel a écrit :
> >> Running 'svn status' after building. I see aclocal.m4 is modified.  The
> >> changes are small, but it seems that generated files shouldn't be
> >> checked in, and configure isn't, so I would suggest svn rm aclocal.m4.
> >> However, it was updated recently so perhaps this is intended.
> >
> > Did you run autogen.sh or aclocal ? If so, that's not necessary since the
> > generated files are put in svn, for the worse or the better.
>
> I ran autogen.sh, because I saw it was present and that seemed normal.
> It never occured to me that I could skip it because I expected generated
> files not to be in svn.  Amazingly my regen of it matches byte-for-byte
> what's checked in, so I didn't even notice that configure is in the
> repo.
>
> And I should say that while I'm all complaints this morning, they are
> all easily fixed nits and I'm impressed at how little issues I am
> finding!
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 

*Koordinates*PO Box 1604, Shortland St, Auckland 1140, New Zealand
Phone +64-9-966 0433 koordinates.com <https://koordinates.com/about>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151102/30a0715f/attachment.html>

From fitzke at lat-lon.de  Mon Nov  2 05:45:01 2015
From: fitzke at lat-lon.de (Jens Fitzke)
Date: Mon, 2 Nov 2015 14:45:01 +0100
Subject: [gdal-dev] Changing coordinate axis order with ogr2ogr
Message-ID: <563768DD.1050602@lat-lon.de>


Hi,

I'm having trouble changing the axis order of geometry coordinates while being
transfered by ogr2ogr from a GML file to PostGIS.

I think I have read most of the relevant stuff about this...

http://trac.osgeo.org/gdal/wiki/rfc20_srs_axes
http://www.gdal.org/drv_gml.html
http://trac.osgeo.org/gdal/wiki/FAQVector#HowdoIflipcoordinateswhentheyarenotintheexpectedorder

... and postings like
http://osgeo-org.1560.x6.nabble.com/gdal-dev-Ogr2ogr-flip-coordinates-td3742960.html

... and tried many variations of the GML driver options and things like (as
suggested in the wiki page mentioned above)

-s_srs "+proj=latlong +datum=WGS84 +axis=neu +wktext" -t_srs "+proj=latlong
+datum=WGS84 +axis=enu +wktext"

or

-s_srs /tmp/epsg4326_longlat.txt -t_srs /tmp/epsg4326.txt

where the axis order in the two files is inverted

but I never received a result like it could be achieved by using
ST_FlipCoordinates(geom) in PostGIS.

It is of course OK to do the trick within PostGIS after data loading, but I'd
love to do it within the ogr2ogr data transfer, for simpleness, elegance and
efficiency.

I guess I might be doing something wrong here...

Any ideas?

Thanks,

Jens


From philipp.seyerlein at gmail.com  Mon Nov  2 06:30:50 2015
From: philipp.seyerlein at gmail.com (Philipp Seyerlein)
Date: Mon, 2 Nov 2015 15:30:50 +0100
Subject: [gdal-dev] GDAL 2.0 environment
Message-ID: <CAJSUfosfBMavcViyA0WqndUW1ErWL3FLxgbCKYofK-pgT8GoXQ@mail.gmail.com>

Hi,

I´m using GDAL 2.0 on an installed osgeo live system, but it doesn´t
integrate fully in all programs. When I ask the terminal "gdalinfo
--version", the right Version 2.0.0 is mentioned. But in a Python script I
always get back the following:

print gdal.VersionInfo('VERSION_NUM')

--> 1110100

It seems that the older version has hidden environment variables. But I
need version 2000000, because I want to save new wkt-geometries like
CurvePolygon in a geopackage file. Therefore, I use a python script. So far
it isn´t possible. Are there any environment variables I have to configure?

Best regards

Philipp
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151102/60861d0b/attachment.html>

From gane.prog at gmail.com  Mon Nov  2 07:13:59 2015
From: gane.prog at gmail.com (Gane R)
Date: Mon, 2 Nov 2015 20:43:59 +0530
Subject: [gdal-dev] forceToPoly causes crash when converting geom to json
Message-ID: <CALMrLdBM2VYRFGivS+MWEiKQ3oZVDtr2HFqRZ9V=60p1JKrhuQ@mail.gmail.com>

I am reading a file geodb and trying to convert multipolygon to Polygon
OGRGeometry *pGeom = NULL;
                            OGRGeometry *pForced = NULL;
                            pGeom = pOGRFeature->StealGeometry();
                            if(pGeom != NULL)
                            {
                                pForced =
OGRGeometryFactory::forceToPolygon(pGeom);
                                if(pForced != NULL)
                                {

pOGRFeature->SetGeometryDirectly(pForced);
                                }
                            }

char *pJsonString = pSrcGeom->exportToJson(); //Causes crash ...

Do any experience these ?
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151102/b7787346/attachment.html>

From lucena_ivan at hotmail.com  Mon Nov  2 11:58:59 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 2 Nov 2015 19:58:59 +0000
Subject: [gdal-dev] VSI handlers as plugin (shared library)
Message-ID: <CO2PR19MB0107AB260064BE13063403C0902C0@CO2PR19MB0107.namprd19.prod.outlook.com>

Hi there,


What if we could build and distribute VSI handler as plugins?


I developed a VSI handler that depends on other software, so I would rather not build the GDAL main library with that dependency and let the user decided if they want to use the plugin or not.


We would need to have a code on cpl_vsil.cpp similar to AutoLoadDrivers() from  gdaldrivermanager.cpp to load vsi_XXX.{so,dll} dynamically.


Would that be worth the effort? Any other cases where that could be useful?


Regards.


Ivan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151102/1105612c/attachment.html>

From even.rouault at spatialys.com  Mon Nov  2 12:09:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Nov 2015 21:09:30 +0100
Subject: [gdal-dev] VSI handlers as plugin (shared library)
In-Reply-To: <CO2PR19MB0107AB260064BE13063403C0902C0@CO2PR19MB0107.namprd19.prod.outlook.com>
References: <CO2PR19MB0107AB260064BE13063403C0902C0@CO2PR19MB0107.namprd19.prod.outlook.com>
Message-ID: <201511022109.31325.even.rouault@spatialys.com>

Le lundi 02 novembre 2015 20:58:59, Ivan Lucena a écrit :
> Hi there,
> 
> 
> What if we could build and distribute VSI handler as plugins?
> 
> 
> I developed a VSI handler that depends on other software, so I would rather
> not build the GDAL main library with that dependency and let the user
> decided if they want to use the plugin or not.
> 
> 
> We would need to have a code on cpl_vsil.cpp similar to AutoLoadDrivers()
> from  gdaldrivermanager.cpp to load vsi_XXX.{so,dll} dynamically.
> 
> 
> Would that be worth the effort? Any other cases where that could be useful?

Ivan,

You don't need to change anything in GDAL, assuming that you call 
GDALRegisterAll() at some point. Just add a C function GDALRegisterMe() in 
your shared module, call the shared object gdal_XXXXXXX.so/dll and you're 
done.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  2 12:47:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Nov 2015 21:47:40 +0100
Subject: [gdal-dev] VSI handlers as plugin (shared library)
In-Reply-To: <CO2PR19MB0107C61496FE97E1D10AFBB9902C0@CO2PR19MB0107.namprd19.prod.outlook.com>
References: <CO2PR19MB0107AB260064BE13063403C0902C0@CO2PR19MB0107.namprd19.prod.outlook.com>
 <201511022109.31325.even.rouault@spatialys.com>
 <CO2PR19MB0107C61496FE97E1D10AFBB9902C0@CO2PR19MB0107.namprd19.prod.outlook.com>
Message-ID: <201511022147.41063.even.rouault@spatialys.com>

Le lundi 02 novembre 2015 21:44:20, Ivan Lucena a écrit :
> Hi Even,
> 
> It doesn't seems like we are talking about the same think.

I think we do talk about the same thing :-)

> 
> A VSI handler is is not an GDAL/OGR driver, so I can't see how that would
> work.

Well, you can just pretend that your shared object is a module that contains a 
GDAL driver, but you don't need to put a GDAL driver in it. AutoLoadDrivers() 
doesn't check that a driver will be registered. It will just call the entry 
point.

So just try what I suggested: add a extern "C" GDALRegisterME() that calls 
your VSI handler installation, and you'll be done.

I've used this technique recently for the port/cpl_vsil_crypt.cpp module to 
make it work against OSGeo4W unmodified binaries.

> 
> A VSI Handler is registered at that code
> [https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_vsil.cpp#L1153].
> 
> I wrote my VSI code on /port and add a installation function to cpl_vsi.h
> and everything is working just fine when HAVE_OCI is detect by the
> makefiles.
> 
> But you gave me an idea, I could move my code from /port/cpl_vsil_XXX.cpp
> to /frmts/georaster/cpl_vsil_XXX.cpp and register it from there. If
> possible.
> 
> Then I would not need a VSI plugin, since the georaster driver plugin is
> the only user of my VSI handler.
> 
> Does it make sense?
> 
> Regards,
> Ivan
> 
> 
> ________________________________________
> From: Even Rouault <even.rouault at spatialys.com>
> Sent: Monday, November 2, 2015 3:09 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Ivan Lucena
> Subject: Re: [gdal-dev] VSI handlers as plugin (shared library)
> 
> Le lundi 02 novembre 2015 20:58:59, Ivan Lucena a écrit :
> > Hi there,
> > 
> > 
> > What if we could build and distribute VSI handler as plugins?
> > 
> > 
> > I developed a VSI handler that depends on other software, so I would
> > rather not build the GDAL main library with that dependency and let the
> > user decided if they want to use the plugin or not.
> > 
> > 
> > We would need to have a code on cpl_vsil.cpp similar to AutoLoadDrivers()
> > from  gdaldrivermanager.cpp to load vsi_XXX.{so,dll} dynamically.
> > 
> > 
> > Would that be worth the effort? Any other cases where that could be
> > useful?
> 
> Ivan,
> 
> You don't need to change anything in GDAL, assuming that you call
> GDALRegisterAll() at some point. Just add a C function GDALRegisterMe() in
> your shared module, call the shared object gdal_XXXXXXX.so/dll and you're
> done.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  2 14:32:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Nov 2015 23:32:55 +0100
Subject: [gdal-dev] Call for discussion on RFC 60: Improved
	round-tripping in OGR
In-Reply-To: <201509231729.50153.even.rouault@spatialys.com>
References: <201509231729.50153.even.rouault@spatialys.com>
Message-ID: <201511022332.55603.even.rouault@spatialys.com>

Hi,

I've updated the RFC text with the suggestions made during this discussion, 
and added the proposed implementation. If nobody has further remarks, I'll 
call soon for a vote for its adoption.

Even

> Hi,
> 
> This is a call for discussion on "RFC 60: Improved round-tripping in OGR".
> 
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
> 
> This RFC defines how to improve better round-tripping in conversion of
> vector formats, in particular for GeoJSON extensions.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Mon Nov  2 22:58:23 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 3 Nov 2015 08:58:23 +0200
Subject: [gdal-dev] forceToPoly causes crash when converting geom to json
In-Reply-To: <CALMrLdBM2VYRFGivS+MWEiKQ3oZVDtr2HFqRZ9V=60p1JKrhuQ@mail.gmail.com>
References: <CALMrLdBM2VYRFGivS+MWEiKQ3oZVDtr2HFqRZ9V=60p1JKrhuQ@mail.gmail.com>
Message-ID: <56385B0F.5050005@gmail.com>

No problems at least on the other side of bindings:

my $g = Geo::OGR::Geometry->new(
     WKT=>'MULTIPOLYGON(((1 1,5 1,5 5,1 5,1 1),(2 2, 3 2, 3 3, 2 3,2 
2)),((3 3,6 2,6 4,3 3)))');
my $h = $g->ForceToPolygon;

say $h->AsText;
say $h->As(Format=>'GeoJSON');

output:

POLYGON ((1 1,5 1,5 5,1 5,1 1),(2 2,3 2,3 3,2 3,2 2),(3 3,6 2,6 4,3 3))
{ "type": "Polygon", "coordinates": [ [ [ 1.0, 1.0 ], [ 5.0, 1.0 ], [ 
5.0, 5.0 ], [ 1.0, 5.0 ], [ 1.0, 1.0 ] ], [ [ 2.0, 2.0 ], [ 3.0, 2.0 ], 
[ 3.0, 3.0 ], [ 2.0, 3.0 ], [ 2.0, 2.0 ] ], [ [ 3.0, 3.0 ], [ 6.0, 2.0 
], [ 6.0, 4.0 ], [ 3.0, 3.0 ] ] ] }

Ari

On 02.11.2015 17:13, Gane R wrote:
> I am reading a file geodb and trying to convert multipolygon to Polygon
> OGRGeometry *pGeom = NULL;
>                             OGRGeometry *pForced = NULL;
>                             pGeom = pOGRFeature->StealGeometry();
>                             if(pGeom != NULL)
>                             {
>                                 pForced = 
> OGRGeometryFactory::forceToPolygon(pGeom);
>                                 if(pForced != NULL)
>                                 {
> pOGRFeature->SetGeometryDirectly(pForced);
>                                 }
>                             }
>
> char *pJsonString = pSrcGeom->exportToJson(); //Causes crash ...
>
> Do any experience these ?
> Gane
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151103/3fde5215/attachment.html>

From bontepaarden at gmail.com  Tue Nov  3 00:07:29 2015
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 3 Nov 2015 09:07:29 +0100
Subject: [gdal-dev] Promote debug msg to warning
Message-ID: <CAHNf2YSEP4qnzBwbS09RoNWYJcFk984jHr4hPp8bY=g5PRBfpA@mail.gmail.com>

Hi all,

We use GDAL with MapWindow GIS and get the binaries from gisinternals.com.
We have a SpatiaLite file which can be opened by MapWindow (via GDAL) but
cannot be edited.

We had to enable the debug messages to understand why.
GDAL reports "SpatiaLite v4 DB found, but updating tables disabled because
runtime spatialite library is v3.0 !" which is a understandable message but
because it is a debug message and not a warning message it is hard to spot.

Wouldn't it be more logical if GDAL would report this message as a warning?

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*We've started with the development of MapWindow v5. Read more.
<http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151103/0d88c1bc/attachment.html>

From rainer.woitok at gmail.com  Tue Nov  3 06:08:37 2015
From: rainer.woitok at gmail.com (Dr Rainer Woitok)
Date: Tue, 3 Nov 2015 15:08:37 +0100
Subject: [gdal-dev] Unable to compile Gdal under Cygwin
In-Reply-To: Msg <201511021114.37902.even.rouault@spatialys.com> of 2015-11-02
 11:14:37 +0100 from even.rouault@spatialys.com
References: <22039.61358.657000.718699@woitok.gmail.com>
 <201511011637.42407.even.rouault@spatialys.com>
 <22071.13144.992000.941075@woitok.gmail.com>
 <201511021114.37902.even.rouault@spatialys.com>
Message-ID: <22072.49125.342000.749636@woitok.gmail.com>

Even,

On Monday, 2015-11-02 11:14:37 +0100, you wrote:

> ...
> No, you should point to the directory where "make install"  has put the files, 
> ie the one that has include and lib subdirectories

Ok, here this  directory  is named  "proj4/"  and contains  (among other
things):

$ ls proj4/bin/*.dll proj4/lib/*proj*
proj4/bin/cygproj-10.dll  proj4/lib/libproj.dll.a
proj4/lib/libproj.a	  proj4/lib/libproj.la
$

So it seems both methods, dynamic and static, are available.   What will
be selected in this case  when I specify the absolute path  to this dir-
ectory via "--with-static-proj4=..."?

In your next to  last message  you also suggested to  "define the PROJSO
environment variable to point to the actual filename".   I checked where
and how this environment  variable is used  and decided that this is the
way to go for me as soon as I'll update next time.   Seems more reliable
than "--with-static-proj4", should perhaps be documented too in "config-
ure --help", and should perhaps also be used in Python script "autotest/
osr/osr_proj4.py" (if you didn't already exactly that).

Sincerely,
  Rainer

 ----------------------------------------------------------------------
| Rainer M Woitok                | Phone : (+49 60 93) 487 95 95       |
| Kolpingstraße 3                | Mobile: (+49 172) 813 6 831         |
| D-63846 Laufach                | Mail  : Rainer.Woitok at Gmail.Com     |
| Germany                        |                                     |
 ----------------------------------------------------------------------

From dadler at adtechgeospatial.com  Tue Nov  3 07:46:51 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Tue, 3 Nov 2015 10:46:51 -0500
Subject: [gdal-dev] Basic plugin questions
In-Reply-To: <mailman.11473.1446559734.18117.gdal-dev@lists.osgeo.org>
References: <mailman.11473.1446559734.18117.gdal-dev@lists.osgeo.org>
Message-ID: <5638D6EB.7030709@adtechgeospatial.com>

If a data source is created as a plugin and GDALRegisterAll invokes 
GDALRegister_myDS, won't this cause an error at runtime if the DLL/so is 
not found?

Does GDAL need to be rebuilt specifically to include support for a 
particular plugin and then distributed separately?

Is there a repository for plugin DLL/so and how do the shared libraries 
get there?

Related to this but for the current non-plugin version of the DB2 OGR 
driver, I added
#ifdef DB2_ENABLED
     RegisterOGRDB2();
#endif
to
OGRRegisterAllInternal() in ogrregisterall.cpp
and
-DDB2_ENABLED
to
ogr\ogrsf_frmts\generic\makefile.vc

This works ok for the current ODBC-based implementation which has no 
external dependencies, but it would be better to switch to the DB2 CLI 
interface (basically the same as ODBC but supports directly platforms 
other than Windows).

Please excuse the basic questions as I'm not that familiar with how this 
all works, especially the various macro variables used in makefiles and 
source code.

Regards,
David

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From dadler at adtechgeospatial.com  Tue Nov  3 07:51:17 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Tue, 3 Nov 2015 10:51:17 -0500
Subject: [gdal-dev] Common Datastore / Dataset for a database interface
Message-ID: <5638D7F5.2050807@adtechgeospatial.com>

Is there any reason why a common module couldn't be used to support both 
raster and vector data for a particular database?

When the driver is opened the data type could be specified either as an 
option or different names, such as "DB2V:" and "DB2R:"

Regards,
David

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Tue Nov  3 09:36:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Nov 2015 18:36:24 +0100
Subject: [gdal-dev] Promote debug msg to warning
In-Reply-To: <CAHNf2YSEP4qnzBwbS09RoNWYJcFk984jHr4hPp8bY=g5PRBfpA@mail.gmail.com>
References: <CAHNf2YSEP4qnzBwbS09RoNWYJcFk984jHr4hPp8bY=g5PRBfpA@mail.gmail.com>
Message-ID: <201511031836.24705.even.rouault@spatialys.com>

Le mardi 03 novembre 2015 09:07:29, Paul Meems a écrit :
> Hi all,
> 
> We use GDAL with MapWindow GIS and get the binaries from gisinternals.com.
> We have a SpatiaLite file which can be opened by MapWindow (via GDAL) but
> cannot be edited.
> 
> We had to enable the debug messages to understand why.
> GDAL reports "SpatiaLite v4 DB found, but updating tables disabled because
> runtime spatialite library is v3.0 !" which is a understandable message but
> because it is a debug message and not a warning message it is hard to spot.
> 
> Wouldn't it be more logical if GDAL would report this message as a warning?

I guess that would make sense, but only if the database is opened in update 
mode (I've not verified if the message is only emitted in that case), and in 
that case return NULL. Patch welcome.

> 
> Thanks,
> 
> Paul
> 
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org
> 
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl
> 
> 
> 
> *We've started with the development of MapWindow v5. Read more.
> <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov  3 09:41:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Nov 2015 18:41:35 +0100
Subject: [gdal-dev] Basic plugin questions
In-Reply-To: <5638D6EB.7030709@adtechgeospatial.com>
References: <mailman.11473.1446559734.18117.gdal-dev@lists.osgeo.org>
 <5638D6EB.7030709@adtechgeospatial.com>
Message-ID: <201511031841.35933.even.rouault@spatialys.com>

Le mardi 03 novembre 2015 16:46:51, David Adler a écrit :
> If a data source is created as a plugin and GDALRegisterAll invokes
> GDALRegister_myDS, won't this cause an error at runtime if the DLL/so is
> not found?

Yes, if you build as plugin, then the #ifdef ENABLE_MYDS shouldn't be defined 
so that GDALRegisterAll() doesn't call GDALRegister_myDS()

> 
> Does GDAL need to be rebuilt specifically to include support for a
> particular plugin and then distributed separately?

Of course not, that's the purpose of the plugin mechanism to not require 
rebuilding GDAL. You just have to make sure to compile the plugin against the 
exact version of GDAL headers you want to run against however.

> 
> Is there a repository for plugin DLL/so and how do the shared libraries
> get there?

Have a look at AutoloadDrivers() in gcore/gdaldrivermanager.cpp

On Unix, plugins will be looked for in ${install_prefix}/share/gdalplugins or 
${install_preifx}/share/gdalplugins/major.minor
Other locations for MacOSX.
And in all cases the GDAL_DRIVER_PATH environment variable can be defined/

> 
> Related to this but for the current non-plugin version of the DB2 OGR
> driver, I added
> #ifdef DB2_ENABLED
>      RegisterOGRDB2();
> #endif
> to
> OGRRegisterAllInternal() in ogrregisterall.cpp
> and
> -DDB2_ENABLED
> to
> ogr\ogrsf_frmts\generic\makefile.vc
> 
> This works ok for the current ODBC-based implementation which has no
> external dependencies, but it would be better to switch to the DB2 CLI
> interface (basically the same as ODBC but supports directly platforms
> other than Windows).
> 
> Please excuse the basic questions as I'm not that familiar with how this
> all works, especially the various macro variables used in makefiles and
> source code.
> 
> Regards,
> David
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov  3 09:43:41 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Nov 2015 18:43:41 +0100
Subject: [gdal-dev] Common Datastore / Dataset for a database interface
In-Reply-To: <5638D7F5.2050807@adtechgeospatial.com>
References: <5638D7F5.2050807@adtechgeospatial.com>
Message-ID: <201511031843.41544.even.rouault@spatialys.com>

Le mardi 03 novembre 2015 16:51:17, David Adler a écrit :
> Is there any reason why a common module couldn't be used to support both
> raster and vector data for a particular database?
> 
> When the driver is opened the data type could be specified either as an
> option or different names, such as "DB2V:" and "DB2R:"

With GDAL 2.0 unification, you can even open it with a single syntax for both 
vector and raster. You can have a look at the frmts/pcidsk, frmts/pdf, 
ogr/ogrsf_frmts/geopackage drivers that have both raster & vector support.

And http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

> 
> Regards,
> David
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthias.benedikt at boku.ac.at  Wed Nov  4 01:33:11 2015
From: matthias.benedikt at boku.ac.at (Matthias Benedikt)
Date: Wed, 04 Nov 2015 10:33:11 +0100
Subject: [gdal-dev] Issues with GDAL compilation
Message-ID: <5639DEE702000067000170C0@gwia2.boku.ac.at>

Hi there,
I'm trying to get GRASS and all its components compiled from source on a Scientific Linux 6.6. PROJ4, GEOS, netCFD and HDF5 are good to go, except GDAL. 
What i did was:


cd /path/to/src
svn checkout https://svn.osgeo.org/gdal/branches/1.11/gdal gdal
cd /path/to/src/gdal
mkdir build
CFLAGS="-g -Wall" LDFLAGS="-s" ./configure \
--prefix=/path/to/src/gdal/build \
--with-png=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-static-proj4=/path/to/src/proj-4.9.1/build \
--with-geos=/path/to/src/geos-3.4.2/build/bin/geos-config \
--with-hdf5=/path/to/src/hdf5-1.8.15-patch1/build \
--with-netcdf=/path/to/src/netcdf-4.3.3.1/build
make -j8

It keeps going a bit, but ends at some point with:


libtool: compile:  icpc -g -O2 -DHAVE_SSE_AT_COMPILE_TIME -Wall -I/path/to/src/gdal/port -I/path/to/src/gdal/gcore -I/path/to/src/gdal/alg -I/path/to/src/gdal/ogr -I/path/to/src/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1 -I/path/to/src/geos-3.4.2/build/include -DHAVE_AVX_AT_COMPILE_TIME -DOGR_ENABLED -I/path/to/src/gdal/port -I/path/to/src/netcdf-4.3.3.1/build/include -c gdalgrid.cpp  -fPIC -DPIC -o .libs/gdalgrid.o
": internal error: 010101_3007
( tel:0101013007) 
 
compilation aborted for thinplatespline.cpp (code 4)
make[1]: *** [thinplatespline.lo] Error 1
make[1]: *** Waiting for unfinished jobs....

I compiled GDAL several times on Ubuntu systems, always worked out fine. Does anyone have any pointers what I'm doing wrong?
 
Best regards,
Matthias
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/b76dfb17/attachment.html>

From even.rouault at spatialys.com  Wed Nov  4 01:39:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Nov 2015 10:39:57 +0100
Subject: [gdal-dev] Issues with GDAL compilation
In-Reply-To: <5639DEE702000067000170C0@gwia2.boku.ac.at>
References: <5639DEE702000067000170C0@gwia2.boku.ac.at>
Message-ID: <201511041039.57133.even.rouault@spatialys.com>

Le mercredi 04 novembre 2015 10:33:11, Matthias Benedikt a écrit :
> Hi there,
> I'm trying to get GRASS and all its components compiled from source on a
> Scientific Linux 6.6. PROJ4, GEOS, netCFD and HDF5 are good to go, except
> GDAL. What i did was:
> 
> 
> cd /path/to/src
> svn checkout https://svn.osgeo.org/gdal/branches/1.11/gdal gdal
> cd /path/to/src/gdal
> mkdir build
> CFLAGS="-g -Wall" LDFLAGS="-s" ./configure \
> --prefix=/path/to/src/gdal/build \
> --with-png=internal \
> --with-libtiff=internal \
> --with-geotiff=internal \
> --with-jpeg=internal \
> --with-gif=internal \
> --with-static-proj4=/path/to/src/proj-4.9.1/build \
> --with-geos=/path/to/src/geos-3.4.2/build/bin/geos-config \
> --with-hdf5=/path/to/src/hdf5-1.8.15-patch1/build \
> --with-netcdf=/path/to/src/netcdf-4.3.3.1/build
> make -j8
> 
> It keeps going a bit, but ends at some point with:
> 
> 
> libtool: compile:  icpc -g -O2 -DHAVE_SSE_AT_COMPILE_TIME -Wall
> -I/path/to/src/gdal/port -I/path/to/src/gdal/gcore -I/path/to/src/gdal/alg
> -I/path/to/src/gdal/ogr -I/path/to/src/gdal/ogr/ogrsf_frmts -DHAVE_GEOS=1
> -I/path/to/src/geos-3.4.2/build/include -DHAVE_AVX_AT_COMPILE_TIME
> -DOGR_ENABLED -I/path/to/src/gdal/port
> -I/path/to/src/netcdf-4.3.3.1/build/include -c gdalgrid.cpp  -fPIC -DPIC
> -o .libs/gdalgrid.o ": internal error: 010101_3007
> ( tel:0101013007)
> 
> compilation aborted for thinplatespline.cpp (code 4)
> make[1]: *** [thinplatespline.lo] Error 1
> make[1]: *** Waiting for unfinished jobs....
> 
> I compiled GDAL several times on Ubuntu systems, always worked out fine.
> Does anyone have any pointers what I'm doing wrong?

Matthias,

Probably nothing, except using a proprietary compiler ;-) It looks like a bug 
in the compiler when dealing with alg/gdalgrid.cpp.
It might perhaps be confused by the AVX code. Try adding --without-avx to the 
configure options.

And if you compile from source, I'd encourage you anyway using the latest 
release : http://download.osgeo.org/gdal/2.0.1/  There were some changes 
regarding separation of AVX code from non-AVX code, so perhaps the compiler 
bug might not pop up.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Wed Nov  4 01:43:39 2015
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Wed, 4 Nov 2015 09:43:39 +0000 (UTC)
Subject: [gdal-dev] using gdal on ironpython 2.7
In-Reply-To: <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
References: <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <567309910.2016809.1446630220021.JavaMail.yahoo@mail.yahoo.com>

Hello to GDAL community,
Lately I have been trying to use the SRTM 3 arc second elevation data in a form of ASCII grid (.asc file) downloaded freely from opentopography.org.
The problem is that, decimal degrees for .asc files downloaded from opentopography.org are unprojected.
I have been told that with GDAL python module it is very easy to project the decimal degrees to Mercator:

gdalwarp -s_srs EPSG:4326 -t_srs EPSG:32631 -r cubic Barcelona_original.asc Barcelona_projected_to_ Mercator.tif

Then we just need to convert the .tif file to .asc:
gdal_translate -of AAIGrid Barcelona_projected_to_ Mercator.tif Barcelona_projected_to_ Mercator.asc​

Maybe there is a way of doing this in just one line instead of two, I do no not know.

There is a problem: I am using a Rhino 5 application, which is shipped with IronPython 2.7, not cPython. I did not succeed in installing the GDAL python module into my IronPython.

Is there a way to install GDAL into the IronPython?I googled and found this topic, where it says I need to use C# bindings to import GDAL into IronPython. Can anyone show an example of this?

If not, can in some way the upper two "gdalwarp" and "gdal_translate" methods be replicated in IronPython?
​Thank you.

​Kind regards,
Djordje Spasic

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/3dc5a45f/attachment.html>

From even.rouault at spatialys.com  Wed Nov  4 02:13:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Nov 2015 11:13:58 +0100
Subject: [gdal-dev] Antw: Re:  Issues with GDAL compilation
In-Reply-To: <5639E40F02000067000170C5@gwia2.boku.ac.at>
References: <5639DEE702000067000170C0@gwia2.boku.ac.at>
 <201511041039.57133.even.rouault@spatialys.com>
 <5639E40F02000067000170C5@gwia2.boku.ac.at>
Message-ID: <201511041113.59266.even.rouault@spatialys.com>

Matthias,

Plese remind to keep the list CC'ed.

> I tried also with the latest version and --without-avx, here's the
> result:
> 
> 
> GDAL is now configured for x86_64-unknown-linux-gnu
> 
>   Installation directory:    /path/to/src/gdal-2.0.1/build
>   C compiler:   			 icc -g -Wall
>   C++ compiler:   		   icpc -g -O2
> 
>   LIBTOOL support:   	    yes
> 
>   LIBZ support:   		   external
>   LIBLZMA support:   	    no
>   GRASS support:   		  no
>   CFITSIO support:   	    no
>   PCRaster support:   	   internal
>   LIBPNG support:   		 internal
>   DDS support:   		    no
>   GTA support:   		    no
>   LIBTIFF support:   	    internal (BigTIFF=yes)
>   LIBGEOTIFF support:   	 internal
>   LIBJPEG support:   	    internal
>   12 bit JPEG:   		    yes
>   12 bit JPEG-in-TIFF:       yes
>   LIBGIF support:   		 internal
>   OGDI support:   		   no
>   HDF4 support:   		   no
>   HDF5 support:   		   yes
>   Kea support:   		    no
>   NetCDF support:   		 yes
>   Kakadu support:   		 no
>   JasPer support:   		 yes (GeoJP2=no)
>   OpenJPEG support:   	   no
>   ECW support:   		    no
>   MrSID support:   		  no
>   MrSID/MG4 Lidar support:   no
>   MSG support:   		    no
>   GRIB support:   		   yes
>   EPSILON support:   	    no
>   WebP support:   		   no
>   cURL support (wms/wcs/...):yes
>   PostgreSQL support:   	 no
>   MySQL support:   		  no
>   Ingres support:   		 no
>   Xerces-C support:   	   no
>   NAS support:   		    no
>   Expat support:   		  yes
>   libxml2 support:   	    yes
>   Google libkml support:     no
>   ODBC support:   		   no
>   PGeo support:   		   no
>   FGDB support:   		   no
>   MDB support:   		    no
>   PCIDSK support:   		 internal
>   OCI support:   		    no
>   GEORASTER support:   	  no
>   SDE support:   		    no
>   Rasdaman support:   	   no
>   DODS support:   		   no
>   SQLite support:   		 yes
>   PCRE support:   		   no
>   SpatiaLite support:   	 no
>   DWGdirect support   	   no
>   INFORMIX DataBlade support:no
>   GEOS support:   		   yes
>   Poppler support:   	    no
>   Podofo support:   		 no
>   OpenCL support:   		 no
>   Armadillo support:   	  no
>   FreeXL support:   		 no
>   SOSI support:   		   no
> 
> 
>   SWIG Bindings:   		  no
> 
>   Statically link PROJ.4:    yes
>   enable OGR building:       yes
>   enable pthread support:    yes
>   enable POSIX iconv support:yes
>   hide internal symbols:     no
> 
> make -j8 went through without errors, but make install does that
> again:
> 
> 
> 
> [132 at l32 gdal-2.0.1]$ make install
> (cd port; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/port'
> make[1]: Nothing to be done for `default'.
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/port'
> (cd gcore; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/gcore'
> make -C mdreader
> make[2]: Entering directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> make[2]: Nothing to be done for `default'.
> make[2]: Leaving directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/gcore'
> (cd alg; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/alg'
> /bin/sh /path/to/src/gdal-2.0.1/libtool --mode=compile --tag=CXX icpc
> -I/path/to/src/gdal-2.0.1/port -I/path/to/src/gdal-2.0.1/gcore
> -I/path/to/src/gdal-2.0.1/alg -I/path/to/src/gdal-2.0.1/ogr
> -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts -g -O2  -Wall  -DHAVE_GEOS=1
> -I/path/to/src/geos-3.4.2/build/include -DHAVE_SSE_AT_COMPILE_TIME
> -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/netcdf-4.3.3.1/build/include  -DGDAL_COMPILATION  -c -o
> thinplatespline.lo thinplatespline.cpp
> libtool: compile:  icpc -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/gdal-2.0.1/gcore -I/path/to/src/gdal-2.0.1/alg
> -I/path/to/src/gdal-2.0.1/ogr -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts
> -g -O2 -Wall -DHAVE_GEOS=1 -I/path/to/src/geos-3.4.2/build/include
> -DHAVE_SSE_AT_COMPILE_TIME -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/netcdf-4.3.3.1/build/include -DGDAL_COMPILATION -c
> thinplatespline.cpp  -fPIC -DPIC -o .libs/thinplatespline.o
> ": internal error: 010101_3007
> 
> compilation aborted for thinplatespline.cpp (code 4)
> make[1]: *** [thinplatespline.lo] Error 1
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/alg'
> make: *** [core-target] Error 2
> 
> 
> Any other ideas?

Perhaps... Apart from cursing the buggy compiler (if it is an uptodate version 
of it, you might want to report to the vendor as it is a shame it aborts on 
this), you might try to replace the following line of alg/thinplatespline.cpp, 
aroud line 125

#if defined(__GNUC__) && defined(__x86_64__)

by

#if 0

This will disable an optimization, which is the trickiest part of that file.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthias.benedikt at boku.ac.at  Wed Nov  4 02:21:31 2015
From: matthias.benedikt at boku.ac.at (Matthias Benedikt)
Date: Wed, 04 Nov 2015 11:21:31 +0100
Subject: [gdal-dev] Antw: Re:  Issues with GDAL compilation
In-Reply-To: <201511041113.59266.even.rouault@spatialys.com>
References: <5639DEE702000067000170C0@gwia2.boku.ac.at>
 <201511041039.57133.even.rouault@spatialys.com>
 <5639E40F02000067000170C5@gwia2.boku.ac.at>
 <201511041113.59266.even.rouault@spatialys.com>
Message-ID: <5639EA3B02000067000170CA@gwia2.boku.ac.at>

Perfect!
Replacing


#if defined(__GNUC__) && defined(__x86_64__)

with

#if 0
did the trick, thanks a million!

>>> Even Rouault <even.rouault at spatialys.com> 04.11.2015 11:13 >>>
Matthias,

Plese remind to keep the list CC'ed.

> I tried also with the latest version and --without-avx, here's the
> result:
> 
> 
> GDAL is now configured for x86_64-unknown-linux-gnu
> 
>   Installation directory:    /path/to/src/gdal-2.0.1/build
>   C compiler:   			 icc -g -Wall
>   C++ compiler:   		   icpc -g -O2
> 
>   LIBTOOL support:   	    yes
> 
>   LIBZ support:   		   external
>   LIBLZMA support:   	    no
>   GRASS support:   		  no
>   CFITSIO support:   	    no
>   PCRaster support:   	   internal
>   LIBPNG support:   		 internal
>   DDS support:   		    no
>   GTA support:   		    no
>   LIBTIFF support:   	    internal (BigTIFF=yes)
>   LIBGEOTIFF support:   	 internal
>   LIBJPEG support:   	    internal
>   12 bit JPEG:   		    yes
>   12 bit JPEG-in-TIFF:  	 yes
>   LIBGIF support:   		 internal
>   OGDI support:   		   no
>   HDF4 support:   		   no
>   HDF5 support:   		   yes
>   Kea support:   		    no
>   NetCDF support:   		 yes
>   Kakadu support:   		 no
>   JasPer support:   		 yes (GeoJP2=no)
>   OpenJPEG support:   	   no
>   ECW support:   		    no
>   MrSID support:   		  no
>   MrSID/MG4 Lidar support:   no
>   MSG support:   		    no
>   GRIB support:   		   yes
>   EPSILON support:   	    no
>   WebP support:   		   no
>   cURL support (wms/wcs/...):yes
>   PostgreSQL support:   	 no
>   MySQL support:   		  no
>   Ingres support:   		 no
>   Xerces-C support:   	   no
>   NAS support:   		    no
>   Expat support:   		  yes
>   libxml2 support:   	    yes
>   Google libkml support:     no
>   ODBC support:   		   no
>   PGeo support:   		   no
>   FGDB support:   		   no
>   MDB support:   		    no
>   PCIDSK support:   		 internal
>   OCI support:   		    no
>   GEORASTER support:   	  no
>   SDE support:   		    no
>   Rasdaman support:   	   no
>   DODS support:   		   no
>   SQLite support:   		 yes
>   PCRE support:   		   no
>   SpatiaLite support:   	 no
>   DWGdirect support   	   no
>   INFORMIX DataBlade support:no
>   GEOS support:   		   yes
>   Poppler support:   	    no
>   Podofo support:   		 no
>   OpenCL support:   		 no
>   Armadillo support:   	  no
>   FreeXL support:   		 no
>   SOSI support:   		   no
> 
> 
>   SWIG Bindings:   		  no
> 
>   Statically link PROJ.4:    yes
>   enable OGR building:  	 yes
>   enable pthread support:    yes
>   enable POSIX iconv support:yes
>   hide internal symbols:     no
> 
> make -j8 went through without errors, but make install does that
> again:
> 
> 
> 
> [132 at l32 gdal-2.0.1]$ make install
> (cd port; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/port'
> make[1]: Nothing to be done for `default'.
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/port'
> (cd gcore; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/gcore'
> make -C mdreader
> make[2]: Entering directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> make[2]: Nothing to be done for `default'.
> make[2]: Leaving directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/gcore'
> (cd alg; make)
> make[1]: Entering directory `/path/to/src/gdal-2.0.1/alg'
> /bin/sh /path/to/src/gdal-2.0.1/libtool --mode=compile --tag=CXX icpc
> -I/path/to/src/gdal-2.0.1/port -I/path/to/src/gdal-2.0.1/gcore
> -I/path/to/src/gdal-2.0.1/alg -I/path/to/src/gdal-2.0.1/ogr
> -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts -g -O2  -Wall  -DHAVE_GEOS=1
> -I/path/to/src/geos-3.4.2/build/include -DHAVE_SSE_AT_COMPILE_TIME
> -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/netcdf-4.3.3.1/build/include  -DGDAL_COMPILATION  -c -o
> thinplatespline.lo thinplatespline.cpp
> libtool: compile:  icpc -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/gdal-2.0.1/gcore -I/path/to/src/gdal-2.0.1/alg
> -I/path/to/src/gdal-2.0.1/ogr -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts
> -g -O2 -Wall -DHAVE_GEOS=1 -I/path/to/src/geos-3.4.2/build/include
> -DHAVE_SSE_AT_COMPILE_TIME -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> -I/path/to/src/netcdf-4.3.3.1/build/include -DGDAL_COMPILATION -c
> thinplatespline.cpp  -fPIC -DPIC -o .libs/thinplatespline.o
> ": internal error: 010101_3007
> 
> compilation aborted for thinplatespline.cpp (code 4)
> make[1]: *** [thinplatespline.lo] Error 1
> make[1]: Leaving directory `/path/to/src/gdal-2.0.1/alg'
> make: *** [core-target] Error 2
> 
> 
> Any other ideas?

Perhaps... Apart from cursing the buggy compiler (if it is an uptodate version 
of it, you might want to report to the vendor as it is a shame it aborts on 
this), you might try to replace the following line of alg/thinplatespline.cpp, 
aroud line 125

#if defined(__GNUC__) && defined(__x86_64__)

by

#if 0

This will disable an optimization, which is the trickiest part of that file.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/0451bc07/attachment-0001.html>

From even.rouault at spatialys.com  Wed Nov  4 04:36:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Nov 2015 13:36:35 +0100
Subject: [gdal-dev] Antw: Re:  Issues with GDAL compilation
In-Reply-To: <5639EA3B02000067000170CA@gwia2.boku.ac.at>
References: <5639DEE702000067000170C0@gwia2.boku.ac.at>
 <201511041113.59266.even.rouault@spatialys.com>
 <5639EA3B02000067000170CA@gwia2.boku.ac.at>
Message-ID: <201511041336.35741.even.rouault@spatialys.com>

Le mercredi 04 novembre 2015 11:21:31, Matthias Benedikt a écrit :
> Perfect!
> Replacing
> 
> 
> #if defined(__GNUC__) && defined(__x86_64__)
> 
> with
> 
> #if 0
> did the trick, thanks a million!

I don't know if you're a C/C+ developer, but if so, perhaps you could provide 
a patch to detect this compiler ?

I guess this must be something around
#ifdef __INTEL_COMPILER

but that's maybe too extreme as I hope that it is just that you use an 
outdated version of it and that newer versions work better.

So perhaps something like

#if (defined(__INTEL_COMPILER) && __INTEL_COMPILER <= buggy_version_number )

assuming blindlessly that the value of __INTEL_COMPILER reflects a version 
number. 

> 
> >>> Even Rouault <even.rouault at spatialys.com> 04.11.2015 11:13 >>>
> 
> Matthias,
> 
> Plese remind to keep the list CC'ed.
> 
> > I tried also with the latest version and --without-avx, here's the
> > result:
> > 
> > 
> > GDAL is now configured for x86_64-unknown-linux-gnu
> > 
> >   Installation directory:    /path/to/src/gdal-2.0.1/build
> >   C compiler:   			 icc -g -Wall
> >   C++ compiler:   		   icpc -g -O2
> >   
> >   LIBTOOL support:   	    yes
> >   
> >   LIBZ support:   		   external
> >   LIBLZMA support:   	    no
> >   GRASS support:   		  no
> >   CFITSIO support:   	    no
> >   PCRaster support:   	   internal
> >   LIBPNG support:   		 internal
> >   DDS support:   		    no
> >   GTA support:   		    no
> >   LIBTIFF support:   	    internal (BigTIFF=yes)
> >   LIBGEOTIFF support:   	 internal
> >   LIBJPEG support:   	    internal
> >   12 bit JPEG:   		    yes
> >   12 bit JPEG-in-TIFF:  	 yes
> >   LIBGIF support:   		 internal
> >   OGDI support:   		   no
> >   HDF4 support:   		   no
> >   HDF5 support:   		   yes
> >   Kea support:   		    no
> >   NetCDF support:   		 yes
> >   Kakadu support:   		 no
> >   JasPer support:   		 yes (GeoJP2=no)
> >   OpenJPEG support:   	   no
> >   ECW support:   		    no
> >   MrSID support:   		  no
> >   MrSID/MG4 Lidar support:   no
> >   MSG support:   		    no
> >   GRIB support:   		   yes
> >   EPSILON support:   	    no
> >   WebP support:   		   no
> >   cURL support (wms/wcs/...):yes
> >   PostgreSQL support:   	 no
> >   MySQL support:   		  no
> >   Ingres support:   		 no
> >   Xerces-C support:   	   no
> >   NAS support:   		    no
> >   Expat support:   		  yes
> >   libxml2 support:   	    yes
> >   Google libkml support:     no
> >   ODBC support:   		   no
> >   PGeo support:   		   no
> >   FGDB support:   		   no
> >   MDB support:   		    no
> >   PCIDSK support:   		 internal
> >   OCI support:   		    no
> >   GEORASTER support:   	  no
> >   SDE support:   		    no
> >   Rasdaman support:   	   no
> >   DODS support:   		   no
> >   SQLite support:   		 yes
> >   PCRE support:   		   no
> >   SpatiaLite support:   	 no
> >   DWGdirect support   	   no
> >   INFORMIX DataBlade support:no
> >   GEOS support:   		   yes
> >   Poppler support:   	    no
> >   Podofo support:   		 no
> >   OpenCL support:   		 no
> >   Armadillo support:   	  no
> >   FreeXL support:   		 no
> >   SOSI support:   		   no
> >   
> >   
> >   SWIG Bindings:   		  no
> >   
> >   Statically link PROJ.4:    yes
> >   enable OGR building:  	 yes
> >   enable pthread support:    yes
> >   enable POSIX iconv support:yes
> >   hide internal symbols:     no
> > 
> > make -j8 went through without errors, but make install does that
> > again:
> > 
> > 
> > 
> > [132 at l32 gdal-2.0.1]$ make install
> > (cd port; make)
> > make[1]: Entering directory `/path/to/src/gdal-2.0.1/port'
> > make[1]: Nothing to be done for `default'.
> > make[1]: Leaving directory `/path/to/src/gdal-2.0.1/port'
> > (cd gcore; make)
> > make[1]: Entering directory `/path/to/src/gdal-2.0.1/gcore'
> > make -C mdreader
> > make[2]: Entering directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> > make[2]: Nothing to be done for `default'.
> > make[2]: Leaving directory `/path/to/src/gdal-2.0.1/gcore/mdreader'
> > make[1]: Leaving directory `/path/to/src/gdal-2.0.1/gcore'
> > (cd alg; make)
> > make[1]: Entering directory `/path/to/src/gdal-2.0.1/alg'
> > /bin/sh /path/to/src/gdal-2.0.1/libtool --mode=compile --tag=CXX icpc
> > -I/path/to/src/gdal-2.0.1/port -I/path/to/src/gdal-2.0.1/gcore
> > -I/path/to/src/gdal-2.0.1/alg -I/path/to/src/gdal-2.0.1/ogr
> > -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts -g -O2  -Wall  -DHAVE_GEOS=1
> > -I/path/to/src/geos-3.4.2/build/include -DHAVE_SSE_AT_COMPILE_TIME
> > -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> > -I/path/to/src/netcdf-4.3.3.1/build/include  -DGDAL_COMPILATION  -c -o
> > thinplatespline.lo thinplatespline.cpp
> > libtool: compile:  icpc -I/path/to/src/gdal-2.0.1/port
> > -I/path/to/src/gdal-2.0.1/gcore -I/path/to/src/gdal-2.0.1/alg
> > -I/path/to/src/gdal-2.0.1/ogr -I/path/to/src/gdal-2.0.1/ogr/ogrsf_frmts
> > -g -O2 -Wall -DHAVE_GEOS=1 -I/path/to/src/geos-3.4.2/build/include
> > -DHAVE_SSE_AT_COMPILE_TIME -DOGR_ENABLED -I/path/to/src/gdal-2.0.1/port
> > -I/path/to/src/netcdf-4.3.3.1/build/include -DGDAL_COMPILATION -c
> > thinplatespline.cpp  -fPIC -DPIC -o .libs/thinplatespline.o
> > ": internal error: 010101_3007
> > 
> > compilation aborted for thinplatespline.cpp (code 4)
> > make[1]: *** [thinplatespline.lo] Error 1
> > make[1]: Leaving directory `/path/to/src/gdal-2.0.1/alg'
> > make: *** [core-target] Error 2
> > 
> > 
> > Any other ideas?
> 
> Perhaps... Apart from cursing the buggy compiler (if it is an uptodate
> version of it, you might want to report to the vendor as it is a shame it
> aborts on this), you might try to replace the following line of
> alg/thinplatespline.cpp, aroud line 125
> 
> #if defined(__GNUC__) && defined(__x86_64__)
> 
> by
> 
> #if 0
> 
> This will disable an optimization, which is the trickiest part of that
> file.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bontepaarden at gmail.com  Wed Nov  4 05:12:32 2015
From: bontepaarden at gmail.com (Paul Meems)
Date: Wed, 4 Nov 2015 14:12:32 +0100
Subject: [gdal-dev] Promote debug msg to warning
In-Reply-To: <201511031836.24705.even.rouault@spatialys.com>
References: <CAHNf2YSEP4qnzBwbS09RoNWYJcFk984jHr4hPp8bY=g5PRBfpA@mail.gmail.com>
 <201511031836.24705.even.rouault@spatialys.com>
Message-ID: <CAHNf2YQhebNawCHf2aHkxbVSU_SCVwjYaQr58XqrQk6Sz0B=FQ@mail.gmail.com>

Hi Even,

One of our team members created a ticket:
https://trac.osgeo.org/gdal/ticket/6199




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*We've started with the development of MapWindow v5. Read more.
<http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*

2015-11-03 18:36 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Le mardi 03 novembre 2015 09:07:29, Paul Meems a écrit :
> > Hi all,
> >
> > We use GDAL with MapWindow GIS and get the binaries from
> gisinternals.com.
> > We have a SpatiaLite file which can be opened by MapWindow (via GDAL) but
> > cannot be edited.
> >
> > We had to enable the debug messages to understand why.
> > GDAL reports "SpatiaLite v4 DB found, but updating tables disabled
> because
> > runtime spatialite library is v3.0 !" which is a understandable message
> but
> > because it is a debug message and not a warning message it is hard to
> spot.
> >
> > Wouldn't it be more logical if GDAL would report this message as a
> warning?
>
> I guess that would make sense, but only if the database is opened in update
> mode (I've not verified if the message is only emitted in that case), and
> in
> that case return NULL. Patch welcome.
>
> >
> > Thanks,
> >
> > Paul
> >
> > *Paul Meems *
> > Release manager, configuration manager
> > and forum moderator of MapWindow GIS.
> > www.mapwindow.org
> >
> > Owner of MapWindow.nl - Support for
> > Dutch speaking users.
> > www.mapwindow.nl
> >
> >
> >
> > *We've started with the development of MapWindow v5. Read more.
> > <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/31789a91/attachment.html>

From even.rouault at spatialys.com  Wed Nov  4 09:32:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 4 Nov 2015 18:32:28 +0100
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
Message-ID: <201511041832.28069.even.rouault@spatialys.com>

Hi,

Since no remarks have been done on the latest proposal, I move to adopt RFC 
60 : Improved round-tripping in OGR

https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr

Starting with my +1,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Wed Nov  4 12:14:09 2015
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 4 Nov 2015 13:14:09 -0700
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
In-Reply-To: <201511041832.28069.even.rouault@spatialys.com>
References: <201511041832.28069.even.rouault@spatialys.com>
Message-ID: <CADPhZXzmcyv92qNHOQsf6++OBNQG5N-VEHwouQVXLf0+=PPObg@mail.gmail.com>

+1

The generalization of the initial GeoJSON-only proposal to other formats is
a nice bonus and very well done, Even. Thanks!

On Wed, Nov 4, 2015 at 10:32 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Since no remarks have been done on the latest proposal, I move to adopt RFC
> 60 : Improved round-tripping in OGR
>
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
>
> Starting with my +1,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/c3414033/attachment.html>

From ozdogan at wisc.edu  Wed Nov  4 11:16:06 2015
From: ozdogan at wisc.edu (MUTLU OZDOGAN)
Date: Wed, 04 Nov 2015 19:16:06 +0000
Subject: [gdal-dev] gdalwarp
Message-ID: <0CE34D3A-9268-43F1-AC65-14C189796BD7@wisc.edu>

Dear List

I have a compressed 4-band geotiff image with the 4th band being the Alpha channel.  When I reproject this image to any other projection using gdalwarp or cut a a small window out of it using gdal_translate, all pixel values become 0 although in the original image they are not zeros.  I think this is because the alpha channel is being interpreted as a mask band - how do I turn this off?  I just want to be able to reproject the image and retain pixel values of all 4 bands (including the alpha band) in the new reprojected file.

Thank you.

Mutlu..


--
Mutlu Ozdogan, Ph.D.
Associate Professor
Department of Forest and Wildlife Ecology &
Nelson Institute for Environmental Studies
t: (608) 262-0873
e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/a3f9ae0a/attachment.html>

From howard at hobu.co  Wed Nov  4 19:48:31 2015
From: howard at hobu.co (Howard Butler)
Date: Wed, 4 Nov 2015 21:48:31 -0600
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
In-Reply-To: <201511041832.28069.even.rouault@spatialys.com>
References: <201511041832.28069.even.rouault@spatialys.com>
Message-ID: <D5893F5E-5556-421C-9DDB-1C04674A9B86@hobu.co>


> On Nov 4, 2015, at 11:32 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> Since no remarks have been done on the latest proposal, I move to adopt RFC 
> 60 : Improved round-tripping in OGR
> 
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
> 
> Starting with my +1,

+1

Howard

From schwehr at gmail.com  Wed Nov  4 23:09:49 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 4 Nov 2015 23:09:49 -0800
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
In-Reply-To: <201511041832.28069.even.rouault@spatialys.com>
References: <201511041832.28069.even.rouault@spatialys.com>
Message-ID: <CACmBxysEs-eHc0=755Tc00Gbp9mZVij+tfN=Z8hR1snKjdqVeQ@mail.gmail.com>

+1

On Wed, Nov 4, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Since no remarks have been done on the latest proposal, I move to adopt RFC
> 60 : Improved round-tripping in OGR
>
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
>
> Starting with my +1,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151104/eb935eb7/attachment.html>

From szekerest at gmail.com  Thu Nov  5 01:35:31 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 5 Nov 2015 10:35:31 +0100
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
In-Reply-To: <201511041832.28069.even.rouault@spatialys.com>
References: <201511041832.28069.even.rouault@spatialys.com>
Message-ID: <CACALY+SYfCY+8u7Y+keRWPH11OA-BYHpoNKUF5sdCXyqiyU_3w@mail.gmail.com>

+1

Tamas

2015-11-04 18:32 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> Since no remarks have been done on the latest proposal, I move to adopt RFC
> 60 : Improved round-tripping in OGR
>
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
>
> Starting with my +1,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151105/debbdf83/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov  5 03:08:05 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 5 Nov 2015 11:08:05 +0000
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
Message-ID: <5986caf8c967474d8c58f396725d2b87@C119S212VM022.msvyvi.vaha.local>

+1



-Jukka Rahkonen-



>Hi,



>Since no remarks have been done on the latest proposal, I move to adopt RFC

>60 : Improved round-tripping in OGR



>https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr



>Starting with my +1,



>Even

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151105/428cc512/attachment-0001.html>

From damian.dixon at gmail.com  Thu Nov  5 04:40:48 2015
From: damian.dixon at gmail.com (Damian Dixon)
Date: Thu, 5 Nov 2015 12:40:48 +0000
Subject: [gdal-dev] cmake status query
Message-ID: <CAJjdW1wXtZ--udoNF771x=nU=vhLEbyK+-YSr1x-uVsUUsm2bw@mail.gmail.com>

Every time I build GDAL on Windows I have lots of pain as I need to build
for debug, release, x86 and x64.

Having looked in the list archives I noticed that there has been some
experiments with using cmake.

What would be required to adopt cmake build system?

Why did the previous attempt fail to be completed?

Thanks Damian.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151105/d21d2bd8/attachment.html>

From pierre.soille at jrc.ec.europa.eu  Thu Nov  5 07:27:40 2015
From: pierre.soille at jrc.ec.europa.eu (Pierre Soille)
Date: Thu, 05 Nov 2015 16:27:40 +0100
Subject: [gdal-dev] FATAL: CPLGetTLSList() failed to allocate TLS list!
Message-ID: <563B756C.6070609@jrc.ec.europa.eu>

Hello!

when reading 1000's of jp2 images with the JP2OpenJPEG/JPEG-2000 driver,
I get from time to time the following error:

FATAL: CPLGetTLSList() failed to allocate TLS list!

It seems that this error occurs in cpl_multiproc.cpp in case not a call
to VSICalloc() returns a NULL pointer,
see
https://github.com/mapbox/node-srs/blob/master/deps/osr/src/cpl_multiproc.cpp#L665

Any idea/hint, why this type of error could occur?

Thanks,

Pierre

From even.rouault at spatialys.com  Thu Nov  5 07:57:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Nov 2015 16:57:11 +0100
Subject: [gdal-dev] FATAL: CPLGetTLSList() failed to allocate TLS list!
In-Reply-To: <563B756C.6070609@jrc.ec.europa.eu>
References: <563B756C.6070609@jrc.ec.europa.eu>
Message-ID: <201511051657.11965.even.rouault@spatialys.com>

Le jeudi 05 novembre 2015 16:27:40, Pierre Soille a écrit :
> Hello!
> 
> when reading 1000's of jp2 images with the JP2OpenJPEG/JPEG-2000 driver,
> I get from time to time the following error:

How do you read them ? Within the same process one after the others ? With 
(many) threads ?

> 
> FATAL: CPLGetTLSList() failed to allocate TLS list!
> 
> It seems that this error occurs in cpl_multiproc.cpp in case not a call
> to VSICalloc() returns a NULL pointer,
> see
> https://github.com/mapbox/node-srs/blob/master/deps/osr/src/cpl_multiproc.c
> pp#L665

I'm not sure why you mention this repository (although it is code that comes 
originally from GDAL)

> 
> Any idea/hint, why this type of error could occur?

The immediate answer is out of memory condition. That said, the root cause 
might be something else. Hard to diagnose without stack trace, etc...

Are you sure there's not a memory leak in your code... ?

> 
> Thanks,
> 
> Pierre
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicholas+osgeo at nicholaswilliams.net  Thu Nov  5 08:28:34 2015
From: nicholas+osgeo at nicholaswilliams.net (Nicholas Williams)
Date: Thu, 5 Nov 2015 10:28:34 -0600
Subject: [gdal-dev] Pip install: error: 'VSILFILE' was not declared
Message-ID: <CAGn4V3XL38XGjHe-aLwmuVSCZHghD9P6TQaVv9MDbK2o7TcJpA@mail.gmail.com>

I'm on Ubuntu 12.04. I ran this:

apt-get install -y autoconf automake libtool make g++ gdal-bin
libgdal1-1.7.0 libgdal1-dev python-gdal

That installed GDAL 1.7.3.

Then I ran this:

export CPLUS_INCLUDE_PATH=/usr/include/gdal
export C_INCLUDE_PATH=/usr/include/gdal

Then I `pip install`-ed a requirements.txt file with this in it:

https://pypi.python.org/packages/source/G/GDAL/GDAL-1.7.1.tar.gz#md5=38b838d528b309a28a3aa24d4fcef3cd

First I tried it without the two exports above and got these errors:

fatal error: cpl_port.h: No such file or directory
compilation terminated

I quickly found on Google that I needed those two exports to solve that
problem. So I tried it with the two exports, and that solved that fatal
error, but it revealed a whole new problem (the output was very long, so I
truncated all the repetitive stuff off; I can supply full output on
request):

  Running setup.py install for GDAL
    warning: build_py: byte-compiling is disabled, skipping.
    building 'osgeo._gdal' extension
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall
-Wstrict-prototypes -fPIC -I../../port -I../../gcore -I../../alg
-I../../ogr/ -I/usr/include/python2.7
-I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include -c
extensions/gdal_wrap.cpp -o
build/temp.linux-x86_64-2.7/extensions/gdal_wrap.o
    cc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid
for Ada/C/ObjC but not for C++ [enabled by default]
    extensions/gdal_wrap.cpp:2999:67: error: ‘VSILFILE’ has not been
declared
    extensions/gdal_wrap.cpp: In function ‘int wrapper_VSIFReadL(void**,
int, int, int*)’:
...
    extensions/gdal_wrap.cpp: In function ‘int wrapper_VSIFWriteL(int,
char*, int, int, int*)’:
    extensions/gdal_wrap.cpp:3473:1: warning: control reaches end of
non-void function [-Wreturn-type]
    error: command 'gcc' failed with exit status 1
Complete output from command /usr/bin/python -c "import setuptools,
tokenize;__file__='/tmp/pip-60DWKf-build/setup.py';exec(compile(getattr(tokenize,
'open', open)(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))"
install --record /tmp/pip-OEZ4Vd-record/install-record.txt
--single-version-externally-managed --compile:
    running install
    running build
    running build_py
    creating build
    creating build/lib.linux-x86_64-2.7
    copying gdal.py -> build/lib.linux-x86_64-2.7
    copying ogr.py -> build/lib.linux-x86_64-2.7
    copying osr.py -> build/lib.linux-x86_64-2.7
    copying gdalconst.py -> build/lib.linux-x86_64-2.7
    copying gdalnumeric.py -> build/lib.linux-x86_64-2.7
    creating build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/gdal_array.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/gdal.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/osr.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/gdalnumeric.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/gdalconst.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/__init__.py -> build/lib.linux-x86_64-2.7/osgeo
    copying osgeo/ogr.py -> build/lib.linux-x86_64-2.7/osgeo
    warning: build_py: byte-compiling is disabled, skipping.
    running build_ext
    building 'osgeo._gdal' extension
    creating build/temp.linux-x86_64-2.7
    creating build/temp.linux-x86_64-2.7/extensions

gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall
-Wstrict-prototypes -fPIC -I../../port -I../../gcore -I../../alg
-I../../ogr/ -I/usr/include/python2.7
-I/usr/lib/python2.7/dist-packages/numpy/core/include -I/usr/include -c
extensions/gdal_wrap.cpp -o
build/temp.linux-x86_64-2.7/extensions/gdal_wrap.o

    cc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid
for Ada/C/ObjC but not for C++ [enabled by default]
    extensions/gdal_wrap.cpp:2999:67: error: ‘VSILFILE’ has not been
declared
    extensions/gdal_wrap.cpp: In function ‘int wrapper_VSIFReadL(void**,
int, int, int*)’:
    extensions/gdal_wrap.cpp:3034:72: error: cannot convert ‘int*’ to
‘FILE* {aka _IO_FILE*}’ for argument ‘4’ to ‘size_t VSIFReadL(void*,
size_t, size_t, FILE*)’
    extensions/gdal_wrap.cpp: In function ‘int PyProgressProxy(double,
const char*, void*)’:
    extensions/gdal_wrap.cpp:3236:2: warning: the address of
‘_Py_NoneStruct’ will never be NULL [-Waddress]
    extensions/gdal_wrap.cpp: In function ‘int wrapper_VSIStatL(const
char*, StatBuf*, int)’:
    extensions/gdal_wrap.cpp:3457:52: error: ‘VSIStatExL’ was not declared
in this scope
    extensions/gdal_wrap.cpp: At global scope:
    extensions/gdal_wrap.cpp:3465:67: error: ‘VSILFILE’ has not been
declared
    extensions/gdal_wrap.cpp: In function ‘int wrapper_VSIFWriteL(int,
char*, int, int, int*)’:
    extensions/gdal_wrap.cpp:3472:42: error: cannot convert ‘int*’ to
‘FILE* {aka _IO_FILE*}’ for argument ‘4’ to ‘size_t VSIFWriteL(const void*,
size_t, size_t, FILE*)’
    extensions/gdal_wrap.cpp: At global scope:
    extensions/gdal_wrap.cpp:3801:5: error: ‘GDALAsyncReaderH’ does not
name a type
    extensions/gdal_wrap.cpp:3807:8: error: ‘GDALAsyncReaderH’ does not
name a type
    extensions/gdal_wrap.cpp: In function ‘void
DeleteAsyncReaderWrapper(GDALAsyncReaderWrapperH)’:
    extensions/gdal_wrap.cpp:3826:20: error: ‘struct
GDALAsyncReaderWrapper’ has no member named ‘hAsyncReader’
...

Googling those errors, I also find solutions that say I need to use the two
exports above, but given that I AM using those exports, and that it solved
my earlier fatal error, I'm guessing that's not the problem here.

I've tried instead pip installing GDAL-1.9.1.tar.gz and GDAL-2.0.1.tar, but
those just fail earlier with different fatal errors. I'm under the
impression here that I need to match the Python GDAL library version with
the libgdal and python-gdal versions, so I think GDAL-1.7.1.tar.gz is
right. But I can't get the requirement to successfully install.

Help?

Thanks,

Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151105/8f4ffd2a/attachment.html>

From pierre.soille at jrc.ec.europa.eu  Thu Nov  5 09:14:14 2015
From: pierre.soille at jrc.ec.europa.eu (Pierre Soille)
Date: Thu, 05 Nov 2015 18:14:14 +0100
Subject: [gdal-dev] FATAL: CPLGetTLSList() failed to allocate TLS list!
In-Reply-To: <201511051657.11965.even.rouault@spatialys.com>
References: <563B756C.6070609@jrc.ec.europa.eu>
 <201511051657.11965.even.rouault@spatialys.com>
Message-ID: <563B8E66.9000702@jrc.ec.europa.eu>

On 05/11/2015 16:57, Even Rouault wrote:
> Le jeudi 05 novembre 2015 16:27:40, Pierre Soille a écrit :
>> Hello!
>>
>> when reading 1000's of jp2 images with the JP2OpenJPEG/JPEG-2000 driver,
>> I get from time to time the following error:
> How do you read them ? Within the same process one after the others ? With 
> (many) threads ?

I read one file by process.  Since the process are not limited by the
RAM, there are as many processes on the compute node as its number of
cores.  I therefore set OMP_NUM_THREADS to 1.  However, it seems that
the code that creates the error uses pthreads (rather than OpenMP). I
suspect that there are too many (p)threads running simultaneously.  I am
not familiar with pthreads but setting POSIX_NUM_THREADS to 1 did not
help (in fact I do not see any reading of an environment variable in the
cpl_multiproc.cpp code).

Thanks a lot,

Pierre

>
>> FATAL: CPLGetTLSList() failed to allocate TLS list!
>>
>> It seems that this error occurs in cpl_multiproc.cpp in case not a call
>> to VSICalloc() returns a NULL pointer,
>> see
>> https://github.com/mapbox/node-srs/blob/master/deps/osr/src/cpl_multiproc.c
>> pp#L665
> I'm not sure why you mention this repository (although it is code that comes 
> originally from GDAL)
>
>> Any idea/hint, why this type of error could occur?
> The immediate answer is out of memory condition. That said, the root cause 
> might be something else. Hard to diagnose without stack trace, etc...
>
> Are you sure there's not a memory leak in your code... ?
>
>> Thanks,
>>
>> Pierre
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Fri Nov  6 12:22:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 6 Nov 2015 21:22:11 +0100
Subject: [gdal-dev] Antw: Re:  Issues with GDAL compilation
In-Reply-To: <alpine.LRH.2.20.1511061941140.12638@warden.aitchison.me.uk>
References: <5639DEE702000067000170C0@gwia2.boku.ac.at>
 <201511041336.35741.even.rouault@spatialys.com>
 <alpine.LRH.2.20.1511061941140.12638@warden.aitchison.me.uk>
Message-ID: <201511062122.11262.even.rouault@spatialys.com>

Le vendredi 06 novembre 2015 20:58:54, Andrew C Aitchison a écrit :
> On Wed, 4 Nov 2015, Even Rouault wrote:
> > Le mercredi 04 novembre 2015 11:21:31, Matthias Benedikt a écrit :
> >> Perfect!
> >> Replacing
> >> 
> >> 
> >> #if defined(__GNUC__) && defined(__x86_64__)
> >> 
> >> with
> >> 
> >> #if 0
> >> did the trick, thanks a million!
> > 
> > I don't know if you're a C/C+ developer, but if so, perhaps you could
> > provide a patch to detect this compiler ?
> > 
> > I guess this must be something around
> > #ifdef __INTEL_COMPILER
> > 
> > but that's maybe too extreme as I hope that it is just that you use an
> > outdated version of it and that newer versions work better.
> > 
> > So perhaps something like
> > 
> > #if (defined(__INTEL_COMPILER) && __INTEL_COMPILER <=
> > buggy_version_number )
> > 
> > assuming blindlessly that the value of __INTEL_COMPILER reflects a
> > version number.
> 
> Is there a ticket for this ?

I don't think anybody created one yet.

> 
> I have (some) access to a Red Hat 6.5 machine with lots of versions
> (and subversions) of the Intel compilers, so I've had a play.
> 
> Short answer:
> This patch works on gcc, all the intel compilers I tried,
> from version 9 to v15, using the optimized code on the current
> version.
> 
> --- alg/thinplatespline.cpp.orig        2015-11-04 17:29:43.115362678
> +0000
> +++ alg/thinplatespline.cpp.new 2015-11-06 19:48:30.596759849 +0000
> @@ -162,7 +162,7 @@
>       return dist ? dist * log( dist ) : 0.0;
>   }
> 
> -#if defined(__GNUC__) && defined(__x86_64__)
> +#if !defined(__INTEL_COMPILER) || __INTEL_COMPILER >= 1500
> 
>   /* Derived and adapted from code originating from: */
> 

I'm a bit confused by the above. Basically the patch enables the optimization 
only for v15 or above, but in the text, you said that v9 to v15 were fine... 
But perhaps your intent was to not to worry about older versions and just put 
a minimum version, which is fine to me.
Your proposed patch isn't correct however. We must keep the initial condition 
defined(__GNUC__) && defined(__x86_64__) since it would break compilation with 
MSVC for example, and we don't want this optim to be anbled on 32 bit since 
vector instructions require SSE/SSE2 to be efficient (and base i386 compilation 
doesn't enable SSE/SSE2 instructions)

> 
> 
> Longer answer:
> 
> The optimized code also compiles (I haven't tried running it)
> on several earlier versions (1200, 1210 and later 1400
> - we need __INTEL_COMPILER_BUILD_DATE to distinguish which 1400
> versions work and which don't).

Ah ok so it was a v14.x that didn't work for Matthias ?

> 
> If there is a ticket I can put the details in it.

You can create one at https://trac.osgeo.org/gdal/newticket

> 
> Andrew C Aitchison

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Nov  7 06:07:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 7 Nov 2015 15:07:28 +0100
Subject: [gdal-dev] Motion: Adopt RFC 60: Improved round-tripping in OGR
In-Reply-To: <201511041832.28069.even.rouault@spatialys.com>
References: <201511041832.28069.even.rouault@spatialys.com>
Message-ID: <201511071507.29630.even.rouault@spatialys.com>

Le mercredi 04 novembre 2015 18:32:28, Even Rouault a écrit :
> Hi,
> 
> Since no remarks have been done on the latest proposal, I move to adopt RFC
> 60 : Improved round-tripping in OGR
> 
> https://trac.osgeo.org/gdal/wiki/rfc60_improved_roundtripping_in_ogr
> 
> Starting with my +1,

I declare this motion passed with +1 from PSC members HowardB, KurtS, TamasS, 
JukkaR and myself, as well from Sean Gillies.

The implementation has just been merged into trunk.

> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Ori.Bar at elbitsystems.com  Sun Nov  8 07:20:37 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Sun, 8 Nov 2015 15:20:37 +0000
Subject: [gdal-dev] Rotated image
Message-ID: <538E9F517DECA94A86A940F00577EACDF836ACB6@MXHFA01.esl.corp.elbit.co.il>

Hello,
According to GDAL API tutorial:
"In the particular, but common, case of a "north up" image without any rotation or shearing, the georeferencing transform takes the following form ..."
In case I don't want to  be limited to "north up", is there any advanced option to save rotation information or just using a new private TRE ( I am working with NITF and using the SetGeoTransform method.) ?
Thanks.


[cid:image003.png at 01D11A49.C88D8E30]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business 
sensitive information.  Unauthorized interception of this e-mail may constitute 
a violation of law. If you are not the intended recipient, you are hereby 
notified that any review, dissemination, distribution or duplication of this 
communication is strictly prohibited. You are also asked to contact the sender 
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151108/fb2f49b5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 4183 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151108/fb2f49b5/attachment.png>

From dadler at adtechgeospatial.com  Sun Nov  8 12:58:17 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Sun, 8 Nov 2015 15:58:17 -0500
Subject: [gdal-dev] Ticket to add IBM DB2 spatial support to GDAL/OGR
In-Reply-To: <5633DF83.9030505@adtechgeospatial.com>
References: <5633DF83.9030505@adtechgeospatial.com>
Message-ID: <563FB769.4010000@adtechgeospatial.com>

Do I need to do something to move this forward?


-------- Forwarded Message --------
Subject: 	Ticket to add IBM DB2 spatial support to GDAL/OGR
Date: 	Fri, 30 Oct 2015 17:22:11 -0400
From: 	David Adler <dadler at adtechgeospatial.com>
To: 	gdal-dev at lists.osgeo.org



I created the following ticket
https://trac.osgeo.org/gdal/ticket/6191
which includes some information about the DB2 spatial driver we created
and also includes an 'svn diff' of all the code changes/additions.

This is based on the current GDAL 2.1 trunk as of 10/29/2015.

What is the next step?





---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151108/dd8804bf/attachment.html>

From mateusz at loskot.net  Mon Nov  9 01:55:06 2015
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 9 Nov 2015 01:55:06 -0800 (PST)
Subject: [gdal-dev] Ticket to add IBM DB2 spatial support to GDAL/OGR
In-Reply-To: <563FB769.4010000@adtechgeospatial.com>
References: <5633DF83.9030505@adtechgeospatial.com>
 <563FB769.4010000@adtechgeospatial.com>
Message-ID: <1447062906863-5235188.post@n6.nabble.com>

David Adler-2 wrote
> Do I need to do something to move this forward?
> 
> -------- Forwarded Message --------
> Subject: 	Ticket to add IBM DB2 spatial support to GDAL/OGR
> Date: 	Fri, 30 Oct 2015 17:22:11 -0400
> From: 	David Adler &lt;

> dadler@

> &gt;
> To: 	

> gdal-dev at .osgeo

> 
> 
> 
> I created the following ticket
> https://trac.osgeo.org/gdal/ticket/6191
> which includes some information about the DB2 spatial driver we created
> and also includes an 'svn diff' of all the code changes/additions.
> 
> This is based on the current GDAL 2.1 trunk as of 10/29/2015.
> 
> What is the next step?


David,

If nobody picks this earlier, I should be able to review it next week.

Regards,
Mateusz



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Ticket-to-add-IBM-DB2-spatial-support-to-GDAL-OGR-tp5233647p5235188.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Mon Nov  9 02:08:15 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 9 Nov 2015 12:08:15 +0200
Subject: [gdal-dev] 2.0.2, when?
Message-ID: <5640708F.9080205@gmail.com>

2.0.2 would be quite important for me as it contains a fix to #6149.

I actually already released a module to CPAN, which depends on that bug 
fixed. ;)

17 other tickets have been filed and none are active.

https://trac.osgeo.org/gdal/roadmap

I know that it won't happen without somebody making it happen, I'm just 
wishing.

Best regards,

Ari


From even.rouault at spatialys.com  Mon Nov  9 08:46:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Nov 2015 17:46:30 +0100
Subject: [gdal-dev] OSGeo Paris Code Sprint 2016
Message-ID: <201511091746.30589.even.rouault@spatialys.com>

Hi,

The OSGeo code sprint 2016 will be held in Paris, from Tuesday, Feb 23 to 
Friday Feb 26 (4 days). This is a great opportunity for developers and project 
members to meet and tackle cross-project issues. Spread the word.

Details at http://wiki.osgeo.org/wiki/Paris_Code_Sprint_2016

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ramonadeck at web.de  Tue Nov 10 04:45:02 2015
From: ramonadeck at web.de (Ramona Deck)
Date: Tue, 10 Nov 2015 13:45:02 +0100
Subject: [gdal-dev] EPSG:6933
Message-ID: <trinity-77a734ec-1f37-47d6-b441-27849db3c174-1447159502930@3capp-webde-bs37>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151110/1aa9da00/attachment.html>

From ramonadeck at web.de  Tue Nov 10 04:46:56 2015
From: ramonadeck at web.de (Ramona Deck)
Date: Tue, 10 Nov 2015 13:46:56 +0100
Subject: [gdal-dev] EPSG:6933
Message-ID: <trinity-a905d207-bbe5-406b-9ec1-30257ee4a7bf-1447159616857@3capp-webde-bs37>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151110/d1578c58/attachment.html>

From even.rouault at spatialys.com  Tue Nov 10 05:33:49 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Nov 2015 14:33:49 +0100
Subject: [gdal-dev] EPSG:6933
In-Reply-To: <trinity-77a734ec-1f37-47d6-b441-27849db3c174-1447159502930@3capp-webde-bs37>
References: <trinity-77a734ec-1f37-47d6-b441-27849db3c174-1447159502930@3capp-webde-bs37>
Message-ID: <201511101433.49726.even.rouault@spatialys.com>

Ramona,

Long answer:
This CRS probably didn't exist in the EPSG database v8.5 that was used the 
last time the proj/GDAL derived EPSG database was generated. And I see that 
the ellipsoidal Lamber Cylindrical Equal Area projection method 9835 was also 
unknown of GDAL. I've fixed GDAL to recognize it so next time the proj/GDAL 
EPSG database is regenerated EPSG:6933 will be there.

Short answer:

use "+proj=cea +lon_0=0 +lat_ts=30 +x_0=0 +y_0=0 +datum=WGS84 +no_defs" 
instead of EPSG:6933 in the meantime.

Best regards,

Even

Le mardi 10 novembre 2015 13:45:02, Ramona Deck a écrit :
> Hello,
>  
> I want to use Soil Moisture data from the SMOS-project which have EPSG
> code: 6933. I try to use gdalwarp for warping the file into EPSG:32632. 
>  
> 
> This is the code I use:
> >gdalwarp -s_srs EPSG:6933 -t_srs EPSG:32632 -tr 100 100
> >subset_SM_OPER_MIR_CLF3MA_20140101T000000_20140131T235959_270_001_7.tif
> >SM.tif
> 
>  
> Unfortunately I get an error message:
> ERROR 6: EPSG PCS/GCS code 6933 not found in EPSG support files.  Is this a
> valid EPSG coordinate system? ERROR 1: Translating source or target SRS
> failed:
>  EPSG:6933
>  
> So it seems that gdal can't find the EPSG code 6933.
> Is there anything I can do for solving the problem?
> 
>  It would be great to get help. Thank you in advance!
>  
> Best regards,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 10 06:10:49 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Nov 2015 15:10:49 +0100
Subject: [gdal-dev] GeoTIFF with non-meter linear unit in SRS
Message-ID: <201511101510.49554.even.rouault@spatialys.com>

Hi,

I've pushed in trunk per https://trac.osgeo.org/gdal/ticket/6210 a fix to 
hopefully address issues when reading GeoTIFF files whose SRS uses non-meter 
linear units (such as us-foot). I'd appreciate if people could confirm it 
doesn't break existing use cases, and hopefully fix cases that didn't work 
before.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Nov 10 09:22:19 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 10 Nov 2015 19:22:19 +0200
Subject: [gdal-dev] Wrapping VSIStdoutSetRedirection
Message-ID: <564227CB.4050904@gmail.com>

I'd like to wrap VSIStdoutSetRedirection.

I would use it for streaming generated data in a web environment. The 
preferred way to stream data out nowadays in Perl web development is to 
use a write function in Perl space - i.e., not the standard print to stdout.

I can capture stdout and achieve the wanted goal that way but it is a 
bit too hackish I think.

I don't think the wrapping is such a big deal itself - it will require a 
bit unusual function typemap, so I'll limit it to Perl for now - but 
there is something in the C space I need to ask.

How can one undo a redirection done with VSIStdoutSetRedirection? It 
seems to me that it would need a function:

void VSIStdoutUnsetRedirection()
{
     pWriteFunction = fwrite;
     pWriteStream = stdout;
}

but there is no such. Should there be one?

Best,

Ari


From even.rouault at spatialys.com  Tue Nov 10 09:41:06 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Nov 2015 18:41:06 +0100
Subject: [gdal-dev] Wrapping VSIStdoutSetRedirection
In-Reply-To: <564227CB.4050904@gmail.com>
References: <564227CB.4050904@gmail.com>
Message-ID: <201511101841.06262.even.rouault@spatialys.com>

Le mardi 10 novembre 2015 18:22:19, Ari Jolma a écrit :
> I'd like to wrap VSIStdoutSetRedirection.
> 
> I would use it for streaming generated data in a web environment. The
> preferred way to stream data out nowadays in Perl web development is to
> use a write function in Perl space - i.e., not the standard print to
> stdout.
> 
> I can capture stdout and achieve the wanted goal that way but it is a
> bit too hackish I think.
> 
> I don't think the wrapping is such a big deal itself - it will require a
> bit unusual function typemap, so I'll limit it to Perl for now - but
> there is something in the C space I need to ask.
> 
> How can one undo a redirection done with VSIStdoutSetRedirection? It
> seems to me that it would need a function:
> 
> void VSIStdoutUnsetRedirection()
> {
>      pWriteFunction = fwrite;
>      pWriteStream = stdout;
> }
> 
> but there is no such. Should there be one?

Why not just call VSIStdoutSetRedirection(fwrite, stdout) ?

> 
> Best,
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Nov 10 10:13:43 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 10 Nov 2015 20:13:43 +0200
Subject: [gdal-dev] Wrapping VSIStdoutSetRedirection
In-Reply-To: <201511101841.06262.even.rouault@spatialys.com>
References: <564227CB.4050904@gmail.com>
 <201511101841.06262.even.rouault@spatialys.com>
Message-ID: <CAEWPGn7nEcHpsZBbr5x37uUFzcf_ScwaZQox+9W=Da7L9OgNgg@mail.gmail.com>

Maybe because I'm an idiot. :)
Too long coding today.
10.11.2015 19.42 "Even Rouault" <even.rouault at spatialys.com> kirjoitti:

> Le mardi 10 novembre 2015 18:22:19, Ari Jolma a écrit :
> > I'd like to wrap VSIStdoutSetRedirection.
> >
> > I would use it for streaming generated data in a web environment. The
> > preferred way to stream data out nowadays in Perl web development is to
> > use a write function in Perl space - i.e., not the standard print to
> > stdout.
> >
> > I can capture stdout and achieve the wanted goal that way but it is a
> > bit too hackish I think.
> >
> > I don't think the wrapping is such a big deal itself - it will require a
> > bit unusual function typemap, so I'll limit it to Perl for now - but
> > there is something in the C space I need to ask.
> >
> > How can one undo a redirection done with VSIStdoutSetRedirection? It
> > seems to me that it would need a function:
> >
> > void VSIStdoutUnsetRedirection()
> > {
> >      pWriteFunction = fwrite;
> >      pWriteStream = stdout;
> > }
> >
> > but there is no such. Should there be one?
>
> Why not just call VSIStdoutSetRedirection(fwrite, stdout) ?
>
> >
> > Best,
> >
> > Ari
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151110/d443b29d/attachment.html>

From mwtoews at gmail.com  Tue Nov 10 12:56:00 2015
From: mwtoews at gmail.com (Mike Toews)
Date: Wed, 11 Nov 2015 09:56:00 +1300
Subject: [gdal-dev] EPSG:6933
In-Reply-To: <201511101433.49726.even.rouault@spatialys.com>
References: <trinity-77a734ec-1f37-47d6-b441-27849db3c174-1447159502930@3capp-webde-bs37>
 <201511101433.49726.even.rouault@spatialys.com>
Message-ID: <CAM2FmMqzhMZ8grP_GZTLwbwrOEGsUgr2QDJT+9mrKA+6y0sVvQ@mail.gmail.com>

On 11 November 2015 at 02:33, Even Rouault <even.rouault at spatialys.com> wrote:
> Long answer:
> This CRS probably didn't exist in the EPSG database v8.5 that was used the
> last time the proj/GDAL derived EPSG database was generated. And I see that
> the ellipsoidal Lamber Cylindrical Equal Area projection method 9835 was also
> unknown of GDAL. I've fixed GDAL to recognize it so next time the proj/GDAL
> EPSG database is regenerated EPSG:6933 will be there.

Are EPSG:6931 and EPSG:6932 supported as well?

The EASE-Grid Data website [1] indicates they are supported by GDAL
with correct version of PROJ.4 (4.8.0), but I can only get the
original EASE-Grid codes working with gdalsrsinfo / ImportFromEPSG.

[1] https://nsidc.org/data/ease/versions.html

From even.rouault at spatialys.com  Tue Nov 10 13:04:38 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 10 Nov 2015 22:04:38 +0100
Subject: [gdal-dev] EPSG:6933
In-Reply-To: <CAM2FmMqzhMZ8grP_GZTLwbwrOEGsUgr2QDJT+9mrKA+6y0sVvQ@mail.gmail.com>
References: <trinity-77a734ec-1f37-47d6-b441-27849db3c174-1447159502930@3capp-webde-bs37>
 <201511101433.49726.even.rouault@spatialys.com>
 <CAM2FmMqzhMZ8grP_GZTLwbwrOEGsUgr2QDJT+9mrKA+6y0sVvQ@mail.gmail.com>
Message-ID: <201511102204.38363.even.rouault@spatialys.com>

Le mardi 10 novembre 2015 21:56:00, Mike Toews a écrit :
> On 11 November 2015 at 02:33, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > Long answer:
> > This CRS probably didn't exist in the EPSG database v8.5 that was used
> > the last time the proj/GDAL derived EPSG database was generated. And I
> > see that the ellipsoidal Lamber Cylindrical Equal Area projection method
> > 9835 was also unknown of GDAL. I've fixed GDAL to recognize it so next
> > time the proj/GDAL EPSG database is regenerated EPSG:6933 will be there.
> 
> Are EPSG:6931 and EPSG:6932 supported as well?

Not with current distributed GDAL/proj EPSG database. Should come with a next 
update.

> 
> The EASE-Grid Data website [1] indicates they are supported by GDAL
> with correct version of PROJ.4 (4.8.0)

With the important note
"""
Note1: Use these ProjectedCRS Codes for EPSG Version 8.6 or later.
Note2: GDAL tools built with the correct version of PROJ4 will work on the 
EASE-Grid 2.0 projections with PROJ4 strings even if it's built with EPSG 
Codes earlier than 8.6. 
"""

So if you update the GDAL csv files or add a definition in epsg.wkt, that will 
work. It is "just" a matter of updating the database.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Wed Nov 11 15:42:37 2015
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Wed, 11 Nov 2015 23:42:37 +0000 (UTC)
Subject: [gdal-dev] using gdal on ironpython
In-Reply-To: <567309910.2016809.1446630220021.JavaMail.yahoo@mail.yahoo.com>
References: <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <567309910.2016809.1446630220021.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1625964851.3829249.1447285357328.JavaMail.yahoo@mail.yahoo.com>


Hello to GDAL community,


I would like to replicate the following two statements GDAL python has:

    # project the decimal degrees to Mercator:
    gdalwarp -s_srs EPSG:4326 -t_srs EPSG:32631 -r cubic original.asc projected_to_Mercator.tif
    
    # convert the .tif file to .asc:
    gdal_translate -of AAIGrid projected_to_Mercator.tif projected_to_Mercator.asc​

But I can not install GDAL to IronPython 2.7, which is what I am using. 
I googled a bit and Tamas Szekeres said that it is possible to "use the gdal C# bindings to access gdal". I tried doing just that:
referencing both gdal 32 bit and 64 bit gdal .dll libraries, but without success:

    from clr import AddReferenceToFileAndPath as addref
    addref("c:/gdal/gdal_wrap.dll")

I am getting a message:

    > Runtime error (IOException): file does not exist: c:\gdal\gdal_wrap2.dll

Path: "c:/gdal/gdal_wrap.dll" is correct, so I do not understand why it says, that the file does not exist.

Can anyone help me on how upper two GDAL statements can be used in IronPython? Or in any other module? I basically need to project the .asc elevation data to Mercator. But it has to be in IronPython not in ArcGIS, QGIS or any other application.
I would be very grateful for any help.

Thank you in advance,
Kind regards,
Djordje Spasic
   

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151111/ff8509cd/attachment.html>

From userofgdal at gmail.com  Wed Nov 11 20:24:37 2015
From: userofgdal at gmail.com (user gdal)
Date: Thu, 12 Nov 2015 09:54:37 +0530
Subject: [gdal-dev] =?utf-8?q?=28no_subject=29?=
Message-ID: <CAJnZZaJtLcT9vjwjU3CEHeFo2s7_Fyh9KA8u6zWOnv8n8Nt_eg@mail.gmail.com>

Hello,

I have a shape file which consists of many polygons (say 56).
Programmatically I wish to select (say, one poly.) from them. I proceeded
something like this.

OGRLayer *clippingshp; unsigned int NumPolygons;

while((tempfeature=inlayer->GetNextFeature( ))!=NULL)
{
  clippingshp->CreateFeature(tempfeature);
clippingshp->SetFeature(tempfeature);


  NumPolygons=clippingshp->GetFeatureCount( ); /* After this NumPolygons
should be 1 */

  /* But NumPolygons = 56, that is the whole file is selected */
  .
  .
  .
}

Can anyone tell me please how to select a feature (polygon in this context)
and copy it into an OGRLayer.


With many thanks,

Yours sincerely,
  B. Ramesh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151112/ee488707/attachment.html>

From userofgdal at gmail.com  Wed Nov 11 20:27:08 2015
From: userofgdal at gmail.com (user gdal)
Date: Thu, 12 Nov 2015 09:57:08 +0530
Subject: [gdal-dev] Selection using OGR
Message-ID: <CAJnZZaK1NXS+14Q8o6rS32i6+d+nyhTDiV_UVTdZMLydE_ihfQ@mail.gmail.com>

Hello,

I have a shape file which consists of many polygons (say 56).
Programmatically I wish to select (say, one poly.) from them. I proceeded
something like this.

OGRLayer *clippingshp; unsigned int NumPolygons;

while((tempfeature=inlayer->GetNextFeature( ))!=NULL)
{
  clippingshp->CreateFeature(tempfeature);
clippingshp->SetFeature(tempfeature);


  NumPolygons=clippingshp->GetFeatureCount( ); /* After this NumPolygons
should be 1 */

  /* But NumPolygons = 56, that is the whole file is selected */
  .
  .
  .
}

Can anyone tell me please how to select a feature (polygon in this context)
and copy it into an OGRLayer.

With many thanks,

Yours sincerely,
  B. Ramesh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151112/3f33e474/attachment.html>

From issworld2000 at yahoo.com  Thu Nov 12 13:25:37 2015
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Thu, 12 Nov 2015 21:25:37 +0000 (UTC)
Subject: [gdal-dev] using gdal on ironpython
In-Reply-To: <1625964851.3829249.1447285357328.JavaMail.yahoo@mail.yahoo.com>
References: <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <567309910.2016809.1446630220021.JavaMail.yahoo@mail.yahoo.com>
 <1625964851.3829249.1447285357328.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1777196159.4159293.1447363537671.JavaMail.yahoo@mail.yahoo.com>




Hello to gdal community,

I would like to replicate the following two statements GDAL python has:

    # project the decimal degrees to Mercator:
    gdalwarp -s_srs EPSG:4326 -t_srs EPSG:32631 -r cubic original.asc projected_to_Mercator.tif
    
    # convert the .tif file to .asc:
    gdal_translate -of AAIGrid projected_to_Mercator.tif projected_to_Mercator.asc​

But I can not install GDAL to IronPython 2.7, which is what I am using.
I googled a bit and Tamas Szekeres said that it is possible to "use the gdal C# bindings to access gdal". I succeeded in importing "gdal_csharp.dll" assembly into the IronPython:
from clr import AddReferenceToFileAndPath as addref
addref("c:/gdal/gdal2b/gdal_csharp.dll")

import OSGeo.GDAL as gdal


But how would I now project the upper .asc file to Mercator?It requires "gdal wrap" and "gdal translate" functionalities. Are they available through gdal_csharp.dll?

I would be very grateful for any help.

Thank you in advance,
Kind regards,
Djordje Spasic     

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151112/494d090e/attachment.html>

From gane.prog at gmail.com  Fri Nov 13 02:41:03 2015
From: gane.prog at gmail.com (Gane R)
Date: Fri, 13 Nov 2015 16:11:03 +0530
Subject: [gdal-dev] Error building Gdal on Mac OS X with Filegeodb
Message-ID: <CALMrLdAf5ArwG6+aLmOzcG9rTY-qE-AmkWtLsF-g4KV4ndfo7w@mail.gmail.com>

I was trying to build gdal-2.0.1 with Filegeodb (File Geodatabase API 1.4
version for Mac 64-bit (Gcc) for Mac running on intel OS X Yosemite 10.10.5

I get the error undefined symbols for architecture x86_64 at Filegeodb
modules. I think all the compiler and OS requirements are met.


I tried to build gdal-1.10 with Filegeodb on MAC it was not too successful.
I followed the step at
*https://gist.github.com/zhm/2005158 <https://gist.github.com/zhm/2005158>*
 I got error with @ECW@ and @LIB_XML@
gdal lib was not build.

Any suggestions will be appretiated.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/f4ecc1f7/attachment.html>

From ari.jolma at gmail.com  Fri Nov 13 05:48:02 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 13 Nov 2015 15:48:02 +0200
Subject: [gdal-dev] OGR_Dr_Open deprecated
Message-ID: <5645EA12.6040100@gmail.com>

OGR_Dr_Open became deprecated in 2.0 but it is still the main method to 
open vector datasets in the bindings.

I just realized that I would need one method to open all data sets. 
OpenEx seems to be it but I would still need to cast the object into a 
Dataset or a DataSource. Maybe OpenEx should be the preferred way to 
open any data set also with the bindings.

However, I don't seem to find good way to tell whether the data set 
object OpenEx gives me is a raster or a vector. Is there such?

Ari

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/d5c09405/attachment.html>

From even.rouault at spatialys.com  Fri Nov 13 05:58:06 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 13 Nov 2015 14:58:06 +0100
Subject: [gdal-dev] OGR_Dr_Open deprecated
In-Reply-To: <5645EA12.6040100@gmail.com>
References: <5645EA12.6040100@gmail.com>
Message-ID: <201511131458.06681.even.rouault@spatialys.com>

Le vendredi 13 novembre 2015 14:48:02, Ari Jolma a écrit :
> OGR_Dr_Open became deprecated in 2.0 but it is still the main method to
> open vector datasets in the bindings.
> 
> I just realized that I would need one method to open all data sets.
> OpenEx seems to be it but I would still need to cast the object into a
> Dataset or a DataSource.

Just don't cast. You can use a Dataset for all purposes since the OGR_DS_XXXX 
API has been transposed to GDALDatasetXXXX and is already available in 
GDALDatasetShadow

> Maybe OpenEx should be the preferred way to
> open any data set also with the bindings.
> 
> However, I don't seem to find good way to tell whether the data set
> object OpenEx gives me is a raster or a vector. Is there such?

If you open with OpenEx(filename, OF_VECTOR), so read-only + vector, then the 
few drivers that support vector and raster will return NULL if the dataset has 
no vector data and just raster. If you open with OpenEx(filename, OF_VECTOR | 
OF_UPDATE) and they support update mode, then they will return non-NULL even 
if the dataset has no vector data. A robust way of checking if there's vector 
data is to check GetLayerCount() != 0.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Nov 13 06:17:40 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 13 Nov 2015 16:17:40 +0200
Subject: [gdal-dev] OGR_Dr_Open deprecated
In-Reply-To: <201511131458.06681.even.rouault@spatialys.com>
References: <5645EA12.6040100@gmail.com>
 <201511131458.06681.even.rouault@spatialys.com>
Message-ID: <5645F104.3060302@gmail.com>



On 13.11.2015 15:58, Even Rouault wrote:
> Le vendredi 13 novembre 2015 14:48:02, Ari Jolma a écrit :
>> OGR_Dr_Open became deprecated in 2.0 but it is still the main method to
>> open vector datasets in the bindings.
>>
>> I just realized that I would need one method to open all data sets.
>> OpenEx seems to be it but I would still need to cast the object into a
>> Dataset or a DataSource.
> Just don't cast. You can use a Dataset for all purposes since the OGR_DS_XXXX
> API has been transposed to GDALDatasetXXXX and is already available in
> GDALDatasetShadow

Swig imposes typechecks that prevent that. It is like with the GDALGrid, 
which takes a vector dataset. I had to write an explicit cast function 
for DataSource object into a Dataset object. Which I now realize is 
probably not safe since there is an explicit warning against that in the 
docs.

>
>> Maybe OpenEx should be the preferred way to
>> open any data set also with the bindings.
>>
>> However, I don't seem to find good way to tell whether the data set
>> object OpenEx gives me is a raster or a vector. Is there such?
> If you open with OpenEx(filename, OF_VECTOR), so read-only + vector, then the
> few drivers that support vector and raster will return NULL if the dataset has
> no vector data and just raster. If you open with OpenEx(filename, OF_VECTOR |
> OF_UPDATE) and they support update mode, then they will return non-NULL even
> if the dataset has no vector data. A robust way of checking if there's vector
> data is to check GetLayerCount() != 0.

Thanks.

I have so far ignored the OpenEx method. I'll develop it so in the Perl 
bindings that it will return a raster dataset object or a vector data 
set object depending whether the returned handle is raster or vector. 
I'll also deprecate the old Open methods in the Perl bindings.

Ari

>
> Even
>


From even.rouault at spatialys.com  Fri Nov 13 06:37:04 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 13 Nov 2015 15:37:04 +0100
Subject: [gdal-dev] OGR_Dr_Open deprecated
In-Reply-To: <5645F104.3060302@gmail.com>
References: <5645EA12.6040100@gmail.com>
 <201511131458.06681.even.rouault@spatialys.com> <5645F104.3060302@gmail.com>
Message-ID: <201511131537.04841.even.rouault@spatialys.com>

Le vendredi 13 novembre 2015 15:17:40, Ari Jolma a écrit :
> On 13.11.2015 15:58, Even Rouault wrote:
> > Le vendredi 13 novembre 2015 14:48:02, Ari Jolma a écrit :
> >> OGR_Dr_Open became deprecated in 2.0 but it is still the main method to
> >> open vector datasets in the bindings.
> >> 
> >> I just realized that I would need one method to open all data sets.
> >> OpenEx seems to be it but I would still need to cast the object into a
> >> Dataset or a DataSource.
> > 
> > Just don't cast. You can use a Dataset for all purposes since the
> > OGR_DS_XXXX API has been transposed to GDALDatasetXXXX and is already
> > available in GDALDatasetShadow
> 
> Swig imposes typechecks that prevent that. It is like with the GDALGrid,
> which takes a vector dataset.

Not sure if it is a "swig" limitation, or something in the Perl bindings. But 
the Python and Java bindings for sure can use the vector part of 
GDALDatasetShadow.

> I had to write an explicit cast function
> for DataSource object into a Dataset object. Which I now realize is
> probably not safe since there is an explicit warning against that in the
> docs.

At the C level, you can technically cast a GDALDatasetH to a OGRDatasourceH 
since the OGR_DS_ C functions end up calling methods of GDALDataset class. But 
you cannot cast a GDALDataset* to a OGRDatasource* since OGRDatasource* has a 
few virtual methods not available in GDALDataset*

> 
> >> Maybe OpenEx should be the preferred way to
> >> open any data set also with the bindings.
> >> 
> >> However, I don't seem to find good way to tell whether the data set
> >> object OpenEx gives me is a raster or a vector. Is there such?
> > 
> > If you open with OpenEx(filename, OF_VECTOR), so read-only + vector, then
> > the few drivers that support vector and raster will return NULL if the
> > dataset has no vector data and just raster. If you open with
> > OpenEx(filename, OF_VECTOR | OF_UPDATE) and they support update mode,
> > then they will return non-NULL even if the dataset has no vector data. A
> > robust way of checking if there's vector data is to check
> > GetLayerCount() != 0.
> 
> Thanks.
> 
> I have so far ignored the OpenEx method. I'll develop it so in the Perl
> bindings that it will return a raster dataset object or a vector data
> set object depending whether the returned handle is raster or vector.
> I'll also deprecate the old Open methods in the Perl bindings.
> 
> Ari
> 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Nov 13 06:54:36 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 13 Nov 2015 16:54:36 +0200
Subject: [gdal-dev] OGR_Dr_Open deprecated
In-Reply-To: <201511131537.04841.even.rouault@spatialys.com>
References: <5645EA12.6040100@gmail.com>
 <201511131458.06681.even.rouault@spatialys.com> <5645F104.3060302@gmail.com>
 <201511131537.04841.even.rouault@spatialys.com>
Message-ID: <5645F9AC.2010509@gmail.com>


On 13.11.2015 16:37, Even Rouault wrote:
> Not sure if it is a "swig" limitation, or something in the Perl 
> bindings. But the Python and Java bindings for sure can use the vector 
> part of GDALDatasetShadow. 

Ok, I've missed all that. Sigh. Until now there's been a strict 
difference between raster and vector data set objects and the Perl 
bindings have been using the vector methods. I actually had missed the 
duplication of the methods.

Let's see what needs to be done. It may be a bigger task for me on the 
documentation side than on the code side.

Ari


From jluis at ualg.pt  Fri Nov 13 10:46:24 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 13 Nov 2015 18:46:24 -0000
Subject: [gdal-dev] Current SVN doesn't build with VS
Message-ID: <op.x71yfmeodbaoe8@macmarilu>

The error is

v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty  
std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce template  
argument for 'std::initializer_list<_Elem>' from 'int'
         c:\program files (x86)\microsoft visual studio  
12.0\vc\include\algorithm(4108) : see declaration of 'std::max'

Joaquim

From schwehr at gmail.com  Fri Nov 13 11:22:58 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 13 Nov 2015 11:22:58 -0800
Subject: [gdal-dev] Current SVN doesn't build with VS
In-Reply-To: <op.x71yfmeodbaoe8@macmarilu>
References: <op.x71yfmeodbaoe8@macmarilu>
Message-ID: <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>

Hi Joaquim,

I broke the build with https://trac.osgeo.org/gdal/changeset/31403/.  Even
created a ticket: https://trac.osgeo.org/gdal/ticket/6212 and I added your
error message to the ticket.

http://build.gisinternals.com/sdk/Default.aspx has been down, so it's been
tough to see what is happening.

It looks like with my latest fix that the max macro is indeed gone, but now
it looks like you are hitting trouble with C++11.  I've just submitted
https://trac.osgeo.org/gdal/changeset/31463 which might fix the issue.  Can
you do a svn update, try again and let me know what you get?

Thanks,
-kurt



On Fri, Nov 13, 2015 at 10:46 AM, Joaquim Luis <jluis at ualg.pt> wrote:

> The error is
>
> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty
> std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce template
> argument for 'std::initializer_list<_Elem>' from 'int'
>         c:\program files (x86)\microsoft visual studio
> 12.0\vc\include\algorithm(4108) : see declaration of 'std::max'
>
> Joaquim
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/4894aeb9/attachment.html>

From jluis at ualg.pt  Fri Nov 13 11:28:36 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 13 Nov 2015 19:28:36 -0000
Subject: [gdal-dev] Current SVN doesn't build with VS
In-Reply-To: <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>
References: <op.x71yfmeodbaoe8@macmarilu>
 <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>
Message-ID: <op.x710dyy9dbaoe8@macmarilu>

Hi Kurt,

I'll update but later. Now I have to go. Meanwhile I had replaced   
std::max by MAX and it passed that point.



> Hi Joaquim,
>
> I broke the build with https://trac.osgeo.org/gdal/changeset/31403/.   
> Even created a ticket: https://trac.osgeo.org/gdal/ticket/6212 and I  
> added your >error message to the ticket.
>
> http://build.gisinternals.com/sdk/Default.aspx has been down, so it's  
> been tough to see what is happening.
>
> It looks like with my latest fix that the max macro is indeed gone, but  
> now it looks like you are hitting trouble with C++11.  I've just  
> submitted https://>trac.osgeo.org/gdal/changeset/31463 which might fix  
> the issue.  Can you do a svn update, try again and let me know what you  
> get?
>
> Thanks,
> -kurt
>
>
>
> On Fri, Nov 13, 2015 at 10:46 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>> The error is
>>
>> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty  
>> std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce template  
>> argument for >>'std::initializer_list<_Elem>' from 'int'
>>        c:\program files (x86)\microsoft visual studio  
>> 12.0\vc\include\algorithm(4108) : see declaration of 'std::max'
>>
>> Joaquim
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> ----
> http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/3a2a0e3a/attachment.html>

From ari.jolma at gmail.com  Fri Nov 13 13:13:45 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 13 Nov 2015 23:13:45 +0200
Subject: [gdal-dev] OGR_Dr_Open deprecated
In-Reply-To: <201511131537.04841.even.rouault@spatialys.com>
References: <5645EA12.6040100@gmail.com>
 <201511131458.06681.even.rouault@spatialys.com> <5645F104.3060302@gmail.com>
 <201511131537.04841.even.rouault@spatialys.com>
Message-ID: <56465289.3020501@gmail.com>

I'm afraid I've missed this change quite much since it was so nicely 
backwards compatible.

It doesn't make sense to have two classes in the Perl bindings when 
there is really only one in the library - it's too confusing. That means 
I'll need to remove the OGR Driver and DataSource classes completely and 
leave only GDAL Driver and Dataset classes.

That's a backwards incompatible change and it should have been made in 
the 2.0 but it'll happen in 2.1 of the Perl bindings.

Ari


On 13.11.2015 16:37, Even Rouault wrote:
> Le vendredi 13 novembre 2015 15:17:40, Ari Jolma a écrit :
>> On 13.11.2015 15:58, Even Rouault wrote:
>>> Le vendredi 13 novembre 2015 14:48:02, Ari Jolma a écrit :
>>>> OGR_Dr_Open became deprecated in 2.0 but it is still the main method to
>>>> open vector datasets in the bindings.
>>>>
>>>> I just realized that I would need one method to open all data sets.
>>>> OpenEx seems to be it but I would still need to cast the object into a
>>>> Dataset or a DataSource.
>>> Just don't cast. You can use a Dataset for all purposes since the
>>> OGR_DS_XXXX API has been transposed to GDALDatasetXXXX and is already
>>> available in GDALDatasetShadow
>> Swig imposes typechecks that prevent that. It is like with the GDALGrid,
>> which takes a vector dataset.
> Not sure if it is a "swig" limitation, or something in the Perl bindings. But
> the Python and Java bindings for sure can use the vector part of
> GDALDatasetShadow.
>
>> I had to write an explicit cast function
>> for DataSource object into a Dataset object. Which I now realize is
>> probably not safe since there is an explicit warning against that in the
>> docs.
> At the C level, you can technically cast a GDALDatasetH to a OGRDatasourceH
> since the OGR_DS_ C functions end up calling methods of GDALDataset class. But
> you cannot cast a GDALDataset* to a OGRDatasource* since OGRDatasource* has a
> few virtual methods not available in GDALDataset*
>
>>>> Maybe OpenEx should be the preferred way to
>>>> open any data set also with the bindings.
>>>>
>>>> However, I don't seem to find good way to tell whether the data set
>>>> object OpenEx gives me is a raster or a vector. Is there such?
>>> If you open with OpenEx(filename, OF_VECTOR), so read-only + vector, then
>>> the few drivers that support vector and raster will return NULL if the
>>> dataset has no vector data and just raster. If you open with
>>> OpenEx(filename, OF_VECTOR | OF_UPDATE) and they support update mode,
>>> then they will return non-NULL even if the dataset has no vector data. A
>>> robust way of checking if there's vector data is to check
>>> GetLayerCount() != 0.
>> Thanks.
>>
>> I have so far ignored the OpenEx method. I'll develop it so in the Perl
>> bindings that it will return a raster dataset object or a vector data
>> set object depending whether the returned handle is raster or vector.
>> I'll also deprecate the old Open methods in the Perl bindings.
>>
>> Ari
>>
>>> Even


From schwehr at gmail.com  Fri Nov 13 14:16:01 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 13 Nov 2015 14:16:01 -0800
Subject: [gdal-dev] Current SVN doesn't build with VS
In-Reply-To: <op.x710dyy9dbaoe8@macmarilu>
References: <op.x71yfmeodbaoe8@macmarilu>
 <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>
 <op.x710dyy9dbaoe8@macmarilu>
Message-ID: <CACmBxyuZpUsASYyj_FzmmSZPEiJPqMbGyY1c7A+BCJ8CiggU6Q@mail.gmail.com>

Hi Joaquim,

Yes, MAX should work - that was what was originally in the code.  I'm
trying hard to get away from macros and such and get to the most robust
code we can.  I really want to find a way that we can use std::max
<http://www.cplusplus.com/reference/algorithm/max/> which is the C++ way to
get the maximum value.  I'd like to get macro usage down as far as possible
in the C++ and only use them in pure C code.  There are limits, but
std::max shouldn't be one of them.  Any help would be greatly appreciated.

Thanks!
-kurt

On Fri, Nov 13, 2015 at 11:28 AM, Joaquim Luis <jluis at ualg.pt> wrote:

> Hi Kurt,
>
> I'll update but later. Now I have to go. Meanwhile I had replaced
>  std::max by MAX and it passed that point.
>
>
>
> Hi Joaquim,
>
> I broke the build with https://trac.osgeo.org/gdal/changeset/31403/.
> Even created a ticket: https://trac.osgeo.org/gdal/ticket/6212 and I
> added your error message to the ticket.
>
> http://build.gisinternals.com/sdk/Default.aspx has been down, so it's
> been tough to see what is happening.
>
> It looks like with my latest fix that the max macro is indeed gone, but
> now it looks like you are hitting trouble with C++11.  I've just submitted
> https://trac.osgeo.org/gdal/changeset/31463 which might fix the issue.
> Can you do a svn update, try again and let me know what you get?
>
> Thanks,
> -kurt
>
>
>
> On Fri, Nov 13, 2015 at 10:46 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>
>> The error is
>>
>> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty
>> std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce template
>> argument for 'std::initializer_list<_Elem>' from 'int'
>>         c:\program files (x86)\microsoft visual studio
>> 12.0\vc\include\algorithm(4108) : see declaration of 'std::max'
>>
>> Joaquim
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> --
> http://schwehr.org
>
>
>
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/e573d01e/attachment.html>

From jluis at ualg.pt  Fri Nov 13 16:10:46 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 14 Nov 2015 00:10:46 -0000
Subject: [gdal-dev] Current SVN doesn't build with VS
In-Reply-To: <CACmBxyuZpUsASYyj_FzmmSZPEiJPqMbGyY1c7A+BCJ8CiggU6Q@mail.gmail.com>
References: <op.x71yfmeodbaoe8@macmarilu>
 <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>
 <op.x710dyy9dbaoe8@macmarilu>
 <CACmBxyuZpUsASYyj_FzmmSZPEiJPqMbGyY1c7A+BCJ8CiggU6Q@mail.gmail.com>
Message-ID: <op.x72df8f2dbaoe8@macmarilu>

Kurt,

Yes, that fixed it thanks. I see now only this warning

v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2550) : warning C4701: potentially  
uninitialized local variable 'iWrkNumType' used

but it's probably a false positive. As are ...

v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(449) : warning C4701: potentially  
uninitialized local variable 'sdInterfaceID' used
v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(436) : warning C4701: potentially  
uninitialized local variable 'HDFfid' used
v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(446) : warning C4701: potentially  
uninitialized local variable 'acs' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(2632) : warning C4701: potentially  
uninitialized local variable 'ndims' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(3270) : warning C4701: potentially  
uninitialized local variable 'c_info' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(3281) : warning C4701: potentially  
uninitialized local variable 'chunkDef' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(8618) : warning C4701: potentially  
uninitialized local variable 'rank' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9568) : warning C4701: potentially  
uninitialized local variable 'xdum' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9070) : warning C4701: potentially  
uninitialized local variable 'j' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9569) : warning C4701: potentially  
uninitialized local variable 'ydum' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9685) : warning C4701: potentially  
uninitialized local variable 'size' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9847) : warning C4701: potentially  
uninitialized local variable 'xdum' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9848) : warning C4701: potentially  
uninitialized local variable 'ydum' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(10113) : warning C4701: potentially  
uninitialized local variable 'nRetn' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(6501) : warning C4701: potentially  
uninitialized local variable 'yMtr0' used
v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(6500) : warning C4701: potentially  
uninitialized local variable 'xMtr0' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(4282) : warning C4701: potentially  
uninitialized local variable 'nVal' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(5839) : warning C4701: potentially  
uninitialized local variable 'j' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7267) : warning C4701: potentially  
uninitialized local variable 'incr' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7301) : warning C4701: potentially  
uninitialized local variable 'offset' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7271) : warning C4701: potentially  
uninitialized local variable 'index' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7249) : warning C4701: potentially  
uninitialized local variable 'bufOffset' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(8428) : warning C4701: potentially  
uninitialized local variable 'incr' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(8414) : warning C4701: potentially  
uninitialized local variable 'index' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(9199) : warning C4701: potentially  
uninitialized local variable 'j' used
v:\gdal\frmts\hdf4\hdf-eos\swapi.c(2451) : warning C4701: potentially  
uninitialized local variable 'vdataID' used
xcopy /D /Y *.obj ..\..\o
V:EHapi.obj
V:gctp_wrap.obj
V:GDapi.obj
V:SWapi.obj
4 File(s) copied

V:\gdal\frmts>cd hdf5 && nmake /nologo /f makefile.vc && cd .. || exit 1
cl /Zi /Fd..\..\gdal_w64.pdb /nologo /MD /EHsc /FC  
/D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG /W4 /wd4127  
/wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389  
/DHAVE_SSE_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore  
-I..\..\alg -I..\..\ogr\ogrsf_frmts -I..\..\gnm -I..\..\gnm\gnm_frmts  
-I..\..\apps  
-IC:\programs\compa_libs\hdf5-1.8.12\compileds\VC12_64\include -DWIN32  
-D_HDF5USEDLL_ -DOGR_ENABLED -DGDAL_COMPILATION /c hdf5dataset.cpp  
hdf5imagedataset.cpp bagdataset.cpp gh5_convenience.cpp iso19115_srs.cpp
hdf5dataset.cpp
c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)  
: warning C4005: '_HDF5USEDLL_' : macro redefinition
command-line arguments : see previous definition of '_HDF5USEDLL_'
v:\gdal\frmts\hdf5\hdf5dataset.cpp(1197) : warning C4244: '*=' :  
conversion from 'hsize_t' to 'unsigned int', possible loss of data
hdf5imagedataset.cpp
c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)  
: warning C4005: '_HDF5USEDLL_' : macro redefinition
command-line arguments : see previous definition of '_HDF5USEDLL_'
v:\gdal\frmts\hdf5\hdf5imagedataset.cpp(388) : warning C4267: '=' :  
conversion from 'size_t' to 'int', possible loss of data
bagdataset.cpp
c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)  
: warning C4005: '_HDF5USEDLL_' : macro redefinition
command-line arguments : see previous definition of '_HDF5USEDLL_'
v:\gdal\frmts\hdf5\bagdataset.cpp(314) : warning C4267: 'initializing' :  
conversion from 'size_t' to 'int', possible loss of data
v:\gdal\frmts\hdf5\bagdataset.cpp(358) : warning C4244: 'initializing' :  
conversion from 'hsize_t' to 'int', possible loss of data
gh5_convenience.cpp
c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)  
: warning C4005: '_HDF5USEDLL_' : macro redefinition
command-line arguments : see previous definition of '_HDF5USEDLL_'
v:\gdal\frmts\hdf5\gh5_convenience.cpp(62) : warning C4267: 'initializing'  
: conversion from 'size_t' to 'int', possible loss of data
iso19115_srs.cpp


> Hi Joaquim,
>
> Yes, MAX should work - that was what was originally in the code.  I'm  
> trying hard to get away from macros and such and get to the most robust  
> code >we can.  I really want to find a way that we can use std::max  
> which is the C++ way to get the maximum value.  I'd like to get macro  
> usage down as far as >possible in the C++ and only use them in pure C  
> code.  There are limits, but std::max shouldn't be one of them.  Any  
> help would be greatly >appreciated.
>
> Thanks!
> -kurt
>
> On Fri, Nov 13, 2015 at 11:28 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>> Hi Kurt,
>>
>> I'll update but later. Now I have to go. Meanwhile I had replaced   
>> std::max by MAX and it passed that point.
>>
>>
>>
>>> Hi Joaquim,
>>>
>>> I broke the build with https://trac.osgeo.org/gdal/changeset/31403/.   
>>> Even created a ticket: https://trac.osgeo.org/gdal/ticket/6212 and I  
>>> added >>>your error message to the ticket.
>>>
>>> http://build.gisinternals.com/sdk/Default.aspx has been down, so it's  
>>> been tough to see what is happening.
>>>
>>> It looks like with my latest fix that the max macro is indeed gone,  
>>> but now it looks like you are hitting trouble with C++11.  I've just  
>>> >>>submitted https://trac.osgeo.org/gdal/changeset/31463 which might  
>>> fix the issue.  Can you do a svn update, try again and let me know  
>>> what you >>>get?
>>>
>>> Thanks,
>>> -kurt
>>>
>>>
>>>
>>> On Fri, Nov 13, 2015 at 10:46 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>>>> The error is
>>>>
>>>> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty  
>>>> std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce  
>>>> template >>>>argument for 'std::initializer_list<_Elem>' from 'int'
>>>>        c:\program files (x86)\microsoft visual studio  
>>>> 12.0\vc\include\algorithm(4108) : see declaration of 'std::max'
>>>>
>>>> Joaquim
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>>
>>> ----
>>> http://schwehr.org
>>
>>
>>
>
>
>
> ----
> http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151114/3ed0bff5/attachment-0001.html>

From jluis at ualg.pt  Fri Nov 13 18:47:08 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 14 Nov 2015 02:47:08 -0000
Subject: [gdal-dev] Trying to debug a GDAL crash in  "GDALClose(hDataset); "
Message-ID: <op.x72koujsdbaoe8@macmarilu>

Hi,

I'm having strange crashes in GDAL (SVN) when called via GMT. The crashes  
occur at a call to

GDALClose(hDataset);

Now, this is only occurs when I try to read a sub-region of a grid but  
those are GMT details.
It doesn't happen to colleagues on OSX but they are using gdal 1.11. Can't  
say that's the reason but this used to work for me as well on Windows (I  
should know because I wrote that code).

I built a GDAL debug and can see that the crash happens in  
cpl_atomic_ops.cpp

int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int newval)
{
   return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),  
(LONG)newval, (LONG)oldval) == (LONG)oldval;
}

because the 'ptr' is invalid. That function is called by  
gdalrasterblock.cpp

GDALRasterBlock::DropLockForRemovalFromStorage()

	if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )

and the debugger tells me that

	nLockCount	<Unable to read memory>	

and here I'm lost. Where is nLockCount supposed to be set?

Thanks

Joaquim

From schwehr at gmail.com  Fri Nov 13 19:33:45 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 13 Nov 2015 19:33:45 -0800
Subject: [gdal-dev] Current SVN doesn't build with VS
In-Reply-To: <op.x72df8f2dbaoe8@macmarilu>
References: <op.x71yfmeodbaoe8@macmarilu>
 <CACmBxythAKY97U5Fgn9XtB6sUbcv2B-8ZpcHcfe3nn42DPPTyw@mail.gmail.com>
 <op.x710dyy9dbaoe8@macmarilu>
 <CACmBxyuZpUsASYyj_FzmmSZPEiJPqMbGyY1c7A+BCJ8CiggU6Q@mail.gmail.com>
 <op.x72df8f2dbaoe8@macmarilu>
Message-ID: <CACmBxyuKmfWkwnxq7bhuuxRVh9foN+8gcpcw8Y0a0CDeL5vLpQ@mail.gmail.com>

woohoo!  Thank!  I'll see if I can address any of those other warnings:

https://trac.osgeo.org/gdal/ticket/6219

I will give https://trac.osgeo.org/gdal/ticket/6212 a couple days and close
it out if I don't get any more failure reports

On Fri, Nov 13, 2015 at 4:10 PM, Joaquim Luis <jluis at ualg.pt> wrote:

> Kurt,
>
> Yes, that fixed it thanks. I see now only this warning
>
> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2550) : warning C4701: potentially
> uninitialized local variable 'iWrkNumType' used
>
> but it's probably a false positive. As are ...
>
> v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(449) : warning C4701: potentially
> uninitialized local variable 'sdInterfaceID' used
> v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(436) : warning C4701: potentially
> uninitialized local variable 'HDFfid' used
> v:\gdal\frmts\hdf4\hdf-eos\ehapi.c(446) : warning C4701: potentially
> uninitialized local variable 'acs' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(2632) : warning C4701: potentially
> uninitialized local variable 'ndims' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(3270) : warning C4701: potentially
> uninitialized local variable 'c_info' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(3281) : warning C4701: potentially
> uninitialized local variable 'chunkDef' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(8618) : warning C4701: potentially
> uninitialized local variable 'rank' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9568) : warning C4701: potentially
> uninitialized local variable 'xdum' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9070) : warning C4701: potentially
> uninitialized local variable 'j' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9569) : warning C4701: potentially
> uninitialized local variable 'ydum' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9685) : warning C4701: potentially
> uninitialized local variable 'size' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9847) : warning C4701: potentially
> uninitialized local variable 'xdum' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(9848) : warning C4701: potentially
> uninitialized local variable 'ydum' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(10113) : warning C4701: potentially
> uninitialized local variable 'nRetn' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(6501) : warning C4701: potentially
> uninitialized local variable 'yMtr0' used
> v:\gdal\frmts\hdf4\hdf-eos\gdapi.c(6500) : warning C4701: potentially
> uninitialized local variable 'xMtr0' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(4282) : warning C4701: potentially
> uninitialized local variable 'nVal' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(5839) : warning C4701: potentially
> uninitialized local variable 'j' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7267) : warning C4701: potentially
> uninitialized local variable 'incr' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7301) : warning C4701: potentially
> uninitialized local variable 'offset' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7271) : warning C4701: potentially
> uninitialized local variable 'index' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(7249) : warning C4701: potentially
> uninitialized local variable 'bufOffset' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(8428) : warning C4701: potentially
> uninitialized local variable 'incr' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(8414) : warning C4701: potentially
> uninitialized local variable 'index' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(9199) : warning C4701: potentially
> uninitialized local variable 'j' used
> v:\gdal\frmts\hdf4\hdf-eos\swapi.c(2451) : warning C4701: potentially
> uninitialized local variable 'vdataID' used
> xcopy /D /Y *.obj ..\..\o
> V:EHapi.obj
> V:gctp_wrap.obj
> V:GDapi.obj
> V:SWapi.obj
> 4 File(s) copied
>
> V:\gdal\frmts>cd hdf5 && nmake /nologo /f makefile.vc && cd .. || exit 1
> cl /Zi /Fd..\..\gdal_w64.pdb /nologo /MD /EHsc /FC
> /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DDEBUG /W4 /wd4127
> /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4018 /wd4389
> /DHAVE_SSE_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore
> -I..\..\alg -I..\..\ogr\ogrsf_frmts -I..\..\gnm -I..\..\gnm\gnm_frmts
> -I..\..\apps -IC:\programs\compa_libs\hdf5-1.8.12\compileds\VC12_64\include
> -DWIN32 -D_HDF5USEDLL_ -DOGR_ENABLED -DGDAL_COMPILATION /c hdf5dataset.cpp
> hdf5imagedataset.cpp bagdataset.cpp gh5_convenience.cpp iso19115_srs.cpp
> hdf5dataset.cpp
> c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)
> : warning C4005: '_HDF5USEDLL_' : macro redefinition
> command-line arguments : see previous definition of '_HDF5USEDLL_'
> v:\gdal\frmts\hdf5\hdf5dataset.cpp(1197) : warning C4244: '*=' :
> conversion from 'hsize_t' to 'unsigned int', possible loss of data
> hdf5imagedataset.cpp
> c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)
> : warning C4005: '_HDF5USEDLL_' : macro redefinition
> command-line arguments : see previous definition of '_HDF5USEDLL_'
> v:\gdal\frmts\hdf5\hdf5imagedataset.cpp(388) : warning C4267: '=' :
> conversion from 'size_t' to 'int', possible loss of data
> bagdataset.cpp
> c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)
> : warning C4005: '_HDF5USEDLL_' : macro redefinition
> command-line arguments : see previous definition of '_HDF5USEDLL_'
> v:\gdal\frmts\hdf5\bagdataset.cpp(314) : warning C4267: 'initializing' :
> conversion from 'size_t' to 'int', possible loss of data
> v:\gdal\frmts\hdf5\bagdataset.cpp(358) : warning C4244: 'initializing' :
> conversion from 'hsize_t' to 'int', possible loss of data
> gh5_convenience.cpp
> c:\programs\compa_libs\hdf5-1.8.12\compileds\vc12_64\include\h5api_adpt.h(30)
> : warning C4005: '_HDF5USEDLL_' : macro redefinition
> command-line arguments : see previous definition of '_HDF5USEDLL_'
> v:\gdal\frmts\hdf5\gh5_convenience.cpp(62) : warning C4267: 'initializing'
> : conversion from 'size_t' to 'int', possible loss of data
> iso19115_srs.cpp
>
>
> Hi Joaquim,
>
> Yes, MAX should work - that was what was originally in the code.  I'm
> trying hard to get away from macros and such and get to the most robust
> code we can.  I really want to find a way that we can use std::max
> <http://www.cplusplus.com/reference/algorithm/max/> which is the C++ way
> to get the maximum value.  I'd like to get macro usage down as far as
> possible in the C++ and only use them in pure C code.  There are limits,
> but std::max shouldn't be one of them.  Any help would be greatly
> appreciated.
>
> Thanks!
> -kurt
>
> On Fri, Nov 13, 2015 at 11:28 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>
>> Hi Kurt,
>>
>> I'll update but later. Now I have to go. Meanwhile I had replaced
>>  std::max by MAX and it passed that point.
>>
>>
>>
>> Hi Joaquim,
>>
>> I broke the build with https://trac.osgeo.org/gdal/changeset/31403/.
>> Even created a ticket: https://trac.osgeo.org/gdal/ticket/6212 and I
>> added your error message to the ticket.
>>
>> http://build.gisinternals.com/sdk/Default.aspx has been down, so it's
>> been tough to see what is happening.
>>
>> It looks like with my latest fix that the max macro is indeed gone, but
>> now it looks like you are hitting trouble with C++11.  I've just submitted
>> https://trac.osgeo.org/gdal/changeset/31463 which might fix the issue.
>> Can you do a svn update, try again and let me know what you get?
>>
>> Thanks,
>> -kurt
>>
>>
>>
>> On Fri, Nov 13, 2015 at 10:46 AM, Joaquim Luis <jluis at ualg.pt> wrote:
>>
>>> The error is
>>>
>>> v:\gdal\frmts\hdf4\hdf4imagedataset.cpp(2386) : error C2784: '_Ty
>>> std::max(std::initializer_list<_Elem>,_Pr)' : could not deduce template
>>> argument for 'std::initializer_list<_Elem>' from 'int'
>>>         c:\program files (x86)\microsoft visual studio
>>> 12.0\vc\include\algorithm(4108) : see declaration of 'std::max'
>>>
>>> Joaquim
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>> --
>> --
>> http://schwehr.org
>>
>>
>>
>>
>>
>
>
> --
> --
> http://schwehr.org
>
>
>
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/d7b81427/attachment.html>

From schwehr at gmail.com  Fri Nov 13 20:05:38 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 13 Nov 2015 20:05:38 -0800
Subject: [gdal-dev] Trying to debug a GDAL crash in "GDALClose(hDataset);
	"
In-Reply-To: <op.x72koujsdbaoe8@macmarilu>
References: <op.x72koujsdbaoe8@macmarilu>
Message-ID: <CACmBxyv52Kev3zCvnibD0HgZ6e1L=a6W1Bhcx1NT-UxmAaiEZQ@mail.gmail.com>

nLockCount should be set by

https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdal_priv.h#L598

https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_atomic_ops.cpp#L56

which uses InterlockedCompareExchange to change it.

Can you give the whole stack trace?

On Fri, Nov 13, 2015 at 6:47 PM, Joaquim Luis <jluis at ualg.pt> wrote:

> Hi,
>
> I'm having strange crashes in GDAL (SVN) when called via GMT. The crashes
> occur at a call to
>
> GDALClose(hDataset);
>
> Now, this is only occurs when I try to read a sub-region of a grid but
> those are GMT details.
> It doesn't happen to colleagues on OSX but they are using gdal 1.11. Can't
> say that's the reason but this used to work for me as well on Windows (I
> should know because I wrote that code).
>
> I built a GDAL debug and can see that the crash happens in
> cpl_atomic_ops.cpp
>
> int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int newval)
> {
>   return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),
> (LONG)newval, (LONG)oldval) == (LONG)oldval;
> }
>
> because the 'ptr' is invalid. That function is called by
> gdalrasterblock.cpp
>
> GDALRasterBlock::DropLockForRemovalFromStorage()
>
>         if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )
>
> and the debugger tells me that
>
>         nLockCount      <Unable to read memory>
>
> and here I'm lost. Where is nLockCount supposed to be set?
>
> Thanks
>
> Joaquim
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151113/15270d1d/attachment-0001.html>

From ari.jolma at gmail.com  Sat Nov 14 08:46:47 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 14 Nov 2015 18:46:47 +0200
Subject: [gdal-dev] No IDATs written into file
Message-ID: <56476577.4000900@gmail.com>

I'm using the Translate function to clip tiles from a larger raster 
using Perl bindings. I'm clipping into PNG files.

This is in a web service environment, i.e., several workers listening to 
a client. The Translate fails in pngwrite.c, in png_write_end with error 
"No IDATs written into file".

The script works fine when I have only one worker.

I have tried writing the file into file system, VSI file system, etc. 
The error is the same. The output seems to be consistently 33 bytes 
long, i.e., only the header I guess.

I'm using unique file names.

Any ideas?

Ari


From even.rouault at spatialys.com  Sat Nov 14 08:59:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Nov 2015 17:59:20 +0100
Subject: [gdal-dev] No IDATs written into file
In-Reply-To: <56476577.4000900@gmail.com>
References: <56476577.4000900@gmail.com>
Message-ID: <201511141759.20164.even.rouault@spatialys.com>

Le samedi 14 novembre 2015 17:46:47, Ari Jolma a écrit :
> I'm using the Translate function to clip tiles from a larger raster
> using Perl bindings. I'm clipping into PNG files.
> 
> This is in a web service environment, i.e., several workers listening to
> a client.

Ari,

Are the workers multi-threaded or each in their own process ?

But even in the multi-threaded case, I can't reproduce with the following :

#include "cpl_multiproc.h"
#include "gdal_utils.h"
#include "gdal.h"

void copyFunc(void* arg)
{
    const char* pszOut = (const char*)arg;
    GDALDatasetH hSrcDS = GDALOpen("byte.tif", GA_ReadOnly);
    char* argv[] = { "-of", "PNG", NULL };
    GDALTranslateOptions* psOptions = GDALTranslateOptionsNew(argv, NULL);
    GDALClose(GDALTranslate(pszOut, hSrcDS, psOptions, NULL));
    GDALClose(hSrcDS);
    GDALTranslateOptionsFree(psOptions);
}

int main(int argc, char* argv[])
{
    CPLJoinableThread *ht1, *ht2;
    GDALAllRegister();
    while(1)
    {
        ht1 = CPLCreateJoinableThread(copyFunc, "test1.png");
        ht2 = CPLCreateJoinableThread(copyFunc, "test2.png");
        CPLJoinThread(ht1);
        CPLJoinThread(ht2);
    }
}

I assume your GDAL is built --with-threads (which is the default) if you use 
it in a multi-threaded context.

Even

> The Translate fails in pngwrite.c, in png_write_end with error
> "No IDATs written into file".
> 
> The script works fine when I have only one worker.
> 
> I have tried writing the file into file system, VSI file system, etc.
> The error is the same. The output seems to be consistently 33 bytes
> long, i.e., only the header I guess.
> 
> I'm using unique file names.
> 
> Any ideas?
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Sat Nov 14 09:09:45 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 14 Nov 2015 19:09:45 +0200
Subject: [gdal-dev] No IDATs written into file
In-Reply-To: <201511141759.20164.even.rouault@spatialys.com>
References: <56476577.4000900@gmail.com>
 <201511141759.20164.even.rouault@spatialys.com>
Message-ID: <56476AD9.9010107@gmail.com>



On 14.11.2015 18:59, Even Rouault wrote:
> Le samedi 14 novembre 2015 17:46:47, Ari Jolma a écrit :
>> I'm using the Translate function to clip tiles from a larger raster
>> using Perl bindings. I'm clipping into PNG files.
>>
>> This is in a web service environment, i.e., several workers listening to
>> a client.
> Ari,
>
> Are the workers multi-threaded or each in their own process ?

They are in their own processes. The web server is Starman.

The libpng is external, I'll try with internal.

Ari

>
> But even in the multi-threaded case, I can't reproduce with the following :
>
> #include "cpl_multiproc.h"
> #include "gdal_utils.h"
> #include "gdal.h"
>
> void copyFunc(void* arg)
> {
>      const char* pszOut = (const char*)arg;
>      GDALDatasetH hSrcDS = GDALOpen("byte.tif", GA_ReadOnly);
>      char* argv[] = { "-of", "PNG", NULL };
>      GDALTranslateOptions* psOptions = GDALTranslateOptionsNew(argv, NULL);
>      GDALClose(GDALTranslate(pszOut, hSrcDS, psOptions, NULL));
>      GDALClose(hSrcDS);
>      GDALTranslateOptionsFree(psOptions);
> }
>
> int main(int argc, char* argv[])
> {
>      CPLJoinableThread *ht1, *ht2;
>      GDALAllRegister();
>      while(1)
>      {
>          ht1 = CPLCreateJoinableThread(copyFunc, "test1.png");
>          ht2 = CPLCreateJoinableThread(copyFunc, "test2.png");
>          CPLJoinThread(ht1);
>          CPLJoinThread(ht2);
>      }
> }
>
> I assume your GDAL is built --with-threads (which is the default) if you use
> it in a multi-threaded context.
>
> Even
>
>> The Translate fails in pngwrite.c, in png_write_end with error
>> "No IDATs written into file".
>>
>> The script works fine when I have only one worker.
>>
>> I have tried writing the file into file system, VSI file system, etc.
>> The error is the same. The output seems to be consistently 33 bytes
>> long, i.e., only the header I guess.
>>
>> I'm using unique file names.
>>
>> Any ideas?
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Sat Nov 14 09:46:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Nov 2015 18:46:55 +0100
Subject: [gdal-dev] GDAL 2015 annual report for November/December 2015
	Newsletter
Message-ID: <201511141846.56020.even.rouault@spatialys.com>

Hi,

See below Landon's invitation to provide content for the OSGeo Newsletter. 
I've initiated a GDAL 2015 yearly report at
https://trac.osgeo.org/gdal/wiki/AnnualReport2015

Last one was in ... 2008 :-) I'd appreciate if people could contribute any 
additional content (perhaps with some report of Seoul code sprint for 
example), or at least checking and fixing spelling/grammar/style...

Even

----------  Message transmis  ----------

Sujet : Re: [OSGeo-Discuss] November/December 2016 Newsletter
Date : samedi 14 novembre 2015, 17:35:10
De : Landon Blake <sunburned.surveyor at gmail.com>
À : OSGeo Discussions <discuss at lists.osgeo.org>, OSGeo Journal 
<newsletter at lists.osgeo.org>

I haven't heard from any of our committees or chapters. I don't need
several pages of content...just a paragraph or two would be great. Please
let me know what your chapter or committee have been up to!

Thanks for your help.

Landon (sunburned.surveyor at gmail.com)

On Wed, Nov 11, 2015 at 10:07 AM, Landon Blake <sunburned.surveyor at gmail.com
> wrote:

> I've got some time off from my day job this week and I'd like to do some
> work on a November/December 2015 Issue of the OSGeo Newsletter.
>
> I'd like to invite chapters, committees, and software projects to send me
> news and articles on there recent activities. I really appreciate any
> contributions.
>
> You can send content to me directly by e-mail (
> sunburned.surveyor at gmail.com) or to the OSGeo Newsletter Mailing List.
>
> Thanks!
>
> Landon
>

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ozdogan at wisc.edu  Sat Nov 14 10:49:02 2015
From: ozdogan at wisc.edu (ozdogan at wisc.edu)
Date: Sat, 14 Nov 2015 12:49:02 -0600
Subject: [gdal-dev] Alpha band masking
Message-ID: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>

Dear All
I have a 4-band air photo image in which the 4th band is the NIR band but it has also been designated as an alpha band. It is the geotiff format. For some reason whenever I reproject this file (using gdalwarp) or resize it (using gdal_translate) all four bands of the resulting files have zero values. It is as if the alpha band is being used to mask all band values.  Any help reprojecting or windowing this large file without making while retaining all 4 band values would be much appreciated.
Thank you
Mutlu

Sent from my iPhone

From even.rouault at spatialys.com  Sat Nov 14 11:00:45 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 14 Nov 2015 20:00:45 +0100
Subject: [gdal-dev] Alpha band masking
In-Reply-To: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>
References: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>
Message-ID: <201511142000.45553.even.rouault@spatialys.com>

Le samedi 14 novembre 2015 19:49:02, ozdogan at wisc.edu a écrit :
> Dear All
> I have a 4-band air photo image in which the 4th band is the NIR band but
> it has also been designated as an alpha band. It is the geotiff format.
> For some reason whenever I reproject this file (using gdalwarp) or resize
> it (using gdal_translate) all four bands of the resulting files have zero
> values. It is as if the alpha band is being used to mask all band values. 
> Any help reprojecting or windowing this large file without making while
> retaining all 4 band values would be much appreciated. Thank you

Mutlu,

The issue is probably indeed the NIR band being recognized as an alpha band. 
You can remove the alpha interpretation with :

gdal_translate in.tif tmp.tif -co alpha=no
rm tmp.tif.aux.xml (or del tmp.tif.aux.xml on Windows)

The removal of tmp.tif.aux.xml is important otherwise the alpha interpretation 
would be kept in this XML file

And then you can gdalwarp this tmp.file with the arguments you need :

gdalwarp tmp.tif ...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Sat Nov 14 11:57:35 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 14 Nov 2015 19:57:35 -0000
Subject: [gdal-dev] Trying to debug a GDAL crash in "GDALClose(hDataset); "
In-Reply-To: <CACmBxyv52Kev3zCvnibD0HgZ6e1L=a6W1Bhcx1NT-UxmAaiEZQ@mail.gmail.com>
References: <op.x72koujsdbaoe8@macmarilu>
 <CACmBxyv52Kev3zCvnibD0HgZ6e1L=a6W1Bhcx1NT-UxmAaiEZQ@mail.gmail.com>
Message-ID: <op.x73wd9ytdbaoe8@macmarilu>

My bad, I don't know how to produce a stack trace from within the VS  
debugger. I have it all visually but find no option to save it as a file.

I added a breakpoint at  cpl_atomic_ops.cpp#L56 but it didn't stop there  
after the call to   GDALClose(hDataset);
Actually when stepping in  it jumps directly from GDALClose() into  
CPLAtomicCompareAndExchange() but once there (due to crash) I can step  
back to other functions.
Sorry if it's not clear.

Do you have a GMT build with GDAL svn? Could you please try if this  
crashes for you

grdmath -Rd -I1 X = lixo.tiff:GTiff
grdinfo -R0/20/30/50 lixo.tiff


> nLockCount should be set by
>
> https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdal_priv.h#L598
>
> https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_atomic_ops.cpp#L56
>
> which uses InterlockedCompareExchange to change it.
>
> Can you give the whole stack trace?
>
> On Fri, Nov 13, 2015 at 6:47 PM, Joaquim Luis <jluis at ualg.pt> wrote:
>> Hi,
>>
>> I'm having strange crashes in GDAL (SVN) when called via GMT. The  
>> crashes occur at a call to
>>
>> GDALClose(hDataset);
>>
>> Now, this is only occurs when I try to read a sub-region of a grid but  
>> those are GMT details.
>> It doesn't happen to colleagues on OSX but they are using gdal 1.11.  
>> Can't say that's the reason but this used to work for me as well on  
>> Windows (I >>should know because I wrote that code).
>>
>> I built a GDAL debug and can see that the crash happens in  
>> cpl_atomic_ops.cpp
>>
>> int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int  
>> newval)
>> {
>>  return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),  
>> (LONG)newval, (LONG)oldval) == (LONG)oldval;
>> }
>>
>> because the 'ptr' is invalid. That function is called by  
>> gdalrasterblock.cpp
>>
>> GDALRasterBlock::DropLockForRemovalFromStorage()
>>
>>        if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )
>>
>> and the debugger tells me that
>>
>>        nLockCount      <Unable to read memory>
>> and here I'm lost. Where is nLockCount supposed to be set?
>>
>> Thanks
>>
>> Joaquim
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> ----
> http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151114/1d084c5c/attachment.html>

From ari.jolma at gmail.com  Sat Nov 14 13:01:35 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 14 Nov 2015 23:01:35 +0200
Subject: [gdal-dev] No IDATs written into file
In-Reply-To: <201511141759.20164.even.rouault@spatialys.com>
References: <56476577.4000900@gmail.com>
 <201511141759.20164.even.rouault@spatialys.com>
Message-ID: <5647A12F.2000500@gmail.com>

This seems very confusing. The source from which I'm clipping is a 
virtual dataset made from PNG's. The failure happens in 
GDALDataset:RasterIO (it returns CE_Failure) but how it gets there seems 
to be because it does not know the real driver type of the simple 
sources. The driver name at the point of failure returns null and 
filename list is also null.

It goes through DatasetRasterIO of several of the the simple sources 
(for example 8) and then on the 9th it calls poDS->RasterIO, which fails.

Hmm,

Ari

On 14.11.2015 18:59, Even Rouault wrote:
> Le samedi 14 novembre 2015 17:46:47, Ari Jolma a écrit :
>> I'm using the Translate function to clip tiles from a larger raster
>> using Perl bindings. I'm clipping into PNG files.
>>
>> This is in a web service environment, i.e., several workers listening to
>> a client.
> Ari,
>
> Are the workers multi-threaded or each in their own process ?
>
> But even in the multi-threaded case, I can't reproduce with the following :
>
> #include "cpl_multiproc.h"
> #include "gdal_utils.h"
> #include "gdal.h"
>
> void copyFunc(void* arg)
> {
>      const char* pszOut = (const char*)arg;
>      GDALDatasetH hSrcDS = GDALOpen("byte.tif", GA_ReadOnly);
>      char* argv[] = { "-of", "PNG", NULL };
>      GDALTranslateOptions* psOptions = GDALTranslateOptionsNew(argv, NULL);
>      GDALClose(GDALTranslate(pszOut, hSrcDS, psOptions, NULL));
>      GDALClose(hSrcDS);
>      GDALTranslateOptionsFree(psOptions);
> }
>
> int main(int argc, char* argv[])
> {
>      CPLJoinableThread *ht1, *ht2;
>      GDALAllRegister();
>      while(1)
>      {
>          ht1 = CPLCreateJoinableThread(copyFunc, "test1.png");
>          ht2 = CPLCreateJoinableThread(copyFunc, "test2.png");
>          CPLJoinThread(ht1);
>          CPLJoinThread(ht2);
>      }
> }
>
> I assume your GDAL is built --with-threads (which is the default) if you use
> it in a multi-threaded context.
>
> Even
>
>> The Translate fails in pngwrite.c, in png_write_end with error
>> "No IDATs written into file".
>>
>> The script works fine when I have only one worker.
>>
>> I have tried writing the file into file system, VSI file system, etc.
>> The error is the same. The output seems to be consistently 33 bytes
>> long, i.e., only the header I guess.
>>
>> I'm using unique file names.
>>
>> Any ideas?
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From ari.jolma at gmail.com  Sat Nov 14 14:12:24 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 15 Nov 2015 00:12:24 +0200
Subject: [gdal-dev] No IDATs written into file
In-Reply-To: <201511141759.20164.even.rouault@spatialys.com>
References: <56476577.4000900@gmail.com>
 <201511141759.20164.even.rouault@spatialys.com>
Message-ID: <5647B1C8.8050108@gmail.com>

The problem was that the source files of the virtual dataset were not 
readable by the process that was running the web server in multi worker 
mode (production mode) while I was running it myself in the debug mode 
(single worker mode). The .vrt file was readable by all.

The virtual dataset did return an error code but I did not even get to 
the point in my debugging where I could see from the code that it was a 
simple not allowed to open those files - it was so deep. I could not see 
the error message although I tried, it was lost at some point. I'll try 
to understand why.

Best,

Ari

On 14.11.2015 18:59, Even Rouault wrote:
> Le samedi 14 novembre 2015 17:46:47, Ari Jolma a écrit :
>> I'm using the Translate function to clip tiles from a larger raster
>> using Perl bindings. I'm clipping into PNG files.
>>
>> This is in a web service environment, i.e., several workers listening to
>> a client.
> Ari,
>
> Are the workers multi-threaded or each in their own process ?
>
> But even in the multi-threaded case, I can't reproduce with the following :
>
> #include "cpl_multiproc.h"
> #include "gdal_utils.h"
> #include "gdal.h"
>
> void copyFunc(void* arg)
> {
>      const char* pszOut = (const char*)arg;
>      GDALDatasetH hSrcDS = GDALOpen("byte.tif", GA_ReadOnly);
>      char* argv[] = { "-of", "PNG", NULL };
>      GDALTranslateOptions* psOptions = GDALTranslateOptionsNew(argv, NULL);
>      GDALClose(GDALTranslate(pszOut, hSrcDS, psOptions, NULL));
>      GDALClose(hSrcDS);
>      GDALTranslateOptionsFree(psOptions);
> }
>
> int main(int argc, char* argv[])
> {
>      CPLJoinableThread *ht1, *ht2;
>      GDALAllRegister();
>      while(1)
>      {
>          ht1 = CPLCreateJoinableThread(copyFunc, "test1.png");
>          ht2 = CPLCreateJoinableThread(copyFunc, "test2.png");
>          CPLJoinThread(ht1);
>          CPLJoinThread(ht2);
>      }
> }
>
> I assume your GDAL is built --with-threads (which is the default) if you use
> it in a multi-threaded context.
>
> Even
>
>> The Translate fails in pngwrite.c, in png_write_end with error
>> "No IDATs written into file".
>>
>> The script works fine when I have only one worker.
>>
>> I have tried writing the file into file system, VSI file system, etc.
>> The error is the same. The output seems to be consistently 33 bytes
>> long, i.e., only the header I guess.
>>
>> I'm using unique file names.
>>
>> Any ideas?
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Sat Nov 14 16:41:12 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Sun, 15 Nov 2015 00:41:12 -0000
Subject: [gdal-dev] Trying to debug a GDAL crash in "GDALClose(hDataset); "
In-Reply-To: <op.x73wd9ytdbaoe8@macmarilu>
References: <op.x72koujsdbaoe8@macmarilu>
 <CACmBxyv52Kev3zCvnibD0HgZ6e1L=a6W1Bhcx1NT-UxmAaiEZQ@mail.gmail.com>
 <op.x73wd9ytdbaoe8@macmarilu>
Message-ID: <op.x739iyxodbaoe8@macmarilu>

Ok I went ahead I tried it myself. It doesn't crash on OSX



> My bad, I don't know how to produce a stack trace from within the VS  
> debugger. I have it all visually but find no option to save it as a file.
>
> I added a breakpoint at  cpl_atomic_ops.cpp#L56 but it didn't stop there  
> after the call to   GDALClose(hDataset);Actually when stepping in  it  
> jumps directly from GDALClose() into CPLAtomicCompareAndExchange() but  
> once there (due to crash) I can step back >to other functions.
> Sorry if it's not clear.
>
> Do you have a GMT build with GDAL svn? Could you please try if this  
> crashes for you
>
> grdmath -Rd -I1 X = lixo.tiff:GTiff
> grdinfo -R0/20/30/50 lixo.tiff
>
>
>> nLockCount should be set by
>>
>> https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdal_priv.h#L598
>>
>> https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_atomic_ops.cpp#L56
>>
>> which uses InterlockedCompareExchange to change it.
>>
>> Can you give the whole stack trace?
>>
>> On Fri, Nov 13, 2015 at 6:47 PM, Joaquim Luis <jluis at ualg.pt> wrote:
>>> Hi,
>>>
>>> I'm having strange crashes in GDAL (SVN) when called via GMT. The  
>>> crashes occur at a call to
>>>
>>> GDALClose(hDataset);
>>>
>>> Now, this is only occurs when I try to read a sub-region of a grid but  
>>> those are GMT details.
>>> It doesn't happen to colleagues on OSX but they are using gdal 1.11.  
>>> Can't say that's the reason but this used to work for me as well on  
>>> Windows >>>(I should know because I wrote that code).
>>>
>>> I built a GDAL debug and can see that the crash happens in  
>>> cpl_atomic_ops.cpp
>>>
>>> int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int  
>>> newval)
>>> {
>>>  return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),  
>>> (LONG)newval, (LONG)oldval) == (LONG)oldval;
>>> }
>>>
>>> because the 'ptr' is invalid. That function is called by  
>>> gdalrasterblock.cpp
>>>
>>> GDALRasterBlock::DropLockForRemovalFromStorage()
>>>
>>>        if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )
>>>
>>> and the debugger tells me that
>>>
>>>        nLockCount      <Unable to read memory>
>>> and here I'm lost. Where is nLockCount supposed to be set?
>>>
>>> Thanks
>>>
>>> Joaquim
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>> ----
>> http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151115/4563fdb1/attachment.html>

From bishop.dev at gmail.com  Sun Nov 15 03:36:51 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Sun, 15 Nov 2015 14:36:51 +0300
Subject: [gdal-dev] GDAL 2015 annual report for November/December 2015
 Newsletter
In-Reply-To: <201511141846.56020.even.rouault@spatialys.com>
References: <201511141846.56020.even.rouault@spatialys.com>
Message-ID: <56486E53.3000900@gmail.com>

Hi Even,

I added the sentence about FOSS4G 2015 code sprint in Seoul.

Best regards,
     Dmitry

14.11.2015 20:46, Even Rouault пишет:
> Hi,
>
> See below Landon's invitation to provide content for the OSGeo Newsletter.
> I've initiated a GDAL 2015 yearly report at
> https://trac.osgeo.org/gdal/wiki/AnnualReport2015
>
> Last one was in ... 2008 :-) I'd appreciate if people could contribute any
> additional content (perhaps with some report of Seoul code sprint for
> example), or at least checking and fixing spelling/grammar/style...
>
> Even
>
> ----------  Message transmis  ----------
>
> Sujet : Re: [OSGeo-Discuss] November/December 2016 Newsletter
> Date : samedi 14 novembre 2015, 17:35:10
> De : Landon Blake <sunburned.surveyor at gmail.com>
> À : OSGeo Discussions <discuss at lists.osgeo.org>, OSGeo Journal
> <newsletter at lists.osgeo.org>
>
> I haven't heard from any of our committees or chapters. I don't need
> several pages of content...just a paragraph or two would be great. Please
> let me know what your chapter or committee have been up to!
>
> Thanks for your help.
>
> Landon (sunburned.surveyor at gmail.com)
>
> On Wed, Nov 11, 2015 at 10:07 AM, Landon Blake <sunburned.surveyor at gmail.com
>> wrote:
>> I've got some time off from my day job this week and I'd like to do some
>> work on a November/December 2015 Issue of the OSGeo Newsletter.
>>
>> I'd like to invite chapters, committees, and software projects to send me
>> news and articles on there recent activities. I really appreciate any
>> contributions.
>>
>> You can send content to me directly by e-mail (
>> sunburned.surveyor at gmail.com) or to the OSGeo Newsletter Mailing List.
>>
>> Thanks!
>>
>> Landon
>>
> -------------------------------------------------------


From even.rouault at spatialys.com  Sun Nov 15 04:33:59 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 15 Nov 2015 13:33:59 +0100
Subject: [gdal-dev] Trying to debug a GDAL crash in "GDALClose(hDataset);
	"
In-Reply-To: <op.x739iyxodbaoe8@macmarilu>
References: <op.x72koujsdbaoe8@macmarilu> <op.x73wd9ytdbaoe8@macmarilu>
 <op.x739iyxodbaoe8@macmarilu>
Message-ID: <201511151333.59426.even.rouault@spatialys.com>

Le dimanche 15 novembre 2015 01:41:12, Joaquim Luis a écrit :
> Ok I went ahead I tried it myself. It doesn't crash on OSX

Perhaps it is an issue similar to
https://trac.osgeo.org/gdal/ticket/5829 ?

Several workarounds :
- make sure all datasets are closed with GDALClose() before process 
termination (cleanest solution)
- set the env variable GDAL_DESTROY to NO to prevent the termination routine 
of GDAL from run and attempting to close any remaining opened dataset

> 
> > My bad, I don't know how to produce a stack trace from within the VS
> > debugger. I have it all visually but find no option to save it as a file.
> > 
> > I added a breakpoint at  cpl_atomic_ops.cpp#L56 but it didn't stop there
> > after the call to   GDALClose(hDataset);Actually when stepping in  it
> > jumps directly from GDALClose() into CPLAtomicCompareAndExchange() but
> > once there (due to crash) I can step back >to other functions.
> > Sorry if it's not clear.
> > 
> > Do you have a GMT build with GDAL svn? Could you please try if this
> > crashes for you
> > 
> > grdmath -Rd -I1 X = lixo.tiff:GTiff
> > grdinfo -R0/20/30/50 lixo.tiff
> > 
> >> nLockCount should be set by
> >> 
> >> https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdal_priv.h#L598
> >> 
> >> https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_atomic_ops.cpp#L
> >> 56
> >> 
> >> which uses InterlockedCompareExchange to change it.
> >> 
> >> Can you give the whole stack trace?
> >> 
> >> On Fri, Nov 13, 2015 at 6:47 PM, Joaquim Luis <jluis at ualg.pt> wrote:
> >>> Hi,
> >>> 
> >>> I'm having strange crashes in GDAL (SVN) when called via GMT. The
> >>> crashes occur at a call to
> >>> 
> >>> GDALClose(hDataset);
> >>> 
> >>> Now, this is only occurs when I try to read a sub-region of a grid but
> >>> those are GMT details.
> >>> It doesn't happen to colleagues on OSX but they are using gdal 1.11.
> >>> Can't say that's the reason but this used to work for me as well on
> >>> Windows >>>(I should know because I wrote that code).
> >>> 
> >>> I built a GDAL debug and can see that the crash happens in
> >>> cpl_atomic_ops.cpp
> >>> 
> >>> int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int
> >>> newval)
> >>> {
> >>> 
> >>>  return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),
> >>> 
> >>> (LONG)newval, (LONG)oldval) == (LONG)oldval;
> >>> }
> >>> 
> >>> because the 'ptr' is invalid. That function is called by
> >>> gdalrasterblock.cpp
> >>> 
> >>> GDALRasterBlock::DropLockForRemovalFromStorage()
> >>> 
> >>>        if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )
> >>> 
> >>> and the debugger tells me that
> >>> 
> >>>        nLockCount      <Unable to read memory>
> >>> 
> >>> and here I'm lost. Where is nLockCount supposed to be set?
> >>> 
> >>> Thanks
> >>> 
> >>> Joaquim
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> 
> >> ----
> >> http://schwehr.org

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Sun Nov 15 06:08:58 2015
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 15 Nov 2015 14:08:58 +0000 (UTC)
Subject: [gdal-dev] load the file to a gdal data set
In-Reply-To: <1625964851.3829249.1447285357328.JavaMail.yahoo@mail.yahoo.com>
References: <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <2129996913.3859546.1445959170452.JavaMail.yahoo@mail.yahoo.com>
 <567309910.2016809.1446630220021.JavaMail.yahoo@mail.yahoo.com>
 <1625964851.3829249.1447285357328.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1102610769.5082001.1447596538906.JavaMail.yahoo@mail.yahoo.com>


Hello,

Does anyone know, how to load a file to a gdal data set in ironpython through gdal_csharp.dll?
I tried the following:
from clr import AddReferenceToFileAndPath as addref
addref("c:/gdal/gdal_csharp.dll")

import OSGeo.GDAL as gdalcsharp

readOnlyAccess = gdalcsharp.Access.GA_ReadOnly
dataSet = gdalcsharp.Gdal.Open("c:/gdal/elevations.asc", readOnlyAccess)

But at the last line, an exception arise:
The type initializer for 'OSGeo.GDAL.GdalPINVOKE' threw an exception.


What is the problem? Am I defining the Access incorrectly?Thank you in advance.

Kind regards,
Djordje Spasic 

 
   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151115/965405a1/attachment-0001.html>

From jluis at ualg.pt  Sun Nov 15 17:56:29 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 16 Nov 2015 01:56:29 -0000
Subject: [gdal-dev] Trying to debug a GDAL crash in "GDALClose(hDataset); "
In-Reply-To: <201511151333.59426.even.rouault@spatialys.com>
References: <op.x72koujsdbaoe8@macmarilu> <op.x73wd9ytdbaoe8@macmarilu>
 <op.x739iyxodbaoe8@macmarilu> <201511151333.59426.even.rouault@spatialys.com>
Message-ID: <op.x757ofj3dbaoe8@macmarilu>

Even,

Thanks, but this was another thing. I fixed a bug in GMT where under  
certain circumstances we were doing some overflowing access to the  
contents of the 'tmp' variable returned by

		GDALRasterIO(hBand, GF_Read, xOrigin, yOrigin, nXSize, nYSize, tmp,
		             nBufXSize, nBufYSize, GDALGetRasterDataType(hBand), 0, 0);


but this whole issue might not be all over yet.

Joaquim

> Le dimanche 15 novembre 2015 01:41:12, Joaquim Luis a écrit :
>> Ok I went ahead I tried it myself. It doesn't crash on OSX
>
> Perhaps it is an issue similar to
> https://trac.osgeo.org/gdal/ticket/5829 ?
>
> Several workarounds :
> - make sure all datasets are closed with GDALClose() before process
> termination (cleanest solution)
> - set the env variable GDAL_DESTROY to NO to prevent the termination  
> routine
> of GDAL from run and attempting to close any remaining opened dataset
>
>>
>> > My bad, I don't know how to produce a stack trace from within the VS
>> > debugger. I have it all visually but find no option to save it as a  
>> file.
>> >
>> > I added a breakpoint at  cpl_atomic_ops.cpp#L56 but it didn't stop  
>> there
>> > after the call to   GDALClose(hDataset);Actually when stepping in  it
>> > jumps directly from GDALClose() into CPLAtomicCompareAndExchange() but
>> > once there (due to crash) I can step back >to other functions.
>> > Sorry if it's not clear.
>> >
>> > Do you have a GMT build with GDAL svn? Could you please try if this
>> > crashes for you
>> >
>> > grdmath -Rd -I1 X = lixo.tiff:GTiff
>> > grdinfo -R0/20/30/50 lixo.tiff
>> >
>> >> nLockCount should be set by
>> >>
>> >> https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdal_priv.h#L598
>> >>
>> >>  
>> https://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_atomic_ops.cpp#L
>> >> 56
>> >>
>> >> which uses InterlockedCompareExchange to change it.
>> >>
>> >> Can you give the whole stack trace?
>> >>
>> >> On Fri, Nov 13, 2015 at 6:47 PM, Joaquim Luis <jluis at ualg.pt> wrote:
>> >>> Hi,
>> >>>
>> >>> I'm having strange crashes in GDAL (SVN) when called via GMT. The
>> >>> crashes occur at a call to
>> >>>
>> >>> GDALClose(hDataset);
>> >>>
>> >>> Now, this is only occurs when I try to read a sub-region of a grid  
>> but
>> >>> those are GMT details.
>> >>> It doesn't happen to colleagues on OSX but they are using gdal 1.11.
>> >>> Can't say that's the reason but this used to work for me as well on
>> >>> Windows >>>(I should know because I wrote that code).
>> >>>
>> >>> I built a GDAL debug and can see that the crash happens in
>> >>> cpl_atomic_ops.cpp
>> >>>
>> >>> int CPLAtomicCompareAndExchange(volatile int* ptr, int oldval, int
>> >>> newval)
>> >>> {
>> >>>
>> >>>  return (LONG)InterlockedCompareExchange((volatile LONG*)(ptr),
>> >>>
>> >>> (LONG)newval, (LONG)oldval) == (LONG)oldval;
>> >>> }
>> >>>
>> >>> because the 'ptr' is invalid. That function is called by
>> >>> gdalrasterblock.cpp
>> >>>
>> >>> GDALRasterBlock::DropLockForRemovalFromStorage()
>> >>>
>> >>>        if( CPLAtomicCompareAndExchange(&nLockCount, 0, -1) )
>> >>>
>> >>> and the debugger tells me that
>> >>>
>> >>>        nLockCount      <Unable to read memory>
>> >>>
>> >>> and here I'm lost. Where is nLockCount supposed to be set?
>> >>>
>> >>> Thanks
>> >>>
>> >>> Joaquim
>> >>> _______________________________________________
>> >>> gdal-dev mailing list
>> >>> gdal-dev at lists.osgeo.org
>> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >> ----
>> >> http://schwehr.org

From even.rouault at spatialys.com  Mon Nov 16 01:21:16 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Nov 2015 10:21:16 +0100
Subject: [gdal-dev] Alpha band masking
In-Reply-To: <190B8674-903F-47A8-A41A-B8BA3FEA0894@wisc.edu>
References: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>
 <201511142000.45553.even.rouault@spatialys.com>
 <190B8674-903F-47A8-A41A-B8BA3FEA0894@wisc.edu>
Message-ID: <201511161021.17036.even.rouault@spatialys.com>

Le samedi 14 novembre 2015 22:26:48, Mutlu Ozdogan a écrit :
> Dear Evan
> Thank you so much for the input. I actually tried exactly those steps and
> unfortunately I still get 0s in the output file. Thank you again

Could you post the result of "gdalinfo -mm your_input_file.tif" and the exact 
GDAL commands you use ?

> Mutlu
> 
> Sent from my iPhone
> 
> > On Nov 14, 2015, at 1:00 PM, Even Rouault <even.rouault at spatialys.com>
> > wrote:
> > 
> > Le samedi 14 novembre 2015 19:49:02, ozdogan at wisc.edu a écrit :
> >> Dear All
> >> I have a 4-band air photo image in which the 4th band is the NIR band
> >> but it has also been designated as an alpha band. It is the geotiff
> >> format. For some reason whenever I reproject this file (using gdalwarp)
> >> or resize it (using gdal_translate) all four bands of the resulting
> >> files have zero values. It is as if the alpha band is being used to
> >> mask all band values. Any help reprojecting or windowing this large
> >> file without making while retaining all 4 band values would be much
> >> appreciated. Thank you
> > 
> > Mutlu,
> > 
> > The issue is probably indeed the NIR band being recognized as an alpha
> > band. You can remove the alpha interpretation with :
> > 
> > gdal_translate in.tif tmp.tif -co alpha=no
> > rm tmp.tif.aux.xml (or del tmp.tif.aux.xml on Windows)
> > 
> > The removal of tmp.tif.aux.xml is important otherwise the alpha
> > interpretation would be kept in this XML file
> > 
> > And then you can gdalwarp this tmp.file with the arguments you need :
> > 
> > gdalwarp tmp.tif ...
> > 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Ori.Bar at elbitsystems.com  Mon Nov 16 06:51:10 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Mon, 16 Nov 2015 14:51:10 +0000
Subject: [gdal-dev] GetGCPs returns null
Message-ID: <538E9F517DECA94A86A940F00577EACDF836C786@MXHFA01.esl.corp.elbit.co.il>

Hi all,
I wanted some explanations please about how to work with the GCPs.
I have an image and I want to save its corners coordinates (not a rectangle) as GCPs and not using the SetGeoTransform method which takes the upper-left coordinate and creates a rectangle based on it.
I accomplished it using the SetGCPs method. I even see that the IGEOLO field (I am working with NITF) is set correctly with those coordinates.
The problem is that I want to retrieve those coordinates for painting a footprint on a map I have.
I Tried the GetGCPs method but I got null. Also the GetGCPCount returns 0.
(I can get the data from the IGEOLO, but I prefer another solution, and in general to understand why GetGCPs returns nothing...)

Thanks.


[cid:image001.png at 01D1208E.FB1CD270]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business 
sensitive information.  Unauthorized interception of this e-mail may constitute 
a violation of law. If you are not the intended recipient, you are hereby 
notified that any review, dissemination, distribution or duplication of this 
communication is strictly prohibited. You are also asked to contact the sender 
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151116/550c7f02/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4164 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151116/550c7f02/attachment.png>

From even.rouault at spatialys.com  Mon Nov 16 07:01:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Nov 2015 16:01:17 +0100
Subject: [gdal-dev] GetGCPs returns null
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C786@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C786@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <201511161601.17581.even.rouault@spatialys.com>

Le lundi 16 novembre 2015 15:51:10, Bar Ori a écrit :
> Hi all,
> I wanted some explanations please about how to work with the GCPs.
> I have an image and I want to save its corners coordinates (not a
> rectangle) as GCPs and not using the SetGeoTransform method which takes
> the upper-left coordinate and creates a rectangle based on it. I
> accomplished it using the SetGCPs method. I even see that the IGEOLO field
> (I am working with NITF) is set correctly with those coordinates. The
> problem is that I want to retrieve those coordinates for painting a
> footprint on a map I have. I Tried the GetGCPs method but I got null. Also
> the GetGCPCount returns 0. (I can get the data from the IGEOLO, but I
> prefer another solution, and in general to understand why GetGCPs returns
> nothing...)

Could be related to a wrong value of the ICORDS creation option. SetGCPs() and 
GetGCPS() are tested in 
https://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers/nitf.py#L1967

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 16 09:18:53 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Nov 2015 18:18:53 +0100
Subject: [gdal-dev] GetGCPs returns null
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C7A2@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C786@MXHFA01.esl.corp.elbit.co.il>
 <201511161601.17581.even.rouault@spatialys.com>
 <538E9F517DECA94A86A940F00577EACDF836C7A2@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <201511161818.53751.even.rouault@spatialys.com>

Le lundi 16 novembre 2015 16:24:40, Bar Ori a écrit :
> I am using ICORDS="D", but I also tried ICORDS ="G". Didn't work.

If the corner coordinates are almost a rectangle (I know you mention they are 
not, but in the case they would be close to one, but not strictly one), it is 
possible that an approximate GeoTransform is computed from them.
Otherwise you'll have to debug in the driver to figure what happens. First step 
would be to display debug messages with CPL_DEBUG=ON

> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: 16 November 2015 17:01
> To: gdal-dev at lists.osgeo.org
> Cc: Bar Ori
> Subject: Re: [gdal-dev] GetGCPs returns null
> 
> Le lundi 16 novembre 2015 15:51:10, Bar Ori a écrit :
> > Hi all,
> > I wanted some explanations please about how to work with the GCPs.
> > I have an image and I want to save its corners coordinates (not a
> > rectangle) as GCPs and not using the SetGeoTransform method which
> > takes the upper-left coordinate and creates a rectangle based on it. I
> > accomplished it using the SetGCPs method. I even see that the IGEOLO
> > field (I am working with NITF) is set correctly with those
> > coordinates. The problem is that I want to retrieve those coordinates
> > for painting a footprint on a map I have. I Tried the GetGCPs method
> > but I got null. Also the GetGCPCount returns 0. (I can get the data
> > from the IGEOLO, but I prefer another solution, and in general to
> > understand why GetGCPs returns
> > nothing...)
> 
> Could be related to a wrong value of the ICORDS creation option. SetGCPs()
> and GetGCPS() are tested in
> https://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers/nitf.py#L1967
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
> 
> The information in this e-mail transmission contains proprietary and
> business sensitive information.  Unauthorized interception of this e-mail
> may constitute a violation of law. If you are not the intended recipient,
> you are hereby notified that any review, dissemination, distribution or
> duplication of this communication is strictly prohibited. You are also
> asked to contact the sender by reply email and immediately destroy all
> copies of the original message.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 16 09:56:49 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Nov 2015 18:56:49 +0100
Subject: [gdal-dev] GetGCPs returns null
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C7DE@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C786@MXHFA01.esl.corp.elbit.co.il>
 <201511161818.53751.even.rouault@spatialys.com>
 <538E9F517DECA94A86A940F00577EACDF836C7DE@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <201511161856.49049.even.rouault@spatialys.com>

Le lundi 16 novembre 2015 18:51:01, Bar Ori a écrit :
> I did some check now and yes...
> Idea is that for my tests, I used simple case of rectangle.
> Now, I changed a little the coordinates (not a rectangle) and received the
> points. Little weird but at least solved.
> Thank you very much.

Please keep the list CC'ed

> 
> So in this case, if the GCP count are 0, I can assume it is a rectangle and
> use the GeoTransform and if not, to extricate the GCPs. Am I right?

GetGeoTransform() will return CE_None if there's a geotransform or CE_Failure 
otherwise.
So you can call GetGeoTransform() and GetGCPs() in the order you wish.

> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: 16 November 2015 19:19
> To: Bar Ori
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GetGCPs returns null
> 
> Le lundi 16 novembre 2015 16:24:40, Bar Ori a écrit :
> > I am using ICORDS="D", but I also tried ICORDS ="G". Didn't work.
> 
> If the corner coordinates are almost a rectangle (I know you mention they
> are not, but in the case they would be close to one, but not strictly
> one), it is possible that an approximate GeoTransform is computed from
> them. Otherwise you'll have to debug in the driver to figure what happens.
> First step would be to display debug messages with CPL_DEBUG=ON
> 
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: 16 November 2015 17:01
> > To: gdal-dev at lists.osgeo.org
> > Cc: Bar Ori
> > Subject: Re: [gdal-dev] GetGCPs returns null
> > 
> > Le lundi 16 novembre 2015 15:51:10, Bar Ori a écrit :
> > > Hi all,
> > > I wanted some explanations please about how to work with the GCPs.
> > > I have an image and I want to save its corners coordinates (not a
> > > rectangle) as GCPs and not using the SetGeoTransform method which
> > > takes the upper-left coordinate and creates a rectangle based on it. I
> > > accomplished it using the SetGCPs method. I even see that the IGEOLO
> > > field (I am working with NITF) is set correctly with those
> > > coordinates. The problem is that I want to retrieve those coordinates
> > > for painting a footprint on a map I have. I Tried the GetGCPs method
> > > but I got null. Also the GetGCPCount returns 0. (I can get the data
> > > from the IGEOLO, but I prefer another solution, and in general to
> > > understand why GetGCPs returns
> > > nothing...)
> > 
> > Could be related to a wrong value of the ICORDS creation option.
> > SetGCPs() and GetGCPS() are tested in
> > https://trac.osgeo.org/gdal/browser/trunk/autotest/gdrivers/nitf.py#L1967
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services http://www.spatialys.com
> > 
> > The information in this e-mail transmission contains proprietary and
> > business sensitive information.  Unauthorized interception of this e-mail
> > may constitute a violation of law. If you are not the intended recipient,
> > you are hereby notified that any review, dissemination, distribution or
> > duplication of this communication is strictly prohibited. You are also
> > asked to contact the sender by reply email and immediately destroy all
> > copies of the original message.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 17 01:04:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 10:04:35 +0100
Subject: [gdal-dev] Alpha band masking
In-Reply-To: <907BCE23-30B2-4195-90C0-DD6E0135EFEC@wisc.edu>
References: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>
 <201511161021.17036.even.rouault@spatialys.com>
 <907BCE23-30B2-4195-90C0-DD6E0135EFEC@wisc.edu>
Message-ID: <201511171004.35567.even.rouault@spatialys.com>

Le mardi 17 novembre 2015 04:08:41, MUTLU OZDOGAN a écrit :
> Dear Even,
> 
> The result of the gdalinfo -mm command is this:
> 
> Driver: GTiff/GeoTIFF
> Files: pr026029_5m.tif
>        pr026029_5m.tfw
> Size is 35921, 41035
> Coordinate System is:
> PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",
>     GEOGCS["NAD83(HARN)",
>         DATUM["NAD83_High_Accuracy_Reference_Network",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6152"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-90],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",520000],
>     PARAMETER["false_northing",-4480000],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (296789.742753763101064,562520.115095380693674)
> Pixel Size = (5.000000000000000,-5.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  296789.743,  562520.115) ( 92d51'25.45"W, 45d30' 1.70"N)
> Lower Left  (  296789.743,  357345.115) ( 92d46' 5.00"W, 43d39'20.14"N)
> Upper Right (  476394.743,  562520.115) ( 90d33'30.53"W, 45d32' 5.47"N)
> Lower Right (  476394.743,  357345.115) ( 90d32'27.79"W, 43d41'16.23"N)
> Center      (  386592.243,  459932.615) ( 91d40'51.66"W, 44d36' 1.34"N)
> Band 1 Block=35921x1 Type=Byte, ColorInterp=Red
>     Computed Min/Max=0.000,255.000
>   Mask Flags: PER_DATASET ALPHA
> Band 2 Block=35921x1 Type=Byte, ColorInterp=Green
>     Computed Min/Max=0.000,255.000
>   Mask Flags: PER_DATASET ALPHA
> Band 3 Block=35921x1 Type=Byte, ColorInterp=Blue
>     Computed Min/Max=0.000,255.000
>   Mask Flags: PER_DATASET ALPHA
> Band 4 Block=35921x1 Type=Byte, ColorInterp=Alpha
>     Computed Min/Max=0.000,255.000
> 
> the exact commands I used are:
> 
> gdal_translate  pr026029_5m.tif tmp.tif -co alpha=no

--> Did you remove tmp.tif.aux.xml as I mentionned before ?

Note: given the use of gdalwarp you make, you could also just use 
gdal_translate -projwin instead (caution: the order of arguments is not the 
same since -projwin expect upper_left_x upper_left_y lower_right_x 
lower_right_y)

> 
> then
> 
> gdalwarp -te 422861.999 225313.018 489606.999 308903.018 -tr 5 5 tmp.tif
> out.tif
> 
> The results of the out.tif is the problematic output as all the bands are
> zeros as in:
> 
> Driver: GTiff/GeoTIFF
> Files: out.tif
> Size is 13349, 16718
> Coordinate System is:
> PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",
>     GEOGCS["NAD83(HARN)",
>         DATUM["NAD83_High_Accuracy_Reference_Network",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6152"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-90],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",520000],
>     PARAMETER["false_northing",-4480000],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (422861.999000000010710,308903.017999999981839)
> Pixel Size = (5.000000000000000,-5.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  422861.999,  308903.018) ( 91d11'47.57"W, 43d14'48.02"N)
> Lower Left  (  422861.999,  225313.018) ( 91d10'55.54"W, 42d29'38.70"N)
> Upper Right (  489606.999,  308903.018) ( 90d22'27.90"W, 43d15' 8.35"N)
> Lower Right (  489606.999,  225313.018) ( 90d22'11.62"W, 42d29'58.50"N)
> Center      (  456234.499,  267108.018) ( 90d46'50.60"W, 42d52'26.06"N)
> Band 1 Block=13349x1 Type=Byte, ColorInterp=Red
>     Computed Min/Max=0.000,0.000
>   Mask Flags: PER_DATASET ALPHA
> Band 2 Block=13349x1 Type=Byte, ColorInterp=Green
>     Computed Min/Max=0.000,0.000
>   Mask Flags: PER_DATASET ALPHA
> Band 3 Block=13349x1 Type=Byte, ColorInterp=Blue
>     Computed Min/Max=0.000,0.000
>   Mask Flags: PER_DATASET ALPHA
> Band 4 Block=13349x1 Type=Byte, ColorInterp=Alpha
>     Computed Min/Max=0.000,0.000
> 
> Thank you so much.
> 
> Mutlu..
> 
> 
> 
> On Nov 16, 2015, at 3:21 AM, Even Rouault
> <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
> 
> Le samedi 14 novembre 2015 22:26:48, Mutlu Ozdogan a écrit :
> Dear Evan
> Thank you so much for the input. I actually tried exactly those steps and
> unfortunately I still get 0s in the output file. Thank you again
> 
> Could you post the result of "gdalinfo -mm your_input_file.tif" and the
> exact GDAL commands you use ?
> 
> Mutlu
> 
> Sent from my iPhone
> 
> On Nov 14, 2015, at 1:00 PM, Even Rouault
> <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
> 
> Le samedi 14 novembre 2015 19:49:02,
> ozdogan at wisc.edu<mailto:ozdogan at wisc.edu> a écrit : Dear All
> I have a 4-band air photo image in which the 4th band is the NIR band
> but it has also been designated as an alpha band. It is the geotiff
> format. For some reason whenever I reproject this file (using gdalwarp)
> or resize it (using gdal_translate) all four bands of the resulting
> files have zero values. It is as if the alpha band is being used to
> mask all band values. Any help reprojecting or windowing this large
> file without making while retaining all 4 band values would be much
> appreciated. Thank you
> 
> Mutlu,
> 
> The issue is probably indeed the NIR band being recognized as an alpha
> band. You can remove the alpha interpretation with :
> 
> gdal_translate in.tif tmp.tif -co alpha=no
> rm tmp.tif.aux.xml (or del tmp.tif.aux.xml on Windows)
> 
> The removal of tmp.tif.aux.xml is important otherwise the alpha
> interpretation would be kept in this XML file
> 
> And then you can gdalwarp this tmp.file with the arguments you need :
> 
> gdalwarp tmp.tif ...
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> 
> 
> --
> Mutlu Ozdogan, Ph.D.
> Associate Professor
> Department of Forest and Wildlife Ecology &
> Nelson Institute for Environmental Studies
> t: (608) 262-0873
> e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 17 08:50:54 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 17:50:54 +0100
Subject: [gdal-dev] Alpha band masking
In-Reply-To: <460F0A96-176D-4E28-85BE-361ECBB4F44A@wisc.edu>
References: <893BDB68-95E8-4F56-973E-9075B2A0FE7A@wisc.edu>
 <201511171004.35567.even.rouault@spatialys.com>
 <460F0A96-176D-4E28-85BE-361ECBB4F44A@wisc.edu>
Message-ID: <201511171750.54491.even.rouault@spatialys.com>

Le mardi 17 novembre 2015 10:19:59, Mutlu Ozdogan a écrit :
> Yes I have removed the xml file sorry I forgot to include that

Try also adding "-co alpha=no -overwrite" to the gdalwarp command line, 
although it shouldn't have any influence on the pixel values at that stage. 

> 
> Sent from my iPhone
> 
> > On Nov 17, 2015, at 3:04 AM, Even Rouault <even.rouault at spatialys.com>
> > wrote:
> > 
> > Le mardi 17 novembre 2015 04:08:41, MUTLU OZDOGAN a écrit :
> >> Dear Even,
> >> 
> >> The result of the gdalinfo -mm command is this:
> >> 
> >> Driver: GTiff/GeoTIFF
> >> Files: pr026029_5m.tif
> >> 
> >>       pr026029_5m.tfw
> >> 
> >> Size is 35921, 41035
> >> Coordinate System is:
> >> PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",
> >> 
> >>    GEOGCS["NAD83(HARN)",
> >>    
> >>        DATUM["NAD83_High_Accuracy_Reference_Network",
> >>        
> >>            SPHEROID["GRS 1980",6378137,298.2572221010002,
> >>            
> >>                AUTHORITY["EPSG","7019"]],
> >>            
> >>            AUTHORITY["EPSG","6152"]],
> >>        
> >>        PRIMEM["Greenwich",0],
> >>        UNIT["degree",0.0174532925199433]],
> >>    
> >>    PROJECTION["Transverse_Mercator"],
> >>    PARAMETER["latitude_of_origin",0],
> >>    PARAMETER["central_meridian",-90],
> >>    PARAMETER["scale_factor",0.9996],
> >>    PARAMETER["false_easting",520000],
> >>    PARAMETER["false_northing",-4480000],
> >>    UNIT["metre",1,
> >>    
> >>        AUTHORITY["EPSG","9001"]]]
> >> 
> >> Origin = (296789.742753763101064,562520.115095380693674)
> >> Pixel Size = (5.000000000000000,-5.000000000000000)
> >> 
> >> Metadata:
> >>  AREA_OR_POINT=Area
> >> 
> >> Image Structure Metadata:
> >>  INTERLEAVE=PIXEL
> >> 
> >> Corner Coordinates:
> >> Upper Left  (  296789.743,  562520.115) ( 92d51'25.45"W, 45d30' 1.70"N)
> >> Lower Left  (  296789.743,  357345.115) ( 92d46' 5.00"W, 43d39'20.14"N)
> >> Upper Right (  476394.743,  562520.115) ( 90d33'30.53"W, 45d32' 5.47"N)
> >> Lower Right (  476394.743,  357345.115) ( 90d32'27.79"W, 43d41'16.23"N)
> >> Center      (  386592.243,  459932.615) ( 91d40'51.66"W, 44d36' 1.34"N)
> >> Band 1 Block=35921x1 Type=Byte, ColorInterp=Red
> >> 
> >>    Computed Min/Max=0.000,255.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 2 Block=35921x1 Type=Byte, ColorInterp=Green
> >> 
> >>    Computed Min/Max=0.000,255.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 3 Block=35921x1 Type=Byte, ColorInterp=Blue
> >> 
> >>    Computed Min/Max=0.000,255.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 4 Block=35921x1 Type=Byte, ColorInterp=Alpha
> >> 
> >>    Computed Min/Max=0.000,255.000
> >> 
> >> the exact commands I used are:
> >> 
> >> gdal_translate  pr026029_5m.tif tmp.tif -co alpha=no
> > 
> > --> Did you remove tmp.tif.aux.xml as I mentionned before ?
> > 
> > Note: given the use of gdalwarp you make, you could also just use
> > gdal_translate -projwin instead (caution: the order of arguments is not
> > the same since -projwin expect upper_left_x upper_left_y lower_right_x
> > lower_right_y)
> > 
> >> then
> >> 
> >> gdalwarp -te 422861.999 225313.018 489606.999 308903.018 -tr 5 5 tmp.tif
> >> out.tif
> >> 
> >> The results of the out.tif is the problematic output as all the bands
> >> are zeros as in:
> >> 
> >> Driver: GTiff/GeoTIFF
> >> Files: out.tif
> >> Size is 13349, 16718
> >> Coordinate System is:
> >> PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",
> >> 
> >>    GEOGCS["NAD83(HARN)",
> >>    
> >>        DATUM["NAD83_High_Accuracy_Reference_Network",
> >>        
> >>            SPHEROID["GRS 1980",6378137,298.2572221010002,
> >>            
> >>                AUTHORITY["EPSG","7019"]],
> >>            
> >>            AUTHORITY["EPSG","6152"]],
> >>        
> >>        PRIMEM["Greenwich",0],
> >>        UNIT["degree",0.0174532925199433]],
> >>    
> >>    PROJECTION["Transverse_Mercator"],
> >>    PARAMETER["latitude_of_origin",0],
> >>    PARAMETER["central_meridian",-90],
> >>    PARAMETER["scale_factor",0.9996],
> >>    PARAMETER["false_easting",520000],
> >>    PARAMETER["false_northing",-4480000],
> >>    UNIT["metre",1,
> >>    
> >>        AUTHORITY["EPSG","9001"]]]
> >> 
> >> Origin = (422861.999000000010710,308903.017999999981839)
> >> Pixel Size = (5.000000000000000,-5.000000000000000)
> >> 
> >> Metadata:
> >>  AREA_OR_POINT=Area
> >> 
> >> Image Structure Metadata:
> >>  INTERLEAVE=PIXEL
> >> 
> >> Corner Coordinates:
> >> Upper Left  (  422861.999,  308903.018) ( 91d11'47.57"W, 43d14'48.02"N)
> >> Lower Left  (  422861.999,  225313.018) ( 91d10'55.54"W, 42d29'38.70"N)
> >> Upper Right (  489606.999,  308903.018) ( 90d22'27.90"W, 43d15' 8.35"N)
> >> Lower Right (  489606.999,  225313.018) ( 90d22'11.62"W, 42d29'58.50"N)
> >> Center      (  456234.499,  267108.018) ( 90d46'50.60"W, 42d52'26.06"N)
> >> Band 1 Block=13349x1 Type=Byte, ColorInterp=Red
> >> 
> >>    Computed Min/Max=0.000,0.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 2 Block=13349x1 Type=Byte, ColorInterp=Green
> >> 
> >>    Computed Min/Max=0.000,0.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 3 Block=13349x1 Type=Byte, ColorInterp=Blue
> >> 
> >>    Computed Min/Max=0.000,0.000
> >>  
> >>  Mask Flags: PER_DATASET ALPHA
> >> 
> >> Band 4 Block=13349x1 Type=Byte, ColorInterp=Alpha
> >> 
> >>    Computed Min/Max=0.000,0.000
> >> 
> >> Thank you so much.
> >> 
> >> Mutlu..
> >> 
> >> 
> >> 
> >> On Nov 16, 2015, at 3:21 AM, Even Rouault
> >> <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
> >> 
> >> Le samedi 14 novembre 2015 22:26:48, Mutlu Ozdogan a écrit :
> >> Dear Evan
> >> Thank you so much for the input. I actually tried exactly those steps
> >> and unfortunately I still get 0s in the output file. Thank you again
> >> 
> >> Could you post the result of "gdalinfo -mm your_input_file.tif" and the
> >> exact GDAL commands you use ?
> >> 
> >> Mutlu
> >> 
> >> Sent from my iPhone
> >> 
> >> On Nov 14, 2015, at 1:00 PM, Even Rouault
> >> <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
> >> 
> >> Le samedi 14 novembre 2015 19:49:02,
> >> ozdogan at wisc.edu<mailto:ozdogan at wisc.edu> a écrit : Dear All
> >> I have a 4-band air photo image in which the 4th band is the NIR band
> >> but it has also been designated as an alpha band. It is the geotiff
> >> format. For some reason whenever I reproject this file (using gdalwarp)
> >> or resize it (using gdal_translate) all four bands of the resulting
> >> files have zero values. It is as if the alpha band is being used to
> >> mask all band values. Any help reprojecting or windowing this large
> >> file without making while retaining all 4 band values would be much
> >> appreciated. Thank you
> >> 
> >> Mutlu,
> >> 
> >> The issue is probably indeed the NIR band being recognized as an alpha
> >> band. You can remove the alpha interpretation with :
> >> 
> >> gdal_translate in.tif tmp.tif -co alpha=no
> >> rm tmp.tif.aux.xml (or del tmp.tif.aux.xml on Windows)
> >> 
> >> The removal of tmp.tif.aux.xml is important otherwise the alpha
> >> interpretation would be kept in this XML file
> >> 
> >> And then you can gdalwarp this tmp.file with the arguments you need :
> >> 
> >> gdalwarp tmp.tif ...
> >> 
> >> Even
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com
> >> 
> >> 
> >> --
> >> Mutlu Ozdogan, Ph.D.
> >> Associate Professor
> >> Department of Forest and Wildlife Ecology &
> >> Nelson Institute for Environmental Studies
> >> t: (608) 262-0873
> >> e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jonathan-lists at lightpear.com  Tue Nov 17 08:55:15 2015
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Tue, 17 Nov 2015 08:55:15 -0800
Subject: [gdal-dev] Standard Parallel 1 - being changed but not displayed?
Message-ID: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>

Hi List,
 I have a Geotiff which includes this projection:
 
PROJ.4 : '+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs
'


OGC WKT :
PROJCS["Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]




If I load this raster into ArcGIS, it displays in the wrong place (a few thousand kilometres North).


I then run it through gdal_translate (GDAL 1.11.1), with no flags:
 * gdal_trainslate input.tif output.tif
 
For output.tif, GDALSRSInfo shows that the projection is identical, but now the file loads correctly in ArcGIS.
The same file works fine in QGIS both before and after the "translation".


Looking at the projection info in ArcGIS, it displays one difference:
Before (not working):
Standard_parallel_1 = 60


After (working):
Standard_parallel_1 = 0


But I don't see anything about those in either of the GDALSRSInfo outputs.


So my questions:
 - What is gdal_translate doing to the file to "fix" it?
 - If it is something to do with Standard Parallel 1 - why isn't this component of the projection exposed by GDAL?
 
Thoughts welcome.
Thanks,
Jonathan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151117/d5cc1844/attachment.html>

From even.rouault at spatialys.com  Tue Nov 17 09:19:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 18:19:11 +0100
Subject: [gdal-dev] Standard Parallel 1 - being changed but not
	displayed?
In-Reply-To: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>
References: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>
Message-ID: <201511171819.11299.even.rouault@spatialys.com>

Le mardi 17 novembre 2015 17:55:15, Jonathan Moules a écrit :
> Hi List,
>  I have a Geotiff which includes this projection:
> 
> PROJ.4 : '+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m
> +no_defs '
> 
> 
> OGC WKT :
> PROJCS["Mercator",
>     GEOGCS["WGS 84",
>         DATUM["WGS_1984",
>             SPHEROID["WGS 84",6378137,298.257223563,
>                 AUTHORITY["EPSG","7030"]],
>             AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4326"]],
>     PROJECTION["Mercator_1SP"],
>     PARAMETER["central_meridian",0],
>     PARAMETER["scale_factor",1],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> 
> 
> 
> 
> If I load this raster into ArcGIS, it displays in the wrong place (a few
> thousand kilometres North).
> 
> 
> I then run it through gdal_translate (GDAL 1.11.1), with no flags:
>  * gdal_trainslate input.tif output.tif
> 
> For output.tif, GDALSRSInfo shows that the projection is identical, but now
> the file loads correctly in ArcGIS. The same file works fine in QGIS both
> before and after the "translation".
> 
> 
> Looking at the projection info in ArcGIS, it displays one difference:
> Before (not working):
> Standard_parallel_1 = 60
> 
> 
> After (working):
> Standard_parallel_1 = 0
> 
> 
> But I don't see anything about those in either of the GDALSRSInfo outputs.
> 
> 
> So my questions:
>  - What is gdal_translate doing to the file to "fix" it?
>  - If it is something to do with Standard Parallel 1 - why isn't this
> component of the projection exposed by GDAL?

Yes, in Mercator_1SP, there's no Standard Parallel 1, this is for 
Mercator_2SP.

See
http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html
http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html

I guess your original geotiff file has some unusual formulation which is 
detected as Mercator_1SP by GDAL, and probably Mercator_2SP by ArCGIS.

You could try with the listgeo utility that comes with libgeotiff to display 
the geotiff keys.

> 
> Thoughts welcome.
> Thanks,
> Jonathan

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jonathan-lists at lightpear.com  Tue Nov 17 10:13:52 2015
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Tue, 17 Nov 2015 10:13:52 -0800
Subject: [gdal-dev] Standard Parallel 1 - being changed but not
 displayed?
In-Reply-To: <201511171819.11299.even.rouault@spatialys.com>
References: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>
 <201511171819.11299.even.rouault@spatialys.com>
Message-ID: <15116a72a35.e7be21cb138821.8556525504760475633@lightpear.com>

Hi Even,
Thanks for the reply.


I guess GDAL chose Mercator_1SP because that's the one that's explicitly defined in the projection text.


I've had a quick look at the two files using listgeo, and highlighted the different lines with **** prefix below (it seems GDAL removes 6 tags, and adds one).


The before:
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeProjected
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GTCitationGeoKey (Ascii,9): "Mercator"
      GeographicTypeGeoKey (Short,1): GCS_WGS_84
      GeogCitationGeoKey (Ascii,7): "WGS 84"
  ****GeogGeodeticDatumGeoKey (Short,1): Datum_WGS84
  ****GeogLinearUnitsGeoKey (Short,1): Linear_Meter 
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
  ****GeogEllipsoidGeoKey (Short,1): Ellipse_WGS_84
      GeogSemiMajorAxisGeoKey (Double,1): 6378137
  ****GeogSemiMinorAxisGeoKey (Double,1): 6356752.31424518
      GeogInvFlatteningGeoKey (Double,1): 298.257223563
      ProjectedCSTypeGeoKey (Short,1): User-Defined
  ****PCSCitationGeoKey (Ascii,9): "Mercator"
      ProjectionGeoKey (Short,1): User-Defined
      ProjCoordTransGeoKey (Short,1): CT_Mercator
      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
  ****ProjStdParallel1GeoKey (Double,1): 60
      ProjNatOriginLongGeoKey (Double,1): 0
      ProjNatOriginLatGeoKey (Double,1): 0
      ProjFalseEastingGeoKey (Double,1): 0
      ProjFalseNorthingGeoKey (Double,1): 0
      End_Of_Keys.
   
------------
The after:
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeProjected
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GTCitationGeoKey (Ascii,9): "Mercator"
      GeographicTypeGeoKey (Short,1): GCS_WGS_84
      GeogCitationGeoKey (Ascii,7): "WGS 84"
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
      GeogSemiMajorAxisGeoKey (Double,1): 6378137
      GeogInvFlatteningGeoKey (Double,1): 298.257223563
      ProjectedCSTypeGeoKey (Short,1): User-Defined
      ProjectionGeoKey (Short,1): User-Defined
      ProjCoordTransGeoKey (Short,1): CT_Mercator
      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
      ProjNatOriginLongGeoKey (Double,1): 0
      ProjNatOriginLatGeoKey (Double,1): 0
      ProjFalseEastingGeoKey (Double,1): 0
      ProjFalseNorthingGeoKey (Double,1): 0
  ****ProjScaleAtNatOriginGeoKey (Double,1): 1
      End_Of_Keys.
   End_Of_Geotiff.
   


I'm not clear on why the things that changed were changed, but I can see that GDAL removed the ProjStdParallel1GeoKey and value. Should not that have been displayed by GDALSRSInfo for the Before file, even if it was wrongly set for this given projection?


Thanks,
Jonathan


---- On Tue, 17 Nov 2015 09:18:49 -0800 Even Rouault&lt;even.rouault at spatialys.com&gt; wrote ---- 

Le mardi 17 novembre 2015 17:55:15, Jonathan Moules a écrit : 
&gt; Hi List, 
&gt; I have a Geotiff which includes this projection: 
&gt; 
&gt; PROJ.4 : '+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m 
&gt; +no_defs ' 
&gt; 
&gt; 
&gt; OGC WKT : 
&gt; PROJCS["Mercator", 
&gt; GEOGCS["WGS 84", 
&gt; DATUM["WGS_1984", 
&gt; SPHEROID["WGS 84",6378137,298.257223563, 
&gt; AUTHORITY["EPSG","7030"]], 
&gt; AUTHORITY["EPSG","6326"]], 
&gt; PRIMEM["Greenwich",0], 
&gt; UNIT["degree",0.0174532925199433], 
&gt; AUTHORITY["EPSG","4326"]], 
&gt; PROJECTION["Mercator_1SP"], 
&gt; PARAMETER["central_meridian",0], 
&gt; PARAMETER["scale_factor",1], 
&gt; PARAMETER["false_easting",0], 
&gt; PARAMETER["false_northing",0], 
&gt; UNIT["metre",1, 
&gt; AUTHORITY["EPSG","9001"]]] 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; If I load this raster into ArcGIS, it displays in the wrong place (a few 
&gt; thousand kilometres North). 
&gt; 
&gt; 
&gt; I then run it through gdal_translate (GDAL 1.11.1), with no flags: 
&gt; * gdal_trainslate input.tif output.tif 
&gt; 
&gt; For output.tif, GDALSRSInfo shows that the projection is identical, but now 
&gt; the file loads correctly in ArcGIS. The same file works fine in QGIS both 
&gt; before and after the "translation". 
&gt; 
&gt; 
&gt; Looking at the projection info in ArcGIS, it displays one difference: 
&gt; Before (not working): 
&gt; Standard_parallel_1 = 60 
&gt; 
&gt; 
&gt; After (working): 
&gt; Standard_parallel_1 = 0 
&gt; 
&gt; 
&gt; But I don't see anything about those in either of the GDALSRSInfo outputs. 
&gt; 
&gt; 
&gt; So my questions: 
&gt; - What is gdal_translate doing to the file to "fix" it? 
&gt; - If it is something to do with Standard Parallel 1 - why isn't this 
&gt; component of the projection exposed by GDAL? 
 
Yes, in Mercator_1SP, there's no Standard Parallel 1, this is for 
Mercator_2SP. 
 
See 
http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html 
http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html 
 
I guess your original geotiff file has some unusual formulation which is 
detected as Mercator_1SP by GDAL, and probably Mercator_2SP by ArCGIS. 
 
You could try with the listgeo utility that comes with libgeotiff to display 
the geotiff keys. 
 
&gt; 
&gt; Thoughts welcome. 
&gt; Thanks, 
&gt; Jonathan 
 
-- 
Spatialys - Geospatial professional services 
http://www.spatialys.com 





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151117/5c1e287f/attachment-0001.html>

From even.rouault at spatialys.com  Tue Nov 17 10:23:52 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 19:23:52 +0100
Subject: [gdal-dev] Fwd: Re:  Alpha band masking
Message-ID: <201511171923.52202.even.rouault@spatialys.com>


----------  Message transmis  ----------

Sujet : Re: [gdal-dev] Alpha band masking
Date : mardi 17 novembre 2015, 19:08:06
De : MUTLU OZDOGAN <ozdogan at wisc.edu>
À : Even Rouault <even.rouault at spatialys.com>

Dear Even,

It turns out that the problem was on my end!  I was clipping the input image 
to corner coordinates that was outside of the input image and hence the 0 
values.

Thank you so much for you help.

Mutlu..


On Nov 17, 2015, at 10:50 AM, Even Rouault 
<even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:

Le mardi 17 novembre 2015 10:19:59, Mutlu Ozdogan a écrit :
Yes I have removed the xml file sorry I forgot to include that

Try also adding "-co alpha=no -overwrite" to the gdalwarp command line,
although it shouldn't have any influence on the pixel values at that stage.


Sent from my iPhone

On Nov 17, 2015, at 3:04 AM, Even Rouault 
<even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
wrote:

Le mardi 17 novembre 2015 04:08:41, MUTLU OZDOGAN a écrit :
Dear Even,

The result of the gdalinfo -mm command is this:

Driver: GTiff/GeoTIFF
Files: pr026029_5m.tif

     pr026029_5m.tfw

Size is 35921, 41035
Coordinate System is:
PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",

  GEOGCS["NAD83(HARN)",

      DATUM["NAD83_High_Accuracy_Reference_Network",

          SPHEROID["GRS 1980",6378137,298.2572221010002,

              AUTHORITY["EPSG","7019"]],

          AUTHORITY["EPSG","6152"]],

      PRIMEM["Greenwich",0],
      UNIT["degree",0.0174532925199433]],

  PROJECTION["Transverse_Mercator"],
  PARAMETER["latitude_of_origin",0],
  PARAMETER["central_meridian",-90],
  PARAMETER["scale_factor",0.9996],
  PARAMETER["false_easting",520000],
  PARAMETER["false_northing",-4480000],
  UNIT["metre",1,

      AUTHORITY["EPSG","9001"]]]

Origin = (296789.742753763101064,562520.115095380693674)
Pixel Size = (5.000000000000000,-5.000000000000000)

Metadata:
AREA_OR_POINT=Area

Image Structure Metadata:
INTERLEAVE=PIXEL

Corner Coordinates:
Upper Left  (  296789.743,  562520.115) ( 92d51'25.45"W, 45d30' 1.70"N)
Lower Left  (  296789.743,  357345.115) ( 92d46' 5.00"W, 43d39'20.14"N)
Upper Right (  476394.743,  562520.115) ( 90d33'30.53"W, 45d32' 5.47"N)
Lower Right (  476394.743,  357345.115) ( 90d32'27.79"W, 43d41'16.23"N)
Center      (  386592.243,  459932.615) ( 91d40'51.66"W, 44d36' 1.34"N)
Band 1 Block=35921x1 Type=Byte, ColorInterp=Red

  Computed Min/Max=0.000,255.000

Mask Flags: PER_DATASET ALPHA

Band 2 Block=35921x1 Type=Byte, ColorInterp=Green

  Computed Min/Max=0.000,255.000

Mask Flags: PER_DATASET ALPHA

Band 3 Block=35921x1 Type=Byte, ColorInterp=Blue

  Computed Min/Max=0.000,255.000

Mask Flags: PER_DATASET ALPHA

Band 4 Block=35921x1 Type=Byte, ColorInterp=Alpha

  Computed Min/Max=0.000,255.000

the exact commands I used are:

gdal_translate  pr026029_5m.tif tmp.tif -co alpha=no

--> Did you remove tmp.tif.aux.xml as I mentionned before ?

Note: given the use of gdalwarp you make, you could also just use
gdal_translate -projwin instead (caution: the order of arguments is not
the same since -projwin expect upper_left_x upper_left_y lower_right_x
lower_right_y)

then

gdalwarp -te 422861.999 225313.018 489606.999 308903.018 -tr 5 5 tmp.tif
out.tif

The results of the out.tif is the problematic output as all the bands
are zeros as in:

Driver: GTiff/GeoTIFF
Files: out.tif
Size is 13349, 16718
Coordinate System is:
PROJCS["NAD83(HARN) / Wisconsin Transverse Mercator",

  GEOGCS["NAD83(HARN)",

      DATUM["NAD83_High_Accuracy_Reference_Network",

          SPHEROID["GRS 1980",6378137,298.2572221010002,

              AUTHORITY["EPSG","7019"]],

          AUTHORITY["EPSG","6152"]],

      PRIMEM["Greenwich",0],
      UNIT["degree",0.0174532925199433]],

  PROJECTION["Transverse_Mercator"],
  PARAMETER["latitude_of_origin",0],
  PARAMETER["central_meridian",-90],
  PARAMETER["scale_factor",0.9996],
  PARAMETER["false_easting",520000],
  PARAMETER["false_northing",-4480000],
  UNIT["metre",1,

      AUTHORITY["EPSG","9001"]]]

Origin = (422861.999000000010710,308903.017999999981839)
Pixel Size = (5.000000000000000,-5.000000000000000)

Metadata:
AREA_OR_POINT=Area

Image Structure Metadata:
INTERLEAVE=PIXEL

Corner Coordinates:
Upper Left  (  422861.999,  308903.018) ( 91d11'47.57"W, 43d14'48.02"N)
Lower Left  (  422861.999,  225313.018) ( 91d10'55.54"W, 42d29'38.70"N)
Upper Right (  489606.999,  308903.018) ( 90d22'27.90"W, 43d15' 8.35"N)
Lower Right (  489606.999,  225313.018) ( 90d22'11.62"W, 42d29'58.50"N)
Center      (  456234.499,  267108.018) ( 90d46'50.60"W, 42d52'26.06"N)
Band 1 Block=13349x1 Type=Byte, ColorInterp=Red

  Computed Min/Max=0.000,0.000

Mask Flags: PER_DATASET ALPHA

Band 2 Block=13349x1 Type=Byte, ColorInterp=Green

  Computed Min/Max=0.000,0.000

Mask Flags: PER_DATASET ALPHA

Band 3 Block=13349x1 Type=Byte, ColorInterp=Blue

  Computed Min/Max=0.000,0.000

Mask Flags: PER_DATASET ALPHA

Band 4 Block=13349x1 Type=Byte, ColorInterp=Alpha

  Computed Min/Max=0.000,0.000

Thank you so much.

Mutlu..



On Nov 16, 2015, at 3:21 AM, Even Rouault
<even.rouault at spatialys.com<mailto:even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>> 
wrote:

Le samedi 14 novembre 2015 22:26:48, Mutlu Ozdogan a écrit :
Dear Evan
Thank you so much for the input. I actually tried exactly those steps
and unfortunately I still get 0s in the output file. Thank you again

Could you post the result of "gdalinfo -mm your_input_file.tif" and the
exact GDAL commands you use ?

Mutlu

Sent from my iPhone

On Nov 14, 2015, at 1:00 PM, Even Rouault
<even.rouault at spatialys.com<mailto:even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>> 
wrote:

Le samedi 14 novembre 2015 19:49:02,
ozdogan at wisc.edu<mailto:ozdogan at wisc.edu><mailto:ozdogan at wisc.edu> a écrit : 
Dear All
I have a 4-band air photo image in which the 4th band is the NIR band
but it has also been designated as an alpha band. It is the geotiff
format. For some reason whenever I reproject this file (using gdalwarp)
or resize it (using gdal_translate) all four bands of the resulting
files have zero values. It is as if the alpha band is being used to
mask all band values. Any help reprojecting or windowing this large
file without making while retaining all 4 band values would be much
appreciated. Thank you

Mutlu,

The issue is probably indeed the NIR band being recognized as an alpha
band. You can remove the alpha interpretation with :

gdal_translate in.tif tmp.tif -co alpha=no
rm tmp.tif.aux.xml (or del tmp.tif.aux.xml on Windows)

The removal of tmp.tif.aux.xml is important otherwise the alpha
interpretation would be kept in this XML file

And then you can gdalwarp this tmp.file with the arguments you need :

gdalwarp tmp.tif ...

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com


--
Mutlu Ozdogan, Ph.D.
Associate Professor
Department of Forest and Wildlife Ecology &
Nelson Institute for Environmental Studies
t: (608) 262-0873
e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>

--
Spatialys - Geospatial professional services
http://www.spatialys.com


--
Mutlu Ozdogan, Ph.D.
Associate Professor
Department of Forest and Wildlife Ecology &
Nelson Institute for Environmental Studies
t: (608) 262-0873
e: ozdogan at wisc.edu<mailto:ozdogan at wisc.edu>





-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov 17 10:33:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 19:33:57 +0100
Subject: [gdal-dev] Standard Parallel 1 - being changed but not
	displayed?
In-Reply-To: <15116a72a35.e7be21cb138821.8556525504760475633@lightpear.com>
References: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>
 <201511171819.11299.even.rouault@spatialys.com>
 <15116a72a35.e7be21cb138821.8556525504760475633@lightpear.com>
Message-ID: <201511171933.57069.even.rouault@spatialys.com>

Le mardi 17 novembre 2015 19:13:52, Jonathan Moules a écrit :
> Hi Even,
> Thanks for the reply.
> 
> 
> I guess GDAL chose Mercator_1SP because that's the one that's explicitly
> defined in the projection text.

No, it is not explicitly defined, and GDAL ignores PCSCitationGeoKey to 
determine the projection method. It will use ProjCoordTransGeoKey = 
CT_Mercator for that, and in GDAL 1.11, it can only map it to Mercator_1SP

> 
> 
> I've had a quick look at the two files using listgeo, and highlighted the
> different lines with **** prefix below (it seems GDAL removes 6 tags, and
> adds one).
> 
> 
> The before:
>    Keyed_Information:
>       GTModelTypeGeoKey (Short,1): ModelTypeProjected
>       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>       GTCitationGeoKey (Ascii,9): "Mercator"
>       GeographicTypeGeoKey (Short,1): GCS_WGS_84
>       GeogCitationGeoKey (Ascii,7): "WGS 84"
>   ****GeogGeodeticDatumGeoKey (Short,1): Datum_WGS84
>   ****GeogLinearUnitsGeoKey (Short,1): Linear_Meter
>       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
>   ****GeogEllipsoidGeoKey (Short,1): Ellipse_WGS_84
>       GeogSemiMajorAxisGeoKey (Double,1): 6378137
>   ****GeogSemiMinorAxisGeoKey (Double,1): 6356752.31424518
>       GeogInvFlatteningGeoKey (Double,1): 298.257223563
>       ProjectedCSTypeGeoKey (Short,1): User-Defined
>   ****PCSCitationGeoKey (Ascii,9): "Mercator"
>       ProjectionGeoKey (Short,1): User-Defined
>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>   ****ProjStdParallel1GeoKey (Double,1): 60
>       ProjNatOriginLongGeoKey (Double,1): 0
>       ProjNatOriginLatGeoKey (Double,1): 0
>       ProjFalseEastingGeoKey (Double,1): 0
>       ProjFalseNorthingGeoKey (Double,1): 0
>       End_Of_Keys.
> 
> ------------
> The after:
>    Keyed_Information:
>       GTModelTypeGeoKey (Short,1): ModelTypeProjected
>       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
>       GTCitationGeoKey (Ascii,9): "Mercator"
>       GeographicTypeGeoKey (Short,1): GCS_WGS_84
>       GeogCitationGeoKey (Ascii,7): "WGS 84"
>       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
>       GeogSemiMajorAxisGeoKey (Double,1): 6378137
>       GeogInvFlatteningGeoKey (Double,1): 298.257223563
>       ProjectedCSTypeGeoKey (Short,1): User-Defined
>       ProjectionGeoKey (Short,1): User-Defined
>       ProjCoordTransGeoKey (Short,1): CT_Mercator
>       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>       ProjNatOriginLongGeoKey (Double,1): 0
>       ProjNatOriginLatGeoKey (Double,1): 0
>       ProjFalseEastingGeoKey (Double,1): 0
>       ProjFalseNorthingGeoKey (Double,1): 0
>   ****ProjScaleAtNatOriginGeoKey (Double,1): 1
>       End_Of_Keys.
>    End_Of_Geotiff.
> 
> 

Actually when trying that with GDAL 2.0, you would now get :

PROJCS["Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_2SP"],
    PARAMETER["standard_parallel_1",60],
    PARAMETER["central_meridian",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]

due to the changes done in https://trac.osgeo.org/gdal/ticket/5791 

The new logic to determine Mercator_1SP vs _2SP is best explainted by the code 
itself ;-)

{{{
            /* If a lat_ts was specified use 2SP, otherwise use 1SP */
            if (psDefn->ProjParmId[2] == ProjStdParallel1GeoKey)
            {
                if (psDefn->ProjParmId[4] == ProjScaleAtNatOriginGeoKey)
                    CPLError( CE_Warning, CPLE_AppDefined,
                              "Mercator projection should not define both 
StdParallel1 and ScaleAtNatOrigin.\n"
                              "Using StdParallel1 and ignoring 
ScaleAtNatOrigin.\n" );
                oSRS.SetMercator2SP( adfParm[2],
                                     adfParm[0], adfParm[1],
                                     adfParm[5], adfParm[6]);
            }
            else
                oSRS.SetMercator( adfParm[0], adfParm[1],
                                  adfParm[4],
                                  adfParm[5], adfParm[6] );
}}}

That new behaviour is more consistant with the geotiff keys (and should be the 
one you get with ArcGIS initialy), although it perhaps reveals a problem with 
the encoding of the geotiff file itself if you say that the Mercator_1SP 
interpretation with scale=1 leads to correct geopositioning.

> 
> I'm not clear on why the things that changed were changed, but I can see
> that GDAL removed the ProjStdParallel1GeoKey and value. Should not that
> have been displayed by GDALSRSInfo for the Before file, even if it was
> wrongly set for this given projection?

GDAL is all about abstraction. It interprets at its best the information from 
the geotiff keys to a well-known projection method, and thus can ignore 
silently some keys that it doesn't need.

> 
> 
> Thanks,
> Jonathan
> 
> 
> ---- On Tue, 17 Nov 2015 09:18:49 -0800 Even
> Rouault&lt;even.rouault at spatialys.com&gt; wrote ----
> 
> Le mardi 17 novembre 2015 17:55:15, Jonathan Moules a écrit :
> &gt; Hi List,
> &gt; I have a Geotiff which includes this projection:
> &gt;
> &gt; PROJ.4 : '+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m
> &gt; +no_defs '
> &gt;
> &gt;
> &gt; OGC WKT :
> &gt; PROJCS["Mercator",
> &gt; GEOGCS["WGS 84",
> &gt; DATUM["WGS_1984",
> &gt; SPHEROID["WGS 84",6378137,298.257223563,
> &gt; AUTHORITY["EPSG","7030"]],
> &gt; AUTHORITY["EPSG","6326"]],
> &gt; PRIMEM["Greenwich",0],
> &gt; UNIT["degree",0.0174532925199433],
> &gt; AUTHORITY["EPSG","4326"]],
> &gt; PROJECTION["Mercator_1SP"],
> &gt; PARAMETER["central_meridian",0],
> &gt; PARAMETER["scale_factor",1],
> &gt; PARAMETER["false_easting",0],
> &gt; PARAMETER["false_northing",0],
> &gt; UNIT["metre",1,
> &gt; AUTHORITY["EPSG","9001"]]]
> &gt;
> &gt;
> &gt;
> &gt;
> &gt; If I load this raster into ArcGIS, it displays in the wrong place (a
> few &gt; thousand kilometres North).
> &gt;
> &gt;
> &gt; I then run it through gdal_translate (GDAL 1.11.1), with no flags:
> &gt; * gdal_trainslate input.tif output.tif
> &gt;
> &gt; For output.tif, GDALSRSInfo shows that the projection is identical,
> but now &gt; the file loads correctly in ArcGIS. The same file works fine
> in QGIS both &gt; before and after the "translation".
> &gt;
> &gt;
> &gt; Looking at the projection info in ArcGIS, it displays one difference:
> &gt; Before (not working):
> &gt; Standard_parallel_1 = 60
> &gt;
> &gt;
> &gt; After (working):
> &gt; Standard_parallel_1 = 0
> &gt;
> &gt;
> &gt; But I don't see anything about those in either of the GDALSRSInfo
> outputs. &gt;
> &gt;
> &gt; So my questions:
> &gt; - What is gdal_translate doing to the file to "fix" it?
> &gt; - If it is something to do with Standard Parallel 1 - why isn't this
> &gt; component of the projection exposed by GDAL?
> 
> Yes, in Mercator_1SP, there's no Standard Parallel 1, this is for
> Mercator_2SP.
> 
> See
> http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html
> http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html
> 
> I guess your original geotiff file has some unusual formulation which is
> detected as Mercator_1SP by GDAL, and probably Mercator_2SP by ArCGIS.
> 
> You could try with the listgeo utility that comes with libgeotiff to
> display the geotiff keys.
> 
> &gt;
> &gt; Thoughts welcome.
> &gt; Thanks,
> &gt; Jonathan

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dvick at boundlessgeo.com  Tue Nov 17 14:36:29 2015
From: dvick at boundlessgeo.com (David Vick)
Date: Tue, 17 Nov 2015 16:36:29 -0600
Subject: [gdal-dev] OGR FileGDB fails to copy data
Message-ID: <CAA2n=r=hatf7h1zrN_bTVCqvj94mqUBR7BUohftiYPNMb5JyRw@mail.gmail.com>

Hi,

I'm currently using OSGeo4W with ESRI's 1.4 version of the File Geodatabase
API and trying to ingest a filegdb into postgresql 9.2.2 that is configured
with ArcSDE and is using st_geometry as the default type.  When I execute
an ogr2ogr -update -append on a feature class that contains either
mulitlinestring or multipolygon I get an error that the copy statement
failed.  The debug info is listed below:

>ogr2ogr -update -append -preserve_fid -fieldmap identity -f "PostgreSQL"
PG:"host=******* user=**** dbname=******* port=5432 password=*****"
C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb AeronauticSrf_AM
--config PGSQL_OGR_FID "objectid" --config PG_USE_COPY "YES" --config
PG_USE_BASE64 "YES" --config FGDB_BULK_LOAD "YES" --config
PG_LIST_ALL_TABLES "YES" --config OGR_TRUNCATE "YES" --debug ON -progress

FileGDB: Really opening C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
OGR: OGROpen(C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb/03B3D220)
succeeded as FileGDB.
PG: DBName="fgcmdev3wk"
PG: PostgreSQL version string : 'PostgreSQL 9.2.2 on
x86_64-unknown-linux-gnu, compiled by gcc (GCC) 4.4.6 20110731 (Red Hat
4.4.6-3), 64-bit'
PG: PostGIS version string : '2.0 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
OGR: OGROpen(PG:host=lnsvr0800.gcsd.harris.com user=fgcm dbname=fgcmdev3wk
port=5432 password=fgcm/054050E8) succeeded as PostgreSQL.
PG: Using column 'objectid' as FID for table 'aeronauticsrf_am'
PG: Field shape is of unknown format type st_geometry (type=st_geometry).
0...10...20...30...40...50...60...70...80...90...100 - done.
PG: PQputCopyEnd()
ERROR 1: COPY statement failed.
ERROR:  ESRI: invalid hexa character in hexa string [30000]:
CONTEXT:  COPY aeronauticsrf_am, line 1, column shape:
"{C8CDC53F-9478-4CB9-9CD3-7ADA9558FFC2}"

OGR2OGR: 118 features written in layer 'aeronauticsrf_am'
FileGDB: ref_count of C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb =
0 now
FileGDB: Really closing C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
now

Does anyone have any other suggestions to try?  Our current process of
loading data is taking in excess of 12 hours and getting ogr2ogr to work
will improve this time to just minutes.

Thank you,

David Vick

Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
dvick at boundlessgeo.com
mobile: 1-636-698-3174
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151117/bb7912e4/attachment.html>

From even.rouault at spatialys.com  Tue Nov 17 14:55:18 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2015 23:55:18 +0100
Subject: [gdal-dev] OGR FileGDB fails to copy data
In-Reply-To: <CAA2n=r=hatf7h1zrN_bTVCqvj94mqUBR7BUohftiYPNMb5JyRw@mail.gmail.com>
References: <CAA2n=r=hatf7h1zrN_bTVCqvj94mqUBR7BUohftiYPNMb5JyRw@mail.gmail.com>
Message-ID: <201511172355.18284.even.rouault@spatialys.com>

Le mardi 17 novembre 2015 23:36:29, David Vick a écrit :
> Hi,
> 
> I'm currently using OSGeo4W with ESRI's 1.4 version of the File Geodatabase
> API and trying to ingest a filegdb into postgresql 9.2.2 that is configured
> with ArcSDE and is using st_geometry as the default type.  When I execute
> an ogr2ogr -update -append on a feature class that contains either
> mulitlinestring or multipolygon I get an error that the copy statement
> 
> failed.  The debug info is listed below:
> >ogr2ogr -update -append -preserve_fid -fieldmap identity -f "PostgreSQL"
> 
> PG:"host=******* user=**** dbname=******* port=5432 password=*****"
> C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb AeronauticSrf_AM
> --config PGSQL_OGR_FID "objectid" --config PG_USE_COPY "YES" --config
> PG_USE_BASE64 "YES" --config FGDB_BULK_LOAD "YES" --config
> PG_LIST_ALL_TABLES "YES" --config OGR_TRUNCATE "YES" --debug ON -progress
> 
> FileGDB: Really opening C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
> OGR: OGROpen(C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb/03B3D220)
> succeeded as FileGDB.
> PG: DBName="fgcmdev3wk"
> PG: PostgreSQL version string : 'PostgreSQL 9.2.2 on
> x86_64-unknown-linux-gnu, compiled by gcc (GCC) 4.4.6 20110731 (Red Hat
> 4.4.6-3), 64-bit'
> PG: PostGIS version string : '2.0 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
> OGR: OGROpen(PG:host=lnsvr0800.gcsd.harris.com user=fgcm dbname=fgcmdev3wk
> port=5432 password=fgcm/054050E8) succeeded as PostgreSQL.
> PG: Using column 'objectid' as FID for table 'aeronauticsrf_am'
> PG: Field shape is of unknown format type st_geometry (type=st_geometry).
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> PG: PQputCopyEnd()
> ERROR 1: COPY statement failed.
> ERROR:  ESRI: invalid hexa character in hexa string [30000]:
> CONTEXT:  COPY aeronauticsrf_am, line 1, column shape:
> "{C8CDC53F-9478-4CB9-9CD3-7ADA9558FFC2}"
> 
> OGR2OGR: 118 features written in layer 'aeronauticsrf_am'
> FileGDB: ref_count of C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb =
> 0 now
> FileGDB: Really closing C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
> now
> 
> Does anyone have any other suggestions to try?  Our current process of
> loading data is taking in excess of 12 hours and getting ogr2ogr to work
> will improve this time to just minutes.

David,

Difficult to know what happens with just that.
Which GDAL version ?
You could try without PG_USE_COPY=YES to check if it is an issue with the copy 
mode.
And -skipfailures to identify if there's a particular feature that cause 
problem or if it is more general.
Perhaps a field mismatch with "-fieldmap identity" ? This option only works if 
the column names in source and target datasets are listed in same order (check 
with ogrinfo)
Did you try creating a new target layer instead of -update + --config 
OGR_TRUNCATE "YES"  ?

I'm not sure when the error "ERROR:  ESRI: invalid hexa character in hexa 
string [30000]:" comes from. Is there a 'ESRI' column ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Ori.Bar at elbitsystems.com  Tue Nov 17 23:32:06 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Wed, 18 Nov 2015 07:32:06 +0000
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
Message-ID: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>

Hi,
I noticed something that for me looks weird and I would like to know maybe I am doing something wrong.
If not, how should I overcome this behavior.

I set 4 GCPs as follows:

var gcps = new[]
{
new GCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
new GCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
new GCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height - 0.5, null, "3"),
new GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
};

And when I am doing as follows:

var geotransform = new double[6];
Gdal.GCPsToGeoTransform(gcps, geotransform, 0)

Or (after using dataSet.SetGCPs(gcps, projection) :

var geotransform = new double[6];
dataSet.GetGeoTransform(geotransform);

So the values returned, are wrong.
For example, if the LeftUp.X was 35.01050 so the value of geotransform[0], which supposed to be the same value, can be 35.0082.
The same with all the geotransform values.
If I am getting from the dataset and setting again, every time it is changing more and more.
Is there any connection to the use of the "0.5"?

Thanks.


[cid:image001.png at 01D121E3.FD25A2D0]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business 
sensitive information.  Unauthorized interception of this e-mail may constitute 
a violation of law. If you are not the intended recipient, you are hereby 
notified that any review, dissemination, distribution or duplication of this 
communication is strictly prohibited. You are also asked to contact the sender 
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/986f316a/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4160 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/986f316a/attachment-0001.png>

From ari.jolma at gmail.com  Wed Nov 18 01:34:34 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 18 Nov 2015 11:34:34 +0200
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <564C462A.7070605@gmail.com>

Bar,

I think you are setting the GCPs up wrongly if you want them to be at 
the corners.

GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4") does 
not have 0 before Height-0.5.

GCPsToGeoTransform checks the special case of GCPs in rectangular shape 
and in top-left, top-right, bottom-right, bottom-left order and returns 
the exact transform the dataset has.

I'm not sure if it makes sense to have real values for the pixel 
coordinates although they are real values.

Best,

Ari

On 18.11.2015 09:32, Bar Ori wrote:
>
> Hi,
>
> I noticed something that for me looks weird and I would like to know 
> maybe I am doing something wrong.
>
> If not, how should I overcome this behavior.
>
> I set 4 GCPs as follows:
>
> vargcps = new[]
>
> {
>
> newGCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
>
> newGCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
>
> newGCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height - 
> 0.5, null, "3"),
>
> newGCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
>
> };
>
> And when I am doing as follows:
>
> vargeotransform = new double[6];
>
> Gdal.GCPsToGeoTransform(gcps, geotransform, 0)
>
> Or (after using dataSet.SetGCPs(gcps, projection) :
>
> vargeotransform = new double[6];
>
> dataSet.GetGeoTransform(geotransform);
>
> So the values returned, are wrong.
>
> For example, if the LeftUp.X was 35.01050 so the value of 
> geotransform[0], which supposed to be the same value, can be 35.0082.
>
> The same with all the geotransform values.
>
> If I am getting from the dataset and setting again, every time it is 
> changing more and more.
>
> Is there any connection to the use of the “0.5”?
>
> Thanks.
>
> **
>
> ****
>
> 	
>
> *Ori Bar |***Software Developer
>
> Applications Development
>
> Elbit Systems Land and C4I
>
> *T *+972-9-8898*900 **|****M***+972-504-734296**
>
> **
>
> **
> *The information in this e-mail transmission contains proprietary and 
> business
> sensitive information.  Unauthorized interception of this e-mail may 
> constitute
> a violation of law. If you are not the intended recipient, you are hereby
> notified that any review, dissemination, distribution or duplication 
> of this
> communication is strictly prohibited. You are also asked to contact 
> the sender
> by reply email and immediately destroy all copies of the original message.
> *
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/752505a4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4160 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/752505a4/attachment.png>

From Ori.Bar at elbitsystems.com  Wed Nov 18 01:59:56 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Wed, 18 Nov 2015 09:59:56 +0000
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
In-Reply-To: <564C462A.7070605@gmail.com>
References: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
 <564C462A.7070605@gmail.com>
Message-ID: <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>

Thanks Ari for your reply.

In my situation, sometimes I am working with rectangles and sometimes not. Depends the source of information.
I thought to always use the GCPs as follows:
In case my shape has rectangular form, so the dataSet.GetGCPCount() will return me “0” and I will use the dataSet.GetGeoTransform(), otherwise, will use the dataSet.GetGCPs().
The issue is that for setting the GCPs, I must put the coordinate in the middle of pixel (that is why I  subtract “0.5”). If I wouldn’t, so yes, the geotransform values would be correct.
Is it a bad practice? Should I figure out the shape from start and to take two different steps?

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Ari Jolma
Sent: 18 November 2015 11:35
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

Bar,

I think you are setting the GCPs up wrongly if you want them to be at the corners.

GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4") does not have 0 before Height-0.5.

GCPsToGeoTransform checks the special case of GCPs in rectangular shape and in top-left, top-right, bottom-right, bottom-left order and returns the exact transform the dataset has.

I'm not sure if it makes sense to have real values for the pixel coordinates although they are real values.

Best,

Ari
On 18.11.2015 09:32, Bar Ori wrote:
Hi,
I noticed something that for me looks weird and I would like to know maybe I am doing something wrong.
If not, how should I overcome this behavior.

I set 4 GCPs as follows:

var gcps = new[]
{
new GCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
new GCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
new GCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height - 0.5, null, "3"),
new GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
};

And when I am doing as follows:

var geotransform = new double[6];
Gdal.GCPsToGeoTransform(gcps, geotransform, 0)

Or (after using dataSet.SetGCPs(gcps, projection) :

var geotransform = new double[6];
dataSet.GetGeoTransform(geotransform);

So the values returned, are wrong.
For example, if the LeftUp.X was 35.01050 so the value of geotransform[0], which supposed to be the same value, can be 35.0082.
The same with all the geotransform values.
If I am getting from the dataset and setting again, every time it is changing more and more.
Is there any connection to the use of the “0.5”?

Thanks.


[cid:image001.png at 01D121F8.9DBE8590]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business
sensitive information.  Unauthorized interception of this e-mail may constitute
a violation of law. If you are not the intended recipient, you are hereby
notified that any review, dissemination, distribution or duplication of this
communication is strictly prohibited. You are also asked to contact the sender
by reply email and immediately destroy all copies of the original message.




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

http://lists.osgeo.org/mailman/listinfo/gdal-dev


The information in this e-mail transmission contains proprietary and business 
sensitive information.  Unauthorized interception of this e-mail may constitute 
a violation of law. If you are not the intended recipient, you are hereby 
notified that any review, dissemination, distribution or duplication of this 
communication is strictly prohibited. You are also asked to contact the sender 
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/724de524/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4160 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/724de524/attachment-0001.png>

From ari.jolma at gmail.com  Wed Nov 18 02:13:15 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 18 Nov 2015 12:13:15 +0200
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
 <564C462A.7070605@gmail.com>
 <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <564C4F3B.3040109@gmail.com>



On 18.11.2015 11:59, Bar Ori wrote:
>
> Thanks Ari for your reply.
>
> In my situation, sometimes I am working with rectangles and sometimes 
> not. Depends the source of information.
>
> I thought to always use the GCPs as follows:
>
> In case my shape has rectangular form, so the dataSet.GetGCPCount() 
> will return me “0” and I will use the dataSet.GetGeoTransform(), 
> otherwise, will use the dataSet.GetGCPs().
>
> The issue is that for setting the GCPs, I must put the coordinate in 
> the middle of pixel (that is why I  subtract “0.5”). If I wouldn’t, so 
> yes, the geotransform values would be correct.
>
> Is it a bad practice? Should I figure out the shape from start and to 
> take two different steps?
>

I don't know the best answer to that. I'm just assuming if you do it 
with some GUI tool for example it will report you pixel coordinates in 
integer values.

Ari

> *From:*gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] *On Behalf 
> Of *Ari Jolma
> *Sent:* 18 November 2015 11:35
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] GCPsToGeoTransform returns wrong values
>
> Bar,
>
> I think you are setting the GCPs up wrongly if you want them to be at 
> the corners.
>
> GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4") does 
> not have 0 before Height-0.5.
>
> GCPsToGeoTransform checks the special case of GCPs in rectangular 
> shape and in top-left, top-right, bottom-right, bottom-left order and 
> returns the exact transform the dataset has.
>
> I'm not sure if it makes sense to have real values for the pixel 
> coordinates although they are real values.
>
> Best,
>
> Ari
>
> On 18.11.2015 09:32, Bar Ori wrote:
>
>     Hi,
>
>     I noticed something that for me looks weird and I would like to
>     know maybe I am doing something wrong.
>
>     If not, how should I overcome this behavior.
>
>     I set 4 GCPs as follows:
>
>     vargcps = new[]
>
>     {
>
>     newGCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
>
>     newGCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
>
>     newGCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height
>     - 0.5, null, "3"),
>
>     newGCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
>
>     };
>
>     And when I am doing as follows:
>
>     vargeotransform = newdouble[6];
>
>     Gdal.GCPsToGeoTransform(gcps, geotransform, 0)
>
>     Or (after using dataSet.SetGCPs(gcps, projection) :
>
>     vargeotransform = newdouble[6];
>
>     dataSet.GetGeoTransform(geotransform);
>
>     So the values returned, are wrong.
>
>     For example, if the LeftUp.X was 35.01050 so the value of
>     geotransform[0], which supposed to be the same value, can be 35.0082.
>
>     The same with all the geotransform values.
>
>     If I am getting from the dataset and setting again, every time it
>     is changing more and more.
>
>     Is there any connection to the use of the “0.5”?
>
>     Thanks.
>
>     **
>
>     **
>
>     	
>
>     *Ori Bar |***Software Developer
>
>     Applications Development
>
>     Elbit Systems Land and C4I
>
>     *T *+972-9-8898*900 **|****M***+972-504-734296
>
>     **
>
>     *The information in this e-mail transmission contains proprietary
>     and business **
>     *sensitive information.  Unauthorized interception of this e-mail
>     may constitute *
>     *a violation of law. If you are not the intended recipient, you
>     are hereby *
>     *notified that any review, dissemination, distribution or
>     duplication of this *
>     *communication is strictly prohibited. You are also asked to
>     contact the sender *
>     *by reply email and immediately destroy all copies of the original
>     message.**
>
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> **
> *The information in this e-mail transmission contains proprietary and 
> business
> sensitive information.  Unauthorized interception of this e-mail may 
> constitute
> a violation of law. If you are not the intended recipient, you are hereby
> notified that any review, dissemination, distribution or duplication 
> of this
> communication is strictly prohibited. You are also asked to contact 
> the sender
> by reply email and immediately destroy all copies of the original message.
> *

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/94f1a5f1/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4160 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/94f1a5f1/attachment-0001.png>

From Ori.Bar at elbitsystems.com  Wed Nov 18 03:18:10 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Wed, 18 Nov 2015 11:18:10 +0000
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
 <564C462A.7070605@gmail.com>
 <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <538E9F517DECA94A86A940F00577EACDF836C99D@MXHFA01.esl.corp.elbit.co.il>

I found in did that the GDALGCPsToGeoTransform using the pixels values for calculation:

At gdal_misc.cpp :
padfGeoTransform[1] = (pasGCPs[1].dfGCPX - pasGCPs[0].dfGCPX) / (pasGCPs[1].dfGCPPixel - pasGCPs[0].dfGCPPixel);
padfGeoTransform[0] = pasGCPs[0].dfGCPX - pasGCPs[0].dfGCPPixel * padfGeoTransform[1];

in this case, the question is what is the best practice for the problem I published (sometimes rectangle, sometimes not).

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Bar Ori
Sent: 18 November 2015 12:00
To: Ari Jolma
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

Thanks Ari for your reply.

In my situation, sometimes I am working with rectangles and sometimes not. Depends the source of information.
I thought to always use the GCPs as follows:
In case my shape has rectangular form, so the dataSet.GetGCPCount() will return me “0” and I will use the dataSet.GetGeoTransform(), otherwise, will use the dataSet.GetGCPs().
The issue is that for setting the GCPs, I must put the coordinate in the middle of pixel (that is why I  subtract “0.5”). If I wouldn’t, so yes, the geotransform values would be correct.
Is it a bad practice? Should I figure out the shape from start and to take two different steps?

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org]<mailto:[mailto:gdal-dev-bounces at lists.osgeo.org]> On Behalf Of Ari Jolma
Sent: 18 November 2015 11:35
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

Bar,

I think you are setting the GCPs up wrongly if you want them to be at the corners.

GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4") does not have 0 before Height-0.5.

GCPsToGeoTransform checks the special case of GCPs in rectangular shape and in top-left, top-right, bottom-right, bottom-left order and returns the exact transform the dataset has.

I'm not sure if it makes sense to have real values for the pixel coordinates although they are real values.

Best,

Ari
On 18.11.2015 09:32, Bar Ori wrote:
Hi,
I noticed something that for me looks weird and I would like to know maybe I am doing something wrong.
If not, how should I overcome this behavior.

I set 4 GCPs as follows:

var gcps = new[]
{
new GCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
new GCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
new GCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height - 0.5, null, "3"),
new GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
};

And when I am doing as follows:

var geotransform = new double[6];
Gdal.GCPsToGeoTransform(gcps, geotransform, 0)

Or (after using dataSet.SetGCPs(gcps, projection) :

var geotransform = new double[6];
dataSet.GetGeoTransform(geotransform);

So the values returned, are wrong.
For example, if the LeftUp.X was 35.01050 so the value of geotransform[0], which supposed to be the same value, can be 35.0082.
The same with all the geotransform values.
If I am getting from the dataset and setting again, every time it is changing more and more.
Is there any connection to the use of the “0.5”?

Thanks.


[cid:image001.png at 01D12203.8BC38D30]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business
sensitive information.  Unauthorized interception of this e-mail may constitute
a violation of law. If you are not the intended recipient, you are hereby
notified that any review, dissemination, distribution or duplication of this
communication is strictly prohibited. You are also asked to contact the sender
by reply email and immediately destroy all copies of the original message.



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

http://lists.osgeo.org/mailman/listinfo/gdal-dev


The information in this e-mail transmission contains proprietary and business
sensitive information.  Unauthorized interception of this e-mail may constitute
a violation of law. If you are not the intended recipient, you are hereby
notified that any review, dissemination, distribution or duplication of this
communication is strictly prohibited. You are also asked to contact the sender
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/914e47e4/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4160 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/914e47e4/attachment-0001.png>

From jonathan-lists at lightpear.com  Wed Nov 18 04:53:04 2015
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Wed, 18 Nov 2015 04:53:04 -0800
Subject: [gdal-dev] Standard Parallel 1 - being changed but not
 displayed?
In-Reply-To: <201511171933.57069.even.rouault@spatialys.com>
References: <151165f2f9b.108371747109661.7306602529032983328@lightpear.com>
 <201511171819.11299.even.rouault@spatialys.com>
 <15116a72a35.e7be21cb138821.8556525504760475633@lightpear.com>
 <201511171933.57069.even.rouault@spatialys.com>
Message-ID: <1511aa7d05b.e470182a386318.6969954067102750791@lightpear.com>

Hi Even,Ok, that clears things up a little. I guess the real question I have at this point is - which is correct in this circumstance?


The original GeoTIFF?
ArcGIS?
GDAL's conversion?


None of the above? I get the feeling it's all a bit subjective.


>From your comments, I'm surprised this doesn't happen more often with various packages\files. I thought projections were nice and reasonably well defined things.


Thanks again,
Jonathan



---- On Tue, 17 Nov 2015 10:33:37 -0800 Even Rouault&lt;even.rouault at spatialys.com&gt; wrote ---- 

Le mardi 17 novembre 2015 19:13:52, Jonathan Moules a écrit : 
&gt; Hi Even, 
&gt; Thanks for the reply. 
&gt; 
&gt; 
&gt; I guess GDAL chose Mercator_1SP because that's the one that's explicitly 
&gt; defined in the projection text. 
 
No, it is not explicitly defined, and GDAL ignores PCSCitationGeoKey to 
determine the projection method. It will use ProjCoordTransGeoKey = 
CT_Mercator for that, and in GDAL 1.11, it can only map it to Mercator_1SP 
 
&gt; 
&gt; 
&gt; I've had a quick look at the two files using listgeo, and highlighted the 
&gt; different lines with **** prefix below (it seems GDAL removes 6 tags, and 
&gt; adds one). 
&gt; 
&gt; 
&gt; The before: 
&gt; Keyed_Information: 
&gt; GTModelTypeGeoKey (Short,1): ModelTypeProjected 
&gt; GTRasterTypeGeoKey (Short,1): RasterPixelIsArea 
&gt; GTCitationGeoKey (Ascii,9): "Mercator" 
&gt; GeographicTypeGeoKey (Short,1): GCS_WGS_84 
&gt; GeogCitationGeoKey (Ascii,7): "WGS 84" 
&gt; ****GeogGeodeticDatumGeoKey (Short,1): Datum_WGS84 
&gt; ****GeogLinearUnitsGeoKey (Short,1): Linear_Meter 
&gt; GeogAngularUnitsGeoKey (Short,1): Angular_Degree 
&gt; ****GeogEllipsoidGeoKey (Short,1): Ellipse_WGS_84 
&gt; GeogSemiMajorAxisGeoKey (Double,1): 6378137 
&gt; ****GeogSemiMinorAxisGeoKey (Double,1): 6356752.31424518 
&gt; GeogInvFlatteningGeoKey (Double,1): 298.257223563 
&gt; ProjectedCSTypeGeoKey (Short,1): User-Defined 
&gt; ****PCSCitationGeoKey (Ascii,9): "Mercator" 
&gt; ProjectionGeoKey (Short,1): User-Defined 
&gt; ProjCoordTransGeoKey (Short,1): CT_Mercator 
&gt; ProjLinearUnitsGeoKey (Short,1): Linear_Meter 
&gt; ****ProjStdParallel1GeoKey (Double,1): 60 
&gt; ProjNatOriginLongGeoKey (Double,1): 0 
&gt; ProjNatOriginLatGeoKey (Double,1): 0 
&gt; ProjFalseEastingGeoKey (Double,1): 0 
&gt; ProjFalseNorthingGeoKey (Double,1): 0 
&gt; End_Of_Keys. 
&gt; 
&gt; ------------ 
&gt; The after: 
&gt; Keyed_Information: 
&gt; GTModelTypeGeoKey (Short,1): ModelTypeProjected 
&gt; GTRasterTypeGeoKey (Short,1): RasterPixelIsArea 
&gt; GTCitationGeoKey (Ascii,9): "Mercator" 
&gt; GeographicTypeGeoKey (Short,1): GCS_WGS_84 
&gt; GeogCitationGeoKey (Ascii,7): "WGS 84" 
&gt; GeogAngularUnitsGeoKey (Short,1): Angular_Degree 
&gt; GeogSemiMajorAxisGeoKey (Double,1): 6378137 
&gt; GeogInvFlatteningGeoKey (Double,1): 298.257223563 
&gt; ProjectedCSTypeGeoKey (Short,1): User-Defined 
&gt; ProjectionGeoKey (Short,1): User-Defined 
&gt; ProjCoordTransGeoKey (Short,1): CT_Mercator 
&gt; ProjLinearUnitsGeoKey (Short,1): Linear_Meter 
&gt; ProjNatOriginLongGeoKey (Double,1): 0 
&gt; ProjNatOriginLatGeoKey (Double,1): 0 
&gt; ProjFalseEastingGeoKey (Double,1): 0 
&gt; ProjFalseNorthingGeoKey (Double,1): 0 
&gt; ****ProjScaleAtNatOriginGeoKey (Double,1): 1 
&gt; End_Of_Keys. 
&gt; End_Of_Geotiff. 
&gt; 
&gt; 
 
Actually when trying that with GDAL 2.0, you would now get : 
 
PROJCS["Mercator", 
 GEOGCS["WGS 84", 
 DATUM["WGS_1984", 
 SPHEROID["WGS 84",6378137,298.257223563, 
 AUTHORITY["EPSG","7030"]], 
 AUTHORITY["EPSG","6326"]], 
 PRIMEM["Greenwich",0], 
 UNIT["degree",0.0174532925199433], 
 AUTHORITY["EPSG","4326"]], 
 PROJECTION["Mercator_2SP"], 
 PARAMETER["standard_parallel_1",60], 
 PARAMETER["central_meridian",0], 
 PARAMETER["false_easting",0], 
 PARAMETER["false_northing",0], 
 UNIT["metre",1, 
 AUTHORITY["EPSG","9001"]]] 
 
due to the changes done in https://trac.osgeo.org/gdal/ticket/5791 
 
The new logic to determine Mercator_1SP vs _2SP is best explainted by the code 
itself ;-) 
 
{{{ 
 /* If a lat_ts was specified use 2SP, otherwise use 1SP */ 
 if (psDefn-&gt;ProjParmId[2] == ProjStdParallel1GeoKey) 
 { 
 if (psDefn-&gt;ProjParmId[4] == ProjScaleAtNatOriginGeoKey) 
 CPLError( CE_Warning, CPLE_AppDefined, 
 "Mercator projection should not define both 
StdParallel1 and ScaleAtNatOrigin.\n" 
 "Using StdParallel1 and ignoring 
ScaleAtNatOrigin.\n" ); 
 oSRS.SetMercator2SP( adfParm[2], 
 adfParm[0], adfParm[1], 
 adfParm[5], adfParm[6]); 
 } 
 else 
 oSRS.SetMercator( adfParm[0], adfParm[1], 
 adfParm[4], 
 adfParm[5], adfParm[6] ); 
}}} 
 
That new behaviour is more consistant with the geotiff keys (and should be the 
one you get with ArcGIS initialy), although it perhaps reveals a problem with 
the encoding of the geotiff file itself if you say that the Mercator_1SP 
interpretation with scale=1 leads to correct geopositioning. 
 
&gt; 
&gt; I'm not clear on why the things that changed were changed, but I can see 
&gt; that GDAL removed the ProjStdParallel1GeoKey and value. Should not that 
&gt; have been displayed by GDALSRSInfo for the Before file, even if it was 
&gt; wrongly set for this given projection? 
 
GDAL is all about abstraction. It interprets at its best the information from 
the geotiff keys to a well-known projection method, and thus can ignore 
silently some keys that it doesn't need. 
 
&gt; 
&gt; 
&gt; Thanks, 
&gt; Jonathan 
&gt; 
&gt; 
&gt; ---- On Tue, 17 Nov 2015 09:18:49 -0800 Even 
&gt; Rouault&amp;lt;even.rouault at spatialys.com&amp;gt; wrote ---- 
&gt; 
&gt; Le mardi 17 novembre 2015 17:55:15, Jonathan Moules a écrit : 
&gt; &amp;gt; Hi List, 
&gt; &amp;gt; I have a Geotiff which includes this projection: 
&gt; &amp;gt; 
&gt; &amp;gt; PROJ.4 : '+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m 
&gt; &amp;gt; +no_defs ' 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; OGC WKT : 
&gt; &amp;gt; PROJCS["Mercator", 
&gt; &amp;gt; GEOGCS["WGS 84", 
&gt; &amp;gt; DATUM["WGS_1984", 
&gt; &amp;gt; SPHEROID["WGS 84",6378137,298.257223563, 
&gt; &amp;gt; AUTHORITY["EPSG","7030"]], 
&gt; &amp;gt; AUTHORITY["EPSG","6326"]], 
&gt; &amp;gt; PRIMEM["Greenwich",0], 
&gt; &amp;gt; UNIT["degree",0.0174532925199433], 
&gt; &amp;gt; AUTHORITY["EPSG","4326"]], 
&gt; &amp;gt; PROJECTION["Mercator_1SP"], 
&gt; &amp;gt; PARAMETER["central_meridian",0], 
&gt; &amp;gt; PARAMETER["scale_factor",1], 
&gt; &amp;gt; PARAMETER["false_easting",0], 
&gt; &amp;gt; PARAMETER["false_northing",0], 
&gt; &amp;gt; UNIT["metre",1, 
&gt; &amp;gt; AUTHORITY["EPSG","9001"]]] 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; If I load this raster into ArcGIS, it displays in the wrong place (a 
&gt; few &amp;gt; thousand kilometres North). 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; I then run it through gdal_translate (GDAL 1.11.1), with no flags: 
&gt; &amp;gt; * gdal_trainslate input.tif output.tif 
&gt; &amp;gt; 
&gt; &amp;gt; For output.tif, GDALSRSInfo shows that the projection is identical, 
&gt; but now &amp;gt; the file loads correctly in ArcGIS. The same file works fine 
&gt; in QGIS both &amp;gt; before and after the "translation". 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; Looking at the projection info in ArcGIS, it displays one difference: 
&gt; &amp;gt; Before (not working): 
&gt; &amp;gt; Standard_parallel_1 = 60 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; After (working): 
&gt; &amp;gt; Standard_parallel_1 = 0 
&gt; &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; But I don't see anything about those in either of the GDALSRSInfo 
&gt; outputs. &amp;gt; 
&gt; &amp;gt; 
&gt; &amp;gt; So my questions: 
&gt; &amp;gt; - What is gdal_translate doing to the file to "fix" it? 
&gt; &amp;gt; - If it is something to do with Standard Parallel 1 - why isn't this 
&gt; &amp;gt; component of the projection exposed by GDAL? 
&gt; 
&gt; Yes, in Mercator_1SP, there's no Standard Parallel 1, this is for 
&gt; Mercator_2SP. 
&gt; 
&gt; See 
&gt; http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html 
&gt; http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html 
&gt; 
&gt; I guess your original geotiff file has some unusual formulation which is 
&gt; detected as Mercator_1SP by GDAL, and probably Mercator_2SP by ArCGIS. 
&gt; 
&gt; You could try with the listgeo utility that comes with libgeotiff to 
&gt; display the geotiff keys. 
&gt; 
&gt; &amp;gt; 
&gt; &amp;gt; Thoughts welcome. 
&gt; &amp;gt; Thanks, 
&gt; &amp;gt; Jonathan 
 
-- 
Spatialys - Geospatial professional services 
http://www.spatialys.com 





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/6a88de1f/attachment.html>

From gane.prog at gmail.com  Wed Nov 18 10:42:30 2015
From: gane.prog at gmail.com (Gane R)
Date: Thu, 19 Nov 2015 00:12:30 +0530
Subject: [gdal-dev] GeoPDF offsets from actual location after gdalwarp
Message-ID: <CALMrLdDwVBm_r0FNyCc=k+hymLdVNGeWheNQceUxDUgSsVF+Pw@mail.gmail.com>

Here is link to a GeoPDF (
https://drive.google.com/file/d/0B4shTM1bPS5TMmk2OWxuTGJpY1k/view?usp=sharing)
this has a mile offset from the current location,
on GDAL gdal-2.0.1 when gdalwarp warps the PDF (poppler driver) to GeoTIF

Here is gdalinfo for the file

Driver: PDF/Geospatial PDF
Files: AssembledMaps.pdf
Size is 3673, 2044
Coordinate System is:
PROJCS["UTM Zone 15, Northern Hemisphere",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9108"]],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-93],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
GeoTransform =
  494482.9934340139, 1.9797610687878, -0.4578063200329283
  3519200.148697479, -0.4578063200329283, -1.9797610687878
Metadata:
  NEATLINE=POLYGON ((491222.64246014197
3515690.1233778466,492158.60528832977 35
19737.6489099222,499430.68065023294 3518056.0308031105,498494.71782204515
351400
8.5052710348,491222.64246014197 3515690.1233778466))
Corner Coordinates:
Upper Left  (  494482.993, 3519200.149) ( 93d 3'29.84"W, 31d48'30.24"N)
Lower Left  (  493547.237, 3515153.517) ( 93d 4' 5.33"W, 31d46'18.79"N)
Upper Right (  501754.656, 3517518.626) ( 92d58'53.27"W, 31d47'35.67"N)
Lower Right (  500818.900, 3513471.994) ( 92d59'28.87"W, 31d45'24.24"N)
Center      (  497650.947, 3516336.072) ( 93d 1'29.32"W, 31d46'57.26"N)
Band 1 Block=3673x1 Type=Byte, ColorInterp=Red
Band 2 Block=3673x1 Type=Byte, ColorInterp=Green
Band 3 Block=3673x1 Type=Byte, ColorInterp=Blue

Does the scale_factor has something on this will gdal_translate -unscale
will help or there is some problem in handling this specific file or
projection parameters

Ganesan R
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/913dfc1f/attachment-0001.html>

From lucena_ivan at hotmail.com  Wed Nov 18 11:22:38 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 18 Nov 2015 19:22:38 +0000
Subject: [gdal-dev] Limit on the number of subdatasets
Message-ID: <BLUPR19MB0145FB9DAC80A909F0E8208C901C0@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi there.


Is there a limit on the number of subdatasets that GDAL can handle?


I can't get it to list more than 4823.


Regards,

Ivan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/75c297e5/attachment.html>

From even.rouault at spatialys.com  Wed Nov 18 11:45:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Nov 2015 20:45:03 +0100
Subject: [gdal-dev] Limit on the number of subdatasets
In-Reply-To: <BLUPR19MB0145FB9DAC80A909F0E8208C901C0@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <BLUPR19MB0145FB9DAC80A909F0E8208C901C0@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <201511182045.03643.even.rouault@spatialys.com>

Le mercredi 18 novembre 2015 20:22:38, Ivan Lucena a écrit :
> Hi there.
> 
> 
> Is there a limit on the number of subdatasets that GDAL can handle?

There's no hard-coded limit AFAIK. Should be memory bound. But performance of 
various stuff handing lists might not be great with a big number.

> 
> 
> I can't get it to list more than 4823.

With what ? 

> 
> 
> Regards,
> 
> Ivan

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 18 12:02:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 18 Nov 2015 21:02:36 +0100
Subject: [gdal-dev] GeoPDF offsets from actual location after gdalwarp
In-Reply-To: <CALMrLdDwVBm_r0FNyCc=k+hymLdVNGeWheNQceUxDUgSsVF+Pw@mail.gmail.com>
References: <CALMrLdDwVBm_r0FNyCc=k+hymLdVNGeWheNQceUxDUgSsVF+Pw@mail.gmail.com>
Message-ID: <201511182102.36943.even.rouault@spatialys.com>

Le mercredi 18 novembre 2015 19:42:30, Gane R a écrit :
> Here is link to a GeoPDF (
> https://drive.google.com/file/d/0B4shTM1bPS5TMmk2OWxuTGJpY1k/view?usp=shari
> ng) this has a mile offset from the current location,
> on GDAL gdal-2.0.1 when gdalwarp warps the PDF (poppler driver) to GeoTIF
> 
> Here is gdalinfo for the file
> 
> Driver: PDF/Geospatial PDF
> Files: AssembledMaps.pdf
> Size is 3673, 2044
> Coordinate System is:
> PROJCS["UTM Zone 15, Northern Hemisphere",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.257222101,
>                 AUTHORITY["EPSG","7019"]],
>             TOWGS84[0,0,0,0,0,0,0],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0,
>             AUTHORITY["EPSG","8901"]],
>         UNIT["degree",0.0174532925199433,
>             AUTHORITY["EPSG","9108"]],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-93],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1]]
> GeoTransform =
>   494482.9934340139, 1.9797610687878, -0.4578063200329283
>   3519200.148697479, -0.4578063200329283, -1.9797610687878
> Metadata:
>   NEATLINE=POLYGON ((491222.64246014197
> 3515690.1233778466,492158.60528832977 35
> 19737.6489099222,499430.68065023294 3518056.0308031105,498494.71782204515
> 351400
> 8.5052710348,491222.64246014197 3515690.1233778466))
> Corner Coordinates:
> Upper Left  (  494482.993, 3519200.149) ( 93d 3'29.84"W, 31d48'30.24"N)
> Lower Left  (  493547.237, 3515153.517) ( 93d 4' 5.33"W, 31d46'18.79"N)
> Upper Right (  501754.656, 3517518.626) ( 92d58'53.27"W, 31d47'35.67"N)
> Lower Right (  500818.900, 3513471.994) ( 92d59'28.87"W, 31d45'24.24"N)
> Center      (  497650.947, 3516336.072) ( 93d 1'29.32"W, 31d46'57.26"N)
> Band 1 Block=3673x1 Type=Byte, ColorInterp=Red
> Band 2 Block=3673x1 Type=Byte, ColorInterp=Green
> Band 3 Block=3673x1 Type=Byte, ColorInterp=Blue
> 
> Does the scale_factor has something on this will gdal_translate -unscale
> will help or there is some problem in handling this specific file or
> projection parameters

No, not related at all. 

Fixed in trunk by r31638  "PDF: make OGC BP registration work with media box 
where min_x != 0 (in non-rotated case)"

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucena_ivan at hotmail.com  Wed Nov 18 12:22:39 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 18 Nov 2015 20:22:39 +0000
Subject: [gdal-dev] Limit on the number of subdatasets
In-Reply-To: <201511182045.03643.even.rouault@spatialys.com>
References: <BLUPR19MB0145FB9DAC80A909F0E8208C901C0@BLUPR19MB0145.namprd19.prod.outlook.com>,
 <201511182045.03643.even.rouault@spatialys.com>
Message-ID: <BLUPR19MB014591434CFED5C3937D923E901C0@BLUPR19MB0145.namprd19.prod.outlook.com>

The georaster driver uses GDAL subdataset to browse the database as you can see here:

gdal.org/frmt_georaster.html section "Browsing the database for GeoRasters"

That is not a big deal because there are other ways go around it.

But it can get a little confusing for users accustomed to use that feature. 

And I think QGIS Oracle Raster plugin uses that feature to browse the images.

It seems like the limitation is on CPLStringList. I will give it a closer look.

Stay safe.

Thanks.
________________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, November 18, 2015 2:45 PM
To: gdal-dev at lists.osgeo.org
Cc: Ivan Lucena
Subject: Re: [gdal-dev] Limit on the number of subdatasets

Le mercredi 18 novembre 2015 20:22:38, Ivan Lucena a écrit :
> Hi there.
>
>
> Is there a limit on the number of subdatasets that GDAL can handle?

There's no hard-coded limit AFAIK. Should be memory bound. But performance of
various stuff handing lists might not be great with a big number.

>
>
> I can't get it to list more than 4823.

With what ?

>
>
> Regards,
>
> Ivan

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From silyko at gmail.com  Wed Nov 18 12:38:58 2015
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Wed, 18 Nov 2015 21:38:58 +0100
Subject: [gdal-dev] GeoTransform confusion
Message-ID: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>

Hi List,

  I have a geoid in AAIGRID-format, with the following header:

ncols 1001
nrows 731
xllcenter 400000.0
yllcenter 6045000.0
cellsize 500.0
NODATA_value 9999

GDAL will read this just fine, and report:

Driver: AAIGrid/Arc/Info ASCII Grid
Files: dkgeoid13b.utm32
Size is 1001, 731
Coordinate System is `'
Origin = (399750.000000000000000,6410250.000000000000000)
Pixel Size = (500.000000000000000,-500.000000000000000)
Metadata:
  AREA_OR_POINT=Point
Corner Coordinates:
Upper Left  (  399750.000, 6410250.000)
Lower Left  (  399750.000, 6044750.000)
Upper Right (  900250.000, 6410250.000)
Lower Right (  900250.000, 6044750.000)
Center      (  650000.000, 6227500.000)
Band 1 Block=1001x1 Type=Float32, ColorInterp=Undefined
  NoData Value=9999

As expected, the upper left corner is shifted half a pixel. It is my
understanding, that GDAL (GetGeoTransform) always uses the xulcorner,
yulcorner (pixel) interpretation. However, I was suprised to see that after
a

gdal_translate dkgeoid13b.utm32 hello.tif,  I get:

>gdalinfo hello.tif
Driver: GTiff/GeoTIFF
Files: hej.tif
Size is 1001, 731
Coordinate System is `'
Origin = (400000.000000000000000,6410000.000000000000000)
Pixel Size = (500.000000000000000,-500.000000000000000)
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  400000.000, 6410000.000)
Lower Left  (  400000.000, 6044500.000)
Upper Right (  900500.000, 6410000.000)
Lower Right (  900500.000, 6044500.000)
Center      (  650250.000, 6227250.000)
Band 1 Block=1001x2 Type=Float32, ColorInterp=Gray
  NoData Value=99

The GeoTransform is not shifted half a pixel, and is not the same as the
AAIGRID i ran gdal_translate on?? So, I would have to interpret now the
GeoTransform as xulcenter and yulcenter. This came as a suprise, and led to
some bugs in our processing software.

Is this to be expected??

Cheers,
Simon Kokkendorff
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151118/fa43c6c5/attachment.html>

From silyko at gmail.com  Thu Nov 19 00:24:46 2015
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Thu, 19 Nov 2015 09:24:46 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
Message-ID: <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>

Basically it seems to be an issue with interpreting "center" directives
when doing the gdal_translate. Consider:

ncols 2
nrows 2
xllcenter 0.0
yllcenter 0.0
cellsize 1.0
nodata_value -999
2 2
2 2

gdalinfo on this file, will give the expected GeoTransform:

In [2]: ds = gdal.Open("center.asc")

In [3]: ds.GetGeoTransform()
Out[3]: (-0.5, 1.0, 0.0, 1.5, 0.0, -1.0)

Seems OK to me.

If I then do a gdal_translate: gdal_translate center.asc center.tif, I get
another interpretation:

In [4]: ds = gdal.Open("center.tif")

In [5]: ds.GetGeoTransform()
Out[5]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)

And, if I do a roundtrip: gdal_translate -of AAIGRID center.tif
center_back.asc, I get:
ncols        2
nrows        2
xllcorner    0.000000000000
yllcorner    -1.000000000000
cellsize     1.000000000000
NODATA_value -999
 2 2
 2 2

Which is definitely not the same GeoTransform as my input center.asc, but
shifted half a cellsize from what I would expect...

In [6]: ds = gdal.Open("center_back.asc")

In [7]: ds.GetGeoTransform()
Out[7]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)



GDAL version:
GDAL 1.11.2, released 2015/02/10

Cheers,
Simon


On Wed, Nov 18, 2015 at 9:38 PM, Simon Lyngby Kokkendorff <silyko at gmail.com>
wrote:

> Hi List,
>
>   I have a geoid in AAIGRID-format, with the following header:
>
> ncols 1001
> nrows 731
> xllcenter 400000.0
> yllcenter 6045000.0
> cellsize 500.0
> NODATA_value 9999
>
> GDAL will read this just fine, and report:
>
> Driver: AAIGrid/Arc/Info ASCII Grid
> Files: dkgeoid13b.utm32
> Size is 1001, 731
> Coordinate System is `'
> Origin = (399750.000000000000000,6410250.000000000000000)
> Pixel Size = (500.000000000000000,-500.000000000000000)
> Metadata:
>   AREA_OR_POINT=Point
> Corner Coordinates:
> Upper Left  (  399750.000, 6410250.000)
> Lower Left  (  399750.000, 6044750.000)
> Upper Right (  900250.000, 6410250.000)
> Lower Right (  900250.000, 6044750.000)
> Center      (  650000.000, 6227500.000)
> Band 1 Block=1001x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=9999
>
> As expected, the upper left corner is shifted half a pixel. It is my
> understanding, that GDAL (GetGeoTransform) always uses the xulcorner,
> yulcorner (pixel) interpretation. However, I was suprised to see that after
> a
>
> gdal_translate dkgeoid13b.utm32 hello.tif,  I get:
>
> >gdalinfo hello.tif
> Driver: GTiff/GeoTIFF
> Files: hej.tif
> Size is 1001, 731
> Coordinate System is `'
> Origin = (400000.000000000000000,6410000.000000000000000)
> Pixel Size = (500.000000000000000,-500.000000000000000)
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  400000.000, 6410000.000)
> Lower Left  (  400000.000, 6044500.000)
> Upper Right (  900500.000, 6410000.000)
> Lower Right (  900500.000, 6044500.000)
> Center      (  650250.000, 6227250.000)
> Band 1 Block=1001x2 Type=Float32, ColorInterp=Gray
>   NoData Value=99
>
> The GeoTransform is not shifted half a pixel, and is not the same as the
> AAIGRID i ran gdal_translate on?? So, I would have to interpret now the
> GeoTransform as xulcenter and yulcenter. This came as a suprise, and led to
> some bugs in our processing software.
>
> Is this to be expected??
>
> Cheers,
> Simon Kokkendorff
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/6517288c/attachment.html>

From ari.jolma at gmail.com  Thu Nov 19 01:03:31 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 19 Nov 2015 11:03:31 +0200
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
Message-ID: <564D9063.2000103@gmail.com>

Simon,

If you set the configuration option GTIFF_POINT_GEO_IGNORE to "TRUE" 
instead of the default "FALSE" the offset will not happen.

I've tested this and it works. The configuration option needs to be set 
in code, it is not a GTiff creation option.

I'm not quite sure why you need to do that. Anyway it happens when the 
destination geotiff is created and its fields are set. The 
geotransformation of the geotiff file are set indirectly using 
geotiepoints using the geotransformation of the source (which is correct).

Ari

On 19.11.2015 10:24, Simon Lyngby Kokkendorff wrote:
> Basically it seems to be an issue with interpreting "center" 
> directives when doing the gdal_translate. Consider:
>
> ncols 2
> nrows 2
> xllcenter 0.0
> yllcenter 0.0
> cellsize 1.0
> nodata_value -999
> 2 2
> 2 2
>
> gdalinfo on this file, will give the expected GeoTransform:
>
> In [2]: ds = gdal.Open("center.asc")
>
> In [3]: ds.GetGeoTransform()
> Out[3]: (-0.5, 1.0, 0.0, 1.5, 0.0, -1.0)
>
> Seems OK to me.
>
> If I then do a gdal_translate: gdal_translate center.asc center.tif, I 
> get another interpretation:
>
> In [4]: ds = gdal.Open("center.tif")
>
> In [5]: ds.GetGeoTransform()
> Out[5]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
>
> And, if I do a roundtrip: gdal_translate -of AAIGRID center.tif 
> center_back.asc, I get:
> ncols        2
> nrows        2
> xllcorner    0.000000000000
> yllcorner    -1.000000000000
> cellsize     1.000000000000
> NODATA_value -999
>  2 2
>  2 2
>
> Which is definitely not the same GeoTransform as my input center.asc, 
> but shifted half a cellsize from what I would expect...
>
> In [6]: ds = gdal.Open("center_back.asc")
>
> In [7]: ds.GetGeoTransform()
> Out[7]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
>
>
>
> GDAL version:
> GDAL 1.11.2, released 2015/02/10
>
> Cheers,
> Simon
>
>
> On Wed, Nov 18, 2015 at 9:38 PM, Simon Lyngby Kokkendorff 
> <silyko at gmail.com <mailto:silyko at gmail.com>> wrote:
>
>     Hi List,
>
>       I have a geoid in AAIGRID-format, with the following header:
>
>     ncols 1001
>     nrows 731
>     xllcenter 400000.0
>     yllcenter 6045000.0
>     cellsize 500.0
>     NODATA_value 9999
>
>     GDAL will read this just fine, and report:
>
>     Driver: AAIGrid/Arc/Info ASCII Grid
>     Files: dkgeoid13b.utm32
>     Size is 1001, 731
>     Coordinate System is `'
>     Origin = (399750.000000000000000,6410250.000000000000000)
>     Pixel Size = (500.000000000000000,-500.000000000000000)
>     Metadata:
>       AREA_OR_POINT=Point
>     Corner Coordinates:
>     Upper Left  (  399750.000, 6410250.000)
>     Lower Left  (  399750.000, 6044750.000)
>     Upper Right (  900250.000, 6410250.000)
>     Lower Right (  900250.000, 6044750.000)
>     Center      (  650000.000, 6227500.000)
>     Band 1 Block=1001x1 Type=Float32, ColorInterp=Undefined
>       NoData Value=9999
>
>     As expected, the upper left corner is shifted half a pixel. It is
>     my understanding, that GDAL (GetGeoTransform) always uses the
>     xulcorner, yulcorner (pixel) interpretation. However, I was
>     suprised to see that after a
>
>     gdal_translate dkgeoid13b.utm32 hello.tif,  I get:
>
>     >gdalinfo hello.tif
>     Driver: GTiff/GeoTIFF
>     Files: hej.tif
>     Size is 1001, 731
>     Coordinate System is `'
>     Origin = (400000.000000000000000,6410000.000000000000000)
>     Pixel Size = (500.000000000000000,-500.000000000000000)
>     Image Structure Metadata:
>       INTERLEAVE=BAND
>     Corner Coordinates:
>     Upper Left  (  400000.000, 6410000.000)
>     Lower Left  (  400000.000, 6044500.000)
>     Upper Right (  900500.000, 6410000.000)
>     Lower Right (  900500.000, 6044500.000)
>     Center      (  650250.000, 6227250.000)
>     Band 1 Block=1001x2 Type=Float32, ColorInterp=Gray
>       NoData Value=99
>
>     The GeoTransform is not shifted half a pixel, and is not the same
>     as the AAIGRID i ran gdal_translate on?? So, I would have to
>     interpret now the GeoTransform as xulcenter and yulcenter. This
>     came as a suprise, and led to some bugs in our processing software.
>
>     Is this to be expected??
>
>     Cheers,
>     Simon Kokkendorff
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/653d0db3/attachment-0001.html>

From silyko at gmail.com  Thu Nov 19 01:15:15 2015
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Thu, 19 Nov 2015 10:15:15 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <564D9063.2000103@gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
 <564D9063.2000103@gmail.com>
Message-ID: <CANzGYpT2593JnbL7rYy7RYr7_Whm5rNreAZemV_Eyc9_ptPKWQ@mail.gmail.com>

Thanks Ari,

   I wasn't aware of that. Naively assumed that GDAL would just keep the
geotransform in a gdal_translate, no matter what. Good to know, thanks!

Cheers,
SImon


On Thu, Nov 19, 2015 at 10:03 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

> Simon,
>
> If you set the configuration option GTIFF_POINT_GEO_IGNORE to "TRUE"
> instead of the default "FALSE" the offset will not happen.
>
> I've tested this and it works. The configuration option needs to be set in
> code, it is not a GTiff creation option.
>
> I'm not quite sure why you need to do that. Anyway it happens when the
> destination geotiff is created and its fields are set. The
> geotransformation of the geotiff file are set indirectly using geotiepoints
> using the geotransformation of the source (which is correct).
>
> Ari
>
>
> On 19.11.2015 10:24, Simon Lyngby Kokkendorff wrote:
>
> Basically it seems to be an issue with interpreting "center" directives
> when doing the gdal_translate. Consider:
>
> ncols 2
> nrows 2
> xllcenter 0.0
> yllcenter 0.0
> cellsize 1.0
> nodata_value -999
> 2 2
> 2 2
>
> gdalinfo on this file, will give the expected GeoTransform:
>
> In [2]: ds = gdal.Open("center.asc")
>
> In [3]: ds.GetGeoTransform()
> Out[3]: (-0.5, 1.0, 0.0, 1.5, 0.0, -1.0)
>
> Seems OK to me.
>
> If I then do a gdal_translate: gdal_translate center.asc center.tif, I get
> another interpretation:
>
> In [4]: ds = gdal.Open("center.tif")
>
> In [5]: ds.GetGeoTransform()
> Out[5]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
>
> And, if I do a roundtrip: gdal_translate -of AAIGRID center.tif
> center_back.asc, I get:
> ncols        2
> nrows        2
> xllcorner    0.000000000000
> yllcorner    -1.000000000000
> cellsize     1.000000000000
> NODATA_value -999
>  2 2
>  2 2
>
> Which is definitely not the same GeoTransform as my input center.asc, but
> shifted half a cellsize from what I would expect...
>
> In [6]: ds = gdal.Open("center_back.asc")
>
> In [7]: ds.GetGeoTransform()
> Out[7]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
>
>
>
> GDAL version:
> GDAL 1.11.2, released 2015/02/10
>
> Cheers,
> Simon
>
>
> On Wed, Nov 18, 2015 at 9:38 PM, Simon Lyngby Kokkendorff <
> <silyko at gmail.com>silyko at gmail.com> wrote:
>
>> Hi List,
>>
>>   I have a geoid in AAIGRID-format, with the following header:
>>
>> ncols 1001
>> nrows 731
>> xllcenter 400000.0
>> yllcenter 6045000.0
>> cellsize 500.0
>> NODATA_value 9999
>>
>> GDAL will read this just fine, and report:
>>
>> Driver: AAIGrid/Arc/Info ASCII Grid
>> Files: dkgeoid13b.utm32
>> Size is 1001, 731
>> Coordinate System is `'
>> Origin = (399750.000000000000000,6410250.000000000000000)
>> Pixel Size = (500.000000000000000,-500.000000000000000)
>> Metadata:
>>   AREA_OR_POINT=Point
>> Corner Coordinates:
>> Upper Left  (  399750.000, 6410250.000)
>> Lower Left  (  399750.000, 6044750.000)
>> Upper Right (  900250.000, 6410250.000)
>> Lower Right (  900250.000, 6044750.000)
>> Center      (  650000.000, 6227500.000)
>> Band 1 Block=1001x1 Type=Float32, ColorInterp=Undefined
>>   NoData Value=9999
>>
>> As expected, the upper left corner is shifted half a pixel. It is my
>> understanding, that GDAL (GetGeoTransform) always uses the xulcorner,
>> yulcorner (pixel) interpretation. However, I was suprised to see that after
>> a
>>
>> gdal_translate dkgeoid13b.utm32 hello.tif,  I get:
>>
>> >gdalinfo hello.tif
>> Driver: GTiff/GeoTIFF
>> Files: hej.tif
>> Size is 1001, 731
>> Coordinate System is `'
>> Origin = (400000.000000000000000,6410000.000000000000000)
>> Pixel Size = (500.000000000000000,-500.000000000000000)
>> Image Structure Metadata:
>>   INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  400000.000, 6410000.000)
>> Lower Left  (  400000.000, 6044500.000)
>> Upper Right (  900500.000, 6410000.000)
>> Lower Right (  900500.000, 6044500.000)
>> Center      (  650250.000, 6227250.000)
>> Band 1 Block=1001x2 Type=Float32, ColorInterp=Gray
>>   NoData Value=99
>>
>> The GeoTransform is not shifted half a pixel, and is not the same as the
>> AAIGRID i ran gdal_translate on?? So, I would have to interpret now the
>> GeoTransform as xulcenter and yulcenter. This came as a suprise, and led to
>> some bugs in our processing software.
>>
>> Is this to be expected??
>>
>> Cheers,
>> Simon Kokkendorff
>>
>>
>>
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/d5de26c4/attachment.html>

From even.rouault at spatialys.com  Thu Nov 19 01:26:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Nov 2015 10:26:23 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
Message-ID: <201511191026.23758.even.rouault@spatialys.com>

Le jeudi 19 novembre 2015 09:24:46, Simon Lyngby Kokkendorff a écrit :
> Basically it seems to be an issue with interpreting "center" directives
> when doing the gdal_translate. Consider:
> 
> ncols 2
> nrows 2
> xllcenter 0.0
> yllcenter 0.0
> cellsize 1.0
> nodata_value -999
> 2 2
> 2 2
> 
> gdalinfo on this file, will give the expected GeoTransform:
> 
> In [2]: ds = gdal.Open("center.asc")
> 
> In [3]: ds.GetGeoTransform()
> Out[3]: (-0.5, 1.0, 0.0, 1.5, 0.0, -1.0)
> 
> Seems OK to me.
> 
> If I then do a gdal_translate: gdal_translate center.asc center.tif, I get
> another interpretation:
> 
> In [4]: ds = gdal.Open("center.tif")
> 
> In [5]: ds.GetGeoTransform()
> Out[5]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
> 
> And, if I do a roundtrip: gdal_translate -of AAIGRID center.tif
> center_back.asc, I get:
> ncols        2
> nrows        2
> xllcorner    0.000000000000
> yllcorner    -1.000000000000
> cellsize     1.000000000000
> NODATA_value -999
>  2 2
>  2 2
> 
> Which is definitely not the same GeoTransform as my input center.asc, but
> shifted half a cellsize from what I would expect...
> 
> In [6]: ds = gdal.Open("center_back.asc")
> 
> In [7]: ds.GetGeoTransform()
> Out[7]: (0.0, 1.0, 0.0, 1.0, 0.0, -1.0)
> 
> 
> 
> GDAL version:
> GDAL 1.11.2, released 2015/02/10

Simon,

Regarding the fact that the geotiff file looses the half-pixel shift, it seems 
to be due to the absence of a SRS. If I do "gdal_translate test.asc test.tif -
a_srs EPSG:32630" for example, then the geotransform I get back is correct. 
This is a defect of the GeoTIFF writer that writes the GeoTIFF Tiepoints with 
the PixelIsPoint convention (since your original data is flagged as such), but 
fails to write GTRasterTypeGeoKey=RasterPixelIsPoint as a geotiff key when 
there's no SRS. Could be worth a ticket.

Some background: https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint

A workaround :
gdal_translate test.asc test.tif -mo AREA_OR_POINT=AREA

This will force the geotiff writer to use the default convention, and thus 
avoiding going back to the centerofpixel convention when writing the GeoTIFF 
tiepoints.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Nov 19 01:29:22 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 19 Nov 2015 11:29:22 +0200
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <201511191026.23758.even.rouault@spatialys.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
 <201511191026.23758.even.rouault@spatialys.com>
Message-ID: <564D9672.6060009@gmail.com>


On 19.11.2015 11:26, Even Rouault wrote:
>
>
> GDAL version:
> GDAL 1.11.2, released 2015/02/10
> Simon,
>
> Regarding the fact that the geotiff file looses the half-pixel shift, it seems
> to be due to the absence of a SRS. If I do "gdal_translate test.asc test.tif -
> a_srs EPSG:32630" for example, then the geotransform I get back is correct.
> This is a defect of the GeoTIFF writer that writes the GeoTIFF Tiepoints with
> the PixelIsPoint convention (since your original data is flagged as such), but
> fails to write GTRasterTypeGeoKey=RasterPixelIsPoint as a geotiff key when
> there's no SRS. Could be worth a ticket.

My conclusion is the same. I think the key should be set regardless of 
the existence of a SRS.

Ari

>
> Some background: https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint
>
> A workaround :
> gdal_translate test.asc test.tif -mo AREA_OR_POINT=AREA
>
> This will force the geotiff writer to use the default convention, and thus
> avoiding going back to the centerofpixel convention when writing the GeoTIFF
> tiepoints.
>
> Even
>


From silyko at gmail.com  Thu Nov 19 01:47:50 2015
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Thu, 19 Nov 2015 10:47:50 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <564D9672.6060009@gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <CANzGYpQjcHFM-i7T92dx-Y-6WuU8MqAo6ROdi+3bJ4Q1LfCYQA@mail.gmail.com>
 <201511191026.23758.even.rouault@spatialys.com>
 <564D9672.6060009@gmail.com>
Message-ID: <CANzGYpT3SUc2Cn2fVwSHwatsi6XayAkhy6uOJ-Ca4bZw0wru2A@mail.gmail.com>

I can confirm also that it works when I set a target srs.
But must admit that the current behaviour was confusing. I knew how to
interpret the input data - under the assumption that a geotransform is not
changed when I do no transformations or interpolations:
If I know that my data are "points" rather than "pixels" - the first
"point" is lying half a cellsize downwards and rightwards from the upper
left corner that GDAL reports. That's what I always assume - not relying on
other metadata items than the GeoTransform.

So I agree that it might be worth a ticket.

Cheers,
Simon





On Thu, Nov 19, 2015 at 10:29 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

>
> On 19.11.2015 11:26, Even Rouault wrote:
>
>>
>>
>> GDAL version:
>> GDAL 1.11.2, released 2015/02/10
>> Simon,
>>
>> Regarding the fact that the geotiff file looses the half-pixel shift, it
>> seems
>> to be due to the absence of a SRS. If I do "gdal_translate test.asc
>> test.tif -
>> a_srs EPSG:32630" for example, then the geotransform I get back is
>> correct.
>> This is a defect of the GeoTIFF writer that writes the GeoTIFF Tiepoints
>> with
>> the PixelIsPoint convention (since your original data is flagged as
>> such), but
>> fails to write GTRasterTypeGeoKey=RasterPixelIsPoint as a geotiff key when
>> there's no SRS. Could be worth a ticket.
>>
>
> My conclusion is the same. I think the key should be set regardless of the
> existence of a SRS.
>
> Ari
>
>
>> Some background:
>> https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint
>>
>> A workaround :
>> gdal_translate test.asc test.tif -mo AREA_OR_POINT=AREA
>>
>> This will force the geotiff writer to use the default convention, and thus
>> avoiding going back to the centerofpixel convention when writing the
>> GeoTIFF
>> tiepoints.
>>
>> Even
>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/3a647eb2/attachment-0001.html>

From even.rouault at spatialys.com  Thu Nov 19 01:59:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Nov 2015 10:59:20 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <CANzGYpT3SUc2Cn2fVwSHwatsi6XayAkhy6uOJ-Ca4bZw0wru2A@mail.gmail.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <564D9672.6060009@gmail.com>
 <CANzGYpT3SUc2Cn2fVwSHwatsi6XayAkhy6uOJ-Ca4bZw0wru2A@mail.gmail.com>
Message-ID: <201511191059.20849.even.rouault@spatialys.com>

Le jeudi 19 novembre 2015 10:47:50, Simon Lyngby Kokkendorff a écrit :
> I can confirm also that it works when I set a target srs.
> But must admit that the current behaviour was confusing. I knew how to
> interpret the input data - under the assumption that a geotransform is not
> changed when I do no transformations or interpolations:
> If I know that my data are "points" rather than "pixels" - the first
> "point" is lying half a cellsize downwards and rightwards from the upper
> left corner that GDAL reports. That's what I always assume - not relying on
> other metadata items than the GeoTransform.
> 
> So I agree that it might be worth a ticket.

Please file one.

> 
> Cheers,
> Simon
> 
> On Thu, Nov 19, 2015 at 10:29 AM, Ari Jolma <ari.jolma at gmail.com> wrote:
> > On 19.11.2015 11:26, Even Rouault wrote:
> >> GDAL version:
> >> GDAL 1.11.2, released 2015/02/10
> >> Simon,
> >> 
> >> Regarding the fact that the geotiff file looses the half-pixel shift, it
> >> seems
> >> to be due to the absence of a SRS. If I do "gdal_translate test.asc
> >> test.tif -
> >> a_srs EPSG:32630" for example, then the geotransform I get back is
> >> correct.
> >> This is a defect of the GeoTIFF writer that writes the GeoTIFF Tiepoints
> >> with
> >> the PixelIsPoint convention (since your original data is flagged as
> >> such), but
> >> fails to write GTRasterTypeGeoKey=RasterPixelIsPoint as a geotiff key
> >> when there's no SRS. Could be worth a ticket.
> > 
> > My conclusion is the same. I think the key should be set regardless of
> > the existence of a SRS.
> > 
> > Ari
> > 
> >> Some background:
> >> https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint
> >> 
> >> A workaround :
> >> gdal_translate test.asc test.tif -mo AREA_OR_POINT=AREA
> >> 
> >> This will force the geotiff writer to use the default convention, and
> >> thus avoiding going back to the centerofpixel convention when writing
> >> the GeoTIFF
> >> tiepoints.
> >> 
> >> Even
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From silyko at gmail.com  Thu Nov 19 03:52:48 2015
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Thu, 19 Nov 2015 12:52:48 +0100
Subject: [gdal-dev] GeoTransform confusion
In-Reply-To: <201511191059.20849.even.rouault@spatialys.com>
References: <CANzGYpQHNaO7OwCGSx64vKbOzX8HAVKhcgghdD5QnKfE5wLJmA@mail.gmail.com>
 <564D9672.6060009@gmail.com>
 <CANzGYpT3SUc2Cn2fVwSHwatsi6XayAkhy6uOJ-Ca4bZw0wru2A@mail.gmail.com>
 <201511191059.20849.even.rouault@spatialys.com>
Message-ID: <CANzGYpQakmQGwk4_JsSazVCyCqnsPahvsgnhcgJBEu9MW_fOwA@mail.gmail.com>

Done: https://trac.osgeo.org/gdal/ticket/6225#ticket

Thanks once again!!
Simon


On Thu, Nov 19, 2015 at 10:59 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 19 novembre 2015 10:47:50, Simon Lyngby Kokkendorff a écrit :
> > I can confirm also that it works when I set a target srs.
> > But must admit that the current behaviour was confusing. I knew how to
> > interpret the input data - under the assumption that a geotransform is
> not
> > changed when I do no transformations or interpolations:
> > If I know that my data are "points" rather than "pixels" - the first
> > "point" is lying half a cellsize downwards and rightwards from the upper
> > left corner that GDAL reports. That's what I always assume - not relying
> on
> > other metadata items than the GeoTransform.
> >
> > So I agree that it might be worth a ticket.
>
> Please file one.
>
> >
> > Cheers,
> > Simon
> >
> > On Thu, Nov 19, 2015 at 10:29 AM, Ari Jolma <ari.jolma at gmail.com> wrote:
> > > On 19.11.2015 11:26, Even Rouault wrote:
> > >> GDAL version:
> > >> GDAL 1.11.2, released 2015/02/10
> > >> Simon,
> > >>
> > >> Regarding the fact that the geotiff file looses the half-pixel shift,
> it
> > >> seems
> > >> to be due to the absence of a SRS. If I do "gdal_translate test.asc
> > >> test.tif -
> > >> a_srs EPSG:32630" for example, then the geotransform I get back is
> > >> correct.
> > >> This is a defect of the GeoTIFF writer that writes the GeoTIFF
> Tiepoints
> > >> with
> > >> the PixelIsPoint convention (since your original data is flagged as
> > >> such), but
> > >> fails to write GTRasterTypeGeoKey=RasterPixelIsPoint as a geotiff key
> > >> when there's no SRS. Could be worth a ticket.
> > >
> > > My conclusion is the same. I think the key should be set regardless of
> > > the existence of a SRS.
> > >
> > > Ari
> > >
> > >> Some background:
> > >> https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint
> > >>
> > >> A workaround :
> > >> gdal_translate test.asc test.tif -mo AREA_OR_POINT=AREA
> > >>
> > >> This will force the geotiff writer to use the default convention, and
> > >> thus avoiding going back to the centerofpixel convention when writing
> > >> the GeoTIFF
> > >> tiepoints.
> > >>
> > >> Even
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/6e98ec06/attachment.html>

From Ori.Bar at elbitsystems.com  Thu Nov 19 04:24:34 2015
From: Ori.Bar at elbitsystems.com (Bar Ori)
Date: Thu, 19 Nov 2015 12:24:34 +0000
Subject: [gdal-dev] GCPsToGeoTransform returns wrong values
In-Reply-To: <538E9F517DECA94A86A940F00577EACDF836C99D@MXHFA01.esl.corp.elbit.co.il>
References: <538E9F517DECA94A86A940F00577EACDF836C92B@MXHFA01.esl.corp.elbit.co.il>
 <564C462A.7070605@gmail.com>
 <538E9F517DECA94A86A940F00577EACDF836C971@MXHFA01.esl.corp.elbit.co.il>
 <538E9F517DECA94A86A940F00577EACDF836C99D@MXHFA01.esl.corp.elbit.co.il>
Message-ID: <538E9F517DECA94A86A940F00577EACDF836CB11@MXHFA01.esl.corp.elbit.co.il>

What I decided to do it to set the GPCs on the corners :

var gcps = new[]
{
new GCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0, 0, null, "1"),
new GCP(RightUp.X, RightUp.Y, RightUp.Z, Width , 0, null, "2"),
new GCP(RightDown.X, RightDown.Y, RightDown.Z, Width, Height, null, "3"),
new GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, 0, Height, null, "4")
};

Then to run :
var geotransform = new double[6];
Gdal.GCPsToGeoTransform(gcps, geotransform, 0)

In case it returns TRUE, a rectangular shape, so I call:
dataSet.GetGeoTransform(geotransform);

Otherwise, I put the GCPs on the middle of pixels ( gcps[0] += 0.5 etc… ) and call :
dataSet.SetGCPs(gcps, projection)

When I want to reload the information, so first I check the GCPs count. If 0, so I take and calculate the corners coordinates using the geotransform.
Otherwise, I get the GCPs.

It works for me.
Ready to hear if there is a better solution.

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Bar Ori
Sent: 18 November 2015 13:18
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

I found in did that the GDALGCPsToGeoTransform using the pixels values for calculation:

At gdal_misc.cpp :
padfGeoTransform[1] = (pasGCPs[1].dfGCPX - pasGCPs[0].dfGCPX) / (pasGCPs[1].dfGCPPixel - pasGCPs[0].dfGCPPixel);
padfGeoTransform[0] = pasGCPs[0].dfGCPX - pasGCPs[0].dfGCPPixel * padfGeoTransform[1];

in this case, the question is what is the best practice for the problem I published (sometimes rectangle, sometimes not).

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org]<mailto:[mailto:gdal-dev-bounces at lists.osgeo.org]> On Behalf Of Bar Ori
Sent: 18 November 2015 12:00
To: Ari Jolma
Cc: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

Thanks Ari for your reply.

In my situation, sometimes I am working with rectangles and sometimes not. Depends the source of information.
I thought to always use the GCPs as follows:
In case my shape has rectangular form, so the dataSet.GetGCPCount() will return me “0” and I will use the dataSet.GetGeoTransform(), otherwise, will use the dataSet.GetGCPs().
The issue is that for setting the GCPs, I must put the coordinate in the middle of pixel (that is why I  subtract “0.5”). If I wouldn’t, so yes, the geotransform values would be correct.
Is it a bad practice? Should I figure out the shape from start and to take two different steps?

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org]<mailto:[mailto:gdal-dev-bounces at lists.osgeo.org]> On Behalf Of Ari Jolma
Sent: 18 November 2015 11:35
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GCPsToGeoTransform returns wrong values

Bar,

I think you are setting the GCPs up wrongly if you want them to be at the corners.

GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4") does not have 0 before Height-0.5.

GCPsToGeoTransform checks the special case of GCPs in rectangular shape and in top-left, top-right, bottom-right, bottom-left order and returns the exact transform the dataset has.

I'm not sure if it makes sense to have real values for the pixel coordinates although they are real values.

Best,

Ari
On 18.11.2015 09:32, Bar Ori wrote:
Hi,
I noticed something that for me looks weird and I would like to know maybe I am doing something wrong.
If not, how should I overcome this behavior.

I set 4 GCPs as follows:

var gcps = new[]
{
new GCP(LeftUp.X, LeftUp.Y, LeftUp.Z, 0.5, 0.5, null, "1"),
new GCP(RightUp.X, RightUp.Y, RightUp.Z, Width - 0.5, 0.5, null, "2"),
new GCP(RightDown.X, RightDown.Y, RightDown.Z, Width - 0.5, Height - 0.5, null, "3"),
new GCP(LeftDown.X, LeftDown.Y, LeftDown.Z, Height - 0.5, null, "4")
};

And when I am doing as follows:

var geotransform = new double[6];
Gdal.GCPsToGeoTransform(gcps, geotransform, 0)

Or (after using dataSet.SetGCPs(gcps, projection) :

var geotransform = new double[6];
dataSet.GetGeoTransform(geotransform);

So the values returned, are wrong.
For example, if the LeftUp.X was 35.01050 so the value of geotransform[0], which supposed to be the same value, can be 35.0082.
The same with all the geotransform values.
If I am getting from the dataset and setting again, every time it is changing more and more.
Is there any connection to the use of the “0.5”?

Thanks.


[cid:image001.png at 01D122D6.033D74C0]

Ori Bar | Software Developer
Applications Development
Elbit Systems Land and C4I
T  +972-9-8898900  |   M  +972-504-734296




The information in this e-mail transmission contains proprietary and business
sensitive information.  Unauthorized interception of this e-mail may constitute
a violation of law. If you are not the intended recipient, you are hereby
notified that any review, dissemination, distribution or duplication of this
communication is strictly prohibited. You are also asked to contact the sender
by reply email and immediately destroy all copies of the original message.


_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

http://lists.osgeo.org/mailman/listinfo/gdal-dev


The information in this e-mail transmission contains proprietary and business
sensitive information.  Unauthorized interception of this e-mail may constitute
a violation of law. If you are not the intended recipient, you are hereby
notified that any review, dissemination, distribution or duplication of this
communication is strictly prohibited. You are also asked to contact the sender
by reply email and immediately destroy all copies of the original message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/a4d34748/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4160 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/a4d34748/attachment-0001.png>

From dvick at boundlessgeo.com  Thu Nov 19 08:18:17 2015
From: dvick at boundlessgeo.com (David Vick)
Date: Thu, 19 Nov 2015 10:18:17 -0600
Subject: [gdal-dev] OGR FileGDB fails to copy data
In-Reply-To: <CAA2n=rkUzq0aZOJtj6QAR3p=FPzSTJwYpbkT0Xi5K_zqssZijw@mail.gmail.com>
References: <CAA2n=r=hatf7h1zrN_bTVCqvj94mqUBR7BUohftiYPNMb5JyRw@mail.gmail.com>
 <201511172355.18284.even.rouault@spatialys.com>
 <CAA2n=rkUzq0aZOJtj6QAR3p=FPzSTJwYpbkT0Xi5K_zqssZijw@mail.gmail.com>
Message-ID: <CAA2n=r=53RsweMgv_VusUdvzDroD1X5D1MgMgjYYP0xXg1QnCw@mail.gmail.com>

Evan,

I wanted to circle back to you and thank you for the suggestion regarding
"fieldmap identity".  It turns out this was indeed the problem.  I was
convinced that it needed to be used to ensure that the domains and
sub-types of the filegeodatabase were transferred.

Thanks again!

David Vick

Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
dvick at boundlessgeo.com
mobile: 1-636-698-3174


On Tue, Nov 17, 2015 at 7:12 PM, David Vick <dvick at boundlessgeo.com> wrote:

> Evan,
>
> Thanks for the reply.
>
> We are using gdal 1.11, I have tried with setting PG_USE_COPY=NO and
> -skipfailures yields no results as all features within the layer fail.  I
> will try without the -fieldmap identity, but doubt that will have any
> effect as the schema of the the file geodatabase is copied into postgis
> prior to running ogr2ogr.
>
> I have tried the OGR_TRUNCATE "YES" --config option and using -overwrite
> deletes the schema that we need as part of our business process.
>
> Yes there is an ESRI column, the geometries are stored in the "shape"
> column in the db as we are currently tied to using ESRI's st_geometry as
> part of the business process.  If we could use postgis' native geometry
> this ogr2ogr process would be a perfect fit.
>
> I will try the ingest again without the -fieldmap identity parameter to
> see if it makes a difference.  Thanks again, and please reach out if you
> think of anything else.
>
> David Vick
>
> Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
> dvick at boundlessgeo.com
> mobile: 1-636-698-3174
>
>
> On Tue, Nov 17, 2015 at 4:55 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le mardi 17 novembre 2015 23:36:29, David Vick a écrit :
>> > Hi,
>> >
>> > I'm currently using OSGeo4W with ESRI's 1.4 version of the File
>> Geodatabase
>> > API and trying to ingest a filegdb into postgresql 9.2.2 that is
>> configured
>> > with ArcSDE and is using st_geometry as the default type.  When I
>> execute
>> > an ogr2ogr -update -append on a feature class that contains either
>> > mulitlinestring or multipolygon I get an error that the copy statement
>> >
>> > failed.  The debug info is listed below:
>> > >ogr2ogr -update -append -preserve_fid -fieldmap identity -f
>> "PostgreSQL"
>> >
>> > PG:"host=******* user=**** dbname=******* port=5432 password=*****"
>> > C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb AeronauticSrf_AM
>> > --config PGSQL_OGR_FID "objectid" --config PG_USE_COPY "YES" --config
>> > PG_USE_BASE64 "YES" --config FGDB_BULK_LOAD "YES" --config
>> > PG_LIST_ALL_TABLES "YES" --config OGR_TRUNCATE "YES" --debug ON
>> -progress
>> >
>> > FileGDB: Really opening
>> C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
>> > OGR:
>> OGROpen(C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb/03B3D220)
>> > succeeded as FileGDB.
>> > PG: DBName="fgcmdev3wk"
>> > PG: PostgreSQL version string : 'PostgreSQL 9.2.2 on
>> > x86_64-unknown-linux-gnu, compiled by gcc (GCC) 4.4.6 20110731 (Red Hat
>> > 4.4.6-3), 64-bit'
>> > PG: PostGIS version string : '2.0 USE_GEOS=1 USE_PROJ=1 USE_STATS=1'
>> > OGR: OGROpen(PG:host=lnsvr0800.gcsd.harris.com user=fgcm
>> dbname=fgcmdev3wk
>> > port=5432 password=fgcm/054050E8) succeeded as PostgreSQL.
>> > PG: Using column 'objectid' as FID for table 'aeronauticsrf_am'
>> > PG: Field shape is of unknown format type st_geometry
>> (type=st_geometry).
>> > 0...10...20...30...40...50...60...70...80...90...100 - done.
>> > PG: PQputCopyEnd()
>> > ERROR 1: COPY statement failed.
>> > ERROR:  ESRI: invalid hexa character in hexa string [30000]:
>> > CONTEXT:  COPY aeronauticsrf_am, line 1, column shape:
>> > "{C8CDC53F-9478-4CB9-9CD3-7ADA9558FFC2}"
>> >
>> > OGR2OGR: 118 features written in layer 'aeronauticsrf_am'
>> > FileGDB: ref_count of
>> C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb =
>> > 0 now
>> > FileGDB: Really closing
>> C:\Users\dvick99\Documents\fgcm\TDS61_Merged_FJ.gdb
>> > now
>> >
>> > Does anyone have any other suggestions to try?  Our current process of
>> > loading data is taking in excess of 12 hours and getting ogr2ogr to work
>> > will improve this time to just minutes.
>>
>> David,
>>
>> Difficult to know what happens with just that.
>> Which GDAL version ?
>> You could try without PG_USE_COPY=YES to check if it is an issue with the
>> copy
>> mode.
>> And -skipfailures to identify if there's a particular feature that cause
>> problem or if it is more general.
>> Perhaps a field mismatch with "-fieldmap identity" ? This option only
>> works if
>> the column names in source and target datasets are listed in same order
>> (check
>> with ogrinfo)
>> Did you try creating a new target layer instead of -update + --config
>> OGR_TRUNCATE "YES"  ?
>>
>> I'm not sure when the error "ERROR:  ESRI: invalid hexa character in hexa
>> string [30000]:" comes from. Is there a 'ESRI' column ?
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/60a3d5de/attachment.html>

From dadler at adtechgeospatial.com  Thu Nov 19 09:11:46 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Thu, 19 Nov 2015 12:11:46 -0500
Subject: [gdal-dev] Is autotest ogr_db2_hack still needed
Message-ID: <564E02D2.8000605@adtechgeospatial.com>

I noticed that ogr_db2_hack.py exists to test for some DB2 V7.2 problem 
with WKB. I don't know what the problem was but we did make some fixes 
to the DB2 WKB support and I'm wondering if this test is still necessary.

If the test is still necessary, was the problem reported to DB2 development?

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From schwehr at gmail.com  Thu Nov 19 11:22:58 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 19 Nov 2015 11:22:58 -0800
Subject: [gdal-dev] Making a small(er) test netcdf from a netcdf with
	subdatasets?
Message-ID: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>

Also asked here:
http://gis.stackexchange.com/questions/170882/how-can-a-make-a-netcdf-with-subgroups-smaller

Is there an easy way to make a netcdf with subdatasets but shrink it
without resorting to C or Fortan?

I'm trying to write a test for code that works with hycom netcdf global
ocean circulation data. The source file 2 subdatasets:

gdalinfo hycom_glb_911_2015110200_t000_uv3z.nc | grep _NAME
  SUBDATASET_1_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc":water_u
  SUBDATASET_2_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc":water_v
With 40 depth bands:

gdalinfo NETCDF:hycom_glb_911_2015110200_t000_uv3z.nc:water_u | grep
'^Band' | head -3
Band 1 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 2 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 3 Block=4500x1 Type=Int16, ColorInterp=Undefined
I've got some code written the does things like calculate the speed in m/s
from the UV and creates a geotiff, etc. The original files are much too
large for using in unittests. Is there an easy way with gdal, nco or ? to
keep the structure and metadata, but create a much smaller file? I'm open
to dropping all but the first two bands and writing a constant value into
each band + turning on deflate compression.

Trying with GDAL:

gdal_translate --version  # At head -> r31584
GDAL 2.1.0dev, released 2015/99/99

gdal_translate hycom_glb_911_2015110200_t000_uv3z.nc
hycom_glb_911_2015110200_t000_uv3z-try2.nc -of netcdf -co compress=deflate
Input file contains subdatasets. Please, select one of them for reading.
The originals are quite a bit large for tests:

ls -lh hycom_glb_911_2015110200_t000_uv3z.nc
-rw-r----- 1 schwehr group 1.4G Nov 19 09:13
hycom_glb_911_2015110200_t000_uv3z.nc

Thanks,
-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/f6b930ac/attachment.html>

From Julien.Demaria at acri-st.fr  Thu Nov 19 11:56:55 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Thu, 19 Nov 2015 19:56:55 +0000
Subject: [gdal-dev] Making a small(er) test netcdf from a netcdf
	with	subdatasets?
In-Reply-To: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>
References: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>
Message-ID: <3B970FB76033264EB34479EC8A365E1102E733CBF6@vwiexc030.acri.local>

Dear Kurt,

Yes you can do that using ncks from nco by specifying the subset on each dimension:
ncks -d lon,340.0,10.0 -d lat,10.0,20.0 in.nc out.nc
another solution is to do ncdump -h into a file, editing the ascii to reduce dimensions and do ncgen to generate the NetCDF. By default it will fill with fillvalue, but you can also add data at the end in the ascii file.

Using gdal I think it is impossible to keep the exact input structure but I'm not sure 100%.

By the way, do you plan to do other improvements/big refactorings/cleanings in short term on the NetCDF driver? I still plan to finalize this
http://lists.osgeo.org/pipermail/gdal-dev/2015-February/040973.html
I have to add unit tests to finalize this, but I have seen that your recent commits completely break my patches, but this is my fault because I should have done before, but time is missing... :-(

Cheers,
Julien

________________________________
De : gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Kurt Schwehr [schwehr at gmail.com]
Date d'envoi : jeudi 19 novembre 2015 20:22
À : gdal dev
Objet : [gdal-dev] Making a small(er) test netcdf from a netcdf with subdatasets?

Also asked here: http://gis.stackexchange.com/questions/170882/how-can-a-make-a-netcdf-with-subgroups-smaller

Is there an easy way to make a netcdf with subdatasets but shrink it without resorting to C or Fortan?

I'm trying to write a test for code that works with hycom netcdf global ocean circulation data. The source file 2 subdatasets:

gdalinfo hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc> | grep _NAME
  SUBDATASET_1_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>":water_u
  SUBDATASET_2_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>":water_v
With 40 depth bands:

gdalinfo NETCDF:hycom_glb_911_2015110200_t000_uv3z.nc:water_u | grep '^Band' | head -3
Band 1 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 2 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 3 Block=4500x1 Type=Int16, ColorInterp=Undefined
I've got some code written the does things like calculate the speed in m/s from the UV and creates a geotiff, etc. The original files are much too large for using in unittests. Is there an easy way with gdal, nco or ? to keep the structure and metadata, but create a much smaller file? I'm open to dropping all but the first two bands and writing a constant value into each band + turning on deflate compression.

Trying with GDAL:

gdal_translate --version  # At head -> r31584
GDAL 2.1.0dev, released 2015/99/99

gdal_translate hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc> hycom_glb_911_2015110200_t000_uv3z-try2.nc<http://hycom_glb_911_2015110200_t000_uv3z-try2.nc> -of netcdf -co compress=deflate
Input file contains subdatasets. Please, select one of them for reading.
The originals are quite a bit large for tests:

ls -lh hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>
-rw-r----- 1 schwehr group 1.4G Nov 19 09:13 hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>

Thanks,
-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/08aab6b9/attachment.html>

From schwehr at gmail.com  Thu Nov 19 12:10:30 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 19 Nov 2015 12:10:30 -0800
Subject: [gdal-dev] Making a small(er) test netcdf from a netcdf with
	subdatasets?
In-Reply-To: <3B970FB76033264EB34479EC8A365E1102E733CBF6@vwiexc030.acri.local>
References: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>
 <3B970FB76033264EB34479EC8A365E1102E733CBF6@vwiexc030.acri.local>
Message-ID: <CACmBxys5mqs9ppHQ7TMjgQcv7-1fjZcP7O-Br1BVTFGvxsJUVQ@mail.gmail.com>

Julien,

Bummer that I broke you patches.  I don't expect to do much more in frmts
for a while.  My big sprint is done and I will likely only do a couple
hours each Friday.  My focus will likely be finishing ports/ and working on
gcore and then ogr.

Here is what I currently have based on comments from gis stack exchange. In
my case, I sadly can't use your lon/lat bounds shrinking as need to test my
code that shifts the data from 0..360 to -180..180.

ncks -4 --deflate 9 -v water_u,water_v -d depth,1,2,1
hycom_glb_911_2015110200_t000_uv3z.nc out.nc

That takes 1.4GB down to 33MB.

-kurt

On Thu, Nov 19, 2015 at 11:56 AM, Julien Demaria <Julien.Demaria at acri-st.fr>
wrote:

> Dear Kurt,
>
> Yes you can do that using ncks from nco by specifying the subset on each
> dimension:
> ncks -d lon,340.0,10.0 -d lat,10.0,20.0 in.nc out.nc
> another solution is to do ncdump -h into a file, editing the ascii to
> reduce dimensions and do ncgen to generate the NetCDF. By default it will
> fill with fillvalue, but you can also add data at the end in the ascii file.
>
> Using gdal I think it is impossible to keep the exact input structure but
> I'm not sure 100%.
>
> By the way, do you plan to do other improvements/big
> refactorings/cleanings in short term on the NetCDF driver? I still plan to
> finalize this
> http://lists.osgeo.org/pipermail/gdal-dev/2015-February/040973.html
> I have to add unit tests to finalize this, but I have seen that your
> recent commits completely break my patches, but this is my fault because I
> should have done before, but time is missing... :-(
>
> Cheers,
> Julien
>
> ------------------------------
> *De :* gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Kurt
> Schwehr [schwehr at gmail.com]
> *Date d'envoi :* jeudi 19 novembre 2015 20:22
> *À :* gdal dev
> *Objet :* [gdal-dev] Making a small(er) test netcdf from a netcdf with
> subdatasets?
>
> Also asked here:
> http://gis.stackexchange.com/questions/170882/how-can-a-make-a-netcdf-with-subgroups-smaller
>
> Is there an easy way to make a netcdf with subdatasets but shrink it
> without resorting to C or Fortan?
>
> I'm trying to write a test for code that works with hycom netcdf global
> ocean circulation data. The source file 2 subdatasets:
>
> gdalinfo hycom_glb_911_2015110200_t000_uv3z.nc | grep _NAME
>   SUBDATASET_1_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc":water_u
>   SUBDATASET_2_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc":water_v
> With 40 depth bands:
>
> gdalinfo NETCDF:hycom_glb_911_2015110200_t000_uv3z.nc:water_u | grep
> '^Band' | head -3
> Band 1 Block=4500x1 Type=Int16, ColorInterp=Undefined
> Band 2 Block=4500x1 Type=Int16, ColorInterp=Undefined
> Band 3 Block=4500x1 Type=Int16, ColorInterp=Undefined
> I've got some code written the does things like calculate the speed in m/s
> from the UV and creates a geotiff, etc. The original files are much too
> large for using in unittests. Is there an easy way with gdal, nco or ? to
> keep the structure and metadata, but create a much smaller file? I'm open
> to dropping all but the first two bands and writing a constant value into
> each band + turning on deflate compression.
>
> Trying with GDAL:
>
> gdal_translate --version  # At head -> r31584
> GDAL 2.1.0dev, released 2015/99/99
>
> gdal_translate hycom_glb_911_2015110200_t000_uv3z.nc
> hycom_glb_911_2015110200_t000_uv3z-try2.nc -of netcdf -co compress=deflate
> Input file contains subdatasets. Please, select one of them for reading.
> The originals are quite a bit large for tests:
>
> ls -lh hycom_glb_911_2015110200_t000_uv3z.nc
> -rw-r----- 1 schwehr group 1.4G Nov 19 09:13
> hycom_glb_911_2015110200_t000_uv3z.nc
>
> Thanks,
> -kurt
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/77ede6d8/attachment.html>

From Julien.Demaria at acri-st.fr  Thu Nov 19 12:22:02 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Thu, 19 Nov 2015 20:22:02 +0000
Subject: [gdal-dev] Making a small(er) test netcdf from a netcdf with
 subdatasets?
In-Reply-To: <CACmBxys5mqs9ppHQ7TMjgQcv7-1fjZcP7O-Br1BVTFGvxsJUVQ@mail.gmail.com>
References: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>
 <3B970FB76033264EB34479EC8A365E1102E733CBF6@vwiexc030.acri.local>,
 <CACmBxys5mqs9ppHQ7TMjgQcv7-1fjZcP7O-Br1BVTFGvxsJUVQ@mail.gmail.com>
Message-ID: <3B970FB76033264EB34479EC8A365E1102E733CC1B@vwiexc030.acri.local>

If you want to reduce again your file you should be able to keep 0..360 but change the step by decimating: -d lon,0,360,10 for example to keep only 37 longitudes.
http://research.jisao.washington.edu/data_sets/nco/#example10

Julien

________________________________
De : Kurt Schwehr [schwehr at gmail.com]
Date d'envoi : jeudi 19 novembre 2015 21:10
À : Julien Demaria
Cc : gdal dev
Objet : Re: RE : [gdal-dev] Making a small(er) test netcdf from a netcdf with subdatasets?

Julien,

Bummer that I broke you patches.  I don't expect to do much more in frmts for a while.  My big sprint is done and I will likely only do a couple hours each Friday.  My focus will likely be finishing ports/ and working on gcore and then ogr.

Here is what I currently have based on comments from gis stack exchange. In my case, I sadly can't use your lon/lat bounds shrinking as need to test my code that shifts the data from 0..360 to -180..180.

ncks -4 --deflate 9 -v water_u,water_v -d depth,1,2,1 hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc> out.nc<http://out.nc>

That takes 1.4GB down to 33MB.

-kurt

On Thu, Nov 19, 2015 at 11:56 AM, Julien Demaria <Julien.Demaria at acri-st.fr<mailto:Julien.Demaria at acri-st.fr>> wrote:
Dear Kurt,

Yes you can do that using ncks from nco by specifying the subset on each dimension:
ncks -d lon,340.0,10.0 -d lat,10.0,20.0 in.nc<http://in.nc> out.nc<http://out.nc>
another solution is to do ncdump -h into a file, editing the ascii to reduce dimensions and do ncgen to generate the NetCDF. By default it will fill with fillvalue, but you can also add data at the end in the ascii file.

Using gdal I think it is impossible to keep the exact input structure but I'm not sure 100%.

By the way, do you plan to do other improvements/big refactorings/cleanings in short term on the NetCDF driver? I still plan to finalize this
http://lists.osgeo.org/pipermail/gdal-dev/2015-February/040973.html
I have to add unit tests to finalize this, but I have seen that your recent commits completely break my patches, but this is my fault because I should have done before, but time is missing... :-(

Cheers,
Julien

________________________________
De : gdal-dev [gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>] de la part de Kurt Schwehr [schwehr at gmail.com<mailto:schwehr at gmail.com>]
Date d'envoi : jeudi 19 novembre 2015 20:22
À : gdal dev
Objet : [gdal-dev] Making a small(er) test netcdf from a netcdf with subdatasets?

Also asked here: http://gis.stackexchange.com/questions/170882/how-can-a-make-a-netcdf-with-subgroups-smaller

Is there an easy way to make a netcdf with subdatasets but shrink it without resorting to C or Fortan?

I'm trying to write a test for code that works with hycom netcdf global ocean circulation data. The source file 2 subdatasets:

gdalinfo hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc> | grep _NAME
  SUBDATASET_1_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>":water_u
  SUBDATASET_2_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>":water_v
With 40 depth bands:

gdalinfo NETCDF:hycom_glb_911_2015110200<tel:2015110200>_t000_uv3z.nc:water_u | grep '^Band' | head -3
Band 1 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 2 Block=4500x1 Type=Int16, ColorInterp=Undefined
Band 3 Block=4500x1 Type=Int16, ColorInterp=Undefined
I've got some code written the does things like calculate the speed in m/s from the UV and creates a geotiff, etc. The original files are much too large for using in unittests. Is there an easy way with gdal, nco or ? to keep the structure and metadata, but create a much smaller file? I'm open to dropping all but the first two bands and writing a constant value into each band + turning on deflate compression.

Trying with GDAL:

gdal_translate --version  # At head -> r31584
GDAL 2.1.0dev, released 2015/99/99

gdal_translate hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc> hycom_glb_911_2015110200_t000_uv3z-try2.nc<http://hycom_glb_911_2015110200_t000_uv3z-try2.nc> -of netcdf -co compress=deflate
Input file contains subdatasets. Please, select one of them for reading.
The originals are quite a bit large for tests:

ls -lh hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>
-rw-r----- 1 schwehr group 1.4G Nov 19 09:13 hycom_glb_911_2015110200_t000_uv3z.nc<http://hycom_glb_911_2015110200_t000_uv3z.nc>

Thanks,
-kurt



--
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/a5557030/attachment-0001.html>

From schwehr at gmail.com  Thu Nov 19 12:31:40 2015
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 19 Nov 2015 12:31:40 -0800
Subject: [gdal-dev] Making a small(er) test netcdf from a netcdf with
 subdatasets?
In-Reply-To: <3B970FB76033264EB34479EC8A365E1102E733CC1B@vwiexc030.acri.local>
References: <CACmBxysM+ZzuBoeCrZM7VU3aUe_dtGYjF9COk5__y868VoeWCA@mail.gmail.com>
 <3B970FB76033264EB34479EC8A365E1102E733CBF6@vwiexc030.acri.local>
 <CACmBxys5mqs9ppHQ7TMjgQcv7-1fjZcP7O-Br1BVTFGvxsJUVQ@mail.gmail.com>
 <3B970FB76033264EB34479EC8A365E1102E733CC1B@vwiexc030.acri.local>
Message-ID: <CACmBxysExx52DGVkhB-sY9+9WY+KficPGptYhyfib5Dckh6TYA@mail.gmail.com>

Thanks!  That gets it down to 268K!

ncks -4 --deflate 9 -v water_u,water_v -d depth,1,2,1 -d lon,0,360,10
hycom_glb_911_2015110200_t000_uv3z.nc out4.nc

On Thu, Nov 19, 2015 at 12:22 PM, Julien Demaria <Julien.Demaria at acri-st.fr>
wrote:

> If you want to reduce again your file you should be able to keep 0..360
> but change the step by decimating: -d lon,0,360,10 for example to keep only
> 37 longitudes.
> http://research.jisao.washington.edu/data_sets/nco/#example10
>
> Julien
>
> ------------------------------
> *De :* Kurt Schwehr [schwehr at gmail.com]
> *Date d'envoi :* jeudi 19 novembre 2015 21:10
> *À :* Julien Demaria
> *Cc :* gdal dev
> *Objet :* Re: RE : [gdal-dev] Making a small(er) test netcdf from a
> netcdf with subdatasets?
>
> Julien,
>
> Bummer that I broke you patches.  I don't expect to do much more in frmts
> for a while.  My big sprint is done and I will likely only do a couple
> hours each Friday.  My focus will likely be finishing ports/ and working on
> gcore and then ogr.
>
> Here is what I currently have based on comments from gis stack exchange.
> In my case, I sadly can't use your lon/lat bounds shrinking as need to test
> my code that shifts the data from 0..360 to -180..180.
>
> ncks -4 --deflate 9 -v water_u,water_v -d depth,1,2,1
> hycom_glb_911_2015110200_t000_uv3z.nc out.nc
>
> That takes 1.4GB down to 33MB.
>
> -kurt
>
> On Thu, Nov 19, 2015 at 11:56 AM, Julien Demaria <
> Julien.Demaria at acri-st.fr> wrote:
>
>> Dear Kurt,
>>
>> Yes you can do that using ncks from nco by specifying the subset on each
>> dimension:
>> ncks -d lon,340.0,10.0 -d lat,10.0,20.0 in.nc out.nc
>> another solution is to do ncdump -h into a file, editing the ascii to
>> reduce dimensions and do ncgen to generate the NetCDF. By default it will
>> fill with fillvalue, but you can also add data at the end in the ascii file.
>>
>> Using gdal I think it is impossible to keep the exact input structure but
>> I'm not sure 100%.
>>
>> By the way, do you plan to do other improvements/big
>> refactorings/cleanings in short term on the NetCDF driver? I still plan to
>> finalize this
>> http://lists.osgeo.org/pipermail/gdal-dev/2015-February/040973.html
>> I have to add unit tests to finalize this, but I have seen that your
>> recent commits completely break my patches, but this is my fault because I
>> should have done before, but time is missing... :-(
>>
>> Cheers,
>> Julien
>>
>> ------------------------------
>> *De :* gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Kurt
>> Schwehr [schwehr at gmail.com]
>> *Date d'envoi :* jeudi 19 novembre 2015 20:22
>> *À :* gdal dev
>> *Objet :* [gdal-dev] Making a small(er) test netcdf from a netcdf with
>> subdatasets?
>>
>> Also asked here:
>> http://gis.stackexchange.com/questions/170882/how-can-a-make-a-netcdf-with-subgroups-smaller
>>
>> Is there an easy way to make a netcdf with subdatasets but shrink it
>> without resorting to C or Fortan?
>>
>> I'm trying to write a test for code that works with hycom netcdf global
>> ocean circulation data. The source file 2 subdatasets:
>>
>> gdalinfo hycom_glb_911_2015110200_t000_uv3z.nc | grep _NAME
>>   SUBDATASET_1_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc
>> ":water_u
>>   SUBDATASET_2_NAME=NETCDF:"hycom_glb_911_2015110200_t000_uv3z.nc
>> ":water_v
>> With 40 depth bands:
>>
>> gdalinfo NETCDF:hycom_glb_911_2015110200_t000_uv3z.nc:water_u | grep
>> '^Band' | head -3
>> Band 1 Block=4500x1 Type=Int16, ColorInterp=Undefined
>> Band 2 Block=4500x1 Type=Int16, ColorInterp=Undefined
>> Band 3 Block=4500x1 Type=Int16, ColorInterp=Undefined
>> I've got some code written the does things like calculate the speed in
>> m/s from the UV and creates a geotiff, etc. The original files are much too
>> large for using in unittests. Is there an easy way with gdal, nco or ? to
>> keep the structure and metadata, but create a much smaller file? I'm open
>> to dropping all but the first two bands and writing a constant value into
>> each band + turning on deflate compression.
>>
>> Trying with GDAL:
>>
>> gdal_translate --version  # At head -> r31584
>> GDAL 2.1.0dev, released 2015/99/99
>>
>> gdal_translate hycom_glb_911_2015110200_t000_uv3z.nc
>> hycom_glb_911_2015110200_t000_uv3z-try2.nc -of netcdf -co
>> compress=deflate
>> Input file contains subdatasets. Please, select one of them for reading.
>> The originals are quite a bit large for tests:
>>
>> ls -lh hycom_glb_911_2015110200_t000_uv3z.nc
>> -rw-r----- 1 schwehr group 1.4G Nov 19 09:13
>> hycom_glb_911_2015110200_t000_uv3z.nc
>>
>> Thanks,
>> -kurt
>>
>
>
>
> --
> --
> http://schwehr.org
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151119/5d81d728/attachment.html>

From landa.martin at gmail.com  Fri Nov 20 05:20:55 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 20 Nov 2015 14:20:55 +0100
Subject: [gdal-dev] unable to open DGN
Message-ID: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>

Hi,

I am trying to open sample DGN file, but it fails. I guess that the
reason is unsupported version (man pages says: Microstation DGN files
from Microstation versions predating version 8.0 are supported for
reading.)

$ file /work/geodata/14_CHU_8.dgn
/work/geodata/14_CHU_8.dgn: Composite Document File V2 Document,
Little Endian, Os: Windows, Version 5.1, Code page: 1200, Locale ID:
1029, Total Editing Time: 00:01, Create Time/Date: Sat Nov  1 14:16:23
2014, Author: coufal, Last Saved By: Coufal, Last Saved Time/Date: Sun
Nov  2 15:20:04 2014, Revision Number: 6, Name of Creating
Application: MicroStation v8.9.3.68, Last Printed: Sun Nov  2 10:36:59
2014

Is there any possibility how to read this file using GDAL library?

Thanks! Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From hellik at web.de  Fri Nov 20 12:43:23 2015
From: hellik at web.de (Helmut Kudrnovsky)
Date: Fri, 20 Nov 2015 12:43:23 -0800 (PST)
Subject: [gdal-dev] how correctly to use the -where parameter in ogr2ogr
Message-ID: <1448052203676-5237738.post@n6.nabble.com>

hi,

maybe a too simple question...

given the natural earth data ne_10m_admin_0_countries.shp, I want to
reproject from EPSG 4326 to EPSG 3035, but only the europe countries.

in the shapefile there is a coloumn called CONTINENT with content like e.g.
Europe, Asia etc.

trying this command

ogr2ogr -s_srs EPSG:4326 -t_srs EPSG:3035 -where 'CONTINENT = "Europe"'
ne_10m_admin_0_countries_europe_epsg3035.shp ne_10m_admin_0_countries.shp
FAILURE:
Unable to open datasource `Europe'' with the following drivers.

any hints?

it's in OSGeo4W ogrinfo --version GDAL 1.11.3, released 2015/09/16

thanks






-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/how-correctly-to-use-the-where-parameter-in-ogr2ogr-tp5237738.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hellik at web.de  Fri Nov 20 12:51:43 2015
From: hellik at web.de (Helmut Kudrnovsky)
Date: Fri, 20 Nov 2015 12:51:43 -0800 (PST)
Subject: [gdal-dev] how correctly to use the -where parameter in ogr2ogr
In-Reply-To: <1448052203676-5237738.post@n6.nabble.com>
References: <1448052203676-5237738.post@n6.nabble.com>
Message-ID: <1448052703694-5237739.post@n6.nabble.com>

Helmut Kudrnovsky wrote
> hi,
> 
> maybe a too simple question...
> 
> given the natural earth data ne_10m_admin_0_countries.shp, I want to
> reproject from EPSG 4326 to EPSG 3035, but only the europe countries.
> 
> in the shapefile there is a coloumn called CONTINENT with content like
> e.g. Europe, Asia etc.
> 
> trying this command
> 
> ogr2ogr -s_srs EPSG:4326 -t_srs EPSG:3035 -where 'CONTINENT = "Europe"'
> ne_10m_admin_0_countries_europe_epsg3035.shp ne_10m_admin_0_countries.shp
> FAILURE:
> Unable to open datasource `Europe'' with the following drivers.
> 
> any hints?

to answer my own question, it's just changing around the quotes:

ogr2ogr -s_srs EPSG:4326 -t_srs EPSG:3035 -where "CONTINENT = 'Europe'"
ne_10m_admin_0_countries_europe_epsg3035.shp ne_10m_admin_0_countries.shp

sorry for the noise.




-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/how-correctly-to-use-the-where-parameter-in-ogr2ogr-tp5237738p5237739.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hrijsdijk at gmail.com  Fri Nov 20 13:13:13 2015
From: hrijsdijk at gmail.com (Hans Rijsdijk)
Date: Sat, 21 Nov 2015 08:13:13 +1100
Subject: [gdal-dev] Reading DNC nautical charts
Message-ID: <751A0DA1-1710-4F27-B490-D71FD02C064F@gmail.com>

Can anyone advise if DNC nautical charts can be used on the gdal software and, if so even better with a gps? In other words for navigation.
I am not familiar with gdal software so a 'fatherly' response will be greatly appreciated.

Cheers

Hans

From even.rouault at spatialys.com  Fri Nov 20 13:35:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Nov 2015 22:35:31 +0100
Subject: [gdal-dev] Proposed Block iterator API
Message-ID: <201511202235.31761.even.rouault@spatialys.com>

Hi,

I was wondering if there wasn't a need for a block iterator API for code that 
wants to process raster efficiently and iterates over blocks from top to bottom, 
and left to write. Currently you have to create 2 for loops and deal with 
partial blocks at edges (see 
https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/rasterio.cpp#L3576). 
Nothing really fundamentaly complicated, but I guess people have to often 
write that boring code and I'm sure there a lot of occurences of it inside 
GDAL itself. The API just returns the coordinates of the window, but doesn't 
do the pixel queries (people could use it to operate on a single band, or 
multiple bands)

An example on how to use the API is :

int main(int argc, char* argv[])
{
    GDALAllRegister();
    GDALDatasetH hDS = GDALOpen(argv[1], GA_ReadOnly);
    GDALBlockIteratorH hIter = GDALCreateBlockIterator(
                                                  GDALGetRasterBand(hDS, 1));
    int nXOff, nYOff, nXSize, nYSize;
    while( GDALBlockIteratorGetNext(hIter, &nXOff, &nYOff, &nXSize, &nYSize) )
    {
        double dfProgressStart, dfProgressEnd;
        dfProgressStart = GDALBlockIteratorGetProgress(hIter, &dfProgressEnd);
        printf("nXOff=%d nYOff=%d nXSize=%d nYSize=%d [%.2f->%.2f]\n",
               nXOff, nYOff, nXSize, nYSize, dfProgressStart, dfProgressEnd);
    }
    GDALDestroyBlockIterator(hIter);
    GDALClose(hDS);
    return 0;
}

And if you run it on a 20x20 raster with blocks of size 16x16, it will 
display:

nXOff=0 nYOff=0 nXSize=16 nYSize=16 [0.00->64.00]
nXOff=16 nYOff=0 nXSize=4 nYSize=16 [64.00->80.00]
nXOff=0 nYOff=16 nXSize=16 nYSize=4 [80.00->96.00]
nXOff=16 nYOff=16 nXSize=4 nYSize=4 [96.00->100.00]:

Thoughts ?

Best regards,

Even



PS: below the API and its implementation

#include <gdal_priv.h>

/* API */
CPL_C_START
typedef struct GDALBlockIterator *GDALBlockIteratorH;

GDALBlockIteratorH CPL_DLL GDALCreateBlockIterator(GDALRasterBandH hBand);
void CPL_DLL GDALDestroyBlockIterator(GDALBlockIteratorH hIter);
int CPL_DLL GDALBlockIteratorGetMaxXSize(GDALBlockIteratorH hIter);
int CPL_DLL GDALBlockIteratorGetMaxYSize(GDALBlockIteratorH hIter);
void GDALBlockIteratorSetBlockSize(GDALBlockIterator* poIter, int nBlockWidth, 
int nBlockHeight);
int CPL_DLL GDALBlockIteratorGetNext(GDALBlockIteratorH hIter,
                                     int* pnXOff,
                                     int* pnYOff,
                                     int* pnXSize,
                                     int* pnYSize);
double CPL_DLL GDALBlockIteratorGetProgress(GDALBlockIteratorH hIter, double* 
pdfNextProgress);
CPL_C_END

/* Impl */
struct GDALBlockIterator
{
    int nXSize;
    int nYSize;
    int nXOff;
    int nYOff;
    int nBlockWidth;
    int nBlockHeight;
    bool bFinished;
};
typedef struct GDALBlockIterator GDALBlockIterator;


GDALBlockIterator* GDALCreateBlockIterator(GDALRasterBandH hBand)
{
    GDALRasterBand* poBand = (GDALRasterBand*)hBand;
    GDALBlockIterator* poIter = new GDALBlockIterator;
    poIter->nXSize = poBand->GetXSize();
    poIter->nYSize = poBand->GetYSize();
    poBand->GetBlockSize( &(poIter->nBlockWidth), &(poIter->nBlockHeight) );
    poIter->nXOff = -1;
    poIter->nYOff = 0;
    poIter->bFinished = false;
    return poIter;
}

void GDALDestroyBlockIterator(GDALBlockIteratorH hIter)
{
    delete hIter;
}

int GDALBlockIteratorGetMaxXSize(GDALBlockIterator* poIter)
{
    return poIter->nBlockWidth;
}

int GDALBlockIteratorGetMaxYSize(GDALBlockIterator* poIter)
{
    return poIter->nBlockHeight;
}

void GDALBlockIteratorSetBlockSize(GDALBlockIterator* poIter, int nBlockWidth, 
int nBlockHeight)
{
    poIter->nBlockWidth = nBlockWidth;
    poIter->nBlockHeight = nBlockHeight;
}

int GDALBlockIteratorGetNext(GDALBlockIterator* poIter,
                             int* pnXOff,
                             int* pnYOff,
                             int* pnXSize,
                             int* pnYSize)
{
    if( poIter->bFinished )
        return FALSE;

    if( poIter->nXOff < 0 )
        poIter->nXOff = 0;
    else
        poIter->nXOff += poIter->nBlockWidth;
    if( poIter->nXOff >= poIter->nXSize )
    {
        poIter->nXOff = 0;
        poIter->nYOff += poIter->nBlockHeight;
        if( poIter->nYOff >= poIter->nYSize )
        {
            poIter->bFinished = true;
            return FALSE;
        }
    }

    if( pnXOff )
        *pnXOff = poIter->nXOff;
    if( pnYOff )
        *pnYOff = poIter->nYOff;
    if( pnXSize )
    {
        *pnXSize = poIter->nBlockWidth;
        if( poIter->nXOff + poIter->nBlockWidth >= poIter->nXSize )
        {
            *pnXSize = poIter->nXSize - poIter->nXOff;
        }
    }
    if( pnYSize )
    {
        *pnYSize = poIter->nBlockHeight;
        if(poIter->nYOff + poIter->nBlockHeight >= poIter->nYSize )
        {
            *pnYSize = poIter->nYSize - poIter->nYOff;
        }
    }
    return TRUE;
}

double GDALBlockIteratorGetProgress(GDALBlockIterator* poIter, double* 
pdfNextProgress)
{
    if( poIter->bFinished )
    {
        if( pdfNextProgress != NULL )
            *pdfNextProgress = 100.0;
        return 100.0;
    }

    int nBlockHeight = poIter->nBlockHeight;
    if( poIter->nYOff + nBlockHeight > poIter->nYSize )
        nBlockHeight = poIter->nYSize - poIter->nYOff;
    double dfProcessedPixels = (double)poIter->nYOff * poIter->nXSize + poIter-
>nXOff * nBlockHeight;
    double dfRet = 100.0 * dfProcessedPixels / poIter->nXSize / poIter-
>nYSize;
    if( pdfNextProgress != NULL )
    {
        GDALBlockIterator sIterDup = *poIter;
        GDALBlockIteratorGetNext(&sIterDup, NULL, NULL, NULL, NULL);
        *pdfNextProgress = GDALBlockIteratorGetProgress(&sIterDup, NULL);
    }
    return dfRet;
}

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bradh at frogmouth.net  Fri Nov 20 13:40:03 2015
From: bradh at frogmouth.net (Brad Hards)
Date: Sat, 21 Nov 2015 08:40:03 +1100
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
Message-ID: <2825798.kcKSA5Ro2e@saxicola>

On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
> I am trying to open sample DGN file, but it fails. I guess that the
> reason is unsupported version (man pages says: Microstation DGN files
> from Microstation versions predating version 8.0 are supported for
> reading.)
As I understand it, version 8 is completely different.

> Is there any possibility how to read this file using GDAL library?
AFAICT, not unless you figure out version 8 format and implement it, or pay 
someone to do that work for you. Is it possibly to get the originator to 
provide it in some other format (e.g. DXF, noting that will lose the 
georeferencing)?

Brad

From nicolas.cadieux at archeotec.ca  Sat Nov 21 21:48:54 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sun, 22 Nov 2015 00:48:54 -0500
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <751A0DA1-1710-4F27-B490-D71FD02C064F@gmail.com>
Message-ID: <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>

Hi,

If you have a link to the charts, I could look at it and see the format and see if they are georeferenced (if coordinates like longitude and latitudes is included in the image file).  They should be.  If so, I would recommend you use a GIS software like QGIS to visualise the maps  and manipulate the map.  QGIS has plugins that will permit you to plug in a GPS and to track the movement for navigation.

 QGIS uses the GDAL library to open, save and manipulate maps images (rasters)  and point, line and polygons (vector data) so you get all the power of GDAL and a user friendly interface.

Nicolas Cadieux M.Sc.
Les Entreprises Archéotec inc. 
8548, rue Saint-Denis Montréal H2P 2H2
Téléphone: 514.381.5112  Fax: 514.381.4995
www.archeotec.ca

On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com> wrote:
>
> Can anyone advise if DNC nautical charts can be used on the gdal software and, if so even better with a gps? In other words for navigation.
> I am not familiar with gdal software so a 'fatherly' response will be greatly appreciated.
>
> Cheers
>
> Hans
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From damian.dixon at gmail.com  Sat Nov 21 22:47:15 2015
From: damian.dixon at gmail.com (Damian Dixon)
Date: Sun, 22 Nov 2015 06:47:15 +0000
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>
References: <751A0DA1-1710-4F27-B490-D71FD02C064F@gmail.com>
 <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>
Message-ID: <CAJjdW1ycbF3HBmEW=URjs2zj33LomwNFGBZj7Z1y-=gRP1JNiA@mail.gmail.com>

Hi,

DNC is based on VPF format.

http://msi.nga.mil/NGAPortal/DNC.portal;jsessionid=v7pkSThJG9vQcrQ0yTwLxTL1hQmyhGbFJQLZCJTW5dGJJjT0GmJX!1413119135!NONE?_nfpb=true&_st=&_pageLabel=dnc_portal_page_70&faqCode=02

The styling is defined by a different standard as a set of geosym rules.

Regards
Damian
On 22 Nov 2015 05:59, "Nicolas Cadieux" <nicolas.cadieux at archeotec.ca>
wrote:

> Hi,
>
> If you have a link to the charts, I could look at it and see the format
> and see if they are georeferenced (if coordinates like longitude and
> latitudes is included in the image file).  They should be.  If so, I would
> recommend you use a GIS software like QGIS to visualise the maps  and
> manipulate the map.  QGIS has plugins that will permit you to plug in a GPS
> and to track the movement for navigation.
>
>  QGIS uses the GDAL library to open, save and manipulate maps images
> (rasters)  and point, line and polygons (vector data) so you get all the
> power of GDAL and a user friendly interface.
>
> Nicolas Cadieux M.Sc.
> Les Entreprises Archéotec inc.
> 8548, rue Saint-Denis Montréal H2P 2H2
> Téléphone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
>
> On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com> wrote:
> >
> > Can anyone advise if DNC nautical charts can be used on the gdal
> software and, if so even better with a gps? In other words for navigation.
> > I am not familiar with gdal software so a 'fatherly' response will be
> greatly appreciated.
> >
> > Cheers
> >
> > Hans
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/19599019/attachment.html>

From hrijsdijk at gmail.com  Sun Nov 22 01:06:53 2015
From: hrijsdijk at gmail.com (Hans Rijsdijk)
Date: Sun, 22 Nov 2015 20:06:53 +1100
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>
References: <751A0DA1-1710-4F27-B490-D71FD02C064F@gmail.com>
 <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>
Message-ID: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>

Hi,
Here is a link: https://www.nga.mil/ProductsServices/NauticalHydrographicBathymetricProduct/Pages/DigitalNauticalChart.aspx

I have also attached 2 of the charts.

Hope this is useful.

Cheers

Hans




From: Nicolas Cadieux
Sent: Sunday, 22 November 2015 4:49 PM
To: Hans Rijsdijk
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Reading DNC nautical charts


Hi,

If you have a link to the charts, I could look at it and see the format and see if they are georeferenced (if coordinates like longitude and latitudes is included in the image file).  They should be.  If so, I would recommend you use a GIS software like QGIS to visualise the maps  and manipulate the map.  QGIS has plugins that will permit you to plug in a GPS and to track the movement for navigation.

 QGIS uses the GDAL library to open, save and manipulate maps images (rasters)  and point, line and polygons (vector data) so you get all the power of GDAL and a user friendly interface.

Nicolas Cadieux M.Sc.
Les Entreprises Archéotec inc. 
8548, rue Saint-Denis Montréal H2P 2H2
Téléphone: 514.381.5112  Fax: 514.381.4995
www.archeotec.ca

On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com> wrote:
>
> Can anyone advise if DNC nautical charts can be used on the gdal software and, if so even better with a gps? In other words for navigation.
> I am not familiar with gdal software so a 'fatherly' response will be greatly appreciated.
>
> Cheers
>
> Hans
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/b78d7810/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: A0715255.rtp
Type: application/octet-stream
Size: 1692 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/b78d7810/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: A0715290.rtp
Type: application/octet-stream
Size: 647 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/b78d7810/attachment-0001.obj>

From jamessramm at gmail.com  Sun Nov 22 03:27:53 2015
From: jamessramm at gmail.com (jramm)
Date: Sun, 22 Nov 2015 03:27:53 -0800 (PST)
Subject: [gdal-dev] Proposed Block iterator API
In-Reply-To: <201511202235.31761.even.rouault@spatialys.com>
References: <201511202235.31761.even.rouault@spatialys.com>
Message-ID: <1448191673725-5237882.post@n6.nabble.com>

Yes this would be incredibly useful. We typically process >100GB rasters and
so iterating in 'windows' is a must for us. 
We have typically implemented a solution outside of GDAL, with a 'next'
function that looks something like this:

int RasterWindow::next()
{
	static int windowNoX = -1;
	static int windowNoY = 0;

	// Initialise the size of the window read
	curSizeX = windowSize;
	curSizeY = windowSize;

	// Check which window number we are on
	if (((windowNoY + 1) >= nY) && ((windowNoX + 1) >= nX))
	{
		// All windows have been read
		return 1;
	}
	// We have reached the end of a row (x) of windows
	else if ((windowNoX + 1) >= nX)
	{
		windowNoX = 0;
		windowNoY += 1;
	}
	// There are still pixels left on the row...
	else
	{
	windowNoX += 1;
	}

	// Calculate the pixel offsets
	xOff = windowNoX * windowSize;
	yOff = windowNoY * windowSize;

	// Correct the current window size to make sure it won't run off the edge
of the raster
	if (xOff + windowSize > RasterSizeX)
	{
		curSizeX = RasterSizeX - xOff;
	}

	if (yOff + windowSize > RasterSizeY)
	{
		curSizeY = RasterSizeY - yOff;
	}

	return 0;

}
It allows us to read more (or less) than the 'natural' block size (if
necessary) so we can send big lumps of data off for processing on a GPU.

For convenience and completeness, it would be helpful if the GetNext
function would optionally take a buffer which,  if present, would be
populated with the pixel values, negating the need for a line of boiler
plate to read the values. 

Another (possibly?) useful component could be some sort of pixel iterator.
For smaller/non-parallel processes, after reading a block we then loop over
the pixels, often with some boiler plate code to pull out the array indices
for various purposes:

uint32_t i, j, iGlobal, jGlobal;
for(pixelCount = 0 ; pixelCount < nPixels ; pixelCount++)
{
    i = pixelCount % currentWindowSizeX;
    j = (pixelCount - i) / currentWindowSizeX;
    iGlobal = i + nXoff;
    jGlobal = j + nYoff;

}

A further function which would take in the desired block size and handle
reading the blocks, allocating buffers etc behind the scenes and then simply
return individual pixels & indices would be quite interesting.

int GDALBlockIteratorGetNextPixel(GDALBlockIteratorH hIter, void *pixel, int
*i, int *j, int *iGlobal, int *jGlobal);



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Proposed-Block-iterator-API-tp5237743p5237882.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bontepaarden at gmail.com  Sun Nov 22 04:05:06 2015
From: bontepaarden at gmail.com (Paul Meems)
Date: Sun, 22 Nov 2015 13:05:06 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
Message-ID: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>

Hi List,

We're using the GDAL tools in MapWinGIS by copying the source code.
You understand we are very pleased with the librarification of the tools.

At this moment we would like to implement the GdalBuildVrt tool, but it
seems it is not yet librarified. Will this happen soon and thus we can wait
or should we copy the code again?

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*We've started with the development of MapWindow v5. Read more.
<http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/50a5447c/attachment-0001.html>

From even.rouault at spatialys.com  Sun Nov 22 04:15:06 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 22 Nov 2015 13:15:06 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
In-Reply-To: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
References: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
Message-ID: <201511221315.07122.even.rouault@spatialys.com>

Le dimanche 22 novembre 2015 13:05:06, Paul Meems a écrit :
> Hi List,
> 
> We're using the GDAL tools in MapWinGIS by copying the source code.
> You understand we are very pleased with the librarification of the tools.
> 
> At this moment we would like to implement the GdalBuildVrt tool, but it
> seems it is not yet librarified. Will this happen soon and thus we can wait
> or should we copy the code again?

Paul,

I think Faza was willing to tackle that at some point, but maybe not 
immediatly. If it is something you need, you may as well contribute it. There 
are now quite a few librarified utilities to take inspiration on.

Even

> 
> Thanks,
> 
> Paul
> 
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org
> 
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl
> 
> 
> 
> *We've started with the development of MapWindow v5. Read more.
> <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bontepaarden at gmail.com  Sun Nov 22 04:48:37 2015
From: bontepaarden at gmail.com (Paul Meems)
Date: Sun, 22 Nov 2015 13:48:37 +0100
Subject: [gdal-dev] Librarified version of GdalBuildVrt
In-Reply-To: <201511221315.07122.even.rouault@spatialys.com>
References: <CAHNf2YTR1R2zw8CqfDVZLnAGYGYvBB6H4xEVCif-fFe1R92MpA@mail.gmail.com>
 <201511221315.07122.even.rouault@spatialys.com>
Message-ID: <CAHNf2YSP8LOq=tkBDK1yiwh9yXdOsrouN0fLCZTGrzm9YukUjg@mail.gmail.com>

Thanks Even for the reply,

I am not a C++ developer so I need to rely on somebody else to implement
this.
For now I'll ask the C++ developer of the MapWindow project to fix the
implementation we already have for the GdalBuildVrt tool.

Thanks,




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*We've started with the development of MapWindow v5. Read more.
<http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*

2015-11-22 13:15 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Le dimanche 22 novembre 2015 13:05:06, Paul Meems a écrit :
> > Hi List,
> >
> > We're using the GDAL tools in MapWinGIS by copying the source code.
> > You understand we are very pleased with the librarification of the tools.
> >
> > At this moment we would like to implement the GdalBuildVrt tool, but it
> > seems it is not yet librarified. Will this happen soon and thus we can
> wait
> > or should we copy the code again?
>
> Paul,
>
> I think Faza was willing to tackle that at some point, but maybe not
> immediatly. If it is something you need, you may as well contribute it.
> There
> are now quite a few librarified utilities to take inspiration on.
>
> Even
>
> >
> > Thanks,
> >
> > Paul
> >
> > *Paul Meems *
> > Release manager, configuration manager
> > and forum moderator of MapWindow GIS.
> > www.mapwindow.org
> >
> > Owner of MapWindow.nl - Support for
> > Dutch speaking users.
> > www.mapwindow.nl
> >
> >
> >
> > *We've started with the development of MapWindow v5. Read more.
> > <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151122/e5ede3a9/attachment.html>

From woodbri at swoodbridge.com  Sun Nov 22 06:29:12 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 22 Nov 2015 09:29:12 -0500
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
References: <751A0DA1-1710-4F27-B490-D71FD02C064F@gmail.com>
 <f372dab5-c90f-4b0a-8442-132216f34fe5@email.android.com>
 <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
Message-ID: <5651D138.9090008@swoodbridge.com>

It looks like the DNC you are looking at are in Vector Product Format, 
so google "gdal vpf" and you will get some links that might help with that.

-Steve

On 11/22/2015 4:06 AM, Hans Rijsdijk wrote:
> Hi,
>
> Here is a link:
> https://www.nga.mil/ProductsServices/NauticalHydrographicBathymetricProduct/Pages/DigitalNauticalChart.aspx
>
> I have also attached 2 of the charts.
>
> Hope this is useful.
>
> Cheers
>
> Hans
>
>
> *From: *Nicolas Cadieux
> *Sent: *Sunday, 22 November 2015 4:49 PM
> *To: *Hans Rijsdijk
> *Cc: *gdal-dev at lists.osgeo.org
> *Subject: *Re: [gdal-dev] Reading DNC nautical charts
>
> Hi,
>
> If you have a link to the charts, I could look at it and see the format
> and see if they are georeferenced (if coordinates like longitude and
> latitudes is included in the image file).  They should be.  If so, I
> would recommend you use a GIS software like QGIS to visualise the maps
> and manipulate the map.  QGIS has plugins that will permit you to plug
> in a GPS and to track the movement for navigation.
>
> QGIS uses the GDAL library to open, save and manipulate maps images
> (rasters)  and point, line and polygons (vector data) so you get all the
> power of GDAL and a user friendly interface.
>
> Nicolas Cadieux M.Sc.
>
> Les Entreprises Archéotec inc.
>
> 8548, rue Saint-Denis Montréal H2P 2H2
>
> Téléphone: 514.381.5112  Fax: 514.381.4995
>
> www.archeotec.ca
>
> On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com> wrote:
>
>  >
>
>  > Can anyone advise if DNC nautical charts can be used on the gdal
> software and, if so even better with a gps? In other words for navigation.
>
>  > I am not familiar with gdal software so a 'fatherly' response will be
> greatly appreciated.
>
>  >
>
>  > Cheers
>
>  >
>
>  > Hans
>
>  > _______________________________________________
>
>  > gdal-dev mailing list
>
>  > gdal-dev at lists.osgeo.org
>
>  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> ------------------------------------------------------------------------
> Avast logo <https://www.avast.com/antivirus> 	
>
> This email has been checked for viruses by Avast antivirus software.
> www.avast.com <https://www.avast.com/antivirus>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From hrijsdijk at gmail.com  Sun Nov 22 13:14:31 2015
From: hrijsdijk at gmail.com (Hans Rijsdijk)
Date: Mon, 23 Nov 2015 08:14:31 +1100
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <2145966708.7086280.1448188852827.JavaMail.yahoo@mail.yahoo.com>
References: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
 <2145966708.7086280.1448188852827.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <C0A443CA-267D-4CC7-8B4F-D0B29E6E5DFE@gmail.com>

Thanks for your response. 
One can get the DNC charts free off the US website (although they may not make all details available). 
For most of my charts I use OpenCPN, but this doesn't run the DNC charts. 
Any suggestions of other open source marine software?

Cheers

Hans

> On 22 Nov 2015, at 9:40 PM, Brent Wood <pcreso at yahoo.com> wrote:
> 
> I think you'll find the Digital Nautical Chart format is not supported by GDAL.
> 
> However there are open source marine navigational software applications that will read them, but apart from USA & New Zealand, I'm not aware of any countries that provide their charts for free.  
> 
> Brent Wood
> 
> From: Hans Rijsdijk <hrijsdijk at gmail.com>
> To: Nicolas Cadieux <nicolas.cadieux at archeotec.ca> 
> Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Sent: Sunday, November 22, 2015 10:06 PM
> Subject: Re: [gdal-dev] Reading DNC nautical charts
> 
> Hi,
> Here is a link: https://www.nga.mil/ProductsServices/NauticalHydrographicBathymetricProduct/Pages/DigitalNauticalChart.aspx
>  
> I have also attached 2 of the charts.
>  
> Hope this is useful.
>  
> Cheers
>  
> Hans
>  
>  
>  
> 
> 
> 
> From: Nicolas Cadieux
> Sent: Sunday, 22 November 2015 4:49 PM
> To: Hans Rijsdijk
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Reading DNC nautical charts
>  
>  
> Hi,
>  
> If you have a link to the charts, I could look at it and see the format and see if they are georeferenced (if coordinates like longitude and latitudes is included in the image file).  They should be.  If so, I would recommend you use a GIS software like QGIS to visualise the maps  and manipulate the map.  QGIS has plugins that will permit you to plug in a GPS and to track the movement for navigation.
>  
> QGIS uses the GDAL library to open, save and manipulate maps images (rasters)  and point, line and polygons (vector data) so you get all the power of GDAL and a user friendly interface.
>  
> Nicolas Cadieux M.Sc.
> Les Entreprises Archéotec inc. 
> 8548, rue Saint-Denis Montréal H2P 2H2
> Téléphone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
>  
> On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com> wrote:
> >  
> > Can anyone advise if DNC nautical charts can be used on the gdal software and, if so even better with a gps? In other words for navigation.
> > I am not familiar with gdal software so a 'fatherly' response will be greatly appreciated.
> >  
> > Cheers
> >  
> > Hans
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
>  
> 
> 
>   			 			
> This email has been checked for viruses by Avast antivirus software. 
> www.avast.com
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/1443dc9d/attachment.html>

From woodbri at swoodbridge.com  Sun Nov 22 13:59:35 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Sun, 22 Nov 2015 16:59:35 -0500
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <C0A443CA-267D-4CC7-8B4F-D0B29E6E5DFE@gmail.com>
References: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
 <2145966708.7086280.1448188852827.JavaMail.yahoo@mail.yahoo.com>
 <C0A443CA-267D-4CC7-8B4F-D0B29E6E5DFE@gmail.com>
Message-ID: <56523AC7.7070000@swoodbridge.com>

There are two version of Nautical charts from what I can see:

1. DNC from www.nga.mil that you pointed at in VPF format
2. NOAA ENC charts

Here is a link explaining the difference:
http://www.nauticalcharts.noaa.gov/mcd/learn_diffENC_DNC.html

The ENC charts are available in S57 format and maybe as shapefiles. I 
played with the ENC charts a while ago with some success.

I thought OGR supported reading VPF files for VMAP0 data using (OGDI 
Vectors (VPF, VMAP, DCW)). But I have no idea if it would work for DNC data.

You might be able to read these with openmap.bbn.com
http://openmap.bbn.com/doc/OpenMapDevGuide.pdf
see section 8.5

-Steve

On 11/22/2015 4:14 PM, Hans Rijsdijk wrote:
> Thanks for your response.
> One can get the DNC charts free off the US website (although they may
> not make all details available).
> For most of my charts I use OpenCPN, but this doesn't run the DNC charts.
> Any suggestions of other open source marine software?
>
> Cheers
>
> Hans
>
> On 22 Nov 2015, at 9:40 PM, Brent Wood <pcreso at yahoo.com
> <mailto:pcreso at yahoo.com>> wrote:
>
>> I think you'll find the Digital Nautical Chart format is not supported
>> by GDAL.
>>
>> However there are open source marine navigational software
>> applications that will read them, but apart from USA & New Zealand,
>> I'm not aware of any countries that provide their charts for free.
>>
>> Brent Wood
>>
>> ------------------------------------------------------------------------
>> *From:* Hans Rijsdijk <hrijsdijk at gmail.com <mailto:hrijsdijk at gmail.com>>
>> *To:* Nicolas Cadieux <nicolas.cadieux at archeotec.ca
>> <mailto:nicolas.cadieux at archeotec.ca>>
>> *Cc:* "gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>"
>> <gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>>
>> *Sent:* Sunday, November 22, 2015 10:06 PM
>> *Subject:* Re: [gdal-dev] Reading DNC nautical charts
>>
>> Hi,
>> Here is a link:
>> https://www.nga.mil/ProductsServices/NauticalHydrographicBathymetricProduct/Pages/DigitalNauticalChart.aspx
>> I have also attached 2 of the charts.
>> Hope this is useful.
>> Cheers
>> Hans
>>
>>
>>
>> *From: *Nicolas Cadieux
>> *Sent: *Sunday, 22 November 2015 4:49 PM
>> *To: *Hans Rijsdijk
>> *Cc: *gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> *Subject: *Re: [gdal-dev] Reading DNC nautical charts
>> Hi,
>> If you have a link to the charts, I could look at it and see the
>> format and see if they are georeferenced (if coordinates like
>> longitude and latitudes is included in the image file).  They should
>> be.  If so, I would recommend you use a GIS software like QGIS to
>> visualise the maps  and manipulate the map.  QGIS has plugins that
>> will permit you to plug in a GPS and to track the movement for navigation.
>> QGIS uses the GDAL library to open, save and manipulate maps images
>> (rasters)  and point, line and polygons (vector data) so you get all
>> the power of GDAL and a user friendly interface.
>> Nicolas Cadieux M.Sc.
>> Les Entreprises Archéotec inc.
>> 8548, rue Saint-Denis Montréal H2P 2H2
>> Téléphone: 514.381.5112  Fax: 514.381.4995
>> www.archeotec.ca <http://www.archeotec.ca>
>> On Nov 20, 2015 4:13 PM, Hans Rijsdijk <hrijsdijk at gmail.com
>> <mailto:hrijsdijk at gmail.com>> wrote:
>> >
>> > Can anyone advise if DNC nautical charts can be used on the gdal
>> software and, if so even better with a gps? In other words for navigation.
>> > I am not familiar with gdal software so a 'fatherly' response will
>> be greatly appreciated.
>> >
>> > Cheers
>> >
>> > Hans
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>> ------------------------------------------------------------------------
>> Avast logo <https://www.avast.com/antivirus> 	
>> This email has been checked for viruses by Avast antivirus software.
>> www.avast.com <https://www.avast.com/antivirus>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From tpiepho at gmail.com  Sun Nov 22 15:19:28 2015
From: tpiepho at gmail.com (Trent Piepho)
Date: Sun, 22 Nov 2015 15:19:28 -0800
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <56523AC7.7070000@swoodbridge.com>
References: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
 <2145966708.7086280.1448188852827.JavaMail.yahoo@mail.yahoo.com>
 <C0A443CA-267D-4CC7-8B4F-D0B29E6E5DFE@gmail.com>
 <56523AC7.7070000@swoodbridge.com>
Message-ID: <CA+7tXig=2V0KjswSvZqHAMQfsACJp3e+=dgWa3xrWq0Zp_mu8w@mail.gmail.com>

On Sun, Nov 22, 2015 at 1:59 PM, Stephen Woodbridge
<woodbri at swoodbridge.com> wrote:
> There are two version of Nautical charts from what I can see:
>
> 1. DNC from www.nga.mil that you pointed at in VPF format
> 2. NOAA ENC charts

NOAA also provides RNC charts in BSB format.  GDAL can read them too.
I've used it with qlandkarte GT for looking at tracks of sailing races
on NOAA charts.  I did have to enhance the GDAL BSB support and
qlandkarte to get it to work with more than a handful of NOAA's
charts.

From even.rouault at spatialys.com  Sun Nov 22 15:23:06 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2015 00:23:06 +0100
Subject: [gdal-dev] Reading DNC nautical charts
In-Reply-To: <CA+7tXig=2V0KjswSvZqHAMQfsACJp3e+=dgWa3xrWq0Zp_mu8w@mail.gmail.com>
References: <565185ae.62d7440a.bbeac.ffffd614@mx.google.com>
 <56523AC7.7070000@swoodbridge.com>
 <CA+7tXig=2V0KjswSvZqHAMQfsACJp3e+=dgWa3xrWq0Zp_mu8w@mail.gmail.com>
Message-ID: <201511230023.06149.even.rouault@spatialys.com>

Le lundi 23 novembre 2015 00:19:28, vous avez écrit :
> On Sun, Nov 22, 2015 at 1:59 PM, Stephen Woodbridge
> 
> <woodbri at swoodbridge.com> wrote:
> > There are two version of Nautical charts from what I can see:
> > 
> > 1. DNC from www.nga.mil that you pointed at in VPF format
> > 2. NOAA ENC charts
> 
> NOAA also provides RNC charts in BSB format.  GDAL can read them too.
> I've used it with qlandkarte GT for looking at tracks of sailing races
> on NOAA charts.  I did have to enhance the GDAL BSB support 

Out of tree patches ?

> and
> qlandkarte to get it to work with more than a handful of NOAA's
> charts.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bontepaarden at gmail.com  Sun Nov 22 23:50:35 2015
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 23 Nov 2015 08:50:35 +0100
Subject: [gdal-dev] RFC 48: Geographical networks support
Message-ID: <CAHNf2YSGoB24GPn2CNDtkqZyQsJAoNMMAChYZfouHZRB4QmOcA@mail.gmail.com>

Hi List,

I'm looking at this RFC. Is it already implemented in GDAL v2?
And can we use it to create the shortest path between 2 points using a
shapefile of roads (linestring)

Thanks,

Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl



*We've started with the development of MapWindow v5. Read more.
<http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/68467ecb/attachment-0001.html>

From bishop.dev at gmail.com  Mon Nov 23 00:14:24 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Mon, 23 Nov 2015 11:14:24 +0300
Subject: [gdal-dev] RFC 48: Geographical networks support
In-Reply-To: <CAHNf2YSGoB24GPn2CNDtkqZyQsJAoNMMAChYZfouHZRB4QmOcA@mail.gmail.com>
References: <CAHNf2YSGoB24GPn2CNDtkqZyQsJAoNMMAChYZfouHZRB4QmOcA@mail.gmail.com>
Message-ID: <5652CAE0.6050407@gmail.com>

Hi Paul,

The RFS48 implemented, but only in trunk. The plan for release was on 
GDAL 2.1.

Yes, you can create shortest path between 2 points using a shapefile of 
roads, but the graph needed to be created. The autocreate method 
developed mostly for points (valves) and lines (tubes) so it may be 
unusable for you case in current implementation.
The details is here:
https://github.com/OSGeo/gdal/blob/trunk/gdal/gnm/gnm_tut.dox
https://github.com/OSGeo/gdal/blob/trunk/gdal/gnm/gnm_arch.dox
https://github.com/OSGeo/gdal/blob/trunk/gdal/apps/gnm_utilities.dox

Also, I would like to note, what GNMGenericNetowrk is not optimized now 
for big datasets (all graph stored in memory).

Best regards,
     Dmitry

23.11.2015 10:50, Paul Meems пишет:
> Hi List,
>
> I'm looking at this RFC. Is it already implemented in GDAL v2?
> And can we use it to create the shortest path between 2 points using a 
> shapefile of roads (linestring)
>
> Thanks,
>
> Paul
>
> *Paul Meems *
> Release manager, configuration manager
> and forum moderator of MapWindow GIS.
> www.mapwindow.org <http://www.mapwindow.org/>
>
> Owner of MapWindow.nl - Support for
> Dutch speaking users.
> www.mapwindow.nl <http://www.mapwindow.nl/>
>
> *
> *
>
> *We've started with the development of MapWindow v5. Read more. 
> <http://www.mapwindow.org/documentation/mapwingis4.9/MapWindow49.html>
> *
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/93a6fe8a/attachment.html>

From gane.prog at gmail.com  Mon Nov 23 05:24:13 2015
From: gane.prog at gmail.com (Gane R)
Date: Mon, 23 Nov 2015 18:54:13 +0530
Subject: [gdal-dev] Two versions of gdal
Message-ID: <CALMrLdANznFBsCTrQO2LtNfV2nhokn5GzLfEaPBYfwqaENaVFg@mail.gmail.com>

I have a requirement of two version of gdal one with filegeodb (gdal 2.0.1)
and other without filegeodb (gdal 2.0.1) on linux, any references how this
can make co exist ?

thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/59b51e2e/attachment.html>

From lucena_ivan at hotmail.com  Mon Nov 23 06:19:10 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 23 Nov 2015 14:19:10 +0000
Subject: [gdal-dev] Two versions of gdal
In-Reply-To: <CALMrLdANznFBsCTrQO2LtNfV2nhokn5GzLfEaPBYfwqaENaVFg@mail.gmail.com>
References: <CALMrLdANznFBsCTrQO2LtNfV2nhokn5GzLfEaPBYfwqaENaVFg@mail.gmail.com>
Message-ID: <BLUPR19MB0145C518833A57085C163A7090070@BLUPR19MB0145.namprd19.prod.outlook.com>

You don't need to build two gdal versions.


You can build GDAL (libgal.so) without the driver and then you build the driver as a plugin (ogr_FileGDB.so).


./configure -without-fgdb

make


./configure -with-fgdb

make


You can choose to use the drive, or not, by managing the GDAL_DRIVER_PATH environment variable.


The advantage is that libgdal.so is not going to depend on FileGDB SDK.


________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Gane R <gane.prog at gmail.com>
Sent: Monday, November 23, 2015 8:24 AM
To: Even Rouault; gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Two versions of gdal

I have a requirement of two version of gdal one with filegeodb (gdal 2.0.1) and other without filegeodb (gdal 2.0.1) on linux, any references how this can make co exist ?

thanks
Gane


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/d32db940/attachment.html>

From andre.vautour at caris.com  Mon Nov 23 06:58:30 2015
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 23 Nov 2015 10:58:30 -0400
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <2825798.kcKSA5Ro2e@saxicola>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
 <2825798.kcKSA5Ro2e@saxicola>
Message-ID: <56532996.7090703@caris.com>

On 2015-11-20 17:40, Brad Hards wrote:
> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
>> I am trying to open sample DGN file, but it fails. I guess that the
>> reason is unsupported version (man pages says: Microstation DGN files
>> from Microstation versions predating version 8.0 are supported for
>> reading.)
> As I understand it, version 8 is completely different.
>
>> Is there any possibility how to read this file using GDAL library?
> AFAICT, not unless you figure out version 8 format and implement it, or pay
> someone to do that work for you.
I just want to add that Teigha, which can currently be used to open DWG 
in GDAL, does support DGN version 8. So, if someone wants to add that 
support, I'd suggest looking at the DWG driver.

The DWG driver has:
class OGRDWGServices : public ExSystemServices, public ExHostAppServices

You'd need to have something like:
class OGRDGNServices : public OdRxSystemServices, public OdDgHostAppServices

I would not be surprised if considerable chunks of the DWG driver could 
be generalized to work for both DWG and DGN,
André

>   Is it possibly to get the originator to
> provide it in some other format (e.g. DXF, noting that will lose the
> georeferencing)?
>
> Brad
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From gane.prog at gmail.com  Mon Nov 23 07:18:30 2015
From: gane.prog at gmail.com (Gane R)
Date: Mon, 23 Nov 2015 20:48:30 +0530
Subject: [gdal-dev] Two versions of gdal
In-Reply-To: <BLUPR19MB0145C518833A57085C163A7090070@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <CALMrLdANznFBsCTrQO2LtNfV2nhokn5GzLfEaPBYfwqaENaVFg@mail.gmail.com>
 <BLUPR19MB0145C518833A57085C163A7090070@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <CALMrLdDEPh8bkMFLs3VqaWO+U3Kd2AGL387uw8NAn1gCxKmQ0A@mail.gmail.com>

Thanks for your reply, I have a requirement that I should have two GDALs. I
have also an issue, I have build gdal 2.0.1 with proj4 as static, it does
not process the geometry inside from filegeodb. any thoughts will be
appreciated. I have the GDAL_DATA environ set, and pro4 share lib also
exist on the machine and ldconfig is also called to update the shared
library.

Thanks
Gane



On Mon, Nov 23, 2015 at 7:49 PM, Ivan Lucena <lucena_ivan at hotmail.com>
wrote:

> You don't need to build two gdal versions.
>
>
> You can build GDAL (libgal.so) without the driver and then you build the
> driver as a plugin (ogr_FileGDB.so).
>
>
> ./configure -without-fgdb
>
> make
>
>
> ./configure -with-fgdb
>
> make
>
>
> You can choose to use the drive, or not, by managing the GDAL_DRIVER_PATH
> environment variable.
>
>
> The advantage is that libgdal.so is not going to depend on FileGDB SDK.
>
>
> ------------------------------
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Gane R <
> gane.prog at gmail.com>
> *Sent:* Monday, November 23, 2015 8:24 AM
> *To:* Even Rouault; gdal-dev at lists.osgeo.org
> *Subject:* [gdal-dev] Two versions of gdal
>
> I have a requirement of two version of gdal one with filegeodb (gdal
> 2.0.1) and other without filegeodb (gdal 2.0.1) on linux, any references
> how this can make co exist ?
>
> thanks
> Gane
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/d3faa797/attachment.html>

From lucena_ivan at hotmail.com  Mon Nov 23 07:41:41 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 23 Nov 2015 15:41:41 +0000
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <56532996.7090703@caris.com>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
 <2825798.kcKSA5Ro2e@saxicola>,<56532996.7090703@caris.com>
Message-ID: <BLUPR19MB0145A56D745F087AB51F16E890070@BLUPR19MB0145.namprd19.prod.outlook.com>

Just a comment on that: In order to build the DWG driver, you or your company, need to be part of some kind of alliance to be able to download a full version of the Teigha SDK. AFAIK

________________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andre Vautour <andre.vautour at caris.com>
Sent: Monday, November 23, 2015 9:58 AM
To: Brad Hards
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] unable to open DGN

On 2015-11-20 17:40, Brad Hards wrote:
> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
>> I am trying to open sample DGN file, but it fails. I guess that the
>> reason is unsupported version (man pages says: Microstation DGN files
>> from Microstation versions predating version 8.0 are supported for
>> reading.)
> As I understand it, version 8 is completely different.
>
>> Is there any possibility how to read this file using GDAL library?
> AFAICT, not unless you figure out version 8 format and implement it, or pay
> someone to do that work for you.
I just want to add that Teigha, which can currently be used to open DWG
in GDAL, does support DGN version 8. So, if someone wants to add that
support, I'd suggest looking at the DWG driver.

The DWG driver has:
class OGRDWGServices : public ExSystemServices, public ExHostAppServices

You'd need to have something like:
class OGRDGNServices : public OdRxSystemServices, public OdDgHostAppServices

I would not be surprised if considerable chunks of the DWG driver could
be generalized to work for both DWG and DGN,
André

>   Is it possibly to get the originator to
> provide it in some other format (e.g. DXF, noting that will lose the
> georeferencing)?
>
> Brad
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From andre.vautour at caris.com  Mon Nov 23 07:48:48 2015
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 23 Nov 2015 11:48:48 -0400
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <BLUPR19MB0145A56D745F087AB51F16E890070@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
 <2825798.kcKSA5Ro2e@saxicola>, <56532996.7090703@caris.com>
 <BLUPR19MB0145A56D745F087AB51F16E890070@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <56533560.7080301@caris.com>

Right, thanks, I wasn't thinking of that when I wrote my reply.

Guess it makes sense for a closed format such as DWG. Might not make as 
much sense to use it for DGN which is more open and does not need to be 
reverse engineered.
André

On 2015-11-23 11:41, Ivan Lucena wrote:
> Just a comment on that: In order to build the DWG driver, you or your company, need to be part of some kind of alliance to be able to download a full version of the Teigha SDK. AFAIK
>
> ________________________________________
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andre Vautour <andre.vautour at caris.com>
> Sent: Monday, November 23, 2015 9:58 AM
> To: Brad Hards
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] unable to open DGN
>
> On 2015-11-20 17:40, Brad Hards wrote:
>> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
>>> I am trying to open sample DGN file, but it fails. I guess that the
>>> reason is unsupported version (man pages says: Microstation DGN files
>>> from Microstation versions predating version 8.0 are supported for
>>> reading.)
>> As I understand it, version 8 is completely different.
>>
>>> Is there any possibility how to read this file using GDAL library?
>> AFAICT, not unless you figure out version 8 format and implement it, or pay
>> someone to do that work for you.
> I just want to add that Teigha, which can currently be used to open DWG
> in GDAL, does support DGN version 8. So, if someone wants to add that
> support, I'd suggest looking at the DWG driver.
>
> The DWG driver has:
> class OGRDWGServices : public ExSystemServices, public ExHostAppServices
>
> You'd need to have something like:
> class OGRDGNServices : public OdRxSystemServices, public OdDgHostAppServices
>
> I would not be surprised if considerable chunks of the DWG driver could
> be generalized to work for both DWG and DGN,
> André
>
>>    Is it possibly to get the originator to
>> provide it in some other format (e.g. DXF, noting that will lose the
>> georeferencing)?
>>
>> Brad
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Mon Nov 23 08:00:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2015 17:00:28 +0100
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <56533560.7080301@caris.com>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
 <BLUPR19MB0145A56D745F087AB51F16E890070@BLUPR19MB0145.namprd19.prod.outlook.com>
 <56533560.7080301@caris.com>
Message-ID: <201511231700.28589.even.rouault@spatialys.com>

Le lundi 23 novembre 2015 16:48:48, Andre Vautour a écrit :
> Right, thanks, I wasn't thinking of that when I wrote my reply.
> 
> Guess it makes sense for a closed format such as DWG. Might not make as
> much sense to use it for DGN which is more open

DGN v8: open ? If you have pointers to a spec, I think that would be much 
appreciated by a lot of people...

> and does not need to be
> reverse engineered.
> André
> 
> On 2015-11-23 11:41, Ivan Lucena wrote:
> > Just a comment on that: In order to build the DWG driver, you or your
> > company, need to be part of some kind of alliance to be able to download
> > a full version of the Teigha SDK. AFAIK
> > 
> > ________________________________________
> > From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andre
> > Vautour <andre.vautour at caris.com> Sent: Monday, November 23, 2015 9:58
> > AM
> > To: Brad Hards
> > Cc: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] unable to open DGN
> > 
> > On 2015-11-20 17:40, Brad Hards wrote:
> >> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
> >>> I am trying to open sample DGN file, but it fails. I guess that the
> >>> reason is unsupported version (man pages says: Microstation DGN files
> >>> from Microstation versions predating version 8.0 are supported for
> >>> reading.)
> >> 
> >> As I understand it, version 8 is completely different.
> >> 
> >>> Is there any possibility how to read this file using GDAL library?
> >> 
> >> AFAICT, not unless you figure out version 8 format and implement it, or
> >> pay someone to do that work for you.
> > 
> > I just want to add that Teigha, which can currently be used to open DWG
> > in GDAL, does support DGN version 8. So, if someone wants to add that
> > support, I'd suggest looking at the DWG driver.
> > 
> > The DWG driver has:
> > class OGRDWGServices : public ExSystemServices, public ExHostAppServices
> > 
> > You'd need to have something like:
> > class OGRDGNServices : public OdRxSystemServices, public
> > OdDgHostAppServices
> > 
> > I would not be surprised if considerable chunks of the DWG driver could
> > be generalized to work for both DWG and DGN,
> > André
> > 
> >>    Is it possibly to get the originator to
> >> 
> >> provide it in some other format (e.g. DXF, noting that will lose the
> >> georeferencing)?
> >> 
> >> Brad
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre.vautour at caris.com  Mon Nov 23 08:23:06 2015
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 23 Nov 2015 12:23:06 -0400
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <201511231700.28589.even.rouault@spatialys.com>
References: <CA+Ei1OemiRoRzGQZGxURrXBATu1uEQXKvL_Y1Yqjhyj9H1YH9w@mail.gmail.com>
 <BLUPR19MB0145A56D745F087AB51F16E890070@BLUPR19MB0145.namprd19.prod.outlook.com>
 <56533560.7080301@caris.com> <201511231700.28589.even.rouault@spatialys.com>
Message-ID: <56533D6A.3030409@caris.com>


On 2015-11-23 12:00, Even Rouault wrote:
> Le lundi 23 novembre 2015 16:48:48, Andre Vautour a écrit :
>> Right, thanks, I wasn't thinking of that when I wrote my reply.
>>
>> Guess it makes sense for a closed format such as DWG. Might not make as
>> much sense to use it for DGN which is more open
> DGN v8: open ? If you have pointers to a spec, I think that would be much
> appreciated by a lot of people...
I apologize, clearly I am not thinking straight today. What I meant to 
say is that Ivan made me realize why the DGN driver was probably not 
implemented by using DGNDirect or Teigha: there was some sort of spec 
available: http://dgnlib.maptools.org/dgn.html.

So, I agree that if using an Open Design library to support such a 
format can be avoided, it would make sense to do so, given their 
licensing. Like I said, I wasn't thinking of that when I first replied.

Kind regards,
André

>> and does not need to be
>> reverse engineered.
>> André
>>
>> On 2015-11-23 11:41, Ivan Lucena wrote:
>>> Just a comment on that: In order to build the DWG driver, you or your
>>> company, need to be part of some kind of alliance to be able to download
>>> a full version of the Teigha SDK. AFAIK
>>>
>>> ________________________________________
>>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andre
>>> Vautour <andre.vautour at caris.com> Sent: Monday, November 23, 2015 9:58
>>> AM
>>> To: Brad Hards
>>> Cc: gdal-dev at lists.osgeo.org
>>> Subject: Re: [gdal-dev] unable to open DGN
>>>
>>> On 2015-11-20 17:40, Brad Hards wrote:
>>>> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
>>>>> I am trying to open sample DGN file, but it fails. I guess that the
>>>>> reason is unsupported version (man pages says: Microstation DGN files
>>>>> from Microstation versions predating version 8.0 are supported for
>>>>> reading.)
>>>> As I understand it, version 8 is completely different.
>>>>
>>>>> Is there any possibility how to read this file using GDAL library?
>>>> AFAICT, not unless you figure out version 8 format and implement it, or
>>>> pay someone to do that work for you.
>>> I just want to add that Teigha, which can currently be used to open DWG
>>> in GDAL, does support DGN version 8. So, if someone wants to add that
>>> support, I'd suggest looking at the DWG driver.
>>>
>>> The DWG driver has:
>>> class OGRDWGServices : public ExSystemServices, public ExHostAppServices
>>>
>>> You'd need to have something like:
>>> class OGRDGNServices : public OdRxSystemServices, public
>>> OdDgHostAppServices
>>>
>>> I would not be surprised if considerable chunks of the DWG driver could
>>> be generalized to work for both DWG and DGN,
>>> André
>>>
>>>>     Is it possibly to get the originator to
>>>>
>>>> provide it in some other format (e.g. DXF, noting that will lose the
>>>> georeferencing)?
>>>>
>>>> Brad
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From gane.prog at gmail.com  Mon Nov 23 08:29:41 2015
From: gane.prog at gmail.com (Gane R)
Date: Mon, 23 Nov 2015 21:59:41 +0530
Subject: [gdal-dev] Geometry not displayed with Filegeodb on GDAL 2.0.1
Message-ID: <CALMrLdBd77R--XG7o_40xxbCy-hKXwOQodvTKKYxbd4ecnFY2Q@mail.gmail.com>

Hi all,

I tried to build *GDAL 2.0.1* with *filegeodb* support with *proj4* as
static lib on *Linux*. I am able to use the API to get the field data from
Filegeodb but I am *not able to get the geometry*.  I have configured as

./configure --with-fgdb=/fgdblib --with-static-proj4=/usr/local/
--with-xml2=no --with-sqlite3=no --with-curl=no --with-expat=no

I am wondering what went wrong. But ogrinfo shows the values of the same
filegeodb file.

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/40fa0ff5/attachment.html>

From ahuarte47 at yahoo.es  Mon Nov 23 08:37:38 2015
From: ahuarte47 at yahoo.es (A Huarte)
Date: Mon, 23 Nov 2015 16:37:38 +0000 (UTC)
Subject: [gdal-dev] unable to open DGN
In-Reply-To: <56533D6A.3030409@caris.com>
References: <56533D6A.3030409@caris.com>
Message-ID: <153229758.14921773.1448296658202.JavaMail.yahoo@mail.yahoo.com>

Hi, sorry for intruding, this help describes the specification of --v95/v7-- versions.
The --v8-- spec is different, OpenDGN only supports read v95/v7 files, and read/write v8 files.
Alvaro
      De: Andre Vautour <andre.vautour at caris.com>
 Para: Even Rouault <even.rouault at spatialys.com> 
CC: gdal-dev at lists.osgeo.org
 Enviado: Lunes 23 de noviembre de 2015 17:23
 Asunto: Re: [gdal-dev] unable to open DGN
   

On 2015-11-23 12:00, Even Rouault wrote:
> Le lundi 23 novembre 2015 16:48:48, Andre Vautour a écrit :
>> Right, thanks, I wasn't thinking of that when I wrote my reply.
>>
>> Guess it makes sense for a closed format such as DWG. Might not make as
>> much sense to use it for DGN which is more open
> DGN v8: open ? If you have pointers to a spec, I think that would be much
> appreciated by a lot of people...
I apologize, clearly I am not thinking straight today. What I meant to 
say is that Ivan made me realize why the DGN driver was probably not 
implemented by using DGNDirect or Teigha: there was some sort of spec 
available: http://dgnlib.maptools.org/dgn.html.

So, I agree that if using an Open Design library to support such a 
format can be avoided, it would make sense to do so, given their 
licensing. Like I said, I wasn't thinking of that when I first replied.

Kind regards,
André



>> and does not need to be
>> reverse engineered.
>> André
>>
>> On 2015-11-23 11:41, Ivan Lucena wrote:
>>> Just a comment on that: In order to build the DWG driver, you or your
>>> company, need to be part of some kind of alliance to be able to download
>>> a full version of the Teigha SDK. AFAIK
>>>
>>> ________________________________________
>>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andre
>>> Vautour <andre.vautour at caris.com> Sent: Monday, November 23, 2015 9:58
>>> AM
>>> To: Brad Hards
>>> Cc: gdal-dev at lists.osgeo.org
>>> Subject: Re: [gdal-dev] unable to open DGN
>>>
>>> On 2015-11-20 17:40, Brad Hards wrote:
>>>> On Fri, 20 Nov 2015 02:20:55 PM Martin Landa wrote:
>>>>> I am trying to open sample DGN file, but it fails. I guess that the
>>>>> reason is unsupported version (man pages says: Microstation DGN files
>>>>> from Microstation versions predating version 8.0 are supported for
>>>>> reading.)
>>>> As I understand it, version 8 is completely different.
>>>>
>>>>> Is there any possibility how to read this file using GDAL library?
>>>> AFAICT, not unless you figure out version 8 format and implement it, or
>>>> pay someone to do that work for you.
>>> I just want to add that Teigha, which can currently be used to open DWG
>>> in GDAL, does support DGN version 8. So, if someone wants to add that
>>> support, I'd suggest looking at the DWG driver.
>>>
>>> The DWG driver has:
>>> class OGRDWGServices : public ExSystemServices, public ExHostAppServices
>>>
>>> You'd need to have something like:
>>> class OGRDGNServices : public OdRxSystemServices, public
>>> OdDgHostAppServices
>>>
>>> I would not be surprised if considerable chunks of the DWG driver could
>>> be generalized to work for both DWG and DGN,
>>> André
>>>
>>>>    Is it possibly to get the originator to
>>>>
>>>> provide it in some other format (e.g. DXF, noting that will lose the
>>>> georeferencing)?
>>>>
>>>> Brad
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/e2ac02af/attachment-0001.html>

From dvick at boundlessgeo.com  Mon Nov 23 10:34:25 2015
From: dvick at boundlessgeo.com (David Vick)
Date: Mon, 23 Nov 2015 12:34:25 -0600
Subject: [gdal-dev] Ingesting ESRI geometry into PostGIS
Message-ID: <CAA2n=rnUQ8F1gEV9AAnoXT_Y-1DyN_W-2k=qA-8iVtYN+opNkw@mail.gmail.com>

All,

I'm trying to use ogr2ogr to ingest FileGDB's into PostgreSQL/PostGIS that
has the default geometry_storage parameter set to st_geometry.  When
running ogr2ogr with DEBUG on I see a message PG: Field shape is of unknown
format type st_multipolygon <type=st_multipolygon> ogr2ogr completes and I
can verify that the data is copied into postgis, but the geometries are NOT
copied over.  Does anyone have an idea on how to resolve this?

Thanks,

David Vick

Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
dvick at boundlessgeo.com
mobile: 1-636-698-3174
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/84bbfdfb/attachment.html>

From pramsey at cleverelephant.ca  Mon Nov 23 10:41:04 2015
From: pramsey at cleverelephant.ca (Paul Ramsey)
Date: Mon, 23 Nov 2015 10:41:04 -0800
Subject: [gdal-dev] Ingesting ESRI geometry into PostGIS
In-Reply-To: <CAA2n=rnUQ8F1gEV9AAnoXT_Y-1DyN_W-2k=qA-8iVtYN+opNkw@mail.gmail.com>
References: <CAA2n=rnUQ8F1gEV9AAnoXT_Y-1DyN_W-2k=qA-8iVtYN+opNkw@mail.gmail.com>
Message-ID: <etPan.56535dc4.238e1f29.12e9c@Crane.local>

This is a non-sequitur "PostgreSQL/PostGIS that has the default geometry_storage parameter set to st_geometry”. The ST_Geometry type is an ESRI thing, and you need to have ESRI dll’s installed in your PostgreSQL/ESRI server in order to create such a column. That’s Problem #1. 

Problem #2 is that GDAL doesn’t support writing to a PostgreSQL/ESRI database, so you’ll have to write a suitable driver for that.

ATB,

P.

On November 23, 2015 at 10:34:28 AM, David Vick (dvick at boundlessgeo.com) wrote:

All,

I'm trying to use ogr2ogr to ingest FileGDB's into PostgreSQL/PostGIS that has the default geometry_storage parameter set to st_geometry.  When running ogr2ogr with DEBUG on I see a message PG: Field shape is of unknown format type st_multipolygon <type=st_multipolygon> ogr2ogr completes and I can verify that the data is copied into postgis, but the geometries are NOT copied over.  Does anyone have an idea on how to resolve this?

Thanks,

David Vick

Professional Services Engineer | Boundless
dvick at boundlessgeo.com
mobile: 1-636-698-3174


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-- 
Paul Ramsey
Sent with Airmail
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/98bebafa/attachment.html>

From dvick at boundlessgeo.com  Mon Nov 23 11:01:27 2015
From: dvick at boundlessgeo.com (David Vick)
Date: Mon, 23 Nov 2015 13:01:27 -0600
Subject: [gdal-dev] Ingesting ESRI geometry into PostGIS
In-Reply-To: <etPan.56535dc4.238e1f29.12e9c@Crane.local>
References: <CAA2n=rnUQ8F1gEV9AAnoXT_Y-1DyN_W-2k=qA-8iVtYN+opNkw@mail.gmail.com>
 <etPan.56535dc4.238e1f29.12e9c@Crane.local>
Message-ID: <CAA2n=rnYm7khJEHScZsCP1wPgbXK4ffU=-ka9VBwqWAJoywYzw@mail.gmail.com>

Paul,

Thanks for the response.  We are running ArcSDE on top of the PostgreSQL
server hence the first part of the question.  As part of our process we are
using ArcObjects to extract the schema of the FileGDB and write the schema
to PostgreSQL and then are attempting to use gdal/ogr2ogr to move the data
as this is much faster than ESRI's processes, but this has failed and now
we know why.  Your second point is quite clear and something that my client
will have to look at in the future.

David Vick

Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
dvick at boundlessgeo.com
mobile: 1-636-698-3174


On Mon, Nov 23, 2015 at 12:41 PM, Paul Ramsey <pramsey at cleverelephant.ca>
wrote:

> This is a non-sequitur "PostgreSQL/PostGIS that has the default
> geometry_storage parameter set to st_geometry”. The ST_Geometry type is an
> ESRI thing, and you need to have ESRI dll’s installed in your
> PostgreSQL/ESRI server in order to create such a column. That’s Problem #1.
>
> Problem #2 is that GDAL doesn’t support writing to a PostgreSQL/ESRI
> database, so you’ll have to write a suitable driver for that.
>
> ATB,
>
> P.
>
> On November 23, 2015 at 10:34:28 AM, David Vick (dvick at boundlessgeo.com)
> wrote:
>
> All,
>
> I'm trying to use ogr2ogr to ingest FileGDB's into PostgreSQL/PostGIS that
> has the default geometry_storage parameter set to st_geometry.  When
> running ogr2ogr with DEBUG on I see a message PG: Field shape is of unknown
> format type st_multipolygon <type=st_multipolygon> ogr2ogr completes and I
> can verify that the data is copied into postgis, but the geometries are NOT
> copied over.  Does anyone have an idea on how to resolve this?
>
> Thanks,
>
> David Vick
>
> Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
> dvick at boundlessgeo.com
> mobile: 1-636-698-3174
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Paul Ramsey
> Sent with Airmail
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/1960d131/attachment.html>

From timothy.astle at caris.com  Mon Nov 23 13:01:31 2015
From: timothy.astle at caris.com (Timothy Astle)
Date: Mon, 23 Nov 2015 17:01:31 -0400
Subject: [gdal-dev] WMS MINRESOLUTION can lead to overflow of raster
	dimensions
Message-ID: <56537EAB.50509@caris.com>

I'm trying to open a WMS dataset using the minimally documented 
MINRESOLUTION option. (http://www.gdal.org/frmt_wms.html)

When providing a way-too-fine resolution, I manage to create a raster 
that exceeds GDALs 32-bit integer based dimensions.  Below shows what 
I'm seeing.  You can see that one of the dimensions has overflowed.

gdal_translate.exe -of PNG 
"http://nowcoast.noaa.gov:80/wms/com.esri.wms.Esrimap/obs?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=RAS_RIDGE_NEXRAD&SRS=EPSG:4326&BBOX=-180,-90,180,90&transparent=true&MINRESOLUTION=8.98315e-008" 
my.png

ERROR 1: Invalid dataset dimensions : -2147483648 x 2003751468
GDALOpen failed - 1
Invalid dataset dimensions : -2147483648 x 2003751468

I'm wondering if it'd make sense to handle the kind of input that would 
cause this problem to surface.  Looking at the calculations made in the 
wmsdriver, when a MINRESOLUTION is provided the following code is where 
the issue happens:

     if (osMinResolution.size() != 0)
     {
         double dfMinResolution = CPLAtofM(osMinResolution);

         while (nOverviewCount > 20)
         {
             nOverviewCount --;
             dfMinResolution *= 2;
         }

         nXSize = (int) ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
         nYSize = (int) ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
     }

Would it make sense to do something as follows?  (Note:  I haven't tried 
this yet, I'm just soliciting early feedback so please bare with me )


     if (osMinResolution.size() != 0)
     {
         double dfMinResolution = CPLAtofM(osMinResolution);

         while (nOverviewCount > 20)
         {
             nOverviewCount --;
             dfMinResolution *= 2;
         }

         // *** Changes here ***
         // Determine a suitable resolution that doesn't overflow max int.
         double dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
         double dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);

         while (dXSize > INT_MAX || dYSize > INT_MAX)
         {
             nOverviewCount --;
             dfMinResolution *= 2;

             dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
             dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
         }

         nXSize = (int) dXSize;
         nYSize = (int) dYSize;
     }

Any thoughts?


Tim Astle

From even.rouault at spatialys.com  Mon Nov 23 13:25:02 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2015 22:25:02 +0100
Subject: [gdal-dev] WMS MINRESOLUTION can lead to overflow of raster
	dimensions
In-Reply-To: <56537EAB.50509@caris.com>
References: <56537EAB.50509@caris.com>
Message-ID: <201511232225.02496.even.rouault@spatialys.com>

Tim,

> Would it make sense to do something as follows?  (Note:  I haven't tried
> this yet, I'm just soliciting early feedback so please bare with me )
> 
> 
>      if (osMinResolution.size() != 0)
>      {
>          double dfMinResolution = CPLAtofM(osMinResolution);
> 
>          while (nOverviewCount > 20)
>          {
>              nOverviewCount --;
>              dfMinResolution *= 2;
>          }
> 
>          // *** Changes here ***
>          // Determine a suitable resolution that doesn't overflow max int.
>          double dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
>          double dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
> 
>          while (dXSize > INT_MAX || dYSize > INT_MAX)
>          {
>              nOverviewCount --;

I'm not sure we need to decrement the number of overviews in that loop.

>              dfMinResolution *= 2;
> 
>              dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
>              dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
>          }
> 
>          nXSize = (int) dXSize;
>          nYSize = (int) dYSize;
>      }
> 
> Any thoughts?

If that works, please open a ticket with the patch.

For extra bonus, I see that a few lines below a similar overflow could also 
occur :

"""
    else
    {
        double dfRatio = (dfMaxX - dfMinX) / (dfMaxY - dfMinY);
        if (dfRatio > 1)
        {
            nXSize = nTileSize;
            nYSize = (int) (nXSize / dfRatio);
        }
        else
        {
            nYSize = nTileSize;
            nXSize = (int) (nYSize * dfRatio);
        }

        if (nOverviewCount < 0 || nOverviewCount > 20)
            nOverviewCount = 20;

        nXSize = nXSize * (1 << nOverviewCount);
        nYSize = nYSize * (1 << nOverviewCount);
    }
"""

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Mon Nov 23 13:39:53 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 23 Nov 2015 22:39:53 +0100
Subject: [gdal-dev] Ingesting ESRI geometry into PostGIS
In-Reply-To: <CAA2n=rnYm7khJEHScZsCP1wPgbXK4ffU=-ka9VBwqWAJoywYzw@mail.gmail.com>
References: <CAA2n=rnUQ8F1gEV9AAnoXT_Y-1DyN_W-2k=qA-8iVtYN+opNkw@mail.gmail.com>
 <etPan.56535dc4.238e1f29.12e9c@Crane.local>
 <CAA2n=rnYm7khJEHScZsCP1wPgbXK4ffU=-ka9VBwqWAJoywYzw@mail.gmail.com>
Message-ID: <CAFcOn29o+vj22iaf1zkcoLAs5MGKJNqTTowTtgieHrgD-C9cnA@mail.gmail.com>

See also https://trac.osgeo.org/postgis/wiki/UsersWikiPostgisarcgis

:S

2015-11-23 20:01 GMT+01:00 David Vick <dvick at boundlessgeo.com>:

> Paul,
>
> Thanks for the response.  We are running ArcSDE on top of the PostgreSQL
> server hence the first part of the question.  As part of our process we are
> using ArcObjects to extract the schema of the FileGDB and write the schema
> to PostgreSQL and then are attempting to use gdal/ogr2ogr to move the data
> as this is much faster than ESRI's processes, but this has failed and now
> we know why.  Your second point is quite clear and something that my client
> will have to look at in the future.
>
> David Vick
>
> Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
> dvick at boundlessgeo.com
> mobile: 1-636-698-3174
>
>
> On Mon, Nov 23, 2015 at 12:41 PM, Paul Ramsey <pramsey at cleverelephant.ca>
> wrote:
>
>> This is a non-sequitur "PostgreSQL/PostGIS that has the default
>> geometry_storage parameter set to st_geometry”. The ST_Geometry type is an
>> ESRI thing, and you need to have ESRI dll’s installed in your
>> PostgreSQL/ESRI server in order to create such a column. That’s Problem #1.
>>
>> Problem #2 is that GDAL doesn’t support writing to a PostgreSQL/ESRI
>> database, so you’ll have to write a suitable driver for that.
>>
>> ATB,
>>
>> P.
>>
>> On November 23, 2015 at 10:34:28 AM, David Vick (dvick at boundlessgeo.com)
>> wrote:
>>
>> All,
>>
>> I'm trying to use ogr2ogr to ingest FileGDB's into PostgreSQL/PostGIS
>> that has the default geometry_storage parameter set to st_geometry.  When
>> running ogr2ogr with DEBUG on I see a message PG: Field shape is of unknown
>> format type st_multipolygon <type=st_multipolygon> ogr2ogr completes and I
>> can verify that the data is copied into postgis, but the geometries are NOT
>> copied over.  Does anyone have an idea on how to resolve this?
>>
>> Thanks,
>>
>> David Vick
>>
>> Professional Services Engineer | Boundless <http://www.boundlessgeo.com>
>> dvick at boundlessgeo.com
>> mobile: 1-636-698-3174
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> --
>> Paul Ramsey
>> Sent with Airmail
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151123/cbda2fbd/attachment.html>

From luc.vanlinden at gmail.com  Tue Nov 24 05:36:37 2015
From: luc.vanlinden at gmail.com (lucvanlinden)
Date: Tue, 24 Nov 2015 05:36:37 -0800 (PST)
Subject: [gdal-dev] does OGR GML support multiple geometries
Message-ID: <1448372197777-5238267.post@n6.nabble.com>

Hi 

Tested 1.11 2.0beta of OGR (have no binaries at hand for latest stabble
2.X).

Trying to use gml with multiple geometries. Here is some simplified
testcase.

testMydualGeom.xsd:

<?xml version="1.0" encoding="utf-8"?>
<xsd:schema
  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
  xmlns:gml="http://www.opengis.net/gml"
  xmlns:gmlsf="http://www.opengis.net/gmlsf"
  xmlns:test="http://www.test.org/test"
  targetNamespace="http://www.test.org/test"
  elementFormDefault="qualified"
  version="0.1.0">

  
  <xsd:import
    namespace="http://www.w3.org/XML/1998/namespace"
    schemaLocation="http://www.w3.org/2001/xml.xsd"/>
  <xsd:import
    namespace="http://www.opengis.net/gml"
   
schemaLocation="http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd"/>
  <xsd:import
    namespace="http://www.opengis.net/gmlsf"
   
schemaLocation="http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsfLevels.xsd"/>


  
  <xsd:element
    name="MyDualGeomFeature"
    type="test:MyDualGeomFeature"
    substitutionGroup="gml:_Feature"/>

  <xsd:complexType name="MyDualGeomFeatureType">
    <xsd:complexContent>
      <xsd:extension base="gml:AbstractFeatureType">
        <xsd:sequence>
          <xsd:element name="componentID"
            type="xsd:string"
            minOccurs="0"
            maxOccurs="1"/>
          <xsd:element name="centerline"
            type="gml:CurvePropertyType"
            minOccurs="0"
            maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation>
                The centerline spatial geometry of this component as it was
installed.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="centerOf"
            type="gml:PointPropertyType"
            minOccurs="0"
            maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation>
                The center point spatial geometry of this component as it
was installed.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
 

</xsd:schema>

testMydualGeom.gml file:

<?xml version="1.0" encoding="UTF-8"?>

<gml:FeatureCollection xmlns:gml="http://www.opengis.net/gml"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  xmlns="http://www.test.org/test"
  xsi:schemaLocation="http://www.test.org testMydualgeom.xsd"
  gml:id="1">

   
  <gml:featureMember>
    <MyDualGeomFeature gml:id="myMyDualGeomFeature1">
		<componentID>test1</componentID>
      <centerline>
        <gml:Point gml:id="geom1" srsName="EPSG:4326">
          <gml:pos>30.095472861000076 -96.079962905999992</gml:pos>
        </gml:Point>
      </centerline>
      <centerOf>
        <gml:Point gml:id="geom2" srsName="EPSG:4326">
          <gml:pos>30.095472861000076 -96.079962905999992</gml:pos>
        </gml:Point>
      </centerOf>
    </MyDualGeomFeature>
  </gml:featureMember>
 

</gml:FeatureCollection>


Ogrinfo reports only one geometry. The gfs file has the following:
<GeometryType>1</GeometryType>

I know and succesfully tested the editing of the gfs file for getting the 2
geometries reckognised by Ogr.

My question, although reading http://www.gdal.org/drv_gml.html

"But, starting with OGR 1.11, if the .xsd schema is understood by the XSD
parser and declares several geometry fields, or the .gfs file declares
several geometry fields, multiple geometry fields will be reported by the
GML driver according to RFC 41."

I would have assumed the xsd would be read correctly to identify the 2
geometry fields.
(also included -oo XSD=testMydualGeom.xsd (for the 2.0beta release).

question is: is this working (ogr gml multiple geometries reading) in a
recent stable 2.X?

tx

Luc







--
View this message in context: http://osgeo-org.1560.x6.nabble.com/does-OGR-GML-support-multiple-geometries-tp5238267.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Nov 24 05:54:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Nov 2015 14:54:30 +0100
Subject: [gdal-dev] does OGR GML support multiple geometries
In-Reply-To: <1448372197777-5238267.post@n6.nabble.com>
References: <1448372197777-5238267.post@n6.nabble.com>
Message-ID: <201511241454.30369.even.rouault@spatialys.com>

Luc,

> 
>   <xsd:element
>     name="MyDualGeomFeature"
>     type="test:MyDualGeomFeature"

==> This should by type="test:MyDualGeomFeatureType"

Once corrected, with GDAL 1.11 or above :

$ ogrinfo ../../trunk/gdal/test.gml -al
Had to open data source read-only.
INFO: Open of `../../trunk/gdal/test.gml'
      using driver `GML' successful.

Layer name: MyDualGeomFeature
Geometry (centerline): Line String
Geometry (centerOf): Point
Feature Count: 1
Extent (centerline): (30.095473, -96.079963) - (30.095473, -96.079963)
Extent (centerOf): (30.095473, -96.079963) - (30.095473, -96.079963)
SRS WKT (centerline):
(unknown)
SRS WKT (centerOf):
(unknown)
Geometry Column 1 = centerline
Geometry Column 2 = centerOf
gml_id: String (0.0)
componentID: String (0.0)
OGRFeature(MyDualGeomFeature):1
  gml_id (String) = myMyDualGeomFeature1
  componentID (String) = test1
  centerline = POINT (30.095472861000079 -96.079962906)
  centerOf = POINT (30.095472861000079 -96.079962906)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From timothy.astle at caris.com  Tue Nov 24 07:50:48 2015
From: timothy.astle at caris.com (Timothy Astle)
Date: Tue, 24 Nov 2015 11:50:48 -0400
Subject: [gdal-dev] WMS MINRESOLUTION can lead to overflow of raster
 dimensions
In-Reply-To: <201511232225.02496.even.rouault@spatialys.com>
References: <56537EAB.50509@caris.com>
 <201511232225.02496.even.rouault@spatialys.com>
Message-ID: <56548758.5040107@caris.com>

Thanks for the feedback Even, comments inline below.

On 23/11/2015 5:25 PM, Even Rouault wrote:
> Tim,
>
>> Would it make sense to do something as follows?  (Note:  I haven't tried
>> this yet, I'm just soliciting early feedback so please bare with me )
>>
>>
>>       if (osMinResolution.size() != 0)
>>       {
>>           double dfMinResolution = CPLAtofM(osMinResolution);
>>
>>           while (nOverviewCount > 20)
>>           {
>>               nOverviewCount --;
>>               dfMinResolution *= 2;
>>           }
>>
>>           // *** Changes here ***
>>           // Determine a suitable resolution that doesn't overflow max int.
>>           double dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
>>           double dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
>>
>>           while (dXSize > INT_MAX || dYSize > INT_MAX)
>>           {
>>               nOverviewCount --;
> I'm not sure we need to decrement the number of overviews in that loop.

Good point.

>
>>               dfMinResolution *= 2;
>>
>>               dXSize = ((dfMaxX - dfMinX) / dfMinResolution + 0.5);
>>               dYSize = ((dfMaxY - dfMinY) / dfMinResolution + 0.5);
>>           }
>>
>>           nXSize = (int) dXSize;
>>           nYSize = (int) dYSize;
>>       }
>>
>> Any thoughts?
> If that works, please open a ticket with the patch.
>
> For extra bonus, I see that a few lines below a similar overflow could also
> occur :

Sounds like a plan to me.

>
> """
>      else
>      {
>          double dfRatio = (dfMaxX - dfMinX) / (dfMaxY - dfMinY);
>          if (dfRatio > 1)
>          {
>              nXSize = nTileSize;
>              nYSize = (int) (nXSize / dfRatio);
>          }
>          else
>          {
>              nYSize = nTileSize;
>              nXSize = (int) (nYSize * dfRatio);
>          }
>
>          if (nOverviewCount < 0 || nOverviewCount > 20)
>              nOverviewCount = 20;
>
>          nXSize = nXSize * (1 << nOverviewCount);
>          nYSize = nYSize * (1 << nOverviewCount);
>      }
> """
>
> Even
>

-- 
Tim Astle
Development Manager for Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.


From xbarnada at gmail.com  Wed Nov 25 07:14:44 2015
From: xbarnada at gmail.com (Xavier Barnada)
Date: Wed, 25 Nov 2015 16:14:44 +0100
Subject: [gdal-dev] Install python binding from pip
Message-ID: <CAMbW+CntP5K7buv-udORJKgRzNihXyHsG0iZeYTCbJRzSBNr7w@mail.gmail.com>

Hi,

I'm trying to install it in a virtualenv in a Ubuntu and I get a message
 about missing cpl_port.h file
I currently have the gdal-dev installed and the cpl_port.h it's
on /usr/include/gdal/
I'm using an a 14.04 ubuntu with the 1.11.12 gdal version.
Is this a bug or it have some trick to install gdal from pip?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151125/5c7a1cfd/attachment.html>

From r.marcofiguera at jacobs-university.de  Wed Nov 25 07:16:17 2015
From: r.marcofiguera at jacobs-university.de (Ramiro Marco Figuera)
Date: Wed, 25 Nov 2015 16:16:17 +0100
Subject: [gdal-dev] strange grid pattern when reprojecting
Message-ID: <5655D0C1.3010801@jacobs-university.de>

Hi all,

I noticed a curious gridded pattern when using gdalwarp to reproject. I 
am reprojecting some lunar south polar DEMs in stereographic projection 
to gnomonic projection. I am using the following command: gdalwarp 
-t_srs '+proj=gnom +lat_0=-90 +lon_0=0 +x_0=0 +y_0=0 +a=1737400 
+b=1737400 +units=m +no_defs ' topo_stereo.tif topo_gnom.tif

When I create a hillshaded map using gdaldem hillshade I can see a 
gridded pattern. I did a hillshaded map with the original map and the 
grid is no there. Am I making a mistake when reprojecting or is that a 
bug? I can provide images if necessary.

Cheers,

Ramiro

-- 
Ramiro Marco Figuera
Research Associate - PhD Student
Department of Physics and Earth Sciences
Jacobs University Bremen
Campus Ring 1, 28759 Bremen, Germany
Office: Research III, Room 99b
Tel: +49 (0)421 200 3226


From nhv at cape.com  Wed Nov 25 07:19:46 2015
From: nhv at cape.com (Norman Vine)
Date: Wed, 25 Nov 2015 10:19:46 -0500
Subject: [gdal-dev] Install python binding from pip
In-Reply-To: <CAMbW+CntP5K7buv-udORJKgRzNihXyHsG0iZeYTCbJRzSBNr7w@mail.gmail.com>
References: <CAMbW+CntP5K7buv-udORJKgRzNihXyHsG0iZeYTCbJRzSBNr7w@mail.gmail.com>
Message-ID: <CF6EE9FB-1C6E-40D8-84E0-E7738B4178F8@cape.com>


On Nov 25, 2015, at 10:14 AM, Xavier Barnada <xbarnada at gmail.com> wrote:

> Hi,
> 
> I'm trying to install it in a virtualenv in a Ubuntu and I get a message  about missing cpl_port.h file
> I currently have the gdal-dev installed and the cpl_port.h it's on /usr/include/gdal/
> I'm using an a 14.04 ubuntu with the 1.11.12 gdal version.
> Is this a bug or it have some trick to install gdal from pip?

This should help

http://gis.stackexchange.com/questions/28966/python-gdal-package-missing-header-file-when-installing-via-pip

From even.rouault at spatialys.com  Wed Nov 25 07:32:22 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2015 16:32:22 +0100
Subject: [gdal-dev] strange grid pattern when reprojecting
In-Reply-To: <5655D0C1.3010801@jacobs-university.de>
References: <5655D0C1.3010801@jacobs-university.de>
Message-ID: <201511251632.23253.even.rouault@spatialys.com>

Le mercredi 25 novembre 2015 16:16:17, Ramiro Marco Figuera a écrit :
> Hi all,
> 
> I noticed a curious gridded pattern when using gdalwarp to reproject. I
> am reprojecting some lunar south polar DEMs in stereographic projection
> to gnomonic projection. I am using the following command: gdalwarp
> -t_srs '+proj=gnom +lat_0=-90 +lon_0=0 +x_0=0 +y_0=0 +a=1737400
> +b=1737400 +units=m +no_defs ' topo_stereo.tif topo_gnom.tif

The default resampling of gdalwarp is nearest neighbour. Perhaps try something 
more advanced like -r bilinear or -r cubic ?

> 
> When I create a hillshaded map using gdaldem hillshade I can see a
> gridded pattern. I did a hillshaded map with the original map and the
> grid is no there. Am I making a mistake when reprojecting or is that a
> bug? I can provide images if necessary.
> 
> Cheers,
> 
> Ramiro

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicolas.cadieux at archeotec.ca  Wed Nov 25 12:27:17 2015
From: nicolas.cadieux at archeotec.ca (nicolas.cadieux at archeotec.ca)
Date: Wed, 25 Nov 2015 15:27:17 -0500
Subject: [gdal-dev] Null data and CRS. gdal_warp overkill???
Message-ID: <565619A5.1070503@archeotec.ca>

Hi,
I am creating a Windows .bat files with a Python script to make DEMs 
with LiDAR points.  The idea is simple.
1) read input txt  file to get the cloud geometries

2)gdal_grid with nodata value marker set to -32768

3)gdal_warp with -dstnodata to set the value marker (of grid created in 
step 2)

4)gdal_fillnotdata.py to replace the no data values (of grid created in 
step 3)

5)gdal_warp again with  -dstnodata to set the value marker (again as 
some values may still be outside of spet 4 search radius)

6)gdaldem hillshade made with DEM of set 5

7)gdal_warp again with -t_srs srs_def: to set the CRS of the Hillshade 
created in step 6.

It looks like I am loosing time with gdal_warp (step 3,5 and7) as I am 
reading a file, adding novalue data or setting CRS, then writing the new 
file and then deleting the old file.

Question: Is there another way of doing this without steps 3, 5 and 7 or 
did i get it right?

Thanks,
Nicolas
P.S.
I am using win7_64 and gdal 1.11.2.
//
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151125/43cd5f55/attachment.html>

From even.rouault at spatialys.com  Wed Nov 25 15:08:09 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Nov 2015 00:08:09 +0100
Subject: [gdal-dev] Null data and CRS. gdal_warp overkill???
In-Reply-To: <565619A5.1070503@archeotec.ca>
References: <565619A5.1070503@archeotec.ca>
Message-ID: <201511260008.09456.even.rouault@spatialys.com>

Le mercredi 25 novembre 2015 21:27:17, nicolas.cadieux at archeotec.ca a écrit :
> Hi,
> I am creating a Windows .bat files with a Python script to make DEMs
> with LiDAR points.  The idea is simple.
> 1) read input txt  file to get the cloud geometries
> 
> 2)gdal_grid with nodata value marker set to -32768
> 
> 3)gdal_warp with -dstnodata to set the value marker (of grid created in
> step 2)
> 
> 4)gdal_fillnotdata.py to replace the no data values (of grid created in
> step 3)
> 
> 5)gdal_warp again with  -dstnodata to set the value marker (again as
> some values may still be outside of spet 4 search radius)
> 
> 6)gdaldem hillshade made with DEM of set 5
> 
> 7)gdal_warp again with -t_srs srs_def: to set the CRS of the Hillshade
> created in step 6.
> 
> It looks like I am loosing time with gdal_warp (step 3,5 and7) as I am
> reading a file, adding novalue data or setting CRS, then writing the new
> file and then deleting the old file.
> 
> Question: Is there another way of doing this without steps 3, 5 and 7 or
> did i get it right?

Yes, you could use gdal_edit.py -a_nodata / -a_srs . See 
http://gdal.org/gdal_edit.html

> 
> Thanks,
> Nicolas
> P.S.
> I am using win7_64 and gdal 1.11.2.
> //

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 25 21:44:56 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 26 Nov 2015 05:44:56 +0000
Subject: [gdal-dev] Proposed Block iterator API
Message-ID: <b829e6ba818a48f3920c04a0bc99503c@C119S212VM022.msvyvi.vaha.local>

Hi,

I was wondering if this idea could resolve also this old ticket https://trac.osgeo.org/gdal/ticket/1233

-Jukka Rahkonen-

Even Rouault wrote:


Hi,



I was wondering if there wasn't a need for a block iterator API for code that

wants to process raster efficiently and iterates over blocks from top to bottom,

and left to write. Currently you have to create 2 for loops and deal with

partial blocks at edges (see

https://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/rasterio.cpp#L3576).

Nothing really fundamentaly complicated, but I guess people have to often

write that boring code and I'm sure there a lot of occurences of it inside

GDAL itself. The API just returns the coordinates of the window, but doesn't

do the pixel queries (people could use it to operate on a single band, or

multiple bands)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151126/0aacb6cd/attachment.html>

From nicolas.cadieux at archeotec.ca  Thu Nov 26 11:54:10 2015
From: nicolas.cadieux at archeotec.ca (nicolas.cadieux at archeotec.ca)
Date: Thu, 26 Nov 2015 14:54:10 -0500
Subject: [gdal-dev] Empty .prj file with gdal_contour
Message-ID: <56576362.1040705@archeotec.ca>

Hi,
On windows_64,
a) When I launch a .bat file with  gdal_contour from a dos prompt (from 
C:\GDAL1p5GBBuffer\bin or from C:\OSGeo4W64\bin ), I get an *empty* .prj 
file.

b) When I launch the same .bat file with  gdal_contour from the 
OSGeo4W64 Shell, I get a *proper* .prj file. Why???

My Windows system variable include  "GDAL_DATA = 
C:\OSGeo4W64\share\gdal".  This works as gdal_warp and gdal_edit in the 
same .bat file find the EPSG code but not gdal_contour.

Am I missing a system variable for OGR?

Thanks
Nicolas

P.S: C:\GDAL1p5GBBuffer\bin is where I have my own compiled version of 
gdal with a few modifications.  C:\OSGeo4W64\bin is out of the box.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151126/b826771a/attachment.html>

From sergio.segala.list at gmail.com  Thu Nov 26 14:32:51 2015
From: sergio.segala.list at gmail.com (Sergio Segala)
Date: Thu, 26 Nov 2015 23:32:51 +0100
Subject: [gdal-dev] GDAL2 and libgdal.so.1
Message-ID: <56578893.60802@gmail.com>

Hi,

i've compiled GDAL 2 (2.0.1) for my CentOS7 environment. On the same 
machine I try to install postgis2 (2.1) from the official PostgreSQL 
repository (pgdg), but the yum package system said that I need the 
libgdal.so.1 library which is not present on the system.
So I'd a look to the /usr/lib64/ and the files I have there are: 
libgdal.so and libgdal.so.20 which are symlink to libgdal.so.20.0.1 and 
of course the bynary file libgdal.so.20.0.1, but there is not the 
libgdal.so.1 file or link. The same situation is on some Fedora RPM I 
downloaded for test pourpose.

So the question is: Is possible to install the RPM of PostGIS2 with the 
building of GDAL2 (I mean without recompiling PostGIS2 package)?
If yes, the right way to do that and also to have a stable system is to 
create a symlink named libgdal.so.1 to libgdal.so.20.0.1?
If no, is there a way to have GDAL 1.11 and GDAL2 on the same system?

Thanks,
Sergio


From r.marcofiguera at jacobs-university.de  Fri Nov 27 02:09:32 2015
From: r.marcofiguera at jacobs-university.de (Ramiro Marco Figuera)
Date: Fri, 27 Nov 2015 11:09:32 +0100
Subject: [gdal-dev] strange grid pattern when reprojecting
In-Reply-To: <201511251632.23253.even.rouault@spatialys.com>
References: <5655D0C1.3010801@jacobs-university.de>
 <201511251632.23253.even.rouault@spatialys.com>
Message-ID: <56582BDC.5060100@jacobs-university.de>

Hi,

I've tried all the resampling methods and all of them produce a gridded 
pattern. Is there any other way of reprojecting the data using gdal?

Cheers,

Ramiro

On 11/25/2015 04:32 PM, Even Rouault wrote:
> Le mercredi 25 novembre 2015 16:16:17, Ramiro Marco Figuera a écrit :
>> Hi all,
>>
>> I noticed a curious gridded pattern when using gdalwarp to reproject. I
>> am reprojecting some lunar south polar DEMs in stereographic projection
>> to gnomonic projection. I am using the following command: gdalwarp
>> -t_srs '+proj=gnom +lat_0=-90 +lon_0=0 +x_0=0 +y_0=0 +a=1737400
>> +b=1737400 +units=m +no_defs ' topo_stereo.tif topo_gnom.tif
> The default resampling of gdalwarp is nearest neighbour. Perhaps try something
> more advanced like -r bilinear or -r cubic ?
>
>> When I create a hillshaded map using gdaldem hillshade I can see a
>> gridded pattern. I did a hillshaded map with the original map and the
>> grid is no there. Am I making a mistake when reprojecting or is that a
>> bug? I can provide images if necessary.
>>
>> Cheers,
>>
>> Ramiro

-- 
Ramiro Marco Figuera
Research Associate - PhD Student
Department of Physics and Earth Sciences
Jacobs University Bremen
Campus Ring 1, 28759 Bremen, Germany
Office: Research III, Room 99b
Tel: +49 (0)421 200 3226


From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov 27 03:25:11 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 27 Nov 2015 11:25:11 +0000
Subject: [gdal-dev] strange grid pattern when reprojecting
Message-ID: <da34c1340b60414c9d7f1e18d92cc299@C119S212VM022.msvyvi.vaha.local>

Hi,


Gdalwarp is the tool to use and usually it works well but your case is not the most common one "lunar south polar DEMs in stereographic projection to gnomonic projection." Best if you could put a sample image available somewhere but perhaps but there are some documents about advanced tricks like https://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp. I would test -et 0.



-Jukka Rahkonen-


Ramiro wrote:

Hi,

I've tried all the resampling methods and all of them produce a gridded
pattern. Is there any other way of reprojecting the data using gdal?

Cheers,

Ramiro

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151127/4366ebfc/attachment.html>

From ari.jolma at gmail.com  Fri Nov 27 03:58:01 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 27 Nov 2015 13:58:01 +0200
Subject: [gdal-dev] Slow warping
Message-ID: <56584549.1080306@gmail.com>

I warped an image for which I estimated a geotransform. I'm wondering 
why it took so long (hours).

My source image is a jpeg, lets call it src.jpg. I add the geotransform 
as a jpgw-file.

This goes fast:

gdal_translate -of JPEG src.jpg test.jpg
Input file size is 6048, 4032
0...10...20...30...40...50...60...70...80...90...100 - done.

but the result is not warped, there is a test.jpg-aux.xml file, which 
contains the original geotransform.

gdalwarp does not do it:

gdalwarp -of JPEG jpg-3067/09410_001.jpg test2.jpg
Output driver `JPEG' not recognised or does not support
direct output file creation.

Using the AutoCreateWarpedVRT in bindings works:

use Geo::GDAL;

my $dataset = Geo::GDAL::Open('src.jpg');
my $warped = Geo::GDAL::AutoCreateWarpedVRT($dataset);
Geo::GDAL::Driver('JPEG')->Copy('tets3.jpg', $warped, 1, undef, sub {my 
$prog = shift; say $prog});

but it is really slow.

Does QGIS use AutoCreateWarpedVRT when it does on-the-fly reprojection? 
It outputs

Warning: Creating Warped VRT.

to the terminal. And it is fast.

Ari



From even.rouault at spatialys.com  Fri Nov 27 04:10:18 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Nov 2015 13:10:18 +0100
Subject: [gdal-dev] Slow warping
In-Reply-To: <56584549.1080306@gmail.com>
References: <56584549.1080306@gmail.com>
Message-ID: <201511271310.19049.even.rouault@spatialys.com>

Le vendredi 27 novembre 2015 12:58:01, Ari Jolma a écrit :
> I warped an image for which I estimated a geotransform. I'm wondering
> why it took so long (hours).
> 
> My source image is a jpeg, lets call it src.jpg. I add the geotransform
> as a jpgw-file.
> 
> This goes fast:
> 
> gdal_translate -of JPEG src.jpg test.jpg
> Input file size is 6048, 4032
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> 
> but the result is not warped, there is a test.jpg-aux.xml file, which
> contains the original geotransform.
> 
> gdalwarp does not do it:
> 
> gdalwarp -of JPEG jpg-3067/09410_001.jpg test2.jpg
> Output driver `JPEG' not recognised or does not support
> direct output file creation.
> 
> Using the AutoCreateWarpedVRT in bindings works:
> 
> use Geo::GDAL;
> 
> my $dataset = Geo::GDAL::Open('src.jpg');
> my $warped = Geo::GDAL::AutoCreateWarpedVRT($dataset);
> Geo::GDAL::Driver('JPEG')->Copy('tets3.jpg', $warped, 1, undef, sub {my
> $prog = shift; say $prog});
> 
> but it is really slow.
> 
> Does QGIS use AutoCreateWarpedVRT when it does on-the-fly reprojection?

Yes

> It outputs
> 
> Warning: Creating Warped VRT.
> 
> to the terminal. And it is fast.

If the image is let's say upside-down, it might be that the block cache isn't 
large enough to handle the CreateCopy() and that the source JPEG must be fully 
uncompressed each time a line is warped. Try setting GDAL_CACHEMAX to 150 
(6048 * 4032 * 3 = 73 MB. and a x 2 security margin).
Look also if cache trashing warnings appear with CPL_DEBUG=ON

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Nov 27 04:43:34 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 27 Nov 2015 14:43:34 +0200
Subject: [gdal-dev] Slow warping
In-Reply-To: <201511271310.19049.even.rouault@spatialys.com>
References: <56584549.1080306@gmail.com>
 <201511271310.19049.even.rouault@spatialys.com>
Message-ID: <56584FF6.2020707@gmail.com>



27.11.2015, 14:10, Even Rouault kirjoitti:
> Try setting GDAL_CACHEMAX to 150 (6048 * 4032 * 3 = 73 MB. and a x 2 
> security margin)

This reduces the time into 4 s.

Quite a bit reduction from several hours.

Maybe the default is too low? 150 MB does not seem much.

Ari


From r.marcofiguera at jacobs-university.de  Fri Nov 27 05:06:18 2015
From: r.marcofiguera at jacobs-university.de (Ramiro Marco Figuera)
Date: Fri, 27 Nov 2015 14:06:18 +0100
Subject: [gdal-dev] strange grid pattern when reprojecting
In-Reply-To: <da34c1340b60414c9d7f1e18d92cc299@C119S212VM022.msvyvi.vaha.local>
References: <da34c1340b60414c9d7f1e18d92cc299@C119S212VM022.msvyvi.vaha.local>
Message-ID: <5658554A.4050409@jacobs-university.de>

Hi,

I've tried adding -et 0 and the grid feature is still there. Here is an 
example: https://www.dropbox.com/s/teywuev72pikcu6/grid.png?dl=0.

Cheers,

Ramiro



On 11/27/2015 12:25 PM, Rahkonen Jukka (MML) wrote:
>
> Hi,
>
> Gdalwarp is the tool to use and usually it works well but your case is 
> not the most common one “lunar south polar DEMs in stereographic 
> projection to gnomonic projection.” Best if you could put a sample 
> image available somewhere but perhaps but there are some documents 
> about advanced tricks like 
> https://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp. I would test –et 0.
> -Jukka Rahkonen-
>
> Ramiro wrote:
>
> Hi,
>
> I've tried all the resampling methods and all of them produce a gridded
>
> pattern. Is there any other way of reprojecting the data using gdal?
>
> Cheers,
>
> Ramiro
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Ramiro Marco Figuera
Research Associate - PhD Student
Department of Physics and Earth Sciences
Jacobs University Bremen
Campus Ring 1, 28759 Bremen, Germany
Office: Research III, Room 99b
Tel: +49 (0)421 200 3226

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151127/2fee20e0/attachment-0001.html>

From gane.prog at gmail.com  Fri Nov 27 05:57:24 2015
From: gane.prog at gmail.com (Gane R)
Date: Fri, 27 Nov 2015 19:27:24 +0530
Subject: [gdal-dev] Blob field support in Filegeodb
Message-ID: <CALMrLdAWfYOdjUn7VydVt=e4XKfsx85Y8f_8dGPH2wBcCYZ84w@mail.gmail.com>

Is the Blob read and write is supported in Filegeodb with ESRI Filegeodb
driver in GDAL. I am using gdal-1.11.3

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151127/54ad2b43/attachment.html>

From gane.prog at gmail.com  Fri Nov 27 05:58:09 2015
From: gane.prog at gmail.com (Gane R)
Date: Fri, 27 Nov 2015 19:28:09 +0530
Subject: [gdal-dev] Geometry not displayed with Filegeodb on GDAL 2.0.1
In-Reply-To: <CALMrLdBd77R--XG7o_40xxbCy-hKXwOQodvTKKYxbd4ecnFY2Q@mail.gmail.com>
References: <CALMrLdBd77R--XG7o_40xxbCy-hKXwOQodvTKKYxbd4ecnFY2Q@mail.gmail.com>
Message-ID: <CALMrLdB4x2gX9NX7YSv-7E4Oykn1eZfJO3kM+xnRx88+jYOcUA@mail.gmail.com>

I figured out the issue this was due to wrong API call.

Thanks
Gane

On Mon, Nov 23, 2015 at 9:59 PM, Gane R <gane.prog at gmail.com> wrote:

> Hi all,
>
> I tried to build *GDAL 2.0.1* with *filegeodb* support with *proj4* as
> static lib on *Linux*. I am able to use the API to get the field data from
> Filegeodb but I am *not able to get the geometry*.  I have configured as
>
> ./configure --with-fgdb=/fgdblib --with-static-proj4=/usr/local/
> --with-xml2=no --with-sqlite3=no --with-curl=no --with-expat=no
>
> I am wondering what went wrong. But ogrinfo shows the values of the same
> filegeodb file.
>
> Thanks
> Gane
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151127/8b26bfcc/attachment.html>

From even.rouault at spatialys.com  Fri Nov 27 06:06:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Nov 2015 15:06:27 +0100
Subject: [gdal-dev] Blob field support in Filegeodb
In-Reply-To: <CALMrLdAWfYOdjUn7VydVt=e4XKfsx85Y8f_8dGPH2wBcCYZ84w@mail.gmail.com>
References: <CALMrLdAWfYOdjUn7VydVt=e4XKfsx85Y8f_8dGPH2wBcCYZ84w@mail.gmail.com>
Message-ID: <201511271506.27262.even.rouault@spatialys.com>

Le vendredi 27 novembre 2015 14:57:24, Gane R a écrit :
> Is the Blob read and write is supported in Filegeodb with ESRI Filegeodb
> driver in GDAL. I am using gdal-1.11.3

Yes

> 
> Thanks
> Gane

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Nov 28 07:13:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 28 Nov 2015 16:13:55 +0100
Subject: [gdal-dev] Changing default value for GDAL_CACHEMAX ? (was Re: Slow
	warping)
In-Reply-To: <56584FF6.2020707@gmail.com>
References: <56584549.1080306@gmail.com>
 <201511271310.19049.even.rouault@spatialys.com> <56584FF6.2020707@gmail.com>
Message-ID: <201511281613.55336.even.rouault@spatialys.com>

Le vendredi 27 novembre 2015 13:43:34, Ari Jolma a écrit :
> 27.11.2015, 14:10, Even Rouault kirjoitti:
> > Try setting GDAL_CACHEMAX to 150 (6048 * 4032 * 3 = 73 MB. and a x 2
> > security margin)
> 
> This reduces the time into 4 s.
> 
> Quite a bit reduction from several hours.
> 
> Maybe the default is too low? 150 MB does not seem much.

Setting the default is not obvious because it depends on use cases and 
hardware configurations. What if people run 100 gdal_translate in parallel ? 
(not very common use cases admidetely, and people can still override the 
default)

Perhaps rather than a fixed value, a percentage of the total RAM would be more 
appropriate (*). Let's say 5% ? 
2 GB (which is the max for a 32 bit process) -> 100 MB
4 GB -> 200 MB
16 GB -> 800 MB.

We could also accept a GDAL_CACHEMAX=X% syntax

Even

(*) the ECW SDK does that for its own purposes, with a 25% default AFAIR

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From alexto1978 at gmail.com  Sat Nov 28 18:47:03 2015
From: alexto1978 at gmail.com (alexto1978)
Date: Sun, 29 Nov 2015 10:47:03 +0800
Subject: [gdal-dev] =?utf-8?b?5Zue5aSN77yaIGdkYWwtZGV2IERpZ2VzdCwgVm9sIDEz?=
 =?utf-8?q?8=2C_Issue_50?=
Message-ID: <dqd66dmu06nayh1ls83v64jn.1448765223926@email.android.com>


    
hello, i want to unsubscribe the email, and i cannot unsubscribe by website,thanj you.


发送自我的三星设备

-------- 原始邮件 --------
发件人： gdal-dev-request at lists.osgeo.org 
日期: 2015-11-29  04:00  (GMT+08:00) 
收件人： gdal-dev at lists.osgeo.org 
主题： gdal-dev Digest, Vol 138, Issue 50 

Send gdal-dev mailing list submissions to
	gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
	gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
	gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Changing default value for GDAL_CACHEMAX ? (was Re: Slow
      warping) (Even Rouault)


----------------------------------------------------------------------

Message: 1
Date: Sat, 28 Nov 2015 16:13:55 +0100
From: Even Rouault <even.rouault at spatialys.com>
To: Ari Jolma <ari.jolma at gmail.com>
Cc: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Changing default value for GDAL_CACHEMAX ? (was
	Re: Slow	warping)
Message-ID: <201511281613.55336.even.rouault at spatialys.com>
Content-Type: Text/Plain;  charset="utf-8"

Le vendredi 27 novembre 2015 13:43:34, Ari Jolma a écrit :
> 27.11.2015, 14:10, Even Rouault kirjoitti:
> > Try setting GDAL_CACHEMAX to 150 (6048 * 4032 * 3 = 73 MB. and a x 2
> > security margin)
> 
> This reduces the time into 4 s.
> 
> Quite a bit reduction from several hours.
> 
> Maybe the default is too low? 150 MB does not seem much.

Setting the default is not obvious because it depends on use cases and 
hardware configurations. What if people run 100 gdal_translate in parallel ? 
(not very common use cases admidetely, and people can still override the 
default)

Perhaps rather than a fixed value, a percentage of the total RAM would be more 
appropriate (*). Let's say 5% ? 
2 GB (which is the max for a 32 bit process) -> 100 MB
4 GB -> 200 MB
16 GB -> 800 MB.

We could also accept a GDAL_CACHEMAX=X% syntax

Even

(*) the ECW SDK does that for its own purposes, with a 25% default AFAIR

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

------------------------------

End of gdal-dev Digest, Vol 138, Issue 50
*****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151129/99968e10/attachment.html>

From dadler at adtechgeospatial.com  Sun Nov 29 04:18:52 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Sun, 29 Nov 2015 07:18:52 -0500
Subject: [gdal-dev] Problem building GDAL on Ubuntu
Message-ID: <565AED2C.2090804@adtechgeospatial.com>

For the first time I am trying to do development on an Ubuntu system.

After installing various tools, checking out the trunk source and 
configuring, make appears to compile all the source ok but fails in 
libtool with the following messages:

make[1]: Entering directory `/home/davea/gdal'
/bin/bash /home/davea/gdal/libtool --mode=link    g++   -lpthread -lm 
-lrt -ldl                     -o libgdal.la 
/home/davea/gdal/frmts/o/*.lo /home/davea/gdal/gcore/*.lo 
/home/davea/gdal/port/*.lo /home/davea/gdal/alg/*.lo 
/home/davea/gdal/apps/commonutils.lo 
/home/davea/gdal/apps/gdalinfo_lib.lo 
/home/davea/gdal/apps/gdal_translate_lib.lo 
/home/davea/gdal/apps/gdalwarp_lib.lo 
/home/davea/gdal/apps/ogr2ogr_lib.lo 
/home/davea/gdal/apps/gdaldem_lib.lo 
/home/davea/gdal/apps/nearblack_lib.lo 
/home/davea/gdal/apps/gdal_grid_lib.lo 
/home/davea/gdal/apps/gdal_rasterize_lib.lo 
/home/davea/gdal/ogr/ogrsf_frmts/o/*.lo ./ogr/ogrgeometryfactory.lo 
./ogr/ogrpoint.lo ./ogr/ogrcurve.lo ./ogr/ogrlinestring.lo 
./ogr/ogrlinearring.lo ./ogr/ogrpolygon.lo ./ogr/ogrutils.lo 
./ogr/ogrgeometry.lo ./ogr/ogrgeometrycollection.lo 
./ogr/ogrmultipolygon.lo ./ogr/ogrsurface.lo ./ogr/ogrmultipoint.lo 
./ogr/ogrmultilinestring.lo ./ogr/ogrcircularstring.lo 
./ogr/ogrcompoundcurve.lo ./ogr/ogrcurvepolygon.lo 
./ogr/ogrcurvecollection.lo ./ogr/ogrmulticurve.lo 
./ogr/ogrmultisurface.lo ./ogr/ogr_api.lo ./ogr/ogrfeature.lo 
./ogr/ogrfeaturedefn.lo ./ogr/ogrfeaturequery.lo 
./ogr/ogrfeaturestyle.lo ./ogr/ogrfielddefn.lo 
./ogr/ogrspatialreference.lo ./ogr/ogr_srsnode.lo ./ogr/ogr_srs_proj4.lo 
./ogr/ogr_fromepsg.lo ./ogr/ogrct.lo ./ogr/ogr_opt.lo 
./ogr/ogr_srs_esri.lo ./ogr/ogr_srs_pci.lo ./ogr/ogr_srs_usgs.lo 
./ogr/ogr_srs_dict.lo ./ogr/ogr_srs_panorama.lo ./ogr/ogr_srs_ozi.lo 
./ogr/ogr_srs_erm.lo ./ogr/swq.lo ./ogr/swq_expr_node.lo 
./ogr/swq_parser.lo ./ogr/swq_select.lo ./ogr/swq_op_registrar.lo 
./ogr/swq_op_general.lo ./ogr/ogr_srs_validate.lo ./ogr/ogr_srs_xml.lo 
./ogr/ograssemblepolygon.lo ./ogr/ogr2gmlgeometry.lo 
./ogr/gml2ogrgeometry.lo ./ogr/ogr_expat.lo ./ogr/ogrpgeogeometry.lo 
./ogr/ogrgeomediageometry.lo ./ogr/ogr_geocoding.lo ./ogr/osr_cs_wkt.lo 
./ogr/osr_cs_wkt_parser.lo ./ogr/ogrgeomfielddefn.lo ./ogr/ograpispy.lo \
         -rpath /usr/local/lib \
         -no-undefined \
         -version-info 20:0:0
libtool: link: unable to infer tagged configuration

libtool: link: specify a tag with `--tag'
make[1]: *** [libgdal.la] Error 1
make: *** [check-lib] Error 2

Did I miss something in the setup process?

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Sun Nov 29 04:28:59 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 29 Nov 2015 13:28:59 +0100
Subject: [gdal-dev] Problem building GDAL on Ubuntu
In-Reply-To: <565AED2C.2090804@adtechgeospatial.com>
References: <565AED2C.2090804@adtechgeospatial.com>
Message-ID: <201511291328.59775.even.rouault@spatialys.com>

Le dimanche 29 novembre 2015 13:18:52, David Adler a écrit :
> For the first time I am trying to do development on an Ubuntu system.

Which Ubuntu version ?

> After installing various tools, checking out the trunk source and
> configuring, make appears to compile all the source ok but fails in
> libtool with the following messages:

> libtool: link: unable to infer tagged configuration
> 
> libtool: link: specify a tag with `--tag'
> make[1]: *** [libgdal.la] Error 1
> make: *** [check-lib] Error 2
> 
> Did I miss something in the setup process?

There's an old ticket somehow related:
https://trac.osgeo.org/gdal/ticket/4436

> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dadler at adtechgeospatial.com  Sun Nov 29 06:40:17 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Sun, 29 Nov 2015 09:40:17 -0500
Subject: [gdal-dev] Problem building GDAL on Ubuntu - solved
In-Reply-To: <201511291328.59775.even.rouault@spatialys.com>
References: <565AED2C.2090804@adtechgeospatial.com>
 <201511291328.59775.even.rouault@spatialys.com>
Message-ID: <565B0E51.2010702@adtechgeospatial.com>

Thank you for the quick response on a Sunday morning.

I'm using Ubuntu 14.04 LTS. The problem was as described in the 
referenced ticket - I didn't see the error when running ./configure.

It all seems to work now.

On 11/29/2015 7:28 AM, Even Rouault wrote:
> Le dimanche 29 novembre 2015 13:18:52, David Adler a écrit :
>> For the first time I am trying to do development on an Ubuntu system.
> Which Ubuntu version ?
>
>> After installing various tools, checking out the trunk source and
>> configuring, make appears to compile all the source ok but fails in
>> libtool with the following messages:
>> libtool: link: unable to infer tagged configuration
>>
>> libtool: link: specify a tag with `--tag'
>> make[1]: *** [libgdal.la] Error 1
>> make: *** [check-lib] Error 2
>>
>> Did I miss something in the setup process?
> There's an old ticket somehow related:
> https://trac.osgeo.org/gdal/ticket/4436
>
>> ---
>> This email has been checked for viruses by Avast antivirus software.
>> https://www.avast.com/antivirus
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 30 00:11:52 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 30 Nov 2015 08:11:52 +0000
Subject: [gdal-dev] strange grid pattern when reprojecting
Message-ID: <6830dd39558749159de984453640f840@C119S212VM022.msvyvi.vaha.local>

Hi,

Sorry for being unclear, I meant a sample of source data that could be used for reproducing the issue, not a sample of output with a grid artifact.

-Jukka Rahkonen-

> Hi,

> I've tried adding -et 0 and the grid feature is still there. Here is an example: https://www.dropbox.com/s/teywuev72pikcu6/grid.png?dl=0.

> Cheers,

> Ramiro
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20151130/844f5157/attachment.html>

From dadler at adtechgeospatial.com  Mon Nov 30 13:24:20 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Mon, 30 Nov 2015 16:24:20 -0500
Subject: [gdal-dev] Convention for class member names
Message-ID: <565CBE84.80606@adtechgeospatial.com>

In the gpkg code, the member names all appear to be prefixed with 'm_'.

Is this a new convention?

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From mateusz at loskot.net  Mon Nov 30 14:13:39 2015
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 30 Nov 2015 23:13:39 +0100
Subject: [gdal-dev] Convention for class member names
In-Reply-To: <565CBE84.80606@adtechgeospatial.com>
References: <565CBE84.80606@adtechgeospatial.com>
Message-ID: <CABUeae8BEsxHtmiCd1AC9GMiSAKoMkbzzsmHHeM0FPY4iROSiQ@mail.gmail.com>

On 30 November 2015 at 22:24, David Adler <dadler at adtechgeospatial.com> wrote:
> In the gpkg code, the member names all appear to be prefixed with 'm_'.
>
> Is this a new convention?

AFAIK, yes, but it looks like it's missing from
https://trac.osgeo.org/gdal/wiki/rfc8_devguide

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

