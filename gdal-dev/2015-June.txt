From even.rouault at spatialys.com  Mon Jun  1 00:17:01 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Jun 2015 09:17:01 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <556BF20B.20205@gmail.com>
References: <55642437.2040603@gmail.com>
	<201505291052.51428.even.rouault@spatialys.com>
	<556BF20B.20205@gmail.com>
Message-ID: <201506010917.02123.even.rouault@spatialys.com>

Le lundi 01 juin 2015 07:47:55, Ari Jolma a ?crit :
> On 29.05.2015 11:52, Even Rouault wrote:
> > As it might be difficult in practice to coordinate with all
> > maintainers at the exact time were things are needed, perhaps we need
> > some wiki page to document which new methods have been added and which
> > languages are impacted, so that the maintainer can look at it when he
> > has time and add the needed typemaps.
> 
> Would a) a message to this list

Would be welcome to make other maintainers aware, but we can't rely only on 
emails since they easily get forgotten and aren't the best support to reflect 
an evolving state.

> and b) an addition to a README file in
> swig be enough?

My suggestion for wiki was that this was more a work document, a todo list, 
that hasn't necessarily to be put in version control, but that could be fine 
too.

> 
> There is swig/include/README.typemaps, which IMO could be renamed to
> swig/README and made a bit larger in its scope.
> 
> Hm. Maybe c) a wiki page could also be of use. I haven't written to the
> wiki in a long time except to make some small updates. I could work on
> that a bit. The wiki should reference the README and vice versa.
> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From liminlu0314 at 163.com  Mon Jun  1 05:53:33 2015
From: liminlu0314 at 163.com (liminlu0314)
Date: Mon, 1 Jun 2015 05:53:33 -0700 (PDT)
Subject: [gdal-dev] GDAL Landsat Dirver
Message-ID: <1433163213067-5208438.post@n6.nabble.com>

Hi All , 
       I am a user of GDAL. During the appliance of GDAL, I found that GDAL
doesn?t support the formats of Landsat 5, Landsat 7 and Landsat 8 data
products. Therefore I wrote a format-extension for GDAL to support the
formats of Landsat 5, Landsat 7 and Landsat 8 data products. I wondered
whether this format-extension could be adopted by GDAL. 
       The input data path is the metadata of Landsat, which are generally
named as *_MTL.txt. Three sub-datasets are included, namely Panchromatic
data, Reflective data and Thermal Infrared Sensor (TIRS) data.
       The format of sub-datasets are as following:
LANDSAT:1:F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
       Note:
       LANDSAT : identifier
       1:index of data type (0 means Panchromatic, 1means Reflective, 2
means TIRS).
       
The attachment is the source code that I wrote for Landsat data formats.
The screenshot below is the zip file structure of Landsat 5 and 8. The zip
file structure of Landsat 7 is similar to that of Landsat 5.

  <http://osgeo-org.1560.x6.nabble.com/file/n5208438/1.jpg> 
Fig 1. The zip file structure of Landsat 5 and Landsat 7
  <http://osgeo-org.1560.x6.nabble.com/file/n5208438/2.jpg> 
Fig 2. The zip file structure of Landsat 8

The short name of data driver that I newly added is LANDSAT. Three
sub-datasets are included, namely Panchromatic data, Reflective data and
TIRS data.

Below is an example. The input file is a Landsat 8 data named ?*_MTL.txt?.
Fig 3 is the output information by gdalinfo. It can be seen that four
sub-datasets are included. 
  <http://osgeo-org.1560.x6.nabble.com/file/n5208438/3.jpg> 
Fig 3. Output information of gdalinfo.
F:\Work\GDAL\gdal-1.11.2_new\gdal-1.11.2>gdalinfo.exe
F:\Data\LandSat\LS8_O_2013
1022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt -nomd
Driver: LANDSAT/LANDSAT 7/8 GeoTiff with Metadata
Files:
F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
Size is 512, 512
Coordinate System is `'
Subdatasets:
 
SUBDATASET_1_NAME=LANDSAT:0:F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
  SUBDATASET_1_DESC=LANDSAT:Panchromatic
 
SUBDATASET_2_NAME=LANDSAT:1:F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
  SUBDATASET_2_DESC=LANDSAT:Reflective
 
SUBDATASET_3_NAME=LANDSAT:2:F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
  SUBDATASET_3_DESC=LANDSAT:Thermal
 
SUBDATASET_4_NAME=LANDSAT:3:F:\Data\LandSat\LS8_O_20131022_032724_000000_128035_GEOTIFF_L4\LO81280352013295BJC00_MTL.txt
  SUBDATASET_4_DESC=LANDSAT:Quality
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

Fig 4 is the information of the second sub-dataset (i.e., the Reflective
data )output by gdalinfo. It can be seen that eight sub-datasets are
included.

  <http://osgeo-org.1560.x6.nabble.com/file/n5208438/4.jpg> 
Fig 4. Output information of gdalinfo.


Best regards 




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Landsat-Dirver-tp5208438.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From liminlu0314 at 163.com  Mon Jun  1 05:55:43 2015
From: liminlu0314 at 163.com (liminlu0314)
Date: Mon, 1 Jun 2015 05:55:43 -0700 (PDT)
Subject: [gdal-dev] GDAL Landsat Dirver
In-Reply-To: <1433163213067-5208438.post@n6.nabble.com>
References: <1433163213067-5208438.post@n6.nabble.com>
Message-ID: <1433163343624-5208440.post@n6.nabble.com>

landsatdataset.cpp
<http://osgeo-org.1560.x6.nabble.com/file/n5208440/landsatdataset.cpp>  

landsatdataset.cpp is LANDSAT Driver source code



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Landsat-Dirver-tp5208438p5208440.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bishop.dev at gmail.com  Mon Jun  1 06:26:17 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Mon, 01 Jun 2015 16:26:17 +0300
Subject: [gdal-dev] GDAL Landsat Dirver
In-Reply-To: <1433163343624-5208440.post@n6.nabble.com>
References: <1433163213067-5208438.post@n6.nabble.com>
	<1433163343624-5208440.post@n6.nabble.com>
Message-ID: <556C5D79.1060307@gmail.com>

Hi,

I would like to note that the Landsat metadata files support added to 
GDAL 2.0 
(https://svn.osgeo.org/gdal/trunk/gdal/gcore/mdreader/reader_landsat.cpp)
I think you can use this metadata reader to parse Landsat metadata file, 
or set to the Landsat dataset the imagery metadata in same manner.
Also, I think the tests for new format in autotest 
(https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/) folder needed.

And, it seems to me that the use:
         char** papszBandMeta = NULL;
         papszBandMeta = CSLAddString(papszBandMeta, pszFilename);
         pLandsatBand->SetMetadata(papszBandMeta);
         poDS->SetBand( iBand+1, pLandsatBand);

should ended with free papszBandMeta array:
         CSLDestroy(papszBandMeta);

But the new driver look promising!

Best regards,
     Dmitry

01.06.2015 15:55, liminlu0314 ?????:
> landsatdataset.cpp
> <http://osgeo-org.1560.x6.nabble.com/file/n5208440/landsatdataset.cpp>
>
> landsatdataset.cpp is LANDSAT Driver source code
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Landsat-Dirver-tp5208438p5208440.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From even.rouault at spatialys.com  Mon Jun  1 06:45:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Jun 2015 15:45:37 +0200
Subject: [gdal-dev] GDAL Landsat Dirver
In-Reply-To: <556C5D79.1060307@gmail.com>
References: <1433163213067-5208438.post@n6.nabble.com>
	<1433163343624-5208440.post@n6.nabble.com>
	<556C5D79.1060307@gmail.com>
Message-ID: <201506011545.37993.even.rouault@spatialys.com>

Hi,

Actually there's another Landsat-8 driver sitting in an attachment to a ticket 
in Trac : https://trac.osgeo.org/gdal/ticket/5501

Even

> Hi,
> 
> I would like to note that the Landsat metadata files support added to
> GDAL 2.0
> (https://svn.osgeo.org/gdal/trunk/gdal/gcore/mdreader/reader_landsat.cpp)
> I think you can use this metadata reader to parse Landsat metadata file,
> or set to the Landsat dataset the imagery metadata in same manner.
> Also, I think the tests for new format in autotest
> (https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/) folder needed.
> 
> And, it seems to me that the use:
>          char** papszBandMeta = NULL;
>          papszBandMeta = CSLAddString(papszBandMeta, pszFilename);
>          pLandsatBand->SetMetadata(papszBandMeta);
>          poDS->SetBand( iBand+1, pLandsatBand);
> 
> should ended with free papszBandMeta array:
>          CSLDestroy(papszBandMeta);
> 
> But the new driver look promising!
> 
> Best regards,
>      Dmitry
> 
> 01.06.2015 15:55, liminlu0314 ?????:
> > landsatdataset.cpp
> > <http://osgeo-org.1560.x6.nabble.com/file/n5208440/landsatdataset.cpp>
> > 
> > landsatdataset.cpp is LANDSAT Driver source code
> > 
> > 
> > 
> > --
> > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/GDAL-Landsat-Dirver-tp5208438p520844
> > 0.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JPalmer at linz.govt.nz  Mon Jun  1 19:30:38 2015
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Tue, 2 Jun 2015 14:30:38 +1200
Subject: [gdal-dev] How to hide the GML in WFS
Message-ID: <C6B695652D5E6B4597E90C5734C024262559C0362A@prdlsmmsg01.ad.linz.govt.nz>

How do you hide the gml_id field from a WFS service? I think I'm setting the correct configuration options, but it doesn't seem to work:

ogrinfo --config GML_EXPOSE_GML_ID NO --config GML_EXPOSE_FID NO -al -so WFS:"https://data.linz.govt.nz/services;key=59f2aaa148bd4818994fa0d3ca36f7e1/wfs/layer-328?service=WFS&request=GetCapabilities" -nomd

ERROR 1: Server is read-only WFS; no WFS-T feature advertized
Had to open data source read-only.
INFO: Open of `WFS:https://data.linz.govt.nz/services;key=3b7124f23806431c8371f139ec84c40e/wfs/layer-328?service=WFS&request=GetCapabilities'
      using driver `WFS' successful.

Layer name: data.linz.govt.nz:layer-328
Geometry: Curve Polygon
Feature Count: 5323
Extent: (1090143.356755, 4767706.953525) - (2089165.570574, 6191066.947320)
Layer SRS WKT:
PROJCS["NZGD2000 / New Zealand Transverse Mercator 2000",
    GEOGCS["NZGD2000",
        DATUM["New_Zealand_Geodetic_Datum_2000",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6167"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4167"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",173],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",1600000],
    PARAMETER["false_northing",10000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","2193"]]
Geometry Column = GEOMETRY
gml_id: String (0.0) NOT NULL
t50_fid: Integer64 (0.0)


Interestingly if I use the new GDAL 2.0 open options (ie. ogrinfo -oo GML_EXPOSE_GML_ID=NO -oo GML_EXPOSE_FID=NO). I get:

Warning 6: driver WFS does not support open option GML_EXPOSE_GML_ID
Warning 6: driver WFS does not support open option GML_EXPOSE_FID

I'm using GDAL 2.0 beta 2.

Thanks
Jeremy

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun  2 00:11:03 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 2 Jun 2015 07:11:03 +0000 (UTC)
Subject: [gdal-dev] How to hide the GML in WFS
References: <C6B695652D5E6B4597E90C5734C024262559C0362A@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <loom.20150602T082650-614@post.gmane.org>

Jeremy Palmer <JPalmer <at> linz.govt.nz> writes:

> 
> How do you hide the gml_id field from a WFS service? I think I'm setting
the correct configuration options,
> but it doesn't seem to work:
...
> 
> Interestingly if I use the new GDAL 2.0 open options (ie. ogrinfo -oo
GML_EXPOSE_GML_ID=NO -oo
> GML_EXPOSE_FID=NO). I get:
> 
> Warning 6: driver WFS does not support open option GML_EXPOSE_GML_ID
> Warning 6: driver WFS does not support open option GML_EXPOSE_FID
> 
> I'm using GDAL 2.0 beta 2.
> 
> Thanks
> Jeremy


Hi,

Documentation of the WFS driver and config options
http://www.gdal.org/drv_wfs.html
https://trac.osgeo.org/gdal/wiki/ConfigOptions do not mention that
GML_EXPOSE_GML_ID and GML_EXPOSE_FID are supported. Compare with another
configuration option: 

GML_INVERT_AXIS_ORDER_IF_LAT_LONG
GML driver specific. Added in GDAL/OGR 1.8.0. See ?GML driver documentation.
Also impacts WFS driver behaviour. 

I think that you are trying to use a non-existing feature. I don't know why
it could not be supported, though. Wait for a confirmation from some
developer and consider making a feature request. For me ogrinfo from the
data I captured from WFS and saved into GML with default parameters looks
indeed confusing:

OGRFeature(lv_editable_points):12
  fid (String) = lv_editable_points.12
  gml_id (String) = editable_points.13
  string (String) = kkk
....


-Jukka Rahkonen-

From even.rouault at spatialys.com  Tue Jun  2 01:10:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Jun 2015 10:10:57 +0200
Subject: [gdal-dev] How to hide the GML in WFS
In-Reply-To: <C6B695652D5E6B4597E90C5734C024262559C0362A@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C024262559C0362A@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <201506021010.57781.even.rouault@spatialys.com>

Hi Jeremy,

> How do you hide the gml_id field from a WFS service? 

You couldn't. In the case of GML returned by a WFS service, the GML driver 
ignored the value of GML_EXPOSE_GML_ID. This was presumably to make WFS-T 
work, but seeing the code again, it should be robust (meaning not crash, but 
properly error out) if gml_id is hidden. So now fixed.

> ogrinfo --config GML_EXPOSE_GML_ID NO --config GML_EXPOSE_FID NO -al -so
> WFS:"https://data.linz.govt.nz/services;key=59f2aaa148bd4818994fa0d3ca36f7
> e1/wfs/layer-328?service=WFS&request=GetCapabilities" -nomd

Side remark: for faster execution (at least from my side of the Earth), if you 
just need the schema, you can also add -nocount -noextent. And no -ro to avoid 
an attempt in WFS-T.

> 
> Interestingly if I use the new GDAL 2.0 open options (ie. ogrinfo -oo
> GML_EXPOSE_GML_ID=NO -oo GML_EXPOSE_FID=NO). I get:
> 
> Warning 6: driver WFS does not support open option GML_EXPOSE_GML_ID
> Warning 6: driver WFS does not support open option GML_EXPOSE_FID

The open options were for the GML driver, not the WFS driver. And their name 
is without the GML_ prefix. The rationale for the open option name to be not 
prefixed is that we don't need the GML_ context anymore, open options being 
explicitely assigned to a particular dataset opening, whereas configuration 
options are global.

For consistency, I've also just added the EXPOSE_GML_ID open option to the WFS 
driver.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JPalmer at linz.govt.nz  Tue Jun  2 04:18:16 2015
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Tue, 2 Jun 2015 23:18:16 +1200
Subject: [gdal-dev] How to hide the GML in WFS
In-Reply-To: <201506021010.57781.even.rouault@spatialys.com>
References: <C6B695652D5E6B4597E90C5734C024262559C0362A@prdlsmmsg01.ad.linz.govt.nz>,
	<201506021010.57781.even.rouault@spatialys.com>
Message-ID: <C6B695652D5E6B4597E90C5734C024262559C0362D@prdlsmmsg01.ad.linz.govt.nz>

________________________________________
From: Even Rouault [even.rouault at spatialys.com]
Sent: Tuesday, 2 June 2015 8:10 p.m.
To: gdal-dev at lists.osgeo.org
Cc: Jeremy Palmer
Subject: Re: [gdal-dev] How to hide the GML in WFS

> You couldn't. In the case of GML returned by a WFS service, the GML driver
> ignored the value of GML_EXPOSE_GML_ID. This was presumably to make WFS-T
> work, but seeing the code again, it should be robust (meaning not crash, but
> properly error out) if gml_id is hidden. So now fixed.

Thank you Even!

>> ogrinfo --config GML_EXPOSE_GML_ID NO --config GML_EXPOSE_FID NO -al -so
>> WFS:"https://data.linz.govt.nz/services;key=59f2aaa148bd4818994fa0d3ca36f7
>> e1/wfs/layer-328?service=WFS&request=GetCapabilities" -nomd

> Side remark: for faster execution (at least from my side of the Earth), if you
> just need the schema, you can also add -nocount -noextent. And no -ro to avoid
> an attempt in WFS-T.

I was being lazy with the -ro omission, but didn't see the new -nocount and -noextent options from GDAL 2.0 - thanks!

> For consistency, I've also just added the EXPOSE_GML_ID open option to the WFS
> driver.

Cheers Jeremy!

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From even.rouault at spatialys.com  Wed Jun  3 01:58:05 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Jun 2015 10:58:05 +0200
Subject: [gdal-dev] 2.0 branch created
Message-ID: <201506031058.05241.even.rouault@spatialys.com>

Hi,

I've just created the 2.0 branch so that development in trunk is not blocked 
during the 2.0.0 release process.
So any fixes that should go to 2.0.0 (and later 2.0.X releases once 2.0.0 is 
out) should go to branches/2.0 and trunk.
trunk is now 2.1.0dev

I'm still intending to snapshot the 2.0 branch as 2.0.0RC1 by the end of this 
week.

Regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jun  3 02:13:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Jun 2015 11:13:51 +0200
Subject: [gdal-dev] Motion: adopt RFC 58: Removing Dataset Nodata Value
Message-ID: <201506031113.51977.even.rouault@spatialys.com>

Hi,

As no points have been raised on the RFC itself (peripheral discussions on how 
to address out-of-range nodata values) :

Motion : I move to adopt RFC 58: Removing Dataset Nodata Value

https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value

Starting with my +1

Best regards,

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From koen.marien at histogenex.com  Wed Jun  3 02:15:16 2015
From: koen.marien at histogenex.com (Koen2704)
Date: Wed, 3 Jun 2015 02:15:16 -0700 (PDT)
Subject: [gdal-dev] gdal_translate and gdal_gdaladdo to create tiled
 pyrimidal tiffs: grey?
Message-ID: <1433322916607-5208842.post@n6.nabble.com>

Dear community 


I am trying to create tiled pyrimidal tifs through GDAL library tools: 
First I do: gdal_translate test.tif tiled_test.tif -b 1 -b 2 -b 3 -co
COMPRESS=JPEG -co PHOTOMETRIC=RGB, then I do: gdal_gdaladdo --config
COMPRESS_OVERVIEW JPEG --config PHOTOMETRIC_OVERVIEW RGB --config
INTERLEAVE_OVERVIEW PIXEL -ro tiled_test.tif 2 4 8 16 

In the end I get a nice tiled pyrimidal tif, but it is greyscale?! How do I
keep the colors?!



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-and-gdal-gdaladdo-to-create-tiled-pyrimidal-tiffs-grey-tp5208842.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun  3 02:34:29 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Jun 2015 11:34:29 +0200
Subject: [gdal-dev] gdal_translate and gdal_gdaladdo to create tiled
	pyrimidal tiffs: grey?
In-Reply-To: <1433322916607-5208842.post@n6.nabble.com>
References: <1433322916607-5208842.post@n6.nabble.com>
Message-ID: <201506031134.29720.even.rouault@spatialys.com>

Le mercredi 03 juin 2015 11:15:16, Koen2704 a ?crit :
> Dear community
> 
> 
> I am trying to create tiled pyrimidal tifs through GDAL library tools:
> First I do: gdal_translate test.tif tiled_test.tif -b 1 -b 2 -b 3 -co
> COMPRESS=JPEG -co PHOTOMETRIC=RGB, 

Note: the resulting dataset will not be tiled if you don't specify -co 
TILED=YES

> then I do: gdal_gdaladdo --config
> COMPRESS_OVERVIEW JPEG --config PHOTOMETRIC_OVERVIEW RGB --config
> INTERLEAVE_OVERVIEW PIXEL -ro tiled_test.tif 2 4 8 16
> 
> In the end I get a nice tiled pyrimidal tif, but it is greyscale?! How do I
> keep the colors?!

That's surprising. Are you sure the viewer is using overviews properly ? You 
could try "gdal_translate tiled_test.tif.ovr ovr2.tif" and display ovr2.tif. 
If it looks OK, then it's likely an issue with the viewer. If it is greyscale 
then there's a strange issue for which sharing your dataset would be good for 
further investigation.

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-translate-and-gdal-gdaladdo-to-cr
> eate-tiled-pyrimidal-tiffs-grey-tp5208842.html Sent from the GDAL - Dev
> mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From koen.marien at histogenex.com  Wed Jun  3 02:44:51 2015
From: koen.marien at histogenex.com (Koen2704)
Date: Wed, 3 Jun 2015 02:44:51 -0700 (PDT)
Subject: [gdal-dev] gdal_translate and gdal_gdaladdo to create tiled
 pyrimidal tiffs: grey?
In-Reply-To: <201506031134.29720.even.rouault@spatialys.com>
References: <1433322916607-5208842.post@n6.nabble.com>
	<201506031134.29720.even.rouault@spatialys.com>
Message-ID: <1433324691179-5208852.post@n6.nabble.com>

Dear Even

There is an issue with the viewer! Why didn't I check this first?!
But I also liked a review of my commands, and they should be okay now when I
include the '-co TILED=YES'.

Thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-and-gdal-gdaladdo-to-create-tiled-pyrimidal-tiffs-grey-tp5208842p5208852.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From vesnikos at gmail.com  Wed Jun  3 04:31:57 2015
From: vesnikos at gmail.com (Nick Ves)
Date: Wed, 3 Jun 2015 14:31:57 +0300
Subject: [gdal-dev] EarthWatch/DigitalGlobe .TIL format geotransform
 origin shifted
In-Reply-To: <1431679699.5555b2d3d9d09@imp.free.fr>
References: <CALqbEi5SYBFTiTfGPBB94C9JRCTKKzHDkWuv_7k88752v+Xwaw@mail.gmail.com>
	<1431679699.5555b2d3d9d09@imp.free.fr>
Message-ID: <CADCcPvstqwaKjweE1wTnzUVxW46bsU5Xo8TPrpKaRvEsvycWBQ@mail.gmail.com>

On Fri, May 15, 2015 at 11:48 AM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Dennis,
>
> https://www.digitalglobe.com/sites/default/files/ISD_External.pdf indeed
> confirms your findings (page 37 & 38, doc of originX and ulX)
>

on http://www.gdal.org/formats_list.html there isn't an entry to til
format or I'm mistaken?

> Fixed per http://trac.osgeo.org/gdal/ticket/5961
>
> Even
>
>> Hey guys,
>>
>>
>>
>> We have DigitalGlobe image strips which come with a *.til file.
>>
>> The geotransform of the til and the separate images have a shift of half a
>> pixel when opened with GDAL.
>>
>> The reason is that in the GDAL TIL driver the coordinates are treated as
>> outer pixel edge, where as it seems like they describe the pixel center, at
>> least in our cases.
>>
>> Does  anyone know of a description for the TIL format to verify if the GDAL
>> driver or the TILs from DigitalGlobe are wrong?
>>
>> For now we fixed it on our side, but you might consider changing the TIL
>> driver to treat the coordinates as pixel center.
>>
>>
>>
>> Best Regards,
>>
>> Dennis
>>
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From howard at hobu.co  Wed Jun  3 05:01:16 2015
From: howard at hobu.co (Howard Butler)
Date: Wed, 3 Jun 2015 07:01:16 -0500
Subject: [gdal-dev] Motion: adopt RFC 58: Removing Dataset Nodata Value
In-Reply-To: <201506031113.51977.even.rouault@spatialys.com>
References: <201506031113.51977.even.rouault@spatialys.com>
Message-ID: <34F886F9-FA43-4248-87AB-3C9E49A3C04D@hobu.co>



> On Jun 3, 2015, at 4:13 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> As no points have been raised on the RFC itself (peripheral discussions on how 
> to address out-of-range nodata values) :
> 
> Motion : I move to adopt RFC 58: Removing Dataset Nodata Value
> 
> https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
> 
> Starting with my +1

+1 

Howard

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jun  3 05:54:53 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 3 Jun 2015 12:54:53 +0000 (UTC)
Subject: [gdal-dev] Motion: adopt RFC 58: Removing Dataset Nodata Value
References: <201506031113.51977.even.rouault@spatialys.com>
Message-ID: <loom.20150603T145432-227@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> As no points have been raised on the RFC itself (peripheral discussions on
how 
> to address out-of-range nodata values) :
> 
> Motion : I move to adopt RFC 58: Removing Dataset Nodata Value
> 
> https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
> 
> Starting with my +1

+1

-Jukka Rahkonen-


From kassies at gmail.com  Wed Jun  3 06:21:07 2015
From: kassies at gmail.com (Rutger)
Date: Wed, 3 Jun 2015 06:21:07 -0700 (PDT)
Subject: [gdal-dev] Filesize too large when writing compressed float's to a
 Geotiff from Python
Message-ID: <1433337667941-5208916.post@n6.nabble.com>

Dear list,

When i try to write a floating point Geotiff from Python (both 32 or 64
bit), the resulting file size is significantly larger compared to the output
of gdal_translate. I wrote a small test script which tests this it for
various creation options like compression and block-sizes. It seems to be
the case for any compression method (packbits, lzw, deflate), and other
creation options don't seem to matter. Uncompressed data, or compressed
integers work fine, the file size matches gdal_translate very well.

Here is the notebook i used:
http://nbviewer.ipython.org/gist/RutgerK/27c4af235035621fb609

I would first all be interested to know if anyone can replicate this
behavior? And if there is something i can do to prevent this? I would rather
avoid having to run gdal_translate after each file written from Python. 

I'm running it on Windows 7 64bit. My GDAL version comes from the default
Conda repository which contains both bindings and utilities (at least for
version 1.11.1).

All i could find was this thread from 2010, it seems somewhat similar except
that there its about Uint16, for which it works for me:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-RE-Compression-using-the-create-method-in-python-and-aggregation-methods-td3747703.html


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Filesize-too-large-when-writing-compressed-float-s-to-a-Geotiff-from-Python-tp5208916.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun  3 07:02:07 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Jun 2015 16:02:07 +0200
Subject: [gdal-dev] Filesize too large when writing compressed float's
	to a Geotiff from Python
In-Reply-To: <1433337667941-5208916.post@n6.nabble.com>
References: <1433337667941-5208916.post@n6.nabble.com>
Message-ID: <201506031602.07517.even.rouault@spatialys.com>

Le mercredi 03 juin 2015 15:21:07, Rutger a ?crit :
> Dear list,
> 
> When i try to write a floating point Geotiff from Python (both 32 or 64
> bit), the resulting file size is significantly larger compared to the
> output of gdal_translate. I wrote a small test script which tests this it
> for various creation options like compression and block-sizes. It seems to
> be the case for any compression method (packbits, lzw, deflate), and other
> creation options don't seem to matter. Uncompressed data, or compressed
> integers work fine, the file size matches gdal_translate very well.
> 
> Here is the notebook i used:
> http://nbviewer.ipython.org/gist/RutgerK/27c4af235035621fb609
> 
> I would first all be interested to know if anyone can replicate this
> behavior? And if there is something i can do to prevent this? I would
> rather avoid having to run gdal_translate after each file written from
> Python.

Rutger,

the issue is that you write data band after band, whereas by default the GTiff 
driver create pixel-interleaved datasets. So some blocks in the GTiff might be 
reread and rewritten several times as the data coming from the various bands 
come.

Several fixes/workarounds :
- if you've sufficient RAM to hold another copy of the uncompressed dataset, 
increase GDAL_CACHEMAX
- or add options = [ 'INTERLEAVE=BAND' ] in the Create() call to create a band 
interleaved dataset
- more involved fix: since there's no dataset WriteArray() in GDAL Python for 
now, you would have to iterate block by block and for each block write the 
corresponding region of each band.
- you could also use Dataset.WriteRaster() if you can get a buffer from the 
numpy array

Even


> 
> I'm running it on Windows 7 64bit. My GDAL version comes from the default
> Conda repository which contains both bindings and utilities (at least for
> version 1.11.1).
> 
> All i could find was this thread from 2010, it seems somewhat similar
> except that there its about Uint16, for which it works for me:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-RE-Compression-using-the-creat
> e-method-in-python-and-aggregation-methods-td3747703.html
> 
> 
> Regards,
> Rutger
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Filesize-too-large-when-writing-compre
> ssed-float-s-to-a-Geotiff-from-Python-tp5208916.html Sent from the GDAL -
> Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Wed Jun  3 07:17:06 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 03 Jun 2015 10:17:06 -0400
Subject: [gdal-dev] Motion: adopt RFC 58: Removing Dataset Nodata Value
In-Reply-To: <34F886F9-FA43-4248-87AB-3C9E49A3C04D@hobu.co>
References: <201506031113.51977.even.rouault@spatialys.com>
	<34F886F9-FA43-4248-87AB-3C9E49A3C04D@hobu.co>
Message-ID: <556F0C62.8070706@mapgears.com>

+1

Daniel

On 2015-06-03 8:01 AM, Howard Butler wrote:
>
>
>> On Jun 3, 2015, at 4:13 AM, Even Rouault <even.rouault at spatialys.com> wrote:
>>
>> Hi,
>>
>> As no points have been raised on the RFC itself (peripheral discussions on how
>> to address out-of-range nodata values) :
>>
>> Motion : I move to adopt RFC 58: Removing Dataset Nodata Value
>>
>> https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
>>
>> Starting with my +1
>
> +1
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From fazamhd at gmail.com  Wed Jun  3 23:42:21 2015
From: fazamhd at gmail.com (faza mahamood)
Date: Thu, 4 Jun 2015 12:12:21 +0530
Subject: [gdal-dev] Need feedback regarding the approaches for swig bindings
 for librarified GDAL utilities
Message-ID: <CAJn=qt2He69vyQZRbJ=FaXcQBYQ2bdq8L3ViqSSCOKAMTE7iYg@mail.gmail.com>

Hi,

I am working on swig bindings for librarified GDAL utilities as part of my
Google Summer of Code project. I have already librarified gdalinfo utility.

https://github.com/fazam/gdal/blob/gdalinfo/gdal/apps/gdal_utils.h
https://github.com/fazam/gdal/blob/gdalinfo/gdal/apps/gdalinfo_lib.cpp

These are the two approaches for swig bindings, after discussing with my
mentor Even.

(1)To create a new module gdal_utils
If we go with this approach, the function calls for gdalinfo and ogrinfo
will be like
gdal_utils.gdalinfo()
gdal_utils.ogrinfo()

(2)To go with the existing modules gdal and ogr
In this approach the function calls for gdalinfo and ogrinfo will be like
gdal.Info()
ogr.Info()

We also need to decide on the names of the functions for all librarified
utilities. Since there is already gdal.RasterizeLayer() and
gdal.ContourGenerate() which does most of the work of gdal_rasterize and
gdal_contour utilities, what should be the names of functions for
gdal_rasterize and gdal_contour?
What should we name the function for ogr2ogr?

I'd appreciate any feedback/suggestion.

Regards,
Faza
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/6bd1eaab/attachment.html>

From kassies at gmail.com  Thu Jun  4 00:29:24 2015
From: kassies at gmail.com (Rutger)
Date: Thu, 4 Jun 2015 00:29:24 -0700 (PDT)
Subject: [gdal-dev] Filesize too large when writing compressed float's
 to a Geotiff from Python
In-Reply-To: <201506031602.07517.even.rouault@spatialys.com>
References: <1433337667941-5208916.post@n6.nabble.com>
	<201506031602.07517.even.rouault@spatialys.com>
Message-ID: <1433402964749-5209075.post@n6.nabble.com>

Even, 

Thanks for the suggestions, the first two work well. I'll have a look at the
ds.WriteRaster, that seems an interesting way, since it also prevents
unnecessary looping over the bands. 

Writing per block is what i usually do, maybe that's why i never noticed it
before. I now ran into it while fetching and writing a dataset from OpenDAP,
whereas i usually read blocks from GTiffs.

It makes sense that the order in which the data is written/stored affects
the performance of the compression, but i don't get why it would be
different for integers as compared to floats? 


Regards,
Rutger




Even Rouault-2 wrote
> Le mercredi 03 juin 2015 15:21:07, Rutger a ?crit :
> 
> Rutger,
> 
> the issue is that you write data band after band, whereas by default the
> GTiff 
> driver create pixel-interleaved datasets. So some blocks in the GTiff
> might be 
> reread and rewritten several times as the data coming from the various
> bands 
> come.
> 
> Several fixes/workarounds :
> - if you've sufficient RAM to hold another copy of the uncompressed
> dataset, 
> increase GDAL_CACHEMAX
> - or add options = [ 'INTERLEAVE=BAND' ] in the Create() call to create a
> band 
> interleaved dataset
> - more involved fix: since there's no dataset WriteArray() in GDAL Python
> for 
> now, you would have to iterate block by block and for each block write the 
> corresponding region of each band.
> - you could also use Dataset.WriteRaster() if you can get a buffer from
> the 
> numpy array
> 
> Even





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Filesize-too-large-when-writing-compressed-float-s-to-a-Geotiff-from-Python-tp5208916p5209075.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jun  4 00:39:42 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Jun 2015 09:39:42 +0200
Subject: [gdal-dev] Filesize too large when writing compressed float's
	to a Geotiff from Python
In-Reply-To: <1433402964749-5209075.post@n6.nabble.com>
References: <1433337667941-5208916.post@n6.nabble.com>
	<201506031602.07517.even.rouault@spatialys.com>
	<1433402964749-5209075.post@n6.nabble.com>
Message-ID: <201506040939.42080.even.rouault@spatialys.com>


> It makes sense that the order in which the data is written/stored affects
> the performance of the compression, but i don't get why it would be
> different for integers as compared to floats?

Floats are larger than Int8 and Int16, so for the same amount of 
GDAL_CACHEMAX, you can cache less blocks, causing more temporary flushes of 
partial tiles/strips to disk (partial = that have data only for one or two 
bands, but not the 3), than need to be refetched when data for the remaining 
bands is available and then recompressed and rewritten.

> 
> 
> Regards,
> Rutger
> 
> 
> 
> 
> Even Rouault-2 wrote
> 
> > Le mercredi 03 juin 2015 15:21:07, Rutger a ?crit :
> > 
> > Rutger,
> > 
> > the issue is that you write data band after band, whereas by default the
> > GTiff
> > driver create pixel-interleaved datasets. So some blocks in the GTiff
> > might be
> > reread and rewritten several times as the data coming from the various
> > bands
> > come.
> > 
> > Several fixes/workarounds :
> > - if you've sufficient RAM to hold another copy of the uncompressed
> > dataset,
> > increase GDAL_CACHEMAX
> > - or add options = [ 'INTERLEAVE=BAND' ] in the Create() call to create a
> > band
> > interleaved dataset
> > - more involved fix: since there's no dataset WriteArray() in GDAL Python
> > for
> > now, you would have to iterate block by block and for each block write
> > the corresponding region of each band.
> > - you could also use Dataset.WriteRaster() if you can get a buffer from
> > the
> > numpy array
> > 
> > Even
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Filesize-too-large-when-writing-compre
> ssed-float-s-to-a-Geotiff-from-Python-tp5208916p5209075.html Sent from the
> GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun  4 07:05:00 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Jun 2015 16:05:00 +0200
Subject: [gdal-dev] Call for discussion on RFC 26: GDAL Block Cache
	Improvements
Message-ID: <201506041605.00222.even.rouault@spatialys.com>

Hi,

I've updated an old RFC initiated by Tamas. The main idea, having a hashset 
based implementation as an alternative to the array based, remains. Changes 
consist mainly in code restructuration, perf improvements to reduce lock 
contention and porting to the state of the latest code base.

This is a RFC for GDAL 2.1

Details at https://trac.osgeo.org/gdal/wiki/rfc26_blockcache

== Summary and rationale ==

GDAL maintains an in-memory cache for the raster blocks fetched from the 
drivers and ensures that the second attempt to access the same block will be 
served from the cache instead of the driver. This cache is maintained in a 
per-band fashion and an array is allocated for the pointers for each blocks 
(or sub-blocks). This approach is not sufficient with large raster dimensions 
(or large virtual rasters ie. with the WMS/TMS driver), which may cause out of 
memory errors in GDALRasterBand::InitBlockInfo, as raised in #3224

For example, a band of a dataset at level 21 with a GoogleMaps tiling requires 
2097152x2097152 tiles of 256x256 pixels. This means that GDAL will try to 
allocate an array of 32768x32768 = 1 billion elements (32768 = 2097152 / 64). 
The size of this array is 4 GB on a 32-bit build, so it cannot be allocated at 
all. And it is 8 GB on a 64-bit build (even if this is generally only virtual 
memory reservation but not actually allocation of physical pages of memory, 
due to over-commit mechanism of the operating system). At dataset closing, 
this means that those 1 billion cells will have to be explored to discover 
remaining cached blocks. In reality, all above figures must be multiplied by 3 
for a RGB (or 4 for a RGBA) dataset.

In the hash set implementation, memory allocation depends directly on the 
number of cached blocks. Typically with the default GDAL_CACHEMAX size of 40 
MB, only 640 blocks of 256x256 pixels can be simultaneously cached (for all 
datasets).

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mathieu.coudert at gmail.com  Thu Jun  4 07:04:32 2015
From: mathieu.coudert at gmail.com (Mathieu Coudert)
Date: Thu, 4 Jun 2015 16:04:32 +0200
Subject: [gdal-dev] Bytes still reachables in setFromUserInput function
Message-ID: <CAOWnZzYAUZAcG8zggo6KtGaQS-0Cw+hKucZu3Mvbp1bVbV9YEA@mail.gmail.com>

Hello,



I am using GDAL 1.11.2 on linux Centos and here is one of my function :



{

OGRSpatialReference sr;

if (sr.SetFromUserInput(proj.c_str()) != OGRERR_NONE)

    throw InvalidInput();



char *wkt;

sr.exportToWkt(&wkt);

string srs (wkt);

OGRFree(wkt);



return srs;

}



This code works fine but when I use Valgrind on it, I get the following
message :



[?] bytes still reachable at line X

where X is the line with the setFromUserInput

(please find below the full stacktrace)



[...] are still reachable [...]

==22766==    at 0x4A06A2E: malloc (vg_replace_malloc.c:270)

==22766==    by 0x54EB3B7: pj_malloc (pj_malloc.c:19)

==22766==    by 0x54F67BB: pj_insert_initcache (pj_initcache.c:161)

==22766==    by 0x54EA388: get_init (pj_init.c:288)

==22766==    by 0x54EA57B: pj_init_ctx (pj_init.c:428)

==22766==    by 0x54EB154: pj_init_plus_ctx (pj_init.c:366)

==22766==    by 0x6A4978: OCTProj4Normalize (ogrct.cpp:309)

==22766==    by 0x6A3215: OGRSpatialReference::importFromEPSGA(int)
(ogr_fromepsg.cpp:2222)

==22766==    by 0x6A381B: OGRSpatialReference::importFromEPSG(int)
(ogr_fromepsg.cpp:2095)

==22766==    by 0x693E41: OGRSpatialReference::SetFromUserInput(char
const*) (ogrspatialreference.cpp:1955)

==22766==    by 0x44D70B:
GisKit::ProjToSRS(std::__cxx11::basic_string<char, std::char_traits<char>,
std::allocator<char> > const&) (GisKit.cpp:46)


Do you have any ideas?

I'd appreciate any feedback/suggestion.



Thanks a lot.



Regards,

Mathieu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/cfb67890/attachment.html>

From eronquillo at lanl.gov  Thu Jun  4 06:58:49 2015
From: eronquillo at lanl.gov (Ronquillo, Edgar Nahum)
Date: Thu, 4 Jun 2015 13:58:49 +0000
Subject: [gdal-dev] Read Ascii Grid and produce GeoTiff
Message-ID: <2086CE7E967C1B4F9D5897BE1C3C746F31194276@ECS-EXG-P-MB01.win.lanl.gov>

Hello everyone,
I have been looking around for a while now. I want to create a python script that can read an AsciiGrid file and be able to produce a GeoTiff out of it. I know it is possible with Gdal, I just don't seem to get it. There are some references out there about this but nothing exact. Someone please help we accomplish this or maybe link me to anything out there that can help me with this task.

Any help would be appreciated!

Thank You
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/6c6a2115/attachment.html>

From even.rouault at spatialys.com  Thu Jun  4 07:20:53 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Jun 2015 16:20:53 +0200
Subject: [gdal-dev] Bytes still reachables in setFromUserInput function
In-Reply-To: <CAOWnZzYAUZAcG8zggo6KtGaQS-0Cw+hKucZu3Mvbp1bVbV9YEA@mail.gmail.com>
References: <CAOWnZzYAUZAcG8zggo6KtGaQS-0Cw+hKucZu3Mvbp1bVbV9YEA@mail.gmail.com>
Message-ID: <201506041620.54031.even.rouault@spatialys.com>

Le jeudi 04 juin 2015 16:04:32, Mathieu Coudert a ?crit :
> Hello,
> 
> 
> 
> I am using GDAL 1.11.2 on linux Centos and here is one of my function :
> 
> 
> 
> {
> 
> OGRSpatialReference sr;
> 
> if (sr.SetFromUserInput(proj.c_str()) != OGRERR_NONE)
> 
>     throw InvalidInput();
> 
> 
> 
> char *wkt;
> 
> sr.exportToWkt(&wkt);
> 
> string srs (wkt);
> 
> OGRFree(wkt);
> 
> 
> 
> return srs;
> 
> }
> 
> 
> 
> This code works fine but when I use Valgrind on it, I get the following
> message :
> 
> 
> 
> [?] bytes still reachable at line X
> 
> where X is the line with the setFromUserInput
> 
> (please find below the full stacktrace)
> 
> 
> 
> [...] are still reachable [...]
> 
> ==22766==    at 0x4A06A2E: malloc (vg_replace_malloc.c:270)
> 
> ==22766==    by 0x54EB3B7: pj_malloc (pj_malloc.c:19)
> 
> ==22766==    by 0x54F67BB: pj_insert_initcache (pj_initcache.c:161)
> 
> ==22766==    by 0x54EA388: get_init (pj_init.c:288)
> 
> ==22766==    by 0x54EA57B: pj_init_ctx (pj_init.c:428)
> 
> ==22766==    by 0x54EB154: pj_init_plus_ctx (pj_init.c:366)
> 
> ==22766==    by 0x6A4978: OCTProj4Normalize (ogrct.cpp:309)
> 
> ==22766==    by 0x6A3215: OGRSpatialReference::importFromEPSGA(int)
> (ogr_fromepsg.cpp:2222)
> 
> ==22766==    by 0x6A381B: OGRSpatialReference::importFromEPSG(int)
> (ogr_fromepsg.cpp:2095)
> 
> ==22766==    by 0x693E41: OGRSpatialReference::SetFromUserInput(char
> const*) (ogrspatialreference.cpp:1955)
> 
> ==22766==    by 0x44D70B:
> GisKit::ProjToSRS(std::__cxx11::basic_string<char, std::char_traits<char>,
> std::allocator<char> > const&) (GisKit.cpp:46)
> 
> 
> Do you have any ideas?

Mathieu,

This is not lost memory, but cached proj.4 definitions. You could explicitely 
call pj_clear_initcache() (from proj_api.h) at the end of your process to 
clear that cache.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun  4 07:22:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Jun 2015 16:22:40 +0200
Subject: [gdal-dev] Read Ascii Grid and produce GeoTiff
In-Reply-To: <2086CE7E967C1B4F9D5897BE1C3C746F31194276@ECS-EXG-P-MB01.win.lanl.gov>
References: <2086CE7E967C1B4F9D5897BE1C3C746F31194276@ECS-EXG-P-MB01.win.lanl.gov>
Message-ID: <201506041622.40873.even.rouault@spatialys.com>

Le jeudi 04 juin 2015 15:58:49, Ronquillo, Edgar Nahum a ?crit :
> Hello everyone,
> I have been looking around for a while now. I want to create a python
> script that can read an AsciiGrid file and be able to produce a GeoTiff
> out of it. I know it is possible with Gdal, I just don't seem to get it.
> There are some references out there about this but nothing exact. Someone
> please help we accomplish this or maybe link me to anything out there that
> can help me with this task.

Edgar,

those 2 lines should do it:

from osgeo import gdal
gdal.GetDriverByName('GTiff').CreateCopy('out.tif', gdal.Open('in.asc'))

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Jun  4 07:35:58 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 04 Jun 2015 17:35:58 +0300
Subject: [gdal-dev] Bindings
Message-ID: <5570624E.2080108@gmail.com>

Hi,

I've been trying to find a way to make the common SWIG interface files 
less concerned about languages and the whole system more flexible and 
understandable (which I see a prerequisite for further developments).

My conclusion seems to be now that it is probably better to make the 
main files, what are now gdal.i, ogr.i etc., language specific and only 
the class files, now ColorTable.i, MajorObject.i, etc., and some other 
files (typedefs.i etc.) common. That way each language could compose the 
module as they like. For example in Perl I would like to get rid of 
Const, and a language could put all classes into one module (gdal) etc.

This would at least require extracting remaining common material in 
gdal.i and ogr.i into new files.

I'll test this in my github fork - which I've mentioned a couple of 
times already. But it will probably take some time due to summer etc.

Any comments on this? This is again just internal reorganization and 
does not affect the APIs.

Ari


From mathieu.coudert at gmail.com  Thu Jun  4 08:18:10 2015
From: mathieu.coudert at gmail.com (Mathieu Coudert)
Date: Thu, 4 Jun 2015 17:18:10 +0200
Subject: [gdal-dev] Bytes still reachables in setFromUserInput function
In-Reply-To: <201506041620.54031.even.rouault@spatialys.com>
References: <CAOWnZzYAUZAcG8zggo6KtGaQS-0Cw+hKucZu3Mvbp1bVbV9YEA@mail.gmail.com>
	<201506041620.54031.even.rouault@spatialys.com>
Message-ID: <CAOWnZzbh1fnHEwtcCYwHf85m1LoedD8QATFAxvZVT9dBJJ_Zrg@mail.gmail.com>

Thanks Even for the prompt answer.
I would have expected a method through the OGR API to handle it without
having to call proj but if it appears like the standard or default way for
you to do it, let's do it.

Cheers,

Mathieu


On Thu, Jun 4, 2015 at 4:20 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 04 juin 2015 16:04:32, Mathieu Coudert a ?crit :
> > Hello,
> >
> >
> >
> > I am using GDAL 1.11.2 on linux Centos and here is one of my function :
> >
> >
> >
> > {
> >
> > OGRSpatialReference sr;
> >
> > if (sr.SetFromUserInput(proj.c_str()) != OGRERR_NONE)
> >
> >     throw InvalidInput();
> >
> >
> >
> > char *wkt;
> >
> > sr.exportToWkt(&wkt);
> >
> > string srs (wkt);
> >
> > OGRFree(wkt);
> >
> >
> >
> > return srs;
> >
> > }
> >
> >
> >
> > This code works fine but when I use Valgrind on it, I get the following
> > message :
> >
> >
> >
> > [?] bytes still reachable at line X
> >
> > where X is the line with the setFromUserInput
> >
> > (please find below the full stacktrace)
> >
> >
> >
> > [...] are still reachable [...]
> >
> > ==22766==    at 0x4A06A2E: malloc (vg_replace_malloc.c:270)
> >
> > ==22766==    by 0x54EB3B7: pj_malloc (pj_malloc.c:19)
> >
> > ==22766==    by 0x54F67BB: pj_insert_initcache (pj_initcache.c:161)
> >
> > ==22766==    by 0x54EA388: get_init (pj_init.c:288)
> >
> > ==22766==    by 0x54EA57B: pj_init_ctx (pj_init.c:428)
> >
> > ==22766==    by 0x54EB154: pj_init_plus_ctx (pj_init.c:366)
> >
> > ==22766==    by 0x6A4978: OCTProj4Normalize (ogrct.cpp:309)
> >
> > ==22766==    by 0x6A3215: OGRSpatialReference::importFromEPSGA(int)
> > (ogr_fromepsg.cpp:2222)
> >
> > ==22766==    by 0x6A381B: OGRSpatialReference::importFromEPSG(int)
> > (ogr_fromepsg.cpp:2095)
> >
> > ==22766==    by 0x693E41: OGRSpatialReference::SetFromUserInput(char
> > const*) (ogrspatialreference.cpp:1955)
> >
> > ==22766==    by 0x44D70B:
> > GisKit::ProjToSRS(std::__cxx11::basic_string<char,
> std::char_traits<char>,
> > std::allocator<char> > const&) (GisKit.cpp:46)
> >
> >
> > Do you have any ideas?
>
> Mathieu,
>
> This is not lost memory, but cached proj.4 definitions. You could
> explicitely
> call pj_clear_initcache() (from proj_api.h) at the end of your process to
> clear that cache.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/a5e84ad4/attachment.html>

From eronquillo at lanl.gov  Thu Jun  4 09:24:57 2015
From: eronquillo at lanl.gov (Ronquillo, Edgar Nahum)
Date: Thu, 4 Jun 2015 16:24:57 +0000
Subject: [gdal-dev] ImportError: numpy.core.multiarray failed to import
Message-ID: <2086CE7E967C1B4F9D5897BE1C3C746F311942CB@ECS-EXG-P-MB01.win.lanl.gov>

Hello,
So I am trying to run the example called "Clip a Geotiff with Shapefile" from this website https://pcjericks.github.io/py-gdalogr-cookbook/raster_layers.html. However, I get an error about numpy although I do have numpy installed. I believe is something with GDAL. Here is my output error:

ImportError: numpy.core.multiarray failed to import

Traceback (most recent call last):
  File "C:\Users\r294505\Desktop\pythonTesting.py", line 1, in <module>
    from osgeo import gdal, gdalnumeric, ogr, osr
  File "C:\Python27\lib\site-packages\osgeo\gdalnumeric.py", line 1, in <module>
    from gdal_array import *
  File "C:\Python27\lib\site-packages\osgeo\gdal_array.py", line 26, in <module>
    _gdal_array = swig_import_helper()
  File "C:\Python27\lib\site-packages\osgeo\gdal_array.py", line 22, in swig_import_helper
    _mod = imp.load_module('_gdal_array', fp, pathname, description)
ImportError: numpy.core.multiarray failed to import

By the way, I am running 64 bit windows 7 in case that is of any help. Any help as to what could be this error would be appreciated.

Thank You
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/43e37d6e/attachment.html>

From szekerest at gmail.com  Thu Jun  4 12:12:47 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 4 Jun 2015 21:12:47 +0200
Subject: [gdal-dev] Bindings
In-Reply-To: <5570624E.2080108@gmail.com>
References: <5570624E.2080108@gmail.com>
Message-ID: <CACALY+R4fRHcLXvbHMq79bqPDyfjR3zE2TS0dqMTBLtUwsr+nw@mail.gmail.com>

Hi Ari,

Creating language specific main files would be fine for me. We could also
add the "language specific extensions" at the bottom section (like
gdal_csharp_extend.i) directly into the file.

We should however make sure to update all relevant files if a common change
is done in a language specific file.

Best regards,

Tamas


2015-06-04 16:35 GMT+02:00 Ari Jolma <ari.jolma at gmail.com>:

> Hi,
>
> I've been trying to find a way to make the common SWIG interface files
> less concerned about languages and the whole system more flexible and
> understandable (which I see a prerequisite for further developments).
>
> My conclusion seems to be now that it is probably better to make the main
> files, what are now gdal.i, ogr.i etc., language specific and only the
> class files, now ColorTable.i, MajorObject.i, etc., and some other files
> (typedefs.i etc.) common. That way each language could compose the module
> as they like. For example in Perl I would like to get rid of Const, and a
> language could put all classes into one module (gdal) etc.
>
> This would at least require extracting remaining common material in gdal.i
> and ogr.i into new files.
>
> I'll test this in my github fork - which I've mentioned a couple of times
> already. But it will probably take some time due to summer etc.
>
> Any comments on this? This is again just internal reorganization and does
> not affect the APIs.
>
> Ari
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/98cfcfc4/attachment.html>

From sfkeller at gmail.com  Thu Jun  4 15:38:01 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 5 Jun 2015 00:38:01 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<201505212334.52905.even.rouault@spatialys.com>
	<CAFcOn28ueEZ0kFBUzsvNuy9O07CA4D2L_jT2u+ppC8JFgFPpZA@mail.gmail.com>
	<201505220053.45562.even.rouault@spatialys.com>
	<CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
Message-ID: <CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>

Hi even

We've finished the GeoCSV spec. and we're almost ready to publish the
Editable GeoCSV plugin fpr QGIS.

So, I have following enhancement requests for the OGR CSV reader,
regarding CSVT:
1. Accept "WKT" (case insensitive) indicating WKT geometry field.
2. Accept "CoordX" and "CoordX" (in any order, case insensitive)
indicating easting/northing of a point geometry.
3. While opening the CSV file, look for .prj as coordinate reference
system/CRS (same CRS format like Shapefiles).

What do you think? Can I open an enhancement request for this?

Cheers, S.

2015-05-22 1:07 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> ...
>>> * "Easting","Northing"
>> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be easier
>> to get. I don't know.
>
> So let's propose Point(X),Point(Y) or PointX,PointY.
>
> -S.
>
>
> 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> Le vendredi 22 mai 2015 00:33:43, Stefan Keller a ?crit :
>>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>>> ...
>>>
>>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>>> >
>>> > For points only I guess?
>>>
>>> Yes.
>>>
>>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>>> >> Point, LineString, Polygon.
>>> >
>>> > "WKT" is not really consistant with Point,LineString,Polygon since the
>>> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
>>> > WKT(LineString), WKT(Polygon) ?
>>>
>>> Right, d'accord. So, let's introduce following two geometry types:
>>> * "Easting","Northing"
>> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be easier
>> to get. I don't know.
>>> * WKT, WKT(Point), WKT(LineString), WKT(Polygon)
>>>
>>> There are additional restricions to these geometry types:
>>> * "Easting","Northing" must co-occur and should be neighboring columns
>>> (in either order).
>> I guess most people would do that, but I don't see a strong rationale to
>> impose neighboring coumns
>>> * if WKT is given, all rows are expected to contain the same geometry type.
>> For generic WKT, all geometry types should be possible (as currently). Only
>> for WKT(xxxx), geometries should be restricted to the specified type.
>>> * There's only one geometry column per .csvt, namely either
>>> <<"Easting","Northing">> or <<WKT>>.
>> Kind of makes sense for Easting,Northing. But for WKT columns I don't see a
>> reason for such a restriction. Actually there's already a
>> secret/undocumented/debug mode in the CSV driver to read multiple geometry
>> columns (I won't reveal it unless I'm tortured, but you can look at the code).
>> This was mostly useful at the first stages when developing RFC 41.
>>
>>>
>>> OK?
>>
>> Not sure what kind of committment would be expected if I say "OK", so I'll
>> abstain ;-)
>>
>>>
>>> --S.
>>>
>>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>>> > Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
>>> >> Hi Even
>>> >>
>>> >> I just see some type mod and subtype definitions for .csvt files in
>>> >> the CSV docs [1] :
>>> >> <<
>>> >> In a single line the types for each column have to be listed with
>>> >> double quotes and be comma separated (e.g., "Integer","String"). It is
>>> >> also possible to specify explicitly the width and precision of each
>>> >> column, e.g. "Integer(5)","Real(10.7)","String(15)". The driver will
>>> >> then use these types as specified for the csv columns. Starting with
>>> >> GDAL 2.0, subtypes can be passed between parenthesis, such as
>>> >> "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
>>> >> <<
>>> >>
>>> >> Following questions and suggestions about .csvt:
>>> >> 1. Do type names really have to be in double quotes?
>>> >
>>> > No
>>> >
>>> >> 2. Is the separator always comma or can it also be a semicolon?
>>> >
>>> > Yes, always comma
>>> >
>>> >> 3. What about a Geometry type with subtypes? I suggest to add
>>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>>> >
>>> > For points only I guess? Well you can build points with a OGR VRT from 2
>>> > CSV columns. I might perhaps add in some time an open option to specify
>>> > the columns for the easting/longitude and northing/latitude.
>>> >
>>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT (default),
>>> >> Point, LineString, Polygon.
>>> >
>>> > "WKT" is not really consistant with Point,LineString,Polygon since the
>>> > later would be expressed as WKT I guess. So perhaps WKT, WKT(Point),
>>> > WKT(LineString), WKT(Polygon) ?
>>> >
>>> >> What do you think?
>>> >> This could also make QGIS "Add Delimited Text Layer..." even better.
>>> >>
>>> >> --S.
>>> >>
>>> >> [1] http://www.gdal.org/drv_csv.html
>>> >>
>>> >> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>>> >> > Salut Even,
>>> >> >
>>> >> > Merci!
>>> >> >
>>> >> > 2015-04-29 20:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>>> >> >> Stefan
>>> >> >>
>>> >> >>> Questions:
>>> >> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV file,
>>> >> >>> how is it encoded? Hex?
>>> >> >>
>>> >> >> There's no support in the CSV driver for binary data
>>> >> >>
>>> >> >>> 2. Can a field in a CSV input files have a IntegerList or a Binary?
>>> >> >>
>>> >> >> No. Well on writing, the IntegerList will be serialized as a string.
>>> >> >> But not recognized as IntegerList on reading
>>> >> >>
>>> >> >>> 3. What is the value delimiter in a field of type IntegerList,
>>> >> >>> Integer64List, RealList, StringList?
>>> >> >>
>>> >> >> The default serializatoin will be
>>> >> >> (number_of_elements:val1,val2,...,valn), but currently it is
>>> >> >> truncated to 80 chracters
>>> >> >>
>>> >> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are there
>>> >> >>> more subtypes?
>>> >> >>
>>> >> >> Not currently. See
>>> >> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>>> >> >>
>>> >> >> Even
>>> >> >>
>>> >> >> --
>>> >> >> Spatialys - Geospatial professional services
>>> >> >> http://www.spatialys.com
>>> >
>>> > --
>>> > Spatialys - Geospatial professional services
>>> > http://www.spatialys.com
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com

From randre at gmail.com  Thu Jun  4 17:19:06 2015
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Thu, 4 Jun 2015 17:19:06 -0700
Subject: [gdal-dev] Problem appending non-geometry tables in PostGis
Message-ID: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>

Hi All,

I'm having some trouble using ogr2ogr to do batch uploads to a Postgis DB.
It appears that on tables which don't contain geometry, CreateLayer is
failing and not allowing data to be appended to an existing table.  Here is
the command that is being used to load each feature class:

ogr2ogr -f "PostgreSQL" -lco ENCODING=UTF-8 -append -update PG:"host=foo
dbname=bar user=crak password=head" ./nokia_here_asia/file.gdb CityPOINames

Below is my logging output.  The first set of data shows the asia data set
being loaded, which creates the PostGIS tables. The next set shows what
happens with the europe data set.  Although warnings are given for
MapAdminArea, MapAdminLink and CityPOI layers, they are sucessfully
appended.  However, CityPOINames, MapAreaNames, and MapNameTrans all fail
with the CreateLayer error.  Those tables are different in that they lack
geometry.
--------
Extracting from ./nokia_here_asia/file.gdb
Loading MapAdminArea feature_class
Loading MapAdminLink feature_class
Loading CityPOI feature_class
Loading CityPOINames feature_class
Loading MapAreaNames feature_class
Loading MapNameTrans feature_class
--------
Extracting from ./nokia_here_europe/file.gdb
Loading MapAdminArea feature_class
WARNING: Layer creation options ignored since an existing layer is
         being appended to.
Loading MapAdminLink feature_class
WARNING: Layer creation options ignored since an existing layer is
         being appended to.
Loading CityPOI feature_class
WARNING: Layer creation options ignored since an existing layer is
         being appended to.
Loading CityPOINames feature_class
ERROR 1: Layer citypoinames already exists, CreateLayer failed.
Use the layer creation option OVERWRITE=YES to replace it.
ERROR 1: Terminating translation prematurely after failed
translation of layer CityPOINames (use -skipfailures to skip errors)

Loading MapAreaNames feature_class
ERROR 1: Layer mapareanames already exists, CreateLayer failed.
Use the layer creation option OVERWRITE=YES to replace it.
ERROR 1: Terminating translation prematurely after failed
translation of layer MapAreaNames (use -skipfailures to skip errors)

Loading MapNameTrans feature_class
ERROR 1: Layer mapnametrans already exists, CreateLayer failed.
Use the layer creation option OVERWRITE=YES to replace it.
ERROR 1: Terminating translation prematurely after failed
translation of layer MapNameTrans (use -skipfailures to skip errors)
--------

I could create some giant CSV files and load these in one shot, but I'd
prefer it if I could handle the entire load using ogr2ogr.  Has anyone else
encountered this, or have suggestions for dealing with the problem?

Thanks,

Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/b4790b1a/attachment.html>

From sault.don at gmail.com  Thu Jun  4 18:14:53 2015
From: sault.don at gmail.com (Saulteau Don)
Date: Thu, 4 Jun 2015 18:14:53 -0700
Subject: [gdal-dev] Problem appending non-geometry tables in PostGis
In-Reply-To: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>
References: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>
Message-ID: <CAJo0jfPBZR1-HJoNP2ZqON_WGQne_+8H5XQaZwPr47ABUyx1ew@mail.gmail.com>

If you add "-nlt NONE" to the ogr2ogr command, does that work?

You might need to do that just for the non-spatial tables, because if you
do that with the spatial tables, they will only upload the attributes.


Donovan

On Thu, Jun 4, 2015 at 5:19 PM, Roger Andr? <randre at gmail.com> wrote:

> Hi All,
>
> I'm having some trouble using ogr2ogr to do batch uploads to a Postgis
> DB.  It appears that on tables which don't contain geometry, CreateLayer is
> failing and not allowing data to be appended to an existing table.  Here is
> the command that is being used to load each feature class:
>
> ogr2ogr -f "PostgreSQL" -lco ENCODING=UTF-8 -append -update PG:"host=foo
> dbname=bar user=crak password=head" ./nokia_here_asia/file.gdb CityPOINames
>
> Below is my logging output.  The first set of data shows the asia data set
> being loaded, which creates the PostGIS tables. The next set shows what
> happens with the europe data set.  Although warnings are given for
> MapAdminArea, MapAdminLink and CityPOI layers, they are sucessfully
> appended.  However, CityPOINames, MapAreaNames, and MapNameTrans all fail
> with the CreateLayer error.  Those tables are different in that they lack
> geometry.
> --------
> Extracting from ./nokia_here_asia/file.gdb
> Loading MapAdminArea feature_class
> Loading MapAdminLink feature_class
> Loading CityPOI feature_class
> Loading CityPOINames feature_class
> Loading MapAreaNames feature_class
> Loading MapNameTrans feature_class
> --------
> Extracting from ./nokia_here_europe/file.gdb
> Loading MapAdminArea feature_class
> WARNING: Layer creation options ignored since an existing layer is
>          being appended to.
> Loading MapAdminLink feature_class
> WARNING: Layer creation options ignored since an existing layer is
>          being appended to.
> Loading CityPOI feature_class
> WARNING: Layer creation options ignored since an existing layer is
>          being appended to.
> Loading CityPOINames feature_class
> ERROR 1: Layer citypoinames already exists, CreateLayer failed.
> Use the layer creation option OVERWRITE=YES to replace it.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer CityPOINames (use -skipfailures to skip errors)
>
> Loading MapAreaNames feature_class
> ERROR 1: Layer mapareanames already exists, CreateLayer failed.
> Use the layer creation option OVERWRITE=YES to replace it.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer MapAreaNames (use -skipfailures to skip errors)
>
> Loading MapNameTrans feature_class
> ERROR 1: Layer mapnametrans already exists, CreateLayer failed.
> Use the layer creation option OVERWRITE=YES to replace it.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer MapNameTrans (use -skipfailures to skip errors)
> --------
>
> I could create some giant CSV files and load these in one shot, but I'd
> prefer it if I could handle the entire load using ogr2ogr.  Has anyone else
> encountered this, or have suggestions for dealing with the problem?
>
> Thanks,
>
> Roger
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150604/1f45e8a8/attachment-0001.html>

From bradh at frogmouth.net  Thu Jun  4 18:18:26 2015
From: bradh at frogmouth.net (Brad Hards)
Date: Fri, 05 Jun 2015 11:18:26 +1000
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
	<CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
Message-ID: <3507838.TUGTlIfB7L@saxicola>

On Fri, 5 Jun 2015 12:38:01 AM Stefan Keller wrote:
> We've finished the GeoCSV spec. 
Does that mean:  http://giswiki.hsr.ch/GeoCSV ?

Brad


From sfkeller at gmail.com  Thu Jun  4 22:41:43 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Fri, 5 Jun 2015 07:41:43 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <3507838.TUGTlIfB7L@saxicola>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
	<CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
	<3507838.TUGTlIfB7L@saxicola>
Message-ID: <CAFcOn294spiCkWwkrCi5SkOPP4LZRt3CRspCAzQwSduXNaJ8ag@mail.gmail.com>

Hi Brad

2015-06-05 3:18 GMT+02:00 Brad Hards <bradh at frogmouth.net> wrote:
>> We've finished the GeoCSV spec.
> Does that mean:  http://giswiki.hsr.ch/GeoCSV ?

Yes. Any comments are welcome.

Cheers, S.


2015-06-05 3:18 GMT+02:00 Brad Hards <bradh at frogmouth.net>:
> On Fri, 5 Jun 2015 12:38:01 AM Stefan Keller wrote:
>> We've finished the GeoCSV spec.
> Does that mean:  http://giswiki.hsr.ch/GeoCSV ?
>
> Brad
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Jun  5 00:50:28 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Jun 2015 09:50:28 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
	<CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
Message-ID: <201506050950.28947.even.rouault@spatialys.com>

Hi Stefan,

> 
> We've finished the GeoCSV spec. and we're almost ready to publish the
> Editable GeoCSV plugin fpr QGIS.
> 
> So, I have following enhancement requests for the OGR CSV reader,
> regarding CSVT:
> 1. Accept "WKT" (case insensitive) indicating WKT geometry field.
> 2. Accept "CoordX" and "CoordX" (in any order, case insensitive)
> indicating easting/northing of a point geometry.
> 3. While opening the CSV file, look for .prj as coordinate reference
> system/CRS (same CRS format like Shapefiles).
Hum, ESRI WKT so ? I would have rather recommanded the OGC WKT format (the one 
natively spoken by GDAL, based on OGC 01-009 
http://www.opengeospatial.org/standards/ct), that has the advantage of 
including EPSG codes explicitely. If you'd want to be up-to-date, there's also 
the WKT 2 / ISO TC 211 format ( 
http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ), but GDAL doesn't 
handle it yet.

> 
> What do you think? Can I open an enhancement request for this?

Yes, I might have a look at that while doing something related in the CSV 
driver.

Even

> 
> Cheers, S.
> 
> 2015-05-22 1:07 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> > 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> > ...
> > 
> >>> * "Easting","Northing"
> >> 
> >> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be
> >> easier to get. I don't know.
> > 
> > So let's propose Point(X),Point(Y) or PointX,PointY.
> > 
> > -S.
> > 
> > 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >> Le vendredi 22 mai 2015 00:33:43, Stefan Keller a ?crit :
> >>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >>> ...
> >>> 
> >>> >> 4. "Geometry(Easting)","Geometry(Northing)"
> >>> > 
> >>> > For points only I guess?
> >>> 
> >>> Yes.
> >>> 
> >>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT
> >>> >> (default), Point, LineString, Polygon.
> >>> > 
> >>> > "WKT" is not really consistant with Point,LineString,Polygon since
> >>> > the later would be expressed as WKT I guess. So perhaps WKT,
> >>> > WKT(Point), WKT(LineString), WKT(Polygon) ?
> >>> 
> >>> Right, d'accord. So, let's introduce following two geometry types:
> >>> * "Easting","Northing"
> >> 
> >> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be
> >> easier to get. I don't know.
> >> 
> >>> * WKT, WKT(Point), WKT(LineString), WKT(Polygon)
> >>> 
> >>> There are additional restricions to these geometry types:
> >>> * "Easting","Northing" must co-occur and should be neighboring columns
> >>> (in either order).
> >> 
> >> I guess most people would do that, but I don't see a strong rationale to
> >> impose neighboring coumns
> >> 
> >>> * if WKT is given, all rows are expected to contain the same geometry
> >>> type.
> >> 
> >> For generic WKT, all geometry types should be possible (as currently).
> >> Only for WKT(xxxx), geometries should be restricted to the specified
> >> type.
> >> 
> >>> * There's only one geometry column per .csvt, namely either
> >>> <<"Easting","Northing">> or <<WKT>>.
> >> 
> >> Kind of makes sense for Easting,Northing. But for WKT columns I don't
> >> see a reason for such a restriction. Actually there's already a
> >> secret/undocumented/debug mode in the CSV driver to read multiple
> >> geometry columns (I won't reveal it unless I'm tortured, but you can
> >> look at the code). This was mostly useful at the first stages when
> >> developing RFC 41.
> >> 
> >>> OK?
> >> 
> >> Not sure what kind of committment would be expected if I say "OK", so
> >> I'll abstain ;-)
> >> 
> >>> --S.
> >>> 
> >>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> >>> > Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
> >>> >> Hi Even
> >>> >> 
> >>> >> I just see some type mod and subtype definitions for .csvt files in
> >>> >> the CSV docs [1] :
> >>> >> <<
> >>> >> In a single line the types for each column have to be listed with
> >>> >> double quotes and be comma separated (e.g., "Integer","String"). It
> >>> >> is also possible to specify explicitly the width and precision of
> >>> >> each column, e.g. "Integer(5)","Real(10.7)","String(15)". The
> >>> >> driver will then use these types as specified for the csv columns.
> >>> >> Starting with GDAL 2.0, subtypes can be passed between parenthesis,
> >>> >> such as "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
> >>> >> <<
> >>> >> 
> >>> >> Following questions and suggestions about .csvt:
> >>> >> 1. Do type names really have to be in double quotes?
> >>> > 
> >>> > No
> >>> > 
> >>> >> 2. Is the separator always comma or can it also be a semicolon?
> >>> > 
> >>> > Yes, always comma
> >>> > 
> >>> >> 3. What about a Geometry type with subtypes? I suggest to add
> >>> >> 4. "Geometry(Easting)","Geometry(Northing)"
> >>> > 
> >>> > For points only I guess? Well you can build points with a OGR VRT
> >>> > from 2 CSV columns. I might perhaps add in some time an open option
> >>> > to specify the columns for the easting/longitude and
> >>> > northing/latitude.
> >>> > 
> >>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT
> >>> >> (default), Point, LineString, Polygon.
> >>> > 
> >>> > "WKT" is not really consistant with Point,LineString,Polygon since
> >>> > the later would be expressed as WKT I guess. So perhaps WKT,
> >>> > WKT(Point), WKT(LineString), WKT(Polygon) ?
> >>> > 
> >>> >> What do you think?
> >>> >> This could also make QGIS "Add Delimited Text Layer..." even better.
> >>> >> 
> >>> >> --S.
> >>> >> 
> >>> >> [1] http://www.gdal.org/drv_csv.html
> >>> >> 
> >>> >> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
> >>> >> > Salut Even,
> >>> >> > 
> >>> >> > Merci!
> >>> >> > 
> >>> >> > 2015-04-29 20:35 GMT+02:00 Even Rouault 
<even.rouault at spatialys.com>:
> >>> >> >> Stefan
> >>> >> >> 
> >>> >> >>> Questions:
> >>> >> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV
> >>> >> >>> file, how is it encoded? Hex?
> >>> >> >> 
> >>> >> >> There's no support in the CSV driver for binary data
> >>> >> >> 
> >>> >> >>> 2. Can a field in a CSV input files have a IntegerList or a
> >>> >> >>> Binary?
> >>> >> >> 
> >>> >> >> No. Well on writing, the IntegerList will be serialized as a
> >>> >> >> string. But not recognized as IntegerList on reading
> >>> >> >> 
> >>> >> >>> 3. What is the value delimiter in a field of type IntegerList,
> >>> >> >>> Integer64List, RealList, StringList?
> >>> >> >> 
> >>> >> >> The default serializatoin will be
> >>> >> >> (number_of_elements:val1,val2,...,valn), but currently it is
> >>> >> >> truncated to 80 chracters
> >>> >> >> 
> >>> >> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are
> >>> >> >>> there more subtypes?
> >>> >> >> 
> >>> >> >> Not currently. See
> >>> >> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
> >>> >> >> 
> >>> >> >> Even
> >>> >> >> 
> >>> >> >> --
> >>> >> >> Spatialys - Geospatial professional services
> >>> >> >> http://www.spatialys.com
> >>> > 
> >>> > --
> >>> > Spatialys - Geospatial professional services
> >>> > http://www.spatialys.com
> >> 
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun  5 00:52:41 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Jun 2015 09:52:41 +0200
Subject: [gdal-dev] Problem appending non-geometry tables in PostGis
In-Reply-To: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>
References: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>
Message-ID: <201506050952.41448.even.rouault@spatialys.com>

Le vendredi 05 juin 2015 02:19:06, Roger Andr? a ?crit :
> Hi All,
> 
> I'm having some trouble using ogr2ogr to do batch uploads to a Postgis DB.
> It appears that on tables which don't contain geometry, CreateLayer is
> failing and not allowing data to be appended to an existing table.  Here is
> the command that is being used to load each feature class:
> 
> ogr2ogr -f "PostgreSQL" -lco ENCODING=UTF-8 -append -update PG:"host=foo
> dbname=bar user=crak password=head" ./nokia_here_asia/file.gdb CityPOINames

Roger,

Add --config PG_LIST_ALL_TABLES YES

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun  5 05:51:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Jun 2015 14:51:23 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 RC1 Available for Review
Message-ID: <201506051451.23568.even.rouault@spatialys.com>

Hi,

As announced, I have prepared a GDAL/OGR 2.0.0 release candidate. This is your 
last chance to test before the official release.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC1.tar.xz
  http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC1.tar.gz
  http://download.osgeo.org/gdal/2.0.0/gdal200RC1.zip

The gdal-grass plugin is available at :

  http://download.osgeo.org/gdal/2.0.0/gdal-grass-2.0.0RC1.tar.gz

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC1.tar.gz
  http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC1.zip

And the documentation:

  http://download.osgeo.org/gdal/2.0.0/gdal200doc.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.0.0-News

If someone wants to improve it, you're welcome!

I'll call for a vote promoting it to final next week if no serious problems are 
reported.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From simonhege at hotmail.com  Fri Jun  5 08:27:34 2015
From: simonhege at hotmail.com (Simon Hege)
Date: Fri, 5 Jun 2015 15:27:34 +0000
Subject: [gdal-dev] OGRGeometry copy constructor
Message-ID: <DUB122-W501BA05EF9504424B78ECBB6B20@phx.gbl>

Hi,

Looking at the code of GDAL 2.0 (but also 1.x), I noticed that the OGRGeometry class (and the derived classes) do not respects the Rule of 3 : there is a destructor and no copy constructor or assignment operator. It seems to me that this may lead to memory leaks on OGRSpatialReference (for example when using std::vector<OGRPoint> and not std::vector<OGRPoint*>).
This is not an issue when using the C API because the clone() method is used.
Am I well understanding the API ? 

Various solutions exists:
1) defines private copy constructors and assignment operators (eg. libkml does this with a macro on each class: LIBKML_DISALLOW_EVIL_CONSTRUCTORS)
2) implements these methods, and manage poSRS the same way that clone()  does.
3) do nothing (and document it somewhere)

If needed I may open an issue and/or send a patch.

Best regards,
Simon HEGE
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150605/8473bf27/attachment.html>

From even.rouault at spatialys.com  Fri Jun  5 08:46:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Jun 2015 17:46:20 +0200
Subject: [gdal-dev] OGRGeometry copy constructor
In-Reply-To: <DUB122-W501BA05EF9504424B78ECBB6B20@phx.gbl>
References: <DUB122-W501BA05EF9504424B78ECBB6B20@phx.gbl>
Message-ID: <201506051746.20575.even.rouault@spatialys.com>

Simon,

> Looking at the code of GDAL 2.0 (but also 1.x), I noticed that the
> OGRGeometry class (and the derived classes) do not respects the Rule of 3
> : there is a destructor and no copy constructor or assignment operator.

Indeed, the Rule of 3 is not currently really implemented in the C++ API.

> It
> seems to me that this may lead to memory leaks on OGRSpatialReference (for
> example when using std::vector<OGRPoint> and not std::vector<OGRPoint*>).
> This is not an issue when using the C API because the clone() method is
> used. Am I well understanding the API ?
> 
> Various solutions exists:
> 1) defines private copy constructors and assignment operators (eg. libkml
> does this with a macro on each class: LIBKML_DISALLOW_EVIL_CONSTRUCTORS)
> 2) implements these methods, and manage poSRS the same way that clone() 
> does. 3) do nothing (and document it somewhere)
> 
> If needed I may open an issue and/or send a patch.

Option 2 looks good to me if you want to prepare a patch for it. Test cases in 
autotest/cpp/test_ogr.cpp would be appreciated.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun  5 10:43:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Jun 2015 19:43:50 +0200
Subject: [gdal-dev] Motion: adopt RFC 58: Removing Dataset Nodata Value
In-Reply-To: <201506031113.51977.even.rouault@spatialys.com>
References: <201506031113.51977.even.rouault@spatialys.com>
Message-ID: <201506051943.50594.even.rouault@spatialys.com>

Le mercredi 03 juin 2015 11:13:51, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised on the RFC itself (peripheral discussions on
> how to address out-of-range nodata values) :
> 
> Motion : I move to adopt RFC 58: Removing Dataset Nodata Value
> 
> https://trac.osgeo.org/gdal/wiki/rfc58_removing_dataset_nodata_value
> 
> Starting with my +1

Hi,

I declare this motion passed with +1 from HowardB, DanielM, JukkaR and myself.

I've just merged the implementation into trunk.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From randre at gmail.com  Fri Jun  5 15:02:34 2015
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Fri, 5 Jun 2015 15:02:34 -0700
Subject: [gdal-dev] Problem appending non-geometry tables in PostGis
In-Reply-To: <201506050952.41448.even.rouault@spatialys.com>
References: <CAOL+ROEdBwuLpj2UvyPya98mtXjZEcXc+wy-4vzO6g4Mb-qyXg@mail.gmail.com>
	<201506050952.41448.even.rouault@spatialys.com>
Message-ID: <CAOL+ROHH+=ZQsGr3toVfDiOodzS+LVEi7Xn0ordRb15Vb4_smg@mail.gmail.com>

Even,

That works, thanks.

Roger

On Fri, Jun 5, 2015 at 12:52 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le vendredi 05 juin 2015 02:19:06, Roger Andr? a ?crit :
> > Hi All,
> >
> > I'm having some trouble using ogr2ogr to do batch uploads to a Postgis
> DB.
> > It appears that on tables which don't contain geometry, CreateLayer is
> > failing and not allowing data to be appended to an existing table.  Here
> is
> > the command that is being used to load each feature class:
> >
> > ogr2ogr -f "PostgreSQL" -lco ENCODING=UTF-8 -append -update PG:"host=foo
> > dbname=bar user=crak password=head" ./nokia_here_asia/file.gdb
> CityPOINames
>
> Roger,
>
> Add --config PG_LIST_ALL_TABLES YES
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150605/ffa2ef1a/attachment.html>

From nicolas.cadieux at archeotec.ca  Fri Jun  5 15:18:45 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 5 Jun 2015 18:18:45 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
Message-ID: <72fef97e-a322-4430-83f8-0aad081f34df@HUCCAS02P.hostedmsx.local>


Hi,
I have been using gdal_grid to interpolate LiDAR data for some time now.? This would be a typical command:

gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 401135.0 -tye 5568587.0 5773796.0?-a nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0 205209.0 -of GTiff H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif?--config GDAL_NUM_THREADS ALL_CPUS

As you can see, this is a huge raster and the csv. file (Pointed with a .vrt) contains over a billion points.? I am trying to do this in one shot to avoid boundary effects.? (I know I can split this .csv file into smaller bits and make this more efficient).?? The computer I am using has 12 cores, 64BG of memory (smaller than the csv file) and a 1TB pcie solid state drive.? It should manage the task but it has been running for 5 days with less than 10% done).? I have access to a super computer with gdal if all else fails. ???

This is my question.? The "--config GDAL_NUM_THREADS ALL_CPUS" or "--config GDAL_NUM_THREADS 12" does not seem to work with the nearest neighbor algorithm. (It seem to work with the -a count command)? If I use this on a smaller data set, I see no difference in speed or cpu usage between using the "ALL_CPUS" or not using this switch.? Is this a bug or simply a limitation of the nearest neighbor algorithm?? I don't want to move this to a super computer if it will not multi-thread properly.??

Thanks,
Nicolas Cadieux

(Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on windows 7_64)? I use GDAL from the command line not from QGIS.


Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

From even.rouault at spatialys.com  Fri Jun  5 16:13:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 6 Jun 2015 01:13:55 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <72fef97e-a322-4430-83f8-0aad081f34df@HUCCAS02P.hostedmsx.local>
References: <72fef97e-a322-4430-83f8-0aad081f34df@HUCCAS02P.hostedmsx.local>
Message-ID: <201506060113.55444.even.rouault@spatialys.com>

Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> Hi,
> I have been using gdal_grid to interpolate LiDAR data for some time now. 
> This would be a typical command:
> 
> gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 401135.0
> -tye 5568587.0 5773796.0 -a
> nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0
> 205209.0 -of GTiff
> H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt
> H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif --confi
> g GDAL_NUM_THREADS ALL_CPUS
> 
> As you can see, this is a huge raster and the csv. file (Pointed with a
> .vrt) contains over a billion points.  I am trying to do this in one shot
> to avoid boundary effects.  (I know I can split this .csv file into
> smaller bits and make this more efficient).   The computer I am using has
> 12 cores, 64BG of memory (smaller than the csv file) and a 1TB pcie solid
> state drive.  It should manage the task but it has been running for 5 days
> with less than 10% done).  I have access to a super computer with gdal if
> all else fails.    
> 
> This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS" or "--config
> GDAL_NUM_THREADS 12" does not seem to work with the nearest neighbor
> algorithm. (It seem to work with the -a count command)  If I use this on a
> smaller data set, I see no difference in speed or cpu usage between using
> the "ALL_CPUS" or not using this switch.  Is this a bug or simply a
> limitation of the nearest neighbor algorithm? 

Nicolas,

The threading mechanism is generic for all algorithms . Add "--debug on" and 
you should see traces like "GDAL_GRID: Using 12 threads". Now, a reason for it 
not being efficient is that the work buffer used by gdalgrid (16 MB) is too small 
w.r.t to nearest speed. Hum, actually looking more closely at the code, I see 
that the quad tree to index the points will be rebuilt for each work buffer. 
This is likely the main cause of the inefficiency and why you don't see 
measurable differences between non threaded or threaded computations (since the 
building of the quadtree is not multithreaded). If you compiled from source, 
you could try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;" 
line in apps/gdal_grid.cpp to a much higher value. A more proper solution 
would be to avoid rebuilding the quad tree for each work buffer. This is mainly 
code restructuring.

An alternative to gdal_grid would be to use gdal_rasterize + gdal_fillnodata. 
This is usually much much faster, so you could try to check if it gives the 
results you expect.

You could also try scipy :
http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpolate.griddata.html#scipy.interpolate.griddata
Not sure how it behaves with that number of points.

Even

> I don't want to move this
> to a super computer if it will not multi-thread properly.  
> 
> Thanks,
> Nicolas Cadieux
> 
> (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on windows
> 7_64)  I use GDAL from the command line not from QGIS.
> 
> 
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc. 
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cgodkin at gmail.com  Fri Jun  5 16:24:49 2015
From: cgodkin at gmail.com (Carl Godkin)
Date: Fri, 5 Jun 2015 16:24:49 -0700
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506060113.55444.even.rouault@spatialys.com>
References: <72fef97e-a322-4430-83f8-0aad081f34df@HUCCAS02P.hostedmsx.local>
	<201506060113.55444.even.rouault@spatialys.com>
Message-ID: <CAE=8kmkdD2yEHv-QMtL3uMFG2eQYJD0pHwLL7onw_0ZCxeoSTA@mail.gmail.com>

Hi Nicolas,

You might also be interested in a new development discussed over the past
couple of
days on the PDAL list.

See http://lists.osgeo.org/pipermail/pdal/2015-June/000590.html

Hope it helps,

carl


On Fri, Jun 5, 2015 at 4:13 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > Hi,
> > I have been using gdal_grid to interpolate LiDAR data for some time now.
> > This would be a typical command:
> >
> > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 401135.0
> > -tye 5568587.0 5773796.0 -a
> > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0
> > 205209.0 -of GTiff
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif
> --confi
> > g GDAL_NUM_THREADS ALL_CPUS
> >
> > As you can see, this is a huge raster and the csv. file (Pointed with a
> > .vrt) contains over a billion points.  I am trying to do this in one shot
> > to avoid boundary effects.  (I know I can split this .csv file into
> > smaller bits and make this more efficient).   The computer I am using has
> > 12 cores, 64BG of memory (smaller than the csv file) and a 1TB pcie solid
> > state drive.  It should manage the task but it has been running for 5
> days
> > with less than 10% done).  I have access to a super computer with gdal if
> > all else fails.
> >
> > This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS" or
> "--config
> > GDAL_NUM_THREADS 12" does not seem to work with the nearest neighbor
> > algorithm. (It seem to work with the -a count command)  If I use this on
> a
> > smaller data set, I see no difference in speed or cpu usage between using
> > the "ALL_CPUS" or not using this switch.  Is this a bug or simply a
> > limitation of the nearest neighbor algorithm?
>
> Nicolas,
>
> The threading mechanism is generic for all algorithms . Add "--debug on"
> and
> you should see traces like "GDAL_GRID: Using 12 threads". Now, a reason
> for it
> not being efficient is that the work buffer used by gdalgrid (16 MB) is
> too small
> w.r.t to nearest speed. Hum, actually looking more closely at the code, I
> see
> that the quad tree to index the points will be rebuilt for each work
> buffer.
> This is likely the main cause of the inefficiency and why you don't see
> measurable differences between non threaded or threaded computations
> (since the
> building of the quadtree is not multithreaded). If you compiled from
> source,
> you could try changing the "const GUInt32 nDesiredBufferSize =
> 16*1024*1024;"
> line in apps/gdal_grid.cpp to a much higher value. A more proper solution
> would be to avoid rebuilding the quad tree for each work buffer. This is
> mainly
> code restructuring.
>
> An alternative to gdal_grid would be to use gdal_rasterize +
> gdal_fillnodata.
> This is usually much much faster, so you could try to check if it gives the
> results you expect.
>
> You could also try scipy :
>
> http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpolate.griddata.html#scipy.interpolate.griddata
> Not sure how it behaves with that number of points.
>
> Even
>
> > I don't want to move this
> > to a super computer if it will not multi-thread properly.
> >
> > Thanks,
> > Nicolas Cadieux
> >
> > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on
> windows
> > 7_64)  I use GDAL from the command line not from QGIS.
> >
> >
> > Nicolas Cadieux M.Sc.
> > Les Entreprises Arch?otec inc.
> > 8548, rue Saint-Denis Montr?al H2P 2H2
> > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > www.archeotec.ca
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150605/f2ad3cd1/attachment.html>

From lukepinnerau at gmail.com  Fri Jun  5 17:42:12 2015
From: lukepinnerau at gmail.com (Luke)
Date: Fri, 5 Jun 2015 17:42:12 -0700 (PDT)
Subject: [gdal-dev] ImportError: numpy.core.multiarray failed to import
In-Reply-To: <2086CE7E967C1B4F9D5897BE1C3C746F311942CB@ECS-EXG-P-MB01.win.lanl.gov>
References: <2086CE7E967C1B4F9D5897BE1C3C746F311942CB@ECS-EXG-P-MB01.win.lanl.gov>
Message-ID: <1433551332845-5209498.post@n6.nabble.com>

Sounds like you have a version mismatch. For example, you'll get that message
if you have numpy 1.7x installed and you installed the gdal binaries and
bindings from Christoph Gohlke
(http://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal) which are built against
numpy 1.9x

If you have numpy 1.7x installed and don't want to upgrade it to numpy 1.9x
(i.e if you are running ArcGIS 10.2 which *requires* numpy 1.7x) you can
install the gdal binaries and bindings from Tamas' GIS Internals site
(http://www.gisinternals.com).



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-ImportError-numpy-core-multiarray-failed-to-import-tp5209204p5209498.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nicolas.cadieux at archeotec.ca  Fri Jun  5 19:00:40 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 5 Jun 2015 22:00:40 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506060113.55444.even.rouault@spatialys.com>
Message-ID: <d2684747-b93b-4e33-b421-fa847c3bcb80@email.android.com>

Thanks Even,

My programing skills are very limited (to mapbasic and thankfully  python).   Restructuring the code is beyond me but I will try to change the variables and recompile.  What to you recommend the new value be? 

I have never done recompiling  in anything but MapBasic so any link toward a tutorial to do this on Windows would be helpful.

I will also look at the rasterize.  This could be a good solution as I am already using the fill no data for anything larger than my 3 meter radius.  

Talking about null data, is it possible to write the no data value in gdal_grid?  I know I can modify it to -32768 for example, but when I open the layer, that no data value become a true value and I need to use another module (translate or warp i think) to explicitly write the no data value in the raster.

The learning curve will be steep but it will be fun!

Thanks for the help.


Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 5, 2015 7:13 PM, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit : 
> > Hi, 
> > I have been using gdal_grid to interpolate LiDAR data for some time now. 
> > This would be a typical command: 
> > 
> > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 401135.0 
> > -tye 5568587.0 5773796.0 -a 
> > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0 
> > 205209.0 -of GTiff 
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt 
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif --confi 
> > g GDAL_NUM_THREADS ALL_CPUS 
> > 
> > As you can see, this is a huge raster and the csv. file (Pointed with a 
> > .vrt) contains over a billion points.? I am trying to do this in one shot 
> > to avoid boundary effects.? (I know I can split this .csv file into 
> > smaller bits and make this more efficient).?? The computer I am using has 
> > 12 cores, 64BG of memory (smaller than the csv file) and a 1TB pcie solid 
> > state drive.? It should manage the task but it has been running for 5 days 
> > with less than 10% done).? I have access to a super computer with gdal if 
> > all else fails.??? 
> > 
> > This is my question.? The "--config GDAL_NUM_THREADS ALL_CPUS" or "--config 
> > GDAL_NUM_THREADS 12" does not seem to work with the nearest neighbor 
> > algorithm. (It seem to work with the -a count command)? If I use this on a 
> > smaller data set, I see no difference in speed or cpu usage between using 
> > the "ALL_CPUS" or not using this switch.? Is this a bug or simply a 
> > limitation of the nearest neighbor algorithm? 
>
> Nicolas, 
>
> The threading mechanism is generic for all algorithms . Add "--debug on" and 
> you should see traces like "GDAL_GRID: Using 12 threads". Now, a reason for it 
> not being efficient is that the work buffer used by gdalgrid (16 MB) is too small 
> w.r.t to nearest speed. Hum, actually looking more closely at the code, I see 
> that the quad tree to index the points will be rebuilt for each work buffer. 
> This is likely the main cause of the inefficiency and why you don't see 
> measurable differences between non threaded or threaded computations (since the 
> building of the quadtree is not multithreaded). If you compiled from source, 
> you could try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;" 
> line in apps/gdal_grid.cpp to a much higher value. A more proper solution 
> would be to avoid rebuilding the quad tree for each work buffer. This is mainly 
> code restructuring. 
>
> An alternative to gdal_grid would be to use gdal_rasterize + gdal_fillnodata. 
> This is usually much much faster, so you could try to check if it gives the 
> results you expect. 
>
> You could also try scipy : 
> http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpolate.griddata.html#scipy.interpolate.griddata 
> Not sure how it behaves with that number of points. 
>
> Even 
>
> > I don't want to move this 
> > to a super computer if it will not multi-thread properly.? 
> > 
> > Thanks, 
> > Nicolas Cadieux 
> > 
> > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on windows 
> > 7_64)? I use GDAL from the command line not from QGIS. 
> > 
> > 
> > Nicolas Cadieux M.Sc. 
> > Les Entreprises Arch?otec inc. 
> > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > www.archeotec.ca 
> > _______________________________________________ 
> > gdal-dev mailing list 
> > gdal-dev at lists.osgeo.org 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com 

From nicolas.cadieux at archeotec.ca  Fri Jun  5 19:12:07 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 5 Jun 2015 22:12:07 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <CAE=8kmkdD2yEHv-QMtL3uMFG2eQYJD0pHwLL7onw_0ZCxeoSTA@mail.gmail.com>
Message-ID: <8af222f8-8cd9-437f-9f79-e5a9d2191d20@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150605/fbcb25dc/attachment.html>

From jawahar_d at hotmail.com  Sat Jun  6 01:31:59 2015
From: jawahar_d at hotmail.com (djawahar)
Date: Sat, 6 Jun 2015 01:31:59 -0700 (PDT)
Subject: [gdal-dev] getting height from Geotiff DEM
Message-ID: <1433579519936-5209506.post@n6.nabble.com>

Hi,
   I have a geotiff dem. How can I get the height information given a pixel
coordinate? I tried to get the data using
gdErr = poDataset->GetRasterBand(1)->RasterIO(
				GF_Read, 0, 0, poDataset->GetRasterXSize(), poDataset->GetRasterYSize(),
				pBits, bmi.Header.biWidth, bmi.Header.biHeight, GDT_Byte,
				1, nScanSize);

but the data is either 0 or 255.

What is the right way to do this?

Thanks & regards,

D. Jawahar



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/getting-height-from-Geotiff-DEM-tp5209506.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nicolas.cadieux at archeotec.ca  Sat Jun  6 07:34:32 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 6 Jun 2015 10:34:32 -0400
Subject: [gdal-dev] getting height from Geotiff DEM
In-Reply-To: <1433579519936-5209506.post@n6.nabble.com>
Message-ID: <67c98e29-875c-47f7-8636-27c0b983e90e@email.android.com>

Hi,

There is the " value tool plugin" that you can install.  That will give you the values when you move your mouse across  the raster. For more points, install the "point sampling tool" plugin.

Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 6, 2015 4:31 AM, djawahar <jawahar_d at hotmail.com> wrote:
>
> Hi, 
> ?? I have a geotiff dem. How can I get the height information given a pixel 
> coordinate? I tried to get the data using 
> gdErr = poDataset->GetRasterBand(1)->RasterIO( 
> GF_Read, 0, 0, poDataset->GetRasterXSize(), poDataset->GetRasterYSize(), 
> pBits, bmi.Header.biWidth, bmi.Header.biHeight, GDT_Byte, 
> 1, nScanSize); 
>
> but the data is either 0 or 255. 
>
> What is the right way to do this? 
>
> Thanks & regards, 
>
> D. Jawahar 
>
>
>
> -- 
> View this message in context: http://osgeo-org.1560.x6.nabble.com/getting-height-from-Geotiff-DEM-tp5209506.html 
> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> _______________________________________________ 
> gdal-dev mailing list 
> gdal-dev at lists.osgeo.org 
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 

From nicolas.cadieux at archeotec.ca  Sat Jun  6 08:37:36 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 6 Jun 2015 11:37:36 -0400
Subject: [gdal-dev] getting height from Geotiff DEM
In-Reply-To: <67c98e29-875c-47f7-8636-27c0b983e90e@email.android.com>
Message-ID: <42f6f02c-b3ec-4373-a096-27654c72680a@email.android.com>

Sorry,

This was the correct answer but for the wrong user list....

Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 6, 2015 10:34, Nicolas Cadieux <nicolas.cadieux at archeotec.ca> wrote:
>
> Hi,
>
> There is the " value tool plugin" that you can install.? That will give you the values when you move your mouse across? the raster. For more points, install the "point sampling tool" plugin.
>
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc.?
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone:?514.381.5112 ?Fax: 514.381.4995
> www.archeotec.ca
>
> On Jun 6, 2015 4:31 AM, djawahar <jawahar_d at hotmail.com> wrote:
> >
> > Hi, 
> > ?? I have a geotiff dem. How can I get the height information given a pixel 
> > coordinate? I tried to get the data using 
> > gdErr = poDataset->GetRasterBand(1)->RasterIO( 
> > GF_Read, 0, 0, poDataset->GetRasterXSize(), poDataset->GetRasterYSize(), 
> > pBits, bmi.Header.biWidth, bmi.Header.biHeight, GDT_Byte, 
> > 1, nScanSize); 
> >
> > but the data is either 0 or 255. 
> >
> > What is the right way to do this? 
> >
> > Thanks & regards, 
> >
> > D. Jawahar 
> >
> >
> >
> > -- 
> > View this message in context: http://osgeo-org.1560.x6.nabble.com/getting-height-from-Geotiff-DEM-tp5209506.html 
> > Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> > _______________________________________________ 
> > gdal-dev mailing list 
> > gdal-dev at lists.osgeo.org 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From lucena_ivan at hotmail.com  Sat Jun  6 09:18:09 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Sat, 6 Jun 2015 12:18:09 -0400
Subject: [gdal-dev] getting height from Geotiff DEM
In-Reply-To: <1433579519936-5209506.post@n6.nabble.com>
References: <1433579519936-5209506.post@n6.nabble.com>
Message-ID: <BLU173-W33C71D7B0F3B78E638563B90B10@phx.gbl>

Usually DEM are not unsigned 8 bit but if you are asking for GDT_Byte, that is what you will get. 

You should change that RasterIO() parameter to GDT_Float32 for example.

> Date: Sat, 6 Jun 2015 01:31:59 -0700
> From: jawahar_d at hotmail.com
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] getting height from Geotiff DEM
> 
> Hi,
>    I have a geotiff dem. How can I get the height information given a pixel
> coordinate? I tried to get the data using
> gdErr = poDataset->GetRasterBand(1)->RasterIO(
> 				GF_Read, 0, 0, poDataset->GetRasterXSize(), poDataset->GetRasterYSize(),
> 				pBits, bmi.Header.biWidth, bmi.Header.biHeight, GDT_Byte,
> 				1, nScanSize);
> 
> but the data is either 0 or 255.
> 
> What is the right way to do this?
> 
> Thanks & regards,
> 
> D. Jawahar
> 
> 
> 
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/getting-height-from-Geotiff-DEM-tp5209506.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150606/7ee2f815/attachment.html>

From sfkeller at gmail.com  Sun Jun  7 04:46:30 2015
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 7 Jun 2015 13:46:30 +0200
Subject: [gdal-dev] OGR Field Types?
In-Reply-To: <201506050950.28947.even.rouault@spatialys.com>
References: <CAFcOn28oLBOBdA6ExSUtHOphuYWb-hcyj6oFeAVEoWHzSZRD6A@mail.gmail.com>
	<CAFcOn28gBGuhcB=gQnuVAzXvkg-L8XveR3TrBwFB4swND6c7CQ@mail.gmail.com>
	<CAFcOn292NczaO=k7taL5bDahg-+UzAwN3GLcF0obDCsz5iceKw@mail.gmail.com>
	<201506050950.28947.even.rouault@spatialys.com>
Message-ID: <CAFcOn28Pp1QE6ZHT-_xSmvQOnutQeKnijy_9rcFo+DkNj4H2oQ@mail.gmail.com>

Salut Even

You're right again. It should be "OGC WMS-format Coordinate Reference
Systems" not ESRI WKT!
I've updated the GeoCSV spec. [1] - and the Editable GeoCSV plugin
(per next week).
And I've entered finally an OGR issue for this enhancement [2].

Cheers, S.

[1] http://giswiki.hsr.ch/GeoCSV#PRJ_file_format_specification
[2] https://trac.osgeo.org/gdal/ticket/5989


2015-06-05 9:50 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Hi Stefan,
>
>>
>> We've finished the GeoCSV spec. and we're almost ready to publish the
>> Editable GeoCSV plugin fpr QGIS.
>>
>> So, I have following enhancement requests for the OGR CSV reader,
>> regarding CSVT:
>> 1. Accept "WKT" (case insensitive) indicating WKT geometry field.
>> 2. Accept "CoordX" and "CoordX" (in any order, case insensitive)
>> indicating easting/northing of a point geometry.
>> 3. While opening the CSV file, look for .prj as coordinate reference
>> system/CRS (same CRS format like Shapefiles).
> Hum, ESRI WKT so ? I would have rather recommanded the OGC WKT format (the one
> natively spoken by GDAL, based on OGC 01-009
> http://www.opengeospatial.org/standards/ct), that has the advantage of
> including EPSG codes explicitely. If you'd want to be up-to-date, there's also
> the WKT 2 / ISO TC 211 format (
> http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ), but GDAL doesn't
> handle it yet.
>
>>
>> What do you think? Can I open an enhancement request for this?
>
> Yes, I might have a look at that while doing something related in the CSV
> driver.
>
> Even
>
>>
>> Cheers, S.
>>
>> 2015-05-22 1:07 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>> > 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> > ...
>> >
>> >>> * "Easting","Northing"
>> >>
>> >> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be
>> >> easier to get. I don't know.
>> >
>> > So let's propose Point(X),Point(Y) or PointX,PointY.
>> >
>> > -S.
>> >
>> > 2015-05-22 0:53 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >> Le vendredi 22 mai 2015 00:33:43, Stefan Keller a ?crit :
>> >>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >>> ...
>> >>>
>> >>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>> >>> >
>> >>> > For points only I guess?
>> >>>
>> >>> Yes.
>> >>>
>> >>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT
>> >>> >> (default), Point, LineString, Polygon.
>> >>> >
>> >>> > "WKT" is not really consistant with Point,LineString,Polygon since
>> >>> > the later would be expressed as WKT I guess. So perhaps WKT,
>> >>> > WKT(Point), WKT(LineString), WKT(Polygon) ?
>> >>>
>> >>> Right, d'accord. So, let's introduce following two geometry types:
>> >>> * "Easting","Northing"
>> >>
>> >> X,Y or Geometry(X), Geometry(Y) or Point(X),Point(Y) would perhaps be
>> >> easier to get. I don't know.
>> >>
>> >>> * WKT, WKT(Point), WKT(LineString), WKT(Polygon)
>> >>>
>> >>> There are additional restricions to these geometry types:
>> >>> * "Easting","Northing" must co-occur and should be neighboring columns
>> >>> (in either order).
>> >>
>> >> I guess most people would do that, but I don't see a strong rationale to
>> >> impose neighboring coumns
>> >>
>> >>> * if WKT is given, all rows are expected to contain the same geometry
>> >>> type.
>> >>
>> >> For generic WKT, all geometry types should be possible (as currently).
>> >> Only for WKT(xxxx), geometries should be restricted to the specified
>> >> type.
>> >>
>> >>> * There's only one geometry column per .csvt, namely either
>> >>> <<"Easting","Northing">> or <<WKT>>.
>> >>
>> >> Kind of makes sense for Easting,Northing. But for WKT columns I don't
>> >> see a reason for such a restriction. Actually there's already a
>> >> secret/undocumented/debug mode in the CSV driver to read multiple
>> >> geometry columns (I won't reveal it unless I'm tortured, but you can
>> >> look at the code). This was mostly useful at the first stages when
>> >> developing RFC 41.
>> >>
>> >>> OK?
>> >>
>> >> Not sure what kind of committment would be expected if I say "OK", so
>> >> I'll abstain ;-)
>> >>
>> >>> --S.
>> >>>
>> >>> 2015-05-21 23:34 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
>> >>> > Le jeudi 21 mai 2015 23:17:26, Stefan Keller a ?crit :
>> >>> >> Hi Even
>> >>> >>
>> >>> >> I just see some type mod and subtype definitions for .csvt files in
>> >>> >> the CSV docs [1] :
>> >>> >> <<
>> >>> >> In a single line the types for each column have to be listed with
>> >>> >> double quotes and be comma separated (e.g., "Integer","String"). It
>> >>> >> is also possible to specify explicitly the width and precision of
>> >>> >> each column, e.g. "Integer(5)","Real(10.7)","String(15)". The
>> >>> >> driver will then use these types as specified for the csv columns.
>> >>> >> Starting with GDAL 2.0, subtypes can be passed between parenthesis,
>> >>> >> such as "Integer(Boolean)", "Integer(Int16)" and "Real(Float32)"
>> >>> >> <<
>> >>> >>
>> >>> >> Following questions and suggestions about .csvt:
>> >>> >> 1. Do type names really have to be in double quotes?
>> >>> >
>> >>> > No
>> >>> >
>> >>> >> 2. Is the separator always comma or can it also be a semicolon?
>> >>> >
>> >>> > Yes, always comma
>> >>> >
>> >>> >> 3. What about a Geometry type with subtypes? I suggest to add
>> >>> >> 4. "Geometry(Easting)","Geometry(Northing)"
>> >>> >
>> >>> > For points only I guess? Well you can build points with a OGR VRT
>> >>> > from 2 CSV columns. I might perhaps add in some time an open option
>> >>> > to specify the columns for the easting/longitude and
>> >>> > northing/latitude.
>> >>> >
>> >>> >> 5. "Geometry" -- encoded in WKT; having subtype values WKT
>> >>> >> (default), Point, LineString, Polygon.
>> >>> >
>> >>> > "WKT" is not really consistant with Point,LineString,Polygon since
>> >>> > the later would be expressed as WKT I guess. So perhaps WKT,
>> >>> > WKT(Point), WKT(LineString), WKT(Polygon) ?
>> >>> >
>> >>> >> What do you think?
>> >>> >> This could also make QGIS "Add Delimited Text Layer..." even better.
>> >>> >>
>> >>> >> --S.
>> >>> >>
>> >>> >> [1] http://www.gdal.org/drv_csv.html
>> >>> >>
>> >>> >> 2015-04-29 22:57 GMT+02:00 Stefan Keller <sfkeller at gmail.com>:
>> >>> >> > Salut Even,
>> >>> >> >
>> >>> >> > Merci!
>> >>> >> >
>> >>> >> > 2015-04-29 20:35 GMT+02:00 Even Rouault
> <even.rouault at spatialys.com>:
>> >>> >> >> Stefan
>> >>> >> >>
>> >>> >> >>> Questions:
>> >>> >> >>> 1. How is 'binary' encoded? E.g. when defining binary in a CSV
>> >>> >> >>> file, how is it encoded? Hex?
>> >>> >> >>
>> >>> >> >> There's no support in the CSV driver for binary data
>> >>> >> >>
>> >>> >> >>> 2. Can a field in a CSV input files have a IntegerList or a
>> >>> >> >>> Binary?
>> >>> >> >>
>> >>> >> >> No. Well on writing, the IntegerList will be serialized as a
>> >>> >> >> string. But not recognized as IntegerList on reading
>> >>> >> >>
>> >>> >> >>> 3. What is the value delimiter in a field of type IntegerList,
>> >>> >> >>> Integer64List, RealList, StringList?
>> >>> >> >>
>> >>> >> >> The default serializatoin will be
>> >>> >> >> (number_of_elements:val1,val2,...,valn), but currently it is
>> >>> >> >> truncated to 80 chracters
>> >>> >> >>
>> >>> >> >>> 4. "Boolean, Int16, Float32" are mentioned as subtypes. Are
>> >>> >> >>> there more subtypes?
>> >>> >> >>
>> >>> >> >> Not currently. See
>> >>> >> >> https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>> >>> >> >>
>> >>> >> >> Even
>> >>> >> >>
>> >>> >> >> --
>> >>> >> >> Spatialys - Geospatial professional services
>> >>> >> >> http://www.spatialys.com
>> >>> >
>> >>> > --
>> >>> > Spatialys - Geospatial professional services
>> >>> > http://www.spatialys.com
>> >>
>> >> --
>> >> Spatialys - Geospatial professional services
>> >> http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From doug.mccorkle at gmail.com  Sun Jun  7 09:50:06 2015
From: doug.mccorkle at gmail.com (Doug McCorkle)
Date: Sun, 7 Jun 2015 11:50:06 -0500
Subject: [gdal-dev] Validating a projection
Message-ID: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>

Hello,

I am trying to add this projection to our runtime environment:

PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
    GEOGCS["GCS_North_American_1983",
        DATUM["D_North_American_1983",
            SPHEROID["GRS_1980",6378137.0,298.257222101]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["False_Easting",0.0],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",-96.0],
    PARAMETER["Standard_Parallel_1",29.5],
    PARAMETER["Standard_Parallel_2",45.5],
    PARAMETER["Latitude_Of_Origin",23.0],
    UNIT["Meter",1.0],
    AUTHORITY["EPSG","102039?]]

in the esri_extra.wkt file with:

102039,PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-96.0],PARAMETER["Standard_Parallel_1",29.5],PARAMETER["Standard_Parallel_2",45.5],PARAMETER["Latitude_Of_Origin",23.0],UNIT["Meter",1.0],AUTHORITY["EPSG","102039?]]

When I try to validate the projection I get this in the debug output:

OGRSpatialReference::Validate: PARAMETER Central_Meridian for PROJECTION Albers_Conic_Equal_Area is an alias for longitude_of_center.

I am unsure of what to do with this debug information to correct the definition. This is the proj4 definition:

# USA Contiguous Albers Equal Area Conic USGS version
<102039> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23.0 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs <>

Any pointers on how to correct the issue is appreciated. Thanks in advance.

Doug



From andre+joost at nurfuerspam.de  Sun Jun  7 11:16:05 2015
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sun, 07 Jun 2015 20:16:05 +0200
Subject: [gdal-dev] Validating a projection
In-Reply-To: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>
References: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>
Message-ID: <ml220c$la8$1@ger.gmane.org>

Am 07.06.2015 um 18:50 schrieb Doug McCorkle:
> Hello,
>
> I am trying to add this projection to our runtime environment:
>
> PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
> GEOGCS["GCS_North_American_1983", DATUM["D_North_American_1983",
> SPHEROID["GRS_1980",6378137.0,298.257222101]],
> PRIMEM["Greenwich",0.0], UNIT["Degree",0.0174532925199433],
> AUTHORITY["EPSG","4269"]], PROJECTION["Albers_Conic_Equal_Area"],
> PARAMETER["False_Easting",0.0], PARAMETER["False_Northing",0.0],
> PARAMETER["Central_Meridian",-96.0],
> PARAMETER["Standard_Parallel_1",29.5],
> PARAMETER["Standard_Parallel_2",45.5],
> PARAMETER["Latitude_Of_Origin",23.0], UNIT["Meter",1.0],
> AUTHORITY["EPSG","102039?]]
>

>  When I try to validate the projection I get this in the debug
> output:
>
> OGRSpatialReference::Validate: PARAMETER Central_Meridian for
> PROJECTION Albers_Conic_Equal_Area is an alias for
> longitude_of_center.
>
> I am unsure of what to do with this debug information to correct the
> definition. This is the proj4 definition:
>
> # USA Contiguous Albers Equal Area Conic USGS version <102039>
> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23.0 +lon_0=-96 +x_0=0
> +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs <>
>

If you run gdalsrsinfo on this proj.4 string, you get the following WKT 
output:

PROJCS["unnamed",
     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.257222101,
                 AUTHORITY["EPSG","7019"]],
             TOWGS84[0,0,0,0,0,0,0],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.0174532925199433,
             AUTHORITY["EPSG","9108"]],
         AUTHORITY["EPSG","4269"]],
     PROJECTION["Albers_Conic_Equal_Area"],
     PARAMETER["standard_parallel_1",29.5],
     PARAMETER["standard_parallel_2",45.5],
     PARAMETER["latitude_of_center",23],
     PARAMETER["longitude_of_center",-96],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["Meter",1]]

So it is really a matter of naming the same parameter. Using 
longitude_of_center will make all GDAL-dependent software happy, while 
the Central_Meridian might be invoked by ESRI.

See also 
http://www.remotesensing.org/geotiff/proj_list/albers_equal_area_conic.html 
for the official OGC WKT parameter names.

HTH,
Andr? Joost



From doug.mccorkle at gmail.com  Sun Jun  7 11:22:26 2015
From: doug.mccorkle at gmail.com (Doug McCorkle)
Date: Sun, 7 Jun 2015 13:22:26 -0500
Subject: [gdal-dev] Validating a projection
In-Reply-To: <ml220c$la8$1@ger.gmane.org>
References: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>
	<ml220c$la8$1@ger.gmane.org>
Message-ID: <2353652A-CA81-471B-8E8E-000097B933D7@gmail.com>



> On Jun 7, 2015, at 1:16 PM, Andre Joost <andre+joost at nurfuerspam.de> wrote:
> 
> Am 07.06.2015 um 18:50 schrieb Doug McCorkle:
>> Hello,
>> 
>> I am trying to add this projection to our runtime environment:
>> 
>> PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
>> GEOGCS["GCS_North_American_1983", DATUM["D_North_American_1983",
>> SPHEROID["GRS_1980",6378137.0,298.257222101]],
>> PRIMEM["Greenwich",0.0], UNIT["Degree",0.0174532925199433],
>> AUTHORITY["EPSG","4269"]], PROJECTION["Albers_Conic_Equal_Area"],
>> PARAMETER["False_Easting",0.0], PARAMETER["False_Northing",0.0],
>> PARAMETER["Central_Meridian",-96.0],
>> PARAMETER["Standard_Parallel_1",29.5],
>> PARAMETER["Standard_Parallel_2",45.5],
>> PARAMETER["Latitude_Of_Origin",23.0], UNIT["Meter",1.0],
>> AUTHORITY["EPSG","102039?]]
>> 
> 
>> When I try to validate the projection I get this in the debug
>> output:
>> 
>> OGRSpatialReference::Validate: PARAMETER Central_Meridian for
>> PROJECTION Albers_Conic_Equal_Area is an alias for
>> longitude_of_center.
>> 
>> I am unsure of what to do with this debug information to correct the
>> definition. This is the proj4 definition:
>> 
>> # USA Contiguous Albers Equal Area Conic USGS version <102039>
>> +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23.0 +lon_0=-96 +x_0=0
>> +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs <>
>> 
> 
> If you run gdalsrsinfo on this proj.4 string, you get the following WKT output:
> 
> PROJCS["unnamed",
>    GEOGCS["NAD83",
>        DATUM["North_American_Datum_1983",
>            SPHEROID["GRS 1980",6378137,298.257222101,
>                AUTHORITY["EPSG","7019"]],
>            TOWGS84[0,0,0,0,0,0,0],
>            AUTHORITY["EPSG","6269"]],
>        PRIMEM["Greenwich",0,
>            AUTHORITY["EPSG","8901"]],
>        UNIT["degree",0.0174532925199433,
>            AUTHORITY["EPSG","9108"]],
>        AUTHORITY["EPSG","4269"]],
>    PROJECTION["Albers_Conic_Equal_Area"],
>    PARAMETER["standard_parallel_1",29.5],
>    PARAMETER["standard_parallel_2",45.5],
>    PARAMETER["latitude_of_center",23],
>    PARAMETER["longitude_of_center",-96],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["Meter",1]]
> 
> So it is really a matter of naming the same parameter. Using longitude_of_center will make all GDAL-dependent software happy, while the Central_Meridian might be invoked by ESRI.
> 
> See also http://www.remotesensing.org/geotiff/proj_list/albers_equal_area_conic.html for the official OGC WKT parameter names.

Andre,

Perfect! Thanks for the quick response and tip. 

Doug


From simonhege at hotmail.com  Sun Jun  7 15:11:44 2015
From: simonhege at hotmail.com (Simon Hege)
Date: Sun, 7 Jun 2015 22:11:44 +0000
Subject: [gdal-dev] OGRGeometry copy constructor
In-Reply-To: <201506051746.20575.even.rouault@spatialys.com>
References: <DUB122-W501BA05EF9504424B78ECBB6B20@phx.gbl>,
	<201506051746.20575.even.rouault@spatialys.com>
Message-ID: <DUB122-W27965B74132FFB46941D08B6B00@phx.gbl>

Even,

I submitted the patch as http://trac.osgeo.org/gdal/ticket/5990

Feel free to ask for improvements if needed.

Simon

> From: even.rouault at spatialys.com
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] OGRGeometry copy constructor
> Date: Fri, 5 Jun 2015 17:46:20 +0200
> CC: simonhege at hotmail.com
> 
> Simon,
> 
> > Looking at the code of GDAL 2.0 (but also 1.x), I noticed that the
> > OGRGeometry class (and the derived classes) do not respects the Rule of 3
> > : there is a destructor and no copy constructor or assignment operator.
> 
> Indeed, the Rule of 3 is not currently really implemented in the C++ API.
> 
> > It
> > seems to me that this may lead to memory leaks on OGRSpatialReference (for
> > example when using std::vector<OGRPoint> and not std::vector<OGRPoint*>).
> > This is not an issue when using the C API because the clone() method is
> > used. Am I well understanding the API ?
> > 
> > Various solutions exists:
> > 1) defines private copy constructors and assignment operators (eg. libkml
> > does this with a macro on each class: LIBKML_DISALLOW_EVIL_CONSTRUCTORS)
> > 2) implements these methods, and manage poSRS the same way that clone() 
> > does. 3) do nothing (and document it somewhere)
> > 
> > If needed I may open an issue and/or send a patch.
> 
> Option 2 looks good to me if you want to prepare a patch for it. Test cases in 
> autotest/cpp/test_ogr.cpp would be appreciated.
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150607/e5cc5d28/attachment.html>

From doug.mccorkle at gmail.com  Sun Jun  7 16:38:49 2015
From: doug.mccorkle at gmail.com (Doug McCorkle)
Date: Sun, 7 Jun 2015 18:38:49 -0500
Subject: [gdal-dev] Validating a projection
In-Reply-To: <2353652A-CA81-471B-8E8E-000097B933D7@gmail.com>
References: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>
	<ml220c$la8$1@ger.gmane.org>
	<2353652A-CA81-471B-8E8E-000097B933D7@gmail.com>
Message-ID: <1AC8C55B-0B74-475B-B928-D13E8C7D91DB@gmail.com>


> On Jun 7, 2015, at 1:22 PM, Doug McCorkle <doug.mccorkle at gmail.com> wrote:
> 
>> 

[snip]

>> If you run gdalsrsinfo on this proj.4 string, you get the following WKT output:
>> 
>> PROJCS["unnamed",
>>   GEOGCS["NAD83",
>>       DATUM["North_American_Datum_1983",
>>           SPHEROID["GRS 1980",6378137,298.257222101,
>>               AUTHORITY["EPSG","7019"]],
>>           TOWGS84[0,0,0,0,0,0,0],
>>           AUTHORITY["EPSG","6269"]],
>>       PRIMEM["Greenwich",0,
>>           AUTHORITY["EPSG","8901"]],
>>       UNIT["degree",0.0174532925199433,
>>           AUTHORITY["EPSG","9108"]],
>>       AUTHORITY["EPSG","4269"]],
>>   PROJECTION["Albers_Conic_Equal_Area"],
>>   PARAMETER["standard_parallel_1",29.5],
>>   PARAMETER["standard_parallel_2",45.5],
>>   PARAMETER["latitude_of_center",23],
>>   PARAMETER["longitude_of_center",-96],
>>   PARAMETER["false_easting",0],
>>   PARAMETER["false_northing",0],
>>   UNIT["Meter",1]]
>> 
>> So it is really a matter of naming the same parameter. Using longitude_of_center will make all GDAL-dependent software happy, while the Central_Meridian might be invoked by ESRI.
>> 
>> See also http://www.remotesensing.org/geotiff/proj_list/albers_equal_area_conic.html for the official OGC WKT parameter names.
> 
> Andre,
> 
> Perfect! Thanks for the quick response and tip. 
> 
> Doug
> 

Andre,

I have updated the projection information with the recommended names. When I process GeoTIFF files with this projection everything works fine while all of the data is in memory and none of the Datasets in question are written to disk. If I write the data to disk in a GeoTIFF file and then try to reload the data and acquire the EPSG with the AutoIdentifyEPSG method I get the unsupported srs error. This is the output from gdalsrsinfo for the GeoTIFF file:

OGC WKT :
PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["standard_parallel_1",29.5],
    PARAMETER["standard_parallel_2",45.5],
    PARAMETER["latitude_of_center",23],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]

It appears that the projection EPSG code is dropped during the write process to geotiff. I do notice with other projections like EPSG:3857 that this is not the case with GeoTIFF files:

OGC WKT :
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
    AUTHORITY["EPSG","3857?]]

Is there a method for enabling the EPSG code to be passed through to the GeoTIFF file in a consistent manner? Thanks again.

Doug




From andre+joost at nurfuerspam.de  Sun Jun  7 20:56:20 2015
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 08 Jun 2015 05:56:20 +0200
Subject: [gdal-dev] Validating a projection
In-Reply-To: <1AC8C55B-0B74-475B-B928-D13E8C7D91DB@gmail.com>
References: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>	<ml220c$la8$1@ger.gmane.org>	<2353652A-CA81-471B-8E8E-000097B933D7@gmail.com>
	<1AC8C55B-0B74-475B-B928-D13E8C7D91DB@gmail.com>
Message-ID: <ml33pl$ll3$1@ger.gmane.org>

Am 08.06.2015 um 01:38 schrieb Doug McCorkle:
>
>>
>
> Andre,
>
> I have updated the projection information with the recommended names.
> When I process GeoTIFF files with this projection everything works
> fine while all of the data is in memory and none of the Datasets in
> question are written to disk. If I write the data to disk in a
> GeoTIFF file and then try to reload the data and acquire the EPSG
> with the AutoIdentifyEPSG method I get the unsupported srs error.

The code 102039 is not an official EPSG code, but rather invented by 
ESRI. That is the reason why some software depending on PROJ/GDAL does 
not AutoIdentify the code number.

HTH,
Andr? Joost


From even.rouault at spatialys.com  Mon Jun  8 00:46:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 08 Jun 2015 09:46:37 +0200
Subject: [gdal-dev] Validating a projection
In-Reply-To: <ml33pl$ll3$1@ger.gmane.org>
References: <B58E056D-0954-4123-8583-134A13C654A7@gmail.com>
	<ml220c$la8$1@ger.gmane.org>
	<2353652A-CA81-471B-8E8E-000097B933D7@gmail.com>
	<1AC8C55B-0B74-475B-B928-D13E8C7D91DB@gmail.com>
	<ml33pl$ll3$1@ger.gmane.org>
Message-ID: <1433749597.5575485da0ce1@imp.free.fr>

Selon Andre Joost <andre+joost at nurfuerspam.de>:

> Am 08.06.2015 um 01:38 schrieb Doug McCorkle:
> >
> >>
> >
> > Andre,
> >
> > I have updated the projection information with the recommended names.
> > When I process GeoTIFF files with this projection everything works
> > fine while all of the data is in memory and none of the Datasets in
> > question are written to disk. If I write the data to disk in a
> > GeoTIFF file and then try to reload the data and acquire the EPSG
> > with the AutoIdentifyEPSG method I get the unsupported srs error.
>
> The code 102039 is not an official EPSG code, but rather invented by
> ESRI.

The GeoTIFF format can only store numerical codes <= 32767.

> That is the reason why some software depending on PROJ/GDAL does
> not AutoIdentify the code number.

AutoIdentifyEPSG(), as documented, only works on very few CRS definitions.

>
> HTH,
> Andr?? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Mon Jun  8 01:51:29 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Mon, 8 Jun 2015 10:51:29 +0200
Subject: [gdal-dev] shape_encoding and Windows
Message-ID: <CA+Ei1OfUGNeyQYDUextKZu+UQ0Q+1OAfHYN9XyKXzUr3z8ZzAg@mail.gmail.com>

Hi,

it's seems to me that SHAPE_ENCODING doesn't work on Windows [1]. I
wonder how to set up encoding when reading Shapefiles on Windows,
ENCODING options is new in GDAL 2.0?

Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From jamessramm at gmail.com  Mon Jun  8 04:07:53 2015
From: jamessramm at gmail.com (jramm)
Date: Mon, 8 Jun 2015 04:07:53 -0700 (PDT)
Subject: [gdal-dev] GDAL/OGR C API, how should I be dealing with 'handles'
Message-ID: <1433761673032-5209726.post@n6.nabble.com>

Many C API functions return a typedef which is referred to as a handle. E.g.

OGRFeatureHOGRLayerHOGRGeometryH
These seem to occur when the C++ api returns a pointer.I have 3 questions:
Why doesnt the C API return pointers? 
How should I pass these 'handles' around. Should I create pointers to them?
Do I need to free them?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-OGR-C-API-how-should-I-be-dealing-with-handles-tp5209726.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/5de0bcf4/attachment.html>

From mateusz at loskot.net  Mon Jun  8 04:25:03 2015
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 8 Jun 2015 13:25:03 +0200
Subject: [gdal-dev] GDAL/OGR C API,
	how should I be dealing with 'handles'
In-Reply-To: <1433761673032-5209726.post@n6.nabble.com>
References: <1433761673032-5209726.post@n6.nabble.com>
Message-ID: <CABUeae_q3CvjN_nXf5HKkcf16XUHZUiZ2jAQ4hCgGiP+g9JKkg@mail.gmail.com>

On 8 June 2015 at 13:07, jramm <jamessramm at gmail.com> wrote:
> Many C API functions return a typedef which is referred to as a handle. E.g.
>
>
> OGRFeatureH OGRLayerH OGRGeometryH
> These seem to occur when the C++ api returns a pointer. I have 3 questions:
>
> Why doesnt the C API return pointers?

H suffix denotes a handle.
Handles are defined as opaque pointer technique
(http://en.wikipedia.org/wiki/Opaque_pointer#C)
In fact, they are pointers.

> How should I pass these 'handles' around. Should I create pointers to them?

No, pass them around and treat them as C/C++ pointers.

> Do I need to free them?

If you mean free as calling C standard free() function, then no,
You should not invoke free with GDAL/OGR handle.

Typically, there is *Close* or *Destroy* function corresponding to particular
handle type, for example

GDALDatasetH h = GDALOpen(...);
...
GDALClose(h)

or

GDALColorTableH h = GDALCreateColorTable(...)
...
GDALDestroyColorTable(h)

You need to check C API reference.

Best regards,
-- 
Mateusz  Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Mon Jun  8 05:24:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 08 Jun 2015 14:24:36 +0200
Subject: [gdal-dev] shape_encoding and Windows
In-Reply-To: <CA+Ei1OfUGNeyQYDUextKZu+UQ0Q+1OAfHYN9XyKXzUr3z8ZzAg@mail.gmail.com>
References: <CA+Ei1OfUGNeyQYDUextKZu+UQ0Q+1OAfHYN9XyKXzUr3z8ZzAg@mail.gmail.com>
Message-ID: <1433766276.5575898471905@imp.free.fr>

Martin,

> it's seems to me that SHAPE_ENCODING doesn't work on Windows [1].

There's no [1] link in your email

> I
> wonder how to set up encoding when reading Shapefiles on Windows,
> ENCODING options is new in GDAL 2.0?

As an open option, yes. But with previous versions (and still with 2.0), you can
specify it as the configuration option SHAPE_ENCODING.

It should work on Windows. The extent of support may vary how GDAL has been
built however. If GDAL has been built with iconv support, then you should have
full support. Otherwise it will use the Windows recoding API which is limited to
convert from encoding names of the form "CPxxx"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From eronquillo at lanl.gov  Mon Jun  8 07:10:41 2015
From: eronquillo at lanl.gov (Ronquillo, Edgar Nahum)
Date: Mon, 8 Jun 2015 14:10:41 +0000
Subject: [gdal-dev] Is it possible?
Message-ID: <2086CE7E967C1B4F9D5897BE1C3C746F3119443F@ECS-EXG-P-MB01.win.lanl.gov>

Hello Gdal users,
I have a question. I have been working here for quite a while on how to map a shapefile into a GeoTiff image. First of all, is this possible with Gdal? Right now I am able to map a shapefile using Basemap, which it isn't Gdal of course. However, I would like to map this same shapefile into Geotiff file that I already have instead of doing it in a big Map like I am doing now. I have been looking around and can't find an example of this being done. If this is not possible with Gdal, do any of you know any available libraries that would do this for me? probably with some examples?

Any help would be greatly appreciated.

Thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/0bdd6e36/attachment-0001.html>

From p.halls at york.ac.uk  Mon Jun  8 07:30:28 2015
From: p.halls at york.ac.uk (Peter Halls)
Date: Mon, 8 Jun 2015 15:30:28 +0100
Subject: [gdal-dev] Is it possible?
In-Reply-To: <2086CE7E967C1B4F9D5897BE1C3C746F3119443F@ECS-EXG-P-MB01.win.lanl.gov>
References: <2086CE7E967C1B4F9D5897BE1C3C746F3119443F@ECS-EXG-P-MB01.win.lanl.gov>
Message-ID: <CADEnnONYY4PLqwRpWqOGVdgV9uXehKV9RGxCBv6=RBqoNNatzg@mail.gmail.com>

Why would you want to map a Shapefile into a Geotiff file?  They are
two fundamentally different types of spatial object.  Shapefiles are
exclusively vector in nature, whilst Geotiffs are exclusively raster.
I suggest reading a text, such as Burrough and McDonnell, Principles
of Geographical Information Systems, published by Oxford University
Press, gaining an understanding of the different properties and how to
exploit them.  Then you will be able to choose a data format
appropriate to your purposes.

Peter.

On 8 June 2015 at 15:10, Ronquillo, Edgar Nahum <eronquillo at lanl.gov> wrote:
> Hello Gdal users,
> I have a question. I have been working here for quite a while on how to map
> a shapefile into a GeoTiff image. First of all, is this possible with Gdal?
> Right now I am able to map a shapefile using Basemap, which it isn't Gdal of
> course. However, I would like to map this same shapefile into Geotiff file
> that I already have instead of doing it in a big Map like I am doing now. I
> have been looking around and can't find an example of this being done. If
> this is not possible with Gdal, do any of you know any available libraries
> that would do this for me? probably with some examples?
>
> Any help would be greatly appreciated.
>
> Thank you
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
                     Department of Politics, University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------

From aperi2007 at gmail.com  Mon Jun  8 07:31:05 2015
From: aperi2007 at gmail.com (Andrea Peri)
Date: Mon, 8 Jun 2015 16:31:05 +0200
Subject: [gdal-dev] Writing/reading a tiff with 8 bands
Message-ID: <CABqTJk9_04cRdXEMnoo2PeAxnSyrsihyCqqxEm-CoUY_wxSXmw@mail.gmail.com>

Hi,
I need to pass from some tiff (landsat LC8) all with 1 only band, to
one tiff with 8th bands.

Is this possible with gdal ?

AFAIK the TIFF allow to hos a image with 8 bands, but I'm not sure
that gdal is capable to wite/red this kind of image.

Thx,

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From even.rouault at spatialys.com  Mon Jun  8 07:37:45 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 08 Jun 2015 16:37:45 +0200
Subject: [gdal-dev] Writing/reading a tiff with 8 bands
In-Reply-To: <CABqTJk9_04cRdXEMnoo2PeAxnSyrsihyCqqxEm-CoUY_wxSXmw@mail.gmail.com>
References: <CABqTJk9_04cRdXEMnoo2PeAxnSyrsihyCqqxEm-CoUY_wxSXmw@mail.gmail.com>
Message-ID: <1433774265.5575a8b96041c@imp.free.fr>

Selon Andrea Peri <aperi2007 at gmail.com>:

> Hi,
> I need to pass from some tiff (landsat LC8) all with 1 only band, to
> one tiff with 8th bands.
>
> Is this possible with gdal ?

Sure. One possibility is to create a VRT file assembling the 8 bands. For
example with gdalbuildvrt with the -separate option. And then use gdal_translate
to convert it into GeoTIFF

>
> AFAIK the TIFF allow to hos a image with 8 bands, but I'm not sure
> that gdal is capable to wite/red this kind of image.
>
> Thx,
>
> --
> -----------------
> Andrea Peri
> . . . . . . . . .
> qwerty ??????????
> -----------------
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From david.m.baker at chk.com  Mon Jun  8 07:59:45 2015
From: david.m.baker at chk.com (David Baker (Geoscience))
Date: Mon, 8 Jun 2015 14:59:45 +0000
Subject: [gdal-dev] Is it possible?
In-Reply-To: <CADEnnONYY4PLqwRpWqOGVdgV9uXehKV9RGxCBv6=RBqoNNatzg@mail.gmail.com>
References: <2086CE7E967C1B4F9D5897BE1C3C746F3119443F@ECS-EXG-P-MB01.win.lanl.gov>
	<CADEnnONYY4PLqwRpWqOGVdgV9uXehKV9RGxCBv6=RBqoNNatzg@mail.gmail.com>
Message-ID: <2A18A4344312134B937DF938D992264A06F24CFD@OKCEXHPRD122.chkenergy.net>

Peter,

I can think of a few reasons, one for example, I have a geologic map that has only USGS quads for position reference.  I also have a shapefile that has county outlines and another that has the PLSS land survey townships and section lines.  I need a GeoTiff because one of the applications I use only will read a GeoTiff, so I want to "burn" the vector shapefile data into my raster GeoTiff image, so I can find the location of the outcrop I mapped, relative to section and township I was mapping in.

David

David M. Baker
Senior Geological Advisor
Chesapeake Energy Corporation
405-935-3715 office
405-496-5373 cell
david.m.baker at chk.com

-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Peter Halls
Sent: Monday, June 08, 2015 9:30 AM
To: Ronquillo, Edgar Nahum; gdal dev
Subject: Re: [gdal-dev] Is it possible?

Why would you want to map a Shapefile into a Geotiff file?  They are
two fundamentally different types of spatial object.  Shapefiles are
exclusively vector in nature, whilst Geotiffs are exclusively raster.
I suggest reading a text, such as Burrough and McDonnell, Principles
of Geographical Information Systems, published by Oxford University
Press, gaining an understanding of the different properties and how to
exploit them.  Then you will be able to choose a data format
appropriate to your purposes.

Peter.

On 8 June 2015 at 15:10, Ronquillo, Edgar Nahum <eronquillo at lanl.gov> wrote:
> Hello Gdal users,
> I have a question. I have been working here for quite a while on how to map
> a shapefile into a GeoTiff image. First of all, is this possible with Gdal?
> Right now I am able to map a shapefile using Basemap, which it isn't Gdal of
> course. However, I would like to map this same shapefile into Geotiff file
> that I already have instead of doing it in a big Map like I am doing now. I
> have been looking around and can't find an example of this being done. If
> this is not possible with Gdal, do any of you know any available libraries
> that would do this for me? probably with some examples?
>
> Any help would be greatly appreciated.
>
> Thank you
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
                     Department of Politics, University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

________________________________

This email (and attachments if any) is intended only for the use of the individual or entity to which it is addressed, and may contain information that is confidential or privileged and exempt from disclosure under applicable law. If the reader of this email is not the intended recipient, or the employee or agent responsible for delivering this message to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. If you have received this communication in error, please notify the sender immediately by return email and destroy all copies of the email (and attachments if any).

From lucena_ivan at hotmail.com  Mon Jun  8 09:15:03 2015
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 8 Jun 2015 12:15:03 -0400
Subject: [gdal-dev] Is it possible?
In-Reply-To: <2A18A4344312134B937DF938D992264A06F24CFD@OKCEXHPRD122.chkenergy.net>
References: <2086CE7E967C1B4F9D5897BE1C3C746F3119443F@ECS-EXG-P-MB01.win.lanl.gov>,
	<CADEnnONYY4PLqwRpWqOGVdgV9uXehKV9RGxCBv6=RBqoNNatzg@mail.gmail.com>,
	<2A18A4344312134B937DF938D992264A06F24CFD@OKCEXHPRD122.chkenergy.net>
Message-ID: <BLU173-W15129289E3E844A8D2DFE290BF0@phx.gbl>


Check gdal_rasterize [http://www.gdal.org/gdal_rasterize.html].


> From: david.m.baker at chk.com
> To: p.halls at york.ac.uk; eronquillo at lanl.gov; gdal-dev at lists.osgeo.org
> Date: Mon, 8 Jun 2015 14:59:45 +0000
> Subject: Re: [gdal-dev] Is it possible?
> 
> Peter,
> 
> I can think of a few reasons, one for example, I have a geologic map that has only USGS quads for position reference.  I also have a shapefile that has county outlines and another that has the PLSS land survey townships and section lines.  I need a GeoTiff because one of the applications I use only will read a GeoTiff, so I want to "burn" the vector shapefile data into my raster GeoTiff image, so I can find the location of the outcrop I mapped, relative to section and township I was mapping in.
> 
> David
> 
> David M. Baker
> Senior Geological Advisor
> Chesapeake Energy Corporation
> 405-935-3715 office
> 405-496-5373 cell
> david.m.baker at chk.com
> 
> -----Original Message-----
> From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Peter Halls
> Sent: Monday, June 08, 2015 9:30 AM
> To: Ronquillo, Edgar Nahum; gdal dev
> Subject: Re: [gdal-dev] Is it possible?
> 
> Why would you want to map a Shapefile into a Geotiff file?  They are
> two fundamentally different types of spatial object.  Shapefiles are
> exclusively vector in nature, whilst Geotiffs are exclusively raster.
> I suggest reading a text, such as Burrough and McDonnell, Principles
> of Geographical Information Systems, published by Oxford University
> Press, gaining an understanding of the different properties and how to
> exploit them.  Then you will be able to choose a data format
> appropriate to your purposes.
> 
> Peter.
> 
> On 8 June 2015 at 15:10, Ronquillo, Edgar Nahum <eronquillo at lanl.gov> wrote:
> > Hello Gdal users,
> > I have a question. I have been working here for quite a while on how to map
> > a shapefile into a GeoTiff image. First of all, is this possible with Gdal?
> > Right now I am able to map a shapefile using Basemap, which it isn't Gdal of
> > course. However, I would like to map this same shapefile into Geotiff file
> > that I already have instead of doing it in a big Map like I am doing now. I
> > have been looking around and can't find an example of this being done. If
> > this is not possible with Gdal, do any of you know any available libraries
> > that would do this for me? probably with some examples?
> >
> > Any help would be greatly appreciated.
> >
> > Thank you
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> --
> ----------------------------------------------------------------------------------------------------------------
> Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit (PRDU)
>                      Department of Politics, University of York
> 
> Snail mail: PRDU, Derwent College, University of York,
>                 Heslington, York YO10 5DD
> This message has the status of a private and personal communication
> ----------------------------------------------------------------------------------------------------------------
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> ________________________________
> 
> This email (and attachments if any) is intended only for the use of the individual or entity to which it is addressed, and may contain information that is confidential or privileged and exempt from disclosure under applicable law. If the reader of this email is not the intended recipient, or the employee or agent responsible for delivering this message to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. If you have received this communication in error, please notify the sender immediately by return email and destroy all copies of the email (and attachments if any).
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/f7c3bf09/attachment.html>

From james.c.tilton at nasa.gov  Mon Jun  8 09:11:06 2015
From: james.c.tilton at nasa.gov (Tilton, James C. (GSFC-6063))
Date: Mon, 8 Jun 2015 16:11:06 +0000
Subject: [gdal-dev] Querying Geographic Coordinate System from an existing
	image file.
Message-ID: <08985B5E1F05CB4799348219BE2A5C461F6C22@NDMSMBX404.ndc.nasa.gov>

I seem to be missing some key point in understanding the use of OGR Projections.

The OGR Projections Tutorial (www.gdal.org/osr_tutorial.html<http://www.gdal.org/osr_tutorial.html>) very clearly describes how to set up a new OGRSpatialReference,
but does not tell how to determine and query the OGRSpatialReference from an existing image data set (e.g. and GeoTiff image).

Could someone please point me to examples/instructions on how to do this?

Thanks.

Jim Tilton
________________________________
Dr. James C. Tilton                                               Voice:   301-286-9510
NASA Goddard Space Flight Center                   FAX:     301-286-1776
Mail Code 606.3                                                    E-Mail:  James.C.Tilton at nasa.gov<mailto:James.C.Tilton at nasa.gov>
(Computational & Information Sciences and Technology Office)
Greenbelt, MD 20771
URLs: http://science.gsfc.nasa.gov/sed/index.cfm?fuseAction=home.main&&navOrgCode=606
and . http://geography.wr.usgs.gov/science/croplands/index.html

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/048284e2/attachment-0001.html>

From kyle at pobox.com  Mon Jun  8 09:58:02 2015
From: kyle at pobox.com (Kyle Shannon)
Date: Mon, 8 Jun 2015 10:58:02 -0600
Subject: [gdal-dev] Querying Geographic Coordinate System from an
 existing image file.
In-Reply-To: <08985B5E1F05CB4799348219BE2A5C461F6C22@NDMSMBX404.ndc.nasa.gov>
References: <08985B5E1F05CB4799348219BE2A5C461F6C22@NDMSMBX404.ndc.nasa.gov>
Message-ID: <CAJ0mEz2wCwg8=Sv0yjo1=9t5STsbO88yQ0EfarTQzib-injAUw@mail.gmail.com>

Jim,

On Mon, Jun 8, 2015 at 10:11 AM, Tilton, James C. (GSFC-6063)
<james.c.tilton at nasa.gov> wrote:
> I seem to be missing some key point in understanding the use of OGR
> Projections.
>
>
>
> The OGR Projections Tutorial (www.gdal.org/osr_tutorial.html) very clearly
> describes how to set up a new OGRSpatialReference,
>
> but does not tell how to determine and query the OGRSpatialReference from an
> existing image data set (e.g. and GeoTiff image).
>
>
>
> Could someone please point me to examples/instructions on how to do this?

See gdalsrsinfo:

http://www.gdal.org/gdalsrsinfo.html

and the source:

https://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdalsrsinfo.cpp

For a geotiff, it'd be something like:

GDALDatasetH hDS = GDALOpen("mytiff.tif", GA_ReadOnly);
const char *pszWkt = GDALGetProjectionRef(hDS);
OGRSpatialReferenceH hSRS;
hSRS = OSRNewSpatialReference(pszWkt);

using the C API (and not doing error checking, obviously).

>
>
>
> Thanks.
>
>
>
> Jim Tilton
>
> ________________________________
>
> Dr. James C. Tilton                                               Voice:
> 301-286-9510
>
> NASA Goddard Space Flight Center                   FAX:     301-286-1776
>
> Mail Code 606.3                                                    E-Mail:
> James.C.Tilton at nasa.gov
>
> (Computational & Information Sciences and Technology Office)
>
> Greenbelt, MD 20771
>
> URLs:
> http://science.gsfc.nasa.gov/sed/index.cfm?fuseAction=home.main&&navOrgCode=606
>
> and . http://geography.wr.usgs.gov/science/croplands/index.html
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From doug_newcomb at fws.gov  Mon Jun  8 12:01:49 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Mon, 8 Jun 2015 15:01:49 -0400
Subject: [gdal-dev] assigning vertical datum to image files
Message-ID: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>

Hi Folks,
I have a directory of 783 .img format Lidar - based  DEMs in the same
projection, North Carolina State Plane  Feet (2011) , NAD 83 , NVD88.  I
was going to use gdalbuildvrt to create a single virtual image for the
area, but gdalbuildvrt complained, informing me that they were not in the
same projection.

A couple of quick bash scripts/commands

for x in *.img; do gdalinfo $x >>img_info.txt;done

and
grep PROJCS img_info.txt|sort|uniq -c

gives me the following:

    437 PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
    346 PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",

gdalinfo gives the following for each type of file ( origin section clipped
out) :

Driver: HFA/Erdas Imagine Images (.img)
Files: D05_37_20878102_20141231.img
       D05_37_20878102_20141231.img.aux.xml
Size is 1000, 1000
Coordinate System is:
PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
    GEOGCS["GCS_NAD_1983_2011",
        DATUM["NAD_1983_2011",
            SPHEROID["GRS_1980",6378137.0,298.257222101]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["False_Easting",2000000.0],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",-79.0],
    PARAMETER["Standard_Parallel_1",34.3333333333333],
    PARAMETER["Standard_Parallel_2",36.1666666666667],
    PARAMETER["Latitude_Of_Origin",33.75],
    UNIT["Foot_US",0.30480060960121924],
    VERTCS["NAVD_1988_Foot_US",
        VDATUM["North_American_Vertical_Datum_1988"],
        PARAMETER["Vertical_Shift",0.0],
        PARAMETER["Direction",1.0],
        UNIT["Foot_US",0.3048006096012192]]]


Driver: HFA/Erdas Imagine Images (.img)
Files: D05_37_20957301_20141231.img
       D05_37_20957301_20141231.img.aux.xml
Size is 1000, 1000
Coordinate System is:
PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
    GEOGCS["GCS_NAD_1983_2011",
        DATUM["NAD_1983_2011",
            SPHEROID["GRS_1980",6378137.0,298.257222101]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["False_Easting",2000000.002616666],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",-79.0],
    PARAMETER["Standard_Parallel_1",34.33333333333334],
    PARAMETER["Standard_Parallel_2",36.16666666666666],
    PARAMETER["Latitude_Of_Origin",33.75],
    UNIT["Foot_US",0.30480060960121924],
    VERTCS["NAVD_1988_Foot_US",
        VDATUM["North_American_Vertical_Datum_1988"],
        PARAMETER["Vertical_Shift",0.0],
        PARAMETER["Direction",1.0],
        UNIT["Foot_US",0.3048006096012192]]]



In theory, these should all be EPSG:6543, so just assigning the correct
 horizontal projection/datum with the epsg code should make things usable.
(i.e,
gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff -co
COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for the
EPSG:6543 projection support in GDAL 2.0!)

However, this only assigns the horizontal infomation, how does one assign a
vertical datum with a horizontal EPSG code?

I see the NVD88 code in vertcs.csv , but how would I implement it in the
above command?

Using gdal 2.0 Beta2


Doug
-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/106dc945/attachment.html>

From lukepinnerau at gmail.com  Mon Jun  8 13:11:10 2015
From: lukepinnerau at gmail.com (Luke Pinner)
Date: Tue, 9 Jun 2015 06:11:10 +1000
Subject: [gdal-dev] ImportError: numpy.core.multiarray failed to import
In-Reply-To: <2086CE7E967C1B4F9D5897BE1C3C746F3119442A@ECS-EXG-P-MB01.win.lanl.gov>
References: <2086CE7E967C1B4F9D5897BE1C3C746F311942CB@ECS-EXG-P-MB01.win.lanl.gov>
	<1433551332845-5209498.post@n6.nabble.com>
	<2086CE7E967C1B4F9D5897BE1C3C746F3119442A@ECS-EXG-P-MB01.win.lanl.gov>
Message-ID: <CAE8LFTwNk-vvF0v8LYihSzT7OUMP858qM6xhTxsZC2y7V933Rw@mail.gmail.com>

On 8 Jun 2015 11:11 pm, "Ronquillo, Edgar Nahum" <eronquillo at lanl.gov>
wrote:
>
> I just noticed I have numpy 1.6. However, I installed the binaries and
bindings from Tamas' GIS internals site. Would I need numpy 1.7 or higher
in this case?

If you're running 32bit python,  yes,  get numpy 1.7.2 from the numpy
sourceforge site.  If using 64bit python,  you might find it easier to
install numpy 1.9 and gdal from Christoph Gohlke's page as numpy don't
produce 64bit builds.

Luke
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/2d5c3772/attachment.html>

From eronquillo at lanl.gov  Mon Jun  8 13:27:41 2015
From: eronquillo at lanl.gov (Ronquillo, Edgar Nahum)
Date: Mon, 8 Jun 2015 20:27:41 +0000
Subject: [gdal-dev] Ascii Grid and Shapefile
Message-ID: <2086CE7E967C1B4F9D5897BE1C3C746F311944DF@ECS-EXG-P-MB01.win.lanl.gov>

Hello,
I already asked a similar question but I will be more exact on what I am looking for. Is it possible with Gdal to read ascii grid file (.asc)? If yes, I would like to read this ascii grid file and produce and display a map out this. Moreover, after having this map I would like to put a shapefile (or many shapefiles) on top of it and also display it. Is this something that can be done with Gdal? I've been looking around and can't seem to find the right answer. Please help.

Thank You
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/a2ac409a/attachment.html>

From david.fawcett at gmail.com  Mon Jun  8 13:57:12 2015
From: david.fawcett at gmail.com (David Fawcett)
Date: Mon, 8 Jun 2015 15:57:12 -0500
Subject: [gdal-dev] Ascii Grid and Shapefile
In-Reply-To: <2086CE7E967C1B4F9D5897BE1C3C746F311944DF@ECS-EXG-P-MB01.win.lanl.gov>
References: <2086CE7E967C1B4F9D5897BE1C3C746F311944DF@ECS-EXG-P-MB01.win.lanl.gov>
Message-ID: <CAF7K3b8hv8NPPnAWJ+4P+UpeA1dtjirVGWemWrkbzP=bn5tYhA@mail.gmail.com>

Edgar,

GDAL can read (and write) ArcInfo ASCII grids.  You can find more info
here:  http://www.gdal.org/frmt_various.html#AAIGrid

The case that you are describing is not a great fit for GDAL alone.  If you
want to overlay your grid and other vector datasets in a desktop
application, you might want to look at QGIS http://www.qgis.org/en/site/

If you are more interested in styling the data and serving maps over the
Web, you may want to look at MapServer.  http://mapserver.org/

David.

On Mon, Jun 8, 2015 at 3:27 PM, Ronquillo, Edgar Nahum <eronquillo at lanl.gov>
wrote:

>  Hello,
> I already asked a similar question but I will be more exact on what I am
> looking for. Is it possible with Gdal to read ascii grid file (.asc)? If
> yes, I would like to read this ascii grid file and produce and display a
> map out this. Moreover, after having this map I would like to put a
> shapefile (or many shapefiles) on top of it and also display it. Is this
> something that can be done with Gdal? I've been looking around and can't
> seem to find the right answer. Please help.
>
> Thank You
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150608/be25b27c/attachment.html>

From peifer at gmx.eu  Mon Jun  8 22:48:14 2015
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue, 09 Jun 2015 07:48:14 +0200
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
Message-ID: <55767E1E.6030009@gmx.eu>


About your initial problem:
 > but gdalbuildvrt complained, informing me that
 > they were not in the same projection.

What about using the below gdalbuildvrt option?

Hermann

-allow_projection_difference:
(starting with GDAL 1.7.0) When this option is specified, the utility 
will accept to make a VRT even if the input datasets have not the same 
projection. Note: this does not mean that they will be reprojected. 
Their projection will just be ignored.

Source: http://www.gdal.org/gdalbuildvrt.html


On 2015-06-08 21:01, Newcomb, Doug wrote:
> Hi Folks,
> I have a directory of 783 .img format Lidar - based  DEMs in the same
> projection, North Carolina State Plane  Feet (2011) , NAD 83 , NVD88.  I
> was going to use gdalbuildvrt to create a single virtual image for the
> area, but gdalbuildvrt complained, informing me that they were not in
> the same projection.
>
> A couple of quick bash scripts/commands
>
> for x in *.img; do gdalinfo $x >>img_info.txt;done
>
> and
> grep PROJCS img_info.txt|sort|uniq -c
>
> gives me the following:
>
>      437 PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>      346 PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>
> gdalinfo gives the following for each type of file ( origin section
> clipped out) :
>
> Driver: HFA/Erdas Imagine Images (.img)
> Files: D05_37_20878102_20141231.img
>         D05_37_20878102_20141231.img.aux.xml
> Size is 1000, 1000
> Coordinate System is:
> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>      GEOGCS["GCS_NAD_1983_2011",
>          DATUM["NAD_1983_2011",
>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>          PRIMEM["Greenwich",0.0],
>          UNIT["Degree",0.017453292519943295]],
>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>      PARAMETER["False_Easting",2000000.0],
>      PARAMETER["False_Northing",0.0],
>      PARAMETER["Central_Meridian",-79.0],
>      PARAMETER["Standard_Parallel_1",34.3333333333333],
>      PARAMETER["Standard_Parallel_2",36.1666666666667],
>      PARAMETER["Latitude_Of_Origin",33.75],
>      UNIT["Foot_US",0.30480060960121924],
>      VERTCS["NAVD_1988_Foot_US",
>          VDATUM["North_American_Vertical_Datum_1988"],
>          PARAMETER["Vertical_Shift",0.0],
>          PARAMETER["Direction",1.0],
>          UNIT["Foot_US",0.3048006096012192]]]
>
>
> Driver: HFA/Erdas Imagine Images (.img)
> Files: D05_37_20957301_20141231.img
>         D05_37_20957301_20141231.img.aux.xml
> Size is 1000, 1000
> Coordinate System is:
> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>      GEOGCS["GCS_NAD_1983_2011",
>          DATUM["NAD_1983_2011",
>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>          PRIMEM["Greenwich",0.0],
>          UNIT["Degree",0.0174532925199433]],
>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>      PARAMETER["False_Easting",2000000.002616666],
>      PARAMETER["False_Northing",0.0],
>      PARAMETER["Central_Meridian",-79.0],
>      PARAMETER["Standard_Parallel_1",34.33333333333334],
>      PARAMETER["Standard_Parallel_2",36.16666666666666],
>      PARAMETER["Latitude_Of_Origin",33.75],
>      UNIT["Foot_US",0.30480060960121924],
>      VERTCS["NAVD_1988_Foot_US",
>          VDATUM["North_American_Vertical_Datum_1988"],
>          PARAMETER["Vertical_Shift",0.0],
>          PARAMETER["Direction",1.0],
>          UNIT["Foot_US",0.3048006096012192]]]
>
>
>
> In theory, these should all be EPSG:6543, so just assigning the correct
>   horizontal projection/datum with the epsg code should make things
> usable. (i.e,
> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff
> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for
> the EPSG:6543 projection support in GDAL 2.0!)
>
> However, this only assigns the horizontal infomation, how does one
> assign a vertical datum with a horizontal EPSG code?
>
> I see the NVD88 code in vertcs.csv , but how would I implement it in the
> above command?
>
> Using gdal 2.0 Beta2
>
>
> Doug
> --
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:doug_newcomb at fws.gov>
> ---------------------------------------------------------------------------------------------------------
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> Interior.   Life is too short for undocumented, proprietary data formats.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From grb at skogoglandskap.no  Tue Jun  9 01:26:50 2015
From: grb at skogoglandskap.no (Graeme B. Bell)
Date: Tue, 9 Jun 2015 08:26:50 +0000
Subject: [gdal-dev] Is it possible?
Message-ID: <4B968898-ECE2-4380-8434-4C2946B855B9@skogoglandskap.no>


Peter,

I think you are misunderstanding the question. You are interpreting the verb 'to map into a geotiff' to mean 'directly insert the original data structure into a incompatible data structure', which is an peculiarly narrow definition even in GIS. 

When he says 'to map' he probably meant either the common english & mathematical sense of the verb "to map A into B" (i.e. to transform), or perhaps the practical GIS sense of 'to go about  interpreting map A as it relates to map B'.


Edgar,

To transform, you can use gdal_rasterize (http://www.gdal.org/gdal_rasterize.html), or for extremely large shapefiles or DBs you can use rbuild (https://github.com/gbb/rbuild) which is a parallelising wrapper for gdal_rasterize.

Whereas if you are wondering how to relate data in a geotiff to data alongside a shapefile in a practical sense, well, there are several options.

1. gdal_rasterize the shapefile, then use e.g. gdal_calc.py to combine the resulting geotiff with your other geotiff.  (gdal_calc is a great little tool!)

2. Consider moving your data into e.g. postgis and postgis raster. Then you can do things like perform intersections and other calculations using both the raster data and the geometry directly. 

Hope this helps, also it's not a bad idea to read Peter's suggested book if you're new to GIS anyway.

Graeme Bell



> Message: 1
> Date: Mon, 8 Jun 2015 15:30:28 +0100
> From: Peter Halls <p.halls at york.ac.uk>
> To: "Ronquillo, Edgar Nahum" <eronquillo at lanl.gov>,	gdal dev
> 	<gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Is it possible?
> Message-ID:
> 	<CADEnnONYY4PLqwRpWqOGVdgV9uXehKV9RGxCBv6=RBqoNNatzg at mail.gmail.com>
> Content-Type: text/plain; charset=UTF-8
> 
> Why would you want to map a Shapefile into a Geotiff file?  They are
> two fundamentally different types of spatial object.  Shapefiles are
> exclusively vector in nature, whilst Geotiffs are exclusively raster.
> I suggest reading a text, such as Burrough and McDonnell, Principles
> of Geographical Information Systems, published by Oxford University
> Press, gaining an understanding of the different properties and how to
> exploit them.  Then you will be able to choose a data format
> appropriate to your purposes.
> 
> Peter.

From thomas at silentwings.no  Tue Jun  9 03:48:08 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Tue, 9 Jun 2015 12:48:08 +0200
Subject: [gdal-dev]  GDALWarp API and paletted images
Message-ID: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>

Hi,

I'm using the GDALWarp api from C++ to reproject and cut various input
images. In general this works very well for my purposes, except that for
paletted images I have to use NearestNeighbour resampling,

I would like to use Bilinear or higher order resampling, and wonder if
there is any way to expand a paletted image to true RGB during the warp
process, so I can use these resampling methods.

Alternatively, is there a way to do this conversion (from code) before the
warp without having to run through the entire image in memory?

- Thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/677d19ab/attachment.html>

From even.rouault at spatialys.com  Tue Jun  9 04:44:19 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 09 Jun 2015 13:44:19 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
Message-ID: <1433850259.5576d193184a8@imp.free.fr>

Thomas,
>
> I'm using the GDALWarp api from C++ to reproject and cut various input
> images. In general this works very well for my purposes, except that for
> paletted images I have to use NearestNeighbour resampling,
>
> I would like to use Bilinear or higher order resampling, and wonder if
> there is any way to expand a paletted image to true RGB during the warp
> process, so I can use these resampling methods.

No, you must use an intermediate step before.

>
> Alternatively, is there a way to do this conversion (from code) before the
> warp without having to run through the entire image in memory?

You can use a in-memory VRT dataset to do on-the-fly expansion to RGB.

With the AddComplexSource() method of VRTSourcedRasterBand class:

    CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
                                     int nSrcXOff=-1, int nSrcYOff=-1,
                                     int nSrcXSize=-1, int nSrcYSize=-1,
                                     int nDstXOff=-1, int nDstYOff=-1,
                                     int nDstXSize=-1, int nDstYSize=-1,
                                     double dfScaleOff=0.0,
                                     double dfScaleRatio=1.0,
                                     double dfNoDataValue = VRT_NODATA_UNSET,
                                     int nColorTableComponent = 0);

Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is what
gdal_translate will do if you use "gdal_translate -of VRT -expand rgb pct.tif
out.vrt"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From doug_newcomb at fws.gov  Tue Jun  9 04:48:24 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Tue, 9 Jun 2015 07:48:24 -0400
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <55767E1E.6030009@gmx.eu>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
Message-ID: <CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>

Thanks!

That should work in this case to build the virtual raster.  I'm still
curious about assigning the vertical datum to the rasters.

Doug

On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:

>
> About your initial problem:
> > but gdalbuildvrt complained, informing me that
> > they were not in the same projection.
>
> What about using the below gdalbuildvrt option?
>
> Hermann
>
> -allow_projection_difference:
> (starting with GDAL 1.7.0) When this option is specified, the utility will
> accept to make a VRT even if the input datasets have not the same
> projection. Note: this does not mean that they will be reprojected. Their
> projection will just be ignored.
>
> Source: http://www.gdal.org/gdalbuildvrt.html
>
>
>
> On 2015-06-08 21:01, Newcomb, Doug wrote:
>
>> Hi Folks,
>> I have a directory of 783 .img format Lidar - based  DEMs in the same
>> projection, North Carolina State Plane  Feet (2011) , NAD 83 , NVD88.  I
>> was going to use gdalbuildvrt to create a single virtual image for the
>> area, but gdalbuildvrt complained, informing me that they were not in
>> the same projection.
>>
>> A couple of quick bash scripts/commands
>>
>> for x in *.img; do gdalinfo $x >>img_info.txt;done
>>
>> and
>> grep PROJCS img_info.txt|sort|uniq -c
>>
>> gives me the following:
>>
>>      437 PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>>      346 PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>>
>> gdalinfo gives the following for each type of file ( origin section
>> clipped out) :
>>
>> Driver: HFA/Erdas Imagine Images (.img)
>> Files: D05_37_20878102_20141231.img
>>         D05_37_20878102_20141231.img.aux.xml
>> Size is 1000, 1000
>> Coordinate System is:
>> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>>      GEOGCS["GCS_NAD_1983_2011",
>>          DATUM["NAD_1983_2011",
>>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>>          PRIMEM["Greenwich",0.0],
>>          UNIT["Degree",0.017453292519943295]],
>>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>>      PARAMETER["False_Easting",2000000.0],
>>      PARAMETER["False_Northing",0.0],
>>      PARAMETER["Central_Meridian",-79.0],
>>      PARAMETER["Standard_Parallel_1",34.3333333333333],
>>      PARAMETER["Standard_Parallel_2",36.1666666666667],
>>      PARAMETER["Latitude_Of_Origin",33.75],
>>      UNIT["Foot_US",0.30480060960121924],
>>      VERTCS["NAVD_1988_Foot_US",
>>          VDATUM["North_American_Vertical_Datum_1988"],
>>          PARAMETER["Vertical_Shift",0.0],
>>          PARAMETER["Direction",1.0],
>>          UNIT["Foot_US",0.3048006096012192]]]
>>
>>
>> Driver: HFA/Erdas Imagine Images (.img)
>> Files: D05_37_20957301_20141231.img
>>         D05_37_20957301_20141231.img.aux.xml
>> Size is 1000, 1000
>> Coordinate System is:
>> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>>      GEOGCS["GCS_NAD_1983_2011",
>>          DATUM["NAD_1983_2011",
>>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>>          PRIMEM["Greenwich",0.0],
>>          UNIT["Degree",0.0174532925199433]],
>>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>>      PARAMETER["False_Easting",2000000.002616666],
>>      PARAMETER["False_Northing",0.0],
>>      PARAMETER["Central_Meridian",-79.0],
>>      PARAMETER["Standard_Parallel_1",34.33333333333334],
>>      PARAMETER["Standard_Parallel_2",36.16666666666666],
>>      PARAMETER["Latitude_Of_Origin",33.75],
>>      UNIT["Foot_US",0.30480060960121924],
>>      VERTCS["NAVD_1988_Foot_US",
>>          VDATUM["North_American_Vertical_Datum_1988"],
>>          PARAMETER["Vertical_Shift",0.0],
>>          PARAMETER["Direction",1.0],
>>          UNIT["Foot_US",0.3048006096012192]]]
>>
>>
>>
>> In theory, these should all be EPSG:6543, so just assigning the correct
>>   horizontal projection/datum with the epsg code should make things
>> usable. (i.e,
>> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff
>> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for
>> the EPSG:6543 projection support in GDAL 2.0!)
>>
>> However, this only assigns the horizontal infomation, how does one
>> assign a vertical datum with a horizontal EPSG code?
>>
>> I see the NVD88 code in vertcs.csv , but how would I implement it in the
>> above command?
>>
>> Using gdal 2.0 Beta2
>>
>>
>> Doug
>> --
>> Doug Newcomb
>> USFWS
>> Raleigh, NC
>> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:doug_newcomb at fws.gov>
>>
>> ---------------------------------------------------------------------------------------------------------
>> The opinions I express are my own and are not representative of the
>> official policy of the U.S.Fish and Wildlife Service or Dept. of the
>> Interior.   Life is too short for undocumented, proprietary data formats.
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>


-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/f45bb60d/attachment.html>

From even.rouault at spatialys.com  Tue Jun  9 06:32:47 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 09 Jun 2015 15:32:47 +0200
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
Message-ID: <1433856767.5576eaff4c2a2@imp.free.fr>

Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:

> Thanks!
>
> That should work in this case to build the virtual raster.  I'm still
> curious about assigning the vertical datum to the rasters.

Doug,

I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node as a
child of the PROJCS node. I believe this is an incorrect WKT definition. There
should rather be a COMPD_CS root note with 2 children: a PROJCS node for the
horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS string
is defined in the .aux.xml sidecar files that are apparently present ?

Regarding your question, there are a few EPSG codes that correspond to
aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom COMPD_CS
with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the horizontal SRS
and YYYY the EPSG code of the vertical SRS. In your case that should be
EPSG:6543+5703 I think

So you can do things like "gdal_translate in.tif out.tif -a_srs EPSG:6543+5703"

If you read back out.tif, you will only get the horizontal SRS by default. This
was for backward compatibility reason I think. But if you specify "--config
GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.

Even

>
> Doug
>
> On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
>
> >
> > About your initial problem:
> > > but gdalbuildvrt complained, informing me that
> > > they were not in the same projection.
> >
> > What about using the below gdalbuildvrt option?
> >
> > Hermann
> >
> > -allow_projection_difference:
> > (starting with GDAL 1.7.0) When this option is specified, the utility will
> > accept to make a VRT even if the input datasets have not the same
> > projection. Note: this does not mean that they will be reprojected. Their
> > projection will just be ignored.
> >
> > Source: http://www.gdal.org/gdalbuildvrt.html
> >
> >
> >
> > On 2015-06-08 21:01, Newcomb, Doug wrote:
> >
> >> Hi Folks,
> >> I have a directory of 783 .img format Lidar - based  DEMs in the same
> >> projection, North Carolina State Plane  Feet (2011) , NAD 83 , NVD88.  I
> >> was going to use gdalbuildvrt to create a single virtual image for the
> >> area, but gdalbuildvrt complained, informing me that they were not in
> >> the same projection.
> >>
> >> A couple of quick bash scripts/commands
> >>
> >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> >>
> >> and
> >> grep PROJCS img_info.txt|sort|uniq -c
> >>
> >> gives me the following:
> >>
> >>      437 PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >>      346 PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >>
> >> gdalinfo gives the following for each type of file ( origin section
> >> clipped out) :
> >>
> >> Driver: HFA/Erdas Imagine Images (.img)
> >> Files: D05_37_20878102_20141231.img
> >>         D05_37_20878102_20141231.img.aux.xml
> >> Size is 1000, 1000
> >> Coordinate System is:
> >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >>      GEOGCS["GCS_NAD_1983_2011",
> >>          DATUM["NAD_1983_2011",
> >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >>          PRIMEM["Greenwich",0.0],
> >>          UNIT["Degree",0.017453292519943295]],
> >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >>      PARAMETER["False_Easting",2000000.0],
> >>      PARAMETER["False_Northing",0.0],
> >>      PARAMETER["Central_Meridian",-79.0],
> >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> >>      PARAMETER["Latitude_Of_Origin",33.75],
> >>      UNIT["Foot_US",0.30480060960121924],
> >>      VERTCS["NAVD_1988_Foot_US",
> >>          VDATUM["North_American_Vertical_Datum_1988"],
> >>          PARAMETER["Vertical_Shift",0.0],
> >>          PARAMETER["Direction",1.0],
> >>          UNIT["Foot_US",0.3048006096012192]]]
> >>
> >>
> >> Driver: HFA/Erdas Imagine Images (.img)
> >> Files: D05_37_20957301_20141231.img
> >>         D05_37_20957301_20141231.img.aux.xml
> >> Size is 1000, 1000
> >> Coordinate System is:
> >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >>      GEOGCS["GCS_NAD_1983_2011",
> >>          DATUM["NAD_1983_2011",
> >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >>          PRIMEM["Greenwich",0.0],
> >>          UNIT["Degree",0.0174532925199433]],
> >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >>      PARAMETER["False_Easting",2000000.002616666],
> >>      PARAMETER["False_Northing",0.0],
> >>      PARAMETER["Central_Meridian",-79.0],
> >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> >>      PARAMETER["Latitude_Of_Origin",33.75],
> >>      UNIT["Foot_US",0.30480060960121924],
> >>      VERTCS["NAVD_1988_Foot_US",
> >>          VDATUM["North_American_Vertical_Datum_1988"],
> >>          PARAMETER["Vertical_Shift",0.0],
> >>          PARAMETER["Direction",1.0],
> >>          UNIT["Foot_US",0.3048006096012192]]]
> >>
> >>
> >>
> >> In theory, these should all be EPSG:6543, so just assigning the correct
> >>   horizontal projection/datum with the epsg code should make things
> >> usable. (i.e,
> >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff
> >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for
> >> the EPSG:6543 projection support in GDAL 2.0!)
> >>
> >> However, this only assigns the horizontal infomation, how does one
> >> assign a vertical datum with a horizontal EPSG code?
> >>
> >> I see the NVD88 code in vertcs.csv , but how would I implement it in the
> >> above command?
> >>
> >> Using gdal 2.0 Beta2
> >>
> >>
> >> Doug
> >> --
> >> Doug Newcomb
> >> USFWS
> >> Raleigh, NC
> >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:doug_newcomb at fws.gov>
> >>
> >>
>
---------------------------------------------------------------------------------------------------------
> >> The opinions I express are my own and are not representative of the
> >> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> >> Interior.   Life is too short for undocumented, proprietary data formats.
> >>
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >>
> >
>
>
> --
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb at fws.gov
>
---------------------------------------------------------------------------------------------------------
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> Interior.   Life is too short for undocumented, proprietary data formats.
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From doug_newcomb at fws.gov  Tue Jun  9 06:45:24 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Tue, 9 Jun 2015 09:45:24 -0400
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <1433856767.5576eaff4c2a2@imp.free.fr>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
	<1433856767.5576eaff4c2a2@imp.free.fr>
Message-ID: <CALQGVr0bf+6y+dSv3EYBcORPjHSiL40qDJPZ9WZMWh4Pa+5FvQ@mail.gmail.com>

Thanks Evan!

Doug

On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
>
> > Thanks!
> >
> > That should work in this case to build the virtual raster.  I'm still
> > curious about assigning the vertical datum to the rasters.
>
> Doug,
>
> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node
> as a
> child of the PROJCS node. I believe this is an incorrect WKT definition.
> There
> should rather be a COMPD_CS root note with 2 children: a PROJCS node for
> the
> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS
> string
> is defined in the .aux.xml sidecar files that are apparently present ?
>
> Regarding your question, there are a few EPSG codes that correspond to
> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
> COMPD_CS
> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
> horizontal SRS
> and YYYY the EPSG code of the vertical SRS. In your case that should be
> EPSG:6543+5703 I think
>
> So you can do things like "gdal_translate in.tif out.tif -a_srs
> EPSG:6543+5703"
>
> If you read back out.tif, you will only get the horizontal SRS by default.
> This
> was for backward compatibility reason I think. But if you specify "--config
> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
>
> Even
>
> >
> > Doug
> >
> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
> >
> > >
> > > About your initial problem:
> > > > but gdalbuildvrt complained, informing me that
> > > > they were not in the same projection.
> > >
> > > What about using the below gdalbuildvrt option?
> > >
> > > Hermann
> > >
> > > -allow_projection_difference:
> > > (starting with GDAL 1.7.0) When this option is specified, the utility
> will
> > > accept to make a VRT even if the input datasets have not the same
> > > projection. Note: this does not mean that they will be reprojected.
> Their
> > > projection will just be ignored.
> > >
> > > Source: http://www.gdal.org/gdalbuildvrt.html
> > >
> > >
> > >
> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
> > >
> > >> Hi Folks,
> > >> I have a directory of 783 .img format Lidar - based  DEMs in the same
> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
> NVD88.  I
> > >> was going to use gdalbuildvrt to create a single virtual image for the
> > >> area, but gdalbuildvrt complained, informing me that they were not in
> > >> the same projection.
> > >>
> > >> A couple of quick bash scripts/commands
> > >>
> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> > >>
> > >> and
> > >> grep PROJCS img_info.txt|sort|uniq -c
> > >>
> > >> gives me the following:
> > >>
> > >>      437
> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >>      346
> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >>
> > >> gdalinfo gives the following for each type of file ( origin section
> > >> clipped out) :
> > >>
> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> Files: D05_37_20878102_20141231.img
> > >>         D05_37_20878102_20141231.img.aux.xml
> > >> Size is 1000, 1000
> > >> Coordinate System is:
> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >>          DATUM["NAD_1983_2011",
> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >>          PRIMEM["Greenwich",0.0],
> > >>          UNIT["Degree",0.017453292519943295]],
> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >>      PARAMETER["False_Easting",2000000.0],
> > >>      PARAMETER["False_Northing",0.0],
> > >>      PARAMETER["Central_Meridian",-79.0],
> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >>      UNIT["Foot_US",0.30480060960121924],
> > >>      VERTCS["NAVD_1988_Foot_US",
> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >>          PARAMETER["Vertical_Shift",0.0],
> > >>          PARAMETER["Direction",1.0],
> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >>
> > >>
> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> Files: D05_37_20957301_20141231.img
> > >>         D05_37_20957301_20141231.img.aux.xml
> > >> Size is 1000, 1000
> > >> Coordinate System is:
> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >>          DATUM["NAD_1983_2011",
> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >>          PRIMEM["Greenwich",0.0],
> > >>          UNIT["Degree",0.0174532925199433]],
> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >>      PARAMETER["False_Easting",2000000.002616666],
> > >>      PARAMETER["False_Northing",0.0],
> > >>      PARAMETER["Central_Meridian",-79.0],
> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >>      UNIT["Foot_US",0.30480060960121924],
> > >>      VERTCS["NAVD_1988_Foot_US",
> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >>          PARAMETER["Vertical_Shift",0.0],
> > >>          PARAMETER["Direction",1.0],
> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >>
> > >>
> > >>
> > >> In theory, these should all be EPSG:6543, so just assigning the
> correct
> > >>   horizontal projection/datum with the epsg code should make things
> > >> usable. (i.e,
> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff
> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for
> > >> the EPSG:6543 projection support in GDAL 2.0!)
> > >>
> > >> However, this only assigns the horizontal infomation, how does one
> > >> assign a vertical datum with a horizontal EPSG code?
> > >>
> > >> I see the NVD88 code in vertcs.csv , but how would I implement it in
> the
> > >> above command?
> > >>
> > >> Using gdal 2.0 Beta2
> > >>
> > >>
> > >> Doug
> > >> --
> > >> Doug Newcomb
> > >> USFWS
> > >> Raleigh, NC
> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
> doug_newcomb at fws.gov>
> > >>
> > >>
> >
>
> ---------------------------------------------------------------------------------------------------------
> > >> The opinions I express are my own and are not representative of the
> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > >> Interior.   Life is too short for undocumented, proprietary data
> formats.
> > >>
> > >>
> > >> _______________________________________________
> > >> gdal-dev mailing list
> > >> gdal-dev at lists.osgeo.org
> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >>
> > >>
> > >
> >
> >
> > --
> > Doug Newcomb
> > USFWS
> > Raleigh, NC
> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >
>
> ---------------------------------------------------------------------------------------------------------
> > The opinions I express are my own and are not representative of the
> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > Interior.   Life is too short for undocumented, proprietary data formats.
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/9c0d06a8/attachment.html>

From doug_newcomb at fws.gov  Tue Jun  9 07:21:09 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Tue, 9 Jun 2015 10:21:09 -0400
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <1433856767.5576eaff4c2a2@imp.free.fr>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
	<1433856767.5576eaff4c2a2@imp.free.fr>
Message-ID: <CALQGVr2AqZt7y-=FEfOwJex1_A0tYcnnsKt6qAHdk+ggBq8-ag@mail.gmail.com>

Evan,
I went back and checked.  The .aux.xml sidecar files  with the img files do
not appear to have projection information.

Doug

On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
>
> > Thanks!
> >
> > That should work in this case to build the virtual raster.  I'm still
> > curious about assigning the vertical datum to the rasters.
>
> Doug,
>
> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node
> as a
> child of the PROJCS node. I believe this is an incorrect WKT definition.
> There
> should rather be a COMPD_CS root note with 2 children: a PROJCS node for
> the
> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS
> string
> is defined in the .aux.xml sidecar files that are apparently present ?
>
> Regarding your question, there are a few EPSG codes that correspond to
> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
> COMPD_CS
> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
> horizontal SRS
> and YYYY the EPSG code of the vertical SRS. In your case that should be
> EPSG:6543+5703 I think
>
> So you can do things like "gdal_translate in.tif out.tif -a_srs
> EPSG:6543+5703"
>
> If you read back out.tif, you will only get the horizontal SRS by default.
> This
> was for backward compatibility reason I think. But if you specify "--config
> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
>
> Even
>
> >
> > Doug
> >
> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
> >
> > >
> > > About your initial problem:
> > > > but gdalbuildvrt complained, informing me that
> > > > they were not in the same projection.
> > >
> > > What about using the below gdalbuildvrt option?
> > >
> > > Hermann
> > >
> > > -allow_projection_difference:
> > > (starting with GDAL 1.7.0) When this option is specified, the utility
> will
> > > accept to make a VRT even if the input datasets have not the same
> > > projection. Note: this does not mean that they will be reprojected.
> Their
> > > projection will just be ignored.
> > >
> > > Source: http://www.gdal.org/gdalbuildvrt.html
> > >
> > >
> > >
> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
> > >
> > >> Hi Folks,
> > >> I have a directory of 783 .img format Lidar - based  DEMs in the same
> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
> NVD88.  I
> > >> was going to use gdalbuildvrt to create a single virtual image for the
> > >> area, but gdalbuildvrt complained, informing me that they were not in
> > >> the same projection.
> > >>
> > >> A couple of quick bash scripts/commands
> > >>
> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> > >>
> > >> and
> > >> grep PROJCS img_info.txt|sort|uniq -c
> > >>
> > >> gives me the following:
> > >>
> > >>      437
> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >>      346
> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >>
> > >> gdalinfo gives the following for each type of file ( origin section
> > >> clipped out) :
> > >>
> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> Files: D05_37_20878102_20141231.img
> > >>         D05_37_20878102_20141231.img.aux.xml
> > >> Size is 1000, 1000
> > >> Coordinate System is:
> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >>          DATUM["NAD_1983_2011",
> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >>          PRIMEM["Greenwich",0.0],
> > >>          UNIT["Degree",0.017453292519943295]],
> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >>      PARAMETER["False_Easting",2000000.0],
> > >>      PARAMETER["False_Northing",0.0],
> > >>      PARAMETER["Central_Meridian",-79.0],
> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >>      UNIT["Foot_US",0.30480060960121924],
> > >>      VERTCS["NAVD_1988_Foot_US",
> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >>          PARAMETER["Vertical_Shift",0.0],
> > >>          PARAMETER["Direction",1.0],
> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >>
> > >>
> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> Files: D05_37_20957301_20141231.img
> > >>         D05_37_20957301_20141231.img.aux.xml
> > >> Size is 1000, 1000
> > >> Coordinate System is:
> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >>          DATUM["NAD_1983_2011",
> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >>          PRIMEM["Greenwich",0.0],
> > >>          UNIT["Degree",0.0174532925199433]],
> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >>      PARAMETER["False_Easting",2000000.002616666],
> > >>      PARAMETER["False_Northing",0.0],
> > >>      PARAMETER["Central_Meridian",-79.0],
> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >>      UNIT["Foot_US",0.30480060960121924],
> > >>      VERTCS["NAVD_1988_Foot_US",
> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >>          PARAMETER["Vertical_Shift",0.0],
> > >>          PARAMETER["Direction",1.0],
> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >>
> > >>
> > >>
> > >> In theory, these should all be EPSG:6543, so just assigning the
> correct
> > >>   horizontal projection/datum with the epsg code should make things
> > >> usable. (i.e,
> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of GTiff
> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you for
> > >> the EPSG:6543 projection support in GDAL 2.0!)
> > >>
> > >> However, this only assigns the horizontal infomation, how does one
> > >> assign a vertical datum with a horizontal EPSG code?
> > >>
> > >> I see the NVD88 code in vertcs.csv , but how would I implement it in
> the
> > >> above command?
> > >>
> > >> Using gdal 2.0 Beta2
> > >>
> > >>
> > >> Doug
> > >> --
> > >> Doug Newcomb
> > >> USFWS
> > >> Raleigh, NC
> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
> doug_newcomb at fws.gov>
> > >>
> > >>
> >
>
> ---------------------------------------------------------------------------------------------------------
> > >> The opinions I express are my own and are not representative of the
> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > >> Interior.   Life is too short for undocumented, proprietary data
> formats.
> > >>
> > >>
> > >> _______________________________________________
> > >> gdal-dev mailing list
> > >> gdal-dev at lists.osgeo.org
> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >>
> > >>
> > >
> >
> >
> > --
> > Doug Newcomb
> > USFWS
> > Raleigh, NC
> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >
>
> ---------------------------------------------------------------------------------------------------------
> > The opinions I express are my own and are not representative of the
> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > Interior.   Life is too short for undocumented, proprietary data formats.
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/285b5af5/attachment-0001.html>

From eronquillo at lanl.gov  Tue Jun  9 07:31:48 2015
From: eronquillo at lanl.gov (Ronquillo, Edgar Nahum)
Date: Tue, 9 Jun 2015 14:31:48 +0000
Subject: [gdal-dev] Overlay shapefile onto Geotiff image
Message-ID: <2086CE7E967C1B4F9D5897BE1C3C746F3119455B@ECS-EXG-P-MB01.win.lanl.gov>

Hi,
I have been working on this issue for quite a while. I currently have a GeoTiff image and a shapefile. I would like to overlay the shapefile on the Geotiff, is this possible with Gdal? I looked into gdal_rasterize but I just don't know how to incorporate it with what I need. A code to start with would be great if possible. Or maybe point me into the right direction of probably other libraries that could do this.

Thanks for the help
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/028f5e7e/attachment.html>

From doug_newcomb at fws.gov  Tue Jun  9 07:38:30 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Tue, 9 Jun 2015 10:38:30 -0400
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <CALQGVr2AqZt7y-=FEfOwJex1_A0tYcnnsKt6qAHdk+ggBq8-ag@mail.gmail.com>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
	<1433856767.5576eaff4c2a2@imp.free.fr>
	<CALQGVr2AqZt7y-=FEfOwJex1_A0tYcnnsKt6qAHdk+ggBq8-ag@mail.gmail.com>
Message-ID: <CALQGVr2pLpssKbeenSWsk4qULUs7t1WT9-G+ThQHXQ947-mTLA@mail.gmail.com>

Evan,
Here is the output from gdalinfo  wit the expanded config.
Note the error messages  on failure to load datum shift files for the
corner coordinates.
I'll upgrade to RC1 and check that again, but thought I would mention.

gdalinfo --config GTIFF_REPORT_COMPD_CS YES D05_37_30081003_20141231.tif

Driver: GTiff/GeoTIFF
Files: D05_37_30081003_20141231.tif
Size is 1000, 1000
Coordinate System is:
COMPD_CS["unknown",
    PROJCS["NAD83(2011) / North Carolina (ftUS)",
        GEOGCS["NAD83(2011)",
            DATUM["NAD83_National_Spatial_Reference_System_2011",
                SPHEROID["GRS 1980",6378137,298.257222101,
                    AUTHORITY["EPSG","7019"]],
                AUTHORITY["EPSG","1116"]],
            PRIMEM["Greenwich",0,
                AUTHORITY["EPSG","8901"]],
            UNIT["degree",0.0174532925199433,
                AUTHORITY["EPSG","9122"]],
            AUTHORITY["EPSG","6318"]],
        PROJECTION["Lambert_Conformal_Conic_2SP"],
        PARAMETER["standard_parallel_1",36.16666666666666],
        PARAMETER["standard_parallel_2",34.33333333333334],
        PARAMETER["latitude_of_origin",33.75],
        PARAMETER["central_meridian",-79],
        PARAMETER["false_easting",2000000],
        PARAMETER["false_northing",0],
        UNIT["US survey foot",0.3048006096012192,
            AUTHORITY["EPSG","9003"]],
        AXIS["X",EAST],
        AXIS["Y",NORTH],
        AUTHORITY["EPSG","6543"]],
    VERT_CS["NAVD88 height",
        VERT_DATUM["North American Vertical Datum 1988",2005,

EXTENSION["PROJ4_GRIDS","g2012a_conus.gtx,g2012a_alaska.gtx,g2012a_guam.gtx,g2012a_hawaii.gtx,g2012a_puertorico.gtx,g2012a_samoa.gtx"],
            AUTHORITY["EPSG","5103"]],
        UNIT["metre",1,
            AUTHORITY["EPSG","9001"]],
        AXIS["Up",UP],
        AUTHORITY["EPSG","5703"]]]
Origin = (3010000.000000000000000,805000.000000000000000)
Pixel Size = (5.000000000000000,-5.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  DataType=Generic
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
ERROR 1: failed to load datum shift file
Upper Left  ( 3010000.000,  805000.000)
ERROR 1: failed to load datum shift file
Lower Left  ( 3010000.000,  800000.000)
ERROR 1: failed to load datum shift file
Upper Right ( 3015000.000,  805000.000)
ERROR 1: failed to load datum shift file
Lower Right ( 3015000.000,  800000.000)
ERROR 1: failed to load datum shift file
Center      ( 3012500.000,  802500.000)
Band 1 Block=1000x2 Type=Float32, ColorInterp=Gray
  Description = Layer_1
  Min=-3.000 Max=-3.000
  Minimum=-3.000, Maximum=-3.000, Mean=-3.000, StdDev=0.000
  NoData Value=-3.40282306073709653e+38
  Metadata:
    LAYER_TYPE=athematic
    STATISTICS_COVARIANCES=0
    STATISTICS_MAXIMUM=-3
    STATISTICS_MEAN=-3
    STATISTICS_MEDIAN=0
    STATISTICS_MINIMUM=-3
    STATISTICS_MODE=0
    STATISTICS_SKIPFACTORX=1
    STATISTICS_SKIPFACTORY=1
    STATISTICS_STDDEV=0


Doug

On Tue, Jun 9, 2015 at 10:21 AM, Newcomb, Doug <doug_newcomb at fws.gov> wrote:

> Evan,
> I went back and checked.  The .aux.xml sidecar files  with the img files
> do not appear to have projection information.
>
> Doug
>
> On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
>>
>> > Thanks!
>> >
>> > That should work in this case to build the virtual raster.  I'm still
>> > curious about assigning the vertical datum to the rasters.
>>
>> Doug,
>>
>> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node
>> as a
>> child of the PROJCS node. I believe this is an incorrect WKT definition.
>> There
>> should rather be a COMPD_CS root note with 2 children: a PROJCS node for
>> the
>> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS
>> string
>> is defined in the .aux.xml sidecar files that are apparently present ?
>>
>> Regarding your question, there are a few EPSG codes that correspond to
>> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
>> COMPD_CS
>> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
>> horizontal SRS
>> and YYYY the EPSG code of the vertical SRS. In your case that should be
>> EPSG:6543+5703 I think
>>
>> So you can do things like "gdal_translate in.tif out.tif -a_srs
>> EPSG:6543+5703"
>>
>> If you read back out.tif, you will only get the horizontal SRS by
>> default. This
>> was for backward compatibility reason I think. But if you specify
>> "--config
>> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
>>
>> Even
>>
>> >
>> > Doug
>> >
>> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
>> >
>> > >
>> > > About your initial problem:
>> > > > but gdalbuildvrt complained, informing me that
>> > > > they were not in the same projection.
>> > >
>> > > What about using the below gdalbuildvrt option?
>> > >
>> > > Hermann
>> > >
>> > > -allow_projection_difference:
>> > > (starting with GDAL 1.7.0) When this option is specified, the utility
>> will
>> > > accept to make a VRT even if the input datasets have not the same
>> > > projection. Note: this does not mean that they will be reprojected.
>> Their
>> > > projection will just be ignored.
>> > >
>> > > Source: http://www.gdal.org/gdalbuildvrt.html
>> > >
>> > >
>> > >
>> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
>> > >
>> > >> Hi Folks,
>> > >> I have a directory of 783 .img format Lidar - based  DEMs in the same
>> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
>> NVD88.  I
>> > >> was going to use gdalbuildvrt to create a single virtual image for
>> the
>> > >> area, but gdalbuildvrt complained, informing me that they were not in
>> > >> the same projection.
>> > >>
>> > >> A couple of quick bash scripts/commands
>> > >>
>> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
>> > >>
>> > >> and
>> > >> grep PROJCS img_info.txt|sort|uniq -c
>> > >>
>> > >> gives me the following:
>> > >>
>> > >>      437
>> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>> > >>      346
>> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>> > >>
>> > >> gdalinfo gives the following for each type of file ( origin section
>> > >> clipped out) :
>> > >>
>> > >> Driver: HFA/Erdas Imagine Images (.img)
>> > >> Files: D05_37_20878102_20141231.img
>> > >>         D05_37_20878102_20141231.img.aux.xml
>> > >> Size is 1000, 1000
>> > >> Coordinate System is:
>> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
>> > >>      GEOGCS["GCS_NAD_1983_2011",
>> > >>          DATUM["NAD_1983_2011",
>> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>> > >>          PRIMEM["Greenwich",0.0],
>> > >>          UNIT["Degree",0.017453292519943295]],
>> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>> > >>      PARAMETER["False_Easting",2000000.0],
>> > >>      PARAMETER["False_Northing",0.0],
>> > >>      PARAMETER["Central_Meridian",-79.0],
>> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
>> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
>> > >>      PARAMETER["Latitude_Of_Origin",33.75],
>> > >>      UNIT["Foot_US",0.30480060960121924],
>> > >>      VERTCS["NAVD_1988_Foot_US",
>> > >>          VDATUM["North_American_Vertical_Datum_1988"],
>> > >>          PARAMETER["Vertical_Shift",0.0],
>> > >>          PARAMETER["Direction",1.0],
>> > >>          UNIT["Foot_US",0.3048006096012192]]]
>> > >>
>> > >>
>> > >> Driver: HFA/Erdas Imagine Images (.img)
>> > >> Files: D05_37_20957301_20141231.img
>> > >>         D05_37_20957301_20141231.img.aux.xml
>> > >> Size is 1000, 1000
>> > >> Coordinate System is:
>> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
>> > >>      GEOGCS["GCS_NAD_1983_2011",
>> > >>          DATUM["NAD_1983_2011",
>> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
>> > >>          PRIMEM["Greenwich",0.0],
>> > >>          UNIT["Degree",0.0174532925199433]],
>> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
>> > >>      PARAMETER["False_Easting",2000000.002616666],
>> > >>      PARAMETER["False_Northing",0.0],
>> > >>      PARAMETER["Central_Meridian",-79.0],
>> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
>> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
>> > >>      PARAMETER["Latitude_Of_Origin",33.75],
>> > >>      UNIT["Foot_US",0.30480060960121924],
>> > >>      VERTCS["NAVD_1988_Foot_US",
>> > >>          VDATUM["North_American_Vertical_Datum_1988"],
>> > >>          PARAMETER["Vertical_Shift",0.0],
>> > >>          PARAMETER["Direction",1.0],
>> > >>          UNIT["Foot_US",0.3048006096012192]]]
>> > >>
>> > >>
>> > >>
>> > >> In theory, these should all be EPSG:6543, so just assigning the
>> correct
>> > >>   horizontal projection/datum with the epsg code should make things
>> > >> usable. (i.e,
>> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of
>> GTiff
>> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you
>> for
>> > >> the EPSG:6543 projection support in GDAL 2.0!)
>> > >>
>> > >> However, this only assigns the horizontal infomation, how does one
>> > >> assign a vertical datum with a horizontal EPSG code?
>> > >>
>> > >> I see the NVD88 code in vertcs.csv , but how would I implement it in
>> the
>> > >> above command?
>> > >>
>> > >> Using gdal 2.0 Beta2
>> > >>
>> > >>
>> > >> Doug
>> > >> --
>> > >> Doug Newcomb
>> > >> USFWS
>> > >> Raleigh, NC
>> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
>> doug_newcomb at fws.gov>
>> > >>
>> > >>
>> >
>>
>> ---------------------------------------------------------------------------------------------------------
>> > >> The opinions I express are my own and are not representative of the
>> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of the
>> > >> Interior.   Life is too short for undocumented, proprietary data
>> formats.
>> > >>
>> > >>
>> > >> _______________________________________________
>> > >> gdal-dev mailing list
>> > >> gdal-dev at lists.osgeo.org
>> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> > >>
>> > >>
>> > >
>> >
>> >
>> > --
>> > Doug Newcomb
>> > USFWS
>> > Raleigh, NC
>> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
>> >
>>
>> ---------------------------------------------------------------------------------------------------------
>> > The opinions I express are my own and are not representative of the
>> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
>> > Interior.   Life is too short for undocumented, proprietary data
>> formats.
>> >
>>
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
>
> --
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb at fws.gov
>
> ---------------------------------------------------------------------------------------------------------
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> Interior.   Life is too short for undocumented, proprietary data formats.
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/323e8726/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jun  9 07:51:58 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 09 Jun 2015 16:51:58 +0200
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <CALQGVr2pLpssKbeenSWsk4qULUs7t1WT9-G+ThQHXQ947-mTLA@mail.gmail.com>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
	<1433856767.5576eaff4c2a2@imp.free.fr>
	<CALQGVr2AqZt7y-=FEfOwJex1_A0tYcnnsKt6qAHdk+ggBq8-ag@mail.gmail.com>
	<CALQGVr2pLpssKbeenSWsk4qULUs7t1WT9-G+ThQHXQ947-mTLA@mail.gmail.com>
Message-ID: <1433861518.5576fd8ead821@imp.free.fr>

Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:

> Evan,
> Here is the output from gdalinfo  wit the expanded config.
> Note the error messages  on failure to load datum shift files for the
> corner coordinates.
> I'll upgrade to RC1 and check that again, but thought I would mention.

That's not related to GDAL but to PROJ.4. You'd need to download and install
those grid files in the PROJ_LIB directory.

Anyway, I realize I gave you the code for a vertical CS with unit = meters
whereas yours was ft. So you'd better use 6360 instead (which has no reference
to grids)

>
> gdalinfo --config GTIFF_REPORT_COMPD_CS YES D05_37_30081003_20141231.tif
>
> Driver: GTiff/GeoTIFF
> Files: D05_37_30081003_20141231.tif
> Size is 1000, 1000
> Coordinate System is:
> COMPD_CS["unknown",
>     PROJCS["NAD83(2011) / North Carolina (ftUS)",
>         GEOGCS["NAD83(2011)",
>             DATUM["NAD83_National_Spatial_Reference_System_2011",
>                 SPHEROID["GRS 1980",6378137,298.257222101,
>                     AUTHORITY["EPSG","7019"]],
>                 AUTHORITY["EPSG","1116"]],
>             PRIMEM["Greenwich",0,
>                 AUTHORITY["EPSG","8901"]],
>             UNIT["degree",0.0174532925199433,
>                 AUTHORITY["EPSG","9122"]],
>             AUTHORITY["EPSG","6318"]],
>         PROJECTION["Lambert_Conformal_Conic_2SP"],
>         PARAMETER["standard_parallel_1",36.16666666666666],
>         PARAMETER["standard_parallel_2",34.33333333333334],
>         PARAMETER["latitude_of_origin",33.75],
>         PARAMETER["central_meridian",-79],
>         PARAMETER["false_easting",2000000],
>         PARAMETER["false_northing",0],
>         UNIT["US survey foot",0.3048006096012192,
>             AUTHORITY["EPSG","9003"]],
>         AXIS["X",EAST],
>         AXIS["Y",NORTH],
>         AUTHORITY["EPSG","6543"]],
>     VERT_CS["NAVD88 height",
>         VERT_DATUM["North American Vertical Datum 1988",2005,
>
>
EXTENSION["PROJ4_GRIDS","g2012a_conus.gtx,g2012a_alaska.gtx,g2012a_guam.gtx,g2012a_hawaii.gtx,g2012a_puertorico.gtx,g2012a_samoa.gtx"],
>             AUTHORITY["EPSG","5103"]],
>         UNIT["metre",1,
>             AUTHORITY["EPSG","9001"]],
>         AXIS["Up",UP],
>         AUTHORITY["EPSG","5703"]]]
> Origin = (3010000.000000000000000,805000.000000000000000)
> Pixel Size = (5.000000000000000,-5.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   DataType=Generic
> Image Structure Metadata:
>   COMPRESSION=DEFLATE
>   INTERLEAVE=BAND
> Corner Coordinates:
> ERROR 1: failed to load datum shift file
> Upper Left  ( 3010000.000,  805000.000)
> ERROR 1: failed to load datum shift file
> Lower Left  ( 3010000.000,  800000.000)
> ERROR 1: failed to load datum shift file
> Upper Right ( 3015000.000,  805000.000)
> ERROR 1: failed to load datum shift file
> Lower Right ( 3015000.000,  800000.000)
> ERROR 1: failed to load datum shift file
> Center      ( 3012500.000,  802500.000)
> Band 1 Block=1000x2 Type=Float32, ColorInterp=Gray
>   Description = Layer_1
>   Min=-3.000 Max=-3.000
>   Minimum=-3.000, Maximum=-3.000, Mean=-3.000, StdDev=0.000
>   NoData Value=-3.40282306073709653e+38
>   Metadata:
>     LAYER_TYPE=athematic
>     STATISTICS_COVARIANCES=0
>     STATISTICS_MAXIMUM=-3
>     STATISTICS_MEAN=-3
>     STATISTICS_MEDIAN=0
>     STATISTICS_MINIMUM=-3
>     STATISTICS_MODE=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=0
>
>
> Doug
>
> On Tue, Jun 9, 2015 at 10:21 AM, Newcomb, Doug <doug_newcomb at fws.gov> wrote:
>
> > Evan,
> > I went back and checked.  The .aux.xml sidecar files  with the img files
> > do not appear to have projection information.
> >
> > Doug
> >
> > On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com>
> > wrote:
> >
> >> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
> >>
> >> > Thanks!
> >> >
> >> > That should work in this case to build the virtual raster.  I'm still
> >> > curious about assigning the vertical datum to the rasters.
> >>
> >> Doug,
> >>
> >> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node
> >> as a
> >> child of the PROJCS node. I believe this is an incorrect WKT definition.
> >> There
> >> should rather be a COMPD_CS root note with 2 children: a PROJCS node for
> >> the
> >> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS
> >> string
> >> is defined in the .aux.xml sidecar files that are apparently present ?
> >>
> >> Regarding your question, there are a few EPSG codes that correspond to
> >> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
> >> COMPD_CS
> >> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
> >> horizontal SRS
> >> and YYYY the EPSG code of the vertical SRS. In your case that should be
> >> EPSG:6543+5703 I think
> >>
> >> So you can do things like "gdal_translate in.tif out.tif -a_srs
> >> EPSG:6543+5703"
> >>
> >> If you read back out.tif, you will only get the horizontal SRS by
> >> default. This
> >> was for backward compatibility reason I think. But if you specify
> >> "--config
> >> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
> >>
> >> Even
> >>
> >> >
> >> > Doug
> >> >
> >> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
> >> >
> >> > >
> >> > > About your initial problem:
> >> > > > but gdalbuildvrt complained, informing me that
> >> > > > they were not in the same projection.
> >> > >
> >> > > What about using the below gdalbuildvrt option?
> >> > >
> >> > > Hermann
> >> > >
> >> > > -allow_projection_difference:
> >> > > (starting with GDAL 1.7.0) When this option is specified, the utility
> >> will
> >> > > accept to make a VRT even if the input datasets have not the same
> >> > > projection. Note: this does not mean that they will be reprojected.
> >> Their
> >> > > projection will just be ignored.
> >> > >
> >> > > Source: http://www.gdal.org/gdalbuildvrt.html
> >> > >
> >> > >
> >> > >
> >> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
> >> > >
> >> > >> Hi Folks,
> >> > >> I have a directory of 783 .img format Lidar - based  DEMs in the same
> >> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
> >> NVD88.  I
> >> > >> was going to use gdalbuildvrt to create a single virtual image for
> >> the
> >> > >> area, but gdalbuildvrt complained, informing me that they were not in
> >> > >> the same projection.
> >> > >>
> >> > >> A couple of quick bash scripts/commands
> >> > >>
> >> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> >> > >>
> >> > >> and
> >> > >> grep PROJCS img_info.txt|sort|uniq -c
> >> > >>
> >> > >> gives me the following:
> >> > >>
> >> > >>      437
> >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >> > >>      346
> >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >> > >>
> >> > >> gdalinfo gives the following for each type of file ( origin section
> >> > >> clipped out) :
> >> > >>
> >> > >> Driver: HFA/Erdas Imagine Images (.img)
> >> > >> Files: D05_37_20878102_20141231.img
> >> > >>         D05_37_20878102_20141231.img.aux.xml
> >> > >> Size is 1000, 1000
> >> > >> Coordinate System is:
> >> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >> > >>      GEOGCS["GCS_NAD_1983_2011",
> >> > >>          DATUM["NAD_1983_2011",
> >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >> > >>          PRIMEM["Greenwich",0.0],
> >> > >>          UNIT["Degree",0.017453292519943295]],
> >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >> > >>      PARAMETER["False_Easting",2000000.0],
> >> > >>      PARAMETER["False_Northing",0.0],
> >> > >>      PARAMETER["Central_Meridian",-79.0],
> >> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> >> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> >> > >>      UNIT["Foot_US",0.30480060960121924],
> >> > >>      VERTCS["NAVD_1988_Foot_US",
> >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> >> > >>          PARAMETER["Vertical_Shift",0.0],
> >> > >>          PARAMETER["Direction",1.0],
> >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> >> > >>
> >> > >>
> >> > >> Driver: HFA/Erdas Imagine Images (.img)
> >> > >> Files: D05_37_20957301_20141231.img
> >> > >>         D05_37_20957301_20141231.img.aux.xml
> >> > >> Size is 1000, 1000
> >> > >> Coordinate System is:
> >> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >> > >>      GEOGCS["GCS_NAD_1983_2011",
> >> > >>          DATUM["NAD_1983_2011",
> >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >> > >>          PRIMEM["Greenwich",0.0],
> >> > >>          UNIT["Degree",0.0174532925199433]],
> >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >> > >>      PARAMETER["False_Easting",2000000.002616666],
> >> > >>      PARAMETER["False_Northing",0.0],
> >> > >>      PARAMETER["Central_Meridian",-79.0],
> >> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> >> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> >> > >>      UNIT["Foot_US",0.30480060960121924],
> >> > >>      VERTCS["NAVD_1988_Foot_US",
> >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> >> > >>          PARAMETER["Vertical_Shift",0.0],
> >> > >>          PARAMETER["Direction",1.0],
> >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> >> > >>
> >> > >>
> >> > >>
> >> > >> In theory, these should all be EPSG:6543, so just assigning the
> >> correct
> >> > >>   horizontal projection/datum with the epsg code should make things
> >> > >> usable. (i.e,
> >> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of
> >> GTiff
> >> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you
> >> for
> >> > >> the EPSG:6543 projection support in GDAL 2.0!)
> >> > >>
> >> > >> However, this only assigns the horizontal infomation, how does one
> >> > >> assign a vertical datum with a horizontal EPSG code?
> >> > >>
> >> > >> I see the NVD88 code in vertcs.csv , but how would I implement it in
> >> the
> >> > >> above command?
> >> > >>
> >> > >> Using gdal 2.0 Beta2
> >> > >>
> >> > >>
> >> > >> Doug
> >> > >> --
> >> > >> Doug Newcomb
> >> > >> USFWS
> >> > >> Raleigh, NC
> >> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
> >> doug_newcomb at fws.gov>
> >> > >>
> >> > >>
> >> >
> >>
> >>
>
---------------------------------------------------------------------------------------------------------
> >> > >> The opinions I express are my own and are not representative of the
> >> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> >> > >> Interior.   Life is too short for undocumented, proprietary data
> >> formats.
> >> > >>
> >> > >>
> >> > >> _______________________________________________
> >> > >> gdal-dev mailing list
> >> > >> gdal-dev at lists.osgeo.org
> >> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> > >>
> >> > >>
> >> > >
> >> >
> >> >
> >> > --
> >> > Doug Newcomb
> >> > USFWS
> >> > Raleigh, NC
> >> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >> >
> >>
> >>
>
---------------------------------------------------------------------------------------------------------
> >> > The opinions I express are my own and are not representative of the
> >> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> >> > Interior.   Life is too short for undocumented, proprietary data
> >> formats.
> >> >
> >>
> >>
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com
> >>
> >
> >
> >
> > --
> > Doug Newcomb
> > USFWS
> > Raleigh, NC
> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >
> >
>
---------------------------------------------------------------------------------------------------------
> > The opinions I express are my own and are not representative of the
> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > Interior.   Life is too short for undocumented, proprietary data formats.
> >
>
>
>
> --
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb at fws.gov
>
---------------------------------------------------------------------------------------------------------
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> Interior.   Life is too short for undocumented, proprietary data formats.
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kempenep at gmail.com  Tue Jun  9 08:20:19 2015
From: kempenep at gmail.com (Pieter Kempeneers)
Date: Tue, 9 Jun 2015 17:20:19 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 133, Issue 17
In-Reply-To: <mailman.18272.1433860740.19517.gdal-dev@lists.osgeo.org>
References: <mailman.18272.1433860740.19517.gdal-dev@lists.osgeo.org>
Message-ID: <CAPa4Yv4GfN3MCKKmczPWtPic=S-cG=2uUhyJD66z9N9b8k3SuA@mail.gmail.com>

>
> Message: 1
> Date: Tue, 9 Jun 2015 14:31:48 +0000
> From: "Ronquillo, Edgar Nahum" <eronquillo at lanl.gov>
> To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] Overlay shapefile onto Geotiff image
> Message-ID:
>         <
> 2086CE7E967C1B4F9D5897BE1C3C746F3119455B at ECS-EXG-P-MB01.win.lanl.gov>
> Content-Type: text/plain; charset="iso-8859-1"
>
> Hi,
> I have been working on this issue for quite a while. I currently have a
> GeoTiff image and a shapefile. I would like to overlay the shapefile on the
> Geotiff, is this possible with Gdal? I looked into gdal_rasterize but I
> just don't know how to incorporate it with what I need. A code to start
> with would be great if possible. Or maybe point me into the right direction
> of probably other libraries that could do this.
>

Hi Edgar,

What is it exactly you want to do with the overlay? If it is just cropping
the Geotiff, you can use gdalwarp (check option -crop_to_cutline). If you
want to extract the raster pixels in the Geotiff covered by the shapefile
(all pixels, average, etc.), you can use pkextract from pktools (
http://pktools.nongnu.org/html/pkextract.html). It also has a processing
toolbox plugin for QGIS (http://plugins.qgis.org/plugins/pktools/). The
code is open source (GPLv3).

Pieter.

2015-06-09 16:39 GMT+02:00 <gdal-dev-request at lists.osgeo.org>:

> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. Overlay shapefile onto Geotiff image (Ronquillo, Edgar Nahum)
>    2. Re: assigning vertical datum to image files (Newcomb, Doug)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 9 Jun 2015 14:31:48 +0000
> From: "Ronquillo, Edgar Nahum" <eronquillo at lanl.gov>
> To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] Overlay shapefile onto Geotiff image
> Message-ID:
>         <
> 2086CE7E967C1B4F9D5897BE1C3C746F3119455B at ECS-EXG-P-MB01.win.lanl.gov>
> Content-Type: text/plain; charset="iso-8859-1"
>
> Hi,
> I have been working on this issue for quite a while. I currently have a
> GeoTiff image and a shapefile. I would like to overlay the shapefile on the
> Geotiff, is this possible with Gdal? I looked into gdal_rasterize but I
> just don't know how to incorporate it with what I need. A code to start
> with would be great if possible. Or maybe point me into the right direction
> of probably other libraries that could do this.
>
> Thanks for the help
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/028f5e7e/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 2
> Date: Tue, 9 Jun 2015 10:38:30 -0400
> From: "Newcomb, Doug" <doug_newcomb at fws.gov>
> To: Even Rouault <even.rouault at spatialys.com>
> Cc: gdal dev <gdal-dev at lists.osgeo.org>, Hermann Peifer
>         <peifer at gmx.eu>
> Subject: Re: [gdal-dev] assigning vertical datum to image files
> Message-ID:
>         <
> CALQGVr2pLpssKbeenSWsk4qULUs7t1WT9-G+ThQHXQ947-mTLA at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Evan,
> Here is the output from gdalinfo  wit the expanded config.
> Note the error messages  on failure to load datum shift files for the
> corner coordinates.
> I'll upgrade to RC1 and check that again, but thought I would mention.
>
> gdalinfo --config GTIFF_REPORT_COMPD_CS YES D05_37_30081003_20141231.tif
>
> Driver: GTiff/GeoTIFF
> Files: D05_37_30081003_20141231.tif
> Size is 1000, 1000
> Coordinate System is:
> COMPD_CS["unknown",
>     PROJCS["NAD83(2011) / North Carolina (ftUS)",
>         GEOGCS["NAD83(2011)",
>             DATUM["NAD83_National_Spatial_Reference_System_2011",
>                 SPHEROID["GRS 1980",6378137,298.257222101,
>                     AUTHORITY["EPSG","7019"]],
>                 AUTHORITY["EPSG","1116"]],
>             PRIMEM["Greenwich",0,
>                 AUTHORITY["EPSG","8901"]],
>             UNIT["degree",0.0174532925199433,
>                 AUTHORITY["EPSG","9122"]],
>             AUTHORITY["EPSG","6318"]],
>         PROJECTION["Lambert_Conformal_Conic_2SP"],
>         PARAMETER["standard_parallel_1",36.16666666666666],
>         PARAMETER["standard_parallel_2",34.33333333333334],
>         PARAMETER["latitude_of_origin",33.75],
>         PARAMETER["central_meridian",-79],
>         PARAMETER["false_easting",2000000],
>         PARAMETER["false_northing",0],
>         UNIT["US survey foot",0.3048006096012192,
>             AUTHORITY["EPSG","9003"]],
>         AXIS["X",EAST],
>         AXIS["Y",NORTH],
>         AUTHORITY["EPSG","6543"]],
>     VERT_CS["NAVD88 height",
>         VERT_DATUM["North American Vertical Datum 1988",2005,
>
>
> EXTENSION["PROJ4_GRIDS","g2012a_conus.gtx,g2012a_alaska.gtx,g2012a_guam.gtx,g2012a_hawaii.gtx,g2012a_puertorico.gtx,g2012a_samoa.gtx"],
>             AUTHORITY["EPSG","5103"]],
>         UNIT["metre",1,
>             AUTHORITY["EPSG","9001"]],
>         AXIS["Up",UP],
>         AUTHORITY["EPSG","5703"]]]
> Origin = (3010000.000000000000000,805000.000000000000000)
> Pixel Size = (5.000000000000000,-5.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   DataType=Generic
> Image Structure Metadata:
>   COMPRESSION=DEFLATE
>   INTERLEAVE=BAND
> Corner Coordinates:
> ERROR 1: failed to load datum shift file
> Upper Left  ( 3010000.000,  805000.000)
> ERROR 1: failed to load datum shift file
> Lower Left  ( 3010000.000,  800000.000)
> ERROR 1: failed to load datum shift file
> Upper Right ( 3015000.000,  805000.000)
> ERROR 1: failed to load datum shift file
> Lower Right ( 3015000.000,  800000.000)
> ERROR 1: failed to load datum shift file
> Center      ( 3012500.000,  802500.000)
> Band 1 Block=1000x2 Type=Float32, ColorInterp=Gray
>   Description = Layer_1
>   Min=-3.000 Max=-3.000
>   Minimum=-3.000, Maximum=-3.000, Mean=-3.000, StdDev=0.000
>   NoData Value=-3.40282306073709653e+38
>   Metadata:
>     LAYER_TYPE=athematic
>     STATISTICS_COVARIANCES=0
>     STATISTICS_MAXIMUM=-3
>     STATISTICS_MEAN=-3
>     STATISTICS_MEDIAN=0
>     STATISTICS_MINIMUM=-3
>     STATISTICS_MODE=0
>     STATISTICS_SKIPFACTORX=1
>     STATISTICS_SKIPFACTORY=1
>     STATISTICS_STDDEV=0
>
>
> Doug
>
> On Tue, Jun 9, 2015 at 10:21 AM, Newcomb, Doug <doug_newcomb at fws.gov>
> wrote:
>
> > Evan,
> > I went back and checked.  The .aux.xml sidecar files  with the img files
> > do not appear to have projection information.
> >
> > Doug
> >
> > On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <even.rouault at spatialys.com
> >
> > wrote:
> >
> >> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
> >>
> >> > Thanks!
> >> >
> >> > That should work in this case to build the virtual raster.  I'm still
> >> > curious about assigning the vertical datum to the rasters.
> >>
> >> Doug,
> >>
> >> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS node
> >> as a
> >> child of the PROJCS node. I believe this is an incorrect WKT definition.
> >> There
> >> should rather be a COMPD_CS root note with 2 children: a PROJCS node for
> >> the
> >> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this SRS
> >> string
> >> is defined in the .aux.xml sidecar files that are apparently present ?
> >>
> >> Regarding your question, there are a few EPSG codes that correspond to
> >> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
> >> COMPD_CS
> >> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
> >> horizontal SRS
> >> and YYYY the EPSG code of the vertical SRS. In your case that should be
> >> EPSG:6543+5703 I think
> >>
> >> So you can do things like "gdal_translate in.tif out.tif -a_srs
> >> EPSG:6543+5703"
> >>
> >> If you read back out.tif, you will only get the horizontal SRS by
> >> default. This
> >> was for backward compatibility reason I think. But if you specify
> >> "--config
> >> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
> >>
> >> Even
> >>
> >> >
> >> > Doug
> >> >
> >> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu> wrote:
> >> >
> >> > >
> >> > > About your initial problem:
> >> > > > but gdalbuildvrt complained, informing me that
> >> > > > they were not in the same projection.
> >> > >
> >> > > What about using the below gdalbuildvrt option?
> >> > >
> >> > > Hermann
> >> > >
> >> > > -allow_projection_difference:
> >> > > (starting with GDAL 1.7.0) When this option is specified, the
> utility
> >> will
> >> > > accept to make a VRT even if the input datasets have not the same
> >> > > projection. Note: this does not mean that they will be reprojected.
> >> Their
> >> > > projection will just be ignored.
> >> > >
> >> > > Source: http://www.gdal.org/gdalbuildvrt.html
> >> > >
> >> > >
> >> > >
> >> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
> >> > >
> >> > >> Hi Folks,
> >> > >> I have a directory of 783 .img format Lidar - based  DEMs in the
> same
> >> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
> >> NVD88.  I
> >> > >> was going to use gdalbuildvrt to create a single virtual image for
> >> the
> >> > >> area, but gdalbuildvrt complained, informing me that they were not
> in
> >> > >> the same projection.
> >> > >>
> >> > >> A couple of quick bash scripts/commands
> >> > >>
> >> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> >> > >>
> >> > >> and
> >> > >> grep PROJCS img_info.txt|sort|uniq -c
> >> > >>
> >> > >> gives me the following:
> >> > >>
> >> > >>      437
> >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >> > >>      346
> >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >> > >>
> >> > >> gdalinfo gives the following for each type of file ( origin section
> >> > >> clipped out) :
> >> > >>
> >> > >> Driver: HFA/Erdas Imagine Images (.img)
> >> > >> Files: D05_37_20878102_20141231.img
> >> > >>         D05_37_20878102_20141231.img.aux.xml
> >> > >> Size is 1000, 1000
> >> > >> Coordinate System is:
> >> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> >> > >>      GEOGCS["GCS_NAD_1983_2011",
> >> > >>          DATUM["NAD_1983_2011",
> >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >> > >>          PRIMEM["Greenwich",0.0],
> >> > >>          UNIT["Degree",0.017453292519943295]],
> >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >> > >>      PARAMETER["False_Easting",2000000.0],
> >> > >>      PARAMETER["False_Northing",0.0],
> >> > >>      PARAMETER["Central_Meridian",-79.0],
> >> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> >> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> >> > >>      UNIT["Foot_US",0.30480060960121924],
> >> > >>      VERTCS["NAVD_1988_Foot_US",
> >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> >> > >>          PARAMETER["Vertical_Shift",0.0],
> >> > >>          PARAMETER["Direction",1.0],
> >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> >> > >>
> >> > >>
> >> > >> Driver: HFA/Erdas Imagine Images (.img)
> >> > >> Files: D05_37_20957301_20141231.img
> >> > >>         D05_37_20957301_20141231.img.aux.xml
> >> > >> Size is 1000, 1000
> >> > >> Coordinate System is:
> >> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> >> > >>      GEOGCS["GCS_NAD_1983_2011",
> >> > >>          DATUM["NAD_1983_2011",
> >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> >> > >>          PRIMEM["Greenwich",0.0],
> >> > >>          UNIT["Degree",0.0174532925199433]],
> >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> >> > >>      PARAMETER["False_Easting",2000000.002616666],
> >> > >>      PARAMETER["False_Northing",0.0],
> >> > >>      PARAMETER["Central_Meridian",-79.0],
> >> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> >> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> >> > >>      UNIT["Foot_US",0.30480060960121924],
> >> > >>      VERTCS["NAVD_1988_Foot_US",
> >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> >> > >>          PARAMETER["Vertical_Shift",0.0],
> >> > >>          PARAMETER["Direction",1.0],
> >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> >> > >>
> >> > >>
> >> > >>
> >> > >> In theory, these should all be EPSG:6543, so just assigning the
> >> correct
> >> > >>   horizontal projection/datum with the epsg code should make things
> >> > >> usable. (i.e,
> >> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of
> >> GTiff
> >> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank you
> >> for
> >> > >> the EPSG:6543 projection support in GDAL 2.0!)
> >> > >>
> >> > >> However, this only assigns the horizontal infomation, how does one
> >> > >> assign a vertical datum with a horizontal EPSG code?
> >> > >>
> >> > >> I see the NVD88 code in vertcs.csv , but how would I implement it
> in
> >> the
> >> > >> above command?
> >> > >>
> >> > >> Using gdal 2.0 Beta2
> >> > >>
> >> > >>
> >> > >> Doug
> >> > >> --
> >> > >> Doug Newcomb
> >> > >> USFWS
> >> > >> Raleigh, NC
> >> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
> >> doug_newcomb at fws.gov>
> >> > >>
> >> > >>
> >> >
> >>
> >>
> ---------------------------------------------------------------------------------------------------------
> >> > >> The opinions I express are my own and are not representative of the
> >> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of
> the
> >> > >> Interior.   Life is too short for undocumented, proprietary data
> >> formats.
> >> > >>
> >> > >>
> >> > >> _______________________________________________
> >> > >> gdal-dev mailing list
> >> > >> gdal-dev at lists.osgeo.org
> >> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> > >>
> >> > >>
> >> > >
> >> >
> >> >
> >> > --
> >> > Doug Newcomb
> >> > USFWS
> >> > Raleigh, NC
> >> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >> >
> >>
> >>
> ---------------------------------------------------------------------------------------------------------
> >> > The opinions I express are my own and are not representative of the
> >> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> >> > Interior.   Life is too short for undocumented, proprietary data
> >> formats.
> >> >
> >>
> >>
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com
> >>
> >
> >
> >
> > --
> > Doug Newcomb
> > USFWS
> > Raleigh, NC
> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >
> >
> ---------------------------------------------------------------------------------------------------------
> > The opinions I express are my own and are not representative of the
> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > Interior.   Life is too short for undocumented, proprietary data formats.
> >
>
>
>
> --
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb at fws.gov
>
> ---------------------------------------------------------------------------------------------------------
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of the
> Interior.   Life is too short for undocumented, proprietary data formats.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/323e8726/attachment.html
> >
>
> ------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> End of gdal-dev Digest, Vol 133, Issue 17
> *****************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/9abaee1e/attachment-0001.html>

From doug_newcomb at fws.gov  Tue Jun  9 12:07:34 2015
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Tue, 9 Jun 2015 15:07:34 -0400
Subject: [gdal-dev] assigning vertical datum to image files
In-Reply-To: <1433861518.5576fd8ead821@imp.free.fr>
References: <CALQGVr3jnYfiB_CS0Kdi4=YCCd00cbf4sUmBQwiqUq-ASa7xXg@mail.gmail.com>
	<55767E1E.6030009@gmx.eu>
	<CALQGVr0Ej3uW1f+V55sCvzfoiavZ+h_FFBFgoh2BEvfrmLsaKA@mail.gmail.com>
	<1433856767.5576eaff4c2a2@imp.free.fr>
	<CALQGVr2AqZt7y-=FEfOwJex1_A0tYcnnsKt6qAHdk+ggBq8-ag@mail.gmail.com>
	<CALQGVr2pLpssKbeenSWsk4qULUs7t1WT9-G+ThQHXQ947-mTLA@mail.gmail.com>
	<1433861518.5576fd8ead821@imp.free.fr>
Message-ID: <CALQGVr1Xuvo0XuRHKgmwPDzm1cWVG7Z6M8V5EnvYbFHigjP7TA@mail.gmail.com>

putting the gtx files in the right proj directory works wonders :-)

Thanks! All is working now.

Doug

On Tue, Jun 9, 2015 at 10:51 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
>
> > Evan,
> > Here is the output from gdalinfo  wit the expanded config.
> > Note the error messages  on failure to load datum shift files for the
> > corner coordinates.
> > I'll upgrade to RC1 and check that again, but thought I would mention.
>
> That's not related to GDAL but to PROJ.4. You'd need to download and
> install
> those grid files in the PROJ_LIB directory.
>
> Anyway, I realize I gave you the code for a vertical CS with unit = meters
> whereas yours was ft. So you'd better use 6360 instead (which has no
> reference
> to grids)
>
> >
> > gdalinfo --config GTIFF_REPORT_COMPD_CS YES D05_37_30081003_20141231.tif
> >
> > Driver: GTiff/GeoTIFF
> > Files: D05_37_30081003_20141231.tif
> > Size is 1000, 1000
> > Coordinate System is:
> > COMPD_CS["unknown",
> >     PROJCS["NAD83(2011) / North Carolina (ftUS)",
> >         GEOGCS["NAD83(2011)",
> >             DATUM["NAD83_National_Spatial_Reference_System_2011",
> >                 SPHEROID["GRS 1980",6378137,298.257222101,
> >                     AUTHORITY["EPSG","7019"]],
> >                 AUTHORITY["EPSG","1116"]],
> >             PRIMEM["Greenwich",0,
> >                 AUTHORITY["EPSG","8901"]],
> >             UNIT["degree",0.0174532925199433,
> >                 AUTHORITY["EPSG","9122"]],
> >             AUTHORITY["EPSG","6318"]],
> >         PROJECTION["Lambert_Conformal_Conic_2SP"],
> >         PARAMETER["standard_parallel_1",36.16666666666666],
> >         PARAMETER["standard_parallel_2",34.33333333333334],
> >         PARAMETER["latitude_of_origin",33.75],
> >         PARAMETER["central_meridian",-79],
> >         PARAMETER["false_easting",2000000],
> >         PARAMETER["false_northing",0],
> >         UNIT["US survey foot",0.3048006096012192,
> >             AUTHORITY["EPSG","9003"]],
> >         AXIS["X",EAST],
> >         AXIS["Y",NORTH],
> >         AUTHORITY["EPSG","6543"]],
> >     VERT_CS["NAVD88 height",
> >         VERT_DATUM["North American Vertical Datum 1988",2005,
> >
> >
>
> EXTENSION["PROJ4_GRIDS","g2012a_conus.gtx,g2012a_alaska.gtx,g2012a_guam.gtx,g2012a_hawaii.gtx,g2012a_puertorico.gtx,g2012a_samoa.gtx"],
> >             AUTHORITY["EPSG","5103"]],
> >         UNIT["metre",1,
> >             AUTHORITY["EPSG","9001"]],
> >         AXIS["Up",UP],
> >         AUTHORITY["EPSG","5703"]]]
> > Origin = (3010000.000000000000000,805000.000000000000000)
> > Pixel Size = (5.000000000000000,-5.000000000000000)
> > Metadata:
> >   AREA_OR_POINT=Area
> >   DataType=Generic
> > Image Structure Metadata:
> >   COMPRESSION=DEFLATE
> >   INTERLEAVE=BAND
> > Corner Coordinates:
> > ERROR 1: failed to load datum shift file
> > Upper Left  ( 3010000.000,  805000.000)
> > ERROR 1: failed to load datum shift file
> > Lower Left  ( 3010000.000,  800000.000)
> > ERROR 1: failed to load datum shift file
> > Upper Right ( 3015000.000,  805000.000)
> > ERROR 1: failed to load datum shift file
> > Lower Right ( 3015000.000,  800000.000)
> > ERROR 1: failed to load datum shift file
> > Center      ( 3012500.000,  802500.000)
> > Band 1 Block=1000x2 Type=Float32, ColorInterp=Gray
> >   Description = Layer_1
> >   Min=-3.000 Max=-3.000
> >   Minimum=-3.000, Maximum=-3.000, Mean=-3.000, StdDev=0.000
> >   NoData Value=-3.40282306073709653e+38
> >   Metadata:
> >     LAYER_TYPE=athematic
> >     STATISTICS_COVARIANCES=0
> >     STATISTICS_MAXIMUM=-3
> >     STATISTICS_MEAN=-3
> >     STATISTICS_MEDIAN=0
> >     STATISTICS_MINIMUM=-3
> >     STATISTICS_MODE=0
> >     STATISTICS_SKIPFACTORX=1
> >     STATISTICS_SKIPFACTORY=1
> >     STATISTICS_STDDEV=0
> >
> >
> > Doug
> >
> > On Tue, Jun 9, 2015 at 10:21 AM, Newcomb, Doug <doug_newcomb at fws.gov>
> wrote:
> >
> > > Evan,
> > > I went back and checked.  The .aux.xml sidecar files  with the img
> files
> > > do not appear to have projection information.
> > >
> > > Doug
> > >
> > > On Tue, Jun 9, 2015 at 9:32 AM, Even Rouault <
> even.rouault at spatialys.com>
> > > wrote:
> > >
> > >> Selon "Newcomb, Doug" <doug_newcomb at fws.gov>:
> > >>
> > >> > Thanks!
> > >> >
> > >> > That should work in this case to build the virtual raster.  I'm
> still
> > >> > curious about assigning the vertical datum to the rasters.
> > >>
> > >> Doug,
> > >>
> > >> I'm a bit surprised that the HFA driver reports a SRS with a VERTCS
> node
> > >> as a
> > >> child of the PROJCS node. I believe this is an incorrect WKT
> definition.
> > >> There
> > >> should rather be a COMPD_CS root note with 2 children: a PROJCS node
> for
> > >> the
> > >> horizontal CRS and a VERTCS node for the vertical CRS. Perhaps this
> SRS
> > >> string
> > >> is defined in the .aux.xml sidecar files that are apparently present ?
> > >>
> > >> Regarding your question, there are a few EPSG codes that correspond to
> > >> aCOMPD_CS, for example 6349. Otherwise, GDAL allows to build a custom
> > >> COMPD_CS
> > >> with the syntax EPSG:XXXX+YYYY where XXXX is the EPSG code of the
> > >> horizontal SRS
> > >> and YYYY the EPSG code of the vertical SRS. In your case that should
> be
> > >> EPSG:6543+5703 I think
> > >>
> > >> So you can do things like "gdal_translate in.tif out.tif -a_srs
> > >> EPSG:6543+5703"
> > >>
> > >> If you read back out.tif, you will only get the horizontal SRS by
> > >> default. This
> > >> was for backward compatibility reason I think. But if you specify
> > >> "--config
> > >> GTIFF_REPORT_COMPD_CS YES" you will get the COMPD_CS.
> > >>
> > >> Even
> > >>
> > >> >
> > >> > Doug
> > >> >
> > >> > On Tue, Jun 9, 2015 at 1:48 AM, Hermann Peifer <peifer at gmx.eu>
> wrote:
> > >> >
> > >> > >
> > >> > > About your initial problem:
> > >> > > > but gdalbuildvrt complained, informing me that
> > >> > > > they were not in the same projection.
> > >> > >
> > >> > > What about using the below gdalbuildvrt option?
> > >> > >
> > >> > > Hermann
> > >> > >
> > >> > > -allow_projection_difference:
> > >> > > (starting with GDAL 1.7.0) When this option is specified, the
> utility
> > >> will
> > >> > > accept to make a VRT even if the input datasets have not the same
> > >> > > projection. Note: this does not mean that they will be
> reprojected.
> > >> Their
> > >> > > projection will just be ignored.
> > >> > >
> > >> > > Source: http://www.gdal.org/gdalbuildvrt.html
> > >> > >
> > >> > >
> > >> > >
> > >> > > On 2015-06-08 21:01, Newcomb, Doug wrote:
> > >> > >
> > >> > >> Hi Folks,
> > >> > >> I have a directory of 783 .img format Lidar - based  DEMs in the
> same
> > >> > >> projection, North Carolina State Plane  Feet (2011) , NAD 83 ,
> > >> NVD88.  I
> > >> > >> was going to use gdalbuildvrt to create a single virtual image
> for
> > >> the
> > >> > >> area, but gdalbuildvrt complained, informing me that they were
> not in
> > >> > >> the same projection.
> > >> > >>
> > >> > >> A couple of quick bash scripts/commands
> > >> > >>
> > >> > >> for x in *.img; do gdalinfo $x >>img_info.txt;done
> > >> > >>
> > >> > >> and
> > >> > >> grep PROJCS img_info.txt|sort|uniq -c
> > >> > >>
> > >> > >> gives me the following:
> > >> > >>
> > >> > >>      437
> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >> > >>      346
> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >> > >>
> > >> > >> gdalinfo gives the following for each type of file ( origin
> section
> > >> > >> clipped out) :
> > >> > >>
> > >> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> > >> Files: D05_37_20878102_20141231.img
> > >> > >>         D05_37_20878102_20141231.img.aux.xml
> > >> > >> Size is 1000, 1000
> > >> > >> Coordinate System is:
> > >> > >> PROJCS["NAD_1983_2011_StatePlane_North_Carolina_FIPS_3200_Ft_US",
> > >> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >> > >>          DATUM["NAD_1983_2011",
> > >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >> > >>          PRIMEM["Greenwich",0.0],
> > >> > >>          UNIT["Degree",0.017453292519943295]],
> > >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >> > >>      PARAMETER["False_Easting",2000000.0],
> > >> > >>      PARAMETER["False_Northing",0.0],
> > >> > >>      PARAMETER["Central_Meridian",-79.0],
> > >> > >>      PARAMETER["Standard_Parallel_1",34.3333333333333],
> > >> > >>      PARAMETER["Standard_Parallel_2",36.1666666666667],
> > >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >> > >>      UNIT["Foot_US",0.30480060960121924],
> > >> > >>      VERTCS["NAVD_1988_Foot_US",
> > >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >> > >>          PARAMETER["Vertical_Shift",0.0],
> > >> > >>          PARAMETER["Direction",1.0],
> > >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >> > >>
> > >> > >>
> > >> > >> Driver: HFA/Erdas Imagine Images (.img)
> > >> > >> Files: D05_37_20957301_20141231.img
> > >> > >>         D05_37_20957301_20141231.img.aux.xml
> > >> > >> Size is 1000, 1000
> > >> > >> Coordinate System is:
> > >> > >> PROJCS["NAD_1983_StatePlane_North_Carolina_FIPS_3200_Feet_2011",
> > >> > >>      GEOGCS["GCS_NAD_1983_2011",
> > >> > >>          DATUM["NAD_1983_2011",
> > >> > >>              SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > >> > >>          PRIMEM["Greenwich",0.0],
> > >> > >>          UNIT["Degree",0.0174532925199433]],
> > >> > >>      PROJECTION["Lambert_Conformal_Conic_2SP"],
> > >> > >>      PARAMETER["False_Easting",2000000.002616666],
> > >> > >>      PARAMETER["False_Northing",0.0],
> > >> > >>      PARAMETER["Central_Meridian",-79.0],
> > >> > >>      PARAMETER["Standard_Parallel_1",34.33333333333334],
> > >> > >>      PARAMETER["Standard_Parallel_2",36.16666666666666],
> > >> > >>      PARAMETER["Latitude_Of_Origin",33.75],
> > >> > >>      UNIT["Foot_US",0.30480060960121924],
> > >> > >>      VERTCS["NAVD_1988_Foot_US",
> > >> > >>          VDATUM["North_American_Vertical_Datum_1988"],
> > >> > >>          PARAMETER["Vertical_Shift",0.0],
> > >> > >>          PARAMETER["Direction",1.0],
> > >> > >>          UNIT["Foot_US",0.3048006096012192]]]
> > >> > >>
> > >> > >>
> > >> > >>
> > >> > >> In theory, these should all be EPSG:6543, so just assigning the
> > >> correct
> > >> > >>   horizontal projection/datum with the epsg code should make
> things
> > >> > >> usable. (i.e,
> > >> > >> gdal_translate -a_"srs epsg:6543" --config GDAL_CACHEMAX 512 -of
> > >> GTiff
> > >> > >> -co COMPRESS=DEFLATE -co PREDICTOR=3 in.img out.tif )  ( Thank
> you
> > >> for
> > >> > >> the EPSG:6543 projection support in GDAL 2.0!)
> > >> > >>
> > >> > >> However, this only assigns the horizontal infomation, how does
> one
> > >> > >> assign a vertical datum with a horizontal EPSG code?
> > >> > >>
> > >> > >> I see the NVD88 code in vertcs.csv , but how would I implement
> it in
> > >> the
> > >> > >> above command?
> > >> > >>
> > >> > >> Using gdal 2.0 Beta2
> > >> > >>
> > >> > >>
> > >> > >> Doug
> > >> > >> --
> > >> > >> Doug Newcomb
> > >> > >> USFWS
> > >> > >> Raleigh, NC
> > >> > >> 919-856-4520 ext. 14 doug_newcomb at fws.gov <mailto:
> > >> doug_newcomb at fws.gov>
> > >> > >>
> > >> > >>
> > >> >
> > >>
> > >>
> >
>
> ---------------------------------------------------------------------------------------------------------
> > >> > >> The opinions I express are my own and are not representative of
> the
> > >> > >> official policy of the U.S.Fish and Wildlife Service or Dept. of
> the
> > >> > >> Interior.   Life is too short for undocumented, proprietary data
> > >> formats.
> > >> > >>
> > >> > >>
> > >> > >> _______________________________________________
> > >> > >> gdal-dev mailing list
> > >> > >> gdal-dev at lists.osgeo.org
> > >> > >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >> > >>
> > >> > >>
> > >> > >
> > >> >
> > >> >
> > >> > --
> > >> > Doug Newcomb
> > >> > USFWS
> > >> > Raleigh, NC
> > >> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> > >> >
> > >>
> > >>
> >
>
> ---------------------------------------------------------------------------------------------------------
> > >> > The opinions I express are my own and are not representative of the
> > >> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > >> > Interior.   Life is too short for undocumented, proprietary data
> > >> formats.
> > >> >
> > >>
> > >>
> > >> --
> > >> Spatialys - Geospatial professional services
> > >> http://www.spatialys.com
> > >>
> > >
> > >
> > >
> > > --
> > > Doug Newcomb
> > > USFWS
> > > Raleigh, NC
> > > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> > >
> > >
> >
>
> ---------------------------------------------------------------------------------------------------------
> > > The opinions I express are my own and are not representative of the
> > > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > > Interior.   Life is too short for undocumented, proprietary data
> formats.
> > >
> >
> >
> >
> > --
> > Doug Newcomb
> > USFWS
> > Raleigh, NC
> > 919-856-4520 ext. 14 doug_newcomb at fws.gov
> >
>
> ---------------------------------------------------------------------------------------------------------
> > The opinions I express are my own and are not representative of the
> > official policy of the U.S.Fish and Wildlife Service or Dept. of the
> > Interior.   Life is too short for undocumented, proprietary data formats.
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150609/b7c4578b/attachment-0001.html>

From gane.prog at gmail.com  Tue Jun  9 19:18:15 2015
From: gane.prog at gmail.com (Gane R)
Date: Wed, 10 Jun 2015 07:48:15 +0530
Subject: [gdal-dev] Creating a transparent GeoTIFF,
 writing shape data over it,
 reading GeoTIFF writing as PNG with transparency.
Message-ID: <CALMrLdAk6eLYvgYpaSDyT2OjqnJtCQn2LCKGOyhSLgJ6vXuyBA@mail.gmail.com>

1. Can I create a transparent GeoTIFF like PNG with alpha channel ?

2. Can I used gdal_rasterize to draw shape over the GeoTIFF with
tranparency

3. Can I read a part of the GeoTIFF using GDALRasterIO and write as PNG
with the same transparency preserved.

Say some kind of work flow with gdal command line tools will be of great
help.

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150610/0cea53f8/attachment.html>

From gane.prog at gmail.com  Tue Jun  9 19:45:07 2015
From: gane.prog at gmail.com (Gane R)
Date: Wed, 10 Jun 2015 08:15:07 +0530
Subject: [gdal-dev] Compute GeoTransform
Message-ID: <CALMrLdBE9mJPrz9sQi3k08ZrUyuG44L9GHYA1GY3qZH1jThh5A@mail.gmail.com>

With Lat Long bound values how do create a geotransform for WGS84 GeoTIFF

I followed this link

https://trac.osgeo.org/gdal/wiki/FAQRaster#HowcanIcreateablankrasterbasedonavectorfilesextentsforusewithgdal_rasterizeGDAL1.8.0

or how do I use the -tr option for WGS84, GeoTIFF I want to have high
resolution image.

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150610/fd032f2e/attachment.html>

From apacker at biosonicsinc.com  Wed Jun 10 10:01:01 2015
From: apacker at biosonicsinc.com (apacker)
Date: Wed, 10 Jun 2015 10:01:01 -0700 (PDT)
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <201506010917.02123.even.rouault@spatialys.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
	<201505261038.10033.even.rouault@spatialys.com>
	<55643841.7060503@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
	<55681116.9050800@gmail.com>
	<201505291052.51428.even.rouault@spatialys.com>
	<556BF20B.20205@gmail.com>
	<201506010917.02123.even.rouault@spatialys.com>
Message-ID: <1433955661666-5210216.post@n6.nabble.com>

Hello,

I am new to GDAL, and SWIG.  I spent yesterday getting GDAL 1.11.2 compiled
and ran into similar errors trying to build the C# bindings as are being
discussed on this thread.  I am on Windows (7 Pro SP1 x64) using Visual
Studio 2013's command prompt.  I am using the current version of swigwin,
3.0.5.

FWIW, I was able to fix the errors by making the following changes.  Since I
don't really understand what SWIG is doing very well, I'm not sure how safe
these are, although they seem fairly minor.  I apologize if this has already
been discussed somewhere else - I'm reporting them just in case they are
helpful.

1. Change line 95 of
gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i from

to


This fixes errors saying that the upcast function does not exist.  These
errors happen starting with SWIG 2.0.0.

2. Delete lines 12-17 of
gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i - this fixes the
duplicate static constructor error CS0111.  This error is related to the
following entry from the SWIG changelog http://www.swig.org/Release/CHANGES. 
The change was first released in SWIG 2.0.0.



3. Add the "-DSWIG2_CSHARP" flag to my SWIG variable in
gdal-1.11.2/nmake.local.  This fixes numerous errors about basic .NET types
like IntPtr not being defined.  This is related to the following entry from
the SWIG changelog, first released in version 3.0.0:



Thanks!  I appreciate all the work that you and others have done to make
GDAL so nice.

Asa




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-CSharp-bindings-question-tp5207528p5210216.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From apacker at biosonicsinc.com  Wed Jun 10 11:07:10 2015
From: apacker at biosonicsinc.com (Asa Packer)
Date: Wed, 10 Jun 2015 11:07:10 -0700
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <1433955661666-5210216.post@n6.nabble.com>
References: <55642437.2040603@gmail.com>	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>	<201505261038.10033.even.rouault@spatialys.com>	<55643841.7060503@gmail.com>	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>	<55681116.9050800@gmail.com>	<201505291052.51428.even.rouault@spatialys.com>	<556BF20B.20205@gmail.com>	<201506010917.02123.even.rouault@spatialys.com>
	<1433955661666-5210216.post@n6.nabble.com>
Message-ID: <012101d0a3a8$45d36720$d17a3560$@biosonicsinc.com>

Hello again,

Sorry, I posted this using the Nabble gateway, and the text I formatted as
raw text did not come through correctly in email.  Here is another try.

-Asa
---
Hello, 

I am new to GDAL, and SWIG.  I spent yesterday getting GDAL 1.11.2 compiled
and ran into similar errors trying to build the C# bindings as are being
discussed on this thread.  I am on Windows (7 Pro SP1 x64) using Visual
Studio 2013's command prompt.  I am using the current version of swigwin,
3.0.5. 

FWIW, I was able to fix the errors by making the following changes.  Since I
don't really understand what SWIG is doing very well, I'm not sure how safe
these are, although they seem fairly minor.  I apologize if this has already
been discussed somewhere else - I'm reporting them just in case they are
helpful. 

1. Change line 95 of
gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i from 
  public $csclassname(IntPtr cPtr, bool cMemoryOwn, object parent) :
base($modulePINVOKE.$csclassnameUpcast(cPtr), cMemoryOwn, parent) {
to 
  public $csclassname(IntPtr cPtr, bool cMemoryOwn, object parent) :
base($modulePINVOKE.$csclassname_SWIGUpcast(cPtr), cMemoryOwn, parent) {

This fixes errors saying that the upcast function does not exist.  These
errors happen starting with SWIG 2.0.0. 

2. Delete lines 12-17 of
gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i - this fixes the
duplicate static constructor error CS0111.  This error is related to the
following entry from the SWIG changelog http://www.swig.org/Release/CHANGES.
The change was first released in SWIG 2.0.0. 

2010-05-23: wsfulton
            [C#] Fix #2957375 - SWIGStringHelper and SWIGExceptionHelper not
always being
            initialized before use in .NET 4 as the classes were not marked
beforefieldinit.
            A static constructor has been added to the intermediary class
like this:

              %pragma(csharp) imclasscode=%{
                static $imclassname() {
                }
              %}

            If you had added your own custom static constructor to the
intermediary class in
            the same way as above, you will have to modify your approach to
use static variable
            initialization or define
SWIG_CSHARP_NO_IMCLASS_STATIC_CONSTRUCTOR - See csharphead.swg.

	    *** POTENTIAL INCOMPATIBILITY ***

3. Add the "-DSWIG2_CSHARP" flag to my SWIG variable in
gdal-1.11.2/nmake.local.  This fixes numerous errors about basic .NET types
like IntPtr not being defined.  This is related to the following entry from
the SWIG changelog, first released in version 3.0.0: 

2013-11-09: wsfulton
            [C#] Apply patch #79 from Brant Kyser
              - Remove using directives from the generated C# code and fully
qualify the use of all .NET
                framework types in order to minimize potential name
collisions from input files defining
                types, namespace, etc with the same name as .NET framework
members.
              - Globally qualify the use of .NET framework types in the
System namespace
              - Remove .NET 1.1 support, .NET 2 is the minimum for the C#
module

            This is a potential backwards compatibility break if code has
been added relying on these using
            statements that used to be generated:

              using System;
              using System.Runtime.InteropServices;

            The quick fix to add these back in is to add the -DSWIG2_CSHARP
command line option when
            executing SWIG. See CSharp.html documentation for more info.

            *** POTENTIAL INCOMPATIBILITY  ***

Thanks!  I appreciate all the work that you and others have done to make
GDAL so nice. 

Asa



From szekerest at gmail.com  Wed Jun 10 12:33:20 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 10 Jun 2015 21:33:20 +0200
Subject: [gdal-dev] CSharp bindings question
In-Reply-To: <012101d0a3a8$45d36720$d17a3560$@biosonicsinc.com>
References: <55642437.2040603@gmail.com>
	<CACALY+TSL-P1ZkO+iVrTMTb2VwdOydq02x62QhAUehcnqw2M7w@mail.gmail.com>
	<201505261038.10033.even.rouault@spatialys.com>
	<55643841.7060503@gmail.com>
	<CACALY+RhWrcSQTtUxkmVZ9SKkdc5-kTvV59VzQpA=yKnZFTviw@mail.gmail.com>
	<55681116.9050800@gmail.com>
	<201505291052.51428.even.rouault@spatialys.com>
	<556BF20B.20205@gmail.com>
	<201506010917.02123.even.rouault@spatialys.com>
	<1433955661666-5210216.post@n6.nabble.com>
	<012101d0a3a8$45d36720$d17a3560$@biosonicsinc.com>
Message-ID: <CACALY+S0RZOKJoTkSqRXjO3Qyc=HswFimyi4WyOTf+BvaYLy=w@mail.gmail.com>

Hi Asa,

Thanks for the detailed investigation, I'll evaluate the result of the
changes and try to incorporate them in GDAL.

Best regards,

Tamas



2015-06-10 20:07 GMT+02:00 Asa Packer <apacker at biosonicsinc.com>:

> Hello again,
>
> Sorry, I posted this using the Nabble gateway, and the text I formatted as
> raw text did not come through correctly in email.  Here is another try.
>
> -Asa
> ---
> Hello,
>
> I am new to GDAL, and SWIG.  I spent yesterday getting GDAL 1.11.2 compiled
> and ran into similar errors trying to build the C# bindings as are being
> discussed on this thread.  I am on Windows (7 Pro SP1 x64) using Visual
> Studio 2013's command prompt.  I am using the current version of swigwin,
> 3.0.5.
>
> FWIW, I was able to fix the errors by making the following changes.  Since
> I
> don't really understand what SWIG is doing very well, I'm not sure how safe
> these are, although they seem fairly minor.  I apologize if this has
> already
> been discussed somewhere else - I'm reporting them just in case they are
> helpful.
>
> 1. Change line 95 of
> gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i from
>   public $csclassname(IntPtr cPtr, bool cMemoryOwn, object parent) :
> base($modulePINVOKE.$csclassnameUpcast(cPtr), cMemoryOwn, parent) {
> to
>   public $csclassname(IntPtr cPtr, bool cMemoryOwn, object parent) :
> base($modulePINVOKE.$csclassname_SWIGUpcast(cPtr), cMemoryOwn, parent) {
>
> This fixes errors saying that the upcast function does not exist.  These
> errors happen starting with SWIG 2.0.0.
>
> 2. Delete lines 12-17 of
> gdal-1.11.2/swig/include/csharp/swig_csharp_extensions.i - this fixes the
> duplicate static constructor error CS0111.  This error is related to the
> following entry from the SWIG changelog
> http://www.swig.org/Release/CHANGES.
> The change was first released in SWIG 2.0.0.
>
> 2010-05-23: wsfulton
>             [C#] Fix #2957375 - SWIGStringHelper and SWIGExceptionHelper
> not
> always being
>             initialized before use in .NET 4 as the classes were not marked
> beforefieldinit.
>             A static constructor has been added to the intermediary class
> like this:
>
>               %pragma(csharp) imclasscode=%{
>                 static $imclassname() {
>                 }
>               %}
>
>             If you had added your own custom static constructor to the
> intermediary class in
>             the same way as above, you will have to modify your approach to
> use static variable
>             initialization or define
> SWIG_CSHARP_NO_IMCLASS_STATIC_CONSTRUCTOR - See csharphead.swg.
>
>             *** POTENTIAL INCOMPATIBILITY ***
>
> 3. Add the "-DSWIG2_CSHARP" flag to my SWIG variable in
> gdal-1.11.2/nmake.local.  This fixes numerous errors about basic .NET types
> like IntPtr not being defined.  This is related to the following entry from
> the SWIG changelog, first released in version 3.0.0:
>
> 2013-11-09: wsfulton
>             [C#] Apply patch #79 from Brant Kyser
>               - Remove using directives from the generated C# code and
> fully
> qualify the use of all .NET
>                 framework types in order to minimize potential name
> collisions from input files defining
>                 types, namespace, etc with the same name as .NET framework
> members.
>               - Globally qualify the use of .NET framework types in the
> System namespace
>               - Remove .NET 1.1 support, .NET 2 is the minimum for the C#
> module
>
>             This is a potential backwards compatibility break if code has
> been added relying on these using
>             statements that used to be generated:
>
>               using System;
>               using System.Runtime.InteropServices;
>
>             The quick fix to add these back in is to add the -DSWIG2_CSHARP
> command line option when
>             executing SWIG. See CSharp.html documentation for more info.
>
>             *** POTENTIAL INCOMPATIBILITY  ***
>
> Thanks!  I appreciate all the work that you and others have done to make
> GDAL so nice.
>
> Asa
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150610/d1e9b0da/attachment.html>

From jamessramm at gmail.com  Thu Jun 11 00:16:04 2015
From: jamessramm at gmail.com (jramm)
Date: Thu, 11 Jun 2015 00:16:04 -0700 (PDT)
Subject: [gdal-dev] gdal_rasterize does not burn polygon attributes
Message-ID: <1434006964984-5210321.post@n6.nabble.com>

I'm running gdal_rasterize, trying to make it create a new tif from polygons,
using an attribute field as the burn value. Here is my command:

gdal_rasterize -tr 5 5 -a SOP -l test -a_nodata 0 test.shp test.tif
I end up with an image that is all 0's. The shapefile is correct and can be
read by OGR...what am I missing?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-rasterize-does-not-burn-polygon-attributes-tp5210321.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/04bbf341/attachment.html>

From mj10777 at googlemail.com  Thu Jun 11 01:46:33 2015
From: mj10777 at googlemail.com (Mark Johnson)
Date: Thu, 11 Jun 2015 10:46:33 +0200
Subject: [gdal-dev] Creating a transparent GeoTIFF,
 writing shape data over it,
 reading GeoTIFF writing as PNG with transparency.
Message-ID: <CAEEbjBh3PvC_aHCzCnnfp2pZep4Xaj1ZW+FuRfiJ+jyB-80DNA@mail.gmail.com>

I have attempted to answer Questions 1 and 3 here:

https://github.com/geopaparazzi/Spatialite-Tasks-with-Sql-Scripts/wiki/Project-1811-gdal_question

I will start on Question 2 now, since I have not used gdal_rasterize that
often.

A quick answer is however,

1)

gdal_translate -of PNG -a_nodata 192
../sources/1811.Neuester_Grundriss_von_Berlin.5800.3068.tif
1811.Neuester_Grundriss_von_Berlin.5800.3068.png

3)

gdal_translate -of PNG -a_nodata 192 -projwin 24800 21300 25800 20700
 ../sources/1811.Neuester_Grundriss_von_Berlin.5800.3068.tif
1811.Neuester_Grundriss_von_Berlin.5800.3068.area_rote_rathausturm_panorama.png

Mark Johnson, Berlin Germany
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/0962aa26/attachment.html>

From jamessramm at gmail.com  Thu Jun 11 02:37:26 2015
From: jamessramm at gmail.com (jramm)
Date: Thu, 11 Jun 2015 02:37:26 -0700 (PDT)
Subject: [gdal-dev] GDAL query creation options?
Message-ID: <1434015446821-5210356.post@n6.nabble.com>

Is there a way to programatically query what dataset creation/layer creation
options are available for a driver?I'd like to be able to do something like:
driver->listDCO(*options)




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-query-creation-options-tp5210356.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/55e33b25/attachment.html>

From even.rouault at spatialys.com  Thu Jun 11 03:58:50 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 11 Jun 2015 12:58:50 +0200
Subject: [gdal-dev] GDAL query creation options?
In-Reply-To: <1434015446821-5210356.post@n6.nabble.com>
References: <1434015446821-5210356.post@n6.nabble.com>
Message-ID: <1434020330.557969eae4ad6@imp.free.fr>

Selon jramm <jamessramm at gmail.com>:

> Is there a way to programatically query what dataset creation/layer creation
> options are available for a driver?I'd like to be able to do something like:
> driver->listDCO(*options)

driver->GetMetadataItem(GDAL_DMD_CREATIONOPTIONLIST)  for raster drivers, and
starting with GDAL 2.0, for vector drivers as well

driver->GetMetadataItem(GDAL_DS_LAYER_CREATIONOPTIONLIST) for vector drivers,
starting with GDAL 2.0

This will return a string with a XML content describing the options.

>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GDAL-query-creation-options-tp5210356.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From grb at skogoglandskap.no  Thu Jun 11 04:23:59 2015
From: grb at skogoglandskap.no (Graeme B. Bell)
Date: Thu, 11 Jun 2015 11:23:59 +0000
Subject: [gdal-dev]  Overlay shapefile onto Geotiff image
Message-ID: <41D20371-8CF1-48A5-BC4D-4744F296D94C@skogoglandskap.no>

> 
> Hi,
> I have been working on this issue for quite a while. I currently have a GeoTiff image and a shapefile. I would like to overlay the shapefile on the Geotiff, is this possible with Gdal? I looked into gdal_rasterize but I just don't know how to incorporate it with what I need. A code to start with would be great if possible. Or maybe point me into the right direction of probably other libraries that could do this.

First, turn your shapefile into a geotiff. You can do this by reading the documentation and searching google for "gdal_rasterize".
You'll need to tell it what size you want to burn. You can do that by looking at the extents (northeast, southwest) of your current raster/geotiff.

Second, overlay the 'shapefile geotiff' onto the other geotiff.
To do this, read the documentation for 

	gdal_merge.py    or     gdalwarp

Both of them can do what you want.
And look for some online articles about those tools for practical examples.

For example, read this and try to practice it: 

	http://geoinformaticstutorial.blogspot.no/2012/11/convert-shapefile-to-raster-with-gdal.html 

Graeme Bell

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 11 04:35:14 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 11 Jun 2015 11:35:14 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?gdal=5Frasterize_does_not_burn_polygon_attri?=
	=?utf-8?q?butes?=
References: <1434006964984-5210321.post@n6.nabble.com>
Message-ID: <loom.20150611T123619-270@post.gmane.org>

jramm <jamessramm <at> gmail.com> writes:

> 
> 
> I'm running gdal_rasterize, trying to make it create a new tif from
polygons, using an attribute field as the burn value. Here is my command:
> 
> gdal_rasterize -tr 5 5 -a SOP -l test -a_nodata 0 test.shp test.tif
> 
> 
> I end up with an image that is all 0's. The shapefile is correct and can
be read by OGR...what am I missing?

Hi,

We are not exactly lazy but the easier it is to study and reproduce the
issue the more probable it is that someone really does it. Next time try to
share a small sample of data as well.

Without having access to your data I digitized two polygons, added an
integer attribute "SOP" and inserted values "10" and "110".

I modified your command 

gdal_rasterize -tr 5 5 -a SOP -l burntest -a_nodata 0 burntest.jml test.tif

I was awaiting that one polygon would be burned with value 10, the other
with 110. Quit test with gdalinfo suggests that it did happen:

gdalinfo test.tif -stats
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 100, 64
Coordinate System is `'
Origin = (487.000000000000000,632.000000000000000)
Pixel Size = (5.000000000000000,-5.000000000000000)
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (     487.000,     632.000)
Lower Left  (     487.000,     312.000)
Upper Right (     987.000,     632.000)
Lower Right (     987.000,     312.000)
Center      (     737.000,     472.000)
Band 1 Block=100x10 Type=Float64, ColorInterp=Gray
  Minimum=10.000, Maximum=110.000, Mean=68.598, StdDev=49.255
  NoData Value=0
  Metadata:
    STATISTICS_MAXIMUM=110
    STATISTICS_MEAN=68.597662771285
    STATISTICS_MINIMUM=10
    STATISTICS_STDDEV=49.255255505085

Notice that datatype is Float64 which means that data range 10-110 is very
narrow when compared to full 64-bit scale.

Here is my test data in OpenJUMP JML format which is understood by GDAL 2.0.


<?xml version='1.0' encoding='UTF-8'?>
<JCSDataFile xmlns:gml="http://www.opengis.net/gml"
xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance" >
<JCSGMLInputTemplate>
<CollectionElement>featureCollection</CollectionElement> 
<FeatureElement>feature</FeatureElement>
<GeometryElement>geometry</GeometryElement>
<ColumnDefinitions>
     <column>
          <name>SOP</name>
          <type>INTEGER</type>
          <valueElement elementName="property" attributeName="name"
attributeValue="SOP"/>
          <valueLocation position="body"/>
     </column>
</ColumnDefinitions>
</JCSGMLInputTemplate>

<featureCollection>
     <feature> 
          <geometry>
                <gml:Polygon>
                  <gml:outerBoundaryIs>
                  <gml:LinearRing>
                    <gml:coordinates>487.0,631.0 
                      875.0,632.0 
                      636.0,361.0 
                      487.0,631.0 </gml:coordinates>
                  </gml:LinearRing>
                  </gml:outerBoundaryIs>
                </gml:Polygon>
          </geometry>
          <property name="SOP">10</property>
     </feature>

     <feature> 
          <geometry>
                <gml:Polygon>
                  <gml:outerBoundaryIs>
                  <gml:LinearRing>
                    <gml:coordinates>894.0,575.0 
                      668.0,313.0 
                      988.0,355.0 
                      894.0,575.0 </gml:coordinates>
                  </gml:LinearRing>
                  </gml:outerBoundaryIs>
                </gml:Polygon>
          </geometry>
          <property name="SOP">120</property>
     </feature>

     </featureCollection>
</JCSDataFile>


-Jukka Rahkonen-



From mj10777 at googlemail.com  Thu Jun 11 05:38:35 2015
From: mj10777 at googlemail.com (Mark Johnson)
Date: Thu, 11 Jun 2015 14:38:35 +0200
Subject: [gdal-dev] Creating a transparent GeoTIFF,
 writing shape data over it,
 reading GeoTIFF writing as PNG with transparency.
Message-ID: <CAEEbjBg3jhkpf-JEBAqrMWdDw2aHauE_JpuWEEGHk-4pgMdb2A@mail.gmail.com>

Question 2 is now finished:

https://github.com/geopaparazzi/Spatialite-Tasks-with-Sql-Scripts/wiki/Project-1811-gdal_question-02

Short version:

gdal_rasterize -tr 0.475211759942328 0.475212956422887 -te 24800 20700
25800 21300 -ot Byte -init 192 -a_nodata 192 -burn 0 -burn 173 -burn 83
-sql "SELECT ST_Buffer(soldner_segment,2.5) FROM segments_berlin_1786"
../sources/berlin_segments_qgis.db segments_berlin_1786_green.tif

and combine the images with
- gdalbuildvrt and gdal_translate

---

This was the first time I used gdal_rasterize and found the sample on the
htlm-page misleading
- there is no sample on creating a image that can be overlayed (i.e. create
a new image)
- the first sample, assumes one is directly overwriting another image
-- when using that sample in creating an new image it will fail, since '.b'
is not permitted in new images
- there is no sample on how to influence the width of the of the created
lines

All of this is useful for someone trying this out for the first time.

Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/0afad4ab/attachment.html>

From thomas at silentwings.no  Thu Jun 11 08:09:01 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Thu, 11 Jun 2015 17:09:01 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <1433850259.5576d193184a8@imp.free.fr>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
	<1433850259.5576d193184a8@imp.free.fr>
Message-ID: <CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>

Great, thanks!

I tried this, but got only a red image as result, so I guess only the first
channel was used.

This is the relevant code, where _ds is the input paletted data set

vrtDS = vrtDriver->Create("", origW, origH, 3, GDT_Byte, NULL);
double geoTransform[6];
_ds->GetGeoTransform(geoTransform);
vrtDS->SetGeoTransform(geoTransform);
GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());

GDALRasterBand* srcBand = _ds->GetRasterBand(1);

vrtDS->AddBand(GDT_Byte, NULL);
vrtDS->AddBand(GDT_Byte, NULL);
vrtDS->AddBand(GDT_Byte, NULL);
VRTSourcedRasterBand* vrtRBand =
(VRTSourcedRasterBand*)vrtDS->GetRasterBand(1);
VRTSourcedRasterBand* vrtGBand =
(VRTSourcedRasterBand*)vrtDS->GetRasterBand(2);
VRTSourcedRasterBand* vrtBBand =
(VRTSourcedRasterBand*)vrtDS->GetRasterBand(3);
vrtRBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
1.0, VRT_NODATA_UNSET, 1);
vrtGBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
1.0, VRT_NODATA_UNSET, 2);
vrtBBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
1.0, VRT_NODATA_UNSET, 3);

Is there anything I have missed in the setup here?

- Thomas



On Tue, Jun 9, 2015 at 1:44 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Thomas,
> >
> > I'm using the GDALWarp api from C++ to reproject and cut various input
> > images. In general this works very well for my purposes, except that for
> > paletted images I have to use NearestNeighbour resampling,
> >
> > I would like to use Bilinear or higher order resampling, and wonder if
> > there is any way to expand a paletted image to true RGB during the warp
> > process, so I can use these resampling methods.
>
> No, you must use an intermediate step before.
>
> >
> > Alternatively, is there a way to do this conversion (from code) before
> the
> > warp without having to run through the entire image in memory?
>
> You can use a in-memory VRT dataset to do on-the-fly expansion to RGB.
>
> With the AddComplexSource() method of VRTSourcedRasterBand class:
>
>     CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
>                                      int nSrcXOff=-1, int nSrcYOff=-1,
>                                      int nSrcXSize=-1, int nSrcYSize=-1,
>                                      int nDstXOff=-1, int nDstYOff=-1,
>                                      int nDstXSize=-1, int nDstYSize=-1,
>                                      double dfScaleOff=0.0,
>                                      double dfScaleRatio=1.0,
>                                      double dfNoDataValue =
> VRT_NODATA_UNSET,
>                                      int nColorTableComponent = 0);
>
> Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is what
> gdal_translate will do if you use "gdal_translate -of VRT -expand rgb
> pct.tif
> out.vrt"
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/ba8c7f03/attachment.html>

From even.rouault at spatialys.com  Thu Jun 11 08:25:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 11 Jun 2015 17:25:36 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
	<1433850259.5576d193184a8@imp.free.fr>
	<CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>
Message-ID: <1434036336.5579a870cb1a2@imp.free.fr>

Selon Thomas Sevaldrud <thomas at silentwings.no>:

> Great, thanks!
>
> I tried this, but got only a red image as result, so I guess only the first
> channel was used.
>
> This is the relevant code, where _ds is the input paletted data set
>
> vrtDS = vrtDriver->Create("", origW, origH, 3, GDT_Byte, NULL);
> double geoTransform[6];
> _ds->GetGeoTransform(geoTransform);
> vrtDS->SetGeoTransform(geoTransform);
> GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
>
> GDALRasterBand* srcBand = _ds->GetRasterBand(1);
>
> vrtDS->AddBand(GDT_Byte, NULL);
> vrtDS->AddBand(GDT_Byte, NULL);
> vrtDS->AddBand(GDT_Byte, NULL);

You don't need the above 3 AddBand() since you called Create() with 3 already

> VRTSourcedRasterBand* vrtRBand =
> (VRTSourcedRasterBand*)vrtDS->GetRasterBand(1);
> VRTSourcedRasterBand* vrtGBand =
> (VRTSourcedRasterBand*)vrtDS->GetRasterBand(2);
> VRTSourcedRasterBand* vrtBBand =
> (VRTSourcedRasterBand*)vrtDS->GetRasterBand(3);
> vrtRBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> 1.0, VRT_NODATA_UNSET, 1);
> vrtGBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> 1.0, VRT_NODATA_UNSET, 2);
> vrtBBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> 1.0, VRT_NODATA_UNSET, 3);
>
> Is there anything I have missed in the setup here?

Looks good otherwise. Did you check that you configured properly the warper to
use the 3 bands of the VRT ?
>
> - Thomas
>
>
>
> On Tue, Jun 9, 2015 at 1:44 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> > Thomas,
> > >
> > > I'm using the GDALWarp api from C++ to reproject and cut various input
> > > images. In general this works very well for my purposes, except that for
> > > paletted images I have to use NearestNeighbour resampling,
> > >
> > > I would like to use Bilinear or higher order resampling, and wonder if
> > > there is any way to expand a paletted image to true RGB during the warp
> > > process, so I can use these resampling methods.
> >
> > No, you must use an intermediate step before.
> >
> > >
> > > Alternatively, is there a way to do this conversion (from code) before
> > the
> > > warp without having to run through the entire image in memory?
> >
> > You can use a in-memory VRT dataset to do on-the-fly expansion to RGB.
> >
> > With the AddComplexSource() method of VRTSourcedRasterBand class:
> >
> >     CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
> >                                      int nSrcXOff=-1, int nSrcYOff=-1,
> >                                      int nSrcXSize=-1, int nSrcYSize=-1,
> >                                      int nDstXOff=-1, int nDstYOff=-1,
> >                                      int nDstXSize=-1, int nDstYSize=-1,
> >                                      double dfScaleOff=0.0,
> >                                      double dfScaleRatio=1.0,
> >                                      double dfNoDataValue =
> > VRT_NODATA_UNSET,
> >                                      int nColorTableComponent = 0);
> >
> > Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is what
> > gdal_translate will do if you use "gdal_translate -of VRT -expand rgb
> > pct.tif
> > out.vrt"
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert at interactive.co.uk  Thu Jun 11 10:06:54 2015
From: robert at interactive.co.uk (Robert Inder)
Date: Thu, 11 Jun 2015 18:06:54 +0100
Subject: [gdal-dev] PostgreSQL drivers
Message-ID: <CAKqjJm_r1tYspLj8ttO4Z6yOb59k5mWpW4wz5wDDtagDY2U1LA@mail.gmail.com>

I have PostgreSQL 9.4 running on a 64-bit Centos 6.4 machine,  I have
then used "yum" to install
    gdal.x86_64            1.9.2-6.rhel6
    gdal-devel.x86_64      1.9.2-6.rhel6
    gdal-java.x86_64       1.9.2-6.rhel6
    gdal-libs.x86_64       1.9.2-6.rhel6
all from the pgdg94 repository.  And when I do
   ogr2ogr --formats | grep "Post"
I get
  -> "PostgreSQL" (read/write)

I also a 32-bit Centos 6.4 machine, on which I have used to remove
PostgreSQL 8.4 and install PostgreSQL 9.4.  I have then used "yum" to
install
    gdal.i686                        1.9.2-6.rhel6
    gdal-devel.i686                  1.9.2-6.rhel6
    gdal-java.i686                   1.9.2-6.rhel6
    gdal-libs.i686                   1.9.2-6.rhel6
again all from the pgdg94 repository.  But ogr2ogr is unable to
connect to the database.  When I do
   ogr2ogr --formats | grep "Post"
I get nothing.

It LOOKS like the 32-bit gdal packages from the pgdg94 repository do
not have PostgreSQL drivers.  Which makes no sense to me, given that I
believe that the pgdg94 is maintained by the Postgres project.

How do I track down what has gone wrong and fix it?


Robert

-- 
Robert Inder,                                    0131 229 1052 / 07808 492 213
Interactive Information Ltd,   3, Lauriston Gardens, Edinburgh EH3 9HH
Registered in Scotland, Company no. SC 150689
                                           Interactions speak louder than words

From ari.ucb.fire at gmail.com  Thu Jun 11 14:26:49 2015
From: ari.ucb.fire at gmail.com (Ari Simmons)
Date: Thu, 11 Jun 2015 14:26:49 -0700
Subject: [gdal-dev] gdalwarp on a .vrt: Using internal nodata values (eg 0)
	for image (?)
Message-ID: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>

I am experimenting with using 'gdalwarp' on a .vrt (first time), but I'm
not sure what I'm doing wrong. I've been running this:

>> gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -of VRT
merged.vrt srtm_merged_3857.vrt

and it processes fast (far far *too fast* for this global file) and returns

>> Creating output file that is 194835P X 479814L.
>> Processing input file merged.vrt
>> Using internal nodata values (eg. 0) for image merged.vrt

The return .vrt file definitely doesn't appear right...a quick look at the
returned file:

input:

Size is 432000, 208800
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-180.000416666666670,84.000416666666666)
Pixel Size = (0.000833333333323,-0.000833333333323)
Corner Coordinates:
Upper Left  (-180.0004167,  84.0004167) (180d 0' 1.50"W, 84d 0' 1.50"N)
Lower Left  (-180.0004167, -89.9995833) (180d 0' 1.50"W, 89d59'58.50"S)
Upper Right ( 179.9995833,  84.0004167) (179d59'58.50"E, 84d 0' 1.50"N)
Lower Right ( 179.9995833, -89.9995833) (179d59'58.50"E, 89d59'58.50"S)
Center      (  -0.0004167,  -2.9995833) (  0d 0' 1.50"W,  2d59'58.50"S)
Band 1 Block=128x128 Type=Int16, ColorInterp=Gray
  NoData Value=0
  Overviews: 216000x104400, 108000x52200, 54000x26100, 27000x13050,
13500x6525,
6750x3263, 3375x1632, 1688x816, 844x408, 422x204

and output file:

 Size is 193861,
479814                                                          Coordinate
System is:
PROJCS["WGS 84 /
Pseudo-Mercator",
GEOGCS["WGS
84",
DATUM["WGS_1984",
SPHEROID["WGS
84",6378137,298.257223563,
AUTHORITY["EPSG","7030"]],
AUTHORITY["EPSG","6326"]],
PRIMEM["Greenwich",0,
AUTHORITY["EPSG","8901"]],
UNIT["degree",0.0174532925199433,
AUTHORITY["EPSG","9122"]],
AUTHORITY["EPSG","4326"]],
PROJECTION["Mercator_1SP"],
PARAMETER["central_meridian",0],
PARAMETER["scale_factor",1],
PARAMETER["false_easting",0],
PARAMETER["false_northing",0],
UNIT["metre",1,
AUTHORITY["EPSG","9001"]],
AXIS["X",EAST],
AXIS["Y",NORTH],
EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
+x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
+no_defs"],
AUTHORITY["EPSG","3857"]]
Origin =
(-19837179.642485119000000,18807657.848855246000000)
Pixel Size =
(205.686440189378940,-205.686440189378940)                         Corner
Coordinates:
Upper Left  (-19837179.642,18807657.849) (178d12' 1.50"W, 84d 0'
1.50"N)        Lower Left  (-19837179.642,-79883575.764) (178d12' 1.50"W,
89d59'58.50"S)       Upper Right (20037399.339,18807657.849)
(179d59'56.47"E, 84d 0' 1.50"N)         Lower Right
(20037399.339,-79883575.764) (179d59'56.47"E, 89d59'58.50"S)
Center      (  100109.848,-30537958.958) (  0d53'57.49"E, 89d
2'43.78"S)        Band 1 Block=512x128 Type=Int16,
ColorInterp=Gray                                 Overviews: 96931x239907,
48466x119954, 24233x59977, 12117x29989, 6059x14995, 3030x7498, 1515x3749,
758x1875, 379x938, 191x471

One notably huge difference is that there is a huge jump in pixel size
(from 0.000833333333323 to 205.686440189378940)...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/b4deb5f1/attachment.html>

From ari.ucb.fire at gmail.com  Thu Jun 11 14:38:47 2015
From: ari.ucb.fire at gmail.com (Ari Simmons)
Date: Thu, 11 Jun 2015 14:38:47 -0700
Subject: [gdal-dev] gdalwarp on a .vrt: Using internal nodata values (eg
	0) for image (?)
In-Reply-To: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>
References: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>
Message-ID: <CAJxqeBudX82rQdEtDRY320GNP17S5VEf5LFbCsJQ1hA86ND1Rg@mail.gmail.com>

One notably huge difference is that there is a huge jump in pixel size
(from 0.000833333333323 to 205.686440189378940)...

ah, duh. Unit change.

On Thu, Jun 11, 2015 at 2:26 PM, Ari Simmons <ari.ucb.fire at gmail.com> wrote:

> I am experimenting with using 'gdalwarp' on a .vrt (first time), but I'm
> not sure what I'm doing wrong. I've been running this:
>
> >> gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -of VRT
> merged.vrt srtm_merged_3857.vrt
>
> and it processes fast (far far *too fast* for this global file) and returns
>
> >> Creating output file that is 194835P X 479814L.
> >> Processing input file merged.vrt
> >> Using internal nodata values (eg. 0) for image merged.vrt
>
> The return .vrt file definitely doesn't appear right...a quick look at the
> returned file:
>
> input:
>
> Size is 432000, 208800
> Coordinate System is:
> GEOGCS["WGS 84",
>     DATUM["WGS_1984",
>         SPHEROID["WGS 84",6378137,298.257223563,
>             AUTHORITY["EPSG","7030"]],
>         AUTHORITY["EPSG","6326"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4326"]]
> Origin = (-180.000416666666670,84.000416666666666)
> Pixel Size = (0.000833333333323,-0.000833333333323)
> Corner Coordinates:
> Upper Left  (-180.0004167,  84.0004167) (180d 0' 1.50"W, 84d 0' 1.50"N)
> Lower Left  (-180.0004167, -89.9995833) (180d 0' 1.50"W, 89d59'58.50"S)
> Upper Right ( 179.9995833,  84.0004167) (179d59'58.50"E, 84d 0' 1.50"N)
> Lower Right ( 179.9995833, -89.9995833) (179d59'58.50"E, 89d59'58.50"S)
> Center      (  -0.0004167,  -2.9995833) (  0d 0' 1.50"W,  2d59'58.50"S)
> Band 1 Block=128x128 Type=Int16, ColorInterp=Gray
>   NoData Value=0
>   Overviews: 216000x104400, 108000x52200, 54000x26100, 27000x13050,
> 13500x6525,
> 6750x3263, 3375x1632, 1688x816, 844x408, 422x204
>
> and output file:
>
>  Size is 193861,
> 479814                                                          Coordinate
> System is:
> PROJCS["WGS 84 /
> Pseudo-Mercator",
> GEOGCS["WGS
> 84",
> DATUM["WGS_1984",
> SPHEROID["WGS
> 84",6378137,298.257223563,
> AUTHORITY["EPSG","7030"]],
> AUTHORITY["EPSG","6326"]],
> PRIMEM["Greenwich",0,
> AUTHORITY["EPSG","8901"]],
> UNIT["degree",0.0174532925199433,
> AUTHORITY["EPSG","9122"]],
> AUTHORITY["EPSG","4326"]],
> PROJECTION["Mercator_1SP"],
> PARAMETER["central_meridian",0],
> PARAMETER["scale_factor",1],
> PARAMETER["false_easting",0],
> PARAMETER["false_northing",0],
> UNIT["metre",1,
> AUTHORITY["EPSG","9001"]],
> AXIS["X",EAST],
> AXIS["Y",NORTH],
> EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
> +no_defs"],
> AUTHORITY["EPSG","3857"]]
> Origin =
> (-19837179.642485119000000,18807657.848855246000000)
> Pixel Size =
> (205.686440189378940,-205.686440189378940)                         Corner
> Coordinates:
> Upper Left  (-19837179.642,18807657.849) (178d12' 1.50"W, 84d 0'
> 1.50"N)        Lower Left  (-19837179.642,-79883575.764) (178d12' 1.50"W,
> 89d59'58.50"S)       Upper Right (20037399.339,18807657.849)
> (179d59'56.47"E, 84d 0' 1.50"N)         Lower Right
> (20037399.339,-79883575.764) (179d59'56.47"E, 89d59'58.50"S)
> Center      (  100109.848,-30537958.958) (  0d53'57.49"E, 89d
> 2'43.78"S)        Band 1 Block=512x128 Type=Int16,
> ColorInterp=Gray                                 Overviews: 96931x239907,
> 48466x119954, 24233x59977, 12117x29989, 6059x14995, 3030x7498, 1515x3749,
> 758x1875, 379x938, 191x471
>
> One notably huge difference is that there is a huge jump in pixel size
> (from 0.000833333333323 to 205.686440189378940)...
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150611/31e59be7/attachment-0001.html>

From eadam at co.lincoln.or.us  Thu Jun 11 15:08:00 2015
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Thu, 11 Jun 2015 15:08:00 -0700
Subject: [gdal-dev] gdalwarp on a .vrt: Using internal nodata values (eg
 0) for image (?)
In-Reply-To: <CAJxqeBudX82rQdEtDRY320GNP17S5VEf5LFbCsJQ1hA86ND1Rg@mail.gmail.com>
References: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>
	<CAJxqeBudX82rQdEtDRY320GNP17S5VEf5LFbCsJQ1hA86ND1Rg@mail.gmail.com>
Message-ID: <CACqBkM9Frsjpp=NAVxjg8PiPxBj-7uY_FTPEH_7-pZv9XbSueQ@mail.gmail.com>

On Thu, Jun 11, 2015 at 2:38 PM, Ari Simmons <ari.ucb.fire at gmail.com> wrote:
> One notably huge difference is that there is a huge jump in pixel size (from
> 0.000833333333323 to 205.686440189378940)...
>
> ah, duh. Unit change.
>
> On Thu, Jun 11, 2015 at 2:26 PM, Ari Simmons <ari.ucb.fire at gmail.com> wrote:
>>
>> I am experimenting with using 'gdalwarp' on a .vrt (first time), but I'm
>> not sure what I'm doing wrong. I've been running this:
>>
>> >> gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -of VRT
>> >> merged.vrt srtm_merged_3857.vrt
>>
>> and it processes fast (far far *too fast* for this global file) and
>> returns

That is the right speed (~0 seconds) and disk space (~0MB).  That is
because it doesn't actually do anything except write down notes of
what it would have done (and will do in the future if you ask for it).
I like testing large VRT files by outputting a subwindow tif like
this:

gdal_translate -13813007 5569641 -13809113 5572598
srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800

If things look good on the subwindow, then it is time for all the I/O
waiting, processor cycles, and storage space.  Evaluating a few
places, especially where tiles come together can find things early
without all the wait.

HTH, Eli

>>
>> >> Creating output file that is 194835P X 479814L.
>> >> Processing input file merged.vrt
>> >> Using internal nodata values (eg. 0) for image merged.vrt
>>
>> The return .vrt file definitely doesn't appear right...a quick look at the
>> returned file:
>>
>> input:
>>
>> Size is 432000, 208800
>> Coordinate System is:
>> GEOGCS["WGS 84",
>>     DATUM["WGS_1984",
>>         SPHEROID["WGS 84",6378137,298.257223563,
>>             AUTHORITY["EPSG","7030"]],
>>         AUTHORITY["EPSG","6326"]],
>>     PRIMEM["Greenwich",0],
>>     UNIT["degree",0.0174532925199433],
>>     AUTHORITY["EPSG","4326"]]
>> Origin = (-180.000416666666670,84.000416666666666)
>> Pixel Size = (0.000833333333323,-0.000833333333323)
>> Corner Coordinates:
>> Upper Left  (-180.0004167,  84.0004167) (180d 0' 1.50"W, 84d 0' 1.50"N)
>> Lower Left  (-180.0004167, -89.9995833) (180d 0' 1.50"W, 89d59'58.50"S)
>> Upper Right ( 179.9995833,  84.0004167) (179d59'58.50"E, 84d 0' 1.50"N)
>> Lower Right ( 179.9995833, -89.9995833) (179d59'58.50"E, 89d59'58.50"S)
>> Center      (  -0.0004167,  -2.9995833) (  0d 0' 1.50"W,  2d59'58.50"S)
>> Band 1 Block=128x128 Type=Int16, ColorInterp=Gray
>>   NoData Value=0
>>   Overviews: 216000x104400, 108000x52200, 54000x26100, 27000x13050,
>> 13500x6525,
>> 6750x3263, 3375x1632, 1688x816, 844x408, 422x204
>>
>> and output file:
>>
>>  Size is 193861, 479814
>> Coordinate System is:
>> PROJCS["WGS 84 / Pseudo-Mercator",
>> GEOGCS["WGS 84",
>> DATUM["WGS_1984",
>> SPHEROID["WGS 84",6378137,298.257223563,
>> AUTHORITY["EPSG","7030"]],
>> AUTHORITY["EPSG","6326"]],
>> PRIMEM["Greenwich",0,
>> AUTHORITY["EPSG","8901"]],
>> UNIT["degree",0.0174532925199433,
>> AUTHORITY["EPSG","9122"]],
>> AUTHORITY["EPSG","4326"]],
>> PROJECTION["Mercator_1SP"],
>> PARAMETER["central_meridian",0],
>> PARAMETER["scale_factor",1],
>> PARAMETER["false_easting",0],
>> PARAMETER["false_northing",0],
>> UNIT["metre",1,
>> AUTHORITY["EPSG","9001"]],
>> AXIS["X",EAST],
>> AXIS["Y",NORTH],
>> EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
>> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
>> AUTHORITY["EPSG","3857"]]
>> Origin = (-19837179.642485119000000,18807657.848855246000000)
>> Pixel Size = (205.686440189378940,-205.686440189378940)
>> Corner Coordinates:
>> Upper Left  (-19837179.642,18807657.849) (178d12' 1.50"W, 84d 0' 1.50"N)
>> Lower Left  (-19837179.642,-79883575.764) (178d12' 1.50"W, 89d59'58.50"S)
>> Upper Right (20037399.339,18807657.849) (179d59'56.47"E, 84d 0' 1.50"N)
>> Lower Right (20037399.339,-79883575.764) (179d59'56.47"E, 89d59'58.50"S)
>> Center      (  100109.848,-30537958.958) (  0d53'57.49"E, 89d 2'43.78"S)
>> Band 1 Block=512x128 Type=Int16, ColorInterp=Gray
>> Overviews: 96931x239907, 48466x119954, 24233x59977, 12117x29989, 6059x14995,
>> 3030x7498, 1515x3749, 758x1875, 379x938, 191x471
>>
>> One notably huge difference is that there is a huge jump in pixel size
>> (from 0.000833333333323 to 205.686440189378940)...
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Roger.Bivand at nhh.no  Thu Jun 11 22:19:30 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 12 Jun 2015 07:19:30 +0200
Subject: [gdal-dev] is there a vector testfile with Integer64 values?
Message-ID: <alpine.LFD.2.11.1506120714380.21102@reclus.nhh.no>

Hi,

In adapting rgdal for GDAL 2.0.0, it would be useful to know that 
clamping, etc, and workarounds for integers in Integer64 fields that 
exceed INT_MAX or INT_MIN actually work. Which of the autotest vector 
files include Integer64 fields that test reading with Integer or String? 
The files I see mostly test error trapping, so an indication of where to 
look would be very valuable. Best with common drivers.

Thanks in advance,

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From cavallini at faunalia.it  Fri Jun 12 00:37:08 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Fri, 12 Jun 2015 09:37:08 +0200
Subject: [gdal-dev] Files without .dxf extension result invalid
Message-ID: <557A8C24.7090701@faunalia.it>

See details at: http://hub.qgis.org/issues/9547
with sample data.
Should I open a ticket?
Thanks.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From even.rouault at spatialys.com  Fri Jun 12 01:02:57 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 10:02:57 +0200
Subject: [gdal-dev] Files without .dxf extension result invalid
In-Reply-To: <557A8C24.7090701@faunalia.it>
References: <557A8C24.7090701@faunalia.it>
Message-ID: <1434096177.557a923142ce8@imp.free.fr>

Hi Paolo,

> See details at: http://hub.qgis.org/issues/9547
> with sample data.

Yes, the DXF driver currently uses the .dxf extension as the only criterion to
determine if a file is DXF or not.

> Should I open a ticket?

Yes, the driver could possibily be improved to also look at the first lines and
guess if they look like valid DXF. Although it must be extremely uncommon to
have dxf files without .dxf extension.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun 12 01:07:48 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 10:07:48 +0200
Subject: [gdal-dev] is there a vector testfile with Integer64 values?
In-Reply-To: <alpine.LFD.2.11.1506120714380.21102@reclus.nhh.no>
References: <alpine.LFD.2.11.1506120714380.21102@reclus.nhh.no>
Message-ID: <1434096468.557a935408129@imp.free.fr>

Selon Roger Bivand <Roger.Bivand at nhh.no>:

> Hi,
>
> In adapting rgdal for GDAL 2.0.0, it would be useful to know that
> clamping, etc, and workarounds for integers in Integer64 fields that
> exceed INT_MAX or INT_MIN actually work. Which of the autotest vector
> files include Integer64 fields that test reading with Integer or String?
> The files I see mostly test error trapping, so an indication of where to
> look would be very valuable. Best with common drivers.

Roger,

you can simply try with

test.csvt:
Integer,Integer64

test.csv:
id,val
1,987654321

if you use GetFieldAsInteger(), it will be clamped to INT_MAX + a CE_Warning
if you use GetFieldAsString(), it will return "987654321" as expected

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Fri Jun 12 01:51:12 2015
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Fri, 12 Jun 2015 10:51:12 +0200
Subject: [gdal-dev] Files without .dxf extension result invalid
In-Reply-To: <1434096177.557a923142ce8@imp.free.fr>
References: <557A8C24.7090701@faunalia.it>
	<1434096177.557a923142ce8@imp.free.fr>
Message-ID: <557A9D80.1000502@faunalia.it>

Il 12/06/2015 10:02, Even Rouault ha scritto:

> Yes, the driver could possibily be improved to also look at the first lines and
> guess if they look like valid DXF. Although it must be extremely uncommon to
> have dxf files without .dxf extension.

thanks, done.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html

From Roger.Bivand at nhh.no  Fri Jun 12 02:42:50 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 12 Jun 2015 11:42:50 +0200
Subject: [gdal-dev] is there a vector testfile with Integer64 values?
In-Reply-To: <1434096468.557a935408129@imp.free.fr>
References: <alpine.LFD.2.11.1506120714380.21102@reclus.nhh.no>
	<1434096468.557a935408129@imp.free.fr>
Message-ID: <alpine.LFD.2.11.1506121141430.22331@reclus.nhh.no>

On Fri, 12 Jun 2015, Even Rouault wrote:

> Selon Roger Bivand <Roger.Bivand at nhh.no>:
>
>> Hi,
>>
>> In adapting rgdal for GDAL 2.0.0, it would be useful to know that
>> clamping, etc, and workarounds for integers in Integer64 fields that
>> exceed INT_MAX or INT_MIN actually work. Which of the autotest vector
>> files include Integer64 fields that test reading with Integer or String?
>> The files I see mostly test error trapping, so an indication of where to
>> look would be very valuable. Best with common drivers.
>
> Roger,
>
> you can simply try with
>
> test.csvt:
> Integer,Integer64
>
> test.csv:
> id,val
> 1,987654321
>
> if you use GetFieldAsInteger(), it will be clamped to INT_MAX + a CE_Warning
> if you use GetFieldAsString(), it will return "987654321" as expected

OK, thanks - I though that there might have been something in autotests.

Best wishes,

Roger

>
> Even
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From thomas at silentwings.no  Fri Jun 12 03:18:44 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Fri, 12 Jun 2015 12:18:44 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <1434036336.5579a870cb1a2@imp.free.fr>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
	<1433850259.5576d193184a8@imp.free.fr>
	<CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>
	<1434036336.5579a870cb1a2@imp.free.fr>
Message-ID: <CAJSDX1gthThvXMcTCKaTONBG9CxeaZKbkEHrcO20z3my=2pG1Q@mail.gmail.com>

Thanks again! The problem was in the warper setup, it used only the first
band of the image. This also revealed a bug in another part of my code
related to VRT's and Warp, since I had added double sets of bands there as
well. However, when fixing this, some old code stopped working :-)

Basically, my problem is that I want to reproject an RGB image which may be
the VRT I made above, or another RGB(A) image, into  an output RGBA. If I
don't have an input alpha channel, I still want the output to have alpha,
and I want any borders that result from the reprojection to have alpha = 0.
What is the correct way of setting up this? Currently I set up the bands
like this:

warpOptions->nBandCount = srcNumBands;

warpOptions->panSrcBands =
(int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));
warpOptions->panDstBands =
(int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));

warpOptions->padfSrcNoDataReal =
(double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
warpOptions->padfSrcNoDataImag =
(double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));

warpOptions->padfDstNoDataReal =
(double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
warpOptions->padfDstNoDataImag =
(double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));

for (int j = 0; j < warpOptions->nBandCount; j++)
{
warpOptions->panSrcBands[j] = j+1;
warpOptions->panDstBands[j] = j+1;

warpOptions->padfSrcNoDataReal[j] = _srcNodata;
warpOptions->padfSrcNoDataImag[j] = 0.0;

warpOptions->padfDstNoDataReal[j] = _nodata;
warpOptions->padfDstNoDataImag[j] = 0.0;
}

if (srcNumBands == 4)
warpOptions->nSrcAlphaBand = 4;

if (dstNumBands == 4)
warpOptions->nDstAlphaBand = 4;

char **papszWarpOptions = NULL;
papszWarpOptions = CSLSetNameValue(papszWarpOptions, "INIT_DEST", "NO_DATA"
);

In some cases this works, but in others I get only a black image after the
warp. So my question is basically if the above code should have worked. My
assumption here is that the GDAL Warper will regard all input pixels as
having full opacity when no alpha channel is specified, and that output
alpha is initialized to 0. Are these valid assumptions, or do I need to
create an alpha channel in the input image as well?

- Thomas

On Thu, Jun 11, 2015 at 5:25 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon Thomas Sevaldrud <thomas at silentwings.no>:
>
> > Great, thanks!
> >
> > I tried this, but got only a red image as result, so I guess only the
> first
> > channel was used.
> >
> > This is the relevant code, where _ds is the input paletted data set
> >
> > vrtDS = vrtDriver->Create("", origW, origH, 3, GDT_Byte, NULL);
> > double geoTransform[6];
> > _ds->GetGeoTransform(geoTransform);
> > vrtDS->SetGeoTransform(geoTransform);
> > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> >
> > GDALRasterBand* srcBand = _ds->GetRasterBand(1);
> >
> > vrtDS->AddBand(GDT_Byte, NULL);
> > vrtDS->AddBand(GDT_Byte, NULL);
> > vrtDS->AddBand(GDT_Byte, NULL);
>
> You don't need the above 3 AddBand() since you called Create() with 3
> already
>
> > VRTSourcedRasterBand* vrtRBand =
> > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(1);
> > VRTSourcedRasterBand* vrtGBand =
> > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(2);
> > VRTSourcedRasterBand* vrtBBand =
> > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(3);
> > vrtRBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > 1.0, VRT_NODATA_UNSET, 1);
> > vrtGBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > 1.0, VRT_NODATA_UNSET, 2);
> > vrtBBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > 1.0, VRT_NODATA_UNSET, 3);
> >
> > Is there anything I have missed in the setup here?
>
> Looks good otherwise. Did you check that you configured properly the
> warper to
> use the 3 bands of the VRT ?
> >
> > - Thomas
> >
> >
> >
> > On Tue, Jun 9, 2015 at 1:44 PM, Even Rouault <even.rouault at spatialys.com
> >
> > wrote:
> >
> > > Thomas,
> > > >
> > > > I'm using the GDALWarp api from C++ to reproject and cut various
> input
> > > > images. In general this works very well for my purposes, except that
> for
> > > > paletted images I have to use NearestNeighbour resampling,
> > > >
> > > > I would like to use Bilinear or higher order resampling, and wonder
> if
> > > > there is any way to expand a paletted image to true RGB during the
> warp
> > > > process, so I can use these resampling methods.
> > >
> > > No, you must use an intermediate step before.
> > >
> > > >
> > > > Alternatively, is there a way to do this conversion (from code)
> before
> > > the
> > > > warp without having to run through the entire image in memory?
> > >
> > > You can use a in-memory VRT dataset to do on-the-fly expansion to RGB.
> > >
> > > With the AddComplexSource() method of VRTSourcedRasterBand class:
> > >
> > >     CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
> > >                                      int nSrcXOff=-1, int nSrcYOff=-1,
> > >                                      int nSrcXSize=-1, int
> nSrcYSize=-1,
> > >                                      int nDstXOff=-1, int nDstYOff=-1,
> > >                                      int nDstXSize=-1, int
> nDstYSize=-1,
> > >                                      double dfScaleOff=0.0,
> > >                                      double dfScaleRatio=1.0,
> > >                                      double dfNoDataValue =
> > > VRT_NODATA_UNSET,
> > >                                      int nColorTableComponent = 0);
> > >
> > > Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is what
> > > gdal_translate will do if you use "gdal_translate -of VRT -expand rgb
> > > pct.tif
> > > out.vrt"
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > >
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150612/5a6e9b36/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jun 12 04:35:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 13:35:17 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <CAJSDX1gthThvXMcTCKaTONBG9CxeaZKbkEHrcO20z3my=2pG1Q@mail.gmail.com>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
	<1433850259.5576d193184a8@imp.free.fr>
	<CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>
	<1434036336.5579a870cb1a2@imp.free.fr>
	<CAJSDX1gthThvXMcTCKaTONBG9CxeaZKbkEHrcO20z3my=2pG1Q@mail.gmail.com>
Message-ID: <1434108917.557ac3f53ab14@imp.free.fr>

Selon Thomas Sevaldrud <thomas at silentwings.no>:

> Thanks again! The problem was in the warper setup, it used only the first
> band of the image. This also revealed a bug in another part of my code
> related to VRT's and Warp, since I had added double sets of bands there as
> well. However, when fixing this, some old code stopped working :-)
>
> Basically, my problem is that I want to reproject an RGB image which may be
> the VRT I made above, or another RGB(A) image, into  an output RGBA. If I
> don't have an input alpha channel, I still want the output to have alpha,
> and I want any borders that result from the reprojection to have alpha = 0.
> What is the correct way of setting up this? Currently I set up the bands
> like this:
>
> warpOptions->nBandCount = srcNumBands;
>
> warpOptions->panSrcBands =
> (int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));
> warpOptions->panDstBands =
> (int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));
>
> warpOptions->padfSrcNoDataReal =
> (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> warpOptions->padfSrcNoDataImag =
> (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
>
> warpOptions->padfDstNoDataReal =
> (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> warpOptions->padfDstNoDataImag =
> (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
>
> for (int j = 0; j < warpOptions->nBandCount; j++)
> {
> warpOptions->panSrcBands[j] = j+1;
> warpOptions->panDstBands[j] = j+1;
>
> warpOptions->padfSrcNoDataReal[j] = _srcNodata;
> warpOptions->padfSrcNoDataImag[j] = 0.0;
>
> warpOptions->padfDstNoDataReal[j] = _nodata;
> warpOptions->padfDstNoDataImag[j] = 0.0;
> }
>
> if (srcNumBands == 4)
> warpOptions->nSrcAlphaBand = 4;
>
> if (dstNumBands == 4)
> warpOptions->nDstAlphaBand = 4;
>
> char **papszWarpOptions = NULL;
> papszWarpOptions = CSLSetNameValue(papszWarpOptions, "INIT_DEST", "NO_DATA"
> );
>
> In some cases this works, but in others I get only a black image after the
> warp. So my question is basically if the above code should have worked. My
> assumption here is that the GDAL Warper will regard all input pixels as
> having full opacity when no alpha channel is specified, and that output
> alpha is initialized to 0. Are these valid assumptions, or do I need to
> create an alpha channel in the input image as well?

I don't see anything fundamentally wrong in the above. If your source image is
fully opaque, you don't need to set padfSrcNoDataReal and padfSrcNoDataImag. And
if you have an output alpha channel, you don't need to set padfDstNoDataReal and
padfDstNoDataImag too. In that cas you would just do papszWarpOptions =
CSLSetNameValue(papszWarpOptions, "INIT_DEST", "0" ); I'm not sure this will
change the end result however.

>
> - Thomas
>
> On Thu, Jun 11, 2015 at 5:25 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> > Selon Thomas Sevaldrud <thomas at silentwings.no>:
> >
> > > Great, thanks!
> > >
> > > I tried this, but got only a red image as result, so I guess only the
> > first
> > > channel was used.
> > >
> > > This is the relevant code, where _ds is the input paletted data set
> > >
> > > vrtDS = vrtDriver->Create("", origW, origH, 3, GDT_Byte, NULL);
> > > double geoTransform[6];
> > > _ds->GetGeoTransform(geoTransform);
> > > vrtDS->SetGeoTransform(geoTransform);
> > > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> > >
> > > GDALRasterBand* srcBand = _ds->GetRasterBand(1);
> > >
> > > vrtDS->AddBand(GDT_Byte, NULL);
> > > vrtDS->AddBand(GDT_Byte, NULL);
> > > vrtDS->AddBand(GDT_Byte, NULL);
> >
> > You don't need the above 3 AddBand() since you called Create() with 3
> > already
> >
> > > VRTSourcedRasterBand* vrtRBand =
> > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(1);
> > > VRTSourcedRasterBand* vrtGBand =
> > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(2);
> > > VRTSourcedRasterBand* vrtBBand =
> > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(3);
> > > vrtRBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > > 1.0, VRT_NODATA_UNSET, 1);
> > > vrtGBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > > 1.0, VRT_NODATA_UNSET, 2);
> > > vrtBBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1, 0.0,
> > > 1.0, VRT_NODATA_UNSET, 3);
> > >
> > > Is there anything I have missed in the setup here?
> >
> > Looks good otherwise. Did you check that you configured properly the
> > warper to
> > use the 3 bands of the VRT ?
> > >
> > > - Thomas
> > >
> > >
> > >
> > > On Tue, Jun 9, 2015 at 1:44 PM, Even Rouault <even.rouault at spatialys.com
> > >
> > > wrote:
> > >
> > > > Thomas,
> > > > >
> > > > > I'm using the GDALWarp api from C++ to reproject and cut various
> > input
> > > > > images. In general this works very well for my purposes, except that
> > for
> > > > > paletted images I have to use NearestNeighbour resampling,
> > > > >
> > > > > I would like to use Bilinear or higher order resampling, and wonder
> > if
> > > > > there is any way to expand a paletted image to true RGB during the
> > warp
> > > > > process, so I can use these resampling methods.
> > > >
> > > > No, you must use an intermediate step before.
> > > >
> > > > >
> > > > > Alternatively, is there a way to do this conversion (from code)
> > before
> > > > the
> > > > > warp without having to run through the entire image in memory?
> > > >
> > > > You can use a in-memory VRT dataset to do on-the-fly expansion to RGB.
> > > >
> > > > With the AddComplexSource() method of VRTSourcedRasterBand class:
> > > >
> > > >     CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
> > > >                                      int nSrcXOff=-1, int nSrcYOff=-1,
> > > >                                      int nSrcXSize=-1, int
> > nSrcYSize=-1,
> > > >                                      int nDstXOff=-1, int nDstYOff=-1,
> > > >                                      int nDstXSize=-1, int
> > nDstYSize=-1,
> > > >                                      double dfScaleOff=0.0,
> > > >                                      double dfScaleRatio=1.0,
> > > >                                      double dfNoDataValue =
> > > > VRT_NODATA_UNSET,
> > > >                                      int nColorTableComponent = 0);
> > > >
> > > > Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is what
> > > > gdal_translate will do if you use "gdal_translate -of VRT -expand rgb
> > > > pct.tif
> > > > out.vrt"
> > > >
> > > > Even
> > > >
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > > >
> > >
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> >
>


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robert at interactive.co.uk  Fri Jun 12 06:04:14 2015
From: robert at interactive.co.uk (Robert Inder)
Date: Fri, 12 Jun 2015 14:04:14 +0100
Subject: [gdal-dev] Apparent problem with GDAL rpm (gdal-1.9.2-6.rhel6.i686)
Message-ID: <CAKqjJm8w_DOT16MN--1SgFpq3ZQWDBBON5sxs2KZ6DHSV0arfA@mail.gmail.com>

I fear my original subject line did not make the problem clear.

It looks like there is a problem with the 32-bit gdal RPM on the
pgdg94.repository (i.e. gdal-1.9.2-6.rhel6.i686).

Specifically, ogr2ogr cannot connect to a running postgres server, and
does not list PostgreSQL as one of the formats it supports

Whereas ogr2ogr from the corresponding 64-bit RPM on the same
repository can, and does.

This doesn't seem right.  Especially for a package in a
Postgres-focused repository!

Does anyone know whether ogrogr in that RPM SHOULD have a PostgreSQL driver?

Can anyone confirm whether it actually DOES?

Robert.

On 11 June 2015 at 18:06, Robert Inder <robert at interactive.co.uk> wrote:
> I have PostgreSQL 9.4 running on a 64-bit Centos 6.4 machine,  I have
> then used "yum" to install
>     gdal.x86_64            1.9.2-6.rhel6
>     gdal-devel.x86_64      1.9.2-6.rhel6
>     gdal-java.x86_64       1.9.2-6.rhel6
>     gdal-libs.x86_64       1.9.2-6.rhel6
> all from the pgdg94 repository.  And when I do
>    ogr2ogr --formats | grep "Post"
> I get
>   -> "PostgreSQL" (read/write)
>
> I also a 32-bit Centos 6.4 machine, on which I have used to remove
> PostgreSQL 8.4 and install PostgreSQL 9.4.  I have then used "yum" to
> install
>     gdal.i686                        1.9.2-6.rhel6
>     gdal-devel.i686                  1.9.2-6.rhel6
>     gdal-java.i686                   1.9.2-6.rhel6
>     gdal-libs.i686                   1.9.2-6.rhel6
> again all from the pgdg94 repository.  But ogr2ogr is unable to
> connect to the database.  When I do
>    ogr2ogr --formats | grep "Post"
> I get nothing.
>
> It LOOKS like the 32-bit gdal packages from the pgdg94 repository do
> not have PostgreSQL drivers.  Which makes no sense to me, given that I
> believe that the pgdg94 is maintained by the Postgres project.
>
> How do I track down what has gone wrong and fix it?
>
>
> Robert
>
> --
> Robert Inder,                                    0131 229 1052 / 07808 492 213
> Interactive Information Ltd,   3, Lauriston Gardens, Edinburgh EH3 9HH
> Registered in Scotland, Company no. SC 150689
>                                            Interactions speak louder than words



-- 
Robert Inder,                                    0131 229 1052 / 07808 492 213
Interactive Information Ltd,   3, Lauriston Gardens, Edinburgh EH3 9HH
Registered in Scotland, Company no. SC 150689
                                           Interactions speak louder than words

From thomas at silentwings.no  Fri Jun 12 06:15:59 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Fri, 12 Jun 2015 15:15:59 +0200
Subject: [gdal-dev] GDALWarp API and paletted images
In-Reply-To: <1434108917.557ac3f53ab14@imp.free.fr>
References: <CAJSDX1hxNzB7pcHvnGLpzT8sOrnQdyBrs82yw5JpZyocuwxdxA@mail.gmail.com>
	<1433850259.5576d193184a8@imp.free.fr>
	<CAJSDX1hfHZ-6ar4JsxTk=gmDDbB9KzPZBXTp9ceYP0eeXFOYoA@mail.gmail.com>
	<1434036336.5579a870cb1a2@imp.free.fr>
	<CAJSDX1gthThvXMcTCKaTONBG9CxeaZKbkEHrcO20z3my=2pG1Q@mail.gmail.com>
	<1434108917.557ac3f53ab14@imp.free.fr>
Message-ID: <CAJSDX1hZnJA8DFCzFKqzyLNxc15cW8uBnmycm02W6JXKS3jJBg@mail.gmail.com>

I have those nodata-values there since the same code path is used for
elevation data and such, but it had no effect to remove it.

I have narrowed it down to the case where I use an overview as input. I
have some very large images with overviews, so I find the overview closest
matching to the output resolution of my image and make a VRT of the
overview level like this:

vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());

geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
vrtDS->SetGeoTransform(geoTransform);

for(int i = 1; i <= _numBands; i++)
{
GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
VRTSourcedRasterBand* vrtBand =
(VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
vrtBand->AddSimpleSource(srcBand);
}
srcDS = vrtDS;

The strange thing is that this used to work when I had the same mistake as
you pointed out, where I added the bands twice, i.e the overview had 6
bands, but only three or four of them were used in the warp operation. When
fixing the code, I got this problem.

Is this the best way to do it btw, or is it a better way to make use of
overviews when cutting out and reprojecting parts of a big image?

Thanks again for all your help :-)

- Thomas




On Fri, Jun 12, 2015 at 1:35 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Selon Thomas Sevaldrud <thomas at silentwings.no>:
>
> > Thanks again! The problem was in the warper setup, it used only the first
> > band of the image. This also revealed a bug in another part of my code
> > related to VRT's and Warp, since I had added double sets of bands there
> as
> > well. However, when fixing this, some old code stopped working :-)
> >
> > Basically, my problem is that I want to reproject an RGB image which may
> be
> > the VRT I made above, or another RGB(A) image, into  an output RGBA. If I
> > don't have an input alpha channel, I still want the output to have alpha,
> > and I want any borders that result from the reprojection to have alpha =
> 0.
> > What is the correct way of setting up this? Currently I set up the bands
> > like this:
> >
> > warpOptions->nBandCount = srcNumBands;
> >
> > warpOptions->panSrcBands =
> > (int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));
> > warpOptions->panDstBands =
> > (int*)CPLMalloc(warpOptions->nBandCount*sizeof(int));
> >
> > warpOptions->padfSrcNoDataReal =
> > (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> > warpOptions->padfSrcNoDataImag =
> > (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> >
> > warpOptions->padfDstNoDataReal =
> > (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> > warpOptions->padfDstNoDataImag =
> > (double*)CPLMalloc(warpOptions->nBandCount*sizeof(double));
> >
> > for (int j = 0; j < warpOptions->nBandCount; j++)
> > {
> > warpOptions->panSrcBands[j] = j+1;
> > warpOptions->panDstBands[j] = j+1;
> >
> > warpOptions->padfSrcNoDataReal[j] = _srcNodata;
> > warpOptions->padfSrcNoDataImag[j] = 0.0;
> >
> > warpOptions->padfDstNoDataReal[j] = _nodata;
> > warpOptions->padfDstNoDataImag[j] = 0.0;
> > }
> >
> > if (srcNumBands == 4)
> > warpOptions->nSrcAlphaBand = 4;
> >
> > if (dstNumBands == 4)
> > warpOptions->nDstAlphaBand = 4;
> >
> > char **papszWarpOptions = NULL;
> > papszWarpOptions = CSLSetNameValue(papszWarpOptions, "INIT_DEST",
> "NO_DATA"
> > );
> >
> > In some cases this works, but in others I get only a black image after
> the
> > warp. So my question is basically if the above code should have worked.
> My
> > assumption here is that the GDAL Warper will regard all input pixels as
> > having full opacity when no alpha channel is specified, and that output
> > alpha is initialized to 0. Are these valid assumptions, or do I need to
> > create an alpha channel in the input image as well?
>
> I don't see anything fundamentally wrong in the above. If your source
> image is
> fully opaque, you don't need to set padfSrcNoDataReal and
> padfSrcNoDataImag. And
> if you have an output alpha channel, you don't need to set
> padfDstNoDataReal and
> padfDstNoDataImag too. In that cas you would just do papszWarpOptions =
> CSLSetNameValue(papszWarpOptions, "INIT_DEST", "0" ); I'm not sure this
> will
> change the end result however.
>
> >
> > - Thomas
> >
> > On Thu, Jun 11, 2015 at 5:25 PM, Even Rouault <
> even.rouault at spatialys.com>
> > wrote:
> >
> > > Selon Thomas Sevaldrud <thomas at silentwings.no>:
> > >
> > > > Great, thanks!
> > > >
> > > > I tried this, but got only a red image as result, so I guess only the
> > > first
> > > > channel was used.
> > > >
> > > > This is the relevant code, where _ds is the input paletted data set
> > > >
> > > > vrtDS = vrtDriver->Create("", origW, origH, 3, GDT_Byte, NULL);
> > > > double geoTransform[6];
> > > > _ds->GetGeoTransform(geoTransform);
> > > > vrtDS->SetGeoTransform(geoTransform);
> > > > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> > > >
> > > > GDALRasterBand* srcBand = _ds->GetRasterBand(1);
> > > >
> > > > vrtDS->AddBand(GDT_Byte, NULL);
> > > > vrtDS->AddBand(GDT_Byte, NULL);
> > > > vrtDS->AddBand(GDT_Byte, NULL);
> > >
> > > You don't need the above 3 AddBand() since you called Create() with 3
> > > already
> > >
> > > > VRTSourcedRasterBand* vrtRBand =
> > > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(1);
> > > > VRTSourcedRasterBand* vrtGBand =
> > > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(2);
> > > > VRTSourcedRasterBand* vrtBBand =
> > > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(3);
> > > > vrtRBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1,
> 0.0,
> > > > 1.0, VRT_NODATA_UNSET, 1);
> > > > vrtGBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1,
> 0.0,
> > > > 1.0, VRT_NODATA_UNSET, 2);
> > > > vrtBBand->AddComplexSource(srcBand, -1, -1, -1, -1, -1, -1, -1, -1,
> 0.0,
> > > > 1.0, VRT_NODATA_UNSET, 3);
> > > >
> > > > Is there anything I have missed in the setup here?
> > >
> > > Looks good otherwise. Did you check that you configured properly the
> > > warper to
> > > use the 3 bands of the VRT ?
> > > >
> > > > - Thomas
> > > >
> > > >
> > > >
> > > > On Tue, Jun 9, 2015 at 1:44 PM, Even Rouault <
> even.rouault at spatialys.com
> > > >
> > > > wrote:
> > > >
> > > > > Thomas,
> > > > > >
> > > > > > I'm using the GDALWarp api from C++ to reproject and cut various
> > > input
> > > > > > images. In general this works very well for my purposes, except
> that
> > > for
> > > > > > paletted images I have to use NearestNeighbour resampling,
> > > > > >
> > > > > > I would like to use Bilinear or higher order resampling, and
> wonder
> > > if
> > > > > > there is any way to expand a paletted image to true RGB during
> the
> > > warp
> > > > > > process, so I can use these resampling methods.
> > > > >
> > > > > No, you must use an intermediate step before.
> > > > >
> > > > > >
> > > > > > Alternatively, is there a way to do this conversion (from code)
> > > before
> > > > > the
> > > > > > warp without having to run through the entire image in memory?
> > > > >
> > > > > You can use a in-memory VRT dataset to do on-the-fly expansion to
> RGB.
> > > > >
> > > > > With the AddComplexSource() method of VRTSourcedRasterBand class:
> > > > >
> > > > >     CPLErr         AddComplexSource( GDALRasterBand *poSrcBand,
> > > > >                                      int nSrcXOff=-1, int
> nSrcYOff=-1,
> > > > >                                      int nSrcXSize=-1, int
> > > nSrcYSize=-1,
> > > > >                                      int nDstXOff=-1, int
> nDstYOff=-1,
> > > > >                                      int nDstXSize=-1, int
> > > nDstYSize=-1,
> > > > >                                      double dfScaleOff=0.0,
> > > > >                                      double dfScaleRatio=1.0,
> > > > >                                      double dfNoDataValue =
> > > > > VRT_NODATA_UNSET,
> > > > >                                      int nColorTableComponent = 0);
> > > > >
> > > > > Set nColorTableComponent to 1,2,3 for respectively R,G,B. This is
> what
> > > > > gdal_translate will do if you use "gdal_translate -of VRT -expand
> rgb
> > > > > pct.tif
> > > > > out.vrt"
> > > > >
> > > > > Even
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > > > >
> > > >
> > >
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > >
> >
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150612/4543de2a/attachment-0001.html>

From robert at interactive.co.uk  Fri Jun 12 09:22:43 2015
From: robert at interactive.co.uk (Robert Inder)
Date: Fri, 12 Jun 2015 17:22:43 +0100
Subject: [gdal-dev] Apparent problem with GDAL rpm
	(gdal-1.9.2-6.rhel6.i686)
In-Reply-To: <alpine.LRH.2.11.1506121559430.25338@warden.aitchison.me.uk>
References: <CAKqjJm8w_DOT16MN--1SgFpq3ZQWDBBON5sxs2KZ6DHSV0arfA@mail.gmail.com>
	<alpine.LRH.2.11.1506121559430.25338@warden.aitchison.me.uk>
Message-ID: <CAKqjJm8qiMxwASa90_tuY3ju3+84YNVnwBjffoEOzCgSJP4yCg@mail.gmail.com>

On 12 June 2015 at 16:11, Andrew C Aitchison <andrew at aitchison.me.uk> wrote:
>
> I wasn't previously aware of the pgdg94 repository
> (I use ELGIS http://elgis.argeo.org/repos/6/elgis).
Ah!  OK...

Silly question, but how/why are you doing that?

I followed a "natural" sequence of links on the postgresql.org which
led me to a "repository RPM" that pointed to pgdg94.
How did you get to Elgis?


> If you are testing the 32-bit packages on a 64-bit machine,
> have you installed 32-bit libraries libraries ?

No, they are different machines.  We currently have a 32-bit
production server with Postgres 8 and PostGIS 1.5.

We need more server capacity, so the plan is to move to 64-bit,
Postgres 9 and PostGIS 2.1.  And that combination seems to work
nicely.

BUT I'd also like to be able to update Postgres/PostGIS on
the existing server.

I can do that OK EXCEPT that ogr2ogr won't talk to the database
(which other things are talking to, so Postgres itself is fine).

> A breif look at
> http://yum.postgresql.org/9.4/redhat/rhel-6.6-i386/gdal-1.9.2-6.rhel6.i686.rpm
> *suggests* that it does not have any postgresql dependencies,
> so you would be able to install it without any postgresql libraries.

But if I want/need it to talk to Postgres, what more do I need?

Robert.

-- 
Robert Inder,                                    0131 229 1052 / 07808 492 213
Interactive Information Ltd,   3, Lauriston Gardens, Edinburgh EH3 9HH
Registered in Scotland, Company no. SC 150689
                                           Interactions speak louder than words

From jlaura at asu.edu  Fri Jun 12 09:59:21 2015
From: jlaura at asu.edu (Jay L.)
Date: Fri, 12 Jun 2015 09:59:21 -0700
Subject: [gdal-dev] Proj4 Transformation Error 6
Message-ID: <CA+bfmPsMDFPrBbXRW4tvMFxdbZqPyNCy0zP1KPpJ_RCeiGbVow@mail.gmail.com>

Using GDAL 1.11.2 (Anaconda Python osgeo binstar install).

I have a WKT projection:
'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'

I import this into a srs object and attempt to export to Proj4.  This is
throwing:

RuntimeError: No translation for Mercator to PROJ.4 format is known.

Along the same lines, I am trying to compute pixel to latlon and the
inverse.  So I need a transformation object.  No problem setting that up
until:

RuntimeError: Failed to initialize PROJ.4 with `+proj=merc +lon_0=0 +k=0
+x_0=0 +y_0=0 +a=3396190 +b=3376200 +units=m +no_defs '.

Which leads me to try:

gdalsrsinfo -V '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190
+b=3376200 +units=m +no_defs'

Validate Succeeds

PROJ.4 : '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
+units=m +no_defs '

OGC WKT :
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",3396190,169.894447223611]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]

So gdalsrsinfo is able to validate the proj4 string.

Any ideas?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150612/f015b3bb/attachment.html>

From kyle at pobox.com  Fri Jun 12 10:21:46 2015
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 12 Jun 2015 11:21:46 -0600
Subject: [gdal-dev] Proj4 Transformation Error 6
In-Reply-To: <CA+bfmPsMDFPrBbXRW4tvMFxdbZqPyNCy0zP1KPpJ_RCeiGbVow@mail.gmail.com>
References: <CA+bfmPsMDFPrBbXRW4tvMFxdbZqPyNCy0zP1KPpJ_RCeiGbVow@mail.gmail.com>
Message-ID: <CAJ0mEz16dk34UeS9WUH5RB2mDdOMoBHMNwzqg5SaFM+5q28tJA@mail.gmail.com>

Jay,


On Fri, Jun 12, 2015 at 10:59 AM, Jay L. <jlaura at asu.edu> wrote:
> Using GDAL 1.11.2 (Anaconda Python osgeo binstar install).
>
> I have a WKT projection:
> 'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'
>
> I import this into a srs object and attempt to export to Proj4.  This is
> throwing:
>
> RuntimeError: No translation for Mercator to PROJ.4 format is known.

OGRSpatialReference needs a specific Mercator projection such as:
Mercator_1SP, Mercator_2SP, etc.  Use Mercator_1SP in your case for
the PROJECTION parameter.

>
> Along the same lines, I am trying to compute pixel to latlon and the
> inverse.  So I need a transformation object.  No problem setting that up
> until:
>
> RuntimeError: Failed to initialize PROJ.4 with `+proj=merc +lon_0=0 +k=0
> +x_0=0 +y_0=0 +a=3396190 +b=3376200 +units=m +no_defs '.
>
> Which leads me to try:
>
> gdalsrsinfo -V '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
> +units=m +no_defs'
>
> Validate Succeeds
>
> PROJ.4 : '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
> +units=m +no_defs '
>
> OGC WKT :
> PROJCS["unnamed",
>     GEOGCS["unnamed ellipse",
>         DATUM["unknown",
>             SPHEROID["unnamed",3396190,169.894447223611]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Mercator_1SP"],
>     PARAMETER["central_meridian",0],
>     PARAMETER["scale_factor",0],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1]]
>
> So gdalsrsinfo is able to validate the proj4 string.

gdalsrsinfo can't validate the WKT though, without the Mercator_1SP

>
> Any ideas?
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From kyle at pobox.com  Fri Jun 12 10:29:17 2015
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 12 Jun 2015 11:29:17 -0600
Subject: [gdal-dev] Proj4 Transformation Error 6
In-Reply-To: <CAJ0mEz16dk34UeS9WUH5RB2mDdOMoBHMNwzqg5SaFM+5q28tJA@mail.gmail.com>
References: <CA+bfmPsMDFPrBbXRW4tvMFxdbZqPyNCy0zP1KPpJ_RCeiGbVow@mail.gmail.com>
	<CAJ0mEz16dk34UeS9WUH5RB2mDdOMoBHMNwzqg5SaFM+5q28tJA@mail.gmail.com>
Message-ID: <CAJ0mEz3COw8SsSy96_a_AP7vZC0zbtnCHOHVpqL5uo1kCDuXnA@mail.gmail.com>

Jay,


On Fri, Jun 12, 2015 at 11:21 AM, Kyle Shannon <kyle at pobox.com> wrote:
> Jay,
>
>
> On Fri, Jun 12, 2015 at 10:59 AM, Jay L. <jlaura at asu.edu> wrote:
>> Using GDAL 1.11.2 (Anaconda Python osgeo binstar install).
>>
>> I have a WKT projection:
>> 'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'
>>
>> I import this into a srs object and attempt to export to Proj4.  This is
>> throwing:
>>
>> RuntimeError: No translation for Mercator to PROJ.4 format is known.
>
> OGRSpatialReference needs a specific Mercator projection such as:
> Mercator_1SP, Mercator_2SP, etc.  Use Mercator_1SP in your case for
> the PROJECTION parameter.
>
>>
>> Along the same lines, I am trying to compute pixel to latlon and the
>> inverse.  So I need a transformation object.  No problem setting that up
>> until:
>>
>> RuntimeError: Failed to initialize PROJ.4 with `+proj=merc +lon_0=0 +k=0
>> +x_0=0 +y_0=0 +a=3396190 +b=3376200 +units=m +no_defs '.
>>
>> Which leads me to try:
>>
>> gdalsrsinfo -V '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
>> +units=m +no_defs'
>>
>> Validate Succeeds
>>
>> PROJ.4 : '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
>> +units=m +no_defs '
>>
>> OGC WKT :
>> PROJCS["unnamed",
>>     GEOGCS["unnamed ellipse",
>>         DATUM["unknown",
>>             SPHEROID["unnamed",3396190,169.894447223611]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433]],
>>     PROJECTION["Mercator_1SP"],
>>     PARAMETER["central_meridian",0],
>>     PARAMETER["scale_factor",0],
>>     PARAMETER["false_easting",0],
>>     PARAMETER["false_northing",0],
>>     UNIT["Meter",1]]
>>
>> So gdalsrsinfo is able to validate the proj4 string.
>
> gdalsrsinfo can't validate the WKT though, without the Mercator_1SP
>
>>
>> Any ideas?
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
> Kyle

Mercator is a valid key in the ESRI WKT dialect:

Type "copyright", "credits" or "license()" for more information.
>>> from osgeo import osr
>>> wkt = 'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'
>>> srs1 = osr.SpatialReference()
>>> srs1.ImportFromWkt(wkt)
0
>>> srs1.ExportToProj4()
''
>>> srs1.MorphFromESRI()
0
>>> srs1.ExportToProj4()
'+proj=merc +lon_0=180 +k=1 +x_0=0 +y_0=0 +a=1737400 +b=1737400
+units=m +no_defs '

The osr.SpatialReference.MorphFromESRI() should do the job too.

-- 
Kyle

From dadler at adtechgeospatial.com  Fri Jun 12 10:33:28 2015
From: dadler at adtechgeospatial.com (David Adler)
Date: Fri, 12 Jun 2015 13:33:28 -0400
Subject: [gdal-dev] New OGR driver for DB2 Spatial support
Message-ID: <557B17E8.9020100@adtechgeospatial.com>

I have mostly completed the driver for DB2 Spatial using the ODBC 
support and would appreciate pointers into the GDAL information for the 
following:

1. Is there a test suite / framework for OGR drivers?
2. What is the mechanism for submitting a new driver?
3. What is the plan for the transition to GDAL 2.0?  My driver was 
developed against GDAL 1.11.2 and parallels similar drivers for MSSQL, 
PostGIS, Oracle, etc.

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From kyle at pobox.com  Fri Jun 12 10:43:23 2015
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 12 Jun 2015 11:43:23 -0600
Subject: [gdal-dev] New OGR driver for DB2 Spatial support
In-Reply-To: <557B17E8.9020100@adtechgeospatial.com>
References: <557B17E8.9020100@adtechgeospatial.com>
Message-ID: <CAJ0mEz0Bq9+P8M0XD_1jZUEMunKUQh+Y_2c3_aHdKhFiNPO58Q@mail.gmail.com>

David

On Fri, Jun 12, 2015 at 11:33 AM, David Adler
<dadler at adtechgeospatial.com> wrote:
> I have mostly completed the driver for DB2 Spatial using the ODBC support
> and would appreciate pointers into the GDAL information for the following:
>
> 1. Is there a test suite / framework for OGR drivers?

Yes, you can download the autotest suite here (for 1.11.2):

http://download.osgeo.org/gdal/1.11.2/

there is also test_ogrsf in apps/

cd apps
make test_ogrsf
./test_ogrsf --help
Usage: test_ogrsf [-ro] [-q] [-threads N] [-loops M] [-fsf]
                  (datasource_name | [-driver driver_name] [[-dsco
NAME=VALUE] ...] [[-lco NAME=VALUE] ...] | -all_drivers)
                  [[layer1_name, layer2_name, ...] | [-sql statement]
[-dialect dialect]]
                   [[-oo NAME=VALUE] ...]

-fsf : full spatial filter testing (slow)

> 2. What is the mechanism for submitting a new driver?

Submit a ticket on the trac instance at:

https://trac.osgeo.org/gdal/newticket

attach the patch for the gdal trunk, and the new unit tests as a patch
in autotest.

> 3. What is the plan for the transition to GDAL 2.0?  My driver was developed
> against GDAL 1.11.2 and parallels similar drivers for MSSQL, PostGIS,
> Oracle, etc.

Current trunk is 2.0, with a release candidate out.  You may have to
do a little work to update the driver.

>
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From ari.ucb.fire at gmail.com  Fri Jun 12 11:25:13 2015
From: ari.ucb.fire at gmail.com (Ari Simmons)
Date: Fri, 12 Jun 2015 11:25:13 -0700
Subject: [gdal-dev] gdalwarp on a .vrt: Using internal nodata values (eg
 0) for image (?)
In-Reply-To: <CACqBkM9Frsjpp=NAVxjg8PiPxBj-7uY_FTPEH_7-pZv9XbSueQ@mail.gmail.com>
References: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>
	<CAJxqeBudX82rQdEtDRY320GNP17S5VEf5LFbCsJQ1hA86ND1Rg@mail.gmail.com>
	<CACqBkM9Frsjpp=NAVxjg8PiPxBj-7uY_FTPEH_7-pZv9XbSueQ@mail.gmail.com>
Message-ID: <CAJxqeBsCVgYAA0OqsGtWmxFJ96ok5pyqcimjgRH2x1g5B5oenA@mail.gmail.com>

Do you mean

gdal_translate -te -13813007 5569641 -13809113 5572598
srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800

?

On Thu, Jun 11, 2015 at 3:08 PM, Eli Adam <eadam at co.lincoln.or.us> wrote:

> On Thu, Jun 11, 2015 at 2:38 PM, Ari Simmons <ari.ucb.fire at gmail.com>
> wrote:
> > One notably huge difference is that there is a huge jump in pixel size
> (from
> > 0.000833333333323 to 205.686440189378940)...
> >
> > ah, duh. Unit change.
> >
> > On Thu, Jun 11, 2015 at 2:26 PM, Ari Simmons <ari.ucb.fire at gmail.com>
> wrote:
> >>
> >> I am experimenting with using 'gdalwarp' on a .vrt (first time), but I'm
> >> not sure what I'm doing wrong. I've been running this:
> >>
> >> >> gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -of VRT
> >> >> merged.vrt srtm_merged_3857.vrt
> >>
> >> and it processes fast (far far *too fast* for this global file) and
> >> returns
>
> That is the right speed (~0 seconds) and disk space (~0MB).  That is
> because it doesn't actually do anything except write down notes of
> what it would have done (and will do in the future if you ask for it).
> I like testing large VRT files by outputting a subwindow tif like
> this:
>
> gdal_translate -13813007 5569641 -13809113 5572598
> srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800
>
> If things look good on the subwindow, then it is time for all the I/O
> waiting, processor cycles, and storage space.  Evaluating a few
> places, especially where tiles come together can find things early
> without all the wait.
>
> HTH, Eli
>
> >>
> >> >> Creating output file that is 194835P X 479814L.
> >> >> Processing input file merged.vrt
> >> >> Using internal nodata values (eg. 0) for image merged.vrt
> >>
> >> The return .vrt file definitely doesn't appear right...a quick look at
> the
> >> returned file:
> >>
> >> input:
> >>
> >> Size is 432000, 208800
> >> Coordinate System is:
> >> GEOGCS["WGS 84",
> >>     DATUM["WGS_1984",
> >>         SPHEROID["WGS 84",6378137,298.257223563,
> >>             AUTHORITY["EPSG","7030"]],
> >>         AUTHORITY["EPSG","6326"]],
> >>     PRIMEM["Greenwich",0],
> >>     UNIT["degree",0.0174532925199433],
> >>     AUTHORITY["EPSG","4326"]]
> >> Origin = (-180.000416666666670,84.000416666666666)
> >> Pixel Size = (0.000833333333323,-0.000833333333323)
> >> Corner Coordinates:
> >> Upper Left  (-180.0004167,  84.0004167) (180d 0' 1.50"W, 84d 0' 1.50"N)
> >> Lower Left  (-180.0004167, -89.9995833) (180d 0' 1.50"W, 89d59'58.50"S)
> >> Upper Right ( 179.9995833,  84.0004167) (179d59'58.50"E, 84d 0' 1.50"N)
> >> Lower Right ( 179.9995833, -89.9995833) (179d59'58.50"E, 89d59'58.50"S)
> >> Center      (  -0.0004167,  -2.9995833) (  0d 0' 1.50"W,  2d59'58.50"S)
> >> Band 1 Block=128x128 Type=Int16, ColorInterp=Gray
> >>   NoData Value=0
> >>   Overviews: 216000x104400, 108000x52200, 54000x26100, 27000x13050,
> >> 13500x6525,
> >> 6750x3263, 3375x1632, 1688x816, 844x408, 422x204
> >>
> >> and output file:
> >>
> >>  Size is 193861, 479814
> >> Coordinate System is:
> >> PROJCS["WGS 84 / Pseudo-Mercator",
> >> GEOGCS["WGS 84",
> >> DATUM["WGS_1984",
> >> SPHEROID["WGS 84",6378137,298.257223563,
> >> AUTHORITY["EPSG","7030"]],
> >> AUTHORITY["EPSG","6326"]],
> >> PRIMEM["Greenwich",0,
> >> AUTHORITY["EPSG","8901"]],
> >> UNIT["degree",0.0174532925199433,
> >> AUTHORITY["EPSG","9122"]],
> >> AUTHORITY["EPSG","4326"]],
> >> PROJECTION["Mercator_1SP"],
> >> PARAMETER["central_meridian",0],
> >> PARAMETER["scale_factor",1],
> >> PARAMETER["false_easting",0],
> >> PARAMETER["false_northing",0],
> >> UNIT["metre",1,
> >> AUTHORITY["EPSG","9001"]],
> >> AXIS["X",EAST],
> >> AXIS["Y",NORTH],
> >> EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
> +lon_0=0.0
> >> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
> >> AUTHORITY["EPSG","3857"]]
> >> Origin = (-19837179.642485119000000,18807657.848855246000000)
> >> Pixel Size = (205.686440189378940,-205.686440189378940)
> >> Corner Coordinates:
> >> Upper Left  (-19837179.642,18807657.849) (178d12' 1.50"W, 84d 0' 1.50"N)
> >> Lower Left  (-19837179.642,-79883575.764) (178d12' 1.50"W,
> 89d59'58.50"S)
> >> Upper Right (20037399.339,18807657.849) (179d59'56.47"E, 84d 0' 1.50"N)
> >> Lower Right (20037399.339,-79883575.764) (179d59'56.47"E, 89d59'58.50"S)
> >> Center      (  100109.848,-30537958.958) (  0d53'57.49"E, 89d 2'43.78"S)
> >> Band 1 Block=512x128 Type=Int16, ColorInterp=Gray
> >> Overviews: 96931x239907, 48466x119954, 24233x59977, 12117x29989,
> 6059x14995,
> >> 3030x7498, 1515x3749, 758x1875, 379x938, 191x471
> >>
> >> One notably huge difference is that there is a huge jump in pixel size
> >> (from 0.000833333333323 to 205.686440189378940)...
> >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150612/3f60d877/attachment.html>

From jlaura at asu.edu  Fri Jun 12 11:27:25 2015
From: jlaura at asu.edu (Jay L.)
Date: Fri, 12 Jun 2015 11:27:25 -0700
Subject: [gdal-dev] Proj4 Transformation Error 6
In-Reply-To: <CAJ0mEz3COw8SsSy96_a_AP7vZC0zbtnCHOHVpqL5uo1kCDuXnA@mail.gmail.com>
References: <CA+bfmPsMDFPrBbXRW4tvMFxdbZqPyNCy0zP1KPpJ_RCeiGbVow@mail.gmail.com>
	<CAJ0mEz16dk34UeS9WUH5RB2mDdOMoBHMNwzqg5SaFM+5q28tJA@mail.gmail.com>
	<CAJ0mEz3COw8SsSy96_a_AP7vZC0zbtnCHOHVpqL5uo1kCDuXnA@mail.gmail.com>
Message-ID: <CA+bfmPuQ4ya0s3hBRZKDeyz1xaVCKnTiE71Zs1C_xwNnJv54wg@mail.gmail.com>

Super cool.  Thanks!

On Fri, Jun 12, 2015 at 10:29 AM, Kyle Shannon <kyle at pobox.com> wrote:

> Jay,
>
>
> On Fri, Jun 12, 2015 at 11:21 AM, Kyle Shannon <kyle at pobox.com> wrote:
> > Jay,
> >
> >
> > On Fri, Jun 12, 2015 at 10:59 AM, Jay L. <jlaura at asu.edu> wrote:
> >> Using GDAL 1.11.2 (Anaconda Python osgeo binstar install).
> >>
> >> I have a WKT projection:
> >>
> 'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'
> >>
> >> I import this into a srs object and attempt to export to Proj4.  This is
> >> throwing:
> >>
> >> RuntimeError: No translation for Mercator to PROJ.4 format is known.
> >
> > OGRSpatialReference needs a specific Mercator projection such as:
> > Mercator_1SP, Mercator_2SP, etc.  Use Mercator_1SP in your case for
> > the PROJECTION parameter.
> >
> >>
> >> Along the same lines, I am trying to compute pixel to latlon and the
> >> inverse.  So I need a transformation object.  No problem setting that up
> >> until:
> >>
> >> RuntimeError: Failed to initialize PROJ.4 with `+proj=merc +lon_0=0 +k=0
> >> +x_0=0 +y_0=0 +a=3396190 +b=3376200 +units=m +no_defs '.
> >>
> >> Which leads me to try:
> >>
> >> gdalsrsinfo -V '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190
> +b=3376200
> >> +units=m +no_defs'
> >>
> >> Validate Succeeds
> >>
> >> PROJ.4 : '+proj=merc +lon_0=0 +k=0 +x_0=0 +y_0=0 +a=3396190 +b=3376200
> >> +units=m +no_defs '
> >>
> >> OGC WKT :
> >> PROJCS["unnamed",
> >>     GEOGCS["unnamed ellipse",
> >>         DATUM["unknown",
> >>             SPHEROID["unnamed",3396190,169.894447223611]],
> >>         PRIMEM["Greenwich",0],
> >>         UNIT["degree",0.0174532925199433]],
> >>     PROJECTION["Mercator_1SP"],
> >>     PARAMETER["central_meridian",0],
> >>     PARAMETER["scale_factor",0],
> >>     PARAMETER["false_easting",0],
> >>     PARAMETER["false_northing",0],
> >>     UNIT["Meter",1]]
> >>
> >> So gdalsrsinfo is able to validate the proj4 string.
> >
> > gdalsrsinfo can't validate the WKT though, without the Mercator_1SP
> >
> >>
> >> Any ideas?
> >>
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
> >
> > --
> > Kyle
>
> Mercator is a valid key in the ESRI WKT dialect:
>
> Type "copyright", "credits" or "license()" for more information.
> >>> from osgeo import osr
> >>> wkt =
> 'PROJCS["Mercator",GEOGCS["GCS_Moon_2000",DATUM["D_Moon_2000",SPHEROID["Moon_2000_IAU_IAG",1737400.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",180.0],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]'
> >>> srs1 = osr.SpatialReference()
> >>> srs1.ImportFromWkt(wkt)
> 0
> >>> srs1.ExportToProj4()
> ''
> >>> srs1.MorphFromESRI()
> 0
> >>> srs1.ExportToProj4()
> '+proj=merc +lon_0=180 +k=1 +x_0=0 +y_0=0 +a=1737400 +b=1737400
> +units=m +no_defs '
>
> The osr.SpatialReference.MorphFromESRI() should do the job too.
>
> --
> Kyle
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150612/4cfd1e55/attachment.html>

From even.rouault at spatialys.com  Fri Jun 12 12:35:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 21:35:24 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC1 for release
Message-ID: <201506122135.24096.even.rouault@spatialys.com>

Motion: GDAL/OGR 2.0.0RC1 is promoted to be the official 2.0.0 final release.

---

No critical issue has been specifically reported on RC1 so far, so I invite PSC 
members to vote on this motion after doing your own testing and validation. 
Input from everyone else who can test it is also very welcome.

I'll start the voting with my :

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kyle at pobox.com  Fri Jun 12 12:30:40 2015
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 12 Jun 2015 13:30:40 -0600
Subject: [gdal-dev] New OGR driver for DB2 Spatial support
In-Reply-To: <557B3123.6020100@adtechgeospatial.com>
References: <557B17E8.9020100@adtechgeospatial.com>
	<CAJ0mEz0Bq9+P8M0XD_1jZUEMunKUQh+Y_2c3_aHdKhFiNPO58Q@mail.gmail.com>
	<557B3123.6020100@adtechgeospatial.com>
Message-ID: <CAJ0mEz1wZA3ia3h-xrbxTEg1N8T4fRCSvhDxLKuchVs_wahvCA@mail.gmail.com>

Patch is a diff of the source tree:

https://en.wikipedia.org/wiki/Patch_%28Unix%29

Yours will mostly be new files, but a few will change.

Easiest way to to do that is with svn checkout the trunk, make your
changes, svn add them, then do svn diff > db2.patch.  That makes it
easier for the gdal devs to test.

On Fri, Jun 12, 2015 at 1:21 PM, David Adler
<dadler at adtechgeospatial.com> wrote:
> Kyle, thank you for the quick response.
>
> I'll take a look at the autotest suite and test_ogrsf.
>
> By "patch", do you mean a zip file of the new and changed files?
>
>
> On 6/12/2015 1:43 PM, Kyle Shannon wrote:
>>
>> David
>>
>> On Fri, Jun 12, 2015 at 11:33 AM, David Adler
>> <dadler at adtechgeospatial.com> wrote:
>>>
>>> I have mostly completed the driver for DB2 Spatial using the ODBC support
>>> and would appreciate pointers into the GDAL information for the
>>> following:
>>>
>>> 1. Is there a test suite / framework for OGR drivers?
>>
>> Yes, you can download the autotest suite here (for 1.11.2):
>>
>> http://download.osgeo.org/gdal/1.11.2/
>>
>> there is also test_ogrsf in apps/
>>
>> cd apps
>> make test_ogrsf
>> ./test_ogrsf --help
>> Usage: test_ogrsf [-ro] [-q] [-threads N] [-loops M] [-fsf]
>>                    (datasource_name | [-driver driver_name] [[-dsco
>> NAME=VALUE] ...] [[-lco NAME=VALUE] ...] | -all_drivers)
>>                    [[layer1_name, layer2_name, ...] | [-sql statement]
>> [-dialect dialect]]
>>                     [[-oo NAME=VALUE] ...]
>>
>> -fsf : full spatial filter testing (slow)
>>
>>> 2. What is the mechanism for submitting a new driver?
>>
>> Submit a ticket on the trac instance at:
>>
>> https://trac.osgeo.org/gdal/newticket
>>
>> attach the patch for the gdal trunk, and the new unit tests as a patch
>> in autotest.
>>
>>> 3. What is the plan for the transition to GDAL 2.0?  My driver was
>>> developed
>>> against GDAL 1.11.2 and parallels similar drivers for MSSQL, PostGIS,
>>> Oracle, etc.
>>
>> Current trunk is 2.0, with a release candidate out.  You may have to
>> do a little work to update the driver.
>>
>>> ---
>>> This email has been checked for viruses by Avast antivirus software.
>>> https://www.avast.com/antivirus
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>
>
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
>



-- 
Kyle

From nicolas.cadieux at archeotec.ca  Fri Jun 12 14:18:26 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 12 Jun 2015 17:18:26 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506060113.55444.even.rouault@spatialys.com>
Message-ID: <1cb9aade-97d5-4bc0-9560-a4aa9958de0f@email.android.com>

Hi Even,
Thank you very much.  I increased the buffer to 1.5 GB (512+512+514)*1024*1024 and I can now work much much faster with gdal_grid.

Does gdal_fillnodata have the same type of variable that could speed things up?  It is also slow and does not seem speeded up by the "All_CPUS".

I will use warp and the raster calculator in the future so you have more magic up your sleeve, I would appreciate it.

Cheers and thanks again.

Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit : 
> > Hi, 
> > I have been using gdal_grid to interpolate LiDAR data for some time now. 
> > This would be a typical command: 
> > 
> > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 401135.0 
> > -tye 5568587.0 5773796.0 -a 
> > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0 
> > 205209.0 -of GTiff 
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt 
> > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif --confi 
> > g GDAL_NUM_THREADS ALL_CPUS 
> > 
> > As you can see, this is a huge raster and the csv. file (Pointed with a 
> > .vrt) contains over a billion points.? I am trying to do this in one shot 
> > to avoid boundary effects.? (I know I can split this .csv file into 
> > smaller bits and make this more efficient).?? The computer I am using has 
> > 12 cores, 64BG of memory (smaller than the csv file) and a 1TB pcie solid 
> > state drive.? It should manage the task but it has been running for 5 days 
> > with less than 10% done).? I have access to a super computer with gdal if 
> > all else fails.??? 
> > 
> > This is my question.? The "--config GDAL_NUM_THREADS ALL_CPUS" or "--config 
> > GDAL_NUM_THREADS 12" does not seem to work with the nearest neighbor 
> > algorithm. (It seem to work with the -a count command)? If I use this on a 
> > smaller data set, I see no difference in speed or cpu usage between using 
> > the "ALL_CPUS" or not using this switch.? Is this a bug or simply a 
> > limitation of the nearest neighbor algorithm? 
>
> Nicolas, 
>
> The threading mechanism is generic for all algorithms . Add "--debug on" and 
> you should see traces like "GDAL_GRID: Using 12 threads". Now, a reason for it 
> not being efficient is that the work buffer used by gdalgrid (16 MB) is too small 
> w.r.t to nearest speed. Hum, actually looking more closely at the code, I see 
> that the quad tree to index the points will be rebuilt for each work buffer. 
> This is likely the main cause of the inefficiency and why you don't see 
> measurable differences between non threaded or threaded computations (since the 
> building of the quadtree is not multithreaded). If you compiled from source, 
> you could try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;" 
> line in apps/gdal_grid.cpp to a much higher value. A more proper solution 
> would be to avoid rebuilding the quad tree for each work buffer. This is mainly 
> code restructuring. 
>
> An alternative to gdal_grid would be to use gdal_rasterize + gdal_fillnodata. 
> This is usually much much faster, so you could try to check if it gives the 
> results you expect. 
>
> You could also try scipy : 
> http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpolate.griddata.html#scipy.interpolate.griddata 
> Not sure how it behaves with that number of points. 
>
> Even 
>
> > I don't want to move this 
> > to a super computer if it will not multi-thread properly.? 
> > 
> > Thanks, 
> > Nicolas Cadieux 
> > 
> > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on windows 
> > 7_64)? I use GDAL from the command line not from QGIS. 
> > 
> > 
> > Nicolas Cadieux M.Sc. 
> > Les Entreprises Arch?otec inc. 
> > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > www.archeotec.ca 
> > _______________________________________________ 
> > gdal-dev mailing list 
> > gdal-dev at lists.osgeo.org 
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com 

From even.rouault at spatialys.com  Fri Jun 12 14:29:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 23:29:23 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <1cb9aade-97d5-4bc0-9560-a4aa9958de0f@email.android.com>
References: <1cb9aade-97d5-4bc0-9560-a4aa9958de0f@email.android.com>
Message-ID: <201506122329.23935.even.rouault@spatialys.com>

Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> Hi Even,
> Thank you very much.  I increased the buffer to 1.5 GB
> (512+512+514)*1024*1024 and I can now work much much faster with
> gdal_grid.
> 
> Does gdal_fillnodata have the same type of variable that could speed things
> up?  It is also slow and does not seem speeded up by the "All_CPUS".

No, no tunable for fillnodata, and it doesn't support multi-threaded 
parallelization.

> 
> I will use warp and the raster calculator in the future so you have more
> magic up your sleeve, I would appreciate it.
> 
> Cheers and thanks again.
> 
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc. 
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
> 
> On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > Hi,
> > > I have been using gdal_grid to interpolate LiDAR data for some time
> > > now. This would be a typical command:
> > > 
> > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0
> > > 401135.0 -tye 5568587.0 5773796.0 -a
> > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0
> > > 205209.0 -of GTiff
> > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt
> > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif
> > > --confi g GDAL_NUM_THREADS ALL_CPUS
> > > 
> > > As you can see, this is a huge raster and the csv. file (Pointed with a
> > > .vrt) contains over a billion points.  I am trying to do this in one
> > > shot to avoid boundary effects.  (I know I can split this .csv file
> > > into smaller bits and make this more efficient).   The computer I am
> > > using has 12 cores, 64BG of memory (smaller than the csv file) and a
> > > 1TB pcie solid state drive.  It should manage the task but it has been
> > > running for 5 days with less than 10% done).  I have access to a super
> > > computer with gdal if all else fails.
> > > 
> > > This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS" or
> > > "--config GDAL_NUM_THREADS 12" does not seem to work with the nearest
> > > neighbor algorithm. (It seem to work with the -a count command)  If I
> > > use this on a smaller data set, I see no difference in speed or cpu
> > > usage between using the "ALL_CPUS" or not using this switch.  Is this
> > > a bug or simply a limitation of the nearest neighbor algorithm?
> > 
> > Nicolas,
> > 
> > The threading mechanism is generic for all algorithms . Add "--debug on"
> > and you should see traces like "GDAL_GRID: Using 12 threads". Now, a
> > reason for it not being efficient is that the work buffer used by
> > gdalgrid (16 MB) is too small w.r.t to nearest speed. Hum, actually
> > looking more closely at the code, I see that the quad tree to index the
> > points will be rebuilt for each work buffer. This is likely the main
> > cause of the inefficiency and why you don't see measurable differences
> > between non threaded or threaded computations (since the building of the
> > quadtree is not multithreaded). If you compiled from source, you could
> > try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;" line
> > in apps/gdal_grid.cpp to a much higher value. A more proper solution
> > would be to avoid rebuilding the quad tree for each work buffer. This is
> > mainly code restructuring.
> > 
> > An alternative to gdal_grid would be to use gdal_rasterize +
> > gdal_fillnodata. This is usually much much faster, so you could try to
> > check if it gives the results you expect.
> > 
> > You could also try scipy :
> > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpol
> > ate.griddata.html#scipy.interpolate.griddata Not sure how it behaves with
> > that number of points.
> > 
> > Even
> > 
> > > I don't want to move this
> > > to a super computer if it will not multi-thread properly. 
> > > 
> > > Thanks,
> > > Nicolas Cadieux
> > > 
> > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on
> > > windows 7_64)  I use GDAL from the command line not from QGIS.
> > > 
> > > 
> > > Nicolas Cadieux M.Sc.
> > > Les Entreprises Arch?otec inc.
> > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > www.archeotec.ca
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun 12 14:50:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Jun 2015 23:50:46 +0200
Subject: [gdal-dev] New OGR driver for DB2 Spatial support
In-Reply-To: <CAJ0mEz0Bq9+P8M0XD_1jZUEMunKUQh+Y_2c3_aHdKhFiNPO58Q@mail.gmail.com>
References: <557B17E8.9020100@adtechgeospatial.com>
	<CAJ0mEz0Bq9+P8M0XD_1jZUEMunKUQh+Y_2c3_aHdKhFiNPO58Q@mail.gmail.com>
Message-ID: <201506122350.46646.even.rouault@spatialys.com>

> > 3. What is the plan for the transition to GDAL 2.0?  My driver was
> > developed against GDAL 1.11.2 and parallels similar drivers for MSSQL,
> > PostGIS, Oracle, etc.
> 
> Current trunk is 2.0,

2.1dev actually ;-)

> with a release candidate out.  You may have to
> do a little work to update the driver.

Should be covered by https://svn.osgeo.org/gdal/trunk/gdal/MIGRATION_GUIDE.TXT

> 
> > ---
> > This email has been checked for viruses by Avast antivirus software.
> > https://www.avast.com/antivirus
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From eadam at co.lincoln.or.us  Fri Jun 12 15:00:09 2015
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 12 Jun 2015 15:00:09 -0700
Subject: [gdal-dev] gdalwarp on a .vrt: Using internal nodata values (eg
 0) for image (?)
In-Reply-To: <CAJxqeBsCVgYAA0OqsGtWmxFJ96ok5pyqcimjgRH2x1g5B5oenA@mail.gmail.com>
References: <CAJxqeBs-+pTpj-PXDam0=+a5K-45ZsQnrqnqT8FNwqyJOxTGVg@mail.gmail.com>
	<CAJxqeBudX82rQdEtDRY320GNP17S5VEf5LFbCsJQ1hA86ND1Rg@mail.gmail.com>
	<CACqBkM9Frsjpp=NAVxjg8PiPxBj-7uY_FTPEH_7-pZv9XbSueQ@mail.gmail.com>
	<CAJxqeBsCVgYAA0OqsGtWmxFJ96ok5pyqcimjgRH2x1g5B5oenA@mail.gmail.com>
Message-ID: <CACqBkM8z3ABjrFNt+QniKReWPiVgVSWP=mjDZ9OqY3kS=Y-Z+Q@mail.gmail.com>

On Fri, Jun 12, 2015 at 11:25 AM, Ari Simmons <ari.ucb.fire at gmail.com> wrote:
> Do you mean
>
> gdal_translate -te -13813007 5569641 -13809113 5572598
> srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800
>
> ?

Oops, I made a bad typo by omitting -projwin:

gdal_translate -projwin -13813007 5569641 -13809113 5572598
srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800

Best regards, Eli

>
> On Thu, Jun 11, 2015 at 3:08 PM, Eli Adam <eadam at co.lincoln.or.us> wrote:
>>
>> On Thu, Jun 11, 2015 at 2:38 PM, Ari Simmons <ari.ucb.fire at gmail.com>
>> wrote:
>> > One notably huge difference is that there is a huge jump in pixel size
>> > (from
>> > 0.000833333333323 to 205.686440189378940)...
>> >
>> > ah, duh. Unit change.
>> >
>> > On Thu, Jun 11, 2015 at 2:26 PM, Ari Simmons <ari.ucb.fire at gmail.com>
>> > wrote:
>> >>
>> >> I am experimenting with using 'gdalwarp' on a .vrt (first time), but
>> >> I'm
>> >> not sure what I'm doing wrong. I've been running this:
>> >>
>> >> >> gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -of VRT
>> >> >> merged.vrt srtm_merged_3857.vrt
>> >>
>> >> and it processes fast (far far *too fast* for this global file) and
>> >> returns
>>
>> That is the right speed (~0 seconds) and disk space (~0MB).  That is
>> because it doesn't actually do anything except write down notes of
>> what it would have done (and will do in the future if you ask for it).
>> I like testing large VRT files by outputting a subwindow tif like
>> this:
>>
>> gdal_translate -13813007 5569641 -13809113 5572598
>> srtm_merged_3857.vrt my_subwindow.tif --config  GDAL_CACHEMAX 800
>>
>> If things look good on the subwindow, then it is time for all the I/O
>> waiting, processor cycles, and storage space.  Evaluating a few
>> places, especially where tiles come together can find things early
>> without all the wait.
>>
>> HTH, Eli
>>
>> >>
>> >> >> Creating output file that is 194835P X 479814L.
>> >> >> Processing input file merged.vrt
>> >> >> Using internal nodata values (eg. 0) for image merged.vrt
>> >>
>> >> The return .vrt file definitely doesn't appear right...a quick look at
>> >> the
>> >> returned file:
>> >>
>> >> input:
>> >>
>> >> Size is 432000, 208800
>> >> Coordinate System is:
>> >> GEOGCS["WGS 84",
>> >>     DATUM["WGS_1984",
>> >>         SPHEROID["WGS 84",6378137,298.257223563,
>> >>             AUTHORITY["EPSG","7030"]],
>> >>         AUTHORITY["EPSG","6326"]],
>> >>     PRIMEM["Greenwich",0],
>> >>     UNIT["degree",0.0174532925199433],
>> >>     AUTHORITY["EPSG","4326"]]
>> >> Origin = (-180.000416666666670,84.000416666666666)
>> >> Pixel Size = (0.000833333333323,-0.000833333333323)
>> >> Corner Coordinates:
>> >> Upper Left  (-180.0004167,  84.0004167) (180d 0' 1.50"W, 84d 0' 1.50"N)
>> >> Lower Left  (-180.0004167, -89.9995833) (180d 0' 1.50"W, 89d59'58.50"S)
>> >> Upper Right ( 179.9995833,  84.0004167) (179d59'58.50"E, 84d 0' 1.50"N)
>> >> Lower Right ( 179.9995833, -89.9995833) (179d59'58.50"E, 89d59'58.50"S)
>> >> Center      (  -0.0004167,  -2.9995833) (  0d 0' 1.50"W,  2d59'58.50"S)
>> >> Band 1 Block=128x128 Type=Int16, ColorInterp=Gray
>> >>   NoData Value=0
>> >>   Overviews: 216000x104400, 108000x52200, 54000x26100, 27000x13050,
>> >> 13500x6525,
>> >> 6750x3263, 3375x1632, 1688x816, 844x408, 422x204
>> >>
>> >> and output file:
>> >>
>> >>  Size is 193861, 479814
>> >> Coordinate System is:
>> >> PROJCS["WGS 84 / Pseudo-Mercator",
>> >> GEOGCS["WGS 84",
>> >> DATUM["WGS_1984",
>> >> SPHEROID["WGS 84",6378137,298.257223563,
>> >> AUTHORITY["EPSG","7030"]],
>> >> AUTHORITY["EPSG","6326"]],
>> >> PRIMEM["Greenwich",0,
>> >> AUTHORITY["EPSG","8901"]],
>> >> UNIT["degree",0.0174532925199433,
>> >> AUTHORITY["EPSG","9122"]],
>> >> AUTHORITY["EPSG","4326"]],
>> >> PROJECTION["Mercator_1SP"],
>> >> PARAMETER["central_meridian",0],
>> >> PARAMETER["scale_factor",1],
>> >> PARAMETER["false_easting",0],
>> >> PARAMETER["false_northing",0],
>> >> UNIT["metre",1,
>> >> AUTHORITY["EPSG","9001"]],
>> >> AXIS["X",EAST],
>> >> AXIS["Y",NORTH],
>> >> EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
>> >> +lon_0=0.0
>> >> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"],
>> >> AUTHORITY["EPSG","3857"]]
>> >> Origin = (-19837179.642485119000000,18807657.848855246000000)
>> >> Pixel Size = (205.686440189378940,-205.686440189378940)
>> >> Corner Coordinates:
>> >> Upper Left  (-19837179.642,18807657.849) (178d12' 1.50"W, 84d 0'
>> >> 1.50"N)
>> >> Lower Left  (-19837179.642,-79883575.764) (178d12' 1.50"W,
>> >> 89d59'58.50"S)
>> >> Upper Right (20037399.339,18807657.849) (179d59'56.47"E, 84d 0' 1.50"N)
>> >> Lower Right (20037399.339,-79883575.764) (179d59'56.47"E,
>> >> 89d59'58.50"S)
>> >> Center      (  100109.848,-30537958.958) (  0d53'57.49"E, 89d
>> >> 2'43.78"S)
>> >> Band 1 Block=512x128 Type=Int16, ColorInterp=Gray
>> >> Overviews: 96931x239907, 48466x119954, 24233x59977, 12117x29989,
>> >> 6059x14995,
>> >> 3030x7498, 1515x3749, 758x1875, 379x938, 191x471
>> >>
>> >> One notably huge difference is that there is a huge jump in pixel size
>> >> (from 0.000833333333323 to 205.686440189378940)...
>> >
>> >
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>

From howard at hobu.co  Sat Jun 13 05:28:50 2015
From: howard at hobu.co (Howard Butler)
Date: Sat, 13 Jun 2015 07:28:50 -0500
Subject: [gdal-dev] Motion: Promote 2.0.0RC1 for release
In-Reply-To: <201506122135.24096.even.rouault@spatialys.com>
References: <201506122135.24096.even.rouault@spatialys.com>
Message-ID: <FE4BDE50-8DD2-4A66-B89F-F718CF34DC18@hobu.co>


> On Jun 12, 2015, at 2:35 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Motion: GDAL/OGR 2.0.0RC1 is promoted to be the official 2.0.0 final release.
> 
> ---
> 
> No critical issue has been specifically reported on RC1 so far, so I invite PSC 
> members to vote on this motion after doing your own testing and validation. 
> Input from everyone else who can test it is also very welcome.
> 
> I'll start the voting with my :
> 
> +1 Even

+1 Howard

From szekerest at gmail.com  Sat Jun 13 11:26:09 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat, 13 Jun 2015 20:26:09 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC1 for release
In-Reply-To: <201506122135.24096.even.rouault@spatialys.com>
References: <201506122135.24096.even.rouault@spatialys.com>
Message-ID: <CACALY+TFmV+7F43_PduipGN0p_B_D1Ee9ThHTeyC0in=gCVsEw@mail.gmail.com>

+1

Tamas

2015-06-12 21:35 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Motion: GDAL/OGR 2.0.0RC1 is promoted to be the official 2.0.0 final
> release.
>
> ---
>
> No critical issue has been specifically reported on RC1 so far, so I
> invite PSC
> members to vote on this motion after doing your own testing and validation.
> Input from everyone else who can test it is also very welcome.
>
> I'll start the voting with my :
>
> +1 Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150613/4211dead/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Jun 13 13:11:52 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Sat, 13 Jun 2015 20:11:52 +0000 (UTC)
Subject: [gdal-dev] Motion: Promote 2.0.0RC1 for release
References: <201506122135.24096.even.rouault@spatialys.com>
Message-ID: <loom.20150613T221103-632@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Motion: GDAL/OGR 2.0.0RC1 is promoted to be the official 2.0.0 final release.

+1

-Jukka Rahkonen-



From landa.martin at gmail.com  Sun Jun 14 02:30:51 2015
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 14 Jun 2015 11:30:51 +0200
Subject: [gdal-dev] dbf data types
Message-ID: <CA+Ei1Oe+rjYrXZBWFPs_CqUG7jQAqDbvcWaG8n4wJzJcPja32w@mail.gmail.com>

Hi all,

recently I was converting dbf files [1] to PostgreSQL database. Some
fields are recognized as characters even they contain numeric types,
eg.

ogrinfo OBCE.DBF OBCE -so
INFO: Open of `OBCE.DBF'
      using driver `ESRI Shapefile' successful.

Layer name: OBCE
ICOB: String (6.0)

ICOB is ID of a city, OGR driver defines this attribute as character.
I tried ADJUST_TYPE option, but it didn't make difference.

Thanks in advance for any hint, Martin

[1] http://geo102.fsv.cvut.cz/~landa/tmp/OBCE.DBF

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sun Jun 14 02:47:49 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 14 Jun 2015 11:47:49 +0200
Subject: [gdal-dev] dbf data types
In-Reply-To: <CA+Ei1Oe+rjYrXZBWFPs_CqUG7jQAqDbvcWaG8n4wJzJcPja32w@mail.gmail.com>
References: <CA+Ei1Oe+rjYrXZBWFPs_CqUG7jQAqDbvcWaG8n4wJzJcPja32w@mail.gmail.com>
Message-ID: <201506141147.49708.even.rouault@spatialys.com>

Hi Martin,
> 
> recently I was converting dbf files [1] to PostgreSQL database. Some
> fields are recognized as characters even they contain numeric types,
> eg.
> 
> ogrinfo OBCE.DBF OBCE -so
> INFO: Open of `OBCE.DBF'
>       using driver `ESRI Shapefile' successful.
> 
> Layer name: OBCE
> ICOB: String (6.0)
> 
> ICOB is ID of a city, OGR driver defines this attribute as character.

Yes, looking in the DBF header shows that it is declared as 'C' (character) 
field

> I tried ADJUST_TYPE option, but it didn't make difference.

ADJUST_TYPE in the shapedriver only does Real->Integer/Integer64 or Integer64-
>Integer field types adjustment as documented

> 
> Thanks in advance for any hint, Martin

One workaround is to convert to CSV and use the AUTODETECT_TYPE=YES open 
option:

ogr2ogr -f CSV OBCE.CSV OBCE.DBF
ogr2ogr -f PostgreSQL PG:xxxx OBCE.CSV -oo AUTODETECT_TYPE=YES

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Jun 14 12:04:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 14 Jun 2015 21:04:51 +0200
Subject: [gdal-dev] [RETRACTED] Re:  Motion: Promote 2.0.0RC1 for release
In-Reply-To: <201506122135.24096.even.rouault@spatialys.com>
References: <201506122135.24096.even.rouault@spatialys.com>
Message-ID: <201506142104.51540.even.rouault@spatialys.com>

Le vendredi 12 juin 2015 21:35:24, Even Rouault a ?crit :
> Motion: GDAL/OGR 2.0.0RC1 is promoted to be the official 2.0.0 final
> release.
> 

Changing my vote to -1 since I discovered a regression : 
https://trac.osgeo.org/gdal/ticket/5999

I've prepared an RC2. Email to follow.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Jun 14 12:28:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 14 Jun 2015 21:28:17 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 RC2 Available for Review
Message-ID: <201506142128.17825.even.rouault@spatialys.com>

Hi,

Due to a regression that could cause compressed GeoTIFF created by GDAL to be 
almost twice as large as their optimal size in some circumstances (see 
https://trac.osgeo.org/gdal/ticket/5999), I have prepared a RC2.

The list of fixes in the 2.0 branch since RC1:
  * Java GNUmakefile: add -f in rm commands (#5997)
  * Doc: Add a brief summary to the GDAL and OGR utilities pages (#5996)
  * Various typo fixes in doc and code (#5995)
  * GTiff/block cache: fix creation of pixel interleaved multiband files (2.0 
regression, #5999)
  * VRT: add handling of a shared='0' attribute on <SourceFilename> to open 
sources in non-shared mode, and VRT_SHARED_SOURCE config option that can be set 
to 0 in case the shared attribute isn't there (#5992)
  * Ili: Fix crash with models using types derived from INTERLIS
  * gdal_grid: fix crash in optimized mode with GCC 4.4 on 64bit (#5987)
  * GDALSuggestedWarpOut2(): fix typo that could prevent detection of part of 
the error cases for #5980
  * CPLAcquireMutex(): improve performance on Windows (#5986)

Updated source code:

  http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC2.tar.xz
  http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC2.tar.gz
  http://download.osgeo.org/gdal/2.0.0/gdal200RC2.zip

gdal-grass plugin unchanged:

  http://download.osgeo.org/gdal/2.0.0/gdal-grass-2.0.0RC1.tar.gz

Updated snapshot of the gdalautotest suite:

  http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC2.tar.gz
  http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC2.zip

Updated documentation:

  http://download.osgeo.org/gdal/2.0.0/gdal200docRC2.zip

I'll call for a vote promoting it to final in one day if no serious problems 
are reported.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Jun 14 12:30:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 14 Jun 2015 21:30:37 +0200
Subject: [gdal-dev] Fwd: [SoC] Report 3 - Integration of GDAL Utilities into
	GDAL Core library
Message-ID: <201506142130.37501.even.rouault@spatialys.com>

Some news. Already a first step achieved.

----------  Message transmis  ----------

Sujet : [SoC] Report 3 - Integration of GDAL Utilities into GDAL Core library
Date : dimanche 14 juin 2015, 18:41:27
De : faza mahamood <fazamhd at gmail.com>
? : soc at lists.osgeo.org

Hi,

This week I completed the swig bindings for librarified GDALInfo utility. I
also added the tests for librarified GDALInfo in the GDAL autotest.

My code commits can be found here.
https://github.com/fazam/gdal/tree/gdalinfo

Next week, I plan to librarify gdal_translate utility, add swig bindings
for it and update the GDAL autotest.

Regards,
Faza

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kassies at gmail.com  Sun Jun 14 23:59:34 2015
From: kassies at gmail.com (Rutger)
Date: Sun, 14 Jun 2015 23:59:34 -0700 (PDT)
Subject: [gdal-dev] Fwd: [SoC] Report 3 - Integration of GDAL Utilities
 into GDAL Core library
In-Reply-To: <201506142130.37501.even.rouault@spatialys.com>
References: <201506142130.37501.even.rouault@spatialys.com>
Message-ID: <1434351574969-5210921.post@n6.nabble.com>

Great work, really looking forward to it. If i understand it correctly this
should make working with GDAL much more robust if you are using it with
language bindings. 

For example, when using Conda (package/env manager) with GDAL and the Python
bindings. I often put the location of the GDAL utilities in my PATH, so
calling `gdalwarp` will work from anywhere. But if you make a new
environment with a different GDAL version, the PATH will still point to the
old version, and you would suddenly mix versions together if you combine the
utilities with the bindings.

Also, not everyone ships the utilities when they compile GDAL.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Fwd-SoC-Report-3-Integration-of-GDAL-Utilities-into-GDAL-Core-library-tp5210878p5210921.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kassies at gmail.com  Mon Jun 15 00:05:18 2015
From: kassies at gmail.com (Rutger)
Date: Mon, 15 Jun 2015 00:05:18 -0700 (PDT)
Subject: [gdal-dev] Overlay shapefile onto Geotiff image
In-Reply-To: <41D20371-8CF1-48A5-BC4D-4744F296D94C@skogoglandskap.no>
References: <2086CE7E967C1B4F9D5897BE1C3C746F3119455B@ECS-EXG-P-MB01.win.lanl.gov>
	<41D20371-8CF1-48A5-BC4D-4744F296D94C@skogoglandskap.no>
Message-ID: <1434351918816-5210923.post@n6.nabble.com>

Graeme B. Bell wrote
> You'll need to tell it what size you want to burn. You can do that by
> looking at the extents (northeast, southwest) of your current
> raster/geotiff.

If you make a copy of the Geotiff you already have, you can provide it as
the 'destination dataset' for gdal_rasterize, it would then (of course)
automatically pick up all the output properties for you. You can then for
example first burn with value 1, and then to another pass with burn value 0
and set the '-i' flag to invert the rasterization, that way anything not
touching the lines will be set to 0, which you can later use as a nodata
value to get the transparency. 

Note that the destination dataset for gdal_rasterize gets modified 'in
place', so especially when experimenting make sure you always have a
copy/backup.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Overlay-shapefile-onto-Geotiff-image-tp5209980p5210923.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Jun 15 02:24:15 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 11:24:15 +0200
Subject: [gdal-dev] Fwd: [GRASS-user] Please check your trac settings for
	email notifications
Message-ID: <201506151124.15888.even.rouault@spatialys.com>

Hi,

Below information is also true for GDAL Trac.

Even

----------  Message transmis  ----------

Sujet : [GRASS-user] Please check your trac settings for email notifications
Date : lundi 15 juin 2015, 11:14:29
De : Markus Neteler <neteler at osgeo.org>
? : GRASS developers list <grass-dev at lists.osgeo.org>, GRASS user list <grass-
user at lists.osgeo.org>

Hi all,

FYI

recently, the OSGeo trac server got updated. Apparently the personal
email preferences didn't survive this update.
If you want to again receive email notification upon trac ticket
updates, you need to login and re-enter your name and email address
here:

https://trac.osgeo.org/grass/prefs

Preferences
--> Full name:
--> Email address:

"This information is used to associate your login name with your email
address and full name, which is used for email notification and RSS
feeds, for example."

Best,
Markus

PS: thanks to Moritz Lennert for identifying this issue.
_______________________________________________
grass-user mailing list
grass-user at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/grass-user


-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thomas at silentwings.no  Mon Jun 15 03:07:25 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Mon, 15 Jun 2015 12:07:25 +0200
Subject: [gdal-dev]  GDALWarp on a specific overview of a dataset
Message-ID: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>

Hi,

I am having a bit of trouble with warping a dataset (an ECW file) with
multiple overviews. The base file is huge, so I am selecting the overview
that matches closest to my output resolution and makes an in-memory VRT of
this, consisting of the overview bands of the original image.

This seems to only work for some overview levels, and not for others. I get
results that appear to be made from the correct sets of colors basically,
but way out of scale and postion. Some times it seems to work nicely
though, so I suspect that there is some memory overwriting issue or
something here.

This is the part of the code that builds the overview VRT. The input
dataset is _ds, an

// Create a VRT of the closest matching overlay
GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );

vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());

   ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double basePixelSizeY =
geoTransform[XFM_PIXEL_SIZE_NS];

geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
vrtDS->SetGeoTransform(geoTransform);

for(int i = 1; i <= _numBands; i++)
{
GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
VRTSourcedRasterBand* vrtBand =
(VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
vrtBand->AddSimpleSource(srcBand);
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150615/47154704/attachment.html>

From thomas at silentwings.no  Mon Jun 15 03:11:03 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Mon, 15 Jun 2015 12:11:03 +0200
Subject: [gdal-dev] GDALWarp on a specific overview of a dataset
In-Reply-To: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
References: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
Message-ID: <CAJSDX1h5t9AM2Q-wyCfEs-ZemPSGESmxUToQsTmwrcJxSxqs8A@mail.gmail.com>

Argh, I managed to send it while editing :-)

Anway, input to this code section is the wanted overview level and the
derived scale factors in X- and Y-direction. Output is the vrtDS dataset
that is used in the GDAL Warp api later.

Are there any obvious mistakes I've made here?

I see that in GDAL 2.0 there will be a new class for handling this, the
GDALOverviewDaset. It's a bit early for me to move to 2.0 yet, but maybe I
should just make a similar dataset type in my own project. Would that be
more efficient than going via a VRT?

- Thomas




On Mon, Jun 15, 2015 at 12:07 PM, Thomas Sevaldrud <thomas at silentwings.no>
wrote:

> Hi,
>
> I am having a bit of trouble with warping a dataset (an ECW file) with
> multiple overviews. The base file is huge, so I am selecting the overview
> that matches closest to my output resolution and makes an in-memory VRT of
> this, consisting of the overview bands of the original image.
>
> This seems to only work for some overview levels, and not for others. I
> get results that appear to be made from the correct sets of colors
> basically, but way out of scale and postion. Some times it seems to work
> nicely though, so I suspect that there is some memory overwriting issue or
> something here.
>
> This is the part of the code that builds the overview VRT. The input
> dataset is _ds, an
>
> // Create a VRT of the closest matching overlay
> GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
>
> vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
> GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
>
>    ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
> basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double basePixelSizeY =
> geoTransform[XFM_PIXEL_SIZE_NS];
>
> geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
> geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
> vrtDS->SetGeoTransform(geoTransform);
>
> for(int i = 1; i <= _numBands; i++)
> {
> GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
> GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
> VRTSourcedRasterBand* vrtBand =
> (VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
> vrtBand->AddSimpleSource(srcBand);
> }
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150615/226232d6/attachment.html>

From even.rouault at spatialys.com  Mon Jun 15 03:19:14 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 12:19:14 +0200
Subject: [gdal-dev] GDALWarp on a specific overview of a dataset
In-Reply-To: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
References: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
Message-ID: <201506151219.14389.even.rouault@spatialys.com>

Thomas,

2 suggestions to help narrowing down the issue :
- try gdalwarp of GDAL 2.0 that can select the most appropriate overview  
given the target resolution / raster size
- try with the ECW translated as a GeoTIFF to check if it isn't an issue with 
the ECW driver itself.

Even

> Hi,
> 
> I am having a bit of trouble with warping a dataset (an ECW file) with
> multiple overviews. The base file is huge, so I am selecting the overview
> that matches closest to my output resolution and makes an in-memory VRT of
> this, consisting of the overview bands of the original image.
> 
> This seems to only work for some overview levels, and not for others. I get
> results that appear to be made from the correct sets of colors basically,
> but way out of scale and postion. Some times it seems to work nicely
> though, so I suspect that there is some memory overwriting issue or
> something here.
> 
> This is the part of the code that builds the overview VRT. The input
> dataset is _ds, an
> 
> // Create a VRT of the closest matching overlay
> GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
> 
> vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
> GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> 
>    ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
> basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double basePixelSizeY =
> geoTransform[XFM_PIXEL_SIZE_NS];
> 
> geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
> geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
> vrtDS->SetGeoTransform(geoTransform);
> 
> for(int i = 1; i <= _numBands; i++)
> {
> GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
> GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
> VRTSourcedRasterBand* vrtBand =
> (VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
> vrtBand->AddSimpleSource(srcBand);
> }

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thomas at silentwings.no  Mon Jun 15 06:51:37 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Mon, 15 Jun 2015 15:51:37 +0200
Subject: [gdal-dev] GDALWarp on a specific overview of a dataset
In-Reply-To: <201506151219.14389.even.rouault@spatialys.com>
References: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
	<201506151219.14389.even.rouault@spatialys.com>
Message-ID: <CAJSDX1g38dbRexe7QG3M0bL+3C1YJD5CvAUa18ho7eYYEjRYTw@mail.gmail.com>

When using the same image in GeoTIFF with overviews, it works correctly,
which may indicate something with the ECW drivers. I suppose it must be
something triggered by something weird I'm doing though, or else I would
think that other people would have the same problem.

The weird thing is that if I simply add an extra band to the VRT it works
with ECW as well... This extra band is never used for anything and has no
source, but with it, I get the correct image.

I can't switch to GDAL 2.0 yet, but I'll try to isolate the code from the
GDALOverviewDataset class and use that instead of the VRT approach, and see
if that makes any difference.

- Thomas


On Mon, Jun 15, 2015 at 12:19 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Thomas,
>
> 2 suggestions to help narrowing down the issue :
> - try gdalwarp of GDAL 2.0 that can select the most appropriate overview
> given the target resolution / raster size
> - try with the ECW translated as a GeoTIFF to check if it isn't an issue
> with
> the ECW driver itself.
>
> Even
>
> > Hi,
> >
> > I am having a bit of trouble with warping a dataset (an ECW file) with
> > multiple overviews. The base file is huge, so I am selecting the overview
> > that matches closest to my output resolution and makes an in-memory VRT
> of
> > this, consisting of the overview bands of the original image.
> >
> > This seems to only work for some overview levels, and not for others. I
> get
> > results that appear to be made from the correct sets of colors basically,
> > but way out of scale and postion. Some times it seems to work nicely
> > though, so I suspect that there is some memory overwriting issue or
> > something here.
> >
> > This is the part of the code that builds the overview VRT. The input
> > dataset is _ds, an
> >
> > // Create a VRT of the closest matching overlay
> > GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
> >
> > vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
> > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> >
> >    ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
> > basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double basePixelSizeY =
> > geoTransform[XFM_PIXEL_SIZE_NS];
> >
> > geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
> > geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
> > vrtDS->SetGeoTransform(geoTransform);
> >
> > for(int i = 1; i <= _numBands; i++)
> > {
> > GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
> > GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
> > VRTSourcedRasterBand* vrtBand =
> > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
> > vrtBand->AddSimpleSource(srcBand);
> > }
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150615/4d9806d0/attachment.html>

From even.rouault at spatialys.com  Mon Jun 15 07:06:56 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 16:06:56 +0200
Subject: [gdal-dev] GDALWarp on a specific overview of a dataset
In-Reply-To: <CAJSDX1g38dbRexe7QG3M0bL+3C1YJD5CvAUa18ho7eYYEjRYTw@mail.gmail.com>
References: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
	<201506151219.14389.even.rouault@spatialys.com>
	<CAJSDX1g38dbRexe7QG3M0bL+3C1YJD5CvAUa18ho7eYYEjRYTw@mail.gmail.com>
Message-ID: <201506151606.56215.even.rouault@spatialys.com>

Le lundi 15 juin 2015 15:51:37, Thomas Sevaldrud a ?crit :
> When using the same image in GeoTIFF with overviews, it works correctly,
> which may indicate something with the ECW drivers. I suppose it must be
> something triggered by something weird I'm doing though, or else I would
> think that other people would have the same problem.

It is sometimes surprising that some bugs remain unreported for long!

> 
> The weird thing is that if I simply add an extra band to the VRT it works
> with ECW as well... This extra band is never used for anything and has no
> source, but with it, I get the correct image.

Interesting. My guess is that you must hit 
https://trac.osgeo.org/gdal/ticket/5954

> 
> I can't switch to GDAL 2.0 yet, but I'll try to isolate the code from the
> GDALOverviewDataset class and use that instead of the VRT approach, and see
> if that makes any difference.

Latest code from 1.11 branch has the fix for the above ticket.

> 
> - Thomas
> 
> 
> On Mon, Jun 15, 2015 at 12:19 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Thomas,
> > 
> > 2 suggestions to help narrowing down the issue :
> > - try gdalwarp of GDAL 2.0 that can select the most appropriate overview
> > given the target resolution / raster size
> > - try with the ECW translated as a GeoTIFF to check if it isn't an issue
> > with
> > the ECW driver itself.
> > 
> > Even
> > 
> > > Hi,
> > > 
> > > I am having a bit of trouble with warping a dataset (an ECW file) with
> > > multiple overviews. The base file is huge, so I am selecting the
> > > overview that matches closest to my output resolution and makes an
> > > in-memory VRT
> > 
> > of
> > 
> > > this, consisting of the overview bands of the original image.
> > > 
> > > This seems to only work for some overview levels, and not for others. I
> > 
> > get
> > 
> > > results that appear to be made from the correct sets of colors
> > > basically, but way out of scale and postion. Some times it seems to
> > > work nicely though, so I suspect that there is some memory overwriting
> > > issue or something here.
> > > 
> > > This is the part of the code that builds the overview VRT. The input
> > > dataset is _ds, an
> > > 
> > > // Create a VRT of the closest matching overlay
> > > GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
> > > 
> > > vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType, NULL);
> > > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> > > 
> > >    ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
> > > 
> > > basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double basePixelSizeY
> > > = geoTransform[XFM_PIXEL_SIZE_NS];
> > > 
> > > geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
> > > geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
> > > vrtDS->SetGeoTransform(geoTransform);
> > > 
> > > for(int i = 1; i <= _numBands; i++)
> > > {
> > > GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
> > > GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
> > > VRTSourcedRasterBand* vrtBand =
> > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
> > > vrtBand->AddSimpleSource(srcBand);
> > > }
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thomas at silentwings.no  Mon Jun 15 08:00:12 2015
From: thomas at silentwings.no (Thomas Sevaldrud)
Date: Mon, 15 Jun 2015 17:00:12 +0200
Subject: [gdal-dev] GDALWarp on a specific overview of a dataset
In-Reply-To: <201506151606.56215.even.rouault@spatialys.com>
References: <CAJSDX1i96C=GOoRr6kfE3xab5h_m2u_WW61NEQFMeRY57RWF0w@mail.gmail.com>
	<201506151219.14389.even.rouault@spatialys.com>
	<CAJSDX1g38dbRexe7QG3M0bL+3C1YJD5CvAUa18ho7eYYEjRYTw@mail.gmail.com>
	<201506151606.56215.even.rouault@spatialys.com>
Message-ID: <CAJSDX1g7tJ7-36nO1dA9GEuqUVPbf23AQk+nOGP0bC+GV1J7yA@mail.gmail.com>

Ah, great! That fixed it :-)

Is there an official 1.11.3 release in the works? It's a bit of hassle for
me to integrate it into our build system here, so if there's a new official
version out soon I probably won't bother to integrate the current snapshot.

Thanks so much for your help, Even!

- Thomas

On Mon, Jun 15, 2015 at 4:06 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 15 juin 2015 15:51:37, Thomas Sevaldrud a ?crit :
> > When using the same image in GeoTIFF with overviews, it works correctly,
> > which may indicate something with the ECW drivers. I suppose it must be
> > something triggered by something weird I'm doing though, or else I would
> > think that other people would have the same problem.
>
> It is sometimes surprising that some bugs remain unreported for long!
>
> >
> > The weird thing is that if I simply add an extra band to the VRT it works
> > with ECW as well... This extra band is never used for anything and has no
> > source, but with it, I get the correct image.
>
> Interesting. My guess is that you must hit
> https://trac.osgeo.org/gdal/ticket/5954
>
> >
> > I can't switch to GDAL 2.0 yet, but I'll try to isolate the code from the
> > GDALOverviewDataset class and use that instead of the VRT approach, and
> see
> > if that makes any difference.
>
> Latest code from 1.11 branch has the fix for the above ticket.
>
> >
> > - Thomas
> >
> >
> > On Mon, Jun 15, 2015 at 12:19 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Thomas,
> > >
> > > 2 suggestions to help narrowing down the issue :
> > > - try gdalwarp of GDAL 2.0 that can select the most appropriate
> overview
> > > given the target resolution / raster size
> > > - try with the ECW translated as a GeoTIFF to check if it isn't an
> issue
> > > with
> > > the ECW driver itself.
> > >
> > > Even
> > >
> > > > Hi,
> > > >
> > > > I am having a bit of trouble with warping a dataset (an ECW file)
> with
> > > > multiple overviews. The base file is huge, so I am selecting the
> > > > overview that matches closest to my output resolution and makes an
> > > > in-memory VRT
> > >
> > > of
> > >
> > > > this, consisting of the overview bands of the original image.
> > > >
> > > > This seems to only work for some overview levels, and not for
> others. I
> > >
> > > get
> > >
> > > > results that appear to be made from the correct sets of colors
> > > > basically, but way out of scale and postion. Some times it seems to
> > > > work nicely though, so I suspect that there is some memory
> overwriting
> > > > issue or something here.
> > > >
> > > > This is the part of the code that builds the overview VRT. The input
> > > > dataset is _ds, an
> > > >
> > > > // Create a VRT of the closest matching overlay
> > > > GDALDriver *vrtDriver = (GDALDriver *) GDALGetDriverByName( "VRT" );
> > > >
> > > > vrtDS = vrtDriver->Create("", ovrW, ovrH, _numBands, _dataType,
> NULL);
> > > > GDALSetProjection(vrtDS, _srcProjectionWKT.c_str());
> > > >
> > > >    ouble geoTransform[6]; _ds->GetGeoTransform(geoTransform); double
> > > >
> > > > basePixelSizeX = geoTransform[XFM_PIXEL_SIZE_EW]; double
> basePixelSizeY
> > > > = geoTransform[XFM_PIXEL_SIZE_NS];
> > > >
> > > > geoTransform[XFM_PIXEL_SIZE_EW] = scaleX*basePixelSizeX;
> > > > geoTransform[XFM_PIXEL_SIZE_NS] = scaleY*basePixelSizeY;
> > > > vrtDS->SetGeoTransform(geoTransform);
> > > >
> > > > for(int i = 1; i <= _numBands; i++)
> > > > {
> > > > GDALRasterBand* srcRootBand = _ds->GetRasterBand(i);
> > > > GDALRasterBand* srcBand = srcRootBand->GetOverview(overviewId);
> > > > VRTSourcedRasterBand* vrtBand =
> > > > (VRTSourcedRasterBand*)vrtDS->GetRasterBand(i);
> > > > vrtBand->AddSimpleSource(srcBand);
> > > > }
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150615/b3fd40a4/attachment.html>

From even.rouault at spatialys.com  Mon Jun 15 10:38:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 19:38:20 +0200
Subject: [gdal-dev] Call for discussion on RFC 26: GDAL Block Cache
	Improvements
In-Reply-To: <201506041605.00222.even.rouault@spatialys.com>
References: <201506041605.00222.even.rouault@spatialys.com>
Message-ID: <201506151938.20323.even.rouault@spatialys.com>

I'll call soon on a vote on this if nobody has remarks.

Le jeudi 04 juin 2015 16:05:00, Even Rouault a ?crit :
> Hi,
> 
> I've updated an old RFC initiated by Tamas. The main idea, having a hashset
> based implementation as an alternative to the array based, remains. Changes
> consist mainly in code restructuration, perf improvements to reduce lock
> contention and porting to the state of the latest code base.
> 
> This is a RFC for GDAL 2.1
> 
> Details at https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
> 
> == Summary and rationale ==
> 
> GDAL maintains an in-memory cache for the raster blocks fetched from the
> drivers and ensures that the second attempt to access the same block will
> be served from the cache instead of the driver. This cache is maintained
> in a per-band fashion and an array is allocated for the pointers for each
> blocks (or sub-blocks). This approach is not sufficient with large raster
> dimensions (or large virtual rasters ie. with the WMS/TMS driver), which
> may cause out of memory errors in GDALRasterBand::InitBlockInfo, as raised
> in #3224
> 
> For example, a band of a dataset at level 21 with a GoogleMaps tiling
> requires 2097152x2097152 tiles of 256x256 pixels. This means that GDAL
> will try to allocate an array of 32768x32768 = 1 billion elements (32768 =
> 2097152 / 64). The size of this array is 4 GB on a 32-bit build, so it
> cannot be allocated at all. And it is 8 GB on a 64-bit build (even if this
> is generally only virtual memory reservation but not actually allocation
> of physical pages of memory, due to over-commit mechanism of the operating
> system). At dataset closing, this means that those 1 billion cells will
> have to be explored to discover remaining cached blocks. In reality, all
> above figures must be multiplied by 3 for a RGB (or 4 for a RGBA) dataset.
> 
> In the hash set implementation, memory allocation depends directly on the
> number of cached blocks. Typically with the default GDAL_CACHEMAX size of
> 40 MB, only 640 blocks of 256x256 pixels can be simultaneously cached (for
> all datasets).
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yidong80 at gmail.com  Mon Jun 15 11:18:02 2015
From: yidong80 at gmail.com (Yi Dong)
Date: Mon, 15 Jun 2015 14:18:02 -0400
Subject: [gdal-dev] gdalwarp on a separate RPC model
Message-ID: <557F16DA.5080909@gmail.com>

Dear List,

I have a question about recitify satellite images that has RPC camera 
using gdalwarp.  I know gdalwarp can be used for this task, with using 
RPC metadata (either packed inside the NITF or stored inside RPB files)
Normally, the image folder shall contain following files
input.ntf
input.rpb
input.imd
etc...
The command I used for this is
gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 rectified.tif

Now I performed some geo-correction on the satellite image and generate 
a corrected RPC model (with imporved offset values) and I store this 
correct RPC camera in 'correct.rpb'.  Now I am trying to use this 
'correct.rpb' to recitify the image
I tried
gdalwarp -rpc input.ntf correct.rpb -to RPC_HEIGHT=200 
recitify_corrected.tif
but it failed with following error
ERROR 4: 'correct.rpb' not recognized as a supported file format

Then I tried to overwrite the 'input.rpb' in the image folder with my 
'corrected.rpb', run 'gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 
rectified.tif' again but I got exactly same results as I used the 
original RPC model.  I guess that might be because gdalwarp used RPC 
parameter that was packed inside NITF image itself, instead of getting 
them from rpb files ?

So Is there other way to use my corrected RPC model in gdal, like 
gdalwarp, gdal_transform, etc.?
Also, gdaltransform doesn't not accept RPB files either.  It only 
recognizes GDAL dataset, i.e. vrt file.  Therefore I need to generate 
vrt file from my RPB.  Is there any vrt example for RPC camera that I 
can follow?

Thanks a lot
Ian


From bishop.dev at gmail.com  Mon Jun 15 11:35:29 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Mon, 15 Jun 2015 21:35:29 +0300
Subject: [gdal-dev] gdalwarp on a separate RPC model
In-Reply-To: <557F16DA.5080909@gmail.com>
References: <557F16DA.5080909@gmail.com>
Message-ID: <557F1AF1.7020509@gmail.com>

Hi Yi,

GDAL use the RPC which it report by gdalinfo. If gdalinfo reports old 
RPC, you have to clean them from dataset. It seem's to me that rpb 
(*_rpc.txt, etc.) files accepted only on GeoTIFF and TILL formats. On 
GDAL 2.0 also jp2 added. So NITF is not a right format for use external 
RPC. So, first of all try to gdal_translate you format to GTiff, and 
than try to create so-name rpb file.

Best regards,
     Dmitry

15.06.2015 21:18, Yi Dong ?????:
> Dear List,
>
> I have a question about recitify satellite images that has RPC camera 
> using gdalwarp.  I know gdalwarp can be used for this task, with using 
> RPC metadata (either packed inside the NITF or stored inside RPB files)
> Normally, the image folder shall contain following files
> input.ntf
> input.rpb
> input.imd
> etc...
> The command I used for this is
> gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 rectified.tif
>
> Now I performed some geo-correction on the satellite image and 
> generate a corrected RPC model (with imporved offset values) and I 
> store this correct RPC camera in 'correct.rpb'.  Now I am trying to 
> use this 'correct.rpb' to recitify the image
> I tried
> gdalwarp -rpc input.ntf correct.rpb -to RPC_HEIGHT=200 
> recitify_corrected.tif
> but it failed with following error
> ERROR 4: 'correct.rpb' not recognized as a supported file format
>
> Then I tried to overwrite the 'input.rpb' in the image folder with my 
> 'corrected.rpb', run 'gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 
> rectified.tif' again but I got exactly same results as I used the 
> original RPC model.  I guess that might be because gdalwarp used RPC 
> parameter that was packed inside NITF image itself, instead of getting 
> them from rpb files ?
>
> So Is there other way to use my corrected RPC model in gdal, like 
> gdalwarp, gdal_transform, etc.?
> Also, gdaltransform doesn't not accept RPB files either.  It only 
> recognizes GDAL dataset, i.e. vrt file.  Therefore I need to generate 
> vrt file from my RPB.  Is there any vrt example for RPC camera that I 
> can follow?
>
> Thanks a lot
> Ian
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From even.rouault at spatialys.com  Mon Jun 15 11:55:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 20:55:20 +0200
Subject: [gdal-dev] gdalwarp on a separate RPC model
In-Reply-To: <557F16DA.5080909@gmail.com>
References: <557F16DA.5080909@gmail.com>
Message-ID: <201506152055.20842.even.rouault@spatialys.com>

Le lundi 15 juin 2015 20:18:02, Yi Dong a ?crit :
> Dear List,
> 
> I have a question about recitify satellite images that has RPC camera
> using gdalwarp.  I know gdalwarp can be used for this task, with using
> RPC metadata (either packed inside the NITF or stored inside RPB files)
> Normally, the image folder shall contain following files
> input.ntf
> input.rpb
> input.imd
> etc...
> The command I used for this is
> gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 rectified.tif
> 
> Now I performed some geo-correction on the satellite image and generate
> a corrected RPC model (with imporved offset values) and I store this
> correct RPC camera in 'correct.rpb'.  Now I am trying to use this
> 'correct.rpb' to recitify the image
> I tried
> gdalwarp -rpc input.ntf correct.rpb -to RPC_HEIGHT=200
> recitify_corrected.tif
> but it failed with following error
> ERROR 4: 'correct.rpb' not recognized as a supported file format
> 
> Then I tried to overwrite the 'input.rpb' in the image folder with my
> 'corrected.rpb', run 'gdalwarp -rpc input.ntf -to RPC_HEIGHT=200
> rectified.tif' again but I got exactly same results as I used the
> original RPC model.  I guess that might be because gdalwarp used RPC
> parameter that was packed inside NITF image itself, instead of getting
> them from rpb files ?
> 
> So Is there other way to use my corrected RPC model in gdal, like
> gdalwarp, gdal_transform, etc.?
> Also, gdaltransform doesn't not accept RPB files either.  It only
> recognizes GDAL dataset, i.e. vrt file.  Therefore I need to generate
> vrt file from my RPB.  Is there any vrt example for RPC camera that I
> can follow?

Ian,

I'd suggesting gdal_translate'ing your input.ntf into a VRT, and replace the 
values in the "VRT" metadata domain with your own values. Then you can run 
gdalwarp on this VRT file

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicolas.cadieux at archeotec.ca  Mon Jun 15 12:00:15 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Mon, 15 Jun 2015 15:00:15 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506122329.23935.even.rouault@spatialys.com>
Message-ID: <503b66f9-3c01-429d-9005-9e135c883598@email.android.com>

Thanks Even,
One last question about the buffer. Is 2GB is the max buffer size for gdal_grid? If I select that, am I likely to run into problem with some values?  Apart from trial and error, is there a balance that should be stuck between available computer memory (currently at 64GB), input file size and the buffer or can I simply select a 2GB buffer?

Merci beaucoup pour votre aide.

Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit : 
> > Hi Even, 
> > Thank you very much.? I increased the buffer to 1.5 GB 
> > (512+512+514)*1024*1024 and I can now work much much faster with 
> > gdal_grid. 
> > 
> > Does gdal_fillnodata have the same type of variable that could speed things 
> > up?? It is also slow and does not seem speeded up by the "All_CPUS". 
>
> No, no tunable for fillnodata, and it doesn't support multi-threaded 
> parallelization. 
>
> > 
> > I will use warp and the raster calculator in the future so you have more 
> > magic up your sleeve, I would appreciate it. 
> > 
> > Cheers and thanks again. 
> > 
> > Nicolas Cadieux M.Sc. 
> > Les Entreprises Arch?otec inc. 
> > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > www.archeotec.ca 
> > 
> > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote: 
> > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit : 
> > > > Hi, 
> > > > I have been using gdal_grid to interpolate LiDAR data for some time 
> > > > now. This would be a typical command: 
> > > > 
> > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 
> > > > 401135.0 -tye 5568587.0 5773796.0 -a 
> > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 52402.0 
> > > > 205209.0 -of GTiff 
> > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt 
> > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif 
> > > > --confi g GDAL_NUM_THREADS ALL_CPUS 
> > > > 
> > > > As you can see, this is a huge raster and the csv. file (Pointed with a 
> > > > .vrt) contains over a billion points.? I am trying to do this in one 
> > > > shot to avoid boundary effects.? (I know I can split this .csv file 
> > > > into smaller bits and make this more efficient).?? The computer I am 
> > > > using has 12 cores, 64BG of memory (smaller than the csv file) and a 
> > > > 1TB pcie solid state drive.? It should manage the task but it has been 
> > > > running for 5 days with less than 10% done).? I have access to a super 
> > > > computer with gdal if all else fails. 
> > > > 
> > > > This is my question.? The "--config GDAL_NUM_THREADS ALL_CPUS" or 
> > > > "--config GDAL_NUM_THREADS 12" does not seem to work with the nearest 
> > > > neighbor algorithm. (It seem to work with the -a count command)? If I 
> > > > use this on a smaller data set, I see no difference in speed or cpu 
> > > > usage between using the "ALL_CPUS" or not using this switch.? Is this 
> > > > a bug or simply a limitation of the nearest neighbor algorithm? 
> > > 
> > > Nicolas, 
> > > 
> > > The threading mechanism is generic for all algorithms . Add "--debug on" 
> > > and you should see traces like "GDAL_GRID: Using 12 threads". Now, a 
> > > reason for it not being efficient is that the work buffer used by 
> > > gdalgrid (16 MB) is too small w.r.t to nearest speed. Hum, actually 
> > > looking more closely at the code, I see that the quad tree to index the 
> > > points will be rebuilt for each work buffer. This is likely the main 
> > > cause of the inefficiency and why you don't see measurable differences 
> > > between non threaded or threaded computations (since the building of the 
> > > quadtree is not multithreaded). If you compiled from source, you could 
> > > try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;" line 
> > > in apps/gdal_grid.cpp to a much higher value. A more proper solution 
> > > would be to avoid rebuilding the quad tree for each work buffer. This is 
> > > mainly code restructuring. 
> > > 
> > > An alternative to gdal_grid would be to use gdal_rasterize + 
> > > gdal_fillnodata. This is usually much much faster, so you could try to 
> > > check if it gives the results you expect. 
> > > 
> > > You could also try scipy : 
> > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpol 
> > > ate.griddata.html#scipy.interpolate.griddata Not sure how it behaves with 
> > > that number of points. 
> > > 
> > > Even 
> > > 
> > > > I don't want to move this 
> > > > to a super computer if it will not multi-thread properly. 
> > > > 
> > > > Thanks, 
> > > > Nicolas Cadieux 
> > > > 
> > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on 
> > > > windows 7_64)? I use GDAL from the command line not from QGIS. 
> > > > 
> > > > 
> > > > Nicolas Cadieux M.Sc. 
> > > > Les Entreprises Arch?otec inc. 
> > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > www.archeotec.ca 
> > > > _______________________________________________ 
> > > > gdal-dev mailing list 
> > > > gdal-dev at lists.osgeo.org 
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com 

From matt.a.hanson at gmail.com  Mon Jun 15 12:12:54 2015
From: matt.a.hanson at gmail.com (Matt Hanson)
Date: Mon, 15 Jun 2015 15:12:54 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <503b66f9-3c01-429d-9005-9e135c883598@email.android.com>
References: <201506122329.23935.even.rouault@spatialys.com>
	<503b66f9-3c01-429d-9005-9e135c883598@email.android.com>
Message-ID: <CAGYeuZmCCoKo6nsms_f8_rVXO29-Yho2S7O1soTuQF-7-Vk_8A@mail.gmail.com>

Hi Nicolas,

I see someone already posted something about lidar2dems.   We also wanted
to use only open-source, so put together this project to easily be able to
make DEMs using what's out there already.
The documentation gives an overview of what it can do and a tutorial for
processing a large area.

http://applied-geosolutions.github.io/lidar2dems/

I'd like to add multiprocessing support, as it processes in pieces as it
is, so wouldn't take much more work to split it up over processors.

-matt


On Mon, Jun 15, 2015 at 3:00 PM, Nicolas Cadieux <
nicolas.cadieux at archeotec.ca> wrote:

> Thanks Even,
> One last question about the buffer. Is 2GB is the max buffer size for
> gdal_grid? If I select that, am I likely to run into problem with some
> values?  Apart from trial and error, is there a balance that should be
> stuck between available computer memory (currently at 64GB), input file
> size and the buffer or can I simply select a 2GB buffer?
>
> Merci beaucoup pour votre aide.
>
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc.
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
>
> On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> wrote:
> >
> > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> > > Hi Even,
> > > Thank you very much.  I increased the buffer to 1.5 GB
> > > (512+512+514)*1024*1024 and I can now work much much faster with
> > > gdal_grid.
> > >
> > > Does gdal_fillnodata have the same type of variable that could speed
> things
> > > up?  It is also slow and does not seem speeded up by the "All_CPUS".
> >
> > No, no tunable for fillnodata, and it doesn't support multi-threaded
> > parallelization.
> >
> > >
> > > I will use warp and the raster calculator in the future so you have
> more
> > > magic up your sleeve, I would appreciate it.
> > >
> > > Cheers and thanks again.
> > >
> > > Nicolas Cadieux M.Sc.
> > > Les Entreprises Arch?otec inc.
> > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > www.archeotec.ca
> > >
> > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote:
> > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > > > Hi,
> > > > > I have been using gdal_grid to interpolate LiDAR data for some time
> > > > > now. This would be a typical command:
> > > > >
> > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0
> > > > > 401135.0 -tye 5568587.0 5773796.0 -a
> > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize
> 52402.0
> > > > > 205209.0 -of GTiff
> > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt
> > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif
> > > > > --confi g GDAL_NUM_THREADS ALL_CPUS
> > > > >
> > > > > As you can see, this is a huge raster and the csv. file (Pointed
> with a
> > > > > .vrt) contains over a billion points.  I am trying to do this in
> one
> > > > > shot to avoid boundary effects.  (I know I can split this .csv file
> > > > > into smaller bits and make this more efficient).   The computer I
> am
> > > > > using has 12 cores, 64BG of memory (smaller than the csv file) and
> a
> > > > > 1TB pcie solid state drive.  It should manage the task but it has
> been
> > > > > running for 5 days with less than 10% done).  I have access to a
> super
> > > > > computer with gdal if all else fails.
> > > > >
> > > > > This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS" or
> > > > > "--config GDAL_NUM_THREADS 12" does not seem to work with the
> nearest
> > > > > neighbor algorithm. (It seem to work with the -a count command)
> If I
> > > > > use this on a smaller data set, I see no difference in speed or cpu
> > > > > usage between using the "ALL_CPUS" or not using this switch.  Is
> this
> > > > > a bug or simply a limitation of the nearest neighbor algorithm?
> > > >
> > > > Nicolas,
> > > >
> > > > The threading mechanism is generic for all algorithms . Add "--debug
> on"
> > > > and you should see traces like "GDAL_GRID: Using 12 threads". Now, a
> > > > reason for it not being efficient is that the work buffer used by
> > > > gdalgrid (16 MB) is too small w.r.t to nearest speed. Hum, actually
> > > > looking more closely at the code, I see that the quad tree to index
> the
> > > > points will be rebuilt for each work buffer. This is likely the main
> > > > cause of the inefficiency and why you don't see measurable
> differences
> > > > between non threaded or threaded computations (since the building of
> the
> > > > quadtree is not multithreaded). If you compiled from source, you
> could
> > > > try changing the "const GUInt32 nDesiredBufferSize = 16*1024*1024;"
> line
> > > > in apps/gdal_grid.cpp to a much higher value. A more proper solution
> > > > would be to avoid rebuilding the quad tree for each work buffer.
> This is
> > > > mainly code restructuring.
> > > >
> > > > An alternative to gdal_grid would be to use gdal_rasterize +
> > > > gdal_fillnodata. This is usually much much faster, so you could try
> to
> > > > check if it gives the results you expect.
> > > >
> > > > You could also try scipy :
> > > >
> http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpol
> > > > ate.griddata.html#scipy.interpolate.griddata Not sure how it behaves
> with
> > > > that number of points.
> > > >
> > > > Even
> > > >
> > > > > I don't want to move this
> > > > > to a super computer if it will not multi-thread properly.
> > > > >
> > > > > Thanks,
> > > > > Nicolas Cadieux
> > > > >
> > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on
> > > > > windows 7_64)  I use GDAL from the command line not from QGIS.
> > > > >
> > > > >
> > > > > Nicolas Cadieux M.Sc.
> > > > > Les Entreprises Arch?otec inc.
> > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > www.archeotec.ca
> > > > > _______________________________________________
> > > > > gdal-dev mailing list
> > > > > gdal-dev at lists.osgeo.org
> > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150615/e2a86231/attachment.html>

From even.rouault at spatialys.com  Mon Jun 15 12:24:41 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Jun 2015 21:24:41 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <503b66f9-3c01-429d-9005-9e135c883598@email.android.com>
References: <503b66f9-3c01-429d-9005-9e135c883598@email.android.com>
Message-ID: <201506152124.41336.even.rouault@spatialys.com>

Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit :
> Thanks Even,
> One last question about the buffer. Is 2GB is the max buffer size for
> gdal_grid? If I select that, am I likely to run into problem with some
> values? 

The variable is a uint32 so you could probably go up to 4 GB.

> Apart from trial and error, is there a balance that should be
> stuck between available computer memory (currently at 64GB), input file
> size and the buffer or can I simply select a 2GB buffer?

As you're exploring new territories, I'd expect you to report how this works 
;-)

> 
> Merci beaucoup pour votre aide.
> 
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc. 
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
> 
> On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> > > Hi Even,
> > > Thank you very much.  I increased the buffer to 1.5 GB
> > > (512+512+514)*1024*1024 and I can now work much much faster with
> > > gdal_grid.
> > > 
> > > Does gdal_fillnodata have the same type of variable that could speed
> > > things up?  It is also slow and does not seem speeded up by the
> > > "All_CPUS".
> > 
> > No, no tunable for fillnodata, and it doesn't support multi-threaded
> > parallelization.
> > 
> > > I will use warp and the raster calculator in the future so you have
> > > more magic up your sleeve, I would appreciate it.
> > > 
> > > Cheers and thanks again.
> > > 
> > > Nicolas Cadieux M.Sc.
> > > Les Entreprises Arch?otec inc.
> > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > www.archeotec.ca
> > > 
> > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote:
> > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > > > Hi,
> > > > > I have been using gdal_grid to interpolate LiDAR data for some time
> > > > > now. This would be a typical command:
> > > > > 
> > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0
> > > > > 401135.0 -tye 5568587.0 5773796.0 -a
> > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize
> > > > > 52402.0 205209.0 -of GTiff
> > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt
> > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif
> > > > > --confi g GDAL_NUM_THREADS ALL_CPUS
> > > > > 
> > > > > As you can see, this is a huge raster and the csv. file (Pointed
> > > > > with a .vrt) contains over a billion points.  I am trying to do
> > > > > this in one shot to avoid boundary effects.  (I know I can split
> > > > > this .csv file into smaller bits and make this more efficient).  
> > > > > The computer I am using has 12 cores, 64BG of memory (smaller than
> > > > > the csv file) and a 1TB pcie solid state drive.  It should manage
> > > > > the task but it has been running for 5 days with less than 10%
> > > > > done).  I have access to a super computer with gdal if all else
> > > > > fails.
> > > > > 
> > > > > This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS" or
> > > > > "--config GDAL_NUM_THREADS 12" does not seem to work with the
> > > > > nearest neighbor algorithm. (It seem to work with the -a count
> > > > > command)  If I use this on a smaller data set, I see no difference
> > > > > in speed or cpu usage between using the "ALL_CPUS" or not using
> > > > > this switch.  Is this a bug or simply a limitation of the nearest
> > > > > neighbor algorithm?
> > > > 
> > > > Nicolas,
> > > > 
> > > > The threading mechanism is generic for all algorithms . Add "--debug
> > > > on" and you should see traces like "GDAL_GRID: Using 12 threads".
> > > > Now, a reason for it not being efficient is that the work buffer
> > > > used by gdalgrid (16 MB) is too small w.r.t to nearest speed. Hum,
> > > > actually looking more closely at the code, I see that the quad tree
> > > > to index the points will be rebuilt for each work buffer. This is
> > > > likely the main cause of the inefficiency and why you don't see
> > > > measurable differences between non threaded or threaded computations
> > > > (since the building of the quadtree is not multithreaded). If you
> > > > compiled from source, you could try changing the "const GUInt32
> > > > nDesiredBufferSize = 16*1024*1024;" line in apps/gdal_grid.cpp to a
> > > > much higher value. A more proper solution would be to avoid
> > > > rebuilding the quad tree for each work buffer. This is mainly code
> > > > restructuring.
> > > > 
> > > > An alternative to gdal_grid would be to use gdal_rasterize +
> > > > gdal_fillnodata. This is usually much much faster, so you could try
> > > > to check if it gives the results you expect.
> > > > 
> > > > You could also try scipy :
> > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.inte
> > > > rpol ate.griddata.html#scipy.interpolate.griddata Not sure how it
> > > > behaves with that number of points.
> > > > 
> > > > Even
> > > > 
> > > > > I don't want to move this
> > > > > to a super computer if it will not multi-thread properly.
> > > > > 
> > > > > Thanks,
> > > > > Nicolas Cadieux
> > > > > 
> > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on
> > > > > windows 7_64)  I use GDAL from the command line not from QGIS.
> > > > > 
> > > > > 
> > > > > Nicolas Cadieux M.Sc.
> > > > > Les Entreprises Arch?otec inc.
> > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > www.archeotec.ca
> > > > > _______________________________________________
> > > > > gdal-dev mailing list
> > > > > gdal-dev at lists.osgeo.org
> > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yidong80 at gmail.com  Mon Jun 15 12:40:34 2015
From: yidong80 at gmail.com (Yi Dong)
Date: Mon, 15 Jun 2015 15:40:34 -0400
Subject: [gdal-dev] gdalwarp on a separate RPC model
In-Reply-To: <201506152055.20842.even.rouault@spatialys.com>
References: <557F16DA.5080909@gmail.com>
	<201506152055.20842.even.rouault@spatialys.com>
Message-ID: <557F2A32.8080100@gmail.com>

Hi Evan,

Thanks a lot!   Your suggestion is exactly what I am looking for. To 
keep the record, here is what I did
1. gdal_translate -of VRT input.ntf input.vrt
2. modify the 'input.vrt' w.r.t. correct RPC model, name it as 
'input_correct.vrt'
3. gdalwarp -rpc -to RPC_HEIGHT=200 input_correct.vrt output.tif
4. gdaltransform input_correct.vrt for projection
5. gdaltransform -i input_correct.vrt for backprojection

Thanks everyone again for help
Ian

On 6/15/2015 2:55 PM, Even Rouault wrote:
> Le lundi 15 juin 2015 20:18:02, Yi Dong a ?crit :
>> Dear List,
>>
>> I have a question about recitify satellite images that has RPC camera
>> using gdalwarp.  I know gdalwarp can be used for this task, with using
>> RPC metadata (either packed inside the NITF or stored inside RPB files)
>> Normally, the image folder shall contain following files
>> input.ntf
>> input.rpb
>> input.imd
>> etc...
>> The command I used for this is
>> gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 rectified.tif
>>
>> Now I performed some geo-correction on the satellite image and generate
>> a corrected RPC model (with imporved offset values) and I store this
>> correct RPC camera in 'correct.rpb'.  Now I am trying to use this
>> 'correct.rpb' to recitify the image
>> I tried
>> gdalwarp -rpc input.ntf correct.rpb -to RPC_HEIGHT=200
>> recitify_corrected.tif
>> but it failed with following error
>> ERROR 4: 'correct.rpb' not recognized as a supported file format
>>
>> Then I tried to overwrite the 'input.rpb' in the image folder with my
>> 'corrected.rpb', run 'gdalwarp -rpc input.ntf -to RPC_HEIGHT=200
>> rectified.tif' again but I got exactly same results as I used the
>> original RPC model.  I guess that might be because gdalwarp used RPC
>> parameter that was packed inside NITF image itself, instead of getting
>> them from rpb files ?
>>
>> So Is there other way to use my corrected RPC model in gdal, like
>> gdalwarp, gdal_transform, etc.?
>> Also, gdaltransform doesn't not accept RPB files either.  It only
>> recognizes GDAL dataset, i.e. vrt file.  Therefore I need to generate
>> vrt file from my RPB.  Is there any vrt example for RPC camera that I
>> can follow?
> Ian,
>
> I'd suggesting gdal_translate'ing your input.ntf into a VRT, and replace the
> values in the "VRT" metadata domain with your own values. Then you can run
> gdalwarp on this VRT file
>
> Even
>


From jmckenna at gatewaygeomatics.com  Mon Jun 15 14:24:55 2015
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 15 Jun 2015 18:24:55 -0300
Subject: [gdal-dev] GDAL/OGR 2.0.0 RC2 Available for Review
In-Reply-To: <201506142128.17825.even.rouault@spatialys.com>
References: <201506142128.17825.even.rouault@spatialys.com>
Message-ID: <557F42A7.5090009@gatewaygeomatics.com>

RC2 compiles and runs on Windows.

-jeff




On 2015-06-14 4:28 PM, Even Rouault wrote:
> Hi,
>
> Due to a regression that could cause compressed GeoTIFF created by GDAL to be
> almost twice as large as their optimal size in some circumstances (see
> https://trac.osgeo.org/gdal/ticket/5999), I have prepared a RC2.
>
> The list of fixes in the 2.0 branch since RC1:
>    * Java GNUmakefile: add -f in rm commands (#5997)
>    * Doc: Add a brief summary to the GDAL and OGR utilities pages (#5996)
>    * Various typo fixes in doc and code (#5995)
>    * GTiff/block cache: fix creation of pixel interleaved multiband files (2.0
> regression, #5999)
>    * VRT: add handling of a shared='0' attribute on <SourceFilename> to open
> sources in non-shared mode, and VRT_SHARED_SOURCE config option that can be set
> to 0 in case the shared attribute isn't there (#5992)
>    * Ili: Fix crash with models using types derived from INTERLIS
>    * gdal_grid: fix crash in optimized mode with GCC 4.4 on 64bit (#5987)
>    * GDALSuggestedWarpOut2(): fix typo that could prevent detection of part of
> the error cases for #5980
>    * CPLAcquireMutex(): improve performance on Windows (#5986)
>
> Updated source code:
>
>    http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC2.tar.xz
>    http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0RC2.tar.gz
>    http://download.osgeo.org/gdal/2.0.0/gdal200RC2.zip
>
> gdal-grass plugin unchanged:
>
>    http://download.osgeo.org/gdal/2.0.0/gdal-grass-2.0.0RC1.tar.gz
>
> Updated snapshot of the gdalautotest suite:
>
>    http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC2.tar.gz
>    http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0RC2.zip
>
> Updated documentation:
>
>    http://download.osgeo.org/gdal/2.0.0/gdal200docRC2.zip
>
> I'll call for a vote promoting it to final in one day if no serious problems
> are reported.
>
> Best regards,
>
> Even
>



From nik at nikosalexandris.net  Mon Jun 15 14:39:47 2015
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Tue, 16 Jun 2015 00:39:47 +0300
Subject: [gdal-dev] gdalwarp on a separate RPC model
In-Reply-To: <557F16DA.5080909@gmail.com>
References: <557F16DA.5080909@gmail.com>
Message-ID: <20150615213947.GC30033@tpx1c2g>

* Yi Dong <yidong80 at gmail.com> [2015-06-15 14:18:02 -0400]:

> Dear List,
> 
> I have a question about recitify satellite images that has RPC camera 
> using gdalwarp.  I know gdalwarp can be used for this task, with using 
> RPC metadata (either packed inside the NITF or stored inside RPB files)
> Normally, the image folder shall contain following files
> input.ntf
> input.rpb
> input.imd
> etc...
> The command I used for this is
> gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 rectified.tif
> 
> Now I performed some geo-correction on the satellite image and generate 
> a corrected RPC model (with imporved offset values)


Deat Ian, may I ask how you generated the "corrected" RPCs after the
geometric (I guess) correction(s)?

Thank you, Nikos


> and I store this 
> correct RPC camera in 'correct.rpb'.  Now I am trying to use this 
> 'correct.rpb' to recitify the image
> I tried
> gdalwarp -rpc input.ntf correct.rpb -to RPC_HEIGHT=200 
> recitify_corrected.tif
> but it failed with following error
> ERROR 4: 'correct.rpb' not recognized as a supported file format
> 
> Then I tried to overwrite the 'input.rpb' in the image folder with my 
> 'corrected.rpb', run 'gdalwarp -rpc input.ntf -to RPC_HEIGHT=200 
> rectified.tif' again but I got exactly same results as I used the 
> original RPC model.  I guess that might be because gdalwarp used RPC 
> parameter that was packed inside NITF image itself, instead of getting 
> them from rpb files ?
> 
> So Is there other way to use my corrected RPC model in gdal, like 
> gdalwarp, gdal_transform, etc.?
> Also, gdaltransform doesn't not accept RPB files either.  It only 
> recognizes GDAL dataset, i.e. vrt file.  Therefore I need to generate 
> vrt file from my RPB.  Is there any vrt example for RPC camera that I 
> can follow?
> 
> Thanks a lot
> Ian
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Nikos Alexandris | Remote Sensing Scientist, Dr
Themidos 3, 42100, Trikala, Greece
GPG Key Fingerprint 6F9D4506F3CA28380974D31A9053534B693C4FB3 

From even.rouault at spatialys.com  Tue Jun 16 01:02:37 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Jun 2015 10:02:37 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
Message-ID: <201506161002.38083.even.rouault@spatialys.com>

Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final release.

---

No critical issue has been reported on RC2 so far, so I invite PSC 
members to vote on this motion after doing your own testing and validation. 
Input from everyone else who can test it is also very welcome.

I'll start the voting with my :

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun 16 07:58:40 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 16 Jun 2015 14:58:40 +0000 (UTC)
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
References: <201506161002.38083.even.rouault@spatialys.com>
Message-ID: <loom.20150616T165727-826@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final release.

...
> 
> I'll start the voting with my :
> 
> +1 Even

+1 

-Jukka Rahkonen- 





From nicolas.cadieux at archeotec.ca  Tue Jun 16 09:50:58 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Tue, 16 Jun 2015 12:50:58 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506152124.41336.even.rouault@spatialys.com>
Message-ID: <feafd10d-3801-456c-a08b-7f9dbc4f397b@email.android.com>

"As you're exploring new territories, I'd expect you to report how this works 
;-) "

Report no 1:

(Sharing how little I know but still trying to help:)

I have been recompiling gdal_grid with a 1 and 1.5 GB buffer instead of the usual 16 mb.  (Both files created with the 1 and 1.5GB are identical).

Increasing the buffer size makes the interpolation much faster (hour instead of weeks) but there may be a possible side effect I would like to share.

It seem that the .tiff file (84GB) is very slow to display in QGIS.  When I use gdalwarp to resave this file (without actually changing the projection or null zero values), I  create an identical file with the same dimension and pixel resolution that is blazing fast to view in QGIS.  There does not seem to be a pyramid in this new file that could explain the results.

Is it possible that by using such a big buffer, the .tiff is not encoded efficiently and that this is fixed when the file is pass through gdalwarp?



Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 15, 2015 15:24, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit : 
> > Thanks Even, 
> > One last question about the buffer. Is 2GB is the max buffer size for 
> > gdal_grid? If I select that, am I likely to run into problem with some 
> > values? 
>
> The variable is a uint32 so you could probably go up to 4 GB. 
>
> > Apart from trial and error, is there a balance that should be 
> > stuck between available computer memory (currently at 64GB), input file 
> > size and the buffer or can I simply select a 2GB buffer? 
>
> As you're exploring new territories, I'd expect you to report how this works 
> ;-) 
>
> > 
> > Merci beaucoup pour votre aide. 
> > 
> > Nicolas Cadieux M.Sc. 
> > Les Entreprises Arch?otec inc. 
> > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > www.archeotec.ca 
> > 
> > On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> wrote: 
> > > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit : 
> > > > Hi Even, 
> > > > Thank you very much.? I increased the buffer to 1.5 GB 
> > > > (512+512+514)*1024*1024 and I can now work much much faster with 
> > > > gdal_grid. 
> > > > 
> > > > Does gdal_fillnodata have the same type of variable that could speed 
> > > > things up?? It is also slow and does not seem speeded up by the 
> > > > "All_CPUS". 
> > > 
> > > No, no tunable for fillnodata, and it doesn't support multi-threaded 
> > > parallelization. 
> > > 
> > > > I will use warp and the raster calculator in the future so you have 
> > > > more magic up your sleeve, I would appreciate it. 
> > > > 
> > > > Cheers and thanks again. 
> > > > 
> > > > Nicolas Cadieux M.Sc. 
> > > > Les Entreprises Arch?otec inc. 
> > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > www.archeotec.ca 
> > > > 
> > > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> wrote: 
> > > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit : 
> > > > > > Hi, 
> > > > > > I have been using gdal_grid to interpolate LiDAR data for some time 
> > > > > > now. This would be a typical command: 
> > > > > > 
> > > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 348733.0 
> > > > > > 401135.0 -tye 5568587.0 5773796.0 -a 
> > > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 
> > > > > > 52402.0 205209.0 -of GTiff 
> > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.vrt 
> > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.tif 
> > > > > > --confi g GDAL_NUM_THREADS ALL_CPUS 
> > > > > > 
> > > > > > As you can see, this is a huge raster and the csv. file (Pointed 
> > > > > > with a .vrt) contains over a billion points.? I am trying to do 
> > > > > > this in one shot to avoid boundary effects.? (I know I can split 
> > > > > > this .csv file into smaller bits and make this more efficient).? 
> > > > > > The computer I am using has 12 cores, 64BG of memory (smaller than 
> > > > > > the csv file) and a 1TB pcie solid state drive.? It should manage 
> > > > > > the task but it has been running for 5 days with less than 10% 
> > > > > > done).? I have access to a super computer with gdal if all else 
> > > > > > fails. 
> > > > > > 
> > > > > > This is my question.? The "--config GDAL_NUM_THREADS ALL_CPUS" or 
> > > > > > "--config GDAL_NUM_THREADS 12" does not seem to work with the 
> > > > > > nearest neighbor algorithm. (It seem to work with the -a count 
> > > > > > command)? If I use this on a smaller data set, I see no difference 
> > > > > > in speed or cpu usage between using the "ALL_CPUS" or not using 
> > > > > > this switch.? Is this a bug or simply a limitation of the nearest 
> > > > > > neighbor algorithm? 
> > > > > 
> > > > > Nicolas, 
> > > > > 
> > > > > The threading mechanism is generic for all algorithms . Add "--debug 
> > > > > on" and you should see traces like "GDAL_GRID: Using 12 threads". 
> > > > > Now, a reason for it not being efficient is that the work buffer 
> > > > > used by gdalgrid (16 MB) is too small w.r.t to nearest speed. Hum, 
> > > > > actually looking more closely at the code, I see that the quad tree 
> > > > > to index the points will be rebuilt for each work buffer. This is 
> > > > > likely the main cause of the inefficiency and why you don't see 
> > > > > measurable differences between non threaded or threaded computations 
> > > > > (since the building of the quadtree is not multithreaded). If you 
> > > > > compiled from source, you could try changing the "const GUInt32 
> > > > > nDesiredBufferSize = 16*1024*1024;" line in apps/gdal_grid.cpp to a 
> > > > > much higher value. A more proper solution would be to avoid 
> > > > > rebuilding the quad tree for each work buffer. This is mainly code 
> > > > > restructuring. 
> > > > > 
> > > > > An alternative to gdal_grid would be to use gdal_rasterize + 
> > > > > gdal_fillnodata. This is usually much much faster, so you could try 
> > > > > to check if it gives the results you expect. 
> > > > > 
> > > > > You could also try scipy : 
> > > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.inte 
> > > > > rpol ate.griddata.html#scipy.interpolate.griddata Not sure how it 
> > > > > behaves with that number of points. 
> > > > > 
> > > > > Even 
> > > > > 
> > > > > > I don't want to move this 
> > > > > > to a super computer if it will not multi-thread properly. 
> > > > > > 
> > > > > > Thanks, 
> > > > > > Nicolas Cadieux 
> > > > > > 
> > > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8 on 
> > > > > > windows 7_64)? I use GDAL from the command line not from QGIS. 
> > > > > > 
> > > > > > 
> > > > > > Nicolas Cadieux M.Sc. 
> > > > > > Les Entreprises Arch?otec inc. 
> > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > > > www.archeotec.ca 
> > > > > > _______________________________________________ 
> > > > > > gdal-dev mailing list 
> > > > > > gdal-dev at lists.osgeo.org 
> > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com 

From even.rouault at spatialys.com  Tue Jun 16 10:00:45 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Jun 2015 19:00:45 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <feafd10d-3801-456c-a08b-7f9dbc4f397b@email.android.com>
References: <feafd10d-3801-456c-a08b-7f9dbc4f397b@email.android.com>
Message-ID: <201506161900.45641.even.rouault@spatialys.com>

Le mardi 16 juin 2015 18:50:58, Nicolas Cadieux a ?crit :
> "As you're exploring new territories, I'd expect you to report how this
> works ;-) "
> 
> Report no 1:
> 
> (Sharing how little I know but still trying to help:)
> 
> I have been recompiling gdal_grid with a 1 and 1.5 GB buffer instead of the
> usual 16 mb.  (Both files created with the 1 and 1.5GB are identical).
> 
> Increasing the buffer size makes the interpolation much faster (hour
> instead of weeks) but there may be a possible side effect I would like to
> share.
> 
> It seem that the .tiff file (84GB) is very slow to display in QGIS.  When I
> use gdalwarp to resave this file (without actually changing the projection
> or null zero values), I  create an identical file with the same dimension
> and pixel resolution that is blazing fast to view in QGIS.  There does not
> seem to be a pyramid in this new file that could explain the results.
> 
> Is it possible that by using such a big buffer, the .tiff is not encoded
> efficiently and that this is fixed when the file is pass through gdalwarp?

Ah, no, this is a "well known" behaviour of gdal_grid. It creates an image 
whose origin is the bottom-left of the image (instead of the upper-left 
usually). Consequently QGIS must creates a warp VRT to get a more classical 
dataset, which slow down things.

A trick to generate directly a file with upper-left origin is to specify "-tye 
ymax ymin" (instead of "-tye ymin ymax")

I guess this behaviour of gdal_grid should be changed as it regularly annoys 
people.

> 
> 
> 
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc. 
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
> 
> On Jun 15, 2015 15:24, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit :
> > > Thanks Even,
> > > One last question about the buffer. Is 2GB is the max buffer size for
> > > gdal_grid? If I select that, am I likely to run into problem with some
> > > values?
> > 
> > The variable is a uint32 so you could probably go up to 4 GB.
> > 
> > > Apart from trial and error, is there a balance that should be
> > > stuck between available computer memory (currently at 64GB), input file
> > > size and the buffer or can I simply select a 2GB buffer?
> > 
> > As you're exploring new territories, I'd expect you to report how this
> > works ;-)
> > 
> > > Merci beaucoup pour votre aide.
> > > 
> > > Nicolas Cadieux M.Sc.
> > > Les Entreprises Arch?otec inc.
> > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > www.archeotec.ca
> > > 
> > > On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> wrote:
> > > > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> > > > > Hi Even,
> > > > > Thank you very much.  I increased the buffer to 1.5 GB
> > > > > (512+512+514)*1024*1024 and I can now work much much faster with
> > > > > gdal_grid.
> > > > > 
> > > > > Does gdal_fillnodata have the same type of variable that could
> > > > > speed things up?  It is also slow and does not seem speeded up by
> > > > > the "All_CPUS".
> > > > 
> > > > No, no tunable for fillnodata, and it doesn't support multi-threaded
> > > > parallelization.
> > > > 
> > > > > I will use warp and the raster calculator in the future so you have
> > > > > more magic up your sleeve, I would appreciate it.
> > > > > 
> > > > > Cheers and thanks again.
> > > > > 
> > > > > Nicolas Cadieux M.Sc.
> > > > > Les Entreprises Arch?otec inc.
> > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > www.archeotec.ca
> > > > > 
> > > > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > > > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > > > > > Hi,
> > > > > > > I have been using gdal_grid to interpolate LiDAR data for some
> > > > > > > time now. This would be a typical command:
> > > > > > > 
> > > > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe
> > > > > > > 348733.0 401135.0 -tye 5568587.0 5773796.0 -a
> > > > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize
> > > > > > > 52402.0 205209.0 -of GTiff
> > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529.
> > > > > > > vrt
> > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_150529
> > > > > > > .tif --confi g GDAL_NUM_THREADS ALL_CPUS
> > > > > > > 
> > > > > > > As you can see, this is a huge raster and the csv. file
> > > > > > > (Pointed with a .vrt) contains over a billion points.  I am
> > > > > > > trying to do this in one shot to avoid boundary effects.  (I
> > > > > > > know I can split this .csv file into smaller bits and make
> > > > > > > this more efficient). The computer I am using has 12 cores,
> > > > > > > 64BG of memory (smaller than the csv file) and a 1TB pcie
> > > > > > > solid state drive.  It should manage the task but it has been
> > > > > > > running for 5 days with less than 10% done).  I have access to
> > > > > > > a super computer with gdal if all else fails.
> > > > > > > 
> > > > > > > This is my question.  The "--config GDAL_NUM_THREADS ALL_CPUS"
> > > > > > > or "--config GDAL_NUM_THREADS 12" does not seem to work with
> > > > > > > the nearest neighbor algorithm. (It seem to work with the -a
> > > > > > > count command)  If I use this on a smaller data set, I see no
> > > > > > > difference in speed or cpu usage between using the "ALL_CPUS"
> > > > > > > or not using this switch.  Is this a bug or simply a
> > > > > > > limitation of the nearest neighbor algorithm?
> > > > > > 
> > > > > > Nicolas,
> > > > > > 
> > > > > > The threading mechanism is generic for all algorithms . Add
> > > > > > "--debug on" and you should see traces like "GDAL_GRID: Using 12
> > > > > > threads". Now, a reason for it not being efficient is that the
> > > > > > work buffer used by gdalgrid (16 MB) is too small w.r.t to
> > > > > > nearest speed. Hum, actually looking more closely at the code, I
> > > > > > see that the quad tree to index the points will be rebuilt for
> > > > > > each work buffer. This is likely the main cause of the
> > > > > > inefficiency and why you don't see measurable differences
> > > > > > between non threaded or threaded computations (since the
> > > > > > building of the quadtree is not multithreaded). If you compiled
> > > > > > from source, you could try changing the "const GUInt32
> > > > > > nDesiredBufferSize = 16*1024*1024;" line in apps/gdal_grid.cpp
> > > > > > to a much higher value. A more proper solution would be to avoid
> > > > > > rebuilding the quad tree for each work buffer. This is mainly
> > > > > > code restructuring.
> > > > > > 
> > > > > > An alternative to gdal_grid would be to use gdal_rasterize +
> > > > > > gdal_fillnodata. This is usually much much faster, so you could
> > > > > > try to check if it gives the results you expect.
> > > > > > 
> > > > > > You could also try scipy :
> > > > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.
> > > > > > inte rpol ate.griddata.html#scipy.interpolate.griddata Not sure
> > > > > > how it behaves with that number of points.
> > > > > > 
> > > > > > Even
> > > > > > 
> > > > > > > I don't want to move this
> > > > > > > to a super computer if it will not multi-thread properly.
> > > > > > > 
> > > > > > > Thanks,
> > > > > > > Nicolas Cadieux
> > > > > > > 
> > > > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 2.8
> > > > > > > on windows 7_64)  I use GDAL from the command line not from
> > > > > > > QGIS.
> > > > > > > 
> > > > > > > 
> > > > > > > Nicolas Cadieux M.Sc.
> > > > > > > Les Entreprises Arch?otec inc.
> > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > > www.archeotec.ca
> > > > > > > _______________________________________________
> > > > > > > gdal-dev mailing list
> > > > > > > gdal-dev at lists.osgeo.org
> > > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Wed Jun 17 06:11:31 2015
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 17 Jun 2015 10:11:31 -0300
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <201506161002.38083.even.rouault@spatialys.com>
References: <201506161002.38083.even.rouault@spatialys.com>
Message-ID: <55817203.4000605@gatewaygeomatics.com>

On 2015-06-16 5:02 AM, Even Rouault wrote:
> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final release.
>
+1



-jeff







From even.rouault at spatialys.com  Thu Jun 18 02:26:48 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 11:26:48 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <201506161002.38083.even.rouault@spatialys.com>
References: <201506161002.38083.even.rouault@spatialys.com>
Message-ID: <201506181126.49095.even.rouault@spatialys.com>

Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
> release.
> 
> ---
> 
> No critical issue has been reported on RC2 so far, so I invite PSC
> members to vote on this motion after doing your own testing and validation.
> Input from everyone else who can test it is also very welcome.
> 
> I'll start the voting with my :
> 
> +1 Even

Technically, there's only +1 from Jukka and myself on this motion after 2 
business days. I'd appreciate more votes from other PSC members.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Thu Jun 18 05:01:42 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 18 Jun 2015 14:01:42 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <201506181126.49095.even.rouault@spatialys.com>
References: <201506161002.38083.even.rouault@spatialys.com>
	<201506181126.49095.even.rouault@spatialys.com>
Message-ID: <CACALY+QmrHO0wkC6s7p7A9u1+_+7sQUr1Y3s4k7290nujbHphg@mail.gmail.com>

+1

Tamas

2015-06-18 11:26 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
> > Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
> > release.
> >
> > ---
> >
> > No critical issue has been reported on RC2 so far, so I invite PSC
> > members to vote on this motion after doing your own testing and
> validation.
> > Input from everyone else who can test it is also very welcome.
> >
> > I'll start the voting with my :
> >
> > +1 Even
>
> Technically, there's only +1 from Jukka and myself on this motion after 2
> business days. I'd appreciate more votes from other PSC members.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150618/3bc09674/attachment.html>

From howard at hobu.co  Thu Jun 18 05:48:34 2015
From: howard at hobu.co (Howard Butler)
Date: Thu, 18 Jun 2015 07:48:34 -0500
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <CACALY+QmrHO0wkC6s7p7A9u1+_+7sQUr1Y3s4k7290nujbHphg@mail.gmail.com>
References: <201506161002.38083.even.rouault@spatialys.com>
	<201506181126.49095.even.rouault@spatialys.com>
	<CACALY+QmrHO0wkC6s7p7A9u1+_+7sQUr1Y3s4k7290nujbHphg@mail.gmail.com>
Message-ID: <0E76386B-9443-4A5C-9E96-A7869ED4143E@hobu.co>

+1

Howard

> On Jun 18, 2015, at 7:01 AM, Tamas Szekeres <szekerest at gmail.com> wrote:
> 
> +1
> 
> Tamas
> 
> 2015-06-18 11:26 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
> > Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
> > release.
> >
> > ---
> >
> > No critical issue has been reported on RC2 so far, so I invite PSC
> > members to vote on this motion after doing your own testing and validation.
> > Input from everyone else who can test it is also very welcome.
> >
> > I'll start the voting with my :
> >
> > +1 Even
> 
> Technically, there's only +1 from Jukka and myself on this motion after 2
> business days. I'd appreciate more votes from other PSC members.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From dmorissette at mapgears.com  Thu Jun 18 06:12:39 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Thu, 18 Jun 2015 09:12:39 -0400
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <201506181126.49095.even.rouault@spatialys.com>
References: <201506161002.38083.even.rouault@spatialys.com>
	<201506181126.49095.even.rouault@spatialys.com>
Message-ID: <5582C3C7.7010104@mapgears.com>

+1

Daniel

On 2015-06-18 5:26 AM, Even Rouault wrote:
> Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
>> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
>> release.
>>
>> ---
>>
>> No critical issue has been reported on RC2 so far, so I invite PSC
>> members to vote on this motion after doing your own testing and validation.
>> Input from everyone else who can test it is also very welcome.
>>
>> I'll start the voting with my :
>>
>> +1 Even
>
> Technically, there's only +1 from Jukka and myself on this motion after 2
> business days. I'd appreciate more votes from other PSC members.
>
> Even
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From watson at sierracmp.com  Thu Jun 18 06:37:01 2015
From: watson at sierracmp.com (George Watson)
Date: Thu, 18 Jun 2015 07:37:01 -0600
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <5582C3C7.7010104@mapgears.com>
References: <201506161002.38083.even.rouault@spatialys.com>
	<201506181126.49095.even.rouault@spatialys.com>
	<5582C3C7.7010104@mapgears.com>
Message-ID: <0F5B81B4-7B4E-4661-A2CA-F43ACE12F3ED@sierracmp.com>

+1

After a bit of testing on with our applications.

George K. Watson

> On Jun 18, 2015, at 7:12 AM, Daniel Morissette <dmorissette at mapgears.com> wrote:
> 
> +1
> 
> Daniel
> 
> On 2015-06-18 5:26 AM, Even Rouault wrote:
>> Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
>>> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
>>> release.
>>> 
>>> ---
>>> 
>>> No critical issue has been reported on RC2 so far, so I invite PSC
>>> members to vote on this motion after doing your own testing and validation.
>>> Input from everyone else who can test it is also very welcome.
>>> 
>>> I'll start the voting with my :
>>> 
>>> +1 Even
>> 
>> Technically, there's only +1 from Jukka and myself on this motion after 2
>> business days. I'd appreciate more votes from other PSC members.
>> 
>> Even
>> 
> 
> 
> -- 
> Daniel Morissette
> http://www.mapgears.com/
> T: +1 418-696-5056 #201
> 
> http://evouala.com/ - Location Intelligence Made Easy
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


From a.neumann at carto.net  Thu Jun 18 06:50:22 2015
From: a.neumann at carto.net (Andreas Neumann)
Date: Thu, 18 Jun 2015 15:50:22 +0200
Subject: [gdal-dev] Question on WFS and encoding
Message-ID: <5582CC9E.4010206@carto.net>

Hi,

I want to transform a WFS to Postgis, using this WFS service:

http://wms.zh.ch/NEKWMS with the layer "landwirtschaftliche-nutzungseignung"

While this works fine, there seems to be an issue with encoding. German 
Umlauts are not correctly displayed after the transformation. Is there a 
way to specify the encoding in ogr2ogr or with some options for WFS?

http://www.gdal.org/drv_wfs.html does not list an encoding option.

Or is it a misconfiguration of the server, if the Umlauts do not display 
correctly?

Thank you for any hints!

Andreas

From even.rouault at spatialys.com  Thu Jun 18 07:16:36 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 16:16:36 +0200
Subject: [gdal-dev] Question on WFS and encoding
In-Reply-To: <5582CC9E.4010206@carto.net>
References: <5582CC9E.4010206@carto.net>
Message-ID: <201506181616.36212.even.rouault@spatialys.com>

Le jeudi 18 juin 2015 15:50:22, Andreas Neumann a ?crit :
> Hi,
> 
> I want to transform a WFS to Postgis, using this WFS service:
> 
> http://wms.zh.ch/NEKWMS with the layer
> "landwirtschaftliche-nutzungseignung"
> 
> While this works fine, there seems to be an issue with encoding. German
> Umlauts are not correctly displayed after the transformation.
> Is there a
> way to specify the encoding in ogr2ogr or with some options for WFS?
> 
> http://www.gdal.org/drv_wfs.html does not list an encoding option.
> 
> Or is it a misconfiguration of the server, if the Umlauts do not display
> correctly?

Andreas,

I think this is an issue with the server that declares <?xml version='1.0' 
encoding="ISO-8859-1" ?> in the header of its GetFeature response, but the 
content really is in UTF-8.

As it seems to be a MapServer service, I guess the following is missing in the 
WEB metadata section of the mapfile (for MapServer < 7), since the default is 
ISO-8859-1 :
"wfs_encoding" "UTF-8"

No easy workaround on OGR side since the OGR GML driver will honour the XML 
encoding indication to do recoding (from what it assumes to be ISO-8859-1, but 
is UTF-8) to UTF-8...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150618/2f4dde17/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 18 07:27:00 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 18 Jun 2015 14:27:00 +0000 (UTC)
Subject: [gdal-dev] Question on WFS and encoding
References: <5582CC9E.4010206@carto.net>
	<201506181616.36212.even.rouault@spatialys.com>
Message-ID: <loom.20150618T162229-839@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

 
> No easy workaround on OGR side since the OGR GML driver will honour the
XML encoding indication to do recoding (from what it assumes to be
ISO-8859-1, but is UTF-8) to UTF-8...

Hi,

If you just need the data a non-OGR workaround is to save the GML on disk
and correct the encoding string by hand or with sed or something.

-Jukka Rahkonen-



From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 18 07:35:37 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 18 Jun 2015 14:35:37 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?Gdal=5Ftranslate_considers_--config_means_-c?=
	=?utf-8?q?o?=
Message-ID: <loom.20150618T162721-767@post.gmane.org>

Hi,

Spotted this from gis.stackexchange
http://gis.stackexchange.com/questions/151153/is-gdal-translate-ignoring-the-cpl-tmpdir-switch

I repeated the test on Windows with GDAL 2.0 and it seems indeed that using
--config option in the beginning of gdal_translate command fails. Like it
would be cut at "-co" and interpreted to mean something totally different.
Moving --config to the end of the command leads to success.

-Jukka Rahkonen-


From a.neumann at carto.net  Thu Jun 18 07:38:49 2015
From: a.neumann at carto.net (Andreas Neumann)
Date: Thu, 18 Jun 2015 16:38:49 +0200
Subject: [gdal-dev] Question on WFS and encoding
In-Reply-To: <loom.20150618T162229-839@post.gmane.org>
References: <5582CC9E.4010206@carto.net>	<201506181616.36212.even.rouault@spatialys.com>
	<loom.20150618T162229-839@post.gmane.org>
Message-ID: <5582D7F9.8090705@carto.net>

Thanks for the temporary workaround - but it is for the server admin to 
fix the issue.

Andreas

On 18.06.2015 16:27, Jukka Rahkonen wrote:
> Even Rouault <even.rouault <at> spatialys.com> writes:
>
>   
>> No easy workaround on OGR side since the OGR GML driver will honour the
> XML encoding indication to do recoding (from what it assumes to be
> ISO-8859-1, but is UTF-8) to UTF-8...
>
> Hi,
>
> If you just need the data a non-OGR workaround is to save the GML on disk
> and correct the encoding string by hand or with sed or something.
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu Jun 18 07:58:11 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 16:58:11 +0200
Subject: [gdal-dev] Gdal_translate considers --config means -co
In-Reply-To: <loom.20150618T162721-767@post.gmane.org>
References: <loom.20150618T162721-767@post.gmane.org>
Message-ID: <201506181658.11690.even.rouault@spatialys.com>

Le jeudi 18 juin 2015 16:35:37, Jukka Rahkonen a ?crit :
> Hi,
> 
> Spotted this from gis.stackexchange
> http://gis.stackexchange.com/questions/151153/is-gdal-translate-ignoring-th
> e-cpl-tmpdir-switch
> 
> I repeated the test on Windows with GDAL 2.0 and it seems indeed that using
> --config option in the beginning of gdal_translate command fails. Like it
> would be cut at "-co" and interpreted to mean something totally different.
> Moving --config to the end of the command leads to success.

Weird. I can't replicate the issue and have no idea why that would happen.

For the record I tried :
gdal_translate --config CPL_TMPDIR /tmp/foo -of kmlsuperoverlay 
../autotest/gcore/data/byte.tif byte.kmz

Anyway since 1.11, the KMLSuperOverlay driver doesn't produce any more any 
temporary file (and in previous versions it didn't honour CPL_TMPDIR)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 18 08:20:24 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 18 Jun 2015 15:20:24 +0000
Subject: [gdal-dev] Gdal_translate considers --config means -co
Message-ID: <77d3a9dff9e94e3abda12c2e84de9d22@C119S212VM022.msvyvi.vaha.local>

Even Rouault wrote

> Le jeudi 18 juin 2015 16:35:37, Jukka Rahkonen a ?crit :
>> Hi,
>> 
>> Spotted this from gis.stackexchange
>> http://gis.stackexchange.com/questions/151153/is-gdal-translate-ignori
>> ng-th
>> e-cpl-tmpdir-switch
>> 
>> I repeated the test on Windows with GDAL 2.0 and it seems indeed that 
>> using --config option in the beginning of gdal_translate command 
>> fails. Like it would be cut at "-co" and interpreted to mean something totally different.
>> Moving --config to the end of the command leads to success.

> Weird. I can't replicate the issue and have no idea why that would happen.

You are right, it does not happen. I had a typo in my test command and as a result I received a message which I did not read carefully
"FAILURE: Too many command options."

So, "command options" and not anything related with "--command" nor creation options "-co". 
With a proper command everything works for me.

-Jukka-



From even.rouault at spatialys.com  Thu Jun 18 08:43:19 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 17:43:19 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506161900.45641.even.rouault@spatialys.com>
References: <feafd10d-3801-456c-a08b-7f9dbc4f397b@email.android.com>
	<201506161900.45641.even.rouault@spatialys.com>
Message-ID: <201506181743.19692.even.rouault@spatialys.com>

Le mardi 16 juin 2015 19:00:45, Even Rouault a ?crit :
> Le mardi 16 juin 2015 18:50:58, Nicolas Cadieux a ?crit :
> > "As you're exploring new territories, I'd expect you to report how this
> > works ;-) "
> > 
> > Report no 1:
> > 
> > (Sharing how little I know but still trying to help:)
> > 
> > I have been recompiling gdal_grid with a 1 and 1.5 GB buffer instead of
> > the usual 16 mb.  (Both files created with the 1 and 1.5GB are
> > identical).
> > 
> > Increasing the buffer size makes the interpolation much faster (hour
> > instead of weeks) but there may be a possible side effect I would like to
> > share.
> > 
> > It seem that the .tiff file (84GB) is very slow to display in QGIS.  When
> > I use gdalwarp to resave this file (without actually changing the
> > projection or null zero values), I  create an identical file with the
> > same dimension and pixel resolution that is blazing fast to view in
> > QGIS.  There does not seem to be a pyramid in this new file that could
> > explain the results.
> > 
> > Is it possible that by using such a big buffer, the .tiff is not encoded
> > efficiently and that this is fixed when the file is pass through
> > gdalwarp?
> 
> Ah, no, this is a "well known" behaviour of gdal_grid. It creates an image
> whose origin is the bottom-left of the image (instead of the upper-left
> usually). Consequently QGIS must creates a warp VRT to get a more classical
> dataset, which slow down things.
> 
> A trick to generate directly a file with upper-left origin is to specify
> "-tye ymax ymin" (instead of "-tye ymin ymax")
> 
> I guess this behaviour of gdal_grid should be changed as it regularly
> annoys people.

Note: I've committed yesterday in gdal trunk 2.1dev several improvements :
- the refactorization I mentionned some time ago, to avoid the quad tree to be 
rebuilt each time, which makes the increasing of the buffer size less necessary
- a new algorithm, linear, which is way much much faster than any other 
existing algorithm and tends to generate better results

> 
> > Nicolas Cadieux M.Sc.
> > Les Entreprises Arch?otec inc.
> > 8548, rue Saint-Denis Montr?al H2P 2H2
> > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > www.archeotec.ca
> > 
> > On Jun 15, 2015 15:24, Even Rouault <even.rouault at spatialys.com> wrote:
> > > Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit :
> > > > Thanks Even,
> > > > One last question about the buffer. Is 2GB is the max buffer size for
> > > > gdal_grid? If I select that, am I likely to run into problem with
> > > > some values?
> > > 
> > > The variable is a uint32 so you could probably go up to 4 GB.
> > > 
> > > > Apart from trial and error, is there a balance that should be
> > > > stuck between available computer memory (currently at 64GB), input
> > > > file size and the buffer or can I simply select a 2GB buffer?
> > > 
> > > As you're exploring new territories, I'd expect you to report how this
> > > works ;-)
> > > 
> > > > Merci beaucoup pour votre aide.
> > > > 
> > > > Nicolas Cadieux M.Sc.
> > > > Les Entreprises Arch?otec inc.
> > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > www.archeotec.ca
> > > > 
> > > > On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > > > > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> > > > > > Hi Even,
> > > > > > Thank you very much.  I increased the buffer to 1.5 GB
> > > > > > (512+512+514)*1024*1024 and I can now work much much faster with
> > > > > > gdal_grid.
> > > > > > 
> > > > > > Does gdal_fillnodata have the same type of variable that could
> > > > > > speed things up?  It is also slow and does not seem speeded up by
> > > > > > the "All_CPUS".
> > > > > 
> > > > > No, no tunable for fillnodata, and it doesn't support
> > > > > multi-threaded parallelization.
> > > > > 
> > > > > > I will use warp and the raster calculator in the future so you
> > > > > > have more magic up your sleeve, I would appreciate it.
> > > > > > 
> > > > > > Cheers and thanks again.
> > > > > > 
> > > > > > Nicolas Cadieux M.Sc.
> > > > > > Les Entreprises Arch?otec inc.
> > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > www.archeotec.ca
> > > > > > 
> > > > > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > > > > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > > > > > > Hi,
> > > > > > > > I have been using gdal_grid to interpolate LiDAR data for
> > > > > > > > some time now. This would be a typical command:
> > > > > > > > 
> > > > > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe
> > > > > > > > 348733.0 401135.0 -tye 5568587.0 5773796.0 -a
> > > > > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize
> > > > > > > > 52402.0 205209.0 -of GTiff
> > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_15052
> > > > > > > > 9. vrt
> > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_15052
> > > > > > > > 9 .tif --confi g GDAL_NUM_THREADS ALL_CPUS
> > > > > > > > 
> > > > > > > > As you can see, this is a huge raster and the csv. file
> > > > > > > > (Pointed with a .vrt) contains over a billion points.  I am
> > > > > > > > trying to do this in one shot to avoid boundary effects.  (I
> > > > > > > > know I can split this .csv file into smaller bits and make
> > > > > > > > this more efficient). The computer I am using has 12 cores,
> > > > > > > > 64BG of memory (smaller than the csv file) and a 1TB pcie
> > > > > > > > solid state drive.  It should manage the task but it has been
> > > > > > > > running for 5 days with less than 10% done).  I have access
> > > > > > > > to a super computer with gdal if all else fails.
> > > > > > > > 
> > > > > > > > This is my question.  The "--config GDAL_NUM_THREADS
> > > > > > > > ALL_CPUS" or "--config GDAL_NUM_THREADS 12" does not seem to
> > > > > > > > work with the nearest neighbor algorithm. (It seem to work
> > > > > > > > with the -a count command)  If I use this on a smaller data
> > > > > > > > set, I see no difference in speed or cpu usage between using
> > > > > > > > the "ALL_CPUS" or not using this switch.  Is this a bug or
> > > > > > > > simply a limitation of the nearest neighbor algorithm?
> > > > > > > 
> > > > > > > Nicolas,
> > > > > > > 
> > > > > > > The threading mechanism is generic for all algorithms . Add
> > > > > > > "--debug on" and you should see traces like "GDAL_GRID: Using
> > > > > > > 12 threads". Now, a reason for it not being efficient is that
> > > > > > > the work buffer used by gdalgrid (16 MB) is too small w.r.t to
> > > > > > > nearest speed. Hum, actually looking more closely at the code,
> > > > > > > I see that the quad tree to index the points will be rebuilt
> > > > > > > for each work buffer. This is likely the main cause of the
> > > > > > > inefficiency and why you don't see measurable differences
> > > > > > > between non threaded or threaded computations (since the
> > > > > > > building of the quadtree is not multithreaded). If you
> > > > > > > compiled from source, you could try changing the "const
> > > > > > > GUInt32 nDesiredBufferSize = 16*1024*1024;" line in
> > > > > > > apps/gdal_grid.cpp to a much higher value. A more proper
> > > > > > > solution would be to avoid rebuilding the quad tree for each
> > > > > > > work buffer. This is mainly code restructuring.
> > > > > > > 
> > > > > > > An alternative to gdal_grid would be to use gdal_rasterize +
> > > > > > > gdal_fillnodata. This is usually much much faster, so you could
> > > > > > > try to check if it gives the results you expect.
> > > > > > > 
> > > > > > > You could also try scipy :
> > > > > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scip
> > > > > > > y. inte rpol ate.griddata.html#scipy.interpolate.griddata Not
> > > > > > > sure how it behaves with that number of points.
> > > > > > > 
> > > > > > > Even
> > > > > > > 
> > > > > > > > I don't want to move this
> > > > > > > > to a super computer if it will not multi-thread properly.
> > > > > > > > 
> > > > > > > > Thanks,
> > > > > > > > Nicolas Cadieux
> > > > > > > > 
> > > > > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS
> > > > > > > > 2.8 on windows 7_64)  I use GDAL from the command line not
> > > > > > > > from QGIS.
> > > > > > > > 
> > > > > > > > 
> > > > > > > > Nicolas Cadieux M.Sc.
> > > > > > > > Les Entreprises Arch?otec inc.
> > > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > > > www.archeotec.ca
> > > > > > > > _______________________________________________
> > > > > > > > gdal-dev mailing list
> > > > > > > > gdal-dev at lists.osgeo.org
> > > > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nicolas.cadieux at archeotec.ca  Thu Jun 18 08:51:20 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Thu, 18 Jun 2015 11:51:20 -0400
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <201506181743.19692.even.rouault@spatialys.com>
Message-ID: <80747aef-5e34-444e-8572-24339b4ccc02@email.android.com>

Thanks,

That is good news.

Is the buffer still at 16 mb? If so, why keep it this low?   Lidar is very demanding even for the best rigs.

I will  test out the algorithms and keep you posted on differences between nn models.  Will recompile if the buffer is still at 16 mg.  I will also look at the new linear interpolation.  

Nicolas

Nicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.ca

On Jun 18, 2015 11:43, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Le mardi 16 juin 2015 19:00:45, Even Rouault a ?crit : 
> > Le mardi 16 juin 2015 18:50:58, Nicolas Cadieux a ?crit : 
> > > "As you're exploring new territories, I'd expect you to report how this 
> > > works ;-) " 
> > > 
> > > Report no 1: 
> > > 
> > > (Sharing how little I know but still trying to help:) 
> > > 
> > > I have been recompiling gdal_grid with a 1 and 1.5 GB buffer instead of 
> > > the usual 16 mb.? (Both files created with the 1 and 1.5GB are 
> > > identical). 
> > > 
> > > Increasing the buffer size makes the interpolation much faster (hour 
> > > instead of weeks) but there may be a possible side effect I would like to 
> > > share. 
> > > 
> > > It seem that the .tiff file (84GB) is very slow to display in QGIS.? When 
> > > I use gdalwarp to resave this file (without actually changing the 
> > > projection or null zero values), I? create an identical file with the 
> > > same dimension and pixel resolution that is blazing fast to view in 
> > > QGIS.? There does not seem to be a pyramid in this new file that could 
> > > explain the results. 
> > > 
> > > Is it possible that by using such a big buffer, the .tiff is not encoded 
> > > efficiently and that this is fixed when the file is pass through 
> > > gdalwarp? 
> > 
> > Ah, no, this is a "well known" behaviour of gdal_grid. It creates an image 
> > whose origin is the bottom-left of the image (instead of the upper-left 
> > usually). Consequently QGIS must creates a warp VRT to get a more classical 
> > dataset, which slow down things. 
> > 
> > A trick to generate directly a file with upper-left origin is to specify 
> > "-tye ymax ymin" (instead of "-tye ymin ymax") 
> > 
> > I guess this behaviour of gdal_grid should be changed as it regularly 
> > annoys people. 
>
> Note: I've committed yesterday in gdal trunk 2.1dev several improvements : 
> - the refactorization I mentionned some time ago, to avoid the quad tree to be 
> rebuilt each time, which makes the increasing of the buffer size less necessary 
> - a new algorithm, linear, which is way much much faster than any other 
> existing algorithm and tends to generate better results 
>
> > 
> > > Nicolas Cadieux M.Sc. 
> > > Les Entreprises Arch?otec inc. 
> > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > www.archeotec.ca 
> > > 
> > > On Jun 15, 2015 15:24, Even Rouault <even.rouault at spatialys.com> wrote: 
> > > > Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit : 
> > > > > Thanks Even, 
> > > > > One last question about the buffer. Is 2GB is the max buffer size for 
> > > > > gdal_grid? If I select that, am I likely to run into problem with 
> > > > > some values? 
> > > > 
> > > > The variable is a uint32 so you could probably go up to 4 GB. 
> > > > 
> > > > > Apart from trial and error, is there a balance that should be 
> > > > > stuck between available computer memory (currently at 64GB), input 
> > > > > file size and the buffer or can I simply select a 2GB buffer? 
> > > > 
> > > > As you're exploring new territories, I'd expect you to report how this 
> > > > works ;-) 
> > > > 
> > > > > Merci beaucoup pour votre aide. 
> > > > > 
> > > > > Nicolas Cadieux M.Sc. 
> > > > > Les Entreprises Arch?otec inc. 
> > > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > > www.archeotec.ca 
> > > > > 
> > > > > On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com> 
> wrote: 
> > > > > > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit : 
> > > > > > > Hi Even, 
> > > > > > > Thank you very much.? I increased the buffer to 1.5 GB 
> > > > > > > (512+512+514)*1024*1024 and I can now work much much faster with 
> > > > > > > gdal_grid. 
> > > > > > > 
> > > > > > > Does gdal_fillnodata have the same type of variable that could 
> > > > > > > speed things up?? It is also slow and does not seem speeded up by 
> > > > > > > the "All_CPUS". 
> > > > > > 
> > > > > > No, no tunable for fillnodata, and it doesn't support 
> > > > > > multi-threaded parallelization. 
> > > > > > 
> > > > > > > I will use warp and the raster calculator in the future so you 
> > > > > > > have more magic up your sleeve, I would appreciate it. 
> > > > > > > 
> > > > > > > Cheers and thanks again. 
> > > > > > > 
> > > > > > > Nicolas Cadieux M.Sc. 
> > > > > > > Les Entreprises Arch?otec inc. 
> > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > > > > www.archeotec.ca 
> > > > > > > 
> > > > > > > On Jun 5, 2015 19:13, Even Rouault <even.rouault at spatialys.com> 
> > 
> > wrote: 
> > > > > > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit : 
> > > > > > > > > Hi, 
> > > > > > > > > I have been using gdal_grid to interpolate LiDAR data for 
> > > > > > > > > some time now. This would be a typical command: 
> > > > > > > > > 
> > > > > > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe 
> > > > > > > > > 348733.0 401135.0 -tye 5568587.0 5773796.0 -a 
> > > > > > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0 -outsize 
> > > > > > > > > 52402.0 205209.0 -of GTiff 
> > > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_15052 
> > > > > > > > > 9. vrt 
> > > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_15052 
> > > > > > > > > 9 .tif --confi g GDAL_NUM_THREADS ALL_CPUS 
> > > > > > > > > 
> > > > > > > > > As you can see, this is a huge raster and the csv. file 
> > > > > > > > > (Pointed with a .vrt) contains over a billion points.? I am 
> > > > > > > > > trying to do this in one shot to avoid boundary effects.? (I 
> > > > > > > > > know I can split this .csv file into smaller bits and make 
> > > > > > > > > this more efficient). The computer I am using has 12 cores, 
> > > > > > > > > 64BG of memory (smaller than the csv file) and a 1TB pcie 
> > > > > > > > > solid state drive.? It should manage the task but it has been 
> > > > > > > > > running for 5 days with less than 10% done).? I have access 
> > > > > > > > > to a super computer with gdal if all else fails. 
> > > > > > > > > 
> > > > > > > > > This is my question.? The "--config GDAL_NUM_THREADS 
> > > > > > > > > ALL_CPUS" or "--config GDAL_NUM_THREADS 12" does not seem to 
> > > > > > > > > work with the nearest neighbor algorithm. (It seem to work 
> > > > > > > > > with the -a count command)? If I use this on a smaller data 
> > > > > > > > > set, I see no difference in speed or cpu usage between using 
> > > > > > > > > the "ALL_CPUS" or not using this switch.? Is this a bug or 
> > > > > > > > > simply a limitation of the nearest neighbor algorithm? 
> > > > > > > > 
> > > > > > > > Nicolas, 
> > > > > > > > 
> > > > > > > > The threading mechanism is generic for all algorithms . Add 
> > > > > > > > "--debug on" and you should see traces like "GDAL_GRID: Using 
> > > > > > > > 12 threads". Now, a reason for it not being efficient is that 
> > > > > > > > the work buffer used by gdalgrid (16 MB) is too small w.r.t to 
> > > > > > > > nearest speed. Hum, actually looking more closely at the code, 
> > > > > > > > I see that the quad tree to index the points will be rebuilt 
> > > > > > > > for each work buffer. This is likely the main cause of the 
> > > > > > > > inefficiency and why you don't see measurable differences 
> > > > > > > > between non threaded or threaded computations (since the 
> > > > > > > > building of the quadtree is not multithreaded). If you 
> > > > > > > > compiled from source, you could try changing the "const 
> > > > > > > > GUInt32 nDesiredBufferSize = 16*1024*1024;" line in 
> > > > > > > > apps/gdal_grid.cpp to a much higher value. A more proper 
> > > > > > > > solution would be to avoid rebuilding the quad tree for each 
> > > > > > > > work buffer. This is mainly code restructuring. 
> > > > > > > > 
> > > > > > > > An alternative to gdal_grid would be to use gdal_rasterize + 
> > > > > > > > gdal_fillnodata. This is usually much much faster, so you could 
> > > > > > > > try to check if it gives the results you expect. 
> > > > > > > > 
> > > > > > > > You could also try scipy : 
> > > > > > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scip 
> > > > > > > > y. inte rpol ate.griddata.html#scipy.interpolate.griddata Not 
> > > > > > > > sure how it behaves with that number of points. 
> > > > > > > > 
> > > > > > > > Even 
> > > > > > > > 
> > > > > > > > > I don't want to move this 
> > > > > > > > > to a super computer if it will not multi-thread properly. 
> > > > > > > > > 
> > > > > > > > > Thanks, 
> > > > > > > > > Nicolas Cadieux 
> > > > > > > > > 
> > > > > > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with QGIS 
> > > > > > > > > 2.8 on windows 7_64)? I use GDAL from the command line not 
> > > > > > > > > from QGIS. 
> > > > > > > > > 
> > > > > > > > > 
> > > > > > > > > Nicolas Cadieux M.Sc. 
> > > > > > > > > Les Entreprises Arch?otec inc. 
> > > > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2 
> > > > > > > > > T?l?phone: 514.381.5112? Fax: 514.381.4995 
> > > > > > > > > www.archeotec.ca 
> > > > > > > > > _______________________________________________ 
> > > > > > > > > gdal-dev mailing list 
> > > > > > > > > gdal-dev at lists.osgeo.org 
> > > > > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
> -- 
> Spatialys - Geospatial professional services 
> http://www.spatialys.com 

From even.rouault at spatialys.com  Thu Jun 18 09:11:20 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 18:11:20 +0200
Subject: [gdal-dev] Gdal-Grid lidar.
In-Reply-To: <80747aef-5e34-444e-8572-24339b4ccc02@email.android.com>
References: <80747aef-5e34-444e-8572-24339b4ccc02@email.android.com>
Message-ID: <201506181811.20512.even.rouault@spatialys.com>

Le jeudi 18 juin 2015 17:51:20, Nicolas Cadieux a ?crit :
> Thanks,
> 
> That is good news.
> 
> Is the buffer still at 16 mb? If so, why keep it this low? 

Choosing a buffer size is always somewhat arbitrary. For example, it might 
depend on if people are running only one instance of the utility, or several 
at the same time...

> Lidar is very
> demanding even for the best rigs.

With the new changes, I don't think increasing the buffer size should 
dramatically change performance, but your experiments will be interesting.

> 
> I will  test out the algorithms and keep you posted on differences between
> nn models.  Will recompile if the buffer is still at 16 mg.  I will also
> look at the new linear interpolation.
> 
> Nicolas
> 
> Nicolas Cadieux M.Sc.
> Les Entreprises Arch?otec inc. 
> 8548, rue Saint-Denis Montr?al H2P 2H2
> T?l?phone: 514.381.5112  Fax: 514.381.4995
> www.archeotec.ca
> 
> On Jun 18, 2015 11:43, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le mardi 16 juin 2015 19:00:45, Even Rouault a ?crit :
> > > Le mardi 16 juin 2015 18:50:58, Nicolas Cadieux a ?crit :
> > > > "As you're exploring new territories, I'd expect you to report how
> > > > this works ;-) "
> > > > 
> > > > Report no 1:
> > > > 
> > > > (Sharing how little I know but still trying to help:)
> > > > 
> > > > I have been recompiling gdal_grid with a 1 and 1.5 GB buffer instead
> > > > of the usual 16 mb.  (Both files created with the 1 and 1.5GB are
> > > > identical).
> > > > 
> > > > Increasing the buffer size makes the interpolation much faster (hour
> > > > instead of weeks) but there may be a possible side effect I would
> > > > like to share.
> > > > 
> > > > It seem that the .tiff file (84GB) is very slow to display in QGIS. 
> > > > When I use gdalwarp to resave this file (without actually changing
> > > > the projection or null zero values), I  create an identical file
> > > > with the same dimension and pixel resolution that is blazing fast to
> > > > view in QGIS.  There does not seem to be a pyramid in this new file
> > > > that could explain the results.
> > > > 
> > > > Is it possible that by using such a big buffer, the .tiff is not
> > > > encoded efficiently and that this is fixed when the file is pass
> > > > through gdalwarp?
> > > 
> > > Ah, no, this is a "well known" behaviour of gdal_grid. It creates an
> > > image whose origin is the bottom-left of the image (instead of the
> > > upper-left usually). Consequently QGIS must creates a warp VRT to get
> > > a more classical dataset, which slow down things.
> > > 
> > > A trick to generate directly a file with upper-left origin is to
> > > specify "-tye ymax ymin" (instead of "-tye ymin ymax")
> > > 
> > > I guess this behaviour of gdal_grid should be changed as it regularly
> > > annoys people.
> > 
> > Note: I've committed yesterday in gdal trunk 2.1dev several improvements
> > : - the refactorization I mentionned some time ago, to avoid the quad
> > tree to be rebuilt each time, which makes the increasing of the buffer
> > size less necessary - a new algorithm, linear, which is way much much
> > faster than any other existing algorithm and tends to generate better
> > results
> > 
> > > > Nicolas Cadieux M.Sc.
> > > > Les Entreprises Arch?otec inc.
> > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > www.archeotec.ca
> > > > 
> > > > On Jun 15, 2015 15:24, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > > > > Le lundi 15 juin 2015 21:00:15, Nicolas Cadieux a ?crit :
> > > > > > Thanks Even,
> > > > > > One last question about the buffer. Is 2GB is the max buffer size
> > > > > > for gdal_grid? If I select that, am I likely to run into problem
> > > > > > with some values?
> > > > > 
> > > > > The variable is a uint32 so you could probably go up to 4 GB.
> > > > > 
> > > > > > Apart from trial and error, is there a balance that should be
> > > > > > stuck between available computer memory (currently at 64GB),
> > > > > > input file size and the buffer or can I simply select a 2GB
> > > > > > buffer?
> > > > > 
> > > > > As you're exploring new territories, I'd expect you to report how
> > > > > this works ;-)
> > > > > 
> > > > > > Merci beaucoup pour votre aide.
> > > > > > 
> > > > > > Nicolas Cadieux M.Sc.
> > > > > > Les Entreprises Arch?otec inc.
> > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > www.archeotec.ca
> > > > > > 
> > > > > > On Jun 12, 2015 17:29, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> > > > > > > Le vendredi 12 juin 2015 23:18:26, Nicolas Cadieux a ?crit :
> > > > > > > > Hi Even,
> > > > > > > > Thank you very much.  I increased the buffer to 1.5 GB
> > > > > > > > (512+512+514)*1024*1024 and I can now work much much faster
> > > > > > > > with gdal_grid.
> > > > > > > > 
> > > > > > > > Does gdal_fillnodata have the same type of variable that
> > > > > > > > could speed things up?  It is also slow and does not seem
> > > > > > > > speeded up by the "All_CPUS".
> > > > > > > 
> > > > > > > No, no tunable for fillnodata, and it doesn't support
> > > > > > > multi-threaded parallelization.
> > > > > > > 
> > > > > > > > I will use warp and the raster calculator in the future so
> > > > > > > > you have more magic up your sleeve, I would appreciate it.
> > > > > > > > 
> > > > > > > > Cheers and thanks again.
> > > > > > > > 
> > > > > > > > Nicolas Cadieux M.Sc.
> > > > > > > > Les Entreprises Arch?otec inc.
> > > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > > > www.archeotec.ca
> > > > > > > > 
> > > > > > > > On Jun 5, 2015 19:13, Even Rouault
> > > > > > > > <even.rouault at spatialys.com>
> > > 
> > > wrote:
> > > > > > > > > Le samedi 06 juin 2015 00:18:45, Nicolas Cadieux a ?crit :
> > > > > > > > > > Hi,
> > > > > > > > > > I have been using gdal_grid to interpolate LiDAR data for
> > > > > > > > > > some time now. This would be a typical command:
> > > > > > > > > > 
> > > > > > > > > > gdal_grid -l P0344_sol2004_XYZI_MTM8_CGVD28_150529 -txe
> > > > > > > > > > 348733.0 401135.0 -tye 5568587.0 5773796.0 -a
> > > > > > > > > > nearest:radius1=3.0:radius2=3.0:angle=0.0:nodata=0.0
> > > > > > > > > > -outsize 52402.0 205209.0 -of GTiff
> > > > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_1
> > > > > > > > > > 5052 9. vrt
> > > > > > > > > > H:/Nicolas/pytemp/OutPut\P0344_sol2004_XYZI_MTM8_CGVD28_1
> > > > > > > > > > 5052 9 .tif --confi g GDAL_NUM_THREADS ALL_CPUS
> > > > > > > > > > 
> > > > > > > > > > As you can see, this is a huge raster and the csv. file
> > > > > > > > > > (Pointed with a .vrt) contains over a billion points.  I
> > > > > > > > > > am trying to do this in one shot to avoid boundary
> > > > > > > > > > effects.  (I know I can split this .csv file into
> > > > > > > > > > smaller bits and make this more efficient). The computer
> > > > > > > > > > I am using has 12 cores, 64BG of memory (smaller than
> > > > > > > > > > the csv file) and a 1TB pcie solid state drive.  It
> > > > > > > > > > should manage the task but it has been running for 5
> > > > > > > > > > days with less than 10% done).  I have access to a super
> > > > > > > > > > computer with gdal if all else fails.
> > > > > > > > > > 
> > > > > > > > > > This is my question.  The "--config GDAL_NUM_THREADS
> > > > > > > > > > ALL_CPUS" or "--config GDAL_NUM_THREADS 12" does not seem
> > > > > > > > > > to work with the nearest neighbor algorithm. (It seem to
> > > > > > > > > > work with the -a count command)  If I use this on a
> > > > > > > > > > smaller data set, I see no difference in speed or cpu
> > > > > > > > > > usage between using the "ALL_CPUS" or not using this
> > > > > > > > > > switch.  Is this a bug or simply a limitation of the
> > > > > > > > > > nearest neighbor algorithm?
> > > > > > > > > 
> > > > > > > > > Nicolas,
> > > > > > > > > 
> > > > > > > > > The threading mechanism is generic for all algorithms . Add
> > > > > > > > > "--debug on" and you should see traces like "GDAL_GRID:
> > > > > > > > > Using 12 threads". Now, a reason for it not being
> > > > > > > > > efficient is that the work buffer used by gdalgrid (16 MB)
> > > > > > > > > is too small w.r.t to nearest speed. Hum, actually looking
> > > > > > > > > more closely at the code, I see that the quad tree to
> > > > > > > > > index the points will be rebuilt for each work buffer.
> > > > > > > > > This is likely the main cause of the inefficiency and why
> > > > > > > > > you don't see measurable differences between non threaded
> > > > > > > > > or threaded computations (since the building of the
> > > > > > > > > quadtree is not multithreaded). If you compiled from
> > > > > > > > > source, you could try changing the "const GUInt32
> > > > > > > > > nDesiredBufferSize = 16*1024*1024;" line in
> > > > > > > > > apps/gdal_grid.cpp to a much higher value. A more proper
> > > > > > > > > solution would be to avoid rebuilding the quad tree for
> > > > > > > > > each work buffer. This is mainly code restructuring.
> > > > > > > > > 
> > > > > > > > > An alternative to gdal_grid would be to use gdal_rasterize
> > > > > > > > > + gdal_fillnodata. This is usually much much faster, so
> > > > > > > > > you could try to check if it gives the results you expect.
> > > > > > > > > 
> > > > > > > > > You could also try scipy :
> > > > > > > > > http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/
> > > > > > > > > scip y. inte rpol
> > > > > > > > > ate.griddata.html#scipy.interpolate.griddata Not sure how
> > > > > > > > > it behaves with that number of points.
> > > > > > > > > 
> > > > > > > > > Even
> > > > > > > > > 
> > > > > > > > > > I don't want to move this
> > > > > > > > > > to a super computer if it will not multi-thread properly.
> > > > > > > > > > 
> > > > > > > > > > Thanks,
> > > > > > > > > > Nicolas Cadieux
> > > > > > > > > > 
> > > > > > > > > > (Gdal1.11.2 downloaded with OSGEO4W 64bit install with
> > > > > > > > > > QGIS 2.8 on windows 7_64)  I use GDAL from the command
> > > > > > > > > > line not from QGIS.
> > > > > > > > > > 
> > > > > > > > > > 
> > > > > > > > > > Nicolas Cadieux M.Sc.
> > > > > > > > > > Les Entreprises Arch?otec inc.
> > > > > > > > > > 8548, rue Saint-Denis Montr?al H2P 2H2
> > > > > > > > > > T?l?phone: 514.381.5112  Fax: 514.381.4995
> > > > > > > > > > www.archeotec.ca
> > > > > > > > > > _______________________________________________
> > > > > > > > > > gdal-dev mailing list
> > > > > > > > > > gdal-dev at lists.osgeo.org
> > > > > > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 18 10:15:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 19:15:30 +0200
Subject: [gdal-dev] Experimental: concurrent update of a dataset
Message-ID: <201506181915.30515.even.rouault@spatialys.com>

Hi,

For those interested in parallelizing algorithms that generate a big dataset 
(let's say a GeoTIFF), I've just committed in trunk an improvement to the 
existing not-so-known-I-guess GDAL "api proxy" mechanism 
(http://www.gdal.org/gdal_api_proxy.html) that was initially designed to deal 
with datasets in isolation from the main process.

The improvement consists in the addition of the "-nofork" option (for Unix 
builds only for now, but could relatively easily be extended to Windows if 
needed) to the gdalserver utility, which cause all actions of different client 
connections to be run (sequentially) in the same thread, thus allowing sharing 
the same dataset object if clients open it with the same name. Consequently, 
safe parallel (in fact serialized) update of a dataset is possible.

Demo:

1) Create a target dataset:

gdalwarp in.tif /tmp/out.tif -overwrite -co TILED=YES

 (Ctrl+C almost immediately to just create the file, could be done more cleanly 
but that's enough for the demo)

2) Launch the server:
gdalserver -unixserver /tmp/mysocket -nofork  -v

(you could use "-tcpserver 8080" also, in which case you would set 
localhost:8080 as the value of the below GDAL_API_PROXY_SERVER)

3) Launch in parallel in 2 terminals :
    a) GDAL_API_PROXY_SERVER=/tmp/mysocket gdalwarp upper.vrt 
API_PROXY:/tmp/out.tif
    b) GDAL_API_PROXY_SERVER=/tmp/mysocket gdalwarp lower.vrt 
API_PROXY:/tmp/out.tif

where upper.vrt and lower.vrt are 2 VRT that are the upper and lower part of 
in.tif

A cool aspect is that you can interrupt violently any client at any time and 
the integrity of the output dataset will be still preserved (but you can only 
safely kill the server once all clients connecting to the same output dataset 
have terminated, which the server will tell you with the verbose -v flag). So 
you can resume part of the processing later (assuming clients deal with 
separated parts of the output raster).

You can also display the result with QGIS while it is processed (this will 
slow down things of course, and it should be launched AFTER a first client so 
it doesn't open the dataset in read-only mode) :
$ ln -s API_PROXY:/tmp/out.tif proxied_out.tif
$ GDAL_API_PROXY_SERVER=/tmp/mysocket qgis proxied_out.tif

The server, and thus the output file, could also be on a completely different 
machine, when using TCP mode of course. The clients could be on different 
machines also. They could also be 2 threads of the same process (assuming they 
use each a dedicated dataset handle obtained with a 
GDALOpen("API_PROXY:/tmp/out.tif", GA_Update) call)

This demo is probably not very exciting (you could use the -multi -wo 
NUM_THREADS=ALL_CPUS options of gdalwarp with more performance), but it should 
give an idea of what this is about. Of course as the communication of all 
clients with the server in -nofork mode is serialized, this is only 
interesting if writing the output dataset itself is not the bottleneck of the 
processing. This also works for read/update scenarios (what gdalwarp does in 
fact since it asks for the content of blocks it will update).

Enjoy,

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 18 10:46:27 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 19:46:27 +0200
Subject: [gdal-dev] Motion: Promote 2.0.0RC2 for release
In-Reply-To: <201506161002.38083.even.rouault@spatialys.com>
References: <201506161002.38083.even.rouault@spatialys.com>
Message-ID: <201506181946.27128.even.rouault@spatialys.com>

Le mardi 16 juin 2015 10:02:37, Even Rouault a ?crit :
> Motion: GDAL/OGR 2.0.0RC2 is promoted to be the official 2.0.0 final
> release.

I declare this motion passed with +1 from JukkaR, TamasS, HowardB, DanielM and 
myself.

I'll proceed soon to renaming the RC as final and announcing it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 18 12:13:17 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 21:13:17 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 released
Message-ID: <201506182113.18044.even.rouault@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team and community, I am pleased to
announce the release of GDAL/OGR 2.0.0.  GDAL/OGR is a C++ geospatial
data access library for raster and vector file formats, databases and
web services.  It includes bindings for several languages, and a variety
of command line tools.

   http://www.gdal.org/

The 2.0.0 release is a major new feature release with the following 
highlights:

 * GDAL and OGR driver and dataset unification:
       http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
 * Support for curve geometries:
       http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
 * Support for OGR field subtypes (boolean, int16, float32):
       http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
 * RasterIO() improvements : resampling and progress callback
       http://trac.osgeo.org/gdal/wiki/rfc51_rasterio_resampling_progress
 * Stricter SQL quoting:
       http://trac.osgeo.org/gdal/wiki/rfc52_strict_sql_quoting
 * OGR not-null constraints and default values:
       http://trac.osgeo.org/gdal/wiki/rfc53_ogr_notnull_default
 * OGR dataset transactions:
       https://trac.osgeo.org/gdal/wiki/rfc54_dataset_transactions
 * Refined SetFeature() and DeleteFeature() semantics:
       https://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_semantics
 * OFTTime/OFTDateTime millisecond accuracy:      
       https://trac.osgeo.org/gdal/wiki/rfc56_millisecond_precisio
 * 64bit histogram bucket count:
       https://trac.osgeo.org/gdal/wiki/rfc57_histogram_64bit_count

 * New GDAL drivers:
    - BPG: read-only driver for Better Portable Graphics format (experimental)
    - GPKG: read/write/update capabilities in the unified raster/vector driver
                http://gdal.org/drv_geopackage_raster.html
    - KEA: read/write driver for KEA format
                http://gdal.org/frmt_kea.html
    - PLMosaic: read-only driver for Planet Labs Mosaics API
                http://gdal.org/frmt_plmosaic.html
    - ROI_PAC: read/write driver for image formats of JPL's ROI_PAC project
                http://www.gdal.org/frmt_various.html#ROI_PAC
    - VICAR: read-only driver for VICAR format
                http://www-mipl.jpl.nasa.gov/external/vicar.html

 * New OGR drivers:
    - Cloudant : read/write driver for Cloudant service
                http://gdal.org/drv_cloudant.html
    - CSW: read-only driver for OGC CSW (Catalog Service for the Web) protocol
                http://gdal.org/drv_csw.html
    - JML: read/write driver for OpenJUMP .jml format
                http://gdal.org/drv_jml.html
    - PLScenes: read-only driver for Planet Labs Scenes API 
                http://gdal.org/drv_plscenes.html
    - Selaphin: read/write driver for the Selaphin/Seraphin format
                http://gdal.org/ogr/drv_selafin.html

 * Significantly improved drivers: CSV, GPKG, GTiff, JP2OpenJPEG, MapInfo, PG, 
SQLite

 * Upgrade to EPSG 8.5 database

 * Fix locale related issues when formatting or reading floating point numbers

More complete information on the new features and fixes in the 2.0.0
release can be found at:

  http://trac.osgeo.org/gdal/wiki/Release/2.0.0-News

The release can be downloaded from:
  * http://download.osgeo.org/gdal/2.0.0/gdal200.zip - source as a zip
  * http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0.tar.gz - source as 
.tar.gz
  * http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0.tar.xz - source as 
.tar.xz
  * http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0.tar.gz - test 
suite
  * http://download.osgeo.org/gdal/2.0.0/gdal200doc.zip - documentation / 
website

As there have been a few changes to the C++ API, and to a lesser extent to the 
C API, developers are strongly advised to read :
      https://svn.osgeo.org/gdal/branches/2.0/gdal/MIGRATION_GUIDE.TXT

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 18 14:08:16 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Jun 2015 23:08:16 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.0 released
In-Reply-To: <201506182113.18044.even.rouault@spatialys.com>
References: <201506182113.18044.even.rouault@spatialys.com>
Message-ID: <201506182308.17048.even.rouault@spatialys.com>

There are so many items that I forgot to mention (thanks Jeremy for the 
reminder!) :

   * 64-bit integer fields and feature IDs :
       https://trac.osgeo.org/gdal/wiki/rfc31_ogr_64

> Hi,
> 
> On behalf of the GDAL/OGR development team and community, I am pleased to
> announce the release of GDAL/OGR 2.0.0.  GDAL/OGR is a C++ geospatial
> data access library for raster and vector file formats, databases and
> web services.  It includes bindings for several languages, and a variety
> of command line tools.
> 
>    http://www.gdal.org/
> 
> The 2.0.0 release is a major new feature release with the following
> highlights:
> 
>  * GDAL and OGR driver and dataset unification:
>        http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>  * Support for curve geometries:
>        http://trac.osgeo.org/gdal/wiki/rfc49_curve_geometries
>  * Support for OGR field subtypes (boolean, int16, float32):
>        http://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype
>  * RasterIO() improvements : resampling and progress callback
>        http://trac.osgeo.org/gdal/wiki/rfc51_rasterio_resampling_progress
>  * Stricter SQL quoting:
>        http://trac.osgeo.org/gdal/wiki/rfc52_strict_sql_quoting
>  * OGR not-null constraints and default values:
>        http://trac.osgeo.org/gdal/wiki/rfc53_ogr_notnull_default
>  * OGR dataset transactions:
>        https://trac.osgeo.org/gdal/wiki/rfc54_dataset_transactions
>  * Refined SetFeature() and DeleteFeature() semantics:
>       
> https://trac.osgeo.org/gdal/wiki/rfc55_refined_setfeature_deletefeature_se
> mantics * OFTTime/OFTDateTime millisecond accuracy:
>        https://trac.osgeo.org/gdal/wiki/rfc56_millisecond_precisio
>  * 64bit histogram bucket count:
>        https://trac.osgeo.org/gdal/wiki/rfc57_histogram_64bit_count
> 
>  * New GDAL drivers:
>     - BPG: read-only driver for Better Portable Graphics format
> (experimental) - GPKG: read/write/update capabilities in the unified
> raster/vector driver http://gdal.org/drv_geopackage_raster.html
>     - KEA: read/write driver for KEA format
>                 http://gdal.org/frmt_kea.html
>     - PLMosaic: read-only driver for Planet Labs Mosaics API
>                 http://gdal.org/frmt_plmosaic.html
>     - ROI_PAC: read/write driver for image formats of JPL's ROI_PAC project
>                 http://www.gdal.org/frmt_various.html#ROI_PAC
>     - VICAR: read-only driver for VICAR format
>                 http://www-mipl.jpl.nasa.gov/external/vicar.html
> 
>  * New OGR drivers:
>     - Cloudant : read/write driver for Cloudant service
>                 http://gdal.org/drv_cloudant.html
>     - CSW: read-only driver for OGC CSW (Catalog Service for the Web)
> protocol http://gdal.org/drv_csw.html
>     - JML: read/write driver for OpenJUMP .jml format
>                 http://gdal.org/drv_jml.html
>     - PLScenes: read-only driver for Planet Labs Scenes API
>                 http://gdal.org/drv_plscenes.html
>     - Selaphin: read/write driver for the Selaphin/Seraphin format
>                 http://gdal.org/ogr/drv_selafin.html
> 
>  * Significantly improved drivers: CSV, GPKG, GTiff, JP2OpenJPEG, MapInfo,
> PG, SQLite
> 
>  * Upgrade to EPSG 8.5 database
> 
>  * Fix locale related issues when formatting or reading floating point
> numbers
> 
> More complete information on the new features and fixes in the 2.0.0
> release can be found at:
> 
>   http://trac.osgeo.org/gdal/wiki/Release/2.0.0-News
> 
> The release can be downloaded from:
>   * http://download.osgeo.org/gdal/2.0.0/gdal200.zip - source as a zip
>   * http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0.tar.gz - source as
> .tar.gz
>   * http://download.osgeo.org/gdal/2.0.0/gdal-2.0.0.tar.xz - source as
> .tar.xz
>   * http://download.osgeo.org/gdal/2.0.0/gdalautotest-2.0.0.tar.gz - test
> suite
>   * http://download.osgeo.org/gdal/2.0.0/gdal200doc.zip - documentation /
> website
> 
> As there have been a few changes to the C++ API, and to a lesser extent to
> the C API, developers are strongly advised to read :
>       https://svn.osgeo.org/gdal/branches/2.0/gdal/MIGRATION_GUIDE.TXT
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun 19 00:52:30 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Jun 2015 09:52:30 +0200
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
Message-ID: <201506190952.30173.even.rouault@spatialys.com>

Hi,

As no points have been raised on the RFC:

Motion : I move to adopt RFC 26: GDAL Block Cache Improvements

https://trac.osgeo.org/gdal/wiki/rfc26_blockcache

Starting with my +1

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jun 19 01:35:53 2015
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 19 Jun 2015 08:35:53 +0000 (UTC)
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
References: <201506190952.30173.even.rouault@spatialys.com>
Message-ID: <loom.20150619T103257-867@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:

> 
> Hi,
> 
> As no points have been raised on the RFC:
> 
> Motion : I move to adopt RFC 26: GDAL Block Cache Improvements
> 
> https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
> 
> Starting with my +1

+0

Unfortunately I Can't say anything about the implementation so "0" but
avoiding out of memory errors with large images is for sure worth "+".

-Jukka Rahkonen-


From sameer.sheikh at wetransform.to  Fri Jun 19 01:55:15 2015
From: sameer.sheikh at wetransform.to (sameer.sheikh at wetransform.to)
Date: Fri, 19 Jun 2015 08:55:15 +0000
Subject: [gdal-dev] OGR support for  Interlis 2 - Geometry issue
Message-ID: <ebbc8481d0140c7cda9e122d9abc7294@www.wetransform.to>

Hello,
I am trying to read the interlis 2 data (.xtf file) into my application using GDAL/OGR library.  The application could read feature and field definitions but unable to read the Geometry. e.g. ogr.GeometryTypeToName( featDefn.GetGeomType() ) returning "Unknown (any)" and Geometry reference as null.
It would be really helpful if somebody can share comments on this.
P.S. : I tried to visualize the data using QGIS with Interlis 2 plugin, I am able to see the Geometry.

Regards,Sameer Sheikh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150619/c6c797eb/attachment.html>

From pablo.angelo at dlr.de  Fri Jun 19 06:47:54 2015
From: pablo.angelo at dlr.de (Pablo d'Angelo)
Date: Fri, 19 Jun 2015 15:47:54 +0200
Subject: [gdal-dev] RPC orthorectification accuracy issues.
Message-ID: <55841D8A.6020104@dlr.de>

Dear GDAL Developers,

i have recently compared the results of our internal RPC based 
orthorectification software and have found several difference, which I 
think are due to various "corner" vs "center" of pixel issues in the RPC 
transform code. This lead to significant shifts when using lower 
resolution DEMs, such as SRTM, particularly in hilly and mountainous 
regions.

I have prepared an analysis and patches to fix these issues at:
https://trac.osgeo.org/gdal/ticket/5993

However I'm not very familiar with the GDAL development workflow. Should 
changes like those be discussed on the list, or just added to a ticket?

Best regards,
  Pablo d'Angelo

-- 
------------------------
Deutsches Zentrum f?r Luft- und Raumfahrt (DLR)
Earth Observation Center | Institut f?r Methodik der Fernerkundung | Oberpfaffenhofen | 82234 We?ling

Dr.-Ing. Pablo d'Angelo
www.DLR.de/eoc


From even.rouault at spatialys.com  Fri Jun 19 07:35:15 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Jun 2015 16:35:15 +0200
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <55841D8A.6020104@dlr.de>
References: <55841D8A.6020104@dlr.de>
Message-ID: <201506191635.15886.even.rouault@spatialys.com>

Le vendredi 19 juin 2015 15:47:54, Pablo d'Angelo a ?crit :
> Dear GDAL Developers,
> 
> i have recently compared the results of our internal RPC based
> orthorectification software and have found several difference, which I
> think are due to various "corner" vs "center" of pixel issues in the RPC
> transform code. This lead to significant shifts when using lower
> resolution DEMs, such as SRTM, particularly in hilly and mountainous
> regions.
> 
> I have prepared an analysis and patches to fix these issues at:
> https://trac.osgeo.org/gdal/ticket/5993

Hi Pablo,

I had seen your well documented ticket and wanted to give feedback. Thanks for 
the reminder.
To my opinion, adjustments between "vendor"/formats conventions and the GDAL 
convention (0,0=upper-left corner of upper-lef pixel) should be done during 
the reading of the RPC parameters from their source (similarly to what is done 
when reading a geotransform with pixel-is-center convention), so as to make 
the 
https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_RPCTransformPoint.patch 
patch unnecessary.
Apart .rpb and .rpc_txt, we can also read RPC from GeoTIFF, NITF, ENVI, 
Oracle, PCIDSK... so I'm wondering what our situation is related to them.
Of course this also leaves the embarassing question of which convention to 
adopt when writing RPC values in .rpb or _rpc.txt files... Probably DG 
convention for .rpb ?

fix_rpc_dem_interpolation.patch looks good to me.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bishop.dev at gmail.com  Fri Jun 19 08:00:12 2015
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Fri, 19 Jun 2015 18:00:12 +0300
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <201506191635.15886.even.rouault@spatialys.com>
References: <55841D8A.6020104@dlr.de>
	<201506191635.15886.even.rouault@spatialys.com>
Message-ID: <55842E7C.8040908@gmail.com>

Hi,
I think the vendor specific shifts should be accepted to RPC while 
reading via mdreader or something same. So the fix_PleiadesRPC.patch 
looks good.
Also about changing alg/gdal_rpc.cpp: ?aybe the addition config key, 
i.e. RPC_SHIFT which will be 0.5 as default value?

Best regards,
     Dmitry

19.06.2015 17:35, Even Rouault ?????:
> Le vendredi 19 juin 2015 15:47:54, Pablo d'Angelo a ?crit :
>> Dear GDAL Developers,
>>
>> i have recently compared the results of our internal RPC based
>> orthorectification software and have found several difference, which I
>> think are due to various "corner" vs "center" of pixel issues in the RPC
>> transform code. This lead to significant shifts when using lower
>> resolution DEMs, such as SRTM, particularly in hilly and mountainous
>> regions.
>>
>> I have prepared an analysis and patches to fix these issues at:
>> https://trac.osgeo.org/gdal/ticket/5993
> Hi Pablo,
>
> I had seen your well documented ticket and wanted to give feedback. Thanks for
> the reminder.
> To my opinion, adjustments between "vendor"/formats conventions and the GDAL
> convention (0,0=upper-left corner of upper-lef pixel) should be done during
> the reading of the RPC parameters from their source (similarly to what is done
> when reading a geotransform with pixel-is-center convention), so as to make
> the
> https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_RPCTransformPoint.patch
> patch unnecessary.
> Apart .rpb and .rpc_txt, we can also read RPC from GeoTIFF, NITF, ENVI,
> Oracle, PCIDSK... so I'm wondering what our situation is related to them.
> Of course this also leaves the embarassing question of which convention to
> adopt when writing RPC values in .rpb or _rpc.txt files... Probably DG
> convention for .rpb ?
>
> fix_rpc_dem_interpolation.patch looks good to me.
>
> Even
>


From warmerdam at pobox.com  Fri Jun 19 14:00:18 2015
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 19 Jun 2015 14:00:18 -0700
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <201506191635.15886.even.rouault@spatialys.com>
References: <55841D8A.6020104@dlr.de>
	<201506191635.15886.even.rouault@spatialys.com>
Message-ID: <CA+YzLBfjJ5_Y2oJB752B57zAiXeeSXmZkB2eEKHgqyDFHWNWKw@mail.gmail.com>

Even,

I feel that the RPC coefficients have well establish meanings from the
NITF spec, and file formats like _rpc.txt.  I assume they are
center-of-pixel oriented.  I would *not* want the RPC metadata we keep
(ie https://trac.osgeo.org/gdal/wiki/rfc22_rpc) to have a different
meaning for the pixel/line locations.  So I would suggest we should
not need to transform the RPC coefficients when they are imported -
instead it is the evaluator which needs to adapt between the RPC
pixel/line model and the usual GDAL interpretation.

I'll note this opinion in the ticket as well.

This is going to be moderately distruptive. :-(

Pablo - thank you for bringing this to light!

Best regards,
Frank

On Fri, Jun 19, 2015 at 7:35 AM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le vendredi 19 juin 2015 15:47:54, Pablo d'Angelo a ?crit :
>> Dear GDAL Developers,
>>
>> i have recently compared the results of our internal RPC based
>> orthorectification software and have found several difference, which I
>> think are due to various "corner" vs "center" of pixel issues in the RPC
>> transform code. This lead to significant shifts when using lower
>> resolution DEMs, such as SRTM, particularly in hilly and mountainous
>> regions.
>>
>> I have prepared an analysis and patches to fix these issues at:
>> https://trac.osgeo.org/gdal/ticket/5993
>
> Hi Pablo,
>
> I had seen your well documented ticket and wanted to give feedback. Thanks for
> the reminder.
> To my opinion, adjustments between "vendor"/formats conventions and the GDAL
> convention (0,0=upper-left corner of upper-lef pixel) should be done during
> the reading of the RPC parameters from their source (similarly to what is done
> when reading a geotransform with pixel-is-center convention), so as to make
> the
> https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_RPCTransformPoint.patch
> patch unnecessary.
> Apart .rpb and .rpc_txt, we can also read RPC from GeoTIFF, NITF, ENVI,
> Oracle, PCIDSK... so I'm wondering what our situation is related to them.
> Of course this also leaves the embarassing question of which convention to
> adopt when writing RPC values in .rpb or _rpc.txt files... Probably DG
> convention for .rpb ?
>
> fix_rpc_dem_interpolation.patch looks good to me.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer

From even.rouault at spatialys.com  Fri Jun 19 14:53:55 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Jun 2015 23:53:55 +0200
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <CA+YzLBfjJ5_Y2oJB752B57zAiXeeSXmZkB2eEKHgqyDFHWNWKw@mail.gmail.com>
References: <55841D8A.6020104@dlr.de>
	<201506191635.15886.even.rouault@spatialys.com>
	<CA+YzLBfjJ5_Y2oJB752B57zAiXeeSXmZkB2eEKHgqyDFHWNWKw@mail.gmail.com>
Message-ID: <201506192353.55345.even.rouault@spatialys.com>

Le vendredi 19 juin 2015 23:00:18, Frank Warmerdam a ?crit :
> Even,
> 
> I feel that the RPC coefficients have well establish meanings from the
> NITF spec, and file formats like _rpc.txt.  I assume they are
> center-of-pixel oriented. 

I couldn't find anything explicit about that when skimming through 
http://geotiff.maptools.org/STDI-0002_v2.1.pdf but you're likely right, and 
anyway Pablo's investigations confirm it.

(although when looking at nitfimage.c, NITF has a record of being inconsistant 
w.r.t that convention, at least for GCPs. IGEOLO is center-of-pixel. RPF 
CoverageSectionSubheader is edge-of-pixel. BLOCKA is center-of-pixel. GEOLOB 
is edge-of-pixel !)

> I would *not* want the RPC metadata we keep
> (ie https://trac.osgeo.org/gdal/wiki/rfc22_rpc) to have a different
> meaning for the pixel/line locations.  So I would suggest we should
> not need to transform the RPC coefficients when they are imported -
> instead it is the evaluator which needs to adapt between the RPC
> pixel/line model and the usual GDAL interpretation.
> 
> I'll note this opinion in the ticket as well.
> 
> This is going to be moderately distruptive. :-(

Actually keeping the RPC metadata as it is found in the sources (with the 
exception of Pleiades and their weird center of pixel (1,1) convention 
perhaps, as proposed in 
https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_PleiadesRPC.patch ?), 
and doing the adjustment in the computation will be less disruptive for the 
existing code than modifying the RPC metadata values for a half-pixel shift in 
all deserializing/serializing .rpb and _rpc.txt code (+ you'd have to make a 
special case when deserializing/serializing the RPC metadata domain in 
.aux.xml and VRT !), so on reflection, I'm happy with Pablo's approach. We 
would just need to document it that better in 
https://trac.osgeo.org/gdal/wiki/rfc22_rpc and 
http://www.gdal.org/gdal_datamodel.html

My initial point was mainly for being consistant with what we do for 
geotransform and GCP (standardizing on edge of pixel), but the structures in 
which that information is stored are rather "GDALish" (and the conventions 
among formats so different that you have to pick up one) whereas RPC metadata 
is indeed more standardized.

> 
> Pablo - thank you for bringing this to light!
> 
> Best regards,
> Frank
> 
> On Fri, Jun 19, 2015 at 7:35 AM, Even Rouault
> 
> <even.rouault at spatialys.com> wrote:
> > Le vendredi 19 juin 2015 15:47:54, Pablo d'Angelo a ?crit :
> >> Dear GDAL Developers,
> >> 
> >> i have recently compared the results of our internal RPC based
> >> orthorectification software and have found several difference, which I
> >> think are due to various "corner" vs "center" of pixel issues in the RPC
> >> transform code. This lead to significant shifts when using lower
> >> resolution DEMs, such as SRTM, particularly in hilly and mountainous
> >> regions.
> >> 
> >> I have prepared an analysis and patches to fix these issues at:
> >> https://trac.osgeo.org/gdal/ticket/5993
> > 
> > Hi Pablo,
> > 
> > I had seen your well documented ticket and wanted to give feedback.
> > Thanks for the reminder.
> > To my opinion, adjustments between "vendor"/formats conventions and the
> > GDAL convention (0,0=upper-left corner of upper-lef pixel) should be
> > done during the reading of the RPC parameters from their source
> > (similarly to what is done when reading a geotransform with
> > pixel-is-center convention), so as to make the
> > https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_RPCTransformPoint.
> > patch patch unnecessary.
> > Apart .rpb and .rpc_txt, we can also read RPC from GeoTIFF, NITF, ENVI,
> > Oracle, PCIDSK... so I'm wondering what our situation is related to them.
> > Of course this also leaves the embarassing question of which convention
> > to adopt when writing RPC values in .rpb or _rpc.txt files... Probably
> > DG convention for .rpb ?
> > 
> > fix_rpc_dem_interpolation.patch looks good to me.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gokcen.eraslan at gmail.com  Sun Jun 21 05:07:28 2015
From: gokcen.eraslan at gmail.com (=?UTF-8?Q?G=c3=b6k=c3=a7en_Eraslan?=)
Date: Sun, 21 Jun 2015 14:07:28 +0200
Subject: [gdal-dev] Reading an OSM file
Message-ID: <5586A900.4030008@gmail.com>

Hi everyone,

I am trying to read an OSM file which I downloaded from geofabrik.
Although I can get the OSM driver by name (readonly), I get nothing when
I try to open the data source in which several .osm and osm.bz2 files
present:

----
#include "ogrsf_frmts.h"

int main()

{
    OGRRegisterAll();

    OGRDataSource       *poDS;
    OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
    OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");

    if( osmdrv == NULL )
    {
        printf( "OSM driver open failed.\n" );
        exit( 1 );
    }

    poDS = OGRSFDriverRegistrar::Open( ".", FALSE );
    if( poDS == NULL )
    {
        printf( "Open failed.\n" );
        exit( 1 );
    }
    return 0;
}
----

Program only prints the message "Open failed". I can also see OSM
(readonly) in "ogrinfo --formats" output. I would appreciate if someone
could help me out.

PS: I am using gdal 1.11.2. Actually, what I would like to do is to read
the file from within R through rgdal but it seems I cannot even read the
file at C level via libgdal.

Thanks in advance.

Best regards.
Gokcen.

From even.rouault at spatialys.com  Sun Jun 21 05:25:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 21 Jun 2015 14:25:23 +0200
Subject: [gdal-dev] Reading an OSM file
In-Reply-To: <5586A900.4030008@gmail.com>
References: <5586A900.4030008@gmail.com>
Message-ID: <201506211425.23947.even.rouault@spatialys.com>

Le dimanche 21 juin 2015 14:07:28, G?k?en Eraslan a ?crit :
> Hi everyone,
> 
> I am trying to read an OSM file which I downloaded from geofabrik.
> Although I can get the OSM driver by name (readonly), I get nothing when
> I try to open the data source in which several .osm and osm.bz2 files
> present:

G?k?en,

For .osm files, you must build GDAL against the Expat library to have XML 
support.
For .osm.bz2, you have to uncompress them priorly to ingesting into GDAL. You 
can potentially do it on-the-fly, with something like "cat your.osm.bz2 | 
bunzip2 | your_program /vsistdin/"

You must also be aware that proper reading of "big" osm files require to turn 
on "interleaved reading" mode, as explained in http://gdal.org/drv_osm.html

Even

> 
> ----
> #include "ogrsf_frmts.h"
> 
> int main()
> 
> {
>     OGRRegisterAll();
> 
>     OGRDataSource       *poDS;
>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
> 
>     if( osmdrv == NULL )
>     {
>         printf( "OSM driver open failed.\n" );
>         exit( 1 );
>     }
> 
>     poDS = OGRSFDriverRegistrar::Open( ".", FALSE );
>     if( poDS == NULL )
>     {
>         printf( "Open failed.\n" );
>         exit( 1 );
>     }
>     return 0;
> }
> ----
> 
> Program only prints the message "Open failed". I can also see OSM
> (readonly) in "ogrinfo --formats" output. I would appreciate if someone
> could help me out.
> 
> PS: I am using gdal 1.11.2. Actually, what I would like to do is to read
> the file from within R through rgdal but it seems I cannot even read the
> file at C level via libgdal.
> 
> Thanks in advance.
> 
> Best regards.
> Gokcen.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gokcen.eraslan at gmail.com  Sun Jun 21 05:35:13 2015
From: gokcen.eraslan at gmail.com (=?UTF-8?Q?G=c3=b6k=c3=a7en_Eraslan?=)
Date: Sun, 21 Jun 2015 14:35:13 +0200
Subject: [gdal-dev] Reading an OSM file
In-Reply-To: <201506211425.23947.even.rouault@spatialys.com>
References: <5586A900.4030008@gmail.com>
	<201506211425.23947.even.rouault@spatialys.com>
Message-ID: <5586AF81.2050104@gmail.com>

Hi Even,

On 2015-06-21 14:25, Even Rouault wrote:
> Le dimanche 21 juin 2015 14:07:28, G?k?en Eraslan a ?crit :
>> Hi everyone,
>>
>> I am trying to read an OSM file which I downloaded from geofabrik.
>> Although I can get the OSM driver by name (readonly), I get nothing when
>> I try to open the data source in which several .osm and osm.bz2 files
>> present:
> 
> G?k?en,
> 

Thanks for your very fast reply.

> For .osm files, you must build GDAL against the Expat library to have XML 
> support.

I am using my distro package. I think my gdal is already built with the
expat support, otherwise it wouldn't show OSM in the "ogrinfo --formats"
output, would it?

In addition, when I try:

    OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
    OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
    OGRDataSource *myosm = osmdrv->Open("myfile.osm");

last line returns successfully, which is good, but I still don't get why
OGRSFDriverRegistrar::Open() returns NULL always.

> For .osm.bz2, you have to uncompress them priorly to ingesting into GDAL. You 
> can potentially do it on-the-fly, with something like "cat your.osm.bz2 | 
> bunzip2 | your_program /vsistdin/"
> 

OK, but I am already using a plain XML .osm file. I also have .osm.pbf
files in the same directory but OGRSFDriverRegistrar::Open() always
returns NULL. My gdal library has sqlite support built-in.

> You must also be aware that proper reading of "big" osm files require to turn 
> on "interleaved reading" mode, as explained in http://gdal.org/drv_osm.html
> 

That I didn't know. Thanks for pointing out. My .osm file is 60M and
.osm.pbf is just 3M. Compared to the planet.osm file, they really tiny :)

> Even
> 

Gokcen.

>>
>> ----
>> #include "ogrsf_frmts.h"
>>
>> int main()
>>
>> {
>>     OGRRegisterAll();
>>
>>     OGRDataSource       *poDS;
>>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
>>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
>>
>>     if( osmdrv == NULL )
>>     {
>>         printf( "OSM driver open failed.\n" );
>>         exit( 1 );
>>     }
>>
>>     poDS = OGRSFDriverRegistrar::Open( ".", FALSE );
>>     if( poDS == NULL )
>>     {
>>         printf( "Open failed.\n" );
>>         exit( 1 );
>>     }
>>     return 0;
>> }
>> ----
>>
>> Program only prints the message "Open failed". I can also see OSM
>> (readonly) in "ogrinfo --formats" output. I would appreciate if someone
>> could help me out.
>>
>> PS: I am using gdal 1.11.2. Actually, what I would like to do is to read
>> the file from within R through rgdal but it seems I cannot even read the
>> file at C level via libgdal.
>>
>> Thanks in advance.
>>
>> Best regards.
>> Gokcen.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
G?k?en Eraslan

From even.rouault at spatialys.com  Sun Jun 21 05:51:31 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 21 Jun 2015 14:51:31 +0200
Subject: [gdal-dev] Reading an OSM file
Message-ID: <201506211451.31687.even.rouault@spatialys.com>


Le dimanche 21 juin 2015 14:35:13, vous avez ?crit :
> Hi Even,
> 
> On 2015-06-21 14:25, Even Rouault wrote:
> > Le dimanche 21 juin 2015 14:07:28, G?k?en Eraslan a ?crit :
> >> Hi everyone,
> >> 
> >> I am trying to read an OSM file which I downloaded from geofabrik.
> >> Although I can get the OSM driver by name (readonly), I get nothing when
> >> I try to open the data source in which several .osm and osm.bz2 files
> > 
> >> present:
> > G?k?en,
> 
> Thanks for your very fast reply.
> 
> > For .osm files, you must build GDAL against the Expat library to have XML
> > support.
> 
> I am using my distro package. I think my gdal is already built with the
> expat support,

Ah yes, it should.

> otherwise it wouldn't show OSM in the "ogrinfo --formats"
> output, would it?

It would appear, but with reduced functionnality (only .pbf reading)

> 
> In addition, when I try:
> 
>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
>     OGRDataSource *myosm = osmdrv->Open("myfile.osm");
> 
> last line returns successfully, which is good, but I still don't get why
> OGRSFDriverRegistrar::Open() returns NULL always.

I didn't look closely at your initial message but in 'poDS = 
OGRSFDriverRegistrar::Open( ".", FALSE );' you need to give a .osm filename, 
not "."

> 
> > For .osm.bz2, you have to uncompress them priorly to ingesting into GDAL.
> > You can potentially do it on-the-fly, with something like "cat
> > your.osm.bz2 | bunzip2 | your_program /vsistdin/"
> 
> OK, but I am already using a plain XML .osm file. I also have .osm.pbf
> files in the same directory but OGRSFDriverRegistrar::Open() always
> returns NULL. My gdal library has sqlite support built-in.
> 
> > You must also be aware that proper reading of "big" osm files require to
> > turn on "interleaved reading" mode, as explained in
> > http://gdal.org/drv_osm.html
> 
> That I didn't know. Thanks for pointing out. My .osm file is 60M and
> .osm.pbf is just 3M. Compared to the planet.osm file, they really tiny :)

You'll see. There's a warning emitted if you need to use interleave reading.

> 
> > Even
> 
> Gokcen.
> 
> >> ----
> >> #include "ogrsf_frmts.h"
> >> 
> >> int main()
> >> 
> >> {
> >> 
> >>     OGRRegisterAll();
> >>     
> >>     OGRDataSource       *poDS;
> >>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
> >>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
> >>     
> >>     if( osmdrv == NULL )
> >>     {
> >>     
> >>         printf( "OSM driver open failed.\n" );
> >>         exit( 1 );
> >>     
> >>     }
> >>     
> >>     poDS = OGRSFDriverRegistrar::Open( ".", FALSE );
> >>     if( poDS == NULL )
> >>     {
> >>     
> >>         printf( "Open failed.\n" );
> >>         exit( 1 );
> >>     
> >>     }
> >>     return 0;
> >> 
> >> }
> >> ----
> >> 
> >> Program only prints the message "Open failed". I can also see OSM
> >> (readonly) in "ogrinfo --formats" output. I would appreciate if someone
> >> could help me out.
> >> 
> >> PS: I am using gdal 1.11.2. Actually, what I would like to do is to read
> >> the file from within R through rgdal but it seems I cannot even read the
> >> file at C level via libgdal.
> >> 
> >> Thanks in advance.
> >> 
> >> Best regards.
> >> Gokcen.
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gokcen.eraslan at gmail.com  Sun Jun 21 05:53:02 2015
From: gokcen.eraslan at gmail.com (=?UTF-8?Q?G=c3=b6k=c3=a7en_Eraslan?=)
Date: Sun, 21 Jun 2015 14:53:02 +0200
Subject: [gdal-dev] Reading an OSM file
In-Reply-To: <201506211451.31687.even.rouault@spatialys.com>
References: <201506211451.31687.even.rouault@spatialys.com>
Message-ID: <5586B3AE.4020109@gmail.com>

Hi Even,

On 2015-06-21 14:51, Even Rouault wrote:
> 
> Le dimanche 21 juin 2015 14:35:13, vous avez ?crit :
>> Hi Even,
>>
>> On 2015-06-21 14:25, Even Rouault wrote:
>>> Le dimanche 21 juin 2015 14:07:28, G?k?en Eraslan a ?crit :
>>>> Hi everyone,
>>>>
>>>> I am trying to read an OSM file which I downloaded from geofabrik.
>>>> Although I can get the OSM driver by name (readonly), I get nothing when
>>>> I try to open the data source in which several .osm and osm.bz2 files
>>>
>>>> present:
>>> G?k?en,
>>
>> Thanks for your very fast reply.
>>
>>> For .osm files, you must build GDAL against the Expat library to have XML
>>> support.
>>
>> I am using my distro package. I think my gdal is already built with the
>> expat support,
> 
> Ah yes, it should.
> 
>> otherwise it wouldn't show OSM in the "ogrinfo --formats"
>> output, would it?
> 
> It would appear, but with reduced functionnality (only .pbf reading)
> 
>>
>> In addition, when I try:
>>
>>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
>>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
>>     OGRDataSource *myosm = osmdrv->Open("myfile.osm");
>>
>> last line returns successfully, which is good, but I still don't get why
>> OGRSFDriverRegistrar::Open() returns NULL always.
> 
> I didn't look closely at your initial message but in 'poDS = 
> OGRSFDriverRegistrar::Open( ".", FALSE );' you need to give a .osm filename, 
> not "."
> 

Aaaaaah, OK. I thought it works similarly to the shapefile driver, in
that, if I supply the name of the directory, gdal iterates over the
files in it and detects the ones with .osm extension.

>>
>>> For .osm.bz2, you have to uncompress them priorly to ingesting into GDAL.
>>> You can potentially do it on-the-fly, with something like "cat
>>> your.osm.bz2 | bunzip2 | your_program /vsistdin/"
>>
>> OK, but I am already using a plain XML .osm file. I also have .osm.pbf
>> files in the same directory but OGRSFDriverRegistrar::Open() always
>> returns NULL. My gdal library has sqlite support built-in.
>>
>>> You must also be aware that proper reading of "big" osm files require to
>>> turn on "interleaved reading" mode, as explained in
>>> http://gdal.org/drv_osm.html
>>
>> That I didn't know. Thanks for pointing out. My .osm file is 60M and
>> .osm.pbf is just 3M. Compared to the planet.osm file, they really tiny :)
> 
> You'll see. There's a warning emitted if you need to use interleave reading.
> 

Thank you so much.

Gokcen.

>>
>>> Even
>>
>> Gokcen.
>>
>>>> ----
>>>> #include "ogrsf_frmts.h"
>>>>
>>>> int main()
>>>>
>>>> {
>>>>
>>>>     OGRRegisterAll();
>>>>     
>>>>     OGRDataSource       *poDS;
>>>>     OGRSFDriverRegistrar *reg = OGRSFDriverRegistrar::GetRegistrar();
>>>>     OGRSFDriver *osmdrv = reg->GetDriverByName("OSM");
>>>>     
>>>>     if( osmdrv == NULL )
>>>>     {
>>>>     
>>>>         printf( "OSM driver open failed.\n" );
>>>>         exit( 1 );
>>>>     
>>>>     }
>>>>     
>>>>     poDS = OGRSFDriverRegistrar::Open( ".", FALSE );
>>>>     if( poDS == NULL )
>>>>     {
>>>>     
>>>>         printf( "Open failed.\n" );
>>>>         exit( 1 );
>>>>     
>>>>     }
>>>>     return 0;
>>>>
>>>> }
>>>> ----
>>>>
>>>> Program only prints the message "Open failed". I can also see OSM
>>>> (readonly) in "ogrinfo --formats" output. I would appreciate if someone
>>>> could help me out.
>>>>
>>>> PS: I am using gdal 1.11.2. Actually, what I would like to do is to read
>>>> the file from within R through rgdal but it seems I cannot even read the
>>>> file at C level via libgdal.
>>>>
>>>> Thanks in advance.
>>>>
>>>> Best regards.
>>>> Gokcen.
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
G?k?en Eraslan

From pablo.angelo at dlr.de  Sun Jun 21 23:29:18 2015
From: pablo.angelo at dlr.de (Pablo d'Angelo)
Date: Mon, 22 Jun 2015 08:29:18 +0200
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <201506192353.55345.even.rouault@spatialys.com>
References: <55841D8A.6020104@dlr.de>
	<201506191635.15886.even.rouault@spatialys.com>
	<CA+YzLBfjJ5_Y2oJB752B57zAiXeeSXmZkB2eEKHgqyDFHWNWKw@mail.gmail.com>
	<201506192353.55345.even.rouault@spatialys.com>
Message-ID: <5587AB3E.5000305@dlr.de>

Hi Even,

Am 19.06.2015 um 23:53 schrieb Even Rouault:
> Actually keeping the RPC metadata as it is found in the sources (with the
> exception of Pleiades and their weird center of pixel (1,1) convention
> perhaps, as proposed in
> https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_PleiadesRPC.patch ?),
> and doing the adjustment in the computation will be less disruptive for the
> existing code than modifying the RPC metadata values for a half-pixel shift in
> all deserializing/serializing .rpb and _rpc.txt code (+ you'd have to make a
> special case when deserializing/serializing the RPC metadata domain in
> .aux.xml and VRT !), so on reflection, I'm happy with Pablo's approach.
I think this is also nicer for third party applications that use the
GDAL RPC metadata. Changing the LINE_OFF and SAMP_OFF
would also require changes in third party code.

Best regards,
   Pablo

From even.rouault at spatialys.com  Mon Jun 22 04:06:33 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Jun 2015 13:06:33 +0200
Subject: [gdal-dev] RPC orthorectification accuracy issues.
In-Reply-To: <5587AB3E.5000305@dlr.de>
References: <55841D8A.6020104@dlr.de>
	<201506192353.55345.even.rouault@spatialys.com>
	<5587AB3E.5000305@dlr.de>
Message-ID: <201506221306.33198.even.rouault@spatialys.com>

Le lundi 22 juin 2015 08:29:18, Pablo d'Angelo a ?crit :
> Hi Even,
> 
> Am 19.06.2015 um 23:53 schrieb Even Rouault:
> > Actually keeping the RPC metadata as it is found in the sources (with the
> > exception of Pleiades and their weird center of pixel (1,1) convention
> > perhaps, as proposed in
> > https://trac.osgeo.org/gdal/attachment/ticket/5993/fix_PleiadesRPC.patch
> > ?), and doing the adjustment in the computation will be less disruptive
> > for the existing code than modifying the RPC metadata values for a
> > half-pixel shift in all deserializing/serializing .rpb and _rpc.txt code
> > (+ you'd have to make a special case when deserializing/serializing the
> > RPC metadata domain in .aux.xml and VRT !), so on reflection, I'm happy
> > with Pablo's approach.
> 
> I think this is also nicer for third party applications that use the
> GDAL RPC metadata. Changing the LINE_OFF and SAMP_OFF
> would also require changes in third party code.

Pablo,

I've applied your patches (with very slight modifications) to trunk and 2.0 
branch.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From alexander.e.bobkov at gmail.com  Mon Jun 22 07:50:33 2015
From: alexander.e.bobkov at gmail.com (Alexander Bobkov)
Date: Mon, 22 Jun 2015 17:50:33 +0300
Subject: [gdal-dev] Set/Get Scale and Offset in GDALRasterBand
Message-ID: <558820B9.80003@gmail.com>

Hi,

What is the intended usage of methods 
SetScale/GetScale/SetOffset/GetOffset of the GDALRasterBand class?

Documentation says that
>
> This value (in combination with the GetOffset() 
> <http://www.gdal.org/classGDALRasterBand.html#ab62e0761dde3e3b76f83155920275e4f> 
> value) is used to transform raw pixel values into the units returned 
> by GetUnits(). For example this might be used to store elevations in 
> GUInt16 bands with a precision of 0.1, and starting from -100.
>
> Units value = (raw value * scale) + offset
>

Who is responsible for applying the formula: client code before/after 
RasterIO operation, or driver code inside IReadBlock/IWriteBlock methods?

Best regards,
Alexander Bobkov
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150622/f66b7056/attachment.html>

From even.rouault at spatialys.com  Mon Jun 22 08:01:24 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Jun 2015 17:01:24 +0200
Subject: [gdal-dev] Set/Get Scale and Offset in GDALRasterBand
In-Reply-To: <558820B9.80003@gmail.com>
References: <558820B9.80003@gmail.com>
Message-ID: <201506221701.24654.even.rouault@spatialys.com>

Le lundi 22 juin 2015 16:50:33, Alexander Bobkov a ?crit :
> Hi,
> 
> What is the intended usage of methods
> SetScale/GetScale/SetOffset/GetOffset of the GDALRasterBand class?
> 
> Documentation says that
> 
> > This value (in combination with the GetOffset()
> > <http://www.gdal.org/classGDALRasterBand.html#ab62e0761dde3e3b76f83155920
> > 275e4f> value) is used to transform raw pixel values into the units
> > returned by GetUnits(). For example this might be used to store
> > elevations in GUInt16 bands with a precision of 0.1, and starting from
> > -100.
> > 
> > Units value = (raw value * scale) + offset
> 
> Who is responsible for applying the formula: client code before/after
> RasterIO operation, or driver code inside IReadBlock/IWriteBlock methods?

Client code after RasterIO(GF_Read, ...)/ReadBlock() or before 
RasterIO(GF_Write, ...)/WriteBlock()

> 
> Best regards,
> Alexander Bobkov

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From rayg at daylongraphics.com  Mon Jun 22 13:28:47 2015
From: rayg at daylongraphics.com (Ray Gardener)
Date: Mon, 22 Jun 2015 13:28:47 -0700
Subject: [gdal-dev] Set/Get Scale and Offset in GDALRasterBand
In-Reply-To: <558820B9.80003@gmail.com>
References: <558820B9.80003@gmail.com>
Message-ID: <55886FFF.30603@daylongraphics.com>

The functions are to allow mapping between logical and physical pixel 
values. This is very common in e.g. elevation DEMs.

Applying them is done by the calling code. At least, I haven't seen any 
routines in GDAL that
would apply them for you.

Ray


On 6/22/2015 7:50 AM, Alexander Bobkov wrote:
> Hi,
>
> What is the intended usage of methods 
> SetScale/GetScale/SetOffset/GetOffset of the GDALRasterBand class?
>
> Documentation says that
>>
>> This value (in combination with the GetOffset() 
>> <http://www.gdal.org/classGDALRasterBand.html#ab62e0761dde3e3b76f83155920275e4f> 
>> value) is used to transform raw pixel values into the units returned 
>> by GetUnits(). For example this might be used to store elevations in 
>> GUInt16 bands with a precision of 0.1, and starting from -100.
>>
>> Units value = (raw value * scale) + offset
>>
>
> Who is responsible for applying the formula: client code before/after 
> RasterIO operation, or driver code inside IReadBlock/IWriteBlock methods?
>
> Best regards,
> Alexander Bobkov
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150622/56713a8f/attachment.html>

From alexander.e.bobkov at gmail.com  Tue Jun 23 03:37:12 2015
From: alexander.e.bobkov at gmail.com (Alexander Bobkov)
Date: Tue, 23 Jun 2015 13:37:12 +0300
Subject: [gdal-dev] Set/Get Scale and Offset in GDALRasterBand
In-Reply-To: <55886FFF.30603@daylongraphics.com>
References: <558820B9.80003@gmail.com> <55886FFF.30603@daylongraphics.com>
Message-ID: <558936D8.2090801@gmail.com>

Even, Ray, thanks for the answers

22.06.2015 23:28, Ray Gardener ?????:
> The functions are to allow mapping between logical and physical pixel 
> values. This is very common in e.g. elevation DEMs.
>
> Applying them is done by the calling code. At least, I haven't seen 
> any routines in GDAL that
> would apply them for you.
>
> Ray
>
>
> On 6/22/2015 7:50 AM, Alexander Bobkov wrote:
>> Hi,
>>
>> What is the intended usage of methods 
>> SetScale/GetScale/SetOffset/GetOffset of the GDALRasterBand class?
>>
>> Documentation says that
>>>
>>> This value (in combination with the GetOffset() 
>>> <http://www.gdal.org/classGDALRasterBand.html#ab62e0761dde3e3b76f83155920275e4f> 
>>> value) is used to transform raw pixel values into the units returned 
>>> by GetUnits(). For example this might be used to store elevations in 
>>> GUInt16 bands with a precision of 0.1, and starting from -100.
>>>
>>> Units value = (raw value * scale) + offset
>>>
>>
>> Who is responsible for applying the formula: client code before/after 
>> RasterIO operation, or driver code inside IReadBlock/IWriteBlock methods?
>>
>> Best regards,
>> Alexander Bobkov
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150623/43123122/attachment.html>

From ipavlik78 at gmail.com  Tue Jun 23 06:22:45 2015
From: ipavlik78 at gmail.com (ipavlik)
Date: Tue, 23 Jun 2015 06:22:45 -0700 (PDT)
Subject: [gdal-dev] GDAL/OGR C# wrapper and UTF8
In-Reply-To: <trinity-eba9f14f-7e23-43bd-a045-a68e4803668c-1364895821731@3capp-gmx-bs04>
References: <trinity-eba9f14f-7e23-43bd-a045-a68e4803668c-1364895821731@3capp-gmx-bs04>
Message-ID: <1435065765652-5212498.post@n6.nabble.com>

Hello,

now, for Layer.GetName() I need to use:
Encoding.UTF8.GetString(Encoding.Default.GetBytes(layer.GetName()));
to have correct characters.

Is it a subject of this issue?

Ivo.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-OGR-C-wrapper-and-UTF8-tp5044028p5212498.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lucadeluge at gmail.com  Tue Jun 23 06:49:07 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Tue, 23 Jun 2015 15:49:07 +0200
Subject: [gdal-dev] python ogr feature didn't save attributes
Message-ID: <CAK4m-3xkVb2LZ4QSEbhM6DCjgvpKjDo1nD1sv3SpEeGMjLpLoA@mail.gmail.com>

Hi devs,

I'm writing a function to cycle inside the feature and update a column
of attribute table, if I print the feature with DumpReadable() I can
see the right attributes but when the script finish the final
shapefile has no attribute table, any idea?

This is the relevant part of code

featureDefn = lay0.GetLayerDefn()
field = ogr.FieldDefn(out_col, ogr.OFTReal)
featureDefn.AddFieldDefn(field)

# loop through input layer
for inFeature in lay0:
    volu = None
    # create a new feature
    outFeature = ogr.Feature(featureDefn)

    # copy the attributes and set geometry
    outFeature.SetFrom(inFeature)

    spec = inFeature.GetField(str(specie))
    diameter = inFeature.GetField(str(diam))
    heig = inFeature.GetField(str(height))
    if diameter > 85:
        diameter = 85
    if spec in ['fa', 'al']:
        if diameter > 4.0091:
            values = CODES[spec]
            volu = formula_vol(values['a'], values['b'], values['c'],
                                values['d0'], diameter, heig)
    elif spec in ['ab', 'ar', 'la', 'pc', 'pn', 'ps']:
        if diameter > 3.69465:
            values = CODES[spec]
            volu = formula_vol(values['a'], values['b'], values['c'],
                                values['d0'], diameter, heig)
    outFeature.SetField(out_col, volu)
    outFeature.DumpReadable()
    # add the feature to the output layer
    outLayer.CreateFeature(outFeature)
    outFeature = None
outLayer = None
outDS = None

and this one of outFeature.DumpReadable()

OGRFeature(20150304_AREEINV_trees):-1
  nr_progr_P (Integer) = 25
  AREAINV (Integer) = 155
  DBH_cm (Real) = 55.500000000000000
  Heigth_m (Real) = 33.600000000000001
  H_m (Real) = (null)
  EST_UTM32W (Real) = 635874.174400790012442
  NORD_UTM32 (Real) = 5127869.940315400250256
  G_m2 (Real) = 0.241922065000000
  V/M (String) = V
  Crown_A_m2 (Real) = (null)
  NOTE (String) = (null)
  RBH_m (Real) = 0.277500000000000
  Abbr_SPECI (String) = ar
  TIPOLOGIA (String) = pianta
  SP_Latino (String) = Picea_abies
  SP_Inglese (String) = Norway_spruce
  prova_volume (Real) = 2.46353029399417
  POINT (635874.174400790012442 5127869.940315400250256)

and this is the output of ogrinfo

Layer name: prova
Geometry: Point
Feature Count: 1630
Extent: (634916.793252, 5127012.958636) - (637692.035641, 5129718.805166)
Layer SRS WKT:
PROJCS["WGS_1984_UTM_Zone_32N",
    GEOGCS["GCS_WGS_1984",
        DATUM["WGS_1984",
            SPHEROID["WGS_84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
FID: Real (11.0)

thanks a lot

-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From dengo at gmx.net  Tue Jun 23 06:51:18 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Tue, 23 Jun 2015 15:51:18 +0200
Subject: [gdal-dev] dimap pleiades issues
In-Reply-To: <CALqbEi4E2XT+p-EdiUka_SmUcsdO0EtkVfRBqHh92N=Dgq0_0A@mail.gmail.com>
References: <CALqbEi4E2XT+p-EdiUka_SmUcsdO0EtkVfRBqHh92N=Dgq0_0A@mail.gmail.com>
Message-ID: <CALqbEi6ucFkhCWHjFHwtUcmxg2o2Y8AQzyJU0-e38DouTRSybg@mail.gmail.com>

Sorry wrong link. This is the dimap pleiades test dataset:
https://drive.google.com/file/d/0B_pKTK9WcAW4RktQUEE2bzVDdGM/view?usp=sharing


On Tue, Jun 23, 2015 at 3:43 PM, Dennis Gocke <dengo at gmx.net> wrote:

> Hi guys,
>
>
>
> following the discussion
> http://thread.gmane.org/gmane.comp.gis.gdal.devel/40628 I did some tests
> with a pleiades dataset.
>
> First of all, Astrium?s very own tool (which now vanished from their page)
> to convert the pleiades RPC*.XML to _RPC.TXT did not change SAMP_OFF and
> LINE_OFF according to the 1,1 pixel center convention, so using this
> _RPC.TXT would probably cause issues in most software.
>
>
>
> So I wanted to see how the GDAL pleiades mdreader works and stumbled
> across some issues:
>
> - the pleiades mdreader is not triggered when opening the dimap file.
>
> - when the image is tiled, the dimap reader only opens the first file but
> has raster dimensions of all tiles, so trying to read pixels, where the
> other tiles should be used, crashes.
>
> - neither a geotransform nor GCPs are provided when opening the dimap file
> (unrelated issue).
>
> - when opening the individual tile tifs the pleiades mdreader is triggered
> and reads the RPC. But it provides the same RPCs for all tiles, which means
> for every tile apart from the upper left tile the RPCs are not correct.
>
>
> I?ve uploaded a Pleiades sample with tiles (blackened pixels) here:
>
> https://drive.google.com/file/d/0B_pKTK9WcAW4UnA2LWJpbFE1ZTQ/view?usp=sharing
>
>
> I think it would be great if GDAL could load all tiles as mosaic from the
> dimap (similar to the DG TIL driver) and would provide the RPCs from the
> pleiades mdreader for this mosaic raster. This would avoid using various
> workarounds.
>
>
>
> Best Regards,
>
> Dennis
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150623/a0ca974a/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jun 23 07:02:25 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 23 Jun 2015 16:02:25 +0200
Subject: [gdal-dev] python ogr feature didn't save attributes
In-Reply-To: <CAK4m-3xkVb2LZ4QSEbhM6DCjgvpKjDo1nD1sv3SpEeGMjLpLoA@mail.gmail.com>
References: <CAK4m-3xkVb2LZ4QSEbhM6DCjgvpKjDo1nD1sv3SpEeGMjLpLoA@mail.gmail.com>
Message-ID: <201506231602.25334.even.rouault@spatialys.com>

Luca,

> 
> I'm writing a function to cycle inside the feature and update a column
> of attribute table, if I print the feature with DumpReadable() I can
> see the right attributes but when the script finish the final
> shapefile has no attribute table, any idea?
> 
> This is the relevant part of code
> 
> featureDefn = lay0.GetLayerDefn()
> field = ogr.FieldDefn(out_col, ogr.OFTReal)
> featureDefn.AddFieldDefn(field)

As suggested in http://gdal.org/python/osgeo.ogr.FeatureDefn-
class.html#AddFieldDefn , you must call CreateField() on the layer object 
instead.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jun 23 07:06:21 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 23 Jun 2015 16:06:21 +0200
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
In-Reply-To: <201506190952.30173.even.rouault@spatialys.com>
References: <201506190952.30173.even.rouault@spatialys.com>
Message-ID: <201506231606.21709.even.rouault@spatialys.com>

Le vendredi 19 juin 2015 09:52:30, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised on the RFC:
> 
> Motion : I move to adopt RFC 26: GDAL Block Cache Improvements
> 
> https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
> 
> Starting with my +1

Hi,

Just a reminder this motion is still under vote (with only one voter, me 
excluded, up to now).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dengo at gmx.net  Tue Jun 23 06:43:35 2015
From: dengo at gmx.net (Dennis Gocke)
Date: Tue, 23 Jun 2015 15:43:35 +0200
Subject: [gdal-dev] dimap pleiades issues
Message-ID: <CALqbEi4E2XT+p-EdiUka_SmUcsdO0EtkVfRBqHh92N=Dgq0_0A@mail.gmail.com>

Hi guys,



following the discussion
http://thread.gmane.org/gmane.comp.gis.gdal.devel/40628 I did some tests
with a pleiades dataset.

First of all, Astrium?s very own tool (which now vanished from their page)
to convert the pleiades RPC*.XML to _RPC.TXT did not change SAMP_OFF and
LINE_OFF according to the 1,1 pixel center convention, so using this
_RPC.TXT would probably cause issues in most software.



So I wanted to see how the GDAL pleiades mdreader works and stumbled across
some issues:

- the pleiades mdreader is not triggered when opening the dimap file.

- when the image is tiled, the dimap reader only opens the first file but
has raster dimensions of all tiles, so trying to read pixels, where the
other tiles should be used, crashes.

- neither a geotransform nor GCPs are provided when opening the dimap file
(unrelated issue).

- when opening the individual tile tifs the pleiades mdreader is triggered
and reads the RPC. But it provides the same RPCs for all tiles, which means
for every tile apart from the upper left tile the RPCs are not correct.


I?ve uploaded a Pleiades sample with tiles (blackened pixels) here:
https://drive.google.com/file/d/0B_pKTK9WcAW4UnA2LWJpbFE1ZTQ/view?usp=sharing


I think it would be great if GDAL could load all tiles as mosaic from the
dimap (similar to the DG TIL driver) and would provide the RPCs from the
pleiades mdreader for this mosaic raster. This would avoid using various
workarounds.



Best Regards,

Dennis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150623/a8a90a0a/attachment.html>

From dmorissette at mapgears.com  Tue Jun 23 07:06:50 2015
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 23 Jun 2015 10:06:50 -0400
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
In-Reply-To: <201506231606.21709.even.rouault@spatialys.com>
References: <201506190952.30173.even.rouault@spatialys.com>
	<201506231606.21709.even.rouault@spatialys.com>
Message-ID: <558967FA.8020003@mapgears.com>

On 2015-06-23 10:06 AM, Even Rouault wrote:
> Le vendredi 19 juin 2015 09:52:30, Even Rouault a ?crit :
>> Hi,
>>
>> As no points have been raised on the RFC:
>>
>> Motion : I move to adopt RFC 26: GDAL Block Cache Improvements
>>
>> https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
>>
>> Starting with my +1
>
> Hi,
>
> Just a reminder this motion is still under vote (with only one voter, me
> excluded, up to now).
>
> Even
>

+1.

I can't claim that I understood all the implementation details, but 
since it solves a significant issue with large datasets without 
introducing new side-effects then I'm all for it.

-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From kor at jemig.eu  Tue Jun 23 08:15:23 2015
From: kor at jemig.eu (Kor de Jong)
Date: Tue, 23 Jun 2015 17:15:23 +0200
Subject: [gdal-dev] Building GDAL 2.0.0 without ogr on Linux fails
Message-ID: <5589780B.7090004@jemig.eu>

Dear all,

I may have found an issue in the build scripts of gdal 2.0.0. Building 
gdal without ogr on Linux fails on my machine:

./configure --without-ogr
make -j8

I attached the output of configure and copied the snippets from the 
build output detailing the errors below.

When I change --without-ogr into --with-ogr, the build succeeds.

Maybe something OGR-ish is building while it shouldn't(?).

Best regards,
Kor de Jong




libtool: compile:  /opt/gcc-4.9/bin/g++ -I/tmp/blah/gdal-2.0.0/port 
-I/tmp/blah/gdal-2.0.0/gcore -I/tmp/blah/gdal-2.0.0/alg 
-I/tmp/blah/gdal-2.0.0/ogr -I/tmp/blah/gdal-2.0.0/ogr/ogrsf_frmts -g -O2 
-Wall -I/tmp/blah/gdal-2.0.0/port -I/usr/include -DGDAL_COMPILATION -c 
mffdataset.cpp -o ../o/mffdataset.o >/dev/null 2>&1
ogrutils.cpp: In function ?int OGRGeneralCmdLineProcessor(int, char***, 
int)?:
ogrutils.cpp:526:60: error: ?GDAL_OF_VECTOR? was not declared in this scope
      return GDALGeneralCmdLineProcessor( nArgc, ppapszArgv, 
GDAL_OF_VECTOR );
                                                             ^
ogrutils.cpp:526:75: error: ?GDALGeneralCmdLineProcessor? was not 
declared in this scope
      return GDALGeneralCmdLineProcessor( nArgc, ppapszArgv, 
GDAL_OF_VECTOR );
 
     ^
ogrutils.cpp:527:1: warning: control reaches end of non-void function 
[-Wreturn-type]
  }
  ^
make[1]: *** [ogrutils.lo] Error 1
make[1]: *** Waiting for unfinished jobs....





pdfwritabledataset.cpp: In member function ?virtual OGRErr 
PDFWritableVectorDataset::SyncToDisk()?:
pdfwritabledataset.cpp:307:17: error: ?class GDALPDFWriter? has no 
member named ?WriteOGRLayer?
          oWriter.WriteOGRLayer((OGRDataSourceH)this,
                  ^
make[2]: *** [../o/pdfwritabledataset.lo] Error 1
make[2]: *** Waiting for unfinished jobs....



make[1]: *** [pdf-install-obj] Error 2
make[1]: *** Waiting for unfinished jobs....
make: *** [frmts-target] Error 2

-------------- next part --------------
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking for gcc... /opt/gcc-4.9/bin/gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether /opt/gcc-4.9/bin/gcc accepts -g... yes
checking for /opt/gcc-4.9/bin/gcc option to accept ISO C89... none needed
checking C_WFLAGS for maximum warnings... -Wall -Wdeclaration-after-statement
checking whether we are using the GNU C++ compiler... yes
checking whether /opt/gcc-4.9/bin/g++ accepts -g... yes
checking CXX_WFLAGS for maximum warnings... -Wall
checking for gcc... (cached) /opt/gcc-4.9/bin/gcc
checking whether we are using the GNU C compiler... (cached) yes
checking whether /opt/gcc-4.9/bin/gcc accepts -g... (cached) yes
checking for /opt/gcc-4.9/bin/gcc option to accept ISO C89... (cached) none needed
checking whether we are using the GNU C++ compiler... (cached) yes
checking whether /opt/gcc-4.9/bin/g++ accepts -g... (cached) yes
checking how to print strings... printf
checking for a sed that does not truncate output... /bin/sed
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for fgrep... /bin/grep -F
checking for ld used by /opt/gcc-4.9/bin/gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 1572864
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands "+="... yes
checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... dlltool
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking for gawk... gawk
checking command to parse /usr/bin/nm -B output from /opt/gcc-4.9/bin/gcc object... ok
checking for sysroot... no
checking for mt... mt
checking if mt is a manifest tool... no
checking how to run the C preprocessor... /opt/gcc-4.9/bin/gcc -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
checking if /opt/gcc-4.9/bin/gcc supports -fno-rtti -fno-exceptions... no
checking for /opt/gcc-4.9/bin/gcc option to produce PIC... -fPIC -DPIC
checking if /opt/gcc-4.9/bin/gcc PIC flag -fPIC -DPIC works... yes
checking if /opt/gcc-4.9/bin/gcc static flag -static works... yes
checking if /opt/gcc-4.9/bin/gcc supports -c -o file.o... yes
checking if /opt/gcc-4.9/bin/gcc supports -c -o file.o... (cached) yes
checking whether the /opt/gcc-4.9/bin/gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking whether -lc should be explicitly linked in... no
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... yes
checking whether to build static libraries... yes
checking how to run the C++ preprocessor... /opt/gcc-4.9/bin/g++ -E
checking for ld used by /opt/gcc-4.9/bin/g++... /usr/bin/ld -m elf_x86_64
checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
checking whether the /opt/gcc-4.9/bin/g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking for /opt/gcc-4.9/bin/g++ option to produce PIC... -fPIC -DPIC
checking if /opt/gcc-4.9/bin/g++ PIC flag -fPIC -DPIC works... yes
checking if /opt/gcc-4.9/bin/g++ static flag -static works... yes
checking if /opt/gcc-4.9/bin/g++ supports -c -o file.o... yes
checking if /opt/gcc-4.9/bin/g++ supports -c -o file.o... (cached) yes
checking whether the /opt/gcc-4.9/bin/g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
checking dynamic linker characteristics... (cached) GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking for dlopen in -ldl... yes
checking for nanosleep in -lrt... yes
checking for sin in -lm... yes
checking for ANSI C header files... (cached) yes
checking assert.h usability... yes
checking assert.h presence... yes
checking for assert.h... yes
checking fcntl.h usability... yes
checking fcntl.h presence... yes
checking for fcntl.h... yes
checking for unistd.h... (cached) yes
checking dbmalloc.h usability... no
checking dbmalloc.h presence... no
checking for dbmalloc.h... no
checking for dlfcn.h... (cached) yes
checking for stdint.h... (cached) yes
checking limits.h usability... yes
checking limits.h presence... yes
checking for limits.h... yes
checking locale.h usability... yes
checking locale.h presence... yes
checking for locale.h... yes
checking values.h usability... yes
checking values.h presence... yes
checking for values.h... yes
checking float.h usability... yes
checking float.h presence... yes
checking for float.h... yes
checking errno.h usability... yes
checking errno.h presence... yes
checking for errno.h... yes
checking direct.h usability... no
checking direct.h presence... no
checking for direct.h... no
checking whether byte ordering is bigendian... no
checking for 64bit integer type... long long
checking for 64bit file io... yes
checking for stat64... yes
checking for fopen64... yes
checking for ftruncate64... yes
checking size of int... 4
checking size of unsigned long... 8
checking size of void*... 8
checking for int8... no
checking for int16... no
checking for int32... no
checking native cpu bit order... lsb2msb
checking for vprintf... yes
checking for _doprnt... no
checking for snprintf... yes
checking for vsnprintf... yes
checking for atoll... yes
checking for strtof... yes
checking for getcwd... yes
checking whether strtof is declared... yes
checking for readlink... yes
checking for lstat... yes
checking for posix_spawnp... yes
checking for vfork... yes
checking for gmtime_r... yes
checking for localtime_r... yes
checking for setlocale... yes
checking to enable debug build... no, CFLAGS="-g -O2"
checking whether GCC 4.1 atomic builtins are available... yes
checking whether SSE is available at compile time... yes
checking whether AVX is available at compile time... yes
checking whether we should hide internal symbols... no
checking for local include/lib path... none
checking for pthread_create in -lpthread... yes
checking for PTHREAD_MUTEX_RECURSIVE... yes
checking for PTHREAD_MUTEX_ADAPTIVE_NP... yes
checking for pthread_spinlock_t... yes
checking for 5 args mremap()... yes
checking for _SC_PHYS_PAGES... yes
checking for deflateInit_ in -lz... yes
checking for inflateCopy in -lz... yes
using pre-installed libz
checking for ld used by GCC... /usr/bin/ld -m elf_x86_64
checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
checking for shared library run path origin... /bin/bash: ./config.rpath: No such file or directory
done
checking for iconv... yes
checking for working iconv... yes
checking for iconv declaration... 
         extern size_t iconv (iconv_t cd, char * *inbuf, size_t *inbytesleft, char * *outbuf, size_t *outbytesleft);
using ICONV_CPP_CONST=""
checking for pg_config... /usr/bin/pg_config
checking for PostgreSQL... yes
checking for PQconnectdb in -lpq... yes
checking for PQputCopyData in -lpq... yes
checking for PQescapeStringConn in -lpq... yes
checking for G_gisinit_2 in -lgrass5... no
checking for ffopen in -lcfitsio... no
libcfitsio not found - FITS support disabled
checking for Mopen in -lcsf... no
checking csf.h usability... no
checking csf.h presence... no
checking for csf.h... no
using internal csf code.
checking for libpng... checking for png_set_IHDR in -lpng... yes
checking png.h usability... yes
checking png.h presence... yes
checking for png.h... yes
using pre-installed libpng.
checking for libcrunch... dds support disabled.
checking for gta_version in -lgta... no
libgta not found - GTA support disabled
checking for PCIDSK... using internal libpcidsk.
checking for libtiff... checking for TIFFScanlineSize64 in -ltiff... yes
checking for _TIFFsetDoubleArray in -ltiff... yes
using pre-installed libtiff.
BigTIFF support enabled.
checking for XTIFFClientOpen in -lgeotiff... no
using internal GeoTIFF code.
checking for jpeg_read_scanlines in -ljpeg... yes
checking jpeglib.h usability... yes
checking jpeglib.h presence... yes
checking for jpeglib.h... yes
using pre-installed libjpeg.
checking for jpeg12... disabled, libjpeg or libtiff not internal
checking for DGifOpenFileName in -lgif... yes
checking gif_lib.h usability... yes
checking gif_lib.h presence... yes
checking for gif_lib.h... yes
using pre-installed libgif.
checking ecs.h usability... no
checking ecs.h presence... no
checking for ecs.h... no
checking for FMEObjects... no
SOSI support disabled.
checking for SDreaddata in -lmfhdfalt... yes
checking for SDget_maxopenfiles in -lmfhdfalt... yes
checking for H5Fopen in -lhdf5... no
checking for kea-config... no
checking for kea... no
checking for nc-config... /usr/bin/nc-config
checking libnetcdf compiler and linker flags with nc-config... 
 got version="netCDF 4.1.3", prefix="/usr",
 libs="-L/usr/lib -lnetcdf", includedir="/usr/include"
checking for nc_open in -lnetcdf... yes
checking for netcdf-4 (and HDF5) support in libnetcdf... yes
checking for HDF4 support in libnetcdf... no
checking for jpc_decode in -ljasper... yes
checking for jp2_decode in -ljasper... yes
checking for pgx_decode in -ljasper... yes
checking for jp2_encode_uuid in -ljasper... yes
configure: hacked JasPer version found (JasPer UUID), GeoJP2 enabled.
checking openjpeg-2.0/openjpeg.h usability... no
checking openjpeg-2.0/openjpeg.h presence... no
checking for openjpeg-2.0/openjpeg.h... no
checking openjpeg-2.1/openjpeg.h usability... no
checking openjpeg-2.1/openjpeg.h presence... no
checking for openjpeg-2.1/openjpeg.h... no
checking for FileGDBAPI... FileGDBAPI not found.
checking for NCScbmOpenFileView in -lNCSEcw... no
checking for NCScbmOpenFileView in -lecwj2... no
checking for Kakadu JPEG2000 support... not requested.
configure: MrSID support disabled.
configure: MrSID/MG4 Lidar support disabled.
checking for MSG... not requested
checking for BSB... enabled
checking if Oracle support is enabled... no
checking for GRIB... enabled
checking for OGR ... disabled by user
checking for MySQL... no
checking for Ingres... no
checking for Xerces C++ Parser headers in /usr/include and /usr/include/xercesc... found
checking for Xerces C++ Parser libraries... found
checking for Xerces C++ Parser... yes
checking if Xerces C++ Parser version is >= 2.7.0... yes
checking for XML_ParserCreate in -lexpat... yes
checking for Expat XML Parser headers in /usr/include... found
checking for Expat XML Parser... yes
checking if Expat XML Parser version is >= 1.95.0... yes
checking for Google libkml... no
checking for SQLConnect in -lodbc... yes
checking for SQLInstallDriverEx in -lodbcinst... yes
checking if Oracle support is enabled... no
checking Checking for DODS... disabled
checking for curl-config... /usr/bin/curl-config
        found libcurl version 7.35.0
checking for curl_global_init in -lcurl... yes
checking for xml2-config... /usr/bin/xml2-config
checking for xmlParseDoc in -lxml2... yes
disabled
checking for sqlite3_open in -lsqlite3... yes
checking for SQLite3 library >= 3.0.0... yes
checking for sqlite3_column_table_name in -lsqlite3... yes
checking pcre.h usability... yes
checking pcre.h presence... yes
checking for pcre.h... yes
checking for pcre_compile in -lpcre... yes
checking Checking for DWGdirect... disabled
configure: IBM Informix DataBlade not supported.
configure: checking whether we should include ESRI SDE support...
        ESRI SDE support not requested.
checking for geos-config... /usr/bin/geos-config
checking for GEOS version >= 3.1.0... yes
checking for GEOSversion in -lgeos_c... yes
configure: Using C API from GEOS 3.4.2
checking for OpenCL support... no
checking for FreeXL support... checking freexl.h usability... no
checking freexl.h presence... no
checking for freexl.h... no
checking for freexl_open in -lfreexl... no
checking for freexl_open in -lfreexl... no
checking for freexl_open in -lfreexl... no
checking for freexl_open in -lfreexl... no
checking for freexl_open in -lfreexl... no
libfreexl not found - FreeXL support disabled
checking for json_object_set_serializer in -ljson-c... no
using internal libjson-c code
checking whether to enable PAM... yes
checking for poppler... disabled
checking for podofo... disabled
checking how to link PROJ.4 library... link dynamically.
checking GDAL version information from gdal_version.h: 2.0.0
checking for perl bindings... disabled
checking for php bindings... disabled
checking for python bindings... disabled
checking whether we should include Java support... no
checking whether we should include MDB support... no
configure: checking whether we should include rasdaman support...
        rasdaman support not requested.
checking whether we should include Armadillo support... no
configure: creating ./config.status
config.status: creating GDALmake.opt
config.status: WARNING:  'GDALmake.opt.in' seems to ignore the --datarootdir setting
config.status: creating port/cpl_config.h
config.status: executing libtool commands

GDAL is now configured for x86_64-unknown-linux-gnu

  Installation directory:    /usr/local
  C compiler:                /opt/gcc-4.9/bin/gcc -g -O2
  C++ compiler:              /opt/gcc-4.9/bin/g++ -g -O2

  LIBTOOL support:           yes

  LIBZ support:              external
  LIBLZMA support:           no
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  LIBPNG support:            external
  DDS support:               no
  GTA support:               no
  LIBTIFF support:           external (BigTIFF=yes)
  LIBGEOTIFF support:        internal
  LIBJPEG support:           external
  12 bit JPEG:               no
  12 bit JPEG-in-TIFF:       no
  LIBGIF support:            external
  OGDI support:              no
  HDF4 support:              yes
  HDF5 support:              no
  Kea support:               no
  NetCDF support:            yes
  Kakadu support:            no
  JasPer support:            yes (GeoJP2=yes)
  OpenJPEG support:          no
  ECW support:               no
  MrSID support:             no
  MrSID/MG4 Lidar support:   no
  MSG support:               no
  GRIB support:              yes
  EPSILON support:           no
  WebP support:              no
  cURL support (wms/wcs/...):yes
  PostgreSQL support:        yes
  MySQL support:             no
  Ingres support:            no
  Xerces-C support:          yes
  NAS support:               yes
  Expat support:             yes
  libxml2 support:           yes
  Google libkml support:     no
  ODBC support:              yes
  PGeo support:              yes
  FGDB support:              no
  MDB support:               no
  PCIDSK support:            internal
  OCI support:               no
  GEORASTER support:         no
  SDE support:               no
  Rasdaman support:          no
  DODS support:              no
  SQLite support:            yes
  PCRE support:              yes
  SpatiaLite support:        no
  DWGdirect support          no
  INFORMIX DataBlade support:no
  GEOS support:              yes
  Poppler support:           no
  Podofo support:            no
  OpenCL support:            no
  Armadillo support:         no
  FreeXL support:            no
  SOSI support:              no


  SWIG Bindings:             no

  Statically link PROJ.4:    no
  enable OGR building:       no
  enable pthread support:    yes
  enable POSIX iconv support:yes
  hide internal symbols:     no

From even.rouault at spatialys.com  Tue Jun 23 09:06:48 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 23 Jun 2015 18:06:48 +0200
Subject: [gdal-dev] dimap pleiades issues
In-Reply-To: <CALqbEi4E2XT+p-EdiUka_SmUcsdO0EtkVfRBqHh92N=Dgq0_0A@mail.gmail.com>
References: <CALqbEi4E2XT+p-EdiUka_SmUcsdO0EtkVfRBqHh92N=Dgq0_0A@mail.gmail.com>
Message-ID: <201506231806.48298.even.rouault@spatialys.com>

Dennis,

I believe this would be good material for a ticket, if there isn't one already

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jun 23 09:14:19 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 23 Jun 2015 18:14:19 +0200
Subject: [gdal-dev] Building GDAL 2.0.0 without ogr on Linux fails
In-Reply-To: <5589780B.7090004@jemig.eu>
References: <5589780B.7090004@jemig.eu>
Message-ID: <201506231814.19105.even.rouault@spatialys.com>

Kor,

I'm half surprised this ended up being broken. At the time of 
https://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification, it still worked 
apparently but I might have accidentaly broken it later. 

Anyway I was wondering if it was worth fixing that? as it might be a continuing 
maintenance pain... This was something I actually considered during RFC 46 (I 
mean dropping support for --without-ogr).

Even

> Dear all,
> 
> I may have found an issue in the build scripts of gdal 2.0.0. Building
> gdal without ogr on Linux fails on my machine:
> 
> ./configure --without-ogr
> make -j8
> 
> I attached the output of configure and copied the snippets from the
> build output detailing the errors below.
> 
> When I change --without-ogr into --with-ogr, the build succeeds.
> 
> Maybe something OGR-ish is building while it shouldn't(?).
> 
> Best regards,
> Kor de Jong
> 
> 
> 
> 
> libtool: compile:  /opt/gcc-4.9/bin/g++ -I/tmp/blah/gdal-2.0.0/port
> -I/tmp/blah/gdal-2.0.0/gcore -I/tmp/blah/gdal-2.0.0/alg
> -I/tmp/blah/gdal-2.0.0/ogr -I/tmp/blah/gdal-2.0.0/ogr/ogrsf_frmts -g -O2
> -Wall -I/tmp/blah/gdal-2.0.0/port -I/usr/include -DGDAL_COMPILATION -c
> mffdataset.cpp -o ../o/mffdataset.o >/dev/null 2>&1
> ogrutils.cpp: In function ?int OGRGeneralCmdLineProcessor(int, char***,
> int)?:
> ogrutils.cpp:526:60: error: ?GDAL_OF_VECTOR? was not declared in this scope
>       return GDALGeneralCmdLineProcessor( nArgc, ppapszArgv,
> GDAL_OF_VECTOR );
>                                                              ^
> ogrutils.cpp:526:75: error: ?GDALGeneralCmdLineProcessor? was not
> declared in this scope
>       return GDALGeneralCmdLineProcessor( nArgc, ppapszArgv,
> GDAL_OF_VECTOR );
> 
>      ^
> ogrutils.cpp:527:1: warning: control reaches end of non-void function
> [-Wreturn-type]
>   }
>   ^
> make[1]: *** [ogrutils.lo] Error 1
> make[1]: *** Waiting for unfinished jobs....
> 
> 
> 
> 
> 
> pdfwritabledataset.cpp: In member function ?virtual OGRErr
> PDFWritableVectorDataset::SyncToDisk()?:
> pdfwritabledataset.cpp:307:17: error: ?class GDALPDFWriter? has no
> member named ?WriteOGRLayer?
>           oWriter.WriteOGRLayer((OGRDataSourceH)this,
>                   ^
> make[2]: *** [../o/pdfwritabledataset.lo] Error 1
> make[2]: *** Waiting for unfinished jobs....
> 
> 
> 
> make[1]: *** [pdf-install-obj] Error 2
> make[1]: *** Waiting for unfinished jobs....
> make: *** [frmts-target] Error 2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From woodbri at swoodbridge.com  Tue Jun 23 18:49:15 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Tue, 23 Jun 2015 21:49:15 -0400
Subject: [gdal-dev] gdal_calc.py looses the color lookup table
Message-ID: <558A0C9B.2060403@swoodbridge.com>

Hi All,

I have a geotiff file like:

[] ~/work/oceandata/test$ gdalinfo A2015173174000.L0_LAC.L2_OC.tif -noct
Driver: GTiff/GeoTIFF
Files: A2015173174000.L0_LAC.L2_OC.tif
        A2015173174000.L0_LAC.L2_OC.tif.aux.xml
Size is 2433, 1727
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-84.000000000000000,45.000000000000000)
Pixel Size = (0.012741471640766,-0.012738853693008)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
Band 1 Block=2433x3 Type=Byte, ColorInterp=Palette
   Min=0.000 Max=250.000
   Minimum=0.000, Maximum=250.000, Mean=0.850, StdDev=9.542
   Metadata:
     STATISTICS_MAXIMUM=250
     STATISTICS_MEAN=0.85033548789076
     STATISTICS_MINIMUM=0
     STATISTICS_STDDEV=9.542216344358
   Color Table (RGB with 256 entries)

It has multiple entries to the color lookup table that should be treated 
as NODATA for example entries 251-255.

So I run gdal_calc.py like:

[] ~/work/oceandata/test$ gdal_calc.py -A 
A2015173174000.L0_LAC.L2_OC.tif --outfile=test.tif --calc="A*(A<251)" 
--NoDataValue=0 --co="TILED=YES"
0 .. 10 .. 20 .. 30 .. 40 .. 50 .. 60 .. 70 .. 80 .. 90 .. 100 - Done

and it create a gray-scale image with no color lut.

[] ~/work/oceandata/test$ gdalinfo test.tif
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 2433, 1727
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-84.000000000000000,45.000000000000000)
Pixel Size = (0.012741471640766,-0.012738853693008)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
   NoData Value=0


[] ~/work/oceandata/test$ gdalinfo --version
GDAL 1.10.1, released 2013/08/26

So is there away to get gdal_calc.py to copy the LUT to the output file?
Is there a better way/different way to set these pixels to be NODATA?

Thanks,
   -Steve

From lucadeluge at gmail.com  Tue Jun 23 23:47:19 2015
From: lucadeluge at gmail.com (Luca Delucchi)
Date: Wed, 24 Jun 2015 08:47:19 +0200
Subject: [gdal-dev] python ogr feature didn't save attributes
In-Reply-To: <201506231602.25334.even.rouault@spatialys.com>
References: <CAK4m-3xkVb2LZ4QSEbhM6DCjgvpKjDo1nD1sv3SpEeGMjLpLoA@mail.gmail.com>
	<201506231602.25334.even.rouault@spatialys.com>
Message-ID: <CAK4m-3yxvbuFfRMAMaK-qYmSGtx5w484CqKd8M8Wop5cmU2Yag@mail.gmail.com>

On 23 June 2015 at 16:02, Even Rouault <even.rouault at spatialys.com> wrote:
> Luca,
>

Hi Even,

>>
>> I'm writing a function to cycle inside the feature and update a column
>> of attribute table, if I print the feature with DumpReadable() I can
>> see the right attributes but when the script finish the final
>> shapefile has no attribute table, any idea?
>>
>> This is the relevant part of code
>>
>> featureDefn = lay0.GetLayerDefn()
>> field = ogr.FieldDefn(out_col, ogr.OFTReal)
>> featureDefn.AddFieldDefn(field)
>
> As suggested in http://gdal.org/python/osgeo.ogr.FeatureDefn-
> class.html#AddFieldDefn , you must call CreateField() on the layer object
> instead.
>

Also if I'm creating a new vector, not updating the existing one?

Because I use the featureDefn when I create the new feature, if I
understood well CreateField should be used only to create a new field
in an existing layer

> Even
>


-- 
ciao
Luca

http://gis.cri.fmach.it/delucchi/
www.lucadelu.org

From even.rouault at spatialys.com  Wed Jun 24 01:29:03 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Jun 2015 10:29:03 +0200
Subject: [gdal-dev] python ogr feature didn't save attributes
In-Reply-To: <CAK4m-3yxvbuFfRMAMaK-qYmSGtx5w484CqKd8M8Wop5cmU2Yag@mail.gmail.com>
References: <CAK4m-3xkVb2LZ4QSEbhM6DCjgvpKjDo1nD1sv3SpEeGMjLpLoA@mail.gmail.com>
	<201506231602.25334.even.rouault@spatialys.com>
	<CAK4m-3yxvbuFfRMAMaK-qYmSGtx5w484CqKd8M8Wop5cmU2Yag@mail.gmail.com>
Message-ID: <201506241029.04132.even.rouault@spatialys.com>

Le mercredi 24 juin 2015 08:47:19, Luca Delucchi a ?crit :
> On 23 June 2015 at 16:02, Even Rouault <even.rouault at spatialys.com> wrote:
> > Luca,
> 
> Hi Even,
> 
> >> I'm writing a function to cycle inside the feature and update a column
> >> of attribute table, if I print the feature with DumpReadable() I can
> >> see the right attributes but when the script finish the final
> >> shapefile has no attribute table, any idea?
> >> 
> >> This is the relevant part of code
> >> 
> >> featureDefn = lay0.GetLayerDefn()
> >> field = ogr.FieldDefn(out_col, ogr.OFTReal)
> >> featureDefn.AddFieldDefn(field)
> > 
> > As suggested in http://gdal.org/python/osgeo.ogr.FeatureDefn-
> > class.html#AddFieldDefn , you must call CreateField() on the layer object
> > instead.
> 
> Also if I'm creating a new vector, not updating the existing one?
> 
> Because I use the featureDefn when I create the new feature, if I
> understood well CreateField should be used only to create a new field
> in an existing layer

Yes, use CreateField() only to add a new field that didn't exist in the layer 
before. If it is already existing, just use the existing feature definition.

> 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jun 24 05:59:35 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Jun 2015 14:59:35 +0200
Subject: [gdal-dev] gdal_calc.py looses the color lookup table
In-Reply-To: <558A0C9B.2060403@swoodbridge.com>
References: <558A0C9B.2060403@swoodbridge.com>
Message-ID: <201506241459.35252.even.rouault@spatialys.com>

Le mercredi 24 juin 2015 03:49:15, Stephen Woodbridge a ?crit :
> Hi All,
> 
> I have a geotiff file like:
> 
> [] ~/work/oceandata/test$ gdalinfo A2015173174000.L0_LAC.L2_OC.tif -noct
> Driver: GTiff/GeoTIFF
> Files: A2015173174000.L0_LAC.L2_OC.tif
>         A2015173174000.L0_LAC.L2_OC.tif.aux.xml
> Size is 2433, 1727
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-84.000000000000000,45.000000000000000)
> Pixel Size = (0.012741471640766,-0.012738853693008)
> Metadata:
>    AREA_OR_POINT=Area
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
> Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
> Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
> Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
> Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
> Band 1 Block=2433x3 Type=Byte, ColorInterp=Palette
>    Min=0.000 Max=250.000
>    Minimum=0.000, Maximum=250.000, Mean=0.850, StdDev=9.542
>    Metadata:
>      STATISTICS_MAXIMUM=250
>      STATISTICS_MEAN=0.85033548789076
>      STATISTICS_MINIMUM=0
>      STATISTICS_STDDEV=9.542216344358
>    Color Table (RGB with 256 entries)
> 
> It has multiple entries to the color lookup table that should be treated
> as NODATA for example entries 251-255.
> 
> So I run gdal_calc.py like:
> 
> [] ~/work/oceandata/test$ gdal_calc.py -A
> A2015173174000.L0_LAC.L2_OC.tif --outfile=test.tif --calc="A*(A<251)"
> --NoDataValue=0 --co="TILED=YES"
> 0 .. 10 .. 20 .. 30 .. 40 .. 50 .. 60 .. 70 .. 80 .. 90 .. 100 - Done
> 
> and it create a gray-scale image with no color lut.
> 
> [] ~/work/oceandata/test$ gdalinfo test.tif
> Driver: GTiff/GeoTIFF
> Files: test.tif
> Size is 2433, 1727
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-84.000000000000000,45.000000000000000)
> Pixel Size = (0.012741471640766,-0.012738853693008)
> Metadata:
>    AREA_OR_POINT=Area
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
> Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
> Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
> Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
> Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
>    NoData Value=0
> 
> 
> [] ~/work/oceandata/test$ gdalinfo --version
> GDAL 1.10.1, released 2013/08/26
> 
> So is there away to get gdal_calc.py to copy the LUT to the output file?
> Is there a better way/different way to set these pixels to be NODATA?

Steve,

https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/attachpct.py could 
be used as post processing to re-apply the color table.

Even

> 
> Thanks,
>    -Steve
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jesse.hietanen at gmail.com  Wed Jun 24 06:19:01 2015
From: jesse.hietanen at gmail.com (johie)
Date: Wed, 24 Jun 2015 06:19:01 -0700 (PDT)
Subject: [gdal-dev] GDAL Java Bindings - No data value using
 AutoCreateWarpedVRT
Message-ID: <1435151941393-5212697.post@n6.nabble.com>

Hi,

I have been working with small application to reproject some raster files
into WGS84. For this purpose I have used GDAL and Java Bindings.
Reprojection works just fine, but the problem is that it creates "black"
bounding box around the warped image (see image below) The problem with this
is that the value of this black area is 0. In my data I have values of 0, so
I cannot really set it as noData later. Below is also the part of my code I
have been using to do this. I have already spent hours with this problem :/

So my question is, is there any way to input some parameter to the
autoCreateWarpedVRT that it changes the Nodata value or is there some way to
change it later? I must use Java bindings on the app :) It is sad that there
are so few examples of how to to actually use the gdal Java bindings
available on the internet. 


<http://osgeo-org.1560.x6.nabble.com/file/n5212697/BlackBoxAutoCreateWarpedVRT.png> 

        Band originalBand = inputDataset.GetRasterBand(1);
        Double[] noDataval = new Double[2];
        originalBand.GetNoDataValue(noDataval);

        SpatialReference dstRef = new SpatialReference("");
        dstRef.ImportFromEPSG(4326);

        Dataset vrt_ds = gdal.AutoCreateWarpedVRT(inputDataset,
inputDataset.GetProjection(), dstRef.ExportToWkt(),
gdalconst.GRA_NearestNeighbour);
        vrt_ds.GetRasterBand(1).SetNoDataValue(noDataval[0]);

        Driver GeoTiffDriver = gdal.GetDriverByName("GTiff");

        Dataset out_ds = GeoTiffDriver.CreateCopy("C:\\temp\\test.tif",
vrt_ds);
        out_ds.GetRasterBand(1).SetNoDataValue(noDataval[0]);

        vrt_ds.delete();
        inputDataset.delete();
        out_ds.delete();

Thanks for your help!




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-No-data-value-using-AutoCreateWarpedVRT-tp5212697.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun 24 07:35:59 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Jun 2015 16:35:59 +0200
Subject: [gdal-dev] GDAL Java Bindings - No data value using
	AutoCreateWarpedVRT
In-Reply-To: <1435151941393-5212697.post@n6.nabble.com>
References: <1435151941393-5212697.post@n6.nabble.com>
Message-ID: <201506241635.59159.even.rouault@spatialys.com>

Le mercredi 24 juin 2015 15:19:01, johie a ?crit :
> Hi,
> 
> I have been working with small application to reproject some raster files
> into WGS84. For this purpose I have used GDAL and Java Bindings.
> Reprojection works just fine, but the problem is that it creates "black"
> bounding box around the warped image (see image below) The problem with
> this is that the value of this black area is 0. In my data I have values
> of 0, so I cannot really set it as noData later. Below is also the part of
> my code I have been using to do this. I have already spent hours with this
> problem :/
> 
> So my question is, is there any way to input some parameter to the
> autoCreateWarpedVRT that it changes the Nodata value or is there some way
> to change it later? I must use Java bindings on the app :) It is sad that
> there are so few examples of how to to actually use the gdal Java bindings
> available on the internet.

Jesse,

I don't think you can do what you want to do in a single step with the current 
API (the librarified gdalwarp will be welcome for that !). The steps I see 
would be :
1) Use gdal.AutoCreateWarpedVRT() to get the output dataset dimension and 
geotransform and don't use it afterwards
2) Create a fresh new GeoTIFF with the above information with Driver.Create() 
+ Dataset.SetGeoTransform() + Dataset.SetProjection()
3) Set its nodata value to the value of your choice
4) Fill it completely with that value (Band.Fill())
5) Use gdal.ReprojectImage()

Note: I see that you need GDAL 2.0 from the doc of GDALReprojectImage(): 
"Starting with GDAL 2.0, nodata values set on destination dataset are taken 
into account."

More or less what gdalwarp does in fact. Except that it wouldn't do directly 
4, but use the INIT_DEST=NO_DATA warping option which would be slightly more 
efficient, but that wasn't yet available to SWIG, before my commit of a few 
seconds ago :-)

Even

> 
> 
> <http://osgeo-org.1560.x6.nabble.com/file/n5212697/BlackBoxAutoCreateWarped
> VRT.png>
> 
>         Band originalBand = inputDataset.GetRasterBand(1);
>         Double[] noDataval = new Double[2];
>         originalBand.GetNoDataValue(noDataval);
> 
>         SpatialReference dstRef = new SpatialReference("");
>         dstRef.ImportFromEPSG(4326);
> 
>         Dataset vrt_ds = gdal.AutoCreateWarpedVRT(inputDataset,
> inputDataset.GetProjection(), dstRef.ExportToWkt(),
> gdalconst.GRA_NearestNeighbour);
>         vrt_ds.GetRasterBand(1).SetNoDataValue(noDataval[0]);
> 
>         Driver GeoTiffDriver = gdal.GetDriverByName("GTiff");
> 
>         Dataset out_ds = GeoTiffDriver.CreateCopy("C:\\temp\\test.tif",
> vrt_ds);
>         out_ds.GetRasterBand(1).SetNoDataValue(noDataval[0]);
> 
>         vrt_ds.delete();
>         inputDataset.delete();
>         out_ds.delete();
> 
> Thanks for your help!
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-No-data-va
> lue-using-AutoCreateWarpedVRT-tp5212697.html Sent from the GDAL - Dev
> mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kusala9 at googlemail.com  Wed Jun 24 08:11:36 2015
From: kusala9 at googlemail.com (kusala nine)
Date: Wed, 24 Jun 2015 16:11:36 +0100
Subject: [gdal-dev]  compiling mongodb driver???
Message-ID: <CAOn9mqdyBnWyYwnaded1BYAnSyYwbAMUPa5WOkTQfm_ZVU-ZRw@mail.gmail.com>

Hi - has anyone got any pointers on compiling the mongodb drivers into the
latest 2.0.0 version of gdal. I've been watching for a while and the new
2.0.0 page has a table saying that mongo is included but not compiled in by
default. I've downloaded the libraries and compiled them from the link on
the gdal "vector formats" page but no idea how to integrate the mongo
library into the rest of the ogr tools. I know there was a bit of traffic
about this a year ago but couldn't find anything more up to date. All help
gratefully received!....

thanks

Jon.(P).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150624/ea7e6993/attachment.html>

From even.rouault at spatialys.com  Wed Jun 24 08:23:26 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Jun 2015 17:23:26 +0200
Subject: [gdal-dev] compiling mongodb driver???
In-Reply-To: <CAOn9mqdyBnWyYwnaded1BYAnSyYwbAMUPa5WOkTQfm_ZVU-ZRw@mail.gmail.com>
References: <CAOn9mqdyBnWyYwnaded1BYAnSyYwbAMUPa5WOkTQfm_ZVU-ZRw@mail.gmail.com>
Message-ID: <201506241723.26765.even.rouault@spatialys.com>

Jon,

It is in the development version (2.1.0dev), not 2.0.0. The website displays 
the doc of the dev version. 

On Unix, you must use the following configure options:
  --with-mongocxx=ARG        Include MongoCXX support (ARG=Path, yes or no)
  --with-boost-lib-path=ARG   Path to boost libraries for mongocxx client

On Windows, look at the directions in nmake.opt (search for MONGO)

Even


> Hi - has anyone got any pointers on compiling the mongodb drivers into the
> latest 2.0.0 version of gdal. I've been watching for a while and the new
> 2.0.0 page has a table saying that mongo is included but not compiled in by
> default. I've downloaded the libraries and compiled them from the link on
> the gdal "vector formats" page but no idea how to integrate the mongo
> library into the rest of the ogr tools. I know there was a bit of traffic
> about this a year ago but couldn't find anything more up to date. All help
> gratefully received!....
> 
> thanks
> 
> Jon.(P).

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kusala9 at googlemail.com  Wed Jun 24 08:28:30 2015
From: kusala9 at googlemail.com (kusala nine)
Date: Wed, 24 Jun 2015 16:28:30 +0100
Subject: [gdal-dev] compiling mongodb driver???
In-Reply-To: <201506241723.26765.even.rouault@spatialys.com>
References: <CAOn9mqdyBnWyYwnaded1BYAnSyYwbAMUPa5WOkTQfm_ZVU-ZRw@mail.gmail.com>
	<201506241723.26765.even.rouault@spatialys.com>
Message-ID: <CAOn9mqe0hX5r9AhRg1BoqwODvgqDgP_ccCedAxzputxYGQQ72w@mail.gmail.com>

great thanks - I'll have a go. many thanks for the pointer.

J

On Wed, Jun 24, 2015 at 4:23 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Jon,
>
> It is in the development version (2.1.0dev), not 2.0.0. The website
> displays
> the doc of the dev version.
>
> On Unix, you must use the following configure options:
>   --with-mongocxx=ARG        Include MongoCXX support (ARG=Path, yes or no)
>   --with-boost-lib-path=ARG   Path to boost libraries for mongocxx client
>
> On Windows, look at the directions in nmake.opt (search for MONGO)
>
> Even
>
>
> > Hi - has anyone got any pointers on compiling the mongodb drivers into
> the
> > latest 2.0.0 version of gdal. I've been watching for a while and the new
> > 2.0.0 page has a table saying that mongo is included but not compiled in
> by
> > default. I've downloaded the libraries and compiled them from the link on
> > the gdal "vector formats" page but no idea how to integrate the mongo
> > library into the rest of the ogr tools. I know there was a bit of traffic
> > about this a year ago but couldn't find anything more up to date. All
> help
> > gratefully received!....
> >
> > thanks
> >
> > Jon.(P).
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150624/0161f6e4/attachment.html>

From woodbri at swoodbridge.com  Wed Jun 24 08:32:06 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Wed, 24 Jun 2015 11:32:06 -0400
Subject: [gdal-dev] gdal_calc.py looses the color lookup table
In-Reply-To: <201506241459.35252.even.rouault@spatialys.com>
References: <558A0C9B.2060403@swoodbridge.com>
	<201506241459.35252.even.rouault@spatialys.com>
Message-ID: <558ACD76.8070505@swoodbridge.com>

On 6/24/2015 8:59 AM, Even Rouault wrote:
> Le mercredi 24 juin 2015 03:49:15, Stephen Woodbridge a ?crit :
>> Hi All,
>>
>> I have a geotiff file like:
>>
>> [] ~/work/oceandata/test$ gdalinfo A2015173174000.L0_LAC.L2_OC.tif -noct
>> Driver: GTiff/GeoTIFF
>> Files: A2015173174000.L0_LAC.L2_OC.tif
>>          A2015173174000.L0_LAC.L2_OC.tif.aux.xml
>> Size is 2433, 1727
>> Coordinate System is:
>> GEOGCS["WGS 84",
>>       DATUM["WGS_1984",
>>           SPHEROID["WGS 84",6378137,298.257223563,
>>               AUTHORITY["EPSG","7030"]],
>>           AUTHORITY["EPSG","6326"]],
>>       PRIMEM["Greenwich",0],
>>       UNIT["degree",0.0174532925199433],
>>       AUTHORITY["EPSG","4326"]]
>> Origin = (-84.000000000000000,45.000000000000000)
>> Pixel Size = (0.012741471640766,-0.012738853693008)
>> Metadata:
>>     AREA_OR_POINT=Area
>> Image Structure Metadata:
>>     INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
>> Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
>> Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
>> Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
>> Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
>> Band 1 Block=2433x3 Type=Byte, ColorInterp=Palette
>>     Min=0.000 Max=250.000
>>     Minimum=0.000, Maximum=250.000, Mean=0.850, StdDev=9.542
>>     Metadata:
>>       STATISTICS_MAXIMUM=250
>>       STATISTICS_MEAN=0.85033548789076
>>       STATISTICS_MINIMUM=0
>>       STATISTICS_STDDEV=9.542216344358
>>     Color Table (RGB with 256 entries)
>>
>> It has multiple entries to the color lookup table that should be treated
>> as NODATA for example entries 251-255.
>>
>> So I run gdal_calc.py like:
>>
>> [] ~/work/oceandata/test$ gdal_calc.py -A
>> A2015173174000.L0_LAC.L2_OC.tif --outfile=test.tif --calc="A*(A<251)"
>> --NoDataValue=0 --co="TILED=YES"
>> 0 .. 10 .. 20 .. 30 .. 40 .. 50 .. 60 .. 70 .. 80 .. 90 .. 100 - Done
>>
>> and it create a gray-scale image with no color lut.
>>
>> [] ~/work/oceandata/test$ gdalinfo test.tif
>> Driver: GTiff/GeoTIFF
>> Files: test.tif
>> Size is 2433, 1727
>> Coordinate System is:
>> GEOGCS["WGS 84",
>>       DATUM["WGS_1984",
>>           SPHEROID["WGS 84",6378137,298.257223563,
>>               AUTHORITY["EPSG","7030"]],
>>           AUTHORITY["EPSG","6326"]],
>>       PRIMEM["Greenwich",0],
>>       UNIT["degree",0.0174532925199433],
>>       AUTHORITY["EPSG","4326"]]
>> Origin = (-84.000000000000000,45.000000000000000)
>> Pixel Size = (0.012741471640766,-0.012738853693008)
>> Metadata:
>>     AREA_OR_POINT=Area
>> Image Structure Metadata:
>>     INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
>> Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
>> Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
>> Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
>> Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
>> Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
>>     NoData Value=0
>>
>>
>> [] ~/work/oceandata/test$ gdalinfo --version
>> GDAL 1.10.1, released 2013/08/26
>>
>> So is there away to get gdal_calc.py to copy the LUT to the output file?
>> Is there a better way/different way to set these pixels to be NODATA?
>
> Steve,
>
> https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/attachpct.py could
> be used as post processing to re-apply the color table.
>
> Even

Even,

Thank you! you have come to my rescue again.

Best regards,
   -Steve

>>
>> Thanks,
>>     -Steve
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From woodbri at swoodbridge.com  Wed Jun 24 18:49:39 2015
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Wed, 24 Jun 2015 21:49:39 -0400
Subject: [gdal-dev] How is NODATA interperted with a color table?
Message-ID: <558B5E33.7070700@swoodbridge.com>

I have a geotiff  with one band of byte with a color table, but it does 
not have NODATA set in it. How would I set it NODATA to be to be entry 0 
in the color table.

$ gdalinfo A2015173174000.L0_LAC.L2_OC.tif
Driver: GTiff/GeoTIFF
Files: A2015173174000.L0_LAC.L2_OC.tif
Size is 2433, 1727
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-84.000000000000000,45.000000000000000)
Pixel Size = (0.012741471640766,-0.012738853693008)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
Band 1 Block=2433x3 Type=Byte, ColorInterp=Palette
   Color Table (RGB with 256 entries)
     0: 147,0,108,255
     ...
   255: 0,0,0,255

I tried the following:

$ gdal_translate -a_nodata 0 -co TILED=YES A2015173174000.L0_LAC.tif 
test-tc.tif
Input file size is 2433, 1727
0...10...20...30...40...50...60...70...80...90...100 - done.
[] ~/work/oceandata/test$ gdalinfo test-tc.tif
Driver: GTiff/GeoTIFF
Files: test-tc.tif
Size is 2433, 1727
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-84.000000000000000,45.000000000000000)
Pixel Size = (0.012741471640766,-0.012738853693008)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  ( -84.0000000,  45.0000000) ( 84d 0' 0.00"W, 45d 0' 0.00"N)
Lower Left  ( -84.0000000,  22.9999997) ( 84d 0' 0.00"W, 23d 0' 0.00"N)
Upper Right ( -52.9999995,  45.0000000) ( 53d 0' 0.00"W, 45d 0' 0.00"N)
Lower Right ( -52.9999995,  22.9999997) ( 53d 0' 0.00"W, 23d 0' 0.00"N)
Center      ( -68.4999997,  33.9999998) ( 68d30' 0.00"W, 34d 0' 0.00"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
   NoData Value=0
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
   NoData Value=0
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
   NoData Value=0

But that does not look correct, so I'm checking. Also I don't see any 
note that the tif is TILED?

Thanks,
   -Steve

From baas at speerit.nl  Wed Jun 24 23:41:25 2015
From: baas at speerit.nl (Jelmer Baas)
Date: Thu, 25 Jun 2015 06:41:25 +0000
Subject: [gdal-dev] FW: [mapserver-users] Segfaults with MapScript from
	Python
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B229F7DB0@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B229F767C@mailserver>
	<CABqPoBaG9xa2Bh+yAih7ZW78gYYAKNLOKxCd7je6z85Wc5-SaQ@mail.gmail.com>
	<BC9747AD8551184D9B674A8310FE337B229F7DB0@mailserver>
Message-ID: <BC9747AD8551184D9B674A8310FE337B27251F2E@mailserver>

Hi all,

A crosspost between mapserver and gdal, since I have no idea where to look, now. 

The issue I wrote about below still exists, although I implemented a crappy workaround (when a label starts with a (, I add a . in front of it - yuck). 

There's another issue I found, though: I have a ogr_style column value with
LABEL(t:"1,2",a:295.800000,s:1.293854g,c:#ff0000,p:1,f:"ISOCP")
This is rendered as '1', instead of '1,2'. Replacing the comma with a period seems to work OK. Also quoting the string works:
LABEL(t:"'1,2'",a:295.800000,s:1.293854g,c:#ff0000,p:1,f:"ISOCP")

It seems both my issues are related to parsing of the OGR_STYLE column when using an ANNOTATION layer in MapServer. Is this a known issue? If not, can someone please tell me where to look to investigate? As I said before, I simply use the binaries for MapServer, so I'm not really that well versed in the 'code hacking'. I'd still be willing to jump into this, though, but I'd need some pointers on where to start, first.

Thanks,

Regards,
Jelmer


-----Original Message-----
From: mapserver-users-bounces at lists.osgeo.org [mailto:mapserver-users-bounces at lists.osgeo.org] On Behalf Of Jelmer Baas
Sent: vrijdag 13 februari 2015 11:07
To: Dan Little
Cc: mapserver-users at lists.osgeo.org
Subject: Re: [mapserver-users] Segfaults with MapScript from Python

Dan, List,

I've been messing around with this issue some more, and found the cause!

This record crashes MapScript is this (this is the ONLY record in the database now):
OID, geom, ogr_style
1234, POINT(620008 6697971), 'LABEL(t:"(0) test")'

The ONLY thing that matters is the OGR_STYLE clause - the (0) part. Replace the style with 'LABEL(t:".(0) test")' and all is well.

I attached my test scripts. Run simply with 'python test.py'.

Test-data:
CREATE TABLE testset
(
  oid oid,
  geom geometry,
  ogr_style character varying(350),
  filetype character(1)
)
Insert into testset(oid, geom, ogr_style) values (1234, '010100002031BF0D00F726AD90D0EB2241846601CDFC8C5941', 'LABEL(t:"(0) test")')

This single record crashes Python / MapScript with a lovely
" Segmentation fault (core dumped)".

Hopefully someone can debug this issue.

Regards,
Jelmer

-----Original Message-----
From: Dan Little [mailto:theduckylittle at gmail.com] 
Sent: donderdag 12 februari 2015 16:55
To: Jelmer Baas
Cc: mapserver-users at lists.osgeo.org
Subject: Re: [mapserver-users] Segfaults with MapScript from Python

I don't see any debugging symbols in there making life a little bit
more difficult.

Is your Python code very complex? Could a useful snippet be posted to a gist?

On Thu, Feb 12, 2015 at 9:44 AM, Jelmer Baas <baas at speerit.nl> wrote:
> Hi List,
>
> Some of my automated renders are failing because Python crashes with an Segmentation fault. I've finally found at least some logs of this:
> Feb 12 16:16:19 vm-ctwrender07 kernel: [276759.889265] traps: python[8002] general protection ip:7f104ec4f50f sp:7fff17d8d790 error:0 in libmapserver.so.6.4.1[7f104eb91000+1d8000]
> Feb 12 15:08:01 vm-ctwrender07 kernel: [272664.046597] traps: python[7841] general protection ip:7f80558877b6 sp:7fff641f27c0 error:0 in libmapserver.so.6.4.1[7f80557c9000+1d8000]
> Feb 12 13:53:01 vm-ctwrender07 kernel: [268166.881041] python[7614]: segfault at fffffffffffffffc ip 00007f805588750f sp 00007fff641f27c0 error 5 in libmapserver.so.6.4.1[7f80557c9000+1d8000]
>
> Unfortunatly, I have no idea how to continue. I suspect this has something todo with odd font rendering (too large, too small), since I had issues with that before. Can someone match these addresses with code and find out where it crashes?
>
> Thanks in advance!
>
> Regards,
> Jelmer
> _______________________________________________
> mapserver-users mailing list
> mapserver-users at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/mapserver-users
-------------- next part --------------
A non-text attachment was scrubbed...
Name: MapScript crash.zip
Type: application/x-zip-compressed
Size: 2262 bytes
Desc: MapScript crash.zip
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150625/6c0d3be2/attachment.bin>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ATT00001.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150625/6c0d3be2/attachment.txt>

From even.rouault at spatialys.com  Thu Jun 25 05:14:46 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 25 Jun 2015 14:14:46 +0200
Subject: [gdal-dev] How is NODATA interperted with a color table?
In-Reply-To: <558B5E33.7070700@swoodbridge.com>
References: <558B5E33.7070700@swoodbridge.com>
Message-ID: <201506251414.46929.even.rouault@spatialys.com>


> But that does not look correct, so I'm checking. Also I don't see any
> note that the tif is TILED?

Steve,

I suspect you've also added -expand rgb ? You could have tried -a_nodata 0 
directly on the paletted TIF. The nodata value should be reported, and the 
transparency component of entry 0 set to 0 instead of 255.

The TILED aspect is covered by "Block=256x256" in the above report (your 
original dataset was stripped organized because of "Block=2433x3 ")

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 25 05:32:34 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 25 Jun 2015 14:32:34 +0200
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
In-Reply-To: <201506190952.30173.even.rouault@spatialys.com>
References: <201506190952.30173.even.rouault@spatialys.com>
Message-ID: <201506251432.34739.even.rouault@spatialys.com>

Le vendredi 19 juin 2015 09:52:30, Even Rouault a ?crit :
> Hi,
> 
> As no points have been raised on the RFC:
> 
> Motion : I move to adopt RFC 26: GDAL Block Cache Improvements
> 
> https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
> 
> Starting with my +1

Hi,

I declare this motion passed with +1 from DanielM and me, and +0 from JukkaR

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Thu Jun 25 05:41:07 2015
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 25 Jun 2015 14:41:07 +0200
Subject: [gdal-dev] Motion: Adopt RFC 26: GDAL Block Cache Improvements
In-Reply-To: <201506190952.30173.even.rouault@spatialys.com>
References: <201506190952.30173.even.rouault@spatialys.com>
Message-ID: <CACALY+TNjN+wLH2dg40rAUC0Hd1JdRz4TtS9wSHW+pvvYW+oSw@mail.gmail.com>

A belated +1 here. As being the initial author, I'm happy to get it
implemented.

2015-06-19 9:52 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> As no points have been raised on the RFC:
>
> Motion : I move to adopt RFC 26: GDAL Block Cache Improvements
>
> https://trac.osgeo.org/gdal/wiki/rfc26_blockcache
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150625/c92fa916/attachment.html>

From mcasella03 at gmail.com  Thu Jun 25 06:02:26 2015
From: mcasella03 at gmail.com (marco casella)
Date: Thu, 25 Jun 2015 15:02:26 +0200
Subject: [gdal-dev] shape to kml with uav imagery associated
Message-ID: <CAJogQe0WHMX+EHbW1zRbA1svymWsV2gFA0CiHrS7p46TmTGrAg@mail.gmail.com>

Hello developers,

I would like to convert a shape file in a kml where each point of this file
if clicked opens an image taken by UAV.

What do you suggest to do?

Best regards.

Marco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150625/00ffc61e/attachment.html>

From jesse.hietanen at gmail.com  Thu Jun 25 23:02:50 2015
From: jesse.hietanen at gmail.com (johie)
Date: Thu, 25 Jun 2015 23:02:50 -0700 (PDT)
Subject: [gdal-dev] GDAL Java Bindings - No data value using
 AutoCreateWarpedVRT
In-Reply-To: <1435151941393-5212697.post@n6.nabble.com>
References: <1435151941393-5212697.post@n6.nabble.com>
Message-ID: <1435298570175-5213048.post@n6.nabble.com>

Hi Evan,

Thanks a lot! Worked like a charm! :)

Jesse



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-Java-Bindings-No-data-value-using-AutoCreateWarpedVRT-tp5212697p5213048.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From davutcsmc at gmail.com  Thu Jun 25 23:24:33 2015
From: davutcsmc at gmail.com (davut cesmeci)
Date: Fri, 26 Jun 2015 09:24:33 +0300
Subject: [gdal-dev] getting "mapinfo" and "default bands" from header file
	by GDAL c++
Message-ID: <CAJE9eDABT7WodSbRBSMz1ivcqazSHqWJrorE3PNYkjxUxQDjfA@mail.gmail.com>

   Hi everyone,

i am working on a c++ program for studying geographic datas. i couldn't
figure it out how to get "mapinfo" and "default bands" parameters from ENVI
.hdr files by GDAL.

i solved my problem by reading header files as a text file using c++ but
wonder whether GDAL has an efficient way for do that or not. Because
matching source and header files is another problem for me, and hoping
somehow i can solve this problem by using GDAL.

  Sorry for bad english

  Best regards, Davut


-- 

We have to do the best that we are capable of.
That is our sacred human responsibility.

Davut ?E?MEC?
Phd. Student
Kocaeli University
Laboratory of Image and Signal Processing

Phone: 0 544 263 53 26

PS : http://www.davutcesmeci.com/iletisim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150626/9a0ac47d/attachment.html>

From oliveira.ricardo at hotmail.com  Fri Jun 26 16:06:06 2015
From: oliveira.ricardo at hotmail.com (Ricardo Oliveira)
Date: Fri, 26 Jun 2015 17:06:06 -0600
Subject: [gdal-dev] gdal_rasterize with text attributes.
Message-ID: <BAY182-W38465F77AE00408E0B710682AD0@phx.gbl>

Hello everyone,I'm trying to do a simple vector to raster conversion using an attribute field stored as string. Am I wrong or does gdal_rasterize does not accept text fields as attributes? Thanks for any insight.Ricardo O.
-----------------------------------------------------------------Ricardo Oliveira - Geographer
Personal Website: http://ricardooliveiragis.com/Blog: http://ricardooliveiragis.com/blog 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150626/dc32d2cb/attachment.html>

From goldfish_and_muskie at yahoo.com  Fri Jun 26 16:20:41 2015
From: goldfish_and_muskie at yahoo.com (Ruth Simm)
Date: Fri, 26 Jun 2015 23:20:41 +0000 (UTC)
Subject: [gdal-dev] Is there a gdalwarp command to turn 'internal nodata
 values' into nodata (and read as transparent by arcmap)?
Message-ID: <344995475.739544.1435360841205.JavaMail.yahoo@mail.yahoo.com>

Using this:
>> dtm>gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -te -2
0037508.34 -20037508.34 20037508.34 20037508.34 -of GTiff globe.vrt globe_3857_gdal.tif
Returned this message

>>Creating output file that is 194835P x 194835L.
>>Processing input file globe.vrt.
>>Using internal nodata values (eg. 0) for image merged.vrt.
All my 'NoData' values are now '0' and I was wondering if there was a way to just keep them as 'NoData' (and still transparent when read by ArcMap - as the globe.vrt is now).

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150626/5f968956/attachment.html>

From nicolas.cadieux at archeotec.ca  Fri Jun 26 21:33:49 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 27 Jun 2015 00:33:49 -0400
Subject: [gdal-dev] Is there a gdalwarp command to turn 'internal nodata
 values' into nodata (and read as transparent by arcmap)?
In-Reply-To: <344995475.739544.1435360841205.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <9dfc9c6e-df5b-4259-b75b-5e83335ef439@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150627/772150da/attachment.html>

From mwtoews at gmail.com  Sat Jun 27 00:54:38 2015
From: mwtoews at gmail.com (Mike Toews)
Date: Sat, 27 Jun 2015 19:54:38 +1200
Subject: [gdal-dev] gdal_rasterize with text attributes.
In-Reply-To: <BAY182-W38465F77AE00408E0B710682AD0@phx.gbl>
References: <BAY182-W38465F77AE00408E0B710682AD0@phx.gbl>
Message-ID: <CAM2FmMqQR8zYgN1S7RE1J6bU+JXurfx4QnXHqBMj3CVmYVvWAg@mail.gmail.com>

Rasters can only store numeric types, not strings. But you could
either rasterize the primary key, or reclassify the strings into a
so-called lookup table of ID and string (e.g. 1="green", 2="blue",
etc.). And then you could look-up the text from a raster using the
common integer ID.

-Mike

On 27 June 2015 at 11:06, Ricardo Oliveira <oliveira.ricardo at hotmail.com> wrote:
> Hello everyone,
>
> I'm trying to do a simple vector to raster conversion using an attribute
> field stored as string. Am I wrong or does gdal_rasterize does not accept
> text fields as attributes?
>
> Thanks for any insight.
>
> Ricardo O.

From nicolas.cadieux at archeotec.ca  Sun Jun 28 06:56:24 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sun, 28 Jun 2015 09:56:24 -0400
Subject: [gdal-dev] Is there a gdalwarp command to turn 'internal nodata
 values' into nodata (and read as transparent by arcmap)?
In-Reply-To: <344995475.739544.1435360841205.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <52aa9879-103e-4e4c-841d-3bee2fa3aba8@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150628/f6e3c399/attachment.html>

From adr.andre at laposte.net  Mon Jun 29 02:12:11 2015
From: adr.andre at laposte.net (=?UTF-8?B?QWRyaWVuIEFORFLDiQ==?=)
Date: Mon, 29 Jun 2015 11:12:11 +0200
Subject: [gdal-dev] Raster origin coodinates in file header
Message-ID: <55910BEB.2030307@laposte.net>

Dear list,

opening 2 rasters with different resolutions i noticed a shift.

Asking our imagery provider, i was told the origin coordinates they 
store in image header (JP2 files) are those of the top left pixel center.

GDAL reads origin coordinates as the top left pixel top left corner 
coordinates, as i'm used to.


Of course, i fixed my problem, the hacky way, playing with 
gdal_translate a_ullr option, but:

How to deal with this?
How not to worry about georeferencing each time i load a raster file?
Is there any OGC recommendation about origin coordinates storage?


Thanking you in advance,

Regards,

Adrien

From even.rouault at spatialys.com  Mon Jun 29 04:37:23 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 29 Jun 2015 13:37:23 +0200
Subject: [gdal-dev] Raster origin coodinates in file header
In-Reply-To: <55910BEB.2030307@laposte.net>
References: <55910BEB.2030307@laposte.net>
Message-ID: <201506291337.23687.even.rouault@spatialys.com>

Adrien,

> opening 2 rasters with different resolutions i noticed a shift.
> 
> Asking our imagery provider, i was told the origin coordinates they
> store in image header (JP2 files) are those of the top left pixel center.
> 
> GDAL reads origin coordinates as the top left pixel top left corner
> coordinates, as i'm used to.
> 
> 
> Of course, i fixed my problem, the hacky way, playing with
> gdal_translate a_ullr option, but:
> 
> How to deal with this?

Normally, if the image provider did its job correctly, GDAL should report a 
consistant georeferencing in its convention (top left corner of top left pixel 
is 0,0), doing half pixel shift if needed.

There are 2 ways of encoding georeferencing in JPEG2000:
- GMLJP2, which has a convention of center of top left pixel. GDAL adds a half 
pixel shift to translate into its convention
- GeoJP2 (GeoTIFF-in-JPEG2000), which in most cases, uses the pixel-is-area 
convention, which is the same as GDAL. In rare cases, it could be pixel-is-
center, in which case recent versions of GDAL (1.11 perhaps, 2.0 for sure), 
will translate to GDAL convention.

Both can be present in a same file, in which case GDAL will use GeoJP2 
contents.

So if you're seeing a half pixel shift, either there's a remaining bug in GDAL 
(not sure where), either the image provider didn't encode it correctly

> How not to worry about georeferencing each time i load a raster file?
> Is there any OGC recommendation about origin coordinates storage?

GMLJP2 mentions it. GMLJP2 v1 wasn't completely clear about that, but the 
language of GMLJP2 v2 has clarified it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mcasella03 at gmail.com  Mon Jun 29 07:15:32 2015
From: mcasella03 at gmail.com (marco casella)
Date: Mon, 29 Jun 2015 16:15:32 +0200
Subject: [gdal-dev] gdal translate
Message-ID: <CAJogQe1aGRuTL=Dc4JbfyYPgctav7Z63ppKWfKAi-GSW3YiREw@mail.gmail.com>

Hello,

I'm trying to convert a tiff file (dem) in a raw image.
I'm using this line:

gdal_translate ?ot UInt16 ?scale ?of ENVI ?outsize 1025 1025 dsm.tif
final.raw

it seems there is some kind of an error, I get this message:

"Too many command options."

Do you know if I am doing something wrong?

Marco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150629/5ef7b0ba/attachment.html>

From even.rouault at spatialys.com  Mon Jun 29 07:21:00 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 29 Jun 2015 16:21:00 +0200
Subject: [gdal-dev] gdal translate
In-Reply-To: <CAJogQe1aGRuTL=Dc4JbfyYPgctav7Z63ppKWfKAi-GSW3YiREw@mail.gmail.com>
References: <CAJogQe1aGRuTL=Dc4JbfyYPgctav7Z63ppKWfKAi-GSW3YiREw@mail.gmail.com>
Message-ID: <201506291621.00912.even.rouault@spatialys.com>

Le lundi 29 juin 2015 16:15:32, marco casella a ?crit :
> Hello,
> 
> I'm trying to convert a tiff file (dem) in a raw image.
> I'm using this line:
> 
> gdal_translate ?ot UInt16 ?scale ?of ENVI ?outsize 1025 1025 dsm.tif
> final.raw
> 
> it seems there is some kind of an error, I get this message:
> 
> "Too many command options."
> 
> Do you know if I am doing something wrong?

Marco,

If I paste your above command line, I also get the same error. This is due to 
the hyphen character being above a Unicode hyphen instead of the regular 
hyphen character you have on your keyboard.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From goldfish_and_muskie at yahoo.com  Mon Jun 29 16:14:55 2015
From: goldfish_and_muskie at yahoo.com (Ruth Simm)
Date: Mon, 29 Jun 2015 23:14:55 +0000 (UTC)
Subject: [gdal-dev] Is there a gdalwarp command to turn 'internal nodata
 values' into nodata (and read as transparent by arcmap)?
In-Reply-To: <52aa9879-103e-4e4c-841d-3bee2fa3aba8@email.android.com>
References: <52aa9879-103e-4e4c-841d-3bee2fa3aba8@email.android.com>
Message-ID: <1046637108.2424061.1435619695663.JavaMail.yahoo@mail.yahoo.com>

Interesting.I am using GDAL 1.9.1 - so it didn't seem to be an option in this older ver.
do you know how it is different then '-srcnodata None'?
 


     On Sunday, June 28, 2015 7:30 AM, Nicolas Cadieux <nicolas.cadieux at archeotec.ca> wrote:
   

 -dstnodata value [value...]:http://www.gdal.org/gdalwarp.htmlNicolas Cadieux M.Sc.
Les Entreprises Arch?otec inc.?
8548, rue Saint-Denis Montr?al H2P 2H2
T?l?phone:?514.381.5112 ?Fax: 514.381.4995
www.archeotec.caOn Jun 26, 2015 7:20 PM, Ruth Simm <goldfish_and_muskie at yahoo.com> wrote:

Using this:
>> dtm>gdalwarp -s_srs EPSG:4326 -t_srs EPSG:3857 -r bilinear -te -2
0037508.34 -20037508.34 20037508.34 20037508.34 -of GTiff globe.vrt globe_3857_gdal.tif
Returned this message

>>Creating output file that is 194835P x 194835L.
>>Processing input file globe.vrt.
>>Using internal nodata values (eg. 0) for image merged.vrt.
All my 'NoData' values are now '0' and I was wondering if there was a way to just keep them as 'NoData' (and still transparent when read by ArcMap - as the globe.vrt is now).




  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150629/2ffe03e9/attachment.html>

From goldfish_and_muskie at yahoo.com  Mon Jun 29 16:20:13 2015
From: goldfish_and_muskie at yahoo.com (Ruth Simm)
Date: Mon, 29 Jun 2015 23:20:13 +0000 (UTC)
Subject: [gdal-dev] gdaldem hillshade returns an empty .tif (i.e. everything
 is 181 (?))
Message-ID: <445454736.2406758.1435620013967.JavaMail.yahoo@mail.yahoo.com>

I ran this command on a completely NORMAL (but large) global .tiff with a few tiles missing - but nothing else suspicious - and after 40 minutes it returned a dud file with '181' being the only value.
Has this ever happened to anyone before?
gdaldem hillshade -of GTiff infile.tif hillshd.tif

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150629/1ee5f285/attachment.html>

From ljvillarin30 at gmail.com  Mon Jun 29 19:48:39 2015
From: ljvillarin30 at gmail.com (oz)
Date: Mon, 29 Jun 2015 19:48:39 -0700 (PDT)
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
Message-ID: <1435632519375-5213484.post@n6.nabble.com>

I am using windows 7(32-bit) and want to warp NetCDF (nc) files and save the
output as GeoTIFF.

First I run gdalinfo first to get the info of the subdataset I need and
added NeTCDF in the beginning(e.g. gdalinfo
NETCDF:"A2015069035500.L2_LAC_OC.nc") but was unfortunate because a warning
appeared:

Warning 1: Variable has 0 dimension(s) - not supported. 
gdalinfo failed - unable to open 'netCDF:A2015069035500.L2_LAC_OC.nc'.

Command line input:

gdalinfo A2015069035500.L2_LAC_OC.nc


NetCDF is present when I tried `gdalinfo --formats`. 

Does anyone have any idea about this? 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From nicolas.cadieux at archeotec.ca  Mon Jun 29 20:22:30 2015
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Mon, 29 Jun 2015 23:22:30 -0400
Subject: [gdal-dev] Is there a gdalwarp command to turn 'internal nodata
 values' into nodata (and read as transparent by arcmap)?
In-Reply-To: <1046637108.2424061.1435619695663.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <e1ad9731-3692-44d9-92ba-122b59dce791@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150629/b25395b5/attachment.html>

From piero.campa at gmail.com  Mon Jun 29 23:41:17 2015
From: piero.campa at gmail.com (Piero Campalani)
Date: Tue, 30 Jun 2015 08:41:17 +0200
Subject: [gdal-dev] =?utf-8?q?=E2=80=8BRe=3A_Raster_origin_coodinates_in_f?=
	=?utf-8?q?ile_header?=
Message-ID: <CAMp9JaPu8AMuhH8pq1sNsG7FVAep9O04bYirkdgFJPK2v5F_tQ@mail.gmail.com>

Adrien,

OGC in its GML standard document -- of course in line with ISO --
recommends that:

* "When a grid point is used to represent a sample space (e.g. image
pixel), the grid point represents the center of the sample space (see ISO
19123:2005, 8.2.2)"*. ?

?GML encodes the locations of a raster/gridded-coverage by means of a grid
of ?0D points.

?You can always put your raster origin wherever you want, i.e. in whatever
corner you prefer.
Alas, there's no way -- that I am aware of -- to specify what is the shape
of a measurement footprint/sample-space, nor to say if the footprint
surrounds the point-geometry equally (point is pixel-centre) or some other
way (point is pixel-upper-left-corner?).

Hence raster creators should probably stick to this recommended encoding
until standards do not offer more freedom on this :)

?@seeAlso
?http://rasdaman.org/wiki/PetascopeSubsets
http://rasdaman.org/ticket/680?

-
?Piero !?
?

On 29 June 2015 at 21:00, <gdal-dev-request at lists.osgeo.org> wrote:

> Date: Mon, 29 Jun 2015 11:12:11 +0200
> From: Adrien ANDR? <adr.andre at laposte.net>
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Raster origin coodinates in file header
> Message-ID: <55910BEB.2030307 at laposte.net>
> Content-Type: text/plain; charset=utf-8; format=flowed
>
> Dear list,
>
> opening 2 rasters with different resolutions i noticed a shift.
>
> Asking our imagery provider, i was told the origin coordinates they
> store in image header (JP2 files) are those of the top left pixel center.
>
> GDAL reads origin coordinates as the top left pixel top left corner
> coordinates, as i'm used to.
>
>
> Of course, i fixed my problem, the hacky way, playing with
> gdal_translate a_ullr option, but:
>
> How to deal with this?
> How not to worry about georeferencing each time i load a raster file?
> Is there any OGC recommendation about origin coordinates storage?
>
>
> Thanking you in advance,
>
> Regards,
>
> Adrien
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/39843f3c/attachment.html>

From ari.jolma at gmail.com  Tue Jun 30 00:40:18 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 30 Jun 2015 10:40:18 +0300
Subject: [gdal-dev] GIntBig in bindings
Message-ID: <559247E2.5090408@gmail.com>

Even,

I'm editing bindings to use GIntBig. That concerns ReadRaster and 
WriteRaster in Band and Dataset.

Is there a reason GDALDatasetRasterIO is used instead of 
GDALDatasetRasterIOEx for some parts of the bindings? I think the 
bindings should now use only GDALDatasetRasterIOEx, at least for clarity.

Regards,

Ari


From even.rouault at spatialys.com  Tue Jun 30 00:52:40 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Jun 2015 09:52:40 +0200
Subject: [gdal-dev] GIntBig in bindings
In-Reply-To: <559247E2.5090408@gmail.com>
References: <559247E2.5090408@gmail.com>
Message-ID: <201506300952.40877.even.rouault@spatialys.com>

Ari,

> 
> I'm editing bindings to use GIntBig. That concerns ReadRaster and
> WriteRaster in Band and Dataset.
> 
> Is there a reason GDALDatasetRasterIO is used instead of
> GDALDatasetRasterIOEx for some parts of the bindings?

None that I can think of

> I think the
> bindings should now use only GDALDatasetRasterIOEx, at least for clarity.

Agreed

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From anton.korosov at nersc.no  Tue Jun 30 00:40:52 2015
From: anton.korosov at nersc.no (Anton Korosov)
Date: Tue, 30 Jun 2015 09:40:52 +0200
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <1435632519375-5213484.post@n6.nabble.com>
References: <1435632519375-5213484.post@n6.nabble.com>
Message-ID: <55924804.5050307@nersc.no>

Hi!

The format of the new OBPG OceanColor files is HDF5 (aka NetCDF4), so 
you should have your GDAL compiled with HDF5 support:
http://www.gdal.org/frmt_hdf5.html

Then you can access the content of the file using groups and variables 
syntax:
gdalinfo HDF5:"A2015069035500.L2_LAC_OC.nc"://geophysical_data/chlor_a

Regards!
Anton

On 30/06/15 04:48, oz wrote:
> I am using windows 7(32-bit) and want to warp NetCDF (nc) files and save the
> output as GeoTIFF.
>
> First I run gdalinfo first to get the info of the subdataset I need and
> added NeTCDF in the beginning(e.g. gdalinfo
> NETCDF:"A2015069035500.L2_LAC_OC.nc") but was unfortunate because a warning
> appeared:
>
> Warning 1: Variable has 0 dimension(s) - not supported.
> gdalinfo failed - unable to open 'netCDF:A2015069035500.L2_LAC_OC.nc'.
>
> Command line input:
>
> gdalinfo A2015069035500.L2_LAC_OC.nc
>
>
> NetCDF is present when I tried `gdalinfo --formats`.
>
> Does anyone have any idea about this?
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From Julien.Demaria at acri-st.fr  Tue Jun 30 01:49:16 2015
From: Julien.Demaria at acri-st.fr (Julien Demaria)
Date: Tue, 30 Jun 2015 08:49:16 +0000
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <55924804.5050307@nersc.no>
References: <1435632519375-5213484.post@n6.nabble.com>
	<55924804.5050307@nersc.no>
Message-ID: <3B970FB76033264EB34479EC8A365E1101BA340E47@vwiexc030.acri.local>

Hi,

Note that I have implemented in GDAL support of NetCDF-4 files including groups and support of warping new NASA OceanColor L2 format using geolocation array but unfortunately still not finalized the patch to GDAL... More details here: http://osgeo-org.1560.x6.nabble.com/gdal-dev-NetCDF-driver-improvements-including-groups-support-td5185773.html
This also works for VIIRS L2 products.
I can provide the patch to you if you are interested, let me know.

Regards,
Julien

-----Message d'origine-----
De?: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Anton Korosov
Envoy??: mardi 30 juin 2015 09:41
??: gdal-dev at lists.osgeo.org
Objet?: Re: [gdal-dev] Getting warning when opening NetCDF file using gdal?

Hi!

The format of the new OBPG OceanColor files is HDF5 (aka NetCDF4), so you should have your GDAL compiled with HDF5 support:
http://www.gdal.org/frmt_hdf5.html

Then you can access the content of the file using groups and variables
syntax:
gdalinfo HDF5:"A2015069035500.L2_LAC_OC.nc"://geophysical_data/chlor_a

Regards!
Anton

On 30/06/15 04:48, oz wrote:
> I am using windows 7(32-bit) and want to warp NetCDF (nc) files and 
> save the output as GeoTIFF.
>
> First I run gdalinfo first to get the info of the subdataset I need 
> and added NeTCDF in the beginning(e.g. gdalinfo
> NETCDF:"A2015069035500.L2_LAC_OC.nc") but was unfortunate because a 
> warning
> appeared:
>
> Warning 1: Variable has 0 dimension(s) - not supported.
> gdalinfo failed - unable to open 'netCDF:A2015069035500.L2_LAC_OC.nc'.
>
> Command line input:
>
> gdalinfo A2015069035500.L2_LAC_OC.nc
>
>
> NetCDF is present when I tried `gdalinfo --formats`.
>
> Does anyone have any idea about this?
>
>
>
> --
> View this message in context: 
> http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCD
> F-file-using-gdal-tp5213484.html Sent from the GDAL - Dev mailing list 
> archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From ljvillarin30 at gmail.com  Tue Jun 30 02:08:50 2015
From: ljvillarin30 at gmail.com (oz)
Date: Tue, 30 Jun 2015 02:08:50 -0700 (PDT)
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <55924804.5050307@nersc.no>
References: <1435632519375-5213484.post@n6.nabble.com>
	<55924804.5050307@nersc.no>
Message-ID: <1435655330127-5213534.post@n6.nabble.com>

By specifying the chlor_a, it will just display all the info on chlor_a. But
how will I able to display the info or all the subdatasets of that file?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484p5213534.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ljvillarin30 at gmail.com  Tue Jun 30 02:26:58 2015
From: ljvillarin30 at gmail.com (oz)
Date: Tue, 30 Jun 2015 02:26:58 -0700 (PDT)
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <1435632519375-5213484.post@n6.nabble.com>
References: <1435632519375-5213484.post@n6.nabble.com>
Message-ID: <1435656418588-5213538.post@n6.nabble.com>

Is there any possibility where I could retrieve all the files from my
subscriptions in samoa.gsfc.nasa.gov ftp site? After a month all the files
were removed. How can I get all those files back so that I could download it 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484p5213538.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jun 30 02:41:51 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Jun 2015 11:41:51 +0200
Subject: [gdal-dev] gdaldem hillshade returns an empty .tif (i.e.
	everything is 181 (?))
In-Reply-To: <445454736.2406758.1435620013967.JavaMail.yahoo@mail.yahoo.com>
References: <445454736.2406758.1435620013967.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <201506301141.51293.even.rouault@spatialys.com>

Le mardi 30 juin 2015 01:20:13, Ruth Simm a ?crit :
> I ran this command on a completely NORMAL (but large) global .tiff with a
> few tiles missing - but nothing else suspicious - and after 40 minutes it
> returned a dud file with '181' being the only value. Has this ever
> happened to anyone before?
> gdaldem hillshade -of GTiff infile.tif hillshd.tif

Ruth,

I guess this might be an issue with the ratio of vertical units to horizontal.

http://gdal.org/gdaldem.html#gdaldem_hillshade:

-s scale:
ratio of vertical units to horizontal. If the horizontal unit of the source 
DEM is degrees (e.g Lat/Long WGS84 projection), you can use scale=111120 if 
the vertical units are meters (or scale=370400 if they are in feet) 

I'd suggest you experiment a bit on a subwindow of your big raster or a 
subsampled version of it first.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/6611b889/attachment.html>

From anton.korosov at nersc.no  Tue Jun 30 02:47:10 2015
From: anton.korosov at nersc.no (Anton Korosov)
Date: Tue, 30 Jun 2015 11:47:10 +0200
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <1435655330127-5213534.post@n6.nabble.com>
References: <1435632519375-5213484.post@n6.nabble.com>	<55924804.5050307@nersc.no>
	<1435655330127-5213534.post@n6.nabble.com>
Message-ID: <5592659E.6040004@nersc.no>

You can use 'ncdump -h A2015069035500.L2_LAC_OC.nc'
ncdump is not part of gdal, but it will show you the contents of the 
dataset.

In Python you can use netcdf4.Dataset to open HDF5 files.

On 30/06/15 11:08, oz wrote:
> By specifying the chlor_a, it will just display all the info on chlor_a. But
> how will I able to display the info or all the subdatasets of that file?
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484p5213534.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From mdsumner at gmail.com  Tue Jun 30 02:50:47 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 30 Jun 2015 09:50:47 +0000
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <5592659E.6040004@nersc.no>
References: <1435632519375-5213484.post@n6.nabble.com>
	<55924804.5050307@nersc.no>
	<1435655330127-5213534.post@n6.nabble.com> <5592659E.6040004@nersc.no>
Message-ID: <CAAcGz98mS52aQ3qR1EXKD9p=ag5oUhAEfvL0E6_kHLxuOBLTpw@mail.gmail.com>

Or rename to .h5 which triggers the right driver in GDAL.

It would be good if the format auto-detect could determine that the file
was HDF5 instead ?



On Tue, 30 Jun 2015 at 19:47 Anton Korosov <anton.korosov at nersc.no> wrote:

> You can use 'ncdump -h A2015069035500.L2_LAC_OC.nc'
> ncdump is not part of gdal, but it will show you the contents of the
> dataset.
>
> In Python you can use netcdf4.Dataset to open HDF5 files.
>
> On 30/06/15 11:08, oz wrote:
> > By specifying the chlor_a, it will just display all the info on chlor_a.
> But
> > how will I able to display the info or all the subdatasets of that file?
> >
> >
> >
> > --
> > View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484p5213534.html
> > Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/ba7a77a2/attachment.html>

From mdsumner at gmail.com  Tue Jun 30 02:53:36 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 30 Jun 2015 09:53:36 +0000
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <CAAcGz98mS52aQ3qR1EXKD9p=ag5oUhAEfvL0E6_kHLxuOBLTpw@mail.gmail.com>
References: <1435632519375-5213484.post@n6.nabble.com>
	<55924804.5050307@nersc.no>
	<1435655330127-5213534.post@n6.nabble.com> <5592659E.6040004@nersc.no>
	<CAAcGz98mS52aQ3qR1EXKD9p=ag5oUhAEfvL0E6_kHLxuOBLTpw@mail.gmail.com>
Message-ID: <CAAcGz9-8AHaXgJQAYgz+wuujcVEJdfijAAMzcBN15Zm2dDEp0Q@mail.gmail.com>

Also, the fully expanded path for SDS does work already:

gdalinfo HDF5:"A2015069000500.L2_LAC_OC.nc"://geophysical_data/Kd_490

Cheers, Mike.



On Tue, 30 Jun 2015 at 19:50 Michael Sumner <mdsumner at gmail.com> wrote:

> Or rename to .h5 which triggers the right driver in GDAL.
>
> It would be good if the format auto-detect could determine that the file
> was HDF5 instead ?
>
>
>
> On Tue, 30 Jun 2015 at 19:47 Anton Korosov <anton.korosov at nersc.no> wrote:
>
>> You can use 'ncdump -h A2015069035500.L2_LAC_OC.nc'
>> ncdump is not part of gdal, but it will show you the contents of the
>> dataset.
>>
>> In Python you can use netcdf4.Dataset to open HDF5 files.
>>
>> On 30/06/15 11:08, oz wrote:
>> > By specifying the chlor_a, it will just display all the info on
>> chlor_a. But
>> > how will I able to display the info or all the subdatasets of that file?
>> >
>> >
>> >
>> > --
>> > View this message in context:
>> http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484p5213534.html
>> > Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/e96f96d9/attachment-0001.html>

From ari.jolma at gmail.com  Tue Jun 30 03:10:39 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 30 Jun 2015 13:10:39 +0300
Subject: [gdal-dev] Extent of a Layer
Message-ID: <55926B1F.5080206@gmail.com>

I wonder when the GetExtent method of a layer started to return an 
Envelope - at least in the Perl bindings.

I'm quite certain that previously GetExtent method of Layer returned 
(Xmin,Ymin,Xmax,Ymax) and GetEnvelope of Geometry returned 
(Xmin,Xmax,Ymin,Ymax). Now they both return (Xmin,Xmax,Ymin,Ymax).

I've always noted the difference in the Perl bindings documentation and 
I have code that expects GetExtent to return (Xmin,Ymin,Xmax,Ymax).

However, I don't find any change like this happening in the repository. 
Strange.

Ari


From even.rouault at spatialys.com  Tue Jun 30 03:19:34 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Jun 2015 12:19:34 +0200
Subject: [gdal-dev] Extent of a Layer
In-Reply-To: <55926B1F.5080206@gmail.com>
References: <55926B1F.5080206@gmail.com>
Message-ID: <201506301219.34548.even.rouault@spatialys.com>

Le mardi 30 juin 2015 12:10:39, Ari Jolma a ?crit :
> I wonder when the GetExtent method of a layer started to return an
> Envelope - at least in the Perl bindings.
> 
> I'm quite certain that previously GetExtent method of Layer returned
> (Xmin,Ymin,Xmax,Ymax) and GetEnvelope of Geometry returned
> (Xmin,Xmax,Ymin,Ymax). Now they both return (Xmin,Xmax,Ymin,Ymax).
> 
> I've always noted the difference in the Perl bindings documentation and
> I have code that expects GetExtent to return (Xmin,Ymin,Xmax,Ymax).

AFAIK OGR_L_GetExtent() has always returned a OGREnvelope, so the order should 
have always been (Xmin,Xmax,Ymin,Ymax), unless something reordered it in the 
Perl bindings.

> 
> However, I don't find any change like this happening in the repository.
> Strange.
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Jun 30 03:22:47 2015
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 30 Jun 2015 13:22:47 +0300
Subject: [gdal-dev] Extent of a Layer
In-Reply-To: <201506301219.34548.even.rouault@spatialys.com>
References: <55926B1F.5080206@gmail.com>
	<201506301219.34548.even.rouault@spatialys.com>
Message-ID: <55926DF7.5040305@gmail.com>



On 30.06.2015 13:19, Even Rouault wrote:
> Le mardi 30 juin 2015 12:10:39, Ari Jolma a ?crit :
>> I wonder when the GetExtent method of a layer started to return an
>> Envelope - at least in the Perl bindings.
>>
>> I'm quite certain that previously GetExtent method of Layer returned
>> (Xmin,Ymin,Xmax,Ymax) and GetEnvelope of Geometry returned
>> (Xmin,Xmax,Ymin,Ymax). Now they both return (Xmin,Xmax,Ymin,Ymax).
>>
>> I've always noted the difference in the Perl bindings documentation and
>> I have code that expects GetExtent to return (Xmin,Ymin,Xmax,Ymax).
> AFAIK OGR_L_GetExtent() has always returned a OGREnvelope, so the order should
> have always been (Xmin,Xmax,Ymin,Ymax), unless something reordered it in the
> Perl bindings.

I don't see that happening. Hm. It's scary to see that kind of bug 
appearing for years and even asserted.

Ari

>
>> However, I don't find any change like this happening in the repository.
>> Strange.
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Tue Jun 30 03:21:52 2015
From: jluis at ualg.pt (Joaquim Luis)
Date: Tue, 30 Jun 2015 11:21:52 +0100
Subject: [gdal-dev] Getting warning when opening NetCDF file using gdal?
In-Reply-To: <1435632519375-5213484.post@n6.nabble.com>
References: <1435632519375-5213484.post@n6.nabble.com>
Message-ID: <op.x01geqmtdbaoe8@macmarilu>

Hi,

I've not yet found time to upgrade to new flavor of Ocean Color nc files  
but if you are using the old nc format you may find Mirone extremely  
useful for this kind of manipulations.
Have a look at this 2 short tutorials

https://sites.google.com/site/mironehowtos/satellite/import-a-modis-l2-sst-hdf-grid

http://w3.ualg.pt/~jluis/mirone/howtos/Make_a_stack_of_L2_MODIS_files.html

Joaquim

> I am using windows 7(32-bit) and want to warp NetCDF (nc) files and save  
> the
> output as GeoTIFF.
>
> First I run gdalinfo first to get the info of the subdataset I need and
> added NeTCDF in the beginning(e.g. gdalinfo
> NETCDF:"A2015069035500.L2_LAC_OC.nc") but was unfortunate because a  
> warning
> appeared:
>
> Warning 1: Variable has 0 dimension(s) - not supported.
> gdalinfo failed - unable to open 'netCDF:A2015069035500.L2_LAC_OC.nc'.
>
> Command line input:
>
> gdalinfo A2015069035500.L2_LAC_OC.nc
>
>
> NetCDF is present when I tried `gdalinfo --formats`.
>
> Does anyone have any idea about this?
>
>
>
> --
> View this message in context:  
> http://osgeo-org.1560.x6.nabble.com/Getting-warning-when-opening-NetCDF-file-using-gdal-tp5213484.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From goldfish_and_muskie at yahoo.com  Tue Jun 30 10:05:58 2015
From: goldfish_and_muskie at yahoo.com (Ruth Simm)
Date: Tue, 30 Jun 2015 17:05:58 +0000 (UTC)
Subject: [gdal-dev] gdaldem hillshade returns an empty .tif (i.e.
 everything is 181 (?))
In-Reply-To: <201506301141.51293.even.rouault@spatialys.com>
References: <201506301141.51293.even.rouault@spatialys.com>
Message-ID: <934035705.3014441.1435683958611.JavaMail.yahoo@mail.yahoo.com>

Hm. Well the prj is 3857 ...but I reprojected it from 4326....would -

I did run this on one tile - came out fine:
gdaldem hillshade DCM_N00E116.tif hillshade_test.tif -compute_edges -z 5 -s 111120 -az 90
but this returned the same result on the global file:

gdaldem hillshade -of GTiff infile_3857.tif hillshade.tif -compute_edges -z 5 -s 111120 -az 90


 


     On Tuesday, June 30, 2015 2:41 AM, Even Rouault <even.rouault at spatialys.com> wrote:
   

 #yiv0977550860 p, #yiv0977550860 li {white-space:pre-wrap;}Le mardi 30 juin 2015 01:20:13, Ruth Simm a ?crit :> I ran this command on a completely NORMAL (but large) global .tiff with a> few tiles missing - but nothing else suspicious - and after 40 minutes it> returned a dud file with '181' being the only value. Has this ever> happened to anyone before?> gdaldem hillshade -of GTiff infile.tif hillshd.tifRuth,I guess this might be an issue with the ratio of vertical units to horizontal.http://gdal.org/gdaldem.html#gdaldem_hillshade:-s scale:ratio of vertical units to horizontal. If the horizontal unit of the source DEM is degrees (e.g Lat/Long WGS84 projection), you can use scale=111120 if the vertical units are meters (or scale=370400 if they are in feet) I'd suggest you experiment a bit on a subwindow of your big raster or a subsampled version of it first.Even-- Spatialys - Geospatial professional serviceshttp://www.spatialys.com

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/62421b25/attachment.html>

From even.rouault at spatialys.com  Tue Jun 30 10:07:56 2015
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Jun 2015 19:07:56 +0200
Subject: [gdal-dev] gdaldem hillshade returns an empty .tif (i.e.
	everything is 181 (?))
In-Reply-To: <934035705.3014441.1435683958611.JavaMail.yahoo@mail.yahoo.com>
References: <201506301141.51293.even.rouault@spatialys.com>
	<934035705.3014441.1435683958611.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <201506301907.56794.even.rouault@spatialys.com>

Le mardi 30 juin 2015 19:05:58, Ruth Simm a ?crit :
> Hm. Well the prj is 3857 ...but I reprojected it from 4326....would -
> 
> I did run this on one tile - came out fine:
> gdaldem hillshade DCM_N00E116.tif hillshade_test.tif -compute_edges -z 5 -s
> 111120 -az 90 but this returned the same result on the global file:
> 
> gdaldem hillshade -of GTiff infile_3857.tif hillshade.tif -compute_edges -z
> 5 -s 111120 -az 90

For EPSG:3857, you shouldn't add  -s 111120 as the horizontal units are 
already meters.

> 
> 
> 
> 
> 
>      On Tuesday, June 30, 2015 2:41 AM, Even Rouault
> <even.rouault at spatialys.com> wrote:
> 
> 
>  #yiv0977550860 p, #yiv0977550860 li {white-space:pre-wrap;}Le mardi 30
> juin 2015 01:20:13, Ruth Simm a ?crit :> I ran this command on a
> completely NORMAL (but large) global .tiff with a> few tiles missing - but
> nothing else suspicious - and after 40 minutes it> returned a dud file
> with '181' being the only value. Has this ever> happened to anyone
> before?> gdaldem hillshade -of GTiff infile.tif hillshd.tifRuth,I guess
> this might be an issue with the ratio of vertical units to
> horizontal.http://gdal.org/gdaldem.html#gdaldem_hillshade:-s scale:ratio
> of vertical units to horizontal. If the horizontal unit of the source DEM
> is degrees (e.g Lat/Long WGS84 projection), you can use scale=111120 if
> the vertical units are meters (or scale=370400 if they are in feet) I'd
> suggest you experiment a bit on a subwindow of your big raster or a
> subsampled version of it first.Even-- Spatialys - Geospatial professional
> serviceshttp://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From goldfish_and_muskie at yahoo.com  Tue Jun 30 10:23:17 2015
From: goldfish_and_muskie at yahoo.com (Ruth Simm)
Date: Tue, 30 Jun 2015 17:23:17 +0000 (UTC)
Subject: [gdal-dev] gdaldem hillshade returns an empty .tif (i.e.
 everything is 181 (?))
In-Reply-To: <201506301907.56794.even.rouault@spatialys.com>
References: <201506301907.56794.even.rouault@spatialys.com>
Message-ID: <1584243302.3008070.1435684998016.JavaMail.yahoo@mail.yahoo.com>

Yup. That's why I thought...so back to square one....
Why do I get a dud file with:
gdaldem hillshade -of GTiff infile.tif hillshd.tif
 



     On Tuesday, June 30, 2015 10:07 AM, Even Rouault <even.rouault at spatialys.com> wrote:
   

 Le mardi 30 juin 2015 19:05:58, Ruth Simm a ?crit :
> Hm. Well the prj is 3857 ...but I reprojected it from 4326....would -
> 
> I did run this on one tile - came out fine:
> gdaldem hillshade DCM_N00E116.tif hillshade_test.tif -compute_edges -z 5 -s
> 111120 -az 90 but this returned the same result on the global file:
> 
> gdaldem hillshade -of GTiff infile_3857.tif hillshade.tif -compute_edges -z
> 5 -s 111120 -az 90

For EPSG:3857, you shouldn't add? -s 111120 as the horizontal units are 
already meters.

> 
> 
> 
> 
> 
>? ? ? On Tuesday, June 30, 2015 2:41 AM, Even Rouault
> <even.rouault at spatialys.com> wrote:
> 
> 
>? #yiv0977550860 p, #yiv0977550860 li {white-space:pre-wrap;}Le mardi 30
> juin 2015 01:20:13, Ruth Simm a ?crit :> I ran this command on a
> completely NORMAL (but large) global .tiff with a> few tiles missing - but
> nothing else suspicious - and after 40 minutes it> returned a dud file
> with '181' being the only value. Has this ever> happened to anyone
> before?> gdaldem hillshade -of GTiff infile.tif hillshd.tifRuth,I guess
> this might be an issue with the ratio of vertical units to
> horizontal.http://gdal.org/gdaldem.html#gdaldem_hillshade:-s scale:ratio
> of vertical units to horizontal. If the horizontal unit of the source DEM
> is degrees (e.g Lat/Long WGS84 projection), you can use scale=111120 if
> the vertical units are meters (or scale=370400 if they are in feet) I'd
> suggest you experiment a bit on a subwindow of your big raster or a
> subsampled version of it first.Even-- Spatialys - Geospatial professional
> serviceshttp://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20150630/733ba8a9/attachment-0001.html>

