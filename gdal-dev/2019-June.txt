From even.rouault at spatialys.com  Sat Jun  1 01:37:39 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 01 Jun 2019 10:37:39 +0200
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
	coordinates
In-Reply-To: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <4700751.o6v3ZJ9pq7@even-i700>

On vendredi 31 mai 2019 23:49:09 CEST Joaquim Manuel Freire Luís wrote:
> Hi,
> 
> GDAL master here
> 
> When I run gdalinfo on a remote nc file, instead of reporting the
> coordinates it prints the array size

Joaquim,

Note that in the /vsicurl/ case, the file gets opened by the HDF5Image driver 
whereas in the non vsicurl case, by the netCDF driver, hence the difference.
A recent enough version (4.5 I believe) of libnetcdf must be used so that /
vsicurl/ can be used by the netCDF driver (you must see 'NetCDF has 
netcdf_mem.h: yes' in configure output)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Sat Jun  1 11:35:15 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 1 Jun 2019 18:35:15 +0000
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <4700751.o6v3ZJ9pq7@even-i700>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
Message-ID: <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Thanks Even

Rebuilding my HDF+netCDF+GDAL stack, but now when issue the final

nmake /f makefile.vc devinstall

it errors after a while with (complains about doxygen). This didn't use to happen. I have a Win doxygen but it's not (never been) in the path.

make: Entering directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
mkdir -p build/xml && cd .. && ((cat Doxyfile | sed "s/PREDEFINED             = /PREDEFINED             = DOXYGEN_XML /"; printf "GENERATE_HTML=NO\nGENERATE_XML=YES\nXML_OUTPUT=doc/build/xml\nXML_PROGRAMLISTING=NO") | doxygen -)
/bin/sh: doxygen: command not found
make: *** [Makefile:22: .doxygen_up_to_date] Error 127
make: Leaving directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
NMAKE : fatal error U1077: 'C:\MinGW64\msys64\usr\bin\make.EXE' : return code '0x2'
Stop.


|>-----Original Message-----
|>From: Even Rouault <even.rouault at spatialys.com>
|>Sent: Saturday, June 1, 2019 9:38 AM
|>To: gdal-dev at lists.osgeo.org
|>Cc: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Subject: Re: [gdal-dev] vsicurl access to a netcdf file does not see the
|>coordinates
|>
|>On vendredi 31 mai 2019 23:49:09 CEST Joaquim Manuel Freire Luís wrote:
|>> Hi,
|>>
|>> GDAL master here
|>>
|>> When I run gdalinfo on a remote nc file, instead of reporting the
|>> coordinates it prints the array size
|>
|>Joaquim,
|>
|>Note that in the /vsicurl/ case, the file gets opened by the HDF5Image driver
|>whereas in the non vsicurl case, by the netCDF driver, hence the difference.
|>A recent enough version (4.5 I believe) of libnetcdf must be used so that /
|>vsicurl/ can be used by the netCDF driver (you must see 'NetCDF has
|>netcdf_mem.h: yes' in configure output)
|>
|>Even
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Sat Jun  1 14:42:56 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 01 Jun 2019 23:42:56 +0200
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
	coordinates
In-Reply-To: <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <2624711.q8xjjUmAtH@even-i700>

On samedi 1 juin 2019 18:35:15 CEST Joaquim Manuel Freire Luís wrote:
> Thanks Even
> 
> Rebuilding my HDF+netCDF+GDAL stack, but now when issue the final
> 
> nmake /f makefile.vc devinstall

Ah, there is no chance that /vsicurl/ with netcdf will work on Windows. It 
also requires the "user-fault file descriptor" Linux specific mechanism.

> 
> it errors after a while with (complains about doxygen). This didn't use to
> happen. I have a Win doxygen but it's not (never been) in the path.
> 
> make: Entering directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
> mkdir -p build/xml && cd .. && ((cat Doxyfile | sed "s/PREDEFINED           
>  = /PREDEFINED             = DOXYGEN_XML /"; printf
> "GENERATE_HTML=NO\nGENERATE_XML=YES\nXML_OUTPUT=doc/build/xml\nXML_PROGRAML
> ISTING=NO") | doxygen -) /bin/sh: doxygen: command not found
> make: *** [Makefile:22: .doxygen_up_to_date] Error 127
> make: Leaving directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
> NMAKE : fatal error U1077: 'C:\MinGW64\msys64\usr\bin\make.EXE' : return
> code '0x2' Stop.

I see Jürgen had to made changes in makefile.vc due to the documentation/
website refactoring, and now there is:

# build using cygwin
docs:
        make PYTHONHOME= -C doc html

install: default docs

Jürgen, we probably don't want to require cygwin for the install & devinstall 
targets. I would rather see doc building as an explicit separate target - that 
is not a dependency of install - and if it has been run explicitly before 
install, then we can install the docs, and otherwise just ignore them. What do 
you think ?

I've filed https://github.com/OSGeo/gdal/issues/1608 about that.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Sat Jun  1 15:05:33 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 1 Jun 2019 22:05:33 +0000
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <2624711.q8xjjUmAtH@even-i700>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
Message-ID: <DB8PR04MB6507CE512CC58A27A5F930F9A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>

|>> Rebuilding my HDF+netCDF+GDAL stack, but now when issue the final
|>>
|>> nmake /f makefile.vc devinstall
|>
|>Ah, there is no chance that /vsicurl/ with netcdf will work on Windows. It also
|>requires the "user-fault file descriptor" Linux specific mechanism.

Ah, I had the impression that recent improvements on this had made it possible to use on Windows as well.

Regarding the docs build. Yes, it absolutely must be decoupled  to a different target. I happen to have Mingw also available from within the command shell env that use to build with VS, and after all the updates that it obliged me to do my Python environment, I finally managed to do the devinstall. But not without a little patch. At the end it still errored complaining that ../latex/gdal.pdf  did not exists (and it was right). I worked around it by commenting that line in the Makefile

Still other issues. 

1- I build both 32 & 64 bit versions but now the nmake clean does not remove all the .obj files, so after building for 64 bits, the 32 bits fails due to x86 vs x64 conflicts.

2- This proj (but you also ware that hat). Proj 6 creates include libs that have the version number (e.g. proj_6_0.lib, proj_6_1.lib, ...). That is not very nice. I declare in my nmake.local

PROJ_LIBRARY = C:\programs\compa_libs\proj5_GIT\compileds\$(LIB_CC)\lib\proj_6_0.lib

And I still had that lib in place so it linked fine to GDAL, but on runtime I started having missing symbols errors (in this case proj_coordoperation_get_method_info) that took me a while to fire out that the problem as that lib name must be updated to

PROJ_LIBRARY = C:\programs\compa_libs\proj5_GIT\compileds\$(LIB_CC)\lib\proj_6_1.lib

GDAL uses only the version independent "gdal_i.lib". Why isn't proj doing the same thing? As is, it's very easy to fall in this trap.


(Hmm, damn it, finished rebuilding GDAL and still have that proj_coordoperation_get_method_info missing error)

|>> it errors after a while with (complains about doxygen). This didn't
|>> use to happen. I have a Win doxygen but it's not (never been) in the path.
|>>
|>> make: Entering directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
|>> mkdir -p build/xml && cd .. && ((cat Doxyfile | sed "s/PREDEFINED
|>>  = /PREDEFINED             = DOXYGEN_XML /"; printf
|>>
|>"GENERATE_HTML=NO\nGENERATE_XML=YES\nXML_OUTPUT=doc/build/xml\
|>nXML_PRO
|>> GRAML
|>> ISTING=NO") | doxygen -) /bin/sh: doxygen: command not found
|>> make: *** [Makefile:22: .doxygen_up_to_date] Error 127
|>> make: Leaving directory '/c/programs/compa_libs/gdal_GIT/gdal/doc'
|>> NMAKE : fatal error U1077: 'C:\MinGW64\msys64\usr\bin\make.EXE' :
|>> return code '0x2' Stop.
|>
|>I see Jürgen had to made changes in makefile.vc due to the documentation/
|>website refactoring, and now there is:
|>
|># build using cygwin
|>docs:
|>        make PYTHONHOME= -C doc html
|>
|>install: default docs
|>
|>Jürgen, we probably don't want to require cygwin for the install & devinstall
|>targets. I would rather see doc building as an explicit separate target - that is
|>not a dependency of install - and if it has been run explicitly before install, then
|>we can install the docs, and otherwise just ignore them. What do you think ?
|>
|>I've filed https://github.com/OSGeo/gdal/issues/1608 about that.
|>
|>Even
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From jluis at ualg.pt  Sat Jun  1 15:52:13 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 1 Jun 2019 22:52:13 +0000
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <2624711.q8xjjUmAtH@even-i700>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
Message-ID: <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>

|>Ah, there is no chance that /vsicurl/ with netcdf will work on Windows. It also
|>requires the "user-fault file descriptor" Linux specific mechanism.

It actually almost works. This command should be equal to just download the file

grdconvert /vsicurl/http://w3.ualg.pt/~jluis/ftp/tmp/idades_v2012.grd -Glixo.grd

and I get the file. Only the coordinates are wrong but for the rest, the grid is fine.

Is there a way to force reading the grid locally with the HDF5 driver instead of the automatically picked netCDF driver?

From jmckenna at gatewaygeomatics.com  Sun Jun  2 06:16:53 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sun, 2 Jun 2019 09:16:53 -0400
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
 <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <815e620a-ebbd-4208-a1c6-d86f3fdde2e8@gatewaygeomatics.com>

On 2019-06-01 6:52 PM, Joaquim Manuel Freire Luís wrote:
> |>Ah, there is no chance that /vsicurl/ with netcdf will work on Windows. It also
> |>requires the "user-fault file descriptor" Linux specific mechanism.
> 
> It actually almost works. This command should be equal to just download the file
> 
> grdconvert /vsicurl/http://w3.ualg.pt/~jluis/ftp/tmp/idades_v2012.grd -Glixo.grd
> 
> and I get the file. Only the coordinates are wrong but for the rest, the grid is fine.
> 
> Is there a way to force reading the grid locally with the HDF5 driver instead of the automatically picked netCDF driver?
> _______________________________________________

I come across this need often also, as many MS4W users leverage GDAL 
through netCDF, HDF5, HDF4, but I'm not aware of a GDAL commandline 
option to 'skip' raster drivers (OGR has "OGR_SKIP").  I could be wrong 
though.  I have seen other users request this 
(https://trac.osgeo.org/gdal/ticket/5917) which seems to say that there 
is a way through the GDAL API, but, I'm just not sure about the commandline.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/





From andrew at aitchison.me.uk  Sun Jun  2 06:35:06 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 2 Jun 2019 14:35:06 +0100 (BST)
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <815e620a-ebbd-4208-a1c6-d86f3fdde2e8@gatewaygeomatics.com>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
 <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <815e620a-ebbd-4208-a1c6-d86f3fdde2e8@gatewaygeomatics.com>
Message-ID: <alpine.DEB.2.21.1906021427150.13045@warden.aitchison.me.uk>

On Sun, 2 Jun 2019, Jeff McKenna wrote:

> On 2019-06-01 6:52 PM, Joaquim Manuel Freire Lu?s wrote:
>> Is there a way to force reading the grid locally with the HDF5 driver 
>> instead of the automatically picked netCDF driver?
>> _______________________________________________
>
> I come across this need often also, as many MS4W users leverage GDAL through 
> netCDF, HDF5, HDF4, but I'm not aware of a GDAL commandline option to 'skip' 
> raster drivers (OGR has "OGR_SKIP").  I could be wrong though.  I have seen 
> other users request this (https://trac.osgeo.org/gdal/ticket/5917) which 
> seems to say that there is a way through the GDAL API, but, I'm just not sure 
> about the commandline.

Rather like OGR_SKIP, the GDAL_SKIP environment variable skips raster 
drivers (tested with gdal 1.11 and 3.0.)

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From jluis at ualg.pt  Sun Jun  2 09:26:13 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Sun, 2 Jun 2019 16:26:13 +0000
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <alpine.DEB.2.21.1906021427150.13045@warden.aitchison.me.uk>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
 <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <815e620a-ebbd-4208-a1c6-d86f3fdde2e8@gatewaygeomatics.com>
 <alpine.DEB.2.21.1906021427150.13045@warden.aitchison.me.uk>
Message-ID: <DB8PR04MB65079FEFB45A9E7C3DD1A253A61B0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Thanks Andrew,

So, I can now force the reading with the HDF5 driver on local file and it also doesn't read the coordinates.
Is this a bug in HDF5 driver?

gdalinfo --config GDAL_SKIP netCDF idades_v2012.grd
Driver: HDF5Image/HDF5 Dataset
Files: none associated
Size is 2029, 1168
Metadata:
  Conventions=COARDS
  description=File written from Matlab
  node_offset=0
  Source_Software=Mirone
  title=Grid computed inside Mirone
  _nc3_strict=1
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1168.0)
Upper Right ( 2029.0,    0.0)
Lower Right ( 2029.0, 1168.0)
Center      ( 1014.5,  584.0)
Band 1 Block=1015x584 Type=Float32, ColorInterp=Undefined
  NoData Value=nan
  Metadata:
    z_actual_range=-0.0558451935648918 181.299896240234
    z_long_name=z
    z_units=unknown
    z__FillValue=-nan(ind)

|>-----Original Message-----
|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Andrew C
|>Aitchison
|>Sent: Sunday, June 2, 2019 2:35 PM
|>To: Jeff McKenna <jmckenna at gatewaygeomatics.com>
|>Cc: gdal-dev at lists.osgeo.org
|>Subject: Re: [gdal-dev] vsicurl access to a netcdf file does not see the
|>coordinates
|>
|>On Sun, 2 Jun 2019, Jeff McKenna wrote:
|>
|>> On 2019-06-01 6:52 PM, Joaquim Manuel Freire Lu?s wrote:
|>>> Is there a way to force reading the grid locally with the HDF5 driver
|>>> instead of the automatically picked netCDF driver?
|>>> _______________________________________________
|>>
|>> I come across this need often also, as many MS4W users leverage GDAL
|>> through netCDF, HDF5, HDF4, but I'm not aware of a GDAL commandline
|>option to 'skip'
|>> raster drivers (OGR has "OGR_SKIP").  I could be wrong though.  I have
|>> seen other users request this
|>> (https://trac.osgeo.org/gdal/ticket/5917) which seems to say that
|>> there is a way through the GDAL API, but, I'm just not sure about the
|>commandline.
|>
|>Rather like OGR_SKIP, the GDAL_SKIP environment variable skips raster drivers
|>(tested with gdal 1.11 and 3.0.)
|>
|>--
|>Andrew C. Aitchison					Cambridge, UK
|> 			andrew at aitchison.me.uk
|>_______________________________________________
|>gdal-dev mailing list
|>gdal-dev at lists.osgeo.org
|>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jmckenna at gatewaygeomatics.com  Sun Jun  2 13:00:11 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sun, 2 Jun 2019 16:00:11 -0400
Subject: [gdal-dev] vsicurl access to a netcdf file does not see the
 coordinates
In-Reply-To: <alpine.DEB.2.21.1906021427150.13045@warden.aitchison.me.uk>
References: <DB8PR04MB650719CF6CEAA51CA7660010A6190@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4700751.o6v3ZJ9pq7@even-i700>
 <DB8PR04MB65074462B516A2D93CB12754A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2624711.q8xjjUmAtH@even-i700>
 <DB8PR04MB6507AB894020526C6FBC8F32A61A0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <815e620a-ebbd-4208-a1c6-d86f3fdde2e8@gatewaygeomatics.com>
 <alpine.DEB.2.21.1906021427150.13045@warden.aitchison.me.uk>
Message-ID: <3d35f402-6534-dee1-c806-a82cb9d5f0f9@gatewaygeomatics.com>

On 2019-06-02 9:35 AM, Andrew C Aitchison wrote:
> On Sun, 2 Jun 2019, Jeff McKenna wrote:
> 
>> On 2019-06-01 6:52 PM, Joaquim Manuel Freire Lu?s wrote:
>>> Is there a way to force reading the grid locally with the HDF5 driver 
>>> instead of the automatically picked netCDF driver?
>>> _______________________________________________
>>
>> I come across this need often also, as many MS4W users leverage GDAL 
>> through netCDF, HDF5, HDF4, but I'm not aware of a GDAL commandline 
>> option to 'skip' raster drivers (OGR has "OGR_SKIP").  I could be 
>> wrong though.  I have seen other users request this 
>> (https://trac.osgeo.org/gdal/ticket/5917) which seems to say that 
>> there is a way through the GDAL API, but, I'm just not sure about the 
>> commandline.
> 
> Rather like OGR_SKIP, the GDAL_SKIP environment variable skips raster 
> drivers (tested with gdal 1.11 and 3.0.)
> 

ah yes, you're right, of course it exists. Thanks. 
https://trac.osgeo.org/gdal/wiki/ConfigOptions#GDAL_SKIP

-jeff



From thomas.bonfort at gmail.com  Mon Jun  3 03:48:34 2019
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Mon, 3 Jun 2019 12:48:34 +0200
Subject: [gdal-dev] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <5574227.TDbNqEBEyc@even-i700>
References: <42081947.AsHn9XMMPI@even-i700> <5574227.TDbNqEBEyc@even-i700>
Message-ID: <CAOM3y2i2d=_PQFHNDDpnfRcGj5FTf3-KZ_ADTXfcvqEXbN7idg@mail.gmail.com>

Hi Even,
Thanks for the extensive research you have put into this.
As a very general remark, this proposal seems to focus on minimizing the
bandwidth from the cog storage to the consumer, whereas I'd argue that
there are a broad range of usages where the consumer is in the same cloud
region as the storage and in that case the transferred bandwidth becomes
much less of an issue compared to the number of GET requests sent to the
underlying file. That said your proposal does not impede on this remark, I
just wanted to point out that in that case I believe a more efficient setup
would be to use a larger curl blocksize to include all strile
offsets/lengths in a single request.
A few other remarks inline...

On Wed, May 29, 2019 at 3:49 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've submitted a PR per https://github.com/OSGeo/gdal/pull/1600 which
> implements the low-level work of below points 4) and 5). To get all
> benefits,
> this requires GDAL to be built against internal libtiff or libtiff master
> after https://gitlab.com/libtiff/libtiff/merge_requests/81 and https://
> gitlab.com/libtiff/libtiff/merge_requests/82 have been merged. Starting
> with
> libtiff 4.0.11 in which this changes will appear, there won't be any
> specific
> behaviour of building against internal libtiff (currently this is required
> to
> avoid loading the whole tile indexes)
>
> As I anticipated, reading a single tile from a COG, generated and read
> with
> this PR, now requires just 3 GET range requests: one to get the header and
> IFDs (without the tile array indices), one to get the offset of the tile
> and
> its successor, and one to get the tile data. That for images with or
> without
> transparency mask.
>
> To describe the specific layout of those COG files, I've decided to
> include a
> description of the features used at the beginning of the file, so that
> optimized readers (like GDAL) can use them and take shortcuts. I've
> decided to
> include them as ASCII strings "hidden" just after the 8 first bytes of a
> ClassicTIFF (or after the 16 first ons for a BigTIFF). That is the first
> IFD
> starts just after those strings. This is completely valid to have 'ghost'
> areas like this in a TIFF file, and readers will normally skip over them.
> So
> for a COG file with a transparency mask, those strings will be:
> GDAL_STRUCTURAL_METADATA_SIZE=000177 bytes\n
> LAYOUT=IFDS_BEFORE_DATA\n
> STRILE_ORDER=ROW_MAJOR\n
> STRILE_LEADER=SIZE_AS_UINT4\n
> STRILE_TRAILER=LAST_4_BYTES_REPEATED\n
> KNOWN_INCOMPATIBLE_EDITION=NO\n
> MASK_INTERLEAVED_WITH_IMAGERY=YES\n
>
> For a COG without mask, the last item will not be present of course.
>
> So it starts with GDAL_STRUCTURAL_METADATA_SIZE=XXXXXX bytes\n where
> XXXXXX
> describes the size of this whole section (starting at the beginning of
> GDAL_STRUCTURAL_METADATA_SIZE).
>
> - LAYOUT=IFDS_BEFORE_DATA: the IFDs are located at the beginning of the
> file.
> GDAL with this PR will also makes sure that the tile index arrays are
> written
> just after the IFDs and before the imagery, so that a first range request
> of
> 16 KB will always get all the IFDs
>
> - STRILE_ORDER=ROW_MAJOR: (strile is a contraction of 'strip or tile') the
> data for tiles is written in increasing tile id order. Future enhancements
> could possibly implement other layouts, like Z_ORDER or HILBERT_CURVE
>

> - STRILE_LEADER=SIZE_AS_UINT4: each tile data is preceded by 4 bytes, in a
> 'ghost' area as well, indicating the real tile size (in little endian
> order).
> TileOffset[i] points to the real tile data, that is, just after those 4
> bytes.
> An optimized reader seeing this metadata item will thus look for
> TileOffset[i]
> and TileOffset[i+1] to deduce it must fetch the data starting at
> offset=TileOffset[i] - 4 and of size=TileOffset[i+1]-TileOffset[i]+4. It
> then
> checks the 4 first bytes to see if the size in this leader marker is
> consistent with TileOffset[i+1]-TileOffset[i]. When there is no mask, they
> should normally be equal (modulo the size taken by STRILE_LEADER and
> STRILE_TRAILER). In the case where there is a mask and
> MASK_INTERLEAVED_WITH_IMAGERY=YES, then the tile size indicated in the
> leader
> will be < TileOffset[i+1]-TileOffset[i] since the data for the mask will
> follow the imagery data (see MASK_INTERLEAVED_WITH_IMAGERY=YES)
>
> - STRILE_TRAILER=LAST_4_BYTES_REPEATED: just after the tile data, the last
> 4
> bytes of the tile data are repeated. This is a way if optimized readers to
> check that TIFF writers not aware of those optimizations have modified the
> TIFF file in a way that breaks the optimizations. If an optimized reader
> detects an inconsistency, it then fallback to the regular/slow method if
> using
> TileOffset[i] + TileByteCount[i]. I've hesitated about using something
> like a
> CRC32, but checking for the last 4 bytes is probably sufficient with
> compression schemes to detect if STRILE_LEADER is valid.
>
> - KNOWN_INCOMPATIBLE_EDITION=NO: when a COG is generated this is always
> written. If GDAL is then used to modify the COG file, as most of the
> changes
> done on an existing COG file, will break the optimized structure, GDAL
> will
> change this metadata item to KNOWN_INCOMPATIBLE_EDITION=YES, and issue a
> warning on writing, and when reopening such file, so that users know they
> have
> 'broken' their COG file
>

Could this one be renamed to COG_VERSION or COG_FLAVOR, which would allow
you to have the spec for this metadata evolve over time (e.g. STRILE_ORDER
could be left out for now as it only has a single valid value) and still be
set to COG_VERSION=INCOMPATIBLE if needed. COG_VERSION should probably
become the first member of the metadata string.


>
> - MASK_INTERLEAVED_WITH_IMAGERY=YES: signals that mask data immediately
> follows imagery data. So when reading data at offset=TileOffset[i] - 4 and
> size=TileOffset[i+1]-TileOffset[i]+4, you'll get a buffer with:
>         * leader with imagery tile size (4 bytes)
>    * imagery data (starting at TileOffset[i] and of size TileByteCount[i])
>    * trailer of imagery (4 bytes)
>    * leader with mask tilesize (4 bytes)
>    * mask data (starting at mask.TileOffset[i] and of size
> mask.TileByteCount[i], but none of them actually need to be read)
>    * trailer of mask data (4 bytes)
>
> One point I hesitated about was how to write those structural metadata.
> Other
> possibilities would have been to include them in the GDAL_METADATA TIFF
> tag
> which contains user visible metadata serialized as XML. But I prefered
> those
> structural details to remain mostly hidden. There are really low level
> details
> not describing the image content. A possibility based on GDAL_METADATA
> would
> have been to use a dedicated metadata domain to hold them, but a utility
> that
> would for example copy TIFF to TIFF could propagate the content of this
> tag
> while not including the needed leader & trailer that would be unknown of
> it.
> One could also have introduced a new (or several) TIFF tag(s) to describe
> them, but that would have require to register them and caused warnings to
> be
> emitted when reading them with older GDAL versions. The only drawback I
> can
> think of about the solution I implemented is that if using only libtiff
> API
> those structural metadata cannot be discovered. Let me know if you believe
> that this could cause issues and what other solution would be preferred.
>
> One other thought I had is that we could actually potentially save the
> reading
> of TileOffset[i] and TileOffset[i+1]. For uncompressed data, this would be
> trivial since only TileOffset[0] is needed to deduce the location of other
> tiles when STRILE_ORDER=ROW_MAJOR. But uncompressed data for COG must not
> be a
> very common use case. For compressed data, we could imagine to take the
> maximum compressed size of a tile, which would be written as a new
> metadata
> item, and adding padding to smaller tiles to get to that size. So that
> would
> require doing a first pass to compute that maximum tile size, and then the
> real one to write the file, so basically a x2 slowdown on generation. For
> JPEG
> compression, one could imagine to avoid most of that initial pass, by
> exmining
> just a few random samples in the source raster to compute the mean
> compressed
> tile size and its standard deviation, and use that to determine a maximum
> compressed tile. It could happen that some tiles would still be larger, in
> which case the writer would need to remove the higher frequencies of the
> tile
> data until the compressed data fits in the maximum allowed size. Another
> drawback is also potential significant lost space in the file if there a
> lot
> of variations in the compression rate among tiles. The criticity of this
> depends on how the file size vs the number of requests is seen as
> important
> (depends on cloud storage fees and use patterns).
>
I see wasted storage space as important :)
Another optimization going down a similar road would be to store the
uint8/uint (depending on bigtiff or not) offset of the first strile in the
IFD description, and then just having to read the short/uint TileByteCounts
knowing that each strile is stored consecutively to its predecessor.

--
Thomas

And we could also potentially save the reading of the header (IFD
> description)
> of the file is the calling code could provide it to the GTiff reader
> (cases
> where it would always read the same COG and so could hardcode its header)
> Anyway, those ideas are perhaps unneeded overcomplications and are not
> part of
> my current scheduled tasks, but I wanted to share them in case that seems
> of
> interest to anyone.
>
> Even
>
> >
> > 4) Optimizations specific to JPEG-compressed imagery (YCbCr color space)
> > with a 1-bit transparency channel, to minimize the number of HTTP range
> > requests needed to read them.
> > As JPEG compression cannot include the transparency information, two TIFF
> > IFD have to be created: one for YCbCr, and another one for alpha.
> Currently
> > the COPY_SRC_OVERVIEWS=YES creation option of the GeoTIFF driver
> separates
> > data for all the tiles of the color channels from data for all the tiles
> of
> > the transparency channel. In practice, readers will generally want to
> > access, for a same location, to data of both color and transparency
> > channels. I will modify the writer to interleave blocks so that color and
> > transparency information are contiguous. If COLOR_X_Y designates the tile
> > with color information at coordinates X,Y (in tile coordinate space), the
> > layout of data in the file will be: COLOR_0_0, TRANSPARENCY_0_0,
> COLOR_1_0,
> > TRANSPARENCY_1_0, etc. The GeoTIFF driver will be improved to fetch
> > together the color and transparency channel when such a layout is
> detected.
> >
> > A further improvement is to be able to avoid completely to read the
> > TileByteCount array of the color channel, and the TileByteCount &
> TileOffset
> > arrays of the transparency channel. The trick is to reserve 4 bytes
> before
> > the start of each COLOR_X_Y tile to indicate its size (those bytes will
> be
> > 'ghost', that is not in the range of data pointed by
> > TileByCount&TileOffset). An optimized reader wanting to read tile
> > i=Y*nb_tiles_in_width+X will start by reading the offsets of tile i and
> > i+1: TileOffset_color[i] and
> > TileOffset_color[i+1]. It will then seek to TileOffset_color[i] – 4 and
> read
> > 4 + TileOffset_color[i+1] – TileOffset_color[i] bytes in a buffer. The
> > first 4 bytes of this buffer will indicate the number of bytes of the
> color
> > tile, and thus it is possible to deduce the offset and size of the mask
> > tile that is located at the end of the buffer. A TIFF metadata item will
> be
> > written to indicate that such layout has been used (with an indication of
> > the file size so as to be able to detect if the file has been later be
> > altered in a non- optimized way), so that optimized readers can adopt the
> > above described behavior. This will require to extend the libtiff
> interface
> > so that the user can directly provide the input buffer to decompress.
> > As the file will remain fully TIFF/BIGTIFF compliant, non-optimized
> readers
> > (such as newer GDAL builds against an older external libtiff version, or
> > previous GDAL versions) will still be able read it, loading values from
> the
> > 4 arrays instead of just one.
> > Note: for other compressions types, a simpler version of the above
> > optimization can still be done, by using TileOffset[i] and
> TileOffset[i+1],
> > and saving the read of TileByteCount[i]
> > To sum up, with the improvements of this task, once the initial loading
> of
> > metadata has been done, a GDAL ReadBlock(x,y) request will cause only two
> > networks range requests: one to read TileOffset[i] and TileOffset[i+1]
> > (potentially already cached if neighboring tiles have been previously
> > accessed in the same process), and another one to read the imagery
> (+mask)
> > data. Whereas currently, 6 might be needed for JPEG YcbCr+mask.
> >
> > 5) Optimizing the layout of the header of a COG file
> >
> > The current layout of the header part of COG file is:
> > - TIFF / BigTIFF signature, followed by the offset of the first IFD
> (Image
> > File Directory)
> > - IFD of full resolution image, that is the list of the tags and their
> value
> > when it consists of a single numeric value, followed by the offset of the
> > next - IFD. Its size is 2 + number_of_tags * 12 + 4 (or 2 +
> number_of_tags
> > * 20 + 8) bytes, so typically 200 bytes maximum
> > - Values of TIFF tags that don't fit inline in the IFD directory, such as
> > TileOffsets and TileByteCounts arrays and GeoTIFF keys
> > - IFD of first overview (typically subsampled by a factor of 2)
> > - Values of its tags that don't fit inline
> > - ...
> > -IFD of last overview
> > - Values of its tags that don't fit inline
> >
> > When the COG file is not too large, the fact of having the TileOffsets
> and
> > TileByteCounts between IFD descriptors is not an issue since they are not
> > too large, and most TIFF readers will load their values when opening the
> > IFD. But for an optimized reader such as GDAL with internal libtiff
> support
> > (or with external libtiff after the optimization of task 4), loading the
> > values of the TileOffsets/TileByteCounts arrays is only needed when
> > accessing imagery.
> >
> > A more efficient layout for network access is :
> > - TIFF / BigTIFF signature, followed by the offset of the first IFD
> > - IFD of full resolution image, followed by the value of its non-inline
> > tags, except  TileOffsets/TileByteCounts
> > - IFD of first overview followed by the value of its non-inline tags,
> except
> > - TileOffsets/TileByteCounts
> > - IFD of last overview followed by the value of its non-inline tags,
> except
> > TileOffsets/TileByteCounts
> > - Values of the TileOffsets/TileByteCounts arrays of IFD of full
> resolution
> > image
> > - Values of the TileOffsets/TileByteCounts arrays of IFD of first
> overview
> > - ...
> > - Values of the TileOffsets/TileByteCounts arrays of IFD of last overview
> >
> > With such a structure, the initial reading of 16 KB at the start of the
> file
> > will be able to load the IFD descriptors of all overviews (and masks,
> which
> > are actually interleaved in between when present). So, combined together
> > with task 4, a cold read of a tile at any zoom level (ie opening the
> file +
> > tile request) could result in just 3 network range requests: one to get
> the
> > IFD descriptors at the start of the file, one to read the location of the
> > tile from the TileOffsets array and one to read the tile data.
> > The proposed structure itself is still fully TIFF compliant. The script
> that
> > validates the COG structure will be adapted to accept that new variant of
> > the header structure.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190603/beb1b742/attachment-0001.html>

From even.rouault at spatialys.com  Mon Jun  3 04:21:06 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 03 Jun 2019 13:21:06 +0200
Subject: [gdal-dev] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <CAOM3y2i2d=_PQFHNDDpnfRcGj5FTf3-KZ_ADTXfcvqEXbN7idg@mail.gmail.com>
References: <42081947.AsHn9XMMPI@even-i700> <5574227.TDbNqEBEyc@even-i700>
 <CAOM3y2i2d=_PQFHNDDpnfRcGj5FTf3-KZ_ADTXfcvqEXbN7idg@mail.gmail.com>
Message-ID: <6529188.rc2RpCrxfF@even-i700>

Hi Thomas,

> As a very general remark, this proposal seems to focus on minimizing the
> bandwidth from the cog storage to the consumer, whereas I'd argue that
> there are a broad range of usages where the consumer is in the same cloud
> region as the storage and in that case the transferred bandwidth becomes
> much less of an issue compared to the number of GET requests sent to the
> underlying file. That said your proposal does not impede on this remark, I
> just wanted to point out that in that case I believe a more efficient setup
> would be to use a larger curl blocksize to include all strile
> offsets/lengths in a single request.

Minimizing the number of GET requests is certainly one of the main objectives 
of this work. Regarding getting all strile offsets/lengths in a single 
request, due to the /vsicurl/ caching, you'll get consecutive strile offsets 
in one request. But as offset and length arrays are separated, for very large 
COGs, you would have needed 2 requests, hence the optimizations to avoid 
reading the length array.

> Could this one be renamed to COG_VERSION or COG_FLAVOR, which would allow
> you to have the spec for this metadata evolve over time (e.g. STRILE_ORDER
> could be left out for now as it only has a single valid value) and still be
> set to COG_VERSION=INCOMPATIBLE if needed. COG_VERSION should probably
> become the first member of the metadata string.

I considered that, but I prefered to have orthogonal optimizations. Regarding 
BLOCK_ORDER, if in the future we allow other values, I can imagine there could 
still be cases where you could prefer BLOCK_ORDER=ROW_MAJOR, so defining a 
version number doesn't seem obvious to me.

> I see wasted storage space as important :)

Sure

> Another optimization going down a similar road would be to store the
> uint8/uint (depending on bigtiff or not) offset of the first strile in the
> IFD description, and then just having to read the short/uint TileByteCounts
> knowing that each strile is stored consecutively to its predecessor.

But that implies that you need to load the bytecounts of all predecessors. If 
you want fast random access to a huge COG, that wouldn't work.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jun  3 23:15:54 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 4 Jun 2019 06:15:54 +0000
Subject: [gdal-dev] GMLAS tries to read spatialreference.org through http
Message-ID: <614a0b1766804b70b313691f51d65c58@C119S212VM042.msvyvi.vaha.local>

Hi,

I am getting lots of warning like this from the GMLAS driver:

HTTP: Fetch(http://spatialreference.org/ref/epsg/28992/)
HTTP: These HTTP headers were set: Accept: application/x-ogcwkt
ERROR 1: Connection timed out after 10563 milliseconds
Warning 1: Reprojection fom http://spatialreference.org/ref/epsg/28992/ to urn:x-ogc:def:crs:EPSG:28992 failed

I guess that the code should be changed to try https instead. The typo "fom" comes also from the driver.


-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190604/cff7ecaf/attachment.html>

From even.rouault at spatialys.com  Tue Jun  4 01:02:54 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 04 Jun 2019 10:02:54 +0200
Subject: [gdal-dev] GMLAS tries to read spatialreference.org through http
In-Reply-To: <614a0b1766804b70b313691f51d65c58@C119S212VM042.msvyvi.vaha.local>
References: <614a0b1766804b70b313691f51d65c58@C119S212VM042.msvyvi.vaha.local>
Message-ID: <7328591.zzfC9ploTH@even-i700>

On mardi 4 juin 2019 06:15:54 CEST Rahkonen Jukka (MML) wrote:
> I am getting lots of warning like this from the GMLAS driver:

> HTTP: Fetch(http://spatialreference.org/ref/epsg/28992/)
> HTTP: These HTTP headers were set: Accept: application/x-ogcwkt
> ERROR 1: Connection timed out after 10563 milliseconds
> Warning 1: Reprojection fom http://spatialreference.org/ref/epsg/28992/ to > 
> urn:x-ogc:def:crs:EPSG:28992 failed

> I guess that the code should be changed to try https instead.

Doesn't look like it is needed. The following works:

gdalsrsinfo http://spatialreference.org/ref/epsg/28992/

and does the redirection to https

Maybe you hit a temporary issue with the server ?

> The typo "fom" comes also from the driver.

Fixed

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From davorinbajic at gmail.com  Tue Jun  4 02:51:51 2019
From: davorinbajic at gmail.com (davorinbajic)
Date: Tue, 4 Jun 2019 02:51:51 -0700 (MST)
Subject: [gdal-dev] gdal_grid does not work in cron but works in terminal
Message-ID: <1559641911357-0.post@n6.nabble.com>


I use the gdal_grid interpolation command. When I work in the terminal
everything works perfectly. However, when I try to run the command in the
bash script from cron then it does not work.

Bash script (/root/interpolation/interpolation.sh):

#!/bin/bash

gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
/root/interpolation/today.vrt /root/interpolation/out/today.tif

I also tried the path to gdal_grid

#!/bin/bash

/usr/bin/gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
/root/interpolation/today.vrt /root/interpolation/out/today.tif

Virtual file (/root/interpolation/today.vrt)

<OGRVRTDataSource>
<OGRVRTLayer name="today">
    <SrcDataSource>/root/interpolation/today.csv</SrcDataSource>
    <GeometryType>wkbPoint</GeometryType>
<LayerSRS>WGS84</LayerSRS>
    <GeometryField encoding="PointFromColumns" x="X" y="Y" z="eto"/>
</OGRVRTLayer>

CSV (/root/interpolation/today.csv)

id,X,Y,eto
1,17.11400986,43.59461212,5.284
2,16.01515388,44.38002777,5.636
3,19.3653698,44.19543839,6.823
4,17.25690269,44.1989975,6.041
5,18.53639221,43.60323715,6.452
6,16.9213295,45.12902069,6.95
...

CRON

PATH='/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin'

39 10 * * * /root/interpolation/interpolation.sh 

Error

Usage: gdal_grid [--help-general] [--formats]
[-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
      CInt16/CInt32/CFloat32/CFloat64}]
[-of format] [-co "NAME=VALUE"]
[-zfield field_name]
[-a_srs srs_def] [-spat xmin ymin xmax ymax]
[-clipsrc <xmin ymin xmax ymax>|WKT|datasource|spat_extent]
[-clipsrcsql sql_statement] [-clipsrclayer layer]
[-clipsrcwhere expression]
[-l layername]* [-where expression] [-sql select_statement]
[-txe xmin xmax] [-tye ymin ymax] [-outsize xsize ysize]
[-a algorithm[:parameter1=value1]*]    [-q]
<src_datasource> <dst_filename>

Available algorithms and parameters with their's defaults:
Inverse distance to a power (default)
   
invdist:power=2.0:smoothing=0.0:radius1=0.0:radius2=0.0:angle=0.0:max_points=0:min_points=0:nodata=0.0
Moving average
    average:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
Nearest neighbor
    nearest:radius1=0.0:radius2=0.0:angle=0.0:nodata=0.0
Various data metrics
    <metric name>:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
    possible metrics are:
        minimum
        maximum
        range
        count
        average_distance
        average_distance_pts

FAILURE: Neither -sql nor -l are specified

Note that it works in the terminal but it does not work in cron. Does anyone
know what the problem is?




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun  4 04:44:11 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 4 Jun 2019 11:44:11 +0000
Subject: [gdal-dev] GMLAS tries to read spatialreference.org through http
Message-ID: <4ed570e7854b4ddd9d4b115e0f5b57fe@C119S212VM042.msvyvi.vaha.local>

Hi,

The reason for my problem was that I had set only env variable http_proxy. Request to http://spatialreference.org returns http 301 Moved Permanently and forwards into https://spatialreference.org/ref/epsg/28992/ . For accessing the https address I have to set also https_proxy. A better alternative is to set GDAL_HTTP_PROXY instead. Behavior of the different proxy settings is best defined in the GitHub issue https://github.com/OSGeo/gdal/issues/878

But now I don't understand why these two gdalsrsinfo request give different results if both http and https are pointing to the same resource:

gdalsrsinfo http://spatialreference.org/ref/epsg/28992/

PROJ.4 : +proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs

OGC WKT2:2018 :
PROJCRS["Amersfoort / RD New",
    BASEGEOGCRS["Amersfoort",
        DATUM["Amersfoort",
            ELLIPSOID["Bessel 1841",6377397.155,299.1528128,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Oblique Stereographic",
            ID["EPSG",9809]],
        PARAMETER["Latitude of natural origin",52.1561605555556,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",5.38763888888889,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9999079,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",155000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",463000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["x",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["y",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    ID["EPSG",28992]]


gdalsrsinfo https://spatialreference.org/ref/epsg/28992/

PROJ.4 : +proj=longlat +datum=WGS84 +no_defs

OGC WKT2:2018 :
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]

-Jukka-

-----Alkuperäinen viesti-----
Lähettäjä: Even Rouault <even.rouault at spatialys.com> 
Lähetetty: tiistai 4. kesäkuuta 2019 11.03
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] GMLAS tries to read spatialreference.org through http

On mardi 4 juin 2019 06:15:54 CEST Rahkonen Jukka (MML) wrote:
> I am getting lots of warning like this from the GMLAS driver:

> HTTP: Fetch(http://spatialreference.org/ref/epsg/28992/)
> HTTP: These HTTP headers were set: Accept: application/x-ogcwkt ERROR 
> 1: Connection timed out after 10563 milliseconds Warning 1: 
> Reprojection fom http://spatialreference.org/ref/epsg/28992/ to >
> urn:x-ogc:def:crs:EPSG:28992 failed

> I guess that the code should be changed to try https instead.

Doesn't look like it is needed. The following works:

gdalsrsinfo http://spatialreference.org/ref/epsg/28992/

and does the redirection to https

Maybe you hit a temporary issue with the server ?

> The typo "fom" comes also from the driver.

Fixed

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jun  4 05:32:06 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 04 Jun 2019 14:32:06 +0200
Subject: [gdal-dev] GMLAS tries to read spatialreference.org through http
In-Reply-To: <4ed570e7854b4ddd9d4b115e0f5b57fe@C119S212VM042.msvyvi.vaha.local>
References: <4ed570e7854b4ddd9d4b115e0f5b57fe@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2873366.qJ6zjOzo2O@even-i700>

> But now I don't understand why these two gdalsrsinfo request give different
> results if both http and https are pointing to the same resource:

The SRS import from URL is currently only enable for http:// URL, not https:// 
. So gdalsrsinfo tries after to open the URL as a GDAL/OGR dataset, and this 
ends up in the GeoJSONSeq driver that manages to open the garbage it gets 
(HTML content) due to its resilient parsing, and thus it reports WGS84 as SRS. 
I've just modified it to error out when no features are detected.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From traviskirstine at gmail.com  Tue Jun  4 05:54:15 2019
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Tue, 4 Jun 2019 08:54:15 -0400
Subject: [gdal-dev] gdal_grid does not work in cron but works in terminal
In-Reply-To: <1559641911357-0.post@n6.nabble.com>
References: <1559641911357-0.post@n6.nabble.com>
Message-ID: <CALtm4h1JF1JjO5NT7th-OJ9vPBUFpSekfRvneSP+N-qqZ0imDQ@mail.gmail.com>

Are you root when you successfully run it in the terminal? Could it be an
issue with the root user environment when running it in the cron?

On Tue, 4 Jun 2019 at 05:52, davorinbajic <davorinbajic at gmail.com> wrote:

>
> I use the gdal_grid interpolation command. When I work in the terminal
> everything works perfectly. However, when I try to run the command in the
> bash script from cron then it does not work.
>
> Bash script (/root/interpolation/interpolation.sh):
>
> #!/bin/bash
>
> gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
>
> invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
> /root/interpolation/today.vrt /root/interpolation/out/today.tif
>
> I also tried the path to gdal_grid
>
> #!/bin/bash
>
> /usr/bin/gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
>
> invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
> /root/interpolation/today.vrt /root/interpolation/out/today.tif
>
> Virtual file (/root/interpolation/today.vrt)
>
> <OGRVRTDataSource>
> <OGRVRTLayer name="today">
>     <SrcDataSource>/root/interpolation/today.csv</SrcDataSource>
>     <GeometryType>wkbPoint</GeometryType>
> <LayerSRS>WGS84</LayerSRS>
>     <GeometryField encoding="PointFromColumns" x="X" y="Y" z="eto"/>
> </OGRVRTLayer>
>
> CSV (/root/interpolation/today.csv)
>
> id,X,Y,eto
> 1,17.11400986,43.59461212,5.284
> 2,16.01515388,44.38002777,5.636
> 3,19.3653698,44.19543839,6.823
> 4,17.25690269,44.1989975,6.041
> 5,18.53639221,43.60323715,6.452
> 6,16.9213295,45.12902069,6.95
> ...
>
> CRON
>
> PATH='/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin'
>
> 39 10 * * * /root/interpolation/interpolation.sh
>
> Error
>
> Usage: gdal_grid [--help-general] [--formats]
> [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>       CInt16/CInt32/CFloat32/CFloat64}]
> [-of format] [-co "NAME=VALUE"]
> [-zfield field_name]
> [-a_srs srs_def] [-spat xmin ymin xmax ymax]
> [-clipsrc <xmin ymin xmax ymax>|WKT|datasource|spat_extent]
> [-clipsrcsql sql_statement] [-clipsrclayer layer]
> [-clipsrcwhere expression]
> [-l layername]* [-where expression] [-sql select_statement]
> [-txe xmin xmax] [-tye ymin ymax] [-outsize xsize ysize]
> [-a algorithm[:parameter1=value1]*]    [-q]
> <src_datasource> <dst_filename>
>
> Available algorithms and parameters with their's defaults:
> Inverse distance to a power (default)
>
>
> invdist:power=2.0:smoothing=0.0:radius1=0.0:radius2=0.0:angle=0.0:max_points=0:min_points=0:nodata=0.0
> Moving average
>     average:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
> Nearest neighbor
>     nearest:radius1=0.0:radius2=0.0:angle=0.0:nodata=0.0
> Various data metrics
>     <metric name>:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
>     possible metrics are:
>         minimum
>         maximum
>         range
>         count
>         average_distance
>         average_distance_pts
>
> FAILURE: Neither -sql nor -l are specified
>
> Note that it works in the terminal but it does not work in cron. Does
> anyone
> know what the problem is?
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190604/e0f7abd9/attachment-0001.html>

From davorinbajic at gmail.com  Tue Jun  4 06:41:25 2019
From: davorinbajic at gmail.com (Davorin Bajic)
Date: Tue, 4 Jun 2019 15:41:25 +0200
Subject: [gdal-dev] gdal_grid does not work in cron but works in terminal
In-Reply-To: <CALtm4h1JF1JjO5NT7th-OJ9vPBUFpSekfRvneSP+N-qqZ0imDQ@mail.gmail.com>
References: <1559641911357-0.post@n6.nabble.com>
 <CALtm4h1JF1JjO5NT7th-OJ9vPBUFpSekfRvneSP+N-qqZ0imDQ@mail.gmail.com>
Message-ID: <CALvJQa_eZzD9NXKqmvzFGGSZTg7kx2C3sOCqdoJwFt7vhTtaRw@mail.gmail.com>

 I solved. The problem was in two versions of gdal. The gdal environment on
the terminal is set to a newer version, while CRON launches the old
version. I solved the problem so that I added the path to new versions gdal
in bash script.

On Tue, Jun 4, 2019 at 2:54 PM Travis Kirstine <traviskirstine at gmail.com>
wrote:

> Are you root when you successfully run it in the terminal? Could it be an
> issue with the root user environment when running it in the cron?
>
> On Tue, 4 Jun 2019 at 05:52, davorinbajic <davorinbajic at gmail.com> wrote:
>
>>
>> I use the gdal_grid interpolation command. When I work in the terminal
>> everything works perfectly. However, when I try to run the command in the
>> bash script from cron then it does not work.
>>
>> Bash script (/root/interpolation/interpolation.sh):
>>
>> #!/bin/bash
>>
>> gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
>>
>> invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
>> /root/interpolation/today.vrt /root/interpolation/out/today.tif
>>
>> I also tried the path to gdal_grid
>>
>> #!/bin/bash
>>
>> /usr/bin/gdal_grid -ot Float64 -of GTiff -outsize 750 750 -a
>>
>> invdist:power=2.0:smoothing=0.0:radius1=0.08:radius2=0.08:angle=0.0:max_points=0:min_points=0
>> /root/interpolation/today.vrt /root/interpolation/out/today.tif
>>
>> Virtual file (/root/interpolation/today.vrt)
>>
>> <OGRVRTDataSource>
>> <OGRVRTLayer name="today">
>>     <SrcDataSource>/root/interpolation/today.csv</SrcDataSource>
>>     <GeometryType>wkbPoint</GeometryType>
>> <LayerSRS>WGS84</LayerSRS>
>>     <GeometryField encoding="PointFromColumns" x="X" y="Y" z="eto"/>
>> </OGRVRTLayer>
>>
>> CSV (/root/interpolation/today.csv)
>>
>> id,X,Y,eto
>> 1,17.11400986,43.59461212,5.284
>> 2,16.01515388,44.38002777,5.636
>> 3,19.3653698,44.19543839,6.823
>> 4,17.25690269,44.1989975,6.041
>> 5,18.53639221,43.60323715,6.452
>> 6,16.9213295,45.12902069,6.95
>> ...
>>
>> CRON
>>
>> PATH='/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin'
>>
>> 39 10 * * * /root/interpolation/interpolation.sh
>>
>> Error
>>
>> Usage: gdal_grid [--help-general] [--formats]
>> [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>>       CInt16/CInt32/CFloat32/CFloat64}]
>> [-of format] [-co "NAME=VALUE"]
>> [-zfield field_name]
>> [-a_srs srs_def] [-spat xmin ymin xmax ymax]
>> [-clipsrc <xmin ymin xmax ymax>|WKT|datasource|spat_extent]
>> [-clipsrcsql sql_statement] [-clipsrclayer layer]
>> [-clipsrcwhere expression]
>> [-l layername]* [-where expression] [-sql select_statement]
>> [-txe xmin xmax] [-tye ymin ymax] [-outsize xsize ysize]
>> [-a algorithm[:parameter1=value1]*]    [-q]
>> <src_datasource> <dst_filename>
>>
>> Available algorithms and parameters with their's defaults:
>> Inverse distance to a power (default)
>>
>>
>> invdist:power=2.0:smoothing=0.0:radius1=0.0:radius2=0.0:angle=0.0:max_points=0:min_points=0:nodata=0.0
>> Moving average
>>     average:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
>> Nearest neighbor
>>     nearest:radius1=0.0:radius2=0.0:angle=0.0:nodata=0.0
>> Various data metrics
>>     <metric
>> name>:radius1=0.0:radius2=0.0:angle=0.0:min_points=0:nodata=0.0
>>     possible metrics are:
>>         minimum
>>         maximum
>>         range
>>         count
>>         average_distance
>>         average_distance_pts
>>
>> FAILURE: Neither -sql nor -l are specified
>>
>> Note that it works in the terminal but it does not work in cron. Does
>> anyone
>> know what the problem is?
>>
>>
>>
>>
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190604/49e2b096/attachment.html>

From jormarfe at gmail.com  Wed Jun  5 03:29:48 2019
From: jormarfe at gmail.com (Jorge Martin)
Date: Wed, 5 Jun 2019 12:29:48 +0200
Subject: [gdal-dev] Issues installing gdal from source code
Message-ID: <CADH5xWpBfrRLFRskk9ROxeUv_nQ3-fABpEr0hCuJ9gNi9Rw+Kg@mail.gmail.com>

Hello,

Trying to compile gdal 2.1.1 we are getting the following error:



./configure --with-libtiff=/opt/cots/tiff-4.0.0
--with-geotiff=/opt/cots/geotiff-1.4.0 --prefix=/opt/cots/gdal_v2

make



(cd port; make)

make[1]: Entering directory `/data2/mvit/gdal-2.1.1/port'

…….

cpl_string.cpp: In function 'int CPLVASPrintf(char**, const char*,
__va_list_tag*)':

cpl_string.cpp:1034: error: declaration of 'int CPLVASPrintf(char**, const
char*, __va_list_tag*)' throws different exceptions

cpl_string.h:215: error: from previous declaration 'int
CPLVASPrintf(char**, const char*, __va_list_tag*) throw ()'

cpl_string.cpp: In function 'int CPLvsnprintf(char*, size_t, const char*,
__va_list_tag*)':

cpl_string.cpp:1124: error: declaration of 'int CPLvsnprintf(char*, size_t,
const char*, __va_list_tag*)' throws different exceptions

cpl_string.h:195: error: from previous declaration 'int CPLvsnprintf(char*,
size_t, const char*, __va_list_tag*) throw ()'

cpl_string.cpp: In function 'int CPLsnprintf(char*, size_t, const char*,
...)':

cpl_string.cpp:1305: error: declaration of 'int CPLsnprintf(char*, size_t,
const char*, ...)' throws different exceptions

cpl_string.h:197: error: from previous declaration 'int CPLsnprintf(char*,
size_t, const char*, ...) throw ()'



our system is Red Hat Enterprise Linux Server release 5.1 (Tikanga) and we
have installed previous version of gdal in the machine.



We also have tried to install other versions such as 2.2.1, 2.2.2 and 2.2.3
and we got the same error. The vesion that we have installed is 1.8.1.

Regards,
Jorge
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190605/5209d926/attachment.html>

From sebastian.schoeller at gmail.com  Wed Jun  5 04:07:44 2019
From: sebastian.schoeller at gmail.com (Sebastian Schoeller)
Date: Wed, 5 Jun 2019 11:07:44 +0000
Subject: [gdal-dev] Datum transformation CSV->CSV for WGS84->DGN95
Message-ID: <CABhpw16_mRbBF3LAPVyG87=SxNpCdUAd7+OnA6z1gPzvsOjXnw@mail.gmail.com>

Dear all,

I posted a problem on

https://gis.stackexchange.com/questions/324848/transform-datum-csv-csv-using-ogr2ogr?noredirect=1#comment529063_324848

and was refered to list mailing list. I am trying to convert Z in
UTM48S/WGS84 to either DGN95 or EGM2008 datum. From what I may read on
epsg.io the EPSG code definition is

EGM2008 datum: 3855
WGS84 datum: 4979
DNG95 datum: 6755
ID74 datum: 6238

Any hints most welcome.

Best regards

Sebastian

From andrew.bell.ia at gmail.com  Wed Jun  5 04:50:29 2019
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 5 Jun 2019 07:50:29 -0400
Subject: [gdal-dev] Issues installing gdal from source code
In-Reply-To: <CADH5xWpBfrRLFRskk9ROxeUv_nQ3-fABpEr0hCuJ9gNi9Rw+Kg@mail.gmail.com>
References: <CADH5xWpBfrRLFRskk9ROxeUv_nQ3-fABpEr0hCuJ9gNi9Rw+Kg@mail.gmail.com>
Message-ID: <CACJ51z0GpK_f6SvHg+s2Bn5Z6wynKfBs60-ZpDN26aSyqLRfbQ@mail.gmail.com>

Perhaps I'm missing something, but I'm seeing no throw specifications on my
2.1 source.  I'm guessing you're finding header files from a version that
is different from the version you're trying to compile.  I'd search your
system for "cpl_string.h" and compare with the include directories used
during compilation.

On Wed, Jun 5, 2019 at 6:30 AM Jorge Martin <jormarfe at gmail.com> wrote:

> Hello,
>
> Trying to compile gdal 2.1.1 we are getting the following error:
>
>
>
> ./configure --with-libtiff=/opt/cots/tiff-4.0.0
> --with-geotiff=/opt/cots/geotiff-1.4.0 --prefix=/opt/cots/gdal_v2
>
> make
>
>
>
> (cd port; make)
>
> make[1]: Entering directory `/data2/mvit/gdal-2.1.1/port'
>
> …….
>
> cpl_string.cpp: In function 'int CPLVASPrintf(char**, const char*,
> __va_list_tag*)':
>
> cpl_string.cpp:1034: error: declaration of 'int CPLVASPrintf(char**, const
> char*, __va_list_tag*)' throws different exceptions
>
> cpl_string.h:215: error: from previous declaration 'int
> CPLVASPrintf(char**, const char*, __va_list_tag*) throw ()'
>
> cpl_string.cpp: In function 'int CPLvsnprintf(char*, size_t, const char*,
> __va_list_tag*)':
>
> cpl_string.cpp:1124: error: declaration of 'int CPLvsnprintf(char*,
> size_t, const char*, __va_list_tag*)' throws different exceptions
>
> cpl_string.h:195: error: from previous declaration 'int
> CPLvsnprintf(char*, size_t, const char*, __va_list_tag*) throw ()'
>
> cpl_string.cpp: In function 'int CPLsnprintf(char*, size_t, const char*,
> ...)':
>
> cpl_string.cpp:1305: error: declaration of 'int CPLsnprintf(char*, size_t,
> const char*, ...)' throws different exceptions
>
> cpl_string.h:197: error: from previous declaration 'int CPLsnprintf(char*,
> size_t, const char*, ...) throw ()'
>
>
>
> our system is Red Hat Enterprise Linux Server release 5.1 (Tikanga) and we
> have installed previous version of gdal in the machine.
>
>
>
> We also have tried to install other versions such as 2.2.1, 2.2.2 and
> 2.2.3 and we got the same error. The vesion that we have installed is
> 1.8.1.
>
> Regards,
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190605/dcabfea3/attachment.html>

From jon.elliott at hexagon.com  Wed Jun  5 05:38:32 2019
From: jon.elliott at hexagon.com (jkellio2)
Date: Wed, 5 Jun 2019 05:38:32 -0700 (MST)
Subject: [gdal-dev] Getting database is locked error when writing to
 GeoPackage database.
Message-ID: <1559738312918-0.post@n6.nabble.com>

I'm using the OGR/GDAL C# managaged API to write to a GeoPackage database and
I keep running into a "database is locked" error when I try to sync the
database to disk.  After much experimentation, this appears to only happen
if I first open the GeoPackage to do a read, close the db (Dispose the
DataSource), reopen db and attempt to write.  Web searches indicate that
this error occurs if the GDAL and SQLite objects from the read are not
disposed before attempting the write.  However, I think I'm disposing all
the managed objects properly so I'm wondering if there is a call that I'm
missing.  Any help would be greatly appreciated.  I've included a sample
Console app that shows the error I'm getting. It attempts to create a new
layer but I get same error if I try updating an existing layer.  I'm using
GeoPackage v1.2, GDAL v2.3, and SQLite v3.21.0 on Windows.


using System;
using System.Collections.Generic;
using OSGeo.OGR;
namespace GeoPackageWriteTest
{
  class GeoPackageTest
  {
    public static void usage()
    {
      Console.WriteLine( "usage (to create a new layer):" );
      Console.WriteLine( "gpkgWriteTest {gpkg filename} {layername}" );
      System.Environment.Exit( 0 );
    }
    static void Main( string[] args )
    {
      if ( args.Length < 2 )
        usage();

      Ogr.RegisterAll();

      // simulate an object opening a geopackage db to do a simple read
      Console.WriteLine( "Opening database readonly: " + args[0] );
      DataSource dataSource1 = Ogr.OpenShared( args[0], 0 ); // open
readonly
      if ( dataSource1 == null )
        throw new ArgumentException( string.Format( "Error opening
GeoPackage database: {0}", args[0] ) );
      using ( dataSource1 )
      {
        Driver driver = dataSource1.GetDriver();
        if ( driver == null )
          throw new ArgumentException( "Error getting GDAL driver!" );
        Console.WriteLine( "Using driver: " + driver.name );

        string pfile = GetParameterTableName( dataSource1 );
        Console.WriteLine( "Parameter table: " + pfile );
      } // DataSource gets disposed and geopackage is closed
      dataSource1 = null;

      // make sure all Disposed objects are garbage collected
      // (just trying to see if it makes a difference, it doesn't)
      GC.Collect( GC.MaxGeneration, GCCollectionMode.Forced, true, true );
      GC.WaitForPendingFinalizers();

      // simulate another object reopening a geopackage db to do a simple
write
      Console.WriteLine( "Opening database readwrite: " + args[0] );
      DataSource dataSource2 = Ogr.OpenShared( args[0], 1 );  // reopen
readwrite
      if ( dataSource2 == null )
        throw new ArgumentException( string.Format( "Error opening
GeoPackage database: {0}", args[0] ) );
      using ( dataSource2 )
      {
        List<string> options = new List<string>();
        options.Add( "SPATIAL_INDEX=YES" );

        Console.WriteLine( "Creating layer: " + args[1] );
        Layer tableLayer = dataSource2.CreateLayer( args[1], null,
wkbGeometryType.wkbNone, options.ToArray() );
        if ( tableLayer == null )
          throw new ArgumentException( string.Format( "Error creating layer:
{0}", args[2] ) );

        int rc = Ogr.OGRERR_NONE;
        int approx_ok = 1;
        int fieldCount = 3;
        for ( int i = 0; i < fieldCount; i++ )
        {
          //FieldDefn fieldDefn = GetFieldDefn( args[n], args[n + 1] );
          string fname = string.Format( "TestField{0}", i );
          FieldDefn fieldDefn = GetFieldDefn( fname, "int32" );
          rc = tableLayer.CreateField( fieldDefn, approx_ok );
          if ( rc != Ogr.OGRERR_NONE )
            throw new ArgumentException( string.Format( "Error creating
field: {0}", fname ) );
        }
        // write changes to disk
        Console.WriteLine( "Writing changes to disk..." );
        dataSource2.FlushCache(); // this throws database locked error
      }
    }
    static string GetParameterTableName( DataSource ogrDataSource )
    {
      try
      {
        string s = string.Empty;
        string sql = "select * from sqlite_master where type='table' and
name like '%Parameter%'";
        OSGeo.OGR.Layer layer = ogrDataSource.ExecuteSQL( sql, null,
"SQLITE" );
        using ( layer )
        {
          layer.ResetReading();
          OSGeo.OGR.Feature fea = layer.GetNextFeature();
          if ( fea != null )
          {
            s = fea.GetFieldAsString( "name" );
          }
        }
        return s;
      }
      catch ( Exception )
      {
        return string.Empty;
      }
    }
    private static FieldDefn GetFieldDefn( string fldName, string fldType )
    {
      //OSGeo.OGR.FieldType fieldType = GetOGRFieldType( fldType );
      OSGeo.OGR.FieldType fieldType = FieldType.OFTInteger;
      OSGeo.OGR.FieldSubType subType = FieldSubType.OFSTNone;

      FieldDefn fieldDefn = new FieldDefn( fldName, fieldType );
      fieldDefn.SetSubType( subType );
      return fieldDefn;
    }
  }
}




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Wed Jun  5 05:47:25 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Jun 2019 14:47:25 +0200
Subject: [gdal-dev] Getting database is locked error when writing to
	GeoPackage database.
In-Reply-To: <1559738312918-0.post@n6.nabble.com>
References: <1559738312918-0.post@n6.nabble.com>
Message-ID: <1644741.kEspKtSYy2@even-i700>

On mercredi 5 juin 2019 05:38:32 CEST jkellio2 wrote:
> I'm using the OGR/GDAL C# managaged API to write to a GeoPackage database
> and I keep running into a "database is locked" error when I try to sync the
> database to disk.  After much experimentation, this appears to only happen
> if I first open the GeoPackage to do a read, close the db (Dispose the
> DataSource), reopen db and attempt to write.  Web searches indicate that
> this error occurs if the GDAL and SQLite objects from the read are not
> disposed before attempting the write.  However, I think I'm disposing all
> the managed objects properly so I'm wondering if there is a call that I'm
> missing.

I'm pretty ignorant of C#, but I believe you may need to explicitly call the 
SWIG generated Dispose() method on the DataSource object. Pure C# garbage 
collection is probably not always sufficient.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jon.elliott at hexagon.com  Wed Jun  5 06:04:00 2019
From: jon.elliott at hexagon.com (jkellio2)
Date: Wed, 5 Jun 2019 06:04:00 -0700 (MST)
Subject: [gdal-dev] Getting database is locked error when writing to
 GeoPackage database.
In-Reply-To: <1644741.kEspKtSYy2@even-i700>
References: <1559738312918-0.post@n6.nabble.com> <1644741.kEspKtSYy2@even-i700>
Message-ID: <1559739840066-0.post@n6.nabble.com>

In C# the using statement calls Dispose for you.  I've stepped through the
OGR C# code and confirmed that Dispose is called.  
The database locked error occurs in the
OGRGeoPackageTableLayer::SyncToDisk() method on the call
RunDeferredCreationIfNecessary().  I drilled down to that method and SQLite
is returning the database locked error on the call the sends in the create
SQL:  sqlite3_exec(poDb, pszSQL, nullptr, nullptr, &pszErrMsg);



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From cedric.traizet at c-s.fr  Wed Jun  5 05:56:30 2019
From: cedric.traizet at c-s.fr (=?UTF-8?Q?C=c3=a9dric_Traizet?=)
Date: Wed, 5 Jun 2019 14:56:30 +0200
Subject: [gdal-dev] Axis order in the kml driver
Message-ID: <4ebe42ae-23b4-7ef1-2dee-d23701c7da2b@c-s.fr>

Hello,

I am trying to use the kml ogr driver in gdal 3.0, but there is 
something I find weird with the spatial references:

- When a layer is created (in the constructor), a wgs84 geoCRS is 
created, without setting its "Axis mapping strategy" to 
OAMS_TRADITIONAL_GIS_ORDER, meaning that it uses latitude first and 
longitude second. This spatial reference is then compared to the source 
spatial reference, and if it doesn't match, a 
OGRCoordinateTransformation is created to convert from the source SRS to 
wgs84 (as kml only supports wgs84).

- When opening a kml datasource using the driver, a wgs84 geoCRS is 
created, this time with its axis mapping strategy set to 
OAMS_TRADITIONAL_GIS_ORDER (longitude first and latitude second). A 
layer is then created with this spatial reference and compared with a 
lat/long wgs84 as described above. And as they mismatch, a coordinate 
transformation is created between the two geoCRS.

I think the wgs84 spatial reference of the layer should also have its 
axis set to OAMS_TRADITIONAL_GIS_ORDER.

Or maybe I am not understanding correctly of spatial references work in 
this driver ? I am still a bit confused with these axis order issues.

Cédric


From even.rouault at spatialys.com  Wed Jun  5 10:05:15 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Jun 2019 19:05:15 +0200
Subject: [gdal-dev] Axis order in the kml driver
In-Reply-To: <4ebe42ae-23b4-7ef1-2dee-d23701c7da2b@c-s.fr>
References: <4ebe42ae-23b4-7ef1-2dee-d23701c7da2b@c-s.fr>
Message-ID: <2966045.GZtKqdeFSa@even-i700>

Cédric,

> - When a layer is created (in the constructor), a wgs84 geoCRS is
> created, without setting its "Axis mapping strategy" to
> OAMS_TRADITIONAL_GIS_ORDER, meaning that it uses latitude first and
> longitude second. 

Yes, was missing. Just fixed

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From epalacios at conabio.gob.mx  Wed Jun  5 11:44:07 2019
From: epalacios at conabio.gob.mx (Erick Palacios Moreno)
Date: Wed, 5 Jun 2019 13:44:07 -0500 (CDT)
Subject: [gdal-dev] gdalinfo's and rasterio's reading problem in LUSTRE FS
 with NetCDF file (ubuntu:bionic)
In-Reply-To: <607747055.17610436.1559760221059.JavaMail.zimbra@conabio.gob.mx>
Message-ID: <68106617.17611179.1559760247488.JavaMail.zimbra@conabio.gob.mx>

Hi everyone,

 My team and I have been facing some problems when reading netcdf files in `LUSTRE` filesystem with `ncdump` tool regarding an HDF5 1.10.1 issue in `ubuntu:bionic` (see for example: https://github.com/ALPSCore/ALPSCore/issues/410)

We made a workaround by installing `netcdf-bin` using repositories of `ubuntu:xenial` in `bionic`. Although `ncdump` have successfully read the netcdf file, we couldn't fix it (sort of...) for `gdalinfo` and  `rasterio` for example:

this works:

ncdump /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc|head -n 20

gdalinfo /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc |head -n 20

gdalinfo -sd 1 /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc |head -n 20

but this neither of next lines work:

gdalinfo netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean

gdalinfo NetCDF:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean

```
ERROR 4: NetCDF:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean: No such file or directory
gdalinfo failed - unable to open 'NetCDF:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean'.
```

This ultimately leads to error with `rio insp`  in both next lines :

rio insp netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean

rio insp NetCDF:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean

```
ERROR:root:Exception caught during processing
Traceback (most recent call last):
  File "rasterio/_base.pyx", line 214, in rasterio._base.DatasetBase.__init__
  File "rasterio/_shim.pyx", line 64, in rasterio._shim.open_dataset
  File "rasterio/_err.pyx", line 205, in rasterio._err.exc_wrap_pointer
rasterio._err.CPLE_OpenFailedError: netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.6/dist-packages/rasterio/rio/insp.py", line 77, in insp
    with rasterio.open(input, mode) as src:
  File "/usr/local/lib/python3.6/dist-packages/rasterio/env.py", line 423, in wrapper
    return f(*args, **kwds)
  File "/usr/local/lib/python3.6/dist-packages/rasterio/__init__.py", line 216, in open
    s = DatasetReader(path, driver=driver, **kwargs)
  File "rasterio/_base.pyx", line 216, in rasterio._base.DatasetBase.__init__
rasterio.errors.RasterioIOError: netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_mean: No such file or directory
Aborted!

```

But this works for both `gdalinfo` and `rio insp` tools:

```
gdalinfo hdf5:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc://blue_mean

Driver: HDF5Image/HDF5 Dataset
Files: /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc
Size is 1667, 1667
Coordinate System is `'
Metadata:
  Conventions=CF-1.6, ACDD-1.3
  date_created=2019-04-26T21:07:47.595416
  geospatial_bounds=POLYGON ((-98.8618335626467 19.8093029971201,-98.8722811078025 19.3587577175966,-98.3949028300917 19.3481841431337,-98.382861955109 19.7986884105649,-98.8618335626467 19.8093029971201))
  geospatial_bounds_crs=EPSG:4326
...
```

```
rio insp hdf5:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc://blue_mean

/usr/local/lib/python3.6/dist-packages/rasterio/__init__.py:216: NotGeoreferencedWarning: Dataset has no geotransform set. The identity matrix may be returned.
  s = DatasetReader(path, driver=driver, **kwargs)
Rasterio 1.0.23 Interactive Inspector (Python 3.6.7)
Type "src.meta", "src.read(1)", or "help(src)" for more information.
>>> src.meta
{'driver': 'HDF5Image', 'dtype': 'int16', 'nodata': None, 'width': 1667, 'height': 1667, 'count': 1, 'crs': None, 'transform': Affine(1.0, 0.0, 0.0,
       0.0, 1.0, 0.0)}

>>> a=src.read()
>>> a
array([[[632, 603, 586, ..., 505, 483, 471],
        [567, 538, 536, ..., 468, 478, 523],
        [614, 580, 537, ..., 540, 633, 675],
        ...,
        [828, 810, 804, ..., 275, 268, 299],
        [857, 844, 823, ..., 310, 290, 307],
        [840, 854, 836, ..., 320, 288, 294]]], dtype=int16)

```

This is related with LUSTRE FS because if we copy our NetCDF file to /root location then:

```
this works:

gdalinfo netcdf:/root/madmex_003_37_-32_1996-01-01.nc:blue_mean

Driver: netCDF/Network Common Data Format
Files: /root/madmex_003_37_-32_1996-01-01.nc
Size is 1667, 1667
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["WGS 84",
...
```

```
rio insp netcdf:/root/madmex_003_37_-32_1996-01-01.nc:blue_mean
Rasterio 1.0.23 Interactive Inspector (Python 3.6.7)
Type "src.meta", "src.read(1)", or "help(src)" for more information.
>>> src.meta
{'driver': 'netCDF', 'dtype': 'int16', 'nodata': -32767.0, 'width': 1667, 'height': 1667, 'count': 1, 'crs': CRS.from_wkt('PROJCS["unnamed",GEOGCS["WGS 84",DATUM["unknown",SPHEROID["WGS84",6378137,6556752.3141]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["standard_parallel_1",17.5],PARAMETER["standard_parallel_2",29.5],PARAMETER["latitude_of_origin",12],PARAMETER["central_meridian",-102],PARAMETER["false_easting",2500000],PARAMETER["false_northing",0]]'), 'transform': Affine(30.0, 0.0, 2827530.0,
       0.0, -30.0, 876410.0)}
>>> a=src.read()
>>> a
array([[[632, 603, 586, ..., 505, 483, 471],
        [567, 538, 536, ..., 468, 478, 523],
        [614, 580, 537, ..., 540, 633, 675],
        ...,
        [828, 810, 804, ..., 275, 268, 299],
        [857, 844, 823, ..., 310, 290, 307],
        [840, 854, 836, ..., 320, 288, 294]]], dtype=int16)
```

We are using `ubuntu:bionic` docker image so you can reproduce this error using next lines:

```
sudo docker run -v /LUSTRE/:/LUSTRE/ \
-v /LUSTRE/MADMEX/dir_test_mount:/temporal \
--name mounting_volume_test_bionic \
--hostname antares3-datacube \
-dit ubuntu:bionic /bin/bash
```

enter to docker container:

```
sudo docker exec -it mounting_volume_test_bionic bash
```

and execute:

```
apt-get update

export DEBIAN_FRONTEND=noninteractive && echo "America/Mexico_City" > /etc/timezone && apt-get install -y tzdata
apt-get update && apt-get install -y \
            wget curl \
            openssh-server \
            openssl \
            sudo \
            nano \
            software-properties-common \
            git \
            vim \
            vim-gtk \
            htop \
            build-essential \
            libssl-dev \
            libffi-dev \
            cmake \
            python3-dev \
            python3-pip \
            python3-setuptools \
            ca-certificates \
            postgresql-client \
            libudunits2-dev \
            nodejs && pip3 install --upgrade pip

#install netcdf:

echo -e 'deb http://security.ubuntu.com/ubuntu/ xenial-security universe\ndeb http://archive.ubuntu.com/ubuntu/ xenial universe' >> /etc/apt/sources.list
apt update
apt install -t xenial-security libcurl3-gnutls
apt install -y -t xenial netcdf-bin


#Install spatial libraries
add-apt-repository -y ppa:ubuntugis/ubuntugis-unstable && apt-get -qq update

apt-get install -y \
            ncview \
            libproj-dev \
            libgeos-dev \
            gdal-bin \
            libgdal-dev
pip install numpy && pip install GDAL==$(gdal-config --version) --global-option=build_ext --global-option='-I/usr/include/gdal' && pip install rasterio
export LC_ALL=C.UTF-8
export LANG=C.UTF-8
export GDAL_DATA=/usr/share/gdal/
```

Hope you can help us

Cheers,

Erick

From even.rouault at spatialys.com  Wed Jun  5 14:02:03 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Jun 2019 23:02:03 +0200
Subject: [gdal-dev] Datum transformation CSV->CSV for WGS84->DGN95
In-Reply-To: <CABhpw16_mRbBF3LAPVyG87=SxNpCdUAd7+OnA6z1gPzvsOjXnw@mail.gmail.com>
References: <CABhpw16_mRbBF3LAPVyG87=SxNpCdUAd7+OnA6z1gPzvsOjXnw@mail.gmail.com>
Message-ID: <1712890.TQKH0Gc14R@even-i700>

On mercredi 5 juin 2019 11:07:44 CEST Sebastian Schoeller wrote:
> Dear all,
> 
> I posted a problem on
> 
> https://gis.stackexchange.com/questions/324848/transform-datum-csv-csv-using
> -ogr2ogr?noredirect=1#comment529063_324848
> 
> and was refered to list mailing list. I am trying to convert Z in
> UTM48S/WGS84 to either DGN95 or EGM2008 datum. From what I may read on
> epsg.io the EPSG code definition is
> 
> EGM2008 datum: 3855
> WGS84 datum: 4979
> DNG95 datum: 6755
> ID74 datum: 6238

For GDAL < 3.0 and EGM2008, this is mostly an issue of having the egm08_25.gtx 
grid installed alongside of others PROJ resources, and then

$ echo "9231824.04 787648.04 711.1442" | \
     gdaltransform -s_srs EPSG:32748  -t_srs EPSG:32748+3855
9231824.03999554 787648.040034059 689.737249081086

For GDAL >= 3.0, this is a bit more tricky, since the system is a bit more 
pedantic about geodetic correctness and will not want to transform between a 
2D CRS and a 3D CRS, so you have to do a 2-step dance:

$ echo "9231824.04 787648.04 711.1442" | \
   gdaltransform -s_srs EPSG:32748 -t_srs EPSG:4326 | \
   gdaltransform -s_srs EPSG:4979  -t_srs EPSG:32748+3855
9231824.03999555 787648.040034041 689.737249081087

I'm a bit confused by your mentions of DGN95 and ID74. Those are geodetic 
(horizontal) datum / geodetic CRS, so they cannot be compared to a vertical 
CRS like EGM2008.

You can transform between both (using the CRS codes corresponding to the 
datum):

For GDAL < 3.0, you'll get for example

$ echo "100 0" | gdaltransform -s_srs EPSG:4238 -t_srs EPSG:4755
100.000235718449 4.52183853812619e-05 12.3954959195107
(but you should ignore the Z value of 12.xxxx, which is irrelevant.)

For GDAL >=3.0,
$ echo "100 0" | gdaltransform -s_srs EPSG:4238 -t_srs EPSG:4755
100.000229251525 2.22071403023558e-05 0

The transformation parameters between ID74 and WGS84/DGN95 have changed 
between both GDAL/PROJ versions, hence the difference in results

Regarding DGN95 to WGS84 conversion, this is considered by EPSG (operation 
15912) as a transformation with no coordinate change with an accuracy of 1m.

$ echo "100 0" | gdaltransform -s_srs EPSG:4755 -t_srs EPSG:4326
100 0 0


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jun  5 14:49:34 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Jun 2019 23:49:34 +0200
Subject: [gdal-dev] gdalinfo's and rasterio's reading problem in LUSTRE
	FS with NetCDF file (ubuntu:bionic)
In-Reply-To: <68106617.17611179.1559760247488.JavaMail.zimbra@conabio.gob.mx>
References: <68106617.17611179.1559760247488.JavaMail.zimbra@conabio.gob.mx>
Message-ID: <3005920.Gpk7C3TN19@even-i700>

On mercredi 5 juin 2019 13:44:07 CEST Erick Palacios Moreno wrote:
> Hi everyone,
> 
>  My team and I have been facing some problems when reading netcdf files in
> `LUSTRE` filesystem with `ncdump` tool regarding an HDF5 1.10.1 issue in
> `ubuntu:bionic` (see for example:
> https://github.com/ALPSCore/ALPSCore/issues/410)
> 
> We made a workaround by installing `netcdf-bin` using repositories of
> `ubuntu:xenial` in `bionic`. Although `ncdump` have successfully read the
> netcdf file, we couldn't fix it (sort of...) for `gdalinfo` and  `rasterio`
> for example:
> 
> this works:
> 
> ncdump /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc|head -n
> 20
> 
> gdalinfo /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc |head
> -n 20
> 
> gdalinfo -sd 1 /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc
> |head -n 20
> 
> but this neither of next lines work:
> 
> gdalinfo
> netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_m
> ean

That one is weird, I mean that 'gdalinfo -sd 1 ...' works, but not 'gdalinfo 
netcdf:....', since the former internally invokes the later, but with the 
difference of an extra GDALOpen()/GDALClose().

I think you've already found the root cause of all this, that its that HDF5 
1.10 doesn't play well with LUSTRE, which causes those kind of weird/random 
failures. Nothing that GDAL can do about. So your best option is to build GDAL 
and libnetcdf against a libhdf5 version that plays well with LUSTRE, or copy 
locally the files.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jormarfe at gmail.com  Thu Jun  6 02:27:57 2019
From: jormarfe at gmail.com (Jorge Martin)
Date: Thu, 6 Jun 2019 11:27:57 +0200
Subject: [gdal-dev] Issues installing gdal from source code
In-Reply-To: <CACJ51z0GpK_f6SvHg+s2Bn5Z6wynKfBs60-ZpDN26aSyqLRfbQ@mail.gmail.com>
References: <CADH5xWpBfrRLFRskk9ROxeUv_nQ3-fABpEr0hCuJ9gNi9Rw+Kg@mail.gmail.com>
 <CACJ51z0GpK_f6SvHg+s2Bn5Z6wynKfBs60-ZpDN26aSyqLRfbQ@mail.gmail.com>
Message-ID: <CADH5xWqPnR+kHOvTTZXEfWCdmkKOs2-mtG2Qs9catW8vGTh6zA@mail.gmail.com>

Hello,



First of all, thanks for you answer!

I have checked what you say, I list more steps and additional information:



1)      check “cpl_string.h" and only one file is found:

      >> gdal-2.2.1]# find / -name cpl_string.h

       /root/gdal-2.2.1/port/cpl_string.h



2)      Compiler version:

      >> g++ --version

        g++ (GCC) 4.1.2 20070626 (Red Hat 4.1.2-14)

                 SO: Red Hat 5.1



3)      I have tried with gdal 2.2.1, 2.2.2, 2.2.3 and the result is the
same.



4)      I have tried with “make –j11” and 3 errors are returned:

                >> cd /root/gdal-2.2.1

               >> ./configure --with-libtiff=/opt/cots/tiff-4.0.0
--with-geotiff=/opt/cots/geotiff-1.4.0 --prefix=/opt/cots/gdal

               >> make –j11



ERRORS:

libtool: compile:  gcc -I/opt/cots/gdal/port -I/opt/cots/gdal/gcore
-I/opt/cots/gdal/alg -I/opt/cots/gdal/ogr -I/opt/cots/gdal/ogr/o
grsf_frmts -I/opt/cots/gdal/gnm -I/opt/cots/gdal/apps
-DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2 -Wall
-Wdeclara        tion-after-statement -Wextra -Winit-self
-Wunused-parameter -Wmissing-prototypes -Wmissing-declarations -Wformat
-Wshadow -DGNM_ENAB        LED -I/opt/cots/gdal/port
-I/usr/include/netcdf-3 -I/opt/cots/geotiff-1.4.0/include
-I/opt/cots/tiff-4.0.0/include -DGDAL_COMPILATIO        N -c gxf_proj4.c
-fPIC -DPIC -o ../o/.libs/gxf_proj4.o

cpl_string.cpp: In function 'int CPLVASPrintf(char**, const char*,
__va_list_tag*)':

cpl_string.cpp:1042: error: declaration of 'int CPLVASPrintf(char**, const
char*, __va_list_tag*)' throws different exceptions

cpl_string.h:284: error: from previous declaration 'int
CPLVASPrintf(char**, const char*, __va_list_tag*) throw ()'

cpl_string.cpp: In function 'int CPLvsnprintf(char*, size_t, const char*,
__va_list_tag*)':

cpl_string.cpp:1134: error: declaration of 'int CPLvsnprintf(char*, size_t,
const char*, __va_list_tag*)' throws different exception        s

cpl_string.h:244: error: from previous declaration 'int CPLvsnprintf(char*,
size_t, const char*, __va_list_tag*) throw ()'

cpl_string.cpp: In function 'int CPLsnprintf(char*, size_t, const char*,
...)':

cpl_string.cpp:1330: error: declaration of 'int CPLsnprintf(char*, size_t,
const char*, ...)' throws different exceptions

cpl_string.h:253: error: from previous declaration 'int CPLsnprintf(char*,
size_t, const char*, ...) throw ()'

make[1]: *** [cpl_string.lo] Error 1

make[1]: Leaving directory `/opt/cots/gdal/port'

make: *** [port-target] Error 2

make: *** Waiting for unfinished jobs....

/bin/sh /opt/cots/gdal/libtool --mode=compile --tag=CXX g++
-I/opt/cots/gdal/port



/bin/sh /opt/cots/gdal/libtool --mode=compile --tag=CXX g++
-I/opt/cots/gdal/port -I/opt/cots/gdal/gcore -I/opt/cots/gdal/alg
-I/opt/cots/gdal/ogr -I/opt/cots/gdal/ogr/ogrsf_frmts -I/opt/cots/gdal/gnm
-I/opt/cots/gdal/apps -DHAVE_SSSE3_AT_COMPILE_TIME
-DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall -Wextra -Winit-self
-Wunused-parameter -Wformat -Wshadow -Wnon-virtual-dtor
-Woverloaded-virtual -fno-operator-names  -I.. -I../..   -I/usr/include
-I/usr/include -DGNM_ENABLED -I/opt/cots/gdal/port -I/usr/include/netcdf-3
-I/opt/cots/geotiff-1.4.0/include -I/opt/cots/tiff-4.0.0/include
-DGDAL_COMPILATION -DHAVE_EXPAT -DHAVE_SQLITE -c -o ../o/gmlhandler.lo
gmlhandler.cpp

libtool: compile:  g++ -I/opt/cots/gdal/port -I/opt/cots/gdal/gcore
-I/opt/cots/gdal/alg -I/opt/cots/gdal/ogr -I/opt/cots/gdal/ogr/ogrsf_frmts
-I/opt/cots/gdal/gnm -I/opt/cots/gdal/apps -DHAVE_SSSE3_AT_COMPILE_TIME
-DHAVE_SSE_AT_COMPILE_TIME -g -O2 -Wall -Wextra -Winit-self
-Wunused-parameter -Wformat -Wshadow -Wnon-virtual-dtor
-Woverloaded-virtual -fno-operator-names -I.. -I../.. -I/usr/include
-I/usr/include -DGNM_ENABLED -I/opt/cots/gdal/port -I/usr/include/netcdf-3
-I/opt/cots/geotiff-1.4.0/include -I/opt/cots/tiff-4.0.0/include
-DGDAL_COMPILATION -DHAVE_EXPAT -DHAVE_SQLITE -c gmlhandler.cpp  -fPIC
-DPIC -o ../o/.libs/gmlhandler.o

gmlhandler.cpp:1887: error: expected `}' at end of input

make[3]: *** [../o/gmlhandler.lo] Error 1

make[3]: Leaving directory `/opt/cots/gdal/ogr/ogrsf_frmts/gml'

make[2]: *** [gml-target] Error 2

make[2]: *** Waiting for unfinished jobs....

/bin/sh /opt/cots/gdal/libtool --mode=compile --tag=CXX g++
-I/opt/cots/gdal/port -I/opt/cots/gdal/gcore -I/opt/cots/gdal/alg
-I/opt/cots/gdal/ogr -I/opt/cots/gdal/ogr/ogrsf_frmts -I/opt/cots/gdal/gnm
-I/opt/cots/gdal/apps -DHAVE_SSSE3_AT_COMPILE_TIME
-DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall -Wextra -Winit-self
-Wunused-parameter -Wformat -Wshadow -Wnon-virtual-dtor
-Woverloaded-virtual -fno-operator-names  -DGNM_ENABLED
-I/opt/cots/gdal/port -I/usr/include/netcdf-3
-I/opt/cots/geotiff-1.4.0/include -I/opt/cots/tiff-4.0.0/include
-DGDAL_COMPILATION -c -o ../o/ehdrdataset.lo ehdrdataset.cpp





libtool: compile:  g++ -I/opt/cots/gdal/port -I/opt/cots/gdal/gcore
-I/opt/cots/gdal/alg -I/opt/cots/gdal/ogr -I/opt/cots/gdal/ogr/ogrsf_frmts
-I/opt/cots/gdal/gnm -I/opt/cots/gdal/apps -DHAVE_SSSE3_AT_COMPILE_TIME
-DHAVE_SSE_AT_COMPILE_TIME -g -O2 -Wall -Wextra -Winit-self
-Wunused-parameter -Wformat -Wshadow -Wnon-virtual-dtor
-Woverloaded-virtual -fno-operator-names -DSQLITE_ENABLED
-I/usr/include/libxml2 -DHAVE_LIBXML2 -I../frmts/gtiff -I../frmts/mem
-I../frmts/vrt -I../ogr -I../ogr/ogrsf_frmts/generic -I../gnm/
-I../gnm/gnm_frmts/ -I/opt/cots/gdal/ogr/ogrsf_frmts/geojson/libjson
-I../ogr/ogrsf_frmts/geojson -DGNM_ENABLED -I/opt/cots/gdal/port
-I/usr/include/netcdf-3 -I/opt/cots/geotiff-1.4.0/include
-I/opt/cots/tiff-4.0.0/include -DGDAL_COMPILATION -DPAM_ENABLED -c
gdalpamproxydb.cpp  -fPIC -DPIC -o .libs/gdalpamproxydb.o

make[3]: Leaving directory `/opt/cots/gdal/ogr/ogrsf_frmts/gmt'

make[2]: Leaving directory `/opt/cots/gdal/ogr/ogrsf_frmts'

make[1]: *** [sublibs] Error 2

make[1]: Leaving directory `/opt/cots/gdal/ogr'

make: *** [ogr-target] Error 2




Do you have any other idea to fix this issue? I do not know why this error
is appearing, becasuse in the past I compile and install gdal 1.8.X in the
same machine without any issue.

Can you help me? Thanks in advance!

El mié., 5 jun. 2019 a las 13:50, Andrew Bell (<andrew.bell.ia at gmail.com>)
escribió:

>
> Perhaps I'm missing something, but I'm seeing no throw specifications on
> my 2.1 source.  I'm guessing you're finding header files from a version
> that is different from the version you're trying to compile.  I'd search
> your system for "cpl_string.h" and compare with the include directories
> used during compilation.
>
> On Wed, Jun 5, 2019 at 6:30 AM Jorge Martin <jormarfe at gmail.com> wrote:
>
>> Hello,
>>
>> Trying to compile gdal 2.1.1 we are getting the following error:
>>
>>
>>
>> ./configure --with-libtiff=/opt/cots/tiff-4.0.0
>> --with-geotiff=/opt/cots/geotiff-1.4.0 --prefix=/opt/cots/gdal_v2
>>
>> make
>>
>>
>>
>> (cd port; make)
>>
>> make[1]: Entering directory `/data2/mvit/gdal-2.1.1/port'
>>
>> …….
>>
>> cpl_string.cpp: In function 'int CPLVASPrintf(char**, const char*,
>> __va_list_tag*)':
>>
>> cpl_string.cpp:1034: error: declaration of 'int CPLVASPrintf(char**,
>> const char*, __va_list_tag*)' throws different exceptions
>>
>> cpl_string.h:215: error: from previous declaration 'int
>> CPLVASPrintf(char**, const char*, __va_list_tag*) throw ()'
>>
>> cpl_string.cpp: In function 'int CPLvsnprintf(char*, size_t, const char*,
>> __va_list_tag*)':
>>
>> cpl_string.cpp:1124: error: declaration of 'int CPLvsnprintf(char*,
>> size_t, const char*, __va_list_tag*)' throws different exceptions
>>
>> cpl_string.h:195: error: from previous declaration 'int
>> CPLvsnprintf(char*, size_t, const char*, __va_list_tag*) throw ()'
>>
>> cpl_string.cpp: In function 'int CPLsnprintf(char*, size_t, const char*,
>> ...)':
>>
>> cpl_string.cpp:1305: error: declaration of 'int CPLsnprintf(char*,
>> size_t, const char*, ...)' throws different exceptions
>>
>> cpl_string.h:197: error: from previous declaration 'int
>> CPLsnprintf(char*, size_t, const char*, ...) throw ()'
>>
>>
>>
>> our system is Red Hat Enterprise Linux Server release 5.1 (Tikanga) and
>> we have installed previous version of gdal in the machine.
>>
>>
>>
>> We also have tried to install other versions such as 2.2.1, 2.2.2 and
>> 2.2.3 and we got the same error. The vesion that we have installed is
>> 1.8.1.
>>
>> Regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190606/6ba95b91/attachment-0001.html>

From epalacios at conabio.gob.mx  Thu Jun  6 08:46:44 2019
From: epalacios at conabio.gob.mx (Erick Palacios Moreno)
Date: Thu, 6 Jun 2019 10:46:44 -0500 (CDT)
Subject: [gdal-dev] gdalinfo's and rasterio's reading problem in LUSTRE
 FS with NetCDF file (ubuntu:bionic)
In-Reply-To: <3005920.Gpk7C3TN19@even-i700>
References: <68106617.17611179.1559760247488.JavaMail.zimbra@conabio.gob.mx>
 <3005920.Gpk7C3TN19@even-i700>
Message-ID: <58449794.18198379.1559836004702.JavaMail.zimbra@conabio.gob.mx>

Hi Even,

Thank you for your answer, we will discuss if it's an option using a different libhdf5 version.

Cheers,

Erick

----- Mensaje original -----
De: "Even Rouault" <even.rouault at spatialys.com>
Para: gdal-dev at lists.osgeo.org
CC: "Erick Palacios Moreno" <epalacios at conabio.gob.mx>
Enviados: Miércoles, 5 de Junio 2019 16:49:34
Asunto: Re: [gdal-dev] gdalinfo's and rasterio's reading problem in LUSTRE FS with NetCDF file (ubuntu:bionic)

On mercredi 5 juin 2019 13:44:07 CEST Erick Palacios Moreno wrote:
> Hi everyone,
> 
>  My team and I have been facing some problems when reading netcdf files in
> `LUSTRE` filesystem with `ncdump` tool regarding an HDF5 1.10.1 issue in
> `ubuntu:bionic` (see for example:
> https://github.com/ALPSCore/ALPSCore/issues/410)
> 
> We made a workaround by installing `netcdf-bin` using repositories of
> `ubuntu:xenial` in `bionic`. Although `ncdump` have successfully read the
> netcdf file, we couldn't fix it (sort of...) for `gdalinfo` and  `rasterio`
> for example:
> 
> this works:
> 
> ncdump /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc|head -n
> 20
> 
> gdalinfo /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc |head
> -n 20
> 
> gdalinfo -sd 1 /LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc
> |head -n 20
> 
> but this neither of next lines work:
> 
> gdalinfo
> netcdf:/LUSTRE/MADMEX/dir_test_mount/madmex_003_37_-32_1996-01-01.nc:blue_m
> ean

That one is weird, I mean that 'gdalinfo -sd 1 ...' works, but not 'gdalinfo 
netcdf:....', since the former internally invokes the later, but with the 
difference of an extra GDALOpen()/GDALClose().

I think you've already found the root cause of all this, that its that HDF5 
1.10 doesn't play well with LUSTRE, which causes those kind of weird/random 
failures. Nothing that GDAL can do about. So your best option is to build GDAL 
and libnetcdf against a libhdf5 version that plays well with LUSTRE, or copy 
locally the files.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hubbatov at mail.ru  Fri Jun  7 00:21:29 2019
From: hubbatov at mail.ru (hubbatov)
Date: Fri, 7 Jun 2019 00:21:29 -0700 (MST)
Subject: [gdal-dev] WCS driver disk cache
Message-ID: <1559892089062-0.post@n6.nabble.com>

Hi! Is it possible to cache server responds using WCS driver in GDAL? Like in
WMS driver ...

Thanks.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From cdelancy at blackfangtechnologies.com  Sun Jun  9 18:33:37 2019
From: cdelancy at blackfangtechnologies.com (CDelancy)
Date: Sun, 9 Jun 2019 18:33:37 -0700 (MST)
Subject: [gdal-dev] What is the correct way to read pixel data from a
 GDALRasterBand in C++?
Message-ID: <1560130417117-0.post@n6.nabble.com>

Using GDAL 3.0 in C++, how do I read pixel values from a raster band?

Essentially, I am looking for something akin to GetValue(int X, intY)
Unfortunately, with the documentation pages down,
https://gdal.org/classGDALRasterBand.html, I haven't been able to make much
headway on this.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gdal at stripfamily.net  Sun Jun  9 19:30:19 2019
From: gdal at stripfamily.net (David Strip)
Date: Sun, 9 Jun 2019 20:30:19 -0600
Subject: [gdal-dev] What is the correct way to read pixel data from a
 GDALRasterBand in C++?
In-Reply-To: <1560130417117-0.post@n6.nabble.com>
References: <1560130417117-0.post@n6.nabble.com>
Message-ID: <9364c523-f45f-9bc4-72de-9b215ba68c37@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190609/d96bc0c4/attachment.html>

From gdal at stripfamily.net  Sun Jun  9 19:24:21 2019
From: gdal at stripfamily.net (David Strip)
Date: Sun, 9 Jun 2019 20:24:21 -0600
Subject: [gdal-dev] Code example(s?) lost in migration to Sphinx
Message-ID: <d2c9b547-6706-279f-2ab7-7e4a620765bf@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190609/954b2a70/attachment.html>

From even.rouault at spatialys.com  Mon Jun 10 02:51:16 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jun 2019 11:51:16 +0200
Subject: [gdal-dev] Code example(s?) lost in migration to Sphinx
In-Reply-To: <d2c9b547-6706-279f-2ab7-7e4a620765bf@stripfamily.net>
References: <d2c9b547-6706-279f-2ab7-7e4a620765bf@stripfamily.net>
Message-ID: <2282270.mItDQAjlki@even-i700>

> Given the automated nature of the move to Sphinx, I wonder if this problem
> is occurring elsewhere in the docs. 

That should be fixed now. Please point if there are other occurences that have 
been missed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From belyakov-i at spsinf.ru  Mon Jun 10 10:09:26 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Mon, 10 Jun 2019 20:09:26 +0300
Subject: [gdal-dev] Can't configure GDAL build ("PROJ 6 symbols not found")
Message-ID: <9589041560186566@myt5-9da6df248f4a.qloud-c.yandex.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190610/8030fb29/attachment.html>

From jon.elliott at hexagon.com  Mon Jun 10 10:19:26 2019
From: jon.elliott at hexagon.com (jkellio2)
Date: Mon, 10 Jun 2019 10:19:26 -0700 (MST)
Subject: [gdal-dev] Getting database is locked error when writing to
 GeoPackage database.
In-Reply-To: <1559739840066-0.post@n6.nabble.com>
References: <1559738312918-0.post@n6.nabble.com>
 <1644741.kEspKtSYy2@even-i700> <1559739840066-0.post@n6.nabble.com>
Message-ID: <1560187166064-0.post@n6.nabble.com>

Just in case anyone was curious. The issue here was in the way I was reading
the result set layer the first time. I only read 1 feature (as that was all
I was interested in). Evidently that leaves the result set in a busy state.
I needed to either read the entire layer, i.e.

      OSGeo.OGR.Feature fea = layer.GetNextFeature();
      while ( fea != null )
      {
        s = fea.GetFieldAsString( "name" );
        layer.GetNextFeature();
      }

Or I needed to reset the layer after reading, i.e.

      OSGeo.OGR.Feature fea = layer.GetNextFeature();
      if ( fea != null )
      {
        s = fea.GetFieldAsString( "name" );
      }
      layer.ResetReading();

Once I did this I was able to write to the database the second time.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Jun 10 10:30:31 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jun 2019 19:30:31 +0200
Subject: [gdal-dev] Can't configure GDAL build ("PROJ 6 symbols not
	found")
In-Reply-To: <9589041560186566@myt5-9da6df248f4a.qloud-c.yandex.net>
References: <9589041560186566@myt5-9da6df248f4a.qloud-c.yandex.net>
Message-ID: <21084953.DSvBD5S4hR@even-i700>

> I also tried ./configure --with-proj=/usr/local/lib

Must be:

./configure --with-proj=/usr/local

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jun 10 10:34:04 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jun 2019 19:34:04 +0200
Subject: [gdal-dev] Getting database is locked error when writing to
	GeoPackage database.
In-Reply-To: <1560187166064-0.post@n6.nabble.com>
References: <1559738312918-0.post@n6.nabble.com>
 <1559739840066-0.post@n6.nabble.com> <1560187166064-0.post@n6.nabble.com>
Message-ID: <70918972.uOBcNmDHrg@even-i700>

On lundi 10 juin 2019 10:19:26 CEST jkellio2 wrote:
> Just in case anyone was curious. The issue here was in the way I was reading
> the result set layer the first time. I only read 1 feature (as that was all
> I was interested in). Evidently that leaves the result set in a busy state.
> I needed to either read the entire layer, i.e.
> 
>       OSGeo.OGR.Feature fea = layer.GetNextFeature();
>       while ( fea != null )
>       {
>         s = fea.GetFieldAsString( "name" );
>         layer.GetNextFeature();
>       }
> 
> Or I needed to reset the layer after reading, i.e.
> 
>       OSGeo.OGR.Feature fea = layer.GetNextFeature();
>       if ( fea != null )
>       {
>         s = fea.GetFieldAsString( "name" );
>       }
>       layer.ResetReading();
> 
> Once I did this I was able to write to the database the second time.

Ah, I missed that. Actually layer.ResetReading() is probably not enough and 
leaks memory.

Layers acquired with layer = ogrDataSource.ExecuteSQL() must be explicitly 
deallocated with
ogrDataSource.ReleaseResultSet(layer)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jon.elliott at hexagon.com  Mon Jun 10 10:45:26 2019
From: jon.elliott at hexagon.com (jkellio2)
Date: Mon, 10 Jun 2019 10:45:26 -0700 (MST)
Subject: [gdal-dev] Getting database is locked error when writing to
 GeoPackage database.
In-Reply-To: <70918972.uOBcNmDHrg@even-i700>
References: <1559738312918-0.post@n6.nabble.com>
 <1644741.kEspKtSYy2@even-i700> <1559739840066-0.post@n6.nabble.com>
 <1560187166064-0.post@n6.nabble.com> <70918972.uOBcNmDHrg@even-i700>
Message-ID: <1560188726288-0.post@n6.nabble.com>

Thanks! Adding the ReleaseResultSet call was my next adjustment after
reviewing some of my C++ code. I was just examining if Dispose was
sufficient to clean up or if I needed to explicitly call ReleaseResultSet.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From nyall.dawson at gmail.com  Mon Jun 10 21:17:10 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Tue, 11 Jun 2019 14:17:10 +1000
Subject: [gdal-dev] Getting actual path to a layer
Message-ID: <CAB28Ashp7k6jfWG_7zuvgDeYmrrrUmmLQwArhFPN7u0Jp1ywng@mail.gmail.com>

Hi list,

If I have a bunch of say shapefiles in a folder, OGR is happy to let
me access these as a dataset, e.g.

da = r"/home/nyall/dev/QGIS/tests/testdata"
driver = ogr.GetDriverByName('ESRI Shapefile')
dataSource = driver.Open(da, 0)

for i in dataSource:
    print(i.GetName())

My question is -- GetName() here returns just the file base name (i.e.
"lines" for "/path/lines.shp"). Is there anyway to retrieve the actual
layer file path for these?

Nyall

From gdal at stripfamily.net  Mon Jun 10 21:47:11 2019
From: gdal at stripfamily.net (David Strip)
Date: Mon, 10 Jun 2019 22:47:11 -0600
Subject: [gdal-dev] Getting actual path to a layer
In-Reply-To: <CAB28Ashp7k6jfWG_7zuvgDeYmrrrUmmLQwArhFPN7u0Jp1ywng@mail.gmail.com>
References: <CAB28Ashp7k6jfWG_7zuvgDeYmrrrUmmLQwArhFPN7u0Jp1ywng@mail.gmail.com>
Message-ID: <0a4a9881-7cbf-0ed4-0c39-9f74d9f51808@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190610/361cd806/attachment.html>

From even.rouault at spatialys.com  Tue Jun 11 00:32:02 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 09:32:02 +0200
Subject: [gdal-dev] Getting actual path to a layer
In-Reply-To: <0a4a9881-7cbf-0ed4-0c39-9f74d9f51808@stripfamily.net>
References: <CAB28Ashp7k6jfWG_7zuvgDeYmrrrUmmLQwArhFPN7u0Jp1ywng@mail.gmail.com>
 <0a4a9881-7cbf-0ed4-0c39-9f74d9f51808@stripfamily.net>
Message-ID: <8621435.L28ygo59zm@even-i700>

On lundi 10 juin 2019 22:47:11 CEST David Strip wrote:
> The docs say that the return value of GetName()
> should be sufficient to open the data source if passed to the same
> OGRSFDriver that this data source was opened with, but it need not be
> exactly the same string that was used to open the data source.

You are refering here it to OGRDataSource::GetName(), whereas Nyall was 
refering to OGRLayer::GetName()

> My question is -- GetName() here returns just the file base name (i.e.
> "lines" for "/path/lines.shp"). Is there anyway to retrieve the actual
> layer file path for these?

No, for most formats, there is no direct mapping from a layer to file(s) 
containing layer data, so there is nothing in the OGR API for that. So you 
have to use the knowledge that this is opened by the shapefile or mapinfo + 
that the datasource name is a directory, and then you can form a filename from 
that and the layer name.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Michel.Dastous at bentley.com  Tue Jun 11 05:46:54 2019
From: Michel.Dastous at bentley.com (Michel Dastous)
Date: Tue, 11 Jun 2019 12:46:54 +0000
Subject: [gdal-dev] C4251 warnings in VS2017
Message-ID: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>

Hi all,

I know this is an old issue (according to this ticket https://trac.osgeo.org/gdal/ticket/4099), but surprisingly Im still getting C4251 warnings on VS2017 and GDAL 3 if my project is compiled with /W2 or more.   It occurs as soon as I include ogrsf_frmts.h

Sample warning message:
1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:  'OGRStyleTable::osLastRequestedStyleName': class 'CPLString' needs to have dll-interface to be used by clients of class 'OGRStyleTable'
1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:     CPLString osLastRequestedStyleName{};
1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:                                         ^

Is it still an ongoing issue or am I missing some compile option?

Thanks,

Michel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/faaf099f/attachment.html>

From belyakov-i at spsinf.ru  Tue Jun 11 06:15:40 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Tue, 11 Jun 2019 16:15:40 +0300
Subject: [gdal-dev] Undefined references to proj_* functions while building
	GDAL
Message-ID: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/d1b0693a/attachment.html>

From mateusz at loskot.net  Tue Jun 11 07:14:14 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 11 Jun 2019 16:14:14 +0200
Subject: [gdal-dev] C4251 warnings in VS2017
In-Reply-To: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
References: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
Message-ID: <CABUeae-rGiWcOCrZN4mpYvPaCgoVCUsCRPN9zcekz4n4jRNdZw@mail.gmail.com>

On Tue, 11 Jun 2019 at 14:46, Michel Dastous <Michel.Dastous at bentley.com> wrote:
>
> Sample warning message:
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:  'OGRStyleTable::osLastRequestedStyleName': class 'CPLString' needs to have dll-interface to be used by clients of class 'OGRStyleTable'
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:     CPLString osLastRequestedStyleName{};
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:                                         ^
>
> Is it still an ongoing issue or am I missing some compile option?

What makes you think it is an ongoing issue, has an issue been
even reported, opened, PR-ed?

There is no ongoing project or activity with aim to free GDAL from
all warnings. Warnings are cleaned as they are noticed and some
remain unnoticed for long or very long time.

Pull requests are welcome, as usual.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From Michel.Dastous at bentley.com  Tue Jun 11 07:20:17 2019
From: Michel.Dastous at bentley.com (Michel Dastous)
Date: Tue, 11 Jun 2019 14:20:17 +0000
Subject: [gdal-dev] C4251 warnings in VS2017
In-Reply-To: <CABUeae-rGiWcOCrZN4mpYvPaCgoVCUsCRPN9zcekz4n4jRNdZw@mail.gmail.com>
References: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <CABUeae-rGiWcOCrZN4mpYvPaCgoVCUsCRPN9zcekz4n4jRNdZw@mail.gmail.com>
Message-ID: <BYAPR19MB2695DD5A6458CD42703512C79BED0@BYAPR19MB2695.namprd19.prod.outlook.com>

Hi Mateusz,

Im asking because ticket #4099 was closed saying it should no longer be an issue with MSVC2015, so I was expecting it to be fixed in VS2017.  I can re-open the bug if needed but wanted to check if I was not the only one seeing this.

Thanks,


Michel

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Mateusz Loskot
Sent: Tuesday, June 11, 2019 10:14 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] C4251 warnings in VS2017

On Tue, 11 Jun 2019 at 14:46, Michel Dastous <Michel.Dastous at bentley.com> wrote:
>
> Sample warning message:
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:  'OGRStyleTable::osLastRequestedStyleName': class 'CPLString' needs to have dll-interface to be used by clients of class 'OGRStyleTable'
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:     CPLString osLastRequestedStyleName{};
> 1>e:\mapserverlibs\include\ogr_featurestyle.h(89,41): warning C4251:                                         ^
>
> Is it still an ongoing issue or am I missing some compile option?

What makes you think it is an ongoing issue, has an issue been even reported, opened, PR-ed?

There is no ongoing project or activity with aim to free GDAL from all warnings. Warnings are cleaned as they are noticed and some remain unnoticed for long or very long time.

Pull requests are welcome, as usual.

Best regards,
--
Mateusz Loskot, https://urldefense.proofpoint.com/v2/url?u=http-3A__mateusz.loskot.net&d=DwIGaQ&c=hmGTLOph1qd_VnCqj81HzEWkDaxmYdIWRBdoFggzhj8&r=Vg9kd7EbrjaIP-YEICx-iglQdpQnMN_4TPeo-J6QxGE&m=9sJ-wM3_RImX_NxoSn_ezaXoOYr2jBWDMfqznyuhWwo&s=gBeUkCEInaSRDuS5cGhZSYmIpejPfVdVfSudz-mTGqk&e=
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://urldefense.proofpoint.com/v2/url?u=https-3A__lists.osgeo.org_mailman_listinfo_gdal-2Ddev&d=DwIGaQ&c=hmGTLOph1qd_VnCqj81HzEWkDaxmYdIWRBdoFggzhj8&r=Vg9kd7EbrjaIP-YEICx-iglQdpQnMN_4TPeo-J6QxGE&m=9sJ-wM3_RImX_NxoSn_ezaXoOYr2jBWDMfqznyuhWwo&s=-SFKSjqhTMPLFQbc-9IaoiEM7RLwDFDWKXL6RBDrmIQ&e= 

From even.rouault at spatialys.com  Tue Jun 11 07:36:41 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 16:36:41 +0200
Subject: [gdal-dev] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <42081947.AsHn9XMMPI@even-i700>
References: <42081947.AsHn9XMMPI@even-i700>
Message-ID: <21374810.ZVL2DVXZTU@even-i700>

Hi,

the last bits (points 1, 2 and 3) are now available in GDAL master.

Doc at https://gdal.org/drivers/raster/cog.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Tue Jun 11 07:37:46 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 11 Jun 2019 16:37:46 +0200
Subject: [gdal-dev] C4251 warnings in VS2017
In-Reply-To: <BYAPR19MB2695DD5A6458CD42703512C79BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
References: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <CABUeae-rGiWcOCrZN4mpYvPaCgoVCUsCRPN9zcekz4n4jRNdZw@mail.gmail.com>
 <BYAPR19MB2695DD5A6458CD42703512C79BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
Message-ID: <CABUeae8aP4kttfrKO_F19FW2sXBE9c67PeuYuOMM4L9ymJqexA@mail.gmail.com>

On Tue, 11 Jun 2019 at 16:20, Michel Dastous <Michel.Dastous at bentley.com> wrote:
>
> Im asking because ticket #4099 was closed saying it should no longer be an issue with MSVC2015, so I was expecting it to be fixed in VS2017.

Right, I missed that one.

Chances are some recent tweaks, even the empty initializer list, triggered
that again for the member. Just ignore it (even with #pragma
warning(disable:4251)
in your code).

[1] """
I recommend avoiding this in the first place - putting STL types in
your DLL's interface
forces you to play by the STL's rules (specifically, you can't mix
different major versions
of VC, and your IDL settings must match).
However, there is a workaround. C4251 is essentially noise and can be
silenced...

Stephan T. Lavavej (one of the maintainer's of Micrsoft's C++ library).
"""

[1] https://web.archive.org/web/20130317015847/http://connect.microsoft.com/VisualStudio/feedback/details/696593/vc-10-vs-2010-basic-string-exports

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From vincent.sarago at gmail.com  Tue Jun 11 07:48:22 2019
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Tue, 11 Jun 2019 10:48:22 -0400
Subject: [gdal-dev] [COG] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <21374810.ZVL2DVXZTU@even-i700>
References: <42081947.AsHn9XMMPI@even-i700> <21374810.ZVL2DVXZTU@even-i700>
Message-ID: <8088AEF1-886C-4576-AE72-784E1F0BC627@gmail.com>

Thanks Even,

Just a quick note. By reading the docs it seems the overviews will be created by default except if OVERVIEWS=FORCE_USE_EXISTING is set and if the input file doesn’t have overviews. The specs make overviews optional thus the OVERVIEWS option usage seems a bit odd. 

TBH, I’m 100% with creating overviews by default and I think they should not be optional, but users that don’t want overviews might found the usage a bit complicated. 

Vincent

> Le 11 juin 2019 à 10:36, Even Rouault <even.rouault at spatialys.com> a écrit :
> 
> Hi,
> 
> the last bits (points 1, 2 and 3) are now available in GDAL master.
> 
> Doc at https://gdal.org/drivers/raster/cog.html
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> COG mailing list
> COG at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/cog


From even.rouault at spatialys.com  Tue Jun 11 07:48:48 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 16:48:48 +0200
Subject: [gdal-dev] C4251 warnings in VS2017
In-Reply-To: <CABUeae8aP4kttfrKO_F19FW2sXBE9c67PeuYuOMM4L9ymJqexA@mail.gmail.com>
References: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <BYAPR19MB2695DD5A6458CD42703512C79BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <CABUeae8aP4kttfrKO_F19FW2sXBE9c67PeuYuOMM4L9ymJqexA@mail.gmail.com>
Message-ID: <2347596.OobankriuD@even-i700>

On mardi 11 juin 2019 16:37:46 CEST Mateusz Loskot wrote:
> On Tue, 11 Jun 2019 at 16:20, Michel Dastous <Michel.Dastous at bentley.com> 
wrote:
> > Im asking because ticket #4099 was closed saying it should no longer be an
> > issue with MSVC2015, so I was expecting it to be fixed in VS2017.
> Right, I missed that one.

I think we would accept a pull request that would change public header files 
that trigger that warning to essentially do (untested !)

#ifdef _MSC_VER
#pragma warning( push )
#pragma warning( disable : 4251 ) // class 'foo' needs to have dll-interface
#endif

...

#ifdef _MSC_VER
#pragma warning( pop )
#endif

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jun 11 08:20:35 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 17:20:35 +0200
Subject: [gdal-dev] [COG] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <8088AEF1-886C-4576-AE72-784E1F0BC627@gmail.com>
References: <42081947.AsHn9XMMPI@even-i700> <21374810.ZVL2DVXZTU@even-i700>
 <8088AEF1-886C-4576-AE72-784E1F0BC627@gmail.com>
Message-ID: <1978857.JJMrgQGLvu@even-i700>

Vincent,

> Just a quick note. By reading the docs it seems the overviews will be
> created by default except if OVERVIEWS=FORCE_USE_EXISTING is set and if the
> input file doesn’t have overviews. The specs make overviews optional thus
> the OVERVIEWS option usage seems a bit odd.

Agreed that's a bit convoluted. I've added support for OVERVIEWS=NONE to 
decrease the quantity of caffeine needed to generate a COG without overviews 
:-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From vincent.sarago at gmail.com  Tue Jun 11 08:21:31 2019
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Tue, 11 Jun 2019 11:21:31 -0400
Subject: [gdal-dev] [COG] Upcoming Cloud Optimized Geotiff (COG) related
	enhancements
In-Reply-To: <1978857.JJMrgQGLvu@even-i700>
References: <42081947.AsHn9XMMPI@even-i700> <21374810.ZVL2DVXZTU@even-i700>
 <8088AEF1-886C-4576-AE72-784E1F0BC627@gmail.com>
 <1978857.JJMrgQGLvu@even-i700>
Message-ID: <59F2D98D-4F58-4C66-8B1E-FBF438521799@gmail.com>

Thanks Even 

> Le 11 juin 2019 à 11:20, Even Rouault <even.rouault at spatialys.com> a écrit :
> 
> Vincent,
> 
>> Just a quick note. By reading the docs it seems the overviews will be
>> created by default except if OVERVIEWS=FORCE_USE_EXISTING is set and if the
>> input file doesn’t have overviews. The specs make overviews optional thus
>> the OVERVIEWS option usage seems a bit odd.
> 
> Agreed that's a bit convoluted. I've added support for OVERVIEWS=NONE to 
> decrease the quantity of caffeine needed to generate a COG without overviews 
> :-)
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From jane at fybr.ca  Tue Jun 11 09:40:22 2019
From: jane at fybr.ca (Jane Wang)
Date: Tue, 11 Jun 2019 09:40:22 -0700
Subject: [gdal-dev] Inserting PDF image to geoPDF
Message-ID: <CA+m3KtqJD7MFSGijPcDv+0MEMdJsY+oMJyneoER+e432=joWqA@mail.gmail.com>

Dear gdal-dev team,

I am attempting to insert a (non-georeferenced) PDF image containing map
legend and company logo using -co EXTRA_IMAGES=legend.pdf for my
gdal_translate -of PDF command.

However, in my output geoPDF document, the legend.pdf image has been
rasterised which is not desired. I wonder if there is a work-around for
this, or if I am not doing it correctly?

I am able to output the legend containing some text and geometric shapes
into other vector formats. i.e. .svg but it did not make a difference on
the map output.

Thank you very much, please let me know if I can provide additional
information / documents.

Regards,
Jane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/9f203e49/attachment.html>

From even.rouault at spatialys.com  Tue Jun 11 10:16:47 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 19:16:47 +0200
Subject: [gdal-dev] Inserting PDF image to geoPDF
In-Reply-To: <CA+m3KtqJD7MFSGijPcDv+0MEMdJsY+oMJyneoER+e432=joWqA@mail.gmail.com>
References: <CA+m3KtqJD7MFSGijPcDv+0MEMdJsY+oMJyneoER+e432=joWqA@mail.gmail.com>
Message-ID: <2358242.kWPYtUVOos@even-i700>

On mardi 11 juin 2019 09:40:22 CEST Jane Wang wrote:
> Dear gdal-dev team,
> 
> I am attempting to insert a (non-georeferenced) PDF image containing map
> legend and company logo using -co EXTRA_IMAGES=legend.pdf for my
> gdal_translate -of PDF command.
> 
> However, in my output geoPDF document, the legend.pdf image has been
> rasterised which is not desired. I wonder if there is a work-around for
> this, or if I am not doing it correctly?

Yes, PDF files passed to EXTRA_IMAGES will be rasterized.

A possibility, requiring GDAL 3.0, is to use the new approach using a XML composition file :
https://gdal.org/drivers/raster/pdf.html#creation-of-pdf-file-from-a-xml-composition-file-gdal-3-0

With that, you can include a PDF, and its content will be inserted 'as it'.
That said, there is a restriction currently that the dimensions of the inserted PDF must
be identical to the ones of the output PDF.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From belyakov-i at spsinf.ru  Tue Jun 11 10:28:01 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Tue, 11 Jun 2019 20:28:01 +0300
Subject: [gdal-dev] Undefined references to proj_* functions while
	building GDAL
In-Reply-To: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
Message-ID: <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/988da12b/attachment-0001.html>

From mateusz at loskot.net  Tue Jun 11 10:36:38 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 11 Jun 2019 19:36:38 +0200
Subject: [gdal-dev] C4251 warnings in VS2017
In-Reply-To: <2347596.OobankriuD@even-i700>
References: <BYAPR19MB26958DB88B2B0788B7B96EA19BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <BYAPR19MB2695DD5A6458CD42703512C79BED0@BYAPR19MB2695.namprd19.prod.outlook.com>
 <CABUeae8aP4kttfrKO_F19FW2sXBE9c67PeuYuOMM4L9ymJqexA@mail.gmail.com>
 <2347596.OobankriuD@even-i700>
Message-ID: <20190611173638.rzdvwpk4aikjbddf@DEV604.cadcorp.net>

On 19-06-11 16:48:48, Even Rouault wrote:
>On mardi 11 juin 2019 16:37:46 CEST Mateusz Loskot wrote:
>> On Tue, 11 Jun 2019 at 16:20, Michel Dastous <Michel.Dastous at bentley.com>
>wrote:
>> > Im asking because ticket #4099 was closed saying it should no longer be an
>> > issue with MSVC2015, so I was expecting it to be fixed in VS2017.
>> Right, I missed that one.
>
>I think we would accept a pull request that would change public header files
>that trigger that warning to essentially do (untested !)
>
>#ifdef _MSC_VER
>#pragma warning( push )
>#pragma warning( disable : 4251 ) // class 'foo' needs to have dll-interface
>#endif
>
>...
>
>#ifdef _MSC_VER
>#pragma warning( pop )
>#endif

Indeed, and that's perfectly reasonable solution for this issue.

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Fingerprint=C081 EA1B 4AFB 7C19 38BA  9C88 928D 7C2A BB2A C1F2

From even.rouault at spatialys.com  Tue Jun 11 10:39:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Jun 2019 19:39:17 +0200
Subject: [gdal-dev] Undefined references to proj_* functions while
	building GDAL
In-Reply-To: <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
 <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
Message-ID: <2802545.M12HXQ5pD2@even-i700>

On mardi 11 juin 2019 20:28:01 CEST Igor Belyakov wrote:
> I also checked (with readelf) if my libproj files contain those symbols.
> There are libproj.a, libproj.so, libproj.so.15 and libproj.so.15.1.0 files
> in usr/local/lib and they all contain symbol `proj_alter_name'. But for
> some reason the linker cannot find it.

you may need to add /usr/local/lib to your /etc/ld.so.conf or define the 
LD_LIBRARY_PATH=/usr/local/lib environment variable.
GDAL build process doesn't set RPATH by default.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From belyakov-i at spsinf.ru  Tue Jun 11 11:26:57 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Tue, 11 Jun 2019 21:26:57 +0300
Subject: [gdal-dev] Undefined references to proj_* functions while
	building GDAL
In-Reply-To: <2802545.M12HXQ5pD2@even-i700>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
 <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
 <2802545.M12HXQ5pD2@even-i700>
Message-ID: <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/ed147037/attachment.html>

From andrew.bell.ia at gmail.com  Tue Jun 11 12:21:13 2019
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 11 Jun 2019 15:21:13 -0400
Subject: [gdal-dev] Undefined references to proj_* functions while
 building GDAL
In-Reply-To: <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
 <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
 <2802545.M12HXQ5pD2@even-i700>
 <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>
Message-ID: <CACJ51z1gj7WM=pWrzKC85VeRnJ6=OJEeAD8rT2v8HdgZjWoyew@mail.gmail.com>

In order to help, you should provide the link line -- at least the part of
it that contains the library directory references.  Building GDAL is tricky
and it's easy locate the wrong library/headers.  You should also locate
other proj libraries on your system that might be getting found.

On Tue, Jun 11, 2019 at 2:27 PM Igor Belyakov <belyakov-i at spsinf.ru> wrote:

> $ export LD_LIBRARY_PATH=/usr/local/lib; make
> - doesn't work either.
> And /usr/local/lib is already in /etc/ld.so.conf
> (to be exact, it's in /etc/ld.so.conf.d/libc.conf that is included in
> /etc/ld.so.conf with "include /etc/ld.so.conf.d/*.conf")
>
> 11.06.2019, 20:39, "Even Rouault" <even.rouault at spatialys.com>:
>
> On mardi 11 juin 2019 20:28:01 CEST Igor Belyakov wrote:
>
>  I also checked (with readelf) if my libproj files contain those symbols.
>  There are libproj.a, libproj.so, libproj.so.15 and libproj.so.15.1.0 files
>  in usr/local/lib and they all contain symbol `proj_alter_name'. But for
>  some reason the linker cannot find it.
>
>
> you may need to add /usr/local/lib to your /etc/ld.so.conf or define the
> LD_LIBRARY_PATH=/usr/local/lib environment variable.
> GDAL build process doesn't set RPATH by default.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/58a71127/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun 11 13:43:43 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 11 Jun 2019 13:43:43 -0700 (MST)
Subject: [gdal-dev] Html formatted mails WAS: Undefined references to proj_*
 functions while building GDAL
In-Reply-To: <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
 <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
 <2802545.M12HXQ5pD2@even-i700>
 <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>
Message-ID: <1560285823036-0.post@n6.nabble.com>

Hi Igor,

Your mail program writes nice html formatted text but unfortunately it makes
it somewhat harder to read the mails directly from the mail archive.
Example: https://lists.osgeo.org/pipermail/gdal-dev/2019-June/050395.html
shows just this:

An HTML attachment was scrubbed...
URL:
<http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190611/988da12b/attachment-0001.html>

Looks good through Nabble, though.

-Jukka Rahkonen-




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From cchhnhk at gmail.com  Tue Jun 11 20:42:12 2019
From: cchhnhk at gmail.com (Changhai Chen)
Date: Wed, 12 Jun 2019 11:42:12 +0800
Subject: [gdal-dev] Convert WGS84 geodetic coordinate to local ENU(local
 Cartesian coordinates coordinate system)
Message-ID: <CAOLjhNnd9c7p+Jpt=cCiGpN3C1X=57M5Vi7WBJ5RB86EpXCAfg@mail.gmail.com>

Hello. Is there any method in GDAL that can convert WGS84 geodetic
coordinate to local ENU(local tangent plane)？
First: GDAL can transform point coordinate from WGS84 geodetic  coordinate
system to WGS84 XYZ (or ECEF ).
Second: but WGS84 XYZ (or ECEF ) to local ENU can not be transformed. I can
fix it by using another tool, but it will be better if GDAL have this
convesion.
Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190612/af7e4531/attachment.html>

From even.rouault at spatialys.com  Wed Jun 12 02:00:22 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jun 2019 11:00:22 +0200
Subject: [gdal-dev] Convert WGS84 geodetic coordinate to local ENU(local
	Cartesian coordinates coordinate system)
In-Reply-To: <CAOLjhNnd9c7p+Jpt=cCiGpN3C1X=57M5Vi7WBJ5RB86EpXCAfg@mail.gmail.com>
References: <CAOLjhNnd9c7p+Jpt=cCiGpN3C1X=57M5Vi7WBJ5RB86EpXCAfg@mail.gmail.com>
Message-ID: <2782670.6I6GVQEeHe@even-i700>

On mercredi 12 juin 2019 11:42:12 CEST Changhai Chen wrote:
> Hello. Is there any method in GDAL that can convert WGS84 geodetic
> coordinate to local ENU(local tangent plane)？
> First: GDAL can transform point coordinate from WGS84 geodetic  coordinate
> system to WGS84 XYZ (or ECEF ).
> Second: but WGS84 XYZ (or ECEF ) to local ENU can not be transformed. I can
> fix it by using another tool, but it will be better if GDAL have this
> convesion.

That should be implemented as a new coordinate operation in PROJ. There's a 
description for this method in the IOGP Guidance note 7.2.

http://www.epsg.org/Portals/0/373-07-02.pdf , page 97, 	"2.2.2 Geocentric/
topocentric conversions"

Contributions welcome

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kreve at sdfe.dk  Wed Jun 12 02:23:18 2019
From: kreve at sdfe.dk (Kristian Evers)
Date: Wed, 12 Jun 2019 09:23:18 +0000
Subject: [gdal-dev] Convert WGS84 geodetic coordinate to local
	ENU(local	Cartesian coordinates coordinate system)
In-Reply-To: <2782670.6I6GVQEeHe@even-i700>
References: <CAOLjhNnd9c7p+Jpt=cCiGpN3C1X=57M5Vi7WBJ5RB86EpXCAfg@mail.gmail.com>
 <2782670.6I6GVQEeHe@even-i700>
Message-ID: <2E885BB293AF0448A0181138489E9A0EB15917F5@S000014.PROD.SITAD.DK>

Here's the relevant PROJ issue should someone want to give this a go

https://github.com/OSGeo/PROJ/issues/500

/Kristian

-----Oprindelig meddelelse-----
Fra: gdal-dev <gdal-dev-bounces at lists.osgeo.org> På vegne af Even Rouault
Sendt: 12. juni 2019 11:00
Til: gdal-dev at lists.osgeo.org
Cc: Changhai Chen <cchhnhk at gmail.com>
Emne: Re: [gdal-dev] Convert WGS84 geodetic coordinate to local ENU(local Cartesian coordinates coordinate system)

On mercredi 12 juin 2019 11:42:12 CEST Changhai Chen wrote:
> Hello. Is there any method in GDAL that can convert WGS84 geodetic
> coordinate to local ENU(local tangent plane)？
> First: GDAL can transform point coordinate from WGS84 geodetic  coordinate
> system to WGS84 XYZ (or ECEF ).
> Second: but WGS84 XYZ (or ECEF ) to local ENU can not be transformed. I can
> fix it by using another tool, but it will be better if GDAL have this
> convesion.

That should be implemented as a new coordinate operation in PROJ. There's a 
description for this method in the IOGP Guidance note 7.2.

http://www.epsg.org/Portals/0/373-07-02.pdf , page 97, 	"2.2.2 Geocentric/
topocentric conversions"

Contributions welcome

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Wed Jun 12 14:17:09 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jun 2019 23:17:09 +0200
Subject: [gdal-dev] Next maintenance releases
Message-ID: <2205252.J8fbBk9D11@even-i700>

Hi,

I'm considering issuing GDAL 2.4.2 and 3.0.1 releases on Friday 28 June. 
Alternate volunteers are welcome as usual :-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From rykovd at gmail.com  Wed Jun 12 18:21:12 2019
From: rykovd at gmail.com (Denis Rykov)
Date: Thu, 13 Jun 2019 03:21:12 +0200
Subject: [gdal-dev] Using pseudo-field FID as ID_FIELD for GeoJSON
Message-ID: <CAJbvKNraRGvtXcXevqOGp_4h2UyW9T_sF0kBB4U8FiL4hexoAA@mail.gmail.com>

Is it possible to reflect fids values of features of original layer while
exporting it to GeoJSON?
Usage of "-lco ID_FIELD=FID" doesn't help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190613/258ff46e/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 13 00:30:40 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 13 Jun 2019 00:30:40 -0700 (MST)
Subject: [gdal-dev] Using pseudo-field FID as ID_FIELD for GeoJSON
In-Reply-To: <CAJbvKNraRGvtXcXevqOGp_4h2UyW9T_sF0kBB4U8FiL4hexoAA@mail.gmail.com>
References: <CAJbvKNraRGvtXcXevqOGp_4h2UyW9T_sF0kBB4U8FiL4hexoAA@mail.gmail.com>
Message-ID: <1560411040085-0.post@n6.nabble.com>

Hi,

Have you tried "-preserve_fid"
https://gdal.org/programs/ogr2ogr.html#ogr2ogr ?

-Jukka Rahkonen-


dr wrote
> Is it possible to reflect fids values of features of original layer while
> exporting it to GeoJSON?
> Usage of "-lco ID_FIELD=FID" doesn't help.





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From belyakov-i at spsinf.ru  Thu Jun 13 02:49:00 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Thu, 13 Jun 2019 12:49:00 +0300
Subject: [gdal-dev] Undefined references to proj_* functions while
	building GDAL
In-Reply-To: <CACJ51z1gj7WM=pWrzKC85VeRnJ6=OJEeAD8rT2v8HdgZjWoyew@mail.gmail.com>
References: <15525471560258940@myt5-184376c2d7f8.qloud-c.yandex.net>
 <16590271560274081@myt1-4903e6646a45.qloud-c.yandex.net>
 <2802545.M12HXQ5pD2@even-i700>
 <16789771560277617@iva3-bb39b28eb4f4.qloud-c.yandex.net>
 <CACJ51z1gj7WM=pWrzKC85VeRnJ6=OJEeAD8rT2v8HdgZjWoyew@mail.gmail.com>
Message-ID: <22386141560419340@iva1-9be92bdead40.qloud-c.yandex.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190613/416acc75/attachment.html>

From jonathanlakethomas at astuntechnology.com  Thu Jun 13 06:26:48 2019
From: jonathanlakethomas at astuntechnology.com (Jonathan Lake-Thomas)
Date: Thu, 13 Jun 2019 14:26:48 +0100
Subject: [gdal-dev] GDAL3.0.0 ogr2ogr and ogrinfo on Windows
Message-ID: <CAHnqONwEzP8abjrTk+u-L=ygj=rOvL7RzPHMhyjMFXij-DFQ+g@mail.gmail.com>

We've been using the windows builds from the gisinternals.com site for a
while now. For ease of access from our application we used to place the
executables and libraries in a single folder. This seemed to work OK and we
only needed a setting for the path to this folder and the gdal-data folder.

Starting with GDAL 3.0.0, it now seems necessary to also specify a PROJ_LIB
path and also add the path of the common components such as gdal300.dll to
the path, this is in addition to the path to the ogr2ogr and ogrinfo
executables. We found that placing everything in the same folder, as we had
done previously, was causing a problem with ogrinfo. ogrinfo does not seem
to write to standard output correctly when placed in the same folder as the
common components.

Would anyone be able to comment as to whether this behaviour in GDAL 3.0.0
is expected?

Many thanks.

-- 
-- 
*Sign up to our mailing list 
<https://astuntechnology.com/company/#email-updates> for updates on news, 
products, conferences, events and training*
*
*

Astun Technology Ltd, The 
Coach House, 17 West Street, Epsom, Surrey, KT18 7RL, UK 
t:+44 1372 744 
009 w: astuntechnology.com <http://astuntechnology.com/> twitter:@astuntech 
<https://twitter.com/astuntech>



iShare - enterprise geographic 
intelligence platform <https://astuntechnology.com/ishare/>
GeoServer, 
PostGIS and QGIS training <https://astuntechnology.com/services/#training>

Helpdesk and customer portal 
<http://support.astuntechnology.com/support/login>




Company registration 
no. 5410695. Registered in England and Wales. Registered office: 120 Manor 
Green Road, Epsom, Surrey, KT19 8LN VAT no. 864201149.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190613/06782bc7/attachment.html>

From chiara.marmo at u-psud.fr  Thu Jun 13 08:05:31 2019
From: chiara.marmo at u-psud.fr (Chiara Marmo)
Date: Thu, 13 Jun 2019 15:05:31 +0000 (GMT)
Subject: [gdal-dev] GDAL linked against CFITSIO on debian/ubuntu
In-Reply-To: <381566530.19250240.1560435384481.JavaMail.zimbra@u-psud.fr>
Message-ID: <341525187.19321965.1560438331822.JavaMail.zimbra@u-psud.fr>

Hello,

I'm checking different OS and distributions for GDAL link against CFITSIO. I was pretty sure that Ubuntu and Debian allow the use of CFITSIO but apparently Ubuntu 18.04 does not...
I've found a "--with-cifitsio=no" in the debian versioning system [1].... but I can't test debian right now.

On Fedora the gdal package checks for the presence of CFITSIO and links against it if found.

Is someone in this list close to debian/ubuntu packagers?
Am I wrong?

Thanks for listening.
Best

Chiara


[1] https://salsa.debian.org/debian-gis-team/gdal/blob/master/debian/rules#L116

-- 
Chiara Marmo
Ingénieur de Recherche GEOPS - Paris Sud-11
Bât 509
Tel: +33 (0)1 69 15 49 03 

From sebastic at xs4all.nl  Thu Jun 13 08:33:00 2019
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Thu, 13 Jun 2019 17:33:00 +0200
Subject: [gdal-dev] GDAL linked against CFITSIO on debian/ubuntu
In-Reply-To: <341525187.19321965.1560438331822.JavaMail.zimbra@u-psud.fr>
References: <341525187.19321965.1560438331822.JavaMail.zimbra@u-psud.fr>
Message-ID: <d1637caa-28db-2dc1-4910-a05368bc3dcc@xs4all.nl>

On 6/13/19 5:05 PM, Chiara Marmo wrote:
> I'm checking different OS and distributions for GDAL link against CFITSIO. I was pretty sure that Ubuntu and Debian allow the use of CFITSIO but apparently Ubuntu 18.04 does not...
> I've found a "--with-cifitsio=no" in the debian versioning system [1].... but I can't test debian right now.
The rules file is pretty clear, I'd say. The feature is not enabled.

If you look at the changelog you'll find why it was disabled:

 gdal (1.4.1-5) unstable; urgency=low

   * libcfitsio3 library is now GPL on Debian, so disabled due to
     incompatibility with GDAL copyright.
     (closes: #422537)

The linked bugreport has more backgrounds:

 https://bugs.debian.org/422537

> On Fedora the gdal package checks for the presence of CFITSIO and links against it if found.

Fedora is not very strict about license & copyright issues.

> Is someone in this list close to debian/ubuntu packagers?

Doesn't get any closer than this. ;-)

> Am I wrong?

No.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Thu Jun 13 09:04:57 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 13 Jun 2019 18:04:57 +0200
Subject: [gdal-dev] GDAL linked against CFITSIO on debian/ubuntu
In-Reply-To: <d1637caa-28db-2dc1-4910-a05368bc3dcc@xs4all.nl>
References: <341525187.19321965.1560438331822.JavaMail.zimbra@u-psud.fr>
 <d1637caa-28db-2dc1-4910-a05368bc3dcc@xs4all.nl>
Message-ID: <2186826.m3xYqEqMa4@even-i700>

On jeudi 13 juin 2019 17:33:00 CEST Sebastiaan Couwenberg wrote:
> On 6/13/19 5:05 PM, Chiara Marmo wrote:
> > I'm checking different OS and distributions for GDAL link against CFITSIO.
> > I was pretty sure that Ubuntu and Debian allow the use of CFITSIO but
> > apparently Ubuntu 18.04 does not... I've found a "--with-cifitsio=no" in
> > the debian versioning system [1].... but I can't test debian right now.
> The rules file is pretty clear, I'd say. The feature is not enabled.
> 
> If you look at the changelog you'll find why it was disabled:
> 
>  gdal (1.4.1-5) unstable; urgency=low
> 
>    * libcfitsio3 library is now GPL on Debian, so disabled due to
>      incompatibility with GDAL copyright.
>      (closes: #422537)
> 
> The linked bugreport has more backgrounds:
> 
>  https://bugs.debian.org/422537

I'd note that GDAL on Debian/Ubuntu links against poppler, which is GPL 
licensed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From chiara.marmo at u-psud.fr  Thu Jun 13 12:55:08 2019
From: chiara.marmo at u-psud.fr (Chiara Marmo)
Date: Thu, 13 Jun 2019 19:55:08 +0000 (GMT)
Subject: [gdal-dev] GDAL linked against CFITSIO on debian/ubuntu
In-Reply-To: <d1637caa-28db-2dc1-4910-a05368bc3dcc@xs4all.nl>
References: <341525187.19321965.1560438331822.JavaMail.zimbra@u-psud.fr>
 <d1637caa-28db-2dc1-4910-a05368bc3dcc@xs4all.nl>
Message-ID: <1620928562.19466674.1560455708563.JavaMail.zimbra@u-psud.fr>

Hi Sebastiaan,

> The rules file is pretty clear, I'd say. The feature is not enabled.
> 
> If you look at the changelog you'll find why it was disabled:
> 
>  gdal (1.4.1-5) unstable; urgency=low
> 
>    * libcfitsio3 library is now GPL on Debian, so disabled due to
>      incompatibility with GDAL copyright.
>      (closes: #422537)
> 
> The linked bugreport has more backgrounds:
> 
>  https://bugs.debian.org/422537
> 

Ok, good to know.. I'm a bit frustrated... :( 
but thanks for your answer :)

Best,
Chiara

-- 
Chiara Marmo
Ingénieur de Recherche GEOPS - Paris Sud-11
Bât 509
Tel: +33 (0)1 69 15 49 03 

From prkrajesvari3 at gmail.com  Fri Jun 14 00:25:58 2019
From: prkrajesvari3 at gmail.com (Rajesvari Parasa)
Date: Fri, 14 Jun 2019 12:55:58 +0530
Subject: [gdal-dev] Help with GPM Data
Message-ID: <CAEKTdxqTv=xNSRez5eKsb15CBT=wBU_ratsWZXQn7xwHBC2qnA@mail.gmail.com>

Hello,

This is the first time that I am dealing with Global Precipitation
Measurement (GPM) datasets. I am downloading these from GES DISC. From the
site, only NetCDF and HDF5 format files are available for download. When I
open these in QGIS, I see that these are wrongly oriented. As if lat, long
values were inverted. Can gdal handle these formats?

If someone has worked with these formats before and converted them well
referenced GeoTIFFs, please help. I tried using panoply, tool developed by
nasa to interact with these formats, though I was able to visualise
properly, I couldn't export to a GeoTIFF.

Regards,
Rajesvari
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190614/b2b4bdd0/attachment.html>

From nicolas.cadieux at archeotec.ca  Fri Jun 14 08:32:14 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 14 Jun 2019 11:32:14 -0400
Subject: [gdal-dev] Ellipsoidal length of a line
Message-ID: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>

Hi,

I am trying to get the length of a line in python. (Not just the straight length between the first and last nodes).  Using geopandas, (therefore the Shapely lib) I am getting the euclidien distance even though the dataframe holdings the line geometries has a CRS (WGS84, zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into account.  

Can I do this with gdal/ogr? 

Thanks for the help
Nicolas

From atle at frenviksveen.net  Fri Jun 14 09:19:02 2019
From: atle at frenviksveen.net (Atle Frenvik Sveen)
Date: Fri, 14 Jun 2019 18:19:02 +0200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
Message-ID: <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>

Hi! 

Not sure if would want to use gdal for this task*, but take a look at this blog post: 

https://janakiev.com/blog/gps-points-distance-python/


*or if it's doable, i guess not, since the scope of gdal is reading/writing geospatial formats

-a

- 
  Atle Frenvik Sveen
  atle at frenviksveen.net
  45278689
  atlefren.net

On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
> Hi,
> 
> I am trying to get the length of a line in python. (Not just the 
> straight length between the first and last nodes).  Using geopandas, 
> (therefore the Shapely lib) I am getting the euclidien distance even 
> though the dataframe holdings the line geometries has a CRS (WGS84, 
> zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into 
> account.  
> 
> Can I do this with gdal/ogr? 
> 
> Thanks for the help
> Nicolas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From patrick.mckendree.young at gmail.com  Fri Jun 14 10:20:20 2019
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Fri, 14 Jun 2019 11:20:20 -0600
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
Message-ID: <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>

Not exactly what you want, but you can do this with PostGIS by casting your
geometry to the geography type:

https://postgis.net/workshops/postgis-intro/geography.html

On Fri, Jun 14, 2019 at 10:26 AM Atle Frenvik Sveen <atle at frenviksveen.net>
wrote:

> Hi!
>
> Not sure if would want to use gdal for this task*, but take a look at this
> blog post:
>
> https://janakiev.com/blog/gps-points-distance-python/
>
>
> *or if it's doable, i guess not, since the scope of gdal is
> reading/writing geospatial formats
>
> -a
>
> -
>   Atle Frenvik Sveen
>   atle at frenviksveen.net
>   45278689
>   atlefren.net
>
> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
> > Hi,
> >
> > I am trying to get the length of a line in python. (Not just the
> > straight length between the first and last nodes).  Using geopandas,
> > (therefore the Shapely lib) I am getting the euclidien distance even
> > though the dataframe holdings the line geometries has a CRS (WGS84,
> > zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into
> > account.
> >
> > Can I do this with gdal/ogr?
> >
> > Thanks for the help
> > Nicolas
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190614/3e5db5bb/attachment.html>

From stephenwoodbridge37 at gmail.com  Fri Jun 14 10:58:48 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Fri, 14 Jun 2019 13:58:48 -0400
Subject: [gdal-dev] Question on python gdal.Rasterize()
Message-ID: <0402b4c8-56a1-436d-4a13-4d237bc04905@gmail.com>

Hi all,

My goal is to take satellite track data and create a gtiff file using 
Python.
The satellite data is in a NetCDF file, which I can read in Python and 
has variables lat, lon, ssha. There are a continue stream of the NetCDF 
data over time so I plan to just keep loading them as they become available.

My thought is to take adjacent track points as a LineStringZ and burn 
them into the image overwriting any existing data. This will keep the 
gtiff up to date with the most current data for any given area.

Maybe there is a better way to do this? suggestions welcome.

I was looking at gdal.RasterizeOptions() and gdal.Rasterize() and my 
thought was that I could create feature with geom like (lon, lat, ssha) 
and then rasterize that into the image using the option "useZ=True" but 
this seems to imply that I need to have an ogr source for the vector 
data. It would be much more convenient to be able to just pass features 
from python to the Rasterize() function.

I see callback and callback_data in the options can these be used for 
that? How?

Rasterize(destNameOrDestDS, srcDS, **kwargs)

I can open the gtiff file and then pass the handle of that to 
destNameOrDestDS.
Can a create an in memory srcDS that I've loaded with the track 
segments. The NetCDF files have about 5-6000 track points in them so an 
eqivalent number of LineStringZ features.

Is there an example of something similar you can link me to.

Thanks,
   -Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From stephenwoodbridge37 at gmail.com  Fri Jun 14 17:11:37 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Fri, 14 Jun 2019 20:11:37 -0400
Subject: [gdal-dev] Question on python gdal.Rasterize()
In-Reply-To: <0402b4c8-56a1-436d-4a13-4d237bc04905@gmail.com>
References: <0402b4c8-56a1-436d-4a13-4d237bc04905@gmail.com>
Message-ID: <12860b59-ff47-121d-d308-b608670d7b25@gmail.com>

OK, After some more research, I found the rasterize.py autotest file 
which was a huge help and I have code working that burns the tracks into 
an image. But its not exactly what I hoping for so I'll give the 
gdal.Grid() a try.

Thanks,
   -Steve

On 6/14/2019 1:58 PM, Stephen Woodbridge wrote:
> Hi all,
>
> My goal is to take satellite track data and create a gtiff file using 
> Python.
> The satellite data is in a NetCDF file, which I can read in Python and 
> has variables lat, lon, ssha. There are a continue stream of the 
> NetCDF data over time so I plan to just keep loading them as they 
> become available.
>
> My thought is to take adjacent track points as a LineStringZ and burn 
> them into the image overwriting any existing data. This will keep the 
> gtiff up to date with the most current data for any given area.
>
> Maybe there is a better way to do this? suggestions welcome.
>
> I was looking at gdal.RasterizeOptions() and gdal.Rasterize() and my 
> thought was that I could create feature with geom like (lon, lat, 
> ssha) and then rasterize that into the image using the option 
> "useZ=True" but this seems to imply that I need to have an ogr source 
> for the vector data. It would be much more convenient to be able to 
> just pass features from python to the Rasterize() function.
>
> I see callback and callback_data in the options can these be used for 
> that? How?
>
> Rasterize(destNameOrDestDS, srcDS, **kwargs)
>
> I can open the gtiff file and then pass the handle of that to 
> destNameOrDestDS.
> Can a create an in memory srcDS that I've loaded with the track 
> segments. The NetCDF files have about 5-6000 track points in them so 
> an eqivalent number of LineStringZ features.
>
> Is there an example of something similar you can link me to.
>
> Thanks,
>   -Steve


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From stephenwoodbridge37 at gmail.com  Fri Jun 14 18:22:10 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Fri, 14 Jun 2019 21:22:10 -0400
Subject: [gdal-dev] Stuck with python gdal.Grid throwing an error
Message-ID: <a8f6f54e-9b0e-0004-887f-d1e7d854f33c@gmail.com>

Hi,

I can't figure out what I'm doing wrong but gdal.Grid() keeps throwing 
an error and I've run out of things to try and work around the issue.

On Ubuntu using these packages:
gdal-bin:amd64/xenial 2.2.2+dfsg-1~xenial1 uptodate
gdal-data:all/xenial 2.2.2+dfsg-1~xenial1 uptodate
libgdal1i:amd64/xenial 1.11.3+dfsg-3build2 uptodate
libgdal20:amd64/xenial 2.2.2+dfsg-1~xenial1 uptodate
python-gdal:amd64/xenial 2.2.2+dfsg-1~xenial1 uptodate

Error message is:

Traceback (most recent call last):
   File "./process-jason3-ssha.py", line 322, in <module>
     Main()
   File "./process-jason3-ssha.py", line 316, in Main
     processFiles(mf, urlList)
   File "./process-jason3-ssha.py", line 242, in processFiles
     err = gdal.Grid(dataset, ds, options=opts)
   File "/usr/lib/python2.7/dist-packages/osgeo/gdal.py", line 968, in Grid
     return GridInternal(destName, srcDS, opts, callback, callback_data)
   File "/usr/lib/python2.7/dist-packages/osgeo/gdal.py", line 3229, in 
GridInternal
     return _gdal.GridInternal(*args)
RuntimeError: not a string

Code looks like (edited out not esentials):

         track = Dataset(fn, "r")
         track.set_auto_mask(False)

         lat = track.variables['lat']
         lon = track.variables['lon']
         ssh = track.variables['ssha']

         cnt = lat.shape[0]

         ds = ogr.GetDriverByName('Memory').CreateDataSource('wrk')
         lyr = ds.CreateLayer('track', srs=SRS)

         opts = 
gdal.GridOptions(algorithm='linear:radius=50:nodata=32767', \
                 layers='track')

         # QUESTION: should I create point features for NoData track 
points??

         for n in range(cnt):
             wkt = "POINT({} {} {})".format(lon[n]-180., lat[n], ssh[n])
             feat = ogr.Feature(lyr.GetLayerDefn())
             feat.SetGeometryDirectly(ogr.Geometry(wkt=wkt))
             lyr.CreateFeature(feat)

         # dataset is a gtiff opened with GA_Update

         # also tried this
         #err = gdal.Grid(dataset, lyr, options=opts)

         err = gdal.Grid(dataset, ds, options=opts)
         if err != 0:
             print 'gdalGrid error: ', err
             return

The above code is basically the same as what I use for 
gdal.RasterizeLayer() and that worked fine.

-Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From nicolas.cadieux at archeotec.ca  Fri Jun 14 21:35:17 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 15 Jun 2019 00:35:17 -0400
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
Message-ID: <6AE8E986-907D-4C31-9793-B9C79AB830A4@archeotec.ca>

Thanks,

The link brings me to some helpful packages.  I thought gdal could be helpful as is has a very good OGR library that deals with this stuff.  

Nicolas

> Le 14 juin 2019 à 12:19, Atle Frenvik Sveen <atle at frenviksveen.net> a écrit :
> 
> Hi! 
> 
> Not sure if would want to use gdal for this task*, but take a look at this blog post: 
> 
> https://janakiev.com/blog/gps-points-distance-python/
> 
> 
> *or if it's doable, i guess not, since the scope of gdal is reading/writing geospatial formats
> 
> -a
> 
> - 
>  Atle Frenvik Sveen
>  atle at frenviksveen.net
>  45278689
>  atlefren.net
> 
>> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
>> Hi,
>> 
>> I am trying to get the length of a line in python. (Not just the 
>> straight length between the first and last nodes).  Using geopandas, 
>> (therefore the Shapely lib) I am getting the euclidien distance even 
>> though the dataframe holdings the line geometries has a CRS (WGS84, 
>> zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into 
>> account.  
>> 
>> Can I do this with gdal/ogr? 
>> 
>> Thanks for the help
>> Nicolas
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From nicolas.cadieux at archeotec.ca  Fri Jun 14 21:42:35 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 15 Jun 2019 00:42:35 -0400
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
 <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>
Message-ID: <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>

Thanks,
Could work but I think this will be too slow. I wonder how QGIS does it? I guess they use code from Proj.4.  If anyone has an other idea, shoot!
Cheers 
Nicolas 

> Le 14 juin 2019 à 13:20, Patrick Young <patrick.mckendree.young at gmail.com> a écrit :
> 
> Not exactly what you want, but you can do this with PostGIS by casting your geometry to the geography type:
> 
> https://postgis.net/workshops/postgis-intro/geography.html
> 
>> On Fri, Jun 14, 2019 at 10:26 AM Atle Frenvik Sveen <atle at frenviksveen.net> wrote:
>> Hi! 
>> 
>> Not sure if would want to use gdal for this task*, but take a look at this blog post: 
>> 
>> https://janakiev.com/blog/gps-points-distance-python/
>> 
>> 
>> *or if it's doable, i guess not, since the scope of gdal is reading/writing geospatial formats
>> 
>> -a
>> 
>> - 
>>   Atle Frenvik Sveen
>>   atle at frenviksveen.net
>>   45278689
>>   atlefren.net
>> 
>> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
>> > Hi,
>> > 
>> > I am trying to get the length of a line in python. (Not just the 
>> > straight length between the first and last nodes).  Using geopandas, 
>> > (therefore the Shapely lib) I am getting the euclidien distance even 
>> > though the dataframe holdings the line geometries has a CRS (WGS84, 
>> > zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into 
>> > account.  
>> > 
>> > Can I do this with gdal/ogr? 
>> > 
>> > Thanks for the help
>> > Nicolas
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/d1403b43/attachment.html>

From even.rouault at spatialys.com  Sat Jun 15 00:53:24 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 15 Jun 2019 09:53:24 +0200
Subject: [gdal-dev] Stuck with python gdal.Grid throwing an error
In-Reply-To: <a8f6f54e-9b0e-0004-887f-d1e7d854f33c@gmail.com>
References: <a8f6f54e-9b0e-0004-887f-d1e7d854f33c@gmail.com>
Message-ID: <1756772.Fsyvd77fcZ@even-i700>

>          err = gdal.Grid(dataset, ds, options=opts)
>          if err != 0:
>              print 'gdalGrid error: ', err
>              return
> 
> The above code is basically the same as what I use for
> gdal.RasterizeLayer() and that worked fine.

gdal.Grid() prototype is

def Grid(destName, srcDS, **kwargs):
    """ Create raster from the scattered data.
        Arguments are :
          destName --- Output dataset name
          srcDS --- a Dataset object or a filename
        Keyword arguments are :
          options --- return of gdal.GridOptions(), string or array of strings
          other keywords arguments of gdal.GridOptions()
        If options is provided as a gdal.GridOptions() object, other keywords 
are ignored. """

So the first argument must be a filename, not a dataset. Only a few utilities 
accept updating an existing dataset. gdal.Grid() will generate a new output 
dataset.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew.bell.ia at gmail.com  Sat Jun 15 03:51:00 2019
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Sat, 15 Jun 2019 06:51:00 -0400
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
 <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>
 <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>
Message-ID: <CACJ51z3HZ5BGFophPMw89ZaE=vQjBexmS2Q4_zJ7SX+uFZxv-A@mail.gmail.com>

How is the line defined? If you have a function, there's calculus.

On Sat, Jun 15, 2019, 12:43 AM Nicolas Cadieux <nicolas.cadieux at archeotec.ca>
wrote:

> Thanks,
> Could work but I think this will be too slow. I wonder how QGIS does it? I
> guess they use code from Proj.4.  If anyone has an other idea, shoot!
> Cheers
> Nicolas
>
> Le 14 juin 2019 à 13:20, Patrick Young <patrick.mckendree.young at gmail.com>
> a écrit :
>
> Not exactly what you want, but you can do this with PostGIS by casting
> your geometry to the geography type:
>
> https://postgis.net/workshops/postgis-intro/geography.html
>
> On Fri, Jun 14, 2019 at 10:26 AM Atle Frenvik Sveen <atle at frenviksveen.net>
> wrote:
>
>> Hi!
>>
>> Not sure if would want to use gdal for this task*, but take a look at
>> this blog post:
>>
>> https://janakiev.com/blog/gps-points-distance-python/
>>
>>
>> *or if it's doable, i guess not, since the scope of gdal is
>> reading/writing geospatial formats
>>
>> -a
>>
>> -
>>   Atle Frenvik Sveen
>>   atle at frenviksveen.net
>>   45278689
>>   atlefren.net
>>
>> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
>> > Hi,
>> >
>> > I am trying to get the length of a line in python. (Not just the
>> > straight length between the first and last nodes).  Using geopandas,
>> > (therefore the Shapely lib) I am getting the euclidien distance even
>> > though the dataframe holdings the line geometries has a CRS (WGS84,
>> > zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into
>> > account.
>> >
>> > Can I do this with gdal/ogr?
>> >
>> > Thanks for the help
>> > Nicolas
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/a70052ad/attachment-0001.html>

From knudsen.thomas at gmail.com  Sat Jun 15 04:02:34 2019
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Sat, 15 Jun 2019 13:02:34 +0200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
 <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>
 <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>
Message-ID: <CAH0YoENEg9KdfmajDHt9mjc5n8Xdamw52u1MnT1Nrppq2+h+2w@mail.gmail.com>

In the PROJ package, the geod utility is included - you could do

echo lat0 lon0  lat1 lon1 | geod -I +ellps=GRS80

Where the "-I" indicates that you want to calculate the "inverse geodetic
problem", i.e. you know where you are, and where you want to go, but you
need to know how far to go and in which direction.

e.g.

$ echo 55 12 56 12 |geod -I +ellps=GRS80
> 0d -180d 111332.699

Where the distance (in m) you look for is the third number on the output
line. The two first are the forward and return azimuths respectively.
Otherwise, you could use the "proj_lp_dist()" entry of the PROJ API - cf.
https://proj.org/development/reference/functions.html

(and probably you should continue this thread on the PROJ mailing list if
you need additional assistance)

/Thomas

Den lør. 15. jun. 2019 kl. 06.43 skrev Nicolas Cadieux <
nicolas.cadieux at archeotec.ca>:

> Thanks,
> Could work but I think this will be too slow. I wonder how QGIS does it? I
> guess they use code from Proj.4.  If anyone has an other idea, shoot!
> Cheers
> Nicolas
>
> Le 14 juin 2019 à 13:20, Patrick Young <patrick.mckendree.young at gmail.com>
> a écrit :
>
> Not exactly what you want, but you can do this with PostGIS by casting
> your geometry to the geography type:
>
> https://postgis.net/workshops/postgis-intro/geography.html
>
> On Fri, Jun 14, 2019 at 10:26 AM Atle Frenvik Sveen <atle at frenviksveen.net>
> wrote:
>
>> Hi!
>>
>> Not sure if would want to use gdal for this task*, but take a look at
>> this blog post:
>>
>> https://janakiev.com/blog/gps-points-distance-python/
>>
>>
>> *or if it's doable, i guess not, since the scope of gdal is
>> reading/writing geospatial formats
>>
>> -a
>>
>> -
>>   Atle Frenvik Sveen
>>   atle at frenviksveen.net
>>   45278689
>>   atlefren.net
>>
>> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
>> > Hi,
>> >
>> > I am trying to get the length of a line in python. (Not just the
>> > straight length between the first and last nodes).  Using geopandas,
>> > (therefore the Shapely lib) I am getting the euclidien distance even
>> > though the dataframe holdings the line geometries has a CRS (WGS84,
>> > zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into
>> > account.
>> >
>> > Can I do this with gdal/ogr?
>> >
>> > Thanks for the help
>> > Nicolas
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/618d3fe9/attachment.html>

From rykovd at gmail.com  Sat Jun 15 04:52:38 2019
From: rykovd at gmail.com (Denis Rykov)
Date: Sat, 15 Jun 2019 13:52:38 +0200
Subject: [gdal-dev] Using pseudo-field FID as ID_FIELD for GeoJSON
In-Reply-To: <1560411040085-0.post@n6.nabble.com>
References: <CAJbvKNraRGvtXcXevqOGp_4h2UyW9T_sF0kBB4U8FiL4hexoAA@mail.gmail.com>
 <1560411040085-0.post@n6.nabble.com>
Message-ID: <CAJbvKNo0FxJeGyCxZ8VABavtLfwGZV6mLV7qXTq7HbS0LMioEA@mail.gmail.com>

Thanks, that did the trick!

On Thu, Jun 13, 2019 at 9:31 AM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> Have you tried "-preserve_fid"
> https://gdal.org/programs/ogr2ogr.html#ogr2ogr ?
>
> -Jukka Rahkonen-
>
>
> dr wrote
> > Is it possible to reflect fids values of features of original layer while
> > exporting it to GeoJSON?
> > Usage of "-lco ID_FIELD=FID" doesn't help.
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/3689d48a/attachment.html>

From cameron.shorter at gmail.com  Sat Jun 15 05:00:37 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Sat, 15 Jun 2019 22:00:37 +1000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <CAERgKeCDhS8NrCm6aozHWWmgH9seMPrvdmntxYvrSKi=LrO9xQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
Message-ID: <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>

Hi GDAL folks,

I'd like to introduce you to Lynden who has dropped by our OSGeo Season 
of Docs community. He is a developer, has used ogr2ogr, is an "expert 
gdal newbie", and is keen to give back to GDAL through documentation.

Do you have thoughts on where there are documentation needs, and where 
Lynden could be most impactful?

Cheers, Cameron

On 7/6/19 9:23 pm, Cameron Shorter wrote:
>
> Hi Lynden,
>
> Great to hear you are interested in getting further involved in OSGeo, 
> and in helping with documentation.
>
> I'm a fellow Australian (based in Sydney), and involved in OSGeo's 
> SeasonOfDocs project, and would love to help you find your feet in our 
> community. What is the best way to contact you? I'm usually hard to 
> catch during work hours, but could have a chat over the weekend. Early 
> morning, or after 8pm often works for me as well.
>
> Welcome. Cameron
>
> On 4/6/19 7:57 pm, María Arias de Reyna wrote:
>> Hi Lynden!
>>
>> You arrive just in time to help in the Season of Docs[0]! Can you 
>> register here on the mailing list [1] and say hi?
>>
>> [0] https://wiki.osgeo.org/wiki/Season_of_Docs_Ideas_2019
>> [1] https://lists.osgeo.org/mailman/listinfo/seasonofdocs
>>
>> On Tue, Jun 4, 2019 at 5:32 AM Lynden Noye <lt.noye at gmail.com 
>> <mailto:lt.noye at gmail.com>> wrote:
>>
>>     Hi there,
>>
>>     My name is Lynden, and I'm a UX/UI designer and front-end
>>     developer from Melbourne Australia.
>>
>>     Through my work at a small native mobile app agency, I've been
>>     using a lot of ogr2ogr for a GIS project, and I'd be interested
>>     in volunteering my time with any help you may need with the GDAL
>>     docs and website.
>>
>>     If you're interested in hearing more, I'd love to have a chat.
>>
>>     Cheers,
>>     Lynden
>>
>>
>> _______________________________________________
>> SeasonOfDocs mailing list
>> SeasonOfDocs at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/seasonofdocs
> -- 
> Cameron Shorter
> Technology Demystifier
> Open Technologies and Geospatial Consultant
>
> M +61 (0) 419 142 254

-- 
Cameron Shorter
Technology Demystifier
Open Technologies and Geospatial Consultant

M +61 (0) 419 142 254

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/0ef6f3a8/attachment.html>

From nicolas.cadieux at archeotec.ca  Sat Jun 15 12:38:06 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Sat, 15 Jun 2019 15:38:06 -0400
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <CAH0YoENEg9KdfmajDHt9mjc5n8Xdamw52u1MnT1Nrppq2+h+2w@mail.gmail.com>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <2b1b8a43-7754-4f66-b97c-737f46ca1d59@www.fastmail.com>
 <CADXYQQ5inGPMkL=E2MO5+8qhyCsKmZGdGmSqPMwP8xNb7sxJDw@mail.gmail.com>
 <0F9758D1-A093-4012-ABF9-95AA6EDE6BB5@archeotec.ca>
 <CAH0YoENEg9KdfmajDHt9mjc5n8Xdamw52u1MnT1Nrppq2+h+2w@mail.gmail.com>
Message-ID: <F5563D81-305E-48BA-A2B3-3CAD9377460C@archeotec.ca>

Thanks every one for your help,

I found good packages out there.  I will probably go with Proj. I’am just surprised it’s not part standard libraries like Shapely or OGR since both can calculate line length.  Most packages look like they are made to calculate only two point at a time and not, for example, a WKT string with multiple nodes.  I guess calculating distance between each vertex would be the way to go.

Cheer, 
Nicolas

> Le 15 juin 2019 à 07:02, Thomas Knudsen <knudsen.thomas at gmail.com> a écrit :
> 
> In the PROJ package, the geod utility is included - you could do
> 
> echo lat0 lon0  lat1 lon1 | geod -I +ellps=GRS80
> 
> Where the "-I" indicates that you want to calculate the "inverse geodetic problem", i.e. you know where you are, and where you want to go, but you need to know how far to go and in which direction.
> 
> e.g.
> 
> $ echo 55 12 56 12 |geod -I +ellps=GRS80
> > 0d	-180d	111332.699 
> 
> Where the distance (in m) you look for is the third number on the output line. The two first are the forward and return azimuths respectively. 
> Otherwise, you could use the "proj_lp_dist()" entry of the PROJ API - cf. https://proj.org/development/reference/functions.html
> 
> (and probably you should continue this thread on the PROJ mailing list if you need additional assistance)
> 
> /Thomas
> 
>> Den lør. 15. jun. 2019 kl. 06.43 skrev Nicolas Cadieux <nicolas.cadieux at archeotec.ca>:
>> Thanks,
>> Could work but I think this will be too slow. I wonder how QGIS does it? I guess they use code from Proj.4.  If anyone has an other idea, shoot!
>> Cheers 
>> Nicolas 
>> 
>>> Le 14 juin 2019 à 13:20, Patrick Young <patrick.mckendree.young at gmail.com> a écrit :
>>> 
>>> Not exactly what you want, but you can do this with PostGIS by casting your geometry to the geography type:
>>> 
>>> https://postgis.net/workshops/postgis-intro/geography.html
>>> 
>>>> On Fri, Jun 14, 2019 at 10:26 AM Atle Frenvik Sveen <atle at frenviksveen.net> wrote:
>>>> Hi! 
>>>> 
>>>> Not sure if would want to use gdal for this task*, but take a look at this blog post: 
>>>> 
>>>> https://janakiev.com/blog/gps-points-distance-python/
>>>> 
>>>> 
>>>> *or if it's doable, i guess not, since the scope of gdal is reading/writing geospatial formats
>>>> 
>>>> -a
>>>> 
>>>> - 
>>>>   Atle Frenvik Sveen
>>>>   atle at frenviksveen.net
>>>>   45278689
>>>>   atlefren.net
>>>> 
>>>> On Fri, Jun 14, 2019, at 17:32, Nicolas Cadieux wrote:
>>>> > Hi,
>>>> > 
>>>> > I am trying to get the length of a line in python. (Not just the 
>>>> > straight length between the first and last nodes).  Using geopandas, 
>>>> > (therefore the Shapely lib) I am getting the euclidien distance even 
>>>> > though the dataframe holdings the line geometries has a CRS (WGS84, 
>>>> > zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into 
>>>> > account.  
>>>> > 
>>>> > Can I do this with gdal/ogr? 
>>>> > 
>>>> > Thanks for the help
>>>> > Nicolas
>>>> > _______________________________________________
>>>> > gdal-dev mailing list
>>>> > gdal-dev at lists.osgeo.org
>>>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190615/0f84d341/attachment.html>

From even.rouault at spatialys.com  Sat Jun 15 14:04:18 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 15 Jun 2019 23:04:18 +0200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <F5563D81-305E-48BA-A2B3-3CAD9377460C@archeotec.ca>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <CAH0YoENEg9KdfmajDHt9mjc5n8Xdamw52u1MnT1Nrppq2+h+2w@mail.gmail.com>
 <F5563D81-305E-48BA-A2B3-3CAD9377460C@archeotec.ca>
Message-ID: <5738954.NquUyK6y17@even-i700>

$ cat test.csv
id,WKT
1,"LINESTRING(2 49,3 50,4 49)"

$ ogr2ogr test.db test.csv -f sqlite -dsco spatialite=yes -a_srs EPSG:4326

$ ogrinfo test.db -sql "select st_length(geometry, 1) from test" -al -q

Layer name: SELECT
OGRFeature(SELECT):0
  st_length(geometry, 1) (Real) = 265450.955822012


Cf http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html#p6

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From knudsen.thomas at gmail.com  Sat Jun 15 19:46:13 2019
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Sun, 16 Jun 2019 04:46:13 +0200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <5738954.NquUyK6y17@even-i700>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <CAH0YoENEg9KdfmajDHt9mjc5n8Xdamw52u1MnT1Nrppq2+h+2w@mail.gmail.com>
 <F5563D81-305E-48BA-A2B3-3CAD9377460C@archeotec.ca>
 <5738954.NquUyK6y17@even-i700>
Message-ID: <CAH0YoEN108=6iq+Z+rVneEzK32ZURHvz3tJ4zniOCRFSYNWarw@mail.gmail.com>

Awesome!

Den lør. 15. jun. 2019 kl. 23.04 skrev Even Rouault <
even.rouault at spatialys.com>:

> $ cat test.csv
> id,WKT
> 1,"LINESTRING(2 49,3 50,4 49)"
>
> $ ogr2ogr test.db test.csv -f sqlite -dsco spatialite=yes -a_srs EPSG:4326
>
> $ ogrinfo test.db -sql "select st_length(geometry, 1) from test" -al -q
>
> Layer name: SELECT
> OGRFeature(SELECT):0
>   st_length(geometry, 1) (Real) = 265450.955822012
>
>
> Cf http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.2.0.html#p6
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190616/ff3fd7d0/attachment.html>

From lt.noye at gmail.com  Sat Jun 15 21:02:59 2019
From: lt.noye at gmail.com (Lynden Noye)
Date: Sun, 16 Jun 2019 14:02:59 +1000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <CAERgKeCDhS8NrCm6aozHWWmgH9seMPrvdmntxYvrSKi=LrO9xQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
Message-ID: <CAH4yv=cpypoguwT8J5TVSuBfcekOnqDW6-DyEf5_6Gh789WsUA@mail.gmail.com>

Hi there!

While Cameron is not wrong about me being a dev, that's been a more recent
thing for me professionally, I'm a much more experienced UX & UI designer ;)

Cameron, I've subscribed to this list too, I look forward to hearing back
on where I might be able to help out!

On Sat, Jun 15, 2019 at 10:00 PM Cameron Shorter <cameron.shorter at gmail.com>
wrote:

> Hi GDAL folks,
>
> I'd like to introduce you to Lynden who has dropped by our OSGeo Season of
> Docs community. He is a developer, has used ogr2ogr, is an "expert gdal
> newbie", and is keen to give back to GDAL through documentation.
>
> Do you have thoughts on where there are documentation needs, and where
> Lynden could be most impactful?
>
> Cheers, Cameron
> On 7/6/19 9:23 pm, Cameron Shorter wrote:
>
> Hi Lynden,
>
> Great to hear you are interested in getting further involved in OSGeo, and
> in helping with documentation.
>
> I'm a fellow Australian (based in Sydney), and involved in OSGeo's
> SeasonOfDocs project, and would love to help you find your feet in our
> community. What is the best way to contact you? I'm usually hard to catch
> during work hours, but could have a chat over the weekend. Early morning,
> or after 8pm often works for me as well.
>
> Welcome. Cameron
> On 4/6/19 7:57 pm, María Arias de Reyna wrote:
>
> Hi Lynden!
>
> You arrive just in time to help in the Season of Docs[0]! Can you register
> here on the mailing list [1] and say hi?
>
> [0] https://wiki.osgeo.org/wiki/Season_of_Docs_Ideas_2019
> [1] https://lists.osgeo.org/mailman/listinfo/seasonofdocs
>
> On Tue, Jun 4, 2019 at 5:32 AM Lynden Noye <lt.noye at gmail.com> wrote:
>
>> Hi there,
>>
>> My name is Lynden, and I'm a UX/UI designer and front-end developer from
>> Melbourne Australia.
>>
>> Through my work at a small native mobile app agency, I've been using a
>> lot of ogr2ogr for a GIS project, and I'd be interested in volunteering my
>> time with any help you may need with the GDAL docs and website.
>>
>> If you're interested in hearing more, I'd love to have a chat.
>>
>> Cheers,
>> Lynden
>>
>
> _______________________________________________
> SeasonOfDocs mailing listSeasonOfDocs at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/seasonofdocs
>
> --
> Cameron Shorter
> Technology Demystifier
> Open Technologies and Geospatial Consultant
>
> M +61 (0) 419 142 254
>
> --
> Cameron Shorter
> Technology Demystifier
> Open Technologies and Geospatial Consultant
>
> M +61 (0) 419 142 254
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190616/2bb4ae7c/attachment-0001.html>

From mwtoews at gmail.com  Sun Jun 16 14:46:20 2019
From: mwtoews at gmail.com (Mike Taves)
Date: Mon, 17 Jun 2019 09:46:20 +1200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
Message-ID: <CAM2FmMqQk2BtY_Bku=Qwwq4Z8sF055oM-7RHy-y8MBrbNVNw8Q@mail.gmail.com>

On Sat, 15 Jun 2019 at 03:32, Nicolas Cadieux
<nicolas.cadieux at archeotec.ca> wrote:
> I am trying to get the length of a line in python. (Not just the straight length between the first and last nodes).  Using geopandas, (therefore the Shapely lib) I am getting the euclidien distance even though the dataframe holdings the line geometries has a CRS (WGS84, zone UTM 18 S).  Obviously, the WGS84 Ellipsoid is not taken into account.
>
> Can I do this with gdal/ogr?

If you are looking for a really precise length (~15 nm) on WGS84, you
can use the Python version of GeographicLib [1].

Note that PROJ incorporates the C library for Geodesics from
GeographicLib [2], and that this is also the same method used in
PostGIS (since version 2.2). I'm not sure how SpatiaLite has
implemented ST_Length, but could be worth checking into.

[1] https://geographiclib.sourceforge.io/html/python/
[2] https://proj.org/geodesic.html#solution-of-geodesic-problems

From a.furieri at lqt.it  Sun Jun 16 21:14:07 2019
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Mon, 17 Jun 2019 06:14:07 +0200
Subject: [gdal-dev] Ellipsoidal length of a line
In-Reply-To: <CAM2FmMqQk2BtY_Bku=Qwwq4Z8sF055oM-7RHy-y8MBrbNVNw8Q@mail.gmail.com>
References: <02BCC5BB-F7D6-41B5-88B5-537EB7841B40@archeotec.ca>
 <CAM2FmMqQk2BtY_Bku=Qwwq4Z8sF055oM-7RHy-y8MBrbNVNw8Q@mail.gmail.com>
Message-ID: <447a169821299ff6d6111d8daa16f36f@lqt.it>

On Mon, 17 Jun 2019 09:46:20 +1200, Mike Taves wrote:
> I'm not sure how SpatiaLite has implemented ST_Length,
> but could be worth checking into.
>
>

Hi Mike,

SpatiaLite started supporting geodesic distances
about ten years ago, and two different methods
were implemented as internal C functions:
1. the first was based on the Great Circle distance
    formula as reported by Aviation Formulary [1]
2. the second was based on the Vincenty inverse
    formula for ellipsoids as reported by a
    JavaScript implementation developed by Chris
    Veness [2]

In more recent times PROJ 4.9.0 started supporting
geodesic distances, so the situation became as follows:
- when libspatialite is built by defining "--enable-proj"
   (default setting) and PROJ >= 4.9.0 is available, then
   geodesic distances will be based on PROJ support.
- if not, the old internal implementation will be used.

bye Sandro (SpatiaLite developer)

[1] https://edwilliams.org/avform.htm#Dist
[2] http://www.movable-type.co.uk/scripts/latlong-vincenty.html

From jormarfe at gmail.com  Mon Jun 17 02:35:55 2019
From: jormarfe at gmail.com (Jorge Martin)
Date: Mon, 17 Jun 2019 11:35:55 +0200
Subject: [gdal-dev] Issue when compiling gdal v2.1.2
Message-ID: <CADH5xWoU4rQZuy6O4i0Tbs+=QQumT4+uHa3qz88-wzGk40VsXw@mail.gmail.com>

Hello,



I am trying to compile the gdal 2.1.2 and I have problems with the gcc.

Do you know what gcc version is necessary to compile?



Cheers,
Jorge
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190617/672058c5/attachment.html>

From even.rouault at spatialys.com  Mon Jun 17 05:43:27 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 14:43:27 +0200
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
Message-ID: <2711013.m1moKplxID@even-i700>

Hi,

this is really great news ! Given my experience with the project, I'm rather 
far from being representative of someone less familiar with it or with a non-
developer profile, so thoughts from the broader GDAL community on what they 
feel is the most missing would be welcome.

One thing I've in mind - this is rather a detail - is that we lost a bit of 
content (build requirements for each driver) during the Sphinx migration, as 
pointed out by
https://github.com/OSGeo/gdal/issues/1204#issuecomment-498624481 , so this 
could be a potential task.

More generally, I feel we might need more tutorial-like / how-to style 
documentation. The current documentation is hopefully rather decent as a 
reference guide, but lacking on the quick-start side. On the wiki, there are 
some source of information, mostly from
https://trac.osgeo.org/gdal/wiki/UserDocs , that could be interesting to 
migrate partly on the main documentation, but with a critical eye (some of the 
hints might be outdated due to later improvements, etc)

Lynden, perhaps you've also suggestions from your practice of the project and 
its documentation on what you'd like to see added ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From eadam at co.lincoln.or.us  Mon Jun 17 08:16:30 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Mon, 17 Jun 2019 08:16:30 -0700
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <2711013.m1moKplxID@even-i700>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
 <2711013.m1moKplxID@even-i700>
Message-ID: <CACqBkM8UDYd2dmdpS8aU5rbCwZiyB17OaQQRGqa+h=Jc14GOuQ@mail.gmail.com>

On Mon, Jun 17, 2019 at 5:43 AM Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> this is really great news ! Given my experience with the project, I'm rather
> far from being representative of someone less familiar with it or with a non-
> developer profile, so thoughts from the broader GDAL community on what they
> feel is the most missing would be welcome.
>

There are some things that are very basic that might make the
documentation more understandable to a beginner.  I'm not sure if
these things are true or I've made them up or they are supposed to be
too obvious to state.

-nln = New Layer Name
-nlt = New Layer Type
-a_srs = assign spatial reference system
-t_srs = target spatial reference system
-s_srs = source spatial reference system

-ot = output type
-of = output format

Are those true?  If not, I've used them to better understand (and
remember) the options.

Best regards, Eli


> One thing I've in mind - this is rather a detail - is that we lost a bit of
> content (build requirements for each driver) during the Sphinx migration, as
> pointed out by
> https://github.com/OSGeo/gdal/issues/1204#issuecomment-498624481 , so this
> could be a potential task.
>
> More generally, I feel we might need more tutorial-like / how-to style
> documentation. The current documentation is hopefully rather decent as a
> reference guide, but lacking on the quick-start side. On the wiki, there are
> some source of information, mostly from
> https://trac.osgeo.org/gdal/wiki/UserDocs , that could be interesting to
> migrate partly on the main documentation, but with a critical eye (some of the
> hints might be outdated due to later improvements, etc)
>
> Lynden, perhaps you've also suggestions from your practice of the project and
> its documentation on what you'd like to see added ?
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Mon Jun 17 08:41:11 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 17:41:11 +0200
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <CACqBkM8UDYd2dmdpS8aU5rbCwZiyB17OaQQRGqa+h=Jc14GOuQ@mail.gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <2711013.m1moKplxID@even-i700>
 <CACqBkM8UDYd2dmdpS8aU5rbCwZiyB17OaQQRGqa+h=Jc14GOuQ@mail.gmail.com>
Message-ID: <9879726.QiK4n0VKT0@even-i700>

On lundi 17 juin 2019 08:16:30 CEST Eli Adam wrote:
> On Mon, Jun 17, 2019 at 5:43 AM Even Rouault <even.rouault at spatialys.com> 
wrote:
> > Hi,
> > 
> > this is really great news ! Given my experience with the project, I'm
> > rather far from being representative of someone less familiar with it or
> > with a non- developer profile, so thoughts from the broader GDAL
> > community on what they feel is the most missing would be welcome.
> 
> There are some things that are very basic that might make the
> documentation more understandable to a beginner.  I'm not sure if
> these things are true or I've made them up or they are supposed to be
> too obvious to state.
> 
> -nln = New Layer Name
> -nlt = New Layer Type
> -a_srs = assign spatial reference system
> -t_srs = target spatial reference system
> -s_srs = source spatial reference system
> 
> -ot = output type
> -of = output format
> 
> Are those true?  If not, I've used them to better understand (and
> remember) the options.

Yes, they are true (or at least I've drawn the same conclusion as you :-))

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Jun 17 09:08:36 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Jun 2019 16:08:36 +0000
Subject: [gdal-dev] Failure to convert to Airy
Message-ID: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Even

I'm seeing this failure with the airy conversion

echo 4.897 52.371 | gdaltransform -s_srs +proj=longlat -t_srs +proj=airy

ERROR 1: PROJ: proj_create: Error -50: malformed pipeline
ERROR 6: Cannot find coordinate operations from `PROJCRS["unknown",BASEGEOGCRS["unknown",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]]],CONVERSION["unknown",METHOD["PROJ airy"]],CS[Cartesian,2],AXIS["(E)",east,ORDER[1],LENGTHUNIT["metre",1,ID["EPSG",9001]]],AXIS["(N)",north,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]]]' to `GEOGCRS["unknown",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]],CS[ellipsoidal,2],AXIS["longitude",east,ORDER[1],ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],AXIS["latitude",north,ORDER[2],ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]]]'
328249.00331295 4987937.10144727 0


This is from a GDAL+PROJ6.1 build a couple weeks ago

gdaltransform --version
GDAL 3.1.0dev, released 2019/99/99

Others work well. For example

echo 4.897 52.371 | gdaltransform -s_srs +proj=longlat -t_srs +proj=lagrng
253763.012478277 3354569.86001135 0

Joaquim

From even.rouault at spatialys.com  Mon Jun 17 09:36:54 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 18:36:54 +0200
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <1670627.2KWybMxPU4@even-i700>

On lundi 17 juin 2019 16:08:36 CEST Joaquim Manuel Freire Luís wrote:
> Even
> 
> I'm seeing this failure with the airy conversion
> 
> echo 4.897 52.371 | gdaltransform -s_srs +proj=longlat -t_srs +proj=airy
> 
> ERROR 1: PROJ: proj_create: Error -50: malformed pipeline
> ERROR 6: Cannot find coordinate operations from
> `PROJCRS["unknown",BASEGEOGCRS["unknown",DATUM["World Geodetic System
> 1984",ELLIPSOID["WGS
> 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["G
> reenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]]],CONVERS
> ION["unknown",METHOD["PROJ
> airy"]],CS[Cartesian,2],AXIS["(E)",east,ORDER[1],LENGTHUNIT["metre",1,ID["E
> PSG",9001]]],AXIS["(N)",north,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]
> ]]' to `GEOGCRS["unknown",DATUM["World Geodetic System 1984",ELLIPSOID["WGS
> 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["G
> reenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]],CS[ellip
> soidal,2],AXIS["longitude",east,ORDER[1],ANGLEUNIT["degree",0.01745329251994
> 33,ID["EPSG",9122]]],AXIS["latitude",north,ORDER[2],ANGLEUNIT["degree",0.017
> 4532925199433,ID["EPSG",9122]]]]' 328249.00331295 4987937.10144727 0
> 

Actually, this half works: you get the correct result, but with an error 
message.
This is because the airy projection has no code in PROJ to compute its reverse 
operation, and gdaltransform logic instanciates both forward and reverse 
transformers.
Error message, not relevant for your use case, shut off by
https://github.com/OSGeo/gdal/commit/d1b68ad5f3adc3ec8f66a4a6dac5d7655670a08c
(which also fixes a real crashing bug when trying to use the null reverse 
method)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Jun 17 09:43:05 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Jun 2019 16:43:05 +0000
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <1670627.2KWybMxPU4@even-i700>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <1670627.2KWybMxPU4@even-i700>
Message-ID: <DB8PR04MB6507DF5A900DCC1F4A5BD165A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Thanks,

This comes from our GMT tests and used to work before the GDAL3+PROJ6 combo. And funny that it also half works when I run it from Julia. But not from GMT.

|>-----Original Message-----
|>From: Even Rouault <even.rouault at spatialys.com>
|>Sent: Monday, June 17, 2019 5:37 PM
|>To: gdal-dev at lists.osgeo.org
|>Cc: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Subject: Re: [gdal-dev] Failure to convert to Airy
|>
|>On lundi 17 juin 2019 16:08:36 CEST Joaquim Manuel Freire Luís wrote:
|>> Even
|>>
|>> I'm seeing this failure with the airy conversion
|>>
|>> echo 4.897 52.371 | gdaltransform -s_srs +proj=longlat -t_srs
|>> +proj=airy
|>>
|>> ERROR 1: PROJ: proj_create: Error -50: malformed pipeline ERROR 6:
|>> Cannot find coordinate operations from
|>> `PROJCRS["unknown",BASEGEOGCRS["unknown",DATUM["World Geodetic
|>System
|>> 1984",ELLIPSOID["WGS
|>>
|>84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIM
|>> EM["G
|>>
|>reenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]]],C
|>> ONVERS
|>> ION["unknown",METHOD["PROJ
|>> airy"]],CS[Cartesian,2],AXIS["(E)",east,ORDER[1],LENGTHUNIT["metre",1,
|>> ID["E
|>> PSG",9001]]],AXIS["(N)",north,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",
|>> 9001]] ]]' to `GEOGCRS["unknown",DATUM["World Geodetic System
|>> 1984",ELLIPSOID["WGS
|>>
|>84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIM
|>> EM["G
|>>
|>reenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]],CS
|>> [ellip
|>> soidal,2],AXIS["longitude",east,ORDER[1],ANGLEUNIT["degree",0.01745329
|>> 251994
|>> 33,ID["EPSG",9122]]],AXIS["latitude",north,ORDER[2],ANGLEUNIT["degree"
|>> ,0.017 4532925199433,ID["EPSG",9122]]]]' 328249.00331295
|>> 4987937.10144727 0
|>>
|>
|>Actually, this half works: you get the correct result, but with an error message.
|>This is because the airy projection has no code in PROJ to compute its reverse
|>operation, and gdaltransform logic instanciates both forward and reverse
|>transformers.
|>Error message, not relevant for your use case, shut off by
|>https://github.com/OSGeo/gdal/commit/d1b68ad5f3adc3ec8f66a4a6dac5d765
|>5670a08c
|>(which also fixes a real crashing bug when trying to use the null reverse
|>method)
|>
|>Even
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jun 17 10:00:05 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 19:00:05 +0200
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <DB8PR04MB6507DF5A900DCC1F4A5BD165A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <1670627.2KWybMxPU4@even-i700>
 <DB8PR04MB6507DF5A900DCC1F4A5BD165A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <4605436.Tv6CzCeKWa@even-i700>

> used to work before the GDAL3+PROJ6 combo.

That would be surprising: with GDAL 2.4 and PROJ < 6, you also get an error, 
but with a different message:

$ gdalinfo --version
GDAL 2.4.1, released 2019/03/15

$ echo 4.897 52.371 | \
	gdaltransform -s_srs +proj=longlat -t_srs "+proj=airy +wktext"

ERROR 6: Failed to initialize PROJ pipeline from `+proj=airy +wktext' to `
+proj=longlat +ellps=WGS84 +no_defs': malformed pipeline
328249.00331295 4987937.10144727 0


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Jun 17 10:14:21 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Jun 2019 17:14:21 +0000
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <4605436.Tv6CzCeKWa@even-i700>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <1670627.2KWybMxPU4@even-i700>
 <DB8PR04MB6507DF5A900DCC1F4A5BD165A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4605436.Tv6CzCeKWa@even-i700>
Message-ID: <DB8PR04MB65071A6016165998FDC9FE40A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Well, I call it via GMT but that test is in GMT for a while and it used to pass.

Anyway, I'll have to investigate this further because I rebuilt GDAL and now the gdaltransform works, but when I call it from GMT is still fails.

The code is

https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_ogrproj.c#L27

and a quick debug shows that the failure occurs the second time that function is called. For some reason that I don't remember right now, I have to call it twice.

(I've to go now for > 1 hour, so won't be able to reply in case of)

|>-----Original Message-----
|>From: Even Rouault <even.rouault at spatialys.com>
|>Sent: Monday, June 17, 2019 6:00 PM
|>To: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Cc: gdal-dev at lists.osgeo.org
|>Subject: Re: [gdal-dev] Failure to convert to Airy
|>
|>> used to work before the GDAL3+PROJ6 combo.
|>
|>That would be surprising: with GDAL 2.4 and PROJ < 6, you also get an error,
|>but with a different message:
|>
|>$ gdalinfo --version
|>GDAL 2.4.1, released 2019/03/15
|>
|>$ echo 4.897 52.371 | \
|>	gdaltransform -s_srs +proj=longlat -t_srs "+proj=airy +wktext"
|>
|>ERROR 6: Failed to initialize PROJ pipeline from `+proj=airy +wktext' to `
|>+proj=longlat +ellps=WGS84 +no_defs': malformed pipeline
|>328249.00331295 4987937.10144727 0
|>
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From ivan.lucena at outlook.com  Mon Jun 17 10:15:33 2019
From: ivan.lucena at outlook.com (Ivan Lucena)
Date: Mon, 17 Jun 2019 17:15:33 +0000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <9879726.QiK4n0VKT0@even-i700>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <2711013.m1moKplxID@even-i700>
 <CACqBkM8UDYd2dmdpS8aU5rbCwZiyB17OaQQRGqa+h=Jc14GOuQ@mail.gmail.com>,
 <9879726.QiK4n0VKT0@even-i700>
Message-ID: <BN6PR2201MB12494A82B028F0FF9685E58AF2EB0@BN6PR2201MB1249.namprd22.prod.outlook.com>

Talking about basics... Most of the SDK we download to build drivers comes with an INSTALL file (.md or not) and that is what people usually look for when they decide that they need to download and build a FOSS. But GDAL doesn't have that. Yes, the information is there, somewhere but it would be nice to have it more accessible for newbies.
________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Even Rouault <even.rouault at spatialys.com>
Sent: Monday, June 17, 2019 11:41 AM
To: eadam at co.lincoln.or.us
Cc: gdal-dev at lists.osgeo.org; Lynden Noye
Subject: Re: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting

On lundi 17 juin 2019 08:16:30 CEST Eli Adam wrote:
> On Mon, Jun 17, 2019 at 5:43 AM Even Rouault <even.rouault at spatialys.com>
wrote:
> > Hi,
> >
> > this is really great news ! Given my experience with the project, I'm
> > rather far from being representative of someone less familiar with it or
> > with a non- developer profile, so thoughts from the broader GDAL
> > community on what they feel is the most missing would be welcome.
>
> There are some things that are very basic that might make the
> documentation more understandable to a beginner.  I'm not sure if
> these things are true or I've made them up or they are supposed to be
> too obvious to state.
>
> -nln = New Layer Name
> -nlt = New Layer Type
> -a_srs = assign spatial reference system
> -t_srs = target spatial reference system
> -s_srs = source spatial reference system
>
> -ot = output type
> -of = output format
>
> Are those true?  If not, I've used them to better understand (and
> remember) the options.

Yes, they are true (or at least I've drawn the same conclusion as you :-))

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190617/7293ed4f/attachment.html>

From even.rouault at spatialys.com  Mon Jun 17 10:21:30 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 19:21:30 +0200
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <DB8PR04MB65071A6016165998FDC9FE40A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4605436.Tv6CzCeKWa@even-i700>
 <DB8PR04MB65071A6016165998FDC9FE40A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <3673785.TaZupJrALs@even-i700>

On lundi 17 juin 2019 17:14:21 CEST Joaquim Manuel Freire Luís wrote:
> Well, I call it via GMT but that test is in GMT for a while and it used to
> pass.
> 
> Anyway, I'll have to investigate this further because I rebuilt GDAL and now
> the gdaltransform works, but when I call it from GMT is still fails.
> 
> The code is
> 
> https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_ogrproj.c#L27

gmt_OGRCoordinateTransformation(() isn't actually equivalent to gdaltransform, 
since it only creates the forward transformer.
So that should, normally, work with both GDAL < 3 or GDAL >= 3 when going from 
longlat to airy.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Jun 17 12:45:34 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Jun 2019 19:45:34 +0000
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <3673785.TaZupJrALs@even-i700>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <4605436.Tv6CzCeKWa@even-i700>
 <DB8PR04MB65071A6016165998FDC9FE40A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <3673785.TaZupJrALs@even-i700>
Message-ID: <DB8PR04MB65079E4DF58D305D8D8076A5A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>

I used the gdaltranslate example because I knew that it would much simpler for you to test but, as I said first, this issue was raised by a call to GDAL from GMT.

Looked again into it and what happens is that the gmt_OGRCoordinateTransformation() call runs fine when

pSrcSRS = "+proj=latlong +datum=WGS84"
pDstSRS = "+proj=airy +ellps=WGS84 +units=m"

but raise the error when I change the order of the source and target (i.e. create the inverse mapping)

pSrcSRS = "+proj=airy +ellps=WGS84 +units=m"
pDstSRS = "+proj=latlong +datum=WGS84"

In this case, it even raises an exception in VS debugger at line #63

		CPLFree(pSrcSRS);		CPLFree(pDstSRS);

|>On lundi 17 juin 2019 17:14:21 CEST Joaquim Manuel Freire Luís wrote:
|>> Well, I call it via GMT but that test is in GMT for a while and it
|>> used to pass.
|>>
|>> Anyway, I'll have to investigate this further because I rebuilt GDAL
|>> and now the gdaltransform works, but when I call it from GMT is still fails.
|>>
|>> The code is
|>>
|>> https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_ogrproj
|>> .c#L27
|>
|>gmt_OGRCoordinateTransformation(() isn't actually equivalent to
|>gdaltransform, since it only creates the forward transformer.
|>So that should, normally, work with both GDAL < 3 or GDAL >= 3 when going
|>from longlat to airy.
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jun 17 12:54:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jun 2019 21:54:53 +0200
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <DB8PR04MB65079E4DF58D305D8D8076A5A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <3673785.TaZupJrALs@even-i700>
 <DB8PR04MB65079E4DF58D305D8D8076A5A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <3085921.c0VWsuIVdO@even-i700>

> but raise the error when I change the order of the source and target (i.e.
> create the inverse mapping)

Sure, as that would trigger the non existing reverse operation.

> 
> pSrcSRS = "+proj=airy +ellps=WGS84 +units=m"
> pDstSRS = "+proj=latlong +datum=WGS84"
> 
> In this case, it even raises an exception in VS debugger at line #63
> 
> 		CPLFree(pSrcSRS);		CPLFree(pDstSRS);

Those CPLFree() are super suspicious and should likely be removed. They are 
not present in other code paths. I suspect the correct signature for the 
function should be

OGRCoordinateTransformationH gmt_OGRCoordinateTransformation(
   struct GMT_CTRL *GMT, const char *pSrcSRS, const char *pDstSRS);

to avoid such issue.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Jun 17 13:14:23 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Jun 2019 20:14:23 +0000
Subject: [gdal-dev] Failure to convert to Airy
In-Reply-To: <3085921.c0VWsuIVdO@even-i700>
References: <DB8PR04MB650788FF43CED77D27101CB0A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <3673785.TaZupJrALs@even-i700>
 <DB8PR04MB65079E4DF58D305D8D8076A5A6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <3085921.c0VWsuIVdO@even-i700>
Message-ID: <DB8PR04MB6507B195ACE0F03C9DD4CC8BA6EB0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Right. I changed the signature and removed the CPLFree() and now in GMT it also ... half works. The middle warnings are print from GMT but the other come from GDAL and are like those you suppressed in your gdaltransform commit. 

So, I should try to catch this type of cases where one can do the direct transform but not the reverse. Any place where I can search what other then Airy have the same issue?


echo 4.897 52.371 | mapproject -J+proj=airy

ERROR 1: PROJ: proj_create: Error -50: malformed pipeline
ERROR 6: Cannot find coordinate operations from `PROJCRS["unknown",BASEGEOGCRS["unknown",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]]],CONVERSION["unknown",METHOD["PROJ airy"]],CS[Cartesian,2],AXIS["(E)",east,ORDER[1],LENGTHUNIT["metre",1,ID["EPSG",9001]]],AXIS["(N)",north,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]]]' to `GEOGCRS["unknown",DATUM["World Geodetic System 1984",ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ID["EPSG",6326]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8901]],CS[ellipsoidal,2],AXIS["longitude",east,ORDER[1],ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],AXIS["latitude",north,ORDER[2],ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]]]'

mapproject [ERROR]: Failed to create coordinate transformation between the following
coordinate systems. This may be because they are not transformable,
or because projection services (PROJ.4 DLL/.so) could not be loaded.
mapproject [ERROR]: Source:

PROJCS["unknown",
    GEOGCS["unknown",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]]],
    PROJECTION["custom_proj4"],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    EXTENSION["PROJ4","+proj=airy +datum=WGS84 +wktext +no_defs"]]

GEOGCS["unknown",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AXIS["Longitude",EAST],
    AXIS["Latitude",NORTH]]

ERROR 10: Pointer 'hTransform' is NULL in 'OCTTransform'.

ERROR 10: Pointer 'hTransform' is NULL in 'OCTTransform'.

ERROR 10: Pointer 'hTransform' is NULL in 'OCTTransform'.

ERROR 10: Pointer 'hTransform' is NULL in 'OCTTransform'.

328249.003313   4987937.10145



From palmerjnz at gmail.com  Tue Jun 18 01:11:55 2019
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Tue, 18 Jun 2019 20:11:55 +1200
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <BN6PR2201MB12494A82B028F0FF9685E58AF2EB0@BN6PR2201MB1249.namprd22.prod.outlook.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <2711013.m1moKplxID@even-i700>
 <CACqBkM8UDYd2dmdpS8aU5rbCwZiyB17OaQQRGqa+h=Jc14GOuQ@mail.gmail.com>
 <9879726.QiK4n0VKT0@even-i700>
 <BN6PR2201MB12494A82B028F0FF9685E58AF2EB0@BN6PR2201MB1249.namprd22.prod.outlook.com>
Message-ID: <CAA5WJYm+=QQL5FV6r62XmdKjd77tR7U8Cr+xqPHB198na3gSjw@mail.gmail.com>

I think we could do with documenting the
https://trac.osgeo.org/gdal/wiki/ConfigOptions in a more complete way and
including it in the main website documentation. We could also consider
including all config options that apply to a driver such as
https://gdal.org/drivers/raster/gtiff.html#configuration-options

Cheers,
Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190618/8a45fef3/attachment.html>

From plspace at abv.bg  Tue Jun 18 03:06:35 2019
From: plspace at abv.bg (plamen terziew)
Date: Tue, 18 Jun 2019 13:06:35 +0300 (EEST)
Subject: [gdal-dev] Disable apps building
Message-ID: <458636972.1363886.1560852395926@nm72.abv.bg>

 Hi,  
  I am building GDAL 2.4 for Android and I do not need to build the apps as well (actually they are failing to build).  
  Is there a way to disable the apps building?  
  Thank you,  Plamen
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190618/ba92aad4/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun 18 07:28:24 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 18 Jun 2019 07:28:24 -0700 (MST)
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
References: <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
Message-ID: <1560868104178-0.post@n6.nabble.com>

Hi,

Probably the hardest bit of all based on the traffic on the mailing list
https://trac.osgeo.org/gdal/wiki/BuildHints but with a help from the
developers it should be possible at least to move hints which do not work
any more into some historic section.

-Jukka Rahkonen-



Cameron Shorter wrote
> Hi GDAL folks,
> 
> I'd like to introduce you to Lynden who has dropped by our OSGeo Season 
> of Docs community. He is a developer, has used ogr2ogr, is an "expert 
> gdal newbie", and is keen to give back to GDAL through documentation.
> 
> Do you have thoughts on where there are documentation needs, and where 
> Lynden could be most impactful?
> 
> Cheers, Cameron





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From p.baumann at jacobs-university.de  Tue Jun 18 07:33:11 2019
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Tue, 18 Jun 2019 16:33:11 +0200
Subject: [gdal-dev] "RFC 75: Multidimensional arrays" available for
 preliminary review
In-Reply-To: <BN8PR05MB6450A23D462AFAB45D12E805871F0@BN8PR05MB6450.namprd05.prod.outlook.com>
References: <1607841.VsNMmxJ7cT@even-i700>
 <BN8PR05MB6450A23D462AFAB45D12E805871F0@BN8PR05MB6450.namprd05.prod.outlook.com>
Message-ID: <a571e9e0-b017-e09d-7fd7-82630c6369c4@jacobs-university.de>

Dear Jason,

it's great to read your excellent writeup of situations and requirements! FYI,
GDAL already has a rasdaman driver where rasdaman (www.rasdaman.org) is an Array
Database doing all you describe (plus a few more things). However, currently
GDAL utilizes rasdaman only as a simple file access mechanism. Instead, queries
could be pushed down from GDAL - that might give a low-hanging fruit for adding
true nD to GDAL. With rasdaman there are 2 interfaces: rasql (no georeferencing,
SQL style, just syntactic deviations to the ISO SQL/MDA datacube standard) and
OGC WCS/WCPS (the OGC datacube access/analytics standards, with space/time
georeferencing).

Would some sort of collaboration be of interest?

cheers,

Peter


On 29.05.19 20:37, Jason Roberts wrote:
> Dear Even,
>
> Thank you for exploring the possibility of making GDAL more multidimensional. In the 10+ years I've lurked on this list I recall this coming up periodically. It's a hard problem; perhaps now will be the time to actually do it!
>
> Over that period, I have worked with a lot of 3D (x,y,z and x,y,time) and 4D (x,y,z,time) datasets from the ocean remote sensing and modeling communities. I'm a marine spatial ecologist; most of my work involves trying to explain or predict distributions of marine species from observations or models of oceanographic variables such as sea surface temperature (SST) or chlorophyll concentration. I want to describe two of the most common scenarios involving multidimensional data in the hope that it can inform your thinking about ways to enhance GDAL's API to be multidimensional. Hopefully you'll find this useful; apologies if not!
>
> Scenario 1: Sampling a 3D or 4D raster dataset with a vector dataset:
>
> In this scenario, we have vector features, usually points, for which we want to obtain values from a 3D or 4D raster dataset. For example, the vector features might be points representing the locations of satellite-tracked animals, of survey vessels, or hauls of fishing gear. The vectors usually have a datetime attribute, and possibly a depth attribute. The raster dataset might be a time series of satellite SST images with dimensions lon, lat, and time, or a time+depth series of water temperature from a 4D ocean model with dimensions lon, lat, depth, and time. We need to match up each point to the closest 2D slice based on time and/or depth, and then index into the image with lon and lat and extract the value of the cell to an attribute of the point. From there we can perform statistical analysis on the sampled values.
>
> Usually the vectors are points, but occasionally we may have lines or polygons over which we'd like to summarize the raster data, e.g. find the mean value of the raster inside each polygon or along a line. This is much more complicated and, in my experience, is much less commonly done than points. Also, just as "bilinear interpolation" might be used to interpolate a value from a point on a 2D raster, we occasionally want to extend this to do "trilinear interpolation" on, say, an x,y,t image, so that the interpolated value is based on the 8 surrounding cells (or 16 surrounding cells with x,y,z,t).
>
> Scenario 2: Summarizing 3D or 4D raster datasets into 2D summary images:
>
> In this scenario, we have a time series of images, either x,y,t or x,y,z,t, that occur at some high temporal frequency, e.g. one image per day, and we want to statistically summarize them at a lower frequency. For example, we might want to take daily SST images and create monthly averages (365 images/year --> 12 images/year) or even monthly climatological averages (365 images/year * n years --> 12 rasters, one for each month averaged across all years).
>
> Implications for GDAL's API:
>
> These scenarios are very high level, and I would not expect GDAL's API to expose methods for performing them. These are geoprocessing operations that should be implemented at some higher layer that itself would make use of GDAL. So the question is: what should GDAL's API provide, if anything, to help facilitate implementation of the scenarios by that higher layer? Here are some things to consider.
>
> 1. Aggregating a series of low dimension datasets into a single virtual higher dimension dataset (e.g. 2D to 3D):
>
> In the communities I work with, it is fairly rare for someone to release a single multidimensional file that spans more than one time slice. For example, it is rare for someone to release a single netCDF of SST with dimensions x,y,t with the length of t being 365, representing one year of daily images. Instead they will release 365 netCDFs, each containing a 2D dataset, or perhaps a 3D dataset with a single time slice. As new data are collected, they issue new files.
>
> To use such data for scenarios 1 and 2 (and others), it is very convenient for these series of low dimension datasets to be aggregated into a single virtual high dimension dataset that can then be operated over. netCDF has long had special facilities for this, such as thredds/opendap and NcML <aggregation>. The GDAL API could expose a similar capability that would allow aggregation of arbitrary raster data in this way (rather than just netCDFs).
>
> This capability would be a challenge to implement, no doubt, but it would provide a lot of value to users of the GDAL API. There could be some synergy with the .vrt driver. Particularly valuable would be the ability to point GDAL to a directory tree of datasets and have it aggregate them.
>
> 2. Special handling for aggregations of periodic datasets:
>
> Many data providers produce datasets that have a regular periodicity. For example, they might release one image per day from a polar orbiting satellite. For these datasets, when performing calculations on the time dimension, it is convenient to assume that there will always be 365 time slices per year (or 366 on leap years). But, sadly, data providers occasionally experience problems and sometimes do not release time slices. Now, suddenly, there are not 365 images with the year 2017, but only 362 because 3 were not produced. Users regularly get tripped up by this. For example, in the popular HYCOM ocean model, inquiries about this happen on their mailing list every few months, prompting the HYCOM team to prepare a multi-page FAQ just on this issue.
>
> There are also datasets that could described as semi-regular. In the oceanographic community, it is common to have rasters that span 8 days. But these datasets often "start over" on 1 January every year, such that the first dataset spans 1-8 January, the second 9-16 January, etc. The 46th one usually spans days 361-365 (or 366) or maybe includes 2-3 days of the new year, but then the next year starts again at 1 January.  
>
> So, assuming GDAL were capable of performing aggregations, it would be useful to describe to GDAL (or have it otherwise deduce) the periodicity of datasets and then itself generate missing time slices virtually. These slices would just be filled with the "no data" value. 
>
> It would also be useful for the API provide an abstraction for the concept of periodicity, so that a caller can get/set it. I fully recognize this is difficult, in that there are so many ways that datasets can be periodic, and that it might not be possible to invent a scheme for representing them all. But there are many datasets that fall under common schemes (e.g. one image every day, 8-days, month, year, etc.) and this might be a situation in which a simple solution can cover 95% of the datasets out there and provide good value.
>
> A lot of these issues about time have been considered before by others, e.g. by those developing netCDF metadata standards. This raises the question: should GDAL even consider getting involved in this area? Isn't it really tricky? Yes, probably. But if GDAL treats time completely generically, the new API might not provide that much value of what can already be done, e.g. with subdatasets. (But I do recognize that this is a potential minefield.)
>
> 3. Lazy evaluation:
>
> If an aggregate dataset is spread across many files, it would be good if GDAL could avoid iterating over all of those files unless absolutely necessary. For example, it would be unfortunate if GDAL could only determine the time or depth coordinate of a file by opening it and reading a netCDF attribute. Consider a 3D dataset of daily SST images composed of 10,000 netCDF files. It would be very slow if GDAL had to open each one in order to return an array of time dimension values. In some cases this might be unavoidable, but GDAL should provide the means to avoid it, if possible, e.g. by telling GDAL how to parse the times from the file names. You are probably well aware of these issues in developing the .vrt driver and similar projects.
>
> I hope this helps. Thanks for your time and consideration.
>
> Jason
>
>> -----Original Message-----
>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even
>> Rouault
>> Sent: Friday, May 24, 2019 11:01 AM
>> To: gdal-dev at lists.osgeo.org
>> Subject: [gdal-dev] "RFC 75: Multidimensional arrays" available for
>> preliminary review
>>
>> Hi,
>>
>> I've prepared a preliminary version of a new RFC to add support for
>> multidimensional arrays
>>
>> https://urldefense.proofpoint.com/v2/url?u=https-
>> 3A__github.com_rouault_gdal_blob_rfc75-
>> 5Ftext_gdal_doc_source_development_rfc_rfc75-5Fmultidimensional-
>> 5Farrays.rst&d=DwIGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=cJfJ
>> 4ejc1xbg_qb47Pg1OoRq1GfFGvWbDD2PT7-
>> fBKk&m=z4DIC0ByQfvEPOoQULwLWJUCYSJ_rD9wnK56bSk-088&s=QoB-
>> _CuLOE_hxDlvaGk9pf_1E6LVycCraOPSTwANhCk&e=
>>
>> If you want to comment it inline, it is also available as a pull request
>> at https://urldefense.proofpoint.com/v2/url?u=https-
>> 3A__github.com_OSGeo_gdal_pull_1580&d=DwIGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1
>> i6YHLR0Sj_gZ4adc&r=cJfJ4ejc1xbg_qb47Pg1OoRq1GfFGvWbDD2PT7-
>> fBKk&m=z4DIC0ByQfvEPOoQULwLWJUCYSJ_rD9wnK56bSk-
>> 088&s=5ZZMNYskn0v4Jzk4QvfTKYSArMmQZEZTTiH3uxtCVAI&e=
>>
>> This is preliminary content to give an idea of the general directions I
>> have in mind for now.
>> Not backed by any implementation yet (should start soon hopefully), so API
>> details will likely change, but early feedback is welcome.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> https://urldefense.proofpoint.com/v2/url?u=http-
>> 3A__www.spatialys.com&d=DwIGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4a
>> dc&r=cJfJ4ejc1xbg_qb47Pg1OoRq1GfFGvWbDD2PT7-
>> fBKk&m=z4DIC0ByQfvEPOoQULwLWJUCYSJ_rD9wnK56bSk-088&s=vEHFxJLIKrMqTFFYqD_x-
>> oa1BtTCt8ppUhHU1HakMoA&e=
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://urldefense.proofpoint.com/v2/url?u=https-
>> 3A__lists.osgeo.org_mailman_listinfo_gdal-
>> 2Ddev&d=DwIGaQ&c=imBPVzF25OnBgGmVOlcsiEgHoG1i6YHLR0Sj_gZ4adc&r=cJfJ4ejc1xb
>> g_qb47Pg1OoRq1GfFGvWbDD2PT7-
>> fBKk&m=z4DIC0ByQfvEPOoQULwLWJUCYSJ_rD9wnK56bSk-
>> 088&s=tUoKHatLSi1xtfDf1EYAGTrYwf99aV9Ky_Sa95QU54w&e=
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
 - Professor of Computer Science, Jacobs University Bremen
   www.faculty.jacobs-university.de/pbaumann
   mail: p.baumann at jacobs-university.de
   tel: +49-421-200-3178, fax: +49-421-200-493178
 - Executive Director, rasdaman GmbH Bremen (HRB 26793)
   www.rasdaman.com, mail: baumann at rasdaman.com
   tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From uwe.schmitz at bezreg-koeln.nrw.de  Tue Jun 18 07:17:16 2019
From: uwe.schmitz at bezreg-koeln.nrw.de (Schmitz, Uwe)
Date: Tue, 18 Jun 2019 14:17:16 +0000
Subject: [gdal-dev] Errors writing GeoTIFF with NBITS=1
Message-ID: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E96F84F3@vbrk21mx02.bezreg-koeln.nrw.de>

Hi Folks,

with gdal 2.4.0 I get errors doing the following:

gdal_translate \
   -co COMPRESS=PACKBITS \
   -co NBITS=1 \
   -co PHOTOMETRIC=MINISWHITE \
   -co PROFILE=GeoTIFF \
   -a_srs epsg:25832 \
   src.tif \
   dst.tif<CR>
Input file size is 4000, 4000
ERROR 6: dst.tif, band 1: SetOffset() not supported on this raster band.
ERROR 6: dst.tif, band 1: SetScale() not supported on this raster band.
ERROR 6: dst.tif, band 1: SetUnitType() not supported on this raster band.
0...10...20...30...40...50...60...70...80...90...100 - done.

src.tif is also GeoTIFF with NBITS=1, COMPRESS=PACKBITS etc.
but dst.tif seems to be the problem.
A search showed me that I can prevent the errors by setting:
export GDAL_PAM_ENABLED=YES

Is this intended? At least with version 2.1.1 there were no errors
without this setting.

Thanks in advance
Uwe


From even.rouault at spatialys.com  Tue Jun 18 08:02:24 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jun 2019 17:02:24 +0200
Subject: [gdal-dev] Errors writing GeoTIFF with NBITS=1
In-Reply-To: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E96F84F3@vbrk21mx02.bezreg-koeln.nrw.de>
References: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E96F84F3@vbrk21mx02.bezreg-koeln.nrw.de>
Message-ID: <3273598.7z5cxh4BUn@even-i700>

On mardi 18 juin 2019 14:17:16 CEST Schmitz, Uwe wrote:
> Hi Folks,
> 
> with gdal 2.4.0 I get errors doing the following:
> 
> gdal_translate \
>    -co COMPRESS=PACKBITS \
>    -co NBITS=1 \
>    -co PHOTOMETRIC=MINISWHITE \
>    -co PROFILE=GeoTIFF \
>    -a_srs epsg:25832 \
>    src.tif \
>    dst.tif<CR>
> Input file size is 4000, 4000
> ERROR 6: dst.tif, band 1: SetOffset() not supported on this raster band.
> ERROR 6: dst.tif, band 1: SetScale() not supported on this raster band.
> ERROR 6: dst.tif, band 1: SetUnitType() not supported on this raster band.
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> 
> src.tif is also GeoTIFF with NBITS=1, COMPRESS=PACKBITS etc.
> but dst.tif seems to be the problem.
> A search showed me that I can prevent the errors by setting:
> export GDAL_PAM_ENABLED=YES
> 
> Is this intended?

I can only reproduce the error messages you get by explictly setting 
GDAL_PAM_ENABLED=NO (GDAL_PAM_ENABLED=YES being the default)
Explicitly disabling PAM will lead to such, generally non critical, warnings/
errors when PAM features are needed. That said, for that particular case, I've 
just pushed a fix in the GTiff driver to avoid the error messages to be 
emitted, but you could encounter them in a number of other places.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cameron.shorter at gmail.com  Tue Jun 18 12:42:32 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Wed, 19 Jun 2019 05:42:32 +1000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <2711013.m1moKplxID@even-i700>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
 <2711013.m1moKplxID@even-i700>
Message-ID: <74db03bd-f33c-910c-e4f6-b45200a37a5e@gmail.com>

Doing some cross-pollination of ideas between gdal list (techies) and 
osgeo season of docs list (writers)...

Feedback Lynden received from GDAL community based on his offer to help 
with docs ...


On 16/6/19 2:02 pm, Lynden Noye wrote:
> While Cameron is not wrong about me being a dev, that's been a more 
> recent thing for me professionally, I'm a much more experienced UX & 
> UI designer ;)
>
> Cameron, I've subscribed to this list too, I look forward to hearing 
> back on where I might be able to help out!
>
> On Sat, Jun 15, 2019 at 10:00 PM Cameron Shorter 
> <cameron.shorter at gmail.com <mailto:cameron.shorter at gmail.com>> wrote:
>
>     Hi GDAL folks,
>
>     I'd like to introduce you to Lynden who has dropped by our OSGeo
>     Season of Docs community. He is a developer, has used ogr2ogr, is
>     an "expert gdal newbie", and is keen to give back to GDAL through
>     documentation.
>
>     Do you have thoughts on where there are documentation needs, and
>     where Lynden could be most impactful?
>
>     Cheers, Cameron
>
On 17/6/19 10:43 pm, Even Rouault wrote:
> Hi,
>
> this is really great news ! Given my experience with the project, I'm rather
> far from being representative of someone less familiar with it or with a non-
> developer profile, so thoughts from the broader GDAL community on what they
> feel is the most missing would be welcome.
>
> One thing I've in mind - this is rather a detail - is that we lost a bit of
> content (build requirements for each driver) during the Sphinx migration, as
> pointed out by
> https://github.com/OSGeo/gdal/issues/1204#issuecomment-498624481 , so this
> could be a potential task.
>
> More generally, I feel we might need more tutorial-like / how-to style
> documentation. The current documentation is hopefully rather decent as a
> reference guide, but lacking on the quick-start side. On the wiki, there are
> some source of information, mostly from
> https://trac.osgeo.org/gdal/wiki/UserDocs , that could be interesting to
> migrate partly on the main documentation, but with a critical eye (some of the
> hints might be outdated due to later improvements, etc)
>
> Lynden, perhaps you've also suggestions from your practice of the project and
> its documentation on what you'd like to see added ?
>
> Even
>
On 18/6/19 1:16 am, Eli Adam wrote:
> There are some things that are very basic that might make the
> documentation more understandable to a beginner.  I'm not sure if
> these things are true or I've made them up or they are supposed to be
> too obvious to state.
>
> -nln = New Layer Name
> -nlt = New Layer Type
> -a_srs = assign spatial reference system
> -t_srs = target spatial reference system
> -s_srs = source spatial reference system
>
> -ot = output type
> -of = output format
>
> Are those true?  If not, I've used them to better understand (and
> remember) the options.
On 18/6/19 3:15 am, Ivan Lucena wrote:
> Talking about basics... Most of the SDK we download to build drivers 
> comes with an INSTALL file (.md or not) and that is what people 
> usually look for when they decide that they need to download and build 
> a FOSS. But GDAL doesn't have that. Yes, the information is there, 
> somewhere but it would be nice to have it more accessible for newbies. 
On 18/6/19 6:11 pm, Jeremy Palmer wrote:
> I think we could do with documenting the 
> https://trac.osgeo.org/gdal/wiki/ConfigOptions in a more complete way 
> and including it in the main website documentation. We could also 
> consider including all config options that apply to a driver such as 
> https://gdal.org/drivers/raster/gtiff.html#configuration-options

-- 
Cameron Shorter
Technology Demystifier
Open Technologies and Geospatial Consultant

M +61 (0) 419 142 254

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190619/17712345/attachment.html>

From uwe.schmitz at bezreg-koeln.nrw.de  Wed Jun 19 00:54:00 2019
From: uwe.schmitz at bezreg-koeln.nrw.de (Schmitz, Uwe)
Date: Wed, 19 Jun 2019 07:54:00 +0000
Subject: [gdal-dev] Errors writing GeoTIFF with NBITS=1
In-Reply-To: <3273598.7z5cxh4BUn@even-i700>
References: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E96F84F3@vbrk21mx02.bezreg-koeln.nrw.de>
 <3273598.7z5cxh4BUn@even-i700>
Message-ID: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E96F969B@vbrk21mx02.bezreg-koeln.nrw.de>

Even,

thanks for investigating in this!

Maybe I should have mentioned: gdal was configure'd  --without-pam 
during build. I think that's why GDAL_PAM_ENABLED is
"NO" by default in my environment.
Yes, may be these errors are not critical, but in my
context (scripting) such errors cause the termination
of the process...

Anyway, thank you very much for the quick patch!

Best wishes
Uwe

>-----Ursprüngliche Nachricht-----
>Von: Even Rouault [mailto:even.rouault at spatialys.com]
>Gesendet: Dienstag, 18. Juni 2019 17:02
>An: gdal-dev at lists.osgeo.org
>Cc: Schmitz, Uwe
>Betreff: Re: [gdal-dev] Errors writing GeoTIFF with NBITS=1
>
>On mardi 18 juin 2019 14:17:16 CEST Schmitz, Uwe wrote:
>> Hi Folks,
>>
>> with gdal 2.4.0 I get errors doing the following:
>>
>> gdal_translate \
>>    -co COMPRESS=PACKBITS \
>>    -co NBITS=1 \
>>    -co PHOTOMETRIC=MINISWHITE \
>>    -co PROFILE=GeoTIFF \
>>    -a_srs epsg:25832 \
>>    src.tif \
>>    dst.tif<CR>
>> Input file size is 4000, 4000
>> ERROR 6: dst.tif, band 1: SetOffset() not supported on this raster band.
>> ERROR 6: dst.tif, band 1: SetScale() not supported on this raster band.
>> ERROR 6: dst.tif, band 1: SetUnitType() not supported on this raster band.
>> 0...10...20...30...40...50...60...70...80...90...100 - done.
>>
>> src.tif is also GeoTIFF with NBITS=1, COMPRESS=PACKBITS etc.
>> but dst.tif seems to be the problem.
>> A search showed me that I can prevent the errors by setting:
>> export GDAL_PAM_ENABLED=YES
>>
>> Is this intended?
>
>I can only reproduce the error mess[Schmitz, Uwe] "ages you get by explictly setting
>GDAL_PAM_ENABLED=NO (GDAL_PAM_ENABLED=YES being the default)
>Explicitly disabling PAM will lead to such, generally non critical, warnings/
>errors when PAM features are needed. That said, for that particular case, I've
>just pushed a fix in the GTiff driver to avoid the error messages to be
>emitted, but you could encounter them in a number of other places.
>
>Even
>
>--
>Spatialys - Geospatial professional services
>http://www.spatialys.com

From gghiggini at gec-it.com  Wed Jun 19 02:57:00 2019
From: gghiggini at gec-it.com (Giorgio Ghiggini)
Date: Wed, 19 Jun 2019 11:57:00 +0200
Subject: [gdal-dev] ogr2ogr MVT use of CONF parameter
Message-ID: <00de01d52685$58bb1860$0a314920$@gec-it.com>

Hello,

 

I am not sure this is the right place to ask my question, apologize in
advance if I am wrong.

 

I am using GDAL 3.0.0, released 2019/05/05 (downloaded here
http://www.gisinternals.com/query.html?content=filelist
<http://www.gisinternals.com/query.html?content=filelist&file=release-1911-x
64-gdal-3-0-0-mapserver-7-4-0.zip>
&file=release-1911-x64-gdal-3-0-0-mapserver-7-4-0.zip).

 

I am trying to create an MVT MBtiles using my own configuration file (here
attached).

 

I then run the following:

 

ogr2ogr -F MVT test6.mbtiles 8-0.0-55.0.sqlite -dsco CONF=conf.json -dsco
FORMAT=MBTILES

 

but I get this errors:

 

ERROR 1: JSON parsing error: unexpected character (at offset 0)

ERROR 1: MVT driver failed to create test6.mbtiles

 

I apologize in advance for my limited knowledge.

 

Thanks for your help,

Best regards

Giorgio 

 

 

Giorgio Ghiggini

 

GEC s.r.l.

Via Monte Matanna 1/C

55049 Viareggio (LU)

Italy

P.Iva: 02412390466

Fatt.Ele.: M5UXCR1

cell.: +39 331 141 9315

email:  <mailto:gghiggini at gec-it.com> gghiggini at gec-it.com

skype: ghigio2000

www.gec-it.com

 <http://www.globalterramaps.com/> www.globalterramaps.com

 <http://www.globalaquamaps.com/> www.globalaquamaps.com

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190619/391e3091/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: conf.json
Type: application/json
Size: 858 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190619/391e3091/attachment.json>

From even.rouault at spatialys.com  Wed Jun 19 03:25:44 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Jun 2019 12:25:44 +0200
Subject: [gdal-dev] ogr2ogr MVT use of CONF parameter
In-Reply-To: <00de01d52685$58bb1860$0a314920$@gec-it.com>
References: <00de01d52685$58bb1860$0a314920$@gec-it.com>
Message-ID: <2172321.sgdfQUD7ry@even-i700>

> ogr2ogr -F MVT test6.mbtiles 8-0.0-55.0.sqlite -dsco CONF=conf.json -dsco
> FORMAT=MBTILES
> 

Actually currently, the CONF option only accepts a JSon string, not a 
filename.
So currently, you should provide inline, with proper escaping.
Something like that (but not completely sure of escaping rules in windows 
shells)

-dsco CONF="{ \"poly\": { \"target_name\": \"mypoly\" } }"

That said, I've just added support for accepting a filename as well (in master 
and backported to 3.0 branch), since that is completely reasonable as an 
expectation.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gghiggini at gec-it.com  Wed Jun 19 05:41:09 2019
From: gghiggini at gec-it.com (Giorgio Ghiggini)
Date: Wed, 19 Jun 2019 14:41:09 +0200
Subject: [gdal-dev] ogr2ogr MVT use of CONF parameter
In-Reply-To: <2172321.sgdfQUD7ry@even-i700>
References: <00de01d52685$58bb1860$0a314920$@gec-it.com>
 <2172321.sgdfQUD7ry@even-i700>
Message-ID: <00e901d5269c$46ba5d30$d42f1790$@gec-it.com>

thanks a lot

-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 
Sent: mercoledì 19 giugno 2019 12:26
To: gdal-dev at lists.osgeo.org
Cc: Giorgio Ghiggini <gghiggini at gec-it.com>
Subject: Re: [gdal-dev] ogr2ogr MVT use of CONF parameter

> ogr2ogr -F MVT test6.mbtiles 8-0.0-55.0.sqlite -dsco CONF=conf.json 
> -dsco FORMAT=MBTILES
> 

Actually currently, the CONF option only accepts a JSon string, not a
filename.
So currently, you should provide inline, with proper escaping.
Something like that (but not completely sure of escaping rules in windows
shells)

-dsco CONF="{ \"poly\": { \"target_name\": \"mypoly\" } }"

That said, I've just added support for accepting a filename as well (in
master and backported to 3.0 branch), since that is completely reasonable as
an expectation.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com


From lt.noye at gmail.com  Wed Jun 19 16:46:20 2019
From: lt.noye at gmail.com (Lynden)
Date: Thu, 20 Jun 2019 09:46:20 +1000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <74db03bd-f33c-910c-e4f6-b45200a37a5e@gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
 <2711013.m1moKplxID@even-i700>
 <74db03bd-f33c-910c-e4f6-b45200a37a5e@gmail.com>
Message-ID: <E81530D2-8701-4842-BF78-E7973C22843E@gmail.com>

I like the idea of dipping my toes in by looking at the command line flags like Eli mentioned for ogr2ogr and ogrinfo and adding some of the more basic things.

Then I could compile my ideas for some more tutorial or example guides somewhat like Mapbox’s JS/iOS SDK beginner examples? https://docs.mapbox.com/ios/maps/examples/
They should have simple high level goals relevant to the tool but broadly applicable to the basic tasks people may have.

Lynden

> On 19 Jun 2019, at 05:42, Cameron Shorter <cameron.shorter at gmail.com> wrote:
> 
> Doing some cross-pollination of ideas between gdal list (techies) and osgeo season of docs list (writers)...
> 
> Feedback Lynden received from GDAL community based on his offer to help with docs ...
> 
> 
> 
>> On 16/6/19 2:02 pm, Lynden Noye wrote:
>> While Cameron is not wrong about me being a dev, that's been a more recent thing for me professionally, I'm a much more experienced UX & UI designer ;)
>> 
>> Cameron, I've subscribed to this list too, I look forward to hearing back on where I might be able to help out!
>> 
>>> On Sat, Jun 15, 2019 at 10:00 PM Cameron Shorter <cameron.shorter at gmail.com> wrote:
>>> Hi GDAL folks,
>>> 
>>> I'd like to introduce you to Lynden who has dropped by our OSGeo Season of Docs community. He is a developer, has used ogr2ogr, is an "expert gdal newbie", and is keen to give back to GDAL through documentation.
>>> 
>>> Do you have thoughts on where there are documentation needs, and where Lynden could be most impactful?
>>> 
>>> Cheers, Cameron
>>> 
>> On 17/6/19 10:43 pm, Even Rouault wrote:
>> Hi,
>> 
>> this is really great news ! Given my experience with the project, I'm rather 
>> far from being representative of someone less familiar with it or with a non-
>> developer profile, so thoughts from the broader GDAL community on what they 
>> feel is the most missing would be welcome.
>> 
>> One thing I've in mind - this is rather a detail - is that we lost a bit of 
>> content (build requirements for each driver) during the Sphinx migration, as 
>> pointed out by
>> https://github.com/OSGeo/gdal/issues/1204#issuecomment-498624481 , so this 
>> could be a potential task.
>> 
>> More generally, I feel we might need more tutorial-like / how-to style 
>> documentation. The current documentation is hopefully rather decent as a 
>> reference guide, but lacking on the quick-start side. On the wiki, there are 
>> some source of information, mostly from
>> https://trac.osgeo.org/gdal/wiki/UserDocs , that could be interesting to 
>> migrate partly on the main documentation, but with a critical eye (some of the 
>> hints might be outdated due to later improvements, etc)
>> 
>> Lynden, perhaps you've also suggestions from your practice of the project and 
>> its documentation on what you'd like to see added ?
>> 
>> Even
>> 
>> On 18/6/19 1:16 am, Eli Adam wrote:
>> There are some things that are very basic that might make the
>> documentation more understandable to a beginner.  I'm not sure if
>> these things are true or I've made them up or they are supposed to be
>> too obvious to state.
>> 
>> -nln = New Layer Name
>> -nlt = New Layer Type
>> -a_srs = assign spatial reference system
>> -t_srs = target spatial reference system
>> -s_srs = source spatial reference system
>> 
>> -ot = output type
>> -of = output format
>> 
>> Are those true?  If not, I've used them to better understand (and
>> remember) the options.
>> On 18/6/19 3:15 am, Ivan Lucena wrote:
>> Talking about basics... Most of the SDK we download to build drivers comes with an INSTALL file (.md or not) and that is what people usually look for when they decide that they need to download and build a FOSS. But GDAL doesn't have that. Yes, the information is there, somewhere but it would be nice to have it more accessible for newbies.
>> On 18/6/19 6:11 pm, Jeremy Palmer wrote:
>> I think we could do with documenting the https://trac.osgeo.org/gdal/wiki/ConfigOptions in a more complete way and including it in the main website documentation. We could also consider including all config options that apply to a driver such as https://gdal.org/drivers/raster/gtiff.html#configuration-options
> -- 
> Cameron Shorter
> Technology Demystifier
> Open Technologies and Geospatial Consultant
> 
> M +61 (0) 419 142 254
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190620/573b0e4b/attachment.html>

From ktheijs at gmail.com  Thu Jun 20 05:46:45 2019
From: ktheijs at gmail.com (Franik)
Date: Thu, 20 Jun 2019 05:46:45 -0700 (MST)
Subject: [gdal-dev] Getting all known coordinate systems.
Message-ID: <1561034805243-0.post@n6.nabble.com>

I am updating to GDAL 3.0 (C# bindings). 

I need a list of all the supported coordinate systems in my application.

In the older versions, I requested all the known coordinate systems by
reading the csv files in the GDAL_DATA folder (pcs.csv, gcs.csv,...).

In the the new version, the csv files have been replaced by the proj.db
file. Does anyone know of a good way to get all the coordinate systems.
Should I just try to read the proj.db file myself and extract all the
records? Or is there some kind of method exposed for this?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Jun 20 05:59:32 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Jun 2019 14:59:32 +0200
Subject: [gdal-dev] Getting all known coordinate systems.
In-Reply-To: <1561034805243-0.post@n6.nabble.com>
References: <1561034805243-0.post@n6.nabble.com>
Message-ID: <1612309.sC136Cjz8d@even-i700>

On jeudi 20 juin 2019 05:46:45 CEST Franik wrote:
> I am updating to GDAL 3.0 (C# bindings).
> 
> I need a list of all the supported coordinate systems in my application.
> 
> In the older versions, I requested all the known coordinate systems by
> reading the csv files in the GDAL_DATA folder (pcs.csv, gcs.csv,...).
> 
> In the the new version, the csv files have been replaced by the proj.db
> file. Does anyone know of a good way to get all the coordinate systems.
> Should I just try to read the proj.db file myself and extract all the
> records? Or is there some kind of method exposed for this?

There's a osr.GetCRSInfoListFromDatabase() method in the SWIG bindings 
(binding of OSRGetCRSInfoListFromDatabase()), but it is only exposed for the 
Python bindings currently. 

A new SWIG typemap should be written for the other binding languages, so that 
osr.GetCRSInfoListFromDatabase() can be used with them.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Thu Jun 20 06:46:53 2019
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 20 Jun 2019 15:46:53 +0200
Subject: [gdal-dev] Getting all known coordinate systems.
In-Reply-To: <1612309.sC136Cjz8d@even-i700>
References: <1561034805243-0.post@n6.nabble.com> <1612309.sC136Cjz8d@even-i700>
Message-ID: <A535A605-6316-4260-856C-45AC685A8CE3@gmail.com>

Do we have a ticket for this addition? I can take care of the c# part.

Best regards,

Tamas

Sent from my iPhone

2019. jún. 20. dátummal, 14:59 időpontban Even Rouault <even.rouault at spatialys.com> írta:

>> On jeudi 20 juin 2019 05:46:45 CEST Franik wrote:
>> I am updating to GDAL 3.0 (C# bindings).
>> 
>> I need a list of all the supported coordinate systems in my application.
>> 
>> In the older versions, I requested all the known coordinate systems by
>> reading the csv files in the GDAL_DATA folder (pcs.csv, gcs.csv,...).
>> 
>> In the the new version, the csv files have been replaced by the proj.db
>> file. Does anyone know of a good way to get all the coordinate systems.
>> Should I just try to read the proj.db file myself and extract all the
>> records? Or is there some kind of method exposed for this?
> 
> There's a osr.GetCRSInfoListFromDatabase() method in the SWIG bindings 
> (binding of OSRGetCRSInfoListFromDatabase()), but it is only exposed for the 
> Python bindings currently. 
> 
> A new SWIG typemap should be written for the other binding languages, so that 
> osr.GetCRSInfoListFromDatabase() can be used with them.
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Jun 20 07:28:55 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Jun 2019 16:28:55 +0200
Subject: [gdal-dev] Getting all known coordinate systems.
In-Reply-To: <A535A605-6316-4260-856C-45AC685A8CE3@gmail.com>
References: <1561034805243-0.post@n6.nabble.com> <1612309.sC136Cjz8d@even-i700>
 <A535A605-6316-4260-856C-45AC685A8CE3@gmail.com>
Message-ID: <1607343.llvGeg59ez@even-i700>

On jeudi 20 juin 2019 15:46:53 CEST Tamas Szekeres wrote:
> Do we have a ticket for this addition? I can take care of the c# part.

I've just created https://github.com/OSGeo/gdal/issues/1665

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stephenwoodbridge37 at gmail.com  Thu Jun 20 13:06:25 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 20 Jun 2019 16:06:25 -0400
Subject: [gdal-dev] Is there an easy way to clip an image to the realdata?
Message-ID: <374fe360-777d-ddd0-23a7-5a10ff798549@gmail.com>

Hi,

I'm working with VIIRS L3U images of L2P (level 2 patches). The L3U data 
is gridded to the +-180 x +-90 but the patch only fills a small 
percentage of that. I'm compositing a the patch for a day using a vrt.

Performance is an issue because all the patches cover the whole globe 
instead of the extents of the patch.

Is there a way to automatically clip an image to the extents of the 
patch, where all the rest of the image it filled with nodata? IE. remove 
all rows and columns from the exterior edges that are all nodata and 
stop when you hit real data.

-Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From paul.dante at ubc.ca  Thu Jun 20 13:26:47 2019
From: paul.dante at ubc.ca (Dante, Paul)
Date: Thu, 20 Jun 2019 20:26:47 +0000
Subject: [gdal-dev] How do I get lat long extents from this Ogrinfo output
	on a .shp?
Message-ID: <BE606CB8BC2D954B9585CEE6A3F4C993826F0D40@S-ITSV-MBX04P.ead.ubc.ca>

I ran ogrinfo on a shape file and got output. How do I convert the extent listed below into lat long coordinates? It looks like the units are meters, but I’m not sure how that will translate to lat long for creating a bounding box:

INFO: Open of `OldStreamsPolyline.shp'
      using driver `ESRI Shapefile' successful.

Layer name: OldStreamsPolyline
Metadata:
  DBF_DATE_LAST_UPDATE=2011-02-17
Geometry: Line String
Feature Count: 179
Extent: (482246.857278, 5449862.717375) - (498293.801839, 5462019.990072)
Layer SRS WKT:
PROJCS["NAD83 / UTM zone 10N",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-123],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","26910"]]
Id: Integer (6.0)
Name: String (50.0)
Region: String (2.0)
Type: String (50.0)


Paul Dante
Software Developer - Geodisy
Walter C. Koerner Library | UBC Library
The University of British Columbia | Vancouver Campus
219-1958 Main Mall | Vancouver BC | V6T 1Z2 Canada
Phone 604 827 5129
paul.dante at ubc.ca<mailto:paul.dante at ubc.ca>

UBC Vancouver is located on the traditional, ancestral, unceded territory of the xʷməθkʷəy̓əm (Musqueam) people
[cid:image001.png at 01D42428.A8255E20]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190620/bad8e2a8/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 5500 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190620/bad8e2a8/attachment.png>

From stephenwoodbridge37 at gmail.com  Thu Jun 20 13:33:21 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 20 Jun 2019 16:33:21 -0400
Subject: [gdal-dev] How do I get lat long extents from this Ogrinfo
 output on a .shp?
In-Reply-To: <BE606CB8BC2D954B9585CEE6A3F4C993826F0D40@S-ITSV-MBX04P.ead.ubc.ca>
References: <BE606CB8BC2D954B9585CEE6A3F4C993826F0D40@S-ITSV-MBX04P.ead.ubc.ca>
Message-ID: <f299c498-543d-261b-1d80-bc91f74a4269@gmail.com>

Hi Paul,

Its not just the extents but all the data in the file is in a UTM 
projection. You can reproject the file to WGS84 and then ogrinfo will 
report in long-lat.

ogr2ogr -t_srs EPSG:4326 OldStreamsPolyline-wgs84.shp OldStreamsPolyline.shp
ogrinfo -so OldStreamsPolyline-wgs84.shp OldStreamsPolyline-wgs84

-Steve W

On 6/20/2019 4:26 PM, Dante, Paul wrote:
>
> I ran ogrinfo on a shape file and got output. How do I convert the 
> extent listed below into lat long coordinates? It looks like the units 
> are meters, but I’m not sure how that will translate to lat long for 
> creating a bounding box:
>
> INFO: Open of `OldStreamsPolyline.shp'
>
>       using driver `ESRI Shapefile' successful.
>
> Layer name: OldStreamsPolyline
>
> Metadata:
>
> DBF_DATE_LAST_UPDATE=2011-02-17
>
> Geometry: Line String
>
> Feature Count: 179
>
> Extent: (482246.857278, 5449862.717375) - (498293.801839, 5462019.990072)
>
> Layer SRS WKT:
>
> PROJCS["NAD83 / UTM zone 10N",
>
> GEOGCS["NAD83",
>
> DATUM["North_American_Datum_1983",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6269"]],
>
> PRIMEM["Greenwich",0,
>
>   AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4269"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-123],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","26910"]]
>
> Id: Integer (6.0)
>
> Name: String (50.0)
>
> Region: String (2.0)
>
> Type: String (50.0)
>
> Paul Dante
>
> Software Developer - Geodisy
>
> Walter C. Koerner Library | UBC Library
>
> The University of British Columbia | Vancouver Campus
> 219-1958 Main Mall | Vancouver BC | V6T 1Z2 Canada
>
> Phone 604 827 5129
>
> paul.dante at ubc.ca <mailto:paul.dante at ubc.ca>__
>
> UBC Vancouver is located on the traditional, ancestral, unceded 
> territory of the xʷməθkʷəy̓əm (Musqueam) people
>
> cid:image001.png at 01D42428.A8255E20
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From cameron.shorter at gmail.com  Thu Jun 20 14:14:45 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Fri, 21 Jun 2019 07:14:45 +1000
Subject: [gdal-dev] Static/Dynamic datum problems
Message-ID: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>

Hi folks,

Our Australian spatial data users are about to face a systematic mismatch
challenge when trying to use multiple static datums (GDA2020, GDA94) with
the dynamic datum (WGS84). At the moment, it is government agencies
grappling with the problem, but it is about to become a mainstream issue.

Australia now has static datums for the years 1994 and 2020 and uses WGS84
(a time-dependent datum!), for web-mapping and web-services.  We recognise:
1. Transforming from GDA94 to GDA2020 reflects Australia’s tectonic
movement of ~ 1.8 metres to the North East.
2. GDA94 was defined as ‘equal to WGS84’ in 1994.
3. GDA2020  was defined as ‘equal to WGS84’ in 2020.
All three statements can’t be accurate. It results in mis-aligned maps in
WGS84

I believe this is a problem the whole world needs to address, given the
upcoming modernsation of significant national datums including the U.S and
we need to bring this topic into an international conversation, ASAP.
I'm interested to know if anyone here is looking into and/or has opinions
on how it should be solved. I'd like to incorporate your ideas into the
recommendations that we are putting foward.
-- 
Cameron Shorter
Technology Demystifier
Open Technologies and Geospatial Consultant

M +61 (0) 419 142 254
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190621/2dd0a2d4/attachment.html>

From paul.dante at ubc.ca  Thu Jun 20 14:20:05 2019
From: paul.dante at ubc.ca (Dante, Paul)
Date: Thu, 20 Jun 2019 21:20:05 +0000
Subject: [gdal-dev] How do I get lat long extents from this Ogrinfo
 output on a .shp?
In-Reply-To: <f299c498-543d-261b-1d80-bc91f74a4269@gmail.com>
References: <BE606CB8BC2D954B9585CEE6A3F4C993826F0D40@S-ITSV-MBX04P.ead.ubc.ca>
 <f299c498-543d-261b-1d80-bc91f74a4269@gmail.com>
Message-ID: <BE606CB8BC2D954B9585CEE6A3F4C993826F1181@S-ITSV-MBX04P.ead.ubc.ca>

Steve,

Thanks, that works wonderfully!

I figured the other data in the file was UTM as well, but I'm only using the extents in my program, which is why I focused on them.

+Paul

Paul Dante
Software Developer - Geodisy
Walter C. Koerner Library | UBC Library 
The University of British Columbia | Vancouver Campus
219-1958 Main Mall | Vancouver BC | V6T 1Z2 Canada 
Phone 604 827 5129 
paul.dante at ubc.ca

UBC Vancouver is located on the traditional, ancestral, unceded territory of the xʷməθkʷəy̓əm (Musqueam) people


-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Stephen Woodbridge
Sent: Thursday, June 20, 2019 1:33 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How do I get lat long extents from this Ogrinfo output on a .shp?

Hi Paul,

Its not just the extents but all the data in the file is in a UTM projection. You can reproject the file to WGS84 and then ogrinfo will report in long-lat.

ogr2ogr -t_srs EPSG:4326 OldStreamsPolyline-wgs84.shp OldStreamsPolyline.shp ogrinfo -so OldStreamsPolyline-wgs84.shp OldStreamsPolyline-wgs84

-Steve W

On 6/20/2019 4:26 PM, Dante, Paul wrote:
>
> I ran ogrinfo on a shape file and got output. How do I convert the 
> extent listed below into lat long coordinates? It looks like the units 
> are meters, but I’m not sure how that will translate to lat long for 
> creating a bounding box:
>
> INFO: Open of `OldStreamsPolyline.shp'
>
>       using driver `ESRI Shapefile' successful.
>
> Layer name: OldStreamsPolyline
>
> Metadata:
>
> DBF_DATE_LAST_UPDATE=2011-02-17
>
> Geometry: Line String
>
> Feature Count: 179
>
> Extent: (482246.857278, 5449862.717375) - (498293.801839, 
> 5462019.990072)
>
> Layer SRS WKT:
>
> PROJCS["NAD83 / UTM zone 10N",
>
> GEOGCS["NAD83",
>
> DATUM["North_American_Datum_1983",
>
> SPHEROID["GRS 1980",6378137,298.257222101,
>
> AUTHORITY["EPSG","7019"]],
>
> TOWGS84[0,0,0,0,0,0,0],
>
> AUTHORITY["EPSG","6269"]],
>
> PRIMEM["Greenwich",0,
>
>   AUTHORITY["EPSG","8901"]],
>
> UNIT["degree",0.0174532925199433,
>
> AUTHORITY["EPSG","9122"]],
>
> AUTHORITY["EPSG","4269"]],
>
> PROJECTION["Transverse_Mercator"],
>
> PARAMETER["latitude_of_origin",0],
>
> PARAMETER["central_meridian",-123],
>
> PARAMETER["scale_factor",0.9996],
>
> PARAMETER["false_easting",500000],
>
> PARAMETER["false_northing",0],
>
> UNIT["metre",1,
>
> AUTHORITY["EPSG","9001"]],
>
> AXIS["Easting",EAST],
>
> AXIS["Northing",NORTH],
>
> AUTHORITY["EPSG","26910"]]
>
> Id: Integer (6.0)
>
> Name: String (50.0)
>
> Region: String (2.0)
>
> Type: String (50.0)
>
> Paul Dante
>
> Software Developer - Geodisy
>
> Walter C. Koerner Library | UBC Library
>
> The University of British Columbia | Vancouver Campus
> 219-1958 Main Mall | Vancouver BC | V6T 1Z2 Canada
>
> Phone 604 827 5129
>
> paul.dante at ubc.ca <mailto:paul.dante at ubc.ca>__
>
> UBC Vancouver is located on the traditional, ancestral, unceded 
> territory of the xʷməθkʷəy̓əm (Musqueam) people
>
> cid:image001.png at 01D42428.A8255E20
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From cameron.shorter at gmail.com  Thu Jun 20 14:30:20 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Fri, 21 Jun 2019 07:30:20 +1000
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <CAH4yv=euRVD1+gCGHcx8RKo=mwW_DDc3jgAaPpxo68hDjYm=5A@mail.gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <f8eeca77-d000-c0c5-81db-c6b23f6ce285@gmail.com>
 <ca8b4177-474c-3184-5816-768302d9f02a@gmail.com>
 <2711013.m1moKplxID@even-i700>
 <74db03bd-f33c-910c-e4f6-b45200a37a5e@gmail.com>
 <E81530D2-8701-4842-BF78-E7973C22843E@gmail.com>
 <CAH4yv=euRVD1+gCGHcx8RKo=mwW_DDc3jgAaPpxo68hDjYm=5A@mail.gmail.com>
Message-ID: <CABqeU+jEDcRccDvF1Fx0rTJD5AR08khgrcv+QBj8K3o9pMy_zA@mail.gmail.com>

Lynden, I'm looping in the gdal and seasonofdocs email lists with your
permission, because:
* This is a good question and I think there are others interested in the
answers
* People on these lists will likely add more value to my answers.

Lynden, your approach sounds good. I'm not familiar with the mechanics of
adding docs to the gdal. I'm hoping the gdal team will provide an answer
here.

With regards to what content to write, we have technical writer volunteers
on the season of docs email list keen to help with structure. (A few of
them live in Melbourne, Australia with you.)  When you are ready we can set
up a meeting to plan your structure and approach.

A starting point for you to think about is to define the doc types you are
writing, as described here:
https://www.divio.com/blog/documentation/

Cheers, Cameron

On Thu, 20 Jun 2019 at 11:34, Lynden Noye <lt.noye at gmail.com> wrote:

> Hi Cameron, what should be my process for getting started?
>
> Can I just open PRs against the docs in question in Github? Should I shoot
> the link around the mailing list when I've opened a PR?
>
> Or is there something more formal that needs to happen with regards to
> approval before getting started?
>
> I didn't want to bother the whole mailing list with these questions,
> unless... that's its purpose? haha
>
> On Thu, Jun 20, 2019 at 9:46 AM Lynden <lt.noye at gmail.com> wrote:
>
>> I like the idea of dipping my toes in by looking at the command line
>> flags like Eli mentioned for ogr2ogr and ogrinfo and adding some of the
>> more basic things.
>>
>> Then I could compile my ideas for some more tutorial or example guides
>> somewhat like Mapbox’s JS/iOS SDK beginner examples?
>> https://docs.mapbox.com/ios/maps/examples/
>> They should have simple high level goals relevant to the tool but broadly
>> applicable to the basic tasks people may have.
>>
>> Lynden
>>
>> On 19 Jun 2019, at 05:42, Cameron Shorter <cameron.shorter at gmail.com>
>> wrote:
>>
>> Doing some cross-pollination of ideas between gdal list (techies) and
>> osgeo season of docs list (writers)...
>>
>> Feedback Lynden received from GDAL community based on his offer to help
>> with docs ...
>>
>>
>> On 16/6/19 2:02 pm, Lynden Noye wrote:
>>
>> While Cameron is not wrong about me being a dev, that's been a more
>> recent thing for me professionally, I'm a much more experienced UX & UI
>> designer ;)
>>
>> Cameron, I've subscribed to this list too, I look forward to hearing back
>> on where I might be able to help out!
>>
>> On Sat, Jun 15, 2019 at 10:00 PM Cameron Shorter <
>> cameron.shorter at gmail.com> wrote:
>>
>>> Hi GDAL folks,
>>>
>>> I'd like to introduce you to Lynden who has dropped by our OSGeo Season
>>> of Docs community. He is a developer, has used ogr2ogr, is an "expert gdal
>>> newbie", and is keen to give back to GDAL through documentation.
>>>
>>> Do you have thoughts on where there are documentation needs, and where
>>> Lynden could be most impactful?
>>>
>>> Cheers, Cameron
>>>
>> On 17/6/19 10:43 pm, Even Rouault wrote:
>>
>> Hi,
>>
>> this is really great news ! Given my experience with the project, I'm rather
>> far from being representative of someone less familiar with it or with a non-
>> developer profile, so thoughts from the broader GDAL community on what they
>> feel is the most missing would be welcome.
>>
>> One thing I've in mind - this is rather a detail - is that we lost a bit of
>> content (build requirements for each driver) during the Sphinx migration, as
>> pointed out byhttps://github.com/OSGeo/gdal/issues/1204#issuecomment-498624481 , so this
>> could be a potential task.
>>
>> More generally, I feel we might need more tutorial-like / how-to style
>> documentation. The current documentation is hopefully rather decent as a
>> reference guide, but lacking on the quick-start side. On the wiki, there are
>> some source of information, mostly fromhttps://trac.osgeo.org/gdal/wiki/UserDocs , that could be interesting to
>> migrate partly on the main documentation, but with a critical eye (some of the
>> hints might be outdated due to later improvements, etc)
>>
>> Lynden, perhaps you've also suggestions from your practice of the project and
>> its documentation on what you'd like to see added ?
>>
>> Even
>>
>>
>> On 18/6/19 1:16 am, Eli Adam wrote:
>>
>> There are some things that are very basic that might make the
>> documentation more understandable to a beginner.  I'm not sure if
>> these things are true or I've made them up or they are supposed to be
>> too obvious to state.
>>
>> -nln = New Layer Name
>> -nlt = New Layer Type
>> -a_srs = assign spatial reference system
>> -t_srs = target spatial reference system
>> -s_srs = source spatial reference system
>>
>> -ot = output type
>> -of = output format
>>
>> Are those true?  If not, I've used them to better understand (and
>> remember) the options.
>>
>> On 18/6/19 3:15 am, Ivan Lucena wrote:
>>
>> Talking about basics... Most of the SDK we download to build drivers
>> comes with an INSTALL file (.md or not) and that is what people usually
>> look for when they decide that they need to download and build a FOSS. But
>> GDAL doesn't have that. Yes, the information is there, somewhere but it
>> would be nice to have it more accessible for newbies.
>>
>> On 18/6/19 6:11 pm, Jeremy Palmer wrote:
>>
>> I think we could do with documenting the
>> https://trac.osgeo.org/gdal/wiki/ConfigOptions in a more complete way
>> and including it in the main website documentation. We could also consider
>> including all config options that apply to a driver such as
>> https://gdal.org/drivers/raster/gtiff.html#configuration-options
>>
>> --
>> Cameron Shorter
>> Technology Demystifier
>> Open Technologies and Geospatial Consultant
>>
>> M +61 (0) 419 142 254
>>
>>

-- 
Cameron Shorter
Technology Demystifier
Open Technologies and Geospatial Consultant

M +61 (0) 419 142 254
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190621/d1b471cb/attachment-0001.html>

From even.rouault at spatialys.com  Thu Jun 20 14:41:31 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Jun 2019 23:41:31 +0200
Subject: [gdal-dev] [SeasonOfDocs] Offers for GDAL documenting
In-Reply-To: <CABqeU+jEDcRccDvF1Fx0rTJD5AR08khgrcv+QBj8K3o9pMy_zA@mail.gmail.com>
References: <CAH4yv=dVRKDr+uZoZXvLfUqcO79s=MC2rsJ8fq-2_dsDyS6UTQ@mail.gmail.com>
 <CAH4yv=euRVD1+gCGHcx8RKo=mwW_DDc3jgAaPpxo68hDjYm=5A@mail.gmail.com>
 <CABqeU+jEDcRccDvF1Fx0rTJD5AR08khgrcv+QBj8K3o9pMy_zA@mail.gmail.com>
Message-ID: <2122348.AQAQ5u3ILN@even-i700>

On vendredi 21 juin 2019 07:30:20 CEST Cameron Shorter wrote:
> Lynden, I'm looping in the gdal and seasonofdocs email lists with your
> permission, because:
> * This is a good question and I think there are others interested in the
> answers
> * People on these lists will likely add more value to my answers.
> 
> Lynden, your approach sounds good. I'm not familiar with the mechanics of
> adding docs to the gdal. I'm hoping the gdal team will provide an answer
> here.

Sphinx based documentation at:
https://github.com/OSGeo/gdal/tree/master/gdal/doc

Build recipee:

Linux or Mac
------------

>From gdal/doc directory, install build dependencies with:
pip3 install --upgrade -r requirements.txt

and then:
make html

OR

Linux
-----

>From gdal/doc directory,
you can also use a Docker image that has already all build dependencies:

docker pull osgeo/proj-docs
docker run -v $PWD:/doc osgeo/proj-docs /bin/sh -c "cd /doc && make html"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 20 15:20:26 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Jun 2019 00:20:26 +0200
Subject: [gdal-dev] Static/Dynamic datum problems
In-Reply-To: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
References: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
Message-ID: <1604074.RSeUgcd6NO@even-i700>

Cameron,

This would be more a topic for proj at lists.osgeo.org .

> 
> Our Australian spatial data users are about to face a systematic mismatch
> challenge when trying to use multiple static datums (GDA2020, GDA94) with
> the dynamic datum (WGS84). At the moment, it is government agencies
> grappling with the problem, but it is about to become a mainstream issue.
> 
> Australia now has static datums for the years 1994 and 2020 and uses WGS84
> (a time-dependent datum!), for web-mapping and web-services.  We recognise:
> 1. Transforming from GDA94 to GDA2020 reflects Australia’s tectonic
> movement of ~ 1.8 metres to the North East.
> 2. GDA94 was defined as ‘equal to WGS84’ in 1994.
> 3. GDA2020  was defined as ‘equal to WGS84’ in 2020.
> All three statements can’t be accurate.

Why ? I don't see a contradiction between those 3 statements, because as you 
mentionned, WGS84 is dynamic.

> I believe this is a problem the whole world needs to address,

I'm not sure to have understood what the problem you're facing to is exactly. 
Is it when combining data sources from several of those 3 CRS ?

There are transformation paths between GDA94 and GDA2020 in the EPSG dataset, 
with static Helmert-based or grid-based transformations.

With PROJ 6:
$ projinfo -s GDA94 -t GDA2020 --summary --spatial-test intersects
Candidate operations found: 5
EPSG:8048, GDA94 to GDA2020 (1), 0.01 m, Australia - GDA
EPSG:8447, GDA94 to GDA2020 (2), 0.05 m, Australia - onshore, at least one 
grid missing
EPSG:8446, GDA94 to GDA2020 (3), 0.05 m, Australia - onshore, at least one 
grid missing
EPSG:8445, GDA94 to GDA2020 (5), 0.05 m, Cocos (Keeling) Islands - onshore, at 
least one grid missing
EPSG:8444, GDA94 to GDA2020 (4), 0.05 m, Christmas Island - onshore, at least 
one grid missing

Mixing with data referenced to WGS84 is going to be more problematic, because 
of its dynamic nature indeed. So typically you will need to know if 
coordinates are expressed to one of the particular realizations of WGS84:
CRS EPSG:7816: WGS 84 (Transit)
CRS EPSG:7657: WGS 84 (G730)
CRS EPSG:7659: WGS 84 (G873)
CRS EPSG:7661: WGS 84 (G1150)
CRS EPSG:7663: WGS 84 (G1674)
CRS EPSG:7665: WGS 84 (G1762)

The EPSG datset contains coordinate operations between those WGS 84 or 
equivalent ITRF realizations, and GDA94 or GDA2020

To/from GDA2020:
- EPSG:8049: "ITRF2014 to GDA2020 (1)'" (Time-dependent Coordinate Frame 
rotation)
- EPSG:8448: "GDA2020 to WGS 84 (G1762)" (Time-dependent Coordinate Frame 
rotation)

To/from GDA94:
- EPSG:6276: "ITRF2008 to GDA94 (1)" (Time-dependent Coordinate Frame 
rotation)
- EPSG:6277: "ITRF2005 to GDA94 (1)" (Time-dependent Coordinate Frame 
rotation)
- EPSG:6278: "ITRF2000 to GDA94 (2)" (Time-dependent Coordinate Frame 
rotation)
- EPSG:6279: "ITRF97 to GDA94 (2)" (Time-dependent Coordinate Frame rotation)
- EPSG:6280: "ITRF96 to GDA94 (2)" (Time-dependent Coordinate Frame rotation)
- EPSG:6313: "ITRF96 to GDA94 (1)" (Time-dependent Coordinate Frame rotation)
- EPSG:6314: "ITRF97 to GDA94 (1)" (Time-dependent Coordinate Frame rotation)
- EPSG:6315: "ITRF2000 to GDA94 (1)" (Time-dependent Coordinate Frame 
rotation)
- EPSG:6392: "ITRF97 to GDA94 (1)" (Time-dependent Coordinate Frame rotation)

So it seems to me that the needed operations are there. GDAL 3 and PROJ 6 
should be able to use them. What is probably more difficult is to figure out 
the WGS84 / ITRF realization and the epoch in which your coordinates are 
expressed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cameron.shorter at gmail.com  Fri Jun 21 01:08:45 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Fri, 21 Jun 2019 18:08:45 +1000
Subject: [gdal-dev] Static/Dynamic datum problems
In-Reply-To: <1604074.RSeUgcd6NO@even-i700>
References: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
 <1604074.RSeUgcd6NO@even-i700>
Message-ID: <CABqeU+gbnUpwZA38K+u2=kdb7-cnJn5AUdoTugrvBVyhB=r-uA@mail.gmail.com>

I've switched this email thread to  proj at lists.osgeo.org as suggested.

On Fri, 21 Jun 2019 at 08:20, Even Rouault <even.rouault at spatialys.com>
wrote:

> Cameron,
>
> This would be more a topic for proj at lists.osgeo.org .
> <snip>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190621/5f3dbd81/attachment.html>

From norman.barker at gmail.com  Sun Jun 23 16:14:08 2019
From: norman.barker at gmail.com (Norman Barker)
Date: Sun, 23 Jun 2019 16:14:08 -0700
Subject: [gdal-dev] backport and conda
Message-ID: <CAN_Dn-HXtdHk+4PXyv_jPmyEn9GN-rwRHH6QDsFpUSyZP8+6Dw@mail.gmail.com>

Hi,

with the backport bot how often does the GDAL conda release get updated? Is
this something that can be triggered through the bot?

Thanks,

Norman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190623/507da44e/attachment.html>

From craig.destigter at koordinates.com  Mon Jun 24 00:16:46 2019
From: craig.destigter at koordinates.com (Craig de Stigter)
Date: Mon, 24 Jun 2019 19:16:46 +1200
Subject: [gdal-dev] Vagrant build environment
Message-ID: <CAF1M8pd2ctpYpxDU7U65AjynrwKJ8r6fugE8SYCOJDjVJtYxLA@mail.gmail.com>

Hi folks

I sat down to finish off a pull request I started months ago, and realised
that GDAL's vagrant build no longer works. It fails quite early in
provisioning.

I think this is probably because Ubuntu 14.04 is no longer in upstream
support, and the ubuntugis PPA has stopped supplying packages for it:

>     default: Unable to locate package postgresql-9.3-postgis-2.2
>     default: Unable to locate package libopenjp2-7-dev
>     default: Unable to locate package libopenjpip7
>     default: Unable to locate package libopenjp3d7
>

Is there a newer recommended way to easily get a dev build of GDAL running,
with a reasonably complete set of drivers? An updated vagrantfile for
Ubuntu 18.04 would be pretty ideal...

-- 
Regards,
Craig

Developer
Koordinates

+64 21 256 9488 <+64%2021%20256%209488> / koordinates.com / @koordinates
<https://twitter.com/koordinates>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190624/ac054d4b/attachment.html>

From even.rouault at spatialys.com  Mon Jun 24 00:20:15 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Jun 2019 09:20:15 +0200
Subject: [gdal-dev] backport and conda
In-Reply-To: <CAN_Dn-HXtdHk+4PXyv_jPmyEn9GN-rwRHH6QDsFpUSyZP8+6Dw@mail.gmail.com>
References: <CAN_Dn-HXtdHk+4PXyv_jPmyEn9GN-rwRHH6QDsFpUSyZP8+6Dw@mail.gmail.com>
Message-ID: <12395900.vdurhWQWaM@even-i700>

Norman,

this is a good question. I've no idea who is in charge of doing GDAL Conda 
updates...
But I guess Conda only packages official releases, and not git HEAD.

Even

> Hi,
> 
> with the backport bot how often does the GDAL conda release get updated? Is
> this something that can be triggered through the bot?
> 
> Thanks,
> 
> Norman


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jun 24 00:25:14 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Jun 2019 09:25:14 +0200
Subject: [gdal-dev] Vagrant build environment
In-Reply-To: <CAF1M8pd2ctpYpxDU7U65AjynrwKJ8r6fugE8SYCOJDjVJtYxLA@mail.gmail.com>
References: <CAF1M8pd2ctpYpxDU7U65AjynrwKJ8r6fugE8SYCOJDjVJtYxLA@mail.gmail.com>
Message-ID: <2094323.7SMpCvQRrL@even-i700>

Hi Craig,

> I sat down to finish off a pull request I started months ago, and realised
> that GDAL's vagrant build no longer works. It fails quite early in
> provisioning.
> 
> I think this is probably because Ubuntu 14.04 is no longer in upstream

Ah, I guess this is a matter of using the following PPAs due to a change a few 
weeks ago in ubuntugis (they moved packages from unstable to stable):

sudo add-apt-repository -y ppa:ubuntugis/ppa
sudo add-apt-repository -y ppa:ubuntugis/ubuntugis-testing

> An updated vagrantfile for Ubuntu 18.04 would be pretty ideal...

Woud be reasonable indeed if someone wants to tackle this.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cpaulik at vandersat.com  Mon Jun 24 01:15:43 2019
From: cpaulik at vandersat.com (Christoph Paulik)
Date: Mon, 24 Jun 2019 10:15:43 +0200
Subject: [gdal-dev] backport and conda
In-Reply-To: <12395900.vdurhWQWaM@even-i700>
References: <CAN_Dn-HXtdHk+4PXyv_jPmyEn9GN-rwRHH6QDsFpUSyZP8+6Dw@mail.gmail.com>
 <12395900.vdurhWQWaM@even-i700>
Message-ID: <CAHtCBng=O0V4Oi4KkO2eKhPD5Dh4k3zFrRhER4vuH7W4L2mkDw@mail.gmail.com>

Hi,

Basically anybody can open a Pull request against
https://github.com/conda-forge/gdal-feedstock for a re-build.

But I'm not sure how 3.0.0 and 2.4.x releases at the same time are handled.

This is of course for the conda-forge version of gdal.

Christoph

On Mon, 24 Jun 2019 at 09:20, Even Rouault <even.rouault at spatialys.com>
wrote:

> Norman,
>
> this is a good question. I've no idea who is in charge of doing GDAL Conda
> updates...
> But I guess Conda only packages official releases, and not git HEAD.
>
> Even
>
> > Hi,
> >
> > with the backport bot how often does the GDAL conda release get updated?
> Is
> > this something that can be triggered through the bot?
> >
> > Thanks,
> >
> > Norman
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
*Christoph Paulik* // Head of Infrastructure
VanderSat // Satellite observed water data. Globally. Daily.
Wilhelminastraat 43a, 2011 VK, Haarlem (NL), The Netherlands
<https://maps.google.com/?q=Wilhelminastraat+43a,+2011+VK,+Haarlem+(NL),+The+Netherlands&entry=gmail&source=g>
*M*  +31 6 18271928 *W*  www.vandersat.com

--------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190624/8055024e/attachment.html>

From doug_newcomb at fws.gov  Mon Jun 24 06:30:29 2019
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Mon, 24 Jun 2019 09:30:29 -0400
Subject: [gdal-dev] [EXTERNAL]  Static/Dynamic datum problems
In-Reply-To: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
References: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
Message-ID: <CALQGVr3-FK18wy4yFO1-vjTLnOMfVG_VAQDjmqVWXTKcRZh29g@mail.gmail.com>

Cameron,
 I just emailed  someone working on this .  He sent me the links below.

https://www.gps.gov/governance/advisory/

https://www.gps.gov/governance/advisory/members/higgins/

Doug

On Thu, Jun 20, 2019 at 5:15 PM Cameron Shorter <cameron.shorter at gmail.com>
wrote:

> Hi folks,
>
> Our Australian spatial data users are about to face a systematic mismatch
> challenge when trying to use multiple static datums (GDA2020, GDA94) with
> the dynamic datum (WGS84). At the moment, it is government agencies
> grappling with the problem, but it is about to become a mainstream issue.
>
> Australia now has static datums for the years 1994 and 2020 and uses WGS84
> (a time-dependent datum!), for web-mapping and web-services.  We recognise:
> 1. Transforming from GDA94 to GDA2020 reflects Australia’s tectonic
> movement of ~ 1.8 metres to the North East.
> 2. GDA94 was defined as ‘equal to WGS84’ in 1994.
> 3. GDA2020  was defined as ‘equal to WGS84’ in 2020.
> All three statements can’t be accurate. It results in mis-aligned maps in
> WGS84
>
> I believe this is a problem the whole world needs to address, given the
> upcoming modernsation of significant national datums including the U.S and
> we need to bring this topic into an international conversation, ASAP.
> I'm interested to know if anyone here is looking into and/or has opinions
> on how it should be solved. I'd like to incorporate your ideas into the
> recommendations that we are putting foward.
> --
> Cameron Shorter
> Technology Demystifier
> Open Technologies and Geospatial Consultant
>
> M +61 (0) 419 142 254
>
>
>
>

-- 
Doug Newcomb - Cartographer
USFWS
551F Pylon Dr
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------

*NOTE: This email correspondence and any attachments to and from this
sender is subject to the Freedom of Information Act (FOIA) and may be
disclosed to third parties.*​
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190624/fc94eca6/attachment-0001.html>

From nikitapetroff at gmail.com  Mon Jun 24 08:24:58 2019
From: nikitapetroff at gmail.com (Nikita Petrov)
Date: Mon, 24 Jun 2019 18:24:58 +0300
Subject: [gdal-dev] Problem building GDAL 3.0.0 on VS2015 x64
Message-ID: <CAGFi3LsvE2cqTfJ0eQa8KtRpDxKWoQLFCwYuiXUdy4dJ41vU_A@mail.gmail.com>

Dear all,

I have a strange error while building GDAL 3.0.0:


C:\OSG\test_osg\build\gdal>if exist *.ilk del *.ilk
link /nologo /dll /INCLUDE:OSRValidate  /INCLUDE:OGR_G_GetPointCount
 /INCLUDE:OGRRegisterAll /INCLUDE:GDALSimpleImageWarp
 /INCLUDE:GDALReprojectImage  /INCLUDE:GDALComputeMedianCutPCT
 /INCLUDE:GDALDitherRGB2PCT  /INCLUDE:OCTNewCoordinateTransformation
port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj
ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib gnm\*.obj gnm\gnm_frmts\o\*.obj
third_party\o\*.obj apps\commonutils.obj apps\gdalinfo_lib.obj
apps\gdal_translate_lib.obj apps\gdalwarp_lib.obj apps\ogr2ogr_lib.obj
 apps\gdaldem_lib.obj apps\nearblack_lib.obj apps\gdal_grid_lib.obj
apps\gdal_rasterize_lib.obj apps\gdalbuildvrt_lib.obj
 C:\OSG\test_osg\install\libjpeg\Release\lib\jpeg.lib
 C:\OSG\test_osg\install\libgeotiff\Release\lib\geotiff.lib
C:\OSG\test_osg\install\libtiff\Release\lib\tiff.lib
C:\OSG\test_osg\install\proj\Release\lib\proj_6_1.lib
 C:\OSG\test_osg\install\libcurl\Release\lib\libcurl_imp.lib wsock32.lib
wldap32.lib winmm.lib    legacy_stdio_definitions.lib odbc32.lib
odbccp32.lib user32.lib
 C:\OSG\test_osg\install\libpng\Release\lib\libpng16.lib
C:\OSG\test_osg\install\zlib\Release\lib\zlib.lib
ws2_32.lib  kernel32.lib psapi.lib gcore\Version.res  /out:gdal300.dll
/implib:gdal_i.lib
   Creating library gdal_i.lib and object gdal_i.exp
gdal_crs.obj : error LNK2019: unresolved external symbol
GDALSerializeGCPListToXML referenced in function GDALSerializeGCPTransformer
gdal_crs.obj : error LNK2019: unresolved external symbol
GDALDeserializeGCPListFromXML referenced in function
GDALDeserializeGCPTransformer
gdal300.dll : fatal error LNK1120: 2 unresolved externals


I build all the needed libs from sources with CMake and MSBuild:
- zlib 1.2.11
- libpng 1.6.37
- libjpeg-turbo 2.0.2
- libtiff 4.0.10
- libcurl 7.65.1
- proj.4 6.1.0
- libgeotiff 1.5.1

This error occurs in both Release and Debug builds.
Just today I've reinstalled Windows 10 x64 and made a clean install of
VS2015.3.

Any ideas what could be wrong?

Kind regards,
Nikita
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190624/92eafc5f/attachment.html>

From cameron.shorter at gmail.com  Mon Jun 24 10:04:55 2019
From: cameron.shorter at gmail.com (Cameron Shorter)
Date: Tue, 25 Jun 2019 03:04:55 +1000
Subject: [gdal-dev] [EXTERNAL]  Static/Dynamic datum problems
In-Reply-To: <CALQGVr3-FK18wy4yFO1-vjTLnOMfVG_VAQDjmqVWXTKcRZh29g@mail.gmail.com>
References: <CABqeU+i83CjcUu9sdUq-EvfmpNfRv34pMzTuT_xpKR+MZgEyQg@mail.gmail.com>
 <CALQGVr3-FK18wy4yFO1-vjTLnOMfVG_VAQDjmqVWXTKcRZh29g@mail.gmail.com>
Message-ID: <c5b8f7c5-cb8e-f185-a4c4-0d4f22fdb5bc@gmail.com>

I'm switching this email thread to proj at lists.osgeo.org (which is where 
the conversation has moved)

On 24/6/19 11:30 pm, Newcomb, Doug wrote:
> Cameron,
>  I just emailed  someone working on this .  He sent me the links below.
>
> https://www.gps.gov/governance/advisory/
>
> https://www.gps.gov/governance/advisory/members/higgins/
>
> Doug
>
>
-- 
Cameron Shorter
Technology Demystifier
Open Technologies and Geospatial Consultant

M +61 (0) 419 142 254

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190625/70be7275/attachment.html>

From adrianaparra at nevada.unr.edu  Mon Jun 24 19:38:41 2019
From: adrianaparra at nevada.unr.edu (Adriana Parra)
Date: Mon, 24 Jun 2019 19:38:41 -0700
Subject: [gdal-dev] Help with band pixel functions
Message-ID: <CAL=hy7+KFA6ebGVmkjdqEcKOVTeZGhpWO9ziaAs1QY=YdLK=vQ@mail.gmail.com>

Hello,

I have been trying to mosaic two images that partially overlap using band
pixel functions in Python. My images contain unsigned integers (uint8) and
the no data value is 255. I considered using the nanmean function so that I
would get average values in overlapping areas of the two images and
maintain the original value of the non-overlapping areas, but for some
reason the NAN values are being interpreted as zero, resulting in half of
the original value in non-overlapping areas.  I would really appreciate any
feedback. I am using GDAL 3.1.0 and python 3.6. Bellow is the code I used
and I am sending attached the input files.
gdalbuildvrt  mosaic1.vrt -input_file_list  input_files.txt -srcnodata "255"

 import numpy as np
def average(in_ar, out_ar, xoff, yoff, xsize, ysize,
raster_xsize,raster_ysize, buf_radius, gt, **kwargs):
    np.round_(np.clip(np.nanmean(in_ar, axis = 0, dtype = 'uint8'),0,255),
              out = out_ar)

gdal_translate --config GDAL_VRT_ENABLE_PYTHON YES mosaic1.vrt mosaic1.tif

 Mosaic1.jpeg
<https://drive.google.com/a/nevada.unr.edu/file/d/1YgugcVnU6d5BmPYkYcotqBi3fFQcPpY8/view?usp=drive_web>
 raw_files.jpeg
<https://drive.google.com/a/nevada.unr.edu/file/d/1SQoH58V3MGtP-oXYnPYsf66snFOsWagC/view?usp=drive_web>
 test_files.7z
<https://drive.google.com/a/nevada.unr.edu/file/d/14No5nblxhNKeOU8k86Gfan7utYIUSqRU/view?usp=drive_web>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190624/e4e3d50e/attachment.html>

From stephenwoodbridge37 at gmail.com  Mon Jun 24 21:57:20 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Tue, 25 Jun 2019 00:57:20 -0400
Subject: [gdal-dev] Help with band pixel functions
In-Reply-To: <CAL=hy7+KFA6ebGVmkjdqEcKOVTeZGhpWO9ziaAs1QY=YdLK=vQ@mail.gmail.com>
References: <CAL=hy7+KFA6ebGVmkjdqEcKOVTeZGhpWO9ziaAs1QY=YdLK=vQ@mail.gmail.com>
Message-ID: <b7bd948d-b72c-5a33-34d0-59d281e290be@gmail.com>

Hi Adriana,

Here are a few ideas:

import numpy as np

ima = gdal.Open(filea, 0)
banda = ima.GetRasterBand(1)
dataa = banda.ReadAsArray()

print type(dataa), dataa.shape, isinstance(dataa, np.ma.MaskedArray)

imb = gdal.Open(fileb, 0)
bandb = imb.GetRasterBand(1)
datab = bandb.ReadAsArray()

print type(datab), datab.shape, isinstance(datab, np.ma.MaskedArray)

So if you have masked arrays, where the fill_value=255, ie: your nodata 
value

The mask is True for nodata so

weights = dataa.mask | datab.mask
np.average([dataa, datab], axis=0, weights=weights)

You might need to invert the weights in which case try weights=~weights 
instead.

You might need to do this in three operations using appropriate masks
1) copy dataa values that are not masked but are in datab
2) copy datab values that are not masked but are in dataa
3) to copy the average of dataa and datab where they are both not masked.

Another option might be to use numpy.vectorize() to apply a function to 
each cell in an array:
https://docs.scipy.org/doc/numpy/reference/generated/numpy.vectorize.html

-Steve

On 6/24/2019 10:38 PM, Adriana Parra wrote:
> Hello,
>
> I have been trying to mosaic two images that partially overlap using 
> band pixel functions in Python. My images contain unsigned integers 
> (uint8) and the no data value is 255. I considered using the nanmean 
> function so that I would get average values in overlapping areas of 
> the two images and maintain the original value of the non-overlapping 
> areas, but for some reason the NAN values are being interpreted as 
> zero, resulting in half of the original value in non-overlapping 
> areas.  I would really appreciate any feedback. I am using GDAL 3.1.0 
> and python 3.6. Bellow is the code I used and I am sending attached 
> the input files.
> gdalbuildvrt  mosaic1.vrt -input_file_list  input_files.txt -srcnodata 
> "255"
>
>  import numpy as np
> def average(in_ar, out_ar, xoff, yoff, xsize, ysize, 
> raster_xsize,raster_ysize, buf_radius, gt, **kwargs):
>     np.round_(np.clip(np.nanmean(in_ar, axis = 0, dtype = 'uint8'),0,255),
>               out = out_ar)
>
> gdal_translate --config GDAL_VRT_ENABLE_PYTHON YES mosaic1.vrt mosaic1.tif
>
> Mosaic1.jpeg 
> <https://drive.google.com/a/nevada.unr.edu/file/d/1YgugcVnU6d5BmPYkYcotqBi3fFQcPpY8/view?usp=drive_web>
> raw_files.jpeg 
> <https://drive.google.com/a/nevada.unr.edu/file/d/1SQoH58V3MGtP-oXYnPYsf66snFOsWagC/view?usp=drive_web>
> test_files.7z 
> <https://drive.google.com/a/nevada.unr.edu/file/d/14No5nblxhNKeOU8k86Gfan7utYIUSqRU/view?usp=drive_web>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun 25 00:02:06 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 25 Jun 2019 07:02:06 +0000
Subject: [gdal-dev] Help user when /vsicurl/ reads GetFileSize=0
Message-ID: <31bd49d60aa543f5bb2b5579b097733d@C119S212VM042.msvyvi.vaha.local>

Hi,

Have a look at https://gis.stackexchange.com/questions/326773/importing-shapefile-from-website-if-download-link-is-compressed-file/326778

I tried what happens with command

ogrinfo /vsizip/vsicurl/https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_l2_500k.zip --debug on

HTTP: libcurl/7.37.1 OpenSSL/1.0.1h zlib/1.2.3
VSICURL: GetFileSize(https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_l2_500k.zip)=0  response_code=200
VSICURL: Request at offset 0, after end of file
VSICURL: Request at offset 0, after end of file
VSICURL: Request at offset 0, after end of file
... repeats about 130 times
FAILURE:
Unable to open datasource `/vsizip/vsicurl/https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_l2_500k.zip' with the following drivers.

Does this mean that www2.census.gov supports HEAD request but it does not send the file size header, or the value of file size is 0? Perhaps vsicurl could catch this and show a meaningful message?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190625/a4fd3845/attachment.html>

From even.rouault at spatialys.com  Tue Jun 25 02:56:30 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jun 2019 11:56:30 +0200
Subject: [gdal-dev] Help user when /vsicurl/ reads GetFileSize=0
In-Reply-To: <31bd49d60aa543f5bb2b5579b097733d@C119S212VM042.msvyvi.vaha.local>
References: <31bd49d60aa543f5bb2b5579b097733d@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2512290.N4L1zrz3FJ@even-i700>

On mardi 25 juin 2019 07:02:06 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Have a look at
> https://gis.stackexchange.com/questions/326773/importing-shapefile-from-web
> site-if-download-link-is-compressed-file/326778
> 
> I tried what happens with command
> 
> ogrinfo
> /vsizip/vsicurl/https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_l
> 2_500k.zip --debug on
> 
> HTTP: libcurl/7.37.1 OpenSSL/1.0.1h zlib/1.2.3
> VSICURL:
> GetFileSize(https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_l2_50
> 0k.zip)=0  response_code=200 VSICURL: Request at offset 0, after end of file
> VSICURL: Request at offset 0, after end of file
> VSICURL: Request at offset 0, after end of file
> ... repeats about 130 times
> FAILURE:
> Unable to open datasource
> `/vsizip/vsicurl/https://www2.census.gov/geo/tiger/GENZ2010/gz_2010_36_620_
> l2_500k.zip' with the following drivers.
> 
> Does this mean that www2.census.gov supports HEAD request but it does not
> send the file size header,

That was the case here. If you add "--config CPL_CURL_VERBOSE YES", you get 
the headers returned.
I've just pushed a fix for that by retrying with a (interrupted) GET request 
when the HEAD does not return the Content-Length header.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jun 25 10:42:22 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jun 2019 19:42:22 +0200
Subject: [gdal-dev] Problem building GDAL 3.0.0 on VS2015 x64
In-Reply-To: <CAGFi3LsvE2cqTfJ0eQa8KtRpDxKWoQLFCwYuiXUdy4dJ41vU_A@mail.gmail.com>
References: <CAGFi3LsvE2cqTfJ0eQa8KtRpDxKWoQLFCwYuiXUdy4dJ41vU_A@mail.gmail.com>
Message-ID: <9039882.DKJKYKkZXu@even-i700>

On lundi 24 juin 2019 18:24:58 CEST Nikita Petrov wrote:
> Dear all,
> 
> I have a strange error while building GDAL 3.0.0:

For reference, turned out to be a false positive:
https://github.com/OSGeo/gdal/issues/1672

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From josh at federal.planet.com  Tue Jun 25 12:01:09 2019
From: josh at federal.planet.com (Josh Fix)
Date: Tue, 25 Jun 2019 15:01:09 -0400
Subject: [gdal-dev] VSI Paths
Message-ID: <CABY_9o4in83s-_UWDbOX6a+S9am0b9duJBg=FTNEWkg351-s=Q@mail.gmail.com>

Hi all, first time poster here.  I hope my question hasn't already been
discussed or answered elsewhere.  I'd like to access some COGs using
vsicurl.  The code base I'm working with attempts to validate image
locations as legitimate URLs, more specifically http:// or file://
locations.  The presence of the double slash (/vsicurl/https:*//*www....)
causes quite a few issues.

Has there been any thought or discussion around adding some sort of support
for a URL protocol/scheme that would allow these paths to be defined as a
more common resource location?  Eg, something like, `vsixxx://
www.x.com/my.tif`?

Josh Fix
Planet Federal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190625/d4db01b4/attachment.html>

From Melvin.LEGGE at ca.thalesgroup.com  Tue Jun 25 12:57:11 2019
From: Melvin.LEGGE at ca.thalesgroup.com (LEGGE Melvin)
Date: Tue, 25 Jun 2019 19:57:11 +0000
Subject: [gdal-dev] Distinguish between no DTED data and actual DTED
	elevation of 0
Message-ID: <3DE0113DCC86C3488FDF18999B139680CD37991F@THSONEA07MBX06P.one-07.grp>

Hi

I am a relative newbie to GIS programming so forgive me if I use the wrong terminology or don't state my problem in the most efficient GIS terms. Anyway, I have inherited a project written by an actual GIS person who is no longer with the company.

The DTED data consists of 4 GDalDatasets with actual DTED elevation data not reaching the boundaries of GDalDatasets - i.e., GDalDatasets are bigger than the actual DTED data.  Our program reads the elevation data along a bearing line from a given point to some requested distance, at regular intervals, by repeatedly calling GDALRasterBand->RasterIO for a specified distance.  What I am seeing is that elevation values of 0 are returned for points between the end of the DTED data and the end of the tile.

Is there any way I can distinguish between the situation above and an actual elevation of 0?  RasterIO always returns CE_None and the returned value is never equal to noDataValue.

Thanks
Mel




________________________________

WARNING: This message is intended only for the named recipients. This message may contain information that is confidential. Any dissemination, copying, or use of this message or its contents by anyone other than the named recipient is strictly prohibited. If you are not a named recipient or an employee or agent responsible for delivering this message to a named recipient, please notify the sender immediately, and immediately destroy this message and any copies you may have. WARNING: Email may not be secure unless properly encrypted. It is possible for e-mails to be intercepted or affected by viruses. While we maintain virus checks on all e-mails, we accept no liability for viruses or other material introduced with this message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190625/8692f589/attachment.html>

From shayne.tueller at us.af.mil  Tue Jun 25 18:17:10 2019
From: shayne.tueller at us.af.mil (TUELLER, SHAYNE R CIV USAF AFMC 519 SMXS/MXDEC)
Date: Wed, 26 Jun 2019 01:17:10 +0000
Subject: [gdal-dev] adding features to a layer/dataset...
Message-ID: <DM2P111MB01212EFF87DB7D1CBEDA7123C6E20@DM2P111MB0121.NAMP111.PROD.OUTLOOK.COM>

Hello,

I have a vector GDALDataset that is shared between two applications running on different machines. Both applications call GDALOpenEx(...) to open the shapefile.shp with flags GDAL_OF_VECTOR and GDAL_OF_SHARED flags set to open the dataset. The dataset only has one layer associated with it and the shapefile format is the ESRI shapefile.

After opening the dataset in both applications, the first application creates a new feature and adds it to the layer. The resulting shapefile on disk shows that this is working when I inspect the contents of the shapefile with ogrinfo -al shapefile.shp. The new feature has been added as expected with a feature count = 1.

Is there a way to update the second application to get the changes to the layer made by the first application? I've tried doing layer->SyncToDisk() in the second application but this has no affect. Do I have to close the layer/dataset and reopen it in the second application to get the changes made by the first application?

I'm new to OGR/GDAL so I hope my explanation and question makes sense...

Shayne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190626/ffb5b55d/attachment.html>

From even.rouault at spatialys.com  Wed Jun 26 04:40:35 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jun 2019 13:40:35 +0200
Subject: [gdal-dev] Distinguish between no DTED data and actual DTED
	elevation of 0
In-Reply-To: <3DE0113DCC86C3488FDF18999B139680CD37991F@THSONEA07MBX06P.one-07.grp>
References: <3DE0113DCC86C3488FDF18999B139680CD37991F@THSONEA07MBX06P.one-07.grp>
Message-ID: <3430916.utUvtFsBoD@even-i700>

On mardi 25 juin 2019 19:57:11 CEST LEGGE Melvin wrote:
> Hi
> 
> I am a relative newbie to GIS programming so forgive me if I use the wrong
> terminology or don't state my problem in the most efficient GIS terms.
> Anyway, I have inherited a project written by an actual GIS person who is
> no longer with the company.
> 
> The DTED data consists of 4 GDalDatasets with actual DTED elevation data not
> reaching the boundaries of GDalDatasets - i.e., GDalDatasets are bigger
> than the actual DTED data.  Our program reads the elevation data along a
> bearing line from a given point to some requested distance, at regular
> intervals, by repeatedly calling GDALRasterBand->RasterIO for a specified
> distance.  What I am seeing is that elevation values of 0 are returned for
> points between the end of the DTED data and the end of the tile.
> 
> Is there any way I can distinguish between the situation above and an actual
> elevation of 0? 

No this looks like a "bug" in the data production itself. You could probably 
add your own custom logic to detect that situation and fix those 0 on the 
edges of the product to nodata (nearblack might be of help for this)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Melvin.LEGGE at ca.thalesgroup.com  Wed Jun 26 05:05:36 2019
From: Melvin.LEGGE at ca.thalesgroup.com (LEGGE Melvin)
Date: Wed, 26 Jun 2019 12:05:36 +0000
Subject: [gdal-dev] Distinguish between no DTED data and actual DTED
 elevation of 0
In-Reply-To: <3430916.utUvtFsBoD@even-i700>
References: <3DE0113DCC86C3488FDF18999B139680CD37991F@THSONEA07MBX06P.one-07.grp>
 <3430916.utUvtFsBoD@even-i700>
Message-ID: <3DE0113DCC86C3488FDF18999B139680CD379A64@THSONEA07MBX06P.one-07.grp>

Thanks Even

So based on your response, a GDalDataSet normally should have valid data all the way to its edges?
Mel

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: Wednesday, June 26, 2019 7:39 AM
To: gdal-dev at lists.osgeo.org
Cc: LEGGE Melvin
Subject: Re: [gdal-dev] Distinguish between no DTED data and actual DTED elevation of 0

On mardi 25 juin 2019 19:57:11 CEST LEGGE Melvin wrote:
> Hi
>
> I am a relative newbie to GIS programming so forgive me if I use the wrong
> terminology or don't state my problem in the most efficient GIS terms.
> Anyway, I have inherited a project written by an actual GIS person who is
> no longer with the company.
>
> The DTED data consists of 4 GDalDatasets with actual DTED elevation data not
> reaching the boundaries of GDalDatasets - i.e., GDalDatasets are bigger
> than the actual DTED data.  Our program reads the elevation data along a
> bearing line from a given point to some requested distance, at regular
> intervals, by repeatedly calling GDALRasterBand->RasterIO for a specified
> distance.  What I am seeing is that elevation values of 0 are returned for
> points between the end of the DTED data and the end of the tile.
>
> Is there any way I can distinguish between the situation above and an actual
> elevation of 0?

No this looks like a "bug" in the data production itself. You could probably
add your own custom logic to detect that situation and fix those 0 on the
edges of the product to nodata (nearblack might be of help for this)

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com

________________________________

WARNING: This message is intended only for the named recipients. This message may contain information that is confidential. Any dissemination, copying, or use of this message or its contents by anyone other than the named recipient is strictly prohibited. If you are not a named recipient or an employee or agent responsible for delivering this message to a named recipient, please notify the sender immediately, and immediately destroy this message and any copies you may have. WARNING: Email may not be secure unless properly encrypted. It is possible for e-mails to be intercepted or affected by viruses. While we maintain virus checks on all e-mails, we accept no liability for viruses or other material introduced with this message.

From even.rouault at spatialys.com  Wed Jun 26 05:15:19 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jun 2019 14:15:19 +0200
Subject: [gdal-dev] Distinguish between no DTED data and actual DTED
	elevation of 0
In-Reply-To: <3DE0113DCC86C3488FDF18999B139680CD379A64@THSONEA07MBX06P.one-07.grp>
References: <3DE0113DCC86C3488FDF18999B139680CD37991F@THSONEA07MBX06P.one-07.grp>
 <3430916.utUvtFsBoD@even-i700>
 <3DE0113DCC86C3488FDF18999B139680CD379A64@THSONEA07MBX06P.one-07.grp>
Message-ID: <6862869.5eb1EP7qi6@even-i700>

On mercredi 26 juin 2019 12:05:36 CEST LEGGE Melvin wrote:
> Thanks Even
> 
> So based on your response, a GDalDataSet normally should have valid data all
> the way to its edges?

This all depends on the content of the dataset you read. GDAL will just expose 
it as it is on file, without adding artificial 0.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jun 26 13:00:05 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jun 2019 22:00:05 +0200
Subject: [gdal-dev] adding features to a layer/dataset...
In-Reply-To: <DM2P111MB01212EFF87DB7D1CBEDA7123C6E20@DM2P111MB0121.NAMP111.PROD.OUTLOOK.COM>
References: <DM2P111MB01212EFF87DB7D1CBEDA7123C6E20@DM2P111MB0121.NAMP111.PROD.OUTLOOK.COM>
Message-ID: <1722471.4FqlehFUx7@even-i700>

Shayne,

> 
> I have a vector GDALDataset that is shared between two applications running
> on different machines. Both applications call GDALOpenEx(...) to open the
> shapefile.shp with flags GDAL_OF_VECTOR and GDAL_OF_SHARED flags set to
> open the dataset. The dataset only has one layer associated with it and the
> shapefile format is the ESRI shapefile.
> 

GDAL_OF_SHARED is for sharing the same dataset handle in the same process, not 
for sharing datasets from several machines.

> After opening the dataset in both applications, the first application
> creates a new feature and adds it to the layer. The resulting shapefile on
> disk shows that this is working when I inspect the contents of the
> shapefile with ogrinfo -al shapefile.shp. The new feature has been added as
> expected with a feature count = 1.
> 
> Is there a way to update the second application to get the changes to the
> layer made by the first application? I've tried doing layer->SyncToDisk()
> in the second application but this has no affect. Do I have to close the
> layer/dataset and reopen it in the second application to get the changes
> made by the first application?

Yes, GDAL doesn't handle synchronization/concurrent edition of shapefiles (or 
any other file based formats), so if a file has been changed outside of GDAL, 
you have to close and reopen the dataset to be sure that GDAL sees the changes 
(sometimes you might see them, or some of them, while keeping the dataset 
open, but it would be too fragile to rely on that)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stephenwoodbridge37 at gmail.com  Wed Jun 26 14:26:13 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Wed, 26 Jun 2019 17:26:13 -0400
Subject: [gdal-dev] adding features to a layer/dataset...
In-Reply-To: <1722471.4FqlehFUx7@even-i700>
References: <DM2P111MB01212EFF87DB7D1CBEDA7123C6E20@DM2P111MB0121.NAMP111.PROD.OUTLOOK.COM>
 <1722471.4FqlehFUx7@even-i700>
Message-ID: <3369a690-d528-4cdb-82d0-22c6f1bc2a8b@gmail.com>

Shayne,

To solve your problem, given the constraints the Even explained, you 
probably need to do something like:

* program that is writing to shapefile
    - creates a socket or pipe
    - open the file for exclusive access
    - after it updates the shapefile
    - close the file
    - writes to the socket a message like "updated"

* program that need to read the shapefile
    - opens socket or pipe created by first program
    - waits on read from socket for a message
    - on getting "updated" message
    - opens the shapefile for read
    - reads the data, then closes the file
    - processes the shape data
    - loops back to wait on read from socket

You also need a shared network filesystem that supports opening the 
shapefile exclusively for both read and write operations so the file is 
not overwritten while it is being accessed.

All that said, this is not really a GDAL issue, and you probably need to 
get advice from a network programming expert because there are issues 
like handling trying to open the file when its locked, stale locks, 
network failures, etc.

-Steve

On 6/26/2019 4:00 PM, Even Rouault wrote:
> Shayne,
>
>> I have a vector GDALDataset that is shared between two applications running
>> on different machines. Both applications call GDALOpenEx(...) to open the
>> shapefile.shp with flags GDAL_OF_VECTOR and GDAL_OF_SHARED flags set to
>> open the dataset. The dataset only has one layer associated with it and the
>> shapefile format is the ESRI shapefile.
>>
> GDAL_OF_SHARED is for sharing the same dataset handle in the same process, not
> for sharing datasets from several machines.
>
>> After opening the dataset in both applications, the first application
>> creates a new feature and adds it to the layer. The resulting shapefile on
>> disk shows that this is working when I inspect the contents of the
>> shapefile with ogrinfo -al shapefile.shp. The new feature has been added as
>> expected with a feature count = 1.
>>
>> Is there a way to update the second application to get the changes to the
>> layer made by the first application? I've tried doing layer->SyncToDisk()
>> in the second application but this has no affect. Do I have to close the
>> layer/dataset and reopen it in the second application to get the changes
>> made by the first application?
> Yes, GDAL doesn't handle synchronization/concurrent edition of shapefiles (or
> any other file based formats), so if a file has been changed outside of GDAL,
> you have to close and reopen the dataset to be sure that GDAL sees the changes
> (sometimes you might see them, or some of them, while keeping the dataset
> open, but it would be too fragile to rely on that)
>
> Even
>


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From ao at t-kartor.se  Wed Jun 26 23:03:57 2019
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Thu, 27 Jun 2019 08:03:57 +0200
Subject: [gdal-dev] adding features to a layer/dataset...
In-Reply-To: <3369a690-d528-4cdb-82d0-22c6f1bc2a8b@gmail.com>
References: <DM2P111MB01212EFF87DB7D1CBEDA7123C6E20@DM2P111MB0121.NAMP111.PROD.OUTLOOK.COM>
 <1722471.4FqlehFUx7@even-i700>
 <3369a690-d528-4cdb-82d0-22c6f1bc2a8b@gmail.com>
Message-ID: <59923e74-6057-9bca-469e-728f5af5a8ef@t-kartor.se>

or use a transactional database which handles all of these aspects (and 
several more) for you
> Shayne,
>
> To solve your problem, given the constraints the Even explained, you 
> probably need to do something like:
>
> * program that is writing to shapefile
>    - creates a socket or pipe
>    - open the file for exclusive access
>    - after it updates the shapefile
>    - close the file
>    - writes to the socket a message like "updated"
>
> * program that need to read the shapefile
>    - opens socket or pipe created by first program
>    - waits on read from socket for a message
>    - on getting "updated" message
>    - opens the shapefile for read
>    - reads the data, then closes the file
>    - processes the shape data
>    - loops back to wait on read from socket
>
> You also need a shared network filesystem that supports opening the 
> shapefile exclusively for both read and write operations so the file 
> is not overwritten while it is being accessed.
>
> All that said, this is not really a GDAL issue, and you probably need 
> to get advice from a network programming expert because there are 
> issues like handling trying to open the file when its locked, stale 
> locks, network failures, etc.
>
> -Steve
>
> On 6/26/2019 4:00 PM, Even Rouault wrote:
>> Shayne,
>>
>>> I have a vector GDALDataset that is shared between two applications 
>>> running
>>> on different machines. Both applications call GDALOpenEx(...) to 
>>> open the
>>> shapefile.shp with flags GDAL_OF_VECTOR and GDAL_OF_SHARED flags set to
>>> open the dataset. The dataset only has one layer associated with it 
>>> and the
>>> shapefile format is the ESRI shapefile.
>>>
>> GDAL_OF_SHARED is for sharing the same dataset handle in the same 
>> process, not
>> for sharing datasets from several machines.
>>
>>> After opening the dataset in both applications, the first application
>>> creates a new feature and adds it to the layer. The resulting 
>>> shapefile on
>>> disk shows that this is working when I inspect the contents of the
>>> shapefile with ogrinfo -al shapefile.shp. The new feature has been 
>>> added as
>>> expected with a feature count = 1.
>>>
>>> Is there a way to update the second application to get the changes 
>>> to the
>>> layer made by the first application? I've tried doing 
>>> layer->SyncToDisk()
>>> in the second application but this has no affect. Do I have to close 
>>> the
>>> layer/dataset and reopen it in the second application to get the 
>>> changes
>>> made by the first application?
>> Yes, GDAL doesn't handle synchronization/concurrent edition of 
>> shapefiles (or
>> any other file based formats), so if a file has been changed outside 
>> of GDAL,
>> you have to close and reopen the dataset to be sure that GDAL sees 
>> the changes
>> (sometimes you might see them, or some of them, while keeping the 
>> dataset
>> open, but it would be too fragile to rely on that)
>>
>> Even
>>
>
>
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Hälsningar

Andreas Oxenstierna
T-Kartor Geospatial AB
Olof Mohlins väg 12 Kristianstad
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From lars.schylberg at blixtmail.se  Thu Jun 27 07:30:57 2019
From: lars.schylberg at blixtmail.se (lars.schylberg at blixtmail.se)
Date: Thu, 27 Jun 2019 14:30:57 +0000
Subject: [gdal-dev] Is there an easy way to clip an image to the
 realdata?
In-Reply-To: <374fe360-777d-ddd0-23a7-5a10ff798549@gmail.com>
References: <374fe360-777d-ddd0-23a7-5a10ff798549@gmail.com>
Message-ID: <cc2e90fb32aba516afa9ec0e3561d367@blixtmail.se>

Hi Steve,

Sorry for the late reply!

I have some scripts that I developed this winter that contains a function
to clip an image or images to the parts that only contains data.

My aim was to create tighter tile indexes for Mapserver.  
I achieved good results for my use case.  

This will be one of the topics that I will present in my talk at 
FOSS4G in Bucharest in August.  I haven't yet prepared the details how to 
explain what I did.  But here we go:

1) First I retile the data to suitable size,
2) then check for empty tiles that I throw away.

The function "trim_tile" is actually what You are asking for, I think.

What I do in the function trim_tile is to use:

1) gdal_calc to produce a binary image where I have data
2) polygonize where data exists
3) compare extents
4) clip data with gdal_translate with projwin argument, if polygon extent is smaller

All is done in a bash script, since it is my preferred language to do things fast.
I use gnu parallel to speed things up. In my case I had 16 cpus in the server.
Some versions of parallel requires the argument "--will-cite", others don't. 

I made my own bash version of retiling that keeps masks.

Further notes is that the script is working on paletted tif 8 bit image.
I have a version for rbg images also.  The main difference is that the
empty image test looks like this in that case:

STDDEV=$(gdalinfo $tile -stats | \
	grep STATISTICS_STDDEV | \
	sed 's/STATISTICS_STDDEV=//g' | \
	awk '{$1=$1;printf "%d", $1}')
	
	if [ "$STDDEV" = "000" ]; then
		/bin/rm $tile
	fi
	
If You have tagged nodata values, those have to be removed with gdal_edit.py 
before You run statistics and then reaplied afterwards with gdal_edit again.	

This might hopefully give some inspiration for you how to tackle your 
use case.

The full script can be found here:  

https://gist.github.com/LarsSchy/9ecb31eb964dd83820c139b2f2769a7c

Have fun

Lars Schylberg


20 juni 2019 kl. 22:06, "Stephen Woodbridge" <stephenwoodbridge37 at gmail.com> skrev:

> Hi,
> 
> I'm working with VIIRS L3U images of L2P (level 2 patches). The L3U data 
> is gridded to the +-180 x +-90 but the patch only fills a small 
> percentage of that. I'm compositing a the patch for a day using a vrt.
> 
> Performance is an issue because all the patches cover the whole globe 
> instead of the extents of the patch.
> 
> Is there a way to automatically clip an image to the extents of the 
> patch, where all the rest of the image it filled with nodata? IE. remove 
> all rows and columns from the exterior edges that are all nodata and 
> stop when you hit real data.
> 
> -Steve
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From stephenwoodbridge37 at gmail.com  Thu Jun 27 08:19:00 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 27 Jun 2019 11:19:00 -0400
Subject: [gdal-dev] Is there an easy way to clip an image to the
	realdata?
In-Reply-To: <cc2e90fb32aba516afa9ec0e3561d367@blixtmail.se>
References: <374fe360-777d-ddd0-23a7-5a10ff798549@gmail.com>
 <cc2e90fb32aba516afa9ec0e3561d367@blixtmail.se>
Message-ID: <c44207e7-1040-aa1b-6cd5-ea3dda8bca9a@gmail.com>

Hi Lars,

Thank you for sharing your ideas and scripts. These will come in handy 
for the future.
For this project I took a different approach of creating a master tiff 
and then copying the data from each patch into that master tiff. It 
turns  out that this was pretty straight forward in python given that 
each patch is masked array and by inverting the mask I end up with a 
mask of the good data that I can conditionally copy into the master. So 
now I have one image with all the real data from 100+ patches which I 
was trying to get using a vrt.

Come to think of it, it might be possible to get the BBOX of the 
inverted mask, and then use that to slice the 2d numpy array and just 
output the sliced image. Something to play with later.

Thanks again,
   -Steve

On 6/27/2019 10:30 AM, lars.schylberg at blixtmail.se wrote:
> Hi Steve,
>
> Sorry for the late reply!
>
> I have some scripts that I developed this winter that contains a function
> to clip an image or images to the parts that only contains data.
>
> My aim was to create tighter tile indexes for Mapserver.
> I achieved good results for my use case.
>
> This will be one of the topics that I will present in my talk at
> FOSS4G in Bucharest in August.  I haven't yet prepared the details how to
> explain what I did.  But here we go:
>
> 1) First I retile the data to suitable size,
> 2) then check for empty tiles that I throw away.
>
> The function "trim_tile" is actually what You are asking for, I think.
>
> What I do in the function trim_tile is to use:
>
> 1) gdal_calc to produce a binary image where I have data
> 2) polygonize where data exists
> 3) compare extents
> 4) clip data with gdal_translate with projwin argument, if polygon extent is smaller
>
> All is done in a bash script, since it is my preferred language to do things fast.
> I use gnu parallel to speed things up. In my case I had 16 cpus in the server.
> Some versions of parallel requires the argument "--will-cite", others don't.
>
> I made my own bash version of retiling that keeps masks.
>
> Further notes is that the script is working on paletted tif 8 bit image.
> I have a version for rbg images also.  The main difference is that the
> empty image test looks like this in that case:
>
> STDDEV=$(gdalinfo $tile -stats | \
> 	grep STATISTICS_STDDEV | \
> 	sed 's/STATISTICS_STDDEV=//g' | \
> 	awk '{$1=$1;printf "%d", $1}')
> 	
> 	if [ "$STDDEV" = "000" ]; then
> 		/bin/rm $tile
> 	fi
> 	
> If You have tagged nodata values, those have to be removed with gdal_edit.py
> before You run statistics and then reaplied afterwards with gdal_edit again.	
>
> This might hopefully give some inspiration for you how to tackle your
> use case.
>
> The full script can be found here:
>
> https://gist.github.com/LarsSchy/9ecb31eb964dd83820c139b2f2769a7c
>
> Have fun
>
> Lars Schylberg
>
>
> 20 juni 2019 kl. 22:06, "Stephen Woodbridge" <stephenwoodbridge37 at gmail.com> skrev:
>
>> Hi,
>>
>> I'm working with VIIRS L3U images of L2P (level 2 patches). The L3U data
>> is gridded to the +-180 x +-90 but the patch only fills a small
>> percentage of that. I'm compositing a the patch for a day using a vrt.
>>
>> Performance is an issue because all the patches cover the whole globe
>> instead of the extents of the patch.
>>
>> Is there a way to automatically clip an image to the extents of the
>> patch, where all the rest of the image it filled with nodata? IE. remove
>> all rows and columns from the exterior edges that are all nodata and
>> stop when you hit real data.
>>
>> -Steve
>>
>> ---
>> This email has been checked for viruses by Avast antivirus software.
>> https://www.avast.com/antivirus
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Thu Jun 27 11:47:12 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Thu, 27 Jun 2019 18:47:12 +0000
Subject: [gdal-dev] kml file with line length too long
Message-ID: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Even

You may be interested in this GMT issue https://github.com/GenericMappingTools/gmt/issues/1012

As mentioned there, ogr2ogr fails for that file too. The diagnostic: line length too long.

Joaquim

From even.rouault at spatialys.com  Thu Jun 27 13:07:32 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Jun 2019 22:07:32 +0200
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <2536059.KnSvqPWpEo@even-i700>

On jeudi 27 juin 2019 18:47:12 CEST Joaquim Manuel Freire Luís wrote:
> Even
> 
> You may be interested in this GMT issue
> https://github.com/GenericMappingTools/gmt/issues/1012
> 
> As mentioned there, ogr2ogr fails for that file too. The diagnostic: line
> length too long.

Hum, ogr2ogr works fine here (2.4 and master on Linux, test with a 2.1.2 on a 
gisinternals Windows build as well). Just warnings about field name 
truncation.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Thu Jun 27 13:17:22 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Thu, 27 Jun 2019 20:17:22 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2536059.KnSvqPWpEo@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2536059.KnSvqPWpEo@even-i700>
Message-ID: <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

But not for me with a master (~1-2 weeks old) GDAL

ogr2ogr -f "ESRI Shapefile" test.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml
ERROR 1: Failed to create file test.shp\RGT 2 DOY-179 28-Jun-2019 04:55:18.shp: No error
ERROR 1: Terminating translation prematurely after failed
translation of layer RGT 2 DOY-179 28-Jun-2019 04:55:18 (use -skipfailures to skip errors)

C:\v>ogr2ogr --version
GDAL 3.1.0dev, released 2019/99/99

|>-----Original Message-----
|>From: Even Rouault <even.rouault at spatialys.com>
|>Sent: Thursday, June 27, 2019 9:08 PM
|>To: gdal-dev at lists.osgeo.org
|>Cc: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Subject: Re: [gdal-dev] kml file with line length too long
|>
|>On jeudi 27 juin 2019 18:47:12 CEST Joaquim Manuel Freire Luís wrote:
|>> Even
|>>
|>> You may be interested in this GMT issue
|>> https://github.com/GenericMappingTools/gmt/issues/1012
|>>
|>> As mentioned there, ogr2ogr fails for that file too. The diagnostic:
|>> line length too long.
|>
|>Hum, ogr2ogr works fine here (2.4 and master on Linux, test with a 2.1.2 on a
|>gisinternals Windows build as well). Just warnings about field name truncation.
|>
|>Even
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jun 27 13:40:54 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Jun 2019 22:40:54 +0200
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2536059.KnSvqPWpEo@even-i700>
 <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <2728472.Y6kk128VFT@even-i700>

On jeudi 27 juin 2019 20:17:22 CEST Joaquim Manuel Freire Luís wrote:
> But not for me with a master (~1-2 weeks old) GDAL
> 
> ogr2ogr -f "ESRI Shapefile" test.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml
> ERROR 1: Failed to create file test.shp\RGT 2 DOY-179 28-Jun-2019
> 04:55:18.shp: No error ERROR 1: Terminating translation prematurely after
> failed
> translation of layer RGT 2 DOY-179 28-Jun-2019 04:55:18 (use -skipfailures
> to skip errors)
> 

Ah, I suspect you might have a file "test.shp" already existing, but here as 
it a multi-layer KML file, the shapefile drivers tries to create a "test.shp" 
directory. A bit of cleanup in your working dir should fix that.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 27 14:01:03 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 27 Jun 2019 14:01:03 -0700 (MST)
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2728472.Y6kk128VFT@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2536059.KnSvqPWpEo@even-i700>
 <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700>
Message-ID: <1561669263857-0.post@n6.nabble.com>

Test with yesterdays GDAL 3.1.0dev from gisinternals creates a directory
"lolo.shp", writes the first shapefile into it but fails with the second.
Debug shows this:

ogr2ogr -f "ESRI shapefile" lolo.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml
--debug on
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_BAG.dll using
GDALRegister_BAG.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_FITS.dll
using GDALRegister_FITS.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_GMT.dll using
GDALRegister_GMT.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF4.dll
using GDALRegister_HDF4.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF4Image.dll
using GDALRegister_HDF4Image.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF5.dll
using GDALRegister_HDF5.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF5Image.dll
using GDALRegister_HDF5Image.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_KEA.dll using
GDALRegister_KEA.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_MG4Lidar.dll
using GDALRegister_MG4Lidar.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_MrSID.dll
using GDALRegister_MrSID.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_netCDF.dll
using GDALRegister_netCDF.
GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\ogr_AmigoCloud.dll
using RegisterOGRAmigoCloud.
GDAL: GDALOpen(IS2_RGT_0002_cycle4_28-Jun-2019.kml, this=0000018665149690)
succeeds as LIBKML.
GDAL: GDALDriver::Create(ESRI
Shapefile,lolo.shp,0,0,0,Unknown,0000000000000000)
Shape: DBF Codepage = LDID/87 for
lolo.shp\IS2_RGT_0002_cycle4_28-Jun-2019.kml.shp
Shape: Treating as encoding 'ISO-8859-1'.
Warning 6: Normalized/laundered field name: 'description' to 'descriptio'
Warning 6: Field timestamp create as date field, though DateTime requested.
Warning 6: Field begin create as date field, though DateTime requested.
Warning 6: Field end create as date field, though DateTime requested.
Warning 6: Normalized/laundered field name: 'altitudeMode' to 'altitudeMo'
GDALVectorTranslate: 1 features written in layer
'IS2_RGT_0002_cycle4_28-Jun-2019.kml'
ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
04:55:18.shp: No error
ERROR 1: Terminating translation prematurely after failed
translation of layer RGT 2 DOY-179 28-Jun-2019 04:55:18 (use -skipfailures
to skip errors)
GDAL: GDALClose(lolo.shp, this=000001866542C1F0)
GDAL: GDALClose(IS2_RGT_0002_cycle4_28-Jun-2019.kml, this=0000018665149690)


-Jukka Rahkonen-




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jluis at ualg.pt  Thu Jun 27 14:27:14 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Thu, 27 Jun 2019 21:27:14 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2728472.Y6kk128VFT@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2536059.KnSvqPWpEo@even-i700>
 <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700>
Message-ID: <DB8PR04MB65074E21523B580A3FF01FBEA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Nope. I'm aware of that but no. Trying with a new name makes no difference.

ogr2ogr -f "ESRI Shapefile" lalaralala.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml
ERROR 1: Failed to create file lalaralala.shp\RGT 2 DOY-179 28-Jun-2019 04:55:18.shp: No error
ERROR 1: Terminating translation prematurely after failed
translation of layer RGT 2 DOY-179 28-Jun-2019 04:55:18 (use -skipfailures to skip errors)

But I suspect something with my built. In Mirone I have a MEX based on GDAL ~2.3 and it crashes. In GMT I have an experimental ogrread (GDAL3) and it crashes too. Is there anything particular with the KML format that I can look for?

|>-----Original Message-----
|>From: Even Rouault <even.rouault at spatialys.com>
|>Sent: Thursday, June 27, 2019 9:41 PM
|>To: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Cc: gdal-dev at lists.osgeo.org
|>Subject: Re: [gdal-dev] kml file with line length too long
|>
|>On jeudi 27 juin 2019 20:17:22 CEST Joaquim Manuel Freire Luís wrote:
|>> But not for me with a master (~1-2 weeks old) GDAL
|>>
|>> ogr2ogr -f "ESRI Shapefile" test.shp
|>> IS2_RGT_0002_cycle4_28-Jun-2019.kml
|>> ERROR 1: Failed to create file test.shp\RGT 2 DOY-179 28-Jun-2019
|>> 04:55:18.shp: No error ERROR 1: Terminating translation prematurely
|>> after failed translation of layer RGT 2 DOY-179 28-Jun-2019 04:55:18
|>> (use -skipfailures to skip errors)
|>>
|>
|>Ah, I suspect you might have a file "test.shp" already existing, but here as it a
|>multi-layer KML file, the shapefile drivers tries to create a "test.shp"
|>directory. A bit of cleanup in your working dir should fix that.
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com

From jluis at ualg.pt  Thu Jun 27 14:32:28 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 27 Jun 2019 21:32:28 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <1561669263857-0.post@n6.nabble.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2536059.KnSvqPWpEo@even-i700>
 <DB8PR04MB650777B68A168A9F148FB126A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700> <1561669263857-0.post@n6.nabble.com>
Message-ID: <DB8PR04MB65075B7549D9AE2564D3A5A4A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

With --debug on I get

C:\v>ogr2ogr -f "ESRI shapefile" lolo.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml --debug on
KML: Valid: 1 Version: 2.2
KML: Not handled: visibility
KML: Not handled: color
KML: Not handled: width
KML: Not handled: LineStyle
KML: Not handled: color
KML: Not handled: PolyStyle
KML: Not handled: Style
KML: Not handled: extrude
KML: Not handled: tesselate
KML: Not handled: visibility
KML: Not handled: color
KML: Not handled: scale
...
KML: Not handled: IconStyle
KML: Not handled: Style
KML: Not handled: id
GDAL: GDALOpen(IS2_RGT_0002_cycle4_28-Jun-2019.kml, this=00000242D7E059B0) succeeds as KML.
GDAL: GDALDriver::Create(ESRI Shapefile,lolo.shp,0,0,0,Unknown,0000000000000000)
ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019 04:55:18.shp: No error
ERROR 1: Terminating translation prematurely after failed


|>-----Original Message-----
|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of jratike80
|>Sent: Thursday, June 27, 2019 10:01 PM
|>To: gdal-dev at lists.osgeo.org
|>Subject: Re: [gdal-dev] kml file with line length too long
|>
|>Test with yesterdays GDAL 3.1.0dev from gisinternals creates a directory
|>"lolo.shp", writes the first shapefile into it but fails with the second.
|>Debug shows this:
|>
|>ogr2ogr -f "ESRI shapefile" lolo.shp IS2_RGT_0002_cycle4_28-Jun-2019.kml
|>--debug on
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_BAG.dll using
|>GDALRegister_BAG.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_FITS.dll
|>using GDALRegister_FITS.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_GMT.dll using
|>GDALRegister_GMT.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF4.dll
|>using GDALRegister_HDF4.
|>GDAL: Auto register
|>C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF4Image.dll
|>using GDALRegister_HDF4Image.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF5.dll
|>using GDALRegister_HDF5.
|>GDAL: Auto register
|>C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_HDF5Image.dll
|>using GDALRegister_HDF5Image.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_KEA.dll using
|>GDALRegister_KEA.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_MG4Lidar.dll
|>using GDALRegister_MG4Lidar.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_MrSID.dll
|>using GDALRegister_MrSID.
|>GDAL: Auto register C:\ohjelmat\gdal_dev\bin\gdal\plugins\gdal_netCDF.dll
|>using GDALRegister_netCDF.
|>GDAL: Auto register
|>C:\ohjelmat\gdal_dev\bin\gdal\plugins\ogr_AmigoCloud.dll
|>using RegisterOGRAmigoCloud.
|>GDAL: GDALOpen(IS2_RGT_0002_cycle4_28-Jun-2019.kml,
|>this=0000018665149690) succeeds as LIBKML.
|>GDAL: GDALDriver::Create(ESRI
|>Shapefile,lolo.shp,0,0,0,Unknown,0000000000000000)
|>Shape: DBF Codepage = LDID/87 for
|>lolo.shp\IS2_RGT_0002_cycle4_28-Jun-2019.kml.shp
|>Shape: Treating as encoding 'ISO-8859-1'.
|>Warning 6: Normalized/laundered field name: 'description' to 'descriptio'
|>Warning 6: Field timestamp create as date field, though DateTime requested.
|>Warning 6: Field begin create as date field, though DateTime requested.
|>Warning 6: Field end create as date field, though DateTime requested.
|>Warning 6: Normalized/laundered field name: 'altitudeMode' to 'altitudeMo'
|>GDALVectorTranslate: 1 features written in layer 'IS2_RGT_0002_cycle4_28-
|>Jun-2019.kml'
|>ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
|>04:55:18.shp: No error
|>ERROR 1: Terminating translation prematurely after failed translation of layer
|>RGT 2 DOY-179 28-Jun-2019 04:55:18 (use -skipfailures to skip errors)
|>GDAL: GDALClose(lolo.shp, this=000001866542C1F0)
|>GDAL: GDALClose(IS2_RGT_0002_cycle4_28-Jun-2019.kml,
|>this=0000018665149690)
|>
|>
|>-Jukka Rahkonen-
|>
|>
|>
|>
|>--
|>Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
|>_______________________________________________
|>gdal-dev mailing list
|>gdal-dev at lists.osgeo.org
|>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Jun 27 14:34:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Jun 2019 23:34:28 +0200
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <1561669263857-0.post@n6.nabble.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700> <1561669263857-0.post@n6.nabble.com>
Message-ID: <2082945.XUfh6R9XPK@even-i700>

> ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
> 04:55:18.shp: No error

Ah, I see. There are ':' characters in the layername, which are invalid 
characters for a filename on Windows. As I tested the gisinternals builds on 
Wine, this limitation is probably not emulated
Anyway, I've just pushed code in the shapefile driver to launder layer name to 
get valid filenames. Ah shapefiles...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Thu Jun 27 14:38:49 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 27 Jun 2019 21:38:49 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2082945.XUfh6R9XPK@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700> <1561669263857-0.post@n6.nabble.com>
 <2082945.XUfh6R9XPK@even-i700>
Message-ID: <DB8PR04MB65077508532B132BFE28BDCDA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Thanks. I'll try it.

|>-----Original Message-----
|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
|>Sent: Thursday, June 27, 2019 10:34 PM
|>To: gdal-dev at lists.osgeo.org
|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>Subject: Re: [gdal-dev] kml file with line length too long
|>
|>> ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
|>> 04:55:18.shp: No error
|>
|>Ah, I see. There are ':' characters in the layername, which are invalid characters
|>for a filename on Windows. As I tested the gisinternals builds on Wine, this
|>limitation is probably not emulated Anyway, I've just pushed code in the
|>shapefile driver to launder layer name to get valid filenames. Ah shapefiles...
|>
|>Even
|>
|>--
|>Spatialys - Geospatial professional services http://www.spatialys.com
|>_______________________________________________
|>gdal-dev mailing list
|>gdal-dev at lists.osgeo.org
|>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jluis at ualg.pt  Thu Jun 27 15:05:59 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 27 Jun 2019 22:05:59 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB65077508532B132BFE28BDCDA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700> <1561669263857-0.post@n6.nabble.com>
 <2082945.XUfh6R9XPK@even-i700>
 <DB8PR04MB65077508532B132BFE28BDCDA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>

OK, better but still some issues

...
Warning 1: Invalid layer name for a shapefile: RGT 2 DOY-179 28-Jun-2019 06:28:18. Laundered to RGT 2 DOY-179 28-Jun-2019 06_28_18.
Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'
Warning 1: Invalid layer name for a shapefile: RGT 2 DOY-179 28-Jun-2019 06:29:18. Laundered to RGT 2 DOY-179 28-Jun-2019 06_29_18.
Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'
Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'

At the end I get a directory with 196 .shp files, of which only " IS2_RGT_0002_cycle4_28-Jun-2019.kml.shp" is good. The rest is a bunch of " RGT 2 DOY-179 28-Jun-2019 06_29_18.shp" with only 136 bytes.


... and my gmt_ogrread() function still crashes my Julia GMT wrapper.





|>-----Original Message-----
|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Joaquim
|>Manuel Freire Luís
|>Sent: Thursday, June 27, 2019 10:39 PM
|>To: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>Subject: Re: [gdal-dev] kml file with line length too long
|>
|>Thanks. I'll try it.
|>
|>|>-----Original Message-----
|>|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even
|>|>Rouault
|>|>Sent: Thursday, June 27, 2019 10:34 PM
|>|>To: gdal-dev at lists.osgeo.org
|>|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>|>Subject: Re: [gdal-dev] kml file with line length too long
|>|>
|>|>> ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
|>|>> 04:55:18.shp: No error
|>|>
|>|>Ah, I see. There are ':' characters in the layername, which are
|>|>invalid characters for a filename on Windows. As I tested the
|>|>gisinternals builds on Wine, this limitation is probably not emulated
|>|>Anyway, I've just pushed code in the shapefile driver to launder layer name
|>to get valid filenames. Ah shapefiles...
|>|>
|>|>Even
|>|>
|>|>--
|>|>Spatialys - Geospatial professional services http://www.spatialys.com
|>|>_______________________________________________
|>|>gdal-dev mailing list
|>|>gdal-dev at lists.osgeo.org
|>|>https://lists.osgeo.org/mailman/listinfo/gdal-dev
|>_______________________________________________
|>gdal-dev mailing list
|>gdal-dev at lists.osgeo.org
|>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Jun 27 15:24:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Jun 2019 00:24:53 +0200
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65077508532B132BFE28BDCDA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <2283823.ppTz0bVaWT@even-i700>

> The rest is a bunch of "
> RGT 2 DOY-179 28-Jun-2019 06_29_18.shp" with only 136 bytes.
 
Which is expected. if you look at the conten of the .kml, you'll see that the 
Folder 's that correspond to those shapefiles have one single point.

> ... and my gmt_ogrread() function still crashes my Julia GMT wrapper.

That's on your side :-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jun 28 03:42:06 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 28 Jun 2019 10:42:06 +0000
Subject: [gdal-dev] Gdal_translate and -scale with non-Byte output
Message-ID: <2945136b908a4cb7ae66aa0ea8e2c270@C119S212VM042.msvyvi.vaha.local>

Hi,

I was reading https://gis.stackexchange.com/questions/247767/performing-histogram-streching-using-gdal-translate and made some tests and now I feel that gdal_translate with -scale does not handle well some use cases with non-Byte output.

The syntax is -scale [src_min src_max [dst_min dst_max]]
"Rescale the input pixels values from the range src_min to src_max to the range dst_min to dst_max. If omitted the output range is 0 to 255. If omitted the input range is automatically computed from the source data."

User can omit a) just the destination range or b) both the source range and the destination range but it is not possible to omit just the source range. This means that if the output is for example Int32 then user cannot let GDAL to detect the input range automatically. Or they can but then the output range is set to 0-255 which is not so good for Int32.

I do not really know how big problem this is or what to do for improving current behavior. Only idea that came into my mind was introduce two new keywords "srs_auto" and "dst_auto". "srs_auto" would do the same than omitting input range, so compute the range from the source data. "dst_auto" would set the range into min-max of the valid values for each output datatype.
BTW is seems that -scale without ranges does not always work quite as documented. The default output range in this test did not stay between 0 and 255.

gdal_translate -of GTiff -ot Int32 -scale base.tif scaletest.tif
gdalinfo scaletest.tif -stats
...
STATISTICS_MAXIMUM=259
STATISTICS_MEAN=109.94244718749
STATISTICS_MINIMUM=-6

-Jukka Rahkonen-



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190628/873093e3/attachment.html>

From even.rouault at spatialys.com  Fri Jun 28 05:03:05 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Jun 2019 14:03:05 +0200
Subject: [gdal-dev] GDAL 2.4.2 RC1 available
Message-ID: <1705592.kR9MAReAlp@even-i700>

Hi,

I have prepared a GDAL/OGR 2.4.2 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.4.2/gdal-2.4.2rc1.tar.xz
  http://download.osgeo.org/gdal/2.4.2/gdal-2.4.2rc1.tar.gz
  http://download.osgeo.org/gdal/2.4.2/gdal242rc1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.4.2/gdalautotest-2.4.2rc1.tar.gz
  http://download.osgeo.org/gdal/2.4.2/gdalautotest-2.4.2rc1.zip

GDAL-GRASS plugin (unmodified):

    http://download.osgeo.org/gdal/2.4.2/gdal-grass-2.4.2.tar.gz

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.4.2-News

I'll call for a vote promoting it to final in the middle of next week if no
serious problems are reported before.

Best regards,

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun 28 05:03:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Jun 2019 14:03:59 +0200
Subject: [gdal-dev] GDAL 3.0.1 RC1 available
Message-ID: <4837377.gDUDFDjfyF@even-i700>

Hi,

I have prepared a GDAL/OGR 3.0.1 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/3.0.1/gdal-3.0.1rc1.tar.xz
  http://download.osgeo.org/gdal/3.0.1/gdal-3.0.1rc1.tar.gz
  http://download.osgeo.org/gdal/3.0.1/gdal301rc1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/3.0.1/gdalautotest-3.0.1rc1.tar.gz
  http://download.osgeo.org/gdal/3.0.1/gdalautotest-3.0.1rc1.zip

GDAL-GRASS plugin (unmodified):

    http://download.osgeo.org/gdal/3.0.1/gdal-grass-3.0.1.tar.gz

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/3.0.1-News

I'll call for a vote promoting it to final in the middle of next week if no
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Fri Jun 28 05:05:02 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Fri, 28 Jun 2019 12:05:02 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2728472.Y6kk128VFT@even-i700> <1561669263857-0.post@n6.nabble.com>
 <2082945.XUfh6R9XPK@even-i700>
 <DB8PR04MB65077508532B132BFE28BDCDA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <DB8PR04MB65079B49743E3807328A9FECA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>

Even, still about this issue. My experimental gmt_ogrread() function crashes when used with this file. The crash occurs at
https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_ogrread.c#L344
and happens more or less randomly in "iLayer" ~> 4. From this I deduce the trouble comes from those multiple (empty?) layers of this file.

It's strange because line 342 also accesses hSRS but it never crashed there.

|>-----Original Message-----
|>From: Joaquim Manuel Freire Luís <jluis at ualg.pt>
|>Sent: Thursday, June 27, 2019 11:06 PM
|>To: Joaquim Manuel Freire Luís <jluis at ualg.pt>; Even Rouault
|><even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>Subject: RE: [gdal-dev] kml file with line length too long
|>
|>OK, better but still some issues
|>
|>...
|>Warning 1: Invalid layer name for a shapefile: RGT 2 DOY-179 28-Jun-2019
|>06:28:18. Laundered to RGT 2 DOY-179 28-Jun-2019 06_28_18.
|>Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'
|>Warning 1: Invalid layer name for a shapefile: RGT 2 DOY-179 28-Jun-2019
|>06:29:18. Laundered to RGT 2 DOY-179 28-Jun-2019 06_29_18.
|>Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'
|>Warning 6: Normalized/laundered field name: 'Description' to 'Descriptio'
|>
|>At the end I get a directory with 196 .shp files, of which only "
|>IS2_RGT_0002_cycle4_28-Jun-2019.kml.shp" is good. The rest is a bunch of "
|>RGT 2 DOY-179 28-Jun-2019 06_29_18.shp" with only 136 bytes.
|>
|>
|>... and my gmt_ogrread() function still crashes my Julia GMT wrapper.
|>
|>
|>
|>
|>
|>|>-----Original Message-----
|>|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Joaquim
|>|>Manuel Freire Luís
|>|>Sent: Thursday, June 27, 2019 10:39 PM
|>|>To: Even Rouault <even.rouault at spatialys.com>;
|>|>gdal-dev at lists.osgeo.org
|>|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>|>Subject: Re: [gdal-dev] kml file with line length too long
|>|>
|>|>Thanks. I'll try it.
|>|>
|>|>|>-----Original Message-----
|>|>|>From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even
|>|>|>Rouault
|>|>|>Sent: Thursday, June 27, 2019 10:34 PM
|>|>|>To: gdal-dev at lists.osgeo.org
|>|>|>Cc: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
|>|>|>Subject: Re: [gdal-dev] kml file with line length too long
|>|>|>
|>|>|>> ERROR 1: Failed to create file lolo.shp\RGT 2 DOY-179 28-Jun-2019
|>|>|>> 04:55:18.shp: No error
|>|>|>
|>|>|>Ah, I see. There are ':' characters in the layername, which are
|>|>|>invalid characters for a filename on Windows. As I tested the
|>|>|>gisinternals builds on Wine, this limitation is probably not
|>|>|>emulated Anyway, I've just pushed code in the shapefile driver to
|>|>|>launder layer name
|>|>to get valid filenames. Ah shapefiles...
|>|>|>
|>|>|>Even
|>|>|>
|>|>|>--
|>|>|>Spatialys - Geospatial professional services
|>|>|>http://www.spatialys.com
|>|>|>_______________________________________________
|>|>|>gdal-dev mailing list
|>|>|>gdal-dev at lists.osgeo.org
|>|>|>https://lists.osgeo.org/mailman/listinfo/gdal-dev
|>|>_______________________________________________
|>|>gdal-dev mailing list
|>|>gdal-dev at lists.osgeo.org
|>|>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Jun 28 05:19:27 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Jun 2019 14:19:27 +0200
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <DB8PR04MB65079B49743E3807328A9FECA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65079B49743E3807328A9FECA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>
Message-ID: <2594345.S4NzLhHmUY@even-i700>

On vendredi 28 juin 2019 12:05:02 CEST Joaquim Manuel Freire Luís wrote:
> Even, still about this issue. My experimental gmt_ogrread() function crashes
> when used with this file. The crash occurs at
> https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_ogrread.c#L3
> 44 and happens more or less randomly in "iLayer" ~> 4. From this I deduce
> the trouble comes from those multiple (empty?) layers of this file. 
> It's strange because line 342 also accesses hSRS but it never crashed
> there.

Nothing strikes me as obviously wrong (just missing CPLFree() on pszWKT and 
pszProj4, but that's not the cause of your issue).
You'll have to use your favorite debugging tool: gdb, valgrind ...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jun 28 06:22:54 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Jun 2019 15:22:54 +0200
Subject: [gdal-dev] Gdal_translate and -scale with non-Byte output
In-Reply-To: <2945136b908a4cb7ae66aa0ea8e2c270@C119S212VM042.msvyvi.vaha.local>
References: <2945136b908a4cb7ae66aa0ea8e2c270@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1711091.s8Kc44lkyk@even-i700>

On vendredi 28 juin 2019 10:42:06 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I was reading
> https://gis.stackexchange.com/questions/247767/performing-histogram-strechi
> ng-using-gdal-translate and made some tests and now I feel that
> gdal_translate with -scale does not handle well some use cases with
> non-Byte output.
> 
> The syntax is -scale [src_min src_max [dst_min dst_max]]
> "Rescale the input pixels values from the range src_min to src_max to the
> range dst_min to dst_max. If omitted the output range is 0 to 255. If
> omitted the input range is automatically computed from the source data."
> 
> User can omit a) just the destination range or b) both the source range and
> the destination range but it is not possible to omit just the source range.
> This means that if the output is for example Int32 then user cannot let
> GDAL to detect the input range automatically. Or they can but then the
> output range is set to 0-255 which is not so good for Int32.
> 
> I do not really know how big problem this is or what to do for improving
> current behavior. Only idea that came into my mind was introduce two new
> keywords "srs_auto" and "dst_auto". "srs_auto" would do the same than
> omitting input range, so compute the range from the source data. "dst_auto"
> would set the range into min-max of the valid values for each output
> datatype.

Reasonable proposal. Could be worth an enhancement ticket with a "good first 
issue" label to attract contributors :-)

> BTW is seems that -scale without ranges does not always work
> quite as documented. The default output range in this test did not stay
> between 0 and 255.

I see that if the min/max of the source is not already known, we compute it 
but with approximation enabled. That's the likely reason (or if statistics 
have been previously computed in an approximated way). As the src and dst min/
max values of -scale are used to compute an offset value and a scaling factor, 
no clamping to the implied or specified dst_min/dst_max can be done (except 
due to the validty range of the data type itself).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Fri Jun 28 07:07:01 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Fri, 28 Jun 2019 14:07:01 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2594345.S4NzLhHmUY@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65079B49743E3807328A9FECA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2594345.S4NzLhHmUY@even-i700>
Message-ID: <DB8PR04MB65078E9D4BA22B295798A876A6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>

|>Nothing strikes me as obviously wrong (just missing CPLFree() on pszWKT and
|>pszProj4, but that's not the cause of your issue).
|>You'll have to use your favorite debugging tool: gdb, valgrind ...

Hmm, landed in proj_as_wkt() but I'm not being able to build a proj debug. No matter setting
		-DCMAKE_BUILD_TYPE=Debug ^
		-DCMAKE_CONFIGURATION_TYPES=Debug ^
In cmake, I end up with a release build

From jmckenna at gatewaygeomatics.com  Fri Jun 28 07:48:10 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 28 Jun 2019 11:48:10 -0300
Subject: [gdal-dev] GDAL 2.4.2 RC1 available
In-Reply-To: <1705592.kR9MAReAlp@even-i700>
References: <1705592.kR9MAReAlp@even-i700>
Message-ID: <1f56026a-28ff-0683-19d7-6233da8208dc@gatewaygeomatics.com>

Hi Even,

No problem here on Windows with VisualStudio 2017.

(and thanks for this 2.4.2 release)

-jeff



On 2019-06-28 9:03 AM, Even Rouault wrote:
> Hi,
> 
> I have prepared a GDAL/OGR 2.4.2 release candidate.
> 
> Peek up an archive among the following ones (by ascending size):
> 
>    http://download.osgeo.org/gdal/2.4.2/gdal-2.4.2rc1.tar.xz
>    http://download.osgeo.org/gdal/2.4.2/gdal-2.4.2rc1.tar.gz
>    http://download.osgeo.org/gdal/2.4.2/gdal242rc1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
>    http://download.osgeo.org/gdal/2.4.2/gdalautotest-2.4.2rc1.tar.gz
>    http://download.osgeo.org/gdal/2.4.2/gdalautotest-2.4.2rc1.zip
> 
> GDAL-GRASS plugin (unmodified):
> 
>      http://download.osgeo.org/gdal/2.4.2/gdal-grass-2.4.2.tar.gz
> 
> The NEWS file is here :
> 
>    http://trac.osgeo.org/gdal/wiki/Release/2.4.2-News
> 
> I'll call for a vote promoting it to final in the middle of next week if no
> serious problems are reported before.
> 
> Best regards,
> 
> Even
> 
> 


-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/

From jluis at ualg.pt  Fri Jun 28 09:32:11 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Fri, 28 Jun 2019 16:32:11 +0000
Subject: [gdal-dev] kml file with line length too long
In-Reply-To: <2594345.S4NzLhHmUY@even-i700>
References: <DB8PR04MB6507906992793403A39C5C5AA6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65070A103819EC1409D13046A6FD0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <DB8PR04MB65079B49743E3807328A9FECA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>
 <2594345.S4NzLhHmUY@even-i700>
Message-ID: <DB8PR04MB650763C889C893511C66242AA6FC0@DB8PR04MB6507.eurprd04.prod.outlook.com>


|>Nothing strikes me as obviously wrong (just missing CPLFree() on pszWKT and
|>pszProj4, but that's not the cause of your issue).
|>You'll have to use your favorite debugging tool: gdb, valgrind ...

I'm afraid that I'm unable to pass this point for the time being. I land in ogrspatialreference#L1409

const char* pszWKT = proj_as_wkt(
        d->getPROJContext(), d->m_pj_crs,
        wktFormat, aosOptions.List());

with a vague "Exception Trown" and don't manage to step in proj_as_wkt(). I have now a pro debug but it created no .pdb file

From ahmettemiz88 at gmail.com  Sat Jun 29 10:46:38 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Sat, 29 Jun 2019 20:46:38 +0300
Subject: [gdal-dev] UnionCascaded operation failed
Message-ID: <CAJKO1YswCy=j7RFiP2cfRyeL+_N=pSary1SZC24k=Si_XoJDfQ@mail.gmail.com>

Hi,

Using C++ I try to buffers from LineStrings,Then I want to union the
resulting polygons with UnionCascaded.
But at UnionCascaded operation failed with:
"error: ‘class std::vector<OGRPolygon*>’ has no member named ‘UnionCascaded’
     OGRGeometry *result=polyCollect.UnionCascaded();
"
Can you tell me what I am doing wrong?

here is the related code fragment:

    std::vector<OGRPolygon * > polyCollect ;
    //OGRGeometryCollection *polyCollect ;

    while( (poFeature = poLayer->GetNextFeature()) != NULL )
    {

        OGRGeometry *poGeometry = poFeature->GetGeometryRef();

        if( poGeometry != NULL
                && wkbFlatten(poGeometry->getGeometryType()) ==
wkbLineString )
        {
            OGRLineString *poLine = (OGRLineString *) poGeometry;
   //
            OGRGeometry *bufGeometry = poLine->Buffer(100,30);
   OGRPolygon *bufPoly=  static_cast<OGRPolygon *> (bufGeometry) ;
            printf( "%s \n", bufPoly->getGeometryName());

   //polyCollect->addGeometryDirectly (bufPoly );
            polyCollect.push_back(bufPoly );
        }
        else
        {
            printf( "no point geometry\n" );
        }

        OGRFeature::DestroyFeature( poFeature );
    }

    OGRGeometry *result=polyCollect.UnionCascaded();

-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190629/3c57de0d/attachment.html>

From gbburkhardt at gmail.com  Sat Jun 29 16:45:39 2019
From: gbburkhardt at gmail.com (Glenn Burkhardt)
Date: Sat, 29 Jun 2019 19:45:39 -0400
Subject: [gdal-dev] gdalwarper destination alpha mask
In-Reply-To: <10478539.9RPRXXOQkn@even-i700>
References: <2e9b4b4f-c6ce-0e9f-ca4a-891b41a4f19f@gmail.com>
 <10478539.9RPRXXOQkn@even-i700>
Message-ID: <4371965b-785e-bb0c-6156-f6d5d2256650@gmail.com>

On 5/5/2019 1:16 PM, Even Rouault wrote:
> Glenn,
>
>> I'm trying to track down a discrepancy between GDAL 1.7.2 and GDAL
>> 2.4.0.  The NASA Worldwind code makes a call to gdal.ReprojectImage()
>> using a dataset generated from an input file to a working destination
>> dataset that's empty, except that the alpha band has been filled with
>> 0xFF.  In the case I'm examining, the projection is 1 to 1; no change.
>> The source file has an appropriate alpha mask to clip the image so only
>> relevant data is shown.
>>
>> When using the 1.7.2 release, the image is shown with a proper overlay
>> on the lower priority layers, with the portions with alpha mask of 0
>> being completely transparent.  But the more recent 2.4.0 release has a
>> black boundary around the image, indicating that the alpha mask was set
>> to 0xff for the whole image.
>>
>> It looks like there's a difference in behavior in the Java call
>>
>>                           gdal.ReprojectImage(srcDS, destDS, s_srs_wkt,
>> t_srs_wkt, gdalconst.GRA_Average);
>>
>> For the 1.7.2 release, the alpha mask in the destination data set is
>> filled in correctly, matching the alpha band in the source. But in the
>> 2.4.0 release, the destination alpha band is filled with 0xFF, which
>> sort of explains the black boundary.  Curiously, for the 1.7.2 release,
>> it doesn't matter if the destination alpha band was filled with zeros or
>> 0xFF.  For the 2.4.0 release, if the destination dataset alpha band is
>> filled with zeros, the image displays correctly, and the reprojected
>> destination dataset alpha band matches the source.
>>
>> I'm trying to understand what the purpose is of the destination alpha
>> density mask in 'gdalwarpper.cpp'.  In the file 'gdalwarpoperation.cpp',
>> I see a note that says "Note that detailed semantics of the masks should
>> be found in
>>
>> GDALWarpKernel."  And in 'gdalwarpkernel.cpp': "A detailed explanation
>> of the semantics of the validity and density masks, and their effects on
>> resampling kernels is needed here."
>>
>> So if there's a place where the semantics are explained, please send me
>> link.  And, if this rings a bell about a change that was made some time
>> between the 1.7.2 (April 23, 2010) and the 2.4.0, please let me know.
> Looking at the NEWS file, the change of behaviour likely dates back to GDAL
> 1.8.0:
>   * GDALReprojectImage() : correctly assign nSrcAlphaBand and nDstAlphaBand
> (#3821) --> https://trac.osgeo.org/gdal/ticket/3821
>
> Previously the source and target alpha bands were treated as regular bands.
> If the target alpha band is initialized to 0xFF, then it means that all target
> pixels are valid, and thus they will remain the same if there is no
> corresponding source pixel, or if they have source_alpha = 0.
>
> The maths involved with destination density are in:
> https://github.com/OSGeo/gdal/blob/master/gdal/alg/gdalwarpkernel.cpp#L1330
> https://github.com/OSGeo/gdal/blob/master/gdal/alg/gdalwarpkernel.cpp#L1414
> Basically this is for alpha blending of source onto target.
>
> That said, looking at the above mentionned change in GDALReprojectImage(), I
> noticed there was something slightly wrong, which I just fixed, in which the
> alpha bands were treated both as regular bands and alpha bands. So I'm not
> sure what the effect was exactly. That said, the difference in results seemed
> minimal when warping over a target image initialized with alpha = 0.
>
> So all in all, you should initialize your target image with alpha = 0 as you
> noticed.
>
> Even
>
>
It turns out that the change you made for treating the alpha band 
separately 
(https://github.com/OSGeo/gdal/commit/b427cb23ff1bc2a5ba2f6634fc3bd90816bb7789) 
fixed one other problem that you might have intended to fix, but has 
caused another.

I have a general question - the new code assumes that the alpha band 
will always be the last one in the dataset.  Is that guaranteed by some 
standard?  In the previous code, the alpha band could have been band 1, 
and the band number was recorded for later use.

After I changed the WorldWind code to initialize the target alpha band 
to 0, which fixed my immediate problem, I discovered that if the source 
dataset has no alpha band, that the alpha band of the result has all 
zeros.  That doesn't happen with your change - it doesn't matter what's 
in the target alpha band initially if there is no alpha band in the 
source - after reprojectImage, the alpha band of the result has all 255 
regardless of the values initially in the target dataset.  That makes sense.

Perhaps that's the problem you intended to fix.

The new problem in the WorldWind code is that 'reprojectImage' was used 
to clip the source dataset to a 'region-of-interest' (ROI).  That's 
probably an improper use of reprojectImage.  If you refer to this code:

https://github.com/WorldWindEarth/WorldWindJava/blob/develop/src/gov/nasa/worldwind/data/GDALDataRaster.java

in createMaskDataset at line 466, it's creating a dataset with a single 
alpha band for the ROI.  When the mask dataset is used at line 1135 in a 
reprojectImage call, GDAL correctly reports a warning:

     GDAL error 5 : GDALWarpOptions.Validate(): nBandCount=0, no bands 
configured!

The intent was to generate a dataset with alpha=0 outside of the ROI.  
In the call to GDALUtils.composeDataRaster at line 1154, the alpha band 
is retrieved from the mask data set, and eventually used in 
'GDALUtils.applyImageMask()' to clip the image.

https://github.com/WorldWindEarth/WorldWindJava/blob/develop/src/gov/nasa/worldwind/util/gdal/GDALUtils.java

So in order to work with any GDAL release after 3.0.0, that code will 
need to be reworked.

If you tell me that WorldWind's use of 'reprojectImage' is inappropriate 
for this purpose, that's fine.  It will need to be re-written.  But 
other users might be using 'reprojectImage' for similar purposes, other 
code might break.  Some entry in the release notes might help.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190629/671e57c6/attachment.html>

From even.rouault at spatialys.com  Sun Jun 30 02:28:21 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 30 Jun 2019 11:28:21 +0200
Subject: [gdal-dev] gdalwarper destination alpha mask
In-Reply-To: <4371965b-785e-bb0c-6156-f6d5d2256650@gmail.com>
References: <2e9b4b4f-c6ce-0e9f-ca4a-891b41a4f19f@gmail.com>
 <10478539.9RPRXXOQkn@even-i700>
 <4371965b-785e-bb0c-6156-f6d5d2256650@gmail.com>
Message-ID: <2492499.B6RiQ4SzFk@even-i700>

> It turns out that the change you made for treating the alpha band
> separately
> (https://github.com/OSGeo/gdal/commit/b427cb23ff1bc2a5ba2f6634fc3bd90816bb77
> 89) fixed one other problem that you might have intended to fix, but has
> caused another.
> 
> I have a general question - the new code assumes that the alpha band
> will always be the last one in the dataset.  Is that guaranteed by some
> standard?  In the previous code, the alpha band could have been band 1,
> and the band number was recorded for later use.

That's an informal convention used in GDAL, and in particularly by the 
gdalwarp utility and the warping kernel itself. If the alpha band is not the 
last one, it would be reprojected as any other band. In fact, the warping 
kernel does not reproject the source alpha band (when it is the last one): it 
uses it as a mask for the other bands. And it updates the destination alpha 
band with the pixel "density" of the reprojected pixels.
The intent of the changes done in GDALReprojectImage() is that it behaves like 
GDALWarp() as much as possible. It seems GDALReprojectImage() didn't initially 
take into accout the specificities of alpha at all, and that a later attempt 
at doing so was broken.

> 
> After I changed the WorldWind code to initialize the target alpha band
> to 0, which fixed my immediate problem, I discovered that if the source
> dataset has no alpha band, that the alpha band of the result has all
> zeros.  That doesn't happen with your change - it doesn't matter what's
> in the target alpha band initially if there is no alpha band in the
> source - after reprojectImage, the alpha band of the result has all 255
> regardless of the values initially in the target dataset.

Depends. If the reprojection doesn't cause geometry changes, then yes, this 
will be 255. Otherwise you'll get 0 in the areas that don't have a 
corresponding source pixel.

> 
> Perhaps that's the problem you intended to fix.
> 
> The new problem in the WorldWind code is that 'reprojectImage' was used
> to clip the source dataset to a 'region-of-interest' (ROI).  That's
> probably an improper use of reprojectImage.  If you refer to this code:
> 
> https://github.com/WorldWindEarth/WorldWindJava/blob/develop/src/gov/nasa/wo
> rldwind/data/GDALDataRaster.java
> 
> in createMaskDataset at line 466, it's creating a dataset with a single
> alpha band for the ROI.  When the mask dataset is used at line 1135 in a
> reprojectImage call, GDAL correctly reports a warning:
> 
>      GDAL error 5 : GDALWarpOptions.Validate(): nBandCount=0, no bands
> configured!
> 
> The intent was to generate a dataset with alpha=0 outside of the ROI. 
> In the call to GDALUtils.composeDataRaster at line 1154, the alpha band
> is retrieved from the mask data set, and eventually used in
> 'GDALUtils.applyImageMask()' to clip the image.

I believe you should proceed differently. Create a composite image *before* 
reproject with the source alpha band at 0 in the areas outside of the ROI.
Or unmark your mask band as being an alpha band so it is treated as a regular 
band.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From caboe at sdfe.dk  Sun Jun 30 22:39:04 2019
From: caboe at sdfe.dk (=?utf-8?B?Q2FzcGVyIELDuHJnZXNlbg==?=)
Date: Mon, 1 Jul 2019 05:39:04 +0000
Subject: [gdal-dev] UnionCascaded operation failed
In-Reply-To: <CAJKO1YswCy=j7RFiP2cfRyeL+_N=pSary1SZC24k=Si_XoJDfQ@mail.gmail.com>
References: <CAJKO1YswCy=j7RFiP2cfRyeL+_N=pSary1SZC24k=Si_XoJDfQ@mail.gmail.com>
Message-ID: <800A1C4B99390947B3BAA86C02CBDB26180908FB@S000014.PROD.SITAD.DK>

A very quick guess would be that you have changed the polyCollect type from a geometry type to a list of geometries. I don’t think the list of geometries has a UnionCascaded method. I would probably go for a polyCollect geometry type of MultiPolygon instead of the list/vector, that way you should be able to run the UnionCascaded method.

/Casper

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Ahmet Temiz
Sent: 29. juni 2019 19:47
To: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] UnionCascaded operation failed

Hi,

Using C++ I try to buffers from LineStrings,Then I want to union the
resulting polygons with UnionCascaded.
But at UnionCascaded operation failed with:
"error: ‘class std::vector<OGRPolygon*>’ has no member named ‘UnionCascaded’
     OGRGeometry *result=polyCollect.UnionCascaded();
"
Can you tell me what I am doing wrong?

here is the related code fragment:

    std::vector<OGRPolygon * > polyCollect ;
    //OGRGeometryCollection *polyCollect ;

    while( (poFeature = poLayer->GetNextFeature()) != NULL )
    {

        OGRGeometry *poGeometry = poFeature->GetGeometryRef();

        if( poGeometry != NULL
                && wkbFlatten(poGeometry->getGeometryType()) == wkbLineString )
        {
            OGRLineString *poLine = (OGRLineString *) poGeometry;
   //
            OGRGeometry *bufGeometry = poLine->Buffer(100,30);
   OGRPolygon *bufPoly=  static_cast<OGRPolygon *> (bufGeometry) ;
            printf( "%s \n", bufPoly->getGeometryName());

   //polyCollect->addGeometryDirectly (bufPoly );
            polyCollect.push_back(bufPoly );
        }
        else
        {
            printf( "no point geometry\n" );
        }

        OGRFeature::DestroyFeature( poFeature );
    }

    OGRGeometry *result=polyCollect.UnionCascaded();

--
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190701/12b2a500/attachment.html>

From ahmettemiz88 at gmail.com  Sun Jun 30 22:55:37 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Mon, 1 Jul 2019 08:55:37 +0300
Subject: [gdal-dev] UnionCascaded operation failed
In-Reply-To: <800A1C4B99390947B3BAA86C02CBDB26180908FB@S000014.PROD.SITAD.DK>
References: <CAJKO1YswCy=j7RFiP2cfRyeL+_N=pSary1SZC24k=Si_XoJDfQ@mail.gmail.com>
 <800A1C4B99390947B3BAA86C02CBDB26180908FB@S000014.PROD.SITAD.DK>
Message-ID: <CAJKO1Ys1FFH93A+hs5z5d3hadsXao2RuGpHNWgN4w5+UGxi=Ag@mail.gmail.com>

Ok, thanks.

On Mon, Jul 1, 2019 at 8:39 AM Casper Børgesen <caboe at sdfe.dk> wrote:

> A very quick guess would be that you have changed the polyCollect type
> from a geometry type to a list of geometries. I don’t think the list of
> geometries has a UnionCascaded method. I would probably go for a
> polyCollect geometry type of MultiPolygon instead of the list/vector, that
> way you should be able to run the UnionCascaded method.
>
>
>
> /Casper
>
>
>
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Ahmet
> Temiz
> *Sent:* 29. juni 2019 19:47
> *To:* gdal-dev <gdal-dev at lists.osgeo.org>
> *Subject:* [gdal-dev] UnionCascaded operation failed
>
>
>
> Hi,
>
>
>
> Using C++ I try to buffers from LineStrings,Then I want to union the
>
> resulting polygons with UnionCascaded.
>
> But at UnionCascaded operation failed with:
>
> "error: ‘class std::vector<OGRPolygon*>’ has no member named
> ‘UnionCascaded’
>      OGRGeometry *result=polyCollect.UnionCascaded();
>
> "
>
> Can you tell me what I am doing wrong?
>
>
>
> here is the related code fragment:
>
>
>
>     std::vector<OGRPolygon * > polyCollect ;
>     //OGRGeometryCollection *polyCollect ;
>
>     while( (poFeature = poLayer->GetNextFeature()) != NULL )
>     {
>
>         OGRGeometry *poGeometry = poFeature->GetGeometryRef();
>
>         if( poGeometry != NULL
>                 && wkbFlatten(poGeometry->getGeometryType()) ==
> wkbLineString )
>         {
>             OGRLineString *poLine = (OGRLineString *) poGeometry;
>    //
>             OGRGeometry *bufGeometry = poLine->Buffer(100,30);
>    OGRPolygon *bufPoly=  static_cast<OGRPolygon *> (bufGeometry) ;
>             printf( "%s \n", bufPoly->getGeometryName());
>
>    //polyCollect->addGeometryDirectly (bufPoly );
>             polyCollect.push_back(bufPoly );
>         }
>         else
>         {
>             printf( "no point geometry\n" );
>         }
>
>         OGRFeature::DestroyFeature( poFeature );
>     }
>
>     OGRGeometry *result=polyCollect.UnionCascaded();
>
>
> --
>
> Ahmet Temiz
> Jeoloji Müh.
> Afet ve Acil Durum Yönetimi Başkanlığı
> Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
>


-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190701/f5539694/attachment.html>

