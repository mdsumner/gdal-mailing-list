From mchapman at hyperacktive.com  Mon Oct  3 10:05:48 2022
From: mchapman at hyperacktive.com (mchapman at hyperacktive.com)
Date: Mon, 3 Oct 2022 11:05:48 -0600
Subject: [gdal-dev] ECRG RasterIO problem
Message-ID: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>

All,

 

I have an ECRG dataset that fails when reading pixels from the
gdalrasterband object on one of the subdatasets.  It appears that the
underlying proxy dataset has a macro check called
RB_PROXY_METHOD_WITH_RET_WITH_INIT_BLOCK that fails because the block sizes
are different.  This happens for all the ECRG subdatasets that I read from,
in other words it's not just specific to a single dataset.  FYI, the same
code works fine for RPFTOC datasets and all other GDAL formats.  I am using
GDAL version 3.4.2.
 
// code snippet from gdalproxydataset.cpp line 247
else if( nSrcBlockXSize != nBlockXSize || nSrcBlockYSize != nBlockYSize) \
{ \
        CPLError(CE_Failure, CPLE_AppDefined, "Inconsistent block dimensions
between proxy and source"); \
        ret = CE_Failure; \
} \
 
The variables nBlockXSize and nBlockYSize are (2304, 1) and nSrcBlockXSize
and nSrcBlockYSize are {128, 128).
 
I think this is because the ECRG frame size is 2304 x 2304 but the block
size of the frame file is 128 x 128.
 
Does anybody know what my problem might be or is this an error in the driver
code?
 
Best regards,
Martin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221003/a36eceb1/attachment.htm>

From gdisk.mike at gmail.com  Mon Oct  3 10:20:05 2022
From: gdisk.mike at gmail.com (gdisk.mike)
Date: Mon, 3 Oct 2022 11:20:05 -0600
Subject: [gdal-dev] How to obtain the raster footprint poly of actual data
 with python
Message-ID: <CAKTSvBjS-FjZqi8p2_wgWR+YX-OFphQt2-4gbWp-Q6pKgQAPGw@mail.gmail.com>

To get the result using command line, I found the 3 commands did the trick.

gdal_translate -b mask -of vrt -a_nodata 0 'path/to/input.tif' test.vrt
gdal_translate -b 1 -of vrt -a_nodata 0 test.vrt test2.vrt
gdal_polygonize.[bat/py] -q  -8 test2.vrt -b 1 -f "ESRI Shapefile"
testdata.shp

This was off Stack exchange somewhere.

However, I'd like to get this same geometry in python.

I keep hitting roadblocks as I'm not real sure how to use
gdal.Translate or gdal.TranslateOptions

ive tried
gtp = gdal.TranslateOptions(format="vrt",bandList="mask", noData=0)
in attempt to start with the first gdal_translate command.

I'm also curious if there's another way, perhaps using --oo or something
different.

In the end I'd ultimately like to get a geometry poly object of where the
actual imagery data is in the file.

Any pointers?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221003/2147d699/attachment.htm>

From liglio.pessoal at nexxa.com.br  Mon Oct  3 13:23:17 2022
From: liglio.pessoal at nexxa.com.br (liglio.pessoal at nexxa.com.br)
Date: Mon, 3 Oct 2022 17:23:17 -0300
Subject: [gdal-dev] PNG image set background transparent
Message-ID: <!&!AAAAAAAAAAAuAAAAAAAAACaPdoM7XC5DsX4JrwXUdYwBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAACz7xiTylt1Q4GHDX2kMrEUAQAAAAA=@nexxa.com.br>

Hi,

 

I have a PNG image RGB (3-band), and I want to set the background
transparent. How do I do it  using GDAL ?

 

Regards,

 

Liglio

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221003/4e86e364/attachment.htm>

From even.rouault at spatialys.com  Mon Oct  3 16:08:26 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Oct 2022 01:08:26 +0200
Subject: [gdal-dev] ECRG RasterIO problem
In-Reply-To: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>
References: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>
Message-ID: <3d637e84-ea06-1447-9619-bd73ca49f212@spatialys.com>

Martin,

I bet you have GDAL_FORCE_CACHING=YES set. At least that was the only 
way I could trigger the error.

I've queued in https://github.com/OSGeo/gdal/pull/6464 a fix for that.

The first commit is sufficient to fix the issue despite being a bit 
hacky, but you could cherry-pick it without changing GDAL ABI

The second commit is a cleaner fix.

Even


Le 03/10/2022 ? 19:05, mchapman at hyperacktive.com a ?crit?:
>
> All,
>
> I have an ECRG dataset that fails when reading pixels from the gdalrasterband object on one of the subdatasets.? It appears that the underlying proxy dataset has a macro check calledRB_PROXY_METHOD_WITH_RET_WITH_INIT_BLOCK that fails because the block 
> sizes are different.? This happens for all the ECRG subdatasets that I 
> read from, in other words it?s not just specific to a single dataset.? 
> FYI, the same code works fine for RPFTOC datasets and all other GDAL 
> formats.? I am using GDAL version 3.4.2.
> // code snippet from gdalproxydataset.cpp line 247
> else if( nSrcBlockXSize != nBlockXSize || nSrcBlockYSize != nBlockYSize) \
> { \
> ??????? CPLError(CE_Failure, CPLE_AppDefined, "Inconsistent block 
> dimensions between proxy and source"); \
> ??????? ret = CE_Failure; \
> } \
> The variables nBlockXSize and nBlockYSize are (2304, 1) and 
> nSrcBlockXSize and nSrcBlockYSize are {128, 128).
> I think this is because the ECRG frame size is 2304 x 2304 but the 
> block size of the frame file is 128 x 128.
> Does anybody know what my problem might be or is this an error in the 
> driver code?
> Best regards,
> Martin
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221004/728d7585/attachment.htm>

From runette at gmail.com  Tue Oct  4 08:48:42 2022
From: runette at gmail.com (Paul Harwood)
Date: Tue, 4 Oct 2022 16:48:42 +0100
Subject: [gdal-dev] PNG image set background transparent
In-Reply-To: <!&!AAAAAAAAAAAuAAAAAAAAACaPdoM7XC5DsX4JrwXUdYwBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAACz7xiTylt1Q4GHDX2kMrEUAQAAAAA=@nexxa.com.br>
References: <!&!AAAAAAAAAAAuAAAAAAAAACaPdoM7XC5DsX4JrwXUdYwBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAACz7xiTylt1Q4GHDX2kMrEUAQAAAAA=@nexxa.com.br>
Message-ID: <CAE8nN5Oqvivbtmb3cfBSQJwY7iNr+JhV5cPx94-vWXViQzoCFQ@mail.gmail.com>

I have never tried it but I think this may be what you are looking for
(with the -setalpha flag)

https://gdal.org/programs/nearblack.html#nearblack

On Mon, 3 Oct 2022 at 21:23, <liglio.pessoal at nexxa.com.br> wrote:

> Hi,
>
>
>
> I have a PNG image RGB (3-band), and I want to set the background
> transparent. How do I do it  using GDAL ?
>
>
>
> Regards,
>
>
>
> Liglio
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221004/aed4888d/attachment.htm>

From mchapman at hyperacktive.com  Tue Oct  4 08:53:57 2022
From: mchapman at hyperacktive.com (mchapman at hyperacktive.com)
Date: Tue, 4 Oct 2022 09:53:57 -0600
Subject: [gdal-dev] ECRG RasterIO problem
In-Reply-To: <3d637e84-ea06-1447-9619-bd73ca49f212@spatialys.com>
References: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>
 <3d637e84-ea06-1447-9619-bd73ca49f212@spatialys.com>
Message-ID: <010901d8d809$83a1e480$8ae5ad80$@hyperacktive.com>

Even,

 

You are my new hero.  That worked!  

 

Question:  Should I always use GDAL_FORCE_CACHING=YES or is it driver specific?  I would like to just set it to YES once at startup and forget about it.  What are the pros and cons of setting it to YES / NO?  

 

Thanks for committing that change.

 

Best regards,

Martin

 

From: Even Rouault <even.rouault at spatialys.com> 
Sent: Monday, October 3, 2022 5:08 PM
To: mchapman at hyperacktive.com; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] ECRG RasterIO problem

 

Martin,

I bet you have GDAL_FORCE_CACHING=YES set. At least that was the only way I could trigger the error.

I've queued in https://github.com/OSGeo/gdal/pull/6464 a fix for that.

The first commit is sufficient to fix the issue despite being a bit hacky, but you could cherry-pick it without changing GDAL ABI

The second commit is a cleaner fix.

Even

 

Le 03/10/2022 ? 19:05, mchapman at hyperacktive.com <mailto:mchapman at hyperacktive.com>  a ?crit :

All,

 

I have an ECRG dataset that fails when reading pixels from the gdalrasterband object on one of the subdatasets.  It appears that the underlying proxy dataset has a macro check called RB_PROXY_METHOD_WITH_RET_WITH_INIT_BLOCK that fails because the block sizes are different.  This happens for all the ECRG subdatasets that I read from, in other words it?s not just specific to a single dataset.  FYI, the same code works fine for RPFTOC datasets and all other GDAL formats.  I am using GDAL version 3.4.2.
 
// code snippet from gdalproxydataset.cpp line 247
else if( nSrcBlockXSize != nBlockXSize || nSrcBlockYSize != nBlockYSize) \
{ \
        CPLError(CE_Failure, CPLE_AppDefined, "Inconsistent block dimensions between proxy and source"); \
        ret = CE_Failure; \
} \
 
The variables nBlockXSize and nBlockYSize are (2304, 1) and nSrcBlockXSize and nSrcBlockYSize are {128, 128).
 
I think this is because the ECRG frame size is 2304 x 2304 but the block size of the frame file is 128 x 128.
 
Does anybody know what my problem might be or is this an error in the driver code?
 
Best regards,
Martin





_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221004/38a0ffd6/attachment.htm>

From even.rouault at spatialys.com  Tue Oct  4 09:02:06 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Oct 2022 18:02:06 +0200
Subject: [gdal-dev] ECRG RasterIO problem
In-Reply-To: <010901d8d809$83a1e480$8ae5ad80$@hyperacktive.com>
References: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>
 <3d637e84-ea06-1447-9619-bd73ca49f212@spatialys.com>
 <010901d8d809$83a1e480$8ae5ad80$@hyperacktive.com>
Message-ID: <2bb9fa94-3436-7619-9bb1-2cfe4782ec2a@spatialys.com>

Martin,

Le 04/10/2022 ? 17:53, mchapman at hyperacktive.com a ?crit?:
>
> Even,
>
> You are my new hero.? That worked!
>
> Question:? Should I always use GDAL_FORCE_CACHING=YES or is it driver 
> specific?
>
It is used by the GDALDataset::RasterIO() and GDALRasterBand::RasterIO() 
methods (which are not virtual), so this applies to all drivers
>
> ? I would like to just set it to YES once at startup and forget about 
> it.? What are the pros and cons of setting it to YES / NO?
>
I would say not to set it, unless you know you need it and are familiar 
with GDAL internals. The default value NO should perform better in most 
situations. By setting to YES, you won't be able to user driver-specific 
IRasterIO() optimizations.

Even

> Thanks for committing that change.
>
> Best regards,
>
> Martin
>
> *From:* Even Rouault <even.rouault at spatialys.com>
> *Sent:* Monday, October 3, 2022 5:08 PM
> *To:* mchapman at hyperacktive.com; gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] ECRG RasterIO problem
>
> Martin,
>
> I bet you have GDAL_FORCE_CACHING=YES set. At least that was the only 
> way I could trigger the error.
>
> I've queued in https://github.com/OSGeo/gdal/pull/6464 a fix for that.
>
> The first commit is sufficient to fix the issue despite being a bit 
> hacky, but you could cherry-pick it without changing GDAL ABI
>
> The second commit is a cleaner fix.
>
> Even
>
> Le 03/10/2022 ? 19:05, mchapman at hyperacktive.com a ?crit?:
>
>     All,
>
>     I have an ECRG dataset that fails when reading pixels from the gdalrasterband object on one of the subdatasets.? It appears that the underlying proxy dataset has a macro check called RB_PROXY_METHOD_WITH_RET_WITH_INIT_BLOCK that fails because the block sizes are different.? This happens for all the ECRG subdatasets that I read from, in other words it?s not just specific to a single dataset.? FYI, the same code works fine for RPFTOC datasets and all other GDAL formats.? I am using GDAL version 3.4.2.
>
>       
>
>     // code snippet from gdalproxydataset.cpp line 247
>
>     else if( nSrcBlockXSize != nBlockXSize || nSrcBlockYSize != nBlockYSize) \
>
>     { \
>
>      ??????? CPLError(CE_Failure, CPLE_AppDefined, "Inconsistent block dimensions between proxy and source"); \
>
>      ??????? ret = CE_Failure; \
>
>     } \
>
>       
>
>     The variables nBlockXSize and nBlockYSize are (2304, 1) and nSrcBlockXSize and nSrcBlockYSize are {128, 128).
>
>       
>
>     I think this is because the ECRG frame size is 2304 x 2304 but the block size of the frame file is 128 x 128.
>
>       
>
>     Does anybody know what my problem might be or is this an error in the driver code?
>
>       
>
>     Best regards,
>
>     Martin
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org
>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221004/31da4815/attachment-0001.htm>

From xycarto at gmail.com  Wed Oct  5 20:58:05 2022
From: xycarto at gmail.com (Ian Reese)
Date: Thu, 6 Oct 2022 16:58:05 +1300
Subject: [gdal-dev] COG and VRT behaviour
Message-ID: <CAAm=p+snmphE+1pXYFaWAjKhayX-tnC5xC4u7wq6qC-WBc+aKg@mail.gmail.com>

Hi GDAL,

Let's say I have two GTiff files in COG format:

f1.tif
f2.tif

f1.tif and f2.tif are created like so:

gdal_translate input.tif f1.tif \
-of COG \
-co BLOCKSIZE=256 \
-co COMPRESS=JPEG \

I can easily create a vrt of these two COGs and get the expected behaviour
where the VRT honours the overviews of the f1 and f2 COGs.

gdalbuildvrt cog.vrt f1.tif f2.tif

This is my question, is it possible to create a COG Tif from this VRT that
copies over the overviews from each COG in the VRT?

For example something like:

gdal_translate cog.vrt cog.tif -of COG -co OVERVIEWS=FORCE_USE_EXISTING

I suspect this may not be possible. My guess is that translate is confused
by which overviews to use when creating the single cog.tif? Or that when I
created f1.tif and f2.tif I missed a setting?

I have tried many combinations to get this to work, but I think it might be
time to ask the experts. Any insight to this would be greatly appreciated.

Cheer,

Ianto

-- 
Ian C Reese
https://xycarto.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221006/913aafa8/attachment.htm>

From thomas.bonfort at gmail.com  Wed Oct  5 22:55:03 2022
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Thu, 6 Oct 2022 07:55:03 +0200
Subject: [gdal-dev] COG and VRT behaviour
In-Reply-To: <CAAm=p+snmphE+1pXYFaWAjKhayX-tnC5xC4u7wq6qC-WBc+aKg@mail.gmail.com>
References: <CAAm=p+snmphE+1pXYFaWAjKhayX-tnC5xC4u7wq6qC-WBc+aKg@mail.gmail.com>
Message-ID: <CAOM3y2igs=64FUS5vZx-LcQQO2hy_CBoeHhTnK6EKy+XMdk+9Q@mail.gmail.com>

There are only very specific cases where it would be valid to directly copy
overview tiles, namely if both image sizes are an exact power of 2. I'll
let Even contradict me if I'm wrong, but I highly doubt that what you are
trying to do is possible.
regards,
Thomas

Le jeu. 6 oct. 2022, 05:58, Ian Reese <xycarto at gmail.com> a ?crit :

> Hi GDAL,
>
> Let's say I have two GTiff files in COG format:
>
> f1.tif
> f2.tif
>
> f1.tif and f2.tif are created like so:
>
> gdal_translate input.tif f1.tif \
> -of COG \
> -co BLOCKSIZE=256 \
> -co COMPRESS=JPEG \
>
> I can easily create a vrt of these two COGs and get the expected behaviour
> where the VRT honours the overviews of the f1 and f2 COGs.
>
> gdalbuildvrt cog.vrt f1.tif f2.tif
>
> This is my question, is it possible to create a COG Tif from this VRT that
> copies over the overviews from each COG in the VRT?
>
> For example something like:
>
> gdal_translate cog.vrt cog.tif -of COG -co OVERVIEWS=FORCE_USE_EXISTING
>
> I suspect this may not be possible. My guess is that translate is confused
> by which overviews to use when creating the single cog.tif? Or that when I
> created f1.tif and f2.tif I missed a setting?
>
> I have tried many combinations to get this to work, but I think it might
> be time to ask the experts. Any insight to this would be greatly
> appreciated.
>
> Cheer,
>
> Ianto
>
> --
> Ian C Reese
> https://xycarto.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221006/e8b27613/attachment.htm>

From even.rouault at spatialys.com  Thu Oct  6 03:02:06 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 6 Oct 2022 12:02:06 +0200
Subject: [gdal-dev] COG and VRT behaviour
In-Reply-To: <CAOM3y2igs=64FUS5vZx-LcQQO2hy_CBoeHhTnK6EKy+XMdk+9Q@mail.gmail.com>
References: <CAAm=p+snmphE+1pXYFaWAjKhayX-tnC5xC4u7wq6qC-WBc+aKg@mail.gmail.com>
 <CAOM3y2igs=64FUS5vZx-LcQQO2hy_CBoeHhTnK6EKy+XMdk+9Q@mail.gmail.com>
Message-ID: <640fc50c-6323-0645-b710-3cf8592159a4@spatialys.com>


Le 06/10/2022 ? 07:55, thomas bonfort a ?crit?:
> There are only very specific cases where it would be valid to directly 
> copy overview tiles, namely if both image sizes are an exact power of 
> 2. I'll let Even contradict me if I'm wrong, but I highly doubt that 
> what you are trying to do is possible.

If your input files have the same overview levels and resolution, 
gdalbuildvrt should already build a VRT with the <OverviewList> element 
listing those overview levels

Demo with a file from GDAL autotest suite

$ gdal_translate autotest/gdrivers/data/small_world.tif left.tif -srcwin 
0 0 200 200 -outsize 1024 0 -of COG
$ gdal_translate autotest/gdrivers/data/small_world.tif right.tif 
-srcwin 200 0 200 200 -outsize 1024 0 -of COG
$ gdalbuildvrt out.vrt left.tif right.tif
$ grep Overview out.vrt
 ? <OverviewList resampling="nearest">2</OverviewList>
$ gdalinfo out.vrt | grep Overview
 ? Overviews: 1024x512

and that should be useable by the COG driver with -co 
OVERVIEWS=FORCE_USE_EXISTING

Note however that the overview exposed by the VRT is a virtual overview: 
so in the general case, there's no guarantee that the values of the 
pixel exactly match those of the source overview, depending on the 
spatial registration of each VRT source. If you have a nice mosaic of 
adjacent sources with power-of-2 dimensions, then yes, you're in the 
good situation.

But, if you were to produce a JPEG-compressed COG, don't expect 
*lossless* copy of overviews in the case of JPEG compression for target 
overviews: GDAL will get the decompressed values of the JPEG compressed 
overviews of the sources and would re-compress them. In the above 
mentioned perfect case, that could potentially be implemented (like 
"gdal_translate input.jpeg output.tif -co COMPRESS=JPEG" does 
currently), but it isn't and it would be a very specific non-trivial 
code to write.

Even


> regards,
> Thomas
>
> Le jeu. 6 oct. 2022, 05:58, Ian Reese <xycarto at gmail.com> a ?crit?:
>
>     Hi GDAL,
>
>     Let's say I have two GTiff files in COG format:
>
>     f1.tif
>     f2.tif
>
>     f1.tif and f2.tif are created like so:
>
>     gdal_translate input.tif f1.tif \
>
>     -of COG \
>
>     -co BLOCKSIZE=256 \
>
>     -co COMPRESS=JPEG \
>
>     I can easily create a vrt of these two COGs and get the expected
>     behaviour where the VRT honours the overviews of the f1 and f2 COGs.
>
>     gdalbuildvrt cog.vrt f1.tif f2.tif
>
>     This is my question, is it possible to create a COG Tif from this
>     VRT that copies over the overviews from each COG in the VRT?
>
>     For example something like:
>
>     gdal_translate cog.vrt cog.tif -of COG -co
>     OVERVIEWS=FORCE_USE_EXISTING
>
>     I suspect this may not be possible. My guess is that translate is
>     confused by which overviews to use when creating the single
>     cog.tif? Or that when I created f1.tif and f2.tif I missed a setting?
>
>     I have tried many combinations to get this to work, but I think it
>     might be time to ask the experts. Any insight to this would be
>     greatly appreciated.
>
>     Cheer,
>
>     Ianto
>
>     -- 
>     Ian C Reese
>     https://xycarto.com
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221006/68589257/attachment-0001.htm>

From loridigia at gmail.com  Thu Oct  6 07:23:55 2022
From: loridigia at gmail.com (Lorenzo Di Giacomo)
Date: Thu, 6 Oct 2022 16:23:55 +0200
Subject: [gdal-dev] gdal.VectorTranslate bug on Linux
Message-ID: <CAERmyNQA3_5Um_OAUjo8qZca9hBNNF-+vmcpCeZxoJKw103WdQ@mail.gmail.com>

Hello, i noticed a strange behaviour in the gdal.VectorTranslate function.
This is my snippet:














*from osgeo import gdal, ogrimport sys'''- SRC (FILE)- DST (FILE)- FORMAT
(GEOJSON)'''SRC =
"/tmp/9f097a2e-d849-4261-9735-f3d45a6d01e7/example.kml"DST =
"/tmp/test.json"FORMAT = "GeoJson"srcDS = gdal.OpenEx(SRC)print("read
done")ds = gdal.VectorTranslate(DST, srcDS, format=FORMAT)*

This code works fine on OSX 10.14 with
GDAL 3.2.0, released 2020/10/26 but not on Debian 11 with GDAL 3.4.2,
released 2022/03/08 and it gave as error: *ERROR 1: hSrcDS == NULL*

Do you know what it could be?
I also tried the snipped described here:
https://github.com/OSGeo/gdal/issues/1683
But even with the Options passed in that manner, gave the same error.
Thanks for your help
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221006/35c3f16b/attachment.htm>

From perrygeo at gmail.com  Thu Oct  6 07:51:56 2022
From: perrygeo at gmail.com (Matt Perry)
Date: Thu, 6 Oct 2022 08:51:56 -0600
Subject: [gdal-dev] GDALOpenShared and open options
Message-ID: <CAG-GLBOz+cqz3tWjj-JX8Agkj8k=3xiUJ=ct=8CbAz8X_CGmuQ@mail.gmail.com>

Hi all. I'm seeing some strange results when reading multiple open
datasets in shared mode. I'm using the TileDB driver which has an open
option, TILEDB_TIMESTAMP. Setting the timestamp should mean that it's
effectively treated as a different dataset since the pixel values will
differ. But what I'm seeing instead is that the timestamp of the first
open dataset takes precedence over any subsequent shared opens.

 I originally encountered this bug with Mapserver (which also uses
GDALOpenShared under the hood) but I've recreated the bug in python to
demonstrate more clearly:
https://gist.github.com/perrygeo/f3e5afcfe8ed9d4064598d6a041f85b9

Digging into the docs a bit, it looks like GDALOpenShared determines
the uniqueness of the dataset based on the file path alone. From
https://gdal.org/api/raster_c_api.html#_CPPv410GDALOpenExPKcjPPCKcPPCKcPPCKc

"if the GetDescription() name for one exactly matches the pszFilename
passed to GDALOpenEx() it will be referenced and returned"

Is the solution here to match on pszFilename AND the full set of open
options? Together, these define a logically-unique dataset. Not doing
so would impact any driver where open options could determine the
pixel values; not sure if any other drivers beside TileDB share this
characteristic.

Thanks for your input,
Matt Perry

From tsvibar at gmail.com  Fri Oct  7 05:03:57 2022
From: tsvibar at gmail.com (Micha Silver)
Date: Fri, 7 Oct 2022 15:03:57 +0300
Subject: [gdal-dev] Changes to NetCDF driver between 3.2 and 3.4 ?
Message-ID: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221007/05eacb6e/attachment.htm>

From runette at gmail.com  Fri Oct  7 05:29:43 2022
From: runette at gmail.com (Paul Harwood)
Date: Fri, 7 Oct 2022 13:29:43 +0100
Subject: [gdal-dev] Changes to NetCDF driver between 3.2 and 3.4 ?
In-Reply-To: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
References: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
Message-ID: <CAE8nN5N7OGXVXNQ8NW5BzP5zaxvx+LHqtJH3RTvUtdBaickqZw@mail.gmail.com>

I might not be this but I remember coming across something similar in the
tests for MDAL and it came down to this PR (I think it was this one)
https://github.com/OSGeo/gdal/pull/5521

Basically - before GDAL was not reading all CRS metadata and after the
change it is reading the CRS data more correctly.

I notice from the StackExchange post that you are defining the Spatial
reference as UTM zone 36N (which is projected) but seem to be providing
that individual coordinates as Lat Lng. I think the change in PR now means
that GDAL is obeying the CRS you specified and trying to look at that data
as being in UTM when it is not!

It kind of makes sense of the messages you receive.

On Fri, 7 Oct 2022 at 13:04, Micha Silver <tsvibar at gmail.com> wrote:

> Hello:
>
> I'm using xarray and rioxarray in python to create a DataSet then export
> to Netcdf. After saving, when I check the exported files with gdalinfo
> using GDAL 3.2, I see the correct extent. However, when using GDAL >=3.4
> (i.e in a conda env) it seems that the extents are lost, and the NetCDF
> dimensions appear instead. This causes the resulting NetCDF to appear at
> coords (0,0) - the wrong place - in QGIS (on a system with the newer GDAL).
>
>
> Here is the output with my system installed GDAL:
>
>
> micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.2.2, released 2021/03/05
> micha at RMS:Kinneret$ gdalinfo  NETCDF:"Kinneret_velocity.nc":v | grep -A 4
> Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left  (  735758.000, 3644806.000) ( 35d31'15.70"E, 32d54'57.98"N)
> Lower Left  (  735758.000, 3621606.000) ( 35d30'54.46"E, 32d42'25.30"N)
> Upper Right (  754558.000, 3644806.000) ( 35d43'18.74"E, 32d54'42.80"N)
>
> Lower Right (  754558.000, 3621606.000) ( 35d42'55.82"E, 32d42'10.25"N)
>
>
> However, in my conda environment, with a newer GDAL:
>
>
> micha at RMS:Kinneret$ conda activate geo
> (geo) micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.5.2, released 2022/09/02
> (geo) micha at RMS:Kinneret$ gdalinfo  NETCDF:"Kinneret_velocity.nc":v |
> grep -A 4 Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,   58.0)
> Upper Right (   47.0,    0.0)
> Lower Right (   47.0,   58.0)
>
> What do I need to add to the xarray Dataset so that the newer GDAL gets
> the correct extent?
>
> In both cases all the "grid_mapping" metadata entries point to
> "spatial_ref", and the full spatial_ref details are available in the NetCDF
> file.
>
>
> (Note: double posted to GIS.stackexchange at
> https://gis.stackexchange.com/questions/442323/changes-to-gdal-netcdf-driver-between-3-2-and-3-4
> )
>
>
> Thanks
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221007/88634dff/attachment.htm>

From even.rouault at spatialys.com  Fri Oct  7 05:31:31 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 7 Oct 2022 14:31:31 +0200
Subject: [gdal-dev] Changes to NetCDF driver between 3.2 and 3.4 ?
In-Reply-To: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
References: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
Message-ID: <226b35f8-55ff-4a66-19c0-f2c5efbf88bd@spatialys.com>

Yes the netCDF driver in GDAL 3.4.2 is much stricter on what it assumes 
to be axis compatible of a geotransform (there were false positives now).

You can set the GDAL_NETCDF_IGNORE_XY_AXIS_NAME_CHECKS configuration 
option or IGNORE_XY_AXIS_NAME_CHECKS open option to YES to remove those 
new extra checks. See https://gdal.org/drivers/raster/netcdf.html

To have GDAL properly recognize the X/longitude & Y/latitude axis as 
such, the 
https://cfconventions.org/Data/cf-conventions/cf-conventions-1.10/cf-conventions.html 
should be followed. So have long_name, standard_name and units set on 
the variables associated with the dimensions such as

float lat(lat) ;
   lat:long_name = "latitude" ;
   lat:units = "degrees_north" ;
   lat:standard_name = "latitude" ;
float lon(lon) ;
   lon:long_name = "longitude" ;
   lon:units = "degrees_east" ;
   lon:standard_name = "longitude" ;

or

   double y(y);
     y:units = "km";
     y:long_name = "y coordinate of projection";
     y:standard_name = "projection_y_coordinate";
   double x(x);
     x:units = "km";
     x:long_name = "x coordinate of projection";
     x:standard_name = "projection_x_coordinate";

Even

Le 07/10/2022 ? 14:03, Micha Silver a ?crit?:
>
> Hello:
>
> I'm using xarray and rioxarray in python to create a DataSet then 
> export to Netcdf. After saving, when I check the exported files with 
> gdalinfo using GDAL 3.2, I see the correct extent. However, when using 
> GDAL >=3.4 (i.e in a conda env) it seems that the extents are lost, 
> and the NetCDF dimensions appear instead. This causes the resulting 
> NetCDF to appear at coords (0,0) - the wrong place - in QGIS (on a 
> system with the newer GDAL).
>
>
> Here is the output with my system installed GDAL:
>
>
> micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.2.2, released 2021/03/05
> micha at RMS:Kinneret$ gdalinfo ?NETCDF:"Kinneret_velocity.nc":v | grep 
> -A 4 Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left ?( ?735758.000, 3644806.000) ( 35d31'15.70"E, 32d54'57.98"N)
> Lower Left ?( ?735758.000, 3621606.000) ( 35d30'54.46"E, 32d42'25.30"N)
> Upper Right ( ?754558.000, 3644806.000) ( 35d43'18.74"E, 32d54'42.80"N)
>
> Lower Right ( ?754558.000, 3621606.000) ( 35d42'55.82"E, 32d42'10.25"N)
>
>
> However, in my conda environment, with a newer GDAL:
>
>
> micha at RMS:Kinneret$ conda activate geo
> (geo) micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.5.2, released 2022/09/02
> (geo) micha at RMS:Kinneret$ gdalinfo ?NETCDF:"Kinneret_velocity.nc":v | 
> grep -A 4 Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left ?( ???0.0, ???0.0)
> Lower Left ?( ???0.0, ??58.0)
> Upper Right ( ??47.0, ???0.0)
> Lower Right ( ??47.0, ??58.0)
>
> What do I need to add to the xarray Dataset so that the newer GDAL 
> gets the correct extent?
>
> In both cases all the "grid_mapping" metadata entries point to 
> "spatial_ref", and the full spatial_ref details are available in the 
> NetCDF file.
>
>
> (Note: double posted to GIS.stackexchange at 
> https://gis.stackexchange.com/questions/442323/changes-to-gdal-netcdf-driver-between-3-2-and-3-4)
>
>
> Thanks
>
> -- 
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221007/f26eeead/attachment-0001.htm>

From alansnow21 at gmail.com  Fri Oct  7 05:33:57 2022
From: alansnow21 at gmail.com (Alan Snow)
Date: Fri, 7 Oct 2022 07:33:57 -0500
Subject: [gdal-dev] Changes to NetCDF driver between 3.2 and 3.4 ?
In-Reply-To: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
References: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
Message-ID: <CAGybdFSx+4+M+jHH5H680ENKwoh3vhq0QOx7uVR_OiBmONn_cg@mail.gmail.com>

Hi Micha,

I answered the question on stackex change. Essentially, you have to provide
the CF axis metadata now. This can be addressed in rioxarray using
rio.write_coordinate_system.

Hopefully this is helpful,
Alan

On Fri, Oct 7, 2022, 7:04 AM Micha Silver <tsvibar at gmail.com> wrote:

> Hello:
>
> I'm using xarray and rioxarray in python to create a DataSet then export
> to Netcdf. After saving, when I check the exported files with gdalinfo
> using GDAL 3.2, I see the correct extent. However, when using GDAL >=3.4
> (i.e in a conda env) it seems that the extents are lost, and the NetCDF
> dimensions appear instead. This causes the resulting NetCDF to appear at
> coords (0,0) - the wrong place - in QGIS (on a system with the newer GDAL).
>
>
> Here is the output with my system installed GDAL:
>
>
> micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.2.2, released 2021/03/05
> micha at RMS:Kinneret$ gdalinfo  NETCDF:"Kinneret_velocity.nc":v | grep -A 4
> Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left  (  735758.000, 3644806.000) ( 35d31'15.70"E, 32d54'57.98"N)
> Lower Left  (  735758.000, 3621606.000) ( 35d30'54.46"E, 32d42'25.30"N)
> Upper Right (  754558.000, 3644806.000) ( 35d43'18.74"E, 32d54'42.80"N)
>
> Lower Right (  754558.000, 3621606.000) ( 35d42'55.82"E, 32d42'10.25"N)
>
>
> However, in my conda environment, with a newer GDAL:
>
>
> micha at RMS:Kinneret$ conda activate geo
> (geo) micha at RMS:Kinneret$ gdalinfo --version
> GDAL 3.5.2, released 2022/09/02
> (geo) micha at RMS:Kinneret$ gdalinfo  NETCDF:"Kinneret_velocity.nc":v |
> grep -A 4 Corner
> Warning 1: dimension #2 (x) is not a Longitude/X dimension.
> Warning 1: dimension #1 (y) is not a Latitude/Y dimension.
> Warning 1: dimension #0 (z) is not a Time or Vertical dimension.
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,   58.0)
> Upper Right (   47.0,    0.0)
> Lower Right (   47.0,   58.0)
>
> What do I need to add to the xarray Dataset so that the newer GDAL gets
> the correct extent?
>
> In both cases all the "grid_mapping" metadata entries point to
> "spatial_ref", and the full spatial_ref details are available in the NetCDF
> file.
>
>
> (Note: double posted to GIS.stackexchange at
> https://gis.stackexchange.com/questions/442323/changes-to-gdal-netcdf-driver-between-3-2-and-3-4
> )
>
>
> Thanks
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221007/a463c043/attachment.htm>

From tsvibar at gmail.com  Fri Oct  7 07:27:05 2022
From: tsvibar at gmail.com (Micha Silver)
Date: Fri, 7 Oct 2022 17:27:05 +0300
Subject: [gdal-dev] Changes to NetCDF driver between 3.2 and 3.4 ?
In-Reply-To: <226b35f8-55ff-4a66-19c0-f2c5efbf88bd@spatialys.com>
References: <4f7c73f2-4b41-aba5-594b-da549cbaa8be@gmail.com>
 <226b35f8-55ff-4a66-19c0-f2c5efbf88bd@spatialys.com>
Message-ID: <2e7b6981-6cea-3436-6fa0-251f35b2403b@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221007/86b858b8/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Oct  9 23:47:19 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 10 Oct 2022 06:47:19 +0000
Subject: [gdal-dev] Why does an old Python code using /vsicurl?[options]
 syntax yield HTTP 404 now?
Message-ID: <AM0PR09MB3219C7B51DB2E9A674625090FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

See this question https://gis.stackexchange.com/questions/442512/python3-download-soilgrid-http-error where the user is obviously trying to use the code from https://git.wur.nl/isric/soilgrids/soilgrids.notebooks/-/blob/master/markdown/webdav_from_Python.md. The tutorial is well written and I believe that it has been working 2 years ago but now it yields a HTTP 404 Not found response from the server. The URL to the data is OK and gdalinfo can access the data.

-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/9780ad42/attachment.htm>

From lists at home.gofferje.net  Mon Oct 10 00:30:13 2022
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Mon, 10 Oct 2022 10:30:13 +0300
Subject: [gdal-dev] Looking for some gdal-python-math-stuff help:
 HighLightCompressVisualizer
Message-ID: <5ef4ead3-fb29-ed4a-9fd9-4e4afc3753a4@home.gofferje.net>

Hi all,

I'm still tinkering on my 
automatic-download-satellite-data-and-create-images-from-my-area scripts 
and I was wondering if anybody could help me out or point me to some math.

I'm currently using percentiles in a little Python script to compress 
the contrast of my images. The result is pretty OK but it breaks if 
large areas of the image are very bright, like clouds or snow.

The Sentinelhub EO Browser offers a function HighlightCompressVisualizer 
(see 
https://docs.sentinel-hub.com/api/latest/evalscript/functions/#highlightcompressvisualizer) 
which does that "a little" better.

Is there anything comparable in gdal, python or any related library?
That level of math is a little bit above me. High school was long ago...

T:Stefan

-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From daniel.fred.evans at gmail.com  Mon Oct 10 01:02:09 2022
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Mon, 10 Oct 2022 09:02:09 +0100
Subject: [gdal-dev] Why does an old Python code using /vsicurl?[options]
 syntax yield HTTP 404 now?
In-Reply-To: <AM0PR09MB3219C7B51DB2E9A674625090FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB3219C7B51DB2E9A674625090FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <CANnaQaZk+16MM2fjgjPSHHAMiX3LGUWy1X+GE+4ha4M2M7g0ZQ@mail.gmail.com>

Hi Jukka,

Can you, or the original poster, give some more information on what Python
and GDAL versions you're using that cause trouble? I've not immediately hit
404 errors on trying - with CPL_DEBUG=ON, I can see GDAL successfully
opening tiles (HTTP 206).

With something like 13,000 tiles in a single VRT, and a flakey academic
data server (according to a reply on the linked post), I'm not yet
convinced that the problem is definitively GDAL-specific.

Regards,
Daniel

On Mon, 10 Oct 2022 at 07:47, Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
>
>
> See this question
> https://gis.stackexchange.com/questions/442512/python3-download-soilgrid-http-error
> where the user is obviously trying to use the code from
> https://git.wur.nl/isric/soilgrids/soilgrids.notebooks/-/blob/master/markdown/webdav_from_Python.md.
> The tutorial is well written and I believe that it has been working 2 years
> ago but now it yields a HTTP 404 Not found response from the server. The
> URL to the data is OK and gdalinfo can access the data.
>
>
>
> -Jukka Rahkonen-
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/d3e71308/attachment.htm>

From daniel.fred.evans at gmail.com  Mon Oct 10 01:03:01 2022
From: daniel.fred.evans at gmail.com (Daniel Evans)
Date: Mon, 10 Oct 2022 09:03:01 +0100
Subject: [gdal-dev] Why does an old Python code using /vsicurl?[options]
 syntax yield HTTP 404 now?
In-Reply-To: <CANnaQaZk+16MM2fjgjPSHHAMiX3LGUWy1X+GE+4ha4M2M7g0ZQ@mail.gmail.com>
References: <AM0PR09MB3219C7B51DB2E9A674625090FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>
 <CANnaQaZk+16MM2fjgjPSHHAMiX3LGUWy1X+GE+4ha4M2M7g0ZQ@mail.gmail.com>
Message-ID: <CANnaQaZ7E=_7oDvrDZ3n_6YMNtdAbrwqSviu6Rb5XL-ivVyRnA@mail.gmail.com>

(To follow my own advice, I've tried with a fresh environment with GDAL
3.4.1 and Python 3.9!)

On Mon, 10 Oct 2022 at 09:02, Daniel Evans <daniel.fred.evans at gmail.com>
wrote:

> Hi Jukka,
>
> Can you, or the original poster, give some more information on what Python
> and GDAL versions you're using that cause trouble? I've not immediately hit
> 404 errors on trying - with CPL_DEBUG=ON, I can see GDAL successfully
> opening tiles (HTTP 206).
>
> With something like 13,000 tiles in a single VRT, and a flakey academic
> data server (according to a reply on the linked post), I'm not yet
> convinced that the problem is definitively GDAL-specific.
>
> Regards,
> Daniel
>
> On Mon, 10 Oct 2022 at 07:47, Rahkonen Jukka <
> jukka.rahkonen at maanmittauslaitos.fi> wrote:
>
>> Hi,
>>
>>
>>
>> See this question
>> https://gis.stackexchange.com/questions/442512/python3-download-soilgrid-http-error
>> where the user is obviously trying to use the code from
>> https://git.wur.nl/isric/soilgrids/soilgrids.notebooks/-/blob/master/markdown/webdav_from_Python.md.
>> The tutorial is well written and I believe that it has been working 2 years
>> ago but now it yields a HTTP 404 Not found response from the server. The
>> URL to the data is OK and gdalinfo can access the data.
>>
>>
>>
>> -Jukka Rahkonen-
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/51af23b0/attachment-0001.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 10 02:08:36 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 10 Oct 2022 09:08:36 +0000
Subject: [gdal-dev] Why does an old Python code using /vsicurl?[options]
 syntax yield HTTP 404 now?
In-Reply-To: <CANnaQaZk+16MM2fjgjPSHHAMiX3LGUWy1X+GE+4ha4M2M7g0ZQ@mail.gmail.com>
References: <AM0PR09MB3219C7B51DB2E9A674625090FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>
 <CANnaQaZk+16MM2fjgjPSHHAMiX3LGUWy1X+GE+4ha4M2M7g0ZQ@mail.gmail.com>
Message-ID: <AM0PR09MB3219D2D0E4B43FE9BF845A63FD209@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I tried first only with gdalinfo. Now I tried Python (v. 3.9 with GDAL 3.4.1  from OSGeo4W) and for me the script stops into another error

ERROR 4: `/vsicurl?max_retry=3&retry_delay=1&list_dir=no&url=https://files.isric.org/soilgrids/latest/data/ocs\./ocs_0-30cm_mean/tileSG-016-043/tileSG-016-043_2-4.tif' not recognized as a supported file format.

I suppose that I get further than the original poster and my GDAL reads the vrt. Then there happens something with reading a tiff that is referred in the vrt but I do not know what. The link to the ...2-4.tif works with a browser and the downloaded TIFF file is good. I tend to have problems with our proxy server but because the .vrt and .tif are coming from the same base URL I do not believe in that issue this time.

-Jukka-



L?hett?j?: Daniel Evans <daniel.fred.evans at gmail.com>
L?hetetty: maanantai 10. lokakuuta 2022 11.02
Vastaanottaja: Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: 'gdal-dev at lists.osgeo.org' (gdal-dev at lists.osgeo.org) <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Why does an old Python code using /vsicurl?[options] syntax yield HTTP 404 now?

Hi Jukka,

Can you, or the original poster, give some more information on what Python and GDAL versions you're using that cause trouble? I've not immediately hit 404 errors on trying - with CPL_DEBUG=ON, I can see GDAL successfully opening tiles (HTTP 206).

With something like 13,000 tiles in a single VRT, and a flakey academic data server (according to a reply on the linked post), I'm not yet convinced that the problem is definitively GDAL-specific.

Regards,
Daniel

On Mon, 10 Oct 2022 at 07:47, Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
Hi,

See this question https://gis.stackexchange.com/questions/442512/python3-download-soilgrid-http-error<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F442512%2Fpython3-download-soilgrid-http-error&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cb1ad9d76010046407f4208daaa95c4ea%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638009857471277550%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=2hp08NNZKDGRY63Zt7tw6WtQlDG8D8%2B7Bogh%2BSUaxBA%3D&reserved=0> where the user is obviously trying to use the code from https://git.wur.nl/isric/soilgrids/soilgrids.notebooks/-/blob/master/markdown/webdav_from_Python.md<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgit.wur.nl%2Fisric%2Fsoilgrids%2Fsoilgrids.notebooks%2F-%2Fblob%2Fmaster%2Fmarkdown%2Fwebdav_from_Python.md&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cb1ad9d76010046407f4208daaa95c4ea%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638009857471277550%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2F7RYPfGI42SwDbdd2KRWe2L%2F5fnlsYDz0uaDh%2B5Wtp4%3D&reserved=0>. The tutorial is well written and I believe that it has been working 2 years ago but now it yields a HTTP 404 Not found response from the server. The URL to the data is OK and gdalinfo can access the data.

-Jukka Rahkonen-

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cb1ad9d76010046407f4208daaa95c4ea%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638009857471433799%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=zlFF1ZzLymmSIkk8atPv8mQ390%2BNYO4%2FI1%2Brj%2FtXMok%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/2b722ffb/attachment.htm>

From mbu at Teleplan.no  Mon Oct 10 03:11:17 2022
From: mbu at Teleplan.no (Budalen, Mats Bruun)
Date: Mon, 10 Oct 2022 10:11:17 +0000
Subject: [gdal-dev] Computing statistics from raster dataset without writing
 aux.xml
Message-ID: <DB7PR04MB4540149E5182D4A7DA8DB083A4209@DB7PR04MB4540.eurprd04.prod.outlook.com>

Hello!

I'm writing a Python program which reads raster data. The program uses the ComputeStatistics() function on the dataset, which automatically attempts to write the result to an .aux.xml next to the raster file. I do not under any circumstance want to try to write to the source directory, so I have set gdal.SetConfigOption('GDAL_PAM_ENABLED','NO') before I open the dataset.

My program will sometimes come across datasets where the SRS is only defined in an aux.xml. Unfortunately, the above ConfigOption prevents the SRS definition from being read from the aux.xml.

Is there any way to compute statistics without creating/changing the aux.xml, while at the same time reading the SRS?


Regards,

Mats Budalen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/c9bf9a7a/attachment-0001.htm>

From lnicola at dend.ro  Mon Oct 10 05:40:55 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Mon, 10 Oct 2022 15:40:55 +0300
Subject: [gdal-dev] Computing statistics from raster dataset without
 writing aux.xml
In-Reply-To: <DB7PR04MB4540149E5182D4A7DA8DB083A4209@DB7PR04MB4540.eurprd04.prod.outlook.com>
References: <DB7PR04MB4540149E5182D4A7DA8DB083A4209@DB7PR04MB4540.eurprd04.prod.outlook.com>
Message-ID: <5ab20d4c-6aa0-4731-9370-ba418ada63ab@betaapp.fastmail.com>

Hi Mats,

This won't help you, but I wanted to suggest you make a temporary directory, copy the .aux.xml file there, then set GDAL_PAM_PROXY_DIR. Unfortunately, at least in my test, GDAL still seems to save the file next to the input, even when calling SetConfigOption before doing anything else.

Regards,
Laurentiu

On Mon, Oct 10, 2022, at 13:11, Budalen, Mats Bruun via gdal-dev wrote:
> Hello!
>  
> I?m writing a Python program which reads raster data. The program uses the *ComputeStatistics()* function on the dataset, which automatically attempts to write the result to an .aux.xml next to the raster file. I do not under any circumstance want to try to write to the source directory, so I have set *gdal.SetConfigOption('GDAL_PAM_ENABLED','NO')* before I open the dataset.
>  
> My program will sometimes come across datasets where the SRS is only defined in an aux.xml. Unfortunately, the above ConfigOption prevents the SRS definition from being read from the aux.xml.
>  
> Is there any way to compute statistics without creating/changing the aux.xml, while at the same time reading the SRS?
>  
>  
> Regards,
>  
> Mats Budalen
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/711a4e61/attachment.htm>

From sean.gillies at gmail.com  Mon Oct 10 06:42:42 2022
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 10 Oct 2022 07:42:42 -0600
Subject: [gdal-dev] Computing statistics from raster dataset without
 writing aux.xml
In-Reply-To: <5ab20d4c-6aa0-4731-9370-ba418ada63ab@betaapp.fastmail.com>
References: <DB7PR04MB4540149E5182D4A7DA8DB083A4209@DB7PR04MB4540.eurprd04.prod.outlook.com>
 <5ab20d4c-6aa0-4731-9370-ba418ada63ab@betaapp.fastmail.com>
Message-ID: <CAOodmJpYEo8NtKdZZ9896ZW6XKANtn5B=V5TztknYDUpwif5xQ@mail.gmail.com>

Hi,

Another approach, also involving a copy, is to read the raster data as
numpy arrays and compute the statistics of those arrays. The GDAL method
also has to read the raster data to compute statistics, of course, but
doesn't store the entirety of it in memory.


On Mon, Oct 10, 2022, 6:51 AM Lauren?iu Nicola via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi Mats,
>
> This won't help you, but I wanted to suggest you make a temporary
> directory, copy the .aux.xml file there, then set GDAL_PAM_PROXY_DIR.
> Unfortunately, at least in my test, GDAL still seems to save the file next
> to the input, even when calling SetConfigOption before doing anything
> else.
>
> Regards,
> Laurentiu
>
> On Mon, Oct 10, 2022, at 13:11, Budalen, Mats Bruun via gdal-dev wrote:
>
> Hello!
>
>
>
> I?m writing a Python program which reads raster data. The program uses the
> *ComputeStatistics()* function on the dataset, which automatically
> attempts to write the result to an .aux.xml next to the raster file. I do
> not under any circumstance want to try to write to the source directory, so
> I have set *gdal.SetConfigOption('GDAL_PAM_ENABLED','NO')* before I open
> the dataset.
>
>
>
> My program will sometimes come across datasets where the SRS is only
> defined in an aux.xml. Unfortunately, the above ConfigOption prevents the
> SRS definition from being read from the aux.xml.
>
>
>
> Is there any way to compute statistics without creating/changing the
> aux.xml, while at the same time reading the SRS?
>
>
>
>
>
> Regards,
>
>
>
> Mats Budalen
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/81d763da/attachment.htm>

From runette at gmail.com  Mon Oct 10 06:46:48 2022
From: runette at gmail.com (Paul Harwood)
Date: Mon, 10 Oct 2022 16:46:48 +0300
Subject: [gdal-dev] Looking for some gdal-python-math-stuff help:
 HighLightCompressVisualizer
In-Reply-To: <5ef4ead3-fb29-ed4a-9fd9-4e4afc3753a4@home.gofferje.net>
References: <5ef4ead3-fb29-ed4a-9fd9-4e4afc3753a4@home.gofferje.net>
Message-ID: <CAE8nN5PAG5XkPEoswgqiWe-8nKa-wLxCcfr1qQSr5GGysgPWJA@mail.gmail.com>

Another more common way to address the problem is to perform a log
transform on the image see
https://theailearner.com/2019/01/01/log-transformation/

I am not aware of any ootb log transform libraries. That link above does
show how to do it in OpenCV and numpy. I would probably use Pillow my self
and here is a link talking about how to do that - not my link and I have
never used it so it could be wrong or very slow etc

https://pythontic.com/image-processing/pillow/logarithmic%20transformation

I guess the same thing could be done in GDAL.

On Mon, 10 Oct 2022, 10:40 Stefan Gofferje, <lists at home.gofferje.net> wrote:

> Hi all,
>
> I'm still tinkering on my
> automatic-download-satellite-data-and-create-images-from-my-area scripts
> and I was wondering if anybody could help me out or point me to some math.
>
> I'm currently using percentiles in a little Python script to compress
> the contrast of my images. The result is pretty OK but it breaks if
> large areas of the image are very bright, like clouds or snow.
>
> The Sentinelhub EO Browser offers a function HighlightCompressVisualizer
> (see
>
> https://docs.sentinel-hub.com/api/latest/evalscript/functions/#highlightcompressvisualizer)
>
> which does that "a little" better.
>
> Is there anything comparable in gdal, python or any related library?
> That level of math is a little bit above me. High school was long ago...
>
> T:Stefan
>
> --
>   (o_   Stefan Gofferje            | SCLT, MCP, CCSA
>   //\   Reg'd Linux User #247167   | VCP #2263
>   V_/_  https://www.gofferje.net   | https://www.saakeskus.fi
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/cc322168/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 10 07:21:48 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 10 Oct 2022 14:21:48 +0000
Subject: [gdal-dev] Computing statistics from raster dataset without
 writing aux.xml
In-Reply-To: <CAOodmJpYEo8NtKdZZ9896ZW6XKANtn5B=V5TztknYDUpwif5xQ@mail.gmail.com>
References: <DB7PR04MB4540149E5182D4A7DA8DB083A4209@DB7PR04MB4540.eurprd04.prod.outlook.com>
 <5ab20d4c-6aa0-4731-9370-ba418ada63ab@betaapp.fastmail.com>
 <CAOodmJpYEo8NtKdZZ9896ZW6XKANtn5B=V5TztknYDUpwif5xQ@mail.gmail.com>
Message-ID: <AM0PR09MB3219D61C7145C02DD2EF801DFD209@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

Third approach, convert the image into VRT format into a temporary directory and both the SRS and statistics will go into the VRT file:

gdal_translate -of VRT -stats input.tif \temp_dir\for_metadata.vrt.

I guess that the temp_dir can be in memory if it feels good.

-Jukka Rahkonen-

L?hett?j?: gda-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Sean Gillies
L?hetetty: maanantai 10. lokakuuta 2022 16.43
Vastaanottaja: Lauren?iu Nicola <lnicola at dend.ro>
Kopio: gdal dev <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Computing statistics from raster dataset without writing aux.xml

Hi,

Another approach, also involving a copy, is to read the raster data as numpy arrays and compute the statistics of those arrays. The GDAL method also has to read the raster data to compute statistics, of course, but doesn't store the entirety of it in memory.


On Mon, Oct 10, 2022, 6:51 AM Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> wrote:
Hi Mats,

This won't help you, but I wanted to suggest you make a temporary directory, copy the .aux.xml file there, then set GDAL_PAM_PROXY_DIR. Unfortunately, at least in my test, GDAL still seems to save the file next to the input, even when calling SetConfigOption before doing anything else.

Regards,
Laurentiu

On Mon, Oct 10, 2022, at 13:11, Budalen, Mats Bruun via gdal-dev wrote:

Hello!



I?m writing a Python program which reads raster data. The program uses the ComputeStatistics() function on the dataset, which automatically attempts to write the result to an .aux.xml next to the raster file. I do not under any circumstance want to try to write to the source directory, so I have set gdal.SetConfigOption('GDAL_PAM_ENABLED','NO') before I open the dataset.



My program will sometimes come across datasets where the SRS is only defined in an aux.xml. Unfortunately, the above ConfigOption prevents the SRS definition from being read from the aux.xml.



Is there any way to compute statistics without creating/changing the aux.xml, while at the same time reading the SRS?





Regards,



Mats Budalen
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cb38698249e6b4faf2c2a08daaac5641c%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638010062006811240%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=VL9i%2FSjvCD%2B14VvxM37TXCLzniuGIkA%2BGrSAAtdhKZY%3D&reserved=0>


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cb38698249e6b4faf2c2a08daaac5641c%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638010062006811240%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=VL9i%2FSjvCD%2B14VvxM37TXCLzniuGIkA%2BGrSAAtdhKZY%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/00beab36/attachment-0001.htm>

From liglio.pessoal at nexxa.com.br  Mon Oct 10 08:08:09 2022
From: liglio.pessoal at nexxa.com.br (liglio.pessoal at nexxa.com.br)
Date: Mon, 10 Oct 2022 12:08:09 -0300
Subject: [gdal-dev] Set a PNG background transparent without flip
Message-ID: <!&!AAAAAAAAAAAuAAAAAAAAACaPdoM7XC5DsX4JrwXUdYwBAMO2jhD3dRHOtM0AqgC7tuYAAAAAAA4AABAAAADsp3OKKnlCRohWoAtDyYvzAQAAAAA=@nexxa.com.br>

Hi,

 

I want to set an image PNG background to transparent. I do using gdalwarp,
but the image flips horizontally. 

I am using a workaround, executing the gdalwarp command twice to flip back.

Can I set the background to transparent using just one command without flip
?

 

IMAGE ORIGINAL:

Driver: PNG/Portable Network Graphics

Files: 2022-09-25--18_46_27.png

Size is 400, 400

Metadata:

  NODATA_VALUES=0 0 0

Image Structure Metadata:

  INTERLEAVE=PIXEL

Corner Coordinates:

Upper Left  (    0.0,    0.0)

Lower Left  (    0.0,  400.0)

Upper Right (  400.0,    0.0)

Lower Right (  400.0,  400.0)

Center      (  200.0,  200.0)

Band 1 Block=400x1 Type=Byte, ColorInterp=Red

  NoData Value=0

  Mask Flags: PER_DATASET NODATA

Band 2 Block=400x1 Type=Byte, ColorInterp=Green

  NoData Value=0

  Mask Flags: PER_DATASET NODATA

Band 3 Block=400x1 Type=Byte, ColorInterp=Blue

  NoData Value=0

  Mask Flags: PER_DATASET NODATA

 

COMMAND:

gdalwarp -of PNG -overwrite  -srcnodata 0 -dstalpha -to
SRC_METHOD=NO_GEOTRANSFORM 2022-09-25--18_56_15.png
MI-2022-09-25--18_56_15.png

 

IMAGE MODIFIED (Background transparent and flipped)

Driver: PNG/Portable Network Graphics

Files: MI-2022-09-25--18_46_27.png

       MI-2022-09-25--18_46_27.png.aux.xml

Size is 400, 400

Origin = (0.000000000000000,400.000000000000000)

Pixel Size = (1.000000000000000,-1.000000000000000)

Image Structure Metadata:

  INTERLEAVE=PIXEL

Corner Coordinates:

Upper Left  (       0.000,     400.000)

Lower Left  (   0.0000000,   0.0000000)

Upper Right (     400.000,     400.000)

Lower Right (     400.000,       0.000)

Center      (     200.000,     200.000)

Band 1 Block=400x1 Type=Byte, ColorInterp=Red

  Mask Flags: PER_DATASET ALPHA

Band 2 Block=400x1 Type=Byte, ColorInterp=Green

  Mask Flags: PER_DATASET ALPHA

Band 3 Block=400x1 Type=Byte, ColorInterp=Blue

  Mask Flags: PER_DATASET ALPHA

Band 4 Block=400x1 Type=Byte, ColorInterp=Alpha

 

Regards,

Liglio

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221010/a2211fef/attachment.htm>

From lists at home.gofferje.net  Tue Oct 11 02:16:12 2022
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Tue, 11 Oct 2022 12:16:12 +0300
Subject: [gdal-dev] Looking for some gdal-python-math-stuff help:
 HighLightCompressVisualizer
In-Reply-To: <CAE8nN5PAG5XkPEoswgqiWe-8nKa-wLxCcfr1qQSr5GGysgPWJA@mail.gmail.com>
References: <5ef4ead3-fb29-ed4a-9fd9-4e4afc3753a4@home.gofferje.net>
 <CAE8nN5PAG5XkPEoswgqiWe-8nKa-wLxCcfr1qQSr5GGysgPWJA@mail.gmail.com>
Message-ID: <5ba323c4-0aef-2f60-0b95-12cbcb43c300@home.gofferje.net>

Hi,

On 10/10/22 16:46, Paul Harwood wrote:
> Another more common way to address the problem is to perform a log 
> transform on the image see 
> https://theailearner.com/2019/01/01/log-transformation/ 
> <https://theailearner.com/2019/01/01/log-transformation/>
> 
> I am not aware of any ootb log transform libraries. That link above does 
> show how to do it in OpenCV and numpy. I would probably use Pillow my 
> self and here is a link talking about how to do that - not my link and I 
> have never used it so it could be wrong or very slow etc
> 
> https://pythontic.com/image-processing/pillow/logarithmic%20transformation <https://pythontic.com/image-processing/pillow/logarithmic%20transformation>
> 
> I guess the same thing could be done in GDAL.

Yes, of course... I do it a lot in my photography hobby. Could (should) 
have thought of this idea myself... Thanks for the pointer!

-Stefan

-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From even.rouault at spatialys.com  Tue Oct 11 05:32:03 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Oct 2022 14:32:03 +0200
Subject: [gdal-dev] Discussion of Xerces-C++ project health and possibility
 of retirement
Message-ID: <3b4c02f9-a03a-c3db-84df-d4e444f9ce94@spatialys.com>

Hi,

FYI see threads "Discussion of Xerces-C++ project health and possibility 
of retirement" and "Prepping a 3.2.4 release" at 
https://lists.apache.org/list.html?c-dev at xerces.apache.org

In short, the Xerces-C++ project GDAL depends for a few drivers is 
considered to be moved into https://attic.apache.org/ , which is for 
end-of-life projects, due to lack of maintainers.

Current GDAL use of Xerces-C++:

- in GML driver. but the Expat XML parser is?also already implemented 
with similar capabilities, so no issue here

- in NAS driver. requirement for NAS driver. That said, I presume Expat 
could be used, as only XML parser capabilities are used AFAIK, pending 
some work of course.

- in ILI driver. Same as NAS

- in GMLAS driver. Xerces-C++ dependency is critical here. Not only its 
XML parsing capabilities are used, as well as its XML Schema validation 
ones, but the driver strongly depends on using XML Schema grammar 
analysis classes of Xerces-C++ to fully understand the XML schema 
constructs. As far as I know, no other C/C++ XML open source libraries 
have such capabilities.

While a no-longer-maintained-at-all Xerces-C++ is likely not an 
immediate risk for GDAL, it could cause troubles in the medium/long 
term: no functional or security fixes, issues with compilation with 
newer compilers, etc.

Even


http://www.spatialys.com
My software is free, but my time generally not.


From Christian.Brock at amdocs.com  Tue Oct 11 05:56:19 2022
From: Christian.Brock at amdocs.com (Christian Brock)
Date: Tue, 11 Oct 2022 12:56:19 +0000
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
Message-ID: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>

I have some special issue and would be glad for suggestions.

We run complex regression tests using environmental files -- too complex for a bug report ;-(

Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.

The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
Can anyone think of something that is true with five or more threads but not below?

Besides this I should mention, that we use Java bindings

The issue is
- file format independent,
- were observed on ubuntu 20.04 and 22.04,
- affects a sample with the following coordinate system:
PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
- WGS84 and all UTM systems are good.

I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
When I change the sample order, it is the second sample again!

And as a final point, there are random memory corruptions every couple of hours.

So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.

Many thanks
--Chr.



This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>


From even.rouault at spatialys.com  Tue Oct 11 06:10:30 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Oct 2022 15:10:30 +0200
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
In-Reply-To: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
References: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
Message-ID: <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>

Christian,

I suspect the issue is not that much jumping from 4 to 5 threads, but 
some latent issue in your code or in GDAL/PROJ that becomes more 
visible. First thing to check: are you sure you are not using a given 
GDAL / OGR object simultaneously in more than one thread ?

If that's not the issue, if you want effective help, I'm afraid you'll 
have to go through the effort of writing a minimal standalone reproducer 
(code+data) that you can share with us.

Even

Le 11/10/2022 ? 14:56, Christian Brock via gdal-dev a ?crit?:
> I have some special issue and would be glad for suggestions.
>
> We run complex regression tests using environmental files -- too complex for a bug report ;-(
>
> Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.
>
> The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
> Can anyone think of something that is true with five or more threads but not below?
>
> Besides this I should mention, that we use Java bindings
>
> The issue is
> - file format independent,
> - were observed on ubuntu 20.04 and 22.04,
> - affects a sample with the following coordinate system:
> PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
> - WGS84 and all UTM systems are good.
>
> I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
> When I change the sample order, it is the second sample again!
>
> And as a final point, there are random memory corruptions every couple of hours.
>
> So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.
>
> Many thanks
> --Chr.
>
>
>
> This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Christian.Brock at amdocs.com  Tue Oct 11 23:59:52 2022
From: Christian.Brock at amdocs.com (Christian Brock)
Date: Wed, 12 Oct 2022 06:59:52 +0000
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
In-Reply-To: <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>
References: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
 <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>
Message-ID: <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>

Hi Even,

Thanks for the fast answer.

We do not share any gdal datasets, BUT we share all spatial references and all coordinate transformations between threads. It used to work in the past, hmm ...

I assume this is a problem?

Cheers --Chr.

-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 

Christian,

I suspect the issue is not that much jumping from 4 to 5 threads, but some latent issue in your code or in GDAL/PROJ that becomes more visible. First thing to check: are you sure you are not using a given GDAL / OGR object simultaneously in more than one thread ?

If that's not the issue, if you want effective help, I'm afraid you'll have to go through the effort of writing a minimal standalone reproducer
(code+data) that you can share with us.

Even

Le 11/10/2022 ? 14:56, Christian Brock via gdal-dev a ?crit?:
> I have some special issue and would be glad for suggestions.
>
> We run complex regression tests using environmental files -- too 
> complex for a bug report ;-(
>
> Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.
>
> The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
> Can anyone think of something that is true with five or more threads but not below?
>
> Besides this I should mention, that we use Java bindings
>
> The issue is
> - file format independent,
> - were observed on ubuntu 20.04 and 22.04,
> - affects a sample with the following coordinate system:
> PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
> - WGS84 and all UTM systems are good.
>
> I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
> When I change the sample order, it is the second sample again!
>
> And as a final point, there are random memory corruptions every couple of hours.
>
> So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.
>
> Many thanks
> --Chr.
>
>
>
> This email and the information contained herein is proprietary and 
> confidential and subject to the Amdocs Email Terms of Service, which 
> you may review at https://www.amdocs.com/about/email-terms-of-service 
> <https://www.amdocs.com/about/email-terms-of-service>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flist
> s.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7CChristi
> an.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127
> 646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZ
> sb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3
> D%7C3000%7C%7C%7C&amp;sdata=nOmLEy8X%2FU%2FMlSh1PPvvwRFsYH17H%2F8Fpm17
> EWPtx5U%3D&amp;reserved=0

--
https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7CChristian.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=2lLYNyBe8NrKkLkZEK7oN6MXq%2Bd7KQMDilS17fVL7Ck%3D&amp;reserved=0
My software is free, but my time generally not.

This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>


From Christian.Brock at amdocs.com  Wed Oct 12 01:12:12 2022
From: Christian.Brock at amdocs.com (Christian Brock)
Date: Wed, 12 Oct 2022 08:12:12 +0000
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
In-Reply-To: <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>
References: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
 <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>
 <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>
Message-ID: <AM8PR06MB761960CA77DBC82A991B3D188A229@AM8PR06MB7619.eurprd06.prod.outlook.com>

Hi Even,

As a PS:

We also open the same file using gdal.Open() or gdal.OpenShared() again and again ...
We tried GeoTiff, external and internal and also HFA -- all show the issue

Thx
--Chr.

-----Original Message-----
From: Christian Brock 

Hi Even,

Thanks for the fast answer.

We do not share any gdal datasets, BUT we share all spatial references and all coordinate transformations between threads. It used to work in the past, hmm ...

I assume this is a problem?

Cheers --Chr.

-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 

Christian,

I suspect the issue is not that much jumping from 4 to 5 threads, but some latent issue in your code or in GDAL/PROJ that becomes more visible. First thing to check: are you sure you are not using a given GDAL / OGR object simultaneously in more than one thread ?

If that's not the issue, if you want effective help, I'm afraid you'll have to go through the effort of writing a minimal standalone reproducer
(code+data) that you can share with us.

Even

Le 11/10/2022 ? 14:56, Christian Brock via gdal-dev a ?crit?:
> I have some special issue and would be glad for suggestions.
>
> We run complex regression tests using environmental files -- too 
> complex for a bug report ;-(
>
> Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.
>
> The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
> Can anyone think of something that is true with five or more threads but not below?
>
> Besides this I should mention, that we use Java bindings
>
> The issue is
> - file format independent,
> - were observed on ubuntu 20.04 and 22.04,
> - affects a sample with the following coordinate system:
> PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
> - WGS84 and all UTM systems are good.
>
> I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
> When I change the sample order, it is the second sample again!
>
> And as a final point, there are random memory corruptions every couple of hours.
>
> So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.
>
> Many thanks
> --Chr.
>
>
>
> This email and the information contained herein is proprietary and 
> confidential and subject to the Amdocs Email Terms of Service, which 
> you may review at https://www.amdocs.com/about/email-terms-of-service
> <https://www.amdocs.com/about/email-terms-of-service>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flist
> s.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7CChristi
> an.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127
> 646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZ
> sb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3
> D%7C3000%7C%7C%7C&amp;sdata=nOmLEy8X%2FU%2FMlSh1PPvvwRFsYH17H%2F8Fpm17
> EWPtx5U%3D&amp;reserved=0

--
https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7CChristian.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=2lLYNyBe8NrKkLkZEK7oN6MXq%2Bd7KQMDilS17fVL7Ck%3D&amp;reserved=0
My software is free, but my time generally not.

This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>


From even.rouault at spatialys.com  Wed Oct 12 01:30:51 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Oct 2022 10:30:51 +0200
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
In-Reply-To: <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>
References: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
 <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>
 <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>
Message-ID: <4c453c04-0348-6da6-4ca4-0f1c2bb56f77@spatialys.com>


Le 12/10/2022 ? 08:59, Christian Brock a ?crit?:
> Hi Even,
>
> Thanks for the fast answer.
>
> We do not share any gdal datasets, BUT we share all spatial references and all coordinate transformations between threads. It used to work in the past, hmm ...
>
> I assume this is a problem?

yes, this was never guaranteed to be safe, even if it was mostly in 
practice before PROJ 6. But with PROJ >= 6, you can't use the same 
SpatialReference or CoordinateTranfsormation concurrently from several 
threads, even for read-only operations, since some internal state might 
be changed.

Even

>
> Cheers --Chr.
>
> -----Original Message-----
> From: Even Rouault <even.rouault at spatialys.com>
>
> Christian,
>
> I suspect the issue is not that much jumping from 4 to 5 threads, but some latent issue in your code or in GDAL/PROJ that becomes more visible. First thing to check: are you sure you are not using a given GDAL / OGR object simultaneously in more than one thread ?
>
> If that's not the issue, if you want effective help, I'm afraid you'll have to go through the effort of writing a minimal standalone reproducer
> (code+data) that you can share with us.
>
> Even
>
> Le 11/10/2022 ? 14:56, Christian Brock via gdal-dev a ?crit?:
>> I have some special issue and would be glad for suggestions.
>>
>> We run complex regression tests using environmental files -- too
>> complex for a bug report ;-(
>>
>> Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.
>>
>> The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
>> Can anyone think of something that is true with five or more threads but not below?
>>
>> Besides this I should mention, that we use Java bindings
>>
>> The issue is
>> - file format independent,
>> - were observed on ubuntu 20.04 and 22.04,
>> - affects a sample with the following coordinate system:
>> PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
>> - WGS84 and all UTM systems are good.
>>
>> I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
>> When I change the sample order, it is the second sample again!
>>
>> And as a final point, there are random memory corruptions every couple of hours.
>>
>> So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.
>>
>> Many thanks
>> --Chr.
>>
>>
>>
>> This email and the information contained herein is proprietary and
>> confidential and subject to the Amdocs Email Terms of Service, which
>> you may review at https://www.amdocs.com/about/email-terms-of-service
>> <https://www.amdocs.com/about/email-terms-of-service>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flist
>> s.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7CChristi
>> an.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127
>> 646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZ
>> sb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3
>> D%7C3000%7C%7C%7C&amp;sdata=nOmLEy8X%2FU%2FMlSh1PPvvwRFsYH17H%2F8Fpm17
>> EWPtx5U%3D&amp;reserved=0
> --
> https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7CChristian.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca127646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=2lLYNyBe8NrKkLkZEK7oN6MXq%2Bd7KQMDilS17fVL7Ck%3D&amp;reserved=0
> My software is free, but my time generally not.
>
> This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From rdmailings at duif.net  Wed Oct 12 02:51:12 2022
From: rdmailings at duif.net (Richard Duivenvoorde)
Date: Wed, 12 Oct 2022 11:51:12 +0200
Subject: [gdal-dev] Does it hurt to *always* use BIGTIFF when using
 gdal_translate
Message-ID: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>

Hi Devs,

In QGIS we have a GUI for gdal_translate, the "Georeferencer".

It was reported that when Georeferencing huge Tiffs (user was talking about 8GB), that QGIS ended up with a broken 3.99GB Tiff, see https://github.com/qgis/QGIS/issues/47362

One of the 'easy' solutions (on QGIS side) would be to *always* add the BIGTIFF=yes option.

Question to you: would that hurt anybody? Is creating a BIGTIFF maybe not preferable because of technical or user limitations?

Thanks for any pointers, or feel free to add it to the issue above.

Regards,

Richard Duivenvoorde

From even.rouault at spatialys.com  Wed Oct 12 03:36:02 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Oct 2022 12:36:02 +0200
Subject: [gdal-dev] Does it hurt to *always* use BIGTIFF when using
 gdal_translate
In-Reply-To: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
References: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
Message-ID: <543ec494-a147-90e1-f0ca-eabb586b3d19@spatialys.com>

Richard,

BigTIFF doesn't have a formal status like classic TIFF, so its adoption 
might be lower by non-libtiff-4.0-or-later based software, in 
particularly outdated proprietary software.

BIGTIFF=IF_SAFER could be a reasonable compromise (BIGTIFF=IF_NEEDED is 
the default behaviour, but not super appropriate when compression is used)

Even

Le 12/10/2022 ? 11:51, Richard Duivenvoorde a ?crit?:
> Hi Devs,
>
> In QGIS we have a GUI for gdal_translate, the "Georeferencer".
>
> It was reported that when Georeferencing huge Tiffs (user was talking 
> about 8GB), that QGIS ended up with a broken 3.99GB Tiff, see 
> https://github.com/qgis/QGIS/issues/47362
>
> One of the 'easy' solutions (on QGIS side) would be to *always* add 
> the BIGTIFF=yes option.
>
> Question to you: would that hurt anybody? Is creating a BIGTIFF maybe 
> not preferable because of technical or user limitations?
>
> Thanks for any pointers, or feel free to add it to the issue above.
>
> Regards,
>
> Richard Duivenvoorde
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andreaerdna at libero.it  Wed Oct 12 04:47:58 2022
From: andreaerdna at libero.it (Andrea Giudiceandrea)
Date: Wed, 12 Oct 2022 13:47:58 +0200
Subject: [gdal-dev] Does it hurt to *always* use BIGTIFF when using
 gdal_translate
In-Reply-To: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
References: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
Message-ID: <72dd75c2-e62a-2b06-d24e-61294f5f3f73@libero.it>

Il 12/10/2022 11:51, Richard Duivenvoorde ha scritto:
> One of the 'easy' solutions (on QGIS side) would be to *always* add 
> the BIGTIFF=yes option.

Hi all,
while there are also the IF_NEEDED and IF_SAFER values for the BIGTIFF 
creation option, another possibility would be to have an option to let 
GDAL to retry to create the raster file as a BIGTIFF if the the normal 
TIFF creation fails or to let QGIS to inform the user if the normal TIFF 
creation fails and then offer the possibility to retry using the 
BIGTIFF=YES option.

Regards.

Andrea

From thomas.bonfort at gmail.com  Wed Oct 12 12:03:30 2022
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Wed, 12 Oct 2022 21:03:30 +0200
Subject: [gdal-dev] Does it hurt to *always* use BIGTIFF when using
 gdal_translate
In-Reply-To: <72dd75c2-e62a-2b06-d24e-61294f5f3f73@libero.it>
References: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
 <72dd75c2-e62a-2b06-d24e-61294f5f3f73@libero.it>
Message-ID: <CAOM3y2ihX9SX8VpOm7RsgJySzQZ+=crhkhH6wHSZvL+8MnjF1Q@mail.gmail.com>

this is one of the reasons we built https://github.com/airbusgeo/cogger
(supposing you are creating a tiled tif): first create your tif with your
usual gdal tooling , unconditionally setting bigtiff=yes, and then as a
postprocessing step run cogger on the resulting file. You'll get a COG
which depending on the final output size will be bigtiff if really needed
or a standard tiff if not.

regards,
thomas

Le mer. 12 oct. 2022, 13:59, Andrea Giudiceandrea via gdal-dev <
gdal-dev at lists.osgeo.org> a ?crit :

> Il 12/10/2022 11:51, Richard Duivenvoorde ha scritto:
> > One of the 'easy' solutions (on QGIS side) would be to *always* add
> > the BIGTIFF=yes option.
>
> Hi all,
> while there are also the IF_NEEDED and IF_SAFER values for the BIGTIFF
> creation option, another possibility would be to have an option to let
> GDAL to retry to create the raster file as a BIGTIFF if the the normal
> TIFF creation fails or to let QGIS to inform the user if the normal TIFF
> creation fails and then offer the possibility to retry using the
> BIGTIFF=YES option.
>
> Regards.
>
> Andrea
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221012/b942129a/attachment.htm>

From schwehr at gmail.com  Wed Oct 12 12:37:33 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 12 Oct 2022 12:37:33 -0700
Subject: [gdal-dev] Does it hurt to *always* use BIGTIFF when using
 gdal_translate
In-Reply-To: <CAOM3y2ihX9SX8VpOm7RsgJySzQZ+=crhkhH6wHSZvL+8MnjF1Q@mail.gmail.com>
References: <0db66d49-1834-b80b-d90c-672d3fa48c08@duif.net>
 <72dd75c2-e62a-2b06-d24e-61294f5f3f73@libero.it>
 <CAOM3y2ihX9SX8VpOm7RsgJySzQZ+=crhkhH6wHSZvL+8MnjF1Q@mail.gmail.com>
Message-ID: <CACmBxyst7-BEakemKABEHEMgw99qx-o=nk1VxPyfTm3115tX2w@mail.gmail.com>

I keep trying to find if anyone has examples for tools that still don't
understand bigtiff, but haven't found anything that has a release in the
last 5 years that can't handle BIGTIFF.  I can't remember where I've asked
before, but I'm asking again on twitter...

https://twitter.com/kurtschwehr/status/1580281226157445120

On Wed, Oct 12, 2022 at 12:17 PM thomas bonfort <thomas.bonfort at gmail.com>
wrote:

> this is one of the reasons we built https://github.com/airbusgeo/cogger
> (supposing you are creating a tiled tif): first create your tif with your
> usual gdal tooling , unconditionally setting bigtiff=yes, and then as a
> postprocessing step run cogger on the resulting file. You'll get a COG
> which depending on the final output size will be bigtiff if really needed
> or a standard tiff if not.
>
> regards,
> thomas
>
> Le mer. 12 oct. 2022, 13:59, Andrea Giudiceandrea via gdal-dev <
> gdal-dev at lists.osgeo.org> a ?crit :
>
>> Il 12/10/2022 11:51, Richard Duivenvoorde ha scritto:
>> > One of the 'easy' solutions (on QGIS side) would be to *always* add
>> > the BIGTIFF=yes option.
>>
>> Hi all,
>> while there are also the IF_NEEDED and IF_SAFER values for the BIGTIFF
>> creation option, another possibility would be to have an option to let
>> GDAL to retry to create the raster file as a BIGTIFF if the the normal
>> TIFF creation fails or to let QGIS to inform the user if the normal TIFF
>> creation fails and then offer the possibility to retry using the
>> BIGTIFF=YES option.
>>
>> Regards.
>>
>> Andrea
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221012/6f2b8d4c/attachment.htm>

From alexandre.gacon at gmail.com  Thu Oct 13 01:13:29 2022
From: alexandre.gacon at gmail.com (Alexandre Gacon)
Date: Thu, 13 Oct 2022 10:13:29 +0200
Subject: [gdal-dev] ogr2ogr preserve fid behavior
Message-ID: <CAFJaAp6=SVO90PPWqEboMng2Fekd28N8tFgpixWK_pivZFxq_Q@mail.gmail.com>

Hello,

I am trying to upload some data from SHP to Postgres. I would like to use a
given column of my SHP as primary key in replacement of the id generated by
ogr2ogr but I don't manage to have the result I want.

I used the options -preserve_fid and --config PGSQL_OGR_FID id which gave
the following output: I have a column "id" as primary key but it does not
contain the value of my SHP but an auto increment value.

The SHP is not used directly but I do some computations and name changes
using a sql statement with the sqlite dialect.

Any idea on how I could have directly my "id" column as primary key with
the values of my input ?

-- 
Alexandre Gacon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221013/ea9a0eee/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 13 01:27:58 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 13 Oct 2022 08:27:58 +0000
Subject: [gdal-dev] ogr2ogr preserve fid behavior
In-Reply-To: <CAFJaAp6=SVO90PPWqEboMng2Fekd28N8tFgpixWK_pivZFxq_Q@mail.gmail.com>
References: <CAFJaAp6=SVO90PPWqEboMng2Fekd28N8tFgpixWK_pivZFxq_Q@mail.gmail.com>
Message-ID: <AM0PR09MB32194AA16F9F0F8E215266ABFD259@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I think that shapefile does not have a proper fid to preserve. I am remembering that I have used the -sql option sometimes for controlling the FID, something like -sql ?SELECT geometry, id AS FID, attribute_1, attribute_2 ? FROM ??

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Alexandre Gacon
L?hetetty: torstai 13. lokakuuta 2022 11.13
Vastaanottaja: gdal-dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] ogr2ogr preserve fid behavior

Hello,

I am trying to upload some data from SHP to Postgres. I would like to use a given column of my SHP as primary key in replacement of the id generated by ogr2ogr but I don't manage to have the result I want.

I used the options -preserve_fid and --config PGSQL_OGR_FID id which gave the following output: I have a column "id" as primary key but it does not contain the value of my SHP but an auto increment value.

The SHP is not used directly but I do some computations and name changes using a sql statement with the sqlite dialect.

Any idea on how I could have directly my "id" column as primary key with the values of my input ?

--
Alexandre Gacon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221013/97fd85d2/attachment-0001.htm>

From Christian.Brock at amdocs.com  Thu Oct 13 02:58:39 2022
From: Christian.Brock at amdocs.com (Christian Brock)
Date: Thu, 13 Oct 2022 09:58:39 +0000
Subject: [gdal-dev] four threads are huh,
 five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0
In-Reply-To: <4c453c04-0348-6da6-4ca4-0f1c2bb56f77@spatialys.com>
References: <AM8PR06MB7619D56BF9C1076BDE1EACBD8A239@AM8PR06MB7619.eurprd06.prod.outlook.com>
 <c6d5688e-2f41-ba0e-f215-76a72dba0f0e@spatialys.com>
 <AM8PR06MB761918DFD63CF0004427E8F58A229@AM8PR06MB7619.eurprd06.prod.outlook.com>
 <4c453c04-0348-6da6-4ca4-0f1c2bb56f77@spatialys.com>
Message-ID: <AM8PR06MB761937B857CB4270B3667CAD8A259@AM8PR06MB7619.eurprd06.prod.outlook.com>

Thanks, I made a workaround using Java's ThreadLocal and it works ?

-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 
Sent: Wednesday, October 12, 2022 10:31
To: Christian Brock <Christian.Brock at amdocs.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] four threads are huh, five are buh? Regressions w/ GDAL 3.5.2/PROJ_9.1.0

CAUTION: This email is from an external source. Please do not open any unknown links or attachments.

Le 12/10/2022 ? 08:59, Christian Brock a ?crit?:
> Hi Even,
>
> Thanks for the fast answer.
>
> We do not share any gdal datasets, BUT we share all spatial references and all coordinate transformations between threads. It used to work in the past, hmm ...
>
> I assume this is a problem?

yes, this was never guaranteed to be safe, even if it was mostly in practice before PROJ 6. But with PROJ >= 6, you can't use the same SpatialReference or CoordinateTranfsormation concurrently from several threads, even for read-only operations, since some internal state might be changed.

Even

>
> Cheers --Chr.
>
> -----Original Message-----
> From: Even Rouault <even.rouault at spatialys.com>
>
> Christian,
>
> I suspect the issue is not that much jumping from 4 to 5 threads, but some latent issue in your code or in GDAL/PROJ that becomes more visible. First thing to check: are you sure you are not using a given GDAL / OGR object simultaneously in more than one thread ?
>
> If that's not the issue, if you want effective help, I'm afraid you'll 
> have to go through the effort of writing a minimal standalone 
> reproducer
> (code+data) that you can share with us.
>
> Even
>
> Le 11/10/2022 ? 14:56, Christian Brock via gdal-dev a ?crit?:
>> I have some special issue and would be glad for suggestions.
>>
>> We run complex regression tests using environmental files -- too 
>> complex for a bug report ;-(
>>
>> Moving from GDAL_2.4.2/PROJ_5.2.0 to GDAL 3.5.2/PROJ_9.1.0 we run into regressions.
>>
>> The most stunning observation is that the issue only occurs when USING MORE THAN FOUR THREADS!
>> Can anyone think of something that is true with five or more threads but not below?
>>
>> Besides this I should mention, that we use Java bindings
>>
>> The issue is
>> - file format independent,
>> - were observed on ubuntu 20.04 and 22.04,
>> - affects a sample with the following coordinate system:
>> PROJCS["Transverse Mercator",GEOGCS["Potsdam_IST_V2_0",DATUM["Potsdam_IST_V2_0",SPHEROID["Bessel",6377397.155,299.152813106079],TOWGS84[583,68,399.5,0,0,1.36E-05,1.13E-05]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]"
>> - WGS84 and all UTM systems are good.
>>
>> I should also mention, that this issue affects only the second sample, when I run more than one sample with the PROJCS above.
>> When I change the sample order, it is the second sample again!
>>
>> And as a final point, there are random memory corruptions every couple of hours.
>>
>> So again, please step forward when you know of anything inside GDAL, PROJ or Java bindings that cares about the number of threads.
>>
>> Many thanks
>> --Chr.
>>
>>
>>
>> This email and the information contained herein is proprietary and 
>> confidential and subject to the Amdocs Email Terms of Service, which 
>> you may review at https://www.amdocs.com/about/email-terms-of-service
>> <https://www.amdocs.com/about/email-terms-of-service>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://eur01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flis
>> t 
>> s.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7CChrist
>> i
>> an.Brock%40amdocs.com%7C2ed3fa7f029246255d3808daab8a13c3%7Cc8eca3ca12
>> 7 
>> 646d59d9da0f2a028920f%7C0%7C0%7C638010906883663070%7CUnknown%7CTWFpbG
>> Z
>> sb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%
>> 3
>> D%7C3000%7C%7C%7C&amp;sdata=nOmLEy8X%2FU%2FMlSh1PPvvwRFsYH17H%2F8Fpm1
>> 7
>> EWPtx5U%3D&amp;reserved=0
> --
> https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.s
> patialys.com%2F&amp;data=05%7C01%7CChristian.Brock%40amdocs.com%7C8383
> ff98852c4c5b087c08daac2c2fa3%7Cc8eca3ca127646d59d9da0f2a028920f%7C0%7C
> 0%7C638011603036795920%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJ
> QIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=
> aRs8p7jleiUviFpxeNSI1KmIx21Ig0QrbEt%2Bs6QiY08%3D&amp;reserved=0
> My software is free, but my time generally not.
>
> This email and the information contained herein is proprietary and 
> confidential and subject to the Amdocs Email Terms of Service, which 
> you may review at https://www.amdocs.com/about/email-terms-of-service 
> <https://www.amdocs.com/about/email-terms-of-service>
>
--
https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7CChristian.Brock%40amdocs.com%7C8383ff98852c4c5b087c08daac2c2fa3%7Cc8eca3ca127646d59d9da0f2a028920f%7C0%7C0%7C638011603036795920%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=aRs8p7jleiUviFpxeNSI1KmIx21Ig0QrbEt%2Bs6QiY08%3D&amp;reserved=0
My software is free, but my time generally not.

This email and the information contained herein is proprietary and confidential and subject to the Amdocs Email Terms of Service, which you may review at https://www.amdocs.com/about/email-terms-of-service <https://www.amdocs.com/about/email-terms-of-service>

From lists at home.gofferje.net  Fri Oct 14 00:48:05 2022
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Fri, 14 Oct 2022 10:48:05 +0300
Subject: [gdal-dev] Create tile index by time?
Message-ID: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>

Morning all!

I have a little hobby project where I pull Sentinel imagery of my town's 
area and create various composites. I run that every morning, so I have 
a bunch of raster images which represent the same geographic area at 
different times. I recently also started playing with mapserver and I 
would like to set up a mapserver to serve those images. I know mapserver 
basics, have my first mapserver up and running.

What I'm looking for now is how to create a tile index for a bunch of 
images which includes the times of those images, so I can server them 
from mapserver as a layer with a time dimension.

Any pointers, tutorials, "RTFMs" (with links) would be very much 
appreciated!

-Stefan


-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From johannespaul92 at gmail.com  Fri Oct 14 00:51:32 2022
From: johannespaul92 at gmail.com (Johannes Paul)
Date: Fri, 14 Oct 2022 09:51:32 +0200
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
Message-ID: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>

Hello,
Is there a way to get the OGRGeometry object out of a GDALDataset object in
c++?
My GDALDataset is a raster and i would like to get the associated
OGRPolygon out of it.
I've used:
srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
However i keep getting segmentation faults error.
Any help would be appreciated.
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/fc22b12a/attachment.htm>

From lnicola at dend.ro  Fri Oct 14 00:55:07 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Fri, 14 Oct 2022 10:55:07 +0300
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
In-Reply-To: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
References: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
Message-ID: <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>

Hi Mats,

Vector and raster datasets are pretty much different things in GDAL. And generally it would be a good idea to check whether e.g. GetLayer actually returns a pointer or nullptr.

What exactly do you mean by "associated OGRPolygon"? Do you want a polygon with the same footprint as the raster?

Laurentiu

On Fri, Oct 14, 2022, at 10:51, Johannes Paul wrote:
> Hello,
> Is there a way to get the OGRGeometry object out of a GDALDataset object in c++?
> My GDALDataset is a raster and i would like to get the associated OGRPolygon out of it.
> I've used:
> srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
> However i keep getting segmentation faults error.
> Any help would be appreciated.
> Thanks
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/2d3d535c/attachment.htm>

From johannespaul92 at gmail.com  Fri Oct 14 01:03:54 2022
From: johannespaul92 at gmail.com (Johannes Paul)
Date: Fri, 14 Oct 2022 10:03:54 +0200
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
In-Reply-To: <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
References: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
 <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
Message-ID: <CACcmK9Zc4sRavVFwtsJqAh5_4umOJrJzGyAmhT4SX1BrO0aMjg@mail.gmail.com>

Hello,
Yes i would need a polygon with the raster footprint.
Thanks


Le ven. 14 oct. 2022 ? 10:01, Lauren?iu Nicola via gdal-dev <
gdal-dev at lists.osgeo.org> a ?crit :

> Hi Mats,
>
> Vector and raster datasets are pretty much different things in GDAL. And
> generally it would be a good idea to check whether e.g. GetLayer actually
> returns a pointer or nullptr.
>
> What exactly do you mean by "associated OGRPolygon"? Do you want a polygon
> with the same footprint as the raster?
>
> Laurentiu
>
> On Fri, Oct 14, 2022, at 10:51, Johannes Paul wrote:
>
> Hello,
> Is there a way to get the OGRGeometry object out of a GDALDataset object
> in c++?
> My GDALDataset is a raster and i would like to get the associated
> OGRPolygon out of it.
> I've used:
> srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
> However i keep getting segmentation faults error.
> Any help would be appreciated.
> Thanks
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/3b17fda6/attachment.htm>

From lnicola at dend.ro  Fri Oct 14 00:56:07 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Fri, 14 Oct 2022 10:56:07 +0300
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
In-Reply-To: <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
References: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
 <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
Message-ID: <fe307747-8f02-4748-9626-064716ed97fe@betaapp.fastmail.com>

PS: Sorry Johannes for getting your name wrong, my email client has a fun little bug.

On Fri, Oct 14, 2022, at 10:55, Lauren?iu Nicola wrote:
> Hi Mats,
> 
> Vector and raster datasets are pretty much different things in GDAL. And generally it would be a good idea to check whether e.g. GetLayer actually returns a pointer or nullptr.
> 
> What exactly do you mean by "associated OGRPolygon"? Do you want a polygon with the same footprint as the raster?
> 
> Laurentiu
> 
> On Fri, Oct 14, 2022, at 10:51, Johannes Paul wrote:
>> Hello,
>> Is there a way to get the OGRGeometry object out of a GDALDataset object in c++?
>> My GDALDataset is a raster and i would like to get the associated OGRPolygon out of it.
>> I've used:
>> srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
>> However i keep getting segmentation faults error.
>> Any help would be appreciated.
>> Thanks
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> 
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/8420c690/attachment.htm>

From lnicola at dend.ro  Fri Oct 14 01:09:44 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Fri, 14 Oct 2022 11:09:44 +0300
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
In-Reply-To: <CACcmK9Zc4sRavVFwtsJqAh5_4umOJrJzGyAmhT4SX1BrO0aMjg@mail.gmail.com>
References: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
 <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
 <CACcmK9Zc4sRavVFwtsJqAh5_4umOJrJzGyAmhT4SX1BrO0aMjg@mail.gmail.com>
Message-ID: <4901516d-41fe-4c4b-83c6-a23ed467423a@betaapp.fastmail.com>

In that case you need to create it manually. There's an example here, using Python, but the API is pretty similar: https://pcjericks.github.io/py-gdalogr-cookbook/geometry.html#create-a-polygon. Remember to close it by duplicating the first vertex.

To get the footprint itself, you'll need to look at the GeoTransform of the raster and its dimensions. https://gdal.org/tutorials/geotransforms_tut.html has more details. Basically, one corner of the footprint is in GT(0) and GT(3), and to get the other four you'll need to translate that point by the spacing in each direction multiplied by the number of pixels. Most images won't be using the rotation parameters.

Laurentiu

On Fri, Oct 14, 2022, at 11:03, Johannes Paul wrote:
> Hello,
> Yes i would need a polygon with the raster footprint.
> Thanks
> 
> 
> Le ven. 14 oct. 2022 ? 10:01, Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org> a ?crit :
>> __
>> Hi Mats,
>> 
>> Vector and raster datasets are pretty much different things in GDAL. And generally it would be a good idea to check whether e.g. GetLayer actually returns a pointer or nullptr.
>> 
>> What exactly do you mean by "associated OGRPolygon"? Do you want a polygon with the same footprint as the raster?
>> 
>> Laurentiu
>> 
>> On Fri, Oct 14, 2022, at 10:51, Johannes Paul wrote:
>>> Hello,
>>> Is there a way to get the OGRGeometry object out of a GDALDataset object in c++?
>>> My GDALDataset is a raster and i would like to get the associated OGRPolygon out of it.
>>> I've used:
>>> srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
>>> However i keep getting segmentation faults error.
>>> Any help would be appreciated.
>>> Thanks
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/f2756ad4/attachment-0001.htm>

From alexandre.gacon at gmail.com  Fri Oct 14 02:13:05 2022
From: alexandre.gacon at gmail.com (Alexandre Gacon)
Date: Fri, 14 Oct 2022 11:13:05 +0200
Subject: [gdal-dev] ogr2ogr preserve fid behavior
In-Reply-To: <AM0PR09MB32194AA16F9F0F8E215266ABFD259@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <CAFJaAp6=SVO90PPWqEboMng2Fekd28N8tFgpixWK_pivZFxq_Q@mail.gmail.com>
 <AM0PR09MB32194AA16F9F0F8E215266ABFD259@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <CAFJaAp4q3XNJcfoCDeVdNX=+dji=VJ0yd0=7kB=-5Ynmk5ofQA@mail.gmail.com>

Hi

I managed to get the expected result by removing the options -preserve_fid
and --config PGSQL_OGR_FID id and by using an existing table set correctly
with the right column as primary key.

Alexandre

Le jeu. 13 oct. 2022 ? 10:28, Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> a ?crit :

> Hi,
>
>
>
> I think that shapefile does not have a proper fid to preserve. I am
> remembering that I have used the -sql option sometimes for controlling the
> FID, something like -sql ?SELECT geometry, id AS FID, attribute_1,
> attribute_2 ? FROM ??
>
>
>
> -Jukka Rahkonen-
>
>
>
> *L?hett?j?:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *Puolesta *Alexandre
> Gacon
> *L?hetetty:* torstai 13. lokakuuta 2022 11.13
> *Vastaanottaja:* gdal-dev <gdal-dev at lists.osgeo.org>
> *Aihe:* [gdal-dev] ogr2ogr preserve fid behavior
>
>
>
> Hello,
>
>
>
> I am trying to upload some data from SHP to Postgres. I would like to use
> a given column of my SHP as primary key in replacement of the id generated
> by ogr2ogr but I don't manage to have the result I want.
>
>
>
> I used the options -preserve_fid and --config PGSQL_OGR_FID id which gave
> the following output: I have a column "id" as primary key but it does not
> contain the value of my SHP but an auto increment value.
>
>
>
> The SHP is not used directly but I do some computations and name changes
> using a sql statement with the sqlite dialect.
>
>
>
> Any idea on how I could have directly my "id" column as primary key with
> the values of my input ?
>
>
> --
>
> Alexandre Gacon
>


-- 
Alexandre Gacon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/e7e3e840/attachment.htm>

From andrew at aitchison.me.uk  Fri Oct 14 02:34:16 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 14 Oct 2022 10:34:16 +0100 (BST)
Subject: [gdal-dev] C++ Getting OGRGeometry out of GDALDataset
In-Reply-To: <CACcmK9Zc4sRavVFwtsJqAh5_4umOJrJzGyAmhT4SX1BrO0aMjg@mail.gmail.com>
References: <CACcmK9YMaO46mBK1R301ZZevVoBihZz6Zogt9K8a-Koh9QpQ3A@mail.gmail.com>
 <643176f7-32d9-43c4-b411-0aca18f10003@betaapp.fastmail.com>
 <CACcmK9Zc4sRavVFwtsJqAh5_4umOJrJzGyAmhT4SX1BrO0aMjg@mail.gmail.com>
Message-ID: <7eae4b32-7cf-3dc1-58c0-99e709ad49@aitchison.me.uk>

On Fri, 14 Oct 2022, Johannes Paul wrote:

> Hello,
> Yes i would need a polygon with the raster footprint.

apps/gdaltindex.cpp implements the gdaltindex application
and is written in C++, so should do what you wish.

Note that this assumes the raster geolocation is given by the affine 
transformation GDALDataset::GetGeoTransform(), which is usually true.
Howver, if the raster geolocation is given by one of the other methods in
https://gdal.org/user/raster_data_model.html (GCPs and/or RPCs)
you may have to do the work yourself.


> Le ven. 14 oct. 2022 ? 10:01, Lauren?iu Nicola via gdal-dev <
> gdal-dev at lists.osgeo.org> a ?crit :
>
>> Hi Mats,
>>
>> Vector and raster datasets are pretty much different things in GDAL. And
>> generally it would be a good idea to check whether e.g. GetLayer actually
>> returns a pointer or nullptr.
>>
>> What exactly do you mean by "associated OGRPolygon"? Do you want a polygon
>> with the same footprint as the raster?
>>
>> Laurentiu
>>
>> On Fri, Oct 14, 2022, at 10:51, Johannes Paul wrote:
>>
>> Hello,
>> Is there a way to get the OGRGeometry object out of a GDALDataset object
>> in c++?
>> My GDALDataset is a raster and i would like to get the associated
>> OGRPolygon out of it.
>> I've used:
>> srcDataset->GetLayer(0)->GetNextFeature()->GetGeometryRef()->toPolygon()
>> However i keep getting segmentation faults error.
>> Any help would be appreciated.
>> Thanks

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From knudsen.thomas at gmail.com  Fri Oct 14 02:52:56 2022
From: knudsen.thomas at gmail.com (Thomas Knudsen)
Date: Fri, 14 Oct 2022 11:52:56 +0200
Subject: [gdal-dev] Create tile index by time?
In-Reply-To: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>
References: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>
Message-ID: <CAH0YoEN0GKm3xQV-yB7JLFsqWn5LmBJmqsc66CB-5BDiuef6wA@mail.gmail.com>

Sounds like a STAC related task to me - https://stacspec.org/en

Den fre. 14. okt. 2022 kl. 09.49 skrev Stefan Gofferje <
lists at home.gofferje.net>:

> Morning all!
>
> I have a little hobby project where I pull Sentinel imagery of my town's
> area and create various composites. I run that every morning, so I have
> a bunch of raster images which represent the same geographic area at
> different times. I recently also started playing with mapserver and I
> would like to set up a mapserver to serve those images. I know mapserver
> basics, have my first mapserver up and running.
>
> What I'm looking for now is how to create a tile index for a bunch of
> images which includes the times of those images, so I can server them
> from mapserver as a layer with a time dimension.
>
> Any pointers, tutorials, "RTFMs" (with links) would be very much
> appreciated!
>
> -Stefan
>
>
> --
>   (o_   Stefan Gofferje            | SCLT, MCP, CCSA
>   //\   Reg'd Linux User #247167   | VCP #2263
>   V_/_  https://www.gofferje.net   | https://www.saakeskus.fi
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/c82ba428/attachment.htm>

From lists at home.gofferje.net  Fri Oct 14 04:00:12 2022
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Fri, 14 Oct 2022 14:00:12 +0300
Subject: [gdal-dev] Create tile index by time?
In-Reply-To: <CAH0YoEN0GKm3xQV-yB7JLFsqWn5LmBJmqsc66CB-5BDiuef6wA@mail.gmail.com>
References: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>
 <CAH0YoEN0GKm3xQV-yB7JLFsqWn5LmBJmqsc66CB-5BDiuef6wA@mail.gmail.com>
Message-ID: <a8fa367a-ac59-0634-4f39-5f31e9d30933@home.gofferje.net>

Hi,

On 10/14/22 12:52, Thomas Knudsen wrote:
> Sounds like a STAC related task to me - https://stacspec.org/en 
> <https://stacspec.org/en>

after having a quick look, I have to say that I didn't understand 
anything about that STAC thingy. Not sure how that is supposed to help me.

I need to create a shape file as a tile index for mapserver which 
contains the time dimension value for each map instead of the geometric 
dimensions.

Like gdaltindex, just for time instead location.

-Stefan

-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From diogo at photopills.com  Fri Oct 14 04:39:35 2022
From: diogo at photopills.com (Diogo)
Date: Fri, 14 Oct 2022 13:39:35 +0200
Subject: [gdal-dev] Transformations with same horizontal datum but different
 geoid outputs the same Z value
Message-ID: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>

Hello everyone!

I'm merging multiple elevation datasets from different countries and I
would like to re-project all into the same coordinates system, 4326+3855
using gdalwarp. I'm using `gdaltransform` to confirm that there is in fact
a conversion from the original projection to the aspected one. However, for
some datasets, there is only conversion in the XY axis, while the Z output
is the same as the input.

Below there are some examples (the geoid code is extracted from the dataset
documentation)

Genoa 1942 height (Italy)

$ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
-s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
4195591.29690422 3357

N2000 (Finland)

$ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
6931460.32557422 269

EVRF2007 (Estonia)

$ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
--debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
682284.606829111 6401087.4159131 318


I don't have much experience with the projections and I'm a bit lost
to understand the possible issues, or interpreted the Z output. What
can be the possible issues?

Any help would be appreciated.

Best regards,

Diogo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221014/d034966d/attachment-0001.htm>

From andrew at aitchison.me.uk  Fri Oct 14 06:57:55 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 14 Oct 2022 14:57:55 +0100 (BST)
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
Message-ID: <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>

On Fri, 14 Oct 2022, Diogo wrote:

> Hello everyone!
>
> I'm merging multiple elevation datasets from different countries and I
> would like to re-project all into the same coordinates system, 4326+3855
> using gdalwarp. I'm using `gdaltransform` to confirm that there is in fact
> a conversion from the original projection to the aspected one. However, for
> some datasets, there is only conversion in the XY axis, while the Z output
> is the same as the input.

Is there a good reason to start with these particular datasets ?

There are international bodies who have produced elevation datasets covering the whole of 
Europe, eg
https://land.copernicus.eu/user-corner/how-to-access-our-data
https://www.eea.europa.eu/data-and-maps/data#c0=5&c11=&c5=all&b_start=0&c12=elevation
https://www.eea.europa.eu/data-and-maps/data/copernicus-land-monitoring-service-eu-dem

which would save you trying to stitch together data in different CRSes.

> Below there are some examples (the geoid code is extracted from the dataset
> documentation)
>
> Genoa 1942 height (Italy)
>
> $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
> -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
> 4195591.29690422 3357
>
> N2000 (Finland)
>
> $ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
> on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
> 6931460.32557422 269
>
> EVRF2007 (Estonia)
>
> $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
> --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
> 682284.606829111 6401087.4159131 318
>
>
> I don't have much experience with the projections and I'm a bit lost
> to understand the possible issues, or interpreted the Z output. What
> can be the possible issues?
>
> Any help would be appreciated.
>
> Best regards,
>
> Diogo
>

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From lists at home.gofferje.net  Sat Oct 15 00:33:04 2022
From: lists at home.gofferje.net (Stefan Gofferje)
Date: Sat, 15 Oct 2022 10:33:04 +0300
Subject: [gdal-dev] Create tile index by time? (Solution)
In-Reply-To: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>
References: <748a274e-e72f-1763-6829-3c14d4fa7b5b@home.gofferje.net>
Message-ID: <f49fed58-ae85-c15f-7e73-3ce56e043295@home.gofferje.net>

On 10/14/22 10:48, Stefan Gofferje wrote:
> I have a little hobby project where I pull Sentinel imagery of my town's 
> area and create various composites. I run that every morning, so I have 
> a bunch of raster images which represent the same geographic area at 
> different times. I recently also started playing with mapserver and I 
> would like to set up a mapserver to serve those images. I know mapserver 
> basics, have my first mapserver up and running.
> 
> What I'm looking for now is how to create a tile index for a bunch of 
> images which includes the times of those images, so I can server them 
> from mapserver as a layer with a time dimension.

In case it is of use for anybody, here is the solution I came up with 
last night:

1.) Add a time index metadatum to the output file 
(gdaltranslate/gdal_edit -mo TIMEINDEX="yyyy-mm-ddThhmmZ"
2.) Hack together a Python script:

#!/usr/bin/python3

import os, sys
from osgeo import gdal
import geopandas as gpd
from shapely.geometry import box

import warnings
warnings.filterwarnings("ignore")

StartDir = str(sys.argv[1])

def getBounds(path):
     raster = gdal.Open(path)
     ulx, xres, xskew, uly, yskew, yres = raster.GetGeoTransform()
     lrx = ulx + (raster.RasterXSize * xres)
     lry = uly + (raster.RasterYSize * yres)
     return box(lrx, lry, ulx, uly)


df = gpd.GeoDataFrame(columns=['location', 'geometry','timestamp'])
for dir, subdir, files in os.walk(StartDir):
     for fname in files:
         if fname.endswith(".tif"):
             fullname = os.path.join(dir+"/", fname)
             print (fullname)
             ds=gdal.Open(fullname)
             metadata=ds.GetMetadata()
             ds=None
             print(metadata)
             df = df.append({'location': fname, 'geometry': 
getBounds(fullname),'timestamp': metadata['TIMESTAMP']}, ignore_index=True)
#            df = gpd.pd.concat(df,{'location': fname, 'geometry': 
getBounds(os.path.join(dir+"/", fname))}, ignore_index=True)

df.to_file("tile-index.shp")


NOTE: suppressing all warnings is temporary until I figured out how to 
move from df.append to pd.concat.

-Stefan


-- 
  (o_   Stefan Gofferje            | SCLT, MCP, CCSA
  //\   Reg'd Linux User #247167   | VCP #2263
  V_/_  https://www.gofferje.net   | https://www.saakeskus.fi


From pssmaniam at hotmail.com  Sat Oct 15 02:50:03 2022
From: pssmaniam at hotmail.com (Sundaram Subramaniam)
Date: Sat, 15 Oct 2022 09:50:03 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 221, Issue 1
In-Reply-To: <mailman.5.1664823601.2413.gdal-dev@lists.osgeo.org>
References: <mailman.5.1664823601.2413.gdal-dev@lists.osgeo.org>
Message-ID: <SEZPR03MB652189BE0C9A06C23944D3CEB8279@SEZPR03MB6521.apcprd03.prod.outlook.com>


________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of gdal-dev-request at lists.osgeo.org <gdal-dev-request at lists.osgeo.org>
Sent: Tuesday, October 4, 2022 12:30 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: gdal-dev Digest, Vol 221, Issue 1

Send gdal-dev mailing list submissions to
        gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
        gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
        gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. ECRG RasterIO problem (mchapman at hyperacktive.com)
   2. How to obtain the raster footprint poly of actual data with
      python (gdisk.mike)


----------------------------------------------------------------------

Message: 1
Date: Mon, 3 Oct 2022 11:05:48 -0600
From: <mchapman at hyperacktive.com>
To: <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] ECRG RasterIO problem
Message-ID: <00b701d8d74a$62942f60$27bc8e20$@hyperacktive.com>
Content-Type: text/plain; charset="us-ascii"

All,



I have an ECRG dataset that fails when reading pixels from the
gdalrasterband object on one of the subdatasets.  It appears that the
underlying proxy dataset has a macro check called
RB_PROXY_METHOD_WITH_RET_WITH_INIT_BLOCK that fails because the block sizes
are different.  This happens for all the ECRG subdatasets that I read from,
in other words it's not just specific to a single dataset.  FYI, the same
code works fine for RPFTOC datasets and all other GDAL formats.  I am using
GDAL version 3.4.2.

// code snippet from gdalproxydataset.cpp line 247
else if( nSrcBlockXSize != nBlockXSize || nSrcBlockYSize != nBlockYSize) \
{ \
        CPLError(CE_Failure, CPLE_AppDefined, "Inconsistent block dimensions
between proxy and source"); \
        ret = CE_Failure; \
} \

The variables nBlockXSize and nBlockYSize are (2304, 1) and nSrcBlockXSize
and nSrcBlockYSize are {128, 128).

I think this is because the ECRG frame size is 2304 x 2304 but the block
size of the frame file is 128 x 128.

Does anybody know what my problem might be or is this an error in the driver
code?

Best regards,
Martin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221003/a36eceb1/attachment-0001.htm>

------------------------------

Message: 2
Date: Mon, 3 Oct 2022 11:20:05 -0600
From: "gdisk.mike" <gdisk.mike at gmail.com>
To: Gdal Dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] How to obtain the raster footprint poly of actual
        data with python
Message-ID:
        <CAKTSvBjS-FjZqi8p2_wgWR+YX-OFphQt2-4gbWp-Q6pKgQAPGw at mail.gmail.com>
Content-Type: text/plain; charset="utf-8"

To get the result using command line, I found the 3 commands did the trick.

gdal_translate -b mask -of vrt -a_nodata 0 'path/to/input.tif' test.vrt
gdal_translate -b 1 -of vrt -a_nodata 0 test.vrt test2.vrt
gdal_polygonize.[bat/py] -q  -8 test2.vrt -b 1 -f "ESRI Shapefile"
testdata.shp

This was off Stack exchange somewhere.

However, I'd like to get this same geometry in python.

I keep hitting roadblocks as I'm not real sure how to use
gdal.Translate or gdal.TranslateOptions

ive tried
gtp = gdal.TranslateOptions(format="vrt",bandList="mask", noData=0)
in attempt to start with the first gdal_translate command.

I'm also curious if there's another way, perhaps using --oo or something
different.

In the end I'd ultimately like to get a geometry poly object of where the
actual imagery data is in the file.

Any pointers?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221003/2147d699/attachment-0001.htm>

------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 221, Issue 1
****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221015/1433db14/attachment.htm>

From andrew at aitchison.me.uk  Sun Oct 16 01:26:34 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 16 Oct 2022 09:26:34 +0100 (BST)
Subject: [gdal-dev] PVS-Studio "missing move constructor" warnings ?
Message-ID: <8f8f99c7-d4d9-601b-c44e-881df2b8d3@aitchison.me.uk>


When I run the PVS-Studio static analyzer https://pvs-studio.com/
on my driver plugin I get two warnings on cpl code:

PVS-Studio Analysis Results

    Date: Sun Oct 16 09:12:51 2022
    PVS-Studio Version: 7.21.64848.262
    Command Line: plog-converter -a GA\:1,2 -t fullhtml -o pvs.dir qctdataset.pvs.log
    qctvector.pvs.log qct.pvs.log qed.pvs.log
    Total Warnings (GA): 2

    Group Location Level Code Message
    General Analysis cpl_string.h:429 Medium V690 The 'CPLStringList' class
    implements the move assignment operator, but lacks a move constructor.
    It is dangerous to use such a class.

    General Analysis cpl_json.h:53 Medium V690 The 'CPLJSONObject' class
    implements the move assignment operator, but lacks a move constructor.
    It is dangerous to use such a class.

Any idea whether there is a missing move constructor
and whether this is a problem ?

Thanks,

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From even.rouault at spatialys.com  Sun Oct 16 05:26:57 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 16 Oct 2022 14:26:57 +0200
Subject: [gdal-dev] PVS-Studio "missing move constructor" warnings ?
In-Reply-To: <8f8f99c7-d4d9-601b-c44e-881df2b8d3@aitchison.me.uk>
References: <8f8f99c7-d4d9-601b-c44e-881df2b8d3@aitchison.me.uk>
Message-ID: <b0a26d1d-1bd7-97b4-284d-84659cf7d3a3@spatialys.com>

Andrew,

remedied with https://github.com/OSGeo/gdal/pull/6534

Even

Le 16/10/2022 ? 10:26, Andrew C Aitchison a ?crit?:
>
> When I run the PVS-Studio static analyzer https://pvs-studio.com/
> on my driver plugin I get two warnings on cpl code:
>
> PVS-Studio Analysis Results
>
> ?? Date: Sun Oct 16 09:12:51 2022
> ?? PVS-Studio Version: 7.21.64848.262
> ?? Command Line: plog-converter -a GA\:1,2 -t fullhtml -o pvs.dir 
> qctdataset.pvs.log
> ?? qctvector.pvs.log qct.pvs.log qed.pvs.log
> ?? Total Warnings (GA): 2
>
> ?? Group Location Level Code Message
> ?? General Analysis cpl_string.h:429 Medium V690 The 'CPLStringList' 
> class
> ?? implements the move assignment operator, but lacks a move constructor.
> ?? It is dangerous to use such a class.
>
> ?? General Analysis cpl_json.h:53 Medium V690 The 'CPLJSONObject' class
> ?? implements the move assignment operator, but lacks a move constructor.
> ?? It is dangerous to use such a class.
>
> Any idea whether there is a missing move constructor
> and whether this is a problem ?
>
> Thanks,
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew at aitchison.me.uk  Sun Oct 16 11:28:23 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 16 Oct 2022 19:28:23 +0100 (BST)
Subject: [gdal-dev] PVS-Studio "missing move constructor" warnings ?
In-Reply-To: <b0a26d1d-1bd7-97b4-284d-84659cf7d3a3@spatialys.com>
References: <8f8f99c7-d4d9-601b-c44e-881df2b8d3@aitchison.me.uk>
 <b0a26d1d-1bd7-97b4-284d-84659cf7d3a3@spatialys.com>
Message-ID: <f7267a96-6bbd-6595-059-f2d66c01949@aitchison.me.uk>

On Sun, 16 Oct 2022, Even Rouault wrote:

> Andrew,
>
> remedied with https://github.com/OSGeo/gdal/pull/6534

Thanks. My PVS-Studio is happy now.

I guess I will have to get my head around the differences between
move/assignment/copy operators and constructors :-(


> Le 16/10/2022 ? 10:26, Andrew C Aitchison a ?crit?:
>> 
>> When I run the PVS-Studio static analyzer https://pvs-studio.com/
>> on my driver plugin I get two warnings on cpl code:
>> 
>> PVS-Studio Analysis Results
>> 
>> ?? Date: Sun Oct 16 09:12:51 2022
>> ?? PVS-Studio Version: 7.21.64848.262
>> ?? Command Line: plog-converter -a GA\:1,2 -t fullhtml -o pvs.dir 
>> qctdataset.pvs.log
>> ?? qctvector.pvs.log qct.pvs.log qed.pvs.log
>> ?? Total Warnings (GA): 2
>> 
>> ?? Group Location Level Code Message
>> ?? General Analysis cpl_string.h:429 Medium V690 The 'CPLStringList' class
>> ?? implements the move assignment operator, but lacks a move constructor.
>> ?? It is dangerous to use such a class.
>> 
>> ?? General Analysis cpl_json.h:53 Medium V690 The 'CPLJSONObject' class
>> ?? implements the move assignment operator, but lacks a move constructor.
>> ?? It is dangerous to use such a class.
>> 
>> Any idea whether there is a missing move constructor
>> and whether this is a problem ?
>> 
>> Thanks,

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From nicolas.godet at outlook.fr  Mon Oct 17 01:05:09 2022
From: nicolas.godet at outlook.fr (Nicolas Godet)
Date: Mon, 17 Oct 2022 08:05:09 +0000
Subject: [gdal-dev] [Doc] gdal_calc.py extent option
Message-ID: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>

Dear Devs,

In documentation<https://gdal.org/programs/gdal_calc.html#cmdoption-extent>, extent param description seems a bit odd to me.


union - the extent (bounds) of the output will be the minimal rectangle that contains all the input extents.

intersect - the extent (bounds) of the output will be the maximal rectangle that is contained in all the input extents.

Shouldn't it be the other way around?

As I intend to add this option to QGIS gdal_calc window (very useful option), I must be sure.

Regards,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/c3dfee2c/attachment.htm>

From andrew at aitchison.me.uk  Mon Oct 17 01:25:23 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 17 Oct 2022 09:25:23 +0100 (BST)
Subject: [gdal-dev] [Doc] gdal_calc.py extent option
In-Reply-To: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
Message-ID: <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>

On Mon, 17 Oct 2022, Nicolas Godet wrote:

> Dear Devs,
>
> In documentation<https://gdal.org/programs/gdal_calc.html#cmdoption-extent>, extent param description seems a bit odd to me.
>
>
> union - the extent (bounds) of the output will be the minimal
> rectangle that contains all the input extents.
>
> intersect - the extent (bounds) of the output will be the maximal
> rectangle that is contained in all the input extents.
>
> Shouldn't it be the other way around?

I think this *is* the right way round;
"all" can be misunderstood but I can not think of a clearer phrasing,
although "every one of" might help.

> As I intend to add this option to QGIS gdal_calc window (very useful
> option), I must be sure.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From nicolas.godet at outlook.fr  Mon Oct 17 01:48:50 2022
From: nicolas.godet at outlook.fr (Nicolas Godet)
Date: Mon, 17 Oct 2022 08:48:50 +0000
Subject: [gdal-dev] [Doc] gdal_calc.py extent option
In-Reply-To: <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
Message-ID: <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>

Indeed, this is right.
My bad..
________________________________
De : Andrew C Aitchison <andrew at aitchison.me.uk>
Envoy? : lundi 17 octobre 2022 10:25
? : Nicolas Godet <nicolas.godet at outlook.fr>
Cc : gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Objet : Re: [gdal-dev] [Doc] gdal_calc.py extent option

On Mon, 17 Oct 2022, Nicolas Godet wrote:

> Dear Devs,
>
> In documentation<https://gdal.org/programs/gdal_calc.html#cmdoption-extent>, extent param description seems a bit odd to me.
>
>
> union - the extent (bounds) of the output will be the minimal
> rectangle that contains all the input extents.
>
> intersect - the extent (bounds) of the output will be the maximal
> rectangle that is contained in all the input extents.
>
> Shouldn't it be the other way around?

I think this *is* the right way round;
"all" can be misunderstood but I can not think of a clearer phrasing,
although "every one of" might help.

> As I intend to add this option to QGIS gdal_calc window (very useful
> option), I must be sure.

--
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/a1112962/attachment.htm>

From idan at miara.com  Mon Oct 17 01:54:52 2022
From: idan at miara.com (Idan Miara)
Date: Mon, 17 Oct 2022 11:54:52 +0300
Subject: [gdal-dev] [Doc] gdal_calc.py extent option
In-Reply-To: <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
 <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
Message-ID: <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>

Hi!
I needed the docs are correct but as this is the second time it confuses
people maybe the wording should be revised?

https://github.com/OSGeo/gdal/pull/5969

Any ideas?

On Mon, 17 Oct 2022, 11:49 Nicolas Godet, <nicolas.godet at outlook.fr> wrote:

> Indeed, this is right.
> My bad..
> ------------------------------
> *De :* Andrew C Aitchison <andrew at aitchison.me.uk>
> *Envoy? :* lundi 17 octobre 2022 10:25
> *? :* Nicolas Godet <nicolas.godet at outlook.fr>
> *Cc :* gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
> *Objet :* Re: [gdal-dev] [Doc] gdal_calc.py extent option
>
> On Mon, 17 Oct 2022, Nicolas Godet wrote:
>
> > Dear Devs,
> >
> > In documentation<
> https://gdal.org/programs/gdal_calc.html#cmdoption-extent>, extent param
> description seems a bit odd to me.
> >
> >
> > union - the extent (bounds) of the output will be the minimal
> > rectangle that contains all the input extents.
> >
> > intersect - the extent (bounds) of the output will be the maximal
> > rectangle that is contained in all the input extents.
> >
> > Shouldn't it be the other way around?
>
> I think this *is* the right way round;
> "all" can be misunderstood but I can not think of a clearer phrasing,
> although "every one of" might help.
>
> > As I intend to add this option to QGIS gdal_calc window (very useful
> > option), I must be sure.
>
> --
> Andrew C. Aitchison                      Kendal, UK
>                     andrew at aitchison.me.uk
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/e7941b05/attachment-0001.htm>

From diogo at photopills.com  Mon Oct 17 01:59:01 2022
From: diogo at photopills.com (Diogo)
Date: Mon, 17 Oct 2022 10:59:01 +0200
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
Message-ID: <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>

Hi Andrew. Thanks for taking the time to read my email and reply it.
I'm aware of Copernicus land and other datasets like SMRT3 and ASTER
however I need the best possible elevation resolution available. To do so,
I'm getting the elevation dataset directly from countries geographic
institutes and converting them into the coordinate system 4326+3855. But as
described in my previous email, I'm having some trouble with some geoids.
Do you have an idea why I'm having these transformation issues? To be
honest, I'm a bit lost because I can't understand it.

Thanks again for your help,
Diogo

On Fri, 14 Oct 2022 at 15:57, Andrew C Aitchison <andrew at aitchison.me.uk>
wrote:

> On Fri, 14 Oct 2022, Diogo wrote:
>
> > Hello everyone!
> >
> > I'm merging multiple elevation datasets from different countries and I
> > would like to re-project all into the same coordinates system, 4326+3855
> > using gdalwarp. I'm using `gdaltransform` to confirm that there is in
> fact
> > a conversion from the original projection to the aspected one. However,
> for
> > some datasets, there is only conversion in the XY axis, while the Z
> output
> > is the same as the input.
>
> Is there a good reason to start with these particular datasets ?
>
> There are international bodies who have produced elevation datasets
> covering the whole of
> Europe, eg
> https://land.copernicus.eu/user-corner/how-to-access-our-data
>
> https://www.eea.europa.eu/data-and-maps/data#c0=5&c11=&c5=all&b_start=0&c12=elevation
>
> https://www.eea.europa.eu/data-and-maps/data/copernicus-land-monitoring-service-eu-dem
>
> which would save you trying to stitch together data in different CRSes.
>
> > Below there are some examples (the geoid code is extracted from the
> dataset
> > documentation)
> >
> > Genoa 1942 height (Italy)
> >
> > $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
> > -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
> > 4195591.29690422 3357
> >
> > N2000 (Finland)
> >
> > $ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
> > on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
> > 6931460.32557422 269
> >
> > EVRF2007 (Estonia)
> >
> > $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
> > --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
> > 682284.606829111 6401087.4159131 318
> >
> >
> > I don't have much experience with the projections and I'm a bit lost
> > to understand the possible issues, or interpreted the Z output. What
> > can be the possible issues?
> >
> > Any help would be appreciated.
> >
> > Best regards,
> >
> > Diogo
> >
>
> --
> Andrew C. Aitchison                      Kendal, UK
>                     andrew at aitchison.me.uk
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/778b5766/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 17 03:03:35 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 17 Oct 2022 10:03:35 +0000
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
Message-ID: <AM0PR09MB32199594F9F9323B4069DEB8FD299@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

Maybe there is no transformation for converting heights from N2000 into WGS84 heights registered into the EPSG database. I found only two N2000 related transformations EPSG:9573 and EPSG:9574 and they seem convert to EVRF2019 height.
Proj can convert between our national height systems N2000, N60, and N43 but I fear that we at the National Land Survey of Finland have not managed to register them yet.

This publication is too heavy to read for me but please have a look and contact Mirjam if you need more advice https://www.researchgate.net/publication/256481988_Development_of_the_Finnish_Height_Conversion_Surface_FIN2005N00#read

-Jukka Rahkonen-



L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Diogo
L?hetetty: maanantai 17. lokakuuta 2022 11.59
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Transformations with same horizontal datum but different geoid outputs the same Z value

Hi Andrew. Thanks for taking the time to read my email and reply it.
I'm aware of Copernicus land and other datasets like SMRT3 and ASTER however I need the best possible elevation resolution available. To do so, I'm getting the elevation dataset directly from countries geographic institutes and converting them into the coordinate system 4326+3855. But as described in my previous email, I'm having some trouble with some geoids. Do you have an idea why I'm having these transformation issues? To be honest, I'm a bit lost because I can't understand it.

Thanks again for your help,
Diogo

On Fri, 14 Oct 2022 at 15:57, Andrew C Aitchison <andrew at aitchison.me.uk<mailto:andrew at aitchison.me.uk>> wrote:
On Fri, 14 Oct 2022, Diogo wrote:

> Hello everyone!
>
> I'm merging multiple elevation datasets from different countries and I
> would like to re-project all into the same coordinates system, 4326+3855
> using gdalwarp. I'm using `gdaltransform` to confirm that there is in fact
> a conversion from the original projection to the aspected one. However, for
> some datasets, there is only conversion in the XY axis, while the Z output
> is the same as the input.

Is there a good reason to start with these particular datasets ?

There are international bodies who have produced elevation datasets covering the whole of
Europe, eg
https://land.copernicus.eu/user-corner/how-to-access-our-data<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fland.copernicus.eu%2Fuser-corner%2Fhow-to-access-our-data&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Caa18fc3bad0649824f9708dab01ed49b%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638015943753338265%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=mfo6NuPABxZJkU3MRQeYfLRAsV0TeX%2FlNkAlinnKN8w%3D&reserved=0>
https://www.eea.europa.eu/data-and-maps/data#c0=5&c11=&c5=all&b_start=0&c12=elevation<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.eea.europa.eu%2Fdata-and-maps%2Fdata%23c0%3D5%26c11%3D%26c5%3Dall%26b_start%3D0%26c12%3Delevation&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Caa18fc3bad0649824f9708dab01ed49b%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638015943753338265%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=1b7YhCgROWYUTq8TBXIivDLKmzEHuj5NpNRCW%2BeVQ%2Fg%3D&reserved=0>
https://www.eea.europa.eu/data-and-maps/data/copernicus-land-monitoring-service-eu-dem<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.eea.europa.eu%2Fdata-and-maps%2Fdata%2Fcopernicus-land-monitoring-service-eu-dem&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Caa18fc3bad0649824f9708dab01ed49b%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638015943753338265%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=PKBB6EfcZ5qniFw6gKkcENOzoPvnfTiQr53ErOZV4DA%3D&reserved=0>

which would save you trying to stitch together data in different CRSes.

> Below there are some examples (the geoid code is extracted from the dataset
> documentation)
>
> Genoa 1942 height (Italy)
>
> $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
> -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
> 4195591.29690422 3357
>
> N2000 (Finland)
>
> $ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
> on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
> 6931460.32557422 269
>
> EVRF2007 (Estonia)
>
> $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
> --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
> 682284.606829111 6401087.4159131 318
>
>
> I don't have much experience with the projections and I'm a bit lost
> to understand the possible issues, or interpreted the Z output. What
> can be the possible issues?
>
> Any help would be appreciated.
>
> Best regards,
>
> Diogo
>

--
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk<mailto:andrew at aitchison.me.uk>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/cb3dcd3c/attachment-0001.htm>

From j1 at jimenezshaw.com  Mon Oct 17 03:03:04 2022
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 17 Oct 2022 12:03:04 +0200
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
Message-ID: <CADRrdKtc2B4td9popPYeRueAzZRvKzpQDdjG5OVf8sDHjpsV-Q@mail.gmail.com>

Italy? I am not aware of any Geoid grid file for Italy in PROJ-Data:
https://cdn.proj.org/

EPSG:5214 is the vertical coordinate reference system, not a geoid model.
https://epsg.org/crs_5214/Genoa-1942-height.html
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Mon, 17 Oct 2022 at 10:59, Diogo <diogo at photopills.com> wrote:

> Hi Andrew. Thanks for taking the time to read my email and reply it.
> I'm aware of Copernicus land and other datasets like SMRT3 and ASTER
> however I need the best possible elevation resolution available. To do so,
> I'm getting the elevation dataset directly from countries geographic
> institutes and converting them into the coordinate system 4326+3855. But as
> described in my previous email, I'm having some trouble with some geoids.
> Do you have an idea why I'm having these transformation issues? To be
> honest, I'm a bit lost because I can't understand it.
>
> Thanks again for your help,
> Diogo
>
> On Fri, 14 Oct 2022 at 15:57, Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
>
>> On Fri, 14 Oct 2022, Diogo wrote:
>>
>> > Hello everyone!
>> >
>> > I'm merging multiple elevation datasets from different countries and I
>> > would like to re-project all into the same coordinates system, 4326+3855
>> > using gdalwarp. I'm using `gdaltransform` to confirm that there is in
>> fact
>> > a conversion from the original projection to the aspected one. However,
>> for
>> > some datasets, there is only conversion in the XY axis, while the Z
>> output
>> > is the same as the input.
>>
>> Is there a good reason to start with these particular datasets ?
>>
>> There are international bodies who have produced elevation datasets
>> covering the whole of
>> Europe, eg
>> https://land.copernicus.eu/user-corner/how-to-access-our-data
>>
>> https://www.eea.europa.eu/data-and-maps/data#c0=5&c11=&c5=all&b_start=0&c12=elevation
>>
>> https://www.eea.europa.eu/data-and-maps/data/copernicus-land-monitoring-service-eu-dem
>>
>> which would save you trying to stitch together data in different CRSes.
>>
>> > Below there are some examples (the geoid code is extracted from the
>> dataset
>> > documentation)
>> >
>> > Genoa 1942 height (Italy)
>> >
>> > $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
>> > -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
>> > 4195591.29690422 3357
>> >
>> > N2000 (Finland)
>> >
>> > $ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
>> > on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
>> > 6931460.32557422 269
>> >
>> > EVRF2007 (Estonia)
>> >
>> > $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
>> > --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
>> > 682284.606829111 6401087.4159131 318
>> >
>> >
>> > I don't have much experience with the projections and I'm a bit lost
>> > to understand the possible issues, or interpreted the Z output. What
>> > can be the possible issues?
>> >
>> > Any help would be appreciated.
>> >
>> > Best regards,
>> >
>> > Diogo
>> >
>>
>> --
>> Andrew C. Aitchison                      Kendal, UK
>>                     andrew at aitchison.me.uk
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/b9d54cd4/attachment.htm>

From even.rouault at spatialys.com  Mon Oct 17 03:28:39 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Oct 2022 12:28:39 +0200
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
Message-ID: <bba09e5e-2c62-1d4c-e183-d7d05a767f99@spatialys.com>

Diogo,

There are far more CRS definitions in the PROJ database, mostly coming 
from the EPSG dataset, than there are known transformations from/to 
those CRS to other ones
>
> Genoa 1942 height (Italy)
>
> $echo  "14.995 37.755 3357"  |  PROJ_NETWORK=ON gdaltransform --debug on -s_srs"EPSG:4326+3855"  -t_srs"EPSG:32632+5214"
> >>  1028333.73796622 4195591.29690422 3357
In that situation, "projinfo -t EPSG:32632+5214 -s EPSG:4326+3855 
--spatial-test intersects" shows a potential transformation, but that 
requires that you need to get (buy) the geo_igm_mar06.grd grid which 
does the "ETRS89 to Genoa 1942 height" transformation from 
https://www.igmi.org/en and convert it into a format understood by PROJ
>
> N2000 (Finland)
>
> $echo  "25.15296 62.50195 269"  |  PROJ_NETWORK=ON gdaltransform --debug on -s_srs"EPSG:4326+3855"  -t_srs"EPSG:3067+3900"
> >>  404861.868388335 6931460.32557422 269

There's no known transformation between N2000 and ETRS89 or WGS84 in the 
database.

That said 
https://www-maanmittauslaitos-fi.translate.goog/kartat-ja-paikkatieto/asiantuntevalle-kayttajalle/koordinaattimuunnokset/fin2005n00-geoidimalli?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en-US&_x_tr_pto=wapp 
shows that there is a FIN2005N00 geoid model that exists for N2000 <--> 
ETRS89, so there's potential if that was registered in EPSG.

That said, if you use the online converted at 
https://kartta.paikkatietoikkuna.fi/?lang=en to do the N2000 <--> 
ETRS89, you can get the result:

1) Transform from EPSG:4326+3855 to ETRS89 3D

$ echo 25.15296 62.50195 269 | PROJ_NETWORK=ON gdaltransform -s_srs 
EPSG:4326+3855 -t_srs EPSG:4939
25.15296 62.50195 287.822128823693

2) Use the online transformer from EUREF-FIN-GRS80h (~= EPSG:4939) to 
EUREF-FIN-GRS80 + N2000

==> lat=62.50195 lon=25.15296 H=269.2867

3) Transform fromEUREF-FIN-GRS80 +? N2000 to EPSG:3067+3900

$ echo 25.15296 62.50195 269.2867? | PROJ_NETWORK=ON gdaltransform 
-s_srs EPSG:4258+3900 -t_srs EPSG:3067+3900
404861.868388335 6931460.32557422 269.2867


> EVRF2007 (Estonia)
>
> $echo  "27.059167 57.714444 318"  |  PROJ_NETWORK=ON gdaltransform --debug on -s_srs"EPSG:4326+3855"  -t_srs"EPSG:3301+5621"
> >>  682284.606829111 6401087.4159131 318

There's only one known transformation between EVRF2007 and ETRS89 or 
WGS84, but it is for Slovakia.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/bafc371c/attachment.htm>

From andrew at aitchison.me.uk  Mon Oct 17 05:16:04 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 17 Oct 2022 13:16:04 +0100 (BST)
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
Message-ID: <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk>

On Mon, 17 Oct 2022, Diogo wrote:

> Hi Andrew. Thanks for taking the time to read my email and reply it.
> I'm aware of Copernicus land and other datasets like SMRT3 and ASTER
> however I need the best possible elevation resolution available. To do so,
> I'm getting the elevation dataset directly from countries geographic
> institutes and converting them into the coordinate system 4326+3855. But as
> described in my previous email, I'm having some trouble with some geoids.
> Do you have an idea why I'm having these transformation issues? To be
> honest, I'm a bit lost because I can't understand it.

Sorry, I know no more (and probably less) than you about the transforms.

>From what others have said, I suspect that there is no *meaningful*
way to have better elevation resolution over such a large area than the 
Copernicus data.

I do know that 4326 uses a geoid which is less accurate *over Great 
Britain* than the one the Great Britain Ordnance Survey have been
using for a century or two (OSGB36 Datum 1936, Airy Spheriod 1830!).
I suspect that other national geo-organisations do the same thing and you 
will lose the extra accuracy in standardising on one coordinate system over 
Europe.


> Thanks again for your help,
> Diogo
>
> On Fri, 14 Oct 2022 at 15:57, Andrew C Aitchison <andrew at aitchison.me.uk>
> wrote:
>
>> On Fri, 14 Oct 2022, Diogo wrote:
>>
>>> Hello everyone!
>>>
>>> I'm merging multiple elevation datasets from different countries and I
>>> would like to re-project all into the same coordinates system, 4326+3855
>>> using gdalwarp. I'm using `gdaltransform` to confirm that there is in
>> fact
>>> a conversion from the original projection to the aspected one. However,
>> for
>>> some datasets, there is only conversion in the XY axis, while the Z
>> output
>>> is the same as the input.
>>
>> Is there a good reason to start with these particular datasets ?
>>
>> There are international bodies who have produced elevation datasets
>> covering the whole of
>> Europe, eg
>> https://land.copernicus.eu/user-corner/how-to-access-our-data
>>
>> https://www.eea.europa.eu/data-and-maps/data#c0=5&c11=&c5=all&b_start=0&c12=elevation
>>
>> https://www.eea.europa.eu/data-and-maps/data/copernicus-land-monitoring-service-eu-dem
>>
>> which would save you trying to stitch together data in different CRSes.
>>
>>> Below there are some examples (the geoid code is extracted from the
>> dataset
>>> documentation)
>>>
>>> Genoa 1942 height (Italy)
>>>
>>> $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on
>>> -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622
>>> 4195591.29690422 3357
>>>
>>> N2000 (Finland)
>>>
>>> $ echo "25.15296 62.50195 269" | PROJ_NETWORK=ON gdaltransform --debug
>>> on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3067+3900">> 404861.868388335
>>> 6931460.32557422 269
>>>
>>> EVRF2007 (Estonia)
>>>
>>> $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform
>>> --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">>
>>> 682284.606829111 6401087.4159131 318
>>>
>>>
>>> I don't have much experience with the projections and I'm a bit lost
>>> to understand the possible issues, or interpreted the Z output. What
>>> can be the possible issues?
>>>
>>> Any help would be appreciated.
>>>
>>> Best regards,
>>>
>>> Diogo
>>>
>>
>> --
>> Andrew C. Aitchison                      Kendal, UK
>>                     andrew at aitchison.me.uk
>>
>

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From gdt at lexort.com  Mon Oct 17 05:32:31 2022
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 17 Oct 2022 08:32:31 -0400
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk> (Andrew
 C. Aitchison's message of "Mon, 17 Oct 2022 13:16:04 +0100 (BST)")
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
 <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk>
Message-ID: <rmir0z61vhc.fsf@s1.lexort.com>


Andrew C Aitchison <andrew at aitchison.me.uk> writes:

> On Mon, 17 Oct 2022, Diogo wrote:
>
>> Hi Andrew. Thanks for taking the time to read my email and reply it.
>> I'm aware of Copernicus land and other datasets like SMRT3 and ASTER
>> however I need the best possible elevation resolution available. To do so,
>> I'm getting the elevation dataset directly from countries geographic
>> institutes and converting them into the coordinate system 4326+3855. But as
>> described in my previous email, I'm having some trouble with some geoids.
>> Do you have an idea why I'm having these transformation issues? To be
>> honest, I'm a bit lost because I can't understand it.
>
> Sorry, I know no more (and probably less) than you about the transforms.

Basically, one needs to pick a worldwide height system and then
transform data from multiple regions into it.  This is hard because

  - The only global height system I'm aware of is "WGS84 Orthometric
    Height".  One in practice accesses that via WGS84 Height Above
    Ellipsoid and the EGM2008 full-resolution gravity model.  In other
    words, WGS84 Orthometric Height is defined relative to a specific
    potential, and the geoid model is just how you get a value.

    A nuance (sorry Javier :-) is that WGS84 is an ensemble and you
    really should say "WGS84(G2159) Orthometric Height" to mean that you
    are using recent WGS84 HAE and then EGM2008.

    (If there is another global height system, I'd like to hear about it.)

  - It is often hard to find transformations from national height datums
    to WGS84 Orthometric Height.  In the US, I don't know of any.  But
    there are published geoid models from NAVD88 to NAD83 HAE, and then
    one can transform to WGS84(G2159) HAE, and then use EGM2008 to get
    WGS84 Orthometric Height.

  - You being able to find and understand transforms is one thing.  But
    them being in EPSG and being handled correctly is another.

> From what others have said, I suspect that there is no *meaningful*
> way to have better elevation resolution over such a large area than
> the Copernicus data.

I think it's likely meaningful, just way too hard.

> I do know that 4326 uses a geoid which is less accurate *over Great
> Britain* than the one the Great Britain Ordnance Survey have been
> using for a century or two (OSGB36 Datum 1936, Airy Spheriod 1830!).
> I suspect that other national geo-organisations do the same thing and
> you will lose the extra accuracy in standardising on one coordinate
> system over Europe.

I don't follow this at all.  EPSG:4326 is a 2D system, so it doesn't
even have height, and has no associated geoid.

I'm sure there is a CRS that's essentially that with HAE, but I use
ITRF2014 (EPSG:7912), to avoid the ensemble issues.

I would expect an EPSG codepoint that is WGS84 lat/lon and WGS84
Orthometic Height.  But that CRS doesn't really "use" a geoid, it's that
the transformation from WGS84(LL)+WGS84OH to WGS84(LLh) is done by
EGM2008.

If you mean that OSGB36 datum (meaning the position of the ellipsoid) is
a better fit for the geoid over GB, then that isn't really relevant
because the issue here is the error in the geoid model, not the
difference between geoid heights and ellipsoidal heights.

For example, I'm at ~ -30m geoid height, and I was able to obtain an
NAVD88 height for a benchmark via RTK GNSS in NAD83 and then using
GEOID18, and ending up within 10-20 cm of the published value (from a
mark last leveled in NGVD29).

So this is likely doable; it's probably just too much work.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221017/ffd34aa5/attachment-0001.sig>

From andrew at aitchison.me.uk  Mon Oct 17 09:04:33 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 17 Oct 2022 17:04:33 +0100 (BST)
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <rmir0z61vhc.fsf@s1.lexort.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
 <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk>
 <rmir0z61vhc.fsf@s1.lexort.com>
Message-ID: <14bbbbb-60f7-4857-6dcc-add6cb7c58c7@aitchison.me.uk>

On Mon, 17 Oct 2022, Greg Troxel wrote:

>
> Andrew C Aitchison <andrew at aitchison.me.uk> writes:
>> I do know that 4326 uses a geoid which is less accurate *over Great
>> Britain* than the one the Great Britain Ordnance Survey have been
>> using for a century or two (OSGB36 Datum 1936, Airy Spheriod 1830!).
>> I suspect that other national geo-organisations do the same thing and
>> you will lose the extra accuracy in standardising on one coordinate
>> system over Europe.
>
> I don't follow this at all.  EPSG:4326 is a 2D system, so it doesn't
> even have height, and has no associated geoid.

Ah. I misremembered; I should have said the GRS80 ellipsoid:

https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#Compatibility_with_related_systems

The Airy ellipsoid is a regional best fit for Britain; more modern mapping 
tends to use the GRS80 ellipsoid used by the Global Positioning System 
(the Airy ellipsoid assumes the Earth to be about 1 km smaller in diameter 
than the GRS80 ellipsoid, and to be slightly less flattened).

I do remember mourning that GPS overthrew the Airy Spheroid.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From diogo at photopills.com  Tue Oct 18 03:36:18 2022
From: diogo at photopills.com (Diogo)
Date: Tue, 18 Oct 2022 12:36:18 +0200
Subject: [gdal-dev] Fwd: Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <CAA_s=pOHWnc=Bbgtc6YT8qxfVkJNy1zyQR82uvsAEEq6BnNHZw@mail.gmail.com>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
 <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk>
 <rmir0z61vhc.fsf@s1.lexort.com>
 <14bbbbb-60f7-4857-6dcc-add6cb7c58c7@aitchison.me.uk>
 <CAA_s=pOHWnc=Bbgtc6YT8qxfVkJNy1zyQR82uvsAEEq6BnNHZw@mail.gmail.com>
Message-ID: <CAA_s=pNgrE122Vyi1JG1=Enx7qw15H6VJ96_rx+L5t18vV2ipA@mail.gmail.com>

Hi there! Thanks, everyone for your help and recommendations provided.



Even, I wasn't aware of that, as many other things I see. I thought that It
could be translated directly

> Genoa 1942 height (Italy)
>
> $ echo "14.995 37.755 3357" | PROJ_NETWORK=ON gdaltransform --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:32632+5214">> 1028333.73796622 4195591.29690422 3357
>
> In that situation, "projinfo -t EPSG:32632+5214 -s EPSG:4326+3855
> --spatial-test intersects" shows a potential transformation, but that
> requires that you need to get (buy) the geo_igm_mar06.grd grid which does
> the "ETRS89 to Genoa 1942 height" transformation from
> https://www.igmi.org/en and convert it into a format understood by PROJ
>

Prefixing your command with "PROJ_NETWORK=ON" outputs a WTK without the
warnings about the missing grid. Should this be enough?

EVRF2007 (Estonia)
>
> $ echo "27.059167 57.714444 318" | PROJ_NETWORK=ON gdaltransform --debug on -s_srs "EPSG:4326+3855" -t_srs "EPSG:3301+5621">> 682284.606829111 6401087.4159131 318
>
> There's only one known transformation between EVRF2007 and ETRS89 or
> WGS84, but it is for Slovakia.
>
Could you tell me which one it is? I will need to transform Slovakia as well


Basically, one needs to pick a worldwide height system and then
> transform data from multiple regions into it.  This is hard because
>
[....]
>

Greg, that is exactly what I'm doing but I was not aware of how hard it
could be. I would like to have the final dataset in 4326+3855. Would be
easier to use the EGM96 instead?

Could you please clarify one thing for me?

- It is often hard to find transformations from national height datums
>     to WGS84 Orthometric Height.  In the US, I don't know of any.  But
>     there are published geoid models from NAVD88 to NAD83 HAE, and then
>     one can transform to WGS84(G2159) HAE, and then use EGM2008 to get
>     WGS84 Orthometric Height.
>

Converting for example the USA NED 10M dataset, I can't reproject all
dataset to 4326+3855 without any intermediary transformation step? For
instance, in the below command, isn't the Z output value precise?
$ echo "-112.55260 33.48142 643" | PROJ_NETWORK=ON gdaltransform -s_srs
"EPSG:6318+5703" -t_srs EPSG:4326+3855
>> -112.5526 33.48142 643.369641951764


>From what others have said, I suspect that there is no *meaningful*
> way to have better elevation resolution over such a large area than the
> Copernicus data.
>

Andrew, I'm using Copernicus as a fallback when I can't find a dataset with
better resolution. Because I need to get the most accurately possible
elevation data, I'm merging datasets with 10M, 5M, or 2M pixel resolution
with Copernicus data. I'm aware that this is not an easy task, but
currently, my main issue is to understand the particularities of
transforming the original dataset projection into the desired one. Because
my background is not related to GIS makes this task more challenging :'-)

Best regards,
Diogo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/ef38412d/attachment.htm>

From lelong.ph at meltemus.com  Tue Oct 18 03:43:53 2022
From: lelong.ph at meltemus.com (Philippe Lelong)
Date: Tue, 18 Oct 2022 10:43:53 +0000
Subject: [gdal-dev] Problem with coordinate transformation
Message-ID: <acef70c2d33849bbbb31111017635bea@meltemus.com>

Hi,


I have an app build against GDAL 3.4.1 and PROJ6, and the same app build against GDAL 2.1.3 and PROJ4. They are not giving the same result when using OGRCoordinateTransformation.


If I do


    const char *their = "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]";

    const char *our = "+proj=longlat +datum=WGS84 +ellps=WGS84 +no_defs +over";

    double miX = -17.4042;

    double miY = 35.3333;

    OGRSpatialReference theirReference;

    theirReference.importFromWkt((char**)&their);

    OGRSpatialReference ourReference;

    ourReference.importFromProj4(our);

    OGRCoordinateTransformation *trans = OGRCreateCoordinateTransformation(&theirReference, &ourReference);

    trans->Transform(1, &miX, &miY);


in the version build against GDAL 3.4.1/PROJ6 this code results in swapping miX and miY (i.e. miX = 35.3333 and miY = -17.4042)

The version build against GDAL 2.1.3/PROJ4 leaves miX and miY unchanged, which I believe is correct.


Any explanation for this behavior and which one is correct? Would I get the same result using PROJ8 ?


Thanks in advance

Philippe Lelong


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/c82990f5/attachment.htm>

From lnicola at dend.ro  Tue Oct 18 04:01:13 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Tue, 18 Oct 2022 14:01:13 +0300
Subject: [gdal-dev] Problem with coordinate transformation
In-Reply-To: <acef70c2d33849bbbb31111017635bea@meltemus.com>
References: <acef70c2d33849bbbb31111017635bea@meltemus.com>
Message-ID: <2f787c01-a889-4eab-8965-f155071cef4c@betaapp.fastmail.com>

Hi Philippe,

The new behaviour is correct. See https://gdal.org/development/rfc/rfc73_proj6_wkt2_srsbarn.html#axis-order-issues for the axis order issue, a change made in GDAL 3.0. You can find a solution in https://github.com/OSGeo/gdal/blob/v3.5.0/MIGRATION_GUIDE.TXT#L67 (calling SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER) on every OGRSpatialReference you use.

Laurentiu

On Tue, Oct 18, 2022, at 13:43, Philippe Lelong wrote:
> Hi,
> 
> 
> 
> I have an app build against GDAL 3.4.1 and PROJ6, and the same app build against GDAL 2.1.3 and PROJ4. They are not giving the same result when using OGRCoordinateTransformation.
> 
> 
> 
> If I do
> 
> 
> 
> 
> 
>     const char *their = "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]";
>     const char *our = "+proj=longlat +datum=WGS84 +ellps=WGS84 +no_defs +over";
>     double miX = -17.4042;
>     double miY = 35.3333;
>     OGRSpatialReference theirReference;
>     theirReference.importFromWkt((char**)&their);
>     OGRSpatialReference ourReference;
>     ourReference.importFromProj4(our);
>     OGRCoordinateTransformation *trans = OGRCreateCoordinateTransformation(&theirReference, &ourReference);
>     trans->Transform(1, &miX, &miY);
> 
> in the version build against GDAL 3.4.1/PROJ6 this code results in swapping miX and miY (i.e. miX = 35.3333 and miY = -17.4042) 
> 
> 
> The version build against GDAL 2.1.3/PROJ4 leaves miX and miY unchanged, which I believe is correct.
> 
> 
> 
> Any explanation for this behavior and which one is correct? Would I get the same result using PROJ8 ?
> 
> 
> 
> Thanks in advance
> 
> Philippe Lelong
> 
> 
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/44eb31fd/attachment-0001.htm>

From lelong.ph at meltemus.com  Tue Oct 18 05:39:01 2022
From: lelong.ph at meltemus.com (Philippe Lelong)
Date: Tue, 18 Oct 2022 12:39:01 +0000
Subject: [gdal-dev] Problem with coordinate transformation
In-Reply-To: <2f787c01-a889-4eab-8965-f155071cef4c@betaapp.fastmail.com>
References: <acef70c2d33849bbbb31111017635bea@meltemus.com>,
 <2f787c01-a889-4eab-8965-f155071cef4c@betaapp.fastmail.com>
Message-ID: <033fc324938d4586a6f05c662b83b72b@meltemus.com>

Thanks very much, I would never have figured that out myself.


Just to make it clear I should add this flag on all OGRSpatialReference or only when it is loaded with importFromWkt ?


--Philippe


________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org>
Sent: Tuesday, October 18, 2022 1:01 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Problem with coordinate transformation

Hi Philippe,

The new behaviour is correct. See https://gdal.org/development/rfc/rfc73_proj6_wkt2_srsbarn.html#axis-order-issues for the axis order issue, a change made in GDAL 3.0. You can find a solution in https://github.com/OSGeo/gdal/blob/v3.5.0/MIGRATION_GUIDE.TXT#L67 (calling SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER) on every OGRSpatialReference you use.

Laurentiu

On Tue, Oct 18, 2022, at 13:43, Philippe Lelong wrote:

Hi,


I have an app build against GDAL 3.4.1 and PROJ6, and the same app build against GDAL 2.1.3 and PROJ4. They are not giving the same result when using OGRCoordinateTransformation.


If I do



    const char *their = "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]";

    const char *our = "+proj=longlat +datum=WGS84 +ellps=WGS84 +no_defs +over";

    double miX = -17.4042;

    double miY = 35.3333;

    OGRSpatialReference theirReference;

    theirReference.importFromWkt((char**)&their);

    OGRSpatialReference ourReference;

    ourReference.importFromProj4(our);

    OGRCoordinateTransformation *trans = OGRCreateCoordinateTransformation(&theirReference, &ourReference);

    trans->Transform(1, &miX, &miY);


in the version build against GDAL 3.4.1/PROJ6 this code results in swapping miX and miY (i.e. miX = 35.3333 and miY = -17.4042)


The version build against GDAL 2.1.3/PROJ4 leaves miX and miY unchanged, which I believe is correct.


Any explanation for this behavior and which one is correct? Would I get the same result using PROJ8 ?


Thanks in advance

Philippe Lelong



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/9337dc88/attachment.htm>

From lnicola at dend.ro  Tue Oct 18 06:45:01 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Tue, 18 Oct 2022 16:45:01 +0300
Subject: [gdal-dev] Problem with coordinate transformation
In-Reply-To: <033fc324938d4586a6f05c662b83b72b@meltemus.com>
References: <acef70c2d33849bbbb31111017635bea@meltemus.com>
 <2f787c01-a889-4eab-8965-f155071cef4c@betaapp.fastmail.com>
 <033fc324938d4586a6f05c662b83b72b@meltemus.com>
Message-ID: <336e6c7d-4618-46dc-b559-627370954844@betaapp.fastmail.com>

Hi,

According to the migration guide, this is only relevant for OSRImportFromEPSG, SetWellKnownGeogCS and SetFromUserInput. But then again, you were using the equivalent of OSRImportFromWkt.

I never noticed any issues when using spatial references loaded from existing rasters, but you might want to test. I tried loading the SpatialReference from a NetCDF produced by GDAL 2.3.2, under the (verified) assumption that it will contain the SRS without the AXIS nodes. But GDAL 3.5.1 still seems to use the traditional order for these.

Laurentiu

On Tue, Oct 18, 2022, at 15:39, Philippe Lelong wrote:
> Thanks very much, I would never have figured that out myself.
> 
> 
> 
> Just to make it clear I should add this flag on all OGRSpatialReference or only when it is loaded with importFromWkt ?
> 
> 
> 
> --Philippe 
> 
> 
> 
> 
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org>
> *Sent:* Tuesday, October 18, 2022 1:01 PM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Problem with coordinate transformation
>  
> Hi Philippe,
> 
> The new behaviour is correct. See https://gdal.org/development/rfc/rfc73_proj6_wkt2_srsbarn.html#axis-order-issues for the axis order issue, a change made in GDAL 3.0. You can find a solution in https://github.com/OSGeo/gdal/blob/v3.5.0/MIGRATION_GUIDE.TXT#L67 (calling SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER) on every OGRSpatialReference you use.
> 
> Laurentiu
> 
> On Tue, Oct 18, 2022, at 13:43, Philippe Lelong wrote:
>> Hi,
>> 
>> 
>> 
>> I have an app build against GDAL 3.4.1 and PROJ6, and the same app build against GDAL 2.1.3 and PROJ4. They are not giving the same result when using OGRCoordinateTransformation.
>> 
>> 
>> 
>> If I do
>> 
>> 
>> 
>> 
>> 
>>     const char *their = "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]";
>>     const char *our = "+proj=longlat +datum=WGS84 +ellps=WGS84 +no_defs +over";
>>     double miX = -17.4042;
>>     double miY = 35.3333;
>>     OGRSpatialReference theirReference;
>>     theirReference.importFromWkt((char**)&their);
>>     OGRSpatialReference ourReference;
>>     ourReference.importFromProj4(our);
>>     OGRCoordinateTransformation *trans = OGRCreateCoordinateTransformation(&theirReference, &ourReference);
>>     trans->Transform(1, &miX, &miY);
>> 
>> in the version build against GDAL 3.4.1/PROJ6 this code results in swapping miX and miY (i.e. miX = 35.3333 and miY = -17.4042) 
>> 
>> 
>> The version build against GDAL 2.1.3/PROJ4 leaves miX and miY unchanged, which I believe is correct.
>> 
>> 
>> 
>> Any explanation for this behavior and which one is correct? Would I get the same result using PROJ8 ?
>> 
>> 
>> 
>> Thanks in advance
>> 
>> Philippe Lelong
>> 
>> 
>> 
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/f43a8e0d/attachment-0001.htm>

From lelong.ph at meltemus.com  Tue Oct 18 07:26:28 2022
From: lelong.ph at meltemus.com (Philippe Lelong)
Date: Tue, 18 Oct 2022 14:26:28 +0000
Subject: [gdal-dev] Problem with coordinate transformation
In-Reply-To: <336e6c7d-4618-46dc-b559-627370954844@betaapp.fastmail.com>
References: <acef70c2d33849bbbb31111017635bea@meltemus.com>
 <2f787c01-a889-4eab-8965-f155071cef4c@betaapp.fastmail.com>
 <033fc324938d4586a6f05c662b83b72b@meltemus.com>,
 <336e6c7d-4618-46dc-b559-627370954844@betaapp.fastmail.com>
Message-ID: <92a95d76e884490180a6efe74e98306d@meltemus.com>

Hi, thanks again for the explanation


I uploaded the tif file I was trying to render here: https://www.virtual-winds.org/maitai/gebco.tif


The thing that worries me is that it is the first case since we upgraded to 3.4.1 a quite a while ago, and I am wondering how it can work for all other tif datasets we are using. I tested a few with this modification and nothing seems broken, so it seems OK.


--Philippe


________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org>
Sent: Tuesday, October 18, 2022 3:45 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Problem with coordinate transformation

Hi,

According to the migration guide, this is only relevant for OSRImportFromEPSG, SetWellKnownGeogCS and SetFromUserInput. But then again, you were using the equivalent of OSRImportFromWkt.

I never noticed any issues when using spatial references loaded from existing rasters, but you might want to test. I tried loading the SpatialReference from a NetCDF produced by GDAL 2.3.2, under the (verified) assumption that it will contain the SRS without the AXIS nodes. But GDAL 3.5.1 still seems to use the traditional order for these.

Laurentiu

On Tue, Oct 18, 2022, at 15:39, Philippe Lelong wrote:

Thanks very much, I would never have figured that out myself.


Just to make it clear I should add this flag on all OGRSpatialReference or only when it is loaded with importFromWkt ?


--Philippe


________________________________

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Lauren?iu Nicola via gdal-dev <gdal-dev at lists.osgeo.org>
Sent: Tuesday, October 18, 2022 1:01 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Problem with coordinate transformation

Hi Philippe,

The new behaviour is correct. See https://gdal.org/development/rfc/rfc73_proj6_wkt2_srsbarn.html#axis-order-issues for the axis order issue, a change made in GDAL 3.0. You can find a solution in https://github.com/OSGeo/gdal/blob/v3.5.0/MIGRATION_GUIDE.TXT#L67 (calling SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER) on every OGRSpatialReference you use.

Laurentiu

On Tue, Oct 18, 2022, at 13:43, Philippe Lelong wrote:

Hi,


I have an app build against GDAL 3.4.1 and PROJ6, and the same app build against GDAL 2.1.3 and PROJ4. They are not giving the same result when using OGRCoordinateTransformation.


If I do



    const char *their = "GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]";

    const char *our = "+proj=longlat +datum=WGS84 +ellps=WGS84 +no_defs +over";

    double miX = -17.4042;

    double miY = 35.3333;

    OGRSpatialReference theirReference;

    theirReference.importFromWkt((char**)&their);

    OGRSpatialReference ourReference;

    ourReference.importFromProj4(our);

    OGRCoordinateTransformation *trans = OGRCreateCoordinateTransformation(&theirReference, &ourReference);

    trans->Transform(1, &miX, &miY);


in the version build against GDAL 3.4.1/PROJ6 this code results in swapping miX and miY (i.e. miX = 35.3333 and miY = -17.4042)


The version build against GDAL 2.1.3/PROJ4 leaves miX and miY unchanged, which I believe is correct.


Any explanation for this behavior and which one is correct? Would I get the same result using PROJ8 ?


Thanks in advance

Philippe Lelong



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/34f2a047/attachment.htm>

From Matt.Wilkie at yukon.ca  Tue Oct 18 08:46:07 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie)
Date: Tue, 18 Oct 2022 15:46:07 +0000
Subject: [gdal-dev] [EXT] Re:  [Doc] gdal_calc.py extent option
In-Reply-To: <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
 <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>
Message-ID: <YT3PR01MB559094AB31CB61B400A040EB87289@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>

To my mind the outputs of Union should be the largest extent area and Intersect is the smallest extent area. However any explanation in words alone will always have some ambiguity. It can't be avoided.

Union and Intersect via Wiki.GIS.com (I do find the intersect diagram less clear in this example than the next one):
[http://wiki.gis.com/wiki/images/thumb/2/28/Union.jpg/300px-Union.jpg]
[http://wiki.gis.com/wiki/images/thumb/4/4e/Demo_one.JPG/300px-Demo_one.JPG]

Union and Intersect in Wikipedia polygon theory:

[cid:image005.gif at 01D8E2CC.BDA0FE00]


http://wiki.gis.com/wiki/index.php/Union
https://en.wikipedia.org/wiki/Boolean_operations_on_polygons

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Idan Miara
Sent: October 17, 2022 1:55 AM
To: Nicolas Godet <nicolas.godet at outlook.fr>
Cc: Andrew C Aitchison <andrew at aitchison.me.uk>; gdal-dev at lists.osgeo.org
Subject: [EXT] Re: [gdal-dev] [Doc] gdal_calc.py extent option

Hi!
I needed the docs are correct but as this is the second time it confuses people maybe the wording should be revised?

https://github.com/OSGeo/gdal/pull/5969<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fpull%2F5969&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=qgiJYx5KjebSDNQrw4QJHhY%2FrntE1Pyxfn32x31xlus%3D&reserved=0>

Any ideas?

On Mon, 17 Oct 2022, 11:49 Nicolas Godet, <nicolas.godet at outlook.fr<mailto:nicolas.godet at outlook.fr>> wrote:
Indeed, this is right.
My bad..
________________________________
De : Andrew C Aitchison <andrew at aitchison.me.uk<mailto:andrew at aitchison.me.uk>>
Envoy? : lundi 17 octobre 2022 10:25
? : Nicolas Godet <nicolas.godet at outlook.fr<mailto:nicolas.godet at outlook.fr>>
Cc : gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Objet : Re: [gdal-dev] [Doc] gdal_calc.py extent option

On Mon, 17 Oct 2022, Nicolas Godet wrote:

> Dear Devs,
>
> In documentation<https://gdal.org/programs/gdal_calc.html#cmdoption-extent<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgdal.org%2Fprograms%2Fgdal_calc.html%23cmdoption-extent&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=ZQebVL1FblaUBIaZBYBsXHNJ0JfFm4nO8RzK2Gp4TZE%3D&reserved=0>>, extent param description seems a bit odd to me.
>
>
> union - the extent (bounds) of the output will be the minimal
> rectangle that contains all the input extents.
>
> intersect - the extent (bounds) of the output will be the maximal
> rectangle that is contained in all the input extents.
>
> Shouldn't it be the other way around?

I think this *is* the right way round;
"all" can be misunderstood but I can not think of a clearer phrasing,
although "every one of" might help.

> As I intend to add this option to QGIS gdal_calc window (very useful
> option), I must be sure.

--
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk<mailto:andrew at aitchison.me.uk>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=dG%2BQVSiawyConLIg1vLJYu9P2pYZ2Y%2Bq2n0XqQ7ADO4%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/f87a3951/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 4315 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/f87a3951/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 3203 bytes
Desc: image002.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/f87a3951/attachment-0003.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.gif
Type: image/gif
Size: 33173 bytes
Desc: image005.gif
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/f87a3951/attachment-0001.gif>

From lnicola at dend.ro  Tue Oct 18 09:12:49 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Tue, 18 Oct 2022 19:12:49 +0300
Subject: [gdal-dev] [EXT] Re:  [Doc] gdal_calc.py extent option
In-Reply-To: <YT3PR01MB559094AB31CB61B400A040EB87289@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
 <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>
 <YT3PR01MB559094AB31CB61B400A040EB87289@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <5785c568-f001-40b5-a3a8-ebf47e7934c4@app.fastmail.com>

Hi Matt,

The definitions are correct. For the union you want a rectangle (or polygon) that's larger than the input, indeed. But you want the smallest of those rectangles, because there's an infinity of them. The larger ones would cover an arbitrary area of the plane (or the globe, if you want).

Same for the intersection. You want the largest polygon equal to or contained in the inputs. Otherwise a smaller answer could just as well be a single point (or empty), even in nondegenerate cases.

If you allow me a parallel to arithmetic, the least (sic) common multiple of 3 and 5 is 15, not 150.

Laurentiu

On Tue, Oct 18, 2022, at 18:46, Matt.Wilkie wrote:
> To my mind the outputs of Union should be the largest extent area and Intersect is the smallest extent area. However any explanation in words alone will always have some ambiguity. It can?t be avoided.
>  
> Union and Intersect via Wiki.GIS.com (I do find the intersect diagram less clear in this example than the next one):
> http://wiki.gis.com/wiki/images/thumb/2/28/Union.jpg/300px-Union.jpg
> http://wiki.gis.com/wiki/images/thumb/4/4e/Demo_one.JPG/300px-Demo_one.JPG
>  
> Union and Intersect in Wikipedia polygon theory:
>  
> 
>  
>  
> http://wiki.gis.com/wiki/index.php/Union
> https://en.wikipedia.org/wiki/Boolean_operations_on_polygons
>  
> -Matt**
>  
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Idan Miara
> *Sent:* October 17, 2022 1:55 AM
> *To:* Nicolas Godet <nicolas.godet at outlook.fr>
> *Cc:* Andrew C Aitchison <andrew at aitchison.me.uk>; gdal-dev at lists.osgeo.org
> *Subject:* [EXT] Re: [gdal-dev] [Doc] gdal_calc.py extent option
>  
> Hi! 
> I needed the docs are correct but as this is the second time it confuses people maybe the wording should be revised?
>  
> https://github.com/OSGeo/gdal/pull/5969 <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fpull%2F5969&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=qgiJYx5KjebSDNQrw4QJHhY%2FrntE1Pyxfn32x31xlus%3D&reserved=0>
>  
> Any ideas? 
>  
> On Mon, 17 Oct 2022, 11:49 Nicolas Godet, <nicolas.godet at outlook.fr> wrote:
>> Indeed, this is right.
>> My bad..
>> 
>> *De :* Andrew C Aitchison <andrew at aitchison.me.uk>
>> *Envoy? :* lundi 17 octobre 2022 10:25
>> *? :* Nicolas Godet <nicolas.godet at outlook.fr>
>> *Cc :* gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
>> *Objet :* Re: [gdal-dev] [Doc] gdal_calc.py extent option
>>  
>> On Mon, 17 Oct 2022, Nicolas Godet wrote:
>> 
>> > Dear Devs,
>> >
>> > In documentation<https://gdal.org/programs/gdal_calc.html#cmdoption-extent <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgdal.org%2Fprograms%2Fgdal_calc.html%23cmdoption-extent&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=ZQebVL1FblaUBIaZBYBsXHNJ0JfFm4nO8RzK2Gp4TZE%3D&reserved=0>>, extent param description seems a bit odd to me.
>> >
>> >
>> > union - the extent (bounds) of the output will be the minimal
>> > rectangle that contains all the input extents.
>> >
>> > intersect - the extent (bounds) of the output will be the maximal
>> > rectangle that is contained in all the input extents.
>> >
>> > Shouldn't it be the other way around?
>> 
>> I think this *is* the right way round;
>> "all" can be misunderstood but I can not think of a clearer phrasing,
>> although "every one of" might help.
>> 
>> > As I intend to add this option to QGIS gdal_calc window (very useful
>> > option), I must be sure.
>> 
>> -- 
>> Andrew C. Aitchison                      Kendal, UK
>>                     andrew at aitchison.me.uk
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://can01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7CMatt.Wilkie%40yukon.ca%7C8ec9f2c95b7c485d163508dab01d7941%7C98f515313973490abb70195aa264a2bc%7C0%7C0%7C638015937908111424%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&sdata=dG%2BQVSiawyConLIg1vLJYu9P2pYZ2Y%2Bq2n0XqQ7ADO4%3D&reserved=0>
>> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/14ff756b/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 4315 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/14ff756b/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 3203 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/14ff756b/attachment-0003.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.gif
Type: image/gif
Size: 33173 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221018/14ff756b/attachment-0001.gif>

From trygveas at met.no  Wed Oct 19 05:10:47 2022
From: trygveas at met.no (Trygve Aspenes)
Date: Wed, 19 Oct 2022 14:10:47 +0200
Subject: [gdal-dev] Fwd: OGR SQL dialect on FlatGeoBuf manipulating
 timestamps
In-Reply-To: <CACB19fTaqEmO_zNd__JSH9heLC8bPQGUZNW-WivNcRAogMvWKA@mail.gmail.com>
References: <CACB19fTaqEmO_zNd__JSH9heLC8bPQGUZNW-WivNcRAogMvWKA@mail.gmail.com>
Message-ID: <CACB19fSh0r_Y7dYT3bZP4eKrVcTkxaX=7DHGbEd4HHz1+htCsQ@mail.gmail.com>

Hi

I have some FlatGeoBuf files I have generated with the python fiona
library. This is a lat lon point and a timestamp. So I want to filter by
timestamp. What I have come up with is to use gdal sql dialect like this:

ogrinfo -sql "select * from flatgeobuf_demo where
TimeStamp>='2013-06-20T17:00:29Z'" flatgeobuf-data/*
INFO: Open of `flatgeobuf-data/points-20130620070000.fgb'
      using driver `FlatGeobuf' successful.
layer names ignored in combination with -sql.

Layer name: flatgeobuf_demo
Geometry: Point
Feature Count: 17
Extent: (-55.071900, -57.866400) - (58.263300, 51.737400)
Layer SRS WKT:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
Geometry Column = _ogr_geometry_
TimeStamp: String (0.0)
OGRFeature(flatgeobuf_demo):19
  TimeStamp (String) = 2013-06-20T17:00:29Z
  POINT (11.3157 -5.3703)
<truncated>

However what I want is to make a query with all points between one
timestamp and another. And here is my problem: the time parameters come
from a request query and have the format YYYY-mm-ddTHH:MM:SSZ. So I need a
way to say:

ogrinfo -sql "select * from flatgeobuf_demo where TimeStamp between
'2013-06-20T17:00:29Z' and '2013-06-20T17:00:29Z'+TimeInterval"
flatgeobuf-data/*

I could rewrite the flatgeobuf file setting TimeStamp as a float containing
the epoch instead. But then I can not convert the incoming query with the
time from my request( with fixed format)

Any idea if, and hopefully how, I can achieve this in OGR SQL?

Trygve Aspenes
--
Trygve Aspenes - Senioringeni?r/Senior Engineer
Fjernm?ling Utvikling/Remotesensing development  Telefon/Phone: 22963133
Fjernm?lingsavdelingen/Remotesensing department  Postboks 43, Blindern
Metklim                                          0313 OSLO
Meteorologisk Institutt
/Norwegian Meteorological Institute               NORWAY
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/11298b50/attachment.htm>

From trygveas at met.no  Wed Oct 19 11:16:57 2022
From: trygveas at met.no (Trygve Aspenes)
Date: Wed, 19 Oct 2022 20:16:57 +0200
Subject: [gdal-dev] OGR SQL dialect on FlatGeoBuf manipulating timestamps
In-Reply-To: <CACB19fSh0r_Y7dYT3bZP4eKrVcTkxaX=7DHGbEd4HHz1+htCsQ@mail.gmail.com>
References: <CACB19fTaqEmO_zNd__JSH9heLC8bPQGUZNW-WivNcRAogMvWKA@mail.gmail.com>
 <CACB19fSh0r_Y7dYT3bZP4eKrVcTkxaX=7DHGbEd4HHz1+htCsQ@mail.gmail.com>
Message-ID: <CACB19fTx4KX_Jbj5c3eV2wHh80fX=rYFiSjbVotbzfiEVe4A4A@mail.gmail.com>

OK, so this is a version thing. I upgraded the gdal version and the
following sqlite3 version 3.39.3 then unixepoch works(using the SQLITE
dialect)

ogrinfo -dialect SQLITE -sql "select * from li_flatgeobuf_demo where
unixepoch(TimeStamp) between unixepoch('2013-06-20T17:00:29Z') and
unixepoch('2013-06-20T17:00:29Z')+300" /data/mapserver/tile-index/*
INFO: Open of `/data/mapserver/tile-index/points-20130620070000.fgb'
      using driver `FlatGeobuf' successful.
layer names ignored in combination with -sql.

Layer name: SELECT
Geometry: Point
Feature Count: 17
Extent: (7.254900, -6.423300) - (58.263300, 51.656400)
Layer SRS WKT:
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
Geometry Column = GEOMETRY
TimeStamp: String (0.0)
OGRFeature(SELECT):0
  TimeStamp (String) = 2013-06-20T17:00:29Z
  POINT (11.3157 -5.3703)

Trygve Aspenes



ons. 19. okt. 2022 kl. 14:10 skrev Trygve Aspenes <trygveas at met.no>:

> Hi
>
> I have some FlatGeoBuf files I have generated with the python fiona
> library. This is a lat lon point and a timestamp. So I want to filter by
> timestamp. What I have come up with is to use gdal sql dialect like this:
>
> ogrinfo -sql "select * from flatgeobuf_demo where
> TimeStamp>='2013-06-20T17:00:29Z'" flatgeobuf-data/*
> INFO: Open of `flatgeobuf-data/points-20130620070000.fgb'
>       using driver `FlatGeobuf' successful.
> layer names ignored in combination with -sql.
>
> Layer name: flatgeobuf_demo
> Geometry: Point
> Feature Count: 17
> Extent: (-55.071900, -57.866400) - (58.263300, 51.737400)
> Layer SRS WKT:
> GEOGCRS["WGS 84",
>     ENSEMBLE["World Geodetic System 1984 ensemble",
>         MEMBER["World Geodetic System 1984 (Transit)"],
>         MEMBER["World Geodetic System 1984 (G730)"],
>         MEMBER["World Geodetic System 1984 (G873)"],
>         MEMBER["World Geodetic System 1984 (G1150)"],
>         MEMBER["World Geodetic System 1984 (G1674)"],
>         MEMBER["World Geodetic System 1984 (G1762)"],
>         ELLIPSOID["WGS 84",6378137,298.257223563,
>             LENGTHUNIT["metre",1]],
>         ENSEMBLEACCURACY[2.0]],
>     PRIMEM["Greenwich",0,
>         ANGLEUNIT["degree",0.0174532925199433]],
>     CS[ellipsoidal,2],
>         AXIS["geodetic latitude (Lat)",north,
>             ORDER[1],
>             ANGLEUNIT["degree",0.0174532925199433]],
>         AXIS["geodetic longitude (Lon)",east,
>             ORDER[2],
>             ANGLEUNIT["degree",0.0174532925199433]],
>     USAGE[
>         SCOPE["Horizontal component of 3D system."],
>         AREA["World."],
>         BBOX[-90,-180,90,180]],
>     ID["EPSG",4326]]
> Data axis to CRS axis mapping: 2,1
> Geometry Column = _ogr_geometry_
> TimeStamp: String (0.0)
> OGRFeature(flatgeobuf_demo):19
>   TimeStamp (String) = 2013-06-20T17:00:29Z
>   POINT (11.3157 -5.3703)
> <truncated>
>
> However what I want is to make a query with all points between one
> timestamp and another. And here is my problem: the time parameters come
> from a request query and have the format YYYY-mm-ddTHH:MM:SSZ. So I need a
> way to say:
>
> ogrinfo -sql "select * from flatgeobuf_demo where TimeStamp between
> '2013-06-20T17:00:29Z' and '2013-06-20T17:00:29Z'+TimeInterval"
> flatgeobuf-data/*
>
> I could rewrite the flatgeobuf file setting TimeStamp as a float
> containing the epoch instead. But then I can not convert the incoming query
> with the time from my request( with fixed format)
>
> Any idea if, and hopefully how, I can achieve this in OGR SQL?
>
> Trygve Aspenes
> --
> Trygve Aspenes - Senioringeni?r/Senior Engineer
> Fjernm?ling Utvikling/Remotesensing development  Telefon/Phone: 22963133
> Fjernm?lingsavdelingen/Remotesensing department  Postboks 43, Blindern
> Metklim                                          0313 OSLO
> Meteorologisk Institutt
> /Norwegian Meteorological Institute               NORWAY
>


-- 
Trygve Aspenes - Senioringeni?r/Senior Engineer
Fjernm?ling Utvikling/Remotesensing development  Telefon/Phone: 22963133
Fjernm?lingsavdelingen/Remotesensing department  Postboks 43, Blindern
Metklim                                          0313 OSLO
Meteorologisk Institutt
/Norwegian Meteorological Institute               NORWAY
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/0f816578/attachment.htm>

From Matt.Wilkie at yukon.ca  Wed Oct 19 13:00:44 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie)
Date: Wed, 19 Oct 2022 20:00:44 +0000
Subject: [gdal-dev] [EXT] Re: [EXT] Re: [Doc] gdal_calc.py extent option
In-Reply-To: <5785c568-f001-40b5-a3a8-ebf47e7934c4@app.fastmail.com>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
 <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>
 <YT3PR01MB559094AB31CB61B400A040EB87289@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
 <5785c568-f001-40b5-a3a8-ebf47e7934c4@app.fastmail.com>
Message-ID: <YT3PR01MB5590BCDD6551630E1D919376872B9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>

The definitions are correct. For the union you want a rectangle (or polygon) that's larger than the input, indeed. But you want the smallest of those rectangles, because there's an infinity of them. The larger ones would cover an arbitrary area of the plane (or the globe, if you want).

Same for the intersection. You want the largest polygon equal to or contained in the inputs. Otherwise a smaller answer could just as well be a single point (or empty), even in nondegenerate cases.

Please verify I?m parsing these words the way you intend. To me it sounds like you?re saying the labels for these figures should be reversed? (for gdal)

[cid:image003.png at 01D8E3BA.985DDCA0]


-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/0596fcae/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 17728 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/0596fcae/attachment-0001.png>

From idan at miara.com  Wed Oct 19 13:07:05 2022
From: idan at miara.com (Idan Miara)
Date: Wed, 19 Oct 2022 23:07:05 +0300
Subject: [gdal-dev] [EXT] Re: [EXT] Re: [Doc] gdal_calc.py extent option
In-Reply-To: <YT3PR01MB5590BCDD6551630E1D919376872B9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
References: <PA4P190MB1166201CD21A65AC12B865168F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <d62e814c-e315-8dbd-6f5-b628a3289119@aitchison.me.uk>
 <PA4P190MB1166BB379D9BE1D668F864118F299@PA4P190MB1166.EURP190.PROD.OUTLOOK.COM>
 <CADmqiFVgKZOq-R0u4Kw8q-5DdeqVtg4e2mRwEFAsmwNXPGSGRw@mail.gmail.com>
 <YT3PR01MB559094AB31CB61B400A040EB87289@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
 <5785c568-f001-40b5-a3a8-ebf47e7934c4@app.fastmail.com>
 <YT3PR01MB5590BCDD6551630E1D919376872B9@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>
Message-ID: <CADmqiFUpSso2KFrbGToUKsdKeiu7XTcV5zyKMOQtwwLGsVW8yg@mail.gmail.com>

Hi Matt,

No, we don't suggest they should be reversed.

If you look at the union, you could also make the minimal bounding box
bigger and it will still include the union, thus we dedine the union to be
the smallest of all bounding boxes that contains that blue figure.

Likewise, for the intersection, we would use the maximum bounding box that
still fully contained inside that blue area.

Idan.

On Wed, 19 Oct 2022, 23:00 Matt.Wilkie, <Matt.Wilkie at yukon.ca> wrote:

> *The definitions are correct. For the union you want a rectangle (or
> polygon) that's larger than the input, indeed. But you want the smallest of
> those rectangles, because there's an infinity of them. The larger ones
> would cover an arbitrary area of the plane (or the globe, if you want).*
>
>
>
> *Same for the intersection. You want the largest polygon equal to or
> contained in the inputs. Otherwise a smaller answer could just as well be a
> single point (or empty), even in nondegenerate cases.*
>
>
>
> Please verify I?m parsing these words the way you intend. To me it sounds
> like you?re saying the labels for these figures should be reversed? (for
> gdal)
>
>
>
>
>
>
>
> -Matt
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/290ec152/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 17728 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221019/290ec152/attachment-0001.png>

From dmburgess at linktechs.net  Thu Oct 20 05:06:53 2022
From: dmburgess at linktechs.net (Dennis Burgess)
Date: Thu, 20 Oct 2022 12:06:53 +0000
Subject: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
Message-ID: <f82524403284465699eca38c84561008@linktechs.net>

We have a large table in MSSQL, this table we extract data from and drop it into a GeoPackage for further processing.  However, the extraction can take some time, its only using 5% of the CPU available, and pulling the data is fairly quick in debug mode, its really its generation and index creation that is slow.  Any tips on speeding this up?  We have SSDs and NVME drives, 10gig networking etc..  So.  It should be as quick as it can be, but the 5% CPU is what I think the killer is.  On this server 24 cores, so 5% would be right at one core..  Is there no multi-threading or other options here?


[LTI-Full_175px]
Dennis Burgess, Mikrotik Certified Trainer
MTCNA, MTCRE, MTCWE, MTCTCE, MTCINE, MTCSE, HE IPv6 Sage, Cambium ePMP Certified
Author of "Learn RouterOS- Second Edition"
Link Technologies, Inc -- Mikrotik & WISP Support Services
Office: 314-735-0270  Website: http://www.linktechs.net<http://www.linktechs.net/>
Need to Automate MikroTik Backups:  https://cloud.linktechs.net
Create Wireless Coverage's with www.towercoverage.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/986b50f1/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4424 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/986b50f1/attachment.png>

From lnicola at dend.ro  Thu Oct 20 06:08:30 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 20 Oct 2022 16:08:30 +0300
Subject: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
In-Reply-To: <f82524403284465699eca38c84561008@linktechs.net>
References: <f82524403284465699eca38c84561008@linktechs.net>
Message-ID: <39d1d12b-3a9d-42b9-b2c1-d7ccb094e25e@betaapp.fastmail.com>

Hi,

https://gdal.org/drivers/vector/gpkg.html#configuration-options has a couple of options that can help with performance. See also https://gdal.org/drivers/vector/sqlite.html#target-drivers-vector-sqlite-performance-hints.

But I don't recall them helping that much. YMMV.

Regards,
Laurentiu

On Thu, Oct 20, 2022, at 15:06, Dennis Burgess wrote:
> We have a large table in MSSQL, this table we extract data from and drop it into a GeoPackage for further processing.  However, the extraction can take some time, its only using 5% of the CPU available, and pulling the data is fairly quick in debug mode, its really its generation and index creation that is slow.  Any tips on speeding this up?  We have SSDs and NVME drives, 10gig networking etc..  So.  It should be as quick as it can be, but the 5% CPU is what I think the killer is.  On this server 24 cores, so 5% would be right at one core..  Is there no multi-threading or other options here? 
>  
>  
> *LTI-Full_175px*
> *Dennis Burgess, Mikrotik Certified Trainer
> MTCNA, MTCRE, MTCWE, MTCTCE, MTCINE, MTCSE, HE IPv6 Sage, Cambium ePMP Certified*
> Author of "Learn RouterOS- Second Edition?
> *Link Technologies, Inc* -- Mikrotik & WISP Support Services
> *Office*: 314-735-0270  Website: http://www.linktechs.net
> Need to Automate MikroTik Backups:  https://cloud.linktechs.net
> Create Wireless Coverage?s with www.towercoverage.com
>  
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/6d3ecfcb/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4424 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/6d3ecfcb/attachment-0001.png>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 20 06:26:07 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 20 Oct 2022 13:26:07 +0000
Subject: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
In-Reply-To: <f82524403284465699eca38c84561008@linktechs.net>
References: <f82524403284465699eca38c84561008@linktechs.net>
Message-ID: <AM0PR09MB3219A13E037FA4834FB26FE1FD2A9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

There are some performance hints in https://gdal.org/drivers/vector/sqlite.html#target-drivers-vector-sqlite-performance-hints but everything in SQLite is stored into one single file that must have a proper organization all the time and that inevitably sets some limits. Ogr2ogr is made to use automatically the most obvious tricks for increasing the performance, like creating a new table first and indexing it afterwards. You may find other hints from SQLite forums, for example this looks interesting https://stackoverflow.com/questions/1711631/improve-insert-per-second-performance-of-sqlite but some tricks like "without_rowid" cannot be used for GeoPackage because the GeoPackage standard does not allow that.

If would help to evaluate if the speed that you have now is reasonable or not if you could provide some metrics like inserted features or megabytes per second.

-Jukka Rahkonen-



L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Dennis Burgess
L?hetetty: torstai 20. lokakuuta 2022 15.07
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation

We have a large table in MSSQL, this table we extract data from and drop it into a GeoPackage for further processing.  However, the extraction can take some time, its only using 5% of the CPU available, and pulling the data is fairly quick in debug mode, its really its generation and index creation that is slow.  Any tips on speeding this up?  We have SSDs and NVME drives, 10gig networking etc..  So.  It should be as quick as it can be, but the 5% CPU is what I think the killer is.  On this server 24 cores, so 5% would be right at one core..  Is there no multi-threading or other options here?


[LTI-Full_175px]
Dennis Burgess, Mikrotik Certified Trainer
MTCNA, MTCRE, MTCWE, MTCTCE, MTCINE, MTCSE, HE IPv6 Sage, Cambium ePMP Certified
Author of "Learn RouterOS- Second Edition"
Link Technologies, Inc -- Mikrotik & WISP Support Services
Office: 314-735-0270  Website: http://www.linktechs.net<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.linktechs.net%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cdefc186c65ee4c75330708dab2977a8d%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638018660925600304%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=J1OWaQUH7p7F%2FpaPKRKFPoPwGwRadewZKRv%2FlRYV%2BUw%3D&reserved=0>
Need to Automate MikroTik Backups:  https://cloud.linktechs.net<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcloud.linktechs.net%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cdefc186c65ee4c75330708dab2977a8d%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638018660925600304%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=B5Mke%2F1KVgT8wTbp2tVo2eoyvE60qhDyzqdEpZCASCM%3D&reserved=0>
Create Wireless Coverage's with www.towercoverage.com<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.towercoverage.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cdefc186c65ee4c75330708dab2977a8d%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638018660925600304%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=E9o9%2BFk9OXa6LWRCm50qpZGWLne6ecTPOJ9ZWwmc6eQ%3D&reserved=0>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/789d6a05/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4424 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/789d6a05/attachment.png>

From Michael.Reetz at nlpvw.niedersachsen.de  Thu Oct 20 07:11:07 2022
From: Michael.Reetz at nlpvw.niedersachsen.de (Reetz, Michael (NLPV))
Date: Thu, 20 Oct 2022 14:11:07 +0000
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
Message-ID: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>

Dear members of the GDAL-DEV group,

we are using MS SQL Server 2019 as basis for Geoserver and GIS software. There are a lot of tables that have attributes of the types geometry and/or geography. I can load these tables into QGIS (3.22.8) projects without any problems.

Now I'm asked to add an geography attribute to one table that has already an geometry attribute and populate it with coordinates by transforming the geometry values. I've found code how to do this with ogr2ogr here:

https://social.msdn.microsoft.com/Forums/sqlserver/en-US/335d3f6b-11f4-4e02-8d6d-b49cb59ed98d/using-ogr2ogr-to-reproject-within-a-sql-table?forum=sqlspatial


Since ogr2ogr is part of the OSGeo4W Shell installed with QGIS, I've tried to run this command there.

ogr2ogr -f "MSSQLSpatial" "MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;" "MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;" -sql "SELECT <my attributes>, GEOM.STAsBinary(), WGS84 FROM <my table>" -s_srs "EPSG:25832" -t_srs "EPSG:4326" -update -lco "GEOM_TYPE=geography" -lco "GEOM_NAME=WGS84" -nln "<my table>"

But I receive the error message:

"Unable to open datasource `MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;' with the following drivers. ..."

MSSQLSpatial is not listed.


I've tried some other commands but all with MSSQL in it leads to an error.

Any idea what I can do to make it run?

Thanks in advance and best regards,

Michael


Mit freundlichen Gr??en
Im Auftrag

Michael Reetz

*****************************************
Michael Reetz
Datenbanken und Anwendungsentwicklung
Nationalpark-Verwaltung Nieders?chsisches Wattenmeer
Virchowstr. 1 | 26382 Wilhelmshaven
Tel.: +49 (0) 4421 911 291
e-mail: michael.reetz at nlpvw.niedersachsen.de<mailto:michael.reetz at nlpv-wattenmeer.niedersachsen.de>
Web: https://www.<https://www./>nationalpark-wattenmeer.de
[cid:image001.png at 01D8E49E.8F2A2820]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/adbeae2f/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 6534 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/adbeae2f/attachment-0001.png>

From pedrongvenancio at gmail.com  Thu Oct 20 07:31:05 2022
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Thu, 20 Oct 2022 15:31:05 +0100
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
Message-ID: <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>

Michael,

Check if you have gdal-mss and msodbcsql libs installed, like here:
https://github.com/PedroVenancio/export_to_sql_server/issues/2#issuecomment-1240675079

Best regards,
Pedro



Reetz, Michael (NLPV) <Michael.Reetz at nlpvw.niedersachsen.de> escreveu no
dia quinta, 20/10/2022 ?(s) 15:13:

> Dear members of the GDAL-DEV group,
>
>
>
> we are using MS SQL Server 2019 as basis for Geoserver and GIS software.
> There are a lot of tables that have attributes of the types geometry and/or
> geography. I can load these tables into QGIS (3.22.8) projects without any
> problems.
>
>
>
> Now I?m asked to add an geography attribute to one table that has already
> an geometry attribute and populate it with coordinates by transforming the
> geometry values. I?ve found code how to do this with ogr2ogr here:
>
>
>
>
> https://social.msdn.microsoft.com/Forums/sqlserver/en-US/335d3f6b-11f4-4e02-8d6d-b49cb59ed98d/using-ogr2ogr-to-reproject-within-a-sql-table?forum=sqlspatial
>
>
>
>
>
> Since ogr2ogr is part of the OSGeo4W Shell installed with QGIS, I?ve tried
> to run this command there.
>
>
>
> ogr2ogr -f "MSSQLSpatial" "MSSQL:server=<my server IP>;driver=ODBC Driver
> 17 for SQL Server;database=<my database>;trusted_connection=yes;"
> "MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL
> Server;database=<my database>;trusted_connection=yes;" -sql "SELECT <my
> attributes>, GEOM.STAsBinary(), WGS84 FROM <my table>" -s_srs "EPSG:25832"
> -t_srs "EPSG:4326" -update -lco "GEOM_TYPE=geography" -lco
> "GEOM_NAME=WGS84" -nln "<my table>"
>
>
>
> But I receive the error message:
>
>
>
> ?Unable to open datasource `MSSQL:server=<my server IP>;driver=ODBC Driver
> 17 for SQL Server;database=<my database>;trusted_connection=yes;' with the
> following drivers. ??
>
>
>
> MSSQLSpatial is not listed.
>
>
>
>
>
> I?ve tried some other commands but all with MSSQL in it leads to an error.
>
>
>
> Any idea what I can do to make it run?
>
>
>
> Thanks in advance and best regards,
>
>
>
> Michael
>
>
>
>
>
> Mit freundlichen Gr??en
>
> Im Auftrag
>
>
>
> Michael Reetz
>
>
>
> *****************************************
>
> Michael Reetz
>
> Datenbanken und Anwendungsentwicklung
> Nationalpark-Verwaltung Nieders?chsisches Wattenmeer
> Virchowstr. 1 | 26382 Wilhelmshaven
> Tel.: +49 (0) 4421 911 291
> e-mail: michael.reetz at nlpvw.niedersachsen.de
> <michael.reetz at nlpv-wattenmeer.niedersachsen.de>
> Web: https://www.*nationalpark-wattenmeer.de
> <http://nationalpark-wattenmeer.de>*
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/54a67d01/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 6534 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/54a67d01/attachment.png>

From Michael.Reetz at nlpvw.niedersachsen.de  Thu Oct 20 07:56:51 2022
From: Michael.Reetz at nlpvw.niedersachsen.de (Reetz, Michael (NLPV))
Date: Thu, 20 Oct 2022 14:56:51 +0000
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
 <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
Message-ID: <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>

Hi Pedro,

I?ve found msodbcsql17.dll in C:\Program Files\QGIS 3.22.8\bin\1033 and C:\Program Files\QGIS 3.22.8\bin.
Gdal-mss seems not to be on my computer. But since SQL Server Native Client isn?t supported by MS SQL Server 2019 , this shouldn?t be a Problem.

I have only the OSGeo4W Shell shipped installed with QGIS. So, the nice setup frontend is missing.

Best regards

Michael

Von: Pedro Ven?ncio <pedrongvenancio at gmail.com>
Gesendet: Donnerstag, 20. Oktober 2022 16:31
An: Reetz, Michael (NLPV) <Michael.Reetz at nlpvw.niedersachsen.de>
Cc: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server


ACHTUNG!! Diese E-Mail erreicht Sie von einem Absender au?erhalb der nieders?chsischen Landesverwaltungs-Infrastruktur mit TLS-Verschl?sselung. Bitte klicken Sie auf keine Links oder ?ffnen Sie keine E-Mail-Anh?nge, falls Sie den Absender nicht kennen und nicht wissen, ob der Inhalt sicher ist.
Michael,

Check if you have gdal-mss and msodbcsql libs installed, like here: https://github.com/PedroVenancio/export_to_sql_server/issues/2#issuecomment-1240675079

Best regards,
Pedro



Reetz, Michael (NLPV) <Michael.Reetz at nlpvw.niedersachsen.de<mailto:Michael.Reetz at nlpvw.niedersachsen.de>> escreveu no dia quinta, 20/10/2022 ?(s) 15:13:
Dear members of the GDAL-DEV group,

we are using MS SQL Server 2019 as basis for Geoserver and GIS software. There are a lot of tables that have attributes of the types geometry and/or geography. I can load these tables into QGIS (3.22.8) projects without any problems.

Now I?m asked to add an geography attribute to one table that has already an geometry attribute and populate it with coordinates by transforming the geometry values. I?ve found code how to do this with ogr2ogr here:

https://social.msdn.microsoft.com/Forums/sqlserver/en-US/335d3f6b-11f4-4e02-8d6d-b49cb59ed98d/using-ogr2ogr-to-reproject-within-a-sql-table?forum=sqlspatial


Since ogr2ogr is part of the OSGeo4W Shell installed with QGIS, I?ve tried to run this command there.

ogr2ogr -f "MSSQLSpatial" "MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;" "MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;" -sql "SELECT <my attributes>, GEOM.STAsBinary(), WGS84 FROM <my table>" -s_srs "EPSG:25832" -t_srs "EPSG:4326" -update -lco "GEOM_TYPE=geography" -lco "GEOM_NAME=WGS84" -nln "<my table>"

But I receive the error message:

?Unable to open datasource `MSSQL:server=<my server IP>;driver=ODBC Driver 17 for SQL Server;database=<my database>;trusted_connection=yes;' with the following drivers. ??

MSSQLSpatial is not listed.


I?ve tried some other commands but all with MSSQL in it leads to an error.

Any idea what I can do to make it run?

Thanks in advance and best regards,

Michael


Mit freundlichen Gr??en
Im Auftrag

Michael Reetz

*****************************************
Michael Reetz
Datenbanken und Anwendungsentwicklung
Nationalpark-Verwaltung Nieders?chsisches Wattenmeer
Virchowstr. 1 | 26382 Wilhelmshaven
Tel.: +49 (0) 4421 911 291
e-mail: michael.reetz at nlpvw.niedersachsen.de<mailto:michael.reetz at nlpv-wattenmeer.niedersachsen.de>
Web: https://www.<https://www./>nationalpark-wattenmeer.de<http://nationalpark-wattenmeer.de>
[cid:image001.png at 01D8E4A4.399CB390]

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/0f617a06/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 6534 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/0f617a06/attachment-0001.png>

From andreaerdna at libero.it  Thu Oct 20 09:36:02 2022
From: andreaerdna at libero.it (Andrea Giudiceandrea)
Date: Thu, 20 Oct 2022 18:36:02 +0200
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
 <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
 <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>
Message-ID: <84435467-4cbe-b901-c670-63ad58d8be63@libero.it>

Hi Michael,
the GDAL/OGR library needs the "ogr_MSSQLSpatial.dll" file to properly 
activate the MSSQLSpatial GDAL/OGR driver ("MSSQL:").

You can check if the MSSQLSpatial GDAL/OGR driver is supported by your 
ogr2ogr tool using the following command in the OSGeo4W Shell:

ogr2ogr --formats | find "MSSQL"

If it outputs the string "MSSQLSpatial -vector- (rw+): Microsoft SQL 
Server Spatial Database (BCP)", then it means such driver is supported, 
otherwise not.

If you cannot use the OSGeo4W "Setup" program to install such file, you 
can try to fix the issue just downloading the "gdal-mss" OSGeo4W package 
from [1] and extracting from it the "ogr_MSSQLSpatial.dll" file to the 
"\apps\gdal\lib\gdalplugins\" folder in your QGIS installation dir.
The exact "gdal-mss" OSGeo4W package to download depends on the exact 
GDAL version installed with QGIS.

Best regards.

[1] 
https://download.osgeo.org/osgeo4w/v2/x86_64/release/gdal/gdal-mss/?C=M&O=D


Il 20/10/2022 16:56, Reetz, Michael (NLPV) ha scritto:
>
> I?ve found msodbcsql17.dll in C:\Program Files\QGIS 3.22.8\bin\1033 
> and C:\Program Files\QGIS 3.22.8\bin.
>
> Gdal-mss seems not to be on my computer. But since SQL Server Native 
> Client isn?t supported by MS SQL Server 2019 , this shouldn?t be a 
> Problem.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/9a1bc397/attachment.htm>

From jonas.ardo at nateko.lu.se  Thu Oct 20 11:06:34 2022
From: jonas.ardo at nateko.lu.se (=?UTF-8?Q?Jonas_Ard=c3=b6?=)
Date: Thu, 20 Oct 2022 20:06:34 +0200
Subject: [gdal-dev] gdal_calc output to multiband nedcdf ?
Message-ID: <a229d640-7d69-f88c-3455-bfe01cf952c1@nateko.lu.se>

Dear gdal-gurus,

Trying to use*gdal_calc* to? do the same calculation for tow 366 band 
(daily data) files and store it in a *.nc file with the same dimensions 
as the input files.

This works OK (output to 366 tiff files):
for i in {1..366} # One band per day output to tif
do
 ? gdal_calc.py?? --calc="exp( (17.625*D) /(243.04+D) ) / exp( 
(17.625*T)/(243.04+T) ) * 100" --outfile=Rh_2020_day$i.tif -D 
DPTa_dayavg_C_2020.nc -T Ta_dayavg_C_2020.nc? --D_band=$i --T_band=$i
done


This do not work (output to one netcdf file):
for i in {1..366} # One band per day output to tif
do
 ? gdal_calc.py?? --calc="exp( (17.625*D) /(243.04+D) ) / exp( 
(17.625*T)/(243.04+T) ) * 100" --outfile=Rh_2020.nc -D 
DPTa_dayavg_C_2020.nc -T Ta_dayavg_C_2020.nc? --D_band=$i --T_band=$i
done

yields:
Error! Output exists, but is the wrong geotransform.? Use the 
--overwrite option to automatically overwrite the existing file
Error! Output exists, but is the wrong geotransform.? Use the 
--overwrite option to automatically overwrite the existing file

Any suggestions how to make the output into a 366-band netcdf file?

using on Cygwin: gdalinfo.exe --version GDAL 3.5.1, released 2022/06/30 
Regards /Jonas, Lund University, Sweden
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/972147e5/attachment.htm>

From lnicola at dend.ro  Thu Oct 20 11:26:28 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 20 Oct 2022 21:26:28 +0300
Subject: [gdal-dev] gdal_calc output to multiband nedcdf ?
In-Reply-To: <a229d640-7d69-f88c-3455-bfe01cf952c1@nateko.lu.se>
References: <a229d640-7d69-f88c-3455-bfe01cf952c1@nateko.lu.se>
Message-ID: <0c859c94-4c07-4e46-81fa-7243c9ddf14a@app.fastmail.com>

Hello,

I've never tried it, but I believe you can describe some computations in a VRT. But gdal_calc can't do this, so you'd need to write the VRT directly as XML. That's probably not much easier than writing some Python or C++ to perform the same computation.

Laurentiu

On Thu, Oct 20, 2022, at 21:06, Jonas Ard? via gdal-dev wrote:
> Dear gdal-gurus,
> 
> Trying to use* gdal_calc* to  do the same calculation for tow 366 band (daily data) files and store it in a *.nc file with the same dimensions as the input files. 
> 
> This works OK (output to 366 tiff files):
> for i in {1..366} # One band per day output to tif
> do
>   gdal_calc.py   --calc="exp( (17.625*D) /(243.04+D) ) / exp( (17.625*T)/(243.04+T) ) * 100" --outfile=Rh_2020_day$i.tif -D DPTa_dayavg_C_2020.nc -T Ta_dayavg_C_2020.nc  --D_band=$i --T_band=$i
> done
> 
> 
> This do not work (output to one netcdf file):
> for i in {1..366} # One band per day output to tif
> do
>   gdal_calc.py   --calc="exp( (17.625*D) /(243.04+D) ) / exp( (17.625*T)/(243.04+T) ) * 100" --outfile=Rh_2020.nc -D DPTa_dayavg_C_2020.nc -T Ta_dayavg_C_2020.nc  --D_band=$i --T_band=$i
> done
> 
> yields:
> Error! Output exists, but is the wrong geotransform.  Use the --overwrite option to automatically overwrite the existing file
> Error! Output exists, but is the wrong geotransform.  Use the --overwrite option to automatically overwrite the existing file
> 
> Any suggestions how to make the output into a 366-band netcdf file?
> using on Cygwin:
> gdalinfo.exe --version
> GDAL 3.5.1, released 2022/06/30
> 
> Regards
> /Jonas, Lund University, Sweden
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/071cfc27/attachment.htm>

From jgr at osgeopt.pt  Thu Oct 20 11:35:53 2022
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Thu, 20 Oct 2022 19:35:53 +0100
Subject: [gdal-dev] ogr SSL errors on ubuntu
Message-ID: <c432ec87-4d12-dd86-ff73-553e907a24f5@osgeopt.pt>

Hi,

Lately, I have problems opening some datasets using ogr2ogr or ogrinfo 
due to SSL errors.

I think others tools like curl had the same kind of problems, but now 
they seem to work well.

Problems with ogr
=================

Example (GDAL 3.6.0dev-f033e1fa1e, released 2022/08/04):

ogrinfo 
'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'

ERROR 1: OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof 
while reading, errno 0

Example (GDAL 3.4.3, released 2022/04/22):

ogrinfo 
'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'

ERROR 1: GnuTLS recv error (-110): The TLS connection was non-properly 
terminated.

maybe related: https://github.com/openssl/openssl/issues/18574

Has someone a nice workaround? Do we need to change ogr code to handle this?

Regards,

Jorge
-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Pr?ximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informa??es: http://osgeopt.pt/sasig2017/

From chaitanya.ch at gmail.com  Thu Oct 20 12:13:51 2022
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri, 21 Oct 2022 00:43:51 +0530
Subject: [gdal-dev] Python API docs
Message-ID: <CAMKgpOZcG9MqNPUPP0KN0mxFnQ0z9NXPUSY14vycUP76Okgpvw@mail.gmail.com>

Hi all,

Does anyone know where the python api docs are moved? I can't find them at "
gdal.org/python".
Thank you

Best regards,
Chaitanya Kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/70ca79e7/attachment.htm>

From alansnow21 at gmail.com  Thu Oct 20 12:16:55 2022
From: alansnow21 at gmail.com (Alan Snow)
Date: Thu, 20 Oct 2022 14:16:55 -0500
Subject: [gdal-dev] Python API docs
In-Reply-To: <CAMKgpOZcG9MqNPUPP0KN0mxFnQ0z9NXPUSY14vycUP76Okgpvw@mail.gmail.com>
References: <CAMKgpOZcG9MqNPUPP0KN0mxFnQ0z9NXPUSY14vycUP76Okgpvw@mail.gmail.com>
Message-ID: <CAGybdFR6Gq+4EO1PDMfyVH40eMc3qdPVQORyTU=bEtwKNu9-DQ@mail.gmail.com>

They are now here: https://gdal.org/api/python/osgeo.html

On Thu, Oct 20, 2022, 2:14 PM Chaitanya kumar CH <chaitanya.ch at gmail.com>
wrote:

> Hi all,
>
> Does anyone know where the python api docs are moved? I can't find them at
> "gdal.org/python".
> Thank you
>
> Best regards,
> Chaitanya Kumar CH.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/b09d11f8/attachment.htm>

From even.rouault at spatialys.com  Thu Oct 20 12:17:51 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2022 21:17:51 +0200
Subject: [gdal-dev] Python API docs
In-Reply-To: <CAMKgpOZcG9MqNPUPP0KN0mxFnQ0z9NXPUSY14vycUP76Okgpvw@mail.gmail.com>
References: <CAMKgpOZcG9MqNPUPP0KN0mxFnQ0z9NXPUSY14vycUP76Okgpvw@mail.gmail.com>
Message-ID: <393a3b2d-c285-f307-5472-eba01a4f4bdb@spatialys.com>

https://gdal.org/api/python/osgeo.html

Le 20/10/2022 ? 21:13, Chaitanya kumar CH a ?crit?:
> Hi all,
>
> Does anyone know where the python api docs are moved? I can't find 
> them at "gdal.org/python <http://gdal.org/python>".
> Thank you
>
> Best regards,
> Chaitanya Kumar CH.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221020/3ac566e4/attachment.htm>

From even.rouault at spatialys.com  Thu Oct 20 12:58:11 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2022 21:58:11 +0200
Subject: [gdal-dev] ogr SSL errors on ubuntu
In-Reply-To: <c432ec87-4d12-dd86-ff73-553e907a24f5@osgeopt.pt>
References: <c432ec87-4d12-dd86-ff73-553e907a24f5@osgeopt.pt>
Message-ID: <c8d131ae-45db-ca81-fa20-858b510a9293@spatialys.com>

Jorge,

Fix/workaround and links to related issues in 
https://github.com/OSGeo/gdal/pull/6561

The curl binary manages to ignore that, but I couldn't easily spot 
how/where in its source code.

The difference in errors are due to your curl versions using different 
backends: gnutls vs openssl.

Even

Le 20/10/2022 ? 20:35, Jorge Gustavo Rocha a ?crit?:
> Hi,
>
> Lately, I have problems opening some datasets using ogr2ogr or ogrinfo 
> due to SSL errors.
>
> I think others tools like curl had the same kind of problems, but now 
> they seem to work well.
>
> Problems with ogr
> =================
>
> Example (GDAL 3.6.0dev-f033e1fa1e, released 2022/08/04):
>
> ogrinfo 
> 'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'
>
> ERROR 1: OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof 
> while reading, errno 0
>
> Example (GDAL 3.4.3, released 2022/04/22):
>
> ogrinfo 
> 'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'
>
> ERROR 1: GnuTLS recv error (-110): The TLS connection was non-properly 
> terminated.
>
> maybe related: https://github.com/openssl/openssl/issues/18574
>
> Has someone a nice workaround? Do we need to change ogr code to handle 
> this?
>
> Regards,
>
> Jorge

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jgr at osgeopt.pt  Thu Oct 20 15:00:53 2022
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Thu, 20 Oct 2022 23:00:53 +0100
Subject: [gdal-dev] ogr SSL errors on ubuntu
In-Reply-To: <c8d131ae-45db-ca81-fa20-858b510a9293@spatialys.com>
References: <c432ec87-4d12-dd86-ff73-553e907a24f5@osgeopt.pt>
 <c8d131ae-45db-ca81-fa20-858b510a9293@spatialys.com>
Message-ID: <3a04f000-91e1-1af9-820f-e9a3d95a3422@osgeopt.pt>

Hi Even,

Thank you so much for addressing this issue in so short time.

I've checked out your pr. It runs fine on my side.

Regards,

Jorge

On 20/10/22 20:58, Even Rouault wrote:
> Jorge,
> 
> Fix/workaround and links to related issues in 
> https://github.com/OSGeo/gdal/pull/6561
> 
> The curl binary manages to ignore that, but I couldn't easily spot 
> how/where in its source code.
> 
> The difference in errors are due to your curl versions using different 
> backends: gnutls vs openssl.
> 
> Even
> 
> Le 20/10/2022 ? 20:35, Jorge Gustavo Rocha a ?crit?:
>> Hi,
>>
>> Lately, I have problems opening some datasets using ogr2ogr or ogrinfo 
>> due to SSL errors.
>>
>> I think others tools like curl had the same kind of problems, but now 
>> they seem to work well.
>>
>> Problems with ogr
>> =================
>>
>> Example (GDAL 3.6.0dev-f033e1fa1e, released 2022/08/04):
>>
>> ogrinfo 
>> 'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'
>>
>> ERROR 1: OpenSSL SSL_read: error:0A000126:SSL routines::unexpected eof 
>> while reading, errno 0
>>
>> Example (GDAL 3.4.3, released 2022/04/22):
>>
>> ogrinfo 
>> 'https://wssig3.azores.gov.pt/geoserver/ows?service=WFS&version=2.0.0&request=GetFeature&typename=ge:GE.Borehole&outputFormat=application/json&EXCEPTIONS=application/json&srsname=EPSG:5013'
>>
>> ERROR 1: GnuTLS recv error (-110): The TLS connection was non-properly 
>> terminated.
>>
>> maybe related: https://github.com/openssl/openssl/issues/18574
>>
>> Has someone a nice workaround? Do we need to change ogr code to handle 
>> this?
>>
>> Regards,
>>
>> Jorge
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Pr?ximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informa??es: http://osgeopt.pt/sasig2017/

From Michael.Reetz at nlpvw.niedersachsen.de  Fri Oct 21 02:48:24 2022
From: Michael.Reetz at nlpvw.niedersachsen.de (Reetz, Michael (NLPV))
Date: Fri, 21 Oct 2022 09:48:24 +0000
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <84435467-4cbe-b901-c670-63ad58d8be63@libero.it>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
 <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
 <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>
 <84435467-4cbe-b901-c670-63ad58d8be63@libero.it>
Message-ID: <d5cd7f9bb6344a4eb8e6d76b55cb00bc@nlpvw.niedersachsen.de>

Hello Andrea and all,



thank you all for your help. I could solve my problem with the field calculator and the command J?rgen sent me in the QGIS user group.



Since the GDAL/ogr MS SQL Server driver is obviously missing on my computer, I will see if I can get a complete installation of the current GDAL package. This would be very helpful in many situations, especially in scripts that perform transformation tasks.



Best regards



Michael


Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von Andrea Giudiceandrea via gdal-dev
Gesendet: Donnerstag, 20. Oktober 2022 18:36
An: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server


ACHTUNG!! Diese E-Mail erreicht Sie von einem Absender au?erhalb der nieders?chsischen Landesverwaltungs-Infrastruktur mit TLS-Verschl?sselung. Bitte klicken Sie auf keine Links oder ?ffnen Sie keine E-Mail-Anh?nge, falls Sie den Absender nicht kennen und nicht wissen, ob der Inhalt sicher ist.
Hi Michael,
the GDAL/OGR library needs the "ogr_MSSQLSpatial.dll" file to properly activate the MSSQLSpatial GDAL/OGR driver ("MSSQL:").

You can check if the MSSQLSpatial GDAL/OGR driver is supported by your ogr2ogr tool using the following command in the OSGeo4W Shell:

ogr2ogr --formats | find "MSSQL"

If it outputs the string "MSSQLSpatial -vector- (rw+): Microsoft SQL Server Spatial Database (BCP)", then it means such driver is supported, otherwise not.

If you cannot use the OSGeo4W "Setup" program to install such file, you can try to fix the issue just downloading the "gdal-mss" OSGeo4W package from [1] and extracting from it the "ogr_MSSQLSpatial.dll" file to the "\apps\gdal\lib\gdalplugins\" folder in your QGIS installation dir.
The exact "gdal-mss" OSGeo4W package to download depends on the exact GDAL version installed with QGIS.

Best regards.

[1] https://download.osgeo.org/osgeo4w/v2/x86_64/release/gdal/gdal-mss/?C=M&O=D

Il 20/10/2022 16:56, Reetz, Michael (NLPV) ha scritto:
I?ve found msodbcsql17.dll in C:\Program Files\QGIS 3.22.8\bin\1033 and C:\Program Files\QGIS 3.22.8\bin.
Gdal-mss seems not to be on my computer. But since SQL Server Native Client isn?t supported by MS SQL Server 2019 , this shouldn?t be a Problem.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/a64a1c69/attachment-0001.htm>

From andreaerdna at libero.it  Fri Oct 21 03:11:50 2022
From: andreaerdna at libero.it (Andrea Giudiceandrea)
Date: Fri, 21 Oct 2022 12:11:50 +0200
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <d5cd7f9bb6344a4eb8e6d76b55cb00bc@nlpvw.niedersachsen.de>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
 <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
 <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>
 <84435467-4cbe-b901-c670-63ad58d8be63@libero.it>
 <d5cd7f9bb6344a4eb8e6d76b55cb00bc@nlpvw.niedersachsen.de>
Message-ID: <c866a22b-f2e8-8152-ddfa-66f4d46f3c66@libero.it>

Il 21/10/2022 11:48, Reetz, Michael (NLPV) ha scritto:
> Since the GDAL/ogr MS SQL Server driver is obviously missing on my 
> computer, I will see if I can get a complete installation of the 
> current GDAL package. This would be very helpful in many situations, 
> especially in scripts that perform transformation tasks.

Hi Michael,
doesn't adding the ogr_MSSQLSpatial.dll file to the 
"\apps\gdal\lib\gdalplugins\" folder (or installing the gdal-mss package 
through OSGeo4W Setup) makes the MSSQLSpatial GDAL/OGR driver available 
to be used with ogr2ogr?

Best regards.

Andrea
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/54eb7a1a/attachment.htm>

From lnicola at dend.ro  Fri Oct 21 05:21:18 2022
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Fri, 21 Oct 2022 15:21:18 +0300
Subject: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
In-Reply-To: <4d8d23848d4a4872b063effe8de9b1bd@linktechs.net>
References: <f82524403284465699eca38c84561008@linktechs.net>
 <39d1d12b-3a9d-42b9-b2c1-d7ccb094e25e@betaapp.fastmail.com>
 <4d8d23848d4a4872b063effe8de9b1bd@linktechs.net>
Message-ID: <53faa10c-1da1-4dd0-88cd-39f0bc67dab0@app.fastmail.com>

It is single-threaded (AFAIK), but as you said, loading the data doesn't take too long, so you won't win more than that by pipelining it. And SQLite doesn't support concurrent writes, not even in WAL mode, so there's not much use for threads there.

I would have expected OGR_SQLITE_SYNCHRONOUS=NO to make a slight difference, but probably less than disabling the spatial index.


Laurentiu

On Fri, Oct 21, 2022, at 15:14, Dennis Burgess wrote:
> Yep, tried all of those items it does help if I don?t create the index and then index it later, but we are not talking a huge amount of time.  Guess it?s a single threaded app?
>  
>  
> *LTI-Full_175px*
> *Dennis Burgess*
> *
*Author of "Learn RouterOS- Second Edition? 
> *Link Technologies, Inc* -- Mikrotik & WISP Support Services 
> *Office*: 314-735-0270  Website: http://www.linktechs.net 
> Create Wireless Coverage?s with www.towercoverage.com
> Need MikroTik Cloud Management: https://cloud.linktechs.net
>  
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> * On Behalf Of *Lauren?iu Nicola via gdal-dev
> *Sent:* Thursday, October 20, 2022 8:09 AM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
> 
>  
> Hi,
>  
> https://gdal.org/drivers/vector/gpkg.html#configuration-options has a couple of options that can help with performance. See also https://gdal.org/drivers/vector/sqlite.html#target-drivers-vector-sqlite-performance-hints.
>  
> But I don't recall them helping that much. YMMV.
>  
> Regards,
> Laurentiu
>  
> On Thu, Oct 20, 2022, at 15:06, Dennis Burgess wrote:
>> We have a large table in MSSQL, this table we extract data from and drop it into a GeoPackage for further processing.  However, the extraction can take some time, its only using 5% of the CPU available, and pulling the data is fairly quick in debug mode, its really its generation and index creation that is slow.  Any tips on speeding this up?  We have SSDs and NVME drives, 10gig networking etc..  So.  It should be as quick as it can be, but the 5% CPU is what I think the killer is.  On this server 24 cores, so 5% would be right at one core..  Is there no multi-threading or other options here? 
>> 
>>  
>> 
>>  
>> 
>> *LTI-Full_175px*
>> 
>> *Dennis Burgess, Mikrotik Certified Trainer**
>> MTCNA, MTCRE, MTCWE, MTCTCE, MTCINE, MTCSE, HE IPv6 Sage, Cambium ePMP Certified*
>> 
>> Author of "Learn RouterOS- Second Edition?
>> 
>> *Link Technologies, Inc* -- Mikrotik & WISP Support Services
>> 
>> *Office*: 314-735-0270  Website: http://www.linktechs.net
>> 
>> Need to Automate MikroTik Backups:  https://cloud.linktechs.net
>> 
>> Create Wireless Coverage?s with www.towercoverage.com
>> 
>>  
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>  
>  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/286c42e1/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4424 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/286c42e1/attachment-0001.png>

From dmburgess at linktechs.net  Fri Oct 21 07:06:14 2022
From: dmburgess at linktechs.net (Dennis Burgess)
Date: Fri, 21 Oct 2022 14:06:14 +0000
Subject: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation
In-Reply-To: <53faa10c-1da1-4dd0-88cd-39f0bc67dab0@app.fastmail.com>
References: <f82524403284465699eca38c84561008@linktechs.net>
 <39d1d12b-3a9d-42b9-b2c1-d7ccb094e25e@betaapp.fastmail.com>
 <4d8d23848d4a4872b063effe8de9b1bd@linktechs.net>
 <53faa10c-1da1-4dd0-88cd-39f0bc67dab0@app.fastmail.com>
Message-ID: <16b1a7ab3ceb4e3f9113b4853b824cdb@linktechs.net>

Ya like 10 seconds, most things are under 2 minutes, so I can live with that..


[LTI-Full_175px]
Dennis Burgess

Author of "Learn RouterOS- Second Edition?
Link Technologies, Inc -- Mikrotik & WISP Support Services
Office: 314-735-0270  Website: http://www.linktechs.net<http://www.linktechs.net/>
Create Wireless Coverage?s with www.towercoverage.com
Need MikroTik Cloud Management: https://cloud.linktechs.net

From: Lauren?iu Nicola <lnicola at dend.ro>
Sent: Friday, October 21, 2022 7:21 AM
To: Dennis Burgess <dmburgess at linktechs.net>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation

It is single-threaded (AFAIK), but as you said, loading the data doesn't take too long, so you won't win more than that by pipelining it. And SQLite doesn't support concurrent writes, not even in WAL mode, so there's not much use for threads there.

I would have expected OGR_SQLITE_SYNCHRONOUS=NO to make a slight difference, but probably less than disabling the spatial index.


Laurentiu

On Fri, Oct 21, 2022, at 15:14, Dennis Burgess wrote:

Yep, tried all of those items it does help if I don?t create the index and then index it later, but we are not talking a huge amount of time.  Guess it?s a single threaded app?





[LTI-Full_175px]

Dennis Burgess

Author of "Learn RouterOS- Second Edition?

Link Technologies, Inc -- Mikrotik & WISP Support Services

Office: 314-735-0270  Website: http://www.linktechs.net<http://www.linktechs.net/>

Create Wireless Coverage?s with www.towercoverage.com<http://www.towercoverage.com>

Need MikroTik Cloud Management: https://cloud.linktechs.net


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Lauren?iu Nicola via gdal-dev
Sent: Thursday, October 20, 2022 8:09 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Tips on Speeding up OGR2OGR GeoPackage Creation



Hi,



https://gdal.org/drivers/vector/gpkg.html#configuration-options has a couple of options that can help with performance. See also https://gdal.org/drivers/vector/sqlite.html#target-drivers-vector-sqlite-performance-hints.



But I don't recall them helping that much. YMMV.



Regards,

Laurentiu



On Thu, Oct 20, 2022, at 15:06, Dennis Burgess wrote:

We have a large table in MSSQL, this table we extract data from and drop it into a GeoPackage for further processing.  However, the extraction can take some time, its only using 5% of the CPU available, and pulling the data is fairly quick in debug mode, its really its generation and index creation that is slow.  Any tips on speeding this up?  We have SSDs and NVME drives, 10gig networking etc..  So.  It should be as quick as it can be, but the 5% CPU is what I think the killer is.  On this server 24 cores, so 5% would be right at one core..  Is there no multi-threading or other options here?





[LTI-Full_175px]

Dennis Burgess, Mikrotik Certified Trainer
MTCNA, MTCRE, MTCWE, MTCTCE, MTCINE, MTCSE, HE IPv6 Sage, Cambium ePMP Certified

Author of "Learn RouterOS- Second Edition?

Link Technologies, Inc -- Mikrotik & WISP Support Services

Office: 314-735-0270  Website: http://www.linktechs.net<http://www.linktechs.net/>

Need to Automate MikroTik Backups:  https://cloud.linktechs.net

Create Wireless Coverage?s with www.towercoverage.com<http://www.towercoverage.com>



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/651e1d2c/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4424 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221021/651e1d2c/attachment-0001.png>

From even.rouault at spatialys.com  Fri Oct 21 08:20:48 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Oct 2022 17:20:48 +0200
Subject: [gdal-dev] GDAL 3.5.3 RC1 available
Message-ID: <71fdd2de-c843-f639-7e38-de13a12fa1bc@spatialys.com>

Hi,

I have prepared a GDAL/OGR 3.5.3 release candidate.

Pick up an archive among the following ones (by ascending size):

 ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc1.tar.xz
 ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.5.3/gdal353rc1.zip

A snapshot of the gdalautotest suite is also available :

https://download.osgeo.org/gdal/3.5.3/gdalautotest-3.5.3rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.5.3/gdalautotest-3.5.3rc1.zip

The NEWS file is here :

 ? https://github.com/OSGeo/gdal/blob/v3.5.3RC1/NEWS.md

I'll call for a vote promoting it to final next week if no
serious problems are reported before.

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew at aitchison.me.uk  Fri Oct 21 09:35:19 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 21 Oct 2022 17:35:19 +0100 (BST)
Subject: [gdal-dev] GDAL 3.5.3 RC1 available
In-Reply-To: <71fdd2de-c843-f639-7e38-de13a12fa1bc@spatialys.com>
References: <71fdd2de-c843-f639-7e38-de13a12fa1bc@spatialys.com>
Message-ID: <42e3888e-685-2cf5-1f96-fe448d6c5390@aitchison.me.uk>

On Fri, 21 Oct 2022, Even Rouault wrote:

> Hi,
>
> I have prepared a GDAL/OGR 3.5.3 release candidate.
>
> Pick up an archive among the following ones (by ascending size):
>
> ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc1.tar.xz
> ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc1.tar.gz
> ? https://download.osgeo.org/gdal/3.5.3/gdal353rc1.zip
>
> A snapshot of the gdalautotest suite is also available :
>
> https://download.osgeo.org/gdal/3.5.3/gdalautotest-3.5.3rc1.tar.gz

This one seems to be a tar file - not compressed.

gdal-3.5.3rc1.tar.xz is OK; I have not checked the others.

> ? https://download.osgeo.org/gdal/3.5.3/gdalautotest-3.5.3rc1.zip
>
> The NEWS file is here :
>
> ? https://github.com/OSGeo/gdal/blob/v3.5.3RC1/NEWS.md
>
> I'll call for a vote promoting it to final next week if no
> serious problems are reported before.
>
> Best regards,
>
> Even

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From even.rouault at spatialys.com  Fri Oct 21 10:04:30 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Oct 2022 19:04:30 +0200
Subject: [gdal-dev] GDAL 3.5.3 RC1 available
In-Reply-To: <42e3888e-685-2cf5-1f96-fe448d6c5390@aitchison.me.uk>
References: <71fdd2de-c843-f639-7e38-de13a12fa1bc@spatialys.com>
 <42e3888e-685-2cf5-1f96-fe448d6c5390@aitchison.me.uk>
Message-ID: <0bb77f6b-6fbd-a2c7-763e-4858b4479634@spatialys.com>


> This one seems to be a tar file - not compressed.
>
> gdal-3.5.3rc1.tar.xz is OK; I have not checked the others.
Good point. Actually that's a defect that must have affected 3.5.0, .1 
and .2 as well. I've just fixed the release script and uploaded the 
corrected file.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Michael.Reetz at nlpvw.niedersachsen.de  Sun Oct 23 23:25:44 2022
From: Michael.Reetz at nlpvw.niedersachsen.de (Reetz, Michael (NLPV))
Date: Mon, 24 Oct 2022 06:25:44 +0000
Subject: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server
In-Reply-To: <c866a22b-f2e8-8152-ddfa-66f4d46f3c66@libero.it>
References: <8ddae9e72ff142248e9af2b96de97c0c@nlpvw.niedersachsen.de>
 <CAMCJChsPnZWkrTR_s=HK_Fy=7kxqc1MXRr-ZywH8L2N=F-EfAw@mail.gmail.com>
 <58411f8bcc824209955376cda6a850f1@nlpvw.niedersachsen.de>
 <84435467-4cbe-b901-c670-63ad58d8be63@libero.it>
 <d5cd7f9bb6344a4eb8e6d76b55cb00bc@nlpvw.niedersachsen.de>
 <c866a22b-f2e8-8152-ddfa-66f4d46f3c66@libero.it>
Message-ID: <786696ed1f2d45cb9354fa06139f3602@nlpvw.niedersachsen.de>

Hi Andrea,

maybe it would be sufficient to add that file. But, unfortunately, I don?t have any privileges to write to that folder or to install any software. I always have to make a request to our IT-department which is a very time consuming procedure. For good reasons ?normal? users are not allowed to install software or even run portable versions of applications. Greetings from EMOTET and Co. ?

Best regards
Michael

Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von Andrea Giudiceandrea via gdal-dev
Gesendet: Freitag, 21. Oktober 2022 12:12
An: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] ogr2ogr doesn't connect to MS SQL Server


ACHTUNG!! Diese E-Mail erreicht Sie von einem Absender au?erhalb der nieders?chsischen Landesverwaltungs-Infrastruktur mit TLS-Verschl?sselung. Bitte klicken Sie auf keine Links oder ?ffnen Sie keine E-Mail-Anh?nge, falls Sie den Absender nicht kennen und nicht wissen, ob der Inhalt sicher ist.
Il 21/10/2022 11:48, Reetz, Michael (NLPV) ha scritto:

Since the GDAL/ogr MS SQL Server driver is obviously missing on my computer, I will see if I can get a complete installation of the current GDAL package. This would be very helpful in many situations, especially in scripts that perform transformation tasks.

Hi Michael,
doesn't adding the ogr_MSSQLSpatial.dll file to the "\apps\gdal\lib\gdalplugins\" folder (or installing the gdal-mss package through OSGeo4W Setup) makes the MSSQLSpatial GDAL/OGR driver available to be used with ogr2ogr?

Best regards.

Andrea
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221024/c5f80f3f/attachment.htm>

From runette at gmail.com  Tue Oct 25 05:42:56 2022
From: runette at gmail.com (Paul Harwood)
Date: Tue, 25 Oct 2022 15:42:56 +0300
Subject: [gdal-dev] Transformations with same horizontal datum but
 different geoid outputs the same Z value
In-Reply-To: <14bbbbb-60f7-4857-6dcc-add6cb7c58c7@aitchison.me.uk>
References: <CAA_s=pM1Jkt+LN0LMBsbb3o30tDoyREJE41wB9Q44fh-Vxdccw@mail.gmail.com>
 <b2bc21c-84d0-7f7b-4378-d6a9224d836@aitchison.me.uk>
 <CAA_s=pPYXD8Lu-f88gD1gO+zdkzdQwYakYFiFAFUQTMfaW+r0g@mail.gmail.com>
 <4442427-4433-59c8-3287-f3c4487b39e9@aitchison.me.uk>
 <rmir0z61vhc.fsf@s1.lexort.com>
 <14bbbbb-60f7-4857-6dcc-add6cb7c58c7@aitchison.me.uk>
Message-ID: <CAE8nN5N54D7BKeWE2GKOoQ8bUK4BWuuRmTSzSjkBgp3V-8CZEw@mail.gmail.com>

I had to respond just because ...

GPS did not overthrow the Airy ellipsoid! It is alive and well in BNG where
it should be.

There are also organizations (like, I believe, MOLA) that prefer to use
LatLng with the Airy ellipsoid. I have a problem with that since it is
confusing (there is no *simple* notation in LatLng coords to tell you which
reference is used) and if you get it wrong the error in position is about
100m! Too big to be ignored but often too small to be obvious!

The response you received was because you mixed up ellipsoids and geoids.
4326 does not reference any geoid - it is a 2D reference system. You
probably meant the equivalent 3D CRS 4979 but that refers to ellipsoidal
height (above, as you say, the wgs84 ellipsoid ensemble). You talked about
the geoid, which is a different reference.

The Airy ellipsoid is not a Geoid. The OS Geoid is, I believe, OSGM15.

As far as converting from ellipsoidal height to orthometric height (i.e.
referenced to the Geoid) - I am not sure that it matters that GPS is using
WGS84 references. You still have to do a similar transformation and I would
expect that the final accuracy would be about the same.

On Mon, 17 Oct 2022 at 19:06, Andrew C Aitchison <andrew at aitchison.me.uk>
wrote:

> On Mon, 17 Oct 2022, Greg Troxel wrote:
>
> >
> > Andrew C Aitchison <andrew at aitchison.me.uk> writes:
> >> I do know that 4326 uses a geoid which is less accurate *over Great
> >> Britain* than the one the Great Britain Ordnance Survey have been
> >> using for a century or two (OSGB36 Datum 1936, Airy Spheriod 1830!).
> >> I suspect that other national geo-organisations do the same thing and
> >> you will lose the extra accuracy in standardising on one coordinate
> >> system over Europe.
> >
> > I don't follow this at all.  EPSG:4326 is a 2D system, so it doesn't
> > even have height, and has no associated geoid.
>
> Ah. I misremembered; I should have said the GRS80 ellipsoid:
>
>
> https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#Compatibility_with_related_systems
>
> The Airy ellipsoid is a regional best fit for Britain; more modern mapping
> tends to use the GRS80 ellipsoid used by the Global Positioning System
> (the Airy ellipsoid assumes the Earth to be about 1 km smaller in diameter
> than the GRS80 ellipsoid, and to be slightly less flattened).
>
> I do remember mourning that GPS overthrew the Airy Spheroid.
>
> --
> Andrew C. Aitchison                      Kendal, UK
>                     andrew at aitchison.me.uk
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221025/11578206/attachment.htm>

From echterhoff at interactive-instruments.de  Tue Oct 25 06:16:33 2022
From: echterhoff at interactive-instruments.de (Johannes Echterhoff)
Date: Tue, 25 Oct 2022 13:16:33 +0000
Subject: [gdal-dev] Documentation of .gfs file format
Message-ID: <GV1P193MB2232623C15E3B7938378CE36FC319@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>

Hello,

The documentation of the GML driver on https://gdal.org/drivers/vector/gml.html has two sections that describe the .gfs file format to some extent (section "Syntax of .gfs file by example" and section "Advanced .gfs syntax"). When looking for more information about the .gfs format, I came across https://github.com/OSGeo/gdal/issues/1138, where <precision> was mentioned as an additional element that can be used in .gfs files.

Is the .gfs. file format documented somewhere in full detail? I would like to write .gfs template files, and in order to do so, knowing all available elements, options, as well as syntax requirements would be great to know. So far, I only came across a number of examples - which certainly help - but I would like to consult an authoritative source, if there is one.

Best regards,
Johannes

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221025/5002500c/attachment.htm>

From even.rouault at spatialys.com  Tue Oct 25 11:07:37 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Oct 2022 20:07:37 +0200
Subject: [gdal-dev] Documentation of .gfs file format
In-Reply-To: <GV1P193MB2232623C15E3B7938378CE36FC319@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
References: <GV1P193MB2232623C15E3B7938378CE36FC319@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
Message-ID: <02c8a813-a366-008e-4444-a3283e637568@spatialys.com>

Johannes,

You have a number of .gfs templates file in 
https://github.com/OSGeo/gdal/tree/master/data

Otherwise just read the code of GMLFeatureClass::InitializeFromXML() if 
you want to have the full view of what the GFS reader understand: 
https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/gml/gmlfeatureclass.cpp#L456 
which is the ultimate authoritative source. That said a .xsd file for 
.gfs could be useful, if that's something you'd be willing to contribute.

Even

Le 25/10/2022 ? 15:16, Johannes Echterhoff a ?crit?:
>
> Hello,
>
> The documentation of the GML driver on 
> https://gdal.org/drivers/vector/gml.html has two sections that 
> describe the .gfs file format to some extent (section ?Syntax of .gfs 
> file by example? and section ?Advanced .gfs syntax?). When looking for 
> more information about the .gfs format, I came across 
> https://github.com/OSGeo/gdal/issues/1138, where <precision> was 
> mentioned as an additional element that can be used in .gfs files.
>
> Is the .gfs. file format documented somewhere in full detail? I would 
> like to write .gfs template files, and in order to do so, knowing all 
> available elements, options, as well as syntax requirements would be 
> great to know. So far, I only came across a number of examples ? which 
> certainly help ? but I would like to consult an authoritative source, 
> if there is one.
>
> Best regards,
>
> Johannes
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221025/512e25d4/attachment-0001.htm>

From echterhoff at interactive-instruments.de  Wed Oct 26 07:39:18 2022
From: echterhoff at interactive-instruments.de (Johannes Echterhoff)
Date: Wed, 26 Oct 2022 14:39:18 +0000
Subject: [gdal-dev] Documentation of .gfs file format
In-Reply-To: <02c8a813-a366-008e-4444-a3283e637568@spatialys.com>
References: <GV1P193MB2232623C15E3B7938378CE36FC319@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <02c8a813-a366-008e-4444-a3283e637568@spatialys.com>
Message-ID: <GV1P193MB22323B35BCA0780FFB0707FCFC309@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>

Even,
Thanks for the source code reference. That was quite useful to identify even more XML elements that can occur in a gfs file.
I?ll see what I can do about an xsd for gfs. Would you be willing to help me in this regard? That would mainly be clarification of schema specifics (like element types), as well as element semantics, where necessary.
Best regards,
Johannes

Von: Even Rouault <even.rouault at spatialys.com>
Gesendet: Dienstag, 25. Oktober 2022 20:08
An: Johannes Echterhoff <echterhoff at interactive-instruments.de>; gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Documentation of .gfs file format


Johannes,

You have a number of .gfs templates file in https://github.com/OSGeo/gdal/tree/master/data

Otherwise just read the code of GMLFeatureClass::InitializeFromXML() if you want to have the full view of what the GFS reader understand: https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/gml/gmlfeatureclass.cpp#L456 which is the ultimate authoritative source. That said a .xsd file for .gfs could be useful, if that's something you'd be willing to contribute.

Even
Le 25/10/2022 ? 15:16, Johannes Echterhoff a ?crit :
Hello,

The documentation of the GML driver on https://gdal.org/drivers/vector/gml.html has two sections that describe the .gfs file format to some extent (section ?Syntax of .gfs file by example? and section ?Advanced .gfs syntax?). When looking for more information about the .gfs format, I came across https://github.com/OSGeo/gdal/issues/1138, where <precision> was mentioned as an additional element that can be used in .gfs files.

Is the .gfs. file format documented somewhere in full detail? I would like to write .gfs template files, and in order to do so, knowing all available elements, options, as well as syntax requirements would be great to know. So far, I only came across a number of examples ? which certainly help ? but I would like to consult an authoritative source, if there is one.

Best regards,
Johannes




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221026/5a4731e1/attachment.htm>

From even.rouault at spatialys.com  Thu Oct 27 05:14:01 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2022 14:14:01 +0200
Subject: [gdal-dev] Documentation of .gfs file format
In-Reply-To: <GV1P193MB22323B35BCA0780FFB0707FCFC309@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
References: <GV1P193MB2232623C15E3B7938378CE36FC319@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <02c8a813-a366-008e-4444-a3283e637568@spatialys.com>
 <GV1P193MB22323B35BCA0780FFB0707FCFC309@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
Message-ID: <9e5bde55-8a9b-5359-7a06-d0a3709d3765@spatialys.com>

Johannes,

yes sure I can help

Even

Le 26/10/2022 ? 16:39, Johannes Echterhoff a ?crit?:
>
> Even,
>
> Thanks for the source code reference. That was quite useful to 
> identify even more XML elements that can occur in a gfs file.
>
> I?ll see what I can do about an xsd for gfs. Would you be willing to 
> help me in this regard? That would mainly be clarification of schema 
> specifics (like element types), as well as element semantics, where 
> necessary.
>
> Best regards,
>
> Johannes
>
> *Von:* Even Rouault <even.rouault at spatialys.com>
> *Gesendet:* Dienstag, 25. Oktober 2022 20:08
> *An:* Johannes Echterhoff <echterhoff at interactive-instruments.de>; 
> gdal-dev at lists.osgeo.org
> *Betreff:* Re: [gdal-dev] Documentation of .gfs file format
>
> Johannes,
>
> You have a number of .gfs templates file in 
> https://github.com/OSGeo/gdal/tree/master/data 
> <https://github.com/OSGeo/gdal/tree/master/data>
>
> Otherwise just read the code of GMLFeatureClass::InitializeFromXML() 
> if you want to have the full view of what the GFS reader understand: 
> https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/gml/gmlfeatureclass.cpp#L456 
> <https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/gml/gmlfeatureclass.cpp#L456>which 
> is the ultimate authoritative source. That said a .xsd file for .gfs 
> could be useful, if that's something you'd be willing to contribute.
>
> Even
>
> Le 25/10/2022 ? 15:16, Johannes Echterhoff a ?crit?:
>
>     Hello,
>
>     The documentation of the GML driver on
>     https://gdal.org/drivers/vector/gml.html
>     <https://gdal.org/drivers/vector/gml.html>has two sections that
>     describe the .gfs file format to some extent (section ?Syntax of
>     .gfs file by example? and section ?Advanced .gfs syntax?). When
>     looking for more information about the .gfs format, I came across
>     https://github.com/OSGeo/gdal/issues/1138
>     <https://github.com/OSGeo/gdal/issues/1138>, where <precision> was
>     mentioned as an additional element that can be used in .gfs files.
>
>     Is the .gfs. file format documented somewhere in full detail? I
>     would like to write .gfs template files, and in order to do so,
>     knowing all available elements, options, as well as syntax
>     requirements would be great to know. So far, I only came across a
>     number of examples ? which certainly help ? but I would like to
>     consult an authoritative source, if there is one.
>
>     Best regards,
>
>     Johannes
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org  <mailto:gdal-dev at lists.osgeo.org>
>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev  <https://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
> -- 
> http://www.spatialys.com  <http://www.spatialys.com>
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221027/0c6e8ad6/attachment.htm>

From even.rouault at spatialys.com  Thu Oct 27 05:22:57 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2022 14:22:57 +0200
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
Message-ID: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>

Hi,

Motion:

Adopt GDAL 3.5.3RC1 as final 3.5.3 release

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mateusz at loskot.net  Thu Oct 27 05:24:25 2022
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 27 Oct 2022 14:24:25 +0200
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
Message-ID: <CABUeae98uvV6sR5D1Yuc9APUuvQhSo2f6=Y2bhd+jaQ5OyK+yg@mail.gmail.com>

+1 Mateusz

Thank you!

On Thu, 27 Oct 2022 at 14:23, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> Motion:
>
> Adopt GDAL 3.5.3RC1 as final 3.5.3 release
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 27 05:55:58 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 27 Oct 2022 12:55:58 +0000
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
Message-ID: <AM0PR09MB3219DD9228AA7A36ACE72B7CFD339@AM0PR09MB3219.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: torstai 27. lokakuuta 2022 15.23
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release

Hi,

Motion:

Adopt GDAL 3.5.3RC1 as final 3.5.3 release

Starting with my +1

Even

-- 
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C9731dac15a5c485036d708dab81608e4%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638024702020651371%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=H6KqQEo72Jr88CfSD%2Fwow5Xi3uGeWtJSDWNzxjGyFV4%3D&amp;reserved=0
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C9731dac15a5c485036d708dab81608e4%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638024702020651371%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=wzphgE%2BkGcJxLR58JCVGvVpSvBFJSFkt4%2Bg%2BRMubqIw%3D&amp;reserved=0

From howard at hobu.co  Thu Oct 27 05:57:15 2022
From: howard at hobu.co (Howard Butler)
Date: Thu, 27 Oct 2022 07:57:15 -0500
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <AM0PR09MB3219DD9228AA7A36ACE72B7CFD339@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
 <AM0PR09MB3219DD9228AA7A36ACE72B7CFD339@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <1F8467FF-8FC1-4CD7-9EA2-7D6EAD692092@hobu.co>

+1

> On Oct 27, 2022, at 7:55 AM, Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> +1
> 
> -Jukka Rahkonen-
> 
> -----Alkuper?inen viesti-----
> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
> L?hetetty: torstai 27. lokakuuta 2022 15.23
> Vastaanottaja: gdal-dev at lists.osgeo.org
> Aihe: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
> 
> Hi,
> 
> Motion:
> 
> Adopt GDAL 3.5.3RC1 as final 3.5.3 release
> 
> Starting with my +1
> 
> Even
> 
> -- 
> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C9731dac15a5c485036d708dab81608e4%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638024702020651371%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=H6KqQEo72Jr88CfSD%2Fwow5Xi3uGeWtJSDWNzxjGyFV4%3D&amp;reserved=0
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C9731dac15a5c485036d708dab81608e4%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638024702020651371%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=wzphgE%2BkGcJxLR58JCVGvVpSvBFJSFkt4%2Bg%2BRMubqIw%3D&amp;reserved=0
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From gdt at lexort.com  Thu Oct 27 07:21:58 2022
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 27 Oct 2022 10:21:58 -0400
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com> (Even
 Rouault's message of "Thu, 27 Oct 2022 14:22:57 +0200")
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
Message-ID: <rmitu3p1h4p.fsf@s1.lexort.com>


I wasn't able to test this promptly, but am doing that now on netbsd-9
amd64 with python 3.10.

gdal-lib (no python) built fine

py-gdal (python bindings) is failing with what smells like a GNUism in
sed patterns, but it's possible this is a change in pkgsrc not gdal and
I haven't figured it out.

Has anybody been able to build on BSD or other system without GNU sed?

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221027/4a001edd/attachment.sig>

From gdt at lexort.com  Thu Oct 27 08:23:00 2022
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 27 Oct 2022 11:23:00 -0400
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <rmitu3p1h4p.fsf@s1.lexort.com> (Greg Troxel's message of "Thu,
 27 Oct 2022 10:21:58 -0400")
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
 <rmitu3p1h4p.fsf@s1.lexort.com>
Message-ID: <rmifsf91eaz.fsf@s1.lexort.com>


Greg Troxel <gdt at lexort.com> writes:

> I wasn't able to test this promptly, but am doing that now on netbsd-9
> amd64 with python 3.10.

And I am still using the autoconf build.

> gdal-lib (no python) built fine
>
> py-gdal (python bindings) is failing with what smells like a GNUism in
> sed patterns, but it's possible this is a change in pkgsrc not gdal and
> I haven't figured it out.

There are GNUisms in sed expressions to pacify coverity, and that is
skipped if it's not GNU sed -- but it's done at build time, not
configure time.   That causes a spurious:

  sed: unknown option -- -
  Usage:  sed [-aElnru] command [file ...]
          sed [-aElnru] [-e command] [-f command_file] [-I[extension]]
              [-i[extension]] [file ...]

which is just noise.   The next issue is:

  swig -Wall -I../include -I../include/python -I../include/python/docs -relativeimport -threads -outdir "osgeo"   -I/tmp/work/geography/py-gdal/work/gdal-3.5.3 -c++ -python -o extensions/gnm_wrap.cpp ../include/gnm.i
  sh: swig: not found

and this surprises me because I would expect swig to have been run
as part of 'make dist' or equiv, and I don't see configure looking for
swig.  Looking at
  https://trac.osgeo.org/gdal/wiki/BuildingOnUnix
I do not see swig listed as a prereq.


With the same system configuration, I reverted the change of version
from 3.5.2 to 3.5.3rc1, and then the py-gdal package built.


So I think something is wrong with 3.5.3rc1 and I would vote -1 on
release if I had a vote.

I would suggest that people test building the tarball on systems without
swig installed.  (with autoconf, as well as cmake)

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221027/b79b8e4b/attachment.sig>

From gdt at lexort.com  Thu Oct 27 08:31:27 2022
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 27 Oct 2022 11:31:27 -0400
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <rmifsf91eaz.fsf@s1.lexort.com> (Greg Troxel's message of "Thu,
 27 Oct 2022 11:23:00 -0400")
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
 <rmitu3p1h4p.fsf@s1.lexort.com> <rmifsf91eaz.fsf@s1.lexort.com>
Message-ID: <rmia65h1dww.fsf@s1.lexort.com>


the problem is that

  work/gdal-3.5.3/swig/python/extensions/gnm_wrap.cpp

has the same timestamp (in the tar file) as

  work/gdal-3.5.3/swig/include/gnm.i

running

  touch work/gdal-3.5.3/swig/python/extensions/gnm_wrap.cpp

after unpack and before build results in a successful build.

I guess make wants object > source, not >=, which seems fair.

I wonder if gnm.i is itself generated as part of distfile creation, and
if it needs a 'sleep 1', or if this is "git checkout"  followed by 'make
dist' and it's all blazingly fast?


  
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221027/4527517a/attachment.sig>

From even.rouault at spatialys.com  Thu Oct 27 09:55:28 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2022 18:55:28 +0200
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <rmia65h1dww.fsf@s1.lexort.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
 <rmitu3p1h4p.fsf@s1.lexort.com> <rmifsf91eaz.fsf@s1.lexort.com>
 <rmia65h1dww.fsf@s1.lexort.com>
Message-ID: <cf8877ac-740b-83bb-1935-5f416d181c51@spatialys.com>

Greg,

I indeed see that some generated files have a lower timestamp than their 
.i sources. Probably something due to some files being regenerated as 
identical (apart higher timestamp) to their existing versions in git and 
thus not being committed into git. There is nothing new in the 
generation process related to this, so weird that this shows up only 
now. Or perhaps this has hit in the past unnoticed.

Anyway I've uploaded updated archives whose only difference is just 
doing "touch swig/python/extensions/*" on top of rc1

 ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc2.tar.xz
 ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc2.tar.gz
 ? https://download.osgeo.org/gdal/3.5.3/gdal353rc2.zip

I've also modified the mkgdaldist.sh to force updating the timestamps 
for future releases

Even

Le 27/10/2022 ? 17:31, Greg Troxel a ?crit?:
> the problem is that
>
>    work/gdal-3.5.3/swig/python/extensions/gnm_wrap.cpp
>
> has the same timestamp (in the tar file) as
>
>    work/gdal-3.5.3/swig/include/gnm.i
>
> running
>
>    touch work/gdal-3.5.3/swig/python/extensions/gnm_wrap.cpp
>
> after unpack and before build results in a successful build.
>
> I guess make wants object > source, not >=, which seems fair.
>
> I wonder if gnm.i is itself generated as part of distfile creation, and
> if it needs a 'sleep 1', or if this is "git checkout"  followed by 'make
> dist' and it's all blazingly fast?
>
>
>    

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Thu Oct 27 10:21:00 2022
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 27 Oct 2022 13:21:00 -0400
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <cf8877ac-740b-83bb-1935-5f416d181c51@spatialys.com> (Even
 Rouault's message of "Thu, 27 Oct 2022 18:55:28 +0200")
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
 <rmitu3p1h4p.fsf@s1.lexort.com> <rmifsf91eaz.fsf@s1.lexort.com>
 <rmia65h1dww.fsf@s1.lexort.com>
 <cf8877ac-740b-83bb-1935-5f416d181c51@spatialys.com>
Message-ID: <rmiv8o5yygz.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

> I indeed see that some generated files have a lower timestamp than
> their .i sources. Probably something due to some files being
> regenerated as identical (apart higher timestamp) to their existing
> versions in git and thus not being committed into git. There is
> nothing new in the generation process related to this, so weird that
> this shows up only now. Or perhaps this has hit in the past unnoticed.
>
> Anyway I've uploaded updated archives whose only difference is just
> doing "touch swig/python/extensions/*" on top of rc1
>
> ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc2.tar.xz
> ? https://download.osgeo.org/gdal/3.5.3/gdal-3.5.3rc2.tar.gz
> ? https://download.osgeo.org/gdal/3.5.3/gdal353rc2.zip
>
> I've also modified the mkgdaldist.sh to force updating the timestamps
> for future releases

Thanks for the quick turnaround!

I have locally updated pkgsrc to 3.5.3rc2, and both gdal-lib and py-gdal
build fine now.

With those, running autotest from gdal release-3.5 branch (tag
v3.5.1RC1), I get a few failures, but I have no reason to think they are
new or super concerning, and should dig into them myself in the
background (while I also flip pkgsrc to cmake).


FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_14 - assert False == 1
FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_15 - AssertionError: SELECT HasSpatialI...
FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_58 - AssertionError: assert 0 == 1
FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_59 - AssertionError: assert 0 == 1
FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_deferred_spi_creation - AssertionError:...
FAILED ogr/ogr_gpkg.py::test_ogr_gpkg_deferred_spi_update - AssertionError: a...
FAILED gcore/geoloc.py::test_geoloc_fill_line[YES] - AssertionError: assert 2...
FAILED gcore/geoloc.py::test_geoloc_fill_line[NO] - AssertionError: assert 22...
FAILED gcore/tiff_read.py::test_tiff_read_big_strip_chunky_way - assert 38441...
FAILED gcore/tiff_write.py::test_tiff_write_64 - AssertionError: coordinate s...
FAILED gcore/tiff_write.py::test_tiff_write_163 - assert 47600 == 47567
FAILED gcore/vrt_read.py::test_vrt_statistics_and_implicit_ovr_recursion_issue
FAILED gdrivers/gpkg.py::test_gpkg_42 - assert 'sqlite3_exec...module: rtree'...
FAILED utilities/test_ogrinfo.py::test_ogrinfo_fielddomains - AssertionError:...



So I'm good with rc2 being promoted.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221027/6ca66e13/attachment.sig>

From j1 at jimenezshaw.com  Fri Oct 28 05:19:02 2022
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Fri, 28 Oct 2022 14:19:02 +0200
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
Message-ID: <CADRrdKtGFMyeOaoahG+cKbZiEEYTjWEEr1PyHJtkc+GyoEwQaA@mail.gmail.com>

My 2 cents:
I compiled (and run some tests in C++) it in Windows, Ubuntu 20.04 and
Macos without any problem.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Thu, 27 Oct 2022 at 14:22, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Motion:
>
> Adopt GDAL 3.5.3RC1 as final 3.5.3 release
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20221028/21636bb1/attachment.htm>

From even.rouault at spatialys.com  Mon Oct 31 09:29:59 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Oct 2022 17:29:59 +0100
Subject: [gdal-dev] Motion: adopt GDAL 3.5.3RC1 as final 3.5.3 release
In-Reply-To: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
References: <353d945d-ffba-6ff5-6c95-0632a35e46c1@spatialys.com>
Message-ID: <60355d4c-d45b-5d46-d14b-30a6357553f5@spatialys.com>

Hi,

I declare this motion passed. The official release will actually be RC2 
rather than RC1

Even

Le 27/10/2022 ? 14:22, Even Rouault a ?crit?:
> Hi,
>
> Motion:
>
> Adopt GDAL 3.5.3RC1 as final 3.5.3 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon Oct 31 09:46:07 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Oct 2022 17:46:07 +0100
Subject: [gdal-dev] GDAL 3.5.3 is released
Message-ID: <0d1638f1-2736-e88e-a380-5e4533f27ea9@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the
release of the GDAL/OGR 3.5.3 bug fix version, the last one planned for the
3.5 series.

Consult the release notes for the list of issues addressed :
 ? https://github.com/OSGeo/gdal/blob/v3.5.3/NEWS.md

The sources are available at:

 ??? http://download.osgeo.org/gdal/3.5.3/gdal-3.5.3.tar.xz
 ??? http://download.osgeo.org/gdal/3.5.3/gdal-3.5.3.tar.gz
 ??? http://download.osgeo.org/gdal/3.5.3/gdal353.zip

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


