From mateusz at loskot.net  Wed Jun  1 01:13:41 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <429CA543.40702@dmsolutions.ca>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>	<d7fud2$j0h$1@sea.gmane.org>	<429BC10F.7050900@dmsolutions.ca>	<d7hrhs$esm$1@sea.gmane.org>
	<429CA543.40702@dmsolutions.ca>
Message-ID: <d7jg0o$h7p$1@sea.gmane.org>

Daniel Morissette napisa?(a):
> Mateusz ?oskot wrote:
> 
>>
>> Thank you, I'm just going to try MITAB lib.
>> As I see it supports MapInfo formats, but as I understand you
>> correctly, I can take OGR part of MITAG, right?
>>
> 
> You'd need to take the "ogr" and "cpl" directories, and then use that to 
> build with OGR's shapelib and sqlite drivers.

OK, I will fight with this this week.
I'll report results here.

>> As I see you are the project leader, right?
>>
> 
> Yup.

Nice, I will catch you sometimes for a little help :-), do you mind?

Regards

-- 
Mateusz ?oskot
mateusz at loskot dot net


From mateusz at loskot.net  Wed Jun  1 01:15:30 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <20050531190013.GA5871@ak4719.spb.edu>
References: <d7elp1$knm$1@sea.gmane.org>	<20050530181438.GB12277@ak4719.spb.edu>	<d7fut0$kbj$1@sea.gmane.org>
	<20050531052316.GA8116@ak4719.spb.edu>	<429C32F9.6070300@loskot.net>
	<20050531190013.GA5871@ak4719.spb.edu>
Message-ID: <d7jg45$h7p$2@sea.gmane.org>

Andrey Kiselev napisa?(a):
> On Tue, May 31, 2005 at 11:48:41AM +0200, Mateusz ?oskot wrote:
> 
>>>>#ifdef HAVE_LOCALE_H
>>>>#  include <locale.h>
>>>>#endif
>>
>>Certainly, I know that technique but the name "guard" strange for me.
> 
> 
> I didn't read original K&R (i.e. in English), and do not know how they
> call this technique, but Stroustrup uses the term "include guards".

I do not have english version of Stroustrup's book.
I read it in polish, and I haven't met "include guards" term.
Thanks for explanation.

>>evc++ supports nmake build system. Certainly, there are some features
>>in "big" Windows (and "big" namke system) not supported byt Pocket PC
>>SDK. I've created makefile.evc and I'm trying to go with this but it
>>is not enough solution. So, I will try to work with nmake.opt and
>>other files you are talking about. Today I will dig into this job.
> 
> 
> Once I tried to build libtiff using eVC. I do not remember details, but a
> mess with headers was the main problem. I haven't forced enough to
> commit the stuff into libtiff CVS, so all of that remains outside of the
> main tree. I do not think there will be a big hassle to port GDAL to
> eVC.

Yes, I realize that.

> As a first step you should write your own cpl_config.h.evc, because
> cpl_config.h.vc is not suitable for that compiler. Also conditional
> compilation in cpl_vsisimple.cpp and cpl_port.h should be corrected (to
> isolate fcntl.h, for example).


OK, and makefile.evc is also required, I think.
I'll work on this port this week.

Regards

-- 
Mateusz ?oskot
mateusz at loskot dot net


From dmorissette at dmsolutions.ca  Wed Jun  1 11:08:17 2005
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <d7jg0o$h7p$1@sea.gmane.org>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>	<d7fud2$j0h$1@sea.gmane.org>	<429BC10F.7050900@dmsolutions.ca>	<d7hrhs$esm$1@sea.gmane.org>	<429CA543.40702@dmsolutions.ca>
	<d7jg0o$h7p$1@sea.gmane.org>
Message-ID: <429DCF61.6070507@dmsolutions.ca>

Mateusz ?oskot wrote:
> 
> Nice, I will catch you sometimes for a little help :-), do you mind?
> 

You mean help with separating OGR? I'd suggest you start by firing 
questions to the lists as you've been doing and if I can help I'll jump 
in.. there are others who are also very knowledgeable about OGR on the 
list and who could help too... and others who could learn useful 
information from those discussions, so going through the lists is always 
preferred.

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From mateusz at loskot.net  Thu Jun  2 02:35:37 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <429DCF61.6070507@dmsolutions.ca>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>	<d7fud2$j0h$1@sea.gmane.org>	<429BC10F.7050900@dmsolutions.ca>	<d7hrhs$esm$1@sea.gmane.org>	<429CA543.40702@dmsolutions.ca>	<d7jg0o$h7p$1@sea.gmane.org>
	<429DCF61.6070507@dmsolutions.ca>
Message-ID: <d7m962$jbl$1@sea.gmane.org>

Daniel Morissette napisa?(a):
> Mateusz ?oskot wrote:
> 
>>
>> Nice, I will catch you sometimes for a little help :-), do you mind?
>>
> 
> You mean help with separating OGR? I'd suggest you start by firing 
> questions to the lists as you've been doing and if I can help I'll jump 
> in..
 > [...]


That's what I mean saying "I will catch you" :-)
I mean the list.

Regards

-- 
Mateusz ?oskot
mateusz at loskot dot net


From hamish_nospam at yahoo.com  Fri Jun  3 04:16:53 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalwarp -tps weirdness
In-Reply-To: <d7jg45$h7p$2@sea.gmane.org>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
	<d7fut0$kbj$1@sea.gmane.org> <20050531052316.GA8116@ak4719.spb.edu>
	<429C32F9.6070300@loskot.net>
	<20050531190013.GA5871@ak4719.spb.edu> <d7jg45$h7p$2@sea.gmane.org>
Message-ID: <20050603201653.71028624.hamish_nospam@yahoo.com>

I'm trying to use gdalwarp's new thin plate spline warping but it is
doing funny things. Seems like a memory stomping problem but I'm not
sure. Doing things like changing the order of GCPs (dozen placed by hand
with gdal_translate) or the length of the output filename makes it
either work or have the output go haywire.

anybody come across this before?


GDAL 1.2.6.0 on Debian.

entered in GDAL bugzilla bug # 864
  http://bugzilla.remotesensing.org/show_bug.cgi?id=864



thanks,
Hamish

From bill at binko.net  Fri Jun  3 11:39:02 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW Problems?
Message-ID: <Pine.LNX.4.58.0506031130180.10727@fastcat.binko.net>

Hi everyone

I've been using Mapserver mainly for vector data, and now have some 
rasters (DOQQs) that I'd like to integrate.  Unfortunately, they came as 
ECW files and I'm using a Linux box, so I think I have some work cut out 
for me.

I have built GDAL CVS HEAD using the binaries for ERMapper's libs from 
gdal.org (they're the only ones that I could get to download).

The problem is that I'm getting a thread that hangs around at the end of 
any of the gdal* commands.  For example, here's what I get when I run the 
gdalinfo on one of the files:

#0  0xffffe410 in ?? ()
#1  0xbfff5968 in ?? ()
#2  0x409ba164 in ?? () from /usr/lib/libNCSUtil.so
#3  0x00000000 in ?? ()
#4  0x404b2ba6 in __nanosleep_nocancel () from /lib/tls/libpthread.so.0
#5  0x409b6408 in NCSSleep () from /usr/lib/libNCSUtil.so
#6  0x409b17ba in CNCSThread::Stop () from /usr/lib/libNCSUtil.so
#7  0x4052e164 in CNCSJP2FileView::Shutdown () from /usr/lib/libNCSEcw.so
#8  0x40526ad9 in CNCSJP2FileView::~CNCSJP2FileView () from /usr/lib/libNCSEcw.so
#9  0x404fd6d4 in CNCSFile::~CNCSFile () from /usr/lib/libNCSEcw.so
#10 0x400ced35 in ECWDataset::~ECWDataset () from /usr/lib/libgdal.so.1
#11 0x401780b7 in GDALClose () from /usr/lib/libgdal.so.1
#12 0x0804a41f in main ()

It looks like a fun pthread concurrency problem.  I'll be happy to attack 
it, but I really don't want to go through this if it's not necessary.

Has anyone been looking at this?  I saw a note a few months ago that might 
be this, but nothing since.

Thanks
Bill

PS: where can I get the ERMapper SDK source?

From Ken.Boss at dnr.state.mn.us  Fri Jun  3 12:09:54 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW Problems?
Message-ID: <s2a03d31.007@co5.dnr.state.mn.us>

>>> Bill Binko <bill@binko.net> 06/03/05 10:39 AM >>>
>Hi everyone
>
...
>
>PS: where can I get the ERMapper SDK source?

Hi Bill--

The source is available at http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=263.  It's v3.1 RC1; RC2 has yet to be released in source form.  You'll need to create a (free) account before downloading.

HTH,

--Ken


From bill at binko.net  Fri Jun  3 13:31:23 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW Problems?
In-Reply-To: <s2a03d31.006@co5.dnr.state.mn.us>
References: <s2a03d31.006@co5.dnr.state.mn.us>
Message-ID: <Pine.LNX.4.58.0506031316420.10727@fastcat.binko.net>

On Fri, 3 Jun 2005, Ken Boss wrote:

> >>> Bill Binko <bill@binko.net> 06/03/05 10:39 AM >>>
> >Hi everyone
> >
> ...
> >
> >PS: where can I get the ERMapper SDK source?
> 
> Hi Bill--
> 
> The source is available at http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=263.  It's v3.1 RC1; RC2 has yet to be released in source form.  You'll need to create a (free) account before downloading.

Ack!

Thanks! However, it looks like a nightmare to build!

I'll give it a shot
Bill

From baba.yoshihiko at gmail.com  Sat Jun  4 00:44:38 2005
From: baba.yoshihiko at gmail.com (BABA Yoshihiko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Python Support on MacOSX
Message-ID: <ba6f520405060321446c26e2a3@mail.gmail.com>

Hi

I am not good at python and want help from Pythonists. This is for
GDAL-1.2.6 and Python 2.3 (not System's) on MacOSX 10.3.9.

I'm trying to make gdal package for Fink on MacOSX with Python
support. When I did as follows, it built and installed everything:

    perl -pi.bak -e 's,^PYTHON_INCLUDES =
\@PYTHON_INCLUDES\@,PYTHON_INCLUDES = -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_LIBS = \@PYTHON_LIBS\@,PYTHON_LIBS =
-L/sw/lib/python2.3/config -lpython2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_CFLAGS = \@PYTHON_CFLAGS\@
\@NUMPY_FLAG\@,PYTHON_CFLAGS =  -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON = \@PYTHON\@,PYTHON =
%p/bin/python2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PY_LD_SHARED = \@PY_LD_SHARED\@,PY_LD_SHARED =
,' GDALmake.opt.in
    perl -pi.bak -e 's,^INST_PYMOD      =      
\@pymoddir\@,INST_PYMOD      = %i/lib/python2.3/site-packages,'
GDALmake.opt.in

Note: %p means Fink's root (/sw in most cases) and %i means install director.

As you see, I tried to link to Fink version of Python, not System's.
Then I tried to use GDAL in Python and got an error as:

YahooBB220041001026:~ baba$ /sw/bin/python
Python 2.3.4 (#1, Mar 27 2005, 05:51:42) 
[GCC 3.3 20030304 (Apple Computer, Inc. build 1495)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import gdal
Fatal Python error: Interpreter not initialized (version mismatch?)
Abort trap
YahooBB220041001026:~ baba$ 

Does it get confused with System's python or what? Any idea?


Thank you

-- 
BABA Yoshihiko
http://homepage.mac.com/babayoshihiko

From baba.yoshihiko at gmail.com  Sat Jun  4 00:55:22 2005
From: baba.yoshihiko at gmail.com (BABA Yoshihiko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Python Support on MacOSX
In-Reply-To: <ba6f520405060321446c26e2a3@mail.gmail.com>
References: <ba6f520405060321446c26e2a3@mail.gmail.com>
Message-ID: <ba6f5204050603215514af2cfd@mail.gmail.com>

Hi

I am not good at python and want help from Pythonists. This is for
GDAL-1.2.6 and Python 2.3 (not System's) on MacOSX 10.3.9.

I'm trying to make gdal package for Fink on MacOSX with Python
support. When I did as follows, it built and installed everything:

    perl -pi.bak -e 's,^PYTHON_INCLUDES =
\@PYTHON_INCLUDES\@,PYTHON_INCLUDES = -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_LIBS = \@PYTHON_LIBS\@,PYTHON_LIBS =
-L/sw/lib/python2.3/config -lpython2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_CFLAGS = \@PYTHON_CFLAGS\@
\@NUMPY_FLAG\@,PYTHON_CFLAGS =  -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON = \@PYTHON\@,PYTHON =
%p/bin/python2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PY_LD_SHARED = \@PY_LD_SHARED\@,PY_LD_SHARED =
,' GDALmake.opt.in
    perl -pi.bak -e 's,^INST_PYMOD      =
\@pymoddir\@,INST_PYMOD      = %i/lib/python2.3/site-packages,'
GDALmake.opt.in

Note: %p means Fink's root (/sw in most cases) and %i means install director.

As you see, I tried to link to Fink version of Python, not System's.
Then I tried to use GDAL in Python and got an error as:

YahooBB220041001026:~ baba$ /sw/bin/python
Python 2.3.4 (#1, Mar 27 2005, 05:51:42)
[GCC 3.3 20030304 (Apple Computer, Inc. build 1495)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import gdal
Fatal Python error: Interpreter not initialized (version mismatch?)
Abort trap
YahooBB220041001026:~ baba$

Does it get confused with System's python or what? Any idea?

Thank you

--
BABA Yoshihiko
http://homepage.mac.com/babayoshihiko

From baba.yoshihiko at gmail.com  Sat Jun  4 01:06:23 2005
From: baba.yoshihiko at gmail.com (BABA Yoshihiko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Python Support on MacOSX
In-Reply-To: <ba6f5204050603215514af2cfd@mail.gmail.com>
References: <ba6f520405060321446c26e2a3@mail.gmail.com>
	<ba6f5204050603215514af2cfd@mail.gmail.com>
Message-ID: <ba6f52040506032206361cf2eb@mail.gmail.com>

Hi

I am not good at python and want help from Pythonists. This is for
GDAL-1.2.6 and Python 2.3 (not System's) on MacOSX 10.3.9.

I'm trying to make gdal package for Fink on MacOSX with Python
support. When I did as follows, it built and installed everything:

    perl -pi.bak -e 's,^PYTHON_INCLUDES =
\@PYTHON_INCLUDES\@,PYTHON_INCLUDES = -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_LIBS = \@PYTHON_LIBS\@,PYTHON_LIBS =
-L/sw/lib/python2.3/config -lpython2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON_CFLAGS = \@PYTHON_CFLAGS\@
\@NUMPY_FLAG\@,PYTHON_CFLAGS =  -I%p/include/python2.3
-I%p/include/python2.3/Numeric,' GDALmake.opt.in
    perl -pi.bak -e 's,^PYTHON = \@PYTHON\@,PYTHON =
%p/bin/python2.3,' GDALmake.opt.in
    perl -pi.bak -e 's,^PY_LD_SHARED = \@PY_LD_SHARED\@,PY_LD_SHARED =
,' GDALmake.opt.in
    perl -pi.bak -e 's,^INST_PYMOD      =
\@pymoddir\@,INST_PYMOD      = %i/lib/python2.3/site-packages,'
GDALmake.opt.in

Note: %p means Fink's root (/sw in most cases) and %i means install director.

As you see, I tried to link to Fink version of Python, not System's.
Then I tried to use GDAL in Python and got an error as:

YahooBB220041001026:~ baba$ /sw/bin/python
Python 2.3.4 (#1, Mar 27 2005, 05:51:42)
[GCC 3.3 20030304 (Apple Computer, Inc. build 1495)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import gdal
Fatal Python error: Interpreter not initialized (version mismatch?)
Abort trap
YahooBB220041001026:~ baba$

Does it get confused with System's python or what? Any idea?

Thank you

--
BABA Yoshihiko
http://homepage.mac.com/babayoshihiko

From sgillies at frii.com  Sat Jun  4 10:54:00 2005
From: sgillies at frii.com (Sean Gillies)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Python Support on MacOSX
In-Reply-To: <ba6f520405060321446c26e2a3@mail.gmail.com>
References: <ba6f520405060321446c26e2a3@mail.gmail.com>
Message-ID: <5dc8b4ccf0694b47b9a78ddb183327e5@frii.com>

On Jun 3, 2005, at 10:44 PM, BABA Yoshihiko wrote:

> Hi
>
> I am not good at python and want help from Pythonists. This is for
> GDAL-1.2.6 and Python 2.3 (not System's) on MacOSX 10.3.9.
>
> I'm trying to make gdal package for Fink on MacOSX with Python
> support. When I did as follows, it built and installed everything:
>
>     perl -pi.bak -e 's,^PYTHON_INCLUDES =
> \@PYTHON_INCLUDES\@,PYTHON_INCLUDES = -I%p/include/python2.3
> -I%p/include/python2.3/Numeric,' GDALmake.opt.in
>     perl -pi.bak -e 's,^PYTHON_LIBS = \@PYTHON_LIBS\@,PYTHON_LIBS =
> -L/sw/lib/python2.3/config -lpython2.3,' GDALmake.opt.in
>     perl -pi.bak -e 's,^PYTHON_CFLAGS = \@PYTHON_CFLAGS\@
> \@NUMPY_FLAG\@,PYTHON_CFLAGS =  -I%p/include/python2.3
> -I%p/include/python2.3/Numeric,' GDALmake.opt.in
>     perl -pi.bak -e 's,^PYTHON = \@PYTHON\@,PYTHON =
> %p/bin/python2.3,' GDALmake.opt.in
>     perl -pi.bak -e 's,^PY_LD_SHARED = \@PY_LD_SHARED\@,PY_LD_SHARED =
> ,' GDALmake.opt.in
>     perl -pi.bak -e 's,^INST_PYMOD      =
> \@pymoddir\@,INST_PYMOD      = %i/lib/python2.3/site-packages,'
> GDALmake.opt.in
>
> Note: %p means Fink's root (/sw in most cases) and %i means install 
> director.
>
> As you see, I tried to link to Fink version of Python, not System's.
> Then I tried to use GDAL in Python and got an error as:
>
> YahooBB220041001026:~ baba$ /sw/bin/python
> Python 2.3.4 (#1, Mar 27 2005, 05:51:42)
> [GCC 3.3 20030304 (Apple Computer, Inc. build 1495)] on darwin
> Type "help", "copyright", "credits" or "license" for more information.
>>>> import gdal
> Fatal Python error: Interpreter not initialized (version mismatch?)
> Abort trap
> YahooBB220041001026:~ baba$
>
> Does it get confused with System's python or what? Any idea?
>
>
> Thank you
>

BABA,

Don't hack the GDALmake.opt.in file. Everything can be accomplished 
with proper use of the GDAL configure script. To specify a particular 
python, do something like this

   $ ./configure [OPTIONS]... PYTHON=/sw/bin/python

Sean

--
Sean Gillies
sgillies at frii dot com
http://zcologia.com


From baba.yoshihiko at gmail.com  Sat Jun  4 20:20:35 2005
From: baba.yoshihiko at gmail.com (BABA Yoshihiko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Python Support on MacOSX
In-Reply-To: <5dc8b4ccf0694b47b9a78ddb183327e5@frii.com>
References: <ba6f520405060321446c26e2a3@mail.gmail.com>
	<5dc8b4ccf0694b47b9a78ddb183327e5@frii.com>
Message-ID: <ba6f5204050604172020834cb8@mail.gmail.com>

Sorry about sending the same email three times.

2005/6/4, Sean Gillies <sgillies@frii.com>:
> 
> BABA,
> 
> Don't hack the GDALmake.opt.in file. Everything can be accomplished
> with proper use of the GDAL configure script. To specify a particular
> python, do something like this
> 
>    $ ./configure [OPTIONS]... PYTHON=/sw/bin/python
> 
> Sean

Of course, that's what I first did. After testing some compile options
with no luck, I found this webpage:
http://aspn.activestate.com/ASPN/Mail/Message/pythonmac-sig/1902289

-- 
BABA Yoshihiko
http://homepage.mac.com/babayoshihiko

From hamish_nospam at yahoo.com  Mon Jun  6 05:08:56 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalwarp -tps weirdness
In-Reply-To: <20050603201653.71028624.hamish_nospam@yahoo.com>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
	<d7fut0$kbj$1@sea.gmane.org> <20050531052316.GA8116@ak4719.spb.edu>
	<429C32F9.6070300@loskot.net>
	<20050531190013.GA5871@ak4719.spb.edu> <d7jg45$h7p$2@sea.gmane.org>
	<20050603201653.71028624.hamish_nospam@yahoo.com>
Message-ID: <20050606210856.28f749bf.hamish_nospam@yahoo.com>

> I'm trying to use gdalwarp's new thin plate spline warping but it is
> doing funny things. Seems like a memory stomping problem but I'm not
> sure. Doing things like changing the order of GCPs (dozen placed by
> hand with gdal_translate) or the length of the output filename makes
> it either work or have the output go haywire.
> 
> anybody come across this before?
> 
> 
> GDAL 1.2.6.0 on Debian.
> 
> entered in GDAL bugzilla bug # 864
>   http://bugzilla.remotesensing.org/show_bug.cgi?id=864



[cc GDAL Bug 864]


recompiled on another machine from source (previous was with the Debian
packages). Same result but now I can use gdb for two segfaults I can
trigger, in addition to the weird output bug mentioned above.

Both segfaults trace back to the GDALWarpOperation::WarpRegion stage.



Segfault 1) Different GeoTIFF image than the above failure, it gets to 
100% complete, then segfaults. Leaves behind a corrupted output GeoTiff.


Here's the gdb session:


$ gdb `which gdalwarp`
(gdb) run -tps -co compress=lzw 8right_gcp.tif 8right_warped_xyz123def.tif
Starting program: /usr/local/bin/gdalwarp -tps -co compress=lzw 8right_gcp.tif 8right_warped_xyz123def.tif
[Thread debugging using libthread_db enabled]
[New Thread 16384 (LWP 9987)]
Creating output file that is 9627P x 6717L.
:0...10...20...30...40...50...60...70...80...90...100 - done.

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 9987)]
0x4070756b in memset () from /lib/libc.so.6
(gdb) bt f
#0  0x4070756b in memset () from /lib/libc.so.6
No symbol table info available.
#1  0x405138ad in _TIFFmemset () from /usr/lib/libtiff.so.4
No symbol table info available.
#2  0x40508833 in TIFFInitSGILog () from /usr/lib/libtiff.so.4
No symbol table info available.
#3  0x40511f85 in TIFFReadBufferSetup () from /usr/lib/libtiff.so.4
No symbol table info available.
#4  0x4051131c in TIFFReadEncodedStrip () from /usr/lib/libtiff.so.4
No symbol table info available.
#5  0x400f5e05 in GTiffRasterBand::IReadBlock (this=0x80512e8, nBlockXOff=0, nBlockYOff=0, 
    pImage=0x8a9ab00) at geotiff.cpp:518
        poGDS = (GTiffDataset *) 0x80511d8
        nBlockBufSize = 9627
        nBlockId = 0
        nBlockIdBand0 = 0
        eErr = CE_None
#6  0x401a8d3a in GDALRasterBand::GetBlockRef (this=0x80512e8, nXBlockOff=0, nYBlockOff=0, 
    bJustInitialize=0) at gdalrasterband.cpp:1142
        poBlock = (class GDALRasterBlock *) 0x8706db0
#7  0x401ac1da in GDALRasterBand::IRasterIO (this=0x80512e8, eRWFlag=GF_Write, nXOff=4813, nYOff=0, 
    nXSize=4814, nYSize=6717, pData=0x41409008, nBufXSize=4814, nBufYSize=6717, eBufType=GDT_Byte, 
    nPixelSpace=1, nLineSpace=4814) at rasterio.cpp:175
        bJustInitialize = 0
        nSrcByteOffset = 0
        nBandDataSize = 1
        nBufDataSize = 1
        pabySrcBlock = (GByte *) 0x0
        poBlock = (class GDALRasterBlock *) 0x40701176
        nLBlockX = -1
        nLBlockY = 0
        iBufYOff = 0
        iBufXOff = 1081866368
        iSrcY = 0
        iSrcX = 0
        dfSrcX = 2.1219957909652723e-314
        dfSrcY = 7.7813168390427143e-292
        dfSrcXInc = 48.371032714843786
        dfSrcYInc = 263.61883544908824
#8  0x401a00b0 in GDALDataset::IRasterIO (this=0x80511d8, eRWFlag=GF_Write, nXOff=4813, nYOff=0, 
    nXSize=4814, nYSize=6717, pData=0x41409008, nBufXSize=4814, nBufYSize=6717, eBufType=GDT_Byte, 
    nBandCount=1, panBandMap=0x80508c0, nPixelSpace=1, nLineSpace=4814, nBandSpace=32335638)
    at gdaldataset.cpp:1290
        poBand = (class GDALRasterBand *) 0x80512e8
        pabyBandData = (GByte *) 0x41409008 ""
        iBandIndex = 0
        eErr = CE_None
#9  0x401a048c in GDALDataset::RasterIO (this=0x80511d8, eRWFlag=GF_Write, nXOff=4813, nYOff=0, 
    nXSize=4814, nYSize=6717, pData=0x41409008, nBufXSize=4814, nBufYSize=6717, eBufType=GDT_Byte, 
    nBandCount=1, panBandMap=0x80508c0, nPixelSpace=1, nLineSpace=4814, nBandSpace=32335638)
    at gdaldataset.cpp:1481
        i = 1
        bNeedToFreeBandMap = 0
        eErr = CE_None
#10 0x401a0531 in GDALDatasetRasterIO (hDS=0x80511d8, eRWFlag=GF_Write, nXOff=4813, nYOff=0, 
    nXSize=4814, nYSize=6717, pData=0x41409008, nBufXSize=4814, nBufYSize=6717, eBufType=GDT_Byte, 
    nBandCount=1, panBandMap=0x80508c0, nPixelSpace=0, nLineSpace=0, nBandSpace=0)
    at gdaldataset.cpp:1515
        poDS = (GDALDataset *) 0x80511d8
#11 0x401cf63e in GDALWarpOperation::WarpRegion (this=0xbffff9b0, nDstXOff=4813, nDstYOff=0, 
    nDstXSize=4814, nDstYSize=6717, nSrcXOff=0, nSrcYOff=0, nSrcXSize=1200, nSrcYSize=11100)
    at gdalwarpoperation.cpp:1190
        eErr = CE_None
        iBand = 1
        pDstBuffer = (void *) 0x41409008
        nWordSize = 1
        nBandSize = 32335638
        pszInitDest = 0x8055d8a "0"
#12 0x401ce7d9 in GDALWarpOperation::ChunkAndWarpImage (this=0xbffff9b0, nDstXOff=0, nDstYOff=0, 
    nDstXSize=9627, nDstYSize=6717) at gdalwarpoperation.cpp:683
        panThisChunk = (int *) 0x80570d8
        dfChunkPixels = 32335638
        eErr = CE_None
        iChunk = 1
        dfPixelsProcessed = 32328921
        dfTotalPixels = 64664559
#13 0x0804aca6 in main (argc=6, argv=0x80504a8) at gdalwarp.cpp:657
        hSrcDS = 0x80509f8
        hDstDS = 0x80511d8
        pszFormat = 0x804b6cc "GTiff"
        pszTargetSRS = 0x0
        pszSourceSRS = 0x0
        pszSrcFilename = 0x804fdc0 "8right_gcp.tif"
        pszDstFilename = 0x80504c8 "8right_warped_xyz123def.tif"
        bCreateOutput = 1
        i = 1
        nOrder = -1
        hTransformArg = (void *) 0x8057358
        hGenImgProjArg = (void *) 0x8055f60
        hApproxArg = (void *) 0x8057358
        papszWarpOptions = (char **) 0x8055d60
        dfErrorThreshold = 0.125
        dfWarpMemoryLimit = 0
        pfnTransformer = 0x8049454 <GDALApproxTransform>
        papszCreateOptions = (char **) 0x0
        eOutputType = GDT_Unknown
        eWorkingType = GDT_Unknown
        eResampleAlg = GRA_NearestNeighbour
        pszSrcNodata = 0x0
        pszDstNodata = 0x0
        bMulti = 0
        psWO = (GDALWarpOptions *) 0x80574d0
        oWO = {_vptr.GDALWarpOperation = 0x403735d0, psOptions = 0x8056b60, 
  dfProgressBase = 0.49994806274020981, dfProgressScale = 0.50005193725979014, hThread1Mutex = 0x0, 
  hThread2Mutex = 0x0, hIOMutex = 0x0, hWarpMutex = 0x0, nChunkListCount = 2, nChunkListMax = 3, 
  panChunkList = 0x80570b8, bReportTimings = 0, nLastTimeReported = 0}
(gdb) l
657                 oWO.ChunkAndWarpImage( 0, 0, 
658                                        GDALGetRasterXSize( hDstDS ),
659                                        GDALGetRasterYSize( hDstDS ) );
660         }
661     
662     /* -------------------------------------------------------------------- */
663     /*      Cleanup                                                         */
664     /* -------------------------------------------------------------------- */
665         if( hApproxArg != NULL )
666             GDALDestroyApproxTransformer( hApproxArg );
(gdb) frame 5
#5  0x400f5e05 in GTiffRasterBand::IReadBlock (this=0x80512e8, nBlockXOff=0, nBlockYOff=0, 
    pImage=0x8a9ab00) at geotiff.cpp:518
518                 if( TIFFReadEncodedStrip( poGDS->hTIFF, nBlockId, pImage,
(gdb) l
513                     eErr = CE_Failure;
514                 }
515             }
516             else
517             {
518                 if( TIFFReadEncodedStrip( poGDS->hTIFF, nBlockId, pImage,
519                                           nBlockBufSize ) == -1 )
520                 {
521                     memset( pImage, 0, nBlockBufSize );
522                     CPLError( CE_Failure, CPLE_AppDefined,
(gdb) frame 6
#6  0x401a8d3a in GDALRasterBand::GetBlockRef (this=0x80512e8, nXBlockOff=0, nYBlockOff=0, 
    bJustInitialize=0) at gdalrasterband.cpp:1142
1142            if( !bJustInitialize
(gdb) l
1137                CPLError( CE_Failure, CPLE_AppDefined, "Internalize failed",
1138                          nXBlockOff, nYBlockOff);
1139                return( NULL );
1140            }
1141    
1142            if( !bJustInitialize
1143             && IReadBlock(nXBlockOff,nYBlockOff,poBlock->GetDataRef()) != CE_None)
1144            {
1145                delete poBlock;
1146                CPLError( CE_Failure, CPLE_AppDefined,



$ gdalinfo 8right_gcp.tif
Driver: GTiff/GeoTIFF
Size is 1200, 11100
Coordinate System is `'
GCP Projection = 
GCP[  0]: Id=1, Info=
          (1198,3) -> [...]
[...]
GCP[ 23]: Id=24, Info=
          (970,11040) -> [...]
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,11100.0)
Upper Right ( 1200.0,    0.0)
Lower Right ( 1200.0,11100.0)
Center      (  600.0, 5550.0)
Band 1 Block=1200x6 Type=Byte, ColorInterp=Gray






--------

Segfault 2) Another segfault in another way using a different file.
I guess this one's only a symptom of the matrix gen failing:



$ gdb `which gdalwarp`
[...]
(gdb) run -tps -co compress=lzw 18left_gcp.tif 18left_warped_abcdefg.tif
Starting program: /usr/local/bin/gdalwarp -tps -co compress=lzw 18left_gcp.tif 18left_warped_abcdefg.tif
[Thread debugging using libthread_db enabled]
[New Thread 16384 (LWP 9969)]
 There is a problem to invert the interpolation matrix
Creating output file that is 4513P x 12251L.
 There is a problem to invert the interpolation matrix
:0.
Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 9969)]
0x401ca487 in GWKNearestNoMasksByte (poWK=0xbffff7d0) at gdalwarpkernel.cpp:2065
2065                    poWK->papabyDstImage[iBand][iDstOffset] = 
(gdb) bt f
#0  0x401ca487 in GWKNearestNoMasksByte (poWK=0xbffff7d0) at gdalwarpkernel.cpp:2065
        iSrcX = -2147483648
        iSrcOffset = -2147483648
        iSrcY = -2147483648
        iBand = 0
        iDstOffset = 0
        iDstX = 0
        iDstY = 0
        nDstXSize = 4513
        nDstYSize = 12251
        nSrcXSize = 0
        nSrcYSize = 0
        eErr = CE_None
        padfX = (double *) 0x80594f8
        padfY = (double *) 0x8062208
        padfZ = (double *) 0x806af18
        pabSuccess = (int *) 0x8073c28
#1  0x401c695e in GDALWarpKernel::PerformWarp (this=0xbffff7d0) at gdalwarpkernel.cpp:591
        eErr = CE_None
#2  0x401cfda6 in GDALWarpOperation::WarpRegionToBuffer (this=0xbffff9b0, nDstXOff=0, nDstYOff=0, 
    nDstXSize=4513, nDstYSize=12251, pDataBuf=0x40f04008, eBufDataType=GDT_Byte, nSrcXOff=0, 
    nSrcYOff=0, nSrcXSize=0, nSrcYSize=0) at gdalwarpoperation.cpp:1475
        eErr = CE_None
        i = 1
        nWordSize = 1
        oWK = {_vptr.GDALWarpKernel = 0x40373570, papszWarpOptions = 0x8056b80, 
  eResample = GRA_NearestNeighbour, eWorkingDataType = GDT_Byte, nBands = 1, nSrcXSize = 0, 
  nSrcYSize = 0, papabySrcImage = 0x8056200, papanBandSrcValid = 0x0, panUnifiedSrcValid = 0x0, 
  pafUnifiedSrcDensity = 0x0, nDstXSize = 4513, nDstYSize = 12251, papabyDstImage = 0x8056f40, 
  panDstValid = 0x0, pafDstDensity = 0x0, nSrcXOff = 0, nSrcYOff = 0, nDstXOff = 0, nDstYOff = 0, 
  pfnTransformer = 0x8049454 <GDALApproxTransform>, pTransformerArg = 0x8056ef0, 
  pfnProgress = 0x8049834 <GDALTermProgress>, pProgress = 0x0, dfProgressBase = 0, 
  dfProgressScale = 1}
#3  0x401cf5a8 in GDALWarpOperation::WarpRegion (this=0xbffff9b0, nDstXOff=0, nDstYOff=0, 
    nDstXSize=4513, nDstYSize=12251, nSrcXOff=0, nSrcYOff=0, nSrcXSize=0, nSrcYSize=0)
    at gdalwarpoperation.cpp:1181
        eErr = CE_None
        iBand = 1
        pDstBuffer = (void *) 0x40f04008
        nWordSize = 1
        nBandSize = 55288763
        pszInitDest = 0x8056b9a "0"
#4  0x401ce7d9 in GDALWarpOperation::ChunkAndWarpImage (this=0xbffff9b0, nDstXOff=0, nDstYOff=0, 
    nDstXSize=4513, nDstYSize=12251) at gdalwarpoperation.cpp:683
        panThisChunk = (int *) 0x8056f18
        dfChunkPixels = 55288763
        eErr = 134532600
        iChunk = 0
        dfPixelsProcessed = 0
        dfTotalPixels = 55288763
#5  0x0804aca6 in main (argc=6, argv=0x80504a8) at gdalwarp.cpp:657
        hSrcDS = 0x80509f8
        hDstDS = 0x8056230
        pszFormat = 0x804b6cc "GTiff"
        pszTargetSRS = 0x0
        pszSourceSRS = 0x0
        pszSrcFilename = 0x804fdc0 "18left_gcp.tif"
        pszDstFilename = 0x80504c8 "18left_warped_abcdefg.tif"
        bCreateOutput = 1
        i = 1
        nOrder = -1
        hTransformArg = (void *) 0x8056ef0
        hGenImgProjArg = (void *) 0x80511d8
        hApproxArg = (void *) 0x8056ef0
        papszWarpOptions = (char **) 0x8050750
        dfErrorThreshold = 0.125
        dfWarpMemoryLimit = 0
        pfnTransformer = 0x8049454 <GDALApproxTransform>
        papszCreateOptions = (char **) 0x0
        eOutputType = GDT_Unknown
        eWorkingType = GDT_Unknown
        eResampleAlg = GRA_NearestNeighbour
        pszSrcNodata = 0x0
        pszDstNodata = 0x0
        bMulti = 0
        psWO = (GDALWarpOptions *) 0x8057268
        oWO = {_vptr.GDALWarpOperation = 0x403735d0, psOptions = 0x8056af0, dfProgressBase = 0, 
  dfProgressScale = 1, hThread1Mutex = 0x0, hThread2Mutex = 0x0, hIOMutex = 0x0, hWarpMutex = 0x0, 
  nChunkListCount = 1, nChunkListMax = 1, panChunkList = 0x8056f18, bReportTimings = 0, 
  nLastTimeReported = 0}
(gdb) l
657                 oWO.ChunkAndWarpImage( 0, 0, 
658                                        GDALGetRasterXSize( hDstDS ),
659                                        GDALGetRasterYSize( hDstDS ) );
660         }
661     
662     /* -------------------------------------------------------------------- */
663     /*      Cleanup                                                         */
664     /* -------------------------------------------------------------------- */
665         if( hApproxArg != NULL )
666             GDALDestroyApproxTransformer( hApproxArg );
(gdb) frame 0
#0  0x401ca487 in GWKNearestNoMasksByte (poWK=0xbffff7d0) at gdalwarpkernel.cpp:2065
2065                    poWK->papabyDstImage[iBand][iDstOffset] = 
(gdb) l
2060    
2061                iDstOffset = iDstX + iDstY * nDstXSize;
2062    
2063                for( iBand = 0; iBand < poWK->nBands; iBand++ )
2064                {
2065                    poWK->papabyDstImage[iBand][iDstOffset] = 
2066                        poWK->papabySrcImage[iBand][iSrcOffset];
2067                }
2068            }
2069    
(gdb) frame 1
#1  0x401c695e in GDALWarpKernel::PerformWarp (this=0xbffff7d0) at gdalwarpkernel.cpp:591
591             return GWKNearestNoMasksByte( this );
(gdb) l
586             && papanBandSrcValid == NULL
587             && panUnifiedSrcValid == NULL
588             && pafUnifiedSrcDensity == NULL
589             && panDstValid == NULL
590             && pafDstDensity == NULL )
591             return GWKNearestNoMasksByte( this );
592     
593         if( eWorkingDataType == GDT_Byte
594             && eResample == GRA_Bilinear
595             && papanBandSrcValid == NULL



So I guess this segfault happens as iSrcOffset being used uninitialized
in gdalwarpkernel.cpp line 2066 ......





thanks,
Hamish

From pedro at geovirtual.com  Mon Jun  6 06:10:25 2005
From: pedro at geovirtual.com (=?iso-8859-1?Q?Pedro_Fern=E1ndez?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Different output warping in 1.2.6
Message-ID: <002801c56a7f$f5b2e520$0a01a8c0@PERE>

A non-text attachment was scrubbed...
Name: smime.p7m
Type: application/pkcs7-mime
Size: 7781 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050606/bd7e0d1d/smime.p7c
From asger at jo-informatik.dk  Mon Jun  6 06:41:23 2005
From: asger at jo-informatik.dk (Asger Petersen)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] RE: gdalwarp -tps weirdness
Message-ID: <6A0257B028DA47499B5A843683051A36068FF3@server01.jo-informatik.local>

> 
> I'm trying to use gdalwarp's new thin plate spline warping but it is
> doing funny things. Seems like a memory stomping problem but I'm not
> sure. Doing things like changing the order of GCPs (dozen placed by hand
> with gdal_translate) or the length of the output filename makes it
> either work or have the output go haywire.
> 
> anybody come across this before?

Hi

I had a problem much like this some time ago. Maybe you are experiencing something similar? Anyway here is an excerpt of the original correspondence with Frank:

My question: 
---
> I grew some gray hair finding out, that you can?t have a numeric filename when you use gcps with gdal_translate.
> This works:
> gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 
> ht200414_06_7631.ecw ht200414_06_7631gcp.jp2
> This doesn't work:
> gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 
> 200414_06_7631.ecw 200414_06_7631gcp.jp2
> If you don't use gcps, there are no problems with numeric filenames. So this also works:
> gdal_translate -of JP2KAK 200414_06_7631.ecw 200414_06_7631gcp.jp2
---

Franks answer:
----
Asger, 
The problem is that there is an optional elevation argument in the -gcp switch.  The usage message should look like this (now updated):

   [-gcp pixel line easting northing [elevation]]*

In order to determine if an elevation is supplied, the program tries to read a numeric value from the argument.  If it gets a non-zero value it treats it as elevation.
---
Regards
Asger

From pedro at geovirtual.com  Mon Jun  6 07:43:54 2005
From: pedro at geovirtual.com (=?iso-8859-1?Q?Pedro_Fern=E1ndez?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Different output warping in 1.2.6
Message-ID: <000601c56a8d$04a01460$0a01a8c0@PERE>

Hi, 

A few weeks ago I wrote some code to warp a SRTM DEM to UTM. The code
was basically similar to the Warp API tutorial and worked fine using
GDAL 1.2.4

Recently, I?ve updated to GDAL 1.2.6 and now the code produces a
different output. The warping is done but the DEM is vertically flipped.

Any hint about what?s going on?

Thanks!


From hamish_nospam at yahoo.com  Mon Jun  6 07:47:22 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: gdalwarp -tps weirdness
In-Reply-To: <6A0257B028DA47499B5A843683051A36068FF3@server01.jo-informatik.local>
References: <6A0257B028DA47499B5A843683051A36068FF3@server01.jo-informatik.local>
Message-ID: <20050606234722.0e2e0b88.hamish_nospam@yahoo.com>

> > I'm trying to use gdalwarp's new thin plate spline warping but it is
> > doing funny things. Seems like a memory stomping problem but I'm not
> > sure. Doing things like changing the order of GCPs (dozen placed by
> > hand with gdal_translate) or the length of the output filename makes
> > it either work or have the output go haywire.
> > 
> > anybody come across this before?
> 
> I had a problem much like this some time ago. Maybe you are
> experiencing something similar? Anyway here is an excerpt of the
> original correspondence with Frank:
> 
> My question: 
> ---
> > I grew some gray hair finding out, that you can?t have a numeric
> > filename when you use gcps with gdal_translate.
[...]
> Franks answer:
> ----
> Asger, 
> The problem is that there is an optional elevation argument in the
> -gcp switch.  The usage message should look like this (now updated):
> 
>    [-gcp pixel line easting northing [elevation]]*
> 
> In order to determine if an elevation is supplied, the program tries
> to read a numeric value from the argument.  If it gets a non-zero
> value it treats it as elevation. ---


Yes, I found that one too. Filed it as bug # 863 (gdal_translate).
:)
My work-around was to put something after the -gcp entries and before
the input source name.  "-co compress=lzw" does the trick.


This doesn't solve bug # 864 though (gdalwarp).
:(



thanks,
Hamish

From saintsjd at yahoo.com  Mon Jun  6 09:35:32 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] tileindex with ASTER hdf files
Message-ID: <20050606133533.20873.qmail@web53908.mail.yahoo.com>

Is it possible to use gdaltindex utility to build an
index shapefile from a set of level 1B ASTER hdf
files?  

Using gdal_wrarp to export the same HDF to geotiff
works fine. All spatial information is preserved. 
Running the gdaltindex utility I receive the error:

It appears no georeferencing is available for
`AST_L1B_00301242004093155_02052004113957.hdf',
skipping.

Thanks

From jicicuendez at gmv.es  Mon Jun  6 10:30:06 2005
From: jicicuendez at gmv.es (Juan Ignacio)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] scanned maps for mosaicking
Message-ID: <EOEFIDEELLFIPDAHPJHIIENDCPAA.jicicuendez@gmv.es>

Hi to everybody,

I am using gdal to create a mosaic composed of scanned maps in tiff format.
When I create this file the colour table of the first file in order to
create the output mosaick. The problem is that not all the imagery have the
same colour table therefore when you visualise the mosaic the only image
which remains the same in the one of the colour table but the colours of the
others have changed as the obviously had a different colour table. Does
anybody know if it is possible to circumvent this problem and create a
mosaic where all the colours look ok? Does the tiff format allow to include
all the colour tables? I would not like to re-scan all the imagery to the
same colour table.

Thanks in advance,
Juan Cicu?ndez

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Data Processing & On-Board Software Business Unit
Email: jicicuendez@gmv.es
Tel:    34-91-807-33-39    **Visit our webpage at http://www.gmv.com
Tel:    34-91-807-21-00 (switchboard)
Fax:    34-91-807-21-99
Isaac Newton 11, Tres Cantos, 28760 Madrid, SPAIN
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


______________________
Este mensaje, y en su caso, cualquier fichero anexo al mismo,
 puede contener informacion clasificada por su emisor como confidencial
 en el marco de su Sistema de Gestion de Seguridad de la 
Informacion siendo para uso exclusivo del destinatario, quedando 
prohibida su divulgacion copia o distribucion a terceros sin la 
autorizacion expresa del remitente. Si Vd. ha recibido este mensaje 
 erroneamente, se ruega lo notifique al remitente y proceda a su borrado. 
Gracias por su colaboracion.
______________________
This message including any attachments may contain confidential 
information, according to our Information Security Management System,
 and intended solely for a specific individual to whom they are addressed.
 Any unauthorised copy, disclosure or distribution of this message
 is strictly forbidden. If you have received this transmission in error,
 please notify the sender immediately and delete it.
______________________

From JAMES.E.HOPPER at saic.com  Mon Jun  6 10:35:16 2005
From: JAMES.E.HOPPER at saic.com (James E. Hopper)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Python Support on MacOSX
In-Reply-To: <20050606101028.D4C3C25E8D12@xserve.flids.com>
References: <20050606101028.D4C3C25E8D12@xserve.flids.com>
Message-ID: <C0DBAA96-7A6D-4729-8FE7-16382AE6F20F@saic.com>

What frank told me to do and it works fine is to use the following  
configure option

--without-libtool

by the way the gdal installer that frank put up for me for osx on his  
ftp site has python support.  i used it to run his python based test  
suite to make sure it worked correctly.

jim


From emolina at cts.udec.cl  Mon Jun  6 11:18:20 2005
From: emolina at cts.udec.cl (=?iso-8859-1?Q?Nicol=E1s_Molina_Ch.?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Problem with Visual Basic
Message-ID: <002b01c56aaa$f959be80$0cda4a98@Atlas>

Hi. Mr

cuestion?, as I compile libreria so that he is compatible with Visual Basic?

from already thank you very much

Nicol?s Molina Ch.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050606/35d7db79/attachment.html
From dron at ak4719.spb.edu  Mon Jun  6 15:51:34 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] tileindex with ASTER hdf files
In-Reply-To: <20050606133533.20873.qmail@web53908.mail.yahoo.com>
References: <20050606133533.20873.qmail@web53908.mail.yahoo.com>
Message-ID: <20050606195134.GA29705@ak4719.spb.edu>

On Mon, Jun 06, 2005 at 06:35:32AM -0700, Jon Saints wrote:
> Is it possible to use gdaltindex utility to build an index shapefile
> from a set of level 1B ASTER hdf files?  
> 
> Using gdal_wrarp to export the same HDF to geotiff works fine. All
> spatial information is preserved. Running the gdaltindex utility I
> receive the error:
> 
> It appears no georeferencing is available for
> `AST_L1B_00301242004093155_02052004113957.hdf', skipping.

Jon,

gdaltindex expects to found geotransformation matrix in the input file,
but ASTER Level 1B referenced with the set of ground control points. So
you shoud convert that dataset in other format (i.e., GeoTIFF) using
gdalwarp and try gdaltindex on that file.

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From dron at ak4719.spb.edu  Mon Jun  6 15:51:34 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] tileindex with ASTER hdf files
In-Reply-To: <20050606133533.20873.qmail@web53908.mail.yahoo.com>
References: <20050606133533.20873.qmail@web53908.mail.yahoo.com>
Message-ID: <20050606195134.GA29705@ak4719.spb.edu>

On Mon, Jun 06, 2005 at 06:35:32AM -0700, Jon Saints wrote:
> Is it possible to use gdaltindex utility to build an index shapefile
> from a set of level 1B ASTER hdf files?  
> 
> Using gdal_wrarp to export the same HDF to geotiff works fine. All
> spatial information is preserved. Running the gdaltindex utility I
> receive the error:
> 
> It appears no georeferencing is available for
> `AST_L1B_00301242004093155_02052004113957.hdf', skipping.

Jon,

gdaltindex expects to found geotransformation matrix in the input file,
but ASTER Level 1B referenced with the set of ground control points. So
you shoud convert that dataset in other format (i.e., GeoTIFF) using
gdalwarp and try gdaltindex on that file.

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From dron at ak4719.spb.edu  Mon Jun  6 15:56:58 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] scanned maps for mosaicking
In-Reply-To: <EOEFIDEELLFIPDAHPJHIIENDCPAA.jicicuendez@gmv.es>
References: <EOEFIDEELLFIPDAHPJHIIENDCPAA.jicicuendez@gmv.es>
Message-ID: <20050606195658.GB29705@ak4719.spb.edu>

On Mon, Jun 06, 2005 at 04:30:06PM +0200, Juan Ignacio wrote:
> I am using gdal to create a mosaic composed of scanned maps in tiff
> format. When I create this file the colour table of the first file in
> order to create the output mosaick. The problem is that not all the
> imagery have the same colour table therefore when you visualise the
> mosaic the only image which remains the same in the one of the colour
> table but the colours of the others have changed as the obviously had
> a different colour table. Does anybody know if it is possible to
> circumvent this problem and create a mosaic where all the colours look
> ok? Does the tiff format allow to include all the colour tables? I
> would not like to re-scan all the imagery to the same colour table.

Juan,

The simplest solution is to convert all your scans in the 24-bit RGB
format. You can do that with the tiff2rgba utility from the libtiff
package. Be ready that resulting images will be larger than original
ones, but not too much if you will use compression.

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From emolina at cts.udec.cl  Mon Jun  6 16:18:50 2005
From: emolina at cts.udec.cl (=?iso-8859-1?Q?Nicol=E1s_Molina_Ch.?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Problem with GDAL and Visual Basic 6
Message-ID: <011c01c56ad4$f39c87a0$0cda4a98@Atlas>

Hello

As I can compile libreria so that it can be used from Visual Basic 6.0, please

Nicol?s Molina Ch.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050606/99c642c0/attachment.html
From dylan at iici.no-ip.org  Tue Jun  7 02:09:24 2005
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] projection conversion equations
Message-ID: <2173f0ebe4f4eeaea038a7f8dba7f635@iici.no-ip.org>

Hi,

I would like to re-implement some functionality in the DHTML mapserver 
interface for converting between Lat/Lon to an Albers Equal Area 
Projection.

Currently, I have the proj library doing this for single coordinate 
pairs, but I would like to integrate this functionality in the form of 
a JS routine for on-the-fly conversion: much like the existing UTM 
<->lat/lon conversion.

Does anyone have any ideas on where to get started?

thanks in advance!

--
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341


From michele.sanges at otomelara.it  Tue Jun  7 05:18:57 2005
From: michele.sanges at otomelara.it (Michele Sanges)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Geometry Types
Message-ID: <42A56681.5060709@otomelara.it>

Hi all,

in file 'ogr_core.h' is defined this enum type:

typedef enum
{
     wkbUnknown = 0,
     wkbPoint = 1,
     wkbLineString = 2,
     wkbPolygon = 3,
     wkbMultiPoint = 4,
     wkbMultiLineString = 5,
     wkbMultiPolygon = 6,
     wkbGeometryCollection = 7,
     wkbNone = 100,
     wkbLinearRing = 101,
     wkbPoint25D = 0x80000001,
     wkbLineString25D = 0x80000002,
     wkbPolygon25D = 0x80000003,
     wkbMultiPoint25D = 0x80000004,
     wkbMultiLineString25D = 0x80000005,
     wkbMultiPolygon25D = 0x80000006,
     wkbGeometryCollection25D = 0x80000007
} OGRwkbGeometryType;


Where can i find the description of any of such geometry types, in 
particular the 25D extensions?

Thanks a lot.
Michele

From jicicuendez at gmv.es  Tue Jun  7 07:58:22 2005
From: jicicuendez at gmv.es (Juan =?utf-8?b?Q2ljdcOpbmRleg==?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: scanned maps for mosaicking
References: <EOEFIDEELLFIPDAHPJHIIENDCPAA.jicicuendez@gmv.es>
	<20050606195658.GB29705@ak4719.spb.edu>
Message-ID: <loom.20050607T135111-299@post.gmane.org>

Andrey Kiselev <dron <at> ak4719.spb.edu> writes:

> 
> On Mon, Jun 06, 2005 at 04:30:06PM +0200, Juan Ignacio wrote:
> > I am using gdal to create a mosaic composed of scanned maps in tiff
> > format. When I create this file the colour table of the first file in
> > order to create the output mosaick. The problem is that not all the
> > imagery have the same colour table therefore when you visualise the
> > mosaic the only image which remains the same in the one of the colour
> > table but the colours of the others have changed as the obviously had
> > a different colour table. Does anybody know if it is possible to
> > circumvent this problem and create a mosaic where all the colours look
> > ok? Does the tiff format allow to include all the colour tables? I
> > would not like to re-scan all the imagery to the same colour table.
> 
> Juan,
> 
> The simplest solution is to convert all your scans in the 24-bit RGB
> format. You can do that with the tiff2rgba utility from the libtiff
> package. Be ready that resulting images will be larger than original
> ones, but not too much if you will use compression.
> 
> Best regards,
> Andrey
> 
Thank you very much Andrey,

I tried to convert the imagery from normal tiff with colour table to RGB tiff 
with tiff2rgba. Somehow I obtain 4-banded files. Should it not be 3 bands 
instead? Is this normal?

Besides my program used to includ a line 
fileInfoArr[i] = new FileInfo(filename, oTargetSRS, temp_dir);

that fails now with the RGB tiff files; this might be related to my previous 
comment.

Any clue about what's going on or workarounds?

Cheers,
Juan




From dron at ak4719.spb.edu  Tue Jun  7 13:37:29 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: scanned maps for mosaicking
In-Reply-To: <loom.20050607T135111-299@post.gmane.org>
References: <EOEFIDEELLFIPDAHPJHIIENDCPAA.jicicuendez@gmv.es>
	<20050606195658.GB29705@ak4719.spb.edu>
	<loom.20050607T135111-299@post.gmane.org>
Message-ID: <20050607173729.GB13846@ak4719.spb.edu>

On Tue, Jun 07, 2005 at 11:58:22AM +0000, Juan Cicu?ndez wrote:
> > The simplest solution is to convert all your scans in the 24-bit RGB
> > format. You can do that with the tiff2rgba utility from the libtiff
> > package. Be ready that resulting images will be larger than original
> > ones, but not too much if you will use compression.
> 
> I tried to convert the imagery from normal tiff with colour table to
> RGB tiff with tiff2rgba. Somehow I obtain 4-banded files. Should it
> not be 3 bands instead? Is this normal?

Yes, that is normal (default) behaviour of the tiff2rgba utility. You
need the -n switch to disable the forth channel generation. The
following is taken from the tiff2rgba manual:

       -n     Drop  the alpha component from the output file, producing
	      a pure RGB file.  Currently this does not work if the -b
	      flag  is  also in effect.


> Besides my program used to includ a line 
> fileInfoArr[i] = new FileInfo(filename, oTargetSRS, temp_dir);
> 
> that fails now with the RGB tiff files; this might be related to my
> previous comment.

Sorry, but I didn't understand what that line does. Could you describe
your problem in more details?

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From saintsjd at yahoo.com  Wed Jun  8 11:31:30 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] quick one: gdal info one band in multiband image
In-Reply-To: <20050607173729.GB13846@ak4719.spb.edu>
Message-ID: <20050608153130.34483.qmail@web53910.mail.yahoo.com>

how can I tell gdalinfo gdal_translate to access a
specific band of a multiband Erdas IMG file?

Thanks

From nhv at cape.com  Wed Jun  8 11:40:34 2005
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] quick one: gdal info one band in multiband image
In-Reply-To: <20050608153130.34483.qmail@web53910.mail.yahoo.com>
Message-ID: <EKEJIKAILPONGGENMBGAIEIFLMAA.nhv@cape.com>

Jon Saints writes:
> 
> how can I tell gdalinfo gdal_translate to access a
> specific band of a multiband Erdas IMG file?

http://www.gdal.org/gdal_utilities.html#gdal_translate

see the -b option

HTH

Norman 

From mbrudka at aster.pl  Wed Jun  8 14:41:04 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Multi-threading Support
In-Reply-To: <931f8ea905060806395ad626f8@mail.gmail.com>
References: <931f8ea90505230903503c2b8e@mail.gmail.com>	
	<429B81E1.7020907@aster.pl>
	<931f8ea905060806395ad626f8@mail.gmail.com>
Message-ID: <42A73BC0.40804@aster.pl>

Frank,

>I'm back from vacation and will try to deal with outstanding issues
>as I can. 
>  
>
Fine. I hope you enjoyed you vacations :-).

>>In my company we assumed we cannot change PROJ.4, in particular
>>we cannot neither place *pj*_errno in thread specific storage nor
>>modify PROJ.4 to return error codes rather than to modify
>>global variables.
>>
>>This implied a global PROJ.4 mutex in ogrct.cpp and locking in the
>>following function/methods:
>>
>>LoadProjLibrary(),
>>char *OCTProj4Normalize( const char *pszProj4Src ),
>>OGRProj4CT::~OGRProj4CT(),
>>int OGRProj4CT::Initialize( OGRSpatialReference * poSourceIn,
>>                            OGRSpatialReference * poTargetIn )
>>int OGRProj4CT::TransformEx( int nCount, double *x, double *y, double *z,
>>                             int *pabSuccess ).
>>
>>Because all PROJ.4 related methods are enclosed in ogrct.cpp, PROJ.4 lock
>>has not to bo exposed outside GDAL. This was sufficient to achieve
>>reentrancy of all OGRSpatialReference related methods in OGR (at least in
>>our tests :-) )
>>    
>>
>
>Yes, I likely ought to incorporate such a change at my end as well.
>As mentioned on the proj mailing list, low level reprojection code in
>PROJ.4 is re-entrant, but aspects of the datum transformation and error
>handling are not. 
>  
>
The solution above works nicely for us. It costs 30 minutes (with
compilation) of work if CPLMutex and CPLMutexGuard are avalaible.

>>>For background, I have made a number of additions to cpl_multiproc.cpp/h
>>>including the addition of a mutex holder class.
>>>      
>>>
>>Great! I made a similiar class when was working on GDAL thread safety
>>few weeks ago. I even planned to post my changes, but I see I'm too
>>late :-). Let me share then my multithread experiences to make
>>GDAL a better software:
>>
>>1. It is better to separate the creation of the mutex from its locking
>>(see eg. boost:thread, ACE::ACE_Mutex). These activities are quite
>>different and it is better to not mix them.
>>Currently, in GDAL mutexes are locked during creation.  It is not very
>>convenient and GDAL by itself is a proof for this statement. In
>>1.2.6 mutexes were employed only in GDALwarp::alg, and they were
>>released just after they were created! Why to make such simple
>>operations so complex then?
>>    
>>
>
>This has indeed been a point of confusion for me as well.  However,
>I am now somewhat loath to change the convention.
>
Changing this convention in GDAL 1.2.6 ( in GDALwarp) costed me an
hour of work. But even in GDALwarp, in the only place in 1.2.6 where
mutexes were employed, the first step after mutex creation was to
release it. This convention seems to be not a very practical one then..

>  In fact, I now
>normally use the CPLCreateOrAcquireMutex() to acquire mutexes 
>deferring mutex creation to the first attempt to acquire them.  Otherwise
>it was sometimes messy to ensure that they were created in advance at
>a point with no other race conditions.  The CPLCreateOrAcquireMutex()
>is intended to ensure that two threads that try to create a given mutex
>at the same time will not have a race condition. 
>  
>
You will never avoid such races without additional (static) mutex created
without locking during init. It is impossible. I see in
CPLCreateOrCreateMutex
that you know this.

But what does it mean? It means that a convention is not very convenient.
Please forgive I make some statements "ex cathedra", but I
wrote too many programs and taught too many programmers and I am also
a little tired when talking about fundamentals which should obvious for any
intermediate multithread programmer.  Nevertheless, here is more elaborated
rationale for such mutex design:
http://www.boost.org/doc/html/threads/rationale.html#threads.rationale.locks

Let me recall also that boost library
http://www.boost.org/doc/html/threads.html
is going to be a part of the forthcoming C++ standard release. If about
mutex guard,
it is from ACE, namely:

[SchmidtStalRohnertBuschmann] Pattern-Oriented Architecture Volume 2.
Patterns
for Concurrent and Networked Objects. POSA2. Douglas C. Schmidt, Michael,
Hans Rohnert, and Frank Buschmann. WileyCopyright ? 2000,
or
http://www.dre.vanderbilt.edu/Doxygen/Stable/ace/classACE__Guard.html

>>2. Usually it is good to have a class for holding mutex (similiar to
>>CPLMutexHolder). But this class should be responsible for holding
>>a mutex only. It should expose and interface for direct
>>acquire/try_acquire/release, but should not lock a mutex by
>>itself in constructor (see eg. boost::thread, ACE::ACE_Mutex). In
>>fact such mutex holder should be a C++ wrapper around
>>native OS functions.
>>    
>>
>
>Well, this is a C++ wrapper around native OS functions, but I found
>it convenient to have the constructor acquire the mutex in most
>situations.   This means I just need to instantiate the holder in an
>appropriate local context such that it is released when the object
>falls out of context. 
>  
>
This is the role of CPLMutexGuard described below.

>I don't mean to imply that the CPLMutexHolder is the best abstraction
>of a mutex holder that could be developed.  But it is simple, and easy 
>for my purposes.
>  
>
I've been using classes similiar to CPLMutex and CPLMutexGuard for a
long time and they are also simple and convenient. Here is a sample from
modified ogrct.cpp using CPLMutex and CPLMutexGuard:
/* ==================================================================== */
/*      PROJ.4 interface stuff.                                         */
/* ==================================================================== */
...
// this is new line, plain static mutex invisible outside ogrct.cpp
static CPLMutex projLock; // A mutex to synchronize the access to PROJ.4
methods
...
static int LoadProjLibrary()

{
    CPLMutexGuard guard( projLock );
    .... //  LoadProjLibrary() implementation
} // here mutex is released by guard

>I would note that it makes no attempt to recover in the case that an 
>attempt to acquire a mutex times out.
>  
>
CPLMutex::acquire is parameterized by timeout. Constructor
is not, because it should not acquire mutex!

>>3. It is good to not use mutexes directly, but via guard class (see eg.
>>boost::thread,  ACE::ACE_Mutex) . The guard class ("the creation
>>of the object is resource allocation", Stroustrup) should acquire a
>>mutex when created and release it  when destroyed. Additionally,
>>a guard should expose a release method. In general, in larger
>>projects it is better to use guards rather than direct
>>direct locking, as this prevents some deadlocks.
>>
>>4. To serve specific purposes better, a guard class should have a
>>copy semantics aka. std::auto_ptr, namely left hand side guard
>>during copying (copy ctor, assignment operator) should grab
>>a mutex (disown) from RHS guard. This way, one
>>may return a guard to synchronize the access to an object and
>>be (almost) sure the mutex will be released. It is better solution
>>than exposing a mutex directly.
>>
>>I've attached an examplary cpl_mutex classes ( which fullfills 1-3
>>requirements) to this e-mail. If you find it usefull, please consider
>>using them in GDAL.
>>    
>>
>
>I read through the CPLMutex class you provided but I am not clear on
>it's utility or the rationale of a "guard".   I appologise for not having the
>time to follow up on some of your references. 
>  
>
Guard is a part of functionality related with acquiring and releasing
the mutex. I hope the code snapshot above explains everything.

>>Thread specific storage is avalaible on many platforms, but
>>unfortunatelly one cannot expect that a single macro solves
>>the problem in portable way. A more serious and portable
>>attempt is to create some wrappers for accessing thread specific
>>keys and then to define all those thread variables as a function
>>calls which get values from thread specific storage. Obviously, such
>>solution is more advanced, and requires much more work than
>>simple declspec or __thread. However, it seems that this is the
>>only way to achieve true portability across many platforms
>>(eg. see ACE).  Do you plan to restrict multithread GDAL to
>>win32/gcc 3.3 only?
>>    
>>
>
>I am aware of methods using pthreads for managing thread local
>data that would be more portable.  However, it requires a non-trivial
>amount of additional work for each thread-local variable, and am not
>currently keen on doing that.   For the time being I am prepared to 
>accept that proper multi-threading support for GDAL is only supported
>on win32 and platforms with modern gcc support - assuming that
>proves sufficient for the end-client. 
>
>If nothing else, having the CPL_THREADLOCAL macro in the code
>makes it easier in the future to identify variables that need to be
>addressed if a more comprehensive approach is needed.
>  
>
Thread specific storage is a part of boost::thread library. It's easy
to use and avalaible for many platforms.

I have a proposition, I made already once. Frank, make
GDAL dependent on boost library. This library contains
solutions for next C++ standard release. Boost is
avalaible on many more platforms than GDAL, and is
really easy to learn and use. Boost is written much better
than anything I saw (well, maybe except some parts of ACE :-) )
and can replace many parts of GDAL::port library. This way
porting GDAL to new platforms will be easier. Boost have
packages for most linuxes, there are distributions for windows.
Boost has commercial support and is recognized a place from
where C++ standard emerges now. I suppose boost would serve
GDAL very well and made GDAL better and avalaible on more
platforms.

I have also one question. Could you give me write access to gdal
CVS, please? Why? In my company we GDAL in our CVS repo,
because we have to remove GDAL bugs by our own (especially in
multithread, memory management and reference counting). I do not
need GDAL CVS access for this, but it's just a pity these changes
are not avalaible for GDAL community. I also do not like merging our
changes
with each new GDAL release. Let me mention also I'm too
busy to report and discuss such bugs each time I recognize or fix them.
A bug report and a discussion which usually follows it takes more time
than fixing bugs! It is not the best way to develop the software.

BTW. There is a serious design problem with reference counting and
memory management in multithread GDAL applications. It makes
the read only sharing of OGRSpatialReference ( and remaining
reference counted classes ) between threads almost impossible . This
problem is a direct implication of lack of correct reference counting via
intrusive smart pointer classes as well as by invalid convention for
mutexes.

Thanks

Marek


From fwarmerdam at gmail.com  Wed Jun  8 15:07:39 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Multi-threading Support
In-Reply-To: <42A73BC0.40804@aster.pl>
References: <931f8ea90505230903503c2b8e@mail.gmail.com>
	<429B81E1.7020907@aster.pl>
	<931f8ea905060806395ad626f8@mail.gmail.com> <42A73BC0.40804@aster.pl>
Message-ID: <931f8ea905060812077ec6a3e6@mail.gmail.com>

On 6/8/05, Marek Brudka <mbrudka@aster.pl> wrote:
> The solution above works nicely for us. It costs 30 minutes (with
> compilation) of work if CPLMutex and CPLMutexGuard are avalaible.

Marek,

I have committed a change to ogrct.cpp to protect PROJ.4 calls 
with a mutex.  If you see problems with my implementation please correct.
 
> I have a proposition, I made already once. Frank, make
> GDAL dependent on boost library. 

I remain unprepared to make such a shift though I can see the
advantages you have enumerated. 
 
> I have also one question. Could you give me write access to gdal
> CVS, please? 

Done, as per private email.

> Why? In my company we GDAL in our CVS repo,
> because we have to remove GDAL bugs by our own (especially in
> multithread, memory management and reference counting). I do not
> need GDAL CVS access for this, but it's just a pity these changes
> are not avalaible for GDAL community. I also do not like merging our
> changes
> with each new GDAL release. Let me mention also I'm too
> busy to report and discuss such bugs each time I recognize or fix them.
> A bug report and a discussion which usually follows it takes more time
> than fixing bugs! It is not the best way to develop the software.

Generally speaking I am happy to provide responsible developers
with CVS commit access to GDAL.  The caveat is that I am still quite
possesive about GDAL so I would prefer you not apply potentially
controversial changes without prior discussion.  Sometimes my resistance
to change is bad for progress in GDAL, but at least it ensures I stay 
comfortable with the library and ensures I am prepared to take responsibility
for it as a whole. 

> BTW. There is a serious design problem with reference counting and
> memory management in multithread GDAL applications. It makes
> the read only sharing of OGRSpatialReference ( and remaining
> reference counted classes ) between threads almost impossible . This
> problem is a direct implication of lack of correct reference counting via
> intrusive smart pointer classes as well as by invalid convention for
> mutexes.

I am aware of the problems with reference management of OGRSpatialReferences
and I agree something needs to be done.  The caveat is that many existing
OGR drivers need to be reviewed very carefully to ensure proper use of
OGRSpatialReference as part of this change.  
 
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From reder at jpl.nasa.gov  Wed Jun  8 15:02:57 2005
From: reder at jpl.nasa.gov (Leonard J. Reder)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] GeoTiff PDS or ISIS test images
Message-ID: <42A740E1.4050509@jpl.nasa.gov>

Hello,

I am looking for test images to validate that the computations for 
mapping coordinates within a software module are correct.  What I am 
after are image sets not of actual data but rather of a correctly 
generated sets of simple shapes on a lat,lon and elevation coordinate 
system.   For example I would like to find a GeoTiff that contains 
groups of 100 meter on edge cubes that are spaced and at verious heights 
spread over a planetary surface.  My interest is mainly in GeoTiff but 
if this sort of thing exists in ISIS or PDS format I probably can 
convert it.  If anyone knows of such data sets could they send me 
instructions on how to get a hold of them?

Thanks for any and all replies,

Len
-- 
____________________________________________________
Leonard J. Reder
Jet Propulsion Laboratory
Interferometry Systems and Technology Section
Robotics and Mobility
Email: reder@huey.jpl.nasa.gov
Phone (Voice): 818-354-3639
Phone (FAX): 818-354-4357
Mail Address:
Mail Stop: 171-113
4800 Oak Grove Dr.
Pasadena, CA. 91109
---------------------------------------------------



From fwarmerdam at gmail.com  Wed Jun  8 15:19:17 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] GeoTiff PDS or ISIS test images
In-Reply-To: <42A740E1.4050509@jpl.nasa.gov>
References: <42A740E1.4050509@jpl.nasa.gov>
Message-ID: <931f8ea905060812191585bd06@mail.gmail.com>

On 6/8/05, Leonard J. Reder <reder@jpl.nasa.gov> wrote:
> Hello,
> 
> I am looking for test images to validate that the computations for
> mapping coordinates within a software module are correct.  What I am
> after are image sets not of actual data but rather of a correctly
> generated sets of simple shapes on a lat,lon and elevation coordinate
> system.   For example I would like to find a GeoTiff that contains
> groups of 100 meter on edge cubes that are spaced and at verious heights
> spread over a planetary surface.  My interest is mainly in GeoTiff but
> if this sort of thing exists in ISIS or PDS format I probably can
> convert it.  If anyone knows of such data sets could they send me
> instructions on how to get a hold of them?

Leonard, 

I'm not sure I follow what you mean by "cubes" or "at various heights"
given the essentially 2D nature of TIFF images.  Are you wanting to verify
that you can relate positions on a projected raster back to lat/long properly?
If so, generating 2 band floating point images with one band being latitude
and one band being longitude, and then reprojecting those to some 
projected coordinate system might be useful.  

If you can't find a way of doing that yourself, I could prepare a small utility 
to do it.  But in the end, the results are only as trustworthy as the GDAL 
reprojection support. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jun  8 16:42:28 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Geometry Types
In-Reply-To: <42A56681.5060709@otomelara.it>
References: <42A56681.5060709@otomelara.it>
Message-ID: <931f8ea90506081342561ece77@mail.gmail.com>

On 6/7/05, Michele Sanges <michele.sanges@otomelara.it> wrote:
> Hi all,
> 
> in file 'ogr_core.h' is defined this enum type:
> 
> typedef enum
> {
>      wkbUnknown = 0,
>      wkbPoint = 1,
>      wkbLineString = 2,
>      wkbPolygon = 3,
>      wkbMultiPoint = 4,
>      wkbMultiLineString = 5,
>      wkbMultiPolygon = 6,
>      wkbGeometryCollection = 7,
>      wkbNone = 100,
>      wkbLinearRing = 101,
>      wkbPoint25D = 0x80000001,
>      wkbLineString25D = 0x80000002,
>      wkbPolygon25D = 0x80000003,
>      wkbMultiPoint25D = 0x80000004,
>      wkbMultiLineString25D = 0x80000005,
>      wkbMultiPolygon25D = 0x80000006,
>      wkbGeometryCollection25D = 0x80000007
> } OGRwkbGeometryType;
> 
> 
> Where can i find the description of any of such geometry types, in
> particular the 25D extensions?

Michele,

What sort of information were you looking for?  Many of these codes
correspond in a relatively obvious way to classes derived from OGRGeometry
and can be tracked from:

  http://www.gdal.org/ogr/classOGRGeometry.html

The 25D version are the normal 2D versions, but with a Z value for each vertex.
The geometry classes are based on the OpenGIS Simple Features geometry
model, so looking at the corresponding OGC spectifications could be useful. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From reder at jpl.nasa.gov  Wed Jun  8 17:18:24 2005
From: reder at jpl.nasa.gov (Leonard J. Reder)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] GeoTiff PDS or ISIS test images
In-Reply-To: <931f8ea905060812191585bd06@mail.gmail.com>
References: <42A740E1.4050509@jpl.nasa.gov>
	<931f8ea905060812191585bd06@mail.gmail.com>
Message-ID: <42A760A0.7000905@jpl.nasa.gov>

Thanks for the reply Frank,

Yes I am unclear and somewhat new to this area.  What I did not say was 
that I am interested in checking lat, lon but also checking elevation. 
We have two planet models in our simulation code and use Gdal as an API 
to various Geo file formats.  My main interest at the momment is testing 
that we can do proper mapping of elevation in the code.  This will of 
course depend on the source file having a good planet model.  So I 
thought someone from USGS or JPL might see the message and have a set of 
test images that could be downloaded.

The problem if I generate it is, that I will be doing it the way I think 
it should be done.  This may not be the way Gdal or other GeoTiff 
generators do it.

Len

Frank Warmerdam wrote:

> On 6/8/05, Leonard J. Reder <reder@jpl.nasa.gov> wrote:
> 
>>Hello,
>>
>>I am looking for test images to validate that the computations for
>>mapping coordinates within a software module are correct.  What I am
>>after are image sets not of actual data but rather of a correctly
>>generated sets of simple shapes on a lat,lon and elevation coordinate
>>system.   For example I would like to find a GeoTiff that contains
>>groups of 100 meter on edge cubes that are spaced and at verious heights
>>spread over a planetary surface.  My interest is mainly in GeoTiff but
>>if this sort of thing exists in ISIS or PDS format I probably can
>>convert it.  If anyone knows of such data sets could they send me
>>instructions on how to get a hold of them?
> 
> 
> Leonard, 
> 
> I'm not sure I follow what you mean by "cubes" or "at various heights"
> given the essentially 2D nature of TIFF images.  Are you wanting to verify
> that you can relate positions on a projected raster back to lat/long properly?
> If so, generating 2 band floating point images with one band being latitude
> and one band being longitude, and then reprojecting those to some 
> projected coordinate system might be useful.  
> 
> If you can't find a way of doing that yourself, I could prepare a small utility 
> to do it.  But in the end, the results are only as trustworthy as the GDAL 
> reprojection support. 
> 
> Best regards,

-- 
____________________________________________________
Leonard J. Reder
Jet Propulsion Laboratory
Interferometry Systems and Technology Section 383
Email: reder@huey.jpl.nasa.gov
Phone (Voice): 818-354-3639
Phone (FAX): 818-354-4357
Mail Address:
Mail Stop: 171-113
4800 Oak Grove Dr.
Pasadena, CA. 91109
---------------------------------------------------


From alessandro.peloso at portici.enea.it  Thu Jun  9 05:22:06 2005
From: alessandro.peloso at portici.enea.it (alessandro.peloso)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Compile problem on AIX5.1
Message-ID: <42A80A3E.1040403@portici.enea.it>

Hi list,
I need to compile gdal (version 1.2.6) on IBM AIX 5.1.
Someone can help me to workaround the well known bug#:498 ( --> libtiff 
bug#:39)?

These are some output from my system:

%oslevel -r
 5100-04

%gcc -v
...
Reading specs from 
/opt/freeware/lib/gcc-lib/powerpc-ibm-aix5.1.0.0/3.3.2/specs
Configured with: ../configure --with-as=/usr/bin/as 
--with-ld=/usr/bin/ld --disable-nls --enable-languages=c,c++ 
--prefix=/opt/freeware --enable-threads 
--enable-version-specific-runtime-libs --host=powerpc-ibm-aix5.1.0.0
Thread model: aix
gcc version 3.3.2

So far i tried:

-remove the patch to tiff.h;
-building without libtool;
-compile with VisualAge cc and gcc;

but with no success...

Any help will be appreciated.

Thanks

Alessandro Peloso
ENEA CR Portici
alessandro.peloso@portici.enea.it


_______________________________________
MAIL SCANSIONATA DA ANTIVIRUS GATEWAY
(Outbound)
.#ENEA#.
_______________________________________

From potts at cfl.rr.com  Thu Jun  9 07:18:36 2005
From: potts at cfl.rr.com (Garrett Potts)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] rmfdataset compile error on mac
Message-ID: <3A5BCA2D-B150-496A-9B51-A24225BF2CD9@cfl.rr.com>

Hello All:


I am getting a compile error on the CVS version of GDAL when  
compiling the rmfdataset.  It appears to be in the #ifdef CPL_MSB  
cases.  The oGDS-> need to be named poGDS->  and a variable i needs  
to be defined in the IWriteBlock method.


Take care all

Garrett

From dron at ak4719.spb.edu  Thu Jun  9 15:25:28 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] rmfdataset compile error on mac
In-Reply-To: <3A5BCA2D-B150-496A-9B51-A24225BF2CD9@cfl.rr.com>
References: <3A5BCA2D-B150-496A-9B51-A24225BF2CD9@cfl.rr.com>
Message-ID: <20050609192528.GA29737@ak4719.spb.edu>

On Thu, Jun 09, 2005 at 07:18:36AM -0400, Garrett Potts wrote:
> I am getting a compile error on the CVS version of GDAL when  
> compiling the rmfdataset.  It appears to be in the #ifdef CPL_MSB  
> cases.  The oGDS-> need to be named poGDS->  and a variable i needs  
> to be defined in the IWriteBlock method.

Should be fixed now. Sorry for inconvinence.

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From fwarmerdam at gmail.com  Thu Jun  9 16:23:42 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Status Report: PCIDSK, PAM
Message-ID: <931f8ea9050609132314535c9d@mail.gmail.com>

Folks,

I'm back from vacation and prepping for the OSGEO'05 conference
and ESIP meetings next week.  My ability to deal with requests and
bug reports will be some what impedded till the week after next. 

PCIDSK:

While away I have implemented support for reading PCIDSK overviews
and also support for tiled PCIDSK files.  

Imagine Overviews:

Shortly before leaving I implemented support for building overviews in
Erdas Imagine files (.img) in the internal format, even for very large
files.  Currently TIFF overviews (ie. .ovr files) can only be up to
4GB in size, so currently Imagine is the only format where GDAL can
build overviews for extremely large datasets.  That is images where 
even the overviews are larger than 4GB. 

PAM: 

The PAM effort is still ongoing.  I recently changed the name of the
auxilary files produced by the PAM classes to have the extension
.aux.xml.  So the auxilary file for irvine.pix would be irvine.pix.aux.xml.
If you have .pam files sitting around you might as well delete or
rename them.  There is still a variety of work to do on PAM support
before I will snapshot a next GDAL release. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From carlos.garcia at sigtech-co.com  Thu Jun  9 16:26:48 2005
From: carlos.garcia at sigtech-co.com (CARLOS GARCIA)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] NETCDF Support
In-Reply-To: <429BC10F.7050900@dmsolutions.ca>
Message-ID: <000001c56d31$9111b8d0$090001c0@CARLOSG>

Does anybody know what kind of support provides GDAL to the NETCDF
format? Can I read? Can I create? Can I translate?

Is there any example of how to use it, I really apreciate

Carlos Garcia



From fwarmerdam at gmail.com  Thu Jun  9 16:51:19 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] NETCDF Support
In-Reply-To: <000001c56d31$9111b8d0$090001c0@CARLOSG>
References: <429BC10F.7050900@dmsolutions.ca>
	<000001c56d31$9111b8d0$090001c0@CARLOSG>
Message-ID: <931f8ea905060913516cb38491@mail.gmail.com>

Carlos, 

There is discussion of the existing NetCDF driver at:

  http://www.gdal.org/frmt_various.html#netCDF

There are a variety of limitations and it is only available if GDAL 
is built with netCDF support enabled - it depends on an external library.

If I may say so, I think the current GDAL netCDF support is somewhat
crappy, but it does work in some situations.  I hope to overall it at
some point. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jacob.delfos at maunsell.com  Thu Jun  9 21:00:47 2005
From: jacob.delfos at maunsell.com (Delfos, Jacob)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
Message-ID: <E290303DB48F754B95D3172270AA0F2CEAA111@auper1ex001.au.aecomnet.com>

Hi All,

Have a bit of a mystery:

I am translating some geotiffs to ecw. These geotiffs have their geographic
information internally in the headers, as well as in a tfw file. They all
translate fine, and the coordinate information in the ecw file is recognised
in ESRI ArcGIS.

One TIFF file, however, I have modified in photoshop, so it lost its
geographic information in the header, but it still has its tfw file. When I
translate it to ecw (using the same command as for the other files), its
coordinate information is not recognised by ESRI ArcGIS. However, its
internal coordinate information IS recognised by other software (gdalinfo,
er viewer, global mapper, etc.). 

So when translating a TIFF with worldfile, the coordinate information seems
to exist internally in the ecw file, is recognised by most software, but not
by ArcGIS. To make it more interesting: If I translate the same file with
the freeware "ecw compressor" from ER Mapper, the resulting ecw file is
correctly referenced by ArcGIS.

In ER Viewer, the image properties are different: the one created by the
compressor has a WGS84 Datum, Coordinate System "Local", Coordinate type
"UTM (Eastings/Northings)" (which should be latlong). For the Gdal ECW,
these properties are set to "RAW".


The command I used:

C:\install\gdal\compiling\apps>gdal_translate -of ECW
C:\temp\gdal\SRTM4_tasmania_ACRES_trueColour.tif
C:\temp\gdal\SRTM4_tasmania_ACRES_trueColour.ecw -co "QUALITY=6"

Gdalinfo on the TIFF:
------------------------------------------------------------
Driver: GTiff/GeoTIFF
Size is 6150, 5217
Coordinate System is `'
Origin = (143.624867,-39.368522)
Pixel Size = (0.00083333,-0.00083333)
Metadata:
  TIFFTAG_SOFTWARE=Adobe Photoshop CS Windows
  TIFFTAG_DATETIME=2005:06:09 16:18:41
  TIFFTAG_XRESOLUTION=72
  TIFFTAG_YRESOLUTION=72
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Corner Coordinates:
Upper Left  ( 143.6248668, -39.3685216)
Lower Left  ( 143.6248668, -43.7160216)
Upper Right ( 148.7498668, -39.3685216)
Lower Right ( 148.7498668, -43.7160216)
Center      ( 146.1873668, -41.5422716)
Band 1 Block=6150x1 Type=Byte, ColorInterp=Red
Band 2 Block=6150x1 Type=Byte, ColorInterp=Green
Band 3 Block=6150x1 Type=Byte, ColorInterp=Blue


Why is the coordinate information written to the header of the ECW file
different if a TFW is used? It's not a drama, but it would be nice if it
worked in ESRI.

Regards,

Jacob


JACOB DELFOS
SPATIAL INFORMATION ANALYST
Maunsell Australia Pty Ltd
629 Newcastle Street, Leederville, WA 6007
PO Box 81, Leederville, WA 6902
Western Australia
ABN 20 093 846 925

Tel     + 61 8 9281 6185
Fax    + 61 8 9281 6297
jacob.delfos@maunsell.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050610/777f6684/attachment.html
From tflynch at gmail.com  Thu Jun  9 21:26:13 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW build and licensing,
	forthcoming source distribution (was: ECW Problems?)
In-Reply-To: <Pine.LNX.4.58.0506031316420.10727@fastcat.binko.net>
References: <s2a03d31.006@co5.dnr.state.mn.us>
	<Pine.LNX.4.58.0506031316420.10727@fastcat.binko.net>
Message-ID: <c39b2a650506091826187d6c55@mail.gmail.com>

Hi Bill,

Thanks for reporting this problem, we're checking it out.  The ECW
JPEG 2000 SDK RC2 source code has actually been online for some time,
and should be slightly more pleasant out of the box than RC1.

We (ER Mapper) have been very aware of the ongoing issues with
building the SDK and are currently hunting for a silver bullet ... a
new release candidate is due out soon with a new build system allowing
all ECW and JPEG 2000 support (what was previously NCSEcw, NCSUtil and
NCScnet) to be combined in either one static, or one shared library
object (which we are referring to as libecwj2).

The new source code distribution will also ship with the standard
example code and makefiles for building with the new single library
structure, which should help people get to grips with the ECW JPEG
2000 SDK.  I have been mentioning it to people for a while now, but
for various reasons (mainly legacy code, the introduction of static
linkage and the need for cross-platform testing) it has not been made
available yet.

The old build system will continue in place for the time being as
well.  The goal is to turn building the library into a one-liner on
Win32 and common *NIX platforms including GNU/Linux, Solaris and Mac
OS X.

Also, yesterday it was confirmed to me that the "server software
restriction" (which theoretically prohibited OSS projects built on the
SDK from including server components) is being lifted from the Public
Use License Agreement, the SDK's copyleft-restricted license.  This
means it is now available under a license very nearly equivalent to
the GPL.

The SDK has two other licenses for Free Use (MIT-style with a
restriction on the maximum size of input datasets for ECW and JPEG
2000 compression ) and Commercial Use - these continue to include the
"server restriction" - for the time being - for commercial reasons.

Tom.

On 6/4/05, Bill Binko <bill@binko.net> wrote:
<snip>
> 
> Thanks! However, it looks like a nightmare to build!
> 
> I'll give it a shot
> Bill


-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From tflynch at gmail.com  Thu Jun  9 21:42:33 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
In-Reply-To: <E290303DB48F754B95D3172270AA0F2CEAA111@auper1ex001.au.aecomnet.com>
References: <E290303DB48F754B95D3172270AA0F2CEAA111@auper1ex001.au.aecomnet.com>
Message-ID: <c39b2a65050609184254118378@mail.gmail.com>

On 6/10/05, Delfos, Jacob <jacob.delfos@maunsell.com> wrote:
>  
> 
> Hi All, 
> 
> Have a bit of a mystery: 
> 
> I am translating some geotiffs to ecw. These geotiffs have their geographic
> information internally in the headers, as well as in a tfw file. They all
> translate fine, and the coordinate information in the ecw file is recognised
> in ESRI ArcGIS. 
<snip>

Hi Jacob,

There are some subtleties in ECW georeferencing, which I can explain
for you.  I think the issue you're seeing is probably a minor flaw in
GDAL, though I haven't checked this.

ER Mapper uses a proprietary georeferencing system called GDT (which
AFAIK predates the popularisation of EPSG) in which a dataset is
referenced by a projection string, a datum string, and registration
information.

This data is embedded in a binary header of an ECW file, and includes
x and y origins, x and y cell sizes, and cell size units, as well as
the projection and datum.  For example, "WGS84/GEODETIC" is one of the
most common datum/projection pairs, corresponding to EPSG code 4326.

ER Mapper supports importing datasets with EPSG codes using an
in-built correspondence between EPSG and GDT.  Usually non-geographic
rasters are stored with RAW/RAW as their projection/datum.  However,
if a raster marked RAW/RAW also contains embedded georeferencing
information (such as you might find in a TFW) indicating it has a
geographical purpose, it is imported into ER Mapper software with a
"fake" projection/datum "WGS84/LOCAL" allowing it to be world-aligned
with datasets in other map layers.

There are several flaws in the system.  One of them is that the
EPSG<-->GDT correspondence is not 1-1, so converting between a GeoTIFF
and an ECW file and back again may lose or change the referencing. 
Another is that ECW does not support the storage of rotated or sheared
registrations (only origin and pixel scale are supported).  Finally,
non-EPSG coordinate system information embedded in a GeoTIFF will
usually be ignored by ER Mapper software at this point in time.

As far as registration is concerned, the ECW JPEG 2000 SDK is fairly
"blind" concerning the binary values stored in the registration area
of an ECW file, so third party applications may store invalid data in
this location.  ArcGIS is one application that has problems if (for
example) the sign of the y cellsize is inverted.  So that's probably
the reason you can't view the GDAL-translated file in ArcGIS with the
ECW plug-in.

-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From jacob.delfos at maunsell.com  Thu Jun  9 23:03:32 2005
From: jacob.delfos at maunsell.com (Jacob Delfos)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
Message-ID: <000801c56d68$fd8a68e0$5d2815ac@au.aecomnet.com>

Hi Tom,

Thanks for that explanation. Now I understand where the WGS84/LOCAL info keeps coming from. So probably ArcGIS doesn't like that dataset, because the SDK (or Gdal) didn't put this fake coordinate system in it. It could be because of the inverted Y sign, but if I copy the .tfw (of the original TIF) to a .eww, ArcGIS reads and registers the ECW fine.

Regarding rotated and sheared registrations: ArcGIS allows you to georeference an ECW, and as long as you use an affine projection, it will create a .eww file for it (with rotation or shear if applicable). So is this technically incorrect?

regards,

Jacob




-----Original Message-----
From: Tom Lynch [mailto:tflynch@gmail.com] 
Sent: 10 June 2005 09:43
To: Delfos, Jacob
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] ECW registration information not recognised in ESRI

On 6/10/05, Delfos, Jacob <jacob.delfos@maunsell.com> wrote:
>  
> 
> Hi All, 
> 
> Have a bit of a mystery: 
> 
> I am translating some geotiffs to ecw. These geotiffs have their geographic
> information internally in the headers, as well as in a tfw file. They all
> translate fine, and the coordinate information in the ecw file is recognised
> in ESRI ArcGIS. 
<snip>

Hi Jacob,

There are some subtleties in ECW georeferencing, which I can explain
for you.  I think the issue you're seeing is probably a minor flaw in
GDAL, though I haven't checked this.

ER Mapper uses a proprietary georeferencing system called GDT (which
AFAIK predates the popularisation of EPSG) in which a dataset is
referenced by a projection string, a datum string, and registration
information.

This data is embedded in a binary header of an ECW file, and includes
x and y origins, x and y cell sizes, and cell size units, as well as
the projection and datum.  For example, "WGS84/GEODETIC" is one of the
most common datum/projection pairs, corresponding to EPSG code 4326.

ER Mapper supports importing datasets with EPSG codes using an
in-built correspondence between EPSG and GDT.  Usually non-geographic
rasters are stored with RAW/RAW as their projection/datum.  However,
if a raster marked RAW/RAW also contains embedded georeferencing
information (such as you might find in a TFW) indicating it has a
geographical purpose, it is imported into ER Mapper software with a
"fake" projection/datum "WGS84/LOCAL" allowing it to be world-aligned
with datasets in other map layers.

There are several flaws in the system.  One of them is that the
EPSG<-->GDT correspondence is not 1-1, so converting between a GeoTIFF
and an ECW file and back again may lose or change the referencing. 
Another is that ECW does not support the storage of rotated or sheared
registrations (only origin and pixel scale are supported).  Finally,
non-EPSG coordinate system information embedded in a GeoTIFF will
usually be ignored by ER Mapper software at this point in time.

As far as registration is concerned, the ECW JPEG 2000 SDK is fairly
"blind" concerning the binary values stored in the registration area
of an ECW file, so third party applications may store invalid data in
this location.  ArcGIS is one application that has problems if (for
example) the sign of the y cellsize is inverted.  So that's probably
the reason you can't view the GDAL-translated file in ArcGIS with the
ECW plug-in.

-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050610/6df8b3f3/attachment.html
From bill at binko.net  Thu Jun  9 23:41:48 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW build and licensing,
	forthcoming source distribution (was: ECW Problems?)
In-Reply-To: <c39b2a650506091826187d6c55@mail.gmail.com>
References: <s2a03d31.006@co5.dnr.state.mn.us>
	<Pine.LNX.4.58.0506031316420.10727@fastcat.binko.net>
	<c39b2a650506091826187d6c55@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0506092335330.28991@fastcat.binko.net>


Tom, thanks for the update.

I recently got ECW DOQQs for about 1/4 of Florida, which I'd like to
integrate into my mapserver-based site.  To do that effectively, I need
GDAL to work well with them, and hence a working ECW library.I am looking
forward to being able to use GDAL's utilities to build a pyramid tiling
scheme and making these available to my users.

As I mentioned in the post, (for the benefit of those cross-posted) the
current problem happenes about 1 in 3 executions of any GDAL utility (or
mapserver call to GDAL), and basically never lets the process end.  There
is a hanging thread or a deadlock somewhere between the GDAL and ECW use 
of pthreads.

I am happy to assist in debugging this, but would like to do so with the 
most recent version possible, and only if necessary. 

I have downloaded RC2 and will to build it and try again.  It will 
probably be Monday before I can report back.

Thanks for the update, and I (seriously) look forward to the simpler build 
system (hint, hint - autoconf is EVIL, but it works).

Thanks

Bill

PS: now that Frank is back from vacation, I might bug him about this as 
well :)



On Fri, 10 Jun 2005, Tom Lynch wrote:

> Hi Bill,
> 
> Thanks for reporting this problem, we're checking it out.  The ECW
> JPEG 2000 SDK RC2 source code has actually been online for some time,
> and should be slightly more pleasant out of the box than RC1.
> 
> We (ER Mapper) have been very aware of the ongoing issues with
> building the SDK and are currently hunting for a silver bullet ... a
> new release candidate is due out soon with a new build system allowing
> all ECW and JPEG 2000 support (what was previously NCSEcw, NCSUtil and
> NCScnet) to be combined in either one static, or one shared library
> object (which we are referring to as libecwj2).
> 
> The new source code distribution will also ship with the standard
> example code and makefiles for building with the new single library
> structure, which should help people get to grips with the ECW JPEG
> 2000 SDK.  I have been mentioning it to people for a while now, but
> for various reasons (mainly legacy code, the introduction of static
> linkage and the need for cross-platform testing) it has not been made
> available yet.
> 
> The old build system will continue in place for the time being as
> well.  The goal is to turn building the library into a one-liner on
> Win32 and common *NIX platforms including GNU/Linux, Solaris and Mac
> OS X.
> 
> Also, yesterday it was confirmed to me that the "server software
> restriction" (which theoretically prohibited OSS projects built on the
> SDK from including server components) is being lifted from the Public
> Use License Agreement, the SDK's copyleft-restricted license.  This
> means it is now available under a license very nearly equivalent to
> the GPL.
> 
> The SDK has two other licenses for Free Use (MIT-style with a
> restriction on the maximum size of input datasets for ECW and JPEG
> 2000 compression ) and Commercial Use - these continue to include the
> "server restriction" - for the time being - for commercial reasons.
> 
> Tom.
> 
> On 6/4/05, Bill Binko <bill@binko.net> wrote:
> <snip>
> > 
> > Thanks! However, it looks like a nightmare to build!
> > 
> > I'll give it a shot
> > Bill
> 
> 
> 

From jicicuendez at gmv.es  Fri Jun 10 08:12:56 2005
From: jicicuendez at gmv.es (Juan =?utf-8?b?Q2ljdcOpbmRleg==?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Error in reading gtiff from ERDAS Imagine
Message-ID: <loom.20050610T114831-37@post.gmane.org>

Hi everybody,

I am trying to write 1 band DEMS files into a tiff files. Even though the image 
looks ok in pci geomatics and ENVI, it is not possible to load it on ERDAS. 
ERDAS takes de image as 3 band rather of just 1 and when loads the image it 
can't find the band 3. In the past I was using the same code to generate colour 
coded tiff and I had no problems with gdal vs 1.2.1. Now I am on 1.2.6 and I 
was using the option:

status = GDALSetMetadataItem( poDriver, "INTERLEAVE", "PIXEL", "" );

Has anyone bumped into this problem? Any advise will most appreciated.

Cheers,
Juan 


From fwarmerdam at gmail.com  Fri Jun 10 09:08:14 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Error in reading gtiff from ERDAS Imagine
In-Reply-To: <loom.20050610T114831-37@post.gmane.org>
References: <loom.20050610T114831-37@post.gmane.org>
Message-ID: <931f8ea905061006083c93ce33@mail.gmail.com>

On 6/10/05, Juan Cicu?ndez <jicicuendez@gmv.es> wrote:
> Hi everybody,
> 
> I am trying to write 1 band DEMS files into a tiff files. Even though the image
> looks ok in pci geomatics and ENVI, it is not possible to load it on ERDAS.
> ERDAS takes de image as 3 band rather of just 1 and when loads the image it
> can't find the band 3. In the past I was using the same code to generate colour
> coded tiff and I had no problems with gdal vs 1.2.1. Now I am on 1.2.6 and I
> was using the option:
> 
> status = GDALSetMetadataItem( poDriver, "INTERLEAVE", "PIXEL", "" );
> 
> Has anyone bumped into this problem? Any advise will most appreciated.

Juan,

I am not sure why this isn't working.  Can you provide me with access
to the GeoTIFF file that isn't readable in Imagine? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jun 10 09:29:03 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
In-Reply-To: <E290303DB48F754B95D3172270AA0F2CEAA111@auper1ex001.au.aecomnet.com>
References: <E290303DB48F754B95D3172270AA0F2CEAA111@auper1ex001.au.aecomnet.com>
Message-ID: <931f8ea905061006291db57e7f@mail.gmail.com>

On 6/9/05, Delfos, Jacob <jacob.delfos@maunsell.com> wrote:
> Have a bit of a mystery: 
> 
> I am translating some geotiffs to ecw. These geotiffs have their geographic
> information internally in the headers, as well as in a tfw file. They all
> translate fine, and the coordinate information in the ecw file is recognised
> in ESRI ArcGIS. 

Jacob, 

I would suggest trying to apply the coordinate system while you are
translating to ECW.  Adding '-a_srs WGS84' on the gdal_translate 
commandline should do the trick. 

A longer term solution on my part might be to apply a more 
appropriate dummy coordinate system instead of RAW if I am 
translating data with no coordinate system, but a meaningful
geotransform.  If you open a bug on this issue, I will look into it.
I may need Tom's advise on appropriate fallback coordinate systems
for coordinates that are apparently geodetic or projected.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From tflynch at gmail.com  Sun Jun 12 20:49:19 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
In-Reply-To: <000801c56d68$fd8a68e0$5d2815ac@au.aecomnet.com>
References: <000801c56d68$fd8a68e0$5d2815ac@au.aecomnet.com>
Message-ID: <c39b2a6505061217497db67f35@mail.gmail.com>

Jacob - sounds right.

With respect to affine and sheared registrations - the situation is that it 
isn't possible to store them in the header of an ECW file (the file header 
stores world origin and world cell size rather than affine values). There is 
nothing to stop an application such as ArcGIS from reading the raster data 
and applying an affine transformation to it based on some other content - 
such as a world file - or creating an auxiliary file when saving a working 
set out to ECW. But a problem can then arise if the dataset gets separated 
from the metadata file.

Cheers

Tom.

On 6/10/05, Jacob Delfos <jacob.delfos@maunsell.com> wrote:
> 
> Hi Tom, 
> 
> Thanks for that explanation. Now I understand where the WGS84/LOCAL info
> keeps coming from. So probably ArcGIS doesn't like that dataset, because 
the
> SDK (or Gdal) didn't put this fake coordinate system in it. It could be
> because of the inverted Y sign, but if I copy the .tfw (of the original 
TIF)
> to a .eww, ArcGIS reads and registers the ECW fine. 
> 
> Regarding rotated and sheared registrations: ArcGIS allows you to
> georeference an ECW, and as long as you use an affine projection, it will
> create a .eww file for it (with rotation or shear if applicable). So is 
this
> technically incorrect? 
> 
> regards, 
> 
> Jacob
> 
> 
> 
> 
> 
> -----Original Message-----
> From: Tom Lynch [mailto:tflynch@gmail.com] 
> Sent: 10 June 2005 09:43
> To: Delfos, Jacob
> Cc: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] ECW registration information not recognised in 
ESRI 
> 
> On 6/10/05, Delfos, Jacob <jacob.delfos@maunsell.com> wrote:
> > 
> > 
> > Hi All, 
> > 
> > Have a bit of a mystery: 
> > 
> > I am translating some geotiffs to ecw. These geotiffs have their
> geographic
> > information internally in the headers, as well as in a tfw file. They 
all
> > translate fine, and the coordinate information in the ecw file is
> recognised
> > in ESRI ArcGIS. 
> <snip> 
> 
> Hi Jacob, 
> 
> There are some subtleties in ECW georeferencing, which I can explain
> for you. I think the issue you're seeing is probably a minor flaw in
> GDAL, though I haven't checked this. 
> 
> ER Mapper uses a proprietary georeferencing system called GDT (which
> AFAIK predates the popularisation of EPSG) in which a dataset is
> referenced by a projection string, a datum string, and registration
> information. 
> 
> This data is embedded in a binary header of an ECW file, and includes
> x and y origins, x and y cell sizes, and cell size units, as well as
> the projection and datum. For example, "WGS84/GEODETIC" is one of the
> most common datum/projection pairs, corresponding to EPSG code 4326. 
> 
> ER Mapper supports importing datasets with EPSG codes using an
> in-built correspondence between EPSG and GDT. Usually non-geographic
> rasters are stored with RAW/RAW as their projection/datum. However,
> if a raster marked RAW/RAW also contains embedded georeferencing
> information (such as you might find in a TFW) indicating it has a
> geographical purpose, it is imported into ER Mapper software with a
> "fake" projection/datum "WGS84/LOCAL" allowing it to be world-aligned
> with datasets in other map layers. 
> 
> There are several flaws in the system. One of them is that the
> EPSG<-->GDT correspondence is not 1-1, so converting between a GeoTIFF
> and an ECW file and back again may lose or change the referencing. 
> Another is that ECW does not support the storage of rotated or sheared
> registrations (only origin and pixel scale are supported). Finally,
> non-EPSG coordinate system information embedded in a GeoTIFF will
> usually be ignored by ER Mapper software at this point in time. 
> 
> As far as registration is concerned, the ECW JPEG 2000 SDK is fairly
> "blind" concerning the binary values stored in the registration area
> of an ECW file, so third party applications may store invalid data in
> this location. ArcGIS is one application that has problems if (for
> example) the sign of the y cellsize is inverted. So that's probably
> the reason you can't view the GDAL-translated file in ArcGIS with the
> ECW plug-in. 
> 
> -- 
> Tom Lynch
> Development, ER Mapper
> Phone: +61 8 93882900
> Fax: +61 8 93882901
> Email: tom.lynch@ermapper.com
> Web: http://www.ermapper.com
> Forums: http://forum.ermapper.com
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 
> 


-- 
Tom Lynch
Development, ER Mapper
Phone: +61 8 93882900
Fax: +61 8 93882901
Email: tom.lynch@ermapper.com
Web: http://www.ermapper.com
Forums: http://forum.ermapper.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050613/109d1dc8/attachment.html
From jacob.delfos at maunsell.com  Sun Jun 12 21:58:42 2005
From: jacob.delfos at maunsell.com (Jacob Delfos)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] ECW registration information not recognised in ESRI
Message-ID: <000801c56fbb$6d8a6100$5d2815ac@au.aecomnet.com>

Frank,

That fixed it. Even though ArcGIS cannot tell the projection, putting that option in makes it look at the coordinate values, and recognises them as degrees.

I would open a bug, but I lost my password, and the password reminders don't seem to arrive.... Is that a problem on my side?

Regards,

Jacob

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Sent: 10 June 2005 21:29
To: Delfos, Jacob
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] ECW registration information not recognised in ESRI

On 6/9/05, Delfos, Jacob <jacob.delfos@maunsell.com> wrote:
> Have a bit of a mystery: 
> 
> I am translating some geotiffs to ecw. These geotiffs have their geographic
> information internally in the headers, as well as in a tfw file. They all
> translate fine, and the coordinate information in the ecw file is recognised
> in ESRI ArcGIS. 

Jacob, 

I would suggest trying to apply the coordinate system while you are
translating to ECW.  Adding '-a_srs WGS84' on the gdal_translate 
commandline should do the trick. 

A longer term solution on my part might be to apply a more 
appropriate dummy coordinate system instead of RAW if I am 
translating data with no coordinate system, but a meaningful
geotransform.  If you open a bug on this issue, I will look into it.
I may need Tom's advise on appropriate fallback coordinate systems
for coordinates that are apparently geodetic or projected.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050613/f7a0ffb4/attachment.html
From sholl at gmx.net  Mon Jun 13 09:08:53 2005
From: sholl at gmx.net (Stephan Holl)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] [ANNOUNCE]: GDF Hannover GRASS GIS Tutorial v.1.1
 English now available.
Message-ID: <20050613150853.19035829@localhost>

Dear List,

[sorry for crossposting]

GDF Hannover is proud to present the English translation of the
well-known German GRASS GIS Tutorial version 1.1.

The book covers an introduction to the Free Geographic Information
System GRASS 6.0. It extends the available literature about GRASS 6 
by aspects of installation and practical usage and offers up to date
material for the use of the latest GRASS developments at the time of
writing.

The document focuses on the new vector functionalities, network
analysis, database management systems (DBMS) and the new graphical
user interface (GUI). A section about the interaction with Quantum GIS
as graphical user interface is also included.

It is released under GNU/FDL and is available from:

	http://www.gdf-hannover.de/literature

Best regards

GDF Hannover

-- 
GDF Hannover - Solutions for spatial data analysis and remote sensing
Hannover Office (TCH) -  Vahrenwalder Stra?e 7   -   D-30165 Hannover
Internet: www.gdf-hannover.de      -      Email: holl@gdf-hannover.de
Phone : ++49-(0)511-9357560       -          Fax: ++49-(0)511-9357100

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050613/b66e4648/attachment.bin
From baldvin at cs.elte.hu  Tue Jun 14 06:27:20 2005
From: baldvin at cs.elte.hu (Kovacs Baldvin)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] +proj=ob_tran equivalent, rotation
Message-ID: <20050614102720.GB28958@cs.elte.hu>

Hi!

I tried to warp a raster image being in latlong representation
into some projected systems like Aitoff, but the world being
rotated, the poles being not at the center of the top of the
projection.

In proj4 you can use +ob_tran +o_lon_p=0 +o_lat_p=0 +proj=anything
to achieve this.

However, since OGRSpatialReference reimplements (a subset of)
the proj parameter parsing, +ob_tran is not available.

My questions:

- is my goal somehow simply achievable, just I can't figure how?
  If so, please show me how!

- if it is not:

  Basically what happens is that when I give gdalwarp a proj4
  projection definition, it parses it, then it stores it in
  a tree similar to the strukture of WKB. It gives the
  WKB to a function which in turn converts it back to proj4,
  and then initializes the proj4 projection objects with that
  string.

  I tried to manually intervene into the last step, and I
  succeded, I achieved my goal.

  Now I am planning to create a patch that makes OGRSpatialReference
  similar to a Perl scalar variable: When it is initialized with
  a proj4 definition, it keeps that definition, and uses that if
  only that is needed. However, when something else is also needed,
  OGRSpatialReference automatically coerces itself into the 
  tree representation.

  The goal is to achieve that through a simple gdalwarp session
  OGRSpatialReference should be happy with either representation,
  which makes it possible to use any proj4 projections. (I
  beleive it is always a design flaw to reimplement an interface
  of a library, sync keeping in sync the features is not a possible
  task to do.)

  I am curious about your views on these things.

Best regards,
Baldvin Kovacs

From support at geoimage.fr  Tue Jun 14 12:57:41 2005
From: support at geoimage.fr (Fabien Dachicourt)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] VRT with several Raw files
Message-ID: <0a6601c57102$2ddcb740$6501a8c0@ANKARA>

Hi,
I would like to use a single VRT file to mosaic several Raw files.
The only way i found is creating one VRT describing each Raw file, and
creating a global VRT merging all others VRT.
Is it possible to mosaic directly several Raw files using a single VRT file,
including Raw descritption and mosaic ?

Thanks in advance,
Fabien
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050614/0ea35973/attachment.html
From starged at videotron.ca  Tue Jun 14 17:25:31 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] VRT with several Raw files
In-Reply-To: <0a6601c57102$2ddcb740$6501a8c0@ANKARA>
References: <0a6601c57102$2ddcb740$6501a8c0@ANKARA>
Message-ID: <42AF4B4B.8070209@videotron.ca>

Salut Fabien,

Fabien Dachicourt wrote:
> I would like to use a single VRT file to mosaic several Raw files.
> The only way i found is creating one VRT describing each Raw file, and
> creating a global VRT merging all others VRT.
> Is it possible to mosaic directly several Raw files using a single VRT file,
> including Raw descritption and mosaic ?

Some time ago, a modified version of gdal_merge.py to output a VRT file was posted on the list:
http://xserve.flids.com/pipermail/gdal-dev/2005-May/008605.html

(BTW, thank you Gabriel for this! It proved quite useful...)

However, I don't know if this will work with Raw files... I guess the only way to find out is to 
try it :)

Let me know if this works for you.

A la prochaine!
--
Mario B.

From zhang at aero.und.edu  Tue Jun 14 17:26:45 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] error in installing gdal-1.2.6 on Redhat AS 4
Message-ID: <1118784405.42af4b958e636@portal.aero.und.edu>

Hi,

Got the following error when installing gdal-1.2.6 on Redhat AS 4

./configure --with-ogr --with-python --without-mysql
make (which gave the error at the end of make output)

g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -lgif /usr/lib/libjpeg.so -l
tiff -lpng -lz -ldl -Wl,--rpath -Wl,/usr/local/lib
ogrinfo.o(.text+0x8b2): In function `main':
: undefined reference to `_Unwind_Resume'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/home/oracle/dngpSources/gdal-1.2.6/ogr'
make: *** [ogr-apps] Error 2

Thanks
Xiaodong


From rsheykhet at sanz.com  Tue Jun 14 19:56:48 2005
From: rsheykhet at sanz.com (Sheykhet, Rostic)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] GDAL/MrSid-5 on Solaris 9
Message-ID: <ED3A48B9840E594890A2BC172D119465037314AE@mailman.san.com>

Hi all,

I am trying to compile GDAL with MrSid support on Solaris 9 platform.  
The LizardTech MrSid SDK version is 5.0.6.955 built for Solaris with GCC
3.2 compiler.
I am using GCC 3.4.x and getting problems during make (see below).  The
xdr_??? Undefined symbols can be fixed by building with -lnsl library.
I am not able to resolve the other undefined symbols.  Has anyone had
success building a similar setup?  

Thanks a lot.

Rostic Sheykhet

....
make[1]: Entering directory `gdal/apps'
g++  gdalinfo.o  \
        /export/home/rsheykhe/sources/gdal/libgdal.a
/export/home/rsheykhe/sources/gdal/libgdal.a
-L/export/home/rsheykhe/sources/../binaries/solaris/mrsid/3rd-party/lib/
Release -lltiesdk
-L/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release
-lltidsdk -lpthread
-L/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib -lmfhdf -ldf
-lsz -ljpeg -lz -lm -ldl -L/export/home/rsheykhe/sources/kakadu/lib
-lkdu -lcryptopp   -o gdalinfo
Undefined                       first referenced
 symbol                             in file
std::allocator<char>::allocate(unsigned int, void
const*)/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Relea
se/libltidsdk.a(lt_stringUtils.o)
std::__default_alloc_template<true, 0>::allocate(unsigned
int)/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release/
libltidsdk.a(lt_fileUtils.o)
xdr_float
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(put
get.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
xdr_long
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(put
get.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
OGRSpatialReference::Validate()
/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release/libl
tidsdk.a(lti_doqMetadata.o)
xdr_u_long
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(str
ing.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
xdr_int
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(iar
ray.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
xdr_double
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(put
get.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
xdr_enum
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(var
.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
xdr_opaque
/export/home/rsheykhe/sources/../binaries/solaris/hdf/lib/libmfhdf.a(put
get.o)  (symbol belongs to implicit dependency /usr/lib/libnsl.so.1)
std::basic_string<char, std::char_traits<char>, std::allocator<char>
>::_Rep::_S_create(unsigned int, std::allocator<char>
const&)/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Relea
se/libltidsdk.a(MrSIDPasswordDelegate.o)
std::basic_string<char, std::char_traits<char>, std::allocator<char>
>::_S_empty_rep_storage/export/home/rsheykhe/sources/../binaries/solaris
/mrsid/lib/Release/libltidsdk.a(MrSIDPasswordDelegate.o)
std::__default_alloc_template<true, 0>::deallocate(void*, unsigned
int)/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release/
libltidsdk.a(MrSIDPasswordDelegate.o)
OGRSpatialReference::exportToWkt(char**)
const/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release
/libltidsdk.a(lti_doqMetadata.o)
std::basic_string<char, std::char_traits<char>, std::allocator<char>
>::_M_check(unsigned int)
const/export/home/rsheykhe/sources/../binaries/solaris/mrsid/lib/Release
/libltidsdk.a(lt_url.o)
ld: fatal: Symbol referencing errors. No output written to gdalinfo
collect2: ld returned 1 exit status
make: *** [gdalinfo] Error 1

From fwarmerdam at gmail.com  Tue Jun 14 20:29:40 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] error in installing gdal-1.2.6 on Redhat AS 4
In-Reply-To: <1118784405.42af4b958e636@portal.aero.und.edu>
References: <1118784405.42af4b958e636@portal.aero.und.edu>
Message-ID: <931f8ea905061417295a0ff567@mail.gmail.com>

On 6/14/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> Hi,
> 
> Got the following error when installing gdal-1.2.6 on Redhat AS 4
> 
> ./configure --with-ogr --with-python --without-mysql
> make (which gave the error at the end of make output)
> 
> g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -lgif /usr/lib/libjpeg.so -l
> tiff -lpng -lz -ldl -Wl,--rpath -Wl,/usr/local/lib
> ogrinfo.o(.text+0x8b2): In function `main':
> : undefined reference to `_Unwind_Resume'
> collect2: ld returned 1 exit status
> make[1]: *** [ogrinfo] Error 1
> make[1]: Leaving directory `/home/oracle/dngpSources/gdal-1.2.6/ogr'
> make: *** [ogr-apps] Error 2

Xiadong, 

Interesting.   We see the same problem (with recursive main() calls)
with Sun compilers.  The workaround is to comment out the
call to main() from within main, though this will disable the
support for translating all subdatasets in one pass. 

In GDAL-CVS this has been corrected.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bill at binko.net  Wed Jun 15 01:18:58 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Please try this ECW 3.1-rc2 patch for linux/posix
Message-ID: <Pine.LNX.4.58.0506150112260.24783@fastcat.binko.net>


Hi everyone.

I found what I think is a problem in the ECW libraries (version 3.1-rc2).  
Basically, they are not initializing a boolean attribute of a class to 
zero (FALSE).  This means that if you test with the debug version of the 
library, it works (GCC initializes it) and if you work with the optimized 
version, it doesn't.

So, I put together a patch that seems to fix the problem.  I'm attaching 
it to this message.

Please let me know if this helps, or if there are more occurrences of 
this.  I have posted this to the ERMapper forum, so hopefully, it will 
make it into the 3.1 release.

Bill
-------------- next part --------------
diff -U5 -r ecwrc2-orig/Source/C/NCSUtil/thread.c ecwrc2/Source/C/NCSUtil/thread.c
--- ecwrc2-orig/Source/C/NCSUtil/thread.c	2005-01-19 12:42:20.000000000 -0500
+++ ecwrc2/Source/C/NCSUtil/thread.c	2005-06-15 00:52:23.947514800 -0400
@@ -198,12 +198,14 @@
 		HANDLE hThread;

 #else /* _WIN32_WCE */

 		unsigned long hThread;

 #endif /* _WIN32_WCE */

 		NCSThreadInfo *pThreadInfo = (NCSThreadInfo*)NCSMalloc(sizeof(NCSThreadInfo), TRUE);

-

 		NCSMutexBegin(&mMutex);

+

+		pThreadInfo->bThreadRunning = FALSE;

+

 		pThreadInfo->tid = tidNextTID++;

 		NCSMutexEnd(&mMutex);

 

 		*pThread = pThreadInfo->tid;

 		pStartData->pThread = &(pThreadInfo->tid);//pThread;

@@ -269,10 +271,11 @@
 	MacThreadID hThread;

 	NCSThreadStartData *pStartData = NULL;

 	if( pThreadInfo ) {

 

 		NCSMutexBegin(&mMutex);

+		pThreadInfo->bThreadRunning = FALSE;

 		pThreadInfo->tid = tidNextTID++;

 		NCSMutexEnd(&mMutex);

 

 		*pThread = pThreadInfo->tid;

 

@@ -354,10 +357,11 @@
 	NCSThreadStartData *pStartData = NULL;

 

 	NCSThreadInfo *pThreadInfo = (NCSThreadInfo*)NCSMalloc(sizeof(NCSThreadInfo), TRUE);

 

 	NCSMutexBegin(&mMutex);

+	pThreadInfo->bThreadRunning = FALSE;

 	pThreadInfo->tid = tidNextTID++;

 	NCSMutexEnd(&mMutex);

 

 	*pThread = pThreadInfo->tid;

 

@@ -629,11 +633,11 @@
 		*/

 		NCSThreadInfo *pThreadInfo = (NCSThreadInfo*)NCSMalloc(sizeof(NCSThreadInfo), TRUE);

 

 		if(pThreadInfo) {

 			NCSMutexBegin(&mMutex);

-

+			pThreadInfo->bThreadRunning = FALSE;

 			pThreadInfo->tid = tidNextTID++;

 

 #ifdef WIN32

 #ifdef _WIN32_WCE

 			pThreadInfo->hThread = GetCurrentThread(); // FIXME - no DuplicateHandle()?

From bill at binko.net  Wed Jun 15 01:20:27 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Please try this ECW 3.1-rc2 patch for linux/posix
In-Reply-To: <Pine.LNX.4.58.0506150112260.24783@fastcat.binko.net>
References: <Pine.LNX.4.58.0506150112260.24783@fastcat.binko.net>
Message-ID: <Pine.LNX.4.58.0506150119340.24783@fastcat.binko.net>


Sorry, I forgot to say what the problem it fixes is ....

When you run gdalinfo (or anything else that uses an ECWDataset), it hangs 
when the destructor gets called about 80% of the time (on my box -- YMMV).

Bill

On Wed, 15 Jun 2005, Bill Binko wrote:

> 
> Hi everyone.
> 
> I found what I think is a problem in the ECW libraries (version 3.1-rc2).  
> Basically, they are not initializing a boolean attribute of a class to 
> zero (FALSE).  This means that if you test with the debug version of the 
> library, it works (GCC initializes it) and if you work with the optimized 
> version, it doesn't.
> 
> So, I put together a patch that seems to fix the problem.  I'm attaching 
> it to this message.
> 
> Please let me know if this helps, or if there are more occurrences of 
> this.  I have posted this to the ERMapper forum, so hopefully, it will 
> make it into the 3.1 release.
> 
> Bill
> 

From bill at binko.net  Wed Jun 15 03:15:20 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Adding Projection to ECW files ?
Message-ID: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>


Hi everyone,

First, enjoy the conference: this can wait, but I wanted to ask while it 
was fresh.  Wish I could join you.

I have had some recent success with my raster project...

1) I have gotten GDAL & ECW to work on Linux (bug in ECW) 

2) I have gotten gdaltindex to generate a tileindex of my DOQQs 

3) I have gotten Mapserver to show my images (YAY) if I set the projection
to UTM Zone 17N in the mapfile

The problem is that the ECW files don't seem to have the UTM 17N
associated with them in any metadata that GDAL reads.  They come with
.aux, .ecw, .ecw.xml, .ecw.aux.xml, and .html files for each image.

Now, when I run gdalinfo on the file, I get this:

[bill@fastcat ecw_rgb]$ gdalinfo dq4517ne.ecw
Driver: ECW/ERMapper Compressed Wavelets
Size is 6199, 7064
Coordinate System is:
LOCAL_CS["LOCAL",
    UNIT["Meter",1]]
Origin = (397031.442000,3277747.800000)
Pixel Size = (1.00000000,-1.00000000)
Corner Coordinates:
Upper Left  (  397031.442, 3277747.800)
Lower Left  (  397031.442, 3270683.800)
Upper Right (  403230.442, 3277747.800)
Lower Right (  403230.442, 3270683.800)
Center      (  400130.942, 3274215.800)
Band 1 Block=6199x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=6199x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=6199x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

So, I know that it has the boundary info, and I don't need separate .tfw 
(or equivalent).  However, notice the LOCAL_CS -- it didn't find the 
projection information.

Is there any way I can add this to the files?  It should be the same for 
all of them.

Without it, gdal_merge.py blows up, and I can't create summary images :(

I know this is long winded, but can anyone help?

Thanks
Bill



From support at geoimage.fr  Wed Jun 15 07:33:01 2005
From: support at geoimage.fr (Fabien Dachicourt)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] VRT with several Raw files
References: <0a6601c57102$2ddcb740$6501a8c0@ANKARA>
	<42AF4B4B.8070209@videotron.ca>
Message-ID: <0c2d01c5719d$fd09f6e0$6501a8c0@ANKARA>

Hi Mario,
this script can only merge images with cartographic header, so it cannot
work for Raws
It's quite normal, cause Raw file description must always be given
explicitly.

Actually, my question was :
    Does VRT syntax support description of several Raw tiles ?

Anyhow, thanks for your advice, this srcipt may be very usefull !

Fabien

----- Original Message ----- 
From: "Mario Beauchamp" <starged@videotron.ca>
To: "Fabien Dachicourt" <support@geoimage.fr>
Cc: <gdal-dev@remotesensing.org>
Sent: Tuesday, June 14, 2005 11:25 PM
Subject: Re: [Gdal-dev] VRT with several Raw files


> Salut Fabien,
>
> Fabien Dachicourt wrote:
>> I would like to use a single VRT file to mosaic several Raw files.
>> The only way i found is creating one VRT describing each Raw file, and
>> creating a global VRT merging all others VRT.
>> Is it possible to mosaic directly several Raw files using a single VRT 
>> file,
>> including Raw descritption and mosaic ?
>
> Some time ago, a modified version of gdal_merge.py to output a VRT file 
> was posted on the list:
> http://xserve.flids.com/pipermail/gdal-dev/2005-May/008605.html
>
> (BTW, thank you Gabriel for this! It proved quite useful...)
>
> However, I don't know if this will work with Raw files... I guess the only 
> way to find out is to try it :)
>
> Let me know if this works for you.
>
> A la prochaine!
> --
> Mario B.
> 



From BEN at Syncera-ITSolutions.NL  Wed Jun 15 09:04:42 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] aggregate polygons to multipolygons based on an attribute
	column (shapefile)
Message-ID: <s2b04396.081@syncera.nl>

Hi list,

is there a tool in the OGR library to aggregate polygons to multipolygons based on an attribute column for shapefiles? Does anybody know how to go about this if it can't be done with OGR?

Eg:

LOCATION_ID    SHAPE
1                         a polygon geometry
1                         a polygon geometry
1                         a polygon geometry
2                         a polygon geometry
2                         a polygon geometry
...

should become

LOCATION_ID    SHAPE
1                         a multipolygon geometry
2                         a multipolygon geometry
...

Thanks in advance.

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl


From marco_vieira at uk2.net  Wed Jun 15 10:46:17 2005
From: marco_vieira at uk2.net (Marco Vieira)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalsplit error on compile with gdal-1.2.6
Message-ID: <34632.200.169.120.76.1118846777.squirrel@maxproxy4.uk2net.com>

Hi all:
   I can compile the Homme Zwaagstra's gdalsplit.cpp with gdal-1.2.0
without errors, but when I compile with gdal-1.2.6 I got this error:

gcc -o gdalsplit -L/usr/local/lib -lgdal -I/usr/local/include
-I/usr/include -ltiff gdalsplit.cpp -Wall
returns:

gdalsplit.cpp: In function `CPLErr CopyRasterBand(GDALDataset*, GDALDataset*,
   int, int, int, int, int)':
gdalsplit.cpp:237: error: `AddSimpleSource' undeclared (first use this
   function)
gdalsplit.cpp:237: error: (Each undeclared identifier is reported only
once for
   each function it appears in.)

Whats happen? The header files appear to be OK.

Marco Vieira.
Fone:    + 55 51 9101-1267
marco_vieira@uk2.net

From fwarmerdam at gmail.com  Wed Jun 15 10:55:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] aggregate polygons to multipolygons based on an
	attribute column (shapefile)
In-Reply-To: <s2b04396.081@syncera.nl>
References: <s2b04396.081@syncera.nl>
Message-ID: <931f8ea905061507554c58a176@mail.gmail.com>

On 6/15/05, Bart van den Eijnden <BEN@syncera-itsolutions.nl> wrote:
> Hi list,
> 
> is there a tool in the OGR library to aggregate polygons to multipolygons based on an attribute column for shapefiles? Does anybody know how to go about this if it can't be done with OGR?

Bart, 

You could write a python script (or C++ program) to accomplish
this with OGR but there is no built-in capability for this in OGR
command line utilities. 

If I were to do it in Python I would read all the features, and maintain
an associative array of geometries in memory to accumulate the
multipolygons, with the attribute value being the key into the array.
This approach assumes that your dataset is small enough that all
the geometry could be held in memory. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From zhang at aero.und.edu  Wed Jun 15 10:55:26 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] error in installing gdal-1.2.6 on Redhat AS 4
In-Reply-To: <931f8ea905061417295a0ff567@mail.gmail.com>
References: <1118784405.42af4b958e636@portal.aero.und.edu>
	<931f8ea905061417295a0ff567@mail.gmail.com>
Message-ID: <42B0415E.2030309@aero.und.edu>

Hi Frank,

Thanks for the reply. But I got the same error even with the 
gdal-cvs-2005.06.15. I also tried gdal-1.2.5 and the same problem. Is 
that because something special with Redhat AS 4. I know I can compile 
gdal-1.2.5 on Redhat AS 3.

Best regards
Xiaodong

Frank Warmerdam wrote:

>On 6/14/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
>  
>
>>Hi,
>>
>>Got the following error when installing gdal-1.2.6 on Redhat AS 4
>>
>>./configure --with-ogr --with-python --without-mysql
>>make (which gave the error at the end of make output)
>>
>>g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -lgif /usr/lib/libjpeg.so -l
>>tiff -lpng -lz -ldl -Wl,--rpath -Wl,/usr/local/lib
>>ogrinfo.o(.text+0x8b2): In function `main':
>>: undefined reference to `_Unwind_Resume'
>>collect2: ld returned 1 exit status
>>make[1]: *** [ogrinfo] Error 1
>>make[1]: Leaving directory `/home/oracle/dngpSources/gdal-1.2.6/ogr'
>>make: *** [ogr-apps] Error 2
>>    
>>
>
>Xiadong, 
>
>Interesting.   We see the same problem (with recursive main() calls)
>with Sun compilers.  The workaround is to comment out the
>call to main() from within main, though this will disable the
>support for translating all subdatasets in one pass. 
>
>In GDAL-CVS this has been corrected.
>
>Best regards,
>
>  
>


From fwarmerdam at gmail.com  Wed Jun 15 11:01:11 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalsplit error on compile with gdal-1.2.6
In-Reply-To: <34632.200.169.120.76.1118846777.squirrel@maxproxy4.uk2net.com>
References: <34632.200.169.120.76.1118846777.squirrel@maxproxy4.uk2net.com>
Message-ID: <931f8ea90506150801344448f0@mail.gmail.com>

On 6/15/05, Marco Vieira <marco_vieira@uk2.net> wrote:
> Hi all:
>    I can compile the Homme Zwaagstra's gdalsplit.cpp with gdal-1.2.0
> without errors, but when I compile with gdal-1.2.6 I got this error:
> 
> gcc -o gdalsplit -L/usr/local/lib -lgdal -I/usr/local/include
> -I/usr/include -ltiff gdalsplit.cpp -Wall
> returns:
> 
> gdalsplit.cpp: In function `CPLErr CopyRasterBand(GDALDataset*, GDALDataset*,
>    int, int, int, int, int)':
> gdalsplit.cpp:237: error: `AddSimpleSource' undeclared (first use this
>    function)
> gdalsplit.cpp:237: error: (Each undeclared identifier is reported only
> once for
>    each function it appears in.)
> 
> Whats happen? The header files appear to be OK.

Marco,

I haven't looked at gdalsplit myself, but I would guess that
it is using the VRTRasterBand.  Relatively recently this
class was altered so that the AddSimpleSource method
is on a subclass, the VRTSourcedRasterBand.  Try to 
alter the code to create or cast to this class as appropriate.

Sorry for not being more specific. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From marco_vieira at uk2.net  Wed Jun 15 14:46:44 2005
From: marco_vieira at uk2.net (Marco Vieira)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalsplit error on compile with gdal-1.2.6
In-Reply-To: <931f8ea90506150801344448f0@mail.gmail.com>
References: <34632.200.169.120.76.1118846777.squirrel@maxproxy4.uk2net.com> 
	<931f8ea90506150801344448f0@mail.gmail.com>
Message-ID: <38612.200.169.120.76.1118861204.squirrel@maxproxy4.uk2net.com>

Bingo!!
 Thank you Frank.

Marco Vieira.
Fone:    + 55 51 9101-1267
marco_vieira@uk2.net

> On 6/15/05, Marco Vieira <marco_vieira@uk2.net> wrote:
>> Hi all:
>>    I can compile the Homme Zwaagstra's gdalsplit.cpp with gdal-1.2.0
>> without errors, but when I compile with gdal-1.2.6 I got this error:
gcc -o gdalsplit -L/usr/local/lib -lgdal -I/usr/local/include
>> -I/usr/include -ltiff gdalsplit.cpp -Wall
>> returns:
>> gdalsplit.cpp: In function `CPLErr CopyRasterBand(GDALDataset*,
GDALDataset*,
>>    int, int, int, int, int)':
>> gdalsplit.cpp:237: error: `AddSimpleSource' undeclared (first use this
>>    function)
>> gdalsplit.cpp:237: error: (Each undeclared identifier is reported only
once for
>>    each function it appears in.)
>> Whats happen? The header files appear to be OK.
>
> Marco,
>
> I haven't looked at gdalsplit myself, but I would guess that
> it is using the VRTRasterBand.  Relatively recently this
> class was altered so that the AddSimpleSource method
> is on a subclass, the VRTSourcedRasterBand.  Try to
> alter the code to create or cast to this class as appropriate.
>
> Sorry for not being more specific.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam and
watch the world go round - Rush    | Geospatial Programmer for Rent
>




From dylan at iici.no-ip.org  Wed Jun 15 18:04:26 2005
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalwarp hangs when -dstnodata is used
Message-ID: <200506151504.26233.dylan@iici.no-ip.org>

Hi,

gdalwarp (1.2.6 compiled from source) hangs after successfully re-projecting a 
raster image when the -dstnodata flag is present.

for example;

this command hangs:
gdalwarp -multi -tps -t_srs '+proj=utm +zone=10 +datum=NAD83 +units=m' -s_srs 
'+proj=lcc +lat_1=36.0000 +lat_2=37.2500 +lat_0=35.333333333333336 
+lon_0=-119.0000 +x_0=2000000 +y_0=500000 +datum=NAD83 +units=ft' -dstnodata 
255 CA_SPC_IV/884088.tif for_mapserver/884088.tif 

this one does not:
gdalwarp -multi -tps -t_srs '+proj=utm +zone=10 +datum=NAD83 +units=m' -s_srs 
'+proj=lcc +lat_1=36.0000 +lat_2=37.2500 +lat_0=35.333333333333336 
+lon_0=-119.0000 +x_0=2000000 +y_0=500000 +datum=NAD83 +units=ft' 
CA_SPC_IV/884088.tif for_mapserver/884088.tif 


any ideas on what could be causing this?

I am trying to assign a NODATA value to a pile of images so that they can be 
tiled in mapserver.

thanks!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From fwarmerdam at gmail.com  Wed Jun 15 11:04:57 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] error in installing gdal-1.2.6 on Redhat AS 4
In-Reply-To: <42B0415E.2030309@aero.und.edu>
References: <1118784405.42af4b958e636@portal.aero.und.edu>
	<931f8ea905061417295a0ff567@mail.gmail.com>
	<42B0415E.2030309@aero.und.edu>
Message-ID: <931f8ea905061508043b436f5c@mail.gmail.com>

On 6/15/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> Hi Frank,
> 
> Thanks for the reply. But I got the same error even with the
> gdal-cvs-2005.06.15. I also tried gdal-1.2.5 and the same problem. Is
> that because something special with Redhat AS 4. I know I can compile
> gdal-1.2.5 on Redhat AS 3.

Xiaodong, 

Sorry, my leap of intuition on this was wrong ...  I should
have looked more closely and noted that you were having
problems with ogrinfo, not gdalinfo as  I had thought. 

I have no idea what is going wrong here.  Sorry!  I have
never seen this report before.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dem at acri-st.fr  Thu Jun 16 03:33:54 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: [kakadu_jpeg2000] Support for GeoJPEG2000 needed
In-Reply-To: <d8pver+ocek@eGroups.com>
References: <d8pver+ocek@eGroups.com>
Message-ID: <6.1.1.1.0.20050616090906.05a1e258@pop3>

Greg,

If your need is only to read/write GeoTIFF and GeoJPEG2000 you should use 
this library/utilities : http://www.gdal.org/ (I send a copy of this post 
to the GDAL's mailing list)
It's a "Geospatial Data Abstraction Library" widely used which can 
read/write many (~ 50) raster formats in a same generic way.
GDAL read/write GeoTIFF and has a GeoJPEG2000 driver using the Kakadu 
library which allows to read/write GeoJPEG2000 files.
For example with GAL utilities you can create a GeoJPEG2000 from a GeoTIFF :
gdal_translate -of GTiff geojp2.jp2 geotiff.tif
the inverse operation is :
gdal_translate -of JP2KAK -co "QUALITY=10" geotiff.tif geojp2.jp2     for 
create a GeoJP2 file (with size 10% of the original file) using Kakadu library.

If your really need to implement GeoTIFF geolocation in Kakadu TIFF and JP2 
support, maybe you should also based your work on GDAL library.
But to my mind I think GDAL already do what you want...

Regards,


Julien

At 21:27 15/06/2005, greg_coatman wrote:
>Professor Taubman has advised me that the Kakadu Software does not read 
>nor write
>GeoTIFF and GeoJPEG2000 images, and he asked me to post a public message here.
>Has anyone documented all of the changes necessary to the Kakadu Software 
>so that it
>can read and write GeoTIFF and GeoJPEG2000 images?
>
>
>
>
>
>
>
>
>For problems with your subscription in this group please email
>kakadu_jpeg2000-owner@yahoogroups.com.
>
>Yahoo! Groups Links
>
><*> To visit your group on the web, go to:
>     http://groups.yahoo.com/group/kakadu_jpeg2000/
>
><*> To unsubscribe from this group, send an email to:
>     kakadu_jpeg2000-unsubscribe@yahoogroups.com
>
><*> Your use of Yahoo! Groups is subject to:
>     http://docs.yahoo.com/info/terms/
>


From dylan at iici.no-ip.org  Thu Jun 16 14:31:49 2005
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] gdalwarp hangs when -dstnodata is used [solved]
In-Reply-To: <20050616115006.6f9c23ec.hamish_nospam@yahoo.com>
References: <200506151504.26233.dylan@iici.no-ip.org>
	<20050616115006.6f9c23ec.hamish_nospam@yahoo.com>
Message-ID: <200506161131.49746.dylan@iici.no-ip.org>

On Wednesday 15 June 2005 04:50 pm, Hamish wrote:
> > gdalwarp (1.2.6 compiled from source) hangs after successfully
> > re-projecting a  raster image when the -dstnodata flag is present.
>
> -tps is very new and still somewhat buggy. Does the same happen with
> -order 2?
>
> All sorts of weird memory problems. For me, if I made the output
> filename less than 20 chars it wouldn't work. Running using electric
> fence made things a bit better:
>
> $ ulimit -c unlimited
>
> $ LD_PRELOAD=libefence.so.0.0 gdalwarp -tps -srcnodata 255 \
>   -dstnodata 255 8right_gcp.tif 8right_warped_xyy.tif
>
>
> (just need E-F shared library installed, no need to recompile)
>
> never had problems with -dstnodata.
>
> And don't use -co compress=lzw in gdalwarp, that has bugs too.
>
>
> see gdal bug #864
>
>
>
> Hamish

Thanks for the tips Hamish. I was able to solve the problem by specifying a 
'-srcnodata 255' option on the command line.

These are some good tips, which i will file for future reference!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From route at cae.com  Thu Jun 16 17:40:29 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Pb with CreateCopy from a BMP to MEM
Message-ID: <62FC3C78EB032A4DB2AD05F964E931F631EAB2@caemex02.caecorp.cae.com>

Hi Mailing List,

I found a problem (?) in GDAL 1.2.6
I'm create a copy of an image in memory (I tested BMP -> MEM)
The problem is that if I don't specify FlushCache to a band, the
ReadBlock return a empty (zero-ed) buffer
To reproduce, run the following code with commenting out the
"poBand->FlushCache();" line

Perhaps it is a mistake at my side ?

Thanks,

Stephane Routelous
http://www.exotk.org


int main(int argc, char* argv[])
{
	GDALAllRegister();
	GDALDataset* realDataSet = (GDALDataset *) GDALOpen(
"T:\\airport_fence.bmp", GA_ReadOnly );
	if ( realDataSet)
	{
		GDALDriver *memDriver =
GetGDALDriverManager()->GetDriverByName("MEM");
		GDALDataset* memDataSet =
memDriver->CreateCopy("MEM:::",realDataSet,FALSE,NULL,NULL,NULL);
		GDALClose(realDataSet);
		if ( memDataSet )
		{
			int sx = memDataSet->GetRasterXSize();
			int sy = memDataSet->GetRasterYSize();

			GDALRasterBand  *poBand =
memDataSet->GetRasterBand( 1 );

	
///////////////////////////////////////////////////////
			//	Comment the following line out
			//
			//poBand->FlushCache();
			//
	
///////////////////////////////////////////////////////

			unsigned char* buffer = (unsigned
char*)malloc(sx*sizeof(unsigned char));
			poBand->RasterIO( GF_Read, 0, 0, sx, 1, 
                          buffer, sx, 1, GDT_Byte, 
                          0, 0 );

			for ( unsigned int i = 0 ; i < sx ; i++ )
			{
				cout << (int) buffer[i] << " " ;
			}

			cout << endl << endl << endl ;
			poBand->ReadBlock(0,0,buffer);
			for (  i = 0 ; i < sx ; i++ )
			{
				cout << (int) buffer[i] << " " ;
			}
		}
	}

	return 0;
}

Output with poBand->FlushCache();

33 33 21 37 21 33 29 29 29 29 51 61 18 29 42 33 37 37 42 51 42 29 29 46
29 21 37
 21 42 18 37 37 29 25 25 33 10 33 33 14 29 42 33 37 21 37 21 33 25 33 29
33 37 6
1 33 18 37 37 33 33 42 46 46 33 25 42 42 18 29 33 29 29 25 42 29 25 25
37 10 29
37 21 14 51 33 33 37 25 29 25 29 29 29 29 33 33 61 46 14 33 42 33 37 37
46 51 37
 25 37 46 21 25 37 21 42 18 42 33 29 25 33 18 21 37 29 10 46 33


33 33 21 37 21 33 29 29 29 29 51 61 18 29 42 33 37 37 42 51 42 29 29 46
29 21 37
 21 42 18 37 37 29 25 25 33 10 33 33 14 29 42 33 37 21 37 21 33 25 33 29
33 37 6
1 33 18 37 37 33 33 42 46 46 33 25 42 42 18 29 33 29 29 25 42 29 25 25
37 10 29
37 21 14 51 33 33 37 25 29 25 29 29 29 29 33 33 61 46 14 33 42 33 37 37
46 51 37
 25 37 46 21 25 37 21 42 18 42 33 29 25 33 18 21 37 29 10 46 33 


Output without poBand->FlushCache();
33 33 21 37 21 33 29 29 29 29 51 61 18 29 42 33 37 37 42 51 42 29 29 46
29 21 37
 21 42 18 37 37 29 25 25 33 10 33 33 14 29 42 33 37 21 37 21 33 25 33 29
33 37 6
1 33 18 37 37 33 33 42 46 46 33 25 42 42 18 29 33 29 29 25 42 29 25 25
37 10 29
37 21 14 51 33 33 37 25 29 25 29 29 29 29 33 33 61 46 14 33 42 33 37 37
46 51 37
 25 37 46 21 25 37 21 42 18 42 33 29 25 33 18 21 37 29 10 46 33


0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0
0 0 0 0 0 0 0 0 Press any key to continue

From mlogan at mail.arc.nasa.gov  Thu Jun 16 18:42:52 2005
From: mlogan at mail.arc.nasa.gov (Mike Logan)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Will GDAL do other planets?
Message-ID: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>

I haven't researched this yet - maybe this is already supported, but
  I can think of some reasons to have GDAL load,query,reproject
  MARS or other planetary data.    Not so much data formats (although
  that would be nice) but rather geospecific support (radius, 
eccentricity, etc).

Has anyone ever tackled this idea?    Or would it be
  too much upheaval to the product?

I'm thinking ahead at using OpenSceneGraph and changes it
  might require.


ml



Michael Logan
QSS Group,Inc./NASA Ames Research Center
Task Lead,                 Visual Cueing & Simulation
Computer Scientist,  Adaptive Control Technologies
MS 262-6,
Moffett Field, CA, 94035
  (650)-604-4494 
  


From starged at videotron.ca  Thu Jun 16 22:31:43 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Will GDAL do other planets?
In-Reply-To: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
References: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
Message-ID: <42B2360F.7080301@videotron.ca>

Hi Mike,

Mike Logan wrote:
> I haven't researched this yet - maybe this is already supported, but
>  I can think of some reasons to have GDAL load,query,reproject
>  MARS or other planetary data.    Not so much data formats (although
>  that would be nice) but rather geospecific support (radius,eccentricity, etc).

The only experience I have with this is retrieving Mars imagery from a WMS server with my 
wmstool for OpenEV. The server in question 
(http://demo.cubewerx.com/demo/cubeserv/cubeserv.cgi?CONFIG=mars&amp;) offers the data in 
different projections only defined by "made-up" EPSG codes like 42180,42181 and such... Frank 
once told me that these codes were not "official" codes and GDAL doesn't deal with those as 
such. For example, the EPSG:42180 (Mars/Geographic) is seen as EPSG:4326 (WGS84)... this is nice 
for simply displaying the image in OpenEV but of course cannot be used for reprojection.

> Has anyone ever tackled this idea?    Or would it be too much upheaval to the product?

I think we would simply require to have proper planetary datum/projection definitions in the csv 
files and assign them codes. Since Cubewerx already invent codes, why couldn't we? :)

Or maybe I'm missing something...
--
Mario B.

From hamish_nospam at yahoo.com  Thu Jun 16 23:28:42 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Will GDAL do other planets?
In-Reply-To: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
References: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
Message-ID: <20050617152842.1756d47d.hamish_nospam@yahoo.com>

> I haven't researched this yet - maybe this is already supported, but
>   I can think of some reasons to have GDAL load,query,reproject
>   MARS or other planetary data.    Not so much data formats (although
>   that would be nice) but rather geospecific support (radius, 
> eccentricity, etc).
> 
> Has anyone ever tackled this idea?    Or would it be
>   too much upheaval to the product?
> 
> I'm thinking ahead at using OpenSceneGraph and changes it
>   might require.
>
>
> ml
>
> Michael Logan
> QSS Group,Inc./NASA Ames Research Center
> Task Lead,                 Visual Cueing & Simulation
> Computer Scientist,  Adaptive Control Technologies
> MS 262-6,
> Moffett Field, CA, 94035
>   (650)-604-4494 
>
> ________________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev



Others have done the same using GDAL+PROJ.4 & r.in.bin in GRASS, maybe 
the old mailing list threads have some info for you. Unfortunately "Mars" 
is hard to do in the search engine.. bloody thing translates into French.
None the less, some links to mailing list threads follow which may be 
informative. Maybe Paul remembers more?

http://grass.itc.it/pipermail/grass5/2003-August/008536.html
http://grass.itc.it/pipermail/grassuser/2002-November/007657.html
http://grass.itc.it/pipermail/grassuser/1994-August/021833.html

from that, someone had a "mars_iau2000" geoid working with PROJ.

MOLA data is pretty easy to import anyway:
  http://bambi.otago.ac.nz/hamish/olympus_mons.html


GRASS just uses GDAL+PROJ.4, so GDAL+PROJ.4 should be able to handle it..



Hopefully some leads there,

Hamish

From starged at videotron.ca  Thu Jun 16 23:40:23 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Pb with CreateCopy from a BMP to MEM
In-Reply-To: <62FC3C78EB032A4DB2AD05F964E931F631EAB2@caemex02.caecorp.cae.com>
References: <62FC3C78EB032A4DB2AD05F964E931F631EAB2@caemex02.caecorp.cae.com>
Message-ID: <42B24627.3050605@videotron.ca>

Salut Stephane,

Stephane Routelous wrote:

> Hi Mailing List,
> 
> I found a problem (?) in GDAL 1.2.6
> I'm create a copy of an image in memory (I tested BMP -> MEM)
> The problem is that if I don't specify FlushCache to a band, the
> ReadBlock return a empty (zero-ed) buffer
> To reproduce, run the following code with commenting out the
> "poBand->FlushCache();" line

I think FlushCache() is needed only when you write to disk, which is of course not the case for 
a MEM dataset. BTW, I have ran into probs with MEM and GDAL Python (should we call it pyGDAL?): 
in OpenEV, removing a MEM layer does not free its memory... have you observed this in C? Or it 
may be OpenEV related only...

> Stephane Routelous
> http://www.exotk.org

Visited... I thought I was the only GDALer in Montreal! :)

A la prochaine!
--
Mario B.


From starged at videotron.ca  Fri Jun 17 00:02:51 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Will GDAL do other planets?
In-Reply-To: <20050617152842.1756d47d.hamish_nospam@yahoo.com>
References: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
	<20050617152842.1756d47d.hamish_nospam@yahoo.com>
Message-ID: <42B24B6B.4070508@videotron.ca>

Hi Hamish,

Hamish wrote:

> Others have done the same using GDAL+PROJ.4 & r.in.bin in GRASS,

That's pretty much the idea...

> None the less, some links to mailing list threads follow which may be 
> informative. Maybe Paul remembers more?
> 
> http://grass.itc.it/pipermail/grass5/2003-August/008536.html
> http://grass.itc.it/pipermail/grassuser/2002-November/007657.html
> http://grass.itc.it/pipermail/grassuser/1994-August/021833.html

Found some info on planetary systems here: http://pds.jpl.nasa.gov/

> MOLA data is pretty easy to import anyway:
>   http://bambi.otago.ac.nz/hamish/olympus_mons.html

Nice pix!
--
Mario B.

From paul-grass at stjohnspoint.co.uk  Fri Jun 17 03:51:25 2005
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Will GDAL do other planets?
In-Reply-To: <20050617152842.1756d47d.hamish_nospam@yahoo.com>
References: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
	<20050617152842.1756d47d.hamish_nospam@yahoo.com>
Message-ID: <42B280FD.2020000@stjohnspoint.co.uk>

Hamish wrote:
>>I haven't researched this yet - maybe this is already supported, but
>>  I can think of some reasons to have GDAL load,query,reproject
>>  MARS or other planetary data.    Not so much data formats (although
>>  that would be nice) but rather geospecific support (radius, 
>>eccentricity, etc).
>>
> Others have done the same using GDAL+PROJ.4 & r.in.bin in GRASS, maybe 
> the old mailing list threads have some info for you. Unfortunately "Mars" 
> is hard to do in the search engine.. bloody thing translates into French.
> None the less, some links to mailing list threads follow which may be 
> informative. Maybe Paul remembers more?

As far as I remember everything that needed to be fixed to model Mars in 
the GRASS projection system, was done.
I remember too projecting some Mars elevation data onto a spherical 
globe in SG3d when I was testing the support, and it looked really well. 
Not sure if I saved it though.

Paul

From dem at acri-st.fr  Fri Jun 17 04:19:42 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: [kakadu_jpeg2000] Support for GeoJPEG2000 needed
In-Reply-To: <63D6344A-DEDC-11D9-A89B-0011242F142C@mac.com>
References: <d8pver+ocek@eGroups.com> <6.1.1.1.0.20050616094320.023ff830@pop3>
	<63D6344A-DEDC-11D9-A89B-0011242F142C@mac.com>
Message-ID: <6.1.1.1.0.20050617101917.023a3950@pop3>

At 05:03 17/06/2005, Greg Coats wrote:
>Julien,
>Thanks for your message, unfortunately it leaves me confused.
>
>Under the heading Building GDAL From Source, External Libraries this web 
>page http://www.gdal.org/gdal_building.html#libraries says that GDAL's 
>JPEG2000 support is based on JasPer.  I suspect this web page has out of 
>date information.  JasPer was superseded about two years ago by 
>GeoJasPer.  GeoJasPer is fully aware of georeferencing info.
>GeoJasPer correctly transcodes between GeoTIFF and GeoJPEG2000 files.
>If GDAL is using GeoJasPer to support GeoTIFF and GeoJPEG2000 files, then 
>GDAL does not have to do anything.

In fact GDAL support GeoJPEG2000 by several way :
         - the first driver is implemented with Jasper : 
http://www.gdal.org/frmt_jpeg2000.html
           but I believe Jasper is less performant than Kakadu (and I 
believe it read ALL the image in memory)
         - another driver is based on Kakadu : 
http://www.gdal.org/frmt_jp2kak.html
         - now there is 2 other drivers supporting (Geo)JPEG2000 :
                 - with proprietary MrSID SDK which now can read/write JP2 
too (I believe they use Kakadu internally)
                 - with the new free ErMapper ECW SDK, which also support 
JP2 http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=266


>A GeoJPEG2000 file begins with the standard JPEG2000 boxes, then adds a 
>uuid box with georeferencing info, and concludes with the usual JPEG2000 
>code stream.  A GeoJPEG2000 file could be made from a JPEG2000 file by 
>inserting a uuid box with georeferencing info between the standard 
>JPEG2000 boxes and the JPEG2000 code stream.

Yes I know and I GDAL do that very well : next the part in GDAL sources 
which write the GeoTIFF informations in the jp2 uuid box :

/************************************************************************/
/*                       JP2KAKWriteGeoTIFFInfo()                       */
/************************************************************************/

void JP2KAKWriteGeoTIFFInfo( jp2_target *jp2_out, GDALDataset *poSrcDS )

{
/* -------------------------------------------------------------------- */
/*      Prepare the memory buffer containing the degenerate GeoTIFF     */
/*      file.                                                           */
/* -------------------------------------------------------------------- */
     const char *pszWKT;
     double      adfGeoTransform[6];
     int         nGTBufSize = 0;
     unsigned char *pabyGTBuf = NULL;

     if( GDALGetGCPCount( poSrcDS ) > 0 )
         pszWKT = poSrcDS->GetGCPProjection();
     else
         pszWKT = poSrcDS->GetProjectionRef();

     poSrcDS->GetGeoTransform(adfGeoTransform);

     if( GTIFMemBufFromWkt( pszWKT, adfGeoTransform,
                            poSrcDS->GetGCPCount(), poSrcDS->GetGCPs(),
                            &nGTBufSize, &pabyGTBuf ) != CE_None )
         return;

     if( nGTBufSize == 0 )
         return;

/* -------------------------------------------------------------------- */
/*      Write to a box on the JP2 file.                                 */
/* -------------------------------------------------------------------- */
#ifdef KAKADU4
     jp2_out->open_next( jp2_uuid_box_type );

     jp2_out->write( (kdu_byte *) msi_uuid2, sizeof(msi_uuid2) );

     jp2_out->write( (kdu_byte *) pabyGTBuf, nGTBufSize );

     jp2_out->close();
#else
     jp2_output_box &uuid_box = jp2_out->open_box( jp2_uuid_box_type );

     uuid_box.write( (kdu_byte *) msi_uuid2, sizeof(msi_uuid2) );

     uuid_box.write( (kdu_byte *) pabyGTBuf, nGTBufSize );

     uuid_box.close();
#endif

     CPLFree( pabyGTBuf );
}



>Given a losslessly compressed, archived GeoJPEG2000 file as input to be 
>transcoded into a lossy GeoJPEG2000 image as output, all JPEG2000 
>transcoders read the size of the uuid box and then read the georeferencing 
>info.  If the JPEG2000 transcoder is not geo-aware, then it essentially 
>discards the geo-info it just read in the uuid box.  If the JPEG2000 
>transcoder is geo-aware, then it simply copies/writes the geo-info into a 
>uuid box identical to the uuid box it just read.

I think a transcoder not geo-aware should copying all jp2 uuid box from 
input to output. It hasn't to know what is it in the box, only to copy it 
to copy the maximum of inputs informations, isn't it ?


>Since the Kakadu Software is the basis from many other JPEG2000 
>transcoders, and frequently updated, it makes sense to include the copying 
>of the georeferencing uuid box in Kakadu, rather than requiring each 
>developer to reinvent this process.

Yes I like the idea Kakadu utilities copies the geo information from 
geojp2/geotiff to geojp2/geotiff, why not.

>I got the impression from Professor Taubman that several Kakadu developers 
>have already incorporated support for GeoJPEG2000 and GeoTIFF in their 
>products.  If they will publicly document this, then that would be 
>great.  If not, since I think it is to everyone's advantage to add 
>GeoJPEG2000 and GeoTIFF support to Kakadu Software, then I volunteer to do so.

You should see the GDAL source code of the kakadu and geotiff drivers.

Best Regards,

Julien

>Greg
>
>
>On Jun 16, 2005, at 3:44 AM, Julien Demaria wrote:
>>Greg,
>>If your need is only to read/write GeoTIFF and GeoJPEG2000 you should use 
>>this library/utilities : http://www.gdal.org/ (I send a separate copy of 
>>this post to the GDAL's mailing list).
>>It's a "Geospatial Data Abstraction Library" widely used which can 
>>read/write many (~ 50) raster formats in a same generic way.
>>GDAL read/write GeoTIFF and has a GeoJPEG2000 driver using the Kakadu 
>>library which allows to read/write GeoJPEG2000 files.
>>For example with GAL utilities you can create a GeoJPEG2000 from a GeoTIFF :
>>gdal_translate -of GTiff geojp2.jp2 geotiff.tif
>>the inverse operation is :
>>gdal_translate -of JP2KAK -co "QUALITY=10" geotiff.tif geojp2.jp2
>>for create a GeoJP2 file (with size 10% of the original file) using 
>>Kakadu library.
>>
>>If your really need to implement GeoTIFF geolocation in Kakadu TIFF and 
>>JP2 support, maybe you should also based your work on GDAL library.
>>But to my mind I think GDAL already do what you want...
>>Regards,
>>Julien
>>
>>At 21:27 15/06/2005, greg_coatman wrote:
>>>Professor Taubman has advised me that the Kakadu Software does not read 
>>>nor write
>>>GeoTIFF and GeoJPEG2000 images, and he asked me to post a public message 
>>>here.
>>>Has anyone documented all of the changes necessary to the Kakadu 
>>>Software so that it
>>>can read and write GeoTIFF and GeoJPEG2000 images?


From sebastien.grignard at archivideo.com  Fri Jun 17 04:40:08 2005
From: sebastien.grignard at archivideo.com (Sebastien Grignard)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Limited type support in OGR CSV driver
Message-ID: <42B28C68.5040101@archivideo.com>

Hello.
I've added type support for the CSV driver.
With these patches you can now write a little csv help file to indicate 
the columns types to OGR.
It works as follow :
  - suppose you have a foobar.csv file that looks like this :
    "ID","X","Y","AREA","NAME"
    "1","1023.5","243.56","675","FOOBAR"
    ...
  - now write a foobar.csvt file like this one :
    "Integer","Real","Real","Integer","String"
The driver will then use the types you specified for the csv columns.
The only types recognized are Integer,Real and String.

Cheers.

-- 
Sebastien Grignard
R&D Developer
Archivideo
40, rue des Veyettes - 35000 Rennes FRANCE
Phone: +033 2 99 86 30 20

-------------- next part --------------
A non-text attachment was scrubbed...
Name: ogrcsvpatch.zip
Type: application/zip
Size: 2040 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050617/8bf63263/ogrcsvpatch.zip
From bill at binko.net  Sun Jun 19 13:59:37 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Adding Projection to ECW files ?
In-Reply-To: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>
References: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>
Message-ID: <Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>


Hi everyone: I hope everyone enjoyed the conference.  If anyone has time 
to look at this, I'd really appreciate it.  I really would like to be busy 
making summary layers, but am stuck at this point.

Thanks
Bill

On Wed, 15 Jun 2005, Bill Binko wrote:

> 
> Hi everyone,
> 
> First, enjoy the conference: this can wait, but I wanted to ask while it 
> was fresh.  Wish I could join you.
> 
> I have had some recent success with my raster project...
> 
> 1) I have gotten GDAL & ECW to work on Linux (bug in ECW) 
> 
> 2) I have gotten gdaltindex to generate a tileindex of my DOQQs 
> 
> 3) I have gotten Mapserver to show my images (YAY) if I set the projection
> to UTM Zone 17N in the mapfile
> 
> The problem is that the ECW files don't seem to have the UTM 17N
> associated with them in any metadata that GDAL reads.  They come with
> .aux, .ecw, .ecw.xml, .ecw.aux.xml, and .html files for each image.
> 
> Now, when I run gdalinfo on the file, I get this:
> 
> [bill@fastcat ecw_rgb]$ gdalinfo dq4517ne.ecw
> Driver: ECW/ERMapper Compressed Wavelets
> Size is 6199, 7064
> Coordinate System is:
> LOCAL_CS["LOCAL",
>     UNIT["Meter",1]]
> Origin = (397031.442000,3277747.800000)
> Pixel Size = (1.00000000,-1.00000000)
> Corner Coordinates:
> Upper Left  (  397031.442, 3277747.800)
> Lower Left  (  397031.442, 3270683.800)
> Upper Right (  403230.442, 3277747.800)
> Lower Right (  403230.442, 3270683.800)
> Center      (  400130.942, 3274215.800)
> Band 1 Block=6199x1 Type=Byte, ColorInterp=Red
>   Overviews: arbitrary
> Band 2 Block=6199x1 Type=Byte, ColorInterp=Green
>   Overviews: arbitrary
> Band 3 Block=6199x1 Type=Byte, ColorInterp=Blue
>   Overviews: arbitrary
> 
> So, I know that it has the boundary info, and I don't need separate .tfw 
> (or equivalent).  However, notice the LOCAL_CS -- it didn't find the 
> projection information.
> 
> Is there any way I can add this to the files?  It should be the same for 
> all of them.
> 
> Without it, gdal_merge.py blows up, and I can't create summary images :(
> 
> I know this is long winded, but can anyone help?
> 
> Thanks
> Bill
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 

From kruland at ku.edu  Sun Jun 19 21:36:13 2005
From: kruland at ku.edu (Kevin Ruland)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
Message-ID: <42B61D8D.8090200@ku.edu>

Frank,

One of the things Shawn expressed dissatisfaction from was for some
problems, gdal will abort() and the interpreter would go away very
quickly.  This of course, is not very nice behavour.

The problem is very apparent in the NG swig code because I don't do any
special parameter checking prior to calling the underlying method.  So
for example, say "out.tif" only contains one layer, then if I do this:

f = gdal.Open( 'out.tif' )
f.GetRasterBand(42)

The underlying GDALDataset::GetRasterBand() gets the numer 42 with no
prior checking.  It rightfually decides this is a good time to issue a
CPLError( CE_Fatal,....).  The problem is CPLErrorV will call abort() if
the error class is CE_Fatal.  Bye bye python.

I see that in the old bindings, you place extra checks in the script
side for the parameters. This is not very amenable to supporting
multiple bindings.

Is there any way to remove this abort() entirely and leave it up to the
application to decide if a problem is serious enough to abort?  It just
seems more polite but I don't understand what the implications would be.

Kevin



From fwarmerdam at gmail.com  Sun Jun 19 21:46:38 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
In-Reply-To: <42B61D8D.8090200@ku.edu>
References: <42B61D8D.8090200@ku.edu>
Message-ID: <931f8ea905061918464b8382aa@mail.gmail.com>

On 6/19/05, Kevin Ruland <kruland@ku.edu> wrote:
> Frank,
> 
> One of the things Shawn expressed dissatisfaction from was for some
> problems, gdal will abort() and the interpreter would go away very
> quickly.  This of course, is not very nice behavour.
> 
> The problem is very apparent in the NG swig code because I don't do any
> special parameter checking prior to calling the underlying method.  So
> for example, say "out.tif" only contains one layer, then if I do this:
> 
> f = gdal.Open( 'out.tif' )
> f.GetRasterBand(42)
> 
> The underlying GDALDataset::GetRasterBand() gets the numer 42 with no
> prior checking.  It rightfually decides this is a good time to issue a
> CPLError( CE_Fatal,....).  The problem is CPLErrorV will call abort() if
> the error class is CE_Fatal.  Bye bye python.
> 
> I see that in the old bindings, you place extra checks in the script
> side for the parameters. This is not very amenable to supporting
> multiple bindings.
> 
> Is there any way to remove this abort() entirely and leave it up to the
> application to decide if a problem is serious enough to abort?  It just
> seems more polite but I don't understand what the implications would be.

Kevin,

I'm not really keen on removing the abort() for fatal errors, but
I do think that this particular error should be changed to just
a normal CE_Failure error intsead of a fatal error.  Really the
only use I see currently for the fatal error is when CPLMalloc()
fails in an allocation.  

I will change GDALDataset::GetRasterBand() to issue a 
CE_Failure error and return NULL in case of an illegal input.
This can be then translated into an appropriate type of exception
in python and possibly other languages. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dem at acri-st.fr  Mon Jun 20 03:59:35 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Fwd: [kakadu_jpeg2000] Re: Support for GeoJPEG2000 needed
Message-ID: <6.1.1.1.0.20050620092250.05920f78@pop3>

Jukka,

I forward you mail to the GDAL's mailing list gdal-dev@remotesensing.org 
and more appropriate Geospatial JPEG2000 mailing list 
jpeg2000@remotesensing.org

>Hi Julien,
>
>One question about GeoJPEG2000: Is it so, that in order to put the
>right information into the uuid box you should first have a valid
>GeoTIFF image?

Yes. GDAL creates a 1x1 pixel valid GeoTIFF in memory and write it to the 
jp2 uuid box.

>What about if you only have images already in JPEG2000
>format and corresponding world files, should you in this case first
>convert them to GeoTIFF and then back to GeoJP2?

In this case you have to create the uuid box geotiff from the world file.
GDAL do that if the world file has the same prefix and .wld.

>How about if you
>manipulate GeoJP2 images somehow (subsample, re-project etc.), is
>GDAL taking care of editing the georeferencing data as well?

Yes sure. A GDAL utility gdalwarp do subsample and reprojection and change 
the georeferencing as well.


>I have understood that OGC is preparing a GML based solution for
>including spatial reference data in JPEG2000 files. Does anybody know
>if this specification will be ready in the near future?

I think Frank Warmerdam from GDAL is the good person to answer to this.


Regards,

Julien


>Regards,
>
>Jukka Rahkonen
>
>--- In kakadu_jpeg2000@yahoogroups.com, Julien Demaria <dem@a...>
>wrote:
> > At 05:03 17/06/2005, Greg Coats wrote:
> > >Julien,
> > >Thanks for your message, unfortunately it leaves me confused.
> > >
> > >Under the heading Building GDAL From Source, External Libraries
>this web
> > >page http://www.gdal.org/gdal_building.html#libraries says that
>GDAL's
> > >JPEG2000 support is based on JasPer.  I suspect this web page has
>out of
> > >date information.  JasPer was superseded about two years ago by
> > >GeoJasPer.  GeoJasPer is fully aware of georeferencing info.
> > >GeoJasPer correctly transcodes between GeoTIFF and GeoJPEG2000
>files.
> > >If GDAL is using GeoJasPer to support GeoTIFF and GeoJPEG2000
>files, then
> > >GDAL does not have to do anything.
> >
> > In fact GDAL support GeoJPEG2000 by several way :
> >          - the first driver is implemented with Jasper :
> > http://www.gdal.org/frmt_jpeg2000.html
> >            but I believe Jasper is less performant than Kakadu (and
>I
> > believe it read ALL the image in memory)
> >          - another driver is based on Kakadu :
> > http://www.gdal.org/frmt_jp2kak.html
> >          - now there is 2 other drivers supporting (Geo)JPEG2000 :
> >                  - with proprietary MrSID SDK which now can
>read/write JP2
> > too (I believe they use Kakadu internally)
> >                  - with the new free ErMapper ECW SDK, which also
>support
> > JP2 http://www.ermapper.com/downloads/download_view.aspx?
>PRODUCT_VERSION_ID=266
> >
> >
> > >A GeoJPEG2000 file begins with the standard JPEG2000 boxes, then
>adds a
> > >uuid box with georeferencing info, and concludes with the usual
>JPEG2000
> > >code stream.  A GeoJPEG2000 file could be made from a JPEG2000
>file by
> > >inserting a uuid box with georeferencing info between the standard
> > >JPEG2000 boxes and the JPEG2000 code stream.
> >
> > Yes I know and I GDAL do that very well : next the part in GDAL
>sources
> > which write the GeoTIFF informations in the jp2 uuid box :
> >
> > /*******************************************************************
>*****/
> > /*                       JP2KAKWriteGeoTIFFInfo
>()                       */
> > /*******************************************************************
>*****/
> >
> > void JP2KAKWriteGeoTIFFInfo( jp2_target *jp2_out, GDALDataset
>*poSrcDS )
> >
> > {
> > /* -----------------------------------------------------------------
>--- */
> > /*      Prepare the memory buffer containing the degenerate
>GeoTIFF     */
> > /*
>file.                                                           */
> > /* -----------------------------------------------------------------
>--- */
> >      const char *pszWKT;
> >      double      adfGeoTransform[6];
> >      int         nGTBufSize = 0;
> >      unsigned char *pabyGTBuf = NULL;
> >
> >      if( GDALGetGCPCount( poSrcDS ) > 0 )
> >          pszWKT = poSrcDS->GetGCPProjection();
> >      else
> >          pszWKT = poSrcDS->GetProjectionRef();
> >
> >      poSrcDS->GetGeoTransform(adfGeoTransform);
> >
> >      if( GTIFMemBufFromWkt( pszWKT, adfGeoTransform,
> >                             poSrcDS->GetGCPCount(), poSrcDS->GetGCPs
>(),
> >                             &nGTBufSize, &pabyGTBuf ) != CE_None )
> >          return;
> >
> >      if( nGTBufSize == 0 )
> >          return;
> >
> > /* -----------------------------------------------------------------
>--- */
> > /*      Write to a box on the JP2
>file.                                 */
> > /* -----------------------------------------------------------------
>--- */
> > #ifdef KAKADU4
> >      jp2_out->open_next( jp2_uuid_box_type );
> >
> >      jp2_out->write( (kdu_byte *) msi_uuid2, sizeof(msi_uuid2) );
> >
> >      jp2_out->write( (kdu_byte *) pabyGTBuf, nGTBufSize );
> >
> >      jp2_out->close();
> > #else
> >      jp2_output_box &uuid_box = jp2_out->open_box(
>jp2_uuid_box_type );
> >
> >      uuid_box.write( (kdu_byte *) msi_uuid2, sizeof(msi_uuid2) );
> >
> >      uuid_box.write( (kdu_byte *) pabyGTBuf, nGTBufSize );
> >
> >      uuid_box.close();
> > #endif
> >
> >      CPLFree( pabyGTBuf );
> > }
> >
> >
> >
> > >Given a losslessly compressed, archived GeoJPEG2000 file as input
>to be
> > >transcoded into a lossy GeoJPEG2000 image as output, all JPEG2000
> > >transcoders read the size of the uuid box and then read the
>georeferencing
> > >info.  If the JPEG2000 transcoder is not geo-aware, then it
>essentially
> > >discards the geo-info it just read in the uuid box.  If the
>JPEG2000
> > >transcoder is geo-aware, then it simply copies/writes the geo-info
>into a
> > >uuid box identical to the uuid box it just read.
> >
> > I think a transcoder not geo-aware should copying all jp2 uuid box
>from
> > input to output. It hasn't to know what is it in the box, only to
>copy it
> > to copy the maximum of inputs informations, isn't it ?
> >
> >
> > >Since the Kakadu Software is the basis from many other JPEG2000
> > >transcoders, and frequently updated, it makes sense to include the
>copying
> > >of the georeferencing uuid box in Kakadu, rather than requiring
>each
> > >developer to reinvent this process.
> >
> > Yes I like the idea Kakadu utilities copies the geo information
>from
> > geojp2/geotiff to geojp2/geotiff, why not.
> >
> > >I got the impression from Professor Taubman that several Kakadu
>developers
> > >have already incorporated support for GeoJPEG2000 and GeoTIFF in
>their
> > >products.  If they will publicly document this, then that would be
> > >great.  If not, since I think it is to everyone's advantage to add
> > >GeoJPEG2000 and GeoTIFF support to Kakadu Software, then I
>volunteer to do so.
> >
> > You should see the GDAL source code of the kakadu and geotiff
>drivers.
> >
> > Best Regards,
> >
> > Julien
> >
> > >Greg
> > >
> > >
> > >On Jun 16, 2005, at 3:44 AM, Julien Demaria wrote:
> > >>Greg,
> > >>If your need is only to read/write GeoTIFF and GeoJPEG2000 you
>should use
> > >>this library/utilities : http://www.gdal.org/ (I send a separate
>copy of
> > >>this post to the GDAL's mailing list).
> > >>It's a "Geospatial Data Abstraction Library" widely used which
>can
> > >>read/write many (~ 50) raster formats in a same generic way.
> > >>GDAL read/write GeoTIFF and has a GeoJPEG2000 driver using the
>Kakadu
> > >>library which allows to read/write GeoJPEG2000 files.
> > >>For example with GAL utilities you can create a GeoJPEG2000 from
>a GeoTIFF :
> > >>gdal_translate -of GTiff geojp2.jp2 geotiff.tif
> > >>the inverse operation is :
> > >>gdal_translate -of JP2KAK -co "QUALITY=10" geotiff.tif geojp2.jp2
> > >>for create a GeoJP2 file (with size 10% of the original file)
>using
> > >>Kakadu library.
> > >>
> > >>If your really need to implement GeoTIFF geolocation in Kakadu
>TIFF and
> > >>JP2 support, maybe you should also based your work on GDAL
>library.
> > >>But to my mind I think GDAL already do what you want...
> > >>Regards,
> > >>Julien
> > >>
> > >>At 21:27 15/06/2005, greg_coatman wrote:
> > >>>Professor Taubman has advised me that the Kakadu Software does
>not read
> > >>>nor write
> > >>>GeoTIFF and GeoJPEG2000 images, and he asked me to post a public
>message
> > >>>here.
> > >>>Has anyone documented all of the changes necessary to the Kakadu
> > >>>Software so that it
> > >>>can read and write GeoTIFF and GeoJPEG2000 images?
>
>
>
>
>
>For problems with your subscription in this group please email
>kakadu_jpeg2000-owner@yahoogroups.com.
>
>Yahoo! Groups Links
>
><*> To visit your group on the web, go to:
>     http://groups.yahoo.com/group/kakadu_jpeg2000/
>
><*> To unsubscribe from this group, send an email to:
>     kakadu_jpeg2000-unsubscribe@yahoogroups.com
>
><*> Your use of Yahoo! Groups is subject to:
>     http://docs.yahoo.com/info/terms/
>


From kruland at ku.edu  Mon Jun 20 09:54:03 2005
From: kruland at ku.edu (Kevin Ruland)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
In-Reply-To: <931f8ea905061918464b8382aa@mail.gmail.com>
References: <42B61D8D.8090200@ku.edu>
	<931f8ea905061918464b8382aa@mail.gmail.com>
Message-ID: <42B6CA7B.4030106@ku.edu>


Frank:

Fair enough solution.

But I think I could trump the whole thing and let you do what you need
to do.  Suppose in language binding X (where X = python :) I write my
own special little ErrorHandler.  And further this ErrorHandler does not
return to the caller (CPLErrorV) but rather throws.  Then in the Swig
binding world, I catch this throw and convert into an appropriate
exception in language X.  Of course, there are some issues:  1)  Need to
have swig generated try blocks around *every* native call.  2) I don't
know how this would interact with user supplied error handlers.  The
user supplied error handler would have to raise/throw/whatever in order
to trump the abort().  This might be fairly simple to do in the ScriptX
<-> ErrorHandler mapping wrapper, but there could be some rather wierd
issues.

Kevin

Frank Warmerdam wrote:

>On 6/19/05, Kevin Ruland <kruland@ku.edu> wrote:
>  
>
>>Frank,
>>
>>One of the things Shawn expressed dissatisfaction from was for some
>>problems, gdal will abort() and the interpreter would go away very
>>quickly.  This of course, is not very nice behavour.
>>
>>The problem is very apparent in the NG swig code because I don't do any
>>special parameter checking prior to calling the underlying method.  So
>>for example, say "out.tif" only contains one layer, then if I do this:
>>
>>f = gdal.Open( 'out.tif' )
>>f.GetRasterBand(42)
>>
>>The underlying GDALDataset::GetRasterBand() gets the numer 42 with no
>>prior checking.  It rightfually decides this is a good time to issue a
>>CPLError( CE_Fatal,....).  The problem is CPLErrorV will call abort() if
>>the error class is CE_Fatal.  Bye bye python.
>>
>>I see that in the old bindings, you place extra checks in the script
>>side for the parameters. This is not very amenable to supporting
>>multiple bindings.
>>
>>Is there any way to remove this abort() entirely and leave it up to the
>>application to decide if a problem is serious enough to abort?  It just
>>seems more polite but I don't understand what the implications would be.
>>    
>>
>
>Kevin,
>
>I'm not really keen on removing the abort() for fatal errors, but
>I do think that this particular error should be changed to just
>a normal CE_Failure error intsead of a fatal error.  Really the
>only use I see currently for the fatal error is when CPLMalloc()
>fails in an allocation.  
>
>I will change GDALDataset::GetRasterBand() to issue a 
>CE_Failure error and return NULL in case of an illegal input.
>This can be then translated into an appropriate type of exception
>in python and possibly other languages. 
>
>Best regards,
>  
>

From fwarmerdam at gmail.com  Mon Jun 20 09:58:37 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Fwd: [kakadu_jpeg2000] Re: Support for GeoJPEG2000
	needed
In-Reply-To: <6.1.1.1.0.20050620092250.05920f78@pop3>
References: <6.1.1.1.0.20050620092250.05920f78@pop3>
Message-ID: <931f8ea90506200658118ab5a5@mail.gmail.com>

On 6/20/05, Julien Demaria <dem@acri-st.fr> wrote:
> >I have understood that OGC is preparing a GML based solution for
> >including spatial reference data in JPEG2000 files. Does anybody know
> >if this specification will be ready in the near future?
 
Folks,

The GML-in-JPEG2000 specification was up for approval at the
OGC TC meetings last week as an RFC.  If it passed I believe it
should be publically viewable within a few weeks.  In the meantime
I would be happy to provide samples of the files from our interoperability
experiment and information on the format. 

As soon as possible I shall try to get details up at my geospatial
jpeg2000 page at:

   http://www.remotesensing.org/jpeg2000/

In general I am happy to answer questions about geospatial formats
for JPEG2000 and their use in GDAL.  

Lastly, the geolocation models for the various geo-jpeg2000
products can be somewhat complicated, so it is not clear that
it would be appropriate to try and represent them in a normalized
way in Kakadu itself.   Doing so well, would almost certainly
involve a whole geotiff parser as well as GML parsing. 

Lastly, I would like to thank Julien for his excellent and accurate
answers so far on this thread.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon Jun 20 10:04:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
In-Reply-To: <42B6CA7B.4030106@ku.edu>
References: <42B61D8D.8090200@ku.edu>
	<931f8ea905061918464b8382aa@mail.gmail.com> <42B6CA7B.4030106@ku.edu>
Message-ID: <931f8ea90506200704234308ee@mail.gmail.com>

On 6/20/05, Kevin Ruland <kruland@ku.edu> wrote:
> 
> Frank:
> 
> Fair enough solution.
> 
> But I think I could trump the whole thing and let you do what you need
> to do.  Suppose in language binding X (where X = python :) I write my
> own special little ErrorHandler.  And further this ErrorHandler does not
> return to the caller (CPLErrorV) but rather throws.  Then in the Swig
> binding world, I catch this throw and convert into an appropriate
> exception in language X.  Of course, there are some issues:  1)  Need to
> have swig generated try blocks around *every* native call.  2) I don't
> know how this would interact with user supplied error handlers.  The
> user supplied error handler would have to raise/throw/whatever in order
> to trump the abort().  This might be fairly simple to do in the ScriptX
> <-> ErrorHandler mapping wrapper, but there could be some rather wierd
> issues.

Kevin,

Certainly the error handlers installed can choose to do something
other than returning if the error class is CE_Fatal.  But keep in mind
that the error class is set to fatal because continued execution on 
the main code path is not possible.  GDAL datastructures are likely
to be arbitrarily invalid after such an error.  

PS. I have committed the patch to remove the fatal error in
the GetRasterBand() method.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From kruland at ku.edu  Mon Jun 20 10:10:35 2005
From: kruland at ku.edu (Kevin Ruland)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
In-Reply-To: <931f8ea90506200704234308ee@mail.gmail.com>
References: <42B61D8D.8090200@ku.edu>	
	<931f8ea905061918464b8382aa@mail.gmail.com>
	<42B6CA7B.4030106@ku.edu>
	<931f8ea90506200704234308ee@mail.gmail.com>
Message-ID: <42B6CE5B.7070302@ku.edu>


>Kevin,
>
>Certainly the error handlers installed can choose to do something
>other than returning if the error class is CE_Fatal.  But keep in mind
>that the error class is set to fatal because continued execution on 
>the main code path is not possible.  GDAL datastructures are likely
>to be arbitrarily invalid after such an error.  
>
>  
>

Frank.

That would certainly be true and it would be up to the programmer to
make sure they didn't do anything stupid, like ignore the exception.  In
the event of such an error, the script might have some important work to
do such as return an error page (in cgi applications) or close databases
or start a pot of coffee for a late night debugging session and the
premature abort() would prevent any action.

Actually, if the error was from malloc, there could be quite a bit of
invalidation throughout the interpreter.  Maybe this wouldn't be such a
good idea.

Kevin



From fwarmerdam at gmail.com  Mon Jun 20 10:27:24 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] CPLErrorV change to better support scriptland
In-Reply-To: <42B6CE5B.7070302@ku.edu>
References: <42B61D8D.8090200@ku.edu>
	<931f8ea905061918464b8382aa@mail.gmail.com> <42B6CA7B.4030106@ku.edu>
	<931f8ea90506200704234308ee@mail.gmail.com> <42B6CE5B.7070302@ku.edu>
Message-ID: <931f8ea9050620072729309de@mail.gmail.com>

On 6/20/05, Kevin Ruland <kruland@ku.edu> wrote:
> Frank.
> 
> That would certainly be true and it would be up to the programmer to
> make sure they didn't do anything stupid, like ignore the exception.  In
> the event of such an error, the script might have some important work to
> do such as return an error page (in cgi applications) or close databases
> or start a pot of coffee for a late night debugging session and the
> premature abort() would prevent any action.

Kevin,

Right.  However, in my experience, with the GetRasterBand() case
set aside, abort() fatal errors are very rare.  It only really happens
if CPLMalloc() fails and that only normally happens if a size calculation
goes wonky.  Large allocations are normally done via VSIMalloc()
(a direct wrapper) and in those cases the caller is expected to recover
gracefully from a failed allocation.
 
> Actually, if the error was from malloc, there could be quite a bit of
> invalidation throughout the interpreter.  Maybe this wouldn't be such a
> good idea.

Well, safe recover might still be difficult.  My suggestion is not to 
worry about this aspect much at this time as I don't think it will arise
except in the worst of circumstances in the future. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon Jun 20 11:47:02 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Adding Projection to ECW files ?
In-Reply-To: <Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>
References: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>
	<Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>
Message-ID: <931f8ea905062008472d1bad89@mail.gmail.com>

On 6/19/05, Bill Binko <bill@binko.net> wrote:
> 
> Hi everyone: I hope everyone enjoyed the conference.  If anyone has time
> to look at this, I'd really appreciate it.  I really would like to be busy
> making summary layers, but am stuck at this point.

Bill, 

Sorry for the delay in responding.  As always there are various
ways of approaching this.   Ideally at the point you were
generating the ECW file you would have set the coordinate system.
Something like this (assuming WGS84):

gdal_translate -of ECW -a_srs '+proj=utm +zone=17 +datum=WGS84' in.tif out.ecw

Assuming you don't want to regenerate the ECWs you should be able to push
the georeferencing into the PAM file (.aux.xml) with a small python script. 

I had intended to provide an example of this, but find that I have another bug
to pursue before I can complete this, but I had better send this email before
I reboot. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pgao at esri.com  Mon Jun 20 12:01:50 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] JPEG and EXIF tags
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F1D@firewire.esri.com>



Some digital cameras can output JPEG images with EXIF (Exchangeable
image file format) tags. Is it possible to get these tags through GDAL
as 
metadata (name=value pairs)?

Thanks,
Gao, Peng

From fwarmerdam at gmail.com  Mon Jun 20 12:12:05 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] JPEG and EXIF tags
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F1D@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F1D@firewire.esri.com>
Message-ID: <931f8ea905062009121d8404f6@mail.gmail.com>

On 6/20/05, Peng Gao <pgao@esri.com> wrote:
> 
> 
> Some digital cameras can output JPEG images with EXIF (Exchangeable
> image file format) tags. Is it possible to get these tags through GDAL
> as
> metadata (name=value pairs)?

Peng,

Currently it is fairly clumsy to read EXIF information with libtiff, because
though the EXIF information is stored in a TIFF directory it is not a
proper "image" directory making it hard to access with TIFFReadDirectory().

I believe that Andrey Kiselev is working on improving that situation in
libtiff, after which it would be easier for GDAL to access EXIF information.
If, in the meantime, it is quite critical to support reading EXIF info I 
could hack a custom directory reader into the GDAL TIFF driver but it
would be at least a few hours of work. 

I too am keen on getting access to the EXIF info from within GDAL.  I
heard about some interesting projects being done with GPS enabled
digital cameras last week, which I believe bundle the location 
information (as well as timestamps and other info) in EXIF packets. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bill at binko.net  Mon Jun 20 13:09:06 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Adding Projection to ECW files ?
In-Reply-To: <931f8ea905062008472d1bad89@mail.gmail.com>
References: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net> 
	<Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>
	<931f8ea905062008472d1bad89@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0506201306150.20356@fastcat.binko.net>

On Mon, 20 Jun 2005, Frank Warmerdam wrote:

> On 6/19/05, Bill Binko <bill@binko.net> wrote:
> > 
> > Hi everyone: I hope everyone enjoyed the conference.  If anyone has time
> > to look at this, I'd really appreciate it.  I really would like to be busy
> > making summary layers, but am stuck at this point.
> 
> Bill, 
> 
> Sorry for the delay in responding.  As always there are various
> ways of approaching this.   Ideally at the point you were
> generating the ECW file you would have set the coordinate system.
> Something like this (assuming WGS84):
> 
> gdal_translate -of ECW -a_srs '+proj=utm +zone=17 +datum=WGS84' in.tif out.ecw
> 

I knew you were busy with the conference: this is important to me, but not 
critical.  Unfortunately, I got the ECWs rather than the TIFFs, so I can't 
re-compress them.  I considered using gdal_translate from ECW to ECW, but 
was worried that I might lose fidelity.

> Assuming you don't want to regenerate the ECWs you should be able to push
> the georeferencing into the PAM file (.aux.xml) with a small python script. 
> 

Is that PAM file documented anywhere?  I can write a script to edit XML if 
I know what I'm writing to.

> I had intended to provide an example of this, but find that I have another bug
> to pursue before I can complete this, but I had better send this email before
> I reboot. 

Understood: I appreciate any help you can give.

Thanks,
Bill

From fwarmerdam at gmail.com  Mon Jun 20 13:37:01 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Adding Projection to ECW files ?
In-Reply-To: <Pine.LNX.4.58.0506201306150.20356@fastcat.binko.net>
References: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>
	<Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>
	<931f8ea905062008472d1bad89@mail.gmail.com>
	<Pine.LNX.4.58.0506201306150.20356@fastcat.binko.net>
Message-ID: <931f8ea9050620103753950a43@mail.gmail.com>

On 6/20/05, Bill Binko <bill@binko.net> wrote:
> I knew you were busy with the conference: this is important to me, but not
> critical.  Unfortunately, I got the ECWs rather than the TIFFs, so I can't
> re-compress them.  I considered using gdal_translate from ECW to ECW, but
> was worried that I might lose fidelity.

Bill, 

Indeed,  recompressing would be somewhat lossy.

> > Assuming you don't want to regenerate the ECWs you should be able to push
> > the georeferencing into the PAM file (.aux.xml) with a small python script.
> >
> 
> Is that PAM file documented anywhere?  I can write a script to edit XML if
> I know what I'm writing to.

It is essentially a subset of the VRT format, so the VRT docs might help.   To 
set the SRS, just edit it add an <SRS>+proj=utm +zone=17 +datum=WGS84</SRS>
node as a child of the <PAMDataset>. 

A minimal file might look like:

abc.ecw.aux.xml:
<PAMDataset>
  <SRS>+proj=utm +zone=17 +datum=WGS84</SRS>
</PAMDataset>

Any followup likely ought to stay on the gdal-dev list. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon Jun 20 13:48:40 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Limited type support in OGR CSV driver
In-Reply-To: <42B28C68.5040101@archivideo.com>
References: <42B28C68.5040101@archivideo.com>
Message-ID: <931f8ea9050620104877cae3dd@mail.gmail.com>

On 6/17/05, Sebastien Grignard <sebastien.grignard@archivideo.com> wrote:
> Hello.
> I've added type support for the CSV driver.
> With these patches you can now write a little csv help file to indicate
> the columns types to OGR.
> It works as follow :
>   - suppose you have a foobar.csv file that looks like this :
>     "ID","X","Y","AREA","NAME"
>     "1","1023.5","243.56","675","FOOBAR"
>     ...
>   - now write a foobar.csvt file like this one :
>     "Integer","Real","Real","Integer","String"
> The driver will then use the types you specified for the csv columns.
> The only types recognized are Integer,Real and String.

Sebastien, 

I have applied this change.  There have been somewhat 
similar proposals before, but what I like about yours is that it
depends on an optional external file so simple access still works
as it did. 

Would you consider submitting a patch for drv_csv.html describing
the feature for users?  Does the csv driver write these files out too?
If you were feeling really ambitious you could even supply additions
to gdalautotest/ogr/ogr_csv.py testing the new capabilities.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon Jun 20 14:46:08 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] HDF-5
Message-ID: <931f8ea90506201146363ae6f2@mail.gmail.com>

Folks,

Early last week I was at the ESIP summer meeting.  ESIP is the
Earth Science Information Partners and is mostly related to 
NASA (and other federal) earth science data utilization.  

One of the discussions was about the HDF-5 format.  It is being
used for more NASA data products, and may well be adopted in
other areas of the industry.  I have also seen some client interest in it.

I am soliciting feedback on features people thing should be supported
by a GDAL HDF-5 driver, existing HDF-5 products that can be used
for compatibility testing, likely "issues", and any GDAL users 
interested in financially supporting work on an HDF-5 driver. 

I was also surprised to learn that the NetCDF 4 "format" is really
HDF-5.  It seems that a next generation of the NetCDF library is
available that uses HDF5 internally as the storage format, but providing
roughly the traditional NetCDF data definition and auxilary data 
concepts.  I am interested in gauging interest in this too. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dburken at comcast.net  Mon Jun 20 16:46:19 2005
From: dburken at comcast.net (David Burken)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] test
Message-ID: <42B72B1B.4080409@comcast.net>

Sorry for the inconvenience.  Testing list...

Dave


From dburken at comcast.net  Mon Jun 20 15:04:19 2005
From: dburken at comcast.net (David Burken)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] hdf4 patch for modis 9 product to pick up geometry
	info...
In-Reply-To: <931f8ea90506201146363ae6f2@mail.gmail.com>
References: <931f8ea90506201146363ae6f2@mail.gmail.com>
Message-ID: <42B71333.7040507@comcast.net>

Hi Frank,

Your hdf mail made me think of this.

The following diff allows me to pick up the geometry info from an hdf4 
modis 9 product.  I'm not sure if this is the best way to do it but it 
seems to work. 

I'm also have problems finding another tool that can verify the 
correctness of the geometry.  ENVI does not pick it up, at least mine 
trial version anyway.  In ossim it seems to be off in the latitude 
direction by about nine minutes when swiped against an elevation cell.  
It's a "sinusoidal " projection.

Let me know if you want the whole file.

Here is the diff for file (basically two lines):  
gdal/frmts/hdf4/hdf4dataset.cpp
817a825,833
 >     else if ( CSLFetchNameValue(poDS->papszGlobalMetadata, 
"HDFEOSVersion") ||>               ( (pszValue = 
CSLFetchNameValue(poDS->papszGlobalMetadata,
 >                                                "PARAMETERNAME"))
 >                 && EQUALN( pszValue, "MOD09A1", 7 ) ) )
 >      {
 >         poDS->iSubdatasetType = EOS_GRID;
 >         poDS->pszSubdatasetType = "EOS_GRID";
 >      }
 >
834c850
<     if ( CSLFetchNameValue(poDS->papszGlobalMetadata, "HDFEOSVersion") )
---
 >     if ( poDS->iSubdatasetType == EOS_GRID )

Take care,
Dave

ps: Curious how your big tiff is doing???


From dburken at comcast.net  Mon Jun 20 16:55:36 2005
From: dburken at comcast.net (David Burken)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] hdf4 patch for modis 9 product to pick up geometry info.
Message-ID: <42B72D48.3000204@comcast.net>

Hi Frank,

Your hdf mail made me think of this.

The following diff allows me to pick up the geometry info from an hdf4 
modis 9 product.  I'm not sure if this is the best way to do it but it 
seems to work.
I'm also have problems finding another tool that can verify the 
correctness of the geometry.  ENVI does not pick it up, at least mine 
trial version anyway.  In ossim it seems to be off in the latitude 
direction by about nine minutes when swiped against an elevation cell.  
It's a "sinusoidal " projection.

Let me know if you want the whole file.

Here is the diff for file (basically two lines):  
gdal/frmts/hdf4/hdf4dataset.cpp
817a825,833
 >     else if ( CSLFetchNameValue(poDS->papszGlobalMetadata, 
"HDFEOSVersion") ||>               ( (pszValue = 
CSLFetchNameValue(poDS->papszGlobalMetadata,
 >                                                "PARAMETERNAME"))
 >                 && EQUALN( pszValue, "MOD09A1", 7 ) ) )
 >      {
 >         poDS->iSubdatasetType = EOS_GRID;
 >         poDS->pszSubdatasetType = "EOS_GRID";
 >      }
 >
834c850
<     if ( CSLFetchNameValue(poDS->papszGlobalMetadata, "HDFEOSVersion") )
---
 >     if ( poDS->iSubdatasetType == EOS_GRID )

Take care,
Dave

ps: Curious how your big tiff is doing???

-- 
Dave
mailto:dburken@comcast.net




From armin.burger at gmx.net  Mon Jun 20 15:11:18 2005
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
Message-ID: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>

Hi everybody,

I tried to compile the new ECW JPEG 2000 SDK 3.2 beta under Linux. It compiled without errors (using the 'older system' compilation with 'NCSNightlyBuildUnix.ksh'), but under the ../bin/linux/ directory it just created the 'libNCSEcwC.so', not the 'libNCSEcw.so'. GDAL looks for this file and also the docs say that it should be created. Any clues why?

Armin

From bill at binko.net  Mon Jun 20 18:07:42 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
References: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
Message-ID: <Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>

On Mon, 20 Jun 2005, Armin Burger wrote:

> Hi everybody,

> 
> I tried to compile the new ECW JPEG 2000 SDK 3.2 beta under Linux. It
> compiled without errors (using the 'older system' compilation with
> 'NCSNightlyBuildUnix.ksh'), but under the ../bin/linux/ directory it
> just created the 'libNCSEcwC.so', not the 'libNCSEcw.so'. GDAL looks for
> this file and also the docs say that it should be created. Any clues
> why?
> 

I found that I had to build with 

NCSNightlyBuildUnix.ksh release

to get the libraries that GDAL needed.  I also HIGHLY recommend either 
applying my patch or using the debug libraries (built with NCS....ksh 
debug) and changing the GDALmake.opt files.

My patch can be found here:

http://forums.ermapper.com/viewtopic.php?p=1630#1630

Bill

From bill at binko.net  Mon Jun 20 18:10:28 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>
References: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
	<Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>
Message-ID: <Pine.LNX.4.58.0506201809210.5834@fastcat.binko.net>


I'm sorry, Armin... I thought you were talking about -rc2.

Could you point me to the download location for 3.2?

>From what Tom responded, my patch will not be in any release for a while, 
so you will probably still need it.

Bill

On Mon, 20 Jun 2005, Bill Binko wrote:

> On Mon, 20 Jun 2005, Armin Burger wrote:
> 
> > Hi everybody,
> 
> > 
> > I tried to compile the new ECW JPEG 2000 SDK 3.2 beta under Linux. It
> > compiled without errors (using the 'older system' compilation with
> > 'NCSNightlyBuildUnix.ksh'), but under the ../bin/linux/ directory it
> > just created the 'libNCSEcwC.so', not the 'libNCSEcw.so'. GDAL looks for
> > this file and also the docs say that it should be created. Any clues
> > why?
> > 
> 
> I found that I had to build with 
> 
> NCSNightlyBuildUnix.ksh release
> 
> to get the libraries that GDAL needed.  I also HIGHLY recommend either 
> applying my patch or using the debug libraries (built with NCS....ksh 
> debug) and changing the GDALmake.opt files.
> 
> My patch can be found here:
> 
> http://forums.ermapper.com/viewtopic.php?p=1630#1630
> 
> Bill
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 

From armin.burger at gmx.net  Mon Jun 20 18:48:21 2005
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
References: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
	<Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>
	<Pine.LNX.4.58.0506201809210.5834@fastcat.binko.net>
Message-ID: <cqGEyxcVPe2vQdS3VD4HwuZFNeKI0QRfY3mdgaKTTt9@akmail>

Bill,

the 3.2 beta is at

http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=276

Armin


> I'm sorry, Armin... I thought you were talking about -rc2.

> Could you point me to the download location for 3.2?

> From what Tom responded, my patch will not be in any release for a while,
> so you will probably still need it.

> Bill

> On Mon, 20 Jun 2005, Bill Binko wrote:

>> On Mon, 20 Jun 2005, Armin Burger wrote:
>>
>> > Hi everybody,
>>
>> >
>> > I tried to compile the new ECW JPEG 2000 SDK 3.2 beta under Linux. It
>> > compiled without errors (using the 'older system' compilation with
>> > 'NCSNightlyBuildUnix.ksh'), but under the ../bin/linux/ directory it
>> > just created the 'libNCSEcwC.so', not the 'libNCSEcw.so'. GDAL looks for
>> > this file and also the docs say that it should be created. Any clues
>> > why?
>> >
>>
>> I found that I had to build with
>>
>> NCSNightlyBuildUnix.ksh release
>>
>> to get the libraries that GDAL needed.  I also HIGHLY recommend either
>> applying my patch or using the debug libraries (built with NCS....ksh
>> debug) and changing the GDALmake.opt files.
>>
>> My patch can be found here:
>>
>> http://forums.ermapper.com/viewtopic.php?p=1630#1630
>>
>> Bill
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@xserve.flids.com
>> http://xserve.flids.com/mailman/listinfo/gdal-dev
>>
>>



From starged at videotron.ca  Mon Jun 20 19:33:04 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] OpenEV tools updates
Message-ID: <42B75230.3030904@videotron.ca>

Hi folks,

Here are the latest updates to my OpenEV tools.

WMS Tool:

- it is now possible to define a http proxy (pref http_proxy in the preferences file)
- server exceptions are now shown
- correct datatype assigned

Fusion Tool:

- works with Quickbird (and possibly Ikonos) imagery
- removed ROI support for now
- warped VRT replaced with gdal.ReprojectImage()
- added block read/write support for more efficient processing

Histo Enhance:

- added preliminary support for Quickbird and Ikonos dynamic range 0-2047 (ie 11-bits)
- added histos_directory preference. This directory and the current image directory are scanned 
for existing histogram files

Also, an early version of a raster projection tool has been added but only so people can help me 
find the bug that causes reprojected images to be blank when reopened after OpenEV is restarted. 
This only happens when the "(Open in) Current View" option is selected. I'd appreciate any 
feedback on this...

All the tools can be found at http://pages.infinit.net/starged/openev/index.htm

Thank you.
--
Mario B.

From bill at binko.net  Tue Jun 21 00:44:16 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <cqGEyxcVPe2vQdS3VD4HwuZFNeKI0QRfY3mdgaKTTt9@akmail>
References: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
	<Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>
	<Pine.LNX.4.58.0506201809210.5834@fastcat.binko.net>
	<cqGEyxcVPe2vQdS3VD4HwuZFNeKI0QRfY3mdgaKTTt9@akmail>
Message-ID: <Pine.LNX.4.58.0506210041480.19633@fastcat.binko.net>


Armin,

Thanks: I tried the new build system to create libecwj2 and had it build 
correctly.  I update GDAL to use it.  However, I get a segfault on opening 
a ECW file with gdalinfo with this stack:

#0  0x405c1aa5 in NCSMutexBegin () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#1  0x40587474 in NCSecwGlobalLock () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#2  0x40503a16 in CNCSJPCGlobalLock::Lock () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#3  0x40503a7b in CNCSJPCGlobalLock::CNCSJPCGlobalLock () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#4  0x40520714 in CNCSJP2FileView::CNCSJP2FileView () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#5  0x40587b1d in CNCSFile::CNCSFile () from /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
#6  0x400d0a17 in ECWDataset::Open () from /usr/lib/libgdal.so.1
#7  0x400d1110 in ECWDataset::OpenECW () from /usr/lib/libgdal.so.1
#8  0x4017963f in GDALOpen () from /usr/lib/libgdal.so.1
#9  0x08049ae7 in main ()

I am going to try the old build process and see if that is more 
successful.

Bill

 On Tue, 21 Jun 2005, Armin Burger wrote:

> Bill,
> 
> the 3.2 beta is at
> 
> http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=276
> 
> Armin
> 
> 
> > I'm sorry, Armin... I thought you were talking about -rc2.
> 
> > Could you point me to the download location for 3.2?
> 
> > From what Tom responded, my patch will not be in any release for a while,
> > so you will probably still need it.
> 
> > Bill
> 
> > On Mon, 20 Jun 2005, Bill Binko wrote:
> 
> >> On Mon, 20 Jun 2005, Armin Burger wrote:
> >>
> >> > Hi everybody,
> >>
> >> >
> >> > I tried to compile the new ECW JPEG 2000 SDK 3.2 beta under Linux. It
> >> > compiled without errors (using the 'older system' compilation with
> >> > 'NCSNightlyBuildUnix.ksh'), but under the ../bin/linux/ directory it
> >> > just created the 'libNCSEcwC.so', not the 'libNCSEcw.so'. GDAL looks for
> >> > this file and also the docs say that it should be created. Any clues
> >> > why?
> >> >
> >>
> >> I found that I had to build with
> >>
> >> NCSNightlyBuildUnix.ksh release
> >>
> >> to get the libraries that GDAL needed.  I also HIGHLY recommend either
> >> applying my patch or using the debug libraries (built with NCS....ksh
> >> debug) and changing the GDALmake.opt files.
> >>
> >> My patch can be found here:
> >>
> >> http://forums.ermapper.com/viewtopic.php?p=1630#1630
> >>
> >> Bill
> >> _______________________________________________
> >> Gdal-dev mailing list
> >> Gdal-dev@xserve.flids.com
> >> http://xserve.flids.com/mailman/listinfo/gdal-dev
> >>
> >>
> 
> 
> 
> 

From tflynch at gmail.com  Tue Jun 21 01:04:40 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <Pine.LNX.4.58.0506210041480.19633@fastcat.binko.net>
References: <zb49Oz8yzKn6WXg8JXSmddg93xXcgbVcdy3pjB2BwNt@akmail>
	<Pine.LNX.4.58.0506201804590.5834@fastcat.binko.net>
	<Pine.LNX.4.58.0506201809210.5834@fastcat.binko.net>
	<cqGEyxcVPe2vQdS3VD4HwuZFNeKI0QRfY3mdgaKTTt9@akmail>
	<Pine.LNX.4.58.0506210041480.19633@fastcat.binko.net>
Message-ID: <c39b2a6505062022043219c4c4@mail.gmail.com>

Hi Bill,

The problem is probably in GDAL ... the new "libecwj2" static build requires 
a call to NCSecwInit() to be made prior to library use and a call to 
NCSecwShutdown() be made following use. These initialize and shutdown 
various resources (include those used by the mutexes) which would explain 
the segfault you're seeing.

I will try to coordinate with Frank on getting the necessary changes into 
GDAL - he may prefer to wait for a more stable version. In the meantime I am 
actively working on providing more documentation and fewer hassles (and 
probably an autoconf-based build - this was discussed a bit at OSG) as soon 
as possible.

Cheers :-)

On 6/21/05, Bill Binko <bill@binko.net> wrote:
> 
> 
> Armin,
> 
> Thanks: I tried the new build system to create libecwj2 and had it build
> correctly. I update GDAL to use it. However, I get a segfault on opening
> a ECW file with gdalinfo with this stack:
> 
> #0 0x405c1aa5 in NCSMutexBegin () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #1 0x40587474 in NCSecwGlobalLock () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #2 0x40503a16 in CNCSJPCGlobalLock::Lock () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #3 0x40503a7b in CNCSJPCGlobalLock::CNCSJPCGlobalLock () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #4 0x40520714 in CNCSJP2FileView::CNCSJP2FileView () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #5 0x40587b1d in CNCSFile::CNCSFile () from 
> /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> #6 0x400d0a17 in ECWDataset::Open () from /usr/lib/libgdal.so.1
> #7 0x400d1110 in ECWDataset::OpenECW () from /usr/lib/libgdal.so.1
> #8 0x4017963f in GDALOpen () from /usr/lib/libgdal.so.1
> #9 0x08049ae7 in main ()
> 
> I am going to try the old build process and see if that is more
> successful.
> 
> Bill
> 
-- 
Tom Lynch
Development, ER Mapper
Phone: +61 8 93882900
Fax: +61 8 93882901
Email: tom.lynch@ermapper.com
Web: http://www.ermapper.com
Forums: http://forum.ermapper.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050621/46acef0b/attachment.html
From armin.burger at gmx.net  Tue Jun 21 02:33:14 2005
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
References: <c39b2a6505062022043219c4c4@mail.gmail.com>
Message-ID: <3553.1119335594@www53.gmx.net>

Tom,

if you try the 'old build' method then only libNCSEcwC.so is created, but
not libNCSEcw.so, even if the documentation says it should so. 

Armin

> --- Urspr?ngliche Nachricht ---
> Von: Tom Lynch <tflynch@gmail.com>
> An: Bill Binko <bill@binko.net>
> Kopie: gdal-dev@remotesensing.org
> Betreff: Re: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
> Datum: Tue, 21 Jun 2005 13:04:40 +0800
> 
> Hi Bill,
> 
> The problem is probably in GDAL ... the new "libecwj2" static build
> requires 
> a call to NCSecwInit() to be made prior to library use and a call to 
> NCSecwShutdown() be made following use. These initialize and shutdown 
> various resources (include those used by the mutexes) which would explain 
> the segfault you're seeing.
> 
> I will try to coordinate with Frank on getting the necessary changes into 
> GDAL - he may prefer to wait for a more stable version. In the meantime I
> am 
> actively working on providing more documentation and fewer hassles (and 
> probably an autoconf-based build - this was discussed a bit at OSG) as
> soon 
> as possible.
> 
> Cheers :-)
> 
> On 6/21/05, Bill Binko <bill@binko.net> wrote:
> > 
> > 
> > Armin,
> > 
> > Thanks: I tried the new build system to create libecwj2 and had it build
> > correctly. I update GDAL to use it. However, I get a segfault on opening
> > a ECW file with gdalinfo with this stack:
> > 
> > #0 0x405c1aa5 in NCSMutexBegin () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #1 0x40587474 in NCSecwGlobalLock () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #2 0x40503a16 in CNCSJPCGlobalLock::Lock () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #3 0x40503a7b in CNCSJPCGlobalLock::CNCSJPCGlobalLock () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #4 0x40520714 in CNCSJP2FileView::CNCSJP2FileView () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #5 0x40587b1d in CNCSFile::CNCSFile () from 
> > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > #6 0x400d0a17 in ECWDataset::Open () from /usr/lib/libgdal.so.1
> > #7 0x400d1110 in ECWDataset::OpenECW () from /usr/lib/libgdal.so.1
> > #8 0x4017963f in GDALOpen () from /usr/lib/libgdal.so.1
> > #9 0x08049ae7 in main ()
> > 
> > I am going to try the old build process and see if that is more
> > successful.
> > 
> > Bill
> > 
> -- 
> Tom Lynch
> Development, ER Mapper
> Phone: +61 8 93882900
> Fax: +61 8 93882901
> Email: tom.lynch@ermapper.com
> Web: http://www.ermapper.com
> Forums: http://forum.ermapper.com
> 

-- 
Geschenkt: 3 Monate GMX ProMail gratis + 3 Ausgaben stern gratis
++ Jetzt anmelden & testen ++ http://www.gmx.net/de/go/promail ++

From tflynch at gmail.com  Tue Jun 21 03:02:31 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <3553.1119335594@www53.gmx.net>
References: <c39b2a6505062022043219c4c4@mail.gmail.com>
	<3553.1119335594@www53.gmx.net>
Message-ID: <c39b2a6505062100025c86f08e@mail.gmail.com>

That's a peculiar situation - the makefile for libNCSEcwC (see 'makefile' in 
$INSTALL/Source/C/NCSEcw/NCSEcwC_SDK/) explicitly requires linkage to 
libNCSEcw, libNCScnet and libNCSUtil, so you shouldn't be able to build it 
without those libraries present on your system.

What are the contents of <install directory>/bin/<platform> after you run 
the build script?

Also, what edits have you made to NCSNightlyBuildUnix.ksh? It is usually 
necessary to edit the shebang line and the value of $NCSTOP - the shebang 
line should point to your shell of choice, and $NCSTOP should be the dir in 
which you unzipped the SDK archive.

Maybe the files are being created somewhere you don't expect them to be.

Tom.



On 6/21/05, Armin Burger <armin.burger@gmx.net> wrote:
> 
> Tom,
> 
> if you try the 'old build' method then only libNCSEcwC.so is created, but
> not libNCSEcw.so, even if the documentation says it should so.
> 
> Armin
> 
> > --- Urspr?ngliche Nachricht ---
> > Von: Tom Lynch <tflynch@gmail.com>
> > An: Bill Binko <bill@binko.net>
> > Kopie: gdal-dev@remotesensing.org
> > Betreff: Re: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
> > Datum: Tue, 21 Jun 2005 13:04:40 +0800
> >
> > Hi Bill,
> >
> > The problem is probably in GDAL ... the new "libecwj2" static build
> > requires
> > a call to NCSecwInit() to be made prior to library use and a call to
> > NCSecwShutdown() be made following use. These initialize and shutdown
> > various resources (include those used by the mutexes) which would 
> explain
> > the segfault you're seeing.
> >
> > I will try to coordinate with Frank on getting the necessary changes 
> into
> > GDAL - he may prefer to wait for a more stable version. In the meantime 
> I
> > am
> > actively working on providing more documentation and fewer hassles (and
> > probably an autoconf-based build - this was discussed a bit at OSG) as
> > soon
> > as possible.
> >
> > Cheers :-)
> >
> > On 6/21/05, Bill Binko <bill@binko.net> wrote:
> > >
> > >
> > > Armin,
> > >
> > > Thanks: I tried the new build system to create libecwj2 and had it 
> build
> > > correctly. I update GDAL to use it. However, I get a segfault on 
> opening
> > > a ECW file with gdalinfo with this stack:
> > >
> > > #0 0x405c1aa5 in NCSMutexBegin () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #1 0x40587474 in NCSecwGlobalLock () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #2 0x40503a16 in CNCSJPCGlobalLock::Lock () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #3 0x40503a7b in CNCSJPCGlobalLock::CNCSJPCGlobalLock () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #4 0x40520714 in CNCSJP2FileView::CNCSJP2FileView () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #5 0x40587b1d in CNCSFile::CNCSFile () from
> > > /home/bill/cvsroot/ecw32beta/lib/libecwj2.so.1
> > > #6 0x400d0a17 in ECWDataset::Open () from /usr/lib/libgdal.so.1
> > > #7 0x400d1110 in ECWDataset::OpenECW () from /usr/lib/libgdal.so.1
> > > #8 0x4017963f in GDALOpen () from /usr/lib/libgdal.so.1
> > > #9 0x08049ae7 in main ()
> > >
> > > I am going to try the old build process and see if that is more
> > > successful.
> > >
> > > Bill
> > >
> > --
> > Tom Lynch
> > Development, ER Mapper
> > Phone: +61 8 93882900
> > Fax: +61 8 93882901
> > Email: tom.lynch@ermapper.com
> > Web: http://www.ermapper.com
> > Forums: http://forum.ermapper.com
> >
> 
> --
> Geschenkt: 3 Monate GMX ProMail gratis + 3 Ausgaben stern gratis
> ++ Jetzt anmelden & testen ++ http://www.gmx.net/de/go/promail ++
> 



-- 
Tom Lynch
Development, ER Mapper
Phone: +61 8 93882900
Fax: +61 8 93882901
Email: tom.lynch@ermapper.com
Web: http://www.ermapper.com
Forums: http://forum.ermapper.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050621/ed3d62c1/attachment.html
From bill at binko.net  Tue Jun 21 03:24:22 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Compiling ECW JPEG 2000 SDK 3.2 beta
In-Reply-To: <c39b2a6505062100025c86f08e@mail.gmail.com>
References: <c39b2a6505062022043219c4c4@mail.gmail.com>
	<3553.1119335594@www53.gmx.net>
	<c39b2a6505062100025c86f08e@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0506210320160.27506@fastcat.binko.net>


Armin, Tom:

After getting the beta to build (all of the libraries) the old way, I am 
still getting the segfault.

Armin, at this point, I think trying to use the beta with GDAL is not 
going to be productive.  If you're trying to get the ECW library by 
itself, that's a different matter.

I'm (unfortuately) tabling this until Frank gets back and has a chance to 
take a look.  

I am attaching a patch that does get GDAL to build with the new libs, but 
I am not sure where or how to best put in those calls that Tom mentioned.  
Therefore, it's of dubious worth.

Tom: did that patch make it into the beta?  If not, is there anything I 
can do to help with that?

Bill

On Tue, 21 Jun 2005, Tom Lynch wrote:

> That's a peculiar situation - the makefile for libNCSEcwC (see 'makefile' in 
> $INSTALL/Source/C/NCSEcw/NCSEcwC_SDK/) explicitly requires linkage to 
> libNCSEcw, libNCScnet and libNCSUtil, so you shouldn't be able to build it 
> without those libraries present on your system.
> 
> What are the contents of <install directory>/bin/<platform> after you run 
> the build script?
> 
> Also, what edits have you made to NCSNightlyBuildUnix.ksh? It is usually 
> necessary to edit the shebang line and the value of $NCSTOP - the shebang 
> line should point to your shell of choice, and $NCSTOP should be the dir in 
> which you unzipped the SDK archive.
> 
> Maybe the files are being created somewhere you don't expect them to be.
> 
> Tom.
> 
> 
> 
-------------- next part --------------
? .libs
? config.log
? libgdal.la
? libtool
? newbuild.patch
? alg/.libs
? apps/.libs
? frmts/ecw/.libs
? frmts/ecw/ecwcreatecopy.lo
? frmts/ecw/ecwdataset.lo
? frmts/ecw/jp2userbox.lo
? frmts/o/.libs
? frmts/o/ogdidataset.loT
? ogr/.libs
? ogr/dq3810nw.ecw
? ogr/ogrtindex
? ogr/ogrsf_frmts/o/.libs
? port/.libs
? pymod/.libs
? pymod/_gdalmodule.la
? pymod/gdal_wrap.lo
? pymod/gdalnumeric.lo
? pymod/numpydataset.lo
Index: configure
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/configure,v
retrieving revision 1.165
diff -U5 -r1.165 configure
--- configure	12 May 2005 06:39:08 -0000	1.165
+++ configure	21 Jun 2005 05:48:24 -0000
@@ -24414,17 +24414,17 @@
 
   echo "ECW support disabled."
 
 elif test "$with_ecw" = "yes" -o "$with_ecw" = "" ; then
 
-  echo "$as_me:$LINENO: checking for NCScbmOpenFileView in -lNCSEcw" >&5
-echo $ECHO_N "checking for NCScbmOpenFileView in -lNCSEcw... $ECHO_C" >&6
-if test "${ac_cv_lib_NCSEcw_NCScbmOpenFileView+set}" = set; then
+  echo "$as_me:$LINENO: checking for NCScbmOpenFileView in -lecwj2" >&5
+echo $ECHO_N "checking for NCScbmOpenFileView in -lecwj2... $ECHO_C" >&6
+if test "${ac_cv_lib_ecwj2_NCScbmOpenFileView+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lNCSEcw  $LIBS"
+LIBS="-lecwj2  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
@@ -24465,45 +24465,45 @@
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
   ac_status=$?
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }; then
-  ac_cv_lib_NCSEcw_NCScbmOpenFileView=yes
+  ac_cv_lib_ecwj2_NCScbmOpenFileView=yes
 else
   echo "$as_me: failed program was:" >&5
 sed 's/^/| /' conftest.$ac_ext >&5
 
-ac_cv_lib_NCSEcw_NCScbmOpenFileView=no
+ac_cv_lib_ecwj2_NCScbmOpenFileView=no
 fi
 rm -f conftest.err conftest.$ac_objext \
       conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-echo "$as_me:$LINENO: result: $ac_cv_lib_NCSEcw_NCScbmOpenFileView" >&5
-echo "${ECHO_T}$ac_cv_lib_NCSEcw_NCScbmOpenFileView" >&6
-if test $ac_cv_lib_NCSEcw_NCScbmOpenFileView = yes; then
+echo "$as_me:$LINENO: result: $ac_cv_lib_ecwj2_NCScbmOpenFileView" >&5
+echo "${ECHO_T}$ac_cv_lib_ecwj2_NCScbmOpenFileView" >&6
+if test $ac_cv_lib_ecwj2_NCScbmOpenFileView = yes; then
   ECW_SETTING=yes
 else
   ECW_SETTING=no
 fi
 
 
   if test "$ECW_SETTING" = "yes" ; then
-    LIBS="-lNCSEcw $LIBS"
+    LIBS="-lecwj2 $LIBS"
   fi
 
 else
 
-  echo "$as_me:$LINENO: checking for libNCSEcw.so" >&5
-echo $ECHO_N "checking for libNCSEcw.so... $ECHO_C" >&6
+  echo "$as_me:$LINENO: checking for libecwj2.so" >&5
+echo $ECHO_N "checking for libecwj2.so... $ECHO_C" >&6
   ECW_SETTING=yes
-  if test -r $with_ecw/lib/libNCSEcw.so ; then
-    LIBS="-L$with_ecw/lib -lNCSEcw $LIBS"
+  if test -r $with_ecw/lib/libecwj2.so ; then
+    LIBS="-L$with_ecw/lib -lecwj2 $LIBS"
     echo "$as_me:$LINENO: result: found in $with_ecw/lib." >&5
 echo "${ECHO_T}found in $with_ecw/lib." >&6
-  elif test -r $with_ecw/bin/libNCSEcw.so ; then
-    LIBS="-L$with_ecw/bin -lNCSEcw $LIBS"
+  elif test -r $with_ecw/bin/libecwj2.so ; then
+    LIBS="-L$with_ecw/bin -lecwj2 $LIBS"
     echo "$as_me:$LINENO: result: found in $with_ecw/bin." >&5
 echo "${ECHO_T}found in $with_ecw/bin." >&6
   else
     { { echo "$as_me:$LINENO: error: not found in $with_ecw/lib or $with_ecw/bin." >&5
 echo "$as_me: error: not found in $with_ecw/lib or $with_ecw/bin." >&2;}
Index: configure.in
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/configure.in,v
retrieving revision 1.143
diff -U5 -r1.143 configure.in
--- configure.in	12 May 2005 06:39:09 -0000	1.143
+++ configure.in	21 Jun 2005 05:48:24 -0000
@@ -859,25 +859,25 @@
 
   echo "ECW support disabled."
 
 elif test "$with_ecw" = "yes" -o "$with_ecw" = "" ; then
 
-  AC_CHECK_LIB(NCSEcw,NCScbmOpenFileView,ECW_SETTING=yes,ECW_SETTING=no,)
+  AC_CHECK_LIB(ecwj2,NCScbmOpenFileView,ECW_SETTING=yes,ECW_SETTING=no,)
 
   if test "$ECW_SETTING" = "yes" ; then   
-    LIBS="-lNCSEcw $LIBS"
+    LIBS="-lecwj2 $LIBS"
   fi
 
 else
 
-  AC_MSG_CHECKING([for libNCSEcw.so])
+  AC_MSG_CHECKING([for libecwj2.so])
   ECW_SETTING=yes
-  if test -r $with_ecw/lib/libNCSEcw.so ; then
-    LIBS="-L$with_ecw/lib -lNCSEcw $LIBS"
+  if test -r $with_ecw/lib/libecwj2.so ; then
+    LIBS="-L$with_ecw/lib -lecwj2 $LIBS"
     AC_MSG_RESULT([found in $with_ecw/lib.])
-  elif test -r $with_ecw/bin/libNCSEcw.so ; then
-    LIBS="-L$with_ecw/bin -lNCSEcw $LIBS"
+  elif test -r $with_ecw/bin/libecwj2.so ; then
+    LIBS="-L$with_ecw/bin -lecwj2 $LIBS"
     AC_MSG_RESULT([found in $with_ecw/bin.])
   else
     AC_MSG_ERROR([not found in $with_ecw/lib or $with_ecw/bin.])
   fi
 
Index: frmts/ecw/GNUmakefile
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/frmts/ecw/GNUmakefile,v
retrieving revision 1.9
diff -U5 -r1.9 GNUmakefile
--- frmts/ecw/GNUmakefile	2 Apr 2005 21:18:45 -0000	1.9
+++ frmts/ecw/GNUmakefile	21 Jun 2005 05:48:24 -0000
@@ -2,11 +2,11 @@
 
 include $(GDAL_ROOT)/GDALmake.opt
 
 OBJ	=	ecwdataset.o ecwcreatecopy.o jp2userbox.o
 
-CPPFLAGS	:=	$(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)
+CPPFLAGS	:=	$(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS) -DLINUX -DPOSIX
 
 default:	$(OBJ)
 
 clean:
 	rm -f *.o $(O_OBJ)
From tugrul at galatali.com  Tue Jun 21 15:43:04 2005
From: tugrul at galatali.com (Tugrul Galatali)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Empty Tiles in GeoTIFFs
Message-ID: <1119382984.31596.97.camel@basin>

	I've recently been working on a high resolution but sparse dataset that
I've been storing in tiled GeoTIFFs. The bulk of the tiles are blank,
and in my own software I just don't write these tiles to the file, and
assume an error in reading one means it was blank to begin with. Which
works great until I attempt to use a third party tool, including GDAL.

	Is what I'm doing a cheap hack I should never expect support for, and
is there a raster format that does have explicit support for missing
tiles?

	Also, after looking at a GeoTIFF generated by GDAL, and skimming the
source and this list, it looks like TIFFTAG_GDAL_NODATA is a string of a
single double, despite -src/dstnodata taking a value per band in
gdalwarp. Is this the set definition for that tag, or is it bound to
change in the future for multiple band support?

-- 
Tugrul Galatali <tugrul@galatali.com>


From craig.miller at spatialminds.com  Tue Jun 21 15:53:52 2005
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Determine table geometry type?
Message-ID: <ALEXANDRIAql2RkeS8Y00000043@ALEXANDRIA.spatialminds.local>

I'm trying to determine the type of geometry stored in a PostGIS  table via
OGR.  I am trying to do this by calling 

 

pogrLayer->GetLayerDefn()->GetGeomType();

 

In my code this always returns wkbUnknown for layers.  Is GeomType supported
for layers?

 

 

 

Another options is to query the OGIS extension tables directly and parse the
results.  Is this the easiest/correct way of determining all spatial tables?

 

"SELECT f_table_catalog AS catalog, f_table_schema as schema, f_table_name
AS tablename, f_geometry_column as dgname FROM Geometry_Columns";

 

 

Thanks for the help,

Craig

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050621/36a98f15/attachment.html
From hamish_nospam at yahoo.com  Tue Jun 21 21:42:06 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] JPEG and EXIF tags
In-Reply-To: <931f8ea905062009121d8404f6@mail.gmail.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F1D@firewire.esri.com>
	<931f8ea905062009121d8404f6@mail.gmail.com>
Message-ID: <20050622134206.6066e4c8.hamish_nospam@yahoo.com>

> > Some digital cameras can output JPEG images with EXIF (Exchangeable
> > image file format) tags. Is it possible to get these tags through
> > GDAL as metadata (name=value pairs)?



see the metacam software for doing EXIF -> ASCII

   http://www.cheeseplant.org/~daniel/pages/metacam.html

(GPL)



Hamish

From pgao at esri.com  Wed Jun 22 01:21:48 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Strange NoData value from a  MrSID image
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F31@firewire.esri.com>

GDAL returns a strange NoData value (-1.2197742815800439e-012) from 
one of my mrSID images. The image is 8-bit and has 3 bands.


MrSIDRasterBand::MrSIDRasterBand( MrSIDDataset *poDS, int nBand )
{
    ...

/* --------------------------------------------------------------------
*/
/*      Set NoData values.
*/
/* --------------------------------------------------------------------
*/
     if ( poDS->poNDPixel )
     {
	 dfNoDataValue = poDS->poNDPixel->getSampleValueFloat32( nBand -
1 );
	 bNoDataSet = TRUE;
     }
     else
     {
	 dfNoDataValue = 0.0;
       bNoDataSet = FALSE;
     }
}

From bill at binko.net  Wed Jun 22 04:08:46 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [UMN_MAPSERVER-USERS] [Gdal-dev] Adding Projection to ECW files ?
In-Reply-To: <42B828A7.8060300@axys.net>
References: <Pine.LNX.4.58.0506150307220.1947@fastcat.binko.net>
	<Pine.LNX.4.58.0506191356150.25243@fastcat.binko.net>
	<42B828A7.8060300@axys.net>
Message-ID: <Pine.LNX.4.58.0506220354260.3797@fastcat.binko.net>

I've implemented Tom's suggestion and written a small (and fast), but very 
ugly utility to modify the header information in ECW files.   This is very 
handy when someone ships you ECWs without any projection information in 
them.

It doesn't rely on GDAL, in fact it just mmap's the first 90 bytes of the 
file(s) and lets you change the values.  Like I said, fast, but ugly.

Anyway, it's available at http://www.mapshine.com/ecwhead-0-1.tar.gz if
you'd like to use it.  Here's the usage:

Usage: ecwhead [options] ecwfile1.ecw [ecwfile2.ecw ...]
Options:
  -m    Set Unit to Meters
  -f    Set Unit to Feet
  -d    Set Unit to Degrees
  -u    Set Unit to Unknown
        (if more than one unit is given, the last will be used)
  -x <float>    Set x cell size
  -y <float>    Set y cell size
  -X <float>    Set x world origin
  -Y <float>    Set y world origin
  -D <string>   Set ECW Compliant Datum String ("WGS84")
  -P <string>   Set ECW Compliant Projection String ("NUTM17")

I hope this is helpful to someone.

Tom, if you'd like to take this and run with it, I'll be happy to work 
with you on that: I'm not looking for a job maintaining it.

Unfortunately, this did not solve my problem, so I'm going to be writing 
another note in a second :-(

Bill



From bill at binko.net  Wed Jun 22 04:26:38 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Help with overviews/pyramids
Message-ID: <Pine.LNX.4.58.0506220411190.3797@fastcat.binko.net>

Hi everyone,

(I'm posting this here first, as I believe it's more Raster related than 
Mapserver, but I may post it there too)

I have DOQQs for a large portion of Florida in ECW format.  I just wrote a 
small utility that fixed the projection that they had, and gdalinfo 
correcly reads their info now, but I cannot seem to get gdal_merge.py to 
create a summary image.

I know the terms summary/overview/pyramids are overused (and misused by 
me), so here's what I want.  If someone can help me through this, I'll be 
happy write a script and a HOWTO to feed back to the community.

I would like to run a script to generate lower granularity ("zoomed out") 
versions of these files.  I would like them to be georeferenced, and I 
would like a Mapserver TILEINDEX for them.  

I am not looking for adding overviews into the files (gdaladdo) since ECW 
files have that already.  I would like the separate layer(s) so that my 
application performs at any zoom level.

I have heard theorhetical discussions about how to do this ("Zoom out 
until it gets slow, then use that zoom level and make another layer"), and 
I get it.  I even thought I understood how to do this with gdal_merge.py.  
However, when I run it against my ECWs even to just get a single low-res 
summary image, I get this:

$> gdal_merge.py -o overview.tiff -ps 10 10 -v `ls -1 dq*.ecw | head -10`

ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 704
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 705

....Hundreds of these lines....

ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 706
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 707
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 708
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 709
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 710
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 711
ERROR 1: overview.tiff:Error updating TIFF header
ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 711

It does leave me with a tiff file, but it's not usable (all black with no 
georeferencing).

I'm a bit frustrated.  I thought this was because of the missing 
projections in the ECW, and I have spent alot of time fixing that.  
However, I'm still stuck :-(

Can anyone help?

Thanks
Bill

From todd.jellett at caris.com  Wed Jun 22 07:43:02 2005
From: todd.jellett at caris.com (Todd Jellett)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] EPSG Areas of Applicability
Message-ID: <6.2.0.14.0.20050622083854.037b6710@caris0.caris.priv>

Hi,

Does gdal support the concept of EPSG Areas of Applicability?

I'm assuming that the "areas of applicability" define a rectangle
(or perhaps a polygon) which defines where a particular datum
would be applicable.

Todd


From fwarmerdam at gmail.com  Wed Jun 22 08:58:54 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] EPSG Areas of Applicability
In-Reply-To: <6.2.0.14.0.20050622083854.037b6710@caris0.caris.priv>
References: <6.2.0.14.0.20050622083854.037b6710@caris0.caris.priv>
Message-ID: <931f8ea905062205583bde7132@mail.gmail.com>

On 6/22/05, Todd Jellett <todd.jellett@caris.com> wrote:
> Hi,
> 
> Does gdal support the concept of EPSG Areas of Applicability?
> 
> I'm assuming that the "areas of applicability" define a rectangle
> (or perhaps a polygon) which defines where a particular datum
> would be applicable.

Todd, 

EPSG has a concept of areas of applicability, but unfortunately
they are expressed textually instead of in a form that could
be taken advantage of systematically.  For example:

"AREA_CODE","AREA_NAME","AREA_OF_USE","ISO_A2_CODE","ISO_A3_CODE","ISO_N_CODE","REMARKS","INFORMATION_SOURCE","DATA_SOURCE","REVISION_DATE","CHANGE_ID","DEPRECATED"
1650,Indonesia - S of equator and 96 to 102 deg E,Indonesia - south of
equator and between 96 and 102 deg East.,,,,,EPSG,EPSG,1995-07-21
00:00:00,,0

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jun 22 09:08:55 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Help with overviews/pyramids
In-Reply-To: <Pine.LNX.4.58.0506220411190.3797@fastcat.binko.net>
References: <Pine.LNX.4.58.0506220411190.3797@fastcat.binko.net>
Message-ID: <931f8ea90506220608da0dbc0@mail.gmail.com>

On 6/22/05, Bill Binko <bill@binko.net> wrote:
> ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 704
> ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 705

Bill, 

Is there any chance that your resulting overview is larger than 4GB
or that the input ecw file is too large to hold in RAM in uncompressed
format?    The error looks like an "out of space" or >4GB related
problem. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From br at forstware.de  Wed Jun 22 09:11:59 2005
From: br at forstware.de (Bjoern Ruff)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] IKONOS
Message-ID: <200506221317.j5MDHXkB026777@forstw.forstware.de>

Hello,

since I have not yet worked with gdal,
may be someone can tell me if I can do the following using gdal
before I start trying:

	I get a Ikonos Multispectral image (4 bands in 4 separate files) as
GEOTIFF 11 Bits per pixel
	(1 m resolution, 50 km2 szene)

	Merge the 4 bands to get a color image,
	select rectangles in the merged picture and store them as GeoTiff or
some other georeferenced format.


Cheers,
Bjoern


From fwarmerdam at gmail.com  Wed Jun 22 10:28:18 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] IKONOS
In-Reply-To: <200506221317.j5MDHXkB026777@forstw.forstware.de>
References: <200506221317.j5MDHXkB026777@forstw.forstware.de>
Message-ID: <931f8ea9050622072857df49d7@mail.gmail.com>

On 6/22/05, Bjoern Ruff <br@forstware.de> wrote:
> Hello,
> 
> since I have not yet worked with gdal,
> may be someone can tell me if I can do the following using gdal
> before I start trying:
> 
>         I get a Ikonos Multispectral image (4 bands in 4 separate files) as
> GEOTIFF 11 Bits per pixel
>         (1 m resolution, 50 km2 szene)

Bjoern, 

You can use the gdal_merge.py script distributed with GDAL
to "stack" individual files into a multispectral image.  

eg. 

gdal_merge.py -seperate -o stack.tif band1.tif band2.tif band3.tif band4.tif

Then use gdal_translate to extract subwindows:

gdal_translate -subwin 0 0 512 512 stack.tif  subwindow.tif

This assumes you want to select your window in terms of pixel
coordinates (or projected coordinates with -projwin).  But if you
want to extract the rectangle graphically you will need a GUI app.
This can be accomplished with OpenEV for instance.  In fact, I think
OpenEV includes a "stacking" mechanism.

>         Merge the 4 bands to get a color image,
>         select rectangles in the merged picture and store them as GeoTiff or
> some other georeferenced format.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jun 22 10:33:09 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Strange NoData value from a MrSID image
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F31@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F31@firewire.esri.com>
Message-ID: <931f8ea90506220733469a798f@mail.gmail.com>

On 6/22/05, Peng Gao <pgao@esri.com> wrote:
> GDAL returns a strange NoData value (-1.2197742815800439e-012) from
> one of my mrSID images. The image is 8-bit and has 3 bands.

Peng, 

Have you checked the image with mrsidinfo to see if that value
is what the mrsid internals also report?  Can you supply an example
file?  Some formats use impossible nodata values to indicate that
there is no nodata value.  Perhaps such a bogus value was carried
into a Mrsid file. 

Best regards,
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pgao at esri.com  Wed Jun 22 10:58:03 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Strange NoData value from a MrSID image
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F34@firewire.esri.com>


> -----Original Message-----
> From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
> Sent: Wednesday, June 22, 2005 7:33 AM
> To: Peng Gao
> Cc: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] Strange NoData value from a MrSID image
> 
> On 6/22/05, Peng Gao <pgao@esri.com> wrote:
> > GDAL returns a strange NoData value (-1.2197742815800439e-012) from
> > one of my mrSID images. The image is 8-bit and has 3 bands.
> 
> Peng,
> 
> Have you checked the image with mrsidinfo to see if that value
> is what the mrsid internals also report?  Can you supply an example
> file?  Some formats use impossible nodata values to indicate that
> there is no nodata value.  Perhaps such a bogus value was carried
> into a Mrsid file.
> 

The following are output from mrsidinfo. It seems the nodata value is
0. If it's the case, then GDAL returned value is close. However, one
thing I noticed is that MrSID calls it NoData Color instead of
NoData value. It could mean that a pixel is NoData only if all three
values
are 0. This is different from GDAL's interpretation of NoData value.
This
could explain why my image doesn't display correctly (All black text 
become NoData).

C:\GDAL\codec\DSDK\bin>mrsidinfo
\\archive\CRData\ArcGIS\DataSources\DataSources
Raster\RasterDB\11877\erdrg.sid
mrsidinfo: (c) 2004 LizardTech, Inc. All rights reserved.

basic image info:
  format:            MRSID
  width:             7382
  height:            9305
  nband:             3
  color space:       RGB
  datatype:          uint8
  precision:         8
  dyn range min:     (natural)
  dyn range max:     (natural)
  background color:  (72, 255, 200)
  nodata color:      (0, 0, 0)
  metadata records:  36

geo coordinate info:
  X UL:              748980
  Y UL:              4.32085e+006
  X res:             1.5287
  Y res:             -1.5287
  X rot:             0
  Y rot:             0

geo points (pixel centers):
  upper left:        (748979.965101, 4320850.825793)
  upper right:       (760263.331028, 4320850.825793)
  lower left:        (748979.965101, 4306627.761631)
  lower right:       (760263.331028, 4306627.761631)
  center:            (754621.648064, 4313739.293712)

MrSID image info:
  number of levels:  8
  is locked:         false
  file version:      1.0.1.

MrSID/MG2-specific image info:
  is dithered:       false


C:\GDAL\codec\DSDK\bin>

From fwarmerdam at gmail.com  Wed Jun 22 11:07:05 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Determine table geometry type?
In-Reply-To: <ALEXANDRIAql2RkeS8Y00000043@ALEXANDRIA.spatialminds.local>
References: <ALEXANDRIAql2RkeS8Y00000043@ALEXANDRIA.spatialminds.local>
Message-ID: <931f8ea9050622080757a7aa6e@mail.gmail.com>

On 6/21/05, Craig Miller <craig.miller@spatialminds.com> wrote:
> 
> I'm trying to determine the type of geometry stored in a PostGIS  table via
> OGR.  I am trying to do this by calling 
> 
> pogrLayer->GetLayerDefn()->GetGeomType(); 
> 
> In my code this always returns wkbUnknown for layers.  Is GeomType supported for layers? 

Craig,

I see that Andrey Kiselev has committed changes to pick up the
geometry type (where easy) from the geometry_columns tables 
on May 5th, 2005.  You might want to try upgrading to a more
recent GDAL from CVS or verify that your
gdal/ogr/ogrsf_frmts/pg/ogrpgtablelayer.cpp has  revision 1.27.

Note, this change came originally from Oleg Semykin. 

I would add that GetGeomType() is the right way to ask a 
layer for it's geometry type.  But some drivers don't set this,
either through omission as was the case with the PostGIS driver,
or because the underlying format does not restrict the layer to one
geometry type. 

> Another options is to query the OGIS extension tables directly and parse the
> results.  Is this the easiest/correct way of determining all spatial tables?
> 
>   
> 
> "SELECT f_table_catalog AS catalog, f_table_schema as schema, f_table_name
> AS tablename, f_geometry_column as dgname FROM Geometry_Columns"; 


Well, this still doesn't return the geometry type.  The patch fetches
the "type" field from the geometry_columns tables to get the type.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jun 22 11:09:48 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Empty Tiles in GeoTIFFs
In-Reply-To: <1119382984.31596.97.camel@basin>
References: <1119382984.31596.97.camel@basin>
Message-ID: <931f8ea90506220809208262af@mail.gmail.com>

On 6/21/05, Tugrul Galatali <tugrul@galatali.com> wrote:
>         I've recently been working on a high resolution but sparse dataset that
> I've been storing in tiled GeoTIFFs. The bulk of the tiles are blank,
> and in my own software I just don't write these tiles to the file, and
> assume an error in reading one means it was blank to begin with. Which
> works great until I attempt to use a third party tool, including GDAL.
> 
>         Is what I'm doing a cheap hack I should never expect support for, and
> is there a raster format that does have explicit support for missing
> tiles?

Tugrul, 

Formats such as PCIDSK and Erdas Imagine do have explicit support
for missing tiles. 

It is also my intention that GDAL should treat a tile offset and tile size
of 0 as meaning a tile is NULL, though I haven't really made much use
of this concept.  

>         Also, after looking at a GeoTIFF generated by GDAL, and skimming the
> source and this list, it looks like TIFFTAG_GDAL_NODATA is a string of a
> single double, despite -src/dstnodata taking a value per band in
> gdalwarp. Is this the set definition for that tag, or is it bound to
> change in the future for multiple band support?

It may well change in the future.   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From zhang at aero.und.edu  Wed Jun 22 13:56:27 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
Message-ID: <42B9A64B.9050305@aero.und.edu>

Hi,

I have a humble question which may have been answered before, but could 
anybody please kindly help out. The question is:

If I have a series of points, say in a text file, like
lat1, lon1
lat2, lon2
lat3, lon3
lat4, lon4

How should I format the text file such that an ogr utility (e.g., 
ogr2ogr) can convert it into a shapefile as a polygon.

Many thanks
Xiaodong


From bill at binko.net  Wed Jun 22 14:24:28 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Help with overviews/pyramids
In-Reply-To: <931f8ea90506220608da0dbc0@mail.gmail.com>
References: <Pine.LNX.4.58.0506220411190.3797@fastcat.binko.net>
	<931f8ea90506220608da0dbc0@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0506221416230.19006@fastcat.binko.net>

On Wed, 22 Jun 2005, Frank Warmerdam wrote:

> On 6/22/05, Bill Binko <bill@binko.net> wrote:
> > ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 704
> > ERROR 1: TIFFAppendToStrip:overview.tiff: Write error at scanline 705
> 
> Bill, 
> 
> Is there any chance that your resulting overview is larger than 4GB
> or that the input ecw file is too large to hold in RAM in uncompressed
> format?    The error looks like an "out of space" or >4GB related
> problem. 

I don't think so... the files are displayed fine in Mapserver with a 
TILEINDEX, even when multiple tiles are displayed.  It gets slow (hence 
this effort) when you zoom out, but there's no failure.

The files range from 1 - 13 MB compressed, and I'm only trying the first 
ten, so the compressed total would be less than 130MB.  Certainly that 
wouldn't uncompress to over 1GB of physical and 1GB of virtual memory?

Overall, I have 855 of these totalling about 6GB (including metadata 
files).

Another reason I doubt that its a memory issue is if I do the same command 
line with -of bmp instead of tiff, I get this:

[bill@fastcat ecw_rgb]$ gdal_merge.py -o overview.bmp -of bmp -ps 10 10 -v `ls -1 dq*.ecw | head -10`

Filename: dq2807ne.ecw
File Size: 6272x7019x3
Pixel Size: 1.000000 x -1.000000
UL:(518476.607000,3041884.156000)   LR:(524748.607000,3034865.156000)
.....

With no errors.  However, overview.bmp is just as useless -- its corrupt 
in any viewer I've tried.

Thanks for the help Frank (et al)

Bill

From dron at ak4719.spb.edu  Wed Jun 22 15:58:15 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] hdf4 patch for modis 9 product to pick up geometry
	info...
In-Reply-To: <42B71333.7040507@comcast.net>
References: <931f8ea90506201146363ae6f2@mail.gmail.com>
	<42B71333.7040507@comcast.net>
Message-ID: <20050622195815.GA22799@ak4719.spb.edu>

On Mon, Jun 20, 2005 at 03:04:19PM -0400, David Burken wrote:
> The following diff allows me to pick up the geometry info from an hdf4
> modis 9 product.  I'm not sure if this is the best way to do it but it
> seems to work. 
> 
> I'm also have problems finding another tool that can verify the
> correctness of the geometry.  ENVI does not pick it up, at least mine
> trial version anyway.  In ossim it seems to be off in the latitude
> direction by about nine minutes when swiped against an elevation cell.
> It's a "sinusoidal " projection.
> 
> Let me know if you want the whole file.

Hi, David,

Could you upload that file? Sorry, but I am not sure I understood the
logic in your patch, so I would like to take a look at the unsupported
dataset.

Regards,
Andrey

PS.
Please, make uniform patches (diff -u) in the future. They are much
easier to analyze and apply.


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From zhang at aero.und.edu  Wed Jun 22 16:38:39 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
Message-ID: <42B9CC4F.1000209@aero.und.edu>

Hi,

I have a humble question which may have been answered before, but could 
anybody please kindly help out. The question is:

If I have a series of points, say in a text file, like
lat1, lon1
lat2, lon2
lat3, lon3
lat4, lon4

How should I format the text file such that an ogr utility (e.g., 
ogr2ogr) can convert it into a shapefile as a polygon.

Many thanks
Xiaodong


From nacional at cbs.umn.edu  Wed Jun 22 16:53:58 2005
From: nacional at cbs.umn.edu (Pericles S. Nacionales)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
In-Reply-To: <42B9CC4F.1000209@aero.und.edu>
References: <42B9CC4F.1000209@aero.und.edu>
Message-ID: <42B9CFE6.7030505@cbs.umn.edu>

Greetings, Xiaodong!

I'm sure there are more than one way to do it but in the past this is 
what I've done (this is the ESRI generate file format):

101
lon1,lat1
lon2, lat2
...
lonN,latN
END
102
lon1,lat1
lon2, lat2
...
lonN,latN
END
END

save it as a file and you can then find the gen2shp utility somewhere 
(or the gen2shp extension for ArcView3) and convert it to a shapefile. 
Or you can use Arc/Info "generate" to create a coverage.  The example 
above will give you two polygons with IDs 101 and 102.  I haven't done 
this in years so my memory might be a little hazy.

If ogr2ogr supports it, that would be even better!

I hope that helps.

-Perry

Xiaodong Zhang wrote:
> Hi,
> 
> I have a humble question which may have been answered before, but could 
> anybody please kindly help out. The question is:
> 
> If I have a series of points, say in a text file, like
> lat1, lon1
> lat2, lon2
> lat3, lon3
> lat4, lon4
> 
> How should I format the text file such that an ogr utility (e.g., 
> ogr2ogr) can convert it into a shapefile as a polygon.
> 
> Many thanks
> Xiaodong
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 

From fwarmerdam at gmail.com  Wed Jun 22 19:19:53 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
In-Reply-To: <42B9CC4F.1000209@aero.und.edu>
References: <42B9CC4F.1000209@aero.und.edu>
Message-ID: <931f8ea905062216196c44dfab@mail.gmail.com>

On 6/22/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> Hi,
> 
> I have a humble question which may have been answered before, but could
> anybody please kindly help out. The question is:
> 
> If I have a series of points, say in a text file, like
> lat1, lon1
> lat2, lon2
> lat3, lon3
> lat4, lon4
> 
> How should I format the text file such that an ogr utility (e.g.,
> ogr2ogr) can convert it into a shapefile as a polygon.

Xiaodong,

Perry's suggestion should work well.  Another alternative
is to treat your file as a .csv file, and then write a small VRT
file to show OGR how to treat the columns as x/y values of a point.
Then use ogr2ogr to convert it to a shapefile. 

See:

  http://www.gdal.org/ogr/drv_csv.html
  http://www.gdal.org/ogr/drv_vrt.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dburken at comcast.net  Thu Jun 23 07:55:07 2005
From: dburken at comcast.net (David Burken)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] hdf4 patch for modis 9 product to pick up geometry
	info...
In-Reply-To: <20050622195815.GA22799@ak4719.spb.edu>
References: <931f8ea90506201146363ae6f2@mail.gmail.com>	<42B71333.7040507@comcast.net>
	<20050622195815.GA22799@ak4719.spb.edu>
Message-ID: <42BAA31B.2060008@comcast.net>

Hi Andrey,

Andrey Kiselev wrote:

>On Mon, Jun 20, 2005 at 03:04:19PM -0400, David Burken wrote:
>  
>
>>The following diff allows me to pick up the geometry info from an hdf4
>>modis 9 product.  I'm not sure if this is the best way to do it but it
>>seems to work. 
>>
>>I'm also have problems finding another tool that can verify the
>>correctness of the geometry.  ENVI does not pick it up, at least mine
>>trial version anyway.  In ossim it seems to be off in the latitude
>>direction by about nine minutes when swiped against an elevation cell.
>>It's a "sinusoidal " projection.
>>
>>Let me know if you want the whole file.
>>    
>>
>
>Hi, David,
>
>Could you upload that file? Sorry, but I am not sure I understood the
>logic in your patch, so I would like to take a look at the unsupported
>dataset.
>
>Regards,
>Andrey
>  
>
I will send you a link to the two samples.

>PS.
>Please, make uniform patches (diff -u) in the future. They are much
>easier to analyze and apply.
>  
>
Can do.
Thanks,
Dave


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050623/4d0315b3/attachment.html
From BEN at Syncera-ITSolutions.NL  Thu Jun 23 10:50:12 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
Message-ID: <s2bae84d.079@syncera.nl>

Hi list,

is it possible using GDAL to clip a raster using a polygon from eg a shapefile and have all the rest turn into NODATA values? If it is possible, how does it work?

Thanks in advance.

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl


From zhang at aero.und.edu  Thu Jun 23 11:12:26 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
In-Reply-To: <42B9CFE6.7030505@cbs.umn.edu>
References: <42B9CC4F.1000209@aero.und.edu> <42B9CFE6.7030505@cbs.umn.edu>
Message-ID: <42BAD15A.8080603@aero.und.edu>

Thanks Perry,

Your memory is good. It is working. Much appreciate.

Xiaodong

Pericles S. Nacionales wrote:

> Greetings, Xiaodong!
>
> I'm sure there are more than one way to do it but in the past this is 
> what I've done (this is the ESRI generate file format):
>
> 101
> lon1,lat1
> lon2, lat2
> ...
> lonN,latN
> END
> 102
> lon1,lat1
> lon2, lat2
> ...
> lonN,latN
> END
> END
>
> save it as a file and you can then find the gen2shp utility somewhere 
> (or the gen2shp extension for ArcView3) and convert it to a shapefile. 
> Or you can use Arc/Info "generate" to create a coverage.  The example 
> above will give you two polygons with IDs 101 and 102.  I haven't done 
> this in years so my memory might be a little hazy.
>
> If ogr2ogr supports it, that would be even better!
>
> I hope that helps.
>
> -Perry
>
> Xiaodong Zhang wrote:
>
>> Hi,
>>
>> I have a humble question which may have been answered before, but 
>> could anybody please kindly help out. The question is:
>>
>> If I have a series of points, say in a text file, like
>> lat1, lon1
>> lat2, lon2
>> lat3, lon3
>> lat4, lon4
>>
>> How should I format the text file such that an ogr utility (e.g., 
>> ogr2ogr) can convert it into a shapefile as a polygon.
>>
>> Many thanks
>> Xiaodong
>>
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@xserve.flids.com
>> http://xserve.flids.com/mailman/listinfo/gdal-dev
>>
>>


From fwarmerdam at gmail.com  Thu Jun 23 11:38:44 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <s2bae84d.079@syncera.nl>
References: <s2bae84d.079@syncera.nl>
Message-ID: <931f8ea905062308381d2c223f@mail.gmail.com>

On 6/23/05, Bart van den Eijnden <BEN@syncera-itsolutions.nl> wrote:
> Hi list,
> 
> is it possible using GDAL to clip a raster using a polygon from eg a shapefile and have all the rest turn into NODATA values? If it is possible, how does it work?

Bart, 

I'm afraid this capability is not currently available in GDAL itself. 
There is a rasterization algorithm in OpenEV that operates against
GDAL raster files, but it has not been migrated down into GDAL. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From zhang at aero.und.edu  Thu Jun 23 12:04:06 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
In-Reply-To: <931f8ea905062216196c44dfab@mail.gmail.com>
References: <42B9CC4F.1000209@aero.und.edu>
	<931f8ea905062216196c44dfab@mail.gmail.com>
Message-ID: <1119542646.42badd766673e@portal.aero.und.edu>

Hi Frank,

Thanks for the help. I'm almost there, but still have one problem. I can create
a shapefile for points but get an error for polygon.

[run:]$ ogr2ogr -f "ESRI Shapefile" test merja.vrt

ERROR 1: Attempt to write non-polygon (POINT) geometry to  type shapefile.
ERROR 1: Terminating translation prematurely after failed
translation of layer MyAOI

[run:]$ cat merja.vrt
<OGRVRTDataSource>

    <OGRVRTLayer name="MyAOI">
        <SrcDataSource relativeToVRT="1">AOIs</SrcDataSource>
 	<SrcLayer>aoi1</SrcLayer>
	<GeometryType>wkbPolygon</GeometryType>
        <LayerSRS>WGS84</LayerSRS>
	<GeometryField encoding="PointFromColumns" x="x" y="y"/>
    </OGRVRTLayer>

</OGRVRTDataSource>

[run:]$ cat AOIs/aoi1.csv
id, x, y
1, -100, 40
2, -90, 40
3, -90, 39
4, -100, 39
5, -100, 40

Thanks
Xiaodong


Quoting Frank Warmerdam <fwarmerdam@gmail.com>:

> On 6/22/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> > Hi,
> > 
> > I have a humble question which may have been answered before, but could
> > anybody please kindly help out. The question is:
> > 
> > If I have a series of points, say in a text file, like
> > lat1, lon1
> > lat2, lon2
> > lat3, lon3
> > lat4, lon4
> > 
> > How should I format the text file such that an ogr utility (e.g.,
> > ogr2ogr) can convert it into a shapefile as a polygon.
> 
> Xiaodong,
> 
> Perry's suggestion should work well.  Another alternative
> is to treat your file as a .csv file, and then write a small VRT
> file to show OGR how to treat the columns as x/y values of a point.
> Then use ogr2ogr to convert it to a shapefile. 
> 
> See:
> 
>   http://www.gdal.org/ogr/drv_csv.html
>   http://www.gdal.org/ogr/drv_vrt.html
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 



From fwarmerdam at gmail.com  Thu Jun 23 12:25:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] convert a group of points (lat, lon) to a shape file
In-Reply-To: <1119542646.42badd766673e@portal.aero.und.edu>
References: <42B9CC4F.1000209@aero.und.edu>
	<931f8ea905062216196c44dfab@mail.gmail.com>
	<1119542646.42badd766673e@portal.aero.und.edu>
Message-ID: <931f8ea9050623092524351327@mail.gmail.com>

On 6/23/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> Hi Frank,
> 
> Thanks for the help. I'm almost there, but still have one problem. I can create
> a shapefile for points but get an error for polygon.

Xiaodong,

Doh!  I'm afraid I didn't read your original message carefully enough. 
I think you would have been better off with Perry's idea.   You could
still accomplish this using the csv driver and the .vrt file but you will
need to restructure your text file to use WKT format for the polygon.

eg. 

In VRT:
        <GeometryField encoding="WKT" field="wkt"/>

And your .csv file:
id, wkt
1, "POLYGON((-100 40, -90 40, -90 39, -100 39, -100 40))"

Sorry for misleading you before. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Thu Jun 23 12:41:17 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] hdf4 patch for modis 9 product to pick up geometry
	info...
In-Reply-To: <42B71333.7040507@comcast.net>
References: <931f8ea90506201146363ae6f2@mail.gmail.com>
	<42B71333.7040507@comcast.net>
Message-ID: <931f8ea905062309417e124613@mail.gmail.com>

On 6/20/05, David Burken <dburken@comcast.net> wrote:
> ps: Curious how your big tiff is doing???

Dave,

I'm happy to leave the HDF patch to Andrey.  With bugzilla
working again, that is good way to submit patches too. 

As for BigTIFF, I didn't get to that on my last vacation as
hoped.  I spent the time reverse engineering PCIDSK overviews.
I had a surprising hard time figuring out what I had done when
I implemented that PCI!  

I may take another run at BigTIFF when I spend a week with the
inlaws at the start of July.  But I don't have a great track record so
far of actually following through on such threats. :-)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Thu Jun 23 15:44:31 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: I wrote a gdal_merge.cpp
In-Reply-To: <50693587-6C8F-45C8-A248-4473BFCAD36A@earthbrowser.com>
References: <50693587-6C8F-45C8-A248-4473BFCAD36A@earthbrowser.com>
Message-ID: <931f8ea90506231244874f20b@mail.gmail.com>

On 6/23/05, Matthew Giger <mgiger@earthbrowser.com> wrote:
> I got tired of not having an easy command line option.  It includes
> most of the options (color palettes and nodata sections being the
> ones it doesn't handle yet).
> 
> Please feel free to include it in the distribution if you like.

Matt,

I am not planning to add this to the core distribution.  Part of the reason
that gdal_merge.py is in python is to encourge folks to see how they
can modify it themselves pretty easily.  But your version could be
helpful, so I am cc:ing this reply (with the attachment) to the mailing
list.

Thanks!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_merge.cpp
Type: application/octet-stream
Size: 9534 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050623/615b3036/gdal_merge.obj
From mpg at lizardtech.com  Thu Jun 23 15:59:10 2005
From: mpg at lizardtech.com (Michael P. Gerlek)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a  MrSID image (Peng Gao)
Message-ID: <C5B740D9CEC9284A84B767BBD1DAA8467F00E5@sea-srv-ms2.lizardtech.com>

Peng Gao wrote:

> GDAL returns a strange NoData value (-1.2197742815800439e-012)
> from one of my mrSID images. The image is 8-bit and has 3 bands.
>
> MrSIDRasterBand::MrSIDRasterBand( MrSIDDataset *poDS, int nBand )
> {
>   ...
>   dfNoDataValue = poDS->poNDPixel->getSampleValueFloat32( nBand - 1 );
>   ...

If this is 8-bit data, then we should be using getSampleValueUint8(),
not getSampleValueFloat32().

The "datatype" in those function name refers to the underlying datatype
of the sample, not the desried return type or such.  I think I even
documented that :-)

-mpg

-----------------------------------
Michael P. Gerlek
Software Architect / MrSID team
mpg@lizardtech.com
LizardTech, a Celartem company
Seattle, Washington
-----------------------------------

From jluis at ualg.pt  Thu Jun 23 17:35:38 2005
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <s2bae84d.079@syncera.nl>
References: <s2bae84d.079@syncera.nl>
Message-ID: <20050623223538.d0zmv9zq8kc8os4c@wmail.ualg.pt>

Quoting Bart van den Eijnden <BEN@Syncera-ITSolutions.NL>:

> Hi list,
>
> is it possible using GDAL to clip a raster using a polygon from eg a 
> shapefile and have all the rest turn into NODATA values? If it is 
> possible, how does it work?
>
> Thanks in advance.
>
> Best regards,
> Bart

Bart,
I don't know if there is a programaticaly way of doing it with gdal.
However, you can do it with my "Mirone" program.
Mirone doesn't know about shape files, but you can import simple ascii
files. If they are closed you are ofered the possibility to "Crop grid"
and to specify the outside polygon value (the NodataValue)

See
w3.ualg.pt/~jluis/mirone
but try instead (if you want, off course) the more updated versions at
ftp.ualg.pt/users/jluis/m_gmt/tmp


From rec at geodesign.com.br  Thu Jun 23 18:51:16 2005
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <20050623223538.d0zmv9zq8kc8os4c@wmail.ualg.pt>
References: <s2bae84d.079@syncera.nl>
	<20050623223538.d0zmv9zq8kc8os4c@wmail.ualg.pt>
Message-ID: <6.2.1.2.0.20050623194146.02957bd0@mailhost.geodesign.com.br>

Bart,

You can do this operation using the freely distributed gis/rs software 
called SPRING, which is available from INPE-Brasil.  The SPRING link is 
http://www.dpi.inpe.br/spring/index.html
You can load GeoTiff, Tiff w/ TFW, etc and shapefiles to SPRING.  There is 
a tool to do this under the Tools Menu.  Also, INPE has developed an open 
source GIS classes and functions library called Terralib that may have the 
tool available.  The link to Terralib is http://www.terralib.org/

Hope it helps.  Reinaldo

At 06:35 PM 6/23/2005, you wrote:
>Quoting Bart van den Eijnden <BEN@Syncera-ITSolutions.NL>:
>
>>Hi list,
>>
>>is it possible using GDAL to clip a raster using a polygon from eg a 
>>shapefile and have all the rest turn into NODATA values? If it is 
>>possible, how does it work?
>>
>>Thanks in advance.
>>
>>Best regards,
>>Bart
>
>Bart,
>I don't know if there is a programaticaly way of doing it with gdal.
>However, you can do it with my "Mirone" program.
>Mirone doesn't know about shape files, but you can import simple ascii
>files. If they are closed you are ofered the possibility to "Crop grid"
>and to specify the outside polygon value (the NodataValue)
>
>See
>w3.ualg.pt/~jluis/mirone
>but try instead (if you want, off course) the more updated versions at
>ftp.ualg.pt/users/jluis/m_gmt/tmp
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev

Reinaldo Escada Chohfi, Ph.D.
Diretor
GeoDesign Internacional

www.geodesign.com.br

E-mail: rec@geodesign.com.br

Tel./Fax: 0-XX-12-3153-5115 (Local)
       55-12-3153-5115 (Intl.)

Intelig?ncia e Tecnologia Espacial de Ponta

Urbanismo, Estudos Ambientais, Monitoriamento Ambiental,
Geoprocessamento, GIS, Processamento de Imagens Geogr?ficas,
Sensoriamento Remoto: Imagens de Sat?lites

Compress?o de Imagens e Documentos Escanerizados
Servidor de Conte?do - Integra??o de Sistemas

Revendedor Autorizado da LizardTech no Brasil

Vila Peralta, 42
12607-040 - Lorena - SP - Brasil

Informa??o confidencial. N?o retransmitir sem autoriza??o.
Copyright (c) 2005 GeoDesign Internacional
Todos os direitos reservados.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050623/fdc93508/attachment.html
From jluis at ualg.pt  Thu Jun 23 19:20:30 2005
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <s2bae84d.079@syncera.nl>
References: <s2bae84d.079@syncera.nl>
Message-ID: <20050624002030.pr7g13zysk40ssg8@wmail.ualg.pt>

Quoting Bart van den Eijnden <BEN@Syncera-ITSolutions.NL>:

> Hi list,
>
> is it possible using GDAL to clip a raster using a polygon from eg a 
> shapefile and have all the rest turn into NODATA values? If it is 
> possible, how does it work?
>
> Thanks in advance.

Bart,
Another option.
A non GIS, very functional (just load the grid and precess it model)
w3.ualg.pt/~jluis/mirone
(but you better use the versions at ftp.ualg.pt/users/jluis/m_gmt/tmp)

Example:
"Draw-> import line"        // import you polygon lline (ascii)
right click on the line and select "ROI crop grid"



From jluis at ualg.pt  Thu Jun 23 20:00:19 2005
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <s2bae84d.079@syncera.nl>
References: <s2bae84d.079@syncera.nl>
Message-ID: <42BB4D13.40308@ualg.pt>

Bart van den Eijnden wrote:

>Hi list,
>
>is it possible using GDAL to clip a raster using a polygon from eg a shapefile and have all the rest turn into NODATA values? If it is possible, how does it work?
>
>Thanks in advance.
>  
>
Bart,
You may also try this, non-GiS, non-project-first, reads most of grid 
types supported by gdal, very functional
w3.ualg.pt/~jluis/mirone
(but there are later versions at ftp.ualg.pt/users/jluis/m_gmt/tmp)

Example:
"Draw->Import line"      (your polygon as an ascii file)
right-click on the polygon and select "ROI crop grid"

From schuyler at nocat.net  Thu Jun 23 21:19:05 2005
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Will GDAL do other planets?
In-Reply-To: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
References: <b2f4021facc4564d1ff39c00a45d0049@mail.arc.nasa.gov>
Message-ID: <20050624011905.GC25077@vishnu.tridity.org>

* On 16-Jun-2005 at  3:43PM PDT, Mike Logan said:
> I haven't researched this yet - maybe this is already supported, but
>  I can think of some reasons to have GDAL load,query,reproject
>  MARS or other planetary data.    Not so much data formats (although
>  that would be nice) but rather geospecific support (radius, 
> eccentricity, etc).
> 
> Has anyone ever tackled this idea?    Or would it be
>  too much upheaval to the product?

We talk about it a little bit in Mapping Hacks -
http://mappinghacks.com/ ...  My sense is that PROJ.4 (and therefore
GDAL) will happily play along with any ellipsoid model you give it.
The only trick you may have to overcome is that longitude on Mars is
traditionally given in the range 0 to 360 degrees, versus the -180 to
180 standard here on Earth.

SDE

From ben at vterrain.org  Thu Jun 23 22:30:58 2005
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] FW: TIGER not lining up?
Message-ID: <20050624023104.270592664220@xserve.flids.com>

Frank,
I tried GDAL (OGR actually) on the Hawaiian TIGER2000 dataset, and it also
gets the Datum wrong (NAD83, not OHD).  Should be a quick fix?
Thanks,
Ben

> -----
> From: Global Mapper Support [mailto:support@globalmapper.com]
> Sent: Thursday, June 16, 2005 11:31 AM
> To: 'Ben Discoe'
> 
> I took a look and was able to reproduce your problem. As it turns out, 
> everything in the Tiger data is NAD83 with the exception of Hawaii. 
> The Tiger document actually says that they're not sure what datum the 
> data is in Hawaii, but selecting Old Hawaiian Mean produces good 
> results, so I switched the Tiger load to use Old Hawaiian Mean for 
> Hawaiian files.
> Let me know if you see any more problems.
> Thanks,
> 
> Mike
> Global Mapper Software LLC
> support@globalmapper.com
> 
> > -----
> > From: Ben Discoe [mailto:ben@vterrain.org]
> > Sent: Thursday, June 16, 2005 1:06 PM
> > To: 'Global Mapper Support'
> > Subject: TIGER not lining up?
> > 
> > I tried out some TIGER2000 data today for my area (big 
> > island of hawaii).  I grabbed it from the Census site:
> > http://www2.census.gov/geo/tiger/tiger2k/hi/tgr15001.zip
> > 
> > When i bring it into GM, it doesn't line up with any of the other 
> > data layers i'm using, in particular USGS DLG.


From jluis at ualg.pt  Fri Jun 24 09:05:43 2005
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] clipping raster using polygon?
In-Reply-To: <42BB4D13.40308@ualg.pt>
References: <s2bae84d.079@syncera.nl> <42BB4D13.40308@ualg.pt>
Message-ID: <42BC0527.3070006@ualg.pt>

Sorry for the multiple copies, but we are having troubles with our mail 
server and I never know when
the message was actualy sent.

J. Luis

From fwarmerdam at gmail.com  Fri Jun 24 11:44:44 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] FW: TIGER not lining up?
In-Reply-To: <20050624023104.270592664220@xserve.flids.com>
References: <20050624023104.270592664220@xserve.flids.com>
Message-ID: <931f8ea9050624084449e9a22c@mail.gmail.com>

On 6/23/05, Ben Discoe <ben@vterrain.org> wrote:
> Frank,
> I tried GDAL (OGR actually) on the Hawaiian TIGER2000 dataset, and it also
> gets the Datum wrong (NAD83, not OHD).  Should be a quick fix?

Ben,

I had no idea that there were non-NAD83 TIGER products!   Reading
section page 2 of chapter 5 of the 2002 TIGER/Line product manual 
I see that:

 In the 1995 and later TIGER/Line files, NAD83 is the coordinate datum
 used for the 48 contiguous states, the District of Columbia, Alaska, Puerto
 Rico, and the Virgin Islands of the United States. Regional datums are
 used for Hawaii and the Pacific Island Areas. NAD27 was the coordinate
 datum used for the 1994 and earlier versions of the TIGER/Line files
 except in Hawaii and the Pacific Island Areas where regional datums were
 used. Because the datum used was not relevant to the U.S. Census 
 Bureau's purposes for creating maps, the documentation did not record
 the specific datum of our source material for Hawaii and the Pacific Island 
 Areas.

So, it seems that the product doesn't internally document the datum but
that I could impute that OHD should be used if the STATE code is for
Hawaii.  Can you point me to a Hawaii file I could use for testing? 

Is OHD the "Old Hawaiian Datum" - EPSG code 4135?  This seems to
be the only specific Hawaiian datum listed in the EPSG 6.5 database. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jun 24 12:03:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
In-Reply-To: <C5B740D9CEC9284A84B767BBD1DAA8467F00E5@sea-srv-ms2.lizardtech.com>
References: <C5B740D9CEC9284A84B767BBD1DAA8467F00E5@sea-srv-ms2.lizardtech.com>
Message-ID: <931f8ea9050624090335278550@mail.gmail.com>

On 6/23/05, Michael P. Gerlek <mpg@lizardtech.com> wrote:
> Peng Gao wrote:
> 
> > GDAL returns a strange NoData value (-1.2197742815800439e-012)
> > from one of my mrSID images. The image is 8-bit and has 3 bands.
> >
> > MrSIDRasterBand::MrSIDRasterBand( MrSIDDataset *poDS, int nBand )
> > {
> >   ...
> >   dfNoDataValue = poDS->poNDPixel->getSampleValueFloat32( nBand - 1 );
> >   ...
> 
> If this is 8-bit data, then we should be using getSampleValueUint8(),
> not getSampleValueFloat32().
> 
> The "datatype" in those function name refers to the underlying datatype
> of the sample, not the desried return type or such.  I think I even
> documented that :-)

Michael,

Ah!  Thanks, I'll fix that.  This would certainly explain why Peng was
getting junk values. 

... I see Andrey has beat me to it.  Thank goodness for CVS reporting
via IRC. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pgao at esri.com  Fri Jun 24 13:30:04 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F4B@firewire.esri.com>

> > If this is 8-bit data, then we should be using
getSampleValueUint8(),

> > not getSampleValueFloat32().

> >

> > The "datatype" in those function name refers to the underlying
datatype

> > of the sample, not the desried return type or such.  I think I even

> > documented that :-)

> 

> Michael,

> 

> Ah!  Thanks, I'll fix that.  This would certainly explain why Peng was

> getting junk values.

> 

> ... I see Andrey has beat me to it.  Thank goodness for CVS reporting

> via IRC.

> 

 

I have a question about the interpretation of MrSID NoData value. 

Is a pixel considered NoData only if all three values match their

corresponding band NoData value, or Is a pixel considered NoData

if any band value matches band NoData value? For example, given

NoData values (0, 0, 0), Are only those pixels with value (0, 0, 0)

considered NoData, or (0, x, x), (0, 0, x), and etc considered

as NoData pixels as well?

 

Gao, Peng

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050624/1aa43537/attachment.html
From fwarmerdam at gmail.com  Fri Jun 24 13:56:57 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F4B@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F4B@firewire.esri.com>
Message-ID: <931f8ea905062410561223d0af@mail.gmail.com>

On 6/24/05, Peng Gao <pgao@esri.com> wrote:
> I have a question about the interpretation of MrSID NoData value. 
> Is a pixel considered NoData only if all three values match their 
> corresponding band NoData value, or Is a pixel considered NoData 
> if any band value matches band NoData value? For example, given 
> NoData values (0, 0, 0), Are only those pixels with value (0, 0, 0) 
> considered NoData, or (0, x, x), (0, 0, x), and etc considered 
> as NoData pixels as well? 

Peng,

In the GDAL data model, nodata is band specific.  So if band one
has a nodata value of 0, then that band is considered to be nodata
if the pixel value is zero.  A pixel might well be no data in some bands,
and not in others ... at least in theory.

I'm not sure if this is the normal interpretation in MrSID though. 

Best regards, 
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mpg at lizardtech.com  Fri Jun 24 14:42:58 2005
From: mpg at lizardtech.com (Michael P. Gerlek)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
Message-ID: <C5B740D9CEC9284A84B767BBD1DAA8467F00F0@sea-srv-ms2.lizardtech.com>

Frank, Peng:

In the MrSID SDK, we are not band-specific -- that is, a pixel is considered nodata iff all bands match the given values.

-mpg


-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent: Friday, June 24, 2005 10:57 AM
To: Peng Gao
Cc: Michael P. Gerlek; gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] RE: Strange NoData value from a MrSID image
(Peng Gao)


On 6/24/05, Peng Gao <pgao@esri.com> wrote:
> I have a question about the interpretation of MrSID NoData value. 
> Is a pixel considered NoData only if all three values match their 
> corresponding band NoData value, or Is a pixel considered NoData 
> if any band value matches band NoData value? For example, given 
> NoData values (0, 0, 0), Are only those pixels with value (0, 0, 0) 
> considered NoData, or (0, x, x), (0, 0, x), and etc considered 
> as NoData pixels as well? 

Peng,

In the GDAL data model, nodata is band specific.  So if band one
has a nodata value of 0, then that band is considered to be nodata
if the pixel value is zero.  A pixel might well be no data in some bands,
and not in others ... at least in theory.

I'm not sure if this is the normal interpretation in MrSID though. 

Best regards, 
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From carueda at ucdavis.edu  Fri Jun 24 16:31:24 2005
From: carueda at ucdavis.edu (Carlos A. Rueda)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: clipping raster using polygon?
In-Reply-To: <s2bae84d.079@syncera.nl>
References: <s2bae84d.079@syncera.nl>
Message-ID: <42BC6D9C.8060905@ucdavis.edu>

Bart,

I think you will find StarSpan (a tool based on GDAL/OGR/GEOS) very 
useful for this operation:  http://starspan.casil.ucdavis.edu

carlos


Bart van den Eijnden wrote:
> Hi list,
> 
> is it possible using GDAL to clip a raster using a polygon from eg a shapefile and have all the rest turn into NODATA values? If it is possible, how does it work?
> 
> Thanks in advance.
> 
> Best regards,
> Bart
> 
> Bart van den Eijnden
> Syncera IT Solutions
> Postbus 270
> 2600 AG  DELFT
> 
> tel.nr.: 015-7512436
> email: BEN@Syncera-ITSolutions.nl


From fwarmerdam at gmail.com  Sat Jun 25 16:14:17 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: a bug in OGRCoordinateTransformation
In-Reply-To: <BBA794F6A91A3342803DF8C71D6180CB0A50F6@thuja>
References: <BBA794F6A91A3342803DF8C71D6180CB0A50F6@thuja>
Message-ID: <931f8ea90506251314529aa1b6@mail.gmail.com>

On 6/24/05, Yang, Zhiqiang <zhiqiang.yang@oregonstate.edu> wrote:
>  
> Hi, 
>   
> I am trying to do some transformation with OGRCoordinateTransformation, but
> the results do not seem correct when compared with result from Erdas Imagine
> 8.7. Here is the details. 
>   
> Source projection is 
> 'PROJCS["UTM Zone 10, Northern
> Hemisphere",GEOGCS["WGS_1984",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.2572235630016],TOWGS84[0,0,0,0,0,0,0]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-123],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["meters",1]]'
>  
> Target projection is 
> `PROJCS["Lambert Azimuthal
> Equal-area",GEOGCS["Undefined",DATUM["Undefined",SPHEROID["Sphere
> of Radius
> 6370997m",6370997,0]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Lambert_Azimuthal_Equal_Area"],PARAMETER["latitude_of_center",45],PARAMETER["longitude_of_center",-100],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["meters",1]]'
>  
> Coordinate to test: (360055.5, 5132807.5) 
> Results from OGRCoordinateTransformation: (-1874278.666369, 420070.981388) 
> Results from Imagine: (-1870537.414966, 439891.156463) 
>   
> The difference between the two results is so big that
> OGRCoordinateTransformation more likely to have bug in it. 

Yang,

The src coordinate system is internally converted to the PROJ.4 
representation:

   +proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs

The target coordinate system is converted to:

   +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997
+b=6370997 +units=m +no_defs

The most likely complication here is that the target coordinate system has
a very different earth model.  Currently, by default, OGR (and PROJ.4)
will attempt to translate between earth models accurately.    That is,
the lat/long coordinate in on the WGS84 ellipsoid is converted into an
x/y/z geocentric location, and then this is converted into a lat/long/height
on the spherical earth model. 

This results in a big latitude shift (and a substantial elevation change).
However, in my experience, when people work with spherical earth
models, they generally do not want the lat/long location converted via
geocentric location.  They would instead prefer the lat/long be used without
adjustment on the sphere. 

Well I thought I would be able to demonstrate that this is what was going on
in this case, but I don't seem to be able to get a matching result!  The
intermediate steps are:

1) Convert from source UTM coordinates to WGS84.

warmerda@gdal2200[27]% testepsg -t src.wkt WGS84 360055.5 5132807.5
(360055.500000,5132807.500000) -> (-124.818312,46.334384)

2) Convert this lat/long to output LAEA projected coordinates, just
taking the lat/long location directly on the sphere.

warmerda@gdal2200[28]% testepsg -t '+proj=latlong +a=6370997
+b=6370997 +no_defs' dst.wkt -124.818312 46.334384
(-124.818312,46.334384) -> (-1867682.518646,440660.120598)

But these results are not particularly close to the results from Imagine
either!  

I think to better establish why there is a difference you will need to 
do your imagine transformation in steps so we can see what step
differs.  

1) convert utm to wgs84 and compare. 
2) convert wgs84 to sphere and compare. 
3) convert spherical lat/long to LAEA and compare. 

PS. Are you really using the WKT directly with Imagine or 
converting it via some mechanism?  Perhaps this translation is
not working well? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From wlx at mygis.org  Sun Jun 26 03:54:25 2005
From: wlx at mygis.org (Liangxu Wang)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] is gdal support integrized sinusoidal projection which
	used by some MODIS product?
Message-ID: <1119772465.11003.6.camel@localhost.localdomain>

Hi,
   I have looked the proj supported projection list, and known that
sinusoidal projection are supported by proj, but the integrized
sinusoidal projection are not mentioned in the list, which are used by
some MODIS product, so if integrized sinusoidal projection are supported
by GDAL?
   Best wishes.

Sincerely yours,
Liangxu Wang


From dron at ak4719.spb.edu  Sun Jun 26 08:15:11 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] is gdal support integrized sinusoidal projection which
	used by some MODIS product?
In-Reply-To: <1119772465.11003.6.camel@localhost.localdomain>
References: <1119772465.11003.6.camel@localhost.localdomain>
Message-ID: <20050626121511.GA26021@ak4719.spb.edu>

On Sun, Jun 26, 2005 at 03:54:25PM +0800, Liangxu Wang wrote:
> I have looked the proj supported projection list, and known that
> sinusoidal projection are supported by proj, but the integrized
> sinusoidal projection are not mentioned in the list, which are used by
> some MODIS product, so if integrized sinusoidal projection are
> supported by GDAL?

GDAL works with projections via the PROJ.4 library, so the integerized
sinusoidal projection is not supported in the GDAL.

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From thare at usgs.gov  Mon Jun 27 04:00:31 2005
From: thare at usgs.gov (Trent M Hare)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Trent M Hare/GD/USGS/DOI is out of the office.
Message-ID: <OF0CE626DB.F1CCEDA3-ON0725702D.002BFE59-0725702D.002BFE59@usgs.gov>

I will be out of the office starting  06/24/2005 and will not return until
07/05/2005.

I will not have email access on the road so I may have wait until July 5th
to catch up.


From avdimisglobal at yahoo.co.uk  Mon Jun 27 10:57:37 2005
From: avdimisglobal at yahoo.co.uk (avdimisglobal@yahoo.co.uk)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Converting S-57 to GML and then parsing the GML document
Message-ID: <!~!UENERkVCMDkAAQACAAAAAAAAAAAAAAAAABgAAAAAAAAAxevMM82Q/E2sjvhYQ/oJTMKAAAAQAAAAHRuQiUTCukiP0x8j65tmDwEAAAAA@fastworx.com>

Hi Guys (and Girls)

I have several S-57 ENC charts. I have converted one of them to GML using:

ogr2ogr ?f ?GML? test.gml test.000

The result is a 6 MB file containing features, which I presume to be
correct.

I then parsed this GML and drew all the features to a PNG file. This is
where the problem comes in. It seems that some of the coordinates in the GML
document is incorrect. Some of the coordinates are not inside the area
defined by:

  <gml:boundedBy>
    <gml:Box>
      <gml:coord><gml:X>-180</gml:X><gml:Y>15</gml:Y></gml:coord>
      <gml:coord><gml:X>-116.5</gml:X><gml:Y>71.5</gml:Y></gml:coord>
    </gml:Box>
  </gml:boundedBy>

Also I don't know in what projection this is. I presume this to be WGS84 as
the result I get when ignoring some coordinates and removing everything like
Aids to Navigations etc look similar to what the original S-57 ENC looked
like.

It seems that all the points are fine. The problem comes in with the lines
and polygons. 

In this feature:

  <gml:featureMember>
    <Line fid="0">
      <RCID>57</RCID>
      <PRIM>2</PRIM>
      <GRUP>2</GRUP>
      <OBJL>30</OBJL>
      <RVER>1</RVER>
      <AGEN>550</AGEN>
      <FIDN>134252534</FIDN>
      <FIDS>2478</FIDS>
      <LNAM>0226080087F609AE</LNAM>
 
<ogr:geometryProperty><gml:LineString><gml:coordinates>-139.299815,69.518647
-139.382691,69.53233400000001 -139.422843,69.53669100000001
-139.483763,69.53959500000001 -139.541914,69.53814300000001
-139.573759,69.53862700000001 -139.595911,69.54298300000001
-139.620833,69.551692 -139.645755,69.558463 -139.681753,69.562331
-139.719135,69.566682 -139.753749,69.575864 -139.804977,69.584559
-139.840975,69.58842300000001 -139.871435,69.59035400000001
-139.904664,69.596148 -139.946201,69.602904 -139.998723,69.608375
-140.027889,69.606765 -140.149729,69.599526 -140.227263,69.596148
-140.329719,69.59035400000001 -140.398947,69.58794
-140.432175,69.58890599999999 -140.490094,69.59194100000001
-140.578705,69.596769 -140.6867,69.606421
-140.809924,69.619444</gml:coordinates></gml:LineString></ogr:geometryProper
ty>
    </Line>
  </gml:featureMember>

I would draw a line between point 1 & 2 and then between 2 & 3. Some of the
coordinates are out of the box. If I ignore them everything looks fine. If I
use them, I have lines all over the place.

I have a similar problem with the polygons.

I'm using PHP to do it all, and had problems with the line being too long. I
then added a check to drop all coordinates that does not have at least a
lat/long. Some points have a third parameter - I presume this to be the Z
value but am not quite sure what it is for.

It would be greatly appreciated if someone could shed a bit of light on the
subject and help me out. I can provide the S-57 ENC and the GML (both are in
the region of 6MB). I also have a screenshot of the S-57 chart and my own
attempt in PNG format. They look similar but we specifically want the
traffic separation schemes and buoys on the charts and also indicating sea,
deep water, rivers and bridges. 

One other thing - When viewing the original S-57 ENC it shows the names of
cities, ports buildings etc. In the GML this is nowhere to be found. Is
there a specific reason for this?

Regards

Albert

-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.
Version: 7.0.323 / Virus Database: 267.8.2/29 - Release Date: 2005/06/27
 



-- 
No virus found in this outgoing message.
Checked by AVG Anti-Virus.
Version: 7.0.323 / Virus Database: 267.8.2/29 - Release Date: 2005/06/27


From fwarmerdam at gmail.com  Mon Jun 27 11:34:28 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Converting S-57 to GML and then parsing the GML
	document
In-Reply-To: <!~!UENERkVCMDkAAQACAAAAAAAAAAAAAAAAABgAAAAAAAAAxevMM82Q/E2sjvhYQ/oJTMKAAAAQAAAAHRuQiUTCukiP0x8j65tmDwEAAAAA@fastworx.com>
References: <!~!UENERkVCMDkAAQACAAAAAAAAAAAAAAAAABgAAAAAAAAAxevMM82Q/E2sjvhYQ/oJTMKAAAAQAAAAHRuQiUTCukiP0x8j65tmDwEAAAAA@fastworx.com>
Message-ID: <931f8ea905062708345e41aa5c@mail.gmail.com>

On 6/27/05, avdimisglobal@yahoo.co.uk <avdimisglobal@yahoo.co.uk> wrote:
> Hi Guys (and Girls)
> 
> I have several S-57 ENC charts. I have converted one of them to GML using:
> 
> ogr2ogr ?f "GML" test.gml test.000
> 
> The result is a 6 MB file containing features, which I presume to be
> correct.
> 
> I then parsed this GML and drew all the features to a PNG file. This is
> where the problem comes in. It seems that some of the coordinates in the GML
> document is incorrect. Some of the coordinates are not inside the area
> defined by:
> 
>   <gml:boundedBy>
>     <gml:Box>
>       <gml:coord><gml:X>-180</gml:X><gml:Y>15</gml:Y></gml:coord>
>       <gml:coord><gml:X>-116.5</gml:X><gml:Y>71.5</gml:Y></gml:coord>
>     </gml:Box>
>   </gml:boundedBy>
> 
> Also I don't know in what projection this is. I presume this to be WGS84 as
> the result I get when ignoring some coordinates and removing everything like
> Aids to Navigations etc look similar to what the original S-57 ENC looked
> like.
> 
> It seems that all the points are fine. The problem comes in with the lines
> and polygons.
> 
> In this feature:
> 
>   <gml:featureMember>
>     <Line fid="0">
>       <RCID>57</RCID>
>       <PRIM>2</PRIM>
>       <GRUP>2</GRUP>
>       <OBJL>30</OBJL>
>       <RVER>1</RVER>
>       <AGEN>550</AGEN>
>       <FIDN>134252534</FIDN>
>       <FIDS>2478</FIDS>
>       <LNAM>0226080087F609AE</LNAM>
> 
> <ogr:geometryProperty><gml:LineString><gml:coordinates>-139.299815,69.518647
> -139.382691,69.53233400000001 -139.422843,69.53669100000001
> -139.483763,69.53959500000001 -139.541914,69.53814300000001
> -139.573759,69.53862700000001 -139.595911,69.54298300000001
> -139.620833,69.551692 -139.645755,69.558463 -139.681753,69.562331
> -139.719135,69.566682 -139.753749,69.575864 -139.804977,69.584559
> -139.840975,69.58842300000001 -139.871435,69.59035400000001
> -139.904664,69.596148 -139.946201,69.602904 -139.998723,69.608375
> -140.027889,69.606765 -140.149729,69.599526 -140.227263,69.596148
> -140.329719,69.59035400000001 -140.398947,69.58794
> -140.432175,69.58890599999999 -140.490094,69.59194100000001
> -140.578705,69.596769 -140.6867,69.606421
> -140.809924,69.619444</gml:coordinates></gml:LineString></ogr:geometryProper
> ty>
>     </Line>
>   </gml:featureMember>
> 
> I would draw a line between point 1 & 2 and then between 2 & 3. Some of the
> coordinates are out of the box. If I ignore them everything looks fine. If I
> use them, I have lines all over the place.

Albert, 

I looked through the LineString above and don't see any
coordinates that appear to be outside the bounds.  Perhaps
you could be more specific about what vertices you think are in
error. 

> I have a similar problem with the polygons.
> 
> I'm using PHP to do it all, and had problems with the line being too long. I
> then added a check to drop all coordinates that does not have at least a
> lat/long. Some points have a third parameter - I presume this to be the Z
> value but am not quite sure what it is for.

Where I have non-zero elevation values I include them in the GML output. 
I think this would only occur for SOUNDG and DEPARE features. 

> It would be greatly appreciated if someone could shed a bit of light on the
> subject and help me out. I can provide the S-57 ENC and the GML (both are in
> the region of 6MB). I also have a screenshot of the S-57 chart and my own
> attempt in PNG format. They look similar but we specifically want the
> traffic separation schemes and buoys on the charts and also indicating sea,
> deep water, rivers and bridges.
> 
> One other thing - When viewing the original S-57 ENC it shows the names of
> cities, ports buildings etc. In the GML this is nowhere to be found. Is
> there a specific reason for this?

The S-57 reader has two modes of operation.  The simple mode is
what you are getting.  If you set things up so that OGR can find
the S-57 object class .csv files then you will get back features in
particular object classes (ie. SOUNDG, LNDARE, etc) with a variety
of object class specific attributes.  

Generally this is accomplished by defining the GDAL_DATA
environment variable to point to the gdal\data directory (where
files such as s57objectclasses.csv are found). 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From werchowyna at epf.pl  Mon Jun 27 17:04:19 2005
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] cannot build dal-grass plugin
Message-ID: <00ec01c57b5c$20a29220$b0e41d3e@eustahiush>

Hi Folks

I've been succesfully building and using gdal --with-grass so far. Now I
want to try it in a plugin instead to save me some re-compiling but either
dumb or blind, I can't make it work. ./configure is ok by make fails.

Here's how it goes. Please somebody help.

Example based on gdal-cvs-2005.05.31 because at hand now, but I have this 
problem with the fresh cvs as well.

[pingwin@localhost pkg]$ cd /src/gdal-cvs-2005.05.31/frmts/grass/pkg

[pingwin@localhost pkg]$
./configure --with-gdal=/usr/local/bin/gdal-config --with-grass=/usr/local/grass-6.1.cvs
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for g++... g++
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
checking for ranlib... ranlib
checking for g++ -shared ... yes
user supplied gdal-config (/usr/local/bin/gdal-config)
using /usr/local/lib as GDAL shared library autoload directory
checking for G_asprintf in -lgrass_gis... yes
configure: creating ./config.status
config.status: creating Makefile

[pingwin@localhost pkg]$ make
make: *** No rules for making object `grass57dataset.o', required by
`gdal_GRASS.so'. Stop.



Anything wrong with my /etc/ld.so.conf ? :

include ld.so.conf.d/*.conf
/usr/X11R6/lib
/usr/lib/qt3/lib
/usr/local/lib
//usr/lib/python2.3/site-packages
//usr/local/lib
/usr/local/grass-6.1.cvs/lib
/usr/lib/wine
//usr/local/lib/qgis

Maciek


From pfcsergioliminiana at yahoo.es  Mon Jun 27 18:38:29 2005
From: pfcsergioliminiana at yahoo.es (Sergio Liminiana Bernat)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] visual c++
Message-ID: <20050627223829.60017.qmail@web25608.mail.ukl.yahoo.com>

In my first progamme in visual Studio c++ 6.0 and GDAL
I have problems when I try to rebuild all. It's a
simple code, only  for exemple. I build GDAL like
"Building GDAL From Source" says changing nmake.opt
file. Can you help me??



#include <gdal_priv.h>

int main()
{
    GDALDataset  *poDataset;

    GDALAllRegister();

     if( poDataset == NULL )
    {
       }
	 return 0;
}


prueba.obj : error LNK2001: unresolved external symbol
_GDALAllRegister
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual enum CPLErr __thiscall
GDALMajorObject::SetMetadataItem(char const *,char
const *,char const *)"
(?SetMetadataItem@GDALMajorObject@@UAE?AW4CPLErr@@PBD00@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual char const * __thiscall
GDALMajorObject::GetMetadataItem(char const *,char
const *)"
(?GetMetadataItem@GDALMajorObject@@UAEPBDPBD0@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual enum CPLErr __thiscall
GDALMajorObject::SetMetadata(char * *,char const *)"
(?SetMetadata@GDALMajorObject@@UAE?AW4CPLErr@@PAPADPBD@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual char * * __thiscall
GDALMajorObject::GetMetadata(char const *)"
(?GetMetadata@GDALMajorObject@@UAEPAPADPBD@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual void __thiscall
GDALMajorObject::SetDescription(char const *)"
(?SetDescription@GDALMajorObject@@UAEXPBD@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual char const * __thiscall
GDALMajorObject::GetDescription(void)const "
(?GetDescription@GDALMajorObject@@UBEPBDXZ)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual __thiscall
GDALMajorObject::~GDALMajorObject(void)"
(??1GDALMajorObject@@UAE@XZ)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual enum CPLErr __thiscall
GDALDataset::AdviseRead(int,int,int,int,int,int,enum
GDALDataType,int,int *,char * *)"
(?AdviseRead@GDALDataset@@UAE?AW4CPLErr@@HHHHHHW4GDALDataType@@HPAH
PAPAD@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual enum CPLErr __thiscall
GDALDataset::SetGCPs(int,struct GDAL_GCP const *,char
const *)"
(?SetGCPs@GDALDataset@@UAE?AW4CPLErr@@HPBUGDAL_GCP@@PBD@Z)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual struct GDAL_GCP const * __thiscall
GDALDataset::GetGCPs(void)"
(?GetGCPs@GDALDataset@@UAEPBUGDAL_GCP@@XZ)
prueba.obj : error LNK2001: unresolved external symbol
"public: virtual char const * __thiscall
GDALDataset::GetGCPProjection(void)" (?GetGCPProjection@GDALDataset@@UAEPBDXZ)


		
______________________________________________ 
Renovamos el Correo Yahoo! 
Nuevos servicios, m?s seguridad 
http://correo.yahoo.es

From fwarmerdam at gmail.com  Tue Jun 28 10:33:01 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] visual c++
In-Reply-To: <20050627223829.60017.qmail@web25608.mail.ukl.yahoo.com>
References: <20050627223829.60017.qmail@web25608.mail.ukl.yahoo.com>
Message-ID: <931f8ea9050628073356439c73@mail.gmail.com>

On 6/27/05, Sergio Liminiana Bernat <pfcsergioliminiana@yahoo.es> wrote:
> In my first progamme in visual Studio c++ 6.0 and GDAL
> I have problems when I try to rebuild all. It's a
> simple code, only  for exemple. I build GDAL like
> "Building GDAL From Source" says changing nmake.opt
> file. Can you help me??
> 
> 
> 
> #include <gdal_priv.h>
> 
> int main()
> {
>     GDALDataset  *poDataset;
> 
>     GDALAllRegister();
> 
>      if( poDataset == NULL )
>     {
>        }
>          return 0;
> }
> 
> 
> prueba.obj : error LNK2001: unresolved external symbol
> _GDALAllRegister
> prueba.obj : error LNK2001: unresolved external symbol
> "public: virtual enum CPLErr __thiscall
> GDALMajorObject::SetMetadataItem(char const *,char
> const *,char const *)"

Sergio, 

It looks like you are not linking in gdal_i.lib. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jun 28 12:12:19 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: [UMN_MAPSERVER-DEV] MapServer and ECW
In-Reply-To: <42C170F7.5030200@dmsolutions.ca>
References: <42C170F7.5030200@dmsolutions.ca>
Message-ID: <931f8ea905062809121fdc182b@mail.gmail.com>

On 6/28/05, Daniel Morissette <dmorissette@dmsolutions.ca> wrote:
> This question is probably more for Frank, but I am interested in
> feedback from anyone else who has played with MapServer and ECW on Linux
> already...
> 
> We've just gone through a painful experience trying to get MapServer to
> work with MrSid files via GDAL on Linux a few weeks ago. Initially we
> suspected corrupted data files because some of them worked and some
> didn't, but it turned out that there were some recent fixes in the GDAL
> CVS that we didn't have. Rebuilding with the latest GDAL from CVS did
> the trick.
> 
> Now that ER-Mapper has modified its license to allow use of the ECW SDK
> with open source server software such as MapServer, we need to get
> Mapserver working with ECW on one of our client's servers. However,
> before we go through the same experience as for MrSid, I'd like to know
> if anyone else has tested/used MapServer with ECW files on Linux? Are
> there specific requirements (GDAL version, DSDK version, etc.)? Anything
> else we should know about?

Daniel, 

There are definately "challenges" with using ECW though they are all
quite overcomable.  

On Linux there have been ongoing issues with the ECW SDK and 
threads handing as files are closed.  In a MapServer context this will
result in map renders not completing and the cgi hanging around
till killed due to timeouts.  Bill Binko has some patches that are helpful.
I applied his patches to the ECW SDK 3.2beta1 and was able to get
things working reliably. 

Building the ECW SDK from source (the only approach available on Linux)
can be quite challenging.  ERMapper provides two approaches to building
in the 3.2beta.  I found it easiest to build by doing:

  cd Sources/NCSBuildQmake
  make -f Makefile-linux-shared

Then manually installing stuff:

  mv ../../lib /usr/local/lib
  cp ../include/* /usr/local/include

One quirk of the ECW SDK is that the include files depend on external
macros setting various platform specific flags.  Rather than hack GDAL to
include different variations of these for each platform, I have taken the 
approach of hacking the ECW SDK include files to define them.  I create
a file called NCSDefines.h and modify their existing NCSTypes.h to include
it.  I put the following in NCSDefines.h for Linux:

#ifndef LINUX
#define LINUX
#define POSIX
#define UNICODE
#define _LARGEFILE_SOURCE
#define _LARGEFILE64_SOURCE
#define _FILE_OFFSET_BITS 64 
#define _GNU_SOURCE
#define LIBECWJ2
#endif

One problem with the "qmake" derived makefiles for the ECW SDK is that
they produce a different library name than was produced by earlier versions
of the SDK.  I just manually hack GDALmake.opt to refer to this library 
(-lecwj2) instead of the old library name (-lNCSEcw).  

If you use the 3.2beta build of the ECW SDK you will also need to 
use the latest version of GDAL from CVS.  I added some initialization
needed by 3.2beta in GDAL just a few days ago.  

Another approach would be to try and use the ECW SDK 3.1 RC2
with Bill Binko's changes.  It uses a different build mechanism though,
which I found somewhat tricky.  It should work with GDAL 1.2.6 out of
the box. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bill at binko.net  Tue Jun 28 15:28:19 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: [UMN_MAPSERVER-DEV] MapServer and ECW
In-Reply-To: <931f8ea905062809121fdc182b@mail.gmail.com>
References: <42C170F7.5030200@dmsolutions.ca>
	<931f8ea905062809121fdc182b@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0506281512400.32136@fastcat.binko.net>

On Tue, 28 Jun 2005, Frank Warmerdam wrote:

> On 6/28/05, Daniel Morissette <dmorissette@dmsolutions.ca> wrote:
> > This question is probably more for Frank, but I am interested in
> > feedback from anyone else who has played with MapServer and ECW on Linux
> > already...
> > 

I have seemed to taken on this yoke recently :)  (I got 16GB of compressed 
ECW DOQQs for $40, and suddenly, I cared about making it work.)

> > Now that ER-Mapper has modified its license to allow use of the ECW SDK
> > with open source server software such as MapServer, we need to get
> > Mapserver working with ECW on one of our client's servers. However,
> > before we go through the same experience as for MrSid, I'd like to know
> > if anyone else has tested/used MapServer with ECW files on Linux? Are
> > there specific requirements (GDAL version, DSDK version, etc.)? Anything
> > else we should know about?

If you have the option, I would wait until the next release of the SDK 
from ERMapper -- even the next Beta.  Tom Lynch (who has been a very good 
resource) says that the next version should have my fixes and may (MAY) 
have a autoconf-based (or at least better) build.

If you want to get started right away, I have had luck with GDAL 1.2.6 and 
the 3.1 release of the SDK -- if you apply my patch.  My patch is fairly 
simple: there is an uninitialized boolean member on one of their classes.  
If it's built with -g, it gets zeroed and works, if it's compiled with -O, 
it doesn't and it's random as to whether or not the program (or mapscript 
call) will ever return.

Here's a forum at ERMapper that is worth following (it also has my patch):

http://forums.ermapper.com/viewtopic.php?t=486&highlight=

Frank has made 3.2beta work with GDAL CVS Head (as he mentioned).  Here's 
a note on ermapper.com that helps there;

http://forums.ermapper.com/viewtopic.php?t=680&highlight=

>From what Frank says, I should be able to use gdal_merge.py with the CVS 
HEAD which has had some issues with 3.1.  However, I've been working on 
some PostGIS performance issues with strk and have put it off.  That needs 
to change.

Along the way, I ended up writting a small utility that lets you edit the 
headers of ECW files (adding Projections, etc.).  I have released that GPL 
and have given Tom the rights to ship it under their choice of license as 
well, so hopefully that will be a positive outcome of some of the pain.

I hope this helps.

Bill

PS: Tom, that beta3 would be great :)

From dmorissette at dmsolutions.ca  Tue Jun 28 15:31:02 2005
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: [UMN_MAPSERVER-DEV] MapServer and ECW
In-Reply-To: <Pine.LNX.4.58.0506281512400.32136@fastcat.binko.net>
References: <42C170F7.5030200@dmsolutions.ca>	<931f8ea905062809121fdc182b@mail.gmail.com>
	<Pine.LNX.4.58.0506281512400.32136@fastcat.binko.net>
Message-ID: <42C1A576.8070202@dmsolutions.ca>

Thanks for the infos Bill. Almost sounds like we should wait for the 
next SDK release.

Bill Binko wrote:
> 
> PS: Tom, that beta3 would be great :)
> 

Question for Tom: any idea when beta3 with Bill's fixes would be 
available? That would help in deciding if we should wait or not.

Thanks

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From cfis at interserv.com  Mon Jun 27 12:17:24 2005
From: cfis at interserv.com (Charles F. I. Savage)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Next Generation SWIG - Ruby
Message-ID: <42C02694.70505@interserv.com>

I came across an interview from April where a "next generation" swig 
binding approach for gdal was mentioned (see 
http://community.qgis.org/index.php?option=com_content&task=view&id=58&Itemid=2). 


I was wondering how much progress has been made on this?  I'd be 
interested in using SWIG to develop Ruby bindings for GDAL/OGR.

Thanks for the help,

Charlie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2781 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050627/c27fa9ac/smime.bin
From cfis at interserv.com  Sun Jun 26 17:57:37 2005
From: cfis at interserv.com (Charles F. I. Savage)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Next Generation SWIG - Ruby
Message-ID: <42BF24D1.8020303@interserv.com>

I came across an interview from April where a "next generation" swig 
binding approach for gdal was mentioned (see 
http://community.qgis.org/index.php?option=com_content&task=view&id=58&Itemid=2). 


I was wondering how much progress has been made on this?  I'd be 
interested in using SWIG to develop Ruby bindings for GDAL/OGR.

Thanks for the help,

Charlie
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 2781 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050626/6c66a8cb/smime.bin
From tflynch at gmail.com  Tue Jun 28 20:27:22 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Re: [UMN_MAPSERVER-DEV] MapServer and ECW
In-Reply-To: <42C1A576.8070202@dmsolutions.ca>
References: <42C170F7.5030200@dmsolutions.ca>
	<931f8ea905062809121fdc182b@mail.gmail.com>
	<Pine.LNX.4.58.0506281512400.32136@fastcat.binko.net>
	<42C1A576.8070202@dmsolutions.ca>
Message-ID: <c39b2a650506281727344b1ce9@mail.gmail.com>

On 6/29/05, Daniel Morissette <dmorissette@dmsolutions.ca> wrote:
> Question for Tom: any idea when beta3 with Bill's fixes would be
> available? That would help in deciding if we should wait or not.

Sure.  I am partly through a test conversion of the build system to
rely on the GNU autotools (a frequent request at OSG).  Once that is
done, approved and given basic QC on Linux, Solaris and Mac OS X it
will be time for a new wrapup.  The Windows builds (VC6.0 .dsp files
and VC7.1 .vcproj files) will be left pretty much as is.

I have been pulled off SDK duties for a couple of weeks to work on
some other projects that have been given a higher priority over here,
but am still working away at it whenever possible.  I hope to have
something out in about a fortnight, so expect something in about a
month ... which will probably be called the ECW JPEG 2000 SDK 3.2 beta
2.
 
 -- 
 Tom Lynch
 Development, ER Mapper
 Phone:      +61 8 93882900
 Fax:        +61 8 93882901
 Email:      tom.lynch@ermapper.com
 Web:        http://www.ermapper.com
 Forums:     http://forum.ermapper.com

From craig.miller at spatialminds.com  Wed Jun 29 18:14:18 2005
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Determine table geometry type?
In-Reply-To: <931f8ea9050622080757a7aa6e@mail.gmail.com>
Message-ID: <ALEXANDRIACj1d4vJFR000000c3@ALEXANDRIA.spatialminds.local>

Frank,

I downloaded today's daily-cvs(June 29th) and the type of geometry stored in
a PostGIS table appears to still always be returned as wkbUnknown.  Is
anyone else seeing the same thing?

The June 27th daily-cvs failed under windows when I was building the pg
driver.  I didn't look to see what, if any, changes have been made since
then.

I am a busy for the next two weeks, and then on vacation for a week after
that.  When I get back, I'll take a look at the code and see if I can
determine what is going on.  In the meantime, I just wanted to communicate
what I'm observing.

Thanks,
--Craig
 

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Sent: Wednesday, June 22, 2005 8:07 AM
To: Craig Miller
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Determine table geometry type?

On 6/21/05, Craig Miller <craig.miller@spatialminds.com> wrote:
> 
> I'm trying to determine the type of geometry stored in a PostGIS  table
via
> OGR.  I am trying to do this by calling 
> 
> pogrLayer->GetLayerDefn()->GetGeomType(); 
> 
> In my code this always returns wkbUnknown for layers.  Is GeomType
supported for layers? 

Craig,

I see that Andrey Kiselev has committed changes to pick up the
geometry type (where easy) from the geometry_columns tables 
on May 5th, 2005.  You might want to try upgrading to a more
recent GDAL from CVS or verify that your
gdal/ogr/ogrsf_frmts/pg/ogrpgtablelayer.cpp has  revision 1.27.

Note, this change came originally from Oleg Semykin. 

I would add that GetGeomType() is the right way to ask a 
layer for it's geometry type.  But some drivers don't set this,
either through omission as was the case with the PostGIS driver,
or because the underlying format does not restrict the layer to one
geometry type. 

> Another options is to query the OGIS extension tables directly and parse
the
> results.  Is this the easiest/correct way of determining all spatial
tables?
> 
>   
> 
> "SELECT f_table_catalog AS catalog, f_table_schema as schema, f_table_name
> AS tablename, f_geometry_column as dgname FROM Geometry_Columns"; 


Well, this still doesn't return the geometry type.  The patch fetches
the "type" field from the geometry_columns tables to get the type.

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From pgao at esri.com  Thu Jun 30 11:00:29 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Turning off error message output
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F7A@firewire.esri.com>

On Unix, GDAL prints error messages to the console, in addition to
error return code. Is there a way to turn off the message printout?

Gao, Peng

From pgao at esri.com  Thu Jun 30 11:36:06 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F7B@firewire.esri.com>

> -----Original Message-----
> From: Michael P. Gerlek [mailto:mpg@lizardtech.com]
> Sent: Friday, June 24, 2005 11:43 AM
> To: warmerdam@pobox.com; Peng Gao
> Cc: gdal-dev@xserve.flids.com
> Subject: RE: [Gdal-dev] RE: Strange NoData value from a MrSID
> image (Peng Gao)
>
> Frank, Peng:
>
> In the MrSID SDK, we are not band-specific -- that is, a
> pixel is considered nodata iff all bands match the given values.
>
> -mpg
>
>
> -----Original Message-----
> From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
> Sent: Friday, June 24, 2005 10:57 AM
> To: Peng Gao
> Cc: Michael P. Gerlek; gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] RE: Strange NoData value from a MrSID
> image (Peng Gao)
>
>
> On 6/24/05, Peng Gao <pgao@esri.com> wrote:
> > I have a question about the interpretation of MrSID NoData value.
> > Is a pixel considered NoData only if all three values match their
> > corresponding band NoData value, or Is a pixel considered NoData if
> > any band value matches band NoData value? For example, given NoData
> > values (0, 0, 0), Are only those pixels with value (0, 0, 0)
> > considered NoData, or (0, x, x), (0, 0, x), and etc considered as
> > NoData pixels as well?
>
> Peng,
>
> In the GDAL data model, nodata is band specific.  So if band
> one has a nodata value of 0, then that band is considered to
> be nodata if the pixel value is zero.  A pixel might well be
> no data in some bands, and not in others ... at least in theory.
>
> I'm not sure if this is the normal interpretation in MrSID though.
>

I have a case where MrSID SDK reports NoData values (0, 0, 0) for
3 bands, and I have a MrSID image containing black text with value 
(0, 13, 14).  Since GDAL uses band specific NoData interpretation, 
the band 1 is nodata. My app considers a
multiband pixel NoData if any of the band is nodata. As the result,
the black text is displayed transparent.
I could ignore
MrSID NoData color at application level. But I can't handle the case
where the NoData values come from PAM.

One solution could be not using native MrSID NoData color as GDAL band
specific 
NoData value (because it's not), and adding a new call at Dataset level
to 
get NoData color for the entire dataset for apps that want to make 
use of the NoData color?

What do you think?

Gao, Peng

