From didier.richard at ign.fr  Wed Sep  1 10:34:20 2004
From: didier.richard at ign.fr (Richard didier)
Date: Wed Nov 21 11:49:22 2007
Subject: [Gdal-dev] Bypassing PROJ.4
Message-ID: <200409011634.20045.didier.richard@ign.fr>

Hi all,

I would like to use the GDAL utilities (mainly gdalwarp) but wouldn't like to 
use PROJ.4 library.

The issue is that we have algorithms for coordinates transformations. We have 
compared results from PROJ.4 and our library and we lost the initial 
coordinates resolution with PROJ.4. Further more, we use specific datum shift 
grids that are not compatible with the one (NAD83) plugged into PROJ.4.

I feel like several solutions can be used, but I'd like to have experts 
opinion. As far I can see, I feel like making a PROJ.4 wrapper to call our 
coordinates transformation library. Still, I have to pass our SRS ID to GDAL 
utilities (I then need to write some ogr_srs_ignrig.cpp files to do it).

Finally, we like to add a -rsi resampling option (sinus cardinal resampling, 
very slow, but really efficient for image geometry quality) to gdalwarp, but 
I don't know exactly where to add it in the source tree.

Thanks in advance for your advices,

didier
-- 
Didier RICHARD, chef de projet "Diffusion des donn?es num?riques" 
Institut Geographique National           tel: +33/0 1.43.98.83.23
2/4 Avenue Pasteur                       fax: +33/0 1.43.98.81.71
F-94165 St-Mande Cedex                e-mail: Didier.Richard@ign.fr


From warmerdam at pobox.com  Wed Sep  1 10:49:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Bypassing PROJ.4
In-Reply-To: <200409011634.20045.didier.richard@ign.fr>
References: <200409011634.20045.didier.richard@ign.fr>
Message-ID: <4135E185.4030308@pobox.com>

Richard didier wrote:
> Hi all,
> 
> I would like to use the GDAL utilities (mainly gdalwarp) but wouldn't like to 
> use PROJ.4 library.
> 
> The issue is that we have algorithms for coordinates transformations. We have 
> compared results from PROJ.4 and our library and we lost the initial 
> coordinates resolution with PROJ.4. Further more, we use specific datum shift 
> grids that are not compatible with the one (NAD83) plugged into PROJ.4.

Richard,

It would be interesting to be able to add support for IGN grids in PROJ.4
at some point.

> I feel like several solutions can be used, but I'd like to have experts 
> opinion. As far I can see, I feel like making a PROJ.4 wrapper to call our 
> coordinates transformation library. Still, I have to pass our SRS ID to GDAL 
> utilities (I then need to write some ogr_srs_ignrig.cpp files to do it).

I would suggest you look at gdal/ogr/ogrct.cpp.  Instead of trying to implement
a PROJ.4 compatible interface to your functions, it might be better to
write an OGRCoordinateTransformation implementation that calls into your
library.  If you look at ogrct.cpp you will see how a PROJ.4 based subclass
of the generic OGRCoordinateTransformation class is defined.  It should, in
theory, be pretty easy to implement an OGR_IGN_CT class as an alternative
for your use, and force OGRCreateCoordinateTransformation() to use that in
preference to the PROJ.4 classes (perhaps controlled by some switch).

This all assumes that you can adequately identify your coordinate systems
of interest in WKT.  I would assume the existing projection descriptions
would be fine, possibly with a particular authority and code being used
to describe your datum.

You could try and implement an ogr_srs_ignrig.cpp module to translate between
OGRSpatialRefernence format, and your own representation but it might just
be easier to do it within your OGR_IGN_CT class.

> Finally, we like to add a -rsi resampling option (sinus cardinal resampling, 
> very slow, but really efficient for image geometry quality) to gdalwarp, but 
> I don't know exactly where to add it in the source tree.

Look in gdal/alg/gdalwarpkernel.cpp.  The GWKGeneralCase() function is the
general purpose code called when no speical case exists for a particular
combination of pixel type and resampling kernel.  If you add your resampling
type here that should be the bulk of the work.

In particular where you see:
/* -------------------------------------------------------------------- */
/*      Collect the source value.                                       */
/* -------------------------------------------------------------------- */
                 if( poWK->eResample == GRA_NearestNeighbour )
                 {
                     GWKGetPixelValue( poWK, iBand, iSrcOffset, &dfDensity,
                                       &dfValueReal, &dfValueImag );
                 }
                 else if( poWK->eResample == GRA_Bilinear )
                 {
                     GWKBilinearResample( poWK, iBand,
                                          padfX[iDstX]-poWK->nSrcXOff,
                                          padfY[iDstX]-poWK->nSrcYOff,
                                          &dfDensity,
                                          &dfValueReal, &dfValueImag );
                 }
...

Add in a case for GRA_SinusCardinal and implement a function for it.  You can
use the other functions as an example.  I imagine the bilinear would be the
simplest case that demonstrates reading from multiple pixels to resample.

Also, there will be a few other places to touch.

  1) Near the beginning of GWKGeneralCase() there is logic to pick the resampling
     kernel size (used for windowing effects) ... make sure you update that.
  2) You will need to add your new resampling type in alg/gdal_warp.h.
  3) You will need to add commandline support in apps/gdalwarp.c

I may have missed a few other spots.  If you can implement this smoothly it
might be nice to incorporate back into the core version.  I presume the support
for your own coordinate system libraries would not be very useful in the
core version and would remain custom to your site.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Wed Sep  1 11:26:24 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to read a
	TIFF
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D118@caemsx03.cae.ca>

Hi,

I'm using gdal1.2.1 on Windows.
When I'm reading a tif file (for example the cramps-tile.tif file from the
libtiff test images), I got a crash on windows (VisualC++ 6.0) using
BoundChecker.
If I run the test in debug without Boundchecker or in release without
boundchecker, it works fine.

The code is simply :
	GDALAllRegister();
	GDALDataset* m_gdalDataSet = (GDALDataset *) GDALOpen(
"C:\\TestDB\\cramps-tile.tif", GA_ReadOnly ); //crash here
	GDALClose(m_gdalDataSet);

the error is reported to occur in tif_dirinfo.c line 292 :
static int
tagCompare(const void* a, const void* b)
{
	const TIFFFieldInfo* ta = *(const TIFFFieldInfo**) a;
	const TIFFFieldInfo* tb = *(const TIFFFieldInfo**) b;
	/* NB: be careful of return values for 16-bit platforms */
	if (ta->field_tag != tb->field_tag)
//crash here
		return (ta->field_tag < tb->field_tag ? -1 : 1);
	else
		return ((int)tb->field_type - (int)ta->field_type);
}

According to the debugger, ta is not valid (0xfbfbfbfb) but a is valid.
When I tried to make the cast in the debug window, I got (which seems to be
invalid) :
-	*(const TIFFFieldInfo**) a	{...}
	field_tag	4227595259
	field_readcount	-20968
	field_writecount	4134
	field_type	270970412
	field_bit	64764
	field_oktochange	252 '?'
	field_passcount	252 '?'
+	field_name	0x003601a9
"56HQp|~?S'(tm)Y?????J
LNP


!"#$%&'()*+,-./0123
456789:;<=Q



"

Can you help me with this problem ?

Thanks a lot in advance,

Stephane
http://www.exotk.org


From route at cae.com  Wed Sep  1 12:01:09 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] bug in the documentation ?
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D11A@caemsx03.cae.ca>

Hi,

according to the documentation
(http://www.remotesensing.org:16080/gdal/classGDALRasterBand.html#a10)

the test for the reading in the blocks is :
01  for( iYBlock = 0; iYBlock < nYBlocks; iYBlock++ )
02     {
03         for( iXBlock = 0; iXBlock < nXBlocks; iXBlock++ )
04         {
05             int        nXValid, nYValid;
06             poBand->ReadBlock( iXBlock, iYBlock, pabyData );
07             // Compute the portion of the block that is valid
08             // for partial edge blocks.
09             if( iXBlock * nXBlockSize > poBand->GetXSize())
10                 nXValid = poBand->GetXSize()- iXBlock * nXBlockSize;
11             else
12                 nXValid = nXBlockSize;
13             if( iYBlock * nYBlockSize > poBand->GetYSize() )
14                 nYValid = poBand->GetYSize()  - iYBlock * nYBlockSize;
15             else
16                 nYValid = nYBlockSize;
17             // Collect the histogram counts.
18             for( int iY = 0; iY < nXValid; iY++ )
19             {
20                 for( int iX = 0; iX < nXValid; iX++ )
21                 {
22                     panHistogram[pabyData[iX + iY * nXBlockSize]] += 1;
23                 }
24             }
25         }
26     }

should it not be :

09		   if( (iXBlock+1) * nXBlockSize > poBand->GetXSize())
//note the +1
10                 nXValid = poBand->GetXSize()- iXBlock * nXBlockSize;

and

13             if( (iYBlock+1) * nYBlockSize > poBand->GetYSize()) //note
the +1
14                 nYValid = poBand->GetYSize()  - iYBlock * nYBlockSize;

thanks,

Stephane

From Silke.Reimer at intevation.de  Wed Sep  1 12:45:13 2004
From: Silke.Reimer at intevation.de (Silke Reimer)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal Fedora Core 2 package
Message-ID: <20040901164513.GR16620@intevation.de>


Hallo!

Some weeks ago I announced some Fedora Core 2 packages, among them
gdal. I would like to inform you that they have now been registered
on the official fedora-site [1] and are undergoing a qualitiy
assurance by the Fedora QA-team. Especially gdal has already been
viewed by two people and I am currently working on a new package.
So hopefully gdal will be part of official Fedora Core releases in
the future. You can follow the progress on Fedora bugzilla (see the
list of links below). 

The package can be downloaded from our FTP-Site and its FreeGIS
mirror [2]. There are three subdirectories: SPEC, SRPMS, and RPMS.
They are containing Specfiles, source rpms and binary rpms
respectively. I would suggest to include the gdal.spec into CVS such
as we already did with the debian directory.

The gdal package is based on the shapelib and proj packages by David
M. Kaplan and Steve Arnold who did register their packages in
November and December 2003. Their status in Fedora can also be
viewed on Fedora bugzilla.

I set up a page which summarizes all the information about the
projects including the actual links to the packages.  This page is
located at our homepage [3].

Many greetings,

        Silke

Fedora status for some GIS related packages:

gdal: https://bugzilla.fedora.us/show_bug.cgi?id=1964 
shapelib: https://bugzilla.fedora.us/show_bug.cgi?id=937
proj: https://bugzilla.fedora.us/show_bug.cgi?id=920

[1] http://www.fedora.us
[2] http://ftp.gwdg.de/pub/misc/freegis/intevation/fedora/2/
[3] http://intevation.net/projects/fedora-gis.en.html

-- 
Silke Reimer

Intevation GmbH                      http://intevation.de/
FreeGIS                                http://freegis.org/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040901/d93f0971/attachment.bin
From Silke.Reimer at intevation.de  Wed Sep  1 12:54:08 2004
From: Silke.Reimer at intevation.de (Silke Reimer)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal debian package
Message-ID: <20040901165408.GS16620@intevation.de>


Hallo!

Writing the mail about the gdal Fedora pacakge I remembered that the
debian directory is still missing the update of some rather
substantial changes. I still have problems with my CVS access and
it would be nice if you, Frank, can have another look on it. 

Otherwise I would suggest to take the diff [1] and apply it to the CVS.
You will have to ensure though that it doesn't break anything that
has been done since the gdal 1.2.1 release.

BTW: By now gdal 1.2.1 is not yet slipped into debian sarge since it
hasn't been built on the arm architecture. I have been informed
though that the next freeze will not be done until all builds on arm
have been done. So version 1.2.1 will be into the next stable
release of debian (suuposed that it builds without failure on arm). 

I don't think that we will have grass support of gdal in debian
sarge though since I still wait for an appropriate grass package :-( 

Many greetings,

	Silke


[1]
http://http.us.debian.org/debian/pool/main/g/gdal/gdal_1.2.1-1.diff.gz

-- 
Silke Reimer

Intevation GmbH                      http://intevation.de/
FreeGIS                                http://freegis.org/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040901/f889ed61/attachment.bin
From dron at ak4719.spb.edu  Wed Sep  1 13:31:51 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to read
	a TIFF
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D118@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D118@caemsx03.cae.ca>
Message-ID: <20040901173151.GD8995@ak4719.spb.edu>

On Wed, Sep 01, 2004 at 11:26:24AM -0400, Stephane Routelous wrote:
> I'm using gdal1.2.1 on Windows.
> When I'm reading a tif file (for example the cramps-tile.tif file from the
> libtiff test images), I got a crash on windows (VisualC++ 6.0) using
> BoundChecker.
> If I run the test in debug without Boundchecker or in release without
> boundchecker, it works fine.
> 
> The code is simply :
> 	GDALAllRegister();
> 	GDALDataset* m_gdalDataSet = (GDALDataset *) GDALOpen(
> "C:\\TestDB\\cramps-tile.tif", GA_ReadOnly ); //crash here
> 	GDALClose(m_gdalDataSet);
> 
> the error is reported to occur in tif_dirinfo.c line 292 :

The first question is: what libtiff version do you use?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From route at cae.com  Wed Sep  1 14:10:01 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to 
	read a TIFF
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D11C@caemsx03.cae.ca>

here is the content of tiffvers.h :
#define TIFFLIB_VERSION_STR "LIBTIFF, Version 3.6.1\nCopyright (c) 1988-1996
Sam Leffler\nCopyright (c) 1991-1996 Silicon Graphics, Inc."
/*
 * This define can be used in code that requires
 * compilation-related definitions specific to a
 * version or versions of the library.  Runtime
 * version checking should be done based on the
 * string returned by TIFFGetVersion.
 */
#define TIFFLIB_VERSION 20031226


thx,

Stephane

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
Sent: Wednesday, September 01, 2004 1:32 PM
To: 'gdal-dev@remotesensing.org'
Subject: Re: [Gdal-dev] crash ( access violation ) in GDAL when trying
to read a TIFF


On Wed, Sep 01, 2004 at 11:26:24AM -0400, Stephane Routelous wrote:
> I'm using gdal1.2.1 on Windows.
> When I'm reading a tif file (for example the cramps-tile.tif file from the
> libtiff test images), I got a crash on windows (VisualC++ 6.0) using
> BoundChecker.
> If I run the test in debug without Boundchecker or in release without
> boundchecker, it works fine.
> 
> The code is simply :
> 	GDALAllRegister();
> 	GDALDataset* m_gdalDataSet = (GDALDataset *) GDALOpen(
> "C:\\TestDB\\cramps-tile.tif", GA_ReadOnly ); //crash here
> 	GDALClose(m_gdalDataSet);
> 
> the error is reported to occur in tif_dirinfo.c line 292 :

The first question is: what libtiff version do you use?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From sgillies at frii.com  Wed Sep  1 14:22:19 2004
From: sgillies at frii.com (Sean Gillies)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal Fedora Core 2 package
In-Reply-To: <20040901164513.GR16620@intevation.de>
References: <20040901164513.GR16620@intevation.de>
Message-ID: <DC236E64-FC43-11D8-8447-000D9329D732@frii.com>

On Sep 1, 2004, at 10:45 AM, Silke Reimer wrote:

>
> Hallo!
>
> ...

Hi Silke,

I tried out the FC2 RPM recently and found that it was requiring
the xerces-j (Java) RPM.  Shouldn't the requirement be on xerces-c?

I appreciate your efforts to get GDAL into FC2.  Thanks!

Sean

--
Sean Gillies
sgillies at frii dot com
http://users.frii.com/sgillies


From dron at ak4719.spb.edu  Wed Sep  1 14:59:41 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to read
	a TIFF
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D11C@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D11C@caemsx03.cae.ca>
Message-ID: <20040901185941.GC21118@ak4719.spb.edu>

On Wed, Sep 01, 2004 at 02:10:01PM -0400, Stephane Routelous wrote:
> here is the content of tiffvers.h :
> #define TIFFLIB_VERSION_STR "LIBTIFF, Version 3.6.1\nCopyright (c) 1988-1996
> Sam Leffler\nCopyright (c) 1991-1996 Silicon Graphics, Inc."
> /*
>  * This define can be used in code that requires
>  * compilation-related definitions specific to a
>  * version or versions of the library.  Runtime
>  * version checking should be done based on the
>  * string returned by TIFFGetVersion.
>  */
> #define TIFFLIB_VERSION 20031226

Ok. Could you try to buid GDAL with the recent libtiff from the CVS?
There are many bugs fixed since the 3.6.1 release and few importand
issues was cleaned up few days ago.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From warmerdam at pobox.com  Wed Sep  1 15:45:02 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal debian package
In-Reply-To: <20040901165408.GS16620@intevation.de>
References: <20040901165408.GS16620@intevation.de>
Message-ID: <413626BE.4000607@pobox.com>

Silke Reimer wrote:
> Hallo!
> 
> Writing the mail about the gdal Fedora pacakge I remembered that the
> debian directory is still missing the update of some rather
> substantial changes. I still have problems with my CVS access and
> it would be nice if you, Frank, can have another look on it. 
> 
> Otherwise I would suggest to take the diff [1] and apply it to the CVS.
> You will have to ensure though that it doesn't break anything that
> has been done since the gdal 1.2.1 release.

Silke,

I had a few problems and issues with the changes:

Why is this needed?

--- gdal-1.2.1.orig/GDALmake.opt.in
+++ gdal-1.2.1/GDALmake.opt.in
@@ -120,7 +120,7 @@
  #
  # HDF4 Support.
  #
-HDF4_INCLUDE  = @HDF4_INCLUDE@
+HDF4_INCLUDE  = @HDF4_INCLUDE@ -I$(GDAL_ROOT)/ogr

It seems that this would be used in gdal/frmts/hdf4/GNUmakefile where
the $(GDAL_INCLUDES) already includes -I$(GDAL_ROOT)/ogr.

I also don't really understand what the HDFEOSVersion.h changes were
supposed to do. I had trouble with auto-applying them so I tried to do
it by hand, but looking at it more closely it seems a comparable patch
may already have been applied.

I think I have applied the various other changes correctly (some by hand)
but you might want to check.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Wed Sep  1 15:57:53 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal debian package
In-Reply-To: <413626BE.4000607@pobox.com>
References: <20040901165408.GS16620@intevation.de> <413626BE.4000607@pobox.com>
Message-ID: <20040901195753.GA27972@ak4719.spb.edu>

On Wed, Sep 01, 2004 at 03:45:02PM -0400, Frank Warmerdam wrote:
> I also don't really understand what the HDFEOSVersion.h changes were
> supposed to do. I had trouble with auto-applying them so I tried to do
> it by hand, but looking at it more closely it seems a comparable patch
> may already have been applied.

Yes, there is already a fix for LINUX/CYGWIN stuff, but it is
interesting for me too why do we need the HDFEOSd_STRINGIZE trick?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From route at cae.com  Wed Sep  1 16:44:49 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to 
	read a TIFF
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D11D@caemsx03.cae.ca>

Hi Andrey,

I tried to take the 3.7.0 alpha from http://libtiff.maptools.org/dl/ ,
extract it in frmts\gtiff, rename the tiff-3.7.0alpha directory to libtiff,
rerun submake.bat, but it does not work.
As I know nothing qbout using makefiles, I don't know what to try now.
I'm on Windows 2000 with VisualC++6.0 SP6.

thanks in advance,


Stephane

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
Sent: Wednesday, September 01, 2004 3:00 PM
To: 'gdal-dev@remotesensing.org'
Subject: Re: [Gdal-dev] crash ( access violation ) in GDAL when trying
to read a TIFF


On Wed, Sep 01, 2004 at 02:10:01PM -0400, Stephane Routelous wrote:
> here is the content of tiffvers.h :
> #define TIFFLIB_VERSION_STR "LIBTIFF, Version 3.6.1\nCopyright (c)
1988-1996
> Sam Leffler\nCopyright (c) 1991-1996 Silicon Graphics, Inc."
> /*
>  * This define can be used in code that requires
>  * compilation-related definitions specific to a
>  * version or versions of the library.  Runtime
>  * version checking should be done based on the
>  * string returned by TIFFGetVersion.
>  */
> #define TIFFLIB_VERSION 20031226

Ok. Could you try to buid GDAL with the recent libtiff from the CVS?
There are many bugs fixed since the 3.6.1 release and few importand
issues was cleaned up few days ago.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From jluis at ualg.pt  Wed Sep  1 16:10:07 2004
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GTOPO30 vs STRM30
In-Reply-To: <200409011634.20045.didier.richard@ign.fr>
References: <200409011634.20045.didier.richard@ign.fr>
Message-ID: <1094069407.41362c9fcc304@wmail.ualg.pt>

Hi,
I just faced a problem running gdalinfo on a SRTM30 file. The documentation at
http://edcftp.cr.usgs.gov/pub/data/srtm/SRTM30/SRTM30_Documentation
says that
"It is formatted and organized in a fashion that mimics the GTOPO30 convention
so software and GIS systems that work with GTOPO30 should also work with SRTM30"
However, gdalinfo says that
'.../e100n40.dem' not recognised as a supported file format.

Has anyone tryied to load srtm30 tiles with gdal?

Thanks
J. Luis

From t.r.decarlo at larc.nasa.gov  Wed Sep  1 18:06:48 2004
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GTOPO30 vs STRM30
In-Reply-To: <1094069407.41362c9fcc304@wmail.ualg.pt>
Message-ID: <000201c4906f$fa949e70$959877c6@cts1149>

You first need to rename the eXXXnYY.dem file to eXXXnYY.bil. 
Then "gdalinfo eXXXnYY.bil" will work.

HTH,
Thom

> -----Original Message-----
> From: jluis@ualg.pt
> Sent: Wednesday, September 01, 2004 4:10 PM
> To: gdal-dev@xserve.flids.com
> Subject: [Gdal-dev] GTOPO30 vs STRM30
> 
> Hi,
> I just faced a problem running gdalinfo on a SRTM30 file. The
> documentation at
> http://edcftp.cr.usgs.gov/pub/data/srtm/SRTM30/SRTM30_Documentation
> says that
> "It is formatted and organized in a fashion that mimics the GTOPO30
> convention
> so software and GIS systems that work with GTOPO30 should also work with
> SRTM30"
> However, gdalinfo says that
> '.../e100n40.dem' not recognised as a supported file format.
> 
> Has anyone tryied to load srtm30 tiles with gdal?
> 
> Thanks
> J. Luis



From jluis at ualg.pt  Wed Sep  1 17:37:44 2004
From: jluis at ualg.pt (jluis@ualg.pt)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GTOPO30 vs STRM30
In-Reply-To: <000201c4906f$fa949e70$959877c6@cts1149>
References: <000201c4906f$fa949e70$959877c6@cts1149>
Message-ID: <1094074664.41364128ae8de@wmail.ualg.pt>

Quoting Thom DeCarlo <t.r.decarlo@larc.nasa.gov>:

> You first need to rename the eXXXnYY.dem file to eXXXnYY.bil.
> Then "gdalinfo eXXXnYY.bil" will work.
> 
> HTH,
> Thom
> 

I found out why. It is not a question of extension (it's the same .bil or .dem).
My mistake was that I didn't downlod the .hdr & .prj associated files.

From nil5-ksa at yandex.ru  Thu Sep  2 02:44:40 2004
From: nil5-ksa at yandex.ru (ksa)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] OGR: how to get information about font name in style
	string for point features
Message-ID: <0cf601c490b8$52c39c70$0511a8c0@moon>

Hi,

I'm using ogr1.2.1 on Linux Slackware 9.1. I've got some difficulties in
getting
style of point features.



I have follow MIF file:

--top of MIF file
Version 300
Charset "WindowsCyrillic"
Delimiter ","
CoordSys Earth Projection 1, 0
Columns 2
  ID Integer
  Code Char(8)
Data

Point 36.145654 54.531409
    Symbol (45,0,10,"MapInfo Weather",0,0)
--end of MIF file



So, I have follow style string (by calling OGRFeature::getStyleString()):

SYMBOL(a:0,c:#000000,s:10pt,id:"mapinfo-sym-45.ogr-sym-8").



There is no information about font name in that style string. How I can get
information about font name? MIF-file contains the information about font
name ("MapInfo Weather").



How I can get information about font name?



Thanks!



Sergey A. Karin



P.S. Sorry for my english.



From Silke.Reimer at intevation.de  Thu Sep  2 08:22:06 2004
From: Silke.Reimer at intevation.de (Silke Reimer)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal debian package
In-Reply-To: <413626BE.4000607@pobox.com>
References: <20040901165408.GS16620@intevation.de> <413626BE.4000607@pobox.com>
Message-ID: <20040902122206.GC3185@intevation.de>

Hi!

On Wed, Sep 01, 2004 at 03:45:02PM -0400, Frank Warmerdam wrote:
> Silke Reimer wrote:
> >Hallo!
> >
> >Writing the mail about the gdal Fedora pacakge I remembered that the
> >debian directory is still missing the update of some rather
> >substantial changes. I still have problems with my CVS access and
> >it would be nice if you, Frank, can have another look on it. 
> >
> >Otherwise I would suggest to take the diff [1] and apply it to the CVS.
> >You will have to ensure though that it doesn't break anything that
> >has been done since the gdal 1.2.1 release.
> 
> Silke,
> 
> I had a few problems and issues with the changes:
> 
> Why is this needed?
> 
> --- gdal-1.2.1.orig/GDALmake.opt.in
> +++ gdal-1.2.1/GDALmake.opt.in
> @@ -120,7 +120,7 @@
>  #
>  # HDF4 Support.
>  #
> -HDF4_INCLUDE  = @HDF4_INCLUDE@
> +HDF4_INCLUDE  = @HDF4_INCLUDE@ -I$(GDAL_ROOT)/ogr
> 
> It seems that this would be used in gdal/frmts/hdf4/GNUmakefile where
> the $(GDAL_INCLUDES) already includes -I$(GDAL_ROOT)/ogr.

I have to check this again. There has certainly been some reason to
add this include but I can't remember it any more. At the moment I
don't have the right system available so I hope it is OK for you to
wait with my answer.

> 
> I also don't really understand what the HDFEOSVersion.h changes were
> supposed to do. I had trouble with auto-applying them so I tried to do
> it by hand, but looking at it more closely it seems a comparable patch
> may already have been applied.

THe HDFEOSVersion.h has been necessary to build gdal with gcc 3.4.
I looked at the email list archives and it seems indeed that this
has been fixed just after the gdal 1.2.1 release. So please drop
this change.

> 
> I think I have applied the various other changes correctly (some by hand)
> but you might want to check.

Yes, I will recently - as soon as I have the system available again.

Thanks so far,

	Silke

-- 
Silke Reimer

Intevation GmbH                      http://intevation.de/
FreeGIS                                http://freegis.org/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040902/4e971506/attachment.bin
From Silke.Reimer at intevation.de  Thu Sep  2 08:35:01 2004
From: Silke.Reimer at intevation.de (Silke Reimer)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal Fedora Core 2 package
In-Reply-To: <DC236E64-FC43-11D8-8447-000D9329D732@frii.com>
References: <20040901164513.GR16620@intevation.de>
	<DC236E64-FC43-11D8-8447-000D9329D732@frii.com>
Message-ID: <20040902123501.GE3185@intevation.de>

On Wed, Sep 01, 2004 at 12:22:19PM -0600, Sean Gillies wrote:
> On Sep 1, 2004, at 10:45 AM, Silke Reimer wrote:
> 
> >
> >Hallo!
> >
> >...
> 
> Hi Silke,
> 
> I tried out the FC2 RPM recently and found that it was requiring
> the xerces-j (Java) RPM.  Shouldn't the requirement be on xerces-c?

Yes, you are of course right. This is one of the issues that I will
have to fix for the next gdal pacakge.

> I appreciate your efforts to get GDAL into FC2.  Thanks!

Thank you :-)

	Silke

-- 
Silke Reimer

Intevation GmbH                      http://intevation.de/
FreeGIS                                http://freegis.org/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040902/b771ad13/attachment.bin
From warmerdam at pobox.com  Thu Sep  2 10:07:39 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] OGR: how to get information about font name in style
	string for point features
In-Reply-To: <0cf601c490b8$52c39c70$0511a8c0@moon>
References: <0cf601c490b8$52c39c70$0511a8c0@moon>
Message-ID: <4137292B.2040501@pobox.com>

ksa wrote:
> Hi,
> 
> I'm using ogr1.2.1 on Linux Slackware 9.1. I've got some difficulties in
> getting
> style of point features.
> 
> 
> 
> I have follow MIF file:
> 
> --top of MIF file
> Version 300
> Charset "WindowsCyrillic"
> Delimiter ","
> CoordSys Earth Projection 1, 0
> Columns 2
>   ID Integer
>   Code Char(8)
> Data
> 
> Point 36.145654 54.531409
>     Symbol (45,0,10,"MapInfo Weather",0,0)
> --end of MIF file
> 
> 
> 
> So, I have follow style string (by calling OGRFeature::getStyleString()):
> 
> SYMBOL(a:0,c:#000000,s:10pt,id:"mapinfo-sym-45.ogr-sym-8").
> 
> 
> 
> There is no information about font name in that style string. How I can get
> information about font name? MIF-file contains the information about font
> name ("MapInfo Weather").
> 
> How I can get information about font name?

Sergey,

It appears the font information is lost even though it should properly be
carried into the style string.  I would encourage you to file a bug report
against GDAL's mapinfo driver about this, including an attached mid/mif file
set that demonstrates the problem.

The bad news is that we are someone backlogged on mapinfo related issues and
it is unlikely to be resolved for a while.  The Mapinfo driver is fairly
complicated and it takes some serious effort to get into the right "headspace"
to make fixes to the style related stuff.   I don't forsee Daniel or I doing
that in the near future and the original author of the .mid/mif section is
no longer involved.

If your need is sufficiently compelling, you could fund a bit of time to
fix this particular issue or look into preparing a patch yourself (though
this is a complicated area).

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Thu Sep  2 10:27:50 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] crash ( access violation ) in GDAL when trying to 
	read a TIFF
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D120@caemsx03.cae.ca>

Hi Andrey,

I got the daily cvs snapshot (gdal-cvs-20040902), recompiled it in debug,
and still got the same problem.
Here is my test code :
int main(int argc, char* argv[])
{
	GDALAllRegister();
	GDALDataset* m_gdalDataSet = (GDALDataset *) GDALOpen(
"C:\\TestDB\\cramps-tile.tif", GA_ReadOnly );  //this is line 15
	cout << m_gdalDataSet->GetRasterXSize() << " " <<
m_gdalDataSet->GetRasterYSize() << endl;
	GDALClose(m_gdalDataSet);
	return 0;
}

I hope the following information will be usefull :
Thnaks a lot,

Stephane

And here is what Boundchecker says (2 errors : Allocation conflict and
memory overrun):


1/ Allocation Conflict:


Type				Quantity			Location
Sequence

Allocation conflict	1				VSIRealloc -
[cpl_vsisimple.cpp, line 332 (gdal12.dll)]		20
Allocation Conflict: Attempting to call realloc on pointer 0x1F28C08, that
was allocated by HeapAlloc.

Current Call Stack
VSIRealloc			cpl_vsisimple.cpp			332
_TIFFrealloc		tif_vsi.c				184
TIFFMergeFieldInfo	tif_dirinfo.c			309
GTiffTagExtender		geotiff.cpp				3695
XTIFFDefaultDirectory	xtiff.c				85
TIFFDefaultDirectory	tif_dir.c				1144
TIFFReadDirectory		tif_dirread.c			200
TIFFClientOpen		tif_open.c				387
TIFFOpen			tif_vsi.c				161
XTIFFOpen			xtiff.c				138
Open				geotiff.cpp				2042
GDALOpen			gdalopen.cpp			228
main				C:\GDALBuild\test\test.cpp	15
mainCRTStartup		crtexe.c				338
	C:\WINNT\system32\KERNEL32.dll!0x00011af3	

Call Stack At Allocation
_heap_alloc	C:\GDALBuild\bin\gdal12.dll!0x0000006c	
_nh_malloc	C:\GDALBuild\bin\gdal12.dll!0x0000000b	
malloc	C:\GDALBuild\bin\gdal12.dll!0x0000000a	
_TIFFmalloc			tif_vsi.c				172



2/ memory overrun


Type			Quantity	Location
Sequence

Overrun detected	1		VSIRealloc - [cpl_vsisimple.cpp,
line 332 (gdal12.dll)]	21
Overrun Detected During Execution: In block 0x1F28C08 (400) allocated by
HeapAlloc.

Current Call Stack
VSIRealloc			cpl_vsisimple.cpp
332
_TIFFrealloc		tif_vsi.c					184
TIFFMergeFieldInfo	tif_dirinfo.c				309
GTiffTagExtender		geotiff.cpp
3695
XTIFFDefaultDirectory	xtiff.c					85
TIFFDefaultDirectory	tif_dir.c					1144
TIFFReadDirectory		tif_dirread.c				200
TIFFClientOpen		tif_open.c					387
TIFFOpen			tif_vsi.c
161
XTIFFOpen			xtiff.c					138
Open				geotiff.cpp
2042
GDALOpen			gdalopen.cpp				228
main				C:\GDALBuild\test\test.cpp		15
mainCRTStartup		crtexe.c					338
	C:\WINNT\system32\KERNEL32.dll!0x00011af3	

Call Stack At Allocation
_heap_alloc	C:\GDALBuild\bin\gdal12.dll!0x0000006c	
_nh_malloc	C:\GDALBuild\bin\gdal12.dll!0x0000000b	
malloc	C:\GDALBuild\bin\gdal12.dll!0x0000000a	
_TIFFmalloc	tif_vsi.c	172


From warmerdam at pobox.com  Thu Sep  2 12:04:21 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] bug in the documentation ?
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D11A@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D11A@caemsx03.cae.ca>
Message-ID: <41374485.6050501@pobox.com>

Stephane Routelous wrote:
> Hi,
> 
> according to the documentation
> (http://www.remotesensing.org:16080/gdal/classGDALRasterBand.html#a10)
...
> should it not be :
> 
> 09		   if( (iXBlock+1) * nXBlockSize > poBand->GetXSize())
> //note the +1
> 10                 nXValid = poBand->GetXSize()- iXBlock * nXBlockSize;
> 
> and
> 
> 13             if( (iYBlock+1) * nYBlockSize > poBand->GetYSize()) //note
> the +1
> 14                 nYValid = poBand->GetYSize()  - iYBlock * nYBlockSize;

Stephane,

You are correct.  I have committed a fix.

Thanks,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jnielsen at aero-graphics.com  Thu Sep  2 12:52:40 2004
From: jnielsen at aero-graphics.com (Jason M. Nielsen)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Overviews in seperate file for TIFF
Message-ID: <1094143960.41374fd861a58@www.agi-lan.com>

Is there a way to force the generation of overviews in a seperate file for
TIFF/GeoTIFFs beyond modifying the gdal code?

From nil5-ksa at yandex.ru  Fri Sep  3 07:25:02 2004
From: nil5-ksa at yandex.ru (ksa)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] OGR: how to get information about font name in style
	string for point features
References: <0cf601c490b8$52c39c70$0511a8c0@moon> <4137292B.2040501@pobox.com>
Message-ID: <0d8001c491a8$b20a76e0$0511a8c0@moon>


----- Original Message ----- 
From: "Frank Warmerdam" <warmerdam@pobox.com>
To: "ksa" <nil5-ksa@yandex.ru>
Cc: "gdal-dev" <gdal-dev@remotesensing.org>
Sent: Thursday, September 02, 2004 6:07 PM
Subject: Re: [Gdal-dev] OGR: how to get information about font name in style
string for point features


> ksa wrote:
> > Hi,
> >
> > I'm using ogr1.2.1 on Linux Slackware 9.1. I've got some difficulties in
> > getting
> > style of point features.
> >
> >
> >
> > I have follow MIF file:
> >
> > --top of MIF file
> > Version 300
> > Charset "WindowsCyrillic"
> > Delimiter ","
> > CoordSys Earth Projection 1, 0
> > Columns 2
> >   ID Integer
> >   Code Char(8)
> > Data
> >
> > Point 36.145654 54.531409
> >     Symbol (45,0,10,"MapInfo Weather",0,0)
> > --end of MIF file
> >
> >
> >
> > So, I have follow style string (by calling
OGRFeature::getStyleString()):
> >
> > SYMBOL(a:0,c:#000000,s:10pt,id:"mapinfo-sym-45.ogr-sym-8").
> >
> >
> >
> > There is no information about font name in that style string. How I can
get
> > information about font name? MIF-file contains the information about
font
> > name ("MapInfo Weather").
> >
> > How I can get information about font name?
>
> Sergey,
>
> It appears the font information is lost even though it should properly be
> carried into the style string.  I would encourage you to file a bug report
> against GDAL's mapinfo driver about this, including an attached mid/mif
file
> set that demonstrates the problem.
>
> The bad news is that we are someone backlogged on mapinfo related issues
and
> it is unlikely to be resolved for a while.  The Mapinfo driver is fairly
> complicated and it takes some serious effort to get into the right
"headspace"
> to make fixes to the style related stuff.   I don't forsee Daniel or I
doing
> that in the near future and the original author of the .mid/mif section is
> no longer involved.
>
> If your need is sufficiently compelling, you could fund a bit of time to
> fix this particular issue or look into preparing a patch yourself (though
> this is a complicated area).
>
> Best regards,
>
> --
> ---------------------------------------+----------------------------------
----
> I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>

Hi, Frank.

It is really important for me to receive this information somehow. Can you
prompt me in what classes it's really necessary to make changes to receive
this information?

Thankful in advance.


From warmerdam at pobox.com  Fri Sep  3 14:13:51 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] OpenEV_FW 1.8.1 Release
Message-ID: <4138B45F.2060605@pobox.com>

Folks,

I have produced a new OpenEV_FW release available at:

   http://www.gdal.org/dl/openev/OpenEV_FW_181.zip

It should also soon be available from the maptools download page at:

   http://gdal.maptools.org/dl/openev

The ftp.remotesensing.org master site is currently down (due to the hurricane
I think) but I will try to move it there next week as well.

I worked hard to include the HDF support in this release, but there are still
some outstanding problems that Andrey is working on.  In part this release
is intended to give folks a chance to try out the latest GDAL as I get close
to releasing GDAL 1.2.2.  Please report any GDAL issues in this package.

I ran the GDAL and MapServer test suites and discovered some problems in
MapServer that I have not isolated.  The GDAL suite seems to be running fine.
So, be a bit wary about this MapServer build.

If we can iron out a few of the other issues I will likely produce a new
cut in a week or so possibly corresponding with a formal GDAL 1.2.2 release.

PS. This new OpenEV_FW includes Gillian's updated raw tools.  As usual it is
built from the latest CVS for GDAL, OpenEV and MapServer.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From carueda at ucdavis.edu  Sat Sep  4 00:15:41 2004
From: carueda at ucdavis.edu (Carlos A. Rueda)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GEOS and GDAL 1.2.2
Message-ID: <chbfhe$p0t$1@sea.gmane.org>


I'm using the current GDAL devolepment code since I need the GEOS
support that is currently being added to GDAL. So It's nice to
know an official 1.2.2 is about to come.
Will ./configure --with-geos=...  work in the formal 1.2.2 ?

thanks much.
carlos


Frank Warmerdam wrote:
 > Folks,
 >
 > I have produced a new OpenEV_FW release available at:
 >
 >   http://www.gdal.org/dl/openev/OpenEV_FW_181.zip
 >
 > It should also soon be available from the maptools download page at:
 >
 >   http://gdal.maptools.org/dl/openev
 >
 > The ftp.remotesensing.org master site is currently down (due to the
 > hurricane
 > I think) but I will try to move it there next week as well.
 >
 > I worked hard to include the HDF support in this release, but there are
 > still
 > some outstanding problems that Andrey is working on.  In part this release
 > is intended to give folks a chance to try out the latest GDAL as I get
 > close
 > to releasing GDAL 1.2.2.  Please report any GDAL issues in this package.
 >
 > I ran the GDAL and MapServer test suites and discovered some problems in
 > MapServer that I have not isolated.  The GDAL suite seems to be running
 > fine.
 > So, be a bit wary about this MapServer build.
 >
 > If we can iron out a few of the other issues I will likely produce a new
 > cut in a week or so possibly corresponding with a formal GDAL 1.2.2
 > release.
 >
 > PS. This new OpenEV_FW includes Gillian's updated raw tools.  As usual
 > it is
 > built from the latest CVS for GDAL, OpenEV and MapServer.
 >
 > Best regards,



From warmerdam at pobox.com  Tue Sep  7 09:53:37 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GEOS and GDAL 1.2.2
In-Reply-To: <chbfhe$p0t$1@sea.gmane.org>
References: <chbfhe$p0t$1@sea.gmane.org>
Message-ID: <413DBD61.4000305@pobox.com>

Carlos A. Rueda wrote:
> 
> I'm using the current GDAL devolepment code since I need the GEOS
> support that is currently being added to GDAL. So It's nice to
> know an official 1.2.2 is about to come.
> Will ./configure --with-geos=...  work in the formal 1.2.2 ?

Carlos,

Fixes in the GDAL configure for working with the GEOS 2.0.0 release have
already been made (about a week ago perhaps).  Let me know if you still
encounter configuration issues with the current CVS GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From asimpson at i-55.com  Tue Sep  7 11:54:53 2004
From: asimpson at i-55.com (Simpson)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
Message-ID: <NFBBKOADOLGDLPMAAHMDIEDGCKAA.asimpson@i-55.com>

Hi,

I have successfully got gdal utilities to process the majority of my sid
files, but landsat data from https://zulu.ssc.nasa.gov/mrsid/ is getting
segmentation fault.  The MrSID utilities mrsidinfo and mrsiddecode seem to
work properly with these datasets.  The one I've been playing with is
https://zulu.ssc.nasa.gov/mrsid/bin/download_file.pl?client=etmpsmos/sid&ima
ge=N-16-30_2000.tar , if you can get through to the site.  Any
tips/suggestions would be great.

Thanks,
Drew.




System Info
	Linux xxxx 2.4.20-20.8 #1 Mon Aug 18 14:59:07 EDT 2003 i686 i686 i386
GNU/Linux

GCC Info
	gcc version 3.2 20020903 (Red Hat Linux 8.0 3.2-7)

GDAL Info
	I tried both gdal-1.2.1 and the csv gdal-cvs-20040903

	configuration
		./configure
			--with-mrsid=/usr/local/Geo_DSDK-4.0.9.713
			--without-geos
			--with-geotiff=internal

	The geotiff on the system would not compile so used version that came with
gdal.
	As soon as I can get my paws on a newer geotiff, I will install it.  Darn
hurricanes!

MrSID Info
	Geo_DSDK-4.0.9.713

STRACE Of gdalinfo call
	This is the tail end of an strace of a call to gdalinfo on one of these
data sets:

	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 187834368, [187834368], SEEK_SET) = 0
	_llseek(3, 222846976, [222846976], SEEK_SET) = 0
	read(3, "\377\243\344~\20\264>\222\10z2NH\3728sy\205\203&\34\32"..., 8192)
= 8192
	_llseek(3, 222855168, [222855168], SEEK_SET) = 0
	close(3)                                = 0
	munmap(0x40014000, 8192)                = 0
	brk(0)                                  = 0x8056000
	brk(0x8057000)                          = 0x8057000
	stat64("/usr/local/share/gdal/unit_of_measure.csv", {st_mode=S_IFREG|0644,
st_size=17933, 	...}) = 0
	open("/usr/local/share/gdal/unit_of_measure.csv", O_RDONLY) = 3
	fstat64(3, {st_mode=S_IFREG|0644, st_size=17933, ...}) = 0
	mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =
0x40014000
	_llseek(3, 0, [0], SEEK_CUR)            = 0
	read(3, "\"UOM_CODE\",\"UNIT_OF_MEAS_NAME\",\""..., 4096) = 4096
	fstat64(3, {st_mode=S_IFREG|0644, st_size=17933, ...}) = 0
	_llseek(3, 16384, [16384], SEEK_SET)    = 0
	read(3, "real, any precision). Must inclu"..., 4096) = 1549
	_llseek(3, 0, [0], SEEK_SET)            = 0
	brk(0)                                  = 0x8057000
	brk(0x805b000)                          = 0x805b000
	read(3, "\"UOM_CODE\",\"UNIT_OF_MEAS_NAME\",\""..., 16384) = 16384
	read(3, "real, any precision). Must inclu"..., 4096) = 1549
	close(3)                                = 0
	munmap(0x40014000, 4096)                = 0
	--- SIGSEGV (Segmentation fault) ---
	+++ killed by SIGSEGV +++



From csab7771 at uibk.ac.at  Tue Sep  7 07:07:55 2004
From: csab7771 at uibk.ac.at (Sabine Grabner)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] reading grass file
Message-ID: <1094555275.413d968bd7228@web-mail2.uibk.ac.at>

hello, 
 
i wrote a method for reading a map with the gdal library which works well for 
reading pcidsk-files. 
 
no i tried to read grass maps. i run: 
 
./configure --with-grass=/usr/local/lib 
make 
make install (as superuser) 
 
when i run my programm i get: 
 
ERROR 4: `/home/sabine/grass/grassdata/oetztal/sabine/dem' does not exist in 
the file system, and is not recognised as a supported dataset name. 
 
i suppose i make any simple beginners mistake. do you have an idea how to read 
my file? 
 
many thanks, sabine 

From csab7771 at uibk.ac.at  Tue Sep  7 07:11:26 2004
From: csab7771 at uibk.ac.at (Sabine Grabner)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] reading grass file
Message-ID: <1094555486.413d975e4bfef@web-mail2.uibk.ac.at>

hello,  
 
ups, i found the information right after posting my message. i had to give the 
path to 'cellhd'. i tried around with 'cell' and without. it was the other 
one :). 
 
thanks anyway. sabine 
 
 

From werchowyna at pf.pl  Tue Sep  7 13:18:22 2004
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] reprojecting DEM&TM
Message-ID: <007001c494fe$aee713c0$bdee63d9@podyadeck>

hello all!

could somebody tell me which method -rn, rb, -rc or -rcs should I use for
DEM and which for data like e.g. Landsat TM reprojecting

thanks
Maciek


From warmerdam at pobox.com  Tue Sep  7 13:28:43 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] reprojecting DEM&TM
In-Reply-To: <007001c494fe$aee713c0$bdee63d9@podyadeck>
References: <007001c494fe$aee713c0$bdee63d9@podyadeck>
Message-ID: <413DEFCB.7060809@pobox.com>

Maciek Sieczka wrote:
> hello all!
> 
> could somebody tell me which method -rn, rb, -rc or -rcs should I use for
> DEM and which for data like e.g. Landsat TM reprojecting

Maciek,

I would suggest -rb for DEMs, and one of the cubic kernsls for landsat data.
Of course, there are various factors that you should take into account.

Using -rb (bilinear) for the DEM will perform local averaging of the nearby
pixel values in the source.  This give reasonable results without introducing
any risky "overshoot" effects you might see with cubic that could be
disturbing for analysis or visualization in a DEM.

The cubic should in theory do better at preserving edges and general
visual crispness than using bilinar or nearest neighbour.  However, if you
are wanting to do analysis with the landsat (such as multispectral classification)
I would suggest just using -rn (nearest neighbour) so as to avoid causing odd
effects to the spectral values.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From sholl at gmx.net  Tue Sep  7 14:44:54 2004
From: sholl at gmx.net (Stephan Holl)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GPJ_grass_to_wkt
Message-ID: <20040907204454.786de737@localhost>

Dear List,

I am trying to compile GDAL (from CVS) with Radims patch in order to
read GRASS-Raster with QGIS.
But unfortunately something went wrong and GDAL does not compile. The
error is as follows:

make[1]: Leaving directory `/home/steph/cvs/gdal/ogr/ogrsf_frmts'
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -L/usr/local/lib
/usr/local/lib/libgeos -L/home/steph/cvs/ogdi/ogdi
-L/home/steph/cvs/ogdi/ogdi/lib -logdi31 /usr/lib/libjpeg.so -ltiff
-lpng -L/home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib -lgrass_I
-lgrass_vask -lgrass_gmath -lgrass_gis -lgrass_datetime -lz -ldl
-L/usr/lib -lpq../.libs/libgdal.so: undefined reference to
`GPJ_grass_to_wkt' collect2: ld returned 1 exit status
make: *** [ogrinfo] Fehler 1
steph@bim:~/cvs/gdal/ogr >

when I do 
ldd ~/cvs/gdal/.libs/libgdal.so
no unresolved references are shown.

Does anybody know how to solve the problem?

Thanks in advance.

Cheers
	Stephan 

-- 
Stephan Holl

Check headers for GnuPG Key!
http://www.gdf-hannover.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040907/a1eb4289/attachment.bin
From dron at ak4719.spb.edu  Tue Sep  7 15:22:29 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <NFBBKOADOLGDLPMAAHMDIEDGCKAA.asimpson@i-55.com>
References: <NFBBKOADOLGDLPMAAHMDIEDGCKAA.asimpson@i-55.com>
Message-ID: <20040907192229.GA20324@ak4719.spb.edu>

On Tue, Sep 07, 2004 at 10:54:53AM -0500, Simpson wrote:
> I have successfully got gdal utilities to process the majority of my sid
> files, but landsat data from https://zulu.ssc.nasa.gov/mrsid/ is getting
> segmentation fault.  The MrSID utilities mrsidinfo and mrsiddecode seem to
> work properly with these datasets.  The one I've been playing with is
> https://zulu.ssc.nasa.gov/mrsid/bin/download_file.pl?client=etmpsmos/sid&ima
> ge=N-16-30_2000.tar , if you can get through to the site.  Any
> tips/suggestions would be great.

Drew,

I shall try to reproduce your problem tomorrow. Just a single question:
what GDAL version you are working with?

> 	The geotiff on the system would not compile so used version that
> 	came with gdal.

That problem is interesting for us too. Why you can't compile
libgeotiff?

> STRACE Of gdalinfo call

Well, thanks for your output, but gdb results will be really more useful
for us...

					Regards,
					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Tue Sep  7 15:28:23 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] reprojecting DEM&TM
In-Reply-To: <007001c494fe$aee713c0$bdee63d9@podyadeck>
References: <007001c494fe$aee713c0$bdee63d9@podyadeck>
Message-ID: <20040907192823.GB20324@ak4719.spb.edu>

On Tue, Sep 07, 2004 at 07:18:22PM +0200, Maciek Sieczka wrote:
> could somebody tell me which method -rn, rb, -rc or -rcs should I use
> for DEM and which for data like e.g. Landsat TM reprojecting

Nobody can't tell you what method should be used in your case. Generally
seaking, in the case of upsampling spline and cubic interpolators are
more suitable (-rcs and -rc). In the case of downsampling and the same
resolution it is completely up to you what method looks better. Just try
them all and select the one which is most appropriate for you.

					Best regards,
					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From hi_ono2001 at ybb.ne.jp  Wed Sep  8 08:34:56 2004
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GEOS and GDAL 1.2.2
References: <chbfhe$p0t$1@sea.gmane.org> <413DBD61.4000305@pobox.com>
Message-ID: <006001c495a0$3fd6bc40$3c8001db@webgis>

Hi.

 When will command line tool like "ogr2ogr" support "GEOS"?


 Regards.

 

From warmerdam at pobox.com  Wed Sep  8 08:45:53 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GEOS and GDAL 1.2.2
In-Reply-To: <006001c495a0$3fd6bc40$3c8001db@webgis>
References: <chbfhe$p0t$1@sea.gmane.org> <413DBD61.4000305@pobox.com>
	<006001c495a0$3fd6bc40$3c8001db@webgis>
Message-ID: <413EFF01.6050900@pobox.com>

Hisaji ONO wrote:
> Hi.
> 
>  When will command line tool like "ogr2ogr" support "GEOS"?

Hisaji,

I haven't really thought through how this would work yet.  My first goal was
to make the capabilities available in C++ and Python so that specific tools
could be built if needed.

I would like to provide a variation on the -spat (spatial subsetting)
switch which allows any relation and an arbitrary geometry.

Do you have specific thoughts on what additional capabilities you
would like to see?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep  8 10:31:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: MapServer WCS
In-Reply-To: <DE8A435707FBA24392E5C67F58E294AA04E87F@dev001_pdc.dev.cadcorp.net>
References: <DE8A435707FBA24392E5C67F58E294AA04E87F@dev001_pdc.dev.cadcorp.net>
Message-ID: <413F17B1.1030103@pobox.com>

Martin Daly wrote:
> Frank,
> 
> No freaky corrupt files this time.  Instead the 24-bit TIFF that
> MapServer produces has TIFFTAG_PLANARCONFIG=PLANARCONFIG_SEPARATE (=2).
> According to the TIFF spec:
> 
> PlanarConfiguration=2 is not currently in widespread use and it is not
> recommended
> for general interchange. It is used as an extension and Baseline TIFF
> readers are not required to support it.
> 
> Any reason for using this?  SIS's internal TIFF (via libtiff) doesn't
> support it, but TIFF via GDAL via libtiff does.  We plan to use GDAL in
> our WCS client anyway, so this is not a big issue.  More curiosity
> really.

Martin,

I have used PLANARCONFIG_SEPERATE within GDAL (and PCI's GDB before that)
by default because it is more efficient for access given the band-by-band
approach of GDAL.  This makes some sense when GDAL is used to produce TIFFs
for consumption in GDAL, but it is true when aiming for maximum interoperability
it would be better to use PLANARCONFIG_CONTIG.

Steve ... I would suggest you add the FORMATOPTION "INTERLEAVE=BAND" line in the
OUTPUTFORMAT declaration in your mapfile to improve interoperability of the
TIFF files.

Martin ... I would encourage you to support planarconfig_seperate files in
your built-in TIFF reader if possible.  They aren't too hard ... just yet
another case.

I am taking the liberty of cc:ing the gdal-dev mailing list so that others
using GDAL to generate TIFF files can keep this issue in mind.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gillian.walter at atlantis-scientific.com  Wed Sep  8 12:03:38 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] OGR feature styles question
Message-ID: <413F2D5A.7080903@atlantis-scientific.com>

Hi,

The following (quite old) part of the gdal website mentions ogr feature 
style files (.OFS) under section 2.7:

http://gdal.velocet.ca/~warmerda/projects/opengis/ogr_feature_style_008.html

Has support for these files actually been implemented anywhere?  If so, 
did it follow this spec, or was something different done?  I am looking 
at saving layer display properties, and I'm not sure whether to make 
this support completely internal to our applications, or to try to do 
something that could also be used in OpenEV. 

Gillian



From warmerdam at pobox.com  Wed Sep  8 12:59:08 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: [Openev-discuss] OGR feature styles question
In-Reply-To: <413F2D5A.7080903@atlantis-scientific.com>
References: <413F2D5A.7080903@atlantis-scientific.com>
Message-ID: <413F3A5C.30300@pobox.com>

Gillian Walter wrote:
> Hi,
> 
> The following (quite old) part of the gdal website mentions ogr feature 
> style files (.OFS) under section 2.7:
> 
> http://gdal.velocet.ca/~warmerda/projects/opengis/ogr_feature_style_008.html 
> 
> 
> Has support for these files actually been implemented anywhere?  If so, 
> did it follow this spec, or was something different done?  I am looking 
> at saving layer display properties, and I'm not sure whether to make 
> this support completely internal to our applications, or to try to do 
> something that could also be used in OpenEV.

Gillian,

The advanced OpenEV rendering capabilities are implemented according to the
OGR Feature Style document though it is by no means a complete implementation
of the specification.   However, within OpenEV the feature style strings
are stored in a _gv_ogrfs attribute on the features.  The OGR reader takes
care of reading the feature style from an OGRFeature and turning it into an
_gv_ogrfs attribute.

There isn't really much capability in OGR or OpenEV for saving the _gv_ogrfs
stuff in arbitrary output files.  Ideally the shapefile saver would add a
column for it if it is present in the dataset but that has no been done.  The
project saved logic *does* preserve the _gv_ogrfs.

My suggestion is to save the feature style as a regular attribute called
_gv_ogrfs for your application purposes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From werchowyna at pf.pl  Wed Sep  8 18:47:38 2004
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal
Message-ID: <005a01c495f6$49426d00$09544cd5@podyadeck>

hello

can somebody tell me if it is safe now to build gdal (cvs) --with-grass?
I read some about it but I'm confused

I want to make the r.out.gdal in Grass work

Maciek

From jnielsen at aero-graphics.com  Thu Sep  9 10:47:40 2004
From: jnielsen at aero-graphics.com (Jason M. Nielsen)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Transform from epsg:26912 to esri:102758 issue...
Message-ID: <1094741260.41406d0cac352@www.agi-lan.com>

I have data in epsg:26912 and the client wants it transformed to esri:102758.

The destination system is "NAD-1983_Stateplane_Wyoming_West_FIPS_4904_Feet"
according to ArcGIS.

If I try to do a direct transformation the following occures:

[root@mapserver s]# gdalwarp -s_srs epsg:26912 -t_srs esri:102758
south_lincoln.tif south_lincolnx.tif 
ERROR 1: Translating source or target SRS failed:
esri:102758

So instead I have specified the parameters as follows:

gdalwarp -s_srs epsg:26912 -t_srs "+proj=tmerc +lat_0=40.5
+lon_0=-110.0833333333333 +k=0.999938 +x_0=799999.9999999999 +y_0=100000
+ellps=GRS80 +datum=NAD83 +to_meter=0.3048006096012192" south_lincoln.tif
south_lincolnx.tif

Now this translates but I then have another issue. gdalinfo reports the
following which looks all good accept one thing thats bugging me.  Note the
false_easting and false_northing. The client gave me a print out of the
projection defines which included those two values. I have also confirmed the
clients printout in both ArcGIS and AutoCAD 2002. The false origin listed by the
client is as follows:

false_easting: 2624666.666667
false_northing: 328083.333333

Note that these are a factor of 3.2808 of those created during the gdal
transformation below.

[root@mapserver s]# gdalinfo south_lincolnx.tif 
Driver: GTiff/GeoTIFF
Size is 21680, 42482
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010042,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",40.5],
    PARAMETER["central_meridian",-110.0833333333333],
    PARAMETER["scale_factor",0.999938],
    PARAMETER["false_easting",8611093.888888888],
    PARAMETER["false_northing",1076386.736111111],
    UNIT["US survey foot",0.3048006096012192,
        AUTHORITY["EPSG","9003"]]]
Origin = (2342073.330325,1150633.460539)
Pixel Size = (3.28217146,-3.28217146)
Corner Coordinates:
Upper Left  ( 2342073.330, 1150633.461) (131d54'38.64"W, 38d36'4.93"N)
Lower Left  ( 2342073.330, 1011200.253) (131d47'54.78"W, 38d14'45.11"N)
Upper Right ( 2413230.808, 1150633.461) (131d40'45.89"W, 38d38'47.38"N)
Lower Right ( 2413230.808, 1011200.253) (131d34'5.46"W, 38d17'25.51"N)
Center      ( 2377652.069, 1080916.857) (131d44'20.54"W, 38d26'46.05"N)


So the question is. Who's is correct? And if my output is wrong what am I doing
incorrectly or are the defines in the esri proj file incorrect? Or am I bugging
out over nothing?

Thanks,
Jason.

From debian at adkgis.org  Thu Sep  9 13:07:47 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GPJ_grass_to_wkt
In-Reply-To: <20040907204454.786de737@localhost>
References: <20040907204454.786de737@localhost>
Message-ID: <1094749667.7106.5.camel@marcy>

On Tue, 2004-09-07 at 14:44, Stephan Holl wrote:
> Dear List,
> 
> I am trying to compile GDAL (from CVS) with Radims patch in order to
> read GRASS-Raster with QGIS.
> But unfortunately something went wrong and GDAL does not compile. The
> error is as follows:
> 
> make[1]: Leaving directory `/home/steph/cvs/gdal/ogr/ogrsf_frmts'
> /bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
> g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -L/usr/local/lib
> /usr/local/lib/libgeos -L/home/steph/cvs/ogdi/ogdi
> -L/home/steph/cvs/ogdi/ogdi/lib -logdi31 /usr/lib/libjpeg.so -ltiff
> -lpng -L/home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib -lgrass_I
> -lgrass_vask -lgrass_gmath -lgrass_gis -lgrass_datetime -lz -ldl
> -L/usr/lib -lpq../.libs/libgdal.so: undefined reference to
> `GPJ_grass_to_wkt' collect2: ld returned 1 exit status
> make: *** [ogrinfo] Fehler 1
> steph@bim:~/cvs/gdal/ogr >
> 
> when I do 
> ldd ~/cvs/gdal/.libs/libgdal.so
> no unresolved references are shown.
> 

Stephan,

Try adding /home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib to
/etc/ld.so.conf and running ldconfig.

Steve




From debian at adkgis.org  Thu Sep  9 13:18:09 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal
In-Reply-To: <005a01c495f6$49426d00$09544cd5@podyadeck>
References: <005a01c495f6$49426d00$09544cd5@podyadeck>
Message-ID: <1094750289.7106.16.camel@marcy>

On Wed, 2004-09-08 at 18:47, Maciek Sieczka wrote:
> hello
> 
> can somebody tell me if it is safe now to build gdal (cvs) --with-grass?
> I read some about it but I'm confused
> 
> I want to make the r.out.gdal in Grass work

Maciek,

It has worked fine for me. But I don't think it's what you need here.
gdal --with-grass allows gdal to read grass vectors and rasters. But
r.out.gdal depends on building grass --with-gdal. I've also found that,
at least for r.in.gdal, it crashes in grass 5.0 and works fine in grass
5.7.

Steve


From asimpson at i-55.com  Thu Sep  9 13:27:27 2004
From: asimpson at i-55.com (Simpson)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <20040907192229.GA20324@ak4719.spb.edu>
Message-ID: <NFBBKOADOLGDLPMAAHMDGEDPCKAA.asimpson@i-55.com>

I tried to compile both gdal-1.2.1 and gdal-cvs-20040903 with the
libgeotiff-1.2.1 on my system and the compilation failed with:

...
(cd ogr; make apps)
make[1]: Entering directory `/xxx/Software/gdal-cvs-20040903/ogr'
/bin/sh ../libtool --mode=compile
g++ -Wall  -O2    -Iogrsf_frmts -I. -I../port -I../gcore -I../ogr -I../alg  
 -D_REENTRANT  -I../port  -c -o ogrinfo.o ogrinfo.cpp

g++ -Wall -O2 -Iogrsf_frmts -I. -I../port -I../gcore -I../ogr -I../alg -D_RE
ENTRANT -I../port -c ogrinfo.cpp  -fPIC -DPIC -o .libs/ogrinfo.o

g++ -Wall -O2 -Iogrsf_frmts -I. -I../port -I../gcore -I../ogr -I../alg -D_RE
ENTRANT -I../port -c ogrinfo.cpp -o ogrinfo.o >/dev/null 2>&1
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo

../.libs/libgdal.so -lodbc -L/usr/local/Geo_DSDK-4.0.9.713/lib/Release -llti
dsdk -lpthread -ljasper -lgif
/usr/lib/libjpeg.so -lgeotiff -ltiff -lpng -lz -ldl -L/usr/lib -lpq
../.libs/libgdal.so: undefined reference to `gtCSVReadParseLine'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/xxx/Software/gdal-cvs-20040903/ogr'
make: *** [ogr-apps] Error 2

If I used the configure parameter "--with-geotiff=internal" gdal compiled
cleanly.

I downloaded and installed libgeotiff-1.2.2 and now gdal compiles cleanly,
but didn't fix problem with MrSID.

Here is gdb output from running gdalinfo against one of the problem MrSID
files:

(gdb) run n_16_30_2000c.zu.sid
Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid

Program received signal SIGSEGV, Segmentation fault.
0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
   from /usr/local/lib/libgdal.so.1
(gdb) bt
#0  0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
   from /usr/local/lib/libgdal.so.1
#1  0x4014ff6f in MrSIDRasterBand::MrSIDRasterBand(MrSIDDataset*, int) ()
   from /usr/local/lib/libgdal.so.1
#2  0x40150f51 in MrSIDDataset::OpenZoomLevel(int) ()
   from /usr/local/lib/libgdal.so.1
#3  0x4015132b in MrSIDDataset::Open(GDALOpenInfo*) ()
   from /usr/local/lib/libgdal.so.1
#4  0x40182abd in GDALOpen () from /usr/local/lib/libgdal.so.1
#5  0x08049833 in main ()
#6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6
(gdb)


Thanks for your help,
Drew.



-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
Sent: Tuesday, September 07, 2004 2:22 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] MrSID Segmentation Fault


On Tue, Sep 07, 2004 at 10:54:53AM -0500, Simpson wrote:
> I have successfully got gdal utilities to process the majority of my sid
> files, but landsat data from https://zulu.ssc.nasa.gov/mrsid/ is getting
> segmentation fault.  The MrSID utilities mrsidinfo and mrsiddecode seem to
> work properly with these datasets.  The one I've been playing with is
>
https://zulu.ssc.nasa.gov/mrsid/bin/download_file.pl?client=etmpsmos/sid&ima
> ge=N-16-30_2000.tar , if you can get through to the site.  Any
> tips/suggestions would be great.

Drew,

I shall try to reproduce your problem tomorrow. Just a single question:
what GDAL version you are working with?

> 	The geotiff on the system would not compile so used version that
> 	came with gdal.

That problem is interesting for us too. Why you can't compile
libgeotiff?

> STRACE Of gdalinfo call

Well, thanks for your output, but gdb results will be really more useful
for us...

					Regards,
					Andrey

--
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev




From wlyons at prologic-inc.com  Thu Sep  9 14:04:37 2004
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Newbie
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DA43ECA@vader.prologic-inc.com>

Hello,

 

I'm new to gdal and relatively new to geospatial data.  What I'm trying
to do is compile gdal in a windows environment using Visual Studio .NET

Has anyone out there tried this before?  Any advice?

 

Thanks,

 

BJ

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040909/59c79013/attachment.html
From dron at ak4719.spb.edu  Thu Sep  9 14:07:34 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <NFBBKOADOLGDLPMAAHMDGEDPCKAA.asimpson@i-55.com>
References: <20040907192229.GA20324@ak4719.spb.edu>
	<NFBBKOADOLGDLPMAAHMDGEDPCKAA.asimpson@i-55.com>
Message-ID: <20040909180734.GB19711@ak4719.spb.edu>

On Thu, Sep 09, 2004 at 12:27:27PM -0500, Simpson wrote:
> Here is gdb output from running gdalinfo against one of the problem
> MrSID files:

Your gdab output does not contain debug info. To build GDAL with
debugging information you should whether use the command

 $ CFG=debug make

or just export 'CFG=debug' environment variable in the shell profile.

> (gdb) run n_16_30_2000c.zu.sid
> Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> (gdb) bt
> #0  0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> #1  0x4014ff6f in MrSIDRasterBand::MrSIDRasterBand(MrSIDDataset*, int) ()
>    from /usr/local/lib/libgdal.so.1
> #2  0x40150f51 in MrSIDDataset::OpenZoomLevel(int) ()
>    from /usr/local/lib/libgdal.so.1
> #3  0x4015132b in MrSIDDataset::Open(GDALOpenInfo*) ()
>    from /usr/local/lib/libgdal.so.1
> #4  0x40182abd in GDALOpen () from /usr/local/lib/libgdal.so.1
> #5  0x08049833 in main ()
> #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6

Ok, it seems that I have found and fixed the problem.

Frank, could you post the new anonymous CVS access instructions for
GDAL?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Thu Sep  9 14:27:51 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Newbie
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DA43ECA@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DA43ECA@vader.prologic-inc.com>
Message-ID: <20040909182751.GA23592@ak4719.spb.edu>

On Thu, Sep 09, 2004 at 02:04:37PM -0400, William Lyons wrote:
> I'm new to gdal and relatively new to geospatial data.  What I'm
> trying to do is compile gdal in a windows environment using Visual
> Studio .NET
> 
> Has anyone out there tried this before?  Any advice?

That should be relatively easy task. There are three steps:

1. Edit nmake.opt file in the GDAL root directory and adjust the build
   options if needed (every option has a comment).
2. Run vcvars32.bat file from the MSVC bin directory to get the
   apprpriate command line environment.
3. Change directory to the GDAL root and run command

   d:\gdal\> nmake /f makefile.vc

   If you want to install compiled binaries you should run

   d:\gdal\> nmake /f makefile.vc install

   afterwards (don't forget to change install path in the nmake.opt).

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From warmerdam at pobox.com  Thu Sep  9 14:50:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <20040909180734.GB19711@ak4719.spb.edu>
References: <20040907192229.GA20324@ak4719.spb.edu>	<NFBBKOADOLGDLPMAAHMDGEDPCKAA.asimpson@i-55.com>
	<20040909180734.GB19711@ak4719.spb.edu>
Message-ID: <4140A5F7.8010603@pobox.com>

Andrey Kiselev wrote:
> Ok, it seems that I have found and fixed the problem.
> 
> Frank, could you post the new anonymous CVS access instructions for
> GDAL?

Andrey / Folks,

The new CVS instructions are on the web site:


   http://www.remotesensing.org/gdal/download.html


The GDAL source is available by anonymous CVS from the cvs.maptools.org server:

  export CVSROOT=:pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot
  cvs login
  Password: <enter>
  cvs checkout gdal

It is also possible that this new bug report relates to the problem encountered.

   http://bugzilla.remotesensing.org/show_bug.cgi?id=610

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From asimpson at i-55.com  Thu Sep  9 14:58:04 2004
From: asimpson at i-55.com (Simpson)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <20040909180734.GB19711@ak4719.spb.edu>
Message-ID: <NFBBKOADOLGDLPMAAHMDMEEACKAA.asimpson@i-55.com>

Andrey,

Did you find the issue?

If not, below is another run of gdalinfo compiled with CFG=debug.

I am not adept with gdb, so let me know how/what other data would be
helpful.

Thanks again for your help,
Drew.



(gdb) run n_16_30_2000c.zu.sid
Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid

Program received signal SIGSEGV, Segmentation fault.
0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
   from /usr/local/lib/libgdal.so.1
(gdb) bt
#0  0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
   from /usr/local/lib/libgdal.so.1
#1  0x4017252f in MrSIDRasterBand (this=0x805b030, poDS=0x805af20, nBand=3)
    at mrsiddataset.cpp:1344
#2  0x40173d56 in MrSIDDataset::OpenZoomLevel(int) (this=0x805af20, iZoom=1)
    at mrsiddataset.cpp:1833
#3  0x401743af in MrSIDDataset::Open(GDALOpenInfo*) (poOpenInfo=0xbfff4230)
    at mrsiddataset.cpp:1933
#4  0x401b5794 in GDALOpen (pszFilename=0x804ee50 "n_16_30_2000c.zu.sid",
    eAccess=GA_ReadOnly) at gdalopen.cpp:228
#5  0x080498b6 in main (argc=2, argv=0x804ecd0) at gdalinfo.c:211
#6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
Sent: Thursday, September 09, 2004 1:08 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] MrSID Segmentation Fault


On Thu, Sep 09, 2004 at 12:27:27PM -0500, Simpson wrote:
> Here is gdb output from running gdalinfo against one of the problem
> MrSID files:

Your gdab output does not contain debug info. To build GDAL with
debugging information you should whether use the command

 $ CFG=debug make

or just export 'CFG=debug' environment variable in the shell profile.

> (gdb) run n_16_30_2000c.zu.sid
> Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
>
> Program received signal SIGSEGV, Segmentation fault.
> 0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> (gdb) bt
> #0  0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> #1  0x4014ff6f in MrSIDRasterBand::MrSIDRasterBand(MrSIDDataset*, int) ()
>    from /usr/local/lib/libgdal.so.1
> #2  0x40150f51 in MrSIDDataset::OpenZoomLevel(int) ()
>    from /usr/local/lib/libgdal.so.1
> #3  0x4015132b in MrSIDDataset::Open(GDALOpenInfo*) ()
>    from /usr/local/lib/libgdal.so.1
> #4  0x40182abd in GDALOpen () from /usr/local/lib/libgdal.so.1
> #5  0x08049833 in main ()
> #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6

Ok, it seems that I have found and fixed the problem.

Frank, could you post the new anonymous CVS access instructions for
GDAL?

						Andrey

--
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev




From rpereira at ku.edu  Thu Sep  9 14:58:05 2004
From: rpereira at ku.edu (Pereira, Ricardo Scachetti)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Link error when building gdal on VC++6
Message-ID: <E77B3DFC56532248BF83B6AFF923AAE304179BC2@bluebird2.home.ku.edu>

	Hi, folks,

	I've just checked out a fresh copy of gdal. I tried to build it
on Windows (Visual C++ 6) using the instructions on this document
http://www.remotesensing.org/gdal/download.html as I've always done.
This time, the build fails with this message:

Microsoft (R) Library Manager Version 6.00.8447
Copyright (C) Microsoft Corp 1992-1998. All rights reserved.

        link /dll /debug /INCLUDE:_OCTNewCoordinateTransformation
/INCLUDE:_OGR
RegisterAll  /INCLUDE:_OGRFeatureStylePuller  /INCLUDE:_OSRValidate
/INCLUDE:_O
PTGetProjectionMethods  /INCLUDE:_OGR_G_GetPointCount
/INCLUDE:_GDALSimpleImageW
arp  /INCLUDE:_GDALSuggestedWarpOutput  /INCLUDE:_GDALGCPTransform
/INCLUDE:_GD
ALComputeMedianCutPCT  /INCLUDE:_GDALDitherRGB2PCT port\*.obj
gcore\*.obj alg\*.
obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib
odbc32.lib
                  /out:gdal12.dll /implib:gdal_i.lib
Microsoft (R) Incremental Linker Version 6.00.8447
Copyright (C) Microsoft Corp 1992-1998. All rights reserved.

   Creating library gdal_i.lib and object gdal_i.exp
gdalallregister.obj : error LNK2001: unresolved external symbol
_GDALRegister_CP
G
gdal12.dll : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: 'link' : return code '0x460'
Stop.


	When I move back to the last working copy I had (from 07/17/04)
it builds fine.
	Does anyone know what is broken in the latest version in CVS?
	Many thanks,

Ricardo




From warmerdam at pobox.com  Thu Sep  9 15:01:56 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Link error when building gdal on VC++6
In-Reply-To: <E77B3DFC56532248BF83B6AFF923AAE304179BC2@bluebird2.home.ku.edu>
References: <E77B3DFC56532248BF83B6AFF923AAE304179BC2@bluebird2.home.ku.edu>
Message-ID: <4140A8A4.6030200@pobox.com>

Pereira, Ricardo Scachetti wrote:
>    Creating library gdal_i.lib and object gdal_i.exp
> gdalallregister.obj : error LNK2001: unresolved external symbol
> _GDALRegister_CP
> G
> gdal12.dll : fatal error LNK1120: 1 unresolved externals
> NMAKE : fatal error U1077: 'link' : return code '0x460'
> Stop.
> 
> 
> 	When I move back to the last working copy I had (from 07/17/04)
> it builds fine.
> 	Does anyone know what is broken in the latest version in CVS?

Ricardo,

Sorry, cpgdataset.obj was missing from gdal/frmts/raw/makefile.vc.  I have
commited a fix for this, but you can easily add it manually and build again.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Thu Sep  9 14:52:22 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <NFBBKOADOLGDLPMAAHMDMEEACKAA.asimpson@i-55.com>
References: <20040909180734.GB19711@ak4719.spb.edu>
	<NFBBKOADOLGDLPMAAHMDMEEACKAA.asimpson@i-55.com>
Message-ID: <20040909185222.GA26939@ak4719.spb.edu>

On Thu, Sep 09, 2004 at 01:58:04PM -0500, Simpson wrote:
> Did you find the issue?

Yes, it should be fixed now (check out the latest CVS).

> If not, below is another run of gdalinfo compiled with CFG=debug.
> 
> I am not adept with gdb, so let me know how/what other data would be
> helpful.

It is completely eniugh for me to get the gdb protocols like the last
one.

						Andrey

> (gdb) run n_16_30_2000c.zu.sid
> Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
> 
> Program received signal SIGSEGV, Segmentation fault.
> 0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> (gdb) bt
> #0  0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> #1  0x4017252f in MrSIDRasterBand (this=0x805b030, poDS=0x805af20, nBand=3)
>     at mrsiddataset.cpp:1344
> #2  0x40173d56 in MrSIDDataset::OpenZoomLevel(int) (this=0x805af20, iZoom=1)
>     at mrsiddataset.cpp:1833
> #3  0x401743af in MrSIDDataset::Open(GDALOpenInfo*) (poOpenInfo=0xbfff4230)
>     at mrsiddataset.cpp:1933
> #4  0x401b5794 in GDALOpen (pszFilename=0x804ee50 "n_16_30_2000c.zu.sid",
>     eAccess=GA_ReadOnly) at gdalopen.cpp:228
> #5  0x080498b6 in main (argc=2, argv=0x804ecd0) at gdalinfo.c:211
> #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6
> 
> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com
> [mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
> Sent: Thursday, September 09, 2004 1:08 PM
> To: gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] MrSID Segmentation Fault
> 
> 
> On Thu, Sep 09, 2004 at 12:27:27PM -0500, Simpson wrote:
> > Here is gdb output from running gdalinfo against one of the problem
> > MrSID files:
> 
> Your gdab output does not contain debug info. To build GDAL with
> debugging information you should whether use the command
> 
>  $ CFG=debug make
> 
> or just export 'CFG=debug' environment variable in the shell profile.
> 
> > (gdb) run n_16_30_2000c.zu.sid
> > Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
> >
> > Program received signal SIGSEGV, Segmentation fault.
> > 0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
> >    from /usr/local/lib/libgdal.so.1
> > (gdb) bt
> > #0  0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
> >    from /usr/local/lib/libgdal.so.1
> > #1  0x4014ff6f in MrSIDRasterBand::MrSIDRasterBand(MrSIDDataset*, int) ()
> >    from /usr/local/lib/libgdal.so.1
> > #2  0x40150f51 in MrSIDDataset::OpenZoomLevel(int) ()
> >    from /usr/local/lib/libgdal.so.1
> > #3  0x4015132b in MrSIDDataset::Open(GDALOpenInfo*) ()
> >    from /usr/local/lib/libgdal.so.1
> > #4  0x40182abd in GDALOpen () from /usr/local/lib/libgdal.so.1
> > #5  0x08049833 in main ()
> > #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6
> 
> Ok, it seems that I have found and fixed the problem.
> 
> Frank, could you post the new anonymous CVS access instructions for
> GDAL?
> 
> 						Andrey
> 
> --
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Thu Sep  9 15:11:34 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <4140A5F7.8010603@pobox.com>
References: <20040907192229.GA20324@ak4719.spb.edu>
	<NFBBKOADOLGDLPMAAHMDGEDPCKAA.asimpson@i-55.com>
	<20040909180734.GB19711@ak4719.spb.edu>
	<4140A5F7.8010603@pobox.com>
Message-ID: <20040909191134.GA15732@ak4719.spb.edu>

On Thu, Sep 09, 2004 at 02:50:31PM -0400, Frank Warmerdam wrote:
> It is also possible that this new bug report relates to the problem
> encountered.
> 
>   http://bugzilla.remotesensing.org/show_bug.cgi?id=610

No, that is another bug... which is fixed too.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From asimpson at i-55.com  Thu Sep  9 15:34:20 2004
From: asimpson at i-55.com (Simpson)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] MrSID Segmentation Fault
In-Reply-To: <20040909185222.GA26939@ak4719.spb.edu>
Message-ID: <NFBBKOADOLGDLPMAAHMDMEEBCKAA.asimpson@i-55.com>

yahoo, it works!

Thanks for everyones help,
Drew.

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
Sent: Thursday, September 09, 2004 1:52 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] MrSID Segmentation Fault


On Thu, Sep 09, 2004 at 01:58:04PM -0500, Simpson wrote:
> Did you find the issue?

Yes, it should be fixed now (check out the latest CVS).

> If not, below is another run of gdalinfo compiled with CFG=debug.
>
> I am not adept with gdb, so let me know how/what other data would be
> helpful.

It is completely eniugh for me to get the gdb protocols like the last
one.

						Andrey

> (gdb) run n_16_30_2000c.zu.sid
> Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
>
> Program received signal SIGSEGV, Segmentation fault.
> 0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> (gdb) bt
> #0  0x402f39ca in LizardTech::LTISample::getValueFloat32() const ()
>    from /usr/local/lib/libgdal.so.1
> #1  0x4017252f in MrSIDRasterBand (this=0x805b030, poDS=0x805af20,
nBand=3)
>     at mrsiddataset.cpp:1344
> #2  0x40173d56 in MrSIDDataset::OpenZoomLevel(int) (this=0x805af20,
iZoom=1)
>     at mrsiddataset.cpp:1833
> #3  0x401743af in MrSIDDataset::Open(GDALOpenInfo*)
(poOpenInfo=0xbfff4230)
>     at mrsiddataset.cpp:1933
> #4  0x401b5794 in GDALOpen (pszFilename=0x804ee50 "n_16_30_2000c.zu.sid",
>     eAccess=GA_ReadOnly) at gdalopen.cpp:228
> #5  0x080498b6 in main (argc=2, argv=0x804ecd0) at gdalinfo.c:211
> #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6
>
> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com
> [mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Andrey Kiselev
> Sent: Thursday, September 09, 2004 1:08 PM
> To: gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] MrSID Segmentation Fault
>
>
> On Thu, Sep 09, 2004 at 12:27:27PM -0500, Simpson wrote:
> > Here is gdb output from running gdalinfo against one of the problem
> > MrSID files:
>
> Your gdab output does not contain debug info. To build GDAL with
> debugging information you should whether use the command
>
>  $ CFG=debug make
>
> or just export 'CFG=debug' environment variable in the shell profile.
>
> > (gdb) run n_16_30_2000c.zu.sid
> > Starting program: /usr/local/bin/gdalinfo n_16_30_2000c.zu.sid
> >
> > Program received signal SIGSEGV, Segmentation fault.
> > 0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
> >    from /usr/local/lib/libgdal.so.1
> > (gdb) bt
> > #0  0x40266eda in LizardTech::LTISample::getValueFloat32() const ()
> >    from /usr/local/lib/libgdal.so.1
> > #1  0x4014ff6f in MrSIDRasterBand::MrSIDRasterBand(MrSIDDataset*, int)
()
> >    from /usr/local/lib/libgdal.so.1
> > #2  0x40150f51 in MrSIDDataset::OpenZoomLevel(int) ()
> >    from /usr/local/lib/libgdal.so.1
> > #3  0x4015132b in MrSIDDataset::Open(GDALOpenInfo*) ()
> >    from /usr/local/lib/libgdal.so.1
> > #4  0x40182abd in GDALOpen () from /usr/local/lib/libgdal.so.1
> > #5  0x08049833 in main ()
> > #6  0x42015967 in __libc_start_main () from /lib/i686/libc.so.6
>
> Ok, it seems that I have found and fixed the problem.
>
> Frank, could you post the new anonymous CVS access instructions for
> GDAL?
>
> 						Andrey
>
> --
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>
>

--
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev




From smc+gdal at dogphilosophy.net  Thu Sep  9 20:11:53 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
Message-ID: <200409091811.58019.smc+gdal@dogphilosophy.net>

I hope a "stupid newbie" question doesn't annoy too many people.  

I'm trying to educate myself on the necessary GIS skills and 
knowledge necessary to accomplish just one thing (at the moment):
converting maps and map data from various public ("legally free") 
sources into maps that can be used with the GPSDrive[1] program.  Most
of the sources are not formal GIS data, though (no "world files" included,
etc.)

The "short" version of my question:
Given:  
   A jpeg or png image from a publically available source (terraserver,
topozone, etc.)
   The coordinates (in decimal form) of the center pixel of the map
   The "scale" of the map
   The projection of the source image (nearly always UTM at the moment)

Can someone give me, idiot that I am, an example gdalwarp command line for
converting said image to equirectangular projection?

The "full" version:

GPSDrive supports two different projections:  Equirectangular and "Whatever
maps downloaded from Expedia are in" (I have been annoyingly unsuccessful at
finding out what projection that is - anyone know?  So far all I've gotten is
one person mentioning that they think it may be a miller projection[2] -
judging by the way that UTM maps end up being "off" when given to GPSDrive,
this seems plausible).

I have a variety of "legally free" (i.e. no-cost plus either public domain
or otherwise legally redistributable) sources of maps and map information,
such as the USGS topographical maps and aerial photos, plus NASA satellite
imagery, US Census Bureau "Tiger/LINE" map data, and so on.  I'd like to use
this information to generate custom maps for GPSDrive.

Generating equirectangular maps from raw data is trivial,and working just
fine for me (e.g. zooming in on the NASA "Blue Marble" imagery that GPSDrive
can work with natively, rendering road features atop it from the Tiger/LINE
data, and then adding it to GPSDrive's map files.  Trying to use USGS maps
and aerial photos doesn't work, though, because they're projected as UTM.
(the center of the map is correct, but naturally the further one travels from
center, the further "off" the map is.)

I am unfortunately starting from more-or-less scratch trying to learn what I
need to know to understand what I'm doing here, so I'm not quite sure how easy
it will be to calculate any parameters that I don't already have that I need
to feed to gdalwarp to accomplish what I'm trying to do.  I went searching
for a FAQ of some type that might discuss converting (for example) USGS
"Orthoquads" from online sources with GDAL, but haven't had much luck.
This may very well be because I'm an idiot, but still...

Apologies in advance for sucking up space on the mailing list with what, to 
me, sounds like a really ignorant question, and thanks in advance for any 
assistance anyone can offer.

[1] - http://gpsdrive.kraftvoll.at/
[2] - http://s2.selwerd.nl/~dirk-jan/gpsdrive/archive/msg03568.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040909/99c7882e/attachment.bin
From ed at topozone.com  Thu Sep  9 21:29:46 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CE68@ptolemy.topozone.com>

S -

In order for gdawarp to translate from projection X to projection Y, you
need to be able to completely define both X and Y.  It sounds like X is
not a problem - the "legally free" (see below) maps you describe appear
to be using UTM or some other reputable map projection, even if you
don't know what it is.  But it's not clear what Y - the "projection"
used by GPSDrive - is.

"Equirectangular" actually defines a class of related projections, and
you need a bit more information in order to define it completely - in
particular, an equirectangular projection usually has two standard
parallels, along which the scale is correct.  Do you have this
information for GPSDrive, or can you specify such information to
GPSDrive?

Are you sure that the projection is equirectangular and not "geographic"
or Plate Carree?  For folks who work with vector data and don't care to
worry about projections, Plate Carree is much more common.

These, and the Miller, are all cylindrical projections and related (more
or less) to each other.  Generally speaking, a projection is defined by
a general descriptive style (i.e. the "Equirectangular projection")
along with whatever specific parameters are required to define the
specific instance of that projection (i.e. the "Equirectangular
projection with standard parallels at 30N and 30S").  The latter is what
you need for gdalwarp; the former leaves out essential details without
which you just can't do the math.

UTM, by the way, can be a little misleading.  It's really a class of 60
very similar projections, each of which is a Transverse Mercator
projection with a different central meridian (i.e. "zone number").

If you can find out a few more details I think we can get you on the
right track.

	- Ed

Re: "legally free" - "legally free" and "technically possible" are not
the same term.  I have spoken to GPSDrive developers in the past and
asked that the code which illegally downloads TopoZone data be removed;
automated map download tools can cause a map provider to spend a lot of
money, fast.  Just because you can figure out how to create an image
with an HTTP request doesn't mean that the provider of that image will
permit you to do so, or that you have some inherent right to do so.
TopoZone offers a subscription service by which you can create and
download custom, seamless GeoTIFF UTM georeferenced topographic maps or
aerial photos - you're completely free to do whatever you want with
those images, but they cost a few dollars.  You are not free to download
topographic map images from TopoZone by any other means for use in your
own applications.  Other data providers have different license and
copyright restrictions; please take the time to read the terms of use on
any map provider web site, and please respect those terms of use.  If
you don't like them, that's fine - choose a different provider.  Thanks!

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 978 251-4242   Fax: +1 978 251-1396 

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Thursday, September 09, 2004 8:12 PM
To: 'Gdal-Dev (E-mail)
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps

I hope a "stupid newbie" question doesn't annoy too many people.  

I'm trying to educate myself on the necessary GIS skills and knowledge
necessary to accomplish just one thing (at the moment):
converting maps and map data from various public ("legally free")
sources into maps that can be used with the GPSDrive[1] program.  Most
of the sources are not formal GIS data, though (no "world files"
included,
etc.)

The "short" version of my question:
Given:  
   A jpeg or png image from a publically available source (terraserver,
topozone, etc.)
   The coordinates (in decimal form) of the center pixel of the map
   The "scale" of the map
   The projection of the source image (nearly always UTM at the moment)

Can someone give me, idiot that I am, an example gdalwarp command line
for converting said image to equirectangular projection?

The "full" version:

GPSDrive supports two different projections:  Equirectangular and
"Whatever maps downloaded from Expedia are in" (I have been annoyingly
unsuccessful at finding out what projection that is - anyone know?  So
far all I've gotten is one person mentioning that they think it may be a
miller projection[2] - judging by the way that UTM maps end up being
"off" when given to GPSDrive, this seems plausible).

I have a variety of "legally free" (i.e. no-cost plus either public
domain or otherwise legally redistributable) sources of maps and map
information, such as the USGS topographical maps and aerial photos, plus
NASA satellite imagery, US Census Bureau "Tiger/LINE" map data, and so
on.  I'd like to use this information to generate custom maps for
GPSDrive.

Generating equirectangular maps from raw data is trivial,and working
just fine for me (e.g. zooming in on the NASA "Blue Marble" imagery that
GPSDrive can work with natively, rendering road features atop it from
the Tiger/LINE data, and then adding it to GPSDrive's map files.  Trying
to use USGS maps and aerial photos doesn't work, though, because they're
projected as UTM.
(the center of the map is correct, but naturally the further one travels
from center, the further "off" the map is.)

I am unfortunately starting from more-or-less scratch trying to learn
what I need to know to understand what I'm doing here, so I'm not quite
sure how easy it will be to calculate any parameters that I don't
already have that I need to feed to gdalwarp to accomplish what I'm
trying to do.  I went searching for a FAQ of some type that might
discuss converting (for example) USGS "Orthoquads" from online sources
with GDAL, but haven't had much luck.
This may very well be because I'm an idiot, but still...

Apologies in advance for sucking up space on the mailing list with what,
to me, sounds like a really ignorant question, and thanks in advance for
any assistance anyone can offer.

[1] - http://gpsdrive.kraftvoll.at/
[2] - http://s2.selwerd.nl/~dirk-jan/gpsdrive/archive/msg03568.html

From werchowyna at pf.pl  Fri Sep 10 04:33:14 2004
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal
References: <005a01c495f6$49426d00$09544cd5@podyadeck>
	<1094750289.7106.16.camel@marcy>
Message-ID: <005901c49712$04229fc0$6bc61d3e@podyadeck>

From: "Steve Halasz" <debian@adkgis.org>

> On Wed, 2004-09-08 at 18:47, Maciek Sieczka wrote:
> > hello
> >
> > can somebody tell me if it is safe now to build gdal (cvs) --with-grass?
> > I read some about it but I'm confused
> >
> > I want to make the r.out.gdal in Grass work

> Maciek,
>
> It has worked fine for me. But I don't think it's what you need here.
> gdal --with-grass allows gdal to read grass vectors and rasters. But
> r.out.gdal depends on building grass --with-gdal

as I know it's opposite - r.out.gdal depends on building GDAL --with-grass
like in my case when I didn't do it and I get:

r.out.gdal
(...)
ERROR: GDAL installation does not support GRASS.
    Recompile GDAL libraries to use r.out.gdal


>. I've also found that,
> at least for r.in.gdal, it crashes in grass 5.0 and works fine in grass
> 5.7.
and can somebody say if both r.in.gdal and r.out.gdal work fine in Grass 5.3
CVS after having compiled GDAL --with-grass?

Maciek


From debian at adkgis.org  Fri Sep 10 10:30:54 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal
In-Reply-To: <005901c49712$04229fc0$6bc61d3e@podyadeck>
References: <005a01c495f6$49426d00$09544cd5@podyadeck>
	<1094750289.7106.16.camel@marcy>
	<005901c49712$04229fc0$6bc61d3e@podyadeck>
Message-ID: <1094826654.3810.16.camel@marcy>

On Fri, 2004-09-10 at 04:33, Maciek Sieczka wrote:
> From: "Steve Halasz" <debian@adkgis.org>
> 
> > On Wed, 2004-09-08 at 18:47, Maciek Sieczka wrote:
> > > hello
> > >
> > > can somebody tell me if it is safe now to build gdal (cvs) --with-grass?
> > > I read some about it but I'm confused
> > >
> > > I want to make the r.out.gdal in Grass work
> 
> > Maciek,
> >
> > It has worked fine for me. But I don't think it's what you need here.
> > gdal --with-grass allows gdal to read grass vectors and rasters. But
> > r.out.gdal depends on building grass --with-gdal
> 
> as I know it's opposite - r.out.gdal depends on building GDAL --with-grass
> like in my case when I didn't do it and I get:
> 
> r.out.gdal
> (...)
> ERROR: GDAL installation does not support GRASS.
>     Recompile GDAL libraries to use r.out.gdal

You're right. I didn't realize this was a requirement. It looks like for
grass 5.3 you need to install libgrass before compiling gdal
--with-grass. See:

http://grass.institutoecos.org.br/grass-list/arq/25903.html

Steve


From sholl at gmx.net  Fri Sep 10 11:38:05 2004
From: sholl at gmx.net (Stephan Holl)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 4, Issue 9
In-Reply-To: <20040909185838.17E862BDC3E@xserve.flids.com>
References: <20040909185838.17E862BDC3E@xserve.flids.com>
Message-ID: <20040910173805.2d45573b@localhost>

Hello Steve, 

On Thu,  9 Sep 2004 14:58:38 -0400 (EDT)
gdal-dev-request@xserve.flids.com wrote:

> Try adding /home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib to
> /etc/ld.so.conf and running ldconfig.

Thanks for the suggestion. I already did that, but the same error
appears.

Perhaps there is another reason?!

Thanks in advance.

Stephan


-- 
Stephan Holl

Check headers for GnuPG Key!
http://www.gdf-hannover.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040910/09aa9c4c/attachment.bin
From debian at adkgis.org  Fri Sep 10 12:13:35 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 4, Issue 9
In-Reply-To: <20040910173805.2d45573b@localhost>
References: <20040909185838.17E862BDC3E@xserve.flids.com>
	<20040910173805.2d45573b@localhost>
Message-ID: <1094832815.3810.35.camel@marcy>

On Fri, 2004-09-10 at 11:38, Stephan Holl wrote:
> Hello Steve, 
> 
> On Thu,  9 Sep 2004 14:58:38 -0400 (EDT)
> gdal-dev-request@xserve.flids.com wrote:
> 
> > Try adding /home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib to
> > /etc/ld.so.conf and running ldconfig.
> 
> Thanks for the suggestion. I already did that, but the same error
> appears.
> 

Did you run autoconf after applying the patch?

Steve


From debian at adkgis.org  Fri Sep 10 12:26:31 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 4, Issue 9
In-Reply-To: <1094832815.3810.35.camel@marcy>
References: <20040909185838.17E862BDC3E@xserve.flids.com>
	<20040910173805.2d45573b@localhost>  <1094832815.3810.35.camel@marcy>
Message-ID: <1094833591.3810.41.camel@marcy>

Stephan,

Where did you get the patch? I suspect it is out of date. Try replacing
grassdataset.cpp with:

http://mpa.itc.it/radim/qgis/gdal/grassdataset.cpp3

And be sure you are using this patch for configure.in:

http://mpa.itc.it/radim/qgis/gdal/configure.in.patch2

Steve

On Fri, 2004-09-10 at 12:13, Steve Halasz wrote:
> On Fri, 2004-09-10 at 11:38, Stephan Holl wrote:
> > Hello Steve, 
> > 
> > On Thu,  9 Sep 2004 14:58:38 -0400 (EDT)
> > gdal-dev-request@xserve.flids.com wrote:
> > 
> > > Try adding /home/steph/cvs/grass57_cvs/dist.i686-pc-linux-gnu/lib to
> > > /etc/ld.so.conf and running ldconfig.
> > 
> > Thanks for the suggestion. I already did that, but the same error
> > appears.
> > 
> 
> Did you run autoconf after applying the patch?
> 
> Steve
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From smc+gdal at dogphilosophy.net  Fri Sep 10 15:12:57 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CE68@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CE68@ptolemy.topozone.com>
Message-ID: <200409101912.i8AJC86j002203@www.dogphilosophy.net>

On Thursday 09 September 2004 07:29 pm, Ed McNierney wrote:
> In order for gdawarp to translate from projection X to projection Y, you
> need to be able to completely define both X and Y.  It sounds like X is
> not a problem - the "legally free" (see below) maps you describe appear
> to be using UTM or some other reputable map projection, even if you
> don't know what it is.  But it's not clear what Y - the "projection"
> used by GPSDrive - is.
[...]
Short answer - there are two.  "Geographic" or "Plate Caree'" MAY be
the correct term for what GPSDrive inaccurately refers to as "topo"
maps for historical reasons.  The other is "Whatever expedia maps are, which 
may or may not be a miller projection".

> "Equirectangular" actually defines a class of related projections, and
> you need a bit more information in order to define it completely - in
> particular, an equirectangular projection usually has two standard
> parallels, along which the scale is correct.  Do you have this
> information for GPSDrive, or can you specify such information to
> GPSDrive?
[...]
What I'm referring to (quite possibly incorrectly) as "equirectangular" is a 
result of adding support for a set of NASA "Blue Marble" satellite data to
GPSDrive.  This data has the following characteristics:

It is a rendered image of satellite photo data of the entire globe.  The data 
is separated into two data sets ("Eastern" and "Western" hemispheres).  The
"Western" hemisphere dataset is 21600x21600x24bit data, covering 90.00,-180.00 
to -90.00,0.00.  Each pixel, regardless of where in the 21600x21600 square it 
is, covers 0.0083333[...] by 0.008333[...] degrees.  While that distorts 
distances pretty severely in places, I like it because it's extremely easy to 
work with in program code.  Is that enough information to determine what the
proper name for the (pseudo-)projection should be?

My interest in the other "Miller or whatever Expedia is" projection is just
because I figure at times I may find it's less distorting when it matters to
me.

> UTM, by the way, can be a little misleading.  It's really a class of 60
> very similar projections, each of which is a Transverse Mercator
> projection with a different central meridian (i.e. "zone number").

Put that way, it makes a little more sense - I knew about the "every 6 degrees
is a different zone" but it hadn't sunk into my thick skull that each one was
technically a different projection.  Southeastern Idaho, where I'm stuck at 
the moment, should be zone 12 if I'm counting right (and I've thus far got:
-s_srs '+proj=utm +zone=12 +datum=WGS84'
as part of the gdalwarp command line... )

> Re: "legally free" - "legally free" and "technically possible" are not
> the same term.  I have spoken to GPSDrive developers in the past and
> asked that the code which illegally downloads TopoZone data be removed;
[...]
Yup, Topozone.com downloads were removed some months ago - just as well, since
being UTM the downloaded maps never quite lined up except right at the center.

I agree completely here - that's actually a primary driving reason behind my
interest in learning to obtain, generate, and possibly redistribute my own
maps in a genuinely legally free manner.  (I use the term "legally free" to
emphasize the difference - too many people think that, for example, Microsoft
Windows is "free" because they were able to borrow the install disks from 
work...)  While my reading of the expedia terms of service didn't seem to 
actually forbid automated downloads, and did seem to permit any reasonable 
"personal, non-commercial use" (which to my mind would include using them
in GPSDrive), they are still not genuinely "free", and yet they are 
currently the only "built-in" automatic download in GPSDrive.  I'd much
rather avoid risking a lawsiege from Microsoft lawyers for copyright
infringement by generating my own maps.

(If I get it all figured out, a HOWTO document will hopefully follow...)

Incidentally, looking at the "Topozone Pro" page, it appears to be an
all-you-can-eat sort of subscription (i.e. pay $49.95 and use it as
much as you want for a year) rather than a per-use service, is that
accurate?  If so, is it possible and reasonable to use THAT service from
an automated, custom-designed program rather than only being able to 
use it "by hand" or via ESRI(tm)-brand ArcProduct for Microsoft(r)
Windows(r)?  (Hey, being able to download the more recent color
aerial photo imagery on demand via a script for use in GPSDrive alone
would just about be worth that to me...)

Thanks for the help!

Sean

From sholl at gmx.net  Fri Sep 10 15:30:10 2004
From: sholl at gmx.net (Stephan Holl)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 4, Issue 9
In-Reply-To: <1094833591.3810.41.camel@marcy>
References: <20040909185838.17E862BDC3E@xserve.flids.com>
	<20040910173805.2d45573b@localhost>
	<1094832815.3810.35.camel@marcy> <1094833591.3810.41.camel@marcy>
Message-ID: <20040910213010.35ec4af2@localhost>

Hello Steve, 

On Fri, 10 Sep 2004 12:26:31 -0400 Steve Halasz <debian@adkgis.org>
wrote:

> Stephan,
> 
> Where did you get the patch? I suspect it is out of date. Try
> replacing grassdataset.cpp with:
> 
> http://mpa.itc.it/radim/qgis/gdal/grassdataset.cpp3
> 
> And be sure you are using this patch for configure.in:
> 
> http://mpa.itc.it/radim/qgis/gdal/configure.in.patch2

finally I did a fresh checkout, applied the above mentioned patches
again, run autoconf, ./configure and make.
Everything went fine now. Mystery things are going on...

Anyway, thanks for your help!

Cheers
	Stephan



-- 
Stephan Holl

Check headers for GnuPG Key!
http://www.gdf-hannover.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040910/7733859c/attachment.bin
From smc+gdal at dogphilosophy.net  Fri Sep 10 17:09:50 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CE95@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CE95@ptolemy.topozone.com>
Message-ID: <200409101509.50822.smc+gdal@dogphilosophy.net>

On Friday 10 September 2004 01:36 pm, you wrote:
> It sounds like (based on the NASA example you gave) you're looking at a
> very simple "geographic" projection.  Does GPSDrive require a specific
> pixel resolution(i.e. do all images need to use the NASA resolution)?
> Does it read GeoTIFF tags, world files, or any of the standard ways of
> specifying that information?  If not, how do you know what the map
> resolution is?  That's the only extra bit of info that completely
> specifies an image in geographic projection.

Oops, knew I was missing a piece of information - yes the maps can
be at different "scales" (I still don't quite "get" scale when it comes
to digital maps...)  GPSDrive only reads plain image files (along with
the reading the latitude and longitude of the center of the image and
the images' "scale" from a supplementary text file) of any type readable
by the GTK libraries.  I believe that GTK can read TIFF type files, but 
I'm pretty sure none of the extra infromation in GeoTIFF files is used.
GPSDrive further requires that the images be exactly 1280x1024.

In its existing state, GPSDrive gives the "scale" of the Blue Marble
satellite imagery as 1:2614061.  I have successfully generated and used
maps at other "scales", using custom code to create a "zoomed" image of
the Blue Marble data and superimposing line features from the Tiger/LINE 2003
data atop it, and they show up correctly in GPSDrive at every "scale".

Incidentally, CAN you confirm or refute the idea that Expedia's maps
are in a "miller" projection (and therefore if I warp my own map images
to that form, they will work correctly as "map_*" files in GPSDrive...)?
So far I've not been able to find anyone who knows for sure, though I suppose
I can find out myself quickly enough once I've gotten the gdalwarp process
worked out.

Thanks again

Sean

From ed at topozone.com  Fri Sep 10 21:43:55 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEAF@ptolemy.topozone.com>

Sean -

Is that "supplementary text file" an ESRI-format world file?  If so, it
would be a text file with six lines in it, each of which contains a
number - and the second and third lines are almost certainly 0.0.

If that's the case, then the first and fourth lines will contain the X
pixel size and the Y pixel size, in units of degrees.  The fifth and
sixth lines are the X and Y coordinates of the upper-left corner of the
image (also in degrees).  Does that look right?

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 978 251-4242   Fax: +1 978 251-1396  

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Friday, September 10, 2004 5:10 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive
maps

On Friday 10 September 2004 01:36 pm, you wrote:
> It sounds like (based on the NASA example you gave) you're looking at 
> a very simple "geographic" projection.  Does GPSDrive require a 
> specific pixel resolution(i.e. do all images need to use the NASA
resolution)?
> Does it read GeoTIFF tags, world files, or any of the standard ways of

> specifying that information?  If not, how do you know what the map 
> resolution is?  That's the only extra bit of info that completely 
> specifies an image in geographic projection.

Oops, knew I was missing a piece of information - yes the maps can be at
different "scales" (I still don't quite "get" scale when it comes to
digital maps...)  GPSDrive only reads plain image files (along with the
reading the latitude and longitude of the center of the image and the
images' "scale" from a supplementary text file) of any type readable by
the GTK libraries.  I believe that GTK can read TIFF type files, but I'm
pretty sure none of the extra infromation in GeoTIFF files is used.
GPSDrive further requires that the images be exactly 1280x1024.

In its existing state, GPSDrive gives the "scale" of the Blue Marble
satellite imagery as 1:2614061.  I have successfully generated and used
maps at other "scales", using custom code to create a "zoomed" image of
the Blue Marble data and superimposing line features from the Tiger/LINE
2003 data atop it, and they show up correctly in GPSDrive at every
"scale".

Incidentally, CAN you confirm or refute the idea that Expedia's maps are
in a "miller" projection (and therefore if I warp my own map images to
that form, they will work correctly as "map_*" files in GPSDrive...)?
So far I've not been able to find anyone who knows for sure, though I
suppose I can find out myself quickly enough once I've gotten the
gdalwarp process worked out.

Thanks again

Sean
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From ed at topozone.com  Fri Sep 10 22:17:04 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB0@ptolemy.topozone.com>

Sean -

As for the Expedia projection, it is NOT a Miller projection - at least
not at small scales.  My bet is that it is a simple orthographic
projection, with the central meridian and the latitude of origin both
set to the coordinates of the center point on the current map view.  I
cannot confirm that this projection doesn't change when you zoom in, but
I don't see any reason why it would need to do so.

Pick an Expedia map and zoom out as far as you can.  Note that the outer
limit of the projected Earth appears to be a circle - a big hint right
there.  Note that the meridian lines (not shown, but many US states have
convenient east-west boundaries) curve up towards the top of the map and
down towards the bottom.  Now use the scroll buttons to spin the globe
around.  The projection behaves reasonably and always appears least
distorted at the center, meaning that the projection parameters change
as the map center changes.  Also note that the projections behave nicely
at the poles as you scroll around.

The orthographic is simple to use and implement, and it makes maps most
people consider "nice" at small scales.  It is what the Earth would look
like if viewed from an infinite distance (with, of course, infinite
magnification to go with it).  The scale bars displayed on Expedia maps
are a little bogus - they probably show the scale at the center of the
map, but orthographic maps don't preserve distances; the distances at
the edges of the circle are badly distorted.  But when zoomed in this is
relatively irrelevant.

So if you're going to work with Expedia maps - and if my guess is
correct - then you will need to know the latitude and longitude of the
center point of each map.  You might want to see if GPSDrive works
correctly with small-scale Expedia maps, where assumptions that might
work for large scales will begin to break down.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 978 251-4242   Fax: +1 978 251-1396  

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Friday, September 10, 2004 5:10 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive
maps

On Friday 10 September 2004 01:36 pm, you wrote:
> It sounds like (based on the NASA example you gave) you're looking at 
> a very simple "geographic" projection.  Does GPSDrive require a 
> specific pixel resolution(i.e. do all images need to use the NASA
resolution)?
> Does it read GeoTIFF tags, world files, or any of the standard ways of

> specifying that information?  If not, how do you know what the map 
> resolution is?  That's the only extra bit of info that completely 
> specifies an image in geographic projection.

Oops, knew I was missing a piece of information - yes the maps can be at
different "scales" (I still don't quite "get" scale when it comes to
digital maps...)  GPSDrive only reads plain image files (along with the
reading the latitude and longitude of the center of the image and the
images' "scale" from a supplementary text file) of any type readable by
the GTK libraries.  I believe that GTK can read TIFF type files, but I'm
pretty sure none of the extra infromation in GeoTIFF files is used.
GPSDrive further requires that the images be exactly 1280x1024.

In its existing state, GPSDrive gives the "scale" of the Blue Marble
satellite imagery as 1:2614061.  I have successfully generated and used
maps at other "scales", using custom code to create a "zoomed" image of
the Blue Marble data and superimposing line features from the Tiger/LINE
2003 data atop it, and they show up correctly in GPSDrive at every
"scale".

Incidentally, CAN you confirm or refute the idea that Expedia's maps are
in a "miller" projection (and therefore if I warp my own map images to
that form, they will work correctly as "map_*" files in GPSDrive...)?
So far I've not been able to find anyone who knows for sure, though I
suppose I can find out myself quickly enough once I've gotten the
gdalwarp process worked out.

Thanks again

Sean
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From smc+gdal at dogphilosophy.net  Fri Sep 10 22:19:51 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEAF@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEAF@ptolemy.topozone.com>
Message-ID: <200409102019.51729.smc+gdal@dogphilosophy.net>

No, 'fraid not.  I was referring to the "map_koord.txt" file that
goes with GPSDrive and contains 4 fields per line:
(filename) (center latitude) (center longitude) ("scale")

for every map image file that GPSDrive is to try to use.
That's, effectively, about all of the information I have for
most of these images (other than the projection type of the source [usually
UTM] and target [geographic/equirectangular/whatever, or miller(?)] images,
and the fact that the image is always 1280x1024 pixels).

If it helps, here's what I'm attempting so far:

/usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=WGS84 +k=0.9996' -t_srs 
'+proj=eqc +lat_ts=42.94584 +lon_0=-113.2167 +datum=WGS84' 
map_42.94584_-113.2167_5512.jpeg top_kings_bowl.jpg
ERROR 1: Unable to compute a transformation between pixel/line
and georeferenced coordinates for map_42.94584_-113.2167_5512.jpeg.
There is no affine transformation and no GCPs.

Obviously, there's information missing that I need to supply to 
gdalwarp, but I'm neither sure exactly what information, nor how
it's labeled in the *_srs fields...
(The example above is a Terraserver aerial photo of the "King's Bowl" 
crater in southeastern Idaho, near American Falls.  The filename
containing coordinates and scale is just a convention I've adopted
to make remembering what they are easier, and doesn't matter to
GPSDrive.)

If it helps, I DON'T intend to change the map "scale", merely to warp 
the image to match either geographic/equirectangular/plate caree or
"whatever expedia is, possibly Miller" projection.

Getting the X and Y coordinates of the ORIGINAL (non-geographic) image's
upper-left corner seems to be a sticking point - I gather that's not
a straightforward proposition for most projections.  On the other hand, 
calculating the upper-left X and Y for the "target" geographic-projection
image is trivial.  If I can supply that for the target, will gdalwarp
be able to back-calculate the the coordinates for the original
(usually UTM) source image was, given that the scale doesn't change?

For calculating the parameters of what I've been calling the "equirectangular"
image ("top_*" in GPSDrive), here a snippet of the code I've been using
successfully:
-----------------------------------
$degpixel = floatval($scale/313687320); 
//degrees/pixel for equirectangular map (calc'd from GPSDrive code)
$lat=floatval($lat);
$lon=floatval($lon);
$ullon=$lon-($degpixel*640);  //upper-left longitude boundary
$ullat=$lat+($degpixel*512);  //upper-left latitude boundary
$lrlon=$lon+($degpixel*640);  //lower-right longitude boundary
$lrlat=$lat-($degpixel*512);  //lower-right latitude boundary
-----------------------------------

Thanks (yet again),

Sean

On Friday 10 September 2004 07:43 pm, you wrote:
> Sean -
>
> Is that "supplementary text file" an ESRI-format world file?  If so, it
> would be a text file with six lines in it, each of which contains a
> number - and the second and third lines are almost certainly 0.0.
>
> If that's the case, then the first and fourth lines will contain the X
> pixel size and the Y pixel size, in units of degrees.  The fifth and
> sixth lines are the X and Y coordinates of the upper-left corner of the
> image (also in degrees).  Does that look right?
>
>  - Ed

From ed at topozone.com  Fri Sep 10 22:50:25 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB1@ptolemy.topozone.com>

Sean -

OK, let's bark up that tree for a minute.  We can figure out how to
generate the map_koord.txt file once we figure out the projection stuff.
What units does the scale appear to use?  Is the scale number very small
for "typical" maps?  If so, it's probably in degrees.  Otherwise my next
guess would be meters.

As far as your gdalwarp command line goes, you're missing the
information that would be found in the world file; you need to create a
file for your TerraServer source JPEG.  This file has the same root name
as the image, with the extension .WLD or .JGW (either is OK).

Are you retrieving the TerraServer images using the TerraServer
"Download" service?  If so, you can download world files, too (see menu
on the left, instructions below the image).  If you're retrieving the
TerraServer image through some other interface, then you must be passing
coordinates with that request and you can construct the world file from
the parameters you're using.  Let us know how you're getting the source
image, and we can at least complete the source image half of the
equation.

	- Ed  

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Friday, September 10, 2004 10:20 PM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive
maps

No, 'fraid not.  I was referring to the "map_koord.txt" file that goes
with GPSDrive and contains 4 fields per line:
(filename) (center latitude) (center longitude) ("scale")

for every map image file that GPSDrive is to try to use.
That's, effectively, about all of the information I have for most of
these images (other than the projection type of the source [usually UTM]
and target [geographic/equirectangular/whatever, or miller(?)] images,
and the fact that the image is always 1280x1024 pixels).

If it helps, here's what I'm attempting so far:

/usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=WGS84 +k=0.9996'
-t_srs '+proj=eqc +lat_ts=42.94584 +lon_0=-113.2167 +datum=WGS84' 
map_42.94584_-113.2167_5512.jpeg top_kings_bowl.jpg ERROR 1: Unable to
compute a transformation between pixel/line and georeferenced
coordinates for map_42.94584_-113.2167_5512.jpeg.
There is no affine transformation and no GCPs.

Obviously, there's information missing that I need to supply to
gdalwarp, but I'm neither sure exactly what information, nor how it's
labeled in the *_srs fields...
(The example above is a Terraserver aerial photo of the "King's Bowl" 
crater in southeastern Idaho, near American Falls.  The filename
containing coordinates and scale is just a convention I've adopted to
make remembering what they are easier, and doesn't matter to
GPSDrive.)

If it helps, I DON'T intend to change the map "scale", merely to warp
the image to match either geographic/equirectangular/plate caree or
"whatever expedia is, possibly Miller" projection.

Getting the X and Y coordinates of the ORIGINAL (non-geographic) image's
upper-left corner seems to be a sticking point - I gather that's not a
straightforward proposition for most projections.  On the other hand,
calculating the upper-left X and Y for the "target"
geographic-projection image is trivial.  If I can supply that for the
target, will gdalwarp be able to back-calculate the the coordinates for
the original (usually UTM) source image was, given that the scale
doesn't change?

For calculating the parameters of what I've been calling the
"equirectangular"
image ("top_*" in GPSDrive), here a snippet of the code I've been using
successfully:
-----------------------------------
$degpixel = floatval($scale/313687320); //degrees/pixel for
equirectangular map (calc'd from GPSDrive code) $lat=floatval($lat);
$lon=floatval($lon); $ullon=$lon-($degpixel*640);  //upper-left
longitude boundary $ullat=$lat+($degpixel*512);  //upper-left latitude
boundary $lrlon=$lon+($degpixel*640);  //lower-right longitude boundary
$lrlat=$lat-($degpixel*512);  //lower-right latitude boundary
-----------------------------------

Thanks (yet again),

Sean

On Friday 10 September 2004 07:43 pm, you wrote:
> Sean -
>
> Is that "supplementary text file" an ESRI-format world file?  If so, 
> it would be a text file with six lines in it, each of which contains a

> number - and the second and third lines are almost certainly 0.0.
>
> If that's the case, then the first and fourth lines will contain the X

> pixel size and the Y pixel size, in units of degrees.  The fifth and 
> sixth lines are the X and Y coordinates of the upper-left corner of 
> the image (also in degrees).  Does that look right?
>
>  - Ed
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From smc+gdal at dogphilosophy.net  Fri Sep 10 22:54:07 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp, expedia, and GPSDrive
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB0@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB0@ptolemy.topozone.com>
Message-ID: <200409102054.07703.smc+gdal@dogphilosophy.net>

On Friday 10 September 2004 08:17 pm, you wrote:
> As for the Expedia projection, it is NOT a Miller projection - at least
> not at small scales.  My bet is that it is a simple orthographic
> projection, with the central meridian and the latitude of origin both
> set to the coordinates of the center point on the current map view.
[...]
> So if you're going to work with Expedia maps - and if my guess is
> correct - then you will need to know the latitude and longitude of the
> center point of each map.  You might want to see if GPSDrive works
> correctly with small-scale Expedia maps, where assumptions that might
> work for large scales will begin to break down.

Last time I checked the expedia maps in GPSDrive (some time ago - I 
haven't been using them for a while due to copyright restrictions 
imposed by the Expedia terms of use) they seemed to work at scales
down around 1:5000 or so, at least.  I don't THINK that's changed at
all.  (I'm not actually planning to work with expedia maps themselves, 
I just want to be able to make "expedia-compatible" maps in the same
format, so that they work with GPSDrive...)

The latitude and longitude of the center point on the map is one of 
the few facts that I *DO* have readily available for every image I've
been downloading.

Would it be possible then, just with the information mentioned thus
far, to give me an example "convert a UTM map with a known center latitude and 
longitude and scale to an orthographic map with the same center 
latitude/longitude and the same scale" command line for gdalwarp?  Or
do I still need to calculate further bits of information to feed gdalwarp
before it can work?

I've just tried:

/usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=WGS84 +k=0.9996 
+lat_0=0.000 +lon_0=-113.2167' -t_srs '+proj=ortho +lat_0=42.94584 
+lon_0=-113.2167 +datum=WGS84' map_42.94584_-113.2167_5512.jpeg 
map_kings_bowl.jpg

And still get the "no affine transformation and no GCPs".  

Presumably, to give it "Ground Control Points" I need to somehow specify at
least either the upper-left pixel's lat/lon, or perhaps there's a way I can
feed gdalwarp the "scale" and have it calculate that, in addition to the
lat/lon of the center point?

Sean

From ed at topozone.com  Fri Sep 10 23:00:51 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp, expedia, and GPSDrive
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB2@ptolemy.topozone.com>

Sean -

Read my last message about missing info for the source image.  Stop
adding parameters to the -s_srs object; you're confusing the properties
of the data set (the image) with the properties of the projection.  For
the UTM projection as your s_srs, zone= and datum= should be the only
properties you need.

Your UTM map will not have a center point (or upper-left point) with
coordinates expressed in degrees, as the units for that projection are
meters, not degrees.  That's fine - you'll create that in the world file
and gdalwarp will take care of the rest.

	- Ed 

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Friday, September 10, 2004 10:54 PM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] gdalwarp, expedia, and GPSDrive

On Friday 10 September 2004 08:17 pm, you wrote:
> As for the Expedia projection, it is NOT a Miller projection - at 
> least not at small scales.  My bet is that it is a simple orthographic

> projection, with the central meridian and the latitude of origin both 
> set to the coordinates of the center point on the current map view.
[...]
> So if you're going to work with Expedia maps - and if my guess is 
> correct - then you will need to know the latitude and longitude of the

> center point of each map.  You might want to see if GPSDrive works 
> correctly with small-scale Expedia maps, where assumptions that might 
> work for large scales will begin to break down.

Last time I checked the expedia maps in GPSDrive (some time ago - I
haven't been using them for a while due to copyright restrictions
imposed by the Expedia terms of use) they seemed to work at scales down
around 1:5000 or so, at least.  I don't THINK that's changed at all.
(I'm not actually planning to work with expedia maps themselves, I just
want to be able to make "expedia-compatible" maps in the same format, so
that they work with GPSDrive...)

The latitude and longitude of the center point on the map is one of the
few facts that I *DO* have readily available for every image I've been
downloading.

Would it be possible then, just with the information mentioned thus far,
to give me an example "convert a UTM map with a known center latitude
and longitude and scale to an orthographic map with the same center
latitude/longitude and the same scale" command line for gdalwarp?  Or do
I still need to calculate further bits of information to feed gdalwarp
before it can work?

I've just tried:

/usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=WGS84 +k=0.9996 
+lat_0=0.000 +lon_0=-113.2167' -t_srs '+proj=ortho +lat_0=42.94584
+lon_0=-113.2167 +datum=WGS84' map_42.94584_-113.2167_5512.jpeg
map_kings_bowl.jpg

And still get the "no affine transformation and no GCPs".  

Presumably, to give it "Ground Control Points" I need to somehow specify
at least either the upper-left pixel's lat/lon, or perhaps there's a way
I can feed gdalwarp the "scale" and have it calculate that, in addition
to the lat/lon of the center point?

Sean
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From smc+gdal at dogphilosophy.net  Fri Sep 10 23:18:17 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Help a stupid GIS newbie: gdalwarp for GPSDrive maps
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB1@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB1@ptolemy.topozone.com>
Message-ID: <200409102118.17656.smc+gdal@dogphilosophy.net>

On Friday 10 September 2004 08:50 pm, you wrote:
> [...]  We can figure out how to generate the map_koord.txt file once we
> figure out the projection stuff.  What units does the scale appear to use? 
> Is the scale number very small for "typical" maps?  If so, it's probably in
> degrees.  Otherwise my next guess would be meters.
I still don't "get" what the scale is - it's not EXACTLY 'meters/pixel' but it
seems to be related to that measure.  Here's the snippet of code from the
GPSDrive source that talks about what the map "scale" means:

/* Mapscale / pixelfact is meter / pixel */
#define PIXELFACT 2817.947378

I don't know how or why that 2817.947378 number comes in there, but
scale does at least relate to "meters/pixel". (GPSDrive's "scale" is
meters/pixel * 2817.947378....)

The map_koord.txt part is easy - I've already got code that generates lines
for that for the geographic-projection maps I'm generating from the NASA 
Blue Marble imagery and US Census Bureau Tiger/LINE data.  

> As far as your gdalwarp command line goes, you're missing the
> information that would be found in the world file; you need to create a
> file for your TerraServer source JPEG.  This file has the same root name
> as the image, with the extension .WLD or .JGW (either is OK).
>
> Are you retrieving the TerraServer images using the TerraServer
> "Download" service?  If so, you can download world files, too (see menu
> on the left, instructions below the image).  If you're retrieving the
> TerraServer image through some other interface, then you must be passing
> coordinates with that request and you can construct the world file from
> the parameters you're using.  Let us know how you're getting the source
> image, and we can at least complete the source image half of the
> equation.

When fetching from terraserver, I use an URL I found within Kismet's
map-generation code (The war-driving application Kismet includes a
program that can render network signal strength atop a map, so you
can check and/or interpolate the coverage of your wireless access
point...)

http://terraservice.net/GetImageArea.ashx?t=1&lat=$lat&lon=$lon&s=$scaleIdx&w=1280&h=1024

Where "t=1" specifies an aerial photo ("t=2" gives a USGS topo map), and
"$scaleIdx" is a number from, for some reason, 10 to 16:
10=2757
11=5512
12=11024
13=22048
14=44096
15=88182
16=176384
(the number on the right being what GPSDrive considers to be the resulting
1280x1024 image's "scale")

Does that help at all?

From smc+gdal at dogphilosophy.net  Fri Sep 10 23:50:00 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Almost got it - I'm learning.
In-Reply-To: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB2@ptolemy.topozone.com>
References: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB2@ptolemy.topozone.com>
Message-ID: <200409102150.00415.smc+gdal@dogphilosophy.net>

OKAY - several facts are falling into place in my ignorant brain now.
(It's like an intellectual trepanning - a hole has been poked in my
mind to let the ignorance out...)

1.)UTM coordinates aren't latitude/longitude degrees.  (And
everyone else on the list, who probably knows what they are
doing, are now slapping their heads and saying "duh"...)

2.)I cannot provide the 'world file' information as part of the 
command line (didn't realize that.  No problem, I dug up
the format of the world file and can generate one, once I know
how to calculate the facts that I need to put in it from the
facts that I have...)

3.)I need to figure out how to calculate "easting" and "northing"
for a particular UTM zone (I already know how to calculate which
zone I am in.)

Seems like the only thing left that I need to figure out is how
to calculate the "easting" and "northing" of the upper-left
pixel of the map from the latitude and longitude degrees of 
the map center and the "scale" (or meters/pixel, which I can 
derive from the "scale").

I'll see if I can get that figured out tonight.  If all goes
well, sometime in the next day or so I'll be back to post "Whee!
I've got it!"...

Thanks once more

Sean

On Friday 10 September 2004 09:00 pm, you wrote:
> Sean -
>
> Read my last message about missing info for the source image.  Stop
> adding parameters to the -s_srs object; you're confusing the properties
> of the data set (the image) with the properties of the projection.  For
> the UTM projection as your s_srs, zone= and datum= should be the only
> properties you need.
>
> Your UTM map will not have a center point (or upper-left point) with
> coordinates expressed in degrees, as the units for that projection are
> meters, not degrees.  That's fine - you'll create that in the world file
> and gdalwarp will take care of the rest.

From ed at topozone.com  Sat Sep 11 09:14:32 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Almost got it - I'm learning.
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CEB4@ptolemy.topozone.com>

Sean -

Go to TerraServer, where you will find documentation on how to construct
the URL request you're using.  Their assumption is that you know the UTM
coordinates and need to convert that to URL querystring parameters, but
it's a very simple transformation and you can calculate the reverse.  If
you know  the TerraServer image-fetch querystring, you DO know the UTM
coordinates.

	- Ed

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Friday, September 10, 2004 11:50 PM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] Almost got it - I'm learning.

OKAY - several facts are falling into place in my ignorant brain now.
(It's like an intellectual trepanning - a hole has been poked in my mind
to let the ignorance out...)

1.)UTM coordinates aren't latitude/longitude degrees.  (And everyone
else on the list, who probably knows what they are doing, are now
slapping their heads and saying "duh"...)

2.)I cannot provide the 'world file' information as part of the command
line (didn't realize that.  No problem, I dug up the format of the world
file and can generate one, once I know how to calculate the facts that I
need to put in it from the facts that I have...)

3.)I need to figure out how to calculate "easting" and "northing"
for a particular UTM zone (I already know how to calculate which zone I
am in.)

Seems like the only thing left that I need to figure out is how to
calculate the "easting" and "northing" of the upper-left pixel of the
map from the latitude and longitude degrees of the map center and the
"scale" (or meters/pixel, which I can derive from the "scale").

I'll see if I can get that figured out tonight.  If all goes well,
sometime in the next day or so I'll be back to post "Whee!
I've got it!"...

Thanks once more

Sean

On Friday 10 September 2004 09:00 pm, you wrote:
> Sean -
>
> Read my last message about missing info for the source image.  Stop 
> adding parameters to the -s_srs object; you're confusing the 
> properties of the data set (the image) with the properties of the 
> projection.  For the UTM projection as your s_srs, zone= and datum= 
> should be the only properties you need.
>
> Your UTM map will not have a center point (or upper-left point) with 
> coordinates expressed in degrees, as the units for that projection are

> meters, not degrees.  That's fine - you'll create that in the world 
> file and gdalwarp will take care of the rest.
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From carueda at ucdavis.edu  Sat Sep 11 20:25:25 2004
From: carueda at ucdavis.edu (Carlos A. Rueda)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalinfo --formats reports envi but doesn't read an envi
Message-ID: <41439775.4040309@ucdavis.edu>

Hello,

I'm having this strange behaviour:

    machine-1> gdalinfo --formats
    ...
    ENVI (rw): ENVI .hdr Labelled
    ...

but:
    machine-1> gdalinfo envi_image1.bsq
    ERROR 4: `envi_image1.bsq' not recognised as a supported file format.

    GDALOpen failed - 4
    `envi_image1.bsq' not recognised as a supported file format.

Of course, envi_image1.bsq *is* an envi standard image.
In fact, if I run the gdalinfo command from a different machine
(let's call it machine-2), it just works fine. The interesting thing
is that the binary I'm running is the same on both machines (through
networked directories).  Some details about the machines:

machine-1:  (debian) linux 2.4.18-bf2.4,
machine-2:  (debian) linux 2.4.18,

I compiled GDAL from cvs in machine-2.  LD_LIBRARY_PATH points to
the same location where the different dependencies (libraries) were
installed before running gdalinfo.

Even more interesting is that on machine-1 (where the above example
fails) the command succeeds for other essentially similar envi images ...

Any ideas?

thanks.

carlos



From smc+gdal at dogphilosophy.net  Sun Sep 12 15:00:28 2004
From: smc+gdal at dogphilosophy.net (S Clark)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GPSDrive Success! (Partial, labor-intensive...)
Message-ID: <200409121300.29030.smc+gdal@dogphilosophy.net>

Quick recap:  I'm attempting to learn to convert various map images,
starting with UTM map images, to one of the two projections supported
by GPSDrive.  At present, the image sources I am using give me only
the following pieces of information:

1)Latitude and Longitude of the center point of the image
2)A "scale", which appears to related to meters/pixel
3)A known image size, required to be 1280x1024 pixels
4)The projection of the source image (currently UTM)

I was able to SUCCESSFULLY convert the previously mentioned Terraserver image
of the "King's Bowl" crater (crater itself is at 42.94944 -113.21637, if
anyone wants to look up a picture of it) such that it is scaled and positioned
correctly in GPSDrive.  I've still got a ways to go to learn what I need, as
there is still a great deal of manual intervention required at the last step,
but here's what I've got so far:

1)Create a "world file" to go with the source image, using the small amount of 
information available for the image:
   A)Calculate the meters/pixel of the image - conversion from the "map scale"
   of GPSDrive, according to the GPSDrive source code gives the formula for   
   this as "map scale/2817.947378".  This gives 1.956033687155673 m/pixel
   for the "scale 5512" original image.

   B)use the 'proj' command (from the proj.4 project) to calculate the
   "easting" and "northing":
      proj +proj=utm +lon_0=(lon of image center) +ellps=WGS84 -r << EOF
      > 42.94584 -113.2167
      > EOF
      319158.52       4757184.46

   C)Create the world file (in this case, named    
   map_42.94584_-113.2167_5512.jgw):
      1.956033687155673
      0
      0
      -1.956033687155673
      319158.52
      4757184.46

2)use gdalwarp to convert the image
(NOTE: GPSDrive "top_*" images should be "latlong".  "map_*" images
MAY be Orthographic [unconfirmed])
(QUESTION: What's the difference between "eqc" (Equirectangular) and 
"latlon" ("Geographic")?)
   A)calculate the UTM zone (floor(abs(-180.000-$image_center_longitude)/6))
   B)gdalwarp to a .bmp (imagemagick appears to have trouble with GeoTIFF)
      /usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=NAD83 +x0=500000' 
-t_srs '+proj=latlong +datum=WGS84' -of bmp map_42.94584_-113.2167_5512.jpeg 
top_kings_bowl.bmp
      Creating output file is that 1432P x 851L.
      ERROR 6: Dataset does not support the SetProjection() method.
      :0...10...20...30...40...50...60...70...80...90...100 - done.
(PROBLEM: gdalwarp couldn't convert to ortho: "too many pixels failed to
transform (441 of 441)")

   C)convert the image to 1280x1024 without changing the center or rescaling
   or warping the map
      i)for undersized height or width, add equal-sized blank borders to
      both sides of the undersized dimension
      ii)for oversized height/width, cut out an appropriately-sized center

      mogrify -border 0x87 -crop 1280x1024+76+0 top_kings_bowl.bmp

3)Add the image to GPSDrive
   A)Copy image to ~/.gpsdrive or wherever GPSDrive looks for images
   B)Add the image to map_koord.txt
      top_kings_bowl.bmp 42.94584 -113.2167 5512
   C)(The worst part right now) - fiddle with the "scale" until the map    
   actually works right.  By trial and error (and examining how the saved
   track file lined up with the road in the aerial photo) I was able to 
   determine that the new image appeared to be about 1:7000 instead of 5512.
   Change the map_koord.txt line accordingly.
      top_kings_bowl.bmp 42.94584 -113.2167 7000
(QUESTION: has the image actually been "rescaled" by the gdalwarp process
from GPSDrive's perspective, or has the "scale" of 5512 been wrong all along?
The 5512 "scale" looks as correct as can be expected when left as UTM and
displayed as a "map_" file in GPSDrive...)

And now the track showing our travel correctly follows the road we took
into the feature.  Screenshots:
http://www.dogphilosophy.net/maps/kings_bowl_screen_notrack.png
http://www.dogphilosophy.net/maps/kings_bowl_screen_track.png

Since the real goal here for me is to be able to automate the entire 
fetch/convert/add-to-GPSDrive process, I still need to figure out what
the problem is with the "scale", but otherwise this seems to be working.

It would also be nice to figure out why I can't get gdalwarp to convert
the image to an Orthographic projection as well (since the information
from Ed McNierney [thanks!] seems to imply there's a good chance that's the
"map_*" projection that GPSDrive uses), but being able to get working
Geographic (latlong) projection images is good enough for my purposes right
now.

Thanks again - suggestions welcome!

Sean

From ed at topozone.com  Sun Sep 12 15:27:18 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GPSDrive Success! (Partial, labor-intensive...)
Message-ID: <2A6FDD75AE04BE4A9E8C918D3C09FB0721CECD@ptolemy.topozone.com>

Sean -

Good job!  I've got a few brief notes/comments:

1A) As I indicated before, if you're using TerraServer images, they are
stored a 1 meter/pixel, 2 meters/pixel, 4 meters/pixel, etc.  You
control which resolution you get by the parameters of your image
request, so you shouldn't have to deduce it afterwards - you get what
you asked for.

1B) The UTM coordinates of the upper-left corner can also be calculated
from the TerraServer querystring request parameter - you don't need to
use PROJ at all, and you'll get a slighly more accurate result.

I think you will find everything you need at
http://www.terraserver-usa.com/about.aspx?n=AboutLinktoHtml

2) Informally, think of lat/long as a special case of equirectangular.
In an equirectangular projection, each one-degree-square block forms a
rectangle, and they're all of the same size (hence, equirectangular).
In lat/long, those rectangles are squares.  The lat/long projection
minimizes distortion along the Equator, but it is VERY bad at middle
latitudes.  The equirectangular lets you choose two standard parallels
(usually an equal distance north and south of the Equator) to have true
scale - so you can have true scale at 40N and 40S, with things getting
moderately bad at the Equator and moderately bad at high latitudes.
Slightly more technically, think of lat/long as being projected onto a
cylinder that touches the Earth at the Equator only (ball stuck in a
tube) while equirectangular is projected onto a slightly narrower
cylinder that passes THROUGH the Earth, intersecting it at the two
standard parallels (tube shoved through the ball).

2) (also) Your UTM zone calculation is off by one - -180 to -174 degrees
is zone 1, note zone 0.

	- Ed



-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of S Clark
Sent: Sunday, September 12, 2004 3:00 PM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] GPSDrive Success! (Partial, labor-intensive...)

Quick recap:  I'm attempting to learn to convert various map images,
starting with UTM map images, to one of the two projections supported by
GPSDrive.  At present, the image sources I am using give me only the
following pieces of information:

1)Latitude and Longitude of the center point of the image 2)A "scale",
which appears to related to meters/pixel 3)A known image size, required
to be 1280x1024 pixels 4)The projection of the source image (currently
UTM)

I was able to SUCCESSFULLY convert the previously mentioned Terraserver
image of the "King's Bowl" crater (crater itself is at 42.94944
-113.21637, if anyone wants to look up a picture of it) such that it is
scaled and positioned correctly in GPSDrive.  I've still got a ways to
go to learn what I need, as there is still a great deal of manual
intervention required at the last step, but here's what I've got so far:

1)Create a "world file" to go with the source image, using the small
amount of information available for the image:
   A)Calculate the meters/pixel of the image - conversion from the "map
scale"
   of GPSDrive, according to the GPSDrive source code gives the formula
for   
   this as "map scale/2817.947378".  This gives 1.956033687155673
m/pixel
   for the "scale 5512" original image.

   B)use the 'proj' command (from the proj.4 project) to calculate the
   "easting" and "northing":
      proj +proj=utm +lon_0=(lon of image center) +ellps=WGS84 -r << EOF
      > 42.94584 -113.2167
      > EOF
      319158.52       4757184.46

   C)Create the world file (in this case, named    
   map_42.94584_-113.2167_5512.jgw):
      1.956033687155673
      0
      0
      -1.956033687155673
      319158.52
      4757184.46

2)use gdalwarp to convert the image
(NOTE: GPSDrive "top_*" images should be "latlong".  "map_*" images MAY
be Orthographic [unconfirmed])
(QUESTION: What's the difference between "eqc" (Equirectangular) and
"latlon" ("Geographic")?)
   A)calculate the UTM zone
(floor(abs(-180.000-$image_center_longitude)/6))
   B)gdalwarp to a .bmp (imagemagick appears to have trouble with
GeoTIFF)
      /usr/bin/gdalwarp -s_srs '+proj=utm +zone=12 +datum=NAD83
+x0=500000' 
-t_srs '+proj=latlong +datum=WGS84' -of bmp
map_42.94584_-113.2167_5512.jpeg top_kings_bowl.bmp
      Creating output file is that 1432P x 851L.
      ERROR 6: Dataset does not support the SetProjection() method.
      :0...10...20...30...40...50...60...70...80...90...100 - done.
(PROBLEM: gdalwarp couldn't convert to ortho: "too many pixels failed to
transform (441 of 441)")

   C)convert the image to 1280x1024 without changing the center or
rescaling
   or warping the map
      i)for undersized height or width, add equal-sized blank borders to
      both sides of the undersized dimension
      ii)for oversized height/width, cut out an appropriately-sized
center

      mogrify -border 0x87 -crop 1280x1024+76+0 top_kings_bowl.bmp

3)Add the image to GPSDrive
   A)Copy image to ~/.gpsdrive or wherever GPSDrive looks for images
   B)Add the image to map_koord.txt
      top_kings_bowl.bmp 42.94584 -113.2167 5512
   C)(The worst part right now) - fiddle with the "scale" until the map

   actually works right.  By trial and error (and examining how the
saved
   track file lined up with the road in the aerial photo) I was able to 
   determine that the new image appeared to be about 1:7000 instead of
5512.
   Change the map_koord.txt line accordingly.
      top_kings_bowl.bmp 42.94584 -113.2167 7000
(QUESTION: has the image actually been "rescaled" by the gdalwarp
process from GPSDrive's perspective, or has the "scale" of 5512 been
wrong all along?
The 5512 "scale" looks as correct as can be expected when left as UTM
and displayed as a "map_" file in GPSDrive...)

And now the track showing our travel correctly follows the road we took
into the feature.  Screenshots:
http://www.dogphilosophy.net/maps/kings_bowl_screen_notrack.png
http://www.dogphilosophy.net/maps/kings_bowl_screen_track.png

Since the real goal here for me is to be able to automate the entire
fetch/convert/add-to-GPSDrive process, I still need to figure out what
the problem is with the "scale", but otherwise this seems to be working.

It would also be nice to figure out why I can't get gdalwarp to convert
the image to an Orthographic projection as well (since the information
from Ed McNierney [thanks!] seems to imply there's a good chance that's
the "map_*" projection that GPSDrive uses), but being able to get
working Geographic (latlong) projection images is good enough for my
purposes right now.

Thanks again - suggestions welcome!

Sean
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From nacional at cbs.umn.edu  Mon Sep 13 15:16:11 2004
From: nacional at cbs.umn.edu (Pericles S. Nacionales)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal-cvs tif_open.c error
Message-ID: <1095102971.19579.26.camel@arceuthobium.ecology.umn.edu>

Folks,

I was compiling GDAL from CVS and I ran into an error with tif_open.c. 
Here's the message:

make[3]: Entering directory
`/data/users/perry/src/gdal/frmts/gtiff/libtiff'
/bin/sh ../../../libtool --mode=compile gcc -c -I../../../port -Wall 
-O3 -march=pentium4 -funroll-loops -fprefetch-loop-arrays -pipe
-I/usr/local/include -DCPL_MULTIPROC_PTHREAD   -DZIP_SUPPORT
-DPIXARLOG_SUPPORT -I../../zlib -DJPEG_SUPPORT -I../../jpeg/libjpeg
tif_open.c -o ../../o/tif_open.o
 gcc -c -I../../../port -Wall -O3 -march=pentium4 -funroll-loops
-fprefetch-loop-arrays -pipe -I/usr/local/include
-DCPL_MULTIPROC_PTHREAD -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib
-DJPEG_SUPPORT -I../../jpeg/libjpeg tif_open.c  -fPIC -DPIC -o
../../o/.libs/tif_open.o
tif_open.c: In function `TIFFClientOpen':
tif_open.c:276: error: `HOST_FILLORDER' undeclared (first use in this
function)
tif_open.c:276: error: (Each undeclared identifier is reported only once
tif_open.c:276: error: for each function it appears in.)
make[3]: *** [../../o/tif_open.o] Error 1
make[3]: Leaving directory
`/data/users/perry/src/gdal/frmts/gtiff/libtiff'
make[2]: *** [lib-tiff] Error 2
make[2]: Leaving directory `/data/users/perry/src/gdal/frmts/gtiff'
make[1]: *** [gtiff-install-obj] Error 2
make[1]: Leaving directory `/data/users/perry/src/gdal/frmts'
make: *** [frmts-target] Error 2

I checked tif_open.c and there doesn't seem to be any "HOST_FILLORDER"
defined anywhere.  Does anyone know anything about it?  By the way, I'm
using gdal's internal libtiff.

Thanks in advance.
-Perry N.



From dron at ak4719.spb.edu  Mon Sep 13 15:30:16 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal-cvs tif_open.c error
In-Reply-To: <1095102971.19579.26.camel@arceuthobium.ecology.umn.edu>
References: <1095102971.19579.26.camel@arceuthobium.ecology.umn.edu>
Message-ID: <20040913193016.GA14816@ak4719.spb.edu>

On Mon, Sep 13, 2004 at 02:16:11PM -0500, Pericles S. Nacionales wrote:
> I was compiling GDAL from CVS and I ran into an error with tif_open.c.
> Here's the message:
> 
> make[3]: Entering directory
> `/data/users/perry/src/gdal/frmts/gtiff/libtiff'
> /bin/sh ../../../libtool --mode=compile gcc -c -I../../../port -Wall 
> -O3 -march=pentium4 -funroll-loops -fprefetch-loop-arrays -pipe
> -I/usr/local/include -DCPL_MULTIPROC_PTHREAD   -DZIP_SUPPORT
> -DPIXARLOG_SUPPORT -I../../zlib -DJPEG_SUPPORT -I../../jpeg/libjpeg
> tif_open.c -o ../../o/tif_open.o
>  gcc -c -I../../../port -Wall -O3 -march=pentium4 -funroll-loops
> -fprefetch-loop-arrays -pipe -I/usr/local/include
> -DCPL_MULTIPROC_PTHREAD -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib
> -DJPEG_SUPPORT -I../../jpeg/libjpeg tif_open.c  -fPIC -DPIC -o
> ../../o/.libs/tif_open.o
> tif_open.c: In function `TIFFClientOpen':
> tif_open.c:276: error: `HOST_FILLORDER' undeclared (first use in this
> function)

Fixed. Please, check out the CVS again.

						Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From nacional at cbs.umn.edu  Mon Sep 13 16:13:05 2004
From: nacional at cbs.umn.edu (Pericles S. Nacionales)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdal-cvs tif_open.c error
In-Reply-To: <20040913193016.GA14816@ak4719.spb.edu>
References: <1095102971.19579.26.camel@arceuthobium.ecology.umn.edu>
	<20040913193016.GA14816@ak4719.spb.edu>
Message-ID: <1095106385.19579.28.camel@arceuthobium.ecology.umn.edu>

On Mon, 2004-09-13 at 14:30, Andrey Kiselev wrote:
> On Mon, Sep 13, 2004 at 02:16:11PM -0500, Pericles S. Nacionales wrote:
> > I was compiling GDAL from CVS and I ran into an error with tif_open.c.
> > Here's the message:
> > 
> > make[3]: Entering directory
> > `/data/users/perry/src/gdal/frmts/gtiff/libtiff'
> > /bin/sh ../../../libtool --mode=compile gcc -c -I../../../port -Wall 
> > -O3 -march=pentium4 -funroll-loops -fprefetch-loop-arrays -pipe
> > -I/usr/local/include -DCPL_MULTIPROC_PTHREAD   -DZIP_SUPPORT
> > -DPIXARLOG_SUPPORT -I../../zlib -DJPEG_SUPPORT -I../../jpeg/libjpeg
> > tif_open.c -o ../../o/tif_open.o
> >  gcc -c -I../../../port -Wall -O3 -march=pentium4 -funroll-loops
> > -fprefetch-loop-arrays -pipe -I/usr/local/include
> > -DCPL_MULTIPROC_PTHREAD -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib
> > -DJPEG_SUPPORT -I../../jpeg/libjpeg tif_open.c  -fPIC -DPIC -o
> > ../../o/.libs/tif_open.o
> > tif_open.c: In function `TIFFClientOpen':
> > tif_open.c:276: error: `HOST_FILLORDER' undeclared (first use in this
> > function)
> 
> Fixed. Please, check out the CVS again.
> 
> 						Andrey

Excellent! Thanks, Andrey.

-Perry


From theveny at dt.insu.cnrs.fr  Tue Sep 14 06:08:48 2004
From: theveny at dt.insu.cnrs.fr (Pierre-Michel THEVENY)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] internal jpglib error
Message-ID: <4146DF50.32366.B3CD4F@localhost>

Hi,

When compiling gdal-1.2.1 under windows using minGW (3.3.1) with internal jpeg lib, 
an error occurs because boolean type is not well defined.

Problem could be solve by editing frmts/jpeg/jpeglib.h and adding

#ifndef HAVE_BOOLEAN
typedef int boolean;
#define HAVE_BOOLEAN
#endif

Best regard
pmt

--
Pierre-Michel THEVENY
INSU/CNRS
Division Technique-Antenne de Toulon
C/o IFREMER BP 330
83507 La SEYNE sur MER cedex



--
Quand le dernier arbre sera abattu, 
La derni?re rivi?re empoisonn?e, 
Le dernier poisson p?ch?, 
Alors vous d?couvrirez 
Que l'argent ne se mange pas. 
(Proverbe Cree)

From ealpert at digitalglobe.com  Tue Sep 14 15:20:37 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp/gcps and ERROR 1: Failed to compute polynomial
	equations of desired order
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B1769@COMAIL01.digitalglobe.com>

Greetings,
 
This is my first post. I tried searching around for examples but didn't
find much and mailman's search capability is non-existant.
 
So what's the secret for using more than 4 gcps with gdalwarp?
 
I have 3 pieces of imagery I'm mosaicing. I know the corners of each
image. I created a single non-projected tif of the three separate
images. I computed where (in pixel space) the top two corners of the
first two images are in the resulting tif and where the bottom two
corners of the last image are. This resulted in 6 GCP points. So I ran
the following:
 
gdal_translate  -gcp 0 0 56.7468972222222 29.4295138888889 -gcp 859 0
56.9820861111111 29.4210638888889 -gcp 0 1363 56.7391 29.1199027777778
-gcp 859 1363 56.9705611111111 29.1071416666667 -gcp 859 2171
56.9677027777778 28.9774388888889 -gcp -gcp 0 2171  56.7381583333333
28.9917333333333 mosaic.tif mosaic_raw.tif
 
Then I ran:
 
 

gdalwarp -co "TFW=YES" mosaic_raw.tif mosaic_new.tif
 
And got:

ERROR 1: Failed to compute polynomial equations of desired order
for provided control points.
 
If I use -order 1 I get a really screwing output.
 
If I remove the middle point and do:
 

gdal_translate  -gcp 0 0 56.7468972222222 29.4295138888889 -gcp 859 0
56.9820861111111 29.4210638888889 -gcp 859 2171 56.9677027777778
28.9774388888889 -gcp 0 2171  56.7381583333333 28.9917333333333
mosaic.tif mosaic_raw.tif
 
Then:

gdalwarp -co "TFW=YES" mosaic_raw.tif mosaic_new.tif
 
I get a projected mosiac of my images but it's not warped as I'd like.
 
So again my question is what needs to be done to use higher order
warping? What are the rules gcps must follow?
 
I'm using gdal1.2.1
 
Thanks in advance,
 
-ethan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040914/267ff0bd/attachment.html
From warmerdam at pobox.com  Tue Sep 14 15:30:57 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp/gcps and ERROR 1: Failed to compute polynomial
	equations of desired order
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB16017B1769@COMAIL01.digitalglobe.com>
References: <1FB6937A87F9074C9A2B8F9D9137EB16017B1769@COMAIL01.digitalglobe.com>
Message-ID: <414746F1.9000107@pobox.com>

Ethan Alpert wrote:
> Greetings,
>  
> This is my first post. I tried searching around for examples but didn't 
> find much and mailman's search capability is non-existant.
>  
> So what's the secret for using more than 4 gcps with gdalwarp?
>  
> I have 3 pieces of imagery I'm mosaicing. I know the corners of each 
> image. I created a single non-projected tif of the three separate 
> images. I computed where (in pixel space) the top two corners of the 
> first two images are in the resulting tif and where the bottom two 
> corners of the last image are. This resulted in 6 GCP points. So I ran 
> the following:
>  
> gdal_translate  -gcp 0 0 56.7468972222222 29.4295138888889 -gcp 859 0 
> 56.9820861111111 29.4210638888889 -gcp 0 1363 56.7391 29.1199027777778 
> -gcp 859 1363 56.9705611111111 29.1071416666667 -gcp 859 2171 
> 56.9677027777778 28.9774388888889 -gcp -gcp 0 2171  56.7381583333333 
> 28.9917333333333 mosaic.tif mosaic_raw.tif

Ethan,

I think the problem is the "-gcp -gcp 0 2171..." part.  The first -gcp
is being accepted, and then atoi() is called on the second so is effectively
being treated as "-gcp 0 0 2171 56.7381583333333 28.9917333333333".  That
is, the gcp is all screwed up.

You might want to use gdalinfo on your output files with GCPs to verify they
look sensible.

I think you will find things work somewhat better once the GCPs are correct.
However, there some issues with the GDAL polynomial warping.

1) gdalwarp creates a forwards and a backwards transformation from the GCPs
    but creates them independently by reversing the GCPs.  They aren't true
    inverses.  The forward transform is used to compute output bounds, but the
    reverse transform is what is actually used in the warping.  With highly
    non-linear GCP sets this can have damaging effects.

2) I don't think the higher order polynomial calculations are actually working
    right.  I would discourage using anything over second order.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ealpert at digitalglobe.com  Tue Sep 14 15:56:15 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp/gcps and ERROR 1: Failed to compute
	polynomial equations of desired order
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B176A@COMAIL01.digitalglobe.com>



That -gcp -gcp was just a cut and paste error.

Here's gdalinfo from mosaic_raw.tif

-bash-2.05b$ gdalinfo mosaic_raw.tif 
Driver: GTiff/GeoTIFF
Size is 859, 2172
Coordinate System is `'
GCP Projection = 
GCP[  0]: Id=1, Info=
          (0,0) -> (56.7469,29.4295,0)
GCP[  1]: Id=2, Info=
          (859,0) -> (56.9821,29.4211,0)
GCP[  2]: Id=3, Info=
          (859,2171) -> (56.9677,28.9774,0)
GCP[  3]: Id=4, Info=
          (0,2171) -> (56.7382,28.9917,0)
GCP[  4]: Id=5, Info=
          (0,1363) -> (56.7391,29.1199,0)
GCP[  5]: Id=6, Info=
          (859,1363) -> (56.9706,29.1071,0)
Metadata:
  TIFFTAG_DOCUMENTNAME=mosaic.tif
  TIFFTAG_SOFTWARE=ImageMagick 5.5.6 04/01/03 Q16
http://www.imagemagick.org
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 2172.0)
Upper Right (  859.0,    0.0)
Lower Right (  859.0, 2172.0)
Center      (  429.5, 1086.0)
Band 1 Block=859x4 Type=UInt16, ColorInterp=Gray
Band 2 Block=859x4 Type=UInt16, ColorInterp=Gray
Band 3 Block=859x4 Type=UInt16, ColorInterp=Gray

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, September 14, 2004 1:31 PM
To: Ethan Alpert
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] gdalwarp/gcps and ERROR 1: Failed to compute
polynomial equations of desired order


Ethan Alpert wrote:
> Greetings,
>  
> This is my first post. I tried searching around for examples but 
> didn't
> find much and mailman's search capability is non-existant.
>  
> So what's the secret for using more than 4 gcps with gdalwarp?
>  
> I have 3 pieces of imagery I'm mosaicing. I know the corners of each
> image. I created a single non-projected tif of the three separate 
> images. I computed where (in pixel space) the top two corners of the 
> first two images are in the resulting tif and where the bottom two 
> corners of the last image are. This resulted in 6 GCP points. So I ran

> the following:
>  
> gdal_translate  -gcp 0 0 56.7468972222222 29.4295138888889 -gcp 859 0
> 56.9820861111111 29.4210638888889 -gcp 0 1363 56.7391 29.1199027777778

> -gcp 859 1363 56.9705611111111 29.1071416666667 -gcp 859 2171 
> 56.9677027777778 28.9774388888889 -gcp -gcp 0 2171  56.7381583333333 
> 28.9917333333333 mosaic.tif mosaic_raw.tif

Ethan,

I think the problem is the "-gcp -gcp 0 2171..." part.  The first -gcp
is being accepted, and then atoi() is called on the second so is
effectively being treated as "-gcp 0 0 2171 56.7381583333333
28.9917333333333".  That is, the gcp is all screwed up.

You might want to use gdalinfo on your output files with GCPs to verify
they look sensible.

I think you will find things work somewhat better once the GCPs are
correct. However, there some issues with the GDAL polynomial warping.

1) gdalwarp creates a forwards and a backwards transformation from the
GCPs
    but creates them independently by reversing the GCPs.  They aren't
true
    inverses.  The forward transform is used to compute output bounds,
but the
    reverse transform is what is actually used in the warping.  With
highly
    non-linear GCP sets this can have damaging effects.

2) I don't think the higher order polynomial calculations are actually
working
    right.  I would discourage using anything over second order.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Sep 14 16:02:59 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] gdalwarp/gcps and ERROR 1: Failed to compute polynomial
	equations of desired order
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB16017B176A@COMAIL01.digitalglobe.com>
References: <1FB6937A87F9074C9A2B8F9D9137EB16017B176A@COMAIL01.digitalglobe.com>
Message-ID: <41474E73.40704@pobox.com>

Ethan Alpert wrote:
> 
> That -gcp -gcp was just a cut and paste error.
> 
> Here's gdalinfo from mosaic_raw.tif
> 
> -bash-2.05b$ gdalinfo mosaic_raw.tif 
> Driver: GTiff/GeoTIFF
> Size is 859, 2172
> Coordinate System is `'
> GCP Projection = 
> GCP[  0]: Id=1, Info=
>           (0,0) -> (56.7469,29.4295,0)
> GCP[  1]: Id=2, Info=
>           (859,0) -> (56.9821,29.4211,0)
> GCP[  2]: Id=3, Info=
>           (859,2171) -> (56.9677,28.9774,0)
> GCP[  3]: Id=4, Info=
>           (0,2171) -> (56.7382,28.9917,0)
> GCP[  4]: Id=5, Info=
>           (0,1363) -> (56.7391,29.1199,0)
> GCP[  5]: Id=6, Info=
>           (859,1363) -> (56.9706,29.1071,0)

Ethan,

I think you will need to be more specific about what you mean by the output
being really screwy.  Also, if I am to reproduce the problem, a "vrt"
of the mosaic_raw.tif would be helpful.

eg.
   gdal_translate -of VRT mosaic_raw.tif mosaic_raw.vrt

This ensures I capture the GCPs accurately without screwing it up in
data entry.  I'll just substitute a chunk of image data of the same
size in place of yours.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From daniel.mac at elantech-inc.com  Tue Sep 14 17:08:08 2004
From: daniel.mac at elantech-inc.com (Dan)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Undefined Symbol: CPLCreateThread
Message-ID: <loom.20040914T230726-448@post.gmane.org>

Hi, 

I am trying to link my solaris application with the GDAL libs (still using 
1.1.9) using Sun Forte CC, and my final undefined symbol error i receive is 
for CPLCreateThread, referenced from the gdalwarpoperation.o file in the GDAL 
library...is there a library i need to include prior to including GDAL for 
this symbol to be defined??? Any help is appreciated...thanks..

dan


From warmerdam at pobox.com  Tue Sep 14 17:12:33 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Undefined Symbol: CPLCreateThread
In-Reply-To: <loom.20040914T230726-448@post.gmane.org>
References: <loom.20040914T230726-448@post.gmane.org>
Message-ID: <41475EC1.1020009@pobox.com>

Dan wrote:
> Hi, 
> 
> I am trying to link my solaris application with the GDAL libs (still using 
> 1.1.9) using Sun Forte CC, and my final undefined symbol error i receive is 
> for CPLCreateThread, referenced from the gdalwarpoperation.o file in the GDAL 
> library...is there a library i need to include prior to including GDAL for 
> this symbol to be defined??? Any help is appreciated...thanks..

Dan,

I'm not sure why this is happening to you. CPLCreateThread() should be
defined in cpl_multiproc.cpp.  If pthreads or win32 style stuff isn't
available it should fallback to a dummy implementation.

If you can't easily identify what is going wrong in cpl_multiproc.cpp, you
can just comment out the call in gdal/alg/gdalwarpoperation.cpp.  Multi
threading is not normally used.

PS. 1.1.9 is pretty ancient.  It's alot more fun answering questions about
current software.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From afinley at gis.umn.edu  Tue Sep 14 17:20:26 2004
From: afinley at gis.umn.edu (Andrew Finley)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] how to get pixels' band vector efficiently
Message-ID: <1095196825.5916.6.camel@populus>

Hi All,
I have written an image classification algorithm which uses gdal to fill
a vector of band values for each pixel.  I'm looking for a better/faster
way of accessing these values. Two general ways I might think to speed
this up are: 

1) move one tile at a time into memory then apply the loop below.
2) find a way to load my target vector more efficiently than one
pixel/layer at a time.

So I guess I'm looking for some ideas or example code.  Could the
tileindex application offer any help? Does it load logical image blocks
(i.e., from a single page)?

Thanks a lot for suggestions.
-Andy

Current approach:
//every pixel loop
for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
	for (int col = 0; col < featureDataset->GetRasterXSize(); col++){

	//fill targetBandVec
	for (layer = 1; layer <= featureDataset->GetRasterCount(); layer++){
		featureBand = featureDataset->GetRasterBand( layer );
		featureBand->RasterIO(GF_Read, col, row, 1, 1, featurePixel, 1, 1,
GDT_Float32, 0, 0 );
		targetBandVec[layer-1]=featurePixel[0];
	}

	Then classify the target vector...

	}
}


-- 
Andrew Finley, Research Fellow
Department of Forest Resources
College of Natural Resources           
University of Minnesota
305 Green Hall
1530 Cleveland Avenue N.
St. Paul, MN 55108

Ph 612-624-1714 office
www.cnr.umn.edu/FR/people/facstaff/finley/index.html

From MChapman at sanz.com  Tue Sep 14 17:41:09 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] how to get pixels' band vector efficiently
Message-ID: <ED3A48B9840E594890A2BC172D119465E63B85@mailman.san.com>

Andy,

This function let's me read in an area of interest with blistering
results...faster than Erdas can do it.  I only ever read in enough bits
to fill the client rect of the viewing window.  I re-read everytime you
move the window.  I can open and display a 8 gig imgage across the
network in 2 - 3 seconds.  Once it's open, it's instantaneous when
scrolling.  The key is using pointer arithmetic with the ansi memcpy()
function.  I've heard you can make it even faster using ReadBlock(), but
that method doesn't suit the aoi function for me as well....plus this is
already greased lightning.  This code is cut and pasted so I don't know
if it will work out of the gate, but, shouldn't be far off if it
doesn't. (I had to remove a few proprietary things).  Also, the
dibsection class is a helper class for windows rgbs.  Let me know if you
need it, I will send it to you.

CDIBSection* CImagePortDoc::GetAreaOfInterest(CRect rect, int nResLevel)
{

		int nBandCount = m_vBandList.size();
		int nWidth = rect.Width();
		int nHeight = rect.Height();
		int nXOffset = rect.left;
		int nYOffset = rect.top;
		void * ptr_dest = NULL;
		void * ptr_src = NULL;
		m_nResLevel = nResLevel;

		int nSize = 3; // this is always 3 bands because windows
dibs are rgb.
		void** pBandBuffer = (void**) new unsigned char*[nSize];

		GDALColorTable* pCT =
m_pDataset->GetRasterBand(1)->GetColorTable();
		GDALRasterBand* pBand = NULL;
		void* pBandBytes = NULL;

		for (int n = 0; n < nSize; n++)
		{
			if (nBandCount > 1)
				pBand =
m_pDataset->GetRasterBand(m_vBandList[n] + 1);
			else
				pBand = m_pDataset->GetRasterBand(1);

			int nRasterX = pBand->GetXSize();
			int nRasterY = pBand->GetYSize();

			if (nWidth > nRasterX)
			{
				nXOffset = 0;
				nWidth = nRasterX;
			}

			if (nHeight > nRasterY) 
			{
				nYOffset = 0;
				nHeight = nRasterY;
			}

			pBandBytes = (unsigned char*)
CPLMalloc(sizeof(unsigned char) * nWidth * nHeight);
			pBand->RasterIO(GF_Read, nXOffset, nYOffset,
nWidth, nHeight, pBandBytes, nWidth , nHeight, GDT_Byte, 0, 0);
			pBandBuffer[n] = pBandBytes;
		}

		unsigned char* pCombinedBytes = (unsigned char*)
CPLMalloc(sizeof(unsigned char) * nWidth * nHeight * nSize);

		for (long i = 0, long j = 0; i < (nWidth * nHeight *
nSize); i += nSize, j++)
		{
			int k = i;

			for (int m = nSize - 1; m >= 0; m--, k++)
			{
				unsigned char* pBytes = (unsigned char*)
pBandBuffer[m];
				ptr_dest = pCombinedBytes + k;
				unsigned char b = pBytes[j];

				if (pCT != NULL)
				{
					GDALColorEntry ce;
					unsigned int c = (unsigned int)
b;
					c = pCT->GetColorEntryAsRGB(c,
&ce);
					if (m == 0) c = ce.c1;
					if (m == 1) c = ce.c2;
					if (m == 2) c = ce.c3;
					b = (unsigned char) c;
				}

				ptr_src = &b;
				memcpy(ptr_dest, ptr_src, 1);
			}
		}

		if ((nWidth > 0) && (nHeight > 0))
		{
			if (m_pDIBSection) delete m_pDIBSection;
			m_pDIBSection = new CDIBSection;

			if (m_pDIBSection)
			{
				m_pDIBSection->Create(nWidth ,nHeight,
24);
				unsigned int dibwidth =
m_pDIBSection->GetTotalWidth();

				GByte* dest = (GByte*)
m_pDIBSection->GetBits();
				GByte* src = (GByte*) pCombinedBytes;

				for (int row = 0; row < nHeight; row++)
				{
					ptr_dest = dest + row * dibwidth
* nSize;
					ptr_src = src + row * nWidth *
nSize;
					memcpy(ptr_dest, ptr_src, nWidth
* nSize);
				}
			}
		}

		if (pBandBuffer)
		{
			for (int d = 0; d < nSize; d++)
				CPLFree(pBandBuffer[d]);

			delete [] pBandBuffer;
		}

		if (pCombinedBytes)
			CPLFree(pCombinedBytes);

		CDIBSection* pDIBSection = m_pDIBSection;
		return pDIBSection;
}




Martin Chapman

-----Original Message-----
From: Andrew Finley [mailto:afinley@gis.umn.edu] 
Sent: Tuesday, September 14, 2004 3:20 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] how to get pixels' band vector efficiently


Hi All,
I have written an image classification algorithm which uses gdal to fill
a vector of band values for each pixel.  I'm looking for a better/faster
way of accessing these values. Two general ways I might think to speed
this up are: 

1) move one tile at a time into memory then apply the loop below.
2) find a way to load my target vector more efficiently than one
pixel/layer at a time.

So I guess I'm looking for some ideas or example code.  Could the
tileindex application offer any help? Does it load logical image blocks
(i.e., from a single page)?

Thanks a lot for suggestions.
-Andy

Current approach:
//every pixel loop
for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
	for (int col = 0; col < featureDataset->GetRasterXSize();
col++){

	//fill targetBandVec
	for (layer = 1; layer <= featureDataset->GetRasterCount();
layer++){
		featureBand = featureDataset->GetRasterBand( layer );
		featureBand->RasterIO(GF_Read, col, row, 1, 1,
featurePixel, 1, 1, GDT_Float32, 0, 0 );
		targetBandVec[layer-1]=featurePixel[0];
	}

	Then classify the target vector...

	}
}


-- 
Andrew Finley, Research Fellow
Department of Forest Resources
College of Natural Resources           
University of Minnesota
305 Green Hall
1530 Cleveland Avenue N.
St. Paul, MN 55108

Ph 612-624-1714 office
www.cnr.umn.edu/FR/people/facstaff/finley/index.html
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From cgt at navicon.dk  Tue Sep 14 18:48:00 2004
From: cgt at navicon.dk (Christian G. Tveen)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Undefined Symbol: CPLCreateThread
In-Reply-To: <41475EC1.1020009@pobox.com>
References: <loom.20040914T230726-448@post.gmane.org>
	<41475EC1.1020009@pobox.com>
Message-ID: <41477520.8060302@navicon.dk>

Hi,

In port/cpl_multiproc.cpp, you may try to set
CPL_C_START before CPLCreateThread, and CPL_C_END after CPLCreateThread:
CPL_C_START
CplCreateThread ()
{

}
CPL_C_END

 If this does not help, its due to my bad memory, and I'll have to check 
my solution at the Solaris box at work tomorrow.

Best Regards Christian

Frank Warmerdam wrote:

> Dan wrote:
>
>> Hi,
>> I am trying to link my solaris application with the GDAL libs (still 
>> using 1.1.9) using Sun Forte CC, and my final undefined symbol error 
>> i receive is for CPLCreateThread, referenced from the 
>> gdalwarpoperation.o file in the GDAL library...is there a library i 
>> need to include prior to including GDAL for this symbol to be 
>> defined??? Any help is appreciated...thanks..
>
>
> Dan,
>
> I'm not sure why this is happening to you. CPLCreateThread() should be
> defined in cpl_multiproc.cpp.  If pthreads or win32 style stuff isn't
> available it should fallback to a dummy implementation.
>
> If you can't easily identify what is going wrong in cpl_multiproc.cpp, 
> you
> can just comment out the call in gdal/alg/gdalwarpoperation.cpp.  Multi
> threading is not normally used.
>
> PS. 1.1.9 is pretty ancient.  It's alot more fun answering questions 
> about
> current software.
>
> Best regards,


From nacional at cbs.umn.edu  Wed Sep 15 03:01:25 2004
From: nacional at cbs.umn.edu (Pericles S. Nacionales)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL CVS: dodsdataset.cpp error
Message-ID: <1095231685.31493.28.camel@localhost>

Hi folks,

While compiling gdal from cvs, I ran into the following error messages:

		from dodsdataset.cpp:28:
/usr/lib/gcc/i686-pc-linux-gnu/3.4.1/include/g++-v3/i686-pc-linux-gnu/bits/gthr-default.h:40:1: warning: this is the location of the previous definition
dodsdataset.cpp: In member function `void
DODSDataset::get_geo_info(DAS&, DDS&)':
dodsdataset.cpp:531: error: expected `)' before "value"
dodsdataset.cpp:535: error: no matching function for call to
`OGRSpatialReference::SetFromUserInput(std::string&)'
../../ogr/ogr_spatialref.h:275: note: candidates are: OGRErr
OGRSpatialReference::SetFromUserInput(const char*)
make[2]: *** [../o/dodsdataset.o] Error 1
make[2]: Leaving directory `/home/pnaciona/src/gdal/frmts/dods'
make[1]: *** [dods-install-obj] Error 2
make[1]: Leaving directory `/home/pnaciona/src/gdal/frmts'
make: *** [frmts-target] Error 2

I got it to compile by commenting out lines 529-536 of dodsdataset.cpp:
    //Set a full coordinate system from "spatial_ref" in WKT or any user
input.
    value = at->get_attr(spatial_ref);
    if( value != "" value != "None" )
    {
        DBG(cerr << spatial_ref << ": " << value << endl);

        oSRS.SetFromUserInput( value );
    }

Thought I'd let someone know...

-Perry N.

-- 
Pericles S. Nacionales <nacional@cbs.umn.edu>
University of Minnesota


From warmerdam at pobox.com  Wed Sep 15 08:27:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL CVS: dodsdataset.cpp error
In-Reply-To: <1095231685.31493.28.camel@localhost>
References: <1095231685.31493.28.camel@localhost>
Message-ID: <4148351B.7090509@pobox.com>

Pericles S. Nacionales wrote:
>     value = at->get_attr(spatial_ref);
>     if( value != "" value != "None" )
>     {
>         DBG(cerr << spatial_ref << ": " << value << endl);
> 
>         oSRS.SetFromUserInput( value );
>     }

Perry,

Sorry about that.  I have patched it in CVS.  There should have been an
&& between the two tests in the if.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 15 09:23:32 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] how to get pixels' band vector efficiently
In-Reply-To: <1095196825.5916.6.camel@populus>
References: <1095196825.5916.6.camel@populus>
Message-ID: <41484254.1050206@pobox.com>

Andrew Finley wrote:
> Hi All,
> I have written an image classification algorithm which uses gdal to fill
> a vector of band values for each pixel.  I'm looking for a better/faster
> way of accessing these values. Two general ways I might think to speed
> this up are: 
> 
> 1) move one tile at a time into memory then apply the loop below.
> 2) find a way to load my target vector more efficiently than one
> pixel/layer at a time.
> 
> So I guess I'm looking for some ideas or example code.  Could the
> tileindex application offer any help? Does it load logical image blocks
> (i.e., from a single page)?

> Current approach:
> //every pixel loop
> for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
> 	for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
> 
> 	//fill targetBandVec
> 	for (layer = 1; layer <= featureDataset->GetRasterCount(); layer++){
> 		featureBand = featureDataset->GetRasterBand( layer );
> 		featureBand->RasterIO(GF_Read, col, row, 1, 1, featurePixel, 1, 1,
> GDT_Float32, 0, 0 );
> 		targetBandVec[layer-1]=featurePixel[0];
> 	}

Andy,

Reading one pixel at a time is going to be terrible for performance.  I would
encourage you to at least change you code to read one line at a time.  This
will give you a huge performance boost.  Going to a tile oriented (or better
yet to the native block size of the source) will help a bit more in some cases,
but not likely very much.

I am also using the multi-band RasterIO() directly on the dataset, one
line at a time in the following example:

  // Make sure that lineBuf holds one whole line of data.
  float *lineBuf;
  int  xsize = featureDataset->GetRasterXSize();
  int  ysize = featureDataset->GetRasterYSize();
  int  bandCount = featureDataset->GetRasterCount();

  lineBuf = (float *) CPLMalloc(xsize * bandCount);

  //every row loop
  for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
      featureDataset->RasterIO( GF_Read, 0, row, xsize, 1,
                                lineBuf, xsize, 1, GDT_Float32,
                                bandCount, NULL,
                                4 * bandCount, 0, 4 );
      // every pixel in row.
      for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
          float *targetBandVec = lineBuf + col;

          ... perform classification ..
      }
  }

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From afinley at gis.umn.edu  Wed Sep 15 09:34:09 2004
From: afinley at gis.umn.edu (Andrew Finley)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] how to get pixels' band vector efficiently
In-Reply-To: <41484254.1050206@pobox.com>
References: <1095196825.5916.6.camel@populus>  <41484254.1050206@pobox.com>
Message-ID: <1095255246.19374.2.camel@populus>

Thanks Frank,
I'll give this a try too.  I really appreciate everyones help.
-andy

On Wed, 2004-09-15 at 08:23, Frank Warmerdam wrote:
> Andrew Finley wrote:
> > Hi All,
> > I have written an image classification algorithm which uses gdal to fill
> > a vector of band values for each pixel.  I'm looking for a better/faster
> > way of accessing these values. Two general ways I might think to speed
> > this up are: 
> > 
> > 1) move one tile at a time into memory then apply the loop below.
> > 2) find a way to load my target vector more efficiently than one
> > pixel/layer at a time.
> > 
> > So I guess I'm looking for some ideas or example code.  Could the
> > tileindex application offer any help? Does it load logical image blocks
> > (i.e., from a single page)?
> 
> > Current approach:
> > //every pixel loop
> > for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
> > 	for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
> > 
> > 	//fill targetBandVec
> > 	for (layer = 1; layer <= featureDataset->GetRasterCount(); layer++){
> > 		featureBand = featureDataset->GetRasterBand( layer );
> > 		featureBand->RasterIO(GF_Read, col, row, 1, 1, featurePixel, 1, 1,
> > GDT_Float32, 0, 0 );
> > 		targetBandVec[layer-1]=featurePixel[0];
> > 	}
> 
> Andy,
> 
> Reading one pixel at a time is going to be terrible for performance.  I would
> encourage you to at least change you code to read one line at a time.  This
> will give you a huge performance boost.  Going to a tile oriented (or better
> yet to the native block size of the source) will help a bit more in some cases,
> but not likely very much.
> 
> I am also using the multi-band RasterIO() directly on the dataset, one
> line at a time in the following example:
> 
>   // Make sure that lineBuf holds one whole line of data.
>   float *lineBuf;
>   int  xsize = featureDataset->GetRasterXSize();
>   int  ysize = featureDataset->GetRasterYSize();
>   int  bandCount = featureDataset->GetRasterCount();
> 
>   lineBuf = (float *) CPLMalloc(xsize * bandCount);
> 
>   //every row loop
>   for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
>       featureDataset->RasterIO( GF_Read, 0, row, xsize, 1,
>                                 lineBuf, xsize, 1, GDT_Float32,
>                                 bandCount, NULL,
>                                 4 * bandCount, 0, 4 );
>       // every pixel in row.
>       for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
>           float *targetBandVec = lineBuf + col;
> 
>           ... perform classification ..
>       }
>   }
> 
> Good luck,

From nacional at cbs.umn.edu  Wed Sep 15 11:38:10 2004
From: nacional at cbs.umn.edu (Pericles S. Nacionales)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL CVS: dodsdataset.cpp error
In-Reply-To: <4148351B.7090509@pobox.com>
References: <1095231685.31493.28.camel@localhost> <4148351B.7090509@pobox.com>
Message-ID: <1095262690.31445.30.camel@localhost>

Thanks, Frank!

On Wed, 2004-09-15 at 07:27, Frank Warmerdam wrote:
> Pericles S. Nacionales wrote:
> >     value = at->get_attr(spatial_ref);
> >     if( value != "" value != "None" )
> >     {
> >         DBG(cerr << spatial_ref << ": " << value << endl);
> > 
> >         oSRS.SetFromUserInput( value );
> >     }
> 
> Perry,
> 
> Sorry about that.  I have patched it in CVS.  There should have been an
> && between the two tests in the if.
> 
> Best regards,

-- 
Pericles S. Nacionales <nacional@cbs.umn.edu>
University of Minnesota


From hrz at geodata.soton.ac.uk  Wed Sep 15 11:40:31 2004
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Raster splitting program
Message-ID: <20040915154029.GB24546@truffles.geodata.soton.ac.uk>

Hello,

I thought I'd post a program that I've written in the hope that it may
be of use to someone else. The program does the opposite of the
gdal_merge.py script by splitting a raster up into georeferenced
tiles.  I've found it useful for making large rasters more manageable,
especially in conjunction with the UMN MapServer and the gdaltindex
program. 

It is a C++ program based on the gdal_translate code (specifically the
stuff that implements the -srcwin modifier). I've developed it under
linux using GCC and GDAL 1.2.0.0 (released 2004/03/10):

$ uname -a
Linux alf 2.4.21-15.0.3.ELsmp #1 SMP Tue Jun 29 18:04:47 EDT 2004 i686
i686 i386 GNU/Linux

$ gcc --version
gcc (GCC) 3.2.3 20030502 (Red Hat Linux 3.2.3-34)

I've been compiling it using the following command:

gcc -o gdalsplit -L/usr/local/lib -lgdal -I/usr/local/include -I/root/src/gdal-1.2.0/frmts -ltiff gdalsplit.cpp -Wall

I'm unable to support the program on any other system. I also have to
admit to being a newbie with C/C++ as well as the GDAL API, so the
disclaimer "use at your own risk" is particularly applicable here!

Attached is the C++ file and man page in nroff format.  The output of
the man page is:

NAME
       gdalsplit - splits raster datasource(s) into tiles

SYNOPSIS
       Usage: gdalsplit [--version]
              [-c cols]
              [-r rows]
              [-quiet]
              src_dataset...


DESCRIPTION
       Split one or more raster datasources into more manageable tiles. This
       is, for instance, useful in conjunction with the gdaltindex program.
       The output files are created in the same directory as the source files.
       The source dataset is not deleted.

       The output datasets are not guaranteed to be of equal pixel size unless
       the columns and rows specified exactly divide into the source dataset
       width and height respectively.


       -c cols:
           Select the number of columns cols to split the source dataset into.
           The default is 2.

       -r rows:
           Select the number of rows rows to split the source dataset into.
           The default is 2.

       -quiet:
           Supress progress monitor and other non-error output.

       src_dataset:
           The source file name.


EXAMPLE
       % gdalsplit -c 3 -r 3 utm.tif

       produces the following 9 files:

       utm_c1_r1.tif
       utm_c1_r2.tif
       utm_c1_r3.tif
       utm_c2_r1.tif
       utm_c2_r2.tif
       utm_c2_r3.tif
       utm_c3_r1.tif
       utm_c3_r2.tif
       utm_c3_r3.tif


Thanks,

Homme Zwaagstra
-------------- next part --------------
/* ****************************************************************************
 * Purpose:  GDAL Image Splitting Program
 * Author:   Homme Zwaagstra, geodata@soton.ac.uk
 *
 * This program is heavily derived from the GDAL gdal_translate utility
 *
 * ****************************************************************************
 * Copyright (c) 1998, 2002, Frank Warmerdam
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
 * DEALINGS IN THE SOFTWARE.
 * ****************************************************************************
 */

#include "cpl_string.h"
#include "vrt/vrtdataset.h"

/* compilation on WIN32 machines has not been tested! */
#ifdef WIN32
#define PATH_SEP_CHAR '\\'
#else
#define PATH_SEP_CHAR '/'
#endif

static CPLErr CopyRasterBand(GDALDataset *poSrcDS, GDALDataset *poDstDS, int nBand, int nSrcXOff, int nSrcYOff, int nSrcXSize, int nSrcYSize);
static VRTDataset * CopyRasterWindow(GDALDatasetH hSrcDS, int nSrcXOff, int nSrcYOff, int nSrcXSize, int nSrcYSize);
static void AttachMetadata( GDALDatasetH, char ** );
static int SplitFile(const char *pszSource, int cols, int rows, int bQuiet, GDALProgressFunc pfnProgress);
static char * CreateString(const char *fmt, ...);
static char * CreateFileName(const char *pszSource, int col, int row);
static char * GetExtension(const char *basename);
static char * GetDirname(const char *string);
static char * GetBasename(const char *string);


/* ******************************************************************** */
/*                               Usage()                                */
/* ******************************************************************** */

static void Usage()

{
    int	iDr;
        
    printf( "Usage: gdalsplit [--version]\n"
            "       [-c cols]\n"
            "       [-r rows]\n"
            "       [-quiet]\n"
            "       src_dataset...\n\n" );

    printf( "%s\n\n", GDALVersionInfo( "--version" ) );
    printf( "The following format drivers are configured and support output:\n" );
    for( iDr = 0; iDr < GDALGetDriverCount(); iDr++ )
		{
			GDALDriverH hDriver = GDALGetDriver(iDr);
        
			if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) != NULL
				|| GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATECOPY,
										NULL ) != NULL )
				{
					printf( "  %s: %s\n",
							GDALGetDriverShortName( hDriver ),
							GDALGetDriverLongName( hDriver ) );
				}
		}
}


/* ******************************************************************** */
/*                                main()                                */
/* ******************************************************************** */

int main( int argc, char ** argv )

{
	int bQuiet = FALSE, i, j = 0;
	int cols = 2, rows = 2;
    GDALProgressFunc pfnProgress = GDALTermProgress;

/* -------------------------------------------------------------------- */
/*      Register standard GDAL drivers, and identify output driver.     */
/* -------------------------------------------------------------------- */

    GDALAllRegister();

/* -------------------------------------------------------------------- */
/*      Handle command line arguments.                                  */
/* -------------------------------------------------------------------- */

	for( i = 1; i < argc; i++ ) {
		if( EQUAL(argv[i],"--version") )
			{
				printf( "%s\n", GDALVersionInfo( "--version" ) );
			}

        else if( EQUAL(argv[i],"-quiet") )
			{
				bQuiet = TRUE;
				pfnProgress = GDALDummyProgress;
			}	

		else if( EQUAL(argv[i],"-c") )
			{
				if( atoi(argv[i+1]) < 2 )
					{
						printf( "There must be more columns than %s.\n", argv[i+1] );
						Usage();
						GDALDestroyDriverManager();
						exit( 2 );
					}

				cols = atoi(argv[++i]);
			}

		else if( EQUAL(argv[i],"-r") )
			{
				if( atoi(argv[i+1]) < 2 )
					{
						printf( "There must be more rows than %s.\n", argv[i+1] );
						Usage();
						GDALDestroyDriverManager();
						exit( 2 );
					}

				rows = atoi(argv[++i]);
			}

        else if( argv[i][0] == '-' )
			{
				printf( "Option %s incomplete, or not recognised.\n\n", 
						argv[i] );
				Usage();
				GDALDestroyDriverManager();
				exit( 2 );
			}
		
        else {
			SplitFile(argv[i], cols, rows, bQuiet, pfnProgress);
			j++;
		}
	}

	/* At least one file must be provided */
	if (j == 0) {
		Usage();
		GDALDestroyDriverManager();
		exit( 2 );
	}

/* -------------------------------------------------------------------- */
/*      Clean up.                                                       */
/* -------------------------------------------------------------------- */

	GDALDumpOpenDatasets( stderr );
    GDALDestroyDriverManager();

	exit(0);
}


/************************************************************************/
/*                           AttachMetadata()                           */
/************************************************************************/

static void AttachMetadata( GDALDatasetH hDS, char **papszMetadataOptions )

{
    int nCount = CSLCount(papszMetadataOptions);
    int i;

    for( i = 0; i < nCount; i++ )
		{
			char    *pszKey = NULL;
			const char *pszValue;
        
			pszValue = CPLParseNameValue( papszMetadataOptions[i], &pszKey );
			GDALSetMetadataItem(hDS,pszKey,pszValue,NULL);
			CPLFree( pszKey );
		}

    CSLDestroy( papszMetadataOptions );
}					


/************************************************************************/
/*                           CopyRasterBand()                           */
/*                                                                      */
/*      Add a copy of the specified source band to the destination      */
/*      dataset using only data from a pixel window.                    */
/************************************************************************/

static CPLErr CopyRasterBand(GDALDataset *poSrcDS, GDALDataset *poDstDS, int nBand, int nSrcXOff, int nSrcYOff, int nSrcXSize, int nSrcYSize)
{
	VRTRasterBand   *poVRTBand;
	GDALRasterBand  *poSrcBand;
	GDALDataType    eBandType;
	double          dfNoData;
	int             bSuccess;

	poSrcBand = poSrcDS->GetRasterBand( nBand );

/* -------------------------------------------------------------------- */
/*      Select output data type to match source.                        */
/* -------------------------------------------------------------------- */
	eBandType = poSrcBand->GetRasterDataType();

/* -------------------------------------------------------------------- */
/*      Create this band.                                               */
/* -------------------------------------------------------------------- */
	if (poDstDS->AddBand( eBandType, NULL ) == CE_Failure)
		return CE_Failure;
	
	poVRTBand = (VRTRasterBand *) poDstDS->GetRasterBand( nBand );           

/* -------------------------------------------------------------------- */
/*      Create a simple data source.                                    */
/* -------------------------------------------------------------------- */
	poVRTBand->AddSimpleSource( poSrcBand,
								nSrcXOff, nSrcYOff, 
								nSrcXSize, nSrcYSize, 
								0, 0,
								nSrcXSize, nSrcYSize );

/* -------------------------------------------------------------------- */
/*      copy over some other information of interest.                   */
/* -------------------------------------------------------------------- */
	poVRTBand->SetMetadata( poSrcBand->GetMetadata() );
	poVRTBand->SetColorTable( poSrcBand->GetColorTable() );
	poVRTBand->SetColorInterpretation(poSrcBand->GetColorInterpretation());
	if( strlen(poSrcBand->GetDescription()) > 0 )
		poVRTBand->SetDescription( poSrcBand->GetDescription() );
	dfNoData = poSrcBand->GetNoDataValue( &bSuccess );
	if ( bSuccess )
		poVRTBand->SetNoDataValue( dfNoData );

	return CE_None;
}


/************************************************************************/
/*                           CopyRasterWindow()                         */
/*                                                                      */
/*      Return a virtual dataset representing the specified pixel       */
/*      window of the source dataset.                                   */
/************************************************************************/

static VRTDataset * CopyRasterWindow(GDALDatasetH hSrcDS, int nSrcXOff, int nSrcYOff, int nSrcXSize, int nSrcYSize) 
{
	VRTDataset *poVDS = NULL;
    int nBandCount = 0, i;
    double adfGeoTransform[6];
    const char *pszProjection;
    char **papszMetadataOptions = NULL;
	
	poVDS = new VRTDataset( nSrcXSize, nSrcYSize );

	pszProjection = GDALGetProjectionRef( hSrcDS );
	if( pszProjection != NULL && strlen(pszProjection) > 0 )
		poVDS->SetProjection( pszProjection );
    
	if( GDALGetGeoTransform( hSrcDS, adfGeoTransform ) == CE_None)
		{
			adfGeoTransform[0] += nSrcXOff * adfGeoTransform[1]
				+ nSrcYOff * adfGeoTransform[2];
			adfGeoTransform[3] += nSrcXOff * adfGeoTransform[4]
				+ nSrcYOff * adfGeoTransform[5];
        
			poVDS->SetGeoTransform( adfGeoTransform );
		}

	else if( GDALGetGCPCount( hSrcDS ) > 0 )
		{
			GDAL_GCP *pasGCPs;
			int       nGCPs = GDALGetGCPCount( hSrcDS );

			pasGCPs = GDALDuplicateGCPs( nGCPs, GDALGetGCPs( hSrcDS ) );

			for( i = 0; i < nGCPs; i++ )
				{
					pasGCPs[i].dfGCPPixel -= nSrcXOff;
					pasGCPs[i].dfGCPLine  -= nSrcYOff;
				}
            
			poVDS->SetGCPs( nGCPs, pasGCPs,
							GDALGetGCPProjection( hSrcDS ) );

			GDALDeinitGCPs( nGCPs, pasGCPs );
			CPLFree( pasGCPs );
		}

	poVDS->SetMetadata( ((GDALDataset*)hSrcDS)->GetMetadata() );
	AttachMetadata( (GDALDatasetH) poVDS, papszMetadataOptions );

	nBandCount = GDALGetRasterCount( hSrcDS );
	for( i = 1; i <= nBandCount; i++ )
		{
			CopyRasterBand((GDALDataset *) hSrcDS, poVDS, i, nSrcXOff, nSrcYOff, nSrcXSize, nSrcYSize);
		}

	return poVDS;
}


/************************************************************************/
/*                           SplitFile()                                */
/*                                                                      */
/*      Split the specified file into the required number of tiles.     */
/************************************************************************/

static int SplitFile(const char * pszSource, int cols, int rows, int bQuiet, GDALProgressFunc pfnProgress)
{
    GDALDatasetH hDataset, hOutDS;
    VRTDataset *poVDS;
    int i,x,z;
    int nRasterXSize, nRasterYSize,
		nSrcXOff = 0, nSrcYOff = 0,
		nRoundedXSize, nRoundedYSize,
		nSrcXSize = 0, nSrcYSize = 0;
    GDALDriverH	hDriver;
	char * pszDest;
	
/* -------------------------------------------------------------------- */
/*      Attempt to open source file.                                    */
/* -------------------------------------------------------------------- */

    hDataset = GDALOpen( pszSource, GA_ReadOnly );
    
    if( hDataset == NULL )
		{
			fprintf( stderr,
					 "GDALOpen failed - %d\n%s\n",
					 CPLGetLastErrorNo(), CPLGetLastErrorMsg() );
			return ( 0 );
		}

    if( CSLCount(GDALGetMetadata( hDataset, "SUBDATASETS" )) > 0 )
		{
			fprintf( stderr,
					 "Input file contains subdatasets. Please, select one of them for reading.\n" );
			GDALClose( hDataset );
			return ( 0 );
		}

    nRasterXSize = GDALGetRasterXSize( hDataset );
    nRasterYSize = GDALGetRasterYSize( hDataset );

    if( cols > nRasterXSize )
		{
			fprintf( stderr,
					 "The column count cannot be greater than the image width in pixels.\n" );
			GDALClose( hDataset );
			return ( 0 );
		}

    if( rows > nRasterYSize )
		{
			fprintf( stderr,
					 "The row count cannot be greater than the image height in pixels.\n" );
			GDALClose( hDataset );
			return ( 0 );
		}
	
	if( !bQuiet )
		printf( "Splitting %s size %d, %d into %d files...\n"
				, pszSource, nRasterXSize, nRasterYSize, cols * rows);

/* -------------------------------------------------------------------- */
/*      Find the output driver.                                         */
/* -------------------------------------------------------------------- */

	hDriver = GDALGetDatasetDriver( hDataset );
	
/* -------------------------------------------------------------------- */
/*      Establish some parameters.                                      */
/* -------------------------------------------------------------------- */

	nRoundedXSize = (int) round(nRasterXSize / (double) cols);
	nRoundedYSize = (int) round(nRasterYSize / (double) rows);

/* -------------------------------------------------------------------- */
/*      Make a virtual clone.                                           */
/* -------------------------------------------------------------------- */

	for (i = 1, z = 1, nSrcXOff = 0; i <= cols; i++, nSrcXOff += nSrcXSize) {
		nSrcXSize = (i != cols) ? nRoundedXSize : nRasterXSize - nRoundedXSize;

		for (x = 1, nSrcYOff = 0; x <= rows; x++, z++, nSrcYOff += nSrcYSize) {
			pszDest = CreateFileName(pszSource, i, x);

			if (!pszDest)
				return FALSE;

			nSrcYSize = (x != rows) ? nRoundedYSize : nRasterYSize - nRoundedYSize;

			if (!bQuiet)
				printf("%d. %s size is %d, %d\n  ", z, pszDest, nSrcXSize, nSrcYSize);

			poVDS = CopyRasterWindow(hDataset, nSrcXOff, nSrcYOff, nSrcXSize, nSrcYSize);

/* -------------------------------------------------------------------- */
/*      Write to the output file using CopyCreate().                    */
/* -------------------------------------------------------------------- */
			hOutDS = GDALCreateCopy( hDriver, pszDest, (GDALDatasetH) poVDS,
									 TRUE, NULL, 
									 pfnProgress, NULL );
			if ( hOutDS != NULL )
				{
					GDALClose( hOutDS );
				}

			GDALClose( (GDALDatasetH) poVDS );

			free(pszDest);
		}
	}
	
    GDALClose( hDataset );
    
    return ( hOutDS != NULL );
}


/************************************************************************/
/*                           CreateString()                             */
/*                                                                      */
/*      Takes printf() arguments and formats output to appropriately    */
/*      allocated string.                                               */
/*      The code is adapted from that found in the glibc vsnprintf      */
/*      man page.                                                       */
/*      It is up to the caller to free the result.                      */
/************************************************************************/

static char * CreateString(const char *fmt, ...) {
	/* Guess we need no more than 100 bytes. */
	int n, size = 100;
	char *p;
	va_list ap;
	if ((p = (char *) malloc (size)) == NULL)
		return NULL;
	while (1) {
		/* Try to print in the allocated space. */
		va_start(ap, fmt);
		n = vsnprintf (p, size, fmt, ap);
		va_end(ap);
		/* If that worked, return the string. */
		if (n > -1 && n < size)
			return p;
		/* Else try again with more space. */
		if (n > -1)    /* glibc 2.1 */
			size = n+1; /* precisely what is needed */
		else           /* glibc 2.0 */
			size *= 2;  /* twice the old size */
		if ((p = (char *) realloc (p, size)) == NULL)
			return NULL;
	}
}


/************************************************************************/
/*                           CreateFileName()                           */
/*                                                                      */
/*      Create filename based on source filename but specifying         */
/*		required column and row.                                        */
/*      It is up to the caller to free the result.                      */
/************************************************************************/

static char * CreateFileName(const char *pszSource, int col, int row) 
{
	char *basename = GetBasename(pszSource);
	char *dirname = GetDirname(pszSource);
	char *ext = GetExtension(basename);
	char *filename;

	if (ext) {
		basename[(strlen(basename) - strlen(ext))-1] = '\0';
		filename = CreateString("%s%c%s_c%d_r%d.%s", dirname, PATH_SEP_CHAR, basename, col, row, ext);
	} else {
		filename = CreateString("%s%c%s_c%d_r%d", dirname, PATH_SEP_CHAR, basename, col, row);
	}

	free(dirname);
	free(basename);
	free(ext);

	return filename;
}


/************************************************************************/
/*                           GetExtension()                             */
/*                                                                      */
/*      Return the extension portion of a filename or NULL if none      */
/*		is present.                                                     */
/*      It is up to the caller to free the result.                      */
/************************************************************************/

static char * GetExtension(const char *basename) 
{
	char *ext;
	char *p = rindex(basename, '.');
	if (!p)
		return NULL;

	if (p < rindex(basename, PATH_SEP_CHAR))
		return NULL;

	if ((ext = (char *) malloc (strlen(p))) == NULL) /* no need to do strlen(p + 1) because we are going to disregard the '.' */
		return NULL;

	strcpy(ext, ++p);

	return ext;
}


/************************************************************************/
/*                           GetDirname()                               */
/*                                                                      */
/*      Return the directory portion of a filename or '.' if none       */
/*		is present.                                                     */
/*      It is up to the caller to free the result.                      */
/*      Code adapted from bash dirname command.                         */
/************************************************************************/

static char * GetDirname(const char *string)
{
	int slen;
	char * psTmp;
	char *dirname;

	slen = strlen (string);

	/* Strip trailing slashes */
	while (slen > 0 && string[slen - 1] == PATH_SEP_CHAR)
		slen--;

	/* (2) If string consists entirely of slash characters, string shall be
	   set to a single slash character.  In this case, skip steps (3)
	   through (8). */
	if (slen == 0)
		return CreateString("%c", PATH_SEP_CHAR);

	if ((psTmp = (char *) malloc (slen+1)) == NULL)
		return NULL;

	strcpy(psTmp, string);
	
	/* (3) If there are any trailing slash characters in string, they
	   shall be removed. */
	psTmp[slen] = '\0';

	/* (4) If there are no slash characters remaining in string, string
	   shall be set to a single period character.  In this case, skip
	   steps (5) through (8).

	   (5) If there are any trailing nonslash characters in string,
	   they shall be removed. */

	while (--slen >= 0)
		if (psTmp[slen] == PATH_SEP_CHAR)
			break;

	if (slen < 0)
		{
			free(psTmp);
			return CreateString(".");
		}

	/* (7) If there are any trailing slash characters in string, they
	   shall be removed. */
	while (--slen >= 0)
		if (psTmp[slen] != PATH_SEP_CHAR)
			break;
	psTmp[++slen] = '\0';

	/* (8) If the remaining string is empty, string shall be set to a single
	   slash character. */
	if (slen == 0)
		dirname = CreateString("%c", PATH_SEP_CHAR);
	else
		dirname = CreateString("%s", psTmp);
	free(psTmp);

	return dirname;
}


/************************************************************************/
/*                           GetBasename()                              */
/*                                                                      */
/*      Return the basename of a filename, including extension.         */
/*      It is up to the caller to free the result.                      */
/*      Code adapted from bash basename command.                        */
/************************************************************************/

static char * GetBasename(const char *string)
{
	int slen;
	char *psTmp, *psTmp2, *psTmp3;
	
	slen = strlen (string);

	/* Strip trailing slashes */
	while (slen > 0 && string[slen - 1] == PATH_SEP_CHAR)
		slen--;

	/* (2) If string consists entirely of slash characters, string shall be
	   set to a single slash character.  In this case, skip steps (3)
	   through (5). */
	if (slen == 0)
		return CreateString("%c", PATH_SEP_CHAR);
	
	if ((psTmp = (char *) malloc (slen+1)) == NULL)
		return NULL;

	strcpy(psTmp, string);
	
	/* (3) If there are any trailing slash characters in string, they
	   shall be removed. */
	psTmp[slen] = '\0';

	/* (4) If there are any slash characters remaining in string, the prefix
	   of string up to an including the last slash character in string
	   shall be removed. */
	while (--slen >= 0)
		if (psTmp[slen] == PATH_SEP_CHAR)
			break;

	if (slen == 0)
		return psTmp;

	for (psTmp2 = &psTmp[slen+1], psTmp3 = psTmp; *psTmp2 != '\0'; psTmp2++, psTmp3++)
		*psTmp3 = *psTmp2;

	*(psTmp3++) = '\0';

	return psTmp;
}
-------------- next part --------------
.TH "gdalsplit" 1 "14 Sept 2004" "gdalsplit" \" -*- nroff -*-
.ad l
.nh
.SH NAME
gdalsplit \- splits raster datasource(s) into tiles 
.SH "SYNOPSIS"
.PP
.PP
.PP
.nf

Usage: gdalsplit [--version]
       [-c cols]
       [-r rows]
       [-quiet]
       src_dataset...
.PP
.SH "DESCRIPTION"
.PP
Split one or more raster datasources into more manageable tiles. This
is, for instance, useful in conjunction with the \fBgdaltindex\fP
program. The output files are created in the same directory as the
source files. The source dataset is not deleted. 
.PP
The output datasets are not guaranteed to be of equal pixel size
unless the columns and rows specified exactly divide into the source
dataset width and height respectively.
.PP
.IP "\fB\fB-c\fP cols\fP:\fP" 1c
Select the number of columns \fBcols\fP to split the source dataset into. The default is 2.
.IP "\fB\fB-r\fP rows\fP:\fP" 1c
Select the number of rows \fBrows\fP to split the source dataset into. The default is 2.
.IP "\fB\fB-quiet\fP:\fP" 1c
Supress progress monitor and other non-error output. 
.IP "\fB\fIsrc_dataset\fP:\fP" 1c
The source file name. 
.PP
.SH "EXAMPLE"
.PP
.PP
.PP
.nf

% gdalsplit -c 3 -r 3 utm.tif
.PP
produces the following 9 files:
.nf

utm_c1_r1.tif
utm_c1_r2.tif
utm_c1_r3.tif
utm_c2_r1.tif
utm_c2_r2.tif
utm_c2_r3.tif
utm_c3_r1.tif
utm_c3_r2.tif
utm_c3_r3.tif
.PP
.SH "AUTHORS"
.PP
Homme Zwaagstra <geodata@soton.ac.uk> 
From gwoc at uol.com.br  Wed Sep 15 11:26:23 2004
From: gwoc at uol.com.br (Gustavo Wagner)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Anyone has ever built GDAL using RHIDE/DJGPP on Windows
Message-ID: <loom.20040915T172103-163@post.gmane.org>

I`ve been using RHIDE/DJGPP on windows for project i am working at.

I am on need to read several DEMs,DTMs and raster images on my program and I 
found GDAL to be almost exactaly what I was looking for. Congratulations for 
anyone involved on it.
But GDAL is very big indeed, and I don`t know if I can build it with my 
application without help.

Thanks in advance for any help



From t.r.decarlo at larc.nasa.gov  Thu Sep 16 13:24:49 2004
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] How to add a NODATA flag to GTiff data?
Message-ID: <006d01c49c12$1217a3a0$959877c6@cts1149>

Hello,
I've got several IFSAR DEM files in geotiff format. Each has a border of
NODATA values (-9999.0) around the real data. My OpenSceneGraph application
(osgdem, which uses gdal to read the input data) should understand that the
default NODATA value is -9999, but it uses that value instead of ignoring
it. 

I remember that when I translated ArcGrid data, which had NODATA values
defined in the header, to geotiff the output had a NODATA field in the
header. My question now is how do I add the NODATA field to the geotiff file
when translating from geotiff or Erdas Imagine format?

Thanks,
Thom



From wlyons at prologic-inc.com  Thu Sep 16 13:40:30 2004
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Some newbie can't open MrSID
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DB78E9E@vader.prologic-inc.com>

Hello,

After successfully building the source (kudos for the relatively
painless build even in windows), I've been learning all I can about how
to use GDAL from the online tutorials.  But, I have hit a snag.  I can't
open MrSID files.  I tried the following:

    GDALDatasetH  hDataset;
    GDALAllRegister();
    hDataset = GDALOpen( argv[1], GA_ReadOnly );
    if( hDataset == NULL )
    {
		printf("File not opened\n");
		return 1;
    }

	const char *sidFormat = "MrSID";
    GDALDriverH sidDriver = GDALGetDriverByName( sidFormat );
    char **sidMetadata;

    if( sidDriver == NULL )
	{
		printf( "No MrSID Support!!" );
        exit( 1 );
	}

Most of it is straight out of the tutorial and I always get "No MrSID
Support!!"

Thanks,
William Lyons



From warmerdam at pobox.com  Thu Sep 16 13:53:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] How to add a NODATA flag to GTiff data?
In-Reply-To: <006d01c49c12$1217a3a0$959877c6@cts1149>
References: <006d01c49c12$1217a3a0$959877c6@cts1149>
Message-ID: <4149D300.90102@pobox.com>

Thom DeCarlo wrote:
> Hello,
> I've got several IFSAR DEM files in geotiff format. Each has a border of
> NODATA values (-9999.0) around the real data. My OpenSceneGraph application
> (osgdem, which uses gdal to read the input data) should understand that the
> default NODATA value is -9999, but it uses that value instead of ignoring
> it. 
> 
> I remember that when I translated ArcGrid data, which had NODATA values
> defined in the header, to geotiff the output had a NODATA field in the
> header. My question now is how do I add the NODATA field to the geotiff file
> when translating from geotiff or Erdas Imagine format?

Thom,

Currently gdal_translate has no mechanism to set a nodata value during
translation.  However, you can convert a file to VRT format, and hand
edit in a nodata value then translate that back to TIFF.

eg.
   gdal_translate -of VRT in.tif work.vrt
   edit work.vrt (add <NoDataValue>-9999</NoDataValue> tag on VRTRasterBand).
   gdal_translate work.vrt out.tif

It would be nice to have a smoother way of doing this of course.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 16 13:58:28 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] Some newbie can't open MrSID
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DB78E9E@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DB78E9E@vader.prologic-inc.com>
Message-ID: <4149D444.2020306@pobox.com>

William Lyons wrote:
> Hello,
> 
> After successfully building the source (kudos for the relatively
> painless build even in windows), I've been learning all I can about how
> to use GDAL from the online tutorials.  But, I have hit a snag.  I can't
> open MrSID files.  I tried the following:
> 
>     GDALDatasetH  hDataset;
>     GDALAllRegister();
>     hDataset = GDALOpen( argv[1], GA_ReadOnly );
>     if( hDataset == NULL )
>     {
> 		printf("File not opened\n");
> 		return 1;
>     }
> 
> 	const char *sidFormat = "MrSID";
>     GDALDriverH sidDriver = GDALGetDriverByName( sidFormat );
>     char **sidMetadata;
> 
>     if( sidDriver == NULL )
> 	{
> 		printf( "No MrSID Support!!" );
>         exit( 1 );
> 	}

William,

You haven't given much info on how you built the software.  Do you have
the MrSID SDK and did you modify your nmake.opt to use them?  If not then
you just don't have MrSID support!

One reason the GDAL windows build is *relatively* easy is that by default
all external dependences are disabled but with that goes lots of formats
that depend on external libraries.

If you have included the MrSID SDK then try doing a clean build.  Especially
on windows the makefile dependencies are often not sufficient to rebuild
all required components when the configuration or include files change.

eg.

   nmake /f makefile.vc clean
   nmake /f makefile.vc

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 16 16:54:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
Message-ID: <4149FD8B.7000802@pobox.com>

Folks,

I have cut a GDAL 1.2.2 release, and this is also my "coming out" with the
new gdal.org domain.

Currently gdal.org is hosted on a kind of crappy web server where I can't even
run scripts to update the web site.  This means that the web site is
updated manually (aka - not so frequently) and email, bugzilla, cvs and ftp
services containue to be hosted by others (DMSolutions via maptools.org
and ImageLinks and IDS for the remotesensing.org services).  But the www.gdal.org
web/download service has cheap bandwidth so I am a bit less of a drain on everyone
else.

I encourage you to grab release downloads from

   http://www.gdal.org/dl

though daily snapshots are still only available from:

   http://gdal.maptools/org/dl/daily

The NEWS file can be read at:

   http://www.gdal.org/NEWS.html

The following are new for 1.2.2:

GDAL 1.2.2 - Overview of Changes
--------------------------------

GRASS Driver:
     - Add Radim's version of the driver submitted by Radim.  This version
       uses GRASS 5.7 libraries directly instead of using libgrass.

DODS Driver:
     - Added support for spatial_ref, FlipX and FlipY .das info.

CPG Driver:
     - added new driver for Convair Polarmetric format.

HDF Driver:
     - Significant bugs fixed.

USGS DEM Driver:
     - Support writing UTM projected files.

PNG Driver:
     - Upgraded to libpng 1.2.6.

MrSID Driver:
     - Substantial performance improvements.
     - Support for DSDK 4.x
     - Support JPEG2000 files via MrSID SDK.

NITF Driver:
     - Support JPEG2000 compressed files (with Kakadu support)

ESRI BIL:
     - Support .clr color files.

VRT Driver:
     - Added support for describing raw files with VRTRawRasterBand.
     - Added support for virtual warped files with VRTWarpedRasterBand.

GeoTIFF Driver:
     - Fix support for 16bit image color tables.
     - Write ExtraSamples tag for files with more samples than expected
       in photometric interpretation.
     - External overviews now built for read-only files.

Erdas Imagine Driver:
     - Fixed support for compressed floating point layers.
     - Various other fixes for compatible with newer Imagine versions.
     - improved metadata handling.

gdal_merge.py:
     - sets projection on output file.


OGR 1.2.2 - Overview of Changes
-------------------------------

SQLite Driver:
     - New read/write driver implemented for SQLite databases.

CSV Driver:
     - New read/write driver implemented for comma seperated value files.

S-57 Driver:
     - Substantial performance improvements.

ODBC Driver:
     - Arbitrary length field values now supported.

GEOS:
     - Integration a series of methods utilizing GEOS when available.  Note
       that Intersect() is still just an envelope comparison.

OGRSpatialReference:
     - Fixed Swiss Oblique Mercator support.

A new OpenEV_FW 1.8.2 synced with GDAL 1.2.2 should following within a few
hours.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From lists at webmapit.com.br  Thu Sep 16 18:56:01 2004
From: lists at webmapit.com.br (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
In-Reply-To: <4149FD8B.7000802@pobox.com>
References: <4149FD8B.7000802@pobox.com>
Message-ID: <20040916225601.25291.qmail@hm47.locaweb.com.br>

# Hi Frank,

On Thu, 16 Sep 2004 16:54:35 -0400, Frank Warmerdam <warmerdam@pobox.com> escreveu:

> De: Frank Warmerdam <warmerdam@pobox.com>
> Data: Thu, 16 Sep 2004 16:54:35 -0400
> Para: gdal-dev <gdal-dev@remotesensing.org>,	FreeGIS <freegis-list@intevation.de>
> Assunto: [Gdal-dev] GDAL 1.2.2 Released
> 
> Folks,
> 
[...]

> 
> GDAL 1.2.2 - Overview of Changes
> --------------------------------
> 
[...]

> 
> OGR 1.2.2 - Overview of Changes
> -------------------------------
> 
> SQLite Driver:
>      - New read/write driver implemented for SQLite databases.

# it means will be possible to store POINTS tables on databases such as MySQL, Informix, MSSQL, DB2, etc a then display these data using tools like MapServer ? or it will also possible to store complex geometries(line/poly's)?

> 
> CSV Driver:
>      - New read/write driver implemented for comma seperated value files.

# I never used this OGR option... what is it for? it is possible to load a CVS like:

POINTID;NAME;X;Y
0;A;210.5;53
1;B;268;9.68
... and so on...

> 
> 
> GEOS:
>      - Integration a series of methods utilizing GEOS when available.  Note
>        that Intersect() is still just an envelope comparison.

# cool... means OGR can make topological tests?

> 
> OGRSpatialReference:
>      - Fixed Swiss Oblique Mercator support.
> 
> A new OpenEV_FW 1.8.2 synced with GDAL 1.2.2 should following within a few
> hours.
> 
> Best regards,

# best.

Eduardo Patto Kanegae
http://www.webmapit.com.br
UIN: 303747254

Treinamento em UMN MapServer - http://www.webmapit.com.br/ptbr/?menuoption=mapserver
F?rum MapServer Brasil - http://mapserver.cttmar.univali.br/forum

***Fim da Mensagem / End of Message ***



> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 
> 

From warmerdam at pobox.com  Thu Sep 16 19:08:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:23 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
In-Reply-To: <20040916225601.25291.qmail@hm47.locaweb.com.br>
References: <4149FD8B.7000802@pobox.com>
	<20040916225601.25291.qmail@hm47.locaweb.com.br>
Message-ID: <414A1CDD.7030904@pobox.com>

Eduardo Patto Kanegae wrote:

>>SQLite Driver:
>>     - New read/write driver implemented for SQLite databases.
> 
> 
> # it means will be possible to store POINTS tables on databases such 
 > as MySQL, Informix, MSSQL, DB2, etc a then display these data using
 > tools like MapServer ? or it will also possible to store complex
 > geometries(line/poly's)?

Eduardo,

The above comment just refers to a driver being implemented for the SQLite
database system (http://www.sqlite.org).  It doesn't help with any of the
databases you mention.

However, OGR also has support for ODBC data connections and this has been
used to read data from a variety of RDBMS systems.  Note that the ODBC
driver has limited support for geometries from these tables, and it is
sometimes necessary to use the OGR VRT (virtual) driver as an extra
layer to indicate what fields of a table from ODBC should be used as x, y
or as well known text style geometry.

I would suggest you read up on the VRT and ODBC OGR drivers if you are
interested in this.

>>CSV Driver:
>>     - New read/write driver implemented for comma seperated value files.
> 
> 
> # I never used this OGR option... what is it for? it is possible to load a CVS like:
> 
> POINTID;NAME;X;Y
> 0;A;210.5;53
> 1;B;268;9.68
> ... and so on...

Yes, but there is no implicit knowledge in OGR that X and Y are location
information.   This would have to be interpreted by a VRT datasource
referring to the CSV datasource.

I would add that your example uses semi-colons as field seperateors.
Currently the CSV only supports _comma_ seperated value files.

>>
>>GEOS:
>>     - Integration a series of methods utilizing GEOS when available.  Note
>>       that Intersect() is still just an envelope comparison.
> 
> 
> # cool... means OGR can make topological tests?

Yes. There are methods on the OGRGeometry to do various topological
tests now.  There are also methods for converting between OGR and GEOS
geometry formats if you want to use other GEOS capabilities directly.

You might want to skim the OGRGeometry method list for stuff like
Intersect(), Touches(), Overlaps(), ConvexHull(), Buffer(),
Intersection() and Difference().

   http://www.gdal.org/ogr/classOGRGeometry.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From lists at webmapit.com.br  Thu Sep 16 20:32:28 2004
From: lists at webmapit.com.br (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
In-Reply-To: <414A1CDD.7030904@pobox.com>
References: <414A1CDD.7030904@pobox.com>
Message-ID: <20040917003228.9836.qmail@hm47.locaweb.com.br>



On Thu, 16 Sep 2004 19:08:13 -0400, Frank Warmerdam <warmerdam@pobox.com> escreveu:

> De: Frank Warmerdam <warmerdam@pobox.com>
> Data: Thu, 16 Sep 2004 19:08:13 -0400
> Para: Eduardo Patto Kanegae <lists@webmapit.com.br>
> Assunto: Re: [Gdal-dev] GDAL 1.2.2 Released
> 
> Eduardo Patto Kanegae wrote:
> 
> >>SQLite Driver:
> >>     - New read/write driver implemented for SQLite databases.
> > 
> > 
> > # it means will be possible to store POINTS tables on databases such 
>  > as MySQL, Informix, MSSQL, DB2, etc a then display these data using
>  > tools like MapServer ? or it will also possible to store complex
>  > geometries(line/poly's)?
> 
> Eduardo,
> 
> The above comment just refers to a driver being implemented for the SQLite
> database system (http://www.sqlite.org).  It doesn't help with any of the
> databases you mention.

# ops... :-) ... sorry my ignorance folks. I thought sqlite was a database framewok like ADO or ODBC.
> 
> However, OGR also has support for ODBC data connections and this has been
> used to read data from a variety of RDBMS systems.  Note that the ODBC
> driver has limited support for geometries from these tables, and it is
> sometimes necessary to use the OGR VRT (virtual) driver as an extra
> layer to indicate what fields of a table from ODBC should be used as x, y
> or as well known text style geometry.
> 
> I would suggest you read up on the VRT and ODBC OGR drivers if you are
> interested in this.

# thanks Frank,

best

Eduardo

> 
> >>CSV Driver:
> >>     - New read/write driver implemented for comma seperated value files.
> > 
> > 
> > # I never used this OGR option... what is it for? it is possible to load a CVS like:
> > 
> > POINTID;NAME;X;Y
> > 0;A;210.5;53
> > 1;B;268;9.68
> > ... and so on...
> 
> Yes, but there is no implicit knowledge in OGR that X and Y are location
> information.   This would have to be interpreted by a VRT datasource
> referring to the CSV datasource.
> 
> I would add that your example uses semi-colons as field seperateors.
> Currently the CSV only supports _comma_ seperated value files.
> 
> >>
> >>GEOS:
> >>     - Integration a series of methods utilizing GEOS when available.  Note
> >>       that Intersect() is still just an envelope comparison.
> > 
> > 
> > # cool... means OGR can make topological tests?
> 
> Yes. There are methods on the OGRGeometry to do various topological
> tests now.  There are also methods for converting between OGR and GEOS
> geometry formats if you want to use other GEOS capabilities directly.
> 
> You might want to skim the OGRGeometry method list for stuff like
> Intersect(), Touches(), Overlaps(), ConvexHull(), Buffer(),
> Intersection() and Difference().
> 
>    http://www.gdal.org/ogr/classOGRGeometry.html
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> 
> 
> 

From carueda at ucdavis.edu  Thu Sep 16 21:49:38 2004
From: carueda at ucdavis.edu (Carlos A. Rueda)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: GDAL 1.2.2 Released
In-Reply-To: <4149FD8B.7000802@pobox.com>
References: <4149FD8B.7000802@pobox.com>
Message-ID: <414A42B2.3060201@ucdavis.edu>

Great! and congrats also for the new site.

Thanks for the good work.

carlos

ps. I have an observation, however: it's not compiling for me..
to be concrete it fails while entering directory frmts/airsar/,
which I notice it's empty.



Frank Warmerdam wrote:
> Folks,
> 
> I have cut a GDAL 1.2.2 release, and this is also my "coming out" with the
> new gdal.org domain.
> 
> Currently gdal.org is hosted on a kind of crappy web server where I 
> can't even
> run scripts to update the web site.  This means that the web site is
> updated manually (aka - not so frequently) and email, bugzilla, cvs and ftp
> services containue to be hosted by others (DMSolutions via maptools.org
> and ImageLinks and IDS for the remotesensing.org services).  But the 
> www.gdal.org
> web/download service has cheap bandwidth so I am a bit less of a drain 
> on everyone
> else.
> 
> I encourage you to grab release downloads from
> 
>   http://www.gdal.org/dl
> 
> though daily snapshots are still only available from:
> 
>   http://gdal.maptools/org/dl/daily
> 
> The NEWS file can be read at:
> 
>   http://www.gdal.org/NEWS.html
> 
> The following are new for 1.2.2:
> 
> GDAL 1.2.2 - Overview of Changes
> --------------------------------
> 
> GRASS Driver:
>     - Add Radim's version of the driver submitted by Radim.  This version
>       uses GRASS 5.7 libraries directly instead of using libgrass.
> 
> DODS Driver:
>     - Added support for spatial_ref, FlipX and FlipY .das info.
> 
> CPG Driver:
>     - added new driver for Convair Polarmetric format.
> 
> HDF Driver:
>     - Significant bugs fixed.
> 
> USGS DEM Driver:
>     - Support writing UTM projected files.
> 
> PNG Driver:
>     - Upgraded to libpng 1.2.6.
> 
> MrSID Driver:
>     - Substantial performance improvements.
>     - Support for DSDK 4.x
>     - Support JPEG2000 files via MrSID SDK.
> 
> NITF Driver:
>     - Support JPEG2000 compressed files (with Kakadu support)
> 
> ESRI BIL:
>     - Support .clr color files.
> 
> VRT Driver:
>     - Added support for describing raw files with VRTRawRasterBand.
>     - Added support for virtual warped files with VRTWarpedRasterBand.
> 
> GeoTIFF Driver:
>     - Fix support for 16bit image color tables.
>     - Write ExtraSamples tag for files with more samples than expected
>       in photometric interpretation.
>     - External overviews now built for read-only files.
> 
> Erdas Imagine Driver:
>     - Fixed support for compressed floating point layers.
>     - Various other fixes for compatible with newer Imagine versions.
>     - improved metadata handling.
> 
> gdal_merge.py:
>     - sets projection on output file.
> 
> 
> OGR 1.2.2 - Overview of Changes
> -------------------------------
> 
> SQLite Driver:
>     - New read/write driver implemented for SQLite databases.
> 
> CSV Driver:
>     - New read/write driver implemented for comma seperated value files.
> 
> S-57 Driver:
>     - Substantial performance improvements.
> 
> ODBC Driver:
>     - Arbitrary length field values now supported.
> 
> GEOS:
>     - Integration a series of methods utilizing GEOS when available.  Note
>       that Intersect() is still just an envelope comparison.
> 
> OGRSpatialReference:
>     - Fixed Swiss Oblique Mercator support.
> 
> A new OpenEV_FW 1.8.2 synced with GDAL 1.2.2 should following within a few
> hours.
> 
> Best regards,



From ealpert at digitalglobe.com  Thu Sep 16 22:04:35 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GCP's, Warping and Source Data Projections
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16147A72@COMAIL01.digitalglobe.com>

Well I've done some good GDAL documentation reading in the past couple days trying to get a handle on what I'm trying to do with respect to GDAL's data model and I'm left with more questions than answers.
 
I've boiled them down to one which if I can get a handle on I might be to conceptually work my way through the rest.
 
Being pretty ignorant I figured that gdal's GCP's support could infer a projection.  Which means I believed that by providing geographic coordinates and pixel/line coordinates that GDAL would some how infer a custom projection for my input data.
 
Is this truly a misconception?
 
The documentation for GDALCreateGenImgProjTransformer seems to suggest this but I can't really find any references to how GCPs need to be related spatially for it to work or whether my source needs to be in a known projection.
 
My data is reduced resolution raw satellite imagery. By raw I mean there's been no ortho-rectification. In real world coordinates my pixel size can vary a lot. 
 
I do have lots of useful information about my data. I have ephemeris, attitude, bearing angle and off nadir angle data. I also have anywhere from 4 to 40 geographic coordinates that define the polygon of the strip (my GCP's) depending on the length of the strip. Each strip can often bend and stretch through out it's scan.
 
So anyway it seems to me I have enough to define a unique projection for each strip of satellite imagery. My question is do I really need to go through all of this? I'm not looking for the most accurate projection but I'm looking for a better way to do it than I am currently.
 
So the utility gdalwarp doesn't like my GCP's for higher order warping and produces an awkwardly placed warped image when using -order 1.  The only thing I can think of is that I have some misconception of how to classify my data's coordinate system,  I'm doing something wrong with preparing it or I need to look into the utility that initially generated the 4-40 GCP's of this data.
 
Thanks,
 
-ethan
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040916/cde77ff5/attachment.html
From warmerdam at pobox.com  Thu Sep 16 23:15:03 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GCP's, Warping and Source Data Projections
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB16147A72@COMAIL01.digitalglobe.com>
References: <1FB6937A87F9074C9A2B8F9D9137EB16147A72@COMAIL01.digitalglobe.com>
Message-ID: <414A56B7.8040304@pobox.com>

Ethan Alpert wrote:
> Being pretty ignorant I figured that gdal's GCP's support could infer a 
> projection.  Which means I believed that by providing geographic 
> coordinates and pixel/line coordinates that GDAL would some how infer a 
> custom projection for my input data.
>  
> Is this truly a misconception?

Ethan,

I'm not sure what you mean by this.  Certainly GDAL does not have any
mechanism to take a set of pixel/line to lat/long GCPs and from them
infer a projected coordinate system appropriate for the image.

However, given GCPs you should be able to rectify or even reproject
the image to some new coordinate system.  The caveat is that the
available low order polynomials behave very poorly for "interesting"
image geometries.

What you really need for raw image views that include a substantial
chunk of the globe is:
  1) a real projection that describes the geometry of the image.  For
     instance the "space oblique mercator" (as I understand it) is a
     projection that describes the geometry of scenes taken from
     satellites like landsat.  If you could describe your image in terms
     of a valid projection you could use gdalwarp to warp it accurately.

  2) a better GCP based trasnformation function than low order polynomials.
     When I was at PCI we had a transformation called thin-plate splines.
     I didn't really understand the math of it, but basically there
     were terms in the equation for each GCP provided and it was an
     exact transformation at the GCPs and it varied "smoothly and
     reasonably" between the GCPs.  If you had decent GCP coverage for
     an image it would give you as well behaved warp.  Other rubber sheeting
     approaches might also work similarly.

GDAL unfortunately lacks any such transfomration that works smoothly
for complex geometries.  This is definately an area I would like to improve
GDAL.  Any deeper minds than mine interested in working on that are welcome!
Certainly papers exist in the literature for a variety of good rubber sheeting
methods, but I have not had the time, patience or mathematical depth to apply
them.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Sep 17 00:13:22 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OpenEV_FW 1.8.2
Message-ID: <414A6462.5070604@pobox.com>

Folks,

A new OpenEV_FW release is now available at:

   http://gdal.org/dl/openev/OpenEV_FW_182.zip

This is based on the 1.2.2 release of GDAL (just out today).  It also
resolves a few quirks with JPEG in TIFF, and HDF support along with any
other recent changes in included packages.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ben at vterrain.org  Fri Sep 17 00:40:28 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] memory leaks (?) from using importFromESRI
In-Reply-To: <414A6462.5070604@pobox.com>
Message-ID: <000001c49c70$75532530$f400fe0a@TOPP2>


When i call:  OGRSpatialReference::importFromESRI()
it calls:  InitDatumMappingTable()

which allocates a bunch of stuff, including a big array like this:
    papszDatumMapping = (char
**)CPLCalloc(sizeof(char*),nMaxDatumMappings*3);

This memory never seems to get freed.  I looked for, but didn't find, a
function like FreeDatumMappingTable().

Is there any way to avoid this leak?

Thanks,
Ben


From warmerdam at pobox.com  Fri Sep 17 01:48:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] memory leaks (?) from using importFromESRI
In-Reply-To: <000001c49c70$75532530$f400fe0a@TOPP2>
References: <000001c49c70$75532530$f400fe0a@TOPP2>
Message-ID: <414A7A9C.4040004@pobox.com>

Ben Discoe wrote:
> When i call:  OGRSpatialReference::importFromESRI()
> it calls:  InitDatumMappingTable()
> 
> which allocates a bunch of stuff, including a big array like this:
>     papszDatumMapping = (char
> **)CPLCalloc(sizeof(char*),nMaxDatumMappings*3);
> 
> This memory never seems to get freed.  I looked for, but didn't find, a
> function like FreeDatumMappingTable().
> 
> Is there any way to avoid this leak?

Ben,

There does not seem to be a way around this.  If you file a bug on it, I will
try to rectify this by the 1.2.3 release.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Sep 17 02:10:55 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: GDAL 1.2.2 Released
In-Reply-To: <414A42B2.3060201@ucdavis.edu>
References: <4149FD8B.7000802@pobox.com> <414A42B2.3060201@ucdavis.edu>
Message-ID: <414A7FEF.4010201@pobox.com>

Carlos A. Rueda wrote:
> ps. I have an observation, however: it's not compiling for me..
> to be concrete it fails while entering directory frmts/airsar/,
> which I notice it's empty.

Doh!

The GDAL 1.2.2 release has been reissued and reuploaded.  Either edit
the "airsar" item out of your GDALmake.opt.in (or GDALmake.opt) or download
and use the updated 1.2.2 release.

AIRSAR Polarmetric format support is not yet ready.  The makefile change
slipped into CVS by accident.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Jeroen.Ticheler at fao.org  Fri Sep 17 07:45:25 2004
From: Jeroen.Ticheler at fao.org (Jeroen Ticheler)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] HDF config question...
Message-ID: <104FF7CA-089F-11D9-979C-000A95D05840@fao.org>

Hi Nicholas!
I read your (old) thread on problems compiling HDF into GDAL. I found a 
solution (working on MAC OS X) after facing exactly the same error 
message:
on line 226 I added hdf as a format, don't know why it was not there. 
It now reads as

GDAL_FORMATS = 	gxf gtiff hfa hdf4 aigrid aaigrid ceos ceos2 iso8211 
xpm \
		sdts raw dted mem jdem envisat elas fit vrt usgsdem l1b \
		nitf bmp pcidsk \
		@OPT_GDAL_FORMATS@

It than found the libraries.

Before doing this I also ran:

sudo ranlib /usr/local/lib/libmfhdf.a

but I'm not sure if that was needed really.

Hope it still helps, if not maybe it does for others.
Ciao,
Jeroen


From pagameba at magma.ca  Fri Sep 17 08:26:28 2004
From: pagameba at magma.ca (Paul Spencer)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
In-Reply-To: <4149FD8B.7000802@pobox.com>
References: <4149FD8B.7000802@pobox.com>
Message-ID: <414AD7F4.7040008@magma.ca>

Frank,

what is the state of the python bindings related to the geos functions? 
  I'm interested in building some user-land tools in openev for 
combining vector geometries and creating buffers (for instance).

Cheers,

Paul

Frank Warmerdam wrote:
> Folks,
> 
...
> 
> GEOS:
>     - Integration a series of methods utilizing GEOS when available.  Note
>       that Intersect() is still just an envelope comparison.
> 

-- 
  -----------------------------------------------------------------
|Paul Spencer                           pspencer@dmsolutions.ca   |
|-----------------------------------------------------------------|
|Applications & Software Development                              |
|DM Solutions Group Inc                 http://www.dmsolutions.ca/|
  -----------------------------------------------------------------


From warmerdam at pobox.com  Fri Sep 17 09:04:11 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL 1.2.2 Released
In-Reply-To: <414AD7F4.7040008@magma.ca>
References: <4149FD8B.7000802@pobox.com> <414AD7F4.7040008@magma.ca>
Message-ID: <414AE0CB.9070709@pobox.com>

Paul Spencer wrote:
> Frank,
> 
> what is the state of the python bindings related to the geos functions? 
>  I'm interested in building some user-land tools in openev for combining 
> vector geometries and creating buffers (for instance).

Paul,

Looking at it, I see that I did the python bindings for the comparison
operators (intersect, equal, disjoint, touches, crosses, within, contains,
overlaps and empty) but I didn't do the operators that produce new geoemtries
as a result (convexhull, distance, buffer, intersection, union, difference
and symmetricdifference).

I'll try and address those as well, though of course it is too late now to
having them in 1.2.2.

BTW, the gdalautotest/ogr/ogr_geos.py script has examples of how the geos
functions are used from Python.

Actually, in C++ there are also methods for converting between GEOS and
OGR geometry formats but these are also not wrapped in python and I don't
anticipate that occuring in the near future.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ksa-nil5 at yandex.ru  Fri Sep 17 03:38:15 2004
From: ksa-nil5 at yandex.ru (ksa)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGRPolygon::get_Area() and OGRLineString::get_Length()
	question
Message-ID: <000901c49c89$4ae08fe0$0b11a8c0@nil5>

Hi, Frank!



Method OGRLineString::get_Length() calculates length of the LineString on a
plane. Why on a plane? Whether it is planned to calculate length LineString
on elipsoid?

Other question: whether it is planned to realize in the near future method
OGRPolygon:: getArea ()?



Sergey A. Karin


From warmerdam at pobox.com  Fri Sep 17 09:38:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGRPolygon::get_Area() and OGRLineString::get_Length()
	question
In-Reply-To: <000901c49c89$4ae08fe0$0b11a8c0@nil5>
References: <000901c49c89$4ae08fe0$0b11a8c0@nil5>
Message-ID: <414AE8D7.9060300@pobox.com>

ksa wrote:
> Hi, Frank!
> 
> 
> 
> Method OGRLineString::get_Length() calculates length of the LineString on a
> plane. Why on a plane? Whether it is planned to calculate length LineString
> on elipsoid?

Sergey,

Well, the obvious reason why it is calculated on a plane is that is much easier
and it is the answer that *I* would normally want if I needed the length of
a line string.

I have no plans to compute length on the ellipsoid.

I looked at GEOS quickly, and it seems to just return the planar length for
linestrings.

> Other question: whether it is planned to realize in the near future method
> OGRPolygon:: getArea ()?

Hmm, good point.  Computing planar area of a polygon is not rocket science
and I have done it in lots of other places.  I will look at implementing it
today.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Sep 17 12:12:32 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGR/GEOS Geometry Operators
Message-ID: <414B0CF0.70602@pobox.com>

Paul,

I was wrong earlier when I said that some of the GEOS geometry bindings
were missing in ogr.py.  They all seem to be there.

eg.

 >>> import ogr
 >>> x = ogr.CreateGeometryFromWkt( 'Point(10 10)' )
 >>> y = x.Buffer( 1.0 )
 >>> print y.ExportToWkt()
POLYGON ((11 10,10.99862953 9.94766404,10.99452190 9.89547154,10.98768834 9.84356553,10.97814760 9.79208831,10.96592583 
9.74118095,10.95105652 9.69098301,10.93358043 9.64163205,10.91354546 9.59326336,10.89100652 9.54600950,10.86602540 
9.50000000,10.83867057 9.45536096,10.80901699 9.41221475,10.77714596 9.37067961,10.74314483 9.33086939,10.70710678 
9.29289322,10.66913061 9.25685517,10.62932039 9.22285404,10.58778525 9.19098301,10.54463904 9.16132943,10.50000000 
9.13397460,10.45399050 9.10899348,10.40673664 9.08645454,10.35836795 9.06641957,10.30901699 9.04894348,10.25881905 
9.03407417,10.20791169 9.02185240,10.15643447 9.01231166,10.10452846 9.00547810,10.05233596 9.00137047,10.00000000 
9.00000000,9.94766404 9.00137047,9.89547154 9.00547810,9.84356554 9.01231166,9.79208831 9.02185240,9.74118095 
9.03407417,9.69098301 9.04894348,9.64163205 9.06641957,9.59326336 9.08645454,9.54600950 9.10899348,9.50000000 
9.13397460,9.45536097 9.16132943,9.41221475 9.19098301,9.37067961 9.22285404,9.33086939 9.25685517,9.29289322 
9.29289322,9.25685517 9.33086939,9.22285404 9.37067961,9.19098301 9.41221475,9.16132943 9.45536096,9.13397460 
9.50000000,9.10899348 9.54600950,9.08645454 9.59326336,9.06641957 9.64163205,9.04894348 9.69098301,9.03407417 
9.74118095,9.02185240 9.79208831,9.01231166 9.84356553,9.00547810 9.89547154,9.00137047 9.94766404,9.00000000 
10.00000000,9.00137047 10.05233596,9.00547810 10.10452846,9.01231166 10.15643446,9.02185240 10.20791169,9.03407417 
10.25881905,9.04894348 10.30901699,9.06641957 10.35836795,9.08645454 10.40673664,9.10899348 10.45399050,9.13397460 
10.50000000,9.16132943 10.54463903,9.19098301 10.58778525,9.22285404 10.62932039,9.25685517 10.66913061,9.29289322 
10.70710678,9.33086939 10.74314483,9.37067961 10.77714596,9.41221475 10.80901699,9.45536096 10.83867057,9.50000000 
10.86602540,9.54600950 10.89100652,9.59326336 10.91354546,9.64163205 10.93358043,9.69098301 10.95105652,9.74118095 
10.96592583,9.79208831 10.97814760,9.84356553 10.98768834,9.89547154 10.99452190,9.94766404 10.99862953,10.00000000 
11.00000000,10.05233596 10.99862953,10.10452846 10.99452190,10.15643446 10.98768834,10.20791169 10.97814760,10.25881904 
10.96592583,10.30901699 10.95105652,10.35836795 10.93358043,10.40673664 10.91354546,10.45399050 10.89100652,10.50000000 
10.86602540,10.54463903 10.83867057,10.58778525 10.80901699,10.62932039 10.77714596,10.66913061 10.74314483,10.70710678 
10.70710678,10.74314483 10.66913061,10.77714596 10.62932039,10.80901699 10.58778525,10.83867057 10.54463904,10.86602540 
10.50000000,10.89100652 10.45399050,10.91354546 10.40673664,10.93358043 10.35836795,10.95105652 10.30901699,10.96592583 
10.25881905,10.97814760 10.20791169,10.98768834 10.15643447,10.99452190 10.10452846,10.99862953 10.05233596,11 10))

Also, I have now implemented the get_Area() method on OGRPolygon, OGRLinearRing
and OGRMultiPolygon and added a GetArea() method in Python on the OGRGeometry.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Sep 17 14:23:47 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Anyone has ever built GDAL using RHIDE/DJGPP on Windows
In-Reply-To: <loom.20040915T172103-163@post.gmane.org>
References: <loom.20040915T172103-163@post.gmane.org>
Message-ID: <414B2BB3.7020104@pobox.com>

Gustavo Wagner wrote:
> I`ve been using RHIDE/DJGPP on windows for project i am working at.
> 
> I am on need to read several DEMs,DTMs and raster images on my program and I 
> found GDAL to be almost exactaly what I was looking for. Congratulations for 
> anyone involved on it.
> But GDAL is very big indeed, and I don`t know if I can build it with my 
> application without help.
> 
> Thanks in advance for any help

Gustavo,

It doesn't look like anyone answered so I'll answer briefly.

I don't know what RHIDE is.  I presume some sort of IDE using DJGPP as the
compiler.

I believe there are folks who have built GDAL with DJGPP before, so I don't
think that should be too hard in and of itself.  But as you noted, GDAL has
a fairly complex source tree so whipping up a "project file" for your IDE
of choice can be very challenging.  My suggestion would be to download and
install Cygwin to use a as a shell, and then use the Unix style build.

But after configuring with the Cygwin GCC, go in and hand fiddle
gdal/port/cpl_config.h and gdal/GDALmake.opt a bit to use your DJGPP
compiler.  With modest effort you should be able to then build using
the Cygwin shell and make utility but your compiler.

Of course, if you were just wanting to do everything from the IDE this might
not fit your needs.

Of course, even if you build the library with DJGPP/Cygwin or with VC++ you
can always use DJGPP/RHIDE to build your application on top of the library.

PS. adding in some of the more esoteric support libraries may be more
challenging.  I was mostly addressing doing a "stock" build just using the
GDAL code itself.

Best regards,
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From rogper at bredband.net  Sat Sep 18 08:05:15 2004
From: rogper at bredband.net (Roger Persson)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] plotting data
Message-ID: <001AE863-096B-11D9-AF84-000502E1F845@bredband.net>

Hi!

I'm relative new to GIS and GIS data and have compiled GDAL on Mac OS X 
10.3. Currently, I'm using the OGR classes, but since those are include 
in GDAL I guess I can ask OGR related questions here.

I've created a little program that loads a shape-file and prints the 
contents (which include thousands of lines...) However, now I want to 
plot this data graphically.

1. From OGR sources, it is mentioned a class named "OGRWin" that shows 
how to create a device to plot points graphically on the screen. 
However, I can't find any such class in the sources. Where is this 
sample class? Maybe this will solve my most worries? :-)

2. I have some sample GIS data in a shape file. However, when it is 
load, there is no OGRSpatialReference created in the OGRGeometry 
collections and, hence, I can't project coordinates by an 
OGRCoordinateTransformation-object from lat/long into 2D pixel-points. 
What are am suppose to do? Assume it is lat/long coordinates to create 
my own OGRSpatialReference?

Please note that this is my first message on this list, be patient. :-)

/Rogper


From MChapman at sanz.com  Sat Sep 18 18:00:31 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] plotting data
Message-ID: <ED3A48B9840E594890A2BC172D119465E63B8F@mailman.san.com>

Roger,

There are several ways to draw your points in a window.  All the ones I know, at a minimum, use the "graphics device context".  The DC (device context) or objects that derive from it, have methods to draw to a window that take x, y as parameters.  It also lets you control things like line width, fill color, etc.  In addition to that, the device context can also be used to pass control of the rendering to a third party graphics library like OpenGL.  There is a lot of good code on the internet that shows how to do this for your specific platform.  

With that said, I would search google for how to draw points in a window using the device context or opengl on Mac OSX.  Once you get that plumbing hooked up it will be obvious how to feed the points to your screen from OGR. 

I would strongly recommend using OpenGL for vector, not for raster though...always use the device context for rasters unless you want to project the image into a vector map.  Go to http://nehe.gamedev.net/ and try some of the cross-platform examples for OpenGL as well.

Martin 


-----Original Message-----
From:	Roger Persson [mailto:rogper@bredband.net]
Sent:	Sat 9/18/2004 6:05 AM
To:	gdal-dev@xserve.flids.com
Cc:	
Subject:	[Gdal-dev] plotting data
Hi!

I'm relative new to GIS and GIS data and have compiled GDAL on Mac OS X 
10.3. Currently, I'm using the OGR classes, but since those are include 
in GDAL I guess I can ask OGR related questions here.

I've created a little program that loads a shape-file and prints the 
contents (which include thousands of lines...) However, now I want to 
plot this data graphically.

1. From OGR sources, it is mentioned a class named "OGRWin" that shows 
how to create a device to plot points graphically on the screen. 
However, I can't find any such class in the sources. Where is this 
sample class? Maybe this will solve my most worries? :-)

2. I have some sample GIS data in a shape file. However, when it is 
load, there is no OGRSpatialReference created in the OGRGeometry 
collections and, hence, I can't project coordinates by an 
OGRCoordinateTransformation-object from lat/long into 2D pixel-points. 
What are am suppose to do? Assume it is lat/long coordinates to create 
my own OGRSpatialReference?

Please note that this is my first message on this list, be patient. :-)

/Rogper

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev




From rogper at bredband.net  Sun Sep 19 05:49:08 2004
From: rogper at bredband.net (Roger Persson)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] plotting data
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63B8F@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63B8F@mailman.san.com>
Message-ID: <270F6D1B-0A21-11D9-9A90-000502E1F845@bredband.net>

Hello,

Thanks for the hint. But what projection are am suppose to use? If I 
project the (lat, long, height)-coordinate onto a "Oblique 
Stereographic" (x, y, z)-surface, then I must project a second time 
onto a graphics device coordinate system (or OpenGL coordinate system) 
before rendering. Is it up to me to calculate the latter (affine) 
transformation, or is there an utility to do that ?

/Rogper

2004-09-19 kl. 00.00 skrev Chapman, Martin:

> Roger,
>
> There are several ways to draw your points in a window.  All the ones 
> I know, at a minimum, use the "graphics device context".  The DC 
> (device context) or objects that derive from it, have methods to draw 
> to a window that take x, y as parameters.  It also lets you control 
> things like line width, fill color, etc.  In addition to that, the 
> device context can also be used to pass control of the rendering to a 
> third party graphics library like OpenGL.  There is a lot of good code 
> on the internet that shows how to do this for your specific platform.
>
> With that said, I would search google for how to draw points in a 
> window using the device context or opengl on Mac OSX.  Once you get 
> that plumbing hooked up it will be obvious how to feed the points to 
> your screen from OGR.
>
> I would strongly recommend using OpenGL for vector, not for raster 
> though...always use the device context for rasters unless you want to 
> project the image into a vector map.  Go to http://nehe.gamedev.net/ 
> and try some of the cross-platform examples for OpenGL as well.
>


From dron at ak4719.spb.edu  Sun Sep 19 08:49:50 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] HDF config question...
In-Reply-To: <104FF7CA-089F-11D9-979C-000A95D05840@fao.org>
References: <104FF7CA-089F-11D9-979C-000A95D05840@fao.org>
Message-ID: <20040919124950.GD13440@ak4719.spb.edu>

On Fri, Sep 17, 2004 at 01:45:25PM +0200, Jeroen Ticheler wrote:
> I read your (old) thread on problems compiling HDF into GDAL. I found
> a solution (working on MAC OS X) after facing exactly the same error
> message:
> on line 226 I added hdf as a format, don't know why it was not there. 
> It now reads as
> 
> GDAL_FORMATS = 	gxf gtiff hfa hdf4 aigrid aaigrid ceos ceos2 iso8211 
> xpm \
> 		sdts raw dted mem jdem envisat elas fit vrt usgsdem l1b \
> 		nitf bmp pcidsk \
> 		@OPT_GDAL_FORMATS@

hdf4 should be detected by the configure script and included in the
OPT_GDAL_FORMATS variable. Could you send me your config.log file?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From ksa-nil5 at yandex.ru  Mon Sep 20 03:28:11 2004
From: ksa-nil5 at yandex.ru (ksa)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGRPolygon::get_Area() and OGRLineString::get_Length()
	question
References: <000901c49c89$4ae08fe0$0b11a8c0@nil5> <414AE8D7.9060300@pobox.com>
Message-ID: <009e01c49ee3$62755d00$0b01a8c0@nil5>

Hi, Frank!



I have realized algorithm (on C++) calculation of distance between two
points on sphere. Accordingly proceeding from it it's possible to realize
calculation of length of linestring on sphere, and also the area of polygon
on sphere. I have these subroutines too.

I can send these subroutines to you that you have added them in OGR library.



Sergey.




> > Hi, Frank!
> >
> >
> >
> > Method OGRLineString::get_Length() calculates length of the LineString
on a
> > plane. Why on a plane? Whether it is planned to calculate length
LineString
> > on elipsoid?
>
> Sergey,
>
> Well, the obvious reason why it is calculated on a plane is that is much
easier
> and it is the answer that *I* would normally want if I needed the length
of
> a line string.
>
> I have no plans to compute length on the ellipsoid.
>
> I looked at GEOS quickly, and it seems to just return the planar length
for
> linestrings.
>
> > Other question: whether it is planned to realize in the near future
method
> > OGRPolygon:: getArea ()?
>
> Hmm, good point.  Computing planar area of a polygon is not rocket science
> and I have done it in lots of other places.  I will look at implementing
it
> today.
>


From Jeroen.Ticheler at fao.org  Mon Sep 20 05:59:12 2004
From: Jeroen.Ticheler at fao.org (Jeroen Ticheler)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] HDF config question...
Message-ID: <B97FF2C7-0AEB-11D9-9889-000A95D05840@fao.org>

>
> Thanks for your reply.
>
> I am not a linking expert either, and after struggling with compiling 
> GDAL including GeoTIFF with LZW and HDF4 I managed this morning 
> starting from a fresh gdal1.2.2 and only modifying one line in the 
> GDALMake.opt.in :
> line 228 was changed to
> CONFIG_LIBS_INS	=	-L$(INST_LIB) -lgdal -lgeotiff -ltiff -lmfhdf
>
> I did this on the basis of what was suggested by William Kyngesburye 
> on how to include GeoTIFF and TIFF with LZW compression on MAC OS X 
> (see http://webpages.charter.net/kyngchaos/macosx/install/gdal.html)
>
> I did install hdf4 (4.2r0-macosx) libraries I got from 
> ftp://ftp.ncsa.uiuc.edu/HDF/HDF/HDF_Current/bin/macosx/ 
> (http://hdf.ncsa.uiuc.edu/release4/obtain.html)
> and I did compile the geotiff (libgeotiff-1.2.2) and tiff 
> (tiff-v3.6.1) with LZW (libtiff-lzw-compression-kit-1.5) before as 
> described by William
> All of these were installed in /usr/local
>
> I used: ./configure --mandir=/usr/local/man --with-libz=/usr 
> --with-hdf4=/usr/local --with-libtiff=/usr/local 
> --with-geotiff=/usr/local --with-jpeg=/usr/local 
> --with-jasper=/usr/local --with-gif=internal --with-png=internal 
> --without-python --without-ogdi --with-threads -without-pg
>
> to configure GDAL and it all worked out. I can now create GeoTIFF with 
> LZW straight out of HDF on MAC OS X. Impressive speed!
>
> Just wanted to share this with others trying to do similar things.
> Jeroen
>
ps. Also just noticed that including LZW into GDAL could be as simple 
as replacing the tif_lzw.c file within the /frmts/gtiff/libtiff/ folder 
of gdal... Learning by doing ;-)


> On 19 Sep 2004, at 14:49, Andrey Kiselev wrote:
>
>> On Fri, Sep 17, 2004 at 01:45:25PM +0200, Jeroen Ticheler wrote:
>> > I read your (old) thread on problems compiling HDF into GDAL. I 
>> found
>> > a solution (working on MAC OS X) after facing exactly the same error
>> > message:
>> > on line 226 I added hdf as a format, don't know why it was not 
>> there.
>> > It now reads as
>> >
>> > GDAL_FORMATS = ?????? gxf gtiff hfa hdf4 aigrid aaigrid ceos ceos2 
>> iso8211
>>  > xpm \
>> > ????? ??????? sdts raw dted mem jdem envisat elas fit vrt usgsdem 
>> l1b \
>> > ????? ??????? nitf bmp pcidsk \
>> > ????? ??????? @OPT_GDAL_FORMATS@
>>
>> hdf4 should be detected by the configure script and included in the
>> OPT_GDAL_FORMATS variable. Could you send me your config.log file?
>>
>> ??????? ??????? ??????? ??????? ??????? ??????? Andrey
>>
>> -- 
>> Andrey V. Kiselev
>> Home phone:? +7 812 5274898? ICQ# 26871517
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@xserve.flids.com
>> http://xserve.flids.com/mailman/listinfo/gdal-dev
>

From Jeroen at Ticheler.net  Fri Sep 17 11:02:21 2004
From: Jeroen at Ticheler.net (Jeroen Ticheler)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL with external geotiff and tiff with LZW
Message-ID: <93430FC4-08BA-11D9-BCB6-000A95D05840@Ticheler.net>

I'm building GDAL with external reference to geotiff and tiff that have 
LZW enabled (tried the tools separately and the compression works)
I am now getting the following error and don't know what I do wrong. Do 
I have to change something in the configuration files?
I have build GDAL 1.2.2 just now without problems, but it was using 
internal tiff and geotiff and LZW didn't seem to work.
Help would be greatly appreciated!
Thanks,
Jeroen

OS: MAC OS X

Command to configure:

./configure --mandir=/usr/local/share/man --with-libtiff=/usr/local 
--with-geotiff=/usr/local --with-hdf4=/usr/local --with-jpeg=/usr/local 
--with-zip=/usr --with-proj=/usr/local

make error:

_PyType_Type
_Py_BuildValue
_Py_InitModule4
__Py_NoneStruct
_GTIFDeaccessCSV referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFFree referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetDefn referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFNew referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFWriteKeys referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_XTIFFClose referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_XTIFFOpen referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFFreeMemory referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetDatumInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetEllipsoidInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetGCSInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetPCSInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetPMInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetUOMAngleInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFGetUOMLengthInfo referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFKeyGet referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_GTIFKeySet referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_XTIFFClientOpen referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
__GTIFFree referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCPLCalloc referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCPLError referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCPLMalloc referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCPLStrdup referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCSLCount referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCSLDestroy referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCSVFilename referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
_gtCSVReadParseLine referenced from libgdal expected to be defined in 
libgeotiff.1.2.2.dylib
make[1]: *** [_gdalmodule.la] Error 1
make: *** [py-module] Error 2


-------------- next part --------------
A non-text attachment was scrubbed...
Name: GDALmake.opt.in
Type: application/text
Size: 6167 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040917/05f59f15/GDALmake.opt.bin
-------------- next part --------------


From MChapman at sanz.com  Sun Sep 19 18:19:52 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] plotting data
Message-ID: <ED3A48B9840E594890A2BC172D119465E63B90@mailman.san.com>

Roger,

Ok, good question.  The first thing you need to understand is that when using a 3D graphics package like OpenGL, you need only be concerned with rendering the desired (x, y, z) to opengl with function calls like glVertex3d(x, y, z);.  OpenGL's graphics pipeline will then handle all transformation needed to transform your points to 2D screen coordinates for rendering.  That's one of the benefits of using 3D OpenGL compared with the 2D device context.  

Here are the steps you need to do to render points from a shape file.  

1.  Open the shape file and read points (z, y) into an array(s), or into your geometry class (like polygon, point, etc) with OGR.  Usually the points are stored in the shape file as lon, lat (angular units). 

2.  Use the OGR api to create a spatial reference system and then transform all x, y points using the OGRCoordinateTransformation class.  There is a tutorial on how to do this at http://www.remotesensing.org:16080/ogr/osr_tutorial.html .  The OGR api will load the projection information for a shape file if there is a file named the same as the shape file but with a .prj extension.   

3. Once you have your new transformed points, then loop through the points and draw them to the screen with OpenGL's glVertex() functions.  There are functions that take both x,y and x,y,z.  OpenGL takes care of all the math to project the points into 3D world coordinates and then to 2D screen coordinates.  I've attached a screen shot to show you the output. 

If you want to make it easy the first time you render the points, just send them to OpenGL with the values you read in out of the shape file (lon is x, lat is y, set z = 0.0).  It will draw the map as you expect even if it's decimal degrees.  Then, as you project points to other values (x,y) the map will just look different.  All the projection is doing is warping the way your map looks like.

See attached screens shots from my app.

Martin



-----Original Message-----
From:	Roger Persson [mailto:rogper@bredband.net]
Sent:	Sun 9/19/2004 3:49 AM
To:	gdal-dev@xserve.flids.com
Cc:	
Subject:	Re: [Gdal-dev] plotting data
Hello,

Thanks for the hint. But what projection are am suppose to use? If I 
project the (lat, long, height)-coordinate onto a "Oblique 
Stereographic" (x, y, z)-surface, then I must project a second time 
onto a graphics device coordinate system (or OpenGL coordinate system) 
before rendering. Is it up to me to calculate the latter (affine) 
transformation, or is there an utility to do that ?

/Rogper

2004-09-19 kl. 00.00 skrev Chapman, Martin:

> Roger,
>
> There are several ways to draw your points in a window.  All the ones 
> I know, at a minimum, use the "graphics device context".  The DC 
> (device context) or objects that derive from it, have methods to draw 
> to a window that take x, y as parameters.  It also lets you control 
> things like line width, fill color, etc.  In addition to that, the 
> device context can also be used to pass control of the rendering to a 
> third party graphics library like OpenGL.  There is a lot of good code 
> on the internet that shows how to do this for your specific platform.
>
> With that said, I would search google for how to draw points in a 
> window using the device context or opengl on Mac OSX.  Once you get 
> that plumbing hooked up it will be obvious how to feed the points to 
> your screen from OGR.
>
> I would strongly recommend using OpenGL for vector, not for raster 
> though...always use the device context for rasters unless you want to 
> project the image into a vector map.  Go to http://nehe.gamedev.net/ 
> and try some of the cross-platform examples for OpenGL as well.
>

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev




-------------- next part --------------
A non-text attachment was scrubbed...
Name: ortho_proj.jpg
Type: image/jpeg
Size: 160980 bytes
Desc: ortho_proj.jpg
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040919/1048ccb6/ortho_proj.jpg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: merc_proj.jpg
Type: image/jpeg
Size: 217224 bytes
Desc: merc_proj.jpg
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040919/1048ccb6/merc_proj.jpg
From dem at acri-st.fr  Wed Sep 22 06:19:39 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] TIFF Compressions Disabled (Unix)
Message-ID: <6.1.1.1.0.20040922121913.065a7b48@pop3>

Hi,

Maybe I'm wrong but it seems that at least PACKBITS and LZW TIFF 
compressions are disabled under Unix in the current GDAL CVS (and in 1.2.2 
version) :
in frmts/gtiff/libtiff/GNUmakefile only pass the -DZIP_SUPPORT 
-DPIXARLOG_SUPPORT -DJPEG_SUPPORT
and the makefile.vc pass -DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
		-DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
		-DZIP_SUPPORT -DPIXARLOG_SUPPORT -DJPEG_SUPPORT

Regards,

Julien 


From warmerdam at pobox.com  Wed Sep 22 09:19:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Linux OpenEV_FW 1.8.2 Release
Message-ID: <41517BD0.6030909@pobox.com>

Folks,

After a lengthy wait, I have produced a new OpenEV_FW release for Linux
corresponding approximately to GDAL 1.2.2.  It doesn't have quite as many
options built into it as the windows version but it does include current
versions of GDAL/OGR, PROJ.4, OpenEV, MapServer and OGDI.

It can be found at:

   http://gdal.org/dl/openev/OpenEV_FW_linux_1.8.2.tar.gz

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 22 09:26:02 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] TIFF Compressions Disabled (Unix)
In-Reply-To: <6.1.1.1.0.20040922121913.065a7b48@pop3>
References: <6.1.1.1.0.20040922121913.065a7b48@pop3>
Message-ID: <41517D6A.2040707@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> Maybe I'm wrong but it seems that at least PACKBITS and LZW TIFF 
> compressions are disabled under Unix in the current GDAL CVS (and in 
> 1.2.2 version) :
> in frmts/gtiff/libtiff/GNUmakefile only pass the -DZIP_SUPPORT 
> -DPIXARLOG_SUPPORT -DJPEG_SUPPORT
> and the makefile.vc pass -DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
>         -DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
>         -DZIP_SUPPORT -DPIXARLOG_SUPPORT -DJPEG_SUPPORT

Julien,

I am afraid you are quite correct.  I had noticed this and talked to Andrey
about it briefly, but then I forgot to ensure it was corrected before the
release.

In the meantime I believe you can just add the extra defines in the
gdal/frmts/gtiff/libtiff/GNUmakefile.

Change:

ALL_C_FLAGS	=	$(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib

to:

ALL_C_FLAGS	=	$(CFLAGS) -I../../zlib \
			-DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
			-DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
			-DZIP_SUPPORT -DPIXARLOG_SUPPORT

I have created a bug report to track this problem:

   http://208.24.120.44/show_bug.cgi?id=616

I will try to issue a GDAL 1.2.3 within a few weeks since this is a fairly
noteworthy flaw in 1.2.2.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From randy.page at terraverge.com  Wed Sep 22 09:30:40 2004
From: randy.page at terraverge.com (Randy Page)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDT ASCII Conversion
Message-ID: <200409220927110.SM02748@rpage>

Hi All,

 

I have national coverage of GDT ASCII formatted data that I need to get into
PostGIS/PostgreSQL.   I saw a reference in the news section of
gdal.maptools.org that OGR 1.2.0 has  "Added support for GDT ASCII
TIGER-like format."   But, I can't find any reference for how to use this
with tools like OGR2OGR.   I have tried specifying the input as TIGER, but
it does not recognize the GDT data.   Any suggestions?

 

Thanks in advance,

 

Randy Page

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040922/bbf7fd71/attachment.html
From warmerdam at pobox.com  Wed Sep 22 09:40:43 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDT ASCII Conversion
In-Reply-To: <200409220927110.SM02748@rpage>
References: <200409220927110.SM02748@rpage>
Message-ID: <415180DB.30207@pobox.com>

Randy Page wrote:
> Hi All,
> 
>  
> 
> I have national coverage of GDT ASCII formatted data that I need to get 
> into PostGIS/PostgreSQL.   I saw a reference in the news section of 
> gdal.maptools.org that OGR 1.2.0 has  ?Added support for GDT ASCII 
> TIGER-like format.?   But, I can?t find any reference for how to use 
> this with tools like OGR2OGR.   I have tried specifying the input as 
> TIGER, but it does not recognize the GDT data.   Any suggestions?

Randy,

The GDT data sample I was provided for development included some subdirectories
with datasets that are roughly in TIGER/Line format.  For instance I have
a directory called USA/12/12057 which looks like this:

CPYRIGHT.TXX  D12057.TF7  D12057.TL2  D12057.TMA  D12057.TT7  D12057.TXE
D12057.AIR    D12057.TI7  D12057.TL7  D12057.TMI  D12057.TV1  DATUM.TXT
D12057.TA1    D12057.TK1  D12057.TL8  D12057.TP1  D12057.TV2  H12057X.TX1
D12057.TA2    D12057.TK2  D12057.TLA  D12057.TR1  D12057.TV7  H12057X.TX2
D12057.TA7    D12057.TK7  D12057.TLI  D12057.TR2  D12057.TV8  H12057X.TX3
D12057.TA8    D12057.TK8  D12057.TM1  D12057.TS1  D12057.TVA
D12057.TAA    D12057.TKA  D12057.TM2  D12057.TS2  D12057.TVI
D12057.TAI    D12057.TKI  D12057.TM7  D12057.TS4  D12057.TW1
D12057.TC7    D12057.TL1  D12057.TM8  D12057.TS5  D12057.TW2

This directory can be opened as a TIGER/Line dataset in OGR.  There are lots
of other directories of information in the GDT dataset that are not supported
by these tiger-like directories seem to hold the bulk of the road lines.

I'm not sure how this might change across GDT versions.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Wed Sep 22 09:50:44 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] TIFF Compressions Disabled (Unix)
In-Reply-To: <41517D6A.2040707@pobox.com>
References: <6.1.1.1.0.20040922121913.065a7b48@pop3>
	<41517D6A.2040707@pobox.com>
Message-ID: <6.1.1.1.0.20040922154718.02420f40@pop3>

Frank,

should I also add the other options from makefile.vc (fillorder, stripchop, 
extrasample, ycbcr_subsampling, $(jpeg_flags)) ? :

in makefile.vc :
EXTRAFLAGS =    -I..\..\zlib -DFILLODER_LSB2MSB \
                 -DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
                 -DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
                 -DZIP_SUPPORT -DPIXARLOG_SUPPORT \
                 -DSTRIPCHOP_DEFAULT=TIFF_STRIPCHOP \
                 -DDEFAULT_EXTRASAMPLE_AS_ALPHA 
-DCHECK_JPEG_YCBCR_SUBSAMPLING \
                 $(JPEG_FLAGS)

Thanks,

Julien


At 15:26 22/09/2004, Frank Warmerdam wrote:
>Julien Demaria wrote:
>>Hi,
>>Maybe I'm wrong but it seems that at least PACKBITS and LZW TIFF 
>>compressions are disabled under Unix in the current GDAL CVS (and in 
>>1.2.2 version) :
>>in frmts/gtiff/libtiff/GNUmakefile only pass the -DZIP_SUPPORT 
>>-DPIXARLOG_SUPPORT -DJPEG_SUPPORT
>>and the makefile.vc pass -DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
>>         -DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
>>         -DZIP_SUPPORT -DPIXARLOG_SUPPORT -DJPEG_SUPPORT
>
>Julien,
>
>I am afraid you are quite correct.  I had noticed this and talked to Andrey
>about it briefly, but then I forgot to ensure it was corrected before the
>release.
>
>In the meantime I believe you can just add the extra defines in the
>gdal/frmts/gtiff/libtiff/GNUmakefile.
>
>Change:
>
>ALL_C_FLAGS     =       $(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT 
>-I../../zlib
>
>to:
>
>ALL_C_FLAGS     =       $(CFLAGS) -I../../zlib \
>                         -DCCITT_SUPPORT -DPACKBITS_SUPPORT -DLZW_SUPPORT \
>                         -DTHUNDER_SUPPORT -DNEXT_SUPPORT -DLOGLUV_SUPPORT \
>                         -DZIP_SUPPORT -DPIXARLOG_SUPPORT
>
>I have created a bug report to track this problem:
>
>   http://208.24.120.44/show_bug.cgi?id=616
>
>I will try to issue a GDAL 1.2.3 within a few weeks since this is a fairly
>noteworthy flaw in 1.2.2.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent


From randy.page at terraverge.com  Wed Sep 22 09:54:23 2004
From: randy.page at terraverge.com (Randy Page)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDT ASCII Conversion
In-Reply-To: <415180DB.30207@pobox.com>
Message-ID: <20040922095123.SM02748@rpage>

Frank,

My GDT directories look exactly the same, except the file extensions all
begin with the letter "L" rather than "T" as yours did.   According to the
GDT documentation, L means the delimiter is line feed, while t means the
delimiter is carriage return, line feed.

Thanks,

Randy

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Wednesday, September 22, 2004 9:41 AM
To: Randy Page
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] GDT ASCII Conversion

Randy Page wrote:
> Hi All,
> 
>  
> 
> I have national coverage of GDT ASCII formatted data that I need to get 
> into PostGIS/PostgreSQL.   I saw a reference in the news section of 
> gdal.maptools.org that OGR 1.2.0 has  "Added support for GDT ASCII 
> TIGER-like format."   But, I can't find any reference for how to use 
> this with tools like OGR2OGR.   I have tried specifying the input as 
> TIGER, but it does not recognize the GDT data.   Any suggestions?

Randy,

The GDT data sample I was provided for development included some
subdirectories
with datasets that are roughly in TIGER/Line format.  For instance I have
a directory called USA/12/12057 which looks like this:

CPYRIGHT.TXX  D12057.TF7  D12057.TL2  D12057.TMA  D12057.TT7  D12057.TXE
D12057.AIR    D12057.TI7  D12057.TL7  D12057.TMI  D12057.TV1  DATUM.TXT
D12057.TA1    D12057.TK1  D12057.TL8  D12057.TP1  D12057.TV2  H12057X.TX1
D12057.TA2    D12057.TK2  D12057.TLA  D12057.TR1  D12057.TV7  H12057X.TX2
D12057.TA7    D12057.TK7  D12057.TLI  D12057.TR2  D12057.TV8  H12057X.TX3
D12057.TA8    D12057.TK8  D12057.TM1  D12057.TS1  D12057.TVA
D12057.TAA    D12057.TKA  D12057.TM2  D12057.TS2  D12057.TVI
D12057.TAI    D12057.TKI  D12057.TM7  D12057.TS4  D12057.TW1
D12057.TC7    D12057.TL1  D12057.TM8  D12057.TS5  D12057.TW2

This directory can be opened as a TIGER/Line dataset in OGR.  There are lots
of other directories of information in the GDT dataset that are not
supported
by these tiger-like directories seem to hold the bulk of the road lines.

I'm not sure how this might change across GDT versions.

Best regards,

-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




From debian at adkgis.org  Wed Sep 22 14:55:36 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] grass in 1.2.2 compilation problem
Message-ID: <1095879336.3620.14.camel@marcy>

Hi,

I'm attempting to compile 1.2.2 --with-grass against grass 5.7.0. I end
up with:

make[2]: Entering directory
`/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
/bin/sh ../libtool --mode=compile g++ -Wall  -O2
-DCPL_MULTIPROC_PTHREAD   -Iogrsf_frmts -I. -I../port -I../gcore
-I../ogr -I../alg   -I../port  -c -o ogrinfo.o ogrinfo.cpp
 g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
-I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp  -fPIC -DPIC -o
.libs/ogrinfo.o
 g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
-I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp -o ogrinfo.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so /usr/lib/libodbc.so
/usr/lib/libltdl.so -L/usr/lib -lxerces-c /usr/lib/libjasper.so -lmfhdf
-ldf -lgif /usr/lib/libjpeg.so -ltiff -lpng -lnetcdf -lcfitsio
-L/usr/lib/grass57/lib -lgrass_I -lgrass_vask -lgrass_gmath -lgrass_gis
-lgrass_datetime -lz -lpthread -ldl -lpq
../.libs/libgdal.so: undefined reference to `G_gisinit_2'
../.libs/libgdal.so: undefined reference to `G_check_cell'
../.libs/libgdal.so: undefined reference to `I_check_group'
../.libs/libgdal.so: undefined reference to `G_get_cell_as_proj4'
collect2: ld returned 1 exit status
make[2]: *** [ogrinfo] Error 1
make[2]: Leaving directory
`/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
make[1]: *** [ogr-apps] Error 2
make[1]: Leaving directory
`/home/steve/projects/qgis/debian/gdal/gdal-1.2.2'
make: *** [build-stamp] Error 2

It appears that it is trying to compile the libgrass version. Renaming
frmts/grass/grass57dataset.cpp to grassdataset.cpp didn't work either. I
looked for where the logic to decide which to use was and couldn't find
it.

Thanks,
Steve


From t.r.decarlo at larc.nasa.gov  Wed Sep 22 15:44:27 2004
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and MinGW
Message-ID: <006101c4a0dc$9242b0f0$959877c6@cts1149>

Well, the subject says it all. I need to build gdal on a Win2K machine that
does not have the MS compilers. I am a complete newbie when it comes to
Dev-C++ and MinGW, but I have successfully installed the software. 

Can anyone provide any help getting gdal to compile? Or maybe just point me
at another info source?

Thanks,
Thom



From warmerdam at pobox.com  Wed Sep 22 15:46:45 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] grass in 1.2.2 compilation problem
In-Reply-To: <1095879336.3620.14.camel@marcy>
References: <1095879336.3620.14.camel@marcy>
Message-ID: <4151D6A5.6090702@pobox.com>

Steve Halasz wrote:
> Hi,
> 
> I'm attempting to compile 1.2.2 --with-grass against grass 5.7.0. I end
> up with:
> 
> make[2]: Entering directory
> `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
> /bin/sh ../libtool --mode=compile g++ -Wall  -O2
> -DCPL_MULTIPROC_PTHREAD   -Iogrsf_frmts -I. -I../port -I../gcore
> -I../ogr -I../alg   -I../port  -c -o ogrinfo.o ogrinfo.cpp
>  g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
> -I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp  -fPIC -DPIC -o
> .libs/ogrinfo.o
>  g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
> -I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp -o ogrinfo.o
> 
>>/dev/null 2>&1
> 
> /bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
> g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so /usr/lib/libodbc.so
> /usr/lib/libltdl.so -L/usr/lib -lxerces-c /usr/lib/libjasper.so -lmfhdf
> -ldf -lgif /usr/lib/libjpeg.so -ltiff -lpng -lnetcdf -lcfitsio
> -L/usr/lib/grass57/lib -lgrass_I -lgrass_vask -lgrass_gmath -lgrass_gis
> -lgrass_datetime -lz -lpthread -ldl -lpq
> ../.libs/libgdal.so: undefined reference to `G_gisinit_2'
> ../.libs/libgdal.so: undefined reference to `G_check_cell'
> ../.libs/libgdal.so: undefined reference to `I_check_group'
> ../.libs/libgdal.so: undefined reference to `G_get_cell_as_proj4'
> collect2: ld returned 1 exit status
> make[2]: *** [ogrinfo] Error 1
> make[2]: Leaving directory
> `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
> make[1]: *** [ogr-apps] Error 2
> make[1]: Leaving directory
> `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2'
> make: *** [build-stamp] Error 2
> 
> It appears that it is trying to compile the libgrass version. Renaming
> frmts/grass/grass57dataset.cpp to grassdataset.cpp didn't work either. I
> looked for where the logic to decide which to use was and couldn't find
> it.

Steve,

It does indeed appear that the libgrass version of the code is being used.
I suspect that both versions of the code have been compiled and linked in.
I would suggesting doing a "make clean" and then make again.  If you
reconfigured and rebuilding without a make clean, it is likely that the
old grassdataset.o would still be handing around in the gdal/frmts/o
directory or libgdal.a.

The logic within the gdal/frmts/grass directory is controlled by the
GRASS_SETTING variable which should be either "libgrass" or "grass57+".
You might want to check GDALmake.opt to see if the variable is set properly.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Jeroen.Ticheler at fao.org  Wed Sep 22 15:51:14 2004
From: Jeroen.Ticheler at fao.org (Ticheler, Jeroen (SDRN))
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
Message-ID: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>

I have a problem compiling the Python modules of GDAL on MAC OS X. I have
seen this problem has been discussed previously (around December 2003), but I
have found no solution yet. Does anyone have a solution?
Thanks,
Jeroen

Error while compiling:

(cd pymod; make)
GNUmakefile:35: warning: overriding commands for target `_gdalmodule.la'
GNUmakefile:29: warning: ignoring old commands for target `_gdalmodule.la'
/bin/sh ../libtool --mode=link  g++ gdal_wrap.lo numpydataset.lo
gdalnumeric.lo
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3
../libgdal.la -o _gdalmodule.la \
        -rpath
/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/site-p
ackages \
        -no-undefined \
        -avoid-version \
        -module
g++ -Wl,-bind_at_load  -o .libs/_gdalmodule.so -bundle  .libs/gdal_wrap.o
.libs/numpydataset.o .libs/gdalnumeric.o  -L/usr/local/lib
../.libs/libgdal.dylib
ld: Undefined symbols:
_PyArg_Parse
_PyArg_ParseTuple
_PyDict_New
_PyDict_Next
_PyDict_SetItem
_PyDict_Type
_PyErr_Clear
_PyErr_SetString
_PyEval_CallObjectWithKeywords
_PyExc_MemoryError
_PyExc_NameError
_PyExc_TypeError
_PyExc_ValueError
_PyFloat_AsDouble
_PyFloat_FromDouble
_PyInt_AsLong
_PyInt_FromLong
_PyInt_Type
_PyList_New
_PyList_SetItem
_PyList_Size
_PyList_Type
_PyModule_GetDict
_PyObject_AsWriteBuffer
_PyString_AsString
_PyString_FromString
_PyString_FromStringAndSize
_PyString_Type
_PyTuple_Size
_PyTuple_Type
_PyType_IsSubtype
_PyType_Type
_Py_BuildValue
_Py_InitModule4
__Py_NoneStruct
make[1]: *** [_gdalmodule.la] Error 1
make: *** [py-module] Error 2

From debian at adkgis.org  Wed Sep 22 16:32:32 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] grass in 1.2.2 compilation problem
In-Reply-To: <4151D6A5.6090702@pobox.com>
References: <1095879336.3620.14.camel@marcy>  <4151D6A5.6090702@pobox.com>
Message-ID: <1095885152.3620.47.camel@marcy>

On Wed, 2004-09-22 at 15:46, Frank Warmerdam wrote:
> Steve Halasz wrote:
> > Hi,
> > 
> > I'm attempting to compile 1.2.2 --with-grass against grass 5.7.0. I end
> > up with:
> > 
> > make[2]: Entering directory
> > `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
> > /bin/sh ../libtool --mode=compile g++ -Wall  -O2
> > -DCPL_MULTIPROC_PTHREAD   -Iogrsf_frmts -I. -I../port -I../gcore
> > -I../ogr -I../alg   -I../port  -c -o ogrinfo.o ogrinfo.cpp
> >  g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
> > -I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp  -fPIC -DPIC -o
> > .libs/ogrinfo.o
> >  g++ -Wall -O2 -DCPL_MULTIPROC_PTHREAD -Iogrsf_frmts -I. -I../port
> > -I../gcore -I../ogr -I../alg -I../port -c ogrinfo.cpp -o ogrinfo.o
> > 
> >>/dev/null 2>&1
> > 
> > /bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
> > g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so /usr/lib/libodbc.so
> > /usr/lib/libltdl.so -L/usr/lib -lxerces-c /usr/lib/libjasper.so -lmfhdf
> > -ldf -lgif /usr/lib/libjpeg.so -ltiff -lpng -lnetcdf -lcfitsio
> > -L/usr/lib/grass57/lib -lgrass_I -lgrass_vask -lgrass_gmath -lgrass_gis
> > -lgrass_datetime -lz -lpthread -ldl -lpq
> > ../.libs/libgdal.so: undefined reference to `G_gisinit_2'
> > ../.libs/libgdal.so: undefined reference to `G_check_cell'
> > ../.libs/libgdal.so: undefined reference to `I_check_group'
> > ../.libs/libgdal.so: undefined reference to `G_get_cell_as_proj4'
> > collect2: ld returned 1 exit status
> > make[2]: *** [ogrinfo] Error 1
> > make[2]: Leaving directory
> > `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2/ogr'
> > make[1]: *** [ogr-apps] Error 2
> > make[1]: Leaving directory
> > `/home/steve/projects/qgis/debian/gdal/gdal-1.2.2'
> > make: *** [build-stamp] Error 2
> > 
> > It appears that it is trying to compile the libgrass version. Renaming
> > frmts/grass/grass57dataset.cpp to grassdataset.cpp didn't work either. I
> > looked for where the logic to decide which to use was and couldn't find
> > it.
> 
> Steve,
> 
> It does indeed appear that the libgrass version of the code is being used.
> I suspect that both versions of the code have been compiled and linked in.
> I would suggesting doing a "make clean" and then make again.  If you
> reconfigured and rebuilding without a make clean, it is likely that the
> old grassdataset.o would still be handing around in the gdal/frmts/o
> directory or libgdal.a.

Frank,

Thanks for the reply. This is taking place in the context of a debian
build with dpkg-buildpackage, which does a make distclean before every
build. I have verified that this removes grassdataset.o. Also, this
error cropped up the first time I tried to build.

> The logic within the gdal/frmts/grass directory is controlled by the
> GRASS_SETTING variable which should be either "libgrass" or "grass57+".
> You might want to check GDALmake.opt to see if the variable is set properly.

Yes, GDALmake.opt is correctly getting:
GRASS_SETTING	=	grass57+
GRASS_INCLUDE	=	-I/usr/lib/grass57/include

But running 'grep -r GRASS_SETTING .' does not show that setting used
anywhere in the source. I also can't find any reference to
grass57dataset. Where does it say:

if GRASS_SETTING = grass57+
  use grass57dataset.cpp
else
  use grassdataset.cpp

Regards,
Steve



From warmerdam at pobox.com  Wed Sep 22 16:40:47 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] grass in 1.2.2 compilation problem
In-Reply-To: <1095885152.3620.47.camel@marcy>
References: <1095879336.3620.14.camel@marcy> <4151D6A5.6090702@pobox.com>
	<1095885152.3620.47.camel@marcy>
Message-ID: <4151E34F.3080107@pobox.com>

Steve Halasz wrote:
> But running 'grep -r GRASS_SETTING .' does not show that setting used
> anywhere in the source. I also can't find any reference to
> grass57dataset. Where does it say:
> 
> if GRASS_SETTING = grass57+
>   use grass57dataset.cpp
> else
>   use grassdataset.cpp

Gack!

I forgot to commit my updates for the GNUmakefile (and some important
improvements to grass57dataset.cpp) before the release. Dang, dang, dang, dang.

OK, I'll issue a 1.2.2.1 or 1.2.3 within a day or two with this and the TIFF
building stuff fix up.  I have committed the changes to CVS if you want
to try it in the meantime.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From zak-ms at hoppsan.org  Wed Sep 22 20:29:03 2004
From: zak-ms at hoppsan.org (Zak James)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
Message-ID: <9246AB06-0CF7-11D9-A4D0-000D933576F4@hoppsan.org>

Jeroen,

I answered this question on the list a few months ago. You may find  
more details in the archive, but I'm including what I wrote then.

I've since determined that for install to proceed, you need to set a  
pymod install directory in GDALmake.opt:
INST_PYMOD      = ${prefix}/lib/python2.3/site-packages/

and make some modifications to the pymod makefile because it thinks the  
bundle extension will be .dylib instead of .so

zak

> Date: July 25, 2004 12:05:55 PM EDT
> Cc: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] Built gdal with python support - error
>
> I recently built gdal's python support on OS X 10.3 (with the OS  
> supplied Python 2.3) by relying on the apple compiler's support for  
> frameworks.
>
> After you configure --without-python, edit the python section of  
> GDALMake.opt like so:
>
> PYTHON_INCLUDES =  
> -I/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3
> PYTHON_LIBS = -framework Python
> PYTHON_CFLAGS =
> PYTHON = yes
>
> and run make. The only other problem seems to be that the shared  
> library is not created as a bundle so after everything is built, you  
> need to build the python module using something like:
>
>  g++ -bundle -flat_namespace gdal_wrap.o numpydataset.o gdalnumeric.o  
> -L.. -lgdal -framework Python -ljpeg -lpng -lz -ldl -o _gdalmodule.so
>
> If you run otool -L on the .so file, you can verify that it is using  
> the appropriate libraries.
>
> zak
> --
> Zak James
> Applications and Software Development
> DM Solutions Group Inc.
> http://www.dmsolutions.ca
>
--
Zak James
Applications and Software Development
DM Solutions Group Inc.
http://www.dmsolutions.ca


On Sep 22, 2004, at 3:51 PM, Ticheler, Jeroen (SDRN) wrote:

> I have a problem compiling the Python modules of GDAL on MAC OS X. I  
> have
> seen this problem has been discussed previously (around December  
> 2003), but I
> have found no solution yet. Does anyone have a solution?
> Thanks,
> Jeroen
>
> Error while compiling:
>
> (cd pymod; make)
> GNUmakefile:35: warning: overriding commands for target  
> `_gdalmodule.la'
> GNUmakefile:29: warning: ignoring old commands for target  
> `_gdalmodule.la'
> /bin/sh ../libtool --mode=link  g++ gdal_wrap.lo numpydataset.lo
> gdalnumeric.lo
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3
> ../libgdal.la -o _gdalmodule.la \
>         -rpath
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/site-p
> ackages \
>         -no-undefined \
>         -avoid-version \
>         -module
> g++ -Wl,-bind_at_load  -o .libs/_gdalmodule.so -bundle   
> .libs/gdal_wrap.o
> .libs/numpydataset.o .libs/gdalnumeric.o  -L/usr/local/lib
> ../.libs/libgdal.dylib
> ld: Undefined symbols:
> _PyArg_Parse
> _PyArg_ParseTuple
> _PyDict_New
> _PyDict_Next
> _PyDict_SetItem
> _PyDict_Type
> _PyErr_Clear
> _PyErr_SetString
> _PyEval_CallObjectWithKeywords
> _PyExc_MemoryError
> _PyExc_NameError
> _PyExc_TypeError
> _PyExc_ValueError
> _PyFloat_AsDouble
> _PyFloat_FromDouble
> _PyInt_AsLong
> _PyInt_FromLong
> _PyInt_Type
> _PyList_New
> _PyList_SetItem
> _PyList_Size
> _PyList_Type
> _PyModule_GetDict
> _PyObject_AsWriteBuffer
> _PyString_AsString
> _PyString_FromString
> _PyString_FromStringAndSize
> _PyString_Type
> _PyTuple_Size
> _PyTuple_Type
> _PyType_IsSubtype
> _PyType_Type
> _Py_BuildValue
> _Py_InitModule4
> __Py_NoneStruct
> make[1]: *** [_gdalmodule.la] Error 1
> make: *** [py-module] Error 2
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>


From lorenzo.moretti at bologna.enea.it  Thu Sep 23 10:38:32 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
Message-ID: <a06110402bd787f281fef@[192.107.62.86]>

Hi Jeroen

This old tips from Alessando Amici works only in GDAL 1.2.1 in OS X:

>there are at least two old threads on the subject, where you can get a bit
>more background, the more interesting is the one with subject: Python Module
>Build in april this year.
>
>you may try the following:
>edit the setup.py script in the root directory changing:
>LIBRARY_DIRS = ["./libs"]
>to
>LIBRARY_DIRS = ["./.libs"]
>on line 69 (yes, this was a brain-not-found kind of error on my part back in
>april... sigh! and i think i don't have cvs write access anymore).
>
>then:
>$ ./configure <...> --without-python
>$ make
>$ python setup.py build
>$ su root "python setup.py install"
>
>please report to the list if this finally works.
>
>cheers,
>alessandro


In OS X the libraries are inside the folder but an invisible folder 
named ".libs" inside gdal source dir.

- built your GDAL without python support;
- after change 2 rows in file setup.py:

row 69
- LIBRARY_DIRS = ["./libs"]
+ LIBRARY_DIRS = ["./.libs"]

row 103
- ("lib", ['libgdal.%s.so' % soversion]),
+ ("lib", ['libgdal.%s.dylib' % soversion]),

- > python setup.py build
- > sudo python setup.py install


This patch does not work in 1.2.2 or other ...

Bye


-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot/idr          Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040923/371ed734/attachment.html
From rpereira at ku.edu  Fri Sep 24 09:48:14 2004
From: rpereira at ku.edu (Pereira, Ricardo Scachetti)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
Message-ID: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>

	Hi, folks,

	GDAL supports creation of many raster formats from table on this
url: http://www.remotesensing.org/gdal/formats_list.html
	But then when I check if the drivers support the Create method,
with a call like this: 

  poDriver = GetGDALDriverManager()->GetDriverByName("AAIGrid");
  if( poDriver == NULL ) exit( 1 );
  papszMetadata = poDriver->GetMetadata();
  bool result = ( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE,
FALSE ) );

	Only BMP and Gtiff seem to support it.
	So my question is, what is the alternative method of creating
raster datasets using the various drivers, other than using Create()?
Why some drivers implement it and others don't?
	Thanks,

Ricardo


--
Ricardo Scachetti Pereira
Computer Engineer
Biodiversity Research Center
Natural History Museum
University of Kansas
1345 Jayhawk Boulevard
Lawrence, KS 66045-7561 USA
Tel: (785) 864-4655, Fax: (785) 864-5335
email: rpereira@ku.edu


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040924/8fb0df8f/attachment.html
From warmerdam at pobox.com  Fri Sep 24 10:01:28 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>
Message-ID: <415428B8.7060704@pobox.com>

Pereira, Ricardo Scachetti wrote:
>         Hi, folks,
> 
>         GDAL supports creation of many raster formats from table on this 
> url: _http://www.remotesensing.org/gdal/formats_list.html_
> 
>         But then when I check if the drivers support the Create method, 
> with a call like this:
> 
>   poDriver = GetGDALDriverManager()->GetDriverByName("AAIGrid");
>   if( poDriver == NULL ) exit( 1 );
>   papszMetadata = poDriver->GetMetadata();
>   bool result = ( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE, 
> FALSE ) );
> 
>         Only BMP and Gtiff seem to support it.
>         So my question is, what is the alternative method of creating 
> raster datasets using the various drivers, other than using Create()? 
> Why some drivers implement it and others don't?

Richardo,

There are basically two ways of creating files with GDAL.  One pre-creates
the file, and then you use the various GDAL "set" functions and the
RasterIO() calls to write out metadata and image data.  This is the Create()
method.

The other approach is to use the CreateCopy() in which case you have to
provide an input file that has the configuration you want in the output
file and it will copy everything to the new file before returning control.

Many formats only support CreateCopy() because it is often difficult to
implement "random update".  For instance, when writing a PNG file you need
to do things in a particular order.  The colormap may need to be written
first, and once the image data is written (always top to bottom) it cannot
be updated again.

So for formats where I am constrained by the underlying library, or challenges
in the format itself I will generally only implement CreateCopy().

However, there should be several formats that do support direct Create(),
including (I think) VRT, NITF, HFA, MEM, PCIDSK and possibly a few others.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Fri Sep 24 10:12:15 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku .edu>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>
Message-ID: <6.1.1.1.0.20040924160001.024ee200@pop3>

Ricardo,

Calling gdalwarp -of JPEG for example and it gives you an error and print 
the drivers list for your local GDAL supporting Create method.

Regards,

Julien

At 15:48 24/09/2004, Pereira, Ricardo Scachetti wrote:
>content-class: urn:content-classes:message
>Content-Type: multipart/alternative;
>         boundary="----_=_NextPart_001_01C4A23D.233BF760"
>
>         Hi, folks,
>
>         GDAL supports creation of many raster formats from table on this 
> url: 
> <http://www.remotesensing.org/gdal/formats_list.html>http://www.remotesensing.org/gdal/formats_list.html
>
>         But then when I check if the drivers support the Create method, 
> with a call like this:
>
>   poDriver = GetGDALDriverManager()->GetDriverByName("AAIGrid");
>   if( poDriver == NULL ) exit( 1 );
>   papszMetadata = poDriver->GetMetadata();
>   bool result = ( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE, FALSE 
> ) );
>
>         Only BMP and Gtiff seem to support it.
>         So my question is, what is the alternative method of creating 
> raster datasets using the various drivers, other than using Create()? Why 
> some drivers implement it and others don't?
>
>         Thanks,
>
>Ricardo
>
>--
>Ricardo Scachetti Pereira
>Computer Engineer
>Biodiversity Research Center
>Natural History Museum
>University of Kansas
>1345 Jayhawk Boulevard
>Lawrence, KS 66045-7561 USA
>Tel: (785) 864-4655, Fax: (785) 864-5335
>email: rpereira@ku.edu
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev


From dem at acri-st.fr  Fri Sep 24 10:27:24 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <415428B8.7060704@pobox.com>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>
	<415428B8.7060704@pobox.com>
Message-ID: <6.1.1.1.0.20040924161331.023de4f0@pop3>

Frank,

I think this is incompatible with the GDAL API, but would it be possible 
(theoritically) to provide a "limited write only" approach in which we give 
all the file format informations (colortable, geolocation, nodata, ...) 
only one time at the create call (a CreateSimple method ?), and allow only 
to write in sequential line-by-line way ?
This approach could be implemented easily for many more drivers than the 
standard Create approach, isn't it ?

Regards,

Julien

At 16:01 24/09/2004, Frank Warmerdam wrote:
>Pereira, Ricardo Scachetti wrote:
>>         Hi, folks,
>>         GDAL supports creation of many raster formats from table on this 
>> url: _http://www.remotesensing.org/gdal/formats_list.html_
>>         But then when I check if the drivers support the Create method, 
>> with a call like this:
>>   poDriver = GetGDALDriverManager()->GetDriverByName("AAIGrid");
>>   if( poDriver == NULL ) exit( 1 );
>>   papszMetadata = poDriver->GetMetadata();
>>   bool result = ( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE, 
>> FALSE ) );
>>         Only BMP and Gtiff seem to support it.
>>         So my question is, what is the alternative method of creating 
>> raster datasets using the various drivers, other than using Create()? 
>> Why some drivers implement it and others don't?
>
>Richardo,
>
>There are basically two ways of creating files with GDAL.  One pre-creates
>the file, and then you use the various GDAL "set" functions and the
>RasterIO() calls to write out metadata and image data.  This is the Create()
>method.
>
>The other approach is to use the CreateCopy() in which case you have to
>provide an input file that has the configuration you want in the output
>file and it will copy everything to the new file before returning control.
>
>Many formats only support CreateCopy() because it is often difficult to
>implement "random update".  For instance, when writing a PNG file you need
>to do things in a particular order.  The colormap may need to be written
>first, and once the image data is written (always top to bottom) it cannot
>be updated again.
>
>So for formats where I am constrained by the underlying library, or challenges
>in the format itself I will generally only implement CreateCopy().
>
>However, there should be several formats that do support direct Create(),
>including (I think) VRT, NITF, HFA, MEM, PCIDSK and possibly a few others.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Fri Sep 24 10:28:01 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <6.1.1.1.0.20040924161331.023de4f0@pop3>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>	<415428B8.7060704@pobox.com>
	<6.1.1.1.0.20040924161331.023de4f0@pop3>
Message-ID: <41542EF1.9010509@pobox.com>

Julien Demaria wrote:
> Frank,
> 
> I think this is incompatible with the GDAL API, but would it be possible 
> (theoritically) to provide a "limited write only" approach in which we 
> give all the file format informations (colortable, geolocation, nodata, 
> ...) only one time at the create call (a CreateSimple method ?), and 
> allow only to write in sequential line-by-line way ?
> This approach could be implemented easily for many more drivers than the 
> standard Create approach, isn't it ?

Julien,

Yes, I can see that this might be desirable, but I'm not too keen on yet
another way of creating files.  Note, that you can provide a virtual file
as input which provides callbacks to get the image data if you want to
avoiding having a copy of the imagery already exist somewhere.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Fri Sep 24 10:45:50 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <41542EF1.9010509@pobox.com>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>
	<415428B8.7060704@pobox.com>
	<6.1.1.1.0.20040924161331.023de4f0@pop3>
	<41542EF1.9010509@pobox.com>
Message-ID: <6.1.1.1.0.20040924164035.02475520@pop3>

At 16:28 24/09/2004, Frank Warmerdam wrote:
>Julien Demaria wrote:
>>Frank,
>>I think this is incompatible with the GDAL API, but would it be possible 
>>(theoritically) to provide a "limited write only" approach in which we 
>>give all the file format informations (colortable, geolocation, nodata, 
>>...) only one time at the create call (a CreateSimple method ?), and 
>>allow only to write in sequential line-by-line way ?
>>This approach could be implemented easily for many more drivers than the 
>>standard Create approach, isn't it ?
>
>Julien,
>
>Yes, I can see that this might be desirable, but I'm not too keen on yet
>another way of creating files.  Note, that you can provide a virtual file
>as input which provides callbacks to get the image data if you want to
>avoiding having a copy of the imagery already exist somewhere.

good solution... have you got a simple example code which do that, if 
possible ?

Thanks in advance,

Julien


From t.r.decarlo at larc.nasa.gov  Fri Sep 24 10:42:05 2004
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and MinGW
In-Reply-To: <006101c4a0dc$9242b0f0$959877c6@cts1149>
Message-ID: <009701c4a244$a99a3cf0$959877c6@cts1149>

Well, I wasn't able to compile with MinGW. However I was able to compile
after installing the Cygwin environment. Now to figure out how to compile
OpenSceneGraph with that...

Thom


> -----Original Message-----
> From: Thom DeCarlo
> Sent: Wednesday, September 22, 2004 3:44 PM
> To: 'GDAL developers'
> Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and MinGW
> 
> Well, the subject says it all. I need to build gdal on a Win2K machine
> that does not have the MS compilers. I am a complete newbie when it comes
> to Dev-C++ and MinGW, but I have successfully installed the software.
> 
> Can anyone provide any help getting gdal to compile? Or maybe just point
> me at another info source?
> 
> Thanks,
> Thom
> 




From warmerdam at pobox.com  Fri Sep 24 10:57:56 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <6.1.1.1.0.20040924164035.02475520@pop3>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>	<415428B8.7060704@pobox.com>	<6.1.1.1.0.20040924161331.023de4f0@pop3>	<41542EF1.9010509@pobox.com>
	<6.1.1.1.0.20040924164035.02475520@pop3>
Message-ID: <415435F4.5080009@pobox.com>

Julien Demaria wrote:
> good solution... have you got a simple example code which do that, if 
> possible ?

Julien,

I'm afraid I do not.  The key is to create a VRT data and VRTSourcedRasterBand
and then add a VRTFuncSource to it.  The function in the VRTFuncSource will be
called as imagery is needed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gillian.walter at atlantis-scientific.com  Fri Sep 24 11:09:25 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <415435F4.5080009@pobox.com>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>	<415428B8.7060704@pobox.com>	<6.1.1.1.0.20040924161331.023de4f0@pop3>	<41542EF1.9010509@pobox.com>	<6.1.1.1.0.20040924164035.02475520@pop3>
	<415435F4.5080009@pobox.com>
Message-ID: <415438A5.5070907@atlantis-scientific.com>

What is a VRTFuncSource?  I didn't see it on:

http://gdal.maptools.org/gdal_vrttut.html

Do you have any VRT snippets lying around that shows what it looks like?

Gillian

Frank Warmerdam wrote:

> Julien Demaria wrote:
>
>> good solution... have you got a simple example code which do that, if 
>> possible ?
>
>
> Julien,
>
> I'm afraid I do not.  The key is to create a VRT data and 
> VRTSourcedRasterBand
> and then add a VRTFuncSource to it.  The function in the VRTFuncSource 
> will be
> called as imagery is needed.
>
> Best regards,




From MChapman at sanz.com  Fri Sep 24 11:40:48 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and MinGW
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFD60@mailman.san.com>

Tom,

If you follow the directions at
http://www.remotesensing.org:16080/gdal/gdal_building.html under
"Building on Windows" verbatum it will work perfectly.  You may need to
modify the nmake.opt file to set your gdal path correctly, but it will
work.  It's a command line build but I've had great success with it.
I'm using VC++ .Net 2003.

Martin

-----Original Message-----
From: Thom DeCarlo [mailto:t.r.decarlo@larc.nasa.gov] 
Sent: Friday, September 24, 2004 8:42 AM
To: 'GDAL developers'
Subject: RE: [Gdal-dev] Need help compiling on Windows with Dev-C++ and
MinGW


Well, I wasn't able to compile with MinGW. However I was able to compile
after installing the Cygwin environment. Now to figure out how to
compile OpenSceneGraph with that...

Thom


> -----Original Message-----
> From: Thom DeCarlo
> Sent: Wednesday, September 22, 2004 3:44 PM
> To: 'GDAL developers'
> Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and 
> MinGW
> 
> Well, the subject says it all. I need to build gdal on a Win2K machine

> that does not have the MS compilers. I am a complete newbie when it 
> comes to Dev-C++ and MinGW, but I have successfully installed the 
> software.
> 
> Can anyone provide any help getting gdal to compile? Or maybe just 
> point me at another info source?
> 
> Thanks,
> Thom
> 



_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Sep 24 11:55:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Create method
In-Reply-To: <415438A5.5070907@atlantis-scientific.com>
References: <E77B3DFC56532248BF83B6AFF923AAE30417A13E@bluebird2.home.ku.edu>	<415428B8.7060704@pobox.com>	<6.1.1.1.0.20040924161331.023de4f0@pop3>	<41542EF1.9010509@pobox.com>	<6.1.1.1.0.20040924164035.02475520@pop3>
	<415435F4.5080009@pobox.com>
	<415438A5.5070907@atlantis-scientific.com>
Message-ID: <41544358.3070204@pobox.com>

Gillian Walter wrote:
> What is a VRTFuncSource?  I didn't see it on:
> 
> http://gdal.maptools.org/gdal_vrttut.html
> 
> Do you have any VRT snippets lying around that shows what it looks like?

Gillian,

I don't believe there is any documentation on the VRTFuncSource nor any
examples I am aware of.  You would basically need to inspect the
gdal/frmts/vrt/vrtdataset.h to see the interface.   If there is sufficient
interest I suppose I should document it properly.

In fact, other than the tutorial, the whole VRT area is rather poorly
documented.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From t.r.decarlo at larc.nasa.gov  Fri Sep 24 14:13:22 2004
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and MinGW
In-Reply-To: <ED3A48B9840E594890A2BC172D11946501CFFD60@mailman.san.com>
Message-ID: <009801c4a262$2dc6bb30$959877c6@cts1149>

Martin,
Yeah, that will work just fine... if you have Microsoft Visual Studio. The
problem I was addressing here was that I don't have that compiler.
Fortunately, Cygwin's implementation of GNU C++ works just fine for GDAL. I
am having problems, though, getting the OpenSceneGraph and requisite
libraries to compile. But, I'll address those problems on that mailing list.

Thom


> -----Original Message-----
> From: Chapman, Martin
> Sent: Friday, September 24, 2004 11:41 AM
> To: Thom DeCarlo; GDAL developers
> Subject: RE: [Gdal-dev] Need help compiling on Windows with Dev-C++ and
> MinGW
> 
> Tom,
> 
> If you follow the directions at
> http://www.remotesensing.org:16080/gdal/gdal_building.html under
> "Building on Windows" verbatum it will work perfectly.  You may need to
> modify the nmake.opt file to set your gdal path correctly, but it will
> work.  It's a command line build but I've had great success with it.
> I'm using VC++ .Net 2003.
> 
> Martin
> 
> -----Original Message-----
> From: Thom DeCarlo
> Sent: Friday, September 24, 2004 8:42 AM
> To: 'GDAL developers'
> Subject: RE: [Gdal-dev] Need help compiling on Windows with Dev-C++ and
> MinGW
> 
> 
> Well, I wasn't able to compile with MinGW. However I was able to compile
> after installing the Cygwin environment. Now to figure out how to
> compile OpenSceneGraph with that...
> 
> Thom
> 
> 
> > -----Original Message-----
> > From: Thom DeCarlo
> > Sent: Wednesday, September 22, 2004 3:44 PM
> > To: 'GDAL developers'
> > Subject: [Gdal-dev] Need help compiling on Windows with Dev-C++ and
> > MinGW
> >
> > Well, the subject says it all. I need to build gdal on a Win2K machine
> 
> > that does not have the MS compilers. I am a complete newbie when it
> > comes to Dev-C++ and MinGW, but I have successfully installed the
> > software.
> >
> > Can anyone provide any help getting gdal to compile? Or maybe just
> > point me at another info source?
> >
> > Thanks,
> > Thom
> >
> 
> 



From alexamici at fastwebnet.it  Fri Sep 24 18:25:12 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <a06110402bd787f281fef@[192.107.62.86]>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
	<a06110402bd787f281fef@[192.107.62.86]>
Message-ID: <200409250025.12392.alexamici@fastwebnet.it>


Lorenzo,

On Thursday 23 September 2004 16:38, Lorenzo Moretti wrote:
> In OS X the libraries are inside the folder but an invisible folder
> named ".libs" inside gdal source dir.

> row 69
> - LIBRARY_DIRS = ["./libs"]
> + LIBRARY_DIRS = ["./.libs"]

just for the record.

this is not OS X specific, all unix variants (that i know of) have their 
temporary libraries inside ./.libs and the problem with the setup.py script 
is a plain and simple typo (that happens to work if you have an installed 
copy of gdal on your system).

Frank, please apply the attached 01 patch (against current cvs).

> row 103
> - ("lib", ['libgdal.%s.so' % soversion]),
> + ("lib", ['libgdal.%s.dylib' % soversion]),

this is more annoying. a special case may be in order.

the second patch attached works on linux. does it fix the "dylib" problem on 
OS X?

> This patch does not work in 1.2.2 or other ...

Frank, the attached 03 patch should fix the 1.2.2 breakage. please apply.

cheers,
alessandro
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 01-libs-fix.diff
Type: text/x-diff
Size: 426 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040925/71a9fae5/01-libs-fix.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 02-macosx-fix.diff
Type: text/x-diff
Size: 413 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040925/71a9fae5/02-macosx-fix.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 03-1.2.2-fix.diff
Type: text/x-diff
Size: 500 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040925/71a9fae5/03-1.2.2-fix.bin
From warmerdam at pobox.com  Fri Sep 24 19:07:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <200409250025.12392.alexamici@fastwebnet.it>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
	<a06110402bd787f281fef@[192.107.62.86]>
	<200409250025.12392.alexamici@fastwebnet.it>
Message-ID: <4154A8BE.9050908@pobox.com>

Alessandro Amici wrote:
> Frank, the attached 03 patch should fix the 1.2.2 breakage. please apply.


Alessandro,

I have applied the 3 patches you provide ... you wanted them all applied,
right?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Sat Sep 25 02:04:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL 1.2.3 Release Candidate
Message-ID: <41550A54.1050208@pobox.com>

Folks,

Due to a number of fairly serious flaws in the 1.2.2 release, I have prepared
a 1.2.3 release.  I have put a release candidate up on gdal.org, but I haven't
finished testing it.  Anyone who has run into problems, or who would like
to give it a spin is encouraged to download and build it.

   http://www.gdal.org/dl/gdal-1.2.3.tar.gz
   http://www.gdal.org/dl/gdal123.zip

I will declare it official in the next day or two after I have done some
further test builds with it if no one else raises any issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From alexamici at fastwebnet.it  Sat Sep 25 04:06:38 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <4154A8BE.9050908@pobox.com>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
	<200409250025.12392.alexamici@fastwebnet.it>
	<4154A8BE.9050908@pobox.com>
Message-ID: <200409251006.39126.alexamici@fastwebnet.it>


Frank,

On Saturday 25 September 2004 01:07, Frank Warmerdam wrote:
> I have applied the 3 patches you provide ... you wanted them all applied,
> right?

i could test the first and the third patches myself.

i'm not sure that the second patch is actually of any use, because i don't 
know if the os.name variable classify OS X as "mac" or "posix". it is not 
going to hurt anybody, anyhow.

moreover, the setup.py script is not used during the standard build, it must 
be explicitly invoked as a work-around to build python support on OS X.

cheers,
alessandro

From daniel112b at home.se  Sat Sep 25 10:37:28 2004
From: daniel112b at home.se (Daniel B=?ISO-8859-1?Q?=E4ck ?=)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] What formats does the OGDI driver support?
Message-ID: <1096123048.cd2b8a00daniel112b@home.se>

Hi,

What formats does the OGDI driver support?

/Daniel


From warmerdam at pobox.com  Sat Sep 25 10:46:37 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] What formats does the OGDI driver support?
In-Reply-To: <1096123048.cd2b8a00daniel112b@home.se>
References: <1096123048.cd2b8a00daniel112b@home.se>
Message-ID: <415584CD.4060005@pobox.com>

Daniel B?ck wrote:
> Hi,
> 
> What formats does the OGDI driver support?

Daniel,

The open source OGDI kit at ogdi.sf.net includes support for DTED, ADRG,
and pretty much any VPF or RPF product.  Of course there are many VPF
products (such as VMAP0, VITD, ...) and RPF products (such as CADRG, CIB,
...).

There may also be OGDI drivers available from commercial vendors.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From zak-ms at hoppsan.org  Sat Sep 25 19:01:31 2004
From: zak-ms at hoppsan.org (Zak James)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <200409251006.39126.alexamici@fastwebnet.it>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
	<200409250025.12392.alexamici@fastwebnet.it>
	<4154A8BE.9050908@pobox.com>
	<200409251006.39126.alexamici@fastwebnet.it>
Message-ID: <D7583AC5-0F46-11D9-8673-000D933576F4@hoppsan.org>

Allesandro,

On OS X 10.3.5 with the supplied Python 2.3, os.name returns "posix".

In any case, I think what the patch is trying to do is erroneous. The 
libgdal dynamic library should have an extension of dylib 
(corresponding to Mach-O dynamically linked shared library ppc) but the 
python module needs to be a loadable module. The convention for these 
'bundle' files is to use the .so extension corresponding to Mach-O 
bundle ppc.

Please correct me if I'm wrong on this.

zak



On Sep 25, 2004, at 4:06 AM, Alessandro Amici wrote:

>
> Frank,
>
> On Saturday 25 September 2004 01:07, Frank Warmerdam wrote:
>> I have applied the 3 patches you provide ... you wanted them all 
>> applied,
>> right?
>
> i could test the first and the third patches myself.
>
> i'm not sure that the second patch is actually of any use, because i 
> don't
> know if the os.name variable classify OS X as "mac" or "posix". it is 
> not
> going to hurt anybody, anyhow.
>
> moreover, the setup.py script is not used during the standard build, 
> it must
> be explicitly invoked as a work-around to build python support on OS X.
>
> cheers,
> alessandro
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>


From dem at acri-st.fr  Mon Sep 27 10:58:21 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] update TIFF compressed files in place
In-Reply-To: <20040924215834.GC6123@ak4719.spb.edu>
References: <EGEELFLLNIGMPKHJFEEEIENEDBAA.larry@nuglyphix.com>
	<20040924215834.GC6123@ak4719.spb.edu>
Message-ID: <6.1.1.1.0.20040927164940.02612730@pop3>

Andrey,

I work with CVS GDAL and play with the new feature "update TIFF compressed 
files in place" with gdalwarp ; my little tests work well except with a RGB 
file with JPEG compression :

Warning 1: JPEGLib:Application transferred too many scanlines
ERROR 1: JPEGLib:Improper call to JPEG library in state 101
Warning 1: JPEGLib:Application transferred too many scanlines
ERROR 1: JPEGLib:Improper call to JPEG library in state 101
Warning 1: JPEGLib:Application transferred too many scanlines

and the resulting file is wrong.

If I want to create a pixel interleaved file (-co INTERLEAVE=PIXEL) I have 
another error :

Warning 1: JPEGLib:Application transferred too many scanlines
gdalwarp: tif_jpeg.c:651: JPEGPreDecode: Assertion 
`sp->cinfo.comm.is_decompressor' failed.

and the resulting file is all black...


Thanks in advance,

Julien

At 23:58 24/09/2004, Andrey Kiselev wrote:
>On Thu, Sep 23, 2004 at 01:41:31PM -0400, Larry Grill wrote:
> > I'm seeing a large performance hit with 3.7b vs. 3.6.1 compiled under
> > MS VC7 or VC6. Our the code section loops through rows doing,
> > TIFFReadEncodedStrip and TIFFWriteScanline. The perfomance difference
> > is approximately 30% and I can compare with a simple recompile of our
> > application linking one version of the library vs. the other.
>
>Larry,
>
>I think I know why the new libtiff is slower than the older one. I have
>implemented a new feature (update compressed files in place), but this
>results in perfomance degradation. I know how to improve things, so the
>fix will come shortly.
>
>                                                         Andrey
>--
>Andrey V. Kiselev
>Home phone:  +7 812 5274898  ICQ# 26871517
>_______________________________________________
>Tiff mailing list
>Tiff@remotesensing.org
>http://xserve.flids.com/mailman/listinfo/tiff


From ealpert at digitalglobe.com  Mon Sep 27 13:30:46 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] rgb2pct.py and NO_DATA?
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B17AB@COMAIL01.digitalglobe.com>



It seems that rgb2pct.py will use my transparent color when it chooses
the quantized colormap and assign non-transaprent pixels this color
index. Any suggestions on how to avoid this? I get transparent speckles
scattered throught my quantized images.

-e

From warmerdam at pobox.com  Mon Sep 27 14:47:05 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] rgb2pct.py and NO_DATA?
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB16017B17AB@COMAIL01.digitalglobe.com>
References: <1FB6937A87F9074C9A2B8F9D9137EB16017B17AB@COMAIL01.digitalglobe.com>
Message-ID: <41586029.5010807@pobox.com>

Ethan Alpert wrote:
> 
> It seems that rgb2pct.py will use my transparent color when it chooses
> the quantized colormap and assign non-transaprent pixels this color
> index. Any suggestions on how to avoid this? I get transparent speckles
> scattered throught my quantized images.

Ethan,

Is your situation that you have a particular value marked as NODATA on
your red, green and blue input bands and that this is being ignored?  If so,
it should be possible to adjust the code for building a PCT to ignore such
pixels, (but to add a transparent color if any are found), and then to change
the DitherRGB2PCT() code to keep track of that.  If this is what you need,
please submit a bug report.  If you are interested in doing it yourself and
submitting patches let me know.

However, it is pretty uncommon for folks to have nodata properly marked on
multispectral input images, so I hadn't thought about this before.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Mon Sep 27 14:25:52 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] update TIFF compressed files in place
In-Reply-To: <6.1.1.1.0.20040927164940.02612730@pop3>
References: <EGEELFLLNIGMPKHJFEEEIENEDBAA.larry@nuglyphix.com>
	<20040924215834.GC6123@ak4719.spb.edu>
	<6.1.1.1.0.20040927164940.02612730@pop3>
Message-ID: <20040927182552.GA15174@ak4719.spb.edu>

On Mon, Sep 27, 2004 at 04:58:21PM +0200, Julien Demaria wrote:
> I work with CVS GDAL and play with the new feature "update TIFF
> compressed files in place" with gdalwarp ; my little tests work well
> except with a RGB file with JPEG compression :
> 
> Warning 1: JPEGLib:Application transferred too many scanlines
> ERROR 1: JPEGLib:Improper call to JPEG library in state 101
> Warning 1: JPEGLib:Application transferred too many scanlines
> ERROR 1: JPEGLib:Improper call to JPEG library in state 101
> Warning 1: JPEGLib:Application transferred too many scanlines
> 
> and the resulting file is wrong.
> 
> If I want to create a pixel interleaved file (-co INTERLEAVE=PIXEL) I have 
> another error :
> 
> Warning 1: JPEGLib:Application transferred too many scanlines
> gdalwarp: tif_jpeg.c:651: JPEGPreDecode: Assertion 
> `sp->cinfo.comm.is_decompressor' failed.
> 
> and the resulting file is all black...

Julien,

I'm not sure that JPEG codec is able to work properly with that feature,
but I will look at this.

						Andrey

PS.
I won't be available until the end of the week.

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Mon Sep 27 14:25:52 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:24 2007
Subject: [Tiff] Re: [Gdal-dev] update TIFF compressed files in place
In-Reply-To: <6.1.1.1.0.20040927164940.02612730@pop3>
References: <EGEELFLLNIGMPKHJFEEEIENEDBAA.larry@nuglyphix.com>
	<20040924215834.GC6123@ak4719.spb.edu>
	<6.1.1.1.0.20040927164940.02612730@pop3>
Message-ID: <20040927182552.GA15174@ak4719.spb.edu>

On Mon, Sep 27, 2004 at 04:58:21PM +0200, Julien Demaria wrote:
> I work with CVS GDAL and play with the new feature "update TIFF
> compressed files in place" with gdalwarp ; my little tests work well
> except with a RGB file with JPEG compression :
> 
> Warning 1: JPEGLib:Application transferred too many scanlines
> ERROR 1: JPEGLib:Improper call to JPEG library in state 101
> Warning 1: JPEGLib:Application transferred too many scanlines
> ERROR 1: JPEGLib:Improper call to JPEG library in state 101
> Warning 1: JPEGLib:Application transferred too many scanlines
> 
> and the resulting file is wrong.
> 
> If I want to create a pixel interleaved file (-co INTERLEAVE=PIXEL) I have 
> another error :
> 
> Warning 1: JPEGLib:Application transferred too many scanlines
> gdalwarp: tif_jpeg.c:651: JPEGPreDecode: Assertion 
> `sp->cinfo.comm.is_decompressor' failed.
> 
> and the resulting file is all black...

Julien,

I'm not sure that JPEG codec is able to work properly with that feature,
but I will look at this.

						Andrey

PS.
I won't be available until the end of the week.

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Tiff mailing list
Tiff@remotesensing.org
http://xserve.flids.com/mailman/listinfo/tiff




From route at cae.com  Mon Sep 27 15:11:45 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] pb creating a bmp
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D162@caemsx03.cae.ca>

Hi,

i'm using GDAL 1.2.2.0, released 2004/08/16 on Windows 2000 with
VisualC++6.0 SP5

I was working with bmp file :
	
void testGDAL()
{
	GDALAllRegister();
    GDALDriver *poDriver;
    char **papszMetadata;

    poDriver = GetGDALDriverManager()->GetDriverByName("BMP");

    if( poDriver == NULL )
       return;

    papszMetadata = poDriver->GetMetadata();
    if( !CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE, FALSE ) )
	{
	printf( "Driver %s does not support Create() method.\n" );
        return;
	}
 	int x = 40;
	int y = 40;
    GDALDataset* m_gdalDataSet = poDriver->Create( "T:\\foo.bmp", x, y, 3,
GDT_Byte, NULL);
	if ( m_gdalDataSet == NULL )
		return;

	GDALRasterBand *poBand = m_gdalDataSet->GetRasterBand(1);
	if ( poBand == NULL )
		return;

	unsigned char* value = (unsigned char*)malloc(x*y);
	memset(value,255,x*y);
	CPLErr err = poBand->RasterIO( GF_Write, 0, 0, x, y, value, x, y,
GDT_Byte, 0, 0 );    
	free(value);
	if ( err != CE_None )
	{
		return;
	}
	m_gdalDataSet->FlushCache();
	GDALClose(m_gdalDataSet);
};

as output (in stdout) I have :
ERROR 3: Can't write block with X offset 0 and Y offset 0
ERROR 3: Can't write block with X offset 0 and Y offset 1
ERROR 3: Can't write block with X offset 0 and Y offset 2
ERROR 3: Can't write block with X offset 0 and Y offset 3
(...)
ERROR 3: Can't write block with X offset 0 and Y offset 33
ERROR 3: Can't write block with X offset 0 and Y offset 34

RasterIO returns CE_None and the created file is wrong.

can you help me with this problem ?
I tried to check the gdal code when debugging, but I'm lost.

Thanks in advance,

Stephane

From ealpert at digitalglobe.com  Mon Sep 27 15:59:26 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] rgb2pct.py and NO_DATA?
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B17AC@COMAIL01.digitalglobe.com>




Frank Wrote:

> Is your situation that you have a particular value marked as NODATA on
your red, green and blue input bands and that this is being ignored?
> If so, it should be possible to adjust the code for building a PCT to
ignore such pixels, (but to add a transparent color if any are found), 
> and then to change the DitherRGB2PCT() code to keep track of that.  If
this is what you need, please submit a bug report.  If you are 
> interested in doing it yourself and submitting patches let me know.

> However, it is pretty uncommon for folks to have nodata properly
marked on multispectral input images, so I hadn't thought about this
before.


Yep this is what I'm doing and intend. I am warping and mosaicing
multiple strips of imagery together. My goal is to have an indexed color
image to display in mapserver (I have several reasons for needing
indexed color). Because of color histogram differnces between the strips
of imagery I must quantize the image as my last step. Rgb2pct.py does
great except for this one problem. 

I'll submit a but report and start looking into how I can do this.

Thanks for the info.

-ethan





From warmerdam at pobox.com  Mon Sep 27 15:59:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] pb creating a bmp
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D162@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D162@caemsx03.cae.ca>
Message-ID: <4158712D.1080602@pobox.com>

Stephane Routelous wrote:
> Hi,
> 
> i'm using GDAL 1.2.2.0, released 2004/08/16 on Windows 2000 with
> VisualC++6.0 SP5
> 
> I was working with bmp file :
...
> as output (in stdout) I have :
> ERROR 3: Can't write block with X offset 0 and Y offset 0
> ERROR 3: Can't write block with X offset 0 and Y offset 1
> ERROR 3: Can't write block with X offset 0 and Y offset 2
> ERROR 3: Can't write block with X offset 0 and Y offset 3
> (...)
> ERROR 3: Can't write block with X offset 0 and Y offset 33
> ERROR 3: Can't write block with X offset 0 and Y offset 34
> 
> RasterIO returns CE_None and the created file is wrong.
> 
> can you help me with this problem ?
> I tried to check the gdal code when debugging, but I'm lost.

Stephane,

Hmm, your code works fine for me on Linux with the current CVS version.
No chance it is anything obvious like the T: drive being full is it?

I'll make a quick try on Windows when my wife makes way for me.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Mon Sep 27 17:09:18 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] pb creating a bmp
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D163@caemsx03.cae.ca>

Arg !!!
You are right. T: is full. (banging the head against the wall for spending 3
hours trying to find the problem)
Sorry :-(

Stephane

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Monday, September 27, 2004 4:00 PM
To: Stephane Routelous
Cc: 'gdal-dev@xserve.flids.com'
Subject: Re: [Gdal-dev] pb creating a bmp


Stephane Routelous wrote:
> Hi,
> 
> i'm using GDAL 1.2.2.0, released 2004/08/16 on Windows 2000 with
> VisualC++6.0 SP5
> 
> I was working with bmp file :
...
> as output (in stdout) I have :
> ERROR 3: Can't write block with X offset 0 and Y offset 0
> ERROR 3: Can't write block with X offset 0 and Y offset 1
> ERROR 3: Can't write block with X offset 0 and Y offset 2
> ERROR 3: Can't write block with X offset 0 and Y offset 3
> (...)
> ERROR 3: Can't write block with X offset 0 and Y offset 33
> ERROR 3: Can't write block with X offset 0 and Y offset 34
> 
> RasterIO returns CE_None and the created file is wrong.
> 
> can you help me with this problem ?
> I tried to check the gdal code when debugging, but I'm lost.

Stephane,

Hmm, your code works fine for me on Linux with the current CVS version.
No chance it is anything obvious like the T: drive being full is it?

I'll make a quick try on Windows when my wife makes way for me.

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Mon Sep 27 22:25:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] pb creating a bmp
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D163@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D163@caemsx03.cae.ca>
Message-ID: <4158CB9F.6020209@pobox.com>

Stephane Routelous wrote:
> Arg !!!
> You are right. T: is full. (banging the head against the wall for spending 3
> hours trying to find the problem)
> Sorry :-(
> 
> Stephane

Stephane,

Ahh, sometimes the simplest problems are the hardest.  Would you mind
submitting a bug into bugzilla about this.  It looks like the code that
writes the header does not check whether or not the writes are succeeding
so we don't discover the error at the point it should come out.

Andrey or I can fix the bug as time permits if there is a clear bug report
on the issue.

Thanks,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From daniel112b at home.se  Tue Sep 28 05:13:05 2004
From: daniel112b at home.se (Daniel B=?ISO-8859-1?Q?=E4ck ?=)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Creating overviews in different folder
Message-ID: <1096362785.d5043660daniel112b@home.se>

Hi,

I would like to be able to create external overviews in a different folder from the original file. The data might be on a shared nework drive where i don't have write access and it could be very handy to be able to be able to keep the data from others clean from my files.

It would be very easy to use if you could supply the overview filename to BuildOverviews and GDALOpen but that would break the binary compatibility. 

GDALDefaultOverviews allready supports overviews with a different location trough the pszBasename parameter of Initialize and BuildOverviews.

Any thoughts on how to change/add the interface to support this?

/Daniel




From warmerdam at pobox.com  Tue Sep 28 09:00:38 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Creating overviews in different folder
In-Reply-To: <1096362785.d5043660daniel112b@home.se>
References: <1096362785.d5043660daniel112b@home.se>
Message-ID: <41596076.8080207@pobox.com>

Daniel B?ck wrote:
> Hi,
> 
> I would like to be able to create external overviews in a different folder from 
 > the original file. The data might be on a shared nework drive where i don't have
 > write access and it could be very handy to be able to be able to keep the data
 > from others clean from my files.
> 
> It would be very easy to use if you could supply the overview filename to 
 > BuildOverviews and GDALOpen but that would break the binary compatibility.
> 
> GDALDefaultOverviews allready supports overviews with a different location 
 > trough the pszBasename parameter of Initialize and BuildOverviews.
> 
> Any thoughts on how to change/add the interface to support this?

Daniel,

Do you want to be able to use the overviews with the original file?  If
so, it isn't clear how GDAL is going to put the overviews and the original
file back together again.

On unix, a solution to the problem would be to create a soft link on a
filesystem you do have write permissions to, pointing to the original file.
Then gdaladdo would be able to create an external overview file in the
same directory as the soft link.

On Windows, this isn't really practical.  One relatively recent change made
in GDAL was to support building overviews for virtual files.  So on windows
you could do something like:

  gdal_translate -of VRT x:\target.tif c:\target.vrt
  gdaladdo c:\target.vrt 2 4 8 16

This should result in creating a small .vrt file that refers back to the
original .tif file.  And the overviews should be built as c:\target.vrt.ovr
and used automatically when you work with target.vrt.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From wjimage at sohu.com  Mon Sep 27 22:23:14 2004
From: wjimage at sohu.com (wjimage@sohu.com)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] problem/bug about GDAL
Message-ID: <12574077.1096338194765.JavaMail.postfix@mx55.mail.sohu.com>


Hello,
I'm regret to refer some bugs of GDAL through email but not bbs because I haven't receive the password email of my account.

I have developed a FFT program based on GDAL,when read the geo. infomation using GetProjectionRef,it's ok, then i write it to the result file,the function return CE_None(read the geo. infomation immediatelly to another char * variable, it's ok,except that UTM is known as unnamed (why?,ERDAS img format)),but in the ERDAS system, the geo. information is NULL. In fact ,the geo. information is NULL when i use the output file of previous result as the input file.
That means, the geo. information can't be written(i have tried GTiff and HFA)! Another bug: the input file and the output file is upside-down when using HFA format!

waiting for your answer.

thanks

wu jun


attatch of src code

if( (strGeoRef = pSrcDataset->GetProjectionRef()) != NULL && strlen(strGeoRef)>0 )
{
      if( CE_None == pDstDataset->SetProjection( strGeoRef ) )
        tGeo = pDstDataset->GetProjectionRef();
}

From daniel112b at home.se  Tue Sep 28 10:43:24 2004
From: daniel112b at home.se (Daniel B=?ISO-8859-1?Q?=E4ck ?=)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Creating overviews in different folder
Message-ID: <1096382604.ce86c3e0daniel112b@home.se>

Yes i would like to use the overviews with the original file, supplying a location or name of the overview file in the call to GDALOpen or similar.

The solution with the .vrt dataset might work out nicely for me, creating it with CreateCopy in the new location. Any immediate draw backs to this solution?

Thanks,

Daniel

On Tue, 28 Sep 2004 09:00:38 -0400, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Daniel B?ck wrote:
> > Hi,
> >
> > I would like to be able to create external overviews in a different folder from
>  > the original file. The data might be on a shared nework drive where i don't have
>  > write access and it could be very handy to be able to be able to keep the data
>  > from others clean from my files.
> >
> > It would be very easy to use if you could supply the overview filename to
>  > BuildOverviews and GDALOpen but that would break the binary compatibility.
> >
> > GDALDefaultOverviews allready supports overviews with a different location
>  > trough the pszBasename parameter of Initialize and BuildOverviews.
> >
> > Any thoughts on how to change/add the interface to support this?
> 
> Daniel,
> 
> Do you want to be able to use the overviews with the original file?  If
> so, it isn't clear how GDAL is going to put the overviews and the original
> file back together again.
> 
> On unix, a solution to the problem would be to create a soft link on a
> filesystem you do have write permissions to, pointing to the original file.
> Then gdaladdo would be able to create an external overview file in the
> same directory as the soft link.
> 
> On Windows, this isn't really practical.  One relatively recent change made
> in GDAL was to support building overviews for virtual files.  So on windows
> you could do something like:
> 
>   gdal_translate -of VRT x:\target.tif c:\target.vrt
>   gdaladdo c:\target.vrt 2 4 8 16
> 
> This should result in creating a small .vrt file that refers back to the
> original .tif file.  And the overviews should be built as c:\target.vrt.ovr
> and used automatically when you work with target.vrt.
> 
> Best regards,
> 
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> 




From warmerdam at pobox.com  Tue Sep 28 11:04:09 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Creating overviews in different folder
In-Reply-To: <1096382604.ce86c3e0daniel112b@home.se>
References: <1096382604.ce86c3e0daniel112b@home.se>
Message-ID: <41597D69.5060802@pobox.com>

Daniel B?ck wrote:
> Yes i would like to use the overviews with the original file, supplying a 
 > location or name of the overview file in the call to GDALOpen or similar.

Daniel,

I am not keen on changing the GDALOpen() or overview generation API to
start passing in names of overview files.

> The solution with the .vrt dataset might work out nicely for me, creating 
 > it with CreateCopy in the new location. Any immediate draw backs to this solution?

The main downside other than complication is that raster access through
a virtual file can be somewhat slower depending on how it is done.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From lorenzo.moretti at bologna.enea.it  Tue Sep 28 12:00:58 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Python modules fail to compile on MAC OS X
In-Reply-To: <a06110402bd787f281fef@[192.107.62.86]>
References: <5565A34160380E4D8BC99BCD2115A51B46035D@osexch1.fao.org>
	<a06110402bd787f281fef@[192.107.62.86]>
Message-ID: <a06110402bd7f38c0193f@[192.107.62.86]>

Alessandro wrote:

>just for the record.
>
>this is not OS X specific, all unix variants (that i know of) have their
>temporary libraries inside ./.libs and the problem with the setup.py script
>is a plain and simple typo (that happens to work if you have an installed
>copy of gdal on your system).
>
>Frank, please apply the attached 01 patch (against current cvs).
>
>>  row 103
>>  - ("lib", ['libgdal.%s.so' % soversion]),
>>  + ("lib", ['libgdal.%s.dylib' % soversion]),
>
>this is more annoying. a special case may be in order.
>
>the second patch attached works on linux. does it fix the "dylib" problem on
>OS X?
>
>>  This patch does not work in 1.2.2 or other ...
>
>Frank, the attached 03 patch should fix the 1.2.2 breakage. please apply.
>
>cheers,
>alessandro
>
>Attachment converted: APPLI:01-libs-fix.diff (TEXT/R*ch) (0035CEC6)
>Attachment converted: APPLI:02-macosx-fix.diff (TEXT/R*ch) (0035CEC7)
>Attachment converted: APPLI:03-1.2.2-fix.diff (TEXT/R*ch) (0035CEC8)


Your PATCH works in all GDAL versions. Very good.

Now I have _gdalmodule.so with other files in my site-packages folder.

Bye Alessandro

-- 
________________________________________________________________________
||       Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|   ENEA prot/idr          Web: http://wwwamb.bologna.enea.it/    
||   |   via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (res.)
~~~~~~   40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
			Download GRASS for MAC OS X:    
	           http://wwwamb.bologna.enea.it/forgrass/
________________________________________________________________________

From mrmallete at gmail.com  Wed Sep 29 02:49:09 2004
From: mrmallete at gmail.com (Michael Mallete)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
Message-ID: <2ade7f6e04092823497cafd2c0@mail.gmail.com>

good day everyone!

i am encountering some problems converting shapefiles to postgis using
ogr2ogr. upon execution, i get this error:

ERROR 1: INSERT command for new feature failed.
ERROR: new row for relation "<table name here>" violates check
constraint "enforce_geotype_wkb_geometry"

ERROR 1: Terminating translation prematurely after failed translation
of layer <table name here>

hope you could help. thanx in advance. have a nice day everyone! :)

-Myk

From daniel112b at home.se  Wed Sep 29 09:08:36 2004
From: daniel112b at home.se (Daniel B=?ISO-8859-1?Q?=E4ck ?=)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Creating overviews in different folder
Message-ID: <1096463316.a5448da0daniel112b@home.se>


On Tue, 28 Sep 2004 11:04:09 -0400, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Daniel B?ck wrote:
> > Yes i would like to use the overviews with the original file, supplying a
>  > location or name of the overview file in the call to GDALOpen or similar.
> 
> Daniel,
> 
> I am not keen on changing the GDALOpen() or overview generation API to
> start passing in names of overview files.
> 

That's understandable.

> > The solution with the .vrt dataset might work out nicely for me, creating
>  > it with CreateCopy in the new location. Any immediate draw backs to this solution?
> 
> The main downside other than complication is that raster access through
> a virtual file can be somewhat slower depending on how it is done.
> 

I gave the .vrt dataset solution a try and i ran into some problems/questions.

1. If I create .vrt dataset with CreateCopy i can't build overviews for it by calling BuildOverviews. The CreateCopy method doesn't initialize the overview manager on the copy. Of course i can close the copy and then reopen it and then build the overviews but is it intended to work that way?

2. The .vrt dataset doesn't report the blocksize correctly, the VRTRasterBand initializes the block size to MIN(128,nXSize) in the initialize method. I'm not sure i have understood all possibilities with the .vrt dataset and it might just be a good reason to why it behaves like that, is it?

Thanks,

Daniel


From warmerdam at pobox.com  Wed Sep 29 09:14:27 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <2ade7f6e04092823497cafd2c0@mail.gmail.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>
Message-ID: <415AB533.5060201@pobox.com>

Michael Mallete wrote:
> good day everyone!
> 
> i am encountering some problems converting shapefiles to postgis using
> ogr2ogr. upon execution, i get this error:
> 
> ERROR 1: INSERT command for new feature failed.
> ERROR: new row for relation "<table name here>" violates check
> constraint "enforce_geotype_wkb_geometry"
> 
> ERROR 1: Terminating translation prematurely after failed translation
> of layer <table name here>
> 
> hope you could help. thanx in advance. have a nice day everyone! :)

Myk,

Is this a new table being created by ogr2ogr?  I have never encountered
this error before.

You might want to set the CPL_DEBUG environment variable to a value of ON
and then rerun.  You will get quite a bit more information about what is
going on internally then.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 29 09:17:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Frightening ancient libpng inside GDAL
In-Reply-To: <01ae01c4a5e6$d4f3dff0$f400fe0a@TOPP2>
References: <01ae01c4a5e6$d4f3dff0$f400fe0a@TOPP2>
Message-ID: <415AB5F6.5080607@pobox.com>

Ben Discoe wrote:
> Frank,
> 
> I never saw a response to my list message below, but glancing at the GDAL's
> 1.2.3 snapshot, it looks like GDAL's copy of libpng has been updated to
> libpng 1.2.6?

Ben,

Correct.  I took your comment to heart, even if I never got back to responding
to the original email once it was done.

cc:ing to the list in case others are interested.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 29 09:20:57 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: FW: 1.2.3
In-Reply-To: <01b001c4a5eb$595692c0$f400fe0a@TOPP2>
References: <01b001c4a5eb$595692c0$f400fe0a@TOPP2>
Message-ID: <415AB6B9.1010304@pobox.com>

Ben Discoe wrote:
> A small build fix for GDAL 1.2.3 as of the .tar.gz that's up there now.
> 
> usgsdem_create.cpp
> changg:
> #include "gdalwarper.h"
> to:
> #include "../../alg/gdalwarper.h"
> 
> This matches the example of other files, e.g. 
> 
> gdal-1.2.3\frmts\vrt\vrtwarped.cpp(51):
> #include "../../alg/gdalwarper.h"

Ben,

Actually, I would prefer to change everything to not using the
relative paths for the includes.  The "alg" directive is now required to
be in the include path for builds of GDAL and GDALmake.opt.in and nmake.opt
were updated accordingly.

For some clients I actually deliver all of GDAL as a single amorphous
directory of library code for simplier integration into other build
environments.  In these cases the relative paths cause problems.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 29 09:41:03 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] GDAL 1.2.3 Formally Released
Message-ID: <415ABB6F.6080705@pobox.com>

Folks,

Ben reminded me I didn't formally announce the 1.2.3 release.  After a couple
small patches from the release candidate I have published a formal 1.2.3
release as of Sunday or so.  Note that 1.2.3 is essentially just a bug fix
release.

GDAL 1.2.3 - Overview of Changes
--------------------------------

GeoTIFF Driver:
     - Fixed many missing compression codecs when built with the internal
       libtiff.
     - Modified driver metadata to only list available compression types.

DODS Driver:
     - Added support for OPeNDAP version after 3.4.x (use of opendap-config).

GRASS Driver:
     - Fixed support for building with grass57.

MrSID Driver:
     - Fixed support for MrSID Encoding SDK.

NITF Driver:
     - Fixed serious bug with non-square output files.


OGR 1.2.3 - Overview of Changes
-------------------------------

OGRSpatialReference:
     - Corrected memory leaks - OSRCleanup() cleans up temporary tables.
     - Fixed build problem with ogrct.cpp on Solaris.

TIGER Driver:
     - Improved generality of support for GDT files.

OGRGeometry:
     - Added getArea() method for rings, polygons and multipolygons.


The 1.2.3 source may be downloaded from:

   http://gdal.org/dl/gdal-1.2.3.tar.gz
   http://gdal.org/dl/gdal123.zip

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From otto.dassau at gmx.de  Wed Sep 29 11:21:23 2004
From: otto.dassau at gmx.de (Otto Dassau)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [GRASS5] export RGB channels in one ERDAS/IMG file
In-Reply-To: <4134AFEF.6080004@pobox.com>
References: <200408310930.i7V9UKC28030@grass.itc.it>
	<4134AFEF.6080004@pobox.com>
Message-ID: <20040929152600.23B1533836F@xserve.flids.com>

On Tue, 31 Aug 2004 13:05:51 -0400
Frank Warmerdam <warmerdam@pobox.com> wrote:

> Otto Dassau wrote:
> > Dear list, 
> > 
> > I would like to export several rasterfiles (channels R,G,B,..) in one ERDAS/IMG
>  > file with GDAL. Is this possible?
> > 
> > r.out.gdal is working, but I can't find an option how to do this in the manual 
>  > pages. Does anybody has an idea?
> 
> 
> Otto,
> 
> I did a quick check of r.out.gdal and it does not seem to support outputting
> more than one raster layer at a time to an output file even though I can see
> that would be highly desirable.  Likely it should offer an option to export
> a "group" as that is the equivelent to a stack of image bands in GDALs data
> model.

Hi,

Now I export single layers (R,G,B) into ERDAS format and use gdal_merge.py to put them in one layer stack, but there is a problem:

gdal_merge.py works with small layers (e.g. 2000x2000 pixels) but crashes with large data sets (31476x31818). 

###ERROR:
gdal_merge.py -v -of HFA 1.img -separate 1b.img 1g.img 1r.img 

Filename: 1.img
File Size: 31476x31818x3
Pixel Size: 0.320000 x -0.320000
UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
Copy 0,0,31476,31818 to 0,0,31476,31818.
ERROR 1: 1.img:0: Invalid strip byte count, strip 0
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 0
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
Traceback (most recent call last):
  File "/usr/local/bin/gdal_merge.py", line 439, in ?
    fi.copy_into( t_fh, 1, t_band, nodata )
  File "/usr/local/bin/gdal_merge.py", line 268, in copy_into
    nodata_arg )
  File "/usr/local/bin/gdal_merge.py", line 101, in raster_copy
    t_xsize, t_ysize, t_band.DataType )
  File "/usr/lib/python2.3/site-packages/gdal.py", line 690, in ReadRaster
    buf_xsize, buf_ysize,buf_type)
TypeError: GetBlockRef failed at X block offset 0, Y block offset 0

Why is there a problem with TIFF, although I export to ERDAS? 

thanks a lot
  Otto

 
> Given that it does not, it seems you might have to do this all rather
> indirectly.  One approach is to output individual rasters and then composite
> them with an external application like OpenEV or within Imagine itself.




From otto.dassau at gmx.de  Wed Sep 29 11:37:48 2004
From: otto.dassau at gmx.de (Otto Dassau)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] color tables ERDAS
Message-ID: <20040929154223.CFCFA3384A2@xserve.flids.com>

Hi, 

exporting B,G,R to ERDAS with gdal the color tables seem to be broken somehow. 

Here are two screenshots (sorry, pretty large):

original B,G,R composite in GRASS 
http://www.gdf-hannover.de/dassau/muell/grassrgb.jpg

see QGIS version of layer stack B,G,R after gdal_merge
http://www.gdf-hannover.de/dassau/muell/grassrgb2.jpg

Does anybody has a hint or a solution for this. GRASS and GDAL are both compiled from CVS yesterday.

  Otto

From warmerdam at pobox.com  Wed Sep 29 13:31:36 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [GRASS5] export RGB channels in one ERDAS/IMG file
In-Reply-To: <20040929152559.1E1752D0D@ruby.pobox.com>
References: <200408310930.i7V9UKC28030@grass.itc.it>	<4134AFEF.6080004@pobox.com>
	<20040929152559.1E1752D0D@ruby.pobox.com>
Message-ID: <415AF178.6020409@pobox.com>

Otto Dassau wrote:

> ###ERROR:
> gdal_merge.py -v -of HFA 1.img -separate 1b.img 1g.img 1r.img 
> 
> Filename: 1.img
> File Size: 31476x31818x3
> Pixel Size: 0.320000 x -0.320000
> UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
> Copy 0,0,31476,31818 to 0,0,31476,31818.
> ERROR 1: 1.img:0: Invalid strip byte count, strip 0
> ERROR 1: TIFFReadEncodedStrip() failed.
> 
> ERROR 1: IReadBlock failed at X offset 0, Y offset 0
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
> Traceback (most recent call last):
>   File "/usr/local/bin/gdal_merge.py", line 439, in ?
>     fi.copy_into( t_fh, 1, t_band, nodata )
>   File "/usr/local/bin/gdal_merge.py", line 268, in copy_into
>     nodata_arg )
>   File "/usr/local/bin/gdal_merge.py", line 101, in raster_copy
>     t_xsize, t_ysize, t_band.DataType )
>   File "/usr/lib/python2.3/site-packages/gdal.py", line 690, in ReadRaster
>     buf_xsize, buf_ysize,buf_type)
> TypeError: GetBlockRef failed at X block offset 0, Y block offset 0
> 
> Why is there a problem with TIFF, although I export to ERDAS? 

Otto,

I don't know why.  How sure are you that 1g.img, 1r.img and 1b.img are
really imagine files?  I would verify this with gdalinfo.

BTW, I think you need to use the -o flag otherwise output goes to
out.tif.  So try:

   gdal_merge.py -v -of HFA -o 1.img -separate 1b.img 1g.img 1r.img

If problems persist you will need to give us more information.  Does
gdal_merge.py work with only one input file (try each)?  etc.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From sewell at dramail.com  Wed Sep 29 16:20:31 2004
From: sewell at dramail.com (Ken Sewell)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
Message-ID: <Pine.LNX.4.53.0409291617230.23915@server.dramail.com>


Given a lat/lon can GDAL tell me what pixel is associated with it(if
any)?  I've found the function that will give me the lat/lon from the
pixel, but I can't seem to find one that gives me a pixel from a lat/lon?
Does such a function exist within GDAL?  Thanks.

Ken Sewell                   Defense Research Associates
Project Engineer             3915 Germany Lane, Suite 102
937-656-4899 x3004           Beavercreek, Ohio 45431-1608
sewell@dramail.com

From mrmallete at gmail.com  Wed Sep 29 22:30:07 2004
From: mrmallete at gmail.com (Michael Mallete)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <415AB533.5060201@pobox.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>
	<415AB533.5060201@pobox.com>
Message-ID: <2ade7f6e04092919302d77d5b5@mail.gmail.com>

good day sir! thank you very much for your kind reply. :)

yes it's a new table being created by ogr2ogr. how do i set the
CPL_DEBUG environment variable?

anyways, i am using the OpenEV_FW kit in a Win2k platform. i am using
ogr2ogr to convert and insert shapefiles to postgis to an external
server running on a win2k server platfrom. i've had success converting
and inserting my other shapefiles. i only encounter this problem from
time to time. i'm wondering what's so unique with the data which
failed with the data which were successfully converted/inserted.

anyways, thanx again sir! hoping my problem is solvable. 

have a nice day! :)

-Myk 




On Wed, 29 Sep 2004 09:14:27 -0400, Frank Warmerdam <warmerdam@pobox.com> wrote:
> 
> 
> Michael Mallete wrote:
> > good day everyone!
> >
> > i am encountering some problems converting shapefiles to postgis using
> > ogr2ogr. upon execution, i get this error:
> >
> > ERROR 1: INSERT command for new feature failed.
> > ERROR: new row for relation "<table name here>" violates check
> > constraint "enforce_geotype_wkb_geometry"
> >
> > ERROR 1: Terminating translation prematurely after failed translation
> > of layer <table name here>
> >
> > hope you could help. thanx in advance. have a nice day everyone! :)
> 
> Myk,
> 
> Is this a new table being created by ogr2ogr?  I have never encountered
> this error before.
> 
> You might want to set the CPL_DEBUG environment variable to a value of ON
> and then rerun.  You will get quite a bit more information about what is
> going on internally then.
> 
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
>

From warmerdam at pobox.com  Wed Sep 29 22:56:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <2ade7f6e04092919302d77d5b5@mail.gmail.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>	
	<415AB533.5060201@pobox.com>
	<2ade7f6e04092919302d77d5b5@mail.gmail.com>
Message-ID: <415B75DE.8080807@pobox.com>

Michael Mallete wrote:
> good day sir! thank you very much for your kind reply. :)
> 
> yes it's a new table being created by ogr2ogr. how do i set the
> CPL_DEBUG environment variable?
> 
> anyways, i am using the OpenEV_FW kit in a Win2k platform. i am using
> ogr2ogr to convert and insert shapefiles to postgis to an external
> server running on a win2k server platfrom. i've had success converting
> and inserting my other shapefiles. i only encounter this problem from
> time to time. i'm wondering what's so unique with the data which
> failed with the data which were successfully converted/inserted.
> 
> anyways, thanx again sir! hoping my problem is solvable. 

Myk,

OK, on review of the OGR PostGIS code and your error message, I am now
guessing that your shapefiles contains polygons and OGR reports it's
geometry type as Polygon.  If so, ogr2ogr will try to create a PostGIS
table where the geometry column is constrained to be of type polygon.

However, polygon shapefiles can actually have some "multi-island"
polygons.  Recently OGR was improved to treat these as Multipolygons
as they ought to be according to the OpenGIS Simple Features geometry
model.  The downside is that you can't put MultiPolygons into a Polygon
geometry column in PostGIS.

If everything was being done manually, the trick would be to set the
geometry type of the column to "GEOMETRY" in the AddGeometryColumn()
call.

I was just going to say that ogr2ogr provides no means to do this.
But on review of the ogr2ogr commandline options I see it does!

You should be able to add "-nlt geometry" to tell ogr2ogr to create the
new layer with unconstrained geometry.  Let me know if this works.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Sep 29 22:58:28 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <Pine.LNX.4.53.0409291617230.23915@server.dramail.com>
References: <Pine.LNX.4.53.0409291617230.23915@server.dramail.com>
Message-ID: <415B7654.1040704@pobox.com>

Ken Sewell wrote:
> Given a lat/lon can GDAL tell me what pixel is associated with it(if
> any)?  I've found the function that will give me the lat/lon from the
> pixel, but I can't seem to find one that gives me a pixel from a lat/lon?
> Does such a function exist within GDAL?  Thanks.


Ken,

Generally speaking, going from lat/long to pixel is the same process as
going from pixel to lat/long.  Can you show how you are doing from
pixel to lat/long?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From mrmallete at gmail.com  Wed Sep 29 23:50:29 2004
From: mrmallete at gmail.com (Michael Mallete)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <415B75DE.8080807@pobox.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>
	<415AB533.5060201@pobox.com>
	<2ade7f6e04092919302d77d5b5@mail.gmail.com>
	<415B75DE.8080807@pobox.com>
Message-ID: <2ade7f6e04092920502ea11075@mail.gmail.com>

hello again mr. warmerdam! 

yes now it works! i tried using ogr2ogr with "-nlt multipolygon"
option. i guess that solves that. thank you so much for this. :)

although i do have another problem. there are some shapefiles that
when i convert/insert, this error appears:

ERROR 1: INSERT command for new feature failed.
ERROR: numeric field overflow

ERROR 1: Terminating translation prematurely after failed translation
of layer <layer name here>

what does "numeric field overflow" mean? sorry for being a pest. my
problems just keep on coming. anyway thank you so much again sir for
your help.

have a nice day! :)

-Myk


On Wed, 29 Sep 2004 22:56:30 -0400, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Michael Mallete wrote:
> > good day sir! thank you very much for your kind reply. :)
> >
> > yes it's a new table being created by ogr2ogr. how do i set the
> > CPL_DEBUG environment variable?
> >
> > anyways, i am using the OpenEV_FW kit in a Win2k platform. i am using
> > ogr2ogr to convert and insert shapefiles to postgis to an external
> > server running on a win2k server platfrom. i've had success converting
> > and inserting my other shapefiles. i only encounter this problem from
> > time to time. i'm wondering what's so unique with the data which
> > failed with the data which were successfully converted/inserted.
> >
> > anyways, thanx again sir! hoping my problem is solvable.
> 
> Myk,
> 
> OK, on review of the OGR PostGIS code and your error message, I am now
> guessing that your shapefiles contains polygons and OGR reports it's
> geometry type as Polygon.  If so, ogr2ogr will try to create a PostGIS
> table where the geometry column is constrained to be of type polygon.
> 
> However, polygon shapefiles can actually have some "multi-island"
> polygons.  Recently OGR was improved to treat these as Multipolygons
> as they ought to be according to the OpenGIS Simple Features geometry
> model.  The downside is that you can't put MultiPolygons into a Polygon
> geometry column in PostGIS.
> 
> If everything was being done manually, the trick would be to set the
> geometry type of the column to "GEOMETRY" in the AddGeometryColumn()
> call.
> 
> I was just going to say that ogr2ogr provides no means to do this.
> But on review of the ogr2ogr commandline options I see it does!
> 
> You should be able to add "-nlt geometry" to tell ogr2ogr to create the
> new layer with unconstrained geometry.  Let me know if this works.
> 
> 
> 
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
>

From warmerdam at pobox.com  Wed Sep 29 23:56:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <2ade7f6e04092920502ea11075@mail.gmail.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>	
	<415AB533.5060201@pobox.com>	
	<2ade7f6e04092919302d77d5b5@mail.gmail.com>	
	<415B75DE.8080807@pobox.com>
	<2ade7f6e04092920502ea11075@mail.gmail.com>
Message-ID: <415B83F3.7030804@pobox.com>

Michael Mallete wrote:
> hello again mr. warmerdam! 
> 
> yes now it works! i tried using ogr2ogr with "-nlt multipolygon"
> option. i guess that solves that. thank you so much for this. :)
> 
> although i do have another problem. there are some shapefiles that
> when i convert/insert, this error appears:
> 
> ERROR 1: INSERT command for new feature failed.
> ERROR: numeric field overflow
> 
> ERROR 1: Terminating translation prematurely after failed translation
> of layer <layer name here>
> 
> what does "numeric field overflow" mean? sorry for being a pest. my
> problems just keep on coming. anyway thank you so much again sir for
> your help.

Michael,

DBF files include information on the width and precision of numeric fields.
But they don't necesarily enforce them while PostgreSQL does.  I suspect
that some numeric values are being passed through that don't match with the
field definition used and this is causing PostgreSQL to choke.  It would be
helpful if you could provide a sample dataset with this problem for me to
investigate further.

I actually did some work recently on the PG driver in OGR to auto-trim long
strings when needed.  Perhaps something similar will be needed for numeric
fields.

In the meantime, you may find the -skipfailures switch to ogr2ogr lets you
proceed with loading most of your data.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 30 00:35:02 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] ogr2ogr shapefile to postgis error
In-Reply-To: <2ade7f6e04092921071d3f5410@mail.gmail.com>
References: <2ade7f6e04092823497cafd2c0@mail.gmail.com>	
	<415AB533.5060201@pobox.com>	
	<2ade7f6e04092919302d77d5b5@mail.gmail.com>	
	<415B75DE.8080807@pobox.com>	
	<2ade7f6e04092920502ea11075@mail.gmail.com>	
	<415B83F3.7030804@pobox.com>
	<2ade7f6e04092921071d3f5410@mail.gmail.com>
Message-ID: <415B8CF6.2030408@pobox.com>

Michael Mallete wrote:
> i see. anyway, here's one of the shapefiles from which i encounter
> this problem sir. so for the meantime i'll heed your advice and use
> -skipfailures for the time being. you've been very helpful sir. i
> can't thank you enough. have a wonderful day ahead. :)

Myk,

The "dbfdump" utility reports this:

warmerda@gdal2200[183]% dbfdump -h -r babuyan.dbf | more                        Field 0: Type=Double, Title=`AREA', 
Width=19, Decimals=11
Field 1: Type=Double, Title=`PERIMETER', Width=19, Decimals=11
Field 2: Type=Integer, Title=`BABUY2_', Width=9, Decimals=0
Field 3: Type=Integer, Title=`BABUY2_ID', Width=9, Decimals=0
                AREA           PERIMETER   BABUY2_ BABUY2_ID
787832.00000000000  3823.87988281250    2         1
7.50226000000e+007  35785.00000000000   3         1
2671240.00000000000 7036.04980468750    4         1
1.94556992000e+008  69256.60156250000   5         1
6.40785000000e+007  40739.60156250000   6         1
54942.19921875000   908.68597412109     7         1
1.68442000000e+008  69378.29687500000   8         1
275060.00000000000  2211.82006835938    9         1
67753.50000000000   1032.68005371094    10        1
9.32392000000e+007  50166.69921875000   11        1
745418.00000000000  3506.34008789063    12        1
976459.00000000000  4958.12988281250    13        1
3933290.00000000000 7308.72021484375    14        1

Basically, the AREA field is defined as 19.11 (19 wide with 11 decimal
places).  But some of the area values are too large to fit in this so
it appears that ESRI software is just putting them in exponential format
(the -r dumps the raw contents of the fields).

Well, I, perhaps foolishly, carry the width and precision information into
PostgreSQL.  And it actually enforces the precision limits.

The solution is to use the PRECISION=NO layer creation option.  This forces
OGR to create the fields as FLOAT8 instead of NUMERIC(19,11).  I tried with
your dataset and it works fine.

There is a certain tension between OGR trying to carry declaritive
information about field definitions or layer types through to PostGIS vs.
doing stuff in the most flexible way possible.

In any event, I was able to load the layer you provided using the command:

ogr2ogr -update -nlt geometry -lco OVERWRITE=yes -lco PRECISION=no \
         PG:dbname=warmerda babuyan.shp

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From otto.dassau at gmx.de  Thu Sep 30 06:17:31 2004
From: otto.dassau at gmx.de (Otto Dassau)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [GRASS5] export RGB channels in one ERDAS/IMG file
In-Reply-To: <415AF178.6020409@pobox.com>
References: <200408310930.i7V9UKC28030@grass.itc.it>
	<4134AFEF.6080004@pobox.com>
	<20040929152559.1E1752D0D@ruby.pobox.com>
	<415AF178.6020409@pobox.com>
Message-ID: <20040930102208.84FE533BEF4@xserve.flids.com>

On Wed, 29 Sep 2004 13:31:36 -0400
Frank Warmerdam <warmerdam@pobox.com> wrote:

> Otto Dassau wrote:
> 
> > ###ERROR:
> > gdal_merge.py -v -of HFA 1.img -separate 1b.img 1g.img 1r.img 
> > 
> > Filename: 1.img
> > File Size: 31476x31818x3
> > Pixel Size: 0.320000 x -0.320000
> > UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
> > Copy 0,0,31476,31818 to 0,0,31476,31818.
> > ERROR 1: 1.img:0: Invalid strip byte count, strip 0
> > ERROR 1: TIFFReadEncodedStrip() failed.
> > 
> > ERROR 1: IReadBlock failed at X offset 0, Y offset 0
> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
> > Traceback (most recent call last):
> >   File "/usr/local/bin/gdal_merge.py", line 439, in ?
> >     fi.copy_into( t_fh, 1, t_band, nodata )
> >   File "/usr/local/bin/gdal_merge.py", line 268, in copy_into
> >     nodata_arg )
> >   File "/usr/local/bin/gdal_merge.py", line 101, in raster_copy
> >     t_xsize, t_ysize, t_band.DataType )
> >   File "/usr/lib/python2.3/site-packages/gdal.py", line 690, in ReadRaster
> >     buf_xsize, buf_ysize,buf_type)
> > TypeError: GetBlockRef failed at X block offset 0, Y block offset 0
> > 
> > Why is there a problem with TIFF, although I export to ERDAS? 
> 
> Otto,
> 
> I don't know why.  How sure are you that 1g.img, 1r.img and 1b.img are
> really imagine files?  I would verify this with gdalinfo.
> 
> BTW, I think you need to use the -o flag otherwise output goes to
> out.tif.  So try:
> 
>    gdal_merge.py -v -of HFA -o 1.img -separate 1b.img 1g.img 1r.img
> 
> If problems persist you will need to give us more information.  Does
> gdal_merge.py work with only one input file (try each)?  etc.
> 

Hi, 

ok sorry, more information, I don't know what you need, so I start answering your 3 questions first:

a) B,G,R are IMAGINE files:

gdalinfo 1b.img | more
Driver: HFA/Erdas Imagine Images (.img)
Size is 31476, 31818
Coordinate System is:
PROJCS["Transverse Mercator",
    GEOGCS["Deutsches_Hauptdreiecksnetz",
        DATUM["Deutsches_Hauptdreiecksnetz",
            SPHEROID["bessel",6377397.155,299.1528128000033],
            TOWGS84[590.5,69.5,411.6,-0.796,-0.052,-3.601,8.3]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",3500000],
    PARAMETER["false_northing",0],
    UNIT["meters",1]]
Origin = (3367943.360000,5941153.600000)
Pixel Size = (0.32000000,-0.32000000)
Corner Coordinates:
Upper Left  ( 3367943.360, 5941153.600) (  7d 0'19.92"E, 53d35'12.17"N)
Lower Left  ( 3367943.360, 5930971.840) (  7d 0'35.38"E, 53d29'42.99"N)
Upper Right ( 3378015.680, 5941153.600) (  7d 9'27.24"E, 53d35'20.95"N)
Lower Right ( 3378015.680, 5930971.840) (  7d 9'41.53"E, 53d29'51.74"N)
Center      ( 3372979.520, 5936062.720) (  7d 5'1.02"E, 53d32'32.05"N)
Band 1 Block=64x64 Type=Int16, ColorInterp=Palette
  Color Table (RGB with 65536 entries)
...

gdalinfo 1g.img | more
Driver: HFA/Erdas Imagine Images (.img)
Size is 31476, 31818
Coordinate System is:
PROJCS["Transverse Mercator",
    GEOGCS["Deutsches_Hauptdreiecksnetz",
        DATUM["Deutsches_Hauptdreiecksnetz",
            SPHEROID["bessel",6377397.155,299.1528128000033],
            TOWGS84[590.5,69.5,411.6,-0.796,-0.052,-3.601,8.3]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",3500000],
    PARAMETER["false_northing",0],
    UNIT["meters",1]]
Origin = (3367943.360000,5941153.600000)
Pixel Size = (0.32000000,-0.32000000)
Corner Coordinates:
Upper Left  ( 3367943.360, 5941153.600) (  7d 0'19.92"E, 53d35'12.17"N)
Lower Left  ( 3367943.360, 5930971.840) (  7d 0'35.38"E, 53d29'42.99"N)
Upper Right ( 3378015.680, 5941153.600) (  7d 9'27.24"E, 53d35'20.95"N)
Lower Right ( 3378015.680, 5930971.840) (  7d 9'41.53"E, 53d29'51.74"N)
Center      ( 3372979.520, 5936062.720) (  7d 5'1.02"E, 53d32'32.05"N)
Band 1 Block=64x64 Type=Int16, ColorInterp=Palette
  Color Table (RGB with 65536 entries)
...

gdalinfo 1r.img | more
Driver: HFA/Erdas Imagine Images (.img)
Size is 31476, 31818
Coordinate System is:
PROJCS["Transverse Mercator",
    GEOGCS["Deutsches_Hauptdreiecksnetz",
        DATUM["Deutsches_Hauptdreiecksnetz",
            SPHEROID["bessel",6377397.155,299.1528128000033],
            TOWGS84[590.5,69.5,411.6,-0.796,-0.052,-3.601,8.3]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",3500000],
    PARAMETER["false_northing",0],
    UNIT["meters",1]]
Origin = (3367943.360000,5941153.600000)
Pixel Size = (0.32000000,-0.32000000)
Corner Coordinates:
Upper Left  ( 3367943.360, 5941153.600) (  7d 0'19.92"E, 53d35'12.17"N)
Lower Left  ( 3367943.360, 5930971.840) (  7d 0'35.38"E, 53d29'42.99"N)
Upper Right ( 3378015.680, 5941153.600) (  7d 9'27.24"E, 53d35'20.95"N)
Lower Right ( 3378015.680, 5930971.840) (  7d 9'41.53"E, 53d29'51.74"N)
Center      ( 3372979.520, 5936062.720) (  7d 5'1.02"E, 53d32'32.05"N)
Band 1 Block=64x64 Type=Int16, ColorInterp=Palette
  Color Table (RGB with 65248 entries)
...

b) The "you need to use the -o flag" error was my fault, but still it doesn't work.

Filename: 1b.img
File Size: 31476x31818x1
Pixel Size: 0.320000 x -0.320000
UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
Copy 0,0,31476,31818 to 0,0,31476,31818.

ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
...

c) does gdal_merge.py work with only one input file

gdal_merge.py -v -of HFA -o 1.img -separate 1b.img

Filename: 1b.img
File Size: 31476x31818x1
Pixel Size: 0.320000 x -0.320000
UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
Copy 0,0,31476,31818 to 0,0,31476,31818.

ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing

gdal_merge.py -v -of HFA -o 1.img -separate 1g.img

Filename: 1g.img
File Size: 31476x31818x1
Pixel Size: 0.320000 x -0.320000
UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
Copy 0,0,31476,31818 to 0,0,31476,31818.

ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing

gdal_merge.py -v -of HFA -o 1.img -separate 1r.img

Filename: 1r.img
File Size: 31476x31818x1
Pixel Size: 0.320000 x -0.320000
UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
Copy 0,0,31476,31818 to 0,0,31476,31818.

ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing


  Otto



From tim at linfiniti.com  Thu Sep 30 09:21:51 2004
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] netcdf reading problems
Message-ID: <200409301421.51500.tim@linfiniti.com>

Hi

I am trying to read netcdf data with gdal so that I can convert it to ascii 
format, and to be able to view it in QGIS. I found that gdal wont read 
any .nc files I give it. The data I am trying to read is multiband (e.g. 
http://linux-gis.co.uk/climate_sample.nc), but even a simple single band 
layer (http://linux-gis.co.uk/simple.nc) wont read. Iget error message like 
this from gdal:

aps02ts@linux:/tmp/netcdf_tests> gdalinfo simple.nc
ERROR 4: `simple.nc' not recognised as a supported file format.

GDALOpen failed - 4
`simple.nc' not recognised as a supported file format.

My gdal is built against cvs head:

aps02ts@linux:/tmp/netcdf_tests> gdalinfo --version
GDAL 1.2.2.0, released 2004/08/16

And has netcdf support compiled in :

aps02ts@linux:/tmp/netcdf_tests> gdalinfo --formats
Supported Formats:
 
8<----------- snip-----------------
  netCDF (rw): network Common Data Format
8<----------- snip-----------------


And the netcdf lib I am using is a suse rpm:

aps02ts@linux:/tmp/netcdf_tests> rpm -qa |grep netcdf
netcdf-3.5.0-665

I have tested the sample data with a standlone netcdf viewer (ncview) and it 
is able to read the data without problem.

Any help you can offer will be greatly appreciated!

Regards

Tim Sutton

-- 
The only reason for time is so that everything doesn't happen at once 
 --Albert Einstein 

Get my public keys from:

http://tim.suttonfamily.co.uk/modules.php?name=Content&pa=showpage&pid=2

From warmerdam at pobox.com  Thu Sep 30 09:37:11 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] netcdf reading problems
In-Reply-To: <200409301421.51500.tim@linfiniti.com>
References: <200409301421.51500.tim@linfiniti.com>
Message-ID: <415C0C07.8070502@pobox.com>

Tim Sutton wrote:
> Hi
> 
> I am trying to read netcdf data with gdal so that I can convert it to ascii 
> format, and to be able to view it in QGIS. I found that gdal wont read 
> any .nc files I give it. The data I am trying to read is multiband (e.g. 
> http://linux-gis.co.uk/climate_sample.nc), but even a simple single band 
> layer (http://linux-gis.co.uk/simple.nc) wont read. Iget error message like 
> this from gdal:
> 
> aps02ts@linux:/tmp/netcdf_tests> gdalinfo simple.nc
> ERROR 4: `simple.nc' not recognised as a supported file format.

Tim,

When I wrote the netcdf driver I was primarily interested in exchanging data
with GMT which uses a very specific organization of the data.  The GDAL
netCDF driver ignores datasets (even netCDF files) that don't match those
assumptions.

Your dataset does not appear to have been generated by GMT.

I do hope to rewrite this driver someday to adhere to the more general
COORDS definitions for grid data but this is a reasonably substantial
job and not anywhere near the top of my priority pile.

Sorry...

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tim at linfiniti.com  Thu Sep 30 09:42:26 2004
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] netcdf reading problems
In-Reply-To: <415C0C07.8070502@pobox.com>
References: <200409301421.51500.tim@linfiniti.com> <415C0C07.8070502@pobox.com>
Message-ID: <200409301442.26734.tim@linfiniti.com>

Hi

Ok many thanks for the reply...Ill try a different approach for the time 
being.

Regards

Tim

On Thursday 30 September 2004 14:37, Frank Warmerdam wrote:
> Tim Sutton wrote:
> > Hi
> >
> > I am trying to read netcdf data with gdal so that I can convert it to
> > ascii format, and to be able to view it in QGIS. I found that gdal wont
> > read any .nc files I give it. The data I am trying to read is multiband
> > (e.g. http://linux-gis.co.uk/climate_sample.nc), but even a simple single
> > band layer (http://linux-gis.co.uk/simple.nc) wont read. Iget error
> > message like this from gdal:
> >
> > aps02ts@linux:/tmp/netcdf_tests> gdalinfo simple.nc
> > ERROR 4: `simple.nc' not recognised as a supported file format.
>
> Tim,
>
> When I wrote the netcdf driver I was primarily interested in exchanging
> data with GMT which uses a very specific organization of the data.  The
> GDAL netCDF driver ignores datasets (even netCDF files) that don't match
> those assumptions.
>
> Your dataset does not appear to have been generated by GMT.
>
> I do hope to rewrite this driver someday to adhere to the more general
> COORDS definitions for grid data but this is a reasonably substantial
> job and not anywhere near the top of my priority pile.
>
> Sorry...
>
> Best regards,

-- 
The only reason for time is so that everything doesn't happen at once 
 --Albert Einstein 

Get my public keys from:

http://tim.suttonfamily.co.uk/modules.php?name=Content&pa=showpage&pid=2

From support at geoimage.fr  Thu Sep 30 09:45:44 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGR dynamic driver loading...
Message-ID: <002401c4a6f3$c8e6d010$3801a8c0@pili>

Hello,

i have recently experimented the use of the "GDAL_DRIVER_PATH".
It's a great mecanism allowing me to :
    - download a well built gdal/ogr distribution ( the openev's one for example ),
    - compile my custom drivers against the associated includes/libs,
    - use my drivers in all gdal/ogr applications including openev, gdal_xxx...

Did you plan to integrate the same kind of dynamic driver loading into OGR ?

It should be great to be able to do the same thing with vector drivers !
_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From nhv at cape.com  Thu Sep 30 09:55:25 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] netcdf reading problems
In-Reply-To: <415C0C07.8070502@pobox.com>
Message-ID: <EKEJIKAILPONGGENMBGAAEALIPAA.nhv@cape.com>

Frank Warmerdam writes:
> 
> Tim Sutton wrote:
> > Hi
> > 
> > I am trying to read netcdf data with gdal so that I can convert it to ascii 
> > format, and to be able to view it in QGIS. I found that gdal wont read 
> > any .nc files I give it. The data I am trying to read is multiband (e.g. 
> > http://linux-gis.co.uk/climate_sample.nc), but even a simple single band 
> > layer (http://linux-gis.co.uk/simple.nc) wont read. Iget error message like 
> > this from gdal:
> > 
> > aps02ts@linux:/tmp/netcdf_tests> gdalinfo simple.nc
> > ERROR 4: `simple.nc' not recognised as a supported file format.
> 
> Tim,
> 
> When I wrote the netcdf driver I was primarily interested in exchanging data
> with GMT which uses a very specific organization of the data.  The GDAL
> netCDF driver ignores datasets (even netCDF files) that don't match those
> assumptions.
> 
> Your dataset does not appear to have been generated by GMT.
> 
> I do hope to rewrite this driver someday to adhere to the more general
> COORDS definitions for grid data but this is a reasonably substantial
> job and not anywhere near the top of my priority pile.

Tim

If you use Python you will should find a combination of GDAL's Python
Interface and Konrad Hinsen's Scientific Python extension module useful,
as Scientific Python contains a generic NetCDF interface.

http://dirac.cnrs-orleans.fr/ScientificPython/

HTH

Norman

From dem at acri-st.fr  Thu Sep 30 10:10:04 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] TIFFGetConfiguredCODECs bug
Message-ID: <6.1.1.1.0.20040930160001.02364a98@pop3>

Hi,

In the current libtiff and GDAL CVS there is a bug in the new 
TIFFGetConfiguredCODECs function :

for (cd = registeredCODECS; cd; cd = cd->next) {
                 codecs = _TIFFrealloc(codecs, i * sizeof(TIFFCodec));
		_TIFFmemcpy(codecs + i - 1, cd->next, sizeof(TIFFCodec));
		i++;
}

the "cd->next" in _TIFFmemcpy shoul be "cd" only.

This function crashs only if there is at least one registered non-builtin 
codec...


Regards,

Julien


From warmerdam at pobox.com  Thu Sep 30 10:09:03 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] OGR dynamic driver loading...
In-Reply-To: <002401c4a6f3$c8e6d010$3801a8c0@pili>
References: <002401c4a6f3$c8e6d010$3801a8c0@pili>
Message-ID: <415C137F.8000409@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> i have recently experimented the use of the "GDAL_DRIVER_PATH".
> It's a great mecanism allowing me to :
>     - download a well built gdal/ogr distribution ( the openev's one for example ),
>     - compile my custom drivers against the associated includes/libs,
>     - use my drivers in all gdal/ogr applications including openev, gdal_xxx...
> 
> Did you plan to integrate the same kind of dynamic driver loading into OGR ?
> 
> It should be great to be able to do the same thing with vector drivers !
> _________________________________________________________________
> Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr

Fr?d?ric,

It is my intention to ... someday ... substantially restructure OGR to
be more closely integrated with GDAL. Amoung other things, this should
mean one central drivers registrar, and the OGRDataSource and OGRLayer
classes deriving from GDALMajorObject so they can have metadata.  As part
of that overhaul I would expect OGR drivers to inherit the same sort of
dynamic loading option as we have now for GDAL.

This would presumably be known as GDAL 2.0 since it would break binary
compatibility and likely even require a few small source changes to
OGR based applications.

However, I have no specific timelines nor are any of my clients driving
this overhaul.   In the meantime, I am hesitant to start building alternate
implementations of some of the capabilitie that already exist on the GDAL
side of things for OGR.

For me the handiest thing would be the ability to build a binary distribution
of GDAL (such as OpenEV_FW) that I can distribute with extra drivers for stuff
like Oracle that only work if Oracle client libraries are on the system.  But
of course, it is also handy for folks with site-local drivers of their own.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 30 10:14:18 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [Tiff] TIFFGetConfiguredCODECs bug
In-Reply-To: <6.1.1.1.0.20040930160001.02364a98@pop3>
References: <6.1.1.1.0.20040930160001.02364a98@pop3>
Message-ID: <415C14BA.7060000@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> In the current libtiff and GDAL CVS there is a bug in the new 
> TIFFGetConfiguredCODECs function :
> 
> for (cd = registeredCODECS; cd; cd = cd->next) {
>                 codecs = _TIFFrealloc(codecs, i * sizeof(TIFFCodec));
>         _TIFFmemcpy(codecs + i - 1, cd->next, sizeof(TIFFCodec));
>         i++;
> }
> 
> the "cd->next" in _TIFFmemcpy shoul be "cd" only.
> 
> This function crashs only if there is at least one registered 
> non-builtin codec...

Julien,

I have submitted this in the libtiff bug database.  Luckily we have caught
this in time to fix before the TIFF 3.7.0 final release.

   http://bugzilla.remotesensing.org/show_bug.cgi?id=623

I would encourage you to add yourself to the cc list.  You might also want
to add details to help me assess the risk this cases in GDAL.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Thu Sep 30 10:10:04 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] [spam] [Tiff] TIFFGetConfiguredCODECs bug
Message-ID: <6.1.1.1.0.20040930160001.02364a98@pop3>

Hi,

In the current libtiff and GDAL CVS there is a bug in the new 
TIFFGetConfiguredCODECs function :

for (cd = registeredCODECS; cd; cd = cd->next) {
                 codecs = _TIFFrealloc(codecs, i * sizeof(TIFFCodec));
		_TIFFmemcpy(codecs + i - 1, cd->next, sizeof(TIFFCodec));
		i++;
}

the "cd->next" in _TIFFmemcpy shoul be "cd" only.

This function crashs only if there is at least one registered non-builtin 
codec...


Regards,

Julien

_______________________________________________
Tiff mailing list
Tiff@remotesensing.org
http://xserve.flids.com/mailman/listinfo/tiff




From warmerdam at pobox.com  Thu Sep 30 10:14:18 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [Tiff] TIFFGetConfiguredCODECs bug
In-Reply-To: <6.1.1.1.0.20040930160001.02364a98@pop3>
References: <6.1.1.1.0.20040930160001.02364a98@pop3>
Message-ID: <415C14BA.7060000@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> In the current libtiff and GDAL CVS there is a bug in the new 
> TIFFGetConfiguredCODECs function :
> 
> for (cd = registeredCODECS; cd; cd = cd->next) {
>                 codecs = _TIFFrealloc(codecs, i * sizeof(TIFFCodec));
>         _TIFFmemcpy(codecs + i - 1, cd->next, sizeof(TIFFCodec));
>         i++;
> }
> 
> the "cd->next" in _TIFFmemcpy shoul be "cd" only.
> 
> This function crashs only if there is at least one registered 
> non-builtin codec...

Julien,

I have submitted this in the libtiff bug database.  Luckily we have caught
this in time to fix before the TIFF 3.7.0 final release.

   http://bugzilla.remotesensing.org/show_bug.cgi?id=623

I would encourage you to add yourself to the cc list.  You might also want
to add details to help me assess the risk this cases in GDAL.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Tiff mailing list
Tiff@remotesensing.org
http://xserve.flids.com/mailman/listinfo/tiff




From sewell at dramail.com  Thu Sep 30 11:11:16 2004
From: sewell at dramail.com (Ken Sewell)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <415B7654.1040704@pobox.com>
References: <Pine.LNX.4.53.0409291617230.23915@server.dramail.com>
	<415B7654.1040704@pobox.com>
Message-ID: <Pine.LNX.4.53.0409301105250.1478@server.dramail.com>


We're basically using the same code in the gdalinfo.c.  We're still
very new at using GDAL so how we go about reversing this to get the pixel
from a lat/lon is still not obvious.  Basically we just need to go both
directions pixel to lat/lon and lat/lon to pixel, we used this method
because we found it in an example.  Can anyone recommend a better way to
accomplish what we need to do?  Thanks.

    if( GDALGetGeoTransform( hDataset, adfGeoTransform ) == CE_None )
    {
        pszProjection = GDALGetProjectionRef(hDataset);

        dfGeoX = adfGeoTransform[0] + adfGeoTransform[1] * x
            + adfGeoTransform[2] * y;
        dfGeoY = adfGeoTransform[3] + adfGeoTransform[4] * x
            + adfGeoTransform[5] * y;
    }

    if( pszProjection != NULL && strlen(pszProjection) > 0 )
    {
        OGRSpatialReferenceH hProj, hLatLong = NULL;

        hProj = OSRNewSpatialReference( pszProjection );
        if( hProj != NULL )
            hLatLong = OSRCloneGeogCS( hProj );

        if( hLatLong != NULL )
        {
            CPLPushErrorHandler( CPLQuietErrorHandler );
            hTransform = OCTNewCoordinateTransformation( hProj, hLatLong
);
            CPLPopErrorHandler();

            OSRDestroySpatialReference( hLatLong );
        }

        if( hProj != NULL )
            OSRDestroySpatialReference( hProj );
    }

    if( hTransform != NULL
        && OCTTransform(hTransform,1,&dfGeoX,&dfGeoY,NULL) )
    {

        printf( "(%s,", GDALDecToDMS( dfGeoX, "Long", 2 ) );
        printf( "%s)", GDALDecToDMS( dfGeoY, "Lat", 2 ) );
    }

    if( hTransform != NULL )
        OCTDestroyCoordinateTransformation( hTransform );


Ken Sewell                   Defense Research Associates
Project Engineer             3915 Germany Lane, Suite 102
937-656-4899 x3004           Beavercreek, Ohio 45431-1608
sewell@dramail.com

On Wed, 29 Sep 2004, Frank Warmerdam wrote:

> Ken Sewell wrote:
> > Given a lat/lon can GDAL tell me what pixel is associated with it(if
> > any)?  I've found the function that will give me the lat/lon from the
> > pixel, but I can't seem to find one that gives me a pixel from a lat/lon?
> > Does such a function exist within GDAL?  Thanks.
>
>
> Ken,
>
> Generally speaking, going from lat/long to pixel is the same process as
> going from pixel to lat/long.  Can you show how you are doing from
> pixel to lat/long?
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>

From warmerdam at pobox.com  Thu Sep 30 11:12:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <Pine.LNX.4.53.0409301105250.1478@server.dramail.com>
References: <Pine.LNX.4.53.0409291617230.23915@server.dramail.com>	<415B7654.1040704@pobox.com>
	<Pine.LNX.4.53.0409301105250.1478@server.dramail.com>
Message-ID: <415C2262.5050207@pobox.com>

Ken Sewell wrote:
> We're basically using the same code in the gdalinfo.c.  We're still
> very new at using GDAL so how we go about reversing this to get the pixel
> from a lat/lon is still not obvious.  Basically we just need to go both
> directions pixel to lat/lon and lat/lon to pixel, we used this method
> because we found it in an example.  Can anyone recommend a better way to
> accomplish what we need to do?  Thanks.

Ken,

This is an appropriate mechanism.

To go in reverse you need to :

  1) Generate the hTransform the same way, but pass in the hProj and
     hLatLong arguments in the opposite order indicating that you are
     going from latlong to projected coordinates.

  2) Apply the hTransform (with OCTTransform) before using the geotransform.

  3) To "unapply" the geotransform, you can do the following if you make
     the simplying assumption that the image is northup (that is, that
     adfGeoTransform[2] == 0 and adfGeoTransform[4] is 0).  If this isn't
     the case there is a slightly more complex approach I can describe.

     x = (dfGeoX - adfGeoTransform[0]) / adfGeoTransform[1];
     y = (dfGeoY - adfGeoTransform[3]) / adfGeoTransform[5];

I hope this helps.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 30 12:20:00 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D16D@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D16D@caemsx03.cae.ca>
Message-ID: <415C3230.1030500@pobox.com>

Stephane Routelous wrote:
> hi,
> 
> funny, I'm just facing the same question !
> 
> what to you mean by 2) ?

   2) Apply the hTransform (with OCTTransform) before using the geotransform.

In the code Ken provided he was using the geotransform to convert from
pixel/line to projected coordinates, and then calling OCTTransform()
to reproject to lat/long.  When going from lat/long to pixel/line you
need to apply the OCTTransform() call to the input values and then do the
part with geotransform.

> And I'm also interessed by the 3) but with adfGeoTransform[2] and
> adfGeoTransform[4] != 0 . I tried to solve the equation by myself, my math
> courses are quite old :-(

The "properly" solution is to invert the geotransform and apply it the old way.
In a relatively recent GDAL the GDALInvGeoTransform() was made a public function.
So we would use instead:

     double adfInvGeoTransform[6];

     GDALInvGeoTransform( adfGeoTransform, adfInvGeoTransform );

     x = adfInvGeoTransform[0] + adfInvGeoTransform[1] * dfGeoX
                               + adfInvGeoTransform[2] * y;
     y = adfInvGeoTransform[3] + adfInvGeoTransform[4] * dfGeoY
                               + adfInvGeoTransform[5] * y;

The code for GDALInvGeoTransform() is in gdal/alg/gdaltransformer.cpp if you
want to inspect it.  It is a simple matrix inversion, but I have to admit my
math is also pretty rusty and I had to find the equations on the web.

You can also use GDALApplyGeoTransform() if you don't like the explicit use of
the geotransform equations by the way (make sure x and y are doubles!):

     GDALApplyGeoTransform( adfInvGeoTransform, dfGeoX, dfGeoY, &x, &y );

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Thu Sep 30 14:18:05 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] memory leak in geotiff.cpp
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D16E@caemsx03.cae.ca>

Hi,

Boundchecker detected a memory leak in geotiff.cpp line 3787 : the "codecs"
pointer is never destroyed.
(GDAL 1.2.3.0, released 2004/08/25 windows)

HTH,

Stephane

From warmerdam at pobox.com  Thu Sep 30 15:34:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: memory leak in geotiff.cpp
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D16E@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D16E@caemsx03.cae.ca>
Message-ID: <415C5FCA.3080205@pobox.com>

Stephane Routelous wrote:
> Hi,
> 
> Boundchecker detected a memory leak in geotiff.cpp line 3787 : the "codecs"
> pointer is never destroyed.
> (GDAL 1.2.3.0, released 2004/08/25 windows)

Doh!

Andrey warned me about this too, but I forgot about it during implementation.
I have committed a fix.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Sep 30 16:09:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Re: [GRASS5] export RGB channels in one ERDAS/IMG file
In-Reply-To: <20040930102210.F0AD811B2BF@icicle.pobox.com>
References: <200408310930.i7V9UKC28030@grass.itc.it>	<4134AFEF.6080004@pobox.com>	<20040929152559.1E1752D0D@ruby.pobox.com>	<415AF178.6020409@pobox.com>
	<20040930102210.F0AD811B2BF@icicle.pobox.com>
Message-ID: <415C67E9.8070401@pobox.com>

Otto Dassau wrote:
> gdal_merge.py -v -of HFA -o 1.img -separate 1r.img
> 
> Filename: 1r.img
> File Size: 31476x31818x1
> Pixel Size: 0.320000 x -0.320000
> UL:(3367943.360000,5941153.600000)   LR:(3378015.680000,5930971.840000)
> Copy 0,0,31476,31818 to 0,0,31476,31818.
> 
> ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing
> ERROR 1: TIFFWriteEncodedStrip:1.img: File not open for writing

Otto,

Sorry, I can't think of any explanation for what is happening.  I don't
get the same result in my attempts to reproduce the problem.  You might want
to verify that format is being used.  Perhaps by adding a print after the
driver is fetched:

     Driver = gdal.GetDriverByName(format)
     print 'using %s format driver for output.' % format

But I see no reason your -of option shouldn't be working unless you are
using an old version of gdal_merge.py where the option was -f instead of -of.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From sewell at dramail.com  Thu Sep 30 16:21:05 2004
From: sewell at dramail.com (Ken Sewell)
Date: Wed Nov 21 11:49:24 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <415C3230.1030500@pobox.com>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D16D@caemsx03.cae.ca>
	<415C3230.1030500@pobox.com>
Message-ID: <Pine.LNX.4.53.0409301617540.4551@server.dramail.com>


Frank,
	Thanks for your help, the GDALInvGeoTransform and
GDALApplyGeoTransform worked.  One quick correction, shouldn't the formula
below read like this:

>      x = adfInvGeoTransform[0] + adfInvGeoTransform[1] * dfGeoX
>                                + adfInvGeoTransform[2] * dfGeoY;
>      y = adfInvGeoTransform[3] + adfInvGeoTransform[4] * dfGeoX
>                                + adfInvGeoTransform[5] * dfGeoY;



Ken Sewell                   Defense Research Associates
Project Engineer             3915 Germany Lane, Suite 102
937-656-4899 x3004           Beavercreek, Ohio 45431-1608
sewell@dramail.com

On Thu, 30 Sep 2004, Frank Warmerdam wrote:

> Stephane Routelous wrote:
> > hi,
> >
> > funny, I'm just facing the same question !
> >
> > what to you mean by 2) ?
>
>    2) Apply the hTransform (with OCTTransform) before using the geotransform.
>
> In the code Ken provided he was using the geotransform to convert from
> pixel/line to projected coordinates, and then calling OCTTransform()
> to reproject to lat/long.  When going from lat/long to pixel/line you
> need to apply the OCTTransform() call to the input values and then do the
> part with geotransform.
>
> > And I'm also interessed by the 3) but with adfGeoTransform[2] and
> > adfGeoTransform[4] != 0 . I tried to solve the equation by myself, my math
> > courses are quite old :-(
>
> The "properly" solution is to invert the geotransform and apply it the old way.
> In a relatively recent GDAL the GDALInvGeoTransform() was made a public function.
> So we would use instead:
>
>      double adfInvGeoTransform[6];
>
>      GDALInvGeoTransform( adfGeoTransform, adfInvGeoTransform );
>
>      x = adfInvGeoTransform[0] + adfInvGeoTransform[1] * dfGeoX
>                                + adfInvGeoTransform[2] * y;
>      y = adfInvGeoTransform[3] + adfInvGeoTransform[4] * dfGeoY
>                                + adfInvGeoTransform[5] * y;
>
> The code for GDALInvGeoTransform() is in gdal/alg/gdaltransformer.cpp if you
> want to inspect it.  It is a simple matrix inversion, but I have to admit my
> math is also pretty rusty and I had to find the equations on the web.
>
> You can also use GDALApplyGeoTransform() if you don't like the explicit use of
> the geotransform equations by the way (make sure x and y are doubles!):
>
>      GDALApplyGeoTransform( adfInvGeoTransform, dfGeoX, dfGeoY, &x, &y );
>
> Best regards,
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>

From warmerdam at pobox.com  Thu Sep 30 16:23:54 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Get a pixel from a lat/lon.
In-Reply-To: <Pine.LNX.4.53.0409301617540.4551@server.dramail.com>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D16D@caemsx03.cae.ca>	<415C3230.1030500@pobox.com>
	<Pine.LNX.4.53.0409301617540.4551@server.dramail.com>
Message-ID: <415C6B5A.7020506@pobox.com>

Ken Sewell wrote:
> Frank,
> 	Thanks for your help, the GDALInvGeoTransform and
> GDALApplyGeoTransform worked.  One quick correction, shouldn't the formula
> below read like this:
> 
> 
>>     x = adfInvGeoTransform[0] + adfInvGeoTransform[1] * dfGeoX
>>                               + adfInvGeoTransform[2] * dfGeoY;
>>     y = adfInvGeoTransform[3] + adfInvGeoTransform[4] * dfGeoX
>>                               + adfInvGeoTransform[5] * dfGeoY;

Ken,

Yes, you are right.  Sorry about that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


