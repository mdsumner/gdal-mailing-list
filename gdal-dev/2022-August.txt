From even.rouault at spatialys.com  Mon Aug  1 08:03:32 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Aug 2022 17:03:32 +0200
Subject: [gdal-dev] New behaviour of "PROMOTE_TO_MULTI" ?
In-Reply-To: <bc65b462-c77a-5b58-21fe-56218dbe7a91@gmail.com>
References: <a973b3b2-47a7-f3eb-e4e5-ecd647405807@gmail.com>
 <CAHBySPYmUy5Dua+joHLmd79r2GbYXPLafUUFj6TMQm+TZbKx1w@mail.gmail.com>
 <742711968.14136783.1658757125530.JavaMail.zimbra@inrae.fr>
 <bc65b462-c77a-5b58-21fe-56218dbe7a91@gmail.com>
Message-ID: <2fcd55ab-49f3-f190-bf87-85a2d9391800@spatialys.com>

Bo Victor,

there's an important mention in the email you quote: "The effect of this 
option is that when a layer is of type Polygon, it will be
converted in the target format as MultiPolygon,".??? In your situation, 
the original layer geometry type is Geometry. There's no way that -nlt 
promote_to_multi can know that your geometries will actually be all 
polygon, or all linestring, and thus change the target layer geometry type.

We would probably a new option to ogr2ogr that would generalize the 
following open option of the shapefile driver:

ADJUST_GEOM_TYPE=NO/FIRST_SHAPE/ALL_SHAPES. Defines how layer geometry 
type is computed, in particular to distinguish shapefiles that have 
shapes with significant values in the M dimension from the ones where 
the M values are set to the nodata value. By default (FIRST_SHAPE), the 
driver will look at the first shape and if it has M values it will 
expose the layer as having a M dimension. By specifying ALL_SHAPES, the 
driver will iterate over features until a shape with a valid M value is 
found to decide the appropriate layer type.

You may file an enhancement ticket about that if you wish

Even

Le 31/07/2022 ? 10:00, Bo Victor Thomsen a ?crit?:
>
> Thanks to Hugues and Richard for responding to my questions.
>
> However, I'm using the ogr2ogr inside a DOS .cmd file like this:
>
> for /R D:\tmp %%f in (*.tab) do ogr2ogr --config PG_USE_COPY yes 
> -progress -lco OVERWRITE=YES -lco SCHEMA=mat -dim XY -a_srs EPSG:25832 
> -f "PostgreSQL" PG:"host=localhost port=5432 user=*** password=*** 
> dbname=geodata" "%%f"
>
> I.e. iterating through a directory plus sub-directories and converting 
> every found tab file into a table into schema "mat" using ogr2ogr
>
> The tab files contains either points, linestrings or polygons. 
> Polygons and linestrings can be a mix of simple and multi-objects. 
> Each tab-file contains only one main type.
>
> So I can't use "-nlt multipolygons". And the point of this project was 
> to get rid of a fairly complex postgres based function that checks an 
> uploaded table and change its geometry type using "alter table ... 
> using st_multi(geom)" type of commands.
>
> That was why I tried to use "-nlt promote_to_multi". According to this 
> mail:
>
> https://lists.osgeo.org/pipermail/gdal-dev/2012-September/034128.html
>
> Even Rouault describes the exact behaviour I'm looking for: Simple 
> linestrings / polygons will be changed to multi types and points will 
> be left alone. And the geometry type will be set to a "multi*" as needed.
>
> What actually happens is that linestrings, polygons /and/ points all 
> are changed to multi type, but the geometry type remains "Geometry".
>
>
> Med venlig hilsen / Kind regards
>
> Bo Victor Thomsen
> Den 25-07-2022 kl. 15:52 skrev Hugues Fran?ois:
>> Hi,
>>
>> I guess you should either
>> => drop the created table prior to launch the ogr2ogr command with 
>> the -nlt PROMOTE_TO_MULTI switch
>> => or maually alter the existing table: ALTER TABLE schema.table 
>> ALTER COLUMN geom TYPE geometry(MultiPolygon, SRID) using ST_MULTI(geom)
>>
>> HTH,
>> Hug
>>
>>
>> ------------------------------------------------------------------------
>> *De: *"Richard Greenwood" <richard.greenwood at gmail.com>
>> *?: *"Bo Victor Thomsen" <bo.victor.thomsen at gmail.com>
>> *Cc: *"gdal dev" <gdal-dev at lists.osgeo.org>
>> *Envoy?: *Lundi 25 Juillet 2022 15:32:35
>> *Objet: *Re: [gdal-dev] New behaviour of "PROMOTE_TO_MULTI" ?
>>
>> Have you tried -nlt MultiPolygon?
>>
>> On Mon, Jul 25, 2022 at 2:54 AM Bo Victor Thomsen 
>> <bo.victor.thomsen at gmail.com> wrote:
>>
>>     I have a MapInfo .tab file containing polygons, both simple and
>>     multipolygons (and only polygons).
>>
>>     Using this command: (all ogr2ogr commands are one-liners, but
>>     examples are split for lucidity)
>>
>>     ogr2ogr
>>     ? --config PG_USE_COPY yes
>>     ? -progress
>>     ? -lco OVERWRITE=YES
>>     ? -dim XY
>>     ? -f "PostgreSQL" PG:"host=localhost port=5432 user=***
>>     password=*** dbname=geodata"
>>     ? FREDSKOV.TAB
>>
>>     will (correctly) create a table in Postgres of PostGIS type
>>     "Geometry"
>>
>>     If I change the command to:
>>
>>     ogr2ogr
>>     ? --config PG_USE_COPY yes
>>     ? -progress
>>     ? -lco OVERWRITE=YES
>>     ? -dim XY
>>     *? -nlt PROMOTE_TO_MULTI*
>>     ? -f "PostgreSQL" PG:"host=localhost port=5432 user=***
>>     password=*** dbname=geodata"
>>     ? FREDSKOV.TAB
>>
>>     I would expect the table to change the PostGIS type to
>>     "MultiPolygon". However it still is registered as "Geometry".
>>
>>     Checking the table using SQL command:
>>
>>     SELECT ST_geometrytype(wkb_geometry), count(*) FROM mat.fredskov
>>     group by 1
>>
>>     affirms, that all geometries now is of type "ST_MultiPolygon".
>>
>>     AFAIK, this is a new behaviour. Or what ?
>>
>>     Postgres/Postgis version : 13.2,? 3.1
>>
>>     OGR2OGR version:? both 3.4 andf 3.6 dev.
>>
>>
>>
>>
>>     -- 
>>     Med venlig hilsen / Kind regards
>>
>>     Bo Victor Thomsen
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>> -- 
>> Richard W. Greenwood
>> www.greenwoodmap.com <http://www.greenwoodmap.com>
>>
>>
>> [Fichier texte:ATT00001]
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220801/1a645c1a/attachment.htm>

From hellik at web.de  Mon Aug  1 09:03:44 2022
From: hellik at web.de (Helmut Kudrnovsky)
Date: Mon, 1 Aug 2022 18:03:44 +0200
Subject: [gdal-dev] gdal_translate wmts.xml wmts.tif: 0ERROR 4:
 ./gdalwmscache\xyz: No such file or directory;
 ERROR 1: GDALWMS: Unable to open downloaded block.
Message-ID: <trinity-d6954c83-e23b-4596-b271-68174605473b-1659369824015@3c-app-webde-bs02>

Hi GDAL community,

I have an GDAL_WMTS XML file containing the information for:

<GDAL_WMTS><GetCapabilitiesUrl>https://www.basemap.at/wmts/1.0.0/WMTSCapabilities.xml</GetCapabilitiesUrl><Layer>bmaporthofoto30cm</Layer><Style>normal</Style><TileMatrixSet>google3857</TileMatrixSet><DataWindow><UpperLeftX>1071964</UpperLeftX><UpperLeftY>6000873</UpperLeftY><LowerRightX>1073445</LowerRightX><LowerRightY>5999385</LowerRightY></DataWindow><BandsCount>4</BandsCount><Cache /><UnsafeSSL>true</UnsafeSSL><ZeroBlockHttpCodes>204,404</ZeroBlockHttpCodes><ZeroBlockOnServerException>true</ZeroBlockOnServerException></GDAL_WMTS>

When I'm opening the xml file in QGIS, the correct tile defined above in the XML will be shown.

When I do

gdal_translate bmortho77.xml bmortho77.tif

then I get:

Input file size is 9921, 9968
0ERROR 4: ./gdalwmscache\eb9a2e93c079d3e8af23fb6be1373c11/8/9/89ffd475b3114e593c2e248e71685f10: No such file or directory
ERROR 1: GDALWMS: Unable to open downloaded block.
ERROR 4: ./gdalwmscache\eb9a2e93c079d3e8af23fb6be1373c11/a/9/a985525d6dc454a986ceecdeff22398b: No such file or directory
ERROR 1: GDALWMS: Unable to open downloaded block.
[...]

any idea?

thanks
Helmut

OSGeo charter member

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug  1 10:52:31 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 1 Aug 2022 17:52:31 +0000
Subject: [gdal-dev] gdal_translate wmts.xml wmts.tif: 0ERROR 4:
 ./gdalwmscache\xyz: No such file or directory;
 ERROR 1: GDALWMS: Unable to open downloaded block.
Message-ID: <AM0PR09MB32198699DF3AF1A0994EEE71FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

You will get error with QGIS as well if you zoom till level 20. You can see the requests that QGIS creates by opening the debug window with function key 12. Here is one that fails.
https://maps.wien.gv.at/basemap/bmaporthofoto30cm/normal/google3857/20/366500/566302.jpeg

Level 19 works
https://maps.wien.gv.at/basemap/bmaporthofoto30cm/normal/google3857/19/183249/283150.jpeg

They perhaps use also some load balancing system but using server address maps.wien.gv.at vs. maps1/wien.gv.at does not seem to make any difference. So the error seems to be due to error in GetCapabilities that claims that zoom level 20 is supported. You can get image data by selecting the zoom level manually with an open option "zoom_level".

gdal_translate bmortho77.xml bmortho77.tif -oo zoom_level=12 --debug on

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Helmut Kudrnovsky
L?hetetty: maanantai 1. elokuuta 2022 19.04
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] gdal_translate wmts.xml wmts.tif: 0ERROR 4: ./gdalwmscache\xyz: No such file or directory; ERROR 1: GDALWMS: Unable to open downloaded block.

Hi GDAL community,

I have an GDAL_WMTS XML file containing the information for:

<GDAL_WMTS><GetCapabilitiesUrl>https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.basemap.at%2Fwmts%2F1.0.0%2FWMTSCapabilities.xml&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C347da3139e62450e8ab008da73d82cdf%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C637949669584791800%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=792LjHXGRON13LHTJ8SR%2FVQZbyPegrlygXVRudCay4U%3D&amp;reserved=0</GetCapabilitiesUrl><Layer>bmaporthofoto30cm</Layer><Style>normal</Style><TileMatrixSet>google3857</TileMatrixSet><DataWindow><UpperLeftX>1071964</UpperLeftX><UpperLeftY>6000873</UpperLeftY><LowerRightX>1073445</LowerRightX><LowerRightY>5999385</LowerRightY></DataWindow><BandsCount>4</BandsCount><Cache /><UnsafeSSL>true</UnsafeSSL><ZeroBlockHttpCodes>204,404</ZeroBlockHttpCodes><ZeroBlockOnServerException>true</ZeroBlockOnServerException></GDAL_WMTS>

When I'm opening the xml file in QGIS, the correct tile defined above in the XML will be shown.

When I do

gdal_translate bmortho77.xml bmortho77.tif

then I get:

Input file size is 9921, 9968
0ERROR 4: ./gdalwmscache\eb9a2e93c079d3e8af23fb6be1373c11/8/9/89ffd475b3114e593c2e248e71685f10: No such file or directory ERROR 1: GDALWMS: Unable to open downloaded block.
ERROR 4: ./gdalwmscache\eb9a2e93c079d3e8af23fb6be1373c11/a/9/a985525d6dc454a986ceecdeff22398b: No such file or directory ERROR 1: GDALWMS: Unable to open downloaded block.
[...]

any idea?

thanks
Helmut

OSGeo charter member
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C347da3139e62450e8ab008da73d82cdf%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C637949669584791800%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=VnmFvyKKANGR9GN5ojHQS9LpzihNhe7COPyvC%2BoM%2BTw%3D&amp;reserved=0

From hellik at web.de  Mon Aug  1 13:30:03 2022
From: hellik at web.de (Helmut Kudrnovsky)
Date: Mon, 1 Aug 2022 22:30:03 +0200
Subject: [gdal-dev] gdal_translate wmts.xml wmts.tif: 0ERROR 4:
 ./gdalwmscache\xyz: No such file or directory;
 ERROR 1: GDALWMS: Unable to open downloaded block.
In-Reply-To: <AM0PR09MB32198699DF3AF1A0994EEE71FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB32198699DF3AF1A0994EEE71FD9A9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <trinity-75c60939-f354-43d8-8973-d083545e89fb-1659385803795@3c-app-webde-bs52>

Rahkonen Jukka:
?
>So the error seems to be due to error in GetCapabilities that claims that zoom level 20 is supported. You can get image data by selecting the zoom >level manually with an open option "zoom_level".

>gdal_translate bmortho77.xml bmortho77.tif -oo zoom_level=12 --debug on

thanks! that helped a lot!

kind regards
Helmut

OSGeo charter member
?



From nyall.dawson at gmail.com  Mon Aug  1 15:43:15 2022
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Tue, 2 Aug 2022 08:43:15 +1000
Subject: [gdal-dev] How to read a PGeo source file using GDAL 2.4
In-Reply-To: <CAHEdGZPqVX91HVCh97b8s5p_wDJUb2_yiK=cHqxakXka0c+2Dw@mail.gmail.com>
References: <CAHEdGZPqVX91HVCh97b8s5p_wDJUb2_yiK=cHqxakXka0c+2Dw@mail.gmail.com>
Message-ID: <CAB28AsjgKHVToEguAitfeF2PjMX6K+C6m0BSr2v3DBvCojvqfA@mail.gmail.com>

On Wed, 27 Jul 2022 at 23:36, andy <aborruso at gmail.com> wrote:
>
> Hi,
> I have compiled GDAL to enable PGeo, and now I have it in --formats.
>
> But if I run "ogrinfo PGeo:input.mdb", I have
>
> ERROR 1: PGeo: MDB Tools driver not found!
> Warning 1: Unable to install MDB driver for ODBC, MDB access may not supported.
> ERROR 1: Unable to initialize ODBC connection to DSN for input.mdb,
> ERROR 1: PGeo: MDB Tools driver not found!
> Warning 1: Unable to install MDB driver for ODBC, MDB access may not supported.
> ERROR 1: Unable to initialize ODBC connection to DSN for input.mdb
>

> How to solve this problem?

In all honesty, you'll be fighting an uphill battle trying to get pgeo
working nicely on older GDAL (and mdbtools) releases. There's been
*many( fixes to both libraries over the past 12 months to get things
working well, so you really want at least GDAL 3.4 and mdbtools 1.0.
(The good news is that with these versions everything should work
great, and even support modern GDAL functionality like field domains
and metadata (and in GDAL 3.6+, relationships)).

That said, you may have some luck if you try setting the environment
variable "OGR_SKIP=ODBC". That was required for a working mdbtools
driver on older GDAL releases.

Nyall

From seri.prashanti at gmail.com  Mon Aug  1 18:03:17 2022
From: seri.prashanti at gmail.com (prashanti seri)
Date: Tue, 2 Aug 2022 06:33:17 +0530
Subject: [gdal-dev] [Gdal-dev] unable to export Mapinfo text geom- style
 always symbol
In-Reply-To: <CAB05kczBHfy743qpz03rdGGhuDa_YQNKnPgUib=3Ujf6sYsmwg@mail.gmail.com>
References: <CAB05kczBHfy743qpz03rdGGhuDa_YQNKnPgUib=3Ujf6sYsmwg@mail.gmail.com>
Message-ID: <CAB05kcxseCWsdPswP4m66nhQ+_FTKyWTVyOu_V632S5dJ83DMA@mail.gmail.com>

> Hi all,
> We are exporting a "TextPointGeometry" type feature using GDAL MapInfo
> driver. Below is the pseudo code -
>
> Driver mapInfoFileDriver = Ogr.GetDriverByName("MapInfo File");
> ...
> Feature mapInfoFeature = CreateFeature(featureData[i].Geometry,
> mapInfolayer, featureData[i].SpatialRef);
>
> mapInfoFeature.SetStyleString($"LABEL(t:\"TT\",a: 0,c:#0000ff)");
>
>
> Result checked with ogrinfo, observed that style is always SYMBOL, see
> below -
>
>
> Style = SYMBOL(a:0,c:#000000,s:12pt,id:"mapinfo-sym-35,ogr-sym-10")
>
>
> Are we missing anything or any limitations?
>
>
> Regards,
> Prashanti
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220802/b250c68c/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug  1 23:08:59 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Tue, 2 Aug 2022 06:08:59 +0000
Subject: [gdal-dev] unable to export Mapinfo text geom- style always
 symbol
Message-ID: <AM0PR09MB321917B4BAF52361171298F9FD9D9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I can reproduce the issue with ogr2ogr and this csv file ?ogr_styletest.csv?:

wkt,OGR_STYLE
"POINT (1 3)","LABEL(t:""TT"",a: 0,c:#0000ff)"

Check what we have:
ogrinfo ogr_styletest.csv -al
OGRFeature(ogr_styletest):1
  wkt (String) = POINT (1 3)
  OGR_STYLE (String) = LABEL(t:"TT",a: 0,c:#0000ff)
  Style = LABEL(t:"TT",a: 0,c:#0000ff)
  POINT (1 3)

Convert into MapInfo MIF:
ogr2ogr -f "MapInfo File" ogr_styletest.mif ogr_styletest.csv

What we have now:
ogrinfo ogr_styletest.mif -al
OGRFeature(ogr_styletest):1
  wkt (String) = POINT (1 3)
  OGR_STYLE (String) = LABEL(t:"TT",a: 0,c:#0000ff)
  Style = SYMBOL(a:0,c:#000000,s:12pt,id:"mapinfo-sym-35,ogr-sym-9")
  POINT (1 3)

The LABEL style is changed into SYMBOL. Label is kept as label if ogr2ogr is set to write out for example OpenJUMP JML format (-f JML).

-Jukka Rahkonen-



L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta prashanti seri
L?hetetty: maanantai 1. elokuuta 2022 8.02
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] unable to export Mapinfo text geom- style always symbol


Team,
We are exporting a "TextPointGeometry" type feature using GDAL MapInfo driver. Below is the pseudo code -

Driver mapInfoFileDriver = Ogr.GetDriverByName("MapInfo File");
...
Feature mapInfoFeature = CreateFeature(featureData[i].Geometry, mapInfolayer, featureData[i].SpatialRef);

mapInfoFeature.SetStyleString($"LABEL(t:\"TT\",a: 0,c:#0000ff)");



Result checked with ogrinfo, observed that style is always SYMBOL, see below -



Style = SYMBOL(a:0,c:#000000,s:12pt,id:"mapinfo-sym-35,ogr-sym-10")



Are we missing anything or any limitations?

Regards,
Prashanti
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220802/802a1df0/attachment-0001.htm>

From mdsumner at gmail.com  Tue Aug  2 00:42:52 2022
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 2 Aug 2022 17:42:52 +1000
Subject: [gdal-dev] determine default SQL dialect
Message-ID: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>

Is it possible to determine the default SQL dialect  that will be used in
the C++ API?

It seems like the logic to pivot on dialect choice is only available to
drivers internally (they know if they have one), so a map of formats is
enough - but I wonder if I'm missing an API hook.

Also, there appears to be dialect values DEBUG, INDIRECT_SQLITE, MONGO_DB,
and ES in use but I gather they are for internal use (and so properly don't
appear in the documentation).

Thanks very much, Mike


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220802/e2852f82/attachment.htm>

From aborruso at gmail.com  Tue Aug  2 02:06:16 2022
From: aborruso at gmail.com (andy)
Date: Tue, 2 Aug 2022 11:06:16 +0200
Subject: [gdal-dev] How to read a PGeo source file using GDAL 2.4
In-Reply-To: <CAB28AsjgKHVToEguAitfeF2PjMX6K+C6m0BSr2v3DBvCojvqfA@mail.gmail.com>
References: <CAHEdGZPqVX91HVCh97b8s5p_wDJUb2_yiK=cHqxakXka0c+2Dw@mail.gmail.com>
 <CAB28AsjgKHVToEguAitfeF2PjMX6K+C6m0BSr2v3DBvCojvqfA@mail.gmail.com>
Message-ID: <CAHEdGZNW3G8pT+6wkQtKUBd+e8oFejOmnzmrw32CEdj-gzEcOg@mail.gmail.com>

Thank you Nyall.

On Tue, 2 Aug 2022 at 00:43, Nyall Dawson <nyall.dawson at gmail.com> wrote:

>
> That said, you may have some luck if you try setting the environment
> variable "OGR_SKIP=ODBC". That was required for a working mdbtools
> driver on older GDAL releases.
>

After running "export  OGR_SKIP=ODBC", and " ogrinfo PGeo:input.mdb" I have
always

ERROR 1: PGeo: MDB Tools driver not found!

Warning 1: Unable to install MDB driver for ODBC, MDB access may not
supported.

ERROR 1: Unable to initialize ODBC connection to DSN for input.mdb,

ERROR 1: PGeo: MDB Tools driver not found!

Warning 1: Unable to install MDB driver for ODBC, MDB access may not
supported.

ERROR 1: Unable to initialize ODBC connection to DSN for  input.mdb

Best regards


-- 
___________________

Andrea Borruso
website: https://medium.com/tantotanto
38? 7' 48" N, 13? 21' 9" E, EPSG:4326
___________________

"cercare e saper riconoscere chi e cosa,
 in mezzo all?inferno, non ? inferno,
e farlo durare, e dargli spazio"

Italo Calvino
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220802/1c3b4f7e/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Aug  2 02:27:51 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Tue, 2 Aug 2022 09:27:51 +0000
Subject: [gdal-dev] determine default SQL dialect
Message-ID: <AM0PR09MB3219F1F51B4F0BD1EC942439FD9D9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

About INDIRECT_SQLITE dialect, it is documented in https://gdal.org/user/sql_sqlite_dialect.html
?If the datasource is SQLite database (GeoPackage, SpatiaLite) then SQLite dialect acts as native SQL dialect and Virtual Table Mechanism is not used. It is possible to force GDAL to use Virtual Tables even in this case by specifying ?-dialect INDIRECT_SQLITE?. This should be used only when necessary, since going through the virtual table mechanism might affect performance.?
There is also an usage example for one special use case.

ES is documented in https://gdal.org/drivers/vector/elasticsearch.html.
MONGO_DB is documented in https://gdal.org/drivers/vector/mongodbv3.html.

-Jukka Rahkonen-


L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Michael Sumner
L?hetetty: tiistai 2. elokuuta 2022 10.43
Vastaanottaja: gdal-dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] determine default SQL dialect

Is it possible to determine the default SQL dialect  that will be used in the C++ API?

It seems like the logic to pivot on dialect choice is only available to drivers internally (they know if they have one), so a map of formats is enough - but I wonder if I'm missing an API hook.

Also, there appears to be dialect values DEBUG, INDIRECT_SQLITE, MONGO_DB, and ES in use but I gather they are for internal use (and so properly don't appear in the documentation).

Thanks very much, Mike


--
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com<mailto:mdsumner at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220802/fe64a175/attachment.htm>

From even.rouault at spatialys.com  Tue Aug  2 09:25:22 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Aug 2022 18:25:22 +0200
Subject: [gdal-dev] determine default SQL dialect
In-Reply-To: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>
References: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>
Message-ID: <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>


Le 02/08/2022 ? 09:42, Michael Sumner a ?crit?:
> Is it possible to determine the default SQL dialect? that will be used 
> in the C++ API?

Short answer: no

Long answer: for a driver that is backed by a SQL engine (SQLite, GPKG, 
PG, MySQL, OCI, etc.), it will default to the RDBMS SQL engine, 
otherwise to OGR SQL.

>
> It seems like the logic to pivot on dialect choice is only available 
> to drivers internally (they know if they have one), so a map of 
> formats is enough - but I wonder if I'm missing an API hook.
>
> Also, there appears to be dialect values DEBUG,?INDIRECT_SQLITE, 
> MONGO_DB, and ES in use but I gather they are for internal use (and so 
> properly don't appear in the documentation).

DEBUG is clearly for internal use (autotest). INDIRECT_SQLITE is 
documented at 
https://gdal.org/user/sql_sqlite_dialect.html?highlight=indirect_sqlite. 
The others are documented in the respective documentation driver pages

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Aug  2 09:26:14 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Aug 2022 18:26:14 +0200
Subject: [gdal-dev] unable to export Mapinfo text geom- style always
 symbol
In-Reply-To: <CAB05kczBHfy743qpz03rdGGhuDa_YQNKnPgUib=3Ujf6sYsmwg@mail.gmail.com>
References: <CAB05kczBHfy743qpz03rdGGhuDa_YQNKnPgUib=3Ujf6sYsmwg@mail.gmail.com>
Message-ID: <a50d379e-cbf4-b2cb-6b4f-89d86178a5e6@spatialys.com>

For reference this was also filed as 
https://github.com/OSGeo/gdal/issues/6149

Implementation pull request: https://github.com/OSGeo/gdal/pull/6152

Le 01/08/2022 ? 07:01, prashanti seri a ?crit?:
>
> Team,
> We are exporting a "TextPointGeometry" type feature using GDAL MapInfo 
> driver. Below is the pseudo code -
>
> Driver mapInfoFileDriver = Ogr.GetDriverByName("MapInfo File");
> ...
> Feature mapInfoFeature = CreateFeature(featureData[i].Geometry, 
> mapInfolayer, featureData[i].SpatialRef);
>
> mapInfoFeature.SetStyleString($"LABEL(t:\"TT\",a: 0,c:#0000ff)");
>
>
> Result checked with ogrinfo, observed that style is always SYMBOL, see 
> below -
>
>
> Style = SYMBOL(a:0,c:#000000,s:12pt,id:"mapinfo-sym-35,ogr-sym-10")
>
>
> Are we missing anything or any limitations?
>
>
> Regards,
> Prashanti
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Aug  2 09:30:30 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Aug 2022 18:30:30 +0200
Subject: [gdal-dev] determine default SQL dialect
In-Reply-To: <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>
References: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>
 <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>
Message-ID: <53ae2ad9-88eb-e830-782e-c2c22ac9988a@spatialys.com>


Le 02/08/2022 ? 18:25, Even Rouault a ?crit?:
>
> Le 02/08/2022 ? 09:42, Michael Sumner a ?crit?:
>> Is it possible to determine the default SQL dialect? that will be 
>> used in the C++ API?
>
> Short answer: no
>
> Long answer: for a driver that is backed by a SQL engine (SQLite, 
> GPKG, PG, MySQL, OCI, etc.), it will default to the RDBMS SQL engine, 
> otherwise to OGR SQL.

Potential not so pretty way of knowing if the default SQL dialect is OGR 
SQL:

run ExecuteSQL( "SELECT OGR_GEOM_WKT FROM {some_layer_name}" )

if that works, then at 99.99% , you have OGR SQL.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mdsumner at gmail.com  Tue Aug  2 12:32:38 2022
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 3 Aug 2022 05:32:38 +1000
Subject: [gdal-dev] determine default SQL dialect
In-Reply-To: <53ae2ad9-88eb-e830-782e-c2c22ac9988a@spatialys.com>
References: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>
 <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>
 <53ae2ad9-88eb-e830-782e-c2c22ac9988a@spatialys.com>
Message-ID: <CAAcGz9_fyY7X8pfcumxW7r_ZSmGiZJua88iCKnXLt5D3PRY-yQ@mail.gmail.com>

Excellent, thanks very much.

Best, Mike

On Wed, 3 Aug 2022, 02:30 Even Rouault, <even.rouault at spatialys.com> wrote:

>
> Le 02/08/2022 ? 18:25, Even Rouault a ?crit :
> >
> > Le 02/08/2022 ? 09:42, Michael Sumner a ?crit :
> >> Is it possible to determine the default SQL dialect  that will be
> >> used in the C++ API?
> >
> > Short answer: no
> >
> > Long answer: for a driver that is backed by a SQL engine (SQLite,
> > GPKG, PG, MySQL, OCI, etc.), it will default to the RDBMS SQL engine,
> > otherwise to OGR SQL.
>
> Potential not so pretty way of knowing if the default SQL dialect is OGR
> SQL:
>
> run ExecuteSQL( "SELECT OGR_GEOM_WKT FROM {some_layer_name}" )
>
> if that works, then at 99.99% , you have OGR SQL.
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220803/e320b2ce/attachment.htm>

From mdsumner at gmail.com  Tue Aug  2 16:11:35 2022
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 3 Aug 2022 09:11:35 +1000
Subject: [gdal-dev] determine default SQL dialect
In-Reply-To: <AM0PR09MB3219F1F51B4F0BD1EC942439FD9D9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB3219F1F51B4F0BD1EC942439FD9D9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <CAAcGz9-Ab9Xz6UJCKqDTA+TJLRdRjTNpV2go-WL3Nth93cwnTg@mail.gmail.com>

very helpful, thank you very much.  Quite a bit more to it than I thought.

Best, Mike



On Tue, Aug 2, 2022 at 7:27 PM Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
>
>
> About INDIRECT_SQLITE dialect, it is documented in
> https://gdal.org/user/sql_sqlite_dialect.html
>
> ?If the datasource is SQLite database (GeoPackage, SpatiaLite) then SQLite
> dialect acts as native SQL dialect and Virtual Table Mechanism is not used.
> It is possible to force GDAL to use Virtual Tables even in this case by
> specifying ?-dialect INDIRECT_SQLITE?. This should be used only when
> necessary, since going through the virtual table mechanism might affect
> performance.?
>
> There is also an usage example for one special use case.
>
>
>
> ES is documented in https://gdal.org/drivers/vector/elasticsearch.html.
>
> MONGO_DB is documented in https://gdal.org/drivers/vector/mongodbv3.html.
>
>
>
> -Jukka Rahkonen-
>
>
>
> *L?hett?j?:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *Puolesta *Michael
> Sumner
> *L?hetetty:* tiistai 2. elokuuta 2022 10.43
> *Vastaanottaja:* gdal-dev <gdal-dev at lists.osgeo.org>
> *Aihe:* [gdal-dev] determine default SQL dialect
>
>
>
> Is it possible to determine the default SQL dialect  that will be used in
> the C++ API?
>
>
>
> It seems like the logic to pivot on dialect choice is only available to
> drivers internally (they know if they have one), so a map of formats is
> enough - but I wonder if I'm missing an API hook.
>
>
>
> Also, there appears to be dialect values DEBUG, INDIRECT_SQLITE, MONGO_DB,
> and ES in use but I gather they are for internal use (and so properly don't
> appear in the documentation).
>
>
>
> Thanks very much, Mike
>
>
>
>
> --
>
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220803/0c9642cd/attachment.htm>

From nyall.dawson at gmail.com  Tue Aug  2 20:35:40 2022
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Wed, 3 Aug 2022 13:35:40 +1000
Subject: [gdal-dev] determine default SQL dialect
In-Reply-To: <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>
References: <CAAcGz9-kb0H5nEb_Zfd5S7nSX8uJSZfuVxH35usP1_41zgXQJw@mail.gmail.com>
 <9d2f681a-3def-f67e-5135-2c3cc816e274@spatialys.com>
Message-ID: <CAB28AshXmHPgSEp5=nVaO35VHGvoyYpMiW0Ee8QHg7UkkgeKcA@mail.gmail.com>

On Wed, 3 Aug 2022 at 02:25, Even Rouault <even.rouault at spatialys.com> wrote:
>
>
> Le 02/08/2022 ? 09:42, Michael Sumner a ?crit :
> > Is it possible to determine the default SQL dialect  that will be used
> > in the C++ API?
>
> Short answer: no
>
> Long answer: for a driver that is backed by a SQL engine (SQLite, GPKG,
> PG, MySQL, OCI, etc.), it will default to the RDBMS SQL engine,
> otherwise to OGR SQL.

Related PR here: https://github.com/OSGeo/gdal/pull/6154, adding a new
GDAL_DMD_SUPPORTED_SQL_DIALECTS driver metadata string.

Feedback is welcome!

Nyall

>
> >
> > It seems like the logic to pivot on dialect choice is only available
> > to drivers internally (they know if they have one), so a map of
> > formats is enough - but I wonder if I'm missing an API hook.
> >
> > Also, there appears to be dialect values DEBUG, INDIRECT_SQLITE,
> > MONGO_DB, and ES in use but I gather they are for internal use (and so
> > properly don't appear in the documentation).
>
> DEBUG is clearly for internal use (autotest). INDIRECT_SQLITE is
> documented at
> https://gdal.org/user/sql_sqlite_dialect.html?highlight=indirect_sqlite.
> The others are documented in the respective documentation driver pages
>
> Even
>
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From seri.prashanti at gmail.com  Tue Aug  2 21:19:50 2022
From: seri.prashanti at gmail.com (prashanti seri)
Date: Wed, 3 Aug 2022 09:49:50 +0530
Subject: [gdal-dev] unable to export Mapinfo text geom- style always
 symbol
In-Reply-To: <a50d379e-cbf4-b2cb-6b4f-89d86178a5e6@spatialys.com>
References: <CAB05kczBHfy743qpz03rdGGhuDa_YQNKnPgUib=3Ujf6sYsmwg@mail.gmail.com>
 <a50d379e-cbf4-b2cb-6b4f-89d86178a5e6@spatialys.com>
Message-ID: <CAB05kcx4Kbx7KmM_VacmtD08ikKG6LVnE9Etd9yLCnJvFboLiA@mail.gmail.com>

Thanks for the information and quick fix.

On Tue, Aug 2, 2022 at 9:56 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> For reference this was also filed as
> https://github.com/OSGeo/gdal/issues/6149
>
> Implementation pull request: https://github.com/OSGeo/gdal/pull/6152
>
> Le 01/08/2022 ? 07:01, prashanti seri a ?crit :
> >
> > Team,
> > We are exporting a "TextPointGeometry" type feature using GDAL MapInfo
> > driver. Below is the pseudo code -
> >
> > Driver mapInfoFileDriver = Ogr.GetDriverByName("MapInfo File");
> > ...
> > Feature mapInfoFeature = CreateFeature(featureData[i].Geometry,
> > mapInfolayer, featureData[i].SpatialRef);
> >
> > mapInfoFeature.SetStyleString($"LABEL(t:\"TT\",a: 0,c:#0000ff)");
> >
> >
> > Result checked with ogrinfo, observed that style is always SYMBOL, see
> > below -
> >
> >
> > Style = SYMBOL(a:0,c:#000000,s:12pt,id:"mapinfo-sym-35,ogr-sym-10")
> >
> >
> > Are we missing anything or any limitations?
> >
> >
> > Regards,
> > Prashanti
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220803/13ca1cc3/attachment.htm>

From rykovd at gmail.com  Fri Aug  5 07:44:59 2022
From: rykovd at gmail.com (Denis Rykov)
Date: Fri, 5 Aug 2022 16:44:59 +0200
Subject: [gdal-dev] gdal.Warp behaves differently comparing to gdalwarp
Message-ID: <CAJbvKNq_p6X+a6xLV4GzLXAwEw_=AXgH_VwQi9ZHZhLWqQ2-hw@mail.gmail.com>

Hi,

I would expect these 2 ways of running GDAL warp should produce the same
results.

gdalwarp -t_srs EPSG:3857 \
         -te 558728 5789851 1242296 7544030 \
         -ts 500 500 \
         "WMS:
http://127.0.0.1:8080/api/resource/5840/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=test_rounds&SRS=EPSG:4326&BBOX=-180.000000,-85.051129,180.000000,85.051129"
\
         /tmp/result1.tif

and

from osgeo import gdal
from osgeo import gdalconst

width = height = 500
url = "WMS:
http://127.0.0.1:8080/api/resource/5840/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=test_rounds&SRS=EPSG:4326&BBOX=-180.000000,-85.051129,180.000000,85.051129
"
ds = gdal.Open(url, gdalconst.GA_ReadOnly)
ds_img = gdal.Warp(
    "/tmp/result2.tif",
    ds,
    options=gdal.WarpOptions(
        width=width,
        height=height,
        outputBounds=(558728, 5789851, 1242296, 7544030),
        dstSRS="EPSG:3857",
    ),
)

But in the first case I get what I expect but in the second one I get a
raster with right spatial extent but 0 in all bands.

What am I missing?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220805/6d9fb309/attachment.htm>

From rykovd at gmail.com  Fri Aug  5 07:57:28 2022
From: rykovd at gmail.com (Denis Rykov)
Date: Fri, 5 Aug 2022 16:57:28 +0200
Subject: [gdal-dev] gdal.Warp behaves differently comparing to gdalwarp
In-Reply-To: <CAJbvKNq_p6X+a6xLV4GzLXAwEw_=AXgH_VwQi9ZHZhLWqQ2-hw@mail.gmail.com>
References: <CAJbvKNq_p6X+a6xLV4GzLXAwEw_=AXgH_VwQi9ZHZhLWqQ2-hw@mail.gmail.com>
Message-ID: <CAJbvKNr0h2UHnuiSy3F5DgboFF-8azPPJgymJQQYBT7QisfiKQ@mail.gmail.com>

ds_img.FlushCache() did the trick!

On Fri, Aug 5, 2022 at 4:44 PM Denis Rykov <rykovd at gmail.com> wrote:

> Hi,
>
> I would expect these 2 ways of running GDAL warp should produce the same
> results.
>
> gdalwarp -t_srs EPSG:3857 \
>          -te 558728 5789851 1242296 7544030 \
>          -ts 500 500 \
>          "WMS:
> http://127.0.0.1:8080/api/resource/5840/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=test_rounds&SRS=EPSG:4326&BBOX=-180.000000,-85.051129,180.000000,85.051129"
> \
>          /tmp/result1.tif
>
> and
>
> from osgeo import gdal
> from osgeo import gdalconst
>
> width = height = 500
> url = "WMS:
> http://127.0.0.1:8080/api/resource/5840/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=test_rounds&SRS=EPSG:4326&BBOX=-180.000000,-85.051129,180.000000,85.051129
> "
> ds = gdal.Open(url, gdalconst.GA_ReadOnly)
> ds_img = gdal.Warp(
>     "/tmp/result2.tif",
>     ds,
>     options=gdal.WarpOptions(
>         width=width,
>         height=height,
>         outputBounds=(558728, 5789851, 1242296, 7544030),
>         dstSRS="EPSG:3857",
>     ),
> )
>
> But in the first case I get what I expect but in the second one I get a
> raster with right spatial extent but 0 in all bands.
>
> What am I missing?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220805/f910da3f/attachment.htm>

From oreilly at mbari.org  Mon Aug  8 11:32:47 2022
From: oreilly at mbari.org (Tom O'Reilly)
Date: Mon, 8 Aug 2022 11:32:47 -0700 (PDT)
Subject: [gdal-dev] gdal_translate drops XMP exif tags
Message-ID: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>

gdal_translate output .tif file does not contain XMP tags that were present in the input .jpg file. 
The output file contains many of the input EXIF tags, aggregated as the GDALMetadata tag, but not the XMP tags. 
Why does gdal_translate remove XMP tags - is there an option to preserve them? 

Thanks 
Tom 
-------------------------------------------------- 
Thomas C. O'Reilly 
Monterey Bay Aquarium Research Institute 
7700 Sandholdt Road 
Moss Landing, California 95039-9644 
831-775-1766 (voice) 
831-775-1620 (FAX) 
oreilly at mbari.org (email) 
http://www.mbari.org (World-wide Web) 

"The machine does not isolate us from the great mysteries 
of nature, but plunges us more deeply into them." 

- ANTOINE DE SAINT-EXUPERY 
"Wind, Sand, and Stars" (1939) 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220808/4ce4f3e7/attachment.htm>

From j1 at jimenezshaw.com  Mon Aug  8 12:03:39 2022
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 8 Aug 2022 21:03:39 +0200
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
Message-ID: <CADRrdKtxOuJPWOyvh4O0+tybkbm0ePdSVb3BzbqT_0WFTHruNA@mail.gmail.com>

Which version of GDAL are you using?
in https://gdal.org/programs/gdal_translate.html there is an option,
"-noxmp", since GDAL 3.2. Without that option it should keep them. If I
remember correctly, the XMP tags are copied as proper XMP, not as
GDALMetadata, with TIFF files.

An example with "gdalinfo -mdd all" for input and output may help.
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Mon, 8 Aug 2022 at 20:32, Tom O'Reilly <oreilly at mbari.org> wrote:

> gdal_translate output .tif file does not contain XMP tags that were
> present in the input .jpg file.
> The output file contains many of the input EXIF tags, aggregated as the
> GDALMetadata tag, but not the XMP tags.
> Why does gdal_translate remove XMP tags - is there an option to preserve
> them?
>
> Thanks
> Tom
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>
> "The machine does not isolate us from the great mysteries
>  of nature, but plunges us more deeply into them."
>
>    - ANTOINE DE SAINT-EXUPERY
>      "Wind, Sand, and Stars" (1939)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220808/b01af038/attachment.htm>

From even.rouault at spatialys.com  Mon Aug  8 12:13:03 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 8 Aug 2022 21:13:03 +0200
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
Message-ID: <a8c3ef58-e1a9-883a-1cdd-78a80929486c@spatialys.com>

Tom,

It would be interesting if you could provide an image how to reproduce that

With the sample file from the autotest suite, I can't reproduce that:

$ gdal_translate ../autotest/gdrivers/data/jpeg/byte_with_xmp.jpg out.tif

$ gdalinfo out.tif -mdd all

Driver: GTiff/GeoTIFF
Files: out.tif
Size is 1, 1
Metadata (xml:XMP):
<?xpacket begin='?' id='W5M0MpCehiHzreSzNTczkc9d'?>
<x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 7.89'>
<rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>

 ?<rdf:Description rdf:about=''
 ? xmlns:dc='http://purl.org/dc/elements/1.1/'>
 ? <dc:description>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Description</rdf:li>
 ?? </rdf:Alt>
 ? </dc:description>
 ? <dc:subject>
 ?? <rdf:Bag>
 ??? <rdf:li>XMP</rdf:li>
 ??? <rdf:li>Test</rdf:li>
 ?? </rdf:Bag>
 ? </dc:subject>
 ? <dc:title>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Title</rdf:li>
 ?? </rdf:Alt>
 ? </dc:title>
 ?</rdf:Description>

 ?<rdf:Description rdf:about=''
 ? xmlns:tiff='http://ns.adobe.com/tiff/1.0/'>
 ? <tiff:BitsPerSample>
 ?? <rdf:Seq>
 ??? <rdf:li>8</rdf:li>
 ?? </rdf:Seq>
 ? </tiff:BitsPerSample>
 ? <tiff:Compression>1</tiff:Compression>
 ? <tiff:ImageLength>20</tiff:ImageLength>
 ? <tiff:ImageWidth>20</tiff:ImageWidth>
<tiff:PhotometricInterpretation>1</tiff:PhotometricInterpretation>
<tiff:PlanarConfiguration>1</tiff:PlanarConfiguration>
 ? <tiff:SamplesPerPixel>1</tiff:SamplesPerPixel>
 ?</rdf:Description>
</rdf:RDF>
</x:xmpmeta>
























<?xpacket end='w'?>
Metadata (DERIVED_SUBDATASETS):
DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:LOGAMPLITUDE:out.tif
 ? DERIVED_SUBDATASET_1_DESC=log10 of amplitude of input bands from out.tif
Image Structure Metadata:
 ? INTERLEAVE=BAND
Corner Coordinates:
Upper Left? (??? 0.0,??? 0.0)
Lower Left? (??? 0.0,??? 1.0)
Upper Right (??? 1.0,??? 0.0)
Lower Right (??? 1.0,??? 1.0)
Center????? (??? 0.5,??? 0.5)
Band 1 Block=1x1 Type=Byte, ColorInterp=Gray

Le 08/08/2022 ? 20:32, Tom O'Reilly a ?crit?:
> gdal_translate output .tif file does not contain XMP tags that were 
> present in the input .jpg file.
> The output file contains many of the input EXIF tags, aggregated as 
> the GDALMetadata tag, but not the XMP tags.
> Why does gdal_translate remove XMP tags - is there an option to 
> preserve them?
>
> Thanks
> Tom
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>
> "The machine does not isolate us from the great mysteries
> ?of nature, but plunges us more deeply into them."
>
> ?? - ANTOINE DE SAINT-EXUPERY
> ?? ? "Wind, Sand, and Stars" (1939)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From oreilly at mbari.org  Mon Aug  8 13:13:39 2022
From: oreilly at mbari.org (Tom O'Reilly)
Date: Mon, 8 Aug 2022 13:13:39 -0700 (PDT)
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <a8c3ef58-e1a9-883a-1cdd-78a80929486c@spatialys.com>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
 <a8c3ef58-e1a9-883a-1cdd-78a80929486c@spatialys.com>
Message-ID: <304125643.4206595.1659989619174.JavaMail.zimbra@mbari.org>

Hi Evan,

I was mistaken in which gdal program drops the XMP tags.
gdal_translate actually transfers the XMP tags properly from the input jpg file to tif output.  But a subsequent gdalwarp on that tif does not pass the XMP tags to its output.

So the sequence is, for example:

step 1: Convert jpg to geotiff, using specified gcps
gdal_translate -gcp 7952 0 -121.7912 36.8015 -gcp 7952 5304 -121.7910 36.8012 -gcp 0 5304 -121.7915 36.8010 -gcp 0 0 -121.7917 36.8013  -of GTiff  -co COMPRESS=DEFLATE -a_srs EPSG:4326 DSC01221.JPG test.tif

step 2: Warp the geotiff 
gdalwarp -t_srs EPSG:4326 -of GTiff -dstalpha test.tif testwarp.tif


The geotiff produced by step 1 contains the XMP tags as expected.
But the warped geotiff produced by step 2 does not contain any XMP tags.

How best to provide a test jpg? The ones I have are all 20+ MBytes.

Thanks
Tom

--------------------------------------------------
Thomas C. O'Reilly
Monterey Bay Aquarium Research Institute
7700 Sandholdt Road
Moss Landing, California 95039-9644
831-775-1766 (voice)
831-775-1620 (FAX)
oreilly at mbari.org (email)
http://www.mbari.org (World-wide Web)
 
"The machine does not isolate us from the great mysteries
 of nature, but plunges us more deeply into them."
 
   - ANTOINE DE SAINT-EXUPERY
     "Wind, Sand, and Stars" (1939)

----- Original Message -----
From: "Even Rouault" <even.rouault at spatialys.com>
To: "Tom O'Reilly" <oreilly at mbari.org>, "gdal-dev" <gdal-dev at lists.osgeo.org>
Sent: Monday, August 8, 2022 12:13:03 PM
Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags

Tom,

It would be interesting if you could provide an image how to reproduce that

With the sample file from the autotest suite, I can't reproduce that:

$ gdal_translate ../autotest/gdrivers/data/jpeg/byte_with_xmp.jpg out.tif

$ gdalinfo out.tif -mdd all

Driver: GTiff/GeoTIFF
Files: out.tif
Size is 1, 1
Metadata (xml:XMP):
<?xpacket begin='?' id='W5M0MpCehiHzreSzNTczkc9d'?>
<x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 7.89'>
<rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>

 ?<rdf:Description rdf:about=''
 ? xmlns:dc='http://purl.org/dc/elements/1.1/'>
 ? <dc:description>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Description</rdf:li>
 ?? </rdf:Alt>
 ? </dc:description>
 ? <dc:subject>
 ?? <rdf:Bag>
 ??? <rdf:li>XMP</rdf:li>
 ??? <rdf:li>Test</rdf:li>
 ?? </rdf:Bag>
 ? </dc:subject>
 ? <dc:title>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Title</rdf:li>
 ?? </rdf:Alt>
 ? </dc:title>
 ?</rdf:Description>

 ?<rdf:Description rdf:about=''
 ? xmlns:tiff='http://ns.adobe.com/tiff/1.0/'>
 ? <tiff:BitsPerSample>
 ?? <rdf:Seq>
 ??? <rdf:li>8</rdf:li>
 ?? </rdf:Seq>
 ? </tiff:BitsPerSample>
 ? <tiff:Compression>1</tiff:Compression>
 ? <tiff:ImageLength>20</tiff:ImageLength>
 ? <tiff:ImageWidth>20</tiff:ImageWidth>
<tiff:PhotometricInterpretation>1</tiff:PhotometricInterpretation>
<tiff:PlanarConfiguration>1</tiff:PlanarConfiguration>
 ? <tiff:SamplesPerPixel>1</tiff:SamplesPerPixel>
 ?</rdf:Description>
</rdf:RDF>
</x:xmpmeta>
























<?xpacket end='w'?>
Metadata (DERIVED_SUBDATASETS):
DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:LOGAMPLITUDE:out.tif
 ? DERIVED_SUBDATASET_1_DESC=log10 of amplitude of input bands from out.tif
Image Structure Metadata:
 ? INTERLEAVE=BAND
Corner Coordinates:
Upper Left? (??? 0.0,??? 0.0)
Lower Left? (??? 0.0,??? 1.0)
Upper Right (??? 1.0,??? 0.0)
Lower Right (??? 1.0,??? 1.0)
Center????? (??? 0.5,??? 0.5)
Band 1 Block=1x1 Type=Byte, ColorInterp=Gray

Le 08/08/2022 ? 20:32, Tom O'Reilly a ?crit?:
> gdal_translate output .tif file does not contain XMP tags that were 
> present in the input .jpg file.
> The output file contains many of the input EXIF tags, aggregated as 
> the GDALMetadata tag, but not the XMP tags.
> Why does gdal_translate remove XMP tags - is there an option to 
> preserve them?
>
> Thanks
> Tom
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>
> "The machine does not isolate us from the great mysteries
> ?of nature, but plunges us more deeply into them."
>
> ?? - ANTOINE DE SAINT-EXUPERY
> ?? ? "Wind, Sand, and Stars" (1939)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not


From oreilly at mbari.org  Mon Aug  8 13:16:14 2022
From: oreilly at mbari.org (Tom O'Reilly)
Date: Mon, 8 Aug 2022 13:16:14 -0700 (PDT)
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <CADRrdKtxOuJPWOyvh4O0+tybkbm0ePdSVb3BzbqT_0WFTHruNA@mail.gmail.com>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
 <CADRrdKtxOuJPWOyvh4O0+tybkbm0ePdSVb3BzbqT_0WFTHruNA@mail.gmail.com>
Message-ID: <245152852.4207751.1659989774369.JavaMail.zimbra@mbari.org>

Hi Javier, 

As noted in my previous response, I was wrong about gdal_translate - it actually does transfer the XMP tags from the input to the output, as XMP tags. 
It is a subsequent call to gdalwarp that drops the XMP tags. 
I am running gdal 3.5.0 

Thanks 
Tom 
-------------------------------------------------- 
Thomas C. O'Reilly 
Monterey Bay Aquarium Research Institute 
7700 Sandholdt Road 
Moss Landing, California 95039-9644 
831-775-1766 (voice) 
831-775-1620 (FAX) 
oreilly at mbari.org (email) 
http://www.mbari.org (World-wide Web) 

"The machine does not isolate us from the great mysteries 
of nature, but plunges us more deeply into them." 

- ANTOINE DE SAINT-EXUPERY 
"Wind, Sand, and Stars" (1939) 


From: "Javier Jimenez Shaw" <j1 at jimenezshaw.com> 
To: "Tom O'Reilly" <oreilly at mbari.org> 
Cc: "gdal-dev" <gdal-dev at lists.osgeo.org> 
Sent: Monday, August 8, 2022 12:03:39 PM 
Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags 

Which version of GDAL are you using? 
in [ https://gdal.org/programs/gdal_translate.html | https://gdal.org/programs/gdal_translate.html ] there is an option, "-noxmp", since GDAL 3.2. Without that option it should keep them. If I remember correctly, the XMP tags are copied as proper XMP, not as GDALMetadata, with TIFF files. 

An example with "gdalinfo -mdd all" for input and output may help. 
.___ ._ ..._ .. . ._. .___ .. __ . _. . __.. ... .... ._ .__ 
Entre dos pensamientos racionales 
hay infinitos pensamientos irracionales. 



On Mon, 8 Aug 2022 at 20:32, Tom O'Reilly < [ mailto:oreilly at mbari.org | oreilly at mbari.org ] > wrote: 



gdal_translate output .tif file does not contain XMP tags that were present in the input .jpg file. 
The output file contains many of the input EXIF tags, aggregated as the GDALMetadata tag, but not the XMP tags. 
Why does gdal_translate remove XMP tags - is there an option to preserve them? 

Thanks 
Tom 
-------------------------------------------------- 
Thomas C. O'Reilly 
Monterey Bay Aquarium Research Institute 
7700 Sandholdt Road 
Moss Landing, California 95039-9644 
831-775-1766 (voice) 
831-775-1620 (FAX) 
[ mailto:oreilly at mbari.org | oreilly at mbari.org ] (email) 
[ http://www.mbari.org/ | http://www.mbari.org ] (World-wide Web) 

"The machine does not isolate us from the great mysteries 
of nature, but plunges us more deeply into them." 

- ANTOINE DE SAINT-EXUPERY 
"Wind, Sand, and Stars" (1939) 
_______________________________________________ 
gdal-dev mailing list 
[ mailto:gdal-dev at lists.osgeo.org | gdal-dev at lists.osgeo.org ] 
[ https://lists.osgeo.org/mailman/listinfo/gdal-dev | https://lists.osgeo.org/mailman/listinfo/gdal-dev ] 




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220808/dfbf773c/attachment-0001.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Aug  8 13:17:26 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 8 Aug 2022 20:17:26 +0000
Subject: [gdal-dev] gdal_translate drops XMP exif tags
Message-ID: <AM0PR09MB32198CFF080DA7CC4C41523BFD639@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

If gdal_translate keeps the tags you should be able to create a small test file by reducing the size with -outsize.

-Jukka Rahkonen-



-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Tom O'Reilly
L?hetetty: maanantai 8. elokuuta 2022 23.14
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>
Kopio: gdal-dev <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] gdal_translate drops XMP exif tags

Hi Evan,

I was mistaken in which gdal program drops the XMP tags.
gdal_translate actually transfers the XMP tags properly from the input jpg file to tif output.  But a subsequent gdalwarp on that tif does not pass the XMP tags to its output.

So the sequence is, for example:

step 1: Convert jpg to geotiff, using specified gcps gdal_translate -gcp 7952 0 -121.7912 36.8015 -gcp 7952 5304 -121.7910 36.8012 -gcp 0 5304 -121.7915 36.8010 -gcp 0 0 -121.7917 36.8013  -of GTiff  -co COMPRESS=DEFLATE -a_srs EPSG:4326 DSC01221.JPG test.tif

step 2: Warp the geotiff
gdalwarp -t_srs EPSG:4326 -of GTiff -dstalpha test.tif testwarp.tif


The geotiff produced by step 1 contains the XMP tags as expected.
But the warped geotiff produced by step 2 does not contain any XMP tags.

How best to provide a test jpg? The ones I have are all 20+ MBytes.

Thanks
Tom

--------------------------------------------------
Thomas C. O'Reilly
Monterey Bay Aquarium Research Institute
7700 Sandholdt Road
Moss Landing, California 95039-9644
831-775-1766 (voice)
831-775-1620 (FAX)
oreilly at mbari.org (email)
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.mbari.org%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=KKLklE5oY8xr8uuILSsV32YGgD9NPoghdD%2BQ9uxdIjY%3D&amp;reserved=0 (World-wide Web)
 
"The machine does not isolate us from the great mysteries
 of nature, but plunges us more deeply into them."
 
   - ANTOINE DE SAINT-EXUPERY
     "Wind, Sand, and Stars" (1939)

----- Original Message -----
From: "Even Rouault" <even.rouault at spatialys.com>
To: "Tom O'Reilly" <oreilly at mbari.org>, "gdal-dev" <gdal-dev at lists.osgeo.org>
Sent: Monday, August 8, 2022 12:13:03 PM
Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags

Tom,

It would be interesting if you could provide an image how to reproduce that

With the sample file from the autotest suite, I can't reproduce that:

$ gdal_translate ../autotest/gdrivers/data/jpeg/byte_with_xmp.jpg out.tif

$ gdalinfo out.tif -mdd all

Driver: GTiff/GeoTIFF
Files: out.tif
Size is 1, 1
Metadata (xml:XMP):
<?xpacket begin='?' id='W5M0MpCehiHzreSzNTczkc9d'?>
<x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 7.89'>
<rdf:RDF xmlns:rdf='https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=D8SUyL%2BKKVW8Ujx7GKclIcLZ4ru%2BM%2BnpbKkQ8O%2BtL28%3D&amp;reserved=0'>

 ?<rdf:Description rdf:about=''
 ? xmlns:dc='https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=j2rNZAD9uKn588r5dnI5y3jNk8VxYVgpNwbmiE6uLWs%3D&amp;reserved=0'>
 ? <dc:description>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Description</rdf:li>
 ?? </rdf:Alt>
 ? </dc:description>
 ? <dc:subject>
 ?? <rdf:Bag>
 ??? <rdf:li>XMP</rdf:li>
 ??? <rdf:li>Test</rdf:li>
 ?? </rdf:Bag>
 ? </dc:subject>
 ? <dc:title>
 ?? <rdf:Alt>
 ??? <rdf:li xml:lang='x-default'>Title</rdf:li>
 ?? </rdf:Alt>
 ? </dc:title>
 ?</rdf:Description>

 ?<rdf:Description rdf:about=''
 ? xmlns:tiff='https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fns.adobe.com%2Ftiff%2F1.0%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=DfHhnsqwL0IP%2BamOJ4fpcniNEmP%2BDyR6hpJq0Cv5fq8%3D&amp;reserved=0'>
 ? <tiff:BitsPerSample>
 ?? <rdf:Seq>
 ??? <rdf:li>8</rdf:li>
 ?? </rdf:Seq>
 ? </tiff:BitsPerSample>
 ? <tiff:Compression>1</tiff:Compression>
 ? <tiff:ImageLength>20</tiff:ImageLength>
 ? <tiff:ImageWidth>20</tiff:ImageWidth>
<tiff:PhotometricInterpretation>1</tiff:PhotometricInterpretation>
<tiff:PlanarConfiguration>1</tiff:PlanarConfiguration>
 ? <tiff:SamplesPerPixel>1</tiff:SamplesPerPixel>
 ?</rdf:Description>
</rdf:RDF>
</x:xmpmeta>
























<?xpacket end='w'?>
Metadata (DERIVED_SUBDATASETS):
DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:LOGAMPLITUDE:out.tif
 ? DERIVED_SUBDATASET_1_DESC=log10 of amplitude of input bands from out.tif
Image Structure Metadata:
 ? INTERLEAVE=BAND
Corner Coordinates:
Upper Left? (??? 0.0,??? 0.0)
Lower Left? (??? 0.0,??? 1.0)
Upper Right (??? 1.0,??? 0.0)
Lower Right (??? 1.0,??? 1.0)
Center????? (??? 0.5,??? 0.5)
Band 1 Block=1x1 Type=Byte, ColorInterp=Gray

Le 08/08/2022 ? 20:32, Tom O'Reilly a ?crit?:
> gdal_translate output .tif file does not contain XMP tags that were 
> present in the input .jpg file.
> The output file contains many of the input EXIF tags, aggregated as 
> the GDALMetadata tag, but not the XMP tags.
> Why does gdal_translate remove XMP tags - is there an option to 
> preserve them?
>
> Thanks
> Tom
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.mbari.org%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=KKLklE5oY8xr8uuILSsV32YGgD9NPoghdD%2BQ9uxdIjY%3D&amp;reserved=0 (World-wide Web)
>
> "The machine does not isolate us from the great mysteries
> ?of nature, but plunges us more deeply into them."
>
> ?? - ANTOINE DE SAINT-EXUPERY
> ?? ? "Wind, Sand, and Stars" (1939)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864831990006%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=Mc0CKOxHPW8lR5rJM9N9i%2BMY9ZYU0hWrptG2QOS4ih0%3D&amp;reserved=0

-- 
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864832146270%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=XzyLX7t5lr3uSfUXSekYHwMpr%2FvlEqIJ7KATBbHS0iM%3D&amp;reserved=0
My software is free, but my time generally not

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C7c347d29dbc44bf5dcb208da797a9f78%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C637955864832146270%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=6BD9A5sEOdtKt2DVCQk444G8tsJ9aIugFyFHHeDtfcQ%3D&amp;reserved=0

From even.rouault at spatialys.com  Mon Aug  8 13:37:03 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 8 Aug 2022 22:37:03 +0200
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <304125643.4206595.1659989619174.JavaMail.zimbra@mbari.org>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
 <a8c3ef58-e1a9-883a-1cdd-78a80929486c@spatialys.com>
 <304125643.4206595.1659989619174.JavaMail.zimbra@mbari.org>
Message-ID: <475aa89e-6235-3f12-36fa-6a0ccd9ab0a6@spatialys.com>


> The geotiff produced by step 1 contains the XMP tags as expected.
> But the warped geotiff produced by step 2 does not contain any XMP tags.

ah ok, gdalwarp indeed does not preserve the XMP information. I guess it 
would be reasonable to do it. You may create an enhancement ticket on 
the GDAL github issue tracker to suggest this.

Even

>
> How best to provide a test jpg? The ones I have are all 20+ MBytes.
>
> Thanks
> Tom
>
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>   
> "The machine does not isolate us from the great mysteries
>   of nature, but plunges us more deeply into them."
>   
>     - ANTOINE DE SAINT-EXUPERY
>       "Wind, Sand, and Stars" (1939)
>
> ----- Original Message -----
> From: "Even Rouault" <even.rouault at spatialys.com>
> To: "Tom O'Reilly" <oreilly at mbari.org>, "gdal-dev" <gdal-dev at lists.osgeo.org>
> Sent: Monday, August 8, 2022 12:13:03 PM
> Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags
>
> Tom,
>
> It would be interesting if you could provide an image how to reproduce that
>
> With the sample file from the autotest suite, I can't reproduce that:
>
> $ gdal_translate ../autotest/gdrivers/data/jpeg/byte_with_xmp.jpg out.tif
>
> $ gdalinfo out.tif -mdd all
>
> Driver: GTiff/GeoTIFF
> Files: out.tif
> Size is 1, 1
> Metadata (xml:XMP):
> <?xpacket begin='?' id='W5M0MpCehiHzreSzNTczkc9d'?>
> <x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 7.89'>
> <rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>
>
>   ?<rdf:Description rdf:about=''
>   ? xmlns:dc='http://purl.org/dc/elements/1.1/'>
>   ? <dc:description>
>   ?? <rdf:Alt>
>   ??? <rdf:li xml:lang='x-default'>Description</rdf:li>
>   ?? </rdf:Alt>
>   ? </dc:description>
>   ? <dc:subject>
>   ?? <rdf:Bag>
>   ??? <rdf:li>XMP</rdf:li>
>   ??? <rdf:li>Test</rdf:li>
>   ?? </rdf:Bag>
>   ? </dc:subject>
>   ? <dc:title>
>   ?? <rdf:Alt>
>   ??? <rdf:li xml:lang='x-default'>Title</rdf:li>
>   ?? </rdf:Alt>
>   ? </dc:title>
>   ?</rdf:Description>
>
>   ?<rdf:Description rdf:about=''
>   ? xmlns:tiff='http://ns.adobe.com/tiff/1.0/'>
>   ? <tiff:BitsPerSample>
>   ?? <rdf:Seq>
>   ??? <rdf:li>8</rdf:li>
>   ?? </rdf:Seq>
>   ? </tiff:BitsPerSample>
>   ? <tiff:Compression>1</tiff:Compression>
>   ? <tiff:ImageLength>20</tiff:ImageLength>
>   ? <tiff:ImageWidth>20</tiff:ImageWidth>
> <tiff:PhotometricInterpretation>1</tiff:PhotometricInterpretation>
> <tiff:PlanarConfiguration>1</tiff:PlanarConfiguration>
>   ? <tiff:SamplesPerPixel>1</tiff:SamplesPerPixel>
>   ?</rdf:Description>
> </rdf:RDF>
> </x:xmpmeta>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> <?xpacket end='w'?>
> Metadata (DERIVED_SUBDATASETS):
> DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:LOGAMPLITUDE:out.tif
>   ? DERIVED_SUBDATASET_1_DESC=log10 of amplitude of input bands from out.tif
> Image Structure Metadata:
>   ? INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left? (??? 0.0,??? 0.0)
> Lower Left? (??? 0.0,??? 1.0)
> Upper Right (??? 1.0,??? 0.0)
> Lower Right (??? 1.0,??? 1.0)
> Center????? (??? 0.5,??? 0.5)
> Band 1 Block=1x1 Type=Byte, ColorInterp=Gray
>
> Le 08/08/2022 ? 20:32, Tom O'Reilly a ?crit?:
>> gdal_translate output .tif file does not contain XMP tags that were
>> present in the input .jpg file.
>> The output file contains many of the input EXIF tags, aggregated as
>> the GDALMetadata tag, but not the XMP tags.
>> Why does gdal_translate remove XMP tags - is there an option to
>> preserve them?
>>
>> Thanks
>> Tom
>> --------------------------------------------------
>> Thomas C. O'Reilly
>> Monterey Bay Aquarium Research Institute
>> 7700 Sandholdt Road
>> Moss Landing, California 95039-9644
>> 831-775-1766 (voice)
>> 831-775-1620 (FAX)
>> oreilly at mbari.org (email)
>> http://www.mbari.org (World-wide Web)
>>
>> "The machine does not isolate us from the great mysteries
>>  ?of nature, but plunges us more deeply into them."
>>
>>  ?? - ANTOINE DE SAINT-EXUPERY
>>  ?? ? "Wind, Sand, and Stars" (1939)
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From j1 at jimenezshaw.com  Mon Aug  8 13:53:23 2022
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 8 Aug 2022 22:53:23 +0200
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <245152852.4207751.1659989774369.JavaMail.zimbra@mbari.org>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
 <CADRrdKtxOuJPWOyvh4O0+tybkbm0ePdSVb3BzbqT_0WFTHruNA@mail.gmail.com>
 <245152852.4207751.1659989774369.JavaMail.zimbra@mbari.org>
Message-ID: <CADRrdKtXJT6ssBHmevurx0RmCGHvprS2oFegtFQZKvAu676hkA@mail.gmail.com>

That makes more sense.
The PR that included the copy of the XMP is
https://github.com/OSGeo/gdal/pull/3050/
The key change is in the function GDALDriver::DefaultCreateCopy , that is
not used by gdalwarp
.___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
Entre dos pensamientos racionales
hay infinitos pensamientos irracionales.



On Mon, 8 Aug 2022 at 22:16, Tom O'Reilly <oreilly at mbari.org> wrote:

> Hi Javier,
>
> As noted in my previous response, I was wrong about gdal_translate - it
> actually does transfer the XMP tags from the input to the output, as XMP
> tags.
> It is a subsequent call to gdalwarp that drops the XMP tags.
> I am running gdal 3.5.0
>
> Thanks
> Tom
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>
> "The machine does not isolate us from the great mysteries
>  of nature, but plunges us more deeply into them."
>
>    - ANTOINE DE SAINT-EXUPERY
>      "Wind, Sand, and Stars" (1939)
>
>
> ------------------------------
> *From: *"Javier Jimenez Shaw" <j1 at jimenezshaw.com>
> *To: *"Tom O'Reilly" <oreilly at mbari.org>
> *Cc: *"gdal-dev" <gdal-dev at lists.osgeo.org>
> *Sent: *Monday, August 8, 2022 12:03:39 PM
> *Subject: *Re: [gdal-dev] gdal_translate drops XMP exif tags
>
> Which version of GDAL are you using?
> in https://gdal.org/programs/gdal_translate.html there is an option,
> "-noxmp", since GDAL 3.2. Without that option it should keep them. If I
> remember correctly, the XMP tags are copied as proper XMP, not as
> GDALMetadata, with TIFF files.
>
> An example with "gdalinfo -mdd all" for input and output may help.
> .___ ._ ..._ .. . ._.  .___ .. __ . _. . __..  ... .... ._ .__
> Entre dos pensamientos racionales
> hay infinitos pensamientos irracionales.
>
>
>
> On Mon, 8 Aug 2022 at 20:32, Tom O'Reilly <oreilly at mbari.org> wrote:
>
>> gdal_translate output .tif file does not contain XMP tags that were
>> present in the input .jpg file.
>> The output file contains many of the input EXIF tags, aggregated as the
>> GDALMetadata tag, but not the XMP tags.
>> Why does gdal_translate remove XMP tags - is there an option to preserve
>> them?
>>
>> Thanks
>> Tom
>> --------------------------------------------------
>> Thomas C. O'Reilly
>> Monterey Bay Aquarium Research Institute
>> 7700 Sandholdt Road
>> Moss Landing, California 95039-9644
>> 831-775-1766 (voice)
>> 831-775-1620 (FAX)
>> oreilly at mbari.org (email)
>> http://www.mbari.org (World-wide Web)
>>
>> "The machine does not isolate us from the great mysteries
>>  of nature, but plunges us more deeply into them."
>>
>>    - ANTOINE DE SAINT-EXUPERY
>>      "Wind, Sand, and Stars" (1939)
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220808/dbcfdaaf/attachment-0001.htm>

From oreilly at mbari.org  Mon Aug  8 14:02:05 2022
From: oreilly at mbari.org (Tom O'Reilly)
Date: Mon, 8 Aug 2022 14:02:05 -0700 (PDT)
Subject: [gdal-dev] gdal_translate drops XMP exif tags
In-Reply-To: <475aa89e-6235-3f12-36fa-6a0ccd9ab0a6@spatialys.com>
References: <474972136.4160688.1659983567439.JavaMail.zimbra@mbari.org>
 <a8c3ef58-e1a9-883a-1cdd-78a80929486c@spatialys.com>
 <304125643.4206595.1659989619174.JavaMail.zimbra@mbari.org>
 <475aa89e-6235-3f12-36fa-6a0ccd9ab0a6@spatialys.com>
Message-ID: <1780871904.4227429.1659992525125.JavaMail.zimbra@mbari.org>

Thanks Even and everyone!

As a workaround I think that for each XMP tag=value in the input .jpg, I can specify '-mo tag=value' option to gdal_translate. It appears that those tags/values are embedded and preserved in GDALMetadata through subsequent gdal processing. E.g. I can specify the following options to gdal_translate:

 % gdal_translate -mo Pitch=1.3 -mo Roll=5.5 -mo Yaw=192.1 <other arguments>

Then downstream tools can get Pitch, Roll and Yaw from the GDALMetadata tag.


Thanks
Tom
  

--------------------------------------------------
Thomas C. O'Reilly
Monterey Bay Aquarium Research Institute
7700 Sandholdt Road
Moss Landing, California 95039-9644
831-775-1766 (voice)
831-775-1620 (FAX)
oreilly at mbari.org (email)
http://www.mbari.org (World-wide Web)
 
"The machine does not isolate us from the great mysteries
 of nature, but plunges us more deeply into them."
 
   - ANTOINE DE SAINT-EXUPERY
     "Wind, Sand, and Stars" (1939)

----- Original Message -----
From: "Even Rouault" <even.rouault at spatialys.com>
To: "Tom O'Reilly" <oreilly at mbari.org>
Cc: "gdal-dev" <gdal-dev at lists.osgeo.org>
Sent: Monday, August 8, 2022 1:37:03 PM
Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags

> The geotiff produced by step 1 contains the XMP tags as expected.
> But the warped geotiff produced by step 2 does not contain any XMP tags.

ah ok, gdalwarp indeed does not preserve the XMP information. I guess it 
would be reasonable to do it. You may create an enhancement ticket on 
the GDAL github issue tracker to suggest this.

Even

>
> How best to provide a test jpg? The ones I have are all 20+ MBytes.
>
> Thanks
> Tom
>
> --------------------------------------------------
> Thomas C. O'Reilly
> Monterey Bay Aquarium Research Institute
> 7700 Sandholdt Road
> Moss Landing, California 95039-9644
> 831-775-1766 (voice)
> 831-775-1620 (FAX)
> oreilly at mbari.org (email)
> http://www.mbari.org (World-wide Web)
>   
> "The machine does not isolate us from the great mysteries
>   of nature, but plunges us more deeply into them."
>   
>     - ANTOINE DE SAINT-EXUPERY
>       "Wind, Sand, and Stars" (1939)
>
> ----- Original Message -----
> From: "Even Rouault" <even.rouault at spatialys.com>
> To: "Tom O'Reilly" <oreilly at mbari.org>, "gdal-dev" <gdal-dev at lists.osgeo.org>
> Sent: Monday, August 8, 2022 12:13:03 PM
> Subject: Re: [gdal-dev] gdal_translate drops XMP exif tags
>
> Tom,
>
> It would be interesting if you could provide an image how to reproduce that
>
> With the sample file from the autotest suite, I can't reproduce that:
>
> $ gdal_translate ../autotest/gdrivers/data/jpeg/byte_with_xmp.jpg out.tif
>
> $ gdalinfo out.tif -mdd all
>
> Driver: GTiff/GeoTIFF
> Files: out.tif
> Size is 1, 1
> Metadata (xml:XMP):
> <?xpacket begin='?' id='W5M0MpCehiHzreSzNTczkc9d'?>
> <x:xmpmeta xmlns:x='adobe:ns:meta/' x:xmptk='Image::ExifTool 7.89'>
> <rdf:RDF xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns#'>
>
>   ?<rdf:Description rdf:about=''
>   ? xmlns:dc='http://purl.org/dc/elements/1.1/'>
>   ? <dc:description>
>   ?? <rdf:Alt>
>   ??? <rdf:li xml:lang='x-default'>Description</rdf:li>
>   ?? </rdf:Alt>
>   ? </dc:description>
>   ? <dc:subject>
>   ?? <rdf:Bag>
>   ??? <rdf:li>XMP</rdf:li>
>   ??? <rdf:li>Test</rdf:li>
>   ?? </rdf:Bag>
>   ? </dc:subject>
>   ? <dc:title>
>   ?? <rdf:Alt>
>   ??? <rdf:li xml:lang='x-default'>Title</rdf:li>
>   ?? </rdf:Alt>
>   ? </dc:title>
>   ?</rdf:Description>
>
>   ?<rdf:Description rdf:about=''
>   ? xmlns:tiff='http://ns.adobe.com/tiff/1.0/'>
>   ? <tiff:BitsPerSample>
>   ?? <rdf:Seq>
>   ??? <rdf:li>8</rdf:li>
>   ?? </rdf:Seq>
>   ? </tiff:BitsPerSample>
>   ? <tiff:Compression>1</tiff:Compression>
>   ? <tiff:ImageLength>20</tiff:ImageLength>
>   ? <tiff:ImageWidth>20</tiff:ImageWidth>
> <tiff:PhotometricInterpretation>1</tiff:PhotometricInterpretation>
> <tiff:PlanarConfiguration>1</tiff:PlanarConfiguration>
>   ? <tiff:SamplesPerPixel>1</tiff:SamplesPerPixel>
>   ?</rdf:Description>
> </rdf:RDF>
> </x:xmpmeta>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> <?xpacket end='w'?>
> Metadata (DERIVED_SUBDATASETS):
> DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:LOGAMPLITUDE:out.tif
>   ? DERIVED_SUBDATASET_1_DESC=log10 of amplitude of input bands from out.tif
> Image Structure Metadata:
>   ? INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left? (??? 0.0,??? 0.0)
> Lower Left? (??? 0.0,??? 1.0)
> Upper Right (??? 1.0,??? 0.0)
> Lower Right (??? 1.0,??? 1.0)
> Center????? (??? 0.5,??? 0.5)
> Band 1 Block=1x1 Type=Byte, ColorInterp=Gray
>
> Le 08/08/2022 ? 20:32, Tom O'Reilly a ?crit?:
>> gdal_translate output .tif file does not contain XMP tags that were
>> present in the input .jpg file.
>> The output file contains many of the input EXIF tags, aggregated as
>> the GDALMetadata tag, but not the XMP tags.
>> Why does gdal_translate remove XMP tags - is there an option to
>> preserve them?
>>
>> Thanks
>> Tom
>> --------------------------------------------------
>> Thomas C. O'Reilly
>> Monterey Bay Aquarium Research Institute
>> 7700 Sandholdt Road
>> Moss Landing, California 95039-9644
>> 831-775-1766 (voice)
>> 831-775-1620 (FAX)
>> oreilly at mbari.org (email)
>> http://www.mbari.org (World-wide Web)
>>
>> "The machine does not isolate us from the great mysteries
>>  ?of nature, but plunges us more deeply into them."
>>
>>  ?? - ANTOINE DE SAINT-EXUPERY
>>  ?? ? "Wind, Sand, and Stars" (1939)
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not


From theo.linnemann at gmail.com  Mon Aug  8 20:20:52 2022
From: theo.linnemann at gmail.com (Theo Linnemann)
Date: Mon, 8 Aug 2022 23:20:52 -0400
Subject: [gdal-dev] Guidance for GeoJSONSeq Error 6: Too Large Feature
In-Reply-To: <mailman.25976.1660013226.32175.gdal-dev@lists.osgeo.org>
References: <mailman.25976.1660013226.32175.gdal-dev@lists.osgeo.org>
Message-ID: <CAC7rD7hZ_DPyEMOqv_hxSvWw8ocssaU7NW4bbj-EGXXNYmTEHw@mail.gmail.com>

>
> Hi There,
>
> I'm working with a set of fairly large geojsonl files, one for each state
> and territory in the United States. I'm using ogr2ogr to ingest this data
> into PostGIS, generally without issue, to speed up an expensive geospatial
> join.
>
> However, one of my files, specifically the Commonwealth of Pennsylvania,
> is about 6.5 GB and has been throwing an odd error that I can't seem to
> find much information on. "ERROR 6: Too large feature". Below is the
> command and output from running ogrinfo with the debug flag set to on,
> which returns the same error.
>
> I'm just hoping for some guidance in terms of what if anything I can do to
> sidestep the issue.
>
> So far, I've taken a look at what seems to be the GDAL source code that
> generates this error
> <https://github.com/OSGeo/gdal/blob/030ff40cf8340273bcc797e90c938cc32d14a34f/ogr/ogrsf_frmts/geojson/ogrgeojsonseqdriver.cpp#L410>,
> but it's unclear to me if it's possible to adjust the size constraint that
> is specified in the condition that throws the error or if the constraint is
> arbitrary or indicative of a larger problem with the file. I've already
> tried using the -gt flag with various sizes as well, but none seem to
> resolve the issue. I ran into an issue previously that required me to set
> OGR_GEOJSON_MAX_OBJ_SIZE=2048MB but that doesn't seem to have any effect
> here for some reason. Perhaps that only effects the GeoJSON driver and not
> the GeoJSONSeq driver? For what it's worth this is running on a node with
> ~350GB of RAM, so generally memory shouldn't be an issue.
>
> ogrinfo --version
> GDAL 3.5.0, released 2022/05/10
> ------------------------------------------------------
>
> ogrinfo --build
>
> PAM_ENABLED=YES
> OGR_ENABLED=YES
> GEOS_ENABLED=YES
> GEOS_VERSION=3.10.2-CAPI-1.16.0
> PROJ_BUILD_VERSION=9.0.0
> PROJ_RUNTIME_VERSION=9.0.0
> ------------------------------------------------------
>
> ogrinfo crs4326_fema_42_2022-07-22.geojsonl --debug ON
> GeoJSONSeq: First pass: 0.06 %
> GeoJSONSeq: First pass: 0.12 %
> GeoJSONSeq: First pass: 0.18 %
> ...
> GeoJSONSeq: First pass: 92.08 %
> GeoJSONSeq: First pass: 92.14 %
> GeoJSONSeq: First pass: 92.20 %
> ERROR 6: Too large feature
> GDAL: GDALOpen(crs4326_fema_42_2022-07-22.geojsonl, this=0x564966fae8b0)
> succeeds as GeoJSONSeq.
> INFO: Open of `crs4326_fema_42_2022-07-22.geojsonl'
>       using driver `GeoJSONSeq' successful.
> OGR: GetLayerCount() = 1
>
> 1: crs4326_fema_42_2022-07-22 (Multi Polygon)
> GDAL: GDALClose(crs4326_fema_42_2022-07-22.geojsonl, this=0x564966fae8b0)
> GDAL: In GDALDestroy - unloading GDAL shared library.
>
> Thank you for any help you're able to offer, it's much appreciated.
>
> TL
>
> Theo Linnemann <https://www.theolinnemann.com/>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220808/a00f1828/attachment.htm>

From gordon at fatcyclops.com  Tue Aug  9 04:16:42 2022
From: gordon at fatcyclops.com (Gordon Paterson)
Date: Tue, 9 Aug 2022 12:16:42 +0100
Subject: [gdal-dev] csharp inverse transform problem
Message-ID: <CAF9Cb5j6r1sRrVp_YgxdO-_dFmEo9jC+3FqQxVSDz769H3kzhg@mail.gmail.com>

Hi everyone,

GDAL 3.5.0

I have an application written in c# that takes data in WGS84 and transforms
the coordinates to the relevant local projected CRS.

In the code I use a URN with the EPSG transformation code, for example for
ED50 data -

urn:ogc:def:coordinateOperation:EPSG::1311


to convert between EPSG:4326 and EPSG:4230 and it works great for going
from EPSG:4230 > EPSG:4326 but it doesn't give the correct results the
other way.

Checking the coordinates with gdaltransform from the command line using the
following -

gdaltransform -s_srs EPSG:4326 -t_srs EPSG:4230 -ct
urn:ogc:def:coordinateOperation:EPSG::1311


I get this -

WGS84 (EPSG:4326)
 2.25661712354279 56.4136492649363

ED50 (EPSG:4230)
2.25511244583886 56.4129769077511


which are the same coordinates I get through code, which is not right,  but
with the -i switch -

gdaltransform -s_srs EPSG:4326 -t_srs EPSG:4230 -ct
urn:ogc:def:coordinateOperation:EPSG::1311 -i


I get this -

ED50 (EPSG:4230)
2.25812179682132 56.414321584992


which is correct.

In the gdal docs there is a bReverseCT boolean parameter for
SetCoordinateOperation that is not accessible and is set to always be false
in the SWIG interface.

I set the correct Axis mapping on the spatial reference within code. I'm no
doubt missing something, what am I doing wrong?

thanks very much,

-Gordon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220809/0137b96b/attachment-0001.htm>

From even.rouault at spatialys.com  Tue Aug  9 05:52:11 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 9 Aug 2022 14:52:11 +0200
Subject: [gdal-dev] autoconf and nmake build systems ready to be removed
In-Reply-To: <6a02a58d-113f-1873-d529-11165e7cb166@spatialys.com>
References: <6a02a58d-113f-1873-d529-11165e7cb166@spatialys.com>
Message-ID: <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>

Hi,

I've just merged the pull request removing them

Even

Le 21/07/2022 ? 22:12, Even Rouault a ?crit?:
> Hi,
>
> Great news: the final step of the CMake migration (checklist in 
> https://github.com/OSGeo/gdal/issues/5680), the removal of the 
> autoconf and nmake build systems 
> (https://github.com/OSGeo/gdal/pull/6110) is now ready to be merged.
>
> Are there people who track GDAL master and still use autoconf/nmake 
> and would need some grace period to complete their transition to cmake ?
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Aug  9 07:18:41 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 9 Aug 2022 16:18:41 +0200
Subject: [gdal-dev] csharp inverse transform problem
In-Reply-To: <CAF9Cb5j6r1sRrVp_YgxdO-_dFmEo9jC+3FqQxVSDz769H3kzhg@mail.gmail.com>
References: <CAF9Cb5j6r1sRrVp_YgxdO-_dFmEo9jC+3FqQxVSDz769H3kzhg@mail.gmail.com>
Message-ID: <df3ddde3-03e2-ad02-b9c7-3c64c4661443@spatialys.com>

Gordon,

urn:ogc:def:coordinateOperation:EPSG::1311 is from ED50 to WGS84, so 
what you observe with gdaltransform is expected. You'd get the correct 
result by just switching EPSG:4326 and EPSG:4230

Regarding the use of the API, it is true that this was lacking. Adressed 
per https://github.com/OSGeo/gdal/pull/6175

Even

Le 09/08/2022 ? 13:16, Gordon Paterson a ?crit?:
> Hi everyone,
>
> GDAL 3.5.0
>
> I have an application written in c# that takes data in WGS84 and 
> transforms the?coordinates to the relevant local projected CRS.
>
> In the code I use a URN with the EPSG transformation code, for example 
> for ED50 data -
>
>     urn:ogc:def:coordinateOperation:EPSG::1311
>
>
> to convert between EPSG:4326 and EPSG:4230 and it works great for 
> going from EPSG:4230 > EPSG:4326 but it doesn't give the correct 
> results the other?way.
>
> Checking the coordinates with gdaltransform from the command line 
> using the following -
>
>     gdaltransform -s_srs EPSG:4326 -t_srs EPSG:4230 -ct
>     urn:ogc:def:coordinateOperation:EPSG::1311
>
>
> I get this -
>
>     WGS84 (EPSG:4326)
>     2.25661712354279 56.4136492649363
>
>     ED50 (EPSG:4230)
>     2.25511244583886 56.4129769077511
>
>
> which are the same coordinates I get through code, which is not 
> right,? but with the -i switch -
>
>     gdaltransform -s_srs EPSG:4326 -t_srs EPSG:4230 -ct
>     urn:ogc:def:coordinateOperation:EPSG::1311 -i
>
>
> I get this -
>
>     ED50 (EPSG:4230)
>     2.25812179682132 56.414321584992
>
>
> which is correct.
>
> In the gdal docs there is a bReverseCT boolean parameter for 
> SetCoordinateOperation that is not?accessible and is set to always be 
> false in the SWIG interface.
>
> I set the correct Axis mapping on the spatial reference within code. 
> I'm no doubt missing something, what am I doing wrong?
>
> thanks very much,
>
> -Gordon
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220809/4d4fb7f2/attachment.htm>

From even.rouault at spatialys.com  Tue Aug  9 08:38:28 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 9 Aug 2022 17:38:28 +0200
Subject: [gdal-dev] Guidance for GeoJSONSeq Error 6: Too Large Feature
In-Reply-To: <CAC7rD7hZ_DPyEMOqv_hxSvWw8ocssaU7NW4bbj-EGXXNYmTEHw@mail.gmail.com>
References: <mailman.25976.1660013226.32175.gdal-dev@lists.osgeo.org>
 <CAC7rD7hZ_DPyEMOqv_hxSvWw8ocssaU7NW4bbj-EGXXNYmTEHw@mail.gmail.com>
Message-ID: <5bac85e2-8cf6-a1ab-18d8-aa961e79b6bd@spatialys.com>

Theo,

you indeed spotted an hardcoded limit in the the GeoJSONSeq driver. 
Addressed per https://github.com/OSGeo/gdal/pull/6177

Even

Le 09/08/2022 ? 05:20, Theo Linnemann a ?crit?:
>
>     Hi There,
>
>     I'm working with a set of fairly large geojsonl?files, one for
>     each state and territory in the United States. I'm using ogr2ogr
>     to ingest this data into PostGIS, generally without issue, to
>     speed up an expensive geospatial join.
>
>     However, one of my files, specifically the?Commonwealth of
>     Pennsylvania, is about 6.5 GB and has been throwing an odd error
>     that I can't seem to find much information on. "ERROR 6: Too large
>     feature". Below is the command and output from running ogrinfo
>     with the debug flag set to on, which returns the same error.
>
>     I'm just hoping for some guidance in terms of what if anything I
>     can do to sidestep the issue.
>
>     So far, I've taken a look at what seems to be the GDAL source code
>     that generates this error
>     <https://github.com/OSGeo/gdal/blob/030ff40cf8340273bcc797e90c938cc32d14a34f/ogr/ogrsf_frmts/geojson/ogrgeojsonseqdriver.cpp#L410>,
>     but it's unclear to me if it's possible to adjust the size
>     constraint that is specified in the condition that throws the
>     error or if the constraint is arbitrary or indicative of a larger
>     problem with the file. I've already tried using the -gt flag with
>     various sizes as well, but none seem to resolve the issue. I ran
>     into an issue previously that required me to set
>     OGR_GEOJSON_MAX_OBJ_SIZE=2048MB?but that doesn't seem to have any
>     effect here for some reason. Perhaps that only effects the GeoJSON
>     driver and not the GeoJSONSeq driver? For what it's worth this is
>     running on a node with ~350GB of RAM, so generally memory
>     shouldn't be an issue.
>
>     ogrinfo --version
>     GDAL 3.5.0, released 2022/05/10
>     ------------------------------------------------------
>
>     ogrinfo --build
>     PAM_ENABLED=YES
>     OGR_ENABLED=YES
>     GEOS_ENABLED=YES
>     GEOS_VERSION=3.10.2-CAPI-1.16.0
>     PROJ_BUILD_VERSION=9.0.0
>     PROJ_RUNTIME_VERSION=9.0.0
>     ------------------------------------------------------
>
>     ogrinfo crs4326_fema_42_2022-07-22.geojsonl --debug ON
>     GeoJSONSeq: First pass: 0.06 %
>     GeoJSONSeq: First pass: 0.12 %
>     GeoJSONSeq: First pass: 0.18 %
>     ...
>     GeoJSONSeq: First pass: 92.08 %
>     GeoJSONSeq: First pass: 92.14 %
>     GeoJSONSeq: First pass: 92.20 %
>     ERROR 6: Too large feature
>     GDAL: GDALOpen(crs4326_fema_42_2022-07-22.geojsonl,
>     this=0x564966fae8b0) succeeds as GeoJSONSeq.
>     INFO: Open of `crs4326_fema_42_2022-07-22.geojsonl'
>     ? ? ? using driver `GeoJSONSeq' successful.
>     OGR: GetLayerCount() = 1
>
>     1: crs4326_fema_42_2022-07-22 (Multi Polygon)
>     GDAL: GDALClose(crs4326_fema_42_2022-07-22.geojsonl,
>     this=0x564966fae8b0)
>     GDAL: In GDALDestroy - unloading GDAL shared library.
>
>     Thank you for any help you're able to offer, it's much appreciated.
>
>     TL
>
>     Theo Linnemann <https://www.theolinnemann.com/>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220809/ee34fef9/attachment.htm>

From theo.linnemann at gmail.com  Tue Aug  9 09:06:14 2022
From: theo.linnemann at gmail.com (Theo Linnemann)
Date: Tue, 9 Aug 2022 12:06:14 -0400
Subject: [gdal-dev] Guidance for GeoJSONSeq Error 6: Too Large Feature
In-Reply-To: <5bac85e2-8cf6-a1ab-18d8-aa961e79b6bd@spatialys.com>
References: <mailman.25976.1660013226.32175.gdal-dev@lists.osgeo.org>
 <CAC7rD7hZ_DPyEMOqv_hxSvWw8ocssaU7NW4bbj-EGXXNYmTEHw@mail.gmail.com>
 <5bac85e2-8cf6-a1ab-18d8-aa961e79b6bd@spatialys.com>
Message-ID: <CAC7rD7gCK=8aE_C7+0V0cLORYmLuipK335jbWoxCg_rxgog=uA@mail.gmail.com>

Wow, thank you so much for the helpful response and quick fix!

TL


On Tue, Aug 9, 2022, 11:38 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Theo,
>
> you indeed spotted an hardcoded limit in the the GeoJSONSeq driver.
> Addressed per https://github.com/OSGeo/gdal/pull/6177
>
> Even
> Le 09/08/2022 ? 05:20, Theo Linnemann a ?crit :
>
> Hi There,
>>
>> I'm working with a set of fairly large geojsonl files, one for each state
>> and territory in the United States. I'm using ogr2ogr to ingest this data
>> into PostGIS, generally without issue, to speed up an expensive geospatial
>> join.
>>
>> However, one of my files, specifically the Commonwealth of Pennsylvania,
>> is about 6.5 GB and has been throwing an odd error that I can't seem to
>> find much information on. "ERROR 6: Too large feature". Below is the
>> command and output from running ogrinfo with the debug flag set to on,
>> which returns the same error.
>>
>> I'm just hoping for some guidance in terms of what if anything I can do
>> to sidestep the issue.
>>
>> So far, I've taken a look at what seems to be the GDAL source code that
>> generates this error
>> <https://github.com/OSGeo/gdal/blob/030ff40cf8340273bcc797e90c938cc32d14a34f/ogr/ogrsf_frmts/geojson/ogrgeojsonseqdriver.cpp#L410>,
>> but it's unclear to me if it's possible to adjust the size constraint that
>> is specified in the condition that throws the error or if the constraint is
>> arbitrary or indicative of a larger problem with the file. I've already
>> tried using the -gt flag with various sizes as well, but none seem to
>> resolve the issue. I ran into an issue previously that required me to set
>> OGR_GEOJSON_MAX_OBJ_SIZE=2048MB but that doesn't seem to have any effect
>> here for some reason. Perhaps that only effects the GeoJSON driver and not
>> the GeoJSONSeq driver? For what it's worth this is running on a node with
>> ~350GB of RAM, so generally memory shouldn't be an issue.
>>
>> ogrinfo --version
>> GDAL 3.5.0, released 2022/05/10
>> ------------------------------------------------------
>>
>> ogrinfo --build
>>
>>
>> PAM_ENABLED=YES
>> OGR_ENABLED=YES
>> GEOS_ENABLED=YES
>> GEOS_VERSION=3.10.2-CAPI-1.16.0
>> PROJ_BUILD_VERSION=9.0.0
>> PROJ_RUNTIME_VERSION=9.0.0
>> ------------------------------------------------------
>>
>> ogrinfo crs4326_fema_42_2022-07-22.geojsonl --debug ON
>> GeoJSONSeq: First pass: 0.06 %
>> GeoJSONSeq: First pass: 0.12 %
>> GeoJSONSeq: First pass: 0.18 %
>> ...
>> GeoJSONSeq: First pass: 92.08 %
>> GeoJSONSeq: First pass: 92.14 %
>> GeoJSONSeq: First pass: 92.20 %
>> ERROR 6: Too large feature
>> GDAL: GDALOpen(crs4326_fema_42_2022-07-22.geojsonl, this=0x564966fae8b0)
>> succeeds as GeoJSONSeq.
>> INFO: Open of `crs4326_fema_42_2022-07-22.geojsonl'
>>       using driver `GeoJSONSeq' successful.
>> OGR: GetLayerCount() = 1
>>
>> 1: crs4326_fema_42_2022-07-22 (Multi Polygon)
>> GDAL: GDALClose(crs4326_fema_42_2022-07-22.geojsonl, this=0x564966fae8b0)
>> GDAL: In GDALDestroy - unloading GDAL shared library.
>>
>> Thank you for any help you're able to offer, it's much appreciated.
>>
>> TL
>>
>> Theo Linnemann <https://www.theolinnemann.com/>
>>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220809/778e3fab/attachment-0001.htm>

From andrew at aitchison.me.uk  Wed Aug 10 04:02:33 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 10 Aug 2022 12:02:33 +0100 (BST)
Subject: [gdal-dev] autoconf and nmake build systems ready to be removed
In-Reply-To: <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>
References: <6a02a58d-113f-1873-d529-11165e7cb166@spatialys.com>
 <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>
Message-ID: <53a823f2-7d30-c16d-8beb-97b45b9d6c94@aitchison.me.uk>


On Tue, 9 Aug 2022, Even Rouault wrote:

> I've just merged the pull request removing them
>
> Even
>
> Le 21/07/2022 ? 22:12, Even Rouault a ?crit?:
>> Hi,
>> 
>> Great news: the final step of the CMake migration (checklist in 
>> https://github.com/OSGeo/gdal/issues/5680), the removal of the autoconf and 
>> nmake build systems (https://github.com/OSGeo/gdal/pull/6110) is now ready 
>> to be merged.
>> 
>> Are there people who track GDAL master and still use autoconf/nmake and 
>> would need some grace period to complete their transition to cmake ?
>> 
>> Even

Conda builds on github seem to be failing because of this:

https://github.com/OSGeo/gdal/runs/7750261228?check_suite_focus=true#step:4:540
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
./ci/travis/conda/setup.sh: line 8: ./autogen.sh: No such file or directory
Error: Process completed with exit code 1.

autogen.sh was removed by Evan's pull.

I see this on Ubuntu and MacOS builds on Github.

Who is preparing Conda to drop automake and commit to cmake ?

Thanks,

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From schwehr at gmail.com  Wed Aug 10 07:23:39 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 10 Aug 2022 07:23:39 -0700
Subject: [gdal-dev] autoconf and nmake build systems ready to be removed
In-Reply-To: <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>
References: <6a02a58d-113f-1873-d529-11165e7cb166@spatialys.com>
 <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>
Message-ID: <CACmBxyuMVFNYa6AHPAXPYjzAtoHzJFEKY-ReQYA3RB5EsXG8FA@mail.gmail.com>

Congrats and many thanks!

On Tue, Aug 9, 2022 at 5:52 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've just merged the pull request removing them
>
> Even
>
> Le 21/07/2022 ? 22:12, Even Rouault a ?crit :
> > Hi,
> >
> > Great news: the final step of the CMake migration (checklist in
> > https://github.com/OSGeo/gdal/issues/5680), the removal of the
> > autoconf and nmake build systems
> > (https://github.com/OSGeo/gdal/pull/6110) is now ready to be merged.
> >
> > Are there people who track GDAL master and still use autoconf/nmake
> > and would need some grace period to complete their transition to cmake ?
> >
> > Even
> >
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220810/cbedad6b/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 10 10:29:48 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Aug 2022 19:29:48 +0200
Subject: [gdal-dev] autoconf and nmake build systems ready to be removed
In-Reply-To: <53a823f2-7d30-c16d-8beb-97b45b9d6c94@aitchison.me.uk>
References: <6a02a58d-113f-1873-d529-11165e7cb166@spatialys.com>
 <b8ac8262-521f-82b7-44a3-9f4a483b8aeb@spatialys.com>
 <53a823f2-7d30-c16d-8beb-97b45b9d6c94@aitchison.me.uk>
Message-ID: <ed33512f-bd1a-6b04-4c2b-6b7408615a29@spatialys.com>

Andrew,
> Conda builds on github seem to be failing because of this:
>
yep this is a known issue until 
https://github.com/conda-forge/gdal-feedstock/pull/629 is ready for merge

Note that those CI Conda based builds were also occasionally broken 
before, sometimes for mysterious reasons (at least to me).

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mdsumner at gmail.com  Sat Aug 13 23:07:42 2022
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 14 Aug 2022 16:07:42 +1000
Subject: [gdal-dev] question for scaling default
Message-ID: <CAAcGz98gxBRC7PdzfoAXKK3MNtJJkv0GcB2=rchj87NVj9-52w@mail.gmail.com>

Hello, I have a new driver candidate, it's natively a type Byte and is a
percentage (or fraction) floating point value when unscaled.  I have a
couple of questions. .

https://github.com/OSGeo/gdal/pull/6183

I'd like to have it unscale by default, with band type Float32 - but be
able to opt out of scaling, and return the raw Byte type. I think that is a
good default since most usage will want the fraction value, but
occasionally useful to obtain the raw codes that include some special out
of range values (>255).

I think I can work out how to do this, but is there a driver that already
provides this kind of behaviour that I can learn from?

Also, I feel like fraction (0, 1) is a more sensible data value than
percentage (0, 100), although I've used percentage in the past with these
data. Any thoughts, or examples that exist in GDAL?

Thanks very much, Mike



-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220814/788b28a9/attachment.htm>

From peter.loewe at gmx.de  Sun Aug 14 03:43:17 2022
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Sun, 14 Aug 2022 12:43:17 +0200
Subject: [gdal-dev] Handbook of Geographic Information / Open Source Chapter
 / GDAL DOI
References: <trinity-bf9eca18-af51-4511-a17f-352cbf8f8d45-1660473678683@3c-app-gmx-bap18>
Message-ID: <trinity-b108b97f-d396-45ba-a9e0-9a7a263f08a9-1660473797304@3c-app-gmx-bap18>

Dear GDAL community,

this is a follow up on the minting of a persitent Digital Object Identifier (DOI) for the GDAL repository. DOI are an emerging standard in digital science.

This DOI reference has now been used to reference the GDAL codebase in the Open Source GIS chapter of the new edition of the Springer Handbook of Geographic Information.

DOI can be used to reference code, data, publications and video and allow to give due scientific credit to the authors, in this case the project development team.

The Open Source GIS chapter which also features GDAL is available for free download during August 2022: https://link.springer.com/chapter/10.1007/978-3-030-53125-6_30.

The chapter includes also a large number of references to conference videos about the software tools which are adressed, which can be immediately accessed from the PDF. The video references are also enabled by DOI.

Kind regards,
Peter


<peter.loewe at gmx.de>


From roper.william at gmail.com  Mon Aug 15 02:45:01 2022
From: roper.william at gmail.com (William Roper)
Date: Mon, 15 Aug 2022 10:45:01 +0100
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
Message-ID: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>

Hi list,

I'm trying to convert a GeoTiff on s3 into a COG, that will also live on
s3. I'm working on EC2 instances, or fargate containers, because local
download and upload speeds are a bit slow.

gdalwarp \
  --config AWS_SECRET_ACCESS_KEY <my-secret-key> \
  --config AWS_ACCESS_KEY_ID <my-access-key> \
  --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE YES \
  --config CPL_TMPDIR /tmp \
  -of COG
  -co TILING_SCHEME=GoogleMapsCompatible
  -co COMPRESS=DEFLATE
  -co NUM_THREADS=ALL_CPUS
  /vsis3/my-bucket/original-old-geotif.tif
  /vsis3/my-bucket/shiny-new-cog.tif


And get the following error:

0...10...20...30...ERROR 1: Only read-only mode is supported for /vsicurl


I get the same issue running in a docker container (osgeo/gdal:latest) or
on an ubuntu EC2 instance with gdal-bin installed with apt  (version
3.4.1).

I can work around it by writing the COG to the machine, and then uploading
to s3, but was wondered what I was doing wrong/not understanding.

Many thanks
Will
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220815/66c88166/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 16 00:18:10 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Aug 2022 09:18:10 +0200
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
In-Reply-To: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
References: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
Message-ID: <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>

William,

can you add "--debug on" and retry to see if more hints are emitted 
about what's going on.

Even

Le 15/08/2022 ? 11:45, William Roper a ?crit?:
> Hi list,
>
> I'm trying to convert a GeoTiff on s3 into a COG, that will also live 
> on s3. I'm working on EC2 instances, or fargate containers, because 
> local download and upload speeds are a bit slow.
>
> gdalwarp \
>    --config AWS_SECRET_ACCESS_KEY <my-secret-key> \
>    --config AWS_ACCESS_KEY_ID <my-access-key> \
>    --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE YES \
>    --config CPL_TMPDIR /tmp \
>    -of COG
>    -co TILING_SCHEME=GoogleMapsCompatible
>    -co COMPRESS=DEFLATE
>    -co NUM_THREADS=ALL_CPUS
>    /vsis3/my-bucket/original-old-geotif.tif
>    /vsis3/my-bucket/shiny-new-cog.tif
>
> And get the following error:
> 0...10...20...30...ERROR 1: Only read-only mode is supported for /vsicurl
>
> I get the same issue running in a docker container (osgeo/gdal:latest) 
> or on an ubuntu EC2 instance with gdal-bin installed with apt? 
> (version 3.4.1).
>
> I can work around it by writing the COG to the machine, and then 
> uploading to s3, but was wondered what I was doing wrong/not 
> understanding.
>
> Many thanks
> Will
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220816/944754a1/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 16 00:38:29 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Aug 2022 09:38:29 +0200
Subject: [gdal-dev] question for scaling default
In-Reply-To: <CAAcGz98gxBRC7PdzfoAXKK3MNtJJkv0GcB2=rchj87NVj9-52w@mail.gmail.com>
References: <CAAcGz98gxBRC7PdzfoAXKK3MNtJJkv0GcB2=rchj87NVj9-52w@mail.gmail.com>
Message-ID: <10687a54-0e7f-321f-f8f3-787f017a8319@spatialys.com>

Mike,

Le 14/08/2022 ? 08:07, Michael Sumner a ?crit?:
> Hello, I have a new driver candidate, it's natively a type Byte and is 
> a percentage (or fraction) floating point value when unscaled.? I have 
> a couple of?questions. .
>
> https://github.com/OSGeo/gdal/pull/6183
>
> I'd like to have it unscale by default, with band type Float32 - but 
> be able to opt out of scaling, and return the raw Byte type. I think 
> that is a good default since most usage will want the fraction value, 
> but occasionally useful to obtain the raw codes that include some 
> special out of range values (>255).
>
> I think?I can work out how to do this,?but is there a driver that 
> already provides this kind of behaviour that I can learn from?

I can't think of a driver that would do exactly that (some apply 
unscaling but they do also the low-level I/O). As the rescaling involves 
changing data type from raw Byte to unscaled Float32, I don't think that 
NSIDCbinRasterBand can directly derive from RawRasterBand. 
NSIDCbinRasterBand should probably have a RawRasterBand member variable 
instead, and implement IReadBlock() to read in a temporary Byte buffer, 
and apply the unscaling from it to the user provided buffer (or a bit 
equivalently you could likely return a VRTRasterBand that would do the 
unscaling, but this might not be more simple to setup, and if you want 
to apply conditional unscaling dependending if values are out of range 
or not, that would not be possible).


>
> Also, I feel like fraction (0, 1) is a more sensible data value than 
> percentage (0, 100), although I've used percentage in the past with 
> these data. Any thoughts, or examples that exist in GDAL?

I don't think there's a norm in GDAL for that. Different drivers or 
different data products probably use both conventions. Having the 
GetUnitType() method return "Percentage" or "Fraction [0,1]" should be 
enough to document the behavior of the driver.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From edzer.pebesma at uni-muenster.de  Tue Aug 16 03:47:57 2022
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 16 Aug 2022 12:47:57 +0200
Subject: [gdal-dev] reading/writing geometries using GDAL's MDA API
Message-ID: <ac4ed9e5-d2b1-0dde-9d35-8ddccf6a0dd0@uni-muenster.de>

I've been using GDAL's C++ multidimensional array (MDA) API lately to 
read and write data cubes from R - excellent work! I was looking into 
support for vector data cubes, multidimensional arrays with a single 
dimension associated with a set of geometries.

What we can do is read and write dimensions, variables, and attributes, 
but what (as far as I can tell) is missing is to read and write 
OGRGeometry variables, using the CF specification for geometry [1], 
which is supported by the NetCDF vector driver. Would it be feasible to 
read and write CF-compliant geometries from multidimensional arrays 
through the MDA API? Right now software writers have to sort this out 
themselves, which is straightforward for points but cludgy for polygons. 
Another issue is crs handling which I think could be done gracefully 
using the OGRGeometry interface.

As a minimal data example: I added two ncdump files below for two time 
instances and two POINT geometries. The first can be read and written by 
the OGR API, but is a one-dimensional array that lacks the time 
information of time series (time distributed over attributes/columns). 
The second is a 2 x 2 multidimensional array with the time information. 
GDAL's MDA API can read it but doesn't recognize geometries, GDAL's OGR 
API cannot read it (obviously). I'd like to be able to read (and write) 
the station dimension of the second one as an OGRGeometry, for points, 
lines or polygons.

[1] 
https://cfconventions.org/Data/cf-conventions/cf-conventions-1.9/cf-conventions.html#geometries
-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

First example (written by OGR NetCDF driver):
netcdf t2 {
dimensions:
	t2_node_coordinates = 2 ;
variables:
	float t2 ;
		t2:geometry_type = "point" ;
		t2:node_coordinates = "t2_coordX t2_coordY" ;
	double t2_coordX(t2_node_coordinates) ;
		t2_coordX:axis = "X" ;
	double t2_coordY(t2_node_coordinates) ;
		t2_coordY:axis = "Y" ;
	double t2_field_t1(t2_node_coordinates) ;
		t2_field_t1:long_name = "Field t1" ;
		t2_field_t1:geometry = "t2" ;
		t2_field_t1:ogr_field_name = "t1" ;
		t2_field_t1:ogr_field_type = "Real" ;
	double t2_field_t2(t2_node_coordinates) ;
		t2_field_t2:long_name = "Field t2" ;
		t2_field_t2:geometry = "t2" ;
		t2_field_t2:ogr_field_name = "t2" ;
		t2_field_t2:ogr_field_type = "Real" ;

// global attributes:
		:Conventions = "CF-1.8" ;
		:GDAL = "GDAL 3.4.3, released 2022/04/22" ;
		:history = "Tue Aug 16 12:14:25 2022: GDAL Create( t2.nc, ... )" ;
data:

  t2 = _ ;

  t2_coordX = 0, 3 ;

  t2_coordY = 1, 5 ;

  t2_field_t1 = 0.33, 0.32 ;

  t2_field_t2 = 0.04, 0.4 ;
}

second example:
etcdf t1 {
dimensions:
	time = 2 ;
	stations = 2 ;
variables:
	double Precipitation(time, stations) ;
		Precipitation:coordinates = "x y" ;
	double stations(stations) ;
	double time(time) ;
		time:units = "days since 1970-01-01" ;
	double x(stations) ;
		x:axis = "X" ;
	double y(stations) ;
		y:axis = "Y" ;
	double geometry ;
		geometry:geometry_type = "point" ;

// global attributes:
		:Conventions = "CF-1.6" ;
data:

  Precipitation =
   0.33, 0.04,
   0.32, 0.4 ;

  stations = 1, 2 ;

  time = 19114, 19115 ;

  x = 0, 3 ;

  y = 1, 5 ;

  geometry = _ ;
}

From roper.william at gmail.com  Tue Aug 16 04:11:23 2022
From: roper.william at gmail.com (William Roper)
Date: Tue, 16 Aug 2022 12:11:23 +0100
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
In-Reply-To: <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>
References: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
 <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>
Message-ID: <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>

Thanks for the reply Even.

I've run with "--debug on" and I think the interesting bit is:

GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15684,6x73 Dst=686,22448,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15750,4x72 Dst=686,22540,98x92
> WARP: Using 1 threads
> .COG: Reprojecting source dataset: end
> GTiff: ScanDirectories()
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.msk)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.MSK)=0
>  response_code=404
> GDAL: GDALDefaultOverviews::OverviewScan()
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.ovr)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.OVR)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.aux)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.AUX)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.aux)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.AUX)=0
>  response_code=404
> COG: Generating overviews of the imagery: start
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.ovr.tmp)=0
>  response_code=404
> S3: /vsis3/my-bucket/test_batch_output/test.tif.ovr.tmp is not a object
> GTiff: File being created as a BigTIFF.
> ERROR 1: Only read-only mode is supported for /vsicurl
> COG: Generating overviews of the imagery: end
> S3: UploadId:
> Rok8InTcYwFMoHYA3kVAwlLDycIxreczdLSODBpLA5exAshfS46ZclK.3.2.a_EAAY3vhoJQnc7DsVk9X3pzsRetSAZ.oc39kDwRe755ftroj5rH9BRXLPaNCcnuTGZP
> S3: Etag for part 1 is "52647419376831771b40964bad80d86e"
> S3: Etag for part 2 is "4bea862d0878bbe1dbe717aa8cea48c8"
> S3: Etag for part 3 is "5ba3c9e4ea924f06cdc2ee614e5627c0"
> S3: Etag for part 4 is "07e53a2e07a2575d1b2d89cf8040ebe8"
> GDAL:
> GDALClose(/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,
> this=0x55a288913060)
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=207439264
>  response_code=206
> GDAL: GDALClose(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
> GDAL: In GDALDestroy - unloading GDAL shared library.
>

 It looks to me like gdal attempted to write a lot of the tmp files to s3,
rather than locally? the command I used is:

gdal_translate --config AWS_SECRET_ACCESS_KEY <hidden> --config
> AWS_ACCESS_KEY_ID <hidden> --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE
> YES --config CPL_TMPDIR /tmp -of COG -co
> TILING_SCHEME\=GoogleMapsCompatible -co COMPRESS\=DEFLATE -co
> NUM_THREADS\=ALL_CPUS --debug on /vsis3/my-bucket/dtm/test.tif /vsis3/
> my-bucket/test_batch_output/test.tif
>

This is on Ubuntu 22.04 using gdal 3.4.1

The iam user has full control over the bucket, checked with the "aws s3api
get-bucket-acl" command, and I can read and write from the bucket using the
"aws s3" command, so if it's an s3 permissions issue, then I'm failing to
give gdal the necessary info - I understood AWS_SECRET_ACCESS_KEY and
AWS_ACCESS_KEY_ID
were sufficient.

Thanks again for taking a look!
Will



On Tue, 16 Aug 2022 at 08:18, Even Rouault <even.rouault at spatialys.com>
wrote:

> William,
>
> can you add "--debug on" and retry to see if more hints are emitted about
> what's going on.
>
> Even
> Le 15/08/2022 ? 11:45, William Roper a ?crit :
>
> Hi list,
>
> I'm trying to convert a GeoTiff on s3 into a COG, that will also live on
> s3. I'm working on EC2 instances, or fargate containers, because local
> download and upload speeds are a bit slow.
>
> gdalwarp \
>   --config AWS_SECRET_ACCESS_KEY <my-secret-key> \
>   --config AWS_ACCESS_KEY_ID <my-access-key> \
>   --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE YES \
>   --config CPL_TMPDIR /tmp \
>   -of COG
>   -co TILING_SCHEME=GoogleMapsCompatible
>   -co COMPRESS=DEFLATE
>   -co NUM_THREADS=ALL_CPUS
>   /vsis3/my-bucket/original-old-geotif.tif
>   /vsis3/my-bucket/shiny-new-cog.tif
>
>
> And get the following error:
>
> 0...10...20...30...ERROR 1: Only read-only mode is supported for /vsicurl
>
>
> I get the same issue running in a docker container (osgeo/gdal:latest) or
> on an ubuntu EC2 instance with gdal-bin installed with apt  (version
> 3.4.1).
>
> I can work around it by writing the COG to the machine, and then uploading
> to s3, but was wondered what I was doing wrong/not understanding.
>
> Many thanks
> Will
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220816/351ca4cf/attachment-0001.htm>

From roper.william at gmail.com  Tue Aug 16 04:16:15 2022
From: roper.william at gmail.com (William Roper)
Date: Tue, 16 Aug 2022 12:16:15 +0100
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
In-Reply-To: <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>
References: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
 <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>
 <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>
Message-ID: <CAO5tZdNs8NEjQ-V=AWyeZh563O_VJZE0AeQLVEhCM6zUddM=2g@mail.gmail.com>

I've included the rest of the debug below. It starts hitting 404s (I guess
because the objects don't exist) almost straight away:

> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=0
>  response_code=404
> S3: /vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp is not a
> object
>

Complete debug output:

gdal_translate --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE YES
> --config CPL_TMPDIR /tmp -of COG -co TILING_SCHEME\=GoogleMapsCompatible
> -co COMPRESS\=DEFLATE -co NUM_THREADS\=ALL_CPUS --debug on
> /vsis3/my-bucket/dtm/test.tif /vsis3/my-bucket/test_batch_output/test.tif
> HTTP: libcurl/7.81.0 OpenSSL/3.0.2 zlib/1.2.11 brotli/1.0.9 zstd/1.4.8
> libidn2/2.3.2 libpsl/0.21.0 (+libidn2/2.3.2) libssh/0.9.6/openssl/zlib
> nghttp2/1.43.0 librtmp/2.3 OpenLDAP/2.5.12
> S3: Downloading 0-16383 (https://my-bucket.s3.amazonaws.com/dtm/test.tif).
> ..
> S3: Got response_code=206
> S3: Downloading 102776832-102793215 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102907904-102911196 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALOpen(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
> succeeds as GTiff.
> Input file size is 8400, 16400
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif)=0
>  response_code=404
> GTiff: ScanDirectories()
> GDAL: GDALDefaultOverviews::OverviewScan()
> GDAL: Computing area of interest: -4.12725, 53.1714, -4.09403, 53.2088
> COG: Using ZOOM_LEVEL 19
> COG: Reprojecting source dataset: start
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=0
>  response_code=404
> S3: /vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp is not a
> object
> GDAL: Computing area of interest: -4.12725, 53.1714, -4.09403, 53.2088
> GDAL:
> GDALDriver::Create(GTiff,/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,12544,23552,4,Byte,0x55a2886c5a10)
> 0WARP: Copying metadata from first source to destination dataset
> GDALWARP: Defining SKIP_NOSOURCE=YES
> WARP: SetAlphaMax: AlphaMax not set.
> S3: Downloading 102842368-102858751 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 16384-10485759 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDAL_CACHEMAX = 392 MB
> S3: Downloading 10485760-20955135 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102842368-102858751 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102776832-102793215 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 20955136-20971519 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 20971520-21004287 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 21004288-21069823 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 21069824-21200895 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 21200896-21463039 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,0,1045x1762 Dst=0,0,1568x2944
> WARP: Using 2 threads
> S3: Downloading 21463040-21987327 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=977,0,1191x1795 Dst=1568,0,1568x2944
> WARP: Using 2 threads
> S3: Downloading 21987328-23035903 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2101,0,1190x1828 Dst=3136,0,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3224,0,1191x1862 Dst=4704,0,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4348,0,1190x1895 Dst=6272,0,1568x2944
> WARP: Using 2 threads
> S3: Downloading 23035904-25133055 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5471,0,1190x1928 Dst=7840,0,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6595,0,1190x1961 Dst=9408,0,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7718,0,682x1994 Dst=10976,0,1568x2944
> WARP: Using 2 threads
> S3: Downloading 25133056-34684927 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 34684928-44236799 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102842368-102875135 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102776832-102809599 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44236800-44253183 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44253184-44285951 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44285952-44351487 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44351488-44482559 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44482560-44744703 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 44744704-45268991 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 45268992-46317567 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 46317568-48414719 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,1723,982x2143 Dst=0,2944,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=915,1757,1191x2143 Dst=1568,2944,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2038,1790,1191x2143 Dst=3136,2944,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3162,1823,1191x2143 Dst=4704,2944,1568x2944
> WARP: Using 2 threads
> S3: Downloading 48414720-50511871 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4285,1857,1191x2142 Dst=6272,2944,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5409,1890,1191x2142 Dst=7840,2944,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6533,1923,1190x2142 Dst=9408,2944,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7656,1956,744x2142 Dst=10976,2944,1568x2944
> WARP: Using 2 threads
> S3: Downloading 50511872-60030975 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 60030976-69550079 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102858752-102875135 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102793216-102809599 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,3828,920x2143 Dst=0,5888,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=852,3861,1191x2143 Dst=1568,5888,1568x2944
> WARP: Using 2 threads
> S3: Downloading 69550080-69926911 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1976,3895,1191x2142 Dst=3136,5888,1568x2944
> 10WARP: Using 2 threads
> S3: Downloading 69926912-70680575 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3100,3928,1190x2143 Dst=4704,5888,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4223,3961,1191x2143 Dst=6272,5888,1568x2944
> WARP: Using 2 threads
> S3: Downloading 70680576-72187903 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5347,3994,1191x2143 Dst=7840,5888,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6471,4027,1190x2143 Dst=9408,5888,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7594,4060,806x2143 Dst=10976,5888,1568x2944
> WARP: Using 2 threads
> S3: Downloading 72187904-82362367 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 82362368-92536831 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102858752-102891519 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102793216-102825983 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,5932,857x2144 Dst=0,8832,1568x2944
> WARP: Using 2 threads
> S3: Downloading 92536832-92782591 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=790,5966,1191x2143 Dst=1568,8832,1568x2944
> WARP: Using 2 threads
> S3: Downloading 92782592-93274111 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1913,5999,1192x2143 Dst=3136,8832,1568x2944
> .WARP: Using 2 threads
> S3: Downloading 93274112-94257151 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3037,6032,1191x2143 Dst=4704,8832,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4161,6066,1191x2143 Dst=6272,8832,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5285,6099,1191x2143 Dst=7840,8832,1568x2944
> WARP: Using 2 threads
> S3: Downloading 94257152-96223231 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6409,6132,1190x2143 Dst=9408,8832,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7533,6165,867x2143 Dst=10976,8832,1568x2944
> WARP: Using 2 threads
> S3: Downloading 96223232-101171199 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,8037,795x2144 Dst=0,11776,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=727,8071,1191x2143 Dst=1568,11776,1568x2944
> WARP: Using 2 threads
> S3: Downloading 101171200-102793215 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1851,8104,1191x2143 Dst=3136,11776,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2975,8137,1191x2144 Dst=4704,11776,1568x2944
> 20WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4099,8170,1191x2144 Dst=6272,11776,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5223,8204,1191x2143 Dst=7840,11776,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6347,8237,1191x2143 Dst=9408,11776,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7471,8270,929x2143 Dst=10976,11776,1568x2944
> .WARP: Using 2 threads
> S3: Downloading 102891520-102907903 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102825984-102842367 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,10142,732x2144 Dst=0,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=665,10176,1191x2143 Dst=1568,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1789,10209,1191x2144 Dst=3136,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2913,10242,1191x2144 Dst=4704,14720,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=4037,10276,1191x2143 Dst=6272,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5161,10309,1191x2143 Dst=7840,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6285,10342,1191x2143 Dst=9408,14720,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7409,10375,991x2143 Dst=10976,14720,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,12248,670x2143 Dst=0,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=602,12281,1192x2144 Dst=1568,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1726,12314,1192x2144 Dst=3136,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2850,12348,1192x2143 Dst=4704,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3975,12381,1191x2144 Dst=6272,17664,1568x2944
> 30WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5099,12414,1191x2144 Dst=7840,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6223,12447,1191x2144 Dst=9408,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7347,12480,1053x2144 Dst=10976,17664,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,14353,607x1091 Dst=0,20608,1568x1472
> .WARP: Using 2 threads
> S3: Downloading 102907904-102911196 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> S3: Downloading 102842368-102858751 (
> https://my-bucket.s3.amazonaws.com/dtm/test.tif)...
> S3: Got response_code=206
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=540,14386,1191x2014 Dst=1568,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=1664,14420,1191x1980 Dst=3136,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=2788,14453,1192x1947 Dst=4704,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=3912,14486,1192x1914 Dst=6272,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=5037,14520,1191x1880 Dst=7840,20608,1568x2944
> .WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=6161,14553,1191x1847 Dst=9408,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=7285,14586,1115x1814 Dst=10976,20608,1568x2944
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15421,14x72 Dst=686,22080,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15423,576x977 Dst=784,22080,784x1472
> WARP: Using 2 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15486,12x73 Dst=686,22172,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15552,10x73 Dst=686,22264,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15618,8x73 Dst=686,22356,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15684,6x73 Dst=686,22448,98x92
> WARP: Using 1 threads
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
> Src=0,15750,4x72 Dst=686,22540,98x92
> WARP: Using 1 threads
> .COG: Reprojecting source dataset: end
> GTiff: ScanDirectories()
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.msk)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.MSK)=0
>  response_code=404
> GDAL: GDALDefaultOverviews::OverviewScan()
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.ovr)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.OVR)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.aux)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.AUX)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.aux)=0
>  response_code=404
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.AUX)=0
>  response_code=404
> COG: Generating overviews of the imagery: start
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.ovr.tmp)=0
>  response_code=404
> S3: /vsis3/my-bucket/test_batch_output/test.tif.ovr.tmp is not a object
> GTiff: File being created as a BigTIFF.
> ERROR 1: Only read-only mode is supported for /vsicurl
> COG: Generating overviews of the imagery: end
> S3: UploadId:
> Rok8InTcYwFMoHYA3kVAwlLDycIxreczdLSODBpLA5exAshfS46ZclK.3.2.a_EAAY3vhoJQnc7DsVk9X3pzsRetSAZ.oc39kDwRe755ftroj5rH9BRXLPaNCcnuTGZP
> S3: Etag for part 1 is "52647419376831771b40964bad80d86e"
> S3: Etag for part 2 is "4bea862d0878bbe1dbe717aa8cea48c8"
> S3: Etag for part 3 is "5ba3c9e4ea924f06cdc2ee614e5627c0"
> S3: Etag for part 4 is "07e53a2e07a2575d1b2d89cf8040ebe8"
> GDAL:
> GDALClose(/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,
> this=0x55a288913060)
> S3: GetFileSize(
> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=207439264
>  response_code=206
> GDAL: GDALClose(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
> GDAL: In GDALDestroy - unloading GDAL shared library.
>

On Tue, 16 Aug 2022 at 12:11, William Roper <roper.william at gmail.com> wrote:

> Thanks for the reply Even.
>
> I've run with "--debug on" and I think the interesting bit is:
>
> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
>> Src=0,15684,6x73 Dst=686,22448,98x92
>> WARP: Using 1 threads
>> GDAL: GDALWarpKernel()::GWKCubicNoMasksOrDstDensityOnlyByte()
>> Src=0,15750,4x72 Dst=686,22540,98x92
>> WARP: Using 1 threads
>> .COG: Reprojecting source dataset: end
>> GTiff: ScanDirectories()
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.msk)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.MSK)=0
>>  response_code=404
>> GDAL: GDALDefaultOverviews::OverviewScan()
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.ovr)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.OVR)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.aux)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.AUX)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.aux)=0
>>  response_code=404
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp.AUX)=0
>>  response_code=404
>> COG: Generating overviews of the imagery: start
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.ovr.tmp)=0
>>  response_code=404
>> S3: /vsis3/my-bucket/test_batch_output/test.tif.ovr.tmp is not a object
>> GTiff: File being created as a BigTIFF.
>> ERROR 1: Only read-only mode is supported for /vsicurl
>> COG: Generating overviews of the imagery: end
>> S3: UploadId:
>> Rok8InTcYwFMoHYA3kVAwlLDycIxreczdLSODBpLA5exAshfS46ZclK.3.2.a_EAAY3vhoJQnc7DsVk9X3pzsRetSAZ.oc39kDwRe755ftroj5rH9BRXLPaNCcnuTGZP
>> S3: Etag for part 1 is "52647419376831771b40964bad80d86e"
>> S3: Etag for part 2 is "4bea862d0878bbe1dbe717aa8cea48c8"
>> S3: Etag for part 3 is "5ba3c9e4ea924f06cdc2ee614e5627c0"
>> S3: Etag for part 4 is "07e53a2e07a2575d1b2d89cf8040ebe8"
>> GDAL:
>> GDALClose(/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,
>> this=0x55a288913060)
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=207439264
>>  response_code=206
>> GDAL: GDALClose(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
>> GDAL: In GDALDestroy - unloading GDAL shared library.
>>
>
>  It looks to me like gdal attempted to write a lot of the tmp files to s3,
> rather than locally? the command I used is:
>
> gdal_translate --config AWS_SECRET_ACCESS_KEY <hidden> --config
>> AWS_ACCESS_KEY_ID <hidden> --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE
>> YES --config CPL_TMPDIR /tmp -of COG -co
>> TILING_SCHEME\=GoogleMapsCompatible -co COMPRESS\=DEFLATE -co
>> NUM_THREADS\=ALL_CPUS --debug on /vsis3/my-bucket/dtm/test.tif /vsis3/
>> my-bucket/test_batch_output/test.tif
>>
>
> This is on Ubuntu 22.04 using gdal 3.4.1
>
> The iam user has full control over the bucket, checked with the "aws s3api
> get-bucket-acl" command, and I can read and write from the bucket using the
> "aws s3" command, so if it's an s3 permissions issue, then I'm failing to
> give gdal the necessary info - I understood AWS_SECRET_ACCESS_KEY and AWS_ACCESS_KEY_ID
> were sufficient.
>
> Thanks again for taking a look!
> Will
>
>
>
> On Tue, 16 Aug 2022 at 08:18, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> William,
>>
>> can you add "--debug on" and retry to see if more hints are emitted about
>> what's going on.
>>
>> Even
>> Le 15/08/2022 ? 11:45, William Roper a ?crit :
>>
>> Hi list,
>>
>> I'm trying to convert a GeoTiff on s3 into a COG, that will also live on
>> s3. I'm working on EC2 instances, or fargate containers, because local
>> download and upload speeds are a bit slow.
>>
>> gdalwarp \
>>   --config AWS_SECRET_ACCESS_KEY <my-secret-key> \
>>   --config AWS_ACCESS_KEY_ID <my-access-key> \
>>   --config CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE YES \
>>   --config CPL_TMPDIR /tmp \
>>   -of COG
>>   -co TILING_SCHEME=GoogleMapsCompatible
>>   -co COMPRESS=DEFLATE
>>   -co NUM_THREADS=ALL_CPUS
>>   /vsis3/my-bucket/original-old-geotif.tif
>>   /vsis3/my-bucket/shiny-new-cog.tif
>>
>>
>> And get the following error:
>>
>> 0...10...20...30...ERROR 1: Only read-only mode is supported for /vsicurl
>>
>>
>> I get the same issue running in a docker container (osgeo/gdal:latest) or
>> on an ubuntu EC2 instance with gdal-bin installed with apt  (version
>> 3.4.1).
>>
>> I can work around it by writing the COG to the machine, and then
>> uploading to s3, but was wondered what I was doing wrong/not understanding.
>>
>> Many thanks
>> Will
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220816/f2ffa88a/attachment-0001.htm>

From even.rouault at spatialys.com  Tue Aug 16 06:05:16 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Aug 2022 15:05:16 +0200
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
In-Reply-To: <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>
References: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
 <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>
 <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>
Message-ID: <26d06a8f-b2f2-02e3-3d29-784de369b773@spatialys.com>

William,
>
>     COG: Generating overviews of the imagery: start
>     S3:
>     GetFileSize(https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.ovr.tmp)=0
>     ?response_code=404
>     S3: /vsis3/my-bucket/test_batch_output/test.tif.ovr.tmp is not a
>     object
>     GTiff: File being created as a BigTIFF.
>     ERROR 1: Only read-only mode is supported for /vsicurl
>     COG: Generating overviews of the imagery: end
>     S3: UploadId:
>     Rok8InTcYwFMoHYA3kVAwlLDycIxreczdLSODBpLA5exAshfS46ZclK.3.2.a_EAAY3vhoJQnc7DsVk9X3pzsRetSAZ.oc39kDwRe755ftroj5rH9BRXLPaNCcnuTGZP
>     S3: Etag for part 1 is "52647419376831771b40964bad80d86e"
>     S3: Etag for part 2 is "4bea862d0878bbe1dbe717aa8cea48c8"
>     S3: Etag for part 3 is "5ba3c9e4ea924f06cdc2ee614e5627c0"
>     S3: Etag for part 4 is "07e53a2e07a2575d1b2d89cf8040ebe8"
>     GDAL:
>     GDALClose(/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,
>     this=0x55a288913060)
>     S3:
>     GetFileSize(https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=207439264
>     ?response_code=206
>     GDAL: GDALClose(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
>     GDAL: In GDALDestroy - unloading GDAL shared library.
>
>
> ?It looks to me like gdal attempted to write a lot of the tmp files to 
> s3, rather than locally? the command I used is:

Yes exactly this is an issue with the temporary file created when 
computing overviews, before integrating them to the final COG file. I've 
tracked this issue at https://github.com/OSGeo/gdal/issues/6205 . I 
should be able to look at fixing that soon

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220816/8fc15226/attachment.htm>

From roper.william at gmail.com  Tue Aug 16 06:49:20 2022
From: roper.william at gmail.com (William Roper)
Date: Tue, 16 Aug 2022 14:49:20 +0100
Subject: [gdal-dev] Failing to write to s3 using GTiff driver.
In-Reply-To: <26d06a8f-b2f2-02e3-3d29-784de369b773@spatialys.com>
References: <CAO5tZdOyqKD12S+6JwCdmXAPJqg7N+o3tnhVBN7xQ+DOGM8XQA@mail.gmail.com>
 <b655cec9-714f-92ec-6b7f-2514fccec1f1@spatialys.com>
 <CAO5tZdNwLto9Y0yD1ufJGXNwMsqEvUEwt+qs3OLGrChQApABtg@mail.gmail.com>
 <26d06a8f-b2f2-02e3-3d29-784de369b773@spatialys.com>
Message-ID: <CAO5tZdM++O5=2U5FbPVT9H+svpietAvQjUnx_-4oUx7CdbFxJA@mail.gmail.com>

Thanks for helping track it down!

On Tue, 16 Aug 2022 at 14:05, Even Rouault <even.rouault at spatialys.com>
wrote:

> William,
>
> COG: Generating overviews of the imagery: start
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.ovr.tmp)=0
>>  response_code=404
>> S3: /vsis3/my-bucket/test_batch_output/test.tif.ovr.tmp is not a object
>> GTiff: File being created as a BigTIFF.
>> ERROR 1: Only read-only mode is supported for /vsicurl
>> COG: Generating overviews of the imagery: end
>> S3: UploadId:
>> Rok8InTcYwFMoHYA3kVAwlLDycIxreczdLSODBpLA5exAshfS46ZclK.3.2.a_EAAY3vhoJQnc7DsVk9X3pzsRetSAZ.oc39kDwRe755ftroj5rH9BRXLPaNCcnuTGZP
>> S3: Etag for part 1 is "52647419376831771b40964bad80d86e"
>> S3: Etag for part 2 is "4bea862d0878bbe1dbe717aa8cea48c8"
>> S3: Etag for part 3 is "5ba3c9e4ea924f06cdc2ee614e5627c0"
>> S3: Etag for part 4 is "07e53a2e07a2575d1b2d89cf8040ebe8"
>> GDAL:
>> GDALClose(/vsis3/my-bucket/test_batch_output/test.tif.warped.tif.tmp,
>> this=0x55a288913060)
>> S3: GetFileSize(
>> https://my-bucket.s3.amazonaws.com/test_batch_output/test.tif.warped.tif.tmp)=207439264
>>  response_code=206
>> GDAL: GDALClose(/vsis3/my-bucket/dtm/test.tif, this=0x55a2882e8570)
>> GDAL: In GDALDestroy - unloading GDAL shared library.
>>
>
>  It looks to me like gdal attempted to write a lot of the tmp files to s3,
> rather than locally? the command I used is:
>
> Yes exactly this is an issue with the temporary file created when
> computing overviews, before integrating them to the final COG file. I've
> tracked this issue at https://github.com/OSGeo/gdal/issues/6205 . I
> should be able to look at fixing that soon
>
> Even
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220816/04839b04/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 16 12:57:33 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Aug 2022 21:57:33 +0200
Subject: [gdal-dev] reading/writing geometries using GDAL's MDA API
In-Reply-To: <ac4ed9e5-d2b1-0dde-9d35-8ddccf6a0dd0@uni-muenster.de>
References: <ac4ed9e5-d2b1-0dde-9d35-8ddccf6a0dd0@uni-muenster.de>
Message-ID: <178320f5-502e-0d1d-be92-f0b872f87ffd@spatialys.com>

Edzer,

The currently support data types for variables (including indexing 
variables of dimensions) or attributes are either numeric (byte, int, 
float, etc.), strings or compound data types of previous types. From a 
quick thinking, I can't think of strong reasons why OGRGeometry couldn't 
be added, baring some changes in GDAL core (looking for specificities of 
string support should give good hints where to make changes).

That said, it would probably only used by the netCDF driver, so it is a 
bit hard to justify to add a new abstraction for just one user 
(user=driver). And implementing that in the netCDF driver wouldn't 
necessarily be easy as it is already quite complicated and I'm not sure 
how reusable the part that deal with SG geometries is. On your examples, 
it is not immediately obvious to me how the driver would expose a 
OGRGeometry data type. In the first one, it would have to synthesize a 
t2_coord variable from t2_coordX and t2_coordY ? And on the second one a 
xy pseudo variable from x and y ? But it would be a bit convoluted for 
the users of the multi-dimensional indexed Precipitation to figure out 
that stations has a variable indexed by stations that has geometries.

So all in all, I believe it should be doable but the ratio 
benefit/effort doesn't seem to me to be super favorable.

Even

Le 16/08/2022 ? 12:47, Edzer Pebesma a ?crit?:
> I've been using GDAL's C++ multidimensional array (MDA) API lately to 
> read and write data cubes from R - excellent work! I was looking into 
> support for vector data cubes, multidimensional arrays with a single 
> dimension associated with a set of geometries.
>
> What we can do is read and write dimensions, variables, and 
> attributes, but what (as far as I can tell) is missing is to read and 
> write OGRGeometry variables, using the CF specification for geometry 
> [1], which is supported by the NetCDF vector driver. Would it be 
> feasible to read and write CF-compliant geometries from 
> multidimensional arrays through the MDA API? Right now software 
> writers have to sort this out themselves, which is straightforward for 
> points but cludgy for polygons. Another issue is crs handling which I 
> think could be done gracefully using the OGRGeometry interface.
>
> As a minimal data example: I added two ncdump files below for two time 
> instances and two POINT geometries. The first can be read and written 
> by the OGR API, but is a one-dimensional array that lacks the time 
> information of time series (time distributed over attributes/columns). 
> The second is a 2 x 2 multidimensional array with the time 
> information. GDAL's MDA API can read it but doesn't recognize 
> geometries, GDAL's OGR API cannot read it (obviously). I'd like to be 
> able to read (and write) the station dimension of the second one as an 
> OGRGeometry, for points, lines or polygons.
>
> [1] 
> https://cfconventions.org/Data/cf-conventions/cf-conventions-1.9/cf-conventions.html#geometries

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From edzer.pebesma at uni-muenster.de  Wed Aug 17 07:35:31 2022
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 17 Aug 2022 16:35:31 +0200
Subject: [gdal-dev] reading/writing geometries using GDAL's MDA API
In-Reply-To: <178320f5-502e-0d1d-be92-f0b872f87ffd@spatialys.com>
References: <ac4ed9e5-d2b1-0dde-9d35-8ddccf6a0dd0@uni-muenster.de>
 <178320f5-502e-0d1d-be92-f0b872f87ffd@spatialys.com>
Message-ID: <ba65aa77-996c-62e4-7fe0-8556b55b1bf0@uni-muenster.de>

Even, thanks for the thoughtful answer,

On 16/08/2022 21:57, Even Rouault wrote:
> Edzer,
> 
> The currently support data types for variables (including indexing 
> variables of dimensions) or attributes are either numeric (byte, int, 
> float, etc.), strings or compound data types of previous types. From a 
> quick thinking, I can't think of strong reasons why OGRGeometry couldn't 
> be added, baring some changes in GDAL core (looking for specificities of 
> string support should give good hints where to make changes).
> 
> That said, it would probably only used by the netCDF driver, so it is a 
> bit hard to justify to add a new abstraction for just one user 
> (user=driver). And implementing that in the netCDF driver wouldn't 
> necessarily be easy as it is already quite complicated and I'm not sure 
> how reusable the part that deal with SG geometries is. 

I think NetCDF + Zarr; the NetCDF community seems to move to Zarr at 
large scale, I have the impression that they keep the CDL / NetCDF data 
model - the one abstracted in the MDA API. It looks like CMIP6 will be 
largely distributed in Zarr on cloud storage forms, see 
https://pangeo-data.github.io/pangeo-cmip6-cloud/overview.html. I would 
be surprised if the Zarr folks would come with a definition for 
geometries different from CF if CF gets used; building this support in 
GDAL would be an incentive for them to not do so.

> On your examples, 
> it is not immediately obvious to me how the driver would expose a 
> OGRGeometry data type. In the first one, it would have to synthesize a 
> t2_coord variable from t2_coordX and t2_coordY ? And on the second one a 
> xy pseudo variable from x and y ? But it would be a bit convoluted for 
> the users of the multi-dimensional indexed Precipitation to figure out 
> that stations has a variable indexed by stations that has geometries.

Geometry sets can indeed best be seen as synthetic variables that are 
associated with a dimension (t2_node_coordinates in the first example of 
my previous email, station in the second).

To find the OGRGeometry dimension,
- look for a variable v that has node_coordinates as attribute
- if v:geometry_type == "point", then
    - look for a variable w that has 'w:axis = "X"' as attribute
    - the dimension of w is the OGRGeometry dimension
- if v:geometry_type == "polygon" or "line", then
    - look for the variable mentioned in v:node_count; the dimension
      associated with this variable is the OGRGeometry dimension

GetOGRGeometries() could be a member function of GDALDimension, 
returning NULL if no CF-compliant geometries can be constructed 
associated with the dimension.

At the end of this email are the two same examples but now with polygons 
rather than points.

(in the second example I posted earlier a 'geometry:node_coordinates = 
"x y";' is missing)

> 
> So all in all, I believe it should be doable but the ratio 
> benefit/effort doesn't seem to me to be super favorable.

I see your point, for me it's a chicken and egg problem. How do we now 
handle the output when querying a data cube with monthly temperature 
projections for the next 30 years for a set of climate models and a set 
of scenarios at a set of given point locations, or get the maximum 
temperature over a set of given regions? I think there's a big gap now 
between the GIS community and the modelling communities; your MDA API 
helps closing it, and we can do better.

I'll talk more about this next week Thu at our FOSS4G presentation, and 
hope to meet you there IRL!

Many regards,

> 
> Even
> 
> Le 16/08/2022 ? 12:47, Edzer Pebesma a ?crit?:
>> I've been using GDAL's C++ multidimensional array (MDA) API lately to 
>> read and write data cubes from R - excellent work! I was looking into 
>> support for vector data cubes, multidimensional arrays with a single 
>> dimension associated with a set of geometries.
>>
>> What we can do is read and write dimensions, variables, and 
>> attributes, but what (as far as I can tell) is missing is to read and 
>> write OGRGeometry variables, using the CF specification for geometry 
>> [1], which is supported by the NetCDF vector driver. Would it be 
>> feasible to read and write CF-compliant geometries from 
>> multidimensional arrays through the MDA API? Right now software 
>> writers have to sort this out themselves, which is straightforward for 
>> points but cludgy for polygons. Another issue is crs handling which I 
>> think could be done gracefully using the OGRGeometry interface.
>>
>> As a minimal data example: I added two ncdump files below for two time 
>> instances and two POINT geometries. The first can be read and written 
>> by the OGR API, but is a one-dimensional array that lacks the time 
>> information of time series (time distributed over attributes/columns). 
>> The second is a 2 x 2 multidimensional array with the time 
>> information. GDAL's MDA API can read it but doesn't recognize 
>> geometries, GDAL's OGR API cannot read it (obviously). I'd like to be 
>> able to read (and write) the station dimension of the second one as an 
>> OGRGeometry, for points, lines or polygons.
>>
>> [1] 
>> https://cfconventions.org/Data/cf-conventions/cf-conventions-1.9/cf-conventions.html#geometries 
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

First, using OGR:
netcdf t2 {
dimensions:
	t2_node_coordinates = 13 ;
	t2_node_count = 2 ;
	t2_part_node_count = 3 ;
variables:
	float t2 ;
		t2:geometry_type = "polygon" ;
		t2:node_coordinates = "t2_coordX t2_coordY" ;
		t2:node_count = "t2_node_count" ;
		t2:part_node_count = "t2_part_node_count" ;
		t2:interior_ring = "t2_interior_ring" ;
	int t2_node_count(t2_node_count) ;
	int t2_part_node_count(t2_part_node_count) ;
	int t2_interior_ring(t2_part_node_count) ;
	double t2_coordX(t2_node_coordinates) ;
		t2_coordX:axis = "X" ;
	double t2_coordY(t2_node_coordinates) ;
		t2_coordY:axis = "Y" ;
	double t2_field_t1(t2_node_count) ;
		t2_field_t1:long_name = "Field t1" ;
		t2_field_t1:geometry = "t2" ;
		t2_field_t1:ogr_field_name = "t1" ;
		t2_field_t1:ogr_field_type = "Real" ;
	double t2_field_t2(t2_node_count) ;
		t2_field_t2:long_name = "Field t2" ;
		t2_field_t2:geometry = "t2" ;
		t2_field_t2:ogr_field_name = "t2" ;
		t2_field_t2:ogr_field_type = "Real" ;

// global attributes:
		:Conventions = "CF-1.8" ;
		:GDAL = "GDAL 3.4.3, released 2022/04/22" ;
		:history = "Wed Aug 17 15:59:23 2022: GDAL Create( t2.nc, ... )" ;
data:

  t2 = _ ;

  t2_node_count = 8, 5 ;

  t2_part_node_count = 4, 4, 5 ;

  t2_interior_ring = 0, 1, 0 ;

  t2_coordX = 0, 1, 1, 0, 0.5, 0.7, 0.7, 0.5, 3, 4, 4, 3, 3 ;

  t2_coordY = 0, 0, 1, 0, 0.5, 0.5, 0.7, 0.5, 3, 3, 4, 4, 3 ;

  t2_field_t1 = 0.33, 0.32 ;

  t2_field_t2 = 0.04, 0.4 ;
}


Second: using MDA
netcdf t1 {
dimensions:
	part = 3 ;
	node = 13 ;
	time = 2 ;
	stations = 2 ;
variables:
	double Precipitation(time, stations) ;
		Precipitation:coordinates = "x y" ;
	double stations(stations) ;
	double time(time) ;
		time:units = "days since 1970-01-01" ;
	double node(node) ;
	double x(node) ;
		x:axis = "X" ;
	double y(node) ;
		y:axis = "Y" ;
	double node_count(stations) ;
	double part_node_count(part) ;
	double interior_ring(part) ;
	double geometry ;
		geometry:geometry_type = "polygon" ;
		geometry:node_count = "node_count" ;
		geometry:node_coordinates = "x y" ;
		geometry:part_node_count = "part_node_count" ;
		geometry:interior_ring = "interior_ring" ;

// global attributes:
		:Conventions = "CF-1.6" ;
data:

  Precipitation =
   0.33, 0.04,
   0.32, 0.4 ;

  stations = 1, 2 ;

  time = 19114, 19115 ;

  node = 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13 ;

  x = 0, 1, 1, 0, 0.5, 0.7, 0.7, 0.5, 3, 4, 4, 3, 3 ;

  y = 0, 0, 1, 0, 0.5, 0.5, 0.7, 0.5, 3, 3, 4, 4, 3 ;

  node_count = 8, 5 ;

  part_node_count = 4, 4, 5 ;

  interior_ring = 0, 1, 0 ;

  geometry = _ ;
}


From christophe.delepine at thalesgroup.com  Thu Aug 18 08:03:26 2022
From: christophe.delepine at thalesgroup.com (DELEPINE Christophe)
Date: Thu, 18 Aug 2022 15:03:26 +0000
Subject: [gdal-dev] Creating a vector mbtile with several layers
In-Reply-To: <1aa2bf7c-04dc-a78c-3eef-dda686c7fbdc@spatialys.com>
References: <5cd13da6909e46d7a4d2a4ff8849f48e@thalesgroup.com>
 <324fa6f4-bd65-a5c4-7917-31207af0ad65@spatialys.com>
 <80e710b23c24454d8e2cdbf72a9be29e@thalesgroup.com>
 <1aa2bf7c-04dc-a78c-3eef-dda686c7fbdc@spatialys.com>
Message-ID: <005e9e716e1f47aa9103b0bc8aabc127@thalesgroup.com>

Hello



I want to implement a vector mbtile viewer and am considering using gdal to extract the data.

I am wondering if gdal public API allows to :



-   Retrieve metadata such as :

o   the min and max zoom levels for each layer

o   the min and max tile indexes for each layer and zoom level

-   Extract efficiently all the features of a given tile (with specific x/y indexes) at a given zoom level



I am currently reading the MBTILES implementation source code (mbtilesdataset.cpp) and there seems to be quite a lot of tricks internally (for instance with SetSpatialFilter)



Would somebody have an example using gdal to extract efficiently a tile for a given layer, given tile index and given zoom ?



Regards

Christophe


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220818/d086c0a0/attachment.htm>

From e11904212 at student.tuwien.ac.at  Fri Aug 26 04:56:42 2022
From: e11904212 at student.tuwien.ac.at (Martin)
Date: Fri, 26 Aug 2022 13:56:42 +0200
Subject: [gdal-dev] JPEG2000 via range request
In-Reply-To: <5da239ca-e873-0f31-96dc-c7093eecc0ae@student.tuwien.ac.at>
References: <5da239ca-e873-0f31-96dc-c7093eecc0ae@student.tuwien.ac.at>
Message-ID: <998636ca-b73a-a2df-da09-49db3f2d5b7e@student.tuwien.ac.at>

Hi,

I want to process JP2 data via vsicurl. Which works so far.
Unfortunately hundreds of requests are sent, even if only the data of 
one tile is required.
I understand that due to the structure of a JP2 file multiple requests 
are necessary. But it looks like GDAL is searching every single tile 
(resulting in ~120 requests).

Is there a way to reduce the number of requests?

I have already tried the JP2ECW-ERDAS driver, same result.

Do I have to configure GDAL in a certain way?

cmd for request:

 ??? #!/bin/bash

 ??? export GDAL_DISABLE_READDIR_ON_OPEN="YES"
 ??? export CPL_VSIL_CURL_ALLOWED_EXTENSIONS="jp2"
 ??? export CPL_CURL_VERBOSE="YES"
 ??? export GDAL_HTTP_MERGE_CONSECUTIVE_RANGES="YES"

 ??? gdal_translate --debug ON -srcwin 0 0 256 256 
/vsicurl/http://localhost:8083/T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2 
./out_subWin.tif

What options do I need to specify when creating the JP2 file to support 
GDAL?

Currently I use the following options:

 ??? #!/bin/bash

 ??? gdal_translate \
 ? ??? ? -of JP2OpenJPEG \
 ?? ???? -co QUALITY=100 \
 ??? ? ? -co TLM=YES \
 ?? ???? -co PLT=YES \
 ? ??? ? -co PROGRESSION=LRCP \
 ?? ???? -co WRITE_METADATA=YES \
 ??? ? ? ../test_data/T33UWP_20220515T100031_TCI_10m.tif \
 ??? ? ? ./T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2

Some logs:

[gdal degug output](https://pastebin.com/vTf7tjLJ)
[nginx logs](https://pastebin.com/8bWW15Tp)
[gdalinfo](https://pastebin.com/HWSmypEQ)
[opj_dump](https://pastebin.com/rdYbHEnY)
[kdu_jp2info](https://pastebin.com/atVUfeVx)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220826/a34348b4/attachment.htm>

From schwehr at gmail.com  Fri Aug 26 09:12:23 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 26 Aug 2022 09:12:23 -0700
Subject: [gdal-dev] JPEG2000 via range request
In-Reply-To: <998636ca-b73a-a2df-da09-49db3f2d5b7e@student.tuwien.ac.at>
References: <5da239ca-e873-0f31-96dc-c7093eecc0ae@student.tuwien.ac.at>
 <998636ca-b73a-a2df-da09-49db3f2d5b7e@student.tuwien.ac.at>
Message-ID: <CACmBxyu2Pkmrxdy6pQU1DDnw4O7=Qk_wr1TvWiEdceOPDmWtJA@mail.gmail.com>

It costs, but you could try this:

https://gdal.org/drivers/raster/jpipkak.html

I have kakadu, but I have never tried the jpip functionality so I can't say
how well it works.

On Fri, Aug 26, 2022, 5:03 AM Martin <e11904212 at student.tuwien.ac.at> wrote:

> Hi,
>
> I want to process JP2 data via vsicurl. Which works so far.
> Unfortunately hundreds of requests are sent, even if only the data of one
> tile is required.
> I understand that due to the structure of a JP2 file multiple requests are
> necessary. But it looks like GDAL is searching every single tile
> (resulting in ~120 requests).
>
> Is there a way to reduce the number of requests?
>
> I have already tried the JP2ECW-ERDAS driver, same result.
>
> Do I have to configure GDAL in a certain way?
>
> cmd for request:
>
>     #!/bin/bash
>
>     export GDAL_DISABLE_READDIR_ON_OPEN="YES"
>     export CPL_VSIL_CURL_ALLOWED_EXTENSIONS="jp2"
>     export CPL_CURL_VERBOSE="YES"
>     export GDAL_HTTP_MERGE_CONSECUTIVE_RANGES="YES"
>
>     gdal_translate --debug ON -srcwin 0 0 256 256 /vsicurl/
> http://localhost:8083/T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2
> ./out_subWin.tif
>
> What options do I need to specify when creating the JP2 file to support
> GDAL?
>
> Currently I use the following options:
>
>     #!/bin/bash
>
>     gdal_translate \
>         -of JP2OpenJPEG \
>         -co QUALITY=100 \
>         -co TLM=YES \
>         -co PLT=YES \
>         -co PROGRESSION=LRCP \
>         -co WRITE_METADATA=YES \
>         ../test_data/T33UWP_20220515T100031_TCI_10m.tif \
>         ./T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2
>
> Some logs:
>
> [gdal degug output](https://pastebin.com/vTf7tjLJ)
> [nginx logs](https://pastebin.com/8bWW15Tp)
> [gdalinfo](https://pastebin.com/HWSmypEQ)
> [opj_dump](https://pastebin.com/rdYbHEnY)
> [kdu_jp2info](https://pastebin.com/atVUfeVx)
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220826/7a50bf70/attachment-0001.htm>

From norman.barker at gmail.com  Fri Aug 26 09:44:53 2022
From: norman.barker at gmail.com (Norman Barker)
Date: Fri, 26 Aug 2022 17:44:53 +0100
Subject: [gdal-dev] JPEG2000 via range request
In-Reply-To: <CACmBxyu2Pkmrxdy6pQU1DDnw4O7=Qk_wr1TvWiEdceOPDmWtJA@mail.gmail.com>
References: <5da239ca-e873-0f31-96dc-c7093eecc0ae@student.tuwien.ac.at>
 <998636ca-b73a-a2df-da09-49db3f2d5b7e@student.tuwien.ac.at>
 <CACmBxyu2Pkmrxdy6pQU1DDnw4O7=Qk_wr1TvWiEdceOPDmWtJA@mail.gmail.com>
Message-ID: <CAN_Dn-EV0KYGSBrJ9ap3tE3ihR7+x7v=-b2V0FyHZjV_DMUy4w@mail.gmail.com>

I wrote the original jpipkak driver years ago and it a driver I would
suggest for deprecation but I am no longer involved in j2k development to
know how much it is being used.

You will need a jpip server to use the jpip client. Wavelets are different
to cogs and you will get the benefits of progressive display.

Norman


On Fri, Aug 26, 2022, 5:12 PM Kurt Schwehr <schwehr at gmail.com> wrote:

> It costs, but you could try this:
>
> https://gdal.org/drivers/raster/jpipkak.html
>
> I have kakadu, but I have never tried the jpip functionality so I can't
> say how well it works.
>
> On Fri, Aug 26, 2022, 5:03 AM Martin <e11904212 at student.tuwien.ac.at>
> wrote:
>
>> Hi,
>>
>> I want to process JP2 data via vsicurl. Which works so far.
>> Unfortunately hundreds of requests are sent, even if only the data of one
>> tile is required.
>> I understand that due to the structure of a JP2 file multiple requests
>> are necessary. But it looks like GDAL is searching every single tile
>> (resulting in ~120 requests).
>>
>> Is there a way to reduce the number of requests?
>>
>> I have already tried the JP2ECW-ERDAS driver, same result.
>>
>> Do I have to configure GDAL in a certain way?
>>
>> cmd for request:
>>
>>     #!/bin/bash
>>
>>     export GDAL_DISABLE_READDIR_ON_OPEN="YES"
>>     export CPL_VSIL_CURL_ALLOWED_EXTENSIONS="jp2"
>>     export CPL_CURL_VERBOSE="YES"
>>     export GDAL_HTTP_MERGE_CONSECUTIVE_RANGES="YES"
>>
>>     gdal_translate --debug ON -srcwin 0 0 256 256 /vsicurl/
>> http://localhost:8083/T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2
>> ./out_subWin.tif
>>
>> What options do I need to specify when creating the JP2 file to support
>> GDAL?
>>
>> Currently I use the following options:
>>
>>     #!/bin/bash
>>
>>     gdal_translate \
>>         -of JP2OpenJPEG \
>>         -co QUALITY=100 \
>>         -co TLM=YES \
>>         -co PLT=YES \
>>         -co PROGRESSION=LRCP \
>>         -co WRITE_METADATA=YES \
>>         ../test_data/T33UWP_20220515T100031_TCI_10m.tif \
>>         ./T33UWP_20220515T100031_TCI_10m_J2Lmin.jp2
>>
>> Some logs:
>>
>> [gdal degug output](https://pastebin.com/vTf7tjLJ)
>> [nginx logs](https://pastebin.com/8bWW15Tp)
>> [gdalinfo](https://pastebin.com/HWSmypEQ)
>> [opj_dump](https://pastebin.com/rdYbHEnY)
>> [kdu_jp2info](https://pastebin.com/atVUfeVx)
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220826/b7750370/attachment.htm>

From adamgutonski at protonmail.com  Fri Aug 26 12:42:24 2022
From: adamgutonski at protonmail.com (adamgutonski)
Date: Fri, 26 Aug 2022 19:42:24 +0000
Subject: [gdal-dev] Creating Feature Classes/Tables with XML_DEFINITION
 option via FileGDB and OpenFileGDB drivers
Message-ID: <qOPjoljobwCjiD3pEGMWTmwhsDpVt0R7kcZXTOgonJq3hJX_Heb5RO2EAcLf_glDCyLMfmqNz5ml7KSFjci3FDddlSfh3xHLw63ltfMyBFE=@protonmail.com>

Hello,

I am having trouble when creating a feature class with subtypes and/or coded domains with the FileGDB or OpenFileGDB drivers, specifically when using the "XML_DEFINITION" or "DOCUMENTATION" layer creation option. I am simply creating a dataset and calling on CreateLayer:

lyr = ds.CreateLayer("TESTPOINT_2", geom_type=ogr.wkbPoint, options=["XML_DEFINITION/DOCUMENTATION=%s" % xmlstr])
ERROR 1: Failed at creating table for \TESTPOINT_2 (General function failure.)

xmlstr is read from a file containing the XML. The XML is based on FC_PCS_Point.xml found in the ESRI FileGDB API resources (in the XMLsamples folder) with added domain information.

My question is where and how to to structure the domain and subtype XML tag/information when using an XML string as part of the XML_DEFINITION or DOCUMENTATION layer creation options? The GDAL documentation specifically mentions that for the xml string that the " root node of such a XML definition must be a <esri:DataElement>". Where are the <Domain> and <Subtype> elements to be placed? Is the subtype and domain information only referenced in the Field elements? I can not seem to get any type of XML string to work beyond a simple feature class or table and have not been able to add subtypes or domains. I have attached the XML document that I am using to this email. Please see the <Subtypes> element under the root <esri:DataElement> as well as the <Domain> under the ELEVATION Field element. Any help or guidance would be greatly appreciated.

Kind regards,
Adam Gutonski

Sent with [Proton Mail](https://proton.me/) secure email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220826/f94539a5/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: testAgain.xml
Type: text/xml
Size: 24629 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220826/f94539a5/attachment-0001.xml>

From howard at hobu.co  Sat Aug 27 05:42:37 2022
From: howard at hobu.co (Howard Butler)
Date: Sat, 27 Aug 2022 14:42:37 +0200
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
Message-ID: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>

Dear PSC,

It has come to my attention that Even's term as a GDAL Maintainer officially ended 31 JUL 2022. I propose that we extend him for another year from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.

Although a small formality, we should make sure to keep a small bit of process around these things.

/me starts with +1

Howard

PS, expect a GDAL Sponsorship Annual Report next week.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 488 bytes
Desc: Message signed with OpenPGP
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220827/e4354aca/attachment.sig>

From Brendan.DeTracey at dfo-mpo.gc.ca  Sat Aug 27 07:09:55 2022
From: Brendan.DeTracey at dfo-mpo.gc.ca (DeTracey, Brendan)
Date: Sat, 27 Aug 2022 14:09:55 +0000
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <e2a19f435319457091484ed5b4d30250@dfo-mpo.gc.ca>

Hi,

I am simply an occasional GDAL/GIS user. However, I would like to thank Even publicly because the few times over the past decade that I have had issues (one of which lead to a _very_ minor bug fix), he has always taken the time to helpfully reply.

Regards,
Brendan
------------------------------------------
Brendan DeTracey 
brendan.detracey at dfo-mpo.gc.ca
(902)426-9727, VS 203/2-3
------------------------------------------
If you have received this communication by mistake, please notify the sender immediately and delete the communication without printing, copying or forwarding it. Thank you. 
Si vous avez re?u cette communication par erreur, veuillez en aviser l'exp?diteur imm?diatement et la supprimer sans l'imprimer, la copier, ou la faire suivre. Merci.
------------------------------------------

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Howard Butler
Sent: Saturday, August 27, 2022 09:43
To: gdal dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL maintainer for 2022-2023

Dear PSC,

It has come to my attention that Even's term as a GDAL Maintainer officially ended 31 JUL 2022. I propose that we extend him for another year from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.

Although a small formality, we should make sure to keep a small bit of process around these things.

/me starts with +1

Howard

PS, expect a GDAL Sponsorship Annual Report next week.

From mateusz at loskot.net  Sat Aug 27 09:40:38 2022
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat, 27 Aug 2022 18:40:38 +0200
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <CABUeae93mOBD-5NmoWYqQiGVT0gm8ywREbmuaN1p1tT7ZoZhcA@mail.gmail.com>

+1

Thank you Even a ton !

On Sat, 27 Aug 2022, 14:42 Howard Butler, <howard at hobu.co> wrote:

> Dear PSC,
>
> It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
>
> Although a small formality, we should make sure to keep a small bit of
> process around these things.
>
> /me starts with +1
>
> Howard
>
> PS, expect a GDAL Sponsorship Annual Report next week.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220827/0ae8884f/attachment.htm>

From szekerest at gmail.com  Sat Aug 27 11:07:41 2022
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat, 27 Aug 2022 20:07:41 +0200
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <CACALY+SWJ2zL2PRspEKFio9mOkO+ZttR43DQwP2G7CnhDS-wZA@mail.gmail.com>

+1

Tamas

Howard Butler <howard at hobu.co> ezt ?rta (id?pont: 2022. aug. 27., Szo,
14:43):

> Dear PSC,
>
> It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
>
> Although a small formality, we should make sure to keep a small bit of
> process around these things.
>
> /me starts with +1
>
> Howard
>
> PS, expect a GDAL Sponsorship Annual Report next week.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220827/4c8795e6/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Aug 27 15:33:53 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Sat, 27 Aug 2022 22:33:53 +0000
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <AM0PR09MB3219FB0942A81BAF14BE5464FD749@AM0PR09MB3219.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Howard Butler
L?hetetty: lauantai 27. elokuuta 2022 15.43
Vastaanottaja: gdal dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL maintainer for 2022-2023

Dear PSC,

It has come to my attention that Even's term as a GDAL Maintainer officially ended 31 JUL 2022. I propose that we extend him for another year from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.

Although a small formality, we should make sure to keep a small bit of process around these things.

/me starts with +1

Howard

PS, expect a GDAL Sponsorship Annual Report next week.

From schwehr at gmail.com  Sun Aug 28 06:56:19 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sun, 28 Aug 2022 06:56:19 -0700
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <CACmBxysYL8NXV-r8HrKxwUHxt5-CsK60byLLEJiAxTUZk53K0g@mail.gmail.com>

+1 KurtS

On Sat, Aug 27, 2022, 5:43 AM Howard Butler <howard at hobu.co> wrote:

> Dear PSC,
>
> It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
>
> Although a small formality, we should make sure to keep a small bit of
> process around these things.
>
> /me starts with +1
>
> Howard
>
> PS, expect a GDAL Sponsorship Annual Report next week.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220828/a22af65e/attachment.htm>

From warmerdam at pobox.com  Sun Aug 28 18:44:23 2022
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun, 28 Aug 2022 21:44:23 -0400
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <CACmBxysYL8NXV-r8HrKxwUHxt5-CsK60byLLEJiAxTUZk53K0g@mail.gmail.com>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
 <CACmBxysYL8NXV-r8HrKxwUHxt5-CsK60byLLEJiAxTUZk53K0g@mail.gmail.com>
Message-ID: <CA+YzLBf1mxWMmz7nhAw8oX1av7woZfFwgWC1NeV_9hx2-c6vmQ@mail.gmail.com>

+1 Frank

On Sun, Aug 28, 2022 at 9:56 AM Kurt Schwehr <schwehr at gmail.com> wrote:

> +1 KurtS
>
> On Sat, Aug 27, 2022, 5:43 AM Howard Butler <howard at hobu.co> wrote:
>
>> Dear PSC,
>>
>> It has come to my attention that Even's term as a GDAL Maintainer
>> officially ended 31 JUL 2022. I propose that we extend him for another year
>> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
>>
>> Although a small formality, we should make sure to keep a small bit of
>> process around these things.
>>
>> /me starts with +1
>>
>> Howard
>>
>> PS, expect a GDAL Sponsorship Annual Report next week.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220828/4e652b4a/attachment.htm>

From dmorissette at mapgears.com  Mon Aug 29 07:27:39 2022
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon, 29 Aug 2022 10:27:39 -0400
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <eae77401-01dd-be01-1d6d-8bcb7d6ce7db@mapgears.com>

+1

Daniel

On 2022-08-27 08:42, Howard Butler wrote:
> Dear PSC,
> 
> It has come to my attention that Even's term as a GDAL Maintainer officially ended 31 JUL 2022. I propose that we extend him for another year from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
> 
> Although a small formality, we should make sure to keep a small bit of process around these things.
> 
> /me starts with +1
> 
> Howard
> 
> PS, expect a GDAL Sponsorship Annual Report next week.
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From norman.barker at gmail.com  Mon Aug 29 07:44:00 2022
From: norman.barker at gmail.com (Norman Barker)
Date: Mon, 29 Aug 2022 09:44:00 -0500
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <eae77401-01dd-be01-1d6d-8bcb7d6ce7db@mapgears.com>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
 <eae77401-01dd-be01-1d6d-8bcb7d6ce7db@mapgears.com>
Message-ID: <CAN_Dn-G3SV0cNy5w63iWoEsM+fQM=59HFAOFZfiWcXdWe=qUCQ@mail.gmail.com>

+1
Norman

On Mon, Aug 29, 2022 at 9:28 AM Daniel Morissette <dmorissette at mapgears.com>
wrote:

> +1
>
> Daniel
>
> On 2022-08-27 08:42, Howard Butler wrote:
> > Dear PSC,
> >
> > It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
> >
> > Although a small formality, we should make sure to keep a small bit of
> process around these things.
> >
> > /me starts with +1
> >
> > Howard
> >
> > PS, expect a GDAL Sponsorship Annual Report next week.
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220829/943b7269/attachment.htm>

From andy.canfield at gmail.com  Mon Aug 29 08:33:58 2022
From: andy.canfield at gmail.com (Andy Canfield)
Date: Mon, 29 Aug 2022 09:33:58 -0600
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <eae77401-01dd-be01-1d6d-8bcb7d6ce7db@mapgears.com>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
 <eae77401-01dd-be01-1d6d-8bcb7d6ce7db@mapgears.com>
Message-ID: <CAH9DkXz4ScZfSUF=W-xj3YCMaB9kES=wVsQndbwUhm0p8bO7QQ@mail.gmail.com>

+1

On Mon, Aug 29, 2022 at 8:27 AM Daniel Morissette <dmorissette at mapgears.com>
wrote:

> +1
>
> Daniel
>
> On 2022-08-27 08:42, Howard Butler wrote:
> > Dear PSC,
> >
> > It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
> >
> > Although a small formality, we should make sure to keep a small bit of
> process around these things.
> >
> > /me starts with +1
> >
> > Howard
> >
> > PS, expect a GDAL Sponsorship Annual Report next week.
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220829/8a4ca94a/attachment.htm>

From sean.gillies at gmail.com  Mon Aug 29 09:46:12 2022
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 29 Aug 2022 10:46:12 -0600
Subject: [gdal-dev] Motion: Approve Even Rouault as a contracted GDAL
 maintainer for 2022-2023
In-Reply-To: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
References: <5FED281D-4148-4FE5-8C88-D4F13F7A70DD@hobu.co>
Message-ID: <CAOodmJpVHG=Exkw-4QqxzNjKNqrV8OdXn+bZC6mwAcshceDT1g@mail.gmail.com>

+1

On Sat, Aug 27, 2022 at 6:43 AM Howard Butler <howard at hobu.co> wrote:

> Dear PSC,
>
> It has come to my attention that Even's term as a GDAL Maintainer
> officially ended 31 JUL 2022. I propose that we extend him for another year
> from 01 AUG 2022 to 31 JUL 2023 under the previous terms and conditions.
>
> Although a small formality, we should make sure to keep a small bit of
> process around these things.
>
> /me starts with +1
>
> Howard
>
> PS, expect a GDAL Sponsorship Annual Report next week.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220829/8162e77e/attachment.htm>

From kevin.bradner at nasa.gov  Mon Aug 29 16:45:29 2022
From: kevin.bradner at nasa.gov (Bradner, Kevin M. (ARC-TI))
Date: Mon, 29 Aug 2022 23:45:29 +0000
Subject: [gdal-dev] use gdal_viewshed
Message-ID: <CO6PR09MB87412B1DC8A771C01293345C8A769@CO6PR09MB8741.namprd09.prod.outlook.com>

Hello,

I'm interested in using gdal_viewshed<https://gdal.org/programs/gdal_viewshed.html#gdal-viewshed> to calculate a viewshed for a point on the surface of the Moon. My DEM stores heights relative to a reference sphere approximately the size of the Moon.

Could I calculate a valid viewshed from this data by passing in a -cc of roughly 3.6 (Earth diameter / Moon diameter)? Some comments in the algorithm's source code make this seem reasonable, but I would like to confirm that this is the only correction I would need to make.

Thank you,
Kevin Bradner

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220829/4018afd2/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 30 02:25:33 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Aug 2022 11:25:33 +0200
Subject: [gdal-dev] use gdal_viewshed
In-Reply-To: <CO6PR09MB87412B1DC8A771C01293345C8A769@CO6PR09MB8741.namprd09.prod.outlook.com>
References: <CO6PR09MB87412B1DC8A771C01293345C8A769@CO6PR09MB8741.namprd09.prod.outlook.com>
Message-ID: <efe4ea11-7f52-a173-28f7-f017b6b0ff6d@spatialys.com>

Hi,


The -cc parameter is only taken into account if there's a CRS associated 
to the DEM, as the sphere diameter isn't hardcoded to be the one of Earth.

So you should first check that there's a lunar one associated to yours

If you use PROJ >= 8.1, you can use IAU:30100 or otherwise the PROJ4 
style string "+proj=longlat +R=1737400 +no_defs +type=crs"

Or you can create a VRT wrapping your DEM with something like:

gdal_translate your_input_dem temp.vrt -a_srs "+proj=longlat +R=1737400 
+no_defs +type=crs"

and then use temp.vrt as input for gdal_viewshed and use -cc 1 as 
there's no atmosphere on Moon (just thinking that gdal_viewshed should 
probably default to -cc 1 for non-Earth bodies)


Even


Le 30/08/2022 ? 01:45, Bradner, Kevin M. (ARC-TI) via gdal-dev a ?crit?:
> Hello,
>
> I'm interested in using gdal_viewshed 
> <https://gdal.org/programs/gdal_viewshed.html#gdal-viewshed> to 
> calculate a viewshed for a point on the surface of the Moon. My DEM 
> stores heights relative to a reference sphere approximately the size 
> of the Moon.
>
> Could I calculate a valid viewshed from this data by passing in a -cc 
> of roughly 3.6 (Earth diameter / Moon diameter)? Some comments in the 
> algorithm's source code make this seem reasonable, but I would like to 
> confirm that this is the only correction I would need to make.
>
> Thank you,
> Kevin Bradner
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220830/83fc957c/attachment.htm>

From zachary at anagraph.io  Tue Aug 30 12:38:22 2022
From: zachary at anagraph.io (=?UTF-8?Q?Zachary_D=C3=A9ziel?=)
Date: Tue, 30 Aug 2022 12:38:22 -0700
Subject: [gdal-dev] Snowflake Vector Driver
Message-ID: <CA+2j9YK4GZtgA0hGtC2VM4WoYOBFE_C2TtYHPcTAGTqYw605Ng@mail.gmail.com>

Hi all,

I've been working with a couple of clients who store their data on
Snowflake. Snowflake is building up its geo-capabilities, but it is not
super mature yet. I love the OGR tools to the point that it is painful to
use anything else...

I have been searching for information regarding if anyone has worked on
integrating a custom vector driver for Snowflake, but I could not find any
info on it. Importing and exporting data to and from Snowflake is rather
painful right now. It either requires using some closed solutions (Carto,
Unfolded, maybe ESRI) or writing your custom scripts that connect to
Snowflake.

So, do you know about any efforts to create a Snowflake Vector driver? What
would it take for this to happen?

If you would be interested in such a driver, feel free to reach out to me!

Cheers,

*Zachary D?ziel*
Product Manager
Anagraph.io
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220830/19520f08/attachment.htm>

From gregers at septima.dk  Tue Aug 30 13:18:17 2022
From: gregers at septima.dk (Hans Gregers Hedegaard Petersen)
Date: Tue, 30 Aug 2022 22:18:17 +0200
Subject: [gdal-dev] Snowflake Vector Driver
In-Reply-To: <CA+2j9YK4GZtgA0hGtC2VM4WoYOBFE_C2TtYHPcTAGTqYw605Ng@mail.gmail.com>
References: <CA+2j9YK4GZtgA0hGtC2VM4WoYOBFE_C2TtYHPcTAGTqYw605Ng@mail.gmail.com>
Message-ID: <CAA+ACAmoBWcNv90AZhNTFmF_Tn-DGLBRcOCU5Bb83FAD4vz2qA@mail.gmail.com>

Hi Zachary,


So, do you know about any efforts to create a Snowflake Vector driver? What
> would it take for this to happen?
>

Please do not see this as discouragement, but we tried to make sense out of
Snowflakes models (both in and out), and  must say we were impressed by
their xml-capabilities; they can take any kind of in data and make an
output model out of it.

But
It
Is
A
Pain(!!!)
To try to figure out anything consistent with the out-model of it.

A lot of ?magic? happens in their mapping, so we basically took a handful
or two of in data files and reverse engineered (read; performed informed
guessing) the configuration used for those, so we could hopefully produce
the corresponding INSPIRE XML configuration for GeoServer.

We found that the same (or so it seemed) Snowflake configuration can
produce several different outputs depending on version/context/input
database column configuration etc

The journey was long, and our client ended up deprecating the services with
a long notice (counted in years) and built ?the same? (functionally and not
backwards compatible) in a week or two in GeoServer.

If you need some specific input, I might find an hour or so to scavenge our
POC. But I am quite sure it is not worth it without the snowflake secret
sauce.


Cheers,

Greg


-- 

*Hans Gregers Hedegaard Petersen*
Partner, Seniorkonsulent
gregers at septima.dk
--------------------------
Septima P/S
Frederiksberggade 19, 2.
1459 K?benhavn K
www.septima.dk
Tlf: +45 7230 0672
Direkte: +45 9132 6945
Cvr: 34900841
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220830/5a7d477f/attachment.htm>

From even.rouault at spatialys.com  Tue Aug 30 13:35:00 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Aug 2022 22:35:00 +0200
Subject: [gdal-dev] Snowflake Vector Driver
In-Reply-To: <CAA+ACAmoBWcNv90AZhNTFmF_Tn-DGLBRcOCU5Bb83FAD4vz2qA@mail.gmail.com>
References: <CA+2j9YK4GZtgA0hGtC2VM4WoYOBFE_C2TtYHPcTAGTqYw605Ng@mail.gmail.com>
 <CAA+ACAmoBWcNv90AZhNTFmF_Tn-DGLBRcOCU5Bb83FAD4vz2qA@mail.gmail.com>
Message-ID: <694af1a4-4411-dc37-1892-b5e9744e35e1@spatialys.com>

Wondering if using the new (Geo)Parquet driver - 
https://gdal.org/drivers/vector/parquet.html - wouldn't help for 
interoperability with Snowflake ?

At least it should currently understand the non-geo part of it, and I 
presume the geo part will come at some point as it seems Snowflake 
support, among others, was one of the driver to develop GeoParquet

Le 30/08/2022 ? 22:18, Hans Gregers Hedegaard Petersen a ?crit?:
> Hi Zachary,
>
>
>     So, do you know about any efforts to create a Snowflake Vector
>     driver? What would it take for this to happen?
>
>
> Please do not see this as discouragement, but we tried to make sense 
> out of Snowflakes models (both in and out), and ?must say we were 
> impressed by their xml-capabilities; they can take any kind of in data 
> and make an output model out of it.
>
> But
> It
> Is
> A
> Pain(!!!)
> To try to figure out anything consistent with the out-model of it.
>
> A lot of ?magic? happens in their mapping, so we basically took a 
> handful or two of in data files and reverse engineered (read; 
> performed informed guessing) the configuration used for those, so we 
> could hopefully produce the corresponding INSPIRE XML configuration 
> for GeoServer.
>
> We found that the same (or so it seemed) Snowflake configuration can 
> produce several different outputs depending on version/context/input 
> database column configuration etc
>
> The journey was long, and our client ended up deprecating the services 
> with a long notice (counted in years) and built ?the same? 
> (functionally and not backwards compatible) in a week or two in GeoServer.
>
> If you need some specific input, I might find an hour or so to 
> scavenge our POC. But I am quite sure it is not worth it without the 
> snowflake secret sauce.
>
>
> Cheers,
>
> Greg
>
>
> -- 
> *Hans Gregers Hedegaard Petersen
> *
> Partner, Seniorkonsulent
> gregers at septima.dk
> --------------------------
> Septima P/S
> Frederiksberggade 19, 2.
> 1459 K?benhavn K
> www.septima.dk <http://www.septima.dk>
> Tlf: +45 7230 0672
> Direkte: +45 9132 6945
> Cvr: 34900841
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220830/802e6de3/attachment.htm>

From zachary at anagraph.io  Tue Aug 30 14:25:37 2022
From: zachary at anagraph.io (=?UTF-8?Q?Zachary_D=C3=A9ziel?=)
Date: Tue, 30 Aug 2022 14:25:37 -0700
Subject: [gdal-dev] Snowflake Vector Driver
In-Reply-To: <CAA+ACAmoBWcNv90AZhNTFmF_Tn-DGLBRcOCU5Bb83FAD4vz2qA@mail.gmail.com>
References: <CA+2j9YK4GZtgA0hGtC2VM4WoYOBFE_C2TtYHPcTAGTqYw605Ng@mail.gmail.com>
 <CAA+ACAmoBWcNv90AZhNTFmF_Tn-DGLBRcOCU5Bb83FAD4vz2qA@mail.gmail.com>
Message-ID: <CA+2j9Y+B9RwPKbQb84wTSGh_eKN1dyexQeYTbaTqSdonzmV79w@mail.gmail.com>

Hi Greg,

Thanks for sharing! We have some ongoing conversations with Snowflake's
team. Lobbying hard the idea of making them more interoperable with the
geospatial ecosystem.

Sharing any shortcomings you experienced during your POC without needing
too many details would help drive some points home.

Let me know if I can help, and I would love to chat.

*Zachary D?ziel*
Product Manager
Anagraph.io


Le mar. 30 ao?t 2022 ? 13:18, Hans Gregers Hedegaard Petersen <
gregers at septima.dk> a ?crit :

> Hi Zachary,
>
>
> So, do you know about any efforts to create a Snowflake Vector driver?
>> What would it take for this to happen?
>>
>
> Please do not see this as discouragement, but we tried to make sense out
> of Snowflakes models (both in and out), and  must say we were impressed by
> their xml-capabilities; they can take any kind of in data and make an
> output model out of it.
>
> But
> It
> Is
> A
> Pain(!!!)
> To try to figure out anything consistent with the out-model of it.
>
> A lot of ?magic? happens in their mapping, so we basically took a handful
> or two of in data files and reverse engineered (read; performed informed
> guessing) the configuration used for those, so we could hopefully produce
> the corresponding INSPIRE XML configuration for GeoServer.
>
> We found that the same (or so it seemed) Snowflake configuration can
> produce several different outputs depending on version/context/input
> database column configuration etc
>
> The journey was long, and our client ended up deprecating the services
> with a long notice (counted in years) and built ?the same? (functionally
> and not backwards compatible) in a week or two in GeoServer.
>
> If you need some specific input, I might find an hour or so to scavenge
> our POC. But I am quite sure it is not worth it without the snowflake
> secret sauce.
>
>
> Cheers,
>
> Greg
>
>
> --
>
> *Hans Gregers Hedegaard Petersen*
> Partner, Seniorkonsulent
> gregers at septima.dk
> --------------------------
> Septima P/S
> Frederiksberggade 19, 2.
> 1459 K?benhavn K
> www.septima.dk
> Tlf: +45 7230 0672
> Direkte: +45 9132 6945
> Cvr: 34900841
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220830/7291bcd5/attachment-0001.htm>

From nik at nixanz.com  Tue Aug 30 16:07:49 2022
From: nik at nixanz.com (Nik Sands)
Date: Wed, 31 Aug 2022 09:07:49 +1000
Subject: [gdal-dev] iOS patch for GDAL 3.5 requires modification for Mac
 Catalyst
Message-ID: <79246A77-3537-4612-9C9C-F6BB764D5722@nixanz.com>

Hi GDAL devs,

A few months ago, a patch to GDAL 3.5 was developed so that building with CMAKE would run correctly for iOS builds.  The patch is below.

I am now extending my iOS app to use Mac Catalyst (for those who don?t know, this is an Apple technology to enable apps developed for iOS to also run on macOS (both ARM and Intel), and for the Mac version to also be extended to include macOS-only functionality, such as menu bars, etc).

I have found that when building for Mac Catalyst, the build failed in exactly the same way that it used to fail for iOS before applying the patch (below).  The errors are due to (as the patch comment says):  tests detect xxxx64 symbols for iOS, which are not available at build time.

So I modified the patched file further to replace this line:

if (${CMAKE_SYSTEM_NAME} MATCHES "iOS?)

...with this:

if (${CMAKE_SYSTEM_NAME} MATCHES ?iOS? OR ${CMAKE_SYSTEM_NAME} MATCHES ?Darwin?)

...and now the Mac Catalyst build works correctly (for both Mac Catalyst x86_64 AND Mac Catalyst arm64).

HOWEVER, I do not know if this might adversely affect direct (non-catalyst) ?normal? macOS builds (as I am not doing any such builds myself).  Is anybody able to verify if this change would be a problem for macOS.  If not, can this change be included in future builds of GDAL, or if it would be problematic for ?normal? macOS, is there some way to modify the cmake config to check explicitly for Mac Catalyst, as opposed to ?normal? macOS?

Cheers,
Nik.


START OF PATCH
??????????

--- orig/configure.cmake	2022-05-11 00:03:37.000000000 +1000
+++ patched/configure.cmake	2022-07-06 18:54:48.000000000 +1000
@@ -41,6 +41,7 @@
 check_type_size("int" SIZEOF_INT)
 check_type_size("unsigned long" SIZEOF_UNSIGNED_LONG)
 check_type_size("void*" SIZEOF_VOIDP)
+check_type_size("size_t" SIZEOF_SIZE_T)
 
 if (MSVC)
   set(HAVE_VSNPRINTF 1)
@@ -116,6 +117,13 @@
         "
     HAVE_5ARGS_MREMAP)
 
+  check_c_source_compiles(
+    "
+        #include <pthread.h>
+        int main() { pthread_atfork(0,0,0); 0; }
+        "
+    HAVE_PTHREAD_ATFORK)
+
   check_include_file("sys/stat.h" HAVE_SYS_STAT_H)
   if (${CMAKE_SYSTEM} MATCHES "Linux")
       check_include_file("linux/fs.h" HAVE_LINUX_FS_H)
@@ -233,6 +241,27 @@
     set(VSI_FTRUNCATE64 "ftruncate")
   endif ()
 
+  # For some reason, above tests detect xxxx64 symbols for iOS, which are not
+  # available at build time.
+  if (${CMAKE_SYSTEM_NAME} MATCHES "iOS")
+    set(VSI_FOPEN64 "fopen")
+    set(VSI_FTRUNCATE64 "ftruncate")
+    set(VSI_FTELL64 "ftell")
+    set(VSI_FSEEK64 "fseek")
+    set(VSI_STAT64 "stat")
+    set(VSI_STAT64_T "stat")
+    unset(HAVE_FOPEN64)
+    unset(HAVE_FOPEN64 CACHE)
+    unset(HAVE_FTRUNCATE64)
+    unset(HAVE_FTRUNCATE64 CACHE)
+    unset(HAVE_FTELL64)
+    unset(HAVE_FTELL64 CACHE)
+    unset(HAVE_FSEEK64)
+    unset(HAVE_FSEEK64 CACHE)
+    unset(HAVE_STATVFS64)
+    unset(HAVE_STATVFS64 CACHE)
+  endif()
+
   set(UNIX_STDIO_64 TRUE)
 
   set(INCLUDE_XLOCALE_H)
@@ -313,4 +342,4 @@
   set(MACOSX_FRAMEWORK OFF)
 endif ()
 
-# vim: ts=4 sw=4 sts=4 et
+# vim: ts=4 sw=4 sts=4 et
\ No newline at end of file


??????????
END OF PATCH

========================================================
NIK SANDS
Line Tamer | Time Traveller | Space Cadet


From jukka.rahkonen at maanmittauslaitos.fi  Wed Aug 31 07:06:05 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 31 Aug 2022 14:06:05 +0000
Subject: [gdal-dev] Reading OAPIF in alternative CRS
Message-ID: <AM0PR09MB32190B7086C5D9CE07B095FDFD789@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I wonder if I could read data with GDAL from OGC API Features service in other CRS if the server supports it. I know that GDAL OAPIF driver does not support the CRS extension https://docs.ogc.org/is/18-058r1/18-058r1.html and that GeoJSON really does not support other CRS than CRS:84 but we have a server that outputs JSON in other CRS if requested and I would accept any workaround. This URL may not work for everybody but gives an example about using crs= in the request.

https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/tieviiva/items?crs=http://www.opengis.net/def/crs/EPSG/0/3067&limit=2

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220831/3c14e6ac/attachment.htm>

From even.rouault at spatialys.com  Wed Aug 31 07:06:22 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 31 Aug 2022 16:06:22 +0200
Subject: [gdal-dev] iOS patch for GDAL 3.5 requires modification for Mac
 Catalyst
In-Reply-To: <79246A77-3537-4612-9C9C-F6BB764D5722@nixanz.com>
References: <79246A77-3537-4612-9C9C-F6BB764D5722@nixanz.com>
Message-ID: <0d0b4e1a-9667-7ba3-0eb0-be38d5ed5787@spatialys.com>

Nik,

I've prepared a PR with your suggested fix in 
https://github.com/OSGeo/gdal/pull/6282

It passes fine on existing MacOS continuous integration jobs we have. It 
would be good if people that have access to a bit ancient MacOSX (not 
sure how ancient it should be...), or with 32-bit builds, could check if 
that PR doesn't prevent using data files > 4 GB.

Even

Le 31/08/2022 ? 01:07, Nik Sands a ?crit?:
> Hi GDAL devs,
>
> A few months ago, a patch to GDAL 3.5 was developed so that building with CMAKE would run correctly for iOS builds.  The patch is below.
>
> I am now extending my iOS app to use Mac Catalyst (for those who don?t know, this is an Apple technology to enable apps developed for iOS to also run on macOS (both ARM and Intel), and for the Mac version to also be extended to include macOS-only functionality, such as menu bars, etc).
>
> I have found that when building for Mac Catalyst, the build failed in exactly the same way that it used to fail for iOS before applying the patch (below).  The errors are due to (as the patch comment says):  tests detect xxxx64 symbols for iOS, which are not available at build time.
>
> So I modified the patched file further to replace this line:
>
> if (${CMAKE_SYSTEM_NAME} MATCHES "iOS?)
>
> ...with this:
>
> if (${CMAKE_SYSTEM_NAME} MATCHES ?iOS? OR ${CMAKE_SYSTEM_NAME} MATCHES ?Darwin?)
>
> ...and now the Mac Catalyst build works correctly (for both Mac Catalyst x86_64 AND Mac Catalyst arm64).
>
> HOWEVER, I do not know if this might adversely affect direct (non-catalyst) ?normal? macOS builds (as I am not doing any such builds myself).  Is anybody able to verify if this change would be a problem for macOS.  If not, can this change be included in future builds of GDAL, or if it would be problematic for ?normal? macOS, is there some way to modify the cmake config to check explicitly for Mac Catalyst, as opposed to ?normal? macOS?
>
> Cheers,
> Nik.
>
>
> START OF PATCH
> ??????????
>
> --- orig/configure.cmake	2022-05-11 00:03:37.000000000 +1000
> +++ patched/configure.cmake	2022-07-06 18:54:48.000000000 +1000
> @@ -41,6 +41,7 @@
>   check_type_size("int" SIZEOF_INT)
>   check_type_size("unsigned long" SIZEOF_UNSIGNED_LONG)
>   check_type_size("void*" SIZEOF_VOIDP)
> +check_type_size("size_t" SIZEOF_SIZE_T)
>   
>   if (MSVC)
>     set(HAVE_VSNPRINTF 1)
> @@ -116,6 +117,13 @@
>           "
>       HAVE_5ARGS_MREMAP)
>   
> +  check_c_source_compiles(
> +    "
> +        #include <pthread.h>
> +        int main() { pthread_atfork(0,0,0); 0; }
> +        "
> +    HAVE_PTHREAD_ATFORK)
> +
>     check_include_file("sys/stat.h" HAVE_SYS_STAT_H)
>     if (${CMAKE_SYSTEM} MATCHES "Linux")
>         check_include_file("linux/fs.h" HAVE_LINUX_FS_H)
> @@ -233,6 +241,27 @@
>       set(VSI_FTRUNCATE64 "ftruncate")
>     endif ()
>   
> +  # For some reason, above tests detect xxxx64 symbols for iOS, which are not
> +  # available at build time.
> +  if (${CMAKE_SYSTEM_NAME} MATCHES "iOS")
> +    set(VSI_FOPEN64 "fopen")
> +    set(VSI_FTRUNCATE64 "ftruncate")
> +    set(VSI_FTELL64 "ftell")
> +    set(VSI_FSEEK64 "fseek")
> +    set(VSI_STAT64 "stat")
> +    set(VSI_STAT64_T "stat")
> +    unset(HAVE_FOPEN64)
> +    unset(HAVE_FOPEN64 CACHE)
> +    unset(HAVE_FTRUNCATE64)
> +    unset(HAVE_FTRUNCATE64 CACHE)
> +    unset(HAVE_FTELL64)
> +    unset(HAVE_FTELL64 CACHE)
> +    unset(HAVE_FSEEK64)
> +    unset(HAVE_FSEEK64 CACHE)
> +    unset(HAVE_STATVFS64)
> +    unset(HAVE_STATVFS64 CACHE)
> +  endif()
> +
>     set(UNIX_STDIO_64 TRUE)
>   
>     set(INCLUDE_XLOCALE_H)
> @@ -313,4 +342,4 @@
>     set(MACOSX_FRAMEWORK OFF)
>   endif ()
>   
> -# vim: ts=4 sw=4 sts=4 et
> +# vim: ts=4 sw=4 sts=4 et
> \ No newline at end of file
>
>
> ??????????
> END OF PATCH
>
> ========================================================
> NIK SANDS
> Line Tamer | Time Traveller | Space Cadet
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From robert.coup at koordinates.com  Wed Aug 31 13:57:25 2022
From: robert.coup at koordinates.com (Robert Coup)
Date: Wed, 31 Aug 2022 21:57:25 +0100
Subject: [gdal-dev] iOS patch for GDAL 3.5 requires modification for Mac
 Catalyst
In-Reply-To: <0d0b4e1a-9667-7ba3-0eb0-be38d5ed5787@spatialys.com>
References: <79246A77-3537-4612-9C9C-F6BB764D5722@nixanz.com>
 <0d0b4e1a-9667-7ba3-0eb0-be38d5ed5787@spatialys.com>
Message-ID: <CAFLLRp+FMEMyyr=dkapbVFusADxAsGH7XytdxQBGKqL_BVqd7A@mail.gmail.com>

Hi,

The patch at the end of my reply builds & tests ok on my environment (macOS
12.5.1 + arm64).

Are you using https://github.com/leetal/ios-cmake or do newer versions of
CMake now have support for Catalyst? (from
https://gitlab.kitware.com/cmake/cmake/-/issues/20132 it seems not)

How do the varios combinations of CMAKE_SYSTEM_NAME=Darwin|iOS, APPLE,
UNIX, etc work under Catalyst?

Rob :)

diff --git a/cmake/helpers/configure.cmake b/cmake/helpers/configure.cmake
index 277f1ab2a9..a91f72aa04 100644
--- a/cmake/helpers/configure.cmake
+++ b/cmake/helpers/configure.cmake
@@ -247,7 +247,7 @@ else ()

   # For some reason, above tests detect xxxx64 symbols for iOS, which are
not
   # available at build time.
-  if (${CMAKE_SYSTEM_NAME} MATCHES "iOS")
+  if (${CMAKE_SYSTEM_NAME} MATCHES ?iOS? OR ${CMAKE_SYSTEM_NAME} MATCHES
?Darwin?)
     set(VSI_FOPEN64 "fopen")
     set(VSI_FTRUNCATE64 "ftruncate")
     set(VSI_FTELL64 "ftell")
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220831/c9bc5a4e/attachment.htm>

From nik at nixanz.com  Wed Aug 31 16:28:57 2022
From: nik at nixanz.com (Nik)
Date: Thu, 1 Sep 2022 09:28:57 +1000
Subject: [gdal-dev] iOS patch for GDAL 3.5 requires modification for Mac
 Catalyst
In-Reply-To: <CAFLLRp+FMEMyyr=dkapbVFusADxAsGH7XytdxQBGKqL_BVqd7A@mail.gmail.com>
References: <CAFLLRp+FMEMyyr=dkapbVFusADxAsGH7XytdxQBGKqL_BVqd7A@mail.gmail.com>
Message-ID: <02E312AC-60D3-4C76-8069-659CE625DB28@nixanz.com>

Thanks Rob and Even,

Rob - yes, I am using the CMAKE as per your link.

I have documented my entire process here:  https://gis.stackexchange.com/questions/434514/build-gdal-3-x-for-ios

Although I?ve not yet updated it for the update to the patch file.

-----------------------------------------
NIK SANDS
Line Tamer | Time Traveller | Space Cadet

> On 1 Sep 2022, at 6:57 am, Robert Coup <robert.coup at koordinates.com> wrote:
> 
> ?
> Hi,
> 
> The patch at the end of my reply builds & tests ok on my environment (macOS 12.5.1 + arm64).
> 
> Are you using https://github.com/leetal/ios-cmake or do newer versions of CMake now have support for Catalyst? (from https://gitlab.kitware.com/cmake/cmake/-/issues/20132 it seems not)
> 
> How do the varios combinations of CMAKE_SYSTEM_NAME=Darwin|iOS, APPLE, UNIX, etc work under Catalyst?
> 
> Rob :)
> 
> diff --git a/cmake/helpers/configure.cmake b/cmake/helpers/configure.cmake
> index 277f1ab2a9..a91f72aa04 100644
> --- a/cmake/helpers/configure.cmake
> +++ b/cmake/helpers/configure.cmake
> @@ -247,7 +247,7 @@ else ()
> 
>    # For some reason, above tests detect xxxx64 symbols for iOS, which are not
>    # available at build time.
> -  if (${CMAKE_SYSTEM_NAME} MATCHES "iOS")
> +  if (${CMAKE_SYSTEM_NAME} MATCHES ?iOS? OR ${CMAKE_SYSTEM_NAME} MATCHES ?Darwin?)
>      set(VSI_FOPEN64 "fopen")
>      set(VSI_FTRUNCATE64 "ftruncate")
>      set(VSI_FTELL64 "ftell")
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220901/19958ae0/attachment.htm>

