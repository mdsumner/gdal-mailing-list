From jluis at ualg.pt  Sat Jan  1 10:47:38 2022
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 1 Jan 2022 18:47:38 +0000
Subject: [gdal-dev] Experiences with the WMS driver
Message-ID: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>

Hello and Happy New Year

I started playing (learning) with the WMS driver and wrote a couple of Julia functions to use it that work well ... some times.
If I use the "http://tiles.maps.eox.at/wms?" service I can get images from there but it already starts to feel strange the image resolution reported

But when I try one example used by the Matlab docs, http://svs.gsfc.nasa.gov/cgi-bin/wms? Then nothing works

First list the layers
gdalinfo http://svs.gsfc.nasa.gov/cgi-bin/wms?

Then try to download one

gdal_translate -of PNG "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE" -outsize 2048 512 out.png
Input file size is 1073741824, 536870912
ERROR 1: GDALWMS: The server returned exception code 'InvalidSize': WIDTH is invalid for layer. Should be 922.

ERROR 1: GDALWMS: The server returned exception code 'InvalidSize': HEIGHT is invalid for layer.  Should be 461.

ERROR 1: GDALWMS: The server returned exception code 'InvalidFormat': FORMAT is invalid for layer.  Should be image/png.

ERROR 1: GDALWMS: The server returned exception code 'InvalidBBOX': BBOX is invalid for layer.  Should be [-180,-90,180,90]

ERROR 1: GDALWMS: The server returned exception code 'LayerNotDefined': Unable to find layer.

ERROR 1: IReadBlock failed at X offset 0, Y offset 0: GDALWMS: The server returned exception code 'LayerNotDefined': Unable to find layer.


But if I do

gdalinfo "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE"

it seems to work but note the reported sizes and unreasonable resolution.

Data axis to CRS axis mapping: 1,2
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.000000335276127,-0.000000335276127)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
  Overviews: 536870912x268435456, 268435456x134217728, 134217728x67108864, 67108864x33554432, 33554432x16777216, 16777216x8388608, 8388608x4194304, 4194304x2097152, 2097152x1048576, 1048576x524288, 524288x262144, 262144x131072, 131072x65536, 65536x32768, 32768x16384, 16384x8192, 8192x4096, 4096x2048, 2048x1024, 1024x512


Debuggin in Matlab I could recover this request URL

http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&LAYERS=3140_21200&CRS=CRS:84&FORMAT=image/png&TRANSPARENT=FALSE&HEIGHT=512&BGCOLOR=&REQUEST=GetMap&WIDTH=2048&BBOX=-50.2,69.11,-49.6,69.26&STYLES=&VERSION=1.3.0

that works if we past it into a browser, but

trying it with gdal_translate errors again,  and again those huge image sizes

gdal_translate -of PNG "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&LAYERS=3140_21200&CRS=CRS:84&FORMAT=image/png&TRANSPARENT=FALSE&HEIGHT=512&BGCOLOR=&REQUEST=GetMap&WIDTH=2048&BBOX=-50.2,69.11,-49.6,69.26&STYLES=&VERSION=1.3.0" out.png
Input file size is 1073741824, 268435456
ERROR 1: libpng: Read Error
ERROR 1: libpng: Read Error
Warning 1: libpng: Image width exceeds user limit in IHDR
Warning 1: libpng: Image height exceeds user limit in IHDR
ERROR 1: libpng: Invalid IHDR data


Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220101/df37efd0/attachment.html>

From momtchil at momtchev.com  Mon Jan  3 07:08:24 2022
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Mon, 3 Jan 2022 16:08:24 +0100
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>


 ??? gdalinfo does not contact the remote server at all, it extracts all 
the information it displays from the URL.

 ??? Try replacing the hostname with something invalid, keeping all the 
parameters and you will still get the same output.



On 01/01/2022 19:47, Joaquim Manuel Freire Lu?s wrote:
>
> But if I do
>
> gdalinfo 
> "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE"
>
> it seems to work but note the reported sizes and unreasonable resolution.
>
> Data axis to CRS axis mapping: 1,2
>
> Origin = (-180.000000000000000,90.000000000000000)
>
> Pixel Size = (0.000000335276127,-0.000000335276127)
>
> Image Structure Metadata:
>
> ? INTERLEAVE=PIXEL
>
> Corner Coordinates:
>
> Upper Left (-180.0000000,? 90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
>
> Lower Left (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
>
> Upper Right ( 180.0000000,? 90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
>
> Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
>
> Center????? (?? 0.0000000,?? 0.0000000) ( 0d 0' 0.01"E,? 0d 0' 0.01"N)
>
> Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
>
> ? Overviews: 536870912x268435456, 268435456x134217728, 
> 134217728x67108864, 67108864x33554432, 33554432x16777216, 
> 16777216x8388608, 8388608x4194304, 4194304x2097152, 2097152x1048576, 
> 1048576x524288, 524288x262144, 262144x131072, 131072x65536, 
> 65536x32768, 32768x16384, 16384x8192, 8192x4096, 4096x2048, 2048x1024, 
> 1024x512
>
>
-- 
Momtchil Momtchev <momtchil at momtchev.com>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220103/2ef75f2b/attachment.html>

From howard at hobu.co  Mon Jan  3 08:12:25 2022
From: howard at hobu.co (Howard Butler)
Date: Mon, 3 Jan 2022 10:12:25 -0600
Subject: [gdal-dev] Motion: promote GDAL 3.4.1 RC1
In-Reply-To: <bf6482701f23424495c6726b1287d537@maanmittauslaitos.fi>
References: <bf6482701f23424495c6726b1287d537@maanmittauslaitos.fi>
Message-ID: <7C60047D-82BE-4274-9304-0F946121F4A8@hobu.co>

+1

Howard

> On Dec 30, 2021, at 5:10 AM, Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> +1
> 
> -Jukka Rahkonen-
> 
> -----Alkuper?inen viesti-----
> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
> L?hetetty: torstai 30. joulukuuta 2021 11.30
> Vastaanottaja: gdal-dev at lists.osgeo.org
> Aihe: [gdal-dev] Motion: promote GDAL 3.4.1 RC1
> 
> Hi,
> 
> Having heard no issues being reported regarding RC1
> 
> Motion:
> 
> Adopt GDAL 3.4.1 RC1 as final 3.4.1 release
> 
> Starting with my +1
> 
> Even
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From ni_hao88 at hotmail.com  Mon Jan  3 10:03:55 2022
From: ni_hao88 at hotmail.com (ni hao)
Date: Mon, 3 Jan 2022 18:03:55 +0000
Subject: [gdal-dev] RPCs in GeoTIFF
Message-ID: <DM5PR02MB38628B17B76BABB6148947F8F1499@DM5PR02MB3862.namprd02.prod.outlook.com>

Hi list,

I use gdal-2.4.4.
I use gdalwarp to orthorectify RADARSAT-2 images with RPCs (in product.xml).
Now I have done some manipulation and save the result in GTiff (e.g., apply Sigma0 LUT).
How can I copy the RPC Metadata from product.xml into GTiff, so I can use gdalwarp RPC orthorectification?
What are the Python commands to call ?
Do I have to use VRT?

Thank you!

ds=gdal.Open(r"C:\RADARSAT-2\2008Feb10\product.xml")
ds.GetMetadata(domain='RPC')
{'HEIGHT_OFF': '1.400000000000000e+02', 'LINE_NUM_COEFF': '1.045003883698053e-03 -3.909147136274753e-05 9.670521993287788e-09 -1.540774061983927e-08 -1.230034082454030e-01 2.994775580755049e-08 3.800851793724760e-08 -7.321141763443381e-04 -3.070513868102579e-08 -3.263789159357597e-08 -1.074590548649705e+00 -1.422870424040082e-07 2.625729922759320e-07 3.515681824455183e-04 1.737795244565543e-08 -1.191967212586014e-06 -6.679635986447045e-04 9.917030647189506e-09 1.183063120029544e-06 9.020179141273994e-07', 'SAMP_SCALE': '1759', 'LONG_OFF': '-5.586200000000000e+00', 'SAMP_DEN_COEFF': '1.000000000000000e+00 -3.873791825160030e-04 -1.654041698986790e-06 1.045768201431545e-08 -7.357169048971613e-04 -5.663646053748347e-06 -2.270764362304154e-08 -7.511863551214131e-07 -3.061984244257416e-07 1.247909289740085e-07 1.555977062556944e-03 2.290649610770613e-06 1.138900631680699e-09 -4.788174308312700e-07 1.913987966778219e-07 -5.724932691905833e-08 5.283021826505342e-06 -2.470297385173699e-08 -5.008669473258436e-08 1.486018900494917e-08', 'ERR_BIAS': '5.000000000000000e-01', 'SAMP_NUM_COEFF': '1.448914459955711e-03 3.107453606755890e-02 -1.362345055216650e-05 -5.545316452513627e-08 1.177884096135199e+00 2.873729811978911e-04 -1.989082475494487e-06 -1.041938833100005e-03 8.430382868139787e-06 -1.570423196668063e-06 -2.556805573684327e-01 -1.724821081109771e-05 4.713416494967566e-07 -9.676787333902578e-04 -2.144746372053350e-06 8.115347578419969e-07 1.767758474109092e-04 2.353735909723349e-07 -6.444353128930045e-06 2.385344654290232e-07', 'LONG_SCALE': '1.859000000000000e-01', 'LINE_DEN_COEFF': '1.000000000000000e+00 -9.804190622020718e-08 -2.386942243966555e-07 1.801605395896790e-08 4.160880031382031e-04 -2.095235371483683e-08 -1.659952797934781e-08 -9.496784414468805e-07 4.758902993568164e-08 5.402628711262573e-08 4.472124981058622e-04 1.370099419045734e-08 -1.785667248922995e-08 7.981478756298640e-07 -7.327071351551446e-09 2.253346171933004e-07 1.637317283006711e-06 -5.178220338393535e-08 1.880261293686099e-06 5.550513900110941e-06', 'SAMP_OFF': '1705', 'LAT_SCALE': '2.073000000000000e-01', 'LAT_OFF': '3.590580000000000e+01', 'LINE_SCALE': '4229', 'LINE_OFF': '4227', 'ERR_RAND': '1.000000000000000e-01', 'HEIGHT_SCALE': '5.010000000000000e+02'}

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220103/01170524/attachment.html>

From jluis at ualg.pt  Mon Jan  3 12:15:01 2022
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 3 Jan 2022 20:15:01 +0000
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>
References: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>
Message-ID: <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>

Thanks. That's right that modifying the host name prints the same size info but there is nothing in the url that permits to estimate the "Pixel Size".

Also, this not the main issue. The main one is when passing a valid "GetMap" string that works in a browser but errors in gdal_translate.


From: Momtchil Momtchev <momtchil at momtchev.com>
Sent: Monday, January 3, 2022 3:08 PM
To: gdal-dev at lists.osgeo.org; Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
Subject: Re: [gdal-dev] Experiences with the WMS driver




    gdalinfo does not contact the remote server at all, it extracts all the information it displays from the URL.

    Try replacing the hostname with something invalid, keeping all the parameters and you will still get the same output.




On 01/01/2022 19:47, Joaquim Manuel Freire Lu?s wrote:


But if I do

gdalinfo "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE"

it seems to work but note the reported sizes and unreasonable resolution.

Data axis to CRS axis mapping: 1,2
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.000000335276127,-0.000000335276127)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
  Overviews: 536870912x268435456, 268435456x134217728, 134217728x67108864, 67108864x33554432, 33554432x16777216, 16777216x8388608, 8388608x4194304, 4194304x2097152, 2097152x1048576, 1048576x524288, 524288x262144, 262144x131072, 131072x65536, 65536x32768, 32768x16384, 16384x8192, 8192x4096, 4096x2048, 2048x1024, 1024x512



--

Momtchil Momtchev <momtchil at momtchev.com><mailto:momtchil at momtchev.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220103/0c92f028/attachment.html>

From even.rouault at spatialys.com  Tue Jan  4 03:25:15 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Jan 2022 12:25:15 +0100
Subject: [gdal-dev] Motion: promote GDAL 3.4.1 RC1
In-Reply-To: <c8327cc5-3da5-4509-9002-130d582a54d5@spatialys.com>
References: <c8327cc5-3da5-4509-9002-130d582a54d5@spatialys.com>
Message-ID: <a2f5004c-7570-0dfb-405d-3b96764a5515@spatialys.com>

Motion passed with +1 from PSC members JukkaR, HowardB and me

Le 30/12/2021 ? 10:30, Even Rouault a ?crit?:
> Hi,
>
> Having heard no issues being reported regarding RC1
>
> Motion:
>
> Adopt GDAL 3.4.1 RC1 as final 3.4.1 release
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Jan  4 03:28:28 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Jan 2022 12:28:28 +0100
Subject: [gdal-dev] GDAL 3.4.1 is released
Message-ID: <d52e0153-1cd0-f132-ed13-159c1c25acf8@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the
release of the GDAL/OGR 3.4.1 bug fix version.

Consult the release notes for the list of issues addressed :

 ? https://github.com/OSGeo/gdal/blob/v3.4.1/gdal/NEWS.md

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.4.1/gdal-3.4.1.tar.xz
 ??? https://download.osgeo.org/gdal/3.4.1/gdal-3.4.1.tar.gz
 ??? https://download.osgeo.org/gdal/3.4.1/gdal341.zip
 ??? https://download.osgeo.org/gdal/3.4.1/gdal-grass-3.4.1.tar.gz

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From ni_hao88 at hotmail.com  Tue Jan  4 14:00:21 2022
From: ni_hao88 at hotmail.com (ni hao)
Date: Tue, 4 Jan 2022 22:00:21 +0000
Subject: [gdal-dev] RPCs in GeoTIFF
In-Reply-To: <DM5PR02MB38628B17B76BABB6148947F8F1499@DM5PR02MB3862.namprd02.prod.outlook.com>
References: <DM5PR02MB38628B17B76BABB6148947F8F1499@DM5PR02MB3862.namprd02.prod.outlook.com>
Message-ID: <DM5PR02MB38622775BD6A87778454CE60F14A9@DM5PR02MB3862.namprd02.prod.outlook.com>

Hi list,

https://gis.stackexchange.com/questions/264644/transfer-rpc-metadata-from-one-geotiff-to-another
The above link showed me how to do it.

thanks.

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of ni hao <ni_hao88 at hotmail.com>
Sent: January 3, 2022 2:03 PM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] RPCs in GeoTIFF

Hi list,

I use gdal-2.4.4.
I use gdalwarp to orthorectify RADARSAT-2 images with RPCs (in product.xml).
Now I have done some manipulation and save the result in GTiff (e.g., apply Sigma0 LUT).
How can I copy the RPC Metadata from product.xml into GTiff, so I can use gdalwarp RPC orthorectification?
What are the Python commands to call ?
Do I have to use VRT?

Thank you!

ds=gdal.Open(r"C:\RADARSAT-2\2008Feb10\product.xml")
ds.GetMetadata(domain='RPC')
{'HEIGHT_OFF': '1.400000000000000e+02', 'LINE_NUM_COEFF': '1.045003883698053e-03 -3.909147136274753e-05 9.670521993287788e-09 -1.540774061983927e-08 -1.230034082454030e-01 2.994775580755049e-08 3.800851793724760e-08 -7.321141763443381e-04 -3.070513868102579e-08 -3.263789159357597e-08 -1.074590548649705e+00 -1.422870424040082e-07 2.625729922759320e-07 3.515681824455183e-04 1.737795244565543e-08 -1.191967212586014e-06 -6.679635986447045e-04 9.917030647189506e-09 1.183063120029544e-06 9.020179141273994e-07', 'SAMP_SCALE': '1759', 'LONG_OFF': '-5.586200000000000e+00', 'SAMP_DEN_COEFF': '1.000000000000000e+00 -3.873791825160030e-04 -1.654041698986790e-06 1.045768201431545e-08 -7.357169048971613e-04 -5.663646053748347e-06 -2.270764362304154e-08 -7.511863551214131e-07 -3.061984244257416e-07 1.247909289740085e-07 1.555977062556944e-03 2.290649610770613e-06 1.138900631680699e-09 -4.788174308312700e-07 1.913987966778219e-07 -5.724932691905833e-08 5.283021826505342e-06 -2.470297385173699e-08 -5.008669473258436e-08 1.486018900494917e-08', 'ERR_BIAS': '5.000000000000000e-01', 'SAMP_NUM_COEFF': '1.448914459955711e-03 3.107453606755890e-02 -1.362345055216650e-05 -5.545316452513627e-08 1.177884096135199e+00 2.873729811978911e-04 -1.989082475494487e-06 -1.041938833100005e-03 8.430382868139787e-06 -1.570423196668063e-06 -2.556805573684327e-01 -1.724821081109771e-05 4.713416494967566e-07 -9.676787333902578e-04 -2.144746372053350e-06 8.115347578419969e-07 1.767758474109092e-04 2.353735909723349e-07 -6.444353128930045e-06 2.385344654290232e-07', 'LONG_SCALE': '1.859000000000000e-01', 'LINE_DEN_COEFF': '1.000000000000000e+00 -9.804190622020718e-08 -2.386942243966555e-07 1.801605395896790e-08 4.160880031382031e-04 -2.095235371483683e-08 -1.659952797934781e-08 -9.496784414468805e-07 4.758902993568164e-08 5.402628711262573e-08 4.472124981058622e-04 1.370099419045734e-08 -1.785667248922995e-08 7.981478756298640e-07 -7.327071351551446e-09 2.253346171933004e-07 1.637317283006711e-06 -5.178220338393535e-08 1.880261293686099e-06 5.550513900110941e-06', 'SAMP_OFF': '1705', 'LAT_SCALE': '2.073000000000000e-01', 'LAT_OFF': '3.590580000000000e+01', 'LINE_SCALE': '4229', 'LINE_OFF': '4227', 'ERR_RAND': '1.000000000000000e-01', 'HEIGHT_SCALE': '5.010000000000000e+02'}

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220104/69259688/attachment.html>

From momtchil at momtchev.com  Tue Jan  4 15:48:26 2022
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Wed, 5 Jan 2022 00:48:26 +0100
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>
 <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <9929ee11-c6a9-3b15-e8a4-b0f216c17934@momtchev.com>


This server serves fixedWidth/fixedHeight images which are indeed part 
of the WMS specification, but as far as I am aware, GDAL does not 
support them.


On 03/01/2022 21:15, Joaquim Manuel Freire Lu?s wrote:
>
> Thanks. That?s right that modifying the host name prints the same size 
> info but there is nothing in the url that permits to estimate the 
> ?Pixel Size?.
>
> Also, this not the main issue. The main one is when passing a valid 
> ?GetMap? string that works in a browser but errors in gdal_translate.
>
> *From:*Momtchil Momtchev <momtchil at momtchev.com>
> *Sent:* Monday, January 3, 2022 3:08 PM
> *To:* gdal-dev at lists.osgeo.org; Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
> *Subject:* Re: [gdal-dev] Experiences with the WMS driver
>
> ??? gdalinfo does not contact the remote server at all, it extracts 
> all the information it displays from the URL.
>
> ??? Try replacing the hostname with something invalid, keeping all the 
> parameters and you will still get the same output.
>
> On 01/01/2022 19:47, Joaquim Manuel Freire Lu?s wrote:
>
>     But if I do
>
>     gdalinfo
>     "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE
>     <http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE>"
>
>     it seems to work but note the reported sizes and unreasonable
>     resolution.
>
>     Data axis to CRS axis mapping: 1,2
>
>     Origin = (-180.000000000000000,90.000000000000000)
>
>     Pixel Size = (0.000000335276127,-0.000000335276127)
>
>     Image Structure Metadata:
>
>     ? INTERLEAVE=PIXEL
>
>     Corner Coordinates:
>
>     Upper Left (-180.0000000,? 90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
>
>     Lower Left (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
>
>     Upper Right ( 180.0000000,? 90.0000000) (180d 0' 0.00"E, 90d 0'
>     0.00"N)
>
>     Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0'
>     0.00"S)
>
>     Center????? (?? 0.0000000,?? 0.0000000) (? 0d 0' 0.01"E,? 0d 0'
>     0.01"N)
>
>     Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
>
>     ? Overviews: 536870912x268435456, 268435456x134217728,
>     134217728x67108864, 67108864x33554432, 33554432x16777216,
>     16777216x8388608, 8388608x4194304, 4194304x2097152,
>     2097152x1048576, 1048576x524288, 524288x262144, 262144x131072,
>     131072x65536, 65536x32768, 32768x16384, 16384x8192, 8192x4096,
>     4096x2048, 2048x1024, 1024x512
>
> -- 
> Momtchil Momtchev<momtchil at momtchev.com>  <mailto:momtchil at momtchev.com>

-- 
Momtchil Momtchev <momtchil at momtchev.com>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220105/0fe96d5c/attachment-0001.html>

From momtchil at momtchev.com  Tue Jan  4 16:18:01 2022
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Wed, 5 Jan 2022 01:18:01 +0100
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>
 <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <b12297d3-e7d6-aeb3-d3cb-1247e58c780b@momtchev.com>


 ??? You can get the raw image with curl (it is just a static image):

$ curl "https://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&request=GetMap&version=1.3.0&layers=3170_21483_bg&styles=&format=image/png&bbox=-180,-90,180,90&crs=CRS:84&transparent=FALSE&width=922&height=461"? --output raw.png

 ??? Then use gdal_translate to georeference it:

$ gdal_translate -a_srs CRS:84? -a_ullr -180 90 180 -90 raw.png out.png


On 03/01/2022 21:15, Joaquim Manuel Freire Lu?s wrote:
>
> Thanks. That?s right that modifying the host name prints the same size 
> info but there is nothing in the url that permits to estimate the 
> ?Pixel Size?.
>
> Also, this not the main issue. The main one is when passing a valid 
> ?GetMap? string that works in a browser but errors in gdal_translate.
>
> *From:*Momtchil Momtchev <momtchil at momtchev.com>
> *Sent:* Monday, January 3, 2022 3:08 PM
> *To:* gdal-dev at lists.osgeo.org; Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
> *Subject:* Re: [gdal-dev] Experiences with the WMS driver
>
> ??? gdalinfo does not contact the remote server at all, it extracts 
> all the information it displays from the URL.
>
> ??? Try replacing the hostname with something invalid, keeping all the 
> parameters and you will still get the same output.
>
> On 01/01/2022 19:47, Joaquim Manuel Freire Lu?s wrote:
>
>     But if I do
>
>     gdalinfo
>     "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE
>     <http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE>"
>
>     it seems to work but note the reported sizes and unreasonable
>     resolution.
>
>     Data axis to CRS axis mapping: 1,2
>
>     Origin = (-180.000000000000000,90.000000000000000)
>
>     Pixel Size = (0.000000335276127,-0.000000335276127)
>
>     Image Structure Metadata:
>
>     ? INTERLEAVE=PIXEL
>
>     Corner Coordinates:
>
>     Upper Left (-180.0000000,? 90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
>
>     Lower Left (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
>
>     Upper Right ( 180.0000000,? 90.0000000) (180d 0' 0.00"E, 90d 0'
>     0.00"N)
>
>     Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0'
>     0.00"S)
>
>     Center????? (?? 0.0000000,?? 0.0000000) (? 0d 0' 0.01"E,? 0d 0'
>     0.01"N)
>
>     Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
>
>     ? Overviews: 536870912x268435456, 268435456x134217728,
>     134217728x67108864, 67108864x33554432, 33554432x16777216,
>     16777216x8388608, 8388608x4194304, 4194304x2097152,
>     2097152x1048576, 1048576x524288, 524288x262144, 262144x131072,
>     131072x65536, 65536x32768, 32768x16384, 16384x8192, 8192x4096,
>     4096x2048, 2048x1024, 1024x512
>
> -- 
> Momtchil Momtchev<momtchil at momtchev.com>  <mailto:momtchil at momtchev.com>

-- 
Momtchil Momtchev <momtchil at momtchev.com>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220105/3abcf2c9/attachment.html>

From jluis at ualg.pt  Wed Jan  5 07:16:59 2022
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Wed, 5 Jan 2022 15:16:59 +0000
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <b12297d3-e7d6-aeb3-d3cb-1247e58c780b@momtchev.com>
References: <AM6PR04MB3959E80741A2861A1E534ADFA6479@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <295a97a0-f6fc-214f-6a05-18566b18bc7e@momtchev.com>
 <AM6PR04MB395925AB09714E5FFC64485FA6499@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <b12297d3-e7d6-aeb3-d3cb-1247e58c780b@momtchev.com>
Message-ID: <AM6PR04MB395994CF72B58D0B257EDC2CA64B9@AM6PR04MB3959.eurprd04.prod.outlook.com>

Tanks again Momtchil. Your example works indeed ... but not with my layer

curl http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&LAYERS=3140_21200&CRS=CRS:84&FORMAT=image/png&TRANSPARENT=FALSE&HEIGHT=512&BGCOLOR=&REQUEST=GetMap&WIDTH=2048&BBOX=-50.2,69.11,-49.6,69.26&STYLES=&VERSION=1.3.0 --output raw.png

the output is an html file saying

<p>The document has moved <a href=https://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&amp;LAYERS=3140_21200&amp;CRS=CRS:84&amp;FORMAT=image/png&amp;TRANSPARENT=FALSE&amp;HEIGHT=512&amp;BGCOLOR=&amp;REQUEST=GetMap&amp;WIDTH=2048&amp;BBOX=-50.2,69.11,-49.6,69.26&amp;STYLES=&amp;VERSION=1.3.0>here</a>.</p>
</body></html>

Anyway, the curl solution is of little interest for me because I don't know how to programmatically select it instead of using gdal_translate.

From: Momtchil Momtchev <momtchil at momtchev.com>
Sent: Wednesday, January 5, 2022 12:18 AM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Experiences with the WMS driver




    You can get the raw image with curl (it is just a static image):

$ curl "https://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&request=GetMap&version=1.3.0&layers=3170_21483_bg&styles=&format=image/png&bbox=-180,-90,180,90&crs=CRS:84&transparent=FALSE&width=922&height=461"<https://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&request=GetMap&version=1.3.0&layers=3170_21483_bg&styles=&format=image/png&bbox=-180,-90,180,90&crs=CRS:84&transparent=FALSE&width=922&height=461>  --output raw.png

    Then use gdal_translate to georeference it:

$ gdal_translate -a_srs CRS:84  -a_ullr -180 90 180 -90 raw.png out.png


On 03/01/2022 21:15, Joaquim Manuel Freire Lu?s wrote:
Thanks. That's right that modifying the host name prints the same size info but there is nothing in the url that permits to estimate the "Pixel Size".

Also, this not the main issue. The main one is when passing a valid "GetMap" string that works in a browser but errors in gdal_translate.


From: Momtchil Momtchev <momtchil at momtchev.com><mailto:momtchil at momtchev.com>
Sent: Monday, January 3, 2022 3:08 PM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>; Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>
Subject: Re: [gdal-dev] Experiences with the WMS driver




    gdalinfo does not contact the remote server at all, it extracts all the information it displays from the URL.

    Try replacing the hostname with something invalid, keeping all the parameters and you will still get the same output.




On 01/01/2022 19:47, Joaquim Manuel Freire Lu?s wrote:


But if I do

gdalinfo "WMS:http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&LAYERS=3170_21483_bg&CRS=CRS:84&BBOX=-180.0,-90.0,180.0,90.0&TRANSPARENT=FALSE"

it seems to work but note the reported sizes and unreasonable resolution.

Data axis to CRS axis mapping: 1,2
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.000000335276127,-0.000000335276127)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"N)
Lower Left  (-180.0000000, -90.0000000) (180d 0' 0.00"W, 90d 0' 0.00"S)
Upper Right ( 180.0000000,  90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"N)
Lower Right ( 180.0000000, -90.0000000) (180d 0' 0.00"E, 90d 0' 0.00"S)
Center      (   0.0000000,   0.0000000) (  0d 0' 0.01"E,  0d 0' 0.01"N)
Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
  Overviews: 536870912x268435456, 268435456x134217728, 134217728x67108864, 67108864x33554432, 33554432x16777216, 16777216x8388608, 8388608x4194304, 4194304x2097152, 2097152x1048576, 1048576x524288, 524288x262144, 262144x131072, 131072x65536, 65536x32768, 32768x16384, 16384x8192, 8192x4096, 4096x2048, 2048x1024, 1024x512



--

Momtchil Momtchev <momtchil at momtchev.com><mailto:momtchil at momtchev.com>

--

Momtchil Momtchev <momtchil at momtchev.com><mailto:momtchil at momtchev.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220105/79d726d5/attachment-0001.html>

From mladen-g at distributel.net  Wed Jan  5 08:18:11 2022
From: mladen-g at distributel.net (mladen-g at distributel.net)
Date: Wed, 05 Jan 2022 16:18:11 +0000
Subject: [gdal-dev] Experiences with the WMS driver
In-Reply-To: <mailman.36671.1641395825.1889.gdal-dev@lists.osgeo.org>
Message-ID: <20220105161811.Horde.Yx2P6JrKrIHItqhjK3ADCgk@webmail.distributel.net>

Hi Joaquim,

FYI your curl command will work if you update the URL to what is in  
the HTML file message (looks like it was moved to HTTPS instead of  
HTTP).

I understand it's not what you want in the end, just thought I'd point  
it out in case it's useful for troubleshooting.

Quoting jluis at ualg.pt:
>
> Tanks again Momtchil. Your example works indeed ? but not with my layer
>
> curl  
> http://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&LAYERS=3140_21200&CRS=CRS:84&FORMAT=image/png&TRANSPARENT=FALSE&HEIGHT=512&BGCOLOR=&REQUEST=GetMap&WIDTH=2048&BBOX=-50.2,69.11,-49.6,69.26> &STYLES=&VERSION=1.3.0 --output  
> raw.png
>
> the output is an html file saying
>
> <p>The document has moved <a  
> href=https://svs.gsfc.nasa.gov/cgi-bin/wms?SERVICE=WMS&amp;LAYERS=3140_21200&amp;CRS=CRS:84&amp;FORMAT=image/png&amp;TRANSPARENT=FALSE&amp;HEIGHT=512&amp;BGCOLOR=&amp;REQUEST=GetMap&amp;WIDTH=2048&amp;BBOX=-50.2,69.11,-49.6,69.26&amp;STYLES=&amp;VERSION=1.3.0>here</a>.</p>
> </body></html>
>
> Anyway, the curl solution is of little interest for me because I  
> don?t know how to programmatically select it instead of using  
> gdal_translate."




From Marta.Kopszak at orange.com  Mon Jan 10 02:27:44 2022
From: Marta.Kopszak at orange.com (Kopszak Marta - Partner Hurt)
Date: Mon, 10 Jan 2022 10:27:44 +0000
Subject: [gdal-dev] Bug in OGR library
Message-ID: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>

Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak
[Logo Orange]<https://www.orange.pl/>

Marta Kopszak
Wsp??pracownik

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych<https://www.orange.pl/zobacz/rodo>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/ea220108/attachment.html>

From even.rouault at spatialys.com  Mon Jan 10 02:42:29 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jan 2022 11:42:29 +0100
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
References: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
Message-ID: <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>

Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 
columns and 1048576 rows ? By quickly looking at the code I can't see an 
obvious limitation, but that doesn't mean anything. Closer investigation 
would be needed. Please file an issue at 
https://github.com/OSGeo/gdal/issues/new with exact details how to 
reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would 
probably have issues as the whole spreadsheet will be loaded into RAM 
and for 2 billion cells, I would expect at least 32 or more GB of RAM to 
be needed. Perhaps spreadsheet software are able to cope with that in a 
smarter way.

Even

Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit?:
>
> Dear Sirs,
>
> I ran into an error when exporting data through the OGR library to the 
> .xlsx and .ods format. The bug occurs when there are more than 2 
> billion records in the database. I know the problem was solved for 
> other formats, e.g. csv. Will the problem be solved also for other 
> formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please 
> forward this e-mail to the appropriate person.
>
> Kind regards,
>
> Marta Kopszak
>
> Logo Orange <https://www.orange.pl/>
>
> *Marta Kopszak*
> Wsp??pracownik
>
> Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
> Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - 
> informacja o danych <https://www.orange.pl/zobacz/rodo>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/2d5fdcf3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 10 02:45:56 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 10 Jan 2022 10:45:56 +0000
Subject: [gdal-dev] Bug in OGR library
Message-ID: <4f8a72cf5aa844698dd7e754f402baff@maanmittauslaitos.fi>

Hi,

Excel xlsx format supports at maximum 1,048,576 rows by 16,384 columns https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3. Do your data fit within these limits?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 12.28
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Bug in OGR library

Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak
[L?hett?j? poisti kuvan. Logo Orange]<https://www.orange.pl/>

Marta Kopszak
Wsp??pracownik

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych<https://www.orange.pl/zobacz/rodo>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/3c7c0d17/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ~WRD0000.jpg
Type: image/jpeg
Size: 823 bytes
Desc: ~WRD0000.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/3c7c0d17/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 380 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/3c7c0d17/attachment-0001.jpg>

From andreas.oxenstierna at t-kartor.com  Mon Jan 10 04:11:12 2022
From: andreas.oxenstierna at t-kartor.com (Andreas Oxenstierna)
Date: Mon, 10 Jan 2022 12:11:12 +0000
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
References: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
 <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
Message-ID: <50cd8389-73dc-422a-9a7b-535846bcc20e@Spark>

Excel limitations, see https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3

ODS: https://wiki.openoffice.org/wiki/Documentation/FAQ/Calc/Miscellaneous/What%27s_the_maximum_number_of_rows_and_cells_for_a_spreadsheet_file%3F

H?lsningar

Andreas Oxenstierna
T-Kartor Geospatial AB
Olof Mohlins v?g 12 Kristianstad
mobile: +46 733 206831
mailto: andreas.oxenstierna at t-kartor.com<mailto:andreas.oxenstierna at t-kartor.com>
www.t-kartor.com<http://www.t-kartor.com>
On 10 Jan 2022, 11:42 +0100, Even Rouault <even.rouault at spatialys.com>, wrote:

Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even

Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak
[Logo Orange]<https://www.orange.pl/>
Marta Kopszak
Wsp??pracownik
Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych<https://www.orange.pl/zobacz/rodo>




_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/1e519320/attachment-0001.html>

From Marta.Kopszak at orange.com  Mon Jan 10 04:34:07 2022
From: Marta.Kopszak at orange.com (Kopszak Marta - Partner Hurt)
Date: Mon, 10 Jan 2022 12:34:07 +0000
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
References: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
 <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
Message-ID: <3c99b38ae23c4e858c680b10b8362b43@orange.com>

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/e3b5657f/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 10 04:42:49 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 10 Jan 2022 12:42:49 +0000
Subject: [gdal-dev] Bug in OGR library
Message-ID: <4e32aef471484402b50d0277dee3b81c@maanmittauslaitos.fi>

Hi,

Could you clarify a bit? You have billion rows in the database table but xlsx and ods can support at maximum a bit more than one million rows (1,048,576). You can?t imagine to have success with converting the whole table. Or is your problem that you can?t write even a single row from the source table because the value of the ID key is too big for xlsx/ods formats?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 14.34
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Bug in OGR library

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/f0e7bd52/attachment-0001.html>

From Marta.Kopszak at orange.com  Mon Jan 10 05:06:48 2022
From: Marta.Kopszak at orange.com (Kopszak Marta - Partner Hurt)
Date: Mon, 10 Jan 2022 13:06:48 +0000
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <4e32aef471484402b50d0277dee3b81c@maanmittauslaitos.fi>
References: <4e32aef471484402b50d0277dee3b81c@maanmittauslaitos.fi>
Message-ID: <2619a3f7518a4a6aa6f1a9c3c0cf9146@orange.com>

I have 2 bilions of rows in the  whole database and I try to export only one table which has 56 columns and 423 thousands of rows so it?s not the issue with Microsoft Excel limitation. I can?t write even a single row (error Feature creation error (OGR error: negative FID are not supported) occurs immediately),
Marta Kopszak

Hi,

Could you clarify a bit? You have billion rows in the database table but xlsx and ods can support at maximum a bit more than one million rows (1,048,576). You can?t imagine to have success with converting the whole table. Or is your problem that you can?t write even a single row from the source table because the value of the ID key is too big for xlsx/ods formats?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 14.34
Vastaanottaja: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Bug in OGR library

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/0ec8b5c9/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 10 05:24:18 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 10 Jan 2022 13:24:18 +0000
Subject: [gdal-dev] Bug in OGR library
Message-ID: <9242de58a0a14ad88d652080281a4941@maanmittauslaitos.fi>

Hi,

Now it starts to make sense. Could you paste the contents of a single row that you can?t write into xlsx format? You can capture it with ogrinfo ?ogrinto [database connection] -sql "select * from my_table limit 1". Or maybe better to convert that row into GML format and attach that to your mail.

-Jukka Rahkonen-

L?hett?j?: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com>
L?hetetty: maanantai 10. tammikuuta 2022 15.07
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Aihe: RE: [gdal-dev] Bug in OGR library

I have 2 bilions of rows in the  whole database and I try to export only one table which has 56 columns and 423 thousands of rows so it?s not the issue with Microsoft Excel limitation. I can?t write even a single row (error Feature creation error (OGR error: negative FID are not supported) occurs immediately),
Marta Kopszak

Hi,

Could you clarify a bit? You have billion rows in the database table but xlsx and ods can support at maximum a bit more than one million rows (1,048,576). You can?t imagine to have success with converting the whole table. Or is your problem that you can?t write even a single row from the source table because the value of the ID key is too big for xlsx/ods formats?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 14.34
Vastaanottaja: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Bug in OGR library

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/6f69c49e/attachment-0001.html>

From Marta.Kopszak at orange.com  Mon Jan 10 06:08:33 2022
From: Marta.Kopszak at orange.com (Kopszak Marta - Partner Hurt)
Date: Mon, 10 Jan 2022 14:08:33 +0000
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <9242de58a0a14ad88d652080281a4941@maanmittauslaitos.fi>
References: <9242de58a0a14ad88d652080281a4941@maanmittauslaitos.fi>
Message-ID: <aca31f9e3b5f4245a3062b951eef5d0d@orange.com>

I think a single record wouldn't help you. If I would copy only one record to another empty database it could be exported to .xlsx. We have a postgres database and a table without any primary key, so QGIS uses a tid. The overall size of the database is huuuge (billions of records), so the tid reaches high values and apparently overflows int4.

Export to CSV goes fine, so it seems OGR?s CSV driver uses int8, but when exporting to XLSX or ODS you get that error. Maybe it?s just as simple as change id datatypes in affected drivers?
From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Sent: Monday, January 10, 2022 2:24 PM
To: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com>; Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Bug in OGR library

Hi,

Now it starts to make sense. Could you paste the contents of a single row that you can?t write into xlsx format? You can capture it with ogrinfo ?ogrinto [database connection] -sql "select * from my_table limit 1". Or maybe better to convert that row into GML format and attach that to your mail.

-Jukka Rahkonen-

L?hett?j?: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com<mailto:Marta.Kopszak at orange.com>>
L?hetetty: maanantai 10. tammikuuta 2022 15.07
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>; Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: RE: [gdal-dev] Bug in OGR library

I have 2 bilions of rows in the  whole database and I try to export only one table which has 56 columns and 423 thousands of rows so it?s not the issue with Microsoft Excel limitation. I can?t write even a single row (error Feature creation error (OGR error: negative FID are not supported) occurs immediately),
Marta Kopszak

Hi,

Could you clarify a bit? You have billion rows in the database table but xlsx and ods can support at maximum a bit more than one million rows (1,048,576). You can?t imagine to have success with converting the whole table. Or is your problem that you can?t write even a single row from the source table because the value of the ID key is too big for xlsx/ods formats?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 14.34
Vastaanottaja: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Bug in OGR library

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/ca767ca5/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 10 06:19:15 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 10 Jan 2022 14:19:15 +0000
Subject: [gdal-dev] Bug in OGR library
Message-ID: <21f29ed3c1e64764a9445870049faec3@maanmittauslaitos.fi>

Hi,

I asked you to create a GML with SQL query from one feature in a hope that the huuuge value from your database would be generated as a FID and appear in GML. Did you try what happens?

So if missing primary key is the main problem why not to add a primary key into your table? Or did you already try to run ogr2ogr with -unsetFid?

-Jukka Rahkonen-

L?hett?j?: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com>
L?hetetty: maanantai 10. tammikuuta 2022 16.09
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Aihe: RE: [gdal-dev] Bug in OGR library

I think a single record wouldn't help you. If I would copy only one record to another empty database it could be exported to .xlsx. We have a postgres database and a table without any primary key, so QGIS uses a tid. The overall size of the database is huuuge (billions of records), so the tid reaches high values and apparently overflows int4.

Export to CSV goes fine, so it seems OGR?s CSV driver uses int8, but when exporting to XLSX or ODS you get that error. Maybe it?s just as simple as change id datatypes in affected drivers?

From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Sent: Monday, January 10, 2022 2:24 PM
To: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com<mailto:Marta.Kopszak at orange.com>>; Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library

Hi,

Now it starts to make sense. Could you paste the contents of a single row that you can?t write into xlsx format? You can capture it with ogrinfo ?ogrinto [database connection] -sql "select * from my_table limit 1". Or maybe better to convert that row into GML format and attach that to your mail.

-Jukka Rahkonen-

L?hett?j?: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com<mailto:Marta.Kopszak at orange.com>>
L?hetetty: maanantai 10. tammikuuta 2022 15.07
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>; Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: RE: [gdal-dev] Bug in OGR library

I have 2 bilions of rows in the  whole database and I try to export only one table which has 56 columns and 423 thousands of rows so it?s not the issue with Microsoft Excel limitation. I can?t write even a single row (error Feature creation error (OGR error: negative FID are not supported) occurs immediately),
Marta Kopszak

Hi,

Could you clarify a bit? You have billion rows in the database table but xlsx and ods can support at maximum a bit more than one million rows (1,048,576). You can?t imagine to have success with converting the whole table. Or is your problem that you can?t write even a single row from the source table because the value of the ID key is too big for xlsx/ods formats?

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> Puolesta Kopszak Marta - Partner Hurt
L?hetetty: maanantai 10. tammikuuta 2022 14.34
Vastaanottaja: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] Bug in OGR library

Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/662e9325/attachment-0001.html>

From rajsekar at gmail.com  Mon Jan 10 06:21:33 2022
From: rajsekar at gmail.com (Rajsekar Manokaran)
Date: Mon, 10 Jan 2022 19:51:33 +0530
Subject: [gdal-dev] Discrepancy in proj values between ubuntu-small and
 ubuntu-full images
Message-ID: <CA+4CNMEhV=MvEyDiEPHJEyMbkoyR_TM-pNUjvja7AV_6r08FxQ@mail.gmail.com>

Hi gdal devs and users,

I came across a discrepancy in proj. values between ubuntu-small and
ubuntu-full docker images even for the same gdal version tag.  I tried to
convert a few coords from epsg:4326 to epsg:2271.  The coords are:

Input:
-77.75 40.16666666666666  # this is the center meridian, lat of 2271
-75.18094433657971 40.25904959199275  # another sample point

The outputs of all ubuntu-small-* images seem to be correct, but the
ubuntu-full-* images have about 1 feet error (2271 uses US_SURVEY_FEET
units).

Here's how I run it:

$ docker run --rm -i osgeo/gdal:"$tag" cs2cs '+init=epsg:4326' '+to'
'+init=epsg:2271' < input
where tag is the docker tag: "ubuntu-full-3.2.2", or "ubuntu-small-3.4.1",
etc.

Here are the outputs for the ubuntu-full images:

output-ubuntu-full-3.2.2
1968499.39      -0.15 0.00
2685535.97      44295.90 0.00
output-ubuntu-full-3.3.3
1968499.39      -0.15 0.00
2685535.97      44295.90 0.00
output-ubuntu-full-3.4.1
1968499.39      -0.15 0.00
2685535.97      44295.90 0.00

Here are the outputs for the small images:

output-ubuntu-small-3.2.2
1968500.00      -0.00 0.00
2685536.18      44296.27 0.00
output-ubuntu-small-3.3.3
1968500.00      -0.00 0.00
2685536.18      44296.27 0.00
output-ubuntu-small-3.4.1
1968500.00      -0.00 0.00
2685536.18      44296.27 0.00

The first input is the center and so should translate to "(false east,
false north)".  Going by that, the small versions seem to be more correct.
Any idea why this difference in the values?

-
Rajsekar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/50efcb41/attachment.html>

From even.rouault at spatialys.com  Mon Jan 10 06:22:25 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jan 2022 15:22:25 +0100
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <3c99b38ae23c4e858c680b10b8362b43@orange.com>
References: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
 <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
 <3c99b38ae23c4e858c680b10b8362b43@orange.com>
Message-ID: <b8b21fd1-f3b9-fa89-e214-99a986ee3c1b@spatialys.com>

Marta,

I was lucky enough to figure out from the error messages that your issue 
came when using QGIS, but it would have been appropriate to mention it 
from the start so we get the global picture.

This is in fact a QGIS bug, which is only seen with the ODS & XLSX 
driver since they use the OGR Memory driver underneath and it has 
special behavior when creating a feature with a set FID.

I've submitted a QGIS bug fix for that in 
https://github.com/qgis/QGIS/pull/46773

Even

Le 10/01/2022 ? 13:34, Kopszak Marta - Partner Hurt a ?crit?:
>
> Hi Even,
>
> Thanks for your replay. More info about the problem:
>
> *Error:*
> /Save error:/
>
> /Export to vector file failed./
>
> /Error: Feature write errors:/
>
> /Feature creation error (OGR error: negative FID are not supported)/
>
> //
>
> The database has more than 2 bilons of records (record ? I mean record 
> in the database table). The error occurs when I export a single table 
> witout the primary key to .xlsx.
>
> I suppose that when the table doesn?t have the primary key it use tid 
> ? the tuple identifier, and the size of tid may exceed the size of a 
> 32-bit integer. It cause the problem to export this table to .xlsx 
> format by OGR library.
>
> Regards,
>
> Marta Kopszak
>
> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Even 
> Rouault
> *Sent:* Monday, January 10, 2022 11:42 AM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Bug in OGR library
>
> Marta,
>
> What is the bug exactly ?
>
> "2 billion records" : by record, you mean cells, like a sheet with 
> 2048 columns and 1048576 rows ? By quickly looking at the code I can't 
> see an obvious limitation, but that doesn't mean anything. Closer 
> investigation would be needed. Please file an issue at 
> https://github.com/OSGeo/gdal/issues/new 
> <https://github.com/OSGeo/gdal/issues/new> with exact details how to 
> reproduce (number of rows/features, and columns/fields in particular).
>
> But even if the writer side would work, the OGR reader side would 
> probably have issues as the whole spreadsheet will be loaded into RAM 
> and for 2 billion cells, I would expect at least 32 or more GB of RAM 
> to be needed. Perhaps spreadsheet software are able to cope with that 
> in a smarter way.
>
> Even
>
> Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit?:
>
>     Dear Sirs,
>
>     I ran into an error when exporting data through the OGR library to
>     the .xlsx and .ods format. The bug occurs when there are more than
>     2 billion records in the database. I know the problem was solved
>     for other formats, e.g. csv. Will the problem be solved also for
>     other formats (e.g. xlsx, .ods)? If this is not the correct
>     e-mail, please forward this e-mail to the appropriate person.
>
>     Kind regards,
>
>     Marta Kopszak
>
>
>     *Marta Kopszak*
>     Wsp??pracownik <https://www.orange.pl/>
>
>     Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
>     Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | _RODO
>     - informacja o danych_ <https://www.orange.pl/>
>
>     <https://www.orange.pl/>
>
>
>     <https://www.orange.pl/>
>
>     _______________________________________________  <https://www.orange.pl/>
>
>     gdal-dev mailing list  <https://www.orange.pl/>
>
>     _gdal-dev at lists.osgeo.org_  <https://www.orange.pl/>
>
>     _https://lists.osgeo.org/mailman/listinfo/gdal-dev_  <https://www.orange.pl/>
>
> --   <https://www.orange.pl/>
> _http://www.spatialys.com_  <https://www.orange.pl/>
> My software is free, but my time generally not.  <https://www.orange.pl/>

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/18cd400f/attachment.html>

From even.rouault at spatialys.com  Mon Jan 10 06:35:44 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jan 2022 15:35:44 +0100
Subject: [gdal-dev] Discrepancy in proj values between ubuntu-small and
 ubuntu-full images
In-Reply-To: <CA+4CNMEhV=MvEyDiEPHJEyMbkoyR_TM-pNUjvja7AV_6r08FxQ@mail.gmail.com>
References: <CA+4CNMEhV=MvEyDiEPHJEyMbkoyR_TM-pNUjvja7AV_6r08FxQ@mail.gmail.com>
Message-ID: <30afd1e3-b4bf-e0c4-230c-8a733e882865@spatialys.com>

Rajsekar,

One of the reason that the -full image is larger than the -small one is 
that the former includes > 500 MB of geodetic grids, whereas the later 
only includes very basic ones. (I've just amended 
https://github.com/OSGeo/gdal/blob/master/docker/README.md to make it 
clearer)

As you do a WGS 84 to NAD83 transformation, the ubuntu-full image can 
use the HPGN grids, and in particular the Pennsylviana grid

$ echo -77.75 40.16666666666666? | PROJ_DEBUG=2 bin/cs2cs 
'+init=epsg:4326' '+to' '+init=epsg:2271'
[ ... snip ... ]
Using coordinate operation axis order change (2D) + Inverse of NAD83 to 
WGS 84 (57) + SPCS83 Pennsylvania North zone (US Survey feet)
pj_open_lib(us_noaa_pahpgn.tif): call 
fopen(/home/even/proj/PROJ-data/us_noaa/us_noaa_pahpgn.tif) - succeeded
1968499.39??? -0.15 0.00

Whereas the -small image has no such grid and will assume that NAD83 == 
WGS84.

In theory the result with the -full image should be more accurate, but 
it depends if somewhere in your workflow someone has not assumed that 
NAD83 == WGS84 ...

Anyway WGS 84 is literaly a moving and somewhat fuzzy target, so you 
shouldn't expect in general results to have an accuracy better than ~ 2m 
in any transformation involving it.

Even

Le 10/01/2022 ? 15:21, Rajsekar Manokaran a ?crit?:
> Hi gdal devs and users,
>
> I came across a discrepancy in proj. values between ubuntu-small and 
> ubuntu-full docker images even for the same gdal version tag.? I tried 
> to convert a few coords from epsg:4326 to epsg:2271.? The coords are:
>
> Input:
> -77.75 40.16666666666666? # this is the center meridian, lat of 2271
> -75.18094433657971 40.25904959199275? # another sample point
>
> The outputs of all ubuntu-small-* images seem to be correct, but the 
> ubuntu-full-* images have about 1 feet error (2271 uses US_SURVEY_FEET 
> units).
>
> Here's how I run it:
>
> $ docker run --rm -i osgeo/gdal:"$tag" cs2cs '+init=epsg:4326' '+to' 
> '+init=epsg:2271' < input
> where tag is the docker tag: "ubuntu-full-3.2.2", or 
> "ubuntu-small-3.4.1", etc.
>
> Here are the outputs for the ubuntu-full images:
>
> output-ubuntu-full-3.2.2
> 1968499.39 ? ? ?-0.15 0.00
> 2685535.97 ? ? ?44295.90 0.00
> output-ubuntu-full-3.3.3
> 1968499.39 ? ? ?-0.15 0.00
> 2685535.97 ? ? ?44295.90 0.00
> output-ubuntu-full-3.4.1
> 1968499.39 ? ? ?-0.15 0.00
> 2685535.97 ? ? ?44295.90 0.00
>
> Here are the outputs for the small images:
>
> output-ubuntu-small-3.2.2
> 1968500.00 ? ? ?-0.00 0.00
> 2685536.18 ? ? ?44296.27 0.00
> output-ubuntu-small-3.3.3
> 1968500.00 ? ? ?-0.00 0.00
> 2685536.18 ? ? ?44296.27 0.00
> output-ubuntu-small-3.4.1
> 1968500.00 ? ? ?-0.00 0.00
> 2685536.18 ? ? ?44296.27 0.00
>
> The first input is the center and so should translate to "(false east, 
> false north)".? Going by that, the small versions seem to be more 
> correct.? Any idea why this difference in the values?
>
> -
> Rajsekar
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/9976a770/attachment-0001.html>

From rajsekar at gmail.com  Mon Jan 10 06:58:05 2022
From: rajsekar at gmail.com (Rajsekar Manokaran)
Date: Mon, 10 Jan 2022 20:28:05 +0530
Subject: [gdal-dev] Discrepancy in proj values between ubuntu-small and
 ubuntu-full images
In-Reply-To: <30afd1e3-b4bf-e0c4-230c-8a733e882865@spatialys.com>
References: <CA+4CNMEhV=MvEyDiEPHJEyMbkoyR_TM-pNUjvja7AV_6r08FxQ@mail.gmail.com>
 <30afd1e3-b4bf-e0c4-230c-8a733e882865@spatialys.com>
Message-ID: <CA+4CNMEDQR0ACj1xt_bcptyToagK1hWiVxnH3iX7JMP3ZvN=iw@mail.gmail.com>

Hi Even,

Thanks for explaining the difference between the images.  You're absolutely
right:  I indeed assumed the two were using the same ellipsoids.  If I use
epsg:4269 (nad83 ell.) as the src, all the numbers are consistent.

-
Regards
Rajsekar


On Mon, Jan 10, 2022 at 8:05 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Rajsekar,
>
> One of the reason that the -full image is larger than the -small one is
> that the former includes > 500 MB of geodetic grids, whereas the later only
> includes very basic ones. (I've just amended
> https://github.com/OSGeo/gdal/blob/master/docker/README.md to make it
> clearer)
>
> As you do a WGS 84 to NAD83 transformation, the ubuntu-full image can use
> the HPGN grids, and in particular the Pennsylviana grid
>
> $ echo -77.75 40.16666666666666  | PROJ_DEBUG=2 bin/cs2cs
> '+init=epsg:4326' '+to' '+init=epsg:2271'
> [ ... snip ... ]
> Using coordinate operation axis order change (2D) + Inverse of NAD83 to
> WGS 84 (57) + SPCS83 Pennsylvania North zone (US Survey feet)
> pj_open_lib(us_noaa_pahpgn.tif): call
> fopen(/home/even/proj/PROJ-data/us_noaa/us_noaa_pahpgn.tif) - succeeded
> 1968499.39    -0.15 0.00
>
> Whereas the -small image has no such grid and will assume that NAD83 ==
> WGS84.
>
> In theory the result with the -full image should be more accurate, but it
> depends if somewhere in your workflow someone has not assumed that NAD83 ==
> WGS84 ...
>
> Anyway WGS 84 is literaly a moving and somewhat fuzzy target, so you
> shouldn't expect in general results to have an accuracy better than ~ 2m in
> any transformation involving it.
>
> Even
> Le 10/01/2022 ? 15:21, Rajsekar Manokaran a ?crit :
>
> Hi gdal devs and users,
>
> I came across a discrepancy in proj. values between ubuntu-small and
> ubuntu-full docker images even for the same gdal version tag.  I tried to
> convert a few coords from epsg:4326 to epsg:2271.  The coords are:
>
> Input:
> -77.75 40.16666666666666  # this is the center meridian, lat of 2271
> -75.18094433657971 40.25904959199275  # another sample point
>
> The outputs of all ubuntu-small-* images seem to be correct, but the
> ubuntu-full-* images have about 1 feet error (2271 uses US_SURVEY_FEET
> units).
>
> Here's how I run it:
>
> $ docker run --rm -i osgeo/gdal:"$tag" cs2cs '+init=epsg:4326' '+to'
> '+init=epsg:2271' < input
> where tag is the docker tag: "ubuntu-full-3.2.2", or "ubuntu-small-3.4.1",
> etc.
>
> Here are the outputs for the ubuntu-full images:
>
> output-ubuntu-full-3.2.2
> 1968499.39      -0.15 0.00
> 2685535.97      44295.90 0.00
> output-ubuntu-full-3.3.3
> 1968499.39      -0.15 0.00
> 2685535.97      44295.90 0.00
> output-ubuntu-full-3.4.1
> 1968499.39      -0.15 0.00
> 2685535.97      44295.90 0.00
>
> Here are the outputs for the small images:
>
> output-ubuntu-small-3.2.2
> 1968500.00      -0.00 0.00
> 2685536.18      44296.27 0.00
> output-ubuntu-small-3.3.3
> 1968500.00      -0.00 0.00
> 2685536.18      44296.27 0.00
> output-ubuntu-small-3.4.1
> 1968500.00      -0.00 0.00
> 2685536.18      44296.27 0.00
>
> The first input is the center and so should translate to "(false east,
> false north)".  Going by that, the small versions seem to be more correct.
> Any idea why this difference in the values?
>
> -
> Rajsekar
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/9acf9157/attachment.html>

From Marta.Kopszak at orange.com  Mon Jan 10 07:18:05 2022
From: Marta.Kopszak at orange.com (Kopszak Marta - Partner Hurt)
Date: Mon, 10 Jan 2022 15:18:05 +0000
Subject: [gdal-dev] Bug in OGR library
In-Reply-To: <b8b21fd1-f3b9-fa89-e214-99a986ee3c1b@spatialys.com>
References: <df5f49efbe3644ce9883b2f9ab065a0b@orange.com>
 <d7303196-05a7-c0d4-c5fa-c95a7ec1a9ed@spatialys.com>
 <3c99b38ae23c4e858c680b10b8362b43@orange.com>
 <b8b21fd1-f3b9-fa89-e214-99a986ee3c1b@spatialys.com>
Message-ID: <681ed6c256b64e17bb77fb1c454b7be9@orange.com>

Thanks Even for very quick bug fix in QGIS!
Kind regards,
Marta


From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, January 10, 2022 3:22 PM
To: Kopszak Marta - Partner Hurt <Marta.Kopszak at orange.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

I was lucky enough to figure out from the error messages that your issue came when using QGIS, but it would have been appropriate to mention it from the start so we get the global picture.

This is in fact a QGIS bug, which is only seen with the ODS & XLSX driver since they use the OGR Memory driver underneath and it has special behavior when creating a feature with a set FID.

I've submitted a QGIS bug fix for that in https://github.com/qgis/QGIS/pull/46773

Even
Le 10/01/2022 ? 13:34, Kopszak Marta - Partner Hurt a ?crit :
Hi Even,
Thanks for your replay. More info about the problem:

Error:
Save error:
Export to vector file failed.
Error: Feature write errors:
Feature creation error (OGR error: negative FID are not supported)

The database has more than 2 bilons of records (record ? I mean record in the database table). The error occurs when I export a single table witout the primary key to .xlsx.

I suppose that when the table doesn?t have the primary key it use tid ? the tuple identifier, and the size of tid may exceed the size of a 32-bit integer. It cause the problem to export this table to .xlsx format by OGR library.

Regards,
Marta Kopszak

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org><mailto:gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Monday, January 10, 2022 11:42 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Bug in OGR library


Marta,

What is the bug exactly ?

"2 billion records" : by record, you mean cells, like a sheet with 2048 columns and 1048576 rows ? By quickly looking at the code I can't see an obvious limitation, but that doesn't mean anything. Closer investigation would be needed. Please file an issue at https://github.com/OSGeo/gdal/issues/new with exact details how to reproduce (number of rows/features, and columns/fields in particular).

But even if the writer side would work, the OGR reader side would probably have issues as the whole spreadsheet will be loaded into RAM and for 2 billion cells, I would expect at least 32 or more GB of RAM to be needed. Perhaps spreadsheet software are able to cope with that in a smarter way.

Even
Le 10/01/2022 ? 11:27, Kopszak Marta - Partner Hurt a ?crit :
Dear Sirs,
I ran into an error when exporting data through the OGR library to the .xlsx and .ods format. The bug occurs when there are more than 2 billion records in the database. I know the problem was solved for other formats, e.g. csv. Will the problem be solved also for other formats (e.g. xlsx, .ods)? If this is not the correct e-mail, please forward this e-mail to the appropriate person.

Kind regards,
Marta Kopszak

Marta Kopszak
Wsp??pracownik<https://www.orange.pl/>

Rozw?j Sieci Stacjonarnej, Wydzia? Rozwoju Planowania
Orange Polska, gen. Romualda Traugutta 55, 50-416 Wroc?aw | RODO - informacja o danych <https://www.orange.pl/>

 <https://www.orange.pl/>

<https://www.orange.pl/>

_______________________________________________<https://www.orange.pl/>

gdal-dev mailing list<https://www.orange.pl/>

gdal-dev at lists.osgeo.org<https://www.orange.pl/>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://www.orange.pl/>

-- <https://www.orange.pl/>

http://www.spatialys.com<https://www.orange.pl/>

My software is free, but my time generally not.<https://www.orange.pl/>

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/266a913a/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Mon Jan 10 08:01:11 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Mon, 10 Jan 2022 16:01:11 +0000
Subject: [gdal-dev] RPCs in GeoTIFF
In-Reply-To: <DM5PR02MB38622775BD6A87778454CE60F14A9@DM5PR02MB3862.namprd02.prod.outlook.com>
References: <DM5PR02MB38628B17B76BABB6148947F8F1499@DM5PR02MB3862.namprd02.prod.outlook.com>
 <DM5PR02MB38622775BD6A87778454CE60F14A9@DM5PR02MB3862.namprd02.prod.outlook.com>
Message-ID: <e6e1ac365fac4abea61753e54308a5f3@yukon.ca>

Thanks for the nudge. I implemented that code as a simple command line script a couple of months ago but neglected to put it anywhere someone else could use it. Fixed that today ;-)

https://gist.github.com/maphew/29a73ee7a4517663cef5081c15799fc3

```
'''Copy RPC metdata from IN raster to OUT raster

Adapted from @user7821537
https://gis.stackexchange.com/questions/264644/transfer-rpc-metadata-from-one-geotiff-to-another
'''
import os
import sys
from osgeo import gdal

gdal.UseExceptions()

if len(sys.argv) < 3:
    print(f"Usage: {sys.argv[0]} [in_file] [out_file]")
    sys.exit(1)

infile = sys.argv[1]        # source filename and path
output = sys.argv[2]        # destination file

data_in = gdal.Open(infile, gdal.GA_ReadOnly)
data_out = gdal.Open(output, gdal.GA_Update)

# get the RPCs from the first file ...
rpcs = data_in.GetMetadata('RPC')

# ... write them to the second file
data_out.SetMetadata(rpcs ,'RPC')

# de-reference the datasets, which triggers gdal to save
data_in = None
data_out = None

```

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of ni hao
Sent: January 4, 2022 3:00 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] RPCs in GeoTIFF


*** External email: Do not click on links or attachments except from trusted senders. ***

******************************************************************************************



Hi list,

https://gis.stackexchange.com/questions/264644/transfer-rpc-metadata-from-one-geotiff-to-another
The above link showed me how to do it.

thanks.

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of ni hao <ni_hao88 at hotmail.com<mailto:ni_hao88 at hotmail.com>>
Sent: January 3, 2022 2:03 PM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: [gdal-dev] RPCs in GeoTIFF

Hi list,

I use gdal-2.4.4.
I use gdalwarp to orthorectify RADARSAT-2 images with RPCs (in product.xml).
Now I have done some manipulation and save the result in GTiff (e.g., apply Sigma0 LUT).
How can I copy the RPC Metadata from product.xml into GTiff, so I can use gdalwarp RPC orthorectification?
What are the Python commands to call ?
Do I have to use VRT?

Thank you!

ds=gdal.Open(r"C:\RADARSAT-2\2008Feb10\product.xml")
ds.GetMetadata(domain='RPC')
{'HEIGHT_OFF': '1.400000000000000e+02', 'LINE_NUM_COEFF': '1.045003883698053e-03 -3.909147136274753e-05 9.670521993287788e-09 -1.540774061983927e-08 -1.230034082454030e-01 2.994775580755049e-08 3.800851793724760e-08 -7.321141763443381e-04 -3.070513868102579e-08 -3.263789159357597e-08 -1.074590548649705e+00 -1.422870424040082e-07 2.625729922759320e-07 3.515681824455183e-04 1.737795244565543e-08 -1.191967212586014e-06 -6.679635986447045e-04 9.917030647189506e-09 1.183063120029544e-06 9.020179141273994e-07', 'SAMP_SCALE': '1759', 'LONG_OFF': '-5.586200000000000e+00', 'SAMP_DEN_COEFF': '1.000000000000000e+00 -3.873791825160030e-04 -1.654041698986790e-06 1.045768201431545e-08 -7.357169048971613e-04 -5.663646053748347e-06 -2.270764362304154e-08 -7.511863551214131e-07 -3.061984244257416e-07 1.247909289740085e-07 1.555977062556944e-03 2.290649610770613e-06 1.138900631680699e-09 -4.788174308312700e-07 1.913987966778219e-07 -5.724932691905833e-08 5.283021826505342e-06 -2.470297385173699e-08 -5.008669473258436e-08 1.486018900494917e-08', 'ERR_BIAS': '5.000000000000000e-01', 'SAMP_NUM_COEFF': '1.448914459955711e-03 3.107453606755890e-02 -1.362345055216650e-05 -5.545316452513627e-08 1.177884096135199e+00 2.873729811978911e-04 -1.989082475494487e-06 -1.041938833100005e-03 8.430382868139787e-06 -1.570423196668063e-06 -2.556805573684327e-01 -1.724821081109771e-05 4.713416494967566e-07 -9.676787333902578e-04 -2.144746372053350e-06 8.115347578419969e-07 1.767758474109092e-04 2.353735909723349e-07 -6.444353128930045e-06 2.385344654290232e-07', 'LONG_SCALE': '1.859000000000000e-01', 'LINE_DEN_COEFF': '1.000000000000000e+00 -9.804190622020718e-08 -2.386942243966555e-07 1.801605395896790e-08 4.160880031382031e-04 -2.095235371483683e-08 -1.659952797934781e-08 -9.496784414468805e-07 4.758902993568164e-08 5.402628711262573e-08 4.472124981058622e-04 1.370099419045734e-08 -1.785667248922995e-08 7.981478756298640e-07 -7.327071351551446e-09 2.253346171933004e-07 1.637317283006711e-06 -5.178220338393535e-08 1.880261293686099e-06 5.550513900110941e-06', 'SAMP_OFF': '1705', 'LAT_SCALE': '2.073000000000000e-01', 'LAT_OFF': '3.590580000000000e+01', 'LINE_SCALE': '4229', 'LINE_OFF': '4227', 'ERR_RAND': '1.000000000000000e-01', 'HEIGHT_SCALE': '5.010000000000000e+02'}

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/6a7b1391/attachment-0001.html>

From matthias at opengis.ch  Mon Jan 10 10:33:10 2022
From: matthias at opengis.ch (Matthias Kuhn)
Date: Mon, 10 Jan 2022 19:33:10 +0100
Subject: [gdal-dev] Mapsforge binary map format
Message-ID: <CAC7zN94BiW1zcPoNMHQ2dvvLNQUfRyMkOVaSsERnGQsUmyaRhg@mail.gmail.com>

Hi,

I just came across the .map format, a tiled vector format (see
https://www.openandromaps.org/en/)

I tried opening the files and failed, is there support for this in gdal/ogr?

Thanks
Matthias

Previous question on the topic:
https://www.openandromaps.org/en/oam-forums/topic/openandromaps-in-qgis
Specification of the format
https://github.com/mapsforge/mapsforge/blob/master/docs/Specification-Binary-Map-File.md
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/dc5ad45b/attachment.html>

From even.rouault at spatialys.com  Mon Jan 10 09:45:11 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jan 2022 18:45:11 +0100
Subject: [gdal-dev] Mapsforge binary map format
In-Reply-To: <CAC7zN94BiW1zcPoNMHQ2dvvLNQUfRyMkOVaSsERnGQsUmyaRhg@mail.gmail.com>
References: <CAC7zN94BiW1zcPoNMHQ2dvvLNQUfRyMkOVaSsERnGQsUmyaRhg@mail.gmail.com>
Message-ID: <79cd9037-115f-e8ec-6276-4c1ab5ea5ae4@spatialys.com>

Hi Matthias,

Le 10/01/2022 ? 19:33, Matthias Kuhn a ?crit?:
> Hi,
>
> I just came across the .map format, a tiled vector format (see 
> https://www.openandromaps.org/en/ <https://www.openandromaps.org/en/>)
>
> I tried opening the files and failed, is there support for this in 
> gdal/ogr?

I don't think so.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From felipematas at yahoo.com  Mon Jan 10 12:06:37 2022
From: felipematas at yahoo.com (Felipe Matas)
Date: Mon, 10 Jan 2022 20:06:37 +0000 (UTC)
Subject: [gdal-dev] [Question] PROJ4String to WKT2 Transformations
References: <1767405678.2154900.1641845197046.ref@mail.yahoo.com>
Message-ID: <1767405678.2154900.1641845197046@mail.yahoo.com>

Hi hi, I was looking for someplace to ask about this, and I was in doubt is was here or in PROJ, but lets do a try.
Actually, probably I'm not the only one, I have some questions about how WKT2 and PROJ4Strings are transformed.
>From what I read, a PROJ4String don't have enough info to construct a precise WKT2, so, actually how PROJ4String is deprecated my main question is how to construct the right WKT2, there is a lot o data stored in the old format, there is usually no more information, and even the software/hardware that get the data in some way save all of it with all the errors.
Actually, we can transform a old CRS to a WKT2:
> st_crs("+type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
+ )
Coordinate Reference System:
  User input: +type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
  wkt:
BOUNDCRS[
    SOURCECRS[
        PROJCRS["unknown",
            BASEGEOGCRS["unknown",
                DATUM["World Geodetic System 1984",
                    ELLIPSOID["WGS 84",6378137,298.257223563,
                        LENGTHUNIT["metre",1]],
                    ID["EPSG",6326]],
                PRIMEM["Greenwich",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8901]]],
            CONVERSION["UTM zone 19S",
                METHOD["Transverse Mercator",
                    ID["EPSG",9807]],
                PARAMETER["Latitude of natural origin",0,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8801]],
                PARAMETER["Longitude of natural origin",-69,
                    ANGLEUNIT["degree",0.0174532925199433],
                    ID["EPSG",8802]],
                PARAMETER["Scale factor at natural origin",0.9996,
                    SCALEUNIT["unity",1],
                    ID["EPSG",8805]],
                PARAMETER["False easting",500000,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8806]],
                PARAMETER["False northing",10000000,
                    LENGTHUNIT["metre",1],
                    ID["EPSG",8807]],
                ID["EPSG",17019]],
            CS[Cartesian,2],
                AXIS["(E)",east,
                    ORDER[1],
                    LENGTHUNIT["metre",1,
                        ID["EPSG",9001]]],
                AXIS["(N)",north,
                    ORDER[2],
                    LENGTHUNIT["metre",1,
                        ID["EPSG",9001]]]]],
    TARGETCRS[
        GEOGCRS["WGS 84",
            DATUM["World Geodetic System 1984",
                ELLIPSOID["WGS 84",6378137,298.257223563,
                    LENGTHUNIT["metre",1]]],
            PRIMEM["Greenwich",0,
                ANGLEUNIT["degree",0.0174532925199433]],
            CS[ellipsoidal,2],
                AXIS["latitude",north,
                    ORDER[1],
                    ANGLEUNIT["degree",0.0174532925199433]],
                AXIS["longitude",east,
                    ORDER[2],
                    ANGLEUNIT["degree",0.0174532925199433]],
            ID["EPSG",4326]]],
    ABRIDGEDTRANSFORMATION["Transformation from unknown to WGS84",
        METHOD["Geocentric translations (geog2D domain)",
            ID["EPSG",9603]],
        PARAMETER["X-axis translation",0,
            ID["EPSG",8605]],
        PARAMETER["Y-axis translation",0,
            ID["EPSG",8606]],
        PARAMETER["Z-axis translation",0,
            ID["EPSG",8607]]]]
So, in some way, GDAL is able to cover this "breach" of information betwen PROJ4String and WKT2, but is not like the breach does not exist, it was just handled in some way, so, the lack of info, also means, there can be othe aproximations to that CRS.
Maybe I'm just confused, and mixing things the things I read, I'm just trying to figure it out, what and how would be the right transformation from proj4string to wkt2.
Thx.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/dabb7277/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 10 12:12:31 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 10 Jan 2022 20:12:31 +0000
Subject: [gdal-dev] [Question] PROJ4String to WKT2 Transformations
Message-ID: <eb247a9818394a9da7211e844fde1f73@maanmittauslaitos.fi>

Hi,

The more or less same question seems to be asked some time ago in gis.stackexchange https://gis.stackexchange.com/questions/420378/can-we-construct-wkt2-from-proj4string-correctly.

-Jukka Rahkonen-


L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Felipe Matas via gdal-dev
L?hetetty: maanantai 10. tammikuuta 2022 22.07
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] [Question] PROJ4String to WKT2 Transformations

Hi hi, I was looking for someplace to ask about this, and I was in doubt is was here or in PROJ, but lets do a try.

Actually, probably I'm not the only one, I have some questions about how WKT2 and PROJ4Strings are transformed.

From what I read, a PROJ4String don't have enough info to construct a precise WKT2, so, actually how PROJ4String is deprecated my main question is how to construct the right WKT2, there is a lot o data stored in the old format, there is usually no more information, and even the software/hardware that get the data in some way save all of it with all the errors.

Actually, we can transform a old CRS to a WKT2:


> st_crs("+type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"

+ )

Coordinate Reference System:

  User input: +type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0

  wkt:

BOUNDCRS[

    SOURCECRS[

        PROJCRS["unknown",

            BASEGEOGCRS["unknown",

                DATUM["World Geodetic System 1984",

                    ELLIPSOID["WGS 84",6378137,298.257223563,

                        LENGTHUNIT["metre",1]],

                    ID["EPSG",6326]],

                PRIMEM["Greenwich",0,

                    ANGLEUNIT["degree",0.0174532925199433],

                    ID["EPSG",8901]]],

            CONVERSION["UTM zone 19S",

                METHOD["Transverse Mercator",

                    ID["EPSG",9807]],

                PARAMETER["Latitude of natural origin",0,

                    ANGLEUNIT["degree",0.0174532925199433],

                    ID["EPSG",8801]],

                PARAMETER["Longitude of natural origin",-69,

                    ANGLEUNIT["degree",0.0174532925199433],

                    ID["EPSG",8802]],

                PARAMETER["Scale factor at natural origin",0.9996,

                    SCALEUNIT["unity",1],

                    ID["EPSG",8805]],

                PARAMETER["False easting",500000,

                    LENGTHUNIT["metre",1],

                    ID["EPSG",8806]],

                PARAMETER["False northing",10000000,

                    LENGTHUNIT["metre",1],

                    ID["EPSG",8807]],

                ID["EPSG",17019]],

            CS[Cartesian,2],

                AXIS["(E)",east,

                    ORDER[1],

                    LENGTHUNIT["metre",1,

                        ID["EPSG",9001]]],

                AXIS["(N)",north,

                    ORDER[2],

                    LENGTHUNIT["metre",1,

                        ID["EPSG",9001]]]]],

    TARGETCRS[

        GEOGCRS["WGS 84",

            DATUM["World Geodetic System 1984",

                ELLIPSOID["WGS 84",6378137,298.257223563,

                    LENGTHUNIT["metre",1]]],

            PRIMEM["Greenwich",0,

                ANGLEUNIT["degree",0.0174532925199433]],

            CS[ellipsoidal,2],

                AXIS["latitude",north,

                    ORDER[1],

                    ANGLEUNIT["degree",0.0174532925199433]],

                AXIS["longitude",east,

                    ORDER[2],

                    ANGLEUNIT["degree",0.0174532925199433]],

            ID["EPSG",4326]]],

    ABRIDGEDTRANSFORMATION["Transformation from unknown to WGS84",

        METHOD["Geocentric translations (geog2D domain)",

            ID["EPSG",9603]],

        PARAMETER["X-axis translation",0,

            ID["EPSG",8605]],

        PARAMETER["Y-axis translation",0,

            ID["EPSG",8606]],

        PARAMETER["Z-axis translation",0,

            ID["EPSG",8607]]]]

So, in some way, GDAL is able to cover this "breach" of information betwen PROJ4String and WKT2, but is not like the breach does not exist, it was just handled in some way, so, the lack of info, also means, there can be othe aproximations to that CRS.

Maybe I'm just confused, and mixing things the things I read, I'm just trying to figure it out, what and how would be the right transformation from proj4string to wkt2.

Thx.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/4acf3a36/attachment-0001.html>

From even.rouault at spatialys.com  Mon Jan 10 12:15:29 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Jan 2022 21:15:29 +0100
Subject: [gdal-dev] [Question] PROJ4String to WKT2 Transformations
In-Reply-To: <1767405678.2154900.1641845197046@mail.yahoo.com>
References: <1767405678.2154900.1641845197046.ref@mail.yahoo.com>
 <1767405678.2154900.1641845197046@mail.yahoo.com>
Message-ID: <553a7520-306c-fef7-720e-e2094a01aa3b@spatialys.com>

Felipe,

when using PROJ to transform a PROJ.4 string to WKT2, there's (as far as 
I can think of) no loss of information. Loss of information can occur in 
the other way round.

The main source of loss is that proj4 strings have a limited set of 
known datums, so sometimes you'll just have a +ellps without any 
+towgs84 or +nadgrids, which is underspecified.

When you've +ellps with +towgs84, datum transformations will be limited 
to using WGS84 as a pivot, whereas if you had a WKT2 string with the 
original datum name, PROJ could potentially avoid going through WGS84 
when doing datum transformation.

Here's with +datum=WGS84, your PROJ.4 string is fully qualified. You can 
remove the +ellps=WGS84 and +towgs84=0,0,0 which are completely 
redundant here.

Even

Le 10/01/2022 ? 21:06, Felipe Matas via gdal-dev a ?crit?:
> Hi hi, I was looking for someplace to ask about this, and I was in 
> doubt is was here or in PROJ, but lets do a try.
>
> Actually, probably I'm not the only one, I have some questions about 
> how WKT2 and PROJ4Strings are transformed.
>
> From what I read, a PROJ4String don't have enough info to construct a 
> precise WKT2, so, actually how PROJ4String is deprecated my main 
> question is how to construct the right WKT2, there is a lot o data 
> stored in the old format, there is usually no more information, and 
> even the software/hardware that get the data in some way save all of 
> it with all the errors.
>
> Actually, we can transform a old CRS to a WKT2:
>
> |> st_crs("+type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m 
> +no_defs +ellps=WGS84 +towgs84=0,0,0" + ) Coordinate Reference System: 
> User input: +type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m 
> +no_defs +ellps=WGS84 +towgs84=0,0,0 wkt: BOUNDCRS[ SOURCECRS[ 
> PROJCRS["unknown", BASEGEOGCRS["unknown", DATUM["World Geodetic System 
> 1984", ELLIPSOID["WGS 84",6378137,298.257223563, 
> LENGTHUNIT["metre",1]], ID["EPSG",6326]], PRIMEM["Greenwich",0, 
> ANGLEUNIT["degree",0.0174532925199433], ID["EPSG",8901]]], 
> CONVERSION["UTM zone 19S", METHOD["Transverse Mercator", 
> ID["EPSG",9807]], PARAMETER["Latitude of natural origin",0, 
> ANGLEUNIT["degree",0.0174532925199433], ID["EPSG",8801]], 
> PARAMETER["Longitude of natural origin",-69, 
> ANGLEUNIT["degree",0.0174532925199433], ID["EPSG",8802]], 
> PARAMETER["Scale factor at natural origin",0.9996, 
> SCALEUNIT["unity",1], ID["EPSG",8805]], PARAMETER["False 
> easting",500000, LENGTHUNIT["metre",1], ID["EPSG",8806]], 
> PARAMETER["False northing",10000000, LENGTHUNIT["metre",1], 
> ID["EPSG",8807]], ID["EPSG",17019]], CS[Cartesian,2], AXIS["(E)",east, 
> ORDER[1], LENGTHUNIT["metre",1, ID["EPSG",9001]]], AXIS["(N)",north, 
> ORDER[2], LENGTHUNIT["metre",1, ID["EPSG",9001]]]]], TARGETCRS[ 
> GEOGCRS["WGS 84", DATUM["World Geodetic System 1984", ELLIPSOID["WGS 
> 84",6378137,298.257223563, LENGTHUNIT["metre",1]]], 
> PRIMEM["Greenwich",0, ANGLEUNIT["degree",0.0174532925199433]], 
> CS[ellipsoidal,2], AXIS["latitude",north, ORDER[1], 
> ANGLEUNIT["degree",0.0174532925199433]], AXIS["longitude",east, 
> ORDER[2], ANGLEUNIT["degree",0.0174532925199433]], ID["EPSG",4326]]], 
> ABRIDGEDTRANSFORMATION["Transformation from unknown to WGS84", 
> METHOD["Geocentric translations (geog2D domain)", ID["EPSG",9603]], 
> PARAMETER["X-axis translation",0, ID["EPSG",8605]], PARAMETER["Y-axis 
> translation",0, ID["EPSG",8606]], PARAMETER["Z-axis translation",0, 
> ID["EPSG",8607]]]]|
>
> So, in some way, GDAL is able to cover this "breach" of information 
> betwen PROJ4String and WKT2, but is not like the breach does not 
> exist, it was just handled in some way, so, the lack of info, also 
> means, there can be othe aproximations to that CRS.
>
> Maybe I'm just confused, and mixing things the things I read, I'm just 
> trying to figure it out, what and how would be the right 
> transformation from proj4string to wkt2.
>
> Thx.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220110/700965d8/attachment.html>

From roman.schiffer at gmail.com  Tue Jan 11 02:38:55 2022
From: roman.schiffer at gmail.com (Roman Breitfuss-Schiffer)
Date: Tue, 11 Jan 2022 11:38:55 +0100
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and
 non-default drivers
Message-ID: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>

Dear all!

We are currently trying to build a GDAL/OGR installation (version >=3.1) 
for our server which operates on RedHat 7.9 (RHEL).

I have some experience with building GDAL on Ubuntu but have no working 
workflow for RHEL as the required packages and header files (e.g. 
gdal-libs, gdal-libs-devel, python-devel etc.) are not available for 
recent GDAL versions via yum.

*Problem 1: Does anyone have experience with building GDAL **(version 
 >=3.1)**on RHEL?*

We want to build with Python bindings and some non-default drivers (e.g. 
GPKG (raster), JP2OpenJPEG, MBTILES, WMS/WCS). I tried out the build on 
Ubuntu with the following ./configure:

./configure
 ? --prefix=/usr
 ? --libdir=/usr/lib64
 ? --with-armadillo=yes
 ? --with-sqlite3=yes
 ? --with-spatialite=yes
 ? --with-openjpeg
 ? --with-geos=yes
 ? --with-curl=/usr/bin/curl-config
 ? --with-python=yes
 ? --with-png=internal
 ? --with-jpeg=internal

*Problem 2: After running the ./configure command the GPKG (raster) 
driver and the JP2OpenJPEG driver are not listed in misc. gdal formats.
*

./configure output see attachment.

Best regards
Roman

  
_______________________________________________
Dipl.-Ing. Roman Breitfuss-Schiffer, MSc. (GIS)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220111/b6b682f6/attachment.html>
-------------- next part --------------
GDAL is now configured for x86_64-pc-linux-gnu

  Installation directory:    /usr
  C compiler:                gcc -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2
  C++ compiler:              g++ -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2
  C++14 support:             no

  LIBTOOL support:           yes

  Armadillo support:         yes
  Blosc support:             no
  CFITSIO support:           external
  crypto/openssl support:    yes
  cryptopp support:          no
  cURL support (wms/wcs/...):yes
  DDS support:               no
  DODS support:              no
  ECW support:               no
  Expat support:             yes
  EXR support:               no
  FGDB support:              no
  FreeXL support:            yes
  GEORASTER support:         no
  GEOS support:              yes
  Google libkml support:     yes
  GRASS support:             no
  GTA support:               no
  HDF4 support:              yes
  HDF5 support:              yes
  JXL support:               no
  HDFS support:              no
  HEIF support:              no
  INFORMIX DataBlade support:no
  Ingres support:            no
  JP2Lura support:           no
  JPEG 12 bit:               yes
  JPEG-in-TIFF 12 bit:       no
  JPEG JasPer support:       no
  JPEG-Lossless/CharLS:      yes
  Kakadu support:            no
  Kea support:               no
  LERC support:              internal
  libbrunsli support:        no
  libdeflate support:        no
  LIBGEOTIFF support:        external
  LIBGIF support:            external
  LIBJPEG support:           internal
  LIBLZMA support:           no
  LIBPNG support:            internal
  LIBTIFF support:           external (BigTIFF=yes)
  libxml2 support:           yes
  LIBZ support:              external
  LZ4 support:               no
  MDB support:               no
  MongoCXX v3 support:       no
  MongoDB support:           no
  MrSID/MG4 Lidar support:   no
  MrSID support:             no
  MSG support:               no
  MySQL support:             no
  NetCDF has netcdf_mem.h:   yes
  NetCDF support:            yes
  OCI support:               no
  ODBC support:              yes
  OGDI support:              yes
  OpenCL support:            no
  OpenJPEG support:          yes
  PCIDSK support:            internal
  PCRaster support:          internal
  PCRE support:              yes
  PCRE2 support:             no
  PDFium support:            no
  Podofo support:            no
  Poppler support:           no
  PostgreSQL support:        yes
  QHull support:             external
  Rasdaman support:          no
  RasterLite2 support:       no
  RDB support:               no
  SFCGAL support:
  SOSI support:              no
  SpatiaLite support:        yes
  SQLite support:            yes
  Teigha (DWG and DGNv8):    no
  TileDB support:            no
  userfaultfd support:       yes
  WebP support:              yes
  Xerces-C support:          yes
  ZSTD support:              yes


  misc. gdal formats:        aaigrid adrg aigrid airsar arg blx bmp bsb cals ceos ceos2 coasp cosar ctg dimap dted elas envisat ers esric fit gff gsg gxf hf2 idrisi ilwis ingr iris iso8211 jaxapalsar jdem kmlsuperoverlay l1b leveller map mrf msgn ngsgeoid nitf northwood pds prf r raw rmf rs2 safe saga sdts sentinel2 sgi sigdem srtmhgt stacit stacta terragen tga til tsx usgsdem xpm xyz zarr zmap rik ozi eeda plmosaic rda wcs wms wmts daas ogcapi rasterlite mbtiles grib pdf
  misc. ogr formats:         arcgen avc cad csv dgn dxf edigeo flatgeobuf geoconcept georss gml gmt gpsbabel gpx gtm jml mapml mvt ntf openfilegdb pgdump rec s57 selafin shape svg sxf tiger vdv wasp idrisi pds sdts amigocloud carto cloudant couchdb csw elastic ngw plscenes wfs gpkg vfk osm nas ili gmlas ods xlsx lvbag odbc pgeo mssqlspatial geomedia walk

  disabled gdal formats:
  disabled ogr formats:

  SWIG Bindings:             python

  PROJ >= 6:                 yes
  enable GNM building:       yes
  enable pthread support:    yes
  enable POSIX iconv support:yes
  hide internal symbols:     no

From neteler at osgeo.org  Tue Jan 11 03:32:16 2022
From: neteler at osgeo.org (Markus Neteler)
Date: Tue, 11 Jan 2022 12:32:16 +0100
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and
 non-default drivers
In-Reply-To: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
References: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
Message-ID: <CALFmHhu8_9FdbeCwOCpKsAf6P=_vqqBg3u2f0EhqhnSxbhcrDw@mail.gmail.com>

Hi Roman,


On Tue, Jan 11, 2022 at 11:39 AM Roman Breitfuss-Schiffer
<roman.schiffer at gmail.com> wrote:
>
> Dear all!
>
> We are currently trying to build a GDAL/OGR installation (version >=3.1) for our server which operates on RedHat 7.9 (RHEL).
>
> I have some experience with building GDAL on Ubuntu but have no working workflow for RHEL as the required packages and header files (e.g. gdal-libs, gdal-libs-devel, python-devel etc.) are not available for recent GDAL versions via yum.

I created an RPM some time ago:

https://copr.fedorainfracloud.org/coprs/neteler/GDAL/

> Problem 1: Does anyone have experience with building GDAL (version >=3.1) on RHEL?

If I find the time I could try to package something more recent (feel
free to clone my COPR repo and take over).

> We want to build with Python bindings and some non-default drivers (e.g. GPKG (raster), JP2OpenJPEG, MBTILES, WMS/WCS).

This would require more work, i.e. create other COPRs for these dependencies.

As a start, you may pick the respective SPEC files from
- https://src.fedoraproject.org/rpms/gdal/
- https://copr.fedorainfracloud.org/coprs/neteler/openjpeg2/
- https://koji.fedoraproject.org/koji/buildinfo?buildID=563127
- etc.

Best,
Markus

-- 
Markus Neteler, PhD
https://www.mundialis.de - free data with free software
https://grass.osgeo.org
https://courses.neteler.org/blog

From michael.smith.erdc at gmail.com  Tue Jan 11 03:38:34 2022
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Tue, 11 Jan 2022 06:38:34 -0500
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and
 non-default drivers
In-Reply-To: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
References: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
Message-ID: <08C5C7A9-6706-41EC-A3C2-2794BC538C67@gmail.com>

You could just install the linux conda version on Redhat. I do this on Redhat 8.5 without issue. I believe the conda linux version contains all those drivers (and python bindings). 

 

 

-- 

Michael Smith

US Army Corps / Remote Sensing GIS Center

 

 

 

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Roman Breitfuss-Schiffer <roman.schiffer at gmail.com>
Date: Tuesday, January 11, 2022 at 5:39 AM
To: <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and non-default drivers

 

Dear all!

We are currently trying to build a GDAL/OGR installation (version >=3.1) for our server which operates on RedHat 7.9 (RHEL). 

I have some experience with building GDAL on Ubuntu but have no working workflow for RHEL as the required packages and header files (e.g. gdal-libs, gdal-libs-devel, python-devel etc.) are not available for recent GDAL versions via yum. 

Problem 1: Does anyone have experience with building GDAL (version >=3.1) on RHEL?

We want to build with Python bindings and some non-default drivers (e.g. GPKG (raster), JP2OpenJPEG, MBTILES, WMS/WCS). I tried out the build on Ubuntu with the following ./configure:

./configure 
  --prefix=/usr 
  --libdir=/usr/lib64  
  --with-armadillo=yes 
  --with-sqlite3=yes 
  --with-spatialite=yes 
  --with-openjpeg 
  --with-geos=yes 
  --with-curl=/usr/bin/curl-config 
  --with-python=yes 
  --with-png=internal 
  --with-jpeg=internal

Problem 2: After running the ./configure command the GPKG (raster) driver and the JP2OpenJPEG driver are not listed in misc. gdal formats. 

./configure output see attachment. 

Best regards
Roman
 
_______________________________________________
Dipl.-Ing. Roman Breitfuss-Schiffer, MSc. (GIS)
_______________________________________________ gdal-dev mailing list gdal-dev at lists.osgeo.org https://lists.osgeo.org/mailman/listinfo/gdal-dev 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220111/4b6d5dcd/attachment-0001.html>

From cgodkin at gmail.com  Tue Jan 11 15:23:28 2022
From: cgodkin at gmail.com (Carl Godkin)
Date: Tue, 11 Jan 2022 15:23:28 -0800
Subject: [gdal-dev] Setting unit type for a raster band...
Message-ID: <CAE=8km=Jk+fVX=HM4O1UicF2oT6Z91pzF8g_nd506U+WX+W4Tg@mail.gmail.com>

Hi,

I'm trying to figure out if there's a way to set the unit type for a raster
band from any of the application programs.  A few seem to copy it from
input to output bands, but I would like to assign it from the command line
if possible.

I have searched for SetUnitType() and GDALSetRasterUnitType() calls in the
GDAL 3.4.0 source and don't see it anywhere but I thought perhaps I'd
overlooked something.

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220111/93a95705/attachment.html>

From even.rouault at spatialys.com  Tue Jan 11 15:29:25 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jan 2022 00:29:25 +0100
Subject: [gdal-dev] Setting unit type for a raster band...
In-Reply-To: <CAE=8km=Jk+fVX=HM4O1UicF2oT6Z91pzF8g_nd506U+WX+W4Tg@mail.gmail.com>
References: <CAE=8km=Jk+fVX=HM4O1UicF2oT6Z91pzF8g_nd506U+WX+W4Tg@mail.gmail.com>
Message-ID: <6f4d50d4-2b86-1609-bd61-fc63713253e8@spatialys.com>


Le 12/01/2022 ? 00:23, Carl Godkin a ?crit?:
> Hi,
>
> I'm trying to figure?out if there's a way to set the unit type for a 
> raster band from any of the application programs. A few seem to copy 
> it from input to output bands, but I would like to assign it from the 
> command line if possible.
>
> I have searched for SetUnitType() and?GDALSetRasterUnitType() calls in 
> the GDAL 3.4.0 source and don't see it anywhere but I thought perhaps 
> I'd overlooked something.

python -c "from osgeo import gdal; ds = gdal.Open('my.tif', 
gdal.GA_Update); ds.GetRasterBand(1).SetUnitType('my unit')"


>
> Thanks very much,
>
> carl
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/1f172f7a/attachment.html>

From even.rouault at spatialys.com  Tue Jan 11 15:35:45 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jan 2022 00:35:45 +0100
Subject: [gdal-dev] Setting unit type for a raster band...
In-Reply-To: <6f4d50d4-2b86-1609-bd61-fc63713253e8@spatialys.com>
References: <CAE=8km=Jk+fVX=HM4O1UicF2oT6Z91pzF8g_nd506U+WX+W4Tg@mail.gmail.com>
 <6f4d50d4-2b86-1609-bd61-fc63713253e8@spatialys.com>
Message-ID: <42740525-46d7-bda7-9acc-9cb7e97cfab1@spatialys.com>


Le 12/01/2022 ? 00:29, Even Rouault a ?crit?:
>
>
> Le 12/01/2022 ? 00:23, Carl Godkin a ?crit?:
>> Hi,
>>
>> I'm trying to figure?out if there's a way to set the unit type for a 
>> raster band from any of the application programs.? A few seem to copy 
>> it from input to output bands, but I would like to assign it from the 
>> command line if possible.
>>
>> I have searched for SetUnitType() and?GDALSetRasterUnitType() calls 
>> in the GDAL 3.4.0 source and don't see it anywhere but I thought 
>> perhaps I'd overlooked something.
>
> python -c "from osgeo import gdal; ds = gdal.Open('my.tif', 
> gdal.GA_Update); ds.GetRasterBand(1).SetUnitType('my unit')"
>
Actually, more simple with 
https://gdal.org/programs/gdal_edit.html#cmdoption-units:

gdal_edit.py my.tif -units "my unit"

>
>>
>> Thanks very much,
>>
>> carl
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/68c8b5d2/attachment.html>

From cgodkin at gmail.com  Tue Jan 11 15:37:57 2022
From: cgodkin at gmail.com (Carl Godkin)
Date: Tue, 11 Jan 2022 15:37:57 -0800
Subject: [gdal-dev] Setting unit type for a raster band...
In-Reply-To: <42740525-46d7-bda7-9acc-9cb7e97cfab1@spatialys.com>
References: <CAE=8km=Jk+fVX=HM4O1UicF2oT6Z91pzF8g_nd506U+WX+W4Tg@mail.gmail.com>
 <6f4d50d4-2b86-1609-bd61-fc63713253e8@spatialys.com>
 <42740525-46d7-bda7-9acc-9cb7e97cfab1@spatialys.com>
Message-ID: <CAE=8kmmsb7cfGy526nT_HXqytzKiVK29c3h4tfxz0UXmceeapg@mail.gmail.com>

Thanks very much, Even.  Both of those suggestions are very clever.  I
didn't think of that approach.  Now I'm in business.

carl

On Tue, Jan 11, 2022 at 3:35 PM Even Rouault <even.rouault at spatialys.com>
wrote:

>
> Le 12/01/2022 ? 00:29, Even Rouault a ?crit :
>
>
> Le 12/01/2022 ? 00:23, Carl Godkin a ?crit :
>
> Hi,
>
> I'm trying to figure out if there's a way to set the unit type for a
> raster band from any of the application programs.  A few seem to copy it
> from input to output bands, but I would like to assign it from the command
> line if possible.
>
> I have searched for SetUnitType() and GDALSetRasterUnitType() calls in the
> GDAL 3.4.0 source and don't see it anywhere but I thought perhaps I'd
> overlooked something.
>
> python -c "from osgeo import gdal; ds = gdal.Open('my.tif',
> gdal.GA_Update); ds.GetRasterBand(1).SetUnitType('my unit')"
>
> Actually, more simple with
> https://gdal.org/programs/gdal_edit.html#cmdoption-units:
>
> gdal_edit.py my.tif -units "my unit"
>
>
>
> Thanks very much,
>
> carl
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220111/48ac6d8f/attachment.html>

From roman.schiffer at gmail.com  Wed Jan 12 04:42:48 2022
From: roman.schiffer at gmail.com (Roman Breitfuss-Schiffer)
Date: Wed, 12 Jan 2022 13:42:48 +0100
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and
 non-default drivers
In-Reply-To: <CALFmHhu8_9FdbeCwOCpKsAf6P=_vqqBg3u2f0EhqhnSxbhcrDw@mail.gmail.com>
References: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
 <CALFmHhu8_9FdbeCwOCpKsAf6P=_vqqBg3u2f0EhqhnSxbhcrDw@mail.gmail.com>
Message-ID: <6b90d1ac-495c-4d73-d17d-127a6c34f877@gmail.com>

Hi Markus!

Thanks for your detailed information!

I was trying to download the RPMs 
https://copr.fedorainfracloud.org/coprs/neteler/GDAL/ on a CentOS 7 
distribution with the given installation instruction (sudo wget -O 
/etc/yum.repos.d/gdal-copr.repo 
https://copr.fedoraproject.org/coprs/neteler/GDAL/repo/epel-7/neteler-GDAL-epel-7.repo) 
but was getting an 404.

I'm pretty new to the packaging & building RPM topic but will continue 
looking into it. Therefore, I think I won't clone your repo for now but 
maybe in the future :)

Best
Roman


Am 11.01.2022 um 12:32 schrieb Markus Neteler:
> Hi Roman,
>
>
> On Tue, Jan 11, 2022 at 11:39 AM Roman Breitfuss-Schiffer
> <roman.schiffer at gmail.com> wrote:
>> Dear all!
>>
>> We are currently trying to build a GDAL/OGR installation (version >=3.1) for our server which operates on RedHat 7.9 (RHEL).
>>
>> I have some experience with building GDAL on Ubuntu but have no working workflow for RHEL as the required packages and header files (e.g. gdal-libs, gdal-libs-devel, python-devel etc.) are not available for recent GDAL versions via yum.
> I created an RPM some time ago:
>
> https://copr.fedorainfracloud.org/coprs/neteler/GDAL/
>
>> Problem 1: Does anyone have experience with building GDAL (version >=3.1) on RHEL?
> If I find the time I could try to package something more recent (feel
> free to clone my COPR repo and take over).
>
>> We want to build with Python bindings and some non-default drivers (e.g. GPKG (raster), JP2OpenJPEG, MBTILES, WMS/WCS).
> This would require more work, i.e. create other COPRs for these dependencies.
>
> As a start, you may pick the respective SPEC files from
> - https://src.fedoraproject.org/rpms/gdal/
> - https://copr.fedorainfracloud.org/coprs/neteler/openjpeg2/
> - https://koji.fedoraproject.org/koji/buildinfo?buildID=563127
> - etc.
>
> Best,
> Markus
>
-- 
_______________________________________________
Dipl.-Ing. Roman Breitfuss-Schiffer, MSc. (GIS)
Veronikagasse 38/20, 1170 Wien
+43 664 5547678


From neteler at osgeo.org  Wed Jan 12 06:30:53 2022
From: neteler at osgeo.org (Markus Neteler)
Date: Wed, 12 Jan 2022 15:30:53 +0100
Subject: [gdal-dev] Build GDAL for RedHat 7.9 with python bindings and
 non-default drivers
In-Reply-To: <6b90d1ac-495c-4d73-d17d-127a6c34f877@gmail.com>
References: <06a22fa9-0cd8-36af-528b-703037918bc0@gmail.com>
 <CALFmHhu8_9FdbeCwOCpKsAf6P=_vqqBg3u2f0EhqhnSxbhcrDw@mail.gmail.com>
 <6b90d1ac-495c-4d73-d17d-127a6c34f877@gmail.com>
Message-ID: <CALFmHhtVRU7YRikaEnKJsmJpMpzqNtQY1FR=Zg9WaFV_MfO4JQ@mail.gmail.com>

Hi Roman,

On Wed, Jan 12, 2022 at 1:42 PM Roman Breitfuss-Schiffer
<roman.schiffer at gmail.com> wrote:
>
> Hi Markus!
>
> Thanks for your detailed information!
>
> I was trying to download the RPMs
> https://copr.fedorainfracloud.org/coprs/neteler/GDAL/ on a CentOS 7
> distribution with the given installation instruction (sudo wget -O
> /etc/yum.repos.d/gdal-copr.repo
> https://copr.fedoraproject.org/coprs/neteler/GDAL/repo/epel-7/neteler-GDAL-epel-7.repo)
> but was getting an 404.

ahh... ok, after some time (1 year I think) Fedora deletes old file to
recover disk space.

> I'm pretty new to the packaging & building RPM topic but will continue
> looking into it. Therefore, I think I won't clone your repo for now but
> maybe in the future :)

I have made a new attempt (files are back), with the SPEC file here:
https://download.copr.fedorainfracloud.org/results/neteler/GDAL/epel-7-x86_64/03146885-gdal/gdal.spec

It didn't fully run through but maybe a good starting point.

Best,
Markus

-- 
Markus Neteler, PhD
https://www.mundialis.de - free data with free software
https://grass.osgeo.org
https://courses.neteler.org/blog

From even.rouault at spatialys.com  Wed Jan 12 08:56:05 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jan 2022 17:56:05 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
Message-ID: <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>

Hi,

see below. Do we want to do that ? I'm not seeing any obvious 
disadvantage, but I've never worked with DOI before. If so, anyone who 
want to take the lead on that ?

Even

-------- Message transf?r? --------
Sujet?: 	DOI for the GDAL project / Springer Handbook of Geoinformatics
Date?: 	Wed, 12 Jan 2022 17:23:40 +0100
De?: 	Peter L?we <peter.loewe at gmx.de>
Pour?: 	even.rouault at spatialys.com



Hello Even,

I'm writing to you as OSgeo Vice President for GDAL concerning an 
opportunity for the GDAL project. Could you please forward the following 
message to the GDAL PSC - or please tell me about a better way to 
contact the PSC directly ?

Dear GDAL Project Steering Committee,

I'm reaching out to you because of an opportunity for the PROJ 
community, which surfaced recently:
The upcoming second edition of the Springer Handbook of Geoinformatics 
will cover the GDAL project. The Handbook project has been delayed due 
to the Pandemic, but will be completed in a few weeks. I am serving as 
the editor of the Handbook chapter about Open Source Geoinformatics.

Recently, new workflows for scientific citation of software projects 
have emerged and are becoming state of the art. This includes references 
by persistent digital object identifiers (DOI) to software projects 
instead of URLs. DOI-based references allow to give due credit to the 
whole project team, including first authors, developers, but also 
maintainers and people in other roles.

The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have 
already registered their own DOI, OSGeoLive, pygeoapi and pycsw will 
follow soon.
As an example, this is the DOI for GRASS GIS: 
https://doi.org/10.5281/zenodo.5810537
Hands on information how to register a DOI for a OSGeo project are 
available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid).

The Editors of the Springer Handbook agree that including DOI references 
for Open Source projects is a win-win-scenario for the upcoming book and 
also the OSGeo project communities. They have extended the production 
deadline until January 20 to give additional software projects the 
opportunity to register a DOI to be included in the book chapter.

If the GDAL project reserves or registers a DOI (takes only a few 
minutes) before the deadline of January 20, I would gladly include it in 
the Open Source Geoinformatics chapter reference section.


Please let me know if you have any questions.

Best,
Peter

https://wiki.osgeo.org/wiki/User:Peter_Loewe

<peter.loewe at gmx.de>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/42dd6f06/attachment.html>

From schwehr at gmail.com  Wed Jan 12 09:18:37 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 12 Jan 2022 09:18:37 -0800
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
Message-ID: <CACmBxyuhBELddkt+HtgZkLx62JtZ_TTjZg9Gf4Ht8PG=FmYJAA@mail.gmail.com>

I don't see a reason not to, but the question is what to point to.

The GRASS link points to an RC, which doesn't feel right.  It appears that
we'd be wanting to do a new doi for each release. Is that really what the
community wants?  Does Zenodo want to be storing a tar for each release for
all time?  This would make Zenodo yet another package distribution system,
which seems cra

I would think it would be better to have simple doi entry with no attached
files that is updated with each release to mention the release with links
and hashes of the tar?

I'm overloaded, so I can't take the lead on this.  I do have this gist of
me playing with the doi system just over a year ago, if anyone is
interested in seeing how the API side of DOIs work.  It uses absl.app, but
that is easy to replace.

https://gist.github.com/schwehr/22ce6080eb9e730ef04fccfa25072e3a

On Wed, Jan 12, 2022 at 8:56 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
> see below. Do we want to do that ? I'm not seeing any obvious
> disadvantage, but I've never worked with DOI before. If so, anyone who want
> to take the lead on that ?
>
> Even
>
> -------- Message transf?r? --------
> Sujet : DOI for the GDAL project / Springer Handbook of Geoinformatics
> Date : Wed, 12 Jan 2022 17:23:40 +0100
> De : Peter L?we <peter.loewe at gmx.de> <peter.loewe at gmx.de>
> Pour : even.rouault at spatialys.com
>
> Hello Even,
>
> I'm writing to you as OSgeo Vice President for GDAL concerning an
> opportunity for the GDAL project. Could you please forward the following
> message to the GDAL PSC - or please tell me about a better way to contact
> the PSC directly ?
>
> Dear GDAL Project Steering Committee,
>
> I'm reaching out to you because of an opportunity for the PROJ community,
> which surfaced recently:
> The upcoming second edition of the Springer Handbook of Geoinformatics
> will cover the GDAL project. The Handbook project has been delayed due to
> the Pandemic, but will be completed in a few weeks. I am serving as the
> editor of the Handbook chapter about Open Source Geoinformatics.
>
> Recently, new workflows for scientific citation of software projects have
> emerged and are becoming state of the art. This includes references by
> persistent digital object identifiers (DOI) to software projects instead of
> URLs. DOI-based references allow to give due credit to the whole project
> team, including first authors, developers, but also maintainers and people
> in other roles.
>
> The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have
> already registered their own DOI, OSGeoLive, pygeoapi and pycsw will follow
> soon.
> As an example, this is the DOI for GRASS GIS:
> https://doi.org/10.5281/zenodo.5810537
> Hands on information how to register a DOI for a OSGeo project are
> available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid).
>
> The Editors of the Springer Handbook agree that including DOI references
> for Open Source projects is a win-win-scenario for the upcoming book and
> also the OSGeo project communities. They have extended the production
> deadline until January 20 to give additional software projects the
> opportunity to register a DOI to be included in the book chapter.
>
> If the GDAL project reserves or registers a DOI (takes only a few minutes)
> before the deadline of January 20, I would gladly include it in the Open
> Source Geoinformatics chapter reference section.
>
>
> Please let me know if you have any questions.
>
> Best,
> Peter
>
> https://wiki.osgeo.org/wiki/User:Peter_Loewe
>
> <peter.loewe at gmx.de> <peter.loewe at gmx.de>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/9408687b/attachment.html>

From alansnow21 at gmail.com  Wed Jan 12 09:32:38 2022
From: alansnow21 at gmail.com (Alan Snow)
Date: Wed, 12 Jan 2022 11:32:38 -0600
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
Message-ID: <CAGybdFRQoM+QvYnvZRGP2LFtcYUkWN4AX-gnLd3F4L=z58fK9A@mail.gmail.com>

Helpful reference:
https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content

On Wed, Jan 12, 2022, 10:56 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
> see below. Do we want to do that ? I'm not seeing any obvious
> disadvantage, but I've never worked with DOI before. If so, anyone who want
> to take the lead on that ?
>
> Even
>
> -------- Message transf?r? --------
> Sujet : DOI for the GDAL project / Springer Handbook of Geoinformatics
> Date : Wed, 12 Jan 2022 17:23:40 +0100
> De : Peter L?we <peter.loewe at gmx.de> <peter.loewe at gmx.de>
> Pour : even.rouault at spatialys.com
>
> Hello Even,
>
> I'm writing to you as OSgeo Vice President for GDAL concerning an
> opportunity for the GDAL project. Could you please forward the following
> message to the GDAL PSC - or please tell me about a better way to contact
> the PSC directly ?
>
> Dear GDAL Project Steering Committee,
>
> I'm reaching out to you because of an opportunity for the PROJ community,
> which surfaced recently:
> The upcoming second edition of the Springer Handbook of Geoinformatics
> will cover the GDAL project. The Handbook project has been delayed due to
> the Pandemic, but will be completed in a few weeks. I am serving as the
> editor of the Handbook chapter about Open Source Geoinformatics.
>
> Recently, new workflows for scientific citation of software projects have
> emerged and are becoming state of the art. This includes references by
> persistent digital object identifiers (DOI) to software projects instead of
> URLs. DOI-based references allow to give due credit to the whole project
> team, including first authors, developers, but also maintainers and people
> in other roles.
>
> The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have
> already registered their own DOI, OSGeoLive, pygeoapi and pycsw will follow
> soon.
> As an example, this is the DOI for GRASS GIS:
> https://doi.org/10.5281/zenodo.5810537
> Hands on information how to register a DOI for a OSGeo project are
> available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid).
>
> The Editors of the Springer Handbook agree that including DOI references
> for Open Source projects is a win-win-scenario for the upcoming book and
> also the OSGeo project communities. They have extended the production
> deadline until January 20 to give additional software projects the
> opportunity to register a DOI to be included in the book chapter.
>
> If the GDAL project reserves or registers a DOI (takes only a few minutes)
> before the deadline of January 20, I would gladly include it in the Open
> Source Geoinformatics chapter reference section.
>
>
> Please let me know if you have any questions.
>
> Best,
> Peter
>
> https://wiki.osgeo.org/wiki/User:Peter_Loewe
>
> <peter.loewe at gmx.de> <peter.loewe at gmx.de>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/1ce50b84/attachment-0001.html>

From dshean at gmail.com  Wed Jan 12 09:33:59 2022
From: dshean at gmail.com (David Shean)
Date: Wed, 12 Jan 2022 09:33:59 -0800
Subject: [gdal-dev] DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CACmBxyuhBELddkt+HtgZkLx62JtZ_TTjZg9Gf4Ht8PG=FmYJAA@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <CACmBxyuhBELddkt+HtgZkLx62JtZ_TTjZg9Gf4Ht8PG=FmYJAA@mail.gmail.com>
Message-ID: <09E5DBC8-41E5-4507-BC37-E49B99FD510A@gmail.com>

Hi Even,
This seems like a good idea, as there are many academic users who will cite.

Not volunteering to take this on, but setting up a DOI is relatively easy with Zenodo and Github integration: https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content <https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content>.  You?ll have a persistent DOI (points to latest), and then automatically generated DOIs for each release.

I agree with Kurt about archiving files, but since these are a direct mirror of the files from the Github release, I don?t see the harm (storage on Zenodo is free).  There may also be a way to configure Zenodo-Github integration to avoid storing a copy.

Hopefully someone with admin on the GDAL Github repo can set this up pretty quickly.
-David

> On Jan 12, 2022, at 9:18 AM, Kurt Schwehr <schwehr at gmail.com> wrote:
> 
> I don't see a reason not to, but the question is what to point to.  
> 
> The GRASS link points to an RC, which doesn't feel right.  It appears that we'd be wanting to do a new doi for each release. Is that really what the community wants?  Does Zenodo want to be storing a tar for each release for all time?  This would make Zenodo yet another package distribution system, which seems cra
> 
> I would think it would be better to have simple doi entry with no attached files that is updated with each release to mention the release with links and hashes of the tar?
> 
> I'm overloaded, so I can't take the lead on this.  I do have this gist of me playing with the doi system just over a year ago, if anyone is interested in seeing how the API side of DOIs work.  It uses absl.app, but that is easy to replace.
> 
> https://gist.github.com/schwehr/22ce6080eb9e730ef04fccfa25072e3a <https://gist.github.com/schwehr/22ce6080eb9e730ef04fccfa25072e3a>
> 
> On Wed, Jan 12, 2022 at 8:56 AM Even Rouault <even.rouault at spatialys.com <mailto:even.rouault at spatialys.com>> wrote:
> Hi,
> 
> see below. Do we want to do that ? I'm not seeing any obvious disadvantage, but I've never worked with DOI before. If so, anyone who want to take the lead on that ?
> 
> Even
> 
> -------- Message transf?r? --------
> Sujet :	DOI for the GDAL project / Springer Handbook of Geoinformatics
> Date :	Wed, 12 Jan 2022 17:23:40 +0100
> De :	Peter L?we <peter.loewe at gmx.de> <mailto:peter.loewe at gmx.de>
> Pour :	even.rouault at spatialys.com <mailto:even.rouault at spatialys.com>
> 
> Hello Even,
> 
> I'm writing to you as OSgeo Vice President for GDAL concerning an opportunity for the GDAL project. Could you please forward the following message to the GDAL PSC - or please tell me about a better way to contact the PSC directly ?
> 
> Dear GDAL Project Steering Committee,
> 
> I'm reaching out to you because of an opportunity for the PROJ community, which surfaced recently:
> The upcoming second edition of the Springer Handbook of Geoinformatics will cover the GDAL project. The Handbook project has been delayed due to the Pandemic, but will be completed in a few weeks. I am serving as the editor of the Handbook chapter about Open Source Geoinformatics.
> 
> Recently, new workflows for scientific citation of software projects have emerged and are becoming state of the art. This includes references by persistent digital object identifiers (DOI) to software projects instead of URLs. DOI-based references allow to give due credit to the whole project team, including first authors, developers, but also maintainers and people in other roles.
> 
> The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have already registered their own DOI, OSGeoLive, pygeoapi and pycsw will follow soon.
> As an example, this is the DOI for GRASS GIS: https://doi.org/10.5281/zenodo.5810537 <https://doi.org/10.5281/zenodo.5810537>
> Hands on information how to register a DOI for a OSGeo project are available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid) <https://wiki.osgeo.org/wiki/Persistent_identifiers(pid)>.
> 
> The Editors of the Springer Handbook agree that including DOI references for Open Source projects is a win-win-scenario for the upcoming book and also the OSGeo project communities. They have extended the production deadline until January 20 to give additional software projects the opportunity to register a DOI to be included in the book chapter.
> 
> If the GDAL project reserves or registers a DOI (takes only a few minutes) before the deadline of January 20, I would gladly include it in the Open Source Geoinformatics chapter reference section.
> 
> 
> Please let me know if you have any questions.
> 
> Best,
> Peter
> 
> https://wiki.osgeo.org/wiki/User:Peter_Loewe <https://wiki.osgeo.org/wiki/User:Peter_Loewe>
> 
> <peter.loewe at gmx.de> <mailto:peter.loewe at gmx.de>
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://lists.osgeo.org/mailman/listinfo/gdal-dev>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/e1ac2a7f/attachment.html>

From neteler at osgeo.org  Wed Jan 12 10:10:13 2022
From: neteler at osgeo.org (Markus Neteler)
Date: Wed, 12 Jan 2022 19:10:13 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CACmBxyuhBELddkt+HtgZkLx62JtZ_TTjZg9Gf4Ht8PG=FmYJAA@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <CACmBxyuhBELddkt+HtgZkLx62JtZ_TTjZg9Gf4Ht8PG=FmYJAA@mail.gmail.com>
Message-ID: <CALFmHhuJFREUFt1vLZuaPCskxH2jFRjBYAofG8bLmFmsWzRJGQ@mail.gmail.com>

Hi,

Kurt Schwehr <schwehr at gmail.com> schrieb am Mi., 12. Jan. 2022, 18:18:

> I don't see a reason not to, but the question is what to point to.
>
> The GRASS link points to an RC, which doesn't feel right.
>


It is autogenerated from the GitHub tag. In the next days there will be the
final one (yes, we should filter out RCs).

Markus


>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/9f42a389/attachment.html>

From raplima at hotmail.com  Wed Jan 12 10:24:43 2022
From: raplima at hotmail.com (Rafael Lima)
Date: Wed, 12 Jan 2022 18:24:43 +0000
Subject: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?
Message-ID: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>

## Expected behavior and actual behavior.

I installed gdal on a Windows environment using anaconda and tried using one of the .py scripts (e.g., ogrmerge.py). I expected the script to make use of the gdal installed in such an environment, but it seems that the script finds another gdal installation (screenshot below), thus throwing an error. My question seems to be related to the one in https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command, apparently unsolved. I was wondering what is the correct approach to make sure gdal scripts find the correct gdal?

## Steps to reproduce the problem.
create a conda environment:
conda create -n test1 gdal
activate the environment
conda activate test1
call a gdal .py script
ogrmerge.py

In my case, that throws an error apparently because the script uses another gdal installation:
[cid:a82a3c37-9996-48fb-b90e-9267e1e33f1d]

## Operating system

Windows 10 Pro - 20H2 version

## GDAL version and provenance

GDAL==3.0.2
GDAL==3.4.0

Thank you!
Rafael
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/59062bd9/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 54185 bytes
Desc: image.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/59062bd9/attachment-0001.png>

From daniel.scheffler at gfz-potsdam.de  Wed Jan 12 09:31:59 2022
From: daniel.scheffler at gfz-potsdam.de (Daniel Scheffler)
Date: Wed, 12 Jan 2022 18:31:59 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
Message-ID: <25fd6d4b-3195-597e-fe5f-3be0656f1cdd@gfz-potsdam.de>

Hi!

Using Zenodo, registering a DOI is quite simple. Just create a Zenodo 
account and link the GDAL GitHub repository to it. Zenodo provides you a 
static DOI to reference the whole project and dynamic DOIs everytime a 
new version of GDAL is released on GitHub (to reference specific 
versions which might be important when referencing software). New DOIs 
are created automatically via a webhook. Custom metadata on Zenodo can 
be defined by adding a .zenodo.json file (like this 
<https://git.gfz-potsdam.de/danschef/arosics/-/blob/master/.zenodo.json>) 
to the repository root. Documentation on that is available here 
<https://help.zenodo.org/guides/search/>.

Daniel


Am 12.01.2022 um 17:56 schrieb Even Rouault:
>
> Hi,
>
> see below. Do we want to do that ? I'm not seeing any obvious 
> disadvantage, but I've never worked with DOI before. If so, anyone who 
> want to take the lead on that ?
>
> Even
>
> -------- Message transf?r? --------
> Sujet?: 	DOI for the GDAL project / Springer Handbook of Geoinformatics
> Date?: 	Wed, 12 Jan 2022 17:23:40 +0100
> De?: 	Peter L?we <peter.loewe at gmx.de>
> Pour?: 	even.rouault at spatialys.com
>
>
>
> Hello Even,
>
> I'm writing to you as OSgeo Vice President for GDAL concerning an 
> opportunity for the GDAL project. Could you please forward the 
> following message to the GDAL PSC - or please tell me about a better 
> way to contact the PSC directly ?
>
> Dear GDAL Project Steering Committee,
>
> I'm reaching out to you because of an opportunity for the PROJ 
> community, which surfaced recently:
> The upcoming second edition of the Springer Handbook of Geoinformatics 
> will cover the GDAL project. The Handbook project has been delayed due 
> to the Pandemic, but will be completed in a few weeks. I am serving as 
> the editor of the Handbook chapter about Open Source Geoinformatics.
>
> Recently, new workflows for scientific citation of software projects 
> have emerged and are becoming state of the art. This includes 
> references by persistent digital object identifiers (DOI) to software 
> projects instead of URLs. DOI-based references allow to give due 
> credit to the whole project team, including first authors, developers, 
> but also maintainers and people in other roles.
>
> The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have 
> already registered their own DOI, OSGeoLive, pygeoapi and pycsw will 
> follow soon.
> As an example, this is the DOI for GRASS GIS: 
> https://doi.org/10.5281/zenodo.5810537
> Hands on information how to register a DOI for a OSGeo project are 
> available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid).
>
> The Editors of the Springer Handbook agree that including DOI 
> references for Open Source projects is a win-win-scenario for the 
> upcoming book and also the OSGeo project communities. They have 
> extended the production deadline until January 20 to give additional 
> software projects the opportunity to register a DOI to be included in 
> the book chapter.
>
> If the GDAL project reserves or registers a DOI (takes only a few 
> minutes) before the deadline of January 20, I would gladly include it 
> in the Open Source Geoinformatics chapter reference section.
>
>
> Please let me know if you have any questions.
>
> Best,
> Peter
>
> https://wiki.osgeo.org/wiki/User:Peter_Loewe
>
> <peter.loewe at gmx.de>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 

M.Sc. Geogr. Daniel Scheffler

Helmholtz Centre Potsdam
GFZ German Research Centre For Geosciences
Department 1 - Geodesy and Remote Sensing
Section 1.4  - Remote Sensing
Telegrafenberg, 14473 Potsdam, Germany

Phone:  +49 (0)331/288-1198
e-mail:daniel.scheffler at gfz-potsdam.de
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/05e6c14b/attachment.html>

From even.rouault at spatialys.com  Wed Jan 12 11:09:06 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jan 2022 20:09:06 +0100
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
Message-ID: <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>

I would have suggested to uninstall the offending proprietary software 
:-), but perhaps checking that PYTHONPATH or PYTHONHOME are not defined 
to an unexpected value will be sufficient

Le 12/01/2022 ? 19:24, Rafael Lima a ?crit?:
> ## Expected behavior and actual behavior.
>
> I installed gdal on a Windows environment using anaconda and tried 
> using one of the .py scripts (e.g., ogrmerge.py). I expected the 
> script to make use of the gdal installed in such an environment, but 
> it seems that the script finds another gdal installation (screenshot 
> below), thus throwing an error. My question seems to be related to the 
> one in 
> https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command, 
> apparently unsolved. I was wondering what is the correct approach to 
> make sure gdal scripts find the correct gdal?
>
> ## Steps to reproduce the problem.
> create a conda environment:
> conda create -n test1 gdal
> activate the environment
> conda activate test1
> call a gdal .py script
> ogrmerge.py
>
> In my case, that throws an error apparently because the script uses 
> another gdal installation:
>
>
> ## Operating system
>
> Windows 10 Pro - 20H2 version
>
> ## GDAL version and provenance
>
> GDAL==3.0.2
> GDAL==3.4.0
>
> Thank you!
> Rafael
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/849e8c4f/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 54185 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/849e8c4f/attachment-0001.png>

From even.rouault at spatialys.com  Wed Jan 12 13:06:35 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Jan 2022 22:06:35 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
Message-ID: <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>

ok, based on the various input, I gave a try at the system.

- https://github.com/OSGeo/gdal/pull/5101 adds a .zenodo.json file. I've 
taken the 16th top committers according to github. If folks want to be 
removed or added or have their information modified (I've looked orcid 
identifiers quickly so I may have missed folks), please add comments in 
the ticket, or better create a pull request? to amend it

- I've used the sandbox.zenodo.org system and create a dummy release in 
my fork to check that it works properly: 
https://sandbox.zenodo.org/account/settings/github/repository/rouault/gdal 
(do not use the DOI from there. it is just dummy)

Even

Le 12/01/2022 ? 17:56, Even Rouault a ?crit?:
>
> Hi,
>
> see below. Do we want to do that ? I'm not seeing any obvious 
> disadvantage, but I've never worked with DOI before. If so, anyone who 
> want to take the lead on that ?
>
> Even
>
> -------- Message transf?r? --------
> Sujet?: 	DOI for the GDAL project / Springer Handbook of Geoinformatics
> Date?: 	Wed, 12 Jan 2022 17:23:40 +0100
> De?: 	Peter L?we <peter.loewe at gmx.de>
> Pour?: 	even.rouault at spatialys.com
>
>
>
> Hello Even,
>
> I'm writing to you as OSgeo Vice President for GDAL concerning an 
> opportunity for the GDAL project. Could you please forward the 
> following message to the GDAL PSC - or please tell me about a better 
> way to contact the PSC directly ?
>
> Dear GDAL Project Steering Committee,
>
> I'm reaching out to you because of an opportunity for the PROJ 
> community, which surfaced recently:
> The upcoming second edition of the Springer Handbook of Geoinformatics 
> will cover the GDAL project. The Handbook project has been delayed due 
> to the Pandemic, but will be completed in a few weeks. I am serving as 
> the editor of the Handbook chapter about Open Source Geoinformatics.
>
> Recently, new workflows for scientific citation of software projects 
> have emerged and are becoming state of the art. This includes 
> references by persistent digital object identifiers (DOI) to software 
> projects instead of URLs. DOI-based references allow to give due 
> credit to the whole project team, including first authors, developers, 
> but also maintainers and people in other roles.
>
> The OSGeo projects GRASS GIS, GMT, MapServer, MOSS and rasdaman have 
> already registered their own DOI, OSGeoLive, pygeoapi and pycsw will 
> follow soon.
> As an example, this is the DOI for GRASS GIS: 
> https://doi.org/10.5281/zenodo.5810537
> Hands on information how to register a DOI for a OSGeo project are 
> available here: https://wiki.osgeo.org/wiki/Persistent_identifiers(pid).
>
> The Editors of the Springer Handbook agree that including DOI 
> references for Open Source projects is a win-win-scenario for the 
> upcoming book and also the OSGeo project communities. They have 
> extended the production deadline until January 20 to give additional 
> software projects the opportunity to register a DOI to be included in 
> the book chapter.
>
> If the GDAL project reserves or registers a DOI (takes only a few 
> minutes) before the deadline of January 20, I would gladly include it 
> in the Open Source Geoinformatics chapter reference section.
>
>
> Please let me know if you have any questions.
>
> Best,
> Peter
>
> https://wiki.osgeo.org/wiki/User:Peter_Loewe
>
> <peter.loewe at gmx.de>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/cc2531f5/attachment.html>

From raplima at hotmail.com  Wed Jan 12 13:21:43 2022
From: raplima at hotmail.com (Rafael Lima)
Date: Wed, 12 Jan 2022 21:21:43 +0000
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
Message-ID: <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>

I thought about uninstalling it to lol
checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient
It was something of the sorts. The paths were actually fine, but the "default windows app" is activated when calling a file with a .py extension. So calling ogrmerge.py on the terminal would activate the default app instead of the activated python =/
Thanks!

________________________________
De: gdal-dev <gdal-dev-bounces at lists.osgeo.org> em nome de Even Rouault <even.rouault at spatialys.com>
Enviado: quarta-feira, 12 de janeiro de 2022 16:09
Para: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Assunto: Re: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?


I would have suggested to uninstall the offending proprietary software :-), but perhaps checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient

Le 12/01/2022 ? 19:24, Rafael Lima a ?crit :
## Expected behavior and actual behavior.

I installed gdal on a Windows environment using anaconda and tried using one of the .py scripts (e.g., ogrmerge.py). I expected the script to make use of the gdal installed in such an environment, but it seems that the script finds another gdal installation (screenshot below), thus throwing an error. My question seems to be related to the one in https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command, apparently unsolved. I was wondering what is the correct approach to make sure gdal scripts find the correct gdal?

## Steps to reproduce the problem.
create a conda environment:
conda create -n test1 gdal
activate the environment
conda activate test1
call a gdal .py script
ogrmerge.py

In my case, that throws an error apparently because the script uses another gdal installation:
[cid:part1.66CDEAD4.863B431E at spatialys.com]

## Operating system

Windows 10 Pro - 20H2 version

## GDAL version and provenance

GDAL==3.0.2
GDAL==3.4.0

Thank you!
Rafael



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/d82088f3/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 54185 bytes
Desc: image.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/d82088f3/attachment-0001.png>

From idan at miara.com  Wed Jan 12 13:26:54 2022
From: idan at miara.com (Idan Miara)
Date: Wed, 12 Jan 2022 23:26:54 +0200
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
 <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
Message-ID: <CAEDrt38OTJzptUczuWLoEeZPgSZrdhfmYqp64rPbATvUBrdctA@mail.gmail.com>

Hi,

I had the same problem, here's my solution :
https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/auxiliary/batch_creator.py

Idan


On Wed, 12 Jan 2022, 23:22 Rafael Lima, <raplima at hotmail.com> wrote:

> I thought about uninstalling it to lol
>
> checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected
> value will be sufficient
>
> It was something of the sorts. The paths were actually fine, but the
> "default windows app" is activated when calling a file with a .py
> extension. So calling ogrmerge.py on the terminal would activate the
> default app instead of the activated python =/
> Thanks!
>
> ------------------------------
> *De:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> em nome de Even Rouault
> <even.rouault at spatialys.com>
> *Enviado:* quarta-feira, 12 de janeiro de 2022 16:09
> *Para:* gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
> *Assunto:* Re: [gdal-dev] How to fix path for gdal .py scripts in
> Anaconda-Windows?
>
>
> I would have suggested to uninstall the offending proprietary software
> :-), but perhaps checking that PYTHONPATH or PYTHONHOME are not defined to
> an unexpected value will be sufficient
> Le 12/01/2022 ? 19:24, Rafael Lima a ?crit :
>
> ## Expected behavior and actual behavior.
>
> I installed gdal on a Windows environment using anaconda and tried using
> one of the .py scripts (e.g., ogrmerge.py). I expected the script to make
> use of the gdal installed in such an environment, but it seems that the
> script finds another gdal installation (screenshot below), thus throwing an
> error. My question seems to be related to the one in
> https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command,
> apparently unsolved. I was wondering what is the correct approach to make
> sure gdal scripts find the correct gdal?
>
> ## Steps to reproduce the problem.
> create a conda environment:
> conda create -n test1 gdal
> activate the environment
> conda activate test1
> call a gdal .py script
> ogrmerge.py
>
> In my case, that throws an error apparently because the script uses
> another gdal installation:
>
>
> ## Operating system
>
> Windows 10 Pro - 20H2 version
>
> ## GDAL version and provenance
>
> GDAL==3.0.2
> GDAL==3.4.0
>
> Thank you!
> Rafael
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/497083f0/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 54185 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/497083f0/attachment-0001.png>

From neteler at osgeo.org  Wed Jan 12 13:36:27 2022
From: neteler at osgeo.org (Markus Neteler)
Date: Wed, 12 Jan 2022 22:36:27 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
Message-ID: <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>

On Wed, Jan 12, 2022 at 10:06 PM Even Rouault
<even.rouault at spatialys.com> wrote:
>
> ok, based on the various input, I gave a try at the system.
>
> - https://github.com/OSGeo/gdal/pull/5101 adds a .zenodo.json file. I've taken the 16th top committers according to github. If folks want to be removed or added or have their information modified (I've looked orcid identifiers quickly so I may have missed folks), please add comments in the ticket, or better create a pull request  to amend it
>
> - I've used the sandbox.zenodo.org system and create a dummy release in my fork to check that it works properly: https://sandbox.zenodo.org/account/settings/github/repository/rouault/gdal (do not use the DOI from there. it is just dummy)

I guess the sandbox link is this: https://sandbox.zenodo.org/record/994062

Markus

From raplima at hotmail.com  Wed Jan 12 13:38:32 2022
From: raplima at hotmail.com (Rafael Lima)
Date: Wed, 12 Jan 2022 21:38:32 +0000
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CAEDrt38OTJzptUczuWLoEeZPgSZrdhfmYqp64rPbATvUBrdctA@mail.gmail.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
 <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <CAEDrt38OTJzptUczuWLoEeZPgSZrdhfmYqp64rPbATvUBrdctA@mail.gmail.com>
Message-ID: <CY4PR16MB16535694584A2E65A80FE025A5529@CY4PR16MB1653.namprd16.prod.outlook.com>

That't great, Idan! Thank you, I will look into it to add it to my code.
Thanks,
Rafael
________________________________
De: Idan Miara <idan at miara.com>
Enviado: quarta-feira, 12 de janeiro de 2022 18:26
Para: Rafael Lima <raplima at hotmail.com>
Cc: Even Rouault <even.rouault at spatialys.com>; gdal dev <gdal-dev at lists.osgeo.org>
Assunto: Re: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?

Hi,

I had the same problem, here's my solution :
https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/auxiliary/batch_creator.py

Idan


On Wed, 12 Jan 2022, 23:22 Rafael Lima, <raplima at hotmail.com<mailto:raplima at hotmail.com>> wrote:
I thought about uninstalling it to lol
checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient
It was something of the sorts. The paths were actually fine, but the "default windows app" is activated when calling a file with a .py extension. So calling ogrmerge.py on the terminal would activate the default app instead of the activated python =/
Thanks!

________________________________
De: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> em nome de Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Enviado: quarta-feira, 12 de janeiro de 2022 16:09
Para: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Assunto: Re: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?


I would have suggested to uninstall the offending proprietary software :-), but perhaps checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient

Le 12/01/2022 ? 19:24, Rafael Lima a ?crit :
## Expected behavior and actual behavior.

I installed gdal on a Windows environment using anaconda and tried using one of the .py scripts (e.g., ogrmerge.py). I expected the script to make use of the gdal installed in such an environment, but it seems that the script finds another gdal installation (screenshot below), thus throwing an error. My question seems to be related to the one in https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command, apparently unsolved. I was wondering what is the correct approach to make sure gdal scripts find the correct gdal?

## Steps to reproduce the problem.
create a conda environment:
conda create -n test1 gdal
activate the environment
conda activate test1
call a gdal .py script
ogrmerge.py

In my case, that throws an error apparently because the script uses another gdal installation:
[cid:part1.66CDEAD4.863B431E at spatialys.com]

## Operating system

Windows 10 Pro - 20H2 version

## GDAL version and provenance

GDAL==3.0.2
GDAL==3.4.0

Thank you!
Rafael



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
http://www.spatialys.com
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/4e9e7899/attachment.html>

From Matt.Wilkie at yukon.ca  Wed Jan 12 15:40:50 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 12 Jan 2022 23:40:50 +0000
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CAEDrt38OTJzptUczuWLoEeZPgSZrdhfmYqp64rPbATvUBrdctA@mail.gmail.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
 <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <CAEDrt38OTJzptUczuWLoEeZPgSZrdhfmYqp64rPbATvUBrdctA@mail.gmail.com>
Message-ID: <4e0da010b1a3437a95ee4c839b5b0213@yukon.ca>

Also see OSGEO4W make-bat-for-py.bat<https://trac.osgeo.org/osgeo4w/ticket/17>. Old but still works. ;-)

```
for %%g in (*.py) do (
  echo @python "%%~dpnxg" %%* > %%~ng.bat
  )
```

You should be able to  insert  settings if needed for environment variables (I didn?t test this particular formulation):

```
@echo off
for %%g in (*.py) do (
   @echo @python "%%~dpnxg" %%*
   if not exist %%~ng.bat (
      echo ?set PYTHONHOME=C:\PROGRA~1\QGIS32~1.2\apps\Python39? > %%~ng.bat
      echo ?set PYTHONUTF8=1? >> %%~ng.bat
      echo @python "%%~dpnxg" %%*  >> %%~ng.bat
   )
```


-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Idan Miara
Sent: January 12, 2022 2:27 PM
To: Rafael Lima <raplima at hotmail.com>
Cc: gdal dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?

Hi,

I had the same problem, here's my solution :
https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/auxiliary/batch_creator.py

Idan

On Wed, 12 Jan 2022, 23:22 Rafael Lima, <raplima at hotmail.com<mailto:raplima at hotmail.com>> wrote:
I thought about uninstalling it to lol
checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient
It was something of the sorts. The paths were actually fine, but the "default windows app" is activated when calling a file with a .py extension. So calling ogrmerge.py on the terminal would activate the default app instead of the activated python =/
Thanks!

________________________________
De: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> em nome de Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Enviado: quarta-feira, 12 de janeiro de 2022 16:09
Para: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Assunto: Re: [gdal-dev] How to fix path for gdal .py scripts in Anaconda-Windows?


I would have suggested to uninstall the offending proprietary software :-), but perhaps checking that PYTHONPATH or PYTHONHOME are not defined to an unexpected value will be sufficient
Le 12/01/2022 ? 19:24, Rafael Lima a ?crit :
## Expected behavior and actual behavior.

I installed gdal on a Windows environment using anaconda and tried using one of the .py scripts (e.g., ogrmerge.py). I expected the script to make use of the gdal installed in such an environment, but it seems that the script finds another gdal installation (screenshot below), thus throwing an error. My question seems to be related to the one in https://stackoverflow.com/questions/69328298/cannot-run-a-py-which-requires-a-gdal-module-in-anaconda-prompt-nor-in-command, apparently unsolved. I was wondering what is the correct approach to make sure gdal scripts find the correct gdal?

## Steps to reproduce the problem.
create a conda environment:
conda create -n test1 gdal
activate the environment
conda activate test1
call a gdal .py script
ogrmerge.py

In my case, that throws an error apparently because the script uses another gdal installation:
[cid:part1.66CDEAD4.863B431E at spatialys.com]

## Operating system

Windows 10 Pro - 20H2 version

## GDAL version and provenance

GDAL==3.0.2
GDAL==3.4.0

Thank you!
Rafael


_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/b90bbb8f/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Wed Jan 12 15:46:47 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 12 Jan 2022 23:46:47 +0000
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
 <503f3e5d-a04c-364f-6aac-0937d820c1be@spatialys.com>
 <CY4PR16MB1653ACFEB08BA698EC502CC8A5529@CY4PR16MB1653.namprd16.prod.outlook.com>
Message-ID: <6f0c2cde6ec6433cbdcbcc049ac0d8ab@yukon.ca>

It was something of the sorts. The paths were actually fine, but the "default windows app" is activated when calling a file with a .py extension. So calling ogrmerge.py on the terminal would activate the default app instead of the activated python =/

If you want to manage from the command line what windows does with the .py extension see ASSOC and FTYPE commands


-          https://ss64.com/nt/assoc.html

-          https://ss64.com/nt/ftype.html

-          https://ss64.com/nt/fassoc.txt


-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220112/02df32a2/attachment.html>

From mwtoews at gmail.com  Thu Jan 13 01:29:14 2022
From: mwtoews at gmail.com (Mike Taves)
Date: Thu, 13 Jan 2022 22:29:14 +1300
Subject: [gdal-dev] How to fix path for gdal .py scripts in
 Anaconda-Windows?
In-Reply-To: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
References: <CY4PR16MB1653E193285E6C1C615721AAA5529@CY4PR16MB1653.namprd16.prod.outlook.com>
Message-ID: <CAM2FmMrz_2M00WHNCng-EDypnLTdVt++_0xma6GRjXYKSgyLDw@mail.gmail.com>

On Thu, 13 Jan 2022 at 07:25, Rafael Lima <raplima at hotmail.com> wrote:
> I installed gdal on a Windows environment using anaconda and tried using one of the .py scripts (e.g., ogrmerge.py). I expected the script to make use of the gdal installed in such an environment, but it seems that the script finds another gdal installation (screenshot below), thus throwing an error. My question seems to be related to the one in stackoverflow, apparently unsolved. I was wondering what is the correct approach to make sure gdal scripts find the correct gdal?

Try calling the script directly using the CONDA_PREFIX environment
variable, i.e.:

(test1) C:\> python %CONDA_PREFIX%\Scripts\ogrmerge.py

From Matt.Wilkie at yukon.ca  Thu Jan 13 09:49:17 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 13 Jan 2022 17:49:17 +0000
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
Message-ID: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>

I am soooo happy today!

I discovered that starting with v2.10.24 Gimp knows about and keeps geotiff tags intact.[0] This means we can use tools like Magic Wand fuzzy select and a host of other tools to quickly fix a host of image issues that are difficult to address using command line tools and/or code.

The big one for me at the moment is dealing with the artifact fringes introduced on image edges when people use jpeg compression.[1] Nearblack is something I keep constantly close by, but it can't deal with areas that are blocked by horizontal scanning.[2] Today I used Gimp to fix the nodata area for 5.5 GB spot image in about 20 minutes, including time with experimentation. True it needed ~45 GB of memory[3] so this isn't something I'll be doing at home, but it worked! [4] And I didn't need to fart around afterwards restoring georeferencing.[5]

[0]: https://www.gimp.org/news/2021/03/29/gimp-2-10-24-released/
[1]: https://i.imgur.com/LZNn5Zt.png
[2]: https://i.imgur.com/avkILmX.png
[3]: https://i.imgur.com/DVLK1OB.png
[4] https://i.imgur.com/KRfxM0G.png
[5]: https://gis.stackexchange.com/a/115560


Some post processing is needed to get things up to our local preferences, for instance Gimp's alpha channel is 15-20% larger than a gdal external mask and it doesn't know my new favourite compression method of ZSTD, but this is a huge step forward. I could jump for joy, and maybe after I send this message I will ;-)

Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220113/94c53397/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jan 13 09:51:42 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 13 Jan 2022 17:51:42 +0000
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
In-Reply-To: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
References: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
Message-ID: <572e10fd3674419b9cc50113a9f36933@yukon.ca>

[5]: https://gis.stackexchange.com/a/115560

Oh look at that. Paint.net has supported geotiff tags since at least 2020. However it dumps a stack trace when I try and open the image I used in the Gimp experiment. The size perhaps.

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Matt.Wilkie at yukon.ca
Sent: January 13, 2022 10:49 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata

I am soooo happy today!

I discovered that starting with v2.10.24 Gimp knows about and keeps geotiff tags intact.[0] This means we can use tools like Magic Wand fuzzy select and a host of other tools to quickly fix a host of image issues that are difficult to address using command line tools and/or code.

The big one for me at the moment is dealing with the artifact fringes introduced on image edges when people use jpeg compression.[1] Nearblack is something I keep constantly close by, but it can?t deal with areas that are blocked by horizontal scanning.[2] Today I used Gimp to fix the nodata area for 5.5 GB spot image in about 20 minutes, including time with experimentation. True it needed ~45 GB of memory[3] so this isn?t something I?ll be doing at home, but it worked! [4] And I didn?t need to fart around afterwards restoring georeferencing.[5]

[0]: https://www.gimp.org/news/2021/03/29/gimp-2-10-24-released/
[1]: https://i.imgur.com/LZNn5Zt.png
[2]: https://i.imgur.com/avkILmX.png
[3]: https://i.imgur.com/DVLK1OB.png
[4] https://i.imgur.com/KRfxM0G.png


Some post processing is needed to get things up to our local preferences, for instance Gimp?s alpha channel is 15-20% larger than a gdal external mask and it doesn?t know my new favourite compression method of ZSTD, but this is a huge step forward. I could jump for joy, and maybe after I send this message I will ;-)

Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220113/6ddbac40/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Thu Jan 13 14:19:00 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 13 Jan 2022 22:19:00 +0000
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
In-Reply-To: <572e10fd3674419b9cc50113a9f36933@yukon.ca>
References: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
 <572e10fd3674419b9cc50113a9f36933@yukon.ca>
Message-ID: <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>

I discovered that starting with v2.10.24 Gimp knows about and keeps geotiff tags intact.[0] This means we can use tools like Magic Wand fuzzy select and a host of other tools to quickly fix a host of image issues that are difficult to address using command line tools and/or code.

It gets better: Gimp reads *.msk files without any fuss. This means drastically reduced memory requirements for quickly making simple edits only to the mask layer. So a person can:


-          take a large multiband band geotiff with a mask side car file, squash the 3+ bands into 1 band

-          open the original .msk file in Gimp

-          drag and drop the squashed 1 band file on top the Gimp session

o   selecting import tif as a Layer

-          Lock the imported layer, set to 50% transparent (or whatever). This is the Visual Guide layer.

-          Paint as thou wilt on the base mask layer (Black is Nodata, White is Data)

-          Delete the visual guide layer

-          Export the base mask layer

o   Select tiff File Type

?  use Deflate compression

?  keep metadata (Geotiff will be disabled, that?s okay)

?  use ?input-rgb-geotiff.tif.msk? as file name

-          DONE!

(this is so awesome. :)

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220113/b23fbcb7/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jan 13 14:42:38 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 13 Jan 2022 22:42:38 +0000
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
In-Reply-To: <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>
References: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
 <572e10fd3674419b9cc50113a9f36933@yukon.ca>
 <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>
Message-ID: <e5d6be275acd48fb916139ea875f1e5e@yukon.ca>

-          take a large multiband band geotiff with a mask side car file, squash the 3+ bands into 1 band

Squashing might be unnecessary. If you open the .msk file first the document is set to 1-bit colour mode, then anything dropped on top is converted to the same mode. In effect squashing on import. The only question is whether it?s more efficient to let Gimp do this or to process ahead of time with gdal_translate. Which is faster probably depends on local conditions.

(this is so awesome. I just have to keep saying that. :)

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220113/a6b1a8f9/attachment-0001.html>

From nik at nikosalexandris.net  Thu Jan 13 15:17:15 2022
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Fri, 14 Jan 2022 00:17:15 +0100
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
In-Reply-To: <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>
References: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
 <572e10fd3674419b9cc50113a9f36933@yukon.ca>
 <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>
Message-ID: <dc08c6776e4bcc3d3c7333646d41b3f6@nikosalexandris.net>

WoW. This is really awesome! 

Whish this existed many years ago... I was using GIMP and all that magic
tools but without resampling or altering the size of the image, and
carefully re-applying geo-tags with the use of listgeo and geotifcp
(like mentioned in https://marc.info/?l=grass-user&m=121788119621237) 
:-). 

On 2022-01-13 23:19, Matt.Wilkie at yukon.ca wrote:

>> 

> _I discovered that starting with v2.10.24 Gimp knows about and keeps geotiff tags intact.[0] This means we can use tools like Magic Wand fuzzy select and a host of other tools to quickly fix a host of image issues that are difficult to address using command line tools and/or code. _ 
> 
> It gets better: Gimp reads *.msk files without any fuss. This means drastically reduced memory requirements for quickly making simple edits only to the mask layer. So a person can: 
> 
> -          take a large multiband band geotiff with a mask side car file, squash the 3+ bands into 1 band 
> 
> -          open the original .msk file in Gimp 
> 
> -          drag and drop the squashed 1 band file on top the Gimp session 
> 
> o   selecting import tif as a Layer 
> 
> -          Lock the imported layer, set to 50% transparent (or whatever). This is the Visual Guide layer. 
> 
> -          Paint as thou wilt on the base mask layer (Black is Nodata, White is Data) 
> 
> -          Delete the visual guide layer 
> 
> -          Export the base mask layer 
> 
> o   Select tiff File Type 
> 
> ?  use Deflate compression 
> 
> ?  keep metadata (Geotiff will be disabled, that's okay) 
> 
> ?  use "input-rgb-geotiff.tif.msk" as file name 
> 
> -          DONE! 
> 
> _(this is so awesome. :)_
> 
> -Matt 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220114/3707b3e5/attachment.html>

From Matt.Wilkie at yukon.ca  Thu Jan 13 15:46:39 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Thu, 13 Jan 2022 23:46:39 +0000
Subject: [gdal-dev] Edit geotiff in Gimp and don't lose metadata
In-Reply-To: <dc08c6776e4bcc3d3c7333646d41b3f6@nikosalexandris.net>
References: <cd57cd5514b64ca7a1464d3685ccfad7@yukon.ca>
 <572e10fd3674419b9cc50113a9f36933@yukon.ca>
 <85760bc8507e46ba84d3228d4e0e6091@yukon.ca>
 <dc08c6776e4bcc3d3c7333646d41b3f6@nikosalexandris.net>
Message-ID: <b22bde7e04c842c09c72294f8d269cad@yukon.ca>

Yes, a long time wish indeed! In discussing this with a colleague today I traced back my first strong desrire for such a thing back to when I got into making elevation models and discovering the hell that results with improperly set nodata. In 1994!

Now my goal is figure out how to make an external .msk file without going through the heavy processing time of using nearblack. Does anyone have a utility parameter or python snippet to create a mask file from internal Nodata value cells? or an arbitrary pixel value?

-Matt

From: Nikos Alexandris <nik at nikosalexandris.net>
Sent: January 13, 2022 4:17 PM
To: Matt.Wilkie <Matt.Wilkie at yukon.ca>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Edit geotiff in Gimp and don't lose metadata

WoW. This is really awesome!

Whish this existed many years ago... I was using GIMP and all that magic tools but without resampling or altering the size of the image, and carefully re-applying geo-tags with the use of listgeo and geotifcp (like mentioned in https://marc.info/?l=grass-user&m=121788119621237)  :-).



On 2022-01-13 23:19, Matt.Wilkie at yukon.ca<mailto:Matt.Wilkie at yukon.ca> wrote:


I discovered that starting with v2.10.24 Gimp knows about and keeps geotiff tags intact.[0] This means we can use tools like Magic Wand fuzzy select and a host of other tools to quickly fix a host of image issues that are difficult to address using command line tools and/or code.



It gets better: Gimp reads *.msk files without any fuss. This means drastically reduced memory requirements for quickly making simple edits only to the mask layer. So a person can:



-          take a large multiband band geotiff with a mask side car file, squash the 3+ bands into 1 band

-          open the original .msk file in Gimp

-          drag and drop the squashed 1 band file on top the Gimp session

o   selecting import tif as a Layer

-          Lock the imported layer, set to 50% transparent (or whatever). This is the Visual Guide layer.

-          Paint as thou wilt on the base mask layer (Black is Nodata, White is Data)

-          Delete the visual guide layer

-          Export the base mask layer

o   Select tiff File Type

?  use Deflate compression

?  keep metadata (Geotiff will be disabled, that's okay)

?  use "input-rgb-geotiff.tif.msk" as file name

-          DONE!



(this is so awesome. :)



-Matt

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220113/837f1d5d/attachment-0001.html>

From robert.coup at koordinates.com  Fri Jan 14 05:15:48 2022
From: robert.coup at koordinates.com (Robert Coup)
Date: Fri, 14 Jan 2022 13:15:48 +0000
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
Message-ID: <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>

Hi,

On Wed, 12 Jan 2022 at 21:36, Markus Neteler <neteler at osgeo.org> wrote:

> On Wed, Jan 12, 2022 at 10:06 PM Even Rouault
> > - I've used the sandbox.zenodo.org system and create a dummy release in
> my fork to check that it works properly:
> https://sandbox.zenodo.org/account/settings/github/repository/rouault/gdal
> (do not use the DOI from there. it is just dummy)
>
> I guess the sandbox link is this: https://sandbox.zenodo.org/record/994062


Only thing I notice there is:

*Cite as *

> Rouault, Even, Warmerdam, Frank, Schwehr, Kurt, Kiselev, Andrey, Butler,
> Howard, ?oskot, Mateusz, Szekeres, Tamas, Tourigny, Etienne, Landa, Martin,
> Miara, Idan, Elliston, Ben, Kumar, Chaitanya, Plesea, Lucian, Morissette,
> Daniel, Jolma, Ari, & Dawson, Nyall. (2022). GDAL (test_zenodo2).
> https://doi.org/10.5072/zenodo.994062


Should "OSGeo" appear in there somewhere?

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220114/05412d18/attachment.html>

From even.rouault at spatialys.com  Fri Jan 14 05:26:39 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Jan 2022 14:26:39 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
 <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
Message-ID: <5247dad7-a0b8-7449-c764-0f9afa5325d2@spatialys.com>

The citation is apparently synthesized from the "creators" listed in 
.zenodo.json. I'm not sure if it's valid to OSGeo as a creator. We could 
also have "and other contributors" since I cut the list to top git 
committers, which is quite . arbitrary. I'm not an academic person by 
any means and the art of citation is unknown territory to me so I tend 
the stick to someone more interested and versed in the subject to 
improve on those first steps :-)

Le 14/01/2022 ? 14:15, Robert Coup a ?crit?:
> Hi,
>
> On Wed, 12 Jan 2022 at 21:36, Markus Neteler <neteler at osgeo.org 
> <mailto:neteler at osgeo.org>> wrote:
>
>     On Wed, Jan 12, 2022 at 10:06 PM Even Rouault
>     > - I've used the sandbox.zenodo.org <http://sandbox.zenodo.org>
>     system and create a dummy release in my fork to check that it
>     works properly:
>     https://sandbox.zenodo.org/account/settings/github/repository/rouault/gdal
>     <https://sandbox.zenodo.org/account/settings/github/repository/rouault/gdal>
>     (do not use the DOI from there. it is just dummy)
>
>     I guess the sandbox link is this:
>     https://sandbox.zenodo.org/record/994062
>     <https://sandbox.zenodo.org/record/994062>
>
>
> Only thing I notice there is:
>
> *Cite as *
>
>     Rouault, Even, Warmerdam, Frank, Schwehr, Kurt, Kiselev, Andrey,
>     Butler, Howard, ?oskot, Mateusz, Szekeres, Tamas, Tourigny,
>     Etienne, Landa, Martin, Miara, Idan, Elliston, Ben, Kumar,
>     Chaitanya, Plesea, Lucian, Morissette, Daniel, Jolma, Ari, &
>     Dawson, Nyall. (2022). GDAL (test_zenodo2).
>     https://doi.org/10.5072/zenodo.994062
>     <https://doi.org/10.5072/zenodo.994062>
>
>
> Should "OSGeo" appear in there somewhere?
>
> Rob :)

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220114/08d6f8f5/attachment.html>

From neteler at osgeo.org  Fri Jan 14 05:47:13 2022
From: neteler at osgeo.org (Markus Neteler)
Date: Fri, 14 Jan 2022 14:47:13 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <5247dad7-a0b8-7449-c764-0f9afa5325d2@spatialys.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
 <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
 <5247dad7-a0b8-7449-c764-0f9afa5325d2@spatialys.com>
Message-ID: <CALFmHhtb_rGK=rXHDApQTEXKOAVyMFJb4dnM9eCR8Gir7fk+dg@mail.gmail.com>

On Fri, Jan 14, 2022 at 2:38 PM Even Rouault <even.rouault at spatialys.com> wrote:
>
> The citation is apparently synthesized from the "creators" listed in .zenodo.json. I'm not sure if it's valid to OSGeo as a creator. We could also have "and other contributors" since I cut the list to top git committers, which is quite . arbitrary. I'm not an academic person by any means and the art of citation is unknown territory to me so I tend the stick to someone more interested and versed in the subject to improve on those first steps :-)

Commonly, this is cited as

organization = {Open Source Geospatial Foundation}

Markus

From even.rouault at spatialys.com  Mon Jan 17 05:37:38 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Jan 2022 14:37:38 +0100
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
Message-ID: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>

Hi,

The new CMake build system 
(https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent 
progress, and I believe that it should be in a production ready state on 
time for GDAL 3.5.0 (~ May). It is already very close to it according to 
a checklist I had created 
(https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c). 
Consequently we could shorten the rather conservative schedule presented 
in RFC 84 to :

- Formally deprecate GNUmakefile and NMake base file systems. Users and 
packagers are encouraged to switch to CMake and actively report (and 
help fixing) issues the find in the process.

==> Target: GDAL 3.5 / May 2022. GDAL 3.5.x point releases will be used 
to address reported issues.

- Completely remove GNUmakefile and NMake base file systems, and make 
CMake the only build system in GDAL source tree.

==> Target: GDAL 3.6 / November 2022


I can't see real advantages in keeping the 3 build systems longer than 
strictly needed:

- it requires more maintenance effort and makes new contributions more 
complicated

- we won't probably get significant feedback regarding the CMake build 
system until people have to adopt it because they have no other alternative.

We already greatly welcome feedback from people trying with master. To 
facilitate this, I believe we could cut a GDAL 3.5 alpha in early March 
so that people who wait for "official" packages have a chance to give it 
a try too.

Thoughts ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew at aitchison.me.uk  Mon Jan 17 06:43:43 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 17 Jan 2022 14:43:43 +0000 (GMT)
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <d22e778-7dd-c233-efb1-73fb47e4b9ef@aitchison.me.uk>


+1 (Not that I have a vote).


The CMake builds of my github clone seems OK.
They do have build failures from time to time but I assume
that is always true of bleeding edge code.

On Mon, 17 Jan 2022, Even Rouault wrote:

> Hi,
>
> The new CMake build system 
> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent 
> progress, and I believe that it should be in a production ready state on time 
> for GDAL 3.5.0 (~ May). It is already very close to it according to a 
> checklist I had created 
> (https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c). 
> Consequently we could shorten the rather conservative schedule presented in 
> RFC 84 to :
>
> - Formally deprecate GNUmakefile and NMake base file systems. Users and 
> packagers are encouraged to switch to CMake and actively report (and help 
> fixing) issues the find in the process.
>
> ==> Target: GDAL 3.5 / May 2022. GDAL 3.5.x point releases will be used to 
> address reported issues.
>
> - Completely remove GNUmakefile and NMake base file systems, and make CMake 
> the only build system in GDAL source tree.
>
> ==> Target: GDAL 3.6 / November 2022
>
>
> I can't see real advantages in keeping the 3 build systems longer than 
> strictly needed:
>
> - it requires more maintenance effort and makes new contributions more 
> complicated
>
> - we won't probably get significant feedback regarding the CMake build system 
> until people have to adopt it because they have no other alternative.
>
> We already greatly welcome feedback from people trying with master. To 
> facilitate this, I believe we could cut a GDAL 3.5 alpha in early March so 
> that people who wait for "official" packages have a chance to give it a try 
> too.
>
> Thoughts ?
>
> Even
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From mateusz at loskot.net  Mon Jan 17 08:06:12 2022
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 17 Jan 2022 17:06:12 +0100
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <CABUeae8QE40DvSiPg-9UGNeA_YNbveSTqJ_OarxUq5yTp7QM1g@mail.gmail.com>

On Mon, 17 Jan 2022 at 14:37, Even Rouault <even.rouault at spatialys.com> wrote:
> The new CMake build system
> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent
> progress, and I believe that it should be in a production ready state on
> time for GDAL 3.5.0 (~ May).

Thanks for those efforts!

> Consequently we could shorten the rather conservative schedule

+1

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From thomas.bonfort at gmail.com  Mon Jan 17 08:10:42 2022
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Mon, 17 Jan 2022 17:10:42 +0100
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <CAOM3y2ixWJJBByHObCdyqH9Pj_BSPOiAAUdP-ucmF7Hy2OD3-A@mail.gmail.com>

> I can't see real advantages in keeping the 3 build systems longer than
> strictly needed
>

fully agree, there's no advantage in delaying shipping if it's ready

--
thomas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220117/38955b95/attachment.html>

From jmckenna at gatewaygeomatics.com  Mon Jan 17 10:10:47 2022
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 17 Jan 2022 14:10:47 -0400
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <CABUeae8QE40DvSiPg-9UGNeA_YNbveSTqJ_OarxUq5yTp7QM1g@mail.gmail.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <CABUeae8QE40DvSiPg-9UGNeA_YNbveSTqJ_OarxUq5yTp7QM1g@mail.gmail.com>
Message-ID: <b60bd134-6cc2-874b-afb3-f807a80baa1f@gatewaygeomatics.com>

On 2022-01-17 9:37 a.m., Even Rouault wrote:
> 
>> Consequently we could shorten the rather conservative schedule
> 

+1

thanks!

-jeff



-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, MapServer Consulting and Training
co-founder of FOSS4G
http://gatewaygeo.com/

From norman.barker at gmail.com  Mon Jan 17 10:55:33 2022
From: norman.barker at gmail.com (Norman Barker)
Date: Mon, 17 Jan 2022 12:55:33 -0600
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <b60bd134-6cc2-874b-afb3-f807a80baa1f@gatewaygeomatics.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <CABUeae8QE40DvSiPg-9UGNeA_YNbveSTqJ_OarxUq5yTp7QM1g@mail.gmail.com>
 <b60bd134-6cc2-874b-afb3-f807a80baa1f@gatewaygeomatics.com>
Message-ID: <CAN_Dn-FWR46ohtvzGGn5L+R3-po0bjbQb2LGdQCM806YL22Ryw@mail.gmail.com>

+1

I am in favour, and will give it a try.

Norman

On Mon, Jan 17, 2022 at 12:11 PM Jeff McKenna <jmckenna at gatewaygeomatics.com>
wrote:

> On 2022-01-17 9:37 a.m., Even Rouault wrote:
> >
> >> Consequently we could shorten the rather conservative schedule
> >
>
> +1
>
> thanks!
>
> -jeff
>
>
>
> --
> Jeff McKenna
> GatewayGeo: Developers of MS4W, MapServer Consulting and Training
> co-founder of FOSS4G
> http://gatewaygeo.com/
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220117/fb927d8e/attachment.html>

From szekerest at gmail.com  Mon Jan 17 12:20:19 2022
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon, 17 Jan 2022 21:20:19 +0100
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <CACALY+T=+0ZgpTPRA_guJj=k-Vusx6mXCA5N2sDRv8a9ZQzmdA@mail.gmail.com>

+1

I'll also do some checks in the next few weeks to make sure the things work
on Windows as expected.

Best regards,

Tamas


Even Rouault <even.rouault at spatialys.com> ezt ?rta (id?pont: 2022. jan.
17., H, 14:38):

> Hi,
>
> The new CMake build system
> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent
> progress, and I believe that it should be in a production ready state on
> time for GDAL 3.5.0 (~ May). It is already very close to it according to
> a checklist I had created
> (
> https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c).
>
> Consequently we could shorten the rather conservative schedule presented
> in RFC 84 to :
>
> - Formally deprecate GNUmakefile and NMake base file systems. Users and
> packagers are encouraged to switch to CMake and actively report (and
> help fixing) issues the find in the process.
>
> ==> Target: GDAL 3.5 / May 2022. GDAL 3.5.x point releases will be used
> to address reported issues.
>
> - Completely remove GNUmakefile and NMake base file systems, and make
> CMake the only build system in GDAL source tree.
>
> ==> Target: GDAL 3.6 / November 2022
>
>
> I can't see real advantages in keeping the 3 build systems longer than
> strictly needed:
>
> - it requires more maintenance effort and makes new contributions more
> complicated
>
> - we won't probably get significant feedback regarding the CMake build
> system until people have to adopt it because they have no other
> alternative.
>
> We already greatly welcome feedback from people trying with master. To
> facilitate this, I believe we could cut a GDAL 3.5 alpha in early March
> so that people who wait for "official" packages have a chance to give it
> a try too.
>
> Thoughts ?
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220117/6d19cf18/attachment.html>

From Matt.Wilkie at yukon.ca  Mon Jan 17 16:38:06 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Tue, 18 Jan 2022 00:38:06 +0000
Subject: [gdal-dev] Nodata is None, but still has blanks?
Message-ID: <1899c908fc904b39b27740399795de9b@yukon.ca>

I'm confused. The attached image has no Nodata, but when dropped into Qgis and ArcGIS large areas are still drawn transparently, and there is no 4th band for a mask or alpha. How is this happening?

(I'm trying to get completely rid of all Nodata and Mask info, so as to start over creating one of those from blank slate).

Matt Wilkie
Geomatics Developer & Administrator
Environment | Technology, Innovation and Mapping
T 867-667-8133 | Yukon.ca<http://yukon.ca/>
Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/12495314/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sample-no-mask.tif
Type: image/tiff
Size: 21723 bytes
Desc: sample-no-mask.tif
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/12495314/attachment-0001.tif>

From warmerdam at pobox.com  Mon Jan 17 18:32:15 2022
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 17 Jan 2022 21:32:15 -0500
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <1899c908fc904b39b27740399795de9b@yukon.ca>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
Message-ID: <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>

Matt,

Tiffinfo reports the following.  Note the "Transparency Mask" subfile.

$ tiffinfo sample-no-mask.tif
...
TIFF Directory at offset 0xe2 (226)
  Image Width: 304 Image Length: 285
  Tile Width: 512 Tile Length: 512
  Bits/Sample: 8
  Sample Format: unsigned integer
  Compression Scheme: JPEG
  Photometric Interpretation: YCbCr
  YCbCr Subsampling: 2, 2
  Samples/Pixel: 3
  Planar Configuration: single image plane
  Reference Black/White:
     0:     0   255
     1:   128   255
     2:   128   255
  Tag 33550: 100.000000,100.000000,0.000000
  Tag 33922:
0.000000,0.000000,0.000000,343739.586723,1091611.850704,0.000000
  Tag 34735:
1,1,0,7,1024,0,1,1,1025,0,1,1,1026,34737,21,0,2049,34737,6,21,2054,0,1,9102,3072,0,1,3578,3076,0,1,9001
  Tag 34737: NAD83 / Yukon Albers|NAD83|
  JPEG Tables: (142 bytes)
TIFF Directory at offset 0x33a (826)
  Subfile Type: transparency mask (4 = 0x4)
  Image Width: 304 Image Length: 285
  Tile Width: 512 Tile Length: 512
  Bits/Sample: 1
  Sample Format: unsigned integer
  Compression Scheme: AdobeDeflate
  Photometric Interpretation: transparency mask
  Samples/Pixel: 1
  Planar Configuration: single image plane
  Predictor: none 1 (0x1)

This is recognised by GDAL and treated as a special kind of mask as
indicated in the gdalinfo report:

$ gdalinfo sample-no-mask.tif
Driver: GTiff/GeoTIFF
Files: sample-no-mask.tif
Size is 304, 285
...
Origin = (343739.586723418149631,1091611.850704099284485)
Pixel Size = (100.000000000000000,-100.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=YCbCr JPEG
  INTERLEAVE=PIXEL
  SOURCE_COLOR_SPACE=YCbCr
Corner Coordinates:
Upper Left  (  343739.587, 1091611.851)
Lower Left  (  343739.587, 1063111.851)
Upper Right (  374139.587, 1091611.851)
Lower Right (  374139.587, 1063111.851)
Center      (  358939.587, 1077361.851)
Band 1 Block=512x512 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET
Band 2 Block=512x512 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET
Band 3 Block=512x512 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET

In QGIS's "Information" tab under properties I see:

"More Information: Mask band (exposed as alpha band)"

So QGIS is using the special mask as alpha.   I find that if I do:

tiffcp sample-no-mask.tif,0 x0.tif

I get an "x0.tif" with just the jpeg image, and not the mask.  That may be
helpful for you (without uncompressing the jpeg image).

Best regards,
Frank




On Mon, Jan 17, 2022 at 7:38 PM <Matt.Wilkie at yukon.ca> wrote:

> I?m confused. The attached image has no Nodata, but when dropped into Qgis
> and ArcGIS large areas are still drawn transparently, and there is no 4th
> band for a mask or alpha. How is this happening?
>
>
>
> (I?m trying to get completely rid of all Nodata and Mask info, so as to
> start over creating one of those from blank slate).
>
>
>
> *Matt Wilkie*
>
> Geomatics Developer & Administrator
>
> Environment | Technology, Innovation and Mapping
>
> T 867-667-8133 | *Yukon.ca <http://yukon.ca/>*
>
> *Hours: 08:30-16:30, Mon-Wed: Office, Thu: Remote, Fri: Away.*
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220117/c24f1698/attachment.html>

From even.rouault at spatialys.com  Tue Jan 18 03:20:49 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jan 2022 12:20:49 +0100
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
Message-ID: <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>

 >? I find that if I do:
> tiffcp?sample-no-mask.tif,0 x0.tif
>
> I get an "x0.tif" with just the jpeg image, and not the mask. That may 
> be helpful for you (without uncompressing the jpeg image).

tiffcp doesn't use the raw interface of libtiff, hence JPEG 
decompression&recompression will occur.

tiffsplit avoids that as it does use the raw interface:

tiffsplit sample-no-mask.tif out

will generate a outaaa.tif file with the original JPEG content (the 
geotif tags will be lost however, and will have to be reinjected 
https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/samples/gdalcopyproj.py 
for example)

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/69a76d12/attachment.html>

From even.rouault at spatialys.com  Tue Jan 18 03:37:09 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jan 2022 12:37:09 +0100
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
Message-ID: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>

Hi,

Please find in https://github.com/OSGeo/gdal/pull/3855a RFC 
thatdescribes the policies that the GDAL project will apply to assess 
substantial code additions, typically new drivers, in particular coming 
for new contributors to the project.

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From robert.coup at koordinates.com  Tue Jan 18 03:54:14 2022
From: robert.coup at koordinates.com (Robert Coup)
Date: Tue, 18 Jan 2022 11:54:14 +0000
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
Message-ID: <CAFLLRpJZgrDMooHin20q4sUdB-cSXF7jL2kNxOZ3c7jELNr1Wg@mail.gmail.com>

Working link is https://github.com/OSGeo/gdal/pull/5128

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/ddd393c2/attachment.html>

From mathias.kemeter at sap.com  Tue Jan 18 04:55:48 2022
From: mathias.kemeter at sap.com (Kemeter, Mathias)
Date: Tue, 18 Jan 2022 12:55:48 +0000
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
Message-ID: <PAXPR02MB7326F8DFC631B031B3837ABAF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>

Hi Even, hi everyone,

As we (SAP) are probably one of the triggers for formalizing this policy, let me take a first stab from the perspective of a new contributor trying to make a substantial contribution:


  *   Having such a policy greatly increases transparency on what has to be done to make a driver contribution. The outlined criteria reduces the need for lengthy discussions.

  *   I do specifically like the idea of having a list of responsible contacts. It makes it easier to track personas ? even if people change. Still, the list could be outdated at some point. Maybe a regular check-in (via email, virtual meeting, etc.) would be beneficial.

  *   To me, the term ?significant code addition? should be defined more precisely. Not only in terms of quantity, but also complexity. New drivers typically have a significant footprint in terms of code quantity, but they are isolated. Whereas there may be other contributions with less code, but spanning several software components.

  *   At least for corporate contributors, the bullet point of participating in the day-to-day activities is too vague to be seriously accomplishable. While I do well understand, what the goal of the statement is, I still think, the responsibilities have to be defined (and quantified) more clearly as the current description may be interpreted as a bottomless pit for development resources.

Best regards,
Mathias

Mathias Kemeter
Head of Multi-model Engines, SAP HANA Database & Analytics

SAP SE Dietmar-Hopp-Allee 16, 69190 Walldorf, Germany
T +49 6227 7-64316, M +49 151 62345760, E mathias.kemeter at sap.com
Mandatory Disclosure Statement:
http://www.sap.com/company/legal/impressum.epx

This e-mail may contain trade secrets or privileged, undisclosed, or otherwise confidential information.  If you have received this e-mail in error, you are hereby notified that any review, copying, or distribution of it is strictly prohibited. Please inform us immediately and destroy the original transmittal.
Thank you for your cooperation

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/bb4388ef/attachment-0001.html>

From gdt at lexort.com  Tue Jan 18 05:06:00 2022
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 18 Jan 2022 08:06:00 -0500
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com> (Even
 Rouault's message of "Mon, 17 Jan 2022 14:37:38 +0100")
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <rmibl09qjlz.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

> The new CMake build system
> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent
> progress, and I believe that it should be in a production ready state
> on time for GDAL 3.5.0 (~ May). It is already very close to it
> according to a checklist I had created
> (https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c).

Do you mean that the master branch already has cmake support that you
believe 99% meets the requirements?

I think that establishing a date before the code meets requirement risks
a later decision to proceed anyway despite meeting the requirements.  So
I'd like to flip this around to the steps needed, with the autoconf
removal decision gated on packager testing.

Specifically:

  - Get master in a shape where the developers believe the requirements
    are met.  This includes build instructions, specifically about how
    to get the right RPATH behavior.  It's going to need testing
    building to a prefix other than /usr and specifically a prefix not
    in the default linker search path.

    I'm unclear on the plan for the test suite.  If running py-test in
    the tests directory against an installed build still works, that's
    fine -- I don't see a need to couple test improvements with the
    cmake conversion.

  - Produce an alpha tarball, following the same (documented) procedure
    that would be used for a relaase in an autoconf-removed world.  This
    is what packagers package, and users hand build.  Tarball creation
    should be documented and scripted, so this should be a combination
    of good testing and near-zero effort.

  - Call for packager and user testing of the alpha tarball.  Give them
    1 full month, because converting a packaging build from autoconf to
    cmake is not trivial, and because everything that depends on gdal
    needs testing too.  (In my case, the gdal build control files are
    much bigger than typical packages.)

    I expect to find problems, because I usually do on autoconf->cmake
    transitions, and often around RPATH handling.  But I will be happy
    to report 100% success if that's how it is.  And I'll try to do this
    sooner rather than later.

  - If there are any failures to meet requirements (including on systems
    where gdal does not have CI; that's the point of the call for
    testing), fix and release another alpha.  2 weeks is adequate
    testing time, if the failures were minor enough to not prevent
    getting to a working state.

  - Once the report/fix cycle ends, then the autoconf removal can
    proceed.

The above can be pipelined, if an alpha tarball can be produced that
90-95% meets requirements, enough that it's reasonable to do a draft
packaging conversion and end up with an installed gdal that one can
build a working qgis against.

Will this work for May?  I don't know, and I think the big questions are
when a believed-requirements-meeting alpha tarball can be produced, and
how many residual issues there are.  With a alpha in 2 weeks, the odds
are good.  With an alpha on April 1, I don't see how it can work.

Greg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/df717742/attachment.sig>

From gdt at lexort.com  Tue Jan 18 05:14:29 2022
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 18 Jan 2022 08:14:29 -0500
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com> (Even
 Rouault's message of "Tue, 18 Jan 2022 12:37:09 +0100")
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
Message-ID: <rmi5yqhqj7u.fsf@s1.lexort.com>


If that is meant to apply mainly to drivers with proprietary SDKs, it
looks fine.   It's a little hard to tell which things apply to drivers
that don't have proprietary dependencies.

For example:

  Drivers require a designated responsible contact.

seems perhaps a bit much, perhaps not, for something that is actually
Free Software.


Besides proprietary SDKs being a problem because the users can't read
them and fix bugs, they are also non-portable.



Another comment is about "complicated registration process".  I
sympathize but I don't really understand that.   So it might be good to
say what's acceptable, which could be one of:

  The SDK must be downloadable by a URL with no user interaction

  It's ok to have a form which requires a name and an email address, and
  which does not opt the user in to spamming, to download.

  It's ok to have a form which requires a name and an email address (and
  opting in to spamming is ok) to download.
 
  Something else



I also think it probably went without saying that drivers that depend on
proprietary SDKs will be default off, even if the build system finds the
SDK, so that people who build GDAL will not accidentally create
proprietary software.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/2ba48f00/attachment.sig>

From Anthony.W.Baker at boeing.com  Tue Jan 18 05:18:24 2022
From: Anthony.W.Baker at boeing.com (Baker (US), Anthony W)
Date: Tue, 18 Jan 2022 13:18:24 +0000
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <rmi5yqhqj7u.fsf@s1.lexort.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
 <rmi5yqhqj7u.fsf@s1.lexort.com>
Message-ID: <05c3345fdabd4244bcbdddb33b42e73b@boeing.com>

unsubscribe

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Greg Troxel
Sent: Tuesday, January 18, 2022 8:14 AM
To: Even Rouault <even.rouault at spatialys.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Call for discussion on RFC 85: Policy regarding substantial code additions


If that is meant to apply mainly to drivers with proprietary SDKs, it
looks fine.   It's a little hard to tell which things apply to drivers
that don't have proprietary dependencies.

For example:

  Drivers require a designated responsible contact.

seems perhaps a bit much, perhaps not, for something that is actually Free Software.


Besides proprietary SDKs being a problem because the users can't read them and fix bugs, they are also non-portable.



Another comment is about "complicated registration process".  I
sympathize but I don't really understand that.   So it might be good to
say what's acceptable, which could be one of:

  The SDK must be downloadable by a URL with no user interaction

  It's ok to have a form which requires a name and an email address, and
  which does not opt the user in to spamming, to download.

  It's ok to have a form which requires a name and an email address (and
  opting in to spamming is ok) to download.
 
  Something else



I also think it probably went without saying that drivers that depend on proprietary SDKs will be default off, even if the build system finds the SDK, so that people who build GDAL will not accidentally create proprietary software.

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jan 18 05:57:29 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 18 Jan 2022 13:57:29 +0000
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
Message-ID: <f95859f3a1f741629b945cc15d811ca3@maanmittauslaitos.fi>

Hi,

Greg Troxel wrote:

> If that is meant to apply mainly to drivers with proprietary SDKs, it
> looks fine.   It's a little hard to tell which things apply to drivers
> that don't have proprietary dependencies.
I think that even drivers with no proprietary dependencies require a thorough understanding about what they do and how they work and for example what standards they try to implement. It could mean hours or days for a generic GDAL maintainer to make the first bug fix.

> For example:
> Drivers require a designated responsible contact.
> seems perhaps a bit much, perhaps not, for something that is actually Free Software.
The intention of the RFC, as I understand it, is to clarify that no new drivers will be accepted without a named maintainer. For a Free Software there is room to live also outside GDAL. 

> Besides proprietary SDKs being a problem because the users can't read them and fix bugs, they are also non-portable.
I belong to those users who can't read and fix even Free Software but depend on maintainers.

-Jukka Rahkonen-

From even.rouault at spatialys.com  Tue Jan 18 06:27:49 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jan 2022 15:27:49 +0100
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <rmibl09qjlz.fsf@s1.lexort.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
Message-ID: <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>

Greg,

I will not respond point by point, but the message here is: "CMake 
support is available and believed to be in good shape into master based 
on our manual tests and initial CI configuration exercising it, it will 
replace autotools+nmake soon, be ready for it and help polishing it". 
There will perhaps be areas where it will not do everything that 
existing build systems made, but existing build systems have also their 
flows that are not easily fixable. So be it. Having one single build 
system at the end of the process, and used in an idiomatic way (our 
autoconf system without automake is far from being idiomatic), is the 
main objective of this whole effort from my side.

CMake might not be completely ready for 3.5.0 for all imaginable 
platforms & configurations (we don't promise to support all platforms 
anyway. I don't believe we have a formal list of supported platforms by 
the way. I'd say what is tested on our CI is the practical definition of 
what is supported), and we won't defer indefinitely 3.5.0 if it doesn't 
work on some confs. That's why autoconf&nmake will only be removed in 
3.6.0, and we have 3.5.x point releases to help address issues.

The release process? is described in HOWTO-RELEASE and it points to the 
mkgdaldist.sh script

You can generate a gdal-master.tar.gz with:

./mkgdaldist.sh master -branch master

No idea if the script works properly on non-Linux systems. You'll need 
some prerequisites for the script to run: Sphinx (pip install -r 
doc/requirements.txt) to generate man pages, swig

Or just clone the git repo and rm -rf autotest .git .github, and that 
will be very close to the final tarball, at least for the purpose of 
doing a CMake build

and try packaging this.

Even


Le 18/01/2022 ? 14:06, Greg Troxel a ?crit?:
> Even Rouault <even.rouault at spatialys.com> writes:
>
>> The new CMake build system
>> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent
>> progress, and I believe that it should be in a production ready state
>> on time for GDAL 3.5.0 (~ May). It is already very close to it
>> according to a checklist I had created
>> (https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c).
> Do you mean that the master branch already has cmake support that you
> believe 99% meets the requirements?
>
> I think that establishing a date before the code meets requirement risks
> a later decision to proceed anyway despite meeting the requirements.  So
> I'd like to flip this around to the steps needed, with the autoconf
> removal decision gated on packager testing.
>
> Specifically:
>
>    - Get master in a shape where the developers believe the requirements
>      are met.  This includes build instructions, specifically about how
>      to get the right RPATH behavior.  It's going to need testing
>      building to a prefix other than /usr and specifically a prefix not
>      in the default linker search path.
>
>      I'm unclear on the plan for the test suite.  If running py-test in
>      the tests directory against an installed build still works, that's
>      fine -- I don't see a need to couple test improvements with the
>      cmake conversion.
>
>    - Produce an alpha tarball, following the same (documented) procedure
>      that would be used for a relaase in an autoconf-removed world.  This
>      is what packagers package, and users hand build.  Tarball creation
>      should be documented and scripted, so this should be a combination
>      of good testing and near-zero effort.
>
>    - Call for packager and user testing of the alpha tarball.  Give them
>      1 full month, because converting a packaging build from autoconf to
>      cmake is not trivial, and because everything that depends on gdal
>      needs testing too.  (In my case, the gdal build control files are
>      much bigger than typical packages.)
>
>      I expect to find problems, because I usually do on autoconf->cmake
>      transitions, and often around RPATH handling.  But I will be happy
>      to report 100% success if that's how it is.  And I'll try to do this
>      sooner rather than later.
>
>    - If there are any failures to meet requirements (including on systems
>      where gdal does not have CI; that's the point of the call for
>      testing), fix and release another alpha.  2 weeks is adequate
>      testing time, if the failures were minor enough to not prevent
>      getting to a working state.
>
>    - Once the report/fix cycle ends, then the autoconf removal can
>      proceed.
>
> The above can be pipelined, if an alpha tarball can be produced that
> 90-95% meets requirements, enough that it's reasonable to do a draft
> packaging conversion and end up with an installed gdal that one can
> build a working qgis against.
>
> Will this work for May?  I don't know, and I think the big questions are
> when a believed-requirements-meeting alpha tarball can be produced, and
> how many residual issues there are.  With a alpha in 2 weeks, the odds
> are good.  With an alpha on April 1, I don't see how it can work.
>
> Greg

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Tue Jan 18 07:01:53 2022
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 18 Jan 2022 10:01:53 -0500
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com> (Even
 Rouault's message of "Tue, 18 Jan 2022 15:27:49 +0100")
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
Message-ID: <rmifsplozoe.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

> Greg,
>
> I will not respond point by point, but the message here is: "CMake
> support is available and believed to be in good shape into master
> based on our manual tests and initial CI configuration exercising it,
> it will replace autotools+nmake soon, be ready for it and help
> polishing it". 

OK, that's great to hear.  As someone who is here mainly as a packager,
I don't subscribe to github, and I haven't seen anything on gdal-dev@
saying that cmake support is ready for widespread testing (but now I
have!).

> There will perhaps be areas where it will not do
> everything that existing build systems made, but existing build
> systems have also their flows that are not easily fixable. So be
> it. Having one single build system at the end of the process, and used
> in an idiomatic way (our autoconf system without automake is far from
> being idiomatic), is the main objective of this whole effort from my
> side.

Sure, I get it that there will be a few rough edges.

> CMake might not be completely ready for 3.5.0 for all imaginable
> platforms & configurations (we don't promise to support all platforms
> anyway. I don't believe we have a formal list of supported platforms
> by the way. I'd say what is tested on our CI is the practical
> definition of what is supported), and we won't defer indefinitely
> 3.5.0 if it doesn't work on some confs. That's why autoconf&nmake will
> only be removed in 3.6.0, and we have 3.5.x point releases to help
> address issues.

Sorry, I misunderstood that the autoconf removal would not be for this
release.  As long as I can use the existing autoconf support for 3.5.0
if I have to, things are much less tense.

And yes, I realize that "supported platforms" is a difficult concept.
But here we're talking about a big change that risks regresssions to
platforms people have already made work, so I see it more as "we should
really avoid causing regressions on platforms known to work".

As a random datpoint, I have updated gdal in pkgsrc to 3.4.1 (not yet
committed it), tested on NetBSD 9 amd64, and the tests have only a
handful of failures that perhaps could be test issues.  And qgis with
this build works ok as far as I can tell.

> The release process? is described in HOWTO-RELEASE and it points to
> the mkgdaldist.sh script
>
> You can generate a gdal-master.tar.gz with:
>
> ./mkgdaldist.sh master -branch master
>
> No idea if the script works properly on non-Linux systems. You'll need
> some prerequisites for the script to run: Sphinx (pip install -r 
> doc/requirements.txt) to generate man pages, swig

I'll try that, but I think you'll get a lot more testing from packagers
if you publish an alpha tarball.

> Or just clone the git repo and rm -rf autotest .git .github, and that
> will be very close to the final tarball, at least for the purpose of
> doing a CMake build
>
> and try packaging this.

I'll try that if the above doesn't work.

And actually I can try a cmake build from the repo, which is probably a
good first step.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/a76c344d/attachment-0001.sig>

From even.rouault at spatialys.com  Tue Jan 18 07:07:31 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jan 2022 16:07:31 +0100
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <PAXPR02MB7326F8DFC631B031B3837ABAF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
 <PAXPR02MB7326F8DFC631B031B3837ABAF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
Message-ID: <db42c9db-496d-0c4a-e74c-75c63a458a0d@spatialys.com>

Mathias,
>
> Hi Even, hi everyone,
>
> As we (SAP) are probably one of the triggers for formalizing this 
> policy, let me take a first stab from the perspective of a new 
> contributor trying to make a substantial contribution:
>
(My personal position is that a first contribution that is a substantial 
one is probably not the best way to engage and socialize with a project. 
End of bracket)
>
>
>   * Having such a policy greatly increases transparency on what has to
>     be done to make a driver contribution. The outlined criteria
>     reduces the need for lengthy discussions.
>
>   * I do specifically like the idea of having a list of responsible
>     contacts. It makes it easier to track personas ? even if people
>     change. Still, the list could be outdated at some point. Maybe a
>     regular check-in (via email, virtual meeting, etc.) would be
>     beneficial.
>
It is the responsibility of a maintainer listed the contacts that can no 
longer occupy this position to update the list: preferably with a 
replacement maintainer, or if not with an empty name.
>
>  *
>
>
>   * To me, the term ?significant code addition? should be defined more
>     precisely. Not only in terms of quantity, but also complexity. New
>     drivers typically have a significant footprint in terms of code
>     quantity, but they are isolated. Whereas there may be other
>     contributions with less code, but spanning several software
>     components.
>
If you know how to define that more precisely, please propose. But this 
RFC is more about giving a general message, and as noted at the end the 
PSC is the ultimate adjudicator.
>
>   * At least for corporate contributors, the bullet point of
>     participating in the day-to-day activities is too vague to be
>     seriously accomplishable. While I do well understand, what the
>     goal of the statement is, I still think, the responsibilities have
>     to be defined (and quantified) more clearly as the current
>     description may be interpreted as a bottomless pit for development
>     resources.
>
I'm not sure how we can quantify, and I don't like the artificial 
division about "corporate contributors" vs "non-corporate contributors". 
Are non-corporate contributors expected to spend their nights & weekends 
doing all the boring & thankless tasks that corporate contributors don't 
"quantify" as being in their area of responsibility ? The message here 
is that the project can't work if people wear blinders and only care 
about the part that they contributed to without considering & investing 
in the project as a whole. Maintaining a project of this size is close 
to be a bottomless pit.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/d5b1e645/attachment.html>

From even.rouault at spatialys.com  Tue Jan 18 07:18:15 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Jan 2022 16:18:15 +0100
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <rmi5yqhqj7u.fsf@s1.lexort.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
 <rmi5yqhqj7u.fsf@s1.lexort.com>
Message-ID: <3c1bd1d0-4297-9eb4-215d-56a043f76306@spatialys.com>


> Another comment is about "complicated registration process".  I
> sympathize but I don't really understand that.   So it might be good to
> say what's acceptable, which could be one of:
>
>    The SDK must be downloadable by a URL with no user interaction
>
>    It's ok to have a form which requires a name and an email address, and
>    which does not opt the user in to spamming, to download.
>
>    It's ok to have a form which requires a name and an email address (and
>    opting in to spamming is ok) to download.
>   
>    Something else
I'll keep the vague formulation.
>
>
>
> I also think it probably went without saying that drivers that depend on
> proprietary SDKs will be default off, even if the build system finds the
> SDK, so that people who build GDAL will not accidentally create
> proprietary software.

Sorry , but no. If people have put proprietary SDKs in default findable 
locations (which generally requires efforts since they generally have 
non standard layouts), they will be used by default, at least in the new 
CMake build. That makes things much more consistent. People can still 
disable them (see 
https://gdal.org/build_hints.html#cmake-package-dependent-options and 
https://gdal.org/build_hints.html#selection-of-drivers). People who 
build GDAL should look at the licensing of all dependencies. It might be 
well possible to create a GDAL build with only free components with 
incompatible licenses, who knows. Or maybe people want a build that is 
globally permissive licensed, and thus they must be careful of not 
including copyleft components. There was a RFC attempt at addressing 
this, but this was abandoned as being a too complex issue.

Anyway people who want to create a build that is going to be used by 
other peoples should do that in a dedicated controlled environment, not 
just the random state of their desktop day-to-day env.

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mathias.kemeter at sap.com  Tue Jan 18 07:28:00 2022
From: mathias.kemeter at sap.com (Kemeter, Mathias)
Date: Tue, 18 Jan 2022 15:28:00 +0000
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <db42c9db-496d-0c4a-e74c-75c63a458a0d@spatialys.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
 <PAXPR02MB7326F8DFC631B031B3837ABAF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
 <db42c9db-496d-0c4a-e74c-75c63a458a0d@spatialys.com>
Message-ID: <PAXPR02MB7326E4AEDF1D71227C2492FEF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>

Hi Even,

thanks for the feedback.

Let me briefly elaborate on the distinction between corporate and non-corporate contributors (?which I did not intend in the first place):

  *   As an individual, I can very well live with the general message and ?sign? the policy based on trust. As written before, I do understand this message and fully agree to it.
  *   However, as an employee in a corporate environment, I will have to justify and quantify investments. No one likes that ? but that?s just how it is.
  *   Accepting a policy means signing a contract. And if formulations leave room for interpretation, it gets harder to sign (or fulfill) this contract. As an individual I wouldn?t care too much. However, in a company with legal departments these thing are handled more strict.

So the intent is not to draw a division between corporate and non-corporate (it may be the same individual), but the perspectives differ for sure depending on what hat you wear.

I like this proposal a lot more as it makes the intention clearer and leaves less room for interpretation:
https://github.com/OSGeo/gdal/pull/5128#discussion_r786826988

Regards,
Mathias

From: Even Rouault <even.rouault at spatialys.com>
Date: Tuesday, 18. January 2022 at 16:07
To: Kemeter, Mathias <mathias.kemeter at sap.com>, gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Call for discussion on RFC 85: Policy regarding substantial code additions
Mathias,
Hi Even, hi everyone,

As we (SAP) are probably one of the triggers for formalizing this policy, let me take a first stab from the perspective of a new contributor trying to make a substantial contribution:
(My personal position is that a first contribution that is a substantial one is probably not the best way to engage and socialize with a project. End of bracket)




  1.  Having such a policy greatly increases transparency on what has to be done to make a driver contribution. The outlined criteria reduces the need for lengthy discussions.


  2.  I do specifically like the idea of having a list of responsible contacts. It makes it easier to track personas ? even if people change. Still, the list could be outdated at some point. Maybe a regular check-in (via email, virtual meeting, etc.) would be beneficial.
It is the responsibility of a maintainer listed the contacts that can no longer occupy this position to update the list: preferably with a replacement maintainer, or if not with an empty name.


  1.

  2.  To me, the term ?significant code addition? should be defined more precisely. Not only in terms of quantity, but also complexity. New drivers typically have a significant footprint in terms of code quantity, but they are isolated. Whereas there may be other contributions with less code, but spanning several software components.
If you know how to define that more precisely, please propose. But this RFC is more about giving a general message, and as noted at the end the PSC is the ultimate adjudicator.



  1.  At least for corporate contributors, the bullet point of participating in the day-to-day activities is too vague to be seriously accomplishable. While I do well understand, what the goal of the statement is, I still think, the responsibilities have to be defined (and quantified) more clearly as the current description may be interpreted as a bottomless pit for development resources.

I'm not sure how we can quantify, and I don't like the artificial division about "corporate contributors" vs "non-corporate contributors". Are non-corporate contributors expected to spend their nights & weekends doing all the boring & thankless tasks that corporate contributors don't "quantify" as being in their area of responsibility ? The message here is that the project can't work if people wear blinders and only care about the part that they contributed to without considering & investing in the project as a whole. Maintaining a project of this size is close to be a bottomless pit.

Even

--

http://www.spatialys.com<https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=04%7C01%7Cmathias.kemeter%40sap.com%7C2f9a04eb7c5d43bb74f208d9da944181%7C42f7676cf455423c82f6dc2d99791af7%7C0%7C0%7C637781152557892198%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=SHAe4Zgt870J32QqKRooJfkvi5a0w4YbvfD5bcEtHBk%3D&reserved=0>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/e5632b43/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Tue Jan 18 07:35:04 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Tue, 18 Jan 2022 15:35:04 +0000
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
Message-ID: <2375cbff196d40bab9481694fa9c167f@yukon.ca>

Thank you Frank and Even.

As is so often the case on this list, I now have answers, and an education. I have been peripherally aware of the tiff tools from libtiff, but not enough so that they came to mind when seeking to puzzle out things. I?m now updated. ;-)

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/34266e80/attachment.html>

From Matt.Wilkie at yukon.ca  Tue Jan 18 08:34:22 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Tue, 18 Jan 2022 16:34:22 +0000
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <edb826f8fd744f13bebe91278214314c@yukon.ca>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
 <edb826f8fd744f13bebe91278214314c@yukon.ca>
Message-ID: <79df6bcea9214656ad1491d998c0b76c@yukon.ca>

A little off topic for this list but people here might know: I see Tiff Tools for Windows binaries[0] haven?t been updated since 2006. Conda has Windows libtiff packages which include the tiff tools executables.[1] Is the conda variant actually newer than 2006 or is it just current packaging?

[0]: http://www.libtiff.org/index.html
[1]: https://anaconda.org/conda-forge/libtiff/4.3.0/download/win-64/libtiff-4.3.0-h0c97f57_1.tar.bz2


-Matt

From: Matt.Wilkie
Sent: January 18, 2022 8:35 AM
To: gdal-dev at lists.osgeo.org
Subject: RE: [gdal-dev] Nodata is None, but still has blanks?

Thank you Frank and Even.

As is so often the case on this list, I now have answers, and an education. I have been peripherally aware of the tiff tools from libtiff, but not enough so that they came to mind when seeking to puzzle out things. I?m now updated. ;-)

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/c9841728/attachment.html>

From Matt.Wilkie at yukon.ca  Tue Jan 18 08:41:46 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Tue, 18 Jan 2022 16:41:46 +0000
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <79df6bcea9214656ad1491d998c0b76c@yukon.ca>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
 <edb826f8fd744f13bebe91278214314c@yukon.ca>
 <79df6bcea9214656ad1491d998c0b76c@yukon.ca>
Message-ID: <c81dd1694eb8480f8ee9fc70638a9b5b@yukon.ca>

Never mind! Paying attention to the version numbers answers the Q: Conda is built from libtiff 4.x while GnuWin32 libtiff is back on version 3.x.

I?ll see if I can find a contact at libtiff.org about adding a line about the library and tools being available via Conda as well as the other sources.

-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Matt.Wilkie at yukon.ca
Sent: January 18, 2022 9:34 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Nodata is None, but still has blanks?

A little off topic for this list but people here might know: I see Tiff Tools for Windows binaries[0] haven?t been updated since 2006. Conda has Windows libtiff packages which include the tiff tools executables.[1] Is the conda variant actually newer than 2006 or is it just current packaging?

[0]: http://www.libtiff.org/index.html
[1]: https://anaconda.org/conda-forge/libtiff/4.3.0/download/win-64/libtiff-4.3.0-h0c97f57_1.tar.bz2

-Matt

From: Matt.Wilkie
Sent: January 18, 2022 8:35 AM
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: RE: [gdal-dev] Nodata is None, but still has blanks?

Thank you Frank and Even.

As is so often the case on this list, I now have answers, and an education. I have been peripherally aware of the tiff tools from libtiff, but not enough so that they came to mind when seeking to puzzle out things. I?m now updated. ;-)

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/ce80da17/attachment-0001.html>

From howard at hobu.co  Tue Jan 18 08:46:05 2022
From: howard at hobu.co (Howard Butler)
Date: Tue, 18 Jan 2022 10:46:05 -0600
Subject: [gdal-dev] Call for discussion on RFC 85: Policy regarding
 substantial code additions
In-Reply-To: <PAXPR02MB7326E4AEDF1D71227C2492FEF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
References: <0ad0bfe0-6a4d-e326-91c5-ff47d8141033@spatialys.com>
 <PAXPR02MB7326F8DFC631B031B3837ABAF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
 <db42c9db-496d-0c4a-e74c-75c63a458a0d@spatialys.com>
 <PAXPR02MB7326E4AEDF1D71227C2492FEF7589@PAXPR02MB7326.eurprd02.prod.outlook.com>
Message-ID: <C99D8392-DBAC-457B-8B20-4E5378A70383@hobu.co>



> On Jan 18, 2022, at 9:28 AM, Kemeter, Mathias via gdal-dev <gdal-dev at lists.osgeo.org> wrote:
> 
> Hi Even,
>  
> thanks for the feedback.
>  
> Let me briefly elaborate on the distinction between corporate and non-corporate contributors (?which I did not intend in the first place):
> As an individual, I can very well live with the general message and ?sign? the policy based on trust. As written before, I do understand this message and fully agree to it. 
> However, as an employee in a corporate environment, I will have to justify and quantify investments. No one likes that ? but that?s just how it is.

As an open source community, we must also justify and quantify our time investments. A GDAL driver based on a binary SDK that is contributed by the company whose SDK it supports is a white elephant for the project. Fixing issues with it is often not simply a matter of putting in time and attention. GDAL's distribution mechanism provides a lot of value ? the binary SDK proprietor is using GDAL to give the benefits of GDAL to its userbase. This RFC is about giving the PSC some tools to react when that cost/benefit as measured by the project is out of balance. 

> Accepting a policy means signing a contract. And if formulations leave room for interpretation, it gets harder to sign (or fulfill) this contract. As an individual I wouldn?t care too much. However, in a company with legal departments these thing are handled more strict.

There's no crying in baseball and there's no contracts in open source. It is run by social mores, social capital, and expertise/time gifting. Showing up cold to drop +15k lines onto a project in one which you have no social capital is rightly met with skepticism. It's the easiest thing for that project to just say no. 

This RFC is to flip the default policy to 'yes', but to provide some guidelines when the contribution has gone stale to the point that it is imposing time/money/maintenance/attention/usability cost on the project.

Howard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220118/c3a0291c/attachment.html>

From jmckenna at gatewaygeomatics.com  Tue Jan 18 09:14:33 2022
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 18 Jan 2022 13:14:33 -0400
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <c81dd1694eb8480f8ee9fc70638a9b5b@yukon.ca>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
 <edb826f8fd744f13bebe91278214314c@yukon.ca>
 <79df6bcea9214656ad1491d998c0b76c@yukon.ca>
 <c81dd1694eb8480f8ee9fc70638a9b5b@yukon.ca>
Message-ID: <41f5cd14-246c-4ad0-5d7f-cb47e4f7c210@gatewaygeomatics.com>

Hi Matt,

Just for the record, the TIFF tools are also distributed to the MS4W 
users as well, on the web mapping side of things ha (I use them often, 
so when I find something useful I try to distribute them). 
https://ms4w.com   Cheers from the far east side.

-jeff



On 2022-01-18 12:41 p.m., Matt.Wilkie at yukon.ca wrote:
> Never mind! Paying attention to the version numbers answers the Q: Conda 
> is built from libtiff 4.x while GnuWin32 libtiff is back on version 3.x.
> 
> I?ll see if I can find a contact at libtiff.org about adding a line 
> about the library and tools being available via Conda as well as the 
> other sources.
> 
> -Matt//
> 
> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of 
> *Matt.Wilkie at yukon.ca
> *Sent:* January 18, 2022 9:34 AM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Nodata is None, but still has blanks?
> 
> A little off topic for this list but people here might know: I see Tiff 
> Tools for Windows binaries[0] haven?t been updated since 2006. Conda has 
> Windows libtiff packages which include the tiff tools executables.[1] Is 
> the conda variant actually newer than 2006 or is it just current packaging?
> 
> [0]: http://www.libtiff.org/index.html <http://www.libtiff.org/index.html>
> 
> [1]: 
> https://anaconda.org/conda-forge/libtiff/4.3.0/download/win-64/libtiff-4.3.0-h0c97f57_1.tar.bz2 
> <https://anaconda.org/conda-forge/libtiff/4.3.0/download/win-64/libtiff-4.3.0-h0c97f57_1.tar.bz2>
> 
> -Matt//
> 
> *From:*Matt.Wilkie
> *Sent:* January 18, 2022 8:35 AM
> *To:* gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> *Subject:* RE: [gdal-dev] Nodata is None, but still has blanks?
> 
> Thank you Frank and Even.
> 
> As is so often the case on this list, I now have answers, and an 
> education. I have been peripherally aware of the tiff tools from 
> libtiff, but not enough so that they came to mind when seeking to puzzle 
> out things. I?m now updated. ;-)
> 
> -Matt//
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, MapServer Consulting and Training
co-founder of FOSS4G
http://gatewaygeo.com/

From billybabis at gmail.com  Wed Jan 19 07:51:10 2022
From: billybabis at gmail.com (Billy Babis)
Date: Wed, 19 Jan 2022 08:51:10 -0700
Subject: [gdal-dev] Potential bug or misunderstanding. Please help
Message-ID: <CAPiO2JYVo-Zqh107MHYGR_qRtr1=Q0zd0f=3rjr_DR9Goj1q_w@mail.gmail.com>

Hi there.

Given 3 input geotiffs (each with 2 bands), I want to create 1 geotiff with
3 bands (the 2nd band from each aforementioned geotiff). This should be
quite simple using gdal.BuildVRT and gdal.translate. But, gdal.BuildVRT
will not allow me to select the 2nd band from each input image. The
following code produces the following warning:

*Code:*
gdal.BuildVRT(output_vrt_fname, lst_of_input_geotiff_files, separate=True,
bandList=[2])

*Warning:*
 "fname.tif has 2 bands. Only the first one will be taken into account for
the -separate case"

Of course, I do not want to only use the first band, I want to use the 2nd
band to create the VRT. Please let me know what I'm doing wrong and how I
can fix it.

Best,
Billy B

-- 
Billy Babis
PhD Candidate: Environmental Economics & Policy (ABD)
Computer Science B.S.
1-(908)-403-2006
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220119/56c3b04c/attachment.html>

From even.rouault at spatialys.com  Wed Jan 19 08:00:06 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Jan 2022 17:00:06 +0100
Subject: [gdal-dev] Potential bug or misunderstanding. Please help
In-Reply-To: <CAPiO2JYVo-Zqh107MHYGR_qRtr1=Q0zd0f=3rjr_DR9Goj1q_w@mail.gmail.com>
References: <CAPiO2JYVo-Zqh107MHYGR_qRtr1=Q0zd0f=3rjr_DR9Goj1q_w@mail.gmail.com>
Message-ID: <c89ef7d0-34da-8f8b-57af-5e2ffb2777ae@spatialys.com>

Billy,

bandList is currently ignored in the separate=True case. This would be a 
reasonable enhancement request that you could file on 
https://github.com/OSGeo/gdal/issues/new

One of the workaround for now is to postedit the generate VRT file and 
substitute the <SourceBand>1</SourceBand> element with 
<SourceBand>2</SourceBand>

You could also use use gdal.Translate() to produce a VRT with the second 
band of each source file, and run gdal.BuildVRT() on those files, but 
that would produce temporary files. If you don't need to serialize the 
output_vrt_fname, but use the returned dataset object with other APIs in 
the same process, you could avoid actual file creation by using an empty 
name for those intermediate VRT files, get the returned dataset object, 
and pass an array with those dataset objects instead of 
lst_of_input_geotiff_files.

Even

Le 19/01/2022 ? 16:51, Billy Babis a ?crit?:

> Hi there.
>
> Given 3 input geotiffs (each with 2 bands), I want to create 1 geotiff 
> with 3 bands (the 2nd band from each aforementioned geotiff). This 
> should?be quite simple using gdal.BuildVRT and gdal.translate. But, 
> gdal.BuildVRT will not allow me to select the 2nd band from each input 
> image. The following code produces the following warning:
>
> *Code:*
> gdal.BuildVRT(output_vrt_fname, lst_of_input_geotiff_files, 
> separate=True, bandList=[2])
>
> *Warning:*
> ?"fname.tif has 2 bands. Only the first one will be taken into account 
> for the -separate case"
>
> Of course, I do not want to only use the first band,?I want to use the 
> 2nd band to create the VRT. Please let me know what I'm doing wrong 
> and how I can fix it.
>
> Best,
> Billy B
>
> -- 
> Billy Babis
> PhD Candidate: Environmental Economics & Policy (ABD)
> Computer Science B.S.
> 1-(908)-403-2006
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220119/ec51a54e/attachment.html>

From Matt.Wilkie at yukon.ca  Wed Jan 19 08:32:27 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 19 Jan 2022 16:32:27 +0000
Subject: [gdal-dev] Potential bug or misunderstanding. Please help
In-Reply-To: <c89ef7d0-34da-8f8b-57af-5e2ffb2777ae@spatialys.com>
References: <CAPiO2JYVo-Zqh107MHYGR_qRtr1=Q0zd0f=3rjr_DR9Goj1q_w@mail.gmail.com>
 <c89ef7d0-34da-8f8b-57af-5e2ffb2777ae@spatialys.com>
Message-ID: <a5553628c51e4717a20bbfcc7de3fbc2@yukon.ca>

Would an in-memory /vsi also work as an intermediate?

Expressed as windows CMD batch file I have handy:

gdalwarp -of vrt ?t_srs epsg:3578 %1 /vsistdout | gdal_translate /vsistdin/ %2


-Matt

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: January 19, 2022 9:00 AM
To: Billy Babis <billybabis at gmail.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Potential bug or misunderstanding. Please help


Billy,

bandList is currently ignored in the separate=True case. This would be a reasonable enhancement request that you could file on https://github.com/OSGeo/gdal/issues/new<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fgithub.com%2fOSGeo%2fgdal%2fissues%2fnew&umid=8E1E185C-D5F1-7B05-A573-C40D9183224D&auth=c132af8ee7c9d1278d61a701569070a095ce962e-963983d70993dd628f3a829c6da1de9b915a8a43>

One of the workaround for now is to postedit the generate VRT file and substitute the <SourceBand>1</SourceBand> element with <SourceBand>2</SourceBand>

You could also use use gdal.Translate() to produce a VRT with the second band of each source file, and run gdal.BuildVRT() on those files, but that would produce temporary files. If you don't need to serialize the output_vrt_fname, but use the returned dataset object with other APIs in the same process, you could avoid actual file creation by using an empty name for those intermediate VRT files, get the returned dataset object, and pass an array with those dataset objects instead of lst_of_input_geotiff_files.

Even

Le 19/01/2022 ? 16:51, Billy Babis a ?crit :
Hi there.

Given 3 input geotiffs (each with 2 bands), I want to create 1 geotiff with 3 bands (the 2nd band from each aforementioned geotiff). This should be quite simple using gdal.BuildVRT and gdal.translate. But, gdal.BuildVRT will not allow me to select the 2nd band from each input image. The following code produces the following warning:

Code:
gdal.BuildVRT(output_vrt_fname, lst_of_input_geotiff_files, separate=True, bandList=[2])

Warning:
 "fname.tif has 2 bands. Only the first one will be taken into account for the -separate case"

Of course, I do not want to only use the first band, I want to use the 2nd band to create the VRT. Please let me know what I'm doing wrong and how I can fix it.

Best,
Billy B

--
Billy Babis
PhD Candidate: Environmental Economics & Policy (ABD)
Computer Science B.S.
1-(908)-403-2006




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=http%3a%2f%2fwww.spatialys.com&umid=8E1E185C-D5F1-7B05-A573-C40D9183224D&auth=c132af8ee7c9d1278d61a701569070a095ce962e-922e18d95be76772930fc905d0f7d174629efcdc>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220119/c36a6157/attachment-0001.html>

From Matt.Wilkie at yukon.ca  Wed Jan 19 08:41:14 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 19 Jan 2022 16:41:14 +0000
Subject: [gdal-dev] Potential bug or misunderstanding. Please help
In-Reply-To: <a5553628c51e4717a20bbfcc7de3fbc2@yukon.ca>
References: <CAPiO2JYVo-Zqh107MHYGR_qRtr1=Q0zd0f=3rjr_DR9Goj1q_w@mail.gmail.com>
 <c89ef7d0-34da-8f8b-57af-5e2ffb2777ae@spatialys.com>
 <a5553628c51e4717a20bbfcc7de3fbc2@yukon.ca>
Message-ID: <83aa30a77ffe45598d63c28e4c318a8d@yukon.ca>

Would an in-memory /vsi also work as an intermediate?  Expressed as windows CMD batch file I have handy:
gdalwarp -of vrt ?t_srs epsg:3578 %1 /vsistdout | gdal_translate /vsistdin/ %2


I should add that I use this like:

                project-to-local.bat input.tif  outfile.tif

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220119/f74e68ed/attachment.html>

From Matt.Wilkie at yukon.ca  Wed Jan 19 15:22:26 2022
From: Matt.Wilkie at yukon.ca (Matt.Wilkie at yukon.ca)
Date: Wed, 19 Jan 2022 23:22:26 +0000
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
Message-ID: <368597afcf6f4a8a8b8c7aff2f693e65@yukon.ca>

Tiffsplit works smoothly and easily. I appreciate adding it to my long term tool kit. For my current project it?s great as an exploration and learning but as it turns out I found a more efficient route for my current project.

The out.tif that split creates for the mask band is a 3 band RGB even though it looks like only the first band has any info in it. That?s not really a problem except that cleaning it up later adds a step (in addition to re-applying the georeferencing). However I discovered that I actually can use gdal_translate out of the box by using environment settings:

set GDAL_TIFF_INTERNAL_MASK=NO
gdal_translate sample-internal-mask.tif out.tif

?will move the internal mask to an external file,  out.tif.msk, that can then be manipulated (a la Gimp recipe posted earlier) or discarded as needed.

It seems that using an environment setting is required. Attempts to use -co and --config  ?GDAL_TIFF_INTERNAL_MASK=NO? resulted in a warning or error respectively:

Warning 6: driver GTiff does not support creation option GDAL_TIFF_INTERNAL_MASK

FAILURE: No target dataset specified.

cheers,

-Matt

From: Even Rouault <even.rouault at spatialys.com>
Sent: January 18, 2022 4:21 AM
To: Frank Warmerdam <warmerdam at pobox.com>; Matt.Wilkie <Matt.Wilkie at yukon.ca>
Cc: gdal dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Nodata is None, but still has blanks?

>  I find that if I do:
tiffcp sample-no-mask.tif,0 x0.tif

I get an "x0.tif" with just the jpeg image, and not the mask.  That may be helpful for you (without uncompressing the jpeg image).

tiffcp doesn't use the raw interface of libtiff, hence JPEG decompression&recompression will occur.

tiffsplit avoids that as it does use the raw interface:

tiffsplit sample-no-mask.tif out

will generate a outaaa.tif file with the original JPEG content (the geotif tags will be lost however, and will have to be reinjected https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/samples/gdalcopyproj.py<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fgithub.com%2fOSGeo%2fgdal%2fblob%2fmaster%2fswig%2fpython%2fgdal%2dutils%2fosgeo%5futils%2fsamples%2fgdalcopyproj.py&umid=B38C0EF4-D5D9-7605-8E85-D961C3CFDB4A&auth=c132af8ee7c9d1278d61a701569070a095ce962e-99d2fc4ea472c846533a93775fde3b12fb6fdbbe> for example)

Even

--

http://www.spatialys.com<https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=http%3a%2f%2fwww.spatialys.com&umid=B38C0EF4-D5D9-7605-8E85-D961C3CFDB4A&auth=c132af8ee7c9d1278d61a701569070a095ce962e-da8823f42eeaed576a737271c27f693b63c86c21>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220119/21cc326a/attachment.html>

From even.rouault at spatialys.com  Wed Jan 19 16:04:52 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Jan 2022 01:04:52 +0100
Subject: [gdal-dev] Nodata is None, but still has blanks?
In-Reply-To: <368597afcf6f4a8a8b8c7aff2f693e65@yukon.ca>
References: <1899c908fc904b39b27740399795de9b@yukon.ca>
 <CA+YzLBdXe1ATs-UvmPNJx_qPjxFaiBGNJF_v55MMaJb8jhgwcg@mail.gmail.com>
 <226ae20c-a02f-7934-340d-5f89b17cb02a@spatialys.com>
 <368597afcf6f4a8a8b8c7aff2f693e65@yukon.ca>
Message-ID: <87d68cda-5fcc-bdf1-e4aa-4e49515cd020@spatialys.com>

> It seems that using an environment setting is required. Attempts to 
> use -co and --config ??GDAL_TIFF_INTERNAL_MASK=NO? resulted in a 
> warning or error respectively:
>
--config GDAL_TIFF_INTERNAL_MASK NO
>
> /Warning 6: driver GTiff does not support creation option 
> GDAL_TIFF_INTERNAL_MASK/
>
> //
>
> /FAILURE: No target dataset specified./
>
> cheers,
>
> -Matt//
>
> *From:*Even Rouault <even.rouault at spatialys.com>
> *Sent:* January 18, 2022 4:21 AM
> *To:* Frank Warmerdam <warmerdam at pobox.com>; Matt.Wilkie 
> <Matt.Wilkie at yukon.ca>
> *Cc:* gdal dev <gdal-dev at lists.osgeo.org>
> *Subject:* Re: [gdal-dev] Nodata is None, but still has blanks?
>
> >? I find that if I do:
>
>     tiffcp?sample-no-mask.tif,0 x0.tif
>
>     I get an "x0.tif" with just the jpeg image, and not the mask.?
>     That may be helpful for you (without uncompressing the jpeg image).
>
> tiffcp doesn't use the raw interface of libtiff, hence JPEG 
> decompression&recompression will occur.
>
> tiffsplit avoids that as it does use the raw interface:
>
> tiffsplit sample-no-mask.tif out
>
> will generate a outaaa.tif file with the original JPEG content (the 
> geotif tags will be lost however, and will have to be reinjected 
> https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/samples/gdalcopyproj.py 
> <https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fgithub.com%2fOSGeo%2fgdal%2fblob%2fmaster%2fswig%2fpython%2fgdal%2dutils%2fosgeo%5futils%2fsamples%2fgdalcopyproj.py&umid=B38C0EF4-D5D9-7605-8E85-D961C3CFDB4A&auth=c132af8ee7c9d1278d61a701569070a095ce962e-99d2fc4ea472c846533a93775fde3b12fb6fdbbe> 
> for example)
>
> Even
>
> -- 
>
> http://www.spatialys.com  <https://imsva91-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=http%3a%2f%2fwww.spatialys.com&umid=B38C0EF4-D5D9-7605-8E85-D961C3CFDB4A&auth=c132af8ee7c9d1278d61a701569070a095ce962e-da8823f42eeaed576a737271c27f693b63c86c21>
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/436baa5f/attachment-0001.html>

From Jon.Morris at jbarisk.com  Thu Jan 20 01:00:27 2022
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 20 Jan 2022 09:00:27 +0000
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
Message-ID: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

I'm writing applications using the GDAL Python bindings and when I profile for performance, GetFeatureCount frequently comes out near the top. I'm often using it to check whether a spatial or attribute filter has returned any features and don't need the full count. When the layer contains millions of features, there would be a big performance improvement if we could exit the count early.

Is there a better way of doing this? I've tried using GetNextFeature instead, but there must be quite a lot of overhead in that function as it is much slower. All I need to know is if the layer has has 0, 1 or >1 features, I don't need the actual count. Can anyone suggest the fastest way of doing this in Python? I'm using GDAL 3.3.1 at the moment but could upgrade if there is new functionality that would help.

Thanks,

Jon

Jon Morris
Software Developer



e: Jon.Morris at jbarisk.com
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image918956.png
Type: image/png
Size: 9886 bytes
Desc: image918956.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image215268.png
Type: image/png
Size: 651 bytes
Desc: image215268.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image706640.png
Type: image/png
Size: 715 bytes
Desc: image706640.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image011385.png
Type: image/png
Size: 966 bytes
Desc: image011385.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image866509.png
Type: image/png
Size: 784 bytes
Desc: image866509.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/473d64e1/attachment-0009.png>

From peter.loewe at gmx.de  Thu Jan 20 01:16:01 2022
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Thu, 20 Jan 2022 10:16:01 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
Message-ID: <trinity-0675ef2b-457d-4778-9280-a4666a7abadf-1642670161257@3c-app-gmx-bs17>

Hello gdal-dev-list,

regarding the current discussion on how to register DOI for GDAL, I've contacted the helpdesks of Zenodo and DataCite. DataCite is the organisation providing the global DOI-infrastructure. Zenodo is an open access repository where a growing number of OSGeo projects already have registered DOI for their codebases.

The question is whether once a DOI for GDAL has been registered manually/retrospectively for the current release (GDAL 3.4.1) it will be feasible to switch to automated DOI versioning for all future GDAL releases.

The DataCite helpdesk confirms, this approach from their infrastructure perspective: "From the DataCite side I don't see anything that would mean the manual workflow could not change to an automated one, but this is something that Zenodo would need to confirm."

The Zenodo helpdesk confirmed this approach last night: "We can actually connect this record to a "virtual" release on our side as if it was actually part of the Github repo. Could you give us more details, for example, the records in question and the GitHub repos?".
-> I have told them that this applies to GDAL (among other projects). No response yet.
Maybe someone of the project community is interested and able to contact the Zenodo help desk directly on this (info at zenodo.org) ?

The deadline to include a DOI for the GDAL project to the Open Source Chapter of the Springer Handbook on Geographic Information is today end of business Pacific Time.

By now, ten OSGeo projects will have their DOI referenced in the Chapter (more to come in the next hours). It would be awesome if GDAL could be included, too.

Best,
Peter

<peter.loewe at gmx.de>


From me at komzpa.net  Thu Jan 20 01:55:30 2022
From: me at komzpa.net (=?UTF-8?Q?Darafei_=22Kom=D1=8Fpa=22_Praliaskouski?=)
Date: Thu, 20 Jan 2022 12:55:30 +0300
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
 <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
Message-ID: <CAC8Q8tKhbuhU8uWc7VvHQpudOByTeghdnSeCkqof+XEaV7xtpQ@mail.gmail.com>

Hello,


> *Cite as *
>
>> Rouault, Even, Warmerdam, Frank, Schwehr, Kurt, Kiselev, Andrey, Butler,
>> Howard, ?oskot, Mateusz, Szekeres, Tamas, Tourigny, Etienne, Landa, Martin,
>> Miara, Idan, Elliston, Ben, Kumar, Chaitanya, Plesea, Lucian, Morissette,
>> Daniel, Jolma, Ari, & Dawson, Nyall. (2022). GDAL (test_zenodo2).
>> https://doi.org/10.5072/zenodo.994062
>
>
>
>
Looking at this list, I don't know whether we effectively double the amount
of contributors, want to get introduced to Howard ?oskot, or should do
something about people separator and/or name-surname inversion?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/87cf885c/attachment.html>

From robert.coup at koordinates.com  Thu Jan 20 02:05:54 2022
From: robert.coup at koordinates.com (Robert Coup)
Date: Thu, 20 Jan 2022 10:05:54 +0000
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CAC8Q8tKhbuhU8uWc7VvHQpudOByTeghdnSeCkqof+XEaV7xtpQ@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
 <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
 <CAC8Q8tKhbuhU8uWc7VvHQpudOByTeghdnSeCkqof+XEaV7xtpQ@mail.gmail.com>
Message-ID: <CAFLLRpKfdF=V_guY6_7PnV2KMG_WTTC3DHrZomodpu8rEd1Y2w@mail.gmail.com>

Hi Darafei,

On Thu, 20 Jan 2022 at 09:55, Darafei "Kom?pa" Praliaskouski <me at komzpa.net>
wrote:

>
> Looking at this list, I don't know whether we effectively double the
> amount of contributors, want to get introduced to Howard ?oskot, or should
> do something about people separator and/or name-surname inversion?
>

Yes, I think the Zenodo website is mixing punctuation up - personally I'd
expect "H. Butler, M. ?oskot," or "Butler, Howard; ?oskot, Mateusz;" but
I'm not an academic.

But the underlying data in the records includes contributors given name &
surname separately, so the data is all *there*, it's just about how it's
presented on Zenodo. In fact, at the top of the page it uses semicolons
between people. And the "Cite as" section has about 1000 styles to choose
from, so at best it's a Zenodo bug, not something related to our side.

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/edca7c16/attachment.html>

From roman.schiffer at gmail.com  Thu Jan 20 02:37:51 2022
From: roman.schiffer at gmail.com (Roman Breitfuss-Schiffer)
Date: Thu, 20 Jan 2022 11:37:51 +0100
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <46f3d869-ee6a-8e3b-2064-325506831f87@gmail.com>

Hi Jon!

I don't know if there's an alternative to GetFeatureCount. At least I 
couldn't find one in the API documentation. Maybe there's a workaround 
I'm not aware of...

What you could do is wrap the call of GetFeatrueCount in a function 
which is killed after some time (2 approaches are discussed here: 
https://stackoverflow.com/questions/40915527/kill-function-after-a-given-amount-of-time). 
With that approach the question remains of getting the value of 
GetFeatureCount when the function gets killed. One could assume that 
there are more features than 1 if the function takes too long. This 
assumption might be a bit risky though...

Best regards
Roman

Am 20.01.2022 um 10:00 schrieb Jon Morris:
>
> I'm writing applications using the GDAL Python bindings and when I 
> profile for performance, GetFeatureCount frequently comes out near the 
> top. I'm often using it to check whether a spatial or attribute filter 
> has returned any features and don't need the full count. When the 
> layer contains millions of features, there would be a big performance 
> improvement if we could exit the count early.
>
> Is there a better way of doing this? I've tried using GetNextFeature 
> instead, but there must be quite a lot of overhead in that function as 
> it is much slower. All I need to know is if the layer has has 0, 1 or 
> >1 features, I don't need the actual count. Can anyone suggest the 
> fastest way of doing this in Python? I'm using GDAL 3.3.1 at the 
> moment but could upgrade if there is new functionality that would help.
>
> Thanks,
>
> Jon
>
> *Jon Morris*
>
> *Software Developer*
>
> e: ? 	*Jon.Morris at jbarisk.com* <mailto:Jon.Morris at jbarisk.com>
> t: 	*+44?(0)1756?799919* <tel:+44%20(0)1756%20799919>
>
> 	
>
> *www.jbarisk.com* <http://www.jbarisk.com/>
>
> Facebook <https://www.facebook.com/TheFloodPeople>
>
> 	
> LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
>
> 	
> Twitter <https://twitter.com/JBARisk>
>
> 	
> YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
> 	
>
> All JBA Risk Management's email messages contain confidential 
> information and are intended only for the individual(s) named. If you 
> are not the named addressee you should not disseminate, distribute or 
> copy this e-mail.
> Please notify the sender immediately by email if you have received 
> this email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number 
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North 
> Yorkshire, BD23 3FD, England.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image918956.png
Type: image/png
Size: 9886 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image215268.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image706640.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image011385.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image866509.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/fb6d4364/attachment-0009.png>

From ijturton at gmail.com  Thu Jan 20 02:55:00 2022
From: ijturton at gmail.com (Ian Turton)
Date: Thu, 20 Jan 2022 10:55:00 +0000
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CA+=cGJ=diz7chgeQ23xZNN39e9agCCno1ksRz4=uMdTAv73OxQ@mail.gmail.com>

I'm not sure if it's a shortcut but couldn't you do a getFeatures loop with
a counter and break after 2 times round the loop, then your counter would
be 0,1 or 2 for your 3 cases.

Ian



On Thu, 20 Jan 2022 at 09:00, Jon Morris <Jon.Morris at jbarisk.com> wrote:

> I'm writing applications using the GDAL Python bindings and when I profile
> for performance, GetFeatureCount frequently comes out near the top. I'm
> often using it to check whether a spatial or attribute filter has returned
> any features and don't need the full count. When the layer contains
> millions of features, there would be a big performance improvement if we
> could exit the count early.
>
>
>
> Is there a better way of doing this? I've tried using GetNextFeature
> instead, but there must be quite a lot of overhead in that function as it
> is much slower. All I need to know is if the layer has has 0, 1 or >1
> features, I don't need the actual count. Can anyone suggest the fastest way
> of doing this in Python? I'm using GDAL 3.3.1 at the moment but could
> upgrade if there is new functionality that would help.
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *Jon Morris*
>
> *Software Developer*
>
>
>
>
> e: ? *Jon.Morris at jbarisk.com* <Jon.Morris at jbarisk.com>
> t:  *+44 (0)1756 799919* <+44%20(0)1756%20799919>
> *www.jbarisk.com* <http://www.jbarisk.com/>
> [image: Facebook] <https://www.facebook.com/TheFloodPeople>
> [image: LinkedIn] <https://www.linkedin.com/company/jba-risk-management/>
> [image: Twitter] <https://twitter.com/JBARisk>
> [image: YouTube]
> <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, England.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Ian Turton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image918956.png
Type: image/png
Size: 9886 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image215268.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image706640.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image011385.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image866509.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/7179a156/attachment-0009.png>

From peter.loewe at gmx.de  Thu Jan 20 04:52:14 2022
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Thu, 20 Jan 2022 13:52:14 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <CAFLLRpKfdF=V_guY6_7PnV2KMG_WTTC3DHrZomodpu8rEd1Y2w@mail.gmail.com>
References: <trinity-05322fb7-2903-4cc4-a777-2683522f4626-1642004620636@3c-app-gmx-bap27>
 <60b1bd3a-d201-3822-c131-5b5494933a37@spatialys.com>
 <a7c858a8-cba4-82a2-80fb-3711f4129016@spatialys.com>
 <CALFmHhtte1-T19b0zLbjNoNz+bfzsuNR0AkLjqowvESVN=pM_Q@mail.gmail.com>
 <CAFLLRpKe-Teo9wVpZoF4P02gyz1K-5n5XbKbddi+56NsEPTfxA@mail.gmail.com>
 <CAC8Q8tKhbuhU8uWc7VvHQpudOByTeghdnSeCkqof+XEaV7xtpQ@mail.gmail.com>
 <CAFLLRpKfdF=V_guY6_7PnV2KMG_WTTC3DHrZomodpu8rEd1Y2w@mail.gmail.com>
Message-ID: <trinity-251cf158-c74c-4556-be73-3ae0e8cedf48-1642683134643@3c-app-gmx-bs28>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/a374c02c/attachment.html>

From peter.loewe at gmx.de  Thu Jan 20 06:37:06 2022
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Thu, 20 Jan 2022 15:37:06 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <trinity-0675ef2b-457d-4778-9280-a4666a7abadf-1642670161257@3c-app-gmx-bs17>
References: <trinity-0675ef2b-457d-4778-9280-a4666a7abadf-1642670161257@3c-app-gmx-bs17>
Message-ID: <trinity-792def8c-8df6-42d2-9cb8-9b83cc30df75-1642689426503@3c-app-gmx-bs28>

Hi,

FYI here's the confirmation by Zenodo about the combined use of manual and automated software versioning:

"It is possible to link manual releases to the GitHub integration automated workflow.
You can go ahead and publish the two manual releases and share them here.
We will then link them to the equivalent GitHub repositories so that when you activate the integration new versions will continue under the same Concept DOIs of the manual releases"

-> the two repos being referred to are PROJ and GDAL.

I will not be abl? to act on this as I do not have admin access to neither the GDAL nor the PROJ repo.

Best,
Peter

<peter.loewe at gmx.de>


> Gesendet: Donnerstag, 20. Januar 2022 um 10:16 Uhr
> Von: "Peter L?we" <peter.loewe at gmx.de>
> An: gdal-dev at lists.osgeo.org
> Betreff: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of Geoinformatics
>
> Hello gdal-dev-list,
> 
> regarding the current discussion on how to register DOI for GDAL, I've contacted the helpdesks of Zenodo and DataCite. DataCite is the organisation providing the global DOI-infrastructure. Zenodo is an open access repository where a growing number of OSGeo projects already have registered DOI for their codebases.
> 
> The question is whether once a DOI for GDAL has been registered manually/retrospectively for the current release (GDAL 3.4.1) it will be feasible to switch to automated DOI versioning for all future GDAL releases.
> 
> The DataCite helpdesk confirms, this approach from their infrastructure perspective: "From the DataCite side I don't see anything that would mean the manual workflow could not change to an automated one, but this is something that Zenodo would need to confirm."
> 
> The Zenodo helpdesk confirmed this approach last night: "We can actually connect this record to a "virtual" release on our side as if it was actually part of the Github repo. Could you give us more details, for example, the records in question and the GitHub repos?".
> -> I have told them that this applies to GDAL (among other projects). No response yet.
> Maybe someone of the project community is interested and able to contact the Zenodo help desk directly on this (info at zenodo.org) ?
> 
> The deadline to include a DOI for the GDAL project to the Open Source Chapter of the Springer Handbook on Geographic Information is today end of business Pacific Time.
> 
> By now, ten OSGeo projects will have their DOI referenced in the Chapter (more to come in the next hours). It would be awesome if GDAL could be included, too.
> 
> Best,
> Peter
> 
> <peter.loewe at gmx.de>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From sean.gillies at gmail.com  Thu Jan 20 07:44:26 2022
From: sean.gillies at gmail.com (Sean Gillies)
Date: Thu, 20 Jan 2022 08:44:26 -0700
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAOodmJrOmaWnf2v3o6sZaE2ystnFXDW7dpYyY0Az1fxCzeajwQ@mail.gmail.com>

Hi Jon,

The performance of GetFeatureCount, filters, and GetNextFeature depends a
lot on the data format. If your data is in Postgres, for example, these
operations are super fast because the database keeps the number of rows
(features) in memory and has highly optimized views of selected rows. If
your data is in a CSV file, GDAL has to read every line to count the number
of features and when getting filtered features has to read all the lines in
between the ones you want. See
https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/csv/ogrcsvlayer.cpp#L1667
.

Can you switch to a more optimized format?

On Thu, Jan 20, 2022 at 2:02 AM Jon Morris <Jon.Morris at jbarisk.com> wrote:

> I'm writing applications using the GDAL Python bindings and when I profile
> for performance, GetFeatureCount frequently comes out near the top. I'm
> often using it to check whether a spatial or attribute filter has returned
> any features and don't need the full count. When the layer contains
> millions of features, there would be a big performance improvement if we
> could exit the count early.
>
>
>
> Is there a better way of doing this? I've tried using GetNextFeature
> instead, but there must be quite a lot of overhead in that function as it
> is much slower. All I need to know is if the layer has has 0, 1 or >1
> features, I don't need the actual count. Can anyone suggest the fastest way
> of doing this in Python? I'm using GDAL 3.3.1 at the moment but could
> upgrade if there is new functionality that would help.
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *Jon Morris*
>
> *Software Developer*
>
>
>
>
> e:  *Jon.Morris at jbarisk.com* <Jon.Morris at jbarisk.com>
> t:  *+44 (0)1756 799919* <+44%20(0)1756%20799919>
> *www.jbarisk.com* <http://www.jbarisk.com/>
> [image: Facebook] <https://www.facebook.com/TheFloodPeople>
> [image: LinkedIn] <https://www.linkedin.com/company/jba-risk-management/>
> [image: Twitter] <https://twitter.com/JBARisk>
> [image: YouTube]
> <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, England.
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image918956.png
Type: image/png
Size: 9886 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image215268.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image706640.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image011385.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image866509.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/15824040/attachment-0009.png>

From even.rouault at spatialys.com  Thu Jan 20 07:49:49 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Jan 2022 16:49:49 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <trinity-792def8c-8df6-42d2-9cb8-9b83cc30df75-1642689426503@3c-app-gmx-bs28>
References: <trinity-0675ef2b-457d-4778-9280-a4666a7abadf-1642670161257@3c-app-gmx-bs17>
 <trinity-792def8c-8df6-42d2-9cb8-9b83cc30df75-1642689426503@3c-app-gmx-bs28>
Message-ID: <0e79ae74-2c96-d7b9-95f0-a51311dc687d@spatialys.com>

Ok, I went ahead with a manual upload of GDAL 3.4.1: 
https://zenodo.org/record/5884352 , with concept DOI being 
https://zenodo.org/record/5884351

Can you ask the zenodo help desk to link the later with the github 
releases of https://github.com/OSGeo/GDAL ?

Same for PROJ 8.2.1: https://zenodo.org/record/5884395, with concept DOI 
being https://zenodo.org/record/5884394, to be associated with 
https://github.com/OSGeo/PROJ

Even


Le 20/01/2022 ? 15:37, Peter L?we a ?crit?:
> Hi,
>
> FYI here's the confirmation by Zenodo about the combined use of manual and automated software versioning:
>
> "It is possible to link manual releases to the GitHub integration automated workflow.
> You can go ahead and publish the two manual releases and share them here.
> We will then link them to the equivalent GitHub repositories so that when you activate the integration new versions will continue under the same Concept DOIs of the manual releases"
>
> -> the two repos being referred to are PROJ and GDAL.
>
> I will not be abl? to act on this as I do not have admin access to neither the GDAL nor the PROJ repo.
>
> Best,
> Peter
>
> <peter.loewe at gmx.de>
>
>
>> Gesendet: Donnerstag, 20. Januar 2022 um 10:16 Uhr
>> Von: "Peter L?we" <peter.loewe at gmx.de>
>> An: gdal-dev at lists.osgeo.org
>> Betreff: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of Geoinformatics
>>
>> Hello gdal-dev-list,
>>
>> regarding the current discussion on how to register DOI for GDAL, I've contacted the helpdesks of Zenodo and DataCite. DataCite is the organisation providing the global DOI-infrastructure. Zenodo is an open access repository where a growing number of OSGeo projects already have registered DOI for their codebases.
>>
>> The question is whether once a DOI for GDAL has been registered manually/retrospectively for the current release (GDAL 3.4.1) it will be feasible to switch to automated DOI versioning for all future GDAL releases.
>>
>> The DataCite helpdesk confirms, this approach from their infrastructure perspective: "From the DataCite side I don't see anything that would mean the manual workflow could not change to an automated one, but this is something that Zenodo would need to confirm."
>>
>> The Zenodo helpdesk confirmed this approach last night: "We can actually connect this record to a "virtual" release on our side as if it was actually part of the Github repo. Could you give us more details, for example, the records in question and the GitHub repos?".
>> -> I have told them that this applies to GDAL (among other projects). No response yet.
>> Maybe someone of the project community is interested and able to contact the Zenodo help desk directly on this (info at zenodo.org) ?
>>
>> The deadline to include a DOI for the GDAL project to the Open Source Chapter of the Springer Handbook on Geographic Information is today end of business Pacific Time.
>>
>> By now, ten OSGeo projects will have their DOI referenced in the Chapter (more to come in the next hours). It would be awesome if GDAL could be included, too.
>>
>> Best,
>> Peter
>>
>> <peter.loewe at gmx.de>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Jon.Morris at jbarisk.com  Thu Jan 20 07:55:08 2022
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 20 Jan 2022 15:55:08 +0000
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <46f3d869-ee6a-8e3b-2064-325506831f87@gmail.com>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <46f3d869-ee6a-8e3b-2064-325506831f87@gmail.com>
Message-ID: <LO2P123MB48619CAAE6C171C00D339907825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Hi Roman,

I'm not sure how you would determine the kill time. Each individual call to GetFeatureCount is fairly quick, but when you're doing it a lot, in a loop, they add up. Here's an example output from the Python profiler:

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      195   98.689    0.506   98.690    0.506 {built-in method osgeo._ogr.Geometry_Intersection}
     4091   40.792    0.010   40.860    0.010 {built-in method osgeo._ogr.Geometry_Union}
     8358   33.862    0.004   33.862    0.004 {built-in method osgeo._ogr.Layer_GetFeatureCount}
    28653   17.059    0.001   17.115    0.001 {built-in method osgeo._ogr.Layer_GetNextFeature}

Obviously, I could be calling the feature count less often, but I was hoping I could shave a small amount of time off each call. Also obviously, my geometry operations are more costly than the feature operations, but it's worth trying to save time anywhere you can.

Jon


e: Jon.Morris at jbarisk.com
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
From: Roman Breitfuss-Schiffer <roman.schiffer at gmail.com>
Sent: 20 January 2022 10:38
To: Jon Morris <Jon.Morris at jbarisk.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Faster alternative to GetFeatureCount?

CAUTION: This email originated from outside of JBA and contains one or more links and one or more attachments. DO NOT click links or open attachments unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.

Hi Jon!

I don't know if there's an alternative to GetFeatureCount. At least I couldn't find one in the API documentation. Maybe there's a workaround I'm not aware of...

What you could do is wrap the call of GetFeatrueCount in a function which is killed after some time (2 approaches are discussed here: https://stackoverflow.com/questions/40915527/kill-function-after-a-given-amount-of-time). With that approach the question remains of getting the value of GetFeatureCount when the function gets killed. One could assume that there are more features than 1 if the function takes too long. This assumption might be a bit risky though...

Best regards
Roman
Am 20.01.2022 um 10:00 schrieb Jon Morris:
I'm writing applications using the GDAL Python bindings and when I profile for performance, GetFeatureCount frequently comes out near the top. I'm often using it to check whether a spatial or attribute filter has returned any features and don't need the full count. When the layer contains millions of features, there would be a big performance improvement if we could exit the count early.

Is there a better way of doing this? I've tried using GetNextFeature instead, but there must be quite a lot of overhead in that function as it is much slower. All I need to know is if the layer has has 0, 1 or >1 features, I don't need the actual count. Can anyone suggest the fastest way of doing this in Python? I'm using GDAL 3.3.1 at the moment but could upgrade if there is new functionality that would help.

Thanks,

Jon

Jon Morris
Software Developer


e: ?
Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>
t:
+44 (0)1756 799919<tel:+44%20(0)1756%20799919>
www.jbarisk.com<http://www.jbarisk.com/>
[cid:image001.png at 01D80E16.184A46E0]
[Facebook]<https://www.facebook.com/TheFloodPeople>
[LinkedIn]<https://www.linkedin.com/company/jba-risk-management/>
[Twitter]<https://twitter.com/JBARisk>
[YouTube]<https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>



All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 9886 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 651 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0011.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 715 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0012.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 966 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0013.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 784 bytes
Desc: image005.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0014.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image244774.png
Type: image/png
Size: 9886 bytes
Desc: image244774.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0015.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image169598.png
Type: image/png
Size: 651 bytes
Desc: image169598.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0016.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image117658.png
Type: image/png
Size: 715 bytes
Desc: image117658.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0017.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image480157.png
Type: image/png
Size: 966 bytes
Desc: image480157.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0018.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image726289.png
Type: image/png
Size: 784 bytes
Desc: image726289.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/e12e83e7/attachment-0019.png>

From Jon.Morris at jbarisk.com  Thu Jan 20 07:57:19 2022
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 20 Jan 2022 15:57:19 +0000
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <CA+=cGJ=diz7chgeQ23xZNN39e9agCCno1ksRz4=uMdTAv73OxQ@mail.gmail.com>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <CA+=cGJ=diz7chgeQ23xZNN39e9agCCno1ksRz4=uMdTAv73OxQ@mail.gmail.com>
Message-ID: <LO2P123MB486110A3FC69F74CD7D7EB37825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Hi Ian,

That's more or less what I was doing, calling GetNextFeature twice. I figured GetFeatureCount would be doing that under the hood anyway, but it didn't seem to run any faster.

Jon


e: Jon.Morris at jbarisk.com
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
From: Ian Turton <ijturton at gmail.com>
Sent: 20 January 2022 10:55
To: Jon Morris <Jon.Morris at jbarisk.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Faster alternative to GetFeatureCount?

CAUTION: This email originated from outside of JBA and contains one or more links and one or more attachments. DO NOT click links or open attachments unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.
I'm not sure if it's a shortcut but couldn't you do a getFeatures loop with a counter and break after 2 times round the loop, then your counter would be 0,1 or 2 for your 3 cases.

Ian



On Thu, 20 Jan 2022 at 09:00, Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
I'm writing applications using the GDAL Python bindings and when I profile for performance, GetFeatureCount frequently comes out near the top. I'm often using it to check whether a spatial or attribute filter has returned any features and don't need the full count. When the layer contains millions of features, there would be a big performance improvement if we could exit the count early.

Is there a better way of doing this? I've tried using GetNextFeature instead, but there must be quite a lot of overhead in that function as it is much slower. All I need to know is if the layer has has 0, 1 or >1 features, I don't need the actual count. Can anyone suggest the fastest way of doing this in Python? I'm using GDAL 3.3.1 at the moment but could upgrade if there is new functionality that would help.

Thanks,

Jon

Jon Morris
Software Developer


e: ?
Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>
t:
+44 (0)1756 799919<tel:+44%20(0)1756%20799919>
www.jbarisk.com<http://www.jbarisk.com/>
[cid:image001.png at 01D80E16.665C3D20]
[Facebook]<https://www.facebook.com/TheFloodPeople>
[LinkedIn]<https://www.linkedin.com/company/jba-risk-management/>
[Twitter]<https://twitter.com/JBARisk>
[YouTube]<https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>



All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
Ian Turton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 9886 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 651 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0011.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 715 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0012.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 966 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0013.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 784 bytes
Desc: image005.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0014.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image267983.png
Type: image/png
Size: 9886 bytes
Desc: image267983.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0015.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image922892.png
Type: image/png
Size: 651 bytes
Desc: image922892.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0016.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image555972.png
Type: image/png
Size: 715 bytes
Desc: image555972.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0017.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image357622.png
Type: image/png
Size: 966 bytes
Desc: image357622.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0018.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image334254.png
Type: image/png
Size: 784 bytes
Desc: image334254.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b443a85b/attachment-0019.png>

From Jon.Morris at jbarisk.com  Thu Jan 20 07:59:43 2022
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 20 Jan 2022 15:59:43 +0000
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <CAOodmJrOmaWnf2v3o6sZaE2ystnFXDW7dpYyY0Az1fxCzeajwQ@mail.gmail.com>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <CAOodmJrOmaWnf2v3o6sZaE2ystnFXDW7dpYyY0Az1fxCzeajwQ@mail.gmail.com>
Message-ID: <LO2P123MB4861BCF79CCE44D9982518F0825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>

Hi Sean,

That seems to be the best option. I was testing on Shapefile initially, but after I posted, I tried a memory layer and got quite different results. Ultimately, our output format is determined by clients (it's usually Shapefile or File GDB), so we'll just have to let them know there are performance implications with some formats.

Thanks,

Jon


e: Jon.Morris at jbarisk.com
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Sean Gillies
Sent: 20 January 2022 15:44
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Faster alternative to GetFeatureCount?

CAUTION: This email originated from outside of JBA and contains one or more links and one or more attachments. DO NOT click links or open attachments unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.
WARNING: This email contains one or more attachments with links within the attachment(s). Please take extra care when handling the attachments.
Hi Jon,

The performance of GetFeatureCount, filters, and GetNextFeature depends a lot on the data format. If your data is in Postgres, for example, these operations are super fast because the database keeps the number of rows (features) in memory and has highly optimized views of selected rows. If your data is in a CSV file, GDAL has to read every line to count the number of features and when getting filtered features has to read all the lines in between the ones you want. See https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/csv/ogrcsvlayer.cpp#L1667.

Can you switch to a more optimized format?

On Thu, Jan 20, 2022 at 2:02 AM Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
I'm writing applications using the GDAL Python bindings and when I profile for performance, GetFeatureCount frequently comes out near the top. I'm often using it to check whether a spatial or attribute filter has returned any features and don't need the full count. When the layer contains millions of features, there would be a big performance improvement if we could exit the count early.

Is there a better way of doing this? I've tried using GetNextFeature instead, but there must be quite a lot of overhead in that function as it is much slower. All I need to know is if the layer has has 0, 1 or >1 features, I don't need the actual count. Can anyone suggest the fastest way of doing this in Python? I'm using GDAL 3.3.1 at the moment but could upgrade if there is new functionality that would help.

Thanks,

Jon

Jon Morris
Software Developer


e:
Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>
t:
+44 (0)1756 799919<tel:+44%20(0)1756%20799919>
www.jbarisk.com<http://www.jbarisk.com/>
[cid:image001.png at 01D80E16.BC39E5D0]
[Facebook]<https://www.facebook.com/TheFloodPeople>
[LinkedIn]<https://www.linkedin.com/company/jba-risk-management/>
[Twitter]<https://twitter.com/JBARisk>
[YouTube]<https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>



All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.


--
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 9886 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 651 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0011.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 715 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0012.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 966 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0013.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 784 bytes
Desc: image005.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0014.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image633772.png
Type: image/png
Size: 9886 bytes
Desc: image633772.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0015.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image076485.png
Type: image/png
Size: 651 bytes
Desc: image076485.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0016.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image695600.png
Type: image/png
Size: 715 bytes
Desc: image695600.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0017.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image601417.png
Type: image/png
Size: 966 bytes
Desc: image601417.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0018.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image345894.png
Type: image/png
Size: 784 bytes
Desc: image345894.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/69617c3c/attachment-0019.png>

From peter.loewe at gmx.de  Thu Jan 20 08:06:43 2022
From: peter.loewe at gmx.de (=?UTF-8?Q?Peter_L=C3=B6we?=)
Date: Thu, 20 Jan 2022 17:06:43 +0100
Subject: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of
 Geoinformatics
In-Reply-To: <0e79ae74-2c96-d7b9-95f0-a51311dc687d@spatialys.com>
References: <trinity-0675ef2b-457d-4778-9280-a4666a7abadf-1642670161257@3c-app-gmx-bs17>
 <trinity-792def8c-8df6-42d2-9cb8-9b83cc30df75-1642689426503@3c-app-gmx-bs28>
 <0e79ae74-2c96-d7b9-95f0-a51311dc687d@spatialys.com>
Message-ID: <trinity-6ebd0fe5-98b9-4d64-b33d-09e915dbc33c-1642694803753@3c-app-gmx-bs19>

Done.

Congratulations to both GDAL and PROJ for minting their DOI !

Best,
Peter

<peter.loewe at gmx.de>


> Gesendet: Donnerstag, 20. Januar 2022 um 16:49 Uhr
> Von: "Even Rouault" <even.rouault at spatialys.com>
> An: "Peter L?we" <peter.loewe at gmx.de>
> Cc: gdal-dev at lists.osgeo.org, "proj" <proj at lists.osgeo.org>
> Betreff: Re: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of Geoinformatics
>
> Ok, I went ahead with a manual upload of GDAL 3.4.1: 
> https://zenodo.org/record/5884352 , with concept DOI being 
> https://zenodo.org/record/5884351
> 
> Can you ask the zenodo help desk to link the later with the github 
> releases of https://github.com/OSGeo/GDAL ?
> 
> Same for PROJ 8.2.1: https://zenodo.org/record/5884395, with concept DOI 
> being https://zenodo.org/record/5884394, to be associated with 
> https://github.com/OSGeo/PROJ
> 
> Even
> 
> 
> Le 20/01/2022 ? 15:37, Peter L?we a ?crit?:
> > Hi,
> >
> > FYI here's the confirmation by Zenodo about the combined use of manual and automated software versioning:
> >
> > "It is possible to link manual releases to the GitHub integration automated workflow.
> > You can go ahead and publish the two manual releases and share them here.
> > We will then link them to the equivalent GitHub repositories so that when you activate the integration new versions will continue under the same Concept DOIs of the manual releases"
> >
> > -> the two repos being referred to are PROJ and GDAL.
> >
> > I will not be abl? to act on this as I do not have admin access to neither the GDAL nor the PROJ repo.
> >
> > Best,
> > Peter
> >
> > <peter.loewe at gmx.de>
> >
> >
> >> Gesendet: Donnerstag, 20. Januar 2022 um 10:16 Uhr
> >> Von: "Peter L?we" <peter.loewe at gmx.de>
> >> An: gdal-dev at lists.osgeo.org
> >> Betreff: [gdal-dev] Fwd: DOI for the GDAL project / Springer Handbook of Geoinformatics
> >>
> >> Hello gdal-dev-list,
> >>
> >> regarding the current discussion on how to register DOI for GDAL, I've contacted the helpdesks of Zenodo and DataCite. DataCite is the organisation providing the global DOI-infrastructure. Zenodo is an open access repository where a growing number of OSGeo projects already have registered DOI for their codebases.
> >>
> >> The question is whether once a DOI for GDAL has been registered manually/retrospectively for the current release (GDAL 3.4.1) it will be feasible to switch to automated DOI versioning for all future GDAL releases.
> >>
> >> The DataCite helpdesk confirms, this approach from their infrastructure perspective: "From the DataCite side I don't see anything that would mean the manual workflow could not change to an automated one, but this is something that Zenodo would need to confirm."
> >>
> >> The Zenodo helpdesk confirmed this approach last night: "We can actually connect this record to a "virtual" release on our side as if it was actually part of the Github repo. Could you give us more details, for example, the records in question and the GitHub repos?".
> >> -> I have told them that this applies to GDAL (among other projects). No response yet.
> >> Maybe someone of the project community is interested and able to contact the Zenodo help desk directly on this (info at zenodo.org) ?
> >>
> >> The deadline to include a DOI for the GDAL project to the Open Source Chapter of the Springer Handbook on Geographic Information is today end of business Pacific Time.
> >>
> >> By now, ten OSGeo projects will have their DOI referenced in the Chapter (more to come in the next hours). It would be awesome if GDAL could be included, too.
> >>
> >> Best,
> >> Peter
> >>
> >> <peter.loewe at gmx.de>
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
>

From mswope at gmail.com  Thu Jan 20 21:03:11 2022
From: mswope at gmail.com (Mike)
Date: Thu, 20 Jan 2022 22:03:11 -0700
Subject: [gdal-dev] Faster alternative to GetFeatureCount?
In-Reply-To: <LO2P123MB4861BCF79CCE44D9982518F0825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB48614F07875A3903D86A6D60825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
 <CAOodmJrOmaWnf2v3o6sZaE2ystnFXDW7dpYyY0Az1fxCzeajwQ@mail.gmail.com>
 <LO2P123MB4861BCF79CCE44D9982518F0825A9@LO2P123MB4861.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAKTSvBjimCVNHVhMnOTze0N29gbOT4bbVqbAH5n=pMy3=tFihA@mail.gmail.com>

In the case if FileGDB, which driver you use to read the FileGDB makes a
big difference.

On Thu, Jan 20, 2022 at 8:59 AM Jon Morris <Jon.Morris at jbarisk.com> wrote:

> Hi Sean,
>
>
>
> That seems to be the best option. I was testing on Shapefile initially,
> but after I posted, I tried a memory layer and got quite different results.
> Ultimately, our output format is determined by clients (it's usually
> Shapefile or File GDB), so we'll just have to let them know there are
> performance implications with some formats.
>
>
>
> Thanks,
>
>
>
> Jon
>
>
> e: ? *Jon.Morris at jbarisk.com* <Jon.Morris at jbarisk.com>
> t:  *+44 (0)1756 799919* <+44%20(0)1756%20799919>
> *www.jbarisk.com* <http://www.jbarisk.com/>
> [image: Facebook] <https://www.facebook.com/TheFloodPeople>
> [image: LinkedIn] <https://www.linkedin.com/company/jba-risk-management/>
> [image: Twitter] <https://twitter.com/JBARisk>
> [image: YouTube]
> <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, England.
>
> *From:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Sean
> Gillies
> *Sent:* 20 January 2022 15:44
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Faster alternative to GetFeatureCount?
>
>
>
> *CAUTION:* This email originated from outside of JBA and *contains one or
> more links and one or more attachments*. DO NOT click links or open
> attachments unless you recognise the sender's email address and are
> absolutely certain that the content is safe.
> See the Phishing page on IMS on SP for more information about how to spot
> and report suspicious messages.
>
> *WARNING: This email contains one or more attachments with links within
> the attachment(s)*. Please take extra care when handling the attachments.
>
> Hi Jon,
>
>
>
> The performance of GetFeatureCount, filters, and GetNextFeature depends a
> lot on the data format. If your data is in Postgres, for example, these
> operations are super fast because the database keeps the number of rows
> (features) in memory and has highly optimized views of selected rows. If
> your data is in a CSV file, GDAL has to read every line to count the number
> of features and when getting filtered features has to read all the lines in
> between the ones you want. See
> https://github.com/OSGeo/gdal/blob/master/ogr/ogrsf_frmts/csv/ogrcsvlayer.cpp#L1667
> .
>
>
>
> Can you switch to a more optimized format?
>
>
>
> On Thu, Jan 20, 2022 at 2:02 AM Jon Morris <Jon.Morris at jbarisk.com> wrote:
>
> I'm writing applications using the GDAL Python bindings and when I profile
> for performance, GetFeatureCount frequently comes out near the top. I'm
> often using it to check whether a spatial or attribute filter has returned
> any features and don't need the full count. When the layer contains
> millions of features, there would be a big performance improvement if we
> could exit the count early.
>
>
>
> Is there a better way of doing this? I've tried using GetNextFeature
> instead, but there must be quite a lot of overhead in that function as it
> is much slower. All I need to know is if the layer has has 0, 1 or >1
> features, I don't need the actual count. Can anyone suggest the fastest way
> of doing this in Python? I'm using GDAL 3.3.1 at the moment but could
> upgrade if there is new functionality that would help.
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *Jon Morris*
>
> *Software Developer*
>
>
>
>
>
> *e: *
>
> Jon.Morris at jbarisk.com
>
> *t: *
>
> +44 (0)1756 799919 <+44%20(0)1756%20799919>
>
> www.jbarisk.com
>
> [image: Facebook] <https://www.facebook.com/TheFloodPeople>
>
> [image: LinkedIn] <https://www.linkedin.com/company/jba-risk-management/>
>
> [image: Twitter] <https://twitter.com/JBARisk>
>
> [image: YouTube]
> <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
>
>
>
>
>
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, England.
>
>
>
> --
>
> Sean Gillies
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 9886 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0011.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0012.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0013.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image005.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0014.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image633772.png
Type: image/png
Size: 9886 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0015.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image076485.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0016.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image695600.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0017.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image601417.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0018.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image345894.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220120/b09e4bd0/attachment-0019.png>

From huangning290 at 126.com  Thu Jan 20 21:57:23 2022
From: huangning290 at 126.com (=?GBK?B?u8bE/g==?=)
Date: Fri, 21 Jan 2022 13:57:23 +0800 (CST)
Subject: [gdal-dev] OCI driver in ogr_fdw postgresql extension
Message-ID: <2356d646.26db.17e7b35fdf4.Coremail.huangning290@126.com>

I want to read geo data from an oracle database. How should I create a server?
I will try to create a server in this way. but can not connect to an oracle.
CREATE SERVER ociserver
FOREIGN DATA WRAPPER ogr_fdw
OPTIONS (
    datasource 'OCI:username/password at host:port:sid',
format 'OCI' );



Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220121/503cf595/attachment.html>

From even.rouault at spatialys.com  Fri Jan 21 02:18:16 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Jan 2022 11:18:16 +0100
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial code
 additions
Message-ID: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>

Hi,

As the discussion seems to have calmed down, I move to adopt RFC 85: 
Policy regarding substantial code additions: 
https://github.com/OSGeo/gdal/pull/5128

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Fri Jan 21 02:26:49 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 21 Jan 2022 10:26:49 +0000
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
Message-ID: <9894d5bafd104f20abb04ec8dbbe3a98@maanmittauslaitos.fi>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: perjantai 21. tammikuuta 2022 12.18
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial code additions

Hi,

As the discussion seems to have calmed down, I move to adopt RFC 85: 
Policy regarding substantial code additions: 
https://github.com/OSGeo/gdal/pull/5128

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From mateusz at loskot.net  Fri Jan 21 02:39:37 2022
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 21 Jan 2022 11:39:37 +0100
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
Message-ID: <CABUeae-UHO_R4nLM0XvfONr5qRx+6ZmbdiC_W_t+UOn77Uq=ig@mail.gmail.com>

+1   Mateusz

On Fri, 21 Jan 2022 at 11:18, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> As the discussion seems to have calmed down, I move to adopt RFC 85:
> Policy regarding substantial code additions:
> https://github.com/OSGeo/gdal/pull/5128
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From schwehr at gmail.com  Fri Jan 21 02:56:29 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 21 Jan 2022 02:56:29 -0800
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
Message-ID: <CACmBxysW25Fd6k+0FZwAeQ3LRG9gPn5F6+XzbOXEO=YK_SWp_Q@mail.gmail.com>

+1 KurtS

On Fri, Jan 21, 2022 at 2:18 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> As the discussion seems to have calmed down, I move to adopt RFC 85:
> Policy regarding substantial code additions:
> https://github.com/OSGeo/gdal/pull/5128
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220121/854c39d4/attachment.html>

From szekerest at gmail.com  Fri Jan 21 08:30:24 2022
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri, 21 Jan 2022 17:30:24 +0100
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
Message-ID: <CACALY+Q++BBRX-K5ROmAkXajWrktR2bPhm3e-FTjWc=Fhmf5SA@mail.gmail.com>

+1

Tamas

Even Rouault <even.rouault at spatialys.com> ezt ?rta (id?pont: 2022. jan.
21., P, 11:18):

> Hi,
>
> As the discussion seems to have calmed down, I move to adopt RFC 85:
> Policy regarding substantial code additions:
> https://github.com/OSGeo/gdal/pull/5128
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220121/b34f4777/attachment.html>

From sean.gillies at gmail.com  Fri Jan 21 09:05:48 2022
From: sean.gillies at gmail.com (Sean Gillies)
Date: Fri, 21 Jan 2022 10:05:48 -0700
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
Message-ID: <CAOodmJrO6Rd6JoG=tz2Gh5A-VqQmMtn7S9UPOr0wJ-M2+ZL73g@mail.gmail.com>

+1 from me.

Howard, I really appreciate how you're reminding us that what proprietary
vendors want is for GDAL to help distribute their software. Writing code
that works is the easy part. Getting it onto computers and getting people
to use it is the hard part.

On Fri, Jan 21, 2022 at 3:18 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> As the discussion seems to have calmed down, I move to adopt RFC 85:
> Policy regarding substantial code additions:
> https://github.com/OSGeo/gdal/pull/5128
>
> Starting with my +1
>
> Even
>
>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220121/c61ee647/attachment.html>

From howard at hobu.co  Fri Jan 21 11:26:23 2022
From: howard at hobu.co (Howard Butler)
Date: Fri, 21 Jan 2022 13:26:23 -0600
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <CAOodmJrO6Rd6JoG=tz2Gh5A-VqQmMtn7S9UPOr0wJ-M2+ZL73g@mail.gmail.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
 <CAOodmJrO6Rd6JoG=tz2Gh5A-VqQmMtn7S9UPOr0wJ-M2+ZL73g@mail.gmail.com>
Message-ID: <C9A2EC64-8B78-441F-95E9-BEBD760452BD@hobu.co>


> On Jan 21, 2022, at 11:05 AM, Sean Gillies <sean.gillies at gmail.com> wrote:
> 
> +1 from me.
> 
> Howard, I really appreciate how you're reminding us that what proprietary vendors want is for GDAL to help distribute their software. Writing code that works is the easy part. Getting it onto computers and getting people to use it is the hard part.

+1

Yes, I think the distinction that matters most is not just that proprietary vendors are leveraging GDAL's distribution channel. It's that they attempt to explicitly or inadvertently externalize the costs of maintaining that distribution channel on the GDAL project itself. An open source developer who tosses something over the wall that a bunch of people including other developers find useful is doing something different than a vendor who is throwing their binary SDK-driven codebase up and over. This RFC provides a the latter expectations they will need to meet if they go forward. IMO, they are not so onerous either.

Howard



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220121/0c9661fb/attachment-0001.html>

From andrew at aitchison.me.uk  Fri Jan 21 14:16:19 2022
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 21 Jan 2022 22:16:19 +0000 (GMT)
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <C9A2EC64-8B78-441F-95E9-BEBD760452BD@hobu.co>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
 <CAOodmJrO6Rd6JoG=tz2Gh5A-VqQmMtn7S9UPOr0wJ-M2+ZL73g@mail.gmail.com>
 <C9A2EC64-8B78-441F-95E9-BEBD760452BD@hobu.co>
Message-ID: <f23e907d-c5-2577-826a-76e20a1be7d@aitchison.me.uk>

On Fri, 21 Jan 2022, Howard Butler wrote:


>> On Jan 21, 2022, at 11:05 AM, Sean Gillies <sean.gillies at gmail.com> wrote:
>>
>> +1 from me.
>>
>> Howard, I really appreciate how you're reminding us that what
>> proprietary vendors want is for GDAL to help distribute their
>> software. Writing code that works is the easy part. Getting it onto
>> computers and getting people to use it is the hard part.
>
> +1
>
> Yes, I think the distinction that matters most is not just that
> proprietary vendors are leveraging GDAL's distribution channel. It's
> that they attempt to explicitly or inadvertently externalize the
> costs of maintaining that distribution channel on the GDAL project
> itself. An open source developer who tosses something over the wall
> that a bunch of people including other developers find useful is
> doing something different than a vendor who is throwing their binary
> SDK-driven codebase up and over. This RFC provides a the latter
> expectations they will need to meet if they go forward. IMO, they
> are not so onerous either.

Should we then change it from "substantion code additions" to
"code additions including (or perhaps interfacing to) non-open code" ?

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From even.rouault at spatialys.com  Fri Jan 21 15:01:07 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 22 Jan 2022 00:01:07 +0100
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <f23e907d-c5-2577-826a-76e20a1be7d@aitchison.me.uk>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
 <CAOodmJrO6Rd6JoG=tz2Gh5A-VqQmMtn7S9UPOr0wJ-M2+ZL73g@mail.gmail.com>
 <C9A2EC64-8B78-441F-95E9-BEBD760452BD@hobu.co>
 <f23e907d-c5-2577-826a-76e20a1be7d@aitchison.me.uk>
Message-ID: <f65ce9c8-a3aa-5acf-27a7-37218471e206@spatialys.com>


> Should we then change it from "substantion code additions" to
> "code additions including (or perhaps interfacing to) non-open code" ?
The scope is a bit beyond that: see my comment 
https://github.com/OSGeo/gdal/pull/5128#discussion_r787095661

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From dthorne at pivotmaritime.com  Sun Jan 23 21:36:07 2022
From: dthorne at pivotmaritime.com (dthorne at pivotmaritime.com)
Date: Mon, 24 Jan 2022 16:36:07 +1100 (AEDT)
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
Message-ID: <1643002567.238829295@apps.rackspace.com>


Hi, So I am trying to get a test C++ project built to read S57 files using the gdal/ogr C++ library. I have previously used the C# library that is on there NuGet manager which states v2.4.4 and that seems to read the s57 without issues. Also tried python and that seems to read it with no issues. However, I am having a problem with the C++ test project. Having built the C++ library into the .lib and .dll files I have included them into a blank project and implemented the functions to read the s57 file, however it is only reporting 5 layers.These 5 layers are the same no matter the s57 file. And 4 out of those 5 layers are not actually layers.Using the autotest generated s57 file as a unit test to cross check, there is supposed to be 13 layers. 
Note: I had feedback from Even indicating the setup environment is probably wrong. And to set up the GDAL_DATA environment variable, so we've made an environment variable referencing the gdal/data folder and that hasn't fixed the problem, but I think it's on the right track as Even said they could reproduce the problem if not setup correctly.
Has anyone had success reading s57 files with a C++ 3.4.1. project that could possibly help get this going?

Link to reference Image: [ https://imgur.com/a/KwmqZSe ]( https://imgur.com/a/KwmqZSe )
Regards,Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220124/10586bc7/attachment.html>

From gdt at lexort.com  Mon Jan 24 16:05:27 2022
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 24 Jan 2022 19:05:27 -0500
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com> (Even
 Rouault's message of "Tue, 18 Jan 2022 15:27:49 +0100")
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
Message-ID: <rmi8rv4addk.fsf_-_@s1.lexort.com>


I have started testing cmake support on gdal master.
My approach is

  1) Build gdal from git using cmake.

  2) Be able to create a release tarball (not actually a release of
  course) from master in order to use for building with pkgsrc.

  3) Build the release using autoconf, basically unchanged pkgsrc
  control files execpt for version, and run tests and check qgis
  functionality.

  4) Convert the package control files to use cmake instead of autoconf
  and test again.  This involves our "gdal-lib" and "py-gdal" packages.

In step 1, I have so far found one problem, an incorrect INCLUDE
variable for poppler.  I have created a pull request with a simple fix:
  https://github.com/OSGeo/gdal/pull/5161

For step 2, as Even suggested would be the case, I ran into a number of
small portability issues (some makefiles need GNU make, even though the
cmake makefiles don't) and missing documentation (breathe and swig (4?)
are required to run mkgdaldist.sh).  None of these are a big deal and
the list is pretty small for what I think might be the first time the
script has been used on a different operating system.  I have a branch
in progress and will submit a PR when it settles down.  The changes are
minor.

For step 3, I've been able to build the release, but haven't tested yet.

Greg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220124/904e6506/attachment.sig>

From jluis at ualg.pt  Mon Jan 24 16:27:20 2022
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Tue, 25 Jan 2022 00:27:20 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <rmi8rv4addk.fsf_-_@s1.lexort.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
Message-ID: <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>

Hi,

I made also an attempt on Windows and so far my findings are:

The docs say that the PROJ variables should be 

PROJ_INCLUDE_DIR
PROJ_LIBRARY_RELEASE

But the lib var must in fact be

PROJ_LIBRARY

Couldn't yet find a way to build with HDF5, ECW and MRSID, which I can do with no problems with the current nmake solution.
For the rest, I haven't test anything but it builds fine and a quick `Dependency` analysis shows no issues.

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Greg Troxel
Sent: Tuesday, January 25, 2022 12:05 AM
To: Even Rouault <even.rouault at spatialys.com>
Cc: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] cmake status update - 99% good news!


I have started testing cmake support on gdal master.
My approach is

  1) Build gdal from git using cmake.

  2) Be able to create a release tarball (not actually a release of
  course) from master in order to use for building with pkgsrc.

  3) Build the release using autoconf, basically unchanged pkgsrc
  control files execpt for version, and run tests and check qgis
  functionality.

  4) Convert the package control files to use cmake instead of autoconf
  and test again.  This involves our "gdal-lib" and "py-gdal" packages.

In step 1, I have so far found one problem, an incorrect INCLUDE variable for poppler.  I have created a pull request with a simple fix:
  https://github.com/OSGeo/gdal/pull/5161

For step 2, as Even suggested would be the case, I ran into a number of small portability issues (some makefiles need GNU make, even though the cmake makefiles don't) and missing documentation (breathe and swig (4?) are required to run mkgdaldist.sh).  None of these are a big deal and the list is pretty small for what I think might be the first time the script has been used on a different operating system.  I have a branch in progress and will submit a PR when it settles down.  The changes are minor.

For step 3, I've been able to build the release, but haven't tested yet.

Greg

From even.rouault at spatialys.com  Mon Jan 24 16:46:56 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jan 2022 01:46:56 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>


Le 25/01/2022 ? 01:27, Joaquim Manuel Freire Lu?s a ?crit?:
> Hi,
>
> I made also an attempt on Windows and so far my findings are:
>
> The docs say that the PROJ variables should be
>
> PROJ_INCLUDE_DIR
> PROJ_LIBRARY_RELEASE
>
> But the lib var must in fact be
>
> PROJ_LIBRARY

How do you build exactly ?

If you build with "cmake --build . --config Release" then I believe 
PROJ_LIBRARY_RELEASE should be honored. Perhaps if you don't specify a 
configuration (is it possible with MSVC CMake builds ? I don't have a VM 
started right now), then PROJ_LIBRARY will be used.


>
> Couldn't yet find a way to build with HDF5, ECW and MRSID, which I can do with no problems with the current nmake solution.

HDF5 1.12.1 is tested with Windows Conda builds

For ECW, it looks like I tested on Windows with ECW 5.5

For MrSID, not sure I tested on Windows. Works on Linux with 
DSDK-9.5.4.4709-rhel6

> For the rest, I haven't test anything but it builds fine and a quick `Dependency` analysis shows no issues.
>
> Joaquim
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Greg Troxel
> Sent: Tuesday, January 25, 2022 12:05 AM
> To: Even Rouault <even.rouault at spatialys.com>
> Cc: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] cmake status update - 99% good news!
>
>
> I have started testing cmake support on gdal master.
> My approach is
>
>    1) Build gdal from git using cmake.
>
>    2) Be able to create a release tarball (not actually a release of
>    course) from master in order to use for building with pkgsrc.
>
>    3) Build the release using autoconf, basically unchanged pkgsrc
>    control files execpt for version, and run tests and check qgis
>    functionality.
>
>    4) Convert the package control files to use cmake instead of autoconf
>    and test again.  This involves our "gdal-lib" and "py-gdal" packages.
>
> In step 1, I have so far found one problem, an incorrect INCLUDE variable for poppler.  I have created a pull request with a simple fix:
>    https://github.com/OSGeo/gdal/pull/5161
>
> For step 2, as Even suggested would be the case, I ran into a number of small portability issues (some makefiles need GNU make, even though the cmake makefiles don't) and missing documentation (breathe and swig (4?) are required to run mkgdaldist.sh).  None of these are a big deal and the list is pretty small for what I think might be the first time the script has been used on a different operating system.  I have a branch in progress and will submit a PR when it settles down.  The changes are minor.
>
> For step 3, I've been able to build the release, but haven't tested yet.
>
> Greg

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From dmorissette at mapgears.com  Mon Jan 24 17:43:04 2022
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon, 24 Jan 2022 20:43:04 -0500
Subject: [gdal-dev] Shortening schedule for CMake adoption ?
In-Reply-To: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
Message-ID: <f3eaa487-6d6c-59ec-625e-776641a86c04@mapgears.com>

FWIW, I'll cast my +0.5 (not a full +1 because I didn't get to test 
myself, but I'm supportive because the feedback I've read so far sounds 
great)


On 2022-01-17 08:37, Even Rouault wrote:
> Hi,
> 
> The new CMake build system 
> (https://gdal.org/development/rfc/rfc84_cmake.html) has made excellent 
> progress, and I believe that it should be in a production ready state on 
> time for GDAL 3.5.0 (~ May). It is already very close to it according to 
> a checklist I had created 
> (https://docs.google.com/spreadsheets/d/1SsUXiZxKim6jhLjlJFCRs1zwMvNpbJbBMB6yl0ms01c). 
> Consequently we could shorten the rather conservative schedule presented 
> in RFC 84 to :
> 
> - Formally deprecate GNUmakefile and NMake base file systems. Users and 
> packagers are encouraged to switch to CMake and actively report (and 
> help fixing) issues the find in the process.
> 
> ==> Target: GDAL 3.5 / May 2022. GDAL 3.5.x point releases will be used 
> to address reported issues.
> 
> - Completely remove GNUmakefile and NMake base file systems, and make 
> CMake the only build system in GDAL source tree.
> 
> ==> Target: GDAL 3.6 / November 2022
> 
> 
> I can't see real advantages in keeping the 3 build systems longer than 
> strictly needed:
> 
> - it requires more maintenance effort and makes new contributions more 
> complicated
> 
> - we won't probably get significant feedback regarding the CMake build 
> system until people have to adopt it because they have no other 
> alternative.
> 
> We already greatly welcome feedback from people trying with master. To 
> facilitate this, I believe we could cut a GDAL 3.5 alpha in early March 
> so that people who wait for "official" packages have a chance to give it 
> a try too.
> 
> Thoughts ?
> 
> Even
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From dg0yt at darc.de  Mon Jan 24 23:23:57 2022
From: dg0yt at darc.de (Kai Pastor, DG0YT)
Date: Tue, 25 Jan 2022 08:23:57 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <rmi8rv4addk.fsf_-_@s1.lexort.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
Message-ID: <cfaa9d61-be00-964b-f4a1-58f3b9dea8f1@darc.de>

I made an initial attempt on gdal with cmake for vcpkg: 
https://github.com/microsoft/vcpkg/pull/22392

Now vcpkg's default is static linkage on Linux and macOS. AFAICT static 
linkage is not covered very well. Fixing this needs a lot of work either 
on the find modules, or on getting dependencies to provide exported 
config. In some cases (e.g. GEOS), config files already exist, but they 
are neither used nor a drop-in replacement (target names differ).

On the export side, all custom find modules must be made available to 
the exported configuration if not burning the depended-on libraries into 
the exported cmake config. Generating a complete gdal.pc needs work, 
too. CMake doesn't provide any help ATM. (But note 
https://gitlab.kitware.com/cmake/cmake/-/issues/22621.)

This is not meant as an argument against shortening the release schedule 
for cmake. I just want to underline that the CMake build system will 
continue to need significant changes, including user-facing changes.

Kai Pastor


From even.rouault at spatialys.com  Tue Jan 25 02:41:45 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jan 2022 11:41:45 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <cfaa9d61-be00-964b-f4a1-58f3b9dea8f1@darc.de>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <cfaa9d61-be00-964b-f4a1-58f3b9dea8f1@darc.de>
Message-ID: <3b6c6ce3-1d60-49e6-2666-07f2fca5b728@spatialys.com>

Hi Kai,

Le 25/01/2022 ? 08:23, Kai Pastor, DG0YT a ?crit?:
> I made an initial attempt on gdal with cmake for vcpkg: 
> https://github.com/microsoft/vcpkg/pull/22392
>
> Now vcpkg's default is static linkage on Linux and macOS. AFAICT 
> static linkage is not covered very well.

Trying to understand the issue: so the problems you face is when GDAL's 
dependencies are static libs, and you want gdal.pc, gdal-config or the 
CMake exported config to keep track all direct and indirect 
dependencies, right ?

Otherwise, I can do a BUILD_SHARED_LIBS=OFF build currently against 
dynamic dependencies.

Is it better covered on the autoconf side ? I've some doubts, as this 
isn't tested by CI. Not saying we can't improve this, but we'll need 
help from knowledgeable people. (can't you fallback on dynamic linkage 
for vcpkg?)

> Fixing this needs a lot of work either on the find modules, or on 
> getting dependencies to provide exported config. In some cases (e.g. 
> GEOS), config files already exist, but they are neither used

> nor a drop-in replacement (target names differ).

Not sure what you mean. Example ?

| including user-facing changes.

Example ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Jan 25 08:34:32 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jan 2022 17:34:32 +0100
Subject: [gdal-dev] Motion: adopt RFC 85: Policy regarding substantial
 code additions
In-Reply-To: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
References: <4d51952f-be1d-c2a6-3675-75aab8785909@spatialys.com>
Message-ID: <4d29ab17-e6c0-821a-c212-836e57a33063@spatialys.com>

I declare this motion passed with +1 from PSC members: MateuszL, KurtS, 
TamasS, SeanG, HowardB, JukkaR and me.

Le 21/01/2022 ? 11:18, Even Rouault a ?crit?:
> Hi,
>
> As the discussion seems to have calmed down, I move to adopt RFC 85: 
> Policy regarding substantial code additions: 
> https://github.com/OSGeo/gdal/pull/5128
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jluis at ualg.pt  Tue Jan 25 11:26:36 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Tue, 25 Jan 2022 19:26:36 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
Message-ID: <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>


>> I made also an attempt on Windows and so far my findings are:

>> The docs say that the PROJ variables should be

>> PROJ_INCLUDE_DIR
>> PROJ_LIBRARY_RELEASE

>> But the lib var must in fact be

>> PROJ_LIBRARY

> How do you build exactly ?

> If you build with "cmake --build . --config Release" then I believe PROJ_LIBRARY_RELEASE should be honored. Perhaps if you don't specify a configuration (is it possible with MSVC CMake builds ? I don't have a VM started right now), then PROJ_LIBRARY will be used.

I build with Ninja and by including a ConfigUser.make file (like GMT and NetCDF do) that is made of lines like

	set(PROJ_INCLUDE_DIR "C:/programs/compa_libs/proj5_GIT/compileds/VC14_64/include")
	set(PROJ_LIBRARY "C:/programs/compa_libs/proj5_GIT/compileds/VC14_64/lib/proj.lib")

I also built all the dependencies myself. I do this because I want to be able to control the dll file name (I'll get back to this in a future thread).

>> Couldn't yet find a way to build with HDF5, ECW and MRSID, which I can do with no problems with the current nmake solution.

> HDF5 1.12.1 is tested with Windows Conda builds


HDF5 is a bit confusing. Here I use the same settings that I use to build NetCDF, some settings are likely repeated but it works to build netCDF

set(HDF5_path C:/programs/compa_libs/hdf5-1.10.5)
set(HDF5_ROOT_DIR ${HDF5_path}/compileds/VC14_64)
set(HDF5_INCLUDE_DIRS ${HDF5_path}/compileds/VC14_32/include)
set(HDF5_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_64/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)
set(HDF5_HL_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)

but the build complains with

-- Could NOT find HDF5 (missing: HDF5_LIBRARIES HDF5_INCLUDE_DIRS) (found version "1.10.5")

>> For ECW, it looks like I tested on Windows with ECW 5.5

I use SDK 3.3 and

-- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")

> For MrSID, not sure I tested on Windows. Works on Linux with
DSDK-9.5.4.4709-rhel6

I don't really know what to set in this one. I have MrSID_DSDK-8.5.0.3422, that works in the nmake build

	set(MRSID_INCLUDE_DIR "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/include")
	set(MRSID_LIBRARY "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/lib/lti_dsdk.lib")

and get

-- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")

From even.rouault at spatialys.com  Tue Jan 25 11:57:04 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Jan 2022 20:57:04 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>


>
> HDF5 is a bit confusing. Here I use the same settings that I use to build NetCDF, some settings are likely repeated but it works to build netCDF
>
> set(HDF5_path C:/programs/compa_libs/hdf5-1.10.5)
> set(HDF5_ROOT_DIR ${HDF5_path}/compileds/VC14_64)
> set(HDF5_INCLUDE_DIRS ${HDF5_path}/compileds/VC14_32/include)
> set(HDF5_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_64/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)
> set(HDF5_HL_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)
>
> but the build complains with
>
> -- Could NOT find HDF5 (missing: HDF5_LIBRARIES HDF5_INCLUDE_DIRS) (found version "1.10.5")

GDAL use the FindHDF5.cmake module provided by CMake itself : 
https://cmake.org/cmake/help/latest/module/FindHDF5.html / 
https://github.com/Kitware/CMake/blob/master/Modules/FindHDF5.cmake

I doubt you can directly specify HDF5_INCLUDE_DIRS, HDF5_LIBRARIES and 
HDF5_HL_LIBRARIES as they are output variables of the FindHDF5 module, 
not input variables

I'd say you should rather set HDF5_ROOT=${HDF5_path}/compileds/VC14_64

You may instrument the FindHDF5.cmake file to have more details

>
>>> For ECW, it looks like I tested on Windows with ECW 5.5
> I use SDK 3.3 and
>
> -- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")

If you have a standard layout ( ${prefix}/include and ${prefix}/lib ) 
then specifying ECW_ROOT=${prefix} should normally work out of the box.

Logic is at 
https://github.com/OSGeo/gdal/blob/master/cmake/modules/packages/FindECW.cmake

>
>> For MrSID, not sure I tested on Windows. Works on Linux with
> DSDK-9.5.4.4709-rhel6
>
> I don't really know what to set in this one. I have MrSID_DSDK-8.5.0.3422, that works in the nmake build
>
> 	set(MRSID_INCLUDE_DIR "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/include")
> 	set(MRSID_LIBRARY "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/lib/lti_dsdk.lib")
Looks good. If you want to debug the logic, it is at 
https://github.com/OSGeo/gdal/blob/master/cmake/modules/packages/FindMRSID.cmake
> and get
>
> -- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")
That's not the right message

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Jan 25 15:34:13 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 00:34:13 +0100
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
Message-ID: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>

Hi,

I'd like to motion to grant github commit rights to Nyall. We don't have 
much people currently doing reviews of pull requests and pressing the 
"Merge" button, and Nyall is definitely in a capacity of fulfilling this 
responsibility, at least in the areas where he fills comfortable. His 
own pull requests are of excellent quality and he's one of the few to 
review my work.

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From schwehr at gmail.com  Tue Jan 25 15:43:13 2022
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 25 Jan 2022 15:43:13 -0800
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <CACmBxytEKC4-GArGwggc==QjyJJkPHp0qTJXEAK_aqROfk4oaA@mail.gmail.com>

+1 KurtS

On Tue, Jan 25, 2022 at 3:34 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I'd like to motion to grant github commit rights to Nyall. We don't have
> much people currently doing reviews of pull requests and pressing the
> "Merge" button, and Nyall is definitely in a capacity of fulfilling this
> responsibility, at least in the areas where he fills comfortable. His
> own pull requests are of excellent quality and he's one of the few to
> review my work.
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220125/35d17fac/attachment.html>

From dmorissette at mapgears.com  Tue Jan 25 18:12:36 2022
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 25 Jan 2022 21:12:36 -0500
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <a63568ee-1de2-b033-e29e-3a144ffdb0c7@mapgears.com>

+1

Daniel


On 2022-01-25 18:34, Even Rouault wrote:
> Hi,
> 
> I'd like to motion to grant github commit rights to Nyall. We don't have 
> much people currently doing reviews of pull requests and pressing the 
> "Merge" button, and Nyall is definitely in a capacity of fulfilling this 
> responsibility, at least in the areas where he fills comfortable. His 
> own pull requests are of excellent quality and he's one of the few to 
> review my work.
> 
> Starting with my +1
> 
> Even
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From warmerdam at pobox.com  Tue Jan 25 19:42:07 2022
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 25 Jan 2022 22:42:07 -0500
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <a63568ee-1de2-b033-e29e-3a144ffdb0c7@mapgears.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
 <a63568ee-1de2-b033-e29e-3a144ffdb0c7@mapgears.com>
Message-ID: <CA+YzLBd+iK7nUofDsS57Mj8RdSJ-wRH8vvKoGQaC0DCwFZk8wg@mail.gmail.com>

+1 FrankW

On Tue, Jan 25, 2022 at 9:12 PM Daniel Morissette <dmorissette at mapgears.com>
wrote:

> +1
>
> Daniel
>
>
> On 2022-01-25 18:34, Even Rouault wrote:
> > Hi,
> >
> > I'd like to motion to grant github commit rights to Nyall. We don't have
> > much people currently doing reviews of pull requests and pressing the
> > "Merge" button, and Nyall is definitely in a capacity of fulfilling this
> > responsibility, at least in the areas where he fills comfortable. His
> > own pull requests are of excellent quality and he's one of the few to
> > review my work.
> >
> > Starting with my +1
> >
> > Even
> >
>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220125/a1a6fa4e/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jan 25 23:50:57 2022
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 26 Jan 2022 07:50:57 +0000
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <bf70d3ccd0744e10844b5719270af6a0@maanmittauslaitos.fi>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: keskiviikko 26. tammikuuta 2022 1.34
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: grant github commit rights to Nyall Dawson

Hi,

I'd like to motion to grant github commit rights to Nyall. We don't have much people currently doing reviews of pull requests and pressing the "Merge" button, and Nyall is definitely in a capacity of fulfilling this responsibility, at least in the areas where he fills comfortable. His own pull requests are of excellent quality and he's one of the few to review my work.

Starting with my +1

Even

--
http://www.spatialys.com
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From mateusz at loskot.net  Wed Jan 26 01:31:36 2022
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 26 Jan 2022 10:31:36 +0100
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <CABUeae-YLJGkcM5mvOuKexO4dUZJ5J8FUjkyhFNyvgN5Ar4M9Q@mail.gmail.com>

+1  Mateusz

On Wed, 26 Jan 2022 at 00:34, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> I'd like to motion to grant github commit rights to Nyall. We don't have
> much people currently doing reviews of pull requests and pressing the
> "Merge" button, and Nyall is definitely in a capacity of fulfilling this
> responsibility, at least in the areas where he fills comfortable. His
> own pull requests are of excellent quality and he's one of the few to
> review my work.
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From momtchil at momtchev.com  Wed Jan 26 02:21:26 2022
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Wed, 26 Jan 2022 11:21:26 +0100
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
In-Reply-To: <1643002567.238829295@apps.rackspace.com>
References: <1643002567.238829295@apps.rackspace.com>
Message-ID: <70619c98-1b82-3767-843a-6e9afa4b1a23@momtchev.com>


Can you post your C++ code? Generally, you have more chances of getting 
an answer for this type of question on https://gis.stackexchange.com/


On 24/01/2022 06:36, dthorne at pivotmaritime.com wrote:
>
> Hi,
> So I am trying to get a test C++ project built to read S57 files using 
> the gdal/ogr C++ library.
> I have previously used the C# library that is on there NuGet manager 
> which states v2.4.4 and that seems to read the s57 without issues. 
> Also tried python and that seems to read it with no issues.
>
> However, I am having a problem with the C++ test project. Having built 
> the C++ library into the .lib and .dll files I have included them into 
> a blank project and implemented the functions to read the s57 file, 
> however it is only reporting 5 layers.
> These 5 layers are the same no matter the s57 file. And 4 out of those 
> 5 layers are not actually layers.
> Using the autotest generated s57 file as a unit test to cross check, 
> there is supposed to be 13 layers.
>
> Note: I had feedback from Even indicating the setup environment is 
> probably wrong. And to set up the GDAL_DATA environment variable, so 
> we've made an environment variable referencing the gdal/data folder 
> and that hasn't fixed the problem, but I think it's on the right track 
> as Even said they could reproduce the problem if not setup correctly.
>
> *Has anyone had success reading s57 files with a C++ 3.4.1. project 
> that could possibly help?get this going?*
>
> Link to reference Image: https://imgur.com/a/KwmqZSe
>
>
> Regards,
> Daniel
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Momtchil Momtchev<momtchil at momtchev.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/6b6a53c4/attachment-0001.html>

From apschwimmer at apmland.de  Wed Jan 26 03:14:56 2022
From: apschwimmer at apmland.de (APM)
Date: Wed, 26 Jan 2022 12:14:56 +0100
Subject: [gdal-dev] Add elevation data to gpx files
Message-ID: <6877020f-ee60-7b22-00f1-493d09ecf474@apmland.de>

Dear List,


I like to add elevation data to some gpx files by using ogr directly.


The actual files are containing for example:


<trk>
 ? <name> town </name>
 ?? <trkseg>
 ??? <trkpt lat="xxx" lon= "yyy"/>


etc ....


Before I asked I created a point layer with DEM data in Qgis 3.22.3. by 
using the "Point sampling tool" and

imported the gpx.

I use http://www.viewfinderpanoramas.org/ as DEM source and create a 
.vrt Raster from it.

Now I have a shape which is containing two attribute fields "fid" and 
"dem", which shows correct DEM data according to the gpx-points.


But I can't create an assembled new gpx file which include something like


<trkpt lat="xxx" lon="yyy"/>

<ele>210</ele>


etc...


I would be glad for some help!


Thank you very much!


Kind regards


Piet





From jluis at ualg.pt  Wed Jan 26 06:28:14 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 14:28:14 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
Message-ID: <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>


Some more news on this before I lose track of it.

Couldn't find a way to build against my HDF5 1.10.5 (everything I tried failed) so built HDF51.12.1 and now simple setting

set(HDF5_ROOT "C:/programs/compa_libs/hdf5-1.12.1/compileds/VC14_64")

finds it and no more troubles (yet found)

But I found two other new issues when adding more dependencies

1.
C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45): fatal error C1083: Cannot open include file: 'zlib.h': No such file or directory

To work around this, I temporarily added zlib.h and zconf.h to frmts\mbtiles  

2.
C:\programs\compa_libs\libxml2-2.9.1\compileds\VC14_64\include\libxml/encoding.h(28): fatal error C1083: Cannot open include file: 'iconv.h': No such file or directory

Didn't try to find a fix to this one.

>
> HDF5 is a bit confusing. Here I use the same settings that I use to 
> build NetCDF, some settings are likely repeated but it works to build 
> netCDF
>
> set(HDF5_path C:/programs/compa_libs/hdf5-1.10.5)
> set(HDF5_ROOT_DIR ${HDF5_path}/compileds/VC14_64) 
> set(HDF5_INCLUDE_DIRS ${HDF5_path}/compileds/VC14_32/include)
> set(HDF5_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_64/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)
> set(HDF5_HL_LIBRARIES ${HDF5_path}/compileds/VC14_64/lib/hdf5.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_hl_cpp.lib 	${HDF5_path}/compileds/VC14_${BITAGE}/lib/hdf5_cpp.lib)
>
> but the build complains with
>
> -- Could NOT find HDF5 (missing: HDF5_LIBRARIES HDF5_INCLUDE_DIRS) 
> (found version "1.10.5")

GDAL use the FindHDF5.cmake module provided by CMake itself : 
https://cmake.org/cmake/help/latest/module/FindHDF5.html / https://github.com/Kitware/CMake/blob/master/Modules/FindHDF5.cmake

I doubt you can directly specify HDF5_INCLUDE_DIRS, HDF5_LIBRARIES and HDF5_HL_LIBRARIES as they are output variables of the FindHDF5 module, not input variables

I'd say you should rather set HDF5_ROOT=${HDF5_path}/compileds/VC14_64

You may instrument the FindHDF5.cmake file to have more details

>
>>> For ECW, it looks like I tested on Windows with ECW 5.5
> I use SDK 3.3 and
>
> -- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY 
> NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")

If you have a standard layout ( ${prefix}/include and ${prefix}/lib ) then specifying ECW_ROOT=${prefix} should normally work out of the box.

Logic is at
https://github.com/OSGeo/gdal/blob/master/cmake/modules/packages/FindECW.cmake

>
>> For MrSID, not sure I tested on Windows. Works on Linux with
> DSDK-9.5.4.4709-rhel6
>
> I don't really know what to set in this one. I have 
> MrSID_DSDK-8.5.0.3422, that works in the nmake build
>
> 	set(MRSID_INCLUDE_DIR "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/include")
> 	set(MRSID_LIBRARY 
> "C:/programs/compa_libs/MrSID_DSDK-8.5.0.3422/compileds/VC14_64/lib/lt
> i_dsdk.lib")
Looks good. If you want to debug the logic, it is at https://github.com/OSGeo/gdal/blob/master/cmake/modules/packages/FindMRSID.cmake
> and get
>
> -- Could NOT find ECW (missing: ECWnet_LIBRARY ECWC_LIBRARY 
> NCSUtil_LIBRARY) (found version "NCS_VERSION_NUMBER 3.3.0.161")
That's not the right message

--
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Jan 26 07:09:39 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 16:09:39 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>

Joaquim,
> But I found two other new issues when adding more dependencies
>
> 1.
> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45): fatal error C1083: Cannot open include file: 'zlib.h': No such file or directory
>
> To work around this, I temporarily added zlib.h and zconf.h to frmts\mbtiles
Should be fixed by the first commit of 
https://github.com/OSGeo/gdal/pull/5179
>
> 2.
> C:\programs\compa_libs\libxml2-2.9.1\compileds\VC14_64\include\libxml/encoding.h(28): fatal error C1083: Cannot open include file: 'iconv.h': No such file or directory

Also probably fixed by the second commit of 
https://github.com/OSGeo/gdal/pull/5179

Een

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Jan 26 09:45:49 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 18:45:49 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>


Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
> Joaquim,
>> But I found two other new issues when adding more dependencies
>>
>> 1.
>> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45): fatal error C1083: Cannot open include file: 'zlib.h': No such file or directory
>>
>> To work around this, I temporarily added zlib.h and zconf.h to frmts\mbtiles
> Should be fixed by the first commit of
> https://github.com/OSGeo/gdal/pull/5179
>
> I'm afraid it got worst

-- Configuring done
-- Generating done
-- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build
ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it

I'd say on the contrary that it helped the build to go further, didn't 
it ? My fixes are totally unrelated to a ws2_32.lib missing

I see in configure.ac that we had the following logic

dnl 
---------------------------------------------------------------------------
dnl Check if we need -lws2_32 (mingw)
dnl 
---------------------------------------------------------------------------

echo "#include <winsock2.h>" > test_ws2_32.c
echo "#include <ws2tcpip.h>" >> test_ws2_32.c
echo "void foo() {}" >> test_ws2_32.c

if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
 ? LIBS="$LIBS -lws2_32"
fi
rm -f test_ws2_32*

dnl 
---------------------------------------------------------------------------
dnl Check if we need -lpsapi (mingw)
dnl 
---------------------------------------------------------------------------

echo "#include <windows.h>" > test_psapi.c
echo "#include <psapi.h>" >> test_psapi.c
echo "void foo() {}" >> test_psapi.c

if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
 ? LIBS="$LIBS -lpsapi"
fi
rm -f test_psapi*

This hasn't been ported yet to cmake builds.

I've ticketed that in https://github.com/OSGeo/gdal/issues/5180.

Hum, upon reflection, the error message would seem to indicate that we 
try to link to ws2_32.lib but it is not found in your environemnt

Looking for ws2_32 in cmake build scripts, I see it is referenced in

cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names 
odbccp32;ws2_32)
cmake/modules/packages/FindHDF4.cmake:??????? list(APPEND HDF4_LIBRARIES 
ws2_32.lib)

Do you use any of ODBC or HDF4 in your build ? Could you try to disable 
them and see if it makes a difference ?

Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in 
cmake/modules/packages/FindHDF4.cmake ?

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Wed Jan 26 10:36:08 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 19:36:08 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>


Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit?:
>
> I do have HDF4 but before I was able to build till the end. I've here 
> a gdal_w64.dll smiling to me. That's why I said it got worst.
>
Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 
<https://github.com/OSGeo/gdal/pull/5179> helping or not ?? If not 
helping, which commit in it is causing an issue ?
>
> Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
> >
>
> > Joaquim,
>
> >> But I found two other new issues when adding more dependencies
>
> >>
>
> >> 1.
>
> >> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):
>
> >> fatal error C1083: Cannot open include file: 'zlib.h': No such file
>
> >> or directory
>
> >>
>
> >> To work around this, I temporarily added zlib.h and zconf.h to
>
> >> frmts\mbtiles
>
> > Should be fixed by the first commit of
>
> > https://github.com/OSGeo/gdal/pull/5179 
> <https://github.com/OSGeo/gdal/pull/5179>
>
> >
>
> > I'm afraid it got worst
>
> -- Configuring done
>
> -- Generating done
>
> -- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build
>
> ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no 
> known rule to make it
>
> I'd say on the contrary that it helped the build to go further, didn't 
> it ? My fixes are totally unrelated to a ws2_32.lib missing
>
> I see in configure.ac that we had the following logic
>
> dnl
>
> ---------------------------------------------------------------------------
>
> dnl Check if we need -lws2_32 (mingw)
>
> dnl
>
> ---------------------------------------------------------------------------
>
> echo "#include <winsock2.h>" > test_ws2_32.c echo "#include 
> <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c
>
> if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
>
> ? LIBS="$LIBS -lws2_32"
>
> fi
>
> rm -f test_ws2_32*
>
> dnl
>
> ---------------------------------------------------------------------------
>
> dnl Check if we need -lpsapi (mingw)
>
> dnl
>
> ---------------------------------------------------------------------------
>
> echo "#include <windows.h>" > test_psapi.c echo "#include <psapi.h>" 
> >> test_psapi.c echo "void foo() {}" >> test_psapi.c
>
> if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
>
> ? LIBS="$LIBS -lpsapi"
>
> fi
>
> rm -f test_psapi*
>
> This hasn't been ported yet to cmake builds.
>
> I've ticketed that in https://github.com/OSGeo/gdal/issues/5180 
> <https://github.com/OSGeo/gdal/issues/5180>.
>
> Hum, upon reflection, the error message would seem to indicate that we 
> try to link to ws2_32.lib but it is not found in your environemnt
>
> Looking for ws2_32 in cmake build scripts, I see it is referenced in
>
> cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names
>
> odbccp32;ws2_32)
>
> cmake/modules/packages/FindHDF4.cmake: list(APPEND HDF4_LIBRARIES
>
> ws2_32.lib)
>
> Do you use any of ODBC or HDF4 in your build ? Could you try to 
> disable them and see if it makes a difference ?
>
> Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in 
> cmake/modules/packages/FindHDF4.cmake ?
>
> Even
>
> --
>
> http://www.spatialys.com <http://www.spatialys.com>
>
> My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/37daa6d7/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 57869 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/37daa6d7/attachment-0001.png>

From jluis at ualg.pt  Wed Jan 26 10:43:35 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 18:43:35 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
Message-ID: <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>

Don?t know which commit did it. Updated this afternoon and started to erroring right away with missing 'ws2_32.lib`

From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:36 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] cmake status update - 99% good news!



Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit :

I do have HDF4 but before I was able to build till the end. I've here a gdal_w64.dll smiling to me. That's why I said it got worst.
Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 helping or not ?  If not helping, which commit in it is causing an issue ?




[cid:image001.png at 01D812E4.9E542DF0]



Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit :

>

> Joaquim,

>> But I found two other new issues when adding more dependencies

>>

>> 1.

>> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):

>> fatal error C1083: Cannot open include file: 'zlib.h': No such file

>> or directory

>>

>> To work around this, I temporarily added zlib.h and zconf.h to

>> frmts\mbtiles

> Should be fixed by the first commit of

> https://github.com/OSGeo/gdal/pull/5179

>

> I'm afraid it got worst



-- Configuring done

-- Generating done

-- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build

ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it



I'd say on the contrary that it helped the build to go further, didn't it ? My fixes are totally unrelated to a ws2_32.lib missing



I see in configure.ac that we had the following logic



dnl

---------------------------------------------------------------------------

dnl Check if we need -lws2_32 (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <winsock2.h>" > test_ws2_32.c echo "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c



if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then

  LIBS="$LIBS -lws2_32"

fi

rm -f test_ws2_32*



dnl

---------------------------------------------------------------------------

dnl Check if we need -lpsapi (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <windows.h>" > test_psapi.c echo "#include <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c



if test -z "`${CC} -c test_psapi.c 2>&1`" ; then

  LIBS="$LIBS -lpsapi"

fi

rm -f test_psapi*



This hasn't been ported yet to cmake builds.



I've ticketed that in https://github.com/OSGeo/gdal/issues/5180.



Hum, upon reflection, the error message would seem to indicate that we try to link to ws2_32.lib but it is not found in your environemnt



Looking for ws2_32 in cmake build scripts, I see it is referenced in



cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names

odbccp32;ws2_32)

cmake/modules/packages/FindHDF4.cmake:        list(APPEND HDF4_LIBRARIES

ws2_32.lib)



Do you use any of ODBC or HDF4 in your build ? Could you try to disable them and see if it makes a difference ?



Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in cmake/modules/packages/FindHDF4.cmake ?



Even



--

http://www.spatialys.com

My software is free, but my time generally not.



--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/d8a2db0c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 57869 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/d8a2db0c/attachment-0001.png>

From even.rouault at spatialys.com  Wed Jan 26 10:49:55 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 19:49:55 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>

did you update to master or did you try my pull request (not merged yet) ?

If only master, can you try to change the reference to "ws2_32.lib" to 
"ws2_32" in cmake/modules/packages/FindHDF4.cmake as I suggested ?

Or perhaps change the if (WIN32) at line 91 to if (MSVC)

Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit?:
>
> Don?t know which commit did it. Updated this afternoon and started to 
> erroring right away with missing 'ws2_32.lib`
>
> *From:*Even Rouault <even.rouault at spatialys.com>
> *Sent:* Wednesday, January 26, 2022 6:36 PM
> *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
> Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     I do have HDF4 but before I was able to build till the end. I've
>     here a gdal_w64.dll smiling to me. That's why I said it got worst.
>
> Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 
> <https://github.com/OSGeo/gdal/pull/5179> helping or not ?? If not 
> helping, which commit in it is causing an issue ?
>
>     Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     >
>
>     > Joaquim,
>
>     >> But I found two other new issues when adding more dependencies
>
>     >>
>
>     >> 1.
>
>     >>
>     C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):
>
>     >> fatal error C1083: Cannot open include file: 'zlib.h': No such
>     file
>
>     >> or directory
>
>     >>
>
>     >> To work around this, I temporarily added zlib.h and zconf.h to
>
>     >> frmts\mbtiles
>
>     > Should be fixed by the first commit of
>
>     > https://github.com/OSGeo/gdal/pull/5179
>     <https://github.com/OSGeo/gdal/pull/5179>
>
>     >
>
>     > I'm afraid it got worst
>
>     -- Configuring done
>
>     -- Generating done
>
>     -- Build files have been written to:
>     C:/programs/compa_libs/gdal_GIT/build
>
>     ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and
>     no known rule to make it
>
>     I'd say on the contrary that it helped the build to go further,
>     didn't it ? My fixes are totally unrelated to a ws2_32.lib missing
>
>     I see in configure.ac that we had the following logic
>
>     dnl
>
>     ---------------------------------------------------------------------------
>
>     dnl Check if we need -lws2_32 (mingw)
>
>     dnl
>
>     ---------------------------------------------------------------------------
>
>     echo "#include <winsock2.h>" > test_ws2_32.c echo "#include
>     <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c
>
>     if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
>
>     ? LIBS="$LIBS -lws2_32"
>
>     fi
>
>     rm -f test_ws2_32*
>
>     dnl
>
>     ---------------------------------------------------------------------------
>
>     dnl Check if we need -lpsapi (mingw)
>
>     dnl
>
>     ---------------------------------------------------------------------------
>
>     echo "#include <windows.h>" > test_psapi.c echo "#include
>     <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c
>
>     if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
>
>     ? LIBS="$LIBS -lpsapi"
>
>     fi
>
>     rm -f test_psapi*
>
>     This hasn't been ported yet to cmake builds.
>
>     I've ticketed that in https://github.com/OSGeo/gdal/issues/5180
>     <https://github.com/OSGeo/gdal/issues/5180>.
>
>     Hum, upon reflection, the error message would seem to indicate
>     that we try to link to ws2_32.lib but it is not found in your
>     environemnt
>
>     Looking for ws2_32 in cmake build scripts, I see it is referenced in
>
>     cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names
>
>     odbccp32;ws2_32)
>
>     cmake/modules/packages/FindHDF4.cmake: list(APPEND HDF4_LIBRARIES
>
>     ws2_32.lib)
>
>     Do you use any of ODBC or HDF4 in your build ? Could you try to
>     disable them and see if it makes a difference ?
>
>     Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in
>     cmake/modules/packages/FindHDF4.cmake ?
>
>     Even
>
>     --
>
>     http://www.spatialys.com <http://www.spatialys.com>
>
>     My software is free, but my time generally not.
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/905f7e95/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 57869 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/905f7e95/attachment-0001.png>

From jluis at ualg.pt  Wed Jan 26 11:12:45 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 19:12:45 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
Message-ID: <AM6PR04MB3959C052A75F8C888246B95FA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>

Updated master (sorry, didn?t stop to think if the commit had been merged)

However, I have cmake 3.22.1 but it doesn?t have a FindHDF4.cmake, only a FinfHDF5

I was building with

               set(HDF4_INCLUDE_DIR C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
               set(HDF4_df_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
           set(HDF4_mfhdf_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)

and when I commented those lines the build advance ? till it stop at the ?Cannot open include file: 'zlib.h'? but that is normal since I?m not using the commit who fixed it.


From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:50 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] cmake status update - 99% good news!


did you update to master or did you try my pull request (not merged yet) ?

If only master, can you try to change the reference to "ws2_32.lib" to "ws2_32" in cmake/modules/packages/FindHDF4.cmake as I suggested ?

Or perhaps change the if (WIN32) at line 91 to if (MSVC)
Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit :
Don?t know which commit did it. Updated this afternoon and started to erroring right away with missing 'ws2_32.lib`

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:36 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] cmake status update - 99% good news!



Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit :

I do have HDF4 but before I was able to build till the end. I've here a gdal_w64.dll smiling to me. That's why I said it got worst.
Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 helping or not ?  If not helping, which commit in it is causing an issue ?









Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit :

>

> Joaquim,

>> But I found two other new issues when adding more dependencies

>>

>> 1.

>> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):

>> fatal error C1083: Cannot open include file: 'zlib.h': No such file

>> or directory

>>

>> To work around this, I temporarily added zlib.h and zconf.h to

>> frmts\mbtiles

> Should be fixed by the first commit of

> https://github.com/OSGeo/gdal/pull/5179

>

> I'm afraid it got worst



-- Configuring done

-- Generating done

-- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build

ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it



I'd say on the contrary that it helped the build to go further, didn't it ? My fixes are totally unrelated to a ws2_32.lib missing



I see in configure.ac that we had the following logic



dnl

---------------------------------------------------------------------------

dnl Check if we need -lws2_32 (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <winsock2.h>" > test_ws2_32.c echo "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c



if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then

  LIBS="$LIBS -lws2_32"

fi

rm -f test_ws2_32*



dnl

---------------------------------------------------------------------------

dnl Check if we need -lpsapi (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <windows.h>" > test_psapi.c echo "#include <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c



if test -z "`${CC} -c test_psapi.c 2>&1`" ; then

  LIBS="$LIBS -lpsapi"

fi

rm -f test_psapi*



This hasn't been ported yet to cmake builds.



I've ticketed that in https://github.com/OSGeo/gdal/issues/5180.



Hum, upon reflection, the error message would seem to indicate that we try to link to ws2_32.lib but it is not found in your environemnt



Looking for ws2_32 in cmake build scripts, I see it is referenced in



cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names

odbccp32;ws2_32)

cmake/modules/packages/FindHDF4.cmake:        list(APPEND HDF4_LIBRARIES

ws2_32.lib)



Do you use any of ODBC or HDF4 in your build ? Could you try to disable them and see if it makes a difference ?



Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in cmake/modules/packages/FindHDF4.cmake ?



Even



--

http://www.spatialys.com

My software is free, but my time generally not.



--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/8545707e/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jan 26 11:23:47 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 20:23:47 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>


Le 26/01/2022 ? 20:08, Joaquim Manuel Freire Lu?s a ?crit?:
>
> Updated master (sorry, didn?t stop to think if the commit had been merged)
>
> However, I have cmake 3.22.1 but it doesn?t have a FindHDF4.cmake, 
> only a FinfHDF5
>
FindHDF4.cmake is in the GDAL repository, in 
cmake/modules/packages/FindHDF4.cmake, so you can try editing it locally 
with my below suggestions
>
> I was building with
>
> ?????????????? set(HDF4_INCLUDE_DIR 
> C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
>
> ?????????????? set(HDF4_df_LIBRARY_RELEASE 
> C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
>
> ?????????? set(HDF4_mfhdf_LIBRARY_RELEASE 
> C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)
>
> and when I commented those lines the build advance ? till it stop at 
> the ?Cannot open include file: 'zlib.h'? but that is normal since I?m 
> not using the commit who fixed it.
>
> *From:*Even Rouault <even.rouault at spatialys.com>
> *Sent:* Wednesday, January 26, 2022 6:50 PM
> *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
> did you update to master or did you try my pull request (not merged yet) ?
>
> If only master, can you try to change the reference to "ws2_32.lib" to 
> "ws2_32" in cmake/modules/packages/FindHDF4.cmake as I suggested ?
>
> Or perhaps change the if (WIN32) at line 91 to if (MSVC)
>
> Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     Don?t know which commit did it. Updated this afternoon and started
>     to erroring right away with missing 'ws2_32.lib`
>
>     *From:*Even Rouault <even.rouault at spatialys.com>
>     <mailto:even.rouault at spatialys.com>
>     *Sent:* Wednesday, January 26, 2022 6:36 PM
>     *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
>     <mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org
>     *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
>     Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit?:
>
>         I do have HDF4 but before I was able to build till the end.
>         I've here a gdal_w64.dll smiling to me. That's why I said it
>         got worst.
>
>     Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179
>     <https://github.com/OSGeo/gdal/pull/5179> helping or not ?? If not
>     helping, which commit in it is causing an issue ?
>
>
>         Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
>         >
>
>         > Joaquim,
>
>         >> But I found two other new issues when adding more dependencies
>
>         >>
>
>         >> 1.
>
>         >>
>         C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):
>
>
>         >> fatal error C1083: Cannot open include file: 'zlib.h': No
>         such file
>
>         >> or directory
>
>         >>
>
>         >> To work around this, I temporarily added zlib.h and zconf.h to
>
>         >> frmts\mbtiles
>
>         > Should be fixed by the first commit of
>
>         > https://github.com/OSGeo/gdal/pull/5179
>         <https://github.com/OSGeo/gdal/pull/5179>
>
>         >
>
>         > I'm afraid it got worst
>
>         -- Configuring done
>
>         -- Generating done
>
>         -- Build files have been written to:
>         C:/programs/compa_libs/gdal_GIT/build
>
>         ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing
>         and no known rule to make it
>
>         I'd say on the contrary that it helped the build to go
>         further, didn't it ? My fixes are totally unrelated to a
>         ws2_32.lib missing
>
>         I see in configure.ac that we had the following logic
>
>         dnl
>
>         ---------------------------------------------------------------------------
>
>         dnl Check if we need -lws2_32 (mingw)
>
>         dnl
>
>         ---------------------------------------------------------------------------
>
>         echo "#include <winsock2.h>" > test_ws2_32.c echo "#include
>         <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >>
>         test_ws2_32.c
>
>         if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
>
>         ? LIBS="$LIBS -lws2_32"
>
>         fi
>
>         rm -f test_ws2_32*
>
>         dnl
>
>         ---------------------------------------------------------------------------
>
>         dnl Check if we need -lpsapi (mingw)
>
>         dnl
>
>         ---------------------------------------------------------------------------
>
>         echo "#include <windows.h>" > test_psapi.c echo "#include
>         <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c
>
>         if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
>
>         ? LIBS="$LIBS -lpsapi"
>
>         fi
>
>         rm -f test_psapi*
>
>         This hasn't been ported yet to cmake builds.
>
>         I've ticketed that in
>         https://github.com/OSGeo/gdal/issues/5180
>         <https://github.com/OSGeo/gdal/issues/5180>.
>
>         Hum, upon reflection, the error message would seem to indicate
>         that we try to link to ws2_32.lib but it is not found in your
>         environemnt
>
>         Looking for ws2_32 in cmake build scripts, I see it is
>         referenced in
>
>         cmake/modules/packages/FindODBC.cmake:
>         set(_odbc_required_libs_names
>
>         odbccp32;ws2_32)
>
>         cmake/modules/packages/FindHDF4.cmake: list(APPEND HDF4_LIBRARIES
>
>         ws2_32.lib)
>
>         Do you use any of ODBC or HDF4 in your build ? Could you try
>         to disable them and see if it makes a difference ?
>
>         Or maybe if you've HDF4, try to change the ws2_32.lib to
>         ws2_32 in cmake/modules/packages/FindHDF4.cmake ?
>
>         Even
>
>         --
>
>         http://www.spatialys.com <http://www.spatialys.com>
>
>         My software is free, but my time generally not.
>
>     -- 
>
>     http://www.spatialys.com
>
>     My software is free, but my time generally not.
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/88c2c61a/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 57869 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/88c2c61a/attachment-0001.png>

From jluis at ualg.pt  Wed Jan 26 11:26:02 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 19:26:02 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
Message-ID: <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>



Ok, sorry you meant the FindHDF4.cmake that comes with GDAL. Doing what you suggested (tried both) makes no difference but commenting

    if(WIN32)
        #list(APPEND HDF4_LIBRARIES ws2_32.lib)
    endif()

makes the ws2_32 trouble go.


Le 26/01/2022 ? 20:08, Joaquim Manuel Freire Lu?s a ?crit :
Updated master (sorry, didn?t stop to think if the commit had been merged)

However, I have cmake 3.22.1 but it doesn?t have a FindHDF4.cmake, only a FinfHDF5
FindHDF4.cmake is in the GDAL repository, in cmake/modules/packages/FindHDF4.cmake, so you can try editing it locally with my below suggestions


I was building with

               set(HDF4_INCLUDE_DIR C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
               set(HDF4_df_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
           set(HDF4_mfhdf_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)

and when I commented those lines the build advance ? till it stop at the ?Cannot open include file: 'zlib.h'? but that is normal since I?m not using the commit who fixed it.

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:50 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] cmake status update - 99% good news!


did you update to master or did you try my pull request (not merged yet) ?

If only master, can you try to change the reference to "ws2_32.lib" to "ws2_32" in cmake/modules/packages/FindHDF4.cmake as I suggested ?

Or perhaps change the if (WIN32) at line 91 to if (MSVC)
Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit :
Don?t know which commit did it. Updated this afternoon and started to erroring right away with missing 'ws2_32.lib`

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:36 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] cmake status update - 99% good news!



Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit :

I do have HDF4 but before I was able to build till the end. I've here a gdal_w64.dll smiling to me. That's why I said it got worst.
Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 helping or not ?  If not helping, which commit in it is causing an issue ?










Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit :

>

> Joaquim,

>> But I found two other new issues when adding more dependencies

>>

>> 1.

>> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):

>> fatal error C1083: Cannot open include file: 'zlib.h': No such file

>> or directory

>>

>> To work around this, I temporarily added zlib.h and zconf.h to

>> frmts\mbtiles

> Should be fixed by the first commit of

> https://github.com/OSGeo/gdal/pull/5179

>

> I'm afraid it got worst



-- Configuring done

-- Generating done

-- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build

ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it



I'd say on the contrary that it helped the build to go further, didn't it ? My fixes are totally unrelated to a ws2_32.lib missing



I see in configure.ac that we had the following logic



dnl

---------------------------------------------------------------------------

dnl Check if we need -lws2_32 (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <winsock2.h>" > test_ws2_32.c echo "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c



if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then

  LIBS="$LIBS -lws2_32"

fi

rm -f test_ws2_32*



dnl

---------------------------------------------------------------------------

dnl Check if we need -lpsapi (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <windows.h>" > test_psapi.c echo "#include <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c



if test -z "`${CC} -c test_psapi.c 2>&1`" ; then

  LIBS="$LIBS -lpsapi"

fi

rm -f test_psapi*



This hasn't been ported yet to cmake builds.



I've ticketed that in https://github.com/OSGeo/gdal/issues/5180.



Hum, upon reflection, the error message would seem to indicate that we try to link to ws2_32.lib but it is not found in your environemnt



Looking for ws2_32 in cmake build scripts, I see it is referenced in



cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names

odbccp32;ws2_32)

cmake/modules/packages/FindHDF4.cmake:        list(APPEND HDF4_LIBRARIES

ws2_32.lib)



Do you use any of ODBC or HDF4 in your build ? Could you try to disable them and see if it makes a difference ?



Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in cmake/modules/packages/FindHDF4.cmake ?



Even



--

http://www.spatialys.com

My software is free, but my time generally not.



--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/6807bc87/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jan 26 11:33:57 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 20:33:57 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
 <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>


Le 26/01/2022 ? 20:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
> Ok, sorry you meant the FindHDF4.cmake that comes with GDAL. Doing 
> what you suggested (tried both) makes no difference but commenting
>
> ??? if(WIN32)
>
> ??????? #list(APPEND HDF4_LIBRARIES ws2_32.lib)
>
> ??? endif()
>
> makes the ws2_32 trouble go.
>
Ah my if(MSVC) suggestion was because I wrongly assumed you used mingw 
(the _w64.dll suffix made me thing of mingw64), but I see the VC14 so 
you use MSVC.

Can you try this then ?

if (WIN32)

 ?? find_library(WS2_32_LIBRARY ws2_32)

 ?? if( WS2_32_LIBRARY )

list(APPEND HDF4_LIBRARIES ${WS2_32_LIBRARY})

 ?? endif()

endif()



> Le 26/01/2022 ? 20:08, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     Updated master (sorry, didn?t stop to think if the commit had been
>     merged)
>
>     However, I have cmake 3.22.1 but it doesn?t have a FindHDF4.cmake,
>     only a FinfHDF5
>
> FindHDF4.cmake is in the GDAL repository, in 
> cmake/modules/packages/FindHDF4.cmake, so you can try editing it 
> locally with my below suggestions
>
>     I was building with
>
>     ?????????????? set(HDF4_INCLUDE_DIR
>     C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
>
>     ?????????????? set(HDF4_df_LIBRARY_RELEASE
>     C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
>
>     ?????????? set(HDF4_mfhdf_LIBRARY_RELEASE
>     C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)
>
>     and when I commented those lines the build advance ? till it stop
>     at the ?Cannot open include file: 'zlib.h'? but that is normal
>     since I?m not using the commit who fixed it.
>
>     *From:*Even Rouault <even.rouault at spatialys.com>
>     <mailto:even.rouault at spatialys.com>
>     *Sent:* Wednesday, January 26, 2022 6:50 PM
>     *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
>     <mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org
>     *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
>     did you update to master or did you try my pull request (not
>     merged yet) ?
>
>     If only master, can you try to change the reference to
>     "ws2_32.lib" to "ws2_32" in cmake/modules/packages/FindHDF4.cmake
>     as I suggested ?
>
>     Or perhaps change the if (WIN32) at line 91 to if (MSVC)
>
>     Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit?:
>
>         Don?t know which commit did it. Updated this afternoon and
>         started to erroring right away with missing 'ws2_32.lib`
>
>         *From:*Even Rouault <even.rouault at spatialys.com>
>         <mailto:even.rouault at spatialys.com>
>         *Sent:* Wednesday, January 26, 2022 6:36 PM
>         *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
>         <mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org
>         *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
>         Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit?:
>
>             I do have HDF4 but before I was able to build till the
>             end. I've here a gdal_w64.dll smiling to me. That's why I
>             said it got worst.
>
>         Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179
>         <https://github.com/OSGeo/gdal/pull/5179> helping or not ?? If
>         not helping, which commit in it is causing an issue ?
>
>
>
>             Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
>             >
>
>             > Joaquim,
>
>             >> But I found two other new issues when adding more
>             dependencies
>
>             >>
>
>             >> 1.
>
>             >>
>             C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):
>
>
>             >> fatal error C1083: Cannot open include file: 'zlib.h':
>             No such file
>
>             >> or directory
>
>             >>
>
>             >> To work around this, I temporarily added zlib.h and
>             zconf.h to
>
>             >> frmts\mbtiles
>
>             > Should be fixed by the first commit of
>
>             > https://github.com/OSGeo/gdal/pull/5179
>             <https://github.com/OSGeo/gdal/pull/5179>
>
>             >
>
>             > I'm afraid it got worst
>
>             -- Configuring done
>
>             -- Generating done
>
>             -- Build files have been written to:
>             C:/programs/compa_libs/gdal_GIT/build
>
>             ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll',
>             missing and no known rule to make it
>
>             I'd say on the contrary that it helped the build to go
>             further, didn't it ? My fixes are totally unrelated to a
>             ws2_32.lib missing
>
>             I see in configure.ac that we had the following logic
>
>             dnl
>
>             ---------------------------------------------------------------------------
>
>             dnl Check if we need -lws2_32 (mingw)
>
>             dnl
>
>             ---------------------------------------------------------------------------
>
>             echo "#include <winsock2.h>" > test_ws2_32.c echo
>             "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void foo()
>             {}" >> test_ws2_32.c
>
>             if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
>
>             ? LIBS="$LIBS -lws2_32"
>
>             fi
>
>             rm -f test_ws2_32*
>
>             dnl
>
>             ---------------------------------------------------------------------------
>
>             dnl Check if we need -lpsapi (mingw)
>
>             dnl
>
>             ---------------------------------------------------------------------------
>
>             echo "#include <windows.h>" > test_psapi.c echo "#include
>             <psapi.h>" >> test_psapi.c echo "void foo() {}" >>
>             test_psapi.c
>
>             if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
>
>             ? LIBS="$LIBS -lpsapi"
>
>             fi
>
>             rm -f test_psapi*
>
>             This hasn't been ported yet to cmake builds.
>
>             I've ticketed that in
>             https://github.com/OSGeo/gdal/issues/5180
>             <https://github.com/OSGeo/gdal/issues/5180>.
>
>             Hum, upon reflection, the error message would seem to
>             indicate that we try to link to ws2_32.lib but it is not
>             found in your environemnt
>
>             Looking for ws2_32 in cmake build scripts, I see it is
>             referenced in
>
>             cmake/modules/packages/FindODBC.cmake:
>             set(_odbc_required_libs_names
>
>             odbccp32;ws2_32)
>
>             cmake/modules/packages/FindHDF4.cmake: list(APPEND
>             HDF4_LIBRARIES
>
>             ws2_32.lib)
>
>             Do you use any of ODBC or HDF4 in your build ? Could you
>             try to disable them and see if it makes a difference ?
>
>             Or maybe if you've HDF4, try to change the ws2_32.lib to
>             ws2_32 in cmake/modules/packages/FindHDF4.cmake ?
>
>             Even
>
>             --
>
>             http://www.spatialys.com <http://www.spatialys.com>
>
>             My software is free, but my time generally not.
>
>         -- 
>
>         http://www.spatialys.com
>
>         My software is free, but my time generally not.
>
>     -- 
>
>     http://www.spatialys.com
>
>     My software is free, but my time generally not.
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/8a913f35/attachment-0001.html>

From dg0yt at darc.de  Wed Jan 26 11:36:57 2022
From: dg0yt at darc.de (dg0yt at darc.de)
Date: Wed, 26 Jan 2022 20:36:57 +0100 (CET)
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <rmibl09qjlz.fsf@s1.lexort.com>
 <2f273733-93ca-a389-709d-fe7e46fde8e9@spatialys.com>
 <rmi8rv4addk.fsf_-_@s1.lexort.com>
 <AM6PR04MB39592339F64BCFF083938026A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <7b74ebe7-d3d6-7325-6879-cbc71ca11e49@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
Message-ID: <1298059940.132972.1643225817534@office.mailbox.org>


> ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it

'ws2_32.lib' is neither the name of a CMake target nor a flag ('-l'). So it is taken as a file by Ninja. However, Ninja is not the linker and so it doesn't find that file. Solutions:
- '-lws2_32' (assuming mingw)
- 'find_library(...)'

Kai

From jluis at ualg.pt  Wed Jan 26 11:41:07 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 19:41:07 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <AM6PR04MB3959B43566F3C3A3D43DD5F8A65F9@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <35d8ffbf-ebec-27bb-a971-5a6086d77871@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
 <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>
Message-ID: <AM6PR04MB3959D91F3F4464727A057E4EA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>

Yes, I?m using MSVC (2022) and yeap, with that change it works fine.

From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 7:34 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] cmake status update - 99% good news!



Le 26/01/2022 ? 20:26, Joaquim Manuel Freire Lu?s a ?crit :


Ok, sorry you meant the FindHDF4.cmake that comes with GDAL. Doing what you suggested (tried both) makes no difference but commenting

    if(WIN32)
        #list(APPEND HDF4_LIBRARIES ws2_32.lib)
    endif()

makes the ws2_32 trouble go.

Ah my if(MSVC) suggestion was because I wrongly assumed you used mingw (the _w64.dll suffix made me thing of mingw64), but I see the VC14 so you use MSVC.

Can you try this then ?

if (WIN32)

   find_library(WS2_32_LIBRARY ws2_32)

   if( WS2_32_LIBRARY )

          list(APPEND HDF4_LIBRARIES ${WS2_32_LIBRARY})

   endif()

endif()






Le 26/01/2022 ? 20:08, Joaquim Manuel Freire Lu?s a ?crit :
Updated master (sorry, didn?t stop to think if the commit had been merged)

However, I have cmake 3.22.1 but it doesn?t have a FindHDF4.cmake, only a FinfHDF5
FindHDF4.cmake is in the GDAL repository, in cmake/modules/packages/FindHDF4.cmake, so you can try editing it locally with my below suggestions



I was building with

               set(HDF4_INCLUDE_DIR C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
               set(HDF4_df_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
           set(HDF4_mfhdf_LIBRARY_RELEASE C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)

and when I commented those lines the build advance ? till it stop at the ?Cannot open include file: 'zlib.h'? but that is normal since I?m not using the commit who fixed it.

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:50 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] cmake status update - 99% good news!


did you update to master or did you try my pull request (not merged yet) ?

If only master, can you try to change the reference to "ws2_32.lib" to "ws2_32" in cmake/modules/packages/FindHDF4.cmake as I suggested ?

Or perhaps change the if (WIN32) at line 91 to if (MSVC)
Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit :
Don?t know which commit did it. Updated this afternoon and started to erroring right away with missing 'ws2_32.lib`

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Sent: Wednesday, January 26, 2022 6:36 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt><mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] cmake status update - 99% good news!



Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit :

I do have HDF4 but before I was able to build till the end. I've here a gdal_w64.dll smiling to me. That's why I said it got worst.
Sorry you lost me. Is https://github.com/OSGeo/gdal/pull/5179 helping or not ?  If not helping, which commit in it is causing an issue ?











Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a ?crit :

>

> Joaquim,

>> But I found two other new issues when adding more dependencies

>>

>> 1.

>> C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):

>> fatal error C1083: Cannot open include file: 'zlib.h': No such file

>> or directory

>>

>> To work around this, I temporarily added zlib.h and zconf.h to

>> frmts\mbtiles

> Should be fixed by the first commit of

> https://github.com/OSGeo/gdal/pull/5179

>

> I'm afraid it got worst



-- Configuring done

-- Generating done

-- Build files have been written to: C:/programs/compa_libs/gdal_GIT/build

ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll', missing and no known rule to make it



I'd say on the contrary that it helped the build to go further, didn't it ? My fixes are totally unrelated to a ws2_32.lib missing



I see in configure.ac that we had the following logic



dnl

---------------------------------------------------------------------------

dnl Check if we need -lws2_32 (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <winsock2.h>" > test_ws2_32.c echo "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void foo() {}" >> test_ws2_32.c



if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then

  LIBS="$LIBS -lws2_32"

fi

rm -f test_ws2_32*



dnl

---------------------------------------------------------------------------

dnl Check if we need -lpsapi (mingw)

dnl

---------------------------------------------------------------------------



echo "#include <windows.h>" > test_psapi.c echo "#include <psapi.h>" >> test_psapi.c echo "void foo() {}" >> test_psapi.c



if test -z "`${CC} -c test_psapi.c 2>&1`" ; then

  LIBS="$LIBS -lpsapi"

fi

rm -f test_psapi*



This hasn't been ported yet to cmake builds.



I've ticketed that in https://github.com/OSGeo/gdal/issues/5180.



Hum, upon reflection, the error message would seem to indicate that we try to link to ws2_32.lib but it is not found in your environemnt



Looking for ws2_32 in cmake build scripts, I see it is referenced in



cmake/modules/packages/FindODBC.cmake: set(_odbc_required_libs_names

odbccp32;ws2_32)

cmake/modules/packages/FindHDF4.cmake:        list(APPEND HDF4_LIBRARIES

ws2_32.lib)



Do you use any of ODBC or HDF4 in your build ? Could you try to disable them and see if it makes a difference ?



Or maybe if you've HDF4, try to change the ws2_32.lib to ws2_32 in cmake/modules/packages/FindHDF4.cmake ?



Even



--

http://www.spatialys.com

My software is free, but my time generally not.



--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/2f01817c/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jan 26 11:46:26 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 20:46:26 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959D91F3F4464727A057E4EA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
 <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>
 <AM6PR04MB3959D91F3F4464727A057E4EA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <92e77838-adcc-9850-c5b1-335c79bcc20e@spatialys.com>


Le 26/01/2022 ? 20:41, Joaquim Manuel Freire Lu?s a ?crit?:
>
> Yes, I?m using MSVC (2022) and yeap, with that change it works fine.
>
great. Queued in https://github.com/OSGeo/gdal/pull/5179
>
> *From:*Even Rouault <even.rouault at spatialys.com>
> *Sent:* Wednesday, January 26, 2022 7:34 PM
> *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
> Le 26/01/2022 ? 20:26, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     Ok, sorry you meant the FindHDF4.cmake that comes with GDAL. Doing
>     what you suggested (tried both) makes no difference but commenting
>
>     ??? if(WIN32)
>
>     ??????? #list(APPEND HDF4_LIBRARIES ws2_32.lib)
>
>     ??? endif()
>
>     makes the ws2_32 trouble go.
>
> Ah my if(MSVC) suggestion was because I wrongly assumed you used mingw 
> (the _w64.dll suffix made me thing of mingw64), but I see the VC14 so 
> you use MSVC.
>
> Can you try this then ?
>
> if (WIN32)
>
> ?? find_library(WS2_32_LIBRARY ws2_32)
>
> ?? if( WS2_32_LIBRARY )
>
> list(APPEND HDF4_LIBRARIES ${WS2_32_LIBRARY})
>
> ?? endif()
>
> endif()
>
>     Le 26/01/2022 ? 20:08, Joaquim Manuel Freire Lu?s a ?crit?:
>
>         Updated master (sorry, didn?t stop to think if the commit had
>         been merged)
>
>         However, I have cmake 3.22.1 but it doesn?t have a
>         FindHDF4.cmake, only a FinfHDF5
>
>     FindHDF4.cmake is in the GDAL repository, in
>     cmake/modules/packages/FindHDF4.cmake, so you can try editing it
>     locally with my below suggestions
>
>
>         I was building with
>
>         set(HDF4_INCLUDE_DIR
>         C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_34/include)
>
>         set(HDF4_df_LIBRARY_RELEASE
>         C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/hdfdll.lib)
>
>         set(HDF4_mfhdf_LIBRARY_RELEASE
>         C:/programs/compa_libs/hdf-4.2.9/compileds/VC14_64/lib/mfhdfdll.lib)
>
>
>         and when I commented those lines the build advance ? till it
>         stop at the ?Cannot open include file: 'zlib.h'? but that is
>         normal since I?m not using the commit who fixed it.
>
>         *From:*Even Rouault <even.rouault at spatialys.com>
>         <mailto:even.rouault at spatialys.com>
>         *Sent:* Wednesday, January 26, 2022 6:50 PM
>         *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
>         <mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org
>         *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
>         did you update to master or did you try my pull request (not
>         merged yet) ?
>
>         If only master, can you try to change the reference to
>         "ws2_32.lib" to "ws2_32" in
>         cmake/modules/packages/FindHDF4.cmake as I suggested ?
>
>         Or perhaps change the if (WIN32) at line 91 to if (MSVC)
>
>         Le 26/01/2022 ? 19:43, Joaquim Manuel Freire Lu?s a ?crit?:
>
>             Don?t know which commit did it. Updated this afternoon and
>             started to erroring right away with missing 'ws2_32.lib`
>
>             *From:*Even Rouault <even.rouault at spatialys.com>
>             <mailto:even.rouault at spatialys.com>
>             *Sent:* Wednesday, January 26, 2022 6:36 PM
>             *To:* Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
>             <mailto:jluis at ualg.pt>; gdal-dev at lists.osgeo.org
>             *Subject:* Re: [gdal-dev] cmake status update - 99% good news!
>
>             Le 26/01/2022 ? 19:31, Joaquim Manuel Freire Lu?s a ?crit?:
>
>                 I do have HDF4 but before I was able to build till the
>                 end. I've here a gdal_w64.dll smiling to me. That's
>                 why I said it got worst.
>
>             Sorry you lost me. Is
>             https://github.com/OSGeo/gdal/pull/5179
>             <https://github.com/OSGeo/gdal/pull/5179> helping or not
>             ?? If not helping, which commit in it is causing an issue ?
>
>
>
>
>                 Le 26/01/2022 ? 17:26, Joaquim Manuel Freire Lu?s a
>                 ?crit?:
>
>                 >
>
>                 > Joaquim,
>
>                 >> But I found two other new issues when adding more
>                 dependencies
>
>                 >>
>
>                 >> 1.
>
>                 >>
>                 C:\programs\compa_libs\gdal_GIT\frmts\mbtiles\mbtilesdataset.cpp(45):
>
>
>                 >> fatal error C1083: Cannot open include file:
>                 'zlib.h': No such file
>
>                 >> or directory
>
>                 >>
>
>                 >> To work around this, I temporarily added zlib.h and
>                 zconf.h to
>
>                 >> frmts\mbtiles
>
>                 > Should be fixed by the first commit of
>
>                 > https://github.com/OSGeo/gdal/pull/5179
>                 <https://github.com/OSGeo/gdal/pull/5179>
>
>                 >
>
>                 > I'm afraid it got worst
>
>                 -- Configuring done
>
>                 -- Generating done
>
>                 -- Build files have been written to:
>                 C:/programs/compa_libs/gdal_GIT/build
>
>                 ninja: error: 'ws2_32.lib', needed by 'gdal_w64.dll',
>                 missing and no known rule to make it
>
>                 I'd say on the contrary that it helped the build to go
>                 further, didn't it ? My fixes are totally unrelated to
>                 a ws2_32.lib missing
>
>                 I see in configure.ac that we had the following logic
>
>                 dnl
>
>                 ---------------------------------------------------------------------------
>
>                 dnl Check if we need -lws2_32 (mingw)
>
>                 dnl
>
>                 ---------------------------------------------------------------------------
>
>                 echo "#include <winsock2.h>" > test_ws2_32.c echo
>                 "#include <ws2tcpip.h>" >> test_ws2_32.c echo "void
>                 foo() {}" >> test_ws2_32.c
>
>                 if test -z "`${CC} -c test_ws2_32.c 2>&1`" ; then
>
>                 ? LIBS="$LIBS -lws2_32"
>
>                 fi
>
>                 rm -f test_ws2_32*
>
>                 dnl
>
>                 ---------------------------------------------------------------------------
>
>                 dnl Check if we need -lpsapi (mingw)
>
>                 dnl
>
>                 ---------------------------------------------------------------------------
>
>                 echo "#include <windows.h>" > test_psapi.c echo
>                 "#include <psapi.h>" >> test_psapi.c echo "void foo()
>                 {}" >> test_psapi.c
>
>                 if test -z "`${CC} -c test_psapi.c 2>&1`" ; then
>
>                 ? LIBS="$LIBS -lpsapi"
>
>                 fi
>
>                 rm -f test_psapi*
>
>                 This hasn't been ported yet to cmake builds.
>
>                 I've ticketed that in
>                 https://github.com/OSGeo/gdal/issues/5180
>                 <https://github.com/OSGeo/gdal/issues/5180>.
>
>                 Hum, upon reflection, the error message would seem to
>                 indicate that we try to link to ws2_32.lib but it is
>                 not found in your environemnt
>
>                 Looking for ws2_32 in cmake build scripts, I see it is
>                 referenced in
>
>                 cmake/modules/packages/FindODBC.cmake:
>                 set(_odbc_required_libs_names
>
>                 odbccp32;ws2_32)
>
>                 cmake/modules/packages/FindHDF4.cmake: list(APPEND
>                 HDF4_LIBRARIES
>
>                 ws2_32.lib)
>
>                 Do you use any of ODBC or HDF4 in your build ? Could
>                 you try to disable them and see if it makes a difference ?
>
>                 Or maybe if you've HDF4, try to change the ws2_32.lib
>                 to ws2_32 in cmake/modules/packages/FindHDF4.cmake ?
>
>                 Even
>
>                 --
>
>                 http://www.spatialys.com <http://www.spatialys.com>
>
>                 My software is free, but my time generally not.
>
>             -- 
>
>             http://www.spatialys.com
>
>             My software is free, but my time generally not.
>
>         -- 
>
>         http://www.spatialys.com
>
>         My software is free, but my time generally not.
>
>     -- 
>
>     http://www.spatialys.com
>
>     My software is free, but my time generally not.
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/657c0bd2/attachment-0001.html>

From jluis at ualg.pt  Wed Jan 26 11:56:51 2022
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Wed, 26 Jan 2022 19:56:51 +0000
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <92e77838-adcc-9850-c5b1-335c79bcc20e@spatialys.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <AM6PR04MB3959A03A03F0E1916AF5D4E8A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <1ac654b0-3249-46d4-36b8-924a1f8b6ac0@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
 <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>
 <AM6PR04MB3959D91F3F4464727A057E4EA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <92e77838-adcc-9850-c5b1-335c79bcc20e@spatialys.com>
Message-ID: <AM6PR04MB3959E212E52580A05B514959A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>

>Ah my if(MSVC) suggestion was because I wrongly assumed you used mingw (the _w64.dll >suffix made me thing of mingw64), but I see the VC14 so you use MSVC.

The ?_w64.dll? (and _w32.dll) suffixes are the reason why I rebuild everything. Is there any way to set them in current cmake solution? It was possible with nmake but for cmake I?m using this patch to the root CMakeList.txt, which at a later stage, if there is no existing alternative, I would like to propose it?s official inclusion.



# If a renaming of the dll has been set in ConfigUser.cmake

if (WIN32 AND GDAL_DLL_RENAME)

set_target_properties(GDAL PROPERTIES RUNTIME_OUTPUT_NAME ${GDAL_DLL_RENAME})

endif (WIN32 AND GDAL_DLL_RENAME)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/fc8e9732/attachment.html>

From even.rouault at spatialys.com  Wed Jan 26 12:15:08 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Jan 2022 21:15:08 +0100
Subject: [gdal-dev] cmake status update - 99% good news!
In-Reply-To: <AM6PR04MB3959E212E52580A05B514959A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
References: <5e0665b1-7336-6ad1-4199-ba707ffb2491@spatialys.com>
 <AM6PR04MB3959EA83BB4AABC3ACA62BBAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c73e1e34-444e-777a-da88-43d3811adcea@spatialys.com>
 <AM6PR04MB3959D6A763BC7233E71F65BEA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <c6a59752-e1f1-6cbf-78d4-bd9327d5bb2b@spatialys.com>
 <AM6PR04MB3959FF6D11A276919BBDC6EAA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <d229bda7-a8ca-27c0-f4bd-19eb94af2530@spatialys.com>
 <AM6PR04MB3959C122F51E1CEF03A2A7EDA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <6e945af6-859f-2663-f310-418008f8f626@spatialys.com>
 <AM6PR04MB39595D47B3BDD491D2D5E797A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <ab4d8469-162b-5b81-b027-2b428f50362c@spatialys.com>
 <AM6PR04MB3959D91F3F4464727A057E4EA6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
 <92e77838-adcc-9850-c5b1-335c79bcc20e@spatialys.com>
 <AM6PR04MB3959E212E52580A05B514959A6209@AM6PR04MB3959.eurprd04.prod.outlook.com>
Message-ID: <2c58ec2d-bc17-7bb2-1682-69b8195a7e2e@spatialys.com>


Le 26/01/2022 ? 20:56, Joaquim Manuel Freire Lu?s a ?crit?:
>
>     >Ah my if(MSVC) suggestion was because I wrongly assumed you used mingw (the _w64.dll >suffix
>     made me thing of mingw64), but I see the VC14 so you use MSVC.
>
>     The ?_w64.dll? (and _w32.dll) suffixes are the reason why I
>     rebuild everything. Is there any way to set them in current cmake
>     solution? It was possible with nmake but for cmake I?m using this
>     patch to the root CMakeList.txt, which at a later stage, if there
>     is no existing alternative, I would like to propose it?s official
>     inclusion.
>
Sounds reasonable if you want to make a pull request for that (in 
gdal.cmake in the root directory). No reason to restrict it to WIN32 
however. Maybe call the variable GDAL_LIBRARY_OUTPUT_NAME ? And document 
it in doc/source/build_hints.rst

Actually you could make it a option() and modify line 259 of gdal.cmake 
(set_target_properties(${GDAL_LIB_TARGET_NAME} PROPERTIES OUTPUT_NAME 
"gdal")) to use it.

>     # If a renaming of the dll has been set in ConfigUser.cmake
>
>     if (WIN32 AND GDAL_DLL_RENAME)
>
>     set_target_properties(GDAL PROPERTIES RUNTIME_OUTPUT_NAME
>     ${GDAL_DLL_RENAME})
>
>     endif (WIN32 AND GDAL_DLL_RENAME)
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/b7c611bf/attachment.html>

From howard at hobu.co  Wed Jan 26 13:23:35 2022
From: howard at hobu.co (Howard Butler)
Date: Wed, 26 Jan 2022 15:23:35 -0600
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <CABUeae-YLJGkcM5mvOuKexO4dUZJ5J8FUjkyhFNyvgN5Ar4M9Q@mail.gmail.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
 <CABUeae-YLJGkcM5mvOuKexO4dUZJ5J8FUjkyhFNyvgN5Ar4M9Q@mail.gmail.com>
Message-ID: <433168DB-41C0-4BEC-8E56-5C44684A1F5C@hobu.co>

+1 Howard

> On Jan 26, 2022, at 3:31 AM, Mateusz Loskot <mateusz at loskot.net> wrote:
> 
> +1  Mateusz
> 
> On Wed, 26 Jan 2022 at 00:34, Even Rouault <even.rouault at spatialys.com> wrote:
>> 
>> Hi,
>> 
>> I'd like to motion to grant github commit rights to Nyall. We don't have
>> much people currently doing reviews of pull requests and pressing the
>> "Merge" button, and Nyall is definitely in a capacity of fulfilling this
>> responsibility, at least in the areas where he fills comfortable. His
>> own pull requests are of excellent quality and he's one of the few to
>> review my work.
>> 
>> Starting with my +1
>> 
>> Even
>> 
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From szekerest at gmail.com  Wed Jan 26 13:38:22 2022
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 26 Jan 2022 22:38:22 +0100
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <CACALY+Q+YXgjA56bTsas_7A08s9g9H9JOzo6wef9AV9-QHjpBA@mail.gmail.com>

+1  Tamas

Even Rouault <even.rouault at spatialys.com> ezt ?rta (id?pont: 2022. jan.
26., Sze, 0:34):

> Hi,
>
> I'd like to motion to grant github commit rights to Nyall. We don't have
> much people currently doing reviews of pull requests and pressing the
> "Merge" button, and Nyall is definitely in a capacity of fulfilling this
> responsibility, at least in the areas where he fills comfortable. His
> own pull requests are of excellent quality and he's one of the few to
> review my work.
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220126/7858e986/attachment.html>

From dthorne at pivotmaritime.com  Wed Jan 26 18:34:23 2022
From: dthorne at pivotmaritime.com (dthorne at pivotmaritime.com)
Date: Thu, 27 Jan 2022 13:34:23 +1100 (AEDT)
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
In-Reply-To: <70619c98-1b82-3767-843a-6e9afa4b1a23@momtchev.com>
References: <1643002567.238829295@apps.rackspace.com> 
 <70619c98-1b82-3767-843a-6e9afa4b1a23@momtchev.com>
Message-ID: <1643250863.474922623@apps.rackspace.com>


Here is the C++ code we have written to read the test s57 file. 
[ https://pastebin.com/seXrkgmB ]( https://pastebin.com/seXrkgmB )
 
We feel that it is some setup stuff we have missed but can't find any clear information. For example we hadn't seen GDAL_DATA environment variables mentioned in any of the documentation we've tried following until Even mentioned it. Are there any other setup stuff we need to do? [ 
 ]( https://pastebin.com/seXrkgmB )


-----Original Message-----
From: "Momtchil Momtchev" <momtchil at momtchev.com>
Sent: Wednesday, January 26, 2022 9:21pm
To: dthorne at pivotmaritime.com, gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly



 
Can you post your C++ code? Generally, you have more chances of getting an answer for this type of question on [ https://gis.stackexchange.com/ ]( https://gis.stackexchange.com/ )
 
On 24/01/2022 06:36, [ dthorne at pivotmaritime.com ]( mailto:dthorne at pivotmaritime.com ) wrote:
Hi, So I am trying to get a test C++ project built to read S57 files using the gdal/ogr C++ library. I have previously used the C# library that is on there NuGet manager which states v2.4.4 and that seems to read the s57 without issues. Also tried python and that seems to read it with no issues. However, I am having a problem with the C++ test project. Having built the C++ library into the .lib and .dll files I have included them into a blank project and implemented the functions to read the s57 file, however it is only reporting 5 layers.These 5 layers are the same no matter the s57 file. And 4 out of those 5 layers are not actually layers.Using the autotest generated s57 file as a unit test to cross check, there is supposed to be 13 layers. 
 Note: I had feedback from Even indicating the setup environment is probably wrong. And to set up the GDAL_DATA environment variable, so we've made an environment variable referencing the gdal/data folder and that hasn't fixed the problem, but I think it's on the right track as Even said they could reproduce the problem if not setup correctly.
Has anyone had success reading s57 files with a C++ 3.4.1. project that could possibly help get this going?

 Link to reference Image: [ https://imgur.com/a/KwmqZSe ]( https://imgur.com/a/KwmqZSe )
Regards,Daniel

_______________________________________________gdal-dev mailing list[ gdal-dev at lists.osgeo.org ]( mailto:gdal-dev at lists.osgeo.org )[ https://lists.osgeo.org/mailman/listinfo/gdal-dev ]( https://lists.osgeo.org/mailman/listinfo/gdal-dev )
-- Momtchil Momtchev [ <momtchil at momtchev.com> ]( mailto:momtchil at momtchev.com )
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220127/16912d2f/attachment-0001.html>

From momtchil at momtchev.com  Thu Jan 27 02:44:26 2022
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Thu, 27 Jan 2022 11:44:26 +0100
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
In-Reply-To: <1643250863.474922623@apps.rackspace.com>
References: <1643002567.238829295@apps.rackspace.com>
 <70619c98-1b82-3767-843a-6e9afa4b1a23@momtchev.com>
 <1643250863.474922623@apps.rackspace.com>
Message-ID: <b9bea8c4-ab61-5633-7e8b-05723cff0d67@momtchev.com>


 ??? Your code looks OK, can you send me the file too?


On 27/01/2022 03:34, dthorne at pivotmaritime.com wrote:
>
> Here is the C++ code we have written to read the test s57 file.
> https://pastebin.com/seXrkgmB
>
> We feel?that it is?some setup stuff we have missed but can't find any 
> clear information. For example we hadn't seen GDAL_DATA environment 
> variables mentioned in any of the documentation we've tried following 
> until Even mentioned it. Are there any other setup stuff we need to do?
> <https://pastebin.com/seXrkgmB>
>
> -----Original Message-----
> From: "Momtchil Momtchev" <momtchil at momtchev.com>
> Sent: Wednesday, January 26, 2022 9:21pm
> To: dthorne at pivotmaritime.com, gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
>
> Can you post your C++ code? Generally, you have more chances of 
> getting an answer for this type of question on 
> https://gis.stackexchange.com/
>
> On 24/01/2022 06:36, dthorne at pivotmaritime.com wrote:
>
>     Hi,
>     So I am trying to get a test C++ project built to read S57 files
>     using the gdal/ogr C++ library.
>     I have previously used the C# library that is on there NuGet
>     manager which states v2.4.4 and that seems to read the s57 without
>     issues. Also tried python and that seems to read it with no issues.
>
>     However, I am having a problem with the C++ test project. Having
>     built the C++ library into the .lib and .dll files I have included
>     them into a blank project and implemented the functions to read
>     the s57 file, however it is only reporting 5 layers.
>     These 5 layers are the same no matter the s57 file. And 4 out of
>     those 5 layers are not actually layers.
>     Using the autotest generated s57 file as a unit test to cross
>     check, there is supposed to be 13 layers.
>
>     Note: I had feedback from Even indicating the setup environment is
>     probably wrong. And to set up the GDAL_DATA environment variable,
>     so we've made an environment variable referencing the gdal/data
>     folder and that hasn't fixed the problem, but I think it's on the
>     right track as Even said they could reproduce the problem if not
>     setup correctly.
>
>     *Has anyone had success reading s57 files with a C++ 3.4.1.
>     project that could possibly help?get this going?*
>
>     Link to reference Image: https://imgur.com/a/KwmqZSe
>
>
>     Regards,
>     Daniel
>
>
>     _______________________________________________ gdal-dev mailing
>     list gdal-dev at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- Momtchil Momtchev <momtchil at momtchev.com>
>
-- 
Momtchil Momtchev<momtchil at momtchev.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220127/8fb4ed22/attachment.html>

From even.rouault at spatialys.com  Thu Jan 27 07:23:12 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Jan 2022 16:23:12 +0100
Subject: [gdal-dev] What to do with DODS drivers ?
Message-ID: <cf15f53d-bdc7-5ed4-3807-f3406563617a@spatialys.com>

Hi,

The GDAL and OGR DODS drivers were announced to be planned for removal 
for 3.5. Someone jumped yesterday in 
https://github.com/OSGeo/gdal/issues/5173 to ask to keep them (or maybe 
just one of the raster of vector one, but they didn't specify which one 
they use).

To what extent is that still useful and working ? It looks like 
protocols doing things similar to WCS or WFS ?

As I indicated in the ticket, our unit tests for those drivers are all 
disabled currently. If someone has still interest in keeping those 
drivers, they should quickly come with a pull request to resurrect the 
tests.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From felipematas at yahoo.com  Thu Jan 27 10:59:46 2022
From: felipematas at yahoo.com (Felipe Matas)
Date: Thu, 27 Jan 2022 18:59:46 +0000 (UTC)
Subject: [gdal-dev] [Question] PROJ4String to WKT2 Transformations
In-Reply-To: <eb247a9818394a9da7211e844fde1f73@maanmittauslaitos.fi>
References: <eb247a9818394a9da7211e844fde1f73@maanmittauslaitos.fi>
Message-ID: <722696481.1644765.1643309986721@mail.yahoo.com>

 Hi, Thx!, now is a lot more clear!, I have a shape with this CRS:
Coordinate Reference System:
? User input: WGS 84 / UTM zone 19S 
? wkt:
PROJCRS["WGS 84 / UTM zone 19S",
??? BASEGEOGCRS["WGS 84",
??????? DATUM["World Geodetic System 1984",
??????????? ELLIPSOID["WGS 84",6378137,298.257223563,
??????????????? LENGTHUNIT["metre",1]]],
??????? PRIMEM["Greenwich",0,
??????????? ANGLEUNIT["degree",0.0174532925199433]],
??????? ID["EPSG",4326]],
??? CONVERSION["UTM zone 19S",
??????? METHOD["Transverse Mercator",
??????????? ID["EPSG",9807]],
??????? PARAMETER["Latitude of natural origin",0,
??????????? ANGLEUNIT["Degree",0.0174532925199433],
??????????? ID["EPSG",8801]],
??????? PARAMETER["Longitude of natural origin",-69,
??????????? ANGLEUNIT["Degree",0.0174532925199433],
??????????? ID["EPSG",8802]],
??????? PARAMETER["Scale factor at natural origin",0.9996,
??????????? SCALEUNIT["unity",1],
??????????? ID["EPSG",8805]],
??????? PARAMETER["False easting",500000,
??????????? LENGTHUNIT["metre",1],
??????????? ID["EPSG",8806]],
??????? PARAMETER["False northing",10000000,
??????????? LENGTHUNIT["metre",1],
??????????? ID["EPSG",8807]]],
??? CS[Cartesian,2],
??????? AXIS["(E)",east,
??????????? ORDER[1],
??????????? LENGTHUNIT["metre",1]],
??????? AXIS["(N)",north,
??????????? ORDER[2],
??????????? LENGTHUNIT["metre",1]],
??? ID["EPSG",32719]]
This CRS is a tranformation from WGS84 to   UTM zone 19S?, If is a transfomation, I don't know, if the data of the file is already transformed, or, the data will be transformed to  UTM zone 19S.
Because, in case it is already transform, to recover the original, I should rollback the transformation and set the WGS84 as the CRS to can use WKT2 in the right way. (skipping the WGS84 pivot)

Thx.
    El martes, 11 de enero de 2022 12:15:14 a.?m. GMT-3, Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi> escribi?:  
 
 <!--#yiv1746375856 _filtered {} _filtered {} _filtered {} _filtered {}#yiv1746375856 #yiv1746375856 p.yiv1746375856MsoNormal, #yiv1746375856 li.yiv1746375856MsoNormal, #yiv1746375856 div.yiv1746375856MsoNormal {margin:0cm;font-size:11.0pt;font-family:"Calibri", sans-serif;}#yiv1746375856 code {font-family:"Courier New";}#yiv1746375856 pre {margin:0cm;margin-bottom:.0001pt;font-size:10.0pt;font-family:"Courier New";}#yiv1746375856 span.yiv1746375856HTML-esimuotoiltuChar {font-family:Consolas;}#yiv1746375856 span.yiv1746375856Shkpostityyli21 {font-family:"Calibri", sans-serif;color:windowtext;}#yiv1746375856 .yiv1746375856MsoChpDefault {font-size:10.0pt;} _filtered {}#yiv1746375856 div.yiv1746375856WordSection1 {}-->
Hi,
 
 ?
 
The more or less same question seems to be asked some time ago in gis.stackexchange https://gis.stackexchange.com/questions/420378/can-we-construct-wkt2-from-proj4string-correctly.
 
 ?
 
-Jukka Rahkonen-
 
 ?
 
 ?
 
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org>Puolesta Felipe Matas via gdal-dev
L?hetetty: maanantai 10. tammikuuta 2022 22.07
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] [Question] PROJ4String to WKT2 Transformations
 
 ?
 
Hi hi, I was looking for someplace to ask about this, and I was in doubt is was here or in PROJ, but lets do a try.
 
 ?
 
Actually, probably I'm not the only one, I have some questions about how WKT2 and PROJ4Strings are transformed.
 
 ?
 
>From what I read, a PROJ4String don't have enough info to construct a precise WKT2, so, actually how PROJ4String is deprecated my main question is how to construct the right WKT2, there is a lot o data stored in the old format, there is usually no more information, and even the software/hardware that get the data in some way save all of it with all the errors.
 
 ?
 
Actually, we can transform a old CRS to a WKT2:
 
 ?
 > st_crs("+type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0" + ) Coordinate Reference System: ? User input: +type=crs +proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0  ??wkt: BOUNDCRS[ ??? SOURCECRS[ ??????? PROJCRS["unknown", ??????????? BASEGEOGCRS["unknown", ??????????????? DATUM["World Geodetic System 1984", ??????????????????? ELLIPSOID["WGS 84",6378137,298.257223563, ??????????????????????? LENGTHUNIT["metre",1]], ??????????????????? ID["EPSG",6326]], ??????????????? PRIMEM["Greenwich",0, ??????????????????? ANGLEUNIT["degree",0.0174532925199433], ??????????????????? ID["EPSG",8901]]], ??????????? CONVERSION["UTM zone 19S", ??????????????? METHOD["Transverse Mercator", ??????????????????? ID["EPSG",9807]], ??????????????? PARAMETER["Latitude of natural origin",0, ??????????????????? ANGLEUNIT["degree",0.0174532925199433], ??????????????????? ID["EPSG",8801]], ??????????????? PARAMETER["Longitude of natural origin",-69, ??????????????????? ANGLEUNIT["degree",0.0174532925199433], ??????????????????? ID["EPSG",8802]], ??????????????? PARAMETER["Scale factor at natural origin",0.9996, ??????????????????? SCALEUNIT["unity",1], ?????????????? ?????ID["EPSG",8805]], ??????????????? PARAMETER["False easting",500000, ??????????????????? LENGTHUNIT["metre",1], ??????????????????? ID["EPSG",8806]], ??????????????? PARAMETER["False northing",10000000, ??????????????????? LENGTHUNIT["metre",1], ????? ??????????????ID["EPSG",8807]], ??????????????? ID["EPSG",17019]], ??????????? CS[Cartesian,2], ??????????????? AXIS["(E)",east, ??????????????????? ORDER[1], ??????????????????? LENGTHUNIT["metre",1, ??????????????????????? ID["EPSG",9001]]], ??????????? ????AXIS["(N)",north, ??????????????????? ORDER[2], ??????????????????? LENGTHUNIT["metre",1, ??????????????????????? ID["EPSG",9001]]]]], ??? TARGETCRS[ ??????? GEOGCRS["WGS 84", ??????????? DATUM["World Geodetic System 1984", ??????????????? ELLIPSOID["WGS 84",6378137,298.257223563, ??????????????????? LENGTHUNIT["metre",1]]], ??????????? PRIMEM["Greenwich",0, ??????????????? ANGLEUNIT["degree",0.0174532925199433]], ??????????? CS[ellipsoidal,2], ??????????????? AXIS["latitude",north, ?????????????????? ?ORDER[1], ??????????????????? ANGLEUNIT["degree",0.0174532925199433]], ??????????????? AXIS["longitude",east, ??????????????????? ORDER[2], ??????????????????? ANGLEUNIT["degree",0.0174532925199433]], ??????????? ID["EPSG",4326]]], ??? ABRIDGEDTRANSFORMATION["Transformation from unknown to WGS84", ??????? METHOD["Geocentric translations (geog2D domain)", ??????????? ID["EPSG",9603]], ??????? PARAMETER["X-axis translation",0, ??????????? ID["EPSG",8605]], ??????? PARAMETER["Y-axis translation",0, ????????? ??ID["EPSG",8606]], ??????? PARAMETER["Z-axis translation",0, ??????????? ID["EPSG",8607]]]] 
 ?
 
So, in some way, GDAL is able to cover this "breach" of information betwen PROJ4String and WKT2, but is not like the breach does not exist, it was just handled in some way, so, the lack of info, also means, there can be othe aproximations to that CRS.
 
 ?
 
Maybe I'm just confused, and mixing things the things I read, I'm just trying to figure it out, what and how would be the right transformation from proj4string to wkt2.
 
 ?
 
Thx.
 
 ?
 _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220127/4f6dd3c2/attachment-0001.html>

From kusala9 at googlemail.com  Thu Jan 27 12:04:02 2022
From: kusala9 at googlemail.com (kusala nine)
Date: Thu, 27 Jan 2022 20:04:02 +0000
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
In-Reply-To: <b9bea8c4-ab61-5633-7e8b-05723cff0d67@momtchev.com>
References: <b9bea8c4-ab61-5633-7e8b-05723cff0d67@momtchev.com>
Message-ID: <D30BB565-8F41-403C-8405-B604E97FDC6D@googlemail.com>

I?m an S57 expert. Send me the data - I?ll take a look, there?s a lot of leeway with S57 and sometimes it trips up GDAL. I had issues with AML data before which is similar?

Jonathan. 

Sent from my iPhone

> On 27 Jan 2022, at 10:44, Momtchil Momtchev <momtchil at momtchev.com> wrote:
> 
> ?
> 
> 
>     Your code looks OK, can you send me the file too?
> 
> 
> 
> On 27/01/2022 03:34, dthorne at pivotmaritime.com wrote:
>> Here is the C++ code we have written to read the test s57 file. 
>> https://pastebin.com/seXrkgmB
>>  
>> We feel that it is some setup stuff we have missed but can't find any clear information. For example we hadn't seen GDAL_DATA environment variables mentioned in any of the documentation we've tried following until Even mentioned it. Are there any other setup stuff we need to do? 
>> 
>> 
>> -----Original Message-----
>> From: "Momtchil Momtchev" <momtchil at momtchev.com>
>> Sent: Wednesday, January 26, 2022 9:21pm
>> To: dthorne at pivotmaritime.com, gdal-dev at lists.osgeo.org
>> Subject: Re: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
>> 
>>  
>> Can you post your C++ code? Generally, you have more chances of getting an answer for this type of question on https://gis.stackexchange.com/
>>  
>> On 24/01/2022 06:36, dthorne at pivotmaritime.com wrote:
>> Hi, 
>> So I am trying to get a test C++ project built to read S57 files using the gdal/ogr C++ library. 
>> I have previously used the C# library that is on there NuGet manager which states v2.4.4 and that seems to read the s57 without issues. Also tried python and that seems to read it with no issues. 
>> 
>> However, I am having a problem with the C++ test project. Having built the C++ library into the .lib and .dll files I have included them into a blank project and implemented the functions to read the s57 file, however it is only reporting 5 layers.
>> These 5 layers are the same no matter the s57 file. And 4 out of those 5 layers are not actually layers.
>> Using the autotest generated s57 file as a unit test to cross check, there is supposed to be 13 layers. 
>> 
>> Note: I had feedback from Even indicating the setup environment is probably wrong. And to set up the GDAL_DATA environment variable, so we've made an environment variable referencing the gdal/data folder and that hasn't fixed the problem, but I think it's on the right track as Even said they could reproduce the problem if not setup correctly.
>> 
>> Has anyone had success reading s57 files with a C++ 3.4.1. project that could possibly help get this going?
>> 
>> Link to reference Image: https://imgur.com/a/KwmqZSe
>> 
>> Regards,
>> Daniel
>> 
>> 
>> _______________________________________________ gdal-dev mailing list gdal-dev at lists.osgeo.org https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> -- Momtchil Momtchev <momtchil at momtchev.com>
> -- 
> Momtchil Momtchev <momtchil at momtchev.com>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220127/7f08ef8a/attachment.html>

From dthorne at pivotmaritime.com  Thu Jan 27 16:55:49 2022
From: dthorne at pivotmaritime.com (dthorne at pivotmaritime.com)
Date: Fri, 28 Jan 2022 11:55:49 +1100 (AEDT)
Subject: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly
In-Reply-To: <D30BB565-8F41-403C-8405-B604E97FDC6D@googlemail.com>
References: <b9bea8c4-ab61-5633-7e8b-05723cff0d67@momtchev.com> 
 <D30BB565-8F41-403C-8405-B604E97FDC6D@googlemail.com>
Message-ID: <1643331349.224118169@apps.rackspace.com>


The S57 file we used to test with each language and it is read correctly in C# & python, our c++ project is the problem. The S57 is the one generated in "\gdal-3.4.1\autotest\ogr\data\s57" when we built gdal. But [ here is a link ]( https://drive.google.com/file/d/1AGCHEQMWHvs6IJgDW45KJvK6gm-r_cpH/view?usp=sharing ) to that s57 folder.

The specific s57 file we used was "1B5X02NE.000" which in reference to the first image I linked should have 13 layers. 
Thanks in advance for the help! 

Daniel



-----Original Message-----
From: "kusala nine" <kusala9 at googlemail.com>
Sent: Friday, January 28, 2022 7:04am
To: "Momtchil Momtchev" <momtchil at momtchev.com>
Cc: dthorne at pivotmaritime.com, gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly


I?m an S57 expert. Send me the data - I?ll take a look, there?s a lot of leeway with S57 and sometimes it trips up GDAL. I had issues with AML data before which is similar?
Jonathan. 


Sent from my iPhone

On 27 Jan 2022, at 10:44, Momtchil Momtchev <momtchil at momtchev.com> wrote:



 
    Your code looks OK, can you send me the file too?
 
On 27/01/2022 03:34, [ dthorne at pivotmaritime.com ]( mailto:dthorne at pivotmaritime.com ) wrote:
Here is the C++ code we have written to read the test s57 file. 
[ https://pastebin.com/seXrkgmB ]( https://pastebin.com/seXrkgmB )
  
 We feel that it is some setup stuff we have missed but can't find any clear information. For example we hadn't seen GDAL_DATA environment variables mentioned in any of the documentation we've tried following until Even mentioned it. Are there any other setup stuff we need to do? [ 
 ]( https://pastebin.com/seXrkgmB )


-----Original Message-----
 From: "Momtchil Momtchev" [ <momtchil at momtchev.com> ]( mailto:momtchil at momtchev.com )
 Sent: Wednesday, January 26, 2022 9:21pm
 To: [ dthorne at pivotmaritime.com ]( mailto:dthorne at pivotmaritime.com ), [ gdal-dev at lists.osgeo.org ]( mailto:gdal-dev at lists.osgeo.org )
 Subject: Re: [gdal-dev] GDAL/OGR 3.4.1 not reading S57 correctly



 
Can you post your C++ code? Generally, you have more chances of getting an answer for this type of question on [ https://gis.stackexchange.com/ ]( https://gis.stackexchange.com/ )
 
On 24/01/2022 06:36, [ dthorne at pivotmaritime.com ]( mailto:dthorne at pivotmaritime.com ) wrote:
Hi, So I am trying to get a test C++ project built to read S57 files using the gdal/ogr C++ library. I have previously used the C# library that is on there NuGet manager which states v2.4.4 and that seems to read the s57 without issues. Also tried python and that seems to read it with no issues. However, I am having a problem with the C++ test project. Having built the C++ library into the .lib and .dll files I have included them into a blank project and implemented the functions to read the s57 file, however it is only reporting 5 layers.These 5 layers are the same no matter the s57 file. And 4 out of those 5 layers are not actually layers.Using the autotest generated s57 file as a unit test to cross check, there is supposed to be 13 layers. 
 Note: I had feedback from Even indicating the setup environment is probably wrong. And to set up the GDAL_DATA environment variable, so we've made an environment variable referencing the gdal/data folder and that hasn't fixed the problem, but I think it's on the right track as Even said they could reproduce the problem if not setup correctly.
Has anyone had success reading s57 files with a C++ 3.4.1. project that could possibly help get this going?

 Link to reference Image: [ https://imgur.com/a/KwmqZSe ]( https://imgur.com/a/KwmqZSe )
Regards,Daniel

_______________________________________________ gdal-dev mailing list [ gdal-dev at lists.osgeo.org ]( mailto:gdal-dev at lists.osgeo.org ) [ https://lists.osgeo.org/mailman/listinfo/gdal-dev ]( https://lists.osgeo.org/mailman/listinfo/gdal-dev )
-- Momtchil Momtchev [ <momtchil at momtchev.com> ]( mailto:momtchil at momtchev.com )
-- Momtchil Momtchev [ <momtchil at momtchev.com> ]( mailto:momtchil at momtchev.com )_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20220128/020f2f1b/attachment-0001.html>

From even.rouault at spatialys.com  Mon Jan 31 01:25:38 2022
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Jan 2022 10:25:38 +0100
Subject: [gdal-dev] Motion: grant github commit rights to Nyall Dawson
In-Reply-To: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
References: <c1dec690-1f56-e225-895f-ac9bb71e3044@spatialys.com>
Message-ID: <f59f0ad3-04be-d8f0-ec95-bb0bcd2f14de@spatialys.com>

Hi,

I declare this motion passed with +1 from PSC members KurtS, DanielM, 
FrankW, JukkaR, MateuszL, HowardB, TamasS and me

Even

Le 26/01/2022 ? 00:34, Even Rouault a ?crit?:
> Hi,
>
> I'd like to motion to grant github commit rights to Nyall. We don't 
> have much people currently doing reviews of pull requests and pressing 
> the "Merge" button, and Nyall is definitely in a capacity of 
> fulfilling this responsibility, at least in the areas where he fills 
> comfortable. His own pull requests are of excellent quality and he's 
> one of the few to review my work.
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


