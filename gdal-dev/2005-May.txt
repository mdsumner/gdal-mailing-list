From starged at videotron.ca  Sun May  1 19:26:22 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] OpenEV tools and goodies
Message-ID: <4275659E.5040203@videotron.ca>

Hi all,

 From now on, all my tools and custom modules for OpenEV can be found at:
http://pages.infinit.net/starged/openev/index.htm

Thank you.
--
Mario B.

From saintsjd at yahoo.com  Mon May  2 09:52:56 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: 6667
Message-ID: <20050502135256.77937.qmail@web53907.mail.yahoo.com>

Ok, I have narrowed the problem.

Yes, I agree that ASTER's come with ground control
points, however, when using gdal_translate it seems
that the utility doesnt apply the ground points
correctly.

My observation is this: In the raw aster image the
corners (ul and lr) of the raw image data are not the
"corners" of the data. Along both edges of the actual
data there are no data values hold space as padding. 
The actual image data is a slanted trazezoid padded on
both sides with no data values within the rectangle
that is the raw aster image. gdal_translate can apply
the GCP points to the raw image, but does so
incorrectly. It applies the ul and lr values to the no
data padding of the raw image, rather than applying
the point to the actual corner where the actual data
begins.  

I hope this makes some sense. I found it difficult to
explain without drawing pictures.  

Is there any workaround for this?

Thanks
Jon


--- Kenneth Melero <kmelero@sanz.com> wrote:
> 
> Andrey,
> 
> Can you provide an example of this?
> 
> Thanks!
> -Ken
> 
> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com
> [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf
> Of Andrey Kiselev
> Sent: Saturday, April 30, 2005 2:42 AM
> To: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] convert HDF ASTER to geotiff
> 
> 
> On Fri, Apr 29, 2005 at 01:18:15PM -0700, Jon Saints
> wrote:
> > Hi, I am new to GDAL. I have had some success
> converting hdf to tif 
> > using gdal_translate.
> > 
> > i have not been able to apply a coorsys to the new
> tif image.  has 
> > anyone any expirience with this sort of thing?
> 
> ASTER scenes are georeferenced with GCP points, that
> means you should use
> gdalwarp to transform the scene in desirable
> projection and extent. And you
> definitely need the latest CVS snapshot of GDAL
> sources where the proper
> functionality has been implemented.
> 
> Regards,
> Andrey
> 
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5970603  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 

From vincent at ecovla.nl  Mon May  2 10:10:05 2005
From: vincent at ecovla.nl (vincent@ecovla.nl)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: <20050502135256.77937.qmail@web53907.mail.yahoo.com>
References: <20050502135256.77937.qmail@web53907.mail.yahoo.com>
Message-ID: <427634BD.1050400@ecovla.nl>

Jon Saints wrote:

> Ok, I have narrowed the problem.
>
> Yes, I agree that ASTER's come with ground control points, however,
> when using gdal_translate it seems that the utility doesnt apply the
> ground points correctly.
>
> My observation is this: In the raw aster image the corners (ul and
> lr) of the raw image data are not the "corners" of the data. Along
> both edges of the actual data there are no data values hold space as
> padding. The actual image data is a slanted trazezoid padded on both
> sides with no data values within the rectangle that is the raw aster
> image. gdal_translate can apply the GCP points to the raw image, but
> does so incorrectly. It applies the ul and lr values to the no data
> padding of the raw image, rather than applying the point to the
> actual corner where the actual data begins.
>
> I hope this makes some sense. I found it difficult to explain without
> drawing pictures.
>
> Is there any workaround for this?
>
> Thanks Jon


Jon,

Are you sure that for your ASTER images, the GCP's don't apply to the
nodata areas too? In the ASTER images that I have used so far, the
opposite is true. GCP's range from (0.5, 0.5) to the full pixel extent
of the ASTER image (that is: including the nodata areas) , i.e. the last
GCP maps pixel coordinate (2490.5,2100.5). This of course would never be
so if the nodata parts were not covered by the GCP's. Moreover, the
georeferencing that I've done using gdalwarp (note: NOT gdal_translate)
looks very accurate; I'm sure I would have noticed it all my ASTER
images were rotated and slanted.

You can check the values of the GCP's using gdalinfo on one of the
subdatasets of your ASTER HDF files.

just my 2c.

regards,
Vincent.

>
>
> --- Kenneth Melero <kmelero@sanz.com> wrote:
>
>> Andrey,
>>
>> Can you provide an example of this?
>>
>> Thanks! -Ken
>>
>> -----Original Message----- From: gdal-dev-bounces@xserve.flids.com
>> [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Andrey
>> Kiselev Sent: Saturday, April 30, 2005 2:42 AM To:
>> gdal-dev@remotesensing.org Subject: Re: [Gdal-dev] convert HDF
>> ASTER to geotiff
>>
>>
>> On Fri, Apr 29, 2005 at 01:18:15PM -0700, Jon Saints wrote:
>>
>>> Hi, I am new to GDAL. I have had some success
>>
>> converting hdf to tif
>>
>>> using gdal_translate.
>>>
>>> i have not been able to apply a coorsys to the new
>>
>> tif image. has
>>
>>> anyone any expirience with this sort of thing?
>>
>> ASTER scenes are georeferenced with GCP points, that means you
>> should use gdalwarp to transform the scene in desirable projection
>> and extent. And you definitely need the latest CVS snapshot of GDAL
>> sources where the proper functionality has been implemented.
>>
>> Regards, Andrey
>>
>> -- Andrey V. Kiselev Home phone: +7 812 5970603 ICQ# 26871517
>> _______________________________________________ Gdal-dev mailing
>> list Gdal-dev@xserve.flids.com
>> http://xserve.flids.com/mailman/listinfo/gdal-dev
>>
>> _______________________________________________ Gdal-dev mailing
>> list Gdal-dev@xserve.flids.com
>> http://xserve.flids.com/mailman/listinfo/gdal-dev
>>
> _______________________________________________ Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev



From saintsjd at yahoo.com  Mon May  2 10:53:05 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: 6667
Message-ID: <20050502145306.89156.qmail@web53909.mail.yahoo.com>

Would you mind providing the list with an example of
your gdal_warp command? 

I have been doing the following:
1) use gdal_translate -sds to extract various ASTER
subsets into non-georeferenced tifs
2) use gdal_merge to merge the first three subsets
into a non-georeferenced multi-band tiff.

*** here I have not been able to use gdal_warp because
the image has no "original coord sys" associated with
it. so I use gdal_translate to apply lat/long coordsys
*** 

3) finally apply lat/long coord sys using UPPERLEFT
LOWERRIGHT values provided by gdalinfo on the original
HDF.

Does this look ok? could you provide an example of the
gdal_warp command?

Thanks
Jon


--- "vincent@ecovla.nl" <vincent@ecovla.nl> wrote:
> Jon Saints wrote:
> 
> > Ok, I have narrowed the problem.
> >
> > Yes, I agree that ASTER's come with ground control
> points, however,
> > when using gdal_translate it seems that the
> utility doesnt apply the
> > ground points correctly.
> >
> > My observation is this: In the raw aster image the
> corners (ul and
> > lr) of the raw image data are not the "corners" of
> the data. Along
> > both edges of the actual data there are no data
> values hold space as
> > padding. The actual image data is a slanted
> trazezoid padded on both
> > sides with no data values within the rectangle
> that is the raw aster
> > image. gdal_translate can apply the GCP points to
> the raw image, but
> > does so incorrectly. It applies the ul and lr
> values to the no data
> > padding of the raw image, rather than applying the
> point to the
> > actual corner where the actual data begins.
> >
> > I hope this makes some sense. I found it difficult
> to explain without
> > drawing pictures.
> >
> > Is there any workaround for this?
> >
> > Thanks Jon
> 
> 
> Jon,
> 
> Are you sure that for your ASTER images, the GCP's
> don't apply to the
> nodata areas too? In the ASTER images that I have
> used so far, the
> opposite is true. GCP's range from (0.5, 0.5) to the
> full pixel extent
> of the ASTER image (that is: including the nodata
> areas) , i.e. the last
> GCP maps pixel coordinate (2490.5,2100.5). This of
> course would never be
> so if the nodata parts were not covered by the
> GCP's. Moreover, the
> georeferencing that I've done using gdalwarp (note:
> NOT gdal_translate)
> looks very accurate; I'm sure I would have noticed
> it all my ASTER
> images were rotated and slanted.
> 
> You can check the values of the GCP's using gdalinfo
> on one of the
> subdatasets of your ASTER HDF files.
> 
> just my 2c.
> 
> regards,
> Vincent.
> 
> >
> >
> > --- Kenneth Melero <kmelero@sanz.com> wrote:
> >
> >> Andrey,
> >>
> >> Can you provide an example of this?
> >>
> >> Thanks! -Ken
> >>
> >> -----Original Message----- From:
> gdal-dev-bounces@xserve.flids.com
> >> [mailto:gdal-dev-bounces@xserve.flids.com] On
> Behalf Of Andrey
> >> Kiselev Sent: Saturday, April 30, 2005 2:42 AM
> To:
> >> gdal-dev@remotesensing.org Subject: Re:
> [Gdal-dev] convert HDF
> >> ASTER to geotiff
> >>
> >>
> >> On Fri, Apr 29, 2005 at 01:18:15PM -0700, Jon
> Saints wrote:
> >>
> >>> Hi, I am new to GDAL. I have had some success
> >>
> >> converting hdf to tif
> >>
> >>> using gdal_translate.
> >>>
> >>> i have not been able to apply a coorsys to the
> new
> >>
> >> tif image. has
> >>
> >>> anyone any expirience with this sort of thing?
> >>
> >> ASTER scenes are georeferenced with GCP points,
> that means you
> >> should use gdalwarp to transform the scene in
> desirable projection
> >> and extent. And you definitely need the latest
> CVS snapshot of GDAL
> >> sources where the proper functionality has been
> implemented.
> >>
> >> Regards, Andrey
> >>
> >> -- Andrey V. Kiselev Home phone: +7 812 5970603
> ICQ# 26871517
> >> _______________________________________________
> Gdal-dev mailing
> >> list Gdal-dev@xserve.flids.com
> >> http://xserve.flids.com/mailman/listinfo/gdal-dev
> >>
> >> _______________________________________________
> Gdal-dev mailing
> >> list Gdal-dev@xserve.flids.com
> >> http://xserve.flids.com/mailman/listinfo/gdal-dev
> >>
> > _______________________________________________
> Gdal-dev mailing list
> > Gdal-dev@xserve.flids.com
> > http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 
> 

From saintsjd at yahoo.com  Mon May  2 10:53:05 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: 6667
Message-ID: <20050502145306.89156.qmail@web53909.mail.yahoo.com>

Would you mind providing the list with an example of
your gdal_warp command? 

I have been doing the following:
1) use gdal_translate -sds to extract various ASTER
subsets into non-georeferenced tifs
2) use gdal_merge to merge the first three subsets
into a non-georeferenced multi-band tiff.

*** here I have not been able to use gdal_warp because
the image has no "original coord sys" associated with
it. so I use gdal_translate to apply lat/long coordsys
*** 

3) finally apply lat/long coord sys using UPPERLEFT
LOWERRIGHT values provided by gdalinfo on the original
HDF.

Does this look ok? could you provide an example of the
gdal_warp command?

Thanks
Jon


--- "vincent@ecovla.nl" <vincent@ecovla.nl> wrote:
> Jon Saints wrote:
> 
> > Ok, I have narrowed the problem.
> >
> > Yes, I agree that ASTER's come with ground control
> points, however,
> > when using gdal_translate it seems that the
> utility doesnt apply the
> > ground points correctly.
> >
> > My observation is this: In the raw aster image the
> corners (ul and
> > lr) of the raw image data are not the "corners" of
> the data. Along
> > both edges of the actual data there are no data
> values hold space as
> > padding. The actual image data is a slanted
> trazezoid padded on both
> > sides with no data values within the rectangle
> that is the raw aster
> > image. gdal_translate can apply the GCP points to
> the raw image, but
> > does so incorrectly. It applies the ul and lr
> values to the no data
> > padding of the raw image, rather than applying the
> point to the
> > actual corner where the actual data begins.
> >
> > I hope this makes some sense. I found it difficult
> to explain without
> > drawing pictures.
> >
> > Is there any workaround for this?
> >
> > Thanks Jon
> 
> 
> Jon,
> 
> Are you sure that for your ASTER images, the GCP's
> don't apply to the
> nodata areas too? In the ASTER images that I have
> used so far, the
> opposite is true. GCP's range from (0.5, 0.5) to the
> full pixel extent
> of the ASTER image (that is: including the nodata
> areas) , i.e. the last
> GCP maps pixel coordinate (2490.5,2100.5). This of
> course would never be
> so if the nodata parts were not covered by the
> GCP's. Moreover, the
> georeferencing that I've done using gdalwarp (note:
> NOT gdal_translate)
> looks very accurate; I'm sure I would have noticed
> it all my ASTER
> images were rotated and slanted.
> 
> You can check the values of the GCP's using gdalinfo
> on one of the
> subdatasets of your ASTER HDF files.
> 
> just my 2c.
> 
> regards,
> Vincent.
> 
> >
> >
> > --- Kenneth Melero <kmelero@sanz.com> wrote:
> >
> >> Andrey,
> >>
> >> Can you provide an example of this?
> >>
> >> Thanks! -Ken
> >>
> >> -----Original Message----- From:
> gdal-dev-bounces@xserve.flids.com
> >> [mailto:gdal-dev-bounces@xserve.flids.com] On
> Behalf Of Andrey
> >> Kiselev Sent: Saturday, April 30, 2005 2:42 AM
> To:
> >> gdal-dev@remotesensing.org Subject: Re:
> [Gdal-dev] convert HDF
> >> ASTER to geotiff
> >>
> >>
> >> On Fri, Apr 29, 2005 at 01:18:15PM -0700, Jon
> Saints wrote:
> >>
> >>> Hi, I am new to GDAL. I have had some success
> >>
> >> converting hdf to tif
> >>
> >>> using gdal_translate.
> >>>
> >>> i have not been able to apply a coorsys to the
> new
> >>
> >> tif image. has
> >>
> >>> anyone any expirience with this sort of thing?
> >>
> >> ASTER scenes are georeferenced with GCP points,
> that means you
> >> should use gdalwarp to transform the scene in
> desirable projection
> >> and extent. And you definitely need the latest
> CVS snapshot of GDAL
> >> sources where the proper functionality has been
> implemented.
> >>
> >> Regards, Andrey
> >>
> >> -- Andrey V. Kiselev Home phone: +7 812 5970603
> ICQ# 26871517
> >> _______________________________________________
> Gdal-dev mailing
> >> list Gdal-dev@xserve.flids.com
> >> http://xserve.flids.com/mailman/listinfo/gdal-dev
> >>
> >> _______________________________________________
> Gdal-dev mailing
> >> list Gdal-dev@xserve.flids.com
> >> http://xserve.flids.com/mailman/listinfo/gdal-dev
> >>
> > _______________________________________________
> Gdal-dev mailing list
> > Gdal-dev@xserve.flids.com
> > http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 
> 

From dron at ak4719.spb.edu  Mon May  2 11:22:56 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: <20050502135256.77937.qmail@web53907.mail.yahoo.com>
References: <20050502135256.77937.qmail@web53907.mail.yahoo.com>
Message-ID: <20050502152256.GB3114@ak4719.spb.edu>

Jon,

On Mon, May 02, 2005 at 06:52:56AM -0700, Jon Saints wrote:
> Yes, I agree that ASTER's come with ground control points, however,
> when using gdal_translate it seems that the utility doesnt apply the
> ground points correctly.

gdal_translate will not apply the control points, that is the task for
special application called gdalwarp, gdal_translate just tries to
transfer as much information as possible between two different file
formats. gdalwarp will do the trasformation based on GCPs or
corners coordinates.

Aslo I am sure you are missed important point: you need GDAL from CVS to
get ASTER transformation working.

> My observation is this: In the raw aster image the corners (ul and lr)
> of the raw image data are not the "corners" of the data. Along both
> edges of the actual data there are no data values hold space as
> padding. The actual image data is a slanted trazezoid padded on both
> sides with no data values within the rectangle that is the raw aster
> image. gdal_translate can apply the GCP points to the raw image, but
> does so incorrectly. It applies the ul and lr values to the no data
> padding of the raw image, rather than applying the point to the actual
> corner where the actual data begins.  

There are two types of ASTERs. The first one is Level 1A. These scenes
contains a set of GCPs and no corner coordinates and should be
georeferenced by the some appropriate application (gdalwarp in our case)
before using. You do not have other way of using these data.

The second type is Level 1B/Level 2 datasets. These ones contain both
GCPs and corner coordinates (and rotation angle in addition); they are
already transformed. These scenes can be georeferenced using both ways:
GCPs and corners, results will be the same. I am prefer use the first
approach, i.e., GCPs, but when I tried georeferencing with the corners
result was the same. These two approaches are equal. And you can't
apply the corner coordinates directly, the scene must be rotated
(rotation angle provided in the metadata as well, but it is not actually
needed).

Anyway, gdalwarp should solve all you problems with ASTER data.

Best regards,
Andrey

PS.
There is also the third type of ASTER scenes, the DEM (Level 3). It is
georeferenced with GCPs, but sligtly differntly from the previous two
types.

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From predator2448 at hotmail.com  Mon May  2 13:56:43 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
Message-ID: <BAY104-F32D867A96B45F02FAEDC8ACE270@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050502/0f0c691b/attachment.html
From saintsjd at yahoo.com  Mon May  2 13:58:26 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] convert HDF ASTER to geotiff
In-Reply-To: 6667
Message-ID: <20050502175827.60898.qmail@web53904.mail.yahoo.com>

gdalwarp solved the problem. I used gdal form FWTOOLS
and it directly read and applied spatial reference to
my exported tifs.  

I thank the list for your help.
Jon


--- Andrey Kiselev <dron@ak4719.spb.edu> wrote:
> Jon,
> 
> On Mon, May 02, 2005 at 06:52:56AM -0700, Jon Saints
> wrote:
> > Yes, I agree that ASTER's come with ground control
> points, however,
> > when using gdal_translate it seems that the
> utility doesnt apply the
> > ground points correctly.
> 
> gdal_translate will not apply the control points,
> that is the task for
> special application called gdalwarp, gdal_translate
> just tries to
> transfer as much information as possible between two
> different file
> formats. gdalwarp will do the trasformation based on
> GCPs or
> corners coordinates.
> 
> Aslo I am sure you are missed important point: you
> need GDAL from CVS to
> get ASTER transformation working.
> 
> > My observation is this: In the raw aster image the
> corners (ul and lr)
> > of the raw image data are not the "corners" of the
> data. Along both
> > edges of the actual data there are no data values
> hold space as
> > padding. The actual image data is a slanted
> trazezoid padded on both
> > sides with no data values within the rectangle
> that is the raw aster
> > image. gdal_translate can apply the GCP points to
> the raw image, but
> > does so incorrectly. It applies the ul and lr
> values to the no data
> > padding of the raw image, rather than applying the
> point to the actual
> > corner where the actual data begins.  
> 
> There are two types of ASTERs. The first one is
> Level 1A. These scenes
> contains a set of GCPs and no corner coordinates and
> should be
> georeferenced by the some appropriate application
> (gdalwarp in our case)
> before using. You do not have other way of using
> these data.
> 
> The second type is Level 1B/Level 2 datasets. These
> ones contain both
> GCPs and corner coordinates (and rotation angle in
> addition); they are
> already transformed. These scenes can be
> georeferenced using both ways:
> GCPs and corners, results will be the same. I am
> prefer use the first
> approach, i.e., GCPs, but when I tried
> georeferencing with the corners
> result was the same. These two approaches are equal.
> And you can't
> apply the corner coordinates directly, the scene
> must be rotated
> (rotation angle provided in the metadata as well,
> but it is not actually
> needed).
> 
> Anyway, gdalwarp should solve all you problems with
> ASTER data.
> 
> Best regards,
> Andrey
> 
> PS.
> There is also the third type of ASTER scenes, the
> DEM (Level 3). It is
> georeferenced with GCPs, but sligtly differntly from
> the previous two
> types.
> 
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5970603  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 

From fwarmerdam at gmail.com  Mon May  2 14:25:53 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
In-Reply-To: <BAY104-F32D867A96B45F02FAEDC8ACE270@phx.gbl>
References: <BAY104-F32D867A96B45F02FAEDC8ACE270@phx.gbl>
Message-ID: <931f8ea9050502112578960b15@mail.gmail.com>

On 5/2/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> psWarpOptions->panSrcBands = (int *) CPLMalloc(sizeof(int) *
> psWarpOptions->nBandCount);
> psWarpOptions->panSrcBands[0] = 1;
> psWarpOptions->panSrcBands[1] = 1;
> psWarpOptions->panSrcBands[2] = 1;
> psWarpOptions->panDstBands = (int *) CPLMalloc(sizeof(int) *
> psWarpOptions->nBandCount);
> psWarpOptions->panDstBands[0] = 1;
> psWarpOptions->panDstBands[1] = 1;
> psWarpOptions->panDstBands[2] = 1; 

Ilya, 

I think you want the src and dst bands to be:

> psWarpOptions->panSrcBands[0] = 1;
> psWarpOptions->panSrcBands[1] = 2;
> psWarpOptions->panSrcBands[2] = 3;
> psWarpOptions->panDstBands[0] = 1;
> psWarpOptions->panDstBands[1] = 2;
> psWarpOptions->panDstBands[2] = 3; 

This would explain why you are getting greyscale output.
I'm less clear on this squishing effect you are seeing.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Mon May  2 15:15:24 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
In-Reply-To: <931f8ea9050502112578960b15@mail.gmail.com>
Message-ID: <BAY104-F214E69182F05DFE7507B82CE270@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050502/6e7f406b/attachment.html
From fwarmerdam at gmail.com  Mon May  2 15:27:06 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
In-Reply-To: <BAY104-F214E69182F05DFE7507B82CE270@phx.gbl>
References: <931f8ea9050502112578960b15@mail.gmail.com>
	<BAY104-F214E69182F05DFE7507B82CE270@phx.gbl>
Message-ID: <931f8ea905050212273085a1dd@mail.gmail.com>

On 5/2/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> I also tried using the precompiled tools from the GDAL website, specifically
> the warp tool and it also produces the squished effect. Perhaps the GeoTIFF
> I am using as a source is special in some sense and needs to be processed in
> a special way, I am not sure. Here is the information extracted using
> gdalinfo.exe about the image, it is around 75 MB: 

Ilya, 

A light bulb just went off for me.  I am willing to bet you are using a
simplistic GeoTIFF reader - perhaps ArcView or ArcGIS?  Many tools
have trouble reading multi-band TIFFs with "band interleaving", the
GDAL output default.   I would suggesting using the INTERLEAVE=PIXEL
creation option. 

ie. 
Change:

    // Create the output file. 
 hDstDS = GDALCreate( hDriver, fileNameOut, nPixels, nLines,
GDALGetRasterCount(hSrcDS), eDT, NULL );
    

To this:

    char *apszOptions[] = { "INTERLEAVE=PIXEL", NULL };
    
    hDstDS = GDALCreate( hDriver, fileNameOut, nPixels, nLines, 
                                      GDALGetRasterCount(hSrcDS), eDT, 
                                       apszOptions );
    
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Mon May  2 16:19:38 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
In-Reply-To: <931f8ea905050212273085a1dd@mail.gmail.com>
Message-ID: <BAY104-F2639040C973B0B4B978CD7CE270@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050502/be433710/attachment.html
From fwarmerdam at gmail.com  Mon May  2 16:23:47 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Warping GeoTIFF colour image - beginner question(s)
In-Reply-To: <BAY104-F2639040C973B0B4B978CD7CE270@phx.gbl>
References: <931f8ea905050212273085a1dd@mail.gmail.com>
	<BAY104-F2639040C973B0B4B978CD7CE270@phx.gbl>
Message-ID: <931f8ea9050502132369db1ebb@mail.gmail.com>

On 5/2/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> Hello Frank, 
> 
>        That did it, thank you very much. I do not actually use ArcView or
> ArcGIS reader but obviously something simplistic since it cannot read the
> band interleaved, only pixel interleaved. 
> 
>        I have another question, which is more general and not only on my
> behalf but also on Peter Lenson's, I am working as undergraduate student in
> GeoICT lab which is related to GeoTango. The question is whether there is a
> C++ version of the python merge program, i.e. gdal_merge.py from pymod
> directory under GDAL? 

Ilya, 

There is no C++ version of gdal_merge.py.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From oscar at geovirtual.es  Wed May  4 10:09:45 2005
From: oscar at geovirtual.es (Oscar ter Hofstede)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] missing/wrong compiler option in nmake.opt
References: <719A38AB7279D511B91900D0B7444A9E0DD1D3B0@caemsx03.cae.ca>
	<931f8ea905030109173bac87c0@mail.gmail.com>
Message-ID: <022c01c550b2$ed22d190$a001a8c0@Oscar>

Hi,

I am trying to build a debug version of my application with the latest 
version of GDAL (1.2.6), including MrSid and ECW support.

I need to build with the debug run-time libraries (by specifying the option 
/MDd), since some other libraries I use are using debug functions that are 
only defined there (CrtDbgReport). However, if I build both my application 
and GDAL with the /MDd option, the application crashes in GDALClose() when 
closing a MrSid or ECW dataset.

Has this something to do with the MrSid and ECW libraries not being compiled 
with /MDd? I downloaded the latest versions of their libraries from their 
websites last week. Is there a solution to this problem?

Cheers,

Oscar.

----- Original Message ----- 
From: "Frank Warmerdam" <fwarmerdam@gmail.com>
To: "Stephane Routelous" <route@cae.com>
Cc: <gdal-dev@remotesensing.org>
Sent: Tuesday, March 01, 2005 7:17 PM
Subject: Re: [Gdal-dev] missing/wrong compiler option in nmake.opt


> On Tue, 1 Mar 2005 11:01:03 -0500, Stephane Routelous <route@cae.com> 
> wrote:
>> Hi,
>>
>> the flag /MDd (Debug Multithread Dll) is missing in the OPTFLAGS for the
>> debug version in nmake.opt to compile on windows with VisualC++ for 1.25
>> in the daily build (20050301.zip) the flag should be /MDd and not /MD
>
> Stephane,
>
> When I build debug versions of GDAL I always use the non-debug
> runtime library to avoid various complexities.  I realize that others may
> not want to do this and will want to use /MDd, which is fine, but I
> have set things up the way they are on purpose.
>
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 



From grevedan at hotmail.com  Wed May  4 11:03:30 2005
From: grevedan at hotmail.com (Dan Greve)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Web link - AIG format
Message-ID: <BAY102-F176E79E611BAB4384BC196C7190@phx.gbl>

Frank,

I was looking for the specification on the gdal website for the AIG Arc/Info 
Binary Grid format, but the link was bad.   Can you check this link, or post 
the spec?

http://www.remotesensing.org:16080/gdal/frmt_various.html#AIG

"Format description" -> http://gdal.velocet.ca/projects/aigrid/index.html


Thanks!

-- Dan Greve
-- Melbourne, FL



From predator2448 at hotmail.com  Wed May  4 12:39:30 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] No reprojection occurs
In-Reply-To: <931f8ea9050502132369db1ebb@mail.gmail.com>
Message-ID: <BAY104-F138DCFE719DE5D6DA3E83BCE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/975e17fc/attachment.html
From fwarmerdam at gmail.com  Wed May  4 13:44:41 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Web link - AIG format
In-Reply-To: <BAY102-F176E79E611BAB4384BC196C7190@phx.gbl>
References: <BAY102-F176E79E611BAB4384BC196C7190@phx.gbl>
Message-ID: <931f8ea905050410445e8edcf7@mail.gmail.com>

On 5/4/05, Dan Greve <grevedan@hotmail.com> wrote:
> Frank,
> 
> I was looking for the specification on the gdal website for the AIG Arc/Info
> Binary Grid format, but the link was bad.   Can you check this link, or post
> the spec?
> 
> http://www.remotesensing.org:16080/gdal/frmt_various.html#AIG
> 
> "Format description" -> http://gdal.velocet.ca/projects/aigrid/index.html

Dan,

I have committed a fix for the link.  It should now be:

 http://home.gdal.org/projects/aigrid/index.html

Access may be intermittent since that is my home server.
 
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed May  4 13:58:30 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] missing/wrong compiler option in nmake.opt
In-Reply-To: <022c01c550b2$ed22d190$a001a8c0@Oscar>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D3B0@caemsx03.cae.ca>
	<931f8ea905030109173bac87c0@mail.gmail.com>
	<022c01c550b2$ed22d190$a001a8c0@Oscar>
Message-ID: <931f8ea905050410587bc03b67@mail.gmail.com>

On 5/4/05, Oscar ter Hofstede <oscar@geovirtual.es> wrote:
> Hi,
> 
> I am trying to build a debug version of my application with the latest
> version of GDAL (1.2.6), including MrSid and ECW support.
> 
> I need to build with the debug run-time libraries (by specifying the option
> /MDd), since some other libraries I use are using debug functions that are
> only defined there (CrtDbgReport). However, if I build both my application
> and GDAL with the /MDd option, the application crashes in GDALClose() when
> closing a MrSid or ECW dataset.
> 
> Has this something to do with the MrSid and ECW libraries not being compiled
> with /MDd? I downloaded the latest versions of their libraries from their
> websites last week. Is there a solution to this problem?

Oscar,

I suspect this is because when using the debug libraries, more runtime
heap checking is done, and one or both of the MrSID and ECW drivers
have some memory bugs.  I believe ERMapper submitted a fix for a
cleanup-time bug in my ECW driver code just a week or two ago, so 
1.2.6 would still be suffering from that.   I'm not sure why there would
be such a problem with MrSID.  It could be something latent.

It is also possible that mixing /MDd GDAL libraries with non-debug
versions of MrSID and ECW libraries causes problems but it seems the
problem would arise before close time.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed May  4 14:02:44 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] No reprojection occurs
In-Reply-To: <BAY104-F138DCFE719DE5D6DA3E83BCE190@phx.gbl>
References: <931f8ea9050502132369db1ebb@mail.gmail.com>
	<BAY104-F138DCFE719DE5D6DA3E83BCE190@phx.gbl>
Message-ID: <931f8ea905050411023e12daf8@mail.gmail.com>

On 5/4/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> INPUT: 
>   
> PROJCS["NAD83 / UTM zone
> 17N",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS
> 1980",6378137,298.2572221010002,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4269"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-81],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","26917"]]
>   
> OUTPUT: 
>   
> GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.2572235630016,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4326"]]
>   
>          I used the above in the Compose Dataset function in OpenEV and
> using the geotransform reprojection I converted the original geotiff from
> NAD83 to WGS84, the result came out to be what I expected from the
> beginning, which is a slightly rotated image and slightly squished from top
> to bottom. I do not know how OpenEV uses GDAL to make the correct
> transformation, but in my case it does not work. If someone can help me I
> would really appreciate it. Thank you very much ahead. I pasted the code
> below. I could make screenshots if that would help. 

Ilya, 

In the above case with OpenEV you are actually going from 
UTM 11N NAD83 to Lat/Long WGS84, so it is a very significant 
conversion.  The conversion being going from UTM to lat/long.  

Internally NAD83 and WGS84 are considered identical by the
GDAL and PROJ.4 code, so that reprojection should never have
an effect.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From rsheykhet at sanz.com  Wed May  4 14:38:59 2005
From: rsheykhet at sanz.com (Sheykhet, Rostic)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] RasterIO on bands with ColorTable
Message-ID: <ED3A48B9840E594890A2BC172D119465033311C2@mailman.san.com>

Hello,

I am trying to perform RasterIO on a band that references a color table.
When the source and destination image dimensions are different, I get
back a band that has indexes into blank/invalid color table entries.  I
assume this is because of the decimation procedure.  Is there a way to
modify this behavior?


Thanks,

Rostic

 

From fwarmerdam at gmail.com  Wed May  4 15:03:20 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] RasterIO on bands with ColorTable
In-Reply-To: <ED3A48B9840E594890A2BC172D119465033311C2@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465033311C2@mailman.san.com>
Message-ID: <931f8ea9050504120341efb3c8@mail.gmail.com>

On 5/4/05, Sheykhet, Rostic <rsheykhet@sanz.com> wrote:
> Hello,
> 
> I am trying to perform RasterIO on a band that references a color table.
> When the source and destination image dimensions are different, I get
> back a band that has indexes into blank/invalid color table entries.  I
> assume this is because of the decimation procedure.  Is there a way to
> modify this behavior?

Rostic,

RasterIO() level resampling should all be "nearest neighbour", and so
not introduce any new values.   Is it possible you have built overviews
on the file in question with averaging?  Perhaps the format is a lossy
compression format? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Wed May  4 15:05:58 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
Message-ID: <BAY104-F932E7BCE2B531C2818BB8CE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/ef2812d6/attachment.html
From fwarmerdam at gmail.com  Wed May  4 15:10:44 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <BAY104-F932E7BCE2B531C2818BB8CE190@phx.gbl>
References: <BAY104-F932E7BCE2B531C2818BB8CE190@phx.gbl>
Message-ID: <931f8ea90505041210a003234@mail.gmail.com>

On 5/4/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> 
> Hello Frank, 
>   
>        Thanks for clearing this up. I am not sure how to project from UTM
> NAD83 to Lat/Long WGS84. In your example application, namely gdalwrap, there
> is a option "+proj=latlong" which would be specified for the -t_srs in order
> to go from whatever the projection of the source into lat and long, I tried
> that and it works, but I do not know how to set this up inside my code, I
> tried using importFromProj4("+proj=longlat"), which should
> automatically set the lat/long option into the srs object I am about to
> assign to the destination image, like this: 

Ilya, 

And did the example you gave not work? In what way does it fail? 
Do the pszSrcWKT and pszDstWKT seem OK? 
   
> OGRSpatialReference oSRS; 
>     //oSRS.SetUTM(17, TRUE); 
>     //oSRS.SetWellKnownGeogCS("WGS84");
>  oSRS.importFromProj4("+proj=longlat"); 

I would encourage you to be specific about the datum.  So 
you could do:

  oSRS.importFromProj4( "+proj=latlong +datum=WGS84" );

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Wed May  4 15:26:52 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <931f8ea90505041210a003234@mail.gmail.com>
Message-ID: <BAY104-F24376DB8850F8A1AEFDDB8CE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/92a42b18/attachment.html
From predator2448 at hotmail.com  Wed May  4 15:30:30 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <931f8ea90505041210a003234@mail.gmail.com>
Message-ID: <BAY104-F30D1B4AD0AFEBB1567C57ECE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/9509450b/attachment.html
From fwarmerdam at gmail.com  Wed May  4 15:36:04 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <BAY104-F24376DB8850F8A1AEFDDB8CE190@phx.gbl>
References: <931f8ea90505041210a003234@mail.gmail.com>
	<BAY104-F24376DB8850F8A1AEFDDB8CE190@phx.gbl>
Message-ID: <931f8ea9050504123666a2ad7e@mail.gmail.com>

On 5/4/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> 
>  
> 
> Hello Frank, 
> 
>        It does not fail in a sense that it crashes, it just doesn't do
> anything to the image as was the case before I added projection to be
> latlong. The pszSrcWKT, and pszDstWKT seem to correct, and the functions
> that compose the latter do not complain either. Here is the code I use, I
> apologize for the mess, don't want to erase experimental lines: 

Ilya, 

If you boil this down to a simple commandline program with the
filenames hardcoded, and also provide the input data file I will
try and figure out what is happening here.   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Wed May  4 16:14:59 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <931f8ea9050504123666a2ad7e@mail.gmail.com>
Message-ID: <BAY104-F3757144930A8CF508F2601CE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/bc7d0578/attachment.html
From predator2448 at hotmail.com  Wed May  4 16:47:18 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <931f8ea9050504123666a2ad7e@mail.gmail.com>
Message-ID: <BAY104-F3636CF156439794EF4A6B1CE190@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050504/b77926d9/attachment.html
From fwarmerdam at gmail.com  Wed May  4 17:18:08 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <BAY104-F3636CF156439794EF4A6B1CE190@phx.gbl>
References: <931f8ea9050504123666a2ad7e@mail.gmail.com>
	<BAY104-F3636CF156439794EF4A6B1CE190@phx.gbl>
Message-ID: <931f8ea905050414185f206861@mail.gmail.com>

On 5/4/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> 
> Hello Frank, 
> 
>        Sorry for bothering you again. I pasted the code from command line
> version back into the visual c++ version and the same problem, for some
> reason vc++ version does not process the image correctly having exactly the
> same code as command line that works nicely. I could send you my data file
> but it is a 75 MB geotiff.

Ilya, 

Sorry, I don't know what to say.  There is obviously some difference
and you will need to figure it out. 

Perhaps in the VC++ version the environment is different and the
PROJ.DLL can't be found?   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From rsheykhet at sanz.com  Wed May  4 17:40:52 2005
From: rsheykhet at sanz.com (Sheykhet, Rostic)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] RasterIO on bands with ColorTable
Message-ID: <ED3A48B9840E594890A2BC172D1194650333129D@mailman.san.com>

Frank,

The pyramid .ovr file contained 3-band raster data and I was reading
just the red band.  Sorry for the confusion.

Thanks a lot.

Rostic

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Sent: Wednesday, May 04, 2005 1:03 PM
To: Sheykhet, Rostic
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] RasterIO on bands with ColorTable

On 5/4/05, Sheykhet, Rostic <rsheykhet@sanz.com> wrote:
> Hello,
> 
> I am trying to perform RasterIO on a band that references a color
table.
> When the source and destination image dimensions are different, I get 
> back a band that has indexes into blank/invalid color table entries.  
> I assume this is because of the decimation procedure.  Is there a way 
> to modify this behavior?

Rostic,

RasterIO() level resampling should all be "nearest neighbour", and so
not introduce any new values.   Is it possible you have built overviews
on the file in question with averaging?  Perhaps the format is a lossy
compression format? 

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From predator2448 at hotmail.com  Wed May  4 22:36:25 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] UTM to Lat/Long projection
In-Reply-To: <931f8ea905050414185f206861@mail.gmail.com>
Message-ID: <BAY104-F39BD166910DB0F81BA3F21CE1A0@phx.gbl>

Hello Frank,

       I tried it again at home, in visual studio .net, I fiddled around 
with the paths in project settings and indeed by setting every possible path 
to GDAL main directory and by putting proj.dll in it as well the image 
reprojection worked.

                 Thanks again.

                                Ilya.

&gt;From: Frank Warmerdam &lt;fwarmerdam@gmail.com&gt;
&gt;Reply-To: warmerdam@pobox.com
&gt;To: Ilya Serebrianik &lt;predator2448@hotmail.com&gt;
&gt;CC: gdal-dev@xserve.flids.com
&gt;Subject: Re: [Gdal-dev] UTM to Lat/Long projection
&gt;Date: Wed, 4 May 2005 17:18:08 -0400
&gt;
&gt;On 5/4/05, Ilya Serebrianik &lt;predator2448@hotmail.com&gt; wrote:
&gt; &gt;
&gt; &gt; Hello Frank,
&gt; &gt;
&gt; &gt;        Sorry for bothering you again. I pasted the code from 
command line
&gt; &gt; version back into the visual c++ version and the same problem, for 
some
&gt; &gt; reason vc++ version does not process the image correctly having 
exactly the
&gt; &gt; same code as command line that works nicely. I could send you my 
data file
&gt; &gt; but it is a 75 MB geotiff.
&gt;
&gt;Ilya,
&gt;
&gt;Sorry, I don't know what to say.  There is obviously some difference
&gt;and you will need to figure it out.
&gt;
&gt;Perhaps in the VC++ version the environment is different and the
&gt;PROJ.DLL can't be found?
&gt;
&gt;Best regards,
&gt;--
&gt;---------------------------------------+--------------------------------------
&gt;I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
&gt;light and sound - activate the windows | http://pobox.com/~warmerdam
&gt;and watch the world go round - Rush    | Geospatial Programmer for Rent



From ARyan at co.linn.or.us  Thu May  5 14:14:35 2005
From: ARyan at co.linn.or.us (Ryan, Adam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
Message-ID: <8292E3D1E5E2EF4A94C36FE80D2443A83A82CF@linnms,>


Hi,

I tried to use Geometry.Intersect with a wkbGeometryCollection type Geometry
and got hung.  Is this not permited?

Thanks, Adam
 

From fwarmerdam at gmail.com  Thu May  5 14:22:11 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
In-Reply-To: <-8581586349320456738@unknownmsgid>
References: <-8581586349320456738@unknownmsgid>
Message-ID: <931f8ea905050511227f76366c@mail.gmail.com>

On 5/5/05, Ryan, Adam <ARyan@co.linn.or.us> wrote:
> 
> Hi,
> 
> I tried to use Geometry.Intersect with a wkbGeometryCollection type Geometry
> and got hung.  Is this not permited?

Adam,

I am not aware of a problem with this, but then I doubt I have specifically
tried it.  Can you prepare a relatively simple example to trigger this 
problem?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ARyan at co.linn.or.us  Thu May  5 14:24:16 2005
From: ARyan at co.linn.or.us (Ryan, Adam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
Message-ID: <8292E3D1E5E2EF4A94C36FE80D2443A83A82D0@linnms,>

Absolutely, just let me get all my ducks in a row...
Adam 


> -----Original Message-----
> From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
> Sent: Thursday, May 05, 2005 11:22 AM
> To: Ryan, Adam
> Cc: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
> 
> 
> On 5/5/05, Ryan, Adam <ARyan@co.linn.or.us> wrote:
> > 
> > Hi,
> > 
> > I tried to use Geometry.Intersect with a wkbGeometryCollection type 
> > Geometry and got hung.  Is this not permited?
> 
> Adam,
> 
> I am not aware of a problem with this, but then I doubt I 
> have specifically tried it.  Can you prepare a relatively 
> simple example to trigger this 
> problem?
> 
> Best regards,
> -- 
> ---------------------------------------+----------------------
> ----------
> ---------------------------------------+------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial 
> Programmer for Rent
> 

From ARyan at co.linn.or.us  Thu May  5 18:37:33 2005
From: ARyan at co.linn.or.us (Ryan, Adam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
Message-ID: <8292E3D1E5E2EF4A94C36FE80D2443A83A82D2@linnms,>


> -----Original Message-----
> From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
> Sent: Thursday, May 05, 2005 11:22 AM
> To: Ryan, Adam
> Cc: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
> 
> 
> On 5/5/05, Ryan, Adam <ARyan@co.linn.or.us> wrote:
> > 
> > Hi,
> > 
> > I tried to use Geometry.Intersect with a wkbGeometryCollection type 
> > Geometry and got hung.  Is this not permited?
> 
> Adam,
> 
> I am not aware of a problem with this, but then I doubt I 
> have specifically tried it.  Can you prepare a relatively 
> simple example to trigger this 
> problem?


Frank, thanks for your reply on this.  I'm still on the steep learning curve
here so bear with me.  I've made a little test script and have noted what
works and what doesn't.

The goal for me is to write a generic theme-on-theme spatial query method,
where you would pass an ogrQueryLayer and an ogrSelectLayer with a
selectList (of record indexes obtained from a previous query that likely
involved mapscript and not ogr directly) and a method (for this test I just
do an intersect) and a mode (new, and, or, xor, not - for later) and
optionally an queryList(again, later).

This test is a step towards that goal.  Any advice on how to optimize for
speed would be greatly appreciated (including rewriting using a whole
different approach).

But first, one comment about pymod.ogr.Geometry.Empty().
When I try:
selectPoly.Empty()
I get:
TypeError: Empty() takes exactly 2 arguments (1 given)
If I change ogr.py from:
    def Empty( self, other_geom ):
        return _gdal.OGR_G_Empty( self._o, other_geom._o )
to:
    def Empty( self ): #   , other_geom ):
        return _gdal.OGR_G_Empty( self._o ) #   , other_geom._o )
It seems to work.

And my test script.  Note that I'm using Howard Butler's ogr.py for python24
on Windows XP:
--------------

#!C:\python24\python.exe

from pymod import ogr,gdal

#   queryLayer is the layer I want a result list for
#   selectLayer is the layer that's previously been queried
#   selectList is the list of record numbers from the previous query
#
#   This will return a list of queryLayer indexes, or an empty list  
#
def intersectByList(queryLayer,selectLayer,selectList):
    
    from pymod import ogr,gdal
    import sys
    import time
    
    #   Keep track of time so I can try to optimize performance
    starttime = time.clock()
    
    #   Start a polygon geometry of feature envelopes
    #   that get all unioned together
    selectEnvelopes = ogr.Geometry(ogr.wkbPolygon)

    #   Start a geometryCollection of select Geometries
    selectGeomCol = ogr.Geometry(ogr.wkbGeometryCollection)

    #   Create a couple of geometries that I use when processing
    #   the envelopes
    selectPoly = ogr.Geometry(ogr.wkbPolygon)
    selectRing = ogr.Geometry(ogr.wkbLinearRing)

    #   Step through the passed record list
    for selectRec in selectList:
    
        #   Get the select Feature and Geometry
        selectFea = selectLayer.GetFeature(selectRec)
        selectGeom = selectFea.GetGeometryRef()
        
        #   Add the Geometry to our collection
        selectGeomCol.AddGeometry(selectGeom.Clone())
        
        #   Add the points of the envelope to the selectRing
        #   and add it to the selectPoly 
        selectEnv = selectGeom.GetEnvelope()
        selectRing.AddPoint(selectEnv[0],selectEnv[2])
        selectRing.AddPoint(selectEnv[1],selectEnv[2])
        selectRing.AddPoint(selectEnv[1],selectEnv[3])
        selectRing.AddPoint(selectEnv[0],selectEnv[3])
        selectRing.AddPoint(selectEnv[0],selectEnv[2])
        selectPoly.AddGeometry(selectRing)
        
        #   Union the existing selectEnvelopes with this polygon
        selectEnvelopes = selectEnvelopes.Union(selectPoly)
        
        #   CleanUp
        selectPoly.Empty()
        selectRing.Empty()
        selectFea.Destroy()

    #   Check time
    print "Made envelops in: ", time.clock() 
                   
    #   Set a spatial filter on the qlayer with selectEnvelopes
    queryLayer.SetSpatialFilter(selectEnvelopes) 

    #   Check time
    print "SetSpatialFilter in : ", time.clock() 
    
    #   Start the return list
    queryList = []

    #    Step through the query features and test for intersect
    queryFeature = queryLayer.GetNextFeature()    
    while queryFeature is not None:
        
        queryGeom = queryFeature.GetGeometryRef()
        
        
        #-------------------------------------
        """#***** This doesn't work:
        
        #   Test for Intersect against select collection
        if queryGeom.Intersect(selectGeomCol):
            queryList.append(queryFeature.GetFID())
        
        """
        #-------------------------------------
        #   So I do the following ...                       
                       
        #   Step through the list of features in the select collection
        for selectI in range(selectGeomCol.GetGeometryCount()):
            
            #   Get one select geometry out of the collection
            selectGeom = selectGeomCol.GetGeometryRef(selectI)
            
            #   Test for Intersect and if true move on to next query Feature
            if queryGeom.Intersect(selectGeom):
                queryList.append(queryFeature.GetFID())
                break
        #-------------------------------------

        
        queryFeature.Destroy()
        queryFeature = queryLayer.GetNextFeature() 
   
   
    #   Check time
    print "Intersected in : ", time.clock() 
       
    #   Return the list
    return queryList
    
#===========================    
    
#   RUN TIME    
    
#   Open ogr select layer
ogrSDS = ogr.Open("c:/gis/shapefiles/surveys.shp")
ogrSlayer = ogrSDS.GetLayer(0)

slayerSet = [27735, 27776, 27782, 27784, 27794, 27795, 27806, 27810, 27812,
27815, 27816, 27829, 27833, 27835, 27838, 27846, 27850, 27851, 27863, 27870,
27877, 27878, 27883, 27884, 27892, 27898, 27899, 27902, 27903, 27905, 27906,
27908, 27910, 27917, 27925, 27942, 27951, 27952, 27953] 

#   Open ogr query layer
ogrQDS = ogr.Open("c:/gis/shapefiles/taxlots.shp")
ogrQlayer = ogrQDS.GetLayer(0)
    
#   Get the intersect list
qlayerSet = intersectByList(ogrQlayer,ogrSlayer,slayerSet)

print qlayerSet

ogrSDS.Destroy()
ogrQDS.Destroy() 

-----

Thanks for any help.  The speed is OK if I'm noodling around on my own, but
kind of slow for a weblication.  Like I said, I'm still learning lots daily.
Cheers,

Adam

From fwarmerdam at gmail.com  Thu May  5 18:49:54 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] ogr.py Intersect with wkbGeometryCollection
In-Reply-To: <4665896333369807336@unknownmsgid>
References: <4665896333369807336@unknownmsgid>
Message-ID: <931f8ea9050505154969517ea3@mail.gmail.com>

On 5/5/05, Ryan, Adam <ARyan@co.linn.or.us> wrote:
> The goal for me is to write a generic theme-on-theme spatial query method,
> where you would pass an ogrQueryLayer and an ogrSelectLayer with a
> selectList (of record indexes obtained from a previous query that likely
> involved mapscript and not ogr directly) and a method (for this test I just
> do an intersect) and a mode (new, and, or, xor, not - for later) and
> optionally an queryList(again, later).
> 
> This test is a step towards that goal.  Any advice on how to optimize for
> speed would be greatly appreciated (including rewriting using a whole
> different approach).

Adam,

I'm afraid I only skimmed the script.  A few thoughts: 

 o Union is pretty expensive.  
 o The spatial filter you end up with is going to be pretty complex I 
    think, so it will be quite expensive to evaluate whether things 
    intersect it.  I would suggest just setting an MBR rectangle for the
    spatial filter.  When you do your later Intersect() you can discard
    NULL results. 
 o In general speed is not GEOS's forte, and your could end up asking
    it to evaluate some pretty hard operations. 

> But first, one comment about pymod.ogr.Geometry.Empty().
> When I try:
> selectPoly.Empty()
> I get:
> TypeError: Empty() takes exactly 2 arguments (1 given)
> If I change ogr.py from:
>     def Empty( self, other_geom ):
>         return _gdal.OGR_G_Empty( self._o, other_geom._o )
> to:
>     def Empty( self ): #   , other_geom ):
>         return _gdal.OGR_G_Empty( self._o ) #   , other_geom._o )
> It seems to work.

Indeed, this was a bug in ogr.py.  I have applied the change in CVS. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From eric.sokolowsky at gsfc.nasa.gov  Fri May  6 13:45:39 2005
From: eric.sokolowsky at gsfc.nasa.gov (Eric Sokolowsky)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Gdalwarp and ImageMagick
In-Reply-To: <931f8ea905050212273085a1dd@mail.gmail.com>
References: <931f8ea9050502112578960b15@mail.gmail.com>
	<BAY104-F214E69182F05DFE7507B82CE270@phx.gbl>
	<931f8ea905050212273085a1dd@mail.gmail.com>
Message-ID: <Pine.LNX.4.61.0505061341350.13748@svsmail.gsfc.nasa.gov>

On Mon, 2 May 2005, Frank Warmerdam wrote:

> A light bulb just went off for me.  I am willing to bet you are using a
> simplistic GeoTIFF reader - perhaps ArcView or ArcGIS?  Many tools
> have trouble reading multi-band TIFFs with "band interleaving", the
> GDAL output default.   I would suggesting using the INTERLEAVE=PIXEL
> creation option.

This suggestion is also required for TIFF images to work with the
ImageMagick Tools (at least version 6.1.4).  To use with gdalwarp, just
add to the command line:

   -co INTERLEAVE=PIXEL

Thanks, Frank!  Gdalwarp is extremely useful in my work.  Now it is even
more so.

-- 
     ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center
    / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
   / __/ _/ / _/ 301.286.3751                  Mailstop 610.3 Bldg 28 Rm E102
  /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771

From predator2448 at hotmail.com  Fri May  6 16:27:36 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Cutting arbitrary piece of an image
Message-ID: <BAY104-F74EECB2DDF070DFC815FFCE1B0@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050506/e6696667/attachment.html
From JAMES.E.HOPPER at saic.com  Sun May  8 17:01:37 2005
From: JAMES.E.HOPPER at saic.com (James E. Hopper)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] gdal and mac
Message-ID: <F2018E1D-89DB-4185-A082-DF014A2F32F8@saic.com>

I am working on creating a mac framework based version of gdal.  i  
havent used the gdal tools before so i wanted to test the framework  
version out.  is there a test suite of images etc that i can use to  
validate that the framework version works like the library version  
created with make?

for instance if i use gdal_translate to convert a geotiff to jpeg i get

gdal_translate -of JPEG  1_10K_e16_0.tif temp.jpg
Input file size is 4608, 7680
ERROR 4: Failed to open temp.jpg.pam to read.


the output jpeg is fine, but what is a pam file and why am i getting  
a failure?

thanks jim


From fwarmerdam at gmail.com  Mon May  9 00:08:39 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] gdal and mac
In-Reply-To: <F2018E1D-89DB-4185-A082-DF014A2F32F8@saic.com>
References: <F2018E1D-89DB-4185-A082-DF014A2F32F8@saic.com>
Message-ID: <931f8ea9050508210859523017@mail.gmail.com>

On 5/8/05, James E. Hopper <JAMES.E.HOPPER@saic.com> wrote:
> I am working on creating a mac framework based version of gdal.  i
> havent used the gdal tools before so i wanted to test the framework
> version out.  is there a test suite of images etc that i can use to
> validate that the framework version works like the library version
> created with make?

James, 

There is a python based test suite available at:
   http://www.gdal.org/dl/gdalautotest-1.2.6.tar.gz

If GDAL is properly built with python support, just go into the
unpacked directory, and run the "run_all.py" script. 

> for instance if i use gdal_translate to convert a geotiff to jpeg i get
> 
> gdal_translate -of JPEG  1_10K_e16_0.tif temp.jpg
> Input file size is 4608, 7680
> ERROR 4: Failed to open temp.jpg.pam to read.
> 
> the output jpeg is fine, but what is a pam file and why am i getting
> a failure?

GDAL is currently in some chaos as "PAM" support is added.  You 
should consider packaging GDAL 1.2.6 unless you have a specific
need of desire to have the latest and greatest.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From support at geoimage.fr  Mon May  9 05:32:52 2005
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Help on writing a new OGR driver
Message-ID: <24c601c5547a$187289b0$0a01a8c0@pili>

Hello,

I need to add support for a new format to OGR.

This new driver must have read access and at least sequential write.

The format itself is quite simple :

a "List" file describes the available layers :

------------------------------------------------------------------------------------------------------------------------
-----
RAYTRACE     Buildings0_0.vec    417285 4921000      428400 4932380      Buildings
RAYTRACE     Vegetation0_0.vec   417340 4921000      428400 4932403      Vegetation
GENAMAP19    Water0_1.vec         428400 4921000      438532 4931908      Water
GENAMAP19    Roads1_1.vec     428400 4909035      439343 4921000      Roads
GENAMAP19    Roads0_1.vec     428400 4921000      440200 4932633      Roads
GENAMAP19    Roads1_0.vec     417229 4909254      428400 4921000      Roads
GENAMAP19    Roads0_0.vec     417322 4921000      428400 4932634      Roads
------------------------------------------------------------------------------------------------------------------------
-----

Each layer may be tiled ( like roads in this example ).

geometries are stored in simple ASCII files (.vec). :

------------------------------------------------------------------------------------------------------------------------
-----
1              Buildings                          11
429054.57 4928806.60
429057.58 4928804.19
429060.59 4928807.20
429066.01 4928802.39
429058.19 4928792.76
429056.38 4928793.36
429052.08 4928788.79
429046.80 4928792.04
429051.57 4928798.18
429049.16 4928799.98
429054.57 4928806.60
2              Buildings                          5
429095.14 4928805.45
429098.79 4928802.60
429095.95 4928797.32
429091.48 4928800.57
429095.14 4928805.45
3              Buildings                          7
429109.36 4928795.70
429123.57 4928787.57
429116.67 4928779.85
------------------------------------------------------------------------------------------------------------------------
-----

I think to choose "List" as the file representing the OGRDataSource, each Layer will appears as an OGRLayer
( automatically untiled if necessary ).

Is there any tutorial on writing new driver for OGR ?
What is the best existing driver to select as a template for this case ?

Thanks for any hints or comments and excuse me for my poor english...

Fr?d?ric.
_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From asger at jo-informatik.dk  Mon May  9 07:54:28 2005
From: asger at jo-informatik.dk (Asger Petersen)
Date: Wed Nov 21 11:49:37 2007
Subject: [Gdal-dev] Possible bug: numeric file name and gcps
Message-ID: <6A0257B028DA47499B5A843683051A36068ED5@server01.jo-informatik.local>

Hi

I grew some gray hair finding out, that you can?t have a numeric filename when you use gcps with gdal_translate.

This works:
gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 ht200414_06_7631.ecw ht200414_06_7631gcp.jp2

This doesn't work:
gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 200414_06_7631.ecw 200414_06_7631gcp.jp2

If you don't use gcps, there are no problems with numeric filenames. So this also works:
gdal_translate -of JP2KAK 200414_06_7631.ecw 200414_06_7631gcp.jp2

(I have only tried with gdal from fwtools 0.9.8.)

Regards
Asger Petersen

From james.e.hopper at saic.com  Mon May  9 08:46:21 2005
From: james.e.hopper at saic.com (James E.Hopper)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdal and mac
Message-ID: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>

Hi,

thanks for the answers.  i build gdal with python it fails to build  
so i turned it off.  i know you have a mac now, can you tell me how  
you get it to build with python??

my xcode project for building gdal is pretty nice.  and i like  
frameworks a lot better than libraries.  they package both the  
library and the header files in a single bundle that you can drag and  
drop into your installation.

i want to create a mac installer when i get it working so i will go  
back to 1.2.6.  when i get that done do you have room to add it onto  
the website?

best jim




> There is a python based test suite available at:
>    http://www.gdal.org/dl/gdalautotest-1.2.6.tar.gz
>
> If GDAL is properly built with python support, just go into the
> unpacked directory, and run the "run_all.py" script.
>
>


From fwarmerdam at gmail.com  Mon May  9 09:32:29 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdal and mac
In-Reply-To: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
References: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
Message-ID: <931f8ea9050509063265ecaa3a@mail.gmail.com>

On 5/9/05, James E. Hopper <james.e.hopper@saic.com> wrote:
> Hi,
> 
> thanks for the answers.  i build gdal with python it fails to build
> so i turned it off.  i know you have a mac now, can you tell me how
> you get it to build with python??

James, 

I build --without-libtool to get python support working.  

> my xcode project for building gdal is pretty nice.  and i like
> frameworks a lot better than libraries.  they package both the
> library and the header files in a single bundle that you can drag and
> drop into your installation.

My concern with Frameworks is that it isn't an "out of the box"
style install and it may be difficult for me to support if it puts
stuff in odd places, and requires different rules to link against.
Will you be fixing up gdal-config to return correct information?
 
> i want to create a mac installer when i get it working so i will go
> back to 1.2.6.  when i get that done do you have room to add it onto
> the website?

Certainly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From eric.doenges at gmx.net  Mon May  9 10:11:55 2005
From: eric.doenges at gmx.net (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdal and mac
In-Reply-To: <931f8ea9050509063265ecaa3a@mail.gmail.com>
References: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
	<931f8ea9050509063265ecaa3a@mail.gmail.com>
Message-ID: <f55e2a97ffa483a04f292ece29ea3805@gmx.net>


Am 09.05.2005 um 15:32 schrieb Frank Warmerdam:

> My concern with Frameworks is that it isn't an "out of the box"
> style install and it may be difficult for me to support if it puts
> stuff in odd places, and requires different rules to link against.
> Will you be fixing up gdal-config to return correct information?

Actually, frameworks are IMO more "out of the box" on MacOS X than 
installing
to /usr/local/ ever could be. The only thing wrong with frameworks is 
that you
need to know at compile time where you are going to be installing the 
framework
if it's not going to be one of the "standard" locations, i.e. if you 
want an
embedded framework.

I did some work on this a long time ago (gdal 1.1.9 on MacOS 10.2) that 
I could
resurrect (the application I'm working on switched to statically 
linking gdal to
reduce the required download size, since providing gdal as a separate 
download is not
an option in my case). I did the following to get a working framework:

a) patched GDALconfig.opt to create a framework. (I lack the courage 
required to
    mess with the configure mechanism 8^)
b) patched cpl_findfile.cpp to look for gdal-specific resources in the 
application's
    main bundle. Unfortunately, the code that looked in the framework's 
bundle
    seems to have been lost in a CVS restructure; but it shouldn't be 
that different
    from looking in the application's main bundle.

I used the built-in libraries for tiff, png and jpg to avoid creating 
dependencies
on libraries not included with MacOS X by default. For MacOS X, this 
leads to a further problem because Apple has a bug in their libraries 
that exports a symbol from
their PNG implementation which clashes with libpng 1.2.6. I submitted a 
bug report
to Apple, but have no idea if they fixed it for 10.4 (haven't received 
my DVD yet).
Come to think of it, I guess Frank is right that this is not really
"out of the box" 8^).

Nevertheless, if anyone is interested in getting this to work, I'll 
send you my notes
on what I did (and my modified cpl_findfile.cpp). The hard work will be 
modifying
the autoconf/automake stuff though.

With kind regards,
Eric


From fwarmerdam at gmail.com  Mon May  9 10:26:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdal and mac
In-Reply-To: <f55e2a97ffa483a04f292ece29ea3805@gmx.net>
References: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
	<931f8ea9050509063265ecaa3a@mail.gmail.com>
	<f55e2a97ffa483a04f292ece29ea3805@gmx.net>
Message-ID: <931f8ea90505090726127c4d5b@mail.gmail.com>

On 5/9/05, Eric D?nges <eric.doenges@gmx.net> wrote:
> Actually, frameworks are IMO more "out of the box" on MacOS X than
> installing
> to /usr/local/ ever could be.

Eric,

My out-of-the-box, I meant it ends up installing differently than
a "configure; make install" from the distributed GDAL source package.
Applications with configure logic setup to look for a conventional
install tree under a normal install tree organization are likely to run
into problems.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon May  9 10:30:35 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Possible bug: numeric file name and gcps
In-Reply-To: <6A0257B028DA47499B5A843683051A36068ED5@server01.jo-informatik.local>
References: <6A0257B028DA47499B5A843683051A36068ED5@server01.jo-informatik.local>
Message-ID: <931f8ea9050509073079fda338@mail.gmail.com>

On 5/9/05, Asger Petersen <asger@jo-informatik.dk> wrote:
> Hi
> 
> I grew some gray hair finding out, that you can?t have a numeric filename when you use gcps with gdal_translate.
> 
> This works:
> gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 ht200414_06_7631.ecw ht200414_06_7631gcp.jp2
> 
> This doesn't work:
> gdal_translate -of JP2KAK -gcp 0 0 702530.030 6172016.512 200414_06_7631.ecw 200414_06_7631gcp.jp2
> 
> If you don't use gcps, there are no problems with numeric filenames. So this also works:
> gdal_translate -of JP2KAK 200414_06_7631.ecw 200414_06_7631gcp.jp2

Asger, 

The problem is that there is an optional elevation argument in the
-gcp switch.  The usage message should look like this (now updated):

   [-gcp pixel line easting northing [elevation]]*

In order to determine if an elevation is supplied, the program tries
to read a numeric value from the argument.  If it gets a non-zero 
value it treats it as elevation. 

I appologise for the needless misery this hackey approach has
caused you.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon May  9 10:59:38 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Help on writing a new OGR driver
In-Reply-To: <24c601c5547a$187289b0$0a01a8c0@pili>
References: <24c601c5547a$187289b0$0a01a8c0@pili>
Message-ID: <931f8ea905050907597ddc9a4b@mail.gmail.com>

On 5/9/05, Fr?d?ric Trastour <support@geoimage.fr> wrote:
> I think to choose "List" as the file representing the OGRDataSource, each Layer will appears as an OGRLayer
> ( automatically untiled if necessary ).

Fr?d?ric,

This seems sensible.  I think the untiling is going to be the messiest
part of this.  It is important that the feature id for all features in a
given layer be unique and ideally persistant from invocation to
invocation (though that can be related for specific drivers).  

Are you wanting to take advantage of spatial queries to only 
open required tiles, or is your use not very performance sensitive?

> Is there any tutorial on writing new driver for OGR ?

Unfortunately, there is no tutorial at this time on writing OGR 
drivers. 

> What is the best existing driver to select as a template for this case ?

Good question.   The GML driver is a nice example of a driver 
supporting simple output creation.   The GML driver is also a fairly
straight forward spatial format reader if you only look at the 
"ogrgml*.cpp" files.  The low level GML code is a bit of a nightmare. 

The S57 and NTF drivers are both examples where many files are
treated as seamless layers.   But they are both also complicated for
other reasons and so looking through them may be somewhat 
complicated. 

> Thanks for any hints or comments and excuse me for my poor english...

My suggestion is that you first make a pass implementing the
driver in such a way that each tile is a separate layer.  Once 
you have that working smoothly then rework the driver to handle
the tiling issue.  At least then you can tackle the basic OGR learning
and then return to address the substantial complexities of the tiling.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bfraser at geoanalytic.com  Mon May  9 11:45:15 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Option to write ulxmap,ulymap,xdim,ydim to Ehdr format?
Message-ID: <046301c554ae$1833fc70$160002c0@shark>

Frank,

  Is there a command line option to have gdal_translate write ulxmap,
ulymap, xdim, ydim to the .hdr file of the Ehdr format?

Thanks!
Brent Fraser


From fwarmerdam at gmail.com  Mon May  9 12:24:47 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Option to write ulxmap, ulymap, xdim,
	ydim to Ehdr format?
In-Reply-To: <046301c554ae$1833fc70$160002c0@shark>
References: <046301c554ae$1833fc70$160002c0@shark>
Message-ID: <931f8ea905050909241fd5cac2@mail.gmail.com>

On 5/9/05, Brent Fraser <bfraser@geoanalytic.com> wrote:
> Frank,
> 
>   Is there a command line option to have gdal_translate write ulxmap,
> ulymap, xdim, ydim to the .hdr file of the Ehdr format?

Brent, 

The gdal_translate command has a -a_ullr switch for setting
the corners.  That is only in recent versions of GDAL.  Is that
what you want?

Hmm, on review, it seems the EHdr writer never writes out
geolocation information.  I guess that is the problem you are
running into? This is due to a very incomplete EHdr driver
implementation.  You could submit an enhancement request,
but unless it is a pressing need I am unlikely to implement it
in the near term.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bfraser at geoanalytic.com  Mon May  9 12:40:14 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Option to write ulxmap, ulymap, xdim,
	ydim to Ehdr format?
References: <046301c554ae$1833fc70$160002c0@shark>
	<931f8ea905050909241fd5cac2@mail.gmail.com>
Message-ID: <049701c554b5$c6621e60$160002c0@shark>

Frank,

  I'll file an enhancement request.  It's low priority for now...

Thanks!
Brent
> ----- Original Message ----- 
> From: "Frank Warmerdam" <fwarmerdam@gmail.com>
> To: "Brent Fraser" <bfraser@geoanalytic.com>
> Cc: "GDAL Dev" <gdal-dev@remotesensing.org>
> Sent: Monday, May 09, 2005 10:24 AM
> Subject: Re: [Gdal-dev] Option to write ulxmap,ulymap,xdim,ydim to Ehdr
format?
>

> On 5/9/05, Brent Fraser <bfraser@geoanalytic.com> wrote:
> > Frank,
> >
> >   Is there a command line option to have gdal_translate write ulxmap,
> > ulymap, xdim, ydim to the .hdr file of the Ehdr format?
>
> Brent,
>
> The gdal_translate command has a -a_ullr switch for setting
> the corners.  That is only in recent versions of GDAL.  Is that
> what you want?
>
> Hmm, on review, it seems the EHdr writer never writes out
> geolocation information.  I guess that is the problem you are
> running into? This is due to a very incomplete EHdr driver
> implementation.  You could submit an enhancement request,
> but unless it is a pressing need I am unlikely to implement it
> in the near term.
>
> Best regards,
> -- 
> ---------------------------------------+----------------------------------
----
> I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent


From predator2448 at hotmail.com  Mon May  9 16:27:38 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Single point projection
Message-ID: <BAY104-F227F70CE0576AC00CAEC45CE1E0@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050509/b4f6cdee/attachment.html
From fwarmerdam at gmail.com  Mon May  9 16:48:09 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Single point projection
In-Reply-To: <BAY104-F227F70CE0576AC00CAEC45CE1E0@phx.gbl>
References: <BAY104-F227F70CE0576AC00CAEC45CE1E0@phx.gbl>
Message-ID: <931f8ea9050509134869d7b1c8@mail.gmail.com>

On 5/9/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> 
> Hello, 
>   
>       I am trying to use the following to reproject a single point from utm
> to latlong, but it gives me an error (see after the code), apparently
> windows already uses the PVALUE definition: 
>   
>      #include <projects.h> 
>   
>       PJ *psPJSource;
>  PJ *psPJTarget; 
>  int err;
>  int nCount = 1; 
>  double x, y, z; 
>  x = 635999.000;
>  y = 4836001.200;
>  z = NULL; 
>  psPJSource = pj_init_plus("+proj=utm +zone=17 +datum=NAD83");
>  psPJTarget = pj_init_plus("+proj=latlong +datum=WGS84");
>  err = pj_transform( psPJSource, psPJTarget, nCount, 1, &x, &y, &z ); 

Ilya, 

Techniclally this is a PROJ.4 issue and would be better
addressed on that mailing list. 

The problem is that you are including projects.h, the "private"
PROJ.4 include file.  If you include proj_api.h, the public 
interfaces, you will not run into this incompatibility with windows.h.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From hamish_nospam at yahoo.com  Mon May  9 19:24:38 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdal and mac
In-Reply-To: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
References: <D63F6F0A-8CF3-4C62-BCCB-9F42C53A40F4@saic.com>
Message-ID: <20050510112438.18ec8619.hamish_nospam@yahoo.com>

> i want to create a mac installer when i get it working so i will go  
> back to 1.2.6.  when i get that done do you have room to add it onto  
> the website?


checkout Lorenzo Moretti's GDAL binaries & installer for mac, installed
as part of a bigger package of support libs for GRASS GIS. (GRASS is a
separate install, libs might be useful to you anyway (PROJ.4 etc))



Hamish

From l.bargeot at educagri.fr  Wed May 11 06:24:20 2005
From: l.bargeot at educagri.fr (Lionel Bargeot)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw compression on linux
Message-ID: <4281DD54.2090509@educagri.fr>

Hi all,

we would like to use gdal on linux to
- first gdal_translate geotiff images povided by a WMS server with gdal 
mapserver driver
- then produce directly with the WMS server an ecw output.

But we encounter difficulties, the ecw output is unreadable by soft like 
Erviewer or Ermapper. We tryed with our own compiled version and with 
the FWtools0.98 for linux precompiled version. Our system is debian/Gnu 
linux.
Can someone confirm that geotiff compression work with gdal on Linux  
with FWtools version or not ?

Thanks a lot

Lionel

-- 
Ing?nieur SIG
CNERTA-ENESAD, 2 rue champs-prevois, batiment grand-champs, 21000 Dijon
03.80.77.28.49
http://www.igcs-stb.org/




From t.r.decarlo at larc.nasa.gov  Wed May 11 09:05:55 2005
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Compiling gdal with MinGW/MSYS?
Message-ID: <007101c5562a$2adf2750$959877c6@cts1149>

Hi,
I'm trying for the first time to compile gdal with MinGW under Win2K. I
think I've got all the required MinGW packages, but the build is failing
with these messages:


make[1]: Entering directory `/s/OSG/gdal/port'
/bin/sh.exe ../libtool --mode=compile g++ -Wall  -O2    -I../port  -c -o 
cpl_vsil_unix_stdio_64.o cpl_vsil_unix_stdio_64.cpp
  g++ -Wall -O2 -I../port -c cpl_vsil_unix_stdio_64.cpp  -DDLL_EXPORT 
-DPIC -o .libs/cpl_vsil_unix_stdio_64.o
cpl_vsil_unix_stdio_64.cpp: In function `int VSIStat(const char*, 
VSIStatBuf*)':
cpl_vsil_unix_stdio_64.cpp:175: error: `stat64' undeclared (first use 
this function)
cpl_vsil_unix_stdio_64.cpp:175: error: (Each undeclared identifier is 
reported only once for each function it appears in.)
make[1]: *** [cpl_vsil_unix_stdio_64.o] Error 1
make[1]: Leaving directory `/s/OSG/gdal/port'
make: *** [port-target] Error 2

I suspect I'm missing something in the include path, but I thought the
./configure should have picked up all the appropriate stuff.

Can anyone give me more info about the proper setup of mingw for gdal?

Thanks,
Thom
--
Thom DeCarlo
-------------------------------------------------------
I know the Voices aren't REAL.
But, sometimes they have good ideas!




From l.bargeot at educagri.fr  Wed May 11 09:06:11 2005
From: l.bargeot at educagri.fr (Lionel Bargeot)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw compression on linux
In-Reply-To: <fc.3b9aca00ea6bbc643b9aca0064bc6bea.4b7e167@educagri.fr>
References: <fc.3b9aca00ea6bbc643b9aca0064bc6bea.4b7e167@educagri.fr>
Message-ID: <42820343.6040508@educagri.fr>

I confirm to myself. For gdal_translate, it was a stupid mistake. We 
obtain nice 8 bit ecw compressed image.
It works with specifying ecw outputformat for a WMS but we have poor 
color output image. It seems like a greyscaled image. We tryed different 
options, (IMAGEMODE particularly) but no improvement of the color.
Perhap's it's more a mapserver question and I will ask on another list.

Lionel


Lionel Bargeot wrote:

> Hi all,
>
> we would like to use gdal on linux to
> - first gdal_translate geotiff images povided by a WMS server with gdal
> mapserver driver
> - then produce directly with the WMS server an ecw output.
>
> But we encounter difficulties, the ecw output is unreadable by soft like
> Erviewer or Ermapper. We tryed with our own compiled version and with
> the FWtools0.98 for linux precompiled version. Our system is debian/Gnu
> linux.
> Can someone confirm that geotiff compression work with gdal on Linux  
> with FWtools version or not ?
>
> Thanks a lot
>
> Lionel
>
> -- 
> Ing?nieur SIG
> CNERTA-ENESAD, 2 rue champs-prevois, batiment grand-champs, 21000 Dijon
> 03.80.77.28.49
> http://www.igcs-stb.org/
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com <mailto:Gdal-dev@xserve.flids.com>
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>

-- 
Ing?nieur SIG
CNERTA-ENESAD, 2 rue champs-prevois, batiment grand-champs, 21000 Dijon
03.80.77.28.49
http://www.igcs-stb.org/




From fwarmerdam at gmail.com  Wed May 11 09:22:50 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Compiling gdal with MinGW/MSYS?
In-Reply-To: <007101c5562a$2adf2750$959877c6@cts1149>
References: <007101c5562a$2adf2750$959877c6@cts1149>
Message-ID: <931f8ea905051106225a04a09c@mail.gmail.com>

On 5/11/05, Thom DeCarlo <t.r.decarlo@larc.nasa.gov> wrote:
> Hi,
> I'm trying for the first time to compile gdal with MinGW under Win2K. I
> think I've got all the required MinGW packages, but the build is failing
> with these messages:

Thom,

As I'm sure you are aware, MINGW+cygwin is not a supported build environment.
I have never tried it myself though I understand others have been successful. 
 
> make[1]: Entering directory `/s/OSG/gdal/port'
> /bin/sh.exe ../libtool --mode=compile g++ -Wall  -O2    -I../port  -c -o
> cpl_vsil_unix_stdio_64.o cpl_vsil_unix_stdio_64.cpp
>   g++ -Wall -O2 -I../port -c cpl_vsil_unix_stdio_64.cpp  -DDLL_EXPORT
> -DPIC -o .libs/cpl_vsil_unix_stdio_64.o
> cpl_vsil_unix_stdio_64.cpp: In function `int VSIStat(const char*,
> VSIStatBuf*)':
> cpl_vsil_unix_stdio_64.cpp:175: error: `stat64' undeclared (first use
> this function)
> cpl_vsil_unix_stdio_64.cpp:175: error: (Each undeclared identifier is
> reported only once for each function it appears in.)
> make[1]: *** [cpl_vsil_unix_stdio_64.o] Error 1
> make[1]: Leaving directory `/s/OSG/gdal/port'
> make: *** [port-target] Error 2
> 
> I suspect I'm missing something in the include path, but I thought the
> ./configure should have picked up all the appropriate stuff.
> 
> Can anyone give me more info about the proper setup of mingw for gdal?

The configure script tries linking a program that calls fseek64.  If that
works, it is assumed that the platform has the fopen64, fseek64, 
ftell64, and stat64 functions and the stat64 type for stat buffers.  That
assumption is either wrong in your case, or we are missing some sort
of include file needed for stat64.  I don't know the solution.

If you don't especially need large file IO (read/write of files larger
than 2GB) then you could just configure "--without-unix-stdio-64".  
That should disable all this stuff.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From nhv at cape.com  Wed May 11 09:42:08 2005
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Compiling gdal with MinGW/MSYS?
In-Reply-To: <007101c5562a$2adf2750$959877c6@cts1149>
Message-ID: <EKEJIKAILPONGGENMBGAKEDNLGAA.nhv@cape.com>

Thom DeCarlo writes:
> 
> Hi,
> I'm trying for the first time to compile gdal with MinGW under Win2K. I
> think I've got all the required MinGW packages, but the build is failing
> with these messages:
> 
> 
> make[1]: Entering directory `/s/OSG/gdal/port'
> /bin/sh.exe ../libtool --mode=compile g++ -Wall  -O2    -I../port  -c -o 
> cpl_vsil_unix_stdio_64.o cpl_vsil_unix_stdio_64.cpp
>   g++ -Wall -O2 -I../port -c cpl_vsil_unix_stdio_64.cpp  -DDLL_EXPORT 
> -DPIC -o .libs/cpl_vsil_unix_stdio_64.o
> cpl_vsil_unix_stdio_64.cpp: In function `int VSIStat(const char*, 
> VSIStatBuf*)':
> cpl_vsil_unix_stdio_64.cpp:175: error: `stat64' undeclared (first use 
> this function)
> cpl_vsil_unix_stdio_64.cpp:175: error: (Each undeclared identifier is 
> reported only once for each function it appears in.)
> make[1]: *** [cpl_vsil_unix_stdio_64.o] Error 1
> make[1]: Leaving directory `/s/OSG/gdal/port'
> make: *** [port-target] Error 2
> 
> I suspect I'm missing something in the include path, but I thought the
> ./configure should have picked up all the appropriate stuff.
> 
> Can anyone give me more info about the proper setup of mingw for gdal?

Hi Thom

I had a similar problem and don't really know the correct way to fix this but ...

I just hand edited my cpl_config.h as attached and things seem to work OK

You will probably want to edit this line to reflect what is in your current file
This is what --prefix=WAS_SET_TO in your configure

/* --prefix directory for GDAL install */
#define GDAL_PREFIX "/usr/mingw"

HTH

Norman
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cpl_config.h
Type: application/octet-stream
Size: 4403 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050511/44fa540e/cpl_config.obj
From t.r.decarlo at larc.nasa.gov  Wed May 11 09:42:35 2005
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Compiling gdal with MinGW/MSYS?
In-Reply-To: <EKEJIKAILPONGGENMBGAKEDNLGAA.nhv@cape.com>
Message-ID: <007801c5562f$49f34ae0$959877c6@cts1149>

Thanks Norman,
I figured you had already worked this out. Being stuck halfway between
Windoze and Linux is a real chore.

Thom
--
Thom DeCarlo
--------------------------------------------------------
      Any sufficiently advanced technology
    is indistinguishable from a rigged demo.



> -----Original Message-----
> From: Norman Vine [mailto:nhv@cape.com]
> Sent: Wednesday, May 11, 2005 9:42 AM
> To: Thom DeCarlo; Gdal-Dev@Remotesensing.Org
> Subject: RE: [Gdal-dev] Compiling gdal with MinGW/MSYS?
> 
> Thom DeCarlo writes:
> >
> > Hi,
> > I'm trying for the first time to compile gdal with MinGW under Win2K. I
> > think I've got all the required MinGW packages, but the build is failing
> > with these messages:
> >
> >
> > make[1]: Entering directory `/s/OSG/gdal/port'
> > /bin/sh.exe ../libtool --mode=compile g++ -Wall  -O2    -I../port  -c -o
> > cpl_vsil_unix_stdio_64.o cpl_vsil_unix_stdio_64.cpp
> >   g++ -Wall -O2 -I../port -c cpl_vsil_unix_stdio_64.cpp  -DDLL_EXPORT
> > -DPIC -o .libs/cpl_vsil_unix_stdio_64.o
> > cpl_vsil_unix_stdio_64.cpp: In function `int VSIStat(const char*,
> > VSIStatBuf*)':
> > cpl_vsil_unix_stdio_64.cpp:175: error: `stat64' undeclared (first use
> > this function)
> > cpl_vsil_unix_stdio_64.cpp:175: error: (Each undeclared identifier is
> > reported only once for each function it appears in.)
> > make[1]: *** [cpl_vsil_unix_stdio_64.o] Error 1
> > make[1]: Leaving directory `/s/OSG/gdal/port'
> > make: *** [port-target] Error 2
> >
> > I suspect I'm missing something in the include path, but I thought the
> > ./configure should have picked up all the appropriate stuff.
> >
> > Can anyone give me more info about the proper setup of mingw for gdal?
> 
> Hi Thom
> 
> I had a similar problem and don't really know the correct way to fix this
> but ...
> 
> I just hand edited my cpl_config.h as attached and things seem to work OK
> 
> You will probably want to edit this line to reflect what is in your
> current file
> This is what --prefix=WAS_SET_TO in your configure
> 
> /* --prefix directory for GDAL install */
> #define GDAL_PREFIX "/usr/mingw"
> 
> HTH
> 
> Norman


From predator2448 at hotmail.com  Wed May 11 17:15:45 2005
From: predator2448 at hotmail.com (Ilya Serebrianik)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Cutting non-square image into square subimages
Message-ID: <BAY104-F168AE4E3E9D8233268A230CE100@phx.gbl>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050511/7a6bba1a/attachment.html
From fwarmerdam at gmail.com  Thu May 12 00:27:09 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Cutting non-square image into square subimages
In-Reply-To: <BAY104-F168AE4E3E9D8233268A230CE100@phx.gbl>
References: <BAY104-F168AE4E3E9D8233268A230CE100@phx.gbl>
Message-ID: <931f8ea9050511212735d84b64@mail.gmail.com>

On 5/11/05, Ilya Serebrianik <predator2448@hotmail.com> wrote:
> 
> Hello, 
>   
>       I have an image that is not square due to projection into lat/long. I
> need to cut that image into  square tiles without changing the resolution.
> For example if I specify a certain width of tile that fits exactly accross
> the width of the parent non-rectangular image it will obviously not fit
> along the height of the image, there will be some region of the last tile
> row that would be outside the parent image boundary. I would like to know
> whether there is a relatively simple way to fill these last row tiles with
> the remaining data from the parent image and therest of those tiles with
> black color (same as no data value?). I would rather not get into the low
> level image i/o such as RasterIO due to time limits and utilize code from
> the already written utilities. If anyone can suggest another way of cutting
> a non-square image into square images with the same resolution I would
> really like to know about it :-). 

Ilya, 

At the commandline you could just construct appropriate output file
bounds for each tile with gdalwarp.  All areas outside the available source
data will be set to zero. 

At the API level you can use RasterIO() to fill just part of a buffer with
appropriate setting of the buffersize, and pixel and line offset values, but
that can be pretty tedious to setup properly. 
 
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Thu May 12 15:47:40 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GDAL 1.2.6 For MacOS X
Message-ID: <931f8ea9050512124758c534a4@mail.gmail.com>

Folks,

James Hopper has prepared an installer for GDAL 1.2.6 for MacOS X. 
I have placed this at:

 http://www.gdal.org/dl/GDAL-1.2.6.dmg

This package installs a GDAL framework for development as well
as installing the "normal" install tree under /usr/local for use of 
commandline utilities or as an alternative target to link against. 

Questions about MacOS X specific issues should be addressed to James.

  james dot e dot hopper <at> saic dot com

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Ken.Boss at dnr.state.mn.us  Thu May 12 18:07:38 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
Message-ID: <s2838dae.019@co5.dnr.state.mn.us>

Under FWTools 0.9.8, I can successfully use gdal_translate to generate
an ECW output from a 400 MB input file.  If I try to do the same with a
750 MB input, however, I get: 

gdal_translate -of ECW -co target=95 two_tiles.tif two_tiles.ecw
Input file size is 18988, 14016
0.100 - done.
ERROR 4: `d:\ken_mrsid\test_tiles\two_tiles.ecw' does not exist in the
file syst
em,
and is not recognised as a supported dataset name.

I'm guessing this might owe to input file size limitations, but looking
at the ECW 3.1 SDK page at http://www.ermapper.com/ecw/ and the price
list at http://www.ermapper.com/document/doc.aspx?doc_id=54, I'm left
with the distinct impression that the free GPL-style license for the SDK
(surely this is what gdal uses?) provides unlimited compression.

Can anybody clarify this for me?

Thanks,

Ken Boss

From bfraser at geoanalytic.com  Thu May 12 18:55:07 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
References: <s2838dae.019@co5.dnr.state.mn.us>
Message-ID: <000901c55745$a4cfd110$160002c0@shark>

Ken,

  Sounds like the gdal_translate delivered with FWTools does not use the
GPL'ed ECW SDK yet.    That's the error I got when I tried to compress > 500
mb with the old ECW library.

The unlimited ECW SDK can be compiled into gdal_translate (on Windows
anyways, I think there may be a few bugs when running on *nix ) if you're
into compiling...

Brent Fraser


----- Original Message ----- 
From: "Ken Boss" <Ken.Boss@dnr.state.mn.us>
To: <gdal-dev@xserve.flids.com>
Sent: Thursday, May 12, 2005 4:07 PM
Subject: [Gdal-dev] ecw-compressing >500MB files


> Under FWTools 0.9.8, I can successfully use gdal_translate to generate
> an ECW output from a 400 MB input file.  If I try to do the same with a
> 750 MB input, however, I get:
>
> gdal_translate -of ECW -co target=95 two_tiles.tif two_tiles.ecw
> Input file size is 18988, 14016
> 0.100 - done.
> ERROR 4: `d:\ken_mrsid\test_tiles\two_tiles.ecw' does not exist in the
> file syst
> em,
> and is not recognised as a supported dataset name.
>
> I'm guessing this might owe to input file size limitations, but looking
> at the ECW 3.1 SDK page at http://www.ermapper.com/ecw/ and the price
> list at http://www.ermapper.com/document/doc.aspx?doc_id=54, I'm left
> with the distinct impression that the free GPL-style license for the SDK
> (surely this is what gdal uses?) provides unlimited compression.
>
> Can anybody clarify this for me?
>
> Thanks,
>
> Ken Boss
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From fwarmerdam at gmail.com  Thu May 12 19:11:41 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
In-Reply-To: <s2838dae.019@co5.dnr.state.mn.us>
References: <s2838dae.019@co5.dnr.state.mn.us>
Message-ID: <931f8ea9050512161176375e41@mail.gmail.com>

On 5/12/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Under FWTools 0.9.8, I can successfully use gdal_translate to generate
> an ECW output from a 400 MB input file.  If I try to do the same with a
> 750 MB input, however, I get:
> 
> gdal_translate -of ECW -co target=95 two_tiles.tif two_tiles.ecw
> Input file size is 18988, 14016
> 0.100 - done.
> ERROR 4: `d:\ken_mrsid\test_tiles\two_tiles.ecw' does not exist in the
> file syst
> em,
> and is not recognised as a supported dataset name.
> 
> I'm guessing this might owe to input file size limitations, but looking
> at the ECW 3.1 SDK page at http://www.ermapper.com/ecw/ and the price
> list at http://www.ermapper.com/document/doc.aspx?doc_id=54, I'm left
> with the distinct impression that the free GPL-style license for the SDK
> (surely this is what gdal uses?) provides unlimited compression.

Ken,

I believe that the file size limitation is what you are running into. 
I believe the FWTools 0.9.8 supports large files, but you need to
"tell" the software you have the legitimate right to compress large
files. This is accomplishing by setting the ECW_LARGE_OK 
creation option to YES. 
eg. 

gdal_translate -of ECW -co ECW_LARGE_OK=YES big.tif big.ecw

Note that by setting this flag, it is my intent that you are acknowledging
that you have conformed with any requirements of the ECW license.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From tflynch at gmail.com  Thu May 12 22:18:39 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
In-Reply-To: <c39b2a6505051218051b83ab05@mail.gmail.com>
References: <s2838dae.019@co5.dnr.state.mn.us>
	<c39b2a6505051218051b83ab05@mail.gmail.com>
Message-ID: <c39b2a6505051219186a0ecd6c@mail.gmail.com>

On 5/13/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Under FWTools 0.9.8, I can successfully use gdal_translate to generate
> an ECW output from a 400 MB input file.  If I try to do the same with a
> 750 MB input, however, I get:
>
> gdal_translate -of ECW -co target=95 two_tiles.tif two_tiles.ecw
> Input file size is 18988, 14016
> 0.100 - done.
> ERROR 4: `d:\ken_mrsid\test_tiles\two_tiles.ecw' does not exist in the
> file syst
> em,
> and is not recognised as a supported dataset name.
>
> I'm guessing this might owe to input file size limitations, but looking
> at the ECW 3.1 SDK page at http://www.ermapper.com/ecw/ and the price
> list at http://www.ermapper.com/document/doc.aspx?doc_id=54, I'm left
> with the distinct impression that the free GPL-style license for the SDK
> (surely this is what gdal uses?) provides unlimited compression.
>
> Can anybody clarify this for me?

Thanks Frank, you have it right on the use of ECW_LARGE_OK I'm sure.

Brent, GDAL does currently use the version of the ECW JPEG 2000 SDK
that is made available under a "GPL-style" license (there are a couple
of differences with the GPL).  The GPLish license only comes into play
when using unlimited compression, otherwise the source and binary
distributions of the ECW JPEG 2000 SDK are for free use.

There's a relevant buglog:

http://bugzilla.remotesensing.org/show_bug.cgi?id=767

--
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From eike.schumann at vodafone.com  Fri May 13 11:11:04 2005
From: eike.schumann at vodafone.com (Schumann, Eike, VF-DE)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] LAYER_TYPE=thematic
Message-ID: <54ADBFDBF31282449B1CCCCE3683AD92D3673F@DEDUS-WICL01M01.vf-de.internal.vodafone.com>

Hello GDAL professionals,

I have a problem (which might be trivial?) changing the metadatum
LAYER_TYPE.
I am using gdal 1.6.
I am creating a 16bit unsigned raster dataset from scretch and want to
save it as an ERDAS IMG file, catagorized as thematic.
But whatever I do the LAYER_TYPE doesn't change from the default
athematic to thematic.
Below is an excerpt from the code I wrote to perform the task. I
appreciate any hint to solve the problem. 
Many thanks in advance,
Eike.

	static const string strProjection = "PROJCS[\"Transverse
Mercator\",GEOGCS[\"Potsdam_IST_V2_0\",DATUM[\"Potsdam_IST_V2_0
\",SPHEROID[\"Bessel\",6377397.155,299.1528131060786],TOWGS84[583,68,399
.5,0,0,1.36e-05,1.13e-05]],PRIMEM[\"Greenwich
\",0],UNIT[\"degree\",0.0174532925199433]],UNIT[\"meter\",1],PROJECTION[
\"Transverse_Mercator\"],PARAMETER[\"latitude_of_origin
\",0],PARAMETER[\"central_meridian\",9],PARAMETER[\"scale_factor\",1],PA
RAMETER[\"false_easting	\",3500000],PARAMETER[\"false_northing\",0]]";

      const char* pszFormat = "HFA";
      char** pMetaData;
 
      GDALDataType type = GDT_UInt16;
   
      GDALDriver* poDriver = GetGDALDriverManager()->GetDriverByName(
pszFormat );
      if( poDriver == NULL ) 
      {
         throw FailedToStore("Couldn't find HFA driver!");;
      }
      char **papszOptions = NULL;
      papszOptions = CSLSetNameValue( papszOptions, "COMPRESS", "TRUE");
//festlegen der Optionen
      
      GDALDataset* poDst = poDriver->Create( fileName.str().c_str(),
image.metaData.cols, image.metaData.rows, 1, type, papszOptions);
      if( NULL == poDst) throw FailedToStore("Couldn't create IMG
image!");

      double  adfGeoTransform[6];
   
      adfGeoTransform[1] = image.metaData.resolutionX;  
      adfGeoTransform[5] = -image.metaData.resolutionY;
      adfGeoTransform[0] = image.metaData.coords.LL.x;
      adfGeoTransform[3] = image.metaData.coords.UR.y;
      adfGeoTransform[2] = 0;
      adfGeoTransform[3] = 0;
      poDst->SetGeoTransform( adfGeoTransform );
   
      CPLErr error = poDst->SetProjection( strProjection.c_str() );


      unsigned char* pixels = ...
   
//***************** Interesting part begin
******************************************
//**********************************************************************
*************

      GDALRasterBand* poBand = poDst->GetRasterBand(1);

      pMetaData = poBand->GetMetadata();
      CSLSetNameValue( pMetaData, "LAYER_TYPE", "thematic");

      poBand->RasterIO( GF_Write, 0, 0, image.metaData.cols,
image.metaData.rows, pixels, image.metaData.cols, image.metaData.rows,
GDT_UInt16,0,0);

//***************** Interesting part end
******************************************
//**********************************************************************
*************

From Ken.Boss at dnr.state.mn.us  Fri May 13 10:31:50 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
Message-ID: <s2847451.050@co5.dnr.state.mn.us>

>>>> fwarmerdam@gmail.com 5/12/2005 6:11:41 PM >>>
>On 5/12/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
>> Under FWTools 0.9.8, I can successfully use gdal_translate to
generate
>> an ECW output from a 400 MB input file.  If I try to do the same
with a
>> 750 MB input, however, I get:
>> 
>> gdal_translate -of ECW -co target=95 two_tiles.tif two_tiles.ecw
>> Input file size is 18988, 14016
>> 0.100 - done.
>> ERROR 4: `d:\ken_mrsid\test_tiles\two_tiles.ecw' does not exist in
the
>> file syst
>> em,
>> and is not recognised as a supported dataset name.
>> 
>> I'm guessing this might owe to input file size limitations, but
looking
>> at the ECW 3.1 SDK page at http://www.ermapper.com/ecw/ and the
price
>> list at http://www.ermapper.com/document/doc.aspx?doc_id=54, I'm
left
>> with the distinct impression that the free GPL-style license for the
SDK
>> (surely this is what gdal uses?) provides unlimited compression.
>
>Ken,
>
>I believe that the file size limitation is what you are running into.

>I believe the FWTools 0.9.8 supports large files, but you need to
>"tell" the software you have the legitimate right to compress large
>files. This is accomplishing by setting the ECW_LARGE_OK 
>creation option to YES. 
>eg. 
>
>gdal_translate -of ECW -co ECW_LARGE_OK=YES big.tif big.ecw
>
>Note that by setting this flag, it is my intent that you are
acknowledging
>that you have conformed with any requirements of the ECW license.
>
>Best regards,
>-- 
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com 
>light and sound - activate the windows | http://pobox.com/~warmerdam 
>and watch the world go round - Rush    | Geospatial Programmer for
Rent
>_______________________________________________

Frank--

Sounds great, but in fact:

gdal_translate -of ECW -co ECW_LARGE_OK=YES
d:/ken_tmp/test_tiles/two_tiles.tif
d:/ken_tmp/mosaicked_tiles/two_tiles.ecw
Input file size is 18988, 14016
0.100 - done.
ERROR 4: `d:/ken_tmp/mosaicked_tiles/two_tiles.ecw' does not exist in
the file s
ystem,
and is not recognised as a supported dataset name.

Perhaps I need simply to wait patiently for 0.9.9 (or, as Brent
suggests, recompile against the newer SDK myself)?

--Ken

From fwarmerdam at gmail.com  Fri May 13 13:04:32 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
In-Reply-To: <s2847451.049@co5.dnr.state.mn.us>
References: <s2847451.049@co5.dnr.state.mn.us>
Message-ID: <931f8ea905051310041cd49940@mail.gmail.com>

Ken,

I have confirmed the problem.  It seems, for no apparently reason, I 
treated this as a config, rather than creation option.  Try using 
--config ECW_LARGE_OK YES instead of -co ECW_LARGE_OK=YES.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dburken at comcast.net  Fri May 13 16:35:02 2005
From: dburken at comcast.net (David Burken)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] big tiff
In-Reply-To: <007101c5562a$2adf2750$959877c6@cts1149>
References: <007101c5562a$2adf2750$959877c6@cts1149>
Message-ID: <42850F76.6010405@comcast.net>

Hi Frank,

Is there a big tiff coming?  Just curious after I saw this:

mercury> pwd
/mnthdb1/work/drb/libtiff/libtiff
mercury> grep VERSION tiff.h
#define TIFF_VERSION            42
#define TIFF_BIGTIFF_VERSION    43

Have a good weekend,
Dave


From Ken.Boss at dnr.state.mn.us  Fri May 13 13:43:51 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ecw-compressing >500MB files
Message-ID: <s284a157.021@co5.dnr.state.mn.us>

Fantastic!  Major kudos to both you and the folks at ERMAPPER for making
this possible.

--Ken

>>> fwarmerdam@gmail.com 5/13/2005 12:04:32 PM >>>
Ken,

I have confirmed the problem.  It seems, for no apparently reason, I 
treated this as a config, rather than creation option.  Try using 
--config ECW_LARGE_OK YES instead of -co ECW_LARGE_OK=YES.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com 
light and sound - activate the windows | http://pobox.com/~warmerdam 
and watch the world go round - Rush    | Geospatial Programmer for
Rent

From Ken.Boss at dnr.state.mn.us  Fri May 13 17:29:14 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] single ECW output from multiple input tiles
Message-ID: <s284d62d.016@co5.dnr.state.mn.us>

>From the get an inch, ask for a mile department...

I'm wondering if any of the tools commonly found in this neighborhood
might be capable of constructing a single mosaicked ECW output directly
from a collection of tiled inputs, without going through an intermediate
(uncompressed, full-res) file.  I'm pretty sure gdal_merge.py won't be
able to fit the bill on this one, are there other options? 

--Ken

From naumov at buffalo.edu  Fri May 13 20:37:07 2005
From: naumov at buffalo.edu (Aleksey Naumov)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TIGER lines
Message-ID: <200505140037.07390.naumov@buffalo.edu>

Dear GDAL users,

Does anyone know of a way to import line features from TIGER files in GDAL? 
The tigerpoly.py script builds a shapefile of polygon features, but how do I 
extract linear features, e.g. roads?

Thanks,
Aleksey

-- 
Aleksey Naumov
Department of Geography
SUNY-Buffalo

From ge at gabrielebner.at  Sat May 14 08:13:23 2005
From: ge at gabrielebner.at (Gabriel Ebner)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
References: <s284d62d.016@co5.dnr.state.mn.us>
Message-ID: <3668039.iGvkhEglk1@schnecke2.gabrielebner.at>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ken Boss wrote:

> I'm wondering if any of the tools commonly found in this neighborhood
> might be capable of constructing a single mosaicked ECW output directly
> from a collection of tiled inputs, without going through an intermediate
> (uncompressed, full-res) file.  I'm pretty sure gdal_merge.py won't be
> able to fit the bill on this one, are there other options?

How about using a vrt dataset?  That should actually be able handle huge
mosaics.  I'm currently using a rewritten gdal_merge.py (attached) to
generate such files and it works pretty well.  It should be possible to
gdal_translate that to ecw without problems.

        Gabriel.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.1 (GNU/Linux)

iD8DBQFChetnja6QLvw1CaARAmRyAJsE6LKEPkN/HbJHlm7eOHgK0J34wwCfZr7X
9TLyEBpCOtH7tGZ4PonKLrc=
=yueR
-----END PGP SIGNATURE-----
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_vrtmerge.py
Type: application/x-python
Size: 8341 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050514/e0cc28e5/gdal_vrtmerge.bin
From schuyler at nocat.net  Sat May 14 11:23:33 2005
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TIGER lines
In-Reply-To: <200505140037.07390.naumov@buffalo.edu>
References: <200505140037.07390.naumov@buffalo.edu>
Message-ID: <20050514152333.GV31423@vishnu.tridity.org>

* On 13-May-2005 at  9:36PM PDT, Aleksey Naumov said:
> 
> Does anyone know of a way to import line features from TIGER files in GDAL? 
> The tigerpoly.py script builds a shapefile of polygon features, but how do I 
> extract linear features, e.g. roads?

ogr2ogr will do this directly. You can use the -where option to filter
line features by CFCC.

SDE

From bfraser at geoanalytic.com  Sat May 14 13:07:44 2005
From: bfraser at geoanalytic.com (bfraser@geoanalytic.com)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] single ECW output from multiple input tiles
In-Reply-To: <s284d62d.016@co5.dnr.state.mn.us>
References: <s284d62d.016@co5.dnr.state.mn.us>
Message-ID: <.24.71.223.141.1116090464.squirrel@24.71.223.141>

Ken,

  I think gdalwarp will do it.  There's a tantalizing bit of doc on the
gdals utilities page:

"Mosaicing into an existing output file is supported if the output file
already exists"

Whether this works with ECW as output is unclear (or what the performance
would be).

Brent

>>From the get an inch, ask for a mile department...
>
> I'm wondering if any of the tools commonly found in this neighborhood
> might be capable of constructing a single mosaicked ECW output directly
> from a collection of tiled inputs, without going through an intermediate
> (uncompressed, full-res) file.  I'm pretty sure gdal_merge.py won't be
> able to fit the bill on this one, are there other options?
>
> --Ken
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>



From Ken.Boss at dnr.state.mn.us  Sat May 14 18:25:39 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
Message-ID: <s28634d4.098@co5.dnr.state.mn.us>

>>>> Gabriel Ebner <ge@gabrielebner.at> 5/14/2005 7:13:23 AM >>>
>
>Ken Boss wrote:
>
>> I'm wondering if any of the tools commonly found in this
neighborhood
>> might be capable of constructing a single mosaicked ECW output
directly
>> from a collection of tiled inputs, without going through an
intermediate
>> (uncompressed, full-res) file.  I'm pretty sure gdal_merge.py won't
be
>> able to fit the bill on this one, are there other options?
>
>How about using a vrt dataset?  That should actually be able handle
huge
>mosaics.  I'm currently using a rewritten gdal_merge.py (attached) to
>generate such files and it works pretty well.  It should be possible
to
>gdal_translate that to ecw without problems.
>
>        Gabriel.

Gabriel--

Many thanks, this is very nearly exactly what I was looking for.  vrt
datasets feed nicely into gdal_translate for outputting to ecw.  My only
remaining obstacle is ensuring that valid image data doesn't get
overwritten by nodata values from overlapping inputs.

Reading at
http://xserve.flids.com/pipermail/gdal-dev/2004-September/007053.html,
I got the idea that I could add a <NoDataValue>0</NoDataValue> tag to
the VRTRasterBand sections of the .vrt file in order to address this
issue, but alas, this seems to have no effect, at least when translating
to ecw.  I was hoping that maybe a source nodata value could be passed
as an ECW creation option, but no such luck.

Any suggestions welcome...

--Ken

From dron at ak4719.spb.edu  Mon May 16 01:14:00 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] big tiff
In-Reply-To: <42850F76.6010405@comcast.net>
References: <007101c5562a$2adf2750$959877c6@cts1149>
	<42850F76.6010405@comcast.net>
Message-ID: <20050516051400.GA31807@ak4719.spb.edu>

On Fri, May 13, 2005 at 04:35:02PM -0400, David Burken wrote:
> Is there a big tiff coming?  Just curious after I saw this:
> 
> mercury> pwd
> /mnthdb1/work/drb/libtiff/libtiff
> mercury> grep VERSION tiff.h
> #define TIFF_VERSION            42
> #define TIFF_BIGTIFF_VERSION    43

No real work yet. There are number of issues in libtiff which should be
solved in order to start 64-bit TIFF implementation. Anyway, the whole
problem is not abandoned.

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From fwarmerdam at gmail.com  Mon May 16 09:53:55 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
In-Reply-To: <s28634d4.098@co5.dnr.state.mn.us>
References: <s28634d4.098@co5.dnr.state.mn.us>
Message-ID: <931f8ea905051606536a164f4c@mail.gmail.com>

On 5/14/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Many thanks, this is very nearly exactly what I was looking for.  vrt
> datasets feed nicely into gdal_translate for outputting to ecw.  My only
> remaining obstacle is ensuring that valid image data doesn't get
> overwritten by nodata values from overlapping inputs.
> 
> Reading at
> http://xserve.flids.com/pipermail/gdal-dev/2004-September/007053.html,
> I got the idea that I could add a <NoDataValue>0</NoDataValue> tag to
> the VRTRasterBand sections of the .vrt file in order to address this
> issue, but alas, this seems to have no effect, at least when translating
> to ecw.  I was hoping that maybe a source nodata value could be passed
> as an ECW creation option, but no such luck.

Ken,

In VRT there are "SimpleSources" and "ComplexSources".  The
complex sources include support for nodata values that are not
copied, and for on the fly scaling.   I *think* you would setup
a complex source similarly to a simple source except that you
use the element <ComplexSource> instead of <SimpleSource> and
the complex source can have NODATA, ScaleOffset and ScaleRatio
tags for which the values are used during image processing.

If you can't get this to work let me know, and I will prepare an example.

I would warning that .vrt's have degrading performance as the number
of sources goes up, so they aren't a great way of managing a mosaic
of hundreds of images. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon May 16 10:08:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TIGER lines
In-Reply-To: <20050514152333.GV31423@vishnu.tridity.org>
References: <200505140037.07390.naumov@buffalo.edu>
	<20050514152333.GV31423@vishnu.tridity.org>
Message-ID: <931f8ea90505160708f21f1dc@mail.gmail.com>

On 5/14/05, Schuyler Erle <schuyler@nocat.net> wrote:
> * On 13-May-2005 at  9:36PM PDT, Aleksey Naumov said:
> >
> > Does anyone know of a way to import line features from TIGER files in GDAL?
> > The tigerpoly.py script builds a shapefile of polygon features, but how do I
> > extract linear features, e.g. roads?
> 
> ogr2ogr will do this directly. You can use the -where option to filter
> line features by CFCC.

Aleksey,

Schuyler is correct.  In particular, the linear features are the CompleteChain
layer.  So to get them all you would do:

  ogr2ogr out.shp TGR10001.RT1 CompleteChain

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon May 16 10:19:07 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] big tiff
In-Reply-To: <20050516051400.GA31807@ak4719.spb.edu>
References: <007101c5562a$2adf2750$959877c6@cts1149>
	<42850F76.6010405@comcast.net> <20050516051400.GA31807@ak4719.spb.edu>
Message-ID: <931f8ea905051607191dedef8@mail.gmail.com>

On 5/16/05, Andrey Kiselev <dron@ak4719.spb.edu> wrote:
> On Fri, May 13, 2005 at 04:35:02PM -0400, David Burken wrote:
> > Is there a big tiff coming?  Just curious after I saw this:
> >
> > mercury> pwd
> > /mnthdb1/work/drb/libtiff/libtiff
> > mercury> grep VERSION tiff.h
> > #define TIFF_VERSION            42
> > #define TIFF_BIGTIFF_VERSION    43
> 
> No real work yet. There are number of issues in libtiff which should be
> solved in order to start 64-bit TIFF implementation. Anyway, the whole
> problem is not abandoned.

Dave,

I would add to this that I am hoping to implement BigTIFF for libtiff
while I am away on vacation, which starts in a week.  No promises
on when this might be released and usable though. It might well be
that I don't get much time for it, or that I find that we should really
do a bunch more preliminary work in libtiff first. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Ken.Boss at dnr.state.mn.us  Mon May 16 13:08:28 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
Message-ID: <s2888da8.015@co5.dnr.state.mn.us>

>>>> fwarmerdam@gmail.com 5/16/2005 8:53:55 AM >>>
>In VRT there are "SimpleSources" and "ComplexSources".  The
>complex sources include support for nodata values that are not
>copied, and for on the fly scaling.   I *think* you would setup
>a complex source similarly to a simple source except that you
>use the element <ComplexSource> instead of <SimpleSource> and
>the complex source can have NODATA, ScaleOffset and ScaleRatio
>tags for which the values are used during image processing.
>
>If you can't get this to work let me know, and I will prepare an
example.
>
>I would warning that .vrt's have degrading performance as the number
>of sources goes up, so they aren't a great way of managing a mosaic
>of hundreds of images. 
>
>Best regards,
>-- 

Frank--

I changed my <SimpleSource>s to <ComplexSource>s, and added
<NoDataValue> tags, first as children of <VRTRasterBand> elements, and
then as children of the <ComplexSource> elements, but to no avail.  A
copy of my test.vrt file is attached.

As regards performance, I decided this weekend to ignore the offsite
problem and run a test with 600 three-band tiles totalling something
like 250 GB of input data.  It failed at 80% completion after 27 hours,
but only (I am reasonably certain) because I had neglected to increase
the size of my virtual memory paging file when I added a RAM upgrade to
the machine last week.  So I see some reason at least for cautious
optimism.

--Ken


-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.vrt
Type: application/octet-stream
Size: 2984 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050516/f592ecff/test.obj
From rsignell at usgs.gov  Tue May 17 08:58:50 2005
From: rsignell at usgs.gov (Rich Signell)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] How to use GeodataTorrent of SRTM30+
Message-ID: <4289EA8A.7000205@usgs.gov>


Frank & Co,

I was intrigued by the Geodata Torrent concept at:

http://uo.space.frot.org/?node=GeodataTorrents

and very interested also in getting a geotiff copy of SRTM30+, so I pointed
BitTornado at <http://fwtools.maptools.org/data/srtm30plus.tif.torrent> but 
received nothing.

Are there tricks or issues that we should know about with this approach to 
distribution of Geodata?

Thanks,
Rich
-- 
Richard P. Signell
U.S. Geological Survey       Phone: (508) 457-2229
384 Woods Hole Road          Fax:   (508) 457-2310
Woods Hole, MA  02543-1598

From schuyler at nocat.net  Tue May 17 09:07:12 2005
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] How to use GeodataTorrent of SRTM30+
In-Reply-To: <4289EA8A.7000205@usgs.gov>
References: <4289EA8A.7000205@usgs.gov>
Message-ID: <20050517130712.GI13265@vishnu.tridity.org>

* On 17-May-2005 at  6:01AM PDT, Rich Signell said:
> 
> and very interested also in getting a geotiff copy of SRTM30+, so I pointed
> BitTornado at <http://fwtools.maptools.org/data/srtm30plus.tif.torrent> but 
> received nothing.
> 
> Are there tricks or issues that we should know about with this approach to 
> distribution of Geodata?

Yes, the problem is that the BitTorrent tracker has been locked down
to prevent the k1dd1es from distributing warez using our service. Try
http://mappinghacks.com/data/srtm30plus.tif.torrent -- I've also fixed
the link on the wiki page.

SDE

From support at geoimage.fr  Tue May 17 11:25:50 2005
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GDAL over internet
Message-ID: <028801c55af5$04d34850$0a01a8c0@pili>

Hello,

our 3D viewer is actually accessing geomatic data DEM/Textures/Vector Layers  using GDAL & OGR.
I'm searching a solution to make this application able to access this kind of data over internet.

I think to two possible solutions :

1/OGDI :
The GDAL OGDI driver seems to allow to access data both locally and over internet ( using the gltpd server ).
In the GDAL distribution I use ( the one included in the Openv_FW package ) i can access, for example,
DTED Data using this driver. The problem is that the OGDI supported format list is quite small and doesn't
include any generic format ( able to support both DEM and Gray/RGB/Lut based textures ) like GEOtiff.

The ideal thing should be a GDAL Based OGDI Driver for GDAL ! With that, any format accessible via GDAL
should be used over internet.

I have found in the contrib/gdal section  of OGDI distribution, something called GDAL bridge.
Is it related ?

Does anyone really use the gltdp server ?


2/ tsmApi
I found on the web the following open source library : http://www.tvgeo.com/tsmApi/
This library is dedicated to the access/delivery ( the delivery is done via an apache module )
of imagery over internet using http.

A solution to my problem should be to develop a new GDAL driver based on the tsmApi.

Does anyone on this list already experiment with this library ?

I can't get it working perfectly. My apache server ( i recompile it, and recompile the tsm apache
against the same version ) craches sometimes int the server module.


Thanks in advance for any hints or comments on this two solutions.
Any other formats/driver/server possibilities should be OK.

Fr?d?ric.

_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From fwarmerdam at gmail.com  Tue May 17 13:59:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GDAL over internet
In-Reply-To: <028801c55af5$04d34850$0a01a8c0@pili>
References: <028801c55af5$04d34850$0a01a8c0@pili>
Message-ID: <931f8ea9050517105973a20e8c@mail.gmail.com>

On 5/17/05, Fr?d?ric Trastour <support@geoimage.fr> wrote:
> Hello,
> 
> our 3D viewer is actually accessing geomatic data DEM/Textures/Vector Layers  using GDAL & OGR.
> I'm searching a solution to make this application able to access this kind of data over internet.
> 
> I think to two possible solutions :
> 
> 1/OGDI :
> The GDAL OGDI driver seems to allow to access data both locally and over internet ( using the gltpd server ).
> In the GDAL distribution I use ( the one included in the Openv_FW package ) i can access, for example,
> DTED Data using this driver. The problem is that the OGDI supported format list is quite small and doesn't
> include any generic format ( able to support both DEM and Gray/RGB/Lut based textures ) like GEOtiff.
> 
> The ideal thing should be a GDAL Based OGDI Driver for GDAL ! With that, any format accessible via GDAL
> should be used over internet.

Fr?d?ric,

In fact, there is an OGDI driver based on GDAL that exists, but it has
not been properly polished.  To be honest, I am not exactly sure where
the code is any more. 

However, I think the bigger barrier to using OGDI for this purpose is that
OGDI returns images with zlib compression.   This lossless compression
is very ineffectively for many kinds of images.  It might not be too bad for
dem data though. 

> I have found in the contrib/gdal section  of OGDI distribution, something called GDAL bridge.
> Is it related ?

Doh!  You are way ahead of me.  This is the OGDI GDAL driver.  It
uses a "gdal bridge" to dynamically load the GDAL library as well, but
that can be discarded, and the driver linked directly against GDAL. 
The "bridge" architecture isn't actively supported anymore.
 
> Does anyone really use the gltdp server ?

I for one have not made use of the gltpd server for a couple years.
 
> 2/ tsmApi
> I found on the web the following open source library : http://www.tvgeo.com/tsmApi/
> This library is dedicated to the access/delivery ( the delivery is done via an apache module )
> of imagery over internet using http.
> 
> A solution to my problem should be to develop a new GDAL driver based on the tsmApi.
> 
> Does anyone on this list already experiment with this library ?
> 
> I can't get it working perfectly. My apache server ( i recompile it, and recompile the tsm apache
> against the same version ) craches sometimes int the server module.
> 
> Thanks in advance for any hints or comments on this two solutions.
> Any other formats/driver/server possibilities should be OK.

I have no experience with the tsmApi. 

I would suggest a couple other options. 

 o A WMS/WCS based GDAL driver using http to fetch from 
   OGC WMS or WCS servers.  I have wanted to do this for a long
   time, but there are a few complications.  With appropriate file
   formats, you could get the data in lossy compressed forms like
   jpeg and jpeg2000 for respectible latency.  This also has the benefit
   that it is useful against a variety of public datasources in addition to
   servers you deploy yourself. 

 o Use "ecwp" or "jpip" protocols.  These are network protocols for
    access to remote ecw and jpeg2000 images and are intended to
    allow fast piecewise access to remote imagery datasets.  In theory
    the ECW and JP2KAK drivers are close to supporting these now.
    However, I have had hard to explain problems with both and I 
    haven't tried to promote them.  I'm not sure what is involved in 
    setting up ecwp or jpip servers though.  You may need to purchase
    commecial software to accomplish it. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From armin.burger at gmx.net  Tue May 17 14:18:42 2005
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GML headers for JPEG2000 files
Message-ID: <lvhjbcG99eYrc2KkFFVbJ6TbmBXK1dyJoNX6Yg4pCHP@akmail>

Hi Frank,

I have a question regarding the new ECW SDK and JPEG2000 in GDAL:

JPEG2000 supports metadata in GML format. Are there any plans to implement this metadata headers in GDAL? Eg, when converting from a GeoTiff with correct headers or defining the metadata in an XML file, writing the corresponding metadata into the JPEG2000 file ?

Best regards

Armin

From fwarmerdam at gmail.com  Tue May 17 14:35:42 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GML headers for JPEG2000 files
In-Reply-To: <lvhjbcG99eYrc2KkFFVbJ6TbmBXK1dyJoNX6Yg4pCHP@akmail>
References: <lvhjbcG99eYrc2KkFFVbJ6TbmBXK1dyJoNX6Yg4pCHP@akmail>
Message-ID: <931f8ea90505171135739142ab@mail.gmail.com>

On 5/17/05, Armin Burger <armin.burger@gmx.net> wrote:
> Hi Frank,
> 
> I have a question regarding the new ECW SDK and JPEG2000 in GDAL:
> 
> JPEG2000 supports metadata in GML format. Are there any plans to implement this metadata headers in GDAL? Eg, when converting from a GeoTiff with correct headers or defining the metadata in an XML file, writing the corresponding metadata into the JPEG2000 file ?

Armin, 

Currently GDAL CVS does support writing GML boxes per the
evolving GML-in-JPEG2000 spec being worked on in the OGC 
GMLJP2 IE (interoperability experiment).   However, to do this
it requires a patched version of the ECW SDK with support for
some extra jp2 boxes.  

On reading the ECW driver supports reading these GML boxes,
even with standard ECW SDKs as the gml reading code is all
handled via the gdaljp2 modules in gdal/gcore.  I plan to extend
use of this to the JP2KAK and possibly other jpeg2000 drivers in
the future.  

However, you asked about metadata in GML.  Currently my work
is only addressing coordinate system and georeferencing information
in GML.  It is also quite practical to embed generic metadata in these
gml packages, and I would like to do that.  I hadn't been pressing that
issue though since we (in the gmljp2 ie) were finding general CRS
work quite a challenge on it's own. 

So, I suppose you could say there is a general intention to implement
generic metadata via gml in jpeg2000 files, but no fixed schedule for
this.   It shouldn't be hard to do if you have a pressing need though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From armin.burger at gmx.net  Tue May 17 15:48:16 2005
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GML headers for JPEG2000 files
References: <lvhjbcG99eYrc2KkFFVbJ6TbmBXK1dyJoNX6Yg4pCHP@akmail>
	<931f8ea90505171135739142ab@mail.gmail.com>
Message-ID: <BbFnx0ZrENHKMGxK9IvzQ4Z9Qmw2hQBqtRataCU6iNI@akmail>

Frank,

thanks for the quick reply. I would be mainly interested in the coordinate and georeference info in the Jp2 files. But of course, if other metadata could be added then the better.

At work we are currently using ER Mapper to convert files to ECW but are thinking to move to Jp2 because of better and standardized support of metadata. But the ER Mapper converter is not really transparent how to specify metadata, currently it seems to work just fine with a few standard projections like UTM. So we were thinking having a look at GDAL to use it instead.

How is the metadata defined in the CVS version of GDAL, via a separate file? Do you have any compiled version of the modified ECW SDK for Linux like the one from January? I was successful compiling the SDK but then could not compile GDAL with that one. It worked fine though with your pre-compiled version from January.

Best regards

Armin



> On 5/17/05, Armin Burger <armin.burger@gmx.net> wrote:
>> Hi Frank,
>>
>> I have a question regarding the new ECW SDK and JPEG2000 in GDAL:
>>
>> JPEG2000 supports metadata in GML format. Are there any plans to implement
>> this metadata headers in GDAL? Eg, when converting from a GeoTiff with
>> correct headers or defining the metadata in an XML file, writing the
>> corresponding metadata into the JPEG2000 file ?

> Armin,

> Currently GDAL CVS does support writing GML boxes per the
> evolving GML-in-JPEG2000 spec being worked on in the OGC
> GMLJP2 IE (interoperability experiment).   However, to do this
> it requires a patched version of the ECW SDK with support for
> some extra jp2 boxes.

> On reading the ECW driver supports reading these GML boxes,
> even with standard ECW SDKs as the gml reading code is all
> handled via the gdaljp2 modules in gdal/gcore.  I plan to extend
> use of this to the JP2KAK and possibly other jpeg2000 drivers in
> the future.

> However, you asked about metadata in GML.  Currently my work
> is only addressing coordinate system and georeferencing information
> in GML.  It is also quite practical to embed generic metadata in these
> gml packages, and I would like to do that.  I hadn't been pressing that
> issue though since we (in the gmljp2 ie) were finding general CRS
> work quite a challenge on it's own.

> So, I suppose you could say there is a general intention to implement
> generic metadata via gml in jpeg2000 files, but no fixed schedule for
> this.   It shouldn't be hard to do if you have a pressing need though.

> Best regards,
> --
> ---------------------------------------+------------------------------------
> --
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent



From fwarmerdam at gmail.com  Tue May 17 16:52:45 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] GML headers for JPEG2000 files
In-Reply-To: <BbFnx0ZrENHKMGxK9IvzQ4Z9Qmw2hQBqtRataCU6iNI@akmail>
References: <lvhjbcG99eYrc2KkFFVbJ6TbmBXK1dyJoNX6Yg4pCHP@akmail>
	<931f8ea90505171135739142ab@mail.gmail.com>
	<BbFnx0ZrENHKMGxK9IvzQ4Z9Qmw2hQBqtRataCU6iNI@akmail>
Message-ID: <931f8ea90505171352bc254b7@mail.gmail.com>

On 5/17/05, Armin Burger <armin.burger@gmx.net> wrote:
> Frank,
> 
> thanks for the quick reply. I would be mainly interested in the coordinate and georeference info in the Jp2 files. But of course, if other metadata could be added then the better.
> 
> At work we are currently using ER Mapper to convert files to ECW but are thinking to move to Jp2 because of better and standardized support of metadata. But the ER Mapper converter is not really transparent how to specify metadata, currently it seems to work just fine with a few standard projections like UTM. So we were thinking having a look at GDAL to use it instead.

Armin,

The ECW SDK's support for coordinate systems is pretty decent for 
EPSG coordinate systems, or other common combinations.  But it does
not extend in an obvious way to user defined CRSes. 

> How is the metadata defined in the CVS version of GDAL, via a separate file? Do you have any compiled version of the modified ECW SDK for Linux like the one from January? I was successful compiling the SDK but then could not compile GDAL with that one. It worked fine though with your pre-compiled version from January.

The GML metadata for jpeg2000 files is embedded in the JPEG2000
file in an xml box.  Is that the question?  Or how is the informatin passed
to gdal_translate to encode?  There are many options including on the
commandline or embedded in the source file. 
 
I hope to issue new FWTools builds with the new gml-in-jpeg2000
support in a nearly final form soon.  So you might consider messing
with that.  I will note that the GML-in-JPEG2000 specification is not
yet finalized and so it might be premature to make yourself very
dependent on it.  But it is sensible to look forward to this as a next
generation approach.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Cedric.Moeri at bd.so.ch  Wed May 18 09:49:17 2005
From: Cedric.Moeri at bd.so.ch (=?iso-8859-1?Q?M=F6ri_C=E9dric?=)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ogr2ogr: Problem with new layer type multilinestring
Message-ID: <5B025B1F39D6D4119F5700508BEEEC66034DE683@srsofaioi4546.ktso.ch>

Hi list

I have a shapefile containing linestrings (polyline) and multilinestrings
(multi-polyline) that I'm trying to put into a PostGIS-DB using ogr2ogr. 

The problem is, that it always violates the check constraint geometry type.
If I try it without the -nlt option, the geometry column is "linestring"
and, of course, the multilinestring-objects violate the constraint. If I put
the -nlt option to "multilinestring" the linestring objects violate the
constraint too. 

I thought, that, if the -nlt option is set to mulitlinestring, it forces a
conversion of linestring objects to multilinestrings as it does it with
polygons/multipolygons.

Am I wrong or whatelse may be the issue?

I am using ogr2ogr version 1.2.5.


regards
mit freundlichen Gr?ssen

C?dric M?ri

********************************************
Kanton Solothurn
Bau- und Justizdepartement
Amt f?r Geoinformation
Abteilung SO!GIS Koordination 
R?tihof
CH 4509 Solothurn
T:   ++41 (0)32 627 2475
Fax: ++41 (0)32 627 2214 
mailto:cedric.moeri@bd.so.ch
http://www.sogis.so.ch
********************************************

-------------- next part --------------
A non-text attachment was scrubbed...
Name: =?iso-8859-1?Q?M=F6ri_C=E9dric=2Evcf?=
Type: application/octet-stream
Size: 210 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050518/d9c06e5b/iso-8859-1QMF6ri_CE9dric2Evcf.obj
From naumov at buffalo.edu  Wed May 18 09:51:11 2005
From: naumov at buffalo.edu (Aleksey Naumov)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TIGER lines
In-Reply-To: <931f8ea90505160708f21f1dc@mail.gmail.com>
References: <200505140037.07390.naumov@buffalo.edu>
	<20050514152333.GV31423@vishnu.tridity.org>
	<931f8ea90505160708f21f1dc@mail.gmail.com>
Message-ID: <200505181351.12214.naumov@buffalo.edu>

Schuyler and Frank, 

Thank you for the pointers, ogr2ogr does exactly what I need. Appreciate your 
info on -where and the layer name, made my work much easier.

Frank and all the developers, thank you for the great piece of software!

Best regards,
Aleksey


On Monday 16 May 2005 14:08, Frank Warmerdam wrote:
> On 5/14/05, Schuyler Erle <schuyler@nocat.net> wrote:
> > * On 13-May-2005 at  9:36PM PDT, Aleksey Naumov said:
> > > Does anyone know of a way to import line features from TIGER files in
> > > GDAL? The tigerpoly.py script builds a shapefile of polygon features,
> > > but how do I extract linear features, e.g. roads?
> >
> > ogr2ogr will do this directly. You can use the -where option to filter
> > line features by CFCC.
>
> Aleksey,
>
> Schuyler is correct.  In particular, the linear features are the
> CompleteChain layer.  So to get them all you would do:
>
>   ogr2ogr out.shp TGR10001.RT1 CompleteChain
>
> Best regards,

-- 
Aleksey Naumov
Department of Geography
SUNY-Buffalo

From mcoletti at gmail.com  Wed May 18 15:25:10 2005
From: mcoletti at gmail.com (Mark Coletti)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Accessing identification string?
Message-ID: <1200950805051812252e1789f8@mail.gmail.com>

Many formats support some form of dataset identification.  E.g., from
an SDTS dataset:

TITL :  = GULER MOUNTAIN, WA / TRANSPORTATION

There does not appear to be a way to access this string from GDAL/OGR.
 If this is so, how do you get that information?  If not, is there a
plan to add support for this?

Cheers,

Mark
-- 
I'm taking reality in small doses to build immunity.

From rsignell at usgs.gov  Wed May 18 15:27:16 2005
From: rsignell at usgs.gov (Rich Signell)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] tif + .tfw + Proj4 projection information => Fully
	Referenced GeoTiff
Message-ID: <428B9714.5000100@usgs.gov>

I'm hoping someone will take pity on a newbie here.

I've got a bunch of .tif images, corresponding .twf files, and I've also been 
told that all the .tifs are in meters, Mercator w/ standard parallel of 41.65 
and a central meridian of -70.316667, NAD83 datum.

I'd like to convert these to EPSG:4326, which would be easy to do using 
gdalwarp, except that I need a fully georeferenced geotiff as input, right?

So then I need a tool to add the georeferencing info.

I tried using OpenEV, but it looks like it also wants a properly georeferenced 
file to begin with.

It looks like I could also use "geotifcp", but it seems that I would need to 
find a properly reference geotiff first in my projection so that I could use 
"listgeo" to understand the input projection text file format.

After this, I had a sneaking suspicion that I was overlooking something.  There 
is an easy way, right?

Thanks,
Rich

-- 
Richard P. Signell
U.S. Geological Survey       Phone: (508) 457-2229
384 Woods Hole Road          Fax:   (508) 457-2310
Woods Hole, MA  02543-1598

From dkleiner at cmf.nrl.navy.mil  Wed May 18 16:05:37 2005
From: dkleiner at cmf.nrl.navy.mil (Dardo D Kleiner - CONTRACTOR)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] tif + .tfw + Proj4 projection information => Fully
	Referenced GeoTiff 
In-Reply-To: Message from Rich Signell <rsignell@usgs.gov> 
	of "Wed, 18 May 2005 15:27:16 EDT." <428B9714.5000100@usgs.gov> 
Message-ID: <200505182005.j4IK5bG2029413@ginger.cmf.nrl.navy.mil>

> I've got a bunch of .tif images, corresponding .twf files, and I've also been 
> told that all the .tifs are in meters, Mercator w/ standard parallel of 41.65 
> and a central meridian of -70.316667, NAD83 datum.

Doesn't look like that's a "standard" source projection, so I think you'll have
to explicitly define the proj parameters for gdalwarp.

e.g.

gdalwarp -s_srs '+proj=tmerc +lat_0=41.65 +lon_0=-70.316667 +datum=NAD83' -t_srs EPSG:4326 <input>.tif <output>.tif

I think you'll also need a couple more parameters: +k, +x_0, and +y_0.

You'll want to look at the proj reference, available at http://proj.maptools.org/

- Dardo

From shadow at dementia.org  Wed May 18 16:42:26 2005
From: shadow at dementia.org (Derrick J Brashear)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Accessing identification string?
In-Reply-To: <1200950805051812252e1789f8@mail.gmail.com>
References: <1200950805051812252e1789f8@mail.gmail.com>
Message-ID: <Pine.GSO.4.61-042.0505181641370.469@johnstown.andrew.cmu.edu>

On Wed, 18 May 2005, Mark Coletti wrote:

> Many formats support some form of dataset identification.  E.g., from
> an SDTS dataset:
>
> TITL :  = GULER MOUNTAIN, WA / TRANSPORTATION
>
> There does not appear to be a way to access this string from GDAL/OGR.
> If this is so, how do you get that information?  If not, is there a
> plan to add support for this?

I sent a patch to do it a long, long time ago when I wanted to preserve it 
translating doq1/doq2 to geotiff. I think it wasn't sufficiently generic 
and it was dropped.

From chodgson at refractions.net  Wed May 18 17:05:24 2005
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] WKT files out of date?
Message-ID: <428BAE14.2030109@refractions.net>

I was working with some gdal code and ran into an issue that the epsg 
code 3005 (BC Albers) isn't in the ogr .wkt files and thus my 
OGRSpatialReference code wasn't working as I expected... AFAICT, it's in 
the latest proj.4 epsg file, but not in the gdal cvs .wkt files. I'm 
surprised it's missing from gdal/ogr... actually, I thought gdal/ogr 
used the proj definition file, until I stated investigating this and 
found otherwise.

I only know about 3005 because it's a relatively new standard to my 
knowledge (should replace 42102 which was previously in common use for 
BC Albers) - so there may be others. Frank, don't you have these 
generated from the same source files or something?

Anyways, I know I can just add it in to my files myself, but I wanted to 
let you know.

Chris

From bfraser at geoanalytic.com  Wed May 18 17:34:43 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] tif + .tfw + Proj4 projection information =>
	FullyReferenced GeoTiff
References: <428B9714.5000100@usgs.gov>
Message-ID: <05c501c55bf1$67f8c610$160002c0@shark>

Rich,

  If you have all projection parameters of your input data, you can specify
them on the gdalwarp command line using the -s_srs option (see
http://www.gdal.org/gdal_utilities.html#gdalwarp):

gdalwarp -s_srs "+proj=merc +lon_0=-70.316667 +lat_ts=41.65 +x_0=0 +y_0=0
ellps=GRS80" -t_srs "EPSG:4326" -of GTiff in.tif out.tif

Have a look at
http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html for more
projection information, as I'm not sure if your standard parallel has the
same meaning as the Proj "latitude of true scale".

Brent Fraser

----- Original Message ----- 
From: "Rich Signell" <rsignell@usgs.gov>
To: "gdal-dev" <gdal-dev@remotesensing.org>
Sent: Wednesday, May 18, 2005 1:27 PM
Subject: [Gdal-dev] tif + .tfw + Proj4 projection information =>
FullyReferenced GeoTiff


> I'm hoping someone will take pity on a newbie here.
>
> I've got a bunch of .tif images, corresponding .twf files, and I've also
been
> told that all the .tifs are in meters, Mercator w/ standard parallel of
41.65
> and a central meridian of -70.316667, NAD83 datum.
>
> I'd like to convert these to EPSG:4326, which would be easy to do using
> gdalwarp, except that I need a fully georeferenced geotiff as input,
right?
>
> So then I need a tool to add the georeferencing info.
>
> I tried using OpenEV, but it looks like it also wants a properly
georeferenced
> file to begin with.
>
> It looks like I could also use "geotifcp", but it seems that I would need
to
> find a properly reference geotiff first in my projection so that I could
use
> "listgeo" to understand the input projection text file format.
>
> After this, I had a sneaking suspicion that I was overlooking something.
There
> is an easy way, right?
>
> Thanks,
> Rich
>
> -- 
> Richard P. Signell
> U.S. Geological Survey       Phone: (508) 457-2229
> 384 Woods Hole Road          Fax:   (508) 457-2310
> Woods Hole, MA  02543-1598
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From kmelero at sanz.com  Wed May 18 18:41:07 2005
From: kmelero at sanz.com (Kenneth Melero)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] WKT files out of date?
In-Reply-To: <428BAE14.2030109@refractions.net>
Message-ID: <003501c55bfa$b055c5d0$0502040a@MGCOMPAQ>


Chris,

I wonder if this is related to the same issue I found the other day when I
was opening a GDAL generated Alber file in ERDAS and the "image information"
window reposnded that the code was invalid.

Actually I owe Frank a sample file...sorry Frank, I'll get that to you
soon...I was having trouble with my ERDAS.

-Ken


-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Chris Hodgson
Sent: Wednesday, May 18, 2005 5:05 PM
To: gdal-dev
Subject: [Gdal-dev] WKT files out of date?


I was working with some gdal code and ran into an issue that the epsg 
code 3005 (BC Albers) isn't in the ogr .wkt files and thus my 
OGRSpatialReference code wasn't working as I expected... AFAICT, it's in 
the latest proj.4 epsg file, but not in the gdal cvs .wkt files. I'm 
surprised it's missing from gdal/ogr... actually, I thought gdal/ogr 
used the proj definition file, until I stated investigating this and 
found otherwise.

I only know about 3005 because it's a relatively new standard to my 
knowledge (should replace 42102 which was previously in common use for 
BC Albers) - so there may be others. Frank, don't you have these 
generated from the same source files or something?

Anyways, I know I can just add it in to my files myself, but I wanted to 
let you know.

Chris
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com http://xserve.flids.com/mailman/listinfo/gdal-dev


From fwarmerdam at gmail.com  Thu May 19 14:01:11 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] ogr2ogr: Problem with new layer type multilinestring
In-Reply-To: <5B025B1F39D6D4119F5700508BEEEC66034DE683@srsofaioi4546.ktso.ch>
References: <5B025B1F39D6D4119F5700508BEEEC66034DE683@srsofaioi4546.ktso.ch>
Message-ID: <931f8ea90505191101220b6ffb@mail.gmail.com>

On 5/18/05, M?ri C?dric <Cedric.Moeri@bd.so.ch> wrote:
> Hi list
> 
> I have a shapefile containing linestrings (polyline) and multilinestrings
> (multi-polyline) that I'm trying to put into a PostGIS-DB using ogr2ogr.
> 
> The problem is, that it always violates the check constraint geometry type.
> If I try it without the -nlt option, the geometry column is "linestring"
> and, of course, the multilinestring-objects violate the constraint. If I put
> the -nlt option to "multilinestring" the linestring objects violate the
> constraint too.
> 
> I thought, that, if the -nlt option is set to mulitlinestring, it forces a
> conversion of linestring objects to multilinestrings as it does it with
> polygons/multipolygons.

M?ri,

I kind of thought it would do that too, but perhaps not. 
 
> Am I wrong or whatelse may be the issue?
> 
> I am using ogr2ogr version 1.2.5.

I would suggest using "-nlt geometry" which should result in 
no geometry type constraint.  At least that is the intention. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Thu May 19 15:08:23 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] LAYER_TYPE=thematic
In-Reply-To: <54ADBFDBF31282449B1CCCCE3683AD92D3673F@DEDUS-WICL01M01.vf-de.internal.vodafone.com>
References: <AcVXzfygNhx9cMoGRV2dy7EPrRJFRA==>
	<54ADBFDBF31282449B1CCCCE3683AD92D3673F@DEDUS-WICL01M01.vf-de.internal.vodafone.com>
Message-ID: <931f8ea90505191208239cee36@mail.gmail.com>

On 5/13/05, Schumann, Eike, VF-DE <eike.schumann@vodafone.com> wrote:

> //***************** Interesting part begin
> ******************************************
> //**********************************************************************
> *************
> 
>       GDALRasterBand* poBand = poDst->GetRasterBand(1);
> 
>       pMetaData = poBand->GetMetadata();
>       CSLSetNameValue( pMetaData, "LAYER_TYPE", "thematic");
> 
>       poBand->RasterIO( GF_Write, 0, 0, image.metaData.cols,
> image.metaData.rows, pixels, image.metaData.cols, image.metaData.rows,
> GDT_UInt16,0,0);

Eike, 

I applogise for the very late response.  First, you are not quite using
the poorly documented (or undocumented?) CSLSetNameValue() function
properly.  A more "proper" implementation might look like:

    char **pMetadata;
    pMetadata = CSLDuplicate(poBand->GetMetadata());
    pMetadata = CSLSetNameValue( pMetadata, "LAYER_TYPE", "thematic");
    poBand->SetMetadata( pMetadata );
    CSLDestroy( pMetadata );

However, the simpler form would be:

    poBand->SetMetadataItem( "LAYER_TYPE", "thematic" );

Then, in theory, when the dataset is closed, the layer type would
be reset to thematic.   However, I did not test that just now, so you
still might have problems. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From carl.anderson at vadose.org  Thu May 19 23:22:18 2005
From: carl.anderson at vadose.org (Carl Anderson)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TFW / WLD file error
Message-ID: <428D57EA.2040901@vadose.org>


I have blundered into an error handling WLD files in Lat/Long usages

For the following examples I tried tif + tfw, pnm + wld, jpg + wld, jpg 
+ jpw image and georeferencing  files.
I even tried passing it through gdal_translate.

first example produces invalid info

if the WLD file is
2.014
0
0
-2.014
-85.34
34.53

gdalinfo my.tif
Driver: GTiff/GeoTIFF
Size is 395, 511
Coordinate System is `'
Origin = (-86.347000,35.537000)
Pixel Size = (2.01400000,-2.01400000)
Corner Coordinates:
Upper Left  ( -86.3470000,  35.5370000)
Lower Left  (     -86.347,    -993.617)
Upper Right (     709.183,      35.537)
Lower Right (     709.183,    -993.617)
Center      (     311.418,    -479.040)
Band 1 Block=395x20 Type=Byte, ColorInterp=Red
Band 2 Block=395x20 Type=Byte, ColorInterp=Green
Band 3 Block=395x20 Type=Byte, ColorInterp=Blue


if I add arbitray digits to the WLD file by simply editnig that file
2.014
0
0
-2.014
-555585.34
555534.53

gdalinfo my.tif
Driver: GTiff/GeoTIFF
Size is 395, 511
Coordinate System is `'
Origin = (-555586.347000,555535.537000)
Pixel Size = (2.01400000,-2.01400000)
Corner Coordinates:
Upper Left  ( -555586.347,  555535.537)
Lower Left  ( -555586.347,  554506.383)
Upper Right ( -554790.817,  555535.537)
Lower Right ( -554790.817,  554506.383)
Center      ( -555188.582,  555020.960)
Band 1 Block=395x16 Type=Byte, ColorInterp=Red
Band 2 Block=395x16 Type=Byte, ColorInterp=Green
Band 3 Block=395x16 Type=Byte, ColorInterp=Blue

C.



From fwarmerdam at gmail.com  Fri May 20 08:30:03 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] TFW / WLD file error
In-Reply-To: <428D57EA.2040901@vadose.org>
References: <428D57EA.2040901@vadose.org>
Message-ID: <931f8ea905052005303eac39b8@mail.gmail.com>

On 5/19/05, Carl Anderson <carl.anderson@vadose.org> wrote:
> 
> I have blundered into an error handling WLD files in Lat/Long usages
> 
> For the following examples I tried tif + tfw, pnm + wld, jpg + wld, jpg
> + jpw image and georeferencing  files.
> I even tried passing it through gdal_translate.
> 
> first example produces invalid info
> 
> if the WLD file is
> 2.014
> 0
> 0
> -2.014
> -85.34
> 34.53
> 
> gdalinfo my.tif
> Driver: GTiff/GeoTIFF
> Size is 395, 511
> Coordinate System is `'
> Origin = (-86.347000,35.537000)
> Pixel Size = (2.01400000,-2.01400000)
> Corner Coordinates:
> Upper Left  ( -86.3470000,  35.5370000)
> Lower Left  (     -86.347,    -993.617)
> Upper Right (     709.183,      35.537)
> Lower Right (     709.183,    -993.617)
> Center      (     311.418,    -479.040)
> Band 1 Block=395x20 Type=Byte, ColorInterp=Red
> Band 2 Block=395x20 Type=Byte, ColorInterp=Green
> Band 3 Block=395x20 Type=Byte, ColorInterp=Blue

Carl,

I'm not sure what you consider to have gone wrong.   Perhaps
you should explain what you were expecting or hoping for. 

I would add that the origin in the world file is the center of
the top left pixel so the gdalinfo top left corner will be half a 
pixel north-west of the origin in the world file.   

In the above example, the values you gave for the origin
seemed like they might be lat/long, but the pixelsize (over
2 degrees by 2 degrees) was quite large.  Is it possible
you thought these pixel sizes were supposed to be in meters
or that they were the width and height of the whole image? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From leibold at lsec.dnd.ca  Fri May 20 12:37:40 2005
From: leibold at lsec.dnd.ca (Leibold, David)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdalwarp on CADRG / gltp: maps
Message-ID: <16727AD54B902446A4FE8DE23B20C8D11CE3CD@lsec.dnd.ca>

I'm trying to reproject some CADRG map files to UTM grid with gdalwarp.

gdalwarp straightens out individual tiles OK (e.g. *.TL2 files), then gdal_merge can build the full map from the tiles.

But when I attempt gdalwarp on the entire CADRP map using OGDI gltp:/rpf addressing, it always produces all-black images (albeit georeferenced images, when default GeoTiff output is used).

Do I need other options in gdalwarp for CADRG reprojections? Or will I have to warp and merge the individual tiles?


Further detail on what I tried:

gltp: addressing and OGDI seems to be working - gdalinfo produces info on the CADRG map with a gltp: address.

gdalwarp was tried with both the Matrix and Image datasets on the CADRG. No error messages were seen.

Example command:

C:>gdalwarp -t_srs "+proj=utm +zone=19 +datum=wgs84" "gltp:/rpf/map1/rpf" test99.tif
Using band 4 of source image as alpha.
Creating output file that is 1993P x 2136L.
:0...10...20...30...40...50...60...70...80...90...100 - done.

gdalwarp was also tried using the more precise gltp: addresses for each subdataset listed in gdalinfo (Matrix and Image sets).

Also tried pre-processing with gdal_translate - even trying -b switches to try different image bands than #4 Alpha. Still got black maps.

Thanks.

----------------------------------------
David Leibold


From fwarmerdam at gmail.com  Fri May 20 12:54:34 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] gdalwarp on CADRG / gltp: maps
In-Reply-To: <16727AD54B902446A4FE8DE23B20C8D11CE3CD@lsec.dnd.ca>
References: <16727AD54B902446A4FE8DE23B20C8D11CE3CD@lsec.dnd.ca>
Message-ID: <931f8ea905052009543f66e95a@mail.gmail.com>

On 5/20/05, Leibold, David <leibold@lsec.dnd.ca> wrote:
> Also tried pre-processing with gdal_translate - even trying -b switches to try different image bands than #4 Alpha. Still got black maps.

David, 

I think the first step is to get gdal_translate working on the dataset. 
If that isn't working, then the issue is likely a problem with the ADRG
driver in OGDI (or possibly the GDAL OGDI driver).  

To be honest I get confused about this to.  I tried it out with a 
1:1M CADRG dataset I have here.  When I do a gdalinfo on the dataset
I get alot of subdatasets:


Subdatasets:
  SUBDATASET_1_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:50K@1@CADRG@DMAAC@3":Matrix
  SUBDATASET_1_DESC=1:50K@1@CADRG@DMAAC@3 as Matrix
  SUBDATASET_2_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:50K@2@CADRG@DMAAC@4":Matrix
  SUBDATASET_2_DESC=1:50K@2@CADRG@DMAAC@4 as Matrix
  SUBDATASET_3_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:1M@1@CADRG@DMAAC@5":Matrix
  SUBDATASET_3_DESC=1:1M@1@CADRG@DMAAC@5 as Matrix
  SUBDATASET_4_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:1M@2@CADRG@DMAAC@6":Matrix
  SUBDATASET_4_DESC=1:1M@2@CADRG@DMAAC@6 as Matrix
  SUBDATASET_5_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:250K@1@CADRG@DMAAC@7":Matrix
  SUBDATASET_5_DESC=1:250K@1@CADRG@DMAAC@7 as Matrix
  SUBDATASET_6_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:250K@2@CADRG@DMAAC@8":Matrix
  SUBDATASET_6_DESC=1:250K@2@CADRG@DMAAC@8 as Matrix
  SUBDATASET_7_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:50K@1@CADRG@DMAAC@3":Image
  SUBDATASET_7_DESC=1:50K@1@CADRG@DMAAC@3 as Image
  SUBDATASET_8_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:50K@2@CADRG@DMAAC@4":Image
  SUBDATASET_8_DESC=1:50K@2@CADRG@DMAAC@4 as Image
  SUBDATASET_9_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:1M@1@CADRG@DMAAC@5":Image
  SUBDATASET_9_DESC=1:1M@1@CADRG@DMAAC@5 as Image
  SUBDATASET_10_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:1M@2@CADRG@DMAAC@6":Image
  SUBDATASET_10_DESC=1:1M@2@CADRG@DMAAC@6 as Image
  SUBDATASET_11_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:250K@1@CADRG@DMAAC@7":Image
  SUBDATASET_11_DESC=1:250K@1@CADRG@DMAAC@7 as Image
  SUBDATASET_12_NAME=gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:250K@2@CADRG@DMAAC@8":Image
  SUBDATASET_12_DESC=1:250K@2@CADRG@DMAAC@8 as Image

I tried accessing these individual subdatasets, and it seems the first
two were just all black at "full res" and show a coarse grid at reduced
resolutions.  But the third one was a respectible dataset.   Furthermore,
the command: 

 gdalwarp -t_srs '+proj=utm +zone=12 +datum=WGS84'
'gltp:/rpf/gdal/usr2/data/rpf/cadrg1M/rpf:"1:1M@1@CADRG@DMAAC@5":Matrix'
~/out.tif

Turn it into a decent reprojected image. 

So, I think the key is to try each of the subdatasets and discover
which are "real" images of interest.  Then warp those. 

The good news is that it does work with CADRG in at least some 
situations. 

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fabrice.lallauret at thales-tts.com  Fri May 20 13:36:40 2005
From: fabrice.lallauret at thales-tts.com (LALLAURET Fabrice - <SSII>)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] performance problem with several DEM reading/updating at
 the same time
Message-ID: <428E2028.1070701@thales-tts.com>

Hello,
I'm playing with gdal and I don't understand some performance problem I 
have:
I'm reading several geotiff dems pixel by pixel at the same time (I 
know, this is not optimal but for my application, it's simplifying the job).
My code is like this :

    for (int i = 0; i < nbx1 ; i+=step)
    {
        for (int j = 0; j < nby1 ; j+=step)
        {
            z1 = z2 = 0.0;
            eErr = band1->RasterIO( GF_Read, i , j , 1 ,1 , &z1 ,1 ,  1 
, GDT_Float32, 0,0);
            if (eErr != CE_None)
                printf("Problem reading band1  %d %d\n",i,j);
            eErr = band2->RasterIO( GF_Read, i , j , 1 ,1 , &z2 ,1 ,  1 
, GDT_Float32, 0,0);
            if (eErr != CE_None)
                printf("Problem reading band2  %d %d\n",i,j);
        }
    }
When I only read a single dem, the test program takes 0.95 s to run. If 
I read a second dem at the same time (as above), the program takes 50 s. 
Why this difference of performance ? (With a writting process performing 
the same test, the program reach 12min !!)

Thanks

-- 
     .--.    Fabrice LALLAURET - STV Team
    |o_o |   Tel: (33) (01 34) 22 84 33
    |:_/ |   Thales Training & Simulation
   //   \ \  1, rue du General de Gaulle
  (|     | ) Z.I. les beaux soleils
 /'\_   _/`\ Osny. B.P. 226
 \___)=(___/ 95523 Cergy-Pontoise Cedex
 E-mail: fabrice.lallauret@thales-tts.com
 My personnal (french) Websites: http://www.xbee.net
 and http://www.french-comics-zone.fr.st



From dkleiner at cmf.nrl.navy.mil  Fri May 20 13:38:18 2005
From: dkleiner at cmf.nrl.navy.mil (Dardo D Kleiner - CONTRACTOR)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha
Message-ID: <200505201738.j4KHcIhu004870@ginger.cmf.nrl.navy.mil>

So I have a set of source imagery in a particular non-WGS84 projection that I
want to convert to a set of raw tiles in WGS84.  I figured I could make use
of the fantastic VRT format to minimize the number of stages required.  So I
build a "layered" vrt tree like this (forgive the ASCII art):

[src1.tif] [src2.tif] [src3.tif] . . . [srcN.tif] (say, 10k x 10k images)
     |          |          |                |
[src1.vrt] [src2.vrt] [src3.vrt] . . . [srcN.vrt] (add georeferencing)
     \          \          /                /
      \          \        /                /
       \          \      /                /
        \---------[src.vrt]--------------/ (i.e. a vrt mosaic)
                      |
                      | gdalwarp -of vrt -s_srs EPSG:xxxx -t_srs EPSG:4326 \
                      |       -co ALPHA=YES -dstalpha src.vrt dest.vrt
                      |
        /---------[dest.vrt]-------------\
       /           /     \                \
      /           /       \                \
     /           /         \                \
[dest1.vrt] [dest2.vrt] [dest3.vrt] . . . [destM.vrt] (512 x 512 tile grid)
     |           |           |                 |
[dest1r.vrt] [dest2r.vrt] [dest3r.vrt] . . . [destMr.vrt] (VRTRawRasterBand)
     |           |           |                 |
[dest1.8888] [dest2.8888] [dest3.8888] . . . [destM.8888] (raw tiles)

I'd like to just be able to run a pass over the dest? files doing
'gdalwarp -of vrt dest?.vrt dest?r.vrt' and have the dest?.8888 files
"magically" created.  In the GDAL Virtual Format Tutorial it says "The
VRTRawRasterBand supports in place update of the raster, whereas the source
based VRTRasterBand is always read-only.", which leads me to believe that I
can write to a vrt that has VRTRawRasterBand.  And gdalwarp says "Mosaicing
into an existing output file is supported if the output file already exists."

I've encountered two problems.

1) When I try to access dest.vrt (say, gdal_translate dest.vrt dest.tif), I
get alot of these errors:

ERROR 6: WriteBlock() not supported for this dataset.

and the resulting image is "wrong", in that the color is very "blue".  If I
don't use "-co ALPHA=YES -dstalpha" the output is "correct".  But I need the
alpha channel to avoid displaying the black edges that result from the warp
operation.

2) When I try to 'gdalwarp -of vrt dest?.vrt dest?.raw' it always overwrites my
raw files with a new VRTWarpedDataset definition, rather than writing "into"
the existing raw VRT and producing the raw tile output file.

Is what I'm attempting supported?  On a more philosophical level, is it insane?

Thanks for any help!
- Dardo


From fwarmerdam at gmail.com  Fri May 20 13:44:00 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] performance problem with several DEM reading/updating
	at the same time
In-Reply-To: <428E2028.1070701@thales-tts.com>
References: <428E2028.1070701@thales-tts.com>
Message-ID: <931f8ea905052010443dd20f5c@mail.gmail.com>

On 5/20/05, LALLAURET Fabrice - <SSII> <fabrice.lallauret@thales-tts.com> wrote:
> Hello,
> I'm playing with gdal and I don't understand some performance problem I
> have:
> I'm reading several geotiff dems pixel by pixel at the same time (I
> know, this is not optimal but for my application, it's simplifying the job).
...
> When I only read a single dem, the test program takes 0.95 s to run. If
> I read a second dem at the same time (as above), the program takes 50 s.
> Why this difference of performance ? (With a writting process performing
> the same test, the program reach 12min !!)

Fabrice, 

My guess is that once you go to the second file you are getting into
a cache thrashing problem.  This is especially likely with some DEM 
formats such as USGS DEM or DTED that are not row oriented.  
If the two files together take more memory than the cache is configured
for, then each read will force the other files data out of memory causing
huge amounts of extra work.

The obvious solution is upping your cache limit, for instance via the
GDAL_CACHEMAX environment variable.  Try setting that to 100
(for 100MB) and see if it makes a difference. 

If not, you may need to provide the full configuration (commandline
program + data files) for me to try out.  Lots of issues can have an 
impact including size of dataset, format, etc). 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri May 20 13:52:15 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha
In-Reply-To: <200505201738.j4KHcIhu004870@ginger.cmf.nrl.navy.mil>
References: <200505201738.j4KHcIhu004870@ginger.cmf.nrl.navy.mil>
Message-ID: <931f8ea90505201052b909699@mail.gmail.com>

On 5/20/05, Dardo D Kleiner - CONTRACTOR <dkleiner@cmf.nrl.navy.mil> wrote:
> So I have a set of source imagery in a particular non-WGS84 projection that I
> want to convert to a set of raw tiles in WGS84.  I figured I could make use
> of the fantastic VRT format to minimize the number of stages required.  So I
> build a "layered" vrt tree like this (forgive the ASCII art):
> 
> [src1.tif] [src2.tif] [src3.tif] . . . [srcN.tif] (say, 10k x 10k images)
>      |          |          |                |
> [src1.vrt] [src2.vrt] [src3.vrt] . . . [srcN.vrt] (add georeferencing)
>      \          \          /                /
>       \          \        /                /
>        \          \      /                /
>         \---------[src.vrt]--------------/ (i.e. a vrt mosaic)
>                       |
>                       | gdalwarp -of vrt -s_srs EPSG:xxxx -t_srs EPSG:4326 \
>                       |       -co ALPHA=YES -dstalpha src.vrt dest.vrt
>                       |
>         /---------[dest.vrt]-------------\
>        /           /     \                \
>       /           /       \                \
>      /           /         \                \
> [dest1.vrt] [dest2.vrt] [dest3.vrt] . . . [destM.vrt] (512 x 512 tile grid)
>      |           |           |                 |
> [dest1r.vrt] [dest2r.vrt] [dest3r.vrt] . . . [destMr.vrt] (VRTRawRasterBand)
>      |           |           |                 |
> [dest1.8888] [dest2.8888] [dest3.8888] . . . [destM.8888] (raw tiles)
> 
> I'd like to just be able to run a pass over the dest? files doing
> 'gdalwarp -of vrt dest?.vrt dest?r.vrt' and have the dest?.8888 files
> "magically" created.  In the GDAL Virtual Format Tutorial it says "The
> VRTRawRasterBand supports in place update of the raster, whereas the source
> based VRTRasterBand is always read-only.", which leads me to believe that I
> can write to a vrt that has VRTRawRasterBand.  And gdalwarp says "Mosaicing
> into an existing output file is supported if the output file already exists."
> 
> I've encountered two problems.
> 
> 1) When I try to access dest.vrt (say, gdal_translate dest.vrt dest.tif), I
> get alot of these errors:
> 
> ERROR 6: WriteBlock() not supported for this dataset.
> 
> and the resulting image is "wrong", in that the color is very "blue".  If I
> don't use "-co ALPHA=YES -dstalpha" the output is "correct".  But I need the
> alpha channel to avoid displaying the black edges that result from the warp
> operation.

Dardo, 

I'm not sure I follow your whole tree of .vrt's concept properly.  Is dest.vrt
using a bunch of <SimpleSource>'s to refer to individual tiles?  You should
be able to read from such a thing, but you cannot write to it. 
 
> 2) When I try to 'gdalwarp -of vrt dest?.vrt dest?.raw' it always overwrites my
> raw files with a new VRTWarpedDataset definition, rather than writing "into"
> the existing raw VRT and producing the raw tile output file.

Try not including the "-of vrt"  part.  When gdalwarp sees you have 
"-of VRT" it does alot of special stuff to write out a new VRT describing
the warp instead of actually performing the warp.  But you should be able
to warp into a preexisting raw file described with a .vrt file.  

> Is what I'm attempting supported?

I think so, with the -of caveat. 

>  On a more philosophical level, is it insane?

Umm, you should be aware that you are stressing things a bit beyond what
I had in mind.  In particular, be aware that having .vrt files using
<SimpleSource>
to describe mosaics of many tiles may have performance problems.  The 
implementation of the <SimpleSource> mechanism does *not* scale gracefully
up to hundreds of thousands of files.  Though it should work fine for dozens
of files.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dkleiner at cmf.nrl.navy.mil  Fri May 20 14:17:37 2005
From: dkleiner at cmf.nrl.navy.mil (Dardo D Kleiner - CONTRACTOR)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha 
In-Reply-To: Message from Frank Warmerdam <fwarmerdam@gmail.com> of "Fri,
	20 May 2005 13:52:15 EDT." <931f8ea90505201052b909699@mail.gmail.com> 
Message-ID: <200505201817.j4KIHb32005951@ginger.cmf.nrl.navy.mil>

>> [src1.tif] [src2.tif] [src3.tif] . . . [srcN.tif] (say, 10k x 10k images)
>>      |          |          |                |
>> [src1.vrt] [src2.vrt] [src3.vrt] . . . [srcN.vrt] (add georeferencing)
>>      \          \          /                /
>>       \          \        /                /
>>        \          \      /                /
>>         \---------[src.vrt]--------------/ (i.e. a vrt mosaic)
>>                       |
>>                       | gdalwarp -of vrt -s_srs EPSG:xxxx -t_srs EPSG:4326 \
>>                       |       -co ALPHA=YES -dstalpha src.vrt dest.vrt
>>                       |
>>         /---------[dest.vrt]-------------\
>>        /           /     \                \
>>       /           /       \                \
>>      /           /         \                \
>> [dest1.vrt] [dest2.vrt] [dest3.vrt] . . . [destM.vrt] (512 x 512 tile grid)
>>      |           |           |                 |
>> [dest1r.vrt] [dest2r.vrt] [dest3r.vrt] . . . [destMr.vrt] (VRTRawRasterBand)
>>      |           |           |                 |
>> [dest1.8888] [dest2.8888] [dest3.8888] . . . [destM.8888] (raw tiles)

> I'm not sure I follow your whole tree of .vrt's concept properly.  Is dest.vrt
> using a bunch of <SimpleSource>'s to refer to individual tiles?  You should
> be able to read from such a thing, but you cannot write to it. 

dest.vrt is created by the gdalwarp command in the middle of the tree.  So it
is a VRTWarpedDataset that references the src.vrt mosaic and specifies the warp
options from the source projection to WGS84.  Then each dest?.vrt uses a
<SimpleSource> and <SrcRect> to read small tile-sized regions from the "main"
dest.vrt file.  

So all the way down the tree to the "512 x 512 tile grid" row, each vrt is
reading from the row above it, either via <SimpleSource>, or, in the case of
dest.vrt, via <SourceDataset> within <GDALWarpOptions>.

At the bottom, each dest?r.vrt is supposed to specify the raw output format, i.e.

<VRTDataset rasterXSize="512" rasterYSize="512">
        <VRTRasterBand dataType="Byte" band="1" subClass="VRTRawRasterBand">
                <ColorInterp>Red</ColorInterp>
                <SourceFilename relativetoVRT="1">dest?.8889</SourceFilename>
                <ImageOffset>0</ImageOffset>
                <PixelOffset>4</PixelOffset>
                <LineOffset>2048</LineOffset>
        </VRTRasterBand>
        <VRTRasterBand dataType="Byte" band="2" subClass="VRTRawRasterBand">
                <ColorInterp>Green</ColorInterp>
                <SourceFilename relativetoVRT="1">dest?.8888</SourceFilename>
                <ImageOffset>1</ImageOffset>
                <PixelOffset>4</PixelOffset>
                <LineOffset>2048</LineOffset>
        </VRTRasterBand>
        <VRTRasterBand dataType="Byte" band="3" subClass="VRTRawRasterBand">
                <ColorInterp>Blue</ColorInterp>
                <SourceFilename relativetoVRT="1">dest?.8888</SourceFilename>
                <ImageOffset>2</ImageOffset>
                <PixelOffset>4</PixelOffset>
                <LineOffset>2048</LineOffset>
        </VRTRasterBand>
        <VRTRasterBand dataType="Byte" band="4" subClass="VRTRawRasterBand">
                <ColorInterp>Alpha</ColorInterp>
                <SourceFilename relativetoVRT="1">dest?.8888</SourceFilename>
                <ImageOffset>3</ImageOffset>
                <PixelOffset>4</PixelOffset>
                <LineOffset>2048</LineOffset>
        </VRTRasterBand>
</VRTDataset>

> Try not including the "-of vrt"  part.  When gdalwarp sees you have 
> "-of VRT" it does alot of special stuff to write out a new VRT describing
> the warp instead of actually performing the warp.  But you should be able
> to warp into a preexisting raw file described with a .vrt file.  

I've found that if I 'touch' the dest?.8888 file before warping (without
specifying "-of vrt"), I get the following error:

"ERROR 5: Destination band 1 appears to be read-only."

If I don't specify "-of vrt", even though the output already exists it gets
overwritten as a GeoTIFF file.

>>  On a more philosophical level, is it insane?

> Umm, you should be aware that you are stressing things a bit beyond what
> I had in mind.  In particular, be aware that having .vrt files using
> <SimpleSource>
> to describe mosaics of many tiles may have performance problems.  The 
> implementation of the <SimpleSource> mechanism does *not* scale gracefully
> up to hundreds of thousands of files.  Though it should work fine for dozens
> of files.

At most I'd have a 3-5 thousand source images.  Up to now, I've been warping
each individual source file, then mosaicing the bunch, then chopping up the
mosaic into my desired 512 x 512 tiles.  This method is very time consuming as
well as space consuming, and for mosaics that approach 2^20 pixels in
width/height it's just impossible.  When I realized the potential of VRT to
give me a single-phase operation, I thought I'd give it a shot.

Thanks again!
- Dardo


From fwarmerdam at gmail.com  Fri May 20 14:34:06 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha
In-Reply-To: <200505201817.j4KIHb32005951@ginger.cmf.nrl.navy.mil>
References: <fwarmerdam@gmail.com> <931f8ea90505201052b909699@mail.gmail.com>
	<200505201817.j4KIHb32005951@ginger.cmf.nrl.navy.mil>
Message-ID: <931f8ea9050520113463e96783@mail.gmail.com>

On 5/20/05, Dardo D Kleiner - CONTRACTOR <dkleiner@cmf.nrl.navy.mil> wrote:
> I've found that if I 'touch' the dest?.8888 file before warping (without
> specifying "-of vrt"), I get the following error:
> 
> "ERROR 5: Destination band 1 appears to be read-only."
> 
> If I don't specify "-of vrt", even though the output already exists it gets
> overwritten as a GeoTIFF file.

Dardo, 

Hmm, this sounds like a bug.  If you can submit sufficient details in Bugzilla
I would hope to dig into it. 
 
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dkleiner at cmf.nrl.navy.mil  Fri May 20 16:14:51 2005
From: dkleiner at cmf.nrl.navy.mil (Dardo D Kleiner - CONTRACTOR)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha 
In-Reply-To: Message from Frank Warmerdam <fwarmerdam@gmail.com> of "Fri,
	20 May 2005 14:34:06 EDT." <931f8ea9050520113463e96783@mail.gmail.com> 
Message-ID: <200505202014.j4KKEqfa008995@ginger.cmf.nrl.navy.mil>

> Hmm, this sounds like a bug.  If you can submit sufficient details in
> Bugzilla I would hope to dig into it. 

Done.  So how about my first problem regarding the use of '-co ALPHA=YES
-dstalpha' when creating VRTWarpedDatasets?  I keep getting unexpected results
in attempts at reading from the resulting .vrt file, and haven't managed to
nail down a clean bug case.  Things like if the BlockX/YSize isn't a multiple
of the dataset size, I get errors like:

Input file size is 600, 600
0.ERROR 6: WriteBlock() not supported for this dataset.
ERROR 5: Access window out of range in RasterIO().  Requested
(512,0) of size 512x128 on raster of 600x600.
ERROR 1: IReadBlock failed at X offset 1, Y offset 0
ERROR 1: GetBlockRef failed at X block offset 1, Y block offset 0
ERROR 6: WriteBlock() not supported for this dataset.

But specifying block size in the gdalwarp command doesn't seem to work (using
'-co BLOCKXSIZE <x> -co BLOCKYSIZE <y>', the resulting .vrt always has 512/128.

And putting it all together, as in:
'-co TILED=YES -co BLOCKXSIZE=512 -co BLOCKYSIZE=512 -co ALPHA=YES -dstalpha'

causes:

Program terminated with signal 11, Segmentation fault.
.
.
.
#0  0x41afd04c in _int_free () from /lib/tls/libc.so.6
#1  0x41afc01b in free () from /lib/tls/libc.so.6
#2  0x40174f01 in VSIFree () from /afs/cmf/project/gis/lib/libgdal.so.1
#3  0x401736cd in CSLDestroy () from /afs/cmf/project/gis/lib/libgdal.so.1
#4  0x0804a33c in main ()

If I hand-edit the file to make it a solid multiple, it doesn't break, but I
still get a whole bunch of "ERROR 6: WriteBlock() not supported for this
dataset" errors.  I can't yet verify whether or not the output alpha channel is
getting the right values for the "warp border" - In a test that uses a "real"
projection, like I mentioned originally, all I can say right now is that 
I get all those ERROR 6's and the output image is excessively blue.

Any ideas?  I'll keep at trying to reduce it to a simple case, but if you have
any suggestions that would be great!
- Dardo


From fwarmerdam at gmail.com  Fri May 20 16:34:32 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] VRTWarpedDataset w/ -dstalpha
In-Reply-To: <200505202014.j4KKEqfa008995@ginger.cmf.nrl.navy.mil>
References: <fwarmerdam@gmail.com> <931f8ea9050520113463e96783@mail.gmail.com>
	<200505202014.j4KKEqfa008995@ginger.cmf.nrl.navy.mil>
Message-ID: <931f8ea9050520133425efba19@mail.gmail.com>

On 5/20/05, Dardo D Kleiner - CONTRACTOR <dkleiner@cmf.nrl.navy.mil> wrote:
> Any ideas?  I'll keep at trying to reduce it to a simple case, but if you have
> any suggestions that would be great!

Dardo,

Sorry, I don't really know why that is happening.  I would need to reproduce
and track through the problem. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From roger at beardandsandals.co.uk  Fri May 20 16:56:51 2005
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] proj coordinate conversions give different results than
	they gave a few months ago
Message-ID: <20050520205552.14AC354152@cmlapp11.siteprotect.com>

I have just resynched my gdal and proj sources from CVS. My gdal source was
a couple of months old, but my proj was much older (it was from the old
repository location).

 

I have some locations (in a VTP model) stored as WGS84 lat long. These were
stored using my old build of gdal. When VTP converts these back into Bitish
National Grid (OSGB 36) they are now offset by 60 or 70 metres.

 

The conversions are done by OGRCreateCoordinateTransformation.

 

Does anyone know of any reason why this difference has appeared?

 

I also checked the conversions using GridInquest and this confirms that the
wrong values are being returned(of course this does not tell me if the input
values where wrong in the first place!).

 

I have looked at the code and it does not look like anything has changed.

 

Help!

 

Roger

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050520/8e9de681/attachment.html
From dem at acri-st.fr  Mon May 23 07:05:27 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Problem with Lambert Conformal Conic projection.
Message-ID: <6.1.1.1.0.20050523130409.0239a5d0@pop3>

Hi,

When I use gdal_translate with a Lambert Conformal Conic projection,
ProjFalseEastingGeokey and ProjFalseNorthingGeokey are not copied.

 >gdalinfo lambert93.tif

Driver: GTiff/GeoTIFF
Size is 1, 1
Coordinate System is:
PROJCS[,
     GEOGCS["IMAGINE GeoTIFF Support
Copyright 1991 - 1999 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: gtiff_io.c,v $ $Revision: 1.13 $ $Date: 2004/07/15 15:11:38 $
Unable to match Ellipsoid (Datum) to a Geo",
         DATUM["unknown",
             SPHEROID["GRS 1980",6378137,298.2572221010042,
                 AUTHORITY["EPSG","7019"]]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Lambert_Conformal_Conic_2SP"],
     PARAMETER["standard_parallel_1",44],
     PARAMETER["standard_parallel_2",49],
     PARAMETER["latitude_of_origin",46.5],
     PARAMETER["central_meridian",3],
     PARAMETER["false_easting",700000],
     PARAMETER["false_northing",6600000],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (737240.360000,6824856.720000)
Pixel Size = (0.68000000,-0.68000000)
Metadata:
   TIFFTAG_RESOLUTIONUNIT=1 (unitless)
Corner Coordinates:
Upper Left  (  737240.360, 6824856.720) (  3d30'15.54"E, 48d31'22.37"N)
Lower Left  (  737240.360, 6824856.040) (  3d30'15.54"E, 48d31'22.35"N)
Upper Right (  737241.040, 6824856.720) (  3d30'15.58"E, 48d31'22.37"N)
Lower Right (  737241.040, 6824856.040) (  3d30'15.58"E, 48d31'22.35"N)
Center      (  737240.700, 6824856.380) (  3d30'15.56"E, 48d31'22.36"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue

 >gdal_translate lambert93.tif translate_lambert93.tif

 >gdalinfo translate_lambert93.tif


Driver: GTiff/GeoTIFF
Size is 1, 1
Coordinate System is:
PROJCS[,
     GEOGCS["IMAGINE GeoTIFF Support
Copyright 1991 - 1999 by ERDAS, Inc. All Rights Reserved
@(#)$RCSfile: gtiff_io.c,v $ $Revision: 1.13 $ $Date: 2004/07/15 15:11:38 $
Unable to match Ellipsoid (Datum) to a Geo",
         DATUM["unknown",
             SPHEROID["GRS 1980",6378137,298.2572221010042,
                 AUTHORITY["EPSG","7019"]]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Lambert_Conformal_Conic_2SP"],
     PARAMETER["standard_parallel_1",44],
     PARAMETER["standard_parallel_2",49],
     PARAMETER["latitude_of_origin",46.5],
     PARAMETER["central_meridian",3],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (737240.360000,6824856.720000)
Pixel Size = (0.68000000,-0.68000000)
Metadata:
   TIFFTAG_RESOLUTIONUNIT=1 (unitless)
Corner Coordinates:
Upper Left  (  737240.360, 6824856.720) (169d16'18.53"W, 85d50'22.87"N)
Lower Left  (  737240.360, 6824856.040) (169d16'18.66"W, 85d50'22.88"N)
Upper Right (  737241.040, 6824856.720) (169d16'18.66"W, 85d50'22.87"N)
Lower Right (  737241.040, 6824856.040) (169d16'18.79"W, 85d50'22.88"N)
Center      (  737240.700, 6824856.380) (169d16'18.66"W, 85d50'22.87"N)
Band 1 Block=1x1 Type=Byte, ColorInterp=Red
Band 2 Block=1x1 Type=Byte, ColorInterp=Green
Band 3 Block=1x1 Type=Byte, ColorInterp=Blue
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lambert93.tif.gz
Type: application/octet-stream
Size: 780 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050523/9af914e6/lambert93.tif.obj
From tylermitchell at shaw.ca  Mon May 23 09:51:56 2005
From: tylermitchell at shaw.ca (Tyler Mitchell)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Problem with Lambert Conformal Conic projection.
Message-ID: <19b6c9119b62d3.19b62d319b6c91@shaw.ca>

> When I use gdal_translate with a Lambert Conformal Conic projection,
> ProjFalseEastingGeokey and ProjFalseNorthingGeokey are not copied.

I'm not sure why, but I wonder if it is related to the image being only size = 1,1.  Have you tried this on a larger image?

Tyler 
-------------- next part --------------
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev
From dem at acri-st.fr  Mon May 23 10:05:53 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Problem with Lambert Conformal Conic projection.
In-Reply-To: <19b6c9119b62d3.19b62d319b6c91@shaw.ca>
References: <19b6c9119b62d3.19b62d319b6c91@shaw.ca>
Message-ID: <6.1.1.1.0.20050523160343.023af9f8@pop3>

Tyler,

All my tests was on a standard image larger than 1x1, but I create this 
small image because there is a size limit of attachments on the mailing list.

Regards,

Julien

At 15:51 23/05/2005, Tyler Mitchell wrote:
> > When I use gdal_translate with a Lambert Conformal Conic projection,
> > ProjFalseEastingGeokey and ProjFalseNorthingGeokey are not copied.
>
>I'm not sure why, but I wonder if it is related to the image being only 
>size = 1,1.  Have you tried this on a larger image?
>
>Tyler
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev


From fwarmerdam at gmail.com  Mon May 23 11:31:53 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Problem with Lambert Conformal Conic projection.
In-Reply-To: <6.1.1.1.0.20050523130409.0239a5d0@pop3>
References: <6.1.1.1.0.20050523130409.0239a5d0@pop3>
Message-ID: <931f8ea905052308317eeedfa6@mail.gmail.com>

On 5/23/05, Julien Demaria <dem@acri-st.fr> wrote:
> Hi,
> 
> When I use gdal_translate with a Lambert Conformal Conic projection,
> ProjFalseEastingGeokey and ProjFalseNorthingGeokey are not copied.

Julien,

I tried your example with GDAL CVS and the false easting and northing
were not lost.  Are you using 1.2.6?  On what platform?  I don't
*recall* fixing something like this recently, but I have a terrible memory
so it is possible it was fixed since 1.2.6 was released.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon May 23 12:03:24 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Multi-threading Support
Message-ID: <931f8ea90505230903503c2b8e@mail.gmail.com>

Folks,

I have committed a variety of changes to GDAL in support of thread
safety.  On win32 these capabilities should now be utilized by default.
On unix you would need to configure --with-pthread and then hand edit
a definition for CPL_THREADLOCAL into cpl_config.h.  I intend to make
the use on unix smoother when I return.

I have done some fairly intensive tests with multireadtest.exe (in 
gdal/apps) and I have reasonably confidence in multi-threaded
use within the the following restrictions:

 o Any given GDALDataset is used only from one thread.
 o The GDAL driver list should be initialized only once (ie. a
    call to GDALAllRegister()). 
 o Currently error handlers are per-thread, so if you want to install
    a custom error handler, you will need to do this for each thread
    depending on it. 
 o The block cache is shared amoung all threads. 
 o My testing has been mostly in a read-only environment.  I don't
    see any obvious problem with writing, but it hasn't been tested
    in a multithreaded environment. 
  o I have not reviewed the OGRSpatialReference related code for
     threadsafety yet.  

The code is incorporated in CVS now.  Some changes went in this
morning, so last night's cvs snapshot will still be buggy.  

For background, I have made a number of additions to cpl_multiproc.cpp/h
including the addition of a mutex holder class.  

I have also modified the assumptions with regard to CPLAcquireMutex().  
It is now expected to support recursive mutex acquisition.  That is, a 
thread can safely acquire an already held mutex again.  Normal reference 
counting rules apply.  I am a bit concerned about how portable this will
be on different pthreads implementations.  Currently I have tested it on
Linux and I had to use the apparently non-standard
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP mutex initialization.
It may be that additional work will be needed for multi-threaded mutex
support on other platforms. 

The other key change was introduction of the CPL_THREADLOCAL
macro.  This attribute for a variable marks it as being thread-local.
That is, a separate instance will exist for each thread.  I have applied
this to a variety of static buffers in gdal/port such as the "last error
message" buffer.   On win32 this evaluates to __declspec(thread). 
On other platforms it resolves to nothing by default, but if you have
an appropriately modern version of gcc you can have it expand
to __thread.  I have tested this with gcc 3.3 on Linux successfully.
I still need to develop the appropriate configuration control around 
this definition.

Those with a strong interest in GDAL multi-threaded support are
encouraged to test it over the next two weeks while I am away.
However, as it is all quite new some teething problems are to be
expected.  So take care with the latest CVS version of GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Ken.Boss at dnr.state.mn.us  Mon May 23 14:41:28 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
Message-ID: <s291ddf5.017@co5.dnr.state.mn.us>

Hello Frank--

I tried again to use gdal_translate to create a large ECW output from
input tiles described in a .vrt file, this time with a more appropriate
pagefile config.  But again it failed after ~30 hours at 80% completion
owing to a memory allocation error.  Here are the basics of my setup:

Win2k
single 2.4 Ghz Pentium 4 processor
1.5 GB RAM
2.5 GB pagefile space
~600 input tiles in .vrt
typical tile size 400 MB
output image 307060 x 464371 pixels x 3 bands (lots of offsite)

Do you think I am simply pushing the envelope too far?  Performance
(processing time) does not seem to be a problem (esp. considering that I
set up the same process to run using "a leading competitor's"
shrink-wrapped wavelet compression solution, and it was running on a
pace to complete after 12 days when I finally killed it), but obviously
these memory allocation errors present a bit of an obstacle.

--Ken



From fwarmerdam at gmail.com  Mon May 23 14:48:59 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
In-Reply-To: <s291ddf5.017@co5.dnr.state.mn.us>
References: <s291ddf5.017@co5.dnr.state.mn.us>
Message-ID: <931f8ea905052311487ccc964d@mail.gmail.com>

On 5/23/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Hello Frank--
> 
> I tried again to use gdal_translate to create a large ECW output from
> input tiles described in a .vrt file, this time with a more appropriate
> pagefile config.  But again it failed after ~30 hours at 80% completion
> owing to a memory allocation error.  Here are the basics of my setup:

Ken,

I can't say that I have tried an encoding nearly as demanding as yours.
I will say that the ECW library tends to produce substantial temporary
files.  I am wondering if it might be running out of disk space for the
phase where the temporary files and the output file are in existance
at the same time.  

If I was you, I would try creating a mosaic for the "top half" of this,
and make sure it completes successfully.   I'm afraid I don't know the
limits involved in producing such large images in ECW format. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From MChapman at sanz.com  Mon May 23 15:26:38 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Multi-threading Support
Message-ID: <ED3A48B9840E594890A2BC172D11946502F9BE82@mailman.san.com>

Frank,

That rocks!!!  You are the man!  

Martin

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Frank Warmerdam
Sent: Monday, May 23, 2005 10:03 AM
To: gdal-dev
Cc: Steve Soule
Subject: [Gdal-dev] Multi-threading Support


Folks,

I have committed a variety of changes to GDAL in support of thread
safety.  On win32 these capabilities should now be utilized by default.
On unix you would need to configure --with-pthread and then hand edit a
definition for CPL_THREADLOCAL into cpl_config.h.  I intend to make the
use on unix smoother when I return.

I have done some fairly intensive tests with multireadtest.exe (in 
gdal/apps) and I have reasonably confidence in multi-threaded use within
the the following restrictions:

 o Any given GDALDataset is used only from one thread.
 o The GDAL driver list should be initialized only once (ie. a
    call to GDALAllRegister()). 
 o Currently error handlers are per-thread, so if you want to install
    a custom error handler, you will need to do this for each thread
    depending on it. 
 o The block cache is shared amoung all threads. 
 o My testing has been mostly in a read-only environment.  I don't
    see any obvious problem with writing, but it hasn't been tested
    in a multithreaded environment. 
  o I have not reviewed the OGRSpatialReference related code for
     threadsafety yet.  

The code is incorporated in CVS now.  Some changes went in this morning,
so last night's cvs snapshot will still be buggy.  

For background, I have made a number of additions to cpl_multiproc.cpp/h
including the addition of a mutex holder class.  

I have also modified the assumptions with regard to CPLAcquireMutex().  
It is now expected to support recursive mutex acquisition.  That is, a 
thread can safely acquire an already held mutex again.  Normal reference

counting rules apply.  I am a bit concerned about how portable this will
be on different pthreads implementations.  Currently I have tested it on
Linux and I had to use the apparently non-standard
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP mutex initialization. It may be
that additional work will be needed for multi-threaded mutex support on
other platforms. 

The other key change was introduction of the CPL_THREADLOCAL macro.
This attribute for a variable marks it as being thread-local. That is, a
separate instance will exist for each thread.  I have applied this to a
variety of static buffers in gdal/port such as the "last error
message" buffer.   On win32 this evaluates to __declspec(thread). 
On other platforms it resolves to nothing by default, but if you have an
appropriately modern version of gcc you can have it expand to __thread.
I have tested this with gcc 3.3 on Linux successfully. I still need to
develop the appropriate configuration control around 
this definition.

Those with a strong interest in GDAL multi-threaded support are
encouraged to test it over the next two weeks while I am away. However,
as it is all quite new some teething problems are to be expected.  So
take care with the latest CVS version of GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From c.krikke at hccnet.nl  Mon May 23 15:54:50 2005
From: c.krikke at hccnet.nl (Kees Krikke)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] bessel to wgs84?
Message-ID: <001601c55fd1$4854d590$6502a8c0@D24C071J>

Hello,

I'm trying to reproject some images from the Dutch RD coordinate system (epsg:28992) that is defined as:

+proj=stere +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m  +no_defs

to utm zone 31N /wgs84
+proj=utm +zone=31 +datum=wgs84

For the datum shift i guess i need to specify the +towgs argument also with the source coordinate system. (+towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491)

I verified these values by running proj.exe and the results are ok.

But if i use these proj4 strings with the gdalwarp -s_srs and -t_srs arguments the resulting images  are not as i expected. It seems that the shift from bessel to wgs84 is not done. 

What do i need to do in order to create images wgs84  from images based on a bessel ellipsoid?

Thanks in advance.

Kees

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050523/001b2082/attachment.html
From fwarmerdam at gmail.com  Mon May 23 16:33:34 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] bessel to wgs84?
In-Reply-To: <001601c55fd1$4854d590$6502a8c0@D24C071J>
References: <001601c55fd1$4854d590$6502a8c0@D24C071J>
Message-ID: <931f8ea905052313331fa4c009@mail.gmail.com>

On 5/23/05, Kees Krikke <c.krikke@hccnet.nl> wrote:
>  
> Hello, 
>   
> I'm trying to reproject some images from the Dutch RD coordinate system
> (epsg:28992) that is defined as: 
>   
> +proj=stere +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908
> +x_0=155000 +y_0=463000 +ellps=bessel +units=m  +no_defs 
>   
> to utm zone 31N /wgs84 
> +proj=utm +zone=31 +datum=wgs84 
>   
> For the datum shift i guess i need to specify the +towgs argument also with
> the source coordinate system.
> (+towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491) 
>   
> I verified these values by running proj.exe and the results are ok. 

Kees, 

Note that proj.exe ignores the +towgs84 specification.  If you want something
analygous to what gdalwarp will do, then you should use cs2cs. 

eg. 

cs2cs    +proj=stere +lat_0=52.15616055555555 +lon_0=5.38763888888889
+k=0.999908
> +x_0=155000 +y_0=463000 +ellps=bessel +units=m +towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491 +no_defs  +to +proj=utm +zone=31 +datum=wgs84 


If gdalwarp isn't agreeing with the result of the cs2cs then we can talk
about that.  If you think the cs2cs result is wrong, then that is another
ball of wax. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From c.krikke at hccnet.nl  Mon May 23 17:41:14 2005
From: c.krikke at hccnet.nl (Kees Krikke)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] bessel to wgs84?
References: <001601c55fd1$4854d590$6502a8c0@D24C071J>
	<931f8ea905052313331fa4c009@mail.gmail.com>
Message-ID: <001e01c55fe0$250b7cb0$6502a8c0@D24C071J>

Frank,

Thanks for your reply. cs2cs seems to give the correct result. If i 
understand correctly i should use:

gdalwarp -s_srs "+proj=stere +lat_0=52.15616055555555 
+lon_0=5.38763888888889 +k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel 
+units=m +towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491 
+no_defs" -t_srs  "proj=utm +zone=31 +datum=wgs84" input.tif output.tif.

..to get the same result as cs2cs gives. My first impression is that the 
gdalwarp output is not wgs84. I will test this tomorrow and let you know.



Regards,

Kees




----- Original Message ----- 
From: "Frank Warmerdam" <fwarmerdam@gmail.com>
To: "Kees Krikke" <kees.krikke@wanadoo.nl>
Cc: "gdal-dev" <gdal-dev@remotesensing.org>
Sent: Monday, May 23, 2005 10:33 PM
Subject: Re: [Gdal-dev] bessel to wgs84?


On 5/23/05, Kees Krikke <c.krikke@hccnet.nl> wrote:
>
> Hello,
>
> I'm trying to reproject some images from the Dutch RD coordinate system
> (epsg:28992) that is defined as:
>
> +proj=stere +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.999908
> +x_0=155000 +y_0=463000 +ellps=bessel +units=m  +no_defs
>
> to utm zone 31N /wgs84
> +proj=utm +zone=31 +datum=wgs84
>
> For the datum shift i guess i need to specify the +towgs argument also 
> with
> the source coordinate system.
> (+towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491)
>
> I verified these values by running proj.exe and the results are ok.

Kees,

Note that proj.exe ignores the +towgs84 specification.  If you want 
something
analygous to what gdalwarp will do, then you should use cs2cs.

eg.

cs2cs    +proj=stere +lat_0=52.15616055555555 +lon_0=5.38763888888889
+k=0.999908 +x_0=155000 +y_0=463000 +ellps=bessel +units=m 
+towgs=565.04,49.91,465.84,-0.409394387,0.35970519561,-1.868491 +no_defs 
+to +proj=utm +zone=31 +datum=wgs84


If gdalwarp isn't agreeing with the result of the cs2cs then we can talk
about that.  If you think the cs2cs result is wrong, then that is another
ball of wax.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From fwarmerdam at gmail.com  Mon May 23 18:20:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Frank on Vacation for 2 weeks
Message-ID: <931f8ea9050523152059393e02@mail.gmail.com>

Folks,

In the next couple hours I am leaving on vacation for two weeks.  
I will be completely off the net till June 7th.  

See you all then!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From tflynch at gmail.com  Mon May 23 22:05:16 2005
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Re: single ECW output from multiple input tiles
In-Reply-To: <s291ddf5.017@co5.dnr.state.mn.us>
References: <s291ddf5.017@co5.dnr.state.mn.us>
Message-ID: <c39b2a65050523190574359347@mail.gmail.com>

Hi Ken,

Your input statistics work out to a ~0.4 TB total input dataset. 
There's nothing intrinsic to the ECW compression libraries that
prevents a dataset of this size from being compressed.  For example,
ER Mapper 7.0, which is based on similar technology, is often used to
compress ECW mosaics from multi-TB input datasets on machines
comparable to yours.

We (ER Mapper) haven't tested gdal_translate with input datasets of
this size.  It's possible that there's some overhead introduced to
processing that prevents them from being successfully compressed for
the moment.  You could also be seeing a difficult to manifest bug in
GDAL, e.g. a minor resource leak that is not usually apparent.

On 5/24/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Hello Frank--
> 
> I tried again to use gdal_translate to create a large ECW output from
> input tiles described in a .vrt file, this time with a more appropriate
> pagefile config.  But again it failed after ~30 hours at 80% completion
> owing to a memory allocation error.  Here are the basics of my setup:
> 
> Win2k
> single 2.4 Ghz Pentium 4 processor
> 1.5 GB RAM
> 2.5 GB pagefile space
> ~600 input tiles in .vrt
> typical tile size 400 MB
> output image 307060 x 464371 pixels x 3 bands (lots of offsite)

-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From ealpert at digitalglobe.com  Tue May 24 13:43:26 2005
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Contouring that outputs polygons?
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB1603A8CBB8@COMAIL01.digitalglobe.com>



Been looking at gdal_contour a bit and noticed that it's output
shapetype is PolyLine. Does anyone know of any contouring utilities that
will output polygons? I'm not particular about what format but most
contouring apps I've found will render the polygons as images but not
export them.

Thanks,

-e

From MChapman at sanz.com  Tue May 24 14:04:54 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Contouring that outputs polygons?
Message-ID: <ED3A48B9840E594890A2BC172D11946502F9BE85@mailman.san.com>

Ethan,

It might be a hack, but, you could always modify the output by adding
the first point as the last and changing the geometry type to polygon.
Or, you could just mod the gdal_contour code to make a polygon instead
of a linestring.  

Just a thought.

Martin

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Ethan Alpert
Sent: Tuesday, May 24, 2005 11:43 AM
To: gdal-dev
Subject: [Gdal-dev] Contouring that outputs polygons?




Been looking at gdal_contour a bit and noticed that it's output
shapetype is PolyLine. Does anyone know of any contouring utilities that
will output polygons? I'm not particular about what format but most
contouring apps I've found will render the polygons as images but not
export them.

Thanks,

-e
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From ealpert at digitalglobe.com  Tue May 24 14:15:17 2005
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Contouring that outputs polygons?
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB1603A8CBB9@COMAIL01.digitalglobe.com>


Hmm...I'll look into that but I don't think the contour lines can be
closed. On potential problem are boundary conditions. There is no
guarentee given all topologies and subsets that lines can be closed into
polygons.

-e

-----Original Message-----
From: Chapman, Martin [mailto:MChapman@sanz.com] 
Sent: Tuesday, May 24, 2005 12:05 PM
To: Ethan Alpert; gdal-dev
Subject: RE: [Gdal-dev] Contouring that outputs polygons?


Ethan,

It might be a hack, but, you could always modify the output by adding
the first point as the last and changing the geometry type to polygon.
Or, you could just mod the gdal_contour code to make a polygon instead
of a linestring.  

Just a thought.

Martin

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Ethan Alpert
Sent: Tuesday, May 24, 2005 11:43 AM
To: gdal-dev
Subject: [Gdal-dev] Contouring that outputs polygons?




Been looking at gdal_contour a bit and noticed that it's output
shapetype is PolyLine. Does anyone know of any contouring utilities that
will output polygons? I'm not particular about what format but most
contouring apps I've found will render the polygons as images but not
export them.

Thanks,

-e
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From route at cae.com  Tue May 24 14:12:01 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] FYI : psd format
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D4DD@caemsx03.cae.ca>

Hi,
 
I've just found this page : 
Import Adobe Photoshop (.psd) images
http://www.codeproject.com/bitmap/MyPSD.asp

I thought someone may need something like that.

Stephane

PS : I didn't check the code to see if an integration in gdal is
possible

From asimpson at i-55.com  Tue May 24 15:33:34 2005
From: asimpson at i-55.com (Simpson)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Contouring that outputs polygons?
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB1603A8CBB9@COMAIL01.digitalglobe.com>
Message-ID: <NFBBKOADOLGDLPMAAHMDGEAHDEAA.asimpson@i-55.com>


I think the vertices of the linestring are drawn through the center of the
pixels on the perimeter of areas of like colored pixels.  In my limited
experience, if the area you are contouring is a straight line of 2 or more
pixels, it is difficult to convert to a polygon.  The buffer function
(available in Postgis) may do it, but I think you'd end up with a larger
representation of the original.

Drew.

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com]On Behalf Of Ethan Alpert
Sent: Tuesday, May 24, 2005 1:15 PM
To: Chapman, Martin; gdal-dev
Subject: RE: [Gdal-dev] Contouring that outputs polygons?



Hmm...I'll look into that but I don't think the contour lines can be
closed. On potential problem are boundary conditions. There is no
guarentee given all topologies and subsets that lines can be closed into
polygons.

-e

-----Original Message-----
From: Chapman, Martin [mailto:MChapman@sanz.com]
Sent: Tuesday, May 24, 2005 12:05 PM
To: Ethan Alpert; gdal-dev
Subject: RE: [Gdal-dev] Contouring that outputs polygons?


Ethan,

It might be a hack, but, you could always modify the output by adding
the first point as the last and changing the geometry type to polygon.
Or, you could just mod the gdal_contour code to make a polygon instead
of a linestring.

Just a thought.

Martin

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Ethan Alpert
Sent: Tuesday, May 24, 2005 11:43 AM
To: gdal-dev
Subject: [Gdal-dev] Contouring that outputs polygons?




Been looking at gdal_contour a bit and noticed that it's output
shapetype is PolyLine. Does anyone know of any contouring utilities that
will output polygons? I'm not particular about what format but most
contouring apps I've found will render the polygons as images but not
export them.

Thanks,

-e
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev



From kennedy at vrco.com  Wed May 25 00:25:11 2005
From: kennedy at vrco.com (Bobby Kennedy)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] NGA (aka NIMA) DNC Support?
Message-ID: <4293FE27.60808@vrco.com>


Quick question about supported formats for OGR...

Are there any plans to support the DNC (Digital Nautical Chart) vector 
format from NGA (NIMA)?

http://www.nga.mil/portal/site/dnc/

Thanks,

 Bobby

-- 
Bobby Kennedy
Software Engineer
VRCO, Inc.
757-456-5500


From dylan at iici.no-ip.org  Tue May 24 16:53:17 2005
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] convert tiff file with world file into geotiff
Message-ID: <200505241353.17358.dylan@iici.no-ip.org>

Hi,

I have a couple hundred tiff files that i would like to convert to geotiff. 

are there any simple ways to do this with gdal?

thanks!


-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From ed at topozone.com  Tue May 24 16:52:44 2005
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] convert tiff file with world file into geotiff
Message-ID: <4BF377919225F449BB097CB76FFE9BC8188594@ptolemy.topozone.com>

Dylan -

You don't need GDAL, as the geotifcp utility (from the geotiff
distribution) will do that for you.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 (978) 251-4242
Fax: +1 (978) 251-1396
ed@topozone.com 

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Dylan Beaudette
Sent: Tuesday, May 24, 2005 4:53 PM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] convert tiff file with world file into geotiff

Hi,

I have a couple hundred tiff files that i would like to convert to
geotiff. 

are there any simple ways to do this with gdal?

thanks!


--
Dylan Beaudette
Soils and Biogeochemistry Graduate Group University of California at
Davis
530.754.7341
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From hamish_nospam at yahoo.com  Tue May 24 23:16:22 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] NGA (aka NIMA) DNC Support?
In-Reply-To: <4293FE27.60808@vrco.com>
References: <4293FE27.60808@vrco.com>
Message-ID: <20050525151622.56643677.hamish_nospam@yahoo.com>

> Quick question about supported formats for OGR...
> 
> Are there any plans to support the DNC (Digital Nautical Chart) vector
> format from NGA (NIMA)?
> 
> http://www.nga.mil/portal/site/dnc/


Hmm, new to me. Interesting. I wonder what overlap there is with NOAA's
ENC data? Duplication of effort or repackaged in a new format??
Any more links?


>From the FAQ:
 "Any system or software application designed to read VPF structured
data can display the data."

 "DNC? is currently available to the public for US waters at this time."


So it appears OGR built with the OGDI driver is needed.

  http://xserve.flids.com/pipermail/gdal-dev/2004-November/007446.html

  http://ogdi.sourceforge.net/




For US waters, NOAA has its data available as public domain "ENC"
non-encoded S57 format:
  http://nauticalcharts.noaa.gov/MCD/enc/index.htm

in OGR:
  http://www.gdal.org/ogr/drv_s57.html

see also
  http://oceanservice.noaa.gov/dataexplorer/


quasi-NOAA raster charts (BSB format v3 & older) are supported by GDAL:
  http://www.gdal.org/frmt_various.html#BSB




Hamish

From BEN at Syncera-ITSolutions.NL  Fri May 27 10:03:29 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] transparent Geotiff?
Message-ID: <s29744d8.007@syncera.nl>

Hi list,

I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?

This is the output from gdalinfo:

C:\Programs\FWTools0.9.8>gdalinfo D:\wormerland\new\De_Poel.tif
Driver: GTiff/GeoTIFF
Size is 8677, 4811
Coordinate System is `'
GCP Projection =
GCP[  0]: Id=1, Info=
          (1457.5,1476.75) -> (114791,502268,0)
GCP[  1]: Id=2, Info=
          (672,4319.25) -> (114759,501887,0)
GCP[  2]: Id=3, Info=
          (2465.88,1705.75) -> (114921,502250,0)
GCP[  3]: Id=4, Info=
          (6097.5,1095.75) -> (115360,502420,0)
GCP[  4]: Id=5, Info=
          (3687.38,1458.75) -> (115069,502315,0)
Metadata:
  TIFFTAG_SOFTWARE=Oi/GFS, writer v00.06.02
  TIFFTAG_XRESOLUTION=200
  TIFFTAG_YRESOLUTION=200
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 4811.0)
Upper Right ( 8677.0,    0.0)
Lower Right ( 8677.0, 4811.0)
Center      ( 4338.5, 2405.5)
Band 1 Block=8677x1 Type=Byte, ColorInterp=Red
Band 2 Block=8677x1 Type=Byte, ColorInterp=Green
Band 3 Block=8677x1 Type=Byte, ColorInterp=Blue

Thanks in advance.

Best regards,
Bart

Bart van den Eijnden
Syncera-ITSolutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl


From eric.sokolowsky at gsfc.nasa.gov  Fri May 27 10:12:19 2005
From: eric.sokolowsky at gsfc.nasa.gov (Eric Sokolowsky)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] transparent Geotiff?
In-Reply-To: <s29744d8.007@syncera.nl>
References: <s29744d8.007@syncera.nl>
Message-ID: <Pine.LNX.4.61.0505271007320.7820@svsmail.gsfc.nasa.gov>

On Fri, 27 May 2005, Bart van den Eijnden wrote:

> Hi list,
>
> I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?

You can try using the gdalwarp tool to convert from your source image to
a new image with transparency with the -dstalpha switch.  You probably also
need -srcnodata 255 and -dstnodata 0.  The the help for gdalwarp for more info.

-- 
     ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center
    / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
   / __/ _/ / _/ 301.286.3751                  Mailstop 610.3 Bldg 28 Rm E102
  /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771

From BEN at Syncera-ITSolutions.NL  Fri May 27 10:21:21 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] transparent Geotiff?
Message-ID: <s2974903.029@syncera.nl>

Worked like a charm! Opens up transparent in OpenEV now so I am sure Mapserver will do the same. Thanks a lot!

D:\wormerland\new>gdalwarp -dstalpha -srcnodata 255 -dstnodata 0 de_poel.tif de_poel2.tif
Creating output file that is 9384P x 6340L.
ERROR 6: SetColorInterpretation() not supported for this dataset.
:0...10...20...30...40...50...60...70...80...90...100 - done.

Best regards,
Bart

Bart van den Eijnden
Syncera-ITSolutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl

>>> Eric Sokolowsky <eric.sokolowsky@gsfc.nasa.gov> 05/27/05 04:12pm >>>
On Fri, 27 May 2005, Bart van den Eijnden wrote:

> Hi list,
>
> I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?

You can try using the gdalwarp tool to convert from your source image to
a new image with transparency with the -dstalpha switch.  You probably also
need -srcnodata 255 and -dstnodata 0.  The the help for gdalwarp for more info.

-- 
     ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center
    / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
   / __/ _/ / _/ 301.286.3751                  Mailstop 610.3 Bldg 28 Rm E102
  /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771


From Ken.Boss at dnr.state.mn.us  Fri May 27 10:35:13 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] transparent Geotiff?
Message-ID: <s296ea51.024@co5.dnr.state.mn.us>

Bart--

If your goal is simply to set background to transparent in mapserver apps, you should be able to use the OFFSITE parameter in your layer definition to accomplish that - no conversion necessary.  Eg:,

  LAYER
    NAME shr30im3
    STATUS OFF
    DATA "data/gen/state/mn/shdr_clrim3.tif"
    TYPE RASTER
    OFFSITE 255 255 255
  END # shaded relief

HTH,

--Ken

>>> "Bart van den Eijnden" <BEN@Syncera-ITSolutions.NL> 05/27/05 9:21 AM >>>
Worked like a charm! Opens up transparent in OpenEV now so I am sure Mapserver will do the same. Thanks a lot!

D:\wormerland\new>gdalwarp -dstalpha -srcnodata 255 -dstnodata 0 de_poel.tif de_poel2.tif
Creating output file that is 9384P x 6340L.
ERROR 6: SetColorInterpretation() not supported for this dataset.
:0...10...20...30...40...50...60...70...80...90...100 - done.

Best regards,
Bart

Bart van den Eijnden
Syncera-ITSolutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl 

>>> Eric Sokolowsky <eric.sokolowsky@gsfc.nasa.gov> 05/27/05 04:12pm >>>
On Fri, 27 May 2005, Bart van den Eijnden wrote:

> Hi list,
>
> I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?

You can try using the gdalwarp tool to convert from your source image to
a new image with transparency with the -dstalpha switch.  You probably also
need -srcnodata 255 and -dstnodata 0.  The the help for gdalwarp for more info.

-- 
     ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center
    / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
   / __/ _/ / _/ 301.286.3751                  Mailstop 610.3 Bldg 28 Rm E102
  /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com 
http://xserve.flids.com/mailman/listinfo/gdal-dev


From Ken.Boss at dnr.state.mn.us  Fri May 27 11:13:47 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] transparent Geotiff?
Message-ID: <s296f34c.082@co5.dnr.state.mn.us>

Yes it will.

--Ken

>>> "Bart van den Eijnden" <BEN@Syncera-ITSolutions.NL> 05/27/05 9:35 AM >>>
Hi Ken,

I didn't know that. Interesting. Will this also work with a tile index?

Best regards,
Bart

Bart van den Eijnden
Syncera-ITSolutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl 

>>> "Ken Boss" <Ken.Boss@dnr.state.mn.us> 05/27/05 04:32pm >>>
Bart--

If your goal is simply to set background to transparent in mapserver apps, you should be able to use the OFFSITE parameter in your layer definition to accomplish that - no conversion necessary.  Eg:,

  LAYER
    NAME shr30im3
    STATUS OFF
    DATA "data/gen/state/mn/shdr_clrim3.tif"
    TYPE RASTER
    OFFSITE 255 255 255
  END # shaded relief

HTH,

--Ken

>>> "Bart van den Eijnden" <BEN@Syncera-ITSolutions.NL> 05/27/05 9:21 AM >>>
Worked like a charm! Opens up transparent in OpenEV now so I am sure Mapserver will do the same. Thanks a lot!

D:\wormerland\new>gdalwarp -dstalpha -srcnodata 255 -dstnodata 0 de_poel.tif de_poel2.tif
Creating output file that is 9384P x 6340L.
ERROR 6: SetColorInterpretation() not supported for this dataset.
:0...10...20...30...40...50...60...70...80...90...100 - done.

Best regards,
Bart

Bart van den Eijnden
Syncera-ITSolutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl 

>>> Eric Sokolowsky <eric.sokolowsky@gsfc.nasa.gov> 05/27/05 04:12pm >>>
On Fri, 27 May 2005, Bart van den Eijnden wrote:

> Hi list,
>
> I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?

You can try using the gdalwarp tool to convert from your source image to
a new image with transparency with the -dstalpha switch.  You probably also
need -srcnodata 255 and -dstnodata 0.  The the help for gdalwarp for more info.

-- 
     ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center
    / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
   / __/ _/ / _/ 301.286.3751                  Mailstop 610.3 Bldg 28 Rm E102
  /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com 
http://xserve.flids.com/mailman/listinfo/gdal-dev 




From dem at acri-st.fr  Fri May 27 11:43:51 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:38 2007
Subject: [Gdal-dev] Problem with Lambert Conformal Conic projection.
In-Reply-To: <931f8ea905052308317eeedfa6@mail.gmail.com>
References: <6.1.1.1.0.20050523130409.0239a5d0@pop3>
	<931f8ea905052308317eeedfa6@mail.gmail.com>
Message-ID: <6.1.1.1.0.20050527165521.023f3c18@pop3>


> > When I use gdal_translate with a Lambert Conformal Conic projection,
> > ProjFalseEastingGeokey and ProjFalseNorthingGeokey are not copied.
>
>I tried your example with GDAL CVS and the false easting and northing
>were not lost.  Are you using 1.2.6?  On what platform?  I don't
>*recall* fixing something like this recently, but I have a terrible memory
>so it is possible it was fixed since 1.2.6 was released.

Frank,

I've found this bug 
http://xserve.flids.com/pipermail/gdal-dev/2005-February/008116.html which 
seems to be related since I've made my test with an older gdalinfo.
I've tried with GDAL 1.2.6, it seems work, but I've some questions :

LISTGEO INITIAL FILE :
==============================
...
       GeogGeodeticDatumGeoKey (Short,1): User-Defined
       GeogPrimeMeridianGeoKey (Short,1): PM_Greenwich
       GeogLinearUnitsGeoKey (Short,1): Linear_Meter
       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
       GeogEllipsoidGeoKey (Short,1): Ellipse_GRS_1980
       ProjectedCSTypeGeoKey (Short,1): User-Defined
       ProjectionGeoKey (Short,1): User-Defined
       ProjCoordTransGeoKey (Short,1): CT_LambertConfConic_2SP
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       ProjStdParallel1GeoKey (Double,1): 44
       ProjStdParallel2GeoKey (Double,1): 49
       ProjNatOriginLongGeoKey (Double,1): 3
       ProjNatOriginLatGeoKey (Double,1): 46.5
       ProjFalseEastingGeoKey (Double,1): 700000
       ProjFalseNorthingGeoKey (Double,1): 6600000
       End_Of_Keys.
    End_Of_Geotiff.

Projection Method: CT_LambertConfConic_2SP
    ProjFalseOriginLatGeoKey: 46.500000 ( 46d30' 0.00"N)
    ProjFalseOriginLongGeoKey: 3.000000 (  3d 0' 0.00"E)
    ProjStdParallel1GeoKey: 44.000000 ( 44d 0' 0.00"N)
    ProjStdParallel2GeoKey: 49.000000 ( 49d 0' 0.00"N)
    ProjFalseEastingGeoKey: 700000.000000 m
    ProjFalseNorthingGeoKey: 6600000.000000 m
==============================

LISTGEO AFTER GDAL_TRANSLATE :
==============================
       GeogGeodeticDatumGeoKey (Short,1): User-Defined
       GeogAngularUnitsGeoKey (Short,1): Angular_Degree
       GeogEllipsoidGeoKey (Short,1): Ellipse_GRS_1980
       ProjectedCSTypeGeoKey (Short,1): User-Defined
       ProjectionGeoKey (Short,1): User-Defined
       ProjCoordTransGeoKey (Short,1): CT_LambertConfConic_2SP
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       ProjStdParallel1GeoKey (Double,1): 44
       ProjStdParallel2GeoKey (Double,1): 49
       ProjFalseOriginLongGeoKey (Double,1): 3
       ProjFalseOriginLatGeoKey (Double,1): 46.5
       ProjFalseOriginEastingGeoKey (Double,1): 700000
       ProjFalseOriginNorthingGeoKey (Double,1): 6600000
       End_Of_Keys.
    End_Of_Geotiff.

Projection Method: CT_LambertConfConic_2SP
    ProjFalseOriginLatGeoKey: 46.500000 ( 46d30' 0.00"N)
    ProjFalseOriginLongGeoKey: 3.000000 (  3d 0' 0.00"E)
    ProjStdParallel1GeoKey: 44.000000 ( 44d 0' 0.00"N)
    ProjStdParallel2GeoKey: 49.000000 ( 49d 0' 0.00"N)
    ProjFalseEastingGeoKey: 0.000000 m
    ProjFalseNorthingGeoKey: 0.000000 m
==============================

DIFF :
==============================
23,24d20
<       GeogPrimeMeridianGeoKey (Short,1): PM_Greenwich
<       GeogLinearUnitsGeoKey (Short,1): Linear_Meter
33,36c29,32
<       ProjNatOriginLongGeoKey (Double,1): 3
<       ProjNatOriginLatGeoKey (Double,1): 46.5
<       ProjFalseEastingGeoKey (Double,1): 700000
<       ProjFalseNorthingGeoKey (Double,1): 6600000
---
 >       ProjFalseOriginLongGeoKey (Double,1): 3
 >       ProjFalseOriginLatGeoKey (Double,1): 46.5
 >       ProjFalseOriginEastingGeoKey (Double,1): 700000
 >       ProjFalseOriginNorthingGeoKey (Double,1): 6600000
45,46c41,42
<    ProjFalseEastingGeoKey: 700000.000000 m
<    ProjFalseNorthingGeoKey: 6600000.000000 m
---
 >    ProjFalseEastingGeoKey: 0.000000 m
 >    ProjFalseNorthingGeoKey: 0.000000 m
48d43
< Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
==============================


Some GeoTIFF Tags are modified : why GDAL use :
 >       ProjFalseOriginLongGeoKey (Double,1): 3
 >       ProjFalseOriginLatGeoKey (Double,1): 46.5
 >       ProjFalseOriginEastingGeoKey (Double,1): 700000
 >       ProjFalseOriginNorthingGeoKey (Double,1): 6600000
instead
<       ProjNatOriginLongGeoKey (Double,1): 3
<       ProjNatOriginLatGeoKey (Double,1): 46.5
<       ProjFalseEastingGeoKey (Double,1): 700000
<       ProjFalseNorthingGeoKey (Double,1): 6600000
?

I see in the GeoTIFF specifications that ProjFalseOriginEastingGeoKey is 
different than ProjFalseEastingGeoKey :
"Gives the easting coordinate of the false origin. This is NOT the False 
Easting, which is the easting attached to the Natural origin."
so this isn't coherent ?

In the Lambert Conic Conformal (2SP) specifications 
(http://www.remotesensing.org/geotiff/proj_list/lambert_conic_conformal_2sp.html) 
I understand I should use the ProjFalseOriginXXX keys, but in the GeoTIFF 
web site example for this projection 
(http://www.remotesensing.org/geotiff/spec/geotiff3.html#3.1.3.) the other 
keys are used.....

Many thanks in advance for help,
Best Regards,


Julien


From dylan at iici.no-ip.org  Fri May 27 15:03:38 2005
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] convert tiff file with world file into geotiff [solved]
In-Reply-To: <1fca43f1fc854d.1fc854d1fca43f@shaw.ca>
References: <1fca43f1fc854d.1fc854d1fca43f@shaw.ca>
Message-ID: <200505271203.38209.dylan@iici.no-ip.org>

Tyler and others who replied,

Thanks for the very helpful tips on converting regular tiffs -> GeoTiff.

At the time I was missing the projection parameters for the data in question, 
and thus could not really proceed any furthere. After receiving the proj 
parameters (CA SPC: yuck!) I was able to re-project and convert all 600 tiff 
files.

Thanks!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

On Friday 27 May 2005 07:06 am, Tyler Mitchell wrote:
> Hi Dylan, did you figure something out re: your question?  I think you can
> use gdal_translate command line tool to convert a tiff with a world file
> into a geotiff - it should be the default output format in.  Or do you need
> to do the georeferencing from scratch too?  I've used gdal_translate's -gcp
> option quite a bit to assign georeferencing control points.  Let me know if
> you need more help.
>
> Tyler
>
> ----- Original Message -----
> From: Dylan Beaudette <dylan@iici.no-ip.org>
> Date: Tuesday, May 24, 2005 1:53 pm
> Subject: [Gdal-dev] convert tiff file with world file into geotiff
>
> > Hi,
> >
> > I have a couple hundred tiff files that i would like to convert to
> > geotiff.
> >
> > are there any simple ways to do this with gdal?
> >
> > thanks!
> >
> >

From cgn at globexplorer.com  Fri May 27 16:04:36 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Solaris/GDAL/Kakadu compile wierdness
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCD0B@loki.wc.globexplorer.net>

Hmmm - (apologies if this has been answered before..) 
when I try to use the resultant libgdal in a subsequent build of GRASS, getting strange ld warnings and unresolved kdu lib issues...

thanks in advance for any suggestions
Chris
---------------------------------------
bigsur.globexplorer.com-> pwd
/export/home/webdemo/src/grass-6.0.0/raster/r.in.gdal

bigsur.globexplorer.com-> make
gcc  -L/export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib        -DPACKAGE=\""grassmods"\" -o /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal OBJ.sparc-sun-solaris2.9/main.o -lgrass_gproj -lproj  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gis -lgrass_datetime -lnsl    -lz  -lsocket  -lgrass_I -lgrass_vask -lcurses  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gmath     -lm  -lnsl    -lz
ld: warning: file /usr/local/lib/libgdal.so: attempted multiple inclusion of file
ld: warning: symbol `sigfpe' has differing types:
        (file /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so type=OBJT; file /usr/lib/libc.so type=FUNC);
        /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so definition taken
Undefined                       first referenced
 symbol                             in file
jp2_dimensions::init(siz_params*, bool) /usr/local/lib/libgdal.so
kdu_roi_rect::kdu_roi_rect[in-charge](kdu_codestream, kdu_dims)/usr/local/lib/libgdal.so
jp2_source::access_palette()        /usr/local/lib/libgdal.so
vtable for jp2_input_box            /usr/local/lib/libgdal.so


:

...
jp2_channels::set_opacity_mapping(int, int, int, int)/usr/local/lib/libgdal.so
jp2_channels::get_opacity_mapping(int, int&, int&, int&)/usr/local/lib/libgdal.so
jp2_colour::init(jp2_colour_space)      /usr/local/lib/libgdal.so
....

going back to kakadu itself, 

bigsur.globexplorer.com# ls -l libkd*
-rw-r--r--   1 root     other     830268 May 20 22:17 libkdu.a
lrwxrwxrwx   1 root     other         29 May 24 21:43 libkdu.so -> /usr/local/lib/libkdu_v45R.so
-rwxr-xr-x   1 root     other     662264 May 25 12:13 libkdu_v45R.so
bigsur.globexplorer.com# nm libkdu_v45R.so | grep jp2_channels
bigsur.globexplorer.com# nm libkdu.a | grep jp2_channels
bigsur.globexplorer.com#



From cgn at globexplorer.com  Sat May 28 16:57:31 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] more Solaris/GDAL/Kakadu compile wierdness
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCD14@loki.wc.globexplorer.net>

I had the same unresolved issues with unresolved jp2_* with mapserver, so I just hardcoded in explicit reference to the Kakadu apps/make/jp2.o and roi_sources.o into the compile line.

now on safari into very wierd libstdc++ errs....

Chris
--------------------------------

bigsur.globexplorer.com# make
gcc  -L/export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib        -DPACKAGE=\""grassmods"\" -o /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal OBJ.sparc-sun-solaris2.9/main.o -lgrass_gproj -lproj  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gis -lgrass_datetime -lnsl    -lz  -lsocket  -lgrass_I -lgrass_vask -lcurses  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gmath    /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o -lm  -lnsl    -lz
ld: warning: file /usr/local/lib/libgdal.so: attempted multiple inclusion of file
ld: warning: symbol `sigfpe' has differing types:
        (file /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so type=OBJT; file /usr/lib/libc.so type=FUNC);
        /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so definition taken
Undefined                       first referenced
 symbol                             in file
std::basic_filebuf<char, std::char_traits<char> >::close()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::ios_base::ios_base[not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)

std::ios_base::~ios_base [not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator new[](unsigned)            /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator new(unsigned)              /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for __cxxabiv1::__si_class_type_info/export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_ifstream<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
VTT for std::basic_ifstream<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_streambuf<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::get(char*, int, char)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::read(char*, int)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_filebuf<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::widen(char) const/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__cxa_call_unexpected               /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator delete[](void*)            /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator delete(void*)              /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_filebuf<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::putback(char)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::operator>>(int&)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_streambuf<char, std::char_traits<char> >::~basic_streambuf [not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::__basic_file<char>::~__basic_file [in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::clear(std::_Ios_Iostate)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for __cxxabiv1::__class_type_info/export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::__basic_file<char>::is_open() const/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_ios<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__gxx_personality_v0                /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_filebuf<char, std::char_traits<char> >::basic_filebuf[in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__cxa_pure_virtual                  /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::init(std::basic_streambuf<char, std::char_traits<char> >*)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::locale::~locale [in-charge]()  /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::get(char&)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
ld: fatal: Symbol referencing errors. No output written to /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal
collect2: ld returned 1 exit status
make: *** [/export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal] Error 1
bigsur.globexplorer.com#





From cgn at globexplorer.com  Sat May 28 18:31:04 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] RE: more Solaris/GDAL/Kakadu compile wierdness
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCD17@loki.wc.globexplorer.net>

manually added -lstdc++ , and references to libpq, and things build...

hopefully this can be of use to those more familiar with the make structure...

Chris

-----Original Message-----
From:	Chris G. Nicholas
Sent:	Sat 5/28/2005 1:57 PM
To:	gdal-dev@xserve.flids.com
Cc:	grass5@grass.itc.it
Subject:	more Solaris/GDAL/Kakadu compile wierdness
I had the same unresolved issues with unresolved jp2_* with mapserver, so I just hardcoded in explicit reference to the Kakadu apps/make/jp2.o and roi_sources.o into the compile line.

now on safari into very wierd libstdc++ errs....

Chris
--------------------------------

bigsur.globexplorer.com# make
gcc  -L/export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib        -DPACKAGE=\""grassmods"\" -o /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal OBJ.sparc-sun-solaris2.9/main.o -lgrass_gproj -lproj  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gis -lgrass_datetime -lnsl    -lz  -lsocket  -lgrass_I -lgrass_vask -lcurses  /usr/local/lib/libgdal.so   -L/usr/local/lib -lgeos -L/usr/local/hdf/lib -ljpeg -ltiff -lpng -lz -lm -ldl -lkdu -lmfhdf -ldf -ludport -lnsl -L/usr/local/pgsql/lib -lpq -lgrass_gmath    /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o -lm  -lnsl    -lz
ld: warning: file /usr/local/lib/libgdal.so: attempted multiple inclusion of file
ld: warning: symbol `sigfpe' has differing types:
        (file /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so type=OBJT; file /usr/lib/libc.so type=FUNC);
        /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/lib/libgrass_I.so definition taken
Undefined                       first referenced
 symbol                             in file
std::basic_filebuf<char, std::char_traits<char> >::close()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::ios_base::ios_base[not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)

std::ios_base::~ios_base [not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator new[](unsigned)            /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator new(unsigned)              /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for __cxxabiv1::__si_class_type_info/export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_ifstream<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
VTT for std::basic_ifstream<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_streambuf<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::get(char*, int, char)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::read(char*, int)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_filebuf<char, std::char_traits<char> >::open(char const*, std::_Ios_Openmode)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::widen(char) const/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__cxa_call_unexpected               /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator delete[](void*)            /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
operator delete(void*)              /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_filebuf<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::putback(char)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::operator>>(int&)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_streambuf<char, std::char_traits<char> >::~basic_streambuf [not-in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::__basic_file<char>::~__basic_file [in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::clear(std::_Ios_Iostate)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for __cxxabiv1::__class_type_info/export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::__basic_file<char>::is_open() const/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
vtable for std::basic_ios<char, std::char_traits<char> >/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__gxx_personality_v0                /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_filebuf<char, std::char_traits<char> >::basic_filebuf[in-charge]()/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
__cxa_pure_virtual                  /export/home/webdemo/src/gdal-1.2.6/frmts/o/jp2.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_ios<char, std::char_traits<char> >::init(std::basic_streambuf<char, std::char_traits<char> >*)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::locale::~locale [in-charge]()  /export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
std::basic_istream<char, std::char_traits<char> >::get(char&)/export/home/webdemo/src/gdal-1.2.6/frmts/o/roi_sources.o  (symbol belongs to implicit dependency /usr/local/lib/libstdc++.so.5)
ld: fatal: Symbol referencing errors. No output written to /export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal
collect2: ld returned 1 exit status
make: *** [/export/home/webdemo/src/grass-6.0.0/dist.sparc-sun-solaris2.9/bin/r.in.gdal] Error 1
bigsur.globexplorer.com#







From mateusz at loskot.net  Mon May 30 05:21:01 2005
From: mateusz at loskot.net (=?ISO-8859-2?Q?Mateusz_=A3oskot?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Building GDAL with eVC++ 4.0
Message-ID: <d7elp1$knm$1@sea.gmane.org>

Hi,

I'm trying to build (and port if necessary) GDAL
using Microsoft eMbedded Visual C++ 4.0 compiler.
It is a kind of better Visual C++ 6.0 compiler, so it
supports some of new C++ features.
So, I'd like to ask a few question:
1)Has anybody built GDAL with eVC++ 4.0?
2)Is there any documentation for CPL?

Greets
-- 
Mateusz ?oskot
mateusz at loskot dot net


From sevilla_lui at gva.es  Mon May 30 06:58:39 2005
From: sevilla_lui at gva.es (Luis W. Sevilla)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] transparent Geotiff?
In-Reply-To: <s296ea51.024@co5.dnr.state.mn.us>
References: <s296ea51.024@co5.dnr.state.mn.us>
Message-ID: <429AF1DF.6060400@gva.es>

We've tryed to configure a mapserver serving WCS layers, but is seems to 
ignore that OFFSITE parameter
it's there anything more to do ?

    thanks in advance

Ken Boss wrote:

>Bart--
>
>If your goal is simply to set background to transparent in mapserver apps, you should be able to use the OFFSITE parameter in your layer definition to accomplish that - no conversion necessary.  Eg:,
>
>  LAYER
>    NAME shr30im3
>    STATUS OFF
>    DATA "data/gen/state/mn/shdr_clrim3.tif"
>    TYPE RASTER
>    OFFSITE 255 255 255
>  END # shaded relief
>
>HTH,
>
>--Ken
>
>  
>
>>>>"Bart van den Eijnden" <BEN@Syncera-ITSolutions.NL> 05/27/05 9:21 AM >>>
>>>>        
>>>>
>Worked like a charm! Opens up transparent in OpenEV now so I am sure Mapserver will do the same. Thanks a lot!
>
>D:\wormerland\new>gdalwarp -dstalpha -srcnodata 255 -dstnodata 0 de_poel.tif de_poel2.tif
>Creating output file that is 9384P x 6340L.
>ERROR 6: SetColorInterpretation() not supported for this dataset.
>:0...10...20...30...40...50...60...70...80...90...100 - done.
>
>Best regards,
>Bart
>
>Bart van den Eijnden
>Syncera-ITSolutions
>Postbus 270
>2600 AG  DELFT
>
>tel.nr.: 015-7512436
>email: BEN@Syncera-ITSolutions.nl 
>
>  
>
>>>>Eric Sokolowsky <eric.sokolowsky@gsfc.nasa.gov> 05/27/05 04:12pm >>>
>>>>        
>>>>
>On Fri, 27 May 2005, Bart van den Eijnden wrote:
>
>  
>
>>Hi list,
>>
>>I have a lot of geotiff files which have a white background. Because many of the tiffs overlap, I need a way to create transparent tiffs (set white as the transparency color). Does anybody know how to do this?
>>    
>>
>
>You can try using the gdalwarp tool to convert from your source image to
>a new image with transparency with the -dstalpha switch.  You probably also
>need -srcnodata 255 and -dstnodata 0.  The the help for gdalwarp for more info.
>
>  
>


-- 
  Luis W. Sevilla
  Equipo de desarrollo gvSIG
  Conselleria de Infraestructuras y Transporte
  Generalitat Valenciana
  Valencia - Spain
  http://www.gvsig.gva.es



From mateusz at loskot.net  Mon May 30 06:03:02 2005
From: mateusz at loskot.net (=?ISO-8859-2?Q?Mateusz_=A3oskot?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] How to separate OGR from GDAL
Message-ID: <d7eo7u$s5i$1@sea.gmane.org>

Hi,

Could anyone advise me how to separate OGR from GDAL
in order to get only OGR functionality?
What components do I need from GDAL?
Is it possible?

Cheers

-- 
Mateusz ?oskot
mateusz at loskot dot net


From lists at b-open-solutions.it  Mon May 30 06:50:17 2005
From: lists at b-open-solutions.it (Alessandro Amici)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] How to separate OGR from GDAL
In-Reply-To: <d7eo7u$s5i$1@sea.gmane.org>
References: <d7eo7u$s5i$1@sea.gmane.org>
Message-ID: <200505301250.18167.lists@b-open-solutions.it>


Mateusz,

Alle 12:03, luned? 30 maggio 2005, Mateusz ?oskot ha scritto:
> Could anyone advise me how to separate OGR from GDAL
> in order to get only OGR functionality?
> What components do I need from GDAL?
> Is it possible?

as far as i know it is not intended to be possible (at least as a 
configuration option).

you may hand-modify the build system in order to only build ogr, but 
there are a number of cross-dependencies (at least there were last time 
i checked) between code inside gdal/ogr and code inside gdal/frmts. it 
is not trivial (or at least it was not).

if you only need ogr functionality and have size constrains i would 
advise you to try and disable some gdal drivers first.

cheers,
alessandro

-- 
B-Open Solutions srl - http://www.bopen.it/
Sicurezza informatica e software Open Source su:
-- http://www.bopen.it/newsletter/200501/ --

From lists at b-open-solutions.it  Mon May 30 06:50:17 2005
From: lists at b-open-solutions.it (Alessandro Amici)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] How to separate OGR from GDAL
In-Reply-To: <d7eo7u$s5i$1@sea.gmane.org>
References: <d7eo7u$s5i$1@sea.gmane.org>
Message-ID: <200505301250.18167.lists@b-open-solutions.it>


Mateusz,

Alle 12:03, luned? 30 maggio 2005, Mateusz ?oskot ha scritto:
> Could anyone advise me how to separate OGR from GDAL
> in order to get only OGR functionality?
> What components do I need from GDAL?
> Is it possible?

as far as i know it is not intended to be possible (at least as a 
configuration option).

you may hand-modify the build system in order to only build ogr, but 
there are a number of cross-dependencies (at least there were last time 
i checked) between code inside gdal/ogr and code inside gdal/frmts. it 
is not trivial (or at least it was not).

if you only need ogr functionality and have size constrains i would 
advise you to try and disable some gdal drivers first.

cheers,
alessandro

-- 
B-Open Solutions srl - http://www.bopen.it/
Sicurezza informatica e software Open Source su:
-- http://www.bopen.it/newsletter/200501/ --

From mbrudka at aster.pl  Mon May 30 13:18:14 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Multi-threading Support
In-Reply-To: <931f8ea90505230903503c2b8e@mail.gmail.com>
References: <931f8ea90505230903503c2b8e@mail.gmail.com>
Message-ID: <429B4AD6.8010904@aster.pl>

Frank Warmerdam wrote:

> Folks,
>
> I have committed a variety of changes to GDAL in support of thread
> safety.

Nice! Thanks!

In our company we use gdal modified to be reentrant
(unix,windows) when any PROJ.4 related methods are called
(OGRSpatialReference and OGRCoordinateTransformation).
In general we introduced global [ :-( ]  PROJ.4 mutex locked
every time PROJ.4 functions are called. This is not a very
efficient, but probably the only option.. PROJ.4 is
a computational library and should rather not be polluted
by a portable thread specific storage code related with
errno. On the other side any interface changes in PROJ.4,
specifically changes in error reporting,  are almost impossible
now (I read this on proj.4 related discussion list). Hence one has
to synchronize PROJ.4 calls externally.

I have also created CPL-based mutex guards to make the code
more safe. If anyone in gdal-users is interested in these
changes I can make them public.

BTW. Gdal does not have to be a thread safe library. The most
important feature of  GDAL in multithread applications is
the reentrancy. Moreoever, the statefull interfaces like OGRLayer
or OGRRasterband are not very well suited to be internally thread
safe, though they should be serialized when accessing low
level datasources. At least, it would be nice to have a mutexes
(avalaible via guard only!) for GDAL/OGR datasources. I can discuss
these ideas (and the other) related with reentrency or thread safety
in more details if anyone on gdal-dev is interested.

Marek Brudka


From dron at ak4719.spb.edu  Mon May 30 14:14:38 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Building GDAL with eVC++ 4.0
In-Reply-To: <d7elp1$knm$1@sea.gmane.org>
References: <d7elp1$knm$1@sea.gmane.org>
Message-ID: <20050530181438.GB12277@ak4719.spb.edu>

On Mon, May 30, 2005 at 11:21:01AM +0200, Mateusz ?oskot wrote:
> I'm trying to build (and port if necessary) GDAL using Microsoft
> eMbedded Visual C++ 4.0 compiler. It is a kind of better Visual C++
> 6.0 compiler, so it supports some of new C++ features. So, I'd like to
> ask a few question:
> 1)Has anybody built GDAL with eVC++ 4.0?
> 2)Is there any documentation for CPL?

Mateusz,

It is not easy task to compile GDAL with the Embedded VC (but it is
possible, I am sure). The main problem is that we do not have a way to
automatically determine the embedded modification of the VC compiler. Of
course, we can use a special option in the nmake.opt file, but this is
not implemented yet. The main work is in proper header guards placement.

The problem is not in GDAL only, all supporting libraries (libtiff,
libjpeg, libpng, zlib, proj4) should be revised too.

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From mateusz at loskot.net  Mon May 30 16:54:25 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <200505301250.18167.lists@b-open-solutions.it>
References: <d7eo7u$s5i$1@sea.gmane.org>
	<200505301250.18167.lists@b-open-solutions.it>
Message-ID: <d7fud2$j0h$1@sea.gmane.org>

Alessandro Amici napisa?(a):
> Alle 12:03, luned? 30 maggio 2005, Mateusz ?oskot ha scritto:
> 
>>Could anyone advise me how to separate OGR from GDAL
>>in order to get only OGR functionality?
>>What components do I need from GDAL?
>>Is it possible?
> 
> as far as i know it is not intended to be possible (at least as a 
> configuration option).
> [...]
> 
> if you only need ogr functionality and have size constrains i would 
> advise you to try and disable some gdal drivers first.

I'll try it. But there isn't any important size constraint of the 
library, of course it is recommended to have small DLL, but it is not 
required.
I need only OGR functionality on Windows CE (Mobile) so it could be 
easier to port the code when I have OGR sources separated.
But I understand it isn't easy job.
Greets

-- 
Mateusz ?oskot
mateusz at loskot dot net


From mateusz at loskot.net  Mon May 30 17:02:55 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <20050530181438.GB12277@ak4719.spb.edu>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
Message-ID: <d7fut0$kbj$1@sea.gmane.org>

Andrey Kiselev napisa?(a):
> On Mon, May 30, 2005 at 11:21:01AM +0200, Mateusz ?oskot wrote:
> 
>>I'm trying to build (and port if necessary) GDAL using Microsoft
>>eMbedded Visual C++ 4.0 compiler. It is a kind of better Visual C++
>>6.0 compiler, so it supports some of new C++ features. So, I'd like to
>>ask a few question:
>>1)Has anybody built GDAL with eVC++ 4.0?
>>2)Is there any documentation for CPL?
> 
> 
> Mateusz,
> 
> It is not easy task to compile GDAL with the Embedded VC (but it is
> possible, I am sure). 

I belive it is possible :-)

 > The main problem is that we do not have a way to
> automatically determine the embedded modification of the VC compiler. Of
> course, we can use a special option in the nmake.opt file, but this is
> not implemented yet. The main work is in proper header guards placement.

I don't think that main problem is with the compiler determination.
For now, I see there are some libraries/files missed in C standard 
library used by eVC++. But it is also possible to work wih this.

eVC++ IDE prvides similar BAT file as "big" Visual Studi to reconfigure
build environment (INCLUDE/LINK path, etc.)

What do you mean as "heade guards placement"?

> The problem is not in GDAL only, all supporting libraries (libtiff,
> libjpeg, libpng, zlib, proj4) should be revised too.

Yes, you are right. But i do not want to use/have libtiff/libjpeg/libpng
in my GDAL (OGR) for Windows CE.
I do only need Vector support.
But proj4 is needed.

Greets


-- 
Mateusz ?oskot
mateusz at loskot dot net


From paul at toolscenter.org  Mon May 30 21:11:07 2005
From: paul at toolscenter.org (Paul Selormey)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <d7fud2$j0h$1@sea.gmane.org>
Message-ID: <20050531011118.117BF25BFD59@xserve.flids.com>

Why not simply write your own OGR. Most of the parts of the OGR
like shapelib, mitab, Proj4, GEOS etc are available as standalone library.

For a typical WinCE application, you most likely do not wish to support
all the data sources in OGR.

Best regards,
Paul.
 

> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com 
> [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Mateusz Loskot
> Sent: Tuesday, May 31, 2005 5:54 AM
> To: gdal-dev@remotesensing.org
> Subject: [Gdal-dev] Re: How to separate OGR from GDAL
> 
> Alessandro Amici napisal(a):
> > Alle 12:03, luned? 30 maggio 2005, Mateusz Loskot ha scritto:
> > 
> >>Could anyone advise me how to separate OGR from GDAL in 
> order to get 
> >>only OGR functionality?
> >>What components do I need from GDAL?
> >>Is it possible?
> > 
> > as far as i know it is not intended to be possible (at least as a 
> > configuration option).
> > [...]
> > 
> > if you only need ogr functionality and have size constrains i would 
> > advise you to try and disable some gdal drivers first.
> 
> I'll try it. But there isn't any important size constraint of 
> the library, of course it is recommended to have small DLL, 
> but it is not required.
> I need only OGR functionality on Windows CE (Mobile) so it 
> could be easier to port the code when I have OGR sources separated.
> But I understand it isn't easy job.
> Greets
> 
> --
> Mateusz Loskot
> mateusz at loskot dot net
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 



From dmorissette at dmsolutions.ca  Mon May 30 21:42:39 2005
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <d7fud2$j0h$1@sea.gmane.org>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>
	<d7fud2$j0h$1@sea.gmane.org>
Message-ID: <429BC10F.7050900@dmsolutions.ca>

Mateusz ?oskot wrote:
> 
> I'll try it. But there isn't any important size constraint of the 
> library, of course it is recommended to have small DLL, but it is not 
> required.
> I need only OGR functionality on Windows CE (Mobile) so it could be 
> easier to port the code when I have OGR sources separated.
> But I understand it isn't easy job.
> Greets
> 

Mateusz,

Perhaps a starting point could be the MITAB library. It comes with a 
standalone/stripped down copy of OGR that contains all the geometry, 
feature, layer, datasource, SRS, etc... classes, as well as the CPL 
(port) stuff. You may not need much more to be able to have a working 
OGR with your selected drivers outside of the GDAL environment.

The CVS version of MITAB (not released yet) has been updated from the 
latest OGR source about 2 weeks ago. You could get it through anonymous 
CVS by checking out module "mitab" with the following CVSROOT:
  CVSROOT=:pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot
There is no password for anonymous CVS access, i.e. just hit return with 
an empty password when doing a 'cvs login'

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From dron at ak4719.spb.edu  Tue May 31 01:23:16 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <d7fut0$kbj$1@sea.gmane.org>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
	<d7fut0$kbj$1@sea.gmane.org>
Message-ID: <20050531052316.GA8116@ak4719.spb.edu>

On Mon, May 30, 2005 at 11:02:55PM +0200, Mateusz ?oskot wrote:
> I don't think that main problem is with the compiler determination.
> For now, I see there are some libraries/files missed in C standard
> library used by eVC++. But it is also possible to work wih this.
> 
> eVC++ IDE prvides similar BAT file as "big" Visual Studi to
> reconfigure build environment (INCLUDE/LINK path, etc.)
> 
> What do you mean as "heade guards placement"?

Guards are the special preprocessor definitions used to enable/disable
compilation of the various program blocks. For example, look at the
cpl_port.h module, it contains constructions like

#ifdef HAVE_LOCALE_H
#  include <locale.h>
#endif

HAVE_LOCALE_H guard is defined in the cpl_config.h file. We can define a
symbol for Embedded VC in nmake.opt and use it as a guard in the various
modules to include the right headers. The first candidates are
cpl_port.h and cpl_vsisimple.cpp. That symbol will be manually enabled
in nmake.opt when appropriate.

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From mateusz at loskot.net  Tue May 31 05:48:41 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <20050531052316.GA8116@ak4719.spb.edu>
References: <d7elp1$knm$1@sea.gmane.org>	<20050530181438.GB12277@ak4719.spb.edu>	<d7fut0$kbj$1@sea.gmane.org>
	<20050531052316.GA8116@ak4719.spb.edu>
Message-ID: <429C32F9.6070300@loskot.net>

Andrey Kiselev napisa?(a):
>> On Mon, May 30, 2005 at 11:02:55PM +0200, Mateusz ?oskot wrote:
>>
>
>>>>I don't think that main problem is with the compiler determination.
>>>>For now, I see there are some libraries/files missed in C standard
>>>>library used by eVC++. But it is also possible to work wih this.
>>>>
>>>>eVC++ IDE prvides similar BAT file as "big" Visual Studi to
>>>>reconfigure build environment (INCLUDE/LINK path, etc.)
>>>>
>>>>What do you mean as "heade guards placement"?
>
>>
>> Guards are the special preprocessor definitions used to enable/disable
>> compilation of the various program blocks. For example, look at the
>> cpl_port.h module, it contains constructions like
>>
>> #ifdef HAVE_LOCALE_H
>> #  include <locale.h>
>> #endif


Certainly, I know that technique but the name "guard" strange for me.


>> HAVE_LOCALE_H guard is defined in the cpl_config.h file.
> We can define a
>> symbol for Embedded VC in nmake.opt and use it
> as a guard in the various
>> modules to include the right headers. The first candidates are
>> cpl_port.h and cpl_vsisimple.cpp.
>> That symbol will be manually enabled
>> in nmake.opt when appropriate.


evc++ supports nmake build system. Certainly, there are some features
in "big" Windows (and "big" namke system) not supported byt Pocket PC
SDK. I've created makefile.evc and I'm trying to go with this but it is
not enough solution. So, I will try to work with nmake.opt and other
files you are talking about. Today I will dig into this job.

Thank you for your help.

-- 
Mateusz ?oskot, mateusz (at) loskot (dot) net
Registered Linux User #220771, Debian (Sarge)

From mateusz at loskot.net  Tue May 31 07:22:17 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <B84102FA2ECDD911A1A50800364468031B7492@orion.geodis.cz>
References: <B84102FA2ECDD911A1A50800364468031B7492@orion.geodis.cz>
Message-ID: <429C48E9.8080604@loskot.net>

Kana, David napisa?(a):
> Hi Mateusz, what kind of vector support do you need? I have ported GDAL to
> eVC++ 3.0 with Gtiff and Jpeg including necessary OGR support. If you are
> interested i can send you eVC++ project.
> 

Hi David,

Some time ago, I started with my own Open GIS geometry
implementation and now I'm going to go on with my project
and implement new features.
Some days ago I found OGR as a very nice tool and
I tought I could replace my own OGC geometries with
OGR, then I could also get SRS support, etc.

So, the first requirement is to provide basic geometries as
(multi)line, (multi)poligon, (multi)point in order to
connect it (OGR vectors) to my layers/map/renderers framework.
Then I could use such library(ies) in Pocket PC mapping/GPS
applications. I use my own quad tree spatial index.

Then, after some additional work (if required) I'm going to
add SRS/coordinates transformation support.

I also would like to contribute to GDAL/OGR with
Pocket PC related features.

Talking about rasters.
I have my own rasters support. It uses tiled rasters.
So, now I do not need reastes support provided by GDAL.
But, surely I'm interested in this and I do not mind to move to GDAL
raster support.

Note: I develop only for Windows CE 4.x and higher versions.
So, I use eVC++ 4.0 (and Visual Studio 2005 when released).

So, if you don't mind, please send me your GDAL/OGR port.
Do you plan to do some work on this project and add new features from
"big" GDAL/OGR?

May be it could be nice to create a kind of branch/subproject
for Windows CE (as it is for sqlite -> sqlite-wince on SF.net)?

Best regards

-- 
Mateusz ?oskot, mateusz (at) loskot (dot) net
Registered Linux User #220771, Debian (Sarge)

From mateusz at loskot.net  Tue May 31 10:18:09 2005
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <429BC10F.7050900@dmsolutions.ca>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>	<d7fud2$j0h$1@sea.gmane.org>
	<429BC10F.7050900@dmsolutions.ca>
Message-ID: <d7hrhs$esm$1@sea.gmane.org>

Daniel Morissette napisa?(a):
> Mateusz ?oskot wrote:
>> [...]
>> I need only OGR functionality on Windows CE (Mobile) so it could be 
>> easier to port the code when I have OGR sources separated.
>> But I understand it isn't easy job.
>> Greets
>>
> 
> Perhaps a starting point could be the MITAB library. It comes with a 
> standalone/stripped down copy of OGR that contains all the geometry, 
> feature, layer, datasource, SRS, etc... classes, as well as the CPL 
> (port) stuff. You may not need much more to be able to have a working 
> OGR with your selected drivers outside of the GDAL environment.

Thank you, I'm just going to try MITAB lib.
As I see it supports MapInfo formats, but as I understand you
correctly, I can take OGR part of MITAG, right?

I work mainly with Shapefiles and sqlite.
So, I could take that OGR port and use Shapelib for my job.

> The CVS version of MITAB (not released yet) has been updated from the 
> latest OGR source about 2 weeks ago. You could get it through anonymous 
> CVS by checking out module "mitab" with the following CVSROOT:
>  CVSROOT=:pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot
> There is no password for anonymous CVS access, i.e. just hit return with 
> an empty password when doing a 'cvs login'

Thank you, I'm checkin it out now.
As I see you are the project leader, right?

Greets

-- 
Mateusz ?oskot
mateusz at loskot dot net


From dmorissette at dmsolutions.ca  Tue May 31 13:56:19 2005
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: How to separate OGR from GDAL
In-Reply-To: <d7hrhs$esm$1@sea.gmane.org>
References: <d7eo7u$s5i$1@sea.gmane.org>	<200505301250.18167.lists@b-open-solutions.it>	<d7fud2$j0h$1@sea.gmane.org>	<429BC10F.7050900@dmsolutions.ca>
	<d7hrhs$esm$1@sea.gmane.org>
Message-ID: <429CA543.40702@dmsolutions.ca>

Mateusz ?oskot wrote:
> 
> Thank you, I'm just going to try MITAB lib.
> As I see it supports MapInfo formats, but as I understand you
> correctly, I can take OGR part of MITAG, right?
> 

You'd need to take the "ogr" and "cpl" directories, and then use that to 
build with OGR's shapelib and sqlite drivers.

> As I see you are the project leader, right?
> 

Yup.

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From Ken.Boss at dnr.state.mn.us  Tue May 31 14:44:56 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] transparent Geotiff?
Message-ID: <s29c6adc.082@co5.dnr.state.mn.us>

>>Bart--
>>
>>If your goal is simply to set background to transparent in mapserver apps, you should be able to use the OFFSITE parameter in your layer definition to accomplish that - no conversion necessary.  Eg:,
>>
>>  LAYER
>>    NAME shr30im3
>>    STATUS OFF
>>    DATA "data/gen/state/mn/shdr_clrim3.tif"
>>    TYPE RASTER
>>    OFFSITE 255 255 255
>>  END # shaded relief
>>
>>HTH,
>>
>>--Ken
>>
>>>> "Luis W. Sevilla" <sevilla_lui@gva.es> 05/30/05 5:58 AM >>>
>We've tryed to configure a mapserver serving WCS layers, but is seems to 
>ignore that OFFSITE parameter
>it's there anything more to do ?
>
>    thanks in advance
>-- 
>  Luis W. Sevilla

Luis--

I haven't done WCS myself.  I do know that in WMS contexts, you can effectively allow layers to "show through" OFFSITE in an overlain image, like:

  LAYER
    NAME landsat_img
    STATUS default
    DATA images/landsat/mosaic_img/state.img
    TYPE RASTER
    PROJECTION
      "init=epsg:26915"
    END
  END # landsat thematic mapper mosaic

  LAYER
    NAME color_ir
    STATUS default
    TILEINDEX images/ra_qq_test/tiles.shp
    TILEITEM "LOCATION"
    TYPE raster
    OFFSITE 0 0 0
    PROJECTION
      "init=epsg:26915"
    END
  END

where the landsat_img layer is drawn first and shows through any offsite areas in the color_ir layer.

If you had a bunch of tiff images with unwanted offsite, and you wanted to display those as a single layer, you could set it up much like the color_ir layer above and it should work.

That said, if what you're after is an image retrieved from WMS sources with transparent offsite, I think you may be out of luck.  AFAIK, there is no provision for that sort of thing, though I could be wrong.

--Ken


From dron at ak4719.spb.edu  Tue May 31 15:00:13 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <429C32F9.6070300@loskot.net>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
	<d7fut0$kbj$1@sea.gmane.org> <20050531052316.GA8116@ak4719.spb.edu>
	<429C32F9.6070300@loskot.net>
Message-ID: <20050531190013.GA5871@ak4719.spb.edu>

On Tue, May 31, 2005 at 11:48:41AM +0200, Mateusz ?oskot wrote:
> >> #ifdef HAVE_LOCALE_H
> >> #  include <locale.h>
> >> #endif
> 
> Certainly, I know that technique but the name "guard" strange for me.

I didn't read original K&R (i.e. in English), and do not know how they
call this technique, but Stroustrup uses the term "include guards".

> evc++ supports nmake build system. Certainly, there are some features
> in "big" Windows (and "big" namke system) not supported byt Pocket PC
> SDK. I've created makefile.evc and I'm trying to go with this but it
> is not enough solution. So, I will try to work with nmake.opt and
> other files you are talking about. Today I will dig into this job.

Once I tried to build libtiff using eVC. I do not remember details, but a
mess with headers was the main problem. I haven't forced enough to
commit the stuff into libtiff CVS, so all of that remains outside of the
main tree. I do not think there will be a big hassle to port GDAL to
eVC.

As a first step you should write your own cpl_config.h.evc, because
cpl_config.h.vc is not suitable for that compiler. Also conditional
compilation in cpl_vsisimple.cpp and cpl_port.h should be corrected (to
isolate fcntl.h, for example).

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From dron at ak4719.spb.edu  Tue May 31 15:00:13 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Re: Building GDAL with eVC++ 4.0
In-Reply-To: <429C32F9.6070300@loskot.net>
References: <d7elp1$knm$1@sea.gmane.org>
	<20050530181438.GB12277@ak4719.spb.edu>
	<d7fut0$kbj$1@sea.gmane.org> <20050531052316.GA8116@ak4719.spb.edu>
	<429C32F9.6070300@loskot.net>
Message-ID: <20050531190013.GA5871@ak4719.spb.edu>

On Tue, May 31, 2005 at 11:48:41AM +0200, Mateusz ?oskot wrote:
> >> #ifdef HAVE_LOCALE_H
> >> #  include <locale.h>
> >> #endif
> 
> Certainly, I know that technique but the name "guard" strange for me.

I didn't read original K&R (i.e. in English), and do not know how they
call this technique, but Stroustrup uses the term "include guards".

> evc++ supports nmake build system. Certainly, there are some features
> in "big" Windows (and "big" namke system) not supported byt Pocket PC
> SDK. I've created makefile.evc and I'm trying to go with this but it
> is not enough solution. So, I will try to work with nmake.opt and
> other files you are talking about. Today I will dig into this job.

Once I tried to build libtiff using eVC. I do not remember details, but a
mess with headers was the main problem. I haven't forced enough to
commit the stuff into libtiff CVS, so all of that remains outside of the
main tree. I do not think there will be a big hassle to port GDAL to
eVC.

As a first step you should write your own cpl_config.h.evc, because
cpl_config.h.vc is not suitable for that compiler. Also conditional
compilation in cpl_vsisimple.cpp and cpl_port.h should be corrected (to
isolate fcntl.h, for example).

Regards,
Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From mbrudka at aster.pl  Tue May 31 16:11:56 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:39 2007
Subject: [Gdal-dev] Multi-threading Support
In-Reply-To: <931f8ea90505230903503c2b8e@mail.gmail.com>
References: <931f8ea90505230903503c2b8e@mail.gmail.com>
Message-ID: <429CC50C.7010000@aster.pl>

Frank,

> o Any given GDALDataset is used only from one thread.
>  
>
Does it mean: "GDALDataset can be used only from one thread mutually"?
Or "GDALDataset  can be used in one specific (creation?) thread"?  Or
worse..? Can we use given dataset in many threads if we synchronize
access to it's methods and objects produced eg. rasterbands?

> o The GDAL driver list should be initialized only once (ie. a
>    call to GDALAllRegister()). 
>  
>
Certainly.

> o Currently error handlers are per-thread, so if you want to install
>    a custom error handler, you will need to do this for each thread
>    depending on it. 
>  
>
Not a very convenient solution, especially when an application has
many threads and thread pools. Why error handlers cannot be
process wide?

> o The block cache is shared amoung all threads. 
>  
>
Does it mean that the cache is thread safe? Can we create a
number of datasets and process them concurrently in various
threads without any explicit locking ? If so, it is a great news :-) !

> o My testing has been mostly in a read-only environment.  I don't
>    see any obvious problem with writing, but it hasn't been tested
>    in a multithreaded environment. 
>  o I have not reviewed the OGRSpatialReference related code for
>     threadsafety yet.  
>
In my company we assumed we cannot change PROJ.4, in particular
we cannot neither place *pj*_errno in thread specific storage nor
modify PROJ.4 to return error codes rather than to modify
global variables.

This implied a global PROJ.4 mutex in ogrct.cpp and locking in the
following function/methods:

LoadProjLibrary(),
char *OCTProj4Normalize( const char *pszProj4Src ),
OGRProj4CT::~OGRProj4CT(),
int OGRProj4CT::Initialize( OGRSpatialReference * poSourceIn,
                            OGRSpatialReference * poTargetIn )
int OGRProj4CT::TransformEx( int nCount, double *x, double *y, double *z,
                             int *pabSuccess ).

Because all PROJ.4 related methods are enclosed in ogrct.cpp, PROJ.4 lock
has not to bo exposed outside GDAL. This was sufficient to achieve
reentrancy of all OGRSpatialReference related methods in OGR (at least in
our tests :-) )

>For background, I have made a number of additions to cpl_multiproc.cpp/h
>including the addition of a mutex holder class.  
>

Great! I made a similiar class when was working on GDAL thread safety
few weeks ago. I even planned to post my changes, but I see I'm too
late :-). Let me share then my multithread experiences to make
GDAL a better software:

1. It is better to separate the creation of the mutex from its locking
(see eg. boost:thread, ACE::ACE_Mutex). These activities are quite
different and it is better to not mix them.
Currently, in GDAL mutexes are locked during creation.  It is not very
convenient and GDAL by itself is a proof for this statement. In
1.2.6 mutexes were employed only in GDALwarp::alg, and they were
released just after they were created! Why to make such simple
operations so complex then?

2. Usually it is good to have a class for holding mutex (similiar to
CPLMutexHolder). But this class should be responsible for holding
a mutex only. It should expose and interface for direct
acquire/try_acquire/release, but should not lock a mutex by
itself in constructor (see eg. boost::thread, ACE::ACE_Mutex). In
fact such mutex holder should be a C++ wrapper around
native OS functions.

3. It is good to not use mutexes directly, but via guard class (see eg.
boost::thread,  ACE::ACE_Mutex) . The guard class ("the creation
of the object is resource allocation", Stroustrup) should acquire a
mutex when created and release it  when destroyed. Additionally,
a guard should expose a release method. In general, in larger
projects it is better to use guards rather than direct
direct locking, as this prevents some deadlocks.

4. To serve specific purposes better, a guard class should have a
copy semantics aka. std::auto_ptr, namely left hand side guard
during copying (copy ctor, assignment operator) should grab
a mutex (disown) from RHS guard. This way, one
may return a guard to synchronize the access to an object and
be (almost) sure the mutex will be released. It is better solution
than exposing a mutex directly.

I've attached an examplary cpl_mutex classes ( which fullfills 1-3
requirements) to this e-mail. If you find it usefull, please consider
using them in GDAL.

>I have also modified the assumptions with regard to CPLAcquireMutex().  
>It is now expected to support recursive mutex acquisition.  That is, a 
>thread can safely acquire an already held mutex again.
>
Good! That was another thing which was not very consistent in
previous versions of GDAL (recursive under win32, but
non-recursive under linux). In general, in OO programing it is
better to use recursive mutexes, though some say that flaws
in architecture manifest sometimes as a need for recursive
mutexes :-)

>  Normal reference 
>counting rules apply.  I am a bit concerned about how portable this will
>be on different pthreads implementations.  Currently I have tested it on
>Linux and I had to use the apparently non-standard
>PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP mutex initialization.
>It may be that additional work will be needed for multi-threaded mutex
>support on other platforms. 
>  
>
Recursive mutexes in pthreads are available in UNIX98 extensions.
Here is the list of platforms, which seem to support recursive
mutexes natively,  though not necessary via pthreads:
AIX >=4 (pthread), linux (pthread), cygwin32 (pthread),
freebsd > 4 (pthread), hpux >=11 (pthread), netbsd (pthread),
win32 (win sdk), psos-diab-ppc.
Probably, recursive mutexes are also avalaible in many other platforms
(eg. sunos, qnx nto), but do not want to mention them explicitely
as I'm cannot verify that at this moment. Neverthless, even
if recursive mutex is not avalaible directly one can emulate it.
But to faciliate this it is better to have CPLMutex class rather
than use void** directly :-).

>The other key change was introduction of the CPL_THREADLOCAL
>macro.  This attribute for a variable marks it as being thread-local.
>That is, a separate instance will exist for each thread.  I have applied
>this to a variety of static buffers in gdal/port such as the "last error
>message" buffer.   On win32 this evaluates to __declspec(thread). 
>On other platforms it resolves to nothing by default, but if you have
>an appropriately modern version of gcc you can have it expand
>to __thread.  I have tested this with gcc 3.3 on Linux successfully.
>I still need to develop the appropriate configuration control around 
>this definition.
>  
>
Thread specific storage is avalaible on many platforms, but
unfortunatelly one cannot expect that a single macro solves
the problem in portable way. A more serious and portable
attempt is to create some wrappers for accessing thread specific
keys and then to define all those thread variables as a function
calls which get values from thread specific storage. Obviously, such
solution is more advanced, and requires much more work than
simple declspec or __thread. However, it seems that this is the
only way to achieve true portability across many platforms
(eg. see ACE).  Do you plan to restrict multithread GDAL to
win32/gcc 3.3 only?

>Those with a strong interest in GDAL multi-threaded support are
>encouraged to test it over the next two weeks while I am away.
>However, as it is all quite new some teething problems are to be
>expected.  So take care with the latest CVS version of GDAL.
>  
>
I'm really gdal ( :-) ) to see all these changes.

Thank you.
Marek


-------------- next part --------------
A non-text attachment was scrubbed...
Name: cpl_mutex.h
Type: text/x-chdr
Size: 4245 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050531/4ce46969/cpl_mutex.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cpl_mutex.cpp
Type: text/x-c++src
Size: 3461 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050531/4ce46969/cpl_mutex-0001.bin
