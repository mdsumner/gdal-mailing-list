From even.rouault at mines-paris.org  Thu May  1 11:25:11 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 1 May 2014 20:25:11 +0200
Subject: [gdal-dev] shapefile enhancements
In-Reply-To: <CAKMUAtCcK_xwHGcMr94Z18-srSDWc0C70f7WqfSgsHu2y9wiSQ@mail.gmail.com>
References: <CAKMUAtCzs6Y8oUWDRegwyePyfXz_ks2Y=YzhVBjSZm3N346L=Q@mail.gmail.com>
	<201404301630.36069.even.rouault@mines-paris.org>
	<CAKMUAtCcK_xwHGcMr94Z18-srSDWc0C70f7WqfSgsHu2y9wiSQ@mail.gmail.com>
Message-ID: <201405012025.11205.even.rouault@mines-paris.org>

Le mercredi 30 avril 2014 22:02:34, Jan Heckman a ?crit :
> Hi,
> 
> Extending shapefile capabilities: The one reason which might persuade
> anyone is the still abundant use of shapefiles for dataexchange.
> Shapefile does seem to play a vital role there. I don't know of anything
> equally 'tradeable'.
> However, an extension would also endanger the
> interoperability/dataexchange, so little of this would work short of
> definining a new shapefile variant specification, working title .shp2.
> I can see the outlines, even though I doubt it will be possible to
> introduce such a thing. The mods would not be that hard, though.

I'm not sure there's a point in defining a .shp2 spec. The GeoPackage one can 
be thought as the "new shapefile".
It should have all its main advantages :
- spatial index
- random access
- binary encoding of geometries

Plus a few nice features :
- attribute indexes
- database format, with SQL capabilities
- binary encoding of attributes
- extensibility

Its history is admitedly a bit young, but the specification is already 
standardized and has begun to be implemented in various software packages, 
including OGR.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From robert at urban4m.com  Thu May  1 11:34:51 2014
From: robert at urban4m.com (Robert Nix)
Date: Thu, 1 May 2014 14:34:51 -0400
Subject: [gdal-dev] Can GDAL read a GTiff from a memory buffer?
Message-ID: <CAC2EkfPzAMptUwdemCuAPHk8o88Z9Mbv+TfoWd-2FQ4iiWm++A@mail.gmail.com>

Hi,

I have a situation where i get a geotiff across the network. I don't want
to have to save it to a file and reopen it to load it into numpy. Is this
possible with GDAL? Doesn't have to be supported in Python. I can call into
C/C++ if needed.

Thanks
-- 
.nix
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140501/be624ef3/attachment.html>

From even.rouault at mines-paris.org  Thu May  1 11:54:52 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 1 May 2014 20:54:52 +0200
Subject: [gdal-dev] Can GDAL read a GTiff from a memory buffer?
In-Reply-To: <CAC2EkfPzAMptUwdemCuAPHk8o88Z9Mbv+TfoWd-2FQ4iiWm++A@mail.gmail.com>
References: <CAC2EkfPzAMptUwdemCuAPHk8o88Z9Mbv+TfoWd-2FQ4iiWm++A@mail.gmail.com>
Message-ID: <201405012054.52684.even.rouault@mines-paris.org>

Le jeudi 01 mai 2014 20:34:51, Robert Nix a ?crit :
> Hi,
> 
> I have a situation where i get a geotiff across the network. I don't want
> to have to save it to a file and reopen it to load it into numpy. Is this
> possible with GDAL? Doesn't have to be supported in Python. I can call into
> C/C++ if needed.

Several possible ways :

- This will download the whole file in memory before opening it :
gdalinfo http://path/to/the.tif

- This will download parts of the file when needed (if the server supports 
range downloading) :
gdalinfo /vsicurl/http://path/to/the.tif

- Download the data with the way you prefer in the_buffer
  Use gdal.FileFromMemBuffer("/vsimem/tmp.tif", the_buffer)
  gdal.Open("/vsimem/tmp.tif")
  gdal.Unlink("/vsimem/tmp.tif")


> 
> Thanks

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From robert at urban4m.com  Thu May  1 12:53:28 2014
From: robert at urban4m.com (Robert Nix)
Date: Thu, 1 May 2014 15:53:28 -0400
Subject: [gdal-dev] Can GDAL read a GTiff from a memory buffer?
In-Reply-To: <201405012054.52684.even.rouault@mines-paris.org>
References: <CAC2EkfPzAMptUwdemCuAPHk8o88Z9Mbv+TfoWd-2FQ4iiWm++A@mail.gmail.com>
	<201405012054.52684.even.rouault@mines-paris.org>
Message-ID: <CAC2EkfPunw_vN+exixKUuSLo+_4_WjUR9tDoooaRqiO-x4DMgg@mail.gmail.com>

Great, Evan! And I found your blog post about
it<http://erouault.blogspot.com/2012/05/new-gdal-virtual-file-system-to-read.html>
with
some good, helpful links too. Thank you!


On Thu, May 1, 2014 at 2:54 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le jeudi 01 mai 2014 20:34:51, Robert Nix a ?crit :
> > Hi,
> >
> > I have a situation where i get a geotiff across the network. I don't want
> > to have to save it to a file and reopen it to load it into numpy. Is this
> > possible with GDAL? Doesn't have to be supported in Python. I can call
> into
> > C/C++ if needed.
>
> Several possible ways :
>
> - This will download the whole file in memory before opening it :
> gdalinfo http://path/to/the.tif
>
> - This will download parts of the file when needed (if the server supports
> range downloading) :
> gdalinfo /vsicurl/http://path/to/the.tif
>
> - Download the data with the way you prefer in the_buffer
>   Use gdal.FileFromMemBuffer("/vsimem/tmp.tif", the_buffer)
>   gdal.Open("/vsimem/tmp.tif")
>   gdal.Unlink("/vsimem/tmp.tif")
>
>
> >
> > Thanks
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



-- 
.nix
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140501/a34a8875/attachment.html>

From robert at urban4m.com  Thu May  1 12:53:54 2014
From: robert at urban4m.com (Robert Nix)
Date: Thu, 1 May 2014 15:53:54 -0400
Subject: [gdal-dev] Can GDAL read a GTiff from a memory buffer?
In-Reply-To: <CAC2EkfPunw_vN+exixKUuSLo+_4_WjUR9tDoooaRqiO-x4DMgg@mail.gmail.com>
References: <CAC2EkfPzAMptUwdemCuAPHk8o88Z9Mbv+TfoWd-2FQ4iiWm++A@mail.gmail.com>
	<201405012054.52684.even.rouault@mines-paris.org>
	<CAC2EkfPunw_vN+exixKUuSLo+_4_WjUR9tDoooaRqiO-x4DMgg@mail.gmail.com>
Message-ID: <CAC2EkfMt_Tw2VhchZsFevgLDONMCAj=axOcgjO=k5a4njWHAZg@mail.gmail.com>

Sorry, Even. :)


On Thu, May 1, 2014 at 3:53 PM, Robert Nix <robert at urban4m.com> wrote:

> Great, Evan! And I found your blog post about it<http://erouault.blogspot.com/2012/05/new-gdal-virtual-file-system-to-read.html> with
> some good, helpful links too. Thank you!
>
>
> On Thu, May 1, 2014 at 2:54 PM, Even Rouault <even.rouault at mines-paris.org
> > wrote:
>
>> Le jeudi 01 mai 2014 20:34:51, Robert Nix a ?crit :
>> > Hi,
>> >
>> > I have a situation where i get a geotiff across the network. I don't
>> want
>> > to have to save it to a file and reopen it to load it into numpy. Is
>> this
>> > possible with GDAL? Doesn't have to be supported in Python. I can call
>> into
>> > C/C++ if needed.
>>
>> Several possible ways :
>>
>> - This will download the whole file in memory before opening it :
>> gdalinfo http://path/to/the.tif
>>
>> - This will download parts of the file when needed (if the server supports
>> range downloading) :
>> gdalinfo /vsicurl/http://path/to/the.tif
>>
>> - Download the data with the way you prefer in the_buffer
>>   Use gdal.FileFromMemBuffer("/vsimem/tmp.tif", the_buffer)
>>   gdal.Open("/vsimem/tmp.tif")
>>   gdal.Unlink("/vsimem/tmp.tif")
>>
>>
>> >
>> > Thanks
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>>
>
>
>
> --
> .nix
>



-- 
.nix
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140501/449cf800/attachment.html>

From jan.heckman at gmail.com  Thu May  1 14:56:35 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Thu, 1 May 2014 23:56:35 +0200
Subject: [gdal-dev] shapefile enhancements
In-Reply-To: <201405012025.11205.even.rouault@mines-paris.org>
References: <CAKMUAtCzs6Y8oUWDRegwyePyfXz_ks2Y=YzhVBjSZm3N346L=Q@mail.gmail.com>
	<201404301630.36069.even.rouault@mines-paris.org>
	<CAKMUAtCcK_xwHGcMr94Z18-srSDWc0C70f7WqfSgsHu2y9wiSQ@mail.gmail.com>
	<201405012025.11205.even.rouault@mines-paris.org>
Message-ID: <CAKMUAtBUHCF=JuXmR8=F9VAZLUjWTj9iCwwx4EEnj37Eym1tNw@mail.gmail.com>

Thanks for the info.
I'll look into GeoPackage!
Jan


On Thu, May 1, 2014 at 8:25 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le mercredi 30 avril 2014 22:02:34, Jan Heckman a ?crit :
> > Hi,
> >
> > Extending shapefile capabilities: The one reason which might persuade
> > anyone is the still abundant use of shapefiles for dataexchange.
> > Shapefile does seem to play a vital role there. I don't know of anything
> > equally 'tradeable'.
> > However, an extension would also endanger the
> > interoperability/dataexchange, so little of this would work short of
> > definining a new shapefile variant specification, working title .shp2.
> > I can see the outlines, even though I doubt it will be possible to
> > introduce such a thing. The mods would not be that hard, though.
>
> I'm not sure there's a point in defining a .shp2 spec. The GeoPackage one
> can
> be thought as the "new shapefile".
> It should have all its main advantages :
> - spatial index
> - random access
> - binary encoding of geometries
>
> Plus a few nice features :
> - attribute indexes
> - database format, with SQL capabilities
> - binary encoding of attributes
> - extensibility
>
> Its history is admitedly a bit young, but the specification is already
> standardized and has begun to be implemented in various software packages,
> including OGR.
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140501/0d8e3a9a/attachment.html>

From landa.martin at gmail.com  Fri May  2 01:36:14 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 2 May 2014 10:36:14 +0200
Subject: [gdal-dev] ogr2ogr -f OCI fails on Windows
In-Reply-To: <BLU173-W31B726EBD5F7C4E8152704905D0@phx.gbl>
References: <CA+Ei1OfSQykhiArHV-UUSJYSCMb8exvd8+9vDNfV4D29EYVsqw@mail.gmail.com>
	<BLU173-W132609D54781D1500D9BC790530@phx.gbl>
	<CA+Ei1OdvWJxks3f9xYFG-imx9BonmTdRTdEP1NOBEdu6=KSJ3g@mail.gmail.com>
	<BLU173-W31B726EBD5F7C4E8152704905D0@phx.gbl>
Message-ID: <CA+Ei1Oentsz01BVvKUkZtUL+OnzL-0x+aEwLKwwxi_Ouga0L4w@mail.gmail.com>

Hi,

2014-04-18 18:55 GMT+02:00 Ivan Lucena <lucena_ivan at hotmail.com>:
> The driver should create the column as VARCHAR2, not VARCHAR [1]. It is
> wrong for several reasons [2] and there is a possibility that the amount of
> data you are loading is too big for the wrong data type. Can you change that
> code [1], compile and try again?
>
> [1] -
> [http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/oci/ogrociwritablelayer.cpp#L296]
>
> [2] """
> The VARCHAR2 subtypes STRING and VARCHAR have the same range of values as
> their base type. For example, VARCHAR is just another name for VARCHAR2.
>
> You can use the VARCHAR2 subtypes for compatibility with ANSI/ISO and IBM
> types.

thanks for the clarification. Changed in r27274. Martin

From yasinberber at gmail.com  Fri May  2 04:23:19 2014
From: yasinberber at gmail.com (=?UTF-8?Q?Yasin_Sel=C3=A7uk_Berber?=)
Date: Fri, 2 May 2014 14:23:19 +0300
Subject: [gdal-dev] how to know which proj4 version gdal uses internally ?
Message-ID: <CA+h5NzPcOSonoUsndaFrHarUVZ1UsFD4XhVLKv+ZaiZLO+NG0g@mail.gmail.com>

hello,

how can i know which proj4 version uses gdal v1.9.2 internally ?

the reason for why i am asking this: i am trying to warp my raster data
into Google Mercator projection from within python, and for the target srs,
i am using function ImportFromEPSG(3857) with gdal v1.9.2 (with python
bindings) and want to know if version 1.9.2 has the new support for Google
Mercator.

i checked the release date for proj4 v4.8.0 and gdal v1.9.2 and saw gdal
v1.9.2 is more recently released. does this mean gdal uses at least v4.8.0
internally or maybe even 4.9.0? (i mean, are proj4 and gdal releases keeped
parallel ?)

below is cropped text from proj4 release notes.

----------
4.7.0 Release Notes
...
Regenerated nad/epsg init file with EPSG 7.1 database, including new
support for Google Mercator (EPSG:3857).
...


thanks
-- 
Yasin
"Bismillah, her hayr?n ba??d?r."
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140502/2740452e/attachment.html>

From even.rouault at mines-paris.org  Fri May  2 04:57:33 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 2 May 2014 13:57:33 +0200
Subject: [gdal-dev] how to know which proj4 version gdal uses internally
	?
In-Reply-To: <CA+h5NzPcOSonoUsndaFrHarUVZ1UsFD4XhVLKv+ZaiZLO+NG0g@mail.gmail.com>
References: <CA+h5NzPcOSonoUsndaFrHarUVZ1UsFD4XhVLKv+ZaiZLO+NG0g@mail.gmail.com>
Message-ID: <201405021357.33980.even.rouault@mines-paris.org>

Le vendredi 02 mai 2014 13:23:19, Yasin Sel?uk Berber a ?crit :
> hello,
> 
> how can i know which proj4 version uses gdal v1.9.2 internally ?
> 
> the reason for why i am asking this: i am trying to warp my raster data
> into Google Mercator projection from within python, and for the target srs,
> i am using function ImportFromEPSG(3857) with gdal v1.9.2 (with python
> bindings) and want to know if version 1.9.2 has the new support for Google
> Mercator.
> 
> i checked the release date for proj4 v4.8.0 and gdal v1.9.2 and saw gdal
> v1.9.2 is more recently released. does this mean gdal uses at least v4.8.0
> internally or maybe even 4.9.0? (i mean, are proj4 and gdal releases keeped
> parallel ?)
> 
> below is cropped text from proj4 release notes.

GDAL has no "internal" proj.4 version. You have to check by other means which 
proj.4 version is installed on your system.

> 
> ----------
> 4.7.0 Release Notes
> ...
> Regenerated nad/epsg init file with EPSG 7.1 database, including new
> support for Google Mercator (EPSG:3857).
> ...
> 
> 
> thanks

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From andre+joost at nurfuerspam.de  Fri May  2 07:03:22 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 02 May 2014 16:03:22 +0200
Subject: [gdal-dev] how to know which proj4 version gdal uses internally
	?
In-Reply-To: <CA+h5NzPcOSonoUsndaFrHarUVZ1UsFD4XhVLKv+ZaiZLO+NG0g@mail.gmail.com>
References: <CA+h5NzPcOSonoUsndaFrHarUVZ1UsFD4XhVLKv+ZaiZLO+NG0g@mail.gmail.com>
Message-ID: <lk08lo$dnl$1@ger.gmane.org>

Am 02.05.2014 13:23, schrieb Yasin Sel?uk Berber:

>
> how can i know which proj4 version uses gdal v1.9.2 internally ?
>

Open a command window, and type

proj

This will return the currently installed version number.

HTH,
Andr? Joost


From jed.kaplan at unil.ch  Fri May  2 07:34:31 2014
From: jed.kaplan at unil.ch (Jed O. Kaplan)
Date: Fri, 2 May 2014 16:34:31 +0200
Subject: [gdal-dev] "Times" projection in GDAL
In-Reply-To: <1395744584.53315f48d8e7c@imp.free.fr>
References: <580CF31B-1F9B-4742-983A-7B1EC320A0E4@unil.ch>
	<533089A6.2080502@gmail.com>
	<B73951F2-3C13-4DA0-A618-3B97BDB01BD3@unil.ch>
	<53313893.7010400@gmail.com> <1395736505.53313fb9d5494@imp.free.fr>
	<53314459.5000404@gmail.com> <1395744584.53315f48d8e7c@imp.free.fr>
Message-ID: <03E83E6B-E92D-4249-9CCE-0A7C36D9BCD6@unil.ch>

Dear All,

I have added the ?Times? projection to my private copy of proj4 and tested it. It works properly using proj and unproj.

Could anyone on this list maybe give me a little guidance as to how I can make GDAL aware of this new map projection so that I may use it with GDAL/OGR utilities?

If everything works, I?ll submit my updates back to the package maintainers.

Many thanks,

Jed

On 25 Mar 2014, at 11:49, Even Rouault <even.rouault at mines-paris.org> wrote:

> Selon Dmitriy Baryshnikov <bishop.dev at gmail.com>:
> 
>> Hi Even,
>> 
>> hfadataset.cpp near 3686 ln
>> else if( EQUAL(pszProjName, "Times") )
>> {
>> sPro.proNumber = EPRJ_TIMES;
>> sPro.proName = (char*) "Times";
>> sPro.proParams[4] = oSRS.GetProjParm(SRS_PP_CENTRAL_MERIDIAN)*D2R;
>> sPro.proParams[6] = oSRS.GetProjParm(SRS_PP_FALSE_EASTING);
>> sPro.proParams[7] = oSRS.GetProjParm(SRS_PP_FALSE_NORTHING);
>> }
>> 
>> also I try this code
>> OGRSpatialReference pSpaRef;
>> const char *pszWkt =
>> 
> "PROJCS[\"World_Times\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHEROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Times\"],PARAMETER[\"Central_Meridian\",0.0],UNIT[\"Meter\",1.0]]";
>> pSpaRef.importFromWkt((char **)&pszWkt);
>> char *pszPrtWKT = NULL;
>> pSpaRef.exportToPrettyWkt(&pszPrtWKT );
>> CPLFree(pszPrtWKT );
>> 
>> And OGRSpatialReference eat this WKT.
> 
> Ah ok, well it is just that it is valid WKT. But we cannot really tell that GDAL
> fully supports it currently. For example the Validate() method of
> OGRSpatialReference would return FALSE since it doesn't know the Times
> projection method, and which projection parameters are valid with it. And we
> don't have a OGRSpatialReference.SetTimes() method. And not mentionning
> importFromProj4/exportToProj4() (but we would need proj.4 support of it before
> of course)
> 
>> 
>> Best regards,
>>     Dmitry
>> 
>> 25.03.2014 12:35, Even Rouault ??????????:
>>> Dmitriy,
>>> 
>>> where did you find reference to the "times" projection in OGR ? I can't
>> find it.
>>> 
>>> Even
>>> 
>> 
>> 
> 
> 


From even.rouault at mines-paris.org  Fri May  2 08:39:03 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 2 May 2014 17:39:03 +0200
Subject: [gdal-dev] "Times" projection in GDAL
In-Reply-To: <03E83E6B-E92D-4249-9CCE-0A7C36D9BCD6@unil.ch>
References: <580CF31B-1F9B-4742-983A-7B1EC320A0E4@unil.ch>
	<1395744584.53315f48d8e7c@imp.free.fr>
	<03E83E6B-E92D-4249-9CCE-0A7C36D9BCD6@unil.ch>
Message-ID: <201405021739.04039.even.rouault@mines-paris.org>

Le vendredi 02 mai 2014 16:34:31, Jed O. Kaplan a ?crit :
> Dear All,
> 
> I have added the ?Times? projection to my private copy of proj4 and tested
> it. It works properly using proj and unproj.
> 
> Could anyone on this list maybe give me a little guidance as to how I can
> make GDAL aware of this new map projection so that I may use it with
> GDAL/OGR utilities?

Below a 'grep' of the places where another projection ("mollweide") is defined. 
Basically you should do similar additions in the same files.

grep -i Mollw ogr/* | grep -v concord | grep -v usg | grep -v panora

ogr/ogr_opt.cpp:    SRS_PT_MOLLWEIDE,
ogr/ogr_opt.cpp:    "Mollweide",
ogr/ogrspatialreference.cpp:        SetMollweide( dfRefLong, 0.0, 0.0 );
ogr/ogrspatialreference.cpp:/*                            SetMollweide()                            
*/
ogr/ogrspatialreference.cpp:OGRErr OGRSpatialReference::SetMollweide( double 
dfCentralMeridian,
ogr/ogrspatialreference.cpp:    SetProjection( SRS_PT_MOLLWEIDE );
ogr/ogrspatialreference.cpp:/*                          OSRSetMollweide()                           
*/
ogr/ogrspatialreference.cpp:OGRErr OSRSetMollweide( OGRSpatialReferenceH hSRS, 
ogr/ogrspatialreference.cpp:    VALIDATE_POINTER1( hSRS, "OSRSetMollweide", 
CE_Failure );
ogr/ogrspatialreference.cpp:    return ((OGRSpatialReference *) hSRS)-
>SetMollweide( 
ogr/ogr_spatialref.h:    /** Mollweide */
ogr/ogr_spatialref.h:    OGRErr      SetMollweide( double dfCentralMeridian,
ogr/ogr_srs_api.h:#define SRS_PT_MOLLWEIDE        "Mollweide"
ogr/ogr_srs_api.h:/** Mollweide */
ogr/ogr_srs_api.h:OGRErr CPL_DLL  OSRSetMollweide( OGRSpatialReferenceH hSRS,
ogr/ogr_srs_proj4.cpp:        SetMollweide( OSR_GDV( papszNV, "lon_0", 0.0 ), 
ogr/ogr_srs_proj4.cpp:    else if( EQUAL(pszProjection,SRS_PT_MOLLWEIDE) )
ogr/ogr_srs_validate.cpp:    SRS_PT_MOLLWEIDE,
ogr/ogr_srs_validate.cpp:    SRS_PT_MOLLWEIDE,


> 
> If everything works, I?ll submit my updates back to the package
> maintainers.
> 
> Many thanks,
> 
> Jed
> 
> On 25 Mar 2014, at 11:49, Even Rouault <even.rouault at mines-paris.org> wrote:
> > Selon Dmitriy Baryshnikov <bishop.dev at gmail.com>:
> >> Hi Even,
> >> 
> >> hfadataset.cpp near 3686 ln
> >> else if( EQUAL(pszProjName, "Times") )
> >> {
> >> sPro.proNumber = EPRJ_TIMES;
> >> sPro.proName = (char*) "Times";
> >> sPro.proParams[4] = oSRS.GetProjParm(SRS_PP_CENTRAL_MERIDIAN)*D2R;
> >> sPro.proParams[6] = oSRS.GetProjParm(SRS_PP_FALSE_EASTING);
> >> sPro.proParams[7] = oSRS.GetProjParm(SRS_PP_FALSE_NORTHING);
> >> }
> >> 
> >> also I try this code
> >> OGRSpatialReference pSpaRef;
> >> const char *pszWkt =
> > 
> > "PROJCS[\"World_Times\",GEOGCS[\"GCS_WGS_1984\",DATUM[\"D_WGS_1984\",SPHE
> > ROID[\"WGS_1984\",6378137.0,298.257223563]],PRIMEM[\"Greenwich\",0.0],UNI
> > T[\"Degree\",0.0174532925199433]],PROJECTION[\"Times\"],PARAMETER[\"Centr
> > al_Meridian\",0.0],UNIT[\"Meter\",1.0]]";
> > 
> >> pSpaRef.importFromWkt((char **)&pszWkt);
> >> char *pszPrtWKT = NULL;
> >> pSpaRef.exportToPrettyWkt(&pszPrtWKT );
> >> CPLFree(pszPrtWKT );
> >> 
> >> And OGRSpatialReference eat this WKT.
> > 
> > Ah ok, well it is just that it is valid WKT. But we cannot really tell
> > that GDAL fully supports it currently. For example the Validate() method
> > of OGRSpatialReference would return FALSE since it doesn't know the
> > Times projection method, and which projection parameters are valid with
> > it. And we don't have a OGRSpatialReference.SetTimes() method. And not
> > mentionning importFromProj4/exportToProj4() (but we would need proj.4
> > support of it before of course)
> > 
> >> Best regards,
> >> 
> >>     Dmitry
> >> 
> >> 25.03.2014 12:35, Even Rouault ??????????:
> >>> Dmitriy,
> >>> 
> >>> where did you find reference to the "times" projection in OGR ? I can't
> >> 
> >> find it.
> >> 
> >>> Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From lucena_ivan at hotmail.com  Fri May  2 08:59:42 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 2 May 2014 11:59:42 -0400
Subject: [gdal-dev] ogr2ogr -f OCI fails on Windows
In-Reply-To: <CA+Ei1Oentsz01BVvKUkZtUL+OnzL-0x+aEwLKwwxi_Ouga0L4w@mail.gmail.com>
References: <CA+Ei1OfSQykhiArHV-UUSJYSCMb8exvd8+9vDNfV4D29EYVsqw@mail.gmail.com>,
	<BLU173-W132609D54781D1500D9BC790530@phx.gbl>,
	<CA+Ei1OdvWJxks3f9xYFG-imx9BonmTdRTdEP1NOBEdu6=KSJ3g@mail.gmail.com>,
	<BLU173-W31B726EBD5F7C4E8152704905D0@phx.gbl>,
	<CA+Ei1Oentsz01BVvKUkZtUL+OnzL-0x+aEwLKwwxi_Ouga0L4w@mail.gmail.com>
Message-ID: <BLU173-W14E529F4DA3398CFCAF89890430@phx.gbl>

Hi Martin,

Here is a list of the issues that I am planning to fix on that driver, once I have time, bur if you think they are important for you too we can share the work. The first item you have already started but you might think of adding that line to the session initialization:

1)  Always create tables using VARCHAR2 
specifications for character strings. Without this, loading into UTF8 
databases is not possible. The simplest to achieve this is to execute 
this statement when connecting:
ALTER SESSION SET NLS_LENGTH_SEMANTICS=CHAR
2) When loading a shape file without
 any attributes, then the -overwrite parameter is ignored. When the 
shape file has at least one attribute in the DBF file, then the 
-overwrite parameter works fine: the OCI driver first drops the existing
 table before re-creating it. Only when the input shape file has no attributes.
3) When reading a view, the name of the view name must be in upper case

4) Add support for LOB attribute columns

5) Create the table with all the column definition at once instead of issuing one ALTER TABLE ADD COLUMN statement for each column

I have started with # 4 but I didn't get very far.

Regards,

Ivan

> Date: Fri, 2 May 2014 10:36:14 +0200
> Subject: Re: [gdal-dev] ogr2ogr -f OCI fails on Windows
> From: landa.martin at gmail.com
> To: lucena_ivan at hotmail.com
> CC: gdal-dev at lists.osgeo.org
> 
> Hi,
> 
> 2014-04-18 18:55 GMT+02:00 Ivan Lucena <lucena_ivan at hotmail.com>:
> > The driver should create the column as VARCHAR2, not VARCHAR [1]. It is
> > wrong for several reasons [2] and there is a possibility that the amount of
> > data you are loading is too big for the wrong data type. Can you change that
> > code [1], compile and try again?
> >
> > [1] -
> > [http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/oci/ogrociwritablelayer.cpp#L296]
> >
> > [2] """
> > The VARCHAR2 subtypes STRING and VARCHAR have the same range of values as
> > their base type. For example, VARCHAR is just another name for VARCHAR2.
> >
> > You can use the VARCHAR2 subtypes for compatibility with ANSI/ISO and IBM
> > types.
> 
> thanks for the clarification. Changed in r27274. Martin
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140502/7e694514/attachment.html>

From landa.martin at gmail.com  Fri May  2 09:06:50 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 2 May 2014 18:06:50 +0200
Subject: [gdal-dev] ogr2ogr -f OCI fails on Windows
In-Reply-To: <BLU173-W14E529F4DA3398CFCAF89890430@phx.gbl>
References: <CA+Ei1OfSQykhiArHV-UUSJYSCMb8exvd8+9vDNfV4D29EYVsqw@mail.gmail.com>
	<BLU173-W132609D54781D1500D9BC790530@phx.gbl>
	<CA+Ei1OdvWJxks3f9xYFG-imx9BonmTdRTdEP1NOBEdu6=KSJ3g@mail.gmail.com>
	<BLU173-W31B726EBD5F7C4E8152704905D0@phx.gbl>
	<CA+Ei1Oentsz01BVvKUkZtUL+OnzL-0x+aEwLKwwxi_Ouga0L4w@mail.gmail.com>
	<BLU173-W14E529F4DA3398CFCAF89890430@phx.gbl>
Message-ID: <CA+Ei1OccFr49S-4WkcJ4dMZ+_JFMRMK6Hc27D=w62_M6fndgyA@mail.gmail.com>

Hi Ivan,

2014-05-02 17:59 GMT+02:00 Ivan Lucena <lucena_ivan at hotmail.com>:

> Here is a list of the issues that I am planning to fix on that driver, once
> I have time, bur if you think they are important for you too we can share
> the work. The first item you have already started but you might think of

Great. BTW, I already started implementing RFC 41 (multiple geometry
fields support) in OCI driver. I hope to have initial version in hands
within the next week. There are some issues where I am not completely
sure about side-effects, so I will definitely appreciate your support!
Martin

From Elke.Ochs at erdc.dren.mil  Fri May  2 11:59:58 2014
From: Elke.Ochs at erdc.dren.mil (Ochs, Elke ERDC-RDE-CRREL-NH)
Date: Fri, 2 May 2014 18:59:58 +0000
Subject: [gdal-dev] GML and Spatial Reference
Message-ID: <49A547E4CC0E624EB0B69B7A9B7C0A405042EFFD@MS-EX2VKS.erdc.dren.mil>

Hello,

I'm not able to save a spatial reference to a GML file and would like help understanding why.  I'm creating a new GML from a copied feature.  I assign the spatial reference to both the output layer and geometry.  During debug, the layer and geometry report  that the SR has been assigned correctly (GetSratialRef/GetSpatialReference).  When I open the result GML file in another script, the spatial reference is empty.

It's a non-standard SRS (albers, units feet) - not sure if this is an issue.

I'm using GDAL 1.10 compiled with Expat.  I'm fairly new to all of this.  Any help is appreciated.  I'm including most of the script, b/c I'm not sure where my error might be.  Some of it is taken from the  GDAL/OGR Cookbook.

    drv = ogr.GetDriverByName("GML")
    ds = drv.Open(gmlin,0)

    srs = osr.SpatialReference()
    proj4str = "+proj=aea +lat_1=29.5n +lat_2=45.5n +lat_0=23.0n +lon_0=96.0w +x_0=0.0 +y_0=0.0 +units=us-ft +datum=NAD83"
    srs.ImportFromProj4(proj4str)

    lyr = ds.GetLayer()
    lyr.SetAttributeFilter("cat = " + cat)
    outds = drv.CreateDataSource(gmlout,options = ["FORMAT=GML3"])
    outlyr = outds.CreateLayer(outlyrname,srs,lyr.GetGeomType())
    inLayerDefn = lyr.GetLayerDefn()
    for i in range(0, inLayerDefn.GetFieldCount()):
        fieldDefn = inLayerDefn.GetFieldDefn(i)
        outlyr.CreateField(fieldDefn)
    outLayerDefn = outlyr.GetLayerDefn()

    for feat in lyr:
        geom = feat.GetGeometryRef()
        outfeat = ogr.Feature(outLayerDefn)
        for i in range(0, outLayerDefn.GetFieldCount()):
            outfeat.SetField(outLayerDefn.GetFieldDefn(i).GetNameRef(), feat.GetField(i))
        geom.AssignSpatialReference(srs)
        outfeat.SetGeometry(geom)
        outlyr.CreateFeature(outfeat)

Thank you,
Elke


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140502/ff7e0b3a/attachment.html>

From even.rouault at mines-paris.org  Fri May  2 12:35:09 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 2 May 2014 21:35:09 +0200
Subject: [gdal-dev] GML and Spatial Reference
In-Reply-To: <49A547E4CC0E624EB0B69B7A9B7C0A405042EFFD@MS-EX2VKS.erdc.dren.mil>
References: <49A547E4CC0E624EB0B69B7A9B7C0A405042EFFD@MS-EX2VKS.erdc.dren.mil>
Message-ID: <201405022135.09436.even.rouault@mines-paris.org>

Le vendredi 02 mai 2014 20:59:58, Ochs, Elke ERDC-RDE-CRREL-NH a ?crit :
> Hello,
> 
> I'm not able to save a spatial reference to a GML file and would like help
> understanding why.  I'm creating a new GML from a copied feature.  I
> assign the spatial reference to both the output layer and geometry. 
> During debug, the layer and geometry report  that the SR has been assigned
> correctly (GetSratialRef/GetSpatialReference).  When I open the result GML
> file in another script, the spatial reference is empty.

Well, this is tricky :
- SRS in GML are only supported as EPSG codes. So you cannot pass an arbitrary 
proj.4 string
- Even if you do so, you will find that reading back the file will not lead to a 
SRS to be retrieved, since the driver is conservative by default (a GML file 
could have a mix of various SRS and we cannot trust the first one found in the 
file).

> 
> It's a non-standard SRS (albers, units feet) - not sure if this is an
> issue.
> 
> I'm using GDAL 1.10 compiled with Expat.  I'm fairly new to all of this. 
> Any help is appreciated.  I'm including most of the script, b/c I'm not
> sure where my error might be.  Some of it is taken from the  GDAL/OGR
> Cookbook.
> 
>     drv = ogr.GetDriverByName("GML")
>     ds = drv.Open(gmlin,0)
> 
>     srs = osr.SpatialReference()
>     proj4str = "+proj=aea +lat_1=29.5n +lat_2=45.5n +lat_0=23.0n
> +lon_0=96.0w +x_0=0.0 +y_0=0.0 +units=us-ft +datum=NAD83"
> srs.ImportFromProj4(proj4str)
> 
>     lyr = ds.GetLayer()
>     lyr.SetAttributeFilter("cat = " + cat)
>     outds = drv.CreateDataSource(gmlout,options = ["FORMAT=GML3"])
>     outlyr = outds.CreateLayer(outlyrname,srs,lyr.GetGeomType())
>     inLayerDefn = lyr.GetLayerDefn()
>     for i in range(0, inLayerDefn.GetFieldCount()):
>         fieldDefn = inLayerDefn.GetFieldDefn(i)
>         outlyr.CreateField(fieldDefn)
>     outLayerDefn = outlyr.GetLayerDefn()
> 
>     for feat in lyr:
>         geom = feat.GetGeometryRef()
>         outfeat = ogr.Feature(outLayerDefn)
>         for i in range(0, outLayerDefn.GetFieldCount()):
>             outfeat.SetField(outLayerDefn.GetFieldDefn(i).GetNameRef(),
> feat.GetField(i)) geom.AssignSpatialReference(srs)
>         outfeat.SetGeometry(geom)
>         outlyr.CreateFeature(outfeat)
> 
> Thank you,
> Elke

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From woklist at kyngchaos.com  Fri May  2 12:44:08 2014
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Fri, 2 May 2014 14:44:08 -0500
Subject: [gdal-dev] FileGDB feature datasets
Message-ID: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>

For a while I've been converting FileGDB v9 files to v10 with Arc (export to GDB multiple) so I can read them with GDAL (1.10).  This works fine, the conversion creates a flat GDB, though the original GDB has the data grouped in feature datasets.

I just got some v10 GDBs, so no conversion needed, right?  Nothing is visible with GDAL.  They also have data divided into feature datasets within the GDB, so it sounds like GDAL can't acces the dataset groups.  Unless I'm missing an option (the GDAL docs for the FileGDB format don't mention datasets)?

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Mon Dieu! but they are all alike.  Cheating, murdering, lying, fighting, and all for things that the beasts of the jungle would not deign to possess - money to purchase the effeminate pleasures of weaklings.  And yet withal bound down by silly customs that make them slaves to their unhappy lot while firm in the belief that they be the lords of creation enjoying the only real pleasures of existence....

- the wisdom of Tarzan



From egoddard1010 at gmail.com  Fri May  2 12:57:52 2014
From: egoddard1010 at gmail.com (Eric Goddard)
Date: Fri, 2 May 2014 14:57:52 -0500
Subject: [gdal-dev] FileGDB feature datasets
In-Reply-To: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>
References: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>
Message-ID: <CAMM2+Yo5eAJcJ63psCMOCsJTtk8MR0s3eZf6N4dx+Kd-po2JFw@mail.gmail.com>

I've been able to open feature classes within datasets, and there is
an option to specify the feature dataset under the layer creation
options (http://www.gdal.org/ogr/drv_filegdb.html). It might be a
custom projection issue -- the FileGDB driver doesn't support custom
projections, and if one is present then none of the features in the
geodatabase can be read. There was a similar post on the QGIS mailing
list: http://osgeo-org.1560.x6.nabble.com/Problem-opening-GDB-v-10-1-using-QGIS-td5131380.html#a5133625

Eric

On Fri, May 2, 2014 at 2:44 PM, William Kyngesburye
<woklist at kyngchaos.com> wrote:
> For a while I've been converting FileGDB v9 files to v10 with Arc (export to GDB multiple) so I can read them with GDAL (1.10).  This works fine, the conversion creates a flat GDB, though the original GDB has the data grouped in feature datasets.
>
> I just got some v10 GDBs, so no conversion needed, right?  Nothing is visible with GDAL.  They also have data divided into feature datasets within the GDB, so it sounds like GDAL can't acces the dataset groups.  Unless I'm missing an option (the GDAL docs for the FileGDB format don't mention datasets)?
>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> "Mon Dieu! but they are all alike.  Cheating, murdering, lying, fighting, and all for things that the beasts of the jungle would not deign to possess - money to purchase the effeminate pleasures of weaklings.  And yet withal bound down by silly customs that make them slaves to their unhappy lot while firm in the belief that they be the lords of creation enjoying the only real pleasures of existence....
>
> - the wisdom of Tarzan
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From kyle at pobox.com  Fri May  2 12:58:48 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Fri, 2 May 2014 13:58:48 -0600
Subject: [gdal-dev] FileGDB feature datasets
In-Reply-To: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>
References: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>
Message-ID: <CAJ0mEz2KeSRYKHOYRwZfN5rvRqCOcr4qKN-Rvmae=U_tuZ-ong@mail.gmail.com>

William,

On Fri, May 2, 2014 at 1:44 PM, William Kyngesburye
<woklist at kyngchaos.com> wrote:
> For a while I've been converting FileGDB v9 files to v10 with Arc (export to GDB multiple) so I can read them with GDAL (1.10).  This works fine, the conversion creates a flat GDB, though the original GDB has the data grouped in feature datasets.
>
> I just got some v10 GDBs, so no conversion needed, right?  Nothing is visible with GDAL.  They also have data divided into feature datasets within the GDB, so it sounds like GDAL can't acces the dataset groups.  Unless I'm missing an option (the GDAL docs for the FileGDB format don't mention datasets)?

Do you have non-standard SRS in the layers?  FileGDB driver can't see
some layers if that is the case, see:

http://trac.osgeo.org/gdal/ticket/4578

However, with 1.11, there is an OpenFileGDB driver that should be able
to pick up the layers in that case (and read version 9 gdb).

http://gdal.org/ogr/drv_openfilegdb.html

I doubt the FileGDB driver can write them though, and OpenFileGDB is
read-only.  You may be able to reproject them though.

If the SRS issue isn't the case, trying 1.11.0 and OpenFileGDB wouldn't hurt.

>
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
>
> "Mon Dieu! but they are all alike.  Cheating, murdering, lying, fighting, and all for things that the beasts of the jungle would not deign to possess - money to purchase the effeminate pleasures of weaklings.  And yet withal bound down by silly customs that make them slaves to their unhappy lot while firm in the belief that they be the lords of creation enjoying the only real pleasures of existence....
>
> - the wisdom of Tarzan
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From woklist at kyngchaos.com  Fri May  2 13:06:36 2014
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Fri, 2 May 2014 15:06:36 -0500
Subject: [gdal-dev] FileGDB feature datasets
In-Reply-To: <CAJ0mEz2KeSRYKHOYRwZfN5rvRqCOcr4qKN-Rvmae=U_tuZ-ong@mail.gmail.com>
References: <73E248C3-B056-47A2-B468-B1C9096A2727@kyngchaos.com>
	<CAJ0mEz2KeSRYKHOYRwZfN5rvRqCOcr4qKN-Rvmae=U_tuZ-ong@mail.gmail.com>
Message-ID: <DE7075F7-E6A5-4022-9218-6AA5BBC74250@kyngchaos.com>

Ah, that's probably the problem.  They use the "standard" US Albers, but using the ESRI custom code instead of the EPSG version.

On May 2, 2014, at 2:58 PM, Kyle Shannon <kyle at pobox.com> wrote:

> William,
> 
> On Fri, May 2, 2014 at 1:44 PM, William Kyngesburye
> <woklist at kyngchaos.com> wrote:
>> For a while I've been converting FileGDB v9 files to v10 with Arc (export to GDB multiple) so I can read them with GDAL (1.10).  This works fine, the conversion creates a flat GDB, though the original GDB has the data grouped in feature datasets.
>> 
>> I just got some v10 GDBs, so no conversion needed, right?  Nothing is visible with GDAL.  They also have data divided into feature datasets within the GDB, so it sounds like GDAL can't acces the dataset groups.  Unless I'm missing an option (the GDAL docs for the FileGDB format don't mention datasets)?
> 
> Do you have non-standard SRS in the layers?  FileGDB driver can't see
> some layers if that is the case, see:
> 
> http://trac.osgeo.org/gdal/ticket/4578
> 
> However, with 1.11, there is an OpenFileGDB driver that should be able
> to pick up the layers in that case (and read version 9 gdb).
> 
> http://gdal.org/ogr/drv_openfilegdb.html
> 
> I doubt the FileGDB driver can write them though, and OpenFileGDB is
> read-only.  You may be able to reproject them though.
> 
> If the SRS issue isn't the case, trying 1.11.0 and OpenFileGDB wouldn't hurt.
> 
>> 
>> -----
>> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
>> http://www.kyngchaos.com/
>> 
>> "Mon Dieu! but they are all alike.  Cheating, murdering, lying, fighting, and all for things that the beasts of the jungle would not deign to possess - money to purchase the effeminate pleasures of weaklings.  And yet withal bound down by silly customs that make them slaves to their unhappy lot while firm in the belief that they be the lords of creation enjoying the only real pleasures of existence....
>> 
>> - the wisdom of Tarzan
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Kyle
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

The equator is so long, it could encircle the earth completely once.


From jukka.rahkonen at mmmtike.fi  Sat May  3 13:51:16 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Sat, 3 May 2014 20:51:16 +0000 (UTC)
Subject: [gdal-dev] ogr2ogr -f OCI fails on Windows
References: <CA+Ei1OfSQykhiArHV-UUSJYSCMb8exvd8+9vDNfV4D29EYVsqw@mail.gmail.com>,
	<BLU173-W132609D54781D1500D9BC790530@phx.gbl>,
	<CA+Ei1OdvWJxks3f9xYFG-imx9BonmTdRTdEP1NOBEdu6=KSJ3g@mail.gmail.com>,
	<BLU173-W31B726EBD5F7C4E8152704905D0@phx.gbl>,
	<CA+Ei1Oentsz01BVvKUkZtUL+OnzL-0x+aEwLKwwxi_Ouga0L4w@mail.gmail.com>
	<BLU173-W14E529F4DA3398CFCAF89890430@phx.gbl>
Message-ID: <loom.20140503T224628-504@post.gmane.org>

Ivan Lucena <lucena_ivan <at> hotmail.com> writes:

> 
> Hi Martin,Here is a list of the issues that I am planning to fix on that
driver, once I have time, bur if you think they are important for you too we
can share the work. The first item you have already started but you might
think of adding that line to the session initialization:

Hi,

I have one more thing for the list:
6) Handle character encoding in some understandable way.

I have learned one exact way to save shapefiles into our Oracle so that the
Scandinavian characters ?????? are OK in the database:

a) Convert shapefiles into Spatialite
b) Set environment set NLS_LANG=AMERICAN_AMERICA.AL32UTF8
c) Convert data from Spatialite into Oracle

I have never had luck with direct conversion from shp into Oracle.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Sat May  3 14:05:22 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 3 May 2014 23:05:22 +0200
Subject: [gdal-dev] Help request to make Python bindings to build again
	with MacOS X 10.9
In-Reply-To: <F0998D54-4A66-48F3-B90D-D2CAFC967585@kyngchaos.com>
References: <201404191822.22260.even.rouault@mines-paris.org>
	<1397986799.535395ef3207e@imp.free.fr>
	<F0998D54-4A66-48F3-B90D-D2CAFC967585@kyngchaos.com>
Message-ID: <201405032305.23221.even.rouault@mines-paris.org>

 
> Maybe there is something weird in the Travis system.

They must have changed something to fix it, since builds now pass.

> 
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
> 
> "Time is an illusion - lunchtime doubly so."
> 
> - Ford Prefect

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mwtoews at gmail.com  Sat May  3 21:03:28 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Sun, 4 May 2014 16:03:28 +1200
Subject: [gdal-dev] Add to PythonGotchas: saving and closing raster datasets
Message-ID: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>

Hi,

This seems to be a common gotcha: http://gis.stackexchange.com/q/93212/1872

I've been caught by it before, and I'm certain many others have too.
This is a gotcha since "WriteArray" doesn't write the array to disk,
but rather it is written when the dataset object is dereferenced. I've
drafted up an entry for the wiki, which could be placed before
"Certain objects contain a Destroy() method, but you should never use
it".

Furthermore, I'm unsure of the best way to demonstrate how to
dereference Python objects. The wiki has two different styles:
    obj = None
or
    del obj

I'm unsure of which is regarded best practice, but encourage
consistency. Please edit as necessary or reply with suggestions.

-Mike


=== Saving and closing datasets ===

To save and close raster datasets, the object needs to be
dereferenced, such as setting it to `None`. It is not written with
{{{WriteArray}}}. For example:
{{{
from osgeo import gdal
driver = gdal.GetDriverByName('GTiff')
dst_ds = driver.Create('new.tif', 10, 15)
band = dst_ds.GetRasterBand(1)
arr = band.ReadAsArray()  # raster values are all zero
arr[2,4:] = 50  # modify some data
band.WriteArray(arr)  # raster file still unmodified
band = None  # dereference band to avoid gotcha described previously
dst_ds = None  # save, close
}}}
The last dereference to the raster dataset writes the data
modifications and closes the raster file. The objects may also be
dereferenced using: {{{del band, dst_ds}}}

From even.rouault at mines-paris.org  Sun May  4 01:40:50 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 4 May 2014 10:40:50 +0200
Subject: [gdal-dev] Add to PythonGotchas: saving and closing raster
	datasets
In-Reply-To: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>
References: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>
Message-ID: <201405041040.50539.even.rouault@mines-paris.org>

Le dimanche 04 mai 2014 06:03:28, Mike Toews a ?crit :
> Hi,
> 
> This seems to be a common gotcha: http://gis.stackexchange.com/q/93212/1872
> 
> I've been caught by it before, and I'm certain many others have too.
> This is a gotcha since "WriteArray" doesn't write the array to disk,
> but rather it is written when the dataset object is dereferenced. 

That depends on the size of the GDAL block cache and your dataset. The real 
answer is that if your dataset uncompressed size is below the GDAL block cache 
size (40 MB by default), nothing will hit the disk just after WriteArray(). If 
your dataset is larger, then blocks will be partially written to disk. But in 
any case, you are right, the only way to be sure that a dataset is reliably 
written to disk (such as being in a state to be readable by another process) 
is to close it properly. FlushCache() might not even be enough in some cases 
(it depends on drivers)

> I've
> drafted up an entry for the wiki, which could be placed before
> "Certain objects contain a Destroy() method, but you should never use
> it".
> 
> Furthermore, I'm unsure of the best way to demonstrate how to
> dereference Python objects. The wiki has two different styles:
>     obj = None
> or
>     del obj
> 
> I'm unsure of which is regarded best practice, but encourage
> consistency. Please edit as necessary or reply with suggestions.

Python purists will say that both are not really ideal from a clearness point 
of view ( http://sgillies.net/blog/2013/12/17/teaching-python-gis-users-to-be-
more-rational.html ), but there's no really other alternative in the API, 
so...

> 
> -Mike
> 
> 
> === Saving and closing datasets ===
> 
> To save and close raster datasets, the object needs to be
> dereferenced, such as setting it to `None`. It is not written with
> {{{WriteArray}}}. For example:
> {{{
> from osgeo import gdal
> driver = gdal.GetDriverByName('GTiff')
> dst_ds = driver.Create('new.tif', 10, 15)
> band = dst_ds.GetRasterBand(1)
> arr = band.ReadAsArray()  # raster values are all zero
> arr[2,4:] = 50  # modify some data
> band.WriteArray(arr)  # raster file still unmodified
> band = None  # dereference band to avoid gotcha described previously
> dst_ds = None  # save, close
> }}}
> The last dereference to the raster dataset writes the data
> modifications and closes the raster file. The objects may also be
> dereferenced using: {{{del band, dst_ds}}}
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gdal-dev-list-mail at alintech.com.au  Sun May  4 19:04:42 2014
From: gdal-dev-list-mail at alintech.com.au (Wilson Waters)
Date: Mon, 05 May 2014 10:04:42 +0800
Subject: [gdal-dev] ERDAS/Intergraph/Hexagon ECW/JP2 v4.3 compile in 1.11
Message-ID: <5366F1BA.4020107@alintech.com.au>

Hi all,

I think there might be a build bug in GDAL 1.11.0 with the ERDAS ECW/JP2 
v4.3 driver in read/write mode.

My problem was identical to this post from a year ago 
http://lists.osgeo.org/pipermail/gdal-dev/2013-June/036565.html

I get the following error
jp2userbox.cpp(133) : error C2664: 'NCS::JP2::CBox::UnParse' : cannot 
convert parameter 1 from 'NCS::SDK::CFileBase' to 'NCS::JP2::CFile &'

After some amount of digging through the ecw driver and SDK include 
files the only way I could get it to compile was changing the definition 
UnParse() in jp2userbox.cpp and gdal_ecw.h
CNCSError JP2UserBox::UnParse( NCS::SDK::CFileBase &JP2File,
                                NCS::CIOStream &Stream )
to
CNCSError JP2UserBox::UnParse( NCS::JP2::CFile &JP2File,
                                NCS::CIOStream &Stream )

It doesn't look like NCS::JP2::CFile isn't in the same inheritance tree 
as NCS::SDK::CFileBase? Although I must be missing something because I 
later found that undefining HAVE_COMPRESS in nmake.opt builds fine...

I'm not sure what other problems this will cause, but it seems to be 
working for us. I'm going to guess this change breaks build with ECW SDK 
v5 though so maybe it needs a few more #defines?

Cheers,
Wilson.

From sean at mapbox.com  Mon May  5 09:18:34 2014
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 05 May 2014 10:18:34 -0600
Subject: [gdal-dev] Add to PythonGotchas: saving and closing raster
	datasets
In-Reply-To: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>
References: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>
Message-ID: <5367B9DA.4040809@mapbox.com>

Hi Mike,

On 5/3/14, 10:03 PM, Mike Toews wrote:
> Hi,
>
> This seems to be a common gotcha: http://gis.stackexchange.com/q/93212/1872
>
> I've been caught by it before, and I'm certain many others have too.
> This is a gotcha since "WriteArray" doesn't write the array to disk,
> but rather it is written when the dataset object is dereferenced. I've
> drafted up an entry for the wiki, which could be placed before
> "Certain objects contain a Destroy() method, but you should never use
> it".
>
> Furthermore, I'm unsure of the best way to demonstrate how to
> dereference Python objects. The wiki has two different styles:
>      obj = None
> or
>      del obj
>
> I'm unsure of which is regarded best practice, but encourage
> consistency. Please edit as necessary or reply with suggestions.
>
> -Mike

The thing is that `obj = None` and `del obj` only cause the file to be 
written (indirectly) if there are no other references to the Dataset 
object. In which case `obj = "Close!"` works just as well ;)

If your code did something like `obj2 = obj` then neither `obj = None` 
nor `del obj` will result in the file being closed because the Dataset 
object will still have a live reference (obj2).

-- 
Sean Gillies
sean at mapbox.com

From mcoletti at gmail.com  Mon May  5 12:56:04 2014
From: mcoletti at gmail.com (Mark Coletti)
Date: Mon, 5 May 2014 15:56:04 -0400
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
Message-ID: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>

Safecast is user sourced radiation data, and has a public API serving data
in GeoJSON format (https://api.safecast.org/en-US/home).  However, I'm
having difficulty in accessing this data via OGR:

% ogrinfo -so "
https://api.safecast.org/en-US/measurements?distance=10&latitude=37.42&longitude=141.033
"
ERROR 4: Failed to read GeoJSON data
ERROR 4: Failed to read GeoJSON data
FAILURE:
Unable to open datasource `
https://api.safecast.org/measurements.json?distance=10&latitude=37.42&longitude=141.033'
with the following drivers.

So OGR sees that the data is formatted as GeoJSON, but is unable to read it
for some reason.

Using curl to manually make the query I get:

% curl  -i -H "Accept: application/json" "
https://api.safecast.org/en-US/measurements?distance=10&latitude=37.42&longitude=141.033
"
HTTP/1.1 200 OK
Server: nginx
Date: Mon, 05 May 2014 19:43:55 GMT
Content-Type: application/json; charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Status: 200 OK
Strict-Transport-Security: max-age=31536000
Access-Control-Allow-Origin: safecast.org
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: *, X-Requested-With
Access-Control-Max-Age: 100000
X-UA-Compatible: IE=Edge,chrome=1
ETag: "e4650539a53d3698d8deb02e912b9ae3"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
X-Runtime: 0.022855
X-Rack-Cache: miss
X-Powered-By: cloud66

[{"captured_at":"2014-01-30T05:03:25Z","device_id":null,"id":30981293,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":4675.0,"latitude":37.41997666666666,"longitude":141.03297166666667},{"captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":30981556,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":2470.0,"latitude":37.42001666666667,"longitude":141.03303666666667},{"captured_at":"2014-01-30T05:00:54Z","device_id":null,"id":30981263,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5428.0,"latitude":37.41996666666667,"longitude":141.03301666666667},{"captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":30981507,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":12191.0,"latitude":37.420003333333334,"longitude":141.03305333333333},{"captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":30981262,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5199.0,"latitude":37.41999666666667,"longitude":141.03306166666667},{"captured_at":"2014-01-30T05:25:21Z","device_id":null,"id":30981555,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":2423.0,"latitude":37.42006833333333,"longitude":141.03301333333334},{"captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":30981294,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":4456.0,"latitude":37.41992833333333,"longitude":141.03297333333333},{"captured_at":"2014-01-30T05:00:59Z","device_id":null,"id":30981264,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5672.0,"latitude":37.419963333333335,"longitude":141.03291666666667},{"captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":30981261,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5135.0,"latitude":37.420035,"longitude":141.03309},{"captured_at":"2014-01-30T05:21:14Z","device_id":null,"id":30981506,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude":141.03293666666667}]

Those do look like legitimate observations, but I don't know if they comply
to the GeoJSON format since I'm new to JSON.

I'm using this version of GDAL/OGR, which was part of the pre-packaged
binaries for qgis for my Mac:
% ogrinfo --version
GDAL 1.10.1, released 2013/08/26

Eventually I'd like to use GDAL/OGR to conveniently create a local spatial
database from such a query.  However, I need to get over this hurdle first.

Cheers,

Mark
-- 
mcoletti at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140505/f45c3718/attachment.html>

From even.rouault at mines-paris.org  Mon May  5 13:11:08 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 5 May 2014 22:11:08 +0200
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
Message-ID: <201405052211.08418.even.rouault@mines-paris.org>

Le lundi 05 mai 2014 21:56:04, Mark Coletti a ?crit :
> Safecast is user sourced radiation data, and has a public API serving data
> in GeoJSON format (https://api.safecast.org/en-US/home).  However, I'm
> having difficulty in accessing this data via OGR:

Mark,

This is JSON, but not GeoJSON (the GeoJSON spec is here 
http://geojson.org/geojson-spec.html if you want to convince yourself). Hence 
the driver cannot read it.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From sean at mapbox.com  Mon May  5 13:12:26 2014
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 05 May 2014 14:12:26 -0600
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
Message-ID: <5367F0AA.2020902@mapbox.com>

Hi Mark,

Safecast's JSON isn't GeoJSON, but wouldn't be too hard to crosswalk 
over to GeoJSON... make a geometry from its latitude/longitude, stuff 
all the other attributes in properties.

On 5/5/14, 1:56 PM, Mark Coletti wrote:
>
> Safecast is user sourced radiation data, and has a public API serving
> data in GeoJSON format (https://api.safecast.org/en-US/home).  However,
> I'm having difficulty in accessing this data via OGR:
>
> % ogrinfo -so
> "https://api.safecast.org/en-US/measurements?distance=10&latitude=37.42&longitude=141.033"
> ERROR 4: Failed to read GeoJSON data
> ERROR 4: Failed to read GeoJSON data
> FAILURE:
> Unable to open datasource
> `https://api.safecast.org/measurements.json?distance=10&latitude=37.42&longitude=141.033'
> with the following drivers.
>
> So OGR sees that the data is formatted as GeoJSON, but is unable to read
> it for some reason.
>
> Using curl to manually make the query I get:
>
> % curl  -i -H "Accept: application/json"
> "https://api.safecast.org/en-US/measurements?distance=10&latitude=37.42&longitude=141.033"
> HTTP/1.1 200 OK
> Server: nginx
> Date: Mon, 05 May 2014 19:43:55 GMT
> Content-Type: application/json; charset=utf-8
> Transfer-Encoding: chunked
> Connection: keep-alive
> Status: 200 OK
> Strict-Transport-Security: max-age=31536000
> Access-Control-Allow-Origin: safecast.org <http://safecast.org>
> Access-Control-Allow-Methods: POST, GET, OPTIONS
> Access-Control-Allow-Headers: *, X-Requested-With
> Access-Control-Max-Age: 100000
> X-UA-Compatible: IE=Edge,chrome=1
> ETag: "e4650539a53d3698d8deb02e912b9ae3"
> Cache-Control: max-age=0, private, must-revalidate
> X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
> X-Runtime: 0.022855
> X-Rack-Cache: miss
> X-Powered-By: cloud66
>
> [{"captured_at":"2014-01-30T05:03:25Z","device_id":null,"id":30981293,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":4675.0,"latitude":37.41997666666666,"longitude":141.03297166666667},{"captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":30981556,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":2470.0,"latitude":37.42001666666667,"longitude":141.03303666666667},{"captured_at":"2014-01-30T05:00:54Z","device_id":null,"id":30981263,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5428.0,"latitude":37.41996666666667,"longitude":141.03301666666667},{"captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":30981507,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":12191.0,"latitude":37.420003333333334,"longitude":141.03305333333333},{"captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":30981262,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5199.0,"lati
tude":37.41999666666667,"longitude":141.03306166666667},{"captured_at":"2014-01-30T05:25:21Z","device_id":null,"id":30981555,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":2423.0,"latitude":37.42006833333333,"longitude":141.03301333333334},{"captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":30981294,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":4456.0,"latitude":37.41992833333333,"longitude":141.03297333333333},{"captured_at":"2014-01-30T05:00:59Z","device_id":null,"id":30981264,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5672.0,"latitude":37.419963333333335,"longitude":141.03291666666667},{"captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":30981261,"location_name":null,"original_id":null,"unit":"cpm","user_id":3,"value":5135.0,"latitude":37.420035,"longitude":141.03309},{"captured_at":"2014-01-30T05:21:14Z","device_id":null,"id":30981506,"location_name":null,"original_id":null,"unit":"cp
m","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude":141.03293666666667}]
>
> Those do look like legitimate observations, but I don't know if they
> comply to the GeoJSON format since I'm new to JSON.
>
> I'm using this version of GDAL/OGR, which was part of the pre-packaged
> binaries for qgis for my Mac:
> % ogrinfo --version
> GDAL 1.10.1, released 2013/08/26
>
> Eventually I'd like to use GDAL/OGR to conveniently create a local
> spatial database from such a query.  However, I need to get over this
> hurdle first.
>
> Cheers,
>
> Mark
> --
> mcoletti at gmail.com <mailto:mcoletti at gmail.com>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Sean Gillies
sean at mapbox.com

From mcoletti at gmail.com  Mon May  5 13:29:13 2014
From: mcoletti at gmail.com (Mark Coletti)
Date: Mon, 5 May 2014 16:29:13 -0400
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <5367F0AA.2020902@mapbox.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
	<5367F0AA.2020902@mapbox.com>
Message-ID: <CAHpqhBProLQ3pU6FDOjhyNWJdy9M23dDs1tygzm5gWNtccWKSQ@mail.gmail.com>

Thank you Even and Sean for your very quick and salient replies!  I'll
notify the Safecast folks that their data might be better served using
GeoJSON; meanwhile, they also make their open source data available as a
single downloadable file in CSV format.  Since qgis can import files of
that type, I've been using that; it's just that I have to do a lot more
work on my end to pare the data down to the region of interest.  (And deal
with the inevitable data corruption.  E.g., I suspect the observations from
2020 are bogus unless they have a time traveler volunteering radiation
readings. =) )

Again, thank you for your help!

Cheers,

Mark


On Mon, May 5, 2014 at 4:12 PM, Sean Gillies <sean at mapbox.com> wrote:

> Hi Mark,
>
> Safecast's JSON isn't GeoJSON, but wouldn't be too hard to crosswalk over
> to GeoJSON... make a geometry from its latitude/longitude, stuff all the
> other attributes in properties.
>
>
> On 5/5/14, 1:56 PM, Mark Coletti wrote:
>
>>
>> Safecast is user sourced radiation data, and has a public API serving
>> data in GeoJSON format (https://api.safecast.org/en-US/home).  However,
>> I'm having difficulty in accessing this data via OGR:
>>
>> % ogrinfo -so
>> "https://api.safecast.org/en-US/measurements?distance=10&
>> latitude=37.42&longitude=141.033"
>> ERROR 4: Failed to read GeoJSON data
>> ERROR 4: Failed to read GeoJSON data
>> FAILURE:
>> Unable to open datasource
>> `https://api.safecast.org/measurements.json?distance=10&
>> latitude=37.42&longitude=141.033'
>> with the following drivers.
>>
>> So OGR sees that the data is formatted as GeoJSON, but is unable to read
>> it for some reason.
>>
>> Using curl to manually make the query I get:
>>
>> % curl  -i -H "Accept: application/json"
>> "https://api.safecast.org/en-US/measurements?distance=10&
>> latitude=37.42&longitude=141.033"
>> HTTP/1.1 200 OK
>> Server: nginx
>> Date: Mon, 05 May 2014 19:43:55 GMT
>> Content-Type: application/json; charset=utf-8
>> Transfer-Encoding: chunked
>> Connection: keep-alive
>> Status: 200 OK
>> Strict-Transport-Security: max-age=31536000
>> Access-Control-Allow-Origin: safecast.org <http://safecast.org>
>>
>> Access-Control-Allow-Methods: POST, GET, OPTIONS
>> Access-Control-Allow-Headers: *, X-Requested-With
>> Access-Control-Max-Age: 100000
>> X-UA-Compatible: IE=Edge,chrome=1
>> ETag: "e4650539a53d3698d8deb02e912b9ae3"
>> Cache-Control: max-age=0, private, must-revalidate
>> X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
>> X-Runtime: 0.022855
>> X-Rack-Cache: miss
>> X-Powered-By: cloud66
>>
>> [{"captured_at":"2014-01-30T05:03:25Z","device_id":
>> null,"id":30981293,"location_name":null,"original_id":null,
>> "unit":"cpm","user_id":3,"value":4675.0,"latitude":37.
>> 41997666666666,"longitude":141.03297166666667},{"
>> captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":
>> 30981556,"location_name":null,"original_id":null,"unit":"
>> cpm","user_id":3,"value":2470.0,"latitude":37.42001666666667,"longitude":
>> 141.03303666666667},{"captured_at":"2014-01-30T05:
>> 00:54Z","device_id":null,"id":30981263,"location_name":null,
>> "original_id":null,"unit":"cpm","user_id":3,"value":5428.0,"latitude":37.
>> 41996666666667,"longitude":141.03301666666667},{"
>> captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":
>> 30981507,"location_name":null,"original_id":null,"unit":"
>> cpm","user_id":3,"value":12191.0,"latitude":37.
>> 420003333333334,"longitude":141.03305333333333},{"
>> captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":
>> 30981262,"location_name":null,"original_id":null,"unit":"
>> cpm","user_id":3,"value":5199.0,"lat
>>
> i
> tude":37.41999666666667,"longitude":141.03306166666667}
> ,{"captured_at":"2014-01-30T05:25:21Z","device_id":
> null,"id":30981555,"location_name":null,"original_id":null,
> "unit":"cpm","user_id":3,"value":2423.0,"latitude":37.
> 42006833333333,"longitude":141.03301333333334},{"
> captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":
> 30981294,"location_name":null,"original_id":null,"unit":"
> cpm","user_id":3,"value":4456.0,"latitude":37.41992833333333,"longitude":
> 141.03297333333333},{"captured_at":"2014-01-30T05:
> 00:59Z","device_id":null,"id":30981264,"location_name":null,
> "original_id":null,"unit":"cpm","user_id":3,"value":5672.0,"latitude":37.
> 419963333333335,"longitude":141.03291666666667},{"
> captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":
> 30981261,"location_name":null,"original_id":null,"unit":"
> cpm","user_id":3,"value":5135.0,"latitude":37.420035,"
> longitude":141.03309},{"captured_at":"2014-01-30T05:
> 21:14Z","device_id":null,"id":30981506,"location_name":null,
> "original_id":null,"unit":"c
> p
> m","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude":
> 141.03293666666667}]
>
>>
>> Those do look like legitimate observations, but I don't know if they
>> comply to the GeoJSON format since I'm new to JSON.
>>
>> I'm using this version of GDAL/OGR, which was part of the pre-packaged
>> binaries for qgis for my Mac:
>> % ogrinfo --version
>> GDAL 1.10.1, released 2013/08/26
>>
>> Eventually I'd like to use GDAL/OGR to conveniently create a local
>> spatial database from such a query.  However, I need to get over this
>> hurdle first.
>>
>> Cheers,
>>
>> Mark
>> --
>> mcoletti at gmail.com <mailto:mcoletti at gmail.com>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
> --
> Sean Gillies
> sean at mapbox.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
mcoletti at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140505/99107e05/attachment-0001.html>

From david.fawcett at gmail.com  Mon May  5 13:43:22 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Mon, 5 May 2014 15:43:22 -0500
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAHpqhBProLQ3pU6FDOjhyNWJdy9M23dDs1tygzm5gWNtccWKSQ@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
	<5367F0AA.2020902@mapbox.com>
	<CAHpqhBProLQ3pU6FDOjhyNWJdy9M23dDs1tygzm5gWNtccWKSQ@mail.gmail.com>
Message-ID: <CAF7K3b8ZozNGL0Xunt_F70oOHMchNa2SXr8k7joTZMfm49K6sw@mail.gmail.com>

Mark,

You could use the GDAL/OGR .csv driver with a VRT to access the data and
spit it out into a different, filtered file.

http://www.gdal.org/ogr/drv_csv.html

You could also use the VSI to pull from a .zip'd file via URL.

You could also likely use args with ogr2ogr to filter by attribute or bbox,
and even reproject the data on the way out.

http://www.gdal.org/ogr2ogr.html

David.


On Mon, May 5, 2014 at 3:29 PM, Mark Coletti <mcoletti at gmail.com> wrote:

> Thank you Even and Sean for your very quick and salient replies!  I'll
> notify the Safecast folks that their data might be better served using
> GeoJSON; meanwhile, they also make their open source data available as a
> single downloadable file in CSV format.  Since qgis can import files of
> that type, I've been using that; it's just that I have to do a lot more
> work on my end to pare the data down to the region of interest.  (And deal
> with the inevitable data corruption.  E.g., I suspect the observations from
> 2020 are bogus unless they have a time traveler volunteering radiation
> readings. =) )
>
> Again, thank you for your help!
>
> Cheers,
>
> Mark
>
>
> On Mon, May 5, 2014 at 4:12 PM, Sean Gillies <sean at mapbox.com> wrote:
>
>> Hi Mark,
>>
>> Safecast's JSON isn't GeoJSON, but wouldn't be too hard to crosswalk over
>> to GeoJSON... make a geometry from its latitude/longitude, stuff all the
>> other attributes in properties.
>>
>>
>> On 5/5/14, 1:56 PM, Mark Coletti wrote:
>>
>>>
>>> Safecast is user sourced radiation data, and has a public API serving
>>> data in GeoJSON format (https://api.safecast.org/en-US/home).  However,
>>> I'm having difficulty in accessing this data via OGR:
>>>
>>> % ogrinfo -so
>>> "https://api.safecast.org/en-US/measurements?distance=10&
>>> latitude=37.42&longitude=141.033"
>>> ERROR 4: Failed to read GeoJSON data
>>> ERROR 4: Failed to read GeoJSON data
>>> FAILURE:
>>> Unable to open datasource
>>> `https://api.safecast.org/measurements.json?distance=10&
>>> latitude=37.42&longitude=141.033'
>>> with the following drivers.
>>>
>>> So OGR sees that the data is formatted as GeoJSON, but is unable to read
>>> it for some reason.
>>>
>>> Using curl to manually make the query I get:
>>>
>>> % curl  -i -H "Accept: application/json"
>>> "https://api.safecast.org/en-US/measurements?distance=10&
>>> latitude=37.42&longitude=141.033"
>>> HTTP/1.1 200 OK
>>> Server: nginx
>>> Date: Mon, 05 May 2014 19:43:55 GMT
>>> Content-Type: application/json; charset=utf-8
>>> Transfer-Encoding: chunked
>>> Connection: keep-alive
>>> Status: 200 OK
>>> Strict-Transport-Security: max-age=31536000
>>> Access-Control-Allow-Origin: safecast.org <http://safecast.org>
>>>
>>> Access-Control-Allow-Methods: POST, GET, OPTIONS
>>> Access-Control-Allow-Headers: *, X-Requested-With
>>> Access-Control-Max-Age: 100000
>>> X-UA-Compatible: IE=Edge,chrome=1
>>> ETag: "e4650539a53d3698d8deb02e912b9ae3"
>>> Cache-Control: max-age=0, private, must-revalidate
>>> X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
>>> X-Runtime: 0.022855
>>> X-Rack-Cache: miss
>>> X-Powered-By: cloud66
>>>
>>> [{"captured_at":"2014-01-30T05:03:25Z","device_id":
>>> null,"id":30981293,"location_name":null,"original_id":null,
>>> "unit":"cpm","user_id":3,"value":4675.0,"latitude":37.
>>> 41997666666666,"longitude":141.03297166666667},{"
>>> captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":
>>> 30981556,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":2470.0,"latitude":37.
>>> 42001666666667,"longitude":141.03303666666667},{"
>>> captured_at":"2014-01-30T05:00:54Z","device_id":null,"id":
>>> 30981263,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":5428.0,"latitude":37.
>>> 41996666666667,"longitude":141.03301666666667},{"
>>> captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":
>>> 30981507,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":12191.0,"latitude":37.
>>> 420003333333334,"longitude":141.03305333333333},{"
>>> captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":
>>> 30981262,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":5199.0,"lat
>>>
>> i
>> tude":37.41999666666667,"longitude":141.03306166666667}
>> ,{"captured_at":"2014-01-30T05:25:21Z","device_id":
>> null,"id":30981555,"location_name":null,"original_id":null,
>> "unit":"cpm","user_id":3,"value":2423.0,"latitude":37.
>> 42006833333333,"longitude":141.03301333333334},{"
>> captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":
>> 30981294,"location_name":null,"original_id":null,"unit":"
>> cpm","user_id":3,"value":4456.0,"latitude":37.41992833333333,"longitude":
>> 141.03297333333333},{"captured_at":"2014-01-30T05:
>> 00:59Z","device_id":null,"id":30981264,"location_name":null,
>> "original_id":null,"unit":"cpm","user_id":3,"value":5672.0,"latitude":37.
>> 419963333333335,"longitude":141.03291666666667},{"
>> captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":
>> 30981261,"location_name":null,"original_id":null,"unit":"
>> cpm","user_id":3,"value":5135.0,"latitude":37.420035,"
>> longitude":141.03309},{"captured_at":"2014-01-30T05:
>> 21:14Z","device_id":null,"id":30981506,"location_name":null,
>> "original_id":null,"unit":"c
>> p
>> m","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude":
>> 141.03293666666667}]
>>
>>>
>>> Those do look like legitimate observations, but I don't know if they
>>> comply to the GeoJSON format since I'm new to JSON.
>>>
>>> I'm using this version of GDAL/OGR, which was part of the pre-packaged
>>> binaries for qgis for my Mac:
>>> % ogrinfo --version
>>> GDAL 1.10.1, released 2013/08/26
>>>
>>> Eventually I'd like to use GDAL/OGR to conveniently create a local
>>> spatial database from such a query.  However, I need to get over this
>>> hurdle first.
>>>
>>> Cheers,
>>>
>>> Mark
>>> --
>>> mcoletti at gmail.com <mailto:mcoletti at gmail.com>
>>>
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>> --
>> Sean Gillies
>> sean at mapbox.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> mcoletti at gmail.com
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140505/2bfbf467/attachment.html>

From david.fawcett at gmail.com  Mon May  5 13:57:12 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Mon, 5 May 2014 15:57:12 -0500
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAF7K3b8ZozNGL0Xunt_F70oOHMchNa2SXr8k7joTZMfm49K6sw@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
	<5367F0AA.2020902@mapbox.com>
	<CAHpqhBProLQ3pU6FDOjhyNWJdy9M23dDs1tygzm5gWNtccWKSQ@mail.gmail.com>
	<CAF7K3b8ZozNGL0Xunt_F70oOHMchNa2SXr8k7joTZMfm49K6sw@mail.gmail.com>
Message-ID: <CAF7K3b_yLxyVtfy-6f31UUfvmYT0oEqhigQyfAcky697GJGOzg@mail.gmail.com>

On second thought, I see that the .csv file is 2.1 gb!  I would suggest not
following the .csv driver approach.

I would follow Sean's suggestion and just use some simple Python (or
whatever language that you want to use to consume the data) to grab the  XY
values and write out geometries.

David.

Note to self:  When Sean suggests something, just hit +1 and hold tongue...


On Mon, May 5, 2014 at 3:43 PM, David Fawcett <david.fawcett at gmail.com>wrote:

> Mark,
>
> You could use the GDAL/OGR .csv driver with a VRT to access the data and
> spit it out into a different, filtered file.
>
> http://www.gdal.org/ogr/drv_csv.html
>
> You could also use the VSI to pull from a .zip'd file via URL.
>
> You could also likely use args with ogr2ogr to filter by attribute or
> bbox, and even reproject the data on the way out.
>
> http://www.gdal.org/ogr2ogr.html
>
> David.
>
>
> On Mon, May 5, 2014 at 3:29 PM, Mark Coletti <mcoletti at gmail.com> wrote:
>
>> Thank you Even and Sean for your very quick and salient replies!  I'll
>> notify the Safecast folks that their data might be better served using
>> GeoJSON; meanwhile, they also make their open source data available as a
>> single downloadable file in CSV format.  Since qgis can import files of
>> that type, I've been using that; it's just that I have to do a lot more
>> work on my end to pare the data down to the region of interest.  (And deal
>> with the inevitable data corruption.  E.g., I suspect the observations from
>> 2020 are bogus unless they have a time traveler volunteering radiation
>> readings. =) )
>>
>> Again, thank you for your help!
>>
>> Cheers,
>>
>> Mark
>>
>>
>> On Mon, May 5, 2014 at 4:12 PM, Sean Gillies <sean at mapbox.com> wrote:
>>
>>> Hi Mark,
>>>
>>> Safecast's JSON isn't GeoJSON, but wouldn't be too hard to crosswalk
>>> over to GeoJSON... make a geometry from its latitude/longitude, stuff all
>>> the other attributes in properties.
>>>
>>>
>>> On 5/5/14, 1:56 PM, Mark Coletti wrote:
>>>
>>>>
>>>> Safecast is user sourced radiation data, and has a public API serving
>>>> data in GeoJSON format (https://api.safecast.org/en-US/home).  However,
>>>> I'm having difficulty in accessing this data via OGR:
>>>>
>>>> % ogrinfo -so
>>>> "https://api.safecast.org/en-US/measurements?distance=10&
>>>> latitude=37.42&longitude=141.033"
>>>> ERROR 4: Failed to read GeoJSON data
>>>> ERROR 4: Failed to read GeoJSON data
>>>> FAILURE:
>>>> Unable to open datasource
>>>> `https://api.safecast.org/measurements.json?distance=10&
>>>> latitude=37.42&longitude=141.033'
>>>> with the following drivers.
>>>>
>>>> So OGR sees that the data is formatted as GeoJSON, but is unable to read
>>>> it for some reason.
>>>>
>>>> Using curl to manually make the query I get:
>>>>
>>>> % curl  -i -H "Accept: application/json"
>>>> "https://api.safecast.org/en-US/measurements?distance=10&
>>>> latitude=37.42&longitude=141.033"
>>>> HTTP/1.1 200 OK
>>>> Server: nginx
>>>> Date: Mon, 05 May 2014 19:43:55 GMT
>>>> Content-Type: application/json; charset=utf-8
>>>> Transfer-Encoding: chunked
>>>> Connection: keep-alive
>>>> Status: 200 OK
>>>> Strict-Transport-Security: max-age=31536000
>>>> Access-Control-Allow-Origin: safecast.org <http://safecast.org>
>>>>
>>>> Access-Control-Allow-Methods: POST, GET, OPTIONS
>>>> Access-Control-Allow-Headers: *, X-Requested-With
>>>> Access-Control-Max-Age: 100000
>>>> X-UA-Compatible: IE=Edge,chrome=1
>>>> ETag: "e4650539a53d3698d8deb02e912b9ae3"
>>>> Cache-Control: max-age=0, private, must-revalidate
>>>> X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
>>>> X-Runtime: 0.022855
>>>> X-Rack-Cache: miss
>>>> X-Powered-By: cloud66
>>>>
>>>> [{"captured_at":"2014-01-30T05:03:25Z","device_id":
>>>> null,"id":30981293,"location_name":null,"original_id":null,
>>>> "unit":"cpm","user_id":3,"value":4675.0,"latitude":37.
>>>> 41997666666666,"longitude":141.03297166666667},{"
>>>> captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":
>>>> 30981556,"location_name":null,"original_id":null,"unit":"
>>>> cpm","user_id":3,"value":2470.0,"latitude":37.
>>>> 42001666666667,"longitude":141.03303666666667},{"
>>>> captured_at":"2014-01-30T05:00:54Z","device_id":null,"id":
>>>> 30981263,"location_name":null,"original_id":null,"unit":"
>>>> cpm","user_id":3,"value":5428.0,"latitude":37.
>>>> 41996666666667,"longitude":141.03301666666667},{"
>>>> captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":
>>>> 30981507,"location_name":null,"original_id":null,"unit":"
>>>> cpm","user_id":3,"value":12191.0,"latitude":37.
>>>> 420003333333334,"longitude":141.03305333333333},{"
>>>> captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":
>>>> 30981262,"location_name":null,"original_id":null,"unit":"
>>>> cpm","user_id":3,"value":5199.0,"lat
>>>>
>>> i
>>> tude":37.41999666666667,"longitude":141.03306166666667}
>>> ,{"captured_at":"2014-01-30T05:25:21Z","device_id":
>>> null,"id":30981555,"location_name":null,"original_id":null,
>>> "unit":"cpm","user_id":3,"value":2423.0,"latitude":37.
>>> 42006833333333,"longitude":141.03301333333334},{"
>>> captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":
>>> 30981294,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":4456.0,"latitude":37.
>>> 41992833333333,"longitude":141.03297333333333},{"
>>> captured_at":"2014-01-30T05:00:59Z","device_id":null,"id":
>>> 30981264,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":5672.0,"latitude":37.
>>> 419963333333335,"longitude":141.03291666666667},{"
>>> captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":
>>> 30981261,"location_name":null,"original_id":null,"unit":"
>>> cpm","user_id":3,"value":5135.0,"latitude":37.420035,"
>>> longitude":141.03309},{"captured_at":"2014-01-30T05:
>>> 21:14Z","device_id":null,"id":30981506,"location_name":null,
>>> "original_id":null,"unit":"c
>>> p
>>> m","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude":
>>> 141.03293666666667}]
>>>
>>>>
>>>> Those do look like legitimate observations, but I don't know if they
>>>> comply to the GeoJSON format since I'm new to JSON.
>>>>
>>>> I'm using this version of GDAL/OGR, which was part of the pre-packaged
>>>> binaries for qgis for my Mac:
>>>> % ogrinfo --version
>>>> GDAL 1.10.1, released 2013/08/26
>>>>
>>>> Eventually I'd like to use GDAL/OGR to conveniently create a local
>>>> spatial database from such a query.  However, I need to get over this
>>>> hurdle first.
>>>>
>>>> Cheers,
>>>>
>>>> Mark
>>>> --
>>>> mcoletti at gmail.com <mailto:mcoletti at gmail.com>
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>>
>>> --
>>> Sean Gillies
>>> sean at mapbox.com
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>> mcoletti at gmail.com
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140505/0029c04e/attachment-0001.html>

From even.rouault at mines-paris.org  Mon May  5 14:22:39 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 5 May 2014 23:22:39 +0200
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAF7K3b_yLxyVtfy-6f31UUfvmYT0oEqhigQyfAcky697GJGOzg@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
	<CAF7K3b8ZozNGL0Xunt_F70oOHMchNa2SXr8k7joTZMfm49K6sw@mail.gmail.com>
	<CAF7K3b_yLxyVtfy-6f31UUfvmYT0oEqhigQyfAcky697GJGOzg@mail.gmail.com>
Message-ID: <201405052322.39751.even.rouault@mines-paris.org>

Le lundi 05 mai 2014 22:57:12, David Fawcett a ?crit :
> On second thought, I see that the .csv file is 2.1 gb!  I would suggest not
> following the .csv driver approach.

Note: Download time might be the problem, but except that, the OGR CSV (and 
VRT) driver should be able to deal with multi giga byte files with minimum RAM 
usage. Basically it reads one line at a time in streaming mode.

> 
> I would follow Sean's suggestion and just use some simple Python (or
> whatever language that you want to use to consume the data) to grab the  XY
> values and write out geometries.
> 
> David.
> 
> Note to self:  When Sean suggests something, just hit +1 and hold tongue...
> 
> On Mon, May 5, 2014 at 3:43 PM, David Fawcett 
<david.fawcett at gmail.com>wrote:
> > Mark,
> > 
> > You could use the GDAL/OGR .csv driver with a VRT to access the data and
> > spit it out into a different, filtered file.
> > 
> > http://www.gdal.org/ogr/drv_csv.html
> > 
> > You could also use the VSI to pull from a .zip'd file via URL.
> > 
> > You could also likely use args with ogr2ogr to filter by attribute or
> > bbox, and even reproject the data on the way out.
> > 
> > http://www.gdal.org/ogr2ogr.html
> > 
> > David.
> > 
> > On Mon, May 5, 2014 at 3:29 PM, Mark Coletti <mcoletti at gmail.com> wrote:
> >> Thank you Even and Sean for your very quick and salient replies!  I'll
> >> notify the Safecast folks that their data might be better served using
> >> GeoJSON; meanwhile, they also make their open source data available as a
> >> single downloadable file in CSV format.  Since qgis can import files of
> >> that type, I've been using that; it's just that I have to do a lot more
> >> work on my end to pare the data down to the region of interest.  (And
> >> deal with the inevitable data corruption.  E.g., I suspect the
> >> observations from 2020 are bogus unless they have a time traveler
> >> volunteering radiation readings. =) )
> >> 
> >> Again, thank you for your help!
> >> 
> >> Cheers,
> >> 
> >> Mark
> >> 
> >> On Mon, May 5, 2014 at 4:12 PM, Sean Gillies <sean at mapbox.com> wrote:
> >>> Hi Mark,
> >>> 
> >>> Safecast's JSON isn't GeoJSON, but wouldn't be too hard to crosswalk
> >>> over to GeoJSON... make a geometry from its latitude/longitude, stuff
> >>> all the other attributes in properties.
> >>> 
> >>> On 5/5/14, 1:56 PM, Mark Coletti wrote:
> >>>> Safecast is user sourced radiation data, and has a public API serving
> >>>> data in GeoJSON format (https://api.safecast.org/en-US/home). 
> >>>> However, I'm having difficulty in accessing this data via OGR:
> >>>> 
> >>>> % ogrinfo -so
> >>>> "https://api.safecast.org/en-US/measurements?distance=10&
> >>>> latitude=37.42&longitude=141.033"
> >>>> ERROR 4: Failed to read GeoJSON data
> >>>> ERROR 4: Failed to read GeoJSON data
> >>>> FAILURE:
> >>>> Unable to open datasource
> >>>> `https://api.safecast.org/measurements.json?distance=10&
> >>>> latitude=37.42&longitude=141.033'
> >>>> with the following drivers.
> >>>> 
> >>>> So OGR sees that the data is formatted as GeoJSON, but is unable to
> >>>> read it for some reason.
> >>>> 
> >>>> Using curl to manually make the query I get:
> >>>> 
> >>>> % curl  -i -H "Accept: application/json"
> >>>> "https://api.safecast.org/en-US/measurements?distance=10&
> >>>> latitude=37.42&longitude=141.033"
> >>>> HTTP/1.1 200 OK
> >>>> Server: nginx
> >>>> Date: Mon, 05 May 2014 19:43:55 GMT
> >>>> Content-Type: application/json; charset=utf-8
> >>>> Transfer-Encoding: chunked
> >>>> Connection: keep-alive
> >>>> Status: 200 OK
> >>>> Strict-Transport-Security: max-age=31536000
> >>>> Access-Control-Allow-Origin: safecast.org <http://safecast.org>
> >>>> 
> >>>> Access-Control-Allow-Methods: POST, GET, OPTIONS
> >>>> Access-Control-Allow-Headers: *, X-Requested-With
> >>>> Access-Control-Max-Age: 100000
> >>>> X-UA-Compatible: IE=Edge,chrome=1
> >>>> ETag: "e4650539a53d3698d8deb02e912b9ae3"
> >>>> Cache-Control: max-age=0, private, must-revalidate
> >>>> X-Request-Id: a30a38247c16374a39ada0a8d4d2fcde
> >>>> X-Runtime: 0.022855
> >>>> X-Rack-Cache: miss
> >>>> X-Powered-By: cloud66
> >>>> 
> >>>> [{"captured_at":"2014-01-30T05:03:25Z","device_id":
> >>>> null,"id":30981293,"location_name":null,"original_id":null,
> >>>> "unit":"cpm","user_id":3,"value":4675.0,"latitude":37.
> >>>> 41997666666666,"longitude":141.03297166666667},{"
> >>>> captured_at":"2014-01-30T05:25:26Z","device_id":null,"id":
> >>>> 30981556,"location_name":null,"original_id":null,"unit":"
> >>>> cpm","user_id":3,"value":2470.0,"latitude":37.
> >>>> 42001666666667,"longitude":141.03303666666667},{"
> >>>> captured_at":"2014-01-30T05:00:54Z","device_id":null,"id":
> >>>> 30981263,"location_name":null,"original_id":null,"unit":"
> >>>> cpm","user_id":3,"value":5428.0,"latitude":37.
> >>>> 41996666666667,"longitude":141.03301666666667},{"
> >>>> captured_at":"2014-01-30T05:21:20Z","device_id":null,"id":
> >>>> 30981507,"location_name":null,"original_id":null,"unit":"
> >>>> cpm","user_id":3,"value":12191.0,"latitude":37.
> >>>> 420003333333334,"longitude":141.03305333333333},{"
> >>>> captured_at":"2014-01-30T05:00:49Z","device_id":null,"id":
> >>>> 30981262,"location_name":null,"original_id":null,"unit":"
> >>>> cpm","user_id":3,"value":5199.0,"lat
> >>> 
> >>> i
> >>> tude":37.41999666666667,"longitude":141.03306166666667}
> >>> ,{"captured_at":"2014-01-30T05:25:21Z","device_id":
> >>> null,"id":30981555,"location_name":null,"original_id":null,
> >>> "unit":"cpm","user_id":3,"value":2423.0,"latitude":37.
> >>> 42006833333333,"longitude":141.03301333333334},{"
> >>> captured_at":"2014-01-30T05:03:30Z","device_id":null,"id":
> >>> 30981294,"location_name":null,"original_id":null,"unit":"
> >>> cpm","user_id":3,"value":4456.0,"latitude":37.
> >>> 41992833333333,"longitude":141.03297333333333},{"
> >>> captured_at":"2014-01-30T05:00:59Z","device_id":null,"id":
> >>> 30981264,"location_name":null,"original_id":null,"unit":"
> >>> cpm","user_id":3,"value":5672.0,"latitude":37.
> >>> 419963333333335,"longitude":141.03291666666667},{"
> >>> captured_at":"2014-01-30T05:00:44Z","device_id":null,"id":
> >>> 30981261,"location_name":null,"original_id":null,"unit":"
> >>> cpm","user_id":3,"value":5135.0,"latitude":37.420035,"
> >>> longitude":141.03309},{"captured_at":"2014-01-30T05:
> >>> 21:14Z","device_id":null,"id":30981506,"location_name":null,
> >>> "original_id":null,"unit":"c
> >>> p
> >>> m","user_id":3,"value":12164.0,"latitude":37.42006333333333,"longitude"
> >>> : 141.03293666666667}]
> >>> 
> >>>> Those do look like legitimate observations, but I don't know if they
> >>>> comply to the GeoJSON format since I'm new to JSON.
> >>>> 
> >>>> I'm using this version of GDAL/OGR, which was part of the pre-packaged
> >>>> binaries for qgis for my Mac:
> >>>> % ogrinfo --version
> >>>> GDAL 1.10.1, released 2013/08/26
> >>>> 
> >>>> Eventually I'd like to use GDAL/OGR to conveniently create a local
> >>>> spatial database from such a query.  However, I need to get over this
> >>>> hurdle first.
> >>>> 
> >>>> Cheers,
> >>>> 
> >>>> Mark
> >>>> --
> >>>> mcoletti at gmail.com <mailto:mcoletti at gmail.com>
> >>>> 
> >>>> 
> >>>> 
> >>>> _______________________________________________
> >>>> gdal-dev mailing list
> >>>> gdal-dev at lists.osgeo.org
> >>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>> 
> >>> --
> >>> Sean Gillies
> >>> sean at mapbox.com
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> 
> >> --
> >> mcoletti at gmail.com
> >> 
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From diregola at gmail.com  Tue May  6 02:01:10 2014
From: diregola at gmail.com (Margherita Di Leo)
Date: Tue, 6 May 2014 11:01:10 +0200
Subject: [gdal-dev] compiling without writing permission - problem
	gdal-1.10.1
Message-ID: <CABa=8Qo7U3O7SqFic6iEmJqE0XFndbqkRONJcoAviOyYxeTAvw@mail.gmail.com>

Dear all,

I have a problem compiling gdal-1.10.1 on a Linux system for which I'm not
administrator.
In the configure I use the --prefix and --bindir options. Everything goes
smoothly and it confirms that "Libraries have been installed in:" the
folder that I selected (for which i have writing permission). After that,
though, something goes wrong:

make[1]: Leaving directory `/space/modelling/opt/GIS/gdal/gdal-1.10.1/apps'
(cd swig; make install)
make[1]: Entering directory `/space/modelling/opt/GIS/gdal/gdal-1.10.1/swig'
for dir in python ; do (cd $dir; make install) || exit; done
make[2]: Entering directory
`/space/modelling/opt/GIS/gdal/gdal-1.10.1/swig/python'
python setup.py install
running install
error: can't create or remove files in install directory

The following error occurred while trying to add or remove files in the
installation directory:

    [Errno 13] Permission denied:
'/usr/lib64/python2.6/site-packages/test-easy-install-29422.write-test'

The installation directory you specified (via --install-dir, --prefix, or
the distutils default setting) was:

    /usr/lib64/python2.6/site-packages/

Perhaps your account does not have write access to this directory?  If the
installation directory is a system-owned directory, you may need to sign in
as the administrator or "root" account.  If you do not have administrative
access to this machine, you may wish to choose a different installation
directory, preferably one that is listed in your PYTHONPATH environment
variable.

For information on other options, you may wish to consult the
documentation at:

  http://peak.telecommunity.com/EasyInstall.html

Please make the appropriate changes for your system and try again.

make[2]: *** [install] Error 1
make[2]: Leaving directory
`/space/modelling/opt/GIS/gdal/gdal-1.10.1/swig/python'
make[1]: *** [install] Error 2
make[1]: Leaving directory `/space/modelling/opt/GIS/gdal/gdal-1.10.1/swig'
make: *** [install-actions] Error 2

How comes? What am I missing?

Thank you in advance

-- 
Best regards,

Dr. Margherita DI LEO
Scientific / technical project officer

European Commission - DG JRC
Institute for Environment and Sustainability (IES)
Via Fermi, 2749
I-21027 Ispra (VA) - Italy - TP 261

Tel. +39 0332 78 3600
margherita.di-leo at jrc.ec.europa.eu

Disclaimer: The views expressed are purely those of the writer and may not
in any circumstance be regarded as stating an official position of the
European Commission.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/95c1f96a/attachment.html>

From mwtoews at gmail.com  Tue May  6 03:29:21 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Tue, 6 May 2014 22:29:21 +1200
Subject: [gdal-dev] compiling without writing permission - problem
	gdal-1.10.1
In-Reply-To: <CABa=8Qo7U3O7SqFic6iEmJqE0XFndbqkRONJcoAviOyYxeTAvw@mail.gmail.com>
References: <CABa=8Qo7U3O7SqFic6iEmJqE0XFndbqkRONJcoAviOyYxeTAvw@mail.gmail.com>
Message-ID: <CAM2FmMraebNqtj8WnySpjo+A3xFP_eHULG_9fZvejrwcq_tasg@mail.gmail.com>

On 6 May 2014 21:01, Margherita Di Leo <diregola at gmail.com> wrote:
> I have a problem compiling gdal-1.10.1 on a Linux system for which I'm not
> administrator.
> In the configure I use the --prefix and --bindir options. Everything goes
> smoothly and it confirms that "Libraries have been installed in:" the folder
> that I selected (for which i have writing permission). After that, though,
> something goes wrong:
...
> How comes? What am I missing?

Unfortunately this is a bug: http://trac.osgeo.org/gdal/ticket/4563

There are a few workarounds, such as installing the Python bindings
manually with the appropriate --prefix:
$ cd swig/python
$ python setup.py install --prefix=/to/where/you/want/it

or edit swig/python/GNUmakefile (line 71):

    $(PYTHON) setup.py install --prefix=$(DESTDIR)$(prefix)

-Mike

From david.tran at hsr.ch  Tue May  6 05:33:24 2014
From: david.tran at hsr.ch (David Tran)
Date: Tue, 6 May 2014 14:33:24 +0200
Subject: [gdal-dev] ogr2ogr.cpp: how to use it in my own code?
Message-ID: <5368D694.2050909@hsr.ch>

Hi to everyone

I use MSVC 2010 to compile my stuff: ogr2ogr.cpp needed some headers, 
therefore I put them in the right directory with the gdal 1.10.1 library 
(gdal_i.lib) from gisinternals.com/sdk. It just doesn't compile (about 
165 errors).

Can I use ogr2ogr.cpp in my own code somehow?

cheers
David

From aperi2007 at gmail.com  Tue May  6 06:04:27 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Tue, 6 May 2014 15:04:27 +0200
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
Message-ID: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>

Hi,

The IGM (Italian Geography Military) has update the definition of the
Reference System in the EPSG DB.

So now there some new codes usable for datasets in Italy:
epsg::6007, 6008, and so on.
This codes are also mandatory for the new cartography that will be created
in Italy.

So will be useful to have this codes available in the gdal environment.
The version gdal I'm using (1.10) don't seem to know this codes.

Before to update to the new gdal 1.11 I like to know if it will support a
more recent version of epsg-db.

Thx,

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/1cb31e76/attachment.html>

From jmckenna at gatewaygeomatics.com  Tue May  6 06:17:09 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 06 May 2014 10:17:09 -0300
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
In-Reply-To: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
References: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
Message-ID: <5368E0D5.3070407@gatewaygeomatics.com>

On 2014-05-06, 10:04 AM, Andrea Peri wrote:
> Hi,
> 
> The IGM (Italian Geography Military) has update the definition of the
> Reference System in the EPSG DB.
> 
> So now there some new codes usable for datasets in Italy:
> epsg::6007, 6008, and so on.
> This codes are also mandatory for the new cartography that will be
> created in Italy.
> 
> So will be useful to have this codes available in the gdal environment.
> The version gdal I'm using (1.10) don't seem to know this codes.
> 
> Before to update to the new gdal 1.11 I like to know if it will support
> a more recent version of epsg-db.
> 
> Thx,
> 

Hello Andrea,

>From the GDAL 1.11 release notes:

 * Upgrade to EPSG 8.2 database

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From aperi2007 at gmail.com  Tue May  6 07:07:43 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Tue, 6 May 2014 16:07:43 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 120, Issue 9
In-Reply-To: <mailman.3552.1399382238.1977.gdal-dev@lists.osgeo.org>
References: <mailman.3552.1399382238.1977.gdal-dev@lists.osgeo.org>
Message-ID: <CABqTJk8OTADp85TqahR3-2=6KQokgT9Q7J_BEfJNtm8JButX3A@mail.gmail.com>

Hi Jef,
thx for response.

unfortunately only now I see that the new Italian epsg codes are available
in the last epsg db (the 8.4 version) released in the 1 may 2014.

Also I understand that gdal will not update to the last available version
(i guess it was the 8.3 version).
So perhaps only from two next release of gdal the epsg:8.4 will be
supported

This mean more than 2 year (2016)

I hope to wrong something .
:)


Thx,

Andrea Peri.


From: Jeff McKenna <jmckenna at gatewaygeomatics.com>

> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] what version of epsg-db in gdal 1.11 ?
> Message-ID: <5368E0D5.3070407 at gatewaygeomatics.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> On 2014-05-06, 10:04 AM, Andrea Peri wrote:
> > Hi,
> >
> > The IGM (Italian Geography Military) has update the definition of the
> > Reference System in the EPSG DB.
> >
> > So now there some new codes usable for datasets in Italy:
> > epsg::6007, 6008, and so on.
> > This codes are also mandatory for the new cartography that will be
> > created in Italy.
> >
> > So will be useful to have this codes available in the gdal environment.
> > The version gdal I'm using (1.10) don't seem to know this codes.
> >
> > Before to update to the new gdal 1.11 I like to know if it will support
> > a more recent version of epsg-db.
> >
> > Thx,
> >
>
> Hello Andrea,
>
> >From the GDAL 1.11 release notes:
>
>  * Upgrade to EPSG 8.2 database
>
> -jeff
>
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> http://www.gatewaygeomatics.com/
>
>
> --
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/38d5088e/attachment.html>

From diregola at gmail.com  Tue May  6 08:31:06 2014
From: diregola at gmail.com (Margherita Di Leo)
Date: Tue, 6 May 2014 17:31:06 +0200
Subject: [gdal-dev] compiling without writing permission - problem
	gdal-1.10.1
In-Reply-To: <CAM2FmMraebNqtj8WnySpjo+A3xFP_eHULG_9fZvejrwcq_tasg@mail.gmail.com>
References: <CABa=8Qo7U3O7SqFic6iEmJqE0XFndbqkRONJcoAviOyYxeTAvw@mail.gmail.com>
	<CAM2FmMraebNqtj8WnySpjo+A3xFP_eHULG_9fZvejrwcq_tasg@mail.gmail.com>
Message-ID: <CABa=8Qpe=2+MvyU8_kxhEwsa64WU+MBJLXx4E3XkESm-ZMsBBg@mail.gmail.com>

Hi,


On Tue, May 6, 2014 at 12:29 PM, Mike Toews <mwtoews at gmail.com> wrote:

>
>
> Unfortunately this is a bug: http://trac.osgeo.org/gdal/ticket/4563


Thank you for pointing me out.

>
>
> There are a few workarounds, such as installing the Python bindings
> manually with the appropriate --prefix:
> $ cd swig/python
> $ python setup.py install --prefix=/to/where/you/want/it
>
> or edit swig/python/GNUmakefile (line 71):
>
>     $(PYTHON) setup.py install --prefix=$(DESTDIR)$(prefix)
>

Thanks for the workaround, but this doesn't seem to work for me, I'm
probably doing something wrong. It expects to
find /lib64/python2.6/site-packages/ inside the folder that I specify in
--prefix..


-- 
Best regards,

Dr. Margherita DI LEO
Scientific / technical project officer

European Commission - DG JRC
Institute for Environment and Sustainability (IES)
Via Fermi, 2749
I-21027 Ispra (VA) - Italy - TP 261

Tel. +39 0332 78 3600
margherita.di-leo at jrc.ec.europa.eu

Disclaimer: The views expressed are purely those of the writer and may not
in any circumstance be regarded as stating an official position of the
European Commission.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/f24afcf1/attachment.html>

From nicolas.simon at spw.wallonie.be  Tue May  6 08:32:09 2014
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Tue, 6 May 2014 15:32:09 +0000
Subject: [gdal-dev] OGR: memory leak in OCI driver
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>

Dear developers,

                I suspect that there is a memory leak in OCI driver for OGR

                My simplified test case is :

...
// point A
OGRRegisterAll();

// point B
pDS = OGRSFDriverRegistrar::Open("OCI:USER/PWD at INSTANCE:TABLE", true);
if(pDS)
     {
          OGRDataSource::DestroyDataSource(pDS);
          pDS = NULL;
     }
     else
     {
          fprintf(fOut,"Erreur Open\n");
     }
     // point C

OGRCleanupAll();
// point D

It appears that I lose memory between points B and C, and between point A and D

                B = A + 4 MB
                C = A + 20 MB ( 16 MB lost)
               D = A +19 MB ( 3 more MB lost)

Test was done with GDAL 1.9 under windows (with Oracle 11g)

Can some one have an idea to find and fix this ?

Thank you

By the way,  I received < TICKET_CREATE privileges are required to perform this operation > when I tried to make a ticket (UID nicsim)

Nicolas




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/02510f87/attachment.html>

From mcoletti at gmail.com  Tue May  6 08:39:26 2014
From: mcoletti at gmail.com (Mark Coletti)
Date: Tue, 6 May 2014 11:39:26 -0400
Subject: [gdal-dev] Difficulty opening Safecast GeoJSON data
In-Reply-To: <CAF7K3b_yLxyVtfy-6f31UUfvmYT0oEqhigQyfAcky697GJGOzg@mail.gmail.com>
References: <CAHpqhBMEOo+wnMsqi97UNA3r5D48Ga7KySWEQ=O0Oraw9G5X0Q@mail.gmail.com>
	<5367F0AA.2020902@mapbox.com>
	<CAHpqhBProLQ3pU6FDOjhyNWJdy9M23dDs1tygzm5gWNtccWKSQ@mail.gmail.com>
	<CAF7K3b8ZozNGL0Xunt_F70oOHMchNa2SXr8k7joTZMfm49K6sw@mail.gmail.com>
	<CAF7K3b_yLxyVtfy-6f31UUfvmYT0oEqhigQyfAcky697GJGOzg@mail.gmail.com>
Message-ID: <CAHpqhBN3wX+_A8ChUfJOE5JiAHhfTre6_dM_Zk=bqm04oQLPRA@mail.gmail.com>

On Mon, May 5, 2014 at 4:57 PM, David Fawcett <david.fawcett at gmail.com>wrote:

> On second thought, I see that the .csv file is 2.1 gb!  I would suggest
> not following the .csv driver approach.
>
> I would follow Sean's suggestion and just use some simple Python (or
> whatever language that you want to use to consume the data) to grab the  XY
> values and write out geometries.
>
>
Actually I was able to load the whole shebang into qgis using their CSV
importer.  The problem with that approach is that that file contains
observations for the entire planet, and I just want Japan.  (Particularly
round Fukushima Daiichi.)  Fortunately I can clip to the region of interest
within qgis, though it's admittedly a little sluggish.  ;)

I was interested in their API because I thought that would be an easy way
to do the clipping on their end, while making getting regular updates
viable.  Regularly downloading and processing 2Gb data isn't feasible.

This is the first time I've dealt with "big data", so I'm still getting my
arms round the associated issues.

Cheers!

Mark
-- 
mcoletti at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/e08875ba/attachment.html>

From lucena_ivan at hotmail.com  Tue May  6 08:47:37 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 6 May 2014 11:47:37 -0400
Subject: [gdal-dev] OGR: memory leak in OCI driver
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>
References: <F02D54DF5576D84C86C23A39A792DC7E3164E534@se0002v.wallonie.intra>
Message-ID: <BLU173-W30D9B916CB0161C18790C7904F0@phx.gbl>

Hi Nicolas,

I received that report a month ago:

"we have found the OGROCISession is never
    released, causing a large memory leak whenever a connection is
    closed. 

    As workaround, we added in OGROCISession::~OGROCISession()


        if( hEnv )

                OCIHandleFree((dvoid *) hEnv, (ub4)
      OCI_HTYPE_ENV);"

But they also mention some other memory leaks without an specific location on the code.

Can you try to see if that fix the problem?

Thanks,

Ivan


From: nicolas.simon at spw.wallonie.be
To: gdal-dev at lists.osgeo.org
Date: Tue, 6 May 2014 15:32:09 +0000
CC: christophe.sandri at spw.wallonie.be; xuan.nguyen at spw.wallonie.be
Subject: [gdal-dev] OGR: memory leak in OCI driver









Dear developers,
 
                I suspect that there is a memory leak in OCI driver for OGR
                
                My simplified test case is :
 
?          
// point A
OGRRegisterAll();
 
// point B
pDS = OGRSFDriverRegistrar::Open("OCI:USER/PWD at INSTANCE:TABLE", true);
if(pDS)
     {
          OGRDataSource::DestroyDataSource(pDS);
          pDS = NULL;
     }
     else
     {
          fprintf(fOut,"Erreur Open\n");
     }
     // point C
     
OGRCleanupAll();
// point D
 
It appears that I lose memory between points B and C, and between point A and D  

 
                B = A + 4 MB
                C = A + 20 MB ( 16 MB lost)
               D = A +19 MB ( 3 more MB lost) 
 
Test was done with GDAL 1.9 under windows (with Oracle 11g)
 
Can some one have an idea to find and fix this ?
 
Thank you
 
By the way,  I received ? TICKET_CREATE privileges are required to perform this operation ? when I tried to make a ticket (UID nicsim)
 
Nicolas
 
 




_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/6987c368/attachment-0001.html>

From antonio.valentino at tiscali.it  Tue May  6 10:38:10 2014
From: antonio.valentino at tiscali.it (Antonio Valentino)
Date: Tue, 06 May 2014 19:38:10 +0200
Subject: [gdal-dev] compiling without writing permission - problem
	gdal-1.10.1
In-Reply-To: <CABa=8Qpe=2+MvyU8_kxhEwsa64WU+MBJLXx4E3XkESm-ZMsBBg@mail.gmail.com>
References: <CABa=8Qo7U3O7SqFic6iEmJqE0XFndbqkRONJcoAviOyYxeTAvw@mail.gmail.com>	<CAM2FmMraebNqtj8WnySpjo+A3xFP_eHULG_9fZvejrwcq_tasg@mail.gmail.com>
	<CABa=8Qpe=2+MvyU8_kxhEwsa64WU+MBJLXx4E3XkESm-ZMsBBg@mail.gmail.com>
Message-ID: <53691E02.7090606@tiscali.it>

Hi Margherita,

Il 06/05/2014 17:31, Margherita Di Leo ha scritto:
> Hi,
> 
> 
> On Tue, May 6, 2014 at 12:29 PM, Mike Toews <mwtoews at gmail.com> wrote:
> 
>>
>>
>> Unfortunately this is a bug: http://trac.osgeo.org/gdal/ticket/4563
> 
> 
> Thank you for pointing me out.
> 
>>
>>
>> There are a few workarounds, such as installing the Python bindings
>> manually with the appropriate --prefix:
>> $ cd swig/python
>> $ python setup.py install --prefix=/to/where/you/want/it
>>
>> or edit swig/python/GNUmakefile (line 71):
>>
>>     $(PYTHON) setup.py install --prefix=$(DESTDIR)$(prefix)
>>
> 
> Thanks for the workaround, but this doesn't seem to work for me, I'm
> probably doing something wrong. It expects to
> find /lib64/python2.6/site-packages/ inside the folder that I specify in
> --prefix..
> 
> 

Yes, the site-packages must already exist and should also be in the
PYTHONPATH.

Plesae try to apply the attached patch to gdal/swig/python/GNUmakefile
and run the following commands from the gdal build directory


mkdir -p $PREFIX/lib64/python2.6/site-packages
env PYTHONPATH=$PREFIX/lib64/python2.6/site-packages:$PYTHONPATH make \
install


of course you should set PREFIX according to your setup.


ciao

--
Antonio Valentino

-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal-python.patch
Type: text/x-patch
Size: 510 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/cc1e3abb/attachment.bin>

From even.rouault at mines-paris.org  Tue May  6 10:55:48 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 6 May 2014 19:55:48 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 120, Issue 9
In-Reply-To: <CABqTJk8OTADp85TqahR3-2=6KQokgT9Q7J_BEfJNtm8JButX3A@mail.gmail.com>
References: <mailman.3552.1399382238.1977.gdal-dev@lists.osgeo.org>
	<CABqTJk8OTADp85TqahR3-2=6KQokgT9Q7J_BEfJNtm8JButX3A@mail.gmail.com>
Message-ID: <201405061955.48165.even.rouault@mines-paris.org>

Le mardi 06 mai 2014 16:07:43, Andrea Peri a ?crit :
> Hi Jef,
> thx for response.
> 
> unfortunately only now I see that the new Italian epsg codes are available
> in the last epsg db (the 8.4 version) released in the 1 may 2014.
> 
> Also I understand that gdal will not update to the last available version
> (i guess it was the 8.3 version).
> So perhaps only from two next release of gdal the epsg:8.4 will be
> supported
> 
> This mean more than 2 year (2016)

Andrea,

I'm not sure to understand why that should wait 2 versions and not the next 
(major) one ? I guess we missed 8.3 because nobody did it and the upgrade to 
8.2 was done before. It is not a matter of "policy".
Actually you just don't have to wait for the upgrade to land in trunk. It is 
generally "just" a matter of updating a bunch of csv files distributed with 
GDAL (although this migt have some software implications if new projection 
method codes are invented/changed). This is documented here : 
http://lists.maptools.org/pipermail/geotiff/2009-June/000566.html

Even

> 
> I hope to wrong something .
> 
> :)
> 
> Thx,
> 
> Andrea Peri.
> 
> 
> From: Jeff McKenna <jmckenna at gatewaygeomatics.com>
> 
> > To: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] what version of epsg-db in gdal 1.11 ?
> > Message-ID: <5368E0D5.3070407 at gatewaygeomatics.com>
> > Content-Type: text/plain; charset=ISO-8859-1
> > 
> > On 2014-05-06, 10:04 AM, Andrea Peri wrote:
> > > Hi,
> > > 
> > > The IGM (Italian Geography Military) has update the definition of the
> > > Reference System in the EPSG DB.
> > > 
> > > So now there some new codes usable for datasets in Italy:
> > > epsg::6007, 6008, and so on.
> > > This codes are also mandatory for the new cartography that will be
> > > created in Italy.
> > > 
> > > So will be useful to have this codes available in the gdal environment.
> > > The version gdal I'm using (1.10) don't seem to know this codes.
> > > 
> > > Before to update to the new gdal 1.11 I like to know if it will support
> > > a more recent version of epsg-db.
> > > 
> > > Thx,
> > 
> > Hello Andrea,
> > 
> > >From the GDAL 1.11 release notes:
> >  * Upgrade to EPSG 8.2 database
> > 
> > -jeff
> > 
> > 
> > 
> > --
> > Jeff McKenna
> > MapServer Consulting and Training Services
> > http://www.gatewaygeomatics.com/
> > 
> > 
> > --
> 
> -----------------
> Andrea Peri
> . . . . . . . . .
> qwerty ?????
> -----------------

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From aperi2007 at gmail.com  Tue May  6 11:50:21 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Tue, 6 May 2014 20:50:21 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 120, Issue 9
In-Reply-To: <201405061955.48165.even.rouault@mines-paris.org>
References: <mailman.3552.1399382238.1977.gdal-dev@lists.osgeo.org>
	<CABqTJk8OTADp85TqahR3-2=6KQokgT9Q7J_BEfJNtm8JButX3A@mail.gmail.com>
	<201405061955.48165.even.rouault@mines-paris.org>
Message-ID: <CABqTJk8L8oWRAAMChyMc75bv_KU-MkuMmhecP9DgbtNM5OcyWw@mail.gmail.com>

Hi Rouault,

my mistake.

I see the last gdal is 8.2 and now epsg was to 8.4 so I deduce (wrongly)
that gdal was 2 version behind.
I forget to evaluate that the 8.4 was released after the release of gdal.

The link to instruction for produce new csv files from epsg db is really
interesting.

Thx a lot.

Andrea




2014-05-06 19:55 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Le mardi 06 mai 2014 16:07:43, Andrea Peri a ?crit :
> > Hi Jef,
> > thx for response.
> >
> > unfortunately only now I see that the new Italian epsg codes are
> available
> > in the last epsg db (the 8.4 version) released in the 1 may 2014.
> >
> > Also I understand that gdal will not update to the last available version
> > (i guess it was the 8.3 version).
> > So perhaps only from two next release of gdal the epsg:8.4 will be
> > supported
> >
> > This mean more than 2 year (2016)
>
> Andrea,
>
> I'm not sure to understand why that should wait 2 versions and not the next
> (major) one ? I guess we missed 8.3 because nobody did it and the upgrade
> to
> 8.2 was done before. It is not a matter of "policy".
> Actually you just don't have to wait for the upgrade to land in trunk. It
> is
> generally "just" a matter of updating a bunch of csv files distributed with
> GDAL (although this migt have some software implications if new projection
> method codes are invented/changed). This is documented here :
> http://lists.maptools.org/pipermail/geotiff/2009-June/000566.html
>
> Even
>
> >
> > I hope to wrong something .
> >
> > :)
> >
> > Thx,
> >
> > Andrea Peri.
> >
> >
> > From: Jeff McKenna <jmckenna at gatewaygeomatics.com>
> >
> > > To: gdal-dev at lists.osgeo.org
> > > Subject: Re: [gdal-dev] what version of epsg-db in gdal 1.11 ?
> > > Message-ID: <5368E0D5.3070407 at gatewaygeomatics.com>
> > > Content-Type: text/plain; charset=ISO-8859-1
> > >
> > > On 2014-05-06, 10:04 AM, Andrea Peri wrote:
> > > > Hi,
> > > >
> > > > The IGM (Italian Geography Military) has update the definition of the
> > > > Reference System in the EPSG DB.
> > > >
> > > > So now there some new codes usable for datasets in Italy:
> > > > epsg::6007, 6008, and so on.
> > > > This codes are also mandatory for the new cartography that will be
> > > > created in Italy.
> > > >
> > > > So will be useful to have this codes available in the gdal
> environment.
> > > > The version gdal I'm using (1.10) don't seem to know this codes.
> > > >
> > > > Before to update to the new gdal 1.11 I like to know if it will
> support
> > > > a more recent version of epsg-db.
> > > >
> > > > Thx,
> > >
> > > Hello Andrea,
> > >
> > > >From the GDAL 1.11 release notes:
> > >  * Upgrade to EPSG 8.2 database
> > >
> > > -jeff
> > >
> > >
> > >
> > > --
> > > Jeff McKenna
> > > MapServer Consulting and Training Services
> > > http://www.gatewaygeomatics.com/
> > >
> > >
> > > --
> >
> > -----------------
> > Andrea Peri
> > . . . . . . . . .
> > qwerty ?????
> > -----------------
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/4ef5b106/attachment.html>

From peifer at gmx.eu  Tue May  6 12:19:05 2014
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue, 06 May 2014 21:19:05 +0200
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
In-Reply-To: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
References: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
Message-ID: <536935A9.7010508@gmx.eu>

On 2014-05-06 15:04, Andrea Peri wrote:
> Hi,
>
> The IGM (Italian Geography Military) has update the definition of the
> Reference System in the EPSG DB.
>
> So now there some new codes usable for datasets in Italy:
> epsg::6007, 6008, and so on.

I just checked at http://epsg-registry.org/ > retrieve by code. There 
don't seem to be any CRS codes in this range. Their online database 
version is 8.4

Hermann


From aperi2007 at gmail.com  Tue May  6 12:30:50 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Tue, 6 May 2014 21:30:50 +0200
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
In-Reply-To: <536935A9.7010508@gmx.eu>
References: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
	<536935A9.7010508@gmx.eu>
Message-ID: <CABqTJk9im7yn3P4rrF4agFoM9wCb5BsZ3HP_xyT+k3aB8HmNWA@mail.gmail.com>

Oops,

you have right

I wrong to report the codes.

the new codes are from 6704 to 6711

so the right for test

was 6707 not 6007

Thx,

Andrea.



2014-05-06 21:19 GMT+02:00 Hermann Peifer <peifer at gmx.eu>:

> On 2014-05-06 15:04, Andrea Peri wrote:
>
>> Hi,
>>
>> The IGM (Italian Geography Military) has update the definition of the
>> Reference System in the EPSG DB.
>>
>> So now there some new codes usable for datasets in Italy:
>> epsg::6007, 6008, and so on.
>>
>
> I just checked at http://epsg-registry.org/ > retrieve by code. There
> don't seem to be any CRS codes in this range. Their online database version
> is 8.4
>
> Hermann
>
>


-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140506/dd844e2c/attachment.html>

From peifer at gmx.eu  Tue May  6 12:52:40 2014
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue, 06 May 2014 21:52:40 +0200
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
In-Reply-To: <CABqTJk9im7yn3P4rrF4agFoM9wCb5BsZ3HP_xyT+k3aB8HmNWA@mail.gmail.com>
References: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>	<536935A9.7010508@gmx.eu>
	<CABqTJk9im7yn3P4rrF4agFoM9wCb5BsZ3HP_xyT+k3aB8HmNWA@mail.gmail.com>
Message-ID: <53693D88.9060401@gmx.eu>

Aha.

These codes are not included in GDAL's most recent gcs.csv/pcs.csv, see 
http://trac.osgeo.org/gdal/browser/trunk/gdal/data

Hermann

On 2014-05-06 21:30, Andrea Peri wrote:
> Oops,
>
> you have right
>
> I wrong to report the codes.
>
> the new codes are from 6704 to 6711
>
> so the right for test
>
> was 6707 not 6007
>
> Thx,
>
> Andrea.
>
>
>
> 2014-05-06 21:19 GMT+02:00 Hermann Peifer <peifer at gmx.eu
> <mailto:peifer at gmx.eu>>:
>
>     On 2014-05-06 15:04, Andrea Peri wrote:
>
>         Hi,
>
>         The IGM (Italian Geography Military) has update the definition
>         of the
>         Reference System in the EPSG DB.
>
>         So now there some new codes usable for datasets in Italy:
>         epsg::6007, 6008, and so on.
>
>
>     I just checked at http://epsg-registry.org/ > retrieve by code.
>     There don't seem to be any CRS codes in this range. Their online
>     database version is 8.4
>
>     Hermann
>
>
>
>
> --
> -----------------
> Andrea Peri
> . . . . . . . . .
> qwerty ?????
> -----------------


From peifer at gmx.eu  Tue May  6 11:25:21 2014
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue, 06 May 2014 20:25:21 +0200
Subject: [gdal-dev] what version of epsg-db in gdal 1.11 ?
In-Reply-To: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
References: <CABqTJk-gNUzeTPU1gWMmKd-WVm8Vpe5twfW1Oj8oZpCrdmsjTw@mail.gmail.com>
Message-ID: <lkb9ei$pcs$1@ger.gmane.org>

On 2014-05-06 15:04, Andrea Peri wrote:
> Hi,
>
> The IGM (Italian Geography Military) has update the definition of the
> Reference System in the EPSG DB.
>
> So now there some new codes usable for datasets in Italy:
> epsg::6007, 6008, and so on.

I just checked at http://epsg-registry.org/ > retrieve by code. There 
don't seem to be any CRS codes in this range. Their online database 
version is 8.4

Hermann



From mccorb at cox.net  Tue May  6 15:56:03 2014
From: mccorb at cox.net (mccorb)
Date: Tue, 6 May 2014 15:56:03 -0700 (PDT)
Subject: [gdal-dev] ogr2ogr coordinate system encoding
Message-ID: <1399416963595-5138903.post@n6.nabble.com>

I have shape files that I am wanting to convert to a GML equivalent file. I
understand how to use the shape file .PRJ files and EPSG info to translate
coordinate systems and all that is working well. 

However, once converted the coordinates are correct but there is nothing in
the file (that I can see) to tell if the coordinates in the GML file are in
lat/lon, utm, or some albers equal area projection etc.

Is there any way to coerce ogr2ogr to encode the coordinate system info into
the resultant GML file that matches the coordinates that are there?

thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-coordinate-system-encoding-tp5138903.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at mmmtike.fi  Wed May  7 03:30:04 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 7 May 2014 10:30:04 +0000 (UTC)
Subject: [gdal-dev] ogr2ogr coordinate system encoding
References: <1399416963595-5138903.post@n6.nabble.com>
Message-ID: <loom.20140507T122622-55@post.gmane.org>

mccorb <mccorb <at> cox.net> writes:

> 
> I have shape files that I am wanting to convert to a GML equivalent file. I
> understand how to use the shape file .PRJ files and EPSG info to translate
> coordinate systems and all that is working well. 
> 
> However, once converted the coordinates are correct but there is nothing in
> the file (that I can see) to tell if the coordinates in the GML file are in
> lat/lon, utm, or some albers equal area projection etc.
> 
> Is there any way to coerce ogr2ogr to encode the coordinate system info into
> the resultant GML file that matches the coordinates that are there?
> 
> thanks

Hi,

It seems that srsName in not written automatically but you must set it in
the org2ogr command

ogr2ogr -a_srs EPSG:3067 -f GML test.gml test.shp

Then you will have
<ogr:geometryProperty><gml:Polygon srsName="EPSG:3067">...

Read also about long SRS if you want to use the urn format with GML 3

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Wed May  7 04:09:54 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 7 May 2014 13:09:54 +0200
Subject: [gdal-dev] ogr2ogr coordinate system encoding
In-Reply-To: <loom.20140507T122622-55@post.gmane.org>
References: <1399416963595-5138903.post@n6.nabble.com>
	<loom.20140507T122622-55@post.gmane.org>
Message-ID: <201405071309.55112.even.rouault@mines-paris.org>

Le mercredi 07 mai 2014 12:30:04, Jukka Rahkonen a ?crit :
> mccorb <mccorb <at> cox.net> writes:
> > I have shape files that I am wanting to convert to a GML equivalent file.
> > I understand how to use the shape file .PRJ files and EPSG info to
> > translate coordinate systems and all that is working well.
> > 
> > However, once converted the coordinates are correct but there is nothing
> > in the file (that I can see) to tell if the coordinates in the GML file
> > are in lat/lon, utm, or some albers equal area projection etc.
> > 
> > Is there any way to coerce ogr2ogr to encode the coordinate system info
> > into the resultant GML file that matches the coordinates that are there?
> > 
> > thanks
> 
> Hi,
> 
> It seems that srsName in not written automatically but you must set it in
> the org2ogr command

In the case of shapefiles, yes, since the .prj file does not contain an EPSG 
code, and GML SRS can only be written as EPSG code. For datasources where the 
SRS include the EPSG code, the -a option should not be necessary.

> 
> ogr2ogr -a_srs EPSG:3067 -f GML test.gml test.shp
> 
> Then you will have
> <ogr:geometryProperty><gml:Polygon srsName="EPSG:3067">...
> 
> Read also about long SRS if you want to use the urn format with GML 3
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From scottm361 at gmail.com  Wed May  7 11:30:45 2014
From: scottm361 at gmail.com (scottm361)
Date: Wed, 7 May 2014 11:30:45 -0700 (PDT)
Subject: [gdal-dev] ogr2ogr error handling
Message-ID: <1399487445094-5139067.post@n6.nabble.com>

I am a developer on an application that will potentially use ogr2ogr to
re-project shapefiles (and potentially other ogr supported formats)

What I am wondering about is the nature of geometry error handling in
ogr2ogr.  My assumption is that geometry errors are quite common in user
supplied data, so I am wondering if I need to rethink the automated use of
ogr2ogr for this purpose.

Geometry errors that I have encountered so far are:

ERROR 1: TopologyException: found non-noded intersection between LINESTRING
(-1.77558e+006 7.46242e+006, -1.77596e+006 7.46259e+006) and LINESTRING
(-1.77596e+006 7.46259e+006, -1.77593e+006 7.46258e+006) at
-1775935.412652828 7462582.2040281445

ERROR 1: TopologyException: side location conflict at -1828580.797204141
7355153.6866245456

ERROR 1: TopologyException: unable to assign hole to a shell


My questions:

1. Does ogr2ogr omit the offending geometries above (or others) when
-skipfailiures is used in the resulting output
2. Are geometry errors ever "created" by reprojection?  Presumably due to
floating point error some geometries might be shifted slightly relative to
each other.
3. If the answer to 2 is "Yes", does that mean topology exceptions like
above are thrown when detected in the source data, AND in the process of
reprojecting the result?
4. Generally speaking, from a reliablility and data integrity standpoint,
are errors such as these safe to ignore and carry on processes using
-skipfailiures, or will users be dismayed by things such as missing
features, which are indirectly a result of their own bad data
5. Is there any way to fix the geometry in the OGR context before attempting
to reproject?

Thank you !
Scott Morken




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-error-handling-tp5139067.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Wed May  7 15:13:22 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 8 May 2014 00:13:22 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
Message-ID: <201405080013.23209.even.rouault@mines-paris.org>

Hi,

This is a call for discussion on "RFC 46: GDAL/OGR unification"

  http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May  7 15:24:36 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 8 May 2014 00:24:36 +0200
Subject: [gdal-dev] ogr2ogr error handling
In-Reply-To: <1399487445094-5139067.post@n6.nabble.com>
References: <1399487445094-5139067.post@n6.nabble.com>
Message-ID: <201405080024.37021.even.rouault@mines-paris.org>

Le mercredi 07 mai 2014 20:30:45, scottm361 a ?crit :
> I am a developer on an application that will potentially use ogr2ogr to
> re-project shapefiles (and potentially other ogr supported formats)
> 
> What I am wondering about is the nature of geometry error handling in
> ogr2ogr.  My assumption is that geometry errors are quite common in user
> supplied data, so I am wondering if I need to rethink the automated use of
> ogr2ogr for this purpose.
> 
> Geometry errors that I have encountered so far are:
> 
> ERROR 1: TopologyException: found non-noded intersection between LINESTRING
> (-1.77558e+006 7.46242e+006, -1.77596e+006 7.46259e+006) and LINESTRING
> (-1.77596e+006 7.46259e+006, -1.77593e+006 7.46258e+006) at
> -1775935.412652828 7462582.2040281445
> 
> ERROR 1: TopologyException: side location conflict at -1828580.797204141
> 7355153.6866245456
> 
> ERROR 1: TopologyException: unable to assign hole to a shell
> 

Those are GEOS errors. Are you doing some clipping/spatial filtering too ? What 
is your ogr2ogr command line ?

> 
> My questions:
> 
> 1. Does ogr2ogr omit the offending geometries above (or others) when
> -skipfailiures is used in the resulting output

It is difficult to tell for sure. It might depend on the call site that triggers 
the error

> 2. Are geometry errors ever "created" by reprojection?  Presumably due to
> floating point error some geometries might be shifted slightly relative to
> each other.

Reprojection could create topological weirdness. For example if you convert a 
polygon from polar projection to geodetic projection.

> 3. If the answer to 2 is "Yes", does that mean topology exceptions like
> above are thrown when detected in the source data, AND in the process of
> reprojecting the result?
> 4. Generally speaking, from a reliablility and data integrity standpoint,
> are errors such as these safe to ignore and carry on processes using
> -skipfailiures, or will users be dismayed by things such as missing
> features, which are indirectly a result of their own bad data
> 5. Is there any way to fix the geometry in the OGR context before
> attempting to reproject?
> 
> Thank you !
> Scott Morken
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/ogr2ogr-error-handling-tp5139067.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From scottm361 at gmail.com  Wed May  7 15:54:50 2014
From: scottm361 at gmail.com (scottm361)
Date: Wed, 7 May 2014 15:54:50 -0700 (PDT)
Subject: [gdal-dev] ogr2ogr error handling
In-Reply-To: <201405080024.37021.even.rouault@mines-paris.org>
References: <1399487445094-5139067.post@n6.nabble.com>
	<201405080024.37021.even.rouault@mines-paris.org>
Message-ID: <1399503290516-5139115.post@n6.nabble.com>

Hi Even

Thanks for the reply.

the command I am using does use clipping, but not spatial filtering:

gdal\apps\ogr2ogr.exe -overwrite -t_srs
"layers\NFI_MODIS250m_kNN_Structure_Stand_Age_v0.prj" -clipdst  -2600000
5700000 3100000 10500000 -skipfailures
".\temp\nfdb_poly_20111223_21094F1A58AE467E\nfdb_poly_20111223_21094F1A58AE467E.shp"
"layers\fire\nfdb_poly_20111223.shp"

Is there an alternative way to do this that I should use?

Scott



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-error-handling-tp5139067p5139115.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Wed May  7 16:01:34 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 8 May 2014 01:01:34 +0200
Subject: [gdal-dev] ogr2ogr error handling
In-Reply-To: <1399503290516-5139115.post@n6.nabble.com>
References: <1399487445094-5139067.post@n6.nabble.com>
	<201405080024.37021.even.rouault@mines-paris.org>
	<1399503290516-5139115.post@n6.nabble.com>
Message-ID: <201405080101.34569.even.rouault@mines-paris.org>

Le jeudi 08 mai 2014 00:54:50, scottm361 a ?crit :
> Hi Even
> 
> Thanks for the reply.
> 
> the command I am using does use clipping, but not spatial filtering:
> 
> gdal\apps\ogr2ogr.exe -overwrite -t_srs
> "layers\NFI_MODIS250m_kNN_Structure_Stand_Age_v0.prj" -clipdst  -2600000
> 5700000 3100000 10500000 -skipfailures
> ".\temp\nfdb_poly_20111223_21094F1A58AE467E\nfdb_poly_20111223_21094F1A58AE
> 467E.shp" "layers\fire\nfdb_poly_20111223.shp"
> 
> Is there an alternative way to do this that I should use?

No, that's fine. Looking at the code, when the GEOS errors occur, it is likely 
that the feature whose intersection with the clip bounding box causes the 
error will not be written. -skipfailures is not really taken into account in 
that matter (the GEOS error does not count as a failure for ogr2ogr, but is 
considered as a null intersection)

With some efforts, you could try to extract the feature that cause the issue 
and analyze if the GEOS error is logical or if it is a bug.

> 
> Scott
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/ogr2ogr-error-handling-tp5139067p51391
> 15.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From vladmerti at gmail.com  Thu May  8 04:29:07 2014
From: vladmerti at gmail.com (Vlad Merticariu)
Date: Thu, 8 May 2014 13:29:07 +0200
Subject: [gdal-dev] libgdal and commercial software
Message-ID: <CAMVn9aHQgF5VE6bX-sRB0rxer7Dp9ywjhG65fwspZjwOwHvJoA@mail.gmail.com>

Dear list,

I have a question about using libgdal in commercial software.

Even though the library itself is released under non-restrictive licence
terms, it appears that the list of dependencies contain GPL released
software, such as  libpoppler or libmysqlclient.

Is it safe to use it in proprietary software?

Thanks,
Vlad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140508/52d5f8b3/attachment.html>

From even.rouault at mines-paris.org  Thu May  8 05:03:15 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 8 May 2014 14:03:15 +0200
Subject: [gdal-dev] libgdal and commercial software
In-Reply-To: <CAMVn9aHQgF5VE6bX-sRB0rxer7Dp9ywjhG65fwspZjwOwHvJoA@mail.gmail.com>
References: <CAMVn9aHQgF5VE6bX-sRB0rxer7Dp9ywjhG65fwspZjwOwHvJoA@mail.gmail.com>
Message-ID: <201405081403.15584.even.rouault@mines-paris.org>

Le jeudi 08 mai 2014 13:29:07, Vlad Merticariu a ?crit :
> Dear list,
> 
> I have a question about using libgdal in commercial software.
> 
> Even though the library itself is released under non-restrictive licence
> terms, it appears that the list of dependencies contain GPL released
> software, such as  libpoppler or libmysqlclient.

They are optional dependencies that you can disable if you don't need them or 
cannot comply with their licencing.

> 
> Is it safe to use it in proprietary software?
> 
> Thanks,
> Vlad

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mateusz at loskot.net  Thu May  8 04:58:29 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Thu, 8 May 2014 13:58:29 +0200
Subject: [gdal-dev] libgdal and commercial software
In-Reply-To: <CAMVn9aHQgF5VE6bX-sRB0rxer7Dp9ywjhG65fwspZjwOwHvJoA@mail.gmail.com>
References: <CAMVn9aHQgF5VE6bX-sRB0rxer7Dp9ywjhG65fwspZjwOwHvJoA@mail.gmail.com>
Message-ID: <CABUeae8si2ZGZCocmWvxUeKW7d5NNk70TW_qTq1xJXchj7_-_Q@mail.gmail.com>

On 8 May 2014 13:29, Vlad Merticariu <vladmerti at gmail.com> wrote:
> Dear list,
>
> I have a question about using libgdal in commercial software.

GDAL itself is a perfectly commercial software.

http://www.gnu.org/philosophy/categories.html

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Sat May 10 08:38:09 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 10 May 2014 17:38:09 +0200
Subject: [gdal-dev] PostGIS: COPY mode turned on
Message-ID: <201405101738.09922.even.rouault@mines-paris.org>

Hi,

I just wanted to inform that, per http://trac.osgeo.org/gdal/ticket/5460, I've 
turned on COPY mode, instead of INSERT, on newly created PostGIS tables, that 
should result in faster execution time, typically in ogr2ogr to PostGIS 
scenarios.

Setting PG_USE_COPY=NO will revert to INSERT.

In -append scenarios, PG_USE_COPY=YES is still necessary if you want COPY.

Please report if you see bad side-effects of this change.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat May 10 13:21:50 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 10 May 2014 22:21:50 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
Message-ID: <201405102221.50572.even.rouault@mines-paris.org>

Hi,

I'm wondering if there's some interest in standardizing a way of embedding 
georeferencing information in popular image formats like JPEG or PNG.

I've just been doing an experiment with JPEG. My solution is to use a GeoTIFF 
box as specified in ? 2.2 "Box contents" of 
http://www.lizardtech.com/download/geo/geotiff_box.txt , a.k.a GeoJP2 and 
heavily used to add georeferencing to JPEG2000 images.
The GeoTIFF file is put in an JFIF APP1 segment with a "GeoTIFFBox\0" signature 
to begin the payload.

So the structure is the following :

\xFF \D8                  <-- SOI marker (Start Of Image)
[ Any optional JPEG segment ]	

\xFF \xE1                <-- APP1 marker
Size                        <-- Number of byte of signature (11) +
                                    size of {geotiff-file}. little-endian uint16
GeoTIFFBox\0         <-- Signature (to distinguish from Exif, etc...)
{geotiff-file}           <-- A GeoTIFF image of size 1x1 (cf ? 2.2 Box contents)

[  Any optional JPEG segment ]	
[  JPEG baseline segments ]
\xFF \D9                 <-- EOI marker (End Of Image)

End of spec !

Such a solution should have a good compatibility level, since the GeoTIFFBox 
APP1 segment should be ignored gracefully by JPEG readers not aware of the 
spec. My few tests with various readers would confirm that.

A working implementation based on GDAL trunk can be found here : 
https://github.com/rouault/gdal2/tree/geotiffbox_in_jpeg

The patch is :
https://github.com/rouault/gdal2/compare/geotiffbox_in_jpeg

Example of such a file attached to this email. Generated by :

gdal_translate http://svn.osgeo.org/gdal/trunk/autotest/gcore/data/byte.tif 
byte.jpg -of jpeg

And

$ gdalinfo byte.jpg
Driver: JPEG/JPEG JFIF
Files: byte.jpg
Size is 20, 20
Coordinate System is:
PROJCS["NAD27 / UTM zone 11N",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26711"]]
Origin = (440720.000000000000000,3751320.000000000000000)
Pixel Size = (60.000000000000000,-60.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
Band 1 Block=20x1 Type=Byte, ColorInterp=Gray
  Image Structure Metadata:
    COMPRESSION=JPEG

There are many potential other solutions, like adding the GeoTIFF tags in a 
proper EXIF segment, since it is already a TIFF structure, but that would have 
made my implementation a bit harder, and I'm wondering how some EXIF readers 
would react when facing GeoTIFF tags. Another solution would be to use the 
heavy GMLJP2 specification ( http://www.opengeospatial.org/standards/gmljp2 ), 
which is an OGC standard, but it is still evolving ( 
http://www.opengeospatial.org/standards/requests/118 ), and is rather verbose 
which defeats the purpose of JPEG being a compressed format...

Any opinion/interest ?

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
A non-text attachment was scrubbed...
Name: byte.jpg
Type: image/jpeg
Size: 857 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140510/5923a5b1/attachment.jpg>

From etourigny.dev at gmail.com  Sat May 10 14:31:30 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Sat, 10 May 2014 18:31:30 -0300
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <201405102221.50572.even.rouault@mines-paris.org>
References: <201405102221.50572.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvMPKtUykUiSAFyZiGwfqLY+6xQiXQZkNwxeC=kQKgEvrA@mail.gmail.com>

Hi Even,

why not simply add the geotransform and WKT or PROJ.4 string as exif tags?
simple to read outside of gdal (any exif reader will support this) and
implement using libexif.

just my 2 cents.
Etienne


On Sat, May 10, 2014 at 5:21 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Hi,
>
> I'm wondering if there's some interest in standardizing a way of embedding
> georeferencing information in popular image formats like JPEG or PNG.
>
> I've just been doing an experiment with JPEG. My solution is to use a
> GeoTIFF
> box as specified in ? 2.2 "Box contents" of
> http://www.lizardtech.com/download/geo/geotiff_box.txt , a.k.a GeoJP2 and
> heavily used to add georeferencing to JPEG2000 images.
> The GeoTIFF file is put in an JFIF APP1 segment with a "GeoTIFFBox\0"
> signature
> to begin the payload.
>
> So the structure is the following :
>
> \xFF \D8                  <-- SOI marker (Start Of Image)
> [ Any optional JPEG segment ]
>
> \xFF \xE1                <-- APP1 marker
> Size                        <-- Number of byte of signature (11) +
>                                     size of {geotiff-file}. little-endian
> uint16
> GeoTIFFBox\0         <-- Signature (to distinguish from Exif, etc...)
> {geotiff-file}           <-- A GeoTIFF image of size 1x1 (cf ? 2.2 Box
> contents)
>
> [  Any optional JPEG segment ]
> [  JPEG baseline segments ]
> \xFF \D9                 <-- EOI marker (End Of Image)
>
> End of spec !
>
> Such a solution should have a good compatibility level, since the
> GeoTIFFBox
> APP1 segment should be ignored gracefully by JPEG readers not aware of the
> spec. My few tests with various readers would confirm that.
>
> A working implementation based on GDAL trunk can be found here :
> https://github.com/rouault/gdal2/tree/geotiffbox_in_jpeg
>
> The patch is :
> https://github.com/rouault/gdal2/compare/geotiffbox_in_jpeg
>
> Example of such a file attached to this email. Generated by :
>
> gdal_translate
> http://svn.osgeo.org/gdal/trunk/autotest/gcore/data/byte.tif
> byte.jpg -of jpeg
>
> And
>
> $ gdalinfo byte.jpg
> Driver: JPEG/JPEG JFIF
> Files: byte.jpg
> Size is 20, 20
> Coordinate System is:
> PROJCS["NAD27 / UTM zone 11N",
>     GEOGCS["NAD27",
>         DATUM["North_American_Datum_1927",
>             SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
>                 AUTHORITY["EPSG","7008"]],
>             AUTHORITY["EPSG","6267"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4267"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-117],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","26711"]]
> Origin = (440720.000000000000000,3751320.000000000000000)
> Pixel Size = (60.000000000000000,-60.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Corner Coordinates:
> Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
> Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
> Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
> Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
> Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
> Band 1 Block=20x1 Type=Byte, ColorInterp=Gray
>   Image Structure Metadata:
>     COMPRESSION=JPEG
>
> There are many potential other solutions, like adding the GeoTIFF tags in a
> proper EXIF segment, since it is already a TIFF structure, but that would
> have
> made my implementation a bit harder, and I'm wondering how some EXIF
> readers
> would react when facing GeoTIFF tags. Another solution would be to use the
> heavy GMLJP2 specification (
> http://www.opengeospatial.org/standards/gmljp2 ),
> which is an OGC standard, but it is still evolving (
> http://www.opengeospatial.org/standards/requests/118 ), and is rather
> verbose
> which defeats the purpose of JPEG being a compressed format...
>
> Any opinion/interest ?
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140510/fd68b0de/attachment.html>

From even.rouault at mines-paris.org  Sat May 10 14:49:55 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 10 May 2014 23:49:55 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <CA+TxYvMPKtUykUiSAFyZiGwfqLY+6xQiXQZkNwxeC=kQKgEvrA@mail.gmail.com>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<CA+TxYvMPKtUykUiSAFyZiGwfqLY+6xQiXQZkNwxeC=kQKgEvrA@mail.gmail.com>
Message-ID: <201405102349.56161.even.rouault@mines-paris.org>

Le samedi 10 mai 2014 23:31:30, Etienne Tourigny a ?crit :
> Hi Even,
> 
> why not simply add the geotransform and WKT or PROJ.4 string as exif tags?
> simple to read outside of gdal (any exif reader will support this) and
> implement using libexif.

You would have to create new EXIF tags for that. The advantage of using 
GeoTIFF is that it is already standardized. And it has a few bonus, like 
ground control points.

> 
> just my 2 cents.
> Etienne
> 
> 
> On Sat, May 10, 2014 at 5:21 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Hi,
> > 
> > I'm wondering if there's some interest in standardizing a way of
> > embedding georeferencing information in popular image formats like JPEG
> > or PNG.
> > 
> > I've just been doing an experiment with JPEG. My solution is to use a
> > GeoTIFF
> > box as specified in ? 2.2 "Box contents" of
> > http://www.lizardtech.com/download/geo/geotiff_box.txt , a.k.a GeoJP2 and
> > heavily used to add georeferencing to JPEG2000 images.
> > The GeoTIFF file is put in an JFIF APP1 segment with a "GeoTIFFBox\0"
> > signature
> > to begin the payload.
> > 
> > So the structure is the following :
> > 
> > \xFF \D8                  <-- SOI marker (Start Of Image)
> > [ Any optional JPEG segment ]
> > 
> > \xFF \xE1                <-- APP1 marker
> > Size                        <-- Number of byte of signature (11) +
> > 
> >                                     size of {geotiff-file}. little-endian
> > 
> > uint16
> > GeoTIFFBox\0         <-- Signature (to distinguish from Exif, etc...)
> > {geotiff-file}           <-- A GeoTIFF image of size 1x1 (cf ? 2.2 Box
> > contents)
> > 
> > [  Any optional JPEG segment ]
> > [  JPEG baseline segments ]
> > \xFF \D9                 <-- EOI marker (End Of Image)
> > 
> > End of spec !
> > 
> > Such a solution should have a good compatibility level, since the
> > GeoTIFFBox
> > APP1 segment should be ignored gracefully by JPEG readers not aware of
> > the spec. My few tests with various readers would confirm that.
> > 
> > A working implementation based on GDAL trunk can be found here :
> > https://github.com/rouault/gdal2/tree/geotiffbox_in_jpeg
> > 
> > The patch is :
> > https://github.com/rouault/gdal2/compare/geotiffbox_in_jpeg
> > 
> > Example of such a file attached to this email. Generated by :
> > 
> > gdal_translate
> > http://svn.osgeo.org/gdal/trunk/autotest/gcore/data/byte.tif
> > byte.jpg -of jpeg
> > 
> > And
> > 
> > $ gdalinfo byte.jpg
> > Driver: JPEG/JPEG JFIF
> > Files: byte.jpg
> > Size is 20, 20
> > Coordinate System is:
> > PROJCS["NAD27 / UTM zone 11N",
> > 
> >     GEOGCS["NAD27",
> >     
> >         DATUM["North_American_Datum_1927",
> >         
> >             SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
> >             
> >                 AUTHORITY["EPSG","7008"]],
> >             
> >             AUTHORITY["EPSG","6267"]],
> >         
> >         PRIMEM["Greenwich",0],
> >         UNIT["degree",0.0174532925199433],
> >         AUTHORITY["EPSG","4267"]],
> >     
> >     PROJECTION["Transverse_Mercator"],
> >     PARAMETER["latitude_of_origin",0],
> >     PARAMETER["central_meridian",-117],
> >     PARAMETER["scale_factor",0.9996],
> >     PARAMETER["false_easting",500000],
> >     PARAMETER["false_northing",0],
> >     UNIT["metre",1,
> >     
> >         AUTHORITY["EPSG","9001"]],
> >     
> >     AUTHORITY["EPSG","26711"]]
> > 
> > Origin = (440720.000000000000000,3751320.000000000000000)
> > Pixel Size = (60.000000000000000,-60.000000000000000)
> > 
> > Metadata:
> >   AREA_OR_POINT=Area
> > 
> > Corner Coordinates:
> > Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
> > Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
> > Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
> > Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
> > Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
> > Band 1 Block=20x1 Type=Byte, ColorInterp=Gray
> > 
> >   Image Structure Metadata:
> >     COMPRESSION=JPEG
> > 
> > There are many potential other solutions, like adding the GeoTIFF tags in
> > a proper EXIF segment, since it is already a TIFF structure, but that
> > would have
> > made my implementation a bit harder, and I'm wondering how some EXIF
> > readers
> > would react when facing GeoTIFF tags. Another solution would be to use
> > the heavy GMLJP2 specification (
> > http://www.opengeospatial.org/standards/gmljp2 ),
> > which is an OGC standard, but it is still evolving (
> > http://www.opengeospatial.org/standards/requests/118 ), and is rather
> > verbose
> > which defeats the purpose of JPEG being a compressed format...
> > 
> > Any opinion/interest ?
> > 
> > Even
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From sillyemperor at gmail.com  Sun May 11 02:03:38 2014
From: sillyemperor at gmail.com (Jiang Wang)
Date: Sun, 11 May 2014 17:03:38 +0800
Subject: [gdal-dev] Read from Erdas Img too slow,
Message-ID: <CAJZgoHkuScfZ8KTj6pvpAZsi3nryhrDXKcpNB9LJOKKtsYDsoQ@mail.gmail.com>

Hi,
My gdal is 1.8.0.I use GDALDataset::RasterIO to read from a img file .The
file size is 30G bytes ,three bands,data type is GDT_Byte and have 8
overviews.When overview is used or there is no need to resample ,it`s
fast.But when resample is needed,i found gdal copy pixel data 1 byte by 1
byte in fllow codes:
                        memcpy( ((GByte *) pData) + iBandBufOffset,
                                pabySrcBlock + iSrcOffset, nBandDataSize );
Codes is in rasterio.cpp at 2150 lines.
My question is why copy 1 byte at one time.and how  to improve it..
Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140511/318c6205/attachment-0001.html>

From even.rouault at mines-paris.org  Sun May 11 02:29:31 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 11 May 2014 11:29:31 +0200
Subject: [gdal-dev] Read from Erdas Img too slow,
In-Reply-To: <CAJZgoHkuScfZ8KTj6pvpAZsi3nryhrDXKcpNB9LJOKKtsYDsoQ@mail.gmail.com>
References: <CAJZgoHkuScfZ8KTj6pvpAZsi3nryhrDXKcpNB9LJOKKtsYDsoQ@mail.gmail.com>
Message-ID: <201405111129.31530.even.rouault@mines-paris.org>

Le dimanche 11 mai 2014 11:03:38, Jiang Wang a ?crit :
> Hi,
> My gdal is 1.8.0.I use GDALDataset::RasterIO to read from a img file .The
> file size is 30G bytes ,three bands,data type is GDT_Byte and have 8
> overviews.When overview is used or there is no need to resample ,it`s
> fast.But when resample is needed,i found gdal copy pixel data 1 byte by 1
> byte in fllow codes:
>                         memcpy( ((GByte *) pData) + iBandBufOffset,
>                                 pabySrcBlock + iSrcOffset, nBandDataSize );
> Codes is in rasterio.cpp at 2150 lines.
> My question is why copy 1 byte at one time.

For each pixel of the output buffer, you need to find which source pixel to 
fetch, and then copy it. As there's resampling involved, the source pixels 
cannot be contiguous, hence a copy one pixel at a time.

> and how  to improve it..

That's an open question ! Well-tested patches welcome.
Perhaps you could start by saving the cost of memcpy() if you know the data 
type is one byte. Similarly to what has been done in the 
GDALRasterBand::IRasterIO() in a more recent version of GDAL. See 
http://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/rasterio.cpp#L503 . If you 
look in the above lines, there have been some tricks to decrease the number of 
multiplications, etc. in the most inner loop.

> Thanks.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Anthony.W.Baker at boeing.com  Mon May 12 11:04:05 2014
From: Anthony.W.Baker at boeing.com (Baker, Anthony W)
Date: Mon, 12 May 2014 18:04:05 +0000
Subject: [gdal-dev] Convert in-memory raster
In-Reply-To: <201405111129.31530.even.rouault@mines-paris.org>
References: <CAJZgoHkuScfZ8KTj6pvpAZsi3nryhrDXKcpNB9LJOKKtsYDsoQ@mail.gmail.com>
	<201405111129.31530.even.rouault@mines-paris.org>
Message-ID: <1106E45778F04E4D94505A07DD749912121E3D@XCH-PHX-403.sw.nos.boeing.com>

I am interested in registering two images together.  In order to do that I would like to align the coordinate frames, the pixel sizes, and the rotation of the two frames.  Is there an easy "in-memory" method for doing this?

Thank you,

Anthony

From etourigny.dev at gmail.com  Mon May 12 12:15:35 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 12 May 2014 16:15:35 -0300
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <201405102349.56161.even.rouault@mines-paris.org>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<CA+TxYvMPKtUykUiSAFyZiGwfqLY+6xQiXQZkNwxeC=kQKgEvrA@mail.gmail.com>
	<201405102349.56161.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvPUZnD5TS-8u31b+g5R_=QX7TPH3gz_vrC2c1ypmCn2kw@mail.gmail.com>

Right, I didn't think of the need to create new EXIF tags.

I think it is a good idea to use existing GTIFF tags to encode this
information.

On the other hand, the method used in jpeg files should ideally be the same
used in other formats (e.g. png, gif) for which it is possible to add extra
metadata.

In light of this, it may be better to use an xml or textual representation
and embed it inside an XMP block, which is supported for many formats[1].
Also it would allow for easier human-reading.

[1]
http://en.wikipedia.org/wiki/Extensible_Metadata_Platform#Embedding_of_XMP


On Sat, May 10, 2014 at 6:49 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 10 mai 2014 23:31:30, Etienne Tourigny a ?crit :
> > Hi Even,
> >
> > why not simply add the geotransform and WKT or PROJ.4 string as exif
> tags?
> > simple to read outside of gdal (any exif reader will support this) and
> > implement using libexif.
>
> You would have to create new EXIF tags for that. The advantage of using
> GeoTIFF is that it is already standardized. And it has a few bonus, like
> ground control points.
>
> >
> > just my 2 cents.
> > Etienne
> >
> >
> > On Sat, May 10, 2014 at 5:21 PM, Even Rouault
> >
> > <even.rouault at mines-paris.org>wrote:
> > > Hi,
> > >
> > > I'm wondering if there's some interest in standardizing a way of
> > > embedding georeferencing information in popular image formats like JPEG
> > > or PNG.
> > >
> > > I've just been doing an experiment with JPEG. My solution is to use a
> > > GeoTIFF
> > > box as specified in ? 2.2 "Box contents" of
> > > http://www.lizardtech.com/download/geo/geotiff_box.txt , a.k.a GeoJP2
> and
> > > heavily used to add georeferencing to JPEG2000 images.
> > > The GeoTIFF file is put in an JFIF APP1 segment with a "GeoTIFFBox\0"
> > > signature
> > > to begin the payload.
> > >
> > > So the structure is the following :
> > >
> > > \xFF \D8                  <-- SOI marker (Start Of Image)
> > > [ Any optional JPEG segment ]
> > >
> > > \xFF \xE1                <-- APP1 marker
> > > Size                        <-- Number of byte of signature (11) +
> > >
> > >                                     size of {geotiff-file}.
> little-endian
> > >
> > > uint16
> > > GeoTIFFBox\0         <-- Signature (to distinguish from Exif, etc...)
> > > {geotiff-file}           <-- A GeoTIFF image of size 1x1 (cf ? 2.2 Box
> > > contents)
> > >
> > > [  Any optional JPEG segment ]
> > > [  JPEG baseline segments ]
> > > \xFF \D9                 <-- EOI marker (End Of Image)
> > >
> > > End of spec !
> > >
> > > Such a solution should have a good compatibility level, since the
> > > GeoTIFFBox
> > > APP1 segment should be ignored gracefully by JPEG readers not aware of
> > > the spec. My few tests with various readers would confirm that.
> > >
> > > A working implementation based on GDAL trunk can be found here :
> > > https://github.com/rouault/gdal2/tree/geotiffbox_in_jpeg
> > >
> > > The patch is :
> > > https://github.com/rouault/gdal2/compare/geotiffbox_in_jpeg
> > >
> > > Example of such a file attached to this email. Generated by :
> > >
> > > gdal_translate
> > > http://svn.osgeo.org/gdal/trunk/autotest/gcore/data/byte.tif
> > > byte.jpg -of jpeg
> > >
> > > And
> > >
> > > $ gdalinfo byte.jpg
> > > Driver: JPEG/JPEG JFIF
> > > Files: byte.jpg
> > > Size is 20, 20
> > > Coordinate System is:
> > > PROJCS["NAD27 / UTM zone 11N",
> > >
> > >     GEOGCS["NAD27",
> > >
> > >         DATUM["North_American_Datum_1927",
> > >
> > >             SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
> > >
> > >                 AUTHORITY["EPSG","7008"]],
> > >
> > >             AUTHORITY["EPSG","6267"]],
> > >
> > >         PRIMEM["Greenwich",0],
> > >         UNIT["degree",0.0174532925199433],
> > >         AUTHORITY["EPSG","4267"]],
> > >
> > >     PROJECTION["Transverse_Mercator"],
> > >     PARAMETER["latitude_of_origin",0],
> > >     PARAMETER["central_meridian",-117],
> > >     PARAMETER["scale_factor",0.9996],
> > >     PARAMETER["false_easting",500000],
> > >     PARAMETER["false_northing",0],
> > >     UNIT["metre",1,
> > >
> > >         AUTHORITY["EPSG","9001"]],
> > >
> > >     AUTHORITY["EPSG","26711"]]
> > >
> > > Origin = (440720.000000000000000,3751320.000000000000000)
> > > Pixel Size = (60.000000000000000,-60.000000000000000)
> > >
> > > Metadata:
> > >   AREA_OR_POINT=Area
> > >
> > > Corner Coordinates:
> > > Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
> > > Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
> > > Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
> > > Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
> > > Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
> > > Band 1 Block=20x1 Type=Byte, ColorInterp=Gray
> > >
> > >   Image Structure Metadata:
> > >     COMPRESSION=JPEG
> > >
> > > There are many potential other solutions, like adding the GeoTIFF tags
> in
> > > a proper EXIF segment, since it is already a TIFF structure, but that
> > > would have
> > > made my implementation a bit harder, and I'm wondering how some EXIF
> > > readers
> > > would react when facing GeoTIFF tags. Another solution would be to use
> > > the heavy GMLJP2 specification (
> > > http://www.opengeospatial.org/standards/gmljp2 ),
> > > which is an OGC standard, but it is still evolving (
> > > http://www.opengeospatial.org/standards/requests/118 ), and is rather
> > > verbose
> > > which defeats the purpose of JPEG being a compressed format...
> > >
> > > Any opinion/interest ?
> > >
> > > Even
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140512/62a8a343/attachment.html>

From even.rouault at mines-paris.org  Mon May 12 12:59:31 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 12 May 2014 21:59:31 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <CA+TxYvPUZnD5TS-8u31b+g5R_=QX7TPH3gz_vrC2c1ypmCn2kw@mail.gmail.com>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405102349.56161.even.rouault@mines-paris.org>
	<CA+TxYvPUZnD5TS-8u31b+g5R_=QX7TPH3gz_vrC2c1ypmCn2kw@mail.gmail.com>
Message-ID: <201405122159.31328.even.rouault@mines-paris.org>

Le lundi 12 mai 2014 21:15:35, Etienne Tourigny a ?crit :
> Right, I didn't think of the need to create new EXIF tags.
> 
> I think it is a good idea to use existing GTIFF tags to encode this
> information.
> 
> On the other hand, the method used in jpeg files should ideally be the same
> used in other formats (e.g. png, gif) for which it is possible to add extra
> metadata.

I think we could also embed a full geotiff box in PNG or GIF. For example with 
PNG, you can create a private chunk : 
http://www.libpng.org/pub/png/spec/1.1/PNG-Encoders.html#E.Private-type-and-
method-codes. So we could have a "gtif" chunk and its payload would be the 
geotiffbox.
And for GIF, we would have "\x21\xff\x0b\GTIFFBoxGTB" + geotiff_file as the 
payload ( http://www.w3.org/Graphics/GIF/spec-gif89a.txt - ? 26)  
And the "usual" trick to terminate GIF application extensions, i.e. a funny 
decreasing sequence \xFF\xFE\...\x01 so that non aware readers can 
resynchronize.

> 
> In light of this, it may be better to use an xml or textual representation
> and embed it inside an XMP block, which is supported for many formats[1].
> Also it would allow for easier human-reading.

Yes, that's one possibility. Which comes back to GMLJP2 unless there are other 
standards...

I'd want to build on something that is a "real" standard or a de-facto 
standard, but not reinvent everything from scratch.

> 
> [1]
> http://en.wikipedia.org/wiki/Extensible_Metadata_Platform#Embedding_of_XMP
> 
> 
> On Sat, May 10, 2014 at 6:49 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le samedi 10 mai 2014 23:31:30, Etienne Tourigny a ?crit :
> > > Hi Even,
> > > 
> > > why not simply add the geotransform and WKT or PROJ.4 string as exif
> > 
> > tags?
> > 
> > > simple to read outside of gdal (any exif reader will support this) and
> > > implement using libexif.
> > 
> > You would have to create new EXIF tags for that. The advantage of using
> > GeoTIFF is that it is already standardized. And it has a few bonus, like
> > ground control points.
> > 
> > > just my 2 cents.
> > > Etienne
> > > 
> > > 
> > > On Sat, May 10, 2014 at 5:21 PM, Even Rouault
> > > 
> > > <even.rouault at mines-paris.org>wrote:
> > > > Hi,
> > > > 
> > > > I'm wondering if there's some interest in standardizing a way of
> > > > embedding georeferencing information in popular image formats like
> > > > JPEG or PNG.
> > > > 
> > > > I've just been doing an experiment with JPEG. My solution is to use a
> > > > GeoTIFF
> > > > box as specified in ? 2.2 "Box contents" of
> > > > http://www.lizardtech.com/download/geo/geotiff_box.txt , a.k.a GeoJP2
> > 
> > and
> > 
> > > > heavily used to add georeferencing to JPEG2000 images.
> > > > The GeoTIFF file is put in an JFIF APP1 segment with a "GeoTIFFBox\0"
> > > > signature
> > > > to begin the payload.
> > > > 
> > > > So the structure is the following :
> > > > 
> > > > \xFF \D8                  <-- SOI marker (Start Of Image)
> > > > [ Any optional JPEG segment ]
> > > > 
> > > > \xFF \xE1                <-- APP1 marker
> > > > Size                        <-- Number of byte of signature (11) +
> > > > 
> > > >                                     size of {geotiff-file}.
> > 
> > little-endian
> > 
> > > > uint16
> > > > GeoTIFFBox\0         <-- Signature (to distinguish from Exif, etc...)
> > > > {geotiff-file}           <-- A GeoTIFF image of size 1x1 (cf ? 2.2
> > > > Box contents)
> > > > 
> > > > [  Any optional JPEG segment ]
> > > > [  JPEG baseline segments ]
> > > > \xFF \D9                 <-- EOI marker (End Of Image)
> > > > 
> > > > End of spec !
> > > > 
> > > > Such a solution should have a good compatibility level, since the
> > > > GeoTIFFBox
> > > > APP1 segment should be ignored gracefully by JPEG readers not aware
> > > > of the spec. My few tests with various readers would confirm that.
> > > > 
> > > > A working implementation based on GDAL trunk can be found here :
> > > > https://github.com/rouault/gdal2/tree/geotiffbox_in_jpeg
> > > > 
> > > > The patch is :
> > > > https://github.com/rouault/gdal2/compare/geotiffbox_in_jpeg
> > > > 
> > > > Example of such a file attached to this email. Generated by :
> > > > 
> > > > gdal_translate
> > > > http://svn.osgeo.org/gdal/trunk/autotest/gcore/data/byte.tif
> > > > byte.jpg -of jpeg
> > > > 
> > > > And
> > > > 
> > > > $ gdalinfo byte.jpg
> > > > Driver: JPEG/JPEG JFIF
> > > > Files: byte.jpg
> > > > Size is 20, 20
> > > > Coordinate System is:
> > > > PROJCS["NAD27 / UTM zone 11N",
> > > > 
> > > >     GEOGCS["NAD27",
> > > >     
> > > >         DATUM["North_American_Datum_1927",
> > > >         
> > > >             SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
> > > >             
> > > >                 AUTHORITY["EPSG","7008"]],
> > > >             
> > > >             AUTHORITY["EPSG","6267"]],
> > > >         
> > > >         PRIMEM["Greenwich",0],
> > > >         UNIT["degree",0.0174532925199433],
> > > >         AUTHORITY["EPSG","4267"]],
> > > >     
> > > >     PROJECTION["Transverse_Mercator"],
> > > >     PARAMETER["latitude_of_origin",0],
> > > >     PARAMETER["central_meridian",-117],
> > > >     PARAMETER["scale_factor",0.9996],
> > > >     PARAMETER["false_easting",500000],
> > > >     PARAMETER["false_northing",0],
> > > >     UNIT["metre",1,
> > > >     
> > > >         AUTHORITY["EPSG","9001"]],
> > > >     
> > > >     AUTHORITY["EPSG","26711"]]
> > > > 
> > > > Origin = (440720.000000000000000,3751320.000000000000000)
> > > > Pixel Size = (60.000000000000000,-60.000000000000000)
> > > > 
> > > > Metadata:
> > > >   AREA_OR_POINT=Area
> > > > 
> > > > Corner Coordinates:
> > > > Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54'
> > > > 8.47"N) Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W,
> > > > 33d53'29.51"N) Upper Right (  441920.000, 3751320.000)
> > > > (117d37'41.48"W, 33d54' 8.71"N) Lower Right (  441920.000,
> > > > 3750120.000) (117d37'41.20"W, 33d53'29.75"N) Center      ( 
> > > > 441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N) Band 1
> > > > Block=20x1 Type=Byte, ColorInterp=Gray
> > > > 
> > > >   Image Structure Metadata:
> > > >     COMPRESSION=JPEG
> > > > 
> > > > There are many potential other solutions, like adding the GeoTIFF
> > > > tags
> > 
> > in
> > 
> > > > a proper EXIF segment, since it is already a TIFF structure, but that
> > > > would have
> > > > made my implementation a bit harder, and I'm wondering how some EXIF
> > > > readers
> > > > would react when facing GeoTIFF tags. Another solution would be to
> > > > use the heavy GMLJP2 specification (
> > > > http://www.opengeospatial.org/standards/gmljp2 ),
> > > > which is an OGC standard, but it is still evolving (
> > > > http://www.opengeospatial.org/standards/requests/118 ), and is rather
> > > > verbose
> > > > which defeats the purpose of JPEG being a compressed format...
> > > > 
> > > > Any opinion/interest ?
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Mon May 12 14:05:21 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 12 May 2014 21:05:21 +0000 (UTC)
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405102349.56161.even.rouault@mines-paris.org>
	<CA+TxYvPUZnD5TS-8u31b+g5R_=QX7TPH3gz_vrC2c1ypmCn2kw@mail.gmail.com>
	<201405122159.31328.even.rouault@mines-paris.org>
Message-ID: <loom.20140512T225741-304@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

...

> > In light of this, it may be better to use an xml or textual representation
> > and embed it inside an XMP block, which is supported for many formats[1].
> > Also it would allow for easier human-reading.
> 
> Yes, that's one possibility. Which comes back to GMLJP2 unless there are
other 
> standards...
> 
> I'd want to build on something that is a "real" standard or a de-facto 
> standard, but not reinvent everything from scratch.

What GMLJP2 gives as a bonus is the axis order trouble and not totally clear
interpretation if origin is in the centre (probably it is) or in the corner
of a pixel, and rectified grid does not support ground control points. Thus
GMLJP2 is at least not better in everything, it has also drawbacks.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Mon May 12 14:18:15 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 12 May 2014 23:18:15 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <loom.20140512T225741-304@post.gmane.org>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405122159.31328.even.rouault@mines-paris.org>
	<loom.20140512T225741-304@post.gmane.org>
Message-ID: <201405122318.15978.even.rouault@mines-paris.org>

Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
> Even Rouault <even.rouault <at> mines-paris.org> writes:
> 
> ...
> 
> > > In light of this, it may be better to use an xml or textual
> > > representation and embed it inside an XMP block, which is supported
> > > for many formats[1]. Also it would allow for easier human-reading.
> > 
> > Yes, that's one possibility. Which comes back to GMLJP2 unless there are
> 
> other
> 
> > standards...
> > 
> > I'd want to build on something that is a "real" standard or a de-facto
> > standard, but not reinvent everything from scratch.
> 
> What GMLJP2 gives as a bonus is the axis order trouble and not totally
> clear interpretation if origin is in the centre (probably it is) or in the
> corner of a pixel, and rectified grid does not support ground control
> points. Thus GMLJP2 is at least not better in everything, it has also
> drawbacks.

Hi Jukka,

Yes, for all your above reasons, I would prefer to avoid it.
Although the axis order trouble (the one of EPSG) and interpretation of origin 
(pixel center) should be mostly clarified with the revised version.
As far as ground countrol points are concerned, I've not really looked at the 
capabilities of GMLCov, so perhaps there's something in it for that. 
Otherwise, that would be indeed a drawback.

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From p.baumann at jacobs-university.de  Mon May 12 14:38:29 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Mon, 12 May 2014 23:38:29 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <201405122318.15978.even.rouault@mines-paris.org>
References: <201405102221.50572.even.rouault@mines-paris.org>	<201405122159.31328.even.rouault@mines-paris.org>	<loom.20140512T225741-304@post.gmane.org>
	<201405122318.15978.even.rouault@mines-paris.org>
Message-ID: <53713F55.1030506@jacobs-university.de>

Hi all,

just saw this, thought I'd chime in being the editor of GMLCOV :)
Any questions, I'll gladly try to answer, I'm just on the road currently, so 
expect a delay of a day or so.

Trying to respond to what has been raised below:

On 05/12/2014 11:18 PM, Even Rouault wrote:
> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>
>> ...
>>
>>>> In light of this, it may be better to use an xml or textual
>>>> representation and embed it inside an XMP block, which is supported
>>>> for many formats[1]. Also it would allow for easier human-reading.
>>> Yes, that's one possibility. Which comes back to GMLJP2 unless there are
>> other
>>
>>> standards...
>>>
>>> I'd want to build on something that is a "real" standard or a de-facto
>>> standard, but not reinvent everything from scratch.
>> What GMLJP2 gives as a bonus is the axis order trouble

actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each coverage 
has a Native CRS which is defined via an OGC URI (which, in the case of EPSG, 
refers to the OGP maintained database). In the CRS definition the axis is given 
unambiguously.

If you don't want to go to that database, use the axisLabels attribute in the 
Envelope, it lists axes in their proper sequence.


>> and not totally
>> clear interpretation if origin is in the centre (probably it is) or in the
>> corner of a pixel,

naively, GMLCOV follows the pixel-in center interpretation. However, encodings 
may override this, such as GeoTIFF (see the pertaining adopted spec [1]).

[1] https://portal.opengeospatial.org/files/?artifact_id=50118


>> and rectified grid does not support ground control
>> points.

yes, because it is rectified. If you want more degree of freedom do not use 
RectifiedGridCoverage but ReferenceableGridCoverage. In conjunction with GML 3.3 
( a compatible enhancement of GML 3.2.1) this gives you irregular and warped 
grids. We're not completely done, though, and would be glad about your support 
in some advanced issues. Note that this work is all voluntary and relies on some 
project financing to be done. Up to now, EC and ESA have been generous, and so 
we are going ahead step by step.


>> Thus GMLJP2 is at least not better in everything, it has also
>> drawbacks.
> Hi Jukka,
>
> Yes, for all your above reasons, I would prefer to avoid it.

so which ones are remaining, following the clarification you mention below?

cheers,
Peter

> Although the axis order trouble (the one of EPSG) and interpretation of origin
> (pixel center) should be mostly clarified with the revised version.
> As far as ground countrol points are concerned, I've not really looked at the
> capabilities of GMLCov, so perhaps there's something in it for that.
> Otherwise, that would be indeed a drawback.
>
>> -Jukka Rahkonen-
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From warmerdam at pobox.com  Mon May 12 14:33:08 2014
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 12 May 2014 14:33:08 -0700
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <201405122318.15978.even.rouault@mines-paris.org>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405122159.31328.even.rouault@mines-paris.org>
	<loom.20140512T225741-304@post.gmane.org>
	<201405122318.15978.even.rouault@mines-paris.org>
Message-ID: <CA+YzLBfy=hKVkRq9xgPzgvzvAZkByPj7tx4oN_05OFTtsOrDtw@mail.gmail.com>

Even,

I have no objection to preparing such a GeoTIFF-in-JPEG/PNG mechanism, but
to be honest I find it hard to get excited about GeoTIFF as a broader way
of describing coordinate system information because of the various quirks
with GeoTIFF and the binary opaqueness of GeoTIFF.  However, there is
already precident with LAS and GeoJP2.

Best regards,
Frank



On Mon, May 12, 2014 at 2:18 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
> > Even Rouault <even.rouault <at> mines-paris.org> writes:
> >
> > ...
> >
> > > > In light of this, it may be better to use an xml or textual
> > > > representation and embed it inside an XMP block, which is supported
> > > > for many formats[1]. Also it would allow for easier human-reading.
> > >
> > > Yes, that's one possibility. Which comes back to GMLJP2 unless there
> are
> >
> > other
> >
> > > standards...
> > >
> > > I'd want to build on something that is a "real" standard or a de-facto
> > > standard, but not reinvent everything from scratch.
> >
> > What GMLJP2 gives as a bonus is the axis order trouble and not totally
> > clear interpretation if origin is in the centre (probably it is) or in
> the
> > corner of a pixel, and rectified grid does not support ground control
> > points. Thus GMLJP2 is at least not better in everything, it has also
> > drawbacks.
>
> Hi Jukka,
>
> Yes, for all your above reasons, I would prefer to avoid it.
> Although the axis order trouble (the one of EPSG) and interpretation of
> origin
> (pixel center) should be mostly clarified with the revised version.
> As far as ground countrol points are concerned, I've not really looked at
> the
> capabilities of GMLCov, so perhaps there's something in it for that.
> Otherwise, that would be indeed a drawback.
>
> >
> > -Jukka Rahkonen-
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140512/c2e132c0/attachment.html>

From p.baumann at jacobs-university.de  Mon May 12 14:39:01 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Mon, 12 May 2014 23:39:01 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <53713F55.1030506@jacobs-university.de>
References: <201405102221.50572.even.rouault@mines-paris.org>	<201405122159.31328.even.rouault@mines-paris.org>	<loom.20140512T225741-304@post.gmane.org>
	<201405122318.15978.even.rouault@mines-paris.org>
	<53713F55.1030506@jacobs-university.de>
Message-ID: <53713F75.6020501@jacobs-university.de>

PS: not sure all on this list are aware of this overview page:
http://external.opengeospatial.org/twiki_public/CoveragesDWG/CoveragesBigPicture

-Peter


On 05/12/2014 11:38 PM, Peter Baumann wrote:
> Hi all,
>
> just saw this, thought I'd chime in being the editor of GMLCOV :)
> Any questions, I'll gladly try to answer, I'm just on the road currently, so 
> expect a delay of a day or so.
>
> Trying to respond to what has been raised below:
>
> On 05/12/2014 11:18 PM, Even Rouault wrote:
>> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>>
>>> ...
>>>
>>>>> In light of this, it may be better to use an xml or textual
>>>>> representation and embed it inside an XMP block, which is supported
>>>>> for many formats[1]. Also it would allow for easier human-reading.
>>>> Yes, that's one possibility. Which comes back to GMLJP2 unless there are
>>> other
>>>
>>>> standards...
>>>>
>>>> I'd want to build on something that is a "real" standard or a de-facto
>>>> standard, but not reinvent everything from scratch.
>>> What GMLJP2 gives as a bonus is the axis order trouble
>
> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each coverage 
> has a Native CRS which is defined via an OGC URI (which, in the case of EPSG, 
> refers to the OGP maintained database). In the CRS definition the axis is 
> given unambiguously.
>
> If you don't want to go to that database, use the axisLabels attribute in the 
> Envelope, it lists axes in their proper sequence.
>
>
>>> and not totally
>>> clear interpretation if origin is in the centre (probably it is) or in the
>>> corner of a pixel,
>
> naively, GMLCOV follows the pixel-in center interpretation. However, encodings 
> may override this, such as GeoTIFF (see the pertaining adopted spec [1]).
>
> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
>
>
>>> and rectified grid does not support ground control
>>> points.
>
> yes, because it is rectified. If you want more degree of freedom do not use 
> RectifiedGridCoverage but ReferenceableGridCoverage. In conjunction with GML 
> 3.3 ( a compatible enhancement of GML 3.2.1) this gives you irregular and 
> warped grids. We're not completely done, though, and would be glad about your 
> support in some advanced issues. Note that this work is all voluntary and 
> relies on some project financing to be done. Up to now, EC and ESA have been 
> generous, and so we are going ahead step by step.
>
>
>>> Thus GMLJP2 is at least not better in everything, it has also
>>> drawbacks.
>> Hi Jukka,
>>
>> Yes, for all your above reasons, I would prefer to avoid it.
>
> so which ones are remaining, following the clarification you mention below?
>
> cheers,
> Peter
>
>> Although the axis order trouble (the one of EPSG) and interpretation of origin
>> (pixel center) should be mostly clarified with the revised version.
>> As far as ground countrol points are concerned, I've not really looked at the
>> capabilities of GMLCov, so perhaps there's something in it for that.
>> Otherwise, that would be indeed a drawback.
>>
>>> -Jukka Rahkonen-
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From jukka.rahkonen at mmmtike.fi  Mon May 12 22:36:34 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka  (Tike))
Date: Tue, 13 May 2014 05:36:34 +0000
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
Message-ID: <EFE5D7EE2EC8D3438FE02E356F81E35A0DA1BB9E@FITLK-EXMBX04.msvyvi.vaha.local>

Hi,

This is just a small detail and I may be wrong, but I fear that axisLabels element does not universally remove the need to go to the database because there are systems which use "X" and "Y" as axis names, but the meaning of X and Y can be different. For example for EPSG:3857 X means Easting but for the old Finnish KKJ is means Northing. I can also be wrong in saying the "X" is an axis name because in the following EPSG reports the names seem to be "Easting" and "Northing" and "X" and "Y" are abbreviations. However, by looking at the EPSG:3857 example from the package https://portal.opengeospatial.org/files/?artifact_id=50118 just the ambiguous abbreviations are used as axisLabels.
<gml:axisLabels>x y</gml:axisLabels>

Am I right or am I wrong?

http://epsg-registry.org/report.htm?type=selection&entity=urn:ogc:def:crs:EPSG::2393&reportDetail=short&style=urn:uuid:report-style:default-with-code&style_name=OGP%20Default%20With%20Code&title=Finnish%20KKJ

http://epsg-registry.org/report.htm?type=selection&entity=urn:ogc:def:crs:EPSG::3857&reportDetail=short&style=urn:uuid:report-style:default-with-code&style_name=OGP%20Default%20With%20Code&title=EPSG:3857

Regards,

-Jukka Rahkonen-

Peter Baumann wrote:

> Hi all,
> 
> just saw this, thought I'd chime in being the editor of GMLCOV :) Any questions,
> I'll gladly try to answer, I'm just on the road currently, so expect a delay of a day
> or so.
> 
> Trying to respond to what has been raised below:
> 
> On 05/12/2014 11:18 PM, Even Rouault wrote:
> > Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
> >> Even Rouault <even.rouault <at> mines-paris.org> writes:
> >>
> >> ...
> >>
> >>>> In light of this, it may be better to use an xml or textual
> >>>> representation and embed it inside an XMP block, which is supported
> >>>> for many formats[1]. Also it would allow for easier human-reading.
> >>> Yes, that's one possibility. Which comes back to GMLJP2 unless there
> >>> are
> >> other
> >>
> >>> standards...
> >>>
> >>> I'd want to build on something that is a "real" standard or a
> >>> de-facto standard, but not reinvent everything from scratch.
> >> What GMLJP2 gives as a bonus is the axis order trouble
> 
> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each coverage
> has a Native CRS which is defined via an OGC URI (which, in the case of EPSG,
> refers to the OGP maintained database). In the CRS definition the axis is given
> unambiguously.
> 
> If you don't want to go to that database, use the axisLabels attribute in the
> Envelope, it lists axes in their proper sequence.
> 
> 
> >> and not totally
> >> clear interpretation if origin is in the centre (probably it is) or in the
> >> corner of a pixel,
> 
> naively, GMLCOV follows the pixel-in center interpretation. However, encodings
> may override this, such as GeoTIFF (see the pertaining adopted spec [1]).
> 
> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
> 
> 
> >> and rectified grid does not support ground control
> >> points.
> 
> yes, because it is rectified. If you want more degree of freedom do not use
> RectifiedGridCoverage but ReferenceableGridCoverage. In conjunction with
> GML 3.3
> ( a compatible enhancement of GML 3.2.1) this gives you irregular and warped
> grids. We're not completely done, though, and would be glad about your
> support
> in some advanced issues. Note that this work is all voluntary and relies on some
> project financing to be done. Up to now, EC and ESA have been generous, and
> so
> we are going ahead step by step.
> 
> 
> >> Thus GMLJP2 is at least not better in everything, it has also
> >> drawbacks.
> > Hi Jukka,
> >
> > Yes, for all your above reasons, I would prefer to avoid it.
> 
> so which ones are remaining, following the clarification you mention below?
> 
> cheers,
> Peter
> 
> > Although the axis order trouble (the one of EPSG) and interpretation of origin
> > (pixel center) should be mostly clarified with the revised version.
> > As far as ground countrol points are concerned, I've not really looked at the
> > capabilities of GMLCov, so perhaps there's something in it for that.
> > Otherwise, that would be indeed a drawback.
> >
> >> -Jukka Rahkonen-
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Dr. Peter Baumann
>   - Professor of Computer Science, Jacobs University Bremen
>     www.faculty.jacobs-university.de/pbaumann
>     mail: p.baumann at jacobs-university.de
>     tel: +49-421-200-3178, fax: +49-421-200-493178
>   - Executive Director, rasdaman GmbH Bremen (HRB 26793)
>     www.rasdaman.com, mail: baumann at rasdaman.com
>     tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
> "Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis
> dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec
> preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)
> 


From robert.coup at onetrackmind.co.nz  Tue May 13 01:28:53 2014
From: robert.coup at onetrackmind.co.nz (Robert Coup)
Date: Tue, 13 May 2014 20:28:53 +1200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <201405122159.31328.even.rouault@mines-paris.org>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405102349.56161.even.rouault@mines-paris.org>
	<CA+TxYvPUZnD5TS-8u31b+g5R_=QX7TPH3gz_vrC2c1ypmCn2kw@mail.gmail.com>
	<201405122159.31328.even.rouault@mines-paris.org>
Message-ID: <CAFLLRpJy_gT2+y6EgK7577JNaj88qFe1t233R_poGb-+EXjc3g@mail.gmail.com>

On Tue, May 13, 2014 at 7:59 AM, Even Rouault <even.rouault at mines-paris.org>
 wrote:

> >
> > In light of this, it may be better to use an xml or textual
> representation
> > and embed it inside an XMP block, which is supported for many formats[1].
> > Also it would allow for easier human-reading.
>
> Yes, that's one possibility. Which comes back to GMLJP2 unless there are
> other
> standards...
>
> I'd want to build on something that is a "real" standard or a de-facto
> standard, but not reinvent everything from scratch.
>

While embedding a GeoTIFF inside a JPEG file is straightforward for GDAL, I
would think that doesn't apply to a random implementation (eg. libjpeg) who
wants to support geo-information. But then I learn that EXIF (from what I
can tell) is implemented as a TIFF file stored within the JPEG, so any JPEG
libraries that support EXIF already support TIFF tags.

In terms of "be native", EXIF seems like the right approach to do this,
with a "Geo" IFD alongside "Image" or "GPSInfo", maybe using exactly the
same set of tags as GeoTIFF.

GMLJP2 is arguably more comprehensive and has the benefit of (in theory)
improving on GeoTIFF, but I haven't actually used it in depth, and Jukka
already mentioned missing GCP support.

2c, didn't really get to a conclusion though

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140513/cd91ebc5/attachment.html>

From niggemann at vista-geo.de  Tue May 13 06:23:12 2014
From: niggemann at vista-geo.de (Fabian Niggemann)
Date: Tue, 13 May 2014 15:23:12 +0200
Subject: [gdal-dev] Gdal-Fortran-Linux Problem
Message-ID: <53721CC0.7040609@vista-geo.de>

Hi,

I?m trying to link gdal to fortrangis to use the gdal fortran interface 
on Ubuntu 12.04. I?ve installed gdal Version 1.11. and installed the 
fortrangis package with disabled shared libraries.
If I try now to compile a fortran program(e.g. Command: ifort -I 
/usr/local/include/ gdal_test.F90 /usr/local/lib/libfortranc.a 
/usr/local/lib/libshp.a /usr/local/lib/libfortrangis.a 
/usr/local/lib/libgdal.a) I get a lot of error messages stating 
undefined references:

/usr/local/lib/libgdal.a(genbindataset.o): In function `_Alloc_hider':
/usr/include/c++/4.7/bits/basic_string.h:272: undefined reference to 
`std::string::_Rep::_S_empty_rep_storage'
/usr/local/lib/libgdal.a(genbindataset.o): In function 
`std::string::_Rep::_M_dispose(std::allocator<char> const&)':
/usr/include/c++/4.7/bits/basic_string.h:237: undefined reference to 
`std::string::_Rep::_S_empty_rep_storage'
/usr/include/c++/4.7/bits/basic_string.h:246: undefined reference to 
`std::string::_Rep::_M_destroy(std::allocator<char> const&)'
/usr/local/lib/libgdal.a(genbindataset.o): In function 
`GDALRegister_GenBin':
...


Any help would be appreciated.

Regards,
Fabian

-- 
VISTA Geowissenschaftliche Fernerkundung GmbH
Administration: Anton-Ferstl-Str.11, D-82234 Wessling
Office: Gabelsbergerstr.51, D-80333 M?nchen
Tel. +49 89 287 794 59 Fax +49 89 523 89 804
eMail: niggemann at vista-geo.de; web: www.vista-geo.de

Amtsgericht M?nchen HRB 129776
Sitz der Gesellschaft: Wessling
Gesch?ftsf?hrung: Dr. Heike Bach

Bankverbindung: Hypo Vereinsbank M?nchen
BLZ 70020270 Konto 39042770

USt-IDNr. DE812904252
St.Nr. 11714150105

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140513/d2ad32a5/attachment.html>

From david.tran at hsr.ch  Tue May 13 07:44:03 2014
From: david.tran at hsr.ch (David Tran)
Date: Tue, 13 May 2014 16:44:03 +0200
Subject: [gdal-dev] Qt5.2.1+GDAL1.11+VC10: ogrsf_frmts.h compile errors
Message-ID: <53722FB3.9070902@hsr.ch>

Hi

test.pro
> TEMPLATE = app
> TARGET = test
> DEPENDPATH += $$PWD/src $$PWD/include
> INCLUDEPATH += $$PWD/src $$PWD/include
> SOURCES += src/main.cpp

main.cpp
> //#include "ogr_api.h"
> #include "ogrsf_frmts.h"
> int main() {}

It compiles fine with #include "ogr_api.h", but with #include 
"ogrsf_frmts.h" it has this error log:

http://pastebin.com/8ersPTd4

Why doesn't it compile?

From chaitanya.ch at gmail.com  Tue May 13 07:45:30 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Tue, 13 May 2014 20:15:30 +0530
Subject: [gdal-dev] Convert in-memory raster
In-Reply-To: <1106E45778F04E4D94505A07DD749912121E3D@XCH-PHX-403.sw.nos.boeing.com>
References: <CAJZgoHkuScfZ8KTj6pvpAZsi3nryhrDXKcpNB9LJOKKtsYDsoQ@mail.gmail.com>
	<201405111129.31530.even.rouault@mines-paris.org>
	<1106E45778F04E4D94505A07DD749912121E3D@XCH-PHX-403.sw.nos.boeing.com>
Message-ID: <CAMKgpOY_VVWcmCTOb9+imjiXp_nrR-HDKRAEwg470j8jEmmMbQ@mail.gmail.com>

Anthony,

The closest methods in the gdal algorithms is to use
GDALComputeMatchingPoints(). You'll get a set of GCPs that match one raster
to another. Please report your experience with it here.

--
Best regards,
Chaitanya Kumar CH
On 12-May-2014 11:40 pm, "Baker, Anthony W" <Anthony.W.Baker at boeing.com>
wrote:

> I am interested in registering two images together.  In order to do that I
> would like to align the coordinate frames, the pixel sizes, and the
> rotation of the two frames.  Is there an easy "in-memory" method for doing
> this?
>
> Thank you,
>
> Anthony
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140513/3536c1cb/attachment.html>

From matt.gregory at oregonstate.edu  Tue May 13 14:36:49 2014
From: matt.gregory at oregonstate.edu (Matt Gregory)
Date: Tue, 13 May 2014 14:36:49 -0700
Subject: [gdal-dev] VRT ComputeStatistics fails because of self-reference
Message-ID: <lku39h$l76$1@ger.gmane.org>

Hi all,

I'm trying to compute statistics on a VRT file using the python 
band.ComputeStatistics method.  I'm using GDAL 1.10.1 on a Windows 7 
64-bit box.

First, I create a VRT clip of a larger raster using gdal_translate, e.g.

   gdal_translate -of VRT -projwin <sub_window> in.tif out.vrt

Then, in Python, I try to compute statistics:

   ds = gdal.OpenShared('out.vrt', gdalconst.GA_ReadOnly)
   rb = ds.GetRasterBand(1)
   (min, max, mean, std) = rb.ComputeStatistics(False)

This fails with many messages of:

   ERROR 1: VRTSourcedRasterBand::IRasterIO() called recursively on
     the same band.
   It looks like the VRT is referencing itself.
   ERROR 1: test.vrt, band 29: IReadBlock failed at X offset 1, Y
     offset 3

I can replicate the same behavior by first creating the VRT using 
gdal_translate and then calling gdalinfo -stats on it.

I see in the code that I'm triggering the bAntiRecursionFlag within the 
GetMinimum and GetMaximum member functions, but unclear how this is 
coming about.

thanks for help,
matt


From "gdal-dev-list-mail" at alintech.com.au  Tue May 13 19:28:25 2014
From: "gdal-dev-list-mail" at alintech.com.au (Wilson Waters)
Date: Wed, 14 May 2014 10:28:25 +0800
Subject: [gdal-dev] ENVI driver patch
Message-ID: <mailman.4.1400034534.1974.gdal-dev@lists.osgeo.org>

Hi all,

I've been working with ENVI files lately and have come across a few 
issues. I'm hoping you can point out if I'm doing something wrong or if 
I should create a GDAL bug with the attached patch.

We found our ENVI .hdr files were being corrupted whenever opened in 
write mode with GDAL. No changes to the data or metadata are required to 
corrupt the file, simply opening the file in write mode was enough. I've 
attached example before and after .hdr files. These files have map info 
projection set to "Arbitrary" (we're not storing map data. It's long 
skinny images of underground drill core).

This is the process causing the corruption in ENVIDataset:
1) open envi file in read/write mode uses OPEN_EXISTING flag on .hdr
2) ENVIDataset::Open() doesn't understand "Arbitrary" projection so 
generates a "LOCAL_CS" projection string
3) close dataset causing ENVIDataset::FlushCache() to be called
4) FlushCache() re-writes hdr file as the bHeaderDirty was set in the 
Open() function. map info field is omitted for some reason?
5) FlushCache() overwrites the old hdr file without clearing first 
causing trailing data in the file

As far as I can tell there are four bugs in the ENVIDataset related to this
1) ENVIDataset::ProcessMapinfo() Doesn't understand the "Arbitrary" 
projection and defaults to LOCAL_CS - which is probably ok, but;
2) ENVIDataset::WriteProjectionInfo fails to write map info field when 
projection is LOCAL_CS
3) ENVIDataset::Open() causes bHeaderDirty to be set (should only happen 
when something external updates the image?)
4) ENVIDataset::FlushCache() should truncate existing file before 
overwriting

We're using GDAL 1.11 on windows, though I think the behaviour would be 
the same on any OS.

Any pointers on whether I'm doing the right thing and if I should submit 
a trac bug?

Cheers,
Wilson.
-------------- next part --------------
ENVI
description = {
C:\bad.bin}
samples = 58
lines   = 1967
bands   = 1
header offset = 0
file type = ENVI Standard
data type = 4
interleave = bsq
byte order = 0
band names = {
example band name}
5, -81.68, 0.0005, 0.0005, 0, North}

band names = {

example band name}

-------------- next part --------------
ENVI
description = {
C:\good.bin}
samples = 58
lines   = 1967
bands   = 1
header offset = 0
file type = ENVI Standard
data type = 4
interleave = bsq
byte order = 0
map info = {Arbitrary, 1, 1, -0.0145, -81.68, 0.0005, 0.0005, 0, North}
band names = {
example band name}
-------------- next part --------------
Index: envidataset.cpp
===================================================================
--- envidataset.cpp	(revision 1427)
+++ envidataset.cpp	(working copy)
@@ -370,6 +370,12 @@
 
     CPLLocaleC  oLocaleEnforcer;
 
+    //ww bugfix
+    // If opening an existing file in Update mode (i.e. "r+") we need to make
+    // sure any existing content is cleared, otherwise the file may contain 
+    // trailing content from the previous write.
+    VSIFTruncateL( fp, 0 );
+
     VSIFSeekL( fp, 0, SEEK_SET );
 /* -------------------------------------------------------------------- */
 /*      Rewrite out the header.                                           */
@@ -668,14 +674,14 @@
 /*      Minimal case - write out simple geotransform if we have a       */
 /*      non-default geotransform.                                       */
 /* -------------------------------------------------------------------- */
-    if( pszProjection == NULL || strlen(pszProjection) == 0 )
+    if( pszProjection == NULL || strlen(pszProjection) == 0 || (strlen(pszProjection) >= 8 && strncmp(pszProjection, "LOCAL_CS", 8) != 0 ) )
     {
         if( adfGeoTransform[0] != 0.0 || adfGeoTransform[1] != 1.0
             || adfGeoTransform[2] != 0.0 || adfGeoTransform[3] != 0.0
             || adfGeoTransform[4] != 0.0 || adfGeoTransform[5] != 1.0 )
         {
             const char* pszHemisphere = "North";
-            VSIFPrintfL( fp, "map info = {Unknown, %s, %d, %s}\n",
+            VSIFPrintfL( fp, "map info = {Arbitrary, %s, %d, %s}\n",
                          osLocation.c_str(), 0, pszHemisphere);
         }
         return;
@@ -2504,6 +2510,11 @@
 /* -------------------------------------------------------------------- */
     poDS->oOvManager.Initialize( poDS, poOpenInfo->pszFilename );
 
+    //ww bug fix.
+    // SetMetadata() calls in Open() makes the header dirty.
+    // Don't re-write the header if nothing external has changed the metadata
+    poDS->bHeaderDirty = FALSE;
+
     return( poDS );
 }
 

From gdal at stripfamily.net  Tue May 13 21:40:46 2014
From: gdal at stripfamily.net (David Strip)
Date: Tue, 13 May 2014 22:40:46 -0600
Subject: [gdal-dev] GeoTiff crashing qgis
Message-ID: <5372F3CE.7060008@stripfamily.net>

I have a piece of C++ code that is clipping regions from a very large
(roughly 90,000 x 100,000 pixels, 11G compressed)  Float32 gray-scale
single band image and writing each as a separate GeoTiff (with LZW
compression). In the sample that I've run, I've clipped four different
regions. gdalinfo can read and provide a description of all four,
however for only two of the images does gdalinfo provide summary
statistics. I can open  two of the images in qgis, while the two that
fail to produce summary statistics cause qgis to hang when I try to open
them. The two that I can open have block sizes of 247x8  (image size
247,311) and 583x3 (image size 583,602) , while the two that fail have
block size 1198x1 (image size 1198, 809) and block size 1444x1 (image
size 1444, 1007).  I'm not sure why the block size would have an impact,
esp since the ones that fail are n x 1, which I would think would be the
easier to read in less capable systems, but it's the only common factor
I've found so far.

All four images display correctly in the Windows Photo Viewer (Win 7).

I'm a bit reluctant to show the whole code since it would take quite a
few lines to get the whole picture down to the gdal calls. The heart of
the write is done using GDALRasterBand::RasterIO, though.

At the moment I'm at a loss as to where to start looking for the problem.
Any suggestions are most welcome.

David Strip


From even.rouault at mines-paris.org  Wed May 14 01:45:49 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 10:45:49 +0200
Subject: [gdal-dev] ENVI driver patch
In-Reply-To: <20140514022855.48CCF83EC@lists.osgeo.org>
References: <20140514022855.48CCF83EC@lists.osgeo.org>
Message-ID: <201405141045.49615.even.rouault@mines-paris.org>

Wilson,

at first sight, I'd say it looks reasonable, but could you post your below 
analysis, patch and samples files as a ticket ( 
http://trac.osgeo.org/gdal/newticket ) so that it doesn't get lost ?

But there's one thing I didn't understand well. In your patch, you changed 
"Unknown" to "Arbitrary" because that's what ENVI requires ?

Even

> Hi all,
> 
> I've been working with ENVI files lately and have come across a few
> issues. I'm hoping you can point out if I'm doing something wrong or if
> I should create a GDAL bug with the attached patch.
> 
> We found our ENVI .hdr files were being corrupted whenever opened in
> write mode with GDAL. No changes to the data or metadata are required to
> corrupt the file, simply opening the file in write mode was enough. I've
> attached example before and after .hdr files. These files have map info
> projection set to "Arbitrary" (we're not storing map data. It's long
> skinny images of underground drill core).
> 
> This is the process causing the corruption in ENVIDataset:
> 1) open envi file in read/write mode uses OPEN_EXISTING flag on .hdr
> 2) ENVIDataset::Open() doesn't understand "Arbitrary" projection so
> generates a "LOCAL_CS" projection string
> 3) close dataset causing ENVIDataset::FlushCache() to be called
> 4) FlushCache() re-writes hdr file as the bHeaderDirty was set in the
> Open() function. map info field is omitted for some reason?
> 5) FlushCache() overwrites the old hdr file without clearing first
> causing trailing data in the file
> 
> As far as I can tell there are four bugs in the ENVIDataset related to this
> 1) ENVIDataset::ProcessMapinfo() Doesn't understand the "Arbitrary"
> projection and defaults to LOCAL_CS - which is probably ok, but;
> 2) ENVIDataset::WriteProjectionInfo fails to write map info field when
> projection is LOCAL_CS
> 3) ENVIDataset::Open() causes bHeaderDirty to be set (should only happen
> when something external updates the image?)
> 4) ENVIDataset::FlushCache() should truncate existing file before
> overwriting
> 
> We're using GDAL 1.11 on windows, though I think the behaviour would be
> the same on any OS.
> 
> Any pointers on whether I'm doing the right thing and if I should submit
> a trac bug?
> 
> Cheers,
> Wilson.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Wed May 14 02:05:08 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 14 May 2014 09:05:08 +0000 (UTC)
Subject: [gdal-dev] GeoTiff crashing qgis
References: <5372F3CE.7060008@stripfamily.net>
Message-ID: <loom.20140514T110038-725@post.gmane.org>

David Strip <gdal <at> stripfamily.net> writes:

> At the moment I'm at a loss as to where to start looking for the problem.
> Any suggestions are most welcome.

Send us links to the images you have created with GDAL and which make
troubles with QGIS. Perhaps someone finds what is wrong in these images.
Next step would be to think how it is possible to make GDAL to write out
such unfriendly files.

-Jukka Rahkonen-






From "gdal-dev-list-mail" at alintech.com.au  Wed May 14 02:13:21 2014
From: "gdal-dev-list-mail" at alintech.com.au (Wilson Waters)
Date: Wed, 14 May 2014 17:13:21 +0800
Subject: [gdal-dev] ENVI driver patch
In-Reply-To: <201405141045.49615.even.rouault@mines-paris.org>
References: <20140514022855.48CCF83EC@lists.osgeo.org>
	<201405141045.49615.even.rouault@mines-paris.org>
Message-ID: <mailman.5.1400058827.1974.gdal-dev@lists.osgeo.org>

Hi Even,

I just created ticket http://trac.osgeo.org/gdal/ticket/5467

I'm no expert in ENVI files but found the only way to get the .hdr files 
working in the ENVI application was to change the "Unknown" map info 
projection to "Arbitrary". The best reference I've found for this is 
http://www.exelisvis.com/docs/ENVI_MAP_INFO_CREATE.html

Regards,
Wilson

On 14/05/2014 4:45 PM, Even Rouault wrote:
> Wilson,
>
> at first sight, I'd say it looks reasonable, but could you post your below
> analysis, patch and samples files as a ticket (
> http://trac.osgeo.org/gdal/newticket ) so that it doesn't get lost ?
>
> But there's one thing I didn't understand well. In your patch, you changed
> "Unknown" to "Arbitrary" because that's what ENVI requires ?
>
> Even
>
>> Hi all,
>>
>> I've been working with ENVI files lately and have come across a few
>> issues. I'm hoping you can point out if I'm doing something wrong or if
>> I should create a GDAL bug with the attached patch.
>>
>> We found our ENVI .hdr files were being corrupted whenever opened in
>> write mode with GDAL. No changes to the data or metadata are required to
>> corrupt the file, simply opening the file in write mode was enough. I've
>> attached example before and after .hdr files. These files have map info
>> projection set to "Arbitrary" (we're not storing map data. It's long
>> skinny images of underground drill core).
>>
>> This is the process causing the corruption in ENVIDataset:
>> 1) open envi file in read/write mode uses OPEN_EXISTING flag on .hdr
>> 2) ENVIDataset::Open() doesn't understand "Arbitrary" projection so
>> generates a "LOCAL_CS" projection string
>> 3) close dataset causing ENVIDataset::FlushCache() to be called
>> 4) FlushCache() re-writes hdr file as the bHeaderDirty was set in the
>> Open() function. map info field is omitted for some reason?
>> 5) FlushCache() overwrites the old hdr file without clearing first
>> causing trailing data in the file
>>
>> As far as I can tell there are four bugs in the ENVIDataset related to this
>> 1) ENVIDataset::ProcessMapinfo() Doesn't understand the "Arbitrary"
>> projection and defaults to LOCAL_CS - which is probably ok, but;
>> 2) ENVIDataset::WriteProjectionInfo fails to write map info field when
>> projection is LOCAL_CS
>> 3) ENVIDataset::Open() causes bHeaderDirty to be set (should only happen
>> when something external updates the image?)
>> 4) ENVIDataset::FlushCache() should truncate existing file before
>> overwriting
>>
>> We're using GDAL 1.11 on windows, though I think the behaviour would be
>> the same on any OS.
>>
>> Any pointers on whether I'm doing the right thing and if I should submit
>> a trac bug?
>>
>> Cheers,
>> Wilson.

From even.rouault at mines-paris.org  Wed May 14 02:22:56 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 11:22:56 +0200
Subject: [gdal-dev] VRT ComputeStatistics fails because of self-reference
In-Reply-To: <lku39h$l76$1@ger.gmane.org>
References: <lku39h$l76$1@ger.gmane.org>
Message-ID: <201405141122.57369.even.rouault@mines-paris.org>

Matt,

thanks for the report. I'm a bit surprised this hasn't been reported before as 
it dates back to 1.10.0. Anyway, I've created a ticket 
http://trac.osgeo.org/gdal/ticket/5468 for that issue and pushed a fix for 
1.10, 1.11 and trunk branches.
I cannot think to a workaround, apart from upgrading from sources.

Even

> Hi all,
> 
> I'm trying to compute statistics on a VRT file using the python
> band.ComputeStatistics method.  I'm using GDAL 1.10.1 on a Windows 7
> 64-bit box.
> 
> First, I create a VRT clip of a larger raster using gdal_translate, e.g.
> 
>    gdal_translate -of VRT -projwin <sub_window> in.tif out.vrt
> 
> Then, in Python, I try to compute statistics:
> 
>    ds = gdal.OpenShared('out.vrt', gdalconst.GA_ReadOnly)
>    rb = ds.GetRasterBand(1)
>    (min, max, mean, std) = rb.ComputeStatistics(False)
> 
> This fails with many messages of:
> 
>    ERROR 1: VRTSourcedRasterBand::IRasterIO() called recursively on
>      the same band.
>    It looks like the VRT is referencing itself.
>    ERROR 1: test.vrt, band 29: IReadBlock failed at X offset 1, Y
>      offset 3
> 
> I can replicate the same behavior by first creating the VRT using
> gdal_translate and then calling gdalinfo -stats on it.
> 
> I see in the code that I'm triggering the bAntiRecursionFlag within the
> GetMinimum and GetMaximum member functions, but unclear how this is
> coming about.
> 
> thanks for help,
> matt
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 14 03:53:32 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 12:53:32 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
Message-ID: <201405141253.32397.even.rouault@mines-paris.org>

Hi,

I've followed the update process of the EPSG SRS database to latest v8.4, and 
just committed the updated files into libgeotiff, GDAL and PROJ trunk. Also 
submitted to PostGIS.

From what I can see, among many changes and additions, 2 new projection 
methods have been added:
* 1051,Lambert Conic Conformal (2SP Michigan)
--> looks very close to standard "Lambert Conic Conformal (2SP)", with the 
addition of a new parameter K, the ellipsoid scaling factor.
* 1052,Colombia Urban

I don't think any of those 2 new methods are currently handled by PROJ, so the 
new PCS based on those projection methods (3 Michigan SRS, and several dozains 
of Colombia PCS) will not be handled by GDAL nor PROJ.

Regarding GDAL, I've improved the add_esri_column.py script (see 
http://trac.osgeo.org/geotiff/changeset/2446), so that we have more ESRI DATUM 
names. That should make morphing from/to ESRI .prj files a bit better.

Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also added 
the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound Horizontal 
+ Vertical).

Please let me know if you see issues.

libgeotiff:
http://trac.osgeo.org/geotiff/ticket/63
http://trac.osgeo.org/geotiff/changeset/2447

GDAL:
http://trac.osgeo.org/gdal/ticket/5462
http://trac.osgeo.org/gdal/changeset/27322

PROJ:
http://trac.osgeo.org/proj/ticket/236
http://trac.osgeo.org/proj/changeset/2448

Submitted for PostGIS :
http://trac.osgeo.org/postgis/ticket/2737

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 14 04:30:54 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 13:30:54 +0200
Subject: [gdal-dev] Qt5.2.1+GDAL1.11+VC10: ogrsf_frmts.h compile errors
In-Reply-To: <53722FB3.9070902@hsr.ch>
References: <53722FB3.9070902@hsr.ch>
Message-ID: <201405141330.54313.even.rouault@mines-paris.org>

Le mardi 13 mai 2014 16:44:03, David Tran a ?crit :
> Hi
> 
> test.pro
> 
> > TEMPLATE = app
> > TARGET = test
> > DEPENDPATH += $$PWD/src $$PWD/include
> > INCLUDEPATH += $$PWD/src $$PWD/include
> > SOURCES += src/main.cpp
> 
> main.cpp
> 
> > //#include "ogr_api.h"
> > #include "ogrsf_frmts.h"
> > int main() {}
> 
> It compiles fine with #include "ogr_api.h", but with #include
> "ogrsf_frmts.h" it has this error log:
> 
> http://pastebin.com/8ersPTd4
> 
> Why doesn't it compile?

It compiles from what I can see. The error is at linking stage. You need to 
link against gdal_i.lib

As those are rather basic C++ development questions, not particularly related 
to GDAL specificities, perhaps you should try to find guidance from someone a 
bit closer to you to get you started more efficiently.

> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 14 04:33:05 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 13:33:05 +0200
Subject: [gdal-dev] Gdal-Fortran-Linux Problem
In-Reply-To: <53721CC0.7040609@vista-geo.de>
References: <53721CC0.7040609@vista-geo.de>
Message-ID: <201405141333.05160.even.rouault@mines-paris.org>

Le mardi 13 mai 2014 15:23:12, Fabian Niggemann a ?crit :
> Hi,
> 
> I?m trying to link gdal to fortrangis to use the gdal fortran interface
> on Ubuntu 12.04. I?ve installed gdal Version 1.11. and installed the
> fortrangis package with disabled shared libraries.
> If I try now to compile a fortran program(e.g. Command: ifort -I
> /usr/local/include/ gdal_test.F90 /usr/local/lib/libfortranc.a
> /usr/local/lib/libshp.a /usr/local/lib/libfortrangis.a
> /usr/local/lib/libgdal.a) I get a lot of error messages stating
> undefined references:
> 
> /usr/local/lib/libgdal.a(genbindataset.o): In function `_Alloc_hider':
> /usr/include/c++/4.7/bits/basic_string.h:272: undefined reference to
> `std::string::_Rep::_S_empty_rep_storage'
> /usr/local/lib/libgdal.a(genbindataset.o): In function
> `std::string::_Rep::_M_dispose(std::allocator<char> const&)':
> /usr/include/c++/4.7/bits/basic_string.h:237: undefined reference to
> `std::string::_Rep::_S_empty_rep_storage'
> /usr/include/c++/4.7/bits/basic_string.h:246: undefined reference to
> `std::string::_Rep::_M_destroy(std::allocator<char> const&)'
> /usr/local/lib/libgdal.a(genbindataset.o): In function
> `GDALRegister_GenBin':
> ...

fortangis, I can't believe it ;-)

Looks like you need to link against libstdc++ too. Can't you dynamically link 
against libgdal.so ? That would avoid that issue.

> 
> 
> Any help would be appreciated.
> 
> Regards,
> Fabian

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From niggemann at vista-geo.de  Wed May 14 05:12:22 2014
From: niggemann at vista-geo.de (Fabian Niggemann)
Date: Wed, 14 May 2014 14:12:22 +0200
Subject: [gdal-dev] Gdal-Fortran-Linux Problem
In-Reply-To: <201405141333.05160.even.rouault@mines-paris.org>
References: <53721CC0.7040609@vista-geo.de>
	<201405141333.05160.even.rouault@mines-paris.org>
Message-ID: <53735DA6.5020104@vista-geo.de>

Am 14.05.2014 13:33, schrieb Even Rouault:
> Le mardi 13 mai 2014 15:23:12, Fabian Niggemann a ?crit :
>> Hi,
>>
>> I?m trying to link gdal to fortrangis to use the gdal fortran interface
>> on Ubuntu 12.04. I?ve installed gdal Version 1.11. and installed the
>> fortrangis package with disabled shared libraries.
>> If I try now to compile a fortran program(e.g. Command: ifort -I
>> /usr/local/include/ gdal_test.F90 /usr/local/lib/libfortranc.a
>> /usr/local/lib/libshp.a /usr/local/lib/libfortrangis.a
>> /usr/local/lib/libgdal.a) I get a lot of error messages stating
>> undefined references:
>>
>> /usr/local/lib/libgdal.a(genbindataset.o): In function `_Alloc_hider':
>> /usr/include/c++/4.7/bits/basic_string.h:272: undefined reference to
>> `std::string::_Rep::_S_empty_rep_storage'
>> /usr/local/lib/libgdal.a(genbindataset.o): In function
>> `std::string::_Rep::_M_dispose(std::allocator<char> const&)':
>> /usr/include/c++/4.7/bits/basic_string.h:237: undefined reference to
>> `std::string::_Rep::_S_empty_rep_storage'
>> /usr/include/c++/4.7/bits/basic_string.h:246: undefined reference to
>> `std::string::_Rep::_M_destroy(std::allocator<char> const&)'
>> /usr/local/lib/libgdal.a(genbindataset.o): In function
>> `GDALRegister_GenBin':
>> ...
> fortangis, I can't believe it ;-)
>
> Looks like you need to link against libstdc++ too. Can't you dynamically link
> against libgdal.so ? That would avoid that issue.
>
>>
>> Any help would be appreciated.
>>
>> Regards,
>> Fabian
Hi Evan,

I think you solved my problem. Dynamically linking to libgdal.so helped.
Thanks a lot!

-- 
VISTA Geowissenschaftliche Fernerkundung GmbH
Administration: Anton-Ferstl-Str.11, D-82234 Wessling
Office: Gabelsbergerstr.51, D-80333 M?nchen
Tel. +49 89 287 794 59 Fax +49 89 523 89 804
eMail: niggemann at vista-geo.de; web: www.vista-geo.de

Amtsgericht M?nchen HRB 129776
Sitz der Gesellschaft: Wessling
Gesch?ftsf?hrung: Dr. Heike Bach

Bankverbindung: Hypo Vereinsbank M?nchen
BLZ 70020270 Konto 39042770

USt-IDNr. DE812904252
St.Nr. 11714150105


From even.rouault at mines-paris.org  Wed May 14 05:31:27 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 14:31:27 +0200
Subject: [gdal-dev] Idea: GeoTIFF box in JPEG to add georeferencing
In-Reply-To: <53713F55.1030506@jacobs-university.de>
References: <201405102221.50572.even.rouault@mines-paris.org>
	<201405122318.15978.even.rouault@mines-paris.org>
	<53713F55.1030506@jacobs-university.de>
Message-ID: <201405141431.27981.even.rouault@mines-paris.org>

> so which ones are remaining, following the clarification you mention below?

Hi Peter,

thanks for the clarifications.

To be honest, my main reluctance to GML-based standards is that they are very 
rich, and thus difficult to understand and implement. A rather large chain of 
depending standards : GMLJP2 refers to GMLCov which refers to GML which refers 
to etc.... And generally there are many ways in GML to express the same thing, 
which makes it difficult to implement the reading part. I had some fun a few 
weeks ago with that with polygons : http://erouault.blogspot.fr/2014/04/gml-
madness.html ...

To come back to more concrete considerations, the axis order issue, as 
confirmed by Jukka, is something that we constantly have to face and have 
troubles to get right.
Jukka, in his review of the new proposed GMLJP2 ( 
http://lists.opengeospatial.org/pipermail/requests/2014-March/000220.html ), 
also raised an interesting question about all the different forms of urn/uri 
that might be found to express SRS.

Another related point is: how do you encode a SRS that is not in the EPSG 
database ? In GDAL's code related to generation of GMLJP2, I see that when we 
write a GMLJP2 with a SRS that is not linked to an EPSG code, we build a local 
GML definition of the SRS, put it in a CRSDictionary.gml JP2 box and link to it 
with "gmljp2://xml/CRSDictionary.gml#ogrcrs1" in the GMLJP2 box. So, to use 
GMLCov in PNG/JPEG/etc... we would likely need both a GMLCov "box" and a CRS 
"box". Not very convenient.

And for fun, you'll find below in [1] how the proj.4 string "+proj=utm +zone=36 
+ellps=WGS84" is translated into GML...

Another practical issue is that the current export/import code in GDAL 
from/into the GML definition is limited to Transverse Mercator and Lambert 
Conformal Conic. No fundamental reason that it couldn't be improved, but 
someone would have to do it.
Besides, I'm not sure if many other software packages implement that GML 
definition of SRS either. For example, it looks like GeoTools doesn't :
http://osgeo-org.1560.x6.nabble.com/Parsing-GML-CRS-definitions-td4963620.html 

I agree with Frank that it is difficult to get excited by GeoTIFF either. The 
main advantages I can see is that :
* it is already rather well supported by most geo-enabled software due to its 
long existence and maturity. So basing something on it shouldn't involve a lot 
of work.
* its binary form makes it rather compact, which is good for example if you 
want to add georeferencing to small PNG/JPEG tiles.

Best regards,

Even

[1] 

<gml:ProjectedCRS gml:id="ogrcrs1">
  <gml:srsName>UTM Zone 36, Northern Hemisphere</gml:srsName>
  <gml:baseCRS>
    <gml:GeographicCRS gml:id="ogrcrs2">
      <gml:srsName>WGS 84</gml:srsName>
      <gml:usesEllipsoidalCS>
        <gml:EllipsoidalCS gml:id="ogrcrs3">
          <gml:csName>ellipsoidal</gml:csName>
          <gml:csID>
            <gml:name gml:codeSpace="urn:ogc:def:cs:EPSG::">6402</gml:name>
          </gml:csID>
          <gml:usesAxis>
            <gml:CoordinateSystemAxis gml:id="ogrcrs4" 
gml:uom="urn:ogc:def:uom:EPSG::9102">
              <gml:name>Geodetic latitude</gml:name>
              <gml:axisID>
                <gml:name 
gml:codeSpace="urn:ogc:def:axis:EPSG::">9901</gml:name>
              </gml:axisID>
              <gml:axisAbbrev>Lat</gml:axisAbbrev>
              <gml:axisDirection>north</gml:axisDirection>
            </gml:CoordinateSystemAxis>
          </gml:usesAxis>
          <gml:usesAxis>
            <gml:CoordinateSystemAxis gml:id="ogrcrs5" 
gml:uom="urn:ogc:def:uom:EPSG::9102">
              <gml:name>Geodetic longitude</gml:name>
              <gml:axisID>
                <gml:name 
gml:codeSpace="urn:ogc:def:axis:EPSG::">9902</gml:name>
              </gml:axisID>
              <gml:axisAbbrev>Lon</gml:axisAbbrev>
              <gml:axisDirection>east</gml:axisDirection>
            </gml:CoordinateSystemAxis>
          </gml:usesAxis>
        </gml:EllipsoidalCS>
      </gml:usesEllipsoidalCS>
      <gml:usesGeodeticDatum>
        <gml:GeodeticDatum gml:id="ogrcrs6">
          <gml:datumName>unknown</gml:datumName>
          <gml:usesPrimeMeridian>
            <gml:PrimeMeridian gml:id="ogrcrs7">
              <gml:meridianName>Greenwich</gml:meridianName>
              <gml:greenwichLongitude>
                <gml:angle gml:uom="urn:ogc:def:uom:EPSG::9102">0</gml:angle>
              </gml:greenwichLongitude>
            </gml:PrimeMeridian>
          </gml:usesPrimeMeridian>
          <gml:usesEllipsoid>
            <gml:Ellipsoid gml:id="ogrcrs8">
              <gml:ellipsoidName>WGS84</gml:ellipsoidName>
              <gml:semiMajorAxis 
gml:uom="urn:ogc:def:uom:EPSG::9001">6378137</gml:semiMajorAxis>
              <gml:secondDefiningParameter>
                <gml:inverseFlattening 
gml:uom="urn:ogc:def:uom:EPSG::9201">298.257223563</gml:inverseFlattening>
              </gml:secondDefiningParameter>
            </gml:Ellipsoid>
          </gml:usesEllipsoid>
        </gml:GeodeticDatum>
      </gml:usesGeodeticDatum>
    </gml:GeographicCRS>
  </gml:baseCRS>
  <gml:definedByConversion>
    <gml:Conversion gml:id="ogrcrs9">
      <gml:usesMethod xlink:href="urn:ogc:def:method:EPSG::9807" />
      <gml:usesParameterValue>
        <gml:value gml:uom="urn:ogc:def:uom:EPSG::9102">0</gml:value>
        <gml:valueOfParameter xlink:href="urn:ogc:def:parameter:EPSG::8801" />
      </gml:usesParameterValue>
      <gml:usesParameterValue>
        <gml:value gml:uom="urn:ogc:def:uom:EPSG::9102">33</gml:value>
        <gml:valueOfParameter xlink:href="urn:ogc:def:parameter:EPSG::8802" />
      </gml:usesParameterValue>
      <gml:usesParameterValue>
        <gml:value gml:uom="urn:ogc:def:uom:EPSG::9001">0.9996</gml:value>
        <gml:valueOfParameter xlink:href="urn:ogc:def:parameter:EPSG::8805" />
      </gml:usesParameterValue>
      <gml:usesParameterValue>
        <gml:value gml:uom="urn:ogc:def:uom:EPSG::9001">500000</gml:value>
        <gml:valueOfParameter xlink:href="urn:ogc:def:parameter:EPSG::8806" />
      </gml:usesParameterValue>
      <gml:usesParameterValue>
        <gml:value gml:uom="urn:ogc:def:uom:EPSG::9001">0</gml:value>
        <gml:valueOfParameter xlink:href="urn:ogc:def:parameter:EPSG::8807" />
      </gml:usesParameterValue>
    </gml:Conversion>
  </gml:definedByConversion>
  <gml:usesCartesianCS>
    <gml:CartesianCS gml:id="ogrcrs10">
      <gml:csName>Cartesian</gml:csName>
      <gml:csID>
        <gml:name gml:codeSpace="urn:ogc:def:cs:EPSG::">4400</gml:name>
      </gml:csID>
      <gml:usesAxis>
        <gml:CoordinateSystemAxis gml:id="ogrcrs11" 
gml:uom="urn:ogc:def:uom:EPSG::9001">
          <gml:name>Easting</gml:name>
          <gml:axisID>
            <gml:name gml:codeSpace="urn:ogc:def:axis:EPSG::">9906</gml:name>
          </gml:axisID>
          <gml:axisAbbrev>E</gml:axisAbbrev>
          <gml:axisDirection>east</gml:axisDirection>
        </gml:CoordinateSystemAxis>
      </gml:usesAxis>
      <gml:usesAxis>
        <gml:CoordinateSystemAxis gml:id="ogrcrs12" 
gml:uom="urn:ogc:def:uom:EPSG::9001">
          <gml:name>Northing</gml:name>
          <gml:axisID>
            <gml:name gml:codeSpace="urn:ogc:def:axis:EPSG::">9907</gml:name>
          </gml:axisID>
          <gml:axisAbbrev>N</gml:axisAbbrev>
          <gml:axisDirection>north</gml:axisDirection>
        </gml:CoordinateSystemAxis>
      </gml:usesAxis>
    </gml:CartesianCS>
  </gml:usesCartesianCS>
</gml:ProjectedCRS>

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From etourigny.dev at gmail.com  Wed May 14 07:11:36 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Wed, 14 May 2014 11:11:36 -0300
Subject: [gdal-dev] Gdal-Fortran-Linux Problem
In-Reply-To: <53721CC0.7040609@vista-geo.de>
References: <53721CC0.7040609@vista-geo.de>
Message-ID: <CA+TxYvMHV-r4hR-KX7QhPXx6c869NFgrW3a=jgC+8fGJS2yEnw@mail.gmail.com>

pretty interesting - it would be nice to incorporate the gdal fortran
bindings inside the gdal source!

however, it is distributed under the  GNU Lesser General Public License, so
I think it's not possible...

Cheers
Etienne


On Tue, May 13, 2014 at 10:23 AM, Fabian Niggemann
<niggemann at vista-geo.de>wrote:

>  Hi,
>
> I?m trying to link gdal to fortrangis to use the gdal fortran interface on
> Ubuntu 12.04. I?ve installed gdal Version 1.11. and installed the
> fortrangis package with disabled shared libraries.
> If I try now to compile a fortran program(e.g. Command: ifort -I
> */usr/local/include/* gdal_test.F90 /usr/local/lib/libfortranc.a
> /usr/local/lib/libshp.a /usr/local/lib/libfortrangis.a
> /usr/local/lib/libgdal.a) I get a lot of error messages stating undefined
> references:
>
> /usr/local/lib/libgdal.a(genbindataset.o): In function `_Alloc_hider':
> /usr/include/c++/4.7/bits/basic_string.h:272: undefined reference to
> `std::string::_Rep::_S_empty_rep_storage'
> /usr/local/lib/libgdal.a(genbindataset.o): In function
> `std::string::_Rep::_M_dispose(std::allocator<char> const&)':
> /usr/include/c++/4.7/bits/basic_string.h:237: undefined reference to
> `std::string::_Rep::_S_empty_rep_storage'
> /usr/include/c++/4.7/bits/basic_string.h:246: undefined reference to
> `std::string::_Rep::_M_destroy(std::allocator<char> const&)'
> /usr/local/lib/libgdal.a(genbindataset.o): In function
> `GDALRegister_GenBin':
> ...
>
>
> Any help would be appreciated.
>
> Regards,
> Fabian
>
> --
> VISTA Geowissenschaftliche Fernerkundung GmbH
> Administration: Anton-Ferstl-Str.11, D-82234 Wessling
> Office: Gabelsbergerstr.51, D-80333 M?nchen
> Tel. +49 89 287 794 59 Fax +49 89 523 89 804
> eMail: niggemann at vista-geo.de; web: www.vista-geo.de
>
> Amtsgericht M?nchen HRB 129776
> Sitz der Gesellschaft: Wessling
> Gesch?ftsf?hrung: Dr. Heike Bach
>
> Bankverbindung: Hypo Vereinsbank M?nchen
> BLZ 70020270 Konto 39042770
>
> USt-IDNr. DE812904252
> St.Nr. 11714150105
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140514/460b874b/attachment.html>

From jukka.rahkonen at mmmtike.fi  Wed May 14 07:41:02 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 14 May 2014 14:41:02 +0000 (UTC)
Subject: [gdal-dev] OSM driver to create separate tables for tags
Message-ID: <loom.20140514T161322-490@post.gmane.org>

Hi,

I wonder if it would make any sense in the GDAL context to have an option in
the OSM driver to separate geometries and tags and write them into their own
tables. The structure of the resulting tables (5 + 5 for points, lines,
multilines, multipolygons and relations) would be like:

Geometry table
==============
osm_id (long)integer or string (primary key)
geometry geometry

Tag table
=========
tag_id (long)integer or string (primary key)
osm_id (long)integer or string (foreign key)
tag string 255
value string 255

I am remembering that OSM has a 255 character limit for tags and values but
I am not sure.

This way all the data from OSM could be converted without any loss into any
database and into CSV and why not also into shapefile + additional dbf file
for tags. That would make much sense for those who are using and especially
analyzing OSM data because all the tags would be are reserved and they could
be queried simply with standard SQL. However, almost everything else in
GDAL/OGR is based on simple features and pushing OSM data into relational
model may not suit for the engine we have.

Utilization of these tables in GIS would not be too complicated at least for
read-only access. It would be best to create views or tables from the master
tables for creating fixed schemata for the work layers but that's all.

-Jukka Rahkonen-


From andre+joost at nurfuerspam.de  Wed May 14 09:33:29 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 14 May 2014 18:33:29 +0200
Subject: [gdal-dev] OSM driver to create separate tables for tags
In-Reply-To: <loom.20140514T161322-490@post.gmane.org>
References: <loom.20140514T161322-490@post.gmane.org>
Message-ID: <ll05u5$bqj$1@ger.gmane.org>

Am 14.05.2014 16:41, schrieb Jukka Rahkonen:

> I wonder if it would make any sense in the GDAL context to have an option in
> the OSM driver to separate geometries and tags and write them into their own
> tables. The structure of the resulting tables (5 + 5 for points, lines,
> multilines, multipolygons and relations) would be like:

Why would you distinguish between line and multiline? The database 
schema for rendering does not do it, and the OSM data model does it not too.

What is still missing is any kind of support for the 'role' field in 
relations. This is set for every member separately, not the whole 
relation as tags do.
For public transport relations, the role specifies if a way is part of 
the route, or a platform. Power relations work similar (line or 
substation), and turn restrictions as well as destination signs make no 
sense without them (from - via - to).

Apart from that, your scheme looks good. Not sure about performance 
issues, if you have huge datasets.

Greetings,
Andr? Joost


From even.rouault at mines-paris.org  Wed May 14 09:42:07 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 14 May 2014 18:42:07 +0200
Subject: [gdal-dev] OSM driver to create separate tables for tags
In-Reply-To: <loom.20140514T161322-490@post.gmane.org>
References: <loom.20140514T161322-490@post.gmane.org>
Message-ID: <201405141842.07477.even.rouault@mines-paris.org>

Le mercredi 14 mai 2014 16:41:02, Jukka Rahkonen a ?crit :
> Hi,
> 
> I wonder if it would make any sense in the GDAL context to have an option
> in the OSM driver to separate geometries and tags and write them into
> their own tables. The structure of the resulting tables (5 + 5 for points,
> lines, multilines, multipolygons and relations) would be like:
> 
> Geometry table
> ==============
> osm_id (long)integer or string (primary key)
> geometry geometry
> 
> Tag table
> =========
> tag_id (long)integer or string (primary key)
> osm_id (long)integer or string (foreign key)
> tag string 255
> value string 255
> 
> I am remembering that OSM has a 255 character limit for tags and values but
> I am not sure.
> 
> This way all the data from OSM could be converted without any loss into any
> database and into CSV and why not also into shapefile + additional dbf file
> for tags. That would make much sense for those who are using and especially
> analyzing OSM data because all the tags would be are reserved and they
> could be queried simply with standard SQL. However, almost everything else
> in GDAL/OGR is based on simple features and pushing OSM data into
> relational model may not suit for the engine we have.
> 
> Utilization of these tables in GIS would not be too complicated at least
> for read-only access. It would be best to create views or tables from the
> master tables for creating fixed schemata for the work layers but that's
> all.

This make some sense. I'm not sure what is the best place where to implement 
that if someone wants to tackle this.
This could be actually implement outside the OSM driver, in a rather generic 
way, by a Python script that would take any OGR datasource, the name of 
hstore-like fields and would split their content in separate tables like you 
describe.
Actually that could be a processing stage in a pipeline style workflow, but we 
don't have that mechanism in OGR.

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From matt.gregory at oregonstate.edu  Wed May 14 09:53:49 2014
From: matt.gregory at oregonstate.edu (Matt Gregory)
Date: Wed, 14 May 2014 09:53:49 -0700
Subject: [gdal-dev] VRT ComputeStatistics fails because of self-reference
In-Reply-To: <201405141122.57369.even.rouault@mines-paris.org>
References: <lku39h$l76$1@ger.gmane.org>
	<201405141122.57369.even.rouault@mines-paris.org>
Message-ID: <53739F9D.2020009@oregonstate.edu>

Hi Even,

On 5/14/2014 2:22 AM, Even Rouault wrote:
> Matt,
>
> thanks for the report. I'm a bit surprised this hasn't been reported before as
> it dates back to 1.10.0. Anyway, I've created a ticket
> http://trac.osgeo.org/gdal/ticket/5468 for that issue and pushed a fix for
> 1.10, 1.11 and trunk branches.
> I cannot think to a workaround, apart from upgrading from sources.

Thanks for the help.  I've confirmed the fix works for my 1.10 branch. 
I was surprised it hadn't been reported yet either.

matt



From jukka.rahkonen at mmmtike.fi  Wed May 14 14:56:53 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 14 May 2014 21:56:53 +0000 (UTC)
Subject: [gdal-dev] OSM driver to create separate tables for tags
References: <loom.20140514T161322-490@post.gmane.org>
	<ll05u5$bqj$1@ger.gmane.org>
Message-ID: <loom.20140514T234009-872@post.gmane.org>

Andre Joost <andre+joost <at> nurfuerspam.de> writes:

> 
> Am 14.05.2014 16:41, schrieb Jukka Rahkonen:
> 
> > I wonder if it would make any sense in the GDAL context to have an option in
> > the OSM driver to separate geometries and tags and write them into their own
> > tables. The structure of the resulting tables (5 + 5 for points, lines,
> > multilines, multipolygons and relations) would be like:
> 
> Why would you distinguish between line and multiline? The database 
> schema for rendering does not do it, and the OSM data model does it not too.

Read the driver manual http://www.gdal.org/ogr/drv_osm.html
Multilinestrings are mostly route relations. Line members of these relations
go also into line layer.

> What is still missing is any kind of support for the 'role' field in 
> relations. This is set for every member separately, not the whole 
> relation as tags do.
> For public transport relations, the role specifies if a way is part of 
> the route, or a platform. Power relations work similar (line or 
> substation), and turn restrictions as well as destination signs make no 
> sense without them (from - via - to).
> 
> Apart from that, your scheme looks good. Not sure about performance 
> issues, if you have huge datasets.

Complicated relations are very hard to turn into simple feature model. GDAL
is doing its best by saving them into GeometryCollections with the relation
tags but handling turn restrictions and so on must be done with special
programs. I consider that GDAL is doing mostly the same than osm2pgsql, but
it has more output formats and it is more flexible. Comprehensive SQL
support with SQLite dialect is wonderful.

I do not see any reason why it should be much if any slower with separated
tables than now when write tags are written into fixed schmema and to
additional all_tags column, which should stay as the default. And for
moderately sized datasets, like finland.osm.pbf or germany.osm.pbf GDAL is
faster than osm2pgsql, especially on weak computers.

-Jukka Rahkonen-





From ychemin at gmail.com  Wed May 14 19:55:26 2014
From: ychemin at gmail.com (Yann Chemin)
Date: Thu, 15 May 2014 08:25:26 +0530
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <201405141253.32397.even.rouault@mines-paris.org>
References: <201405141253.32397.even.rouault@mines-paris.org>
Message-ID: <CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>

Hi,

is there planetary datum support in this new version (i.e. Moon 2000, or etc.)?

Yann

On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> Hi,
>
> I've followed the update process of the EPSG SRS database to latest v8.4,
> and
> just committed the updated files into libgeotiff, GDAL and PROJ trunk. Also
>
> submitted to PostGIS.
>
> From what I can see, among many changes and additions, 2 new projection
> methods have been added:
> * 1051,Lambert Conic Conformal (2SP Michigan)
> --> looks very close to standard "Lambert Conic Conformal (2SP)", with the
> addition of a new parameter K, the ellipsoid scaling factor.
> * 1052,Colombia Urban
>
> I don't think any of those 2 new methods are currently handled by PROJ, so
> the
> new PCS based on those projection methods (3 Michigan SRS, and several
> dozains
> of Colombia PCS) will not be handled by GDAL nor PROJ.
>
> Regarding GDAL, I've improved the add_esri_column.py script (see
> http://trac.osgeo.org/geotiff/changeset/2446), so that we have more ESRI
> DATUM
> names. That should make morphing from/to ESRI .prj files a bit better.
>
> Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also
> added
> the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
> Horizontal
> + Vertical).
>
> Please let me know if you see issues.
>
> libgeotiff:
> http://trac.osgeo.org/geotiff/ticket/63
> http://trac.osgeo.org/geotiff/changeset/2447
>
> GDAL:
> http://trac.osgeo.org/gdal/ticket/5462
> http://trac.osgeo.org/gdal/changeset/27322
>
> PROJ:
> http://trac.osgeo.org/proj/ticket/236
> http://trac.osgeo.org/proj/changeset/2448
>
> Submitted for PostGIS :
> http://trac.osgeo.org/postgis/ticket/2737
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
----

From bishop.dev at gmail.com  Thu May 15 03:07:23 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Thu, 15 May 2014 14:07:23 +0400
Subject: [gdal-dev] GDAL_DRIVER_PATH dll hell
Message-ID: <537491DB.7070300@gmail.com>

Hi,

Yesterday I faced interesting problem on Win7 64 bit.
My program uses last gdal version 1.12. During start the error message 
popuped in dialog that gdal v. 1.8 was not find and application closed. 
I checked with dependency walker what were was no gdal 1.8 dependency in 
application and all it dll's.
I found out that another program used the gdal 1.8  was installed on 
that PC. And this program create env variable GDAL_DRIVER_PATH which 
pointed on some non standard driver linked with gdal 1.8
My gdal 1.12 try to load this driver as GDAL_DRIVER_PATH was present and 
crush as it was linked with gdal 1.8.
I solved it by setting CPLSetConfigOption("GDAL_DRIVER_PATH", 
"disabled"); in my application, but this is not a good solution.
I think some version checking needed or something else. Anyhow I think 
this is bug.
That do you think about this?
If this is a bug I'll create ticket.

-- 
Best regards,
     Dmitry


From niels.k.h at gmail.com  Thu May 15 03:45:53 2014
From: niels.k.h at gmail.com (=?ISO-8859-1?Q?Niels_Kj=F8ller_Hansen?=)
Date: Thu, 15 May 2014 12:45:53 +0200
Subject: [gdal-dev] OGR 1.11 upgrade -> Geometry gone after
	layer.SetFeature() (MSSQL)
Message-ID: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>

Hello all

I have been running a python script daily, which takes a table from a
MSSQL database, identifies which fields are strings, and does some
character set fixing (utf8 to latin1)

The trouble is, that after an upgrade to GDAL/OGR 1.11, the table ends
up with an empty geometry column. When I try to run through the script
in the python terminal, a call to 'feature.GetGeomFieldCount()'
returns 0

And this is before doing something to the feature. It is my guess that
the feature doesn't get the geometry, and when I write it (using
layer.SetFeature(feature)), It empties the column.

Am I doing something wrong? The entire script is here:
http://osgeo.codepad.org/Yn5xAdE6 (mostly, comments are in Danish,
sorry about that)

Other ways of succesfully importing utf8 sources (gml) in to a
MSSQL-database (latin1) is also greatly appreciated, although I would
still like to be able to do string manipulation in the database :)

Regards,
Niels

From even.rouault at mines-paris.org  Thu May 15 04:39:08 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 13:39:08 +0200
Subject: [gdal-dev] OGR 1.11 upgrade -> Geometry gone after
	layer.SetFeature() (MSSQL)
In-Reply-To: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
References: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
Message-ID: <1400153948.5374a75c46187@imp.free.fr>

Niels,

you could use ogr2ogr and ogrinfo to check where the issue appears in your
processing.

Even

> Hello all
>
> I have been running a python script daily, which takes a table from a
> MSSQL database, identifies which fields are strings, and does some
> character set fixing (utf8 to latin1)
>
> The trouble is, that after an upgrade to GDAL/OGR 1.11, the table ends
> up with an empty geometry column. When I try to run through the script
> in the python terminal, a call to 'feature.GetGeomFieldCount()'
> returns 0
>
> And this is before doing something to the feature. It is my guess that
> the feature doesn't get the geometry, and when I write it (using
> layer.SetFeature(feature)), It empties the column.
>
> Am I doing something wrong? The entire script is here:
> http://osgeo.codepad.org/Yn5xAdE6 (mostly, comments are in Danish,
> sorry about that)
>
> Other ways of succesfully importing utf8 sources (gml) in to a
> MSSQL-database (latin1) is also greatly appreciated, although I would
> still like to be able to do string manipulation in the database :)
>
> Regards,
> Niels
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From even.rouault at mines-paris.org  Thu May 15 04:43:06 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 13:43:06 +0200
Subject: [gdal-dev] GDAL_DRIVER_PATH dll hell
In-Reply-To: <537491DB.7070300@gmail.com>
References: <537491DB.7070300@gmail.com>
Message-ID: <1400154186.5374a84a84784@imp.free.fr>

Selon Dmitriy Baryshnikov <bishop.dev at gmail.com>:

> Hi,
>
> Yesterday I faced interesting problem on Win7 64 bit.
> My program uses last gdal version 1.12. During start the error message
> popuped in dialog that gdal v. 1.8 was not find and application closed.
> I checked with dependency walker what were was no gdal 1.8 dependency in
> application and all it dll's.
> I found out that another program used the gdal 1.8  was installed on
> that PC. And this program create env variable GDAL_DRIVER_PATH which
> pointed on some non standard driver linked with gdal 1.8
> My gdal 1.12 try to load this driver as GDAL_DRIVER_PATH was present and
> crush as it was linked with gdal 1.8.
> I solved it by setting CPLSetConfigOption("GDAL_DRIVER_PATH",
> "disabled"); in my application, but this is not a good solution.
> I think some version checking needed or something else. Anyhow I think
> this is bug.
> That do you think about this?
> If this is a bug I'll create ticket.

I don't think there's a way to prevent this. GDAL 1.12 will logically try to
load drivers that are in GDAL_DRIVER_PATH, and if the plugins in there link with
any DLL, the Windows mechanisms will try to load that DLL.
Well, perhaps there's a way of putting some "metadata" in the DLL that you could
inspect before loading it, but I don't know Windows well enough to tell.

>
> --
> Best regards,
>      Dmitry
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From even.rouault at mines-paris.org  Thu May 15 04:50:18 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 13:50:18 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>
Message-ID: <1400154618.5374a9fa66d70@imp.free.fr>

Selon Yann Chemin <ychemin at gmail.com>:

> Hi,
>
> is there planetary datum support in this new version (i.e. Moon 2000, or
> etc.)?

No, I don't think that the EPSG folks are interested in other planets yet ;-)
But Frank mentionned some time ago (
http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary-td3750798.html
) that he wanted to investigate how to deliver the IAU set of planetary
coordinate systems , but this hasn't been pursued further AFAIK.

I see there's a version of this file here :
http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt

Even

>
> Yann
>
> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> > Hi,
> >
> > I've followed the update process of the EPSG SRS database to latest v8.4,
> > and
> > just committed the updated files into libgeotiff, GDAL and PROJ trunk. Also
> >
> > submitted to PostGIS.
> >
> > From what I can see, among many changes and additions, 2 new projection
> > methods have been added:
> > * 1051,Lambert Conic Conformal (2SP Michigan)
> > --> looks very close to standard "Lambert Conic Conformal (2SP)", with the
> > addition of a new parameter K, the ellipsoid scaling factor.
> > * 1052,Colombia Urban
> >
> > I don't think any of those 2 new methods are currently handled by PROJ, so
> > the
> > new PCS based on those projection methods (3 Michigan SRS, and several
> > dozains
> > of Colombia PCS) will not be handled by GDAL nor PROJ.
> >
> > Regarding GDAL, I've improved the add_esri_column.py script (see
> > http://trac.osgeo.org/geotiff/changeset/2446), so that we have more ESRI
> > DATUM
> > names. That should make morphing from/to ESRI .prj files a bit better.
> >
> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also
> > added
> > the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
> > Horizontal
> > + Vertical).
> >
> > Please let me know if you see issues.
> >
> > libgeotiff:
> > http://trac.osgeo.org/geotiff/ticket/63
> > http://trac.osgeo.org/geotiff/changeset/2447
> >
> > GDAL:
> > http://trac.osgeo.org/gdal/ticket/5462
> > http://trac.osgeo.org/gdal/changeset/27322
> >
> > PROJ:
> > http://trac.osgeo.org/proj/ticket/236
> > http://trac.osgeo.org/proj/changeset/2448
> >
> > Submitted for PostGIS :
> > http://trac.osgeo.org/postgis/ticket/2737
> >
> > Best regards,
> >
> > Even
> >
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
>
> --
> ----
>



From ychemin at gmail.com  Thu May 15 05:00:33 2014
From: ychemin at gmail.com (Yann Chemin)
Date: Thu, 15 May 2014 17:30:33 +0530
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <1400154618.5374a9fa66d70@imp.free.fr>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>
	<1400154618.5374a9fa66d70@imp.free.fr>
Message-ID: <CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>

Hi Even,

I would be interested to include it. But I see that the 1Mb
uncompressed text is an issue.

If it was OK for the additional Mb in the source code,
what would be the place to look into gdal code to create the patch needed?

Thanks,
Yann

PS: did not copy other lists as I am not a member, registered to proj
ML today though.

On 15/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> Selon Yann Chemin <ychemin at gmail.com>:
>
>> Hi,
>>
>> is there planetary datum support in this new version (i.e. Moon 2000, or
>> etc.)?
>
> No, I don't think that the EPSG folks are interested in other planets yet
> ;-)
> But Frank mentionned some time ago (
> http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary-td3750798.html
> ) that he wanted to investigate how to deliver the IAU set of planetary
> coordinate systems , but this hasn't been pursued further AFAIK.
>
> I see there's a version of this file here :
> http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt
>
> Even
>
>>
>> Yann
>>
>> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
>> > Hi,
>> >
>> > I've followed the update process of the EPSG SRS database to latest
>> > v8.4,
>> > and
>> > just committed the updated files into libgeotiff, GDAL and PROJ trunk.
>> > Also
>> >
>> > submitted to PostGIS.
>> >
>> > From what I can see, among many changes and additions, 2 new projection
>> > methods have been added:
>> > * 1051,Lambert Conic Conformal (2SP Michigan)
>> > --> looks very close to standard "Lambert Conic Conformal (2SP)", with
>> > the
>> > addition of a new parameter K, the ellipsoid scaling factor.
>> > * 1052,Colombia Urban
>> >
>> > I don't think any of those 2 new methods are currently handled by PROJ,
>> > so
>> > the
>> > new PCS based on those projection methods (3 Michigan SRS, and several
>> > dozains
>> > of Colombia PCS) will not be handled by GDAL nor PROJ.
>> >
>> > Regarding GDAL, I've improved the add_esri_column.py script (see
>> > http://trac.osgeo.org/geotiff/changeset/2446), so that we have more
>> > ESRI
>> > DATUM
>> > names. That should make morphing from/to ESRI .prj files a bit better.
>> >
>> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've
>> > also
>> > added
>> > the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
>> > Horizontal
>> > + Vertical).
>> >
>> > Please let me know if you see issues.
>> >
>> > libgeotiff:
>> > http://trac.osgeo.org/geotiff/ticket/63
>> > http://trac.osgeo.org/geotiff/changeset/2447
>> >
>> > GDAL:
>> > http://trac.osgeo.org/gdal/ticket/5462
>> > http://trac.osgeo.org/gdal/changeset/27322
>> >
>> > PROJ:
>> > http://trac.osgeo.org/proj/ticket/236
>> > http://trac.osgeo.org/proj/changeset/2448
>> >
>> > Submitted for PostGIS :
>> > http://trac.osgeo.org/postgis/ticket/2737
>> >
>> > Best regards,
>> >
>> > Even
>> >
>> > --
>> > Geospatial professional services
>> > http://even.rouault.free.fr/services.html
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>>
>>
>> --
>> ----
>>
>
>
>


-- 
----

From niels.k.h at gmail.com  Thu May 15 05:01:58 2014
From: niels.k.h at gmail.com (=?ISO-8859-1?Q?Niels_Kj=F8ller_Hansen?=)
Date: Thu, 15 May 2014 14:01:58 +0200
Subject: [gdal-dev] OGR 1.11 upgrade -> Geometry gone after
 layer.SetFeature() (MSSQL)
In-Reply-To: <1400153948.5374a75c46187@imp.free.fr>
References: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
	<1400153948.5374a75c46187@imp.free.fr>
Message-ID: <CABjvV9GzZTpJ8XzMSXwJ1jEQuvjHtdfA48+1qnJTNroDqGEkdQ@mail.gmail.com>

Hi Even,

Thank you for responding so fast. I am not sure, however, how to use
ogr2ogr and ogrinfo to further diagnose my problem.

I have tried stepping through batch file, where the Python script is a part..

Ogr2ogr loads the file into dbo.table_name as it should (although with
wrong character set)
The I run the python script:

C:\> python fix_mssql_encoding.py --schema=dbo --table=table_name --quiet

Afterwards, the encoding is fixed, but the geometry is all
NULL-values. I use SQL Manager from Microsoft to monitor the table
while doing the read/write.

It took me a bit of time isolating the problem to my script.

It seems that handling the geometry changed from 1.10 to 1.11? Should
I do some 'transaction-stuff' instead of JUST doing the
layer.SetFeature(feature)?

- Niels


2014-05-15 13:39 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> Niels,
>
> you could use ogr2ogr and ogrinfo to check where the issue appears in your
> processing.
>
> Even
>
>> Hello all
>>
>> I have been running a python script daily, which takes a table from a
>> MSSQL database, identifies which fields are strings, and does some
>> character set fixing (utf8 to latin1)
>>
>> The trouble is, that after an upgrade to GDAL/OGR 1.11, the table ends
>> up with an empty geometry column. When I try to run through the script
>> in the python terminal, a call to 'feature.GetGeomFieldCount()'
>> returns 0
>>
>> And this is before doing something to the feature. It is my guess that
>> the feature doesn't get the geometry, and when I write it (using
>> layer.SetFeature(feature)), It empties the column.
>>
>> Am I doing something wrong? The entire script is here:
>> http://osgeo.codepad.org/Yn5xAdE6 (mostly, comments are in Danish,
>> sorry about that)
>>
>> Other ways of succesfully importing utf8 sources (gml) in to a
>> MSSQL-database (latin1) is also greatly appreciated, although I would
>> still like to be able to do string manipulation in the database :)
>>
>> Regards,
>> Niels
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>

From jukka.rahkonen at mmmtike.fi  Thu May 15 05:58:56 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 15 May 2014 12:58:56 +0000 (UTC)
Subject: [gdal-dev] Typo in geopackage driver page
Message-ID: <loom.20140515T145439-60@post.gmane.org>

Hi,

Nice to see the spatial index support in geopackages. BTW. there is a tiny
typo on the driver page http://www.gdal.org/ogr/drv_geopackage.html:

SPATIAL_INDEX: (GDAL <=2.0)

-Jukka Rahkonen-


From woodbri at swoodbridge.com  Thu May 15 07:25:12 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 15 May 2014 10:25:12 -0400
Subject: [gdal-dev] How to map Int32 or Float32 GTiff to color map?
Message-ID: <5374CE48.60305@swoodbridge.com>

Hi all,

I'm trying to create a VRT file for a GTiff that is Int32 or Float32 to 
add a ColorTable but I seem to be missing a key piece of information. 
How are the pixel values mapped to the color table entries? via the 
histogram?

My GTiff has noData=-32767 and good values the range from say -5 to 100. 
So do I create a color table that is based on the 256 buckets in the 
histogram?

So for example I get:

Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
   Min=-32767.000 Max=33.980   Computed Min/Max=-54.985,34.320
   Minimum=-32767.000, Maximum=33.980, Mean=-15887.345, StdDev=16386.592
   256 buckets from -32831.1 to 98.0444:
   1545169 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 27375 1924356
   NoData Value=-32767
   Metadata:
     STATISTICS_MAXIMUM=33.979999542236
     STATISTICS_MEAN=-15887.344614501
     STATISTICS_MINIMUM=-32767
     STATISTICS_STDDEV=16386.59208246


It seems that the NoData value is included in the stats which really 
skews the numbers compressing all my values into two buckets! How can I 
avoid that? I want to ignore the NoData values and spread my good values 
into the remaining buckets. How can I do this?

Thanks,
   -Steve


From giohappy at gmail.com  Thu May 15 07:29:52 2014
From: giohappy at gmail.com (G. Allegri)
Date: Thu, 15 May 2014 16:29:52 +0200
Subject: [gdal-dev] ogr2ogr with OSM data error Too many tags in relation
Message-ID: <CAB4g1=zXhhYAcxF92EM2YyYe1NBRai1pmpoY=hEdhG8t83AOqg@mail.gmail.com>

I'm trying to use the OGR OSM driver to convert an .osm file to sqlite
(spatialite)
Running:

ogr2ogr -f SQlite myosm.sqlite myosm.osm -dsco SPATIALITE=YES

I obtain:

ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331
ERROR 1: Too many tags in relation 365331

(yes, it's repeated)
Relation 365331 is the italian administrative boundary (
http://www.openstreetmap.org/relation/365331). It contains a lot of tags
(mainly translations).

Is there a limit to the number of relations OSM's driver can manage? How to
avoid loading all those name "subtags"?

giovanni

-- 
Giovanni Allegri
http://about.me/giovanniallegri
Twitter: https://twitter.com/_giohappy_
blog: http://blog.spaziogis.it
GEO+ geomatica in Italia http://bit.ly/GEOplus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/5423d9a6/attachment.html>

From andre+joost at nurfuerspam.de  Thu May 15 08:03:52 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 15 May 2014 17:03:52 +0200
Subject: [gdal-dev] OSM driver to create separate tables for tags
In-Reply-To: <loom.20140514T234009-872@post.gmane.org>
References: <loom.20140514T161322-490@post.gmane.org>
	<ll05u5$bqj$1@ger.gmane.org>
	<loom.20140514T234009-872@post.gmane.org>
Message-ID: <ll2la6$8ng$1@ger.gmane.org>

Am 14.05.2014 23:56, schrieb Jukka Rahkonen:

>
> Read the driver manual http://www.gdal.org/ogr/drv_osm.html
> Multilinestrings are mostly route relations. Line members of these relations
> go also into line layer.

Ok, I missed that one.


>
> I do not see any reason why it should be much if any slower with separated
> tables than now when write tags are written into fixed schmema and to
> additional all_tags column, which should stay as the default.

> And for
> moderately sized datasets, like finland.osm.pbf or germany.osm.pbf GDAL is
> faster than osm2pgsql, especially on weak computers.
>

Osm2pgsql might take longer because it puts a lot emphasis on 
multipolygon retrieval. I still have polygons missing with the gdal 
driver (although this is better than the OSM import in QGIS).

But import time does not matter for me , as it is done only once. I was 
rather thinking about rendering time. From the postgis database, I can 
select a column "network" and style my cycle paths according to the 
values "icn","ncn","rcn","lcn". Pretty much the same as I would do it 
with a shapefile.

I guess this needs different handling with your tag table approach.


Greetings,
Andr? Joost


From andre+joost at nurfuerspam.de  Thu May 15 07:56:26 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 15 May 2014 16:56:26 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <201405141253.32397.even.rouault@mines-paris.org>
References: <201405141253.32397.even.rouault@mines-paris.org>
Message-ID: <ll2la7$8ng$2@ger.gmane.org>

Am 14.05.2014 12:53, schrieb Even Rouault:

>
> Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also added
> the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound Horizontal
> + Vertical).
>
> Please let me know if you see issues.
>

The GEOCGS will likely cause a lot of confusion. They need three 
coordinates (X/Y/Z), while most GIS software is still in 2D-mode 
(lat/lon or X/Y). As a consequence, inverse projection (or 
on-the-fly-reprojection) is not possible if the third coordinate is 
lost. See 
http://gis.stackexchange.com/questions/95729/help-defining-custom-crs-in-qgis-2-2 
for an example.

BTW, any chance to get my http://trac.osgeo.org/proj/ticket/235 included?
It is just about datum shift of the Czech Republic bound to East German 
Pulkovo projections, which leads to unwanted datum shifts.

Greetings,
Andr? Joost



From andre+joost at nurfuerspam.de  Thu May 15 07:47:47 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 15 May 2014 16:47:47 +0200
Subject: [gdal-dev] GDAL_DRIVER_PATH dll hell
In-Reply-To: <537491DB.7070300@gmail.com>
References: <537491DB.7070300@gmail.com>
Message-ID: <ll2la7$8ng$3@ger.gmane.org>

Am 15.05.2014 12:07, schrieb Dmitriy Baryshnikov:

> I found out that another program used the gdal 1.8 was installed on that
> PC. And this program create env variable GDAL_DRIVER_PATH which pointed
> on some non standard driver linked with gdal 1.8

> I think some version checking needed or something else. Anyhow I think
> this is bug.
> That do you think about this?
> If this is a bug I'll create ticket.
>

The gdal packages from gisinternals.com sets this variable when you 
start the SDKShell.bat to open a command window. The variable gets 
destroyed when the cmd window is closed.
OSGEO4W does the same, setting the path to its own location.

You could do the same, either in your application or in a bat arround 
it. For the first choice, you could restore the path variable when you 
exit your application.

HTH,
Andr? Joost


From eddie.stathopoulos at worldviewsolutions.com  Thu May 15 08:27:50 2014
From: eddie.stathopoulos at worldviewsolutions.com (Eddie Stathopoulos)
Date: Thu, 15 May 2014 15:27:50 +0000
Subject: [gdal-dev] File geodatabase write lock using C# bindings
Message-ID: <0b86d3a964674876b9e1e0c2491ea7b4@CO1PR04MB444.namprd04.prod.outlook.com>

Hello all, I am attempting to create a C# WCF service to convert GeoJSON -> other formats. File Geodatabase is desired. I am using the latest C# GDAL bindings and the driver is being recognized and loaded, but it seems I'm bumping into a write lock?

I receive an AccessViolationException (Attempted to read or write protected memory. This is often an indication that other memory is corrupt) using the following code. The files in the FGDB directory are created.

outputDriver = Ogr.GetDriverByName("FileGDB");
outputDataSource = outputDriver.CopyDataSource(dataSource, outputFilePath, null);

Any clue what is causing this lock or how I could get around this?

Thanks!?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/e33086b1/attachment-0001.html>

From bruceraup at gmail.com  Thu May 15 09:13:14 2014
From: bruceraup at gmail.com (Bruce Raup)
Date: Thu, 15 May 2014 10:13:14 -0600
Subject: [gdal-dev] Difficulty finding all parts of shapefile polygon using
	Python and osgeo/ogr
Message-ID: <CAOggSvaWP8KK5QYBSTYm2u57f4neNPRN67HQvWUiJfRMR6c3KA@mail.gmail.com>

Hello,

I have a Python script that reads a shapefile, converts holes in polygons
to top-level polygons, and writes a new polygon.  The new top-level
polygons inherit attributes from their parents, with optional modifications
of specific attributes.  For a simple test shapefile, the output of shpdump
shows what I mean:

$ shpdump simple_shapes_with_holes.shp
Shapefile Type: Polygon   # of Shapes: 3

File Bounds: (      -1.113,       0.146,0,0)
         to  (       0.751,       1.101,0,0)

Shape:0 (Polygon)  nVertices=11, nParts=2
  Bounds:(      -1.113,       0.146, 0, 0)
      to (      -0.493,       0.723, 0, 0)
     (      -1.087,       0.151, 0, 0) Ring
     (      -1.113,       0.686, 0, 0)
     (      -1.109,       0.712, 0, 0)
     (      -0.506,       0.723, 0, 0)
     (      -0.493,       0.146, 0, 0)
     (      -1.087,       0.151, 0, 0)
   + (      -0.896,       0.346, 0, 0) Ring
     (      -0.682,       0.339, 0, 0)
     (      -0.684,       0.556, 0, 0)
     (      -0.909,       0.558, 0, 0)
     (      -0.896,       0.346, 0, 0)

Shape:1 (Polygon)  nVertices=19, nParts=4
  Bounds:(      -0.127,       0.159, 0, 0)
      to (       0.751,       0.783, 0, 0)
     (       0.402,       0.783, 0, 0) Ring
     (       0.751,       0.159, 0, 0)
     (      -0.127,       0.198, 0, 0)
     (       0.402,       0.783, 0, 0)
   + (       0.298,       0.539, 0, 0) Ring
     (       0.417,       0.523, 0, 0)
     (       0.426,       0.612, 0, 0)
     (       0.339,       0.625, 0, 0)
     (       0.298,       0.539, 0, 0)
   + (       0.083,       0.263, 0, 0) Ring
     (       0.248,       0.252, 0, 0)
     (       0.213,       0.396, 0, 0)
     (       0.107,       0.367, 0, 0)
     (       0.083,       0.263, 0, 0)
   + (       0.361,       0.281, 0, 0) Ring
     (       0.530,       0.265, 0, 0)
     (       0.435,       0.413, 0, 0)
     (       0.330,       0.435, 0, 0)
     (       0.361,       0.281, 0, 0)

Shape:2 (Polygon)  nVertices=6, nParts=1
  Bounds:(      -0.389,       0.681, 0, 0)
      to (       0.141,       1.101, 0, 0)
     (      -0.383,       1.005, 0, 0) Ring
     (      -0.136,       1.101, 0, 0)
     (       0.141,       0.964, 0, 0)
     (      -0.154,       0.681, 0, 0)
     (      -0.389,       0.809, 0, 0)
     (      -0.383,       1.005, 0, 0)




$ shpdump simple_shapes_with_holes_flattened.shp
Shapefile Type: Polygon   # of Shapes: 7

File Bounds: (      -1.113,       0.146,0,0)
         to  (       0.751,       1.101,0,0)

Shape:0 (Polygon)  nVertices=6, nParts=1
  Bounds:(      -1.113,       0.146, 0, 0)
      to (      -0.493,       0.723, 0, 0)
     (      -1.087,       0.151, 0, 0) Ring
     (      -1.113,       0.686, 0, 0)
     (      -1.109,       0.712, 0, 0)
     (      -0.506,       0.723, 0, 0)
     (      -0.493,       0.146, 0, 0)
     (      -1.087,       0.151, 0, 0)

Shape:1 (Polygon)  nVertices=5, nParts=1
  Bounds:(      -0.909,       0.339, 0, 0)
      to (      -0.682,       0.558, 0, 0)
     (      -0.896,       0.346, 0, 0) Ring
     (      -0.909,       0.558, 0, 0)
     (      -0.684,       0.556, 0, 0)
     (      -0.682,       0.339, 0, 0)
     (      -0.896,       0.346, 0, 0)

Shape:2 (Polygon)  nVertices=4, nParts=1
  Bounds:(      -0.127,       0.159, 0, 0)
      to (       0.751,       0.783, 0, 0)
     (       0.402,       0.783, 0, 0) Ring
     (       0.751,       0.159, 0, 0)
     (      -0.127,       0.198, 0, 0)
     (       0.402,       0.783, 0, 0)

Shape:3 (Polygon)  nVertices=5, nParts=1
  Bounds:(       0.298,       0.523, 0, 0)
      to (       0.426,       0.625, 0, 0)
     (       0.298,       0.539, 0, 0) Ring
     (       0.339,       0.625, 0, 0)
     (       0.426,       0.612, 0, 0)
     (       0.417,       0.523, 0, 0)
     (       0.298,       0.539, 0, 0)

Shape:4 (Polygon)  nVertices=5, nParts=1
  Bounds:(       0.083,       0.252, 0, 0)
      to (       0.248,       0.396, 0, 0)
     (       0.083,       0.263, 0, 0) Ring
     (       0.107,       0.367, 0, 0)
     (       0.213,       0.396, 0, 0)
     (       0.248,       0.252, 0, 0)
     (       0.083,       0.263, 0, 0)

Shape:5 (Polygon)  nVertices=5, nParts=1
  Bounds:(       0.330,       0.265, 0, 0)
      to (       0.530,       0.435, 0, 0)
     (       0.361,       0.281, 0, 0) Ring
     (       0.330,       0.435, 0, 0)
     (       0.435,       0.413, 0, 0)
     (       0.530,       0.265, 0, 0)
     (       0.361,       0.281, 0, 0)

Shape:6 (Polygon)  nVertices=6, nParts=1
  Bounds:(      -0.389,       0.681, 0, 0)
      to (       0.141,       1.101, 0, 0)
     (      -0.383,       1.005, 0, 0) Ring
     (      -0.136,       1.101, 0, 0)
     (       0.141,       0.964, 0, 0)
     (      -0.154,       0.681, 0, 0)
     (      -0.389,       0.809, 0, 0)
     (      -0.383,       1.005, 0, 0)


I have a shapefile for which this doesn't work, however, and I suspect it's
perhaps a difference in the way the inner rings are represented.  In this
real shapefile, the top part of the output from shpdump looks like


Shapefile Type: Polygon   # of Shapes: 1

File Bounds: (  462611.523, 3894164.223,0,0)
         to  (  470338.347, 3901974.217,0,0)

Shape:0 (Polygon)  nVertices=1575, nParts=14
  Bounds:(  462611.523, 3894164.223, 0, 0)
      to (  470338.347, 3901974.217, 0, 0)
     (  467768.987, 3900844.546, 0, 0) Ring
     (  467744.058, 3900868.748, 0, 0)
     (  467702.110, 3900879.841, 0, 0)
     (  467670.108, 3900921.799, 0, 0)
     (  467632.530, 3900960.784, 0, 0)
     (  467689.198, 3900957.167, 0, 0)
     (  467751.895, 3900922.201, 0, 0)
     (  467785.655, 3900861.426, 0, 0)
     (  467768.987, 3900844.546, 0, 0)
   + (  467774.970, 3900834.757, 0, 0) Ring
     (  467796.445, 3900858.379, 0, 0)
     (  467850.763, 3900846.242, 0, 0)
     (  467900.197, 3900841.419, 0, 0)
     (  467927.928, 3900814.893, 0, 0)
     (  467936.368, 3900767.871, 0, 0)
.
.
.

But my python code doesn't see all the parts.


$ python
Python 2.7 (r27:82500, Aug 07 2010, 16:54:59) [GCC] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import ogr
>>> sf = ogr.Open('segments.shp')
>>> sl = sf.GetLayer(0)
>>> sl
<osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
0xb7472980> >
>>> feat = sl[0]
>>> feat
<osgeo.ogr.Feature; proxy of <Swig Object of type 'OGRFeatureShadow *' at
0xb7472620> >
>>> sg = feat.GetGeometryRef()
>>> sg
<osgeo.ogr.Geometry; proxy of <Swig Object of type 'OGRGeometryShadow *' at
0xb749e770> >
>>> sg.GetGeometryCount()
2
>>>


I would expect the output of sg.GetGeometryCount() to be 15.  Am I doing
something wrong?

The complete script is at

http://cires.colorado.edu/~braup/OGR/flatten_shapefile.py

The testfile is at

http://cires.colorado.edu/~braup/OGR/simple_shapes_with_holes.zip

The "real" testfile on which the script fails is at:

http://cires.colorado.edu/~braup/OGR/nanga_segments.zip

Any pointers would be greatly appreciated.

Cheers,
Bruce Raup

-- 
Bruce Raup
http://cires.colorado.edu/~braup/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/43a657cc/attachment.html>

From even.rouault at mines-paris.org  Thu May 15 10:54:29 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 19:54:29 +0200
Subject: [gdal-dev] OGR 1.11 upgrade -> Geometry gone after
	layer.SetFeature() (MSSQL)
In-Reply-To: <CABjvV9GzZTpJ8XzMSXwJ1jEQuvjHtdfA48+1qnJTNroDqGEkdQ@mail.gmail.com>
References: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
	<1400153948.5374a75c46187@imp.free.fr>
	<CABjvV9GzZTpJ8XzMSXwJ1jEQuvjHtdfA48+1qnJTNroDqGEkdQ@mail.gmail.com>
Message-ID: <201405151954.29742.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 14:01:58, Niels Kj?ller Hansen a ?crit :
> Hi Even,
> 
> Thank you for responding so fast. I am not sure, however, how to use
> ogr2ogr and ogrinfo to further diagnose my problem.

Well,  "ogrinfo the_syntax_to_open_a_mssql_db -al" and you'll see if there are 
geometries in it, before and after running your script.

> 
> I have tried stepping through batch file, where the Python script is a
> part..
> 
> Ogr2ogr loads the file into dbo.table_name as it should (although with
> wrong character set)
> The I run the python script:
> 
> C:\> python fix_mssql_encoding.py --schema=dbo --table=table_name --quiet
> 
> Afterwards, the encoding is fixed, but the geometry is all
> NULL-values. I use SQL Manager from Microsoft to monitor the table
> while doing the read/write.
> 
> It took me a bit of time isolating the problem to my script.
> 
> It seems that handling the geometry changed from 1.10 to 1.11? Should
> I do some 'transaction-stuff' instead of JUST doing the
> layer.SetFeature(feature)?

The notion of geometry field is new to 1.11 but has been added in a backward 
compatible way, so the MSSQL driver should not (in theory) be impacted by it.
So I would rather suspect a change in the driver itself, but it is hard to 
tell.
I've no way of testing MSSQL myself to help.

If you can find a simple way of reproducing the bug, it might be worth opening 
a ticket for that.

> 
> - Niels
> 
> 2014-05-15 13:39 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> > Niels,
> > 
> > you could use ogr2ogr and ogrinfo to check where the issue appears in
> > your processing.
> > 
> > Even
> > 
> >> Hello all
> >> 
> >> I have been running a python script daily, which takes a table from a
> >> MSSQL database, identifies which fields are strings, and does some
> >> character set fixing (utf8 to latin1)
> >> 
> >> The trouble is, that after an upgrade to GDAL/OGR 1.11, the table ends
> >> up with an empty geometry column. When I try to run through the script
> >> in the python terminal, a call to 'feature.GetGeomFieldCount()'
> >> returns 0
> >> 
> >> And this is before doing something to the feature. It is my guess that
> >> the feature doesn't get the geometry, and when I write it (using
> >> layer.SetFeature(feature)), It empties the column.
> >> 
> >> Am I doing something wrong? The entire script is here:
> >> http://osgeo.codepad.org/Yn5xAdE6 (mostly, comments are in Danish,
> >> sorry about that)
> >> 
> >> Other ways of succesfully importing utf8 sources (gml) in to a
> >> MSSQL-database (latin1) is also greatly appreciated, although I would
> >> still like to be able to do string manipulation in the database :)
> >> 
> >> Regards,
> >> Niels
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 10:55:11 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 19:55:11 +0200
Subject: [gdal-dev] Typo in geopackage driver page
In-Reply-To: <loom.20140515T145439-60@post.gmane.org>
References: <loom.20140515T145439-60@post.gmane.org>
Message-ID: <201405151955.12274.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 14:58:56, Jukka Rahkonen a ?crit :
> Hi,
> 
> Nice to see the spatial index support in geopackages. BTW. there is a tiny
> typo on the driver page http://www.gdal.org/ogr/drv_geopackage.html:
> 
> SPATIAL_INDEX: (GDAL <=2.0)

Fixed thanks

> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 10:56:53 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 19:56:53 +0200
Subject: [gdal-dev] How to map Int32 or Float32 GTiff to color map?
In-Reply-To: <5374CE48.60305@swoodbridge.com>
References: <5374CE48.60305@swoodbridge.com>
Message-ID: <201405151956.53534.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 16:25:12, Stephen Woodbridge a ?crit :
> Hi all,
> 
> I'm trying to create a VRT file for a GTiff that is Int32 or Float32 to
> add a ColorTable but I seem to be missing a key piece of information.
> How are the pixel values mapped to the color table entries? via the
> histogram?
> 
> My GTiff has noData=-32767 and good values the range from say -5 to 100.
> So do I create a color table that is based on the 256 buckets in the
> histogram?

No way you can use a GDAL color table to map negative values...
Perhaps you should use gdaldem color-relief to generate a RGB output. Note 
that gdaldem color-relief is compatible with VRT output : it uses the LUT 
mechanism to do so.

> 
> So for example I get:
> 
> Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>    Min=-32767.000 Max=33.980   Computed Min/Max=-54.985,34.320
>    Minimum=-32767.000, Maximum=33.980, Mean=-15887.345, StdDev=16386.592
>    256 buckets from -32831.1 to 98.0444:
>    1545169 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
> 0 0 0 0 0 0 27375 1924356
>    NoData Value=-32767
>    Metadata:
>      STATISTICS_MAXIMUM=33.979999542236
>      STATISTICS_MEAN=-15887.344614501
>      STATISTICS_MINIMUM=-32767
>      STATISTICS_STDDEV=16386.59208246
> 
> 
> It seems that the NoData value is included in the stats which really
> skews the numbers compressing all my values into two buckets! How can I
> avoid that? I want to ignore the NoData values and spread my good values
> into the remaining buckets. How can I do this?

You can't. There's a ticket I think about the fact we should ignore nodata 
value in stats.

> 
> Thanks,
>    -Steve
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 11:06:59 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 20:06:59 +0200
Subject: [gdal-dev] ogr2ogr with OSM data error Too many tags in relation
In-Reply-To: <CAB4g1=zXhhYAcxF92EM2YyYe1NBRai1pmpoY=hEdhG8t83AOqg@mail.gmail.com>
References: <CAB4g1=zXhhYAcxF92EM2YyYe1NBRai1pmpoY=hEdhG8t83AOqg@mail.gmail.com>
Message-ID: <201405152006.59275.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 16:29:52, G. Allegri a ?crit :
> I'm trying to use the OGR OSM driver to convert an .osm file to sqlite
> (spatialite)
> Running:
> 
> ogr2ogr -f SQlite myosm.sqlite myosm.osm -dsco SPATIALITE=YES
> 
> I obtain:
> 
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> ERROR 1: Too many tags in relation 365331
> 
> (yes, it's repeated)
> Relation 365331 is the italian administrative boundary (
> http://www.openstreetmap.org/relation/365331). It contains a lot of tags
> (mainly translations).
> 
> Is there a limit to the number of relations OSM's driver can manage? 

The error comes from the XML .osm parser in fact. I see it has not the logic 
of the PBF parser to increase the hard-coded initial values. So the max is 
256.
If you convert your .osm into a .pbf, I suspect you wouldn't have this error.
Otherwise if you compile from source you can increase the value at line 2246 
of ogr/ogrsf_frmts/osm/osm_parser.cpp ( psCtxt->nTagsAllocated = 256; ).
But that error is not critical. The extra tags after the 256 first ones will 
just be ignored.
Anyway it might be good if you can open a ticket about that issue.

> How to
> avoid loading all those name "subtags"?
> 
> giovanni

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 11:12:23 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 20:12:23 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<1400154618.5374a9fa66d70@imp.free.fr>
	<CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>
Message-ID: <201405152012.23585.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 14:00:33, Yann Chemin a ?crit :
> Hi Even,
> 
> I would be interested to include it. But I see that the 1Mb
> uncompressed text is an issue.
> 
> If it was OK for the additional Mb in the source code,
> what would be the place to look into gdal code to create the patch needed?

Basically I believe it would be just a matter of dropping the file in the data 
subdirectory. I can see some logic in ogr/ogrspatialreference.cpp to deal with 
IAU: prefixes, but you would have to test.

Something that should be checked is whether we have the rights to distribute 
that file along with GDAL.

> 
> Thanks,
> Yann
> 
> PS: did not copy other lists as I am not a member, registered to proj
> ML today though.
> 
> On 15/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> > Selon Yann Chemin <ychemin at gmail.com>:
> >> Hi,
> >> 
> >> is there planetary datum support in this new version (i.e. Moon 2000, or
> >> etc.)?
> > 
> > No, I don't think that the EPSG folks are interested in other planets yet
> > ;-)
> > But Frank mentionned some time ago (
> > http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary
> > -td3750798.html ) that he wanted to investigate how to deliver the IAU
> > set of planetary coordinate systems , but this hasn't been pursued
> > further AFAIK.
> > 
> > I see there's a version of this file here :
> > http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt
> > 
> > Even
> > 
> >> Yann
> >> 
> >> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> >> > Hi,
> >> > 
> >> > I've followed the update process of the EPSG SRS database to latest
> >> > v8.4,
> >> > and
> >> > just committed the updated files into libgeotiff, GDAL and PROJ trunk.
> >> > Also
> >> > 
> >> > submitted to PostGIS.
> >> > 
> >> > From what I can see, among many changes and additions, 2 new
> >> > projection methods have been added:
> >> > * 1051,Lambert Conic Conformal (2SP Michigan)
> >> > --> looks very close to standard "Lambert Conic Conformal (2SP)", with
> >> > the
> >> > addition of a new parameter K, the ellipsoid scaling factor.
> >> > * 1052,Colombia Urban
> >> > 
> >> > I don't think any of those 2 new methods are currently handled by
> >> > PROJ, so
> >> > the
> >> > new PCS based on those projection methods (3 Michigan SRS, and several
> >> > dozains
> >> > of Colombia PCS) will not be handled by GDAL nor PROJ.
> >> > 
> >> > Regarding GDAL, I've improved the add_esri_column.py script (see
> >> > http://trac.osgeo.org/geotiff/changeset/2446), so that we have more
> >> > ESRI
> >> > DATUM
> >> > names. That should make morphing from/to ESRI .prj files a bit better.
> >> > 
> >> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've
> >> > also
> >> > added
> >> > the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
> >> > Horizontal
> >> > + Vertical).
> >> > 
> >> > Please let me know if you see issues.
> >> > 
> >> > libgeotiff:
> >> > http://trac.osgeo.org/geotiff/ticket/63
> >> > http://trac.osgeo.org/geotiff/changeset/2447
> >> > 
> >> > GDAL:
> >> > http://trac.osgeo.org/gdal/ticket/5462
> >> > http://trac.osgeo.org/gdal/changeset/27322
> >> > 
> >> > PROJ:
> >> > http://trac.osgeo.org/proj/ticket/236
> >> > http://trac.osgeo.org/proj/changeset/2448
> >> > 
> >> > Submitted for PostGIS :
> >> > http://trac.osgeo.org/postgis/ticket/2737
> >> > 
> >> > Best regards,
> >> > 
> >> > Even
> >> > 
> >> > --
> >> > Geospatial professional services
> >> > http://even.rouault.free.fr/services.html
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev at lists.osgeo.org
> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> 
> >> --
> >> ----

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 11:28:25 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 20:28:25 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <ll2la7$8ng$2@ger.gmane.org>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<ll2la7$8ng$2@ger.gmane.org>
Message-ID: <201405152028.25973.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 16:56:26, Andre Joost a ?crit :
> Am 14.05.2014 12:53, schrieb Even Rouault:
> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also
> > added the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS
> > (Compound Horizontal + Vertical).
> > 
> > Please let me know if you see issues.
> 
> The GEOCGS will likely cause a lot of confusion. They need three
> coordinates (X/Y/Z), while most GIS software is still in 2D-mode
> (lat/lon or X/Y). As a consequence, inverse projection (or
> on-the-fly-reprojection) is not possible if the third coordinate is
> lost. See
> http://gis.stackexchange.com/questions/95729/help-defining-custom-crs-in-qg
> is-2-2 for an example.

It is the responsibility of people using those codes to use them correctly... 

> 
> BTW, any chance to get my http://trac.osgeo.org/proj/ticket/235 included?
> It is just about datum shift of the Czech Republic bound to East German
> Pulkovo projections, which leads to unwanted datum shifts.

Not saying I would take charge of that myself, but I don't see a patch. The 
patch would need to be done in the datum_shift_pref.csv file of libgeotiff.

More points if you can modify the logic of build_pcs.py to select the right 
datum shift !

> 
> Greetings,
> Andr? Joost
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From thare at usgs.gov  Thu May 15 11:26:58 2014
From: thare at usgs.gov (Hare, Trent)
Date: Thu, 15 May 2014 11:26:58 -0700
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <201405152012.23585.even.rouault@mines-paris.org>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<1400154618.5374a9fa66d70@imp.free.fr>
	<CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>
	<201405152012.23585.even.rouault@mines-paris.org>
Message-ID: <CAB6t5t-qhZd43RhDqQczFVqMAQhHbx+YdQy7QaDTDbKZmX8sQQ@mail.gmail.com>

No issues with distribution of IAU codes. Anything we or I release (code or
otherwise) will have a "public domain" license as in normal as per US
government policy. Thus it is free for use by anyone for any purpose
without restriction under copyright law. If "GDAL" requires a more normal
license it can be taken over by anyone for that purpose.

-Trent

-Trent




On Thu, May 15, 2014 at 11:12 AM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Le jeudi 15 mai 2014 14:00:33, Yann Chemin a ?crit :
> > Hi Even,
> >
> > I would be interested to include it. But I see that the 1Mb
> > uncompressed text is an issue.
> >
> > If it was OK for the additional Mb in the source code,
> > what would be the place to look into gdal code to create the patch
> needed?
>
> Basically I believe it would be just a matter of dropping the file in the
> data
> subdirectory. I can see some logic in ogr/ogrspatialreference.cpp to deal
> with
> IAU: prefixes, but you would have to test.
>
> Something that should be checked is whether we have the rights to
> distribute
> that file along with GDAL.
>
> >
> > Thanks,
> > Yann
> >
> > PS: did not copy other lists as I am not a member, registered to proj
> > ML today though.
> >
> > On 15/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> > > Selon Yann Chemin <ychemin at gmail.com>:
> > >> Hi,
> > >>
> > >> is there planetary datum support in this new version (i.e. Moon 2000,
> or
> > >> etc.)?
> > >
> > > No, I don't think that the EPSG folks are interested in other planets
> yet
> > > ;-)
> > > But Frank mentionned some time ago (
> > >
> http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary
> > > -td3750798.html ) that he wanted to investigate how to deliver the IAU
> > > set of planetary coordinate systems , but this hasn't been pursued
> > > further AFAIK.
> > >
> > > I see there's a version of this file here :
> > > http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt
> > >
> > > Even
> > >
> > >> Yann
> > >>
> > >> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> > >> > Hi,
> > >> >
> > >> > I've followed the update process of the EPSG SRS database to latest
> > >> > v8.4,
> > >> > and
> > >> > just committed the updated files into libgeotiff, GDAL and PROJ
> trunk.
> > >> > Also
> > >> >
> > >> > submitted to PostGIS.
> > >> >
> > >> > From what I can see, among many changes and additions, 2 new
> > >> > projection methods have been added:
> > >> > * 1051,Lambert Conic Conformal (2SP Michigan)
> > >> > --> looks very close to standard "Lambert Conic Conformal (2SP)",
> with
> > >> > the
> > >> > addition of a new parameter K, the ellipsoid scaling factor.
> > >> > * 1052,Colombia Urban
> > >> >
> > >> > I don't think any of those 2 new methods are currently handled by
> > >> > PROJ, so
> > >> > the
> > >> > new PCS based on those projection methods (3 Michigan SRS, and
> several
> > >> > dozains
> > >> > of Colombia PCS) will not be handled by GDAL nor PROJ.
> > >> >
> > >> > Regarding GDAL, I've improved the add_esri_column.py script (see
> > >> > http://trac.osgeo.org/geotiff/changeset/2446), so that we have more
> > >> > ESRI
> > >> > DATUM
> > >> > names. That should make morphing from/to ESRI .prj files a bit
> better.
> > >> >
> > >> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've
> > >> > also
> > >> > added
> > >> > the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
> > >> > Horizontal
> > >> > + Vertical).
> > >> >
> > >> > Please let me know if you see issues.
> > >> >
> > >> > libgeotiff:
> > >> > http://trac.osgeo.org/geotiff/ticket/63
> > >> > http://trac.osgeo.org/geotiff/changeset/2447
> > >> >
> > >> > GDAL:
> > >> > http://trac.osgeo.org/gdal/ticket/5462
> > >> > http://trac.osgeo.org/gdal/changeset/27322
> > >> >
> > >> > PROJ:
> > >> > http://trac.osgeo.org/proj/ticket/236
> > >> > http://trac.osgeo.org/proj/changeset/2448
> > >> >
> > >> > Submitted for PostGIS :
> > >> > http://trac.osgeo.org/postgis/ticket/2737
> > >> >
> > >> > Best regards,
> > >> >
> > >> > Even
> > >> >
> > >> > --
> > >> > Geospatial professional services
> > >> > http://even.rouault.free.fr/services.html
> > >> > _______________________________________________
> > >> > gdal-dev mailing list
> > >> > gdal-dev at lists.osgeo.org
> > >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >>
> > >> --
> > >> ----
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/69ae146b/attachment-0001.html>

From even.rouault at mines-paris.org  Thu May 15 11:47:32 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 20:47:32 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405080013.23209.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
Message-ID: <201405152047.32942.even.rouault@mines-paris.org>

Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> Hi,
> 
> This is a call for discussion on "RFC 46: GDAL/OGR unification"
> 
>   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> 

No reaction : no interest or no time to review yet ?
Or should I move that forward ?
But I'd prefer if such architectural changes could be a bit reviewed...

> Best regards,
> 
> Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 15 11:48:57 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 15 May 2014 20:48:57 +0200
Subject: [gdal-dev] File geodatabase write lock using C# bindings
In-Reply-To: <0b86d3a964674876b9e1e0c2491ea7b4@CO1PR04MB444.namprd04.prod.outlook.com>
References: <0b86d3a964674876b9e1e0c2491ea7b4@CO1PR04MB444.namprd04.prod.outlook.com>
Message-ID: <201405152048.57703.even.rouault@mines-paris.org>

Le jeudi 15 mai 2014 17:27:50, Eddie Stathopoulos a ?crit :
> Hello all, I am attempting to create a C# WCF service to convert GeoJSON ->
> other formats. File Geodatabase is desired. I am using the latest C# GDAL
> bindings and the driver is being recognized and loaded, but it seems I'm
> bumping into a write lock?
> 
> I receive an AccessViolationException (Attempted to read or write protected
> memory. This is often an indication that other memory is corrupt) using
> the following code. The files in the FGDB directory are created.
> 
> outputDriver = Ogr.GetDriverByName("FileGDB");
> outputDataSource = outputDriver.CopyDataSource(dataSource, outputFilePath,
> null);
> 
> Any clue what is causing this lock or how I could get around this?

I cannot help for C# but my recommandation would be to try with ogr2ogr first.

> 
> Thanks!?

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From woodbri at swoodbridge.com  Thu May 15 12:08:43 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 15 May 2014 15:08:43 -0400
Subject: [gdal-dev] How to map Int32 or Float32 GTiff to color map?
In-Reply-To: <201405151956.53534.even.rouault@mines-paris.org>
References: <5374CE48.60305@swoodbridge.com>
	<201405151956.53534.even.rouault@mines-paris.org>
Message-ID: <537510BB.7040101@swoodbridge.com>

On 5/15/2014 1:56 PM, Even Rouault wrote:
> Le jeudi 15 mai 2014 16:25:12, Stephen Woodbridge a ?crit :
>> Hi all,
>>
>> I'm trying to create a VRT file for a GTiff that is Int32 or Float32 to
>> add a ColorTable but I seem to be missing a key piece of information.
>> How are the pixel values mapped to the color table entries? via the
>> histogram?
>>
>> My GTiff has noData=-32767 and good values the range from say -5 to 100.
>> So do I create a color table that is based on the 256 buckets in the
>> histogram?
>
> No way you can use a GDAL color table to map negative values...
> Perhaps you should use gdaldem color-relief to generate a RGB output. Note
> that gdaldem color-relief is compatible with VRT output : it uses the LUT
> mechanism to do so.

OK, I will look at gdaldem, but not wanting to give up on this yet, is 
there a way to change the NoData pixels from -32767 to say -20 then 
scale 1.0 and offset the value by 10.

This would make NoData=0

old   => new
  -5        5
   0       10
   1       11
100      110

then I would have all positive values and the range would be manageable?

The scale and offset are already supported in VRT, but I'm not sure if 
it is possible to remap -32767 values to a new value.

Thanks for your response.

-Steve

>>
>> So for example I get:
>>
>> Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>>     Min=-32767.000 Max=33.980   Computed Min/Max=-54.985,34.320
>>     Minimum=-32767.000, Maximum=33.980, Mean=-15887.345, StdDev=16386.592
>>     256 buckets from -32831.1 to 98.0444:
>>     1545169 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>> 0 0 0 0 0 0 27375 1924356
>>     NoData Value=-32767
>>     Metadata:
>>       STATISTICS_MAXIMUM=33.979999542236
>>       STATISTICS_MEAN=-15887.344614501
>>       STATISTICS_MINIMUM=-32767
>>       STATISTICS_STDDEV=16386.59208246
>>
>>
>> It seems that the NoData value is included in the stats which really
>> skews the numbers compressing all my values into two buckets! How can I
>> avoid that? I want to ignore the NoData values and spread my good values
>> into the remaining buckets. How can I do this?
>
> You can't. There's a ticket I think about the fact we should ignore nodata
> value in stats.
>
>>
>> Thanks,
>>     -Steve
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From thare at usgs.gov  Thu May 15 12:45:21 2014
From: thare at usgs.gov (Hare, Trent)
Date: Thu, 15 May 2014 12:45:21 -0700
Subject: [gdal-dev] How to map Int32 or Float32 GTiff to color map?
In-Reply-To: <537510BB.7040101@swoodbridge.com>
References: <5374CE48.60305@swoodbridge.com>
	<201405151956.53534.even.rouault@mines-paris.org>
	<537510BB.7040101@swoodbridge.com>
Message-ID: <CAB6t5t_C+qgk6-tzvwyzuov5AggY0kKhn=v5jmrYtFPTdjd4Ug@mail.gmail.com>

Steve,
   You can think of this very much *as a hack* but I had some success. I
was also testing how to colorize a DEM (or 32bit floating point image)
outside of gdaldem. You would need a script to configure the "lut" line for
each file min/max range though. It does seem to work and you can convert to
other colorized graphical formats (e.g. PNG) using gdal_translate.

example:
(1) create a 3 band VRT of your original file.
> ls dem.tif > mylist
> ls dem.tif >> mylist
> ls dem.tif >> mylist
> gdalbuildvrt -separate -input_file_list mylist DEM_3bands.vrt

(2) now manually add or script a <LUT> section for each band (see below for
color mapping or [dest value]. Original DEM range was from -8.296 to 4.022)

<LUT>[src value 1]:[dest value 1],[src value 2]:[dest value 2],...</LUT>

example:
<LUT>-8.296:75,-7:0,-3:0,-1.5:204,2:255,3.5:255,3.9:150,4.022:255</LUT>
from: http://www.gdal.org/gdal_vrttut.html


kind of crazy and really not tested much... Shows how convenient VRTs
continue to be.

Good luck,
Trent


example VRT and tiny DEM (1 MB, odd blip on the right):
https://www.dropbox.com/s/kb8x2vlzmwtl52v/ColorMapping_DEM_toRainbow-BrownWhite_test.zip

screenshot of DEM as converted to PNG:
> gdal_translate -ot byte -of PNG DEM_3bands.vrt DEM_3bands.png
https://www.dropbox.com/s/i1kldn7th7w5910/1MM3298IOLBYDEM08P2905_colorize.png


-------------------

The above "rainbow to brown to white" color-ramp in percent would be mapped
at:
# Red stretch pairs. The pattern is percentage:DN
0:75 10:0 40:0 55:204 70:255 85:255 99:150 100:255

# Green stretch pairs. The pattern is percentage:DN
0:0 10:0 30:151 40:204 55:204 70:102 85:0 99:75 100:255

# Blue stretch pairs. The pattern is percentage:DN
0:102 10:204 25:151 40:0 99:0 100:255

------------------

Example VRT:
<VRTDataset rasterXSize="373" rasterYSize="625">
  <GeoTransform>-5.0000000000000000e-001, 1.0000000000000000e+000,
0.0000000000000000e+000, 5.0000000000000000e-001,
0.0000000000000000e+000,-1.0000000000000000e+000</GeoTransform>
  <VRTRasterBand dataType="Float32" band="1">
    <NoDataValue>-3.40282265508890E+038</NoDataValue>
    <ColorInterp>Red</ColorInterp>
    <ComplexSource>
      <SourceFilename
relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="373" RasterYSize="625"
DataType="Float32" BlockXSize="373" BlockYSize="5" />
      <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
      <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />

<LUT>-8.296:75,-7:0,-3:0,-1.5:204,2:255,3.5:255,3.9:150,4.022:255</LUT>
    </ComplexSource>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="2">
    <NoDataValue>-3.40282265508890E+038</NoDataValue>
    <ColorInterp>Green</ColorInterp>
    <ComplexSource>
      <SourceFilename
relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="373" RasterYSize="625"
DataType="Float32" BlockXSize="373" BlockYSize="5" />
      <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
      <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />

<LUT>-8.296:0,-7:0,-5:151,-3:204,-1.5:204,2:102,3.5:0,3.9:75,4.022:255</LUT>
    </ComplexSource>
  </VRTRasterBand>
  <VRTRasterBand dataType="Float32" band="3">
    <NoDataValue>-3.40282265508890E+038</NoDataValue>
    <ColorInterp>Blue</ColorInterp>
    <ComplexSource>
      <SourceFilename
relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="373" RasterYSize="625"
DataType="Float32" BlockXSize="373" BlockYSize="5" />
      <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
      <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />
      <LUT>-8.296:102,-6.5:204,-4.5:151,-3:0,3.9:0,4.022:255</LUT>
    </ComplexSource>
  </VRTRasterBand>
</VRTDataset>




On Thu, May 15, 2014 at 12:08 PM, Stephen Woodbridge <
woodbri at swoodbridge.com> wrote:

> On 5/15/2014 1:56 PM, Even Rouault wrote:
>
>> Le jeudi 15 mai 2014 16:25:12, Stephen Woodbridge a ?crit :
>>
>>> Hi all,
>>>
>>> I'm trying to create a VRT file for a GTiff that is Int32 or Float32 to
>>> add a ColorTable but I seem to be missing a key piece of information.
>>> How are the pixel values mapped to the color table entries? via the
>>> histogram?
>>>
>>> My GTiff has noData=-32767 and good values the range from say -5 to 100.
>>> So do I create a color table that is based on the 256 buckets in the
>>> histogram?
>>>
>>
>> No way you can use a GDAL color table to map negative values...
>> Perhaps you should use gdaldem color-relief to generate a RGB output. Note
>> that gdaldem color-relief is compatible with VRT output : it uses the LUT
>> mechanism to do so.
>>
>
> OK, I will look at gdaldem, but not wanting to give up on this yet, is
> there a way to change the NoData pixels from -32767 to say -20 then scale
> 1.0 and offset the value by 10.
>
> This would make NoData=0
>
> old   => new
>  -5        5
>   0       10
>   1       11
> 100      110
>
> then I would have all positive values and the range would be manageable?
>
> The scale and offset are already supported in VRT, but I'm not sure if it
> is possible to remap -32767 values to a new value.
>
> Thanks for your response.
>
> -Steve
>
>
>
>>> So for example I get:
>>>
>>> Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>>>     Min=-32767.000 Max=33.980   Computed Min/Max=-54.985,34.320
>>>     Minimum=-32767.000, Maximum=33.980, Mean=-15887.345, StdDev=16386.592
>>>     256 buckets from -32831.1 to 98.0444:
>>>     1545169 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>>> 0 0 0 0 0 0 27375 1924356
>>>     NoData Value=-32767
>>>     Metadata:
>>>       STATISTICS_MAXIMUM=33.979999542236
>>>       STATISTICS_MEAN=-15887.344614501
>>>       STATISTICS_MINIMUM=-32767
>>>       STATISTICS_STDDEV=16386.59208246
>>>
>>>
>>> It seems that the NoData value is included in the stats which really
>>> skews the numbers compressing all my values into two buckets! How can I
>>> avoid that? I want to ignore the NoData values and spread my good values
>>> into the remaining buckets. How can I do this?
>>>
>>
>> You can't. There's a ticket I think about the fact we should ignore nodata
>> value in stats.
>>
>>
>>> Thanks,
>>>     -Steve
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/d1808ef6/attachment-0001.html>

From Elke.Ochs at erdc.dren.mil  Thu May 15 13:26:43 2014
From: Elke.Ochs at erdc.dren.mil (Ochs, Elke ERDC-RDE-CRREL-NH)
Date: Thu, 15 May 2014 20:26:43 +0000
Subject: [gdal-dev] OGRLineString Project
Message-ID: <49A547E4CC0E624EB0B69B7A9B7C0A4050434AC5@MS-EX2VKS.erdc.dren.mil>

Hello,

The class reference for OGRLineString says Project is available at OGR 1.11.0, GEOS >= 3.2.0.  I'm using Python 2.7, OGR 1.11.0, GEOS 3.4.2, but can't locate the Project method.  Is it really in 1.11.0?  Someone smarter than I said it seems to be missing from the SWIG interface (hope I said that right).  If Project isn't implemented, yet, will it be soon?

The syntax I've tried is:
MyLineGeometry.Project(MyPointGeometry)

I get the following error:
AttributeError: Project

This functionality is available through Shapely, but I need to limit use of additional dependencies.

Thank you for any help,
Elke

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/afe24225/attachment.html>

From woodbri at swoodbridge.com  Thu May 15 13:26:52 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Thu, 15 May 2014 16:26:52 -0400
Subject: [gdal-dev] How to map Int32 or Float32 GTiff to color map?
In-Reply-To: <CAB6t5t_C+qgk6-tzvwyzuov5AggY0kKhn=v5jmrYtFPTdjd4Ug@mail.gmail.com>
References: <5374CE48.60305@swoodbridge.com>
	<201405151956.53534.even.rouault@mines-paris.org>
	<537510BB.7040101@swoodbridge.com>
	<CAB6t5t_C+qgk6-tzvwyzuov5AggY0kKhn=v5jmrYtFPTdjd4Ug@mail.gmail.com>
Message-ID: <5375230C.30200@swoodbridge.com>

Trent - thank you for your idea. That was another idea that I was 
thinking about doing but your recipe makes it much clearer on how to do it.

Even - I tried the gdaldem method and after making the color mapping 
table it gave me very good results.

Great feedback and suggestions! I think I'm able to move this along now.

Thanks,
   -Steve

On 5/15/2014 3:45 PM, Hare, Trent wrote:
> Steve,
>     You can think of this very much *as a hack* but I had some success.
> I was also testing how to colorize a DEM (or 32bit floating point image)
> outside of gdaldem. You would need a script to configure the "lut" line
> for each file min/max range though. It does seem to work and you can
> convert to other colorized graphical formats (e.g. PNG) using
> gdal_translate.
>
> example:
> (1) create a 3 band VRT of your original file.
>  > ls dem.tif > mylist
>  > ls dem.tif >> mylist
>  > ls dem.tif >> mylist
>  > gdalbuildvrt -separate -input_file_list mylist DEM_3bands.vrt
>
> (2) now manually add or script a <LUT> section for each band (see below
> for color mapping or [dest value]. Original DEM range was from -8.296 to
> 4.022)
>
> <LUT>[src value 1]:[dest value 1],[src value 2]:[dest value 2],...</LUT>
>
> example:
> <LUT>-8.296:75,-7:0,-3:0,-1.5:204,2:255,3.5:255,3.9:150,4.022:255</LUT>
> from: http://www.gdal.org/gdal_vrttut.html
>
>
> kind of crazy and really not tested much... Shows how convenient VRTs
> continue to be.
>
> Good luck,
> Trent
>
>
> example VRT and tiny DEM (1 MB, odd blip on the right):
> https://www.dropbox.com/s/kb8x2vlzmwtl52v/ColorMapping_DEM_toRainbow-BrownWhite_test.zip
>
> screenshot of DEM as converted to PNG:
>  > gdal_translate -ot byte -of PNG DEM_3bands.vrt DEM_3bands.png
> https://www.dropbox.com/s/i1kldn7th7w5910/1MM3298IOLBYDEM08P2905_colorize.png
>
>
> -------------------
>
> The above "rainbow to brown to white" color-ramp in percent would be
> mapped at:
> # Red stretch pairs. The pattern is percentage:DN
> 0:75 10:0 40:0 55:204 70:255 85:255 99:150 100:255
>
> # Green stretch pairs. The pattern is percentage:DN
> 0:0 10:0 30:151 40:204 55:204 70:102 85:0 99:75 100:255
>
> # Blue stretch pairs. The pattern is percentage:DN
> 0:102 10:204 25:151 40:0 99:0 100:255
>
> ------------------
>
> Example VRT:
> <VRTDataset rasterXSize="373" rasterYSize="625">
>    <GeoTransform>-5.0000000000000000e-001, 1.0000000000000000e+000,
> 0.0000000000000000e+000, 5.0000000000000000e-001,
> 0.0000000000000000e+000,-1.0000000000000000e+000</GeoTransform>
>    <VRTRasterBand dataType="Float32" band="1">
>      <NoDataValue>-3.40282265508890E+038</NoDataValue>
>      <ColorInterp>Red</ColorInterp>
>      <ComplexSource>
>        <SourceFilename
> relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SourceProperties RasterXSize="373" RasterYSize="625"
> DataType="Float32" BlockXSize="373" BlockYSize="5" />
>        <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
>        <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />
>
> <LUT>-8.296:75,-7:0,-3:0,-1.5:204,2:255,3.5:255,3.9:150,4.022:255</LUT>
>      </ComplexSource>
>    </VRTRasterBand>
>    <VRTRasterBand dataType="Float32" band="2">
>      <NoDataValue>-3.40282265508890E+038</NoDataValue>
>      <ColorInterp>Green</ColorInterp>
>      <ComplexSource>
>        <SourceFilename
> relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SourceProperties RasterXSize="373" RasterYSize="625"
> DataType="Float32" BlockXSize="373" BlockYSize="5" />
>        <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
>        <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />
>
> <LUT>-8.296:0,-7:0,-5:151,-3:204,-1.5:204,2:102,3.5:0,3.9:75,4.022:255</LUT>
>      </ComplexSource>
>    </VRTRasterBand>
>    <VRTRasterBand dataType="Float32" band="3">
>      <NoDataValue>-3.40282265508890E+038</NoDataValue>
>      <ColorInterp>Blue</ColorInterp>
>      <ComplexSource>
>        <SourceFilename
> relativeToVRT="1">1MM3298IOLBYDEM08P2905.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SourceProperties RasterXSize="373" RasterYSize="625"
> DataType="Float32" BlockXSize="373" BlockYSize="5" />
>        <SrcRect xOff="0" yOff="0" xSize="373" ySize="625" />
>        <DstRect xOff="0" yOff="0" xSize="373" ySize="625" />
>        <LUT>-8.296:102,-6.5:204,-4.5:151,-3:0,3.9:0,4.022:255</LUT>
>      </ComplexSource>
>    </VRTRasterBand>
> </VRTDataset>
>
>
>
>
> On Thu, May 15, 2014 at 12:08 PM, Stephen Woodbridge
> <woodbri at swoodbridge.com <mailto:woodbri at swoodbridge.com>> wrote:
>
>     On 5/15/2014 1:56 PM, Even Rouault wrote:
>
>         Le jeudi 15 mai 2014 16:25:12, Stephen Woodbridge a ?crit :
>
>             Hi all,
>
>             I'm trying to create a VRT file for a GTiff that is Int32 or
>             Float32 to
>             add a ColorTable but I seem to be missing a key piece of
>             information.
>             How are the pixel values mapped to the color table entries?
>             via the
>             histogram?
>
>             My GTiff has noData=-32767 and good values the range from
>             say -5 to 100.
>             So do I create a color table that is based on the 256
>             buckets in the
>             histogram?
>
>
>         No way you can use a GDAL color table to map negative values...
>         Perhaps you should use gdaldem color-relief to generate a RGB
>         output. Note
>         that gdaldem color-relief is compatible with VRT output : it
>         uses the LUT
>         mechanism to do so.
>
>
>     OK, I will look at gdaldem, but not wanting to give up on this yet,
>     is there a way to change the NoData pixels from -32767 to say -20
>     then scale 1.0 and offset the value by 10.
>
>     This would make NoData=0
>
>     old   => new
>       -5        5
>        0       10
>        1       11
>     100      110
>
>     then I would have all positive values and the range would be manageable?
>
>     The scale and offset are already supported in VRT, but I'm not sure
>     if it is possible to remap -32767 values to a new value.
>
>     Thanks for your response.
>
>     -Steve
>
>
>
>             So for example I get:
>
>             Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>                  Min=-32767.000 Max=33.980   Computed Min/Max=-54.985,34.320
>                  Minimum=-32767.000, Maximum=33.980, Mean=-15887.345,
>             StdDev=16386.592
>                  256 buckets from -32831.1 to 98.0444:
>                  1545169 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
>             0 0 0 0 0 0
>             0 0 0 0 0 0 27375 1924356
>                  NoData Value=-32767
>                  Metadata:
>                    STATISTICS_MAXIMUM=33.__979999542236
>                    STATISTICS_MEAN=-15887.__344614501
>                    STATISTICS_MINIMUM=-32767
>                    STATISTICS_STDDEV=16386.__59208246
>
>
>             It seems that the NoData value is included in the stats
>             which really
>             skews the numbers compressing all my values into two
>             buckets! How can I
>             avoid that? I want to ignore the NoData values and spread my
>             good values
>             into the remaining buckets. How can I do this?
>
>
>         You can't. There's a ticket I think about the fact we should
>         ignore nodata
>         value in stats.
>
>
>             Thanks,
>                  -Steve
>
>             _________________________________________________
>             gdal-dev mailing list
>             gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>             http://lists.osgeo.org/__mailman/listinfo/gdal-dev
>             <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>
>
>     _________________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/__mailman/listinfo/gdal-dev
>     <http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
>


From jukka.rahkonen at mmmtike.fi  Thu May 15 14:24:12 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 15 May 2014 21:24:12 +0000 (UTC)
Subject: [gdal-dev] OSM driver to create separate tables for tags
References: <loom.20140514T161322-490@post.gmane.org>
	<ll05u5$bqj$1@ger.gmane.org>
	<loom.20140514T234009-872@post.gmane.org>
	<ll2la6$8ng$1@ger.gmane.org>
Message-ID: <loom.20140515T211351-691@post.gmane.org>

Andre Joost <andre+joost <at> nurfuerspam.de> writes:

> 
> But import time does not matter for me , as it is done only once. I was 
> rather thinking about rendering time. From the postgis database, I can 
> select a column "network" and style my cycle paths according to the 
> values "icn","ncn","rcn","lcn". Pretty much the same as I would do it 
> with a shapefile.
> 
> I guess this needs different handling with your tag table approach.


Couple of years ago I was told that such arrangement would be all too slow
for rendering https://groups.google.com/forum/#!topic/openstreetmap/aslKT7-OcLQ
I did not believe and I made some experiments and measured that in my
rendering test joined tables were faster than the standard osm2pgsql tables.
Not a surprise for me because osm2pgsql does not create indexes for the
attribute columns but my renderer was using them in selects. In the tag
table I had indexes on all columns. I prepered a test Spatialite DB then and
it is still online at http://latuviitta.org/documents/relation_test.zip


-Jukka Rahkonen-







From p.baumann at jacobs-university.de  Thu May 15 14:43:16 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Thu, 15 May 2014 23:43:16 +0200
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <1400154618.5374a9fa66d70@imp.free.fr>
References: <201405141253.32397.even.rouault@mines-paris.org>	<CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>
	<1400154618.5374a9fa66d70@imp.free.fr>
Message-ID: <537534F4.6010905@jacobs-university.de>

I've been talking to OGP folks, and they were not really interested - BTW, also 
not in our time coordinate reference systems; Time CRSs are being addressed 
within OGC, therefore: the OGC resolver serves space and (soon) time, and 
spatial requests will be forwarded to the EPSG service.

On including planetary CRSs in the OGC service we are talking with several 
people (inlc USGS, who likes the idea), but we decided to first get through with 
time before pursuing planetary stuff further.

OGC's CRS resolver (which we have implemented in FOSS) definitely allows such a 
scope extension.

cheers,
Peter


On 05/15/2014 01:50 PM, Even Rouault wrote:
> Selon Yann Chemin <ychemin at gmail.com>:
>
>> Hi,
>>
>> is there planetary datum support in this new version (i.e. Moon 2000, or
>> etc.)?
> No, I don't think that the EPSG folks are interested in other planets yet ;-)
> But Frank mentionned some time ago (
> http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary-td3750798.html
> ) that he wanted to investigate how to deliver the IAU set of planetary
> coordinate systems , but this hasn't been pursued further AFAIK.
>
> I see there's a version of this file here :
> http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt
>
> Even
>
>> Yann
>>
>> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
>>> Hi,
>>>
>>> I've followed the update process of the EPSG SRS database to latest v8.4,
>>> and
>>> just committed the updated files into libgeotiff, GDAL and PROJ trunk. Also
>>>
>>> submitted to PostGIS.
>>>
>>>  From what I can see, among many changes and additions, 2 new projection
>>> methods have been added:
>>> * 1051,Lambert Conic Conformal (2SP Michigan)
>>> --> looks very close to standard "Lambert Conic Conformal (2SP)", with the
>>> addition of a new parameter K, the ellipsoid scaling factor.
>>> * 1052,Colombia Urban
>>>
>>> I don't think any of those 2 new methods are currently handled by PROJ, so
>>> the
>>> new PCS based on those projection methods (3 Michigan SRS, and several
>>> dozains
>>> of Colombia PCS) will not be handled by GDAL nor PROJ.
>>>
>>> Regarding GDAL, I've improved the add_esri_column.py script (see
>>> http://trac.osgeo.org/geotiff/changeset/2446), so that we have more ESRI
>>> DATUM
>>> names. That should make morphing from/to ESRI .prj files a bit better.
>>>
>>> Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've also
>>> added
>>> the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
>>> Horizontal
>>> + Vertical).
>>>
>>> Please let me know if you see issues.
>>>
>>> libgeotiff:
>>> http://trac.osgeo.org/geotiff/ticket/63
>>> http://trac.osgeo.org/geotiff/changeset/2447
>>>
>>> GDAL:
>>> http://trac.osgeo.org/gdal/ticket/5462
>>> http://trac.osgeo.org/gdal/changeset/27322
>>>
>>> PROJ:
>>> http://trac.osgeo.org/proj/ticket/236
>>> http://trac.osgeo.org/proj/changeset/2448
>>>
>>> Submitted for PostGIS :
>>> http://trac.osgeo.org/postgis/ticket/2737
>>>
>>> Best regards,
>>>
>>> Even
>>>
>>> --
>>> Geospatial professional services
>>> http://even.rouault.free.fr/services.html
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>> --
>> ----
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis 
dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec 
preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From etourigny.dev at gmail.com  Thu May 15 16:16:27 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Thu, 15 May 2014 20:16:27 -0300
Subject: [gdal-dev] Update of EPSG database to v8.4
In-Reply-To: <CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>
References: <201405141253.32397.even.rouault@mines-paris.org>
	<CALTpO6BiRtz57RAZnP0EGqmUAv513WsgmoHizE7JY45LVR=3nA@mail.gmail.com>
	<1400154618.5374a9fa66d70@imp.free.fr>
	<CALTpO6BPeCYGEp1wQ0=YPMfvMUoKfBOf3ZWd4KQvX3m2vxdfpw@mail.gmail.com>
Message-ID: <CA+TxYvPiQetU+vL8qBo0cmRMDucabn-Ny4UKjBQgXBWHdxP9aw@mail.gmail.com>

You might be able to gzip compress the file
GDAL can read gzip files transparently, but I am not sure that the csv
 reading code in GDAL works with compressed files.



On Thu, May 15, 2014 at 9:00 AM, Yann Chemin <ychemin at gmail.com> wrote:

> Hi Even,
>
> I would be interested to include it. But I see that the 1Mb
> uncompressed text is an issue.
>
> If it was OK for the additional Mb in the source code,
> what would be the place to look into gdal code to create the patch needed?
>
> Thanks,
> Yann
>
> PS: did not copy other lists as I am not a member, registered to proj
> ML today though.
>
> On 15/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> > Selon Yann Chemin <ychemin at gmail.com>:
> >
> >> Hi,
> >>
> >> is there planetary datum support in this new version (i.e. Moon 2000, or
> >> etc.)?
> >
> > No, I don't think that the EPSG folks are interested in other planets yet
> > ;-)
> > But Frank mentionned some time ago (
> >
> http://osgeo-org.1560.x6.nabble.com/IAU-2000-Coordinate-System-Dictionary-td3750798.html
> > ) that he wanted to investigate how to deliver the IAU set of planetary
> > coordinate systems , but this hasn't been pursued further AFAIK.
> >
> > I see there's a version of this file here :
> > http://svn.osgeo.org/metacrs/sr.org/srsbrowser/data/IAU2000.wkt
> >
> > Even
> >
> >>
> >> Yann
> >>
> >> On 14/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> >> > Hi,
> >> >
> >> > I've followed the update process of the EPSG SRS database to latest
> >> > v8.4,
> >> > and
> >> > just committed the updated files into libgeotiff, GDAL and PROJ trunk.
> >> > Also
> >> >
> >> > submitted to PostGIS.
> >> >
> >> > From what I can see, among many changes and additions, 2 new
> projection
> >> > methods have been added:
> >> > * 1051,Lambert Conic Conformal (2SP Michigan)
> >> > --> looks very close to standard "Lambert Conic Conformal (2SP)", with
> >> > the
> >> > addition of a new parameter K, the ellipsoid scaling factor.
> >> > * 1052,Colombia Urban
> >> >
> >> > I don't think any of those 2 new methods are currently handled by
> PROJ,
> >> > so
> >> > the
> >> > new PCS based on those projection methods (3 Michigan SRS, and several
> >> > dozains
> >> > of Colombia PCS) will not be handled by GDAL nor PROJ.
> >> >
> >> > Regarding GDAL, I've improved the add_esri_column.py script (see
> >> > http://trac.osgeo.org/geotiff/changeset/2446), so that we have more
> >> > ESRI
> >> > DATUM
> >> > names. That should make morphing from/to ESRI .prj files a bit better.
> >> >
> >> > Regarding PROJ.4 'espg' and PostGIS spatial_ref_sys.sql files, I've
> >> > also
> >> > added
> >> > the list of SRS that are GEOCCS (GeoCentric) and COMPD_CS (Compound
> >> > Horizontal
> >> > + Vertical).
> >> >
> >> > Please let me know if you see issues.
> >> >
> >> > libgeotiff:
> >> > http://trac.osgeo.org/geotiff/ticket/63
> >> > http://trac.osgeo.org/geotiff/changeset/2447
> >> >
> >> > GDAL:
> >> > http://trac.osgeo.org/gdal/ticket/5462
> >> > http://trac.osgeo.org/gdal/changeset/27322
> >> >
> >> > PROJ:
> >> > http://trac.osgeo.org/proj/ticket/236
> >> > http://trac.osgeo.org/proj/changeset/2448
> >> >
> >> > Submitted for PostGIS :
> >> > http://trac.osgeo.org/postgis/ticket/2737
> >> >
> >> > Best regards,
> >> >
> >> > Even
> >> >
> >> > --
> >> > Geospatial professional services
> >> > http://even.rouault.free.fr/services.html
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev at lists.osgeo.org
> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> >
> >>
> >>
> >> --
> >> ----
> >>
> >
> >
> >
>
>
> --
> ----
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/a75d8ef6/attachment-0001.html>

From warmerdam at pobox.com  Thu May 15 19:02:39 2014
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 15 May 2014 19:02:39 -0700
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405152047.32942.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
Message-ID: <CA+YzLBcwG=EJRYw8n=1VTEgOPtQUmr2APnkC0TBi7RK5ggFXXg@mail.gmail.com>

Even,

I have (finally) looked over the RFC and I'm super pleased.  I couldn't
find anything I wanted to argue against, and it all looks excellent to me
though I could imagine some some bumps in real world use.

Feel free to call for a motion when you are ready.

Best regards,
Frank



On Thu, May 15, 2014 at 11:47 AM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > Hi,
> >
> > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> >
> >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> >
>
> No reaction : no interest or no time to review yet ?
> Or should I move that forward ?
> But I'd prefer if such architectural changes could be a bit reviewed...
>
> > Best regards,
> >
> > Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140515/eab1073a/attachment.html>

From bishop.dev at gmail.com  Thu May 15 23:56:29 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Fri, 16 May 2014 10:56:29 +0400
Subject: [gdal-dev] OGRLineString Project
In-Reply-To: <49A547E4CC0E624EB0B69B7A9B7C0A4050434AC5@MS-EX2VKS.erdc.dren.mil>
References: <49A547E4CC0E624EB0B69B7A9B7C0A4050434AC5@MS-EX2VKS.erdc.dren.mil>
Message-ID: <5375B69D.5060002@gmail.com>

Hi Elk,

The Project method (and several others) present in GDAL sinvce 1.11, but 
there is no binding to python yet.
About dates/releases when it'll be coded - hard to say, maybe somebody 
provide a patch with such functionality.

Best regards,
     Dmitry

16.05.2014 00:26, Ochs, Elke ERDC-RDE-CRREL-NH ?????:
>
> Hello,
>
> The class reference for OGRLineString says Project is available at OGR 
> 1.11.0, GEOS >= 3.2.0.  I'm using Python 2.7, OGR 1.11.0, GEOS 3.4.2, 
> but can't locate the Project method.  Is it really in 1.11.0?  Someone 
> smarter than I said it seems to be missing from the SWIG interface 
> (hope I said that right).  If Project isn't implemented, yet, will it 
> be soon?
>
> The syntax I've tried is:
>
> MyLineGeometry.Project(MyPointGeometry)
>
> I get the following error:
>
> AttributeError: Project
>
> This functionality is available through Shapely, but I need to limit 
> use of additional dependencies.
>
> Thank you for any help,
>
> Elke
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/45da40be/attachment.html>

From bishop.dev at gmail.com  Fri May 16 00:09:57 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Fri, 16 May 2014 11:09:57 +0400
Subject: [gdal-dev] GDAL_DRIVER_PATH dll hell
In-Reply-To: <ll2la7$8ng$3@ger.gmane.org>
References: <537491DB.7070300@gmail.com> <ll2la7$8ng$3@ger.gmane.org>
Message-ID: <5375B9C5.9040403@gmail.com>

Hi Andre,

The solution you proposed is something special. In common case this is 
library responsible to solve such situation.
Following you logic, the gdal have to deny using global environment 
variable GDAL_DRIVER_PATH and require that each developer set this 
variable manually in code or input parameters. So all developers play 
using the same rules.
Currently the developers can add to GDAL_DRIVER_PATH own incompatible 
drivers and all gdal libraries in PC will not work.

Maybe this is good idea to prevent using global environment variable 
GDAL_DRIVER_PATH, but I'm not sure that CPL config options support this 
behavior. It seem to me that CPLGetConfigOption take the global 
environment variable if the value is not present in the config, and 
where is no way to prevent this.

I call for solution to set such gdal behavior, when developers cannot 
crush gdal installations of each others.

Best regards,
     Dmitry

15.05.2014 18:47, Andre Joost ?????:
> Am 15.05.2014 12:07, schrieb Dmitriy Baryshnikov:
>
>> I found out that another program used the gdal 1.8 was installed on that
>> PC. And this program create env variable GDAL_DRIVER_PATH which pointed
>> on some non standard driver linked with gdal 1.8
>
>> I think some version checking needed or something else. Anyhow I think
>> this is bug.
>> That do you think about this?
>> If this is a bug I'll create ticket.
>>
>
> The gdal packages from gisinternals.com sets this variable when you 
> start the SDKShell.bat to open a command window. The variable gets 
> destroyed when the cmd window is closed.
> OSGEO4W does the same, setting the path to its own location.
>
> You could do the same, either in your application or in a bat arround 
> it. For the first choice, you could restore the path variable when you 
> exit your application.
>
> HTH,
> Andr? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From giohappy at gmail.com  Fri May 16 01:12:07 2014
From: giohappy at gmail.com (G. Allegri)
Date: Fri, 16 May 2014 10:12:07 +0200
Subject: [gdal-dev] ogr2ogr with OSM data error Too many tags in relation
In-Reply-To: <201405152006.59275.even.rouault@mines-paris.org>
References: <CAB4g1=zXhhYAcxF92EM2YyYe1NBRai1pmpoY=hEdhG8t83AOqg@mail.gmail.com>
	<201405152006.59275.even.rouault@mines-paris.org>
Message-ID: <CAB4g1=xeA4eEf7sbsmQ_rE=9PJUuvtVkT0L-xbbMeWAW_TCgpg@mail.gmail.com>

Hi Even, thanks.
A new run ended with the mentioned errors and a warning about a bad
polygon.
I thought it was a bad sqlite because QGIS couldn't load it, but ogrinfo
and ogr2ogr work well with it (I could convert to shapefiles).

giovanni


2014-05-15 20:06 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Le jeudi 15 mai 2014 16:29:52, G. Allegri a ?crit :
> > I'm trying to use the OGR OSM driver to convert an .osm file to sqlite
> > (spatialite)
> > Running:
> >
> > ogr2ogr -f SQlite myosm.sqlite myosm.osm -dsco SPATIALITE=YES
> >
> > I obtain:
> >
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> > ERROR 1: Too many tags in relation 365331
> >
> > (yes, it's repeated)
> > Relation 365331 is the italian administrative boundary (
> > http://www.openstreetmap.org/relation/365331). It contains a lot of tags
> > (mainly translations).
> >
> > Is there a limit to the number of relations OSM's driver can manage?
>
> The error comes from the XML .osm parser in fact. I see it has not the
> logic
> of the PBF parser to increase the hard-coded initial values. So the max is
> 256.
> If you convert your .osm into a .pbf, I suspect you wouldn't have this
> error.
> Otherwise if you compile from source you can increase the value at line
> 2246
> of ogr/ogrsf_frmts/osm/osm_parser.cpp ( psCtxt->nTagsAllocated = 256; ).
> But that error is not critical. The extra tags after the 256 first ones
> will
> just be ignored.
> Anyway it might be good if you can open a ticket about that issue.
>
> > How to
> > avoid loading all those name "subtags"?
> >
> > giovanni
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



-- 
Giovanni Allegri
http://about.me/giovanniallegri
Twitter: https://twitter.com/_giohappy_
blog: http://blog.spaziogis.it
GEO+ geomatica in Italia http://bit.ly/GEOplus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/f88520ed/attachment.html>

From giohappy at gmail.com  Fri May 16 01:35:27 2014
From: giohappy at gmail.com (G. Allegri)
Date: Fri, 16 May 2014 10:35:27 +0200
Subject: [gdal-dev] ogr2ogr with OSM data error Too many tags in relation
In-Reply-To: <CAB4g1=xeA4eEf7sbsmQ_rE=9PJUuvtVkT0L-xbbMeWAW_TCgpg@mail.gmail.com>
References: <CAB4g1=zXhhYAcxF92EM2YyYe1NBRai1pmpoY=hEdhG8t83AOqg@mail.gmail.com>
	<201405152006.59275.even.rouault@mines-paris.org>
	<CAB4g1=xeA4eEf7sbsmQ_rE=9PJUuvtVkT0L-xbbMeWAW_TCgpg@mail.gmail.com>
Message-ID: <CAB4g1=w9unkEF7OBgnRhvtDhoK0gywmYzfPi3oLuYgj8+WXAUA@mail.gmail.com>

Solved the mistery :)
Osgeo4W's GDAL seems to not have splite, so the output SQLite db wasn't a
spatialite db.

giovanni


2014-05-16 10:12 GMT+02:00 G. Allegri <giohappy at gmail.com>:

> Hi Even, thanks.
> A new run ended with the mentioned errors and a warning about a bad
> polygon.
> I thought it was a bad sqlite because QGIS couldn't load it, but ogrinfo
> and ogr2ogr work well with it (I could convert to shapefiles).
>
> giovanni
>
>
> 2014-05-15 20:06 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
>
> Le jeudi 15 mai 2014 16:29:52, G. Allegri a ?crit :
>> > I'm trying to use the OGR OSM driver to convert an .osm file to sqlite
>> > (spatialite)
>> > Running:
>> >
>> > ogr2ogr -f SQlite myosm.sqlite myosm.osm -dsco SPATIALITE=YES
>> >
>> > I obtain:
>> >
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> > ERROR 1: Too many tags in relation 365331
>> >
>> > (yes, it's repeated)
>> > Relation 365331 is the italian administrative boundary (
>> > http://www.openstreetmap.org/relation/365331). It contains a lot of
>> tags
>> > (mainly translations).
>> >
>> > Is there a limit to the number of relations OSM's driver can manage?
>>
>> The error comes from the XML .osm parser in fact. I see it has not the
>> logic
>> of the PBF parser to increase the hard-coded initial values. So the max is
>> 256.
>> If you convert your .osm into a .pbf, I suspect you wouldn't have this
>> error.
>> Otherwise if you compile from source you can increase the value at line
>> 2246
>> of ogr/ogrsf_frmts/osm/osm_parser.cpp ( psCtxt->nTagsAllocated = 256; ).
>> But that error is not critical. The extra tags after the 256 first ones
>> will
>> just be ignored.
>> Anyway it might be good if you can open a ticket about that issue.
>>
>> > How to
>> > avoid loading all those name "subtags"?
>> >
>> > giovanni
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>>
>
>
>
> --
> Giovanni Allegri
> http://about.me/giovanniallegri
> Twitter: https://twitter.com/_giohappy_
> blog: http://blog.spaziogis.it
> GEO+ geomatica in Italia http://bit.ly/GEOplus
>



-- 
Giovanni Allegri
http://about.me/giovanniallegri
Twitter: https://twitter.com/_giohappy_
blog: http://blog.spaziogis.it
GEO+ geomatica in Italia http://bit.ly/GEOplus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/29655477/attachment-0001.html>

From nicolas.simon at spw.wallonie.be  Fri May 16 03:53:14 2014
From: nicolas.simon at spw.wallonie.be (SIMON Nicolas)
Date: Fri, 16 May 2014 10:53:14 +0000
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <CA+YzLBcwG=EJRYw8n=1VTEgOPtQUmr2APnkC0TBi7RK5ggFXXg@mail.gmail.com>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
	<CA+YzLBcwG=EJRYw8n=1VTEgOPtQUmr2APnkC0TBi7RK5ggFXXg@mail.gmail.com>
Message-ID: <F02D54DF5576D84C86C23A39A792DC7E3164F336@se0002v.wallonie.intra>

Hi list,

I'm a little disappointed because I have hoped to find in version 2 a reinforcement (unification) of the semantics of operations against the reported capabilities (cf OGRLayer.TestCapability)

For exemple, if I take the function OGRLayer.SetFeature (OGRFeature * poFeature) which is documented as ?Rewrite an existing feature?
I found drivers implementing it with ?update/where? which do nothing if feature does not exist (conforming implementation),
and other drivers implementing it with ?delete/insert? which always insert the feature (not conforming implementation)

I think that adopting the same semantic will allow to automate generic autotests on the basis of reported capabilities (and simplify autotest).
This will also simplify applications that want to use GDAL/OGR in a generic way

In addition, these generic autotests could allow developers to validate the compatibility of their new driver against the semantics of GDAL/OGR and can give a kind of ?compatibility label?.

May be this suggestion becomes a new RFC (if someone else agree with me)

Nicolas

De : gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Frank Warmerdam
Envoy? : vendredi 16 mai 2014 04:03
? : Even Rouault
Cc : gdal dev
Objet : Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification

Even,

I have (finally) looked over the RFC and I'm super pleased.  I couldn't find anything I wanted to argue against, and it all looks excellent to me though I could imagine some some bumps in real world use.

Feel free to call for a motion when you are ready.

Best regards,
Frank


On Thu, May 15, 2014 at 11:47 AM, Even Rouault <even.rouault at mines-paris.org<mailto:even.rouault at mines-paris.org>> wrote:
Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> Hi,
>
> This is a call for discussion on "RFC 46: GDAL/OGR unification"
>
>   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
No reaction : no interest or no time to review yet ?
Or should I move that forward ?
But I'd prefer if such architectural changes could be a bit reviewed...

> Best regards,
>
> Even

--
Geospatial professional services
http://even.rouault.free.fr/services.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com<mailto:warmerdam at pobox.com>
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/516266b3/attachment.html>

From lucena_ivan at hotmail.com  Fri May 16 03:57:19 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 16 May 2014 06:57:19 -0400
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405152047.32942.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>,
	<201405152047.32942.even.rouault@mines-paris.org>
Message-ID: <BLU173-W17D150BD146B997CC4980890310@phx.gbl>

Even,

I think that RFC 36 should be included in your list of 
related RFCs and should be reconsider for adoption since the unification
 would make the probing even more expensive.

Regards,

Ivan 

> From: even.rouault at mines-paris.org
> To: gdal-dev at lists.osgeo.org
> Date: Thu, 15 May 2014 20:47:32 +0200
> Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
> 
> Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > Hi,
> > 
> > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > 
> >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > 
> 
> No reaction : no interest or no time to review yet ?
> Or should I move that forward ?
> But I'd prefer if such architectural changes could be a bit reviewed...
> 
> > Best regards,
> > 
> > Even
> 
> -- 
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/bc8f1214/attachment.html>

From even.rouault at mines-paris.org  Fri May 16 04:23:43 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 13:23:43 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <F02D54DF5576D84C86C23A39A792DC7E3164F336@se0002v.wallonie.intra>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
	<CA+YzLBcwG=EJRYw8n=1VTEgOPtQUmr2APnkC0TBi7RK5ggFXXg@mail.gmail.com>
	<F02D54DF5576D84C86C23A39A792DC7E3164F336@se0002v.wallonie.intra>
Message-ID: <1400239423.5375f53f07727@imp.free.fr>

Hi Nicolas,

> Hi list,
>
> I'm a little disappointed because I have hoped to find in version 2 a
> reinforcement (unification) of the semantics of operations against the
> reported capabilities (cf OGRLayer.TestCapability)

Apart from the below example, are you thinking to other things ?

RFC 46 is already big enough, and I'd prefer it not to turn into a jumbo RFC ;-)

>
> For exemple, if I take the function OGRLayer.SetFeature (OGRFeature *
> poFeature) which is documented as ???Rewrite an existing feature???
> I found drivers implementing it with ???update/where??? which do nothing if
> feature does not exist (conforming implementation),
> and other drivers implementing it with ???delete/insert??? which always
> insert the feature (not conforming implementation)

I'd say that it is pretty much an implementation detail that could/should be
fixed in the drivers, if it can be. Which drivers are you thinking to that would
not implement the right semantics ?

>
> I think that adopting the same semantic will allow to automate generic
> autotests on the basis of reported capabilities (and simplify autotest).
> This will also simplify applications that want to use GDAL/OGR in a generic
> way

There's already the test_ogrsf utility that can be used for that. A substantial
number of OGR drivers already include a test that run it.

>
> In addition, these generic autotests could allow developers to validate the
> compatibility of their new driver against the semantics of GDAL/OGR and can
> give a kind of ???compatibility label???.

Yes, but some manual tests are still necessary because test_ogrsf will not be
able for example to tell if the values of features reported by the drivers are
the one expected. It can only do consistency checks, like checking that the
number of iterations of GetNextFeature() equals to GetFeatureCount(), etc...

>
> May be this suggestion becomes a new RFC (if someone else agree with me)

If someone wants to do the implementation work ;-) But I'm still not clear on
the scope you would give to such an RFC.

Regards,

Even


From even.rouault at mines-paris.org  Fri May 16 04:36:08 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 13:36:08 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <BLU173-W17D150BD146B997CC4980890310@phx.gbl>
References: <201405080013.23209.even.rouault@mines-paris.org>,
	<201405152047.32942.even.rouault@mines-paris.org>
	<BLU173-W17D150BD146B997CC4980890310@phx.gbl>
Message-ID: <1400240168.5375f8285481b@imp.free.fr>

Ivan,

yes indeed, I missed that one. I'll update the RFC with it.
I think that the intent of RFC36 is covered by what is already proposed in RFC46
with the papszAllowedDrivers of GDALOpenEx().

I do not think that specifying the candidate driver(s) is that usefull in
utilities since the time to launch them will be generally higher than the
probing time. But that could be easily implemented later with an option if that
was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly gdalinfo
foo.jp2 -driver jp2ecw,jp2openjpeg).
Due to the work I did in OGR drivers to avoid repeated file access by using
GDALOpenInfo*, I don't think that GDAL drivers should be affected. And the OGR
drivers are registered after the GDAL ones. So if the file being opened is
really a GDAL dataset, the OGR drivers should have 0 impact on the opening time.
I did try to benchmark a bit that, but it is difficult to come to a firm
conclusion since there are many factors: hot/cold runs, whether you spawn a new
process or use an existing one, etc.. And the time being measured are a few tens
of milliseconds, so very sensitive to task scheduling.

Even

> Even,
>
> I think that RFC 36 should be included in your list of
> related RFCs and should be reconsider for adoption since the unification
>  would make the probing even more expensive.
>
> Regards,
>
> Ivan
>
> > From: even.rouault at mines-paris.org
> > To: gdal-dev at lists.osgeo.org
> > Date: Thu, 15 May 2014 20:47:32 +0200
> > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
> >
> > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > Hi,
> > >
> > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > >
> > >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > >
> >
> > No reaction : no interest or no time to review yet ?
> > Or should I move that forward ?
> > But I'd prefer if such architectural changes could be a bit reviewed...
> >
> > > Best regards,
> > >
> > > Even
> >
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From lucena_ivan at hotmail.com  Fri May 16 07:01:12 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 16 May 2014 10:01:12 -0400
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <1400240168.5375f8285481b@imp.free.fr>
References: <201405080013.23209.even.rouault@mines-paris.org>,
	<201405152047.32942.even.rouault@mines-paris.org>
	<BLU173-W17D150BD146B997CC4980890310@phx.gbl>,
	<1400240168.5375f8285481b@imp.free.fr>
Message-ID: <BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>

Even,

Yes, it is hard to measure the impact of probing in a single file or any interactive command line operations.

In the current API the class Driver doesn't expose the Open method:

Driver drv = gdal.GetDriverByName("QWERTY");
Dataset dst = drv.Open("ASDFG");

IMHO that is a missing functionality in  GDAL API. 

GDAL API is a library to support Geospatial Data Abastration not just a format conversion tool. You should be able the use it even if your sole intention is do deal with the fictitious "QWERTY" format. IMHO. Yes, you can delete all the driver or put then all on the black list but that may not be the best solution.

The frustration of some user/programmer could be that they know what driver they want to use and they don't want to waste time probing; they don't want GDAL to get confused by files that can be supported by driver A and B; and most important they want to process a very very large number of files (ETL) or repeated times (WEB).

The RFC 36 is just a band-aid solution. It starts from the fact that some drivers already haven a prefix like "HDF4:" and use it to select the driver. As you can see, the suggested code is not that pretty [http://trac.osgeo.org/gdal/ticket/3043] since there is no Driver::Open method available.

Regards,

Ivan

> Date: Fri, 16 May 2014 13:36:08 +0200
> From: even.rouault at mines-paris.org
> To: lucena_ivan at hotmail.com
> CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
> 
> Ivan,
> 
> yes indeed, I missed that one. I'll update the RFC with it.
> I think that the intent of RFC36 is covered by what is already proposed in RFC46
> with the papszAllowedDrivers of GDALOpenEx().
> 
> I do not think that specifying the candidate driver(s) is that usefull in
> utilities since the time to launch them will be generally higher than the
> probing time. But that could be easily implemented later with an option if that
> was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly gdalinfo
> foo.jp2 -driver jp2ecw,jp2openjpeg).
> Due to the work I did in OGR drivers to avoid repeated file access by using
> GDALOpenInfo*, I don't think that GDAL drivers should be affected. And the OGR
> drivers are registered after the GDAL ones. So if the file being opened is
> really a GDAL dataset, the OGR drivers should have 0 impact on the opening time.
> I did try to benchmark a bit that, but it is difficult to come to a firm
> conclusion since there are many factors: hot/cold runs, whether you spawn a new
> process or use an existing one, etc.. And the time being measured are a few tens
> of milliseconds, so very sensitive to task scheduling.
> 
> Even
> 
> > Even,
> >
> > I think that RFC 36 should be included in your list of
> > related RFCs and should be reconsider for adoption since the unification
> >  would make the probing even more expensive.
> >
> > Regards,
> >
> > Ivan
> >
> > > From: even.rouault at mines-paris.org
> > > To: gdal-dev at lists.osgeo.org
> > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
> > >
> > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > Hi,
> > > >
> > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > >
> > > >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > >
> > >
> > > No reaction : no interest or no time to review yet ?
> > > Or should I move that forward ?
> > > But I'd prefer if such architectural changes could be a bit reviewed...
> > >
> > > > Best regards,
> > > >
> > > > Even
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> 
> 
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/74e4b693/attachment.html>

From etourigny.dev at gmail.com  Fri May 16 07:23:02 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 16 May 2014 11:23:02 -0300
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <1400240168.5375f8285481b@imp.free.fr>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
	<BLU173-W17D150BD146B997CC4980890310@phx.gbl>
	<1400240168.5375f8285481b@imp.free.fr>
Message-ID: <CA+TxYvNxOQuUmSB0R-jfRY6ynVpk2OgDA0ZYGEaerzrKSRtBKQ@mail.gmail.com>

>From my understanding of the RFC, legacy functions GDALOpen() would only
try to open the dataset using raster drivers and OGROpen() would only try
using vector drivers, so it shouldn't take more time than in gdal 1.x.

It also seems that this RFC addresses the need to specify the driver(s)
used to open the dataset. This effectively solves the problems raised in
RFC 36, as Even mentions. In my view no need to work on RFC 36 as this
should cover it (as long as the utilities are updated).

Looks good to me!

cheers,
Etienne



On Fri, May 16, 2014 at 8:36 AM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Ivan,
>
> yes indeed, I missed that one. I'll update the RFC with it.
> I think that the intent of RFC36 is covered by what is already proposed in
> RFC46
> with the papszAllowedDrivers of GDALOpenEx().
>
> I do not think that specifying the candidate driver(s) is that usefull in
> utilities since the time to launch them will be generally higher than the
> probing time. But that could be easily implemented later with an option if
> that
> was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly gdalinfo
> foo.jp2 -driver jp2ecw,jp2openjpeg).
> Due to the work I did in OGR drivers to avoid repeated file access by using
> GDALOpenInfo*, I don't think that GDAL drivers should be affected. And the
> OGR
> drivers are registered after the GDAL ones. So if the file being opened is
> really a GDAL dataset, the OGR drivers should have 0 impact on the opening
> time.
> I did try to benchmark a bit that, but it is difficult to come to a firm
> conclusion since there are many factors: hot/cold runs, whether you spawn
> a new
> process or use an existing one, etc.. And the time being measured are a
> few tens
> of milliseconds, so very sensitive to task scheduling.
>
> Even
>
> > Even,
> >
> > I think that RFC 36 should be included in your list of
> > related RFCs and should be reconsider for adoption since the unification
> >  would make the probing even more expensive.
> >
> > Regards,
> >
> > Ivan
> >
> > > From: even.rouault at mines-paris.org
> > > To: gdal-dev at lists.osgeo.org
> > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> unification
> > >
> > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > Hi,
> > > >
> > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > >
> > > >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > >
> > >
> > > No reaction : no interest or no time to review yet ?
> > > Or should I move that forward ?
> > > But I'd prefer if such architectural changes could be a bit reviewed...
> > >
> > > > Best regards,
> > > >
> > > > Even
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/21295f0a/attachment.html>

From etourigny.dev at gmail.com  Fri May 16 07:25:13 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 16 May 2014 11:25:13 -0300
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
	<BLU173-W17D150BD146B997CC4980890310@phx.gbl>
	<1400240168.5375f8285481b@imp.free.fr>
	<BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>
Message-ID: <CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>

With this RFC, you could achieve this using GDALOpenEx()

e.g. GDALOpenEx( "ASDFG", GDAL_OF_ALL, "QWERTY")


On Fri, May 16, 2014 at 11:01 AM, Ivan Lucena <lucena_ivan at hotmail.com>wrote:

> Even,
>
> Yes, it is hard to measure the impact of probing in a single file or any
> interactive command line operations.
>
> In the current API the class Driver doesn't expose the Open method:
>
> *Driver drv = gdal.GetDriverByName("QWERTY");*
> *Dataset dst = drv.Open("ASDFG");*
>
>
> IMHO that is a *missing functionality* in  GDAL API.
>
> GDAL API is a library to support Geospatial Data Abastration not just a
> format conversion tool. You should be able the use it even if your sole
> intention is do deal with the fictitious "QWERTY" format. IMHO. Yes, you
> can delete all the driver or put then all on the black list but that may
> not be the best solution.
>
> The frustration of some user/programmer could be that they know what
> driver they want to use and they don't want to waste time probing; they
> don't want GDAL to get confused by files that can be supported by driver A
> and B; and most important they want to process a very very large number of
> files (ETL) or repeated times (WEB).
>
> The RFC 36 is just a band-aid solution. It starts from the fact that some
> drivers already haven a prefix like "HDF4:" and use it to select the
> driver. As you can see, the suggested code is not that pretty [
> http://trac.osgeo.org/gdal/ticket/3043] since there is no Driver::Open
> method available.
>
> Regards,
>
> Ivan
>
> > Date: Fri, 16 May 2014 13:36:08 +0200
> > From: even.rouault at mines-paris.org
> > To: lucena_ivan at hotmail.com
> > CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> > Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> unification
>
> >
> > Ivan,
> >
> > yes indeed, I missed that one. I'll update the RFC with it.
> > I think that the intent of RFC36 is covered by what is already proposed
> in RFC46
> > with the papszAllowedDrivers of GDALOpenEx().
> >
> > I do not think that specifying the candidate driver(s) is that usefull in
> > utilities since the time to launch them will be generally higher than the
> > probing time. But that could be easily implemented later with an option
> if that
> > was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly
> gdalinfo
> > foo.jp2 -driver jp2ecw,jp2openjpeg).
> > Due to the work I did in OGR drivers to avoid repeated file access by
> using
> > GDALOpenInfo*, I don't think that GDAL drivers should be affected. And
> the OGR
> > drivers are registered after the GDAL ones. So if the file being opened
> is
> > really a GDAL dataset, the OGR drivers should have 0 impact on the
> opening time.
> > I did try to benchmark a bit that, but it is difficult to come to a firm
> > conclusion since there are many factors: hot/cold runs, whether you
> spawn a new
> > process or use an existing one, etc.. And the time being measured are a
> few tens
> > of milliseconds, so very sensitive to task scheduling.
> >
> > Even
> >
> > > Even,
> > >
> > > I think that RFC 36 should be included in your list of
> > > related RFCs and should be reconsider for adoption since the
> unification
> > > would make the probing even more expensive.
> > >
> > > Regards,
> > >
> > > Ivan
> > >
> > > > From: even.rouault at mines-paris.org
> > > > To: gdal-dev at lists.osgeo.org
> > > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> unification
> > > >
> > > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > > Hi,
> > > > >
> > > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > > >
> > > > > http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > > >
> > > >
> > > > No reaction : no interest or no time to review yet ?
> > > > Or should I move that forward ?
> > > > But I'd prefer if such architectural changes could be a bit
> reviewed...
> > > >
> > > > > Best regards,
> > > > >
> > > > > Even
> > > >
> > > > --
> > > > Geospatial professional services
> > > > http://even.rouault.free.fr/services.html
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >
> >
> >
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/28777a73/attachment-0001.html>

From danieltesta at suremptec.com.ar  Fri May 16 07:01:45 2014
From: danieltesta at suremptec.com.ar (Daniel Testa)
Date: Fri, 16 May 2014 11:01:45 -0300
Subject: [gdal-dev]  new landsat-8 metadata format
Message-ID: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>

Hi, I'm writing to you because I need support for the new Landsat-8
metadata format (_MTL.txt file)

I took a look at the latest version, 1.11.0, and I couldn't find anything
on the matter. So, I was thinking I could add support for the new format by
myself.

There are 3 groups of bands: panchromatic, multispectral and thermal. One
.tif file for each band and then the MTL file with all the info. I'd like
to open the MTL file, using GDAL, and have access to all of them. So, what
I was thinking was that I could add a public method (virtual) to the
GDALDataset class, lets say GetSubDatasets, that would allow a dataset to
return associated subdatasets. Then, in the FASTDataset class, if I detect
that I'm trying to open a MTL file, I could make the FASTDataset::Open
method return a Dataset (as it does now) containing only the multispectral
bands and then with the overridden GetSubDatasets method I could get a
vector with the other 2 datasets: one with the panchromatic band and
another one with the thermal bands.

What do you think?

Any idea, suggestion or comment is very welcome :)

Sample:

class CPL_DLL GDALDataset : public GDALMajorObject
{
[...]
public:
    virtual GDALDataset* GetSubDatasets() { return NULL; }
[...]
}

class FASTDataset : public GDALPamDataset
{
[...]
private:
    GDALDataset* porSubDatasets;
[...]
public:
    virtual GDALDataset* GetSubDatasets();
[...]
}

GDALDataset *FASTDataset::Open( GDALOpenInfo * poOpenInfo )
{
    /**

    IF mtl
        LOAD main dataset
        LOAD subdatasets
        RETURN main dataset

    **/

    int i;

    if(poOpenInfo->nHeaderBytes < 1024)
        return NULL;

[...]
}

Thanks in advance.

Regards,
Daniel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/0e65953a/attachment.html>

From ragi at burhum.com  Fri May 16 08:15:53 2014
From: ragi at burhum.com (rburhum)
Date: Fri, 16 May 2014 08:15:53 -0700 (PDT)
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405080013.23209.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
Message-ID: <1400253352937-5140783.post@n6.nabble.com>

I went through the whole RFC and it looks great! 

Even, this looks like an incredible amount of work and I wanted to thank you
for undertaking it.

Ragi



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-46-GDAL-OGR-unification-tp5139112p5140783.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lucena_ivan at hotmail.com  Fri May 16 08:18:38 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 16 May 2014 11:18:38 -0400
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>
References: <201405080013.23209.even.rouault@mines-paris.org>,
	<201405152047.32942.even.rouault@mines-paris.org>,
	<BLU173-W17D150BD146B997CC4980890310@phx.gbl>,
	<1400240168.5375f8285481b@imp.free.fr>,
	<BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>,
	<CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>
Message-ID: <BLU173-W8BB1675F44738DD2C4F1390310@phx.gbl>

Hi Etienne,

That sounds great!

Thanks to point that out.

Regards,

Ivan

Date: Fri, 16 May 2014 11:25:13 -0300
Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
From: etourigny.dev at gmail.com
To: lucena_ivan at hotmail.com
CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org

With this RFC, you could achieve this using GDALOpenEx()
e.g. GDALOpenEx( "ASDFG", GDAL_OF_ALL, "QWERTY")


On Fri, May 16, 2014 at 11:01 AM, Ivan Lucena <lucena_ivan at hotmail.com> wrote:




Even,

Yes, it is hard to measure the impact of probing in a single file or any interactive command line operations.

In the current API the class Driver doesn't expose the Open method:


Driver drv = gdal.GetDriverByName("QWERTY");
Dataset dst = drv.Open("ASDFG");

IMHO that is a missing functionality in  GDAL API. 

GDAL API is a library to support Geospatial Data Abastration not just a format conversion tool. You should be able the use it even if your sole intention is do deal with the fictitious "QWERTY" format. IMHO. Yes, you can delete all the driver or put then all on the black list but that may not be the best solution.


The frustration of some user/programmer could be that they know what driver they want to use and they don't want to waste time probing; they don't want GDAL to get confused by files that can be supported by driver A and B; and most important they want to process a very very large number of files (ETL) or repeated times (WEB).


The RFC 36 is just a band-aid solution. It starts from the fact that some drivers already haven a prefix like "HDF4:" and use it to select the driver. As you can see, the suggested code is not that pretty [http://trac.osgeo.org/gdal/ticket/3043] since there is no Driver::Open method available.


Regards,

Ivan

> Date: Fri, 16 May 2014 13:36:08 +0200
> From: even.rouault at mines-paris.org
> To: lucena_ivan at hotmail.com

> CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification

> 
> Ivan,
> 
> yes indeed, I missed that one. I'll update the RFC with it.
> I think that the intent of RFC36 is covered by what is already proposed in RFC46
> with the papszAllowedDrivers of GDALOpenEx().

> 
> I do not think that specifying the candidate driver(s) is that usefull in
> utilities since the time to launch them will be generally higher than the
> probing time. But that could be easily implemented later with an option if that

> was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly gdalinfo
> foo.jp2 -driver jp2ecw,jp2openjpeg).
> Due to the work I did in OGR drivers to avoid repeated file access by using
> GDALOpenInfo*, I don't think that GDAL drivers should be affected. And the OGR

> drivers are registered after the GDAL ones. So if the file being opened is
> really a GDAL dataset, the OGR drivers should have 0 impact on the opening time.
> I did try to benchmark a bit that, but it is difficult to come to a firm

> conclusion since there are many factors: hot/cold runs, whether you spawn a new
> process or use an existing one, etc.. And the time being measured are a few tens
> of milliseconds, so very sensitive to task scheduling.

> 
> Even
> 
> > Even,
> >
> > I think that RFC 36 should be included in your list of
> > related RFCs and should be reconsider for adoption since the unification
> >  would make the probing even more expensive.

> >
> > Regards,
> >
> > Ivan
> >
> > > From: even.rouault at mines-paris.org
> > > To: gdal-dev at lists.osgeo.org

> > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
> > >
> > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :

> > > > Hi,
> > > >
> > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > >
> > > >   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

> > > >
> > >
> > > No reaction : no interest or no time to review yet ?
> > > Or should I move that forward ?
> > > But I'd prefer if such architectural changes could be a bit reviewed...

> > >
> > > > Best regards,
> > > >
> > > > Even
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html

> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev

> >
> 
> 
 		 	   		  

_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev

 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/5a3d5f31/attachment.html>

From even.rouault at mines-paris.org  Fri May 16 10:56:04 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 19:56:04 +0200
Subject: [gdal-dev] new landsat-8 metadata format
In-Reply-To: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
References: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
Message-ID: <201405161956.04718.even.rouault@mines-paris.org>

Daniel,

There's no real need of a new API for that (although it might be cleaner to 
have a dedicated one at some point). I'd note that your proposed API would 
only work for a single subdataset, not a vector of them.

Anyway, the subdatasets mechanism already exist in many drivers and should do 
what you need. You can read the "SUBDATASETS domain" section of 
http://www.gdal.org/gdal_datamodel.html and have a look at the code of the 
mentionned drivers to see how they do that.

Another question I have is : how close or far would be Landsat8 support  from 
the existing code of the FAST driver. I see that FAST relies on "raw" bands, 
whereas you mention .tif for Landsat 8 + the change of metadata format. So it 
might be more appropriate to have a new driver if technically there is little 
common points between the drivers.

Best regards,

Even

> Hi, I'm writing to you because I need support for the new Landsat-8
> metadata format (_MTL.txt file)
> 
> I took a look at the latest version, 1.11.0, and I couldn't find anything
> on the matter. So, I was thinking I could add support for the new format by
> myself.
> 
> There are 3 groups of bands: panchromatic, multispectral and thermal. One
> .tif file for each band and then the MTL file with all the info. I'd like
> to open the MTL file, using GDAL, and have access to all of them. So, what
> I was thinking was that I could add a public method (virtual) to the
> GDALDataset class, lets say GetSubDatasets, that would allow a dataset to
> return associated subdatasets. Then, in the FASTDataset class, if I detect
> that I'm trying to open a MTL file, I could make the FASTDataset::Open
> method return a Dataset (as it does now) containing only the multispectral
> bands and then with the overridden GetSubDatasets method I could get a
> vector with the other 2 datasets: one with the panchromatic band and
> another one with the thermal bands.
> 
> What do you think?
> 
> Any idea, suggestion or comment is very welcome :)
> 
> Sample:
> 
> class CPL_DLL GDALDataset : public GDALMajorObject
> {
> [...]
> public:
>     virtual GDALDataset* GetSubDatasets() { return NULL; }
> [...]
> }
> 
> class FASTDataset : public GDALPamDataset
> {
> [...]
> private:
>     GDALDataset* porSubDatasets;
> [...]
> public:
>     virtual GDALDataset* GetSubDatasets();
> [...]
> }
> 
> GDALDataset *FASTDataset::Open( GDALOpenInfo * poOpenInfo )
> {
>     /**
> 
>     IF mtl
>         LOAD main dataset
>         LOAD subdatasets
>         RETURN main dataset
> 
>     **/
> 
>     int i;
> 
>     if(poOpenInfo->nHeaderBytes < 1024)
>         return NULL;
> 
> [...]
> }
> 
> Thanks in advance.
> 
> Regards,
> Daniel.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jlmcgraw at gmail.com  Fri May 16 11:18:22 2014
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Fri, 16 May 2014 14:18:22 -0400
Subject: [gdal-dev] ogr2ogr v1.10.1 and AIXM (issues with curves?)
Message-ID: <CA+XueT3SYJ-zKvOQwVWFjVh0YWj2+cG7iJxqWjx22=LNXh67uA@mail.gmail.com>

GDAL gurus,
 I'm trying to use the AIXM files from the FAA (downloadable here:
https://nfdc.faa.gov/webContent/56DaySub/2014-05-29/aixm5.0.zip ) in QGIS
and I'm noticing that there are some that with no warnings or complaints
just don't produce a polygon. (ogrinfo says "POLYGON EMPTY")

Two examples are "P-56B DISTRICT OF COLUMBIA.xml" and "POINSETT MOA, SC.xml"

Is there some command line incantation that I'm missing?  Or perhaps this
is a feature of GML/AIXM that isn't supported?  I've read that there is
little or no GDAL support for curves/arcs though I'm unclear as to the
current status of that support.

Here's a snippet from the P-56B file:
<horizontalProjection>
 <Surface gml:id="Surface1" srsDimension="2"
srsName="URN:OGC:DEF:CRS:OGC:1.3:CRS84">
  <patches>
   <PolygonPatch>
    <exterior>
     <Ring>
      <curveMember>
       <Curve ns:id="Curve1">
        <segments>
         <CircleByCenterPoint numArc="1">
          <pointProperty>
           <Point ns:id="Point_1">
            <pos>-77.066944 38.921389</pos>
            </Point>
           </pointProperty>
          <radius uom="NM">0.4</radius>
         </CircleByCenterPoint>
        </segments>
       </Curve>
      </curveMember>
     </Ring>
    </exterior>
   </PolygonPatch>
  </patches>
 </Surface>
</horizontalProjection>

If I should be posting this somewhere else or filing a bug report/feature
request please let me know

Thanks!
-Jesse McGraw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/cde34561/attachment-0001.html>

From even.rouault at mines-paris.org  Fri May 16 11:44:52 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 20:44:52 +0200
Subject: [gdal-dev] ogr2ogr v1.10.1 and AIXM (issues with curves?)
In-Reply-To: <CA+XueT3SYJ-zKvOQwVWFjVh0YWj2+cG7iJxqWjx22=LNXh67uA@mail.gmail.com>
References: <CA+XueT3SYJ-zKvOQwVWFjVh0YWj2+cG7iJxqWjx22=LNXh67uA@mail.gmail.com>
Message-ID: <201405162044.52877.even.rouault@mines-paris.org>

Le vendredi 16 mai 2014 20:18:22, Jesse McGraw a ?crit :
> GDAL gurus,
>  I'm trying to use the AIXM files from the FAA (downloadable here:
> https://nfdc.faa.gov/webContent/56DaySub/2014-05-29/aixm5.0.zip ) in QGIS
> and I'm noticing that there are some that with no warnings or complaints
> just don't produce a polygon. (ogrinfo says "POLYGON EMPTY")
> 
> Two examples are "P-56B DISTRICT OF COLUMBIA.xml" and "POINSETT MOA,
> SC.xml"
> 
> Is there some command line incantation that I'm missing? Or perhaps this
> is a feature of GML/AIXM that isn't supported?  I've read that there is
> little or no GDAL support for curves/arcs though I'm unclear as to the
> current status of that support.

CircleByCenterPoint is not currently supported by the GML decoder.
 
> 
> Here's a snippet from the P-56B file:
> <horizontalProjection>
>  <Surface gml:id="Surface1" srsDimension="2"
> srsName="URN:OGC:DEF:CRS:OGC:1.3:CRS84">
>   <patches>
>    <PolygonPatch>
>     <exterior>
>      <Ring>
>       <curveMember>
>        <Curve ns:id="Curve1">
>         <segments>
>          <CircleByCenterPoint numArc="1">
>           <pointProperty>
>            <Point ns:id="Point_1">
>             <pos>-77.066944 38.921389</pos>
>             </Point>
>            </pointProperty>
>           <radius uom="NM">0.4</radius>
>          </CircleByCenterPoint>
>         </segments>
>        </Curve>
>       </curveMember>
>      </Ring>
>     </exterior>
>    </PolygonPatch>
>   </patches>
>  </Surface>
> </horizontalProjection>
> 
> If I should be posting this somewhere else or filing a bug report/feature
> request please let me know

That could be worth one.

> 
> Thanks!
> -Jesse McGraw

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jlmcgraw at gmail.com  Fri May 16 12:21:14 2014
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Fri, 16 May 2014 15:21:14 -0400
Subject: [gdal-dev] ogr2ogr v1.10.1 and AIXM (issues with curves?)
In-Reply-To: <201405162044.52877.even.rouault@mines-paris.org>
References: <CA+XueT3SYJ-zKvOQwVWFjVh0YWj2+cG7iJxqWjx22=LNXh67uA@mail.gmail.com>
	<201405162044.52877.even.rouault@mines-paris.org>
Message-ID: <CA+XueT3PVUg7-RNEhxbgLx9j-K3R5gdGWB2SCrcEnkuZMiiuNQ@mail.gmail.com>

Well, that explains that one.  :)

I'm sure it must be the same story for the other files, various unsupported
GML features.  Is there any way to make ogr2ogr warn when it encounters
something it doesn't support versus silently creating blank geometry?

Out of curiosity, is more robust GML/AIXM support something that's of
general interest?  Is it widely used?




On Fri, May 16, 2014 at 2:44 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le vendredi 16 mai 2014 20:18:22, Jesse McGraw a ?crit :
> > GDAL gurus,
> >  I'm trying to use the AIXM files from the FAA (downloadable here:
> > https://nfdc.faa.gov/webContent/56DaySub/2014-05-29/aixm5.0.zip ) in
> QGIS
> > and I'm noticing that there are some that with no warnings or complaints
> > just don't produce a polygon. (ogrinfo says "POLYGON EMPTY")
> >
> > Two examples are "P-56B DISTRICT OF COLUMBIA.xml" and "POINSETT MOA,
> > SC.xml"
> >
> > Is there some command line incantation that I'm missing? Or perhaps this
> > is a feature of GML/AIXM that isn't supported?  I've read that there is
> > little or no GDAL support for curves/arcs though I'm unclear as to the
> > current status of that support.
>
> CircleByCenterPoint is not currently supported by the GML decoder.
>
> >
> > Here's a snippet from the P-56B file:
> > <horizontalProjection>
> >  <Surface gml:id="Surface1" srsDimension="2"
> > srsName="URN:OGC:DEF:CRS:OGC:1.3:CRS84">
> >   <patches>
> >    <PolygonPatch>
> >     <exterior>
> >      <Ring>
> >       <curveMember>
> >        <Curve ns:id="Curve1">
> >         <segments>
> >          <CircleByCenterPoint numArc="1">
> >           <pointProperty>
> >            <Point ns:id="Point_1">
> >             <pos>-77.066944 38.921389</pos>
> >             </Point>
> >            </pointProperty>
> >           <radius uom="NM">0.4</radius>
> >          </CircleByCenterPoint>
> >         </segments>
> >        </Curve>
> >       </curveMember>
> >      </Ring>
> >     </exterior>
> >    </PolygonPatch>
> >   </patches>
> >  </Surface>
> > </horizontalProjection>
> >
> > If I should be posting this somewhere else or filing a bug report/feature
> > request please let me know
>
> That could be worth one.
>
> >
> > Thanks!
> > -Jesse McGraw
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/fb2cecda/attachment.html>

From even.rouault at mines-paris.org  Fri May 16 12:25:53 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 21:25:53 +0200
Subject: [gdal-dev] ogr2ogr v1.10.1 and AIXM (issues with curves?)
In-Reply-To: <CA+XueT3PVUg7-RNEhxbgLx9j-K3R5gdGWB2SCrcEnkuZMiiuNQ@mail.gmail.com>
References: <CA+XueT3SYJ-zKvOQwVWFjVh0YWj2+cG7iJxqWjx22=LNXh67uA@mail.gmail.com>
	<201405162044.52877.even.rouault@mines-paris.org>
	<CA+XueT3PVUg7-RNEhxbgLx9j-K3R5gdGWB2SCrcEnkuZMiiuNQ@mail.gmail.com>
Message-ID: <201405162125.53678.even.rouault@mines-paris.org>

Le vendredi 16 mai 2014 21:21:14, Jesse McGraw a ?crit :
> Well, that explains that one.  :)
> 
> I'm sure it must be the same story for the other files, various unsupported
> GML features.  Is there any way to make ogr2ogr warn when it encounters
> something it doesn't support versus silently creating blank geometry?

Not currently. That would not be that easy. I guess people would prefer 
investing time in implementing missing stuff than reporting non-implemented 
stuff ;-)

> 
> Out of curiosity, is more robust GML/AIXM support something that's of
> general interest?  Is it widely used?

Full AIXM support would likely need a dedicated driver. The support in the 
genric GML driver might not capture all the structure of AIXM (even if we 
consider that all the GML geometries would be supported)

> 
> 
> 
> 
> On Fri, May 16, 2014 at 2:44 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le vendredi 16 mai 2014 20:18:22, Jesse McGraw a ?crit :
> > > GDAL gurus,
> > > 
> > >  I'm trying to use the AIXM files from the FAA (downloadable here:
> > > https://nfdc.faa.gov/webContent/56DaySub/2014-05-29/aixm5.0.zip ) in
> > 
> > QGIS
> > 
> > > and I'm noticing that there are some that with no warnings or
> > > complaints just don't produce a polygon. (ogrinfo says "POLYGON
> > > EMPTY")
> > > 
> > > Two examples are "P-56B DISTRICT OF COLUMBIA.xml" and "POINSETT MOA,
> > > SC.xml"
> > > 
> > > Is there some command line incantation that I'm missing? Or perhaps
> > > this is a feature of GML/AIXM that isn't supported?  I've read that
> > > there is little or no GDAL support for curves/arcs though I'm unclear
> > > as to the current status of that support.
> > 
> > CircleByCenterPoint is not currently supported by the GML decoder.
> > 
> > > Here's a snippet from the P-56B file:
> > > <horizontalProjection>
> > > 
> > >  <Surface gml:id="Surface1" srsDimension="2"
> > > 
> > > srsName="URN:OGC:DEF:CRS:OGC:1.3:CRS84">
> > > 
> > >   <patches>
> > >   
> > >    <PolygonPatch>
> > >    
> > >     <exterior>
> > >     
> > >      <Ring>
> > >      
> > >       <curveMember>
> > >       
> > >        <Curve ns:id="Curve1">
> > >        
> > >         <segments>
> > >         
> > >          <CircleByCenterPoint numArc="1">
> > >          
> > >           <pointProperty>
> > >           
> > >            <Point ns:id="Point_1">
> > >            
> > >             <pos>-77.066944 38.921389</pos>
> > >             </Point>
> > >            
> > >            </pointProperty>
> > >           
> > >           <radius uom="NM">0.4</radius>
> > >          
> > >          </CircleByCenterPoint>
> > >         
> > >         </segments>
> > >        
> > >        </Curve>
> > >       
> > >       </curveMember>
> > >      
> > >      </Ring>
> > >     
> > >     </exterior>
> > >    
> > >    </PolygonPatch>
> > >   
> > >   </patches>
> > >  
> > >  </Surface>
> > > 
> > > </horizontalProjection>
> > > 
> > > If I should be posting this somewhere else or filing a bug
> > > report/feature request please let me know
> > 
> > That could be worth one.
> > 
> > > Thanks!
> > > -Jesse McGraw
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From danieltesta at suremptec.com.ar  Fri May 16 13:58:42 2014
From: danieltesta at suremptec.com.ar (Daniel Testa)
Date: Fri, 16 May 2014 17:58:42 -0300
Subject: [gdal-dev] new landsat-8 metadata format
In-Reply-To: <201405161956.04718.even.rouault@mines-paris.org>
References: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
	<201405161956.04718.even.rouault@mines-paris.org>
Message-ID: <CAHy2iFd1q-QV_vKj-nzwFvaZG8c_jfzT6Mkta7h+C8RfjdeXZg@mail.gmail.com>

Hi Even,

> There's no real need of a new API for that (although it might be cleaner
to
> have a dedicated one at some point). I'd note that your proposed API would
> only work for a single subdataset, not a vector of them.

Sorry, my bad. Should have been:

GDALDataset** pporSubDatasets;
virtual GDALDataset** GetSubDatasets();

> Anyway, the subdatasets mechanism already exist in many drivers and
should do
> what you need. You can read the "SUBDATASETS domain" section of
> http://www.gdal.org/gdal_datamodel.html and have a look at the code of the
> mentionned drivers to see how they do that.

I've read the "SUBDATASETS domain" section and took a look at the HDF5
format, in particular, but I don't think that that would work for me. Maybe
I'm not looking at the right place though.

The scenario:
LC82300942013289LGN00_B1.tif
LC82300942013289LGN00_B2.tif
LC82300942013289LGN00_B3.tif
LC82300942013289LGN00_B4.tif
LC82300942013289LGN00_B5.tif
LC82300942013289LGN00_B6.tif
LC82300942013289LGN00_B7.tif
LC82300942013289LGN00_B8.tif
LC82300942013289LGN00_B9.tif
LC82300942013289LGN00_B10.tif
LC82300942013289LGN00_B11.tif
LC82300942013289LGN00_BQA.tif
LC82300942013289LGN00_MTL.txt

I'd like to open LC82300942013289LGN00_MTL.txt and get 4 datasets:
Dataset 1:
LC82300942013289LGN00_B1.tif
LC82300942013289LGN00_B2.tif
LC82300942013289LGN00_B3.tif
LC82300942013289LGN00_B4.tif
LC82300942013289LGN00_B5.tif
LC82300942013289LGN00_B6.tif
LC82300942013289LGN00_B7.tif
LC82300942013289LGN00_B9.tif

Dataset 2:
LC82300942013289LGN00_B8.tif

Dataset 3:
LC82300942013289LGN00_B10.tif
LC82300942013289LGN00_B11.tif

Dataset 4:
LC82300942013289LGN00_BQA.tif

Maybe GetSubDatasets is not the most appropiate name for this purpose (I
thought about that, but at that moment I couldn't think of a better name).
Maybe GetAssociatedDatasets would be better.

Using it:

GDALDataset* poDataset = (GDALDataset *)GDALOpen(...);
poDataset->GetRasterBand(...); // would return a band from those in Dataset
1 above.

GDALDataset** pporAssocDatasets = poDataset->GetAssociatedDatasets();
pporAssocDatasets[0]->GetRasterBand(...); // would return a band from those
in Dataset 2 above.

pporAssocDatasets[1]->GetRasterBand(...); // would retun a band from those
in Dataset 3 above.

pporAssocDatasets[2]->GetRasterBand(...); // would return a band from those
in Dataset 4 above.


> Another question I have is : how close or far would be Landsat8 support
 from
> the existing code of the FAST driver. I see that FAST relies on "raw"
bands,
> whereas you mention .tif for Landsat 8 + the change of metadata format.
So it
> might be more appropriate to have a new driver if technically there is
little
> common points between the drivers.

Yes, it might be better to add a new driver.


Hope this will give you a better idea of what I'd like to accomplish.

Thanks.



On Fri, May 16, 2014 at 2:56 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Daniel,
>
> There's no real need of a new API for that (although it might be cleaner to
> have a dedicated one at some point). I'd note that your proposed API would
> only work for a single subdataset, not a vector of them.
>
> Anyway, the subdatasets mechanism already exist in many drivers and should
> do
> what you need. You can read the "SUBDATASETS domain" section of
> http://www.gdal.org/gdal_datamodel.html and have a look at the code of the
> mentionned drivers to see how they do that.
>
> Another question I have is : how close or far would be Landsat8 support
>  from
> the existing code of the FAST driver. I see that FAST relies on "raw"
> bands,
> whereas you mention .tif for Landsat 8 + the change of metadata format. So
> it
> might be more appropriate to have a new driver if technically there is
> little
> common points between the drivers.
>
> Best regards,
>
> Even
>
> > Hi, I'm writing to you because I need support for the new Landsat-8
> > metadata format (_MTL.txt file)
> >
> > I took a look at the latest version, 1.11.0, and I couldn't find anything
> > on the matter. So, I was thinking I could add support for the new format
> by
> > myself.
> >
> > There are 3 groups of bands: panchromatic, multispectral and thermal. One
> > .tif file for each band and then the MTL file with all the info. I'd like
> > to open the MTL file, using GDAL, and have access to all of them. So,
> what
> > I was thinking was that I could add a public method (virtual) to the
> > GDALDataset class, lets say GetSubDatasets, that would allow a dataset to
> > return associated subdatasets. Then, in the FASTDataset class, if I
> detect
> > that I'm trying to open a MTL file, I could make the FASTDataset::Open
> > method return a Dataset (as it does now) containing only the
> multispectral
> > bands and then with the overridden GetSubDatasets method I could get a
> > vector with the other 2 datasets: one with the panchromatic band and
> > another one with the thermal bands.
> >
> > What do you think?
> >
> > Any idea, suggestion or comment is very welcome :)
> >
> > Sample:
> >
> > class CPL_DLL GDALDataset : public GDALMajorObject
> > {
> > [...]
> > public:
> >     virtual GDALDataset* GetSubDatasets() { return NULL; }
> > [...]
> > }
> >
> > class FASTDataset : public GDALPamDataset
> > {
> > [...]
> > private:
> >     GDALDataset* porSubDatasets;
> > [...]
> > public:
> >     virtual GDALDataset* GetSubDatasets();
> > [...]
> > }
> >
> > GDALDataset *FASTDataset::Open( GDALOpenInfo * poOpenInfo )
> > {
> >     /**
> >
> >     IF mtl
> >         LOAD main dataset
> >         LOAD subdatasets
> >         RETURN main dataset
> >
> >     **/
> >
> >     int i;
> >
> >     if(poOpenInfo->nHeaderBytes < 1024)
> >         return NULL;
> >
> > [...]
> > }
> >
> > Thanks in advance.
> >
> > Regards,
> > Daniel.
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140516/28db3e5c/attachment-0001.html>

From even.rouault at mines-paris.org  Fri May 16 14:11:39 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 16 May 2014 23:11:39 +0200
Subject: [gdal-dev] new landsat-8 metadata format
In-Reply-To: <CAHy2iFd1q-QV_vKj-nzwFvaZG8c_jfzT6Mkta7h+C8RfjdeXZg@mail.gmail.com>
References: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
	<201405161956.04718.even.rouault@mines-paris.org>
	<CAHy2iFd1q-QV_vKj-nzwFvaZG8c_jfzT6Mkta7h+C8RfjdeXZg@mail.gmail.com>
Message-ID: <201405162311.39686.even.rouault@mines-paris.org>

> 
> I've read the "SUBDATASETS domain" section and took a look at the HDF5
> format, in particular, but I don't think that that would work for me. 

I think that should work.

> Maybe
> I'm not looking at the right place though.
> 
> The scenario:
> LC82300942013289LGN00_B1.tif
> LC82300942013289LGN00_B2.tif
> LC82300942013289LGN00_B3.tif
> LC82300942013289LGN00_B4.tif
> LC82300942013289LGN00_B5.tif
> LC82300942013289LGN00_B6.tif
> LC82300942013289LGN00_B7.tif
> LC82300942013289LGN00_B8.tif
> LC82300942013289LGN00_B9.tif
> LC82300942013289LGN00_B10.tif
> LC82300942013289LGN00_B11.tif
> LC82300942013289LGN00_BQA.tif
> LC82300942013289LGN00_MTL.txt
> 
> I'd like to open LC82300942013289LGN00_MTL.txt and get 4 datasets:
> Dataset 1:
> LC82300942013289LGN00_B1.tif
> LC82300942013289LGN00_B2.tif
> LC82300942013289LGN00_B3.tif
> LC82300942013289LGN00_B4.tif
> LC82300942013289LGN00_B5.tif
> LC82300942013289LGN00_B6.tif
> LC82300942013289LGN00_B7.tif
> LC82300942013289LGN00_B9.tif
> 
> Dataset 2:
> LC82300942013289LGN00_B8.tif
> 
> Dataset 3:
> LC82300942013289LGN00_B10.tif
> LC82300942013289LGN00_B11.tif
> 
> Dataset 4:
> LC82300942013289LGN00_BQA.tif
> 
> Maybe GetSubDatasets is not the most appropiate name for this purpose (I
> thought about that, but at that moment I couldn't think of a better name).
> Maybe GetAssociatedDatasets would be better.
> 
> Using it:
> 
> GDALDataset* poDataset = (GDALDataset *)GDALOpen(...);
> poDataset->GetRasterBand(...); // would return a band from those in Dataset
> 1 above.

You could have the dataset report subdataset names, like 
"LANDSAT8:LC82300942013289LGN00_MTL.txt:panchromatic", 
"LANDSAT8:LC82300942013289LGN00_MTL.txt:multispectral", etc... And when those 
names are passed to the Open() methods would return a dataset that would point 
to the relevant tif.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From danieltesta at suremptec.com.ar  Sat May 17 07:06:35 2014
From: danieltesta at suremptec.com.ar (Daniel Testa)
Date: Sat, 17 May 2014 11:06:35 -0300
Subject: [gdal-dev] new landsat-8 metadata format
In-Reply-To: <201405162311.39686.even.rouault@mines-paris.org>
References: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
	<201405161956.04718.even.rouault@mines-paris.org>
	<CAHy2iFd1q-QV_vKj-nzwFvaZG8c_jfzT6Mkta7h+C8RfjdeXZg@mail.gmail.com>
	<201405162311.39686.even.rouault@mines-paris.org>
Message-ID: <CAHy2iFcGj3a78JQ3Wo9E-+D-x4xWvOVVTxPQ+ZnBq6rK2SmvMA@mail.gmail.com>

> You could have the dataset report subdataset names, like
> "LANDSAT8:LC82300942013289LGN00_MTL.txt:panchromatic",
> "LANDSAT8:LC82300942013289LGN00_MTL.txt:multispectral", etc... And when
those
> names are passed to the Open() methods would return a dataset that would
point
> to the relevant tif.

I see what you mean. I'll try following that path and let you know how it
goes.

Thanks Even.

Best regards,
Daniel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140517/826bf3ea/attachment.html>

From szekerest at gmail.com  Sat May 17 15:02:21 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sun, 18 May 2014 00:02:21 +0200
Subject: [gdal-dev] OGR 1.11 upgrade -> Geometry gone after
 layer.SetFeature() (MSSQL)
In-Reply-To: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
References: <CABjvV9Faa_ghE3i248-ATP+5fJmGOxe6-ZdooO-+B5AMLgzAag@mail.gmail.com>
Message-ID: <CACALY+RcijFGjomit3HQmww1=c2A-enLLR1nji01isKhWGOjhA@mail.gmail.com>

I've experienced the same issue and will provide the fix shortly.
Added a ticket for the record: http://trac.osgeo.org/gdal/ticket/5474

Tamas


2014-05-15 12:45 GMT+02:00 Niels Kj?ller Hansen <niels.k.h at gmail.com>:

> Hello all
>
> I have been running a python script daily, which takes a table from a
> MSSQL database, identifies which fields are strings, and does some
> character set fixing (utf8 to latin1)
>
> The trouble is, that after an upgrade to GDAL/OGR 1.11, the table ends
> up with an empty geometry column. When I try to run through the script
> in the python terminal, a call to 'feature.GetGeomFieldCount()'
> returns 0
>
> And this is before doing something to the feature. It is my guess that
> the feature doesn't get the geometry, and when I write it (using
> layer.SetFeature(feature)), It empties the column.
>
> Am I doing something wrong? The entire script is here:
> http://osgeo.codepad.org/Yn5xAdE6 (mostly, comments are in Danish,
> sorry about that)
>
> Other ways of succesfully importing utf8 sources (gml) in to a
> MSSQL-database (latin1) is also greatly appreciated, although I would
> still like to be able to do string manipulation in the database :)
>
> Regards,
> Niels
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140518/bcd5b127/attachment.html>

From jan.heckman at gmail.com  Sat May 17 15:53:23 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Sun, 18 May 2014 00:53:23 +0200
Subject: [gdal-dev] Difficulty finding all parts of shapefile polygon
 using Python and osgeo/ogr
In-Reply-To: <CAOggSvaWP8KK5QYBSTYm2u57f4neNPRN67HQvWUiJfRMR6c3KA@mail.gmail.com>
References: <CAOggSvaWP8KK5QYBSTYm2u57f4neNPRN67HQvWUiJfRMR6c3KA@mail.gmail.com>
Message-ID: <CAKMUAtBctCrWYPZpHnmSLTPQHYF+Z38W4OPVs1GKJLxsgVPe-Q@mail.gmail.com>

Hello Bruce,
The point is that the geometrycount identifies two polygons, one a small
little piece sort of inside a bay of your shape, the other the rest, along
with the holes.
See ogr_apitutorial <http://www.gdal.org/ogr/ogr_apitut.html> - all
assuming you are using 1.11: *Starting with OGR 1.11, several geometry
fields <http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields>** can
be associated to a feature*.
The little hidden piece starts at (approx) 467767;3900845. It happens to be
the first part of the shape.
The example code in the link above should put you closer to all this;
however, retrieving the polygon(part)s will take a bit more digging..
Good luck,
Jan


On Thu, May 15, 2014 at 6:13 PM, Bruce Raup <bruceraup at gmail.com> wrote:

> Hello,
>
> I have a Python script that reads a shapefile, converts holes in polygons
> to top-level polygons, and writes a new polygon.  The new top-level
> polygons inherit attributes from their parents, with optional modifications
> of specific attributes.  For a simple test shapefile, the output of shpdump
> shows what I mean:
>
> $ shpdump simple_shapes_with_holes.shp
> Shapefile Type: Polygon   # of Shapes: 3
>
> File Bounds: (      -1.113,       0.146,0,0)
>          to  (       0.751,       1.101,0,0)
>
> Shape:0 (Polygon)  nVertices=11, nParts=2
>   Bounds:(      -1.113,       0.146, 0, 0)
>       to (      -0.493,       0.723, 0, 0)
>      (      -1.087,       0.151, 0, 0) Ring
>      (      -1.113,       0.686, 0, 0)
>      (      -1.109,       0.712, 0, 0)
>      (      -0.506,       0.723, 0, 0)
>      (      -0.493,       0.146, 0, 0)
>      (      -1.087,       0.151, 0, 0)
>    + (      -0.896,       0.346, 0, 0) Ring
>      (      -0.682,       0.339, 0, 0)
>      (      -0.684,       0.556, 0, 0)
>      (      -0.909,       0.558, 0, 0)
>      (      -0.896,       0.346, 0, 0)
>
> Shape:1 (Polygon)  nVertices=19, nParts=4
>   Bounds:(      -0.127,       0.159, 0, 0)
>       to (       0.751,       0.783, 0, 0)
>      (       0.402,       0.783, 0, 0) Ring
>      (       0.751,       0.159, 0, 0)
>      (      -0.127,       0.198, 0, 0)
>      (       0.402,       0.783, 0, 0)
>    + (       0.298,       0.539, 0, 0) Ring
>      (       0.417,       0.523, 0, 0)
>      (       0.426,       0.612, 0, 0)
>      (       0.339,       0.625, 0, 0)
>      (       0.298,       0.539, 0, 0)
>    + (       0.083,       0.263, 0, 0) Ring
>      (       0.248,       0.252, 0, 0)
>      (       0.213,       0.396, 0, 0)
>      (       0.107,       0.367, 0, 0)
>      (       0.083,       0.263, 0, 0)
>    + (       0.361,       0.281, 0, 0) Ring
>      (       0.530,       0.265, 0, 0)
>      (       0.435,       0.413, 0, 0)
>      (       0.330,       0.435, 0, 0)
>      (       0.361,       0.281, 0, 0)
>
> Shape:2 (Polygon)  nVertices=6, nParts=1
>   Bounds:(      -0.389,       0.681, 0, 0)
>       to (       0.141,       1.101, 0, 0)
>      (      -0.383,       1.005, 0, 0) Ring
>      (      -0.136,       1.101, 0, 0)
>      (       0.141,       0.964, 0, 0)
>      (      -0.154,       0.681, 0, 0)
>      (      -0.389,       0.809, 0, 0)
>      (      -0.383,       1.005, 0, 0)
>
>
>
>
> $ shpdump simple_shapes_with_holes_flattened.shp
> Shapefile Type: Polygon   # of Shapes: 7
>
> File Bounds: (      -1.113,       0.146,0,0)
>          to  (       0.751,       1.101,0,0)
>
> Shape:0 (Polygon)  nVertices=6, nParts=1
>   Bounds:(      -1.113,       0.146, 0, 0)
>       to (      -0.493,       0.723, 0, 0)
>      (      -1.087,       0.151, 0, 0) Ring
>      (      -1.113,       0.686, 0, 0)
>      (      -1.109,       0.712, 0, 0)
>      (      -0.506,       0.723, 0, 0)
>      (      -0.493,       0.146, 0, 0)
>      (      -1.087,       0.151, 0, 0)
>
> Shape:1 (Polygon)  nVertices=5, nParts=1
>   Bounds:(      -0.909,       0.339, 0, 0)
>       to (      -0.682,       0.558, 0, 0)
>      (      -0.896,       0.346, 0, 0) Ring
>      (      -0.909,       0.558, 0, 0)
>      (      -0.684,       0.556, 0, 0)
>      (      -0.682,       0.339, 0, 0)
>      (      -0.896,       0.346, 0, 0)
>
> Shape:2 (Polygon)  nVertices=4, nParts=1
>   Bounds:(      -0.127,       0.159, 0, 0)
>       to (       0.751,       0.783, 0, 0)
>      (       0.402,       0.783, 0, 0) Ring
>      (       0.751,       0.159, 0, 0)
>      (      -0.127,       0.198, 0, 0)
>      (       0.402,       0.783, 0, 0)
>
> Shape:3 (Polygon)  nVertices=5, nParts=1
>   Bounds:(       0.298,       0.523, 0, 0)
>       to (       0.426,       0.625, 0, 0)
>      (       0.298,       0.539, 0, 0) Ring
>      (       0.339,       0.625, 0, 0)
>      (       0.426,       0.612, 0, 0)
>      (       0.417,       0.523, 0, 0)
>      (       0.298,       0.539, 0, 0)
>
> Shape:4 (Polygon)  nVertices=5, nParts=1
>   Bounds:(       0.083,       0.252, 0, 0)
>       to (       0.248,       0.396, 0, 0)
>      (       0.083,       0.263, 0, 0) Ring
>      (       0.107,       0.367, 0, 0)
>      (       0.213,       0.396, 0, 0)
>      (       0.248,       0.252, 0, 0)
>      (       0.083,       0.263, 0, 0)
>
> Shape:5 (Polygon)  nVertices=5, nParts=1
>   Bounds:(       0.330,       0.265, 0, 0)
>       to (       0.530,       0.435, 0, 0)
>      (       0.361,       0.281, 0, 0) Ring
>      (       0.330,       0.435, 0, 0)
>      (       0.435,       0.413, 0, 0)
>      (       0.530,       0.265, 0, 0)
>      (       0.361,       0.281, 0, 0)
>
> Shape:6 (Polygon)  nVertices=6, nParts=1
>   Bounds:(      -0.389,       0.681, 0, 0)
>       to (       0.141,       1.101, 0, 0)
>      (      -0.383,       1.005, 0, 0) Ring
>      (      -0.136,       1.101, 0, 0)
>      (       0.141,       0.964, 0, 0)
>      (      -0.154,       0.681, 0, 0)
>      (      -0.389,       0.809, 0, 0)
>      (      -0.383,       1.005, 0, 0)
>
>
> I have a shapefile for which this doesn't work, however, and I suspect
> it's perhaps a difference in the way the inner rings are represented.  In
> this real shapefile, the top part of the output from shpdump looks like
>
>
> Shapefile Type: Polygon   # of Shapes: 1
>
> File Bounds: (  462611.523, 3894164.223,0,0)
>          to  (  470338.347, 3901974.217,0,0)
>
> Shape:0 (Polygon)  nVertices=1575, nParts=14
>   Bounds:(  462611.523, 3894164.223, 0, 0)
>       to (  470338.347, 3901974.217, 0, 0)
>      (  467768.987, 3900844.546, 0, 0) Ring
>      (  467744.058, 3900868.748, 0, 0)
>      (  467702.110, 3900879.841, 0, 0)
>      (  467670.108, 3900921.799, 0, 0)
>      (  467632.530, 3900960.784, 0, 0)
>      (  467689.198, 3900957.167, 0, 0)
>      (  467751.895, 3900922.201, 0, 0)
>      (  467785.655, 3900861.426, 0, 0)
>      (  467768.987, 3900844.546, 0, 0)
>    + (  467774.970, 3900834.757, 0, 0) Ring
>      (  467796.445, 3900858.379, 0, 0)
>      (  467850.763, 3900846.242, 0, 0)
>      (  467900.197, 3900841.419, 0, 0)
>      (  467927.928, 3900814.893, 0, 0)
>      (  467936.368, 3900767.871, 0, 0)
> .
> .
> .
>
> But my python code doesn't see all the parts.
>
>
> $ python
> Python 2.7 (r27:82500, Aug 07 2010, 16:54:59) [GCC] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
> >>> from osgeo import ogr
> >>> sf = ogr.Open('segments.shp')
> >>> sl = sf.GetLayer(0)
> >>> sl
> <osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
> 0xb7472980> >
> >>> feat = sl[0]
> >>> feat
> <osgeo.ogr.Feature; proxy of <Swig Object of type 'OGRFeatureShadow *' at
> 0xb7472620> >
> >>> sg = feat.GetGeometryRef()
> >>> sg
> <osgeo.ogr.Geometry; proxy of <Swig Object of type 'OGRGeometryShadow *'
> at 0xb749e770> >
> >>> sg.GetGeometryCount()
> 2
> >>>
>
>
> I would expect the output of sg.GetGeometryCount() to be 15.  Am I doing
> something wrong?
>
> The complete script is at
>
> http://cires.colorado.edu/~braup/OGR/flatten_shapefile.py
>
> The testfile is at
>
> http://cires.colorado.edu/~braup/OGR/simple_shapes_with_holes.zip
>
> The "real" testfile on which the script fails is at:
>
> http://cires.colorado.edu/~braup/OGR/nanga_segments.zip
>
> Any pointers would be greatly appreciated.
>
> Cheers,
> Bruce Raup
>
> --
> Bruce Raup
> http://cires.colorado.edu/~braup/
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140518/75f16837/attachment-0001.html>

From sfkeller at gmail.com  Sun May 18 06:29:12 2014
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 18 May 2014 15:29:12 +0200
Subject: [gdal-dev] Revival of "OGR Layer Converter" plugin?
Message-ID: <CAFcOn29DXhJmD08fp7muJ7tiuUBsHH65n3-E5Zy0z-4UiE9t2Q@mail.gmail.com>

Hi Mateusz, hi all

Four years ago you submitted the "OGR Layer Converter" plugin to QGIS trunk
(http://hub.qgis.org/issues/1249 ). Since then OGR became part of the usual
"Open Vector Layer..." dialog.
But this "open..." dialog includes no parameter ogr2ogr would have -
neither source nor target creation layer options.
What do you think of a revival of the plugin which would give control to an
advanced user over those options?

-Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140518/12c7a9e6/attachment.html>

From sfkeller at gmail.com  Sun May 18 07:01:26 2014
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 18 May 2014 16:01:26 +0200
Subject: [gdal-dev] [Qgis-developer] Revival of "OGR Layer Converter"
	plugin?
In-Reply-To: <CAAi8Yg-f7Ra+OOXTOrtV=X_3--60JorHDsLGSktsMO8veBLvdQ@mail.gmail.com>
References: <CAFcOn29DXhJmD08fp7muJ7tiuUBsHH65n3-E5Zy0z-4UiE9t2Q@mail.gmail.com>
	<CAAi8Yg-f7Ra+OOXTOrtV=X_3--60JorHDsLGSktsMO8veBLvdQ@mail.gmail.com>
Message-ID: <CAFcOn2-2RsTx06AatD+eig_tZ8onuY6+_vp6eM1y6fyvqFY1ZA@mail.gmail.com>

Almost... :-)
I meant beingable to add source options like (like -clipsrc, -nln and
-sql) within the OGR based "Add Vector Layer..." dialog:
http://imgur.com/tcLJUHg

- Stefan


2014-05-18 15:32 GMT+02:00 Nathan Woodrow <madmanwoo at gmail.com>:

> Stefan,
>
> Are these the options you mean?
>
> http://i.imgur.com/DW7tYEF.png
>
> - Nathan
>
>
> On Sun, May 18, 2014 at 11:29 PM, Stefan Keller <sfkeller at gmail.com>wrote:
>
>> Hi Mateusz, hi all
>>
>> Four years ago you submitted the "OGR Layer Converter" plugin to QGIS
>> trunk (http://hub.qgis.org/issues/1249 ). Since then OGR became part of
>> the usual "Open Vector Layer..." dialog.
>> But this "open..." dialog includes no parameter ogr2ogr would have -
>> neither source nor target creation layer options.
>> What do you think of a revival of the plugin which would give control
>> to an advanced user over those options?
>>
>> -Stefan
>>
>>
>> _______________________________________________
>> Qgis-developer mailing list
>> Qgis-developer at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/qgis-developer
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140518/7e7bf85c/attachment.html>

From kalu671 at gmail.com  Sun May 18 08:55:49 2014
From: kalu671 at gmail.com (kalu671)
Date: Sun, 18 May 2014 08:55:49 -0700 (PDT)
Subject: [gdal-dev] Raster Color map in python
Message-ID: <1400428549224-5141027.post@n6.nabble.com>

I have a reference raster map and list of other rasters. I want to get color
table from reference map and set to the list using python. I can read other
parameters from raster but some how I can not get the color table
(GetRasterColorTable())from the source file, let alone setting the table
(SetRasterColorTable())to the list. I am pasting some code lines here. Could
someone help me figuring this out? or suggesting another easy solution?

There is another similar thread but that is related to C#. I tried to follow
that in python but didn't help.

SourceFile = "source.tif"
targetFile = "target.tif"

rastDriver    = gdal.GetDriverByName('gtiff')
rastDriver.Register()

inSourceFile   = gdal.Open(SourceFile)
inTargetFile   = gdal.Open(targetFile)

## reading parameters of source file
col 		= inSourceFile.RasterXSize
row		= inSourceFile.RasterYSize
bands	 	= inSourceFile.RasterCount
ct	        = inSourceFile.GetRasterColorTable() # the code stops working
from this line if I comment out        this line the code goes through
GeoT 		= inSourceFile.GetGeoTransform()
proj 		= inSourceFile.GetProjection()


Thank you in Advance for your help






--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Raster-Color-map-in-python-tp5141027.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mikejohnryan08 at gmail.com  Sun May 18 12:41:24 2014
From: mikejohnryan08 at gmail.com (mikejohnryan08)
Date: Sun, 18 May 2014 12:41:24 -0700 (PDT)
Subject: [gdal-dev] Clip Raster Image Pair by Overlapping Area
Message-ID: <1400442084328-5141034.post@n6.nabble.com>

Hello,

I have a whole set of aerial images which I am trying to clip by their
overlapping areas, for use in a more involved program I am writing with PIL. 
I'm completely new to using the GDAL library but understand this would be a
sufficient tool for doing this; however, I'm not sure where to begin.

What would be the best method to use the python OSgeo and GDAL libraries to
extract the overlapping area from a pair of images?  They also come with a
footprint vector file which could be used to clip them, but this may become
too involved.

I could easily do this manually with a GIS program, but I need to execute
this through Python as it will be part of a batch processing script.  Any
ideas/advice would be great!  Thanks so much in advance.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Clip-Raster-Image-Pair-by-Overlapping-Area-tp5141034.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Sun May 18 13:03:06 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Sun, 18 May 2014 22:03:06 +0200
Subject: [gdal-dev] Revival of "OGR Layer Converter" plugin?
In-Reply-To: <CAFcOn29DXhJmD08fp7muJ7tiuUBsHH65n3-E5Zy0z-4UiE9t2Q@mail.gmail.com>
References: <CAFcOn29DXhJmD08fp7muJ7tiuUBsHH65n3-E5Zy0z-4UiE9t2Q@mail.gmail.com>
Message-ID: <CABUeae90TPYNeG-waMy3METgXjUAR3KyYtGOgKz8cXsmjcAkAA@mail.gmail.com>

On 18 May 2014 15:29, Stefan Keller <sfkeller at gmail.com> wrote:
> Hi Mateusz, hi all
>
> Four years ago you submitted the "OGR Layer Converter" plugin to QGIS trunk
> (http://hub.qgis.org/issues/1249 ). Since then OGR became part of the usual
> "Open Vector Layer..." dialog.
> But this "open..." dialog includes no parameter ogr2ogr would have - neither
> source nor target creation layer options.
> What do you think of a revival of the plugin which would give control to an
> advanced user over those options?

Hi Stefan,

I thought that plugin has got a new maintainer or has died.
I haven't been working on it and I'm afraid I'm not able to help.
If you'd be interested in taking it over, you are welcome to do it.

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From pierre.mauduit at camptocamp.com  Mon May 19 07:27:33 2014
From: pierre.mauduit at camptocamp.com (Pierre Mauduit)
Date: Mon, 19 May 2014 16:27:33 +0200
Subject: [gdal-dev] [OGR] Questions about the MIF/MID format implementation
Message-ID: <CAHTJp2QWASUBCXbvpEv8d6Q1OJBrALxrJWj7+_RyyK4tMKVBZQ@mail.gmail.com>

Hi list,

We are currently using GDAL/OGR bindings for Java, and we stumbled upon a
bug using MIF/MID (where the same code achieves generating TAB with no
problem at all). While debugging, we reached the following (GeoTools)
code[1]:

 if (!driverName.equalsIgnoreCase("georss") &&
                !driverName.equalsIgnoreCase("gpx") &&
                !driverName.equalsIgnoreCase("sosi") &&
                !ogr.LayerCanCreateField(layer)) {
                throw new DataSourceException(
                        "OGR reports it's not possible to create fields on
this layer");
            }

By digging into the MIF/MID and tab code "OGR-side", I discovered that the
TestCapability method between the two formats is not returning exactly the
same capabilities. I thought both were very close to each other, so is the
CreateField capability not supported at MIF/MID side, or is it just a
missing test ?

I tried to recompile a own version of GDAL/OGR returning true for
CreateField TestCapability in the MIF/MID code, and I was able to correctly
generate the expected mif file from my application, but I might be wrong in
the approach, being pretty new to gdal codebase and not a C++ guru.

Secondly, by reading the code, I found out a weird test[2]: is line #2258
ever triggered ?

Thanks in advance for the answers and regards,

[1]
https://github.com/geotools/geotools/blob/master/modules/plugin/ogr/ogr-core/src/main/java/org/geotools/data/ogr/OGRDataStore.java#L194-L198

[2]
https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_miffile.cpp#L2255-L2259


<https://github.com/geotools/geotools/blob/master/modules/plugin/ogr/ogr-core/src/main/java/org/geotools/data/ogr/OGRDataStore.java#L194-L198>
-- 

Pierre Mauduit

Ing?nieur d?veloppement

Camptocamp France SAS

Savoie Technolac, BP 352

73377 Le Bourget du Lac, Cedex

Tel (France) : +33 4 79 26 58 02

Fax : 04 79 70 15 81

Mail : pierre.mauduit at camptocamp.com <yves.jacolin at camptocamp.com>

http://www.camptocamp.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/dff0fe99/attachment.html>

From guillaume.pasero at c-s.fr  Mon May 19 09:04:38 2014
From: guillaume.pasero at c-s.fr (Guillaume Pasero)
Date: Mon, 19 May 2014 18:04:38 +0200
Subject: [gdal-dev] OpenJPEG driver
Message-ID: <537A2B96.7030809@c-s.fr>

Hi everybody,

I am using the OpenJPEG driver from GDAL and I noticed some differences 
with the behaviour of an other OpenJPEG "driver" that I used before in 
the library Orfeo ToolBox. The GDAL driver fails to pass a conformance 
test : using the input file "jpeg2000_conf_p1_06.j2k" , reading the 
resolution level 4 (zero being the original image) , it should produce a 
1x1 image with the pixel value [195, 36, 100].

The behaviour of GDAL drivers differs on the following points :

  * The number of overviews detected for a jpeg2000 dataset is limited
    (no overview if its dimensions are both lower than 256). Even if the
    the overviews can be computed by GDAL, it won't use the wavelet
    coefficients for the highest levels, but rather perform the default
    nearest neighbor interpolation.
  * The size of the overview at level 'n' is computed as : ovr_size =
    raster_size / 2^n , whereas it should be ovr_size = ceil(
    raster_size / float(2^n) )


I am using GDAL 1.10.1 and OpenJpeg 2.0.
Is it relevant to report a bug on this topic ?

Best Regards,
Guillaume

-- 
<www.c-s.fr> 	*Guillaume PASERO*
Ing?nieur d'?tudes et d?veloppement
*Business Unit E-SPACE & Geo Information* 
<https://thor.si.c-s.fr/blogs/cs-blogs-business/>*- D?partement 
APPLICATIONS*

*CS Syst?mes d'Information*
Parc de la Grande Plaine - 5, Rue Brindejonc des Moulinais - BP 15872
31506 Toulouse Cedex 05 - FRANCE
+33 561 17 64 21 - guillaume.pasero at c-s.fr

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/d53e0733/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logo_cs.png
Type: image/png
Size: 19066 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/d53e0733/attachment-0001.png>

From kyle at pobox.com  Mon May 19 09:06:22 2014
From: kyle at pobox.com (Kyle Shannon)
Date: Mon, 19 May 2014 10:06:22 -0600
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405080013.23209.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
Message-ID: <CAJ0mEz1x=db=0G6XJrtBV+uQXagSA=H2qouRER9Pf-yxLusqKA@mail.gmail.com>

Even,

On Wed, May 7, 2014 at 4:13 PM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Hi,
>
> This is a call for discussion on "RFC 46: GDAL/OGR unification"
>
>   http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

It looks good to me, and surprisingly few changes for users (I think).
 Thanks for the work.

kss

-- 
Kyle

From vincent.mora at oslandia.com  Mon May 19 11:00:54 2014
From: vincent.mora at oslandia.com (Vincent Mora)
Date: Mon, 19 May 2014 20:00:54 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405152047.32942.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405152047.32942.even.rouault@mines-paris.org>
Message-ID: <537A46D6.7070609@oslandia.com>

On 15/05/2014 20:47, Even Rouault wrote:
> Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
>> Hi,
>>
>> This is a call for discussion on "RFC 46: GDAL/OGR unification"
>>
>>    http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>>
> No reaction : no interest or no time to review yet ?
> Or should I move that forward ?
> But I'd prefer if such architectural changes could be a bit reviewed...
I did read the proposal, but no relevant comment came to mind.
>> Best regards,
>>
>> Even

From even.rouault at mines-paris.org  Mon May 19 11:01:47 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 20:01:47 +0200
Subject: [gdal-dev] OpenJPEG driver
In-Reply-To: <537A2B96.7030809@c-s.fr>
References: <537A2B96.7030809@c-s.fr>
Message-ID: <201405192001.48688.even.rouault@mines-paris.org>

Guillaume,

> 
> I am using the OpenJPEG driver from GDAL and I noticed some differences
> with the behaviour of an other OpenJPEG "driver" that I used before in
> the library Orfeo ToolBox. The GDAL driver fails to pass a conformance
> test : using the input file "jpeg2000_conf_p1_06.j2k" 

Are you refering to 
http://code.google.com/p/openjpeg/source/browse/data/input/conformance/p1_06.j2k 
? I see this is a 12 x 12 pixel image ...

> , reading the
> resolution level 4 (zero being the original image) , it should produce a
> 1x1 image with the pixel value [195, 36, 100].
> 
> The behaviour of GDAL drivers differs on the following points :
> 
>   * The number of overviews detected for a jpeg2000 dataset is limited
>     (no overview if its dimensions are both lower than 256). Even if the
>     the overviews can be computed by GDAL, it won't use the wavelet
>     coefficients for the highest levels, but rather perform the default
>     nearest neighbor interpolation.

Yes, this is to avoid exposing overviews that are too small and do not make 
pratical sense. Other JPEG2000 drivers, such as JP2KAK or JP2ECW, have similar 
logic.

>   * The size of the overview at level 'n' is computed as : ovr_size =
>     raster_size / 2^n , whereas it should be ovr_size = ceil(
>     raster_size / float(2^n) )
> 

Hum, any reason to particularly round to the upper value rather than the lower 
value ? The JP2ECW driver does the rounding to the lower value too.

> 
> I am using GDAL 1.10.1 and OpenJpeg 2.0.
> Is it relevant to report a bug on this topic ?

IMHO the test case seems to be a bit too artificial to justify any change, 
unless there are real world cases where that would cause issues.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon May 19 11:09:12 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 20:09:12 +0200
Subject: [gdal-dev] [OGR] Questions about the MIF/MID format
	implementation
In-Reply-To: <CAHTJp2QWASUBCXbvpEv8d6Q1OJBrALxrJWj7+_RyyK4tMKVBZQ@mail.gmail.com>
References: <CAHTJp2QWASUBCXbvpEv8d6Q1OJBrALxrJWj7+_RyyK4tMKVBZQ@mail.gmail.com>
Message-ID: <201405192009.12709.even.rouault@mines-paris.org>

Le lundi 19 mai 2014 16:27:33, Pierre Mauduit a ?crit :
> Hi list,
> 
> We are currently using GDAL/OGR bindings for Java, and we stumbled upon a
> bug using MIF/MID (where the same code achieves generating TAB with no
> problem at all). While debugging, we reached the following (GeoTools)
> code[1]:
> 
>  if (!driverName.equalsIgnoreCase("georss") &&
>                 !driverName.equalsIgnoreCase("gpx") &&
>                 !driverName.equalsIgnoreCase("sosi") &&
>                 !ogr.LayerCanCreateField(layer)) {
>                 throw new DataSourceException(
>                         "OGR reports it's not possible to create fields on
> this layer");
>             }
> 
> By digging into the MIF/MID and tab code "OGR-side", I discovered that the
> TestCapability method between the two formats is not returning exactly the
> same capabilities. I thought both were very close to each other, so is the
> CreateField capability not supported at MIF/MID side, or is it just a
> missing test ?

Yes looks like the TestCapability() method on the MIF side should also report 
OLCCreateField. CreateField() is necessary implemented since you can create 
MIF/MID files with attributes.

> 
> I tried to recompile a own version of GDAL/OGR returning true for
> CreateField TestCapability in the MIF/MID code, and I was able to correctly
> generate the expected mif file from my application, but I might be wrong in
> the approach, being pretty new to gdal codebase and not a C++ guru.
> 
> Secondly, by reading the code, I found out a weird test[2]: is line #2258
> ever triggered ?

Yep, I guess the second one should read OLCRandomWrite, if we compare with the 
TAB side. Anyway in practice this should be OK since the default value is 
FALSE...

> 
> Thanks in advance for the answers and regards,
> 
> [1]
> https://github.com/geotools/geotools/blob/master/modules/plugin/ogr/ogr-cor
> e/src/main/java/org/geotools/data/ogr/OGRDataStore.java#L194-L198
> 
> [2]
> https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrsf_frmts/mitab/mitab_m
> iffile.cpp#L2255-L2259
> 
> 
> <https://github.com/geotools/geotools/blob/master/modules/plugin/ogr/ogr-co
> re/src/main/java/org/geotools/data/ogr/OGRDataStore.java#L194-L198>

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon May 19 11:10:10 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 20:10:10 +0200
Subject: [gdal-dev] Raster Color map in python
In-Reply-To: <1400428549224-5141027.post@n6.nabble.com>
References: <1400428549224-5141027.post@n6.nabble.com>
Message-ID: <201405192010.10674.even.rouault@mines-paris.org>

Le dimanche 18 mai 2014 17:55:49, kalu671 a ?crit :
> I have a reference raster map and list of other rasters. I want to get
> color table from reference map and set to the list using python. I can
> read other parameters from raster but some how I can not get the color
> table
> (GetRasterColorTable())from the source file, let alone setting the table
> (SetRasterColorTable())to the list. I am pasting some code lines here.
> Could someone help me figuring this out? or suggesting another easy
> solution?
> 
> There is another similar thread but that is related to C#. I tried to
> follow that in python but didn't help.
> 
> SourceFile = "source.tif"
> targetFile = "target.tif"
> 
> rastDriver    = gdal.GetDriverByName('gtiff')
> rastDriver.Register()
> 
> inSourceFile   = gdal.Open(SourceFile)
> inTargetFile   = gdal.Open(targetFile)
> 
> ## reading parameters of source file
> col 		= inSourceFile.RasterXSize
> row		= inSourceFile.RasterYSize
> bands	 	= inSourceFile.RasterCount
> ct	        = inSourceFile.GetRasterColorTable() # the code stops working


--> Color tables are attached to bands, not datasets. so you have to do 
something like inSourcefile.GetRasterBand(1).GetRasterColorTable()

> from this line if I comment out        this line the code goes through
> GeoT 		= inSourceFile.GetGeoTransform()
> proj 		= inSourceFile.GetProjection()
> 
> 
> Thank you in Advance for your help
> 
> 
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Raster-Color-map-in-python-tp5141027.h
> tml Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From kalu671 at gmail.com  Mon May 19 11:53:20 2014
From: kalu671 at gmail.com (devendra dahal)
Date: Mon, 19 May 2014 13:53:20 -0500
Subject: [gdal-dev] Raster Color map in python
In-Reply-To: <201405192010.10674.even.rouault@mines-paris.org>
References: <1400428549224-5141027.post@n6.nabble.com>
	<201405192010.10674.even.rouault@mines-paris.org>
Message-ID: <CAMJhjUU4AC3_gRQaK5qxv0EbZkB3QaLukAcaqQnSGYrzN_BfYQ@mail.gmail.com>

Wonderful,

Thanks a lot.


On Mon, May 19, 2014 at 1:10 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le dimanche 18 mai 2014 17:55:49, kalu671 a ?crit :
> > I have a reference raster map and list of other rasters. I want to get
> > color table from reference map and set to the list using python. I can
> > read other parameters from raster but some how I can not get the color
> > table
> > (GetRasterColorTable())from the source file, let alone setting the table
> > (SetRasterColorTable())to the list. I am pasting some code lines here.
> > Could someone help me figuring this out? or suggesting another easy
> > solution?
> >
> > There is another similar thread but that is related to C#. I tried to
> > follow that in python but didn't help.
> >
> > SourceFile = "source.tif"
> > targetFile = "target.tif"
> >
> > rastDriver    = gdal.GetDriverByName('gtiff')
> > rastDriver.Register()
> >
> > inSourceFile   = gdal.Open(SourceFile)
> > inTargetFile   = gdal.Open(targetFile)
> >
> > ## reading parameters of source file
> > col           = inSourceFile.RasterXSize
> > row           = inSourceFile.RasterYSize
> > bands         = inSourceFile.RasterCount
> > ct            = inSourceFile.GetRasterColorTable() # the code stops
> working
>
>
> --> Color tables are attached to bands, not datasets. so you have to do
> something like inSourcefile.GetRasterBand(1).GetRasterColorTable()
>
> > from this line if I comment out        this line the code goes through
> > GeoT          = inSourceFile.GetGeoTransform()
> > proj          = inSourceFile.GetProjection()
> >
> >
> > Thank you in Advance for your help
> >
> >
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://osgeo-org.1560.x6.nabble.com/Raster-Color-map-in-python-tp5141027.h
> > tml Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/5e3a0d9e/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon May 19 13:16:16 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 19 May 2014 20:16:16 +0000 (UTC)
Subject: [gdal-dev] Number accuracy in convertion shp to geojson
Message-ID: <loom.20140519T220357-731@post.gmane.org>

Hi,

I have shapefile like this:
>ogrinfo geojsontest.shp -al|more
INFO: Open of `geojsontest.shp'
      using driver `ESRI Shapefile' successful.

Layer name: geojsontest
Geometry: Point
Feature Count: 5
Extent: (5.000000, -40.000000) - (30.000000, -15.000000)
Layer SRS WKT:
(unknown)
id: Real (11.0)
attr: Real (11.0)
OGRFeature(geojsontest):0
  id (Real) = 12
  attr (Real) = 3
  POINT (5 -25)

I converted the shapefile into geojson with command:
>ogr2ogr -f "GeoJSON"  geojsontest.json -s_srs EPSG:4326 -t_srs EPSG:3857
-lco coordinate_precision=0 geojsontest.shp

As a result I get
{ "type": "Feature", "properties": { "id": 12.000000, "attr": 3.000000 },
"geometry": { "type": "Point", "coordinates": [ 556597, -2875745 ] } },

Why so many decimals in "id" and "attr"? Doesn't definition (11.0) in dbf
file mean that it has max 11 numbers and 0 decimals, thus it is an integer?

Data comes from OpenJUMP and the developer writes:

"Basic data types of dBase III format are :
C (Character) 	All OEM code page characters. 
D (Date) 	Numbers and a character to separate month, day, and year (stored
internally as 8 digits in YYYYMMDD format). 
N (Numeric) 	- . 0 1 2 3 4 5 6 7 8 9 
L (Logical) 	? Y y N n T t F f (? when not initialized). 
M (Memo) 	All OEM code page characters (stored internally as 10 digits
representing a .DBT block number). 

AFAIK, OpenJUMP uses only C, D and N

For integers, it exports a numeric of length 11 with 0 decimals 
For doubles, it exports a numeric of length 33 with 16 decimals
While reading a dbf, OpenJUMP reads column with 0 decimal as integers and
columns with 1 decimal or more as double"

Is there something wrong with the dbf created by OpenJUMP or is the OGR
geojson driver doing wrong when it writes out decimal numbers?

-Jukka Rahkonen-



From even.rouault at mines-paris.org  Mon May 19 13:27:45 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 22:27:45 +0200
Subject: [gdal-dev] Number accuracy in convertion shp to geojson
In-Reply-To: <loom.20140519T220357-731@post.gmane.org>
References: <loom.20140519T220357-731@post.gmane.org>
Message-ID: <201405192227.45883.even.rouault@mines-paris.org>

Le lundi 19 mai 2014 22:16:16, Jukka Rahkonen a ?crit :
> Hi,
> 
> I have shapefile like this:
> >ogrinfo geojsontest.shp -al|more
> 
> INFO: Open of `geojsontest.shp'
>       using driver `ESRI Shapefile' successful.
> 
> Layer name: geojsontest
> Geometry: Point
> Feature Count: 5
> Extent: (5.000000, -40.000000) - (30.000000, -15.000000)
> Layer SRS WKT:
> (unknown)
> id: Real (11.0)
> attr: Real (11.0)
> OGRFeature(geojsontest):0
>   id (Real) = 12
>   attr (Real) = 3
>   POINT (5 -25)
> 
> I converted the shapefile into geojson with command:
> >ogr2ogr -f "GeoJSON"  geojsontest.json -s_srs EPSG:4326 -t_srs EPSG:3857
> 
> -lco coordinate_precision=0 geojsontest.shp
> 
> As a result I get
> { "type": "Feature", "properties": { "id": 12.000000, "attr": 3.000000 },
> "geometry": { "type": "Point", "coordinates": [ 556597, -2875745 ] } },
> 
> Why so many decimals in "id" and "attr"? Doesn't definition (11.0) in dbf
> file mean that it has max 11 numbers and 0 decimals, thus it is an integer?

Yes, but with 11 figures, you can have an integer that is more than a signed 32 
bit integer, hence the choice of the shapefile driver to expose those fields as 
real to avoid integer overflow.

> 
> Data comes from OpenJUMP and the developer writes:
> 
> "Basic data types of dBase III format are :
> C (Character) 	All OEM code page characters.
> D (Date) 	Numbers and a character to separate month, day, and year 
(stored
> internally as 8 digits in YYYYMMDD format).
> N (Numeric) 	- . 0 1 2 3 4 5 6 7 8 9
> L (Logical) 	? Y y N n T t F f (? when not initialized).
> M (Memo) 	All OEM code page characters (stored internally as 10 digits
> representing a .DBT block number).
> 
> AFAIK, OpenJUMP uses only C, D and N
> 
> For integers, it exports a numeric of length 11 with 0 decimals
> For doubles, it exports a numeric of length 33 with 16 decimals
> While reading a dbf, OpenJUMP reads column with 0 decimal as integers and
> columns with 1 decimal or more as double"
> 
> Is there something wrong with the dbf created by OpenJUMP or is the OGR
> geojson driver doing wrong when it writes out decimal numbers?

The GeoJSON driver doesn't honour field width and precision when writing.

> 
> -Jukka Rahkonen-
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon May 19 13:28:37 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 22:28:37 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>
	<CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>
Message-ID: <201405192228.38271.even.rouault@mines-paris.org>

Le vendredi 16 mai 2014 16:25:13, Etienne Tourigny a ?crit :
> With this RFC, you could achieve this using GDALOpenEx()
> 
> e.g. GDALOpenEx( "ASDFG", GDAL_OF_ALL, "QWERTY")

Actually, this is an array of driver names: 

char** papszDrivers = CSLAddString(NULL, "QWERTY")
poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, papszDrivers, NULL, NULL);
CSLDestroy(papszDrivers);

or in Python

gdal.OpenEx("ADSFG", allowed_drivers = ['QWERTY'])

> 
> On Fri, May 16, 2014 at 11:01 AM, Ivan Lucena 
<lucena_ivan at hotmail.com>wrote:
> > Even,
> > 
> > Yes, it is hard to measure the impact of probing in a single file or any
> > interactive command line operations.
> > 
> > In the current API the class Driver doesn't expose the Open method:
> > 
> > *Driver drv = gdal.GetDriverByName("QWERTY");*
> > *Dataset dst = drv.Open("ASDFG");*
> > 
> > 
> > IMHO that is a *missing functionality* in  GDAL API.
> > 
> > GDAL API is a library to support Geospatial Data Abastration not just a
> > format conversion tool. You should be able the use it even if your sole
> > intention is do deal with the fictitious "QWERTY" format. IMHO. Yes, you
> > can delete all the driver or put then all on the black list but that may
> > not be the best solution.
> > 
> > The frustration of some user/programmer could be that they know what
> > driver they want to use and they don't want to waste time probing; they
> > don't want GDAL to get confused by files that can be supported by driver
> > A and B; and most important they want to process a very very large
> > number of files (ETL) or repeated times (WEB).
> > 
> > The RFC 36 is just a band-aid solution. It starts from the fact that some
> > drivers already haven a prefix like "HDF4:" and use it to select the
> > driver. As you can see, the suggested code is not that pretty [
> > http://trac.osgeo.org/gdal/ticket/3043] since there is no Driver::Open
> > method available.
> > 
> > Regards,
> > 
> > Ivan
> > 
> > > Date: Fri, 16 May 2014 13:36:08 +0200
> > > From: even.rouault at mines-paris.org
> > > To: lucena_ivan at hotmail.com
> > > CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> > > Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > 
> > unification
> > 
> > > Ivan,
> > > 
> > > yes indeed, I missed that one. I'll update the RFC with it.
> > > I think that the intent of RFC36 is covered by what is already proposed
> > 
> > in RFC46
> > 
> > > with the papszAllowedDrivers of GDALOpenEx().
> > > 
> > > I do not think that specifying the candidate driver(s) is that usefull
> > > in utilities since the time to launch them will be generally higher
> > > than the probing time. But that could be easily implemented later with
> > > an option
> > 
> > if that
> > 
> > > was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly
> > 
> > gdalinfo
> > 
> > > foo.jp2 -driver jp2ecw,jp2openjpeg).
> > > Due to the work I did in OGR drivers to avoid repeated file access by
> > 
> > using
> > 
> > > GDALOpenInfo*, I don't think that GDAL drivers should be affected. And
> > 
> > the OGR
> > 
> > > drivers are registered after the GDAL ones. So if the file being opened
> > 
> > is
> > 
> > > really a GDAL dataset, the OGR drivers should have 0 impact on the
> > 
> > opening time.
> > 
> > > I did try to benchmark a bit that, but it is difficult to come to a
> > > firm conclusion since there are many factors: hot/cold runs, whether
> > > you
> > 
> > spawn a new
> > 
> > > process or use an existing one, etc.. And the time being measured are a
> > 
> > few tens
> > 
> > > of milliseconds, so very sensitive to task scheduling.
> > > 
> > > Even
> > > 
> > > > Even,
> > > > 
> > > > I think that RFC 36 should be included in your list of
> > > > related RFCs and should be reconsider for adoption since the
> > 
> > unification
> > 
> > > > would make the probing even more expensive.
> > > > 
> > > > Regards,
> > > > 
> > > > Ivan
> > > > 
> > > > > From: even.rouault at mines-paris.org
> > > > > To: gdal-dev at lists.osgeo.org
> > > > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > 
> > unification
> > 
> > > > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > > > Hi,
> > > > > > 
> > > > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > > > > 
> > > > > > http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > > > 
> > > > > No reaction : no interest or no time to review yet ?
> > > > > Or should I move that forward ?
> > > > > But I'd prefer if such architectural changes could be a bit
> > 
> > reviewed...
> > 
> > > > > > Best regards,
> > > > > > 
> > > > > > Even
> > > > > 
> > > > > --
> > > > > Geospatial professional services
> > > > > http://even.rouault.free.fr/services.html
> > > > > _______________________________________________
> > > > > gdal-dev mailing list
> > > > > gdal-dev at lists.osgeo.org
> > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon May 19 13:29:29 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 22:29:29 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
Message-ID: <201405192229.29577.even.rouault@mines-paris.org>

Hi,

I think that the points raised in the discussion have been answered. I've just 
done a minor edit to the RFC text to mention RFC 36, as rightly suggested by 
Ivan.

So:

Motion : I move to adopt RFC 46: GDAL/OGR unification

    http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Starting with my +1

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From etourigny.dev at gmail.com  Mon May 19 13:43:06 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 19 May 2014 17:43:06 -0300
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <201405192228.38271.even.rouault@mines-paris.org>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<BLU173-W50FC128F816F1A3C0E9ABA90310@phx.gbl>
	<CA+TxYvMaN5JLP007S=TX=Uga_2FwP5Q08Pz_+3KhqffdW4tEug@mail.gmail.com>
	<201405192228.38271.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvODkHuntWTm5USQrUeCUaEMSKvZ1ae1nKxogcXzn_RqKw@mail.gmail.com>

hmmm may I suggest to use a short-handed version using a single character
string? While it is easy in python, it's a bit cumbersome in c/c++
(requiring 3 lines of code instead of 1)

something like
poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver", NULL, NULL);
poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver1,driver2", NULL, NULL);
or
poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver1 driver2", NULL, NULL);

cheers
Etienne


On Mon, May 19, 2014 at 5:28 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le vendredi 16 mai 2014 16:25:13, Etienne Tourigny a ?crit :
> > With this RFC, you could achieve this using GDALOpenEx()
> >
> > e.g. GDALOpenEx( "ASDFG", GDAL_OF_ALL, "QWERTY")
>
> Actually, this is an array of driver names:
>
> char** papszDrivers = CSLAddString(NULL, "QWERTY")
> poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, papszDrivers, NULL, NULL);
> CSLDestroy(papszDrivers);
>
> or in Python
>
> gdal.OpenEx("ADSFG", allowed_drivers = ['QWERTY'])
>
> >
> > On Fri, May 16, 2014 at 11:01 AM, Ivan Lucena
> <lucena_ivan at hotmail.com>wrote:
> > > Even,
> > >
> > > Yes, it is hard to measure the impact of probing in a single file or
> any
> > > interactive command line operations.
> > >
> > > In the current API the class Driver doesn't expose the Open method:
> > >
> > > *Driver drv = gdal.GetDriverByName("QWERTY");*
> > > *Dataset dst = drv.Open("ASDFG");*
> > >
> > >
> > > IMHO that is a *missing functionality* in  GDAL API.
> > >
> > > GDAL API is a library to support Geospatial Data Abastration not just a
> > > format conversion tool. You should be able the use it even if your sole
> > > intention is do deal with the fictitious "QWERTY" format. IMHO. Yes,
> you
> > > can delete all the driver or put then all on the black list but that
> may
> > > not be the best solution.
> > >
> > > The frustration of some user/programmer could be that they know what
> > > driver they want to use and they don't want to waste time probing; they
> > > don't want GDAL to get confused by files that can be supported by
> driver
> > > A and B; and most important they want to process a very very large
> > > number of files (ETL) or repeated times (WEB).
> > >
> > > The RFC 36 is just a band-aid solution. It starts from the fact that
> some
> > > drivers already haven a prefix like "HDF4:" and use it to select the
> > > driver. As you can see, the suggested code is not that pretty [
> > > http://trac.osgeo.org/gdal/ticket/3043] since there is no Driver::Open
> > > method available.
> > >
> > > Regards,
> > >
> > > Ivan
> > >
> > > > Date: Fri, 16 May 2014 13:36:08 +0200
> > > > From: even.rouault at mines-paris.org
> > > > To: lucena_ivan at hotmail.com
> > > > CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> > > > Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > >
> > > unification
> > >
> > > > Ivan,
> > > >
> > > > yes indeed, I missed that one. I'll update the RFC with it.
> > > > I think that the intent of RFC36 is covered by what is already
> proposed
> > >
> > > in RFC46
> > >
> > > > with the papszAllowedDrivers of GDALOpenEx().
> > > >
> > > > I do not think that specifying the candidate driver(s) is that
> usefull
> > > > in utilities since the time to launch them will be generally higher
> > > > than the probing time. But that could be easily implemented later
> with
> > > > an option
> > >
> > > if that
> > >
> > > > was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly
> > >
> > > gdalinfo
> > >
> > > > foo.jp2 -driver jp2ecw,jp2openjpeg).
> > > > Due to the work I did in OGR drivers to avoid repeated file access by
> > >
> > > using
> > >
> > > > GDALOpenInfo*, I don't think that GDAL drivers should be affected.
> And
> > >
> > > the OGR
> > >
> > > > drivers are registered after the GDAL ones. So if the file being
> opened
> > >
> > > is
> > >
> > > > really a GDAL dataset, the OGR drivers should have 0 impact on the
> > >
> > > opening time.
> > >
> > > > I did try to benchmark a bit that, but it is difficult to come to a
> > > > firm conclusion since there are many factors: hot/cold runs, whether
> > > > you
> > >
> > > spawn a new
> > >
> > > > process or use an existing one, etc.. And the time being measured
> are a
> > >
> > > few tens
> > >
> > > > of milliseconds, so very sensitive to task scheduling.
> > > >
> > > > Even
> > > >
> > > > > Even,
> > > > >
> > > > > I think that RFC 36 should be included in your list of
> > > > > related RFCs and should be reconsider for adoption since the
> > >
> > > unification
> > >
> > > > > would make the probing even more expensive.
> > > > >
> > > > > Regards,
> > > > >
> > > > > Ivan
> > > > >
> > > > > > From: even.rouault at mines-paris.org
> > > > > > To: gdal-dev at lists.osgeo.org
> > > > > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > > > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > >
> > > unification
> > >
> > > > > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > > > > Hi,
> > > > > > >
> > > > > > > This is a call for discussion on "RFC 46: GDAL/OGR unification"
> > > > > > >
> > > > > > > http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > > > >
> > > > > > No reaction : no interest or no time to review yet ?
> > > > > > Or should I move that forward ?
> > > > > > But I'd prefer if such architectural changes could be a bit
> > >
> > > reviewed...
> > >
> > > > > > > Best regards,
> > > > > > >
> > > > > > > Even
> > > > > >
> > > > > > --
> > > > > > Geospatial professional services
> > > > > > http://even.rouault.free.fr/services.html
> > > > > > _______________________________________________
> > > > > > gdal-dev mailing list
> > > > > > gdal-dev at lists.osgeo.org
> > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/13b60513/attachment-0001.html>

From even.rouault at mines-paris.org  Mon May 19 13:53:35 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 22:53:35 +0200
Subject: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR unification
In-Reply-To: <CA+TxYvODkHuntWTm5USQrUeCUaEMSKvZ1ae1nKxogcXzn_RqKw@mail.gmail.com>
References: <201405080013.23209.even.rouault@mines-paris.org>
	<201405192228.38271.even.rouault@mines-paris.org>
	<CA+TxYvODkHuntWTm5USQrUeCUaEMSKvZ1ae1nKxogcXzn_RqKw@mail.gmail.com>
Message-ID: <201405192253.35935.even.rouault@mines-paris.org>

Le lundi 19 mai 2014 22:43:06, Etienne Tourigny a ?crit :
> hmmm may I suggest to use a short-handed version using a single character
> string? While it is easy in python, it's a bit cumbersome in c/c++
> (requiring 3 lines of code instead of 1)
> 
> something like
> poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver", NULL, NULL);
> poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver1,driver2", NULL, NULL);
> or
> poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, "driver1 driver2", NULL, NULL);

In most cases, you will pass NULL as argument, so I don't think that will be 
much an annoyance to have an array of strings. The issue with the single 
string is that you never know which separator to use. A similar example is 
with GDAL_SKIP and OGR_SKIP. In GDAL_SKIP, we used to have space as separator. 
And in OGR_SKIP, comma.... (since there are OGR drivers with spaces in their 
name "ESRI Shapefile"). In the branch, I've introduced a logic that tries to 
detect the separator, while recommanding comma, but that's a bit messy. That's 
why I'd prefer the array of string, even if it is a bit more verbose to 
declare.
But if people feel strongly for the single string, that wouldn't be a big deal 
to switch to that.

> 
> cheers
> Etienne
> 
> 
> On Mon, May 19, 2014 at 5:28 PM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le vendredi 16 mai 2014 16:25:13, Etienne Tourigny a ?crit :
> > > With this RFC, you could achieve this using GDALOpenEx()
> > > 
> > > e.g. GDALOpenEx( "ASDFG", GDAL_OF_ALL, "QWERTY")
> > 
> > Actually, this is an array of driver names:
> > 
> > char** papszDrivers = CSLAddString(NULL, "QWERTY")
> > poDS = GDALOpenEx( "ASDFG", GDAL_OF_ALL, papszDrivers, NULL, NULL);
> > CSLDestroy(papszDrivers);
> > 
> > or in Python
> > 
> > gdal.OpenEx("ADSFG", allowed_drivers = ['QWERTY'])
> > 
> > > On Fri, May 16, 2014 at 11:01 AM, Ivan Lucena
> > 
> > <lucena_ivan at hotmail.com>wrote:
> > > > Even,
> > > > 
> > > > Yes, it is hard to measure the impact of probing in a single file or
> > 
> > any
> > 
> > > > interactive command line operations.
> > > > 
> > > > In the current API the class Driver doesn't expose the Open method:
> > > > 
> > > > *Driver drv = gdal.GetDriverByName("QWERTY");*
> > > > *Dataset dst = drv.Open("ASDFG");*
> > > > 
> > > > 
> > > > IMHO that is a *missing functionality* in  GDAL API.
> > > > 
> > > > GDAL API is a library to support Geospatial Data Abastration not just
> > > > a format conversion tool. You should be able the use it even if your
> > > > sole intention is do deal with the fictitious "QWERTY" format. IMHO.
> > > > Yes,
> > 
> > you
> > 
> > > > can delete all the driver or put then all on the black list but that
> > 
> > may
> > 
> > > > not be the best solution.
> > > > 
> > > > The frustration of some user/programmer could be that they know what
> > > > driver they want to use and they don't want to waste time probing;
> > > > they don't want GDAL to get confused by files that can be supported
> > > > by
> > 
> > driver
> > 
> > > > A and B; and most important they want to process a very very large
> > > > number of files (ETL) or repeated times (WEB).
> > > > 
> > > > The RFC 36 is just a band-aid solution. It starts from the fact that
> > 
> > some
> > 
> > > > drivers already haven a prefix like "HDF4:" and use it to select the
> > > > driver. As you can see, the suggested code is not that pretty [
> > > > http://trac.osgeo.org/gdal/ticket/3043] since there is no
> > > > Driver::Open method available.
> > > > 
> > > > Regards,
> > > > 
> > > > Ivan
> > > > 
> > > > > Date: Fri, 16 May 2014 13:36:08 +0200
> > > > > From: even.rouault at mines-paris.org
> > > > > To: lucena_ivan at hotmail.com
> > > > > CC: even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> > > > > Subject: RE: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > > > 
> > > > unification
> > > > 
> > > > > Ivan,
> > > > > 
> > > > > yes indeed, I missed that one. I'll update the RFC with it.
> > > > > I think that the intent of RFC36 is covered by what is already
> > 
> > proposed
> > 
> > > > in RFC46
> > > > 
> > > > > with the papszAllowedDrivers of GDALOpenEx().
> > > > > 
> > > > > I do not think that specifying the candidate driver(s) is that
> > 
> > usefull
> > 
> > > > > in utilities since the time to launch them will be generally higher
> > > > > than the probing time. But that could be easily implemented later
> > 
> > with
> > 
> > > > > an option
> > > > 
> > > > if that
> > > > 
> > > > > was really needed (e.g. gdalinfo foo.tif -driver gtiff or possibly
> > > > 
> > > > gdalinfo
> > > > 
> > > > > foo.jp2 -driver jp2ecw,jp2openjpeg).
> > > > > Due to the work I did in OGR drivers to avoid repeated file access
> > > > > by
> > > > 
> > > > using
> > > > 
> > > > > GDALOpenInfo*, I don't think that GDAL drivers should be affected.
> > 
> > And
> > 
> > > > the OGR
> > > > 
> > > > > drivers are registered after the GDAL ones. So if the file being
> > 
> > opened
> > 
> > > > is
> > > > 
> > > > > really a GDAL dataset, the OGR drivers should have 0 impact on the
> > > > 
> > > > opening time.
> > > > 
> > > > > I did try to benchmark a bit that, but it is difficult to come to a
> > > > > firm conclusion since there are many factors: hot/cold runs,
> > > > > whether you
> > > > 
> > > > spawn a new
> > > > 
> > > > > process or use an existing one, etc.. And the time being measured
> > 
> > are a
> > 
> > > > few tens
> > > > 
> > > > > of milliseconds, so very sensitive to task scheduling.
> > > > > 
> > > > > Even
> > > > > 
> > > > > > Even,
> > > > > > 
> > > > > > I think that RFC 36 should be included in your list of
> > > > > > related RFCs and should be reconsider for adoption since the
> > > > 
> > > > unification
> > > > 
> > > > > > would make the probing even more expensive.
> > > > > > 
> > > > > > Regards,
> > > > > > 
> > > > > > Ivan
> > > > > > 
> > > > > > > From: even.rouault at mines-paris.org
> > > > > > > To: gdal-dev at lists.osgeo.org
> > > > > > > Date: Thu, 15 May 2014 20:47:32 +0200
> > > > > > > Subject: Re: [gdal-dev] Call for discussion on RFC 46: GDAL/OGR
> > > > 
> > > > unification
> > > > 
> > > > > > > Le jeudi 08 mai 2014 00:13:22, Even Rouault a ?crit :
> > > > > > > > Hi,
> > > > > > > > 
> > > > > > > > This is a call for discussion on "RFC 46: GDAL/OGR
> > > > > > > > unification"
> > > > > > > > 
> > > > > > > > http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> > > > > > > 
> > > > > > > No reaction : no interest or no time to review yet ?
> > > > > > > Or should I move that forward ?
> > > > > > > But I'd prefer if such architectural changes could be a bit
> > > > 
> > > > reviewed...
> > > > 
> > > > > > > > Best regards,
> > > > > > > > 
> > > > > > > > Even
> > > > > > > 
> > > > > > > --
> > > > > > > Geospatial professional services
> > > > > > > http://even.rouault.free.fr/services.html
> > > > > > > _______________________________________________
> > > > > > > gdal-dev mailing list
> > > > > > > gdal-dev at lists.osgeo.org
> > > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > 
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Mon May 19 14:00:58 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 19 May 2014 21:00:58 +0000 (UTC)
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
References: <201405192229.29577.even.rouault@mines-paris.org>
Message-ID: <loom.20140519T225345-324@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Hi,
> 
> I think that the points raised in the discussion have been answered. I've
just 
> done a minor edit to the RFC text to mention RFC 36, as rightly suggested by 
> Ivan.
> 
> So:
> 
> Motion : I move to adopt RFC 46: GDAL/OGR unification
> 
>     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> 
> Starting with my +1

+0 because RFC goes too deeply into the code for me but I trust that Even
has a good intention.

-Jukka Rahkonen-


From woodbri at swoodbridge.com  Mon May 19 14:42:06 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 19 May 2014 17:42:06 -0400
Subject: [gdal-dev] Question on scaling between tif and vrt
Message-ID: <537A7AAE.2050400@swoodbridge.com>

Hi all,

I have a .tif file with -ot Int16 and an associated .vrt file that is 
applying a color palette and is type Byte.

How does if decide on how to scale the pixel values?

Does it compute the range and then just scale and offset that values to 
the new range?

Below are the gdalinfo for each.

Thanks,
   -Steve

gdalinfo -stats MODIS_SST_EAST-201405190900.tif
Driver: GTiff/GeoTIFF
Files: MODIS_SST_EAST-201405190900.tif
        MODIS_SST_EAST-201405190900.tif.aux.xml
Size is 8800, 6600
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-125.000000000000000,54.931818190930159)
Pixel Size = (0.009090548548341,-0.009058565004476)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-125.0000000,  54.9318182) (125d 0' 0.00"W, 54d55'54.55"N)
Lower Left  (-125.0000000,  -4.8547108) (125d 0' 0.00"W,  4d51'16.96"S)
Upper Right ( -45.0031728,  54.9318182) ( 45d 0'11.42"W, 54d55'54.55"N)
Lower Right ( -45.0031728,  -4.8547108) ( 45d 0'11.42"W,  4d51'16.96"S)
Center      ( -85.0015864,  25.0385537) ( 85d 0' 5.71"W, 25d 2'18.79"N)
Band 1 Block=8800x1 Type=Int16, ColorInterp=Gray
   Min=-10004.000 Max=6035.000
   Minimum=-10004.000, Maximum=6035.000, Mean=-673.234, StdDev=268.660
   Overviews: 4400x3300, 2200x1650, 1100x825, 550x413, 275x207
   Metadata:
     STATISTICS_MAXIMUM=6035
     STATISTICS_MEAN=-673.23378700069
     STATISTICS_MINIMUM=-10004
     STATISTICS_STDDEV=268.66013989253

gdalinfo -stats -noct MODIS_SST_EAST-201405190900.vrt
Driver: VRT/Virtual Raster
Files: /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.vrt
        /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.tif
Size is 8800, 6600
Coordinate System is `'
Origin = (-125.000000000000000,54.936579299999998)
Pixel Size = (0.009090548056818,-0.009058564515152)
Corner Coordinates:
Upper Left  (-125.0000000,  54.9365793)
Lower Left  (-125.0000000,  -4.8499465)
Upper Right ( -45.0031771,  54.9365793)
Lower Right ( -45.0031771,  -4.8499465)
Center      ( -85.0015886,  25.0433164)
Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
   Minimum=0.000, Maximum=255.000, Mean=1.885, StdDev=21.797
   Metadata:
     STATISTICS_MAXIMUM=255
     STATISTICS_MEAN=1.8849891356749
     STATISTICS_MINIMUM=0
     STATISTICS_STDDEV=21.796961177215
   Color Table (RGB with 256 entries)

From even.rouault at mines-paris.org  Mon May 19 14:48:02 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 19 May 2014 23:48:02 +0200
Subject: [gdal-dev] Question on scaling between tif and vrt
In-Reply-To: <537A7AAE.2050400@swoodbridge.com>
References: <537A7AAE.2050400@swoodbridge.com>
Message-ID: <201405192348.02077.even.rouault@mines-paris.org>

Le lundi 19 mai 2014 23:42:06, Stephen Woodbridge a ?crit :
> Hi all,
> 
> I have a .tif file with -ot Int16 and an associated .vrt file that is
> applying a color palette and is type Byte.
> 
> How does if decide on how to scale the pixel values?
> 
> Does it compute the range and then just scale and offset that values to
> the new range?

Not completely sure to understand what you really mean, but I'd say no scaling 
nor offseting.
Color table is plain and stupid. You need to provide as many entries in the 
color tables as values in the input file, and the index of the color table must 
match the value of the pixel in the source band. And this is not possible in 
your case since the minimum value is negative (as said in previous related 
discussion), and the color table entries are indexed starting at 0.

--> use LUT

> 
> Below are the gdalinfo for each.
> 
> Thanks,
>    -Steve
> 
> gdalinfo -stats MODIS_SST_EAST-201405190900.tif
> Driver: GTiff/GeoTIFF
> Files: MODIS_SST_EAST-201405190900.tif
>         MODIS_SST_EAST-201405190900.tif.aux.xml
> Size is 8800, 6600
> Coordinate System is:
> GEOGCS["WGS 84",
>      DATUM["WGS_1984",
>          SPHEROID["WGS 84",6378137,298.257223563,
>              AUTHORITY["EPSG","7030"]],
>          AUTHORITY["EPSG","6326"]],
>      PRIMEM["Greenwich",0],
>      UNIT["degree",0.0174532925199433],
>      AUTHORITY["EPSG","4326"]]
> Origin = (-125.000000000000000,54.931818190930159)
> Pixel Size = (0.009090548548341,-0.009058565004476)
> Metadata:
>    AREA_OR_POINT=Area
> Image Structure Metadata:
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-125.0000000,  54.9318182) (125d 0' 0.00"W, 54d55'54.55"N)
> Lower Left  (-125.0000000,  -4.8547108) (125d 0' 0.00"W,  4d51'16.96"S)
> Upper Right ( -45.0031728,  54.9318182) ( 45d 0'11.42"W, 54d55'54.55"N)
> Lower Right ( -45.0031728,  -4.8547108) ( 45d 0'11.42"W,  4d51'16.96"S)
> Center      ( -85.0015864,  25.0385537) ( 85d 0' 5.71"W, 25d 2'18.79"N)
> Band 1 Block=8800x1 Type=Int16, ColorInterp=Gray
>    Min=-10004.000 Max=6035.000
>    Minimum=-10004.000, Maximum=6035.000, Mean=-673.234, StdDev=268.660
>    Overviews: 4400x3300, 2200x1650, 1100x825, 550x413, 275x207
>    Metadata:
>      STATISTICS_MAXIMUM=6035
>      STATISTICS_MEAN=-673.23378700069
>      STATISTICS_MINIMUM=-10004
>      STATISTICS_STDDEV=268.66013989253
> 
> gdalinfo -stats -noct MODIS_SST_EAST-201405190900.vrt
> Driver: VRT/Virtual Raster
> Files: /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.vrt
>         /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.tif
> Size is 8800, 6600
> Coordinate System is `'
> Origin = (-125.000000000000000,54.936579299999998)
> Pixel Size = (0.009090548056818,-0.009058564515152)
> Corner Coordinates:
> Upper Left  (-125.0000000,  54.9365793)
> Lower Left  (-125.0000000,  -4.8499465)
> Upper Right ( -45.0031771,  54.9365793)
> Lower Right ( -45.0031771,  -4.8499465)
> Center      ( -85.0015886,  25.0433164)
> Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
>    Minimum=0.000, Maximum=255.000, Mean=1.885, StdDev=21.797
>    Metadata:
>      STATISTICS_MAXIMUM=255
>      STATISTICS_MEAN=1.8849891356749
>      STATISTICS_MINIMUM=0
>      STATISTICS_STDDEV=21.796961177215
>    Color Table (RGB with 256 entries)
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mickael.savinaud at c-s.fr  Mon May 19 15:23:25 2014
From: mickael.savinaud at c-s.fr (SAVINAUD =?iso-8859-1?b?TWlja2HDq2w=?=)
Date: Tue, 20 May 2014 00:23:25 +0200
Subject: [gdal-dev] OpenJPEG driver
In-Reply-To: <201405192001.48688.even.rouault@mines-paris.org>
References: <537A2B96.7030809@c-s.fr>
	<201405192001.48688.even.rouault@mines-paris.org>
Message-ID: <20140520002325.10152xi287qik2n1@messagerie.si.c-s.fr>

Hi Even,

Even Rouault <even.rouault at mines-paris.org> a ?crit?:

> Guillaume,
>
>>
>> I am using the OpenJPEG driver from GDAL and I noticed some differences
>> with the behaviour of an other OpenJPEG "driver" that I used before in
>> the library Orfeo ToolBox. The GDAL driver fails to pass a conformance
>> test : using the input file "jpeg2000_conf_p1_06.j2k"
>
> Are you refering to
> http://code.google.com/p/openjpeg/source/browse/data/input/conformance/p1_06.j2k
> ? I see this is a 12 x 12 pixel image ...
Yes it is. Thie file is a part of the jpeg2000 decoding conformance data.
>
>> , reading the
>> resolution level 4 (zero being the original image) , it should produce a
>> 1x1 image with the pixel value [195, 36, 100].
>>
>> The behaviour of GDAL drivers differs on the following points :
>>
>>   * The number of overviews detected for a jpeg2000 dataset is limited
>>     (no overview if its dimensions are both lower than 256). Even if the
>>     the overviews can be computed by GDAL, it won't use the wavelet
>>     coefficients for the highest levels, but rather perform the default
>>     nearest neighbor interpolation.
>
> Yes, this is to avoid exposing overviews that are too small and do not make
> pratical sense. Other JPEG2000 drivers, such as JP2KAK or JP2ECW,  
> have similar
> logic.
>
>>   * The size of the overview at level 'n' is computed as : ovr_size =
>>     raster_size / 2^n , whereas it should be ovr_size = ceil(
>>     raster_size / float(2^n) )
>>
>
> Hum, any reason to particularly round to the upper value rather than  
> the lower
> value ? The JP2ECW driver does the rounding to the lower value too.

The upper method is defined by the JPEG2000 norm (Annex B of the Part1)

>
>>
>> I am using GDAL 1.10.1 and OpenJpeg 2.0.
>> Is it relevant to report a bug on this topic ?
>
> IMHO the test case seems to be a bit too artificial to justify any change,
> unless there are real world cases where that would cause issues.
>
Yes it is not a real case but it is a conformance data which allow to  
define if a decoder is JPEG decoding compliant. It helps to verify  
that real less complicated case will be handled properly. For example  
we can see that JP2ECW is not compliant about this point.

Micka?l
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>



----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.



From lcelati at latitude-geosystems.com  Mon May 19 16:28:42 2014
From: lcelati at latitude-geosystems.com (dandrigo)
Date: Mon, 19 May 2014 16:28:42 -0700 (PDT)
Subject: [gdal-dev] qgis 2.2 : problem to visualize postgis raster layer
Message-ID: <1400542121957-5141320.post@n6.nabble.com>

Hello,



I imported raster into my postgis db without problem. But regarding the
visualization of the data in qgis i have an error message. This following
message appears when i try to load pg raster data from the qgis db manager.
I paste below the screenshot :

SS_error_pg_rasrter.JPG
<http://osgeo-org.1560.x6.nabble.com/file/n5141320/SS_error_pg_rasrter.JPG>  

I'm really surprised by the error message appearing in qgis. What's the
meaning of this connexion problem? i succeed without problem in connecting
and loading postgis layer vector data in qgis. My problem concerns only pg
raster data...

In advance thank you to throw light for me in order to visualize pg raster
data. 






--
View this message in context: http://osgeo-org.1560.x6.nabble.com/qgis-2-2-problem-to-visualize-postgis-raster-layer-tp5141320.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From woodbri at swoodbridge.com  Mon May 19 17:22:12 2014
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 19 May 2014 20:22:12 -0400
Subject: [gdal-dev] Question on scaling between tif and vrt
In-Reply-To: <201405192348.02077.even.rouault@mines-paris.org>
References: <537A7AAE.2050400@swoodbridge.com>
	<201405192348.02077.even.rouault@mines-paris.org>
Message-ID: <537AA034.1000501@swoodbridge.com>

Even,

Thanks!

I didn't set his up, I just inherited the maintenance of it and I'm just 
trying to understand how it works and eventually make changes to it and 
fix some of the processing that does not seem to be grounded in a good 
process, which is looking like more and more of the code. :(

I get the point about the color table values need to be values from 0-n 
and you need 0-n entries in the color table.  Or you need to use LUT 
like you explained before.

What I was trying to understand is more along the lines of

input tif is Int16
vrt is declared as Byte

How does GDAL deal with this? There are no errors or warnings. gdalinfo 
is reporting a Byte range of values for the vrt. I'm wondering how it is 
interpreting an arbitrary Int16 value into a Byte?

So some of the obvious guesses are:

1. it is scaling them (you say no on this)
2. it is reading the Int16 and only using only the low or high order 
byte as the value?
3. something else?

Thank you for your patience with all my questions.

-Steve

On 5/19/2014 5:48 PM, Even Rouault wrote:
> Le lundi 19 mai 2014 23:42:06, Stephen Woodbridge a ?crit :
>> Hi all,
>>
>> I have a .tif file with -ot Int16 and an associated .vrt file that is
>> applying a color palette and is type Byte.
>>
>> How does if decide on how to scale the pixel values?
>>
>> Does it compute the range and then just scale and offset that values to
>> the new range?
>
> Not completely sure to understand what you really mean, but I'd say no scaling
> nor offseting.
> Color table is plain and stupid. You need to provide as many entries in the
> color tables as values in the input file, and the index of the color table must
> match the value of the pixel in the source band. And this is not possible in
> your case since the minimum value is negative (as said in previous related
> discussion), and the color table entries are indexed starting at 0.
>
> --> use LUT
>
>>
>> Below are the gdalinfo for each.
>>
>> Thanks,
>>     -Steve
>>
>> gdalinfo -stats MODIS_SST_EAST-201405190900.tif
>> Driver: GTiff/GeoTIFF
>> Files: MODIS_SST_EAST-201405190900.tif
>>          MODIS_SST_EAST-201405190900.tif.aux.xml
>> Size is 8800, 6600
>> Coordinate System is:
>> GEOGCS["WGS 84",
>>       DATUM["WGS_1984",
>>           SPHEROID["WGS 84",6378137,298.257223563,
>>               AUTHORITY["EPSG","7030"]],
>>           AUTHORITY["EPSG","6326"]],
>>       PRIMEM["Greenwich",0],
>>       UNIT["degree",0.0174532925199433],
>>       AUTHORITY["EPSG","4326"]]
>> Origin = (-125.000000000000000,54.931818190930159)
>> Pixel Size = (0.009090548548341,-0.009058565004476)
>> Metadata:
>>     AREA_OR_POINT=Area
>> Image Structure Metadata:
>>     INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (-125.0000000,  54.9318182) (125d 0' 0.00"W, 54d55'54.55"N)
>> Lower Left  (-125.0000000,  -4.8547108) (125d 0' 0.00"W,  4d51'16.96"S)
>> Upper Right ( -45.0031728,  54.9318182) ( 45d 0'11.42"W, 54d55'54.55"N)
>> Lower Right ( -45.0031728,  -4.8547108) ( 45d 0'11.42"W,  4d51'16.96"S)
>> Center      ( -85.0015864,  25.0385537) ( 85d 0' 5.71"W, 25d 2'18.79"N)
>> Band 1 Block=8800x1 Type=Int16, ColorInterp=Gray
>>     Min=-10004.000 Max=6035.000
>>     Minimum=-10004.000, Maximum=6035.000, Mean=-673.234, StdDev=268.660
>>     Overviews: 4400x3300, 2200x1650, 1100x825, 550x413, 275x207
>>     Metadata:
>>       STATISTICS_MAXIMUM=6035
>>       STATISTICS_MEAN=-673.23378700069
>>       STATISTICS_MINIMUM=-10004
>>       STATISTICS_STDDEV=268.66013989253
>>
>> gdalinfo -stats -noct MODIS_SST_EAST-201405190900.vrt
>> Driver: VRT/Virtual Raster
>> Files: /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.vrt
>>          /maps/wms/data/MODIS_SST_EAST/MODIS_SST_EAST-201405190900.tif
>> Size is 8800, 6600
>> Coordinate System is `'
>> Origin = (-125.000000000000000,54.936579299999998)
>> Pixel Size = (0.009090548056818,-0.009058564515152)
>> Corner Coordinates:
>> Upper Left  (-125.0000000,  54.9365793)
>> Lower Left  (-125.0000000,  -4.8499465)
>> Upper Right ( -45.0031771,  54.9365793)
>> Lower Right ( -45.0031771,  -4.8499465)
>> Center      ( -85.0015886,  25.0433164)
>> Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
>>     Minimum=0.000, Maximum=255.000, Mean=1.885, StdDev=21.797
>>     Metadata:
>>       STATISTICS_MAXIMUM=255
>>       STATISTICS_MEAN=1.8849891356749
>>       STATISTICS_MINIMUM=0
>>       STATISTICS_STDDEV=21.796961177215
>>     Color Table (RGB with 256 entries)
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From etourigny.dev at gmail.com  Mon May 19 18:14:08 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 19 May 2014 22:14:08 -0300
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <loom.20140519T225345-324@post.gmane.org>
References: <201405192229.29577.even.rouault@mines-paris.org>
	<loom.20140519T225345-324@post.gmane.org>
Message-ID: <CA+TxYvOOBmnOKW6ufPvrVFeDW+t-98b2v2Oq=PJt_-=jogBMyg@mail.gmail.com>

+1 from me


On Mon, May 19, 2014 at 6:00 PM, Jukka Rahkonen
<jukka.rahkonen at mmmtike.fi>wrote:

> Even Rouault <even.rouault <at> mines-paris.org> writes:
>
> >
> > Hi,
> >
> > I think that the points raised in the discussion have been answered. I've
> just
> > done a minor edit to the RFC text to mention RFC 36, as rightly
> suggested by
> > Ivan.
> >
> > So:
> >
> > Motion : I move to adopt RFC 46: GDAL/OGR unification
> >
> >     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> >
> > Starting with my +1
>
> +0 because RFC goes too deeply into the code for me but I trust that Even
> has a good intention.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/efa87b84/attachment.html>

From warmerdam at pobox.com  Mon May 19 18:34:35 2014
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 19 May 2014 18:34:35 -0700
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <201405192229.29577.even.rouault@mines-paris.org>
References: <201405192229.29577.even.rouault@mines-paris.org>
Message-ID: <CA+YzLBdqNLrDuVKQ_axC4qu-NMGdNU5MUPzUgB_xS8_s5btcMg@mail.gmail.com>

+1 Frank



On Mon, May 19, 2014 at 1:29 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Hi,
>
> I think that the points raised in the discussion have been answered. I've
> just
> done a minor edit to the RFC text to mention RFC 36, as rightly suggested
> by
> Ivan.
>
> So:
>
> Motion : I move to adopt RFC 46: GDAL/OGR unification
>
>     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/25be84af/attachment.html>

From ychemin at gmail.com  Mon May 19 18:56:06 2014
From: ychemin at gmail.com (Yann Chemin)
Date: Tue, 20 May 2014 07:26:06 +0530
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <201405192229.29577.even.rouault@mines-paris.org>
References: <201405192229.29577.even.rouault@mines-paris.org>
Message-ID: <CALTpO6DivFqfd5rR9H0WX2hz8dJR7gCBcut5EXNyHUyvFwUsEQ@mail.gmail.com>

+1, much needed

On 20/05/2014, Even Rouault <even.rouault at mines-paris.org> wrote:
> Hi,
>
> I think that the points raised in the discussion have been answered. I've
> just
> done a minor edit to the RFC text to mention RFC 36, as rightly suggested by
>
> Ivan.
>
> So:
>
> Motion : I move to adopt RFC 46: GDAL/OGR unification
>
>     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
----

From david.fawcett at gmail.com  Mon May 19 19:37:49 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Mon, 19 May 2014 21:37:49 -0500
Subject: [gdal-dev] gdal_translate .vrt issue
Message-ID: <CAF7K3b8jEbk_5Ou5QjhbahBC6_Gwo90Z2nYXUcEK0Zg_vP4XEQ@mail.gmail.com>

I am using gdal_translate and a .vrt to take 115 .jp2 files from the USGS,
pull them together and then export a lower resolution .jp2.

This is with GDAL 1.10 on OSX.
gdalinfo --version
GDAL 1.10.1, released 2013/08/26

When I run gdal_translate, it gets about 30% of the way through the process
and errors out saying that it can't open one of the .j2w files.  When I run
gdalinfo on the file, I can open it, and if I run gdal_translate on just
that file, I can successfully export a reduced resolution copy.

The output of gdalinfo is here:
https://gist.github.com/fawcett/beead31741e24394b38e

I can also load the .vrt image into QGIS 2.2 and it loads (slowly of
course).

gdal_translate img_index.vrt mpls34.jp2 -outsize 10% 10% -of JP2OpenJPEG
-co QUALITY=25 -epo
Input file size is 45000, 65000
0...10...20.ERROR 4:
CSLLoad2("/Users/david/projects/mpls_watersheds/data/15TVK830815_201203_0x3000m_CL_1/15TVK830815_201203_0x3000m_CL_1.j2w")
failed: unable to open file.
ERROR 4:
`/Users/david/projects/mpls_watersheds/data/15TVK830830_201203_0x3000m_CL_1/15TVK830830_201203_0x3000m_CL_1.jp2'
not recognised as a supported file format.

gdalinfo 15TVK830815_201203_0x3000m_CL_1.jp2
Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
Files: 15TVK830815_201203_0x3000m_CL_1.jp2
       15TVK830815_201203_0x3000m_CL_1.j2w
Size is 5000, 5000
Coordinate System is:
PROJCS["NAD83 / UTM zone 15N",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-93],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26915"]]
Origin = (483000.000000000000000,4983000.000000000000000)
Pixel Size = (0.300000000000012,-0.300000000000186)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  483000.000, 4983000.000) ( 93d12'56.50"W, 45d 0' 0.87"N)
Lower Left  (  483000.000, 4981500.000) ( 93d12'56.32"W, 44d59'12.26"N)
Upper Right (  484500.000, 4983000.000) ( 93d11'47.99"W, 45d 0' 1.00"N)
Lower Right (  484500.000, 4981500.000) ( 93d11'47.82"W, 44d59'12.39"N)
Center      (  483750.000, 4982250.000) ( 93d12'22.16"W, 44d59'36.63"N)
Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
  Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
  Overviews: arbitrary
Band 2 Block=1024x1024 Type=Byte, ColorInterp=Green
  Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
  Overviews: arbitrary
Band 3 Block=1024x1024 Type=Byte, ColorInterp=Blue
  Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
  Overviews: arbitrary

The .vrt file contents are here:
https://gist.github.com/fawcett/c8cd5d271b0a89e67779

Does anyone have a suggestion on how to troubleshoot this?  I am wondering
if I am just running out of memory.

Thanks,

David.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140519/11afd576/attachment.html>

From p.baumann at jacobs-university.de  Tue May 20 00:26:54 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Tue, 20 May 2014 09:26:54 +0200
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
	addgeoreferencing
In-Reply-To: <85189FC0E08D4A5A8324E6ED2ED51CD1@OfficeHP>
References: <201405102221.50572.even.rouault@mines-paris.org>	<201405122159.31328.even.rouault@mines-paris.org>	<loom.20140512T225741-304@post.gmane.org><201405122318.15978.even.rouault@mines-paris.org><53713F55.1030506@jacobs-university.de>
	<53713F75.6020501@jacobs-university.de>
	<85189FC0E08D4A5A8324E6ED2ED51CD1@OfficeHP>
Message-ID: <537B03BE.50604@jacobs-university.de>

On 05/19/2014 10:50 PM, Carl Reed wrote:
> Thanks, Peter.
>
> Also, FYI, version 2 of the OGC GML in JP2000 (GMLJP2) candidate standard is 
> in an OGC adoption vote until June 29.  There is also an OGC/ISO discussion 
> this week as to whether this OGC standards should also become an ISO standard.

Just for clarification: this includes GMLCOV and WCS.
cheers,
Peter


>
> Cheers
>
> Carl
>
>
> -----Original Message----- From: Peter Baumann
> Sent: Monday, May 12, 2014 3:39 PM
> To: Even Rouault ; gdal-dev at lists.osgeo.org
> Cc: Jukka Rahkonen ; standards at lists.osgeo.org
> Subject: Re: [OSGeo-Standards] [gdal-dev] Idea: GeoTIFF box in JPEG to 
> addgeoreferencing
>
> PS: not sure all on this list are aware of this overview page:
> http://external.opengeospatial.org/twiki_public/CoveragesDWG/CoveragesBigPicture
>
> -Peter
>
>
> On 05/12/2014 11:38 PM, Peter Baumann wrote:
>> Hi all,
>>
>> just saw this, thought I'd chime in being the editor of GMLCOV :)
>> Any questions, I'll gladly try to answer, I'm just on the road currently, so 
>> expect a delay of a day or so.
>>
>> Trying to respond to what has been raised below:
>>
>> On 05/12/2014 11:18 PM, Even Rouault wrote:
>>> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>>>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>>>
>>>> ...
>>>>
>>>>>> In light of this, it may be better to use an xml or textual
>>>>>> representation and embed it inside an XMP block, which is supported
>>>>>> for many formats[1]. Also it would allow for easier human-reading.
>>>>> Yes, that's one possibility. Which comes back to GMLJP2 unless there are
>>>> other
>>>>
>>>>> standards...
>>>>>
>>>>> I'd want to build on something that is a "real" standard or a de-facto
>>>>> standard, but not reinvent everything from scratch.
>>>> What GMLJP2 gives as a bonus is the axis order trouble
>>
>> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each coverage 
>> has a Native CRS which is defined via an OGC URI (which, in the case of EPSG, 
>> refers to the OGP maintained database). In the CRS definition the axis is 
>> given unambiguously.
>>
>> If you don't want to go to that database, use the axisLabels attribute in the 
>> Envelope, it lists axes in their proper sequence.
>>
>>
>>>> and not totally
>>>> clear interpretation if origin is in the centre (probably it is) or in the
>>>> corner of a pixel,
>>
>> naively, GMLCOV follows the pixel-in center interpretation. However, 
>> encodings may override this, such as GeoTIFF (see the pertaining adopted spec 
>> [1]).
>>
>> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
>>
>>
>>>> and rectified grid does not support ground control
>>>> points.
>>
>> yes, because it is rectified. If you want more degree of freedom do not use 
>> RectifiedGridCoverage but ReferenceableGridCoverage. In conjunction with GML 
>> 3.3 ( a compatible enhancement of GML 3.2.1) this gives you irregular and 
>> warped grids. We're not completely done, though, and would be glad about your 
>> support in some advanced issues. Note that this work is all voluntary and 
>> relies on some project financing to be done. Up to now, EC and ESA have been 
>> generous, and so we are going ahead step by step.
>>
>>
>>>> Thus GMLJP2 is at least not better in everything, it has also
>>>> drawbacks.
>>> Hi Jukka,
>>>
>>> Yes, for all your above reasons, I would prefer to avoid it.
>>
>> so which ones are remaining, following the clarification you mention below?
>>
>> cheers,
>> Peter
>>
>>> Although the axis order trouble (the one of EPSG) and interpretation of origin
>>> (pixel center) should be mostly clarified with the revised version.
>>> As far as ground countrol points are concerned, I've not really looked at the
>>> capabilities of GMLCov, so perhaps there's something in it for that.
>>> Otherwise, that would be indeed a drawback.
>>>
>>>> -Jukka Rahkonen-
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From lcelati at latitude-geosystems.com  Tue May 20 00:46:27 2014
From: lcelati at latitude-geosystems.com (dandrigo)
Date: Tue, 20 May 2014 00:46:27 -0700 (PDT)
Subject: [gdal-dev] qgis 2.2 : gdal error message for display postgis
	raster layer
In-Reply-To: <1400542121957-5141320.post@n6.nabble.com>
References: <1400542121957-5141320.post@n6.nabble.com>
Message-ID: <1400571987294-5141357.post@n6.nabble.com>

Following to my previous message, the host value seems to be not specified. 

COuld you tell me how i can specified this host value in order to load
postgis raster ? 

Thanks. 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/qgis-2-2-gdal-error-message-for-display-postgis-raster-layer-tp5141320p5141357.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From landa.martin at gmail.com  Tue May 20 00:42:16 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 20 May 2014 09:42:16 +0200
Subject: [gdal-dev] ogr python pg GetLayerByName / CreateLayer
Message-ID: <CA+Ei1OcHKsmG7Qd0mMP+59W12u9KTptzCCAOkK5_ZvBoWS9yJA@mail.gmail.com>

Hi all,

sample script to reproduce:

"""
from osgeo import ogr

odrv = ogr.GetDriverByName("PostgreSQL")
ods = odrv.Open("PG:dbname=pgis_vfr", True)
layerName = 'obce'
if not ods.GetLayerByName(layerName):
    print "Layer not found, creating..."
    ods.CreateLayer(layerName, None, ogr.wkbPoint, [])
else:
    print "Layer found"

ods.SyncToDisk()
ods.Destroy()
"""

1) first run - table exists in DB

Layer found

2) drop table obce;

3) second run

ERROR 1: No field definitions found for 'obce', is it a table?
<- this goes from GetLayerByName() / ReadTableDefinition()
<- why report it as an error, I just what to check if layer exists...

Layer not found, creating...

Using GDAL 1.12dev, PostGIS 2.1.

Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Tue May 20 01:29:33 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 10:29:33 +0200
Subject: [gdal-dev] ogr python pg GetLayerByName / CreateLayer
In-Reply-To: <CA+Ei1OcHKsmG7Qd0mMP+59W12u9KTptzCCAOkK5_ZvBoWS9yJA@mail.gmail.com>
References: <CA+Ei1OcHKsmG7Qd0mMP+59W12u9KTptzCCAOkK5_ZvBoWS9yJA@mail.gmail.com>
Message-ID: <1400574573.537b126db0d5b@imp.free.fr>

Selon Martin Landa <landa.martin at gmail.com>:

> Hi all,
>
> sample script to reproduce:
>
> """
> from osgeo import ogr
>
> odrv = ogr.GetDriverByName("PostgreSQL")
> ods = odrv.Open("PG:dbname=pgis_vfr", True)
> layerName = 'obce'
> if not ods.GetLayerByName(layerName):
>     print "Layer not found, creating..."
>     ods.CreateLayer(layerName, None, ogr.wkbPoint, [])
> else:
>     print "Layer found"
>
> ods.SyncToDisk()
> ods.Destroy()
> """
>
> 1) first run - table exists in DB
>
> Layer found
>
> 2) drop table obce;
>
> 3) second run
>
> ERROR 1: No field definitions found for 'obce', is it a table?
> <- this goes from GetLayerByName() / ReadTableDefinition()
> <- why report it as an error, I just what to check if layer exists...

Since that path is also taken when discovering existing spatial layers, this
could make some sense at the time where geometry_columns was a table and not a
view as in PostGIS 2.X now, and you could imagine some inconsistency where a
table would remain declared in geometry_columns but did not exist.

>
> Layer not found, creating...
>
> Using GDAL 1.12dev, PostGIS 2.1.

Is it new to the -dev version ? I don't think so, but anyway, feel free to
change the error into a CPLDebug message. The error seems to be emitted there
http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgtablelayer.cpp#L380

>
> Thanks, Martin
>
> --
> Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From even.rouault at mines-paris.org  Tue May 20 01:37:17 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 10:37:17 +0200
Subject: [gdal-dev] gdal_translate .vrt issue
In-Reply-To: <CAF7K3b8jEbk_5Ou5QjhbahBC6_Gwo90Z2nYXUcEK0Zg_vP4XEQ@mail.gmail.com>
References: <CAF7K3b8jEbk_5Ou5QjhbahBC6_Gwo90Z2nYXUcEK0Zg_vP4XEQ@mail.gmail.com>
Message-ID: <1400575037.537b143d172ad@imp.free.fr>

Selon David Fawcett <david.fawcett at gmail.com>:

> I am using gdal_translate and a .vrt to take 115 .jp2 files from the USGS,
> pull them together and then export a lower resolution .jp2.
>
> This is with GDAL 1.10 on OSX.
> gdalinfo --version
> GDAL 1.10.1, released 2013/08/26
>
> When I run gdal_translate, it gets about 30% of the way through the process
> and errors out saying that it can't open one of the .j2w files.  When I run
> gdalinfo on the file, I can open it, and if I run gdal_translate on just
> that file, I can successfully export a reduced resolution copy.
>
> The output of gdalinfo is here:
> https://gist.github.com/fawcett/beead31741e24394b38e
>
> I can also load the .vrt image into QGIS 2.2 and it loads (slowly of
> course).

Even when you zoom out at 10% like your gdal_translate command ?

>
> gdal_translate img_index.vrt mpls34.jp2 -outsize 10% 10% -of JP2OpenJPEG
> -co QUALITY=25 -epo
> Input file size is 45000, 65000
> 0...10...20.ERROR 4:
>
CSLLoad2("/Users/david/projects/mpls_watersheds/data/15TVK830815_201203_0x3000m_CL_1/15TVK830815_201203_0x3000m_CL_1.j2w")
> failed: unable to open file.
> ERROR 4:
>
`/Users/david/projects/mpls_watersheds/data/15TVK830830_201203_0x3000m_CL_1/15TVK830830_201203_0x3000m_CL_1.jp2'
> not recognised as a supported file format.
>
> gdalinfo 15TVK830815_201203_0x3000m_CL_1.jp2
> Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
> Files: 15TVK830815_201203_0x3000m_CL_1.jp2
>        15TVK830815_201203_0x3000m_CL_1.j2w
> Size is 5000, 5000
> Coordinate System is:
> PROJCS["NAD83 / UTM zone 15N",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-93],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","26915"]]
> Origin = (483000.000000000000000,4983000.000000000000000)
> Pixel Size = (0.300000000000012,-0.300000000000186)
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  483000.000, 4983000.000) ( 93d12'56.50"W, 45d 0' 0.87"N)
> Lower Left  (  483000.000, 4981500.000) ( 93d12'56.32"W, 44d59'12.26"N)
> Upper Right (  484500.000, 4983000.000) ( 93d11'47.99"W, 45d 0' 1.00"N)
> Lower Right (  484500.000, 4981500.000) ( 93d11'47.82"W, 44d59'12.39"N)
> Center      (  483750.000, 4982250.000) ( 93d12'22.16"W, 44d59'36.63"N)
> Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
>   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
>   Overviews: arbitrary
> Band 2 Block=1024x1024 Type=Byte, ColorInterp=Green
>   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
>   Overviews: arbitrary
> Band 3 Block=1024x1024 Type=Byte, ColorInterp=Blue
>   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
>   Overviews: arbitrary
>
> The .vrt file contents are here:
> https://gist.github.com/fawcett/c8cd5d271b0a89e67779
>
> Does anyone have a suggestion on how to troubleshoot this?  I am wondering
> if I am just running out of memory.

I guess you might rather run out of file descriptors. What is the default limit
on Mac : 1024 as on Linux ?
For each opened JP2 by the OpenJPEG driver, it maintains a file descriptor per
overview level (and for the main level). So in your above case, 6 file
descriptors.
The VRT mechanism shouldn't open simultaneously more than
GDAL_MAX_DATASET_POOL_SIZE=100 datasets
(http://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdalproxypool.cpp#L313).
100 * 6 = 600... So if you have JP2 images bigger than the one you sampled, you
might have more overview levels. Or possibly the limit on Mac is lower than
1024.
You might want to try setting the GDAL_MAX_DATASET_POOL_SIZE configuration
option/environmenet variable to a lower value, let's say 10, and see if it works
better.

Even



From authmanc at Mathematik.Uni-Marburg.de  Tue May 20 01:21:43 2014
From: authmanc at Mathematik.Uni-Marburg.de (Christian Authmann)
Date: Tue, 20 May 2014 10:21:43 +0200
Subject: [gdal-dev] Missing include in MSG driver
Message-ID: <537B1097.4070102@mathematik.uni-marburg.de>

Hello,

I tried to compile GDAL 1.11.0 with the meteosat 2 (MSG) driver, but 
compilation failed in

frmts/msg/msgcommand.cpp

with a message stating that sprintf() was unknown. Adding

#include <cstdio>

at the top of the file fixed the problem. A trivial patch is attached; I 
release it under the license of the original file in the hopes that a 
dev will commit it.


Thanks!
-- 
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg
-------------- next part --------------
--- a/frmts/msg/msgcommand.cpp	2014-04-16 22:04:48.000000000 +0200
+++ b/frmts/msg/msgcommand.cpp	2014-05-19 17:00:51.322992001 +0200
@@ -29,6 +29,7 @@
 
 #include "msgcommand.h"
 #include <cstdlib>
+#include <cstdio>
 using namespace std;
 
 #ifdef _WIN32

From guillaume.pasero at c-s.fr  Tue May 20 01:47:21 2014
From: guillaume.pasero at c-s.fr (Guillaume Pasero)
Date: Tue, 20 May 2014 10:47:21 +0200
Subject: [gdal-dev] OpenJPEG driver
In-Reply-To: <201405192001.48688.even.rouault@mines-paris.org>
References: <537A2B96.7030809@c-s.fr>
	<201405192001.48688.even.rouault@mines-paris.org>
Message-ID: <537B1699.8070004@c-s.fr>

Hi Even,

Le 19/05/2014 20:01, Even Rouault a ?crit :
> Guillaume,
>
>> I am using the OpenJPEG driver from GDAL and I noticed some differences
>> with the behaviour of an other OpenJPEG "driver" that I used before in
>> the library Orfeo ToolBox. The GDAL driver fails to pass a conformance
>> test : using the input file "jpeg2000_conf_p1_06.j2k"
> Are you refering to
> http://code.google.com/p/openjpeg/source/browse/data/input/conformance/p1_06.j2k
> ? I see this is a 12 x 12 pixel image ...
Yes, this is a 12x12 image.
>
>> , reading the
>> resolution level 4 (zero being the original image) , it should produce a
>> 1x1 image with the pixel value [195, 36, 100].
>>
>> The behaviour of GDAL drivers differs on the following points :
>>
>>    * The number of overviews detected for a jpeg2000 dataset is limited
>>      (no overview if its dimensions are both lower than 256). Even if the
>>      the overviews can be computed by GDAL, it won't use the wavelet
>>      coefficients for the highest levels, but rather perform the default
>>      nearest neighbor interpolation.
> Yes, this is to avoid exposing overviews that are too small and do not make
> pratical sense. Other JPEG2000 drivers, such as JP2KAK or JP2ECW, have similar
> logic.
>
>>    * The size of the overview at level 'n' is computed as : ovr_size =
>>      raster_size / 2^n , whereas it should be ovr_size = ceil(
>>      raster_size / float(2^n) )
>>
> Hum, any reason to particularly round to the upper value rather than the lower
> value ? The JP2ECW driver does the rounding to the lower value too.
This rounding to the upper value is done in OpenJpeg (for instance : 
src/lib/openjp2/j2k.c:7648 ). I think it is also used to compute the 
maximum number of resolutions. I am not sure if using a lower-value 
rounding in GDAL driver has an impact on the decompressed images (other 
than a possible crop).
>
>> I am using GDAL 1.10.1 and OpenJpeg 2.0.
>> Is it relevant to report a bug on this topic ?
> IMHO the test case seems to be a bit too artificial to justify any change,
> unless there are real world cases where that would cause issues.
I agree that this is a corner case, and I guess you would like to keep a 
consistent behaviour between the different jpeg2000 drivers. My worry is 
more about the compliance with the standard.
>
> Even
>


-- 
<www.c-s.fr> 	*Guillaume PASERO*
Ing?nieur d'?tudes et d?veloppement
*Business Unit E-SPACE & Geo Information* 
<https://thor.si.c-s.fr/blogs/cs-blogs-business/>*- D?partement 
APPLICATIONS*

*CS Syst?mes d'Information*
Parc de la Grande Plaine - 5, Rue Brindejonc des Moulinais - BP 15872
31506 Toulouse Cedex 05 - FRANCE
+33 561 17 64 21 - guillaume.pasero at c-s.fr

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140520/aa5438c0/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logo_cs.png
Type: image/png
Size: 19066 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140520/aa5438c0/attachment-0001.png>

From even.rouault at mines-paris.org  Tue May 20 01:48:52 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 10:48:52 +0200
Subject: [gdal-dev] OpenJPEG driver
In-Reply-To: <20140520002325.10152xi287qik2n1@messagerie.si.c-s.fr>
References: <537A2B96.7030809@c-s.fr>
	<201405192001.48688.even.rouault@mines-paris.org>
	<20140520002325.10152xi287qik2n1@messagerie.si.c-s.fr>
Message-ID: <1400575732.537b16f49e5c1@imp.free.fr>

Micka?l,

> >
> >>   * The size of the overview at level 'n' is computed as : ovr_size =
> >>     raster_size / 2^n , whereas it should be ovr_size = ceil(
> >>     raster_size / float(2^n) )
> >>
> >
> > Hum, any reason to particularly round to the upper value rather than
> > the lower
> > value ? The JP2ECW driver does the rounding to the lower value too.
>
> The upper method is defined by the JPEG2000 norm (Annex B of the Part1)

ok, and that's what openjpeg use too ? If so, we might have inconsistencies
between the expectations of the GDAL driver when it calls openjpeg API and the
dimensions reported by openjpeg. That might actually remind me of something I
saw at the time where the driver was developed.

>
> >
> >>
> >> I am using GDAL 1.10.1 and OpenJpeg 2.0.
> >> Is it relevant to report a bug on this topic ?
> >
> > IMHO the test case seems to be a bit too artificial to justify any change,
> > unless there are real world cases where that would cause issues.
> >
> Yes it is not a real case but it is a conformance data which allow to
> define if a decoder is JPEG decoding compliant. It helps to verify
> that real less complicated case will be handled properly. For example
> we can see that JP2ECW is not compliant about this point.

Yeah, but ultra pedantry compliance testing can lead to less performance or
other issues in real world cases so there's a trade-off to evaluate. The JP2ECW
driver is used happily in production even if it isn't strictly compliant on that
point.

Anyway if you want to provide a well tested patch for the issue related to
overview dimensions, please do so.
As far as reporting overview levels whose dimension is < 256, there's a risk of
consumming more file descriptors than reasonable (see
http://lists.osgeo.org/pipermail/gdal-dev/2014-May/039155.html). Unless you want
to restructure the driver a bit so that all overviews share the same file
descriptor. But I guess some saving/restoring of the position would have to be
implemented, so that you can switch arbitrarily between overviews. I remember
some headaches with openjpeg since it has a tendancy of segfaulting if you don't
reset it properly between requests of blocks made in random order, so I prefered
to assign a file descriptor to each overview level.

Best regards,

Even


From jukka.rahkonen at mmmtike.fi  Tue May 20 01:10:15 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 20 May 2014 08:10:15 +0000 (UTC)
Subject: [gdal-dev] OpenJPEG driver
References: <537A2B96.7030809@c-s.fr>
	<201405192001.48688.even.rouault@mines-paris.org>
	<20140520002325.10152xi287qik2n1@messagerie.si.c-s.fr>
Message-ID: <loom.20140520T100239-472@post.gmane.org>

SAVINAUD Micka??l <mickael.savinaud <at> c-s.fr> writes:


> > IMHO the test case seems to be a bit too artificial to justify any change,
> > unless there are real world cases where that would cause issues.
> >
> Yes it is not a real case but it is a conformance data which allow to  
> define if a decoder is JPEG decoding compliant. It helps to verify  
> that real less complicated case will be handled properly. For example  
> we can see that JP2ECW is not compliant about this point.

Is it a right place to run such tests with GDAL? I understand that JPEG2000
SDKs should pass the tests but isn't GDAL working one step further when it
is utilizing the data ripped off the j2k codestreams?

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Tue May 20 01:54:28 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 10:54:28 +0200
Subject: [gdal-dev] OpenJPEG driver
In-Reply-To: <537B1699.8070004@c-s.fr>
References: <537A2B96.7030809@c-s.fr>
	<201405192001.48688.even.rouault@mines-paris.org>
	<537B1699.8070004@c-s.fr>
Message-ID: <1400576068.537b184429f01@imp.free.fr>

Selon Guillaume Pasero <guillaume.pasero at c-s.fr>:

> Hi Even,
>
> Le 19/05/2014 20:01, Even Rouault a ??crit :
> > Guillaume,
> >
> >> I am using the OpenJPEG driver from GDAL and I noticed some differences
> >> with the behaviour of an other OpenJPEG "driver" that I used before in
> >> the library Orfeo ToolBox. The GDAL driver fails to pass a conformance
> >> test : using the input file "jpeg2000_conf_p1_06.j2k"
> > Are you refering to
> >
>
http://code.google.com/p/openjpeg/source/browse/data/input/conformance/p1_06.j2k
> > ? I see this is a 12 x 12 pixel image ...
> Yes, this is a 12x12 image.
> >
> >> , reading the
> >> resolution level 4 (zero being the original image) , it should produce a
> >> 1x1 image with the pixel value [195, 36, 100].
> >>
> >> The behaviour of GDAL drivers differs on the following points :
> >>
> >>    * The number of overviews detected for a jpeg2000 dataset is limited
> >>      (no overview if its dimensions are both lower than 256). Even if the
> >>      the overviews can be computed by GDAL, it won't use the wavelet
> >>      coefficients for the highest levels, but rather perform the default
> >>      nearest neighbor interpolation.
> > Yes, this is to avoid exposing overviews that are too small and do not make
> > pratical sense. Other JPEG2000 drivers, such as JP2KAK or JP2ECW, have
> similar
> > logic.
> >
> >>    * The size of the overview at level 'n' is computed as : ovr_size =
> >>      raster_size / 2^n , whereas it should be ovr_size = ceil(
> >>      raster_size / float(2^n) )
> >>
> > Hum, any reason to particularly round to the upper value rather than the
> lower
> > value ? The JP2ECW driver does the rounding to the lower value too.
> This rounding to the upper value is done in OpenJpeg (for instance :
> src/lib/openjp2/j2k.c:7648 ). I think it is also used to compute the
> maximum number of resolutions. I am not sure if using a lower-value
> rounding in GDAL driver has an impact on the decompressed images (other
> than a possible crop).
> >
> >> I am using GDAL 1.10.1 and OpenJpeg 2.0.
> >> Is it relevant to report a bug on this topic ?
> > IMHO the test case seems to be a bit too artificial to justify any change,
> > unless there are real world cases where that would cause issues.
> I agree that this is a corner case, and I guess you would like to keep a
> consistent behaviour between the different jpeg2000 drivers. My worry is
> more about the compliance with the standard.

Apart from the issue of the rounding of the overview dimensions, why should we
care much about overviews < 256 pixels ? Why is compliance with the standard so
important on that point, I mean, practically ? Is there a certification of GDAL
under way, where that could be important to get the certification ? If so, you
could still add some configuration option to the driver (that would default to
the current behaviour), that, if set, would expose all levels and make the
compliance tests pass...

> >
> > Even
> >
>
>
> --
> <www.c-s.fr> 	*Guillaume PASERO*
> Ing??nieur d'??tudes et d??veloppement
> *Business Unit E-SPACE & Geo Information*
> <https://thor.si.c-s.fr/blogs/cs-blogs-business/>*- D??partement
> APPLICATIONS*
>
> *CS Syst??mes d'Information*
> Parc de la Grande Plaine - 5, Rue Brindejonc des Moulinais - BP 15872
> 31506 Toulouse Cedex 05 - FRANCE
> +33 561 17 64 21 - guillaume.pasero at c-s.fr
>
>



From Emmanuel.Devys at ign.fr  Tue May 20 03:00:18 2014
From: Emmanuel.Devys at ign.fr (Emmanuel Devys)
Date: Tue, 20 May 2014 10:00:18 +0000
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
 addgeoreferencing
Message-ID: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F26@mailex1.ign.fr>

Peter, Carl et al
For the sake of clarification, I'd like to know in the " this includes GMLCOV and WCS." What does the "this" relates to ? (GMLJP2 ?, OGC/ISO discussion ? both ?
Moreover, I believe WCS is not directly related (or included) ... IMHO, the relationship between WCS (Web coverage Service) and these encodings (JPEG2000, JPEG, PNG) is only via the WCS encoding extensions (presently the GeoTIFF one, and the emergent JP2K one).

The version 2 of the OGC GML in JP2000 (GMLJP2) candidate is based on the GMLCOV schema.
My understanding of the OGC/ISO TC211 discussion is that it is related to the "Geo-enabled JP2K standard(s)", for which GMLJP2 is a candidate, being aware that there are others (such as the GeoTIFF box in JPEG2000 - also called GeoJ2(TM)).

Would there be additional discussion to bring GMLCOV to ISO TC211 (as an implementation standard for 19123) ?

Cheers
Emmanuel Devys

-----Message d'origine-----
De?: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Peter Baumann
Envoy??: mardi 20 mai 2014 09:27
??: Carl Reed; Even Rouault; gdal-dev at lists.osgeo.org
Cc?: Jukka Rahkonen; standards at lists.osgeo.org
Objet?: Re: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to addgeoreferencing

On 05/19/2014 10:50 PM, Carl Reed wrote:
> Thanks, Peter.
>
> Also, FYI, version 2 of the OGC GML in JP2000 (GMLJP2) candidate 
> standard is in an OGC adoption vote until June 29.  There is also an 
> OGC/ISO discussion this week as to whether this OGC standards should also become an ISO standard.

Just for clarification: this includes GMLCOV and WCS.
cheers,
Peter


>
> Cheers
>
> Carl
>
>
> -----Original Message----- From: Peter Baumann
> Sent: Monday, May 12, 2014 3:39 PM
> To: Even Rouault ; gdal-dev at lists.osgeo.org
> Cc: Jukka Rahkonen ; standards at lists.osgeo.org
> Subject: Re: [OSGeo-Standards] [gdal-dev] Idea: GeoTIFF box in JPEG to 
> addgeoreferencing
>
> PS: not sure all on this list are aware of this overview page:
> http://external.opengeospatial.org/twiki_public/CoveragesDWG/Coverages
> BigPicture
>
> -Peter
>
>
> On 05/12/2014 11:38 PM, Peter Baumann wrote:
>> Hi all,
>>
>> just saw this, thought I'd chime in being the editor of GMLCOV :) Any 
>> questions, I'll gladly try to answer, I'm just on the road currently, 
>> so expect a delay of a day or so.
>>
>> Trying to respond to what has been raised below:
>>
>> On 05/12/2014 11:18 PM, Even Rouault wrote:
>>> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>>>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>>>
>>>> ...
>>>>
>>>>>> In light of this, it may be better to use an xml or textual 
>>>>>> representation and embed it inside an XMP block, which is 
>>>>>> supported for many formats[1]. Also it would allow for easier human-reading.
>>>>> Yes, that's one possibility. Which comes back to GMLJP2 unless 
>>>>> there are
>>>> other
>>>>
>>>>> standards...
>>>>>
>>>>> I'd want to build on something that is a "real" standard or a 
>>>>> de-facto standard, but not reinvent everything from scratch.
>>>> What GMLJP2 gives as a bonus is the axis order trouble
>>
>> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each 
>> coverage has a Native CRS which is defined via an OGC URI (which, in 
>> the case of EPSG, refers to the OGP maintained database). In the CRS 
>> definition the axis is given unambiguously.
>>
>> If you don't want to go to that database, use the axisLabels 
>> attribute in the Envelope, it lists axes in their proper sequence.
>>
>>
>>>> and not totally
>>>> clear interpretation if origin is in the centre (probably it is) or 
>>>> in the corner of a pixel,
>>
>> naively, GMLCOV follows the pixel-in center interpretation. However, 
>> encodings may override this, such as GeoTIFF (see the pertaining 
>> adopted spec [1]).
>>
>> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
>>
>>
>>>> and rectified grid does not support ground control points.
>>
>> yes, because it is rectified. If you want more degree of freedom do 
>> not use RectifiedGridCoverage but ReferenceableGridCoverage. In 
>> conjunction with GML
>> 3.3 ( a compatible enhancement of GML 3.2.1) this gives you irregular 
>> and warped grids. We're not completely done, though, and would be 
>> glad about your support in some advanced issues. Note that this work 
>> is all voluntary and relies on some project financing to be done. Up 
>> to now, EC and ESA have been generous, and so we are going ahead step by step.
>>
>>
>>>> Thus GMLJP2 is at least not better in everything, it has also 
>>>> drawbacks.
>>> Hi Jukka,
>>>
>>> Yes, for all your above reasons, I would prefer to avoid it.
>>
>> so which ones are remaining, following the clarification you mention below?
>>
>> cheers,
>> Peter
>>
>>> Although the axis order trouble (the one of EPSG) and interpretation 
>>> of origin (pixel center) should be mostly clarified with the revised version.
>>> As far as ground countrol points are concerned, I've not really 
>>> looked at the capabilities of GMLCov, so perhaps there's something in it for that.
>>> Otherwise, that would be indeed a drawback.
>>>
>>>> -Jukka Rahkonen-
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

--
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882 "Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Emmanuel.Devys at ign.fr  Tue May 20 03:48:12 2014
From: Emmanuel.Devys at ign.fr (Emmanuel Devys)
Date: Tue, 20 May 2014 10:48:12 +0000
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
 addgeoreferencing
Message-ID: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F82@mailex1.ign.fr>

Thanks Peter, Carl, Even, Jukka et al for this interesting discussion on adding Georeferencing to image file standards, and capabilities of GMLJP2 2.0 (and its GMLCOV capabilities for rectified Grid coverages or Georeferenceable Grid coverages), GeoJP2 ...

I appreciate this idea and action from Even to use the GeoTIFF Box mechanism (as documented in the GeoJP2 as explained below) for other formats (than JP2K format) such as native JPEG, PNG ... This is outside the scope of the Geo-enabled JP2K (and GMLJP2), but of significant interest with PNG or JPG data.

However, if used with JP2 format (specified in ISO 15444-1), this GeoJP2 (TM) mechanism is an alternative to the GMLJP2 standard. A simple one, with no multi-image capability, no annotation (in GML or any other XML like, such as SVG) ... but widely supported for providing a Geo-enabled capability to JP2 data. The GMLJP2 standard is based on the Gridded Coverage model and GML schema in order to provide this capability, allowing multi-image, annotations ...

The new version 2.0 of GMLJP2 (under OGC ballot until June 29) is based on GMLCOV schema.
Discussions are now initiated between OGC and ISO (TC211 - Geographic information) on the " Geo-enabled JP2K" topic and standards. Whether GMLJP2 and the GeoTIFF Box in JP2 is to be discussed. There are other alternatives, one being the auxiliary World files (.j2w) with limited information (only 6 parameters, no CRS) , another one being the BIIF encapsulation (ISO 12087-5), also called NITF in USA - North America and its Geo extension to Geo-reference "raw JP2K codestream" (jc2 format) - but the resulting file is no longer a .jp2 file, but a .ntf file.

Should further actions from OGC, ISO, and  GDAL and OSGeo communities be initiated ? IMHO this is an open issue ...

Emmanuel
 
-----Message d'origine-----
De?: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Peter Baumann
Envoy??: mardi 20 mai 2014 09:27
??: Carl Reed; Even Rouault; gdal-dev at lists.osgeo.org
Cc?: Jukka Rahkonen; standards at lists.osgeo.org
Objet?: Re: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to addgeoreferencing

On 05/19/2014 10:50 PM, Carl Reed wrote:
> Thanks, Peter.
>
> Also, FYI, version 2 of the OGC GML in JP2000 (GMLJP2) candidate 
> standard is in an OGC adoption vote until June 29.  There is also an 
> OGC/ISO discussion this week as to whether this OGC standards should also become an ISO standard.

Just for clarification: this includes GMLCOV and WCS.
cheers,
Peter


>
> Cheers
>
> Carl
>
>
> -----Original Message----- From: Peter Baumann
> Sent: Monday, May 12, 2014 3:39 PM
> To: Even Rouault ; gdal-dev at lists.osgeo.org
> Cc: Jukka Rahkonen ; standards at lists.osgeo.org
> Subject: Re: [OSGeo-Standards] [gdal-dev] Idea: GeoTIFF box in JPEG to 
> addgeoreferencing
>
> PS: not sure all on this list are aware of this overview page:
> http://external.opengeospatial.org/twiki_public/CoveragesDWG/Coverages
> BigPicture
>
> -Peter
>
>
> On 05/12/2014 11:38 PM, Peter Baumann wrote:
>> Hi all,
>>
>> just saw this, thought I'd chime in being the editor of GMLCOV :) Any 
>> questions, I'll gladly try to answer, I'm just on the road currently, 
>> so expect a delay of a day or so.
>>
>> Trying to respond to what has been raised below:
>>
>> On 05/12/2014 11:18 PM, Even Rouault wrote:
>>> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>>>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>>>
>>>> ...
>>>>
>>>>>> In light of this, it may be better to use an xml or textual 
>>>>>> representation and embed it inside an XMP block, which is 
>>>>>> supported for many formats[1]. Also it would allow for easier human-reading.
>>>>> Yes, that's one possibility. Which comes back to GMLJP2 unless 
>>>>> there are
>>>> other
>>>>
>>>>> standards...
>>>>>
>>>>> I'd want to build on something that is a "real" standard or a 
>>>>> de-facto standard, but not reinvent everything from scratch.
>>>> What GMLJP2 gives as a bonus is the axis order trouble
>>
>> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each 
>> coverage has a Native CRS which is defined via an OGC URI (which, in 
>> the case of EPSG, refers to the OGP maintained database). In the CRS 
>> definition the axis is given unambiguously.
>>
>> If you don't want to go to that database, use the axisLabels 
>> attribute in the Envelope, it lists axes in their proper sequence.
>>
>>
>>>> and not totally
>>>> clear interpretation if origin is in the centre (probably it is) or 
>>>> in the corner of a pixel,
>>
>> naively, GMLCOV follows the pixel-in center interpretation. However, 
>> encodings may override this, such as GeoTIFF (see the pertaining 
>> adopted spec [1]).
>>
>> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
>>
>>
>>>> and rectified grid does not support ground control points.
>>
>> yes, because it is rectified. If you want more degree of freedom do 
>> not use RectifiedGridCoverage but ReferenceableGridCoverage. In 
>> conjunction with GML
>> 3.3 ( a compatible enhancement of GML 3.2.1) this gives you irregular 
>> and warped grids. We're not completely done, though, and would be 
>> glad about your support in some advanced issues. Note that this work 
>> is all voluntary and relies on some project financing to be done. Up 
>> to now, EC and ESA have been generous, and so we are going ahead step by step.
>>
>>
>>>> Thus GMLJP2 is at least not better in everything, it has also 
>>>> drawbacks.
>>> Hi Jukka,
>>>
>>> Yes, for all your above reasons, I would prefer to avoid it.
>>
>> so which ones are remaining, following the clarification you mention below?
>>
>> cheers,
>> Peter
>>
>>> Although the axis order trouble (the one of EPSG) and interpretation 
>>> of origin (pixel center) should be mostly clarified with the revised version.
>>> As far as ground countrol points are concerned, I've not really 
>>> looked at the capabilities of GMLCov, so perhaps there's something in it for that.
>>> Otherwise, that would be indeed a drawback.
>>>
>>>> -Jukka Rahkonen-
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

--
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882 "Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From dmorissette at mapgears.com  Tue May 20 05:49:04 2014
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 20 May 2014 08:49:04 -0400
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <201405192229.29577.even.rouault@mines-paris.org>
References: <201405192229.29577.even.rouault@mines-paris.org>
Message-ID: <537B4F40.8000909@mapgears.com>

+1

Daniel


On 14-05-19 4:29 PM, Even Rouault wrote:
> Hi,
>
> I think that the points raised in the discussion have been answered. I've just
> done a minor edit to the RFC text to mention RFC 36, as rightly suggested by
> Ivan.
>
> So:
>
> Motion : I move to adopt RFC 46: GDAL/OGR unification
>
>      http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
> Starting with my +1
>
> Best regards,
>
> Even
>


-- 
Daniel Morissette
T: +1 418-696-5056 #201
http://www.mapgears.com/
Provider of Professional MapServer Support since 2000

From lhomme.xavier at gmail.com  Tue May 20 06:43:15 2014
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Tue, 20 May 2014 15:43:15 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <537B4F40.8000909@mapgears.com>
References: <201405192229.29577.even.rouault@mines-paris.org>
	<537B4F40.8000909@mapgears.com>
Message-ID: <CACqzBMx1xajn9zrh30SyMFpWC0P_LPVym-8b1dzqFH1WBRJTbg@mail.gmail.com>

+1
xl


2014-05-20 14:49 GMT+02:00 Daniel Morissette <dmorissette at mapgears.com>:

> +1
>
> Daniel
>
>
> On 14-05-19 4:29 PM, Even Rouault wrote:
>
>> Hi,
>>
>> I think that the points raised in the discussion have been answered. I've
>> just
>> done a minor edit to the RFC text to mention RFC 36, as rightly suggested
>> by
>> Ivan.
>>
>> So:
>>
>> Motion : I move to adopt RFC 46: GDAL/OGR unification
>>
>>      http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>>
>> Starting with my +1
>>
>> Best regards,
>>
>> Even
>>
>>
>
> --
> Daniel Morissette
> T: +1 418-696-5056 #201
> http://www.mapgears.com/
> Provider of Professional MapServer Support since 2000
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140520/8e473d0f/attachment.html>

From mateusz at loskot.net  Tue May 20 07:34:55 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 20 May 2014 16:34:55 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <CACqzBMx1xajn9zrh30SyMFpWC0P_LPVym-8b1dzqFH1WBRJTbg@mail.gmail.com>
References: <201405192229.29577.even.rouault@mines-paris.org>
	<537B4F40.8000909@mapgears.com>
	<CACqzBMx1xajn9zrh30SyMFpWC0P_LPVym-8b1dzqFH1WBRJTbg@mail.gmail.com>
Message-ID: <CABUeae83iBc9ByHAqL+e2w+O71Cr5ao03673F76bcbSzDeE6tg@mail.gmail.com>

AFAIU, this voting request targets PSC members [1] only.
Or, does it target the whole community?

[1] http://trac.osgeo.org/gdal/wiki/GovernanceAndCommunity

Mateusz

On 20 May 2014 15:43, xavier lhomme <lhomme.xavier at gmail.com> wrote:
> +1
> xl
>
>
> 2014-05-20 14:49 GMT+02:00 Daniel Morissette <dmorissette at mapgears.com>:
>>
>> +1
>>
>> Daniel
>>
>>
>> On 14-05-19 4:29 PM, Even Rouault wrote:
>>>
>>> Hi,
>>>
>>> I think that the points raised in the discussion have been answered. I've
>>> just
>>> done a minor edit to the RFC text to mention RFC 36, as rightly suggested
>>> by
>>> Ivan.
>>>
>>> So:
>>>
>>> Motion : I move to adopt RFC 46: GDAL/OGR unification
>>>
>>>      http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>>>
>>> Starting with my +1
>>>
>>> Best regards,
>>>
>>> Even
>>>
>>
>>
>> --
>> Daniel Morissette
>> T: +1 418-696-5056 #201
>> http://www.mapgears.com/
>> Provider of Professional MapServer Support since 2000
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Tue May 20 08:29:12 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 17:29:12 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <CABUeae83iBc9ByHAqL+e2w+O71Cr5ao03673F76bcbSzDeE6tg@mail.gmail.com>
References: <201405192229.29577.even.rouault@mines-paris.org>
	<537B4F40.8000909@mapgears.com>
	<CACqzBMx1xajn9zrh30SyMFpWC0P_LPVym-8b1dzqFH1WBRJTbg@mail.gmail.com>
	<CABUeae83iBc9ByHAqL+e2w+O71Cr5ao03673F76bcbSzDeE6tg@mail.gmail.com>
Message-ID: <1400599752.537b74c80edcf@imp.free.fr>

Selon Mateusz  <mateusz at loskot.net>:

> AFAIU, this voting request targets PSC members [1] only.
> Or, does it target the whole community?
>
> [1] http://trac.osgeo.org/gdal/wiki/GovernanceAndCommunity

Mateusz,

Officially, only votes from PSC members is taken into account, so as it remains
manageable (e.g. if a random subscriber, who doesn't take an active part to the
project, could veto each proposal systematically, the project would be stalled),
but as said in the page you quote "input from all subscribers is welcome".
http://trac.osgeo.org/gdal/wiki/rfc1_pmc also mentions "Anyone may comment on
proposals on the list, but only members of the Project Management Committee's
votes will be counted"

Even


From mateusz at loskot.net  Tue May 20 08:41:53 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 20 May 2014 17:41:53 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <1400599752.537b74c80edcf@imp.free.fr>
References: <201405192229.29577.even.rouault@mines-paris.org>
	<537B4F40.8000909@mapgears.com>
	<CACqzBMx1xajn9zrh30SyMFpWC0P_LPVym-8b1dzqFH1WBRJTbg@mail.gmail.com>
	<CABUeae83iBc9ByHAqL+e2w+O71Cr5ao03673F76bcbSzDeE6tg@mail.gmail.com>
	<1400599752.537b74c80edcf@imp.free.fr>
Message-ID: <CABUeae98+rCsvtOV5FXoAaePX6M3YsWEaWPzZLa=5KNRpC=neg@mail.gmail.com>

On 20 May 2014 17:29, Even Rouault <even.rouault at mines-paris.org> wrote:
> Selon Mateusz  <mateusz at loskot.net>:
>
>> AFAIU, this voting request targets PSC members [1] only.
>> Or, does it target the whole community?
>>
>> [1] http://trac.osgeo.org/gdal/wiki/GovernanceAndCommunity
>
> Mateusz,
>
> Officially, only votes from PSC members is taken into account, so as it remains
> manageable (e.g. if a random subscriber, who doesn't take an active part to the
> project, could veto each proposal systematically, the project would be stalled),
> but as said in the page you quote "input from all subscribers is welcome".
> http://trac.osgeo.org/gdal/wiki/rfc1_pmc also mentions "Anyone may comment on
> proposals on the list, but only members of the Project Management Committee's
> votes will be counted"

Even,

Right, I just thought there was a separate thread for the substantial input from
the community.

p.s. as community member, not in PSC I give: +1 (let's influence PSC
members a bit :))

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From david.fawcett at gmail.com  Tue May 20 09:18:37 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Tue, 20 May 2014 11:18:37 -0500
Subject: [gdal-dev] gdal_translate .vrt issue
In-Reply-To: <1400575037.537b143d172ad@imp.free.fr>
References: <CAF7K3b8jEbk_5Ou5QjhbahBC6_Gwo90Z2nYXUcEK0Zg_vP4XEQ@mail.gmail.com>
	<1400575037.537b143d172ad@imp.free.fr>
Message-ID: <CAF7K3b9yNGFJhmtpkmN_Afa==QHgsmkQOomSuLRjCrk-Q3Beqg@mail.gmail.com>

As usual Even, spot on!

Thank you for precise diagnosis and the quick solution.  My project is back
on track and the product can be delivered soon.  I am guessing that I could
bump the pool_size up somewhat.  I plan to play around with that value and
maybe get a little more performance (on my old Mac laptop...).

Thanks again,

David.


On Tue, May 20, 2014 at 3:37 AM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Selon David Fawcett <david.fawcett at gmail.com>:
>
> > I am using gdal_translate and a .vrt to take 115 .jp2 files from the
> USGS,
> > pull them together and then export a lower resolution .jp2.
> >
> > This is with GDAL 1.10 on OSX.
> > gdalinfo --version
> > GDAL 1.10.1, released 2013/08/26
> >
> > When I run gdal_translate, it gets about 30% of the way through the
> process
> > and errors out saying that it can't open one of the .j2w files.  When I
> run
> > gdalinfo on the file, I can open it, and if I run gdal_translate on just
> > that file, I can successfully export a reduced resolution copy.
> >
> > The output of gdalinfo is here:
> > https://gist.github.com/fawcett/beead31741e24394b38e
> >
> > I can also load the .vrt image into QGIS 2.2 and it loads (slowly of
> > course).
>
> Even when you zoom out at 10% like your gdal_translate command ?
>
> >
> > gdal_translate img_index.vrt mpls34.jp2 -outsize 10% 10% -of JP2OpenJPEG
> > -co QUALITY=25 -epo
> > Input file size is 45000, 65000
> > 0...10...20.ERROR 4:
> >
>
> CSLLoad2("/Users/david/projects/mpls_watersheds/data/15TVK830815_201203_0x3000m_CL_1/15TVK830815_201203_0x3000m_CL_1.j2w")
> > failed: unable to open file.
> > ERROR 4:
> >
>
> `/Users/david/projects/mpls_watersheds/data/15TVK830830_201203_0x3000m_CL_1/15TVK830830_201203_0x3000m_CL_1.jp2'
> > not recognised as a supported file format.
> >
> > gdalinfo 15TVK830815_201203_0x3000m_CL_1.jp2
> > Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
> > Files: 15TVK830815_201203_0x3000m_CL_1.jp2
> >        15TVK830815_201203_0x3000m_CL_1.j2w
> > Size is 5000, 5000
> > Coordinate System is:
> > PROJCS["NAD83 / UTM zone 15N",
> >     GEOGCS["NAD83",
> >         DATUM["North_American_Datum_1983",
> >             SPHEROID["GRS 1980",6378137,298.2572221010002,
> >                 AUTHORITY["EPSG","7019"]],
> >             AUTHORITY["EPSG","6269"]],
> >         PRIMEM["Greenwich",0],
> >         UNIT["degree",0.0174532925199433],
> >         AUTHORITY["EPSG","4269"]],
> >     PROJECTION["Transverse_Mercator"],
> >     PARAMETER["latitude_of_origin",0],
> >     PARAMETER["central_meridian",-93],
> >     PARAMETER["scale_factor",0.9996],
> >     PARAMETER["false_easting",500000],
> >     PARAMETER["false_northing",0],
> >     UNIT["metre",1,
> >         AUTHORITY["EPSG","9001"]],
> >     AUTHORITY["EPSG","26915"]]
> > Origin = (483000.000000000000000,4983000.000000000000000)
> > Pixel Size = (0.300000000000012,-0.300000000000186)
> > Image Structure Metadata:
> >   INTERLEAVE=PIXEL
> > Corner Coordinates:
> > Upper Left  (  483000.000, 4983000.000) ( 93d12'56.50"W, 45d 0' 0.87"N)
> > Lower Left  (  483000.000, 4981500.000) ( 93d12'56.32"W, 44d59'12.26"N)
> > Upper Right (  484500.000, 4983000.000) ( 93d11'47.99"W, 45d 0' 1.00"N)
> > Lower Right (  484500.000, 4981500.000) ( 93d11'47.82"W, 44d59'12.39"N)
> > Center      (  483750.000, 4982250.000) ( 93d12'22.16"W, 44d59'36.63"N)
> > Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
> >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> >   Overviews: arbitrary
> > Band 2 Block=1024x1024 Type=Byte, ColorInterp=Green
> >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> >   Overviews: arbitrary
> > Band 3 Block=1024x1024 Type=Byte, ColorInterp=Blue
> >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> >   Overviews: arbitrary
> >
> > The .vrt file contents are here:
> > https://gist.github.com/fawcett/c8cd5d271b0a89e67779
> >
> > Does anyone have a suggestion on how to troubleshoot this?  I am
> wondering
> > if I am just running out of memory.
>
> I guess you might rather run out of file descriptors. What is the default
> limit
> on Mac : 1024 as on Linux ?
> For each opened JP2 by the OpenJPEG driver, it maintains a file descriptor
> per
> overview level (and for the main level). So in your above case, 6 file
> descriptors.
> The VRT mechanism shouldn't open simultaneously more than
> GDAL_MAX_DATASET_POOL_SIZE=100 datasets
> (
> http://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdalproxypool.cpp#L313
> ).
> 100 * 6 = 600... So if you have JP2 images bigger than the one you
> sampled, you
> might have more overview levels. Or possibly the limit on Mac is lower than
> 1024.
> You might want to try setting the GDAL_MAX_DATASET_POOL_SIZE configuration
> option/environmenet variable to a lower value, let's say 10, and see if it
> works
> better.
>
> Even
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140520/a1627c15/attachment.html>

From even.rouault at mines-paris.org  Tue May 20 10:07:13 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 19:07:13 +0200
Subject: [gdal-dev] Question on scaling between tif and vrt
In-Reply-To: <537AA034.1000501@swoodbridge.com>
References: <537A7AAE.2050400@swoodbridge.com>
	<201405192348.02077.even.rouault@mines-paris.org>
	<537AA034.1000501@swoodbridge.com>
Message-ID: <201405201907.13583.even.rouault@mines-paris.org>

Le mardi 20 mai 2014 02:22:12, Stephen Woodbridge a ?crit :
> Even,
> 
> Thanks!
> 
> I didn't set his up, I just inherited the maintenance of it and I'm just
> trying to understand how it works and eventually make changes to it and
> fix some of the processing that does not seem to be grounded in a good
> process, which is looking like more and more of the code. :(
> 
> I get the point about the color table values need to be values from 0-n
> and you need 0-n entries in the color table.  Or you need to use LUT
> like you explained before.
> 
> What I was trying to understand is more along the lines of
> 
> input tif is Int16
> vrt is declared as Byte
> 
> How does GDAL deal with this? There are no errors or warnings. gdalinfo
> is reporting a Byte range of values for the vrt. I'm wondering how it is
> interpreting an arbitrary Int16 value into a Byte?
> 
> So some of the obvious guesses are:
> 
> 1. it is scaling them (you say no on this)
> 2. it is reading the Int16 and only using only the low or high order
> byte as the value?
> 3. something else?

It should clamp input values to the Byte range. So negative values in Int16 
will transform to 0, and ones > 255 will be clamped to 255.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Tue May 20 10:08:21 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 20 May 2014 19:08:21 +0200
Subject: [gdal-dev] gdal_translate .vrt issue
In-Reply-To: <CAF7K3b9yNGFJhmtpkmN_Afa==QHgsmkQOomSuLRjCrk-Q3Beqg@mail.gmail.com>
References: <CAF7K3b8jEbk_5Ou5QjhbahBC6_Gwo90Z2nYXUcEK0Zg_vP4XEQ@mail.gmail.com>
	<1400575037.537b143d172ad@imp.free.fr>
	<CAF7K3b9yNGFJhmtpkmN_Afa==QHgsmkQOomSuLRjCrk-Q3Beqg@mail.gmail.com>
Message-ID: <201405201908.21569.even.rouault@mines-paris.org>

Le mardi 20 mai 2014 18:18:37, David Fawcett a ?crit :
> As usual Even, spot on!
> 
> Thank you for precise diagnosis and the quick solution.  My project is back
> on track and the product can be delivered soon.  I am guessing that I could
> bump the pool_size up somewhat.  I plan to play around with that value and
> maybe get a little more performance (on my old Mac laptop...).

The value of the pool size might not be important in some cases. It is highly 
dependant on the read pattern. And GDAL_CACHEMAX will also play a role.

> 
> Thanks again,
> 
> David.
> 
> 
> On Tue, May 20, 2014 at 3:37 AM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Selon David Fawcett <david.fawcett at gmail.com>:
> > > I am using gdal_translate and a .vrt to take 115 .jp2 files from the
> > 
> > USGS,
> > 
> > > pull them together and then export a lower resolution .jp2.
> > > 
> > > This is with GDAL 1.10 on OSX.
> > > gdalinfo --version
> > > GDAL 1.10.1, released 2013/08/26
> > > 
> > > When I run gdal_translate, it gets about 30% of the way through the
> > 
> > process
> > 
> > > and errors out saying that it can't open one of the .j2w files.  When I
> > 
> > run
> > 
> > > gdalinfo on the file, I can open it, and if I run gdal_translate on
> > > just that file, I can successfully export a reduced resolution copy.
> > > 
> > > The output of gdalinfo is here:
> > > https://gist.github.com/fawcett/beead31741e24394b38e
> > > 
> > > I can also load the .vrt image into QGIS 2.2 and it loads (slowly of
> > > course).
> > 
> > Even when you zoom out at 10% like your gdal_translate command ?
> > 
> > > gdal_translate img_index.vrt mpls34.jp2 -outsize 10% 10% -of
> > > JP2OpenJPEG -co QUALITY=25 -epo
> > > Input file size is 45000, 65000
> > 
> > > 0...10...20.ERROR 4:
> > CSLLoad2("/Users/david/projects/mpls_watersheds/data/15TVK830815_201203_0
> > x3000m_CL_1/15TVK830815_201203_0x3000m_CL_1.j2w")
> > 
> > > failed: unable to open file.
> > 
> > > ERROR 4:
> > `/Users/david/projects/mpls_watersheds/data/15TVK830830_201203_0x3000m_CL
> > _1/15TVK830830_201203_0x3000m_CL_1.jp2'
> > 
> > > not recognised as a supported file format.
> > > 
> > > gdalinfo 15TVK830815_201203_0x3000m_CL_1.jp2
> > > Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
> > > Files: 15TVK830815_201203_0x3000m_CL_1.jp2
> > > 
> > >        15TVK830815_201203_0x3000m_CL_1.j2w
> > > 
> > > Size is 5000, 5000
> > > Coordinate System is:
> > > PROJCS["NAD83 / UTM zone 15N",
> > > 
> > >     GEOGCS["NAD83",
> > >     
> > >         DATUM["North_American_Datum_1983",
> > >         
> > >             SPHEROID["GRS 1980",6378137,298.2572221010002,
> > >             
> > >                 AUTHORITY["EPSG","7019"]],
> > >             
> > >             AUTHORITY["EPSG","6269"]],
> > >         
> > >         PRIMEM["Greenwich",0],
> > >         UNIT["degree",0.0174532925199433],
> > >         AUTHORITY["EPSG","4269"]],
> > >     
> > >     PROJECTION["Transverse_Mercator"],
> > >     PARAMETER["latitude_of_origin",0],
> > >     PARAMETER["central_meridian",-93],
> > >     PARAMETER["scale_factor",0.9996],
> > >     PARAMETER["false_easting",500000],
> > >     PARAMETER["false_northing",0],
> > >     UNIT["metre",1,
> > >     
> > >         AUTHORITY["EPSG","9001"]],
> > >     
> > >     AUTHORITY["EPSG","26915"]]
> > > 
> > > Origin = (483000.000000000000000,4983000.000000000000000)
> > > Pixel Size = (0.300000000000012,-0.300000000000186)
> > > 
> > > Image Structure Metadata:
> > >   INTERLEAVE=PIXEL
> > > 
> > > Corner Coordinates:
> > > Upper Left  (  483000.000, 4983000.000) ( 93d12'56.50"W, 45d 0' 0.87"N)
> > > Lower Left  (  483000.000, 4981500.000) ( 93d12'56.32"W, 44d59'12.26"N)
> > > Upper Right (  484500.000, 4983000.000) ( 93d11'47.99"W, 45d 0' 1.00"N)
> > > Lower Right (  484500.000, 4981500.000) ( 93d11'47.82"W, 44d59'12.39"N)
> > > Center      (  483750.000, 4982250.000) ( 93d12'22.16"W, 44d59'36.63"N)
> > > Band 1 Block=1024x1024 Type=Byte, ColorInterp=Red
> > > 
> > >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> > >   Overviews: arbitrary
> > > 
> > > Band 2 Block=1024x1024 Type=Byte, ColorInterp=Green
> > > 
> > >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> > >   Overviews: arbitrary
> > > 
> > > Band 3 Block=1024x1024 Type=Byte, ColorInterp=Blue
> > > 
> > >   Overviews: 2500x2500, 1250x1250, 625x625, 312x312, 156x156
> > >   Overviews: arbitrary
> > > 
> > > The .vrt file contents are here:
> > > https://gist.github.com/fawcett/c8cd5d271b0a89e67779
> > > 
> > > Does anyone have a suggestion on how to troubleshoot this?  I am
> > 
> > wondering
> > 
> > > if I am just running out of memory.
> > 
> > I guess you might rather run out of file descriptors. What is the default
> > limit
> > on Mac : 1024 as on Linux ?
> > For each opened JP2 by the OpenJPEG driver, it maintains a file
> > descriptor per
> > overview level (and for the main level). So in your above case, 6 file
> > descriptors.
> > The VRT mechanism shouldn't open simultaneously more than
> > GDAL_MAX_DATASET_POOL_SIZE=100 datasets
> > (
> > http://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdalproxypool.cpp#L31
> > 3 ).
> > 100 * 6 = 600... So if you have JP2 images bigger than the one you
> > sampled, you
> > might have more overview levels. Or possibly the limit on Mac is lower
> > than 1024.
> > You might want to try setting the GDAL_MAX_DATASET_POOL_SIZE
> > configuration option/environmenet variable to a lower value, let's say
> > 10, and see if it works
> > better.
> > 
> > Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Tue May 20 16:13:50 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 21 May 2014 01:13:50 +0200
Subject: [gdal-dev] ogr python pg GetLayerByName / CreateLayer
In-Reply-To: <1400574573.537b126db0d5b@imp.free.fr>
References: <CA+Ei1OcHKsmG7Qd0mMP+59W12u9KTptzCCAOkK5_ZvBoWS9yJA@mail.gmail.com>
	<1400574573.537b126db0d5b@imp.free.fr>
Message-ID: <CA+Ei1OdUpdeyBg3zimruuYmtEEYYKj_iO9AF5h0_TBRTX73c3A@mail.gmail.com>

2014-05-20 10:29 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> Is it new to the -dev version ? I don't think so, but anyway, feel free to
> change the error into a CPLDebug message. The error seems to be emitted there
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/pg/ogrpgtablelayer.cpp#L380

no, it's not new to dev version. Anyway done in r27369. Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Wed May 21 02:39:50 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 21 May 2014 11:39:50 +0200
Subject: [gdal-dev] Missing include in MSG driver
In-Reply-To: <537B1097.4070102@mathematik.uni-marburg.de>
References: <537B1097.4070102@mathematik.uni-marburg.de>
Message-ID: <201405211139.50356.even.rouault@mines-paris.org>

Le mardi 20 mai 2014 10:21:43, Christian Authmann a ?crit :
> Hello,
> 
> I tried to compile GDAL 1.11.0 with the meteosat 2 (MSG) driver, but
> compilation failed in
> 
> frmts/msg/msgcommand.cpp
> 
> with a message stating that sprintf() was unknown. Adding
> 
> #include <cstdio>
> 
> at the top of the file fixed the problem. A trivial patch is attached; I
> release it under the license of the original file in the hopes that a
> dev will commit it.

Could not compile-test myself, but looks reasonnable

Applied per http://trac.osgeo.org/gdal/ticket/5479

> 
> 
> Thanks!

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 21 03:39:20 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 21 May 2014 12:39:20 +0200
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
	addgeoreferencing
In-Reply-To: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F82@mailex1.ign.fr>
References: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F82@mailex1.ign.fr>
Message-ID: <201405211239.20862.even.rouault@mines-paris.org>

Le mardi 20 mai 2014 12:48:12, Emmanuel Devys a ?crit :
> Thanks Peter, Carl, Even, Jukka et al for this interesting discussion on
> adding Georeferencing to image file standards, and capabilities of GMLJP2
> 2.0 (and its GMLCOV capabilities for rectified Grid coverages or
> Georeferenceable Grid coverages), GeoJP2 ...
> 
> I appreciate this idea and action from Even to use the GeoTIFF Box
> mechanism (as documented in the GeoJP2 as explained below) for other
> formats (than JP2K format) such as native JPEG, PNG ... This is outside
> the scope of the Geo-enabled JP2K (and GMLJP2), but of significant
> interest with PNG or JPG data.

A fundamental question that has not been much discussed in this thread is : do 
people really see interest in capturing georeferencing in popular image 
formats like PNG or JPG ? My thinking is that it could be potentially usefull 
in a few situations :
* when a WMS server returns a PNG or JPG.
* when generating tile caches for WMTS / TMS.

> 
> However, if used with JP2 format (specified in ISO 15444-1), this GeoJP2
> (TM) mechanism is an alternative to the GMLJP2 standard. A simple one,
> with no multi-image capability, no annotation (in GML or any other XML
> like, such as SVG) ... but widely supported for providing a Geo-enabled
> capability to JP2 data. The GMLJP2 standard is based on the Gridded
> Coverage model and GML schema in order to provide this capability,
> allowing multi-image, annotations ...
> 
> The new version 2.0 of GMLJP2 (under OGC ballot until June 29) is based on
> GMLCOV schema. Discussions are now initiated between OGC and ISO (TC211 -
> Geographic information) on the " Geo-enabled JP2K" topic and standards.
> Whether GMLJP2 and the GeoTIFF Box in JP2 is to be discussed.

Just curious: what is this "geo-enable JP2K" thing and how is it different from 
JP2 with GMLJP2 or GeoJP2 ? And why would need it to be different... ?

> There are
> other alternatives, one being the auxiliary World files (.j2w) with
> limited information (only 6 parameters, no CRS) ,

Already supported by GDAL, but kind of poor man georeferencing solution... 

> another one being the
> BIIF encapsulation (ISO 12087-5), also called NITF in USA - North America
> and its Geo extension to Geo-reference "raw JP2K codestream" (jc2 format)
> - but the resulting file is no longer a .jp2 file, but a .ntf file.

Not the simplest format to deal with, especially regarding georeferencing, 
since you can have different historical ways of encoding georeferencing in 
NITF. http://gdal.org/frmt_nitf.html mentions at least the IGEOLO, BLOCKA, 
RPC00B, GeoSDE TRE... An advantage is that it brings some way of adding other 
metadata.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From szekerest at gmail.com  Wed May 21 03:44:43 2014
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 21 May 2014 12:44:43 +0200
Subject: [gdal-dev] Motion: Adopt RFC 46 : GDAL/OGR unification
In-Reply-To: <201405192229.29577.even.rouault@mines-paris.org>
References: <201405192229.29577.even.rouault@mines-paris.org>
Message-ID: <CACALY+SvqwOtKmX3otbWSz4DWQ8dMHJ=L=w0nHEMopYYFXy_WA@mail.gmail.com>

+1

Tamas



2014-05-19 22:29 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> Hi,
>
> I think that the points raised in the discussion have been answered. I've
> just
> done a minor edit to the RFC text to mention RFC 36, as rightly suggested
> by
> Ivan.
>
> So:
>
> Motion : I move to adopt RFC 46: GDAL/OGR unification
>
>     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
>
> Starting with my +1
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140521/59e6e076/attachment.html>

From david.fawcett at gmail.com  Wed May 21 04:39:43 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Wed, 21 May 2014 06:39:43 -0500
Subject: [gdal-dev] Outside of Image Area Warnings gdal_translate
Message-ID: <CAF7K3b85UH8L6=J=2ZCRDB1MEKVS2Ad5xwtbiLVOioVNtmBOAA@mail.gmail.com>

I am running gdal_translate to composite image tiles in a vrt and reduce
the output image size.  I ran it at outsize 50% 50% and received no
warnings.  When I bumped the outsize up to 75%, I got quite a few warnings
like the one below.

Warning 1: Right position of the decoded area (region_x1=5120) is outside
the image area (Xsiz=5000).

This one gave no warnings:
gdal_translate img_index.vrt mpls50.jp2 -outsize 50% 50% -of JP2OpenJPEG
-co QUALITY=25 --config GDAL_MAX_DATASET_POOL_SIZE 10

This one produced warnings
gdal_translate img_index.vrt mpls7575.jp2 -outsize 75% 75% -of JP2OpenJPEG
-co QUALITY=75 --config GDAL_MAX_DATASET_POOL_SIZE 10

GDAL version is 1.10

Any suggestions on how to avoid the warnings?

Thanks,

David.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140521/2b7fa269/attachment.html>

From even.rouault at mines-paris.org  Wed May 21 05:21:49 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 21 May 2014 14:21:49 +0200
Subject: [gdal-dev] Outside of Image Area Warnings gdal_translate
In-Reply-To: <CAF7K3b85UH8L6=J=2ZCRDB1MEKVS2Ad5xwtbiLVOioVNtmBOAA@mail.gmail.com>
References: <CAF7K3b85UH8L6=J=2ZCRDB1MEKVS2Ad5xwtbiLVOioVNtmBOAA@mail.gmail.com>
Message-ID: <201405211421.50007.even.rouault@mines-paris.org>

Le mercredi 21 mai 2014 13:39:43, David Fawcett a ?crit :
> I am running gdal_translate to composite image tiles in a vrt and reduce
> the output image size.  I ran it at outsize 50% 50% and received no
> warnings.  When I bumped the outsize up to 75%, I got quite a few warnings
> like the one below.
> 
> Warning 1: Right position of the decoded area (region_x1=5120) is outside
> the image area (Xsiz=5000).
> 
> This one gave no warnings:
> gdal_translate img_index.vrt mpls50.jp2 -outsize 50% 50% -of JP2OpenJPEG
> -co QUALITY=25 --config GDAL_MAX_DATASET_POOL_SIZE 10
> 
> This one produced warnings
> gdal_translate img_index.vrt mpls7575.jp2 -outsize 75% 75% -of JP2OpenJPEG
> -co QUALITY=75 --config GDAL_MAX_DATASET_POOL_SIZE 10
> 
> GDAL version is 1.10
> 
> Any suggestions on how to avoid the warnings?

The warning come from the openjpeg library and suggests that the GDAL driver 
issue an invalid query extending over the right of an image. Which is indeed 
the case. I've just fixed it with http://trac.osgeo.org/gdal/ticket/5480

Looking at the openjpeg code, it looks like it should properly adjust the 
request to what expects the GDAL driver, so the end result should be OK.

The fact that you get the warning at some subsampling ratio and not at others 
come from the fact that the overview dimensions are not the same and the GDAL 
driver adjusts its strategy how to work with openjpeg API (there's a tile API 
and a window API. The last one was the one that issued the warning)

Another thing I wanted to mention is that the fact you ran into this issue 
reveals that your JPEG2000 images are mono-tile. Which is OK per se. The 
OpenJPEG library just doesn't work very efficiently with such images (basically 
even if you need one pixel, it will decode the whole image). Other JPEG2000 
libraries are able to use other JPEG2000 mechanisms to operate more efficiently.

> 
> Thanks,
> 
> David.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mateusz at loskot.net  Wed May 21 05:55:57 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Wed, 21 May 2014 14:55:57 +0200
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
	addgeoreferencing
In-Reply-To: <201405211239.20862.even.rouault@mines-paris.org>
References: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F82@mailex1.ign.fr>
	<201405211239.20862.even.rouault@mines-paris.org>
Message-ID: <CABUeae_UqT_Uev+d+hNi=Fu7fv0drn2m4dpF5PVSbNrhfWC0FA@mail.gmail.com>

On 21 May 2014 12:39, Even Rouault <even.rouault at mines-paris.org> wrote:
> Le mardi 20 mai 2014 12:48:12, Emmanuel Devys a ?crit :
>> Thanks Peter, Carl, Even, Jukka et al for this interesting discussion on
>> adding Georeferencing to image file standards, and capabilities of GMLJP2
>> 2.0 (and its GMLCOV capabilities for rectified Grid coverages or
>> Georeferenceable Grid coverages), GeoJP2 ...
>>
>> I appreciate this idea and action from Even to use the GeoTIFF Box
>> mechanism (as documented in the GeoJP2 as explained below) for other
>> formats (than JP2K format) such as native JPEG, PNG ... This is outside
>> the scope of the Geo-enabled JP2K (and GMLJP2), but of significant
>> interest with PNG or JPG data.
>
> A fundamental question that has not been much discussed in this thread is : do
> people really see interest in capturing georeferencing in popular image
> formats like PNG or JPG ? My thinking is that it could be potentially usefull
> in a few situations :
> * when a WMS server returns a PNG or JPG.
> * when generating tile caches for WMTS / TMS.

Having a self-contained raster is surely an interesting thing.
It would support creation of lean(er) kind of services.
Would/Will it cross the chasm? That is a matter of business strategy :)

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Wed May 21 06:41:11 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 21 May 2014 15:41:11 +0200
Subject: [gdal-dev] Outside of Image Area Warnings gdal_translate
In-Reply-To: <CAF7K3b_KZ2RHRu8nKuAuJouqK0uqCd4r77wBje9g0Uxt8mXeFA@mail.gmail.com>
References: <CAF7K3b85UH8L6=J=2ZCRDB1MEKVS2Ad5xwtbiLVOioVNtmBOAA@mail.gmail.com>
	<201405211421.50007.even.rouault@mines-paris.org>
	<CAF7K3b_KZ2RHRu8nKuAuJouqK0uqCd4r77wBje9g0Uxt8mXeFA@mail.gmail.com>
Message-ID: <201405211541.11232.even.rouault@mines-paris.org>

Le mercredi 21 mai 2014 15:34:40, David Fawcett a ?crit :
> Thank you Even.
> 
> My input images came from an external source, so I have no control over
> them.  Are you suggesting that I tile the output?   I don't see a creation
> option of TILED=YES for OpenJPEG, it looks like I would have to use one of
> the commercial libraries.

That's controlled by the BLOCKXSIZE and BLOCKYSIZE options. They imply tiling. 
But, by default, the openjpeg driver will tile the images with a tile size of 
1024.
On the contrary if you wanted a single-tile image, you would have to set 
BLOCKXSIZE and BLOCKYSIZE to the dimensions of the raster.

> 
> David.
> 
> 
> On Wed, May 21, 2014 at 7:21 AM, Even Rouault
> 
> <even.rouault at mines-paris.org>wrote:
> > Le mercredi 21 mai 2014 13:39:43, David Fawcett a ?crit :
> > > I am running gdal_translate to composite image tiles in a vrt and
> > > reduce the output image size.  I ran it at outsize 50% 50% and
> > > received no warnings.  When I bumped the outsize up to 75%, I got
> > > quite a few
> > 
> > warnings
> > 
> > > like the one below.
> > > 
> > > Warning 1: Right position of the decoded area (region_x1=5120) is
> > > outside the image area (Xsiz=5000).
> > > 
> > > This one gave no warnings:
> > > gdal_translate img_index.vrt mpls50.jp2 -outsize 50% 50% -of
> > > JP2OpenJPEG -co QUALITY=25 --config GDAL_MAX_DATASET_POOL_SIZE 10
> > > 
> > > This one produced warnings
> > > gdal_translate img_index.vrt mpls7575.jp2 -outsize 75% 75% -of
> > 
> > JP2OpenJPEG
> > 
> > > -co QUALITY=75 --config GDAL_MAX_DATASET_POOL_SIZE 10
> > > 
> > > GDAL version is 1.10
> > > 
> > > Any suggestions on how to avoid the warnings?
> > 
> > The warning come from the openjpeg library and suggests that the GDAL
> > driver
> > issue an invalid query extending over the right of an image. Which is
> > indeed
> > the case. I've just fixed it with http://trac.osgeo.org/gdal/ticket/5480
> > 
> > Looking at the openjpeg code, it looks like it should properly adjust the
> > request to what expects the GDAL driver, so the end result should be OK.
> > 
> > The fact that you get the warning at some subsampling ratio and not at
> > others
> > come from the fact that the overview dimensions are not the same and the
> > GDAL
> > driver adjusts its strategy how to work with openjpeg API (there's a tile
> > API
> > and a window API. The last one was the one that issued the warning)
> > 
> > Another thing I wanted to mention is that the fact you ran into this
> > issue reveals that your JPEG2000 images are mono-tile. Which is OK per
> > se. The OpenJPEG library just doesn't work very efficiently with such
> > images (basically
> > even if you need one pixel, it will decode the whole image). Other
> > JPEG2000 libraries are able to use other JPEG2000 mechanisms to operate
> > more efficiently.
> > 
> > > Thanks,
> > > 
> > > David.
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Wed May 21 06:55:59 2014
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka  (Tike))
Date: Wed, 21 May 2014 13:55:59 +0000
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
 addgeoreferencing
Message-ID: <EFE5D7EE2EC8D3438FE02E356F81E35A0DA2C991@FITLK-EXMBX04.msvyvi.vaha.local>

Even Rouault wrote:

> A fundamental question that has not been much discussed in this thread is : do
> people really see interest in capturing georeferencing in popular image formats
> like PNG or JPG ? My thinking is that it could be potentially usefull in a few
> situations :
> * when a WMS server returns a PNG or JPG.
> * when generating tile caches for WMTS / TMS.

If an image is a map or aerial image it is worth more with georeferencing than without or of equal value for some users but not less for anybody. WMS is a good example (we have GeoTIFF outputformat as on option just because of that) but there are lots of static map services in the web which deliver just images of maps but which could with a minimal effort attach georeferencing into the maps so that they could be flipped into a GPS device to act as moving map background also for offline usage.

I think that use cases for PNG and JPG are mostly very simple. However, world file is not enough but also the projection code should be advertised. And support for georeferencing by using ground control points would suit very well for scanned maps and digital photos of maps. Inserting a minimal tiff file inside an image in another format may be a dirty trick but at least it works pretty well with JPEG2000.

-Jukka Rahkonen-


From p.baumann at jacobs-university.de  Wed May 21 07:20:50 2014
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Wed, 21 May 2014 16:20:50 +0200
Subject: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to
	addgeoreferencing
In-Reply-To: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F26@mailex1.ign.fr>
References: <10DA769A5C37DF408C33DC5AF4CF2E1B22F83F26@mailex1.ign.fr>
Message-ID: <537CB642.7090103@jacobs-university.de>

Hi Emmanuel,

my fault, the curse of shorthand...expanding a little:

- GMLCOV gives a format-independent coverage model, with an increasing number of 
mappings from/to concrete formats getting available. As there is a formal 
dependency of GMLJP2 on GMLCOV both best should be adopted in sync.

Characterizing GMLCOV as a 19123 implementation standard makes a lot of sense - 
19123 is abstract, and many non-interoperable implementations can be (and have 
been) done. GMLCOV is based on the 19123 concepts and refines them to an 
interoperable data model which is conformance-testable down to single pixel level.

- WCS indeed is a separate issue (GMLCOV is built in a way that many services 
can be used, while WCS just happens to be the one with the most 
coverage-specific functionality). Makeing WCS an ISO standard actually has been 
suggested to me independently from this thread & earlier, by several people.

As WCS likewise is based on 19123 (here the functional part comes in) IMHO it 
would indeed make sense to have both data and service model standardized in the 
realm of TC211.

Although having been pushed I have not undertaken any steps in this direction 
until now, partly due to resource issues and partly as I am not familiar with 
TC211 procedures. I will try to join TC211 telcos so that we jointly can clarify 
issues.

cheers,
Peter


On 05/20/2014 12:00 PM, Emmanuel Devys wrote:
> Peter, Carl et al
> For the sake of clarification, I'd like to know in the " this includes GMLCOV and WCS." What does the "this" relates to ? (GMLJP2 ?, OGC/ISO discussion ? both ?
> Moreover, I believe WCS is not directly related (or included) ... IMHO, the relationship between WCS (Web coverage Service) and these encodings (JPEG2000, JPEG, PNG) is only via the WCS encoding extensions (presently the GeoTIFF one, and the emergent JP2K one).
>
> The version 2 of the OGC GML in JP2000 (GMLJP2) candidate is based on the GMLCOV schema.
> My understanding of the OGC/ISO TC211 discussion is that it is related to the "Geo-enabled JP2K standard(s)", for which GMLJP2 is a candidate, being aware that there are others (such as the GeoTIFF box in JPEG2000 - also called GeoJ2(TM)).
>
> Would there be additional discussion to bring GMLCOV to ISO TC211 (as an implementation standard for 19123) ?
>
> Cheers
> Emmanuel Devys
>
> -----Message d'origine-----
> De : gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Peter Baumann
> Envoy? : mardi 20 mai 2014 09:27
> ? : Carl Reed; Even Rouault; gdal-dev at lists.osgeo.org
> Cc : Jukka Rahkonen; standards at lists.osgeo.org
> Objet : Re: [gdal-dev] [OSGeo-Standards] Idea: GeoTIFF box in JPEG to addgeoreferencing
>
> On 05/19/2014 10:50 PM, Carl Reed wrote:
>> Thanks, Peter.
>>
>> Also, FYI, version 2 of the OGC GML in JP2000 (GMLJP2) candidate
>> standard is in an OGC adoption vote until June 29.  There is also an
>> OGC/ISO discussion this week as to whether this OGC standards should also become an ISO standard.
> Just for clarification: this includes GMLCOV and WCS.
> cheers,
> Peter
>
>
>> Cheers
>>
>> Carl
>>
>>
>> -----Original Message----- From: Peter Baumann
>> Sent: Monday, May 12, 2014 3:39 PM
>> To: Even Rouault ; gdal-dev at lists.osgeo.org
>> Cc: Jukka Rahkonen ; standards at lists.osgeo.org
>> Subject: Re: [OSGeo-Standards] [gdal-dev] Idea: GeoTIFF box in JPEG to
>> addgeoreferencing
>>
>> PS: not sure all on this list are aware of this overview page:
>> http://external.opengeospatial.org/twiki_public/CoveragesDWG/Coverages
>> BigPicture
>>
>> -Peter
>>
>>
>> On 05/12/2014 11:38 PM, Peter Baumann wrote:
>>> Hi all,
>>>
>>> just saw this, thought I'd chime in being the editor of GMLCOV :) Any
>>> questions, I'll gladly try to answer, I'm just on the road currently,
>>> so expect a delay of a day or so.
>>>
>>> Trying to respond to what has been raised below:
>>>
>>> On 05/12/2014 11:18 PM, Even Rouault wrote:
>>>> Le lundi 12 mai 2014 23:05:21, Jukka Rahkonen a ?crit :
>>>>> Even Rouault <even.rouault <at> mines-paris.org> writes:
>>>>>
>>>>> ...
>>>>>
>>>>>>> In light of this, it may be better to use an xml or textual
>>>>>>> representation and embed it inside an XMP block, which is
>>>>>>> supported for many formats[1]. Also it would allow for easier human-reading.
>>>>>> Yes, that's one possibility. Which comes back to GMLJP2 unless
>>>>>> there are
>>>>> other
>>>>>
>>>>>> standards...
>>>>>>
>>>>>> I'd want to build on something that is a "real" standard or a
>>>>>> de-facto standard, but not reinvent everything from scratch.
>>>>> What GMLJP2 gives as a bonus is the axis order trouble
>>> actually, no. GMLJP2 relies on GMLCOV which defines axis order. Each
>>> coverage has a Native CRS which is defined via an OGC URI (which, in
>>> the case of EPSG, refers to the OGP maintained database). In the CRS
>>> definition the axis is given unambiguously.
>>>
>>> If you don't want to go to that database, use the axisLabels
>>> attribute in the Envelope, it lists axes in their proper sequence.
>>>
>>>
>>>>> and not totally
>>>>> clear interpretation if origin is in the centre (probably it is) or
>>>>> in the corner of a pixel,
>>> naively, GMLCOV follows the pixel-in center interpretation. However,
>>> encodings may override this, such as GeoTIFF (see the pertaining
>>> adopted spec [1]).
>>>
>>> [1] https://portal.opengeospatial.org/files/?artifact_id=50118
>>>
>>>
>>>>> and rectified grid does not support ground control points.
>>> yes, because it is rectified. If you want more degree of freedom do
>>> not use RectifiedGridCoverage but ReferenceableGridCoverage. In
>>> conjunction with GML
>>> 3.3 ( a compatible enhancement of GML 3.2.1) this gives you irregular
>>> and warped grids. We're not completely done, though, and would be
>>> glad about your support in some advanced issues. Note that this work
>>> is all voluntary and relies on some project financing to be done. Up
>>> to now, EC and ESA have been generous, and so we are going ahead step by step.
>>>
>>>
>>>>> Thus GMLJP2 is at least not better in everything, it has also
>>>>> drawbacks.
>>>> Hi Jukka,
>>>>
>>>> Yes, for all your above reasons, I would prefer to avoid it.
>>> so which ones are remaining, following the clarification you mention below?
>>>
>>> cheers,
>>> Peter
>>>
>>>> Although the axis order trouble (the one of EPSG) and interpretation
>>>> of origin (pixel center) should be mostly clarified with the revised version.
>>>> As far as ground countrol points are concerned, I've not really
>>>> looked at the capabilities of GMLCov, so perhaps there's something in it for that.
>>>> Otherwise, that would be indeed a drawback.
>>>>
>>>>> -Jukka Rahkonen-
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> --
> Dr. Peter Baumann
>    - Professor of Computer Science, Jacobs University Bremen
>      www.faculty.jacobs-university.de/pbaumann
>      mail: p.baumann at jacobs-university.de
>      tel: +49-421-200-3178, fax: +49-421-200-493178
>    - Executive Director, rasdaman GmbH Bremen (HRB 26793)
>      www.rasdaman.com, mail: baumann at rasdaman.com
>      tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882 "Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
  - Professor of Computer Science, Jacobs University Bremen
    www.faculty.jacobs-university.de/pbaumann
    mail: p.baumann at jacobs-university.de
    tel: +49-421-200-3178, fax: +49-421-200-493178
  - Executive Director, rasdaman GmbH Bremen (HRB 26793)
    www.rasdaman.com, mail: baumann at rasdaman.com
    tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis 
dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec 
preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From jan.heckman at gmail.com  Wed May 21 12:44:20 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 21 May 2014 21:44:20 +0200
Subject: [gdal-dev] Difficulty finding all parts of shapefile polygon
 using Python and osgeo/ogr
In-Reply-To: <CAPODg7d0BCwDUaacQQEefwKkfytkDU+RVsS9OmOVWRG3u2mobw@mail.gmail.com>
References: <CAOggSvaWP8KK5QYBSTYm2u57f4neNPRN67HQvWUiJfRMR6c3KA@mail.gmail.com>
	<CAKMUAtBctCrWYPZpHnmSLTPQHYF+Z38W4OPVs1GKJLxsgVPe-Q@mail.gmail.com>
	<CAKMUAtBWncjFNjfmAa03Gs6p36VAPNU0+1YHvBemVZ3Yp2WjEw@mail.gmail.com>
	<CAPODg7d0BCwDUaacQQEefwKkfytkDU+RVsS9OmOVWRG3u2mobw@mail.gmail.com>
Message-ID: <CAKMUAtBDkEvsk=tTZdcyxsTgoDvUw60rzipLNk7gz-tmrvNy+w@mail.gmail.com>

Hi Bruce,
Fine, I liked looking into it as a way of refamiliarizing myself, so no
time wasted as far as I'm concerned.
Something that stuck in my mind is that the shapefile looks like a
contour-plot and that the cut-off of the little shape0 might not be
desired, at least not with the sort of minimal breach between the parts we
see in your example: the split could be regarded as an artifact.
If this is broadly correct in your case and you see the contouring as an
issue, maybe we could look into steering the contouring algorithm using
(speaking loosely) a minimal breach parameter. I've done something similar,
but it's a bit of time ago.
The problem I'm viewing occurs with narrow ridge- (or canyon-)like
structures, where, in view of the discretization, you could imagine a gap
in the ridge or a nice continuous case.
(The difference would be quite noticeable when you try to climb along the
ridge [?]). This is known in contouring as an issue of interpretation and
cannot be decided analytically without additional information, leading to a
case for supplying an additional input parameter to influence the result.
Best regards,
Jan


On Tue, May 20, 2014 at 5:54 AM, Bruce Raup <bruceraup at gmail.com> wrote:

> Jan,
>
> Thank you very much for spending time on my problem.  I ended up figuring
> out that the shapefile's structure consisted of a MULTIPOLYGON that
> contained two POLYGONs, one simple one (the small one you mentioned) and
> another with "holes".  I modified my code to account for the possibility of
> this case and it works great now.
>
> Thanks again, and best regards,
> Bruce Raup
>
>
> On Sun, May 18, 2014 at 6:19 AM, Jan Heckman <jan.heckman at gmail.com>wrote:
>
>> Bruce,
>> Attached is the digging - in C++, but should help for python as well.
>> I  used C++ for easier debugging, because there just might have been a
>> bug - but there wasn't.
>> Contains c++ source for reading the geometry of the testfile, the output
>> the program generates and the original zip of the nanga test shapefile.
>> Complexity of the geometric model follows from OGC specs.
>> But then, shapefiles support e.g. a collection of geometries (to be used
>> with a single set of attributes), as well.
>> (Nanga? Nanga Parbat? Couldn't make it out[?]).
>>  Jan
>>
>>
>> On Sun, May 18, 2014 at 12:53 AM, Jan Heckman <jan.heckman at gmail.com>wrote:
>>
>>> Hello Bruce,
>>> The point is that the geometrycount identifies two polygons, one a small
>>> little piece sort of inside a bay of your shape, the other the rest, along
>>> with the holes.
>>> See ogr_apitutorial <http://www.gdal.org/ogr/ogr_apitut.html> - all
>>> assuming you are using 1.11: *Starting with OGR 1.11, several geometry
>>> fields <http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields>** can
>>> be associated to a feature*.
>>> The little hidden piece starts at (approx) 467767;3900845. It happens to
>>> be the first part of the shape.
>>> The example code in the link above should put you closer to all this;
>>> however, retrieving the polygon(part)s will take a bit more digging..
>>> Good luck,
>>> Jan
>>>
>>>
>>> On Thu, May 15, 2014 at 6:13 PM, Bruce Raup <bruceraup at gmail.com> wrote:
>>>
>>>> Hello,
>>>>
>>>> I have a Python script that reads a shapefile, converts holes in
>>>> polygons to top-level polygons, and writes a new polygon.  The new
>>>> top-level polygons inherit attributes from their parents, with optional
>>>> modifications of specific attributes.  For a simple test shapefile, the
>>>> output of shpdump shows what I mean:
>>>>
>>>> $ shpdump simple_shapes_with_holes.shp
>>>> Shapefile Type: Polygon   # of Shapes: 3
>>>>
>>>> File Bounds: (      -1.113,       0.146,0,0)
>>>>          to  (       0.751,       1.101,0,0)
>>>>
>>>> Shape:0 (Polygon)  nVertices=11, nParts=2
>>>>   Bounds:(      -1.113,       0.146, 0, 0)
>>>>       to (      -0.493,       0.723, 0, 0)
>>>>      (      -1.087,       0.151, 0, 0) Ring
>>>>      (      -1.113,       0.686, 0, 0)
>>>>      (      -1.109,       0.712, 0, 0)
>>>>      (      -0.506,       0.723, 0, 0)
>>>>      (      -0.493,       0.146, 0, 0)
>>>>      (      -1.087,       0.151, 0, 0)
>>>>    + (      -0.896,       0.346, 0, 0) Ring
>>>>      (      -0.682,       0.339, 0, 0)
>>>>      (      -0.684,       0.556, 0, 0)
>>>>      (      -0.909,       0.558, 0, 0)
>>>>      (      -0.896,       0.346, 0, 0)
>>>>
>>>> Shape:1 (Polygon)  nVertices=19, nParts=4
>>>>   Bounds:(      -0.127,       0.159, 0, 0)
>>>>       to (       0.751,       0.783, 0, 0)
>>>>      (       0.402,       0.783, 0, 0) Ring
>>>>      (       0.751,       0.159, 0, 0)
>>>>      (      -0.127,       0.198, 0, 0)
>>>>      (       0.402,       0.783, 0, 0)
>>>>    + (       0.298,       0.539, 0, 0) Ring
>>>>      (       0.417,       0.523, 0, 0)
>>>>      (       0.426,       0.612, 0, 0)
>>>>      (       0.339,       0.625, 0, 0)
>>>>      (       0.298,       0.539, 0, 0)
>>>>    + (       0.083,       0.263, 0, 0) Ring
>>>>      (       0.248,       0.252, 0, 0)
>>>>      (       0.213,       0.396, 0, 0)
>>>>      (       0.107,       0.367, 0, 0)
>>>>      (       0.083,       0.263, 0, 0)
>>>>    + (       0.361,       0.281, 0, 0) Ring
>>>>      (       0.530,       0.265, 0, 0)
>>>>      (       0.435,       0.413, 0, 0)
>>>>      (       0.330,       0.435, 0, 0)
>>>>      (       0.361,       0.281, 0, 0)
>>>>
>>>> Shape:2 (Polygon)  nVertices=6, nParts=1
>>>>   Bounds:(      -0.389,       0.681, 0, 0)
>>>>       to (       0.141,       1.101, 0, 0)
>>>>      (      -0.383,       1.005, 0, 0) Ring
>>>>      (      -0.136,       1.101, 0, 0)
>>>>      (       0.141,       0.964, 0, 0)
>>>>      (      -0.154,       0.681, 0, 0)
>>>>      (      -0.389,       0.809, 0, 0)
>>>>      (      -0.383,       1.005, 0, 0)
>>>>
>>>>
>>>>
>>>>
>>>> $ shpdump simple_shapes_with_holes_flattened.shp
>>>> Shapefile Type: Polygon   # of Shapes: 7
>>>>
>>>> File Bounds: (      -1.113,       0.146,0,0)
>>>>          to  (       0.751,       1.101,0,0)
>>>>
>>>> Shape:0 (Polygon)  nVertices=6, nParts=1
>>>>   Bounds:(      -1.113,       0.146, 0, 0)
>>>>       to (      -0.493,       0.723, 0, 0)
>>>>      (      -1.087,       0.151, 0, 0) Ring
>>>>      (      -1.113,       0.686, 0, 0)
>>>>      (      -1.109,       0.712, 0, 0)
>>>>      (      -0.506,       0.723, 0, 0)
>>>>      (      -0.493,       0.146, 0, 0)
>>>>      (      -1.087,       0.151, 0, 0)
>>>>
>>>> Shape:1 (Polygon)  nVertices=5, nParts=1
>>>>   Bounds:(      -0.909,       0.339, 0, 0)
>>>>       to (      -0.682,       0.558, 0, 0)
>>>>      (      -0.896,       0.346, 0, 0) Ring
>>>>      (      -0.909,       0.558, 0, 0)
>>>>      (      -0.684,       0.556, 0, 0)
>>>>      (      -0.682,       0.339, 0, 0)
>>>>      (      -0.896,       0.346, 0, 0)
>>>>
>>>> Shape:2 (Polygon)  nVertices=4, nParts=1
>>>>   Bounds:(      -0.127,       0.159, 0, 0)
>>>>       to (       0.751,       0.783, 0, 0)
>>>>      (       0.402,       0.783, 0, 0) Ring
>>>>      (       0.751,       0.159, 0, 0)
>>>>      (      -0.127,       0.198, 0, 0)
>>>>      (       0.402,       0.783, 0, 0)
>>>>
>>>> Shape:3 (Polygon)  nVertices=5, nParts=1
>>>>   Bounds:(       0.298,       0.523, 0, 0)
>>>>       to (       0.426,       0.625, 0, 0)
>>>>      (       0.298,       0.539, 0, 0) Ring
>>>>      (       0.339,       0.625, 0, 0)
>>>>      (       0.426,       0.612, 0, 0)
>>>>      (       0.417,       0.523, 0, 0)
>>>>      (       0.298,       0.539, 0, 0)
>>>>
>>>> Shape:4 (Polygon)  nVertices=5, nParts=1
>>>>   Bounds:(       0.083,       0.252, 0, 0)
>>>>       to (       0.248,       0.396, 0, 0)
>>>>      (       0.083,       0.263, 0, 0) Ring
>>>>      (       0.107,       0.367, 0, 0)
>>>>      (       0.213,       0.396, 0, 0)
>>>>      (       0.248,       0.252, 0, 0)
>>>>      (       0.083,       0.263, 0, 0)
>>>>
>>>> Shape:5 (Polygon)  nVertices=5, nParts=1
>>>>   Bounds:(       0.330,       0.265, 0, 0)
>>>>       to (       0.530,       0.435, 0, 0)
>>>>      (       0.361,       0.281, 0, 0) Ring
>>>>      (       0.330,       0.435, 0, 0)
>>>>      (       0.435,       0.413, 0, 0)
>>>>      (       0.530,       0.265, 0, 0)
>>>>      (       0.361,       0.281, 0, 0)
>>>>
>>>> Shape:6 (Polygon)  nVertices=6, nParts=1
>>>>   Bounds:(      -0.389,       0.681, 0, 0)
>>>>       to (       0.141,       1.101, 0, 0)
>>>>      (      -0.383,       1.005, 0, 0) Ring
>>>>      (      -0.136,       1.101, 0, 0)
>>>>      (       0.141,       0.964, 0, 0)
>>>>      (      -0.154,       0.681, 0, 0)
>>>>      (      -0.389,       0.809, 0, 0)
>>>>      (      -0.383,       1.005, 0, 0)
>>>>
>>>>
>>>> I have a shapefile for which this doesn't work, however, and I suspect
>>>> it's perhaps a difference in the way the inner rings are represented.  In
>>>> this real shapefile, the top part of the output from shpdump looks like
>>>>
>>>>
>>>> Shapefile Type: Polygon   # of Shapes: 1
>>>>
>>>> File Bounds: (  462611.523, 3894164.223,0,0)
>>>>          to  (  470338.347, 3901974.217,0,0)
>>>>
>>>> Shape:0 (Polygon)  nVertices=1575, nParts=14
>>>>   Bounds:(  462611.523, 3894164.223, 0, 0)
>>>>       to (  470338.347, 3901974.217, 0, 0)
>>>>      (  467768.987, 3900844.546, 0, 0) Ring
>>>>      (  467744.058, 3900868.748, 0, 0)
>>>>      (  467702.110, 3900879.841, 0, 0)
>>>>      (  467670.108, 3900921.799, 0, 0)
>>>>      (  467632.530, 3900960.784, 0, 0)
>>>>      (  467689.198, 3900957.167, 0, 0)
>>>>      (  467751.895, 3900922.201, 0, 0)
>>>>      (  467785.655, 3900861.426, 0, 0)
>>>>      (  467768.987, 3900844.546, 0, 0)
>>>>    + (  467774.970, 3900834.757, 0, 0) Ring
>>>>      (  467796.445, 3900858.379, 0, 0)
>>>>      (  467850.763, 3900846.242, 0, 0)
>>>>      (  467900.197, 3900841.419, 0, 0)
>>>>      (  467927.928, 3900814.893, 0, 0)
>>>>      (  467936.368, 3900767.871, 0, 0)
>>>> .
>>>> .
>>>> .
>>>>
>>>> But my python code doesn't see all the parts.
>>>>
>>>>
>>>> $ python
>>>> Python 2.7 (r27:82500, Aug 07 2010, 16:54:59) [GCC] on linux2
>>>> Type "help", "copyright", "credits" or "license" for more information.
>>>> >>> from osgeo import ogr
>>>> >>> sf = ogr.Open('segments.shp')
>>>> >>> sl = sf.GetLayer(0)
>>>> >>> sl
>>>> <osgeo.ogr.Layer; proxy of <Swig Object of type 'OGRLayerShadow *' at
>>>> 0xb7472980> >
>>>> >>> feat = sl[0]
>>>> >>> feat
>>>> <osgeo.ogr.Feature; proxy of <Swig Object of type 'OGRFeatureShadow *'
>>>> at 0xb7472620> >
>>>> >>> sg = feat.GetGeometryRef()
>>>> >>> sg
>>>> <osgeo.ogr.Geometry; proxy of <Swig Object of type 'OGRGeometryShadow
>>>> *' at 0xb749e770> >
>>>> >>> sg.GetGeometryCount()
>>>> 2
>>>> >>>
>>>>
>>>>
>>>> I would expect the output of sg.GetGeometryCount() to be 15.  Am I
>>>> doing something wrong?
>>>>
>>>> The complete script is at
>>>>
>>>> http://cires.colorado.edu/~braup/OGR/flatten_shapefile.py
>>>>
>>>> The testfile is at
>>>>
>>>> http://cires.colorado.edu/~braup/OGR/simple_shapes_with_holes.zip
>>>>
>>>> The "real" testfile on which the script fails is at:
>>>>
>>>> http://cires.colorado.edu/~braup/OGR/nanga_segments.zip
>>>>
>>>> Any pointers would be greatly appreciated.
>>>>
>>>> Cheers,
>>>> Bruce Raup
>>>>
>>>> --
>>>> Bruce Raup
>>>> http://cires.colorado.edu/~braup/
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>
>
>
> --
> 720-383-4668
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140521/e6435520/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 330.gif
Type: image/gif
Size: 96 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140521/e6435520/attachment-0001.gif>

From peter.lenou at gmail.com  Wed May 21 18:10:16 2014
From: peter.lenou at gmail.com (Peter Lenou)
Date: Thu, 22 May 2014 03:10:16 +0200
Subject: [gdal-dev] Help formatting 2 million images for geoserver WMS via
	GDAL
Message-ID: <CAGz5G874Gc_pCn+U4QZd3ntE1wEb4nG=Crpemewj_Z9myezDqA@mail.gmail.com>

I am trying to use the GDAL command line utilities to format 2 million
images (geotiff) of variable size in a form that can be uploaded to
geoserver to be served via WMS.

I am having problems determining what is the best method to format the data
i.e. do I pyramid the whole set using gdal_retile.py? do I build a VRT for
10k images, use gdal_translate to create an internally tiled image then
gdaladdo to create overviews? I can then use gdaltindex to create a
shapefile for all the resulting images and create an ImageMosaic layer in
geoserver.

What do people suggest is the best method to do this firstly from a GDAL
point of view, then integrating the results into geoserver?

Also, how do I add another million images in a months time? Do I have to go
through the whole process all over again or is there a way I can append
data?

Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140522/31fa9372/attachment.html>

From shuai at illinois.edu  Thu May 22 15:46:50 2014
From: shuai at illinois.edu (Zhang, Shuai)
Date: Thu, 22 May 2014 22:46:50 +0000
Subject: [gdal-dev] New OGR Driver for MongoDB
In-Reply-To: <1400702895.11428.72.camel@travel>
References: <2DAEBB32799F494EBE504E1247CC5E8220E59BF4@CITESMBX6.ad.uillinois.edu>
	,<1400520138.11428.31.camel@travel>
	<2DAEBB32799F494EBE504E1247CC5E8220E5B4E0@CITESMBX6.ad.uillinois.edu>,
	<1400702895.11428.72.camel@travel>
Message-ID: <2DAEBB32799F494EBE504E1247CC5E8220E64C79@CHIMBX6.ad.uillinois.edu>

Hey Nicol,

you are right, you should put the folder in the  'ogr/ogrsf_frmts' directory .
But the parameters set to compile the driver into gdal/ogr can be a little bit complicated.
You could find some clues on "OGR Driver Implementation Tutorial", 
but you still need to handle the mongodb lib things.

if you do not want to bother, attached are a version which could run on windows platform. 
in the nmake.opt file, set MONGO Library to your path. i think it will work.

just let me know.
and sorry I haven't make everything ready to use.

yours,
shuai
________________________________________
From: Nicol Hermann [mapserver at geoworld.de]
Sent: Wednesday, May 21, 2014 3:08 PM
To: Zhang, Shuai
Subject: Re: [gdal-dev] New OGR Driver for MongoDB

Hello shuai,

me again.
I checked out the Mongo driver from the Git repository but have some
trouble which steps are necessary to include it into the GDAL trunk.
Can you please provide me some hints.
I assume I have to copy the 'mongo' directory to 'ogr/ogrsf_frmts',
right?
Anything to consider to have it available as 'configure' option?

Thanks for your assistance
Nicol


Am Montag, den 19.05.2014, 21:12 +0000 schrieb Zhang, Shuai:
> Hi Nicol,
>
> Great you are interested.
> I opened up a ticket for this project, as you may find here: http://trac.osgeo.org/gdal/ticket/5453
> you may also find the source code in my github https://github.com/geosky/mongodb-gdal-driver
> glad if you could join in the mongogis group i set up in the github, we may have some discusses there.
>
> thanks,
> shuai
> ________________________________________
> From: Nicol Hermann [mapserver at geoworld.de]
> Sent: Monday, May 19, 2014 12:22 PM
> To: Zhang, Shuai
> Subject: Re: [gdal-dev] New OGR Driver for MongoDB
>
> Hello Shuai,
>
> I saw your post about the Mongo driver in the GDAL mailing list.
> Is the driver you wrote for OGR already available somewhere?
> Did you open up a ticket like Kyle recommended?
> If so it would be great if you could share the ticket number with me.
> Thank you very much.
> Nicol
>
>
> Am Mittwoch, den 30.04.2014, 13:55 +0000 schrieb Zhang, Shuai:
> > Hi there,
> >
> >
> > I wrote a ogr driver for mongodb and wish to contribute to the
> > community.
> > but I'm not sure where to start and how to do it.
> > Is there anyone who can give me a hand or some guidance about it?
> > it will be terrific if you know geojson driver or couchdb driver
> > well,
> > so that we may have discussions on the code level.
> >
> >
> > Thanks,
> > Shuai
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>



From jmckenna at gatewaygeomatics.com  Fri May 23 05:36:43 2014
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 23 May 2014 09:36:43 -0300
Subject: [gdal-dev] New OGR Driver for MongoDB
In-Reply-To: <2DAEBB32799F494EBE504E1247CC5E8220E64C79@CHIMBX6.ad.uillinois.edu>
References: <2DAEBB32799F494EBE504E1247CC5E8220E59BF4@CITESMBX6.ad.uillinois.edu>	,
	<1400520138.11428.31.camel@travel>	<2DAEBB32799F494EBE504E1247CC5E8220E5B4E0@CITESMBX6.ad.uillinois.edu>,
	<1400702895.11428.72.camel@travel>
	<2DAEBB32799F494EBE504E1247CC5E8220E64C79@CHIMBX6.ad.uillinois.edu>
Message-ID: <537F40DB.2010203@gatewaygeomatics.com>

Hi Shuai,

Would you be willing to outline your MongoDB build steps on a new page
in the BuildHints wiki?  (in section "External Library Issues"
http://trac.osgeo.org/gdal/wiki/BuildHints).  That way everyone can
follow your steps and they are not lost in the email archives.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

On 2014-05-22, 7:46 PM, Zhang, Shuai wrote:
> Hey Nicol,
> 
> you are right, you should put the folder in the  'ogr/ogrsf_frmts' directory .
> But the parameters set to compile the driver into gdal/ogr can be a little bit complicated.
> You could find some clues on "OGR Driver Implementation Tutorial", 
> but you still need to handle the mongodb lib things.
> 
> if you do not want to bother, attached are a version which could run on windows platform. 
> in the nmake.opt file, set MONGO Library to your path. i think it will work.
> 
> just let me know.
> and sorry I haven't make everything ready to use.
> 
> yours,
> shuai
> ________________________________________
> From: Nicol Hermann [mapserver at geoworld.de]
> Sent: Wednesday, May 21, 2014 3:08 PM
> To: Zhang, Shuai
> Subject: Re: [gdal-dev] New OGR Driver for MongoDB
> 
> Hello shuai,
> 
> me again.
> I checked out the Mongo driver from the Git repository but have some
> trouble which steps are necessary to include it into the GDAL trunk.
> Can you please provide me some hints.
> I assume I have to copy the 'mongo' directory to 'ogr/ogrsf_frmts',
> right?
> Anything to consider to have it available as 'configure' option?
> 
> Thanks for your assistance
> Nicol
> 
> 
> Am Montag, den 19.05.2014, 21:12 +0000 schrieb Zhang, Shuai:
>> Hi Nicol,
>>
>> Great you are interested.
>> I opened up a ticket for this project, as you may find here: http://trac.osgeo.org/gdal/ticket/5453
>> you may also find the source code in my github https://github.com/geosky/mongodb-gdal-driver
>> glad if you could join in the mongogis group i set up in the github, we may have some discusses there.
>>
>> thanks,
>> shuai
>> ________________________________________
>> From: Nicol Hermann [mapserver at geoworld.de]
>> Sent: Monday, May 19, 2014 12:22 PM
>> To: Zhang, Shuai
>> Subject: Re: [gdal-dev] New OGR Driver for MongoDB
>>
>> Hello Shuai,
>>
>> I saw your post about the Mongo driver in the GDAL mailing list.
>> Is the driver you wrote for OGR already available somewhere?
>> Did you open up a ticket like Kyle recommended?
>> If so it would be great if you could share the ticket number with me.
>> Thank you very much.
>> Nicol
>>
>>
>> Am Mittwoch, den 30.04.2014, 13:55 +0000 schrieb Zhang, Shuai:
>>> Hi there,
>>>
>>>
>>> I wrote a ogr driver for mongodb and wish to contribute to the
>>> community.
>>> but I'm not sure where to start and how to do it.
>>> Is there anyone who can give me a hand or some guidance about it?
>>> it will be terrific if you know geojson driver or couchdb driver
>>> well,
>>> so that we may have discussions on the code level.
>>>
>>>
>>> Thanks,
>>> Shuai


From mccorb at cox.net  Fri May 23 09:49:17 2014
From: mccorb at cox.net (mccorb)
Date: Fri, 23 May 2014 09:49:17 -0700 (PDT)
Subject: [gdal-dev] GML file with multiple shape types
Message-ID: <1400863757732-5142207.post@n6.nabble.com>

1. Can OGR style GML files have multiple shape types (point, linestring,
polygon, etc) and coordinate projections defined in a single file? Based on
just the file structure it looks like the answer is probably yes...
2. If yes, can OGR2OGR be run somehow with multiple shape files to create a
single output GML file?

thanks




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GML-file-with-multiple-shape-types-tp5142207.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Fri May 23 11:17:35 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 23 May 2014 20:17:35 +0200
Subject: [gdal-dev] GML file with multiple shape types
In-Reply-To: <1400863757732-5142207.post@n6.nabble.com>
References: <1400863757732-5142207.post@n6.nabble.com>
Message-ID: <201405232017.35325.even.rouault@mines-paris.org>

Le vendredi 23 mai 2014 18:49:17, mccorb a ?crit :
> 1. Can OGR style GML files have multiple shape types (point, linestring,
> polygon, etc) and coordinate projections defined in a single file? Based on
> just the file structure it looks like the answer is probably yes...

- OGR can general GML files with several layers, each with any arbitrary shape 
type.
- OGR can generate GML files with different SRS per layer (some recent fixes in 
OGR 1.11 have been done related to that by the way). However when reading them 
back, it will generally not report the SRS in that situation.

> 2. If yes, can OGR2OGR be run somehow with multiple shape files to create a
> single output GML file?

The GML driver doesn't support append mode, so you will have to do the merging 
by yourself first. But that is not necessarily complicated :
* If your input files are shapefiles, you can just put them in a single 
directory and use the directory name as the OGR datasource name. In which case 
each shapefile will be seen as a layer.
* Otherwise, you can use the virtual dataset mechanism (VRT) to combine 
arbitrary layers into a single virtual dataset.

> 
> thanks
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GML-file-with-multiple-shape-types-tp5
> 142207.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From varunsaraf14 at gmail.com  Fri May 23 14:14:01 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Sat, 24 May 2014 02:44:01 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 1 : Implement write support for
 GDAL PostGIS Raster driver for GDAL
Message-ID: <CAPfr+rsD_86CjKfGk4t1Xs-yX2+ssV45jn3W2ufXUxMAMB8mog@mail.gmail.com>

Hi,

Below is my first weekly report:

*What did I do this week?*

   - Tried to understand and familiarize myself with the I/O system in GDAL.
   - Learnt more about the different sets of API in GDAL : Create(),
   CreateCopy() and IRasterIO().

*What do I plan on doing next week?*

   - Learn more about Create() and CreateCopy() API's in order to replicate
   raster2pgsql from PostGIS.
   - Create the sql query which will write data to the PostgreSQL tables.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-1
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/5d276fa2/attachment.html>

From gusevmihs at gmail.com  Fri May 23 14:18:25 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 24 May 2014 01:18:25 +0400
Subject: [gdal-dev] GSoC weekly report 1. OGR Networking
Message-ID: <CAJB43Vps4LoATy36LX0n2LARr5zykUdux56XGQYpD-pFvX4aAA@mail.gmail.com>

Hello everyone!

Links:
Project wiki: http://trac.osgeo.org/gdal/wiki/geography_network_support
Github: https://github.com/MikhanGusev/gnm
Blog: http://gsoc2014gnm.blogspot.ru/

During this week I worked on the business logic of the networks in OGR. You
are welcome to see my last post in the blog to get more details. There is
nothing that I'm blocked on now, but there is a question about a final
implementation of the new OGR API. I have already proposed some ideas in my
blog. I think it will be good to decide now, so the next step for me is to
discuss with my mentors the final implementation, make a decision and work
in that direction. Anyway, as the most part of my code will stay the same,
I continue do the following: complete the business logic support and
implement missing methods (disconnectFeatures(), removeRule(),
unblockFeature()).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/a46f2e2f/attachment.html>

From even.rouault at mines-paris.org  Sat May 24 07:35:35 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 24 May 2014 16:35:35 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
Message-ID: <201405241635.35384.even.rouault@mines-paris.org>

> Motion : I move to adopt RFC 46: GDAL/OGR unification
> 
>     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> 

Hi,

The motion has been adopted with support from PSC members JukkaR, FrankW, 
DanielM, TamasS and myself.

The code has also been merged in trunk now. Version number upgraded to 2.0dev. 
Full rebuild needed ! Let me know if issues arise.

I've also done some unification of the online documentation on gdal.org too, by 
merging the previous gdal.org/ogr/index.html into the main 
gdal.org/index.html. Basically the "make docs" target in GDAL root directory 
generate the whole doc. Those changes will be reflected on the server in a few 
hours. Still work to do to update the tutorials.
I've installed in http://gdal.org/1.11/ the snapshot of the 1.11 
documentation, that will be mentionned in gdal.org main page, so that the 
trunk documentation can evolve more easily.

Question : I see that in http://gdal.org/credits.html we still have mentions 
to past sponsors, but the sponsorship program is more or less abandonned, so I 
think we could remove the Sponsorship section, and make sure that those past 
sponsors are just mentionned in the "Corporate" section.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From etourigny.dev at gmail.com  Sat May 24 12:28:39 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Sat, 24 May 2014 16:28:39 -0300
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <201405241635.35384.even.rouault@mines-paris.org>
References: <201405241635.35384.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvOYCd7zSgwxkCKY65QBx5XiH2OAi+v_gmFPkJpCpitmFw@mail.gmail.com>

Hi Even, great work!

Quick testing was fine and revealed no errors.

I was able to compile it in QGIS master very easily. The only "issue" I
encountered was related to GDALRegisterAll() and OGRAllRegister()
registering all drivers (raster and vector), requiring to ignore the
vector-only drivers in the raster-only related code in QGIS.

May I suggest a change that would improve backwards-compatibility and avoid
unwanted issues? Perhaps these 2 functions should only register raster or
vector drivers (as in GDAL 1.x), instead of all drivers, and a new function
would register both raster and vector drivers. This would ensure old code
behaves as previously, and ensure that no extra drivers are loaded and
probed when only raster/vector drivers are needed.

Just to be clearer here is how I would see it:
GDALRegisterAll() -> registers raster drivers (those with
GDAL_DCAP_RASTER="YES")
OGRAllRegister() -> registers vector drivers (those with
GDAL_DCAP_VECTOR="YES")
GDALRegisterDrivers() -> registers all drivers

On the other habd, I imagine this may not be easy to implement and could
cause some confusion in the future. Also, probing optimization can instead
be achieved using GDALOpenEx() specifying raster vs.vector drivers.

cheers,
Etienne




On Sat, May 24, 2014 at 11:35 AM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> > Motion : I move to adopt RFC 46: GDAL/OGR unification
> >
> >     http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification
> >
>
> Hi,
>
> The motion has been adopted with support from PSC members JukkaR, FrankW,
> DanielM, TamasS and myself.
>
> The code has also been merged in trunk now. Version number upgraded to
> 2.0dev.
> Full rebuild needed ! Let me know if issues arise.
>
> I've also done some unification of the online documentation on gdal.orgtoo, by
> merging the previous gdal.org/ogr/index.html into the main
> gdal.org/index.html. Basically the "make docs" target in GDAL root
> directory
> generate the whole doc. Those changes will be reflected on the server in a
> few
> hours. Still work to do to update the tutorials.
> I've installed in http://gdal.org/1.11/ the snapshot of the 1.11
> documentation, that will be mentionned in gdal.org main page, so that the
> trunk documentation can evolve more easily.
>
> Question : I see that in http://gdal.org/credits.html we still have
> mentions
> to past sponsors, but the sponsorship program is more or less abandonned,
> so I
> think we could remove the Sponsorship section, and make sure that those
> past
> sponsors are just mentionned in the "Corporate" section.
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/8700d2dc/attachment.html>

From even.rouault at mines-paris.org  Sat May 24 12:54:53 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 24 May 2014 21:54:53 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <CA+TxYvOYCd7zSgwxkCKY65QBx5XiH2OAi+v_gmFPkJpCpitmFw@mail.gmail.com>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<CA+TxYvOYCd7zSgwxkCKY65QBx5XiH2OAi+v_gmFPkJpCpitmFw@mail.gmail.com>
Message-ID: <201405242154.53555.even.rouault@mines-paris.org>

Le samedi 24 mai 2014 21:28:39, Etienne Tourigny a ?crit :
> Hi Even, great work!
> 
> Quick testing was fine and revealed no errors.
> 
> I was able to compile it in QGIS master very easily. The only "issue" I
> encountered was related to GDALRegisterAll() and OGRAllRegister()
> registering all drivers (raster and vector), requiring to ignore the
> vector-only drivers in the raster-only related code in QGIS.

Yeah, I've noticed a similar issue in PostGIS because they unload now all 
drivers by default except those in a white list, and they still needed a OGR 
driver.

> 
> May I suggest a change that would improve backwards-compatibility and avoid
> unwanted issues? Perhaps these 2 functions should only register raster or
> vector drivers (as in GDAL 1.x), instead of all drivers, and a new function
> would register both raster and vector drivers. This would ensure old code
> behaves as previously, and ensure that no extra drivers are loaded and
> probed when only raster/vector drivers are needed.
> 
> Just to be clearer here is how I would see it:
> GDALRegisterAll() -> registers raster drivers (those with
> GDAL_DCAP_RASTER="YES")
> OGRAllRegister() -> registers vector drivers (those with
> GDAL_DCAP_VECTOR="YES")
> GDALRegisterDrivers() -> registers all drivers
> 
> On the other habd, I imagine this may not be easy to implement and could
> cause some confusion in the future.

That could be done, although I'm not sure it is really worth doing. There will 
be likely other changes in GDAL 2.0 development that will require adjustments 
in calling code.
In your suggestion a driver that has a raster and vector face (like the re-
unified PDF and PCIDSK done in RFC 46) should be listed in the two lists.

Actually in QGIS case, the issue is likely not driver registration, but driver 
listing (in QGIS, both GDAL and OGR driver should be registered). So that 
wouldn't help.

> Also, probing optimization can instead
> be achieved using GDALOpenEx() specifying raster vs.vector drivers.

GDALOpen() will only probe drivers that have raster capabilities. It is an 
alias of GDALOpenEx(filename, GDAL_OF_RASTER | update_flag )

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mailinglist.samfranklin at gmail.com  Sat May 24 12:45:45 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Sat, 24 May 2014 20:45:45 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata' values?
Message-ID: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>

Greetings. This is my first post to this mailing list, so apologies if I
commit a mailing-list faux-pas :)

I wonder if anyone can offer a suggestion, as I'm hoping I've missed
something obvious.

I regularly receive bathymetric DEMs, acquired by acoustic multibeam
echosounders (MBES) from offshore geophysical surveys that take the form of
narrow corridors of survey or irregularly shaped areas.

My goal is to have a end-to-end open source/GDAL workflow that converts the
bathymetric DEM to greyscale GEOTIFF which I can then use for further
processing/analysis using GDAL/OGR.

The convention in the offshore sector is to deliver bathymetric data as
single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly
spaced to form a grid and the textfile row order is spatially sequential.

However, crucially 'nodata' values are omitted from the XYZ.  I can only
assume the reasoning was to reduce the file size on disc. This is an
industry convention that will not change anytime soon.

gdal_translate obviously does not read these XYZ files as gdal throws an
error due to the lack of true rectangular grid.  I've read the XYZ info
http://www.gdal.org/frmt_xyz.html which is clear to me, no problem there.

I do not want to use gdal_grid on the XYZ as this will introduce a further
interpolation step. The XYZs I receive are already cleansed and gridded by
the surveyor which I don't wish to edit further.

So, I currently use a proprietary marine geophysical package which can
directly read the gridded XYZ without nodata values.  Using this package, I
can export to ESRI ASCII grid (.ASC) which I then use gdal_translate
without issue for my further processing steps.

I'd like the freedom of a non-proprietary solution and the only thing I can
think of is to write a python script to pre-process my XYZ into a format
that gdal will accept.  I was thinking of calculating the XY bounding box
of the data and output an XYZ that blends the original values and nodata
values in the correct row order.

If anyone is interested, see below link to a zip of three separate
examples, containing:
-- 'gridded' XYZ (without nodata values)
-- processed greyscale GEOTIFF (using proprietary package)
-- processed color-relief RGB GEOTIFF (using proprietary package)
https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
All data in these examples are referenced to SRS EPSG:27700.

If I've missed anything obvious, or if anyone has any thoughts of how I can
achieve my goal using GDAL or other, or comment on my proposed solution,
that would be greatly appreciated.

Thanks in advance.
Sam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/a6addf4d/attachment.html>

From etourigny.dev at gmail.com  Sat May 24 13:29:35 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Sat, 24 May 2014 17:29:35 -0300
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <201405242154.53555.even.rouault@mines-paris.org>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<CA+TxYvOYCd7zSgwxkCKY65QBx5XiH2OAi+v_gmFPkJpCpitmFw@mail.gmail.com>
	<201405242154.53555.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvPrNtrTCB+YGD4T1TUjnVaf5z9B+TUwWKEMuv682kFtjA@mail.gmail.com>

On Sat, May 24, 2014 at 4:54 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le samedi 24 mai 2014 21:28:39, Etienne Tourigny a ?crit :
> > Hi Even, great work!
> >
> > Quick testing was fine and revealed no errors.
> >
> > I was able to compile it in QGIS master very easily. The only "issue" I
> > encountered was related to GDALRegisterAll() and OGRAllRegister()
> > registering all drivers (raster and vector), requiring to ignore the
> > vector-only drivers in the raster-only related code in QGIS.
>
> Yeah, I've noticed a similar issue in PostGIS because they unload now all
> drivers by default except those in a white list, and they still needed a
> OGR
> driver.


> >
> > May I suggest a change that would improve backwards-compatibility and
> avoid
> > unwanted issues? Perhaps these 2 functions should only register raster or
> > vector drivers (as in GDAL 1.x), instead of all drivers, and a new
> function
> > would register both raster and vector drivers. This would ensure old code
> > behaves as previously, and ensure that no extra drivers are loaded and
> > probed when only raster/vector drivers are needed.
> >
> > Just to be clearer here is how I would see it:
> > GDALRegisterAll() -> registers raster drivers (those with
> > GDAL_DCAP_RASTER="YES")
> > OGRAllRegister() -> registers vector drivers (those with
> > GDAL_DCAP_VECTOR="YES")
> > GDALRegisterDrivers() -> registers all drivers
> >
> > On the other habd, I imagine this may not be easy to implement and could
> > cause some confusion in the future.
>
> That could be done, although I'm not sure it is really worth doing. There
> will
> be likely other changes in GDAL 2.0 development that will require
> adjustments
> in calling code.
> In your suggestion a driver that has a raster and vector face (like the re-
> unified PDF and PCIDSK done in RFC 46) should be listed in the two lists.
>
> Actually in QGIS case, the issue is likely not driver registration, but
> driver
> listing (in QGIS, both GDAL and OGR driver should be registered). So that
> wouldn't help.
>

sort of - the side effect of registering all vector drivers was that vector
drivers were listed, so I filtered them using the GDAL_DCAP_RASTER



>
> > Also, probing optimization can instead
> > be achieved using GDALOpenEx() specifying raster vs.vector drivers.
>
> GDALOpen() will only probe drivers that have raster capabilities. It is an
> alias of GDALOpenEx(filename, GDAL_OF_RASTER | update_flag )
>

right- got confused there

anyway - if important issues come up it might be worth changing this, if
not no biggie. Again congrats!

Etienne

>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/678ba53d/attachment-0001.html>

From mateusz at loskot.net  Sat May 24 14:07:07 2014
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat, 24 May 2014 14:07:07 -0700 (PDT)
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <201405241635.35384.even.rouault@mines-paris.org>
References: <201405241635.35384.even.rouault@mines-paris.org>
Message-ID: <1400965627856-5142357.post@n6.nabble.com>

Hi,

I can confirm the trunk builds without any problems with VS2013.

Thanks Even!

Best regards,
Mateusz Loskot 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-RFC-46-GDAL-OGR-unification-adopted-and-commited-tp5142327p5142357.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From pcreso at pcreso.com  Sat May 24 14:25:49 2014
From: pcreso at pcreso.com (Brent Wood)
Date: Sat, 24 May 2014 14:25:49 -0700 (PDT)
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
Message-ID: <1400966749.44551.YahooMailNeo@web121201.mail.ne1.yahoo.com>

Hi 


Any reason for requiring a GDAL only system?

GMT & MB (MultiBeam) System (http://gmt.soest.hawaii.edu/ & http://www.ldeo.columbia.edu/res/pi/MB-System/ ) are Open Source tools built specifically for working with seabed & multibeam data.

GMT netCDF grids are supported by GDAL, & GMT can also create the greyscale geotiffsdirectly from the grid data, the combination of GMT & GDALis extremely powerful and effective.

The other Open Source tools I'd look at in this context, for a fully functional suite for such work, is Postgis, where the new pgraster functionality allows you to manage the gridded data (including large sets of geotiff imagery.

Of course, in the FOSS arena, there is also GRASS, which has some very powerful raster/DEM tools, but I find of limited value in the maritime arena, as well as OSSIM, both include command line tools you can script along with GDAL. And there are others, but in the maritime & multibeam Open Source space I suggest that GMT & MB System (ideally with GDAL) reign supreme :-)

Cheers,

?? Brent Wood


________________________________
 From: Sam Franklin <mailinglist.samfranklin at gmail.com>
To: gdal-dev at lists.osgeo.org 
Sent: Sunday, May 25, 2014 7:45 AM
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata' values?
 


Greetings. This is my first post to this mailing list, so apologies if I commit a mailing-list faux-pas :)

I wonder if anyone can offer a suggestion, as I'm hoping I've missed something obvious.

I regularly receive bathymetric DEMs, acquired by acoustic multibeam echosounders (MBES) from offshore geophysical surveys that take the form of narrow corridors of survey or irregularly shaped areas.

My goal is to have a end-to-end open source/GDAL workflow that converts the bathymetric DEM to greyscale GEOTIFF which I can then use for further processing/analysis using GDAL/OGR.

The convention in the offshore sector is to deliver bathymetric data as single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly spaced to form a grid and the textfile row order is spatially sequential.

However, crucially 'nodata' values are omitted from the XYZ. ?I can only assume the reasoning was to reduce the file size on disc. This is an industry convention that will not change anytime soon.

gdal_translate obviously does not read these XYZ files as gdal throws an error due to the lack of true rectangular grid. ?I've read the XYZ info http://www.gdal.org/frmt_xyz.html which is clear to me, no problem there.


I do not want to use gdal_grid on the XYZ as this will introduce a further interpolation step. The XYZs I receive are already cleansed and gridded by the surveyor which I don't wish to edit further.


So, I currently use a proprietary marine geophysical package which can directly read the gridded XYZ without nodata values. ?Using this package, I can export to ESRI ASCII grid (.ASC) which I then use gdal_translate without issue for my further processing steps.

I'd like the freedom of a non-proprietary solution and the only thing I can think of is to write a python script to pre-process my XYZ into a format that gdal will accept. ?I was thinking of calculating the XY bounding box of the data and output an XYZ that blends the original values and nodata values in the correct row order.

If anyone is interested, see below link to a zip of three separate examples, containing:
-- 'gridded' XYZ (without nodata values)
-- processed greyscale GEOTIFF (using proprietary package)
-- processed color-relief RGB GEOTIFF (using proprietary package)
https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
All data in these examples are referenced to SRS EPSG:27700.

If I've missed anything obvious, or if anyone has any thoughts of how I can achieve my goal using GDAL or other, or comment on my proposed solution, that would be greatly appreciated.

Thanks in advance.
Sam
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/2b68ad5a/attachment.html>

From even.rouault at mines-paris.org  Sat May 24 15:43:02 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 25 May 2014 00:43:02 +0200
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
Message-ID: <201405250043.02661.even.rouault@mines-paris.org>

Le samedi 24 mai 2014 21:45:45, Sam Franklin a ?crit :
> Greetings. This is my first post to this mailing list, so apologies if I
> commit a mailing-list faux-pas :)
> 
> I wonder if anyone can offer a suggestion, as I'm hoping I've missed
> something obvious.
> 
> I regularly receive bathymetric DEMs, acquired by acoustic multibeam
> echosounders (MBES) from offshore geophysical surveys that take the form of
> narrow corridors of survey or irregularly shaped areas.
> 
> My goal is to have a end-to-end open source/GDAL workflow that converts the
> bathymetric DEM to greyscale GEOTIFF which I can then use for further
> processing/analysis using GDAL/OGR.
> 
> The convention in the offshore sector is to deliver bathymetric data as
> single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly
> spaced to form a grid and the textfile row order is spatially sequential.
> 
> However, crucially 'nodata' values are omitted from the XYZ.  I can only
> assume the reasoning was to reduce the file size on disc. This is an
> industry convention that will not change anytime soon.
> 
> gdal_translate obviously does not read these XYZ files as gdal throws an
> error due to the lack of true rectangular grid.  I've read the XYZ info
> http://www.gdal.org/frmt_xyz.html which is clear to me, no problem there.
> 
> I do not want to use gdal_grid on the XYZ as this will introduce a further
> interpolation step. The XYZs I receive are already cleansed and gridded by
> the surveyor which I don't wish to edit further.
> 
> So, I currently use a proprietary marine geophysical package which can
> directly read the gridded XYZ without nodata values.  Using this package, I
> can export to ESRI ASCII grid (.ASC) which I then use gdal_translate
> without issue for my further processing steps.
> 
> I'd like the freedom of a non-proprietary solution and the only thing I can
> think of is to write a python script to pre-process my XYZ into a format
> that gdal will accept.  I was thinking of calculating the XY bounding box
> of the data and output an XYZ that blends the original values and nodata
> values in the correct row order.
> 
> If anyone is interested, see below link to a zip of three separate
> examples, containing:
> -- 'gridded' XYZ (without nodata values)
> -- processed greyscale GEOTIFF (using proprietary package)
> -- processed color-relief RGB GEOTIFF (using proprietary package)
> https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
> All data in these examples are referenced to SRS EPSG:27700.
> 
> If I've missed anything obvious, or if anyone has any thoughts of how I can
> achieve my goal using GDAL or other, or comment on my proposed solution,
> that would be greatly appreciated.

What would be interesting is a link to a XYZ file that fails to be opened. In 
GDAL 1.11, I've improved the driver to be able to handle lines with missing 
values at their start and end. It might be possible to improve it again to 
deal with nodata values that would be at any place within lines. If the whole 
file is regularly gridded of course.

> 
> Thanks in advance.
> Sam

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gordonfarquharson at gmail.com  Sat May 24 15:53:35 2014
From: gordonfarquharson at gmail.com (Gordon Farquharson)
Date: Sat, 24 May 2014 15:53:35 -0700
Subject: [gdal-dev] Segmentation fault when using GDALReprojectImage
Message-ID: <CABwPwwKZ+=8X=MMz_nG=DVFhjNtO+8q7PM9YGBX=vNiLD0szFg@mail.gmail.com>

I am trying to warp a dataset read with the DTED driver by using
GDALReprojectImage. The output dataset is created with the MEM driver. The
program is failing with a segmentation fault. Below is a minimal working
program that shows the error, and the resulting output when run in GDB.

#include <iostream>
#include <string>

#include <gdal/gdal_priv.h>
#include <gdal/gdal_alg.h>
#include <gdal/gdalwarper.h>
#include <gdal/ogr_spatialref.h>
#include <gdal/cpl_conv.h>
#include <gdal/cpl_minixml.h>

namespace {
    const size_t SUCCESS = 0;
    const size_t ERROR_IN_COMMAND_LINE = 1;
    const size_t ERROR_IN_GDAL = 2;
    const size_t ERROR_UNHANDLED_EXCEPTION = 3;
}

void OGRCheckError(OGRErr errnum, const char *errstr)
{
    if (errnum != OGRERR_NONE)    {
    std::cout << errstr << " (" << errnum << ")" << std::endl;
    exit(ERROR_IN_GDAL);
    }
}

void CPLCheckError(CPLErr errnum)
{
    if (errnum == CE_Failure) {
    std::cerr << CPLGetLastErrorMsg() << std::endl;
    exit(ERROR_IN_GDAL);
    }
}

int main(int argc, char **argv)
{
    try {
    std::string pszFilename = "/mnt/raid/dted/w078/n34.dt2";

    OGRErr nOGRError;
    CPLErr eCPLError;

    GDALAllRegister();

    // GDAL: opening the input file

    GDALDataset *poSrcDataset;

    poSrcDataset = (GDALDataset *)GDALOpen(pszFilename.c_str(),
                           GA_ReadOnly);
    if (poSrcDataset == NULL) {
        std::cerr << CPLGetLastErrorMsg() << std::endl;
        return ERROR_IN_GDAL;
    }

    // GDAL: warp data

    GDALDatasetH hSrcDataset = poSrcDataset;
    GDALDatasetH hDstDataset;

    GDALDriverH hDstDriver;

    const char *pszDstProj4 = "+proj=utm +zone=11 +datum=WGS84";

    const char *pszSrcWKT = poSrcDataset->GetProjectionRef();
    char *pszDstWKT = NULL;

        OGRSpatialReference oSRS;

    double adfDstGeoTransform[6];
    int nPixels = 0, nLines = 0;

    nOGRError = oSRS.importFromProj4(pszDstProj4);
    OGRCheckError(nOGRError, "Error importing proj4 string");

    nOGRError = oSRS.exportToWkt(&pszDstWKT);
    OGRCheckError(nOGRError, "Error converting proj4 string to WKT");

    void *hTransformArg;

    hTransformArg =
        GDALCreateGenImgProjTransformer(hSrcDataset, pszSrcWKT,
                        NULL, pszDstWKT,
                        FALSE, 0, 1);
    if (hTransformArg == NULL) {
        std::cerr << CPLGetLastErrorMsg() << std::endl;
        return ERROR_IN_GDAL;
    }

    eCPLError = GDALSuggestedWarpOutput(hSrcDataset,
                        GDALGenImgProjTransform,
                        hTransformArg,
                        adfDstGeoTransform,
                        &nPixels, &nLines );
    CPLCheckError(eCPLError);

    // Construct destination Dataset

    std::cout << "Constructing output dataset" << std::endl;

    GDALDataset *poDstDataset;

    poDstDataset = GetGDALDriverManager()->
        GetDriverByName("MEM")->
        Create("", nPixels, nLines,
           poSrcDataset->GetRasterCount(),
           poSrcDataset->GetRasterBand(1)->GetRasterDataType(),
           NULL);
    if (poDstDataset == NULL) {
        std::cerr << CPLGetLastErrorMsg() << std::endl;
        return ERROR_IN_GDAL;
    }

    poDstDataset->SetProjection(pszDstWKT);
    poDstDataset->SetGeoTransform(adfDstGeoTransform);

    // Warp data

    std::cout << "Reprojecting image" << std::endl;

    eCPLError = GDALReprojectImage(hSrcDataset, pszSrcWKT,
                       hDstDataset, pszDstWKT,
                       GRA_Bilinear,
                       0.0, 0.0,
                       GDALTermProgress, NULL,
                       NULL);
    CPLCheckError(eCPLError);
    }

    catch(std::exception& e) {
    std::cerr << "Unhandled Exception reached the top of main: "
          << e.what() << ", application will now exit" << std::endl;
    return ERROR_UNHANDLED_EXCEPTION;
    }

    return SUCCESS;
}

The output in GDB is:

Starting program: /home/gordon/src/novcs/gdal-test/gdal-test-mwp
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Constructing output dataset
Reprojecting image

Program received signal SIGSEGV, Segmentation fault.
0x00007ffff7628a4c in GDALGetGeoTransform () from /usr/lib/libgdal.so.1

The program is compiled with

g++ -g gdal-test-mwp.cc -lgdal -Bshared -o gdal-test-mwp

I using the Debian Wheezy GDAL package:

Desired=Unknown/Install/Remove/Purge/Hold
|
Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)
||/ Name           Version      Architecture Description
+++-==============-============-============-=================================
ii  libgdal1       1.9.0-3.1    amd64        Geospatial Data Abstraction
Libra

Anybody got any ideas why this is failing?

Gordon

-- 
Gordon Farquharson
GnuPG Key ID: 32D6D676
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/7c5012ea/attachment-0001.html>

From gordonfarquharson at gmail.com  Sat May 24 16:09:09 2014
From: gordonfarquharson at gmail.com (Gordon Farquharson)
Date: Sat, 24 May 2014 16:09:09 -0700
Subject: [gdal-dev] Segmentation fault when using GDALReprojectImage
In-Reply-To: <CABwPwwKZ+=8X=MMz_nG=DVFhjNtO+8q7PM9YGBX=vNiLD0szFg@mail.gmail.com>
References: <CABwPwwKZ+=8X=MMz_nG=DVFhjNtO+8q7PM9YGBX=vNiLD0szFg@mail.gmail.com>
Message-ID: <CABwPwwJqSDrPueBift1Fo4Chj5zgG=3WJE2MWLtFQKKHr+7ZDQ@mail.gmail.com>

On Sat, May 24, 2014 at 3:53 PM, Gordon Farquharson <
gordonfarquharson at gmail.com> wrote:

> I am trying to warp a dataset read with the DTED driver by using
GDALReprojectImage. The output

I figured it out. I wasn't initializing hDstDataset.

Gordon

--
Gordon Farquharson
GnuPG Key ID: 32D6D676
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/01004352/attachment.html>

From mailinglist.samfranklin at gmail.com  Sat May 24 15:25:24 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Sat, 24 May 2014 23:25:24 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <1400966749.44551.YahooMailNeo@web121201.mail.ne1.yahoo.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<1400966749.44551.YahooMailNeo@web121201.mail.ne1.yahoo.com>
Message-ID: <CA+M-Ukg-c_3+dUjOfhq07u06W81yk7eecLjWdsN0-LuC4VR7ZQ@mail.gmail.com>

Hey Brent - Oh boy. I really appreciate the info.

GMT's xyz2grd looks very promising indeed |
http://gmt.soest.hawaii.edu/doc/latest/xyz2grd.html

I'll check out the other links too.

Embarrassingly, I've been banging my head against this brick wall for years
:-)

Many thanks Brent - total life saver!



On 24 May 2014 22:25, Brent Wood <pcreso at pcreso.com> wrote:

> Hi
>
> Any reason for requiring a GDAL only system?
>
> GMT & MB (MultiBeam) System ( http://gmt.soest.hawaii.edu/ &
> http://www.ldeo.columbia.edu/res/pi/MB-System/ ) are Open Source tools
> built specifically for working with seabed & multibeam data.
>
> GMT netCDF grids are supported by GDAL, & GMT can also create the
> greyscale geotiffs directly from the grid data, the combination of GMT &
> GDAL is extremely powerful and effective.
>
> The other Open Source tools I'd look at in this context, for a fully
> functional suite for such work, is Postgis, where the new pgraster
> functionality allows you to manage the gridded data (including large sets
> of geotiff imagery.
>
> Of course, in the FOSS arena, there is also GRASS, which has some very
> powerful raster/DEM tools, but I find of limited value in the maritime
> arena, as well as OSSIM, both include command line tools you can script
> along with GDAL. And there are others, but in the maritime & multibeam Open
> Source space I suggest that GMT & MB System (ideally with GDAL) reign
> supreme :-)
>
> Cheers,
>
>    Brent Wood
>   ------------------------------
>  *From:* Sam Franklin <mailinglist.samfranklin at gmail.com>
> *To:* gdal-dev at lists.osgeo.org
> *Sent:* Sunday, May 25, 2014 7:45 AM
> *Subject:* [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
> values?
>
> Greetings. This is my first post to this mailing list, so apologies if I
> commit a mailing-list faux-pas :)
>
> I wonder if anyone can offer a suggestion, as I'm hoping I've missed
> something obvious.
>
> I regularly receive bathymetric DEMs, acquired by acoustic multibeam
> echosounders (MBES) from offshore geophysical surveys that take the form of
> narrow corridors of survey or irregularly shaped areas.
>
> My goal is to have a end-to-end open source/GDAL workflow that converts
> the bathymetric DEM to greyscale GEOTIFF which I can then use for further
> processing/analysis using GDAL/OGR.
>
> The convention in the offshore sector is to deliver bathymetric data as
> single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly
> spaced to form a grid and the textfile row order is spatially sequential.
>
> However, crucially 'nodata' values are omitted from the XYZ.  I can only
> assume the reasoning was to reduce the file size on disc. This is an
> industry convention that will not change anytime soon.
>
> gdal_translate obviously does not read these XYZ files as gdal throws an
> error due to the lack of true rectangular grid.  I've read the XYZ info
> http://www.gdal.org/frmt_xyz.html which is clear to me, no problem there.
>
> I do not want to use gdal_grid on the XYZ as this will introduce a further
> interpolation step. The XYZs I receive are already cleansed and gridded by
> the surveyor which I don't wish to edit further.
>
> So, I currently use a proprietary marine geophysical package which can
> directly read the gridded XYZ without nodata values.  Using this package, I
> can export to ESRI ASCII grid (.ASC) which I then use gdal_translate
> without issue for my further processing steps.
>
> I'd like the freedom of a non-proprietary solution and the only thing I
> can think of is to write a python script to pre-process my XYZ into a
> format that gdal will accept.  I was thinking of calculating the XY
> bounding box of the data and output an XYZ that blends the original values
> and nodata values in the correct row order.
>
> If anyone is interested, see below link to a zip of three separate
> examples, containing:
> -- 'gridded' XYZ (without nodata values)
> -- processed greyscale GEOTIFF (using proprietary package)
> -- processed color-relief RGB GEOTIFF (using proprietary package)
> https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
> All data in these examples are referenced to SRS EPSG:27700.
>
> If I've missed anything obvious, or if anyone has any thoughts of how I
> can achieve my goal using GDAL or other, or comment on my proposed
> solution, that would be greatly appreciated.
>
> Thanks in advance.
> Sam
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/141e5897/attachment.html>

From pcreso at pcreso.com  Sat May 24 17:14:43 2014
From: pcreso at pcreso.com (Brent Wood)
Date: Sat, 24 May 2014 17:14:43 -0700 (PDT)
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no
	'nodata'	values?
In-Reply-To: <201405250043.02661.even.rouault@mines-paris.org>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405250043.02661.even.rouault@mines-paris.org>
Message-ID: <1400976883.79692.YahooMailNeo@web121202.mail.ne1.yahoo.com>

Hi Evan,

I figure most serious users of tools like these will not limit themselves by using a MS Windows platform (& those that do are masochists anyway :-), so using tools like awk (& sed & cut & grep) for pre-processing XYZ files with missing values in any column or other issues is a ready solution for most issues that such files have.


For example, for whitespace separated XYZ files which may have missing values:

if the missing values are just missing:

cat $FILE | awk '{ if(NF==3) print $0}' | ....


if missing values are represented by some value you want to change (eg: from -99999 to NaN )

cat $FILE | sed 's/-99999/NaN/g' | ....

The xNIX text processing tools have allowed me do do all the pre-processing I've ever needed, for use with GMT, GDAL, GRASS & R, and unless there are very common specific use cases, I think dome guidelines about using existing tools to solve these problems are more useful than replicating the functionality in GDAL. 


That said, an example of a useful (I think) case is with most GMT commands that take XYZ input, you can use the "-:" command line parameter (Expect lat/lon -YXZ- input/output rather than lon/lat) so you don't need awk...? 


Cheers,

(with grateful thanks for all your good work!)

Brent




________________________________
 From: Even Rouault <even.rouault at mines-paris.org>
To: gdal-dev at lists.osgeo.org 
Sent: Sunday, May 25, 2014 10:43 AM
Subject: Re: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'	values?
 

Le samedi 24 mai 2014 21:45:45, Sam Franklin a ?crit :
> Greetings. This is my first post to this mailing list, so apologies if I
> commit a mailing-list faux-pas :)
> 
> I wonder if anyone can offer a suggestion, as I'm hoping I've missed
> something obvious.
> 
> I regularly receive bathymetric DEMs, acquired by acoustic multibeam
> echosounders (MBES) from offshore geophysical surveys that take the form of
> narrow corridors of survey or irregularly shaped areas.
> 
> My goal is to have a end-to-end open source/GDAL workflow that converts the
> bathymetric DEM to greyscale GEOTIFF which I can then use for further
> processing/analysis using GDAL/OGR.
> 
> The convention in the offshore sector is to deliver bathymetric data as
> single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly
> spaced to form a grid and the textfile row order is spatially sequential.
> 
> However, crucially 'nodata' values are omitted from the XYZ.? I can only
> assume the reasoning was to reduce the file size on disc. This is an
> industry convention that will not change anytime soon.
> 
> gdal_translate obviously does not read these XYZ files as gdal throws an
> error due to the lack of true rectangular grid.? I've read the XYZ info
> http://www.gdal.org/frmt_xyz.html which is clear to me, no problem there.
> 
> I do not want to use gdal_grid on the XYZ as this will introduce a further
> interpolation step. The XYZs I receive are already cleansed and gridded by
> the surveyor which I don't wish to edit further.
> 
> So, I currently use a proprietary marine geophysical package which can
> directly read the gridded XYZ without nodata values.? Using this package, I
> can export to ESRI ASCII grid (.ASC) which I then use gdal_translate
> without issue for my further processing steps.
> 
> I'd like the freedom of a non-proprietary solution and the only thing I can
> think of is to write a python script to pre-process my XYZ into a format
> that gdal will accept.? I was thinking of calculating the XY bounding box
> of the data and output an XYZ that blends the original values and nodata
> values in the correct row order.
> 
> If anyone is interested, see below link to a zip of three separate
> examples, containing:
> -- 'gridded' XYZ (without nodata values)
> -- processed greyscale GEOTIFF (using proprietary package)
> -- processed color-relief RGB GEOTIFF (using proprietary package)
> https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
> All data in these examples are referenced to SRS EPSG:27700.
> 
> If I've missed anything obvious, or if anyone has any thoughts of how I can
> achieve my goal using GDAL or other, or comment on my proposed solution,
> that would be greatly appreciated.

What would be interesting is a link to a XYZ file that fails to be opened. In 
GDAL 1.11, I've improved the driver to be able to handle lines with missing 
values at their start and end. It might be possible to improve it again to 
deal with nodata values that would be at any place within lines. If the whole 
file is regularly gridded of course.

> 
> Thanks in advance.
> Sam

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140524/878796d7/attachment-0001.html>

From mailinglist.samfranklin at gmail.com  Sat May 24 23:20:13 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Sun, 25 May 2014 07:20:13 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <201405250043.02661.even.rouault@mines-paris.org>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405250043.02661.even.rouault@mines-paris.org>
Message-ID: <CA+M-UkjBHCKYg2q2Fw4JBtN-gfYXNGqUcXi4vfEB7E35SXs7rg@mail.gmail.com>

Hey Even - well that's embarrassing, it looks like gdal 1.11.0 solves the
problem for those three xyz files that I sent through! Great work, thanks!

However, I've found an example that fails to open here
https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_data04-02.zip

Using gdal 1.11.0 on osx 10.9.3, I receive the following error:

$ gdalinfo data04-02.xyz
ERROR 1: Ungridded dataset: At line 18, X is 516085.000000, where as
516100.000000 was expected (1)
gdalinfo failed - unable to open 'data04-02.xyz'.
I doubt you remember - I chatted to you about this problem at FOSS4G, sorry
it's taken about 9 months to contact you!

Thanks in advance.
S



On 24 May 2014 23:43, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le samedi 24 mai 2014 21:45:45, Sam Franklin a ?crit :
> > Greetings. This is my first post to this mailing list, so apologies if I
> > commit a mailing-list faux-pas :)
> >
> > I wonder if anyone can offer a suggestion, as I'm hoping I've missed
> > something obvious.
> >
> > I regularly receive bathymetric DEMs, acquired by acoustic multibeam
> > echosounders (MBES) from offshore geophysical surveys that take the form
> of
> > narrow corridors of survey or irregularly shaped areas.
> >
> > My goal is to have a end-to-end open source/GDAL workflow that converts
> the
> > bathymetric DEM to greyscale GEOTIFF which I can then use for further
> > processing/analysis using GDAL/OGR.
> >
> > The convention in the offshore sector is to deliver bathymetric data as
> > single 'gridded' .XYZ ASCII file, where XY coordinate pairs are evenly
> > spaced to form a grid and the textfile row order is spatially sequential.
> >
> > However, crucially 'nodata' values are omitted from the XYZ.  I can only
> > assume the reasoning was to reduce the file size on disc. This is an
> > industry convention that will not change anytime soon.
> >
> > gdal_translate obviously does not read these XYZ files as gdal throws an
> > error due to the lack of true rectangular grid.  I've read the XYZ info
> > http://www.gdal.org/frmt_xyz.html which is clear to me, no problem
> there.
> >
> > I do not want to use gdal_grid on the XYZ as this will introduce a
> further
> > interpolation step. The XYZs I receive are already cleansed and gridded
> by
> > the surveyor which I don't wish to edit further.
> >
> > So, I currently use a proprietary marine geophysical package which can
> > directly read the gridded XYZ without nodata values.  Using this
> package, I
> > can export to ESRI ASCII grid (.ASC) which I then use gdal_translate
> > without issue for my further processing steps.
> >
> > I'd like the freedom of a non-proprietary solution and the only thing I
> can
> > think of is to write a python script to pre-process my XYZ into a format
> > that gdal will accept.  I was thinking of calculating the XY bounding box
> > of the data and output an XYZ that blends the original values and nodata
> > values in the correct row order.
> >
> > If anyone is interested, see below link to a zip of three separate
> > examples, containing:
> > -- 'gridded' XYZ (without nodata values)
> > -- processed greyscale GEOTIFF (using proprietary package)
> > -- processed color-relief RGB GEOTIFF (using proprietary package)
> >
> https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_examples.zip
> > All data in these examples are referenced to SRS EPSG:27700.
> >
> > If I've missed anything obvious, or if anyone has any thoughts of how I
> can
> > achieve my goal using GDAL or other, or comment on my proposed solution,
> > that would be greatly appreciated.
>
> What would be interesting is a link to a XYZ file that fails to be opened.
> In
> GDAL 1.11, I've improved the driver to be able to handle lines with missing
> values at their start and end. It might be possible to improve it again to
> deal with nodata values that would be at any place within lines. If the
> whole
> file is regularly gridded of course.
>
> >
> > Thanks in advance.
> > Sam
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140525/0744800b/attachment.html>

From lucena_ivan at hotmail.com  Mon May 26 07:40:24 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 26 May 2014 10:40:24 -0400
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <1400965627856-5142357.post@n6.nabble.com>
References: <201405241635.35384.even.rouault@mines-paris.org>,
	<1400965627856-5142357.post@n6.nabble.com>
Message-ID: <BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>

Hi there,

I can also confirm that the trunk builds without any problems in OS X 10.9.3. The version number is correct at this time however I don't think the "released" information is quite clear:

$ gdalinfo --version
GDAL 2.0.0dev, released 2014/04/16

The RFC 46 propose moving the OGR drivers from ogr/ogrsf_frmts/ to frmts/  and I am looking forward to do that. When can we start? Is it going to be a GDAL's maintainer task or it is something that the driver's maintainer will do? 

Great Job Even!

Regards,

Ivan

> Date: Sat, 24 May 2014 14:07:07 -0700
> From: mateusz at loskot.net
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
> 
> Hi,
> 
> I can confirm the trunk builds without any problems with VS2013.
> 
> Thanks Even!
> 
> Best regards,
> Mateusz Loskot 
> 
> 
> 
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-RFC-46-GDAL-OGR-unification-adopted-and-commited-tp5142327p5142357.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140526/88d46487/attachment.html>

From even.rouault at mines-paris.org  Mon May 26 08:21:47 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 26 May 2014 17:21:47 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
References: <201405241635.35384.even.rouault@mines-paris.org>,
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
Message-ID: <1401117707.53835c0b51955@imp.free.fr>

Hi Ivan,

>
> The RFC 46 propose moving the OGR drivers from ogr/ogrsf_frmts/ to frmts/
> and I am looking forward to do that. When can we start?

When you want. There's no particularly emergency to do that IMHO, and the move
should be done properly with "svn mv", so that the traceability of files doesn't
suffer too much.
One thing that just came to my mind is if we want every drivers to stay under
frmts, or if we want more structure like frmts/raster, frmts/vector,
frmts/mixed. I dunno.

> Is it going to be a
> GDAL's maintainer task or it is something that the driver's maintainer will
> do?

I consider that anyone with commit rights is a GDAL maintainer.

Even


From mateusz at loskot.net  Mon May 26 08:36:49 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Mon, 26 May 2014 17:36:49 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <1401117707.53835c0b51955@imp.free.fr>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
	<1401117707.53835c0b51955@imp.free.fr>
Message-ID: <CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>

On 26 May 2014 17:21, Even Rouault <even.rouault at mines-paris.org> wrote:
> One thing that just came to my mind is if we want every drivers to stay under
> frmts, or if we want more structure like frmts/raster, frmts/vector,
> frmts/mixed.

IMO, the frmts folder as a single bag for all drivers will quickly become
difficult to navigate through. I'm very supportive to Even's idea of
introducing the extra level that would indicate type of a driver.

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From federicojurio at suremptec.com.ar  Mon May 26 12:33:43 2014
From: federicojurio at suremptec.com.ar (Federico Jurio)
Date: Mon, 26 May 2014 16:33:43 -0300
Subject: [gdal-dev] Multipolygon errors
Message-ID: <CADmC3ayN=o==BNWA6L1juBeiDuUqFfmBCZ=m5wXEpTQMHCsD=Q@mail.gmail.com>

Hi, once again i'm here with an issue.

I am trying to rederize a multipolygon geometry without success. Here is
the wkt

POLYGON ((-54.874213174672484 34.043827148471607,-15.258888807860258
> 50.078601296943226,-15.258888807860258
> 5.432759550218335,-55.188620510917026
> 10.777684266375541,-54.874213174672484
> 34.043827148471607),(-49.843695794759817
> 29.013309768558948,-50.472510467248902
> 16.122608982532746,-20.603813524017465
> 11.720906275109165,-21.232628196506546
> 39.388751864628816,-49.843695794759817 29.013309768558948))


I have tried many different ways

*Case #1*
OGRGeometryCollection * pmultigeom = new OGRGeometryCollection();
int gerror = pmultigeom->importFromWkt(&pwkt);

*pwkt is a char* that contains the wkt that i have mentioned before.*

*Case #2*
OGRMultiPolygon * pmultigeom = new OGRMultiPolygon();
int gerror = pmultigeom->importFromWkt(&pwkt);

Result: In both cases importFromWkt() returns 5, which means
OGRERR_CORRUPT_DATA

*Case #3*
std::vector<OGRFeature *> featurecache;
...
for (size_t nfeat = 0; nfeat < totalcachefeatures; nfeat++) {
            OGRGeometryCollection * pmultigeom =
                  dynamic_cast<OGRGeometryCollection
*>(featurecache[nfeat]->GetGeometryRef());
...
}

Result: pmultigeom = NULL

*Case #4*
std::vector<OGRFeature *> featurecache;
...
for (size_t nfeat = 0; nfeat < totalcachefeatures; nfeat++) {
OGRGeometryCollection * pmultigeom = new OGRGeometryCollection();

pmultigeom->addGeometryDirectly(featurecache[nfeat]->GetGeometryRef());
...
}

*Case #5*
std::vector<OGRFeature *> featurecache;
...
for (size_t nfeat = 0; nfeat < totalcachefeatures; nfeat++) {
OGRGeometryCollection * pmultigeom = new OGRGeometryCollection();
            pmultigeom->addGeometry(featurecache[nfeat]->GetGeometryRef());
...
}

In both cases only shows one of the two geometries and i don't know why
only one.

Any advice would be greatly appreciated. Thank you for your time.
Best regards

-- 
Federico Jurio
SUR Emprendimientos Tecnol?gicos

Per? 345  Piso 5to Oficina "B" (C1067AAG)
Ciudad de Buenos Aires, Argentina
Tel. +54 (11) 4342-2976/84
federicojurio at suremptec.com.ar
www.suremptec.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140526/a2b36bd6/attachment.html>

From even.rouault at mines-paris.org  Mon May 26 13:18:58 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 26 May 2014 22:18:58 +0200
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkjBHCKYg2q2Fw4JBtN-gfYXNGqUcXi4vfEB7E35SXs7rg@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405250043.02661.even.rouault@mines-paris.org>
	<CA+M-UkjBHCKYg2q2Fw4JBtN-gfYXNGqUcXi4vfEB7E35SXs7rg@mail.gmail.com>
Message-ID: <201405262218.58381.even.rouault@mines-paris.org>

Le dimanche 25 mai 2014 08:20:13, Sam Franklin a ?crit :
> Hey Even - well that's embarrassing, it looks like gdal 1.11.0 solves the
> problem for those three xyz files that I sent through! Great work, thanks!
> 
> However, I've found an example that fails to open here
> https://dl.dropboxusercontent.com/u/4086367/gdal_translate_xyz_data04-02.zi
> p
> 
> Using gdal 1.11.0 on osx 10.9.3, I receive the following error:
> 
> $ gdalinfo data04-02.xyz
> ERROR 1: Ungridded dataset: At line 18, X is 516085.000000, where as
> 516100.000000 was expected (1)
> gdalinfo failed - unable to open 'data04-02.xyz'.
> I doubt you remember - I chatted to you about this problem at FOSS4G, sorry
> it's taken about 9 months to contact you!

Hi Sam,

Hum, I didn't really recall that, but quite a lof of people talked to me about 
various subjects ;-)

ok, I've looked at your file and it has some weirdness that would require much 
more work to deal with, namely the fact of having lines in non strictly 
ascending or descending lines.
But if you do :
sort -nk 2 data04-02.xyz > data04-02-sorted.xyz

You should be able to open it with trunk now (I've done a few extra fixes to 
better deal with holes within lines).

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From lucena_ivan at hotmail.com  Mon May 26 16:24:58 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 26 May 2014 19:24:58 -0400
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
References: <201405241635.35384.even.rouault@mines-paris.org>,
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>,
	<1401117707.53835c0b51955@imp.free.fr>,
	<CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
Message-ID: <BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>

Hi Mateusz,

That seems like a good idea. 

But I don't know if I should unify two drivers an put then on frmts/mixed. It will certainly works in the new structure proposed by RFC 46 but it might create some problems for me. What I am most interested is to have two driver (that uses the same data container) sharing a little bit of code.

The RFC 46 says "Various data containers can accept both
data types" and by that I understand it means "at the same time". The same dataset can contain Vector and Raster.

If I understood it correclty, if you use gdalinfo with one of those dataset it will call GDALOpenEx with GDAL_OF_RASTER and if you use ogrinfo with the same dataset it will call GDALOpenEx with GDAL_OF_VECTOR. So nothing new under the sun here, from the user point of view. What is a very good thing.

But it might be a case where you would like to develop or unify some drivers and put then into the mixed folder. I don't know.

In my case I would like to have a folder structure to keep my two driver under the same folder.

Something like that:

/frmts/container/
/frmts/container/vector
/frmts/container/raster

But that idea doesn't help with your concern about a large number of sub-folders under /frmts.

What do you think?

Regards,

Ivan

> From: mateusz at loskot.net
> Date: Mon, 26 May 2014 17:36:49 +0200
> Subject: Re: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
> To: even.rouault at mines-paris.org
> CC: lucena_ivan at hotmail.com; gdal-dev at lists.osgeo.org
> 
> On 26 May 2014 17:21, Even Rouault <even.rouault at mines-paris.org> wrote:
> > One thing that just came to my mind is if we want every drivers to stay under
> > frmts, or if we want more structure like frmts/raster, frmts/vector,
> > frmts/mixed.
> 
> IMO, the frmts folder as a single bag for all drivers will quickly become
> difficult to navigate through. I'm very supportive to Even's idea of
> introducing the extra level that would indicate type of a driver.
> 
> Best regards,
> -- 
> Mateusz  ?oskot, http://mateusz.loskot.net
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140526/4cade0b4/attachment.html>

From even.rouault at mines-paris.org  Mon May 26 17:31:08 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 27 May 2014 02:31:08 +0200
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkiMoavpNAPyHCwJB274RO4pth4dgWNvZd2bDE4nL9Q-Kg@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405262218.58381.even.rouault@mines-paris.org>
	<CA+M-UkiMoavpNAPyHCwJB274RO4pth4dgWNvZd2bDE4nL9Q-Kg@mail.gmail.com>
Message-ID: <201405270231.08722.even.rouault@mines-paris.org>

Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
> Hey Even - great tip.  The sort command you suggested worked well with that
> xyz dataset.
> 
> However, I've found a further dataset that does not work with gdal even
> after the sort. This is the error:
> 
> mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
> data08-02.tif
> Input file size is 4371, 11210
> 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000 instead
> of 48164.000000 for nBlockYOff = 4951ERROR 1: data08-02-sorted.xyz, band 1:
> IReadBlock failed at X offset 0, Y offset 4951
> 
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 4951
> 
> See screenshot below, the data is arranged into three 'strips'. See dropbox
> link to the data |
> https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
> 
> Any workaround you can think of?

Probably an issue with just sorting on column 2. I didn't have the same error 
as you, but anyway you should try :

sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz

with that I manage to translate the file.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From marcelacampo at gmail.com  Mon May 26 20:31:07 2014
From: marcelacampo at gmail.com (Marcela Campo)
Date: Tue, 27 May 2014 00:31:07 -0300
Subject: [gdal-dev] issues with gdal2tiles.py
Message-ID: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>

Hi,
  I am trying to use gdal2tiles with a set of geotiff and I get the
following error

ERROR 6: EPSG PCS/GCS code 900913 not found in EPSG support files.  Is this
a valid
EPSG coordinate system?
ERROR 6: No translation for an empty SRS to PROJ.4 format is known.


I have already transformed to projection EPSG:3857, here is the gdalinfo
output for one of the files

Driver: GTiff/GeoTIFF
Files: rec_230076_1994-12-31_f4_p.tif
       rec_230076_1994-12-31_f4_p.tfw
Size is 728, 741
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
 +no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (-7130153.280253740958869,-2651286.133427014108747)
Pixel Size = (32.745668091799999,-32.745668092300001)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_IMAGEDESCRIPTION=ImageJ=1.48v

Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-7130153.280,-2651286.133) ( 64d 3' 4.52"W, 23d 9'33.23"S)
Lower Left  (-7130153.280,-2675550.673) ( 64d 3' 4.52"W, 23d21'34.15"S)
Upper Right (-7106314.434,-2651286.133) ( 63d50'13.59"W, 23d 9'33.23"S)
Lower Right (-7106314.434,-2675550.673) ( 63d50'13.59"W, 23d21'34.15"S)
Center      (-7118233.857,-2663418.403) ( 63d56'39.06"W, 23d15'33.82"S)
Band 1 Block=728x3 Type=Byte, ColorInterp=Red
Band 2 Block=728x3 Type=Byte, ColorInterp=Green
Band 3 Block=728x3 Type=Byte, ColorInterp=Blue


the command generates the tiles, but as the images appear a bit shifted I
wonder if it somewhat misinterpreted the projection.

I am using gdal 1.10.1 on ubuntu.

Thanks!
Marcela
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140527/88c34442/attachment.html>

From christianhelring at gmail.com  Mon May 26 23:28:41 2014
From: christianhelring at gmail.com (Chrishelring)
Date: Mon, 26 May 2014 23:28:41 -0700 (PDT)
Subject: [gdal-dev] problems with merging ecw files
Message-ID: <1401172121023-5142634.post@n6.nabble.com>

hi,

I?m trying to merge about 40 ecw files into one, using gdal_merge.py. it
seems to work (no error), but when I?m trying to open the file, it says,
"Unable to read header information: Cannot open file
c:\temp\ortofoto2007\ortofoto2007.ecw".

I?m using GDAL 1.11.0 with the following command:

C:\TEMP\ortofoto2007>python C:\osgeo4w\bin\gdal_merge.py -o
c:\temp\ortofoto2007
\ortofoto2007.ecw --optfile c:\temp\ortofoto2007\orto07.txt

Any help would really be appreciated. :)

Christian



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/problems-with-merging-ecw-files-tp5142634.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Tue May 27 00:28:50 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 27 May 2014 09:28:50 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
	<1401117707.53835c0b51955@imp.free.fr>
	<CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
	<BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>
Message-ID: <CABUeae_Y_BxsDaQ9+onfHb8xxE+u0cKxJT5vu1ZrC=220OMDpg@mail.gmail.com>

On 27 May 2014 01:24, Ivan Lucena <lucena_ivan at hotmail.com> wrote:
> What I am most interested is to have two driver
> (that uses the same data container) sharing a little bit of code.
> [...]
> In my case I would like to have a folder structure to keep my two driver
> under the same folder.
>
> Something like that:
>
> /frmts/container/
> /frmts/container/vector
> /frmts/container/raster
>
> But that idea doesn't help with your concern about a large number of
> sub-folders under /frmts.

Ivan,

You've touched an important issues - sharing of code between drivers that
connect to the same data provider.

My understanding is that drivers like Oracle or PostGIS would have the
following structure:

/frmts/mixed/oracle
/frmts/mixed/postgis

I'm not sure if I've grasped the idea well though.

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Tue May 27 02:46:35 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 27 May 2014 11:46:35 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <CABUeae_Y_BxsDaQ9+onfHb8xxE+u0cKxJT5vu1ZrC=220OMDpg@mail.gmail.com>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
	<1401117707.53835c0b51955@imp.free.fr>
	<CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
	<BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>
	<CABUeae_Y_BxsDaQ9+onfHb8xxE+u0cKxJT5vu1ZrC=220OMDpg@mail.gmail.com>
Message-ID: <1401183995.53845efbe3c05@imp.free.fr>

Selon Mateusz  <mateusz at loskot.net>:

I'd rather see frmts/mixed/XXXXX if XXXXX is a single driver that can return
both raster and vector content.
If you have a XXXXX (GeoRaster) and YYYYYY (OGR OCI) drivers that use common
code but remain separate, I'd say you can have frmts/raster/XXXXX and
frmts/vector/YYYYY and make one of them include headers from the other one. Like
it has been done up to now. Well if you want it to be cleaner, you could have
frmts/common/oracle and put in there the common code. However, if they are
plugins and not build-in driver, you should however make sure that both drivers
are bundled in the same shared object.


> On 27 May 2014 01:24, Ivan Lucena <lucena_ivan at hotmail.com> wrote:
> > What I am most interested is to have two driver
> > (that uses the same data container) sharing a little bit of code.
> > [...]
> > In my case I would like to have a folder structure to keep my two driver
> > under the same folder.
> >
> > Something like that:
> >
> > /frmts/container/
> > /frmts/container/vector
> > /frmts/container/raster
> >
> > But that idea doesn't help with your concern about a large number of
> > sub-folders under /frmts.
>
> Ivan,
>
> You've touched an important issues - sharing of code between drivers that
> connect to the same data provider.
>
> My understanding is that drivers like Oracle or PostGIS would have the
> following structure:
>
> /frmts/mixed/oracle
> /frmts/mixed/postgis
>
> I'm not sure if I've grasped the idea well though.
>
> Best regards,
> --
> Mateusz  ??oskot, http://mateusz.loskot.net
>

From lucena_ivan at hotmail.com  Tue May 27 04:15:58 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 27 May 2014 07:15:58 -0400
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <1401183995.53845efbe3c05@imp.free.fr>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
	<1401117707.53835c0b51955@imp.free.fr>
	<CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
	<BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>
	<CABUeae_Y_BxsDaQ9+onfHb8xxE+u0cKxJT5vu1ZrC=220OMDpg@mail.gmail.com>,
	<1401183995.53845efbe3c05@imp.free.fr>
Message-ID: <BLU173-W18D3834F70FA7EED1A2E2903A0@phx.gbl>

> Date: Tue, 27 May 2014 11:46:35 +0200
> From: even.rouault at mines-paris.org
> To: mateusz at loskot.net
> CC: lucena_ivan at hotmail.com; even.rouault at mines-paris.org; gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
> 
> Selon Mateusz  <mateusz at loskot.net>:
> 
> I'd rather see frmts/mixed/XXXXX if XXXXX is a single driver that can return
> both raster and vector content.
> If you have a XXXXX (GeoRaster) and YYYYYY (OGR OCI) drivers that use common
> code but remain separate, I'd say you can have frmts/raster/XXXXX and
> frmts/vector/YYYYY and make one of them include headers from the other one. Like

That is fine. That will be just a matter of adding some -I include path.

> it has been done up to now. Well if you want it to be cleaner, you could have
> frmts/common/oracle and put in there the common code. However, if they are
> plugins and not build-in driver, you should however make sure that both drivers
> are bundled in the same shared object.

I don't think that will be necessary. I mean, the /common folder.

But let me through another idea, if you don't mind. 

What if the folder under /frmts where organized by software/company name, not by container? 

BTW, that is what I did on my first GDAL driver, I used the software name not the format or driver name as the folder name.

IMHO there is no need for /vector, /raster or /mixed sub-folder. It really doesn't matter if a driver is mixed or not, in terms of folder structure. That should be dictated by the code.

Inside the software/company sub-folder, the developer could organize folder names in the anyway they want, as long as there is a main makefile to be called. Or maybe not even that, because a driver could be plugin-only. Inside that folder you could have one, two, three or more drivers, mixed or not. And we could still have formats independent from software/companies seating on the /frmts folder just like he have now.

Would that be too much freedom? Would make it more organized or messier?

Like I said before, I am fine with what you proposed. I am just giving some ideas. I am not concerned about "my two drivers" but about the health of the overall GDAL code.

My best regards,

Ivan


> 
> 
> > On 27 May 2014 01:24, Ivan Lucena <lucena_ivan at hotmail.com> wrote:
> > > What I am most interested is to have two driver
> > > (that uses the same data container) sharing a little bit of code.
> > > [...]
> > > In my case I would like to have a folder structure to keep my two driver
> > > under the same folder.
> > >
> > > Something like that:
> > >
> > > /frmts/container/
> > > /frmts/container/vector
> > > /frmts/container/raster
> > >
> > > But that idea doesn't help with your concern about a large number of
> > > sub-folders under /frmts.
> >
> > Ivan,
> >
> > You've touched an important issues - sharing of code between drivers that
> > connect to the same data provider.
> >
> > My understanding is that drivers like Oracle or PostGIS would have the
> > following structure:
> >
> > /frmts/mixed/oracle
> > /frmts/mixed/postgis
> >
> > I'm not sure if I've grasped the idea well though.
> >
> > Best regards,
> > --
> > Mateusz  ??oskot, http://mateusz.loskot.net
> >
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140527/afc9c905/attachment.html>

From kornm123 at gmail.com  Tue May 27 04:10:05 2014
From: kornm123 at gmail.com (Marcel Korn)
Date: Tue, 27 May 2014 13:10:05 +0200
Subject: [gdal-dev] Gdalwarp is unable to output a geotiff with units =
	seconds correctly
Message-ID: <CALNygLm-EZXi5kOeuS5fZgq5ie5AQkfdS7Mfzq9Q=cOy2=8iRA@mail.gmail.com>

We use geotif with units=seconds quite a lot.

I found that running :
gdalwarp -t_srs <srs-def> <input path> <output path>

1. If target srs_def is a prj file with EPSG code for GCS WGS84 and units=
degree and my input file is a geotiff with GCS WGS84 and units= Seconds -
the output file is a "normal" geotiff with GCS WGS84 and units= degree.
2. If target srs_def in a prj file with EPSG code for GCS WGS84 and units=
SECONDS and my input file is a geotiff with GCS WGS84 and units= degree  -
the output is a geotiff with the units undetected correctly.
In order to correct the output file I used ArcCatalog and set the units to
seconds.
After the correction the file (and the header was ok).
Note: the prj must include authority = EPSG and the code (in this case
4326) otherwise the geotiff is produced as Custom CS and it may or may not
be identified correctly and fully by apps.
Also note that with default units you can run gdalwarp with EPSG:4326
instead of the prj file.

It seems like there is a functional program bug since GDAL reads
non-default units OK but cannot produce a geotiff with seconds. Something
similar will probable happen with UTM PCSs if the target is feet instead of
meter (the default).

I would like to know if somebody else found this problem and how he solved
it.
Of course, I wait to get confirmation it is a bug or maybe I did something
wrong.
If it is a "new bug" I wou?d like to know what can I do to advance the
solution for it.

This bug reminds me of a very old ArcMap bug that manifests itself when you
open a polygon or a raster with non-default units like second. If this is
the first item you open, the units are not read correctly until you reload
the GCS into the Data Frame. And than you get Degrees...the logic (or the
lack of it) is similar.

Best regards,
Moty
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140527/50b953bd/attachment.html>

From even.rouault at mines-paris.org  Tue May 27 05:11:42 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 27 May 2014 14:11:42 +0200
Subject: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
In-Reply-To: <BLU173-W18D3834F70FA7EED1A2E2903A0@phx.gbl>
References: <201405241635.35384.even.rouault@mines-paris.org>
	<1400965627856-5142357.post@n6.nabble.com>
	<BLU173-W9A80C36CB4B5167D4343B903B0@phx.gbl>
	<1401117707.53835c0b51955@imp.free.fr>
	<CABUeae81KZqrHWXqB4FGUp3F++Bqkk=Qi6xj03W7c0TCJrJi9A@mail.gmail.com>
	<BLU173-W3111F32FA2BCA96696A640903B0@phx.gbl>
	<CABUeae_Y_BxsDaQ9+onfHb8xxE+u0cKxJT5vu1ZrC=220OMDpg@mail.gmail.com>,
	<1401183995.53845efbe3c05@imp.free.fr>
	<BLU173-W18D3834F70FA7EED1A2E2903A0@phx.gbl>
Message-ID: <1401192702.538480fe2dfe3@imp.free.fr>

Selon Ivan Lucena <lucena_ivan at hotmail.com>:

> > Date: Tue, 27 May 2014 11:46:35 +0200
> > From: even.rouault at mines-paris.org
> > To: mateusz at loskot.net
> > CC: lucena_ivan at hotmail.com; even.rouault at mines-paris.org;
> gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] RFC 46 GDAL/OGR unification adopted and commited
> >
> > Selon Mateusz  <mateusz at loskot.net>:
> >
> > I'd rather see frmts/mixed/XXXXX if XXXXX is a single driver that can
> return
> > both raster and vector content.
> > If you have a XXXXX (GeoRaster) and YYYYYY (OGR OCI) drivers that use
> common
> > code but remain separate, I'd say you can have frmts/raster/XXXXX and
> > frmts/vector/YYYYY and make one of them include headers from the other one.
> Like
>
> That is fine. That will be just a matter of adding some -I include path.
>
> > it has been done up to now. Well if you want it to be cleaner, you could
> have
> > frmts/common/oracle and put in there the common code. However, if they are
> > plugins and not build-in driver, you should however make sure that both
> drivers
> > are bundled in the same shared object.
>
> I don't think that will be necessary. I mean, the /common folder.
>
> But let me through another idea, if you don't mind.
>
> What if the folder under /frmts where organized by software/company name, not
> by container?

My feeling is that there are not so many drivers that are unambiguously
associated with a software/company.
And if you take a particular company, the common points between shape file,
PGeo, FileGDB, OpenFileGDB, SDE or ArcObjects are rather small (I can only think
to shapefile blob encoding/decoding for pgeo/mdb and filegdb/openfilegdb). And
it would be rather amusing to place OpenFileGDB under an E$RI directory.
And sometimes the company name changes many times, but the format remains
(ECW...)

>
> BTW, that is what I did on my first GDAL driver, I used the software name not
> the format or driver name as the folder name.
>
> IMHO there is no need for /vector, /raster or /mixed sub-folder. It really
> doesn't matter if a driver is mixed or not, in terms of folder structure.
> That should be dictated by the code.

I agree. There's no technical necessity in that /vector, /raster and /mixed
possible structure.

I've just had a look at how QGIS ogranize their providers -
https://github.com/qgis/QGIS/tree/master/src/providers - and it is flat, mixing
raster and vector. But they have "only" 15 of them.

>
> Inside the software/company sub-folder, the developer could organize folder
> names in the anyway they want, as long as there is a main makefile to be
> called. Or maybe not even that, because a driver could be plugin-only. Inside
> that folder you could have one, two, three or more drivers, mixed or not. And
> we could still have formats independent from software/companies seating on
> the /frmts folder just like he have now.
>
> Would that be too much freedom? Would make it more organized or messier?

No definitive conclusion from myself. The frmts/raster frmts/vector approach was
a no-brainer adaptation of the current organization.

>
> Like I said before, I am fine with what you proposed. I am just giving some
> ideas. I am not concerned about "my two drivers" but about the health of the
> overall GDAL code.
>
> My best regards,
>
> Ivan
>
>
> >
> >
> > > On 27 May 2014 01:24, Ivan Lucena <lucena_ivan at hotmail.com> wrote:
> > > > What I am most interested is to have two driver
> > > > (that uses the same data container) sharing a little bit of code.
> > > > [...]
> > > > In my case I would like to have a folder structure to keep my two
> driver
> > > > under the same folder.
> > > >
> > > > Something like that:
> > > >
> > > > /frmts/container/
> > > > /frmts/container/vector
> > > > /frmts/container/raster
> > > >
> > > > But that idea doesn't help with your concern about a large number of
> > > > sub-folders under /frmts.
> > >
> > > Ivan,
> > >
> > > You've touched an important issues - sharing of code between drivers that
> > > connect to the same data provider.
> > >
> > > My understanding is that drivers like Oracle or PostGIS would have the
> > > following structure:
> > >
> > > /frmts/mixed/oracle
> > > /frmts/mixed/postgis
> > >
> > > I'm not sure if I've grasped the idea well though.
> > >
> > > Best regards,
> > > --
> > > Mateusz  ??oskot, http://mateusz.loskot.net
> > >
>



From mailinglist.samfranklin at gmail.com  Tue May 27 06:09:37 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Tue, 27 May 2014 14:09:37 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <201405270231.08722.even.rouault@mines-paris.org>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405262218.58381.even.rouault@mines-paris.org>
	<CA+M-UkiMoavpNAPyHCwJB274RO4pth4dgWNvZd2bDE4nL9Q-Kg@mail.gmail.com>
	<201405270231.08722.even.rouault@mines-paris.org>
Message-ID: <CA+M-UkiaX+rA5Oe_MUOrCL2q=zFL3HS1F3e9uZC=4nXf2ownow@mail.gmail.com>

Hi Even. Great, that worked for me too when sorting on both columns.
Really appreciate you help.
Sam


On 27 May 2014 01:31, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
> > Hey Even - great tip.  The sort command you suggested worked well with
> that
> > xyz dataset.
> >
> > However, I've found a further dataset that does not work with gdal even
> > after the sort. This is the error:
> >
> > mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
> > data08-02.tif
> > Input file size is 4371, 11210
> > 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
> instead
> > of 48164.000000 for nBlockYOff = 4951ERROR 1: data08-02-sorted.xyz, band
> 1:
> > IReadBlock failed at X offset 0, Y offset 4951
> >
> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 4951
> >
> > See screenshot below, the data is arranged into three 'strips'. See
> dropbox
> > link to the data |
> > https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
> >
> > Any workaround you can think of?
>
> Probably an issue with just sorting on column 2. I didn't have the same
> error
> as you, but anyway you should try :
>
> sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz
>
> with that I manage to translate the file.
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140527/8a4d124b/attachment.html>

From andre+joost at nurfuerspam.de  Tue May 27 07:53:19 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 27 May 2014 16:53:19 +0200
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
Message-ID: <lm297u$alo$1@ger.gmane.org>

Am 27.05.2014 05:31, schrieb Marcela Campo:
> Hi,
>    I am trying to use gdal2tiles with a set of geotiff and I get the
> following error
>
> ERROR 6: EPSG PCS/GCS code 900913 not found in EPSG support files.  Is this
> a valid
> EPSG coordinate system?
> ERROR 6: No translation for an empty SRS to PROJ.4 format is known.
>
>
> I have already transformed to projection EPSG:3857, here is the gdalinfo
> output for one of the files

> the command generates the tiles, but as the images appear a bit shifted I
> wonder if it somewhat misinterpreted the projection.
>

Instead of reprojecting to EPSG:900913 (which will place the points on 
the same spot on the globe), try to assign the projection with -a_srs. 
This will effectively shift the points.

If the shift goes in the wrong direction, try EPSG:3395. This is the 
projection on a ellipsoid rather than a sphere.

HTH,
Andr? Joost


From marcelacampo at gmail.com  Tue May 27 09:45:23 2014
From: marcelacampo at gmail.com (Marcela Campo)
Date: Tue, 27 May 2014 13:45:23 -0300
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <lm297u$alo$1@ger.gmane.org>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
Message-ID: <CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>

Hi Andr?, thank you for your response.

I am not using EPSG:900913 anywhere

I got some img files someone else processed in arcgis and I am processing
them this way:

gdal_translate -of GTIFF -co "COMPRESS=LZW" -scale 0 255 0 255 -ot Byte
input.img  input.tif
gdalwarp  -t_srs "EPSG:3857" input.tif output_p.tif
gdal2tiles.py output_p.tif

I tried forcing the source projection during warp this way

gdalwarp -s_srs "EPSG:22184" -t_srs "EPSG:3857"  input.tif output_p.tif

I am not sure about source projection, I found it out doing:

gdalinfo -proj4 input.img

and searching for the proj4 string in the internet. The image is actually
from the zone of projection EPSG:22184 so I believe is ok.

In what point of the process you say I should be forcing with a_srs?

Thanks!
Marcela



On Tue, May 27, 2014 at 11:53 AM, Andre Joost <andre+joost at nurfuerspam.de>wrote:

> Am 27.05.2014 05:31, schrieb Marcela Campo:
>
>  Hi,
>>    I am trying to use gdal2tiles with a set of geotiff and I get the
>> following error
>>
>> ERROR 6: EPSG PCS/GCS code 900913 not found in EPSG support files.  Is
>> this
>> a valid
>> EPSG coordinate system?
>> ERROR 6: No translation for an empty SRS to PROJ.4 format is known.
>>
>>
>> I have already transformed to projection EPSG:3857, here is the gdalinfo
>> output for one of the files
>>
>
>  the command generates the tiles, but as the images appear a bit shifted I
>> wonder if it somewhat misinterpreted the projection.
>>
>>
> Instead of reprojecting to EPSG:900913 (which will place the points on the
> same spot on the globe), try to assign the projection with -a_srs. This
> will effectively shift the points.
>
> If the shift goes in the wrong direction, try EPSG:3395. This is the
> projection on a ellipsoid rather than a sphere.
>
> HTH,
> Andr? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140527/51dcff79/attachment.html>

From andre+joost at nurfuerspam.de  Tue May 27 10:19:09 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 27 May 2014 19:19:09 +0200
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
	<CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
Message-ID: <lm2hgq$nft$1@ger.gmane.org>

Am 27.05.2014 18:45, schrieb Marcela Campo:
> Hi Andr?, thank you for your response.
>
> I am not using EPSG:900913 anywhere

You mentioned an error message about EPSG:900913 in your first post.
I did my gdal2tiling a few years ago, and at that time 900913 was still 
listed in proj. Now it has been replaced by EPSG:3857, but gdal2tiles 
still wants it (I guess).

How much is your offset?

If it is a few hundred meters, it is more likely a datum shift issue. If 
it is about 20km, it might be the Google mercator bug.

For the first one, you might look into the PSAD56 or SAD69 UTM 
projections. They have a shift against WGS84 and POSGAR based projections.

For the second, you can try setting -s_srs "EPSG:3395" -t_srs 
"EPSG:3857" (or the other way round) to correct it before tiling.

You could as well load the untiled tif into QGIS and compare to 
Oepnstreetmap or Google background using the Openlayers plugin.

HTH,
Andr? Joost


From mwtoews at gmail.com  Tue May 27 15:06:04 2014
From: mwtoews at gmail.com (Mike Toews)
Date: Wed, 28 May 2014 10:06:04 +1200
Subject: [gdal-dev] Add to PythonGotchas: saving and closing raster
	datasets
In-Reply-To: <5367B9DA.4040809@mapbox.com>
References: <CAM2FmMrAaeLhgDHgXcRYMf7J3KTkpnWCSyrp06r_8j5r3pYyMA@mail.gmail.com>
	<5367B9DA.4040809@mapbox.com>
Message-ID: <CAM2FmMo_d-RzLhP5H-ziuKZ0jPDi55Bvvp66HQaBvVT2b3JdWw@mail.gmail.com>

Thanks Even and Sean for the input. I'll proceed to add this to the
wiki when I have an extended moment.

I think I'll rephrase this gotcha to also apply to OGR datasources,
where the API reads "you should always close any opened datasource
with OGR_DS_Destroy() that will ensure all data is correctly
flushed"[1]

I think it is worth to mention that raster datasets can use
FlushCache() and vector datasources can use SyncToDisk() to "save" the
data intermittently without closing, but is driver-specific and not
required before closing.

As for "save and close", I think I'll use `del ds` as the recommended
method, with mention that any copies of the references to the
dataset/source also need to be dereferenced.

-Mike

[1] http://www.gdal.org/ogr__api_8h.html#a9d845a6cf6652756925530418905471a

From landa.martin at gmail.com  Wed May 28 01:36:12 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 28 May 2014 10:36:12 +0200
Subject: [gdal-dev] driver pages
Message-ID: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>

Hi,

after RFC-46, the original location of OGR driver pages is broken, eg.

http://www.gdal.org/ogr/drv_shapefile.html

Would be nice to add redirection... Thanks, Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Wed May 28 01:47:13 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 10:47:13 +0200
Subject: [gdal-dev] driver pages
In-Reply-To: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
Message-ID: <201405281047.13821.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 10:36:12, Martin Landa a ?crit :
> Hi,
> 
> after RFC-46, the original location of OGR driver pages is broken, eg.
> 
> http://www.gdal.org/ogr/drv_shapefile.html
> 
> Would be nice to add redirection... Thanks, Martin

Yes, I agree. Anyone know how to do that ?

I did a "manual" redirection with a HTML page for www.gdal.org/ogr/index.html, 
but I don't think it is appropriate to do that for each html page that was 
under ogr.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 28 04:01:32 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 13:01:32 +0200
Subject: [gdal-dev] driver pages
In-Reply-To: <201405281047.13821.even.rouault@mines-paris.org>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
	<201405281047.13821.even.rouault@mines-paris.org>
Message-ID: <201405281301.32910.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 10:47:13, Even Rouault a ?crit :
> Le mercredi 28 mai 2014 10:36:12, Martin Landa a ?crit :
> > Hi,
> > 
> > after RFC-46, the original location of OGR driver pages is broken, eg.
> > 
> > http://www.gdal.org/ogr/drv_shapefile.html
> > 
> > Would be nice to add redirection... Thanks, Martin
> 
> Yes, I agree. Anyone know how to do that ?
> 
> I did a "manual" redirection with a HTML page for
> www.gdal.org/ogr/index.html, but I don't think it is appropriate to do
> that for each html page that was under ogr.

ok, I finally figured that out by myself. It was just a matter of putting a 
.htaccess file at the root of gdal.org with the following content :
RewriteEngine On 
Redirect permanent /ogr http://www.gdal.org

> 
> Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jrepetto at free.fr  Wed May 28 03:57:00 2014
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Wed, 28 May 2014 12:57:00 +0200
Subject: [gdal-dev] problems with merging ecw files
In-Reply-To: <1401172121023-5142634.post@n6.nabble.com>
References: <1401172121023-5142634.post@n6.nabble.com>
Message-ID: <5385C0FC.40402@free.fr>

Le 27/05/2014 08:28, Chrishelring a ?crit :

> I?m trying to merge about 40 ecw files into one, using gdal_merge.py. it
> seems to work (no error), but when I?m trying to open the file, it says,
> "Unable to read header information: Cannot open file
> c:\temp\ortofoto2007\ortofoto2007.ecw".

Hi,
Does the file exist ?


From landa.martin at gmail.com  Wed May 28 04:13:34 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 28 May 2014 13:13:34 +0200
Subject: [gdal-dev] driver pages
In-Reply-To: <201405281301.32910.even.rouault@mines-paris.org>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
	<201405281047.13821.even.rouault@mines-paris.org>
	<201405281301.32910.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OevtKQ39N5e4uFE_DyfLyC=Ft06saPGRL0jAOcpVhAhbQ@mail.gmail.com>

Hi,

2014-05-28 13:01 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:

> ok, I finally figured that out by myself. It was just a matter of putting a
> .htaccess file at the root of gdal.org with the following content :
> RewriteEngine On
> Redirect permanent /ogr http://www.gdal.org

thanks! Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From david.tran at hsr.ch  Wed May 28 04:46:47 2014
From: david.tran at hsr.ch (David Tran)
Date: Wed, 28 May 2014 13:46:47 +0200
Subject: [gdal-dev] GDAL 1.11: SQLite & tables
In-Reply-To: <CA+Ei1OevtKQ39N5e4uFE_DyfLyC=Ft06saPGRL0jAOcpVhAhbQ@mail.gmail.com>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>	<201405281047.13821.even.rouault@mines-paris.org>	<201405281301.32910.even.rouault@mines-paris.org>
	<CA+Ei1OevtKQ39N5e4uFE_DyfLyC=Ft06saPGRL0jAOcpVhAhbQ@mail.gmail.com>
Message-ID: <5385CCA7.4030805@hsr.ch>

Hi

Is there a something similiar to "tables=table1,table2" from pg for sqlite?

pg:
http://www.gdal.org/drv_pg_advanced.html

sqlite:
http://www.gdal.org/drv_sqlite.html


thanks in advance.

From even.rouault at mines-paris.org  Wed May 28 05:03:21 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 14:03:21 +0200
Subject: [gdal-dev] GDAL 1.11: SQLite & tables
In-Reply-To: <5385CCA7.4030805@hsr.ch>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
	<CA+Ei1OevtKQ39N5e4uFE_DyfLyC=Ft06saPGRL0jAOcpVhAhbQ@mail.gmail.com>
	<5385CCA7.4030805@hsr.ch>
Message-ID: <201405281403.21747.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 13:46:47, David Tran a ?crit :
> Hi
> 
> Is there a something similiar to "tables=table1,table2" from pg for sqlite?

No, that doesn't exist in the SQLite driver. Why would you need it : do you 
have performance problems when opening a sqlite DB with a lot of tables ?

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From chaitanya.ch at gmail.com  Wed May 28 05:05:29 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Wed, 28 May 2014 17:35:29 +0530
Subject: [gdal-dev] GDAL 1.11: SQLite & tables
In-Reply-To: <5385CCA7.4030805@hsr.ch>
References: <CA+Ei1OcMpj9GaBHi_BBt853e9zs908W9MR=MeQ_BOjW2z-B08w@mail.gmail.com>
	<201405281047.13821.even.rouault@mines-paris.org>
	<201405281301.32910.even.rouault@mines-paris.org>
	<CA+Ei1OevtKQ39N5e4uFE_DyfLyC=Ft06saPGRL0jAOcpVhAhbQ@mail.gmail.com>
	<5385CCA7.4030805@hsr.ch>
Message-ID: <CAMKgpObyJQ8+-rsQG2f7GROw2rGLwtkQhMe3pG5LYZq03B4xeg@mail.gmail.com>

David,

This feature is not available in SQLite driver. It just avoids getting a
long list of tables and views with potentially no spatial data.


On Wed, May 28, 2014 at 5:16 PM, David Tran <david.tran at hsr.ch> wrote:

> Hi
>
> Is there a something similiar to "tables=table1,table2" from pg for sqlite?
>
> pg:
> http://www.gdal.org/drv_pg_advanced.html
>
> sqlite:
> http://www.gdal.org/drv_sqlite.html
>
>
> thanks in advance.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/1463579d/attachment.html>

From even.rouault at mines-paris.org  Wed May 28 05:26:15 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 14:26:15 +0200
Subject: [gdal-dev] Gdalwarp is unable to output a geotiff with units =
	seconds correctly
In-Reply-To: <CALNygLm-EZXi5kOeuS5fZgq5ie5AQkfdS7Mfzq9Q=cOy2=8iRA@mail.gmail.com>
References: <CALNygLm-EZXi5kOeuS5fZgq5ie5AQkfdS7Mfzq9Q=cOy2=8iRA@mail.gmail.com>
Message-ID: <201405281426.15549.even.rouault@mines-paris.org>

Le mardi 27 mai 2014 13:10:05, Marcel Korn a ?crit :
> We use geotif with units=seconds quite a lot.
> 
> I found that running :
> gdalwarp -t_srs <srs-def> <input path> <output path>
> 
> 1. If target srs_def is a prj file with EPSG code for GCS WGS84 and units=
> degree and my input file is a geotiff with GCS WGS84 and units= Seconds -
> the output file is a "normal" geotiff with GCS WGS84 and units= degree.
> 2. If target srs_def in a prj file with EPSG code for GCS WGS84 and units=
> SECONDS and my input file is a geotiff with GCS WGS84 and units= degree  -
> the output is a geotiff with the units undetected correctly.
> In order to correct the output file I used ArcCatalog and set the units to
> seconds.
> After the correction the file (and the header was ok).
> Note: the prj must include authority = EPSG and the code (in this case
> 4326) otherwise the geotiff is produced as Custom CS and it may or may not
> be identified correctly and fully by apps.
> Also note that with default units you can run gdalwarp with EPSG:4326
> instead of the prj file.
> 
> It seems like there is a functional program bug since GDAL reads
> non-default units OK but cannot produce a geotiff with seconds. Something
> similar will probable happen with UTM PCSs if the target is feet instead of
> meter (the default).
> 
> I would like to know if somebody else found this problem and how he solved
> it.
> Of course, I wait to get confirmation it is a bug or maybe I did something
> wrong.
> If it is a "new bug" I wou?d like to know what can I do to advance the
> solution for it.
> 
> This bug reminds me of a very old ArcMap bug that manifests itself when you
> open a polygon or a raster with non-default units like second. If this is
> the first item you open, the units are not read correctly until you reload
> the GCS into the Data Frame. And than you get Degrees...the logic (or the
> lack of it) is similar.
> 
> Best regards,
> Moty

Marcel,

could you open a ticket with all the elements to reproduce ?

From a quick review, it would require some work in proj.4 to add support for 
angular units and in the GDAL interface to proj.4 to use it to/from WKT. 
Perhaps in the GeoTIFF driver too.

I would note, that using EPSG:4326 in WKT with units != degree is something 
that calls for trouble. The equivalent of EPSG:4326 with units = seconds  is 
not EPSG:4326

You can contract a GDAL service provider if you want that topic to go forward.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 28 05:27:57 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 14:27:57 +0200
Subject: [gdal-dev] problems with merging ecw files
In-Reply-To: <1401172121023-5142634.post@n6.nabble.com>
References: <1401172121023-5142634.post@n6.nabble.com>
Message-ID: <201405281427.57476.even.rouault@mines-paris.org>

Le mardi 27 mai 2014 08:28:41, Chrishelring a ?crit :
> hi,
> 
> I?m trying to merge about 40 ecw files into one, using gdal_merge.py. it
> seems to work (no error), but when I?m trying to open the file, it says,
> "Unable to read header information: Cannot open file
> c:\temp\ortofoto2007\ortofoto2007.ecw".
> 
> I?m using GDAL 1.11.0 with the following command:
> 
> C:\TEMP\ortofoto2007>python C:\osgeo4w\bin\gdal_merge.py -o
> c:\temp\ortofoto2007
> \ortofoto2007.ecw --optfile c:\temp\ortofoto2007\orto07.txt
> 
> Any help would really be appreciated. :)

You would need to also specify "-of ECW" otherwise the .ecw produced is going 
to be a GeoTIFF.
Note that gdal_merge.py can have issues with big source images, so 
gdalbuildvrt + gdal_translate or gdalwarp are often better alternatives.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From lucena_ivan at hotmail.com  Wed May 28 05:32:19 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 28 May 2014 08:32:19 -0400
Subject: [gdal-dev] OGR-trunk plugin fails to load
Message-ID: <BLU173-W30DA8C2D7E1F55B60D02E990250@phx.gbl>

Hi Even,

I svn updated trunk and I build the OGR/OCI driver as a plugin and it fail to load.

$ gdalinfo --version
ERROR 1: dlsym(0x7fac63d051f0, _GDALRegisterMe): symbol not found
ERROR 1: dlsym(0x7fac63d051f0, _GDALRegister_CI): symbol not found
GDAL 2.0.0dev, released 2014/04/16

That is OSX 10.9. I haven't try on other systems yet.

I also build the GDAL/GeoRaster driver as a plugin and that seems to be fine.

It seems like a general problem, not only for that driver. So if you can try to build another OGR driver as a plugin you might find that same issue.

Regards,

Ivan



 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/93fade29/attachment.html>

From even.rouault at mines-paris.org  Wed May 28 06:26:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 15:26:46 +0200
Subject: [gdal-dev] OGR-trunk plugin fails to load
In-Reply-To: <BLU173-W30DA8C2D7E1F55B60D02E990250@phx.gbl>
References: <BLU173-W30DA8C2D7E1F55B60D02E990250@phx.gbl>
Message-ID: <201405281526.46436.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 14:32:19, Ivan Lucena a ?crit :
> Hi Even,
> 
> I svn updated trunk and I build the OGR/OCI driver as a plugin and it fail
> to load.
> 
> $ gdalinfo --version
> ERROR 1: dlsym(0x7fac63d051f0, _GDALRegisterMe): symbol not found
> ERROR 1: dlsym(0x7fac63d051f0, _GDALRegister_CI): symbol not found
> GDAL 2.0.0dev, released 2014/04/16
> 
> That is OSX 10.9. I haven't try on other systems yet.
> 
> I also build the GDAL/GeoRaster driver as a plugin and that seems to be
> fine.
> 
> It seems like a general problem, not only for that driver. So if you can
> try to build another OGR driver as a plugin you might find that same
> issue.

Indeed. Should be fixed now.

> 
> Regards,
> 
> Ivan

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jonathanmoules at warwickshire.gov.uk  Wed May 28 07:35:39 2014
From: jonathanmoules at warwickshire.gov.uk (Jonathan Moules)
Date: Wed, 28 May 2014 15:35:39 +0100
Subject: [gdal-dev] Questions about processing four band (RGBI) imagery
Message-ID: <CAA-xNcVCGHmTOGm5u-DhhUJoqMBNa3dfwuA4Y46RMhHyoBtm1w@mail.gmail.com>

Hi List,
  I have four band (RGB plus Infrared) imagery from some aerial photography
we've had flown. I've already used GDAL to create suitable optimised RGB
GeoTIFFs using this data and now want to do it with the Infrared band too.

The RGBI data is about 1TB uncompressed, currently stored as 2732 GeoTIFF
tiles compressed with LZW:

Files: SK1400.tif
>        SK1400.tfw
> Size is 8000, 8000
> Coordinate System is:
> PROJCS["OSGB 1936 / British National Grid",
>     GEOGCS["OSGB 1936",
>         DATUM["OSGB_1936",
>             SPHEROID["Airy 1830",6377563.396,299.3249753150316,
>                 AUTHORITY["EPSG","7001"]],
>             AUTHORITY["EPSG","6277"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4277"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",49],
>     PARAMETER["central_meridian",-2],
>     PARAMETER["scale_factor",0.9996012717],
>     PARAMETER["false_easting",400000],
>     PARAMETER["false_northing",-100000],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","27700"]]
> Origin = (414000.000000000000000,301000.000000000000000)
> Pixel Size = (0.125000000000000,-0.125000000000000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  414000.000,  301000.000) (  1d47'35.68"W, 52d36'22.49"N)
> Lower Left  (  414000.000,  300000.000) (  1d47'35.83"W, 52d35'50.12"N)
> Upper Right (  415000.000,  301000.000) (  1d46'42.51"W, 52d36'22.40"N)
> Lower Right (  415000.000,  300000.000) (  1d46'42.68"W, 52d35'50.03"N)
> Center      (  414500.000,  300500.000) (  1d47' 9.18"W, 52d36' 6.26"N)
> Band 1 Block=8000x32 Type=Byte, ColorInterp=Red
> Band 2 Block=8000x32 Type=Byte, ColorInterp=Green
> Band 3 Block=8000x32 Type=Byte, ColorInterp=Blue
> Band 4 Block=8000x32 Type=Byte, ColorInterp=Undefined
>
>

My goal is to create a mosaiced GeoTIFF image with all four bands in it. It
should be as small as possible without serious quality degredation.


I've got some some questions as a result of my experiments so far:


   - "-co PHOTOMETRIC=YCBCR" - in gdal_translate this will fail saying it
   only works with 3 bands. Yet with gdaladdo, compressing overviews with
   "--config PHOTOMETRIC_OVERVIEW YCBCR" works fine (or at least gives no
   errors). Any reason for this?
   - Is there any special compression to use for four band imagery as I
   can't use YCBCR?
   - What's the best way to process the data? I'm using:

gdal_translate aerial.vrt aerial.tif -of GTiff -co BIGTIFF=YES -co
> TILED=YES -co blockxsize=512 -co blockysize=512 -co COMPRESS=JPEG -co
> JPEG_QUALITY=50 -a_srs EPSG:27700
> gdaladdo aerial.tif -r average --config COMPRESS_OVERVIEW JPEG --config
> JPEG_QUALITY_OVERVIEW 50 --config INTERLEAVE_OVERVIEW PIXEL --config
> PHOTOMETRIC_OVERVIEW YCBCR 2 4 8 16 32


   - How do I get GDAL to *not *set Band 4 to "Alpha" (which is what the
   above does).

Using GDAL 1.10.1

Thanks,
Jonathan

-- 
This transmission is intended for the named addressee(s) only and may 
contain confidential, sensitive or personal information and should be 
handled accordingly. Unless you are the named addressee (or authorised to 
receive it for the addressee) you may not copy or use it, or disclose it to 
anyone else. If you have received this transmission in error please notify 
the sender immediately. All email traffic sent to or from us, including 
without limitation all GCSX traffic, may be subject to recording and/or 
monitoring in accordance with relevant legislation.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/05a499c8/attachment.html>

From rgourrat at ag-carto.fr  Wed May 28 10:48:18 2014
From: rgourrat at ag-carto.fr (=?iso-8859-1?Q?R=E9my_GOURRAT?=)
Date: Wed, 28 May 2014 17:48:18 +0000
Subject: [gdal-dev] [Gdal 1.11]gdal_merge.py issue for merging tif
Message-ID: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>

Hi,

I try to use gdal_merge.py on a windows server 2008 r2 intel.

So i installed Python 3.3.3 and gdal and gdal-111-1600-x64-core.msi<http://www.gisinternals.com/sdk/Download.aspx?file=release-1600-x64-gdal-1-11-mapserver-6-4\gdal-111-1600-x64-core.msi>

GDAL_DATA et GDAL_DRIVER_PATH are Ok, I check with trying an ogr2ogr from OCI to Shape with -a_srs EPSG.

When I do a "gdalinfo" d1.tif and "gdalinfo d2.tif" it's Ok.

But Every time I try to execute this script :

gdal_merge.py -o output.tif d1.tif d2.tif

I have this error message :

"
Traceback (most recent call last):
  File "C:\Program Files\GDAL\gdal_merge.py", line 35, in <module>
    from osgeo import gdal
ImportError: cannot import name gdal

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files\GDAL\gdal_merge.py", line 37, in <module>
    import gdal
ImportError: No module named 'gdal'
"
do i need to install the GDAL-1.11.0.win-amd64-py3.3.msi , i think that's it just for AMD Processor, right ?

Thanks for your help

R?my Gourrat

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/24db255d/attachment.html>

From even.rouault at mines-paris.org  Wed May 28 10:56:40 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 19:56:40 +0200
Subject: [gdal-dev] [Gdal 1.11]gdal_merge.py issue for merging tif
In-Reply-To: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>
References: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>
Message-ID: <201405281956.40874.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 19:48:18, R?my GOURRAT a ?crit :
> Hi,
> 
> I try to use gdal_merge.py on a windows server 2008 r2 intel.
> 
> So i installed Python 3.3.3 and gdal and
> gdal-111-1600-x64-core.msi<http://www.gisinternals.com/sdk/Download.aspx?f
> ile=release-1600-x64-gdal-1-11-mapserver-6-4\gdal-111-1600-x64-core.msi>
> 
> GDAL_DATA et GDAL_DRIVER_PATH are Ok, I check with trying an ogr2ogr from
> OCI to Shape with -a_srs EPSG.
> 
> When I do a "gdalinfo" d1.tif and "gdalinfo d2.tif" it's Ok.
> 
> But Every time I try to execute this script :
> 
> gdal_merge.py -o output.tif d1.tif d2.tif
> 
> I have this error message :
> 
> "
> Traceback (most recent call last):
>   File "C:\Program Files\GDAL\gdal_merge.py", line 35, in <module>
>     from osgeo import gdal
> ImportError: cannot import name gdal
> 
> During handling of the above exception, another exception occurred:
> 
> Traceback (most recent call last):
>   File "C:\Program Files\GDAL\gdal_merge.py", line 37, in <module>
>     import gdal
> ImportError: No module named 'gdal'
> "
> do i need to install the GDAL-1.11.0.win-amd64-py3.3.msi , i think that's
> it just for AMD Processor, right ?

R?gis,

Yes you need the Python bindings. AMD64 is actually the original name of the 
Intel 64bit architecture.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 28 11:07:28 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 20:07:28 +0200
Subject: [gdal-dev] Questions about processing four band (RGBI) imagery
In-Reply-To: <CAA-xNcVCGHmTOGm5u-DhhUJoqMBNa3dfwuA4Y46RMhHyoBtm1w@mail.gmail.com>
References: <CAA-xNcVCGHmTOGm5u-DhhUJoqMBNa3dfwuA4Y46RMhHyoBtm1w@mail.gmail.com>
Message-ID: <201405282007.28304.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 16:35:39, Jonathan Moules a ?crit :
> Hi List,
>   I have four band (RGB plus Infrared) imagery from some aerial photography
> we've had flown. I've already used GDAL to create suitable optimised RGB
> GeoTIFFs using this data and now want to do it with the Infrared band too.
> 
> The RGBI data is about 1TB uncompressed, currently stored as 2732 GeoTIFF
> tiles compressed with LZW:
> 
> Files: SK1400.tif
> 
> >        SK1400.tfw
> > 
> > Size is 8000, 8000
> > Coordinate System is:
> > PROJCS["OSGB 1936 / British National Grid",
> > 
> >     GEOGCS["OSGB 1936",
> >     
> >         DATUM["OSGB_1936",
> >         
> >             SPHEROID["Airy 1830",6377563.396,299.3249753150316,
> >             
> >                 AUTHORITY["EPSG","7001"]],
> >             
> >             AUTHORITY["EPSG","6277"]],
> >         
> >         PRIMEM["Greenwich",0],
> >         UNIT["degree",0.0174532925199433],
> >         AUTHORITY["EPSG","4277"]],
> >     
> >     PROJECTION["Transverse_Mercator"],
> >     PARAMETER["latitude_of_origin",49],
> >     PARAMETER["central_meridian",-2],
> >     PARAMETER["scale_factor",0.9996012717],
> >     PARAMETER["false_easting",400000],
> >     PARAMETER["false_northing",-100000],
> >     UNIT["metre",1,
> >     
> >         AUTHORITY["EPSG","9001"]],
> >     
> >     AUTHORITY["EPSG","27700"]]
> > 
> > Origin = (414000.000000000000000,301000.000000000000000)
> > Pixel Size = (0.125000000000000,-0.125000000000000)
> > 
> > Metadata:
> >   AREA_OR_POINT=Area
> > 
> > Image Structure Metadata:
> >   COMPRESSION=LZW
> >   INTERLEAVE=PIXEL
> > 
> > Corner Coordinates:
> > Upper Left  (  414000.000,  301000.000) (  1d47'35.68"W, 52d36'22.49"N)
> > Lower Left  (  414000.000,  300000.000) (  1d47'35.83"W, 52d35'50.12"N)
> > Upper Right (  415000.000,  301000.000) (  1d46'42.51"W, 52d36'22.40"N)
> > Lower Right (  415000.000,  300000.000) (  1d46'42.68"W, 52d35'50.03"N)
> > Center      (  414500.000,  300500.000) (  1d47' 9.18"W, 52d36' 6.26"N)
> > Band 1 Block=8000x32 Type=Byte, ColorInterp=Red
> > Band 2 Block=8000x32 Type=Byte, ColorInterp=Green
> > Band 3 Block=8000x32 Type=Byte, ColorInterp=Blue
> > Band 4 Block=8000x32 Type=Byte, ColorInterp=Undefined
> 
> My goal is to create a mosaiced GeoTIFF image with all four bands in it. It
> should be as small as possible without serious quality degredation.
> 
> 
> I've got some some questions as a result of my experiments so far:
> 
> 
>    - "-co PHOTOMETRIC=YCBCR" - in gdal_translate this will fail saying it
>    only works with 3 bands. Yet with gdaladdo, compressing overviews with
>    "--config PHOTOMETRIC_OVERVIEW YCBCR" works fine (or at least gives no
>    errors). Any reason for this?

--config PHOTOMETRIC_OVERVIEW YCBCR is ignored if you build internal GTiff 
overview. And I've just tested with external overview and it fails as expected 
:

$ gdaladdo 4band.tif 2 --config COMPRESS_OVERVIEW JPEG --config 
PHOTOMETRIC_OVERVIEW YCBCR -ro
ERROR 6: PHOTOMETRIC_OVERVIEW=YCBCR requires a source raster with only 3 bands 
(RGB)
Overview building failed.


>    - Is there any special compression to use for four band imagery as I
>    can't use YCBCR?

Just base JPEG compression

>    - What's the best way to process the data? I'm using:
> 
> gdal_translate aerial.vrt aerial.tif -of GTiff -co BIGTIFF=YES -co
> 
> > TILED=YES -co blockxsize=512 -co blockysize=512 -co COMPRESS=JPEG -co
> > JPEG_QUALITY=50 -a_srs EPSG:27700
> > gdaladdo aerial.tif -r average --config COMPRESS_OVERVIEW JPEG --config
> > JPEG_QUALITY_OVERVIEW 50 --config INTERLEAVE_OVERVIEW PIXEL --config
> > PHOTOMETRIC_OVERVIEW YCBCR 2 4 8 16 32

As said above, the --config options will be ignored for internal overviews 
(except JPEG_QUALITY_OVERVIEW actually). They will reuse the same setting as 
the full resolution bands

> 
>    - How do I get GDAL to *not *set Band 4 to "Alpha" (which is what the
>    above does).

Add -co ALPHA=UNSPECIFIED

> 
> Using GDAL 1.10.1
> 
> Thanks,
> Jonathan

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gordonfarquharson at gmail.com  Wed May 28 12:03:40 2014
From: gordonfarquharson at gmail.com (Gordon Farquharson)
Date: Wed, 28 May 2014 12:03:40 -0700
Subject: [gdal-dev] VRTBuilder class
Message-ID: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>

The VRTBuilder class in the gdalbuildvrt utility source code is very
useful. Is there any intention to make it part of the GDAL API?

Gordon

-- 
Gordon Farquharson
GnuPG Key ID: 32D6D676
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/10fcd30b/attachment.html>

From even.rouault at mines-paris.org  Wed May 28 12:18:19 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 21:18:19 +0200
Subject: [gdal-dev] VRTBuilder class
In-Reply-To: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
References: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
Message-ID: <201405282118.19197.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 21:03:40, Gordon Farquharson a ?crit :
> The VRTBuilder class in the gdalbuildvrt utility source code is very
> useful. Is there any intention to make it part of the GDAL API?
> 
> Gordon

Gordon,

the idea of turning the code of GDAL utilities as library code reusable by 
user code has floated around. It probably waits for contributions and/or 
funding. In the mean time, you can "import" the code into your code.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gordonfarquharson at gmail.com  Wed May 28 12:27:54 2014
From: gordonfarquharson at gmail.com (Gordon Farquharson)
Date: Wed, 28 May 2014 12:27:54 -0700
Subject: [gdal-dev] VRTBuilder class
In-Reply-To: <201405282118.19197.even.rouault@mines-paris.org>
References: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
	<201405282118.19197.even.rouault@mines-paris.org>
Message-ID: <CABwPwwLW0C4CBWvPojfEJDdkKxTkJSTLBjdzG49V9r8ADQA4_w@mail.gmail.com>

Thanks for the quick answer. Would the approach of turning GDAL utility
code into libraries be as simple as putting the code into .h and .cpp
files, or would you want to do it in a more globally organized way, e.g..,
to develop a sensible class hierarchy and a consistent naming scheme?

Gordon


On Wed, May 28, 2014 at 12:18 PM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Le mercredi 28 mai 2014 21:03:40, Gordon Farquharson a ?crit :
> > The VRTBuilder class in the gdalbuildvrt utility source code is very
> > useful. Is there any intention to make it part of the GDAL API?
> >
> > Gordon
>
> Gordon,
>
> the idea of turning the code of GDAL utilities as library code reusable by
> user code has floated around. It probably waits for contributions and/or
> funding. In the mean time, you can "import" the code into your code.
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



-- 
Gordon Farquharson
GnuPG Key ID: 32D6D676
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/28f17145/attachment.html>

From even.rouault at mines-paris.org  Wed May 28 12:42:39 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 21:42:39 +0200
Subject: [gdal-dev] VRTBuilder class
In-Reply-To: <CABwPwwLW0C4CBWvPojfEJDdkKxTkJSTLBjdzG49V9r8ADQA4_w@mail.gmail.com>
References: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
	<201405282118.19197.even.rouault@mines-paris.org>
	<CABwPwwLW0C4CBWvPojfEJDdkKxTkJSTLBjdzG49V9r8ADQA4_w@mail.gmail.com>
Message-ID: <201405282142.40026.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 21:27:54, Gordon Farquharson a ?crit :
> Thanks for the quick answer. Would the approach of turning GDAL utility
> code into libraries be as simple as putting the code into .h and .cpp
> files, or would you want to do it in a more globally organized way, e.g..,
> to develop a sensible class hierarchy and a consistent naming scheme?

Everything can be considered. Proposals welcome.
At the minimum, work should be done to remove global variables, avoid exit() 
calls, etc... so that it can be used as a proper library function.
And it would be good if that library'fication of utilities should allow to pass 
dataset objects instead of strings for example. 

> 
> Gordon
> 
> 
> On Wed, May 28, 2014 at 12:18 PM, Even Rouault
> <even.rouault at mines-paris.org
> 
> > wrote:
> > 
> > Le mercredi 28 mai 2014 21:03:40, Gordon Farquharson a ?crit :
> > > The VRTBuilder class in the gdalbuildvrt utility source code is very
> > > useful. Is there any intention to make it part of the GDAL API?
> > > 
> > > Gordon
> > 
> > Gordon,
> > 
> > the idea of turning the code of GDAL utilities as library code reusable
> > by user code has floated around. It probably waits for contributions
> > and/or funding. In the mean time, you can "import" the code into your
> > code.
> > 
> > Even
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From skunkmyrddyn at gmail.com  Wed May 28 12:47:12 2014
From: skunkmyrddyn at gmail.com (Simon Shak)
Date: Wed, 28 May 2014 14:47:12 -0500
Subject: [gdal-dev] problems with merging ecw files
In-Reply-To: <1401172121023-5142634.post@n6.nabble.com>
References: <1401172121023-5142634.post@n6.nabble.com>
Message-ID: <CAJuTQSGkHuOO1AH2CKR+HrJ4c5Svzn0OOoRSyu_K+ahwbpzZdg@mail.gmail.com>

Depending on how large an output file there are limitations in the file
formats to consider. The older ecw library allows writing a file no larger
than 500mb.the newer one you need a special license to write at all.  The
geotiff will by default not write as big tiff which will also limit output
file size. Check the file formats page for details.
On May 27, 2014 1:29 AM, "Chrishelring" <christianhelring at gmail.com> wrote:

> hi,
>
> I?m trying to merge about 40 ecw files into one, using gdal_merge.py. it
> seems to work (no error), but when I?m trying to open the file, it says,
> "Unable to read header information: Cannot open file
> c:\temp\ortofoto2007\ortofoto2007.ecw".
>
> I?m using GDAL 1.11.0 with the following command:
>
> C:\TEMP\ortofoto2007>python C:\osgeo4w\bin\gdal_merge.py -o
> c:\temp\ortofoto2007
> \ortofoto2007.ecw --optfile c:\temp\ortofoto2007\orto07.txt
>
> Any help would really be appreciated. :)
>
> Christian
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/problems-with-merging-ecw-files-tp5142634.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/ae65bbd2/attachment.html>

From siebe at hydroconsult.nl  Wed May 28 12:14:34 2014
From: siebe at hydroconsult.nl (Siebe Bosch)
Date: Wed, 28 May 2014 21:14:34 +0200
Subject: [gdal-dev] VRTBuilder class
In-Reply-To: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
References: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
Message-ID: <5386359A.20009@hydroconsult.nl>

Dear Gordon,

If you want to use the VRTBuilder inside your own programming 
environment (on Windows) you could also start using the MapWinGIS 
ActiveX control.
Version 4.9 and later supports GDAL, including the VRTBuilder function.

The activeX control can be downloaded here:
mapwingis.codeplex.com

I just got it working myself. Building a VRT file from a bunch of grids 
has become quite easy now. Sequentially I use functions such as 
ClipGridByPolygon on the VRT file and it works fine.

Cheers,
Siebe



On 28-05-14 21:03, Gordon Farquharson wrote:
> The VRTBuilder class in the gdalbuildvrt utility source code is very 
> useful. Is there any intention to make it part of the GDAL API?
>
> Gordon
>
> -- 
> Gordon Farquharson
> GnuPG Key ID: 32D6D676
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
---------------------------------------------
Hydroconsult
Lulofsstraat 55, unit 47
2521 AL Den Haag
The Netherlands

web: http://www.hydroconsult.nl
e-mail: siebe at hydroconsult.nl
phone: +31(0)70 250 0580
mobile: +31(0)6 17 682 689
---------------------------------------------
Aangesloten bij WaterFocus, de co?peratie van
zelfstandige professionals in het waterbeheer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/d2fa9d5f/attachment.html>

From klonuo at gmail.com  Wed May 28 13:10:51 2014
From: klonuo at gmail.com (klo uo)
Date: Wed, 28 May 2014 22:10:51 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
	PDF] with the following drivers
Message-ID: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>

Hi,

I have vector data in PDF format, which I tried to georeference with
org2ogr -gcp feature and output basic Shapefile, but program complains that
it's unable to read the PDF file, which I confirm as valid by processing it
with ghostscript.

I then converted PDF to SVG and confirmed that SVG is well-formed and valid
XML, but again ogr2ogr complains about it.

Finally by converting initial PDF to DXF, ogr2ogr was able to complete the
task.

I want to avoid converting PDF to other format and especially to DXF which
makes the process slow, so I'm hoping for advice. I can provide the test
files if necessary.  Thanks.

I use 64 bit GDAL 1.10.1, released 2013/08/26 from gisinternals on Windows 8


Here is output from `ogrinfo --formats`:

c:\Program Files\GDAL>ogrinfo --formats
Supported Formats:
  -> "ESRI Shapefile" (read/write)
  -> "MapInfo File" (read/write)
  -> "UK .NTF" (readonly)
  -> "SDTS" (readonly)
  -> "TIGER" (read/write)
  -> "S57" (read/write)
  -> "DGN" (read/write)
  -> "VRT" (readonly)
  -> "REC" (readonly)
  -> "Memory" (read/write)
  -> "BNA" (read/write)
  -> "CSV" (read/write)
  -> "NAS" (readonly)
  -> "GML" (read/write)
  -> "GPX" (read/write)
  -> "LIBKML" (read/write)
  -> "KML" (read/write)
  -> "GeoJSON" (read/write)
  -> "Interlis 1" (read/write)
  -> "Interlis 2" (read/write)
  -> "GMT" (read/write)
  -> "SQLite" (read/write)
  -> "ODBC" (read/write)
  -> "PGeo" (readonly)
  -> "MSSQLSpatial" (read/write)
  -> "PostgreSQL" (read/write)
  -> "MySQL" (read/write)
  -> "PCIDSK" (read/write)
  -> "XPlane" (readonly)
  -> "AVCBin" (readonly)
  -> "AVCE00" (readonly)
  -> "DXF" (read/write)
  -> "Geoconcept" (read/write)
  -> "GeoRSS" (read/write)
  -> "GPSTrackMaker" (read/write)
  -> "VFK" (readonly)
  -> "PGDump" (read/write)
  -> "OSM" (readonly)
  -> "GPSBabel" (read/write)
  -> "SUA" (readonly)
  -> "OpenAir" (readonly)
  -> "PDS" (readonly)
  -> "WFS" (readonly)
  -> "HTF" (readonly)
  -> "AeronavFAA" (readonly)
  -> "Geomedia" (readonly)
  -> "EDIGEO" (readonly)
  -> "GFT" (read/write)
  -> "SVG" (readonly)
  -> "CouchDB" (read/write)
  -> "Idrisi" (readonly)
  -> "ARCGEN" (readonly)
  -> "SEGUKOOA" (readonly)
  -> "SEGY" (readonly)
  -> "ODS" (read/write)
  -> "XLSX" (read/write)
  -> "ElasticSearch" (read/write)
  -> "PDF" (read/write)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140528/2047b860/attachment-0001.html>

From even.rouault at mines-paris.org  Wed May 28 13:27:33 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 22:27:33 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
	PDF] with the following drivers
In-Reply-To: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
References: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
Message-ID: <201405282227.33502.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 22:10:51, klo uo a ?crit :
> Hi,
> 
> I have vector data in PDF format, which I tried to georeference with
> org2ogr -gcp feature and output basic Shapefile, but program complains that
> it's unable to read the PDF file, which I confirm as valid by processing it
> with ghostscript.
> 
> I then converted PDF to SVG and confirmed that SVG is well-formed and valid
> XML, but again ogr2ogr complains about it.
> 
> Finally by converting initial PDF to DXF, ogr2ogr was able to complete the
> task.
> 
> I want to avoid converting PDF to other format and especially to DXF which
> makes the process slow, so I'm hoping for advice. I can provide the test
> files if necessary.  Thanks.

Could you provide the test file ? The PDF vector reader has some limitations, 
and works best with "structured" PDF.

As far as SVG is concerned, the SVG reader is also currently limited to a 
particular formation of SVG : http://gdal.org/drv_svg.html

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 28 14:34:35 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 28 May 2014 23:34:35 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
	PDF] with the following drivers
In-Reply-To: <CAA-8Ld_t1gK78fy6qgMP6PADQpDhsugvfQPG6EyMQmoUYn7x+A@mail.gmail.com>
References: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
	<201405282227.33502.even.rouault@mines-paris.org>
	<CAA-8Ld_t1gK78fy6qgMP6PADQpDhsugvfQPG6EyMQmoUYn7x+A@mail.gmail.com>
Message-ID: <201405282334.35482.even.rouault@mines-paris.org>

Le mercredi 28 mai 2014 23:06:38, vous avez ?crit :
> Hi Even,
> 
> thanks for your prompt reply.
> 
> Could you please tell more about the PDF limitation. For example a way to
> transform my PDF to the one that ogr2ogr would understand?
> 
> I attached the test files.

The PDF driver would require some enhancements to support that kind of file. 
Basically it currently only supports files that have a layered organization, 
whereas yours is "flat". From a quick analysis, I'd say it would require modest 
effort to support that file.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From klonuo at gmail.com  Wed May 28 15:24:34 2014
From: klonuo at gmail.com (klo uo)
Date: Thu, 29 May 2014 00:24:34 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
 PDF] with the following drivers
In-Reply-To: <201405282334.35482.even.rouault@mines-paris.org>
References: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
	<201405282227.33502.even.rouault@mines-paris.org>
	<CAA-8Ld_t1gK78fy6qgMP6PADQpDhsugvfQPG6EyMQmoUYn7x+A@mail.gmail.com>
	<201405282334.35482.even.rouault@mines-paris.org>
Message-ID: <CAA-8Ld_oPkDEDgMfXAEvNUp2+iyWcThu6Jf7JeNP_2TZXkkx6A@mail.gmail.com>

Ok, thanks for your confirmation.

I'll go DXF route.
In the meantime I found that by using pstoedit for conversion from PDF to
DXF is the right choice.



On Wed, May 28, 2014 at 11:34 PM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Le mercredi 28 mai 2014 23:06:38, vous avez ?crit :
> > Hi Even,
> >
> > thanks for your prompt reply.
> >
> > Could you please tell more about the PDF limitation. For example a way to
> > transform my PDF to the one that ogr2ogr would understand?
> >
> > I attached the test files.
>
> The PDF driver would require some enhancements to support that kind of
> file.
> Basically it currently only supports files that have a layered
> organization,
> whereas yours is "flat". From a quick analysis, I'd say it would require
> modest
> effort to support that file.
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/7e038a2d/attachment.html>

From zlzhao1104 at gmail.com  Wed May 28 18:11:34 2014
From: zlzhao1104 at gmail.com (zlzhao1104)
Date: Wed, 28 May 2014 18:11:34 -0700 (PDT)
Subject: [gdal-dev] Store GDAL Result Raster in PostGIS Directly
Message-ID: <1401325894541-5143022.post@n6.nabble.com>

Hi I'm a new GDAL/PostGIS user.  This question might be simple to you:

I need to use gdal_translate to clip a raster, which is already stored in
PostGIS.  I could do it by using "PG" to link to my PostGIS database and I
could store the result as a tiff file on my disk:

gdal_translate -projwin -120.01969132 35.8820930603 -119.47058351
35.1172643251 "PG: dbname=geodb host=localhost user=postgres password=xxxxxx
port=5432 mode=2 schema=public table=srtm_ca" test.tiff

I'm wondering if there is a way to store the result raster directly to my
PostGIS database as a table.  I tried to replace "test.tiff" above to
"PG:......" but GDAL still generated a raster on my disk named "PG:......".

Thanks in advance for any ideas and sorry to bother others.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Store-GDAL-Result-Raster-in-PostGIS-Directly-tp5143022.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From chaitanya.ch at gmail.com  Wed May 28 19:59:23 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu, 29 May 2014 08:29:23 +0530
Subject: [gdal-dev] Store GDAL Result Raster in PostGIS Directly
In-Reply-To: <1401325894541-5143022.post@n6.nabble.com>
References: <1401325894541-5143022.post@n6.nabble.com>
Message-ID: <CAMKgpOZw=Rz-Lm60UFuRiatvZ3mKkwZ77fwJjtH9T-HL0LxseA@mail.gmail.com>

zlzhao1104,

Two things:
You need to specify the output data format using the -of option.
PostGIS raster driver doesn't support writing yet. It's being implemented
now.

It is more efficient to do that directly using an SQL command. Refer to
PostGIS docs.

--
Best regards,
Chaitanya Kumar CH
On 29-May-2014 6:42 am, "zlzhao1104" <zlzhao1104 at gmail.com> wrote:

> Hi I'm a new GDAL/PostGIS user.  This question might be simple to you:
>
> I need to use gdal_translate to clip a raster, which is already stored in
> PostGIS.  I could do it by using "PG" to link to my PostGIS database and I
> could store the result as a tiff file on my disk:
>
> gdal_translate -projwin -120.01969132 35.8820930603 -119.47058351
> 35.1172643251 "PG: dbname=geodb host=localhost user=postgres
> password=xxxxxx
> port=5432 mode=2 schema=public table=srtm_ca" test.tiff
>
> I'm wondering if there is a way to store the result raster directly to my
> PostGIS database as a table.  I tried to replace "test.tiff" above to
> "PG:......" but GDAL still generated a raster on my disk named "PG:......".
>
> Thanks in advance for any ideas and sorry to bother others.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Store-GDAL-Result-Raster-in-PostGIS-Directly-tp5143022.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/aa73b4a0/attachment.html>

From zlzhao1104 at gmail.com  Wed May 28 21:17:31 2014
From: zlzhao1104 at gmail.com (zlzhao1104)
Date: Wed, 28 May 2014 21:17:31 -0700 (PDT)
Subject: [gdal-dev] Store GDAL Result Raster in PostGIS Directly
In-Reply-To: <CAMKgpOZw=Rz-Lm60UFuRiatvZ3mKkwZ77fwJjtH9T-HL0LxseA@mail.gmail.com>
References: <1401325894541-5143022.post@n6.nabble.com>
	<CAMKgpOZw=Rz-Lm60UFuRiatvZ3mKkwZ77fwJjtH9T-HL0LxseA@mail.gmail.com>
Message-ID: <1401337051960-5143036.post@n6.nabble.com>

Thanks a lot, chaitanya_ch.  I'll use SQL instead.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Store-GDAL-Result-Raster-in-PostGIS-Directly-tp5143022p5143036.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From cavallini at faunalia.it  Wed May 28 23:35:10 2014
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Thu, 29 May 2014 08:35:10 +0200
Subject: [gdal-dev] VRTBuilder class
In-Reply-To: <5386359A.20009@hydroconsult.nl>
References: <CABwPwwLuKpbs=KWt+h8=qiyjbFteqfmnq7dRdE_xR6REoe5i6g@mail.gmail.com>
	<5386359A.20009@hydroconsult.nl>
Message-ID: <5386D51E.9090009@faunalia.it>

Il 28/05/2014 21:14, Siebe Bosch ha scritto:
> If you want to use the VRTBuilder inside your own programming environment (on
> Windows) you could also start using the MapWinGIS ActiveX control.
> Version 4.9 and later supports GDAL, including the VRTBuilder function.

Or you can use Processing in QGIS to automatically create a Python script for this.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
Corsi QGIS e PostGIS: http://www.faunalia.eu/training.html

From battisti at actgate.com  Thu May 29 03:26:58 2014
From: battisti at actgate.com (Andrea Battisti)
Date: Thu, 29 May 2014 12:26:58 +0200
Subject: [gdal-dev]  geotiff false easting/northing unit nuisance
Message-ID: <53870B72.5070701@actgate.com>

Hello,


I am trying to have GDAL play nice with some geotiff aerial images, and 
I have an issue with the way the units are handled on the false 
easting/northing parameters.

The images use the California State Plane projection (zone 2), in feet, 
not meters, i.e.:
http://spatialreference.org/ref/epsg/2226/



Now, this is what I get from listgeo:

Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (2,3):
          0                 0                 0
          6391500           1996000           0
       ModelPixelScaleTag (1,3):
          1                 1                 0
       End_Of_Tags.
    Keyed_Information:
       GTModelTypeGeoKey (Short,1): ModelTypeProjected
       GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
       GTCitationGeoKey (Ascii,318): "...
Projection Name = NAD_1983_StatePlane_California_II_FIPS_0402_Feet
Units = us_survey_feet
GeoTIFF Units = us_survey_feet"
       ProjectedCSTypeGeoKey (Short,1): PCS_NAD83_California_2
       PCSCitationGeoKey (Ascii,228): "...
State Plane Zone -402
NAD = 83"
       ProjLinearUnitsGeoKey (Short,1): Linear_Foot_US_Survey
       End_Of_Keys.
    End_Of_Geotiff.

PCS = 26942 (name unknown)
Projection = 10432 ()
GCS: 4269/NAD83
Datum: 6269/North American Datum 1983
Ellipsoid: 7019/GRS 1980 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)
Projection Linear Units: 9003/US survey foot (0.304801m)

Corner Coordinates:
Upper Left    ( 6391500.000, 1996000.000)
Lower Left    ( 6391500.000, 1991000.000)
Upper Right   ( 6396500.000, 1996000.000)
Lower Right   ( 6396500.000, 1991000.000)
Center        ( 6394000.000, 1993500.000)




And this is what I get from gdalsrsinfo (I tried both GDAL 1.9.2 and 
1.10.1, same result):


PROJ.4 : '+proj=lcc +lat_1=39.83333333333334 +lat_2=38.33333333333334 
+lat_0=37.
66666666666666 +lon_0=-122 +x_0=6561666.666666666 +y_0=1640416.666666667 
+datum=
NAD83 +units=us-ft +no_defs '

OGC WKT :
PROJCS["NAD_1983_StatePlane_California_II_FIPS_0402_Feet",
     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.2572221010002,
                 AUTHORITY["EPSG","7019"]],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4269"]],
     PROJECTION["Lambert_Conformal_Conic_2SP"],
     PARAMETER["standard_parallel_1",39.83333333333334],
     PARAMETER["standard_parallel_2",38.33333333333334],
     PARAMETER["latitude_of_origin",37.66666666666666],
     PARAMETER["central_meridian",-122],
     PARAMETER["false_easting",21527734.72222222],
     PARAMETER["false_northing",5381933.680555555],
     UNIT["us_survey_feet",0.3048006096012192],
     AUTHORITY["EPSG","26942"]]


That is very close to what I expect, except for the false 
easting/northing and thus x_0/y_0, which should be:

     PARAMETER["false_easting",6561666.667],
     PARAMETER["false_northing",1640416.667],

and in meters:+x_0=2000000 +y_0=500000


Now, I understand that this is an "obscure" area and it has already been 
discussed in the past, e.g.:
https://trac.osgeo.org/gdal/ticket/3901
https://trac.osgeo.org/gdal/ticket/4954
but it is not clear to me if there is something weird on these specific 
geotiff files, or on the GDAL side, or a combination of both
(by the way, these files work fine on ESRI software).

In this case, looks like that the WKT/Proj is read from external 
projection definition files, is it possible the force GDAL to show the 
right parameters without trying to adjust the units?



Thanks in advance and sorry for the long post!
Andrea Battisti, IT Engineer


From marcelacampo at gmail.com  Thu May 29 05:37:56 2014
From: marcelacampo at gmail.com (Marcela Campo)
Date: Thu, 29 May 2014 09:37:56 -0300
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <lm2hgq$nft$1@ger.gmane.org>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
	<CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
	<lm2hgq$nft$1@ger.gmane.org>
Message-ID: <CAN4kiCDXOOOWtO9ddf-LVTv3SU48avEcVnfKLH-mgVWufYKMhg@mail.gmail.com>

Hi Andre, thank you for the information. I mentioned 900913 in the response
because the error code actually refers to it, I have no idea why. I don't
reproject to it and I don't see any mention of it in the geographical
information in the tiff.

The shift is of a couple of kilometers. I have one image that looks ok, and
the rest does not. The only difference is that the original 'img' files
that turn out shifted have an ancialliary file with extension aux.xml.

Can it be that gdal is not picking that one up correctly? As far as I read
it should recognize it with no issues.

Thanks!


On Tue, May 27, 2014 at 2:19 PM, Andre Joost <andre+joost at nurfuerspam.de>wrote:

> Am 27.05.2014 18:45, schrieb Marcela Campo:
>
>  Hi Andr?, thank you for your response.
>>
>> I am not using EPSG:900913 anywhere
>>
>
> You mentioned an error message about EPSG:900913 in your first post.
> I did my gdal2tiling a few years ago, and at that time 900913 was still
> listed in proj. Now it has been replaced by EPSG:3857, but gdal2tiles still
> wants it (I guess).
>
> How much is your offset?
>
> If it is a few hundred meters, it is more likely a datum shift issue. If
> it is about 20km, it might be the Google mercator bug.
>
> For the first one, you might look into the PSAD56 or SAD69 UTM
> projections. They have a shift against WGS84 and POSGAR based projections.
>
> For the second, you can try setting -s_srs "EPSG:3395" -t_srs "EPSG:3857"
> (or the other way round) to correct it before tiling.
>
> You could as well load the untiled tif into QGIS and compare to
> Oepnstreetmap or Google background using the Openlayers plugin.
>
>
> HTH,
> Andr? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/fb0e77af/attachment-0001.html>

From david.fawcett at gmail.com  Thu May 29 06:33:36 2014
From: david.fawcett at gmail.com (David Fawcett)
Date: Thu, 29 May 2014 08:33:36 -0500
Subject: [gdal-dev] Question about strategy on building big mosaic
Message-ID: <CAF7K3b_5=57iF_G8aEWzUWNavXUJmcmejwp2Cqzv0iFdnjjdvw@mail.gmail.com>

I am working on a project where am creating (and re-creating) a large image
from ~125 image tiles.  Each tile is a 5000x5000px jp2000 compressed image,
with no internal tiles.

I have a vrt set up and I have merged them all together using
gdal_translate, but it took ~20 hours to run on an admittedly old Macbook
Pro.  Even explained that the large input tiles make it really inefficient
for the OpenJPEG2000 driver to read the input images as part of the
translate operation.

I am trying to figure out if it is a reasonable strategy to introduce an
intermediate step where I create tiled copies of the input tiles.  At the
same time, I don't want to decrease image quality with the intermediate
step.

If I used -co REVERSABLE=YES, would I be able to end up with the same
quality in my final output?

I realize that I will have to do the performance test to determine if it
makes sense to add this intermediate step from a processing time
standpoint, but does this sound like a reasonable approach?

Thanks,

David.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/7cbfb647/attachment.html>

From andre+joost at nurfuerspam.de  Thu May 29 06:31:27 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 29 May 2014 15:31:27 +0200
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
	<CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
Message-ID: <lm7d9n$or5$2@ger.gmane.org>

Am 27.05.2014 18:45, schrieb Marcela Campo:

>
> I am not sure about source projection, I found it out doing:
>
> gdalinfo -proj4 input.img
>

Can you add the full output of gdalinfo input.img (before any reprojection)?

Greetings,
Andr? Joost


From marcelacampo at gmail.com  Thu May 29 08:23:41 2014
From: marcelacampo at gmail.com (Marcela Campo)
Date: Thu, 29 May 2014 12:23:41 -0300
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <lm7d9n$or5$2@ger.gmane.org>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
	<CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
	<lm7d9n$or5$2@ger.gmane.org>
Message-ID: <CAN4kiCBbPm7fe_NFv01oo+u6aX7iVHw9XPPSk5YXti+pwAcRHw@mail.gmail.com>

Sure, this is the output of gdalinfo -nomd -norat on the original img file
Thanks!

Driver: HFA/Erdas Imagine Images (.img)
Files: rec_230076_1994-12-31_f4.img
       rec_230076_1994-12-31_f4.img.aux.xml
       rec_230076_1994-12-31_f4.rrd
Size is 725, 734
Coordinate System is:
PROJCS["Transverse Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9108"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",-90],
    PARAMETER["central_meridian",-63],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",4500000],
    PARAMETER["false_northing",0],
    UNIT["meters",1]]
Origin = (4392504.764280953444541,7439406.971977045759559)
Pixel Size = (30.015846093058180,-30.015846093058180)
Corner Coordinates:
Upper Left  ( 4392504.764, 7439406.972) ( 64d 2'58.91"W, 23d 9'33.23"S)
Lower Left  ( 4392504.764, 7417375.341) ( 64d 3' 4.52"W, 23d21'29.27"S)
Upper Right ( 4414266.253, 7439406.972) ( 63d50'13.98"W, 23d 9'37.81"S)
Lower Right ( 4414266.253, 7417375.341) ( 63d50'18.45"W, 23d21'33.90"S)
Center      ( 4403385.508, 7428391.156) ( 63d56'38.97"W, 23d15'33.68"S)
Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
  Description = Layer_1
  Min=21.000 Max=184.000
  Minimum=21.000, Maximum=184.000, Mean=94.024, StdDev=23.309
  Overviews: 182x184, 91x92, 46x46
Band 2 Block=64x64 Type=Byte, ColorInterp=Undefined
  Description = Layer_2
  Min=1.000 Max=255.000
  Minimum=1.000, Maximum=255.000, Mean=31.384, StdDev=18.953
  Overviews: 182x184, 91x92, 46x46
Band 3 Block=64x64 Type=Byte, ColorInterp=Undefined
  Description = Layer_3
  Min=1.000 Max=185.000
  Minimum=1.000, Maximum=185.000, Mean=71.827, StdDev=28.688
  Overviews: 182x184, 91x92, 46x46



On Thu, May 29, 2014 at 10:31 AM, Andre Joost <andre+joost at nurfuerspam.de>wrote:

> Am 27.05.2014 18:45, schrieb Marcela Campo:
>
>
>> I am not sure about source projection, I found it out doing:
>>
>> gdalinfo -proj4 input.img
>>
>>
> Can you add the full output of gdalinfo input.img (before any
> reprojection)?
>
> Greetings,
>
> Andr? Joost
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/d966ac6e/attachment.html>

From jrepetto at free.fr  Thu May 29 08:20:44 2014
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Thu, 29 May 2014 17:20:44 +0200
Subject: [gdal-dev] [Gdal 1.11]gdal_merge.py issue for merging tif
In-Reply-To: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>
References: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>
Message-ID: <5387504C.3030703@free.fr>

On 28/05/2014 19:48, R?my GOURRAT wrote:
>
> do i need to install the GDAL-1.11.0.win-amd64-py3.3.msi , i think
> that?s it just for AMD Processor, right ?
>
> Thanks for your help
>
> R?my Gourrat

Bonjour,

Since you are French, you may find useful to read this page :
http://geotribu.net/node/636

Jean-Claude


From andre+joost at nurfuerspam.de  Thu May 29 09:12:15 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 29 May 2014 18:12:15 +0200
Subject: [gdal-dev] issues with gdal2tiles.py
In-Reply-To: <CAN4kiCBbPm7fe_NFv01oo+u6aX7iVHw9XPPSk5YXti+pwAcRHw@mail.gmail.com>
References: <CAN4kiCDUm4N0vk984TRAyb1JDjiwtsJUqO=2q9TggKC4=+XuJw@mail.gmail.com>
	<lm297u$alo$1@ger.gmane.org>
	<CAN4kiCD0O_HP_T1cRqQWqe+6gxYRSo3r971dFNLskLK9A3+kyA@mail.gmail.com>
	<lm7d9n$or5$2@ger.gmane.org>
	<CAN4kiCBbPm7fe_NFv01oo+u6aX7iVHw9XPPSk5YXti+pwAcRHw@mail.gmail.com>
Message-ID: <lm7mbi$gif$1@ger.gmane.org>

Am 29.05.2014 17:23, schrieb Marcela Campo:
> Sure, this is the output of gdalinfo -nomd -norat on the original img file
>
> Origin = (4392504.764280953444541,7439406.971977045759559)
> Pixel Size = (30.015846093058180,-30.015846093058180)
> Corner Coordinates:
> Upper Left  ( 4392504.764, 7439406.972) ( 64d 2'58.91"W, 23d 9'33.23"S)
> Lower Left  ( 4392504.764, 7417375.341) ( 64d 3' 4.52"W, 23d21'29.27"S)
> Upper Right ( 4414266.253, 7439406.972) ( 63d50'13.98"W, 23d 9'37.81"S)
> Lower Right ( 4414266.253, 7417375.341) ( 63d50'18.45"W, 23d21'33.90"S)
> Center      ( 4403385.508, 7428391.156) ( 63d56'38.97"W, 23d15'33.68"S)

These points are 4 to 26 km east of Embarcacion, almost matching those 
of the EPSG:3857 tif you reported earlier. Even with the old Campo 
Inchauspe datum they are just 200m shifted.

Where do you expect the corners to be?

Greetings,
Andr? Joost


From jluis at ualg.pt  Thu May 29 09:58:42 2014
From: jluis at ualg.pt (jluis at ualg.pt)
Date: Thu, 29 May 2014 18:58:42 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
Message-ID: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>

Hi,

I made GMT respect as far as possible the AREA_OR_POINT GeoTiff key  
for read/write, but ...

The following was silently ignored (GMT uses the MEM driver)

GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

so digging here and there I found about GDALMD_AREA_OR_POINT, and in  
fact this one is now taken into consideration

GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);


However, this implies that on reading I have now to test for both

GDALGetMetadataItem(hDataset, "AREA_OR_POINT", NULL)

  ---- AND ----

GDALGetMetadataItem(hDataset, "GDALMD_AREA_OR_POINT", NULL)

This means that other codes that pay attention to the AREA vs POINT  
thing will have to do both tests as well and if they do only the first  
one, GeoTiffs created by GDAL will have the problem ignored, and quite  
likely an error in coordinates will follow.

So the question is, why this name duplication (AREA_OR_POINT vs  
GDALMD_AREA_OR_POINT) and why GDALSetMetadataItem() ignores the  
AREA_OR_POINT key?

Thanks
Joaquim

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.


From even.rouault at mines-paris.org  Thu May 29 11:26:40 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 20:26:40 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
Message-ID: <6175776.fk6az8a8hR@even-thinkpad-l530>

Joaquim,

I'm confused by what you are actually trying to do.

GDALMD_AREA_OR_POINT is a #define that evaluates to "AREA_OR_POINT". The string 
"GDALMD_AREA_OR_POINT" however is nowhere used in GDAL.

Regarding the MEM driver, GDALMD_AREA_OR_POINT is just a random metadata item.
Some drivers will set GDALMD_AREA_OR_POINT to the GDALMD_AOP_POINT = "Point" 
value.
And the GTiff driver uses it to determine if it must apply a half-pixel shift 
between the GDAL convention and the GeoTIFF convention.

Even

> Hi,
> 
> I made GMT respect as far as possible the AREA_OR_POINT GeoTiff key
> for read/write, but ...
> 
> The following was silently ignored (GMT uses the MEM driver)
> 
> GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
> 
> so digging here and there I found about GDALMD_AREA_OR_POINT, and in
> fact this one is now taken into consideration
> 
> GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);
> 
> 
> However, this implies that on reading I have now to test for both
> 
> GDALGetMetadataItem(hDataset, "AREA_OR_POINT", NULL)
> 
>   ---- AND ----
> 
> GDALGetMetadataItem(hDataset, "GDALMD_AREA_OR_POINT", NULL)
> 
> This means that other codes that pay attention to the AREA vs POINT
> thing will have to do both tests as well and if they do only the first
> one, GeoTiffs created by GDAL will have the problem ignored, and quite
> likely an error in coordinates will follow.
> 
> So the question is, why this name duplication (AREA_OR_POINT vs
> GDALMD_AREA_OR_POINT) and why GDALSetMetadataItem() ignores the
> AREA_OR_POINT key?
> 
> Thanks
> Joaquim
> 
> ----------------------------------------------------------------
> This message was sent using IMP, the Internet Messaging Program.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/be319b2d/attachment-0001.html>

From even.rouault at mines-paris.org  Thu May 29 11:45:48 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 20:45:48 +0200
Subject: [gdal-dev] Question about strategy on building big mosaic
In-Reply-To: <CAF7K3b_5=57iF_G8aEWzUWNavXUJmcmejwp2Cqzv0iFdnjjdvw@mail.gmail.com>
References: <CAF7K3b_5=57iF_G8aEWzUWNavXUJmcmejwp2Cqzv0iFdnjjdvw@mail.gmail.com>
Message-ID: <2469495.hkK3Z6gORD@even-thinkpad-l530>

David,

If you have plenty of storage space, you could translate each JPEG2000 image 
to a tiled uncompressed geotiff. Ideally you would use tiles of size 128 to 
match with the block size of the VRT driver.
If storage space is an issue, yes you can try reversible JPEG2000 (although 
compression rate is not particuarly shiny with reversible compression), but 
make sure that the block size is 128 too.

If you have enough RAM, you should also make sure that GDAL_CACHEMAX is at 
least 128 * width_of_vrt_mosaic * 3 (if your images are RGB). And potentially 
* 2 as security margin.

Even

On Thursday 29 May 2014 08:33:36 David Fawcett wrote:
> I am working on a project where am creating (and re-creating) a large image
> from ~125 image tiles.  Each tile is a 5000x5000px jp2000 compressed image,
> with no internal tiles.
> 
> I have a vrt set up and I have merged them all together using
> gdal_translate, but it took ~20 hours to run on an admittedly old Macbook
> Pro.  Even explained that the large input tiles make it really inefficient
> for the OpenJPEG2000 driver to read the input images as part of the
> translate operation.
> 
> I am trying to figure out if it is a reasonable strategy to introduce an
> intermediate step where I create tiled copies of the input tiles.  At the
> same time, I don't want to decrease image quality with the intermediate
> step.
> 
> If I used -co REVERSABLE=YES, would I be able to end up with the same
> quality in my final output?
> 
> I realize that I will have to do the performance test to determine if it
> makes sense to add this intermediate step from a processing time
> standpoint, but does this sound like a reasonable approach?
> 
> Thanks,
> 
> David.
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/01d27b2a/attachment.html>

From jluis at ualg.pt  Thu May 29 12:16:12 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 20:16:12 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <6175776.fk6az8a8hR@even-thinkpad-l530>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<6175776.fk6az8a8hR@even-thinkpad-l530>
Message-ID: <5387877C.3070705@ualg.pt>

On 29-05-2014 19:26, Even Rouault wrote:
>
> Joaquim,
>
> I'm confused by what you are actually trying to do.
>

OK Even, I'll try to explain better. As we all know here, GDAL reports 
all region limits as pixel corner coordinates (AREA_OR_POINT=Area for 
GeoTiffs). GMT on the other hand keeps track of the original 
registration (we call it grid or node registration (cell center) and 
pixel registration (cell corner)). And we can toggle between one and 
another either by just adjusting the grid limits or by re-interpolation.

When GMT reads grids via GDAL it only knows that what the latter tells 
it, but not the data's original info. A decision was made (mea culpa) 
that all rasters of char type (images) are treated in GMT as 'Area' 
(pixel) and the others (grids) as 'Point'. This allow as, for example, 
that a netcdf grid created and read by GMT internal code or via GDAL  
sow the same limits (most of times). It's a pity that the original 
registration type is not preserved in GDAL so we could respect it. But 
GeoTIffs when they use the AREA_OR_POINT key store that info, so in that 
case I try to respect it. So, answering to your question, that is what I 
am trying to do

> GDALMD_AREA_OR_POINT is a #define that evaluates to "AREA_OR_POINT". 
> The string "GDALMD_AREA_OR_POINT" however is nowhere used in GDAL.
>

So let me repeat one of my previous questions, why was this ignored?

     GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

> Regarding the MEM driver, GDALMD_AREA_OR_POINT is just a random 
> metadata item.
>
> Some drivers will set GDALMD_AREA_OR_POINT to the GDALMD_AOP_POINT = 
> "Point" value.
>
> And the GTiff driver uses it to determine if it must apply a 
> half-pixel shift between the GDAL convention and the GeoTIFF convention.
>
> Even
>
> > Hi,
>
> >
>
> > I made GMT respect as far as possible the AREA_OR_POINT GeoTiff key
>
> > for read/write, but ...
>
> >
>
> > The following was silently ignored (GMT uses the MEM driver)
>
> >
>
> > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
>
> >
>
> > so digging here and there I found about GDALMD_AREA_OR_POINT, and in
>
> > fact this one is now taken into consideration
>
> >
>
> > GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);
>
> >
>
> >
>
> > However, this implies that on reading I have now to test for both
>
> >
>
> > GDALGetMetadataItem(hDataset, "AREA_OR_POINT", NULL)
>
> >
>
> > ---- AND ----
>
> >
>
> > GDALGetMetadataItem(hDataset, "GDALMD_AREA_OR_POINT", NULL)
>
> >
>
> > This means that other codes that pay attention to the AREA vs POINT
>
> > thing will have to do both tests as well and if they do only the first
>
> > one, GeoTiffs created by GDAL will have the problem ignored, and quite
>
> > likely an error in coordinates will follow.
>
> >
>
> > So the question is, why this name duplication (AREA_OR_POINT vs
>
> > GDALMD_AREA_OR_POINT) and why GDALSetMetadataItem() ignores the
>
> > AREA_OR_POINT key?
>
> >
>
> > Thanks
>
> > Joaquim
>
> >
>
> > ----------------------------------------------------------------
>
> > This message was sent using IMP, the Internet Messaging Program.
>
> >
>
> > _______________________________________________
>
> > gdal-dev mailing list
>
> > gdal-dev at lists.osgeo.org
>
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
>
> Geospatial professional services
>
> http://even.rouault.free.fr/services.html
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/93f3020b/attachment.html>

From jluis at ualg.pt  Thu May 29 12:31:05 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 20:31:05 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5387877C.3070705@ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<6175776.fk6az8a8hR@even-thinkpad-l530> <5387877C.3070705@ualg.pt>
Message-ID: <53878AF9.9000707@ualg.pt>


> It's a pity that the original registration type is not preserved in 
> GDAL so we could respect it.

Just to be clear. I meant the "original registration type information" 
(there are formats that don't even support the "Area" model). Not that 
GDAL should do differently that it does.

From even.rouault at mines-paris.org  Thu May 29 12:32:44 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 21:32:44 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5387877C.3070705@ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<6175776.fk6az8a8hR@even-thinkpad-l530> <5387877C.3070705@ualg.pt>
Message-ID: <5675912.M4rbJoosja@even-thinkpad-l530>

On Thursday 29 May 2014 20:16:12 Joaquim Luis wrote:
> On 29-05-2014 19:26, Even Rouault wrote:
> > Joaquim,
> > 
> > I'm confused by what you are actually trying to do.
> 
> OK Even, I'll try to explain better. As we all know here, GDAL reports
> all region limits as pixel corner coordinates (AREA_OR_POINT=Area for
> GeoTiffs). GMT on the other hand keeps track of the original
> registration (we call it grid or node registration (cell center) and
> pixel registration (cell corner)). And we can toggle between one and
> another either by just adjusting the grid limits or by re-interpolation.
> 
> When GMT reads grids via GDAL it only knows that what the latter tells
> it, but not the data's original info. A decision was made (mea culpa)
> that all rasters of char type (images) are treated in GMT as 'Area'
> (pixel) and the others (grids) as 'Point'. This allow as, for example,
> that a netcdf grid created and read by GMT internal code or via GDAL
> sow the same limits (most of times). It's a pity that the original
> registration type is not preserved in GDAL so we could respect it.

Is not preserved : through which operations ?

> But
> GeoTIffs when they use the AREA_OR_POINT key store that info, so in that
> case I try to respect it. So, answering to your question, that is what I
> am trying to do
> 
> So let me repeat one of my previous questions, why was this ignored?
> 
>      GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

What do you mean by "ignored" ? Self-contained reproducable use case please 
;-) I don't read in your mind.

$ python
Python 2.7.3 (default, Feb 27 2014, 19:58:35) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
ds =>>> ds = gdal.GetDriverByName('Mem').Create('', 1, 1)
>>> ds.SetMetadataItem('AREA_OR_POINT', 'Point')
0
>>> ds.GetMetadataItem('AREA_OR_POINT')
'Point'


> 
> > Regarding the MEM driver, GDALMD_AREA_OR_POINT is just a random
> > metadata item.
> > 
> > Some drivers will set GDALMD_AREA_OR_POINT to the GDALMD_AOP_POINT =
> > "Point" value.
> > 
> > And the GTiff driver uses it to determine if it must apply a
> > half-pixel shift between the GDAL convention and the GeoTIFF convention.
> > 
> > Even
> > 
> > > Hi,
> > > 
> > > 
> > > 
> > > I made GMT respect as far as possible the AREA_OR_POINT GeoTiff key
> > > 
> > > for read/write, but ...
> > > 
> > > 
> > > 
> > > The following was silently ignored (GMT uses the MEM driver)
> > > 
> > > 
> > > 
> > > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
> > > 
> > > 
> > > 
> > > so digging here and there I found about GDALMD_AREA_OR_POINT, and in
> > > 
> > > fact this one is now taken into consideration
> > > 
> > > 
> > > 
> > > GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);
> > > 
> > > 
> > > 
> > > 
> > > 
> > > However, this implies that on reading I have now to test for both
> > > 
> > > 
> > > 
> > > GDALGetMetadataItem(hDataset, "AREA_OR_POINT", NULL)
> > > 
> > > 
> > > 
> > > ---- AND ----
> > > 
> > > 
> > > 
> > > GDALGetMetadataItem(hDataset, "GDALMD_AREA_OR_POINT", NULL)
> > > 
> > > 
> > > 
> > > This means that other codes that pay attention to the AREA vs POINT
> > > 
> > > thing will have to do both tests as well and if they do only the first
> > > 
> > > one, GeoTiffs created by GDAL will have the problem ignored, and quite
> > > 
> > > likely an error in coordinates will follow.
> > > 
> > > 
> > > 
> > > So the question is, why this name duplication (AREA_OR_POINT vs
> > > 
> > > GDALMD_AREA_OR_POINT) and why GDALSetMetadataItem() ignores the
> > > 
> > > AREA_OR_POINT key?
> > > 
> > > 
> > > 
> > > Thanks
> > > 
> > > Joaquim
> > > 
> > > 
> > > 
> > > ----------------------------------------------------------------
> > > 
> > > This message was sent using IMP, the Internet Messaging Program.
> > > 
> > > 
> > > 
> > > _______________________________________________
> > > 
> > > gdal-dev mailing list
> > > 
> > > gdal-dev at lists.osgeo.org
> > > 
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > Geospatial professional services
> > 
> > http://even.rouault.free.fr/services.html
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/b584a4d1/attachment-0001.html>

From troll1602 at gmail.com  Thu May 29 12:41:17 2014
From: troll1602 at gmail.com (Ryan)
Date: Thu, 29 May 2014 12:41:17 -0700
Subject: [gdal-dev] Reading contents of Erdas Block File
Message-ID: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>

I have some imagery that has metadata stored in Erdas Block Files (.blk)
that I am having a hard time reading.

It likes the data is stored in an HFA Header, when viewing the file (cat or
less) it begins with "EHFA_HEADER_TAG".

However, there are no raster bands so using gdalinfo or GDALOpen errors out
with:
ERROR 1: Unable to open image_name_file.blk, it has zero usable bands.

Any ideas on reading this kind of file?

-Ryan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/2fd66d7c/attachment.html>

From jluis at ualg.pt  Thu May 29 12:58:36 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 20:58:36 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5675912.M4rbJoosja@even-thinkpad-l530>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<6175776.fk6az8a8hR@even-thinkpad-l530> <5387877C.3070705@ualg.pt>
	<5675912.M4rbJoosja@even-thinkpad-l530>
Message-ID: <5387916C.6020100@ualg.pt>


> It's a pity that the original
>
> > registration type is not preserved in GDAL so we could respect it.
>
> Is not preserved : through which operations ?
>

Through some form of metadata that would inform us that:
  "Although I'm reporting cell corner coordinates this file was 
originally using cell center" (example case: Golden Software, AKA Surfer 
format)

> > So let me repeat one of my previous questions, why was this ignored?
>
> >
>
> > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
>
> What do you mean by "ignored" ? Self-contained reproducable use case 
> please ;-) I don't read in your mind.
>

Sorry that you can't.

I can't refer to a 5 liner example so I'll have to show some printings. 
When I use

     GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);


----- From GMT convert from netCDF to GeoTiff -----

grdreformat smt.grd lixo_MD_Pt.tiff=gd:GTiFF

Now gdalinfo shows "GDALMD_AREA_OR_POINT=Point"


gdalinfo lixo_MD_Pt.tiff
Driver: GTiff/GeoTIFF
Files: lixo_MD_Pt.tiff
Size is 256, 256
Coordinate System is `'
Origin = (-128500.000000000000000,127500.000000000000000)
Pixel Size = (1000.000000000000000,-1000.000000000000000)
Metadata:
   GDALMD_AREA_OR_POINT=Point 
<================================================
Image Structure Metadata:
   COMPRESSION=DEFLATE
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -128500.000,  127500.000)
Lower Left  ( -128500.000, -128500.000)
Upper Right (  127500.000,  127500.000)
Lower Right (  127500.000, -128500.000)
Center      (    -500.000,    -500.000)
Band 1 Block=256x8 Type=Float32, ColorInterp=Gray
   Min=-5000.000 Max=-1249.000
   Minimum=-5000.000, Maximum=-1249.000, Mean=-4941.563, StdDev=395.981
   NoData Value=nan
   Metadata:
     STATISTICS_MAXIMUM=-1249
     STATISTICS_MEAN=-4941.5626603216
     STATISTICS_MINIMUM=-5000
     STATISTICS_STDDEV=395.98068901299

However, if I do instead

     GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

grdreformat smt.grd lixo_MD_Pt2.tiff=gd:GTiFF

Than gdalinfo shows nothing in what regards the AREA_OR_POINT metadata. 
This is what I was referring as "Ignored"

gdalinfo lixo_MD_Pt2.tiff
Driver: GTiff/GeoTIFF
Files: lixo_MD_Pt2.tiff
Size is 256, 256
Coordinate System is `'
Origin = (-128000.000000000000000,127000.000000000000000)
Pixel Size = (1000.000000000000000,-1000.000000000000000)
Image Structure Metadata:
   COMPRESSION=DEFLATE
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -128000.000,  127000.000)
Lower Left  ( -128000.000, -129000.000)
Upper Right (  128000.000,  127000.000)
Lower Right (  128000.000, -129000.000)
Center      (       0.000,   -1000.000)
Band 1 Block=256x8 Type=Float32, ColorInterp=Gray
   Min=-5000.000 Max=-1249.000
   Minimum=-5000.000, Maximum=-1249.000, Mean=-4941.563, StdDev=395.981
   NoData Value=nan
   Metadata:
     STATISTICS_MAXIMUM=-1249
     STATISTICS_MEAN=-4941.5626603216
     STATISTICS_MINIMUM=-5000
     STATISTICS_STDDEV=395.98068901299

> $ python
>
> Python 2.7.3 (default, Feb 27 2014, 19:58:35)
>
> [GCC 4.6.3] on linux2
>
> Type "help", "copyright", "credits" or "license" for more information.
>
> >>> from osgeo import gdal
>
> ds =>>> ds = gdal.GetDriverByName('Mem').Create('', 1, 1)
>
> >>> ds.SetMetadataItem('AREA_OR_POINT', 'Point')
>
> 0
>
> >>> ds.GetMetadataItem('AREA_OR_POINT')
>
> 'Point'
>
> >
>
> > > Regarding the MEM driver, GDALMD_AREA_OR_POINT is just a random
>
> > > metadata item.
>
> > >
>
> > > Some drivers will set GDALMD_AREA_OR_POINT to the GDALMD_AOP_POINT =
>
> > > "Point" value.
>
> > >
>
> > > And the GTiff driver uses it to determine if it must apply a
>
> > > half-pixel shift between the GDAL convention and the GeoTIFF 
> convention.
>
> > >
>
> > > Even
>
> > >
>
> > > > Hi,
>
> > > >
>
> > > >
>
> > > >
>
> > > > I made GMT respect as far as possible the AREA_OR_POINT GeoTiff key
>
> > > >
>
> > > > for read/write, but ...
>
> > > >
>
> > > >
>
> > > >
>
> > > > The following was silently ignored (GMT uses the MEM driver)
>
> > > >
>
> > > >
>
> > > >
>
> > > > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
>
> > > >
>
> > > >
>
> > > >
>
> > > > so digging here and there I found about GDALMD_AREA_OR_POINT, and in
>
> > > >
>
> > > > fact this one is now taken into consideration
>
> > > >
>
> > > >
>
> > > >
>
> > > > GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);
>
> > > >
>
> > > >
>
> > > >
>
> > > >
>
> > > >
>
> > > > However, this implies that on reading I have now to test for both
>
> > > >
>
> > > >
>
> > > >
>
> > > > GDALGetMetadataItem(hDataset, "AREA_OR_POINT", NULL)
>
> > > >
>
> > > >
>
> > > >
>
> > > > ---- AND ----
>
> > > >
>
> > > >
>
> > > >
>
> > > > GDALGetMetadataItem(hDataset, "GDALMD_AREA_OR_POINT", NULL)
>
> > > >
>
> > > >
>
> > > >
>
> > > > This means that other codes that pay attention to the AREA vs POINT
>
> > > >
>
> > > > thing will have to do both tests as well and if they do only the 
> first
>
> > > >
>
> > > > one, GeoTiffs created by GDAL will have the problem ignored, and 
> quite
>
> > > >
>
> > > > likely an error in coordinates will follow.
>
> > > >
>
> > > >
>
> > > >
>
> > > > So the question is, why this name duplication (AREA_OR_POINT vs
>
> > > >
>
> > > > GDALMD_AREA_OR_POINT) and why GDALSetMetadataItem() ignores the
>
> > > >
>
> > > > AREA_OR_POINT key?
>
> > > >
>
> > > >
>
> > > >
>
> > > > Thanks
>
> > > >
>
> > > > Joaquim
>
> > > >
>
> > > >
>
> > > >
>
> > > > ----------------------------------------------------------------
>
> > > >
>
> > > > This message was sent using IMP, the Internet Messaging Program.
>
> > > >
>
> > > >
>
> > > >
>
> > > > _______________________________________________
>
> > > >
>
> > > > gdal-dev mailing list
>
> > > >
>
> > > > gdal-dev at lists.osgeo.org
>
> > > >
>
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> > >
>
> > > Geospatial professional services
>
> > >
>
> > > http://even.rouault.free.fr/services.html
>
> -- 
>
> Geospatial professional services
>
> http://even.rouault.free.fr/services.html
>


From even.rouault at mines-paris.org  Thu May 29 13:14:20 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 22:14:20 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5387916C.6020100@ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<5675912.M4rbJoosja@even-thinkpad-l530> <5387916C.6020100@ualg.pt>
Message-ID: <5351094.fIf2VnKs8A@even-thinkpad-l530>

On Thursday 29 May 2014 20:58:36 Joaquim Luis wrote:
> > It's a pity that the original
> > 
> > > registration type is not preserved in GDAL so we could respect it.
> > 
> > Is not preserved : through which operations ?
> 
> Through some form of metadata that would inform us that:
>   "Although I'm reporting cell corner coordinates this file was
> originally using cell center" (example case: Golden Software, AKA Surfer
> format)

This is what GDALMD_AREA_OR_POINT is supposed to do, although I can imagine 
that not all drivers will set it even if they should.

> 
> > > So let me repeat one of my previous questions, why was this ignored?
> > > 
> > > 
> > > 
> > > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
> > 
> > What do you mean by "ignored" ? Self-contained reproducable use case
> > please ;-) I don't read in your mind.
> 
> Sorry that you can't.
> 
> I can't refer to a 5 liner example so I'll have to show some printings.
> When I use
> 
>      GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);

Don't do that !!! As I said before "GDALMD_AREA_OR_POINT" as no particular 
meaning within GDAL and is equivalent to a random metadata item. You could 
write as well "FOO".

"GDALMD_AREA_OR_POINT" != GDALMD_AREA_OR_POINT
but
GDALMD_AREA_OR_POINT = "AREA_OR_POINT"

> 
> 
> ----- From GMT convert from netCDF to GeoTiff -----
> 
> grdreformat smt.grd lixo_MD_Pt.tiff=gd:GTiFF
> 
> Now gdalinfo shows "GDALMD_AREA_OR_POINT=Point"
> 
> 
> gdalinfo lixo_MD_Pt.tiff
> Driver: GTiff/GeoTIFF
> Files: lixo_MD_Pt.tiff
> Size is 256, 256
> Coordinate System is `'
> Origin = (-128500.000000000000000,127500.000000000000000)
> Pixel Size = (1000.000000000000000,-1000.000000000000000)
> Metadata:
>    GDALMD_AREA_OR_POINT=Point
> <================================================
> Image Structure Metadata:
>    COMPRESSION=DEFLATE
>    INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( -128500.000,  127500.000)
> Lower Left  ( -128500.000, -128500.000)
> Upper Right (  127500.000,  127500.000)
> Lower Right (  127500.000, -128500.000)
> Center      (    -500.000,    -500.000)
> Band 1 Block=256x8 Type=Float32, ColorInterp=Gray
>    Min=-5000.000 Max=-1249.000
>    Minimum=-5000.000, Maximum=-1249.000, Mean=-4941.563, StdDev=395.981
>    NoData Value=nan
>    Metadata:
>      STATISTICS_MAXIMUM=-1249
>      STATISTICS_MEAN=-4941.5626603216
>      STATISTICS_MINIMUM=-5000
>      STATISTICS_STDDEV=395.98068901299
> 
> However, if I do instead
> 
>      GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

On which dataset do you this : a GTiff dataset ? Opened in update mode ?

See :

Original file is AREA_OR_Point = Area

$ gdalinfo byte.tif
Driver: GTiff/GeoTIFF
Files: byte.tif
Size is 20, 20
Coordinate System is:
PROJCS["NAD27 / UTM zone 11N",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26711"]]
Origin = (440720.000000000000000,3751320.000000000000000)
Pixel Size = (60.000000000000000,-60.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
Band 1 Block=20x20 Type=Byte, ColorInterp=Gray

# Open it in update mode and set Point

even at even-ThinkPad-L530:~/trunk/gdal$ python
Python 2.7.3 (default, Feb 27 2014, 19:58:35) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
>>> ds = gdal.Open('byte.tif', gdal.GA_Update)
>>> ds.SetMetadataItem('AREA_OR_POINT', 'Point')
0
>>> ds = None
>>> 

# This is 'Point' now

even at even-ThinkPad-L530:~/trunk/gdal$ gdalinfo byte.tif
Driver: GTiff/GeoTIFF
Files: byte.tif
Size is 20, 20
Coordinate System is:
PROJCS["NAD27 / UTM zone 11N",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-117],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26711"]]
Origin = (440720.000000000000000,3751320.000000000000000)
Pixel Size = (60.000000000000000,-60.000000000000000)
Metadata:
  AREA_OR_POINT=Point
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54' 8.47"N)
Lower Left  (  440720.000, 3750120.000) (117d38'27.92"W, 33d53'29.51"N)
Upper Right (  441920.000, 3751320.000) (117d37'41.48"W, 33d54' 8.71"N)
Lower Right (  441920.000, 3750120.000) (117d37'41.20"W, 33d53'29.75"N)
Center      (  441320.000, 3750720.000) (117d38' 4.70"W, 33d53'49.11"N)
Band 1 Block=20x20 Type=Byte, ColorInterp=Gray


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/3466629f/attachment-0001.html>

From jluis at ualg.pt  Thu May 29 13:50:32 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 21:50:32 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5351094.fIf2VnKs8A@even-thinkpad-l530>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<5675912.M4rbJoosja@even-thinkpad-l530> <5387916C.6020100@ualg.pt>
	<5351094.fIf2VnKs8A@even-thinkpad-l530>
Message-ID: <53879D98.7000803@ualg.pt>


> This is what GDALMD_AREA_OR_POINT is supposed to do, although I can 
> imagine that not all drivers will set it even if they should.
>

Ah, good news.


> > GDALSetMetadataItem(hDstDS, "GDALMD_AREA_OR_POINT", "Point", NULL);
>
> Don't do that !!! As I said before "GDALMD_AREA_OR_POINT" as no 
> particular meaning within GDAL and is equivalent to a random metadata 
> item. You could write as well "FOO".
>
> "GDALMD_AREA_OR_POINT" != GDALMD_AREA_OR_POINT
>
> but
>
> GDALMD_AREA_OR_POINT = "AREA_OR_POINT"
>


Glad to not do, but than I'm left with nothing. If I do instead as you say

     GDALSetMetadataItem(hDstDS, GDALMD_AREA_OR_POINT, "Point", NULL);

which than equivalent to

     GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);

than, as I showed before and contrary to your python examples, the 
GDALSetMetadataItem() is not working in our code.


> On which dataset do you this : a GTiff dataset ? Opened in update mode ?
>

No, not update mode. It's dataset filled an empty MEM. See (lines #167 
and after)

http://gmtrac.soest.hawaii.edu/projects/gmt/repository/entry/branches/5.2.0/src/gmt_gdalwrite.c



From even.rouault at mines-paris.org  Thu May 29 14:08:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 23:08:46 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <53879D98.7000803@ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<5351094.fIf2VnKs8A@even-thinkpad-l530> <53879D98.7000803@ualg.pt>
Message-ID: <1676571.y1rOAcFv1E@even-thinkpad-l530>

> 
> Glad to not do, but than I'm left with nothing. If I do instead as you say
> 
>      GDALSetMetadataItem(hDstDS, GDALMD_AREA_OR_POINT, "Point", NULL);
> 
> which than equivalent to
> 
>      GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
> 
> than, as I showed before and contrary to your python examples, the
> GDALSetMetadataItem() is not working in our code.
> 
> > On which dataset do you this : a GTiff dataset ? Opened in update mode ?
> 
> No, not update mode. It's dataset filled an empty MEM. See (lines #167
> and after)
> 
> http://gmtrac.soest.hawaii.edu/projects/gmt/repository/entry/branches/5.2.0/
> src/gmt_gdalwrite.c

Well, I suppose that your local copy of the code use GDALMD_ARE_OR_POINT 
unquoted...

I've tried a simplified version of your code and it works for me. Do you use a 
recent enough version of GDAL ?

from osgeo import gdal
from osgeo import osr
mem_ds = gdal.GetDriverByName('Mem').Create('mem', 1, 1)
mem_ds.SetGeoTransform([10,1,0,100,0,-1])
sr = osr.SpatialReference()
sr.ImportFromEPSG(32631)
mem_ds.SetProjection(sr.ExportToWkt())
mem_ds.SetMetadataItem('AREA_OR_POINT', 'Point')
gtiff_ds = gdal.GetDriverByName('GTiff').CreateCopy('out.tif', mem_ds)
gtiff_ds = None

Note: for AREA_OR_POINT to be taken into account in GeoTiff, you need to define 
both a geotransform and a SRS.

$ gdalinfo out.tif
Driver: GTiff/GeoTIFF
Files: out.tif
Size is 1, 1
Coordinate System is:
PROJCS["WGS 84 / UTM zone 31N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",3],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32631"]]
Origin = (10.000000000000000,100.000000000000000)
Pixel Size = (1.000000000000000,-1.000000000000000)
Metadata:
  AREA_OR_POINT=Point
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (      10.000,     100.000) (  1d29'19.16"W,  0d 0' 3.25"N)
Lower Left  (      10.000,      99.000) (  1d29'19.16"W,  0d 0' 3.21"N)
Upper Right (      11.000,     100.000) (  1d29'19.12"W,  0d 0' 3.25"N)
Lower Right (      11.000,      99.000) (  1d29'19.12"W,  0d 0' 3.21"N)
Center      (      10.500,      99.500) (  1d29'19.14"W,  0d 0' 3.23"N)
Band 1 Block=1x1 Type=Byte, ColorInterp=Gray


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/378cd8bb/attachment.html>

From jluis at ualg.pt  Thu May 29 14:48:04 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 22:48:04 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <1676571.y1rOAcFv1E@even-thinkpad-l530>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<5351094.fIf2VnKs8A@even-thinkpad-l530> <53879D98.7000803@ualg.pt>
	<1676571.y1rOAcFv1E@even-thinkpad-l530>
Message-ID: <5387AB14.40503@ualg.pt>

On 29-05-2014 22:08, Even Rouault wrote:
>
> >
>
> > Glad to not do, but than I'm left with nothing. If I do instead as 
> you say
>
> >
>
> > GDALSetMetadataItem(hDstDS, GDALMD_AREA_OR_POINT, "Point", NULL);
>
> >
>
> > which than equivalent to
>
> >
>
> > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
>
> >
>
> > than, as I showed before and contrary to your python examples, the
>
> > GDALSetMetadataItem() is not working in our code.
>
> >
>
> > > On which dataset do you this : a GTiff dataset ? Opened in update 
> mode ?
>
> >
>
> > No, not update mode. It's dataset filled an empty MEM. See (lines #167
>
> > and after)
>
> >
>
> > 
> http://gmtrac.soest.hawaii.edu/projects/gmt/repository/entry/branches/5.2.0/
>
> > src/gmt_gdalwrite.c
>

> Well, I suppose that your local copy of the code use 
> GDALMD_ARE_OR_POINT unquoted...
>

as mentioned before, with and without.

> I've tried a simplified version of your code and it works for me. Do 
> you use a recent enough version of GDAL ?
>

Yes. A svn revision after 1.11.


> Note: for AREA_OR_POINT to be taken into account in GeoTiff, you need 
> to define both a geotransform and a SRS.
>

AHHHHHH. This changes the whole story. Some cases do not set a SRS. Is 
there any fall-back SRS that I could use when no info is available to 
create one?
Type, 'linear in unknown units'?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/752922e1/attachment-0001.html>

From even.rouault at mines-paris.org  Thu May 29 14:50:51 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 29 May 2014 23:50:51 +0200
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <5387AB14.40503@ualg.pt>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<1676571.y1rOAcFv1E@even-thinkpad-l530> <5387AB14.40503@ualg.pt>
Message-ID: <3095859.4dYrNBSgbW@even-thinkpad-l530>

On Thursday 29 May 2014 22:48:04 Joaquim Luis wrote:
> On 29-05-2014 22:08, Even Rouault wrote:
> > > Glad to not do, but than I'm left with nothing. If I do instead as
> > 
> > you say
> > 
> > > GDALSetMetadataItem(hDstDS, GDALMD_AREA_OR_POINT, "Point", NULL);
> > > 
> > > 
> > > 
> > > which than equivalent to
> > > 
> > > 
> > > 
> > > GDALSetMetadataItem(hDstDS, "AREA_OR_POINT", "Point", NULL);
> > > 
> > > 
> > > 
> > > than, as I showed before and contrary to your python examples, the
> > > 
> > > GDALSetMetadataItem() is not working in our code.
> > > 
> > > > On which dataset do you this : a GTiff dataset ? Opened in update
> > 
> > mode ?
> > 
> > > No, not update mode. It's dataset filled an empty MEM. See (lines #167
> > > 
> > > and after)
> > 
> > http://gmtrac.soest.hawaii.edu/projects/gmt/repository/entry/branches/5.2.
> > 0/> 
> > > src/gmt_gdalwrite.c
> > 
> > Well, I suppose that your local copy of the code use
> > GDALMD_ARE_OR_POINT unquoted...
> 
> as mentioned before, with and without.
> 
> > I've tried a simplified version of your code and it works for me. Do
> > you use a recent enough version of GDAL ?
> 
> Yes. A svn revision after 1.11.
> 
> > Note: for AREA_OR_POINT to be taken into account in GeoTiff, you need
> > to define both a geotransform and a SRS.
> 
> AHHHHHH. This changes the whole story. Some cases do not set a SRS. Is
> there any fall-back SRS that I could use when no info is available to
> create one?
> Type, 'linear in unknown units'?

I've successfully tried with :

mem_ds.SetProjection('LOCAL_CS["Unknown"]')

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/f021e183/attachment.html>

From jluis at ualg.pt  Thu May 29 14:58:29 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 29 May 2014 22:58:29 +0100
Subject: [gdal-dev] AREA_OR_POINT vs GDALMD_AREA_OR_POINT
In-Reply-To: <3095859.4dYrNBSgbW@even-thinkpad-l530>
References: <20140529185842.20217ix2qtju6kkk@wmail.ualg.pt>
	<1676571.y1rOAcFv1E@even-thinkpad-l530> <5387AB14.40503@ualg.pt>
	<3095859.4dYrNBSgbW@even-thinkpad-l530>
Message-ID: <5387AD85.2050508@ualg.pt>


> > AHHHHHH. This changes the whole story. Some cases do not set a SRS. Is
>
> > there any fall-back SRS that I could use when no info is available to
>
> > create one?
>
> > Type, 'linear in unknown units'?
>
> I've successfully tried with :
>
> mem_ds.SetProjection('LOCAL_CS["Unknown"]')
>
>

Thanks a lot. I'll work on it.

From even.rouault at mines-paris.org  Thu May 29 15:24:30 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 30 May 2014 00:24:30 +0200
Subject: [gdal-dev] Reading contents of Erdas Block File
In-Reply-To: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>
References: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>
Message-ID: <2326311.R2eHnoToIa@even-thinkpad-l530>

On Thursday 29 May 2014 12:41:17 Ryan wrote:
> I have some imagery that has metadata stored in Erdas Block Files (.blk)
> that I am having a hard time reading.
> 
> It likes the data is stored in an HFA Header, when viewing the file (cat or
> less) it begins with "EHFA_HEADER_TAG".
> 
> However, there are no raster bands so using gdalinfo or GDALOpen errors out
> with:
> ERROR 1: Unable to open image_name_file.blk, it has zero usable bands.

Did you try opening the main file, the .img ?

> 
> Any ideas on reading this kind of file?
> 
> -Ryan
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140530/c524e0d9/attachment.html>

From troll1602 at gmail.com  Thu May 29 16:42:35 2014
From: troll1602 at gmail.com (Ryan)
Date: Thu, 29 May 2014 16:42:35 -0700
Subject: [gdal-dev] Reading contents of Erdas Block File
In-Reply-To: <2326311.R2eHnoToIa@even-thinkpad-l530>
References: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>
	<2326311.R2eHnoToIa@even-thinkpad-l530>
Message-ID: <CACo4qxCEHduBHBv3FdW4xUr+GqDro60Swv9aRQRois5jGYFprw@mail.gmail.com>

There is a set of images (a handful of .img) and only one block file. I can
open any of the images but that doesn't seem to access the metadata that's
stored on the block file.

-Ryan


On Thu, May 29, 2014 at 3:24 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

>  On Thursday 29 May 2014 12:41:17 Ryan wrote:
>
> > I have some imagery that has metadata stored in Erdas Block Files (.blk)
>
> > that I am having a hard time reading.
>
> >
>
> > It likes the data is stored in an HFA Header, when viewing the file (cat
> or
>
> > less) it begins with "EHFA_HEADER_TAG".
>
> >
>
> > However, there are no raster bands so using gdalinfo or GDALOpen errors
> out
>
> > with:
>
> > ERROR 1: Unable to open image_name_file.blk, it has zero usable bands.
>
>
>
> Did you try opening the main file, the .img ?
>
>
>
> >
>
> > Any ideas on reading this kind of file?
>
> >
>
> > -Ryan
>
> --
>
> Geospatial professional services
>
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140529/6f965861/attachment.html>

From even.rouault at mines-paris.org  Fri May 30 00:51:40 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 30 May 2014 09:51:40 +0200
Subject: [gdal-dev] Reading contents of Erdas Block File
In-Reply-To: <CACo4qxCEHduBHBv3FdW4xUr+GqDro60Swv9aRQRois5jGYFprw@mail.gmail.com>
References: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>
	<2326311.R2eHnoToIa@even-thinkpad-l530>
	<CACo4qxCEHduBHBv3FdW4xUr+GqDro60Swv9aRQRois5jGYFprw@mail.gmail.com>
Message-ID: <1765073.IFJndEhmdS@even-thinkpad-l530>

On Thursday 29 May 2014 16:42:35 Ryan wrote:
> There is a set of images (a handful of .img) and only one block file. I can
> open any of the images but that doesn't seem to access the metadata that's
> stored on the block file.

Access to the .blk and one of the .img could be useful for investigation.

> 
> -Ryan
> 
> 
> On Thu, May 29, 2014 at 3:24 PM, Even Rouault <even.rouault at mines-paris.org>
> wrote:
> >  On Thursday 29 May 2014 12:41:17 Ryan wrote:
> > > I have some imagery that has metadata stored in Erdas Block Files (.blk)
> > > 
> > > that I am having a hard time reading.
> > > 
> > > 
> > > 
> > > It likes the data is stored in an HFA Header, when viewing the file (cat
> > 
> > or
> > 
> > > less) it begins with "EHFA_HEADER_TAG".
> > > 
> > > 
> > > 
> > > However, there are no raster bands so using gdalinfo or GDALOpen errors
> > 
> > out
> > 
> > > with:
> > > 
> > > ERROR 1: Unable to open image_name_file.blk, it has zero usable bands.
> > 
> > Did you try opening the main file, the .img ?
> > 
> > > Any ideas on reading this kind of file?
> > > 
> > > 
> > > 
> > > -Ryan
> > 
> > --
> > 
> > Geospatial professional services
> > 
> > http://even.rouault.free.fr/services.html
-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140530/63658834/attachment-0001.html>

From gusevmihs at gmail.com  Fri May 30 09:14:06 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Fri, 30 May 2014 20:14:06 +0400
Subject: [gdal-dev] GSoC weekly report 2. GDAL Networking
Message-ID: <CAJB43VpA8iAd0c8nn5RXVkKhKBxgJDcdmH+tFSgJBMm9qZ0iEg@mail.gmail.com>

Hello everyone!

During this week I worked on the concept of networking GDAL API. After
several days developing and discussions with mentors I came up with this
solution:
http://gsoc2014gnm.blogspot.ru/2014/05/new-gdal-networking-api.html.
Exploring of new GDAL 2.0 structure took to me an additional time. The next
week I plan to continue implementing this API, basing on trunk 2.0.
Building GDAL from source is also in the scope for the next week.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140530/66de1d80/attachment.html>

From danieltesta at suremptec.com.ar  Fri May 30 13:27:32 2014
From: danieltesta at suremptec.com.ar (Daniel Testa)
Date: Fri, 30 May 2014 17:27:32 -0300
Subject: [gdal-dev] new landsat-8 metadata format
In-Reply-To: <CAHy2iFcGj3a78JQ3Wo9E-+D-x4xWvOVVTxPQ+ZnBq6rK2SmvMA@mail.gmail.com>
References: <CAHy2iFebO09R5s7VNr5yQH6pMY=jKcJ1qKgcYq4tCv1oqM9pmQ@mail.gmail.com>
	<201405161956.04718.even.rouault@mines-paris.org>
	<CAHy2iFd1q-QV_vKj-nzwFvaZG8c_jfzT6Mkta7h+C8RfjdeXZg@mail.gmail.com>
	<201405162311.39686.even.rouault@mines-paris.org>
	<CAHy2iFcGj3a78JQ3Wo9E-+D-x4xWvOVVTxPQ+ZnBq6rK2SmvMA@mail.gmail.com>
Message-ID: <CAHy2iFfjcWczUkOXWBgkr-hicrV+CbgEU-S5t56aD9nGuSPX5g@mail.gmail.com>

Hi, I created a new ticket (http://trac.osgeo.org/gdal/ticket/5501) with a
patch that adds support for the new landsat-8 metadata format.

I've followed the path of HDF5 as Even suggested.

Any idea, suggestion or comment is always very welcome :)

Thanks.

Best regards,
Daniel.


On Sat, May 17, 2014 at 11:06 AM, Daniel Testa <danieltesta at suremptec.com.ar
> wrote:

> > You could have the dataset report subdataset names, like
> > "LANDSAT8:LC82300942013289LGN00_MTL.txt:panchromatic",
> > "LANDSAT8:LC82300942013289LGN00_MTL.txt:multispectral", etc... And when
> those
> > names are passed to the Open() methods would return a dataset that would
> point
> > to the relevant tif.
>
> I see what you mean. I'll try following that path and let you know how it
> goes.
>
> Thanks Even.
>
> Best regards,
> Daniel.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140530/b977bbf8/attachment.html>

From varunsaraf14 at gmail.com  Sat May 31 07:54:19 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Sat, 31 May 2014 20:24:19 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 2 : Implement write support for
 GDAL PostGIS Raster driver for GDAL
Message-ID: <CAPfr+rtzaBHourcQjnHf8tY_3tEeDwXWCEih=Jbhj1-tTz=-fg@mail.gmail.com>

Hi,

Below is my second weekly report:

*What did I do this week?*

   - Learnt more about the different sets of API in GDAL : Create(),
   CreateCopy() and IRasterIO().
   - Tried to map different variables/functions in raster2pgsql to the ones
   in GDAL PostGISRaster driver.

*What do I plan on doing next week?*

   - Create the sql query which will write data to the PostgreSQL tables.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-2
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140531/4f688c92/attachment.html>

From klonuo at gmail.com  Sat May 31 15:45:06 2014
From: klonuo at gmail.com (klo uo)
Date: Sun, 1 Jun 2014 00:45:06 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
 PDF] with the following drivers
In-Reply-To: <CAA-8Ld_oPkDEDgMfXAEvNUp2+iyWcThu6Jf7JeNP_2TZXkkx6A@mail.gmail.com>
References: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
	<201405282227.33502.even.rouault@mines-paris.org>
	<CAA-8Ld_t1gK78fy6qgMP6PADQpDhsugvfQPG6EyMQmoUYn7x+A@mail.gmail.com>
	<201405282334.35482.even.rouault@mines-paris.org>
	<CAA-8Ld_oPkDEDgMfXAEvNUp2+iyWcThu6Jf7JeNP_2TZXkkx6A@mail.gmail.com>
Message-ID: <CAA-8Ld-zHBMkNDXFjXDFoDy1KtkDAwYv4ahuJ93=i5CZs+oZ1w@mail.gmail.com>

Hi,

it turned out afterall that DXF is not such a great choice in my case.
`pstoedit` is best tool for rapid conversion, but it does not respect
polygons present in initial PDF files, but it just samples polygons to very
small lines which is such bad outcome.

Evan, or anybody else, can you please link me to SVG DTD that ogr2ogr would
understand?
The link provided here: http://www.gdal.org/drv_svg.html is dead, and on
their (cloudmade) web portal I can find any information about their custom
SVG format.

I also assume there is no tool that can make initial PDF valid for ogr2ogr.


Thanks,
Klo



On Thu, May 29, 2014 at 12:24 AM, klo uo <klonuo at gmail.com> wrote:

> Ok, thanks for your confirmation.
>
> I'll go DXF route.
> In the meantime I found that by using pstoedit for conversion from PDF to
> DXF is the right choice.
>
>
>
> On Wed, May 28, 2014 at 11:34 PM, Even Rouault <
> even.rouault at mines-paris.org> wrote:
>
>> Le mercredi 28 mai 2014 23:06:38, vous avez ?crit :
>> > Hi Even,
>> >
>> > thanks for your prompt reply.
>> >
>> > Could you please tell more about the PDF limitation. For example a way
>> to
>> > transform my PDF to the one that ogr2ogr would understand?
>> >
>> > I attached the test files.
>>
>> The PDF driver would require some enhancements to support that kind of
>> file.
>> Basically it currently only supports files that have a layered
>> organization,
>> whereas yours is "flat". From a quick analysis, I'd say it would require
>> modest
>> effort to support that file.
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140601/2f9c8e40/attachment.html>

