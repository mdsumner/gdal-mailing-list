From even.rouault at spatialys.com  Sat Feb  1 04:21:39 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 01 Feb 2020 13:21:39 +0100
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
Message-ID: <2958350.DYHqErPMC2@even-i700>

Chris,

There are 2 issues with this netCDF file:
- the lon,lat indexing is done in a transposed way w.r.t the netCDF 
conventions. That is in this file the fastest varying dimension is the 
latitude, instead of longitude
- the spacing of the lat variable is not constant

I've a somewhat complicated workflow to propose to create a georeferenced 
GeoTIFF file. It assumes you are running GDAL master 3.1.0dev to be able to 
use the gdalmdimtranslate utility

1) Create a tiled geotiff

gdal_translate NETCDF:"SD_20160901.nc":snd_upd out.tif -co TILED=YES

2) Transpose it, and also mirror the values in the x and y directions. I'm not 
sure why this mirroring is needed at all (at least the one in the horizontal 
direction. The one in the version direction might perhaps be explained by a 
north-up vs south-up convention difference between netCDF and GeoTIFF)

gdalmdimtranslate out.tif out2.tif -co TILED=YES \
    -array band=1,transpose=[1,0],view=[::-1,::-1]

(in theory 1. and 2. could be merged in a single step, but doing the 
transposition on the initial netCDF file will be very inefficient. Doing it on 
a source tiled file is the best)

3) Create a out2.tif.aux.xml file with the following content

<PAMDataset>
  <Metadata domain="GEOLOCATION">
    <MDI key="LINE_OFFSET">0</MDI>
    <MDI key="LINE_STEP">1</MDI>
    <MDI key="PIXEL_OFFSET">0</MDI>
    <MDI key="PIXEL_STEP">1</MDI>
    <MDI key="SRS">EPSG:4326</MDI>
    <MDI key="X_BAND">1</MDI>
    <MDI key="X_DATASET">NETCDF:"SD_20160901.nc":lon</MDI>
    <MDI key="Y_BAND">1</MDI>
    <MDI key="Y_DATASET">NETCDF:"SD_20160901.nc":lat</MDI>
  </Metadata>
</PAMDataset>

4) Warp it:

gdalwarp out2.tif out3.tif -overwrite -co TILED=YES

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Feb  1 06:01:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 01 Feb 2020 15:01:07 +0100
Subject: [gdal-dev] Python Wheels for gdal
In-Reply-To: <CADPhZXx5+tPznCqLOnTkJv1Nx8tMT9H=n+4dEs3BCUTX+bwGkg@mail.gmail.com>
References: <CAHtCBniKAStXMsA8gg=QoyYeGRdgT19_QGrCpDS2RwhNaGRX6Q@mail.gmail.com>
 <2004643.y9WdgZ42uR@even-i700>
 <CADPhZXx5+tPznCqLOnTkJv1Nx8tMT9H=n+4dEs3BCUTX+bwGkg@mail.gmail.com>
Message-ID: <5814936.ysQ6HM8itc@even-i700>

> There are existing tools. Multibuild uses
> https://github.com/pypa/auditwheel. It says in the project README that the
> result is "like static linking"

>From what I understood, this is far from being static linking. It just plays 
with the RPATH to make sure that the .so from the wheel .libs directory are 
loaded instead of other from the system paths. But if within the same process, 
you have symbols with same name coming from different .so (like libhdf5 coming 
from rasterio wheel and another one coming from h5py), then game over.

Playing with my idea of symbol renaming, I've discovered this jewel:
https://github.com/lief-project/LIEF
It has a super simple Python API to manipulate ELF, PE and Mach-O objects. I 
gave it a try with Linux ELF and rasterio wheels

Small python script and instructions at:
https://gist.github.com/rouault/5e92eb046b7c451b8b0071e9d765c9de

The result is a patched rasterio wheel where .so files in rasterio/.libs/ have 
all their exported symbols prefixed with _rasterio_whl_  and the rasterio/*.so 
files are modified to import those _rasterio_whl_ symbols. So we have in 
theory full symbol isolation. The resulting rasterio seems to be functional 
(at least rasterio.open() works), although I didn't have an initial situation 
where I could make it crash when loading gdal python bindings or h5py. Would 
be cool if someone that has a crashing setup could confirm that this actually 
fixes it.

But... there is a downside preventing this to be used in production. lief has 
a bug / inefficency: the symbol renaming creates .so larger than expected. In 
particular, with the netcdf lib that jumps from 1.9 MB to 52 MB !
Reported as https://github.com/lief-project/LIEF/issues/379

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From markus.metz.giswork at gmail.com  Sat Feb  1 13:51:57 2020
From: markus.metz.giswork at gmail.com (Markus Metz)
Date: Sat, 1 Feb 2020 22:51:57 +0100
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <2958350.DYHqErPMC2@even-i700>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <2958350.DYHqErPMC2@even-i700>
Message-ID: <CAG+h=FH=eG9ErZ93xPv=HpjnqC-=yUrxdKGnr22OiEwbvvZa0g@mail.gmail.com>

Regarding this EASE-2 grid (https://nsidc.org/ease/ease-grid-projection-gt),
I found that

On Sat, Feb 1, 2020 at 1:22 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> - the spacing of the lat variable is not constant

the spacing of the lat variable increases drastically towards the poles.

You could convert the netcdf file to xyz text format, then treat it as
vector points and interpolate a grid surface from these points with
appropriate parameters. This should preserve the original values at the
original xy locations and should take care of the increasing spacing of the
lat variable towards the poles. Regarding your use case of snow depth, a
land mask could speed up the interpolation step, skipping oceans.

>
> I've a somewhat complicated workflow to propose to create a georeferenced
> GeoTIFF file. It assumes you are running GDAL master 3.1.0dev to be able
to
> use the gdalmdimtranslate utility
>
> 1) Create a tiled geotiff
>
> gdal_translate NETCDF:"SD_20160901.nc":snd_upd out.tif -co TILED=YES
>
> 2) Transpose it, and also mirror the values in the x and y directions.
I'm not
> sure why this mirroring is needed at all (at least the one in the
horizontal
> direction. The one in the version direction might perhaps be explained by
a
> north-up vs south-up convention difference between netCDF and GeoTIFF)
>
> gdalmdimtranslate out.tif out2.tif -co TILED=YES \
>     -array band=1,transpose=[1,0],view=[::-1,::-1]
>
> (in theory 1. and 2. could be merged in a single step, but doing the
> transposition on the initial netCDF file will be very inefficient. Doing
it on
> a source tiled file is the best)
>
> 3) Create a out2.tif.aux.xml file with the following content
>
> <PAMDataset>
>   <Metadata domain="GEOLOCATION">
>     <MDI key="LINE_OFFSET">0</MDI>
>     <MDI key="LINE_STEP">1</MDI>
>     <MDI key="PIXEL_OFFSET">0</MDI>
>     <MDI key="PIXEL_STEP">1</MDI>
>     <MDI key="SRS">EPSG:4326</MDI>
>     <MDI key="X_BAND">1</MDI>
>     <MDI key="X_DATASET">NETCDF:"SD_20160901.nc":lon</MDI>
>     <MDI key="Y_BAND">1</MDI>
>     <MDI key="Y_DATASET">NETCDF:"SD_20160901.nc":lat</MDI>
>   </Metadata>
> </PAMDataset>
>
> 4) Warp it:
>
> gdalwarp out2.tif out3.tif -overwrite -co TILED=YES
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200201/d71148bc/attachment.html>

From chris.marsh at usask.ca  Sat Feb  1 16:34:46 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Sun, 2 Feb 2020 00:34:46 +0000
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <2958350.DYHqErPMC2@even-i700>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <2958350.DYHqErPMC2@even-i700>
Message-ID: <CAFgDerHf_haaa5cYwaO0O+UdB67=9KbL6edsCPx0xC3s=q7axw@mail.gmail.com>

HI Even,

Thanks for the detailed response. I have compiled master 3.1dev however strangest thing when I try to run it

$ export PATH=`pwd`/gdal-install/bin:$PATH
$ which gdal_translate
/Users/chris/Documents/science/analysis/gdal-install/bin/gdal_translate
 $ gdal_translate NETCDF:"`pwd`/SD_20160901.nc":snd_upd out.tif -co TILED=YES
ERROR 4: NETCDF:/Users/chris/Documents/science/analysis/SD_20160901.nc:snd_upd: No such file or directory
$ ls /Users/chris/Documents/science/analysis/SD_20160901.nc
/Users/chris/Documents/science/analysis/SD_20160901.nc

If I try to use my homebrew installed gdal_translate it works.

I've also tried without the `pwd` but that doesn't work either. This seems like a stupid PEBKAC but I'm out of ideas.

Trying the 2nd command resulted in

$ /gdal-install/bin/gdalmdimtranslate out.tif out2.tif -co TILED=YES -array band=1,transpose=[1,0],view=[::-1,::-1]
zsh: no matches found: band=1,transpose=[1,0],view=[::-1,::-1]

Cheers
Chris


Chris Marsh, PhD
University of Saskatchewan
chrismarsh.ca<http://chrismarsh.ca/>



On Sat, Feb 1, 2020 at 6:21 AM Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>


Chris,

There are 2 issues with this netCDF file:
- the lon,lat indexing is done in a transposed way w.r.t the netCDF
conventions. That is in this file the fastest varying dimension is the
latitude, instead of longitude
- the spacing of the lat variable is not constant

I've a somewhat complicated workflow to propose to create a georeferenced
GeoTIFF file. It assumes you are running GDAL master 3.1.0dev to be able to
use the gdalmdimtranslate utility

1) Create a tiled geotiff

gdal_translate NETCDF:"SD_20160901.nc":snd_upd out.tif -co TILED=YES

2) Transpose it, and also mirror the values in the x and y directions. I'm not
sure why this mirroring is needed at all (at least the one in the horizontal
direction. The one in the version direction might perhaps be explained by a
north-up vs south-up convention difference between netCDF and GeoTIFF)

gdalmdimtranslate out.tif out2.tif -co TILED=YES \
    -array band=1,transpose=[1,0],view=[::-1,::-1]

(in theory 1. and 2. could be merged in a single step, but doing the
transposition on the initial netCDF file will be very inefficient. Doing it on
a source tiled file is the best)

3) Create a out2.tif.aux.xml file with the following content

<PAMDataset>
  <Metadata domain="GEOLOCATION">
    <MDI key="LINE_OFFSET">0</MDI>
    <MDI key="LINE_STEP">1</MDI>
    <MDI key="PIXEL_OFFSET">0</MDI>
    <MDI key="PIXEL_STEP">1</MDI>
    <MDI key="SRS">EPSG:4326</MDI>
    <MDI key="X_BAND">1</MDI>
    <MDI key="X_DATASET">NETCDF:"SD_20160901.nc<http://20160901.nc>":lon</MDI>
    <MDI key="Y_BAND">1</MDI>
    <MDI key="Y_DATASET">NETCDF:"SD_20160901.nc<http://20160901.nc>":lat</MDI>
  </Metadata>
</PAMDataset>

4) Warp it:

gdalwarp out2.tif out3.tif -overwrite -co TILED=YES

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200202/363b8334/attachment.html>

From chris.marsh at usask.ca  Sat Feb  1 16:37:04 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Sun, 2 Feb 2020 00:37:04 +0000
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <CAG+h=FH=eG9ErZ93xPv=HpjnqC-=yUrxdKGnr22OiEwbvvZa0g@mail.gmail.com>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <2958350.DYHqErPMC2@even-i700>
 <CAG+h=FH=eG9ErZ93xPv=HpjnqC-=yUrxdKGnr22OiEwbvvZa0g@mail.gmail.com>
Message-ID: <CAFgDerG01dQrZ6iPcSJUX-Txk0yRVwZfwdpgC0iKsv2yOXoKYA@mail.gmail.com>

Thanks this may be a good option 2 if I can't get even's solution to work. Seems straightforward, agreed on mask!

On Sat, Feb 1, 2020 at 15:52 Markus Metz <markus.metz.giswork at gmail.com<mailto:markus.metz.giswork at gmail.com>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>

Regarding this EASE-2 grid (https://nsidc.org/ease/ease-grid-projection-gt), I found that

On Sat, Feb 1, 2020 at 1:22 PM Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:

> - the spacing of the lat variable is not constant

the spacing of the lat variable increases drastically towards the poles.

You could convert the netcdf file to xyz text format, then treat it as vector points and interpolate a grid surface from these points with appropriate parameters. This should preserve the original values at the original xy locations and should take care of the increasing spacing of the lat variable towards the poles. Regarding your use case of snow depth, a land mask could speed up the interpolation step, skipping oceans.

>
> I've a somewhat complicated workflow to propose to create a georeferenced
> GeoTIFF file. It assumes you are running GDAL master 3.1.0dev to be able to
> use the gdalmdimtranslate utility
>
> 1) Create a tiled geotiff
>
> gdal_translate NETCDF:"SD_20160901.nc":snd_upd out.tif -co TILED=YES
>
> 2) Transpose it, and also mirror the values in the x and y directions. I'm not
> sure why this mirroring is needed at all (at least the one in the horizontal
> direction. The one in the version direction might perhaps be explained by a
> north-up vs south-up convention difference between netCDF and GeoTIFF)
>
> gdalmdimtranslate out.tif out2.tif -co TILED=YES \
>     -array band=1,transpose=[1,0],view=[::-1,::-1]
>
> (in theory 1. and 2. could be merged in a single step, but doing the
> transposition on the initial netCDF file will be very inefficient. Doing it on
> a source tiled file is the best)
>
> 3) Create a out2.tif.aux.xml file with the following content
>
> <PAMDataset>
>   <Metadata domain="GEOLOCATION">
>     <MDI key="LINE_OFFSET">0</MDI>
>     <MDI key="LINE_STEP">1</MDI>
>     <MDI key="PIXEL_OFFSET">0</MDI>
>     <MDI key="PIXEL_STEP">1</MDI>
>     <MDI key="SRS">EPSG:4326</MDI>
>     <MDI key="X_BAND">1</MDI>
>     <MDI key="X_DATASET">NETCDF:"SD_20160901.nc":lon</MDI>
>     <MDI key="Y_BAND">1</MDI>
>     <MDI key="Y_DATASET">NETCDF:"SD_20160901.nc":lat</MDI>
>   </Metadata>
> </PAMDataset>
>
> 4) Warp it:
>
> gdalwarp out2.tif out3.tif -overwrite -co TILED=YES
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
--
Chris Marsh, PhD
University of Saskatchewan
chrismarsh.ca<http://chrismarsh.ca/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200202/bd0cad18/attachment-0001.html>

From even.rouault at spatialys.com  Sun Feb  2 04:15:13 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 02 Feb 2020 13:15:13 +0100
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <CAFgDerHf_haaa5cYwaO0O+UdB67=9KbL6edsCPx0xC3s=q7axw@mail.gmail.com>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <2958350.DYHqErPMC2@even-i700>
 <CAFgDerHf_haaa5cYwaO0O+UdB67=9KbL6edsCPx0xC3s=q7axw@mail.gmail.com>
Message-ID: <7029125.2IMaufSPgf@even-i700>

On dimanche 2 février 2020 00:34:46 CET Marsh, Chris wrote:
> HI Even,
> 
> Thanks for the detailed response. I have compiled master 3.1dev however
> strangest thing when I try to run it
 
> $ export PATH=`pwd`/gdal-install/bin:$PATH
> $ which gdal_translate
> /Users/chris/Documents/science/analysis/gdal-install/bin/gdal_translate
>  $ gdal_translate NETCDF:"`pwd`/SD_20160901.nc":snd_upd out.tif -co
> TILED=YES
 ERROR 4:
> NETCDF:/Users/chris/Documents/science/analysis/SD_20160901.nc:snd_upd: No
> such file or directory

Do you have the netCDF driver included ? Check with
"gdalinfo --format netCDF". This file is also a netCDF 4 file, so you need to 
make sure you netCDF lib is built against HDF5.
You may use the "osgeo/gdal" Docker image.
See https://github.com/OSGeo/gdal/blob/master/gdal/docker/README.md

> $ ls
> /Users/chris/Documents/science/analysis/SD_20160901.nc
> /Users/chris/Documents/science/analysis/SD_20160901.nc
> 
> If I try to use my homebrew installed gdal_translate it works.
> 
> I've also tried without the `pwd` but that doesn't work either. This seems
> like a stupid PEBKAC but I'm out of ideas.
 
> Trying the 2nd command resulted in
> 
> $ /gdal-install/bin/gdalmdimtranslate out.tif out2.tif -co TILED=YES -array
> band=1,transpose=[1,0],view=[::-1,::-1]
 zsh: no matches found:

Ah, just trying with zsh, this is just a quoting issue. You need to surround 
the value of the array option with double quotes

... -array "band=1,transpose=[1,0],view=[::-1,::-1]"

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From michael.landry at hotmail.com  Sun Feb  2 06:12:07 2020
From: michael.landry at hotmail.com (=?utf-8?B?TWljaGHDq2wgTGFuZHJ5?=)
Date: Sun, 2 Feb 2020 14:12:07 +0000
Subject: [gdal-dev] Can't build GDAL 3.0.X to read GML format on Linux
	(Ubuntu 18.04)
Message-ID: <CH2PR04MB71096C5B1153B0C28F28EC118A010@CH2PR04MB7109.namprd04.prod.outlook.com>

Hi,


I have successfully built and tested GDAL 3.0.1 and 3.0.4 with the SWIG java bindings and everything works fine except that I can't read GML format files. When I call the java method ogr.open( .. ), it always returns null. I investigated and i found out that I cannot open GML files with the ogrinfo app either. It seems the problem is on the native side and not on the bindings side. Here is the output of the command ogrinfo --formats for the app.


[cid:2fd2948e-3523-4798-a6b1-c35c2e941e0b]


I am using a configure script to build my makefiles. I read online at https://gdal.org/drivers/vector/gml.html​ that XERCES or EXPAT is needed to read gml files. I first started to build with only EXPAT and now I am building with EXPAT and XERCES, but I still can't read GML files. Here is my configuration output from the console.


C++14 support:             no

  LIBTOOL support:           yes

  LIBZ support:              external
  LIBLZMA support:           no
  ZSTD support:              no
  cryptopp support:          no
  crypto/openssl support:    no
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  LIBPNG support:            internal
  DDS support:               no
  GTA support:               no
  LIBTIFF support:           internal (BigTIFF=yes)
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  12 bit JPEG:               yes
  12 bit JPEG-in-TIFF:       yes
  LIBGIF support:            internal
  JPEG-Lossless/CharLS:      no
  OGDI support:              no
  HDF4 support:              no
  HDF5 support:              no
  Kea support:               no
  NetCDF support:            no
  Kakadu support:            no
  JasPer support:            no
  OpenJPEG support:          no
  ECW support:               yes
  MrSID support:             yes
  MrSID/MG4 Lidar support:   no
  JP2Lura support:           no
  MSG support:               no
  EPSILON support:           no
  WebP support:              no
  cURL support (wms/wcs/...):yes
  PostgreSQL support:        no
  LERC support:              yes
  MySQL support:             no
  Ingres support:            no
  Xerces-C support:          yes
  Expat support:             yes
  libxml2 support:           no
  Google libkml support:     no
  ODBC support:              no
  FGDB support:              no
  MDB support:               no
  PCIDSK support:            internal
  OCI support:               no
  GEORASTER support:         no
  SDE support:               no
  Rasdaman support:          no
  DODS support:              no
  SQLite support:            yes
  PCRE support:              no
  SpatiaLite support:        no
  RasterLite2 support:       no
  Teigha (DWG and DGNv8):    no
  INFORMIX DataBlade support:no
  GEOS support:              no
  SFCGAL support:            no
  QHull support:             internal
  Poppler support:           no
  Podofo support:            no
  PDFium support:            no
  OpenCL support:            no
  Armadillo support:         no
  FreeXL support:            no
  SOSI support:              no
  MongoDB support:           no
  MongoCXX v3 support:       no
  HDFS support:              no
  TileDB support:            no
  userfaultfd support:       yes


I did not disable the gml driver and the makefile says that gml is built by default. Here is the list of the available formats listed for ogr where you can see gml.


[cid:4d09603f-8ab8-4bfb-9380-3e23227760f5]


Here is the call i make to configure and to make in my script file to build GDAL.


[cid:9db827de-93bd-401f-ae0a-1a881134d61a]


I also built GDAL 3.0.1 on Windows and the command ogrinfo --formats lists all the possible formats, including gml and maybe 50+ others. Is there a way to build gdal on linux so that all the formats are also available for ogr? I joined my script file to build gdal.

​Thank you for your time!


Michael

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200202/862dcc70/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: build_gdal_x64.sh
Type: text/x-sh
Size: 9823 bytes
Desc: build_gdal_x64.sh
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200202/862dcc70/attachment-0001.sh>

From even.rouault at spatialys.com  Sun Feb  2 06:21:52 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 02 Feb 2020 15:21:52 +0100
Subject: [gdal-dev] Can't build GDAL 3.0.X to read GML format on Linux
	(Ubuntu 18.04)
In-Reply-To: <CH2PR04MB71096C5B1153B0C28F28EC118A010@CH2PR04MB7109.namprd04.prod.outlook.com>
References: <CH2PR04MB71096C5B1153B0C28F28EC118A010@CH2PR04MB7109.namprd04.prod.outlook.com>
Message-ID: <2017604.EReKUlx9AA@even-i700>

> Is there a way to build gdal on linux so that all the formats are also 
available for ogr?

Make sure to "make clean" before building each time you re-run configure with 
different options / install new depedencies.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Sun Feb  2 10:11:26 2020
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sun, 2 Feb 2020 18:11:26 +0000
Subject: [gdal-dev] How to create a Memory Vector dataset?
In-Reply-To: <1974708.SS0o9F72QL@even-i700>
References: <DB8PR04MB6697C5AA69837D394FA48B24A6070@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <1974708.SS0o9F72QL@even-i700>
Message-ID: <DB8PR04MB6697619E4EE7B78D0F2BB8FFA6010@DB8PR04MB6697.eurprd04.prod.outlook.com>


>> Is there an
>> example somewhere of creating a Memory (not MEM?) vector dataset that 
>> I could use to learn more on this?

> https://gdal.org/tutorials/vector_api_tut.html#writing-to-ogr should work with MEM too.

Even,

Sorry, I'm having *some* troubles with the MEM driver that I don't see how to solve

<begin snip>
	hDriver = GDALGetDriverByName("MEM");
	hDS = GDALCreate(hDriver, "mem", 1, 1, 1, GDT_Unknown, NULL);
	hLayer = GDALDatasetCreateLayer(hDS, "point_out", NULL, wkbPoint, NULL);
<end snip>

(errored when I used " GDALCreate(hDriver, "mem", 0, 0, 0, GDT_Unknown, NULL);" )

ERROR 6: CreateLayer() not supported by this dataset.

From even.rouault at spatialys.com  Sun Feb  2 10:21:20 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 02 Feb 2020 19:21:20 +0100
Subject: [gdal-dev] How to create a Memory Vector dataset?
In-Reply-To: <DB8PR04MB6697619E4EE7B78D0F2BB8FFA6010@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <DB8PR04MB6697C5AA69837D394FA48B24A6070@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <1974708.SS0o9F72QL@even-i700>
 <DB8PR04MB6697619E4EE7B78D0F2BB8FFA6010@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <2786898.kM0cu3QX0T@even-i700>

On dimanche 2 février 2020 18:11:26 CET Joaquim Manuel Freire Luís wrote:
> >> Is there an
> >> example somewhere of creating a Memory (not MEM?) vector dataset that
> >> I could use to learn more on this?
> > 
> > https://gdal.org/tutorials/vector_api_tut.html#writing-to-ogr should work
> > with MEM too.
> Even,
> 
> Sorry, I'm having *some* troubles with the MEM driver that I don't see how
> to solve
> 
> <begin snip>
> 	hDriver = GDALGetDriverByName("MEM");

--> should be "Memory" here for the vector driver. The MEM driver is raster-
only.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Sun Feb  2 11:31:58 2020
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sun, 2 Feb 2020 19:31:58 +0000
Subject: [gdal-dev] How to create a Memory Vector dataset?
In-Reply-To: <2786898.kM0cu3QX0T@even-i700>
References: <DB8PR04MB6697C5AA69837D394FA48B24A6070@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <1974708.SS0o9F72QL@even-i700>
 <DB8PR04MB6697619E4EE7B78D0F2BB8FFA6010@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <2786898.kM0cu3QX0T@even-i700>
Message-ID: <DB8PR04MB66970AB21742624E974FC042A6010@DB8PR04MB6697.eurprd04.prod.outlook.com>

Cool, that worked. But I had to go back to

hDS = GDALCreate(hDriver, "mem", 0, 0, 0, GDT_Unknown, NULL);

otherwise hDS == NULL


I now have something with 1 point only. Seems a bit inefficient, for each point, having to

Loop over all points {
		hFeature = OGR_F_Create(OGR_L_GetLayerDefn(hLayer));
		OGR_F_SetFieldString(hFeature, OGR_F_GetFieldIndex(hFeature, "Name"), "0");

		hPt = OGR_G_CreateGeometry(wkbPoint);
		OGR_G_SetPoint(hPt, 0, x, y, z);
		OGR_F_SetGeometry(hFeature, hPt);
		OGR_G_DestroyGeometry(hPt);

		if (OGR_L_CreateFeature(hLayer, hFeature) != OGRERR_NONE) {
			GMT_Report (GMT->parent, GMT_MSG_ERROR, "Failed to create feature in dataset.\n");
			GDALDestroyDriverManager();
			return NULL;
		}
		OGR_F_Destroy(hFeature);
}

But let me have a true working case to see.

Thanks.


-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 
Sent: Sunday, February 2, 2020 6:21 PM
To: Joaquim Manuel Freire Luís <jluis at ualg.pt>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How to create a Memory Vector dataset?

On dimanche 2 février 2020 18:11:26 CET Joaquim Manuel Freire Luís wrote:
> >> Is there an
> >> example somewhere of creating a Memory (not MEM?) vector dataset 
> >> that I could use to learn more on this?
> > 
> > https://gdal.org/tutorials/vector_api_tut.html#writing-to-ogr should 
> > work with MEM too.
> Even,
> 
> Sorry, I'm having *some* troubles with the MEM driver that I don't see 
> how to solve
> 
> <begin snip>
> 	hDriver = GDALGetDriverByName("MEM");

--> should be "Memory" here for the vector driver. The MEM driver is 
--> raster-
only.

--
Spatialys - Geospatial professional services http://www.spatialys.com

From woklist at kyngchaos.com  Sun Feb  2 14:11:24 2020
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Sun, 2 Feb 2020 16:11:24 -0600
Subject: [gdal-dev] "latest" rasterlite2?
Message-ID: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>

I see a change in GDAL 3.0.4 to "fix build against latest librasterlite2".  But this breaks compilation for me.  The latest ratserlite2 I know is 1.1.0-beta0 from over a year ago.  That's still latest at the spatialite website that I can see.

Where do I find this new "latest" rasterlite?  Could a test be added to allow for older versions?

-----
William Kyngesburye
<kyngchaos at kyngchaos.com>
<http://www.kyngchaos.com>

Don't Panic

From even.rouault at spatialys.com  Sun Feb  2 15:12:29 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 03 Feb 2020 00:12:29 +0100
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>
References: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>
Message-ID: <15810884.cfePtQjR56@even-i700>

William,

> I see a change in GDAL 3.0.4 to "fix build against latest librasterlite2". 
> But this breaks compilation for me.  The latest ratserlite2 I know is
> 1.1.0-beta0 from over a year ago.

Hum, I didn't know this was ever released... When the  driver was initially 
developed, it was designed to work with a future version of librasterlite2, 
that wasn't released at that time.

> Where do I find this new "latest" rasterlite?

You need to use latest fossil HEAD. Not released yet.

> Could a test be added to allow for older versions?

Would be a bit painful... I would have probably not backported this commit 
from master if I had known that 1.1.0-beta0 had been released... Given that 
this rasterlite2 driver is likely a edge case, I'd suggest to just drop the 
driver for now from your compilation. Or you'd have to build latest fossil 
HEAD
Some instructions at http://www.gaia-gis.it/gaia-sins/about-fossil.html
(libspatialite to be replaced by librasterlite2)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From woklist at kyngchaos.com  Sun Feb  2 17:26:00 2020
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Sun, 2 Feb 2020 19:26:00 -0600
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <15810884.cfePtQjR56@even-i700>
References: <15810884.cfePtQjR56@even-i700>
Message-ID: <90115C80-495E-46B1-96F7-B26F1CA3452C@kyngchaos.com>

Hm, well, rasterlite2 1.1.0b0 has been available since June 2018.  1.0 was from 2014, but that didn't have one of the functions at all that is causing trouble, rl2_load_raw_tiles_into_dbms.  That was changed in GDAL for a change in the parameters.

About fossil - no rasterlite2, at least not mentioned on the spatialite site.  So again, I have no idea where to get the "latest" rasterlite 2 you made the changes in GDAL 3.0.4 for.

I just reverted those changes in my copy of the source and GDAL compiles OK now.

-----
William Kyngesburye
<kyngchaos at kyngchaos.com>
<http://www.kyngchaos.com>

Don't Panic

> On Feb 2, 2020, at 5:12 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> ﻿William,
> 
>> I see a change in GDAL 3.0.4 to "fix build against latest librasterlite2". 
>> But this breaks compilation for me.  The latest ratserlite2 I know is
>> 1.1.0-beta0 from over a year ago.
> 
> Hum, I didn't know this was ever released... When the  driver was initially 
> developed, it was designed to work with a future version of librasterlite2, 
> that wasn't released at that time.
> 
>> Where do I find this new "latest" rasterlite?
> 
> You need to use latest fossil HEAD. Not released yet.
> 
>> Could a test be added to allow for older versions?
> 
> Would be a bit painful... I would have probably not backported this commit 
> from master if I had known that 1.1.0-beta0 had been released... Given that 
> this rasterlite2 driver is likely a edge case, I'd suggest to just drop the 
> driver for now from your compilation. Or you'd have to build latest fossil 
> HEAD
> Some instructions at http://www.gaia-gis.it/gaia-sins/about-fossil.html
> (libspatialite to be replaced by librasterlite2)
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> 


From jukka.rahkonen at maanmittauslaitos.fi  Sun Feb  2 23:14:36 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 3 Feb 2020 00:14:36 -0700 (MST)
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <90115C80-495E-46B1-96F7-B26F1CA3452C@kyngchaos.com>
References: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>
 <15810884.cfePtQjR56@even-i700>
 <90115C80-495E-46B1-96F7-B26F1CA3452C@kyngchaos.com>
Message-ID: <1580714076147-0.post@n6.nabble.com>

Hi,

Have a look at https://www.gaia-gis.it/fossil/librasterlite2/index.

-Jukka Rahkonen-


William Kyngesburye wrote
> About fossil - no rasterlite2, at least not mentioned on the spatialite
> site.  So again, I have no idea where to get the "latest" rasterlite 2 you
> made the changes in GDAL 3.0.4 for.
> 





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From olivia.gill at sepa.org.uk  Mon Feb  3 05:15:46 2020
From: olivia.gill at sepa.org.uk (Gill, Olivia)
Date: Mon, 3 Feb 2020 13:15:46 +0000
Subject: [gdal-dev] gml to Oracle
Message-ID: <73974960B66D2A4DAD304111B3C203C701AF97EF9D@SEPA-APP-EXC03.sepanet.sepa.org.uk>

Hi
I'm having trouble importing a gml file to Oracle using ogr2ogr. The import works but ignores 3d points. I am using a .gfs template and the following script:

C:\OSGeo4W64\OSGeo4W.bat for /R %%f in (*.gml) do ogr2ogr -f OCI OCI:schema/password at owner:TABLE "%%~dpnf.gml" --config GML_GFS_TEMPLATE template.gfs -append -addfields -relaxedFieldNameMatch

An extract of the gml:
      <net:geometry>
        <gml:Point srsName="urn:ogc:def:crs:EPSG::7405" gml:id="osgb5000005143866540_geom">
          <gml:pos>457436.880 1200753.970 92.854</gml:pos>
        </gml:Point>
      </net:geometry>

My template includes the following, to set the point geometry to
<ElementPath>HydroNode</ElementPath>
    <GeometryType>-2147483647</GeometryType>
    <SRSName>EPSG:27700</SRSName>

The resulting row in oracle MDSYS_SDO_GEOMETRY:
MDSYS.SDO_GEOMETRY(2001, NULL, MDSYS.SDO_POINT_TYPE(418363.37, 1157184.19, NULL), NULL, NULL)

So that the SRID is set to NULL, and the coordinates set the Z type to null also.
Hoping someone can help.
Olivia Gill





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200203/6ea250db/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb  3 07:28:59 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 3 Feb 2020 08:28:59 -0700 (MST)
Subject: [gdal-dev] gml to Oracle
In-Reply-To: <73974960B66D2A4DAD304111B3C203C701AF97EF9D@SEPA-APP-EXC03.sepanet.sepa.org.uk>
References: <73974960B66D2A4DAD304111B3C203C701AF97EF9D@SEPA-APP-EXC03.sepanet.sepa.org.uk>
Message-ID: <1580743739221-0.post@n6.nabble.com>

Hi,

Some generic ogr2ogr options do not work with Oracle OCI driver. Read
https://gdal.org/drivers/vector/oci.html#vector-oci and have a try with

-lco DIM=3 -lco SRID=27700

Writing output of a small test data set into LOADER_FILE can help with
debugging and reporting if something still goes wrong.

-Jukka Rahkonen-


Gill, Olivia wrote
> Hi
> I'm having trouble importing a gml file to Oracle using ogr2ogr. The
> import works but ignores 3d points. I am using a .gfs template and the
> following script:
> 
> C:\OSGeo4W64\OSGeo4W.bat for /R %%f in (*.gml) do ogr2ogr -f OCI
> OCI:schema/password at owner:TABLE "%%~dpnf.gml" --config GML_GFS_TEMPLATE
> template.gfs -append -addfields -relaxedFieldNameMatch
> 
> An extract of the gml:
>       
> <net:geometry>
>         
> <gml:Point srsName="urn:ogc:def:crs:EPSG::7405"
> gml:id="osgb5000005143866540_geom">
>           
> <gml:pos>
> 457436.880 1200753.970 92.854
> </gml:pos>
>         
> </gml:Point>
>       
> </net:geometry>
> My template includes the following, to set the point geometry to
> <ElementPath>
> HydroNode
> </ElementPath>
>     
> <GeometryType>
> -2147483647
> </GeometryType>
>     
> <SRSName>
> EPSG:27700
> </SRSName>
> The resulting row in oracle MDSYS_SDO_GEOMETRY:
> MDSYS.SDO_GEOMETRY(2001, NULL, MDSYS.SDO_POINT_TYPE(418363.37, 1157184.19,
> NULL), NULL, NULL)
> 
> So that the SRID is set to NULL, and the coordinates set the Z type to
> null also.
> Hoping someone can help.
> Olivia Gill
> 
> 
> 
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From chris.marsh at usask.ca  Mon Feb  3 09:36:46 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Mon, 3 Feb 2020 17:36:46 +0000
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <7029125.2IMaufSPgf@even-i700>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <2958350.DYHqErPMC2@even-i700>
 <CAFgDerHf_haaa5cYwaO0O+UdB67=9KbL6edsCPx0xC3s=q7axw@mail.gmail.com>
 <7029125.2IMaufSPgf@even-i700>
Message-ID: <CAFgDerEWfS-=sRpOQZO45ypyh=mYFjwGfrXfCTgkfaj9uak22g@mail.gmail.com>

Yup, forgot to enable netcdf. Sorry about that.

Otherwise your directions worked perfectly, thank you very much!

In terms of understanding, exactly, these steps for the next time:

0) How would I have known the data were transposed lon, lat?
0b) How would I have known the spacing of the lat variable was not constant? I imagine "because I looked at it?" :) Knowing this, I've gone back and I see it now when I do a quick analysis with xarray. What was the method you diagnosed this with?
1) What is the motivation to tiling the output?
2) Knowing about the mirror command is cool
3) I don't understand this step.  Why is this referencing back  the nc file?

Cheers
Chris


Chris Marsh, PhD
University of Saskatchewan
chrismarsh.ca<http://chrismarsh.ca/>



On Sun, Feb 2, 2020 at 6:15 AM Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>


On dimanche 2 février 2020 00:34:46 CET Marsh, Chris wrote:
> HI Even,
>
> Thanks for the detailed response. I have compiled master 3.1dev however
> strangest thing when I try to run it

> $ export PATH=`pwd`/gdal-install/bin:$PATH
> $ which gdal_translate
> /Users/chris/Documents/science/analysis/gdal-install/bin/gdal_translate
>  $ gdal_translate NETCDF:"`pwd`/SD_20160901.nc":snd_upd out.tif -co
> TILED=YES
 ERROR 4:
> NETCDF:/Users/chris/Documents/science/analysis/SD_20160901.nc:snd_upd: No
> such file or directory

Do you have the netCDF driver included ? Check with
"gdalinfo --format netCDF". This file is also a netCDF 4 file, so you need to
make sure you netCDF lib is built against HDF5.
You may use the "osgeo/gdal" Docker image.
See https://github.com/OSGeo/gdal/blob/master/gdal/docker/README.md

> $ ls
> /Users/chris/Documents/science/analysis/SD_20160901.nc
> /Users/chris/Documents/science/analysis/SD_20160901.nc
>
> If I try to use my homebrew installed gdal_translate it works.
>
> I've also tried without the `pwd` but that doesn't work either. This seems
> like a stupid PEBKAC but I'm out of ideas.

> Trying the 2nd command resulted in
>
> $ /gdal-install/bin/gdalmdimtranslate out.tif out2.tif -co TILED=YES -array
> band=1,transpose=[1,0],view=[::-1,::-1]
 zsh: no matches found:

Ah, just trying with zsh, this is just a quoting issue. You need to surround
the value of the array option with double quotes

... -array "band=1,transpose=[1,0],view=[::-1,::-1]"

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200203/f8d4218e/attachment-0001.html>

From even.rouault at spatialys.com  Mon Feb  3 10:45:10 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 03 Feb 2020 19:45:10 +0100
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <CAFgDerEWfS-=sRpOQZO45ypyh=mYFjwGfrXfCTgkfaj9uak22g@mail.gmail.com>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <7029125.2IMaufSPgf@even-i700>
 <CAFgDerEWfS-=sRpOQZO45ypyh=mYFjwGfrXfCTgkfaj9uak22g@mail.gmail.com>
Message-ID: <3224253.71II3oTkeY@even-i700>

On lundi 3 février 2020 17:36:45 CET Marsh, Chris wrote:
> Yup, forgot to enable netcdf. Sorry about that.
> 
> Otherwise your directions worked perfectly, thank you very much!
> 
> In terms of understanding, exactly, these steps for the next time:
> 
> 0) How would I have known the data were transposed lon, lat?

gdalinfo NETCDF:"SD_20160901.nc":snd_upd 
reporting
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
and
metadata with the lat and lon variables was a hint

"ncdump SD_20160901.nc" showing "float snd_upd(lon, lat)" confirmed it

> 0b) How would I have known the spacing of the lat variable was not constant?

Computing differences on consecutive lat values in the ncdump output. But 
gdalinfo with "--debug on" also reports "Longitude is not equally spaced" (it 
is confused here because of the lon/lat inversion, so this must be understood 
as the latitude...)

> 1) What is the motivation to tiling the output?

So that transposition of the array works fast.

> 3) I don't understand this step.  Why is this referencing back  the nc
> file?

Because previous steps have lost the georeferencing

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From chris.marsh at usask.ca  Mon Feb  3 11:37:33 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Mon, 3 Feb 2020 19:37:33 +0000
Subject: [gdal-dev] NetCDF and EASE-2
In-Reply-To: <3224253.71II3oTkeY@even-i700>
References: <CAFgDerFz_yZ3ET-crP7o-J3OAkShYviL4FPsjO_f9YJY4RDL7w@mail.gmail.com>
 <7029125.2IMaufSPgf@even-i700>
 <CAFgDerEWfS-=sRpOQZO45ypyh=mYFjwGfrXfCTgkfaj9uak22g@mail.gmail.com>
 <3224253.71II3oTkeY@even-i700>
Message-ID: <CAFgDerGAqDGbqKWGHabttyNjUZDN4LcUR-MitUBgJAoHiwNFTw@mail.gmail.com>

Hi Even,
I see, Ok I think that all makes sense. Thanks very much!

Cheers
Chris

Chris Marsh, PhD
University of Saskatchewan
chrismarsh.ca<http://chrismarsh.ca/>



On Mon, Feb 3, 2020 at 12:45 PM Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>


On lundi 3 février 2020 17:36:45 CET Marsh, Chris wrote:
> Yup, forgot to enable netcdf. Sorry about that.
>
> Otherwise your directions worked perfectly, thank you very much!
>
> In terms of understanding, exactly, these steps for the next time:
>
> 0) How would I have known the data were transposed lon, lat?

gdalinfo NETCDF:"SD_20160901.nc":snd_upd
reporting
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
and
metadata with the lat and lon variables was a hint

"ncdump SD_20160901.nc" showing "float snd_upd(lon, lat)" confirmed it

> 0b) How would I have known the spacing of the lat variable was not constant?

Computing differences on consecutive lat values in the ncdump output. But
gdalinfo with "--debug on" also reports "Longitude is not equally spaced" (it
is confused here because of the lon/lat inversion, so this must be understood
as the latitude...)

> 1) What is the motivation to tiling the output?

So that transposition of the array works fast.

> 3) I don't understand this step.  Why is this referencing back  the nc
> file?

Because previous steps have lost the georeferencing

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200203/ffc49136/attachment.html>

From woklist at kyngchaos.com  Mon Feb  3 16:54:03 2020
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Mon, 3 Feb 2020 18:54:03 -0600
Subject: [gdal-dev] "latest" rasterlite2?
Message-ID: <FA3F3612-718E-452E-9717-F85A81720061@kyngchaos.com>

﻿Been there... but now I see, the site design confused me, I didn't look at the menu.

Still, the page has only the 1.1.0b0 download.  That's what people will be downloading.

-----
William Kyngesburye
<kyngchaos at kyngchaos.com>
<http://www.kyngchaos.com>

Don't Panic

> On Feb 3, 2020, at 1:14 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> ﻿Hi,
> 
> Have a look at https://www.gaia-gis.it/fossil/librasterlite2/index.
> 
> -Jukka Rahkonen-
> 
> 
> William Kyngesburye wrote
>> About fossil - no rasterlite2, at least not mentioned on the spatialite
>> site.  So again, I have no idea where to get the "latest" rasterlite 2 you
>> made the changes in GDAL 3.0.4 for.
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  4 00:27:00 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 4 Feb 2020 01:27:00 -0700 (MST)
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <FA3F3612-718E-452E-9717-F85A81720061@kyngchaos.com>
References: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>
 <15810884.cfePtQjR56@even-i700>
 <FA3F3612-718E-452E-9717-F85A81720061@kyngchaos.com>
Message-ID: <1580804820516-0.post@n6.nabble.com>

Hi,

There are just no ready made tarballs available which is the normal
situation with Spatialite project.
I do not build programs myself but at least I could download the source code
from the current trunk. I downloaded fossil for Windows from
https://www.fossil-scm.org/fossil/uv/download.html and then I run  command

fossil clone https://www.gaia-gis.it/fossil/librasterlite2
librasterlite2.fossil 


This thread helped me with my trial
https://groups.google.com/forum/#!topic/spatialite-users/o8aJrsEO7qk. 

-Jukka Rahkonen-


William Kyngesburye wrote
> ﻿Been there... but now I see, the site design confused me, I didn't look
> at the menu.
> 
> Still, the page has only the 1.1.0b0 download.  That's what people will be
> downloading.
> 
> -----
> William Kyngesburye
> &lt;

> kyngchaos@

> &gt;
> &lt;http://www.kyngchaos.com&gt;
> 
> Don't Panic
> 
>> On Feb 3, 2020, at 1:14 AM, jratike80 &lt;

> jukka.rahkonen@

> &gt; wrote:
>> 
>> ﻿Hi,
>> 
>> Have a look at https://www.gaia-gis.it/fossil/librasterlite2/index.
>> 
>> -Jukka Rahkonen-
>> 
>> 
>> William Kyngesburye wrote
>>> About fossil - no rasterlite2, at least not mentioned on the spatialite
>>> site.  So again, I have no idea where to get the "latest" rasterlite 2
>>> you
>>> made the changes in GDAL 3.0.4 for.
>> 
>> 
>> 
>> 
>> 
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From woklist at kyngchaos.com  Tue Feb  4 06:22:12 2020
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Tue, 4 Feb 2020 08:22:12 -0600
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <1580804820516-0.post@n6.nabble.com>
References: <1580804820516-0.post@n6.nabble.com>
Message-ID: <E3B98DFF-E2BF-4D40-BBDB-8EB333C95C9A@kyngchaos.com>

But there are readymade tarballs - that's the 1.1.0beta0 that's on the rasterlite2 front page.  Sure, it's a beta, but it's the only one available and it's been there for over a year.  All the other projects on gaia-gis also have tarballs.

-----
William Kyngesburye
<kyngchaos at kyngchaos.com>
<http://www.kyngchaos.com>

Don't Panic

> On Feb 4, 2020, at 2:27 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> ﻿Hi,
> 
> There are just no ready made tarballs available which is the normal
> situation with Spatialite project.
> I do not build programs myself but at least I could download the source code
> from the current trunk. I downloaded fossil for Windows from
> https://www.fossil-scm.org/fossil/uv/download.html and then I run  command
> 
> fossil clone https://www.gaia-gis.it/fossil/librasterlite2
> librasterlite2.fossil 
> 
> 
> This thread helped me with my trial
> https://groups.google.com/forum/#!topic/spatialite-users/o8aJrsEO7qk. 
> 
> -Jukka Rahkonen-
> 
> 
> William Kyngesburye wrote
>> ﻿Been there... but now I see, the site design confused me, I didn't look
>> at the menu.
>> 
>> Still, the page has only the 1.1.0b0 download.  That's what people will be
>> downloading.
>> 
>> -----
>> William Kyngesburye
>> &lt;
> 
>> kyngchaos@
> 
>> &gt;
>> &lt;http://www.kyngchaos.com&gt;
>> 
>> Don't Panic
>> 
>>> On Feb 3, 2020, at 1:14 AM, jratike80 &lt;
> 
>> jukka.rahkonen@
> 
>> &gt; wrote:
>>> 
>>> ﻿Hi,
>>> 
>>> Have a look at https://www.gaia-gis.it/fossil/librasterlite2/index.
>>> 
>>> -Jukka Rahkonen-
>>> 
>>> 
>>> William Kyngesburye wrote
>>>> About fossil - no rasterlite2, at least not mentioned on the spatialite
>>>> site.  So again, I have no idea where to get the "latest" rasterlite 2
>>>> you
>>>> made the changes in GDAL 3.0.4 for.
>>> 
>>> 
>>> 
>>> 
>>> 
>>> --
>>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>>> _______________________________________________
>>> gdal-dev mailing list
>>> 
> 
>> gdal-dev at .osgeo
> 
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> 
>> _______________________________________________
>> gdal-dev mailing list
> 
>> gdal-dev at .osgeo
> 
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  4 07:14:47 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 4 Feb 2020 08:14:47 -0700 (MST)
Subject: [gdal-dev] "latest" rasterlite2?
In-Reply-To: <E3B98DFF-E2BF-4D40-BBDB-8EB333C95C9A@kyngchaos.com>
References: <64C17A9C-1D36-4356-B540-E0D710BED631@kyngchaos.com>
 <15810884.cfePtQjR56@even-i700>
 <FA3F3612-718E-452E-9717-F85A81720061@kyngchaos.com>
 <1580804820516-0.post@n6.nabble.com>
 <E3B98DFF-E2BF-4D40-BBDB-8EB333C95C9A@kyngchaos.com>
Message-ID: <1580829287593-0.post@n6.nabble.com>

Hi,

If we go back to the beginning of this thread.

You asked what version Even meant with "latest"
>> I see a change in GDAL 3.0.4 to "fix build against latest
>> librasterlite2". 
>> But this breaks compilation for me.  The latest ratserlite2 I know is
>> 1.1.0-beta0 from over a year ago.

>Hum, I didn't know this was ever released... When the  driver was initially 
>developed, it was designed to work with a future version of librasterlite2, 
>that wasn't released at that time.

>> Where do I find this new "latest" rasterlite?

Even answered that he meant the latest checkout from the fossil repository,
not the latest tarball.
>You need to use latest fossil HEAD. Not released yet.

If you need to apply the "fix build against latest librasterlite2" you must
capture sources from the fossil repository because the fix is not written
for the published tarball.

The other tarballs are old as well but I guess that GDAL can be compiled
with them.

-Jukka Rahkonen-


William Kyngesburye wrote
> But there are readymade tarballs - that's the 1.1.0beta0 that's on the
> rasterlite2 front page.  Sure, it's a beta, but it's the only one
> available and it's been there for over a year.  All the other projects on
> gaia-gis also have tarballs.
> 
> -----
> William Kyngesburye
> &lt;

> kyngchaos@

> &gt;
> &lt;http://www.kyngchaos.com&gt;





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Tue Feb  4 08:07:19 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 04 Feb 2020 17:07:19 +0100
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <4816617.FNJc4Uo8ek@even-i700>
References: <4816617.FNJc4Uo8ek@even-i700>
Message-ID: <2690165.gSqyxufuV3@even-i700>

On samedi 25 janvier 2020 18:52:14 CET Even Rouault wrote:
> Hi,
> 
> A number of people have expressed a wish to refresh GDAL's logo and have
> already submitted ideas in https://github.com/OSGeo/gdal/issues/2117

I haven't seen any recent activity on this ticket. No other ideas than the 
ones proposed in #2117 which are variations around the same theme ? Would be 
good if there was a range of choices.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Tue Feb  4 22:20:13 2020
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 5 Feb 2020 07:20:13 +0100
Subject: [gdal-dev] Command line text input (a WKT) to OGR e.g. to transform
 a coordinate using ogr2ogr?
Message-ID: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>

Hi,

I'd like to transform a single coordinate e.g. from SRS 4326 to local
Swiss EPSG 2056 without creating a file before hand - just like an
calculator.

Is this possible in a command line shell (like Win cmd/powershell,
bash) e.g. in the following (not yet functional) form:

echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
EPSG:4326 -t_srs EPSG:2056 ...?
echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
EPSG:4326 -t_srs EPSG:2056 -sql "select OGR_GEOM_WKT from input" ...?

:Stefan

From bradh at frogmouth.net  Tue Feb  4 22:51:55 2020
From: bradh at frogmouth.net (Brad Hards)
Date: Wed, 5 Feb 2020 17:51:55 +1100
Subject: [gdal-dev] Command line text input (a WKT) to OGR e.g. to
	transform a coordinate using ogr2ogr?
In-Reply-To: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>
References: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>
Message-ID: <016701d5dbf0$c16e6850$444b38f0$@frogmouth.net>

I think that cs2cs might be a suitable tool. Part of Proj, not GDAL, though.

https://proj.org/apps/cs2cs.html

Brad



From johannespaul92 at gmail.com  Wed Feb  5 01:08:42 2020
From: johannespaul92 at gmail.com (Johannes Paul)
Date: Wed, 5 Feb 2020 10:08:42 +0100
Subject: [gdal-dev] GDAL png driver
Message-ID: <CACcmK9Y=RP7oWNej=vBE5kXgas2Sq0mG_gxe_fNfmeb+53KF7Q@mail.gmail.com>

Hello,
I have an issue with a Mapserver output format, and I'm wondering if it
could be related to the associated GDAL driver.
Actually I'm using Mapserver to output PNG 16-bits DEM raster from .HGT
elevation data.
I'm using the below output format definition :

OUTPUTFORMAT
  NAME PNG16
  DRIVER GDAL/PNG
  MIMETYPE image/png
  IMAGEMODE INT16
  EXTENSION "png"
END

However I keep on getting the standard PNG 8-bits out of mapserver.

The strange thing being that when I use a similar config to get GeoTiff
16-bits, I do get what I'm asking for :

OUTPUTFORMAT
  NAME GEOTIFF16
  DRIVER GDAL/GTiff
  MIMETYPE image/tiff
  IMAGEMODE INT16
  EXTENSION "tiff"
END
Could that be an issue with the GDAL/PNG driver ? It seems that the
GDAL/PNG driver supports only CreateCopy() and not Create(), where the
GDAL/GTiff driver supports both ... Could that be it ?

For information, I'm using GDAL v2.1.3 and Mapserver v7.0.1
Thanks,
Johannes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/ce1c7b4b/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb  5 04:14:27 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 5 Feb 2020 05:14:27 -0700 (MST)
Subject: [gdal-dev] Command line text input (a WKT) to OGR e.g. to
 transform a coordinate using ogr2ogr?
In-Reply-To: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>
References: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>
Message-ID: <1580904867199-0.post@n6.nabble.com>

Hi,

Gdaltransform should be a rather close hit
https://gdal.org/programs/gdaltransform.html#gdaltransform

Usage example with your point

gdaltransform -s_srs epsg:4326 -t_srs epsg:2056
Enter X Y [Z [T]] values separated by space, and press Return.
10.1989 45.9461
2814015.23490644 1092044.84521026 0

But of course you can do the same with ogrinfo and SQLite SQL dialect. Here
done on Windows and with a WKT written into the command. Notice that for
ogrinfo some vector source must exist even the command does not read any
data from there. 

ogrinfo -dialect sqlite -sql "select
st_x(st_transform(setsrid(st_geomfromtext('POINT(10.1989
45.9461)'),4326),2056))||','||st_y(st_transform(setsrid(st_geomfromtext('POINT(10.1989
45.9461)'),4326),2056)) as xy" foo.shp|find "xy"
xy: String (0.0)
  xy (String) = 2814015.23490644,1092044.84521027

-Jukka Rahkonen-



Stefan Keller wrote
> Hi,
> 
> I'd like to transform a single coordinate e.g. from SRS 4326 to local
> Swiss EPSG 2056 without creating a file before hand - just like an
> calculator.
> 
> Is this possible in a command line shell (like Win cmd/powershell,
> bash) e.g. in the following (not yet functional) form:
> 
> echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
> EPSG:4326 -t_srs EPSG:2056 ...?
> echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
> EPSG:4326 -t_srs EPSG:2056 -sql "select OGR_GEOM_WKT from input" ...?
> 
> :Stefan
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From Owen.Varley at inzpire.com  Wed Feb  5 04:20:04 2020
From: Owen.Varley at inzpire.com (Owen Varley)
Date: Wed, 5 Feb 2020 12:20:04 +0000
Subject: [gdal-dev] Understanding GDAL's versioning/release process
Message-ID: <e10f6a40d36d47b8a196bfc3e844701a@VS1015934.inzpire.com>

Hi all,

I've been using GDAL for the past couple of months and I have a question about how releases are managed that I can't figure out from trawling GitHub.

There's a pull request (#1621) that includes a commit (https://github.com/OSGeo/gdal/pull/1621/commits/bcaeb975a703bdec49aff267a1a7a8f0c35ab5f2) that was merged into master on 4 Jun 2019. The commit has been tagged 3.0.3 and 2.4.4, however, when running gdal v3.0.3 or v3.0.4 the changes introduced by the commit don't seem to have taken affect. Having read through the v3.0.3 release notes (https://github.com/OSGeo/gdal/blob/v3.0.3/gdal/NEWS) I can't find any mention of #1621 being included.

My question is, if the commit was merged into master on 4 Jun 2019, would it not automatically be included within any releases posts that date? If not, how do you determine when/if the commit has been released?

Many thanks,

Owen
[http://revolutionindefence.com/images/logobanner.png]
This email and any attachments to it may be confidential and are intended solely for the use of the individual to whom it is addressed. If you are not the intended recipient of this email, you must neither take any action based upon its contents, nor copy or show it to anyone. Please contact the sender if you believe you have received this email in error. Inzpire retains personal data relating to our customers and partners for the purposes of conducting a business relationship, communicating and marketing to them as well as to providing invitations to upcoming events. Please see our Privacy Notice <https://www.inzpire.com/privacy-cookie-policy/> for further information. In accordance with our Privacy Notice, you have the right to withdraw your consent at any time. Inzpire may monitor email traffic data and also the content of email for the purposes of security. Inzpire Limited (Registered in England & Wales: Company Number: 05456427) Registered office: Unit 1B, Alpha Court Business Park, Kingsley Road, Lincoln, LN6 3TA. https://www.inzpire.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/6df1e31d/attachment.html>

From michael.landry at hotmail.com  Wed Feb  5 04:33:31 2020
From: michael.landry at hotmail.com (=?utf-8?B?TWljaGHDq2wgTGFuZHJ5?=)
Date: Wed, 5 Feb 2020 12:33:31 +0000
Subject: [gdal-dev] Can't build GDAL 3.0.X to read GML format on Linux
	(Ubuntu 18.04)
In-Reply-To: <CH2PR04MB71096C5B1153B0C28F28EC118A010@CH2PR04MB7109.namprd04.prod.outlook.com>
References: <CH2PR04MB71096C5B1153B0C28F28EC118A010@CH2PR04MB7109.namprd04.prod.outlook.com>
Message-ID: <CH2PR04MB7109E68D568A2672EC694E5A8A020@CH2PR04MB7109.namprd04.prod.outlook.com>

I found the problem.

Even though I was running a new configure file and calling make clean each time to remove the last built files, some files like config.status were not updated so the installation was running with the same faulty configuration over and over. It seems I could add configuration options, but I could not remove what had already been added.

Before calling ./configure, I had to call make distclean to remove everything that was installed by configure. The command make clean removes things that were generated by Make and the command make distclean removed things that were generated by Configure and Libtools.

I still don't know why my old configuration was not working... but now it works so I don't need to investigate.

Have a nice day!

________________________________
De : Michaël Landry
Envoyé : 2 février 2020 09:12
À : gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Objet : Can't build GDAL 3.0.X to read GML format on Linux (Ubuntu 18.04)


Hi,


I have successfully built and tested GDAL 3.0.1 and 3.0.4 with the SWIG java bindings and everything works fine except that I can't read GML format files. When I call the java method ogr.open( .. ), it always returns null. I investigated and i found out that I cannot open GML files with the ogrinfo app either. It seems the problem is on the native side and not on the bindings side. Here is the output of the command ogrinfo --formats for the app.


[cid:2fd2948e-3523-4798-a6b1-c35c2e941e0b]


I am using a configure script to build my makefiles. I read online at https://gdal.org/drivers/vector/gml.html​ that XERCES or EXPAT is needed to read gml files. I first started to build with only EXPAT and now I am building with EXPAT and XERCES, but I still can't read GML files. Here is my configuration output from the console.


C++14 support:             no

  LIBTOOL support:           yes

  LIBZ support:              external
  LIBLZMA support:           no
  ZSTD support:              no
  cryptopp support:          no
  crypto/openssl support:    no
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  LIBPNG support:            internal
  DDS support:               no
  GTA support:               no
  LIBTIFF support:           internal (BigTIFF=yes)
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  12 bit JPEG:               yes
  12 bit JPEG-in-TIFF:       yes
  LIBGIF support:            internal
  JPEG-Lossless/CharLS:      no
  OGDI support:              no
  HDF4 support:              no
  HDF5 support:              no
  Kea support:               no
  NetCDF support:            no
  Kakadu support:            no
  JasPer support:            no
  OpenJPEG support:          no
  ECW support:               yes
  MrSID support:             yes
  MrSID/MG4 Lidar support:   no
  JP2Lura support:           no
  MSG support:               no
  EPSILON support:           no
  WebP support:              no
  cURL support (wms/wcs/...):yes
  PostgreSQL support:        no
  LERC support:              yes
  MySQL support:             no
  Ingres support:            no
  Xerces-C support:          yes
  Expat support:             yes
  libxml2 support:           no
  Google libkml support:     no
  ODBC support:              no
  FGDB support:              no
  MDB support:               no
  PCIDSK support:            internal
  OCI support:               no
  GEORASTER support:         no
  SDE support:               no
  Rasdaman support:          no
  DODS support:              no
  SQLite support:            yes
  PCRE support:              no
  SpatiaLite support:        no
  RasterLite2 support:       no
  Teigha (DWG and DGNv8):    no
  INFORMIX DataBlade support:no
  GEOS support:              no
  SFCGAL support:            no
  QHull support:             internal
  Poppler support:           no
  Podofo support:            no
  PDFium support:            no
  OpenCL support:            no
  Armadillo support:         no
  FreeXL support:            no
  SOSI support:              no
  MongoDB support:           no
  MongoCXX v3 support:       no
  HDFS support:              no
  TileDB support:            no
  userfaultfd support:       yes


I did not disable the gml driver and the makefile says that gml is built by default. Here is the list of the available formats listed for ogr where you can see gml.


[cid:4d09603f-8ab8-4bfb-9380-3e23227760f5]


Here is the call i make to configure and to make in my script file to build GDAL.


[cid:9db827de-93bd-401f-ae0a-1a881134d61a]


I also built GDAL 3.0.1 on Windows and the command ogrinfo --formats lists all the possible formats, including gml and maybe 50+ others. Is there a way to build gdal on linux so that all the formats are also available for ogr? I joined my script file to build gdal.

​Thank you for your time!


Michael

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/a440a4be/attachment-0001.html>

From sandorl at gmail.com  Wed Feb  5 04:39:07 2020
From: sandorl at gmail.com (=?UTF-8?B?TMOhc3psw7MgU8OhbmRvcg==?=)
Date: Wed, 5 Feb 2020 13:39:07 +0100
Subject: [gdal-dev] conda conflicts
Message-ID: <CAG-ehZ3ODTvVhR_bMQhev83=wFnuX8cSu2Eo=uQDKSw8EqbFSQ@mail.gmail.com>

Hi,
Many thanks for GDAL. I spent some time on gdal.org, the git repo, the
Anaconda repo, and even tried a Homebrew installation. I cannot get a
working installation on my mac.

As I guess conda was supposed to be the default and foolproof way to get
started, let me explain how dependencies break.

Here is how a simple "conda install gdal" proceeds. It did not seem to make
a difference to activate an environment I use for the Intel Python Distro
or not, or specify the conda-forge channel or not.

conda install gdal (*idp*)

Collecting package metadata (current_repodata.json): done

Solving environment: failed with initial frozen solve. Retrying with
flexible solve.

Solving environment: failed with repodata from current_repodata.json, will
retry with next repodata source.

Collecting package metadata (repodata.json): done

Solving environment: failed with initial frozen solve. Retrying with
flexible solve.

Solving environment: -

Found conflicts! Looking for incompatible packages.

This can take several minutes.  Press CTRL-C to abort.

Examining conflict for (and here many packages are repeatedly checked)

A conda search gdal found the version below, among many:

gdal                           3.0.2  py37hbe65578_0  pkgs/main

I was actually hoping to get a simple operation done (below), sorry for all
this trouble!
https://gis.stackexchange.com/questions/348598/how-to-use-facebook-geotiff-maps-on-carto/348746?noredirect=1#comment572180_348746

Thanks for any thoughts,

Laszlo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/602e7dd5/attachment.html>

From jorisvandenbossche at gmail.com  Wed Feb  5 04:49:15 2020
From: jorisvandenbossche at gmail.com (Joris Van den Bossche)
Date: Wed, 5 Feb 2020 13:49:15 +0100
Subject: [gdal-dev] conda conflicts
In-Reply-To: <CAG-ehZ3ODTvVhR_bMQhev83=wFnuX8cSu2Eo=uQDKSw8EqbFSQ@mail.gmail.com>
References: <CAG-ehZ3ODTvVhR_bMQhev83=wFnuX8cSu2Eo=uQDKSw8EqbFSQ@mail.gmail.com>
Message-ID: <CALQtMBYtdDk5JxdPnBeg4UmnEbomqQ7XmSB5pHQbPV_M326j7A@mail.gmail.com>

Hi Laszlo,

The conda packages are not directly controlled by the GDAL developers, so
for the default Anaconda channel, you might want to report an issue at
https://github.com/ContinuumIO/anaconda-issues/issues, and for the
conda-forge package at https://github.com/conda-forge/gdal-feedstock/issues.

If you do that, make sure to provide some more information: the output of conda
info and conda list would help.

Specifically for conda-forge, check here how to set things up to work best
with the conda-forge channel:
https://conda-forge.org/docs/user/introduction.html#how-can-i-install-packages-from-conda-forge
(the strict channel priority is important)
Also, the output you showed below doesn't really show an error. Did you let
the command complete? (it can take a while)

Best,
Joris

On Wed, 5 Feb 2020 at 13:39, László Sándor <sandorl at gmail.com> wrote:

> Hi,
> Many thanks for GDAL. I spent some time on gdal.org, the git repo, the
> Anaconda repo, and even tried a Homebrew installation. I cannot get a
> working installation on my mac.
>
> As I guess conda was supposed to be the default and foolproof way to get
> started, let me explain how dependencies break.
>
> Here is how a simple "conda install gdal" proceeds. It did not seem to
> make a difference to activate an environment I use for the Intel Python
> Distro or not, or specify the conda-forge channel or not.
>
> conda install gdal (*idp*)
>
> Collecting package metadata (current_repodata.json): done
>
> Solving environment: failed with initial frozen solve. Retrying with
> flexible solve.
>
> Solving environment: failed with repodata from current_repodata.json, will
> retry with next repodata source.
>
> Collecting package metadata (repodata.json): done
>
> Solving environment: failed with initial frozen solve. Retrying with
> flexible solve.
>
> Solving environment: -
>
> Found conflicts! Looking for incompatible packages.
>
> This can take several minutes.  Press CTRL-C to abort.
>
> Examining conflict for (and here many packages are repeatedly checked)
>
> A conda search gdal found the version below, among many:
>
> gdal                           3.0.2  py37hbe65578_0  pkgs/main
>
> I was actually hoping to get a simple operation done (below), sorry for
> all this trouble!
>
> https://gis.stackexchange.com/questions/348598/how-to-use-facebook-geotiff-maps-on-carto/348746?noredirect=1#comment572180_348746
>
> Thanks for any thoughts,
>
> Laszlo
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/7896ec33/attachment.html>

From sandorl at gmail.com  Wed Feb  5 04:55:37 2020
From: sandorl at gmail.com (=?UTF-8?B?TMOhc3psw7MgU8OhbmRvcg==?=)
Date: Wed, 5 Feb 2020 13:55:37 +0100
Subject: [gdal-dev] conda conflicts
In-Reply-To: <CALQtMBYtdDk5JxdPnBeg4UmnEbomqQ7XmSB5pHQbPV_M326j7A@mail.gmail.com>
References: <CAG-ehZ3ODTvVhR_bMQhev83=wFnuX8cSu2Eo=uQDKSw8EqbFSQ@mail.gmail.com>
 <CALQtMBYtdDk5JxdPnBeg4UmnEbomqQ7XmSB5pHQbPV_M326j7A@mail.gmail.com>
Message-ID: <CAG-ehZ3szYDthyh5KP_ZfnRAtiJC44bJrLbVduUbTv90q8uoww@mail.gmail.com>

Thanks, Joris, I will follow up on this.

But just on your last question: I definitely let the command finish (on
multiple attempts, actually), I just spared you the lengthy output.
Conflicts galore.

On Wed, Feb 5, 2020 at 1:49 PM Joris Van den Bossche <
jorisvandenbossche at gmail.com> wrote:

> Hi Laszlo,
>
> The conda packages are not directly controlled by the GDAL developers, so
> for the default Anaconda channel, you might want to report an issue at
> https://github.com/ContinuumIO/anaconda-issues/issues, and for the
> conda-forge package at
> https://github.com/conda-forge/gdal-feedstock/issues.
> If you do that, make sure to provide some more information: the output of conda
> info and conda list would help.
>
> Specifically for conda-forge, check here how to set things up to work best
> with the conda-forge channel:
> https://conda-forge.org/docs/user/introduction.html#how-can-i-install-packages-from-conda-forge
> (the strict channel priority is important)
> Also, the output you showed below doesn't really show an error. Did you
> let the command complete? (it can take a while)
>
> Best,
> Joris
>
> On Wed, 5 Feb 2020 at 13:39, László Sándor <sandorl at gmail.com> wrote:
>
>> Hi,
>> Many thanks for GDAL. I spent some time on gdal.org, the git repo, the
>> Anaconda repo, and even tried a Homebrew installation. I cannot get a
>> working installation on my mac.
>>
>> As I guess conda was supposed to be the default and foolproof way to get
>> started, let me explain how dependencies break.
>>
>> Here is how a simple "conda install gdal" proceeds. It did not seem to
>> make a difference to activate an environment I use for the Intel Python
>> Distro or not, or specify the conda-forge channel or not.
>>
>> conda install gdal (*idp*)
>>
>> Collecting package metadata (current_repodata.json): done
>>
>> Solving environment: failed with initial frozen solve. Retrying with
>> flexible solve.
>>
>> Solving environment: failed with repodata from current_repodata.json,
>> will retry with next repodata source.
>>
>> Collecting package metadata (repodata.json): done
>>
>> Solving environment: failed with initial frozen solve. Retrying with
>> flexible solve.
>>
>> Solving environment: -
>>
>> Found conflicts! Looking for incompatible packages.
>>
>> This can take several minutes.  Press CTRL-C to abort.
>>
>> Examining conflict for (and here many packages are repeatedly checked)
>>
>> A conda search gdal found the version below, among many:
>>
>> gdal                           3.0.2  py37hbe65578_0  pkgs/main
>>
>> I was actually hoping to get a simple operation done (below), sorry for
>> all this trouble!
>>
>> https://gis.stackexchange.com/questions/348598/how-to-use-facebook-geotiff-maps-on-carto/348746?noredirect=1#comment572180_348746
>>
>> Thanks for any thoughts,
>>
>> Laszlo
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/fa870891/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb  5 05:15:53 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 5 Feb 2020 06:15:53 -0700 (MST)
Subject: [gdal-dev] Understanding GDAL's versioning/release process
In-Reply-To: <e10f6a40d36d47b8a196bfc3e844701a@VS1015934.inzpire.com>
References: <e10f6a40d36d47b8a196bfc3e844701a@VS1015934.inzpire.com>
Message-ID: <1580908553590-0.post@n6.nabble.com>

Hi,

Master or "trunk" is the development branch. Current trunk will be released
as GDAL 3.1 perhaps around May 2020. New features are developed into trunk
but some changes, mainly bug fixes and especially bug fixes which deal with
security issues, are also backported into one of more released branches.

You are referring to a pull request that adds a new driver for creating
cloud optimized GeoTIFFs. Such large contributions which add new
functionalities are not backported. It is also documented in the driver page
https://gdal.org/drivers/raster/cog.html#raster-cog "New in version 3.1". If
you want to use the COG driver before that you must compile GDAL from the
master or if you are a Windows users you can download compiled binaries from
OSGeo4W or from gisinternals.com.

-Jukka Rahkonen-



Owen Varley wrote
> Hi all,
> 
> I've been using GDAL for the past couple of months and I have a question
> about how releases are managed that I can't figure out from trawling
> GitHub.
> 
> There's a pull request (#1621) that includes a commit
> (https://github.com/OSGeo/gdal/pull/1621/commits/bcaeb975a703bdec49aff267a1a7a8f0c35ab5f2)
> that was merged into master on 4 Jun 2019. The commit has been tagged
> 3.0.3 and 2.4.4, however, when running gdal v3.0.3 or v3.0.4 the changes
> introduced by the commit don't seem to have taken affect. Having read
> through the v3.0.3 release notes
> (https://github.com/OSGeo/gdal/blob/v3.0.3/gdal/NEWS) I can't find any
> mention of #1621 being included.
> 
> My question is, if the commit was merged into master on 4 Jun 2019, would
> it not automatically be included within any releases posts that date? If
> not, how do you determine when/if the commit has been released?
> 
> Many thanks,
> 
> Owen
> [http://revolutionindefence.com/images/logobanner.png]
> This email and any attachments to it may be confidential and are intended
> solely for the use of the individual to whom it is addressed. If you are
> not the intended recipient of this email, you must neither take any action
> based upon its contents, nor copy or show it to anyone. Please contact the
> sender if you believe you have received this email in error. Inzpire
> retains personal data relating to our customers and partners for the
> purposes of conducting a business relationship, communicating and
> marketing to them as well as to providing invitations to upcoming events.
> Please see our Privacy Notice
> &lt;https://www.inzpire.com/privacy-cookie-policy/&gt; for further
> information. In accordance with our Privacy Notice, you have the right to
> withdraw your consent at any time. Inzpire may monitor email traffic data
> and also the content of email for the purposes of security. Inzpire
> Limited (Registered in England & Wales: Company Number: 05456427)
> Registered office: Unit 1B, Alpha Court Business Park, Kingsley Road,
> Lincoln, LN6 3TA. https://www.inzpire.com
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From Jon.Morris at jbarisk.com  Wed Feb  5 09:15:13 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Wed, 5 Feb 2020 17:15:13 +0000
Subject: [gdal-dev] Cannot set simple geotransform
Message-ID: <CWLP123MB25952D272027BD7C7392C8D582020@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>

I've just spent most of the afternoon banging my head against the desk because it appears that you cannot set a geotransform of (0, 1, 0, 0, 0, -1). Any other value works fine, but with this particular GT, the change is not saved when you close the ds. Is this a known issue? I'm using GDAL 2.2.0 on Python 3.6.8.

IPython console:

In [269]: ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',5,5,1,gdal.GDT_Byte)

In [270]: ds.GetGeoTransform()
Out[270]: (0.0, 1.0, 0.0, 0.0, 0.0, 1.0)

In [271]: ds.SetGeoTransform((0,1,0,0,0,-1))
Out[271]: 0

In [272]: del ds

In [273]: ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)

In [274]: ds.GetGeoTransform()
Out[274]: (0.0, 1.0, 0.0, 0.0, 0.0, 1.0)

In [275]: ds.SetGeoTransform((0,1,0,0,0,-1.000000001))
Out[275]: 0

In [276]: del ds

In [277]: ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)

In [278]: ds.GetGeoTransform()
Out[278]: (0.0, 1.0, 0.0, 0.0, 0.0, -1.000000001)



Thanks,

Jon

Jon Morris
Software Developer

Skype<sip:jon.morris at jbarisk.com>


T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/abd8b66f/attachment.html>

From sean at mapbox.com  Wed Feb  5 10:06:25 2020
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 5 Feb 2020 11:06:25 -0700
Subject: [gdal-dev] Cannot set simple geotransform
In-Reply-To: <CWLP123MB25952D272027BD7C7392C8D582020@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>
References: <CWLP123MB25952D272027BD7C7392C8D582020@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CADPhZXx7Y6zZUjgwgfKxnQ0QqWqLExrt-1ZanVyAjKVrNkprjg@mail.gmail.com>

Hi Jon,

On Wed, Feb 5, 2020 at 10:15 AM Jon Morris <Jon.Morris at jbarisk.com> wrote:

> I've just spent most of the afternoon banging my head against the desk
> because it appears that you cannot set a geotransform of (0, 1, 0, 0, 0,
> -1). Any other value works fine, but with this particular GT, the change is
> not saved when you close the ds. Is this a known issue? I'm using GDAL
> 2.2.0 on Python 3.6.8.
>
>
>
> IPython console:
>
>
>
> In [269]:
> ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',5,5,1,gdal.GDT_Byte)
>
>
>
>
> In [270]:
> ds.GetGeoTransform()
>
>
> Out[270]: (0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
>
>
>
> In [271]:
> ds.SetGeoTransform((0,1,0,0,0,-1))
>
>
> Out[271]: 0
>
>
>
> In [272]: del ds
>
>
>
>
> In [273]:
> ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)
>
>
>
>
> In [274]:
> ds.GetGeoTransform()
>
>
> Out[274]: (0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
>
>
>
> In [275]:
> ds.SetGeoTransform((0,1,0,0,0,-1.000000001))
>
>
> Out[275]: 0
>
>
>
> In [276]: del
> ds
>
>
>
>
> In [277]:
> ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)
>
>
>
>
> In [278]:
> ds.GetGeoTransform()
>
>
> Out[278]: (0.0, 1.0, 0.0, 0.0, 0.0, -1.000000001)
>
>
>
>
>
>
>
> Thanks,
>
>
>
> Jon
>
>
It's a known bug. There is some analysis at
https://github.com/mapbox/rasterio/issues/524#issuecomment-156655258.

Briefly: depending on the format driver, setting the geotransform can be a
no-op if the given transform is ~= the identity transform. For GeoTIFF,
both (0, 1, 0, 0, 0, 1) and (0, 1, 0, 0, 0, -1) are considered to be ~=
identity and are invalid inputs that are ignored.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200205/8b246036/attachment-0001.html>

From even.rouault at spatialys.com  Wed Feb  5 10:31:11 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Feb 2020 19:31:11 +0100
Subject: [gdal-dev] Cannot set simple geotransform
In-Reply-To: <CADPhZXx7Y6zZUjgwgfKxnQ0QqWqLExrt-1ZanVyAjKVrNkprjg@mail.gmail.com>
References: <CWLP123MB25952D272027BD7C7392C8D582020@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>
 <CADPhZXx7Y6zZUjgwgfKxnQ0QqWqLExrt-1ZanVyAjKVrNkprjg@mail.gmail.com>
Message-ID: <4786173.FITmAA2o5C@even-i700>

> It's a known bug. There is some analysis at
> https://github.com/mapbox/rasterio/issues/524#issuecomment-156655258.

Actually, is a *past* known bug, at least for the GTiff driver

>From GDAL 2.3.0 news:
 * make it accept to write SetGeoTransform([0,1,0,0,0,1]) as a 
ModelTransformationTag, and remove particular cases with the [0,1,0,0,0,1] 
geotransform (#1683)

This fix also fixes (0,1,0,0,0,-1)

>>> from osgeo import gdal
ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',5,5,1,gdal.GDT_Byte)     
>>> ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',
5,5,1,gdal.GDT_Byte)     
>>> ds.GetGeoTransform()     
(0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
>>> ds.SetGeoTransform((0,1,0,0,0,-1))                 
0
>>> del ds           
>>> ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)    
>>> ds.GetGeoTransform()             
(0.0, 1.0, 0.0, 0.0, 0.0, -1.0)
>>> 


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Feb  5 11:36:03 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 05 Feb 2020 20:36:03 +0100
Subject: [gdal-dev] Understanding GDAL's versioning/release process
In-Reply-To: <e10f6a40d36d47b8a196bfc3e844701a@VS1015934.inzpire.com>
References: <e10f6a40d36d47b8a196bfc3e844701a@VS1015934.inzpire.com>
Message-ID: <3446273.YqdxbF4iqb@even-i700>

On mercredi 5 février 2020 12:20:04 CET Owen Varley wrote:
> Hi all,
> 
> I've been using GDAL for the past couple of months and I have a question
> about how releases are managed that I can't figure out from trawling
> GitHub.
> 
> There's a pull request (#1621) that includes a commit
> (https://github.com/OSGeo/gdal/pull/1621/commits/bcaeb975a703bdec49aff267a1
> a7a8f0c35ab5f2) that was merged into master on 4 Jun 2019. The commit has
> been tagged 3.0.3 and 2.4.4, however, when running gdal v3.0.3 or v3.0.4
> the changes introduced by the commit don't seem to have taken affect.
> Having read through the v3.0.3 release notes
> (https://github.com/OSGeo/gdal/blob/v3.0.3/gdal/NEWS) I can't find any
> mention of #1621 being included.
> 

The way github presents things is indeed confusing... The above mention commit 
is only in master, and certainly not in 2.4.x or 3.0.x tags...

> My question is, if the commit was merged into master on 4 Jun 2019, would it
> not automatically be included within any releases posts that date? If not,
> how do you determine when/if the commit has been released?

git log in the relevant branch/tag and seach for the commit message

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jon at upowr.com.au  Wed Feb  5 16:55:40 2020
From: jon at upowr.com.au (Jon Seymour)
Date: Thu, 6 Feb 2020 11:55:40 +1100
Subject: [gdal-dev] upgrading to gdal-2.4.2 on debian:buster
Message-ID: <CAK3HS-f=9PtpeqstR3SUibpM0DWXq3guNRtqc07YmM=7R-nrOA@mail.gmail.com>

Hello all,

I have been using gdal-2.4.0 on debian buster for some time now. I ran
across an issue with the vsis3 driver and its interplay with the vrt driver
(AWS container credentials were expiring after 6 hours). This issue is
fixed in 2.4.2 so I wanted to upgrade my system to gdal-2.4.2 so I could
take advantage of the fix.

What I am looking for is a sketch of the most correct and efficient way for
me to do this.

What I have tried is the following:

I downloaded 2.4.2 from source and rebuilt it with the
--with-python=/usr/bin/python3 configuration option

This resulted in an installation in /usr/local. I noticed that another
dependency (the .deb package python-opencv) installs gdal-2.4.0 in
/usr/lib. I updated the symbolic link in /usr/lib to refer to the version
of libgdal.so.20 in /usr/local/lib and this worked for gdalinfo, it didn't
work for my larger program:

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of
OGRCoordinateTransformation failed.

Presumably this resulted from having a mix of 2.4.0 and 2.4.2 artefacts in
the same path.

I am now in the process of rebuilding the source with a prefix of /usr so
that I can at least replace the /usr version of the binary with my locally
built versions, but I don't know yet if that will work better.

I also experimented with rebuilding the 2.4.2 .deb package from the 2.4.2
tag of  https://salsa.debian.org/debian-gis-team/gdal but ran into problems
with an unresolved dependency (libodgi) which I wasn't able to resolve
trivially so I abandoned that attempt.

What is the best way for me to upgrade gdal from 2.4.0 to 2.4.2 on a debian
buster system?

jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/ae7baa98/attachment.html>

From jon at upowr.com.au  Wed Feb  5 20:14:55 2020
From: jon at upowr.com.au (Jon Seymour)
Date: Thu, 6 Feb 2020 15:14:55 +1100
Subject: [gdal-dev] upgrading to gdal-2.4.2 on debian:buster
In-Reply-To: <CAK3HS-f=9PtpeqstR3SUibpM0DWXq3guNRtqc07YmM=7R-nrOA@mail.gmail.com>
References: <CAK3HS-f=9PtpeqstR3SUibpM0DWXq3guNRtqc07YmM=7R-nrOA@mail.gmail.com>
Message-ID: <CAK3HS-dSrSF8uarJtU+652393FzBJfqQgxheN=6f=MFdqUakMw@mail.gmail.com>

I finally solved this, I have added some notes inline to my original post
to explain how and some misconceptions I had that have now been cleaned up.
Although I now have a working solution, I would be interested in
understanding cleaner approaches, if there are any (e.g. ways to rebuild
the debian package).

On Thu, Feb 6, 2020 at 11:55 AM Jon Seymour <jon at upowr.com.au> wrote:

> Hello all,
>
> I have been using gdal-2.4.0 on debian buster for some time now. I ran
> across an issue with the vsis3 driver and its interplay with the vrt driver
> (AWS container credentials were expiring after 6 hours). This issue is
> fixed in 2.4.2 so I wanted to upgrade my system to gdal-2.4.2 so I could
> take advantage of the fix.
>
> What I am looking for is a sketch of the most correct and efficient way
> for me to do this.
>
> What I have tried is the following:
>
> I downloaded 2.4.2 from source and rebuilt it with the
> --with-python=/usr/bin/python3 configuration option
>

> This resulted in an installation in /usr/local. I noticed that another
> dependency (the .deb package python-opencv) installs gdal-2.4.0 in
> /usr/lib. I updated the symbolic link in /usr/lib to refer to the version
> of libgdal.so.20 in /usr/local/lib and this worked for gdalinfo, it didn't
> work for my larger program:
>
>
In the end, for the functionality I wanted, I needed to
install libcurl4-openssl-dev libproj-dev into my build environment, and
then run ./configure with --prefix=/usr --with-python=/usr/bin/python3


> ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of
> OGRCoordinateTransformation failed.
>


> Presumably this resulted from having a mix of 2.4.0 and 2.4.2 artefacts in
> the same path.
>
>


> This problem was actually caused by not installing libproj-dev prior to
the gdal build.

>

> I am now in the process of rebuilding the source with a prefix of /usr so
> that I can at least replace the /usr version of the binary with my locally
> built versions, but I don't know yet if that will work better.
>
> I also experimented with rebuilding the 2.4.2 .deb package from the 2.4.2
> tag of  https://salsa.debian.org/debian-gis-team/gdal but ran into
> problems with an unresolved dependency (libodgi) which I wasn't able to
> resolve trivially so I abandoned that attempt.
>
>
I didn't try this, but I wondered later if I should have considered adding
the debian experimental repo to the build image in order to resolve the
libogdi-dev dependency.


> What is the best way for me to upgrade gdal from 2.4.0 to 2.4.2 on a
> debian buster system?
>
>
Ultimately, I built gdal-2.4.2 with this Dockerfile:

ARG BASE_IMAGE=debian:buster
FROM ${BASE_IMAGE}
ARG GDAL_VERSION=2.4.2
ENV GDAL_VERSION=${GDAL_VERSION}
RUN apt-get update && apt-get install -y \
                wget \
                build-essential \
                cmake \
                cython3 \
                libavcodec-dev \
                libavdevice-dev \
                libavfilter-dev \
                libavformat-dev \
                libblosc-dev \
                libbz2-dev \
                libjpeg62-turbo-dev \
                libjxr-dev \
                liblcms2-dev \
                liblz4-dev \
                liblzma-dev \
                libpng-dev \
                libswscale-dev \
                libtiff-dev \
                libwebp-dev \
                libz-dev \
                pkg-config \
                python-opencv \
                python3 \
                python3-dev \
                python3-numpy \
                python3-pip \
                python3-pip \
                python3-pytest \
                python3-pytest-cov \
                python3-setuptools \
                python3-virtualenv \
                python3-wheel \
                libcurl4-openssl-dev \
                libjpeg-dev \
                libopenjp2-7-dev \
                libproj-dev \
                libzstd-dev
RUN mkdir -p /usr/src && \
        cd /usr/src && \
        wget
https://download.osgeo.org/gdal/${GDAL_VERSION}/gdal-${GDAL_VERSION}.tar.gz
&& \
        tar xzf gdal-${GDAL_VERSION}.tar.gz && \
        cd gdal-${GDAL_VERSION} && \
        ./configure --prefix=/usr --with-python=/usr/bin/python3 && \
        make && \
        make install
RUN pip3 install cython jupyter GDAL==${GDAL_VERSION}

Feel free to let me know if there is a better way to skin this cat.

jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/11ecb10b/attachment.html>

From sebastic at xs4all.nl  Wed Feb  5 21:10:35 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Thu, 6 Feb 2020 06:10:35 +0100
Subject: [gdal-dev] upgrading to gdal-2.4.2 on debian:buster
In-Reply-To: <CAK3HS-f=9PtpeqstR3SUibpM0DWXq3guNRtqc07YmM=7R-nrOA@mail.gmail.com>
References: <CAK3HS-f=9PtpeqstR3SUibpM0DWXq3guNRtqc07YmM=7R-nrOA@mail.gmail.com>
Message-ID: <d29a6e61-ca8e-bc1a-6798-33b469068774@xs4all.nl>

On 2/6/20 1:55 AM, Jon Seymour wrote:
> What is the best way for me to upgrade gdal from 2.4.0 to 2.4.2 on a debian
> buster system?

Create a buster-backports branch from the most recent debian/2.4.x tag
in the package repository, and follow the procedure for backports:

 https://debian-gis-team.pages.debian.net/policy/packaging.html#git-backports

Add your backported package to your own apt repo and use that to upgrade
the installed package, or install it manually.

Since the virtual ABI dependency wasn't updated for every patch release
in 2.4 you don't need to rebuild any of the reverse dependencies when
upgrading to a newer 2.4.x.

Alternatively, work with the package maintainer to get the required
bugfixes into an official stable update, assuming that the severity is
important or higher.

 https://www.debian.org/doc/manuals/developers-reference/pkgs.en.html#upload-stable

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From Jon.Morris at jbarisk.com  Wed Feb  5 23:54:47 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 6 Feb 2020 07:54:47 +0000
Subject: [gdal-dev] Cannot set simple geotransform
In-Reply-To: <4786173.FITmAA2o5C@even-i700>
References: <CWLP123MB25952D272027BD7C7392C8D582020@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>
 <CADPhZXx7Y6zZUjgwgfKxnQ0QqWqLExrt-1ZanVyAjKVrNkprjg@mail.gmail.com>
 <4786173.FITmAA2o5C@even-i700>
Message-ID: <CWLP123MB25951AEDB751E24686CFD25C821D0@CWLP123MB2595.GBRP123.PROD.OUTLOOK.COM>

That's great to know, thanks both. Really must get on with that upgrade to GDAL 3...

Thanks,

Jon

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: 05 February 2020 18:31
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Cannot set simple geotransform

> It's a known bug. There is some analysis at
> https://github.com/mapbox/rasterio/issues/524#issuecomment-156655258.

Actually, is a *past* known bug, at least for the GTiff driver

From GDAL 2.3.0 news:
 * make it accept to write SetGeoTransform([0,1,0,0,0,1]) as a ModelTransformationTag, and remove particular cases with the [0,1,0,0,0,1] geotransform (#1683)

This fix also fixes (0,1,0,0,0,-1)

>>> from osgeo import gdal
ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',5,5,1,gdal.GDT_Byte)
>>> ds=gdal.GetDriverByName('GTiff').Create('/tmp/test.tif',
5,5,1,gdal.GDT_Byte)
>>> ds.GetGeoTransform()
(0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
>>> ds.SetGeoTransform((0,1,0,0,0,-1))
0
>>> del ds
>>> ds=gdal.OpenEx('/tmp/test.tif',gdal.GA_Update)
>>> ds.GetGeoTransform()
(0.0, 1.0, 0.0, 0.0, 0.0, -1.0)
>>>


--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.
Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919



From Daniel.Evans at jbarisk.com  Thu Feb  6 02:20:59 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Thu, 6 Feb 2020 10:20:59 +0000
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
Message-ID: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>

I am currently looking at upgrading from GDAL 2.x to GDAL 3.x. Most of my software tests pass, but I have a few failing because a transform from WGS84 to WGS84 is flipping the axes on transformed geometries.

I have a recollection of reading about GDAL 3 (or PROJ 6) resulting in axis swapping in some cases, but can't find the discussion/Github issue again.


The two SRS objects appear identical, and seem to report the same axis order, but a point at (1, 0) gets transformed to (0, 1) - Python code below:

>>> from_proj =  ds.GetLayer().GetSpatialRef()
>>> to_proj = osr.SpatialReference()
>>> to_proj.ImportFromEPSG(4326)
>>> to_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> to_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> from_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> from_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> xform = osr.CoordinateTransformation(from_proj, to_proj)
>>> xform.TransformPoint(1.0, 0.0)
(0.0, 1.0, 0.0)


If I follow from_proj back to its origin, it is also imported by importing from an EPSG code, which is again 4326:

>>> projection = osr.SpatialReference()
>>> projection.ImportFromEPSG(epsg)
>>> temp_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
>>> layer = temp_ds.CreateLayer(name, projection, geom_type=geom_type)


The two SRS objects appear identical when exported to WKT:

>>> from_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'
>>> to_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'


And if I re-import the SRSes from those WKT strings, the transform starts to behave:

>>> from_proj_reimported = osr.SpatialReference(); from_proj_reimported.ImportFromWkt(from_proj.ExportToWkt())
>>> to_proj_reimported = osr.SpatialReference(); to_proj_reimported.ImportFromWkt(to_proj.ExportToWkt())
>>> new_xform = osr.CoordinateTransformation(from_proj_reimported, to_proj_reimported)
>>> new_xform.TransformPoint(1.0, 0.0)
(1.0, 0.0, 0.0)


How are these two SRS objects ending up with flipped axes, how can I actually tell that the axes are flipped, and what do I need to do to un-flip them (short of exporting and reimporting every time I use them)?


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>


T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png]  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/c6b30fc1/attachment.html>

From Daniel.Evans at jbarisk.com  Thu Feb  6 02:30:35 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Thu, 6 Feb 2020 10:30:35 +0000
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <LO2P123MB20779D73360E95953A553C7C951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>

To give a somewhat more concise example:


from osgeo import gdal, osr, ogr

projection = osr.SpatialReference()
projection.ImportFromEPSG(4326)

temp_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
layer = temp_ds.CreateLayer("foo", projection, geom_type=ogr.wkbPolygon)
projFromLayer = layer.GetSpatialRef()

xform = osr.CoordinateTransformation(projection, projFromLayer)
xform.TransformPoint(1.0, 0.0)
# Outputs (0.0, 1.0, 0.0)

xform_no_layer = osr.CoordinateTransformation(projection, projection)
xform_no_layer.TransformPoint(1.0, 0.0)
# Outputs (1.0, 0.0, 0.0)


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>

From: Daniel Evans
Sent: 06 February 2020 10:21
To: gdal-dev at lists.osgeo.org
Subject: WGS84 -> WGS84 transform flips axes

I am currently looking at upgrading from GDAL 2.x to GDAL 3.x. Most of my software tests pass, but I have a few failing because a transform from WGS84 to WGS84 is flipping the axes on transformed geometries.

I have a recollection of reading about GDAL 3 (or PROJ 6) resulting in axis swapping in some cases, but can't find the discussion/Github issue again.


The two SRS objects appear identical, and seem to report the same axis order, but a point at (1, 0) gets transformed to (0, 1) - Python code below:

>>> from_proj =  ds.GetLayer().GetSpatialRef()
>>> to_proj = osr.SpatialReference()
>>> to_proj.ImportFromEPSG(4326)
>>> to_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> to_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> from_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> from_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> xform = osr.CoordinateTransformation(from_proj, to_proj)
>>> xform.TransformPoint(1.0, 0.0)
(0.0, 1.0, 0.0)


If I follow from_proj back to its origin, it is also imported by importing from an EPSG code, which is again 4326:

>>> projection = osr.SpatialReference()
>>> projection.ImportFromEPSG(epsg)
>>> temp_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
>>> layer = temp_ds.CreateLayer(name, projection, geom_type=geom_type)


The two SRS objects appear identical when exported to WKT:

>>> from_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'
>>> to_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'


And if I re-import the SRSes from those WKT strings, the transform starts to behave:

>>> from_proj_reimported = osr.SpatialReference(); from_proj_reimported.ImportFromWkt(from_proj.ExportToWkt())
>>> to_proj_reimported = osr.SpatialReference(); to_proj_reimported.ImportFromWkt(to_proj.ExportToWkt())
>>> new_xform = osr.CoordinateTransformation(from_proj_reimported, to_proj_reimported)
>>> new_xform.TransformPoint(1.0, 0.0)
(1.0, 0.0, 0.0)


How are these two SRS objects ending up with flipped axes, how can I actually tell that the axes are flipped, and what do I need to do to un-flip them (short of exporting and reimporting every time I use them)?


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>


T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png]  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/3ac98533/attachment-0001.html>

From mateusz at loskot.net  Thu Feb  6 02:32:25 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 6 Feb 2020 11:32:25 +0100
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CABUeae8iBSj-uNnJ+_iMO26pOjRGF2DfiTmh=Dd9UBzFSZn3qQ@mail.gmail.com>

On Thu, 6 Feb 2020 at 11:21, Daniel Evans <Daniel.Evans at jbarisk.com> wrote:

> I am currently looking at upgrading from GDAL 2.x to GDAL 3.x. Most of my
> software tests pass, but I have a few failing because a transform from
> WGS84 to WGS84 is flipping the axes on transformed geometries.
>
>
>
> I have a recollection of reading about GDAL 3 (or PROJ 6) resulting in
> axis swapping in some cases, but can’t find the discussion/Github issue
> again.
>

Try https://gdal.org/tutorials/osr_api_tut.html#crs-and-axis-order

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/8842248b/attachment.html>

From Daniel.Evans at jbarisk.com  Thu Feb  6 04:11:07 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Thu, 6 Feb 2020 12:11:07 +0000
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB20779D73360E95953A553C7C951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
 <LO2P123MB20779D73360E95953A553C7C951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <LO2P123MB20779DC57B5200D79B90509E951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>

It seems that the Migration Guide has the answer:

> OSRImportFromEPSG() takes into account official axis order.
> Traditional GIS-friendly axis order can be restored with
> OGRSpatialReference::SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER);

In my previous example, if one compares the responses to GetAxisMappingStrategy(), the original SRS and that returned by the layer are different:

>>> projection.GetAxisMappingStrategy() == osr.OAMS_AUTHORITY_COMPLIANT
# True

>>> projFromLayer.GetAxisMappingStrategy() == osr.OAMS_TRADITIONAL_GIS_ORDER
# True


Is the change to this value in this circumstance intentional? If so, does it mean that I have to repeatedly enforce the axis mapping strategy, because I don't know whether it will have been modified or not, depending on the provenance of the SRS object?


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>

From: Daniel Evans
Sent: 06 February 2020 10:31
To: gdal-dev at lists.osgeo.org
Subject: RE: WGS84 -> WGS84 transform flips axes

To give a somewhat more concise example:


from osgeo import gdal, osr, ogr

projection = osr.SpatialReference()
projection.ImportFromEPSG(4326)

temp_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
layer = temp_ds.CreateLayer("foo", projection, geom_type=ogr.wkbPolygon)
projFromLayer = layer.GetSpatialRef()

xform = osr.CoordinateTransformation(projection, projFromLayer)
xform.TransformPoint(1.0, 0.0)
# Outputs (0.0, 1.0, 0.0)

xform_no_layer = osr.CoordinateTransformation(projection, projection)
xform_no_layer.TransformPoint(1.0, 0.0)
# Outputs (1.0, 0.0, 0.0)


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>

From: Daniel Evans
Sent: 06 February 2020 10:21
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: WGS84 -> WGS84 transform flips axes

I am currently looking at upgrading from GDAL 2.x to GDAL 3.x. Most of my software tests pass, but I have a few failing because a transform from WGS84 to WGS84 is flipping the axes on transformed geometries.

I have a recollection of reading about GDAL 3 (or PROJ 6) resulting in axis swapping in some cases, but can't find the discussion/Github issue again.


The two SRS objects appear identical, and seem to report the same axis order, but a point at (1, 0) gets transformed to (0, 1) - Python code below:

>>> from_proj =  ds.GetLayer().GetSpatialRef()
>>> to_proj = osr.SpatialReference()
>>> to_proj.ImportFromEPSG(4326)
>>> to_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> to_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> from_proj.GetAxisName(None, 0)
'Geodetic latitude'
>>> from_proj.GetAxisName(None, 1)
'Geodetic longitude'
>>> xform = osr.CoordinateTransformation(from_proj, to_proj)
>>> xform.TransformPoint(1.0, 0.0)
(0.0, 1.0, 0.0)


If I follow from_proj back to its origin, it is also imported by importing from an EPSG code, which is again 4326:

>>> projection = osr.SpatialReference()
>>> projection.ImportFromEPSG(epsg)
>>> temp_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
>>> layer = temp_ds.CreateLayer(name, projection, geom_type=geom_type)


The two SRS objects appear identical when exported to WKT:

>>> from_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'
>>> to_proj.ExportToWkt()
'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]'


And if I re-import the SRSes from those WKT strings, the transform starts to behave:

>>> from_proj_reimported = osr.SpatialReference(); from_proj_reimported.ImportFromWkt(from_proj.ExportToWkt())
>>> to_proj_reimported = osr.SpatialReference(); to_proj_reimported.ImportFromWkt(to_proj.ExportToWkt())
>>> new_xform = osr.CoordinateTransformation(from_proj_reimported, to_proj_reimported)
>>> new_xform.TransformPoint(1.0, 0.0)
(1.0, 0.0, 0.0)


How are these two SRS objects ending up with flipped axes, how can I actually tell that the axes are flipped, and what do I need to do to un-flip them (short of exporting and reimporting every time I use them)?


Dr. Daniel Evans
Software Developer

Skype<sip:daniel.evans at jbarisk.com>


T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png]  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/5728d4c2/attachment-0001.html>

From Daniel.Evans at jbarisk.com  Thu Feb  6 04:20:42 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Thu, 6 Feb 2020 12:20:42 +0000
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
Message-ID: <LO2P123MB2077E6421E74C7263226BE57951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>

> Try https://gdal.org/tutorials/osr_api_tut.html#crs-and-axis-order

> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net

Thanks - I hadn't spotted your response until sending mine just now. That is indeed what's going on, with the setting being changed depending on how an SRS has been used.


Dr. Daniel Evans
Software Developer

Skype

T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <>  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.
Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919



From mateusz at loskot.net  Thu Feb  6 04:27:50 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 6 Feb 2020 13:27:50 +0100
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB2077E6421E74C7263226BE57951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077E6421E74C7263226BE57951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CABUeae9NQLjxdE-Adq0kOHPPwMsq=OTtF6rRKwrmGwmHFrUicQ@mail.gmail.com>

On Thu, 6 Feb 2020 at 13:20, Daniel Evans <Daniel.Evans at jbarisk.com> wrote:
>
> > Try https://gdal.org/tutorials/osr_api_tut.html#crs-and-axis-order
>
> Thanks - I hadn't spotted your response until sending mine just now. That is indeed what's going on, with the setting being changed depending on how an SRS has been used.

You're welcome.

BTW, I know most of us still remember search-less gdal.org,
and we don't even attempt to search the GDAL docs,
but last May things have greatly improved -
we've got ourselves the new shiny slick and cool search box :)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From Daniel.Evans at jbarisk.com  Thu Feb  6 04:29:39 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Thu, 6 Feb 2020 12:29:39 +0000
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <CABUeae9NQLjxdE-Adq0kOHPPwMsq=OTtF6rRKwrmGwmHFrUicQ@mail.gmail.com>
References: <LO2P123MB2077E6421E74C7263226BE57951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
 <CABUeae9NQLjxdE-Adq0kOHPPwMsq=OTtF6rRKwrmGwmHFrUicQ@mail.gmail.com>
Message-ID: <LO2P123MB20778A2A039531A1DDD7CB0F951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>

I'm still so backwards that I rely on the Git repository and the Python API documentation for information (https://gdal.org/python/) - but I've discovered that the latter is rather out of date today, as options like GetAxisMappingOrder aren't listed at all.

Daniel

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Mateusz Loskot
Sent: 06 February 2020 12:28
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] WGS84 -> WGS84 transform flips axes

On Thu, 6 Feb 2020 at 13:20, Daniel Evans <Daniel.Evans at jbarisk.com> wrote:
>
> > Try https://gdal.org/tutorials/osr_api_tut.html#crs-and-axis-order
>
> Thanks - I hadn't spotted your response until sending mine just now. That is indeed what's going on, with the setting being changed depending on how an SRS has been used.

You're welcome.

BTW, I know most of us still remember search-less gdal.org, and we don't even attempt to search the GDAL docs, but last May things have greatly improved - we've got ourselves the new shiny slick and cool search box :)

Best regards,
--
Mateusz Loskot, http://mateusz.loskot.net _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <>  [Follow us on Twitter] <https://twitter.com/jbarisk>
Our postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.
Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919



From even.rouault at spatialys.com  Thu Feb  6 04:43:28 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 06 Feb 2020 13:43:28 +0100
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB20779DC57B5200D79B90509E951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077BD2E7E79F6D3B6026896951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
 <LO2P123MB20779D73360E95953A553C7C951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
 <LO2P123MB20779DC57B5200D79B90509E951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <10635035.7Zzp8tSAiA@even-i700>

> In my previous example, if one compares the responses to 
GetAxisMappingStrategy(), the original SRS and that returned by the layer are 
different:
> >>> projection.GetAxisMappingStrategy() == osr.OAMS_AUTHORITY_COMPLIANT
> 
> # True
> 
> >>> projFromLayer.GetAxisMappingStrategy() == osr.OAMS_TRADITIONAL_GIS_ORDER
> 
> # True
> 
> 
> Is the change to this value in this circumstance intentional? 

Yes.

By default OGRSpatialReference object are authority compliant, since that's 
normative. But the reality is that 99% of GDAL code doesn't like that, so most 
drivers will hastily change to OAMS_TRADITIONAL_GIS_ORDER

> If so, does it
> mean that I have to repeatedly enforce the axis mapping strategy, because I
> don't know whether it will have been modified or not, depending on the
> provenance of the SRS object?

If you get vector data + a OGRSpatialReference object from a OGR driver you 
shouldn't override its axis mapping strategy if you intend to reproject from 
it to something else. 99% of the time it will be OAMS_TRADITIONAL_GIS_ORDER, 
but in the rare cases where it would be OAMS_AUTHORITY_COMPLIANT and the SRS 
would be a EPSG geographic CRS, it means that for example the first element in 
the coordinate tuple would be latitude. If you don't override the axis mapping 
strategy, then OGRCoordinateTransformation will do the right thing knowing 
that the first element in the coordinate tuple is a latitude.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Thu Feb  6 05:00:13 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 6 Feb 2020 14:00:13 +0100
Subject: [gdal-dev] WGS84 -> WGS84 transform flips axes
In-Reply-To: <LO2P123MB20778A2A039531A1DDD7CB0F951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB2077E6421E74C7263226BE57951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
 <CABUeae9NQLjxdE-Adq0kOHPPwMsq=OTtF6rRKwrmGwmHFrUicQ@mail.gmail.com>
 <LO2P123MB20778A2A039531A1DDD7CB0F951D0@LO2P123MB2077.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CABUeae_Fmufy09q-03oxVrvkoLSWtxESLWfQByOAa5BeQVVGFQ@mail.gmail.com>

On Thu, 6 Feb 2020 at 13:29, Daniel Evans <Daniel.Evans at jbarisk.com> wrote:
>
> I'm still so backwards that I rely on the Git repository and the Python API documentation for information (https://gdal.org/python/)
>  but I've discovered that the latter is rather out of date today, as options like GetAxisMappingOrder aren't listed at all.

Any API reference, even an up to date one, is intrinsically a specific
and narrow view at a library
features and as such it is not a reliable source of information about
architecture, behaviour,
caveates and corner cases of a complex system like GDAL.

It's not uncommon Python-oriented developers skip the *core* docs thinking
"that is for the C/C++ camp folks" and relying on the Python API reference.
It's a mistake.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From alber.ipia at inpe.br  Thu Feb  6 05:53:52 2020
From: alber.ipia at inpe.br (=?UTF-8?Q?Alber_S=c3=a1nchez?=)
Date: Thu, 6 Feb 2020 10:53:52 -0300
Subject: [gdal-dev] gdal_calc issue
Message-ID: <8eb8c2b7-941b-e912-3d1e-17dfe3cf7861@inpe.br>

Good morning,

I unable to use gdal_calc to make a pixel-wise computation between two
tiffs with several bands.

I have two tifs, each contains time series of the same spectral band.
For example, file1.tif contains a time series of RED and file2.tif
contains a time series of NIR (near infrared). The dates of the time
series in both files match. I would like to create a third file with a
pixel-wise computation between the first two files for which I'm using
gdal_calc as follows:

gdal_calc.py -A file1.tif -B file2.tif --calc="((A - B) / (A + B +
0.00001)) * 10000" --outfile=result.tif

This runs but only uses the first band in both files. I know about the
"allBands" flag, but it only handles one of the files, not both. For
example, this produces the wrong results because it only uses the first
band in file2.tif:

gdal_calc.py -A file1.tif -B file2.tif --calc="((A - B) / (A + B
+0.00001)) * 10000" --outfile=result.tif --allBands=A --allBands=B

Am I doing something wrong? Is there another way?

By the way, I prepared two samples files, available here:

https://www.dropbox.com/sh/a3yoxz34rsm1qqi/AAChpBHarBc5fiC19AlEnyk3a?dl=0

I'm sorry if I'm posting this question in the wrong list.

Thanks a lot!

-- 
Alber Sánchez
National Institute for Space Research
Earth System Science Center
São José dos Campos, SP, Brazil





-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200206/73f95a0b/attachment-0001.sig>

From sfkeller at gmail.com  Thu Feb  6 10:12:17 2020
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 6 Feb 2020 19:12:17 +0100
Subject: [gdal-dev] Command line text input (a WKT) to OGR e.g. to
 transform a coordinate using ogr2ogr?
In-Reply-To: <1580904867199-0.post@n6.nabble.com>
References: <CAFcOn2-NKycJe7dmkOV2WQq0TgVHDE1dCLb=+hZHv+LKe1NTQw@mail.gmail.com>
 <1580904867199-0.post@n6.nabble.com>
Message-ID: <CAFcOn29EuF7xXRmjanV+P1nDMfUg+tioanfHNUM4HMpdTN0ztw@mail.gmail.com>

Hi Brad, hi Jukka

Thank you for the tips!

Seems that in fact cs2cs works similar to GDAL and both seem to be
installed e.g. with QGIS

cs2cs +init=epsg:4326 +to +init=epsg:2056

:Stefan

Am Mi., 5. Feb. 2020 um 13:14 Uhr schrieb jratike80
<jukka.rahkonen at maanmittauslaitos.fi>:
>
> Hi,
>
> Gdaltransform should be a rather close hit
> https://gdal.org/programs/gdaltransform.html#gdaltransform
>
> Usage example with your point
>
> gdaltransform -s_srs epsg:4326 -t_srs epsg:2056
> Enter X Y [Z [T]] values separated by space, and press Return.
> 10.1989 45.9461
> 2814015.23490644 1092044.84521026 0
>
> But of course you can do the same with ogrinfo and SQLite SQL dialect. Here
> done on Windows and with a WKT written into the command. Notice that for
> ogrinfo some vector source must exist even the command does not read any
> data from there.
>
> ogrinfo -dialect sqlite -sql "select
> st_x(st_transform(setsrid(st_geomfromtext('POINT(10.1989
> 45.9461)'),4326),2056))||','||st_y(st_transform(setsrid(st_geomfromtext('POINT(10.1989
> 45.9461)'),4326),2056)) as xy" foo.shp|find "xy"
> xy: String (0.0)
>   xy (String) = 2814015.23490644,1092044.84521027
>
> -Jukka Rahkonen-
>
>
>
> Stefan Keller wrote
> > Hi,
> >
> > I'd like to transform a single coordinate e.g. from SRS 4326 to local
> > Swiss EPSG 2056 without creating a file before hand - just like an
> > calculator.
> >
> > Is this possible in a command line shell (like Win cmd/powershell,
> > bash) e.g. in the following (not yet functional) form:
> >
> > echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
> > EPSG:4326 -t_srs EPSG:2056 ...?
> > echo "POINT(10.1989 45.9461)" | ogr2ogr -f CSV ?stdout ?stdin -s_srs
> > EPSG:4326 -t_srs EPSG:2056 -sql "select OGR_GEOM_WKT from input" ...?
> >
> > :Stefan
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From umbertofilippo at tiscali.it  Fri Feb  7 02:30:12 2020
From: umbertofilippo at tiscali.it (umbertofilippo)
Date: Fri, 7 Feb 2020 03:30:12 -0700 (MST)
Subject: [gdal-dev] [Python bindings] BuildOverviews() not supported for VRT
	dataset
Message-ID: <1581071412102-0.post@n6.nabble.com>

Hello everybody,

I am trying to build overviews in a VRT dataset with python GDAL.

I try this code:

out_vrt = os.path.join(out_dir, 'mosaic.vrt')
ds = gdal.BuildVRT(out_vrt, [raster1.tif, raster2.tif])
factors = [128, 256, 512]
gdal.SetConfigOption('COMPRESS_OVERVIEW', 'DEFLATE')
ds.BuildOverviews("AVERAGE", factors)

, but I get this error:

ERROR 6:
/home/umberto/Documents/jrc/FB_Data4Good/mosaic/test/vrt/mosaic.vrt:
BuildOverviews() not supported for this dataset.

The VRT mosaic is created, but the overviews are not.

As far as I know, gdaladdo should work with VRTs, but I am not sure if
gdal.BuildVRT() is actually using it.

Any idea?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From umbertofilippo at tiscali.it  Fri Feb  7 02:58:02 2020
From: umbertofilippo at tiscali.it (umbertofilippo)
Date: Fri, 7 Feb 2020 03:58:02 -0700 (MST)
Subject: [gdal-dev] [Python bindings] BuildOverviews() not supported for
 VRT dataset
In-Reply-To: <1581071412102-0.post@n6.nabble.com>
References: <1581071412102-0.post@n6.nabble.com>
Message-ID: <1581073082817-0.post@n6.nabble.com>

Solved by looking at  this answer
<https://gis.stackexchange.com/questions/44003/python-equivalent-of-gdalbuildvrt/299218> 
:

out_vrt = os.path.join(out_dir, 'mosaic.vrt')
ds = gdal.BuildVRT(out_vrt, [raster1.tif, raster2.tif])
ds = None # this did the trick!
factors = [128, 256, 512]
gdal.SetConfigOption('COMPRESS_OVERVIEW', 'DEFLATE')
ds.BuildOverviews("AVERAGE", factors)

Explanation (quoting one of the comments in the answer I mentioned):

"Note that the CreateCopy() method returns a writable dataset, and that it
must be closed properly to complete writing and flushing the dataset to
disk. In the Python case this occurs automatically when "dst_ds" goes out of
scope." SInce there is no closing for python, you have to bring your vrt out
of scope, by assign it to None.





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Fri Feb  7 03:32:21 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 07 Feb 2020 12:32:21 +0100
Subject: [gdal-dev] [Python bindings] BuildOverviews() not supported for
	VRT dataset
In-Reply-To: <1581073082817-0.post@n6.nabble.com>
References: <1581071412102-0.post@n6.nabble.com>
 <1581073082817-0.post@n6.nabble.com>
Message-ID: <5495192.e3ccqXuUkb@even-i700>

On vendredi 7 février 2020 03:58:02 CET umbertofilippo wrote:
> Solved by looking at  this answer
> <https://gis.stackexchange.com/questions/44003/python-equivalent-of-gdalbuil
> dvrt/299218>
> 
> 
> out_vrt = os.path.join(out_dir, 'mosaic.vrt')
> ds = gdal.BuildVRT(out_vrt, [raster1.tif, raster2.tif])
> ds = None # this did the trick!
> factors = [128, 256, 512]
> gdal.SetConfigOption('COMPRESS_OVERVIEW', 'DEFLATE')
> ds.BuildOverviews("AVERAGE", factors)

The above will obviously not work :-) ! You cannot call ds.BuildOverview() 
when ds is set to None before.
I suspect you've added in-between a
ds = gdal.Open(out_vrt, gdal.GA_Update)

But having to close / re-open was a bug that I've just fixd. Your original 
code would now work.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From umbertofilippo at tiscali.it  Fri Feb  7 05:02:58 2020
From: umbertofilippo at tiscali.it (umbertofilippo)
Date: Fri, 7 Feb 2020 06:02:58 -0700 (MST)
Subject: [gdal-dev] [Python bindings] BuildOverviews() not supported for
 VRT dataset
In-Reply-To: <5495192.e3ccqXuUkb@even-i700>
References: <1581071412102-0.post@n6.nabble.com>
 <1581073082817-0.post@n6.nabble.com> <5495192.e3ccqXuUkb@even-i700>
Message-ID: <1581080578891-0.post@n6.nabble.com>

Yeah you're totally right obviously :)

i forgot to copy and paste ds = gdal.BuildVRT(out_vrt, rasters,
options=vrt_options) in between...

out_vrt = os.path.join(out_dir, 'mosaic.vrt')
ds = gdal.BuildVRT(out_vrt, [raster1.tif, raster2.tif])
ds = None # this did the trick!
ds = gdal.BuildVRT(out_vrt, rasters, options=vrt_options)
factors = [128, 256, 512]
gdal.SetConfigOption('COMPRESS_OVERVIEW', 'DEFLATE')
ds.BuildOverviews("AVERAGE", factors)

Anyway, great that you already fixed it!

Umberto



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From umbertofilippo at tiscali.it  Fri Feb  7 05:11:45 2020
From: umbertofilippo at tiscali.it (umbertofilippo)
Date: Fri, 7 Feb 2020 06:11:45 -0700 (MST)
Subject: [gdal-dev] [Python bindings] BuildOverviews() not supported for
 VRT dataset
In-Reply-To: <1581080578891-0.post@n6.nabble.com>
References: <1581071412102-0.post@n6.nabble.com>
 <1581073082817-0.post@n6.nabble.com> <5495192.e3ccqXuUkb@even-i700>
 <1581080578891-0.post@n6.nabble.com>
Message-ID: <1581081105501-0.post@n6.nabble.com>

just edited the previous post (again, wrong copy and paste, shame on me)



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From sergey.suloev at gmail.com  Fri Feb  7 06:08:29 2020
From: sergey.suloev at gmail.com (Sergey Suloev)
Date: Fri, 7 Feb 2020 17:08:29 +0300
Subject: [gdal-dev] Question about GDAL API: way to find out if CS is SPCS
Message-ID: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>

Hello,

in my project I am using GDAL to manage coordinate systems.
I am looking for a function/class that can tell me if a specific 
coordinate system is a State Plane Coordinate System and give a zone number.

Thank you very much

From alansnow21 at gmail.com  Fri Feb  7 06:36:22 2020
From: alansnow21 at gmail.com (Alan Snow)
Date: Fri, 7 Feb 2020 08:36:22 -0600
Subject: [gdal-dev] Question about GDAL API: way to find out if CS is
	SPCS
In-Reply-To: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>
References: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>
Message-ID: <CAGybdFSLvu=p5KBrNyJ6QSEVxVeG4M0hBo7TvJLZ9V_10be80A@mail.gmail.com>

If you use python, the pyproj CRS class can help.
>>> from pyproj import CRS
>>> crs = CRS("EPSG:26945")
>>> crs
<Projected CRS: EPSG:26945>
Name: NAD83 / California zone 5
Axis Info [cartesian]:
- X[east]: Easting (metre)
- Y[north]: Northing (metre)
Area of Use:
- name: USA - California - SPCS83 - 5
- bounds: (-121.42, 32.76, -114.12, 35.81)
Coordinate Operation:
- name: SPCS83 California zone 5 (meters)
- method: Lambert Conic Conformal (2SP)
Datum: North American Datum 1983
- Ellipsoid: GRS 1980
- Prime Meridian: Greenwich

>>> crs.name
'NAD83 / California zone 5'
>>> crs.coordinate_operation.name
'SPCS83 California zone 5 (meters)'

On Fri, Feb 7, 2020 at 8:08 AM Sergey Suloev <sergey.suloev at gmail.com>
wrote:

> Hello,
>
> in my project I am using GDAL to manage coordinate systems.
> I am looking for a function/class that can tell me if a specific
> coordinate system is a State Plane Coordinate System and give a zone
> number.
>
> Thank you very much
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Alan Snow
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200207/6c0e055c/attachment.html>

From sergey.suloev at gmail.com  Fri Feb  7 08:10:56 2020
From: sergey.suloev at gmail.com (Sergey Suloev)
Date: Fri, 7 Feb 2020 19:10:56 +0300
Subject: [gdal-dev] Question about GDAL API: way to find out if CS is
	SPCS
In-Reply-To: <CAGybdFSLvu=p5KBrNyJ6QSEVxVeG4M0hBo7TvJLZ9V_10be80A@mail.gmail.com>
References: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>
 <CAGybdFSLvu=p5KBrNyJ6QSEVxVeG4M0hBo7TvJLZ9V_10be80A@mail.gmail.com>
Message-ID: <3cc34fe1-b716-4252-5475-300c07d44e74@gmail.com>

hi, Alan,

On 2/7/20 5:36 PM, Alan Snow wrote:
> If you use python, the pyproj CRS class can help.
>  >>> from pyproj import CRS
>  >>> crs = CRS("EPSG:26945")
>  >>> crs
> <Projected CRS: EPSG:26945>
> Name: NAD83 / California zone 5
> Axis Info [cartesian]:
> - X[east]: Easting (metre)
> - Y[north]: Northing (metre)
> Area of Use:
> - name: USA - California - SPCS83 - 5
> - bounds: (-121.42, 32.76, -114.12, 35.81)
> Coordinate Operation:
> - name: SPCS83 California zone 5 (meters)
> - method: Lambert Conic Conformal (2SP)
> Datum: North American Datum 1983
> - Ellipsoid: GRS 1980
> - Prime Meridian: Greenwich
> 
>  >>> crs.name <http://crs.name>
> 'NAD83 / California zone 5'
>  >>> crs.coordinate_operation.name <http://crs.coordinate_operation.name>
> 'SPCS83 California zone 5 (meters)'
> 
> On Fri, Feb 7, 2020 at 8:08 AM Sergey Suloev <sergey.suloev at gmail.com 
> <mailto:sergey.suloev at gmail.com>> wrote:
> 
>     Hello,
> 
>     in my project I am using GDAL to manage coordinate systems.
>     I am looking for a function/class that can tell me if a specific
>     coordinate system is a State Plane Coordinate System and give a zone
>     number.
> 
>     Thank you very much
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Alan Snow

thanks for the answer. I am using C/C++ and I was expecting to find a 
function/method like "GetSPCSZone", "IzSPCS" or similar.

Do you mean that I have to parse a coordinate system name in order to 
find required information ?

Sergey

From csmemoe at aquaveo.com  Fri Feb  7 09:06:28 2020
From: csmemoe at aquaveo.com (Chris Smemoe)
Date: Fri, 7 Feb 2020 10:06:28 -0700
Subject: [gdal-dev] Question about GDAL API: way to find out if CS isSPCS
In-Reply-To: <3cc34fe1-b716-4252-5475-300c07d44e74@gmail.com>
References: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>
 <CAGybdFSLvu=p5KBrNyJ6QSEVxVeG4M0hBo7TvJLZ9V_10be80A@mail.gmail.com>
 <3cc34fe1-b716-4252-5475-300c07d44e74@gmail.com>
Message-ID: <DBE8100A70BC4AD78BB1DE907039C13F@aquaveo.local>

Sergey,

As far as I know, there are no functions like that in GDAL.  Perhaps those
functions could be added to the API.  I'd recommend posting the question to
gis.stackexchange.com and try to get an answer there.  I have some rather
complicated code I use to determine if I'm in state plane coordinates using
a combination of GDAL and the WKT parameters, but I wouldn't really post
that code to this mailing list.  There may be an easier way to determine if
you're in state plane coordinates.  Maybe post the link to your question on
gis.stackexchange and I can try to answer it.

Chris

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Sergey
Suloev
Sent: Friday, February 07, 2020 9:11 AM
To: Alan Snow
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Question about GDAL API: way to find out if CS
isSPCS

hi, Alan,

On 2/7/20 5:36 PM, Alan Snow wrote:
> If you use python, the pyproj CRS class can help.
>  >>> from pyproj import CRS
>  >>> crs = CRS("EPSG:26945")
>  >>> crs
> <Projected CRS: EPSG:26945>
> Name: NAD83 / California zone 5
> Axis Info [cartesian]:
> - X[east]: Easting (metre)
> - Y[north]: Northing (metre)
> Area of Use:
> - name: USA - California - SPCS83 - 5
> - bounds: (-121.42, 32.76, -114.12, 35.81)
> Coordinate Operation:
> - name: SPCS83 California zone 5 (meters)
> - method: Lambert Conic Conformal (2SP)
> Datum: North American Datum 1983
> - Ellipsoid: GRS 1980
> - Prime Meridian: Greenwich
> 
>  >>> crs.name <http://crs.name>
> 'NAD83 / California zone 5'
>  >>> crs.coordinate_operation.name <http://crs.coordinate_operation.name>
> 'SPCS83 California zone 5 (meters)'
> 
> On Fri, Feb 7, 2020 at 8:08 AM Sergey Suloev <sergey.suloev at gmail.com 
> <mailto:sergey.suloev at gmail.com>> wrote:
> 
>     Hello,
> 
>     in my project I am using GDAL to manage coordinate systems.
>     I am looking for a function/class that can tell me if a specific
>     coordinate system is a State Plane Coordinate System and give a zone
>     number.
> 
>     Thank you very much
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Alan Snow

thanks for the answer. I am using C/C++ and I was expecting to find a 
function/method like "GetSPCSZone", "IzSPCS" or similar.

Do you mean that I have to parse a coordinate system name in order to 
find required information ?

Sergey
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Fri Feb  7 09:30:00 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 07 Feb 2020 18:30:00 +0100
Subject: [gdal-dev] Question about GDAL API: way to find out if CS is
	SPCS
In-Reply-To: <3cc34fe1-b716-4252-5475-300c07d44e74@gmail.com>
References: <20ee4293-9248-980a-0c7b-1294f76943d9@gmail.com>
 <CAGybdFSLvu=p5KBrNyJ6QSEVxVeG4M0hBo7TvJLZ9V_10be80A@mail.gmail.com>
 <3cc34fe1-b716-4252-5475-300c07d44e74@gmail.com>
Message-ID: <3825056.VRL1J6RApS@even-i700>

> thanks for the answer. I am using C/C++ and I was expecting to find a
> function/method like "GetSPCSZone", "IzSPCS" or similar.

There's no such function. But you can just open the data/stateplane.csv file 
to find a match of EPSG code.

An alternative is to use exportToWkt() with WKT2 output and look at the value 
of CONVERSION[]

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From manuelhewitt at gmail.com  Sat Feb  8 03:27:11 2020
From: manuelhewitt at gmail.com (Manuel H.)
Date: Sat, 8 Feb 2020 12:27:11 +0100
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
Message-ID: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>

Hi,

I was attempting to simplify my Google Earth KML file and found ogr2ogr
mentioned on the internet.
When I run it through the program, ogr2ogr seems to ignore everything that
is a "Track" according to Google Earth. Only entries that are a "Path" are
converted. They are all GPS logs I collected over many years with different
devices. Most modern tracks have been collected with smartphones and they
are all ignored.

Is there an easy way to prevent or circumvent this?

Also, ogr2ogr flattens my KML by removing all folders and the general
hierarchy. This is annoying, but I could deal with it if I convert folders
separately.

BG,

Manuel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200208/45143ffe/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Feb  8 04:34:27 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 8 Feb 2020 05:34:27 -0700 (MST)
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
In-Reply-To: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
References: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
Message-ID: <1581165267522-0.post@n6.nabble.com>

Hi,

Could you provide some test data? If data area GPS logs, do you happen to
have they also in GPX format that might have better support in GDAL and for
example gpsbabel program?

-Jukka Rahkonen-


Manuel H. wrote
> Hi,
> 
> I was attempting to simplify my Google Earth KML file and found ogr2ogr
> mentioned on the internet.
> When I run it through the program, ogr2ogr seems to ignore everything that
> is a "Track" according to Google Earth. Only entries that are a "Path" are
> converted. They are all GPS logs I collected over many years with
> different
> devices. Most modern tracks have been collected with smartphones and they
> are all ignored.
> 
> Is there an easy way to prevent or circumvent this?
> 
> Also, ogr2ogr flattens my KML by removing all folders and the general
> hierarchy. This is annoying, but I could deal with it if I convert folders
> separately.
> 
> BG,
> 
> Manuel
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Sat Feb  8 06:44:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 08 Feb 2020 15:44:55 +0100
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
In-Reply-To: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
References: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
Message-ID: <4801301.9nCIGIpUFl@even-i700>

On samedi 8 février 2020 12:27:11 CET Manuel H. wrote:
> Hi,
> 
> I was attempting to simplify my Google Earth KML file and found ogr2ogr
> mentioned on the internet.
> When I run it through the program, ogr2ogr seems to ignore everything that
> is a "Track" according to Google Earth. Only entries that are a "Path" are
> converted. They are all GPS logs I collected over many years with different
> devices. Most modern tracks have been collected with smartphones and they
> are all ignored.
> 
> Is there an easy way to prevent or circumvent this?

Depends on which driver you use.
The older KML driver (https://gdal.org/drivers/vector/kml.html)  has no 
support for tracks
The newer LIBKML one (https://gdal.org/drivers/vector/libkml.html), based on 
libkml, has some support for tracks.

Check the first line of "ogrinfo foo.kml"

INFO: Open of `foo.kml'
      using driver `LIBKML' successful.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Sat Feb  8 10:02:33 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sat, 8 Feb 2020 18:02:33 +0000
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
Message-ID: <224c5dc49dcc4439a00ca58524852b41@C119S212VM042.msvyvi.vaha.local>

Hi,

Please answer with “reply-all” so your mails go also back to the list.

GDAL has two drivers for KML
https://gdal.org/drivers/vector/kml.html
https://gdal.org/drivers/vector/libkml.html#vector-libkml

KML driver finds only one layer from your data
ogrinfo --config gdal_skip libkml testcase.kml
INFO: Open of `testcase.kml'
      using driver `KML' successful.
1: Stuttgart-Schweiz (3D Line String)

LIBKML driver finds 4 layers

ogrinfo testcase.kml
INFO: Open of `testcase.kml'
      using driver `LIBKML' successful.
1: Tempor├ñre Orte
2: Stuttgart-Schweiz
3: GPS device
4: Tracks

Layers 1 and 3 do not contain data but layers 2 and 4 do.

It seems that you are using GDAL which either does not have LIBKML driver or it appears in the list of formats after KML. Check the drivers with command ogrinfo --formats. If you don’t have LIBKML you must get such GDAL build that has the driver. If you have both KML and LIBKML in that order, you must skip the KML driver with config option --config GDAL_SKIP KML.

-Jukka Rahkonen-


Lähettäjä: Manuel H. <manuelhewitt at gmail.com>
Lähetetty: lauantai 8. helmikuuta 2020 14.50
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] ogr2ogr ignoring tracks, only converting paths

Test data with a track and a path. After simplification only the path is left:  https://filebin.net/xp0qi0cfm4bs08cw

The newer tracks I should have as GPX tracks, but likely not the old ones. I surely could simplify new ones before adding them to Google Earth, but I was looking for a way to simplify all the old data as easily as possible. I wanted to prevent having to export each track manually and then run it through a program before piecing it back together. My KML is over 80MB.

Am Sa., 8. Feb. 2020 um 13:34 Uhr schrieb jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>:
Hi,

Could you provide some test data? If data area GPS logs, do you happen to
have they also in GPX format that might have better support in GDAL and for
example gpsbabel program?

-Jukka Rahkonen-


Manuel H. wrote
> Hi,
>
> I was attempting to simplify my Google Earth KML file and found ogr2ogr
> mentioned on the internet.
> When I run it through the program, ogr2ogr seems to ignore everything that
> is a "Track" according to Google Earth. Only entries that are a "Path" are
> converted. They are all GPS logs I collected over many years with
> different
> devices. Most modern tracks have been collected with smartphones and they
> are all ignored.
>
> Is there an easy way to prevent or circumvent this?
>
> Also, ogr2ogr flattens my KML by removing all folders and the general
> hierarchy. This is annoying, but I could deal with it if I convert folders
> separately.
>
> BG,
>
> Manuel
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200208/cc4372db/attachment.html>

From manuelhewitt at gmail.com  Sat Feb  8 14:55:22 2020
From: manuelhewitt at gmail.com (Manuel H.)
Date: Sat, 8 Feb 2020 23:55:22 +0100
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
In-Reply-To: <4801301.9nCIGIpUFl@even-i700>
References: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
 <4801301.9nCIGIpUFl@even-i700>
Message-ID: <CAGMh49w77hfY_dfx1X1B7M-6J-+W0jYD_FP9grxCvFkd8a3p8Q@mail.gmail.com>

It says it uses KML.
Well, I followed your links and the LIBKML driver seems to be abandoned for
many years. It's not worth it for me trying to set up a whole development
environment just for this.

Am Sa., 8. Feb. 2020 um 15:44 Uhr schrieb Even Rouault <
even.rouault at spatialys.com>:

> On samedi 8 février 2020 12:27:11 CET Manuel H. wrote:
> > Hi,
> >
> > I was attempting to simplify my Google Earth KML file and found ogr2ogr
> > mentioned on the internet.
> > When I run it through the program, ogr2ogr seems to ignore everything
> that
> > is a "Track" according to Google Earth. Only entries that are a "Path"
> are
> > converted. They are all GPS logs I collected over many years with
> different
> > devices. Most modern tracks have been collected with smartphones and they
> > are all ignored.
> >
> > Is there an easy way to prevent or circumvent this?
>
> Depends on which driver you use.
> The older KML driver (https://gdal.org/drivers/vector/kml.html)  has no
> support for tracks
> The newer LIBKML one (https://gdal.org/drivers/vector/libkml.html), based
> on
> libkml, has some support for tracks.
>
> Check the first line of "ogrinfo foo.kml"
>
> INFO: Open of `foo.kml'
>       using driver `LIBKML' successful.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200208/a3cceabe/attachment.html>

From even.rouault at spatialys.com  Sat Feb  8 15:17:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 09 Feb 2020 00:17:07 +0100
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
In-Reply-To: <CAGMh49w77hfY_dfx1X1B7M-6J-+W0jYD_FP9grxCvFkd8a3p8Q@mail.gmail.com>
References: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
 <4801301.9nCIGIpUFl@even-i700>
 <CAGMh49w77hfY_dfx1X1B7M-6J-+W0jYD_FP9grxCvFkd8a3p8Q@mail.gmail.com>
Message-ID: <1626374.tv2yneTPIK@even-i700>

On samedi 8 février 2020 23:55:22 CET Manuel H. wrote:
> It says it uses KML.
> Well, I followed your links and the LIBKML driver seems to be abandoned for
> many years.

You're talking about https://github.com/google/libkml ? Yes this one was 
abandoned.
Community took over in https://github.com/libkml/libkml which let to a bit 
more recent libkml 1.3 release which is packaged by some Linux distributions 
and can be used to build GDAL against (admitedly libkml/libkml is pretty much 
stalled too)
I've just updated the GDAL driver doc to point to this latest repository.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dbakeman at comcast.net  Sat Feb  8 17:41:46 2020
From: dbakeman at comcast.net (David J. Bakeman)
Date: Sat, 8 Feb 2020 17:41:46 -0800
Subject: [gdal-dev] ogr2ogr ignoring tracks, only converting paths
In-Reply-To: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
References: <CAGMh49y_+OYjxDtEftA7i-yDBZKUBgqqR0Pgg9oDg3eb=v53NQ@mail.gmail.com>
Message-ID: <a7d8b2c4-f178-f15f-ce20-41cdd8e1d2d8@comcast.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200208/78325561/attachment.html>

From gdal-dev_glendeni at drjack.info  Sun Feb  9 14:21:48 2020
From: gdal-dev_glendeni at drjack.info (Jack Glendening)
Date: Sun, 09 Feb 2020 14:21:48 -0800
Subject: [gdal-dev] gdalwarp -dstalpha does not create alpha band
Message-ID: <1581286908.13493.40.camel@HP-GLENDENI>

For gdalwarp (GDAL 2.3.1), using -dstalpha (hoping to get transparent
pixels outside the original image area) ala 

 gdalwarp -dstalpha -srcnodata 0 -t_srs EPSG:4326 in.tif out.tif 

for an input geotiff RGB image (created by gdal_translate) I get an RGB
output image, not an RGBA as I expected. From googling, it appears
-dstalpha works for others. This seems so simple, cannot understand
what could be going wrong.

Jack 



From even.rouault at spatialys.com  Mon Feb 10 00:56:24 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Feb 2020 09:56:24 +0100
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <4816617.FNJc4Uo8ek@even-i700>
References: <4816617.FNJc4Uo8ek@even-i700>
Message-ID: <1779421.lmLRqVldIr@even-i700>

Hi,

So looking at https://github.com/OSGeo/gdal/issues/2117, it seems we didn't 
get more proposals than the ones from 2 weeks ago. There are 3 proposals in 
the initial post of the ticket: nirvn_v1, nirvn_v2 and nirvn_v3
In https://github.com/OSGeo/gdal/issues/2117#issuecomment-570059241 , there's 
also a variant of nirvn_v3 with the compas/satellite replacing the A.

Thoughts ? (PSC and community)

Even

> Hi,
> 
> A number of people have expressed a wish to refresh GDAL's logo and have
> already submitted ideas in https://github.com/OSGeo/gdal/issues/2117
> 
> In order to make the topic advance in a positive way, I suggest the
> following guidelines for an informal contest starting now:
> - Propositions must be added to the above ticket until February 8 any time
> zone. In the spirit of "release early release often", it is suggested that
> people don't wait until the deadline so as to benefit from community
> feedback and potentially improve their proposals.
> - Each proposition must be clearly associated with a "${person_name}_$
> {unique_id}" identifier so we can unambiguously reference propositions.
> - A same person can issue any number of propositions.
> - Community members are invited to express their preferences in the ticket.
> - PSC will have final word on adopting a proposition or keeping the current
> logo if no clear concensus emerges. I hope other PSC members have better
> visual judgment than me to evaluate propositions ;-)
> - The selected proposition will have to be ultimately released as SVG
> readable by FOSS tools. With a color & back-white version
> - The selected proposition will have to be ultimately licensed under CC0 /
> Public domain for the sake of simplicity of use. For due credit, the author
> will be more than welcome to indicate its authorship, typically in rdf
> metadata, as was done for the PROJ logo (*)
> - Perhaps I've forgotten rules that will be added later. Hence the informal
> contest :-)
> 
> Happy sketching,
> 
> Even
> 
> (*) https://raw.githubusercontent.com/OSGeo/PROJ/master/media/logo.svg
> 
> PS: I would have appreciated if someone else from the community had taken
> the lead on writing this email, as suggested in the ticket. Don't be shy.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb 10 01:26:41 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 10 Feb 2020 02:26:41 -0700 (MST)
Subject: [gdal-dev] gdalwarp -dstalpha does not create alpha band
In-Reply-To: <1581286908.13493.40.camel@HP-GLENDENI>
References: <1581286908.13493.40.camel@HP-GLENDENI>
Message-ID: <1581326801202-0.post@n6.nabble.com>


Hi,

It does really work for others. I just verified with GDAL 3.1.0dev and 2.4.2
on Windows. Could you repeat the test carefully with the bare minimum

gdalwarp -dstalpha without_alpha.tif with_alpha.tif

If it does not work please arrange a reproducible test case for us by
telling how to get exactly same GDAL version as you have, and point same
source tiff file as input.

-Jukka Rahkonen-


Jack Glendening wrote
> For gdalwarp (GDAL 2.3.1), using -dstalpha (hoping to get transparent
> pixels outside the original image area) ala 
> 
>  gdalwarp -dstalpha -srcnodata 0 -t_srs EPSG:4326 in.tif out.tif 
> 
> for an input geotiff RGB image (created by gdal_translate) I get an RGB
> output image, not an RGBA as I expected. From googling, it appears
> -dstalpha works for others. This seems so simple, cannot understand
> what could be going wrong.
> 
> Jack 
> 
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Feb 10 02:28:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Feb 2020 11:28:55 +0100
Subject: [gdal-dev] OGRCreateCoordinateTransformation problem on GDAL
	3.0.3 and PROJ 6.3.0
In-Reply-To: <7396512.jYUACzATW9@even-i700>
References: <18f4178c-72d1-556c-4390-0b569d6bf082@uni-muenster.de>
 <9078d446-3c0b-856f-ff66-a2fd40cfbc51@uni-muenster.de>
 <7396512.jYUACzATW9@even-i700>
Message-ID: <3693324.rtXfsxraRt@even-i700>

On jeudi 23 janvier 2020 18:43:24 CET Even Rouault wrote:
> On jeudi 23 janvier 2020 18:35:40 CET Edzer Pebesma wrote:
> > On 1/23/20 5:58 PM, Even Rouault wrote:
> > >> Thanks! Yes, with SRS->importFromUserInput("EPSG:3857"); etc this works
> > >> fine; I'm OK with the warning, I just don't see how the subsequent
> > >> error
> > >> relates to syntax that is deprecated.
> > > 
> > > I'm looking at this, but haven't yet an explanation. This is very
> > > subtle,
> > > and seems to be linked specifically to EPSG:3857
> 
> OK, memory helping, I finally identified the root cause. This is a bug in
> PROJ. Fix submitted per https://github.com/OSGeo/PROJ/pull/1873

PROJ 6.3.1 release candidate shipping the fix announced at:
https://lists.osgeo.org/pipermail/proj/2020-February/009360.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From chris.marsh at usask.ca  Mon Feb 10 05:39:03 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Mon, 10 Feb 2020 13:39:03 +0000
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <1779421.lmLRqVldIr@even-i700>
References: <4816617.FNJc4Uo8ek@even-i700> <1779421.lmLRqVldIr@even-i700>
Message-ID: <CAFgDerHB1+pqdUbB46HczsXa9S--XiVZ-+kx=YQ0-NHwwhEXkw@mail.gmail.com>


I personally like nirvn_v2

On Mon, Feb 10, 2020 at 01:56 Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>


Hi,

So looking at https://github.com/OSGeo/gdal/issues/2117, it seems we didn't
get more proposals than the ones from 2 weeks ago. There are 3 proposals in
the initial post of the ticket: nirvn_v1, nirvn_v2 and nirvn_v3
In https://github.com/OSGeo/gdal/issues/2117#issuecomment-570059241 , there's
also a variant of nirvn_v3 with the compas/satellite replacing the A.

Thoughts ? (PSC and community)

Even

> Hi,
>
> A number of people have expressed a wish to refresh GDAL's logo and have
> already submitted ideas in https://github.com/OSGeo/gdal/issues/2117
>
> In order to make the topic advance in a positive way, I suggest the
> following guidelines for an informal contest starting now:
> - Propositions must be added to the above ticket until February 8 any time
> zone. In the spirit of "release early release often", it is suggested that
> people don't wait until the deadline so as to benefit from community
> feedback and potentially improve their proposals.
> - Each proposition must be clearly associated with a "${person_name}_$
> {unique_id}" identifier so we can unambiguously reference propositions.
> - A same person can issue any number of propositions.
> - Community members are invited to express their preferences in the ticket.
> - PSC will have final word on adopting a proposition or keeping the current
> logo if no clear concensus emerges. I hope other PSC members have better
> visual judgment than me to evaluate propositions ;-)
> - The selected proposition will have to be ultimately released as SVG
> readable by FOSS tools. With a color & back-white version
> - The selected proposition will have to be ultimately licensed under CC0 /
> Public domain for the sake of simplicity of use. For due credit, the author
> will be more than welcome to indicate its authorship, typically in rdf
> metadata, as was done for the PROJ logo (*)
> - Perhaps I've forgotten rules that will be added later. Hence the informal
> contest :-)
>
> Happy sketching,
>
> Even
>
> (*) https://raw.githubusercontent.com/OSGeo/PROJ/master/media/logo.svg
>
> PS: I would have appreciated if someone else from the community had taken
> the lead on writing this email, as suggested in the ticket. Don't be shy.


--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
--
Chris Marsh, PhD
University of Saskatchewan
chrismarsh.ca<http://chrismarsh.ca/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200210/627c895c/attachment-0001.html>

From sean at mapbox.com  Mon Feb 10 13:30:04 2020
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 10 Feb 2020 14:30:04 -0700
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <1779421.lmLRqVldIr@even-i700>
References: <4816617.FNJc4Uo8ek@even-i700> <1779421.lmLRqVldIr@even-i700>
Message-ID: <CADPhZXw6sfLwhrbOKpGvmGDp7KZT2Xpz9T5x5OVPogVgyX5Lbw@mail.gmail.com>

Hi Even,

On Mon, Feb 10, 2020 at 1:56 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> So looking at https://github.com/OSGeo/gdal/issues/2117, it seems we
> didn't
> get more proposals than the ones from 2 weeks ago. There are 3 proposals
> in
> the initial post of the ticket: nirvn_v1, nirvn_v2 and nirvn_v3
> In https://github.com/OSGeo/gdal/issues/2117#issuecomment-570059241 ,
> there's
> also a variant of nirvn_v3 with the compas/satellite replacing the A.
>
> Thoughts ? (PSC and community)
>

Of the three proposals I'm -1 on v1, +0 on v2, -0 on v3. I'm not a fan of
the green (our planet is blue, no?) and I think the kerning in "G D A L"
could be improved upon, it's too loose for my taste. I appreciate the work
that's gone into the designs, for sure.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200210/782da48e/attachment.html>

From jmckenna at gatewaygeomatics.com  Mon Feb 10 14:12:30 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 10 Feb 2020 18:12:30 -0400
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <1779421.lmLRqVldIr@even-i700>
References: <4816617.FNJc4Uo8ek@even-i700> <1779421.lmLRqVldIr@even-i700>
Message-ID: <dbad900d-a3f1-abff-ca73-a73630b50b06@gatewaygeomatics.com>

On 2020-02-10 4:56 a.m., Even Rouault wrote:
> So looking at https://github.com/OSGeo/gdal/issues/2117, it seems we didn't
> get more proposals than the ones from 2 weeks ago. There are 3 proposals in
> the initial post of the ticket: nirvn_v1, nirvn_v2 and nirvn_v3
> In https://github.com/OSGeo/gdal/issues/2117#issuecomment-570059241 , there's
> also a variant of nirvn_v3 with the compas/satellite replacing the A.
> 

Hi Even,

I prefer nirvn_v3 (with the solar panels, which reference the original 
GDAL logo).  I am not a fan of the A in "GDAL" being replaced by that 
symbol.

-jeff



From mateusz at loskot.net  Mon Feb 10 14:25:37 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 10 Feb 2020 23:25:37 +0100
Subject: [gdal-dev] Refreshing GDAL's logo
In-Reply-To: <CADPhZXw6sfLwhrbOKpGvmGDp7KZT2Xpz9T5x5OVPogVgyX5Lbw@mail.gmail.com>
References: <4816617.FNJc4Uo8ek@even-i700> <1779421.lmLRqVldIr@even-i700>
 <CADPhZXw6sfLwhrbOKpGvmGDp7KZT2Xpz9T5x5OVPogVgyX5Lbw@mail.gmail.com>
Message-ID: <CABUeae8iYpu8DD-CB56KMSmv7W1ZN99MA_3zad0NQhqY6txPCQ@mail.gmail.com>

On Mon, 10 Feb 2020 at 22:30, Sean Gillies <sean at mapbox.com> wrote:
> On Mon, Feb 10, 2020 at 1:56 AM Even Rouault <even.rouault at spatialys.com> wrote:
>>
>> So looking at https://github.com/OSGeo/gdal/issues/2117, it seems we didn't
>> get more proposals than the ones from 2 weeks ago. There are 3 proposals in
>> the initial post of the ticket: nirvn_v1, nirvn_v2 and nirvn_v3
>> In https://github.com/OSGeo/gdal/issues/2117#issuecomment-570059241 , there's
>> also a variant of nirvn_v3 with the compas/satellite replacing the A.
>>
>> Thoughts ? (PSC and community)
>
>
> Of the three proposals I'm -1 on v1, +0 on v2, -0 on v3.

Likewise, I'm happy to copy Sean's scoring as my own.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From idan at miara.com  Tue Feb 11 05:08:48 2020
From: idan at miara.com (Idan Miara)
Date: Tue, 11 Feb 2020 15:08:48 +0200
Subject: [gdal-dev] Python: MEM inputs to warp and DEMProcessing
Message-ID: <CAEDrt3-x-hpPJncvYC7BKp-i6R88K=RQsR0PACW8cEQJavmGVQ@mail.gmail.com>

Hi,

I'm using gdal python API with the following functions:
1.  gdal.warp with a cutline input
2.  gdal.DEMProcessing in 'color-relief' mode

I receive the cutline as WKT and the color file as text, thus to use these
functions I needed to create an OGR file and a color palette text file.

Is there a workaround without writing these files to disk?
i.e. pass the cutline MEM DS or as string and the color palette as string?
Or maybe with VSI?

Kind regards,
Idan.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200211/0ff98c7a/attachment.html>

From dirk.vdb at gmail.com  Tue Feb 11 12:14:20 2020
From: dirk.vdb at gmail.com (Dirk Vanden Boer)
Date: Tue, 11 Feb 2020 21:14:20 +0100
Subject: [gdal-dev] GDALDataset::CopyLayer options handling causing crash
Message-ID: <CADuK5a2cPpdSNt7EUqQVYkP_XcrAGPqaL1ZASN7FruLR3bCq1w@mail.gmail.com>

I get a crash when calling the CopyLayer function.
Pseudo code:
char** options = CSLAddString(nullptr, "DST_SRSWKT=some_wkt");
ds->CopyLayer(srcLayer, "newname", options);
CSLDestroy(options);

Inside GDALDataset::CopyLayer the DST_SRSWKT option is removed from the
list:
// Remove DST_WKT from option list to prevent warning from driver.
const int nSRSPos = CSLFindName(papszOptions, "DST_SRSWKT");
papszOptions = CSLRemoveStrings(papszOptions, nSRSPos, 1, nullptr);

But since this is the only option CSLDestroy is called on the options
pointer.
So the CSLDestroy(options) after the copy causes a crash since the memory
is deleted twice.

How is this supported to be handled? How can the caller know the options
array has been destroyed by the CopyLayer function?

Kind regards,
Dirk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200211/29f65cac/attachment.html>

From even.rouault at spatialys.com  Tue Feb 11 12:55:32 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Feb 2020 21:55:32 +0100
Subject: [gdal-dev] GDALDataset::CopyLayer options handling causing crash
In-Reply-To: <CADuK5a2cPpdSNt7EUqQVYkP_XcrAGPqaL1ZASN7FruLR3bCq1w@mail.gmail.com>
References: <CADuK5a2cPpdSNt7EUqQVYkP_XcrAGPqaL1ZASN7FruLR3bCq1w@mail.gmail.com>
Message-ID: <4759237.vyQTNn1GFD@even-i700>

Dirk,

> How is this supported to be handled? How can the caller know the options
> array has been destroyed by the CopyLayer function?

This is a GDAL bug. This couldn't work. And there was no test for this 
feature.
Fix & small test just committed in master and 3.0 branch

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julio.esquerdo at embrapa.br  Tue Feb 11 13:15:33 2020
From: julio.esquerdo at embrapa.br (=?iso-8859-1?Q?J=FAlio_C=E9sar_D=2E_M=2E?= Esquerdo)
Date: Tue, 11 Feb 2020 18:15:33 -0300 (BRT)
Subject: [gdal-dev] Stacking JP2 files
In-Reply-To: <1625000567.6376159.1581455035257.JavaMail.root@embrapa.br>
Message-ID: <201339513.6377634.1581455733094.JavaMail.root@embrapa.br>

Hello, 

I'm using gdal_merge.py to stack a set of JP2 rasters with the following command line:

gdal_merge.py *jp2 -o output.jp2 -of JP2OpenJPEG -separate 

It didn't work. I got the message: "Format driver JP2OpenJPEG does not support creation and piecewise writing".

The command works fine for GTiff rasters, but not with JP2 files.

Is it possible to stack very compressed JP2 files using GDAL? 

Thanks,

Best Regards,

Julio Esquerdo



____________________________________________________________________________
Aviso de confidencialidade

Esta mensagem da Empresa  Brasileira de Pesquisa  Agropecuaria (Embrapa),
empresa publica federal  regida pelo disposto  na Lei Federal no. 5.851,  de
7 de dezembro de 1972,  e  enviada exclusivamente  a seu destinatario e pode
conter informacoes  confidenciais, protegidas  por sigilo profissional.  Sua
utilizacao desautorizada  e ilegal e  sujeita o infrator as penas da lei. Se
voce  a recebeu indevidamente, queira, por gentileza, reenvia-la ao
emitente, esclarecendo o equivoco.

Confidentiality note

This message from Empresa  Brasileira de Pesquisa  Agropecuaria (Embrapa),
a government company  established under  Brazilian law (5.851/72), is
directed exclusively to  its addressee  and may contain confidential data, 
protected under  professional secrecy  rules. Its unauthorized  use is
illegal and  may subject the transgressor to the law's penalties. If you are
not the addressee, please send it back, elucidating the failure.


From even.rouault at spatialys.com  Tue Feb 11 13:27:25 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Feb 2020 22:27:25 +0100
Subject: [gdal-dev] Stacking JP2 files
In-Reply-To: <201339513.6377634.1581455733094.JavaMail.root@embrapa.br>
References: <201339513.6377634.1581455733094.JavaMail.root@embrapa.br>
Message-ID: <8959126.ThMEBKy9tG@even-i700>

On mardi 11 février 2020 18:15:33 CET Júlio César D. M. Esquerdo wrote:
> Hello,
> 
> I'm using gdal_merge.py to stack a set of JP2 rasters with the following
> command line:
> 
> gdal_merge.py *jp2 -o output.jp2 -of JP2OpenJPEG -separate
> 
> It didn't work. I got the message: "Format driver JP2OpenJPEG does not
> support creation and piecewise writing".
> 
> The command works fine for GTiff rasters, but not with JP2 files.
> 
> Is it possible to stack very compressed JP2 files using GDAL?

With gdal_merge.py you can't directly output to JPEG2000 since the output 
format of gdal_merge.py must have random write capabilities, which isn't 
compatible of JPEG2000. A solution would be to output to GeoTIFF and use 
gdal_translate to convert the GeoTIFF to JPEG2000

Or isnstead of gdal_merge, can use gdalbuildvrt -separate to create a VRT 
file, and use gdal_translate to convert it to JPEG2000. That will save you the 
materialization of a GeoTIFF file

In theory it could be possible to stack several JPEG2000 files in a single one 
without any loss, but you'd need to use specialized tools for that.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From glendening at drjack.net  Tue Feb 11 19:24:52 2020
From: glendening at drjack.net (John W. Glendening)
Date: Tue, 11 Feb 2020 19:24:52 -0800
Subject: [gdal-dev] gdalwarp -dstalpha does not create alpha band
In-Reply-To: <1581326801202-0.post@n6.nabble.com>
References: <1581286908.13493.40.camel@HP-GLENDENI>
 <1581326801202-0.post@n6.nabble.com>
Message-ID: <1581477892.9810.7.camel@HP-GLENDENI>

Jukka

After reading your message assuring me that -dstalpha does work for
others, and since what I was doing seemed so basic, I decided to
re-boot my computer and try again (I have recently been using some
large graphics files).  Lo and behold I am now getting the expected
result, transparency outside the original image area.  :-)  Thanks for
your response.

Jack


On Mon, 2020-02-10 at 02:26 -0700, jratike80 wrote:
> Hi,
> 
> It does really work for others. I just verified with GDAL 3.1.0dev and 2.4.2
> on Windows. Could you repeat the test carefully with the bare minimum
> 
> gdalwarp -dstalpha without_alpha.tif with_alpha.tif
> 
> If it does not work please arrange a reproducible test case for us by
> telling how to get exactly same GDAL version as you have, and point same
> source tiff file as input.
> 
> -Jukka Rahkonen-
> 
> 
> Jack Glendening wrote
> > For gdalwarp (GDAL 2.3.1), using -dstalpha (hoping to get transparent
> > pixels outside the original image area) ala 
> > 
> >  gdalwarp -dstalpha -srcnodata 0 -t_srs EPSG:4326 in.tif out.tif 
> > 
> > for an input geotiff RGB image (created by gdal_translate) I get an RGB
> > output image, not an RGBA as I expected. From googling, it appears
> > -dstalpha works for others. This seems so simple, cannot understand
> > what could be going wrong.
> > 
> > Jack 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> 
> > gdal-dev at .osgeo
> 
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
John W. (Jack) Glendening  831-484-6929
25953 Deer Run Lane  Salinas, CA  93908


From jukka.rahkonen at maanmittauslaitos.fi  Thu Feb 13 13:06:57 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 13 Feb 2020 21:06:57 +0000
Subject: [gdal-dev] How far can we resolve complex GeoJSON?
Message-ID: <94c78cfe16db4b5aa3568cdea5a27d10@C119S212VM042.msvyvi.vaha.local>

Hi,

Have a look at data returned by request https://beta-paikkatieto.maanmittauslaitos.fi/geographic-names/wfs3/v1/collections/placenames/items?municipality=837&limit=100
There exists couple of features with "parallelName" and GDAL converts that part into a string type attribute

  parallelName (String) = [ { "placeNameId": 40581553, "placeNameVersionId": 2, "spelling": "Pirkkahalli", "language": "fin", "languageOfficiality": 1, "languageDominance": 1, "placeNameSource": 1, "placeNameStatus": 5, "placeNameCreationTime": "2008-12-05T22:00:00Z", "placeNameModificationTime": "2017-02-15T10:41:10Z", "placeNameDeletionTime": null } ]

Can we do anything else with GDAL and GeoJSON driver? I suppose it does not same kind of advanced features like GMLAS driver has.
Here is one placename as an example. A place can have zero to n parallel names.

{
      "type": "Feature",
      "id": "PN_40581553",
      "properties": {
        "placeNameId": 40581553,
        "placeNameVersionId": 2,
        "spelling": "Pirkkahalli",
        "language": "fin",
        "languageOfficiality": 1,
        "languageDominance": 1,
        "placeNameSource": 1,
        "placeNameStatus": 5,
        "placeNameCreationTime": "2008-12-05T22:00:00Z",
        "placeNameModificationTime": "2017-02-15T10:41:10Z",
        "placeNameDeletionTime": null,
        "placeId": 10581553,
        "placeVersionId": 2,
        "placeType": 8010105,
        "placeTypeDescription": 8010105,
        "placeTypeCategory": 8,
        "placeTypeGroup": 801,
        "placeTypeSubgroup": 80101,
        "placeElevation": 81,
        "tm35MapSheet": "M4211F3",
        "gslsMapSheet": "212308D",
        "rescueGridSquare": "21N4B3",
        "municipality": "837",
        "subregion": "064",
        "region": "06",
        "scaleRelevance": 50000,
        "placeCreationTime": "2008-12-05T22:00:00Z",
        "placeModificationTime": "2014-08-01T13:47:38Z",
        "placeDeletionTime": null,
        "parallelName": [
          {
            "placeNameId": 42003784,
            "placeNameVersionId": 3,
            "spelling": "Tampereen messu- ja urheilukeskus",
            "language": "fin",
            "languageOfficiality": 1,
            "languageDominance": 1,
            "placeNameSource": 1,
            "placeNameStatus": 3,
            "placeNameCreationTime": "2017-02-02T13:53:12Z",
            "placeNameModificationTime": "2017-02-15T14:34:47Z",
            "placeNameDeletionTime": null
          }
        ]
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          23.7323985,
          61.4640113
        ]
      }
    }

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200213/f772595e/attachment.html>

From even.rouault at spatialys.com  Thu Feb 13 15:43:49 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 00:43:49 +0100
Subject: [gdal-dev] How far can we resolve complex GeoJSON?
In-Reply-To: <94c78cfe16db4b5aa3568cdea5a27d10@C119S212VM042.msvyvi.vaha.local>
References: <94c78cfe16db4b5aa3568cdea5a27d10@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2316572.omusGTGv1v@even-i700>

On jeudi 13 février 2020 21:06:57 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Have a look at data returned by request
> https://beta-paikkatieto.maanmittauslaitos.fi/geographic-names/wfs3/v1/coll
> ections/placenames/items?municipality=837&limit=100 There exists couple of
> features with "parallelName" and GDAL converts that part into a string type
> attribute

-oo FLATTEN_NESTED_ATTRIBUTES=YES can improve things for a property that is a 
JSon object/dictionary, but not here because parallelName content is an array.
> 
>   parallelName (String) = [ { "placeNameId": 40581553, "placeNameVersionId":
> 2, "spelling": "Pirkkahalli", "language": "fin", "languageOfficiality": 1,
> "languageDominance": 1, "placeNameSource": 1, "placeNameStatus": 5,
> "placeNameCreationTime": "2008-12-05T22:00:00Z",
> "placeNameModificationTime": "2017-02-15T10:41:10Z",
> "placeNameDeletionTime": null } ]
> 
> Can we do anything else with GDAL and GeoJSON driver? I suppose it does not
> same kind of advanced features like GMLAS driver has.

Indeed. The GeoJSON driver cannot create auxiliary layers for nested objects. 
Thinking that a fun exercise would be to write a script that would convert the 
GeoJSON content into XML (there are already utilities to do that) and generate 
a XML schema. And then feed that into GMLAS. Sounds fun, doesn't it ;-) ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stephane.brunner at camptocamp.com  Fri Feb 14 05:14:41 2020
From: stephane.brunner at camptocamp.com (=?UTF-8?Q?St=C3=A9phane_Brunner?=)
Date: Fri, 14 Feb 2020 14:14:41 +0100
Subject: [gdal-dev] Docker images
Message-ID: <CAChDcoRD7hcMEhmZarRuKJrkwb-=JvMD3ju2F27P-Pz+FOEN+A@mail.gmail.com>

Hello,

Now we get a relay nice Docker images with GDAL, but I have tow questions:
- How is the security is managed in those Docker images?
- How will new versions of distributions be managed?

CU and thanks in advance
Stéphane Brunner

-- 

*Stéphane Brunner*
Geospatial Solutions
Software Developer

*camptocamp*
INNOVATIVE SOLUTIONS
BY OPEN SOURCE EXPERTS

camptocamp.com
mapfish.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200214/d29d41f7/attachment-0001.html>

From jachym.cepicky at gmail.com  Fri Feb 14 07:09:02 2020
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Fri, 14 Feb 2020 16:09:02 +0100
Subject: [gdal-dev] postgis raster driver
Message-ID: <CAAZUH4FS6K4_dsc1vjJbSyzSyX0YE-G_aqfRq=ihEiOaN3ZPEQ@mail.gmail.com>

Hi Developers,

how up-to-date is this page:

https://trac.osgeo.org/gdal/wiki/frmts_wtkraster.html ?

Log says, it's about 6 years old now.

It also says, among other things,

The GDAL PostGIS Raster driver does not support writing raster to the
database yet. But you can load raster data in the database in 2 ways:

Using raster2pgsql to load rasters
Creating rasters using PostGIS Raster functions
The write support to GDAL PostGIS Raster driver is under developme

Is this still valid? How much work is needed, to be able to use
gdalwarp instead of raster2pgsql ?

Thank you

Jachym

-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/pgp/JachymCepicky.pgp

From square_cube at hotmail.com  Fri Feb 14 08:28:23 2020
From: square_cube at hotmail.com (Square Cube)
Date: Fri, 14 Feb 2020 16:28:23 +0000
Subject: [gdal-dev] Pass >1 geometry field via ODBC
Message-ID: <DB7PR04MB4681C569087263D7DC4BE9BE80150@DB7PR04MB4681.eurprd04.prod.outlook.com>

I am using QGis to read records from a database via ODBC. Each record contains spatial information in the main table in WKT format, and the database also has a Geometry_Columns table that defines
f_geometry_column
f_table_catalogue
f_table_name
geometry_type

This works fine, and QGis is able to plot data straight from the database. 

The database was recently modified and now has two fields of spatial information (point and line) both in WKT format. I can get QGis to read either of these by modifying the single record in the 
Geometry_Columns table.  

If there are two records in the Geometry_Columns table, QGis will only read the WKT field defined in the first record. 

Is this a limitation of the ODBC driver? Or is there a specific way to pass >1 geometry field from a table to QGis via ODBC?

Grateful for any assistance 




From sean at mapbox.com  Fri Feb 14 08:39:29 2020
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 14 Feb 2020 09:39:29 -0700
Subject: [gdal-dev] How far can we resolve complex GeoJSON?
In-Reply-To: <2316572.omusGTGv1v@even-i700>
References: <94c78cfe16db4b5aa3568cdea5a27d10@C119S212VM042.msvyvi.vaha.local>
 <2316572.omusGTGv1v@even-i700>
Message-ID: <CADPhZXzhamJFvW_QATNK4CiFDNv-MkSsgiuZ5jS-s_ma0PKktw@mail.gmail.com>

Hi Jukka, Even,

On Thu, Feb 13, 2020 at 4:43 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 13 février 2020 21:06:57 CET Rahkonen Jukka (MML) wrote:
> > Hi,
> >
> > Have a look at data returned by request
> >
> https://beta-paikkatieto.maanmittauslaitos.fi/geographic-names/wfs3/v1/coll
> > ections/placenames/items?municipality=837&limit=100 There exists couple
> of
> > features with "parallelName" and GDAL converts that part into a string
> type
> > attribute
>
> -oo FLATTEN_NESTED_ATTRIBUTES=YES can improve things for a property that
> is a
> JSon object/dictionary, but not here because parallelName content is an
> array.
> >
> >   parallelName (String) = [ { "placeNameId": 40581553,
> "placeNameVersionId":
> > 2, "spelling": "Pirkkahalli", "language": "fin", "languageOfficiality":
> 1,
> > "languageDominance": 1, "placeNameSource": 1, "placeNameStatus": 5,
> > "placeNameCreationTime": "2008-12-05T22:00:00Z",
> > "placeNameModificationTime": "2017-02-15T10:41:10Z",
> > "placeNameDeletionTime": null } ]
> >
> > Can we do anything else with GDAL and GeoJSON driver? I suppose it does
> not
> > same kind of advanced features like GMLAS driver has.
>
> Indeed. The GeoJSON driver cannot create auxiliary layers for nested
> objects.
> Thinking that a fun exercise would be to write a script that would convert
> the
> GeoJSON content into XML (there are already utilities to do that) and
> generate
> a XML schema. And then feed that into GMLAS. Sounds fun, doesn't it ;-) ?
>
> Even
>

If this JSON is coming from a WFS, won't there be a JSON schema of some
kind provided by the server? Would using OGR's WFS3 driver instead of
GeoJSON help?

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200214/879a58b0/attachment.html>

From joseph.risi at mdrc.org  Fri Feb 14 12:16:47 2020
From: joseph.risi at mdrc.org (Joseph Risi)
Date: Fri, 14 Feb 2020 20:16:47 +0000
Subject: [gdal-dev] Issue trying to install gdal 3.0.4 on Red Hat 8
Message-ID: <MN2PR06MB6287AFFBC3B7FDABA945A15B92150@MN2PR06MB6287.namprd06.prod.outlook.com>

I'm running Red Hat 8, and I'm trying to install gdal 3.0.4 on it.

The commands I've excuted thus far:

wget http://download.osgeo.org/gdal/3.0.4/gdal-3.0.4.tar.gz
tar zxvf gdal-3.0.4.tar.gz
cd gdal-3.0.4
./configure
sudo make install

After I run `sudo make install`, I get the following error messages:

path/to/gdal-3.0.4/.libs/libgdal.so: undefined reference to `jpeg_CreateDecompress_12`
path/to/gdal-3.0.4/.libs/libgdal.so: undefined reference to `jpeg_write_tables_12`
path/to/gdal-3.0.4/.libs/libgdal.so: undefined reference to `jpeg_start_decompress_12`
...

It continues on like this for some amount of lines all starting with `jpeg` and ending with `12` and different words in between. It finally ends with:

collect2: error: ld returned 1 exit status
make[1]: *** [GNUmakefile:82: gdalinfo] Error 1
make: *** [GNUmakefile:112: apps-target] Error 2

I'm not sure what to do or what this error even means. If anyone has any ideas, or if there is anymore information I can share, let me know.

Joseph A. Risi
Information Analyst
MDRC
200 Vesey Street, 23rd Floor
New York, NY 10281
joseph.risi at mdrc.org
Pronouns: He/Him/His
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200214/5dfd19f8/attachment.html>

From even.rouault at spatialys.com  Fri Feb 14 12:42:49 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 21:42:49 +0100
Subject: [gdal-dev] How far can we resolve complex GeoJSON?
In-Reply-To: <CADPhZXzhamJFvW_QATNK4CiFDNv-MkSsgiuZ5jS-s_ma0PKktw@mail.gmail.com>
References: <94c78cfe16db4b5aa3568cdea5a27d10@C119S212VM042.msvyvi.vaha.local>
 <2316572.omusGTGv1v@even-i700>
 <CADPhZXzhamJFvW_QATNK4CiFDNv-MkSsgiuZ5jS-s_ma0PKktw@mail.gmail.com>
Message-ID: <16851077.f8G391M7ms@even-i700>

> If this JSON is coming from a WFS, won't there be a JSON schema of some
> kind provided by the server?

The WFS3 driver has some (primitive) support for JSON schema and XML schema, 
but only for the "simple features" profile.

> Would using OGR's WFS3 driver instead of GeoJSON help?

No, it uses underneath the GeoJSON driver (and doesn't expose the open option 
I mentionned).

Dealing with complex features + streaming mode that you typically expect from 
reading from a WFS server would be a complicated (not to say impossible) 
topic.
The GMLAS driver can deal with arbitrarily large datasets, but this requires 
at least 2 reading passes for various technical reasons.

Eve

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb 14 12:50:43 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 21:50:43 +0100
Subject: [gdal-dev] Docker images
In-Reply-To: <CAChDcoRD7hcMEhmZarRuKJrkwb-=JvMD3ju2F27P-Pz+FOEN+A@mail.gmail.com>
References: <CAChDcoRD7hcMEhmZarRuKJrkwb-=JvMD3ju2F27P-Pz+FOEN+A@mail.gmail.com>
Message-ID: <1815638.AuAO8381F8@even-i700>

Stéphane,

> - How is the security is managed in those Docker images?

Basically those images are built by a nightly cron job on my machine, and I 
don't think I've docker pull'ed the base Ubuntu image in recent times, so they 
are probably outdated. Currently you'd better apt update && apt upgrade if you 
care about the security patches from the OS provider (not sure what Alpine 
does on that respect)

> - How will new versions of distributions be managed?

The usual answer: when someone is keen on updating them, pull requests gladly 
accepted, etc etc :-) For the Ubuntu based ones, I guess we should stick on 
LTR releases. For Alpine based ones, we can probably be more agressive in 
updates and switch to the latest version when it is available.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb 14 12:57:05 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 21:57:05 +0100
Subject: [gdal-dev] postgis raster driver
In-Reply-To: <CAAZUH4FS6K4_dsc1vjJbSyzSyX0YE-G_aqfRq=ihEiOaN3ZPEQ@mail.gmail.com>
References: <CAAZUH4FS6K4_dsc1vjJbSyzSyX0YE-G_aqfRq=ihEiOaN3ZPEQ@mail.gmail.com>
Message-ID: <6131347.Hjithb9Qzo@even-i700>

Jachym,

> https://trac.osgeo.org/gdal/wiki/frmts_wtkraster.html ?

https://gdal.org/drivers/raster/postgisraster.html should better reflect the 
current state.

> The GDAL PostGIS Raster driver does not support writing raster to the
> database yet.

This still holds true

> The write support to GDAL PostGIS Raster driver is under development

Not sure if it has really been in developmenet. Not to my knowledge at least.

> How much work is needed, to be able to use gdalwarp instead of raster2pgsql

It depends... PostGIS raster tables can be extremely deverse, from very 
loosely/non-constrainted (arbitrary resolution of 'patches', no tiling, etc), 
to super constrainted (tiling of tiles of same size and resolution). Updating 
/ creating a new raster table with the later (strictly constrainted) could 
perhaps be an effort of the order of one week for someone already familiar 
with GDAL & this driver in particular. I don't think writing in loosely/non-
constrainted tables would be reasonably doable.

Even 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb 14 13:04:15 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 22:04:15 +0100
Subject: [gdal-dev] Pass >1 geometry field via ODBC
In-Reply-To: <DB7PR04MB4681C569087263D7DC4BE9BE80150@DB7PR04MB4681.eurprd04.prod.outlook.com>
References: <DB7PR04MB4681C569087263D7DC4BE9BE80150@DB7PR04MB4681.eurprd04.prod.outlook.com>
Message-ID: <6227145.WoWgA1pYRT@even-i700>

> If there are two records in the Geometry_Columns table, QGis will only read
> the WKT field defined in the first record.
> 
> Is this a limitation of the ODBC driver?

Yes, the driver isn't currently designed to deal with that. Assuming that the 
schema of the Geometry_Columns has a unicity constraint on (f_table_name, 
f_geometry_column), and not f_table_name only, I suspect the driver would 
report two OGR layers (if you look at the ogrinfo output), one with each of 
the geometry column active, but with the same name, which would probably 
confuse QGIS later.

> Or is there a specific way to pass >1 geometry field from a table to QGis 
via ODBC?

Not that I can think of, apart the trick you found.

QGIS can only deal with a single geometry column per layer, but it can deal 
with OGR layers that report several geometry layers (for other drivers that 
have such capability, like PostgreSQL, SQLite, etc), by instanciating one QGIS 
layer for each geometry column.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb 14 13:37:50 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Feb 2020 22:37:50 +0100
Subject: [gdal-dev] Issue trying to install gdal 3.0.4 on Red Hat 8
In-Reply-To: <MN2PR06MB6287AFFBC3B7FDABA945A15B92150@MN2PR06MB6287.namprd06.prod.outlook.com>
References: <MN2PR06MB6287AFFBC3B7FDABA945A15B92150@MN2PR06MB6287.namprd06.prod.outlook.com>
Message-ID: <2224227.BAupRXbrDR@even-i700>

On vendredi 14 février 2020 20:16:47 CET Joseph Risi wrote:
> I'm running Red Hat 8, and I'm trying to install gdal 3.0.4 on it.
> 
> The commands I've excuted thus far:
> 
> wget http://download.osgeo.org/gdal/3.0.4/gdal-3.0.4.tar.gz
> tar zxvf gdal-3.0.4.tar.gz
> cd gdal-3.0.4
> ./configure
> sudo make install
> 
> After I run `sudo make install`, I get the following error messages:

The easiest to fix is (assuming you don't need JPEG 12 bit support):

./configure --without-jpeg12
and "make clean" before rebuilding

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From joseph.risi at mdrc.org  Fri Feb 14 13:59:14 2020
From: joseph.risi at mdrc.org (Joseph Risi)
Date: Fri, 14 Feb 2020 21:59:14 +0000
Subject: [gdal-dev] [X]Re: Issue trying to install gdal 3.0.4 on Red Hat
	8
In-Reply-To: <2224227.BAupRXbrDR@even-i700>
References: <MN2PR06MB6287AFFBC3B7FDABA945A15B92150@MN2PR06MB6287.namprd06.prod.outlook.com>,
 <2224227.BAupRXbrDR@even-i700>
Message-ID: <MN2PR06MB628741EBFB9D2B73C8929A7292150@MN2PR06MB6287.namprd06.prod.outlook.com>

Ah thank you. I found an alternative fix as well.

./configure --with-libtiff=internal --with-geotiff=internal --with-jpeg=internal --with-jpeg12

Joseph A. Risi
Information Analyst
MDRC
200 Vesey Street, 23rd Floor
New York, NY 10281
joseph.risi at mdrc.org
Pronouns: He/Him/His
________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Friday, February 14, 2020 4:37 PM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Cc: Joseph Risi <joseph.risi at mdrc.org>
Subject: [X]Re: [gdal-dev] Issue trying to install gdal 3.0.4 on Red Hat 8

On vendredi 14 février 2020 20:16:47 CET Joseph Risi wrote:
> I'm running Red Hat 8, and I'm trying to install gdal 3.0.4 on it.
>
> The commands I've excuted thus far:
>
> wget https://nam03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fdownload.osgeo.org%2Fgdal%2F3.0.4%2Fgdal-3.0.4.tar.gz&amp;data=02%7C01%7Cjoseph.risi%40mdrc.org%7C3e27a5a2530348feea9008d7b19625fc%7C3194279cbd8f4094ae73b54513b0a289%7C0%7C1%7C637173130763555057&amp;sdata=4TDTN9yHHalTnf3x88hoZ8TbfhT09X%2FZ6yMWqfZ6Xac%3D&amp;reserved=0
> tar zxvf gdal-3.0.4.tar.gz
> cd gdal-3.0.4
> ./configure
> sudo make install
>
> After I run `sudo make install`, I get the following error messages:

The easiest to fix is (assuming you don't need JPEG 12 bit support):

./configure --without-jpeg12
and "make clean" before rebuilding

--
Spatialys - Geospatial professional services
https://nam03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com&amp;data=02%7C01%7Cjoseph.risi%40mdrc.org%7C3e27a5a2530348feea9008d7b19625fc%7C3194279cbd8f4094ae73b54513b0a289%7C0%7C1%7C637173130763555057&amp;sdata=GozbtaTB6QW%2FvBjvROytRwR%2BqMWY7v8OYnHtShR3dok%3D&amp;reserved=0
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200214/4437c1a7/attachment-0001.html>

From stephane.brunner at camptocamp.com  Mon Feb 17 01:11:48 2020
From: stephane.brunner at camptocamp.com (=?UTF-8?Q?St=C3=A9phane_Brunner?=)
Date: Mon, 17 Feb 2020 10:11:48 +0100
Subject: [gdal-dev] Docker images
In-Reply-To: <1815638.AuAO8381F8@even-i700>
References: <CAChDcoRD7hcMEhmZarRuKJrkwb-=JvMD3ju2F27P-Pz+FOEN+A@mail.gmail.com>
 <1815638.AuAO8381F8@even-i700>
Message-ID: <CAChDcoTvHv-tg=C9wzjpjfZsriUyDSpNZPeADUyJK=nC62V_Ww@mail.gmail.com>

Hello,


Le ven. 14 févr. 2020 à 21:50, Even Rouault <even.rouault at spatialys.com> a
écrit :

> Stéphane,
>
> > - How is the security is managed in those Docker images?
>
> Basically those images are built by a nightly cron job on my machine, and
> I
> don't think I've docker pull'ed the base Ubuntu image in recent times, so
> they
> are probably outdated. Currently you'd better apt update && apt upgrade if
> you
> care about the security patches from the OS provider (not sure what Alpine
> does on that respect)
>

You speak about the nightly build, the 'version' build (like
ubuntu-small-3.0.4
<https://hub.docker.com/layers/osgeo/gdal/ubuntu-small-3.0.4/images/sha256-f395f6f83adc5d3279e8d0bfe443213e7a8178757e93e0bbac2153c370b09a92?context=explore>)
is generated when the release is created and never after, right?



>
> > - How will new versions of distributions be managed?
>
> The usual answer: when someone is keen on updating them, pull requests
> gladly
> accepted, etc etc :-) For the Ubuntu based ones, I guess we should stick
> on
> LTR releases. For Alpine based ones, we can probably be more agressive in
> updates and switch to the latest version when it is available.
>
> Even
>

Thanks for your responses Even
CU Stéphane


> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 

*Stéphane Brunner*
Geospatial Solutions
Software Developer

*camptocamp*
INNOVATIVE SOLUTIONS
BY OPEN SOURCE EXPERTS

camptocamp.com
mapfish.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200217/7893fdf6/attachment.html>

From jluis at ualg.pt  Mon Feb 17 09:05:37 2020
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 17 Feb 2020 17:05:37 +0000
Subject: [gdal-dev] Help with CPL_DEBUG
Message-ID: <DB8PR04MB6697819853BC0826E2F4C06DA6160@DB8PR04MB6697.eurprd04.prod.outlook.com>

Hi Even,

We are having a strange failure in one CI test of GMT that calls GDAL. The thing happens at this line

https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_gdal_librarified.c#L355
and since bUsageError comes != 0 the error message at
https://github.com/GenericMappingTools/gmt/blob/master/src/gmt_gdal_librarified.c#L268
is triggered.

Now the strange part. The code works well when run locally in either Windows, WSL and Mac but fail the CI test in Linux and Mac (and works on Windows).
I have no idea why that might happen and tried to run it with CPL_DEBUG as in

gmt grdgdal lixo.csv -R0/10/0/10 -Gjunk.nc -I0.05 -F"-a nearest -co CPL_DEBUG=ON"

(this is a mixed GMT and GDAL syntax (the part under double quotes), never mind. It just works locally)

But got no debug printouts from the CI test. Am I wrongly using the CPL_DEBUG? All GDAL versions in CI are above 2.1

Thanks

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200217/dcc3aed5/attachment.html>

From mateusz at loskot.net  Mon Feb 17 09:28:45 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 17 Feb 2020 18:28:45 +0100
Subject: [gdal-dev] Help with CPL_DEBUG
In-Reply-To: <DB8PR04MB6697819853BC0826E2F4C06DA6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <DB8PR04MB6697819853BC0826E2F4C06DA6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <CABUeae-4r5OhX7ACr4Pd=bFV9MwP0xd=hg5RhRmEuZ0bBOabwg@mail.gmail.com>

On Mon, 17 Feb 2020 at 18:05, Joaquim Manuel Freire Luís <jluis at ualg.pt> wrote:
>
> Hi Even,

FYI, you have e-mailed the public gdal-dev mailing list.

> I have no idea why that might happen and tried to run it with CPL_DEBUG as in
> gmt grdgdal lixo.csv -R0/10/0/10 -Gjunk.nc -I0.05 -F"-a nearest -co CPL_DEBUG=ON"
> (this is a mixed GMT and GDAL syntax (the part under double quotes), never mind. It just works locally)
>
> But got no debug printouts from the CI test. Am I wrongly using the CPL_DEBUG? All GDAL versions in CI are above 2.1

See https://trac.osgeo.org/gdal/wiki/ConfigOptions#CPL_DEBUG, may help.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From jluis at ualg.pt  Mon Feb 17 09:34:15 2020
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Mon, 17 Feb 2020 17:34:15 +0000
Subject: [gdal-dev] Help with CPL_DEBUG
In-Reply-To: <CABUeae-4r5OhX7ACr4Pd=bFV9MwP0xd=hg5RhRmEuZ0bBOabwg@mail.gmail.com>
References: <DB8PR04MB6697819853BC0826E2F4C06DA6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <CABUeae-4r5OhX7ACr4Pd=bFV9MwP0xd=hg5RhRmEuZ0bBOabwg@mail.gmail.com>
Message-ID: <DB8PR04MB66971D901F5CF69005BE8257A6160@DB8PR04MB6697.eurprd04.prod.outlook.com>



On Mon, 17 Feb 2020 at 18:05, Joaquim Manuel Freire Luís <jluis at ualg.pt> wrote:
>>
>> Hi Even,

> FYI, you have e-mailed the public gdal-dev mailing list.

Yes, I know but since Even responds all the times ... I took the liberty

I also read that page, and used "CPL_DEBUG=ON" in my command, but no message was printed hence my suspicion that I might not be using it correctly.

> I have no idea why that might happen and tried to run it with 
> CPL_DEBUG as in gmt grdgdal lixo.csv -R0/10/0/10 -Gjunk.nc -I0.05 -F"-a nearest -co CPL_DEBUG=ON"
> (this is a mixed GMT and GDAL syntax (the part under double quotes), 
> never mind. It just works locally)
>
> But got no debug printouts from the CI test. Am I wrongly using the 
> CPL_DEBUG? All GDAL versions in CI are above 2.1

See https://trac.osgeo.org/gdal/wiki/ConfigOptions#CPL_DEBUG, may help.

Best regards,
--
Mateusz Loskot, http://mateusz.loskot.net _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From mateusz at loskot.net  Mon Feb 17 09:44:26 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 17 Feb 2020 18:44:26 +0100
Subject: [gdal-dev] Help with CPL_DEBUG
In-Reply-To: <DB8PR04MB66971D901F5CF69005BE8257A6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <DB8PR04MB6697819853BC0826E2F4C06DA6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <CABUeae-4r5OhX7ACr4Pd=bFV9MwP0xd=hg5RhRmEuZ0bBOabwg@mail.gmail.com>
 <DB8PR04MB66971D901F5CF69005BE8257A6160@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <CABUeae_=NoBrts5dzmCk4GS8ma+LrKw_5aiotxf_OGJg6BGs8Q@mail.gmail.com>

On Mon, 17 Feb 2020 at 18:34, Joaquim Manuel Freire Luís <jluis at ualg.pt> wrote:
> On Mon, 17 Feb 2020 at 18:05, Joaquim Manuel Freire Luís <jluis at ualg.pt> wrote:
> >>
> >> Hi Even,
>
> > FYI, you have e-mailed the public gdal-dev mailing list.
>
> Yes, I know but since Even responds all the times ... I took the liberty

I hope such liberty doesn't spread too widely, unless accepted
...and followed by stream of invoices to Even.

> I also read that page, and used "CPL_DEBUG=ON" in my command,
> but no message was printed hence my suspicion that I might not be using it correctly.

I believe there may be/is difference between
--config CPL_DEBUG ON
vs
--config CPL_DEBUG=ON

The Wiki page does not mention the latter, does it?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From gustavo.r.santos9 at gmail.com  Mon Feb 17 10:18:47 2020
From: gustavo.r.santos9 at gmail.com (gustavorsantos)
Date: Mon, 17 Feb 2020 11:18:47 -0700 (MST)
Subject: [gdal-dev] gdalWarp generates a black image when I use the
	outputBounds option
Message-ID: <1581963527570-0.post@n6.nabble.com>

Hi,

I am trying to crop a .tiff image. However, when I use the outputBounds
option the output file is not what I was expecting.

Here is my fuction code:

def warp(t):
    bounds = t.getMercatorCorners() #calculates the minX, minY, maxX and
maxY
    list(bounds)
    raster = gdal.Open("img/pre/104001001ACD9F00_a_R1C1.tif",
gdal.GA_ReadOnly)

    outputTile = gdal.Warp("img/pos/warp_test.tif", raster,
dstSRS="EPSG:3857", resampleAlg=gdal.GRA_Cubic, height=256, width=256,
outputBounds=bounds, outputBoundsSRS="EPSG:3857")
    outputTile = None

    raster = None

Thanks



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb 17 11:33:25 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 17 Feb 2020 12:33:25 -0700 (MST)
Subject: [gdal-dev] gdalWarp generates a black image when I use the
 outputBounds option
In-Reply-To: <1581963527570-0.post@n6.nabble.com>
References: <1581963527570-0.post@n6.nabble.com>
Message-ID: <1581968005377-0.post@n6.nabble.com>

Hi,

What I think first is that your output bounds do not hit your source data
but with the information that you provide it is impossible to know.

Have you considered to use the gdalwarp executable for testing? If you can't
make it to work please send a link to some test data.

-Jukka Rahkonen-



gustavorsantos wrote
> Hi,
> 
> I am trying to crop a .tiff image. However, when I use the outputBounds
> option the output file is not what I was expecting.
> 
> Here is my fuction code:
> 
> def warp(t):
>     bounds = t.getMercatorCorners() #calculates the minX, minY, maxX and
> maxY
>     list(bounds)
>     raster = gdal.Open("img/pre/104001001ACD9F00_a_R1C1.tif",
> gdal.GA_ReadOnly)
> 
>     outputTile = gdal.Warp("img/pos/warp_test.tif", raster,
> dstSRS="EPSG:3857", resampleAlg=gdal.GRA_Cubic, height=256, width=256,
> outputBounds=bounds, outputBoundsSRS="EPSG:3857")
>     outputTile = None
> 
>     raster = None
> 
> Thanks
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gustavo.r.santos9 at gmail.com  Mon Feb 17 11:51:29 2020
From: gustavo.r.santos9 at gmail.com (gustavorsantos)
Date: Mon, 17 Feb 2020 12:51:29 -0700 (MST)
Subject: [gdal-dev] gdalWarp generates a black image when I use the
 outputBounds option
In-Reply-To: <1581968005377-0.post@n6.nabble.com>
References: <1581963527570-0.post@n6.nabble.com>
 <1581968005377-0.post@n6.nabble.com>
Message-ID: <1581969089679-0.post@n6.nabble.com>

I am converting the Tiles Map Service coordinates to the ESPG:3857
projection. I have pretty sure that the tiles coordinates are between the
master image's bounds. I use the command line gdalwarp using the -te flag
but I have the same output. 

Sorry, but I am working with private data and I don't know where you can
find similar data.

Anyway, thanks!

Gustavo Santos




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb 17 12:01:17 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 17 Feb 2020 13:01:17 -0700 (MST)
Subject: [gdal-dev] gdalWarp generates a black image when I use the
 outputBounds option
In-Reply-To: <1581969089679-0.post@n6.nabble.com>
References: <1581963527570-0.post@n6.nabble.com>
 <1581968005377-0.post@n6.nabble.com> <1581969089679-0.post@n6.nabble.com>
Message-ID: <1581969677827-0.post@n6.nabble.com>

Hi,

Well, based on the errors I tend to do I am pretty sure that the bounds are
not OK. Test data can be what ever raster, or you can use gdal_edit and
paint your original image into totally red or what ever color you want. But
I am sure that you can resolve your problem also by your own with some
thinking and testing.

-Jukka-


gustavorsantos wrote
> I am converting the Tiles Map Service coordinates to the ESPG:3857
> projection. I have pretty sure that the tiles coordinates are between the
> master image's bounds. I use the command line gdalwarp using the -te flag
> but I have the same output. 
> 
> Sorry, but I am working with private data and I don't know where you can
> find similar data.
> 
> Anyway, thanks!
> 
> Gustavo Santos
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gustavo.r.santos9 at gmail.com  Mon Feb 17 12:33:14 2020
From: gustavo.r.santos9 at gmail.com (gustavorsantos)
Date: Mon, 17 Feb 2020 13:33:14 -0700 (MST)
Subject: [gdal-dev] gdalWarp generates a black image when I use the
 outputBounds option
In-Reply-To: <1581969677827-0.post@n6.nabble.com>
References: <1581963527570-0.post@n6.nabble.com>
 <1581968005377-0.post@n6.nabble.com> <1581969089679-0.post@n6.nabble.com>
 <1581969677827-0.post@n6.nabble.com>
Message-ID: <1581971594338-0.post@n6.nabble.com>

Hello,


I think i found the erro, my conversion is not giving the ' - ' signal on
the longitude.

Thanks for the help!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From tim.azzopardi at gmail.com  Tue Feb 18 07:58:35 2020
From: tim.azzopardi at gmail.com (Tim Azzopardi)
Date: Tue, 18 Feb 2020 15:58:35 +0000
Subject: [gdal-dev] NPE in OGREnvelope constructor when loading GDAL dlls
Message-ID: <CACn=4YFRnwbdJ7JcRF-=CijdJUu=X0msBgXsrSGCfhNkSdpFcg@mail.gmail.com>

I'm getting started with GDAL.

I've had success running GDAL code in a windows 32 bit console
app running in Visual Studio 2017 on Windows 10 64 bit using these files
and directories:
    \release-1911-gdal-3-0-2-mapserver-7-4-2-libs\lib\gdal_i.lib (for
linking my code)
    \release-1911-gdal-3-0-2-mapserver-7-4-2-libs\include (for compiling my
code)
    \release-1911-gdal-3-0-2-mapserver-7-4-2\bin (for DLLs required at
runtime)
which I got from
http://download.gisinternals.com/query.html?content=filelist&file=release-1911-gdal-3-0-2-mapserver-7-4-2.zip


I can successfully load a wkt projection file from the console using this
code without any problems
    OGRSpatialReference oSRS;
    oSRS.importFromWkt(&pszWkt_tmp);
    oSRS.dumpReadable();


Now I'm trying to integrate this very simple code into my own 32 bit DLL
which is loaded dynamically by an "off-the-shelf" 32 bit app.

I've written many of these dynamically loaded DLLs before, but when I try
to integrate GDAL into my new DLL, I get an exception when the GDAL DLLs
are being loaded __before_it_ever_gets_to_my_code_. Its stopping seemingly
while loading the GDAL dlls.

The exception occurs (according to the Visual Studio 2017 debugger -
"Exception thrown: write access violation. *this* was nullptr") before
entry into the OGREnvelope constructor at line 60 in ogr_core.h. There is
no call stack shown unfortunately so I've got no idea where the
initialization call is coming from.

class CPL_DLL OGREnvelope
{
  public:
        OGREnvelope() : MinX(std::numeric_limits<double>::infinity()),
    <--  "Exception thrown: write access violation. *this* was nullptr"
                        MaxX(-std::numeric_limits<double>::infinity()),
                        MinY(std::numeric_limits<double>::infinity()),
                        MaxY(-std::numeric_limits<double>::infinity())
        {
        }

I've tried setting the environment variables
   GDAL_DATA=D:\release-1911-gdal-2-4-3-mapserver-7-4-2\bin\gdal-data
   PROJ_LIB=D:\release-1911-gdal-2-4-3-mapserver-7-4-2\bin\proj6\share
but this does not seem to change anything

I appreciate that I am running in a bit of a "niche" environment (32 bit
windows DLL dynamically loaded by a 3rd party app) but if anybody has any
suggestions as to what I might try to make this work I would be very
grateful!

Thanks


-- 
-o-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200218/a7944a1b/attachment.html>

From luis.herrero at gmail.com  Tue Feb 18 14:35:15 2020
From: luis.herrero at gmail.com (Luis Herrero)
Date: Tue, 18 Feb 2020 23:35:15 +0100
Subject: [gdal-dev] Sentinel-2 Sun view angles / access to dataset files
Message-ID: <CAFgnFacL4-m-EZnqCCe4GVRFtrWc1iCTviLGduhKhCkXEjd8yQ@mail.gmail.com>

Hi there!



First of all, thank you for your incredible work. I am a newbie in GDAL
(mainly through Rasterio actually) and, well, I am astonished about how
useful it is.



I am processing Sentinel-2 L1C images in compact safe format. In order to
convert from TOA reflectance to surface reflectance, I need to access to
the zenith and azimuth viewing angles. This data may be read from the
MTD_TL.xml file (for example, in the test file
https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/data/fake_sentinel2_l1c_safecompact/S2A_MSIL1C_test.SAFE/GRANULE/FOO/MTD_TL.xml
it
is under the node “Mean_Viewing_Incidence_Angle”).



I have tried to access through the xml:SENTINEL2 metadata (see
https://gdal.org/drivers/raster/sentinel2.html#metadata) but I get the
global metadata file (in the test
https://github.com/OSGeo/gdal/blob/master/autotest/gdrivers/data/fake_sentinel2_l1c_safecompact/S2A_MSIL1C_test.SAFE/MTD_MSIL1C.xml).
I cannot get it either reading from the xml:VRT metadata domain. I have
also tried to read it from the subdatasets, but the values do not appear
either.



I have two questions:

1)     Are these values already available, and it is my fault not being
able to read them?

2)     If these values are not available, I am thinking in just parsing the
XML. Even if these values are available, eventually I will need to read
some data not available as tags. However, GDAL transparently manages lots
of things through the virtual file systems (I am interested in S3 buckets).
I am wondering if there is any GDAL’s API for reading any file as a plain
text file.



Looking forward to hearing from you.



Thank you very much



Luis Herrero
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200218/3de51064/attachment.html>

From cdelancy at blackfangtechnologies.com  Fri Feb 21 04:10:50 2020
From: cdelancy at blackfangtechnologies.com (Craig Delancy)
Date: Fri, 21 Feb 2020 12:10:50 +0000
Subject: [gdal-dev] No Data Value and Resampling during Warp (C++ API)
Message-ID: <DM6PR17MB38844F819221537CB023FD67C7120@DM6PR17MB3884.namprd17.prod.outlook.com>

Hello, mailing list:

I am currently running into a problem when using ChunkAndWarp on my data sets. It seems that No Data regions are not excluded from the resampling algorithm, and so I end up with values in the image that have been created by blending a data value with a non-data value, resulting in pixels that are skewed towards No Data but not actually equal to it. This then throws off min and max calculations, and causes many other problems.

Is there a way to exclude no data regions from resampling algorithms, or am I confined to using the Nearest Neighbor option?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200221/f8a84657/attachment.html>

From even.rouault at spatialys.com  Fri Feb 21 04:51:35 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Feb 2020 13:51:35 +0100
Subject: [gdal-dev] No Data Value and Resampling during Warp (C++ API)
In-Reply-To: <DM6PR17MB38844F819221537CB023FD67C7120@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB38844F819221537CB023FD67C7120@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <2009650.aigxvxgX2b@even-i700>

On vendredi 21 février 2020 12:10:50 CET Craig Delancy wrote:
> Hello, mailing list:
> 
> I am currently running into a problem when using ChunkAndWarp on my data
> sets. It seems that No Data regions are not excluded from the resampling
> algorithm,

You need to specify nodata in the padfSrcNoDataReal array, and potentially 
padfDstNoDataReal as well.
Or use the GDALWarp() function that will do most of the needed setups 
automatically.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From umbertofilippo at tiscali.it  Fri Feb 21 07:52:04 2020
From: umbertofilippo at tiscali.it (umbertofilippo)
Date: Fri, 21 Feb 2020 08:52:04 -0700 (MST)
Subject: [gdal-dev] Cannot use in memory raster object with gdal warp (GDAL
	Python API)
Message-ID: <1582300324042-0.post@n6.nabble.com>

Sorry if this is a copy of a question I already asked on gis.stackexchange (
here
<https://gis.stackexchange.com/questions/351577/cannot-use-in-memory-raster-object-with-gdal-warp-gdal-python-api> 
), but I thought I might get more chance to receive an answer here.

These are the operations I am doing in my code:

1 - reading an existing raster (tif)
2 - creating a in memory raster object
3 - reading the existing raster object in chunk as array
4 - making some calculations
5 - writing the array to my in memory object

What I want to do now is, with the in memory raster object ready to be used,
feed it to gdal warp, which should also output an intermediate raster object
that I'll be use afterwards.

However, when I try to GetRasterBand() out of this latter raster object, I
receive an error because it is actually equal to None:

    AttributeError: 'NoneType' object has no attribute 'GetRasterBand'

I am pretty sure it is about saving/updating/flushing the status of the
raster object after the calculations but I could not find out if this is the
actual problem.

How can I use in memory (intermediate) files in my script?
Here is the code code I am using (the error is at the very last line):

from osgeo import gdal, gdalconst
import numpy as np

in_raster = gdal.Open(r'/my/raster.tif', gdalconst.GA_ReadOnly)
in_b = in_r.GetRasterBand(1)

b1 = in_raster.GetRasterBand(1)
xsize = b1.XSize
ysize = b1.YSize
step = 10  # THIS IS THE CHUNK SIZE!
ystep = ysize / step
ystep = int(ystep)
yresidual = ysize - (ystep * step)

driver = gdal.GetDriverByName("MEM")
temp_calc = driver.Create('',
                          xsize,
                          ysize,
                          1,
                          gdal.GDT_Float32)

temp_b = temp_calc.GetRasterBand(1)

for i in range(step):
    if i != step-1:
        arr_part = in_b.ReadAsArray(
            0, ystep * i, xsize, ystep).astype('float32')

        data = np.nan_to_num(arr_part)

        temp_b.WriteArray(data, 0, ystep * i)
    else:
        arr_part = in_b.ReadAsArray(
            0, ystep * i, xsize, ystep + yresidual).astype('float32')

        # replace nan with zeros
        #
https://docs.scipy.org/doc/numpy/reference/generated/numpy.nan_to_num.html
        data = np.nan_to_num(arr_part)

        # write array chunk to (in memory) file
        # https://gdal.org/python/osgeo.gdal.Band-class.html#WriteArray
        temp_b.WriteArray(data, 0, ystep * i)

# get raster resolution
in_gt = in_raster.GetGeoTransform()
in_x = in_gt[1]
in_y = -in_gt[5]

kwargs = {'xRes': in_x,
          'yRes': in_y,
          'targetAlignedPixels': True,
          'resampleAlg': 'average',
          'format': 'MEM'
          }

ds = gdal.Warp('',
               temp_calc,
               **kwargs)
b1 = ds.GetRasterBand(1)
# ds is None and the above line throws the exception



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From nyall.dawson at gmail.com  Sat Feb 22 16:45:54 2020
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Sun, 23 Feb 2020 10:45:54 +1000
Subject: [gdal-dev] Fedora package status
Message-ID: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>

Hi list,

Does anyone with any knowledge of the fedora packaging infrastructure
have any advice for getting the gdal library updated in the fedora
repos?

Even on the most recent Fedora releases, this is stuck at absolutely
ancient versions (2.3!).

Worse is that the proj library has been updated, resulting in the
not-recommended combination of proj 6/gdal 2 (specifically proj 6.2 --
a version with known critical bugs).

Nyall

From mickhowe292 at gmail.com  Sat Feb 22 17:52:04 2020
From: mickhowe292 at gmail.com (mick howe)
Date: Sun, 23 Feb 2020 01:52:04 +0000
Subject: [gdal-dev] Fedora package status
In-Reply-To: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
References: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
Message-ID: <CAFcrWXi+4tGuG9C4nr9HjVxUJrkTbqa_UHTCyBtvd7aTwAuk0g@mail.gmail.com>

Don't know if this would still work but back about Fedora 1 - 3 I used
checkinstall to build & package .tar.gz's into rpms then used a version of
apt for redhat to manage them as a local repository.
I was a lot more clever back then and have been using arch since 2008-9

mick in glen innes

On Sun, 23 Feb 2020 at 00:46, Nyall Dawson <nyall.dawson at gmail.com> wrote:

> Hi list,
>
> Does anyone with any knowledge of the fedora packaging infrastructure
> have any advice for getting the gdal library updated in the fedora
> repos?
>
> Even on the most recent Fedora releases, this is stuck at absolutely
> ancient versions (2.3!).
>
> Worse is that the proj library has been updated, resulting in the
> not-recommended combination of proj 6/gdal 2 (specifically proj 6.2 --
> a version with known critical bugs).
>
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200223/38eb14fd/attachment.html>

From manisandro at gmail.com  Sun Feb 23 05:25:21 2020
From: manisandro at gmail.com (Sandro Mani)
Date: Sun, 23 Feb 2020 14:25:21 +0100
Subject: [gdal-dev] Fedora package status
In-Reply-To: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
References: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
Message-ID: <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>

Hi Nyall

I've started the non-responsive maintainer process for various gis 
packages last week since they are indeed pretty neglected an am testing 
the updates here [1]. I'm hoping to finish the process next week and get 
things up-to-date again.

Sandro

[1] https://copr.fedorainfracloud.org/coprs/smani/gisstack/ 
<https://copr.fedorainfracloud.org/coprs/smani/gisstack/builds/>

On 23.02.20 01:45, Nyall Dawson wrote:
> Hi list,
>
> Does anyone with any knowledge of the fedora packaging infrastructure
> have any advice for getting the gdal library updated in the fedora
> repos?
>
> Even on the most recent Fedora releases, this is stuck at absolutely
> ancient versions (2.3!).
>
> Worse is that the proj library has been updated, resulting in the
> not-recommended combination of proj 6/gdal 2 (specifically proj 6.2 --
> a version with known critical bugs).
>
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200223/993ef093/attachment.html>

From neteler at osgeo.org  Sun Feb 23 08:54:29 2020
From: neteler at osgeo.org (Markus Neteler)
Date: Sun, 23 Feb 2020 17:54:29 +0100
Subject: [gdal-dev] Fedora package status
In-Reply-To: <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>
References: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
 <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>
Message-ID: <CALFmHhu=cRT+jRzLJp7m_BkbyVJcOwxJGA9vzBZCQVRbiSOocQ@mail.gmail.com>

Hi Sandro, Nyall, all,

On Sun, Feb 23, 2020 at 2:25 PM Sandro Mani <manisandro at gmail.com> wrote:
>
> Hi Nyall
>
> I've started the non-responsive maintainer process for various gis packages last week since they are indeed pretty neglected an am testing the updates here [1]. I'm hoping to finish the process next week and get things up-to-date again.
>
> Sandro
>
> [1] https://copr.fedorainfracloud.org/coprs/smani/gisstack/

This is cool, I already discovered your PR here:

https://src.fedoraproject.org/rpms/gdal

Being the maintainer of GRASS GIS in Fedora, I can try to push things
also for GDAL, based on your efforts.

Best
Markus

From nyall.dawson at gmail.com  Sun Feb 23 14:47:53 2020
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Mon, 24 Feb 2020 08:47:53 +1000
Subject: [gdal-dev] Fedora package status
In-Reply-To: <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>
References: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
 <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>
Message-ID: <CAB28AsigRrFywqQSvpuWFaTNNNpXoVp1fke0WHVqk2mYe-=4GQ@mail.gmail.com>

On Sun, 23 Feb 2020 at 23:25, Sandro Mani <manisandro at gmail.com> wrote:
>
> Hi Nyall
>
> I've started the non-responsive maintainer process for various gis packages last week since they are indeed pretty neglected an am testing the updates here [1]. I'm hoping to finish the process next week and get things up-to-date again.

Great news, thanks for your efforts here!

Let me know if I can do anything to help (even if you just want me to
pester on the bug reports to try to raise the severity of the issues
around these older package versions!)

Nyall

>
> Sandro
>
> [1] https://copr.fedorainfracloud.org/coprs/smani/gisstack/
>
> On 23.02.20 01:45, Nyall Dawson wrote:
>
> Hi list,
>
> Does anyone with any knowledge of the fedora packaging infrastructure
> have any advice for getting the gdal library updated in the fedora
> repos?
>
> Even on the most recent Fedora releases, this is stuck at absolutely
> ancient versions (2.3!).
>
> Worse is that the proj library has been updated, resulting in the
> not-recommended combination of proj 6/gdal 2 (specifically proj 6.2 --
> a version with known critical bugs).
>
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jon at upowr.com.au  Sun Feb 23 20:46:03 2020
From: jon at upowr.com.au (Jon Seymour)
Date: Mon, 24 Feb 2020 15:46:03 +1100
Subject: [gdal-dev] Occasional ERROR 4 on gdal.Open() with vrt files hosted
	on AWS S3
Message-ID: <CAK3HS-ehrn490_TJtQngQSKkJneoD8tQ9GBuY+WBQYUE=WJ02A@mail.gmail.com>

G'day,

I am trying to get to the bottom of some errors I have been experiencing
with gdal 2.4.2 + Python 3 running in a long-running debian container on
AWS ECS. The files I am trying to load are VRT (actually named .tif) that
reference actual .tif files hosted in the same S3 bucket.

Most of the time the access works, the symptom is that if the container has
been running for a long time, then the gdal.Open() returns null and logs an
ERROR 4 to the stderr. For example:

ERROR 4: `/vsis3/acme-foo-bar/baz/quux.tif' not recognized as a supported
file format
If the container is restarted, then the access works as expected. Indeed,
if I call gdal.VsiCurlClearCache(), then the access works as expected, so
the issue is not the AWS credentials. Indeed, verbose vsicurl logging
indicates that there are no 4xx or 5xx errors on any request (almost all
the requests return.a 206 Partial Response response code).

I was initially using gdal 2.4.0 with IAM role-based credentials and
discovered this issue (https://github.com/OSGeo/gdal/issues/1593) that
looked very similar to the issue I was having.

However, I have since upgraded the library to gdal-2.4.2 and an issue with
identical symptoms persists - occasionally. I have even stopped using IAM
role based credentials and switched to using explicitly managed
AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment variables but the
issue persists - occasionally. By occasionally, I mean that I can't
reproduce the problem at will even with files for which it happens
initially. The fact that I do not see any 4xx or 5xx errors indicates to me
that this is not a AWS credentials issue.

I have enabled vsicurl verbose logging and have observed that I get a 206
response of the correct length (1985, in my case), indicating that the
request to AWS S3 has not actually failed and probably has returned the
expected response.

It does seem suspicious to me that a call to gdal.VsiCurlClearCache()
appears to resolve the issue immediately, but it isn't clear why that works
or what the root cause of the underlying issue is.

Any suggestions about how I could debug this would be gratefully accepted.

jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200224/3a0b4a83/attachment.html>

From thomas.bonfort at gmail.com  Sun Feb 23 22:49:25 2020
From: thomas.bonfort at gmail.com (thomas bonfort)
Date: Mon, 24 Feb 2020 07:49:25 +0100
Subject: [gdal-dev] Occasional ERROR 4 on gdal.Open() with vrt files
 hosted on AWS S3
In-Reply-To: <CAK3HS-ehrn490_TJtQngQSKkJneoD8tQ9GBuY+WBQYUE=WJ02A@mail.gmail.com>
References: <CAK3HS-ehrn490_TJtQngQSKkJneoD8tQ9GBuY+WBQYUE=WJ02A@mail.gmail.com>
Message-ID: <CAOM3y2hOGQ8i0+tt-21uxwNYdzazmzvgMzn7MYAzT17N_hdL8Q@mail.gmail.com>

Jon,
This issue is probably related to https://github.com/OSGeo/gdal/issues/1244
and was fixed in 2.4.4

--
Thomas

Le lun. 24 févr. 2020 à 05:46, Jon Seymour <jon at upowr.com.au> a écrit :

> G'day,
>
> I am trying to get to the bottom of some errors I have been experiencing
> with gdal 2.4.2 + Python 3 running in a long-running debian container on
> AWS ECS. The files I am trying to load are VRT (actually named .tif) that
> reference actual .tif files hosted in the same S3 bucket.
>
> Most of the time the access works, the symptom is that if the container
> has been running for a long time, then the gdal.Open() returns null and
> logs an ERROR 4 to the stderr. For example:
>
> ERROR 4: `/vsis3/acme-foo-bar/baz/quux.tif' not recognized as a supported
> file format
> If the container is restarted, then the access works as expected. Indeed,
> if I call gdal.VsiCurlClearCache(), then the access works as expected, so
> the issue is not the AWS credentials. Indeed, verbose vsicurl logging
> indicates that there are no 4xx or 5xx errors on any request (almost all
> the requests return.a 206 Partial Response response code).
>
> I was initially using gdal 2.4.0 with IAM role-based credentials and
> discovered this issue (https://github.com/OSGeo/gdal/issues/1593) that
> looked very similar to the issue I was having.
>
> However, I have since upgraded the library to gdal-2.4.2 and an issue with
> identical symptoms persists - occasionally. I have even stopped using IAM
> role based credentials and switched to using explicitly managed
> AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment variables but the
> issue persists - occasionally. By occasionally, I mean that I can't
> reproduce the problem at will even with files for which it happens
> initially. The fact that I do not see any 4xx or 5xx errors indicates to me
> that this is not a AWS credentials issue.
>
> I have enabled vsicurl verbose logging and have observed that I get a 206
> response of the correct length (1985, in my case), indicating that the
> request to AWS S3 has not actually failed and probably has returned the
> expected response.
>
> It does seem suspicious to me that a call to gdal.VsiCurlClearCache()
> appears to resolve the issue immediately, but it isn't clear why that works
> or what the root cause of the underlying issue is.
>
> Any suggestions about how I could debug this would be gratefully accepted.
>
> jon.
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200224/dafd853e/attachment.html>

From jon at upowr.com.au  Sun Feb 23 23:05:41 2020
From: jon at upowr.com.au (Jon Seymour)
Date: Mon, 24 Feb 2020 18:05:41 +1100
Subject: [gdal-dev] Occasional ERROR 4 on gdal.Open() with vrt files
 hosted on AWS S3
In-Reply-To: <CAOM3y2hOGQ8i0+tt-21uxwNYdzazmzvgMzn7MYAzT17N_hdL8Q@mail.gmail.com>
References: <CAK3HS-ehrn490_TJtQngQSKkJneoD8tQ9GBuY+WBQYUE=WJ02A@mail.gmail.com>
 <CAOM3y2hOGQ8i0+tt-21uxwNYdzazmzvgMzn7MYAzT17N_hdL8Q@mail.gmail.com>
Message-ID: <CAK3HS-fqkSswmMDQhDgWQT1jU_Ojo119Z6H=8JNLeFwsGx4H+Q@mail.gmail.com>

On Mon, Feb 24, 2020 at 5:49 PM thomas bonfort <thomas.bonfort at gmail.com>
wrote:

> Jon,
> This issue is probably related to
> https://github.com/OSGeo/gdal/issues/1244 and was fixed in 2.4.4
>

Thomas,

Thanks very much for that tip, it does sound promising. A thread safety
issue may also explain another symptom I saw once, which was an unexpected
ERROR 1 while parsing the VRT file, however, that has only happened once so
I am not sure if it is the same issue.

Anyway, I will build 2.4.4 and see whether my current workaround (retrying
at most once after calling VSICurlClearCache) is rendered unnecessary.

jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200224/4a562abc/attachment.html>

From manisandro at gmail.com  Mon Feb 24 02:32:04 2020
From: manisandro at gmail.com (Sandro Mani)
Date: Mon, 24 Feb 2020 11:32:04 +0100
Subject: [gdal-dev] Fedora package status
In-Reply-To: <CAB28AsigRrFywqQSvpuWFaTNNNpXoVp1fke0WHVqk2mYe-=4GQ@mail.gmail.com>
References: <CAB28AsghV6wMBR4qOi0b8rTY05Am346GBrPJtZ_i1+QEDvPK+Q@mail.gmail.com>
 <5c39bfd7-62b7-1beb-dd03-1b04a7155cad@gmail.com>
 <CAB28AsigRrFywqQSvpuWFaTNNNpXoVp1fke0WHVqk2mYe-=4GQ@mail.gmail.com>
Message-ID: <e0602acc-901f-f332-3816-d234c672edde@gmail.com>

> Let me know if I can do anything to help (even if you just want me to
> pester on the bug reports to try to raise the severity of the issues
> around these older package versions!)

I've moved ahead and filed [1] to formally resolve the situation. Feel 
free to add comments there.

Sandro

[1] https://pagure.io/fesco/issue/2345

>> Sandro
>>
>> [1] https://copr.fedorainfracloud.org/coprs/smani/gisstack/
>>
>> On 23.02.20 01:45, Nyall Dawson wrote:
>>
>> Hi list,
>>
>> Does anyone with any knowledge of the fedora packaging infrastructure
>> have any advice for getting the gdal library updated in the fedora
>> repos?
>>
>> Even on the most recent Fedora releases, this is stuck at absolutely
>> ancient versions (2.3!).
>>
>> Worse is that the proj library has been updated, resulting in the
>> not-recommended combination of proj 6/gdal 2 (specifically proj 6.2 --
>> a version with known critical bugs).
>>
>> Nyall
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From devlocalca at gmail.com  Mon Feb 24 21:59:15 2020
From: devlocalca at gmail.com (/dev /local/ca)
Date: Mon, 24 Feb 2020 22:59:15 -0700
Subject: [gdal-dev] How do I install GDAL on Windows 10?
Message-ID: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>

I want to install and use GDAL on Windows 10.

I don't know what 'conda' is, I don't care what it is, and I don't want to
install it and screw up my machine.

Ultimately I want to install 'geopandas', but it has a requirement of
'fiona', and 'fiona' requires 'GDAL' so I need to figure that out first,

---
then I need to figure out how to install 'Rtree' which has a dependency of
'spatialindex', so after this will figure out how to install
'spatialindex', then figure out how to install 'Rtree', then try again and
see if 'fiona' will install and then after that try 'geopandas' again,

but for now, the first step I see is 'GDAL'.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200224/59728ab6/attachment.html>

From mateusz at loskot.net  Mon Feb 24 23:20:18 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 25 Feb 2020 08:20:18 +0100
Subject: [gdal-dev] How do I install GDAL on Windows 10?
In-Reply-To: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
References: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
Message-ID: <F8CE7337-E1B7-4C6E-B708-15DCCFE640C0@loskot.net>

On 25 February 2020 06:59:15 CET, /dev /local/ca <devlocalca at gmail.com> wrote:
>I want to install and use GDAL on Windows 10.
>
>I don't know what 'conda' is, I don't care what it is, and I don't want
>to
>install it and screw up my machine.

You've chosen the operating system wrongly as apparently it does not fit your attitude.

Luckily, you've got the WSL on Windows 10.
Use it and chances are you'll stop complaining across the Web...



-- 
Mateusz Loskot, mateusz at loskot.net
(Sent from K-9 on mobile, may suffer from top-posting)

From jmckenna at gatewaygeomatics.com  Tue Feb 25 05:12:15 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 25 Feb 2020 09:12:15 -0400
Subject: [gdal-dev] How do I install GDAL on Windows 10?
In-Reply-To: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
References: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
Message-ID: <700119bd-de55-b6be-eff6-fd568da56ae5@gatewaygeomatics.com>

If you are looking for a simple zipfile, you can download MS4W 
(https://ms4w.com/) which contains GDAL 2.4.4 and Python 3.7.5 - 
GeoPandas hasn't been added yet to MS4W, but there is already a ticket 
filed so it will be added to a future version soon.

Some steps for you:
- extract MS4W to drive root, so after extraction you have C:/ms4w
- open a command window and cd into /ms4w
- setenv.bat
- gdalinfo --version

You can then get more assistance from the MS4W community at 
https://ms4w.com/forum/


-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/


On 2020-02-25 1:59 a.m., /dev /local/ca wrote:
> I want to install and use GDAL on Windows 10.
> 
> I don't know what 'conda' is, I don't care what it is, and I don't want 
> to install it and screw up my machine.
> 
> Ultimately I want to install 'geopandas', but it has a requirement of 
> 'fiona', and 'fiona' requires 'GDAL' so I need to figure that out first,
> 
> ---
> then I need to figure out how to install 'Rtree' which has a dependency 
> of 'spatialindex', so after this will figure out how to install 
> 'spatialindex', then figure out how to install 'Rtree', then try again 
> and see if 'fiona' will install and then after that try 'geopandas' again,
> 
> but for now, the first step I see is 'GDAL'.
> 




From jorisvandenbossche at gmail.com  Tue Feb 25 05:32:28 2020
From: jorisvandenbossche at gmail.com (Joris Van den Bossche)
Date: Tue, 25 Feb 2020 14:32:28 +0100
Subject: [gdal-dev] How do I install GDAL on Windows 10?
In-Reply-To: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
References: <CAH5ok1m+uRQw0FbRtu-YoPRA4ciL8ROedh1bQ_3cFNpi6s2uVQ@mail.gmail.com>
Message-ID: <CALQtMBao5kCX0e8=M-M_0ARd8SAojh4jpegxEbLtmUO974QsjA@mail.gmail.com>

On Tue, 25 Feb 2020 at 06:59, /dev /local/ca <devlocalca at gmail.com> wrote:

> I want to install and use GDAL on Windows 10.
>
> I don't know what 'conda' is, I don't care what it is, and I don't want to
> install it and screw up my machine.
>

I know you said to not care about what conda is, but if you want an easy
way to install GDAL (and fiona, rtree, geopandas, ...) on Windows, you
might want to care. conda is a cross-platform package manager for binary
packages (so pre-built, you don't need to build from source yourself), and
includes GDAL and the other mentioned packages. Miniconda provides a way to
minimally install the conda package manager (without the full blown
Anaconda distribution): https://docs.conda.io/en/latest/miniconda.html

In principle, wheels could also provide binary packages for python, but
unfortunately, the situation right now is that not all dependencies of
GeoPandas provide those for Windows (eg there are also no wheels for
rtree/libspatialindex). See
https://geopandas.readthedocs.io/en/latest/install.html#installing-with-pip


>
> Ultimately I want to install 'geopandas', but it has a requirement of
> 'fiona', and 'fiona' requires 'GDAL' so I need to figure that out first,
>
> ---
> then I need to figure out how to install 'Rtree' which has a dependency of
> 'spatialindex', so after this will figure out how to install
> 'spatialindex', then figure out how to install 'Rtree', then try again and
> see if 'fiona' will install and then after that try 'geopandas' again,
>
> but for now, the first step I see is 'GDAL'.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200225/e8c742fb/attachment.html>

From mulcahy.brianp at gmail.com  Tue Feb 25 06:12:39 2020
From: mulcahy.brianp at gmail.com (Brian)
Date: Tue, 25 Feb 2020 09:12:39 -0500
Subject: [gdal-dev] Occasional ERROR 4 on gdal.Open() with vrt files hosted
 on AWS S3
Message-ID: <CANoBQeaXXe5xPQK2abN1U4GwNzxg4z4LCw4CHamzrVmHXGMNMw@mail.gmail.com>

Jon do you think it could be a memory or storage issue?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200225/15bc95bf/attachment.html>

From zac at weatherwary.com  Tue Feb 25 10:13:59 2020
From: zac at weatherwary.com (Zachary Flamig)
Date: Tue, 25 Feb 2020 12:13:59 -0600
Subject: [gdal-dev] Grib Support?
Message-ID: <36AE8537-54FA-464B-A909-95D539B47038@weatherwary.com>

Hi,

We noticed that somewhere along the line to GDAL 3 something changed with respect to grib support and it now doesn’t correctly parse some projections.

For example, this file:
https://nomads.ncep.noaa.gov/pub/data/nccf/com/blend/prod/blend.20200224/17/grib2/blend.t17z.master.f001.co.grib2 <https://nomads.ncep.noaa.gov/pub/data/nccf/com/blend/prod/blend.20200224/17/grib2/blend.t17z.master.f001.co.grib2>

The grib specifies a lower bound latitude which isn’t being properly converted to the upper bound latitude that gdal wants.

I traced this back to here: https://github.com/OSGeo/gdal/blob/master/gdal/frmts/grib/gribdataset.cpp#L2127 <https://github.com/OSGeo/gdal/blob/master/gdal/frmts/grib/gribdataset.cpp#L2127> where scan in this file is set to 80 not 64 so the if statement isn’t true. This is fixable if we do proper flag checks i.e. (if ((meta->gds.scan & GRIB2BIT_2) == GRIB2BIT_2)) but this line hasn’t changed from GDAL 2.

I did see this comment https://github.com/OSGeo/gdal/blob/master/gdal/frmts/grib/degrib/degrib/metaparse.cpp#L1259 <https://github.com/OSGeo/gdal/blob/master/gdal/frmts/grib/degrib/degrib/metaparse.cpp#L1259>
which makes me think something changed with the underlying grib2 libraries?

Any thoughts on the best way forward?

Zac
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200225/2748ed2e/attachment-0001.html>

From even.rouault at spatialys.com  Tue Feb 25 11:47:57 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Feb 2020 20:47:57 +0100
Subject: [gdal-dev] Grib Support?
In-Reply-To: <36AE8537-54FA-464B-A909-95D539B47038@weatherwary.com>
References: <36AE8537-54FA-464B-A909-95D539B47038@weatherwary.com>
Message-ID: <8654846.VUPH5MTJ7O@even-i700>

On mardi 25 février 2020 12:13:59 CET Zachary Flamig wrote:
> Hi,
> 
> We noticed that somewhere along the line to GDAL 3 something changed with
> respect to grib support and it now doesn’t correctly parse some
> projections.

Fixed. Was a side effect of an optimization.
This affects only master / 3.1dev branch

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zac at weatherwary.com  Tue Feb 25 14:41:46 2020
From: zac at weatherwary.com (Zachary Flamig)
Date: Tue, 25 Feb 2020 16:41:46 -0600
Subject: [gdal-dev] Grib Support?
In-Reply-To: <8654846.VUPH5MTJ7O@even-i700>
References: <36AE8537-54FA-464B-A909-95D539B47038@weatherwary.com>
 <8654846.VUPH5MTJ7O@even-i700>
Message-ID: <02D0A9DC-C255-4708-B4F4-FED66E1442D7@weatherwary.com>

Thanks for the fast fix!

Zac

> On Feb 25, 2020, at 1:47 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> On mardi 25 février 2020 12:13:59 CET Zachary Flamig wrote:
>> Hi,
>> 
>> We noticed that somewhere along the line to GDAL 3 something changed with
>> respect to grib support and it now doesn’t correctly parse some
>> projections.
> 
> Fixed. Was a side effect of an optimization.
> This affects only master / 3.1dev branch
> 
> Even
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From jon at upowr.com.au  Tue Feb 25 15:31:17 2020
From: jon at upowr.com.au (Jon Seymour)
Date: Wed, 26 Feb 2020 10:31:17 +1100
Subject: [gdal-dev] gdal-dev Digest, Vol 189, Issue 34
In-Reply-To: <mailman.77850.1582654442.17185.gdal-dev@lists.osgeo.org>
References: <mailman.77850.1582654442.17185.gdal-dev@lists.osgeo.org>
Message-ID: <CAK3HS-dSNKxDbfj7FeQL0Y+k2V+D_ux4L-zZH_hA2eurjj4oFg@mail.gmail.com>

>
> Jon do you think it could be a memory or storage issue?
>

Almost certainly not a storage (as in disk or remote s3) issue since the
local disk is not exhausted and there is no evidence of an S3 access issue.

Based on the fact that a call to gdal.VSICurlClearCache appears to clear
the symptom, it does look like a corruption of the in-memory VSICurl cache
(or, more likely, its book-keeping data structures). I suspect Thomas is
correct and the issue will be fixed in gdal-2.4.4 (by the fix for
https://github.com/osGeo/gdal/issues/1244) but it is too early for me to
say for sure yet.

jon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200226/518f30c5/attachment.html>

From brentonmallen1 at gmail.com  Wed Feb 26 06:13:08 2020
From: brentonmallen1 at gmail.com (Brenton Mallen)
Date: Wed, 26 Feb 2020 09:13:08 -0500
Subject: [gdal-dev] Merge and Overviews with VSIMEM
Message-ID: <CANz2Sn+upYWb=N=42M+ZYk7nTvmFR03c17Cm9d=s_L2=eKwBhA@mail.gmail.com>

Hi,

I'm attempting to merge 2 multi-band tiffs as well as build overviews for
the resulting merged tiff.  I'm a bit confused when I attempt to use a
`vsimem` object to perform the actions in memory.  For example, I have a
couple of functions defined as

def merge_bands(tiffs, out_file):
    """Merge multi-band GeoTIFFs together.

    Args:
        tiffs (list): List of paths to TIFFs to be merged
        out_file (str): Path to output file
    """
    merge_command = 'gdal_merge.py -separate -o {} '.format(out_file)
    merge_command += ' --config GDAL_CACHEMAX 256'
    merge_command += ' -co compress=LZW'
    merge_command += ' -co TILED=YES'
    for tiff in tiffs:
        merge_command = merge_command + ' {}'.format(tiff)
    sp.check_call(merge_command, shell=True, stdout=sp.PIPE, stderr=sp.PIPE)

def build_overviews(filename, levels):
    """Build overviews.
    Args:
        filename (str): Input filename
        levels (list): Level (int) or list or levels (ints)
            to build overviews for.
    """
    if not isinstance(levels, list):
        levels = [levels]
    command = 'gdaladdo'
    command += ' -r average'
    command += ' {}'.format(filename)
    command += ' {}'.format(' '.join(str(x) for x in levels))
    sp.check_call(command, shell=True, stdout=sp.PIPE, stderr=sp.PIPE)


When I attempt to call it, using the following, the `vsimem` object seems
to no longer be accessible to perform the overview creation:

merged_mem = '/vsimem/merged.tiff'

merge_bands(['file1.tiff', 'file2.tiff'], merged_mem)
build_overviews(merged_mem, [2,4,8,16,32,64])

I get an `exit status 2` which I believe is due to `merged_mem` being a
NoneType after the merge is performed.

I'm also confused about best practices.  Ideally, I'd like to do this all
in the python wrapper but there doesn't seem to be an immediately obvious
parallel for the `gdal_merge` script.

I'm using python 3.8 and GDAL 3.0.2.

Any guidance would be appreciated and thank you for your time,
Brenton

-- 
Brenton Mallen
(561) 376-6580 | Site <https://brentonmallen.com/> | GitHub
<https://github.com/brentonmallen1> | LinkedIn
<https://www.linkedin.com/in/brentonmallen/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200226/62c61304/attachment-0001.html>

From sean at mapbox.com  Wed Feb 26 07:27:37 2020
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 26 Feb 2020 08:27:37 -0700
Subject: [gdal-dev] Merge and Overviews with VSIMEM
In-Reply-To: <CANz2Sn+upYWb=N=42M+ZYk7nTvmFR03c17Cm9d=s_L2=eKwBhA@mail.gmail.com>
References: <CANz2Sn+upYWb=N=42M+ZYk7nTvmFR03c17Cm9d=s_L2=eKwBhA@mail.gmail.com>
Message-ID: <CADPhZXwCA0YH6ZYM+DS6P1bpY1mfq-Pke4=C3eaWBw9_Y4HNJQ@mail.gmail.com>

Hi Brenton,

On Wed, Feb 26, 2020 at 7:13 AM Brenton Mallen <brentonmallen1 at gmail.com>
wrote:

> Hi,
>
> I'm attempting to merge 2 multi-band tiffs as well as build overviews for
> the resulting merged tiff.  I'm a bit confused when I attempt to use a
> `vsimem` object to perform the actions in memory.  For example, I have a
> couple of functions defined as
>
> def merge_bands(tiffs, out_file):
>     """Merge multi-band GeoTIFFs together.
>
>     Args:
>         tiffs (list): List of paths to TIFFs to be merged
>         out_file (str): Path to output file
>     """
>     merge_command = 'gdal_merge.py -separate -o {} '.format(out_file)
>     merge_command += ' --config GDAL_CACHEMAX 256'
>     merge_command += ' -co compress=LZW'
>     merge_command += ' -co TILED=YES'
>     for tiff in tiffs:
>         merge_command = merge_command + ' {}'.format(tiff)
>     sp.check_call(merge_command, shell=True, stdout=sp.PIPE, stderr=sp.PIPE)
>
> def build_overviews(filename, levels):
>     """Build overviews.
>     Args:
>         filename (str): Input filename
>         levels (list): Level (int) or list or levels (ints)
>             to build overviews for.
>     """
>     if not isinstance(levels, list):
>         levels = [levels]
>     command = 'gdaladdo'
>     command += ' -r average'
>     command += ' {}'.format(filename)
>     command += ' {}'.format(' '.join(str(x) for x in levels))
>     sp.check_call(command, shell=True, stdout=sp.PIPE, stderr=sp.PIPE)
>
>
> When I attempt to call it, using the following, the `vsimem` object seems
> to no longer be accessible to perform the overview creation:
>
> merged_mem = '/vsimem/merged.tiff'
>
> merge_bands(['file1.tiff', 'file2.tiff'], merged_mem)
> build_overviews(merged_mem, [2,4,8,16,32,64])
>
> I get an `exit status 2` which I believe is due to `merged_mem` being a
> NoneType after the merge is performed.
>
> I'm also confused about best practices.  Ideally, I'd like to do this all
> in the python wrapper but there doesn't seem to be an immediately obvious
> parallel for the `gdal_merge` script.
>
> I'm using python 3.8 and GDAL 3.0.2.
>
> Any guidance would be appreciated and thank you for your time,
> Brenton
>

VSIMEM files are visible within a process (
https://gdal.org/user/virtual_file_systems.html#vsimem-in-memory-files) and
Python's check_call runs your command within a *new* process. You have a
single string named merged_mem, but I think this maps to a different
in-memory file in each of the two processes in your program. Even will have
a more definitive answer, I'm sure. but I think these are your options:

1. use a physical temp file, easily shared between processes
2. use a more sophisticated shared memory (mmap?)
3. implement the merge in Python within the original process

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200226/46a33b56/attachment.html>

From parthivpradeep at gmail.com  Wed Feb 26 08:00:12 2020
From: parthivpradeep at gmail.com (Pradeep kumar)
Date: Wed, 26 Feb 2020 17:00:12 +0100
Subject: [gdal-dev] Sub: Gdal,
	leave one out method with GCP'S (Interpolation Equation)
Message-ID: <CAL9U1Wtu_-D9CWMw4cZ177ozr_X7D+ABG3JpD63aTi7-b8o4oQ@mail.gmail.com>

Hi All,

I am georeferencing aerial images with gcps using gdal_translate and
gdalwarp. Before georeferencing image(warping) I would like to check
quality and final result on a control_point cp (eg disabeld gcps).
Therefore I would like to calculate the coordinates in destination image
for a independent control_point based on the interpolation method (n-order,
helmet and spline) which is NOT used by warping itself.  Afterwards compare
positions with estimated coordinates of that cp.

Example:
Lets say, I have 10 gcps. I take 8 gcps, using `-order n` generate a
`model`.  Then predict destination values for rest of the two control
points using this `model`. Finally compute shift between predicted and
actual values for these control points.

Could you please let me know if any gdal tool does this? Can any one give
some insight how to implement this in python?

I have checked following stack exchange issues.
1.
https://gis.stackexchange.com/questions/225931/python-gdal-how-to-obtain-dx-dy-residual-errors-for-gcps-after-gdalwarp-usage
(self written n-grad interpolation, is there any validaton form offical
gdal?)
2. http://osgeo-org.1560.x6.nabble.com/GCPs-to-geo-transform-td3771045.html
3.
https://gis.stackexchange.com/questions/102111/preserve-gcps-after-gdalwarp

-- 
Best Regards,
Pradeep Gulla
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200226/27ee3383/attachment-0001.html>

From even.rouault at spatialys.com  Wed Feb 26 08:17:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Feb 2020 17:17:26 +0100
Subject: [gdal-dev] Merge and Overviews with VSIMEM
In-Reply-To: <CANz2Sn+upYWb=N=42M+ZYk7nTvmFR03c17Cm9d=s_L2=eKwBhA@mail.gmail.com>
References: <CANz2Sn+upYWb=N=42M+ZYk7nTvmFR03c17Cm9d=s_L2=eKwBhA@mail.gmail.com>
Message-ID: <1827758.7cc3kO5dR8@even-i700>

> When I attempt to call it, using the following, the `vsimem` object seems
> to no longer be accessible to perform the overview creation:

Yes, /vsimem/ objects are only visible during the lifetime of the process. 
Here as you start a subprocss, the /vsimem file will not be visible by the 
parent

Different possible solutions:
- you materialize the file on the filesystem
- or you import gdal_merge, and run gdal_merge.main(argv)
- or you use gdal.Warp() instead of gdal_merge

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Feb 26 08:37:34 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Feb 2020 17:37:34 +0100
Subject: [gdal-dev] Sub: Gdal,
	leave one out method with GCP'S (Interpolation Equation)
In-Reply-To: <CAL9U1Wtu_-D9CWMw4cZ177ozr_X7D+ABG3JpD63aTi7-b8o4oQ@mail.gmail.com>
References: <CAL9U1Wtu_-D9CWMw4cZ177ozr_X7D+ABG3JpD63aTi7-b8o4oQ@mail.gmail.com>
Message-ID: <2354702.Zg0OleFupB@even-i700>

Pradeep Gulla,

https://github.com/OSGeo/gdal/blob/master/autotest/gcore/transformer.py
could serve as inspiration

You could use gdal.Warp() to output to a in-memory VRT and use 
gdal.Transformer() on that

Even

> Hi All,
> 
> I am georeferencing aerial images with gcps using gdal_translate and
> gdalwarp. Before georeferencing image(warping) I would like to check
> quality and final result on a control_point cp (eg disabeld gcps).
> Therefore I would like to calculate the coordinates in destination image
> for a independent control_point based on the interpolation method (n-order,
> helmet and spline) which is NOT used by warping itself.  Afterwards compare
> positions with estimated coordinates of that cp.
> 
> Example:
> Lets say, I have 10 gcps. I take 8 gcps, using `-order n` generate a
> `model`.  Then predict destination values for rest of the two control
> points using this `model`. Finally compute shift between predicted and
> actual values for these control points.
> 
> Could you please let me know if any gdal tool does this? Can any one give
> some insight how to implement this in python?
> 
> I have checked following stack exchange issues.
> 1.
> https://gis.stackexchange.com/questions/225931/python-gdal-how-to-obtain-dx-> dy-residual-errors-for-gcps-after-gdalwarp-usage (self written n-grad
> interpolation, is there any validaton form offical gdal?)
> 2. http://osgeo-org.1560.x6.nabble.com/GCPs-to-geo-transform-td3771045.html
> 3.
> https://gis.stackexchange.com/questions/102111/preserve-gcps-after-gdalwarp


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Martin.Franzke at telekom.de  Wed Feb 26 11:12:27 2020
From: Martin.Franzke at telekom.de (Martin.Franzke at telekom.de)
Date: Wed, 26 Feb 2020 19:12:27 +0000
Subject: [gdal-dev] Sub: Gdal,
 leave one out method with GCP'S (Interpolation Equation)
In-Reply-To: <CAL9U1Wtu_-D9CWMw4cZ177ozr_X7D+ABG3JpD63aTi7-b8o4oQ@mail.gmail.com>
References: <CAL9U1Wtu_-D9CWMw4cZ177ozr_X7D+ABG3JpD63aTi7-b8o4oQ@mail.gmail.com>
Message-ID: <89669C26-265C-4A2E-9A9F-11B5AEA0B2C6@telekom.de>

Hi Pradeep,
to calculate the destination coordinates of the two points, you can call gdaltransform with the same gcp parameters as gdal_translate und gdalwarp before. Gdal uses the same algorithm for transforming raster and vector data.

Martin

Von meinem iPhone gesendet

Am 26.02.2020 um 17:00 schrieb Pradeep kumar <parthivpradeep at gmail.com>:

﻿
Hi All,

I am georeferencing aerial images with gcps using gdal_translate and gdalwarp. Before georeferencing image(warping) I would like to check quality and final result on a control_point cp (eg disabeld gcps). Therefore I would like to calculate the coordinates in destination image for a independent control_point based on the interpolation method (n-order, helmet and spline) which is NOT used by warping itself.  Afterwards compare positions with estimated coordinates of that cp.

Example:
Lets say, I have 10 gcps. I take 8 gcps, using `-order n` generate a `model`.  Then predict destination values for rest of the two control points using this `model`. Finally compute shift between predicted and actual values for these control points.

Could you please let me know if any gdal tool does this? Can any one give some insight how to implement this in python?

I have checked following stack exchange issues.
1. https://gis.stackexchange.com/questions/225931/python-gdal-how-to-obtain-dx-dy-residual-errors-for-gcps-after-gdalwarp-usage (self written n-grad interpolation, is there any validaton form offical gdal?)
2. http://osgeo-org.1560.x6.nabble.com/GCPs-to-geo-transform-td3771045.html
3. https://gis.stackexchange.com/questions/102111/preserve-gcps-after-gdalwarp

--
Best Regards,
Pradeep Gulla
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200226/34e76c71/attachment.html>

From idan at miara.com  Thu Feb 27 02:29:54 2020
From: idan at miara.com (Idan Miara)
Date: Thu, 27 Feb 2020 12:29:54 +0200
Subject: [gdal-dev] raster calc with different extents
Message-ID: <CAEDrt391DMxtQjbHWvO-2U4939SveCwUNgpLp+uXuKxfQc_P0Q@mail.gmail.com>

Hi,

Is there an easy way to make calculations with rasters with the same
projection and resolution but with different extents?
i.e. adding a few rasters with partial overlap so that the result raster
would be a union or an intersection of the extents.

Something like this but with different extents:
gdal_calc.py -A input1.tif -B input2.tif --outfile=result.tif --calc="A+B"

Kind regards,
Idan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200227/c6763ccc/attachment.html>

From armin.r.schmidt at gmail.com  Thu Feb 27 04:57:38 2020
From: armin.r.schmidt at gmail.com (Armin Schmidt)
Date: Thu, 27 Feb 2020 13:57:38 +0100
Subject: [gdal-dev] Cannot use in memory raster object with gdal warp
 (GDAL Python API)
In-Reply-To: <5fee62b7-0db4-34da-f1ee-e5b3c811a266@GeodataWIZ.com>
References: <5fee62b7-0db4-34da-f1ee-e5b3c811a266@GeodataWIZ.com>
Message-ID: <c3e953cb-36b3-7156-e363-b329b117677a@Gmail.com>

Hi Umberto,

There isn't information in your question about the size of the raster 
image, but as you are reading it in chunks, it probably is large. Hence 
my guess is that your in-memory raster is not big enough to hold the 
data, without giving an error message. And the subsequent gdal.Warp 
simply cannot handle this.

If the file-raster weren't large, you could simply load it into memory 
in one command.

Armin

On 21/02/2020 16:52, umbertofilippo wrote:
> Sorry if this is a copy of a question I already asked on 
> gis.stackexchange (
> here
> <https://gis.stackexchange.com/questions/351577/cannot-use-in-memory-raster-object-with-gdal-warp-gdal-python-api>
> ), but I thought I might get more chance to receive an answer here.
>
> These are the operations I am doing in my code:
>
> 1 - reading an existing raster (tif)
> 2 - creating a in memory raster object
> 3 - reading the existing raster object in chunk as array
> 4 - making some calculations
> 5 - writing the array to my in memory object
>
> What I want to do now is, with the in memory raster object ready to be 
> used,
> feed it to gdal warp, which should also output an intermediate raster 
> object
> that I'll be use afterwards.
>
> However, when I try to GetRasterBand() out of this latter raster object, I
> receive an error because it is actually equal to None:
>
> AttributeError: 'NoneType' object has no attribute 'GetRasterBand'
>
> I am pretty sure it is about saving/updating/flushing the status of the
> raster object after the calculations but I could not find out if this 
> is the
> actual problem.
>
> How can I use in memory (intermediate) files in my script?
> Here is the code code I am using (the error is at the very last line):
>
> from osgeo import gdal, gdalconst
> import numpy as np
>
> in_raster = gdal.Open(r'/my/raster.tif', gdalconst.GA_ReadOnly)
> in_b = in_r.GetRasterBand(1)
>
> b1 = in_raster.GetRasterBand(1)
> xsize = b1.XSize
> ysize = b1.YSize
> step = 10 # THIS IS THE CHUNK SIZE!
> ystep = ysize / step
> ystep = int(ystep)
> yresidual = ysize - (ystep * step)
>
> driver = gdal.GetDriverByName("MEM")
> temp_calc = driver.Create('',
> xsize,
> ysize,
> 1,
> gdal.GDT_Float32)
>
> temp_b = temp_calc.GetRasterBand(1)
>
> for i in range(step):
> if i != step-1:
> arr_part = in_b.ReadAsArray(
> 0, ystep * i, xsize, ystep).astype('float32')
>
> data = np.nan_to_num(arr_part)
>
> temp_b.WriteArray(data, 0, ystep * i)
> else:
> arr_part = in_b.ReadAsArray(
> 0, ystep * i, xsize, ystep + yresidual).astype('float32')
>
> # replace nan with zeros
> #
> https://docs.scipy.org/doc/numpy/reference/generated/numpy.nan_to_num.html
> data = np.nan_to_num(arr_part)
>
> # write array chunk to (in memory) file
> # https://gdal.org/python/osgeo.gdal.Band-class.html#WriteArray
> temp_b.WriteArray(data, 0, ystep * i)
>
> # get raster resolution
> in_gt = in_raster.GetGeoTransform()
> in_x = in_gt[1]
> in_y = -in_gt[5]
>
> kwargs = {'xRes': in_x,
> 'yRes': in_y,
> 'targetAlignedPixels': True,
> 'resampleAlg': 'average',
> 'format': 'MEM'
> }
>
> ds = gdal.Warp('',
> temp_calc,
> **kwargs)
> b1 = ds.GetRasterBand(1)
> # ds is None and the above line throws the exception
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
__________________________________________________________________
Dr Armin Schmidt
  Dipl.-Phys., Dr. rer. nat.
GeodataWIZ: Geo Data + Visualisation
  www.GeodataWIZ.com
  www.GeodataWIZ.com/armin-schmidt
Honorary Secretary ISAP
  International Society for Archaeological Prospection
  www.archprospection.org
Honorary Visiting Research Fellow, University of Bradford
  School of Archaeological and Forensic Sciences
Honorary Fellow, Durham University
  Department of Archaeology
http://orcid.org/0000-0002-4241-5381

Email: A.Schmidt at GeodataWIZ.com

Available in print:
  Guidelines for the use of Geophysics in Archaeology (2015). Namur: EAC.
  Earth Resistance for Archaeologists (2013). Lanham: AltaMira Press
  Geophysical Data in Archaeology (2013). Oxford: Oxbow Books.
http://www.amazon.co.uk/-/e/B0034QC4OW
__________________________________________________________________

Disclaimer
==========
This email and any attachments to it may be confidential and are
intended solely for the use of the individual to whom it is
addressed. If you are not the intended recipient of this email,
you must neither take any action based upon its contents, nor
copy or show it to anyone.

Please contact the sender if you believe you have received this
email in error.
__________________________________________________________________



From cmoultonatx at gmail.com  Thu Feb 27 13:28:48 2020
From: cmoultonatx at gmail.com (Chris Moulton)
Date: Thu, 27 Feb 2020 15:28:48 -0600
Subject: [gdal-dev] Rotating a GeoTransform from a KML Superoverlay
Message-ID: <CADdW5o54L1Ezt6=-iYCOSHDe=w4uooazi9htLr=EgUHfg33EfQ@mail.gmail.com>

Hello GDAL Dev community!

First time question asker here, and it doesn't seem like this specific task
has been asked about before.

Problem: I have a bunch of KML superoverlays which I am tasked with
converting them all to geotiff. I am running into an issue with the
rotation values not being 0.0, which results in improperly georeferenced
rasters. I've attempted a few different solutions, which I'll outline below.

Here is a sample KML bounding box (exact coords omitted for anonymity):

<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="
http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2"
xmlns:atom="http://www.w3.org/2005/Atom">
<GroundOverlay>
     <name>KML Name</name>
     <Icon>
          <href>image_path.jpg</href>
          <viewBoundScale>0.75</viewBoundScale>
     </Icon>
     <LatLonBox>
          <north>40.5</north>
          <south>40.4</south>
          <east>-105.2</east>
          <west>-105.1</west>
          <rotation>58.0</rotation>
     </LatLonBox>
</GroundOverlay>

The code snippet below is my current iteration, the only inputs are
IN_KML_PATH, OUT_TIFF_NAME, and then the ROTATION value in degrees read
directly from the KML LatLonBox.

Here it is:

'''
#Dependencies
import gdal
from affine import Affine

#Driver for writing geotiff
tiff_driver = gdal.GetDriverByName('GTiff')

#Setting up data source, getting GeoTransform and other relevant info
in_ds = gdal.OpenEx(IN_KML_PATH)
in_geotransform = in_ds.GetGeoTransform()
in_projection = in_ds.GetProjection()
primary_band = in_ds.GetRasterBand(1)

#Creating an affine geotransform and rotating it 58.0 degrees anticlockwise
(KML specs)
#This is obviously where I'm going wrong, but don't quite know what I'm
missing!
af_geotransform = Affine.from_gdal(*in_geotransform)
af_geotransform *= Affine.rotation(-58.0)

#Creating out tiff
out_ds = tiff_driver.Create(OUT_TIFF_NAME,
     primary_band.XSize,
     primary_band.YSize,
     in_ds.RasterCount,
     primary_band.DataType)

#Setting projection and new geotransform
out_ds.SetProjection(in_projection)
out_ds.SetGeoTransform(af_geotransform.to_gdal())


#Writing in bands to the output image
for i in range(1, in_ds.RasterCount + 1):
     in_band = in_ds.GetRasterBand(i)
     in_data = in_band.ReadAsArray()
     out_band = out_ds.GetRasterBand(i)
     out_band.WriteArray(in_data)

#Fin
out_ds.FlushCache()
del out_ds
'''

I've tried a few different methods for rotating the in_geotransform,
including:directly changing the 'rotation' values from default 0.0 to the
rotation value in the KML. This does not result in anything resembling what
I need. I assume I'm missing a translation step in the affine
transformation, but haven't gotten too far there.

I know this was a lengthy question, I tried to be as detailed as possible
about what I've attempted so far. I don't think there is anything going
wrong per say, just reaching out to the community to see if I could get any
direction here!


Cheers,

Chris Moulton
cmoultonatx at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200227/5b73e76f/attachment.html>

From borjarf9 at gmail.com  Fri Feb 28 03:53:25 2020
From: borjarf9 at gmail.com (=?UTF-8?Q?Borja_Rodr=C3=ADguez_Fern=C3=A1ndez?=)
Date: Fri, 28 Feb 2020 12:53:25 +0100
Subject: [gdal-dev] AZURE BLOB
Message-ID: <CALAT5Vd-=JO32tqZvXkmE5Dh4k2hnxLrL-07rKni-R49+gezDg@mail.gmail.com>

Hi
I am trying to upload an image in tiff format into QGIS using Azure Blob
protocol with the name of the blob and the storage account key but I have
this error:

Layer Invalid: provider GDAL You can not open GDAL dataset / vsiaz / cog2 /
3LiES........Lack AZURE_STORAGE_ACCOUNT + AZURE_STORAGE_ACCESS_KEY or
AZURE_STORAGE_CONNECTION_STRING settings frame layer Provider is invalid
(Provider: gdal, URL: / vsiaz / cog2 / 3LiES.............

I write the name of the storage account and the key1 of that storage
account but I get an error

What could be the problem?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/73a0feb3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb 28 04:19:47 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 28 Feb 2020 05:19:47 -0700 (MST)
Subject: [gdal-dev] AZURE BLOB
In-Reply-To: <CALAT5Vd-=JO32tqZvXkmE5Dh4k2hnxLrL-07rKni-R49+gezDg@mail.gmail.com>
References: <CALAT5Vd-=JO32tqZvXkmE5Dh4k2hnxLrL-07rKni-R49+gezDg@mail.gmail.com>
Message-ID: <1582892387056-0.post@n6.nabble.com>

Hi,

Do you really have spaces in your URL string?

-Jukka Rahkonen-


Borja Rodríguez Fernández wrote
> Hi
> I am trying to upload an image in tiff format into QGIS using Azure Blob
> protocol with the name of the blob and the storage account key but I have
> this error:
> 
> Layer Invalid: provider GDAL You can not open GDAL dataset / vsiaz / cog2
> /
> 3LiES........Lack AZURE_STORAGE_ACCOUNT + AZURE_STORAGE_ACCESS_KEY or
> AZURE_STORAGE_CONNECTION_STRING settings frame layer Provider is invalid
> (Provider: gdal, URL: / vsiaz / cog2 / 3LiES.............
> 
> I write the name of the storage account and the key1 of that storage
> account but I get an error
> 
> What could be the problem?
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From justb4 at gmail.com  Fri Feb 28 04:28:11 2020
From: justb4 at gmail.com (Just van den Broecke)
Date: Fri, 28 Feb 2020 13:28:11 +0100
Subject: [gdal-dev] Q: GFS Type for int64/bigint?
Message-ID: <f5d2fd80-40af-aabe-1a63-b15c597d4c43@gmail.com>

Hi,

I use ogr2ogr (GML to PG) with a .gfs file with Type specs.  I need to 
map a GML integer value to eventually a BigInt in PostgreSQL. I see 
String, Integer, Real etc. "Integer" maps to "integer" type in 
PostgreSQL but I need to map to a PG BigInt.

What Type do I need to specify in the .gfs file? Tried Integer64, Long 
etc. Or is there no such Type? Could not figure from the OGR GML Driver 
doc. I can use GFS Type Real and later cast to bigint in PostgreSQL, but 
is somewhat involved.

Best,

Just van den Broecke
The Netherlands

From even.rouault at spatialys.com  Fri Feb 28 04:45:41 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Feb 2020 13:45:41 +0100
Subject: [gdal-dev] Q: GFS Type for int64/bigint?
In-Reply-To: <f5d2fd80-40af-aabe-1a63-b15c597d4c43@gmail.com>
References: <f5d2fd80-40af-aabe-1a63-b15c597d4c43@gmail.com>
Message-ID: <2100206.UFztnACjyB@even-i700>

Just,

> I use ogr2ogr (GML to PG) with a .gfs file with Type specs.  I need to
> map a GML integer value to eventually a BigInt in PostgreSQL. I see
> String, Integer, Real etc. "Integer" maps to "integer" type in
> PostgreSQL but I need to map to a PG BigInt.
> 
> What Type do I need to specify in the .gfs file?

Use
<Type>Integer</Type>
<SubType>Integer64</SubType>

See
https://github.com/OSGeo/gdal/blob/7f942653f570f3e99cf0273e979272190cc6c312/gdal/data/ruian_vf_v1.gfs#L60

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From justb4 at gmail.com  Fri Feb 28 04:51:48 2020
From: justb4 at gmail.com (Just van den Broecke)
Date: Fri, 28 Feb 2020 13:51:48 +0100
Subject: [gdal-dev] Q: GFS Type for int64/bigint?
In-Reply-To: <2100206.UFztnACjyB@even-i700>
References: <f5d2fd80-40af-aabe-1a63-b15c597d4c43@gmail.com>
 <2100206.UFztnACjyB@even-i700>
Message-ID: <ea70d0a7-412d-4e8f-752b-11705eb49edf@gmail.com>

Hi Even, Aha, thanks for quick reply! Best, Just

On 28-02-20 13:45, Even Rouault wrote:
> Just,
> 
>> I use ogr2ogr (GML to PG) with a .gfs file with Type specs.  I need to
>> map a GML integer value to eventually a BigInt in PostgreSQL. I see
>> String, Integer, Real etc. "Integer" maps to "integer" type in
>> PostgreSQL but I need to map to a PG BigInt.
>>
>> What Type do I need to specify in the .gfs file?
> 
> Use
> <Type>Integer</Type>
> <SubType>Integer64</SubType>
> 
> See
> https://github.com/OSGeo/gdal/blob/7f942653f570f3e99cf0273e979272190cc6c312/gdal/data/ruian_vf_v1.gfs#L60
> 
> Even
> 


From xbartolone at gmail.com  Fri Feb 28 06:10:46 2020
From: xbartolone at gmail.com (Francesco Bartoli)
Date: Fri, 28 Feb 2020 15:10:46 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
Message-ID: <f8477475-fe11-4c6e-a370-b922b9d33a65@Spark>

Dear devs,

In the pygeoapi project we are experiencing this issue https://github.com/geopython/pygeoapi/issues/371. I've just started a PR https://github.com/geopython/pygeoapi/pull/372 hich basically tries to catch if all properties of the feature have null values and raise an exception ourself.
Catching null values is due because GDAL doesn't throw the exception if OGR_GEOJSON_MAX_OBJ_SIZE has the default value. I'm wondering if this is a bug or an expected behavior. If it is then I will file an issue.

Best,
Francesco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/9a32c002/attachment-0001.html>

From even.rouault at spatialys.com  Fri Feb 28 06:19:52 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Feb 2020 15:19:52 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <f8477475-fe11-4c6e-a370-b922b9d33a65@Spark>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <f8477475-fe11-4c6e-a370-b922b9d33a65@Spark>
Message-ID: <2198812.CLDSvcy3v0@even-i700>

On vendredi 28 février 2020 15:10:46 CET Francesco Bartoli wrote:
> Dear devs,
> 
> In the pygeoapi project we are experiencing this
> issue https://github.com/geopython/pygeoapi/issues/371. I've just started a
> PR https://github.com/geopython/pygeoapi/pull/372 hich basically tries to
> catch if all properties of the feature have null values and raise an
> exception ourself. Catching null values is due because GDAL doesn't throw
> the exception if OGR_GEOJSON_MAX_OBJ_SIZE has the default value. I'm
> wondering if this is a bug or an expected behavior. If it is then I will
> file an issue.

Use ogr.UseExceptions() (instead of gdal.UseExceptions())

Enabling exceptions is controlled separately in the 2 Python modules.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From xbartolone at gmail.com  Fri Feb 28 06:22:04 2020
From: xbartolone at gmail.com (Francesco Bartoli)
Date: Fri, 28 Feb 2020 15:22:04 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <2198812.CLDSvcy3v0@even-i700>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <f8477475-fe11-4c6e-a370-b922b9d33a65@Spark>
 <2198812.CLDSvcy3v0@even-i700>
Message-ID: <8ade7046-dca8-41bd-acd0-f1969d70054c@Spark>

Ahh I didn’t know, thanks Even

Francesco
Il 28 feb 2020, 15:19 +0100, Even Rouault <even.rouault at spatialys.com>, ha scritto:
> On vendredi 28 février 2020 15:10:46 CET Francesco Bartoli wrote:
> > Dear devs,
> >
> > In the pygeoapi project we are experiencing this
> > issue https://github.com/geopython/pygeoapi/issues/371. I've just started a
> > PR https://github.com/geopython/pygeoapi/pull/372 hich basically tries to
> > catch if all properties of the feature have null values and raise an
> > exception ourself. Catching null values is due because GDAL doesn't throw
> > the exception if OGR_GEOJSON_MAX_OBJ_SIZE has the default value. I'm
> > wondering if this is a bug or an expected behavior. If it is then I will
> > file an issue.
>
> Use ogr.UseExceptions() (instead of gdal.UseExceptions())
>
> Enabling exceptions is controlled separately in the 2 Python modules.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/eb756d0d/attachment.html>

From pedrongvenancio at gmail.com  Fri Feb 28 06:28:26 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Fri, 28 Feb 2020 14:28:26 +0000
Subject: [gdal-dev] ogr2ogr command to coordinate transform using NTv2 grids
	in GDAL 3+
Message-ID: <CAMCJChtoL+9+os4iFtFCZTuOzREGPTSDMPGGO+JkqChyWDtK2Q@mail.gmail.com>

Dear all,

I'm trying to make transformations with ogr2ogr, using NTv2 grids, in
GDAL/OGR 3, and it does not work.

The command I was using in GDAL/OGR 2 is

ogr2ogr -s_srs "+proj=tmerc +lat_0=39.66666666666666 +lon_0=1 +k=1
+x_0=200000 +y_0=300000 +ellps=intl
+nadgrids=C:\Users\PedroVenancio\AppData\Roaming\QGIS\QGIS3\profiles\default\python\plugins\ntv2_transformations\grids\DLx_ETRS89_geo.gsb
+wktext +pm=lisbon +units=m +no_defs" -t_srs EPSG:3763 -f "ESRI Shapefile"
-lco ENCODING=UTF-8
D:/Testes/postos_vigia/postos_vigia_rede_nacional_3763.shp
D:\Testes\postos_vigia\postos_vigia_rede_nacional_20790.shp

and the result in GDAL/OGR 3.0.2 or 3.0.4 is

ERROR 1: Failed to reproject feature 0 (geometry probably out of source or
destination SRS).
ERROR 1: Terminating translation prematurely after failed
translation of layer postos_vigia_rede_nacional_20790 (use -skipfailures to
skip errors)

This command works well in GDAL/OGR 2.4.0 and 2.4.2.

Looking at the ogr2ogr documentation, I've found the new -ct option

https://gdal.org/programs/ogr2ogr.html#cmdoption-ogr2ogr-ct

So, I can run the transformation in GDAL/OGR 3, with the command

ogr2ogr -s_srs EPSG:20790 -t_srs EPSG:3763 -ct "+proj=pipeline +step +inv
+proj=tmerc +lat_0=39.6666666666667 +lon_0=1 +k=1 +x_0=200000 +y_0=300000
+ellps=intl +pm=lisbon +step +proj=hgridshift +grids=DLx_ETRS89_geo.gsb
+step +proj=tmerc +lat_0=39.6682583333333 +lon_0=-8.13310833333333 +k=1
+x_0=0 +y_0=0 +ellps=GRS80" -f "ESRI Shapefile" -lco ENCODING=UTF-8
D:/Testes/postos_vigia/postos_vigia_rede_nacional_3763_17.shp
D:\Testes\postos_vigia\postos_vigia_rede_nacional_20790.shp

I've get the -ct string from QGIS and it works as expected, but the command
becomes much more complex and not compatible with GDAL/OGR 2.x versions.

Is this the only and best way to make this operation, with NTv2 grids, in
GDAL/OGR 3?

And where can I find documentation about the WKT2 string describing the
CoordinateOperation to use in -ct? I can always use QGIS, but it is not
very handy, and I suspect that I'm not using the best approach.

Thank you very much!

Best regards,
Pedro Venâncio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/bb8ab169/attachment.html>

From even.rouault at spatialys.com  Fri Feb 28 07:51:39 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Feb 2020 16:51:39 +0100
Subject: [gdal-dev] ogr2ogr command to coordinate transform using NTv2
	grids in GDAL 3+
In-Reply-To: <CAMCJChtoL+9+os4iFtFCZTuOzREGPTSDMPGGO+JkqChyWDtK2Q@mail.gmail.com>
References: <CAMCJChtoL+9+os4iFtFCZTuOzREGPTSDMPGGO+JkqChyWDtK2Q@mail.gmail.com>
Message-ID: <42787649.3dE6jCgg87@even-i700>

Pedro,

> I'm trying to make transformations with ogr2ogr, using NTv2 grids, in
> GDAL/OGR 3, and it does not work.
> 
> The command I was using in GDAL/OGR 2 is
> 
> ogr2ogr -s_srs "+proj=tmerc +lat_0=39.66666666666666 +lon_0=1 +k=1
> +x_0=200000 +y_0=300000 +ellps=intl
> +nadgrids=C:\Users\PedroVenancio\AppData\Roaming\QGIS\QGIS3\profiles\default
> \python\plugins\ntv2_transformations\grids\DLx_ETRS89_geo.gsb +wktext
> +pm=lisbon +units=m +no_defs" -t_srs EPSG:3763 -f "ESRI Shapefile" -lco
> ENCODING=UTF-8
> D:/Testes/postos_vigia/postos_vigia_rede_nacional_3763.shp
> D:\Testes\postos_vigia\postos_vigia_rede_nacional_20790.shp
> 
> and the result in GDAL/OGR 3.0.2 or 3.0.4 is
> 
> ERROR 1: Failed to reproject feature 0 (geometry probably out of source or
> destination SRS).
> ERROR 1: Terminating translation prematurely after failed
> translation of layer postos_vigia_rede_nacional_20790 (use -skipfailures to
> skip errors)
> 
> This command works well in GDAL/OGR 2.4.0 and 2.4.2.

Arg, I found this was a bug of PROJ >= 6. I've just submitted a fix for it in 
https://github.com/OSGeo/PROJ/pull/1998
The issue came from using both +nadgrids and +pm, which wasn't handled 
correctly, and resulted in grid transformation being done with longitudes 
expressed in Lisbon prime meridan instead of Greenwich

> And where can I find documentation about the WKT2 string describing the
> CoordinateOperation to use in -ct?

Create coordinate operations in WKT2 can be really tedious. The best reference 
is probably the standard itself:
http://docs.opengeospatial.org/is/18-010r7/18-010r7.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pedrongvenancio at gmail.com  Fri Feb 28 08:04:16 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Fri, 28 Feb 2020 16:04:16 +0000
Subject: [gdal-dev] ogr2ogr command to coordinate transform using NTv2
 grids in GDAL 3+
In-Reply-To: <42787649.3dE6jCgg87@even-i700>
References: <CAMCJChtoL+9+os4iFtFCZTuOzREGPTSDMPGGO+JkqChyWDtK2Q@mail.gmail.com>
 <42787649.3dE6jCgg87@even-i700>
Message-ID: <CAMCJChtTdJKS9ArF+qkTdurV_-FqpezsBBDukR_AkcaDXvaiPg@mail.gmail.com>

Thank you very much Even!

As usual, faster fix was completely impossible! :)

Best regards,
Pedro


Even Rouault <even.rouault at spatialys.com> escreveu no dia sexta, 28/02/2020
à(s) 15:51:

> Pedro,
>
> > I'm trying to make transformations with ogr2ogr, using NTv2 grids, in
> > GDAL/OGR 3, and it does not work.
> >
> > The command I was using in GDAL/OGR 2 is
> >
> > ogr2ogr -s_srs "+proj=tmerc +lat_0=39.66666666666666 +lon_0=1 +k=1
> > +x_0=200000 +y_0=300000 +ellps=intl
> >
> +nadgrids=C:\Users\PedroVenancio\AppData\Roaming\QGIS\QGIS3\profiles\default
> > \python\plugins\ntv2_transformations\grids\DLx_ETRS89_geo.gsb +wktext
> > +pm=lisbon +units=m +no_defs" -t_srs EPSG:3763 -f "ESRI Shapefile" -lco
> > ENCODING=UTF-8
> > D:/Testes/postos_vigia/postos_vigia_rede_nacional_3763.shp
> > D:\Testes\postos_vigia\postos_vigia_rede_nacional_20790.shp
> >
> > and the result in GDAL/OGR 3.0.2 or 3.0.4 is
> >
> > ERROR 1: Failed to reproject feature 0 (geometry probably out of source
> or
> > destination SRS).
> > ERROR 1: Terminating translation prematurely after failed
> > translation of layer postos_vigia_rede_nacional_20790 (use -skipfailures
> to
> > skip errors)
> >
> > This command works well in GDAL/OGR 2.4.0 and 2.4.2.
>
> Arg, I found this was a bug of PROJ >= 6. I've just submitted a fix for it
> in
> https://github.com/OSGeo/PROJ/pull/1998
> The issue came from using both +nadgrids and +pm, which wasn't handled
> correctly, and resulted in grid transformation being done with longitudes
> expressed in Lisbon prime meridan instead of Greenwich
>
> > And where can I find documentation about the WKT2 string describing the
> > CoordinateOperation to use in -ct?
>
> Create coordinate operations in WKT2 can be really tedious. The best
> reference
> is probably the standard itself:
> http://docs.opengeospatial.org/is/18-010r7/18-010r7.html
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/fbe5e7bf/attachment.html>

From xbartolone at gmail.com  Fri Feb 28 08:22:28 2020
From: xbartolone at gmail.com (Francesco Bartoli)
Date: Fri, 28 Feb 2020 17:22:28 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <2198812.CLDSvcy3v0@even-i700>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <f8477475-fe11-4c6e-a370-b922b9d33a65@Spark>
 <2198812.CLDSvcy3v0@even-i700>
Message-ID: <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>

However, we are using both modules so how can we handle exceptions properly for both of them?

Using ogr.UseExceptions() the call https://github.com/geopython/pygeoapi/pull/372/files#diff-b105ae3f7a36059b16bdc16a08071016R361 gives the same result silently without any message to system output this time.

Thanks,
Francesco
Il 28 feb 2020, 15:19 +0100, Even Rouault <even.rouault at spatialys.com>, ha scritto:
> On vendredi 28 février 2020 15:10:46 CET Francesco Bartoli wrote:
> > Dear devs,
> >
> > In the pygeoapi project we are experiencing this
> > issue https://github.com/geopython/pygeoapi/issues/371. I've just started a
> > PR https://github.com/geopython/pygeoapi/pull/372 hich basically tries to
> > catch if all properties of the feature have null values and raise an
> > exception ourself. Catching null values is due because GDAL doesn't throw
> > the exception if OGR_GEOJSON_MAX_OBJ_SIZE has the default value. I'm
> > wondering if this is a bug or an expected behavior. If it is then I will
> > file an issue.
>
> Use ogr.UseExceptions() (instead of gdal.UseExceptions())
>
> Enabling exceptions is controlled separately in the 2 Python modules.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200228/84a6d19e/attachment-0001.html>

From even.rouault at spatialys.com  Fri Feb 28 08:29:54 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Feb 2020 17:29:54 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <2198812.CLDSvcy3v0@even-i700> <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>
Message-ID: <3050483.EyXBC9cvJK@even-i700>

On vendredi 28 février 2020 17:22:28 CET Francesco Bartoli wrote:
> However, we are using both modules so how can we handle exceptions properly
> for both of them?

You can use both gdal.UseExceptions() and ogr.UseExceptions()

> 
> Using ogr.UseExceptions() the
> call https://github.com/geopython/pygeoapi/pull/372/files#diff-b105ae3f7a36
> 059b16bdc16a08071016R361 gives the same result silently without any message
> to system output this time.

On a quick test, ogr.UseExceptions() does the job for me:

$ OGR_GEOJSON_MAX_OBJ_SIZE=0 python
>>> from osgeo import ogr
>>> ogr.UseExceptions()
>>> ds = ogr.Open('poly.geojson')
>>> lyr = ds.GetLayer(0)
>>> lyr.GetNextFeature()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/even/gdal/git/gdal/gdal/swig/python/build/lib.linux-x86_64-2.7/
osgeo/ogr.py", line 1339, in GetNextFeature
    return _ogr.Layer_GetNextFeature(self, *args)
RuntimeError: GeoJSON object too complex, please see the 
OGR_GEOJSON_MAX_OBJ_SIZE environment option
>>> 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From justb4 at gmail.com  Fri Feb 28 08:49:22 2020
From: justb4 at gmail.com (Just van den Broecke)
Date: Fri, 28 Feb 2020 17:49:22 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <3050483.EyXBC9cvJK@even-i700>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <2198812.CLDSvcy3v0@even-i700> <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>
 <3050483.EyXBC9cvJK@even-i700>
Message-ID: <a65c28e8-ca53-cbf0-6495-122272a47145@gmail.com>

On 28-02-20 17:29, Even Rouault wrote:
> On vendredi 28 février 2020 17:22:28 CET Francesco Bartoli wrote:
>> However, we are using both modules so how can we handle exceptions properly
>> for both of them?
AFAIK we only use OGR (vector) currently within pygeoapi, no raster/GDAL 
yet.
> 
> You can use both gdal.UseExceptions() and ogr.UseExceptions()
My bad: in the initial version of the pygeoapi OGRProvider I added 
gdal.UseExceptions() from example code (py-gdalogr-cookbook). Was not 
aware of ogr.UseExceptions()!

> 
>>
>> Using ogr.UseExceptions() the
>> call https://github.com/geopython/pygeoapi/pull/372/files#diff-b105ae3f7a36
>> 059b16bdc16a08071016R361 gives the same result silently without any message
>> to system output this time.
> 
> On a quick test, ogr.UseExceptions() does the job for me:
> 
> $ OGR_GEOJSON_MAX_OBJ_SIZE=0 python
>>>> from osgeo import ogr
>>>> ogr.UseExceptions()
>>>> ds = ogr.Open('poly.geojson')
>>>> lyr = ds.GetLayer(0)
>>>> lyr.GetNextFeature()
> Traceback (most recent call last):
>    File "<stdin>", line 1, in <module>
>    File "/home/even/gdal/git/gdal/gdal/swig/python/build/lib.linux-x86_64-2.7/
> osgeo/ogr.py", line 1339, in GetNextFeature
>      return _ogr.Layer_GetNextFeature(self, *args)
> RuntimeError: GeoJSON object too complex, please see the
> OGR_GEOJSON_MAX_OBJ_SIZE environment option
>>>>
> 


From xbartolone at gmail.com  Sat Feb 29 11:07:30 2020
From: xbartolone at gmail.com (Francesco Bartoli)
Date: Sat, 29 Feb 2020 20:07:30 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <a65c28e8-ca53-cbf0-6495-122272a47145@gmail.com>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <2198812.CLDSvcy3v0@even-i700>
 <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>
 <3050483.EyXBC9cvJK@even-i700>
 <a65c28e8-ca53-cbf0-6495-122272a47145@gmail.com>
Message-ID: <6817e313-9475-4510-91ee-31000ec06e62@Spark>

Il 28 feb 2020, 17:49 +0100, Just van den Broecke <justb4 at gmail.com>, ha scritto:
> On 28-02-20 17:29, Even Rouault wrote:
> > On vendredi 28 février 2020 17:22:28 CET Francesco Bartoli wrote:
> > > However, we are using both modules so how can we handle exceptions properly
> > > for both of them?
> AFAIK we only use OGR (vector) currently within pygeoapi, no raster/GDAL
> yet.

We are using both https://github.com/geopython/pygeoapi/blob/9d6322a9733313a98664d65a5d42e119802c3e3b/pygeoapi/provider/ogr.py#L101-L104 even though without any real spatial operation from GDAL
> >
> > You can use both gdal.UseExceptions() and ogr.UseExceptions()
> My bad: in the initial version of the pygeoapi OGRProvider I added
> gdal.UseExceptions() from example code (py-gdalogr-cookbook). Was not
> aware of ogr.UseExceptions()!
>
> >
> > >
> > > Using ogr.UseExceptions() the
> > > call https://github.com/geopython/pygeoapi/pull/372/files#diff-b105ae3f7a36
> > > 059b16bdc16a08071016R361 gives the same result silently without any message
> > > to system output this time.
> >
> > On a quick test, ogr.UseExceptions() does the job for me:
> >
> > $ OGR_GEOJSON_MAX_OBJ_SIZE=0 python
> > > > > from osgeo import ogr
> > > > > ogr.UseExceptions()
> > > > > ds = ogr.Open('poly.geojson')
> > > > > lyr = ds.GetLayer(0)
> > > > > lyr.GetNextFeature()
> > Traceback (most recent call last):
> > File "<stdin>", line 1, in <module>
> > File "/home/even/gdal/git/gdal/gdal/swig/python/build/lib.linux-x86_64-2.7/
> > osgeo/ogr.py", line 1339, in GetNextFeature
> > return _ogr.Layer_GetNextFeature(self, *args)
> > RuntimeError: GeoJSON object too complex, please see the
> > OGR_GEOJSON_MAX_OBJ_SIZE environment option
> > > > >
> >
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200229/e4d88022/attachment.html>

From xbartolone at gmail.com  Sat Feb 29 11:34:14 2020
From: xbartolone at gmail.com (Francesco Bartoli)
Date: Sat, 29 Feb 2020 20:34:14 +0100
Subject: [gdal-dev] Handle geojson bigger than 200MB
In-Reply-To: <3050483.EyXBC9cvJK@even-i700>
References: <687fa626-ab91-40ef-9ee8-ed63de93341d@Spark>
 <2198812.CLDSvcy3v0@even-i700>
 <3b6a6124-cca3-4cd2-a1e2-6aca7b55cbd2@Spark>
 <3050483.EyXBC9cvJK@even-i700>
Message-ID: <34cd4704-d2e1-4c96-b707-5a60029cb91b@Spark>

Thanks Even, it works but I have strange result with the size value. I wouldn’t have been expected the exception from this test:

$ OGR_GEOJSON_MAX_OBJ_SIZE=500MB ogr2ogr -f "GeoJSON" indonesia.geojson "WFS:geonode.wfp.org/geoserver/wfs?request=GetFeature&typename=geonode:glb_bnd_adm0_1&outputformat=json" -where “adm0_id=‘272’"

indonesia.geojson is around 35MB so the exception shouldn’t raise if OGR_GEOJSON_MAX_OBJ_SIZE=50 AFAIK:

$ python
Python 3.7.6 (default, Jan 28 2020, 15:35:48)
[Clang 11.0.0 (clang-1100.0.33.17)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> os.environ["OGR_GEOJSON_MAX_OBJ_SIZE"] = “50”
>>> from osgeo import ogr
>>> ogr.UseExceptions()
>>> ds = ogr.Open('/Users/geobart/Downloads/indonesia.geojson’)
>>> lyr = ds.GetLayer(0)
>>> lyr.GetNextFeature()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/Users/geobart/.pyenv/versions/pygeoapi/lib/python3.7/site-packages/osgeo/ogr.py", line 1632, in GetNextFeature
    return _ogr.Layer_GetNextFeature(self, *args)
RuntimeError: GeoJSON object too complex, please see the OGR_GEOJSON_MAX_OBJ_SIZE environment option

Is it a bug?
Il 28 feb 2020, 17:29 +0100, Even Rouault <even.rouault at spatialys.com>, ha scritto:
> On vendredi 28 février 2020 17:22:28 CET Francesco Bartoli wrote:
> > However, we are using both modules so how can we handle exceptions properly
> > for both of them?
>
> You can use both gdal.UseExceptions() and ogr.UseExceptions()
>
> >
> > Using ogr.UseExceptions() the
> > call https://github.com/geopython/pygeoapi/pull/372/files#diff-b105ae3f7a36
> > 059b16bdc16a08071016R361 gives the same result silently without any message
> > to system output this time.
>
> On a quick test, ogr.UseExceptions() does the job for me:
>
> $ OGR_GEOJSON_MAX_OBJ_SIZE=0 python
> > > > from osgeo import ogr
> > > > ogr.UseExceptions()
> > > > ds = ogr.Open('poly.geojson')
> > > > lyr = ds.GetLayer(0)
> > > > lyr.GetNextFeature()
> Traceback (most recent call last):
> File "<stdin>", line 1, in <module>
> File "/home/even/gdal/git/gdal/gdal/swig/python/build/lib.linux-x86_64-2.7/
> osgeo/ogr.py", line 1339, in GetNextFeature
> return _ogr.Layer_GetNextFeature(self, *args)
> RuntimeError: GeoJSON object too complex, please see the
> OGR_GEOJSON_MAX_OBJ_SIZE environment option
> > > >
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200229/33d2fe9d/attachment.html>

From jluis at ualg.pt  Sat Feb 29 11:50:44 2020
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 29 Feb 2020 19:50:44 +0000
Subject: [gdal-dev] netcdf warnings
Message-ID: <DB8PR04MB6697B116E5638C2B69D85C53A6E90@DB8PR04MB6697.eurprd04.prod.outlook.com>

Hi,

There are a couple of issues that show when I run this test case.

First is that ERROR 3

$ gdal_grid -ot Float32 -txe 0.000000 10.000000 -tye 0.000000 10.000000 -outsize 201 201 -a nearest lixo.vrt junk.nc
Warning 1: Several drivers matching nc extension. Using NETCDF
0...10...20...30...40...50...60...70...80...90...100 - done.
ERROR 3: An attempt to read an undefined ID from virtual variable collection was made

Repeating the command (that is, overwriting the grid) shows more warnings, namely the "dimension #1 (lon) is not a Longitude/X dimension"

$ gdal_grid -ot Float32 -txe 0.000000 10.000000 -tye 0.000000 10.000000 -outsize 201 201 -a nearest lixo.vrt junk.nc
Warning 1: Several drivers matching nc extension. Using NETCDF
Warning 1: The dataset has several variables that could be identified as vector fields, but not all share the same primary dimension. Consequently they will be ignored.
Warning 1: dimension #1 (lon) is not a Longitude/X dimension.
Warning 1: dimension #0 (lat) is not a Latitude/Y dimension.
0...10...20...30...40...50...60...70...80...90...ERROR 3: An attempt to read an undefined ID from virtual variable collection was made

Which also show in gdalinfo

$ gdalinfo junk.nc
Warning 1: dimension #1 (lon) is not a Longitude/X dimension.
Warning 1: dimension #0 (lat) is not a Latitude/Y dimension.
Driver: netCDF/Network Common Data Format
...

I see that the x,y coordinates are always named "lon,lat" but data is not in geographics those names are not true. In GMT we call them "x,y" what data represent cartesian units or "lon,lat" when they are geographic. As a consequence of this, gdalinfo report those "not a Longitude/X dimension" warnings for the former case when the nc grid has not an "spatial_ref" attribute.

The data used in this example is attached


Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200229/c3b50fec/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lixo.vrt
Type: application/octet-stream
Size: 278 bytes
Desc: lixo.vrt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200229/c3b50fec/attachment-0002.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lixo.csv
Type: application/octet-stream
Size: 190 bytes
Desc: lixo.csv
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200229/c3b50fec/attachment-0003.obj>

