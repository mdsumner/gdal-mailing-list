From even.rouault at spatialys.com  Sat Oct  1 02:57:53 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 1 Oct 2016 11:57:53 +0200
Subject: [gdal-dev] SQL FID 0- or 1-based
In-Reply-To: <CAAcGz9-n1+mY-6+wbkasVuZj+P7woo-uX1Tns7SZCE8nX6iEFw@mail.gmail.com>
References: <CAAcGz9-n1+mY-6+wbkasVuZj+P7woo-uX1Tns7SZCE8nX6iEFw@mail.gmail.com>
Message-ID: <201610011157.53337.even.rouault@spatialys.com>

Le samedi 01 octobre 2016 08:20:06, Michael Sumner a écrit :
> Hello, I'm seeing that the OGRSQL virtual FID value is 0-based for
> shapefile, and 1-based for MapInfo (TAB or MIF).
> 
> Is this driver-dependent generally, or is shapefile (or MI?) a special
> case?

There's no general rule. I think 1-based must be more common among drivers 
though.

I see GeoJSON is 0-based (if the GeoJSON has no id member)
SQLite/GPKG : 1-based (at least when OGR creates the FID)
KML: 0-based but LIBKML: 1-based

> 
> Using the autotest data I see
> 
> ## no feature returned (there are 2)
> ogrinfo autotest/ogr/data/seamless_part1.tab -sql "SELECT * FROM
> seamless_part1 WHERE FID = 0"
> 
> ## one feature returned
> ogrinfo autotest/ogr/data/seamless_part1.tab -sql "SELECT * FROM
> seamless_part1 WHERE FID = 2"
> 
> ## create analogous SHP
> ogr2ogr shp autotest/ogr/data/seamless_part1.tab seamless_part1
> 
> ## one feature returned
> ogrinfo shp -sql "SELECT * FROM seamless_part1 WHERE FID = 0"
> 
> ## no feature returned
> ogrinfo shp -sql "SELECT * FROM seamless_part1 WHERE FID = 2"
> 
> Cheers, Mike.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jaak at nutiteq.com  Sat Oct  1 12:47:59 2016
From: jaak at nutiteq.com (Jaak Laineste)
Date: Sat, 1 Oct 2016 22:47:59 +0300
Subject: [gdal-dev] geojson size matters?
Message-ID: <6E786FA5-18EF-443E-BB49-728A10950D60@nutiteq.com>

I have a big geojson (4.83G) and try to convert it using ogr2ogr (GDAL 2.1.1, released 2016/07/07, Mac), but after 6 minutes of processing it terminates with:

ERROR 1: GeoJSON parsing error: continue (at offset -1)
ERROR 4: Failed to read GeoJSON data
FAILURE:
Unable to open datasource `geonames.geojson’ with the following drivers.
…

Also I was not able to open same file with QGIS (it tried to consume 50+G RAM and crashed). The file is here: https://dl.dropboxusercontent.com/u/3573333/tmp/geonames.geojson.bz2

I have similar smaller file from same proces, with size just below 2G and that one works fine. So it looks like some 2G or 4G size issue.

Is there maximum size for readable GeoJSON files?


Jaak
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161001/a24851d2/attachment.html>

From even.rouault at spatialys.com  Sat Oct  1 14:47:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 1 Oct 2016 23:47:12 +0200
Subject: [gdal-dev] geojson size matters?
In-Reply-To: <6E786FA5-18EF-443E-BB49-728A10950D60@nutiteq.com>
References: <6E786FA5-18EF-443E-BB49-728A10950D60@nutiteq.com>
Message-ID: <201610012347.12787.even.rouault@spatialys.com>

Le samedi 01 octobre 2016 21:47:59, Jaak Laineste a écrit :
> I have a big geojson (4.83G) and try to convert it using ogr2ogr (GDAL
> 2.1.1, released 2016/07/07, Mac), but after 6 minutes of processing it
> terminates with:
> 
> ERROR 1: GeoJSON parsing error: continue (at offset -1)

This would seem to suggest something invalid in the GeoJSON, but this might be 
an artifact of an out of memory situation.

> ERROR 4: Failed to read GeoJSON data
> FAILURE:
> Unable to open datasource `geonames.geojson’ with the following drivers.
> …
> 
> Also I was not able to open same file with QGIS (it tried to consume 50+G
> RAM and crashed). The file is here:
> https://dl.dropboxusercontent.com/u/3573333/tmp/geonames.geojson.bz2
> 
> I have similar smaller file from same proces, with size just below 2G and
> that one works fine. So it looks like some 2G or 4G size issue.
> 
> Is there maximum size for readable GeoJSON files?

If you have lots of RAM, no. But the current reader typically requires an 
amout of RAM that is at least 10 times or more than the file size.

Known as https://trac.osgeo.org/gdal/ticket/6540

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Oct  3 00:49:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 3 Oct 2016 09:49:09 +0200
Subject: [gdal-dev] Call for discussion on RFC 66: OGR random layer
	read/write capabilities
In-Reply-To: <201609281358.31295.even.rouault@spatialys.com>
References: <201609281358.31295.even.rouault@spatialys.com>
Message-ID: <201610030949.09607.even.rouault@spatialys.com>

If nobody has remarks on it, I'll call for a vote on this on Wednesday.

Even

> Hi,
> 
> This is a call for discussion on "RFC 66: OGR random layer read/write
> capabilities" :
> 
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
> 
> This RFC introduces a new API to be able to iterate over vector features at
> dataset level, in addition to the existing capability of doing it at the
> layer level. The existing capability of writing features in layers in
> random order, that is supported by most drivers with output capabilities,
> is formalized with a new dataset capability flag.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From francisco.javier.calzado at ericsson.com  Mon Oct  3 02:34:39 2016
From: francisco.javier.calzado at ericsson.com (Francisco Javier Calzado)
Date: Mon, 3 Oct 2016 09:34:39 +0000
Subject: [gdal-dev] Multithread deadlock
In-Reply-To: <201609300104.49561.even.rouault@spatialys.com>
References: <6BA6E0BBA9988E428FA9178AB0B28B4857673E13@ESESSMB205.ericsson.se>
 <6BA6E0BBA9988E428FA9178AB0B28B4857675043@ESESSMB205.ericsson.se>
 <201609281010.41346.even.rouault@spatialys.com>
 <201609300104.49561.even.rouault@spatialys.com>
Message-ID: <6BA6E0BBA9988E428FA9178AB0B28B48576792C9@ESESSMB205.ericsson.se>

Thank you so much Even. It is working like a charm!

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: 30 September, 2016 01:05
To: gdal-dev at lists.osgeo.org
Cc: Francisco Javier Calzado <francisco.javier.calzado at ericsson.com>
Subject: Re: [gdal-dev] Multithread deadlock

> I don't think this comes from GDALPam, but rather from the lower level 
> machinery of GDALRasterBand & GDALRasterBlock. As I said before, 
> multi- threaded writing has never properly worked and I'm not sure if 
> the issue you see is just an implementation bug or a design bug.

OK, after investigation, it was just an implementation bug. A lack of mutex in
GetLockedBlock() that caused IReadBlock() & IWriteBlock() to be called from 2 different threads on the same dataset.

Fixed per https://trac.osgeo.org/gdal/ticket/6665

I think the issue was mostly due to using the low level
GetLockedBlock()/MarkDirty()/DropLock() interfaces, and that people using
RasterIO(GF_Read/GF_Write) should be immune to that bug due to locks being already taken at that stage.

Anyway fixed now (with a new test case similar to yours). Thanks for the reproducers.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From howard at hobu.co  Mon Oct  3 08:49:34 2016
From: howard at hobu.co (Howard Butler)
Date: Mon, 3 Oct 2016 10:49:34 -0500
Subject: [gdal-dev] Call for discussion on RFC 66: OGR random layer
 read/write capabilities
In-Reply-To: <201610030949.09607.even.rouault@spatialys.com>
References: <201609281358.31295.even.rouault@spatialys.com>
 <201610030949.09607.even.rouault@spatialys.com>
Message-ID: <366206EB-DC5B-42BB-B299-2B91E4B3E120@hobu.co>

Even,

I briefly looked at it the other day. My only nit was it seems a little confusing to have a GetNextFeature on both the Dataset and the Layer. Is one always better than the other? Which one should I use when? Should I always use Dataset::GetNextFeature() and let it forward down to OGRLayer::GetNextFeature()? The RFC is clear about those questions, but people don't read the docs :)  Is it possible and more clear to rename it?

Its need also suggest this is adding some messiness in the relationship of Dataset <-> Layer.  I suppose there's not much we can do about that.

Howard

> On Oct 3, 2016, at 2:49 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> If nobody has remarks on it, I'll call for a vote on this on Wednesday.
> 
> Even
> 
>> Hi,
>> 
>> This is a call for discussion on "RFC 66: OGR random layer read/write
>> capabilities" :
>> 
>> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
>> 
>> This RFC introduces a new API to be able to iterate over vector features at
>> dataset level, in addition to the existing capability of doing it at the
>> layer level. The existing capability of writing features in layers in
>> random order, that is supported by most drivers with output capabilities,
>> is formalized with a new dataset capability flag.
>> 
>> Best regards,
>> 
>> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Mon Oct  3 09:06:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 3 Oct 2016 18:06:12 +0200
Subject: [gdal-dev] Call for discussion on RFC 66: OGR random layer
	read/write capabilities
In-Reply-To: <366206EB-DC5B-42BB-B299-2B91E4B3E120@hobu.co>
References: <201609281358.31295.even.rouault@spatialys.com>
 <201610030949.09607.even.rouault@spatialys.com>
 <366206EB-DC5B-42BB-B299-2B91E4B3E120@hobu.co>
Message-ID: <201610031806.12852.even.rouault@spatialys.com>

Le lundi 03 octobre 2016 17:49:34, Howard Butler a écrit :
> Even,
> 
> I briefly looked at it the other day. My only nit was it seems a little
> confusing to have a GetNextFeature on both the Dataset and the Layer. Is
> one always better than the other? Which one should I use when? Should I
> always use Dataset::GetNextFeature() and let it forward down to
> OGRLayer::GetNextFeature()? The RFC is clear about those questions, but
> people don't read the docs :)  

Yes I know. We just write them so to have an excuse when they start asking 
questions ;-)

To limit the risk of confusion, I'd suggest not to edit the tutorial and other 
doc that currently only mention OGRLayer::GetNextFeature(). And perhaps add in 
the doc of Dataset::ResetReading() and GetNextFeature() that people in general 
should rather use the corresponding OGRLayer methods for simplicity.

> Is it possible and more clear to rename it?

Do you have any suggestion ? But really Dataset::GetNextFeature() and 
OGRLayer::GetNextFeature() essentially do the same, just the set that is 
iterated over is different.

> 
> Its need also suggest this is adding some messiness in the relationship of
> Dataset <-> Layer.  I suppose there's not much we can do about that.

Clearly Dataset::GetNextFeature() addresses a particular need, and I'm not 
sure that there will be many other user of it than ogr2ogr.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dadler at adtechgeospatial.com  Mon Oct  3 14:57:45 2016
From: dadler at adtechgeospatial.com (David Adler)
Date: Mon, 3 Oct 2016 17:57:45 -0400
Subject: [gdal-dev] Build using VS2015
Message-ID: <5eda6d05-3006-3ec4-653b-c80f9489f0c4@adtechgeospatial.com>

Should the build succeed with the 2015 version of the MS compiler using 
x86? I get

With x64 it gets a lot more errors.

It works fine with VS 2010 x86 - haven't tried x64.



---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161003/bcd52244/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: kcpdekdpoblidhge.png
Type: image/png
Size: 12761 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161003/bcd52244/attachment.png>

From even.rouault at spatialys.com  Mon Oct  3 15:05:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Oct 2016 00:05:19 +0200
Subject: [gdal-dev] Build using VS2015
In-Reply-To: <5eda6d05-3006-3ec4-653b-c80f9489f0c4@adtechgeospatial.com>
References: <5eda6d05-3006-3ec4-653b-c80f9489f0c4@adtechgeospatial.com>
Message-ID: <201610040005.20000.even.rouault@spatialys.com>

Le lundi 03 octobre 2016 23:57:45, David Adler a écrit :
> Should the build succeed with the 2015 version of the MS compiler using
> x86? I get
> 
> With x64 it gets a lot more errors.
> 
> It works fine with VS 2010 x86 - haven't tried x64.

David,

Specify MSVC_VER=1900 on the nmake command line.

nmake.opt :

!IFDEF ODBC_SUPPORTED
!IF $(MSVC_VER) >= 1900
# legacy_stdio_definitions.lib : 
https://connect.microsoft.com/VisualStudio/feedback/details/1134693/vs-2015-
ctp-5-c-vsnwprintf-s-and-other-functions-are-not-exported-in-appcrt140-dll-
breaking-linkage-of-static-libraries
ODBCLIB = legacy_stdio_definitions.lib odbc32.lib odbccp32.lib user32.lib
[...]

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Tue Oct  4 09:19:13 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Tue, 4 Oct 2016 18:19:13 +0200
Subject: [gdal-dev] /vsizip/ requires zip extension?
Message-ID: <CA+Ei1Oc-htL_OAxmCRALxnCBk1WyrsYCyK+CSmfNy9dydnqa2g@mail.gmail.com>

Hi,

recently I found out that /vsizip/ requires `zip` extension for the
input file. Eg.

ogrinfo /vsizip/test.zip -ro -q
1: test (3D Polygon)

while

cp test.zip test

ogrinfo /vsizip/test -ro -q
FAILURE:
Unable to open datasource `/vsizip/test' with the following drivers.

Why is the extension required? Thanks, Ma

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Tue Oct  4 09:51:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 4 Oct 2016 18:51:21 +0200
Subject: [gdal-dev] /vsizip/ requires zip extension?
In-Reply-To: <CA+Ei1Oc-htL_OAxmCRALxnCBk1WyrsYCyK+CSmfNy9dydnqa2g@mail.gmail.com>
References: <CA+Ei1Oc-htL_OAxmCRALxnCBk1WyrsYCyK+CSmfNy9dydnqa2g@mail.gmail.com>
Message-ID: <201610041851.21898.even.rouault@spatialys.com>

Le mardi 04 octobre 2016 18:19:13, Martin Landa a écrit :
> Hi,
> 
> recently I found out that /vsizip/ requires `zip` extension for the
> input file. Eg.
> 
> ogrinfo /vsizip/test.zip -ro -q
> 1: test (3D Polygon)
> 
> while
> 
> cp test.zip test
> 
> ogrinfo /vsizip/test -ro -q
> FAILURE:
> Unable to open datasource `/vsizip/test' with the following drivers.
> 
> Why is the extension required? 

For filenames like /vsizip//path/to.zip/path/inside/it.tif

The good news is that in trunk I've recently relaxed that since I needed to 
deal with .tar files with extensions not ending with .tar, so you can now use 
syntaxes like

/vsizip/{/path/to/the/zip.any_or_no_ext}
/vsizip/{/path/to/the/zip.any_or_no_ext}/path/inside/it

And you can even nest it as many times as you need in case of zip inside zip 
etc...

/vsizip/{/vsizip/{/path/to/the/zip.any_or_no_ext}/path/inside/it}/....

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From diregola at gmail.com  Wed Oct  5 02:29:43 2016
From: diregola at gmail.com (Margherita Di Leo)
Date: Wed, 5 Oct 2016 11:29:43 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
Message-ID: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>

Hi,

I need a suggestion on the use of ogr2ogr for clipping vector files
(points) in batch. For all them I need to reduce the spatial extent of a
certain quantity DX, DY, so it would be

ymax = ymax_current - DY
ymin = ymin_current + DY
xmax = xmax_current - DX
xmin = xmin_current + DX

I could calculate ymax, ymin, xmax, xmin if I could read the current values
in a FAST way. Or perhaps is there an option to put directly DX and DY in
ogr2ogr which I didn't spot?

Any hints appreciated
Thanks

-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161005/bb44affa/attachment.html>

From even.rouault at spatialys.com  Wed Oct  5 03:44:39 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 5 Oct 2016 12:44:39 +0200
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
	capabilities
Message-ID: <201610051244.39079.even.rouault@spatialys.com>

Hi,

I know that Howard has expressed some concerns regarding the potential 
confusion that this could add, but I'm not sure what better alternatives there 
would be to address the needs it tries to solve.

So I move to adopt RFC 66: OGR random layer read/write capabilities

https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite

-------

Starting with my +1

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Wed Oct  5 03:53:22 2016
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed, 5 Oct 2016 12:53:22 +0200
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
	capabilities
In-Reply-To: <201610051244.39079.even.rouault@spatialys.com>
References: <201610051244.39079.even.rouault@spatialys.com>
Message-ID: <CACALY+TM8PsZ4KTNihrXT50j9HF3wS-a2-41cOSw8a1t3mPMbQ@mail.gmail.com>

+1

Tamas



2016-10-05 12:44 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:

> Hi,
>
> I know that Howard has expressed some concerns regarding the potential
> confusion that this could add, but I'm not sure what better alternatives
> there
> would be to address the needs it tries to solve.
>
> So I move to adopt RFC 66: OGR random layer read/write capabilities
>
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
>
> -------
>
> Starting with my +1
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161005/084e8cb3/attachment.html>

From afalciano at yahoo.it  Wed Oct  5 04:37:58 2016
From: afalciano at yahoo.it (Antonio Falciano)
Date: Wed, 5 Oct 2016 13:37:58 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
Message-ID: <9ec086db-24f8-dc6d-461f-b7938fc0f002@yahoo.it>

Il 05/10/2016 11:29, Margherita Di Leo ha scritto:
> Hi,
>
> I need a suggestion on the use of ogr2ogr for clipping vector files
> (points) in batch. For all them I need to reduce the spatial extent of a
> certain quantity DX, DY, so it would be
>
> ymax = ymax_current - DY
> ymin = ymin_current + DY
> xmax = xmax_current - DX
> xmin = xmin_current + DX
>
> I could calculate ymax, ymin, xmax, xmin if I could read the current
> values in a FAST way. Or perhaps is there an option to put directly DX
> and DY in ogr2ogr which I didn't spot?

Ciao Margherita,
the current values can be retrieved using ogrinfo. For instance, a quick
and dirty xmin_current value is:

ogrinfo points.shp -dialect SQLite -sql "SELECT
MbrMinX(ST_Union(geometry)) FROM points" | grep "=" | sed
's/MbrMinX(ST_Union(geometry)) (Real) =//g' | sed 's/^[ \t]*//;s/[ \t]*$//'

...and so on for the other ones. Then you can make the reduction and
finally rebuild the spatial query extents to pass to -spat option in 
ogr2ogr.

Antonio

-- 
Antonio Falciano
http://www.linkedin.com/in/antoniofalciano

From howard at hobu.co  Wed Oct  5 06:47:44 2016
From: howard at hobu.co (Howard Butler)
Date: Wed, 5 Oct 2016 08:47:44 -0500
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
 capabilities
In-Reply-To: <CACALY+TM8PsZ4KTNihrXT50j9HF3wS-a2-41cOSw8a1t3mPMbQ@mail.gmail.com>
References: <201610051244.39079.even.rouault@spatialys.com>
 <CACALY+TM8PsZ4KTNihrXT50j9HF3wS-a2-41cOSw8a1t3mPMbQ@mail.gmail.com>
Message-ID: <101B2D6A-9DDD-4FCB-93BE-A79416FF62F7@hobu.co>

+1

I couldn't come up with anything better, and I was mostly lamenting the need to add more to the API surface.

Howard

> On Oct 5, 2016, at 5:53 AM, Tamas Szekeres <szekerest at gmail.com> wrote:
> 
> +1
> 
> Tamas
> 
> 
> 
> 2016-10-05 12:44 GMT+02:00 Even Rouault <even.rouault at spatialys.com>:
> Hi,
> 
> I know that Howard has expressed some concerns regarding the potential
> confusion that this could add, but I'm not sure what better alternatives there
> would be to address the needs it tries to solve.
> 
> So I move to adopt RFC 66: OGR random layer read/write capabilities
> 
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
> 
> -------
> 
> Starting with my +1
> 
> Even
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at maanmittauslaitos.fi  Wed Oct  5 07:26:32 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 5 Oct 2016 07:26:32 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
 capabilities
In-Reply-To: <201610051244.39079.even.rouault@spatialys.com>
References: <201610051244.39079.even.rouault@spatialys.com>
Message-ID: <1475677592768-5289435.post@n6.nabble.com>

+1

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> I know that Howard has expressed some concerns regarding the potential 
> confusion that this could add, but I'm not sure what better alternatives
> there 
> would be to address the needs it tries to solve.
> 
> So I move to adopt RFC 66: OGR random layer read/write capabilities
> 
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
> 
> -------
> 
> Starting with my +1
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-adopt-RFC-66-OGR-random-layer-read-write-capabilities-tp5289399p5289435.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From dbakeman at comcast.net  Wed Oct  5 11:24:10 2016
From: dbakeman at comcast.net (David J. Bakeman)
Date: Wed, 5 Oct 2016 11:24:10 -0700
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
Message-ID: <57F5454A.1000701@comcast.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161005/9e541849/attachment.html>

From even.rouault at spatialys.com  Wed Oct  5 11:53:01 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 5 Oct 2016 20:53:01 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
Message-ID: <201610052053.01918.even.rouault@spatialys.com>

Le mercredi 05 octobre 2016 11:29:43, Margherita Di Leo a écrit :
> Hi,
> 
> I need a suggestion on the use of ogr2ogr for clipping vector files
> (points) in batch. For all them I need to reduce the spatial extent of a
> certain quantity DX, DY, so it would be
> 
> ymax = ymax_current - DY
> ymin = ymin_current + DY
> xmax = xmax_current - DX
> xmin = xmin_current + DX
> 
> I could calculate ymax, ymin, xmax, xmin if I could read the current values
> in a FAST way. Or perhaps is there an option to put directly DX and DY in
> ogr2ogr which I didn't spot?

Tiny Python script with GDAL 2.1 :

from osgeo import gdal
src_ds = gdal.OpenEx('your.shp')
lyr = src_ds.GetLayer(0)
minx, maxx, miny, maxy = lyr.GetExtent()
# Note the different order of bounds between previous and next line
gdal.VectorTranslate("out.shp", src_ds, \
 spatFilter=(minx + DX,miny +DY,maxx-DX, maxy-DX))


> 
> Any hints appreciated
> Thanks

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct  5 13:47:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 5 Oct 2016 22:47:56 +0200
Subject: [gdal-dev] GPKG: Drop table but how to drop the rest?
In-Reply-To: <201609291313.17961.even.rouault@spatialys.com>
References: <7e6c930a30694930907eb1b25c81135e@C119S212VM022.msvyvi.vaha.local>
 <201609291313.17961.even.rouault@spatialys.com>
Message-ID: <201610052247.56382.even.rouault@spatialys.com>

Le jeudi 29 septembre 2016 13:13:17, Even Rouault a écrit :
> Hi Jukka,
> 
> > I wonder if it could be possible to do something like "DROP CASCADING" in
> > GeoPackage and delete the spatial index by the same.
> 
> I will work in a short term on this (as well as renaming columns)

Jukka, I wrote too fast and now realize that 
GDALGeoPackageDataset::DeleteLayer() is already implemented in fact (renaming 
is not) and available through the API. It is just that the DELLAYER: shortcut 
is not available.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Wed Oct  5 13:47:43 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 5 Oct 2016 16:47:43 -0400
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
 capabilities
In-Reply-To: <201610051244.39079.even.rouault@spatialys.com>
References: <201610051244.39079.even.rouault@spatialys.com>
Message-ID: <2c6c2f99-6298-4b0a-4281-44d6bf2d1809@mapgears.com>

+1

Daniel

On 2016-10-05 6:44 AM, Even Rouault wrote:
> Hi,
>
> I know that Howard has expressed some concerns regarding the potential
> confusion that this could add, but I'm not sure what better alternatives there
> would be to address the needs it tries to solve.
>
> So I move to adopt RFC 66: OGR random layer read/write capabilities
>
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
>
> -------
>
> Starting with my +1
>
> Even
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct  6 03:54:38 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 6 Oct 2016 10:54:38 +0000
Subject: [gdal-dev] Gdal_grid with a mask layer?
Message-ID: <4e3b24b738fd4fda83a17c600b68b40f@C119S212VM022.msvyvi.vaha.local>

Hi,

I have depth data from a lake as scattered points and I would like to convert them into raster DEM.  Unfortunately this lake is not a rectangular, north oriented one but it has a curvy shoreline and lots of islands. In my first trials the resulting DEM leaks away from the water to the dry ground. I guess that some other algorithms than the invdist would give better results near the shoreline. Generating fake zero depth points on the ground area would probably help with all the algorithms. However, what I would like to do is to define a mask layer for telling the valid area for the DEM that will be generated.  Is that possible somehow? If it is not then other good tricks are welcome. The good result should have zero depth on the ground and sharp shoreline at correct place.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161006/044ab274/attachment.html>

From jluis at ualg.pt  Thu Oct  6 04:10:16 2016
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu, 06 Oct 2016 12:10:16 +0100
Subject: [gdal-dev] Gdal_grid with a mask layer?
In-Reply-To: <4e3b24b738fd4fda83a17c600b68b40f@C119S212VM022.msvyvi.vaha.local>
References: <4e3b24b738fd4fda83a17c600b68b40f@C119S212VM022.msvyvi.vaha.local>
Message-ID: <op.yowrzizjdbaoe8@macmarilu>

Jukka, if no gdal solution comes out, consider this

http://gmt.soest.hawaii.edu/doc/latest/grdmask.html

Joaquim

>
> Hi,
>
>
> I have depth data from a lake as scattered points and I would like to  
> convert them into raster DEM.  Unfortunately this lake is not a  
> >rectangular, north oriented one but it has a curvy shoreline and lots  
> of islands. In my first trials the resulting DEM leaks away from the  
> >water to the dry ground. I guess that some other algorithms than the  
> invdist would give better results near the shoreline. Generating >fake  
> zero depth points on the ground area would probably help with all the  
> algorithms. However, what I would like to do is to define >a mask layer  
> for telling the valid area for the DEM that will be generated.  Is that  
> possible somehow? If it is not then other good tricks >are welcome. The  
> good result should have zero depth on the ground and sharp shoreline at  
> correct place.
>
>
> -Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161006/16c2f56e/attachment.html>

From diregola at gmail.com  Thu Oct  6 05:47:05 2016
From: diregola at gmail.com (Margherita Di Leo)
Date: Thu, 6 Oct 2016 14:47:05 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <201610052053.01918.even.rouault@spatialys.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
 <201610052053.01918.even.rouault@spatialys.com>
Message-ID: <CABa=8QrBoudjxzgN=6ZxV5xF092_FMNhpV827yLYUSCTPaBq=Q@mail.gmail.com>

Dear Even,

On Wed, Oct 5, 2016 at 8:53 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
>
> Tiny Python script with GDAL 2.1 :
>
> from osgeo import gdal
> src_ds = gdal.OpenEx('your.shp')
> lyr = src_ds.GetLayer(0)
> minx, maxx, miny, maxy = lyr.GetExtent()
> # Note the different order of bounds between previous and next line
> gdal.VectorTranslate("out.shp", src_ds, \
>  spatFilter=(minx + DX,miny +DY,maxx-DX, maxy-DX))
>
>
>
> Many thanks!
I'm having some headache because I have gdal 1.11 installed system-wide,
coming from package, so I installed gdal 2.2 in local in $HOME/opt/gdal
(=$GDAL_INSTALL_DIR)
in my terminal I run:

$ export PATH=$GDAL_INSTALL_DIR/bin:$PATH
$ export LD_LIBRARY_PATH=$GDAL_INSTALL_DIR/lib:$LD_LIBRARY_PATH
$ export GDAL_DATA=$GDAL_INSTALL_DIR/share/gdal
$ gdalinfo --version
GDAL 2.2.0dev, released 2016/99/99

$ python
[...]
>>> from osgeo import gdal
>>> gdal.VersionInfo()
'1110400'

Also, in sys.path() the $GDAL_INSTALL_DIR is listed correctly... I'm at a
dead end :-/


-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161006/f974001e/attachment.html>

From even.rouault at spatialys.com  Thu Oct  6 06:25:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 6 Oct 2016 15:25:32 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <CABa=8QrBoudjxzgN=6ZxV5xF092_FMNhpV827yLYUSCTPaBq=Q@mail.gmail.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
 <201610052053.01918.even.rouault@spatialys.com>
 <CABa=8QrBoudjxzgN=6ZxV5xF092_FMNhpV827yLYUSCTPaBq=Q@mail.gmail.com>
Message-ID: <201610061525.33061.even.rouault@spatialys.com>

Le jeudi 06 octobre 2016 14:47:05, Margherita Di Leo a écrit :
> Dear Even,
> 
> On Wed, Oct 5, 2016 at 8:53 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Tiny Python script with GDAL 2.1 :
> > 
> > from osgeo import gdal
> > src_ds = gdal.OpenEx('your.shp')
> > lyr = src_ds.GetLayer(0)
> > minx, maxx, miny, maxy = lyr.GetExtent()
> > # Note the different order of bounds between previous and next line
> > gdal.VectorTranslate("out.shp", src_ds, \
> > 
> >  spatFilter=(minx + DX,miny +DY,maxx-DX, maxy-DX))
> > 
> > Many thanks!
> 
> I'm having some headache because I have gdal 1.11 installed system-wide,
> coming from package, so I installed gdal 2.2 in local in $HOME/opt/gdal
> (=$GDAL_INSTALL_DIR)
> in my terminal I run:
> 
> $ export PATH=$GDAL_INSTALL_DIR/bin:$PATH
> $ export LD_LIBRARY_PATH=$GDAL_INSTALL_DIR/lib:$LD_LIBRARY_PATH
> $ export GDAL_DATA=$GDAL_INSTALL_DIR/share/gdal
> $ gdalinfo --version
> GDAL 2.2.0dev, released 2016/99/99
> 
> $ python
> [...]
> 
> >>> from osgeo import gdal
> >>> gdal.VersionInfo()
> 
> '1110400'
> 
> Also, in sys.path() the $GDAL_INSTALL_DIR is listed correctly... I'm at a
> dead end :-/

Try:

export PYTHONPATH=$GDAL_INSTALL_DIR/lib/python2.7/site-packages

( adapt the path to the python version you use)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From diregola at gmail.com  Fri Oct  7 03:00:17 2016
From: diregola at gmail.com (Margherita Di Leo)
Date: Fri, 7 Oct 2016 12:00:17 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <201610061525.33061.even.rouault@spatialys.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
 <201610052053.01918.even.rouault@spatialys.com>
 <CABa=8QrBoudjxzgN=6ZxV5xF092_FMNhpV827yLYUSCTPaBq=Q@mail.gmail.com>
 <201610061525.33061.even.rouault@spatialys.com>
Message-ID: <CABa=8QoiKaoYOWg1CSw=L7OsGQbaNBY0WypGW7qTH_jWWY=Hfw@mail.gmail.com>

Dear Even, all,

On Thu, Oct 6, 2016 at 3:25 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 06 octobre 2016 14:47:05, Margherita Di Leo a écrit :
> > Dear Even,
> >
> >
>
> Try:
>
> export PYTHONPATH=$GDAL_INSTALL_DIR/lib/python2.7/site-packages
>
> ( adapt the path to the python version you use)
>

It didn't help.
Sorry to go off-topic from original subject but I really cannot understand
what's wrong with my work flow.
I write down every single step:

# Download source
cd $HOME/opt
svn checkout https://svn.osgeo.org/gdal/trunk/gdal gdal-source

# Create bin dir
mkdir -p $HOME/opt/gdal-bin
export GDAL_INSTALL_DIR=$HOME/opt/gdal-bin

# set environment variables for current session
export PATH=$GDAL_INSTALL_DIR/bin:$PATH
export LD_LIBRARY_PATH=$GDAL_INSTALL_DIR/lib:$LD_LIBRARY_PATH
export GDAL_DATA=$GDAL_INSTALL_DIR/share/gdal

# compile gdal in local folder
cd $HOME/opt/gdal-source
./configure --prefix=$GDAL_INSTALL_DIR
make
make install

# setting up python environment
cd $HOME/opt/gdal-source/swig/python
python setup.py build
mkdir -p $GDAL_INSTALL_DIR/lib64/python2.7/site-packages/
export
PYTHONPATH=$GDAL_INSTALL_DIR/lib64/python2.7/site-packages:$PYTHONPATH
python setup.py install --prefix=$GDAL_INSTALL_DIR

# Check if works
python
from osgeo import gdal


Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "osgeo/__init__.py", line 21, in <module>
    _gdal = swig_import_helper()
  File "osgeo/__init__.py", line 13, in swig_import_helper
    import _gdal
ImportError: No module named _gdal


Outside python:

gdalinfo --version
GDAL 2.2.0dev, released 2016/99/99

:-/


-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161007/ca244c2a/attachment.html>

From julien.michel at cnes.fr  Fri Oct  7 06:34:57 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Fri, 7 Oct 2016 15:34:57 +0200
Subject: [gdal-dev] Outdated external overviews
Message-ID: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>

Dear all,

I recently came accross an issue in our software which uses overviews to 
speed-up navigation in image : the image can change after an external 
overview has been generated (for instance it has been re-generated by an 
upstream processing chain with different parameters), this can lead to 
display bugs or even crash in client code (if for instance the number of 
bands has changed). Of course this is not a problem for the user that 
knows what she is doing : simply removing and generating the overview 
again fixes the problem. But for software that offers overview 
generation to the end user, this might become an issue, as the software 
has no clue wether the ovr file is outdated or not.

Possible mecanism to prevent this would be :

- Check file last modification time between external overview and image 
file. If image file is newer than overview files, it is probably outdated.

- Encode image checksum in ovr file, and compare it upon loading (might 
be a bit intensive).

With those checks, gdal could detect that the ovr file is outdated and 
simply ignore it. Then client code could be aware that there are 
actually no overviews for this image and take actions to generate new ones.

Any thought ?

Regards,

Julien

PS: This of course does not apply if overviews are internal

-- 
Julien MICHEL
CNES - DCT/SI/AP


From even.rouault at spatialys.com  Fri Oct  7 07:46:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 7 Oct 2016 16:46:58 +0200
Subject: [gdal-dev] Outdated external overviews
In-Reply-To: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>
References: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>
Message-ID: <201610071646.58739.even.rouault@spatialys.com>

Hi Julien,
> 
> I recently came accross an issue in our software which uses overviews to
> speed-up navigation in image : the image can change after an external
> overview has been generated (for instance it has been re-generated by an
> upstream processing chain with different parameters), this can lead to
> display bugs or even crash in client code (if for instance the number of
> bands has changed)

Are the crashes you mention occuring in GDAL ? If so that should be fixed. From 
a quick try, RasterIO() requests that involve overviews trigger a proper error 
if the .ovr has less bands than the full resolution dataset. Of course if 
client code directly uses GetOverview(), it must be careful to check for NULL 
pointer.

> . Of course this is not a problem for the user that
> knows what she is doing : simply removing and generating the overview
> again fixes the problem. But for software that offers overview
> generation to the end user, this might become an issue, as the software
> has no clue wether the ovr file is outdated or not.
> 
> Possible mecanism to prevent this would be :
> 
> - Check file last modification time between external overview and image
> file. If image file is newer than overview files, it is probably outdated.

"Probably" yes :-) But I can imagine workflows where the overviews are not 
necessarily a subsampling of the full resolution dataset, in which case such 
behaviour wouldn't be desirable. I'm also wondering if that wouldn't cause 
problems when datasets are copied. Hopefully timestamps should be preserved 
most of the time, but I guess you could find situations where they are not and 
where the overview could be copied before the main dataset.

> 
> - Encode image checksum in ovr file, and compare it upon loading (might
> be a bit intensive).

We definitely don't want to do that on gigabyte sized datasets...

> 
> With those checks, gdal could detect that the ovr file is outdated and
> simply ignore it. Then client code could be aware that there are
> actually no overviews for this image and take actions to generate new ones.

The client code can also use the GDALDataset::GetFileList() API and see if 
there's a .ovr file listed in there. And thus decide to apply a timestamp based 
logic if it whishes. 

Or one could imagine to put that logic into GDAL itself, but I think that 
should be an option explicitly set.

There would be a subtelty also. Imagine that the external overview is 
outdated, and you want to update it, but not recreate it from scratch. For 
example if you know which area has been updated in full resolution dataset. 
Then you'd want the overview to be still accessible. So hiding the overview 
should only apply for datasets opened in read-only mode.

> 
> PS: This of course does not apply if overviews are internal

You probably meant that detecting that overviews are outdated is even less 
doable than for the external case, but that situation can still happen.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Oct  7 13:46:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 7 Oct 2016 22:46:27 +0200
Subject: [gdal-dev] Shapefile auto-repacking now done by default
Message-ID: <201610072246.27429.even.rouault@spatialys.com>

Hi,

This is a subject I raised some time ago. Seeing all the issues that the past 
behaviour (non repacking) causes in QGIS with its interoperability with other 
software, and the fact that QGIS must have logic to decide whether and when to 
issue the REPACK command that doesn't really belong to that application layer, 
I finally implemented in trunk shapefile auto repacking by default at dataset 
closing and FlushCache()/SyncToDisk() time.

This is controlled by the new AUTO_REPACK open and layer creation options 
(that default to YES).

One thing I didn't implement is auto repack if no action that required it has 
been done in the current session. For example imagine that you edit a shapefile 
that had holes before opening, and just append features to it, REPACK will not 
be automatically done. Could be done, but perhaps costly in some use cases.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Oct  8 02:36:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 8 Oct 2016 11:36:34 +0200
Subject: [gdal-dev] Motion: adopt RFC 66: OGR random layer read/write
	capabilities
In-Reply-To: <201610051244.39079.even.rouault@spatialys.com>
References: <201610051244.39079.even.rouault@spatialys.com>
Message-ID: <201610081136.34720.even.rouault@spatialys.com>

Le mercredi 05 octobre 2016 12:44:39, Even Rouault a écrit :
> Hi,
> 
> I know that Howard has expressed some concerns regarding the potential
> confusion that this could add, but I'm not sure what better alternatives
> there would be to address the needs it tries to solve.
> 
> So I move to adopt RFC 66: OGR random layer read/write capabilities
> 
> https://trac.osgeo.org/gdal/wiki/rfc66_randomlayerreadwrite
> 
> -------
> 

I declare this motion passed with +1 from TamasS, HowardB, JukkaR, DanielM and 
myself.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Oct  8 05:03:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 8 Oct 2016 14:03:40 +0200
Subject: [gdal-dev] New GMLAS (GML Application Schema) in trunk
Message-ID: <201610081403.41443.even.rouault@spatialys.com>

Hi,

Just to inform you I've commited an initial version (read-only for now, write 
support to come) of the OGR GMLAS driver into trunk. This driver can read XML 
files of (almost) arbitrary structure, included those containing so called 
Complex Features, provided that they are accompanied by one or several XML 
schemas that describe the structure of their content. While this driver is 
generic to any XML schema, the main target is to be able to read documents 
referencing directly or indirectly to the GML namespace, such as GML documents 
conforming to Inspire or GeoSciML schemas.

The connection string is GMLAS:/path/to/the.gml

More on http://gdal.org/drv_gmlas.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.michel at cnes.fr  Mon Oct 10 02:57:47 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 10 Oct 2016 11:57:47 +0200
Subject: [gdal-dev] Outdated external overviews
In-Reply-To: <201610071646.58739.even.rouault@spatialys.com>
References: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>
 <201610071646.58739.even.rouault@spatialys.com>
Message-ID: <a32d4ad1-545e-c4b7-778f-f2cd53448485@cnes.fr>

Hi Even,

Thanks for your response. I understand all your points, and that Gdal 
requirements usually fall far beyond our limited use cases ... We can of 
course do a lot in the client code (starting with comparing timestamps), 
but this is not specific to our software, I bet Qgis for instance will 
happily use outdated overviews without notice. This is why I am 
wondering if it could not be handled more cleanly at the Gdal level. I 
understand though that this is not an easy problem to fix.

Regards,

Julien

Le 07/10/2016 à 16:46, Even Rouault a écrit :
> Hi Julien,
>> I recently came accross an issue in our software which uses overviews to
>> speed-up navigation in image : the image can change after an external
>> overview has been generated (for instance it has been re-generated by an
>> upstream processing chain with different parameters), this can lead to
>> display bugs or even crash in client code (if for instance the number of
>> bands has changed)
> Are the crashes you mention occuring in GDAL ? If so that should be fixed. From
> a quick try, RasterIO() requests that involve overviews trigger a proper error
> if the .ovr has less bands than the full resolution dataset. Of course if
> client code directly uses GetOverview(), it must be careful to check for NULL
> pointer.
>
>> . Of course this is not a problem for the user that
>> knows what she is doing : simply removing and generating the overview
>> again fixes the problem. But for software that offers overview
>> generation to the end user, this might become an issue, as the software
>> has no clue wether the ovr file is outdated or not.
>>
>> Possible mecanism to prevent this would be :
>>
>> - Check file last modification time between external overview and image
>> file. If image file is newer than overview files, it is probably outdated.
> "Probably" yes :-) But I can imagine workflows where the overviews are not
> necessarily a subsampling of the full resolution dataset, in which case such
> behaviour wouldn't be desirable. I'm also wondering if that wouldn't cause
> problems when datasets are copied. Hopefully timestamps should be preserved
> most of the time, but I guess you could find situations where they are not and
> where the overview could be copied before the main dataset.
>
>> - Encode image checksum in ovr file, and compare it upon loading (might
>> be a bit intensive).
> We definitely don't want to do that on gigabyte sized datasets...
>
>> With those checks, gdal could detect that the ovr file is outdated and
>> simply ignore it. Then client code could be aware that there are
>> actually no overviews for this image and take actions to generate new ones.
> The client code can also use the GDALDataset::GetFileList() API and see if
> there's a .ovr file listed in there. And thus decide to apply a timestamp based
> logic if it whishes.
>
> Or one could imagine to put that logic into GDAL itself, but I think that
> should be an option explicitly set.
>
> There would be a subtelty also. Imagine that the external overview is
> outdated, and you want to update it, but not recreate it from scratch. For
> example if you know which area has been updated in full resolution dataset.
> Then you'd want the overview to be still accessible. So hiding the overview
> should only apply for datasets opened in read-only mode.
>
>> PS: This of course does not apply if overviews are internal
> You probably meant that detecting that overviews are outdated is even less
> doable than for the external case, but that situation can still happen.
>
> Even
>
>


-- 
Julien MICHEL
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From clearlymichele at yahoo.com  Mon Oct 10 06:20:08 2016
From: clearlymichele at yahoo.com (Michele Cleary)
Date: Mon, 10 Oct 2016 13:20:08 +0000 (UTC)
Subject: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
References: <810612762.1246649.1476105608501.ref@mail.yahoo.com>
Message-ID: <810612762.1246649.1476105608501@mail.yahoo.com>

I'm trying to open an HDF5 file, specific bands, but GDAL is giving an error message: 
> "'HDF5:C:\pathToFile\pathToFile/filename.h5://ImageData/B4' does not> exist in the file system and is not recognized as a supported data set> name"
I got the error message after the GDALOpenInternal call using CPLGetLastErrorMsg().  I can't step into GDALOpenInternal (with Visual Studio) because we don't have GDAL source cpp file; just h file that came with the package, unless I'm searching for the wrong file name.
The string for the ConnectionString parameter for GDALOpenInternal is shown in the quotes above.  
I found [qgis polygonize error 4 "file does not exist in the file system"], but they said it was because of using non-ascii characters in file path string.  I didn't see any other pertinent info on this error message.
We need to access the specific band of the HDF5 file.  I noticed that our slashes in the path are showing in different directions, but I'm not sure that would be the issue here.  We have both windows and linux OS's.  This error was seen on windows os.
We used (gdalinfo.exe filename.h5) and do see that the B4 exists there.
Using the string, HDF5:"C:\pathToFile\filename.h5"://ImageData/B2, didn't work for openInternal with GDAL.

I saw  (gdal.org/gdal_tutorial.html), which gives an example to open a band after a GDALOpen, but it seems that it's supposed to work with GDALOpenInternal also according to my co-workers. We just don't have a good example of the connection string to get it working with GDALOpenInternal since we don't have access to that part of the code that does it. They want me to focus on using GDALOpenInternal.

I'm seeing lists.alioth.debian.org/pipermail/pkg-grass-devel/2012-Novem‌​ber/…, which gives me hope, but doesn't have a good example. I saw this which could be an example, although it isn't using a path, but I'm not sure: gdalwarp HDF4_SDS:ASTER_L1B:"pg-PR1B0000-2002031402_100_001":2 pg-PR1B0000-2002031402_100_001_2.tif

My question is, what format for the connection string do I need to use GDALOpenInternal, if it's not what I show for the two things I tried above?  
Thanks,Mich

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161010/365761bf/attachment.html>

From even.rouault at spatialys.com  Mon Oct 10 06:44:13 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Oct 2016 15:44:13 +0200
Subject: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
In-Reply-To: <810612762.1246649.1476105608501@mail.yahoo.com>
References: <810612762.1246649.1476105608501.ref@mail.yahoo.com>
 <810612762.1246649.1476105608501@mail.yahoo.com>
Message-ID: <201610101544.14463.even.rouault@spatialys.com>

Le lundi 10 octobre 2016 15:20:08, Michele Cleary a écrit :
> I'm trying to open an HDF5 file, specific bands, but GDAL is giving an
> error message: 
> 
> > "'HDF5:C:\pathToFile\pathToFile/filename.h5://ImageData/B4' does not>
> > exist in the file system and is not recognized as a supported data set>
> > name"
> 
> I got the error message after the GDALOpenInternal call using
> CPLGetLastErrorMsg().  I can't step into GDALOpenInternal (with Visual
> Studio) because we don't have GDAL source cpp file; just h file that came
> with the package, unless I'm searching for the wrong file name. The string
> for the ConnectionString parameter for GDALOpenInternal is shown in the
> quotes above. I found [qgis polygonize error 4 "file does not exist in the
> file system"], but they said it was because of using non-ascii characters
> in file path string.  I didn't see any other pertinent info on this error
> message. We need to access the specific band of the HDF5 file.  I noticed
> that our slashes in the path are showing in different directions, but I'm
> not sure that would be the issue here.  We have both windows and linux
> OS's.  This error was seen on windows os. We used (gdalinfo.exe
> filename.h5) and do see that the B4 exists there. Using the string,
> HDF5:"C:\pathToFile\filename.h5"://ImageData/B2, didn't work for
> openInternal with GDAL.
> 
> I saw  (gdal.org/gdal_tutorial.html), which gives an example to open a band
> after a GDALOpen, but it seems that it's supposed to work with
> GDALOpenInternal also according to my co-workers. We just don't have a
> good example of the connection string to get it working with
> GDALOpenInternal since we don't have access to that part of the code that
> does it. They want me to focus on using GDALOpenInternal.
> 
> I'm
> seeing lists.alioth.debian.org/pipermail/pkg-grass-devel/2012-Novem‌​ber/…
> , which gives me hope, but doesn't have a good example. I saw this which
> could be an example, although it isn't using a path, but I'm not sure:
> gdalwarp HDF4_SDS:ASTER_L1B:"pg-PR1B0000-2002031402_100_001":2
> pg-PR1B0000-2002031402_100_001_2.tif
> 
> My question is, what format for the connection string do I need to use
> GDALOpenInternal, if it's not what I show for the two things I tried
> above? 

You should try first 

gdalinfo c:\pathToFile\filename.h5

and then, if that opens, try accessing the subdataset it will report. The 
expected syntax is like HDF5:"c:\pathToFile\filename.h5":subdataset_name

Since you seem to mention that the path contains non ASCII characters, I 
wouldn't be surprise if that didn't work correctly on Windows. You should 
perhaps try making sure your path is encoded in the current ANSI code page of 
your system since that's probably what the HDF5 API expects.

Would probably make sense for GDAL to recode from UTF-8 to current ANSI code 
page automagically as it does in the XLS driver:

#ifdef _WIN32
    if( CPLTestBool( CPLGetConfigOption( "GDAL_FILENAME_IS_UTF8", "YES" ) ) )
        pszName = CPLRecode( pszFilename, CPL_ENC_UTF8, CPLString().Printf( 
"CP%d", GetACP() ) );
    else
        pszName = CPLStrdup( pszFilename );
#else
    pszName = CPLStrdup( pszFilename );
#endif

That assumes that the accentued characters you need can be expressed in the 
current ANSI code page, otherwise you'll have to move the file elsewhere

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From roberto.marzocchi at gmail.com  Mon Oct 10 07:36:13 2016
From: roberto.marzocchi at gmail.com (Roberto Marzocchi)
Date: Mon, 10 Oct 2016 16:36:13 +0200
Subject: [gdal-dev] A 2D translation of a polygon
Message-ID: <CAMoURBPEoN=3oesXck11Q3eAhqjYrRdVSMrOCGMyh-t6pfWVMg@mail.gmail.com>

Dear all,

I am searching a C function which do a 2D translation (or shift) of a
geometry. Apparently it is very simple question, but I do not found any
function to do this simple operation.

The only way is to export all the vertices and translate them?

Perhaps OGR_G_Transform (OGRGeometryH, OGRCoordinateTransformationH) can be
the correct function, but I do not understand OGRCoordinateTransformationH
I need to do only a shift of my OGRGeometryH.

Thanks in advanced for your help.

All the best,
R
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161010/30be0ebd/attachment.html>

From clearlymichele at yahoo.com  Mon Oct 10 07:46:27 2016
From: clearlymichele at yahoo.com (Michele)
Date: Mon, 10 Oct 2016 14:46:27 +0000 (UTC)
Subject: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
In-Reply-To: <201610101544.14463.even.rouault@spatialys.com>
References: <810612762.1246649.1476105608501.ref@mail.yahoo.com>
 <810612762.1246649.1476105608501@mail.yahoo.com>
 <201610101544.14463.even.rouault@spatialys.com>
Message-ID: <1868948973.1282093.1476110787674@mail.yahoo.com>

Thanks for the reply, Even!  
I can do gdalinfo c:\pathToFile\filename.h5.
What do you mean, " try accessing the subdataset it will report. The expected syntax is like HDF5:"c:\pathToFile\filename.h5":subdataset_name"?
Do you mean gdalinfo HDF5:"c:\pathtoFile\filename.h5"://ImageData/h2?
When I do that, I get:
 ERROR 4: `HDF5:c:\pathToFile\filename.h5://ImageData/h2' does not exist in the file
and is not recognised as a supported dataset name.
gdalinfo failed - unable to open 'HDF5:c:\pathToFile\filename.h5://ImageData/h2'.
We know h2 exists because it was listed in gdalinfo for the filename.
Thanks,Michele
      From: Even Rouault <even.rouault at spatialys.com>
 To: Michele <clearlymichele at yahoo.com> 
Cc: gdal-dev at lists.osgeo.org
 Sent: Monday, October 10, 2016 9:44 AM
 Subject: Re: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
   
Le lundi 10 octobre 2016 15:20:08, Michele a écrit :
> I'm trying to open an HDF5 file, specific bands, but GDAL is giving an
> error message: 
> 
> > "'HDF5:C:\pathToFile\pathToFile/filename.h5://ImageData/B4' does not>
> > exist in the file system and is not recognized as a supported data set>
> > name"
> 
> I got the error message after the GDALOpenInternal call using
> CPLGetLastErrorMsg().  I can't step into GDALOpenInternal (with Visual
> Studio) because we don't have GDAL source cpp file; just h file that came
> with the package, unless I'm searching for the wrong file name. The string
> for the ConnectionString parameter for GDALOpenInternal is shown in the
> quotes above. I found [qgis polygonize error 4 "file does not exist in the
> file system"], but they said it was because of using non-ascii characters
> in file path string.  I didn't see any other pertinent info on this error
> message. We need to access the specific band of the HDF5 file.  I noticed
> that our slashes in the path are showing in different directions, but I'm
> not sure that would be the issue here.  We have both windows and linux
> OS's.  This error was seen on windows os. We used (gdalinfo.exe
> filename.h5) and do see that the B4 exists there. Using the string,
> HDF5:"C:\pathToFile\filename.h5"://ImageData/B2, didn't work for
> openInternal with GDAL.
> 
> I saw  (gdal.org/gdal_tutorial.html), which gives an example to open a band
> after a GDALOpen, but it seems that it's supposed to work with
> GDALOpenInternal also according to my co-workers. We just don't have a
> good example of the connection string to get it working with
> GDALOpenInternal since we don't have access to that part of the code that
> does it. They want me to focus on using GDALOpenInternal.
> 
> I'm
> seeing lists.alioth.debian.org/pipermail/pkg-grass-devel/2012-Novem‌​ber/…
> , which gives me hope, but doesn't have a good example. I saw this which
> could be an example, although it isn't using a path, but I'm not sure:
> gdalwarp HDF4_SDS:ASTER_L1B:"pg-PR1B0000-2002031402_100_001":2
> pg-PR1B0000-2002031402_100_001_2.tif
> 
> My question is, what format for the connection string do I need to use
> GDALOpenInternal, if it's not what I show for the two things I tried
> above? 

You should try first 

gdalinfo c:\pathToFile\filename.h5

and then, if that opens, try accessing the subdataset it will report. The 
expected syntax is like HDF5:"c:\pathToFile\filename.h5":subdataset_name

Since you seem to mention that the path contains non ASCII characters, I 
wouldn't be surprise if that didn't work correctly on Windows. You should 
perhaps try making sure your path is encoded in the current ANSI code page of 
your system since that's probably what the HDF5 API expects.

Would probably make sense for GDAL to recode from UTF-8 to current ANSI code 
page automagically as it does in the XLS driver:

#ifdef _WIN32
    if( CPLTestBool( CPLGetConfigOption( "GDAL_FILENAME_IS_UTF8", "YES" ) ) )
        pszName = CPLRecode( pszFilename, CPL_ENC_UTF8, CPLString().Printf( 
"CP%d", GetACP() ) );
    else
        pszName = CPLStrdup( pszFilename );
#else
    pszName = CPLStrdup( pszFilename );
#endif

That assumes that the accentued characters you need can be expressed in the 
current ANSI code page, otherwise you'll have to move the file elsewhere

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161010/75b0b4cb/attachment-0001.html>

From clearlymichele at yahoo.com  Mon Oct 10 09:17:08 2016
From: clearlymichele at yahoo.com (Michele)
Date: Mon, 10 Oct 2016 16:17:08 +0000 (UTC)
Subject: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
In-Reply-To: <1868948973.1282093.1476110787674@mail.yahoo.com>
References: <810612762.1246649.1476105608501.ref@mail.yahoo.com>
 <810612762.1246649.1476105608501@mail.yahoo.com>
 <201610101544.14463.even.rouault@spatialys.com>
 <1868948973.1282093.1476110787674@mail.yahoo.com>
Message-ID: <192082733.1354159.1476116228866@mail.yahoo.com>

I tried to cd to the dir that filename.h5 is in and it works:


c:\path\gdal_bin\gdalinfo.exe HDF5:"filename.h5"://ImageData/B2
I noticed that I had ImageData/h2 instead of ImageData/B2 below.  It's correct in the code that's going to GDALOpenInternal, though.

      From: Michele <clearlymichele at yahoo.com>
 To: Even Rouault <even.rouault at spatialys.com> 
Cc: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
 Sent: Monday, October 10, 2016 10:46 AM
 Subject: Re: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
   
Thanks for the reply, Even!  
I can do gdalinfo c:\pathToFile\filename.h5.
What do you mean, " try accessing the subdataset it will report. The expected syntax is like HDF5:"c:\pathToFile\filename.h5":subdataset_name"?
Do you mean gdalinfo HDF5:"c:\pathtoFile\filename.h5"://ImageData/h2?
When I do that, I get:
 ERROR 4: `HDF5:c:\pathToFile\filename.h5://ImageData/h2' does not exist in the file
and is not recognised as a supported dataset name.
gdalinfo failed - unable to open 'HDF5:c:\pathToFile\filename.h5://ImageData/h2'.
We know h2 exists because it was listed in gdalinfo for the filename.
Thanks,Michele
      From: Even Rouault <even.rouault at spatialys.com>
 To: Michele <clearlymichele at yahoo.com> 
Cc: gdal-dev at lists.osgeo.org
 Sent: Monday, October 10, 2016 9:44 AM
 Subject: Re: [gdal-dev] GDALOpenInternal Problem Opening specific HDF5 bands
  
Le lundi 10 octobre 2016 15:20:08, Michele a écrit :
> I'm trying to open an HDF5 file, specific bands, but GDAL is giving an
> error message: 
> 
> > "'HDF5:C:\pathToFile\pathToFile/filename.h5://ImageData/B4' does not>
> > exist in the file system and is not recognized as a supported data set>
> > name"
> 
> I got the error message after the GDALOpenInternal call using
> CPLGetLastErrorMsg().  I can't step into GDALOpenInternal (with Visual
> Studio) because we don't have GDAL source cpp file; just h file that came
> with the package, unless I'm searching for the wrong file name. The string
> for the ConnectionString parameter for GDALOpenInternal is shown in the
> quotes above. I found [qgis polygonize error 4 "file does not exist in the
> file system"], but they said it was because of using non-ascii characters
> in file path string.  I didn't see any other pertinent info on this error
> message. We need to access the specific band of the HDF5 file.  I noticed
> that our slashes in the path are showing in different directions, but I'm
> not sure that would be the issue here.  We have both windows and linux
> OS's.  This error was seen on windows os. We used (gdalinfo.exe
> filename.h5) and do see that the B4 exists there. Using the string,
> HDF5:"C:\pathToFile\filename.h5"://ImageData/B2, didn't work for
> openInternal with GDAL.
> 
> I saw  (gdal.org/gdal_tutorial.html), which gives an example to open a band
> after a GDALOpen, but it seems that it's supposed to work with
> GDALOpenInternal also according to my co-workers. We just don't have a
> good example of the connection string to get it working with
> GDALOpenInternal since we don't have access to that part of the code that
> does it. They want me to focus on using GDALOpenInternal.
> 
> I'm
> seeing lists.alioth.debian.org/pipermail/pkg-grass-devel/2012-Novem‌​ber/…
> , which gives me hope, but doesn't have a good example. I saw this which
> could be an example, although it isn't using a path, but I'm not sure:
> gdalwarp HDF4_SDS:ASTER_L1B:"pg-PR1B0000-2002031402_100_001":2
> pg-PR1B0000-2002031402_100_001_2.tif
> 
> My question is, what format for the connection string do I need to use
> GDALOpenInternal, if it's not what I show for the two things I tried
> above? 

You should try first 

gdalinfo c:\pathToFile\filename.h5

and then, if that opens, try accessing the subdataset it will report. The 
expected syntax is like HDF5:"c:\pathToFile\filename.h5":subdataset_name

Since you seem to mention that the path contains non ASCII characters, I 
wouldn't be surprise if that didn't work correctly on Windows. You should 
perhaps try making sure your path is encoded in the current ANSI code page of 
your system since that's probably what the HDF5 API expects.

Would probably make sense for GDAL to recode from UTF-8 to current ANSI code 
page automagically as it does in the XLS driver:

#ifdef _WIN32
    if( CPLTestBool( CPLGetConfigOption( "GDAL_FILENAME_IS_UTF8", "YES" ) ) )
        pszName = CPLRecode( pszFilename, CPL_ENC_UTF8, CPLString().Printf( 
"CP%d", GetACP() ) );
    else
        pszName = CPLStrdup( pszFilename );
#else
    pszName = CPLStrdup( pszFilename );
#endif

That assumes that the accentued characters you need can be expressed in the 
current ANSI code page, otherwise you'll have to move the file elsewhere

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

   

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161010/f2fec169/attachment.html>

From even.rouault at spatialys.com  Mon Oct 10 10:07:45 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 10 Oct 2016 19:07:45 +0200
Subject: [gdal-dev] Time for 2.1.2 ?
Message-ID: <201610101907.45241.even.rouault@spatialys.com>

Hi,

I'd like to prepare a RC for a 2.1.2 bugfix release on Friday, unless someone 
needs more time to push a fix. If there are outstanding issues not yet in the 
2.1 branch and that would need to be considered for inclusion, speak up.

The current fixes done since 2.1.1 are:
https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.1.2
and probably most of those in:
https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.4

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 10 13:37:16 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 10 Oct 2016 13:37:16 -0700 (MST)
Subject: [gdal-dev] Time for 2.1.2 ?
In-Reply-To: <201610101907.45241.even.rouault@spatialys.com>
References: <201610101907.45241.even.rouault@spatialys.com>
Message-ID: <1476131836226-5290101.post@n6.nabble.com>

+1

QGIS users will probably appreciate https://trac.osgeo.org/gdal/ticket/6672
a lot.

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> I'd like to prepare a RC for a 2.1.2 bugfix release on Friday, unless
> someone 
> needs more time to push a fix. If there are outstanding issues not yet in
> the 
> 2.1 branch and that would need to be considered for inclusion, speak up.
> 
> The current fixes done since 2.1.1 are:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.1.2
> and probably most of those in:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.4
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Time-for-2-1-2-tp5290060p5290101.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bishop.dev at gmail.com  Tue Oct 11 01:31:39 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Tue, 11 Oct 2016 11:31:39 +0300
Subject: [gdal-dev] Time for 2.1.2 ?
In-Reply-To: <201610101907.45241.even.rouault@spatialys.com>
References: <201610101907.45241.even.rouault@spatialys.com>
Message-ID: <4d00b2d4-6474-05c7-e74f-b16e3dd05faa@gmail.com>

Hi,

What do you think about enabling GNM (network model) build by default in 
2.1.2?

GNM using in QNetwork plugin in QGIS and via command line utilities but 
not available by default and only small number users can get it.

I think if we enable GNM by default we can get more user feedback.

Best regards,
     Dmitry

10.10.16 20:07, Even Rouault пишет:
> Hi,
>
> I'd like to prepare a RC for a 2.1.2 bugfix release on Friday, unless someone
> needs more time to push a fix. If there are outstanding issues not yet in the
> 2.1 branch and that would need to be considered for inclusion, speak up.
>
> The current fixes done since 2.1.1 are:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.1.2
> and probably most of those in:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.4
>
> Even
>


From even.rouault at spatialys.com  Tue Oct 11 02:07:20 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Oct 2016 11:07:20 +0200
Subject: [gdal-dev] Time for 2.1.2 ?
In-Reply-To: <4d00b2d4-6474-05c7-e74f-b16e3dd05faa@gmail.com>
References: <201610101907.45241.even.rouault@spatialys.com>
 <4d00b2d4-6474-05c7-e74f-b16e3dd05faa@gmail.com>
Message-ID: <201610111107.20594.even.rouault@spatialys.com>

Hi Dmitry,

> 
> What do you think about enabling GNM (network model) build by default in
> 2.1.2?

Firs step would be to enable it by default in trunk and monitor that things go 
well w.r.t. the CI setups displayed at https://github.com/OSGeo/gdal

Normally we aren't supposed to add new functionnality in micro releases, but 
we can probably make some exception here as it doesn't cause backward 
incompatible changes or ABI breakage. So if things go smoothly in trunk and 
nobody objects, I guess you can enable it in 2.1 too.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Oct 11 07:11:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 11 Oct 2016 16:11:10 +0200
Subject: [gdal-dev] Outdated external overviews
In-Reply-To: <a32d4ad1-545e-c4b7-778f-f2cd53448485@cnes.fr>
References: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>
 <201610071646.58739.even.rouault@spatialys.com>
 <a32d4ad1-545e-c4b7-778f-f2cd53448485@cnes.fr>
Message-ID: <201610111611.10059.even.rouault@spatialys.com>

Julien,

> 
> Thanks for your response. I understand all your points, and that Gdal
> requirements usually fall far beyond our limited use cases ... 

I was mostly playing the devil advocate. I don't have in mind real world use 
cases that would rely on .ovr being potentially older that the main file, while 
still considering them valid (anyone having such use cases ?). And I'd suspect 
they are probably very niche use cases, compared to the cases where the main 
image has been refreshed but an outdated overview file is hanging around.
On the other hand, my main fear with your proposal would be timestamp issues 
when copying datasets around that could make GDAL think that an .ovr is 
outdated whereas it is not. But that's perhaps a unusual case too.
(That said we have already timestamp based logic in the GML driver where the 
OGR generated .gfs file is only taken into account if more recent than the 
.gml. I can remember having had issues with that with the autotest suite that 
have required adding an explicit touch of the .gfs file before running the 
test. Might be just a SVN / git thing, or perhaps the content of the .gml was 
indeed minorly edited after the .gfs had been created.)

Thinking loud: would a USE_EVEN_IF_OLDER_THAN_MAIN_FILE=YES/NO metadata item 
added to the .ovr would make sense to determine the later behaviour ? I dunno. 
If folks are sufficiently aware to set this metadata to YES (assuming the new 
default would be NO), then they might as well touch the .ovr file after 
modifying the main file.

Anyway if you feel strong about changes in that area that have implications 
regarding backward compatibile behaviour, a RFC would be appropriate.

Even


> We can of
> course do a lot in the client code (starting with comparing timestamps),
> but this is not specific to our software, I bet Qgis for instance will
> happily use outdated overviews without notice. This is why I am
> wondering if it could not be handled more cleanly at the Gdal level. I
> understand though that this is not an easy problem to fix.
> 
> Regards,
> 
> Julien
> 
> Le 07/10/2016 à 16:46, Even Rouault a écrit :
> > Hi Julien,
> > 
> >> I recently came accross an issue in our software which uses overviews to
> >> speed-up navigation in image : the image can change after an external
> >> overview has been generated (for instance it has been re-generated by an
> >> upstream processing chain with different parameters), this can lead to
> >> display bugs or even crash in client code (if for instance the number of
> >> bands has changed)
> > 
> > Are the crashes you mention occuring in GDAL ? If so that should be
> > fixed. From a quick try, RasterIO() requests that involve overviews
> > trigger a proper error if the .ovr has less bands than the full
> > resolution dataset. Of course if client code directly uses
> > GetOverview(), it must be careful to check for NULL pointer.
> > 
> >> . Of course this is not a problem for the user that
> >> knows what she is doing : simply removing and generating the overview
> >> again fixes the problem. But for software that offers overview
> >> generation to the end user, this might become an issue, as the software
> >> has no clue wether the ovr file is outdated or not.
> >> 
> >> Possible mecanism to prevent this would be :
> >> 
> >> - Check file last modification time between external overview and image
> >> file. If image file is newer than overview files, it is probably
> >> outdated.
> > 
> > "Probably" yes :-) But I can imagine workflows where the overviews are
> > not necessarily a subsampling of the full resolution dataset, in which
> > case such behaviour wouldn't be desirable. I'm also wondering if that
> > wouldn't cause problems when datasets are copied. Hopefully timestamps
> > should be preserved most of the time, but I guess you could find
> > situations where they are not and where the overview could be copied
> > before the main dataset.
> > 
> >> - Encode image checksum in ovr file, and compare it upon loading (might
> >> be a bit intensive).
> > 
> > We definitely don't want to do that on gigabyte sized datasets...
> > 
> >> With those checks, gdal could detect that the ovr file is outdated and
> >> simply ignore it. Then client code could be aware that there are
> >> actually no overviews for this image and take actions to generate new
> >> ones.
> > 
> > The client code can also use the GDALDataset::GetFileList() API and see
> > if there's a .ovr file listed in there. And thus decide to apply a
> > timestamp based logic if it whishes.
> > 
> > Or one could imagine to put that logic into GDAL itself, but I think that
> > should be an option explicitly set.
> > 
> > There would be a subtelty also. Imagine that the external overview is
> > outdated, and you want to update it, but not recreate it from scratch.
> > For example if you know which area has been updated in full resolution
> > dataset. Then you'd want the overview to be still accessible. So hiding
> > the overview should only apply for datasets opened in read-only mode.
> > 
> >> PS: This of course does not apply if overviews are internal
> > 
> > You probably meant that detecting that overviews are outdated is even
> > less doable than for the external case, but that situation can still
> > happen.
> > 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Oct 11 07:34:58 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 11 Oct 2016 07:34:58 -0700 (MST)
Subject: [gdal-dev] Outdated external overviews
In-Reply-To: <201610111611.10059.even.rouault@spatialys.com>
References: <62fdf87f-bbfc-f60a-8207-ce5dbc625c94@cnes.fr>
 <201610071646.58739.even.rouault@spatialys.com>
 <a32d4ad1-545e-c4b7-778f-f2cd53448485@cnes.fr>
 <201610111611.10059.even.rouault@spatialys.com>
Message-ID: <1476196498779-5290252.post@n6.nabble.com>

Hi,

Hard to say if such use case exists. Perhaps if .ovr is actually not
subsampled from the main data at all but tweaked from let's say 1:50000
scale raster maps when the main maps are 1:20000.  I have created such
overview stacks sometimes through .vrt. I am not sure if the automatic
invalidating would have any effect in that case.

-Jukka Rahkonen-


Even Rouault-2 wrote
> Julien,
> 
>> 
>> Thanks for your response. I understand all your points, and that Gdal
>> requirements usually fall far beyond our limited use cases ... 
> 
> I was mostly playing the devil advocate. I don't have in mind real world
> use 
> cases that would rely on .ovr being potentially older that the main file,
> while 
> still considering them valid (anyone having such use cases ?). And I'd
> suspect 
> they are probably very niche use cases, compared to the cases where the
> main 
> image has been refreshed but an outdated overview file is hanging around.
> On the other hand, my main fear with your proposal would be timestamp
> issues 
> when copying datasets around that could make GDAL think that an .ovr is 
> outdated whereas it is not. But that's perhaps a unusual case too.
> (That said we have already timestamp based logic in the GML driver where
> the 
> OGR generated .gfs file is only taken into account if more recent than the 
> .gml. I can remember having had issues with that with the autotest suite
> that 
> have required adding an explicit touch of the .gfs file before running the 
> test. Might be just a SVN / git thing, or perhaps the content of the .gml
> was 
> indeed minorly edited after the .gfs had been created.)
> 
> Thinking loud: would a USE_EVEN_IF_OLDER_THAN_MAIN_FILE=YES/NO metadata
> item 
> added to the .ovr would make sense to determine the later behaviour ? I
> dunno. 
> If folks are sufficiently aware to set this metadata to YES (assuming the
> new 
> default would be NO), then they might as well touch the .ovr file after 
> modifying the main file.
> 
> Anyway if you feel strong about changes in that area that have
> implications 
> regarding backward compatibile behaviour, a RFC would be appropriate.
> 
> Even
> 
> 
>> We can of
>> course do a lot in the client code (starting with comparing timestamps),
>> but this is not specific to our software, I bet Qgis for instance will
>> happily use outdated overviews without notice. This is why I am
>> wondering if it could not be handled more cleanly at the Gdal level. I
>> understand though that this is not an easy problem to fix.
>> 
>> Regards,
>> 
>> Julien
>> 
>> Le 07/10/2016 à 16:46, Even Rouault a écrit :
>> > Hi Julien,
>> > 
>> >> I recently came accross an issue in our software which uses overviews
>> to
>> >> speed-up navigation in image : the image can change after an external
>> >> overview has been generated (for instance it has been re-generated by
>> an
>> >> upstream processing chain with different parameters), this can lead to
>> >> display bugs or even crash in client code (if for instance the number
>> of
>> >> bands has changed)
>> > 
>> > Are the crashes you mention occuring in GDAL ? If so that should be
>> > fixed. From a quick try, RasterIO() requests that involve overviews
>> > trigger a proper error if the .ovr has less bands than the full
>> > resolution dataset. Of course if client code directly uses
>> > GetOverview(), it must be careful to check for NULL pointer.
>> > 
>> >> . Of course this is not a problem for the user that
>> >> knows what she is doing : simply removing and generating the overview
>> >> again fixes the problem. But for software that offers overview
>> >> generation to the end user, this might become an issue, as the
>> software
>> >> has no clue wether the ovr file is outdated or not.
>> >> 
>> >> Possible mecanism to prevent this would be :
>> >> 
>> >> - Check file last modification time between external overview and
>> image
>> >> file. If image file is newer than overview files, it is probably
>> >> outdated.
>> > 
>> > "Probably" yes :-) But I can imagine workflows where the overviews are
>> > not necessarily a subsampling of the full resolution dataset, in which
>> > case such behaviour wouldn't be desirable. I'm also wondering if that
>> > wouldn't cause problems when datasets are copied. Hopefully timestamps
>> > should be preserved most of the time, but I guess you could find
>> > situations where they are not and where the overview could be copied
>> > before the main dataset.
>> > 
>> >> - Encode image checksum in ovr file, and compare it upon loading
>> (might
>> >> be a bit intensive).
>> > 
>> > We definitely don't want to do that on gigabyte sized datasets...
>> > 
>> >> With those checks, gdal could detect that the ovr file is outdated and
>> >> simply ignore it. Then client code could be aware that there are
>> >> actually no overviews for this image and take actions to generate new
>> >> ones.
>> > 
>> > The client code can also use the GDALDataset::GetFileList() API and see
>> > if there's a .ovr file listed in there. And thus decide to apply a
>> > timestamp based logic if it whishes.
>> > 
>> > Or one could imagine to put that logic into GDAL itself, but I think
>> that
>> > should be an option explicitly set.
>> > 
>> > There would be a subtelty also. Imagine that the external overview is
>> > outdated, and you want to update it, but not recreate it from scratch.
>> > For example if you know which area has been updated in full resolution
>> > dataset. Then you'd want the overview to be still accessible. So hiding
>> > the overview should only apply for datasets opened in read-only mode.
>> > 
>> >> PS: This of course does not apply if overviews are internal
>> > 
>> > You probably meant that detecting that overviews are outdated is even
>> > less doable than for the external case, but that situation can still
>> > happen.
>> > 
>> > Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Outdated-external-overviews-tp5289792p5290252.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From diregola at gmail.com  Tue Oct 11 08:44:43 2016
From: diregola at gmail.com (Margherita Di Leo)
Date: Tue, 11 Oct 2016 17:44:43 +0200
Subject: [gdal-dev] Need suggestion on clipping vectors in batch
In-Reply-To: <CABa=8QoiKaoYOWg1CSw=L7OsGQbaNBY0WypGW7qTH_jWWY=Hfw@mail.gmail.com>
References: <CABa=8QokmFGtic+4Wwh3WMhYK=tKW4zpTuLcoURkdD1i8MewQQ@mail.gmail.com>
 <201610052053.01918.even.rouault@spatialys.com>
 <CABa=8QrBoudjxzgN=6ZxV5xF092_FMNhpV827yLYUSCTPaBq=Q@mail.gmail.com>
 <201610061525.33061.even.rouault@spatialys.com>
 <CABa=8QoiKaoYOWg1CSw=L7OsGQbaNBY0WypGW7qTH_jWWY=Hfw@mail.gmail.com>
Message-ID: <CABa=8QrVMqNFKDXi+jN0esRT5a-q0Tm6hrtsb3Y4vYnqsuN2JQ@mail.gmail.com>

On Fri, Oct 7, 2016 at 12:00 PM, Margherita Di Leo <diregola at gmail.com>
wrote:

> Dear Even, all,
>
> On Thu, Oct 6, 2016 at 3:25 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le jeudi 06 octobre 2016 14:47:05, Margherita Di Leo a écrit :
>> > Dear Even,
>> >
>> >
>>
>> Try:
>>
>> export PYTHONPATH=$GDAL_INSTALL_DIR/lib/python2.7/site-packages
>>
>> ( adapt the path to the python version you use)
>>
>
> It didn't help.
> Sorry to go off-topic from original subject but I really cannot understand
> what's wrong with my work flow.
> I write down every single step:
>
> # Download source
> cd $HOME/opt
> svn checkout https://svn.osgeo.org/gdal/trunk/gdal gdal-source
>
> # Create bin dir
> mkdir -p $HOME/opt/gdal-bin
> export GDAL_INSTALL_DIR=$HOME/opt/gdal-bin
>
> # set environment variables for current session
> export PATH=$GDAL_INSTALL_DIR/bin:$PATH
> export LD_LIBRARY_PATH=$GDAL_INSTALL_DIR/lib:$LD_LIBRARY_PATH
> export GDAL_DATA=$GDAL_INSTALL_DIR/share/gdal
>
> # compile gdal in local folder
> cd $HOME/opt/gdal-source
> ./configure --prefix=$GDAL_INSTALL_DIR
> make
> make install
>
> # setting up python environment
> cd $HOME/opt/gdal-source/swig/python
> python setup.py build
> mkdir -p $GDAL_INSTALL_DIR/lib64/python2.7/site-packages/
> export PYTHONPATH=$GDAL_INSTALL_DIR/lib64/python2.7/site-packages:
> $PYTHONPATH
> python setup.py install --prefix=$GDAL_INSTALL_DIR
>
> # Check if works
> python
> from osgeo import gdal
>
>
> Traceback (most recent call last):
>   File "<stdin>", line 1, in <module>
>   File "osgeo/__init__.py", line 21, in <module>
>     _gdal = swig_import_helper()
>   File "osgeo/__init__.py", line 13, in swig_import_helper
>     import _gdal
> ImportError: No module named _gdal
>
>
> Outside python:
>
> gdalinfo --version
> GDAL 2.2.0dev, released 2016/99/99
>

 I don't know what was happening, but now this works. Sorry for the noise.


-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161011/8aae1590/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Thu Oct 13 05:47:54 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 13 Oct 2016 09:47:54 -0300
Subject: [gdal-dev] Time for 2.1.2 ?
In-Reply-To: <201610101907.45241.even.rouault@spatialys.com>
References: <201610101907.45241.even.rouault@spatialys.com>
Message-ID: <a9249084-ed52-236d-1066-dd7c2143f52b@gatewaygeomatics.com>

On 2016-10-10 2:07 PM, Even Rouault wrote:
> Hi,
>
> I'd like to prepare a RC for a 2.1.2 bugfix release on Friday, unless someone
> needs more time to push a fix. If there are outstanding issues not yet in the
> 2.1 branch and that would need to be considered for inclusion, speak up.
>
> The current fixes done since 2.1.1 are:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.1.2
> and probably most of those in:
> https://trac.osgeo.org/gdal/query?status=closed&group=resolution&milestone=2.0.4
>

In time for GDAL's 18th birthday on Monday the 17th?  ;)    Or added 
easter egg, to celebrate it, in the 2.1.2 release?   :)))

It's a great accomplishment, share the news.

-jeff







From a.neumann at carto.net  Fri Oct 14 00:45:38 2016
From: a.neumann at carto.net (Neumann, Andreas)
Date: Fri, 14 Oct 2016 09:45:38 +0200
Subject: [gdal-dev] Question on TIFF compression alternatives
Message-ID: <c5c75e07f60f9175b02a301a17ce9fec@carto.net>

Hi, 

I have a question on TIFF compression alternatives. 

My data of concern is 8bit gray value. Lots of white pixel (>95%), the
rest is black pixels (content) and some gray pixels because of
antialiasing. 

I would like to compress to save some storage, but I need a good
performance. What is the recommended compression that is fast on
decompression? 

I tried DEFLATE, but it is rather slow to decompress. Would LZW or
PACKBITS be preferred in this situation? How about LZMA? I would like to
avoid non-compressed data, because I use SSD storage for performance
reasons. 

Thanks for you reply, 

Andreas

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161014/1807cc9b/attachment.html>

From imangholiloo at alumni.ut.ac.ir  Fri Oct 14 02:11:34 2016
From: imangholiloo at alumni.ut.ac.ir (Mohammad.Imangholiloo)
Date: Fri, 14 Oct 2016 02:11:34 -0700 (MST)
Subject: [gdal-dev] What happens to pixel values > src_max under -scale?
In-Reply-To: <1476435776919-5290695.post@n6.nabble.com>
References: <52FE9AC1.2000802@mapbox.com>
 <201402142348.47956.even.rouault@mines-paris.org>
 <1476435776919-5290695.post@n6.nabble.com>
Message-ID: <1476436294435-5290701.post@n6.nabble.com>

Dear Even,
Hello,
I have similar question of Sean Gillies and more detailed like Dillabough,
Craig
(http://osgeo-org.1560.x6.nabble.com/Scaling-images-with-gdal-translate-td3752921.html
)
Basically, I am scaling Bigtiff-Geotiff float 32 with gdal (
gdal_translate -scale 0 1 0 10000 input.tif output_sc.tif) My input pixel
values are mainly between 0 1 (only 1 or 2 of pixel are >1 to 35), So, I
command 0 1 0 10,000. Output got to be between 0 266600.6875. According to
your answer for Sean Gillies, it should be 0 350,000. I wonder why it
scaled images as such? How to skip those strange and rare pixels by command
here

Thank you for any information.
Mohammad 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-What-happens-to-pixel-values-src-max-under-scale-tp5103924p5290701.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Oct 14 03:09:49 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Oct 2016 12:09:49 +0200
Subject: [gdal-dev] Question on TIFF compression alternatives
In-Reply-To: <c5c75e07f60f9175b02a301a17ce9fec@carto.net>
References: <c5c75e07f60f9175b02a301a17ce9fec@carto.net>
Message-ID: <201610141209.49714.even.rouault@spatialys.com>

Le vendredi 14 octobre 2016 09:45:38, Neumann, Andreas a écrit :
> Hi,
> 
> I have a question on TIFF compression alternatives.
> 
> My data of concern is 8bit gray value. Lots of white pixel (>95%), the
> rest is black pixels (content) and some gray pixels because of
> antialiasing.
> 
> I would like to compress to save some storage, but I need a good
> performance. What is the recommended compression that is fast on
> decompression?
> 
> I tried DEFLATE, but it is rather slow to decompress. Would LZW or
> PACKBITS be preferred in this situation? How about LZMA? I would like to
> avoid non-compressed data, because I use SSD storage for performance
> reasons.

My findings on a 37614 x 18816  8 bit image (a scan of a text page) that should 
be similar to what you describe.

Decompression time is the result of the second run of "time gdalinfo -
checksum" (so you can consider that I/O is cached by the OS and you measure 
essentially CPU time. storage is spinning disk)

No tiling:

Size			Compression			Decompression time
707895750	out_nocompression.tif	9.3 s

11239972	out_deflate.tif			10.8 s
17749306	out_lzw.tif				10.5 s
12337710	out_lzma.tif			12.6 s
36201320	out_packbits.tif			9.9 s

Tiling:

Size			Compression			Decompression time
 8813833		out_deflate_tiled.tif		11.1 s
14614121	out_lzw_tiled.tif			11.0 s
 8479238		out_lzma_tiled.tif		13.0 s
37018470	out_packbits_tiled.tif		10.2 s

Note: in the tiling case, the gdalinfo -checksum benchmark might not be ideal 
as it proceeds line by line (and not block by block), thus there's a lot of 
copying between cached blocks and output buffer that is done.

So I've done time gdal_translate XXX.tif /vsimem/out.tif -q :

deflate tiled:	2.5 s
lzw tiled:		2.3 s
packbits tiled: 	1.5 s
lzma tiled:		4.5 s

Times for non tiled files are essentially the same.


Note: if you use tiling and you have whole tiles that are at white value, if 
you use GDAL trunk, set the SPARSE_OK=YES creation option and set the nodata 
value to 255, then those tiles will be entirely omitted from the compressed 
file. This might save a few extra bytes, and also some decompression time.

gdal_translate out_nocompression.tif out_packbits_tiled.tif -co tiled=yes  -co 
compress=packbits
gdal_translate out_nocompression.tif out_packbits_tiled_sparse.tif -co 
tiled=yes -a_nodata 255 -co compress=packbits -co sparse_ok=yes

37018470	out_packbits_tiled.tif
30409074	out_packbits_tiled_sparse.tif

time gdal_translate out_packbits_tiled_sparse.tif /vsimem/out.tif -q: 1.3 s

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Fri Oct 14 04:01:50 2016
From: a.neumann at carto.net (Neumann, Andreas)
Date: Fri, 14 Oct 2016 13:01:50 +0200
Subject: [gdal-dev] Question on TIFF compression alternatives
In-Reply-To: <201610141209.49714.even.rouault@spatialys.com>
References: <c5c75e07f60f9175b02a301a17ce9fec@carto.net>
 <201610141209.49714.even.rouault@spatialys.com>
Message-ID: <3c987f34c59fa99e8981afc4c3a9aa1f@carto.net>

Hi Even, 

Thank you for your detailed reply. 

I should have added that my concern is mainly about random access to
parts of the images - for QGIS server and QGIS Desktop. 

I have internal pyramids. I am not so sure if it is tiled or not. Does
gdalinfo reveal whether the TIFF was created with "TILED=YES"? 

So from your analysis it looks like lzma is the slowest, but overall,
the differences aren't that huge. I don't know how random access to
parts of the image changes the game a bit, compared to your analysis
where you examine the decompression of the whole image - right? 

Thanks, 

Andreas 

On 2016-10-14 12:09, Even Rouault wrote:

> Le vendredi 14 octobre 2016 09:45:38, Neumann, Andreas a écrit : 
> 
>> Hi,
>> 
>> I have a question on TIFF compression alternatives.
>> 
>> My data of concern is 8bit gray value. Lots of white pixel (>95%), the
>> rest is black pixels (content) and some gray pixels because of
>> antialiasing.
>> 
>> I would like to compress to save some storage, but I need a good
>> performance. What is the recommended compression that is fast on
>> decompression?
>> 
>> I tried DEFLATE, but it is rather slow to decompress. Would LZW or
>> PACKBITS be preferred in this situation? How about LZMA? I would like to
>> avoid non-compressed data, because I use SSD storage for performance
>> reasons.
> 
> My findings on a 37614 x 18816  8 bit image (a scan of a text page) that should 
> be similar to what you describe.
> 
> Decompression time is the result of the second run of "time gdalinfo -
> checksum" (so you can consider that I/O is cached by the OS and you measure 
> essentially CPU time. storage is spinning disk)
> 
> No tiling:
> 
> Size            Compression            Decompression time
> 707895750    out_nocompression.tif    9.3 s
> 
> 11239972    out_deflate.tif            10.8 s
> 17749306    out_lzw.tif                10.5 s
> 12337710    out_lzma.tif            12.6 s
> 36201320    out_packbits.tif            9.9 s
> 
> Tiling:
> 
> Size            Compression            Decompression time
> 8813833        out_deflate_tiled.tif        11.1 s
> 14614121    out_lzw_tiled.tif            11.0 s
> 8479238        out_lzma_tiled.tif        13.0 s
> 37018470    out_packbits_tiled.tif        10.2 s
> 
> Note: in the tiling case, the gdalinfo -checksum benchmark might not be ideal 
> as it proceeds line by line (and not block by block), thus there's a lot of 
> copying between cached blocks and output buffer that is done.
> 
> So I've done time gdal_translate XXX.tif /vsimem/out.tif -q :
> 
> deflate tiled:    2.5 s
> lzw tiled:        2.3 s
> packbits tiled:     1.5 s
> lzma tiled:        4.5 s
> 
> Times for non tiled files are essentially the same.
> 
> Note: if you use tiling and you have whole tiles that are at white value, if 
> you use GDAL trunk, set the SPARSE_OK=YES creation option and set the nodata 
> value to 255, then those tiles will be entirely omitted from the compressed 
> file. This might save a few extra bytes, and also some decompression time.
> 
> gdal_translate out_nocompression.tif out_packbits_tiled.tif -co tiled=yes  -co 
> compress=packbits
> gdal_translate out_nocompression.tif out_packbits_tiled_sparse.tif -co 
> tiled=yes -a_nodata 255 -co compress=packbits -co sparse_ok=yes
> 
> 37018470    out_packbits_tiled.tif
> 30409074    out_packbits_tiled_sparse.tif
> 
> time gdal_translate out_packbits_tiled_sparse.tif /vsimem/out.tif -q: 1.3 s
> 
> Even

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161014/f331cdff/attachment.html>

From even.rouault at spatialys.com  Fri Oct 14 04:16:03 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Oct 2016 13:16:03 +0200
Subject: [gdal-dev] Question on TIFF compression alternatives
In-Reply-To: <3c987f34c59fa99e8981afc4c3a9aa1f@carto.net>
References: <c5c75e07f60f9175b02a301a17ce9fec@carto.net>
 <201610141209.49714.even.rouault@spatialys.com>
 <3c987f34c59fa99e8981afc4c3a9aa1f@carto.net>
Message-ID: <201610141316.03507.even.rouault@spatialys.com>

Le vendredi 14 octobre 2016 13:01:50, Neumann, Andreas a écrit :
> Hi Even,
> 
> Thank you for your detailed reply.
> 
> I should have added that my concern is mainly about random access to
> parts of the images - for QGIS server and QGIS Desktop.
> 
> I have internal pyramids. I am not so sure if it is tiled or not.

Internal pyramids created by GDAL are tiled with tiles of 128x128 pixel (can 
be changed with the GDAL_TIFF_OVR_BLOCKSIZE configuration option: 
http://gdal.org/frmt_gtiff.html#overviews . But the default is generally fine)

> Does
> gdalinfo reveal whether the TIFF was created with "TILED=YES"?

If you see something "Band 1 Block=256x256" in the gdalinfo output, the full 
resolution image is tiled. If the block width (the first figure after Block=) is 
the image width, then it is not. You definitely want to use a tiled image for 
random access.

> 
> So from your analysis it looks like lzma is the slowest, but overall,
> the differences aren't that huge. I don't know how random access to
> parts of the image changes the game a bit, compared to your analysis
> where you examine the decompression of the whole image - right?

I used whole image decompression otherwise the timings would have been hard to 
measure accurately. You can expect the same ratios of performance to apply to 
partial image decompression.

My timing were done on "hot" runs. Depending on use cases, I/O might be the 
overwhelming time.

> 
> Thanks,
> 
> Andreas
> 
> On 2016-10-14 12:09, Even Rouault wrote:
> > Le vendredi 14 octobre 2016 09:45:38, Neumann, Andreas a écrit :
> >> Hi,
> >> 
> >> I have a question on TIFF compression alternatives.
> >> 
> >> My data of concern is 8bit gray value. Lots of white pixel (>95%), the
> >> rest is black pixels (content) and some gray pixels because of
> >> antialiasing.
> >> 
> >> I would like to compress to save some storage, but I need a good
> >> performance. What is the recommended compression that is fast on
> >> decompression?
> >> 
> >> I tried DEFLATE, but it is rather slow to decompress. Would LZW or
> >> PACKBITS be preferred in this situation? How about LZMA? I would like to
> >> avoid non-compressed data, because I use SSD storage for performance
> >> reasons.
> > 
> > My findings on a 37614 x 18816  8 bit image (a scan of a text page) that
> > should be similar to what you describe.
> > 
> > Decompression time is the result of the second run of "time gdalinfo -
> > checksum" (so you can consider that I/O is cached by the OS and you
> > measure essentially CPU time. storage is spinning disk)
> > 
> > No tiling:
> > 
> > Size            Compression            Decompression time
> > 707895750    out_nocompression.tif    9.3 s
> > 
> > 11239972    out_deflate.tif            10.8 s
> > 17749306    out_lzw.tif                10.5 s
> > 12337710    out_lzma.tif            12.6 s
> > 36201320    out_packbits.tif            9.9 s
> > 
> > Tiling:
> > 
> > Size            Compression            Decompression time
> > 8813833        out_deflate_tiled.tif        11.1 s
> > 14614121    out_lzw_tiled.tif            11.0 s
> > 8479238        out_lzma_tiled.tif        13.0 s
> > 37018470    out_packbits_tiled.tif        10.2 s
> > 
> > Note: in the tiling case, the gdalinfo -checksum benchmark might not be
> > ideal as it proceeds line by line (and not block by block), thus there's
> > a lot of copying between cached blocks and output buffer that is done.
> > 
> > So I've done time gdal_translate XXX.tif /vsimem/out.tif -q :
> > 
> > deflate tiled:    2.5 s
> > lzw tiled:        2.3 s
> > packbits tiled:     1.5 s
> > lzma tiled:        4.5 s
> > 
> > Times for non tiled files are essentially the same.
> > 
> > Note: if you use tiling and you have whole tiles that are at white value,
> > if you use GDAL trunk, set the SPARSE_OK=YES creation option and set the
> > nodata value to 255, then those tiles will be entirely omitted from the
> > compressed file. This might save a few extra bytes, and also some
> > decompression time.
> > 
> > gdal_translate out_nocompression.tif out_packbits_tiled.tif -co tiled=yes
> >  -co compress=packbits
> > gdal_translate out_nocompression.tif out_packbits_tiled_sparse.tif -co
> > tiled=yes -a_nodata 255 -co compress=packbits -co sparse_ok=yes
> > 
> > 37018470    out_packbits_tiled.tif
> > 30409074    out_packbits_tiled_sparse.tif
> > 
> > time gdal_translate out_packbits_tiled_sparse.tif /vsimem/out.tif -q: 1.3
> > s
> > 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Oct 14 04:45:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Oct 2016 13:45:10 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC1 Available for Review
Message-ID: <201610141345.10916.even.rouault@spatialys.com>

Hi,

I have prepared a GDAL/OGR 2.1.2 release candidate. Please review and test. 
Testing from Mac users will be especially appreciated as currently our MacOSX 
Travis-CI instances do not work (https://trac.osgeo.org/gdal/ticket/6670)

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC1.tar.xz
  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC1.tar.gz
  http://download.osgeo.org/gdal/2.1.2/gdal212RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2.tar.gz
  http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.1.2-News

I'll call for a vote promoting it to final in the middle of next week if no 
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Oct 14 04:49:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 14 Oct 2016 13:49:28 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC1 Available for Review
In-Reply-To: <201610141345.10916.even.rouault@spatialys.com>
References: <201610141345.10916.even.rouault@spatialys.com>
Message-ID: <201610141349.28215.even.rouault@spatialys.com>


> A snapshot of the gdalautotest suite is also available :

Corrected links:
   http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC1.tar.gz
   http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC1.zip

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Fri Oct 14 12:45:34 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 14 Oct 2016 16:45:34 -0300
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC1 Available for Review
In-Reply-To: <201610141345.10916.even.rouault@spatialys.com>
References: <201610141345.10916.even.rouault@spatialys.com>
Message-ID: <539c6aee-7aa6-31cb-f52e-4e2b84f65c49@gatewaygeomatics.com>

On 2016-10-14 8:45 AM, Even Rouault wrote:
> Hi,
>
> I have prepared a GDAL/OGR 2.1.2 release candidate. Please review and test.
> Testing from Mac users will be especially appreciated as currently our MacOSX
> Travis-CI instances do not work (https://trac.osgeo.org/gdal/ticket/6670)
>

Works well with Visual Studio 2015 on Windows.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/








From jmckenna at gatewaygeomatics.com  Fri Oct 14 13:28:34 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 14 Oct 2016 17:28:34 -0300
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC1 Available for Review
In-Reply-To: <201610141345.10916.even.rouault@spatialys.com>
References: <201610141345.10916.even.rouault@spatialys.com>
Message-ID: <7d533b47-69ac-4fbc-9db5-3af7c1322a14@gatewaygeomatics.com>

On 2016-10-14 8:45 AM, Even Rouault wrote:
> Hi,
>
> I have prepared a GDAL/OGR 2.1.2 release candidate. Please review and test.
> Testing from Mac users will be especially appreciated as currently our MacOSX
> Travis-CI instances do not work (https://trac.osgeo.org/gdal/ticket/6670)

I was able to compile it on OSX.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From schwehr at gmail.com  Sun Oct 16 18:12:22 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sun, 16 Oct 2016 18:12:22 -0700
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC1 Available for Review
In-Reply-To: <201610141349.28215.even.rouault@spatialys.com>
References: <201610141345.10916.even.rouault@spatialys.com>
 <201610141349.28215.even.rouault@spatialys.com>
Message-ID: <CACmBxyvjAa5U1OubD40k8mzx4ipeea53iJMnkkZax5T_By3J-Q@mail.gmail.com>

+1 for RC1

On Fri, Oct 14, 2016 at 4:49 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
> > A snapshot of the gdalautotest suite is also available :
>
> Corrected links:
>    http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC1.tar.gz
>    http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC1.zip
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161016/07f9999c/attachment.html>

From jidnyasa.nilange at advancedriskanalytics.com  Sun Oct 16 23:49:39 2016
From: jidnyasa.nilange at advancedriskanalytics.com (Jidnyasa Nilange)
Date: Mon, 17 Oct 2016 12:19:39 +0530
Subject: [gdal-dev] FW: Function -  GDALCreatePansharpenedVRT
Message-ID: <001901d22842$a63528e0$f29f7aa0$@advancedriskanalytics.com>

 

 

Hi,

 

              I am trying to use  GDALCreatePansharpenedVRT  function
however I am not been able to interpret the argument const char * pszXML 

 

 Which is explained as  "Pansharpened VRT XML where <SpectralBand> elements
have no explicit SourceFilename and SourceBand. The spectral bands in the
XML will be assigned the successive values of the pahInputSpectralBands
array. Must not be NULL."

 

Can someone please explain me, if this function merely converts the
pansharpened VRT  XML to VRT dataset or does it actually pansharpens the
image using multispectral and panchromatic inputs. If the latter is true
please let me know how to generate such an XML and what it should consist
of. 

 

Waiting for the reply.

 

Thanks & Regards,

Jidnyasa N

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161017/15f7fe84/attachment.html>

From even.rouault at spatialys.com  Mon Oct 17 02:10:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Oct 2016 11:10:11 +0200
Subject: [gdal-dev] FW: Function -  GDALCreatePansharpenedVRT
In-Reply-To: <001901d22842$a63528e0$f29f7aa0$@advancedriskanalytics.com>
References: <001901d22842$a63528e0$f29f7aa0$@advancedriskanalytics.com>
Message-ID: <201610171110.12127.even.rouault@spatialys.com>

Hi,
> 
>               I am trying to use  GDALCreatePansharpenedVRT  function
> however I am not been able to interpret the argument const char * pszXML
> 
> 
> 
>  Which is explained as  "Pansharpened VRT XML where <SpectralBand> elements
> have no explicit SourceFilename and SourceBand. The spectral bands in the
> XML will be assigned the successive values of the pahInputSpectralBands
> array. Must not be NULL."
> 
> 
> 
> Can someone please explain me, if this function merely converts the
> pansharpened VRT  XML to VRT dataset

Yes

> or does it actually pansharpens the
> image using multispectral and panchromatic inputs

No, you have to read the content of the VRT dataset with GDAL RasterIO() API 
or translate it to another format like GTiff with GDALCreateCopy() for example.

> . If the latter is true
> please let me know how to generate such an XML and what it should consist
> of.

See also
http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_pansharpen

And also http://www.gdal.org/gdal_pansharpen.html if you don't need to embed 
that in your program but just run as an external program.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Oct 17 07:14:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 17 Oct 2016 16:14:26 +0200
Subject: [gdal-dev] FW: Function -  GDALCreatePansharpenedVRT
In-Reply-To: <002b01d2285e$e1f01450$a5d03cf0$@advancedriskanalytics.com>
References: <001901d22842$a63528e0$f29f7aa0$@advancedriskanalytics.com>
 <201610171110.12127.even.rouault@spatialys.com>
 <002b01d2285e$e1f01450$a5d03cf0$@advancedriskanalytics.com>
Message-ID: <201610171614.26784.even.rouault@spatialys.com>

Jidnyasa,

Please let the list CC'ed (I've re-added it)

> 
> Thanks for the reply. My doubt is if I am having only panchromatic and
> multispectral files as an input how to generate pansharpening vrt without
> using python script as I am trying to use only C++?

Well 2 choices:

1) port 
https://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal_pansharpen.py 
to C++. That shouldn't be too hard. It mostly formats the XML of the VRT and 
finally pass it to GDALCreateCopy

2) or perhaps less cumbersome, use the lower level C++ pansharping API of 
alg/gdalpansharpen.h ( http://www.gdal.org/gdalpansharpen_8h.html )

Even

> 
> Thanks & Regards,
> Jidnyasa N
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Monday, October 17, 2016 2:40 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Jidnyasa Nilange <jidnyasa.nilange at advancedriskanalytics.com>
> Subject: Re: [gdal-dev] FW: Function - GDALCreatePansharpenedVRT
> 
> Hi,
> 
> >               I am trying to use  GDALCreatePansharpenedVRT  function
> > 
> > however I am not been able to interpret the argument const char *
> > pszXML
> > 
> >  Which is explained as  "Pansharpened VRT XML where <SpectralBand>
> > 
> > elements have no explicit SourceFilename and SourceBand. The spectral
> > bands in the XML will be assigned the successive values of the
> > pahInputSpectralBands array. Must not be NULL."
> > 
> > 
> > 
> > Can someone please explain me, if this function merely converts the
> > pansharpened VRT  XML to VRT dataset
> 
> Yes
> 
> > or does it actually pansharpens the
> > image using multispectral and panchromatic inputs
> 
> No, you have to read the content of the VRT dataset with GDAL RasterIO()
> API or translate it to another format like GTiff with GDALCreateCopy() for
> example.
> 
> > . If the latter is true
> > please let me know how to generate such an XML and what it should
> > consist of.
> 
> See also
> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_pansharpen
> 
> And also http://www.gdal.org/gdal_pansharpen.html if you don't need to
> embed that in your program but just run as an external program.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jpinternet at live.fr  Mon Oct 17 16:11:24 2016
From: jpinternet at live.fr (jp internet)
Date: Mon, 17 Oct 2016 23:11:24 +0000
Subject: [gdal-dev] using WFS in virtual format
Message-ID: <DB5PR10MB0152E14DB4EFF29665960B30D7D00@DB5PR10MB0152.EURPRD10.PROD.OUTLOOK.COM>

Hello,
This is the first message I send on this list.
I want to know if it's possible to write a VRT from a WFS datasource write with a .xml and not with WFS:http://....
thank you in advance for your help

Jerôme Potel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161017/f688b686/attachment.html>

From jpinternet at live.fr  Mon Oct 17 16:12:16 2016
From: jpinternet at live.fr (jp internet)
Date: Mon, 17 Oct 2016 23:12:16 +0000
Subject: [gdal-dev] help
Message-ID: <DB5PR10MB01526BEFEEAD8E0B0C300690D7D00@DB5PR10MB0152.EURPRD10.PROD.OUTLOOK.COM>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161017/9e58129d/attachment.html>

From r.marcofiguera at jacobs-university.de  Tue Oct 18 02:38:08 2016
From: r.marcofiguera at jacobs-university.de (Ramiro Marco Figuera)
Date: Tue, 18 Oct 2016 11:38:08 +0200
Subject: [gdal-dev] Get specific parameter in CRS information with Python
	gdal
Message-ID: <870f6f18-03b4-4d22-3ecd-572237537831@jacobs-university.de>

Hi,

I have a tif image containing its CRS. I would like to extract the 
parameter "central_meridian". I have the following piece of code:

from osgeo import gdal,osr
ds=gdal.Open(r'hrs0000bf5c_07_if177l_trr3_CAT_scale_trial_p.img.tif')
prj=ds.GetProjection()
print prj

srs=osr.SpatialReference(wkt=prj)
print srs.GetAttrValue('PARAMETER',0)
print srs.GetAttrValue('PARAMETER',1)

The output I get is the following: 
PROJCS["Mars_Npolar_Stereo",GEOGCS["GCS_Unknown",DATUM["Unknown",SPHEROID["S_Unknown",3396190,169.8944472236118]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Polar_Stereographic"],PARAMETER["latitude_of_origin",90],PARAMETER["central_meridian",160.0712280273438],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]

latitude_of_origin 90

The code is fetching the first parameter: latitude_of_origin 90 but i 
would like to get the second one "central_meridian" but i don't know how 
to do it? Any ideas?

Thanks a lot.


-- 
Ramiro Marco Figuera
Research Associate - PhD Student
Department of Physics and Earth Sciences
Jacobs University Bremen
Campus Ring 1, 28759 Bremen, Germany
Office: Research III, Room 99b
Tel: +49 (0)421 200 3226


From menno at huss.nl  Tue Oct 18 06:00:01 2016
From: menno at huss.nl (mvscheers)
Date: Tue, 18 Oct 2016 06:00:01 -0700 (MST)
Subject: [gdal-dev]  ReadRaster C# Incorrect values
Message-ID: <1476795601991-5291259.post@n6.nabble.com>

Hi, 

Trying to get data from attached grib file. 

(BAND 1) 

 float[] bfr = new float[dataBand.XSize * dataBand.YSize]; 
            unsafe 
            { 
                fixed (float* dataPtr = bfr) 
                { 
                    dataBand.ReadRaster(0, 0, dataBand.XSize,
dataBand.YSize, (IntPtr) dataPtr, dataBand.XSize,dataBand.YSize,
DataType.GDT_Float64, 0, 0); 
                } 
            } 

All values returned are either the NO_DATA value (9999) or 0. 
ANything im doing wrong here ? 

L-000-MSG3__-MPEF________-MPEG_____-000000___-201610121330-__.grib
<http://osgeo-org.1560.x6.nabble.com/file/n5291259/L-000-MSG3__-MPEF________-MPEG_____-000000___-201610121330-__.grib>  



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-ReadRaster-C-Incorrect-values-tp5291259.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Oct 18 06:17:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Oct 2016 15:17:19 +0200
Subject: [gdal-dev] ReadRaster C# Incorrect values
In-Reply-To: <1476795601991-5291259.post@n6.nabble.com>
References: <1476795601991-5291259.post@n6.nabble.com>
Message-ID: <201610181517.19304.even.rouault@spatialys.com>

Le mardi 18 octobre 2016 15:00:01, mvscheers a écrit :
> Hi,
> 
> Trying to get data from attached grib file.
> 
> (BAND 1)
> 
>  float[] bfr = new float[dataBand.XSize * dataBand.YSize];
>             unsafe
>             {
>                 fixed (float* dataPtr = bfr)
>                 {
>                     dataBand.ReadRaster(0, 0, dataBand.XSize,
> dataBand.YSize, (IntPtr) dataPtr, dataBand.XSize,dataBand.YSize,
> DataType.GDT_Float64, 0, 0);
>                 }
>             }
> 

Probably a mismatch between C# float (32bit) and GDT_Float64. Either use float + 
GDT_Float32 or double + GDT_Float64


> All values returned are either the NO_DATA value (9999) or 0.
> ANything im doing wrong here ?
> 
> L-000-MSG3__-MPEF________-MPEG_____-000000___-201610121330-__.grib
> <http://osgeo-org.1560.x6.nabble.com/file/n5291259/L-000-MSG3__-MPEF_______
> _-MPEG_____-000000___-201610121330-__.grib>
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-ReadRaster-C-Incorrect-values
> -tp5291259.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Oct 18 06:19:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Oct 2016 15:19:06 +0200
Subject: [gdal-dev] Get specific parameter in CRS information with
	Python gdal
In-Reply-To: <870f6f18-03b4-4d22-3ecd-572237537831@jacobs-university.de>
References: <870f6f18-03b4-4d22-3ecd-572237537831@jacobs-university.de>
Message-ID: <201610181519.06567.even.rouault@spatialys.com>

Le mardi 18 octobre 2016 11:38:08, Ramiro Marco Figuera a écrit :
> Hi,
> 
> I have a tif image containing its CRS. I would like to extract the
> parameter "central_meridian". I have the following piece of code:
> 
> from osgeo import gdal,osr
> ds=gdal.Open(r'hrs0000bf5c_07_if177l_trr3_CAT_scale_trial_p.img.tif')
> prj=ds.GetProjection()
> print prj
> 
> srs=osr.SpatialReference(wkt=prj)
> print srs.GetAttrValue('PARAMETER',0)
> print srs.GetAttrValue('PARAMETER',1)
> 
> The output I get is the following:
> PROJCS["Mars_Npolar_Stereo",GEOGCS["GCS_Unknown",DATUM["Unknown",SPHEROID["
> S_Unknown",3396190,169.8944472236118]],PRIMEM["Greenwich",0],UNIT["degree",
> 0.0174532925199433]],PROJECTION["Polar_Stereographic"],PARAMETER["latitude_
> of_origin",90],PARAMETER["central_meridian",160.0712280273438],PARAMETER["s
> cale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],
> UNIT["metre",1,AUTHORITY["EPSG","9001"]]]
> 
> latitude_of_origin 90
> 
> The code is fetching the first parameter: latitude_of_origin 90 but i
> would like to get the second one "central_meridian" but i don't know how
> to do it? Any ideas?

Relevant extract from 
https://svn.osgeo.org/gdal/trunk/autotest/osr/osr_basic.py


    parm_list = \
              [ (osr.SRS_PP_CENTRAL_MERIDIAN, -117.0),
                (osr.SRS_PP_LATITUDE_OF_ORIGIN, 0.0),
                (osr.SRS_PP_SCALE_FACTOR, 0.9996),
                (osr.SRS_PP_FALSE_EASTING, 500000.0),
                (osr.SRS_PP_FALSE_NORTHING, 0.0) ]

    for parm in parm_list:
        value = utm_srs.GetProjParm( parm[0], -1111 )
        if abs(value-parm[1]) > .00000000000010:
            gdaltest.post_reason( 'got %g for %s instead of %g.' \
                                  % (value, parm[0], parm[1] ) )
            return 'fail'




> 
> Thanks a lot.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Oct 18 06:20:53 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Oct 2016 15:20:53 +0200
Subject: [gdal-dev] using WFS in virtual format
In-Reply-To: <DB5PR10MB0152E14DB4EFF29665960B30D7D00@DB5PR10MB0152.EURPRD10.PROD.OUTLOOK.COM>
References: <DB5PR10MB0152E14DB4EFF29665960B30D7D00@DB5PR10MB0152.EURPRD10.PROD.OUTLOOK.COM>
Message-ID: <201610181520.53350.even.rouault@spatialys.com>

Le mardi 18 octobre 2016 01:11:24, jp internet a écrit :
> Hello,
> This is the first message I send on this list.
> I want to know if it's possible to write a VRT from a WFS datasource write
> with a .xml and not with WFS:http://.... thank you in advance for your
> help
> 

Jérôme,

not completely sure to understand what you want to do.

But you can

1) Create a special XML file that will contain the definition of the WFS 
service:
http://gdal.org/drv_wfs.html

2) You can reference either "WFS:http://" or a .xml file conforming to point 1) 
as the datasource name in a OGR VRT file

Even

> Jerôme Potel

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From menno at huss.nl  Tue Oct 18 06:23:28 2016
From: menno at huss.nl (mvscheers)
Date: Tue, 18 Oct 2016 06:23:28 -0700 (MST)
Subject: [gdal-dev] ReadRaster C# Incorrect values
In-Reply-To: <201610181517.19304.even.rouault@spatialys.com>
References: <1476795601991-5291259.post@n6.nabble.com>
 <201610181517.19304.even.rouault@spatialys.com>
Message-ID: <1476797008080-5291263.post@n6.nabble.com>

Thanks for the suggestion, 

I posted a wrong example (Tried everything, converting bytes to doubles etc)
I have tried reading float64 -> c# double. same problem.

Doing this in c++ yields the same result.

Viewing this grib file in panoply gives correct results.

Still at a loss here



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-ReadRaster-C-Incorrect-values-tp5291259p5291263.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Oct 18 06:26:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 18 Oct 2016 15:26:56 +0200
Subject: [gdal-dev] ReadRaster C# Incorrect values
In-Reply-To: <1476797008080-5291263.post@n6.nabble.com>
References: <1476795601991-5291259.post@n6.nabble.com>
 <201610181517.19304.even.rouault@spatialys.com>
 <1476797008080-5291263.post@n6.nabble.com>
Message-ID: <201610181526.56213.even.rouault@spatialys.com>

Le mardi 18 octobre 2016 15:23:28, mvscheers a écrit :
> Thanks for the suggestion,
> 
> I posted a wrong example (Tried everything, converting bytes to doubles
> etc) I have tried reading float64 -> c# double. same problem.
> 
> Doing this in c++ yields the same result.
> 
> Viewing this grib file in panoply gives correct results.
> 
> Still at a loss here

I hadn't seen you attached the file. gdalinfo -stats also confirm your findings. 
This is probably a defect in the g2clib/degrib libraries used by GDAL to 
decode GRIB files.


> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-ReadRaster-C-Incorrect-values
> -tp5291259p5291263.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct 19 02:09:43 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Oct 2016 11:09:43 +0200
Subject: [gdal-dev] Motion: Promote 2.1.2RC1 for release
Message-ID: <201610191109.43536.even.rouault@spatialys.com>

Motion: GDAL/OGR 2.1.2RC1 is promoted to be the official 2.1.2 final release.

---

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Wed Oct 19 04:56:43 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 19 Oct 2016 08:56:43 -0300
Subject: [gdal-dev] Motion: Promote 2.1.2RC1 for release
In-Reply-To: <201610191109.43536.even.rouault@spatialys.com>
References: <201610191109.43536.even.rouault@spatialys.com>
Message-ID: <ce63eed1-a71c-8faf-4d7e-fc972e28f472@gatewaygeomatics.com>

On 2016-10-19 6:09 AM, Even Rouault wrote:
> Motion: GDAL/OGR 2.1.2RC1 is promoted to be the official 2.1.2 final release.
>

+1  jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From jidnyasa.nilange at advancedriskanalytics.com  Wed Oct 19 05:57:52 2016
From: jidnyasa.nilange at advancedriskanalytics.com (Jidnyasa Nilange)
Date: Wed, 19 Oct 2016 18:27:52 +0530
Subject: [gdal-dev] FW: Function -  GDALCreatePansharpenedVRT
In-Reply-To: <201610171614.26784.even.rouault@spatialys.com>
References: <001901d22842$a63528e0$f29f7aa0$@advancedriskanalytics.com>
 <201610171110.12127.even.rouault@spatialys.com>
 <002b01d2285e$e1f01450$a5d03cf0$@advancedriskanalytics.com>
 <201610171614.26784.even.rouault@spatialys.com>
Message-ID: <000101d22a08$6bba4480$432ecd80$@advancedriskanalytics.com>

Hi,

Can anyone provide me a flowchart of the methods to be used to actually access the pansharpened dataset and convert it into .tif?
i.e. I would like to know how to move ahead after getting CE_NONE from GDALPansharpenProcessRegion method. 

Thanks & regards,
Jidnyasa N

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Monday, October 17, 2016 7:44 PM
To: Jidnyasa Nilange <jidnyasa.nilange at advancedriskanalytics.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] FW: Function - GDALCreatePansharpenedVRT

Jidnyasa,

Please let the list CC'ed (I've re-added it)

> 
> Thanks for the reply. My doubt is if I am having only panchromatic and 
> multispectral files as an input how to generate pansharpening vrt 
> without using python script as I am trying to use only C++?

Well 2 choices:

1) port
https://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal_pansharpen.py
to C++. That shouldn't be too hard. It mostly formats the XML of the VRT and finally pass it to GDALCreateCopy

2) or perhaps less cumbersome, use the lower level C++ pansharping API of alg/gdalpansharpen.h ( http://www.gdal.org/gdalpansharpen_8h.html )

Even

> 
> Thanks & Regards,
> Jidnyasa N
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Monday, October 17, 2016 2:40 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Jidnyasa Nilange <jidnyasa.nilange at advancedriskanalytics.com>
> Subject: Re: [gdal-dev] FW: Function - GDALCreatePansharpenedVRT
> 
> Hi,
> 
> >               I am trying to use  GDALCreatePansharpenedVRT  
> > function
> > 
> > however I am not been able to interpret the argument const char * 
> > pszXML
> > 
> >  Which is explained as  "Pansharpened VRT XML where <SpectralBand>
> > 
> > elements have no explicit SourceFilename and SourceBand. The 
> > spectral bands in the XML will be assigned the successive values of 
> > the pahInputSpectralBands array. Must not be NULL."
> > 
> > 
> > 
> > Can someone please explain me, if this function merely converts the 
> > pansharpened VRT  XML to VRT dataset
> 
> Yes
> 
> > or does it actually pansharpens the
> > image using multispectral and panchromatic inputs
> 
> No, you have to read the content of the VRT dataset with GDAL 
> RasterIO() API or translate it to another format like GTiff with 
> GDALCreateCopy() for example.
> 
> > . If the latter is true
> > please let me know how to generate such an XML and what it should 
> > consist of.
> 
> See also
> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_pansharpen
> 
> And also http://www.gdal.org/gdal_pansharpen.html if you don't need to 
> embed that in your program but just run as an external program.
> 
> Even
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com

--
Spatialys - Geospatial professional services http://www.spatialys.com


From Odd-Ragnar.Lydersen at powel.no  Wed Oct 19 06:17:52 2016
From: Odd-Ragnar.Lydersen at powel.no (Odd Ragnar Lydersen)
Date: Wed, 19 Oct 2016 13:17:52 +0000
Subject: [gdal-dev] WFS driver bug2 - MAXFEATURES not working
In-Reply-To: <201609291119.55396.even.rouault@spatialys.com>
References: <BD69AB4022C5C34DAC908920605A87025A6123A0@MAIL.powelasa.powel.com>
 <BD69AB4022C5C34DAC908920605A87025A61243D@MAIL.powelasa.powel.com>
 <201609291119.55396.even.rouault@spatialys.com>
Message-ID: <BD69AB4022C5C34DAC908920605A87025A614981@MAIL.powelasa.powel.com>

Now I have come around to test this a bit more.
 
1) I tried the same as you did, only for wfs v. 1.1.0

ogrinfo -ro "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1"  continents -al  -spat 0 45 15 50
INFO: Open of `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1'
      using driver `WFS' successful.
Metadata:
  ABSTRACT=This demonstration server showcases MapServer (www.mapserver.org) and its OGC support
  PROVIDER_NAME=Gateway Geomatics
  TITLE=WMS Demo Server for MapServer

Layer name: continents
Metadata:
  TITLE=World continents
Geometry: Unknown (any)
Feature Count: 0
...

Not working in version 1.1.0.

2) I add the spatial filter to the URL, using BBOX.

ogrinfo -ro "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1&BBOX=0,45,15,50"  continents -al
INFO: Open of `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1&BBOX=0,45,15,50'
      using driver `WFS' successful.
Metadata:
  ABSTRACT=This demonstration server showcases MapServer (www.mapserver.org) and its OGC support
  PROVIDER_NAME=Gateway Geomatics
  TITLE=WMS Demo Server for MapServer

Layer name: continents
Metadata:
  TITLE=World continents
Geometry: Unknown (any)
Feature Count: 1
...

Working in version 1.1.0, when adding BBOX to URL.

3) Then I tested this out in our application, and all is well if I read GDAL:WFS without really using the C++ api, and just setting up the config file with the correct URL-parameters. Both version 1.0.0 and 1.1.0 works.

Shouldn't this work just as well using the C++ API calls, to set up the spatial constraints, and maxfeatures?
Now I'm rather editing the URL to get the result I want, and that is OK, but a bit awkward and cumbersome.

>Odd-Ragnar<

-----Opprinnelig melding-----
Fra: Even Rouault [mailto:even.rouault at spatialys.com] 
Sendt: torsdag 29. september 2016 11.20
Til: gdal-dev at lists.osgeo.org
Kopi: Odd Ragnar Lydersen <Odd-Ragnar.Lydersen at powel.no>
Emne: Re: [gdal-dev] WFS driver bug2 - MAXFEATURES not working

Le jeudi 29 septembre 2016 10:06:12, Odd Ragnar Lydersen a écrit :
> So I have tried to dig a bit more into this, and I have noticed a few 
> things.
> 
> 
> 1)      I set MAXFEATURES=60 in the url
> 
> 2)      I select the layer I want to work with, let's call it MyLayer.
> 
> 3)      I call SetSpatialFilterRect() on the MyLayer and set it to a small
> area containing 11 points.
> 
> 4)      I call GetFeatureCount() on MyLayer, and then I get 60 features
> returned, even though I know it should be spatially bound to an area 
> containing only 11 features.
> 
> 5)      Then I should be iterating through all the features, using
> GetNextFeature(), but no features are read.
> 
> In 4), the result from GetFeatureCount(), should have been 11.
> In 5), I should have been able to read the expected 11 features.
> 

The WFS driver has quite a bunch of optimizations (and workarounds for buggy implementations), which are as many doors for more or less subtle bugs, but in my below testing, that seems to work :

$ python
>>> from osgeo import ogr
>>> ds = 
>>> ogr.Open('WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.0.0&MA
>>> XFEATURES=1') lyr = ds.GetLayerByName('continents')
>>> lyr.SetSpatialFilterRect(0,45,15,50)
>>> print(lyr.GetFeatureCount())
1
>>> f = lyr.GetNextFeature()
>>> print(f['NA2DESC'])
'Italy'
>>> f = lyr.GetNextFeature()
>>> print(f)
None

or from the command line :
$ ogrinfo -ro "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.0.0&MAXFEATURES=1"  continents -al  -spat 0 45 15 50
INFO: Open of `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.0.0&MAXFEATURES=1'
      using driver `WFS' successful.
Metadata:
  ABSTRACT=This demonstration server showcases MapServer (www.mapserver.org) and its OGC support
  TITLE=WMS Demo Server for MapServer

Layer name: continents
Metadata:
  TITLE=World continents
Geometry: Unknown (any)
Feature Count: 1
Extent: (13.427750, 45.697224) - (13.439472, 45.711639) Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Geometry Column = msGeometry
gml_id: String (0.0) NOT NULL
NA2DESC: String (0.0)
NA3DESC: String (0.0)
OGRFeature(continents):22518
  gml_id (String) = continents.22518
  NA2DESC (String) = Italy
  NA3DESC (String) = Europe
  POLYGON ((13.437944 45.708195,13.438861 45.706806,13.439472 45.705387,13.438694 45.702862,13.436277 45.700832,13.432834 45.697224,13.431194 45.697472,13.430611
45.699085,13.432083 45.702999,13.432167 45.704613,13.430305 45.707443,13.42775 45.709583,13.4285 45.711639,13.43275 45.710167,13.437944 45.708195))





Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From howard at hobu.co  Wed Oct 19 06:35:41 2016
From: howard at hobu.co (Howard Butler)
Date: Wed, 19 Oct 2016 08:35:41 -0500
Subject: [gdal-dev] Motion: Promote 2.1.2RC1 for release
In-Reply-To: <ce63eed1-a71c-8faf-4d7e-fc972e28f472@gatewaygeomatics.com>
References: <201610191109.43536.even.rouault@spatialys.com>
 <ce63eed1-a71c-8faf-4d7e-fc972e28f472@gatewaygeomatics.com>
Message-ID: <BDDDA584-5B7A-4D4A-BB1A-D41A19B93F0B@hobu.co>


> On Oct 19, 2016, at 6:56 AM, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> 
> On 2016-10-19 6:09 AM, Even Rouault wrote:
>> Motion: GDAL/OGR 2.1.2RC1 is promoted to be the official 2.1.2 final release.
>> 
> 
> +1  jeff

+1 Howard

From even.rouault at spatialys.com  Wed Oct 19 06:55:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Oct 2016 15:55:19 +0200
Subject: [gdal-dev] WFS driver bug2 - MAXFEATURES not working
In-Reply-To: <BD69AB4022C5C34DAC908920605A87025A614981@MAIL.powelasa.powel.com>
References: <BD69AB4022C5C34DAC908920605A87025A6123A0@MAIL.powelasa.powel.com>
 <201609291119.55396.even.rouault@spatialys.com>
 <BD69AB4022C5C34DAC908920605A87025A614981@MAIL.powelasa.powel.com>
Message-ID: <201610191555.19198.even.rouault@spatialys.com>

Le mercredi 19 octobre 2016 15:17:52, Odd Ragnar Lydersen a écrit :
> Now I have come around to test this a bit more.
> 
> 1) I tried the same as you did, only for wfs v. 1.1.0
> 
> ogrinfo -ro
> "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1" 
> continents -al  -spat 0 45 15 50 INFO: Open of
> `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1'
> using driver `WFS' successful.
> Metadata:
>   ABSTRACT=This demonstration server showcases MapServer
> (www.mapserver.org) and its OGC support PROVIDER_NAME=Gateway Geomatics
>   TITLE=WMS Demo Server for MapServer
> 
> Layer name: continents
> Metadata:
>   TITLE=World continents
> Geometry: Unknown (any)
> Feature Count: 0
> ...
> 
> Not working in version 1.1.0.

Add "-oo CONSIDER_EPSG_AS_URN=YES". MapServer WFS 1.1 returns srsName in 
EPSG:XXX form even though it honours EPSG axix order (ie lat, long). But the 
OGR GML & WFS readers interpret "EPSG:XXXX" as the old GIS convention (long, 
lat order). So here it will let the coordinates in that lat, long order, but 
when evaluating the spatial filter on client side, it will discard the feature 
as the coordinates are in the wrong order.
Specifying CONSIDER_EPSG_AS_URN=YES will instruct them to interpret EPSG:xxxx 
as if it was urn:ogc:def:crs:EPSG::XXXX

Disclaimer: I'm not responsible for the axis order mess :-)

> 
> 2) I add the spatial filter to the URL, using BBOX.
> 
> ogrinfo -ro
> "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1&BBO
> X=0,45,15,50"  continents -al INFO: Open of
> `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1&BBO
> X=0,45,15,50' using driver `WFS' successful.
> Metadata:
>   ABSTRACT=This demonstration server showcases MapServer
> (www.mapserver.org) and its OGC support PROVIDER_NAME=Gateway Geomatics
>   TITLE=WMS Demo Server for MapServer
> 
> Layer name: continents
> Metadata:
>   TITLE=World continents
> Geometry: Unknown (any)
> Feature Count: 1
> ...
> 
> Working in version 1.1.0, when adding BBOX to URL.

Works somehow, but note that the coordinate order is lat,long. Related to the 
previous point.

> 
> 3) Then I tested this out in our application, and all is well if I read
> GDAL:WFS without really using the C++ api, and just setting up the config
> file with the correct URL-parameters. Both version 1.0.0 and 1.1.0 works.
> 
> Shouldn't this work just as well using the C++ API calls, to set up the
> spatial constraints, and maxfeatures? Now I'm rather editing the URL to
> get the result I want, and that is OK, but a bit awkward and cumbersome.

Not sure to understand, but perhaps related to the above issue.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ao at t-kartor.se  Wed Oct 19 08:09:03 2016
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Wed, 19 Oct 2016 17:09:03 +0200
Subject: [gdal-dev] Read PDF with OGR
Message-ID: <8adbad94-b97c-407c-003c-48b4098a5667@t-kartor.se>

Hi list

I want to attach georeferencing to existing vector PDF files that lacks 
georef info.

This works without any issues using gdal:
gdal_translate -of PDF -a_srs EPSG:3006 -a_ullr 718500 6359200 726500 
6369100  <infile> <outfile> --config GDAL_PDF_DPI 300

but all attempts with ogr fails, even if the PDF driver is listed:
Unable to open datasource `k.pdf' with the following drivers.
   -> PDF

I tested with https://www.nps.gov/hfc/carto/PDF/ANTImap1.pdf with the 
same result, i.e. GDAL can read the vector PDF file but not OGR
ogrinfo --format pdf returns all available options etc.

I would like to use ogr2ogr so vector geospatial PDF's can be created. 
Is this possible?

Tested only with GDAL 2.1.1 on OSX 10.12

The two sample links in the bottom of http://www.gdal.org/frmt_pdf.html 
are broken.

-- 
Best Regards

Andreas Oxenstierna
T-Kartor Geospatial AB
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From even.rouault at spatialys.com  Wed Oct 19 08:47:25 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Oct 2016 17:47:25 +0200
Subject: [gdal-dev] Read PDF with OGR
In-Reply-To: <8adbad94-b97c-407c-003c-48b4098a5667@t-kartor.se>
References: <8adbad94-b97c-407c-003c-48b4098a5667@t-kartor.se>
Message-ID: <201610191747.26074.even.rouault@spatialys.com>

Le mercredi 19 octobre 2016 17:09:03, Andreas Oxenstierna a écrit :
> Hi list
> 
> I want to attach georeferencing to existing vector PDF files that lacks
> georef info.
> 
> This works without any issues using gdal:
> gdal_translate -of PDF -a_srs EPSG:3006 -a_ullr 718500 6359200 726500
> 6369100  <infile> <outfile> --config GDAL_PDF_DPI 300

gdal_translate will not attach georeferencing to existing PDF file, but it will 
create a new one, re-rasterizing its content.

Use rather gdal_edit.py : http://gdal.org/gdal_edit.html
That will just add the geospatial metadata and not change the rest of the PDF 
content.
This will also work for "vector" PDF files (although your example is already 
georeferenced)

> but all attempts with ogr fails, even if the PDF driver is listed:
> Unable to open datasource `k.pdf' with the following drivers.
>    -> PDF
> 
> I tested with https://www.nps.gov/hfc/carto/PDF/ANTImap1.pdf with the
> same result, i.e. GDAL can read the vector PDF file but not OGR
> ogrinfo --format pdf returns all available options etc.
> 

The OGR PDF driver only recognize by default very specific formulations of 
vector PDF that use the StructTreeRoot objects of the PDF specification, which 
is not the case for this sample.

There was a feature actually not yet documented. Done now :
"""
If there is no such logical structure, the driver will not try to interpret 
the vector content of the PDF, unless you defined the 
OGR_PDF_READ_NON_STRUCTURED configuration option to YES."""

So try:

ogrinfo ANTImap1.pdf --config OGR_PDF_READ_NON_STRUCTURED YES

Note that the conversion from PDF vectors to OGR geometries can be rough for 
some PDF objects.

> I would like to use ogr2ogr so vector geospatial PDF's can be created.
> Is this possible?

Yes. 
And you can combine raster + vector as explained in the tutorial at 
http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf 
(last link of the PDF driver documentation page)

> The two sample links in the bottom of http://www.gdal.org/frmt_pdf.html
> are broken.

I've removed/updated them

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ao at t-kartor.se  Wed Oct 19 09:36:19 2016
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Wed, 19 Oct 2016 18:36:19 +0200
Subject: [gdal-dev] Read PDF with OGR
In-Reply-To: <201610191747.26074.even.rouault@spatialys.com>
References: <8adbad94-b97c-407c-003c-48b4098a5667@t-kartor.se>
 <201610191747.26074.even.rouault@spatialys.com>
Message-ID: <c6b9944b-1877-9170-d9c9-b14508ec8475@t-kartor.se>

Thanks, gdal_edit.py worked as you described, exactly what I needed for 
these orienteering maps.

Yes, I wondered how OGR actually should interpret unstructured PDF 
vectors...
I unsuccesfully tested with vector PDFs created by several softwares - 
which softwares can actually create ogr-readable PDFs?


> Le mercredi 19 octobre 2016 17:09:03, Andreas Oxenstierna a écrit :
>> Hi list
>>
>> I want to attach georeferencing to existing vector PDF files that lacks
>> georef info.
>>
>> This works without any issues using gdal:
>> gdal_translate -of PDF -a_srs EPSG:3006 -a_ullr 718500 6359200 726500
>> 6369100  <infile> <outfile> --config GDAL_PDF_DPI 300
> gdal_translate will not attach georeferencing to existing PDF file, but it will
> create a new one, re-rasterizing its content.
>
> Use rather gdal_edit.py : http://gdal.org/gdal_edit.html
> That will just add the geospatial metadata and not change the rest of the PDF
> content.
> This will also work for "vector" PDF files (although your example is already
> georeferenced)
>
>> but all attempts with ogr fails, even if the PDF driver is listed:
>> Unable to open datasource `k.pdf' with the following drivers.
>>     -> PDF
>>
>> I tested with https://www.nps.gov/hfc/carto/PDF/ANTImap1.pdf with the
>> same result, i.e. GDAL can read the vector PDF file but not OGR
>> ogrinfo --format pdf returns all available options etc.
>>
> The OGR PDF driver only recognize by default very specific formulations of
> vector PDF that use the StructTreeRoot objects of the PDF specification, which
> is not the case for this sample.
>
> There was a feature actually not yet documented. Done now :
> """
> If there is no such logical structure, the driver will not try to interpret
> the vector content of the PDF, unless you defined the
> OGR_PDF_READ_NON_STRUCTURED configuration option to YES."""
>
> So try:
>
> ogrinfo ANTImap1.pdf --config OGR_PDF_READ_NON_STRUCTURED YES
>
> Note that the conversion from PDF vectors to OGR geometries can be rough for
> some PDF objects.
>
>> I would like to use ogr2ogr so vector geospatial PDF's can be created.
>> Is this possible?
> Yes.
> And you can combine raster + vector as explained in the tutorial at
> http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf
> (last link of the PDF driver documentation page)
>
>> The two sample links in the bottom of http://www.gdal.org/frmt_pdf.html
>> are broken.
> I've removed/updated them
>
> Even
>


-- 
Best regards

Andreas Oxenstierna
T-Kartor Geospatial AB
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From lucena_ivan at hotmail.com  Wed Oct 19 12:47:24 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 19 Oct 2016 19:47:24 +0000
Subject: [gdal-dev] Utilities as a library, C API
Message-ID: <BLUPR19MB0145672386521B7CCCC6821EF2D20@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi there,


I am trying to use C API defined in gdal_utils.h.


By reading the RFC 59.1 I understand that the SWIG wrappers will have a nice interface to pass the parameters [1], ex.:

          format --- output format ("GTiff", etc...)
          outputType --- output type (gdal.GDT_Byte, etc...)
          bandList --- array of band numbers (index start at 1)
          srcWin --- subwindow in pixels to extract: [left_x, top_y, width, height]

But it seems like for C, the only way to pass the parameters will be by passing "char** papszArgv" in the same fashion as GDAL command line.


That doesn't seems to be fair with poor C programmers like me. We would need to translate things like "format=XXX" to "-of XXX" and "outputType=XXX" to "-ot XXX" for all the options and all the utilities.


The GDALTranslateOptions is opaque [2], so we cannot access it's member either. See commented line and the error message:


       GDALTranslateOptions* psOptions = GDALTranslateOptionsNew( papszArgv, NULL );


//     psOptions->pszFormat = pszOutDriver; // error: dereferencing pointer to incomplete type


       hDstDataset = GDALTranslate(
           (const char*) pszOutFilename,
           (GDALDatasetH) hSrcDataset,
           (const GDALTranslateOptions*) psOptions,

           (int*) NULL );


       GDALTranslateOptionsFree( psOptions );


Is there any other way to pass the parameters to the GDAL "Utilities as Libraries" in C?


Thanks,

Ivan


[1] - https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library

[2] - http://www.gdal.org/gdal__utils_8h.html





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161019/ada0879f/attachment.html>

From even.rouault at spatialys.com  Wed Oct 19 12:55:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 19 Oct 2016 21:55:09 +0200
Subject: [gdal-dev] Utilities as a library, C API
In-Reply-To: <BLUPR19MB0145672386521B7CCCC6821EF2D20@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <BLUPR19MB0145672386521B7CCCC6821EF2D20@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <201610192155.10008.even.rouault@spatialys.com>

Ivan,

The fact that GDALTranslateOptions is opaque is a design decision that was the 
outcome of the discussion phase of RFC 59. It was thought that it would be 
difficult to have a stable C structure that could be also extented in the future 
without becoming too messy. For example regarding old options that would have 
been generalized into newer syntax. Hence the decision to have a minimal 
string based interface that takes the same arguments than the command line 
strings that lead to RFC 59.1.
So it is up to you to build a nicer API on top of this and build the string 
array (that's what the python bindings do for example). Note that the strings 
must be split like the arguments of the main(), ie. { "-of", "GTiff", NULL }. 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct 19 16:24:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2016 01:24:10 +0200
Subject: [gdal-dev] Motion: Promote 2.1.2RC1 for release
In-Reply-To: <201610191109.43536.even.rouault@spatialys.com>
References: <201610191109.43536.even.rouault@spatialys.com>
Message-ID: <201610200124.10844.even.rouault@spatialys.com>

Le mercredi 19 octobre 2016 11:09:43, Even Rouault a écrit :
> Motion: GDAL/OGR 2.1.2RC1 is promoted to be the official 2.1.2 final
> release.
> 
> ---
> 
> +1 Even

Sigh. Changing my vote to -1 as I just discovered that the fix done in 
https://trac.osgeo.org/gdal/ticket/6681 indirectly caused a regression in the 
PLScenes driver.
Fixed per https://trac.osgeo.org/gdal/ticket/6691

I'll issue a RC2

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct 19 16:44:20 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2016 01:44:20 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC2 Available for Review
Message-ID: <201610200144.20049.even.rouault@spatialys.com>

Hi,

I've generated a new RC because of a regression I just found (fixed per 
https://trac.osgeo.org/gdal/ticket/6691)

Updated links:

  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC2.tar.xz
  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC2.tar.gz
  http://download.osgeo.org/gdal/2.1.2/gdal212RC2.zip

  http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC2.tar.gz
  http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC2.zip

The changes since 2.1.2RC1 are:
* /vsimem/: fix potential crash when closing -different- handles pointing to the 
same file from different threads (fixes #6683)
* Fix multi-threading issues in read/write scenarios (fixes #6684)
* ILI1: fix crash in OGRILI1Layer::JoinSurfaceLayer() when the multicurve of 
the feature of the poSurfaceLineLayer layer is empty (fixes #6688)
* GPKG/SQLite/PG/FileGDB/MEM: properly set/reset field subtype with 
AlterFieldDefn() (fixes #6689)
* Fix regression in PLScenes V1 raster random access. Add a 
CPL_VSIL_CURL_ALLOWED_FILENAME config option to solve that (fixes #6691)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From LPlesea at esri.com  Wed Oct 19 21:11:03 2016
From: LPlesea at esri.com (Lucian Plesea)
Date: Thu, 20 Oct 2016 04:11:03 +0000
Subject: [gdal-dev] Simplify WMS minidriver managment?
Message-ID: <345d7ab4668e405a99b1ed04aca1160f@RED-INF-MXMB-P4.esri.com>

Does anyone have any objection on removing the dynamic aspect of the WMS minidriver manager?  It seems to be patterned on the GDAL driver registry, but within the confines of WMS there are no dynamic minidriver list changes.  It also leaks resources currently when the WMS driver is unregistered.
I do have a working solution I plan to commit.

Lucian



From Odd-Ragnar.Lydersen at powel.no  Wed Oct 19 22:31:31 2016
From: Odd-Ragnar.Lydersen at powel.no (Odd Ragnar Lydersen)
Date: Thu, 20 Oct 2016 05:31:31 +0000
Subject: [gdal-dev] WFS driver bug2 - MAXFEATURES not working
In-Reply-To: <201610191555.19198.even.rouault@spatialys.com>
References: <BD69AB4022C5C34DAC908920605A87025A6123A0@MAIL.powelasa.powel.com>
 <201609291119.55396.even.rouault@spatialys.com>
 <BD69AB4022C5C34DAC908920605A87025A614981@MAIL.powelasa.powel.com>
 <201610191555.19198.even.rouault@spatialys.com>
Message-ID: <BD69AB4022C5C34DAC908920605A87025A614A11@MAIL.powelasa.powel.com>

Thanks for the clarification about the axis order, which differs between the two versions of WFS.
That explains a lot, and first tests in my code is looking good.

Those pitfalls, are hard to see sometimes.

>Odd-Ragnar< 

-----Opprinnelig melding-----
Fra: Even Rouault [mailto:even.rouault at spatialys.com] 
Sendt: onsdag 19. oktober 2016 15.55
Til: Odd Ragnar Lydersen <Odd-Ragnar.Lydersen at powel.no>
Kopi: gdal-dev at lists.osgeo.org
Emne: Re: SV: [gdal-dev] WFS driver bug2 - MAXFEATURES not working

Le mercredi 19 octobre 2016 15:17:52, Odd Ragnar Lydersen a écrit :
> Now I have come around to test this a bit more.
> 
> 1) I tried the same as you did, only for wfs v. 1.1.0
> 
> ogrinfo -ro
> "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1" 
> continents -al  -spat 0 45 15 50 INFO: Open of 
> `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1'
> using driver `WFS' successful.
> Metadata:
>   ABSTRACT=This demonstration server showcases MapServer
> (www.mapserver.org) and its OGC support PROVIDER_NAME=Gateway Geomatics
>   TITLE=WMS Demo Server for MapServer
> 
> Layer name: continents
> Metadata:
>   TITLE=World continents
> Geometry: Unknown (any)
> Feature Count: 0
> ...
> 
> Not working in version 1.1.0.

Add "-oo CONSIDER_EPSG_AS_URN=YES". MapServer WFS 1.1 returns srsName in EPSG:XXX form even though it honours EPSG axix order (ie lat, long). But the OGR GML & WFS readers interpret "EPSG:XXXX" as the old GIS convention (long, lat order). So here it will let the coordinates in that lat, long order, but when evaluating the spatial filter on client side, it will discard the feature as the coordinates are in the wrong order.
Specifying CONSIDER_EPSG_AS_URN=YES will instruct them to interpret EPSG:xxxx as if it was urn:ogc:def:crs:EPSG::XXXX

Disclaimer: I'm not responsible for the axis order mess :-)

> 
> 2) I add the spatial filter to the URL, using BBOX.
> 
> ogrinfo -ro
> "WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1
> &BBO X=0,45,15,50"  continents -al INFO: Open of 
> `WFS:http://demo.mapserver.org/cgi-bin/wfs?VERSION=1.1.0&MAXFEATURES=1
> &BBO X=0,45,15,50' using driver `WFS' successful.
> Metadata:
>   ABSTRACT=This demonstration server showcases MapServer
> (www.mapserver.org) and its OGC support PROVIDER_NAME=Gateway Geomatics
>   TITLE=WMS Demo Server for MapServer
> 
> Layer name: continents
> Metadata:
>   TITLE=World continents
> Geometry: Unknown (any)
> Feature Count: 1
> ...
> 
> Working in version 1.1.0, when adding BBOX to URL.

Works somehow, but note that the coordinate order is lat,long. Related to the previous point.

> 
> 3) Then I tested this out in our application, and all is well if I 
> read GDAL:WFS without really using the C++ api, and just setting up 
> the config file with the correct URL-parameters. Both version 1.0.0 and 1.1.0 works.
> 
> Shouldn't this work just as well using the C++ API calls, to set up 
> the spatial constraints, and maxfeatures? Now I'm rather editing the 
> URL to get the result I want, and that is OK, but a bit awkward and cumbersome.

Not sure to understand, but perhaps related to the above issue.

--
Spatialys - Geospatial professional services http://www.spatialys.com

From diregola at gmail.com  Thu Oct 20 06:39:32 2016
From: diregola at gmail.com (Margherita Di Leo)
Date: Thu, 20 Oct 2016 15:39:32 +0200
Subject: [gdal-dev] Fwd: Geospatial devroom at FOSDEM 2017 on Sunday
	5/2/2017 in Brussels
In-Reply-To: <CABa=8QrKWCMAE_2w+gmyM4GxLzdCxQCYrq_-hw+B-mrw__5V=A@mail.gmail.com>
References: <CABa=8QrKWCMAE_2w+gmyM4GxLzdCxQCYrq_-hw+B-mrw__5V=A@mail.gmail.com>
Message-ID: <CABa=8QoUwqGxpwvBEfBgTsFddFoBtSFYweN6SfeBmRHEYrQy_w@mail.gmail.com>

*Apologies for cross posting!*

Call for Presentations

Please forward!

FOSDEM is a free and non-commercial event bringing together about 5000
developers in Brussels, Belgium. The goal is to provide open source
software developers and communities a place to meet and share thoughts. The
participation is free of charge, although donations are welcome. The next
edition will take place on 4 - 5 February 2017. For the third (!) time
there will be a Geospatial devroom and will be happening on Sunday 5/2/2017!

Geospatial technologies and mapping used to be specialist work, but
nowadays location and maps are becoming part of many projects/applications,
which usually use only a small subset of the possibilities the data and
software offer.

The geospatial devroom is the place to talk about open, geo-related data
and software and their ecosystem. This includes standards and tools, e.g.
for spatial databases, and online mapping, geospatial services, used for
collecting, storing, delivering, analysing, and visualizing purposes.

We welcome submissions about:

   -

   Web and desktop GIS applications;


   -

   Collaborative editing / versioning of geodata and metadata;
   -

   Interoperable geospatial web services and specifications;
   -

   Collection of data using sensors / UAVs / satellites;
   -

   Geo-analytic algorithms / libraries;
   -

   Geospatial extensions for classical databases (indexes, operations) and
   dedicated databases;
   -

   Big geodata, scalable GIS applications;
   -

   Volunteered Geographic information - Crowdsourced geodata.


HOW TO SUBMIT YOUR PROPOSAL FOR A TALK

Are you thrilled to present your work to other open source developers?
Would you like to run a discussion? Any other ideas?

Please submit your proposal at:

 https://fosdem.org/submit

Make sure to select the 'Geospatial devroom' as 'Track'. If you have an
account from previous years, you should be using the same.

Please specify in the notes if you prefer for your presentation either a
short timeslot (lightning talks ~10 minutes) or a long timeslot (20 minutes
presentation + discussion). However, note that time slots are indicative
and will be assigned according to the timing of the session.

The DEADLINE for submissions is Thursday **1st December 2016**.

Notification of acceptance will be sent to the Authors by 11/12/2016 at the
latest.

Should you have any questions, please do not hesitate to get in touch with
the organisers of the devroom at fosdem-geospatial at gisky.be!

Want to know what FOSDEM geospatial is like? Check out the videos and the
presentations of our previous two editions: [1,2]

The organizers

Johan Van de Wauw

Margherita Di Leo

Anne Ghisla

Martin Hammitzsch

[1] https://archive.fosdem.org/2015/schedule/track/geospatial/

[2] https://archive.fosdem.org/2016/schedule/track/geospatial/


-- 
Margherita Di Leo



-- 
Margherita Di Leo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161020/0cf14085/attachment-0001.html>

From lucena_ivan at hotmail.com  Thu Oct 20 08:03:03 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Thu, 20 Oct 2016 15:03:03 +0000
Subject: [gdal-dev] Utilities as a library, C API
In-Reply-To: <201610192155.10008.even.rouault@spatialys.com>
References: <BLUPR19MB0145672386521B7CCCC6821EF2D20@BLUPR19MB0145.namprd19.prod.outlook.com>,
 <201610192155.10008.even.rouault@spatialys.com>
Message-ID: <BLUPR19MB0145BB88DE4D271455767A33F2D50@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi Even,


OK. It is what it is. I guess.


I wrote a little test code:


#include <gdal.h>
#include <gdal_utils.h>

int main( int argc, char** argv )
{
   char* papszArgv[1024];
   int i = 0;

   const char*     pszSrcFilename = "rgbsmall.tif";
   const char*     pszDstFilename = "test90.tif";

   GDALDatasetH    hSrcDataset = NULL;
   GDALDatasetH    hDstDataset = NULL;

   GDALTranslateOptions* psOptions = NULL;

   GDALAllRegister();

   papszArgv[i++] = "-of";
   papszArgv[i++] = "GTIFF";

   papszArgv[i++] = "-b";
   papszArgv[i++] = "3";

   papszArgv[i++] = "-b";
   papszArgv[i++] = "2";

   papszArgv[i++] = "-b";
   papszArgv[i++] = "1";

   papszArgv[i++] = "-srcwin";
   papszArgv[i++] = "10";
   papszArgv[i++] = "10";
   papszArgv[i++] = "30";
   papszArgv[i++] = "30";

   papszArgv[i++] = "-co";
   papszArgv[i++] = "BLOCKXSIZE=4";

   papszArgv[i++] = "-co";
   papszArgv[i++] = "BLOCKYSIZE=4";

   papszArgv[i++] = NULL;

   psOptions   = GDALTranslateOptionsNew( papszArgv, NULL );

   hSrcDataset = GDALOpen( pszSrcFilename, GA_ReadOnly );

   hDstDataset = GDALTranslate( pszDstFilename, hSrcDataset, psOptions, NULL );

   GDALTranslateOptionsFree( psOptions );

   GDALClose( hSrcDataset );

   GDALClose( hDstDataset );
}


And I can say that it does work as expected. Maybe we should put that example somewhere on the wiki.


I found to interesting issues. That is just a C application using the GDAL C API but I could only compile with g++, not with gcc. I can't record that was the case 10 years ago. It used to be the case that gdal_translate itself was isolated from the core. Maybe it has something to do with that.


The GTIFF create-option BLOCKXSIZE doesn't seems to work. I tries with larger images and it seems like we can only control the number of rows on a block (BLOCKYSIZE),  but not the number of columns (BLOCKXSIZE).


Thanks again.


Best regards,

Ivan

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, October 19, 2016 3:55:09 PM
To: gdal-dev at lists.osgeo.org
Cc: Ivan Lucena
Subject: Re: [gdal-dev] Utilities as a library, C API

Ivan,

The fact that GDALTranslateOptions is opaque is a design decision that was the
outcome of the discussion phase of RFC 59. It was thought that it would be
difficult to have a stable C structure that could be also extented in the future
without becoming too messy. For example regarding old options that would have
been generalized into newer syntax. Hence the decision to have a minimal
string based interface that takes the same arguments than the command line
strings that lead to RFC 59.1.
So it is up to you to build a nicer API on top of this and build the string
array (that's what the python bindings do for example). Note that the strings
must be split like the arguments of the main(), ie. { "-of", "GTiff", NULL }.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161020/d8dff9e3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 20 10:33:59 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 20 Oct 2016 10:33:59 -0700 (MST)
Subject: [gdal-dev] New GMLAS (GML Application Schema) in trunk
In-Reply-To: <201610081403.41443.even.rouault@spatialys.com>
References: <201610081403.41443.even.rouault@spatialys.com>
Message-ID: <1476984839861-5291751.post@n6.nabble.com>

Hi Even

I made a very short test with these data:
http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistotietojen_kyselypalvelu_WFS/Asiakasdokumentaatio_wfs-2015/helmikuu2017/ktjkii-wfs-2015.xsd

http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistotietojen_kyselypalvelu_WFS/Asiakasdokumentaatio_wfs-2015/helmikuu2017/Esimerkit/Tuotteet/RekisteriyksikonSijaintitiedotTuote/vastaus-FTT-102-03.xml

http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistotietojen_kyselypalvelu_WFS/Asiakasdokumentaatio_wfs-2015/helmikuu2017/Esimerkit/Tuotteet/RekisteriyksikonSijaintitiedotTuote/vastaus-FTT-102-01.xml

http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistotietojen_kyselypalvelu_WFS/Asiakasdokumentaatio_wfs-2015/helmikuu2017/Esimerkit/Tuotteet/RekisteriyksikonSijaintitiedotTuote/vastaus-FTT-102-02.xml

The XSD schema is massive but GDAL seems to resolve it and it finds huge
amount of layers from the sample XML files, with geometries where they
belong to. Feels like an awesome work.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-New-GMLAS-GML-Application-Schema-in-trunk-tp5289894p5291751.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Oct 20 13:26:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2016 22:26:12 +0200
Subject: [gdal-dev] Utilities as a library, C API
In-Reply-To: <BLUPR19MB0145BB88DE4D271455767A33F2D50@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <BLUPR19MB0145672386521B7CCCC6821EF2D20@BLUPR19MB0145.namprd19.prod.outlook.com>
 <201610192155.10008.even.rouault@spatialys.com>
 <BLUPR19MB0145BB88DE4D271455767A33F2D50@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <3686562.EUCdsNsZ5Q@even-n550jk>

On Thursday 20 October 2016 15:03:03 Ivan Lucena wrote:
> Hi Even,
> 
> 
> OK. It is what it is. I guess.
> 
> 
> I wrote a little test code:
> 
> 
> #include <gdal.h>
> #include <gdal_utils.h>
> 
> int main( int argc, char** argv )
> {
>    char* papszArgv[1024];
>    int i = 0;
> 
>    const char*     pszSrcFilename = "rgbsmall.tif";
>    const char*     pszDstFilename = "test90.tif";
> 
>    GDALDatasetH    hSrcDataset = NULL;
>    GDALDatasetH    hDstDataset = NULL;
> 
>    GDALTranslateOptions* psOptions = NULL;
> 
>    GDALAllRegister();
> 
>    papszArgv[i++] = "-of";
>    papszArgv[i++] = "GTIFF";
> 
>    papszArgv[i++] = "-b";
>    papszArgv[i++] = "3";
> 
>    papszArgv[i++] = "-b";
>    papszArgv[i++] = "2";
> 
>    papszArgv[i++] = "-b";
>    papszArgv[i++] = "1";
> 
>    papszArgv[i++] = "-srcwin";
>    papszArgv[i++] = "10";
>    papszArgv[i++] = "10";
>    papszArgv[i++] = "30";
>    papszArgv[i++] = "30";
> 
>    papszArgv[i++] = "-co";
>    papszArgv[i++] = "BLOCKXSIZE=4";
> 
>    papszArgv[i++] = "-co";
>    papszArgv[i++] = "BLOCKYSIZE=4";
> 
>    papszArgv[i++] = NULL;
> 
>    psOptions   = GDALTranslateOptionsNew( papszArgv, NULL );
> 
>    hSrcDataset = GDALOpen( pszSrcFilename, GA_ReadOnly );
> 
>    hDstDataset = GDALTranslate( pszDstFilename, hSrcDataset, psOptions, NULL
> );
> 
>    GDALTranslateOptionsFree( psOptions );
> 
>    GDALClose( hSrcDataset );
> 
>    GDALClose( hDstDataset );
> }
> 
> 
> And I can say that it does work as expected. Maybe we should put that
> example somewhere on the wiki.
> 
> 
> I found to interesting issues. That is just a C application using the GDAL C
> API but I could only compile with g++, not with gcc.

Could you be more specific about the error you got ? It should be usable from 
pure C, but I'm not 100% positive this has been tested

> The GTIFF create-option BLOCKXSIZE doesn't seems to work. I tries with
> larger images and it seems like we can only control the number of rows on a
> block (BLOCKYSIZE),  but not the number of columns (BLOCKXSIZE).

BLOCKXSIZE is only taken into account if you also define TILED=YES.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthew.f.cechini at nasa.gov  Thu Oct 20 13:27:14 2016
From: matthew.f.cechini at nasa.gov (Cechini, Matthew F. (GSFC-423.0)[Science Systems & Applications, Inc.])
Date: Thu, 20 Oct 2016 20:27:14 +0000
Subject: [gdal-dev] gdal_merge nodata evaluation
Message-ID: <D42EA0D2.84D8E%matthew.f.cechini@nasa.gov>

All,
   We’ve recently begun usage of the gdal_merge utility in our processing workflow and have hit a snag.  I’m not sure if the snag is by design or is user error.  Here’s the scenario:

   We have two 24_bit PNG images, and existing image (E) and a new image (N) we are merging into E.  They are the same size/projection/etc, so that’s ignored here.  Some pixels within N are transparent with non-zero RGB band values.  The behavior we want is for gdal_merge to ignore these transparent pixels during the merge.  Unfortunately, it appears that the -n nodata_value argument is evaluated band-by-band.  So, the following merged pixel (M) occurs for a merge of E and N:
E: 100, 100, 100, 255
        N: 0, 0, 3, 0
        M: 100, 100, 3, 255

   To work around this, we figured out a gdal_calc command that will set RGB bands to 0 (nodata) in N if the pixel is transparent.  So that gives us this:

E: 100, 100, 100, 255
        N': 0, 0, 0, 0
        M: 100, 100, 100, 255

   That’s fine, however, we still have the problem of opaque pixels in N merging incorrectly:

E: 100, 100, 100, 255
        N: 0, 0, 3, 255
        M: 100, 100, 3, 255

   In this case, we either have to come up with a gnarly gdal_calc command… or accept the infrequent merge issues.

   The exploratory question is “why does gdal_merge evaluate the nodata value band-by-band?”  This is also a limitation with gdal_translate, whereas gdalwarp allows for multiple band nodata values.  Answers to that will be interesting, but not necessarily fix our immediate issue, so how do we resolve this situation using existing gdal capabilities?

Thanks,
Matt
.................................................................
Matthew Cechini
Contractor, Science Systems and Applications, Inc.
NASA GIBS Systems/Software Engineer
410.205.6272
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161020/871170d2/attachment.html>

From even.rouault at spatialys.com  Thu Oct 20 13:56:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2016 22:56:37 +0200
Subject: [gdal-dev] gdal_merge nodata evaluation
In-Reply-To: <D42EA0D2.84D8E%matthew.f.cechini@nasa.gov>
References: <D42EA0D2.84D8E%matthew.f.cechini@nasa.gov>
Message-ID: <1847224.IarHmd4cU4@even-n550jk>

On Thursday 20 October 2016 20:27:14 Cechini, GSFC-423.0, Inc.] wrote:
> All,
>    We’ve recently begun usage of the gdal_merge utility in our processing
> workflow and have hit a snag.  I’m not sure if the snag is by design or is
> user error.  Here’s the scenario:
 
>    We have two 24_bit PNG images, and existing image (E) and a new image (N)
> we are merging into E.  They are the same size/projection/etc, so that’s
> ignored here.  Some pixels within N are transparent with non-zero RGB band
> values.  The behavior we want is for gdal_merge to ignore these transparent
> pixels during the merge.  Unfortunately, it appears that the -n
> nodata_value argument is evaluated band-by-band.  So, the following merged
> pixel (M) occurs for a merge of E and N:
 E: 100, 100, 100, 255
>         N: 0, 0, 3, 0
>         M: 100, 100, 3, 255
> 
>    To work around this, we figured out a gdal_calc command that will set RGB
> bands to 0 (nodata) in N if the pixel is transparent.  So that gives us
> this:
 
> E: 100, 100, 100, 255
>         N': 0, 0, 0, 0
>         M: 100, 100, 100, 255
> 
>    That’s fine, however, we still have the problem of opaque pixels in N
> merging incorrectly:
 
> E: 100, 100, 100, 255
>         N: 0, 0, 3, 255
>         M: 100, 100, 3, 255
> 
>    In this case, we either have to come up with a gnarly gdal_calc command…
> or accept the infrequent merge issues.
 
>    The exploratory question is “why does gdal_merge evaluate the nodata
> value band-by-band?”  This is also a limitation with gdal_translate,
> whereas gdalwarp allows for multiple band nodata values.  Answers to that
> will be interesting, but not necessarily fix our immediate issue, so how do
> we resolve this situation using existing gdal capabilities?

gdalwarp can generally be used as a replacement for gdal_merge. I'd try it :

gdalwarp new.tif existing.tif

Possibly with: -srcnodata "X Y Z" -wo UNIFIED_SRC_NODATA=YES

But this may not be necessary if your source is PNG as the NODATA_VALUES="X Y 
Z" metadata is probably already defined.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct 20 14:04:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 20 Oct 2016 23:04:07 +0200
Subject: [gdal-dev] New GMLAS (GML Application Schema) in trunk
In-Reply-To: <1476984839861-5291751.post@n6.nabble.com>
References: <201610081403.41443.even.rouault@spatialys.com>
 <1476984839861-5291751.post@n6.nabble.com>
Message-ID: <2004634.4bslHhUgXh@even-n550jk>

Hi Jukka,

> The XSD schema is massive but GDAL seems to resolve it and it finds huge
> amount of layers from the sample XML files, with geometries where they
> belong to. 

You can use -oo REMOVE_UNUSED_LAYERS=YES (and -oo REMOVE_UNUSED_FIELDS=YES) to 
get only the relevant layers for what is really in the .xml 

> Feels like an awesome work.

Thanks. A big remaining part planned for the next weeks is doing the reverse 
operation: given a database with a structure of layers and fields as the ones 
exposed by the read side, compose a valid XML file.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Thu Oct 20 22:33:32 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 20 Oct 2016 22:33:32 -0700
Subject: [gdal-dev] GDAL/OGR 2.1.2 RC2 Available for Review
In-Reply-To: <201610200144.20049.even.rouault@spatialys.com>
References: <201610200144.20049.even.rouault@spatialys.com>
Message-ID: <CACmBxyuzmr=5AR=GAfsC0dyF+BpHLvfR8ORi1SSLG5j-qrsRaA@mail.gmail.com>

Fixed OSM bug I introduced back in January...

https://trac.osgeo.org/gdal/changeset/35846

On Wed, Oct 19, 2016 at 4:44 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've generated a new RC because of a regression I just found (fixed per
> https://trac.osgeo.org/gdal/ticket/6691)
>
> Updated links:
>
>   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC2.tar.xz
>   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC2.tar.gz
>   http://download.osgeo.org/gdal/2.1.2/gdal212RC2.zip
>
>   http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC2.tar.gz
>   http://download.osgeo.org/gdal/2.1.2/gdalautotest-2.1.2RC2.zip
>
> The changes since 2.1.2RC1 are:
> * /vsimem/: fix potential crash when closing -different- handles pointing
> to the
> same file from different threads (fixes #6683)
> * Fix multi-threading issues in read/write scenarios (fixes #6684)
> * ILI1: fix crash in OGRILI1Layer::JoinSurfaceLayer() when the multicurve
> of
> the feature of the poSurfaceLineLayer layer is empty (fixes #6688)
> * GPKG/SQLite/PG/FileGDB/MEM: properly set/reset field subtype with
> AlterFieldDefn() (fixes #6689)
> * Fix regression in PLScenes V1 raster random access. Add a
> CPL_VSIL_CURL_ALLOWED_FILENAME config option to solve that (fixes #6691)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161020/0e28b6cd/attachment.html>

From even.rouault at spatialys.com  Fri Oct 21 02:16:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 21 Oct 2016 11:16:47 +0200
Subject: [gdal-dev] GDAL 2.1.2 RC3 available
Message-ID: <2169032.OzuB6TxD4U@even-n550jk>

Hi,

I've generated a new RC with the fix for the OSM regression fixed by Kurt 
(https://trac.osgeo.org/gdal/changeset/35846). This is the only change since 
RC2.

Updated links:
   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC3.tar.xz
   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC3.tar.gz
   http://download.osgeo.org/gdal/2.1.2/gdal212RC3.zip

Autotest suite unchanged since RC2.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthew.f.cechini at nasa.gov  Fri Oct 21 08:33:51 2016
From: matthew.f.cechini at nasa.gov (Cechini, Matthew F. (GSFC-423.0)[Science Systems & Applications, Inc.])
Date: Fri, 21 Oct 2016 15:33:51 +0000
Subject: [gdal-dev] gdal_merge nodata evaluation
In-Reply-To: <1847224.IarHmd4cU4@even-n550jk>
References: <D42EA0D2.84D8E%matthew.f.cechini@nasa.gov>
 <1847224.IarHmd4cU4@even-n550jk>
Message-ID: <D42FAD62.84E3E%matthew.f.cechini@nasa.gov>

Thanks Even.  It also looks like gdal_merge always uses nearest neighbor
interpolation, which is another reason we’ll have to use gdalwarp instead.

Matt
.................................................................
Matthew Cechini
Contractor, Science Systems and Applications, Inc.
NASA GIBS Systems/Software Engineer
410.205.6272




On 10/20/16, 4:56 PM, "Even Rouault" <even.rouault at spatialys.com> wrote:

>On Thursday 20 October 2016 20:27:14 Cechini, GSFC-423.0, Inc.] wrote:
>> All,
>>    We’ve recently begun usage of the gdal_merge utility in our
>>processing
>> workflow and have hit a snag.  I’m not sure if the snag is by design or
>>is
>> user error.  Here’s the scenario:
> 
>>    We have two 24_bit PNG images, and existing image (E) and a new
>>image (N)
>> we are merging into E.  They are the same size/projection/etc, so that’s
>> ignored here.  Some pixels within N are transparent with non-zero RGB
>>band
>> values.  The behavior we want is for gdal_merge to ignore these
>>transparent
>> pixels during the merge.  Unfortunately, it appears that the -n
>> nodata_value argument is evaluated band-by-band.  So, the following
>>merged
>> pixel (M) occurs for a merge of E and N:
> E: 100, 100, 100, 255
>>         N: 0, 0, 3, 0
>>         M: 100, 100, 3, 255
>> 
>>    To work around this, we figured out a gdal_calc command that will
>>set RGB
>> bands to 0 (nodata) in N if the pixel is transparent.  So that gives us
>> this:
> 
>> E: 100, 100, 100, 255
>>         N': 0, 0, 0, 0
>>         M: 100, 100, 100, 255
>> 
>>    That’s fine, however, we still have the problem of opaque pixels in N
>> merging incorrectly:
> 
>> E: 100, 100, 100, 255
>>         N: 0, 0, 3, 255
>>         M: 100, 100, 3, 255
>> 
>>    In this case, we either have to come up with a gnarly gdal_calc
>>command…
>> or accept the infrequent merge issues.
> 
>>    The exploratory question is “why does gdal_merge evaluate the nodata
>> value band-by-band?”  This is also a limitation with gdal_translate,
>> whereas gdalwarp allows for multiple band nodata values.  Answers to
>>that
>> will be interesting, but not necessarily fix our immediate issue, so
>>how do
>> we resolve this situation using existing gdal capabilities?
>
>gdalwarp can generally be used as a replacement for gdal_merge. I'd try
>it :
>
>gdalwarp new.tif existing.tif
>
>Possibly with: -srcnodata "X Y Z" -wo UNIFIED_SRC_NODATA=YES
>
>But this may not be necessary if your source is PNG as the
>NODATA_VALUES="X Y
>Z" metadata is probably already defined.
>
>Even
>
>
>-- 
>Spatialys - Geospatial professional services
>http://www.spatialys.com


From cavallini at faunalia.it  Sat Oct 22 09:30:27 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Sat, 22 Oct 2016 18:30:27 +0200
Subject: [gdal-dev] Error in gdalwarp
Message-ID: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>

Hi all,
I'm running gdalwarp on data from

https://github.com/qgis/QGIS-Training-Data/tree/master/training_manual_data/processing/iterative

as

gdalwarp -ot Float32 -q -of GTiff -cutline watersheds.shp -co
COMPRESS=DEFLATE -co PREDICTOR=1 -co ZLEVEL=6 -wo OPTIMIZE_SIZE=TRUE
dem25.tif OUTPUT.tif

and I get

GDAL command output:
Warning 1: Self-intersection at or near point 583.00000000000182 326
ERROR 1: Cutline is not valid after transformation

Previously the same command was running fine. I also checked geom
validity of the vector, and I coud not spot any error.

Is there an explanation?

GDAL 2.1.1+dfsg-5 on Debian sid.

All the best, and thanks.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From andre+joost at nurfuerspam.de  Sat Oct 22 10:18:49 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sat, 22 Oct 2016 19:18:49 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
Message-ID: <nug72t$4js$1@blaine.gmane.org>

Am 22.10.2016 um 18:30 schrieb Paolo Cavallini:
> gdalwarp -ot Float32 -q -of GTiff -cutline watersheds.shp -co
> COMPRESS=DEFLATE -co PREDICTOR=1 -co ZLEVEL=6 -wo OPTIMIZE_SIZE=TRUE
> dem25.tif OUTPUT.tif

Works for me with GDAL 1.11.3 and 2.0-dev, but fails on GDAL 2.1.0 and 
2.1.2. All Gisintenal builds on Windows 7 and 8.

HTH,
André Joost


From even.rouault at spatialys.com  Sat Oct 22 12:54:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 22 Oct 2016 21:54:08 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
Message-ID: <2827692.HDbp4l8A5b@even-n550jk>

On Saturday 22 October 2016 18:30:27 Paolo Cavallini wrote:
> Hi all,
> I'm running gdalwarp on data from
> 
> https://github.com/qgis/QGIS-Training-Data/tree/master/training_manual_data/
> processing/iterative
> 
> as
> 
> gdalwarp -ot Float32 -q -of GTiff -cutline watersheds.shp -co
> COMPRESS=DEFLATE -co PREDICTOR=1 -co ZLEVEL=6 -wo OPTIMIZE_SIZE=TRUE
> dem25.tif OUTPUT.tif
> 
> and I get
> 
> GDAL command output:
> Warning 1: Self-intersection at or near point 583.00000000000182 326
> ERROR 1: Cutline is not valid after transformation
> 
> Previously the same command was running fine. I also checked geom
> validity of the vector, and I coud not spot any error.
> 
> Is there an explanation?

Hi Paolo,

Since GDAL 2.1, validation of the cutline geometry once reprojected into 
source coordinates is done, and defaults into an error if the validation 
fails.

Here the issue is linked to the fact that when the cutline datasource is made 
of several polygons, a multipolygon is made with them by adding them as parts 
of the multipolygon. And if you do that on watersheds.shp, it results in a 
invalid multipolygon likely because the parts share common boundaries

You can revert to the previous behaviour and avoid the error to be fatal by 
adding
--config GDALWARP_IGNORE_BAD_CUTLINE YES
to the gdalwarp command line.

The clipping to the cutline might work or not depending on the nature of the 
invalidity (in your case that shouldn't be an issue). The check was added 
because there were use cases where unnoticed invalidities resulted in rather 
critical issues (for example when you need to clip out some regions because of 
regulations on forbidden zones, and an invalidity causes an area that should 
have been clipped out to not being clipped out).

Probably that in the use case you point, the way the multipolygon is built 
should be revised to use a proper unioning operation instead of the current 
rather naive way. Could be worth a ticket.

You can do that step manually with:

ogr2ogr cutline.shp -sql "select st_union(geometry) from watersheds" 
watersheds.shp -dialect sqlite


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Sat Oct 22 23:06:32 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Sun, 23 Oct 2016 08:06:32 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <2827692.HDbp4l8A5b@even-n550jk>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
 <2827692.HDbp4l8A5b@even-n550jk>
Message-ID: <e8762134-942d-f67c-0abb-57016b9d0a0c@faunalia.it>

Hi Even,

Il 22/10/2016 21:54, Even Rouault ha scritto:

> Since GDAL 2.1, validation of the cutline geometry once reprojected into 
> source coordinates is done, and defaults into an error if the validation 
> fails.
> 
> Here the issue is linked to the fact that when the cutline datasource is made 
> of several polygons, a multipolygon is made with them by adding them as parts 
> of the multipolygon. And if you do that on watersheds.shp, it results in a 
> invalid multipolygon likely because the parts share common boundaries

Thanks for the detailed explanation.

> You can revert to the previous behaviour and avoid the error to be fatal by 
> adding
> --config GDALWARP_IGNORE_BAD_CUTLINE YES
> to the gdalwarp command line.
> 
> The clipping to the cutline might work or not depending on the nature of the 
> invalidity (in your case that shouldn't be an issue). The check was added 
> because there were use cases where unnoticed invalidities resulted in rather 
> critical issues (for example when you need to clip out some regions because of 
> regulations on forbidden zones, and an invalidity causes an area that should 
> have been clipped out to not being clipped out).

Rather tricky. The same analysis seems to run fine, however, on the same
data with different software.
What would be your advice for gdalwarp usage in QGIS>Processing? Just
adding GDALWARP_IGNORE_BAD_CUTLINE YES by default, and perhaps an extra
option to disable it?

> Probably that in the use case you point, the way the multipolygon is built 
> should be revised to use a proper unioning operation instead of the current 
> rather naive way. Could be worth a ticket.
> 
> You can do that step manually with:
> 
> ogr2ogr cutline.shp -sql "select st_union(geometry) from watersheds" 
> watersheds.shp -dialect sqlite

Unfortunately this removes all internal borders, making it unusable for
the original purpose.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From christian.urich at gmail.com  Mon Oct 24 00:42:31 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Mon, 24 Oct 2016 18:42:31 +1100
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
Message-ID: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>

Hi all,

I have created a binary blob in a spatialite db. If I try to open the db the column is wrongly identified as geometry which causes all kinds of problems.

Is there a way to force gdal to only consider the geometry_columns table?


Cheers


Christian



From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 24 01:17:42 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 24 Oct 2016 01:17:42 -0700 (MST)
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
Message-ID: <1477297062414-5292228.post@n6.nabble.com>

Please put a test db somewhere or describe how to create such a database. I
made a quick test by importing some XML file with spatialite-gui 1.8.0-dev.
it creates a table as

CREATE TABLE "xml" (
"pk_uid" INTEGER PRIMARY KEY AUTOINCREMENT,
"xml_document" BLOB NOT NULL
,"file_name" TEXT NOT NULL
,"schema_uri" TEXT
,"parse_errors" TEXT
,"validate_errors" TEXT);

Test with ogrinfo of GDAL 2.2.0dev does not list table "xml".

ogrinfo blob.sqlite
INFO: Open of `blob.sqlite'
      using driver `SQLite' successful.
1: layer_1 (Point)

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292228.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Oct 24 03:51:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Oct 2016 12:51:50 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <e8762134-942d-f67c-0abb-57016b9d0a0c@faunalia.it>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
 <2827692.HDbp4l8A5b@even-n550jk>
 <e8762134-942d-f67c-0abb-57016b9d0a0c@faunalia.it>
Message-ID: <201610241251.50270.even.rouault@spatialys.com>

> Rather tricky. The same analysis seems to run fine, however, on the same
> data with different software.

On individual polygons yes. But if you just aggregate all the polygons as a 
multipolygon (what gdalwarp does), it becomes invalid.

> What would be your advice for gdalwarp usage in QGIS>Processing? Just
> adding GDALWARP_IGNORE_BAD_CUTLINE YES by default, and perhaps an extra
> option to disable it?

Possibly. I've just fixed the issue per https://trac.osgeo.org/gdal/ticket/6694 
and will issue a GDAL 2.1.2 RC4 with that extra fix.

> 
> > Probably that in the use case you point, the way the multipolygon is
> > built should be revised to use a proper unioning operation instead of
> > the current rather naive way. Could be worth a ticket.
> > 
> > You can do that step manually with:
> > 
> > ogr2ogr cutline.shp -sql "select st_union(geometry) from watersheds"
> > watersheds.shp -dialect sqlite
> 
> Unfortunately this removes all internal borders, making it unusable for
> the original purpose.

Hum, I'm not sure to understand. I don't see any difference when running 
gdalwarp with your cutline (with --config GDALWARP_IGNORE_BAD_CUTLINE YES or 
after my fix) or the cutline resulting of the union (anyway my fix doesn't 
involve union'ing). Or perhaps if you enable blending ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cavallini at faunalia.it  Mon Oct 24 03:58:43 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Mon, 24 Oct 2016 12:58:43 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <201610241251.50270.even.rouault@spatialys.com>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
 <2827692.HDbp4l8A5b@even-n550jk>
 <e8762134-942d-f67c-0abb-57016b9d0a0c@faunalia.it>
 <201610241251.50270.even.rouault@spatialys.com>
Message-ID: <6e9d9e90-212a-4265-5c13-cd2de6c3f485@faunalia.it>

Il 24/10/2016 12:51, Even Rouault ha scritto:

> Possibly. I've just fixed the issue per https://trac.osgeo.org/gdal/ticket/6694 
> and will issue a GDAL 2.1.2 RC4 with that extra fix.

thanks for that.

> Hum, I'm not sure to understand. I don't see any difference when running 
> gdalwarp with your cutline (with --config GDALWARP_IGNORE_BAD_CUTLINE YES or 
> after my fix) or the cutline resulting of the union (anyway my fix doesn't 
> involve union'ing). Or perhaps if you enable blending ?

the difference is when running the analisys as recursive, under Processing.
All the best, and thanks again.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From cavallini at faunalia.it  Mon Oct 24 04:03:53 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Mon, 24 Oct 2016 13:03:53 +0200
Subject: [gdal-dev] Error in gdalwarp
In-Reply-To: <6e9d9e90-212a-4265-5c13-cd2de6c3f485@faunalia.it>
References: <fea058ef-a85f-b157-e284-5a756e774c5d@faunalia.it>
 <2827692.HDbp4l8A5b@even-n550jk>
 <e8762134-942d-f67c-0abb-57016b9d0a0c@faunalia.it>
 <201610241251.50270.even.rouault@spatialys.com>
 <6e9d9e90-212a-4265-5c13-cd2de6c3f485@faunalia.it>
Message-ID: <f824cd4b-63bc-6f64-ddaa-59ca29fe017a@faunalia.it>

Il 24/10/2016 12:58, Paolo Cavallini ha scritto:
> Il 24/10/2016 12:51, Even Rouault ha scritto:
> 
>> Possibly. I've just fixed the issue per https://trac.osgeo.org/gdal/ticket/6694 
>> and will issue a GDAL 2.1.2 RC4 with that extra fix.

For the record, ticket open on Processing:
https://hub.qgis.org/issues/15746
Thanks again for the help.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From even.rouault at spatialys.com  Mon Oct 24 04:02:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Oct 2016 13:02:48 +0200
Subject: [gdal-dev] GDAL 2.1.2 RC4 available
Message-ID: <201610241302.48699.even.rouault@spatialys.com>

Hi,

I've generated a new RC (hopefully the last one) with the following fixes since 
RC3:
* gdalwarp: fix failure with cutline on a layer of touching polygons (#6694)
* RMF: fix load/store inversion of cm and dm units in MTW files 
(https://github.com/OSGeo/gdal/pull/162)

Updated links:
   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC4.tar.xz
   http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2RC4.tar.gz
   http://download.osgeo.org/gdal/2.1.2/gdal212RC4.zip

Autotest suite unchanged since RC2.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From christian.urich at gmail.com  Mon Oct 24 04:21:46 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Mon, 24 Oct 2016 22:21:46 +1100
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <1477297062414-5292228.post@n6.nabble.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
Message-ID: <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>

Here is a link to a small test database

https://www.dropbox.com/s/vwu4q7ud3e3sv2y/binary_blob.sqlite.zip?dl=0 <https://www.dropbox.com/s/vwu4q7ud3e3sv2y/binary_blob.sqlite.zip?dl=0>

The problem seems to come up when the BLOB is a bit bigger. I couldn’t reproduce it with a smaller dataset.  

For the db I get with ogrinfo GDAL 2.1.0

INFO: Open of `/home/christian/Desktop/binary_blob.sqlite'
      using driver `SQLite' successful.
1: timeseries





> On 24 Oct. 2016, at 7:17 pm, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> Please put a test db somewhere or describe how to create such a database. I
> made a quick test by importing some XML file with spatialite-gui 1.8.0-dev.
> it creates a table as
> 
> CREATE TABLE "xml" (
> "pk_uid" INTEGER PRIMARY KEY AUTOINCREMENT,
> "xml_document" BLOB NOT NULL
> ,"file_name" TEXT NOT NULL
> ,"schema_uri" TEXT
> ,"parse_errors" TEXT
> ,"validate_errors" TEXT);
> 
> Test with ogrinfo of GDAL 2.2.0dev does not list table "xml".
> 
> ogrinfo blob.sqlite
> INFO: Open of `blob.sqlite'
>      using driver `SQLite' successful.
> 1: layer_1 (Point)
> 
> -Jukka Rahkonen-
> 
> 
> 
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292228.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/758e03c8/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 24 04:42:13 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 24 Oct 2016 04:42:13 -0700 (MST)
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
 <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
Message-ID: <1477309333371-5292285.post@n6.nabble.com>

How did you create the database? It is a spatial db for Spatialite as well
because it contains also field GEOMETRY which is registered in
geometry_columns.

DLL of the "timeseries" table is
CREATE TABLE 'timeseries' ( ogc_fid INTEGER PRIMARY KEY, 'data' BLOB, 'end'
VARCHAR, 'start' VARCHAR, 'station_id' INTEGER, 'timestep' INTEGER, 'type'
VARCHAR, "GEOMETRY" GEOMETRY)

Ogrinfo -al -so finds these attributes:

FID Column = ogc_fid
Geometry Column 1 = data
Geometry Column 2 = GEOMETRY
end: String (0.0)
start: String (0.0)
station_id: Integer (0.0)
timestep: Integer (0.0)
type: String (0.0)

If I drop column "GEOMETRY" with spatialite-gui which also removes the line
from geometry_columns the table is not more a spatial table for GDAL

ogrinfo binary_blob.sqlite -al -so
INFO: Open of `binary_blob.sqlite'
      using driver `SQLite' successful.

Is your aim to have both the geometry and some blob fields? Is the problem
in here:
Geometry Column 1 = data
Geometry Column 2 = GEOMETRY

So, field "data" is somehow reported to be a geometry even it is not
registered in the geometry_columns. That does feel a bit odd.




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292285.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From christian.urich at gmail.com  Mon Oct 24 04:50:42 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Mon, 24 Oct 2016 13:50:42 +0200
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <1477309333371-5292285.post@n6.nabble.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
 <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
 <1477309333371-5292285.post@n6.nabble.com>
Message-ID: <CABPjL4mzaAcb+JEpAGc=aUo89Gy1CwTqObukrU+yaMiOBTNpQg@mail.gmail.com>

It is a spatialite database.

The data field is the SQLITE_BLOB that should not be recognised as
geometry.




On 24 October 2016 at 10:42:21 pm, jratike80 (
jukka.rahkonen at maanmittauslaitos.fi) wrote:

How did you create the database? It is a spatial db for Spatialite as well
because it contains also field GEOMETRY which is registered in
geometry_columns.

DLL of the "timeseries" table is
CREATE TABLE 'timeseries' ( ogc_fid INTEGER PRIMARY KEY, 'data' BLOB, 'end'
VARCHAR, 'start' VARCHAR, 'station_id' INTEGER, 'timestep' INTEGER, 'type'
VARCHAR, "GEOMETRY" GEOMETRY)

Ogrinfo -al -so finds these attributes:

FID Column = ogc_fid
Geometry Column 1 = data
Geometry Column 2 = GEOMETRY
end: String (0.0)
start: String (0.0)
station_id: Integer (0.0)
timestep: Integer (0.0)
type: String (0.0)

If I drop column "GEOMETRY" with spatialite-gui which also removes the line
from geometry_columns the table is not more a spatial table for GDAL

ogrinfo binary_blob.sqlite -al -so
INFO: Open of `binary_blob.sqlite'
using driver `SQLite' successful.

Is your aim to have both the geometry and some blob fields? Is the problem
in here:
Geometry Column 1 = data
Geometry Column 2 = GEOMETRY

So, field "data" is somehow reported to be a geometry even it is not
registered in the geometry_columns. That does feel a bit odd.




--
View this message in context:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292285.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/fae25bd8/attachment-0001.html>

From even.rouault at spatialys.com  Mon Oct 24 04:56:59 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Oct 2016 13:56:59 +0200
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
 <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
Message-ID: <201610241357.00283.even.rouault@spatialys.com>

Le lundi 24 octobre 2016 13:21:46, Christian Urich a écrit :
> Here is a link to a small test database
> 
> https://www.dropbox.com/s/vwu4q7ud3e3sv2y/binary_blob.sqlite.zip?dl=0
> <https://www.dropbox.com/s/vwu4q7ud3e3sv2y/binary_blob.sqlite.zip?dl=0>
> 
> The problem seems to come up when the BLOB is a bit bigger. I couldn’t
> reproduce it with a smaller dataset.

I've fixed the issue per https://trac.osgeo.org/gdal/ticket/6695

You can workaround it by having the non geometry BLOB columns listed after the 
geometry one(s) in the CREATE TABLE statement.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 24 05:00:25 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 24 Oct 2016 05:00:25 -0700 (MST)
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <CABPjL4mzaAcb+JEpAGc=aUo89Gy1CwTqObukrU+yaMiOBTNpQg@mail.gmail.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
 <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
 <1477309333371-5292285.post@n6.nabble.com>
 <CABPjL4mzaAcb+JEpAGc=aUo89Gy1CwTqObukrU+yaMiOBTNpQg@mail.gmail.com>
Message-ID: <1477310425111-5292293.post@n6.nabble.com>

Hi,

It does smell like a bug. Could you repeat my test and take care to have the
additional BLOB field created after the geometry field? For me this
workaround seems to work and there is only one geometry left and "data"
field is reported as "binary" type.

FID Column = ogc_fid
Geometry Column = geometry
end: String (0.0)
start: String (0.0)
station_id: Integer (0.0)
timestep: Integer (0.0)
type: String (0.0)
data: Binary (0.0)



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292293.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From christian.urich at gmail.com  Mon Oct 24 05:10:34 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Mon, 24 Oct 2016 14:10:34 +0200
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <1477310425111-5292293.post@n6.nabble.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477297062414-5292228.post@n6.nabble.com>
 <4C5A6EF8-13A1-4772-9CA3-89B85C3D6B69@gmail.com>
 <1477309333371-5292285.post@n6.nabble.com>
 <CABPjL4mzaAcb+JEpAGc=aUo89Gy1CwTqObukrU+yaMiOBTNpQg@mail.gmail.com>
 <1477310425111-5292293.post@n6.nabble.com>
Message-ID: <CABPjL4nqeYrPVvNOpmyMtHrBCZxpynkSrOcjnpK=KdJY+9r-+w@mail.gmail.com>

Hi,

will do.

I run into another problem. The update statement for multiple geometry
fails.

ERROR 1: In SetFeature(): sqlite3_prepare(UPDATE 'timeseries' SET "data" =
?"GEOMETRY" = ?,"end" = ?,"start" = ?,"station_id" = ?,"timestep" =
?,"type" = ?,"s" = ? WHERE "ogc_fid" = 1):
  near ""GEOMETRY"": syntax error

Looks like a comma is missing. Looking at the code my guess is
gdal/gdal/ogr/ogrsf_frmts/sqlite/ogrsqlitetablelayer.cpp line 2640 misses a

if( bNeedComma )
            osCommand += ",";


On 24 October 2016 at 11:00:34 pm, jratike80 (
jukka.rahkonen at maanmittauslaitos.fi) wrote:

Hi,

It does smell like a bug. Could you repeat my test and take care to have the
additional BLOB field created after the geometry field? For me this
workaround seems to work and there is only one geometry left and "data"
field is reported as "binary" type.

FID Column = ogc_fid
Geometry Column = geometry
end: String (0.0)
start: String (0.0)
station_id: Integer (0.0)
timestep: Integer (0.0)
type: String (0.0)
data: Binary (0.0)



--
View this message in context:
http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrongly-identified-SQLITE-BLOB-as-geomtry-tp5292220p5292293.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/7f4874b1/attachment.html>

From even.rouault at spatialys.com  Mon Oct 24 05:31:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Oct 2016 14:31:58 +0200
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <CABPjL4nqeYrPVvNOpmyMtHrBCZxpynkSrOcjnpK=KdJY+9r-+w@mail.gmail.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477310425111-5292293.post@n6.nabble.com>
 <CABPjL4nqeYrPVvNOpmyMtHrBCZxpynkSrOcjnpK=KdJY+9r-+w@mail.gmail.com>
Message-ID: <201610241431.58549.even.rouault@spatialys.com>

Le lundi 24 octobre 2016 14:10:34, Christian Urich a écrit :
> Hi,
> 
> will do.
> 
> I run into another problem. The update statement for multiple geometry
> fails.
> 
> ERROR 1: In SetFeature(): sqlite3_prepare(UPDATE 'timeseries' SET "data" =
> ?"GEOMETRY" = ?,"end" = ?,"start" = ?,"station_id" = ?,"timestep" =
> ?,"type" = ?,"s" = ? WHERE "ogc_fid" = 1):
>   near ""GEOMETRY"": syntax error
> 
> Looks like a comma is missing. Looking at the code my guess is
> gdal/gdal/ogr/ogrsf_frmts/sqlite/ogrsqlitetablelayer.cpp line 2640 misses a
> 
> if( bNeedComma )
>             osCommand += ",";
> 

Good catch! Thanks. Fixed per https://trac.osgeo.org/gdal/ticket/6696

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hellik at web.de  Mon Oct 24 09:06:48 2016
From: hellik at web.de (Helmut Kudrnovsky)
Date: Mon, 24 Oct 2016 09:06:48 -0700 (MST)
Subject: [gdal-dev] gdal_translate to Rasterlite and (missing) srs
Message-ID: <1477325208868-5292361.post@n6.nabble.com>

hi,

a question regarding gdal_translate to Rasterlite and srs (based upon [1]):

a geotif with srs information:

gdalinfo geotiff_out.tif
Driver: GTiff/GeoTIFF
Files: geotiff_out.tif
Size is 7201, 7001
Coordinate System is:
PROJCS["MGI / Austria GK Central",
    GEOGCS["bessel",
        DATUM["Militar_Geographische_Institute",
            SPHEROID["Bessel_1841",6377397.155,299.1528128],
            TOWGS84[577.326,90.129,463.919,5.1366,1.4742,5.297,2.4232]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",13.33333333333333],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",-5000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
[...]

then a simple gdal_translate:

gdal_translate -of Rasterlite geotiff_out.tif gdtrans_to_rasterlite.db

and gdalinfo of the Rasterlite db:

gdalinfo gdtrans_to_rasterlite.db
Driver: Rasterlite/Rasterlite
Files: gdtrans_to_rasterlite.db
Size is 7201, 7001
Coordinate System is `'
[...]

by gdal_translate with -a_srs

gdal_translate -a_srs EPSG:31255 [...]

gdalinfo gdtrans_to_rasterlite_srs.db
Driver: Rasterlite/Rasterlite
Files: gdtrans_to_rasterlite_srs.db
Size is 7201, 7001
Coordinate System is:
PROJCS["MGI / Austria GK Central",
[...]

the srs information is available within the Rasterlite db.

is this intentional that there is no srs by a simple gdal_translate of a
geotiff to a Rasterlite db?
maybe there is some other command line option related to Rasterlite db which
I'm missing?




[1] https://trac.osgeo.org/grass/ticket/3191#comment:3



-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-to-Rasterlite-and-missing-srs-tp5292361.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Oct 24 09:22:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 24 Oct 2016 18:22:47 +0200
Subject: [gdal-dev] gdal_translate to Rasterlite and (missing) srs
In-Reply-To: <1477325208868-5292361.post@n6.nabble.com>
References: <1477325208868-5292361.post@n6.nabble.com>
Message-ID: <201610241822.47457.even.rouault@spatialys.com>

Helmut,

> is this intentional that there is no srs by a simple gdal_translate of a
> geotiff to a Rasterlite db?

From what I can see the driver doesn't handle adding a new entry in the 
spatial_ref_sys table if there's no AUTHORITY node, such as in your use case. 
From what I can see, it also probably doesn't properly support creating 
entries in spatial_ref_sys with Spatialite 4 layout (the driver has been 
likely developped during Spatialite 3 era)
It is "intentional" in the meaning that this wasn't implemented, but could 
potentially be added. Could be worth a ticket in Trac.

> maybe there is some other command line option related to Rasterlite db
> which I'm missing?

No, the workaround is the one you found. Make sure a EPSG code is attached to 
the input dataset, or assign it explictly

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew.bell.ia at gmail.com  Mon Oct 24 09:53:23 2016
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 24 Oct 2016 11:53:23 -0500
Subject: [gdal-dev] Fwd: [pdal] Riegl extrabytes stripped
In-Reply-To: <CACJ51z3=Qb-5wrY0mGDtqSOTUb7UmNBdnbfHTq8K3Kjy0zcBiA@mail.gmail.com>
References: <3FB09E30D726C54A99B50CCB731EE1715E13A2DAC2@ATEX008.at.local>
 <CACJ51z3=Qb-5wrY0mGDtqSOTUb7UmNBdnbfHTq8K3Kjy0zcBiA@mail.gmail.com>
Message-ID: <CACJ51z2-jYz0J9U-JdcF_DNpHr911JSgTg8AdLMLOQP4RjuhGg@mail.gmail.com>

On Mon, Oct 24, 2016 at 10:52 AM, Benjamin Kabelik <b.kabelik@
airbornetechnologies.at> wrote:

> Dear mailing list members,
>
>
>
> I read the thread about the extra bytes and wrote a pdal translate command
> for a ntv2 projection from UTM33n ETRS89 to Austria MGI M34:
>
>
>
> For %i in (*.las) do (docker run -v c:/temp/trafo_wien2/:/data
> pdal/pdal:1.3 pdal translate reprojection --filters.reprojection.in_srs="EPSG:25833"
> --filters.reprojection.out_srs="+proj=tmerc +lat_0=0
> +lon_0=16.33333333333333 +k=1 +x_0=0 +y_0=-5000000 +ellps=bessel
> +towgs84=577.326,90.129,463.919,5.137,1.474,5.297,2.4232 +units=m
> +no_defs +nadgrids=/data/AT_GIS_GRID.gsb" --writers.las.forward=vlr
> --writers.las.extra_dims="Amplitude=float,Pulse width=float"
> --writers.las.minor_version=4 --writers.las.dataformat_id=6
> --writers.las.offset_x=auto --writers.las.offset_y=auto
> --writers.las.offset_z=auto -i /data/%i -o /data/%i_gk_gisgrid.las)
>
>
>
>
>
> There are two things that came up:
>
> 1.       I had to switch the data type of amplitude and pulse width from
> uint16 to float because with uint16 I get integer values instead of float.
>
> 2.       Is there any option to forward the description and scale of the
> extra bytes?
>

I'm sorry, but there is currently no way to set the scale/offset or
description in an extra-bytes VLR/field.  I'd be happy to help with a
contribution that you may wish to make to remedy the situation.

Best,

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/586aff87/attachment-0001.html>

From hellik at web.de  Mon Oct 24 10:25:45 2016
From: hellik at web.de (Helmut Kudrnovsky)
Date: Mon, 24 Oct 2016 10:25:45 -0700 (MST)
Subject: [gdal-dev] gdal_translate to Rasterlite and (missing) srs
In-Reply-To: <201610241822.47457.even.rouault@spatialys.com>
References: <1477325208868-5292361.post@n6.nabble.com>
 <201610241822.47457.even.rouault@spatialys.com>
Message-ID: <1477329945084-5292390.post@n6.nabble.com>

hi Even,


Even Rouault-2 wrote
> Helmut,
> 
>> is this intentional that there is no srs by a simple gdal_translate of a
>> geotiff to a Rasterlite db?
> 
> From what I can see the driver doesn't handle adding a new entry in the 
> spatial_ref_sys table if there's no AUTHORITY node, such as in your use
> case. 
> From what I can see, it also probably doesn't properly support creating 
> entries in spatial_ref_sys with Spatialite 4 layout (the driver has been 
> likely developped during Spatialite 3 era)
> It is "intentional" in the meaning that this wasn't implemented, but could 
> potentially be added. Could be worth a ticket in Trac.

thanks for the explanations. ticket opened in trac #6697.



-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-to-Rasterlite-and-missing-srs-tp5292361p5292390.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From rex200789 at gmail.com  Mon Oct 24 14:08:25 2016
From: rex200789 at gmail.com (Rex Christian)
Date: Mon, 24 Oct 2016 17:08:25 -0400
Subject: [gdal-dev] Need some information please
Message-ID: <CA+RGT8w_ja4UyVKU3ePJd_Vrbcr_Asocp9BG4vftb6-VbLdjng@mail.gmail.com>

Hello all, I have tried to pass the parameter o: in the symbol toll
parameter for constructing style string. The problem is that I always get a
border/outline on my fill circle. Any ideas on how to mitigate this?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/7af4566f/attachment.html>

From christian.urich at gmail.com  Mon Oct 24 16:49:54 2016
From: christian.urich at gmail.com (Christian Urich)
Date: Mon, 24 Oct 2016 19:49:54 -0400
Subject: [gdal-dev] Wrongly identified SQLITE_BLOB as geomtry
In-Reply-To: <201610241431.58549.even.rouault@spatialys.com>
References: <8279A2F6-D6A6-44E3-BA29-16885AEC795B@gmail.com>
 <1477310425111-5292293.post@n6.nabble.com>
 <CABPjL4nqeYrPVvNOpmyMtHrBCZxpynkSrOcjnpK=KdJY+9r-+w@mail.gmail.com>
 <201610241431.58549.even.rouault@spatialys.com>
Message-ID: <CABPjL4n7TdAxwBejWzovXK16Li5QPfNT--oo7_TBSo+g8dP3dQ@mail.gmail.com>

Hi Even and Jukka,

Thanks for the quick fixes!

Just tested the code from the master and it works for my use case.

Cheers

Christian




On 24 October 2016 at 11:33:17 pm, Even Rouault (even.rouault at spatialys.com)
wrote:

Le lundi 24 octobre 2016 14:10:34, Christian Urich a écrit :
> Hi,
>
> will do.
>
> I run into another problem. The update statement for multiple geometry
> fails.
>
> ERROR 1: In SetFeature(): sqlite3_prepare(UPDATE 'timeseries' SET "data"
=
> ?"GEOMETRY" = ?,"end" = ?,"start" = ?,"station_id" = ?,"timestep" =
> ?,"type" = ?,"s" = ? WHERE "ogc_fid" = 1):
> near ""GEOMETRY"": syntax error
>
> Looks like a comma is missing. Looking at the code my guess is
> gdal/gdal/ogr/ogrsf_frmts/sqlite/ogrsqlitetablelayer.cpp line 2640 misses
a
>
> if( bNeedComma )
> osCommand += ",";
>

Good catch! Thanks. Fixed per https://trac.osgeo.org/gdal/ticket/6696

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161024/b903989f/attachment.html>

From even.rouault at spatialys.com  Tue Oct 25 01:39:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Oct 2016 10:39:46 +0200
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
Message-ID: <201610251039.46747.even.rouault@spatialys.com>

Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final release.

---

+1 Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Oct 25 03:16:35 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 25 Oct 2016 03:16:35 -0700 (MST)
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
In-Reply-To: <201610251039.46747.even.rouault@spatialys.com>
References: <201610251039.46747.even.rouault@spatialys.com>
Message-ID: <1477390595478-5292539.post@n6.nabble.com>

Even Rouault-2 wrote
> Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final
> release.
> 
> ---
> 
> +1 Even

+1

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-Promote-2-1-2RC4-for-release-tp5292496p5292539.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jmckenna at gatewaygeomatics.com  Tue Oct 25 05:01:50 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 25 Oct 2016 09:01:50 -0300
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
In-Reply-To: <201610251039.46747.even.rouault@spatialys.com>
References: <201610251039.46747.even.rouault@spatialys.com>
Message-ID: <d96e24d7-e43e-90b7-9c2b-a7272baf644a@gatewaygeomatics.com>

On 2016-10-25 5:39 AM, Even Rouault wrote:
> Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final release.
>

+1 jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From howard at hobu.co  Tue Oct 25 06:37:29 2016
From: howard at hobu.co (Howard Butler)
Date: Tue, 25 Oct 2016 08:37:29 -0500
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
In-Reply-To: <d96e24d7-e43e-90b7-9c2b-a7272baf644a@gatewaygeomatics.com>
References: <201610251039.46747.even.rouault@spatialys.com>
 <d96e24d7-e43e-90b7-9c2b-a7272baf644a@gatewaygeomatics.com>
Message-ID: <3F06C64D-B869-4A0A-BD9E-55A5828B209C@hobu.co>


> On Oct 25, 2016, at 7:01 AM, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:
> 
> On 2016-10-25 5:39 AM, Even Rouault wrote:
>> Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final release.
>> 
> 
> +1 jeff

+1 Howard



From rex200789 at gmail.com  Tue Oct 25 06:40:52 2016
From: rex200789 at gmail.com (Renison)
Date: Tue, 25 Oct 2016 06:40:52 -0700 (MST)
Subject: [gdal-dev] Need some information please
In-Reply-To: <CA+RGT8w_ja4UyVKU3ePJd_Vrbcr_Asocp9BG4vftb6-VbLdjng@mail.gmail.com>
References: <CA+RGT8w_ja4UyVKU3ePJd_Vrbcr_Asocp9BG4vftb6-VbLdjng@mail.gmail.com>
Message-ID: <1477402852686-5292580.post@n6.nabble.com>

I am using GDAL 64 bit with map server compiled with MSCV 1600. I am trying
to generate a tab file and when I pass a style string like this string style
= @"SYMBOL(c:#00FF00,o:#00FF00,id:""mapinfo-sym-64,ogr-sym-7"")"; it always
seems to ignore the "o". My goal is to get rid of the border around the
symbol by passing the outline as the same color.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Need-some-information-please-tp5292430p5292580.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Oct 25 08:06:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 25 Oct 2016 17:06:50 +0200
Subject: [gdal-dev] Need some information please
In-Reply-To: <1477402852686-5292580.post@n6.nabble.com>
References: <CA+RGT8w_ja4UyVKU3ePJd_Vrbcr_Asocp9BG4vftb6-VbLdjng@mail.gmail.com>
 <1477402852686-5292580.post@n6.nabble.com>
Message-ID: <201610251706.51000.even.rouault@spatialys.com>

Le mardi 25 octobre 2016 15:40:52, Renison a écrit :
> I am using GDAL 64 bit with map server compiled with MSCV 1600. I am trying
> to generate a tab file and when I pass a style string like this string
> style = @"SYMBOL(c:#00FF00,o:#00FF00,id:""mapinfo-sym-64,ogr-sym-7"")"; it
> always seems to ignore the "o". My goal is to get rid of the border around
> the symbol by passing the outline as the same color.

My understanding of the code is that the outline color is ignored when writing 
MapInfo style. I haven't dug up to know if it is just code that is missing or 
if there's indeed no way to set that in .tab format (support on the read side 
is also missing)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From rex200789 at gmail.com  Tue Oct 25 08:18:11 2016
From: rex200789 at gmail.com (Renison)
Date: Tue, 25 Oct 2016 08:18:11 -0700 (MST)
Subject: [gdal-dev] Need some information please
In-Reply-To: <201610251706.51000.even.rouault@spatialys.com>
References: <CA+RGT8w_ja4UyVKU3ePJd_Vrbcr_Asocp9BG4vftb6-VbLdjng@mail.gmail.com>
 <1477402852686-5292580.post@n6.nabble.com>
 <201610251706.51000.even.rouault@spatialys.com>
Message-ID: <1477408691693-5292592.post@n6.nabble.com>

Thanks for the reply Even, is there any other way I can get rid of the
outline/border of the symbol without modifying the underlying c++ and c
code?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Need-some-information-please-tp5292430p5292592.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From patrick.mckendree.young at gmail.com  Tue Oct 25 11:49:04 2016
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Tue, 25 Oct 2016 12:49:04 -0600
Subject: [gdal-dev] GDAL Python Bindings via manylinux wheels
Message-ID: <CADXYQQ69V6eyKicwnVcnEEVzU1ArdkSrtWijJtjfwEg+Pbqpuw@mail.gmail.com>

Hi all,

I've been working on an experiment to see if I can get the Python GDAL
bindings packaged up as a "manylinux" wheel (see
https://www.python.org/dev/peps/pep-0513/ and
https://github.com/pypa/manylinux for more info) to see if I can run the
GDAL utilities that are now exposed via the bindings as an AWS' Lambda
service (you need everything packed up into a zip to get it to run in
lambda).

Basically, such a wheel contains a vendorized version of GDAL and its
dependencies plus the bindings all packed up in a nice package for quick
and easy install without compilation and should work on most versions of
linux.

I've got a prototype that builds these wheels working (see
https://github.com/youngpm/gdalmanylinux  thanks to the rasterio project
for doing most of the work for their project!).  The nice thing is that
such wheels are virtualenv friendly and don't require the user having
installed gdal themselves, its all self contained in site-packages.

In any case, I thought other GDAL'rs might be interested, maybe this could
lead to official manylinux gdal wheels pushed to pypi at
https://pypi.python.org/pypi/GDAL/ ?  I believe the same trick can be done
for osx and windows, but haven't tried myself.

Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161025/d7db5448/attachment-0001.html>

From dmorissette at mapgears.com  Tue Oct 25 13:20:56 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 25 Oct 2016 16:20:56 -0400
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
In-Reply-To: <201610251039.46747.even.rouault@spatialys.com>
References: <201610251039.46747.even.rouault@spatialys.com>
Message-ID: <484e08c1-9b0f-952d-abc4-83155615f5b0@mapgears.com>

On 2016-10-25 4:39 AM, Even Rouault wrote:
> Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final release.
>

+1

Daniel

-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From naoliv at gmail.com  Wed Oct 26 03:47:28 2016
From: naoliv at gmail.com (Nelson A. de Oliveira)
Date: Wed, 26 Oct 2016 08:47:28 -0200
Subject: [gdal-dev] "dialect SQLITE" isn't working as expected in ogr2ogr
Message-ID: <CAARFvTW4JEdTStCjvYma7UT8W_rLHj3Lkmx-JjSa-v5yMk8+pw@mail.gmail.com>

Hi!

I can't get a proper output when using "-dialect SQLITE" with ogr2ogr

For example, this properly works:

=====
ogr2ogr -update -append -f "ESRI Shapefile" -sql "SELECT NM_TIPO_LO,
NM_TITULO_, NM_NOME_LO FROM \"35032080500_face\"" -t_srs EPSG:4326
merged.shp 35032080500_face.shp
=====

I can see 4 files, as expected:
merged.dbf, merged.prj, merged.shp and merged.shx


Adding "-dialect SQLITE" (remove the merged* files before running):

=====
ogr2ogr -update -append -f "ESRI Shapefile" -dialect SQLITE -sql "SELECT
NM_TIPO_LO, NM_TITULO_, NM_NOME_LO FROM \"35032080500_face\"" -t_srs
EPSG:4326 merged.shp 35032080500_face.shp
=====

This is only a simpfilied example, as I would like to use some SQLITE
functions that aren't available in OGR SQL, for example.

The problem is: ogr2ogr doesn't give any warning or error message, but
I can see only two files being created: merged.dbf and merged.prj

There isn't any shapefile there.

ogr2ogr's manpage says:
=====
       -dialect dialect:
           SQL dialect. In some cases can be used to use (unoptimized) OGR SQL
           instead of the native SQL of an RDBMS by passing OGRSQL. Starting
           with GDAL 1.10, the 'SQLITE' dialect can also be used with any
           datasource.
=====

http://www.gdal.org/ogr_sql_sqlite.html also says:
=====
Since GDAL/OGR 1.10, the SQLite "dialect" can be used as an alternate
SQL dialect to the OGR SQL dialect. This assumes that GDAL/OGR is built
with support for SQLite (>= 3.6), and preferably with Spatialite support
too to benefit from spatial functions.

The SQLite dialect may be used with any OGR datasource, like the OGR SQL
dialect. It is available through the GDALDataset::ExecuteSQL() method by
specifying the pszDialect to "SQLITE". For the ogrinfo or ogr2ogr
utility, you must specify the "-dialect SQLITE" option.

This is mainly aimed to execute SELECT statements (…)
=====

>From what I understand, I can use "-dialect SQLITE" with any datasource
(including shapefiles, I expect)

Is ogr2ogr somehow not doing what it should do, is the documentation
incomplete (ie, we can use the dialect only with some specific cases) or
there is something else wrong, please?

ogr2ogr is version 2.1.1

Thank you!

Best regards,
Nelson

From even.rouault at spatialys.com  Wed Oct 26 03:51:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 26 Oct 2016 12:51:56 +0200
Subject: [gdal-dev] "dialect SQLITE" isn't working as expected in ogr2ogr
In-Reply-To: <CAARFvTW4JEdTStCjvYma7UT8W_rLHj3Lkmx-JjSa-v5yMk8+pw@mail.gmail.com>
References: <CAARFvTW4JEdTStCjvYma7UT8W_rLHj3Lkmx-JjSa-v5yMk8+pw@mail.gmail.com>
Message-ID: <201610261251.57107.even.rouault@spatialys.com>

Le mercredi 26 octobre 2016 12:47:28, Nelson A. de Oliveira a écrit :
> Hi!
> 
> I can't get a proper output when using "-dialect SQLITE" with ogr2ogr
> 
> For example, this properly works:
> 
> =====
> ogr2ogr -update -append -f "ESRI Shapefile" -sql "SELECT NM_TIPO_LO,
> NM_TITULO_, NM_NOME_LO FROM \"35032080500_face\"" -t_srs EPSG:4326
> merged.shp 35032080500_face.shp
> =====
> 
> I can see 4 files, as expected:
> merged.dbf, merged.prj, merged.shp and merged.shx
> 
> 
> Adding "-dialect SQLITE" (remove the merged* files before running):
> 
> =====
> ogr2ogr -update -append -f "ESRI Shapefile" -dialect SQLITE -sql "SELECT
> NM_TIPO_LO, NM_TITULO_, NM_NOME_LO FROM \"35032080500_face\"" -t_srs
> EPSG:4326 merged.shp 35032080500_face.shp
> =====
> 
> This is only a simpfilied example, as I would like to use some SQLITE
> functions that aren't available in OGR SQL, for example.
> 
> The problem is: ogr2ogr doesn't give any warning or error message, but
> I can see only two files being created: merged.dbf and merged.prj

Yes, you didn't explicitly select the geometry field, hence a geometry-less DBF 
is produced. This is indeed a difference in behaviour between OGR SQL (where 
geometry selection is implicit) and the SQLite dialect (where it must be 
explicit, conforming to other spatial enabled SQL databases).

See the "Geometry field" section in http://www.gdal.org/ogr_sql_sqlite.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From naoliv at gmail.com  Wed Oct 26 05:34:15 2016
From: naoliv at gmail.com (Nelson A. de Oliveira)
Date: Wed, 26 Oct 2016 10:34:15 -0200
Subject: [gdal-dev] "dialect SQLITE" isn't working as expected in ogr2ogr
In-Reply-To: <201610261251.57107.even.rouault@spatialys.com>
References: <CAARFvTW4JEdTStCjvYma7UT8W_rLHj3Lkmx-JjSa-v5yMk8+pw@mail.gmail.com>
 <201610261251.57107.even.rouault@spatialys.com>
Message-ID: <CAARFvTXwkVt3bLaJ0gsnQ0B413MKPJCMbMgLQw3zOhqPFcND4g@mail.gmail.com>

On Wed, Oct 26, 2016 at 8:51 AM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Yes, you didn't explicitly select the geometry field, hence a geometry-less DBF
> is produced. This is indeed a difference in behaviour between OGR SQL (where
> geometry selection is implicit) and the SQLite dialect (where it must be
> explicit, conforming to other spatial enabled SQL databases).
>
> See the "Geometry field" section in http://www.gdal.org/ogr_sql_sqlite.html

Good.
Thanks!

From hugomau at gmail.com  Wed Oct 26 08:30:24 2016
From: hugomau at gmail.com (=?UTF-8?Q?Hugo_Maur=C3=ADcio?=)
Date: Wed, 26 Oct 2016 15:30:24 +0000
Subject: [gdal-dev] Gdal.Dataset C# class is not complete
Message-ID: <CAPVQy3aG0S4ty1G-QX83mamYDPWQ_01pA-28WTW-uNfE6jEzqw@mail.gmail.com>

Most of the deprecated Ogr.DataSource methods that where moved to
Gdal.Datasource are not present in the Gdal.Dataset class.

Methods like GetLayerByName() or GetLayerCount().

Why is this? Are they in another place?

Thank you.

Hugo Maurício
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161026/c5edbe5f/attachment.html>

From jidnyasa.nilange at advancedriskanalytics.com  Wed Oct 26 23:51:28 2016
From: jidnyasa.nilange at advancedriskanalytics.com (Jidnyasa Nilange)
Date: Thu, 27 Oct 2016 12:21:28 +0530
Subject: [gdal-dev] Configuration for UINT16 data
Message-ID: <001501d2301e$8f58cf80$ae0a6e80$@advancedriskanalytics.com>

Hi,

 

I am trying to read band pixels using RasterIO method. However It seems that
when my data is in UINT16 format void pointer is returning 0.00 values for
all pixels. How do I make sure that irrespective of datatype pixels are read
by gdal?

 

Thanks & regards,

Jidnyasa 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/8465ed4c/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 27 01:26:37 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 27 Oct 2016 08:26:37 +0000
Subject: [gdal-dev] RFC 64 wiki page is empty
Message-ID: <cd7b415145c6425fb6f0826468aa3458@C119S212VM022.msvyvi.vaha.local>

Hi,

There is no contents in https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin but it would be nice to have something. I suppose that RFC was defined and implemented in
https://github.com/avyavkumar/gdal/wiki

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/cf30782f/attachment.html>

From even.rouault at spatialys.com  Thu Oct 27 02:23:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2016 11:23:23 +0200
Subject: [gdal-dev] RFC 64 wiki page is empty
In-Reply-To: <cd7b415145c6425fb6f0826468aa3458@C119S212VM022.msvyvi.vaha.local>
References: <cd7b415145c6425fb6f0826468aa3458@C119S212VM022.msvyvi.vaha.local>
Message-ID: <201610271123.23159.even.rouault@spatialys.com>

Le jeudi 27 octobre 2016 10:26:37, Rahkonen Jukka (MML) a écrit :
> Hi,
> 
> There is no contents in
> https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin but
> it would be nice to have something. I suppose that RFC was defined and
> implemented in https://github.com/avyavkumar/gdal/wiki

Hi,

I don't know if/when Avyav will have time to pursue on that.

During FOSS4G code sprint, I forked Avyav branch and put several fixes and 
follows up ( https://github.com/rouault/gdal2/tree/gsoc-triangle-ps-tin ), but 
there are a few things left before it is appropriate for merging, like 
deciding the behaviour when converting from a driver that support those 
geometry types to a driver that doesn't support them. I don't have time right 
now to go on with that.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct 27 02:27:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2016 11:27:14 +0200
Subject: [gdal-dev] Motion: Promote 2.1.2RC4 for release
In-Reply-To: <201610251039.46747.even.rouault@spatialys.com>
References: <201610251039.46747.even.rouault@spatialys.com>
Message-ID: <201610271127.14075.even.rouault@spatialys.com>

Le mardi 25 octobre 2016 10:39:46, Even Rouault a écrit :
> Motion: GDAL/OGR 2.1.2RC4 is promoted to be the official 2.1.2 final
> release.
> 
> ---
> 
> +1 Even

I declare this motion passed with +1 from PSC members JukkaR, HowardB, 
DanielM, KurtS and myself, as well as support from JeffM.

I'll proceed to the renaming shortly and the official announcement.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct 27 02:44:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2016 11:44:28 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.2 released
Message-ID: <201610271144.29004.even.rouault@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to
announce the release of the GDAL/OGR 2.1.2 bug fix version. 
It contains ~65 bug fixes (including a few enhancements regarding GeoPackage 
support) since 2.1.1.

The sources are available at:

  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2.tar.xz
  http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2.tar.gz
  http://download.osgeo.org/gdal/2.1.2/gdal212.zip

Details on the changes are available at:
  http://trac.osgeo.org/gdal/wiki/Release/2.1.2-News

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jef at norbit.de  Thu Oct 27 04:43:41 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Thu, 27 Oct 2016 13:43:41 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.2 released
In-Reply-To: <201610271144.29004.even.rouault@spatialys.com>
References: <201610271144.29004.even.rouault@spatialys.com>
Message-ID: <20161027114341.GA20630@norbit.de>

Hi Even,

On Thu, 27. Oct 2016 at 11:44:28 +0200, Even Rouault wrote:
> On behalf of the GDAL/OGR development team, I am pleased to
> announce the release of the GDAL/OGR 2.1.2 bug fix version. 
> It contains ~65 bug fixes (including a few enhancements regarding GeoPackage 
> support) since 2.1.1.

Thanks.

Just introduced it into OSGeo4W.   Including three patches, which I thought I
had already applied.  Did it now.


Jürgen

-- 
Jürgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-31
Dipl.-Inf. (FH)           Rheinstraße 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/1594dade/attachment.sig>

From traviskirstine at gmail.com  Thu Oct 27 06:02:11 2016
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Thu, 27 Oct 2016 09:02:11 -0400
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
Message-ID: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>

I've been looking at resampling high resolution orthophoto images (0.10m)
using gdalwarp vs gdal_translate to a lower resolution

gdalwarp  -co TILED=YES -srcnodata "0 0 0" -dstnodata "0 0 0" -tr 2 2   -r
bilinear in.tif warp_2m_bilinear.tif

compared to

gdal_translate -co TILED=YES -a_nodata 0 -tr 2 2  -r bilinear input.tif
translate_2m_bilinear


It appears to me that gdal_translate produces a much "better" result with
reduced aliasing.  Why would the results differ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/df68a68f/attachment.html>

From even.rouault at spatialys.com  Thu Oct 27 06:48:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 27 Oct 2016 15:48:15 +0200
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
Message-ID: <201610271548.15375.even.rouault@spatialys.com>

Le jeudi 27 octobre 2016 15:02:11, Travis Kirstine a écrit :
> I've been looking at resampling high resolution orthophoto images (0.10m)
> using gdalwarp vs gdal_translate to a lower resolution
> 
> gdalwarp  -co TILED=YES -srcnodata "0 0 0" -dstnodata "0 0 0" -tr 2 2   -r
> bilinear in.tif warp_2m_bilinear.tif
> 
> compared to
> 
> gdal_translate -co TILED=YES -a_nodata 0 -tr 2 2  -r bilinear input.tif
> translate_2m_bilinear
> 
> 
> It appears to me that gdal_translate produces a much "better" result with
> reduced aliasing.  Why would the results differ?

Does gdalinfo on the output of both files report the same spatial extent ? 
gdalwarp and gdal_translate have different logic to compute it when not 
explicitly mentionned.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From traviskirstine at gmail.com  Thu Oct 27 07:17:33 2016
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Thu, 27 Oct 2016 10:17:33 -0400
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <201610271548.15375.even.rouault@spatialys.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
 <201610271548.15375.even.rouault@spatialys.com>
Message-ID: <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>

Even,

Thanks for your response.  I rechecked by results and it appears that the
difference may be related to the GDAL version.  I had originally been
testing using gdal 1.7.3 for the gdalwarp command and gdal 2.1.1 (osgeo4w)
for the gdal_translate command.  If I run both command using gdal 2.1.1 the
result appear the same.

Thanks

On 27 October 2016 at 09:48, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le jeudi 27 octobre 2016 15:02:11, Travis Kirstine a écrit :
> > I've been looking at resampling high resolution orthophoto images (0.10m)
> > using gdalwarp vs gdal_translate to a lower resolution
> >
> > gdalwarp  -co TILED=YES -srcnodata "0 0 0" -dstnodata "0 0 0" -tr 2 2
>  -r
> > bilinear in.tif warp_2m_bilinear.tif
> >
> > compared to
> >
> > gdal_translate -co TILED=YES -a_nodata 0 -tr 2 2  -r bilinear input.tif
> > translate_2m_bilinear
> >
> >
> > It appears to me that gdal_translate produces a much "better" result with
> > reduced aliasing.  Why would the results differ?
>
> Does gdalinfo on the output of both files report the same spatial extent ?
> gdalwarp and gdal_translate have different logic to compute it when not
> explicitly mentionned.
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/06d0d97c/attachment-0001.html>

From hrz at geodata.soton.ac.uk  Thu Oct 27 08:56:24 2016
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Thu, 27 Oct 2016 16:56:24 +0100
Subject: [gdal-dev] GDAL/OGR 2.1.2 released
In-Reply-To: <201610271144.29004.even.rouault@spatialys.com>
References: <201610271144.29004.even.rouault@spatialys.com>
Message-ID: <f8781061-e8eb-b11d-856f-492f13be7164@geodata.soton.ac.uk>

Hi,

For anyone interested in using GDAL with Docker, you can now get this 
version from the Docker Hub:

     docker pull geodata/gdal:2.1.2

See <https://hub.docker.com/r/geodata/gdal/> for further details.

Best regards,

Homme.


On 27/10/16 10:44, Even Rouault wrote:
> Hi,
>
> On behalf of the GDAL/OGR development team, I am pleased to
> announce the release of the GDAL/OGR 2.1.2 bug fix version.
> It contains ~65 bug fixes (including a few enhancements regarding GeoPackage
> support) since 2.1.1.
>
> The sources are available at:
>
>    http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2.tar.xz
>    http://download.osgeo.org/gdal/2.1.2/gdal-2.1.2.tar.gz
>    http://download.osgeo.org/gdal/2.1.2/gdal212.zip
>
> Details on the changes are available at:
>    http://trac.osgeo.org/gdal/wiki/Release/2.1.2-News
>
> Best regards,
>
> Even
>


From sablok at amazon.com  Thu Oct 27 16:35:55 2016
From: sablok at amazon.com (sablok)
Date: Thu, 27 Oct 2016 16:35:55 -0700 (MST)
Subject: [gdal-dev] GDAL Errors while building PostGIS extension?
Message-ID: <1477611355814-5293151.post@n6.nabble.com>

Hello people, I am trying to build PostGIS extensions on my machine. I have
bee able to install all the dependencies of PostGIS successfully namely
Json-c, PCRE, PROJ, GEOS and GDAL however while compiling these dependencies
I noticed a peculiar warning being thrown every time around with regards to
the libz shared object library the code wanted to use to build itself and
that is whenever make wanted to link against libz it always printed a
warning : "no version information available" but the compilation went
succesfully and I could see the different shared objects in the libs and the
necessary binaries being built. But now when I try to execute the following
command to configure PostGIS

./configure --with-gdalconfig=/root/bin/gdal-config
--with-geosconfig=/root/bin/geos-config --with-projdir=/root
--with-jsondir=/root --with-pgconfig=/root/bin/pg_config
--with-xml2config=/root/bin/xml2-config

it errors out with the following statement : Could not find GDALAllRegister,
Could not find GDAL and in the config.log it points out the code where the
error occured with the following statement :

/root/lib/libgdal.so: undefined reference to `inflateCopy at ZLIB_1.2.0'

Can anyone help me out with what is going wrong here and how can I fix this?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Errors-while-building-PostGIS-extension-tp5293151.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gdt at lexort.com  Thu Oct 27 17:43:50 2016
From: gdt at lexort.com (Greg Troxel)
Date: Thu, 27 Oct 2016 20:43:50 -0400
Subject: [gdal-dev] GDAL Errors while building PostGIS extension?
In-Reply-To: <1477611355814-5293151.post@n6.nabble.com> (sablok@amazon.com's
 message of "Thu, 27 Oct 2016 16:35:55 -0700 (MST)")
References: <1477611355814-5293151.post@n6.nabble.com>
Message-ID: <smur371l2ux.fsf@linuxpal.mit.edu>


sablok <sablok at amazon.com> writes:

> it errors out with the following statement : Could not find GDALAllRegister,
> Could not find GDAL and in the config.log it points out the code where the
> error occured with the following statement :
>
> /root/lib/libgdal.so: undefined reference to `inflateCopy at ZLIB_1.2.0'
>
> Can anyone help me out with what is going wrong here and how can I fix this?

It seems highly likely that either

  your libz is messed up

or

  you have multiple libz versions on your system, and are using
  different ones for different things, or building with one, and running
  with another, or something like that


I would suggest figuring out how to get to only one copy of libz
existing.   I also suggest not trying to build new software on LTS
systems - but you didn't explain what you are doing in detail.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161027/d689d551/attachment.sig>

From sablok at amazon.com  Thu Oct 27 21:14:58 2016
From: sablok at amazon.com (sablok)
Date: Thu, 27 Oct 2016 21:14:58 -0700 (MST)
Subject: [gdal-dev] GDAL Errors while building PostGIS extension?
In-Reply-To: <smur371l2ux.fsf@linuxpal.mit.edu>
References: <1477611355814-5293151.post@n6.nabble.com>
 <smur371l2ux.fsf@linuxpal.mit.edu>
Message-ID: <1477628098872-5293159.post@n6.nabble.com>

Indeed that is the problem, I am using GCC 4.9.2 to build postgis and its
dependencies, however the version of libz that is present inside the
postgresql's lib directory has been compiled with GCC 4.9.3 version. Can you
let me know is that the real problem here and what are the consequences that
this process entails of compiling against a library with different versions
of GCC?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Errors-while-building-PostGIS-extension-tp5293151p5293159.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kassies at gmail.com  Fri Oct 28 01:37:27 2016
From: kassies at gmail.com (Rutger)
Date: Fri, 28 Oct 2016 01:37:27 -0700 (MST)
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
 <201610271548.15375.even.rouault@spatialys.com>
 <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>
Message-ID: <1477643847621-5293193.post@n6.nabble.com>

While on the subject, i'm not aware of the implementation details of GDAL's
bilinear algorithm**. But normally you go from four source points/pixels to
a new one. How is this handled in extreme downsampling cases like Travis is
doing? Decreasing resolution a factor of 20, you're going from 400 input
pixels, to 1 output. If you would take four pixel into account you are
ignoring 99% of the input signal. From an algorithm perspective that could
be correct, but this is not always intuitive as a user. 

So Travis, have you considered using 'average' instead of bilinear? 

**I checked for 'nearest neighbor', and (of course) you will get the nearest
neighbor, leaving you with the value of 1 (center) out of the 400 source
pixels. It could be what someone's after, but most often its not.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-vs-gdal-translate-for-resizing-images-tp5293033p5293193.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Oct 28 05:21:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Oct 2016 14:21:27 +0200
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <1477643847621-5293193.post@n6.nabble.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
 <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>
 <1477643847621-5293193.post@n6.nabble.com>
Message-ID: <201610281421.27605.even.rouault@spatialys.com>

Le vendredi 28 octobre 2016 10:37:27, Rutger a écrit :
> While on the subject, i'm not aware of the implementation details of GDAL's
> bilinear algorithm**. But normally you go from four source points/pixels to
> a new one. How is this handled in extreme downsampling cases like Travis is
> doing? 

All resampling methods (except Gauss but that should likely be fixed, and 
nearest neighbour of course) since GDAL 2.0 take into account all the needed 
source pixels.

For a bilinear interpolation without resampling (or with oversampling), the 
weight function (in 1D) is :
1 - |x| if |x| <= 1
0 otherwise

where x is the distance of the center of the target pixel (considered in the 
dimensions of the source image) to the center of the source pixel considered

When downsampling by a factor of N, it is generalized as:
(1 - |x/N|)/N if |x| <= N
0 otherwise
So you have 2*N pixels taken into account

So when downsampling by a factor of 20, it is (2*20)^2 = 1600 source pixels 
taken into account for bilinear.

Example, let's consider test.asc being:

ncols        6
nrows        6
xllcorner    0
yllcorner    0
cellsize     0
 0   0   0   0   0   0
 0   100 0   0   0   0
 0   0   0   0   0   0
 0   0   0   0   0   0
 0   0   0   0   0   0
 0   0   0   0   0   0

$ gdal_translate test.asc /vsistdout/ -of aaigrid -r bilinear -outsize 50% 50%
ncols        3
nrows        3
xllcorner    0.000000000000
yllcorner    0.000000000000
cellsize     0.000000000000
 18 5 0
 5 2 0
 0 0 0

This is the same result you'd got by using imagemagick
"convert -filter triangle -resize 50% in.tif out.tif"


Whereas average (after https://trac.osgeo.org/gdal/changeset/35991, so this 
email took me all the morning lol) will return:

$ gdal_translate test.asc /vsistdout/ -of aaigrid -r average -outsize 50% 50%
ncols        3
nrows        3
xllcorner    0.000000000000
yllcorner    0.000000000000
cellsize     0.000000000000
 25 0 0
 0 0 0
 0 0 0

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kassies at gmail.com  Fri Oct 28 06:39:55 2016
From: kassies at gmail.com (Rutger)
Date: Fri, 28 Oct 2016 06:39:55 -0700 (MST)
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <201610281421.27605.even.rouault@spatialys.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
 <201610271548.15375.even.rouault@spatialys.com>
 <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>
 <1477643847621-5293193.post@n6.nabble.com>
 <201610281421.27605.even.rouault@spatialys.com>
Message-ID: <1477661995303-5293266.post@n6.nabble.com>

Thanks Even, that's very informative (and slightly shocking). I'll switch
from average to bilinear until the next release. ;)

The bilinear implementation looks very good, for a lot of GIS software i've
seen thats where you could expect some gotcha's.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-vs-gdal-translate-for-resizing-images-tp5293033p5293266.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 28 06:54:08 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 28 Oct 2016 13:54:08 +0000
Subject: [gdal-dev] Ogr and long list of errors due to missing SQLite module
Message-ID: <293f4b97d2d343b1937e5b858322bc05@C119S212VM022.msvyvi.vaha.local>

Hi,

If a GeoPackage file is touched with recent Spatialite-gui it creates automatically a virtual GPKG table for each native spatial GPKG table. If I now use ogrinfo or ogr2ogr with such database it will print an error for each virtual layer like

ERROR 1: no such module: VirtualGPKG
Warning 1: unable to read table definition for 'vgpkg_Virtausnuoli'

Ogr2ogr works despite the messages but if there are 130 layers in the GeoPackage the error list is rather long. For most users it would be enough, or still too much, to get a list of the missing modules just one time for the whole datastore.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161028/3b4ccadf/attachment.html>

From even.rouault at spatialys.com  Fri Oct 28 07:12:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 28 Oct 2016 16:12:17 +0200
Subject: [gdal-dev] Ogr and long list of errors due to missing SQLite
	module
In-Reply-To: <293f4b97d2d343b1937e5b858322bc05@C119S212VM022.msvyvi.vaha.local>
References: <293f4b97d2d343b1937e5b858322bc05@C119S212VM022.msvyvi.vaha.local>
Message-ID: <201610281612.17700.even.rouault@spatialys.com>

Le vendredi 28 octobre 2016 15:54:08, Rahkonen Jukka (MML) a écrit :
> Hi,
> 
> If a GeoPackage file is touched with recent Spatialite-gui it creates
> automatically a virtual GPKG table for each native spatial GPKG table. If
> I now use ogrinfo or ogr2ogr with such database it will print an error for
> each virtual layer like
> 
> ERROR 1: no such module: VirtualGPKG
> Warning 1: unable to read table definition for 'vgpkg_Virtausnuoli'
> 
> Ogr2ogr works despite the messages but if there are 130 layers in the
> GeoPackage the error list is rather long. For most users it would be
> enough, or still too much, to get a list of the missing modules just one
> time for the whole datastore.

Fixed per https://trac.osgeo.org/gdal/ticket/6707 (by not listing those 
tables)
Can be workarounded by specifying -oo LIST_ALL_TABLES=NO

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at lexort.com  Fri Oct 28 07:35:28 2016
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 28 Oct 2016 10:35:28 -0400
Subject: [gdal-dev] GDAL Errors while building PostGIS extension?
In-Reply-To: <1477628098872-5293159.post@n6.nabble.com> (sablok@amazon.com's
 message of "Thu, 27 Oct 2016 21:14:58 -0700 (MST)")
References: <1477611355814-5293151.post@n6.nabble.com>
 <smur371l2ux.fsf@linuxpal.mit.edu>
 <1477628098872-5293159.post@n6.nabble.com>
Message-ID: <smutwbwk0cv.fsf@linuxpal.mit.edu>


sablok <sablok at amazon.com> writes:

> Indeed that is the problem, I am using GCC 4.9.2 to build postgis and its
> dependencies, however the version of libz that is present inside the
> postgresql's lib directory has been compiled with GCC 4.9.3 version. Can you
> let me know is that the real problem here and what are the consequences that
> this process entails of compiling against a library with different versions
> of GCC?

4.9.2 vs 4.9.3 is probably not it.

1) You still have not explained everythihng you are doing.

2) I think you need help about building software in general, not help
about gdal.  Perhaps you should try coworkers since you seem to be at a
large company.



-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 180 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161028/4ffef999/attachment.sig>

From kassies at gmail.com  Fri Oct 28 08:22:58 2016
From: kassies at gmail.com (Rutger)
Date: Fri, 28 Oct 2016 08:22:58 -0700 (MST)
Subject: [gdal-dev] gdalwarp vs gdal_translate for resizing images
In-Reply-To: <1477661995303-5293266.post@n6.nabble.com>
References: <CALtm4h3cm-sBrq=rmBKy4hCVQ6BmRX9SX7ypJ3hs_WjuDDFLkA@mail.gmail.com>
 <201610271548.15375.even.rouault@spatialys.com>
 <CALtm4h2yDOmzkx9mbEA_m+eujF=1qVgjEQTgp39b5-W-kZmf4Q@mail.gmail.com>
 <1477643847621-5293193.post@n6.nabble.com>
 <201610281421.27605.even.rouault@spatialys.com>
 <1477661995303-5293266.post@n6.nabble.com>
Message-ID: <1477668178154-5293296.post@n6.nabble.com>

A case where this might come up is when for example resampling 10m Sentinel
to the 20m bands, although in such a scenario i usually would go from 20m to
10m. I did a quick comparison for the 'average' resample case, and compared
it to 'averaging' using Numpy:

/def resize(a, shape):
    
    yin, xin = a.shape
    yout, xout = shape
    
    sh = yout, yin//yout, xout, xin//xout

    return a.reshape(sh).mean(axis=(-1, 1))/

Since distance is calculated in map coordinates, the effect depends on the
used coordinate system.

With GDAL 2.1.0, released 2016/04/25:
<http://osgeo-org.1560.x6.nabble.com/file/n5293296/gdal_avg_sf.png> 

<http://osgeo-org.1560.x6.nabble.com/file/n5293296/numpy_avg_sf.png> 




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdalwarp-vs-gdal-translate-for-resizing-images-tp5293033p5293296.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From sablok at amazon.com  Fri Oct 28 10:26:32 2016
From: sablok at amazon.com (sablok)
Date: Fri, 28 Oct 2016 10:26:32 -0700 (MST)
Subject: [gdal-dev] GDAL Errors while building PostGIS extension?
In-Reply-To: <smutwbwk0cv.fsf@linuxpal.mit.edu>
References: <1477611355814-5293151.post@n6.nabble.com>
 <smur371l2ux.fsf@linuxpal.mit.edu> <1477628098872-5293159.post@n6.nabble.com>
 <smutwbwk0cv.fsf@linuxpal.mit.edu>
Message-ID: <1477675592422-5293312.post@n6.nabble.com>

I did figure out the problem, it was a libz issue, the version of libz that
was getting used while building PostGIS and its dependencies was older than
what was required, hence I removed the libz's from the postgresql's lib
directory and added system libz's stored in /lib64 to the environment's PATH
variable and everything else did build successfully, however I am not sure
if that's the correct way to build PostGIS. A detailed explanation of the
process I undertook to install PostGIS and its dependencies is as follows :

1) Copied over all the Postgresql's artifacts built on RHEL_5 and then
copied them over to a directory in Amazon Linux.

2) Updated the LD_LIBRARY_PATH to postgresql's/lib
3) Built json-c, gdal, proj, pcre and geos using --prefix = postgresql's
directory

that is the exact process I followed to build PostGIS as well



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-Errors-while-building-PostGIS-extension-tp5293151p5293312.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sat Oct 29 01:43:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 10:43:50 +0200
Subject: [gdal-dev] ogr2ogr: issues going from polar2geographic
In-Reply-To: <201607090100.47001.even.rouault@spatialys.com>
References: <15b48597-20ab-72ad-34f0-20886b5446c2@gmail.com>
 <201607090100.47001.even.rouault@spatialys.com>
Message-ID: <201610291043.51270.even.rouault@spatialys.com>

Le samedi 09 juillet 2016 01:00:46, Even Rouault a écrit :
> Le vendredi 08 juillet 2016 21:05:05, Robb Wright a écrit :
> > I'm having problems going from a Stereographic North Pole to 4326.
> > Contiguous polys across the 180 line in polar are splitting and wrapping
> > across the 4326 space, instead of just splitting at the 180.  The data
> > doesn't go south of ~50 degrees latitude.
> > 
> > ogr2ogr --config CHECK_WITH_INVERT_PROJ=YES "ESRI Shapefile"
> > output_wgs84.shp masie_ice_r00_v01_2016187_4km.shp -s_srs "+proj=stere
> > +lat_0=90 +lat_ts=60 +lon_0=-80 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m
> > +no_defs" -t_srs EPSG:4326
> > 
> > I've tried it with/without wrapdateline, with/without
> > CHECK_WITH_INVERT_PROJ but all output looks the same.
> > The proj4 came from gdalsrsinfo on the source file.
> > 
> > Source shapefile:
> > ftp://sidads.colorado.edu/DATASETS/NOAA/G02186/latest/4km/maise_ice_r00_4
> > km .zip
> > 
> > Using GDAL 2.1.0, released 2016/04/25 from the built GISInternals site.
> > 
> > If anyone has thoughts on how to go from a polar to anything else, it
> > would be appreciated.
> 
> Robb,
> 
> ogr2ogr -wrapdateline heuristics aren't ready to deal with such complex
> cases as polygons in polar projection that contain the pole itself and/or
> that cross the merdian +/- 180 deg (here we have both)
> 
> I've finally found a method in 4 steps :
> 
> 1) create needle.csv with the following content :
> 
> id,WKT
> 1,"POLYGON((179.99999 0,179.99999 89.99999,-179.99999 89.99999,-179.99999
> 0,179.99999 0))"
> 
> 2) project it to the polar system :
> 
> $ ogr2ogr needle_polar.shp needle.csv -s_srs EPSG:4326 -t_srs "+proj=stere
> +lat_0=90 +lat_ts=60 +lon_0=-80 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m
> +no_defs" -overwrite
> 
> 3) erase the needle from the original shapefile :
> 
> $ python ogr_layer_algebra.py Erase -input_ds
> masie_ice_r00_v01_2016189_4km.shp -method_ds needle_polar.shp  -output_ds
> polar_without_pole.shp -overwrite
> 
> where ogr_layer_algebra.py comes from
> https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr_layer_algebra
> .py
> 
> This step makes sure that no polygons include a point at longitude +/- 180
> deg, as well as making sure that the ~ 90 latitude appears in the
> coordinates of the polygon that contains the pole.
> 
> 4) Finally project it to EPSG:4326
> 
> $ ogr2ogr result.shp polar_without_pole.shp -t_srs EPSG:4326 -overwrite
> 

Update: I've implemented recently in trunk the above trick, so ogr2ogr will 
now work correctly out of the box for polar projection (and projections 
spanning the antimeridian) to EPSG:4326

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Oct 29 06:02:43 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 15:02:43 +0200
Subject: [gdal-dev] Motion: adopt RFC 65: IETF RFC7946 GeoJSON
Message-ID: <201610291502.43594.even.rouault@spatialys.com>

Hi,

I move to formally adopt RFC 65: IETF RFC7946 GeoJSON

https://trac.osgeo.org/gdal/wiki/rfc65_rfc7946_geojson

The implementation has been committed into trunk the past days.

-------

Starting with my +1

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Sat Oct 29 12:36:43 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 19:36:43 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
References: <912550552.340238.1477769803158.ref@mail.yahoo.com>
Message-ID: <912550552.340238.1477769803158@mail.yahoo.com>

Hello,

I am converting an .osm file to a .shp file with OGR2OGR.exe. Here is an example:
ogr2ogr.exe --configOSM_USE_CUSTOM_INDEXING NO -skipfailures -f "ESRI Shapefile"output.shp input.osm
In osmconf.ini the "other_tags" is set to "yes" (other_tags=yes).

Is it possible to somehow tell the OGR2OGR to split the "other_tags" string into all of those separate tags it contains?
Or maybe to somehow do that by editing the osmconf.ini file?

I googled, and checked the GDAL OSM driver page, but still couldn't find an answer.

Thank you for the reply.

Regards,
Djordje
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/a63b7300/attachment.html>

From even.rouault at spatialys.com  Sat Oct 29 13:00:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 22:00:50 +0200
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <912550552.340238.1477769803158@mail.yahoo.com>
References: <912550552.340238.1477769803158.ref@mail.yahoo.com>
 <912550552.340238.1477769803158@mail.yahoo.com>
Message-ID: <201610292200.50478.even.rouault@spatialys.com>

Le samedi 29 octobre 2016 21:36:43, Djordje Spasic a écrit :
> Hello,
> 
> I am converting an .osm file to a .shp file with OGR2OGR.exe. Here is an
> example: ogr2ogr.exe --configOSM_USE_CUSTOM_INDEXING NO -skipfailures -f
> "ESRI Shapefile"output.shp input.osm In osmconf.ini the "other_tags" is
> set to "yes" (other_tags=yes).
> 
> Is it possible to somehow tell the OGR2OGR to split the "other_tags" string
> into all of those separate tags it contains? Or maybe to somehow do that
> by editing the osmconf.ini file?
> 
> I googled, and checked the GDAL OSM driver page, but still couldn't find an
> answer.

Djordje,

There's no option to do that. This would require doing a 2 pass strategy :
* a initial pass in to collect all the possible tags so as to discover all the 
needed fields
 * and then the real pass to read the data.

(We could potentially do that in a single pass if we allowed the layer 
definition to be modified while reading, but this isn't something that is 
allowed in the OGR "contract" with respect to code using the API. We could 
imagine an option where code ready for that (for example an updated ogr2ogr) 
would tell the reader: you can declare new fields as soon as you discover them)

So you have to do that as a post processing step with some scripting (could be 
a useful contribution).

Or edit osmconf.ini to add the extra tags you want as fields in the attribute= 
configuration key, as I'm not sure you really need all exotic tags to be 
individualized as OGR fields.

Or actually you could do a simplified osm2shape.py that would be a simplified 
ogr2ogr that would read the .osm file, and split other_tags on the fly.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Sat Oct 29 13:03:29 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 29 Oct 2016 13:03:29 -0700 (MST)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <912550552.340238.1477769803158@mail.yahoo.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
Message-ID: <1477771409072-5293456.post@n6.nabble.com>

Hi,

Have you tried "all_tags" http://www.gdal.org/drv_osm.html?  Shapefiles are
poor as target format because it limits the name of the tag to 10
characters, and the length of the value to 255 characters. I recommend to
use Spatialite or GeoPackage instead.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-splitting-other-tags-from-osm-file-tp5293451p5293456.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sat Oct 29 13:04:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 22:04:50 +0200
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <1477771409072-5293456.post@n6.nabble.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <1477771409072-5293456.post@n6.nabble.com>
Message-ID: <201610292204.50710.even.rouault@spatialys.com>

Le samedi 29 octobre 2016 22:03:29, jratike80 a écrit :
> Hi,
> 
> Have you tried "all_tags" http://www.gdal.org/drv_osm.html?  Shapefiles are
> poor as target format because it limits the name of the tag to 10
> characters, and the length of the value to 255 characters. I recommend to
> use Spatialite or GeoPackage instead.

all_tags will not do what Djordge wants. It is just a concatenation of all 
tags in a single field with hstore formatting.

> 
> -Jukka Rahkonen-
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-splitting-other-tags-from-osm
> -file-tp5293451p5293456.html Sent from the GDAL - Dev mailing list archive
> at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Sat Oct 29 14:07:08 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 21:07:08 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292204.50710.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <1477771409072-5293456.post@n6.nabble.com>
 <201610292204.50710.even.rouault@spatialys.com>
Message-ID: <1680220840.409858.1477775228237@mail.yahoo.com>

Thank you for the useful replies both Even and Jukka!

@Even Rouault: 
Let me see if I understood you:
1) If I would like a particular key (field) from the other_tags, I can name it in the osmconf.ini's "attributes=". Then once the OGR2OGR performs the conversion from .osm to .shp, that particular key(field) will be taken out from the other_tags, and presented among other regular keys (fields).
2) But If I would like to get all keys (fields) from the other_tags, then I need to write a script which will split the other_tags string.

If I go with the second option, then there is something I do not understand. Here is an other_tags string example for OSM Munich location:

"addr:postcode"=>"80636","addr:street"=>"Marlene-Dietrich-Strasse"
I understand that postcode and street are keys (fields). And that 80636 and Marlene-Dietrich-Strasse are their respective values.
But what does the addr represent? Is this some sort of category of the key? And why do only keys in the other_tags have this subcategory label?


@Jukka Rahkonen: I am currently stuck with shapefile. We'll see if in future I will jump to Spatialite or GeoPackage file types. Thank you for the suggestion!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/098a95dd/attachment.html>

From issworld2000 at yahoo.com  Sat Oct 29 14:07:08 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 21:07:08 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292204.50710.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <1477771409072-5293456.post@n6.nabble.com>
 <201610292204.50710.even.rouault@spatialys.com>
Message-ID: <1680220840.409858.1477775228237@mail.yahoo.com>

Thank you for the useful replies both Even and Jukka!

@Even Rouault: 
Let me see if I understood you:
1) If I would like a particular key (field) from the other_tags, I can name it in the osmconf.ini's "attributes=". Then once the OGR2OGR performs the conversion from .osm to .shp, that particular key(field) will be taken out from the other_tags, and presented among other regular keys (fields).
2) But If I would like to get all keys (fields) from the other_tags, then I need to write a script which will split the other_tags string.

If I go with the second option, then there is something I do not understand. Here is an other_tags string example for OSM Munich location:

"addr:postcode"=>"80636","addr:street"=>"Marlene-Dietrich-Strasse"
I understand that postcode and street are keys (fields). And that 80636 and Marlene-Dietrich-Strasse are their respective values.
But what does the addr represent? Is this some sort of category of the key? And why do only keys in the other_tags have this subcategory label?


@Jukka Rahkonen: I am currently stuck with shapefile. We'll see if in future I will jump to Spatialite or GeoPackage file types. Thank you for the suggestion!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/098a95dd/attachment-0003.html>

From even.rouault at spatialys.com  Sat Oct 29 14:09:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 23:09:48 +0200
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <1680220840.409858.1477775228237@mail.yahoo.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292204.50710.even.rouault@spatialys.com>
 <1680220840.409858.1477775228237@mail.yahoo.com>
Message-ID: <201610292309.49016.even.rouault@spatialys.com>

Le samedi 29 octobre 2016 23:07:08, Djordje Spasic a écrit :
> Thank you for the useful replies both Even and Jukka!
> 
> @Even Rouault:
> Let me see if I understood you:
> 1) If I would like a particular key (field) from the other_tags, I can name
> it in the osmconf.ini's "attributes=". Then once the OGR2OGR performs the
> conversion from .osm to .shp, that particular key(field) will be taken out
> from the other_tags, and presented among other regular keys (fields). 

Yes

> 2)
> But If I would like to get all keys (fields) from the other_tags, then I
> need to write a script which will split the other_tags string.

Yes
> 
> If I go with the second option, then there is something I do not
> understand. Here is an other_tags string example for OSM Munich location:
> 
> "addr:postcode"=>"80636","addr:street"=>"Marlene-Dietrich-Strasse"
> I understand that postcode and street are keys (fields). And that 80636 and
> Marlene-Dietrich-Strasse are their respective values. But what does the
> addr represent? Is this some sort of category of the key? And why do only
> keys in the other_tags have this subcategory label?
 
This is just OSM convention about tag names. For OGR purpose, foo, foo: 
foo:bar, :bar, ['$^%&~ are equivalent
To answere your question, yes I guess the prefix:name is a convention to give 
some namespace / context / category.
You could as well put addr:postcode as value in attribute=

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Sat Oct 29 14:15:31 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 29 Oct 2016 14:15:31 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 65: IETF RFC7946 GeoJSON
In-Reply-To: <201610291502.43594.even.rouault@spatialys.com>
References: <201610291502.43594.even.rouault@spatialys.com>
Message-ID: <1477775731863-5293460.post@n6.nabble.com>

Conditional +1

Do I understand right that M must be dropped when writing geometries which
include measure into RFC 7946 variant? This is not mentioned in GDAL RFC 65,
how about in the code?

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-adopt-RFC-65-IETF-RFC7946-GeoJSON-tp5293429p5293460.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Sat Oct 29 14:21:00 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 21:21:00 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292309.49016.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292204.50710.even.rouault@spatialys.com>
 <1680220840.409858.1477775228237@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
Message-ID: <444240422.380732.1477776060227@mail.yahoo.com>

Thank you for the quick reply Even. 
> You could as well putaddr:postcode as value in attribute=
This means that the name of the key (field) will be:"addr:postc", to accommodate those 10 maximal characters reserved for shapefile key (field) names? 
Even do you mind if I ask you what is the difference betweenother_tags, and all_tags?There is an exaplanation in the osmconf.ini:
"all_tags" and"other_tags" are exclusive
But I do not understand it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/748dfaf2/attachment.html>

From issworld2000 at yahoo.com  Sat Oct 29 14:21:00 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 21:21:00 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292309.49016.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292204.50710.even.rouault@spatialys.com>
 <1680220840.409858.1477775228237@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
Message-ID: <444240422.380732.1477776060227@mail.yahoo.com>

Thank you for the quick reply Even. 
> You could as well putaddr:postcode as value in attribute=
This means that the name of the key (field) will be:"addr:postc", to accommodate those 10 maximal characters reserved for shapefile key (field) names? 
Even do you mind if I ask you what is the difference betweenother_tags, and all_tags?There is an exaplanation in the osmconf.ini:
"all_tags" and"other_tags" are exclusive
But I do not understand it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/748dfaf2/attachment-0003.html>

From even.rouault at spatialys.com  Sat Oct 29 14:22:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 23:22:07 +0200
Subject: [gdal-dev] Motion: adopt RFC 65: IETF RFC7946 GeoJSON
In-Reply-To: <1477775731863-5293460.post@n6.nabble.com>
References: <201610291502.43594.even.rouault@spatialys.com>
 <1477775731863-5293460.post@n6.nabble.com>
Message-ID: <201610292322.07403.even.rouault@spatialys.com>

Le samedi 29 octobre 2016 23:15:31, jratike80 a écrit :
> Conditional +1
> 
> Do I understand right that M must be dropped when writing geometries which
> include measure into RFC 7946 variant? This is not mentioned in GDAL RFC
> 65, how about in the code?

There was nothing particular to do regarding this, as only 2D and XYZ were 
supported by the existing driver. I've just added a note in the RFC about that

$ cat test.csv
id,WKT
1,"POINT ZM(1 2 3 4)"

$ ogr2ogr -f geojson /vsistdout/ test.csv -select id
{
"type": "FeatureCollection",
"features": [
{ "type": "Feature", "properties": { "id": "1" }, "geometry": { "type": 
"Point", "coordinates": [ 1.0, 2.0, 3.0 ] } }
]
}

$ ogr2ogr -f geojson /vsistdout/ test.csv -select id -lco RFC7946=YES \
   -a_srs EPSG:4326
{
"type": "FeatureCollection",
"features": [
{ "type": "Feature", "properties": { "id": "1" }, "geometry": { "type": 
"Point", "coordinates": [ 1.0, 2.0, 3.0 ] } }
]
}

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Oct 29 14:27:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 29 Oct 2016 23:27:09 +0200
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <444240422.380732.1477776060227@mail.yahoo.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
Message-ID: <201610292327.10140.even.rouault@spatialys.com>

Le samedi 29 octobre 2016 23:21:00, Djordje Spasic a écrit :
> Thank you for the quick reply Even. 
> 
> > You could as well putaddr:postcode as value in attribute=
> 
> This means that the name of the key (field) will be:"addr:postc", to
> accommodate those 10 maximal characters reserved for shapefile key (field)
> names?

Yes. You could also do renaming with:

ogr2ogr points.shp your.osm -sql "select \"addr:postcode\" as postcode from 
points"

Or create a computed field in the osmconf.ini (untested, but should hopefully 
work):

computed_attributes=postcode
postcode=String
postcode_sql="SELECT [addr:postcode]"


> Even do you mind if I ask you what is the difference
> betweenother_tags, and all_tags?There is an exaplanation in the
> osmconf.ini: "all_tags" and"other_tags" are exclusive
> But I do not understand it.

Why not just experimenting ? This would be clearer than any explanations.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Sat Oct 29 14:50:22 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 29 Oct 2016 21:50:22 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292327.10140.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
Message-ID: <490279618.396678.1477777822286@mail.yahoo.com>

Thank you Even.

> Why notjust experimenting ? This would be clearer than any explanations.

I did. But I do not understand the results.
Fore example if for "other_tags=yes" for a single shape I got the string previously mentioned:

"addr:postcode"=>"80636","addr:street"=>"Marlene-Dietrich-Strasse"
But if I set the "all_tags=yes", then for the same shape, I get the following all_tags string:

"addr:postcode"=>"80636","addr:street"=>"Marlene-Dietrich-Straße","building"=>"yes"
So only the additional: "building"=>"yes" tag is given.
Which makes me confused what is the difference between other_tags and all_tags.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161029/f9fe8079/attachment-0001.html>

From etienne.trimaille at gmail.com  Sat Oct 29 21:05:16 2016
From: etienne.trimaille at gmail.com (Etienne Trimaille)
Date: Sun, 30 Oct 2016 11:05:16 +0700
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610292327.10140.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
Message-ID: <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>

As Even said, there is no way to get all tags as a separate field only with
ogr2ogr.
The 'all_tags' flag will use the HSTORE only.

You can have a look to the QGIS QuickOSM plugin. With this plugin, you can
open a local OSM file like yours and ask the plugin to parse every fields
available. The plugin will manage to create a field for each OSM tag.

2016-10-30 4:27 GMT+07:00 Even Rouault <even.rouault at spatialys.com>:

> Le samedi 29 octobre 2016 23:21:00, Djordje Spasic a écrit :
> > Thank you for the quick reply Even.
> >
> > > You could as well putaddr:postcode as value in attribute=
> >
> > This means that the name of the key (field) will be:"addr:postc", to
> > accommodate those 10 maximal characters reserved for shapefile key
> (field)
> > names?
>
> Yes. You could also do renaming with:
>
> ogr2ogr points.shp your.osm -sql "select \"addr:postcode\" as postcode from
> points"
>
> Or create a computed field in the osmconf.ini (untested, but should
> hopefully
> work):
>
> computed_attributes=postcode
> postcode=String
> postcode_sql="SELECT [addr:postcode]"
>
>
> > Even do you mind if I ask you what is the difference
> > betweenother_tags, and all_tags?There is an exaplanation in the
> > osmconf.ini: "all_tags" and"other_tags" are exclusive
> > But I do not understand it.
>
> Why not just experimenting ? This would be clearer than any explanations.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161030/e30efa0e/attachment.html>

From issworld2000 at yahoo.com  Sun Oct 30 05:55:15 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 30 Oct 2016 12:55:15 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
 <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>
Message-ID: <382127480.586238.1477832115164@mail.yahoo.com>

Thank you for the reply Etienne,

I am not interested in using QGIS. I am limited to OGR2OGR.exe for now.


> As Even said, there is no way to get all tags as a separate field only with ogr2ogr. The 'all_tags' flag will use the HSTORE only.


Yes, I understood that from Even's reply.

Jukka mentioned all_tags, of which I haven't been aware of.
So my issue now is: what is the difference between other_tags and all_tags?

Thank you.

Regards,
Djordje
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161030/3571c9da/attachment.html>

From andre+joost at nurfuerspam.de  Sun Oct 30 09:57:37 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sun, 30 Oct 2016 17:57:37 +0100
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <382127480.586238.1477832115164@mail.yahoo.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
 <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>
 <382127480.586238.1477832115164@mail.yahoo.com>
Message-ID: <nv58s8$q4a$1@blaine.gmane.org>

Am 30.10.2016 um 13:55 schrieb Djordje Spasic:

>
> Jukka mentioned all_tags, of which I haven't been aware of.
> So my issue now is: what is the difference between other_tags and all_tags?
>


other_tags includes all tags that are **not** covered by the attribute 
fields list in osmconf.ini.

all_tags includes really all tags of a feature, even if they are already 
in their respective column listed in osmconf.ini (like building or 
highway usually are).

It might be necessary to rename addr:postcode to addr_postcode or 
postcode to avoid further problems with shapefile specifications. See 
http://support.esri.com/technical-article/000005588

HTH,
André Joost


From jukka.rahkonen at maanmittauslaitos.fi  Sun Oct 30 10:04:56 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sun, 30 Oct 2016 10:04:56 -0700 (MST)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <382127480.586238.1477832115164@mail.yahoo.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <1477771409072-5293456.post@n6.nabble.com>
 <201610292204.50710.even.rouault@spatialys.com>
 <1680220840.409858.1477775228237@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
 <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>
 <382127480.586238.1477832115164@mail.yahoo.com>
Message-ID: <1477847096958-5293505.post@n6.nabble.com>

Hi,

I apologize that I did not remember right what -all_tags is doing. The
difference is as written in http://www.gdal.org/drv_osm.html

"Similar to "other_tags", except that it contains both keys specifically
identified to be reported as dedicated fields, as well as other keys."

Thus all_tags concatenates all tag/value pairs into one attribute (which is
designed for PostGIS HSTORE type) even if some keys are especially picked to
be written into regular attribute fields. Other_tags option concatenates
only those tag/value pairs which are not already converted into regular
attributes.  First option writes the selected attributes two times into
output data which does make sense with PostGIS hstore when it can be handy
to have everything queryable from hstore, but having same data as normal
attribute makes is also possible to use special index for the field, cast
strings to other datatypes etc. for some specialized queries and processing
of data.

If you need to get access to all the tag/value pairs in the data you may
bang your head on the wall with ogr2ogr and shapefiles. Some suggestions: 
- Use ogr2ogr and PostGIS with hstore + all_tags
- Try OpenJUMP which creates fields for all the tags it finds.
- QGIS was already suggested
- Try Spatialite OSM raw tool
https://www.gaia-gis.it/fossil/spatialite-tools/wiki?name=spatialite_osm_raw

-Jukka Rahkonen-





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-splitting-other-tags-from-osm-file-tp5293451p5293505.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sun Oct 30 11:29:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 30 Oct 2016 19:29:23 +0100
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <1477847096958-5293505.post@n6.nabble.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <382127480.586238.1477832115164@mail.yahoo.com>
 <1477847096958-5293505.post@n6.nabble.com>
Message-ID: <201610301929.23629.even.rouault@spatialys.com>

Le dimanche 30 octobre 2016 18:04:56, jratike80 a écrit :
> Hi,
> 
> I apologize that I did not remember right what -all_tags is doing. The
> difference is as written in http://www.gdal.org/drv_osm.html
> 
> "Similar to "other_tags", except that it contains both keys specifically
> identified to be reported as dedicated fields, as well as other keys."
> 
> Thus all_tags concatenates all tag/value pairs into one attribute (which is
> designed for PostGIS HSTORE type) even if some keys are especially picked
> to be written into regular attribute fields. Other_tags option
> concatenates only those tag/value pairs which are not already converted
> into regular attributes.  First option writes the selected attributes two
> times into output data which does make sense with PostGIS hstore when it
> can be handy to have everything queryable from hstore, but having same
> data as normal attribute makes is also possible to use special index for
> the field, cast strings to other datatypes etc. for some specialized
> queries and processing of data.
> 
> If you need to get access to all the tag/value pairs in the data you may
> bang your head on the wall with ogr2ogr and shapefiles. Some suggestions:
> - Use ogr2ogr and PostGIS with hstore + all_tags
> - Try OpenJUMP which creates fields for all the tags it finds.
> - QGIS was already suggested
> - Try Spatialite OSM raw tool
> https://www.gaia-gis.it/fossil/spatialite-tools/wiki?name=spatialite_osm_ra
> w

I've modified in a quick & dirty way the (deprecated) python port of ogr2ogr to 
implement the splitting of other_tags column :
https://gist.github.com/rouault/1c7b66b420d0ff665fbcb735e26e8664

python osm2ogr.py directory_of_shapefiles your.osm -skip

(note: this will probably not work in append mode, just initial conversion)

But this is a bad idea with osm files that are sufficiently big. For example with 
a conversion of an old dataset from Finland that I interrupted during 
conversion, the points layer had already 795 attributes ! (and I removed a 
few. See at line 1613 some filtering

So splitting *all* the tags is a bad idea. Particularly with shapefiles and the 
10 character limit for fieldnames. But this is also true for any output format 
since layers with hundreds of attributes will cause various issues. You need 
to apply some extra application logic to choose a subset, apply field name 
renaming etc.

Another more reasonable approach would be like what spatialite_osm_raw does, 
that is put tags as (node_id, key, value) triplet in dedicated tables. But you 
need to deal with layer joins afterwards.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From issworld2000 at yahoo.com  Sun Oct 30 11:43:52 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 30 Oct 2016 18:43:52 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <201610301929.23629.even.rouault@spatialys.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <382127480.586238.1477832115164@mail.yahoo.com>
 <1477847096958-5293505.post@n6.nabble.com>
 <201610301929.23629.even.rouault@spatialys.com>
Message-ID: <955745094.697101.1477853032193@mail.yahoo.com>

Thank you Even!

The osm2ogr.py that you just posted, relies on python GDAL bindings?

I am currently using MapWindow/MapWinGIS C# bindings which enable usage of ogr2ogr.exe. I am limited to .NET .dll files only, so I can not use python GDAL ones.

But I am sure this script will be very useful to much of the Python GDAL users community.


Do I know if it is possible to approve my email sent at 7:24 PM CET, today?
It is larger than 50kb. For some reason it looks like the way I am handling quotes is counted as a reply text as well.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161030/92289eee/attachment.html>

From issworld2000 at yahoo.com  Sun Oct 30 11:24:11 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 30 Oct 2016 18:24:11 +0000 (UTC)
Subject: [gdal-dev] splitting other_tags from .osm file
In-Reply-To: <1477847096958-5293505.post@n6.nabble.com>
References: <912550552.340238.1477769803158@mail.yahoo.com>
 <1477771409072-5293456.post@n6.nabble.com>
 <201610292204.50710.even.rouault@spatialys.com>
 <1680220840.409858.1477775228237@mail.yahoo.com>
 <201610292309.49016.even.rouault@spatialys.com>
 <444240422.380732.1477776060227@mail.yahoo.com>
 <201610292327.10140.even.rouault@spatialys.com>
 <CAMtDFLJ7GBmDaKe1HQi8U1CJk0j9+q9b9yN=jn6LKH++fpVE-w@mail.gmail.com>
 <382127480.586238.1477832115164@mail.yahoo.com>
 <1477847096958-5293505.post@n6.nabble.com>
Message-ID: <2134739979.727548.1477851851234@mail.yahoo.com>

Thank you for the replies Andre and Jukka.

@Andre:
 > It might be necessary torename addr:postcode to addr_postcode or 
postcode to avoid further problems with shapefile specifications. See 
http://support.esri.com/technical-article/000005588
Understood.


@Juka and Andre:
> other_tags includes all tagsthat are **not** covered by the attribute 
fields list in osmconf.ini.

all_tags includes really all tags of a feature, even if they are already 
in their respective column listed in osmconf.ini (like building or 
highway usually are).


> I apologize that I did notremember right what -all_tags is doing. The
difference is as written in http://www.gdal.org/drv_osm.html

"Similar to "other_tags", except that it contains both keysspecifically
identified to be reported as dedicated fields, as well as other keys."

Thus all_tags concatenates all tag/value pairs into one attribute (which is
designed for PostGIS HSTORE type) even if some keys are especially picked to
be written into regular attribute fields. Other_tags option concatenates
only those tag/value pairs which are not already converted into regular
attributes.  First option writes the selected attributes two times into
output data which does make sense with PostGIS hstore when it can be handy
to have everything queryable from hstore, but having same data as normal
attribute makes is also possible to use special index for the field, cast
strings to other datatypes etc. for some specialized queries and processing
of data.
Ah, I understand now.
What confused me was the following sentence from the GDAL OSM Driver page:

Similar to "other_tags", except that it contains both keys specifically identified to be reported asdedicated fields, as well as other keys.
The upper mentioned "dedicated fields" was the first and only mention of "dedicated fields" on that page. After your last replies I understood that this is actually related with the part of the osmconf.ini file, which defines the particular fields. For example:

# keys to report as OGR fields
attributes=name,type,aeroway,amenity,admin_level,barrier,boundary,building,craft,geological,historic,land_area,landuse,leisure,man_made,military,natural,office,place,shop,sport,tourism




@ Jukka:
> If youneed to get access to all the tag/value pairs in the data you may
bang your head on the wall with ogr2ogr and shapefiles. Some suggestions: 
- Use ogr2ogr and PostGIS with hstore + all_tags
- Try OpenJUMP which creates fields for all the tags it finds.
- QGIS was already suggested
- Try Spatialite OSM raw toolhttps://www.gaia-gis.it/fossil/spatialite-tools/wiki?name=spatialite_osm_raw
It's good to know this. I will have to stick with shapefiles for now.
But I can see that OGR2OGR can convert an .osm file to PostgreSQL format, so I assume this may be useful later. But I would have to become familiar with PostgreSQL format first.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161030/c6457282/attachment-0001.html>

From johan.de.braak at eleaf.com  Mon Oct 31 03:11:44 2016
From: johan.de.braak at eleaf.com (Johan de Braak)
Date: Mon, 31 Oct 2016 03:11:44 -0700 (MST)
Subject: [gdal-dev] gdal.RasterizeOptions output type
Message-ID: <1477908704808-5293573.post@n6.nabble.com>

Hi all,

I cannot seem to find the possibility to set the output type in
gdal.RasterizeOptions (like in gdal.TranslateOptions). Am I missing
something or is this not possible? 

I'm using GDAL 2.1.1

Thank you,

Johan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp5293573.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Oct 31 03:29:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Oct 2016 11:29:27 +0100
Subject: [gdal-dev] gdal.RasterizeOptions output type
In-Reply-To: <1477908704808-5293573.post@n6.nabble.com>
References: <1477908704808-5293573.post@n6.nabble.com>
Message-ID: <201610311129.27442.even.rouault@spatialys.com>

Le lundi 31 octobre 2016 11:11:44, Johan de Braak a écrit :
> Hi all,
> 
> I cannot seem to find the possibility to set the output type in
> gdal.RasterizeOptions (like in gdal.TranslateOptions). Am I missing
> something or is this not possible?

This was indeed a shortcoming. I've just added it in trunk.
You can workaround by using the option string: options="-ot ..."

> 
> I'm using GDAL 2.1.1
> 
> Thank you,
> 
> Johan
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp52
> 93573.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucena_ivan at hotmail.com  Mon Oct 31 06:24:44 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 31 Oct 2016 13:24:44 +0000
Subject: [gdal-dev] gdal.RasterizeOptions output type
In-Reply-To: <201610311129.27442.even.rouault@spatialys.com>
References: <1477908704808-5293573.post@n6.nabble.com>,
 <201610311129.27442.even.rouault@spatialys.com>
Message-ID: <BLUPR19MB01454D33825C431E58666F6CF2AE0@BLUPR19MB0145.namprd19.prod.outlook.com>

Even, Are you planning to backport that?

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Even Rouault <even.rouault at spatialys.com>
Sent: Monday, October 31, 2016 6:29:27 AM
To: gdal-dev at lists.osgeo.org
Cc: Johan de Braak
Subject: Re: [gdal-dev] gdal.RasterizeOptions output type

Le lundi 31 octobre 2016 11:11:44, Johan de Braak a écrit :
> Hi all,
>
> I cannot seem to find the possibility to set the output type in
> gdal.RasterizeOptions (like in gdal.TranslateOptions). Am I missing
> something or is this not possible?

This was indeed a shortcoming. I've just added it in trunk.
You can workaround by using the option string: options="-ot ..."

>
> I'm using GDAL 2.1.1
>
> Thank you,
>
> Johan
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp52
> 93573.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161031/1a6ad663/attachment.html>

From Jerome.Guelat at vogelwarte.ch  Mon Oct 31 06:34:32 2016
From: Jerome.Guelat at vogelwarte.ch (Guelat Jerome)
Date: Mon, 31 Oct 2016 13:34:32 +0000
Subject: [gdal-dev] Dropping GeoPackage table doesn't reduce file size
Message-ID: <53F9F3EAA7ADA840BB25DEF7D956D41B175265E1@MailNT.vogelwarte.ch>

Hi,

I'm trying to drop a GeoPackage table using ogrinfo db.gpkg -sql "drop table test" (test is the only table in the GeoPackage). This seems to work and ogrinfo tells me that the GeoPackage is empty but the file size is the same as before (9.5 MB). Is this expected?

I'm using GDAL/OGR 2.1.2 on Windows, the GeoPackage was created with QGIS 2.18.

Thanks for your help!

Jerome

From jukka.rahkonen at maanmittauslaitos.fi  Mon Oct 31 06:48:10 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 31 Oct 2016 06:48:10 -0700 (MST)
Subject: [gdal-dev] Dropping GeoPackage table doesn't reduce file size
In-Reply-To: <53F9F3EAA7ADA840BB25DEF7D956D41B175265E1@MailNT.vogelwarte.ch>
References: <53F9F3EAA7ADA840BB25DEF7D956D41B175265E1@MailNT.vogelwarte.ch>
Message-ID: <1477921690990-5293607.post@n6.nabble.com>

You must vacuum https://www.sqlite.org/lang_vacuum.html. It can be slow so
you do not necessarily want to do it if your database is big and if you
dropped just a small table.

ogrinfo db.gpkg -sql "VACUUM"

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-GeoPackage-table-doesn-t-reduce-file-size-tp5293603p5293607.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Jerome.Guelat at vogelwarte.ch  Mon Oct 31 07:14:47 2016
From: Jerome.Guelat at vogelwarte.ch (jguelat)
Date: Mon, 31 Oct 2016 07:14:47 -0700 (MST)
Subject: [gdal-dev] Dropping GeoPackage table doesn't reduce file size
In-Reply-To: <1477921690990-5293607.post@n6.nabble.com>
References: <53F9F3EAA7ADA840BB25DEF7D956D41B175265E1@MailNT.vogelwarte.ch>
 <1477921690990-5293607.post@n6.nabble.com>
Message-ID: <1477923287770-5293618.post@n6.nabble.com>

Thanks for you help! I thought this was done automatically...



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-GeoPackage-table-doesn-t-reduce-file-size-tp5293603p5293618.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kyle at pobox.com  Mon Oct 31 07:55:49 2016
From: kyle at pobox.com (Kyle Shannon)
Date: Mon, 31 Oct 2016 08:55:49 -0600
Subject: [gdal-dev] Dropping GeoPackage table doesn't reduce file size
In-Reply-To: <1477923287770-5293618.post@n6.nabble.com>
References: <53F9F3EAA7ADA840BB25DEF7D956D41B175265E1@MailNT.vogelwarte.ch>
 <1477921690990-5293607.post@n6.nabble.com>
 <1477923287770-5293618.post@n6.nabble.com>
Message-ID: <CAJ0mEz2__ELySNUZUX67aqOOEcKg90RH7jFL46KPr9MUTmE0yA@mail.gmail.com>

Jerome,

On Mon, Oct 31, 2016 at 8:14 AM, jguelat <Jerome.Guelat at vogelwarte.ch> wrote:
> Thanks for you help! I thought this was done automatically...

It is disabled by default:

https://www.sqlite.org/pragma.html#pragma_auto_vacuum

If you want to enable it through OGR, you can use OGR_SQLITE_PRAGMA:

"""

Starting with OGR 1.11, any SQLite pragma can be specified with the
OGR_SQLITE_PRAGMA configuration option. The syntax is
OGR_SQLITE_PRAGMA =
"pragma_name=pragma_value[,pragma_name2=pragma_value2]*".

"""

from the SQLite driver page:

http://gdal.org/drv_sqlite.html

>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-GeoPackage-table-doesn-t-reduce-file-size-tp5293603p5293618.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Kyle

From even.rouault at spatialys.com  Mon Oct 31 08:32:30 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 31 Oct 2016 16:32:30 +0100
Subject: [gdal-dev] gdal.RasterizeOptions output type
In-Reply-To: <BLUPR19MB01454D33825C431E58666F6CF2AE0@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <1477908704808-5293573.post@n6.nabble.com>
 <201610311129.27442.even.rouault@spatialys.com>
 <BLUPR19MB01454D33825C431E58666F6CF2AE0@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <201610311632.30058.even.rouault@spatialys.com>

Le lundi 31 octobre 2016 14:24:44, Ivan Lucena a écrit :
> Even, Are you planning to backport that?

Done per https://trac.osgeo.org/gdal/ticket/6710

> 
> ________________________________
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Even Rouault
> <even.rouault at spatialys.com> Sent: Monday, October 31, 2016 6:29:27 AM
> To: gdal-dev at lists.osgeo.org
> Cc: Johan de Braak
> Subject: Re: [gdal-dev] gdal.RasterizeOptions output type
> 
> Le lundi 31 octobre 2016 11:11:44, Johan de Braak a écrit :
> > Hi all,
> > 
> > I cannot seem to find the possibility to set the output type in
> > gdal.RasterizeOptions (like in gdal.TranslateOptions). Am I missing
> > something or is this not possible?
> 
> This was indeed a shortcoming. I've just added it in trunk.
> You can workaround by using the option string: options="-ot ..."
> 
> > I'm using GDAL 2.1.1
> > 
> > Thank you,
> > 
> > Johan
> > 
> > 
> > 
> > --
> > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp5
> > 2 93573.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lucena_ivan at hotmail.com  Mon Oct 31 09:03:09 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 31 Oct 2016 16:03:09 +0000
Subject: [gdal-dev] gdal.RasterizeOptions output type
In-Reply-To: <201610311632.30058.even.rouault@spatialys.com>
References: <1477908704808-5293573.post@n6.nabble.com>
 <201610311129.27442.even.rouault@spatialys.com>
 <BLUPR19MB01454D33825C431E58666F6CF2AE0@BLUPR19MB0145.namprd19.prod.outlook.com>,
 <201610311632.30058.even.rouault@spatialys.com>
Message-ID: <BLUPR19MB0145CC8A9B54BD9D925C31F8F2AE0@BLUPR19MB0145.namprd19.prod.outlook.com>

Thanks.

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, October 31, 2016 11:32:30 AM
To: Ivan Lucena
Cc: gdal-dev at lists.osgeo.org; Johan de Braak
Subject: Re: [gdal-dev] gdal.RasterizeOptions output type

Le lundi 31 octobre 2016 14:24:44, Ivan Lucena a écrit :
> Even, Are you planning to backport that?

Done per https://trac.osgeo.org/gdal/ticket/6710

>
> ________________________________
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Even Rouault
> <even.rouault at spatialys.com> Sent: Monday, October 31, 2016 6:29:27 AM
> To: gdal-dev at lists.osgeo.org
> Cc: Johan de Braak
> Subject: Re: [gdal-dev] gdal.RasterizeOptions output type
>
> Le lundi 31 octobre 2016 11:11:44, Johan de Braak a écrit :
> > Hi all,
> >
> > I cannot seem to find the possibility to set the output type in
> > gdal.RasterizeOptions (like in gdal.TranslateOptions). Am I missing
> > something or is this not possible?
>
> This was indeed a shortcoming. I've just added it in trunk.
> You can workaround by using the option string: options="-ot ..."
>
> > I'm using GDAL 2.1.1
> >
> > Thank you,
> >
> > Johan
> >
> >
> >
> > --
> > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/gdal-RasterizeOptions-output-type-tp5
> > 2 93573.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161031/f04f4550/attachment-0001.html>

From SDikmen at havelsan.com.tr  Mon Oct 31 09:24:47 2016
From: SDikmen at havelsan.com.tr (=?iso-8859-3?Q?Serpil_D=A9KMEN?=)
Date: Mon, 31 Oct 2016 16:24:47 +0000
Subject: [gdal-dev] 64 bit Gdal - .mdb file reading problem
In-Reply-To: <1477908704808-5293573.post@n6.nabble.com>
References: <1477908704808-5293573.post@n6.nabble.com>
Message-ID: <3E1F92FB-9C69-4985-9F92-0887EF47A76F@havelsan.com.tr>


Hi
we need to read .mdb vector files using ogr.
But it is not possible with 64 bit gdal java  bindings. I have investigated all of the related posts and tried to apply proposed solutions but it not succeed .
I have installed 64 bithttp://blog.codefluententities.com/2011/01/20/microsoft-access-database-engine-2010-redistributable<http://blog.codefluententities.com/2011/01/20/microsoft-access-database-engine-2010-redistributable/>
but the problem is still continue.

Is there an exact solution for this problem on windows using 64 bit java ?

Thanks in advance
Serpil


iPhone'umdan gönderildi
Dikkat: Bu elektronik posta mesaji kisisel ve ozeldir. Eger size gonderilmediyse lutfen gondericiyi bilgilendirip mesaji siliniz.Firmamiza gelen ve giden mesajlar virus taramasindan gecirilmektedir. Mesajdaki gorusler gondericiye ait olup HAVELSAN A.S. resmi gorusu olmak zorunda degildir. Attention: This e-mail message is private and privileged.If you are not the recipient for whom this e-mail message is intended, please notify the sender immediately and delete this e-mail message from your system.All sent and received e-mail messages go through a virus scan. Any opinions presented in this e-mail message are solely those of the author and do not necessarily represent HAVELSAN A.S.`s formal and authorized views.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161031/27bd169f/attachment.html>

From howard at hobu.co  Mon Oct 31 10:18:05 2016
From: howard at hobu.co (Howard Butler)
Date: Mon, 31 Oct 2016 12:18:05 -0500
Subject: [gdal-dev] Motion: adopt RFC 65: IETF RFC7946 GeoJSON
In-Reply-To: <201610291502.43594.even.rouault@spatialys.com>
References: <201610291502.43594.even.rouault@spatialys.com>
Message-ID: <26E50C11-C7AA-416C-8B78-3F734019394B@hobu.co>


> On Oct 29, 2016, at 8:02 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> I move to formally adopt RFC 65: IETF RFC7946 GeoJSON
> 
> https://trac.osgeo.org/gdal/wiki/rfc65_rfc7946_geojson
> 
> The implementation has been committed into trunk the past days.
> 
> -------
> 
> Starting with my +1

+1 

Howard

From dmorissette at mapgears.com  Mon Oct 31 12:53:33 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon, 31 Oct 2016 15:53:33 -0400
Subject: [gdal-dev] Motion: adopt RFC 65: IETF RFC7946 GeoJSON
In-Reply-To: <201610291502.43594.even.rouault@spatialys.com>
References: <201610291502.43594.even.rouault@spatialys.com>
Message-ID: <621ab207-7f97-5721-8508-8b11c8db62fc@mapgears.com>

+1

Daniel

On 2016-10-29 9:02 AM, Even Rouault wrote:
> Hi,
>
> I move to formally adopt RFC 65: IETF RFC7946 GeoJSON
>
> https://trac.osgeo.org/gdal/wiki/rfc65_rfc7946_geojson
>
> The implementation has been committed into trunk the past days.
>
> -------
>
> Starting with my +1
>
> Even
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

