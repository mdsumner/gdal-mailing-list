From daetalusun at gmail.com  Wed May  1 01:40:39 2013
From: daetalusun at gmail.com (Alexander Sun)
Date: Wed, 1 May 2013 16:40:39 +0800
Subject: [gdal-dev] New idea for Gsoc, any suggestions?
Message-ID: <CAJYHJk_3iAw94WksAWw=cqJqhBJchWyweTZZWxmqWC9Mq=78AA@mail.gmail.com>

Hi there,
I want to participate the Gsoc, my idea is port GDAL API to Go language.
Because there has no mature GDAL-GO binding exits.

My plan is use Cgo to implement C-like API in Go first. Then change to
SWIG and implements C++ like API.(Currently, swig-2.0.9 not support Go
on Windows).

Any suggestions are welcome!

Alex

From even.rouault at mines-paris.org  Wed May  1 02:52:30 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 1 May 2013 11:52:30 +0200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <48E640BA-0BD7-4D07-AD12-3101F4EE8E02@mac.com>
References: <2FE71558-30D7-4CA3-A540-F9D4C7A5AFFC@mac.com>
	<B254502A-B75B-49DB-B94F-9CD8D4040734@mac.com>
	<48E640BA-0BD7-4D07-AD12-3101F4EE8E02@mac.com>
Message-ID: <201305011152.30779.even.rouault@mines-paris.org>

Le mercredi 01 mai 2013 01:29:30, Peter Bunting a ?crit :
> Hi All,
> 
> Sam and I have prepared an RFC for our proposal for improving raster
> attribute table (RAT) support and put it on the trac.
> 
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
> 
> We'd be keen to here feedback on our proposal.
> 

Peter,

Here are my observations and questions :

* Is the boolean data type really necessary ? There will be a difficulty with 
the associated C bindings since 'bool' isn't a C type, but a C++ one.

* I'm not sure about what you meant with "The CSLString type will be used for 
reading and writing strings". You probably meant the CPLString C++ class right 
? I'm not sure how this would fly with ValuesIO(GDALRWFlag eRWFlag, int iField, 
int iStartRow, int iLength, char **papszStrList). This is probably just an 
implementation detail.
Related to that, when eRWFlag == GF_Read, you will probably need to document 
that only the papszStrList array must be allocated with a size of iLength * 
sizeof(char*) bytes, and that the papszStrList[i] values that will be set in 
it will be allocated with the CPL allocation routines. So users will be 
responsible to clear the values with CPLFree().

* For the HFA specialized implementation, I guess you would override almost 
all methods of GDALRasterAttributeTable, and that you wouldn't use the 
"std::vector<GDALRasterAttributeField> aoFields" member variable for example 
since you don't want the size of anValues/adfValues/aosValues arrays of 
GDALRasterAttributeField to go out of control.
So perhaps a better design would be to completely remove the private members 
of GDALRasterAttributeTable to make it an abstract class. The current 
implementation, with the private member variables, would go to a 
GDALDefaultRasterAttributeTable that would extend GDALRasterAttributeTable 
(like HFARasterAttributeTable would do).
This would have of course some backward compatibility implications, especially 
for C++ users, since GDALRasterAttributeTable would be no longer instanciable 
(GDALDefaultRasterAttributeTable would), but I don't believe this would cause 
much churn in existing user code bases, and would have only some limited 
implication in GDAL code base. The C function GDALCreateRasterAttributeTable() 
could be preserved and return an instance of GDALDefaultRasterAttributeTable.

* If your purpose is to address huge RATs, I'm not sure about what we can do 
with the Serialize() method, which is for example used by the PAM mechanism 
when translating datasets to formats that don't support natively RATs. Perhaps 
in the case the RAT is detected to be large to be reasonably serialized (for 
example 10 MB ?), this method could just return NULL (some check should be 
done in the existing GDAL code base to see if we are robust to NULL being 
returned. I can see at least that CPLAddXMLChild( psTree, psPam->poDefaultRAT-
>Serialize() ) at line 209 of gdalpamrasterband.cpp would need some care)

* In a similar situation (huge RAT), I'm not sure what the Clone() method 
would do. GDALPamRasterBand::SetDefaultRAT() uses Clone() on that passed RAT 
object.http://trac.osgeo.org/gdal/attachment/ticket/4903/4903.4.diff would do 
the same on VRTRasterBand::SetDefaultRAT(). IdrisiRasterBand::SetDefaultRAT() 
does that too. Perhaps that HFARasterAttributeTable::Clone() could return a 
self-contained immutable copy of itself (i.e. it could survive the destruction 
of the HFADataset object of the source RAT). Perhaps only in the huge RAT 
case. In other cases, it could return a GDALDefaultRasterAttributeTable object 
with all columns and rows in memory, that could be potentially modified by 
calling code. Hum, that seems to be complicated...

In the SetDefaultRAT() use case, the use of Clone() is not meant at getting a 
free-standing copy of the source object that can be altered, but rather to be 
independant from the life cycle of the passed object. Would be probably better 
addressed with some shared pointer mechanism, but the implication would be 
really too huge and go well beyond changes in RAT management...

* Not linked with your proposal, but I noticed that gdal_rat.h exposes methods 
that are not implemented, like GetRowMin(), GetRowMax(), GetColorOfValue(). 
Your work could be the opportunity to clean that by removing them.

* Just a detail: In the current state of your proposal, "The proposed 
additions will have an impact on C binary compatibility because they change 
the API" would be better rephrased as "The proposed additions will extend the 
C API" (there's no compatibility problem since it is backward compatible).

* I'd like to see a mention of extending the Python autotest suite to test the 
new API, both for their default implementation and specialized implementation 
in the HFA driver.

Best regards,

Even

From even.rouault at mines-paris.org  Wed May  1 03:45:02 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 1 May 2013 12:45:02 +0200
Subject: [gdal-dev] Anyone interested in mentoring my project?
In-Reply-To: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
References: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
Message-ID: <201305011245.02423.even.rouault@mines-paris.org>

Le mardi 30 avril 2013 21:55:05, Jorge Ar?valo a ?crit :
> Hello,
> 
> I've applied as student to Google Summer of Code, with this project
> (GDAL/OGR on the web):
> http://www.google-melange.com/gsoc/proposal/review/google/gsoc2013/jorgear
> evalo/10002
> 
> The project has no assigned mentor on the ideas page
> (http://trac.osgeo.org/gdal/wiki/SummerOfCode). So, is anyone interested
> in mentoring it?

Hi Jorge,

(Not applying myself as a mentor for now. Just a few thoughts)

I skimmed through your proposal and was wondering if there's not an overlap 
with what is provided by the OGC WPS standard. Did you consider this ?  
http://en.wikipedia.org/wiki/Web_Processing_Service will lead you to the 
standard, exiting WPS server implementations, client-side javascript 
frameworks, etc...

Some aspects of your proposal (particularly about uploading data, etc...) made 
me also remind of the OpenAerialMap effort ( http://openaerialmap.org/Main_Page 
), but it is currently stalled. I believe the main issue was storage 
capability and bandwidth price, but the mailing list seem no longer reachable.

Even

From lhomme.xavier at gmail.com  Wed May  1 07:00:40 2013
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Wed, 1 May 2013 16:00:40 +0200
Subject: [gdal-dev] NITF with MultiDataSet
Message-ID: <CACqzBMxA8GTd5OZxTx71udd=FQH=hKj79oRR=Ryhi5CUfvEEZQ@mail.gmail.com>

Hi
I try to load a NITF with multidataset into ArcGIS Desktop . But ArcGIS
tells me that there is no spatial reference in my file.
Then I check with gdalinfo which tells me that my file is referenced with
WGS84.

Then I try to convert the file with gdal in GeoTiff format
I'm using gdal 1.9.2 and try to convert a NITF with multidataset into a
GeoTiFF file.
I'm using ns3361c.tif downloaded from
http://www.gwg.nga.mil/ntb/baseline/software/testfile/Nitfv2_1/scen_2_1.htmlas
a sample.

I try :
gdalwarp NITF_IM:0:ns3361nc.nsf test.tif
gdalwarp NITF_IM:1:ns3361nc.nsf test.tif
gdalwarp NITF_IM:2:ns3361nc.nsf test.tif
gdalwarp NITF_IM:3:ns3361nc.nsf test.tif

the online doc of gdalwarp explains : Mosaicing into an existing output
file is supported if the output file already exists.

but the result test.tif doesn't conains all subdataset.

Thanks in advance.

xlhomme
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130501/f8a6b00a/attachment.html>

From jorgearevalo at libregis.org  Wed May  1 07:52:16 2013
From: jorgearevalo at libregis.org (=?utf-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed, 1 May 2013 16:52:16 +0200
Subject: [gdal-dev] Anyone interested in mentoring my project?
In-Reply-To: <201305011245.02423.even.rouault@mines-paris.org>
References: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
	<201305011245.02423.even.rouault@mines-paris.org>
Message-ID: <63538DD2CFCB4DB89818C5DAD01B87A4@libregis.org>

Hello Even,

First of all, many thanks for your thoughts and references. I need experts' point of view.  

El mi?rcoles 1 de mayo de 2013 a las 12:45, Even Rouault escribi?:

> Le mardi 30 avril 2013 21:55:05, Jorge Ar?valo a ?crit :
> > Hello,
> >  
> > I've applied as student to Google Summer of Code, with this project
> > (GDAL/OGR on the web):
> > http://www.google-melange.com/gsoc/proposal/review/google/gsoc2013/jorgear
> > evalo/10002
> >  
> > The project has no assigned mentor on the ideas page
> > (http://trac.osgeo.org/gdal/wiki/SummerOfCode). So, is anyone interested
> > in mentoring it?
>  
>  
>  
> Hi Jorge,
>  
> (Not applying myself as a mentor for now. Just a few thoughts)
>  
> I skimmed through your proposal and was wondering if there's not an overlap  
> with what is provided by the OGC WPS standard. Did you consider this ?  
> http://en.wikipedia.org/wiki/Web_Processing_Service will lead you to the  
> standard, exiting WPS server implementations, client-side javascript  
> frameworks, etc...
>  
Yes, the idea is very similar. But while WPS focuses on standardization and interoperability (OGC style), I'd like to focus on user's experience. Fast & beauty, even if not standard. The concept under products like Mapbox or CartoDB.

> Some aspects of your proposal (particularly about uploading data, etc...) made  
> me also remind of the OpenAerialMap effort ( http://openaerialmap.org/Main_Page  
> ), but it is currently stalled. I believe the main issue was storage  
> capability and bandwidth price, but the mailing list seem no longer reachable.
>  
Really interesting. I'll have a look. Many thanks for that too.
  
>  
> Even

Best regards,  
Jorge


From tclarke at ball.com  Wed May  1 08:22:35 2013
From: tclarke at ball.com (Clarke, Trevor)
Date: Wed, 1 May 2013 11:22:35 -0400
Subject: [gdal-dev] NITF with MultiDataSet
In-Reply-To: <CACqzBMxA8GTd5OZxTx71udd=FQH=hKj79oRR=Ryhi5CUfvEEZQ@mail.gmail.com>
References: <CACqzBMxA8GTd5OZxTx71udd=FQH=hKj79oRR=Ryhi5CUfvEEZQ@mail.gmail.com>
Message-ID: <873043AF54FE794B912B616ABA7E9FE50DB3ABB0@daytonmsg2k3.AERO.BALL.COM>

Try building a vrt with the NITF datasets.

http://www.gdal.org/gdal_vrttut.html

 

----------------------

Trevor R.H. Clarke

Software Engineer, Ball Aerospace

(937)320-7087

 

From: gdal-dev-bounces at lists.osgeo.org
[mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of xavier lhomme
Sent: Wednesday, May 01, 2013 10:01 AM
To: gdal-dev
Subject: [gdal-dev] NITF with MultiDataSet

 

Hi 

I try to load a NITF with multidataset into ArcGIS Desktop . But ArcGIS
tells me that there is no spatial reference in my file. 

Then I check with gdalinfo which tells me that my file is referenced
with WGS84. 

 

Then I try to convert the file with gdal in GeoTiff format 

I'm using gdal 1.9.2 and try to convert a NITF with multidataset into a
GeoTiFF file.

I'm using ns3361c.tif downloaded from
http://www.gwg.nga.mil/ntb/baseline/software/testfile/Nitfv2_1/scen_2_1.
html
<https://urldefense.proofpoint.com/v1/url?u=http://www.gwg.nga.mil/ntb/b
aseline/software/testfile/Nitfv2_1/scen_2_1.html&k=1GMYaKjmAz8SrwAdnQ9kl
A%3D%3D%0A&r=Ho639Wn0LQPE3P8SnMqwUA%3D%3D%0A&m=fXmXsze96dRFEt%2FSg8aGVjX
F5CVqZ0uiDT2S5Dj1Fr8%3D%0A&s=5b21c39e547e7065be604564da1e4018edfa136e518
1cb66ad1087d5b6f8b0af>  as a sample.

 

I try : 

gdalwarp NITF_IM:0:ns3361nc.nsf test.tif

gdalwarp NITF_IM:1:ns3361nc.nsf test.tif

gdalwarp NITF_IM:2:ns3361nc.nsf test.tif

gdalwarp NITF_IM:3:ns3361nc.nsf test.tif

 

the online doc of gdalwarp explains : Mosaicing into an existing output
file is supported if the output file already exists.

 

but the result test.tif doesn't conains all subdataset. 

 

Thanks in advance. 

 

xlhomme

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130501/68afdab7/attachment-0001.html>

From nik at nikosalexandris.net  Wed May  1 15:30:57 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 02 May 2013 01:30:57 +0300
Subject: [gdal-dev] GoogleEarth wont read KML files created by ogr2ogr:
	Unknown element <Schema>
Message-ID: <455831543.5BRkjBY56i@vertikal>

Hi!

I work with GDAL 1.9.2, compiled from source with support for expat and KML 
under Kubuntu 12.10.  Any attempt to convert a(ny) shapefile (be it of type 
point or polygon) using ogr2ogr (or exporting from GRASS GIS or/and QGIS -- 
all based on the same GDAL librairies) results in a .kml file that Google-
Earth (version 7. ) wont read with the "excuse": Unknown element <Schema>.

Even the example KML file over at 
<https://developers.google.com/kml/articles/vector> is rejected by GE with the 
same error message.

Removing the <Schema> entries altogether, makes the file readable by GE.

Anyhow, GE reads without problems a KML example (that includes Schema 
elements) to be found over at 
<https://developers.google.com/kml/documentation/extendeddata> (look for the 
Example under "Adding Typed Data to a Feature").

What are the odds?

Thank you, Nikos
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 230 bytes
Desc: This is a digitally signed message part.
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/d6c9b361/attachment.pgp>

From warmerdam at pobox.com  Wed May  1 15:40:14 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 1 May 2013 15:40:14 -0700
Subject: [gdal-dev] GoogleEarth wont read KML files created by ogr2ogr:
 Unknown element <Schema>
In-Reply-To: <455831543.5BRkjBY56i@vertikal>
References: <455831543.5BRkjBY56i@vertikal>
Message-ID: <CA+YzLBeK3uh0DrvfdMgcig9G1VVYJ=Ug=1AtrObhzZ5kEz222A@mail.gmail.com>

Nikos,

Could you file a ticket, and attach a working and nonworking kml example?

Any idea if this behavior varies across versions of google earth?  I wonder
if libkml can read the file(s) ok.

Best regards,
Frank


On Wed, May 1, 2013 at 3:30 PM, Nikos Alexandris <nik at nikosalexandris.net>wrote:

> Hi!
>
> I work with GDAL 1.9.2, compiled from source with support for expat and KML
> under Kubuntu 12.10.  Any attempt to convert a(ny) shapefile (be it of type
> point or polygon) using ogr2ogr (or exporting from GRASS GIS or/and QGIS --
> all based on the same GDAL librairies) results in a .kml file that Google-
> Earth (version 7. ) wont read with the "excuse": Unknown element <Schema>.
>
> Even the example KML file over at
> <https://developers.google.com/kml/articles/vector> is rejected by GE
> with the
> same error message.
>
> Removing the <Schema> entries altogether, makes the file readable by GE.
>
> Anyhow, GE reads without problems a KML example (that includes Schema
> elements) to be found over at
> <https://developers.google.com/kml/documentation/extendeddata> (look for
> the
> Example under "Adding Typed Data to a Feature").
>
> What are the odds?
>
> Thank you, Nikos
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130501/bf529fa6/attachment.html>

From peifer at gmx.eu  Wed May  1 17:07:46 2013
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed, 01 May 2013 21:07:46 -0300
Subject: [gdal-dev] GoogleEarth wont read KML files created by ogr2ogr:
 Unknown element <Schema>
In-Reply-To: <CA+YzLBeK3uh0DrvfdMgcig9G1VVYJ=Ug=1AtrObhzZ5kEz222A@mail.gmail.com>
References: <455831543.5BRkjBY56i@vertikal>
	<CA+YzLBeK3uh0DrvfdMgcig9G1VVYJ=Ug=1AtrObhzZ5kEz222A@mail.gmail.com>
Message-ID: <5181AE52.8090508@gmx.eu>


FYI, some 4 years ago, I reported an XML schema validation error related 
to the <Schema> element: http://trac.osgeo.org/gdal/ticket/2858. IIRC, 
the explanation at the time was that there are some limitations with the 
kml driver and "the real solution is to switch to libkml..."

Hermann


On 2013-05-01 19:40, Frank Warmerdam wrote:
> Nikos,
>
> Could you file a ticket, and attach a working and nonworking kml example?
>
> Any idea if this behavior varies across versions of google earth?  I
> wonder if libkml can read the file(s) ok.
>
> Best regards,
> Frank
>
>
> On Wed, May 1, 2013 at 3:30 PM, Nikos Alexandris
> <nik at nikosalexandris.net <mailto:nik at nikosalexandris.net>> wrote:
>
>     Hi!
>
>     I work with GDAL 1.9.2, compiled from source with support for expat
>     and KML
>     under Kubuntu 12.10.  Any attempt to convert a(ny) shapefile (be it
>     of type
>     point or polygon) using ogr2ogr (or exporting from GRASS GIS or/and
>     QGIS --
>     all based on the same GDAL librairies) results in a .kml file that
>     Google-
>     Earth (version 7. ) wont read with the "excuse": Unknown element
>     <Schema>.
>
>     Even the example KML file over at
>     <https://developers.google.com/kml/articles/vector> is rejected by
>     GE with the
>     same error message.
>
>     Removing the <Schema> entries altogether, makes the file readable by GE.
>
>     Anyhow, GE reads without problems a KML example (that includes Schema
>     elements) to be found over at
>     <https://developers.google.com/kml/documentation/extendeddata> (look
>     for the
>     Example under "Adding Typed Data to a Feature").
>
>     What are the odds?
>
>     Thank you, Nikos
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com <mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From tyler.mitchell at actian.com  Wed May  1 20:27:24 2013
From: tyler.mitchell at actian.com (Tyler Mitchell)
Date: Wed, 1 May 2013 20:27:24 -0700
Subject: [gdal-dev] Anyone interested in mentoring my project?
In-Reply-To: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
References: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
Message-ID: <03E57B01-B15D-4524-8045-651A8E64B6BD@actian.com>

Jorge,

While I'm not really an ideal mentor, I really like the idea.  I hope you can find someone!

Tyler

On 2013-04-30, at 12:55 PM, Jorge Ar?valo wrote:

> Hello, 
> 
> I've applied as student to Google Summer of Code, with this project (GDAL/OGR on the web): http://www.google-melange.com/gsoc/proposal/review/google/gsoc2013/jorgearevalo/10002
> 
> The project has no assigned mentor on the ideas page (http://trac.osgeo.org/gdal/wiki/SummerOfCode). So, is anyone interested in mentoring it?
> 
> Best regards, 
> 
> -- 
> Jorge Arevalo
> Freelance developer
> 
> http://www.krop.com/jorgearevalo
> http://about.me/jorgeas80
> 
> Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



Tyler Mitchell
Engineering Director 
Actian Corporation
tyler.mitchell at actian.com

MOBILE 250-303-1831
SKYPE spatialguru
www.actian.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130501/740335d8/attachment.html>

From nik at nikosalexandris.net  Thu May  2 00:09:53 2013
From: nik at nikosalexandris.net (Nikos Alexandris)
Date: Thu, 02 May 2013 10:09:53 +0300
Subject: [gdal-dev] GoogleEarth wont read KML files created by ogr2ogr:
	Unknown element <Schema>
In-Reply-To: <CA+YzLBeK3uh0DrvfdMgcig9G1VVYJ=Ug=1AtrObhzZ5kEz222A@mail.gmail.com>
References: <455831543.5BRkjBY56i@vertikal>
	<CA+YzLBeK3uh0DrvfdMgcig9G1VVYJ=Ug=1AtrObhzZ5kEz222A@mail.gmail.com>
Message-ID: <2121950.hBFY90CDZT@vertikal>

Frank Warmerdam wrote:

> Could you file a ticket, and attach a working and nonworking kml example?

Done.

> Any idea if this behavior varies across versions of google earth?

Not between ver. 6 and 7 under (K)Ubuntu at least.

> I wonder if libkml can read the file(s) ok.

As usual, lack of time and I (maybe wrongly) "suspect" that getting libkml 
from SVN integrated in GDAL(-stable) is not easy.

Thank you, Nikos

[rest deleted]

From rveciana at gmail.com  Thu May  2 03:22:48 2013
From: rveciana at gmail.com (Roger Veciana i Rovira)
Date: Thu, 2 May 2013 12:22:48 +0200
Subject: [gdal-dev] Polygon simplification using the borders to preserve
	topology
Message-ID: <CAJx2no=sqyqaB6ReE0EuYovQ9SA5TgVii+WrN_QPsrSBnMuESw@mail.gmail.com>

Hello,

I have the a shapefile full of polygons, and* *I want to simplify them,
preserving the points they share.
ogr2ogr -simplify simplifies each polygon independently, so the borders
don't fit properly.
Is there a way to do this with GDAL? TopoJSON format(
https://github.com/mbostock/topojson), for instance, uses the shared
segments instead of the polygons, and simplifies them well, but I prefer to
use GDAL.

Thank you

Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/15aafb33/attachment-0001.html>

From blaurent at heurisis.eu  Thu May  2 08:27:47 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Thu, 02 May 2013 17:27:47 +0200
Subject: [gdal-dev] Adding labels / specifying styles
Message-ID: <518285F3.2040801@heurisis.eu>

Hello,

I am a newbie with GDAL and OGR.

I managed to create a shapefile following the provided sample : 
http://www.gdal.org/ogr/ogr_apitut.html.

The shapefile contains points. Now, I would like to associate labels to 
my points. I also wish to specify the size, the color of my points. Is 
it possible ? How ?

Thank you very much in advance for your help.

Beno?t

From jorgearevalo at libregis.org  Thu May  2 08:33:47 2013
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Thu, 2 May 2013 17:33:47 +0200
Subject: [gdal-dev] Anyone interested in mentoring my project?
In-Reply-To: <03E57B01-B15D-4524-8045-651A8E64B6BD@actian.com>
References: <7BF6582664C242F2BBFB3A4102DCB4ED@libregis.org>
	<03E57B01-B15D-4524-8045-651A8E64B6BD@actian.com>
Message-ID: <CAMhtMNMPMvhPrk_8yNL7sUeCv7DP0pfPMBa3C7CXZG9ZNQGx+w@mail.gmail.com>

Hello Tyler,

Thanks for your words!

Best regards,

Jorge


On Thu, May 2, 2013 at 5:27 AM, Tyler Mitchell <tyler.mitchell at actian.com>wrote:

> Jorge,
>
> While I'm not really an ideal mentor, I really like the idea.  I hope you
> can find someone!
>
> Tyler
>
> On 2013-04-30, at 12:55 PM, Jorge Ar?valo wrote:
>
> Hello,
>
> I've applied as student to Google Summer of Code, with this project
> (GDAL/OGR on the web):
> http://www.google-melange.com/gsoc/proposal/review/google/gsoc2013/jorgearevalo/10002
>
> The project has no assigned mentor on the ideas page (
> http://trac.osgeo.org/gdal/wiki/SummerOfCode). So, is anyone interested
> in mentoring it?
>
> Best regards,
>
> --
> Jorge Arevalo
> Freelance developer
>
> http://www.krop.com/jorgearevalo
> http://about.me/jorgeas80
>
> Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> *Tyler Mitchell***
> Engineering Director
> Actian Corporation
> *tyler.mitchell at actian.com
> *
> MOBILE 250-303-1831
> SKYPE spatialguru
> www.actian.com
>
>


-- 
Jorge Arevalo
Freelance developer

http://www.krop.com/jorgearevalo
http://about.me/jorgeas80
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/45abcb3d/attachment.html>

From alexandre.gacon+gdal at gmail.com  Thu May  2 08:38:26 2013
From: alexandre.gacon+gdal at gmail.com (Alexandre Gacon)
Date: Thu, 2 May 2013 17:38:26 +0200
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <518285F3.2040801@heurisis.eu>
References: <518285F3.2040801@heurisis.eu>
Message-ID: <CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>

Hi,

The shapefile format is not a format who supports styles and labels. It is
a data only format. So you can not associate labels to your points. You can
at most add a column with a text.

Regards
Alexandre


2013/5/2 Beno?t Laurent <blaurent at heurisis.eu>

> Hello,
>
> I am a newbie with GDAL and OGR.
>
> I managed to create a shapefile following the provided sample :
> http://www.gdal.org/ogr/ogr_**apitut.html<http://www.gdal.org/ogr/ogr_apitut.html>
> .
>
> The shapefile contains points. Now, I would like to associate labels to my
> points. I also wish to specify the size, the color of my points. Is it
> possible ? How ?
>
> Thank you very much in advance for your help.
>
> Beno?t
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



-- 
Alexandre Gacon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/f811d646/attachment.html>

From blaurent at heurisis.eu  Thu May  2 08:45:52 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Thu, 02 May 2013 17:45:52 +0200
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
Message-ID: <51828A30.9020707@heurisis.eu>

Thank you for your quick answer.
> Hi,
>
> The shapefile format is not a format who supports styles and labels. 
> It is a data only format. So you can not associate labels to your 
> points. You can at most add a column with a text.
That's what I have already done indeed.

After that, I am importing my shapefiles in QGis. Maybe, I should create 
my labels using a Python script based on the added text column ?

Regards,

Beno?t


From tyler.mitchell at actian.com  Thu May  2 08:46:29 2013
From: tyler.mitchell at actian.com (Tyler Mitchell)
Date: Thu, 2 May 2013 08:46:29 -0700
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
Message-ID: <7E7F17E3-7FAA-4018-9E17-EA4F95626EA5@actian.com>

Once you've got the data stored in the table, you can then use desktop mapping products like QGIS (http://qgis.org) to use those columns to fuel labelling on your maps.   I highly recommend you checkout QGIS for your next steps.

Tyler

On 2013-05-02, at 8:38 AM, Alexandre Gacon wrote:

> Hi,
> 
> The shapefile format is not a format who supports styles and labels. It is a data only format. So you can not associate labels to your points. You can at most add a column with a text.
> 
> Regards
> Alexandre
> 
> 
> 2013/5/2 Beno?t Laurent <blaurent at heurisis.eu>
> Hello,
> 
> I am a newbie with GDAL and OGR.
> 
> I managed to create a shapefile following the provided sample : http://www.gdal.org/ogr/ogr_apitut.html.
> 
> The shapefile contains points. Now, I would like to associate labels to my points. I also wish to specify the size, the color of my points. Is it possible ? How ?
> 
> Thank you very much in advance for your help.
> 
> Beno?t
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Alexandre Gacon
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



Tyler Mitchell
Engineering Director 
Actian Corporation
tyler.mitchell at actian.com

MOBILE 250-303-1831
SKYPE spatialguru
www.actian.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/800ed271/attachment-0001.html>

From tyler.mitchell at actian.com  Thu May  2 08:47:18 2013
From: tyler.mitchell at actian.com (Tyler Mitchell)
Date: Thu, 2 May 2013 08:47:18 -0700
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <51828A30.9020707@heurisis.eu>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<51828A30.9020707@heurisis.eu>
Message-ID: <7A51B464-F6AD-4516-BBC4-B688D655B6EB@actian.com>


On 2013-05-02, at 8:45 AM, Beno?t Laurent wrote:

> After that, I am importing my shapefiles in QGis. Maybe, I should create my labels using a Python script based on the added text column ?

You shouldn't have to use Python to draw labels, there are capabilities in the properties for each layer in QGIS that allow you to select which column to use for the label text.  It's really simple :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/c1a01fd6/attachment.html>

From blaurent at heurisis.eu  Thu May  2 08:53:18 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Thu, 02 May 2013 17:53:18 +0200
Subject: [gdal-dev] [SPAM?]:  Re:  Adding labels / specifying styles
In-Reply-To: <7A51B464-F6AD-4516-BBC4-B688D655B6EB@actian.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<51828A30.9020707@heurisis.eu>
	<7A51B464-F6AD-4516-BBC4-B688D655B6EB@actian.com>
Message-ID: <51828BEE.4060305@heurisis.eu>

Thank you for your answer.
>
> On 2013-05-02, at 8:45 AM, Beno?t Laurent wrote:
>
>> After that, I am importing my shapefiles in QGis. Maybe, I should 
>> create my labels using a Python script based on the added text column ?
>
> You shouldn't have to use Python to draw labels, there are 
> capabilities in the properties for each layer in QGIS that allow you 
> to select which column to use for the label text.  It's really simple :)
Indeed, I managed to do this manually. It perfectly works.

However, I deal with a great number of files and I would like to 
accelerate the process. That is why I am asking for a script based 
solution. I can already import all my shapefiles with a Python script. I 
would like to indicate which column to use as label.

Regards,

Beno?t
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/d4ec8ba4/attachment.html>

From tyler.mitchell at actian.com  Thu May  2 09:06:10 2013
From: tyler.mitchell at actian.com (Tyler Mitchell)
Date: Thu, 2 May 2013 09:06:10 -0700
Subject: [gdal-dev] [SPAM?]:  Re:  Adding labels / specifying styles
In-Reply-To: <51828BEE.4060305@heurisis.eu>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<51828A30.9020707@heurisis.eu>
	<7A51B464-F6AD-4516-BBC4-B688D655B6EB@actian.com>
	<51828BEE.4060305@heurisis.eu>
Message-ID: <06D2CC22-2830-4ABB-A100-091214934760@actian.com>

> However, I deal with a great number of files and I would like to accelerate the process. That is why I am asking for a script based solution. I can already import all my shapefiles with a Python script. I would like to indicate which column to use as label.

I see... perhaps you could look at creating QGIS project files directly.  Once you know the pattern you should be able to automate what you need, as the file is just XML and you can create one manually and inspect it.  I look forward to hearing what you figure out.

Tyler

From jukka.rahkonen at mmmtike.fi  Thu May  2 09:29:09 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 2 May 2013 16:29:09 +0000 (UTC)
Subject: [gdal-dev] Adding labels / specifying styles
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
Message-ID: <loom.20130502T182317-678@post.gmane.org>

Alexandre Gacon <alexandre.gacon+gdal <at> gmail.com> writes:

> 
> 
> Hi,
> The shapefile format is not a format who supports styles and labels. It is
a data only format. So you can not associate labels to your points. You can
at most add a column with a text.

It is true, but not the whole truth. GDAL does understand certain kind of
attributes as drawing styles, see http://www.gdal.org/ogr/ogr_feature_style.html
However, I am not sure if QGIS can utilize them automatically. This document
contains some examples which should prove that it is possible to associate
labels to points and even more
http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf.

-Jukka Rahkonen-


From doug_newcomb at fws.gov  Thu May  2 09:56:45 2013
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Thu, 2 May 2013 12:56:45 -0400
Subject: [gdal-dev] [SPAM?]: Re: Adding labels / specifying styles
In-Reply-To: <06D2CC22-2830-4ABB-A100-091214934760@actian.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<51828A30.9020707@heurisis.eu>
	<7A51B464-F6AD-4516-BBC4-B688D655B6EB@actian.com>
	<51828BEE.4060305@heurisis.eu>
	<06D2CC22-2830-4ABB-A100-091214934760@actian.com>
Message-ID: <CALQGVr0E2ScP05REUHjGS3e2CSbAjdSFkkhOz3dyCMbQGxBJ4w@mail.gmail.com>

Benoit,
The Atlas plugin for qgis 1.8.0 , http://plugins.qgis.org/plugins/atlas/ ,
might do what you want.  It's in the offiicial repository.

Doug


On Thu, May 2, 2013 at 12:06 PM, Tyler Mitchell
<tyler.mitchell at actian.com>wrote:

> > However, I deal with a great number of files and I would like to
> accelerate the process. That is why I am asking for a script based
> solution. I can already import all my shapefiles with a Python script. I
> would like to indicate which column to use as label.
>
> I see... perhaps you could look at creating QGIS project files directly.
>  Once you know the pattern you should be able to automate what you need, as
> the file is just XML and you can create one manually and inspect it.  I
> look forward to hearing what you figure out.
>
> Tyler
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/0a359f92/attachment-0001.html>

From CABO at NIRAS.DK  Thu May  2 13:47:33 2013
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Thu, 2 May 2013 20:47:33 +0000
Subject: [gdal-dev] Polygonize + 8conn => self intersection?
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805351A1CB9@allkexa1.NIRAS.INT>

Hi all.

I've got a simple question. When using GDAL Polygonize with 8-connectivity on two diagonal pixels (the X's) like this:

X +
+ X

Does this lead to a single polygon with self intersection or a multipolygon with two single polygons?

It seems to give me a single polygon regardless of the geometry type of the output layer.

Regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/f536331d/attachment.html>

From chris_lawrence at partech.com  Thu May  2 14:46:22 2013
From: chris_lawrence at partech.com (Chris Lawrence)
Date: Thu, 2 May 2013 17:46:22 -0400
Subject: [gdal-dev] Unable to access GDAL_DATA directory on Android
Message-ID: <78BB25DC8E187B43BFEEB74CB0AF695604D61542@beasley.PARCorp.Local>

I am developing an Android-based GDAL application.  I have successfully
built GDAL v1.9.2 and the SWIG-based Java bindings using the
instructions provided on the building GDAL page.  I am able to register
the drivers and load a dataset in my application, however, I am unable
to initialize a SpatialReference using an EPSG code (4326).  I have
placed the contents of gdal/data at /sdcard/gdal on the device; I have
tried both gdal.SetConfigOption("GDAL_DATA", "/sdcard/gdal") as well as
gdal.PushFinderLocation("/sdcard/gdal").  If anyone has experience using
GDAL on Android and has encountered and resolved this situation
previously, your insight would be greatly appreciated.
 
Thanks,
 
-chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130502/df5e49e1/attachment.html>

From gillingham.sam at gmail.com  Thu May  2 15:18:29 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Fri, 3 May 2013 10:18:29 +1200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
Message-ID: <CAMH-RbYQQrwS4L0OVWeE66w0zYOGqEN-9AUPCEbVeP200KKbjw@mail.gmail.com>

Thanks Ivan,

We explicitly referenced the HFA driver as this is one which is
commonly used and we are familiar with the source code having
submitted a number of patches for the driver.

We plan to provide default implementations of the new functions which
will call the existing Get/Set functions (note the change so all
functions are virtual) so all existing drivers will support the new
functions but without the potential performance benefit. This also
means we won't be breaking existing code, other than requiring a
recompile due to the change to virtual functions.

Unfortunately, we don't know much about the the other drivers you
refer to so would suggest it would be best for the developers of those
drivers to update them in due course if they feel it is necessary and
would provide a significant benefit over the default implementation
which will be provided.

Best wishes,

Sam and Pete

From gillingham.sam at gmail.com  Thu May  2 15:23:48 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Fri, 3 May 2013 10:23:48 +1200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
Message-ID: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>

Hi Evan,

Response to your points below:

1) Good point about bool not being available in C. How about making
this an 8 bit int instead? The idea was to be able to express
True/False values without using a whole integer, thus saving space. We
included it in case future drivers support it.

2) I was meaning the CSL* family of functions from cpl_string.h since
the CPLString class won't be available from C so the 'char
**papszStrList' parameter will be manipulated with these functions.
Your suggestion of only the list being allocated and ValuesIO()
allocating the strings themselves make sense and will be incorporated
in the RFC.

3) Yes this would be cleaner - I will modify the RFC to include
GDALDefaultRasterAttributeTable.

4,5) regarding Clone() and Serialize(). Maybe these functions should
be unsupported for GDALRasterAttributeTable? We are trying to get the
RAT support on a similar footing to bands (eg. reading/writing the
data on demand and not holding all data in memory, plus being able to
access whole chunks at once). AFAIK the Band object does not support
Clone and Serialize and our feeling is that neither should the RAT
class. Perhaps the proposed derived GDALDefaultRasterAttributeTable
would have Clone() and Serialize() to support existing code (and it
can because it holds all the data in memory)?

6) Yes this is a good opportunity to remove unimplemented functions.

7) The wording is incorrect and will be changed.

8) Agreed.

We will make the changes to the RFC.

Sam and Pete


------------------------------

Message: 2
Date: Wed, 1 May 2013 11:52:30 +0200
From: Even Rouault <even.rouault at mines-paris.org>
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL Raster Attribute Tables.
Message-ID: <201305011152.30779.even.rouault at mines-paris.org>
Content-Type: Text/Plain;  charset="utf-8"

Le mercredi 01 mai 2013 01:29:30, Peter Bunting a ?crit :
> Hi All,
>
> Sam and I have prepared an RFC for our proposal for improving raster
> attribute table (RAT) support and put it on the trac.
>
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> We'd be keen to here feedback on our proposal.
>

Peter,

Here are my observations and questions :

* Is the boolean data type really necessary ? There will be a difficulty with
the associated C bindings since 'bool' isn't a C type, but a C++ one.

* I'm not sure about what you meant with "The CSLString type will be used for
reading and writing strings". You probably meant the CPLString C++ class right
? I'm not sure how this would fly with ValuesIO(GDALRWFlag eRWFlag, int iField,
int iStartRow, int iLength, char **papszStrList). This is probably just an
implementation detail.
Related to that, when eRWFlag == GF_Read, you will probably need to document
that only the papszStrList array must be allocated with a size of iLength *
sizeof(char*) bytes, and that the papszStrList[i] values that will be set in
it will be allocated with the CPL allocation routines. So users will be
responsible to clear the values with CPLFree().

* For the HFA specialized implementation, I guess you would override almost
all methods of GDALRasterAttributeTable, and that you wouldn't use the
"std::vector<
GDALRasterAttributeField> aoFields" member variable for example
since you don't want the size of anValues/adfValues/aosValues arrays of
GDALRasterAttributeField to go out of control.
So perhaps a better design would be to completely remove the private members
of GDALRasterAttributeTable to make it an abstract class. The current
implementation, with the private member variables, would go to a
GDALDefaultRasterAttributeTable that would extend GDALRasterAttributeTable
(like HFARasterAttributeTable would do).
This would have of course some backward compatibility implications, especially
for C++ users, since GDALRasterAttributeTable would be no longer instanciable
(GDALDefaultRasterAttributeTable would), but I don't believe this would cause
much churn in existing user code bases, and would have only some limited
implication in GDAL code base. The C function GDALCreateRasterAttributeTable()
could be preserved and return an instance of GDALDefaultRasterAttributeTable.

* If your purpose is to address huge RATs, I'm not sure about what we can do
with the Serialize() method, which is for example used by the PAM mechanism
when translating datasets to formats that don't support natively RATs. Perhaps
in the case the RAT is detected to be large to be reasonably serialized (for
example 10 MB ?), this method could just return NULL (some check should be
done in the existing GDAL code base to see if we are robust to NULL being
returned. I can see at least that CPLAddXMLChild( psTree, psPam->poDefaultRAT-
>Serialize() ) at line 209 of gdalpamrasterband.cpp would need some care)

* In a similar situation (huge RAT), I'm not sure what the Clone() method
would do. GDALPamRasterBand::SetDefaultRAT() uses Clone() on that passed RAT
object.http://trac.osgeo.org/gdal/attachment/ticket/4903/4903.4.diff would do
the same on VRTRasterBand::SetDefaultRAT(). IdrisiRasterBand::SetDefaultRAT()
does that too. Perhaps that HFARasterAttributeTable::Clone() could return a
self-contained immutable copy of itself (i.e. it could survive the destruction
of the HFADataset object of the source RAT). Perhaps only in the huge RAT
case. In other cases, it could return a GDALDefaultRasterAttributeTable object
with all columns and rows in memory, that could be potentially modified by
calling code. Hum, that seems to be complicated...

In the SetDefaultRAT() use case, the use of Clone() is not meant at getting a
free-standing copy of the source object that can be altered, but rather to be
independant from the life cycle of the passed object. Would be probably better
addressed with some shared pointer mechanism, but the implication would be
really too huge and go well beyond changes in RAT management...

* Not linked with your proposal, but I noticed that gdal_rat.h exposes methods
that are not implemented, like GetRowMin(), GetRowMax(), GetColorOfValue().
Your work could be the opportunity to clean that by removing them.

* Just a detail: In the current state of your proposal, "The proposed
additions will have an impact on C binary compatibility because they change
the API" would be better rephrased as "The proposed additions will extend the
C API" (there's no compatibility problem since it is backward compatible).

* I'd like to see a mention of extending the Python autotest suite to test the
new API, both for their default implementation and specialized implementation
in the HFA driver.

Best regards,

Even

From even.rouault at mines-paris.org  Thu May  2 16:32:43 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 3 May 2013 01:32:43 +0200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
References: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
Message-ID: <201305030132.43289.even.rouault@mines-paris.org>

Le vendredi 03 mai 2013 00:23:48, Sam Gillingham a ?crit :
> Hi Evan,
> 
> Response to your points below:
> 
> 1) Good point about bool not being available in C. How about making
> this an 8 bit int instead? The idea was to be able to express
> True/False values without using a whole integer, thus saving space. We
> included it in case future drivers support it.

According to http://stackoverflow.com/questions/4897844/is-sizeofbool-
implementation-defined-in-c , sizeof(bool) is not necessarily 1 (even if I 
guess that 99% of the compilers define it as such). If you want the 1 byte 
guarantee, then perhaps use the CPL GByte type (which resolves to unsigned 
char) for both the C and C++ parts.

> 
> 2) I was meaning the CSL* family of functions from cpl_string.h since
> the CPLString class won't be available from C so the 'char
> **papszStrList' parameter will be manipulated with these functions.

Ah ok, but that wouldn't have worked for the read case. You would have needed 
to pass a pointer to **papszStrList. So a ***ppapszStrList. Kind of ugly.

> Your suggestion of only the list being allocated and ValuesIO()
> allocating the strings themselves make sense and will be incorporated
> in the RFC.
> 
> 3) Yes this would be cleaner - I will modify the RFC to include
> GDALDefaultRasterAttributeTable.

This point is certainly the most important change that would be done with this 
RFC.

> 
> 4,5) regarding Clone() and Serialize(). Maybe these functions should
> be unsupported for GDALRasterAttributeTable?

You mean defined in the interface and return NULL pointers, or perhaps pure 
virutal methods ?

> We are trying to get the
> RAT support on a similar footing to bands (eg. reading/writing the
> data on demand and not holding all data in memory, plus being able to
> access whole chunks at once). AFAIK the Band object does not support
> Clone and Serialize and our feeling is that neither should the RAT
> class.

So that would mean that the translation of a HFA with a RAT to another format 
only supporting PAM RAT would fail, even for modest size source HFA RATs ? 
That could be seen as a functional regression. Not that I care that much 
personnaly about RATs, but perhaps others do. Actually that would go against 
the effort lead in http://trac.osgeo.org/gdal/ticket/4903. This might require 
some coordination with Robert and Toby.

> Perhaps the proposed derived GDALDefaultRasterAttributeTable
> would have Clone() and Serialize() to support existing code (and it
> can because it holds all the data in memory)?

Agreed

> 
> 6) Yes this is a good opportunity to remove unimplemented functions.
> 
> 7) The wording is incorrect and will be changed.
> 
> 8) Agreed.

Another point I'm thinking is that, if your RFC is the first one implemented 
for GDAL 2.0, we should initiate a MIGRATION_GUIDE.TXT file to list all the 
source incompatibilities with the 1.X versions and how to address them. For 
example, for that RFC, that GDALRasterAttributeTable is no longer 
instanciable, and that GDALDefaultRasterAttributeTable should be used to get 
the same functionality as of pre 2.0 version, etc..

> 
> We will make the changes to the RFC.
> 
> Sam and Pete
> 
> 
> ------------------------------
> 
> Message: 2
> Date: Wed, 1 May 2013 11:52:30 +0200
> From: Even Rouault <even.rouault at mines-paris.org>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL Raster Attribute Tables.
> Message-ID: <201305011152.30779.even.rouault at mines-paris.org>
> Content-Type: Text/Plain;  charset="utf-8"
> 
> Le mercredi 01 mai 2013 01:29:30, Peter Bunting a ?crit :
> > Hi All,
> > 
> > Sam and I have prepared an RFC for our proposal for improving raster
> > attribute table (RAT) support and put it on the trac.
> > 
> > http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
> > 
> > We'd be keen to here feedback on our proposal.
> 
> Peter,
> 
> Here are my observations and questions :
> 
> * Is the boolean data type really necessary ? There will be a difficulty
> with the associated C bindings since 'bool' isn't a C type, but a C++ one.
> 
> * I'm not sure about what you meant with "The CSLString type will be used
> for reading and writing strings". You probably meant the CPLString C++
> class right ? I'm not sure how this would fly with ValuesIO(GDALRWFlag
> eRWFlag, int iField, int iStartRow, int iLength, char **papszStrList).
> This is probably just an implementation detail.
> Related to that, when eRWFlag == GF_Read, you will probably need to
> document that only the papszStrList array must be allocated with a size of
> iLength * sizeof(char*) bytes, and that the papszStrList[i] values that
> will be set in it will be allocated with the CPL allocation routines. So
> users will be responsible to clear the values with CPLFree().
> 
> * For the HFA specialized implementation, I guess you would override almost
> all methods of GDALRasterAttributeTable, and that you wouldn't use the
> "std::vector<
> GDALRasterAttributeField> aoFields" member variable for example
> since you don't want the size of anValues/adfValues/aosValues arrays of
> GDALRasterAttributeField to go out of control.
> So perhaps a better design would be to completely remove the private
> members of GDALRasterAttributeTable to make it an abstract class. The
> current implementation, with the private member variables, would go to a
> GDALDefaultRasterAttributeTable that would extend GDALRasterAttributeTable
> (like HFARasterAttributeTable would do).
> This would have of course some backward compatibility implications,
> especially for C++ users, since GDALRasterAttributeTable would be no
> longer instanciable (GDALDefaultRasterAttributeTable would), but I don't
> believe this would cause much churn in existing user code bases, and would
> have only some limited implication in GDAL code base. The C function
> GDALCreateRasterAttributeTable() could be preserved and return an instance
> of GDALDefaultRasterAttributeTable.
> 
> * If your purpose is to address huge RATs, I'm not sure about what we can
> do with the Serialize() method, which is for example used by the PAM
> mechanism when translating datasets to formats that don't support natively
> RATs. Perhaps in the case the RAT is detected to be large to be reasonably
> serialized (for example 10 MB ?), this method could just return NULL (some
> check should be done in the existing GDAL code base to see if we are
> robust to NULL being returned. I can see at least that CPLAddXMLChild(
> psTree, psPam->poDefaultRAT-
> 
> >Serialize() ) at line 209 of gdalpamrasterband.cpp would need some care)
> 
> * In a similar situation (huge RAT), I'm not sure what the Clone() method
> would do. GDALPamRasterBand::SetDefaultRAT() uses Clone() on that passed
> RAT object.http://trac.osgeo.org/gdal/attachment/ticket/4903/4903.4.diff
> would do the same on VRTRasterBand::SetDefaultRAT().
> IdrisiRasterBand::SetDefaultRAT() does that too. Perhaps that
> HFARasterAttributeTable::Clone() could return a self-contained immutable
> copy of itself (i.e. it could survive the destruction of the HFADataset
> object of the source RAT). Perhaps only in the huge RAT case. In other
> cases, it could return a GDALDefaultRasterAttributeTable object with all
> columns and rows in memory, that could be potentially modified by calling
> code. Hum, that seems to be complicated...
> 
> In the SetDefaultRAT() use case, the use of Clone() is not meant at getting
> a free-standing copy of the source object that can be altered, but rather
> to be independant from the life cycle of the passed object. Would be
> probably better addressed with some shared pointer mechanism, but the
> implication would be really too huge and go well beyond changes in RAT
> management...
> 
> * Not linked with your proposal, but I noticed that gdal_rat.h exposes
> methods that are not implemented, like GetRowMin(), GetRowMax(),
> GetColorOfValue(). Your work could be the opportunity to clean that by
> removing them.
> 
> * Just a detail: In the current state of your proposal, "The proposed
> additions will have an impact on C binary compatibility because they change
> the API" would be better rephrased as "The proposed additions will extend
> the C API" (there's no compatibility problem since it is backward
> compatible).
> 
> * I'd like to see a mention of extending the Python autotest suite to test
> the new API, both for their default implementation and specialized
> implementation in the HFA driver.
> 
> Best regards,
> 
> Even
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From gillingham.sam at gmail.com  Thu May  2 21:37:26 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Fri, 3 May 2013 16:37:26 +1200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <201305030132.43289.even.rouault@mines-paris.org>
References: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
	<201305030132.43289.even.rouault@mines-paris.org>
Message-ID: <CAMH-Rbb9Loc322h-0ircXFYscbK-zSWtmOWz3mrCN5mdq-0y-w@mail.gmail.com>

Hi Even,

Another alternative that will have less impact on existing code and
behaviour may be to leave GetDefatultRAT and SetDefaultRAT as they are (ie
returning an in-memory representation of the attribute table -
GDALRasterAttributeTable). This means existing code can Clone() and
Serialize() etc.

We could then have another function on GDALRasterBand (eg GetRAT()) that
returns the virtual base class version ('GDALIORasterAttributeTable'), if
supported by the driver. We don't need a SetRAT() as the intention is that
all modifications to the returned object are written to disc. Applications
could call GetRAT() first to see if they can use the 'new' way, or drop
back to GetDefaultRAT if they can't (memory permitting).

GDALRasterAttributeTable doesn't need to be derived from
GDALIORasterAttributeTable (although it could be). We could have a way of
converting a GDALRasterAttributeTable to a GDALIORasterAttributeTable
(maybe an alternate constructor of GDALRasterAttributeTable).

Would this be a more acceptable proposal?

Sam.

On 3 May 2013 11:32, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le vendredi 03 mai 2013 00:23:48, Sam Gillingham a ?crit :
> > Hi Evan,
> >
> > Response to your points below:
> >
> > 1) Good point about bool not being available in C. How about making
> > this an 8 bit int instead? The idea was to be able to express
> > True/False values without using a whole integer, thus saving space. We
> > included it in case future drivers support it.
>
> According to http://stackoverflow.com/questions/4897844/is-sizeofbool-
> implementation-defined-in-c<http://stackoverflow.com/questions/4897844/is-sizeofbool-implementation-defined-in-c>, sizeof(bool) is not necessarily 1 (even if I
> guess that 99% of the compilers define it as such). If you want the 1 byte
> guarantee, then perhaps use the CPL GByte type (which resolves to unsigned
> char) for both the C and C++ parts.
>
> >
> > 2) I was meaning the CSL* family of functions from cpl_string.h since
> > the CPLString class won't be available from C so the 'char
> > **papszStrList' parameter will be manipulated with these functions.
>
> Ah ok, but that wouldn't have worked for the read case. You would have
> needed
> to pass a pointer to **papszStrList. So a ***ppapszStrList. Kind of ugly.
>
> > Your suggestion of only the list being allocated and ValuesIO()
> > allocating the strings themselves make sense and will be incorporated
> > in the RFC.
> >
> > 3) Yes this would be cleaner - I will modify the RFC to include
> > GDALDefaultRasterAttributeTable.
>
> This point is certainly the most important change that would be done with
> this
> RFC.
>
> >
> > 4,5) regarding Clone() and Serialize(). Maybe these functions should
> > be unsupported for GDALRasterAttributeTable?
>
> You mean defined in the interface and return NULL pointers, or perhaps pure
> virutal methods ?
>
> > We are trying to get the
> > RAT support on a similar footing to bands (eg. reading/writing the
> > data on demand and not holding all data in memory, plus being able to
> > access whole chunks at once). AFAIK the Band object does not support
> > Clone and Serialize and our feeling is that neither should the RAT
> > class.
>
> So that would mean that the translation of a HFA with a RAT to another
> format
> only supporting PAM RAT would fail, even for modest size source HFA RATs ?
> That could be seen as a functional regression. Not that I care that much
> personnaly about RATs, but perhaps others do. Actually that would go
> against
> the effort lead in http://trac.osgeo.org/gdal/ticket/4903. This might
> require
> some coordination with Robert and Toby.
>
> > Perhaps the proposed derived GDALDefaultRasterAttributeTable
> > would have Clone() and Serialize() to support existing code (and it
> > can because it holds all the data in memory)?
>
> Agreed
>
> >
> > 6) Yes this is a good opportunity to remove unimplemented functions.
> >
> > 7) The wording is incorrect and will be changed.
> >
> > 8) Agreed.
>
> Another point I'm thinking is that, if your RFC is the first one
> implemented
> for GDAL 2.0, we should initiate a MIGRATION_GUIDE.TXT file to list all the
> source incompatibilities with the 1.X versions and how to address them. For
> example, for that RFC, that GDALRasterAttributeTable is no longer
> instanciable, and that GDALDefaultRasterAttributeTable should be used to
> get
> the same functionality as of pre 2.0 version, etc..
>
> >
> > We will make the changes to the RFC.
> >
> > Sam and Pete
> >
> >
> > ------------------------------
> >
> > Message: 2
> > Date: Wed, 1 May 2013 11:52:30 +0200
> > From: Even Rouault <even.rouault at mines-paris.org>
> > To: gdal-dev at lists.osgeo.org
> > Subject: Re: [gdal-dev] GDAL Raster Attribute Tables.
> > Message-ID: <201305011152.30779.even.rouault at mines-paris.org>
> > Content-Type: Text/Plain;  charset="utf-8"
> >
> > Le mercredi 01 mai 2013 01:29:30, Peter Bunting a ?crit :
> > > Hi All,
> > >
> > > Sam and I have prepared an RFC for our proposal for improving raster
> > > attribute table (RAT) support and put it on the trac.
> > >
> > > http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
> > >
> > > We'd be keen to here feedback on our proposal.
> >
> > Peter,
> >
> > Here are my observations and questions :
> >
> > * Is the boolean data type really necessary ? There will be a difficulty
> > with the associated C bindings since 'bool' isn't a C type, but a C++
> one.
> >
> > * I'm not sure about what you meant with "The CSLString type will be used
> > for reading and writing strings". You probably meant the CPLString C++
> > class right ? I'm not sure how this would fly with ValuesIO(GDALRWFlag
> > eRWFlag, int iField, int iStartRow, int iLength, char **papszStrList).
> > This is probably just an implementation detail.
> > Related to that, when eRWFlag == GF_Read, you will probably need to
> > document that only the papszStrList array must be allocated with a size
> of
> > iLength * sizeof(char*) bytes, and that the papszStrList[i] values that
> > will be set in it will be allocated with the CPL allocation routines. So
> > users will be responsible to clear the values with CPLFree().
> >
> > * For the HFA specialized implementation, I guess you would override
> almost
> > all methods of GDALRasterAttributeTable, and that you wouldn't use the
> > "std::vector<
> > GDALRasterAttributeField> aoFields" member variable for example
> > since you don't want the size of anValues/adfValues/aosValues arrays of
> > GDALRasterAttributeField to go out of control.
> > So perhaps a better design would be to completely remove the private
> > members of GDALRasterAttributeTable to make it an abstract class. The
> > current implementation, with the private member variables, would go to a
> > GDALDefaultRasterAttributeTable that would extend
> GDALRasterAttributeTable
> > (like HFARasterAttributeTable would do).
> > This would have of course some backward compatibility implications,
> > especially for C++ users, since GDALRasterAttributeTable would be no
> > longer instanciable (GDALDefaultRasterAttributeTable would), but I don't
> > believe this would cause much churn in existing user code bases, and
> would
> > have only some limited implication in GDAL code base. The C function
> > GDALCreateRasterAttributeTable() could be preserved and return an
> instance
> > of GDALDefaultRasterAttributeTable.
> >
> > * If your purpose is to address huge RATs, I'm not sure about what we can
> > do with the Serialize() method, which is for example used by the PAM
> > mechanism when translating datasets to formats that don't support
> natively
> > RATs. Perhaps in the case the RAT is detected to be large to be
> reasonably
> > serialized (for example 10 MB ?), this method could just return NULL
> (some
> > check should be done in the existing GDAL code base to see if we are
> > robust to NULL being returned. I can see at least that CPLAddXMLChild(
> > psTree, psPam->poDefaultRAT-
> >
> > >Serialize() ) at line 209 of gdalpamrasterband.cpp would need some care)
> >
> > * In a similar situation (huge RAT), I'm not sure what the Clone() method
> > would do. GDALPamRasterBand::SetDefaultRAT() uses Clone() on that passed
> > RAT object.http://trac.osgeo.org/gdal/attachment/ticket/4903/4903.4.diff
> > would do the same on VRTRasterBand::SetDefaultRAT().
> > IdrisiRasterBand::SetDefaultRAT() does that too. Perhaps that
> > HFARasterAttributeTable::Clone() could return a self-contained immutable
> > copy of itself (i.e. it could survive the destruction of the HFADataset
> > object of the source RAT). Perhaps only in the huge RAT case. In other
> > cases, it could return a GDALDefaultRasterAttributeTable object with all
> > columns and rows in memory, that could be potentially modified by calling
> > code. Hum, that seems to be complicated...
> >
> > In the SetDefaultRAT() use case, the use of Clone() is not meant at
> getting
> > a free-standing copy of the source object that can be altered, but rather
> > to be independant from the life cycle of the passed object. Would be
> > probably better addressed with some shared pointer mechanism, but the
> > implication would be really too huge and go well beyond changes in RAT
> > management...
> >
> > * Not linked with your proposal, but I noticed that gdal_rat.h exposes
> > methods that are not implemented, like GetRowMin(), GetRowMax(),
> > GetColorOfValue(). Your work could be the opportunity to clean that by
> > removing them.
> >
> > * Just a detail: In the current state of your proposal, "The proposed
> > additions will have an impact on C binary compatibility because they
> change
> > the API" would be better rephrased as "The proposed additions will extend
> > the C API" (there's no compatibility problem since it is backward
> > compatible).
> >
> > * I'd like to see a mention of extending the Python autotest suite to
> test
> > the new API, both for their default implementation and specialized
> > implementation in the HFA driver.
> >
> > Best regards,
> >
> > Even
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130503/18f5a193/attachment.html>

From blaurent at heurisis.eu  Fri May  3 00:24:29 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Fri, 03 May 2013 09:24:29 +0200
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <loom.20130502T182317-678@post.gmane.org>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
Message-ID: <5183662D.2000907@heurisis.eu>

Le 02/05/2013 18:29, Jukka Rahkonen a ?crit :
> Alexandre Gacon <alexandre.gacon+gdal <at> gmail.com> writes:
>
>>
>> Hi,
>> The shapefile format is not a format who supports styles and labels. It is
> a data only format. So you can not associate labels to your points. You can
> at most add a column with a text.
>
> It is true, but not the whole truth. GDAL does understand certain kind of
> attributes as drawing styles,
I had searched in that direction, more precisely in the OGR API 
documentation : http://www.gdal.org/ogr/classOGRStyleTool.html. However, 
I was stuck as I did not know to which objects the styles has to be 
applied. I was looking for some samples.

At that point, I have the choice between different solutions:
1) using the Atlas plugin ;
2) coming back to my first idea of using OGR ;
3) trying to examine the way Qgis projects are generated ;
4) writing a python script.

The easiest solution seems to be the first one... In the long term, I 
would prefer the second one.

I shall tell you my choice.

Regards,

Beno?t


From even.rouault at mines-paris.org  Fri May  3 01:18:50 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 03 May 2013 10:18:50 +0200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <CAMH-Rbb9Loc322h-0ircXFYscbK-zSWtmOWz3mrCN5mdq-0y-w@mail.gmail.com>
References: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
	<201305030132.43289.even.rouault@mines-paris.org>
	<CAMH-Rbb9Loc322h-0ircXFYscbK-zSWtmOWz3mrCN5mdq-0y-w@mail.gmail.com>
Message-ID: <1367569130.518372ea55681@imp.free.fr>

Selon Sam Gillingham <gillingham.sam at gmail.com>:

> Hi Even,
>
> Another alternative that will have less impact on existing code and
> behaviour may be to leave GetDefatultRAT and SetDefaultRAT as they are (ie
> returning an in-memory representation of the attribute table -
> GDALRasterAttributeTable). This means existing code can Clone() and
> Serialize() etc.
>
> We could then have another function on GDALRasterBand (eg GetRAT()) that
> returns the virtual base class version ('GDALIORasterAttributeTable'), if
> supported by the driver. We don't need a SetRAT() as the intention is that
> all modifications to the returned object are written to disc. Applications
> could call GetRAT() first to see if they can use the 'new' way, or drop
> back to GetDefaultRAT if they can't (memory permitting).
>
> GDALRasterAttributeTable doesn't need to be derived from
> GDALIORasterAttributeTable (although it could be). We could have a way of
> converting a GDALRasterAttributeTable to a GDALIORasterAttributeTable
> (maybe an alternate constructor of GDALRasterAttributeTable).
>
> Would this be a more acceptable proposal?

Hi Sam,

I didn't want to mean that the previous proposal was not acceptable. I was just
underlying that it had consequences a bit larger than the original scope of the
RFC, without being a complete revolution. I'd be interested if FrankW could
share his views on this, his being the author of the RAT mechanism.

I'm not entirely convinced by the above alternate proposal. Seems a bit
confusing from the user point of view : "should I use GetRAT() or
GetDefaultRAT() ?". And I've not well understood how
GDALRasterAttributeTable and GDALIORasterAttributeTable would relate. Both would
be available in the C++ API ? We should try to keep it as simple as possible
IMHO.

To go back on the first idea - GDALRasterAttributeTable being an abstract class,
GDALDefaultRasterAttributeTable deriving it to implement the functionnality of
1.X GDALRasterAttributeTable, and a HFARasterAttributeTable, specialized version
of GDALRasterAttributeTable implementing the ValuesIO() methods -, how would it
be complicated to have Clone() and Serialize() to work in
HFARasterAttributeTable only if the RAT is of reasonable size (e.g. product of
GetRowCount() * GetColCount() < 1 000 000) ?  Clone() could
return a GDALDefaultRasterAttributeTable. Actually, Clone() could be lazily
implemented as a "return new
GDALDefaultRasterAttributeTable()->Deserialize(Serialize())" (with the
appropriate check if Serialize() returns NULL).

Even

From doug_newcomb at fws.gov  Fri May  3 04:50:54 2013
From: doug_newcomb at fws.gov (Newcomb, Doug)
Date: Fri, 3 May 2013 07:50:54 -0400
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <5183662D.2000907@heurisis.eu>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
	<5183662D.2000907@heurisis.eu>
Message-ID: <CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>

Benoit,
 You can also script plotting in GRASS ,
http://grasswiki.osgeo.org/wiki/Ps.map_scripts

Doug


On Fri, May 3, 2013 at 3:24 AM, Beno?t Laurent <blaurent at heurisis.eu> wrote:

> Le 02/05/2013 18:29, Jukka Rahkonen a ?crit :
>
>  Alexandre Gacon <alexandre.gacon+gdal <at> gmail.com> writes:
>>
>>
>>> Hi,
>>> The shapefile format is not a format who supports styles and labels. It
>>> is
>>>
>> a data only format. So you can not associate labels to your points. You
>> can
>> at most add a column with a text.
>>
>> It is true, but not the whole truth. GDAL does understand certain kind of
>> attributes as drawing styles,
>>
> I had searched in that direction, more precisely in the OGR API
> documentation : http://www.gdal.org/ogr/**classOGRStyleTool.html<http://www.gdal.org/ogr/classOGRStyleTool.html>.
> However, I was stuck as I did not know to which objects the styles has to
> be applied. I was looking for some samples.
>
> At that point, I have the choice between different solutions:
> 1) using the Atlas plugin ;
> 2) coming back to my first idea of using OGR ;
> 3) trying to examine the way Qgis projects are generated ;
> 4) writing a python script.
>
> The easiest solution seems to be the first one... In the long term, I
> would prefer the second one.
>
> I shall tell you my choice.
>
> Regards,
>
> Beno?t
>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



-- 
Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb at fws.gov
---------------------------------------------------------------------------------------------------------
The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of the
Interior.   Life is too short for undocumented, proprietary data formats.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130503/cc49883f/attachment.html>

From blaurent at heurisis.eu  Fri May  3 05:51:24 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Fri, 03 May 2013 14:51:24 +0200
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <loom.20130502T182317-678@post.gmane.org>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
Message-ID: <5183B2CC.9000209@heurisis.eu>

Hello,
> It is true, but not the whole truth. GDAL does understand certain kind of
> attributes as drawing styles, see http://www.gdal.org/ogr/ogr_feature_style.html
> However, I am not sure if QGIS can utilize them automatically.
I tried to use OGR but failed until now :-(. I can specify a style in my 
c++ code but it is ignored when opening the shapefiles with QGIS.

This post 
(http://osgeo-org.1560.x6.nabble.com/MapInfo-tab-files-td4378592.html) 
suggests that QGIS don't care about OGR styles. The post is 1 year old. 
The issue may have been treated since ?

Beno?t


From blaurent at heurisis.eu  Fri May  3 06:04:07 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Fri, 03 May 2013 15:04:07 +0200
Subject: [gdal-dev] Adding labels / specifying styles
In-Reply-To: <CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
	<5183662D.2000907@heurisis.eu>
	<CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
Message-ID: <5183B5C7.3000107@heurisis.eu>

Le 03/05/2013 13:50, Newcomb, Doug a ?crit :
> Benoit,
>  You can also script plotting in GRASS , 
> http://grasswiki.osgeo.org/wiki/Ps.map_scripts
I must admit that I don't know anything about GRASS...

I was proposed different solutions. For the moment, the Atlas plugin 
does not meet my needs (but will be helpful for other tasks). I also 
failed with OGR. In both cases, I may have missed something. However, I 
am thinking of writing a Python script...

Beno?t


From gillingham.sam at gmail.com  Sat May  4 20:01:17 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Sun, 5 May 2013 15:01:17 +1200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <1367569130.518372ea55681@imp.free.fr>
References: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
	<201305030132.43289.even.rouault@mines-paris.org>
	<CAMH-Rbb9Loc322h-0ircXFYscbK-zSWtmOWz3mrCN5mdq-0y-w@mail.gmail.com>
	<1367569130.518372ea55681@imp.free.fr>
Message-ID: <CAMH-RbYRcxD4Q7n_wFyJd4-fVdDsZZTjKPbtVpxot0hdF-4HAg@mail.gmail.com>

Hi Even, Frank etc,

I have updated the RFC to incorporate the comments from this thread.

http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support

Let me know if there is anything else that needs to be addressed, or if I
have missed anything.

Thanks,
Sam.


On 3 May 2013 20:18, Even Rouault <even.rouault at mines-paris.org> wrote:

> Selon Sam Gillingham <gillingham.sam at gmail.com>:
>
> > Hi Even,
> >
> > Another alternative that will have less impact on existing code and
> > behaviour may be to leave GetDefatultRAT and SetDefaultRAT as they are
> (ie
> > returning an in-memory representation of the attribute table -
> > GDALRasterAttributeTable). This means existing code can Clone() and
> > Serialize() etc.
> >
> > We could then have another function on GDALRasterBand (eg GetRAT()) that
> > returns the virtual base class version ('GDALIORasterAttributeTable'), if
> > supported by the driver. We don't need a SetRAT() as the intention is
> that
> > all modifications to the returned object are written to disc.
> Applications
> > could call GetRAT() first to see if they can use the 'new' way, or drop
> > back to GetDefaultRAT if they can't (memory permitting).
> >
> > GDALRasterAttributeTable doesn't need to be derived from
> > GDALIORasterAttributeTable (although it could be). We could have a way of
> > converting a GDALRasterAttributeTable to a GDALIORasterAttributeTable
> > (maybe an alternate constructor of GDALRasterAttributeTable).
> >
> > Would this be a more acceptable proposal?
>
> Hi Sam,
>
> I didn't want to mean that the previous proposal was not acceptable. I was
> just
> underlying that it had consequences a bit larger than the original scope
> of the
> RFC, without being a complete revolution. I'd be interested if FrankW could
> share his views on this, his being the author of the RAT mechanism.
>
> I'm not entirely convinced by the above alternate proposal. Seems a bit
> confusing from the user point of view : "should I use GetRAT() or
> GetDefaultRAT() ?". And I've not well understood how
> GDALRasterAttributeTable and GDALIORasterAttributeTable would relate. Both
> would
> be available in the C++ API ? We should try to keep it as simple as
> possible
> IMHO.
>
> To go back on the first idea - GDALRasterAttributeTable being an abstract
> class,
> GDALDefaultRasterAttributeTable deriving it to implement the
> functionnality of
> 1.X GDALRasterAttributeTable, and a HFARasterAttributeTable, specialized
> version
> of GDALRasterAttributeTable implementing the ValuesIO() methods -, how
> would it
> be complicated to have Clone() and Serialize() to work in
> HFARasterAttributeTable only if the RAT is of reasonable size (e.g.
> product of
> GetRowCount() * GetColCount() < 1 000 000) ?  Clone() could
> return a GDALDefaultRasterAttributeTable. Actually, Clone() could be lazily
> implemented as a "return new
> GDALDefaultRasterAttributeTable()->Deserialize(Serialize())" (with the
> appropriate check if Serialize() returns NULL).
>
> Even
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130505/f67503c5/attachment.html>

From ari.jolma at gmail.com  Sun May  5 07:57:05 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 05 May 2013 17:57:05 +0300
Subject: [gdal-dev] Metadata in OGR classes?
Message-ID: <51867341.40108@gmail.com>

Hi,

On the GDAL side there is the MajorObject class, which adds metadata to 
GDAL classes and objects like Datasets. On OGR side there is no such 
thing, AFAIK. Some OGR classes have a TestCapability method, which can 
in principle support arbitrary capabilities, but there is no method, 
which would return class or object related information.

For example a geotiff that I have returns four TIFFTAG_xxx keys and 
respective values when I open it into a GDAL Dataset.

The reason I was looking for metadata method in OGR is that in some GUI 
code I want to support generic and interactive creation of OGR 
DataSources. For this purpose I've added to the OGR Driver class a 
method DataSourceTemplate(1). This is in Perl code and outside of GDAL, 
I use the Driver class from the bindings. The DataSourceTemplate method 
returns a string, which can be used to create a dialog box for asking 
arguments for the data source from the user. For example a GeoJSON 
driver returns the string "<URL>[@<username>:][<password>]". This tells 
the GUI code that a dialog box is needed which asks from the user a URL 
and optionally username and password. Of course mostly the template is 
simply <filename> and for database, GeoJSON, WFS and some other drivers 
it is something else.

I was thinking that this kind of additional information would be best 
available as metadata.

Any thoughts on these?

Ari

1) 
https://github.com/ajolma/geoinformatica/blob/master/Geo-Vector/lib/Geo/Vector/Layer.pm 
(from line 794 onwards)


From even.rouault at mines-paris.org  Sun May  5 09:52:35 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 5 May 2013 18:52:35 +0200
Subject: [gdal-dev] Metadata in OGR classes?
In-Reply-To: <51867341.40108@gmail.com>
References: <51867341.40108@gmail.com>
Message-ID: <201305051852.35917.even.rouault@mines-paris.org>

Le dimanche 05 mai 2013 16:57:05, Ari Jolma a ?crit :
> Hi,
> 
> On the GDAL side there is the MajorObject class, which adds metadata to
> GDAL classes and objects like Datasets. On OGR side there is no such
> thing, AFAIK. Some OGR classes have a TestCapability method, which can
> in principle support arbitrary capabilities, but there is no method,
> which would return class or object related information.
> 
> For example a geotiff that I have returns four TIFFTAG_xxx keys and
> respective values when I open it into a GDAL Dataset.
> 
> The reason I was looking for metadata method in OGR is that in some GUI
> code I want to support generic and interactive creation of OGR
> DataSources. For this purpose I've added to the OGR Driver class a
> method DataSourceTemplate(1). This is in Perl code and outside of GDAL,
> I use the Driver class from the bindings. The DataSourceTemplate method
> returns a string, which can be used to create a dialog box for asking
> arguments for the data source from the user. For example a GeoJSON
> driver returns the string "<URL>[@<username>:][<password>]". This tells
> the GUI code that a dialog box is needed which asks from the user a URL
> and optionally username and password. Of course mostly the template is
> simply <filename> and for database, GeoJSON, WFS and some other drivers
> it is something else.
> 
> I was thinking that this kind of additional information would be best
> available as metadata.
> 
> Any thoughts on these?

On the GDAL site we have creation options that indicate options available for 
Create() and CreateCopy() methods. Something similar for connexion strings 
could be useful indeed.

Unfortunately OGR is currently orphaned in terms of metadata. If it is 
reconciled with GDAL, I guess that OGRSFDriver, OGRDataSource and OGRLayer 
classes could inherit from GDALMajorObject to expose metadata capabilities.

> 
> Ari
> 
> 1)
> https://github.com/ajolma/geoinformatica/blob/master/Geo-Vector/lib/Geo/Vec
> tor/Layer.pm (from line 794 onwards)
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at mines-paris.org  Sun May  5 12:57:45 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 5 May 2013 21:57:45 +0200
Subject: [gdal-dev] GDAL Raster Attribute Tables.
In-Reply-To: <CAMH-RbYRcxD4Q7n_wFyJd4-fVdDsZZTjKPbtVpxot0hdF-4HAg@mail.gmail.com>
References: <CAMH-RbaoRkuhPUq-9eNg93nPXMGCZRra8HwmWyq+=z5E1r7wQg@mail.gmail.com>
	<1367569130.518372ea55681@imp.free.fr>
	<CAMH-RbYRcxD4Q7n_wFyJd4-fVdDsZZTjKPbtVpxot0hdF-4HAg@mail.gmail.com>
Message-ID: <201305052157.45733.even.rouault@mines-paris.org>

Le dimanche 05 mai 2013 05:01:17, Sam Gillingham a ?crit :
> Hi Even, Frank etc,
> 
> I have updated the RFC to incorporate the comments from this thread.
> 
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
> 
> Let me know if there is anything else that needs to be addressed, or if I
> have missed anything.

Sam,

About "The application should use CSLDestroy when finished to deallocate all 
the memory.", this can work, but requires the calling code to do that :

/* Allocate one more element for the NULL string marking the end of array */
char** papszRet = (char**) CPLMalloc(sizeof(char*) * (nLength + 1));
papszRet[nLength] = NULL;
poRAT->ValuesIO(GF_Read, iField, iStartRow, nLength, papszRet);
CSLDestroy(papszRet);

That of course assumes that ValueIO() will never set an element of the array 
to NULL. If so, CSLDestroy() would stop destroying strings at the first 
occurence of a NULL string in the array.

Another possibility would be :

char** papszRet = (char**) CPLMalloc(sizeof(char*) * nLength);
/* ValuesIO() is supposed to initialize all the elements to a valid value, */
/* at least to NULL even/especially if it fails */
poRAT->ValuesIO(GF_Read, iField, iStartRow, nLength, papszRet);
for(i = 0; i < nLength; i++)
    CPLFree(papszRet[i]);
CPLFree(papszRet);

Even

From hellyj at ucsd.edu  Sun May  5 14:04:52 2013
From: hellyj at ucsd.edu (John Helly)
Date: Sun, 05 May 2013 14:04:52 -0700
Subject: [gdal-dev] [GMT4] Messy little problem between GMT4,
	GDAL 1.9.2 and ArcGIS 10
Message-ID: <5186C974.4020703@ucsd.edu>

Hi.

A few years ago I had a problem with GMT/GDAL interactions such that the 
GMT netCDF files were reflected when read into Qgis (for example). This 
was worked around by running it through 'gdal_translate -of GMT'.  There 
was also a discussion about this being a bug in something in GDAL (since 
Qgis was using GDAL if I remember correctly) that was supposed to have 
been fixed in some version (obviously don't remember the details). At 
any rate, it stopped being a problem for me but now something else is 
causing a problem in files that have the following workflow:

--> mbgrid (from MB-System) --> gdal_translate -of GMT --> ArcGIS netCDF 
reader

Now I find that gdal_translate appears to be changing the header in a 
way such that ArcGIS cannot read the netCDF.  The first 'ncdump -h' 
below is what the header looks like before running through 
gdal_translate and the second one is after gdal_translate.

I'm sending this note to MB-System, GMT and GDAL groups since it seems 
like an issue of import to all three.  Any thoughts on this?

J.

=======================================Output from mbgrid before 
gdal_translate ==================================================
ncdump -h MCBCP_BeachModel_UTM11N_Baseline.grdclip.nc
netcdf MCBCP_BeachModel_UTM11N_Baseline.grdclip {
dimensions:
     x = 12626 ;
     y = 12251 ;
variables:
     double x(x) ;
         x:long_name = "Easting (meters)" ;
         x:actual_range = 444057.827834802, 469309.046567392 ;
     double y(y) ;
         y:long_name = "Northing (meters)" ;
         y:actual_range = 3670183.00468016, 3694684.53612513 ;
     float z(y, x) ;
         z:long_name = "Topography (m)" ;
         z:_FillValue = NaNf ;
         z:actual_range = -1995.541015625, 599.818359375 ;

// global attributes:
         :Conventions = "COARDS/CF-1.0" ;
         :title = "Topography Grid" ;
         :history = "grdclip -V 
/media/EXT4_Projects_01/SLR_Data/level1/MCBCP/Basemap/MCBCP_BeachModel_UTM11N_Baseline.grd 
-G/media/EXT4_Projects_01/SLR_Data/level1/MCBCP/Basemap/MCBCP_BeachModel_UTM11N_Baseline.grdclip.nc 
-Sa600/NaN -Sb-2000/NaN" ;
         :description = "\n",
             "\tProjection: UTM11N\n",
             "\tGrid created by mbgrid\n",
             "\tMB-system Version 5.3.1982\n",
             "\tRun by <hellyj> on <StonestepsLinux> at <Thu Apr 25 
19:44:41 2013>" ;
         :GMT_version = "4.5.9_r9909 [64-bit]" ;
}
=====================================Output from mbgrid after 
gdal_translate ====================================================
ncdump -h MCBCP_BeachModel_UTM11N_Baseline.grdclip.flipped.nc
netcdf MCBCP_BeachModel_UTM11N_Baseline.grdclip.flipped {
dimensions:
     side = 2 ;
     xysize = 154681126 ;
variables:
     double x_range(side) ;
         x_range:units = "meters" ;
     double y_range(side) ;
         y_range:units = "meters" ;
     double z_range(side) ;
         z_range:units = "meters" ;
     double spacing(side) ;
     int dimension(side) ;
     float z(xysize) ;
         z:scale_factor = 1. ;
         z:add_offset = 0. ;
         z:node_offset = 1 ;

// global attributes:
         :title = "" ;
         :source = "" ;
}

-- 
John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / stonesteps (Skype) / stonesteps7 (iChat) / http://www.sdsc.edu/~hellyj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130505/effe5e78/attachment.html>

From bertelli at charta.acme.com  Sun May  5 23:43:12 2013
From: bertelli at charta.acme.com (Carlo A. Bertelli (Charta s.r.l.))
Date: Mon, 6 May 2013 08:43:12 +0200
Subject: [gdal-dev] ocr(opus) and ogr
Message-ID: <CALc8-VJOPDCSrOPuXa2gZmaMA_pfD=BHBCOC=LMPb+JUU3M7Gw@mail.gmail.com>

hello,
I had a fairly clean map with street codes, a very good candidate for
optical character recognition, so I tried to recognize it with some of the
available ocr engines and applications, just to try what if.
To my surprise, ocropus (https://code.google.com/p/ocropus/) got something
useful. It's output is an xhtml file with pixel based *coordinates* (may I
add some exclamative marks here?).
Here is an example:
   ?span class="ocr_line" title="bbox 6309 5042 6465 5085"?506V?/span?
I hope I could do something with it.
One great thing could be writing a specialized ocroscript (which is the
command ocropus uses). Ocropus is written in python, so it shouldn't be
impossible.
But even with search and replace I could obtain a reasonable csv/xml file.
The problem is still having to deal with pixel based coordinates. I think
this could be solved with some proj magic, to feed it to ogr2ogr and
voil?...
Being able to deal with pixel based coordinates could enable us to use
basic raster to vector conversion, which is not unuseful.
Could someone help me?
c

-- 
--------------------------------------------------------------------------
Carlo A. Bertelli
   Charta servizi e sistemi per il territorio e la storia ambientale srl
          Dipendenze del palazzo Doria,
          vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
          tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
--------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/d384113f/attachment.html>

From marion.violot at gmail.com  Mon May  6 00:27:13 2013
From: marion.violot at gmail.com (MARION VIOLOT)
Date: Mon, 6 May 2013 09:27:13 +0200
Subject: [gdal-dev] Othogonal projcetion
Message-ID: <CAOo1m6Qpbs9TSBiSB1YMaSGGYU37OTmXYyNYPBhsfYoAshtKeQ@mail.gmail.com>

Dear everyone,

I am new with GDAL-OGR and only need to orthogonally project points on
polyline and then calculate the distance from the projections and the start
point of the polyline (in C++, in a Windows Form Application with Visual
Studio 2008).

I didn't find yet a developed method in GDAL-OGR that enables me to do it.
I would like to know if there is any existing one, or at least one method
that calculates the shorter distance between a point and a polyline? I was
thinking about first understanding and then using the OGR Projections
Tutorial, but it's seems very complicated for doing so little.

Thanks a lot for your time and your help.
Marion.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/a43ccee7/attachment.html>

From robbkwright at gmail.com  Mon May  6 05:03:11 2013
From: robbkwright at gmail.com (Robb K. Wright)
Date: Mon, 06 May 2013 08:03:11 -0400
Subject: [gdal-dev] Creating .ovr files with gdalwarp/lanczos
Message-ID: <51879BFF.2050002@gmail.com>


For my data/data type (8-bit indexed images), the lanczos resampling 
method provides by far the best visual look for overviews ? but gdaladdo 
doesn?t support this type.

Does anybody have a way to use gdalwarp to create .ovr files?

Robb


From silyko at gmail.com  Mon May  6 06:38:59 2013
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Mon, 6 May 2013 15:38:59 +0200
Subject: [gdal-dev] Spatialite geometry format
Message-ID: <CANzGYpR6TU_droGphsP66uiejzCDbX+Pq6y=vMNs=EMSbwSp5g@mail.gmail.com>

Hi List,

   I am programming an application which can transform ogr-datasources
(using our own transformation library). In that process I use ogr (version
1.10)  via the c-api to read and write datasources - usually it works like
a charm. However, when I try to write an output spatialite datasource, I
run into this error:

sqlite3_step() failed:

points2.GEOMETRY violates Geometry constraint [geom-type or SRID not
allowed] (19)


I am not sure whether it's an issue with the SRID or the geom-type /
format. I also see on the ogr-drivers page, that spatialite use a speciel
(wkb like?) format for the geometry column.


What I usually do is to clone an input feature, clone the geometry:


hGeometry = OGR_G_Clone(OGR_F_GetGeometryRef(hFeature_out));


perform some transformations and set the geometry (again):


OGR_F_SetGeometryDirectly(hFeature_out,hGeometry);


While this works for (most) input and output datasources, it produces the
error above for spatialite output. Perhaps because the internal geometry
reperesentation is wrong, or there is some other more strict check of
output srs - e.g. should I use  OGR_G_AssignSpatialReference to assign the
output spatial reference to the geometry?


Is there something obvious that I am missing here?


Best Regards,

Simon Kokkendorff,  Danish Geodata Agency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/af01e906/attachment-0001.html>

From even.rouault at mines-paris.org  Mon May  6 06:50:32 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 06 May 2013 15:50:32 +0200
Subject: [gdal-dev] Spatialite geometry format
In-Reply-To: <CANzGYpR6TU_droGphsP66uiejzCDbX+Pq6y=vMNs=EMSbwSp5g@mail.gmail.com>
References: <CANzGYpR6TU_droGphsP66uiejzCDbX+Pq6y=vMNs=EMSbwSp5g@mail.gmail.com>
Message-ID: <1367848232.5187b5282d10f@imp.free.fr>

Selon Simon Lyngby Kokkendorff <silyko at gmail.com>:

> Hi List,
>
>    I am programming an application which can transform ogr-datasources
> (using our own transformation library). In that process I use ogr (version
> 1.10)  via the c-api to read and write datasources - usually it works like
> a charm. However, when I try to write an output spatialite datasource, I
> run into this error:
>
> sqlite3_step() failed:
>
> points2.GEOMETRY violates Geometry constraint [geom-type or SRID not
> allowed] (19)
>
>
> I am not sure whether it's an issue with the SRID or the geom-type /
> format. I also see on the ogr-drivers page, that spatialite use a speciel
> (wkb like?) format for the geometry column.

Yes, but this is an implementation detail from the point of view of users of
OGR, that is hidden by the OGR API.

>
>
> What I usually do is to clone an input feature, clone the geometry:
>
>
> hGeometry = OGR_G_Clone(OGR_F_GetGeometryRef(hFeature_out));
>
>
> perform some transformations and set the geometry (again):
>
>
> OGR_F_SetGeometryDirectly(hFeature_out,hGeometry);
>
>
> While this works for (most) input and output datasources, it produces the
> error above for spatialite output. Perhaps because the internal geometry
> reperesentation is wrong, or there is some other more strict check of
> output srs - e.g. should I use  OGR_G_AssignSpatialReference to assign the
> output spatial reference to the geometry?
>
>
> Is there something obvious that I am missing here?

The driver takes responsibility of assigning the SRID automatically from the
layer SRS. So the error is likely due to an attempt of inserting a geometry
whose type doesn't match the layer geometry type. Spatialite is really strict on
that: POLYGON != MULTIPOLYGON, and (perhaps I'm not sure) 2D != 2.5D

>
>
> Best Regards,
>
> Simon Kokkendorff,  Danish Geodata Agency
>



From marion.violot at gmail.com  Mon May  6 07:12:57 2013
From: marion.violot at gmail.com (MARION VIOLOT)
Date: Mon, 6 May 2013 16:12:57 +0200
Subject: [gdal-dev] Othogonal projcetion
In-Reply-To: <CAOo1m6Qpbs9TSBiSB1YMaSGGYU37OTmXYyNYPBhsfYoAshtKeQ@mail.gmail.com>
References: <CAOo1m6Qpbs9TSBiSB1YMaSGGYU37OTmXYyNYPBhsfYoAshtKeQ@mail.gmail.com>
Message-ID: <CAOo1m6TiwgT+2Nu9nyC+66BTZFN1egUOHy2RAGwU=xYSg0wDqQ@mail.gmail.com>

Dear everyone,

I found sometehing a way more easy that I could use. It's the method
Distance(). Apparently, " if OGR is built without the GEOS library, this
method will always fail, issuing a CPLE_NotSupported error ". I guess if it
returns me -1 means that it was built with GEOS, but an error occured,
isn't it? My code is quite simple,

I got the following polyligne poLine that seems to be correctly read as
when I look at its numbers of points, its length and so on, it seems to be
found without error. Then, I got the start point of my poLine, which is
also correct.


poLine = (OGRLineString *) poGeometry;
poPoint = OGRPoint::OGRPoint(0,0);
poLine->StartPoint(& poPoint);


After that I have some points poPointBis in one layer, and it gives me well
the number of points :


poPointBis = (OGRPoint *) poGeometryBis;


But when I do the following with a loop over the number of points, I have
-1 as the return value.

poPointBis = (OGRPoint *) poGeometryBis;
vector<double> Shorter;
for all the points {
 Shorter.push_back(poPointBis->Distance(poLine));
}


I thought may be it's beacause one geometry is a line and the other one is
a point. So I did the same thing with poGeometry and poGeometryBis and now
I'm trying with two points. And I still have -1 as the return value.

So, I missed something, but I really don't see what.  Does someone know
something about it?

Thanks a lot in advance,
Marion.





On Mon, May 6, 2013 at 9:27 AM, MARION VIOLOT <marion.violot at gmail.com>wrote:

> Dear everyone,
>
> I am new with GDAL-OGR and only need to orthogonally project points on
> polyline and then calculate the distance from the projections and the start
> point of the polyline (in C++, in a Windows Form Application with Visual
> Studio 2008).
>
> I didn't find yet a developed method in GDAL-OGR that enables me to do it.
> I would like to know if there is any existing one, or at least one method
> that calculates the shorter distance between a point and a polyline? I was
> thinking about first understanding and then using the OGR Projections
> Tutorial, but it's seems very complicated for doing so little.
>
> Thanks a lot for your time and your help.
> Marion.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/6e2ad5c3/attachment.html>

From chris_lawrence at partech.com  Mon May  6 07:14:53 2013
From: chris_lawrence at partech.com (Chris Lawrence)
Date: Mon, 6 May 2013 10:14:53 -0400
Subject: [gdal-dev] Unable to access GDAL_DATA directory on Android
In-Reply-To: <78BB25DC8E187B43BFEEB74CB0AF695604D61542@beasley.PARCorp.Local>
Message-ID: <78BB25DC8E187B43BFEEB74CB0AF695604D6203D@beasley.PARCorp.Local>

Following up as I found the (obvious) issue in case anyone else
encouters it: I was statically linking libgdal as per the examples for
android.  Linking against the libgdal.so library resolved the issue.  As
an aside, be aware that Android does not support versioned .so
libraries.
 
-chris
 
 
________________________________

From: gdal-dev-bounces at lists.osgeo.org
[mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Chris Lawrence
Sent: Thursday, May 02, 2013 5:46 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Unable to access GDAL_DATA directory on Android
 
I am developing an Android-based GDAL application.  I have successfully
built GDAL v1.9.2 and the SWIG-based Java bindings using the
instructions provided on the building GDAL page.  I am able to register
the drivers and load a dataset in my application, however, I am unable
to initialize a SpatialReference using an EPSG code (4326).  I have
placed the contents of gdal/data at /sdcard/gdal on the device; I have
tried both gdal.SetConfigOption("GDAL_DATA", "/sdcard/gdal") as well as
gdal.PushFinderLocation("/sdcard/gdal").  If anyone has experience using
GDAL on Android and has encountered and resolved this situation
previously, your insight would be greatly appreciated.
 
Thanks,
 
-chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/807c5982/attachment.html>

From silyko at gmail.com  Mon May  6 10:29:07 2013
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Mon, 6 May 2013 19:29:07 +0200
Subject: [gdal-dev] Spatialite geometry format
In-Reply-To: <1367848232.5187b5282d10f@imp.free.fr>
References: <CANzGYpR6TU_droGphsP66uiejzCDbX+Pq6y=vMNs=EMSbwSp5g@mail.gmail.com>
	<1367848232.5187b5282d10f@imp.free.fr>
Message-ID: <CANzGYpSF2pn-92af--A2cS+4j6Bt6ZZNV99PnAeERxx1f5g-Tw@mail.gmail.com>

Hi Even,

I think you're right. The transformation seems to alter the geometry type
somehow - need to debug a little more to see exactly what's going on.

 Thanks,
Simon



On Mon, May 6, 2013 at 3:50 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Selon Simon Lyngby Kokkendorff <silyko at gmail.com>:
>
> > Hi List,
> >
> >    I am programming an application which can transform ogr-datasources
> > (using our own transformation library). In that process I use ogr
> (version
> > 1.10)  via the c-api to read and write datasources - usually it works
> like
> > a charm. However, when I try to write an output spatialite datasource, I
> > run into this error:
> >
> > sqlite3_step() failed:
> >
> > points2.GEOMETRY violates Geometry constraint [geom-type or SRID not
> > allowed] (19)
> >
> >
> > I am not sure whether it's an issue with the SRID or the geom-type /
> > format. I also see on the ogr-drivers page, that spatialite use a speciel
> > (wkb like?) format for the geometry column.
>
> Yes, but this is an implementation detail from the point of view of users
> of
> OGR, that is hidden by the OGR API.
>
> >
> >
> > What I usually do is to clone an input feature, clone the geometry:
> >
> >
> > hGeometry = OGR_G_Clone(OGR_F_GetGeometryRef(hFeature_out));
> >
> >
> > perform some transformations and set the geometry (again):
> >
> >
> > OGR_F_SetGeometryDirectly(hFeature_out,hGeometry);
> >
> >
> > While this works for (most) input and output datasources, it produces the
> > error above for spatialite output. Perhaps because the internal geometry
> > reperesentation is wrong, or there is some other more strict check of
> > output srs - e.g. should I use  OGR_G_AssignSpatialReference to assign
> the
> > output spatial reference to the geometry?
> >
> >
> > Is there something obvious that I am missing here?
>
> The driver takes responsibility of assigning the SRID automatically from
> the
> layer SRS. So the error is likely due to an attempt of inserting a geometry
> whose type doesn't match the layer geometry type. Spatialite is really
> strict on
> that: POLYGON != MULTIPOLYGON, and (perhaps I'm not sure) 2D != 2.5D
>
> >
> >
> > Best Regards,
> >
> > Simon Kokkendorff,  Danish Geodata Agency
> >
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/42bf70a6/attachment-0001.html>

From silyko at gmail.com  Mon May  6 11:00:44 2013
From: silyko at gmail.com (Simon Lyngby Kokkendorff)
Date: Mon, 6 May 2013 20:00:44 +0200
Subject: [gdal-dev] Spatialite geometry format
In-Reply-To: <CANzGYpSF2pn-92af--A2cS+4j6Bt6ZZNV99PnAeERxx1f5g-Tw@mail.gmail.com>
References: <CANzGYpR6TU_droGphsP66uiejzCDbX+Pq6y=vMNs=EMSbwSp5g@mail.gmail.com>
	<1367848232.5187b5282d10f@imp.free.fr>
	<CANzGYpSF2pn-92af--A2cS+4j6Bt6ZZNV99PnAeERxx1f5g-Tw@mail.gmail.com>
Message-ID: <CANzGYpQfZ083NgT4W81gD_J6j17b6O_JB0U2wbzazcpdrfAcOQ@mail.gmail.com>

Yes, it was after a call to:
OGR_G_SetPoint
that the geometry type was altered. Should really test if it's a 2.5D or 2D
geometry and use OGR_G_SetPoint_2D in the latter case!

Thanks,
SImon



On Mon, May 6, 2013 at 7:29 PM, Simon Lyngby Kokkendorff
<silyko at gmail.com>wrote:

> Hi Even,
>
> I think you're right. The transformation seems to alter the geometry type
> somehow - need to debug a little more to see exactly what's going on.
>
>  Thanks,
> Simon
>
>
>
> On Mon, May 6, 2013 at 3:50 PM, Even Rouault <even.rouault at mines-paris.org
> > wrote:
>
>> Selon Simon Lyngby Kokkendorff <silyko at gmail.com>:
>>
>> > Hi List,
>> >
>> >    I am programming an application which can transform ogr-datasources
>> > (using our own transformation library). In that process I use ogr
>> (version
>> > 1.10)  via the c-api to read and write datasources - usually it works
>> like
>> > a charm. However, when I try to write an output spatialite datasource, I
>> > run into this error:
>> >
>> > sqlite3_step() failed:
>> >
>> > points2.GEOMETRY violates Geometry constraint [geom-type or SRID not
>> > allowed] (19)
>> >
>> >
>> > I am not sure whether it's an issue with the SRID or the geom-type /
>> > format. I also see on the ogr-drivers page, that spatialite use a
>> speciel
>> > (wkb like?) format for the geometry column.
>>
>> Yes, but this is an implementation detail from the point of view of users
>> of
>> OGR, that is hidden by the OGR API.
>>
>> >
>> >
>> > What I usually do is to clone an input feature, clone the geometry:
>> >
>> >
>> > hGeometry = OGR_G_Clone(OGR_F_GetGeometryRef(hFeature_out));
>> >
>> >
>> > perform some transformations and set the geometry (again):
>> >
>> >
>> > OGR_F_SetGeometryDirectly(hFeature_out,hGeometry);
>> >
>> >
>> > While this works for (most) input and output datasources, it produces
>> the
>> > error above for spatialite output. Perhaps because the internal geometry
>> > reperesentation is wrong, or there is some other more strict check of
>> > output srs - e.g. should I use  OGR_G_AssignSpatialReference to assign
>> the
>> > output spatial reference to the geometry?
>> >
>> >
>> > Is there something obvious that I am missing here?
>>
>> The driver takes responsibility of assigning the SRID automatically from
>> the
>> layer SRS. So the error is likely due to an attempt of inserting a
>> geometry
>> whose type doesn't match the layer geometry type. Spatialite is really
>> strict on
>> that: POLYGON != MULTIPOLYGON, and (perhaps I'm not sure) 2D != 2.5D
>>
>> >
>> >
>> > Best Regards,
>> >
>> > Simon Kokkendorff,  Danish Geodata Agency
>> >
>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/c605760e/attachment.html>

From hellyj at ucsd.edu  Mon May  6 11:57:49 2013
From: hellyj at ucsd.edu (John Helly)
Date: Mon, 06 May 2013 11:57:49 -0700
Subject: [gdal-dev] [mbsystem] [GMT4] Messy little problem between GMT4,
 GDAL 1.9.2 and ArcGIS 10
In-Reply-To: <0274C33B-89D5-4F37-9BA8-6F7DC0D7040A@yahoo.com>
References: <5186C974.4020703@ucsd.edu>
	<0274C33B-89D5-4F37-9BA8-6F7DC0D7040A@yahoo.com>
Message-ID: <5187FD2D.8070403@ucsd.edu>

Hi Kurt.
Thanks for the reply.

You are correct that mbgrid outputs a GMT netCDF file.  I was running 
gdal_translate to overcome a weirdness that may no longer exist but 
previously caused the output to be reflected when displayed in GIS 
tools.  This was due to a difference between GDAL utilities and the GMT 
tools in indexing the data (as I recall).

Geotiffs are a nice alternative.  I was just used to using netCDF.

Joaquim Luis explained the problem as due to gdal using an old GMT3 
format (below)

 >>
John,

No wonder the headers are different. The gdal_translate -of GMT converts 
the grid into the old-old-old GMT3 version netCDF that was not CF 
compliant. And if you want to do that, no need to call gdal_translate, 
all you need is to append '=cf' to grid's name of mbgrid command (I'm 
assuming that mbgrid delegates all grid writing work to GMT).

In summary, I don't see any problem here as it's very unlikely that Arc 
will be able to read that old-old-old netCDF variant (unless it lets  
GDAL do all the work)

Joaquim
 >>


J.

On 5/5/13 5:39 PM, Kurt Schwehr wrote:
> Hi John,
>
> - It's Sunday so the brain isn't really engaged, but doesn't mbgrid 
> output a gmt grd file?  (your dump shows that)  Why are you running 
> gdal_translate when your issue was with qgis/gdal and your destination 
> is ArcGIS?
>
> - gdal 1.10.0 is just out.  Before trying anything else, you might try 
> upgrading to that.
>
> - Why not write a geotif from gdal?  You get the option of LZW 
> compression then and a lot more tools can read geotif than can read 
> gmt netcdf grids... it's also a much more tested path through gdal. 
>  Since I never seem to remember how to do compress and I always seem 
> monstrous amounts of files... for the record, to LZW compress a 
> geotif, add this:
>    -co "COMPRESS=LZW"
>
> - are you seeing the same things from gdalinfo on the output as the 
> input? (e.g. is gdal being self consistent)
>
> - you never mentioned what options you were passing to gdal_translate. 
>  One of your options could be the issue.
>
> -kurt
>
> On May 5, 2013, at 2:04 PM, John Helly <hellyj at ucsd.edu 
> <mailto:hellyj at ucsd.edu>> wrote:
>
>> Hi.
>>
>> A few years ago I had a problem with GMT/GDAL interactions such that 
>> the GMT netCDF files were reflected when read into Qgis (for 
>> example). This was worked around by running it through 
>> 'gdal_translate -of GMT'.  There was also a discussion about this 
>> being a bug in something in GDAL (since Qgis was using GDAL if I 
>> remember correctly) that was supposed to have been fixed in some 
>> version (obviously don't remember the details). At any rate, it 
>> stopped being a problem for me but now something else is causing a 
>> problem in files that have the following workflow:
>>
>> --> mbgrid (from MB-System) --> gdal_translate -of GMT --> ArcGIS 
>> netCDF reader
>>
>> Now I find that gdal_translate appears to be changing the header in a 
>> way such that ArcGIS cannot read the netCDF. The first 'ncdump -h' 
>> below is what the header looks like before running through 
>> gdal_translate and the second one is after gdal_translate.
>>
>> I'm sending this note to MB-System, GMT and GDAL groups since it 
>> seems like an issue of import to all three.  Any thoughts on this?
>>
>> J.
>>
>> =======================================Output from mbgrid before 
>> gdal_translate ==================================================
>> ncdump -h MCBCP_BeachModel_UTM11N_Baseline.grdclip.nc
>> netcdf MCBCP_BeachModel_UTM11N_Baseline.grdclip {
>> dimensions:
>>     x = 12626 ;
>>     y = 12251 ;
>> variables:
>>     double x(x) ;
>>         x:long_name = "Easting (meters)" ;
>>         x:actual_range = 444057.827834802, 469309.046567392 ;
>>     double y(y) ;
>>         y:long_name = "Northing (meters)" ;
>>         y:actual_range = 3670183.00468016, 3694684.53612513 ;
>>     float z(y, x) ;
>>         z:long_name = "Topography (m)" ;
>>         z:_FillValue = NaNf ;
>>         z:actual_range = -1995.541015625, 599.818359375 ;
>>
>> // global attributes:
>>         :Conventions = "COARDS/CF-1.0" ;
>>         :title = "Topography Grid" ;
>>         :history = "grdclip -V 
>> /media/EXT4_Projects_01/SLR_Data/level1/MCBCP/Basemap/MCBCP_BeachModel_UTM11N_Baseline.grd 
>> -G/media/EXT4_Projects_01/SLR_Data/level1/MCBCP/Basemap/MCBCP_BeachModel_UTM11N_Baseline.grdclip.nc 
>> -Sa600/NaN -Sb-2000/NaN" ;
>>         :description = "\n",
>>             "\tProjection: UTM11N\n",
>>             "\tGrid created by mbgrid\n",
>>             "\tMB-system Version 5.3.1982\n",
>>             "\tRun by <hellyj> on <StonestepsLinux> at <Thu Apr 25 
>> 19:44:41 2013>" ;
>>         :GMT_version = "4.5.9_r9909 [64-bit]" ;
>> }
>> =====================================Output from mbgrid after 
>> gdal_translate ====================================================
>> ncdump -h MCBCP_BeachModel_UTM11N_Baseline.grdclip.flipped.nc
>> netcdf MCBCP_BeachModel_UTM11N_Baseline.grdclip.flipped {
>> dimensions:
>>     side = 2 ;
>>     xysize = 154681126 ;
>> variables:
>>     double x_range(side) ;
>>         x_range:units = "meters" ;
>>     double y_range(side) ;
>>         y_range:units = "meters" ;
>>     double z_range(side) ;
>>         z_range:units = "meters" ;
>>     double spacing(side) ;
>>     int dimension(side) ;
>>     float z(xysize) ;
>>         z:scale_factor = 1. ;
>>         z:add_offset = 0. ;
>>         z:node_offset = 1 ;
>>
>> // global attributes:
>>         :title = "" ;
>>         :source = "" ;
>> }
>>
>> -- 
>> John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / stonesteps (Skype) / stonesteps7 (iChat) /http://www.sdsc.edu/~hellyj
>

-- 
John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / stonesteps (Skype) / stonesteps7 (iChat) / http://www.sdsc.edu/~hellyj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/097399a7/attachment.html>

From manoj.bist1 at gmail.com  Mon May  6 20:58:27 2013
From: manoj.bist1 at gmail.com (Manoj Bist)
Date: Mon, 6 May 2013 20:58:27 -0700
Subject: [gdal-dev] Bathymetry data for US reservoirs.
Message-ID: <CAGC+Sx79UzMrgV1mzfTaxUufzBe8XyMxKA0Q-4-5TQq2m7RCaQ@mail.gmail.com>

Hi,

I have been using gdal since past few months (without any issue).  I am
running into a non gdal  related issue pertaining to getting depth/bathy
data for reservoirs that I am interested in.

I am looking for bathymetry data for some USACE reservoirs. I am told this
data used to be available in the USACE GIS data clearing house website. But
this website has been down for quite some time now. Does anyone know if I
can find the same data elsewhere? The following is the link to USACE GIS
clearing house but it has been down for quite a while now.

http://corpsgeo1.usace.army.mil/

I have wasted quite a bit of time searching for this (incl. contacting
USACE unsuccessfully both via phone and email). I would really appreciate
any pointers regarding this.

Thanks,

--MB.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130506/89977267/attachment.html>

From manoj.bist1 at gmail.com  Tue May  7 09:57:33 2013
From: manoj.bist1 at gmail.com (Manoj Bist)
Date: Tue, 7 May 2013 09:57:33 -0700
Subject: [gdal-dev] Bathymetry data for US reservoirs.
In-Reply-To: <BLU175-W19EA85409B359070488549B2BA0@phx.gbl>
References: <CAGC+Sx79UzMrgV1mzfTaxUufzBe8XyMxKA0Q-4-5TQq2m7RCaQ@mail.gmail.com>
	<BLU175-W19EA85409B359070488549B2BA0@phx.gbl>
Message-ID: <CAGC+Sx7Sm1P-Kvrk4_NS1kpvj2RtGFsJ0VwyDn3Rmn7LdO023A@mail.gmail.com>

Thanks a lot for the response Marius. I was able to find data for Texas on
the  twdb website.

I was looking for bathy data for  Lake Allatoona, Lake Lanier, Seminole
(Georgia) etc.  Most of the USACE website/urls for data I have tried
(including the spatial data clearing house) are either down or give random
errors in the browser.

I couldn't find any other website that might have backup/archive of USACE
data.

Thanks,

--MB.

On Tue, May 7, 2013 at 6:14 AM, Marius Jigmond <mariusjigmond at hotmail.com>wrote:

> For Texas reservoirs you may contact Jason Kemp of the Texas Water
> Development Board (see
> http://www.twdb.texas.gov/surfacewater/surveys/index.asp for contact
> info). He may have some data or may be able to point you in the right
> direction.
>
> -marius
>
> ------------------------------
> Date: Mon, 6 May 2013 20:58:27 -0700
> From: manoj.bist1 at gmail.com
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Bathymetry data for US reservoirs.
>
>
> Hi,
>
> I have been using gdal since past few months (without any issue).  I am
> running into a non gdal  related issue pertaining to getting depth/bathy
> data for reservoirs that I am interested in.
>
> I am looking for bathymetry data for some USACE reservoirs. I am told this
> data used to be available in the USACE GIS data clearing house website. But
> this website has been down for quite some time now. Does anyone know if I
> can find the same data elsewhere? The following is the link to USACE GIS
> clearing house but it has been down for quite a while now.
>
> http://corpsgeo1.usace.army.mil/
>
> I have wasted quite a bit of time searching for this (incl. contacting
> USACE unsuccessfully both via phone and email). I would really appreciate
> any pointers regarding this.
>
> Thanks,
>
> --MB.
>
> _______________________________________________ gdal-dev mailing list
> gdal-dev at lists.osgeo.org http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130507/06ca78d0/attachment.html>

From mariusjigmond at hotmail.com  Tue May  7 06:14:21 2013
From: mariusjigmond at hotmail.com (Marius Jigmond)
Date: Tue, 7 May 2013 08:14:21 -0500
Subject: [gdal-dev] Bathymetry data for US reservoirs.
In-Reply-To: <CAGC+Sx79UzMrgV1mzfTaxUufzBe8XyMxKA0Q-4-5TQq2m7RCaQ@mail.gmail.com>
References: <CAGC+Sx79UzMrgV1mzfTaxUufzBe8XyMxKA0Q-4-5TQq2m7RCaQ@mail.gmail.com>
Message-ID: <BLU175-W19EA85409B359070488549B2BA0@phx.gbl>

For Texas reservoirs you may contact Jason Kemp of the Texas Water Development Board (see http://www.twdb.texas.gov/surfacewater/surveys/index.asp for contact info). He may have some data or may be able to point you in the right direction.
-marius

Date: Mon, 6 May 2013 20:58:27 -0700
From: manoj.bist1 at gmail.com
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Bathymetry data for US reservoirs.

Hi,

I have been using gdal since past few months (without any issue).  I am running into a non gdal  related issue pertaining to getting depth/bathy data for reservoirs that I am interested in.  


I am looking for bathymetry data for some USACE reservoirs. I am told this data used to be available in the USACE GIS data clearing house website. But this website has been down for quite some time now. Does anyone know if I can find the same data elsewhere? The following is the link to USACE GIS clearing house but it has been down for quite a while now.

http://corpsgeo1.usace.army.mil/

I have wasted quite a bit of time searching for this (incl. contacting USACE unsuccessfully both via phone and email). I would really appreciate any pointers regarding this.

Thanks,
--MB.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130507/b50d2795/attachment.html>

From marion.violot at gmail.com  Tue May  7 03:02:55 2013
From: marion.violot at gmail.com (MARION VIOLOT)
Date: Tue, 7 May 2013 12:02:55 +0200
Subject: [gdal-dev] Build GDAL OGR with GEOS
Message-ID: <CAOo1m6QTYytO2DxQzLXxPFNSQx43pQ74y1Xds_KAr8GF=AniOw@mail.gmail.com>

Hi again everyone.

Does someone could please detail me the steps to follow in order to build
GDAL-OGR with GEOS on Windows, with Visual Studio 2008 please? I found the
following link ;

http://trac.osgeo.org/gdal/wiki/MakeFileProjects

http://trac.osgeo.org/gdal/wiki/BuildingOnWindows

http://vterrain.org/Distrib/gdal.html

At the end, do I have to create a Make File Project or use a Visual Studio
solution? I already managed to build GDAL-OGR (using the command prompt)
and used it, but I don't know if it was the proper way. Plus, I need OGR to
be built with GEOS.

Besides, I don't know which version of GEOS I should use from this link :
http://trac.osgeo.org/geos/ ?

To finish, how can I do to build them together? I already found the
following discussion but it doesn't really help me :

http://lists.osgeo.org/pipermail/gdal-dev/2009-October/022241.html

I'm quite lost, so any help would be very appreciate. Thank you in advance.

Marion.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130507/e0114e74/attachment.html>

From even.rouault at mines-paris.org  Tue May  7 14:42:30 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 7 May 2013 23:42:30 +0200
Subject: [gdal-dev] Build GDAL OGR with GEOS
In-Reply-To: <CAOo1m6QTYytO2DxQzLXxPFNSQx43pQ74y1Xds_KAr8GF=AniOw@mail.gmail.com>
References: <CAOo1m6QTYytO2DxQzLXxPFNSQx43pQ74y1Xds_KAr8GF=AniOw@mail.gmail.com>
Message-ID: <201305072342.30777.even.rouault@mines-paris.org>

Le mardi 07 mai 2013 12:02:55, MARION VIOLOT a ?crit :
> Hi again everyone.
> 
> Does someone could please detail me the steps to follow in order to build
> GDAL-OGR with GEOS on Windows, with Visual Studio 2008 please? I found the
> following link ;
> 
> http://trac.osgeo.org/gdal/wiki/MakeFileProjects
> 
> http://trac.osgeo.org/gdal/wiki/BuildingOnWindows
> 
> http://vterrain.org/Distrib/gdal.html
> 
> At the end, do I have to create a Make File Project or use a Visual Studio
> solution? I already managed to build GDAL-OGR (using the command prompt)
> and used it, but I don't know if it was the proper way. Plus, I need OGR to
> be built with GEOS.
> 
> Besides, I don't know which version of GEOS I should use from this link :
> http://trac.osgeo.org/geos/ ?
> 
> To finish, how can I do to build them together? I already found the
> following discussion but it doesn't really help me :
> 
> http://lists.osgeo.org/pipermail/gdal-dev/2009-October/022241.html
> 
> I'm quite lost, so any help would be very appreciate. Thank you in advance.

Marion,

Why don't you just use one of the GDAL builds at 
http://www.gisinternals.com/sdk/ ? They already do include GEOS. And if you 
really want to compile by yourself, there are also source packages that are 
ready to be built.

Best regards,

Even

> 
> Marion.

From jmckenna at gatewaygeomatics.com  Tue May  7 15:27:39 2013
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 07 May 2013 19:27:39 -0300
Subject: [gdal-dev] Build GDAL OGR with GEOS
In-Reply-To: <CAOo1m6QTYytO2DxQzLXxPFNSQx43pQ74y1Xds_KAr8GF=AniOw@mail.gmail.com>
References: <CAOo1m6QTYytO2DxQzLXxPFNSQx43pQ74y1Xds_KAr8GF=AniOw@mail.gmail.com>
Message-ID: <51897FDB.1030805@gatewaygeomatics.com>

On 2013-05-07 7:02 AM, MARION VIOLOT wrote:
> Hi again everyone.
> 
> Does someone could please detail me the steps to follow in order to
> build GDAL-OGR with GEOS on Windows, with Visual Studio 2008 please? I
> found the following link ;
> 
> http://trac.osgeo.org/gdal/wiki/MakeFileProjects
> 
> http://trac.osgeo.org/gdal/wiki/BuildingOnWindows
> 
> http://vterrain.org/Distrib/gdal.html
> 
> At the end, do I have to create a Make File Project or use a Visual
> Studio solution? I already managed to build GDAL-OGR (using the command
> prompt) and used it, but I don't know if it was the proper way. Plus, I
> need OGR to be built with GEOS.
> 
> Besides, I don't know which version of GEOS I should use from this link
> : http://trac.osgeo.org/geos/ ?
> 
> To finish, how can I do to build them together? I already found the
> following discussion but it doesn't really help me :
> 
> http://lists.osgeo.org/pipermail/gdal-dev/2009-October/022241.html
> 
> I'm quite lost, so any help would be very appreciate. Thank you in advance.
> 
> Marion.
> 
> 

Hi Marion,

It's actually very straightforward to compile GEOS on windows.  Since
you're already familiar with commandline through your GDAL build, here
are my steps (note that others likely use cmake or other methods, but
this is what works for me).

- download 3.3.8 from http://trac.osgeo.org/geos/
- in MSVC command window:
  - cd to geos-3.3.8
  - autogen.bat
  - nmake /f makefile.vc MSVC_VER=1500
- output is in /src/
- cd into gdal
- edit nmake.opt
  - change GEOS_DIR, GEOS_CFLAGS, GEOS_LIB variables for your local paths
- nmake /f makefile.vc clean
- nmake /f makefile.vc

(this is what I've been doing for MS4W for many years)

Enjoy,

-jeff

-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From markus.u.mueller at zoho.com  Wed May  8 15:07:34 2013
From: markus.u.mueller at zoho.com (markus.u.mueller)
Date: Wed, 08 May 2013 15:07:34 -0700
Subject: [gdal-dev] Bug in  of GDALRead.cs
Message-ID: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>

Dear listers,

I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the right place to record it? I will describe the problem anyway and would be willing to move it to another place if more appropriate.


I want to read Arc/Info Binary Grids and convert them to other image formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the current binaries (MSVC2010 (Win64) -stable) from http://vbkto.dyndns.org/sdk/. Then I started testing the example C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I use the demo dataset utm.tif, this all works fine.
I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap 10 (Conversion Tools - To Raster - Raster to other Format). When I try to use  GDALReadDirect.cs I get the following error messages:
Using driver Arc/Info Binary Grid Band 1 : DataType: GDT_Int16 Size (512,512) PaletteInterp: GCI_Undefined OverView 0 : DataType: GDT_Int16 Size (256,256) PaletteInterp: GCI_GrayIndex OverView 1 : DataType: GDT_Int16 Size (128,128) PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample
GDALReadDirect.cs obviously has an erroneous method named SaveBitMapDirect, that first checks on the available Color interpretation and then on the number of bands. After the file is converted to Arc/Info binary Grid format, the information about the Color interpretation is lost, so only then the program checks on the number of available bands and returns an error message. SaveBitMapDirect works for the described case if Line 157 is edited:
if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex || redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
This is not a general fix, only for the immediate problem.




Cheers,


Markus










-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130508/b35be70a/attachment.html>

From warmerdam at pobox.com  Wed May  8 15:57:05 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 8 May 2013 15:57:05 -0700
Subject: [gdal-dev] Bug in of GDALRead.cs
In-Reply-To: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
References: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
Message-ID: <CA+YzLBeMB9t6GUhFUSCYnQQ_soXhnTAV0Ahc-=35eLz1RdavGA@mail.gmail.com>

Markus,

The GDAL C# bindings in FWTools is pretty ancient at this point so
reporting bugs against it is unlikely to result in improvements.  You might
want to upgrade to the latest version - either building from source, or
perhaps using Tamas' SDK (http://www.gisinternals.com/sdk/).

Best regards,
Frank


On Wed, May 8, 2013 at 3:07 PM, markus.u.mueller
<markus.u.mueller at zoho.com>wrote:

> **
> Dear listers,
>
> I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the
> right place to record it? I will describe the problem anyway and would be
> willing to move it to another place if more appropriate.
>
> I want to read Arc/Info Binary Grids and convert them to other image
> formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the
> current binaries (MSVC2010 (Win64) -stable) from
> http://vbkto.dyndns.org/sdk/. Then I started testing the example
> C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I
> use the demo dataset utm.tif, this all works fine.
>
> I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap
> 10 (Conversion Tools - To Raster - Raster to other Format). When I try to
> use  GDALReadDirect.cs I get the following error messages:
>
> Using driver Arc/Info Binary Grid Band 1 :    DataType: GDT_Int16    Size (512,512)    PaletteInterp: GCI_Undefined       OverView 0 :          DataType: GDT_Int16          Size (256,256)          PaletteInterp: GCI_GrayIndex       OverView 1 :          DataType: GDT_Int16          Size (128,128)          PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample
>
> GDALReadDirect.cs obviously has an erroneous method named SaveBitMapDirect,
> that first checks on the available Color interpretation and then on the
> number of bands. After the file is converted to Arc/Info binary Grid
> format, the information about the Color interpretation is lost, so only
> then the program checks on the number of available bands and returns an
> error message. SaveBitMapDirect works for the described case if Line 157
> is edited:
>
> if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex ||
> redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
>
> This is not a general fix, only for the immediate problem.
>
>
>
> Cheers,
>
>
> Markus
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130508/71ad9b81/attachment-0001.html>

From markus.u.mueller at zoho.com  Wed May  8 18:57:32 2013
From: markus.u.mueller at zoho.com (markus.u.mueller)
Date: Wed, 08 May 2013 18:57:32 -0700
Subject: [gdal-dev] Bug in of GDALRead.cs
In-Reply-To: <CA+YzLBeMB9t6GUhFUSCYnQQ_soXhnTAV0Ahc-=35eLz1RdavGA@mail.gmail.com>
References: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
	<CA+YzLBeMB9t6GUhFUSCYnQQ_soXhnTAV0Ahc-=35eLz1RdavGA@mail.gmail.com>
Message-ID: <13e8701f698.-3481136183877250529.-5574187506009945009@zoho.com>

Frank,

that is what I am using (Tamas' SDK), perhaps my email was not clear enough. The example .cs files (and that is where I found the bug) though are only available via FWTools. Makes sense?
This example files are not strictly part of the C#-bindings, but as they are the only documentation available I figured it makes sense to fix them.




Cheers,


Markus




---- On Wed, 08 May 2013 15:57:05 -0700 Frank Warmerdam &lt;warmerdam at pobox.com&gt; wrote ---- 


Markus,

The GDAL C# bindings in FWTools is pretty ancient at this point so reporting bugs against it is unlikely to result in improvements.  You might want to upgrade to the latest version - either building from source, or perhaps using Tamas' SDK (http://www.gisinternals.com/sdk/).
 

Best regards,
Frank



On Wed, May 8, 2013 at 3:07 PM, markus.u.mueller &lt;markus.u.mueller at zoho.com&gt; wrote:
 Dear listers,

 I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the right place to record it? I will describe the problem anyway and would be willing to move it to another place if more appropriate.
 

 I want to read Arc/Info Binary Grids and convert them to other image formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the current binaries (MSVC2010 (Win64) -stable) from http://vbkto.dyndns.org/sdk/. Then I started testing the example C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I use the demo dataset utm.tif, this all works fine.
 I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap 10 (Conversion Tools - To Raster - Raster to other Format). When I try to use  GDALReadDirect.cs I get the following error messages:
 
  Using driver Arc/Info Binary Grid Band 1 : DataType: GDT_Int16 Size (512,512) PaletteInterp: GCI_Undefined OverView 0 : DataType: GDT_Int16 Size (256,256) PaletteInterp: GCI_GrayIndex OverView 1 : DataType: GDT_Int16 Size (128,128) PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample 
 GDALReadDirect.cs obviously has an erroneous method named SaveBitMapDirect, that first checks on the available Color interpretation and then on the number of bands. After the file is converted to Arc/Info binary Grid format, the information about the Color interpretation is lost, so only then the program checks on the number of available bands and returns an error message. SaveBitMapDirect works for the described case if Line 157 is edited:
 if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex || redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
 This is not a general fix, only for the immediate problem.
 
 
 

 Cheers,
 

 Markus
 

 

 







_______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 http://lists.osgeo.org/mailman/listinfo/gdal-dev





-- 
---------------------------------------+--------------------------------------
 I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
 and watch the world go round - Rush    | Geospatial Software Developer
 
 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130508/be49acab/attachment.html>

From szekerest at gmail.com  Wed May  8 23:34:45 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 9 May 2013 08:34:45 +0200
Subject: [gdal-dev] Bug in of GDALRead.cs
In-Reply-To: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
References: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
Message-ID: <CACALY+TC9MfRKPUg_EXdUrwPnyTJTntZp7FV3n5Avdsn7Fv1Ow@mail.gmail.com>

Markus,

The GDAL issue tracker is the right place to record such issues (
http://trac.osgeo.org/gdal/newticket). I'd also require your sample
dataset, since I have no ArcMap 10 available to reproduce that according to
your description below.

Best regards,

Tamas



2013/5/9 markus.u.mueller <markus.u.mueller at zoho.com>

> **
> Dear listers,
>
> I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the
> right place to record it? I will describe the problem anyway and would be
> willing to move it to another place if more appropriate.
>
> I want to read Arc/Info Binary Grids and convert them to other image
> formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the
> current binaries (MSVC2010 (Win64) -stable) from
> http://vbkto.dyndns.org/sdk/. Then I started testing the example
> C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I
> use the demo dataset utm.tif, this all works fine.
>
> I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap
> 10 (Conversion Tools - To Raster - Raster to other Format). When I try to
> use  GDALReadDirect.cs I get the following error messages:
>
> Using driver Arc/Info Binary Grid Band 1 :    DataType: GDT_Int16    Size (512,512)    PaletteInterp: GCI_Undefined       OverView 0 :          DataType: GDT_Int16          Size (256,256)          PaletteInterp: GCI_GrayIndex       OverView 1 :          DataType: GDT_Int16          Size (128,128)          PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample
>
> GDALReadDirect.cs obviously has an erroneous method named SaveBitMapDirect,
> that first checks on the available Color interpretation and then on the
> number of bands. After the file is converted to Arc/Info binary Grid
> format, the information about the Color interpretation is lost, so only
> then the program checks on the number of available bands and returns an
> error message. SaveBitMapDirect works for the described case if Line 157
> is edited:
>
> if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex ||
> redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
>
> This is not a general fix, only for the immediate problem.
>
>
>
> Cheers,
>
>
> Markus
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130509/1841fb94/attachment-0001.html>

From warmerdam at pobox.com  Thu May  9 10:51:23 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 9 May 2013 10:51:23 -0700
Subject: [gdal-dev] Bug in of GDALRead.cs
In-Reply-To: <13e8701f698.-3481136183877250529.-5574187506009945009@zoho.com>
References: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
	<CA+YzLBeMB9t6GUhFUSCYnQQ_soXhnTAV0Ahc-=35eLz1RdavGA@mail.gmail.com>
	<13e8701f698.-3481136183877250529.-5574187506009945009@zoho.com>
Message-ID: <CA+YzLBeFT_iXrqk=YLU8-mVMOFEdQYL7nWzkGDvGQKAxoFd9jQ@mail.gmail.com>

Markus,

Ah, I see.  The up to date sample scripts can also be found at:

  http://svn.osgeo.org/gdal/trunk/gdal/swig/csharp/apps/

The examples in FWTools are likely very out of date.

Best regards,
Frank

On Wed, May 8, 2013 at 6:57 PM, markus.u.mueller
<markus.u.mueller at zoho.com>wrote:

> **
> Frank,
>
> that is what I am using (Tamas' SDK), perhaps my email was not clear
> enough. The example .cs files (and that is where I found the bug) though
> are only available via FWTools. Makes sense?
> This example files are not strictly part of the C#-bindings, but as they
> are the only documentation available I figured it makes sense to fix them.
>
>
> Cheers,
>
> Markus
>
>
>
> ---- On Wed, 08 May 2013 15:57:05 -0700 *Frank Warmerdam <
> warmerdam at pobox.com>* wrote ----
>
> Markus,
>
> The GDAL C# bindings in FWTools is pretty ancient at this point so
> reporting bugs against it is unlikely to result in improvements.  You might
> want to upgrade to the latest version - either building from source, or
> perhaps using Tamas' SDK (http://www.gisinternals.com/sdk/).
>
> Best regards,
> Frank
>
>
> On Wed, May 8, 2013 at 3:07 PM, markus.u.mueller <
> markus.u.mueller at zoho.com> wrote:
>
> **
> Dear listers,
>
> I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the
> right place to record it? I will describe the problem anyway and would be
> willing to move it to another place if more appropriate.
>
> I want to read Arc/Info Binary Grids and convert them to other image
> formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the
> current binaries (MSVC2010 (Win64) -stable) from
> http://vbkto.dyndns.org/sdk/. Then I started testing the example
> C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I
> use the demo dataset utm.tif, this all works fine.
>
> I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap
> 10 (Conversion Tools - To Raster - Raster to other Format). When I try to
> use  GDALReadDirect.cs I get the following error messages:
>
>  Using driver Arc/Info Binary Grid Band 1 :    DataType: GDT_Int16    Size (512,512)    PaletteInterp: GCI_Undefined       OverView 0 :          DataType: GDT_Int16          Size (256,256)          PaletteInterp: GCI_GrayIndex       OverView 1 :          DataType: GDT_Int16          Size (128,128)          PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample
>
>  GDALReadDirect.cs obviously has an erroneous method named
> SaveBitMapDirect, that first checks on the available Color interpretation
> and then on the number of bands. After the file is converted to Arc/Info
> binary Grid format, the information about the Color interpretation is lost,
> so only then the program checks on the number of available bands and
> returns an error message. SaveBitMapDirect works for the described case
> if Line 157 is edited:
>
> if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex ||
> redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
>
> This is not a general fix, only for the immediate problem.
>
>
>
> Cheers,
>
>
> Markus
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
>
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130509/13f3c896/attachment.html>

From markus.u.mueller at zoho.com  Thu May  9 13:52:36 2013
From: markus.u.mueller at zoho.com (=?UTF-8?Q?Markus_M=C3=BCller?=)
Date: Thu, 09 May 2013 13:52:36 -0700
Subject: [gdal-dev] Bug in of GDALRead.cs
In-Reply-To: <CA+YzLBeFT_iXrqk=YLU8-mVMOFEdQYL7nWzkGDvGQKAxoFd9jQ@mail.gmail.com>
References: <13e862f69a9.-6421673252878858306.7375992146699935780@zoho.com>
	<CA+YzLBeMB9t6GUhFUSCYnQQ_soXhnTAV0Ahc-=35eLz1RdavGA@mail.gmail.com>
	<13e8701f698.-3481136183877250529.-5574187506009945009@zoho.com>
	<CA+YzLBeFT_iXrqk=YLU8-mVMOFEdQYL7nWzkGDvGQKAxoFd9jQ@mail.gmail.com>
Message-ID: <13e8b1125bd.6712177113184465968.-3456345789154512951@zoho.com>

Tamas and Frank,

the (supposed) bug is still the same with the files from http://svn.osgeo.org/gdal/trunk/gdal/swig/csharp/apps/.
I created a trac ticket as suggested by Tamas: http://trac.osgeo.org/gdal/ticket/5074.




Cheers,


Markus

---- On Thu, 09 May 2013 10:51:23 -0700 Frank Warmerdam &lt;warmerdam at pobox.com&gt; wrote ---- 


Markus,

Ah, I see.  The up to date sample scripts can also be found at:


  http://svn.osgeo.org/gdal/trunk/gdal/swig/csharp/apps/
 

The examples in FWTools are likely very out of date.


Best regards,
Frank

On Wed, May 8, 2013 at 6:57 PM, markus.u.mueller &lt;markus.u.mueller at zoho.com&gt; wrote:
  Frank,

that is what I am using (Tamas' SDK), perhaps my email was not clear enough. The example .cs files (and that is where I found the bug) though are only available via FWTools. Makes sense?
 This example files are not strictly part of the C#-bindings, but as they are the only documentation available I figured it makes sense to fix them.




Cheers,


 Markus




---- On Wed, 08 May 2013 15:57:05 -0700 Frank Warmerdam &lt;warmerdam at pobox.com&gt; wrote ---- 

 
Markus,

The GDAL C# bindings in FWTools is pretty ancient at this point so reporting bugs against it is unlikely to result in improvements.  You might want to upgrade to the latest version - either building from source, or perhaps using Tamas' SDK (http://www.gisinternals.com/sdk/).
 

Best regards,
Frank



On Wed, May 8, 2013 at 3:07 PM, markus.u.mueller &lt;markus.u.mueller at zoho.com&gt; wrote:
  Dear listers,

 I  think I found a bug in GDALReadDirect.cs (part of FWTools). Is this the right place to record it? I will describe the problem anyway and would be willing to move it to another place if more appropriate.
 

 I want to read Arc/Info Binary Grids and convert them to other image formats using the C#-bindings of GDAL. I installed FWTools 2.4.7 and the current binaries (MSVC2010 (Win64) -stable) from http://vbkto.dyndns.org/sdk/. Then I started testing the example C#-programs that are part of FWTools, especially  GDALReadDirect.cs. When I use the demo dataset utm.tif, this all works fine.
 I then converted utm.tif to the Arc/Info Binary Grid format using ArcMap 10 (Conversion Tools - To Raster - Raster to other Format). When I try to use  GDALReadDirect.cs I get the following error messages:
 
  Using driver Arc/Info Binary Grid Band 1 : DataType: GDT_Int16 Size (512,512) PaletteInterp: GCI_Undefined OverView 0 : DataType: GDT_Int16 Size (256,256) PaletteInterp: GCI_GrayIndex OverView 1 : DataType: GDT_Int16 Size (128,128) PaletteInterp: GCI_GrayIndex The number of the raster bands is not enough to run this sample 
 GDALReadDirect.cs obviously has an erroneous method named SaveBitMapDirect, that first checks on the available Color interpretation and then on the number of bands. After the file is converted to Arc/Info binary Grid format, the information about the Color interpretation is lost, so only then the program checks on the number of available bands and returns an error message. SaveBitMapDirect works for the described case if Line 157 is edited:
 if (redBand.GetRasterColorInterpretation() == ColorInterp.GCI_GrayIndex || redBand.GetRasterColorInterpretation() == ColorInterp.GCI_Undefined)
 This is not a general fix, only for the immediate problem.
 
 
 

 Cheers,
 

 Markus
 

 

 







_______________________________________________
 gdal-dev mailing list
 gdal-dev at lists.osgeo.org
 http://lists.osgeo.org/mailman/listinfo/gdal-dev
 




-- 
---------------------------------------+--------------------------------------
 I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
 light and sound - activate the windows | http://pobox.com/~warmerdam
 and watch the world go round - Rush    | Geospatial Software Developer
 
  










-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
 light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
 


 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130509/df083e99/attachment.html>

From manoj.bist1 at gmail.com  Thu May  9 14:48:07 2013
From: manoj.bist1 at gmail.com (Manoj Bist)
Date: Thu, 9 May 2013 14:48:07 -0700
Subject: [gdal-dev] Bathymetry data for US reservoirs.
In-Reply-To: <CAGC+Sx7Sm1P-Kvrk4_NS1kpvj2RtGFsJ0VwyDn3Rmn7LdO023A@mail.gmail.com>
References: <CAGC+Sx79UzMrgV1mzfTaxUufzBe8XyMxKA0Q-4-5TQq2m7RCaQ@mail.gmail.com>
	<BLU175-W19EA85409B359070488549B2BA0@phx.gbl>
	<CAGC+Sx7Sm1P-Kvrk4_NS1kpvj2RtGFsJ0VwyDn3Rmn7LdO023A@mail.gmail.com>
Message-ID: <CAGC+Sx4-MtSUHrNtMiLH7NWU8NzQ=ZTTBhvuU+MWbDh1ifF6Zw@mail.gmail.com>

Does anyone know if there is any other forum/newsgroup that would be more
relevant for a query like this?
I would really appreciate any pointers regarding this.

Thanks,

--MB.

On Tue, May 7, 2013 at 9:57 AM, Manoj Bist <manoj.bist1 at gmail.com> wrote:

> Thanks a lot for the response Marius. I was able to find data for Texas on
> the  twdb website.
>
> I was looking for bathy data for  Lake Allatoona, Lake Lanier, Seminole
> (Georgia) etc.  Most of the USACE website/urls for data I have tried
> (including the spatial data clearing house) are either down or give random
> errors in the browser.
>
> I couldn't find any other website that might have backup/archive of USACE
> data.
>
> Thanks,
>
> --MB.
>
> On Tue, May 7, 2013 at 6:14 AM, Marius Jigmond <mariusjigmond at hotmail.com>wrote:
>
>> For Texas reservoirs you may contact Jason Kemp of the Texas Water
>> Development Board (see
>> http://www.twdb.texas.gov/surfacewater/surveys/index.asp for contact
>> info). He may have some data or may be able to point you in the right
>> direction.
>>
>> -marius
>>
>> ------------------------------
>> Date: Mon, 6 May 2013 20:58:27 -0700
>> From: manoj.bist1 at gmail.com
>> To: gdal-dev at lists.osgeo.org
>> Subject: [gdal-dev] Bathymetry data for US reservoirs.
>>
>>
>> Hi,
>>
>> I have been using gdal since past few months (without any issue).  I am
>> running into a non gdal  related issue pertaining to getting depth/bathy
>> data for reservoirs that I am interested in.
>>
>> I am looking for bathymetry data for some USACE reservoirs. I am told
>> this data used to be available in the USACE GIS data clearing house
>> website. But this website has been down for quite some time now. Does
>> anyone know if I can find the same data elsewhere? The following is the
>> link to USACE GIS clearing house but it has been down for quite a while now.
>>
>> http://corpsgeo1.usace.army.mil/
>>
>> I have wasted quite a bit of time searching for this (incl. contacting
>> USACE unsuccessfully both via phone and email). I would really appreciate
>> any pointers regarding this.
>>
>>  Thanks,
>>
>> --MB.
>>
>> _______________________________________________ gdal-dev mailing list
>> gdal-dev at lists.osgeo.org http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130509/03d33e15/attachment-0001.html>

From Aruna.Jayaraman at arkex.com  Thu May  9 23:22:30 2013
From: Aruna.Jayaraman at arkex.com (Aruna Jayaraman)
Date: Fri, 10 May 2013 07:22:30 +0100
Subject: [gdal-dev] Help! unresolved external symbol void __cdecl
 std::_Xlength_error(char const *)"
Message-ID: <C2FAB3BFBF66BF4095674E471F898C1509E98E49B3@THHS2E12BE2X.hostedservice2.net>

Hi,
  I am getting this following unresolved.
  I am building Debug Win32. ( Well I get this in Debug X64 as well) in Visual Studio 10 C++.

Error      503         error LNK2001: unresolved external symbol "void __cdecl std::_Xlength_error(char const *)" (?_Xlength_error at std@@YAXPBD at Z)     gdal.lib



Thanks and Regards
Aruna Jayaraman
Geophysics Software Developer
Tel: +44(0)1908 518 351 (direct)
Mob: +44(0) 7846230340
Hom:+44(0) 1908679367
Email: aruna.jayaraman at arkex.com<mailto:aruna.jayaraman at arkex.com>
ARKeX
ARKeX Ltd
www.arkex.com<http://www.arkex.com>
1 Mercers Manor Barns, Sherington, MK16 9PU
Tel: +44 (0)1908 613960
Fax: +44 (0)1908 518355
Registered address: Newton House, Cambridge Business Park, Cambridge CB4 0WZ. Registered in England No: 4255000.
The information in this email and any files transmitted with it are confidential and are intended solely for the addressee(s).  If you receive this email by mistake, please delete it and advise the sender immediately.  All messages sent and received by ARKeX Ltd are monitored for virus, high risk file extensions and inappropriate content.  As a result users should be aware that mail may be accessed.  The views expressed in this email may not be official policy, but the personal views of the originator.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130510/2a6b4d94/attachment.html>

From jp.alcantara at geographica.gs  Fri May 10 09:07:54 2013
From: jp.alcantara at geographica.gs (=?ISO-8859-1?Q?Juan_Pedro_P=E9rez_Alc=E1ntara?=)
Date: Fri, 10 May 2013 18:07:54 +0200
Subject: [gdal-dev] Datum shiftings
Message-ID: <CACFPushZ_mAu-m99Ss8iY9g6mN1j5XWN3RTL4Ddmq5pnAxhDbg@mail.gmail.com>

Hi there,

after spending a lot of time with gdaltransform, I'm at a loss trying to
figure out how to make a datum shifting using a NTv2 grid.

First, I'm not sure if GDAL use my PROJ4 installation to perform the
shifting. My PostGIS certainly does, as well as other software that relies
on PROJ. I've modified the CRS definitions that needs to use the grid on
the PROJ4 share data and that's all for those programs.

But I guess if GDAL uses its own methods to transform. I've been messing
with the pcs and gcs files, with the PROJ definitions in .wkt files, and
trying to incorporate my own WKT, but to no avail.

My questions are:

Does GDAL make use of the PROJ in my system? It seems to me that no.

How can I make GDAL to use a NTv2 grid to shift between some datums?

Thanks so much in advance,
Juan Pedro P?rez Alc?ntara
Technical Director
jp.alcantara at geographica.gs <alberto.asuero at geographica.gs>
+34 670 786 422
Rodio 35
41007 Sevilla
Spain
<http://maps.google.es/maps?f=q&source=s_q&hl=es&geocode=&q=rodio+35,+sevilla+espa%C3%B1a&sll=40.396764,-3.713379&sspn=10.787528,19.753418&ie=UTF8&hq=&hnear=Calle+Rodio,+35,+41007+Sevilla,+Andaluc%C3%ADa&t=h&z=16>
T  +34  954 437 818
F  +34  955 110 441
Visit our web
*www.geographica.gs*
<http://www.geographica.gs/>
Follow us on Twitter
*@Geographica_ST*
<https://twitter.com/#%21/Geographica_GS>
[image: Twitter] <https://twitter.com/#%21/Geographica_ST>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130510/3ce21edb/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: maps.png
Type: image/png
Size: 398 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130510/3ce21edb/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logo.png
Type: image/png
Size: 2424 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130510/3ce21edb/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: icon_twitter.png
Type: image/png
Size: 1196 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130510/3ce21edb/attachment-0002.png>

From andre+joost at nurfuerspam.de  Fri May 10 10:32:00 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 10 May 2013 19:32:00 +0200
Subject: [gdal-dev] Datum shiftings
In-Reply-To: <CACFPushZ_mAu-m99Ss8iY9g6mN1j5XWN3RTL4Ddmq5pnAxhDbg@mail.gmail.com>
References: <CACFPushZ_mAu-m99Ss8iY9g6mN1j5XWN3RTL4Ddmq5pnAxhDbg@mail.gmail.com>
Message-ID: <kmjavg$guf$1@ger.gmane.org>

Am 10.05.2013 18:07, schrieb Juan Pedro P?rez Alc?ntara:

>
> How can I make GDAL to use a NTv2 grid to shift between some datums?
>

You have to tell GDAL where to find your shift gridin your file system:

cs2cs +init=epsg:4326 +to +proj=tmerc +lat_0=0 +lon_0=6 +k=1 
+x_0=2500000 +y_0=0 +ellps=bessel 
+nadgrids=D:\Karten\gdal\cs2cs\BETA2007.gsb +units=m in.txt >>out.txt

HTH,
Andre Joost


From edison90110 at gmail.com  Fri May 10 20:38:00 2013
From: edison90110 at gmail.com (edison Qian)
Date: Sat, 11 May 2013 11:38:00 +0800
Subject: [gdal-dev] Help about GDAL
Message-ID: <CAPkHVDhFmvSKFWicYEvGbO9ikaiFTu2Ejo63xL1urJVKoe9ONQ@mail.gmail.com>

Dear List:

i have met an error about GDAL that when a cpp file including GDAL library
is coded, i compile this cpp file with following command in ubuntu bash:

    $g++ gdal_linux.cpp -I /usr/local/include/ -L /usr/local/lib/ -lgdal -o
aaa

it succeeds!
however, when i run file aaa, an error appears:

    error while loading shared libraries: libgdal.so.1: cannot open shared
object file: No such file or directory

which is similar to the one Wesley got:
http://lists.osgeo.org/pipermail/gdal-dev/2009-March/020128.html

i wonder whether this problem has been solved or not because i've not seen
any solutions to it.
Any help would be greatly appreciated.

Kind regards,
Edison
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130511/a557858a/attachment.html>

From eadam at co.lincoln.or.us  Sat May 11 09:13:08 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Sat, 11 May 2013 09:13:08 -0700
Subject: [gdal-dev] Help about GDAL
In-Reply-To: <CAPkHVDhFmvSKFWicYEvGbO9ikaiFTu2Ejo63xL1urJVKoe9ONQ@mail.gmail.com>
References: <CAPkHVDhFmvSKFWicYEvGbO9ikaiFTu2Ejo63xL1urJVKoe9ONQ@mail.gmail.com>
Message-ID: <CACqBkM894NCy865cHXS7EJgbtA6bmR+D78oAEn5JqqaUpAXxTA@mail.gmail.com>

Edison,

I've had similar problems (although for different reasons I think).  The
suggestions at the end of this are similar to what I've done to make it
work for me,
http://lists.osgeo.org/pipermail/gdal-dev/2009-March/020132.html

Sudo ldconfig might help too.

Regards, Eli
On May 10, 2013 8:38 PM, "edison Qian" <edison90110 at gmail.com> wrote:

> Dear List:
>
> i have met an error about GDAL that when a cpp file including GDAL library
> is coded, i compile this cpp file with following command in ubuntu bash:
>
>     $g++ gdal_linux.cpp -I /usr/local/include/ -L /usr/local/lib/ -lgdal
> -o aaa
>
> it succeeds!
> however, when i run file aaa, an error appears:
>
>     error while loading shared libraries: libgdal.so.1: cannot open shared
> object file: No such file or directory
>
> which is similar to the one Wesley got:
> http://lists.osgeo.org/pipermail/gdal-dev/2009-March/020128.html
>
> i wonder whether this problem has been solved or not because i've not seen
> any solutions to it.
> Any help would be greatly appreciated.
>
> Kind regards,
> Edison
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130511/c8c06aba/attachment.html>

From 2284168009 at qq.com  Mon May 13 00:56:07 2013
From: 2284168009 at qq.com (=?gb18030?B?wbrM7LO9?=)
Date: Mon, 13 May 2013 15:56:07 +0800
Subject: [gdal-dev] how to free p(OGRLinearRing *p = new OGRLinearRing();
	) properly
Message-ID: <tencent_246A5AC501F0C9B26E817AE6@qq.com>

Hi,
 
OGRLinearRing *p = new OGRLinearRing(); 
//that's a runtime error 
delete p;

I've tried OGRCleanupAll(); but it didn't work.

What is the proper way to free pointer p,thanks for your help!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/120be703/attachment.html>

From candini at meeo.it  Mon May 13 01:29:10 2013
From: candini at meeo.it (Alessandro Candini)
Date: Mon, 13 May 2013 10:29:10 +0200
Subject: [gdal-dev] Django 1.5.1,
	gdal 1.9.2: segmentation fault on DataSource import
Message-ID: <5190A456.5020502@meeo.it>

I cannot import gdal utilities anymore.

I was working on a project on an Arch Linux machine, using Django 1.5.1 
and GDAL 1.9.2.

Today I have updated my distro and the DataSource failed its import:
from django.contrib.gis.gdal import DataSource
...
Exception Value: cannot import name DataSource

Going back between exceptions, I found that the segmentation fault is 
caused by line 84 of 
/usr/lib/python2.7/site-packages/django/contrib/gis/gdal/libgdal.py:
ver = gdal_version().decode()

This is inside the gdal_version_info() function.

Have you got any idea on how to solve this?

Thanks.

From pierigis at gmail.com  Mon May 13 02:26:02 2013
From: pierigis at gmail.com (Pietro Rossin)
Date: Mon, 13 May 2013 02:26:02 -0700 (PDT)
Subject: [gdal-dev] ogr2ogr: dxf to postgis,
	is it possible to record dxf filename?
Message-ID: <1368437162258-5052840.post@n6.nabble.com>

Hello all
I must convert lots of dxf files to a postgis table
I wrote a python script to process a folder/subfolder and then create a
table into a postgis database and to load there all the features coming from
each dxf.
This script handle each single dxf file so I can track its name during the
loop process.
My question is,
is it possible to write the filename to the postgis table during each loop?

my loop is for the first dxf file:
ogr2ogr --config DXF_INLINE_BLOCKS FALSE --config DXF_MERGE_BLOCK_GEOMETRIES
FALSE -f "PostgreSQL" PG:"host= ' + host + " user=" + user + " dbname=" +
dbname + " password="+ pword + "\" " +" -lco DIM=3 " + file + " -where
\"Layer NOT LIKE 'X%'\"" +" -overwrite -a_srs EPSG:" + epsg + " entities"

All the others:

'ogr2ogr --config DXF_INLINE_BLOCKS FALSE --config
DXF_MERGE_BLOCK_GEOMETRIES FALSE -f "PostgreSQL" PG:"host= '	+ host + "
user=" + user + " dbname=" + dbname + " password="+ pword + "\" " + file + "
-where \"Layer NOT LIKE 'X%'\"" +" -append " +  "entities"

in_workspace, host, dbname, user, pword, epsg are parameters asked at the
beginning of the process, file comes from  a for loop process.

This creates a postgis table like this:
  ogc_fid serial NOT NULL,
  wkb_geometry geometry(GeometryZ,3004),
  layer character varying,
  subclasses character varying,
  extendedentity character varying,
  linetype character varying,
  entityhandle character varying,
  text character varying,
  blockname character varying,
  blockscale double precision[],
  blockangle double precision


So, How can I tell the script to add a field (let's say filename) in the
first passage and to fill it with file name values?
Sorry, but i'm not so skilled in python/ogr coding..
Thanks to all for any help
Pietro



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-dxf-to-postgis-is-it-possible-to-record-dxf-filename-tp5052840.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From tannasko at gmail.com  Mon May 13 03:03:38 2013
From: tannasko at gmail.com (tanasko)
Date: Mon, 13 May 2013 03:03:38 -0700 (PDT)
Subject: [gdal-dev] ECW support on Fedora Linux - error
In-Reply-To: <1366533183978-5048546.post@n6.nabble.com>
References: <1343399620972-4991388.post@n6.nabble.com>
	<1347381748551-5001142.post@n6.nabble.com>
	<CA+rY5eKjyhVm_U6saYJ-QdSqpLFMW+ihrpJZ_PKso5UW9hf09w@mail.gmail.com>
	<5050ED7A.6030109@gatewaygeomatics.com>
	<1366267156093-5047841.post@n6.nabble.com>
	<1366270727114-5047862.post@n6.nabble.com>
	<CAAJeQgsxEUz5XV4Tuu_GCEpTz1Nn=TqbsieZA+Jxx-aJ9t4ZxA@mail.gmail.com>
	<516FC4A0.4080002@free.fr>
	<CAAJeQgvk0nhxhN_-19fM7VFucDtoS0uTwcmM2dborvgEtSgZ9A@mail.gmail.com>
	<1366533183978-5048546.post@n6.nabble.com>
Message-ID: <1368439418444-5052857.post@n6.nabble.com>

Can I hope to get help from someone?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ECW-support-on-Fedora-Linux-error-tp4991388p5052857.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jp.alcantara at geographica.gs  Mon May 13 03:34:08 2013
From: jp.alcantara at geographica.gs (=?ISO-8859-1?Q?Juan_Pedro_P=E9rez_Alc=E1ntara?=)
Date: Mon, 13 May 2013 12:34:08 +0200
Subject: [gdal-dev] Datum shiftings
In-Reply-To: <kmjavg$guf$1@ger.gmane.org>
References: <CACFPushZ_mAu-m99Ss8iY9g6mN1j5XWN3RTL4Ddmq5pnAxhDbg@mail.gmail.com>
	<kmjavg$guf$1@ger.gmane.org>
Message-ID: <CACFPusiGhMm8Uk7A6SUHP5t_kScOUQCHEhv4VG-SpLqRB_WKmA@mail.gmail.com>

Hi Andre,

thanks so much for the quick answer, this is perfect for scripting.

However, I'm still wondering... is GDAL using the local PROJ4 installation?
Or does datum shiftings by itself? If so, why not to rely on PROJ4?

And using the grid is something we always want to do. Is there any place in
the GDAL config files where we can make the use of the grid permanent for a
datum shift case in particular?

Thanks a lot,


Juan Pedro P?rez Alc?ntara
Technical Director
jp.alcantara at geographica.gs <alberto.asuero at geographica.gs>
+34 670 786 422
Rodio 35
41007 Sevilla
Spain
<http://maps.google.es/maps?f=q&source=s_q&hl=es&geocode=&q=rodio+35,+sevilla+espa%C3%B1a&sll=40.396764,-3.713379&sspn=10.787528,19.753418&ie=UTF8&hq=&hnear=Calle+Rodio,+35,+41007+Sevilla,+Andaluc%C3%ADa&t=h&z=16>
T  +34  954 437 818
F  +34  955 110 441
Visit our web
*www.geographica.gs*
<http://www.geographica.gs/>
Follow us on Twitter
*@Geographica_ST*
<https://twitter.com/#%21/Geographica_GS>
[image: Twitter] <https://twitter.com/#%21/Geographica_ST>


On Fri, May 10, 2013 at 7:32 PM, Andre Joost <andre+joost at nurfuerspam.de>wrote:

> Am 10.05.2013 18:07, schrieb Juan Pedro P?rez Alc?ntara:
>
>
>> How can I make GDAL to use a NTv2 grid to shift between some datums?
>>
>>
> You have to tell GDAL where to find your shift gridin your file system:
>
> cs2cs +init=epsg:4326 +to +proj=tmerc +lat_0=0 +lon_0=6 +k=1 +x_0=2500000
> +y_0=0 +ellps=bessel +nadgrids=D:\Karten\gdal\**cs2cs\BETA2007.gsb
> +units=m in.txt >>out.txt
>
> HTH,
> Andre Joost
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/ba9fd45d/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: maps.png
Type: image/png
Size: 398 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/ba9fd45d/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: icon_twitter.png
Type: image/png
Size: 1196 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/ba9fd45d/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logo.png
Type: image/png
Size: 2424 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/ba9fd45d/attachment-0002.png>

From blaurent at heurisis.eu  Mon May 13 06:34:05 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Mon, 13 May 2013 15:34:05 +0200
Subject: [gdal-dev] Adding labels
In-Reply-To: <CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
	<5183662D.2000907@heurisis.eu>
	<CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
Message-ID: <5190EBCD.3020108@heurisis.eu>

Hello,

In a previous post, I was trying to automatically add labels to a vector 
layer, the text of each label being contained in one field of the layer.

I was proposed different solutions. I eventually chose to write a Python 
script that I run with the script runner from Gary Sherman : 
http://spatialgalaxy.net/2012/01/29/script-runner-a-plugin-to-run-python-scripts-in-qgis/. 
I can load all my shapefiles properly.

However, I am struggling with the labelling process. I had a try relying 
on an old post : 
http://svn.osgeo.org/qgis/trunk/code_examples/3_basic_labelling/tutorial3.t2t. 
For the moment, I was unsuccessfull. Furthermore, it seems that there is 
a new labelling engine...

Is there a sample of use somewhere ? Any help would be appreciated.

Beno?t

From tyler.mitchell at actian.com  Mon May 13 08:23:14 2013
From: tyler.mitchell at actian.com (Tyler Mitchell)
Date: Mon, 13 May 2013 08:23:14 -0700
Subject: [gdal-dev] Adding labels
In-Reply-To: <5190EBCD.3020108@heurisis.eu>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
	<5183662D.2000907@heurisis.eu>
	<CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
	<5190EBCD.3020108@heurisis.eu>
Message-ID: <77704AA4-5502-41DF-8FFD-71F7AA14C488@actian.com>

Hi Benoit, you'll probably have more luck if you ask on the QGIS mailing list, as GDAL helps with data access but not with the visualisation you are aiming for.

Best wishes,
Tyler

On 2013-05-13, at 6:34 AM, Beno?t Laurent wrote:

> Hello,
> 
> In a previous post, I was trying to automatically add labels to a vector layer, the text of each label being contained in one field of the layer.
> 
> I was proposed different solutions. I eventually chose to write a Python script that I run with the script runner from Gary Sherman : http://spatialgalaxy.net/2012/01/29/script-runner-a-plugin-to-run-python-scripts-in-qgis/. I can load all my shapefiles properly.
> 
> However, I am struggling with the labelling process. I had a try relying on an old post : http://svn.osgeo.org/qgis/trunk/code_examples/3_basic_labelling/tutorial3.t2t. For the moment, I was unsuccessfull. Furthermore, it seems that there is a new labelling engine...
> 
> Is there a sample of use somewhere ? Any help would be appreciated.
> 
> Beno?t
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



Tyler Mitchell
Engineering Director 
Actian Corporation
tyler.mitchell at actian.com

MOBILE 250-303-1831
SKYPE spatialguru
www.actian.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/8954bc7a/attachment-0001.html>

From blaurent at heurisis.eu  Mon May 13 08:36:16 2013
From: blaurent at heurisis.eu (=?ISO-8859-1?Q?Beno=EEt_Laurent?=)
Date: Mon, 13 May 2013 17:36:16 +0200
Subject: [gdal-dev] [SPAM?]:  Re:  Adding labels
In-Reply-To: <77704AA4-5502-41DF-8FFD-71F7AA14C488@actian.com>
References: <518285F3.2040801@heurisis.eu>
	<CAFJaAp4qkAY8ch7cws0QyciQ2TXPYo3JCdAMu0-SBo-GmkbF3Q@mail.gmail.com>
	<loom.20130502T182317-678@post.gmane.org>
	<5183662D.2000907@heurisis.eu>
	<CALQGVr2UXtdiPyd1ndj0VLAnFZ4GL7CtOP0bhj0+piY3r+LpZw@mail.gmail.com>
	<5190EBCD.3020108@heurisis.eu>
	<77704AA4-5502-41DF-8FFD-71F7AA14C488@actian.com>
Message-ID: <51910870.5040900@heurisis.eu>

Le 13/05/2013 17:23, Tyler Mitchell a ?crit :
> Hi Benoit, you'll probably have more luck if you ask on the QGIS 
> mailing list, as GDAL helps with data access but not with the 
> visualisation you are aiming for.
Ok, thank you.

Beno?t



From mihaela.gaspar at urbanrobotics.net  Mon May 13 08:53:28 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 08:53:28 -0700
Subject: [gdal-dev] Can't build gdal in x64
Message-ID: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>

I am trying to build GDAL (1.9.2) in x64.

In the instructions, I see:

# Uncomment the following if you are building for 64-bit windows#
(x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit#
compiles.!IF "$(PLATFORM)" == "x64"
WIN64=YES!ENDIF

And then, lower,

# Under win64, symbols for function names lack the underscore prefix#
present on win32. Also the STDCALL calling convention is not
used.!IFDEF WIN64!UNDEF STDCALL!ELSE
SYM_PREFIX=_!ENDIF

Can't find a PATH, INCLUDE and LIB specific for x64, or anything else that
I should do...

I can build in Win32.

In x64, I get linker errors:

LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
LINK : error LNK2001: unresolved external symbol _OSRValidate...
gdal19.dll : fatal error LNK1120: 74 unresolved externals

Please help.

Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/05ccfccb/attachment.html>

From andre+joost at nurfuerspam.de  Mon May 13 09:11:54 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 13 May 2013 18:11:54 +0200
Subject: [gdal-dev] Datum shiftings
In-Reply-To: <CACFPusiGhMm8Uk7A6SUHP5t_kScOUQCHEhv4VG-SpLqRB_WKmA@mail.gmail.com>
References: <CACFPushZ_mAu-m99Ss8iY9g6mN1j5XWN3RTL4Ddmq5pnAxhDbg@mail.gmail.com>
	<kmjavg$guf$1@ger.gmane.org>
	<CACFPusiGhMm8Uk7A6SUHP5t_kScOUQCHEhv4VG-SpLqRB_WKmA@mail.gmail.com>
Message-ID: <kmr3i8$2kf$1@ger.gmane.org>

Am 13.05.2013 12:34, schrieb Juan Pedro P?rez Alc?ntara:

>
> However, I'm still wondering... is GDAL using the local PROJ4 installation?
> Or does datum shiftings by itself? If so, why not to rely on PROJ4?

GDAL brings its own database, which is in sync with PROJ4. At least on 
Windows it will not look at other installations of PROJ.

Other Software handle projections and datum shifts seperately. For 
PROJ/GDAL it was decided to bundle them together in EPSG-Codes, which 
may lead to false results if users of other software reprojected with 
other parametres. And you should consider that datum shifts may be 
altered from one GDAL/PROJ version to the next, because local 
authorities may have published better shift parametres.

>
> And using the grid is something we always want to do. Is there any place in
> the GDAL config files where we can make the use of the grid permanent for a
> datum shift case in particular?

Only the North American grids are hardcoded in PROJ:

http://trac.osgeo.org/proj/browser/trunk/proj/src/pj_datums.c

And GDAL ist using them as well. You are free to add your datum, and 
compile from source for yourself.

Greetings,
Andr? Joost


From Ralf.Suhr at itc-halle.de  Mon May 13 09:01:29 2013
From: Ralf.Suhr at itc-halle.de (Ralf Suhr)
Date: Mon, 13 May 2013 18:01:29 +0200
Subject: [gdal-dev] ogr2ogr: dxf to postgis,
	is it possible to record dxf filename?
In-Reply-To: <1368437162258-5052840.post@n6.nabble.com>
References: <1368437162258-5052840.post@n6.nabble.com>
Message-ID: <201305131801.29766.Ralf.Suhr@itc-halle.de>

Hello Pietro,

you can use the -sql switch to add a extra value.

ogrinfo -sql "SELECT 'filename' AS source,* FROM entities" File.dxf


Gr
Ralf

On Montag 13 Mai 2013 11:26:02 Pietro Rossin wrote:
   Hello all
   I must convert lots of dxf files to a postgis table
   I wrote a python script to process a folder/subfolder and then create a
   table into a postgis database and to load there all the features coming
   from each dxf.
   This script handle each single dxf file so I can track its name during the
   loop process.
   My question is,
   is it possible to write the filename to the postgis table during each
   loop?
   
   my loop is for the first dxf file:
   ogr2ogr --config DXF_INLINE_BLOCKS FALSE --config
   DXF_MERGE_BLOCK_GEOMETRIES FALSE -f "PostgreSQL" PG:"host= ' + host + "
   user=" + user + " dbname=" + dbname + " password="+ pword + "\" " +" -lco
   DIM=3 " + file + " -where \"Layer NOT LIKE 'X%'\"" +" -overwrite -a_srs
   EPSG:" + epsg + " entities"
   
   All the others:
   
   'ogr2ogr --config DXF_INLINE_BLOCKS FALSE --config
   DXF_MERGE_BLOCK_GEOMETRIES FALSE -f "PostgreSQL" PG:"host= '	+ host + "
   user=" + user + " dbname=" + dbname + " password="+ pword + "\" " + file +
   " -where \"Layer NOT LIKE 'X%'\"" +" -append " +  "entities"
   
   in_workspace, host, dbname, user, pword, epsg are parameters asked at the
   beginning of the process, file comes from  a for loop process.
   
   This creates a postgis table like this:
     ogc_fid serial NOT NULL,
     wkb_geometry geometry(GeometryZ,3004),
     layer character varying,
     subclasses character varying,
     extendedentity character varying,
     linetype character varying,
     entityhandle character varying,
     text character varying,
     blockname character varying,
     blockscale double precision[],
     blockangle double precision
   
   
   So, How can I tell the script to add a field (let's say filename) in the
   first passage and to fill it with file name values?
   Sorry, but i'm not so skilled in python/ogr coding..
   Thanks to all for any help
   Pietro
   
   
   
   --
   View this message in context:
   http://osgeo-org.1560.x6.nabble.com/ogr2ogr-dxf-to-postgis-is-it-possible
   -to-record-dxf-filename-tp5052840.html Sent from the GDAL - Dev mailing
   list archive at Nabble.com.
   _______________________________________________
   gdal-dev mailing list
   gdal-dev at lists.osgeo.org
   http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/dd4a0f18/attachment-0001.html>

From mihaela.gaspar at urbanrobotics.net  Mon May 13 11:14:58 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 11:14:58 -0700
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
Message-ID: <CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>

More info on issue: I seem to build from VS but not from command line.

I put (to build in Win32)

!IFNDEF PLATFORM
PLATFORM=WIN32!ENDIF

Modified to

!IFNDEF PLATFORM
PLATFORM=x64!ENDIF

(to build in x64) - And it worked. But only if I build from inside Visual
Studio.

I would like to be able to use a bat file (and build alll
platform/configurations) The above - while it builds in VS, it will not
build from command line (with commands:

start /b /wait nmake -f makefile.vc clean
start /b /wait nmake.exe /f makefile.vc PLATFORM=x64
start /b /wait nmake.exe /f makefile.vc devinstall PLATFORM=x64

The exact same thing builds in Win32...



On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar <
mihaela.gaspar at urbanrobotics.net> wrote:

> I am trying to build GDAL (1.9.2) in x64.
>
> In the instructions, I see:
>
> # Uncomment the following if you are building for 64-bit windows# (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit# compiles.!IF "$(PLATFORM)" == "x64"
> WIN64=YES!ENDIF
>
>  And then, lower,
>
> # Under win64, symbols for function names lack the underscore prefix# present on win32. Also the STDCALL calling convention is not used.!IFDEF WIN64!UNDEF STDCALL!ELSE
> SYM_PREFIX=_!ENDIF
>
>  Can't find a PATH, INCLUDE and LIB specific for x64, or anything else
> that I should do...
>
> I can build in Win32.
>
> In x64, I get linker errors:
>
> LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
> LINK : error LNK2001: unresolved external symbol _OSRValidate...
> gdal19.dll : fatal error LNK1120: 74 unresolved externals
>
>  Please help.
>
> Thank you.
>
>
>
>


-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/d0de6200/attachment.html>

From chapmanm at pixia.com  Mon May 13 11:20:23 2013
From: chapmanm at pixia.com (Martin Chapman)
Date: Mon, 13 May 2013 14:20:23 -0400 (EDT)
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
Message-ID: <158e43d2.0000182c.0000000f@CHAPMANM7.pixia.local>

Mihaela,

 

You have to run nmake from the VC x64 command line window.  

 

Goto:

Start Menu->All Programs->Microsoft Visual Studio 2010->Visual Studio
Tools->Visual Studio x64 Win64 Command Prompt (2010)

 

That will run the appropriate bat file for nmake and setup the x64
compiler options.  CD to your gdal dir then run nmake /f makefile.vc from
there.

 

Best regards,

Martin

 

From: gdal-dev-bounces at lists.osgeo.org
[mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Mihaela Gaspar
Sent: Monday, May 13, 2013 12:15 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Can't build gdal in x64

 

More info on issue: I seem to build from VS but not from command line.

 

I put (to build in Win32)

 
!IFNDEF PLATFORM
PLATFORM=WIN32
!ENDIF

Modified to

 
!IFNDEF PLATFORM
PLATFORM=x64
!ENDIF

(to build in x64) - And it worked. But only if I build from inside Visual
Studio.

I would like to be able to use a bat file (and build alll
platform/configurations) The above - while it builds in VS, it will not
build from command line (with commands:

 
start /b /wait nmake -f makefile.vc clean
start /b /wait nmake.exe /f makefile.vc PLATFORM=x64
start /b /wait nmake.exe /f makefile.vc devinstall PLATFORM=x64

The exact same thing builds in Win32...

 

 

On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar
<mihaela.gaspar at urbanrobotics.net> wrote:

I am trying to build GDAL (1.9.2) in x64.

In the instructions, I see:

 
# Uncomment the following if you are building for 64-bit windows
# (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit
# compiles.
!IF "$(PLATFORM)" == "x64"
WIN64=YES
!ENDIF

And then, lower,

 
# Under win64, symbols for function names lack the underscore prefix
# present on win32. Also the STDCALL calling convention is not used.
!IFDEF WIN64
!UNDEF STDCALL
!ELSE
SYM_PREFIX=_
!ENDIF

Can't find a PATH, INCLUDE and LIB specific for x64, or anything else that
I should do...

I can build in Win32.

In x64, I get linker errors:

 
LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
LINK : error LNK2001: unresolved external symbol _OSRValidate
...
gdal19.dll : fatal error LNK1120: 74 unresolved externals

Please help.

Thank you.

 

		





 

-- 




Mihaela Gaspar

Urban Robotics Inc.
Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

 <mailto:mihaela.gaspar at urbanrobotics.net>
mihaela.gaspar at urbanrobotics.net  
 <http://www.urbanrobotics.net/> http://www.urbanrobotics.net

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/70f7575c/attachment-0001.html>

From jluis at ualg.pt  Mon May 13 11:29:12 2013
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 13 May 2013 19:29:12 +0100
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
Message-ID: <519130F8.5050604@ualg.pt>

Mihael,

To build with nmake command line all you need (plus the uncomment of 
x64) is to run the command from a command shell that has the apropriate 
variables set to build for 64 bits.

For example, this is what I do to set up one 64 bits building 
environment (it's called from within another batch file)

call "C:\Program Files (x86)\Microsoft Visual Studio 
10.0\VC\vcvarsall.bat" amd64

Joaquim

> More info on issue: I seem to build from VS but not from command line.
>
> I put (to build in Win32)
>
> |!IFNDEF PLATFORM
> PLATFORM=WIN32
> !ENDIF|
>
> Modified to
>
> |!IFNDEF PLATFORM
> PLATFORM=x64
> !ENDIF|
>
> (to build in x64) - And it worked. But only if I build from inside 
> Visual Studio.
>
> I would like to be able to use a bat file (and build alll 
> platform/configurations) The above - while it builds in VS, it will 
> not build from command line (with commands:
>
> |start/b/wait nmake-f makefile.vc clean
> start/b/wait nmake.exe/f makefile.vc PLATFORM=x64
> start/b/wait nmake.exe/f makefile.vc devinstall PLATFORM=x64|
>
> The exact same thing builds in Win32...
>
>
>
>
> On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar 
> <mihaela.gaspar at urbanrobotics.net 
> <mailto:mihaela.gaspar at urbanrobotics.net>> wrote:
>
>     I am trying to build GDAL (1.9.2) in x64.
>
>     In the instructions, I see:
>
>     |# Uncomment the following if you are building for 64-bit windows
>     # (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit
>     # compiles.
>     !IF"$(PLATFORM)"  ==  "x64"
>     WIN64=YES
>     !ENDIF|
>
>     And then, lower,
>
>     |# Under win64, symbols for function names lack the underscore prefix
>     # present on win32. Also the STDCALL calling convention is not used.
>     !IFDEF WIN64
>     !UNDEF STDCALL
>     !ELSE
>     SYM_PREFIX=_
>     !ENDIF|
>
>     Can't find a PATH, INCLUDE and LIB specific for x64, or anything
>     else that I should do...
>
>     I can build in Win32.
>
>     In x64,I get linker errors:
>
>     |LINK:  error LNK2001:  unresolved external symbol_OGRFeatureStylePuller
>     LINK:  error LNK2001:  unresolved external symbol_OSRValidate
>     ...
>     gdal19.dll:  fatal error LNK1120:  74  unresolved externals|
>
>     Please help.
>
>     Thank you.
>
>
>
>     	
>
>
>
>
> -- 
>
>
> *Mihaela Gaspar* 	
>
> *Urban Robotics Inc.**
> *Software Engineer
>
> 33 NW First Avenue, Suite 200 | Portland, OR 97209
>
> c: 971-269-9649
>
> mihaela.gaspar at urbanrobotics.net <mailto:mihaela.gaspar at urbanrobotics.net>
> http://www.urbanrobotics.net <http://www.urbanrobotics.net/>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/01b33863/attachment-0001.html>

From mihaela.gaspar at urbanrobotics.net  Mon May 13 11:38:42 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 11:38:42 -0700
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <158e43d2.0000182c.0000000f@CHAPMANM7.pixia.local>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
	<158e43d2.0000182c.0000000f@CHAPMANM7.pixia.local>
Message-ID: <CACwvHmppLSG0QXOgHv0q0Eu1vhM5dF+uSv6unw6xR=b+xCHU8g@mail.gmail.com>

Thank you Martin. But... Did this. Same result, same linker errors.

On Mon, May 13, 2013 at 11:20 AM, Martin Chapman <chapmanm at pixia.com> wrote:

> Mihaela,****
>
> ** **
>
> You have to run nmake from the VC x64 command line window.  ****
>
> ** **
>
> Goto:****
>
> Start Menu->All Programs->Microsoft Visual Studio 2010->Visual Studio
> Tools->Visual Studio x64 Win64 Command Prompt (2010)****
>
> ** **
>
> That will run the appropriate bat file for nmake and setup the x64
> compiler options.  CD to your gdal dir then run nmake /f makefile.vc from
> there.****
>
> ** **
>
> Best regards,****
>
> Martin****
>
> ** **
>
> *From:* gdal-dev-bounces at lists.osgeo.org [mailto:
> gdal-dev-bounces at lists.osgeo.org] *On Behalf Of *Mihaela Gaspar
> *Sent:* Monday, May 13, 2013 12:15 PM
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] Can't build gdal in x64****
>
> ** **
>
> More info on issue: I seem to build from VS but not from command line.****
>
> ** **
>
> I put (to build in Win32)****
>
> ** **
>
> !IFNDEF PLATFORM****
>
> PLATFORM=WIN32****
>
> !ENDIF****
>
> Modified to****
>
> ** **
>
> !IFNDEF PLATFORM****
>
> PLATFORM=x64****
>
> !ENDIF****
>
> (to build in x64) - And it worked. But only if I build from inside Visual
> Studio.****
>
> I would like to be able to use a bat file (and build alll
> platform/configurations) The above - while it builds in VS, it will not
> build from command line (with commands:****
>
> ** **
>
> start /b /wait nmake -f makefile.vc clean****
>
> start /b /wait nmake.exe /f makefile.vc PLATFORM=x64****
>
> start /b /wait nmake.exe /f makefile.vc devinstall PLATFORM=x64****
>
> The exact same thing builds in Win32...****
>
> ** **
>
> ** **
>
> On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar <
> mihaela.gaspar at urbanrobotics.net> wrote:****
>
> I am trying to build GDAL (1.9.2) in x64.****
>
> In the instructions, I see:****
>
> ** **
>
> # Uncomment the following if you are building for 64-bit windows****
>
> # (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit****
>
> # compiles.****
>
> !IF "$(PLATFORM)" == "x64"****
>
> WIN64=YES****
>
> !ENDIF****
>
> And then, lower,****
>
> ** **
>
> # Under win64, symbols for function names lack the underscore prefix****
>
> # present on win32. Also the STDCALL calling convention is not used.****
>
> !IFDEF WIN64****
>
> !UNDEF STDCALL****
>
> !ELSE****
>
> SYM_PREFIX=_****
>
> !ENDIF****
>
> Can't find a PATH, INCLUDE and LIB specific for x64, or anything else that
> I should do...****
>
> I can build in Win32.****
>
> In x64, I get linker errors:****
>
> ** **
>
> LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller****
>
> LINK : error LNK2001: unresolved external symbol _OSRValidate****
>
> ...****
>
> gdal19.dll : fatal error LNK1120: 74 unresolved externals****
>
> Please help.****
>
> Thank you.****
>
> ** **
>
>
>
> ****
>
> ** **
>
> -- ****
>
>
>
> *Mihaela Gaspar*****
>
> *Urban Robotics Inc.**
> *Software Engineer****
>
> 33 NW First Avenue, Suite 200 | Portland, OR 97209****
>
> c: 971-269-9649****
>
> mihaela.gaspar at urbanrobotics.net
> http://www.urbanrobotics.net****
>
> ** **
>



-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/7b4b71be/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Mon May 13 11:43:29 2013
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 13 May 2013 15:43:29 -0300
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
Message-ID: <51913451.1030608@gatewaygeomatics.com>

On 2013-05-13 12:53 PM, Mihaela Gaspar wrote:
> 
> In x64,I get linker errors:
> 
> |LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
> LINK : error LNK2001: unresolved external symbol _OSRValidate
> ...
> gdal19.dll : fatal error LNK1120: 74 unresolved externals|
> 

Note that before I switch from building GDAL from x32 to x64, I have to
rebuild *all* of the dependent libraries in x64 (this is the hardest
part of the whole process).

Also note to make sure that you run "nmake /f makefile.vc clean" before
each build.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From mihaela.gaspar at urbanrobotics.net  Mon May 13 11:51:39 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 11:51:39 -0700
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <51913451.1030608@gatewaygeomatics.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<51913451.1030608@gatewaygeomatics.com>
Message-ID: <CACwvHmqvMzV4q79JOx+anzrA8SzAP5yGGZubq5gEK3WAs41sKw@mail.gmail.com>

Thank you.
I have all the dependent libraries built in Win32 and x64, and have set the
correct paths to platform/configuration
Also, pls see my question update - before building, I run a clean.

On Mon, May 13, 2013 at 11:43 AM, Jeff McKenna <
jmckenna at gatewaygeomatics.com> wrote:

> On 2013-05-13 12:53 PM, Mihaela Gaspar wrote:
> >
> > In x64,I get linker errors:
> >
> > |LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
> > LINK : error LNK2001: unresolved external symbol _OSRValidate
> > ...
> > gdal19.dll : fatal error LNK1120: 74 unresolved externals|
> >
>
> Note that before I switch from building GDAL from x32 to x64, I have to
> rebuild *all* of the dependent libraries in x64 (this is the hardest
> part of the whole process).
>
> Also note to make sure that you run "nmake /f makefile.vc clean" before
> each build.
>
> -jeff
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> http://www.gatewaygeomatics.com/
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/7e527c76/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Mon May 13 11:59:35 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 11:59:35 -0700
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmqvMzV4q79JOx+anzrA8SzAP5yGGZubq5gEK3WAs41sKw@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<51913451.1030608@gatewaygeomatics.com>
	<CACwvHmqvMzV4q79JOx+anzrA8SzAP5yGGZubq5gEK3WAs41sKw@mail.gmail.com>
Message-ID: <CACwvHmqbATydk03WUR_MzpHcOLaWHoov4MibHFVJvkgBYQ1ymA@mail.gmail.com>

The solution from Joaquim Luis worked.
I used

call "C:\Program Files (x86)\Microsoft Visual Studio
10.0\VC\vcvarsall.bat" amd64

Thank you !


On Mon, May 13, 2013 at 11:51 AM, Mihaela Gaspar <
mihaela.gaspar at urbanrobotics.net> wrote:

> Thank you.
> I have all the dependent libraries built in Win32 and x64, and have set
> the correct paths to platform/configuration
> Also, pls see my question update - before building, I run a clean.
>
>
> On Mon, May 13, 2013 at 11:43 AM, Jeff McKenna <
> jmckenna at gatewaygeomatics.com> wrote:
>
>> On 2013-05-13 12:53 PM, Mihaela Gaspar wrote:
>> >
>> > In x64,I get linker errors:
>> >
>> > |LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
>> > LINK : error LNK2001: unresolved external symbol _OSRValidate
>> > ...
>> > gdal19.dll : fatal error LNK1120: 74 unresolved externals|
>> >
>>
>> Note that before I switch from building GDAL from x32 to x64, I have to
>> rebuild *all* of the dependent libraries in x64 (this is the hardest
>> part of the whole process).
>>
>> Also note to make sure that you run "nmake /f makefile.vc clean" before
>> each build.
>>
>> -jeff
>>
>>
>> --
>> Jeff McKenna
>> MapServer Consulting and Training Services
>> http://www.gatewaygeomatics.com/
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
>
> *Mihaela Gaspar*
>
> *Urban Robotics Inc.**
> *Software Engineer
>
> 33 NW First Avenue, Suite 200 | Portland, OR 97209
>
> c: 971-269-9649
>
> mihaela.gaspar at urbanrobotics.net
> http://www.urbanrobotics.net
>



-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/4d40d618/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Mon May 13 12:03:44 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Mon, 13 May 2013 12:03:44 -0700
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <519130F8.5050604@ualg.pt>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>
	<519130F8.5050604@ualg.pt>
Message-ID: <CACwvHmovpgVkFMtyEBirteWV5YJG31SBNjUT4A+XhNtgwbvnbQ@mail.gmail.com>

Thank you, this worked !!

On Mon, May 13, 2013 at 11:29 AM, Joaquim Luis <jluis at ualg.pt> wrote:

>  Mihael,
>
> To build with nmake command line all you need (plus the uncomment of x64)
> is to run the command from a command shell that has the apropriate
> variables set to build for 64 bits.
>
> For example, this is what I do to set up one 64 bits building environment
> (it's called from within another batch file)
>
>
> call "C:\Program Files (x86)\Microsoft Visual Studio
> 10.0\VC\vcvarsall.bat" amd64
>
> Joaquim
>
> More info on issue: I seem to build from VS but not from command line.
>
>   I put (to build in Win32)
>
> !IFNDEF PLATFORM
> PLATFORM=WIN32!ENDIF
>
>  Modified to
>
> !IFNDEF PLATFORM
> PLATFORM=x64!ENDIF
>
>  (to build in x64) - And it worked. But only if I build from inside Visual
> Studio.
>
> I would like to be able to use a bat file (and build alll
> platform/configurations) The above - while it builds in VS, it will not
> build from command line (with commands:
>
> start /b /wait nmake -f makefile.vc clean
> start /b /wait nmake.exe /
> f ma
>  kefile<
> /span>.vc PLATFORM=x64
> start /b /wait nmake.exe /f ma
>  kefile<
> /span>.vc devinstall PLATFORM=x64
>
>  The exact same thing builds in Win32...
>
>
>
> On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar <
> mihaela.gaspar at urbanrobotics.net> wrote:
>
>>  I am trying to build GDAL (1.9.2) in x64.
>>
>> In the instructions, I see:
>>
>> # Uncomment the following if you are building for 64-bit windows# (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit# compiles.!IF "$(PLATFORM)" == "x64"
>> WIN64=YES!ENDIF
>>
>>  And then, lower,
>>
>> # Under win64, symbols for function names lack the underscore prefix# present on win32. Also the STDCALL calling convention is not used.!IFDEF WIN64!UNDEF STDCALL!ELSE
>> SYM_PREFIX=_!ENDIF
>>
>>  Can't find a PATH, INCLUDE and LIB specific for x64, or anything else
>> that I should do...
>>
>> I can build in Win32.
>>
>> In x64, I get linker errors:
>>
>> LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
>> LINK : error LNK2001: unresolved external symbol _OSRValidate...
>> gdal19.dll : fatal error LNK1120: 74 unresolved externals
>>
>>  Please help.
>>
>> Thank you.
>>
>>
>>
>>
>
>
>  --
>
>
> *Mihaela Gaspar*
>
> *Urban Robotics Inc.**
> *Software Engineer
>
> 33 NW First Avenue, Suite 200 | Portland, OR 97209
>
> c: 971-269-9649
>
> mihaela.gaspar at urbanrobotics.net
> http://www.urbanrobotics.net
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>


-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/2d57c1b1/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Mon May 13 12:04:07 2013
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 13 May 2013 16:04:07 -0300
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmqbATydk03WUR_MzpHcOLaWHoov4MibHFVJvkgBYQ1ymA@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>
	<51913451.1030608@gatewaygeomatics.com>
	<CACwvHmqvMzV4q79JOx+anzrA8SzAP5yGGZubq5gEK3WAs41sKw@mail.gmail.com>
	<CACwvHmqbATydk03WUR_MzpHcOLaWHoov4MibHFVJvkgBYQ1ymA@mail.gmail.com>
Message-ID: <51913927.203@gatewaygeomatics.com>

That's great news.  For good karma, you could now add your notes (think
of what you got stuck on for x64) to the BuildHints page:
http://trac.osgeo.org/gdal/wiki/BuildingOnWindows

Thanks,

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2013-05-13 3:59 PM, Mihaela Gaspar wrote:
> The solution from Joaquim Luis worked.
> I used
> 
> call "C:\Program Files (x86)\Microsoft Visual Studio 
> 10.0\VC\vcvarsall.bat" amd64
> 
> Thank you !


From 2284168009 at qq.com  Mon May 13 18:47:11 2013
From: 2284168009 at qq.com (=?gb18030?B?wbrM7LO9?=)
Date: Tue, 14 May 2013 09:47:11 +0800
Subject: [gdal-dev] [ogr_geometry.h ]Detected memory leaks when using c++
	operator new
Message-ID: <tencent_681D090248A35D4E17690C00@qq.com>

Hello all 

The following function uses c++ operator new to get a pointer of OGRLinearRing and modified that ring. Before the function returns, it's neccessary to delete that pointer,but  "delete poFLinear;" will cause a runtime error and the program stops running. What should I do to delete that pointer? Thanks.

 
int GetWSInfo(const vector<Point> &ring,OUT CWSInfo & wsinfo)
{
 OGRLinearRing *poFLinear = new OGRLinearRing();
 poFLinear->setPoints(ring.size(),(OGRRawPoint*)(&ring[0]));
 poFLinear->closeRings();
 OGRPolygon * poFPoly = new OGRPolygon();
 poFPoly->addRingDirectly(poFLinear);
 wsinfo.WSAREA = poFLinear->get_Area();
 wsinfo.WSPERI = poFLinear->get_Length();
 //delete poFLinear;
 //delete poFPoly;
 return RETURN_OK;
}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/f050a677/attachment.html>

From warmerdam at pobox.com  Mon May 13 19:51:31 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 13 May 2013 19:51:31 -0700
Subject: [gdal-dev] [ogr_geometry.h ]Detected memory leaks when using
 c++ operator new
In-Reply-To: <tencent_681D090248A35D4E17690C00@qq.com>
References: <tencent_681D090248A35D4E17690C00@qq.com>
Message-ID: <CA+YzLBcVy0UyEM8x6v6-Krmg0qx+mB5YOfWj8J9xpV2_6eJsSw@mail.gmail.com>

???,

I am guessing you are working on Windows and are running into problems with
a mix of runtime heaps. I would suggest avoiding using new and delete
directly and instead leaving everything to functions from the GDAL DLL.

I believe you should use OGRGeometryFactory::createGeometry(wkbLinearRing)
to create the linear ring (use wkbPolygon for the polygon) and
OGRGeometryFactory::destroyGeometry() to destroy geometries.

Keep in mind that addRingDirectly() transfers ownership of the ring to the
polygon so you should not destroy the ring after that.  It will be cleaned
up by the polygon when that is destroyed.

Best regards,
Frank



On Mon, May 13, 2013 at 6:47 PM, ??? <2284168009 at qq.com> wrote:

> Hello all
>
> The following function uses c++ operator new to get a pointer of
> OGRLinearRing and modified that ring. Before the function returns, it's
> neccessary to delete that pointer,but  "delete poFLinear;" will cause a
> runtime error and the program stops running. What should I do to delete
> that pointer? Thanks.
>
>
> int GetWSInfo(const vector<Point> &ring,OUT CWSInfo & wsinfo)
> {
>  OGRLinearRing *poFLinear = new OGRLinearRing();
>  poFLinear->setPoints(ring.size(),(OGRRawPoint*)(&ring[0]));
>  poFLinear->closeRings();
>  OGRPolygon * poFPoly = new OGRPolygon();
>  poFPoly->addRingDirectly(poFLinear);
>  wsinfo.WSAREA = poFLinear->get_Area();
>  wsinfo.WSPERI = poFLinear->get_Length();
>  //delete poFLinear;
>  //delete poFPoly;
>  return RETURN_OK;
> }
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130513/ebbbcbda/attachment.html>

From gillingham.sam at gmail.com  Mon May 13 21:37:10 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Tue, 14 May 2013 16:37:10 +1200
Subject: [gdal-dev] Raster Attribute Table RFC
Message-ID: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>

Hi All,

I propose a motion to get RFC 40 - "Improving performance of Raster
Attribute Table implementation for large tables" adopted. This adds some
new functionality for GDAL 2.0. Even and others have made suggestions and
these have been incorporated into the RFC:

http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support

Thanks,
Sam.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/90c5f0b4/attachment.html>

From chapmanm at pixia.com  Tue May 14 09:12:48 2013
From: chapmanm at pixia.com (Martin Chapman)
Date: Tue, 14 May 2013 12:12:48 -0400 (EDT)
Subject: [gdal-dev] Can't build gdal in x64
In-Reply-To: <CACwvHmovpgVkFMtyEBirteWV5YJG31SBNjUT4A+XhNtgwbvnbQ@mail.gmail.com>
References: <CACwvHmobDrHiHfnn5PktX=WSZbtw1jtYzE8+PR5f_S1a2VGw0w@mail.gmail.com>	<CACwvHmqLk6Wug7cDPf3TKh63cP31i_jtmE+AHP1R7dNQALSeHQ@mail.gmail.com>	<519130F8.5050604@ualg.pt>
	<CACwvHmovpgVkFMtyEBirteWV5YJG31SBNjUT4A+XhNtgwbvnbQ@mail.gmail.com>
Message-ID: <38e6a5de.00001dc0.00000008@CHAPMANM7S>

FYI,

 

This is the same as doing:

 

Start Menu->All Programs->Microsoft Visual Studio 2010->Visual Studio
Tools->Visual Studio x64 Cross Tools Command Prompt (2010)

 

If you look at the properties of the shortcut it launches the same bat
file.

 

Best regards,

Martin

 

From: gdal-dev-bounces at lists.osgeo.org
[mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Mihaela Gaspar
Sent: Monday, May 13, 2013 1:04 PM
To: Joaquim Luis
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Can't build gdal in x64

 

Thank you, this worked !!

On Mon, May 13, 2013 at 11:29 AM, Joaquim Luis <jluis at ualg.pt> wrote:

Mihael,

To build with nmake command line all you need (plus the uncomment of x64)
is to run the command from a command shell that has the apropriate
variables set to build for 64 bits.

For example, this is what I do to set up one 64 bits building environment
(it's called from within another batch file)



call "C:\Program Files (x86)\Microsoft Visual Studio
10.0\VC\vcvarsall.bat" amd64

Joaquim




More info on issue: I seem to build from VS but not from command line. 

 

I put (to build in Win32)

 
!IFNDEF PLATFORM
PLATFORM=WIN32
!ENDIF

Modified to

 
!IFNDEF PLATFORM
PLATFORM=x64
!ENDIF

(to build in x64) - And it worked. But only if I build from inside Visual
Studio.

I would like to be able to use a bat file (and build alll
platform/configurations) The above - while it builds in VS, it will not
build from command line (with commands:

 
 
start /b /wait nmake -f makefile.vc clean
start /b /wait nmake.exe /
 
f ma
 kefile<
/span>.vc PLATFORM=x64
start /b /wait nmake.exe /f ma
 kefile<
/span>.vc devinstall PLATFORM=x64

The exact same thing builds in Win32...

 

 

On Mon, May 13, 2013 at 8:53 AM, Mihaela Gaspar
<mihaela.gaspar at urbanrobotics.net> wrote:

I am trying to build GDAL (1.9.2) in x64.

In the instructions, I see:

 
# Uncomment the following if you are building for 64-bit windows
# (x64). You'll need to have PATH, INCLUDE and LIB set up for 64-bit
# compiles.
!IF "$(PLATFORM)" == "x64"
WIN64=YES
!ENDIF

And then, lower,

 
# Under win64, symbols for function names lack the underscore prefix
# present on win32. Also the STDCALL calling convention is not used.
!IFDEF WIN64
!UNDEF STDCALL
!ELSE
SYM_PREFIX=_
!ENDIF

Can't find a PATH, INCLUDE and LIB specific for x64, or anything else that
I should do...

I can build in Win32.

In x64, I get linker errors:

 
LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller
LINK : error LNK2001: unresolved external symbol _OSRValidate
...
gdal19.dll : fatal error LNK1120: 74 unresolved externals

Please help.

Thank you.

 

		





 

-- 




Mihaela Gaspar

Urban Robotics Inc.
Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

 <mailto:mihaela.gaspar at urbanrobotics.net>
mihaela.gaspar at urbanrobotics.net  
 <http://www.urbanrobotics.net/> http://www.urbanrobotics.net

 

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

 





 

-- 




Mihaela Gaspar

Urban Robotics Inc.
Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

 <mailto:mihaela.gaspar at urbanrobotics.net>
mihaela.gaspar at urbanrobotics.net  
 <http://www.urbanrobotics.net/> http://www.urbanrobotics.net

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/d7dc9bf2/attachment-0001.html>

From mihaela.gaspar at urbanrobotics.net  Tue May 14 09:55:31 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Tue, 14 May 2013 09:55:31 -0700
Subject: [gdal-dev] Is it possible to build pdb files in Release ?
Message-ID: <CACwvHmoHLGY5Fx=DzNLj62r_g5wPDQ9ZyN9wZS3EbpdBkNi2zg@mail.gmail.com>

I built GDAL in both Debug and Release.

The default behavior is to create .pdb files in Debug, but not in Release.

I would like to get a pdb file in Release build as well, is it possible ?

The only lines I see that have to do with pdb, are:

!IFNDEF DEBUG
OPTFLAGS= $(CXX_ANALYZE_FLAGS) /nologo /MT /EHsc /Ox
/D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
/Fd$(LIBDIR)\gdal$(VERSION).pdb /ITERATOR_DEBUG_LEVEL=0
!ELSE
OPTFLAGS= $(CXX_ANALYZE_FLAGS) /nologo /MTd /EHsc /Zi
/D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE
/Fd$(LIBDIR)\gdal$(VERSION).pdb /DDEBUG /ITERATOR_DEBUG_LEVEL=2
!ENDIF

It is not apparent to me how to get pdb files to be created, based on this.

Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/3e814a0a/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Tue May 14 10:11:16 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Tue, 14 May 2013 10:11:16 -0700
Subject: [gdal-dev] What is the difference between gdal.lib and gdal.i.lib ?
Message-ID: <CACwvHmqscmtqTTgTSj3QFPOJ=wVrBF69cjbK6Y83a2dXLuHYcw@mail.gmail.com>

The devinstall option copies gdal.i.lib into the target library
installation folder.
I see another lib file created, gdal.lib
What is the difference between them ?
I I link statically, do I use gdal.i.lib ?
Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/54968fea/attachment.html>

From warmerdam at pobox.com  Tue May 14 11:08:38 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 14 May 2013 11:08:38 -0700
Subject: [gdal-dev] What is the difference between gdal.lib and
	gdal.i.lib ?
In-Reply-To: <CACwvHmqscmtqTTgTSj3QFPOJ=wVrBF69cjbK6Y83a2dXLuHYcw@mail.gmail.com>
References: <CACwvHmqscmtqTTgTSj3QFPOJ=wVrBF69cjbK6Y83a2dXLuHYcw@mail.gmail.com>
Message-ID: <CA+YzLBdAWY8OCi7_3E_zRr5=qqXkSAVct+Bcjv5zBDp4u3mEig@mail.gmail.com>

Mihaela,

gdal.i.lib is a stub library wrapping the GDAL DLL.  Link against
gdal.i.lib if you want to use the DLL.

gdal.lib is a static library with everything in it.  Link against this if
you want to avoid using the GDAL DLL.

Best regards,
Frank



On Tue, May 14, 2013 at 10:11 AM, Mihaela Gaspar <
mihaela.gaspar at urbanrobotics.net> wrote:

> The devinstall option copies gdal.i.lib into the target library
> installation folder.
> I see another lib file created, gdal.lib
> What is the difference between them ?
> I I link statically, do I use gdal.i.lib ?
> Thank you.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/1bfeb61b/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Tue May 14 11:09:33 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Tue, 14 May 2013 11:09:33 -0700
Subject: [gdal-dev] What is the difference between gdal.lib and
	gdal.i.lib ?
In-Reply-To: <CA+YzLBdAWY8OCi7_3E_zRr5=qqXkSAVct+Bcjv5zBDp4u3mEig@mail.gmail.com>
References: <CACwvHmqscmtqTTgTSj3QFPOJ=wVrBF69cjbK6Y83a2dXLuHYcw@mail.gmail.com>
	<CA+YzLBdAWY8OCi7_3E_zRr5=qqXkSAVct+Bcjv5zBDp4u3mEig@mail.gmail.com>
Message-ID: <CACwvHmp=jdBhMm079JsnANQOKqe51KtFWU9eU_OQ3-sp-RuOAw@mail.gmail.com>

Thank you.

On Tue, May 14, 2013 at 11:08 AM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Mihaela,
>
> gdal.i.lib is a stub library wrapping the GDAL DLL.  Link against
> gdal.i.lib if you want to use the DLL.
>
> gdal.lib is a static library with everything in it.  Link against this if
> you want to avoid using the GDAL DLL.
>
> Best regards,
> Frank
>
>
>
> On Tue, May 14, 2013 at 10:11 AM, Mihaela Gaspar <
> mihaela.gaspar at urbanrobotics.net> wrote:
>
>> The devinstall option copies gdal.i.lib into the target library
>> installation folder.
>> I see another lib file created, gdal.lib
>> What is the difference between them ?
>> I I link statically, do I use gdal.i.lib ?
>> Thank you.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>



-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/43aa10ef/attachment.html>

From gdal at stripfamily.net  Tue May 14 12:41:43 2013
From: gdal at stripfamily.net (David Strip)
Date: Tue, 14 May 2013 13:41:43 -0600
Subject: [gdal-dev] Is it possible to build pdb files in Release ?
In-Reply-To: <CACwvHmoHLGY5Fx=DzNLj62r_g5wPDQ9ZyN9wZS3EbpdBkNi2zg@mail.gmail.com>
References: <CACwvHmoHLGY5Fx=DzNLj62r_g5wPDQ9ZyN9wZS3EbpdBkNi2zg@mail.gmail.com>
Message-ID: <51929377.3040809@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/d53e805e/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Tue May 14 13:23:06 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Tue, 14 May 2013 13:23:06 -0700
Subject: [gdal-dev] Is it possible to build pdb files in Release ?
In-Reply-To: <51929377.3040809@stripfamily.net>
References: <CACwvHmoHLGY5Fx=DzNLj62r_g5wPDQ9ZyN9wZS3EbpdBkNi2zg@mail.gmail.com>
	<51929377.3040809@stripfamily.net>
Message-ID: <CACwvHmqrW_=VKsvuZf8bdnvwS159g9nWo=GFuTBf30erLKyOFg@mail.gmail.com>

Thank you, it's perfect.

On Tue, May 14, 2013 at 12:41 PM, David Strip <gdal at stripfamily.net> wrote:

>  The pdb file is generated by the /Zi flag. Add that to the list of flags
> in your release build.
>
>
> On 5/14/2013 10:55 AM, Mihaela Gaspar wrote:
>
> I built GDAL in both Debug and Release.
>
>  The default behavior is to create .pdb files in Debug, but not in
> Release.
>
>  I would like to get a pdb file in Release build as well, is it possible ?
>
>  The only lines I see that have to do with pdb, are:
>
>  !IFNDEF DEBUG
> OPTFLAGS= $(CXX_ANALYZE_FLAGS) /nologo /MT /EHsc /Ox
> /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
> /Fd$(LIBDIR)\gdal$(VERSION).pdb /ITERATOR_DEBUG_LEVEL=0
> !ELSE
> OPTFLAGS= $(CXX_ANALYZE_FLAGS) /nologo /MTd /EHsc /Zi
> /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE
> /Fd$(LIBDIR)\gdal$(VERSION).pdb /DDEBUG /ITERATOR_DEBUG_LEVEL=2
> !ENDIF
>
>  It is not apparent to me how to get pdb files to be created, based on
> this.
>
>  Thank you.
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>


-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/9514f524/attachment.html>

From warmerdam at pobox.com  Tue May 14 13:54:25 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 14 May 2013 13:54:25 -0700
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
Message-ID: <CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>

Sam,

It looks good to me, though I'm dubious about the value of treating
booleans as Byte instead of integer.

Best regards,
Frank



On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Hi All,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" adopted. This adds some
> new functionality for GDAL 2.0. Even and others have made suggestions and
> these have been incorporated into the RFC:
>
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> Thanks,
> Sam.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/f251589b/attachment.html>

From warmerdam at pobox.com  Tue May 14 13:54:26 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 14 May 2013 13:54:26 -0700
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
Message-ID: <CA+YzLBeZa0U59q-UeMygt=DU=9yFSMS9D4VKBho71zD=t8oZ6A@mail.gmail.com>

Sam,

It looks good to me, though I'm dubious about the value of treating
booleans as Byte instead of integer.

Best regards,
Frank



On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Hi All,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" adopted. This adds some
> new functionality for GDAL 2.0. Even and others have made suggestions and
> these have been incorporated into the RFC:
>
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> Thanks,
> Sam.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/36a9447f/attachment.html>

From warmerdam at pobox.com  Tue May 14 13:53:54 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 14 May 2013 13:53:54 -0700
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
Message-ID: <CA+YzLBfCf4Tb4y2mm6K_zuJkRTDbHDSEox3tpnvtSDO6Sp1tWg@mail.gmail.com>

Sam,

It looks good to me, though I'm dubious about the value of treating
booleans as Byte instead of integer.

Best regards,
Frank



On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Hi All,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" adopted. This adds some
> new functionality for GDAL 2.0. Even and others have made suggestions and
> these have been incorporated into the RFC:
>
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> Thanks,
> Sam.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/b2eae5e5/attachment.html>

From etourigny.dev at gmail.com  Tue May 14 14:52:38 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 14 May 2013 18:52:38 -0300
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
	<CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>
Message-ID: <CA+TxYvPH=+HhABzN6uYwseRdrP-whk2Ve30jj_fNPthmLmnbqQ@mail.gmail.com>

On Tue, May 14, 2013 at 5:54 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Sam,
>
> It looks good to me, though I'm dubious about the value of treating
> booleans as Byte instead of integer.
>

everywhere else booleans are defined as integers like this

int bSomeVar;


>
> Best regards,
> Frank
>
>
>
> On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:
>
>> Hi All,
>>
>> I propose a motion to get RFC 40 - "Improving performance of Raster
>> Attribute Table implementation for large tables" adopted. This adds some
>> new functionality for GDAL 2.0. Even and others have made suggestions and
>> these have been incorporated into the RFC:
>>
>> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>>
>> Thanks,
>> Sam.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130514/0e17850f/attachment-0001.html>

From etourigny.dev at gmail.com  Wed May 15 07:12:05 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Wed, 15 May 2013 11:12:05 -0300
Subject: [gdal-dev] gdalwarp does not apply source nodata value to
	destination
Message-ID: <CA+TxYvPw4MuyMUnFJ7Uaaaubi-QjjY0q5tSH_yMNTJjwaCwdBQ@mail.gmail.com>

I have just noticed that destination nodata value is not set when
-dstnodata option is not used in gdalwarp.

This can be problematic when warping a dataset with no data values, as the
result can be different from expected, if -dstnodata is not set.
gdalwarp does use source nodata pixels if -srcnodata is not used.

I consider this as a bug (or at the very least a limitation), because one
cannot warp a dataset in an automatic fashion and get expected output (with
same nodata value as input).

Would it be OK to copy them over if -dstnodata is not used, or would there
be problems with doing this? Or perhaps a new argument -copynodata could be
added if there is fear of disruption.

cheers
Etienne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/7a057012/attachment.html>

From aashishcy at gmail.com  Wed May 15 11:31:13 2013
From: aashishcy at gmail.com (Jayesh Chaudhary)
Date: Wed, 15 May 2013 14:31:13 -0400
Subject: [gdal-dev] Corner points
Message-ID: <CAGeT8ynCZbKVXOrJ9RsOucW0ef1rAsk_wi4DD-+p2HeRaYHVJg@mail.gmail.com>

Friends,

I am using GDAL to read NITF (rsets / overviews) and in this particular
dataset the rsets (r0, r1, r2)  have different corner points (slightly).

Problem is that when I use these rsets and when I zoom in on these images,
GDAL compute some appropriate overview but since the corners are different
slightly, the image I get back is slightly offset from the I got earlier
from a different overview.

I am wondering if there anything I can do in gdal to handle this case. We
cannot really fix the data.

Any help is appreciated.

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/91856f47/attachment.html>

From gillingham.sam at gmail.com  Wed May 15 14:58:21 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Thu, 16 May 2013 09:58:21 +1200
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CA+TxYvPH=+HhABzN6uYwseRdrP-whk2Ve30jj_fNPthmLmnbqQ@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
	<CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>
	<CA+TxYvPH=+HhABzN6uYwseRdrP-whk2Ve30jj_fNPthmLmnbqQ@mail.gmail.com>
Message-ID: <CAMH-RbZ9-FfXDoKvWJXfboGNqrX1i7D28R6cwyo=c2RsjVmG8A@mail.gmail.com>

Etienne, Frank,

The original idea was to save space with the byte type, although I admit
bools are a rather unusual case. If we represent them as ints it might be
more straightforward just to use the int form of ValuesIO instead. How
about removing the bool form of ValuesIO and should a future driver support
bools it can treat them as ints?

Sam


On 15 May 2013 09:52, Etienne Tourigny <etourigny.dev at gmail.com> wrote:

>
>
> On Tue, May 14, 2013 at 5:54 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:
>
>> Sam,
>>
>> It looks good to me, though I'm dubious about the value of treating
>> booleans as Byte instead of integer.
>>
>
> everywhere else booleans are defined as integers like this
>
> int bSomeVar;
>
>
>>
>> Best regards,
>> Frank
>>
>>
>>
>> On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <gillingham.sam at gmail.com
>> > wrote:
>>
>>> Hi All,
>>>
>>> I propose a motion to get RFC 40 - "Improving performance of Raster
>>> Attribute Table implementation for large tables" adopted. This adds some
>>> new functionality for GDAL 2.0. Even and others have made suggestions and
>>> these have been incorporated into the RFC:
>>>
>>> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>>>
>>> Thanks,
>>> Sam.
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam at pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Software Developer
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/ea8fe3dd/attachment.html>

From warmerdam at pobox.com  Wed May 15 15:26:45 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 15 May 2013 15:26:45 -0700
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CAMH-RbZ9-FfXDoKvWJXfboGNqrX1i7D28R6cwyo=c2RsjVmG8A@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
	<CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>
	<CA+TxYvPH=+HhABzN6uYwseRdrP-whk2Ve30jj_fNPthmLmnbqQ@mail.gmail.com>
	<CAMH-RbZ9-FfXDoKvWJXfboGNqrX1i7D28R6cwyo=c2RsjVmG8A@mail.gmail.com>
Message-ID: <CA+YzLBeiCSvYpmwdGHPgbntce_aFOzRgk54puUOOeAP26BjRvw@mail.gmail.com>

On Wed, May 15, 2013 at 2:58 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Etienne, Frank,
>
> The original idea was to save space with the byte type, although I admit
> bools are a rather unusual case. If we represent them as ints it might be
> more straightforward just to use the int form of ValuesIO instead. How
> about removing the bool form of ValuesIO and should a future driver support
> bools it can treat them as ints?
>

Sam,

Yes, that would be my suggestion, reducing the number of entry points
slightly.

Best regards,
Frank


>
>
> On 15 May 2013 09:52, Etienne Tourigny <etourigny.dev at gmail.com> wrote:
>
>>
>>
>> On Tue, May 14, 2013 at 5:54 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:
>>
>>> Sam,
>>>
>>> It looks good to me, though I'm dubious about the value of treating
>>> booleans as Byte instead of integer.
>>>
>>
>> everywhere else booleans are defined as integers like this
>>
>> int bSomeVar;
>>
>>
>>>
>>> Best regards,
>>>  Frank
>>>
>>>
>>>
>>> On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <
>>> gillingham.sam at gmail.com> wrote:
>>>
>>>> Hi All,
>>>>
>>>> I propose a motion to get RFC 40 - "Improving performance of Raster
>>>> Attribute Table implementation for large tables" adopted. This adds some
>>>> new functionality for GDAL 2.0. Even and others have made suggestions and
>>>> these have been incorporated into the RFC:
>>>>
>>>> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>>>>
>>>> Thanks,
>>>> Sam.
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>>
>>> --
>>>
>>> ---------------------------------------+--------------------------------------
>>> I set the clouds in motion - turn up   | Frank Warmerdam,
>>> warmerdam at pobox.com
>>> light and sound - activate the windows | http://pobox.com/~warmerdam
>>> and watch the world go round - Rush    | Geospatial Software Developer
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/5793f128/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Wed May 15 16:18:16 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Wed, 15 May 2013 16:18:16 -0700
Subject: [gdal-dev] GDAL with external zlib
Message-ID: <CACwvHmqx6uWkpfxxpQX-Q6j+zG834vcCy5Qu0J7WOto7+4RbKA@mail.gmail.com>

I have built GDAL, and was experimenting on a project.

I have external zlib 1.2.5

The external libraries are generally statically linked.

When trying the same thing with gdal, I got a link error:
error LNK2005: _deflate_copyright already defined in gdal.lib(deflate.obj)

I tried to find where gdal is using zlib, to try to add the external
reference, in similar fashion to other 3rd party software.
There is no place to include zlib though, in frmts\makefile.vc there is
something that I don't understand:
EXTRAFLAGS = $(EXTRAFLAGS) -DFRMT_zlib

And in port\makefile.vc there is an inclusion of the local zlib:
EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ


I tried to emulate other libs, by adding in nmake.opt:
# External ZLIB
ZLIB_INCLUDE = $(SDK)/zlib-1.2.5/build/include

And replacing in port\makefile.vc the line above with
!IFDEF ZLIB_INCLUDE
EXTRAFLAGS =  $(ZLIB_INCLUDE) -DHAVE_LIBZ
!ELSE
EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ
!ENDIF

But it didn't build.

How can I build with external zlib, to avoid version conflicts ?

Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/e950c84d/attachment.html>

From gillingham.sam at gmail.com  Wed May 15 16:19:24 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Thu, 16 May 2013 11:19:24 +1200
Subject: [gdal-dev] Raster Attribute Table RFC
In-Reply-To: <CA+YzLBeiCSvYpmwdGHPgbntce_aFOzRgk54puUOOeAP26BjRvw@mail.gmail.com>
References: <CAMH-RbZax0b=Qz4RcgSoBmfqGg2nQ8=WGBJcNEueQ7h4nx7RpA@mail.gmail.com>
	<CA+YzLBfQh=jJSMRo5PvQxYW1WsQHOvKpD0roJ9b10-=-u=PdJQ@mail.gmail.com>
	<CA+TxYvPH=+HhABzN6uYwseRdrP-whk2Ve30jj_fNPthmLmnbqQ@mail.gmail.com>
	<CAMH-RbZ9-FfXDoKvWJXfboGNqrX1i7D28R6cwyo=c2RsjVmG8A@mail.gmail.com>
	<CA+YzLBeiCSvYpmwdGHPgbntce_aFOzRgk54puUOOeAP26BjRvw@mail.gmail.com>
Message-ID: <CAMH-RbY=sUS2=2DEytazC9Nr9OzqO+dhFg8bPmhjcoAeYOECMA@mail.gmail.com>

Hi Frank,

I've updated the RFC.
Sam.


On 16 May 2013 10:26, Frank Warmerdam <warmerdam at pobox.com> wrote:

>
>
>
> On Wed, May 15, 2013 at 2:58 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:
>
>> Etienne, Frank,
>>
>> The original idea was to save space with the byte type, although I admit
>> bools are a rather unusual case. If we represent them as ints it might be
>> more straightforward just to use the int form of ValuesIO instead. How
>> about removing the bool form of ValuesIO and should a future driver support
>> bools it can treat them as ints?
>>
>
> Sam,
>
> Yes, that would be my suggestion, reducing the number of entry points
> slightly.
>
> Best regards,
> Frank
>
>
>>
>>
>> On 15 May 2013 09:52, Etienne Tourigny <etourigny.dev at gmail.com> wrote:
>>
>>>
>>>
>>> On Tue, May 14, 2013 at 5:54 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:
>>>
>>>> Sam,
>>>>
>>>> It looks good to me, though I'm dubious about the value of treating
>>>> booleans as Byte instead of integer.
>>>>
>>>
>>> everywhere else booleans are defined as integers like this
>>>
>>> int bSomeVar;
>>>
>>>
>>>>
>>>> Best regards,
>>>>  Frank
>>>>
>>>>
>>>>
>>>> On Mon, May 13, 2013 at 9:37 PM, Sam Gillingham <
>>>> gillingham.sam at gmail.com> wrote:
>>>>
>>>>> Hi All,
>>>>>
>>>>> I propose a motion to get RFC 40 - "Improving performance of Raster
>>>>> Attribute Table implementation for large tables" adopted. This adds some
>>>>> new functionality for GDAL 2.0. Even and others have made suggestions and
>>>>> these have been incorporated into the RFC:
>>>>>
>>>>> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>>>>>
>>>>> Thanks,
>>>>> Sam.
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>>
>>>> ---------------------------------------+--------------------------------------
>>>> I set the clouds in motion - turn up   | Frank Warmerdam,
>>>> warmerdam at pobox.com
>>>> light and sound - activate the windows | http://pobox.com/~warmerdam
>>>> and watch the world go round - Rush    | Geospatial Software Developer
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/8dc088f2/attachment-0001.html>

From warmerdam at pobox.com  Wed May 15 16:40:05 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 15 May 2013 16:40:05 -0700
Subject: [gdal-dev] GDAL with external zlib
In-Reply-To: <CACwvHmqx6uWkpfxxpQX-Q6j+zG834vcCy5Qu0J7WOto7+4RbKA@mail.gmail.com>
References: <CACwvHmqx6uWkpfxxpQX-Q6j+zG834vcCy5Qu0J7WOto7+4RbKA@mail.gmail.com>
Message-ID: <CA+YzLBdCqsT6KZRiUcJrrG7DGVm8EPnvZYePgBa=V=RzNPU=sw@mail.gmail.com>

Mihaela,

The -DFRMT_ZLIB item in gdal/frmts/makefile.vc is triggering use of the
local copy of zlib if OGDI is *not* configured as it includes a copy of
zlib.  It should in theory be practical to generalize that in some way so
the decision isn't based on OGDI but clearly it isn't common to build GDAL
on windows without it's own zlib since there is nothing in nmake.opt about
it.

I do believe it is fairly common on linux to build with the system zlib.

Best regards,
Frank



On Wed, May 15, 2013 at 4:18 PM, Mihaela Gaspar <
mihaela.gaspar at urbanrobotics.net> wrote:

> I have built GDAL, and was experimenting on a project.
>
> I have external zlib 1.2.5
>
> The external libraries are generally statically linked.
>
> When trying the same thing with gdal, I got a link error:
> error LNK2005: _deflate_copyright already defined in gdal.lib(deflate.obj)
>
> I tried to find where gdal is using zlib, to try to add the external
> reference, in similar fashion to other 3rd party software.
> There is no place to include zlib though, in frmts\makefile.vc there is
> something that I don't understand:
> EXTRAFLAGS = $(EXTRAFLAGS) -DFRMT_zlib
>
> And in port\makefile.vc there is an inclusion of the local zlib:
> EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ
>
>
> I tried to emulate other libs, by adding in nmake.opt:
> # External ZLIB
> ZLIB_INCLUDE = $(SDK)/zlib-1.2.5/build/include
>
> And replacing in port\makefile.vc the line above with
> !IFDEF ZLIB_INCLUDE
> EXTRAFLAGS =  $(ZLIB_INCLUDE) -DHAVE_LIBZ
> !ELSE
> EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ
> !ENDIF
>
> But it didn't build.
>
> How can I build with external zlib, to avoid version conflicts ?
>
> Thank you.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/5d27d7bb/attachment.html>

From mihaela.gaspar at urbanrobotics.net  Wed May 15 16:51:31 2013
From: mihaela.gaspar at urbanrobotics.net (Mihaela Gaspar)
Date: Wed, 15 May 2013 16:51:31 -0700
Subject: [gdal-dev] GDAL with external zlib
In-Reply-To: <CA+YzLBdCqsT6KZRiUcJrrG7DGVm8EPnvZYePgBa=V=RzNPU=sw@mail.gmail.com>
References: <CACwvHmqx6uWkpfxxpQX-Q6j+zG834vcCy5Qu0J7WOto7+4RbKA@mail.gmail.com>
	<CA+YzLBdCqsT6KZRiUcJrrG7DGVm8EPnvZYePgBa=V=RzNPU=sw@mail.gmail.com>
Message-ID: <CACwvHmpZ4-9QfvKk84k85DmBWHA6J3qB0eCWouuxEA81W7nweA@mail.gmail.com>

Thank you Frank,

I'm afraid I don't understand this.
I looked now at the list EXTERNAL_LIBS in nmake.opt, and zlib is not
included.
If in Linux it is possible (common?) to build with the system zlib, why
can't I do that in Windows, with the external zlib ?
And if I can't... then how can I avoid the linker error I am getting ?
Note: if I build against the dll, it works. But "our practice" is to build
against static libraries.
Also the fact that linking against the dll gave me no error - could that
mean that there is no conflict with the different zlib version, or that the
conflict passed unnoticed at link time but it might give me trouble later ?

Sorry, I am asking all these questions, trying to get this build and
working perfectly...

Thank you so much for help.


On Wed, May 15, 2013 at 4:40 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Mihaela,
>
> The -DFRMT_ZLIB item in gdal/frmts/makefile.vc is triggering use of the
> local copy of zlib if OGDI is *not* configured as it includes a copy of
> zlib.  It should in theory be practical to generalize that in some way so
> the decision isn't based on OGDI but clearly it isn't common to build GDAL
> on windows without it's own zlib since there is nothing in nmake.opt about
> it.
>
> I do believe it is fairly common on linux to build with the system zlib.
>
> Best regards,
> Frank
>
>
>
> On Wed, May 15, 2013 at 4:18 PM, Mihaela Gaspar <
> mihaela.gaspar at urbanrobotics.net> wrote:
>
>> I have built GDAL, and was experimenting on a project.
>>
>> I have external zlib 1.2.5
>>
>> The external libraries are generally statically linked.
>>
>> When trying the same thing with gdal, I got a link error:
>> error LNK2005: _deflate_copyright already defined in gdal.lib(deflate.obj)
>>
>> I tried to find where gdal is using zlib, to try to add the external
>> reference, in similar fashion to other 3rd party software.
>> There is no place to include zlib though, in frmts\makefile.vc there is
>> something that I don't understand:
>> EXTRAFLAGS = $(EXTRAFLAGS) -DFRMT_zlib
>>
>> And in port\makefile.vc there is an inclusion of the local zlib:
>> EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ
>>
>>
>> I tried to emulate other libs, by adding in nmake.opt:
>> # External ZLIB
>> ZLIB_INCLUDE = $(SDK)/zlib-1.2.5/build/include
>>
>> And replacing in port\makefile.vc the line above with
>> !IFDEF ZLIB_INCLUDE
>> EXTRAFLAGS =  $(ZLIB_INCLUDE) -DHAVE_LIBZ
>> !ELSE
>> EXTRAFLAGS =  -I..\frmts\zlib -DHAVE_LIBZ
>> !ENDIF
>>
>> But it didn't build.
>>
>> How can I build with external zlib, to avoid version conflicts ?
>>
>> Thank you.
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>



-- 


*Mihaela Gaspar*

*Urban Robotics Inc.**
*Software Engineer

33 NW First Avenue, Suite 200 | Portland, OR 97209

c: 971-269-9649

mihaela.gaspar at urbanrobotics.net
http://www.urbanrobotics.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/c0e7f8c4/attachment.html>

From warmerdam at pobox.com  Wed May 15 18:12:42 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 15 May 2013 18:12:42 -0700
Subject: [gdal-dev] Google Maps Engine OGR Driver
Message-ID: <CA+YzLBc1K+jE9AhVfvh7JVibDbuu4Ga+9Jy6Z0XUriBe+RqeQA@mail.gmail.com>

Folks,

I'm starting work on an OGR driver for Google Maps Engine (GME), focused on
it's use as a feature store.  This should be somewhat similar to the Fusion
Tables driver. GME API docs are at:

  https://developers.google.com/maps-engine/documentation/before-you-begin

It will have (I think) similar auth issues to fusion tables.  Features are
exchanged in GeoJSON format.

If anyone is interested in testing or potentially collaborating on this let
me know.

I'd hope to have something operational in a few weeks if I don't get too
distracted.

There are also other aspects of GME that might be interesting at some point
- particularly support for rasters and maps might be exposed through GDAL.
 If the feature access goes well I might investigate those in the future.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130515/16fafaf7/attachment.html>

From no-reply at neogeo-online.net  Thu May 16 02:48:57 2013
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Thu, 16 May 2013 11:48:57 +0200
Subject: [gdal-dev] Wrong .prj file with SHAPEZIP Outputformat
Message-ID: <5194AB89.6040603@neogeo-online.net>

Hi list(s),

Sorry for cross-posting gdal and mapserver dev lists, but I don't know 
exactly where my problem comes from.

When using a SHAPEZIP OUTPUTFORMAT with MapServer, I retrieve a prj file 
which is not exactly the correct projection definition (for EPSG:3946) :

PROJCS["Lambert_Conformal_Conic",GEOGCS["GCS_GRS 1980(IUGG, 
1980)",DATUM["D_unknown",SPHEROID["GRS80",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["standard_parallel_1",45.25],PARAMETER["standard_parallel_2",46.75],PARAMETER["latitude_of_origin",46],PARAMETER["central_meridian",3],PARAMETER["false_easting",1700000],PARAMETER["false_northing",5200000],UNIT["Meter",1]]

I took a look at the code in mapogroutput.c and noticed it was all 
driven by OGR.

So I did the same extract to a EPSG:3946 shapefile with ogr2ogr. It 
gives the correct result :

PROJCS["RGF93_Lambert_93",GEOGCS["GCS_RGF93",DATUM["D_RGF_1993",SPHEROID["GRS_1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["standard_parallel_1",49],PARAMETER["standard_parallel_2",44],PARAMETER["latitude_of_origin",46.5],PARAMETER["central_meridian",3],PARAMETER["false_easting",700000],PARAMETER["false_northing",6600000],UNIT["Meter",1]]

which makes the shapefile's projection understandable by QGIS.

So, the question is : where does the prj definition generated by 
mapserver come from ? Why is it wrong and how to fix this ?

Best regards

Guillaume

From jgomezdans at gmail.com  Thu May 16 04:19:30 2013
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Thu, 16 May 2013 12:19:30 +0100
Subject: [gdal-dev] HDF4 and 1.10
Message-ID: <CAMWde5oUZr4khVUb5YhdPMtT_chCQV9+-+Li34-gQVJYQPKvew@mail.gmail.com>

Hi,
I read with interest that gdal 1.10 has the following new addition:

* Add ability to increase the maximum number of opened HDF4 files
(from <http://trac.osgeo.org/gdal/wiki/Release/1.10.0-News>). Does that
mean that I can compile GDAL against a version of the HDF library that
has MAX_FILE
set to a small number?

Thanks!
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/7b31d92b/attachment.html>

From osgeo.mailinglist at gmail.com  Thu May 16 04:29:10 2013
From: osgeo.mailinglist at gmail.com (Thomas Gratier)
Date: Thu, 16 May 2013 13:29:10 +0200
Subject: [gdal-dev] [mapserver-dev] Wrong .prj file with SHAPEZIP
	Outputformat
In-Reply-To: <5194AB89.6040603@neogeo-online.net>
References: <5194AB89.6040603@neogeo-online.net>
Message-ID: <CACPZzQ3z1j2aA52vVJADjC3FefMcbV2AfdOgvbwj3QNSUy0eFg@mail.gmail.com>

Hello,

Just a guess: the Mapserver projection file comes maybe from GEOS and GDAL
retrieve the wrong proj (deduce from the mapfile) after (although with your
analysis it doesn't seem so) >>
http://mapserver.org/faq.html#where-do-i-find-my-epsg-code

Regards

Thomas Gratier


2013/5/16 Guillaume Sueur <no-reply at neogeo-online.net>

> Hi list(s),
>
> Sorry for cross-posting gdal and mapserver dev lists, but I don't know
> exactly where my problem comes from.
>
> When using a SHAPEZIP OUTPUTFORMAT with MapServer, I retrieve a prj file
> which is not exactly the correct projection definition (for EPSG:3946) :
>
> PROJCS["Lambert_Conformal_**Conic",GEOGCS["GCS_GRS 1980(IUGG,
> 1980)",DATUM["D_unknown",**SPHEROID["GRS80",6378137,298.**
> 257222101]],PRIMEM["Greenwich"**,0],UNIT["Degree",0.**
> 017453292519943295]],**PROJECTION["Lambert_Conformal_**
> Conic"],PARAMETER["standard_**parallel_1",45.25],PARAMETER["**
> standard_parallel_2",46.75],**PARAMETER["latitude_of_origin"**
> ,46],PARAMETER["central_**meridian",3],PARAMETER["false_**
> easting",1700000],PARAMETER["**false_northing",5200000],UNIT[**"Meter",1]]
>
> I took a look at the code in mapogroutput.c and noticed it was all driven
> by OGR.
>
> So I did the same extract to a EPSG:3946 shapefile with ogr2ogr. It gives
> the correct result :
>
> PROJCS["RGF93_Lambert_93",**GEOGCS["GCS_RGF93",DATUM["D_**
> RGF_1993",SPHEROID["GRS_1980",**6378137,298.257222101]],**
> PRIMEM["Greenwich",0],UNIT["**Degree",0.017453292519943295]]**
> ,PROJECTION["Lambert_**Conformal_Conic"],PARAMETER["**
> standard_parallel_1",49],**PARAMETER["standard_parallel_**
> 2",44],PARAMETER["latitude_of_**origin",46.5],PARAMETER["**
> central_meridian",3],**PARAMETER["false_easting",**
> 700000],PARAMETER["false_**northing",6600000],UNIT["**Meter",1]]
>
> which makes the shapefile's projection understandable by QGIS.
>
> So, the question is : where does the prj definition generated by mapserver
> come from ? Why is it wrong and how to fix this ?
>
> Best regards
>
> Guillaume
> ______________________________**_________________
> mapserver-dev mailing list
> mapserver-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/mapserver-dev<http://lists.osgeo.org/mailman/listinfo/mapserver-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/55e1bad8/attachment.html>

From traviskirstine at gmail.com  Thu May 16 05:46:06 2013
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Thu, 16 May 2013 08:46:06 -0400
Subject: [gdal-dev] Google Maps Engine OGR Driver
In-Reply-To: <CA+YzLBc1K+jE9AhVfvh7JVibDbuu4Ga+9Jy6Z0XUriBe+RqeQA@mail.gmail.com>
References: <CA+YzLBc1K+jE9AhVfvh7JVibDbuu4Ga+9Jy6Z0XUriBe+RqeQA@mail.gmail.com>
Message-ID: <CALtm4h28+oyRB4ViXbOGUWWKuKXwDX=aSX-JE2jM0C-6Boez_Q@mail.gmail.com>

We would be interested in testing, and have access to a GME account.


On 15 May 2013 21:12, Frank Warmerdam <warmerdam at pobox.com> wrote:

> Folks,
>
> I'm starting work on an OGR driver for Google Maps Engine (GME), focused
> on it's use as a feature store.  This should be somewhat similar to the
> Fusion Tables driver. GME API docs are at:
>
>   https://developers.google.com/maps-engine/documentation/before-you-begin
>
> It will have (I think) similar auth issues to fusion tables.  Features are
> exchanged in GeoJSON format.
>
> If anyone is interested in testing or potentially collaborating on this
> let me know.
>
> I'd hope to have something operational in a few weeks if I don't get too
> distracted.
>
> There are also other aspects of GME that might be interesting at some
> point - particularly support for rasters and maps might be exposed through
> GDAL.  If the feature access goes well I might investigate those in the
> future.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/518e0fca/attachment.html>

From jorgearevalo at libregis.org  Thu May 16 10:17:48 2013
From: jorgearevalo at libregis.org (=?utf-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Thu, 16 May 2013 19:17:48 +0200
Subject: [gdal-dev] What is the best way to test if a CPLString is not empty?
Message-ID: <E87520D8179D4FE69B2AC5F9B17F9871@libregis.org>

If I define a CPLString this way:

CPLString osString; 

And I want to check if osString is not empty, what would be the best way?

My bet:

if (osString.c_str() == NULL) 

But I find it a little rusty... Is there any other better way?

Many thanks in advance 

-- 
Jorge Arevalo
Freelance developer

http://www.krop.com/jorgearevalo
http://about.me/jorgeas80

Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)



From warmerdam at pobox.com  Thu May 16 11:07:28 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 16 May 2013 11:07:28 -0700
Subject: [gdal-dev] What is the best way to test if a CPLString is not
	empty?
In-Reply-To: <E87520D8179D4FE69B2AC5F9B17F9871@libregis.org>
References: <E87520D8179D4FE69B2AC5F9B17F9871@libregis.org>
Message-ID: <CA+YzLBdp5CVt0wzFZNU=d7Z8Z2bdN7us=oW4dEXdsoeVebgTmA@mail.gmail.com>

Jorge,

I don't believe oString.c_str() will ever be NULL.  You can use the
std::string empty() method to test if a string is empty (zero length).

  http://www.cplusplus.com/reference/string/string/empty/

CPLStrings have no equivelient to a NULL distinct from being a zero length
string.

Best regards,
Frank

On Thu, May 16, 2013 at 10:17 AM, Jorge Ar?valo
<jorgearevalo at libregis.org>wrote:

> If I define a CPLString this way:
>
> CPLString osString;
>
> And I want to check if osString is not empty, what would be the best way?
>
> My bet:
>
> if (osString.c_str() == NULL)
>
> But I find it a little rusty... Is there any other better way?
>
> Many thanks in advance
>
> --
> Jorge Arevalo
> Freelance developer
>
> http://www.krop.com/jorgearevalo
> http://about.me/jorgeas80
>
> Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/fc250408/attachment.html>

From jorgearevalo at libregis.org  Thu May 16 11:54:40 2013
From: jorgearevalo at libregis.org (=?utf-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Thu, 16 May 2013 20:54:40 +0200
Subject: [gdal-dev] What is the best way to test if a CPLString is not
 empty?
In-Reply-To: <CA+YzLBdp5CVt0wzFZNU=d7Z8Z2bdN7us=oW4dEXdsoeVebgTmA@mail.gmail.com>
References: <E87520D8179D4FE69B2AC5F9B17F9871@libregis.org>
	<CA+YzLBdp5CVt0wzFZNU=d7Z8Z2bdN7us=oW4dEXdsoeVebgTmA@mail.gmail.com>
Message-ID: <D9ED7B3B0519456B902A21318B847B46@libregis.org>

That sounds perfect. Thanks Frank!  

--  
Jorge Arevalo
Freelance developer

http://www.krop.com/jorgearevalo
http://about.me/jorgeas80

Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)


El jueves 16 de mayo de 2013 a las 20:07, Frank Warmerdam escribi?:

>  
>  
> Jorge,
>  
> I don't believe oString.c_str() will ever be NULL. You can use the std::string empty() method to test if a string is empty (zero length).  
>  
> http://www.cplusplus.com/reference/string/string/empty/
>  
> CPLStrings have no equivelient to a NULL distinct from being a zero length string.
>  
> Best regards,
> Frank
>  
> On Thu, May 16, 2013 at 10:17 AM, Jorge Ar?valo <jorgearevalo at libregis.org (mailto:jorgearevalo at libregis.org)> wrote:
> > If I define a CPLString this way:
> >  
> > CPLString osString;
> >  
> > And I want to check if osString is not empty, what would be the best way?
> >  
> > My bet:
> >  
> > if (osString.c_str() == NULL)
> >  
> > But I find it a little rusty... Is there any other better way?
> >  
> > Many thanks in advance
> >  
> > --
> > Jorge Arevalo
> > Freelance developer
> >  
> > http://www.krop.com/jorgearevalo
> > http://about.me/jorgeas80
> >  
> > Enviado con Sparrow (http://www.sparrowmailapp.com/?sig)
> >  
> >  
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org (mailto:gdal-dev at lists.osgeo.org)
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
>  
>  
>  
> --  
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up | Frank Warmerdam, warmerdam at pobox.com (mailto:warmerdam at pobox.com)
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush | Geospatial Software Developer




From thomasc at mirageoscience.com  Thu May 16 15:56:34 2013
From: thomasc at mirageoscience.com (Thomas Campagne)
Date: Thu, 16 May 2013 22:56:34 +0000
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift file
 when using EPSG codes?
Message-ID: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>

Hi,

I am using the GDAL API for Python for a script that takes only EPSG codes for inputs to specify source and target coordinate systems.
While the cs2cs command seems to handle quite well transformation between NAD27 (EPSG:4267) and NAD83 (EPSG:4326) coordinates in North America, I would like to have similar capabilities for AGD66 (EPSG:4202) to GDA94 (EPSG:4283) and AGD84 (EPSG:4203) to GDA94 (EPSG:4283) in Australia.
When using the -v option with cs2cs to look at the proj string being used i get the following:
    >cs2cs -v +init=epsg:4267
    ># ---- From Coordinate System ----
    >#Lat/long (Geodetic alias)
    >#
    ># +init=epsg:4267 +proj=longlat +datum=NAD27 +no_defs +ellps=clrk66
    ># +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
    ># ---- To Coordinate System ----
    >#Lat/long (Geodetic alias)
    >#
    ># +proj=latlong +datum=NAD27 +ellps=clrk66
    ># +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
The nadgrids parameters tells cs2cs to use the best fitting datum grid shift file from conus, alaska, ntv2_0.gsb, and ntv1_can.dat.
For AGD66 (EPSG:4202) cs2cs returns:
    >cs2cs -v +init=epsg:4202
    ># ---- From Coordinate System ----
    >#Lat/long (Geodetic alias)
    >#
    ># +init=epsg:4202 +proj=longlat +ellps=aust_SA
    ># +towgs84=-117.808,-51.536,137.784,0.303,0.446,0.234,-0.29 +no_defs
    ># ---- To Coordinate System ----
    >#Lat/long (Geodetic alias)
    >#
    ># +proj=latlong +ellps=aust_SA
    ># +towgs84=-117.808,-51.536,137.784,0.303,0.446,0.234,-0.29
There is no nadgrids parameter but a towgs84 instead. A grid shift file from the ICSM; "A66 National (13.09.01).gsb" contains the shift between AGD66 and GDA94.
How can I make GDAL/cs2cs/proj identify this file when using EPSG codes?
I tried to reinstall GDAL/cs2cs/proj using the osgeo4w installer with A66 National (13.09.01).gsb within the directory containing the other datum shift files prior to the reinstallation but without success.

I also posted an enhancement ticket on Trac:
http://trac.osgeo.org/gdal/ticket/5085

Cheers

Thomas

[Description: cid:image002.gif at 01CBC6E3.6EDE0130]
Thomas Campagne, M.Sc. Geophysics, Consultant
ADVANCED GEOPHYSICAL INTERPRETATION CENTRE
www.MiraGeoscience.com<http://www.mirageoscience.com/>  tel +1 778 329 0430 ext 227, 512B - 409 Granville St, Vancouver, BC, V6C 1T2, Canada

+ Our Q2 eNewsletter 2013 is now out! You may download it here<http://goo.gl/9GDBi>.

+ August 11-14 We will be hosting a workshop at the ASEG Conference in Melbourne, Australia. Stop by Booth 49. More details here<http://www.mirageoscience.com/events/upcoming_events.php>.

+ August 12-15 We will be hosting a workshop at the SGA Biennial Meeting in Uppsala, Sweden. More details here<http://www.mirageoscience.com/events/upcoming_events.php>.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/fe533c0e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 2275 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130516/fe533c0e/attachment.jpg>

From assetfx at gmail.com  Thu May 16 17:43:15 2013
From: assetfx at gmail.com (Hank Finley)
Date: Fri, 17 May 2013 10:43:15 +1000
Subject: [gdal-dev] Wrapping with SWIG
Message-ID: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>

Hi All,

I'm currently trying to create a wrapper for a C API with SWIG for use in
Java. The API is for an open source spatial database called Spatialite.

This is causing a few headaches and I need some help.

My first question is did the SWIG wrappers for GDAL get created in-house or
was it a paid for project?
The second is there someone that could lend a hand?

-- 
Regards Hank
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130517/2840bc24/attachment.html>

From ari.jolma at gmail.com  Thu May 16 21:51:15 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 17 May 2013 07:51:15 +0300
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
Message-ID: <5195B743.4040401@gmail.com>

On 05/17/2013 03:43 AM, Hank Finley wrote:
> Hi All,
>
> I'm currently trying to create a wrapper for a C API with SWIG for use 
> in Java. The API is for an open source spatial database called Spatialite.
>
> This is causing a few headaches and I need some help.
>
> My first question is did the SWIG wrappers for GDAL get created 
> in-house or was it a paid for project?

Hank,

AFAIK, there was no money involved, but some of those that initiated the 
development are not any more involved - you can see their names in the 
associated source files. Probably Howard is the most knowledgeable on 
the overall matter from those on this list. However, he's probably not 
the best source for Java specific things. I'm not sure who is the Swig 
Java person at the moment. My knowledge is about Swig Perl.

> The second is there someone that could lend a hand?

I believe Swig provides tools for a bootstrap so you should be on your 
way, but the question is how far? Are you dealing with a specific issue 
or more general issue? Did you try the Swig list? I've asked a couple of 
questions on that some (long) time ago.

Best regards,

Ari
>
> -- 
> Regards Hank
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130517/367e744e/attachment-0001.html>

From assetfx at gmail.com  Thu May 16 23:17:40 2013
From: assetfx at gmail.com (Hank Finley)
Date: Thu, 16 May 2013 23:17:40 -0700 (PDT)
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <5195B743.4040401@gmail.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<5195B743.4040401@gmail.com>
Message-ID: <1368771460100-5053853.post@n6.nabble.com>

Hi Ari,

thanks for your time, yes I have tried the SWIG list a few times, however
replies are 'far and few between', so I am stretching out to new sources of
help. It is not what you would call an active list.

At the moment I am just focusing on one header file that has 8 struct's that
are coming up with SWIGTYPE_p opaque types, so I guess that the issue is
specific.

Yes I am on my way, I have created an interface file and resolved a few
issues, however these others remain and I am not that knowledgeable that I
can solve them by myself.

The struct's are mostly to do with geometries and some of them are either
the same issue or familiar, so solving one would solve others.

Hopefully some one versed in SWIG / Java sees this and can help, any
forwarding on to users in the 'know' would be very appreciated!

Kind regards Hank



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrapping-with-SWIG-tp5053824p5053853.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Fri May 17 00:20:42 2013
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri, 17 May 2013 09:20:42 +0200
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
Message-ID: <CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>

Hank,

As far as I know Even Rouault has been working on the maintenance of
GDAL/Java wrapper in the recent time.
You may also consider using GDAL to access the spatialite db, which would
eliminate the need to create the wrapper around spatialite  as you have
mentioned.

Best regards,

Tamas



2013/5/17 Hank Finley <assetfx at gmail.com>

> Hi All,
>
> I'm currently trying to create a wrapper for a C API with SWIG for use in
> Java. The API is for an open source spatial database called Spatialite.
>
> This is causing a few headaches and I need some help.
>
> My first question is did the SWIG wrappers for GDAL get created in-house
> or was it a paid for project?
> The second is there someone that could lend a hand?
>
> --
> Regards Hank
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130517/e0eaa930/attachment.html>

From assetfx at gmail.com  Fri May 17 00:38:31 2013
From: assetfx at gmail.com (Hank Finley)
Date: Fri, 17 May 2013 00:38:31 -0700 (PDT)
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
Message-ID: <1368776311385-5053886.post@n6.nabble.com>

Hi Tamas,

thanks for the advice, I would still like to continue with my goal, down the
track I'm going to be using this to fuel my OpenGL graphical map. The SQL
API level was far too slow, so I am going to the C API level.

Is it possible to contact Even somehow?

Regards Hank



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrapping-with-SWIG-tp5053824p5053886.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Fri May 17 01:14:52 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 17 May 2013 11:14:52 +0300
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <1368776311385-5053886.post@n6.nabble.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
	<1368776311385-5053886.post@n6.nabble.com>
Message-ID: <CAEWPGn5bZtpWEr4Xvuj9EP-K3KOSqPtKbSNeOWJwSt4zBzH1pw@mail.gmail.com>

2013/5/17 Hank Finley <assetfx at gmail.com>

> Hi Tamas,
>
> thanks for the advice, I would still like to continue with my goal, down
> the
> track I'm going to be using this to fuel my OpenGL graphical map. The SQL
> API level was far too slow, so I am going to the C API level.
>
> Is it possible to contact Even somehow?
>


He's probably already read all these messages. :)



>
> Regards Hank
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrapping-with-SWIG-tp5053824p5053886.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130517/dedef780/attachment.html>

From etourigny.dev at gmail.com  Fri May 17 07:33:07 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 17 May 2013 11:33:07 -0300
Subject: [gdal-dev] gdalwarp does not apply source nodata value to
	destination
In-Reply-To: <CA+TxYvPw4MuyMUnFJ7Uaaaubi-QjjY0q5tSH_yMNTJjwaCwdBQ@mail.gmail.com>
References: <CA+TxYvPw4MuyMUnFJ7Uaaaubi-QjjY0q5tSH_yMNTJjwaCwdBQ@mail.gmail.com>
Message-ID: <CA+TxYvOJiTiZQqPrTip4CyAn8N22W=AQ8XBL8FTfgDbg_RvPrQ@mail.gmail.com>

I have created a ticket and attached a patch to resolve this.

http://trac.osgeo.org/gdal/ticket/5087

On Wed, May 15, 2013 at 11:12 AM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

> I have just noticed that destination nodata value is not set when
> -dstnodata option is not used in gdalwarp.
>
> This can be problematic when warping a dataset with no data values, as the
> result can be different from expected, if -dstnodata is not set.
> gdalwarp does use source nodata pixels if -srcnodata is not used.
>
> I consider this as a bug (or at the very least a limitation), because one
> cannot warp a dataset in an automatic fashion and get expected output (with
> same nodata value as input).
>
> Would it be OK to copy them over if -dstnodata is not used, or would there
> be problems with doing this? Or perhaps a new argument -copynodata could be
> added if there is fear of disruption.
>
> cheers
> Etienne
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130517/e67c74ec/attachment.html>

From thomasc at mirageoscience.com  Fri May 17 10:00:47 2013
From: thomasc at mirageoscience.com (Thomas Campagne)
Date: Fri, 17 May 2013 17:00:47 +0000
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift
 file when using EPSG codes?
In-Reply-To: <5196405B.5060900@gmx.eu>
References: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>
	<5196405B.5060900@gmx.eu>
Message-ID: <0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>

I am running GDAL (1.9.2-2) and PROJ4 (4.8.0-0) installations on Windows 7.
I have two installs of the latest release one through the osgeo4w setup and another with my PythonXY install. 

With osgeo4w the files are in :
C:\OSGeo4W\share\gdal  (contains csv files, and pci_datum.txt seems to contain references to grid shift files but not to EPSG codes)
C:\OSGeo4W\share\proj (contains an epsg file and the grid shift files with few lines containing the +nadgrids=@null parameter)

When I run cs2cs -v +init=epsg:4267 I still do not understand how the +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat parameter is being generated as I cannot find it within the text/csv files.

With PythonXY the files are in:
C:\Python27\GDAL\data    (contains csv files, and pci_datum.txt seems to contain references to grid shift files but not to EPSG codes)
C:\Python27\Lib\site-packages\pyproj\data  (contains an epsg file and the grid shift files with few lines containing the +nadgrids=@null parameter)

I thought about editing relevant files of my GDAL and PROJ4 installation but I could not understand which one as I based my search on the NAD27/NAD83 datum shift and could not understand how it is working...

Any idea about which files to edit to add the nadgrids parameter to the proj string referenced by a given EPSG code (4202 for AGD66 as example)?

Thomas

-----Original Message-----
From: Hermann Peifer [mailto:peifer at gmx.eu] 
Sent: May-17-13 7:36 AM
To: Thomas Campagne
Subject: Re: How to set GDAL/cs2cs/proj to use NTv2 grid shift file when using EPSG codes?

What about editing relevant files of your GDAL and PROJ4 installation, as a diry quick hack?

On my MacBook, I would look for the csv files at /opt/local/share/gdal/ and the epsg file at /opt/local/share/proj/

/opt/local/share/proj/ is also the directory where I put extra grid shift files like OSTN02_NTv2.gsb and BETA2007.gsb

Hermann

On 2013-05-16 19:56, Thomas Campagne wrote:
> Hi,
>
> I am using the GDAL API for Python for a script that takes only EPSG 
> codes for inputs to specify source and target coordinate systems.
>
> While the cs2cs command seems to handle quite well transformation 
> between NAD27 (EPSG:4267) and NAD83 (EPSG:4326) coordinates in North 
> America, I would like to have similar capabilities for AGD66 
> (EPSG:4202) to GDA94 (EPSG:4283) and AGD84 (EPSG:4203) to GDA94 
> (EPSG:4283) in Australia.
>
> When using the -v option with cs2cs to look at the proj string being 
> used i get the following:
>
>      >cs2cs -v +init=epsg:4267
>
>      ># ---- From Coordinate System ----
>
>      >#Lat/long (Geodetic alias)
>
>      >#
>
>      ># +init=epsg:4267 +proj=longlat +datum=NAD27 +no_defs 
> +ellps=clrk66
>
>      ># +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>
>      ># ---- To Coordinate System ----
>
>      >#Lat/long (Geodetic alias)
>
>      >#
>
>      ># +proj=latlong +datum=NAD27 +ellps=clrk66
>
>      ># +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
>
> The nadgrids parameters tells cs2cs to use the best fitting datum grid 
> shift file from conus, alaska, ntv2_0.gsb, and ntv1_can.dat.
>
> For AGD66 (EPSG:4202) cs2cs returns:
>
>      >cs2cs -v +init=epsg:4202
>
>      ># ---- From Coordinate System ----
>
>      >#Lat/long (Geodetic alias)
>
>      >#
>
>      ># +init=epsg:4202 +proj=longlat +ellps=aust_SA
>
>      ># +towgs84=-117.808,-51.536,137.784,0.303,0.446,0.234,-0.29 
> +no_defs
>
>      ># ---- To Coordinate System ----
>
>      >#Lat/long (Geodetic alias)
>
>      >#
>
>      ># +proj=latlong +ellps=aust_SA
>
>      ># +towgs84=-117.808,-51.536,137.784,0.303,0.446,0.234,-0.29
>
> There is no nadgrids parameter but a towgs84 instead. A grid shift 
> file from the ICSM; "A66 National (13.09.01).gsb" contains the shift 
> between
> AGD66 and GDA94.
>
> How can I make GDAL/cs2cs/proj identify this file when using EPSG codes?
>
> I tried to reinstall GDAL/cs2cs/proj using the osgeo4w installer with
> A66 National (13.09.01).gsb within the directory containing the other 
> datum shift files prior to the reinstallation but without success.
>
> I also posted an enhancement ticket on Trac:
>
> http://trac.osgeo.org/gdal/ticket/5085
>
> Cheers
>
> Thomas
>
> *Description: cid:image002.gif at 01CBC6E3.6EDE0130*
>
> *Thomas Campagne, M.Sc. Geophysics, Consultant
> **A**DVANCED**G**EOPHYSICAL**I**NTERPRETATION**C**ENTRE**
> *www.MiraGeoscience.com <http://www.mirageoscience.com/>**tel +1 778 
> 329
> 0430 ext 227, 512B - 409 Granville St, Vancouver, BC, V6C 1T2, Canada
>
> **
>
> *+ *Our Q2 eNewsletter 2013 is now out!You may download it here 
> <http://goo.gl/9GDBi>.
>
> + August 11-14 We will be hosting a workshop at the ASEG Conference in
> Melbourne, Australia. Stop by Booth 49. More details here 
> <http://www.mirageoscience.com/events/upcoming_events.php>.
>
> + August 12-15 We will be hosting a workshop at the SGA Biennial 
> + Meeting
> in Uppsala, Sweden. More details here
> <http://www.mirageoscience.com/events/upcoming_events.php>.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From andre+joost at nurfuerspam.de  Fri May 17 10:21:29 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 17 May 2013 19:21:29 +0200
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift
 file when using EPSG codes?
In-Reply-To: <0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>
References: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>
	<5196405B.5060900@gmx.eu>
	<0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>
Message-ID: <kn5ovm$l09$1@ger.gmane.org>

Am 17.05.2013 19:00, schrieb Thomas Campagne:

> When I run cs2cs -v +init=epsg:4267 I still do not understand how the
> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat parameter is being
> generated as I cannot find it within the text/csv files.
>

EPSG:4267 expands to
+proj=longlat +datum=NAD27 +no_defs

and the nadgrids are in the "+datum=NAD27". This is hardcoded in
<http://trac.osgeo.org/proj/browser/trunk/proj/src/pj_datums.c>
> "NAD27",    "nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat",
> 	                                                     "clrk66",
> 	                                "North_American_Datum_1927",


> Any idea about which files to edit to add the nadgrids parameter to
> the proj string referenced by a given EPSG code (4202 for AGD66 as
> example)?


You could add a line for AGD66 datum and nadgrid file in the file, and 
compile from source. And you have to change the share/proj/epsg file to 
use your datum istead of +towgs84.

Or try to insert the +nadgrids=<filename> for the AGD66 entry directly.

HTH,
Andr? Joost



From gdt at ir.bbn.com  Sat May 18 04:56:11 2013
From: gdt at ir.bbn.com (Greg Troxel)
Date: Sat, 18 May 2013 07:56:11 -0400
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <1368776311385-5053886.post@n6.nabble.com> (Hank Finley's message
	of "Fri, 17 May 2013 00:38:31 -0700 (PDT)")
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
	<1368776311385-5053886.post@n6.nabble.com>
Message-ID: <rmid2soh57o.fsf@fnord.ir.bbn.com>


Hank Finley <assetfx at gmail.com> writes:

> thanks for the advice, I would still like to continue with my goal, down the
> track I'm going to be using this to fuel my OpenGL graphical map. The SQL
> API level was far too slow, so I am going to the C API level.
>
> Is it possible to contact Even somehow?

I may have missed something, but you don't seem to have posted a
detailed explanation of what you did and what your problem is.
Generally people are more willing to help in public, because the
archived replies will help others.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130518/9142ac2d/attachment.pgp>

From gillingham.sam at gmail.com  Sat May 18 15:27:45 2013
From: gillingham.sam at gmail.com (Sam Gillingham)
Date: Sun, 19 May 2013 10:27:45 +1200
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance of Raster
 Attribute Table implementation for large tables"
Message-ID: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>

Dear PSC members,

I propose a motion to get RFC 40 - "Improving performance of Raster
Attribute Table implementation for large tables" formally adopted.

This adds some new functionality for GDAL 2.0. Even, Frank and others have
made suggestions and these have been incorporated into the RFC:
http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support

I'll start with a:

+1 from me


Thanks,
Sam.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130519/ca02ebe7/attachment.html>

From assetfx at gmail.com  Sat May 18 16:32:43 2013
From: assetfx at gmail.com (Hank Finley)
Date: Sat, 18 May 2013 16:32:43 -0700 (PDT)
Subject: [gdal-dev] Wrapping with SWIG (with attached example)
In-Reply-To: <rmid2soh57o.fsf@fnord.ir.bbn.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
	<1368776311385-5053886.post@n6.nabble.com>
	<rmid2soh57o.fsf@fnord.ir.bbn.com>
Message-ID: <1368919963323-5054207.post@n6.nabble.com>

Hi Greg,

Your right I haven't posted any issue yet. I am trying to look for a person
with the right skills that could help me first.

I am looking for someone that has had experience wrapping the C language
with SWIG, for use in Java. If I can find someone then I will gladly post
more detail.

Change of heart...
I am attempting to wrap Spatialite structs and functions for use in Java. I
am using SWIG to do this. At the moment I am focused on the structs. They
reside in structs.h. When SWIG cannot figure out how to wrap something it
creates opaque datatypes, like SWIGTYPE_p_int (this is just an example). To
resolve the opaques you write an interface file that tells SWIG how to
manage the datatype. I have resolved some of these, however there are some
that remain and I am trying to find someone that could lend me a hand, as I
have gone as far as I can by myself.

I have attached a zip that contains the struct.h header file and my
structs.i interface file. In structs.h I have underlined the types that have
caused SWIG to create opaque datatypes. I have written short notes beside
the ones I have resolved. example.zip
<http://osgeo-org.1560.x6.nabble.com/file/n5054207/example.zip>  

Kind regards Hank



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Wrapping-with-SWIG-tp5053824p5054207.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Sun May 19 03:32:45 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 19 May 2013 12:32:45 +0200
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance of
	Raster Attribute Table implementation for large tables"
In-Reply-To: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
References: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
Message-ID: <1368959565.5198aa4d8253a@imp.free.fr>

Selon Sam Gillingham <gillingham.sam at gmail.com>:

> Dear PSC members,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" formally adopted.
>

+1 Even




From petebunting at mac.com  Sun May 19 06:12:58 2013
From: petebunting at mac.com (Peter Bunting)
Date: Sun, 19 May 2013 14:12:58 +0100
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance
 of	Raster Attribute Table implementation for large tables"
In-Reply-To: <1368959565.5198aa4d8253a@imp.free.fr>
References: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
	<1368959565.5198aa4d8253a@imp.free.fr>
Message-ID: <10F98401-678C-48E5-BA47-BFB61606B49E@mac.com>

+1 Pete

On 19 May 2013, at 11:32, Even Rouault <even.rouault at mines-paris.org> wrote:

> Selon Sam Gillingham <gillingham.sam at gmail.com>:
> 
>> Dear PSC members,
>> 
>> I propose a motion to get RFC 40 - "Improving performance of Raster
>> Attribute Table implementation for large tables" formally adopted.
>> 
> 
> +1 Even
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Sun May 19 07:45:29 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun, 19 May 2013 07:45:29 -0700
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance of
 Raster Attribute Table implementation for large tables"
In-Reply-To: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
References: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
Message-ID: <CA+YzLBeh4-ic6+nTpyrPVwD=suM1RGwPmAvrXHGnieGN89nq-g@mail.gmail.com>

+1 Frank


On Sat, May 18, 2013 at 3:27 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Dear PSC members,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" formally adopted.
>
> This adds some new functionality for GDAL 2.0. Even, Frank and others have
> made suggestions and these have been incorporated into the RFC:
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> I'll start with a:
>
> +1 from me
>
>
> Thanks,
> Sam.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130519/3ee814a6/attachment.html>

From hobu.inc at gmail.com  Sun May 19 12:21:13 2013
From: hobu.inc at gmail.com (Howard Butler)
Date: Sun, 19 May 2013 14:21:13 -0500
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance of
	Raster Attribute Table implementation for large tables"
In-Reply-To: <CA+YzLBeh4-ic6+nTpyrPVwD=suM1RGwPmAvrXHGnieGN89nq-g@mail.gmail.com>
References: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
	<CA+YzLBeh4-ic6+nTpyrPVwD=suM1RGwPmAvrXHGnieGN89nq-g@mail.gmail.com>
Message-ID: <63CD614A-A394-423D-A9EB-9942EB12D765@gmail.com>

+1 Howard

I don't necessarily agree with the statement that this is a GDAL 2.0 item, however. We have plenty of examples of changing the C++ API and simply adding new stuff to the C API.  There's no reason why this can't go into GDAL 1.11, if that's what our next release is called, if the the C API does not change and only additions are made to support the new functionality.

I'm not sure I like the method name, ValuesIO, so much, but I don't have a better suggestion. Not that I like the name RasterIO either ;) 

Howard

/me is good at neither naming nor caching.

On May 19, 2013, at 9:45 AM, Frank Warmerdam <warmerdam at pobox.com> wrote:

> +1 Frank
> 
> 
> On Sat, May 18, 2013 at 3:27 PM, Sam Gillingham <gillingham.sam at gmail.com> wrote:
> Dear PSC members,
> 
> I propose a motion to get RFC 40 - "Improving performance of Raster Attribute Table implementation for large tables" formally adopted. 
> 
> This adds some new functionality for GDAL 2.0. Even, Frank and others have made suggestions and these have been incorporated into the RFC:
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
> 
> I'll start with a:
> 
> +1 from me
> 
> 
> Thanks,
> Sam.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From fupenghzau at gmail.com  Sun May 19 12:24:23 2013
From: fupenghzau at gmail.com (Peng FU)
Date: Sun, 19 May 2013 15:24:23 -0400
Subject: [gdal-dev] compile
Message-ID: <000301ce54c6$791dffb0$6b59ff10$@gmail.com>

Hi,

 

Does anyone know how to build gdal in linux OS or windows OS? I want to
include the netcdf library into the gdal? 

Thanks!

 

peng

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130519/859808f1/attachment.html>

From bishop.dev at gmail.com  Sun May 19 12:26:55 2013
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Sun, 19 May 2013 23:26:55 +0400
Subject: [gdal-dev] compile
In-Reply-To: <000301ce54c6$791dffb0$6b59ff10$@gmail.com>
References: <000301ce54c6$791dffb0$6b59ff10$@gmail.com>
Message-ID: <5199277F.6040207@gmail.com>

Hi Peng,

The full instructions can be found here:
http://trac.osgeo.org/gdal/wiki/BuildHints

Best regards,
     Dmitriy

19.05.2013 23:24, Peng FU ?????:
>
> Hi,
>
> Does anyone know how to build gdal in linux OS or windows OS? I want 
> to include the netcdf library into the gdal?
>
> Thanks!
>
> peng
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130519/cbca4996/attachment.html>

From etourigny.dev at gmail.com  Sun May 19 12:29:06 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Sun, 19 May 2013 16:29:06 -0300
Subject: [gdal-dev] compile
In-Reply-To: <000301ce54c6$791dffb0$6b59ff10$@gmail.com>
References: <000301ce54c6$791dffb0$6b59ff10$@gmail.com>
Message-ID: <CA+TxYvO6_eDKAmv0eUWx_WACOxzRPH2bG3dm38+B6DxHdyjxjw@mail.gmail.com>

On Sun, May 19, 2013 at 4:24 PM, Peng FU <fupenghzau at gmail.com> wrote:

> Hi,****
>
> ** **
>
> Does anyone know how to build gdal in linux OS or windows OS? I want to
> include the netcdf library into the gdal?
>

FYI some builds of gdal include netcdf support, such as  ubuntugis-unstable
PPA (for ubuntu and derivatives).


> ****
>
> Thanks!****
>
> ** **
>
> peng****
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130519/7470a15b/attachment.html>

From jaak at nutiteq.com  Mon May 20 09:26:09 2013
From: jaak at nutiteq.com (Jaak Laineste (Nutiteq))
Date: Mon, 20 May 2013 19:26:09 +0300
Subject: [gdal-dev] Some OGR drivers do not work
Message-ID: <4D7740AE-B6AC-491A-899D-046AE421B4FC@nutiteq.com>

Hello,

I compiled GDAL 0.10 release for Android, with basic driver package. I left cURL and other more complex dependencies for later. It works with partial success:

a) Snags during compiling:
 1. had to disable gif driver, as there was "undefined reference to `GIFAbstractDataset::GetMetadataItem". I don't see any real use of that anyway.
 2. from tif_open.c I removed lines 99 and 100 (asserts for 64bit types), as they appear not to work on 32bit ARMv7 (they assert false). Would it be safe enough? Interesting is that I did not have this problem with GDAL 0.9
 3. Some other tweaks and changes as described in [1] to get also Swig Java bindings working

b) Runtime problems. Main problem is that some OGR drivers do not open some of test files, even if ogr.GetDriver() reports them. See [2] for reported the list. There is no any error message, and debugging this via Android NDK would be a bit too much for me.
 1. Working files: shapefile, esripolygon.json, dxf, csv
 2. Not working: KML, GML and GeoJSON. By not working I mean Open (<file>,false) returns null.

So my questions:
1. Is there a way to troubleshoot runtime problems ? org.gdal.gdal.gdal.GetLastErrorMsg() seems to report nothing after Open error. Maybe some dependency missing from compilation?
2. Any hint how to fix tif_open.c problem properly?

Thank you,

[1] https://github.com/nutiteq/gdal/wiki/AndroidHowto
[2] https://github.com/nutiteq/hellomap3d/wiki/Ogr-layer 


Jaak
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/5c142718/attachment.html>

From warmerdam at pobox.com  Mon May 20 10:25:50 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 20 May 2013 10:25:50 -0700
Subject: [gdal-dev] Some OGR drivers do not work
In-Reply-To: <4D7740AE-B6AC-491A-899D-046AE421B4FC@nutiteq.com>
References: <4D7740AE-B6AC-491A-899D-046AE421B4FC@nutiteq.com>
Message-ID: <CA+YzLBd0QnBQMP9w7ZTjAjd1eVykbp5sHUpA-QbO72UP0Gd0vw@mail.gmail.com>

On Mon, May 20, 2013 at 9:26 AM, Jaak Laineste (Nutiteq)
<jaak at nutiteq.com>wrote:

> Hello,
>
> I compiled GDAL 0.10 release for Android, with basic driver package. I
> left cURL and other more complex dependencies for later. It works with
> partial success:
>
> a) Snags during compiling:
>  1. had to disable gif driver, as there was "undefined reference to
> `GIFAbstractDataset::GetMetadataItem". I don't see any real use of that
> anyway.
>  2. from tif_open.c I removed lines 99 and 100 (asserts for 64bit types),
> as they appear not to work on 32bit ARMv7 (they assert false). Would it be
> safe enough? Interesting is that I did not have this problem with GDAL 0.9
>

 Jaak,

When using a built-in libtiff build, libtiff uses the GDAL GIntBig and
GUIntBig types for 64 bit integers.  So this failure means that the
definitions for these types in gdal/port/cpl_port.h are not actually
64bits.  That looks like:

#if defined(WIN32) && defined(_MSC_VER)

#define VSI_LARGE_API_SUPPORTED
typedef __int64          GIntBig;
typedef unsigned __int64 GUIntBig;

#elif HAVE_LONG_LONG

typedef long long        GIntBig;
typedef unsigned long long GUIntBig;

#else

typedef long             GIntBig;
typedef unsigned long    GUIntBig;

#endif

What is an appropriate 64bit integer type on Android?  You are likely
falling into the case that just uses long and unsigned long which is not
great on a 32bit platform.

Note that not getting this type right is likely behind some of the other
failures you are seeing.


 3. Some other tweaks and changes as described in [1] to get also Swig Java
> bindings working
>
> b) Runtime problems. Main problem is that some OGR drivers do not open
> some of test files, even if ogr.GetDriver() reports them. See [2] for
> reported the list. There is no any error message, and debugging this via
> Android NDK would be a bit too much for me.
>

You could customize error handling to log to a file or some other suitable
mechanism from gdal/port/cpl_error.cpp, and also turn on debug output.  For
a logging error handler do this near the start of your program:

  CPLSetConfigOption("CPL_LOG", "/tmp/your.log");
  CPLPushErrorHandler(CPLLoggingErrorHandler);

to enable debugging output do:

  CPLSetConfigOption("CPL_DEBUG", "ON");

I haven't used the logging error handler for a long time so it might be
quirkly/broken/wrong.

Thanks for reporting on your findings!

Best regards,
Frank


>  1. Working files: shapefile, esripolygon.json, dxf, csv
>  2. Not working: KML, GML and GeoJSON. By not working I mean Open
> (<file>,false) returns null.
>
> So my questions:
> 1. Is there a way to troubleshoot runtime problems
> ? org.gdal.gdal.gdal.GetLastErrorMsg() seems to report nothing after Open
> error. Maybe some dependency missing from compilation?
> 2. Any hint how to fix tif_open.c problem properly?
>
> Thank you,
>
> [1] https://github.com/nutiteq/gdal/wiki/AndroidHowto
> [2] https://github.com/nutiteq/hellomap3d/wiki/Ogr-layer
>
>
> Jaak
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/3974eb48/attachment-0001.html>

From ahmettemiz88 at gmail.com  Mon May 20 10:43:48 2013
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Mon, 20 May 2013 20:43:48 +0300
Subject: [gdal-dev] weird slope map
Message-ID: <CAJKO1YuDeFs=_L=uh_CQ5fpP0vKMA37_vAVMKZ+yRgNZ0vnEig@mail.gmail.com>

Hello

I obtained steplike slope map from elevation iso lines.

What are the likely problems ?

regards
-- 
Ahmet Temiz
Jeoloji M?h.
Afet ve Acil Durum Y?netimi Ba?kanl???
Planlama ve Zarar Azaltma Dairesi Ba?kanl???


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/5e75a1fa/attachment.html>

From fupenghzau at gmail.com  Mon May 20 11:34:15 2013
From: fupenghzau at gmail.com (Peng Fu)
Date: Mon, 20 May 2013 14:34:15 -0400
Subject: [gdal-dev] problem with gdal_translate
Message-ID: <CANyfTqs=Ce+R25rmjYJrJJy6yH2GcUpDpz5tL3cyouyW=aynAA@mail.gmail.com>

Hi,

I used the gdal_translate to store the netcdf data into geotiff file, but
it just gave me an error:
Input file contains subdatasets. Please, select one of them for reading.

command:
gdal_translate -of GTiff -b 9 -a_srs EPSG:4326  BAND_02.nc  /test.tif

Does anyone know what is the problem?

Thanks!

Peng
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/16390bbe/attachment.html>

From ari.jolma at gmail.com  Mon May 20 12:17:59 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 20 May 2013 22:17:59 +0300
Subject: [gdal-dev] Problems when mixing https calls
Message-ID: <519A76E7.4050801@gmail.com>

Hi,

I've run into problems when I use https calls from two systems (Perl's 
libww and GDAL) in one program. The use case is WFS with https. First I 
use Perl like this

my $ua = LWP::UserAgent->new;
my $response = $ua->get('https://xxx');

(note that the call does not need to be to the actual WFS, any https 
call is enough to cause a problem and note that this is just using net 
code - the Perl variables may be destroyed completely before we use GDAL)

and then I use GDAL

my $Driver = Geo::OGR::GetDriver('WFS');
my $DataSource = $Driver->Open('WFS:https://xxx', 0);
my $Layer = $DataSource->Layer('xxx');
my $c = $Layer->GetFeatureCount();

During the last command there is a segfault in the bindings of Perl code 
to OpenSSL (surprise!). The segfault does not appear if I remove the 
Perl get call.

My theory is that when I use Perl to access content from a https source 
it leaves a callback to OpenSSL, which is then used for some reason when 
GDAL uses Curl, which uses OpenSSL again.

The Perl bindings code has this comment:

"we intentionally do not implement cleanup of openssl's threading as it 
causes troubles"

This page

http://www.openssl.org/docs/crypto/threads.html

explains about OpenSSL use in multithreaded applications.

Of course it may just be that I'm using a binary OpenSSL, which was 
compiled with different compiler version than what I have (this is Linux 
Mint 64bit).

My question is, is CPL of GDAL doing anything related to OpenSSL (like 
setting callbacks) or is that completely in Curl's domain? Has anybody 
else seen anything like this before?

Cheers,

Ari


From jukka.rahkonen at mmmtike.fi  Mon May 20 12:30:37 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 20 May 2013 19:30:37 +0000 (UTC)
Subject: [gdal-dev] weird slope map
References: <CAJKO1YuDeFs=_L=uh_CQ5fpP0vKMA37_vAVMKZ+yRgNZ0vnEig@mail.gmail.com>
Message-ID: <loom.20130520T212601-902@post.gmane.org>

Ahmet Temiz <ahmettemiz88 <at> gmail.com> writes:

> 
> 
> Hello
> 
> I obtained steplike slope map from elevation iso lines.
> 
> What are the likely problems ?

Can you give us a sample of your source data and the exact commands you have
used? Perhaps also some example about what you would like to get as a result.

Regards,

-Jukka Rahkonen-



From etourigny.dev at gmail.com  Mon May 20 12:38:27 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 20 May 2013 16:38:27 -0300
Subject: [gdal-dev] problem with gdal_translate
In-Reply-To: <CANyfTqs=Ce+R25rmjYJrJJy6yH2GcUpDpz5tL3cyouyW=aynAA@mail.gmail.com>
References: <CANyfTqs=Ce+R25rmjYJrJJy6yH2GcUpDpz5tL3cyouyW=aynAA@mail.gmail.com>
Message-ID: <CA+TxYvPTt7Fqg_WiCiDLnYmrq9_BqpfZuGzTZ9mg-qGRJtkJhw@mail.gmail.com>

Please look at the netcdf docs at [1]

When there are various variables in a netcdf ffile, gdal treats them as
subdatasets, you can only operate on one at a time.

calling gdalinfo on the netcdf file will reveal the special names used to
access each subdataset

[1] http://www.gdal.org/frmt_netcdf.html


On Mon, May 20, 2013 at 3:34 PM, Peng Fu <fupenghzau at gmail.com> wrote:

> Hi,
>
> I used the gdal_translate to store the netcdf data into geotiff file, but
> it just gave me an error:
> Input file contains subdatasets. Please, select one of them for reading.
>
> command:
> gdal_translate -of GTiff -b 9 -a_srs EPSG:4326  BAND_02.nc  /test.tif
>
> Does anyone know what is the problem?
>
> Thanks!
>
> Peng
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/9d5d716e/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon May 20 12:46:36 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 20 May 2013 19:46:36 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?problem_with_gdal=5Ftranslate?=
References: <CANyfTqs=Ce+R25rmjYJrJJy6yH2GcUpDpz5tL3cyouyW=aynAA@mail.gmail.com>
Message-ID: <loom.20130520T213529-334@post.gmane.org>

Peng Fu <fupenghzau <at> gmail.com> writes:


> Hi,
> I used the gdal_translate to store the netcdf data into geotiff file, but
it just gave me an error:
> Input file contains subdatasets. Please, select one of them for
reading.command:gdal_translate -of GTiff -b 9 -a_srs EPSG:4326? BAND_02.nc?
/test.tif


I have never done anything with netcfd, but I would run gdalinfo for getting
a list about the subdatasets and then use that as a source as described in
the driver manual page http://www.gdal.org/frmt_netcdf.html

Perhaps it will be something like NETCDF:"BAND_02.nc":subdataset

-Jukka Rahkonen-


From etourigny.dev at gmail.com  Mon May 20 12:49:01 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Mon, 20 May 2013 16:49:01 -0300
Subject: [gdal-dev] problem with gdal_translate
In-Reply-To: <CANyfTqt4PYNr6U+pq7Wmo=Jkcm5sVcv5x3Ev7Xudm+Mq2RC4_A@mail.gmail.com>
References: <CANyfTqs=Ce+R25rmjYJrJJy6yH2GcUpDpz5tL3cyouyW=aynAA@mail.gmail.com>
	<CA+TxYvPTt7Fqg_WiCiDLnYmrq9_BqpfZuGzTZ9mg-qGRJtkJhw@mail.gmail.com>
	<CANyfTqt4PYNr6U+pq7Wmo=Jkcm5sVcv5x3Ev7Xudm+Mq2RC4_A@mail.gmail.com>
Message-ID: <CA+TxYvNFj7r9TGv_N_VdE5YPwgKyC2PXLz_C01QKsjiAvxvz8w@mail.gmail.com>

On Mon, May 20, 2013 at 4:41 PM, Peng Fu <fupenghzau at gmail.com> wrote:

> Thanks! I fixed the problem.
> But it seems that the resultant geotiff image doesn't have coordinate
> information. Do you know how to keep the coordinate information?
>

that's probably because it doesn't have one... it is a lat/lon file right?
 did you add the -a_srs EPSG:4326 argument to gdal_translate?

Perhaps you mean there is no geotransform? Or perhaps the coordinate
information does not adhere to the CF Conventions [2], which gdal uses.

In any case calling gdalinfo on the subdataset will show which coordinate
information gdal gets from the netcdf file.

Send me the output of both gdalinfo and 'ncdump -h yourfile.nc'


[2]
http://cf-pcmdi.llnl.gov/documents/cf-conventions/1.6/cf-conventions.html




>
>
> Peng
>
>
> On Mon, May 20, 2013 at 3:38 PM, Etienne Tourigny <etourigny.dev at gmail.com
> > wrote:
>
>> Please look at the netcdf docs at [1]
>>
>> When there are various variables in a netcdf ffile, gdal treats them as
>> subdatasets, you can only operate on one at a time.
>>
>> calling gdalinfo on the netcdf file will reveal the special names used to
>> access each subdataset
>>
>> [1] http://www.gdal.org/frmt_netcdf.html
>>
>>
>> On Mon, May 20, 2013 at 3:34 PM, Peng Fu <fupenghzau at gmail.com> wrote:
>>
>>> Hi,
>>>
>>> I used the gdal_translate to store the netcdf data into geotiff file,
>>> but it just gave me an error:
>>> Input file contains subdatasets. Please, select one of them for reading.
>>>
>>> command:
>>> gdal_translate -of GTiff -b 9 -a_srs EPSG:4326  BAND_02.nc  /test.tif
>>>
>>> Does anyone know what is the problem?
>>>
>>> Thanks!
>>>
>>> Peng
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/10b49b21/attachment.html>

From even.rouault at mines-paris.org  Mon May 20 13:13:43 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 20 May 2013 22:13:43 +0200
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <519A76E7.4050801@gmail.com>
References: <519A76E7.4050801@gmail.com>
Message-ID: <1369080823.519a83f71e1fe@imp.free.fr>


>
> My question is, is CPL of GDAL doing anything related to OpenSSL (like
> setting callbacks)

No, to the best of my knowledge, there's nothing explicitely related to OpenSSL
in CPL use of curl. CPL code sets callbacks, but there are specific to the Curl
contexts created by CPL.

From ari.jolma at gmail.com  Mon May 20 14:33:36 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 21 May 2013 00:33:36 +0300
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <1369080823.519a83f71e1fe@imp.free.fr>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
Message-ID: <519A96B0.2080307@gmail.com>

Even,

Another strange thing with GDAL WFS driver. Earlier it did not try to 
access the HEAD of a XXX.resolved.gml and now it does:

Here's an excerpt from my server logs. These calls are created by GDAL, 
the first is a good GetFeature call, which gets 215633 bytes of GML and 
the next is bogus. I can see this made up in ogrgmldatasource.cpp but do 
not understand why. In February this did not happen and GDAL parsed the 
GML the WFS provided fine (it actually created by GDAL too).

213.157.86.72 - ajolma [21/May/2013:00:02:56 +0300] "GET 
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.geom 
HTTP/1.1" 200 215633
213.157.86.72 - ajolma [21/May/2013:00:02:58 +0300] "HEAD 
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.resolved.gml 
HTTP/1.1" 200 -

Do you have an idea what's going on here?

Thanks,

Ari

On 05/20/2013 11:13 PM, Even Rouault wrote:
>> My question is, is CPL of GDAL doing anything related to OpenSSL (like
>> setting callbacks)
> No, to the best of my knowledge, there's nothing explicitely related to OpenSSL
> in CPL use of curl. CPL code sets callbacks, but there are specific to the Curl
> contexts created by CPL.


From jgomezdans at gmail.com  Mon May 20 15:46:57 2013
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Mon, 20 May 2013 23:46:57 +0100
Subject: [gdal-dev] multiple access to a file
Message-ID: <CAMWde5qbB=PLaD45N3_U4tL-o=HMtau9PkBc74e57R+q4vDPww@mail.gmail.com>

Hi,
I have a rather demanding processing scheme (read data from files, and
process pixel per pixel). It's trivial to parallelise (just do pixels in
different machines/cores), and I intend to run this on several machines on
our cluster.

I'm unsure whether I can use GDAL (python bindings) like this. My idea
would be to first create the output files. After this, the scene is split
into several windows, and different works start processing the different
windows. Once a worker is done, it gets a handle to the created file and
writes a chunk to it, closes the handle an exits.

Questions are: does this "create and fill" make sense? Do I need to lock
the output files, or can I just write to the file handles (the windows
don't overlap)? Is this format dependent? Am I missing something? I'd
rather avoid creating lots of intermediate files to then stitch up.

Thanks!
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/261f80c3/attachment-0001.html>

From warmerdam at pobox.com  Mon May 20 16:02:15 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 20 May 2013 16:02:15 -0700
Subject: [gdal-dev] multiple access to a file
In-Reply-To: <CAMWde5qbB=PLaD45N3_U4tL-o=HMtau9PkBc74e57R+q4vDPww@mail.gmail.com>
References: <CAMWde5qbB=PLaD45N3_U4tL-o=HMtau9PkBc74e57R+q4vDPww@mail.gmail.com>
Message-ID: <CA+YzLBeKeXcYR=_b41DurOPdV7KVvAzmVrWrKN_PFEjA3M8cng@mail.gmail.com>

Jose,

I'm sorry, but I don't think this will work trivially.

If you write a small part of an image, GDAL is likely to read a larger
area, update that and write it back.  If other programs happen to try and
update the same larger area at the same time some data is likely to be
lost.

If you are careful to write on tile/block boundaries, and use an output
file that preinitializes everything then it might work but it is likely to
be somewhat fragile.

Best regards,
Frank



On Mon, May 20, 2013 at 3:46 PM, Jose Gomez-Dans <jgomezdans at gmail.com>wrote:

> Hi,
> I have a rather demanding processing scheme (read data from files, and
> process pixel per pixel). It's trivial to parallelise (just do pixels in
> different machines/cores), and I intend to run this on several machines on
> our cluster.
>
> I'm unsure whether I can use GDAL (python bindings) like this. My idea
> would be to first create the output files. After this, the scene is split
> into several windows, and different works start processing the different
> windows. Once a worker is done, it gets a handle to the created file and
> writes a chunk to it, closes the handle an exits.
>
> Questions are: does this "create and fill" make sense? Do I need to lock
> the output files, or can I just write to the file handles (the windows
> don't overlap)? Is this format dependent? Am I missing something? I'd
> rather avoid creating lots of intermediate files to then stitch up.
>
> Thanks!
> Jose
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130520/4f64b7a7/attachment.html>

From even.rouault at mines-paris.org  Tue May 21 00:57:42 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 21 May 2013 09:57:42 +0200
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <519A96B0.2080307@gmail.com>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com>
Message-ID: <1369123062.519b28f62a3a5@imp.free.fr>

Selon Ari Jolma <ari.jolma at gmail.com>:

> Even,
>
> Another strange thing with GDAL WFS driver. Earlier it did not try to
> access the HEAD of a XXX.resolved.gml and now it does:
>
> Here's an excerpt from my server logs. These calls are created by GDAL,
> the first is a good GetFeature call, which gets 215633 bytes of GML and
> the next is bogus. I can see this made up in ogrgmldatasource.cpp but do
> not understand why. In February this did not happen and GDAL parsed the
> GML the WFS provided fine (it actually created by GDAL too).
>
> 213.157.86.72 - ajolma [21/May/2013:00:02:56 +0300] "GET
>
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.geom
> HTTP/1.1" 200 215633
> 213.157.86.72 - ajolma [21/May/2013:00:02:58 +0300] "HEAD
>
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.resolved.gml
> HTTP/1.1" 200 -
>
> Do you have an idea what's going on here?

Ari,

I don't remind a recent change that might have affected this (but my memory can
be fragile), but reviewing the GML driver code, the fact that .resolved.gml is
probed means that the GML driver doesn't recognize the first bytes of the
GetFeature response to be a GML WFS document. Could you paste them ? My
hypothesis would be that the FeatureCollection root element is in a XML
namespace different from none, gml or wfs.

Does the probing of .resolved.gml, apart from slowing down the process, prevent
the driver to parse the GetFeature document ? I think it should not, but there
might be subtle issues since it will probably not use the schema obtained with
DescribeFeatureType to return the GML layer.

Even

From ari.jolma at gmail.com  Tue May 21 01:07:07 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 21 May 2013 11:07:07 +0300
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <1369123062.519b28f62a3a5@imp.free.fr>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com> <1369123062.519b28f62a3a5@imp.free.fr>
Message-ID: <519B2B2B.6030406@gmail.com>

On 05/21/2013 10:57 AM, Even Rouault wrote:
> Selon Ari Jolma <ari.jolma at gmail.com>:
>
>> Even,
>>
>> Another strange thing with GDAL WFS driver. Earlier it did not try to
>> access the HEAD of a XXX.resolved.gml and now it does:
>>
>> Here's an excerpt from my server logs. These calls are created by GDAL,
>> the first is a good GetFeature call, which gets 215633 bytes of GML and
>> the next is bogus. I can see this made up in ogrgmldatasource.cpp but do
>> not understand why. In February this did not happen and GDAL parsed the
>> GML the WFS provided fine (it actually created by GDAL too).
>>
>> 213.157.86.72 - ajolma [21/May/2013:00:02:56 +0300] "GET
>>
> /OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.geom
>> HTTP/1.1" 200 215633
>> 213.157.86.72 - ajolma [21/May/2013:00:02:58 +0300] "HEAD
>>
> /OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.resolved.gml
>> HTTP/1.1" 200 -
>>
>> Do you have an idea what's going on here?
> Ari,
>
> I don't remind a recent change that might have affected this (but my memory can
> be fragile), but reviewing the GML driver code, the fact that .resolved.gml is
> probed means that the GML driver doesn't recognize the first bytes of the
> GetFeature response to be a GML WFS document. Could you paste them ?

<?xml version="1.0" encoding="utf-8" ?>
<ogr:FeatureCollection
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://ogr.maptools.org/ .xsd"
      xmlns:ogr="http://ogr.maptools.org/"
      xmlns:gml="http://www.opengis.net/gml">
   <gml:featureMember>
     <ogr:vtest_geom_  fid="vtest_geom_.0">
       <ogr:geometryProperty><gml:Point  srsName="EPSG:3067"><gml:coordinates>185607.11328746471554,6718884.468898030929267</gml:coordinates></gml:Point></ogr:geometryProperty>
       <ogr:id>6483</ogr:id>
     </ogr:vtest_geom_>
   </gml:featureMember>

...

>   My
> hypothesis would be that the FeatureCollection root element is in a XML
> namespace different from none, gml or wfs.

It seems to be in ogr (it's made by GDAL). I'll try changing that.

>
> Does the probing of .resolved.gml, apart from slowing down the process, prevent
> the driver to parse the GetFeature document ?

yes, the resolved.gml is not older than the GetFeature doc, thus it is 
used and found to be empty. I commented that out but it still can't 
parse the features.

>   I think it should not, but there
> might be subtle issues since it will probably not use the schema obtained with
> DescribeFeatureType to return the GML layer.

It is using the schema it got from DescribeFeature.

About the OpenSSL problem. I can probably bypass it by using only Curl 
(there are Perl bindings to Curl)

Ari


>
> Even

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130521/f0163e0e/attachment.html>

From even.rouault at mines-paris.org  Tue May 21 01:38:09 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 21 May 2013 10:38:09 +0200
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <519B2B2B.6030406@gmail.com>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com> <1369123062.519b28f62a3a5@imp.free.fr>
	<519B2B2B.6030406@gmail.com>
Message-ID: <1369125489.519b32719be5c@imp.free.fr>

Selon Ari Jolma <ari.jolma at gmail.com>:

> On 05/21/2013 10:57 AM, Even Rouault wrote:
> > Selon Ari Jolma <ari.jolma at gmail.com>:
> >
> >> Even,
> >>
> >> Another strange thing with GDAL WFS driver. Earlier it did not try to
> >> access the HEAD of a XXX.resolved.gml and now it does:
> >>
> >> Here's an excerpt from my server logs. These calls are created by GDAL,
> >> the first is a good GetFeature call, which gets 215633 bytes of GML and
> >> the next is bogus. I can see this made up in ogrgmldatasource.cpp but do
> >> not understand why. In February this did not happen and GDAL parsed the
> >> GML the WFS provided fine (it actually created by GDAL too).
> >>
> >> 213.157.86.72 - ajolma [21/May/2013:00:02:56 +0300] "GET
> >>
> >
>
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.geom
> >> HTTP/1.1" 200 215633
> >> 213.157.86.72 - ajolma [21/May/2013:00:02:58 +0300] "HEAD
> >>
> >
>
/OILRISK-protected/wfs.pl?SERVICE=WFS&VERSION=1.1.0&REQUEST=GetFeature&TYPENAME=OILRISK.vtest.resolved.gml
> >> HTTP/1.1" 200 -
> >>
> >> Do you have an idea what's going on here?
> > Ari,
> >
> > I don't remind a recent change that might have affected this (but my memory
> can
> > be fragile), but reviewing the GML driver code, the fact that .resolved.gml
> is
> > probed means that the GML driver doesn't recognize the first bytes of the
> > GetFeature response to be a GML WFS document. Could you paste them ?
>
> <?xml version="1.0" encoding="utf-8" ?>
> <ogr:FeatureCollection
>       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>       xsi:schemaLocation="http://ogr.maptools.org/ .xsd"
>       xmlns:ogr="http://ogr.maptools.org/"
>       xmlns:gml="http://www.opengis.net/gml">
>    <gml:featureMember>
>      <ogr:vtest_geom_  fid="vtest_geom_.0">
>        <ogr:geometryProperty><gml:Point
>
srsName="EPSG:3067"><gml:coordinates>185607.11328746471554,6718884.468898030929267</gml:coordinates></gml:Point></ogr:geometryProperty>
>        <ogr:id>6483</ogr:id>
>      </ogr:vtest_geom_>
>    </gml:featureMember>
>
> ...
>
> >   My
> > hypothesis would be that the FeatureCollection root element is in a XML
> > namespace different from none, gml or wfs.
>
> It seems to be in ogr (it's made by GDAL). I'll try changing that.

Yes, that's the likely cause and using wfs as the namespace should fix it.

Perhaps the detection of WFS documents could be made more robust, but in the
above case, I'm not sure that GML documents emitted by default by OGR are valid
WFS documents that could be successfully read by other WFS clients. I think (but
I'm not 100% positive about that) that the wfs namespace should appear
somewhere. At least that's what I've seen in all documents emitted by WFS
servers.

>
> >
> > Does the probing of .resolved.gml, apart from slowing down the process,
> prevent
> > the driver to parse the GetFeature document ?
>
> yes, the resolved.gml is not older than the GetFeature doc, thus it is
> used and found to be empty. I commented that out but it still can't
> parse the features.

Ah right, since the .resolved.gml is in a GET parameter, the server returns a
successfull HTTP code...

From ari.jolma at gmail.com  Tue May 21 02:39:09 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 21 May 2013 12:39:09 +0300
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <1369125489.519b32719be5c@imp.free.fr>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com> <1369123062.519b28f62a3a5@imp.free.fr>
	<519B2B2B.6030406@gmail.com> <1369125489.519b32719be5c@imp.free.fr>
Message-ID: <519B40BD.8090002@gmail.com>

On 05/21/2013 11:38 AM, Even Rouault wrote:
>
> Yes, that's the likely cause and using wfs as the namespace should fix it.
>
> Perhaps the detection of WFS documents could be made more robust, but in the
> above case, I'm not sure that GML documents emitted by default by OGR are valid
> WFS documents that could be successfully read by other WFS clients. I think (but
> I'm not 100% positive about that) that the wfs namespace should appear
> somewhere. At least that's what I've seen in all documents emitted by WFS
> servers.

QGIS is happy with it. But ok, I can change the server also. That seems 
to be settable now in OGR 1.10.

The GML did not parse into features until I changed the feature element 
names to be the same that was advertised and had been recorded into a 
GML Class - this is my bug clearly. However, before it was ok for GDAL 
and it still is ok for QGIS. GDAL seems pickier now.

Thanks,

Ari


From ari.jolma at gmail.com  Tue May 21 03:27:27 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 21 May 2013 13:27:27 +0300
Subject: [gdal-dev] Problems when mixing https calls
In-Reply-To: <1369130389.519b4595d50c6@imp.free.fr>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com> <1369123062.519b28f62a3a5@imp.free.fr>
	<519B2B2B.6030406@gmail.com> <1369125489.519b32719be5c@imp.free.fr>
	<519B40BD.8090002@gmail.com> <1369130389.519b4595d50c6@imp.free.fr>
Message-ID: <519B4C0F.4060202@gmail.com>

(sorry, gdal-dev was accidentally dropped)

On 05/21/2013 12:59 PM, Even Rouault wrote:
> Selon Ari Jolma <ari.jolma at gmail.com>:
>
>> On 05/21/2013 11:38 AM, Even Rouault wrote:
>>> Yes, that's the likely cause and using wfs as the namespace should fix it.
>>>
>>> Perhaps the detection of WFS documents could be made more robust, but in
>> the
>>> above case, I'm not sure that GML documents emitted by default by OGR are
>> valid
>>> WFS documents that could be successfully read by other WFS clients. I think
>> (but
>>> I'm not 100% positive about that) that the wfs namespace should appear
>>> somewhere. At least that's what I've seen in all documents emitted by WFS
>>> servers.
>> QGIS is happy with it. But ok, I can change the server also. That seems
>> to be settable now in OGR 1.10.
>>
>> The GML did not parse into features until I changed the feature element
>> names to be the same that was advertised and had been recorded into a
>> GML Class - this is my bug clearly.
> You mean there was a mismatch between the schema returned by DescribeFeatureType
> and the content of GetFeature ?

Yes, the name of the feature was different.

>
>> However, before it was ok for GDAL
>> and it still is ok for QGIS. GDAL seems pickier now.
> This is perhaps due to the WFS/GML driver running in streaming mode now. It uses
> the schema to be able to decode the GetFeature XML on-the-fly. Previously it
> downloaded the whole file in memory and could analyze its structure without
> relying on the XML schema (although I believe that if the schema was available,
> it was used, so I'm not completely sure that's the explanation).
> You can probably revert to the old behaviour by setting the environmenent
> variable OGR_WFS_USE_STREAMING to NO.

ok, well, streaming is better anyway,

Ari

>
>> Thanks,
>>
>> Ari
>>
>>
>


From jgomezdans at gmail.com  Tue May 21 03:30:19 2013
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Tue, 21 May 2013 11:30:19 +0100
Subject: [gdal-dev] multiple access to a file
In-Reply-To: <CA+YzLBeKeXcYR=_b41DurOPdV7KVvAzmVrWrKN_PFEjA3M8cng@mail.gmail.com>
References: <CAMWde5qbB=PLaD45N3_U4tL-o=HMtau9PkBc74e57R+q4vDPww@mail.gmail.com>
	<CA+YzLBeKeXcYR=_b41DurOPdV7KVvAzmVrWrKN_PFEjA3M8cng@mail.gmail.com>
Message-ID: <CAMWde5pH2yiX3Z+bu8BVxa5sGT9zff0Ytg_xDEb7y6YFPBk0NQ@mail.gmail.com>

Hi Frank,



On 21 May 2013 00:02, Frank Warmerdam <warmerdam at pobox.com> wrote:

> If you write a small part of an image, GDAL is likely to read a larger
> area, update that and write it back.  If other programs happen to try and
> update the same larger area at the same time some data is likely to be
> lost.
>

Thanks for your reply. However, locking the output files would still work?
Provided the cache has been flushed between the open/close dataset calls,
it should be fine?

Thanks!
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130521/e65cb92a/attachment.html>

From etourigny.dev at gmail.com  Tue May 21 05:23:00 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 21 May 2013 09:23:00 -0300
Subject: [gdal-dev] multiple access to a file
In-Reply-To: <CAMWde5pH2yiX3Z+bu8BVxa5sGT9zff0Ytg_xDEb7y6YFPBk0NQ@mail.gmail.com>
References: <CAMWde5qbB=PLaD45N3_U4tL-o=HMtau9PkBc74e57R+q4vDPww@mail.gmail.com>
	<CA+YzLBeKeXcYR=_b41DurOPdV7KVvAzmVrWrKN_PFEjA3M8cng@mail.gmail.com>
	<CAMWde5pH2yiX3Z+bu8BVxa5sGT9zff0Ytg_xDEb7y6YFPBk0NQ@mail.gmail.com>
Message-ID: <CA+TxYvN-=UHTf2SmMc+wwjBLXuoGtw4cMfJkK7kJWvfUpm5R5A@mail.gmail.com>

On Tue, May 21, 2013 at 7:30 AM, Jose Gomez-Dans <jgomezdans at gmail.com>wrote:

> Hi Frank,
>
>
>
> On 21 May 2013 00:02, Frank Warmerdam <warmerdam at pobox.com> wrote:
>
>> If you write a small part of an image, GDAL is likely to read a larger
>> area, update that and write it back.  If other programs happen to try and
>> update the same larger area at the same time some data is likely to be
>> lost.
>>
>
> Thanks for your reply. However, locking the output files would still work?
> Provided the cache has been flushed between the open/close dataset calls,
> it should be fine?
>

I guess it would work, but you probably won't get much speedup this way.

Like Frank says, not sure it would be so trivial as you would have to
implement something like MPI in the gdal I/O routines and take care that
blocks are assigned to each MPI process.

If you have many files to process, it might be easier to distribute the
many files over many machines simultaneously,  but write one file per
machine only.

cheers
Etienne


>
> Thanks!
> Jose
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130521/d8f865f2/attachment.html>

From jorgearevalo at libregis.org  Tue May 21 08:43:37 2013
From: jorgearevalo at libregis.org (Jorge Arevalo)
Date: Tue, 21 May 2013 17:43:37 +0200
Subject: [gdal-dev] [PostGis-raster] Unnecessary Extent SQL query on
 GetCoverage request
In-Reply-To: <CAARPnw8hchd+UtpuseLTBDyzk6S_iK5XR0T+eFMY1tpBAY7x+A@mail.gmail.com>
References: <CAARPnw8hchd+UtpuseLTBDyzk6S_iK5XR0T+eFMY1tpBAY7x+A@mail.gmail.com>
Message-ID: <CAMhtMNOUNsFjJWnYyQ=mOX7ebNz3swkGY1KgbRPV_-UizAw7wg@mail.gmail.com>

Hello Jean-Fran?ois,

I now it's late to answer this question. Sorry for that.

You couldn't avoid that query because was raised by the GDAL PostGIS Raster
driver. I'm working on some improvements right now, and that's one of the
improvements actually made. I suggest you to get the last code from 1.10
branch, and give it a try. That should solve this problem.

Best regards,

Jorge


On Thu, Jan 17, 2013 at 9:10 PM, Jean-Fran?ois Bourgon
<jfbourgon at gmail.com>wrote:

> I published a Postgis-raster table as a Mapserver WCS layer using
> gdal-1.10dev driver. I'm getting the expected result as output of my
> Getcoverage query but I'm concerned by the time required to extract the
> data. It takes about 3 minutes to extract a 4800 x 4800 pixels area. I
> looked at the SQL queries performed against the database during data
> processing and found that the GDAL driver execute a query in order to get
> the extent of my layer using the following SQL query:
>
> select srid, nbband, st_xmin(geom) as xmin, st_xmax(geom) as xmax,
> st_ymin(geom) as ymin, st_ymax(geom) as ymax
> from (select st_srid(rast) srid, st_extent(rast::geometry) geom,
> max(ST_NumBands(rast)) nbband from mib_postgis.gridcoverage_
> cdsm75 group by st_srid(rast)) foo;
>
> srid | nbband |       xmin        |       xmax        |       ymin
> |       ymax
>
> ------+--------+-------------------+-------------------+------------------+------------------
> 4617 |      1 | -139.500104166667 | -52.0001041666667 | 41.5001041666667 |
> 60.0001041666667
> (1 row)
>
> Time: 153033.599 ms
>
> I'm wondering how I could avoid this SQL to be performed on each call,
> since it is consuming a large amount of the request processing time and
> values are always the same.
>
> Is it something that could be fixed at database level or into my mapfile.
> See the my current mapfile layer definition:
>
> LAYER
>     NAME cdsm
>     GROUP cdsm
>     METADATA
>       "wcs_label"           "cdsm"  ### required
>       "wcs_rangeset_name"   "Range 1"    ### required to support
> DescribeCoverage request
>       "wcs_rangeset_label"  "My Label"   ### required to support
> DescribeCoverage request
>       "wcs_extent" "-139.500104166667 41.5001041666667 -52.0001041666667
> 60.0001041666667"
>       "wcs_resolution" "0.000208333333333 0.000208333333333"
>     END
>     TYPE RASTER
>     STATUS ON
>     PROCESSING "NODATA=255"
>     DATA "PG:host=hostname port=portnumber dbname='dbname' user='username'
> password='passwd' schema='schema' table='gridcoverage_cdsm75' mode='2'"
>     PROJECTION
>         "init=epsg:4617"
>     END
>   END
>
> Thanks,
>
> J-F
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Jorge Arevalo
Freelance developer

http://www.krop.com/jorgearevalo
http://about.me/jorgeas80
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130521/ce35aa63/attachment.html>

From kkirubanantham at yahoo.com  Wed May 22 00:03:32 2013
From: kkirubanantham at yahoo.com (Kiruba)
Date: Wed, 22 May 2013 00:03:32 -0700 (PDT)
Subject: [gdal-dev] *.ENC Files
Message-ID: <1369206212138-5054808.post@n6.nabble.com>

Hi All,
 
   I have written ENC (S57 - Electronic Nautical Chart) file viewer
application which reads *.000 extension. Recently I have received some S57
files with *.ENC extension which I am unable to read with this application. 
I have tried opening this with other application (SeeMyDEnc) but failed.
Please can someone explain about this file format and tell me how I can read
this file using GDAL?

Regards,
Kiruba.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ENC-Files-tp5054808.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ml at interatlas.fr  Wed May 22 01:28:27 2013
From: ml at interatlas.fr (M. LATTES)
Date: Wed, 22 May 2013 10:28:27 +0200
Subject: [gdal-dev] *.ENC Files
In-Reply-To: <1369206212138-5054808.post@n6.nabble.com>
References: <1369206212138-5054808.post@n6.nabble.com>
Message-ID: <041001ce56c6$6041a030$20c4e090$@fr>

Hi kiruba,

Take a look to the wotsit.org website they may have the file format
specification ?

Maybe this is for you : http://home.gdal.org/projects/s57/

Regards.

Mathieu LATTES
Directeur Technique
m.lattes at interatlas.fr
Tel : 01 46 30 63 63
Fax : 01 46 30 23 80
http://www.interatlas.fr
http://www.urbimap.com



-----Message d'origine-----
De?: gdal-dev-bounces at lists.osgeo.org
[mailto:gdal-dev-bounces at lists.osgeo.org] De la part de Kiruba
Envoy??: mercredi 22 mai 2013 09:04
??: gdal-dev at lists.osgeo.org
Objet?: [gdal-dev] *.ENC Files

Hi All,
 
   I have written ENC (S57 - Electronic Nautical Chart) file viewer
application which reads *.000 extension. Recently I have received some S57
files with *.ENC extension which I am unable to read with this application. 
I have tried opening this with other application (SeeMyDEnc) but failed.
Please can someone explain about this file format and tell me how I can read
this file using GDAL?

Regards,
Kiruba.



--
View this message in context:
http://osgeo-org.1560.x6.nabble.com/ENC-Files-tp5054808.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


From abhinav at vizexperts.com  Wed May 22 02:42:24 2013
From: abhinav at vizexperts.com (Abhinav)
Date: Wed, 22 May 2013 02:42:24 -0700 (PDT)
Subject: [gdal-dev] Regarding missing stylestring in SQLITE Driver
Message-ID: <1369215744244-5054868.post@n6.nabble.com>

Hi All,


I am using sqlite driver to write the OGRLayer to disk. I am setting
StyleString for each feature. But when I read back, my feature contains NULL
stylestring.  Though I am able to get other attributes, I am setting to the
feature.

I wonder whether sqlite driver supports writing style string or not? If It
allows, do we have to give any option to enable writing of the style ?

Thanks and regards
Abhinav Goyal





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Regarding-missing-stylestring-in-SQLITE-Driver-tp5054868.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From dengo at gmx.net  Wed May 22 03:20:19 2013
From: dengo at gmx.net (Dennis Gocke)
Date: Wed, 22 May 2013 12:20:19 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
Message-ID: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>

Hi,

I?ve encountered a problem with Pleiades JP2 files from Astrium, GDAL
crashes when opening the file.

You should be able to reproduce the the crash by downloading a sample
dataset from their page.

http://www.astrium-geo.com/en/23-sample-imagery
Optical Imagery->Pleiades->Pleiades Primary Product ? Bundle
You have to fill out the form and will then receive a download link via
email.

The crash happens with the file
FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2

And I have other JP2 Pleiades files where it happens too, so it?s not
related to this single file. Both ERDAS and ArcGIS are able to open the
file.

If it?s not possible to open the files with GDAL, an appropriate error
message instead of a crash would be good.
Thanks for looking into it.
Cheers,
Dennis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/488a9ad1/attachment.html>

From kkirubanantham at yahoo.com  Wed May 22 04:37:27 2013
From: kkirubanantham at yahoo.com (Kiruba)
Date: Wed, 22 May 2013 04:37:27 -0700 (PDT)
Subject: [gdal-dev] *.ENC Files
In-Reply-To: <041001ce56c6$6041a030$20c4e090$@fr>
References: <1369206212138-5054808.post@n6.nabble.com>
	<041001ce56c6$6041a030$20c4e090$@fr>
Message-ID: <1369222647047-5054893.post@n6.nabble.com>

HI Mathieu,

I am unable to file extension as *.ENC anywhere. Every place S57 files are
mentioned with *.000 extension. In fact the application i have referred
(SeeMyEnc) above is downloaded from that page only.

Anyway Thanks for your reply.
Kiruba. 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ENC-Files-tp5054808p5054893.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From warmerdam at pobox.com  Wed May 22 06:35:03 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 22 May 2013 06:35:03 -0700
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
Message-ID: <CA+YzLBf7A0o_rgDEqfB3-jtQ4iM81iBzTfY6j-=fFq=OtEq2rA@mail.gmail.com>

Dennis,

There are several jpeg2000 drivers potentially available for gdal.  Do you
know which you are using?

Best regards,
 On May 22, 2013 5:20 AM, "Dennis Gocke" <dengo at gmx.net> wrote:

> Hi,
>
>  I?ve encountered a problem with Pleiades JP2 files from Astrium, GDAL
> crashes when opening the file.
>
> You should be able to reproduce the the crash by downloading a sample
> dataset from their page.
>
> http://www.astrium-geo.com/en/23-sample-imagery
> Optical Imagery->Pleiades->Pleiades Primary Product ? Bundle
> You have to fill out the form and will then receive a download link via
> email.
>
> The crash happens with the file
> FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>
> And I have other JP2 Pleiades files where it happens too, so it?s not
> related to this single file. Both ERDAS and ArcGIS are able to open the
> file.
>
>  If it?s not possible to open the files with GDAL, an appropriate error
> message instead of a crash would be good.
> Thanks for looking into it.
>  Cheers,
> Dennis
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/024414c9/attachment.html>

From jukka.rahkonen at mmmtike.fi  Wed May 22 07:11:30 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 22 May 2013 14:11:30 +0000 (UTC)
Subject: [gdal-dev] Regarding missing stylestring in SQLITE Driver
References: <1369215744244-5054868.post@n6.nabble.com>
Message-ID: <loom.20130522T160519-361@post.gmane.org>

Abhinav <abhinav <at> vizexperts.com> writes:

> 
> Hi All,
> 
> I am using sqlite driver to write the OGRLayer to disk. I am setting
> StyleString for each feature. But when I read back, my feature contains NULL
> stylestring.  Though I am able to get other attributes, I am setting to the
> feature.
> 
> I wonder whether sqlite driver supports writing style string or not? If It
> allows, do we have to give any option to enable writing of the style ?

Hi,

Please tell us how you tried to do your task. Here is what I did in my quick
test.


Step 1: Set OGR style with SQL and write features with styles into
Spatialite db.

ogr2ogr -f SQLite -dsco spatialite=yes styletest.sqlite finland.osm.pbf -sql
"select highway, ref, 'SYMBOL(id:bus_stop.png)' as OGR_STYLE from points
where highway='bus_stop'"

Step 2: Check with ogrinfo what we have in the db

C:\ohjelmat\GDAL_dev>ogrinfo -al styletest.sqlite
INFO: Open of `styletest.sqlite'
      using driver `SQLite' successful.

........

FID Column = OGC_FID
Geometry Column = GEOMETRY
highway: String (0.0)
ref: String (0.0)
ogr_style: String (0.0)
OGRFeature(points):1
  highway (String) = bus_stop
  ref (String) = (null)
  ogr_style (String) = SYMBOL(id:bus_stop.png)
  Style = SYMBOL(id:bus_stop.png)
  POINT (28.0978864 61.0612954)

OGRFeature(points):2
  highway (String) = bus_stop
  ref (String) = (null)
  ogr_style (String) = SYMBOL(id:bus_stop.png)
  Style = SYMBOL(id:bus_stop.png)
  POINT (28.1802628 61.0576507)

Looks good to me.

-Jukka Rahkonen-




From dengo at gmx.net  Wed May 22 09:42:57 2013
From: dengo at gmx.net (Dennis Gocke)
Date: Wed, 22 May 2013 18:42:57 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CA+YzLBf7A0o_rgDEqfB3-jtQ4iM81iBzTfY6j-=fFq=OtEq2rA@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CA+YzLBf7A0o_rgDEqfB3-jtQ4iM81iBzTfY6j-=fFq=OtEq2rA@mail.gmail.com>
Message-ID: <CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>

I'm using the stable 1.10 build from Tamas' site.

GDALIdentifyDriver on the file reports: "ERDAS JPEG2000 (SDK 3.x)"

When trying to open the file I get an AccessViolationException.

Cheers,
Dennis


On Wed, May 22, 2013 at 3:35 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Dennis,
>
> There are several jpeg2000 drivers potentially available for gdal.  Do you
> know which you are using?
>
> Best regards,
>  On May 22, 2013 5:20 AM, "Dennis Gocke" <dengo at gmx.net> wrote:
>
>> Hi,
>>
>>  I?ve encountered a problem with Pleiades JP2 files from Astrium, GDAL
>> crashes when opening the file.
>>
>> You should be able to reproduce the the crash by downloading a sample
>> dataset from their page.
>>
>> http://www.astrium-geo.com/en/23-sample-imagery
>> Optical Imagery->Pleiades->Pleiades Primary Product ? Bundle
>> You have to fill out the form and will then receive a download link via
>> email.
>>
>> The crash happens with the file
>> FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>>
>> And I have other JP2 Pleiades files where it happens too, so it?s not
>> related to this single file. Both ERDAS and ArcGIS are able to open the
>> file.
>>
>>  If it?s not possible to open the files with GDAL, an appropriate error
>> message instead of a crash would be good.
>> Thanks for looking into it.
>>  Cheers,
>> Dennis
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/ee533e1a/attachment.html>

From ao at t-kartor.se  Wed May 22 10:10:46 2013
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Wed, 22 May 2013 19:10:46 +0200
Subject: [gdal-dev] NetCDF grid mapping read issue
Message-ID: <519CFC16.7070804@t-kartor.se>

Dear list,

GRID cannot interpret (tested with 1.9 and 1.10) the coordinate systems 
in two different NetCDF files storing oceanographic/meteorological data.
But it can interpret the coordinates in a third NetCDF file.
PANOPLY, as available from http://www.giss.nasa.gov/tools/panoply/, can 
correctly display all files in lat-lon (4326).

NetCDF file where GDAL can interpret the coordinates:
https://dl.dropboxusercontent.com/u/13880880/metoffice_foam1_orca025_GLO_ASLV_b20120923_dm20120921.nc 
   (CF convention is 1.0)

NetCDF files where GDAL cannot interpret the coordinates:
https://dl.dropboxusercontent.com/u/13880880/metoffice_foam1_orca025_NTV_ASLV_b20110921_dm20110921.nc 
   (CF convention is 1.0)
http://thredds.met.no/thredds/fileServer/metno/proff4km/default/files/proffDefault4km_2013-04-25_00.nc 
(be warned: 1.2 Gb)    (CF convention is 1.4)

We have got this information from the Norwegian experts:
For PROFF data, the rotated lat/lon coordinates are defined so that each 
latitude and each longitude (and therefore each data point) correspond 
to elements in the rlat/rlon vectors.

The GeoTransform array mentioned in http://www.gdal.org/frmt_netcdf.html 
seems not to be used for these two files.

-- 
Best Regards

Andreas Oxenstierna
T-Kartan Produkt AB
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From even.rouault at mines-paris.org  Wed May 22 10:20:55 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 22 May 2013 19:20:55 +0200
Subject: [gdal-dev] Wrapping with SWIG
In-Reply-To: <1368776311385-5053886.post@n6.nabble.com>
References: <CACPKxk_KHkXdJxmubH2Vesein_dMTFxAnJdZAsAE8=j+0GSHzw@mail.gmail.com>
	<CACALY+RU=a+HLroXimBmFzbLKAU_WoEqp6noB65r1X6UW6n5Uw@mail.gmail.com>
	<1368776311385-5053886.post@n6.nabble.com>
Message-ID: <201305221920.55720.even.rouault@mines-paris.org>

Le vendredi 17 mai 2013 09:38:31, Hank Finley a ?crit :
> Hi Tamas,
> 
> thanks for the advice, I would still like to continue with my goal, down
> the track I'm going to be using this to fuel my OpenGL graphical map. The
> SQL API level was far too slow, so I am going to the C API level.
> 
> Is it possible to contact Even somehow?

Done now ;-)

I'm afraid that your goal - as far as I've understood it - is not achievable. 
You will have to use the SQLite API at some point since Spatialite is "no 
more" than a set of C functions (and triggers) that can do 
serialization/deserialization of geometry blobs, spatial operations, etc... 
But you have to access the SQLite database through the SQL SQLite API.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From warmerdam at pobox.com  Wed May 22 10:22:09 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 22 May 2013 10:22:09 -0700
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CA+YzLBf7A0o_rgDEqfB3-jtQ4iM81iBzTfY6j-=fFq=OtEq2rA@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
Message-ID: <CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>

Dennis,

Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I was
never really able to trace down the issues.  I would encourage you to
consider alternatives - one possibility is the MrSID SDK's JPEG2000
support.  If Tamas's build includes MrSID support then all you need to do
is set the GDAL_SKIP environment variable to JP2ECW which would make GDAL
skip the ECW based driver.   If Tamas hasn't built with MrSID then it falls
to you to build GDAL which can be somewhat complicated.

Best regards,
Frank



On Wed, May 22, 2013 at 9:42 AM, Dennis Gocke <dengo at gmx.net> wrote:

> I'm using the stable 1.10 build from Tamas' site.
>
> GDALIdentifyDriver on the file reports: "ERDAS JPEG2000 (SDK 3.x)"
>
> When trying to open the file I get an AccessViolationException.
>
> Cheers,
> Dennis
>
>
> On Wed, May 22, 2013 at 3:35 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:
>
>> Dennis,
>>
>> There are several jpeg2000 drivers potentially available for gdal.  Do
>> you know which you are using?
>>
>> Best regards,
>>  On May 22, 2013 5:20 AM, "Dennis Gocke" <dengo at gmx.net> wrote:
>>
>>> Hi,
>>>
>>>  I?ve encountered a problem with Pleiades JP2 files from Astrium, GDAL
>>> crashes when opening the file.
>>>
>>> You should be able to reproduce the the crash by downloading a sample
>>> dataset from their page.
>>>
>>> http://www.astrium-geo.com/en/23-sample-imagery
>>> Optical Imagery->Pleiades->Pleiades Primary Product ? Bundle
>>> You have to fill out the form and will then receive a download link via
>>> email.
>>>
>>> The crash happens with the file
>>> FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>>>
>>> And I have other JP2 Pleiades files where it happens too, so it?s not
>>> related to this single file. Both ERDAS and ArcGIS are able to open the
>>> file.
>>>
>>>  If it?s not possible to open the files with GDAL, an appropriate error
>>> message instead of a crash would be good.
>>> Thanks for looking into it.
>>>  Cheers,
>>> Dennis
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/2e589079/attachment.html>

From warmerdam at pobox.com  Wed May 22 10:24:24 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 22 May 2013 10:24:24 -0700
Subject: [gdal-dev] Motion: adopt RFC 40 - "Improving performance of
 Raster Attribute Table implementation for large tables"
In-Reply-To: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
References: <CAMH-RbaWMP6i3Zdqeiu5nhBMKb=UcNVzDCTqG2HnkEH3YpT8LA@mail.gmail.com>
Message-ID: <CA+YzLBcu6HOfnLQyW3y03qLvcX_sOWHCxv+B=5es6=4Edz0U1g@mail.gmail.com>

Folks,

I declare this motion passed with PSC support from Frank, Even and Howard.

Sam,  you can update the wiki to show this RFC as adopted and proceed in
trunk.  Thanks for pursuing this and also for working gracefully through
our process. :-)

Best regards,
Frank



On Sat, May 18, 2013 at 3:27 PM, Sam Gillingham <gillingham.sam at gmail.com>wrote:

> Dear PSC members,
>
> I propose a motion to get RFC 40 - "Improving performance of Raster
> Attribute Table implementation for large tables" formally adopted.
>
> This adds some new functionality for GDAL 2.0. Even, Frank and others have
> made suggestions and these have been incorporated into the RFC:
> http://trac.osgeo.org/gdal/wiki/rfc40_enhanced_rat_support
>
> I'll start with a:
>
> +1 from me
>
>
> Thanks,
> Sam.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/ac9af4a7/attachment-0001.html>

From kyle at pobox.com  Wed May 22 10:27:47 2013
From: kyle at pobox.com (Kyle Shannon)
Date: Wed, 22 May 2013 11:27:47 -0600
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CA+YzLBf7A0o_rgDEqfB3-jtQ4iM81iBzTfY6j-=fFq=OtEq2rA@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
Message-ID: <CAJ0mEz1yiRT3MUKqaVRF-Ptc1vCtzDuDasgv_go+pn212i_vZA@mail.gmail.com>

Dennis,
I believe you can use Even's GDAL API Proxy to avoid crashes in third
party libraries.  See:

http://trac.osgeo.org/gdal/ticket/4979

for more info.

kss

On Wed, May 22, 2013 at 11:22 AM, Frank Warmerdam <warmerdam at pobox.com> wrote:
> Dennis,
>
> Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I was
> never really able to trace down the issues.  I would encourage you to
> consider alternatives - one possibility is the MrSID SDK's JPEG2000 support.
> If Tamas's build includes MrSID support then all you need to do is set the
> GDAL_SKIP environment variable to JP2ECW which would make GDAL skip the ECW
> based driver.   If Tamas hasn't built with MrSID then it falls to you to
> build GDAL which can be somewhat complicated.
>
> Best regards,
> Frank
>
>
>
> On Wed, May 22, 2013 at 9:42 AM, Dennis Gocke <dengo at gmx.net> wrote:
>>
>> I'm using the stable 1.10 build from Tamas' site.
>>
>> GDALIdentifyDriver on the file reports: "ERDAS JPEG2000 (SDK 3.x)"
>>
>> When trying to open the file I get an AccessViolationException.
>>
>> Cheers,
>> Dennis
>>
>>
>> On Wed, May 22, 2013 at 3:35 PM, Frank Warmerdam <warmerdam at pobox.com>
>> wrote:
>>>
>>> Dennis,
>>>
>>> There are several jpeg2000 drivers potentially available for gdal.  Do
>>> you know which you are using?
>>>
>>> Best regards,
>>>
>>> On May 22, 2013 5:20 AM, "Dennis Gocke" <dengo at gmx.net> wrote:
>>>>
>>>> Hi,
>>>>
>>>> I?ve encountered a problem with Pleiades JP2 files from Astrium, GDAL
>>>> crashes when opening the file.
>>>>
>>>> You should be able to reproduce the the crash by downloading a sample
>>>> dataset from their page.
>>>>
>>>> http://www.astrium-geo.com/en/23-sample-imagery
>>>>
>>>> Optical Imagery->Pleiades->Pleiades Primary Product ? Bundle
>>>> You have to fill out the form and will then receive a download link via
>>>> email.
>>>>
>>>> The crash happens with the file
>>>> FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>>>>
>>>> And I have other JP2 Pleiades files where it happens too, so it?s not
>>>> related to this single file. Both ERDAS and ArcGIS are able to open the
>>>> file.
>>>>
>>>> If it?s not possible to open the files with GDAL, an appropriate error
>>>> message instead of a crash would be good.
>>>>
>>>> Thanks for looking into it.
>>>> Cheers,
>>>> Dennis
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
>
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at mines-paris.org  Wed May 22 10:46:22 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 22 May 2013 19:46:22 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
Message-ID: <201305221946.22339.even.rouault@mines-paris.org>

Le mercredi 22 mai 2013 19:22:09, Frank Warmerdam a ?crit :
> Dennis,
> 
> Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I was
> never really able to trace down the issues.  I would encourage you to
> consider alternatives - one possibility is the MrSID SDK's JPEG2000
> support.  If Tamas's build includes MrSID support then all you need to do
> is set the GDAL_SKIP environment variable to JP2ECW which would make GDAL
> skip the ECW based driver.   If Tamas hasn't built with MrSID then it falls
> to you to build GDAL which can be somewhat complicated.

I can replicate the crash with the JP2ECW driver with ECW SDK 3.3. It occurs 
actually in the SDK itself, not in GDAL, so nothing that we can really do 
about that (except using GDAL API Proxy, see below). Newer versions of the SDK 
don't produce this crash.

Frank's above suggestions are the way to go. Tamas' builds do include MrSID 
support as a plugin (XXXX-mrsid.msi packages). But they also include the 
OpenJPEG driver, which can successfully open this file and should be the next 
driver used after skipping JP2ECW :

$ gdalinfo --config GDAL_SKIP JP2ECW 
IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2

Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
Files: IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
        IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2.aux.xml
Size is 10000, 6191
Coordinate System is `'
GeoTransform =
  144.8407819720184, 2.303727068124578e-05, -3.011809327220197e-09
  -37.76248166104331, -9.154071614724073e-09, -1.808332187648097e-05
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  ( 144.8407820, -37.7624817) 
Lower Left  ( 144.8407633, -37.8744355) 
Upper Right ( 145.0711547, -37.7625732) 
Lower Right ( 145.0711360, -37.8745270) 
Center      ( 144.9559590, -37.8185044) 
Band 1 Block=2048x2048 Type=UInt16, ColorInterp=Red
  Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=12
Band 2 Block=2048x2048 Type=UInt16, ColorInterp=Green
  Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=12
Band 3 Block=2048x2048 Type=UInt16, ColorInterp=Blue
  Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=12
Band 4 Block=2048x2048 Type=UInt16, ColorInterp=Alpha
  Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
  Overviews: arbitrary
  Image Structure Metadata:
    NBITS=12

If you want to use the JP2MrSID driver, you need to set --config GDAL_SKIP 
"JP2ECW JPEG2000 JP2OPENJPEG"

> Dennis,
> I believe you can use Even's GDAL API Proxy to avoid crashes in third
>party libraries.  See:
> http://trac.osgeo.org/gdal/ticket/4979

Indeed, 

$ gdalinfo  --config GDAL_API_PROXY YES 
IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
ERROR 1: Read from pipe failed
gdalinfo failed - unable to open 
'/home/even/gdal/data/jpeg2000/FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2'.

But that's only band-aid and you need to use another driver in order to open 
the file successfully

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed May 22 10:54:00 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 22 May 2013 19:54:00 +0200
Subject: [gdal-dev] Regarding missing stylestring in SQLITE Driver
In-Reply-To: <loom.20130522T160519-361@post.gmane.org>
References: <1369215744244-5054868.post@n6.nabble.com>
	<loom.20130522T160519-361@post.gmane.org>
Message-ID: <201305221954.00632.even.rouault@mines-paris.org>

Le mercredi 22 mai 2013 16:11:30, Jukka Rahkonen a ?crit :
> Abhinav <abhinav <at> vizexperts.com> writes:
> > Hi All,
> > 
> > I am using sqlite driver to write the OGRLayer to disk. I am setting
> > StyleString for each feature. But when I read back, my feature contains
> > NULL stylestring.  Though I am able to get other attributes, I am
> > setting to the feature.
> > 
> > I wonder whether sqlite driver supports writing style string or not? If
> > It allows, do we have to give any option to enable writing of the style
> > ?
> 
> Hi,
> 
> Please tell us how you tried to do your task. Here is what I did in my
> quick test.
> 
> 
> Step 1: Set OGR style with SQL and write features with styles into
> Spatialite db.
> 
> ogr2ogr -f SQLite -dsco spatialite=yes styletest.sqlite finland.osm.pbf
> -sql "select highway, ref, 'SYMBOL(id:bus_stop.png)' as OGR_STYLE from
> points where highway='bus_stop'"

Abhinav,

Jukka's suggestion to set a OGR_STYLE attribute is actually what you can do to 
have styles written in a sqlite database. The SetStyleString() API is 
supported directly by very few formats (only MapInfo comes to mind). For other 
cases, using the special OGR_STYLE attribute is the only way to go.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From thomasc at mirageoscience.com  Wed May 22 11:42:54 2013
From: thomasc at mirageoscience.com (Thomas Campagne)
Date: Wed, 22 May 2013 18:42:54 +0000
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift
 file when using EPSG codes?
In-Reply-To: <kn5ovm$l09$1@ger.gmane.org>
References: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>
	<5196405B.5060900@gmx.eu>
	<0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>
	<kn5ovm$l09$1@ger.gmane.org>
Message-ID: <0A52D2F3069984439507D303D0CB4FCF4D651E5F@MBX201.domain.local>

Thanks Andr?!

I will add a line for AGD66 datum and nadgrid file in pj_datums.c, and make the appropriate change in the epsg file , and compile from source. 

Is possible to default to the use of +towgs84 when there is no successful grids with +nadgrids?

For New-Zealand the line in pj_datums.c is:
"nzgd49",	"nadgrids=nzgd2kgrid0005.gsb", 	"intl",	 "New Zealand Geodetic Datum 1949"
And the epsg file contains:
# NZGD49
<4272> +proj=longlat +datum=nzgd49 +no_defs  <>

Could the following work if points are not located within the area covered by the NTv2 file?

pj_datums.c contains:
"nzgd49",	" nadgrids=@nzgd2kgrid0005.gsb ", 	"intl", "New Zealand Geodetic Datum 1949"
And the epsg file contains:
# NZGD49
<4272> +proj=longlat +datum=nzgd49 + towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993 +no_defs  <>



-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Andre Joost
Sent: May-17-13 10:21 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift file when using EPSG codes?

Am 17.05.2013 19:00, schrieb Thomas Campagne:

> When I run cs2cs -v +init=epsg:4267 I still do not understand how the
> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat parameter is being
> generated as I cannot find it within the text/csv files.
>

EPSG:4267 expands to
+proj=longlat +datum=NAD27 +no_defs

and the nadgrids are in the "+datum=NAD27". This is hardcoded in <http://trac.osgeo.org/proj/browser/trunk/proj/src/pj_datums.c>
> "NAD27",    "nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat",
> 	                                                     "clrk66",
> 	                                "North_American_Datum_1927",


> Any idea about which files to edit to add the nadgrids parameter to 
> the proj string referenced by a given EPSG code (4202 for AGD66 as 
> example)?


You could add a line for AGD66 datum and nadgrid file in the file, and compile from source. And you have to change the share/proj/epsg file to use your datum istead of +towgs84.

Or try to insert the +nadgrids=<filename> for the AGD66 entry directly.

HTH,
Andr? Joost


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From etourigny.dev at gmail.com  Wed May 22 11:45:04 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Wed, 22 May 2013 15:45:04 -0300
Subject: [gdal-dev] NetCDF grid mapping read issue
In-Reply-To: <519CFC16.7070804@t-kartor.se>
References: <519CFC16.7070804@t-kartor.se>
Message-ID: <CA+TxYvOT_fbUUGxVdqw3dzKdwPJNKMu1W7hMMvrex8FMZrZSkg@mail.gmail.com>

On Wed, May 22, 2013 at 2:10 PM, Andreas Oxenstierna <ao at t-kartor.se> wrote:

> Dear list,
>
> GRID cannot interpret (tested with 1.9 and 1.10) the coordinate systems in
> two different NetCDF files storing oceanographic/meteorological data.
> But it can interpret the coordinates in a third NetCDF file.
> PANOPLY, as available from http://www.giss.nasa.gov/**tools/panoply/<http://www.giss.nasa.gov/tools/panoply/>,
> can correctly display all files in lat-lon (4326).
>
> NetCDF file where GDAL can interpret the coordinates:
> https://dl.dropboxusercontent.**com/u/13880880/metoffice_**
> foam1_orca025_GLO_ASLV_**b20120923_dm20120921.nc<https://dl.dropboxusercontent.com/u/13880880/metoffice_foam1_orca025_GLO_ASLV_b20120923_dm20120921.nc>  (CF convention is 1.0)
>
> NetCDF files where GDAL cannot interpret the coordinates:
> https://dl.dropboxusercontent.**com/u/13880880/metoffice_**
> foam1_orca025_NTV_ASLV_**b20110921_dm20110921.nc<https://dl.dropboxusercontent.com/u/13880880/metoffice_foam1_orca025_NTV_ASLV_b20110921_dm20110921.nc>  (CF convention is 1.0)
> http://thredds.met.no/thredds/**fileServer/metno/proff4km/**
> default/files/proffDefault4km_**2013-04-25_00.nc<http://thredds.met.no/thredds/fileServer/metno/proff4km/default/files/proffDefault4km_2013-04-25_00.nc>(be warned: 1.2 Gb)    (CF convention is 1.4)
>
> We have got this information from the Norwegian experts:
> For PROFF data, the rotated lat/lon coordinates are defined so that each
> latitude and each longitude (and therefore each data point) correspond to
> elements in the rlat/rlon vectors.
>

rotated pole is not supported, sorry.

If the driver supported the netcdf-cf coordinates attribute (see Netcdf CF
1.6 section 5.2) these 2 problems would be solved...

There is a mention of this in the netcdf improvement wiki at
http://trac.osgeo.org/gdal/wiki/NetCDF_Improvements

Please add this information to the following ticket
http://trac.osgeo.org/gdal/ticket/4285

regards,
Etienne



>
> The GeoTransform array mentioned in http://www.gdal.org/frmt_**netcdf.html<http://www.gdal.org/frmt_netcdf.html>seems not to be used for these two files.
>
> --
> Best Regards
>
> Andreas Oxenstierna
> T-Kartan Produkt AB
> mobile: +46 733 206831
> mailto: ao at t-kartor.se
> http://www.t-kartor.com
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/53c71804/attachment.html>

From warmerdam at pobox.com  Wed May 22 14:27:03 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed, 22 May 2013 14:27:03 -0700
Subject: [gdal-dev] *.ENC Files
In-Reply-To: <1369222647047-5054893.post@n6.nabble.com>
References: <1369206212138-5054808.post@n6.nabble.com>
	<041001ce56c6$6041a030$20c4e090$@fr>
	<1369222647047-5054893.post@n6.nabble.com>
Message-ID: <CA+YzLBcwKk8S3j=QsxLtxuC-bByBwJjPRHrdtZQe=1_Oab39wA@mail.gmail.com>

Kiruna,

I am not familiar with the enc extension.  Can you make one available?

Best regards,
 On May 22, 2013 6:38 AM, "Kiruba" <kkirubanantham at yahoo.com> wrote:

> HI Mathieu,
>
> I am unable to file extension as *.ENC anywhere. Every place S57 files are
> mentioned with *.000 extension. In fact the application i have referred
> (SeeMyEnc) above is downloaded from that page only.
>
> Anyway Thanks for your reply.
> Kiruba.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/ENC-Files-tp5054808p5054893.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130522/34c4c3c8/attachment.html>

From andre+joost at nurfuerspam.de  Wed May 22 21:40:22 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Thu, 23 May 2013 06:40:22 +0200
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift
 file when using EPSG codes?
In-Reply-To: <0A52D2F3069984439507D303D0CB4FCF4D651E5F@MBX201.domain.local>
References: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>
	<5196405B.5060900@gmx.eu>
	<0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>
	<kn5ovm$l09$1@ger.gmane.org>
	<0A52D2F3069984439507D303D0CB4FCF4D651E5F@MBX201.domain.local>
Message-ID: <knk6l1$br0$1@ger.gmane.org>

Am 22.05.2013 20:42, schrieb Thomas Campagne:
> Thanks Andr?!
>
> I will add a line for AGD66 datum and nadgrid file in pj_datums.c,
> and make the appropriate change in the epsg file , and compile from
> source.
>
> Is possible to default to the use of +towgs84 when there is no
> successful grids with +nadgrids?
>
> For New-Zealand the line in pj_datums.c is: "nzgd49",
> "nadgrids=nzgd2kgrid0005.gsb", 	"intl",	 "New Zealand Geodetic Datum
> 1949" And the epsg file contains: # NZGD49 <4272>  +proj=longlat
> +datum=nzgd49 +no_defs<>
>
> Could the following work if points are not located within the area
> covered by the NTv2 file?
>
> pj_datums.c contains: "nzgd49",	" nadgrids=@nzgd2kgrid0005.gsb ",
> "intl", "New Zealand Geodetic Datum 1949" And the epsg file
> contains: # NZGD49 <4272>  +proj=longlat +datum=nzgd49 +
> towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993 +no_defs<>
>

I have not yet tested such cases. You might try and report the result 
here ;-)

Greetings,
Andr? Joost




From Luke.Pinner at environment.gov.au  Thu May 23 00:18:44 2013
From: Luke.Pinner at environment.gov.au (Pinner, Luke)
Date: Thu, 23 May 2013 07:18:44 +0000
Subject: [gdal-dev] GDAL_API_PROXY and deregistering drivers (python/win32)
 [SEC=UNCLASSIFIED]
Message-ID: <08A7084C05C8C94A9EA11656A36D3EE17EF50F62@PVAC01EXMX01.internal.govt>

Greetings,

Following on from the GDAL 1.10 JP2000 Problem/Crash thread (http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-1-10-JP2000-Problem-Crash-td5054876.html), I'm trying to use the GDAL API Proxy and deregister the JP2ECW driver at runtime to avoid crashes with those Pleiades JP2s.  I'm stuck with the ERDAS ECW/JP2 v3.3 SDK at the moment due to the licensing of the v.4+ SDK and the need to support ECW on Linux.  However, deregistering fails when opening a dataset using the API Proxy.  Below is a simple test script that demonstrates this.

from osgeo import gdal
print gdal.__version__
gdal.UseExceptions()

f='img_phr1a_p_001/img_phr1a_p_201202250025599_sen_ipu_20120504_1737-002_r1c1.jp2'

gdal.AllRegister()

d=gdal.GetDriverByName('JP2ECW')
d.Deregister()
ds=gdal.Open(f)
print 'No PROXY:'+ds.GetDriver().GetDescription()
del ds;ds=None

gdal.AllRegister()

d=gdal.GetDriverByName('JP2ECW')
d.Deregister()
ds=gdal.Open('API_PROXY:'+f)
print 'API_PROXY:'+ds.GetDriver().GetDescription()
del ds;ds=None

This prints:
1.10.0
No PROXY:JP2OpenJPEG
API_PROXY:JP2ECW

I realise it's a bit of a dumb test, i.e. if gdal can open it, what's the problem...? But the crashes with this particular file are happening when running another operation after successfully opening the file. So what I was hoping to do was wrap a try: except: around the operation and if that fails, deregister the crappy (but much faster) ERDAS driver and fall back to the OpenJPEG driver.

Is there a workaround?

Regards,

Luke Pinner

If you have received this transmission in error please notify us immediately by return e-mail and delete all copies. If this e-mail or any attachments have been sent to you in error, that error does not constitute waiver of any confidentiality, privilege or copyright in respect of information in the e-mail or attachments.

Please consider the environment before printing this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130523/84ea768f/attachment.html>

From ijturton at gmail.com  Thu May 23 02:01:46 2013
From: ijturton at gmail.com (Ian Turton)
Date: Thu, 23 May 2013 10:01:46 +0100
Subject: [gdal-dev] Can I leave OGR_INTERLEAVED_READING=YES on all the time?
Message-ID: <CA+=cGJnavJsjLKn2ij_AkP0iFBsHXrt4auPv_p6dSg4ss6agZQ@mail.gmail.com>

I'm developing an application that wraps OGR for feature ingest which works
fine. With the new OSM driver all is good until a user tries to open a
large file which hangs unless OGR_INTERLEAVED_READING=YES is set (then all
is fine again).

However I don't really want users to have to decide if they have a large
file or not and then mess around with environment variables, so is there
any downside to setting this on in my code and leaving it on all the time?

if not what is the size break point at which I should turn it on?

cheers

Ian

-- 
Ian Turton
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130523/6df73c28/attachment.html>

From julien.malik at c-s.fr  Thu May 23 06:34:26 2013
From: julien.malik at c-s.fr (Julien Malik)
Date: Thu, 23 May 2013 15:34:26 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <201305221946.22339.even.rouault@mines-paris.org>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
Message-ID: <519E1AE2.8060007@c-s.fr>

Hello Even,

On 05/22/2013 07:46 PM, Even Rouault wrote:
>
> Frank's above suggestions are the way to go. Tamas' builds do include MrSID
> support as a plugin (XXXX-mrsid.msi packages). But they also include the
> OpenJPEG driver, which can successfully open this file and should be the next
> driver used after skipping JP2ECW :
>
> $ gdalinfo --config GDAL_SKIP JP2ECW
> IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2

Does this mean that in an ideal "free software only" setup, OpenJPEG is 
now the default driver (used before Jasper) ?

Thanks,
Julien


From dengo at gmx.net  Thu May 23 08:51:59 2013
From: dengo at gmx.net (Dennis Gocke)
Date: Thu, 23 May 2013 17:51:59 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <201305221946.22339.even.rouault@mines-paris.org>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
Message-ID: <CALqbEi7gy54xTAcAmsdZNMftWa+hzW-ymeS6fBF_uPM_LmSGbQ@mail.gmail.com>

Thanks guys for the info and advise.


I was able to skip the JP2ECW driver and successfully open the file with
the JP2OpenJPEG driver. But the driver is quite slow, in some cases up to
20x slower than the JP2ECW driver loading the same amount of pixels on a
raster where both drivers work. Skipping the JP2OpenJPEG driver leads do no
driver available for opening jp2, so Tamas? build seems to not include the
other drivers, e.g. JP2MrSID, which is strange, as I?m able to open *.sid
files!?!


It was mentioned that the newer ECW SDK does not have this problem, the
reason for not including it is licensing issues?

Cheers,
Dennis


On Wed, May 22, 2013 at 7:46 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

> Le mercredi 22 mai 2013 19:22:09, Frank Warmerdam a ?crit :
> > Dennis,
> >
> > Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I was
> > never really able to trace down the issues.  I would encourage you to
> > consider alternatives - one possibility is the MrSID SDK's JPEG2000
> > support.  If Tamas's build includes MrSID support then all you need to do
> > is set the GDAL_SKIP environment variable to JP2ECW which would make GDAL
> > skip the ECW based driver.   If Tamas hasn't built with MrSID then it
> falls
> > to you to build GDAL which can be somewhat complicated.
>
> I can replicate the crash with the JP2ECW driver with ECW SDK 3.3. It
> occurs
> actually in the SDK itself, not in GDAL, so nothing that we can really do
> about that (except using GDAL API Proxy, see below). Newer versions of the
> SDK
> don't produce this crash.
>
> Frank's above suggestions are the way to go. Tamas' builds do include MrSID
> support as a plugin (XXXX-mrsid.msi packages). But they also include the
> OpenJPEG driver, which can successfully open this file and should be the
> next
> driver used after skipping JP2ECW :
>
> $ gdalinfo --config GDAL_SKIP JP2ECW
> IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>
> Driver: JP2OpenJPEG/JPEG-2000 driver based on OpenJPEG library
> Files: IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
>         IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2.aux.xml
> Size is 10000, 6191
> Coordinate System is `'
> GeoTransform =
>   144.8407819720184, 2.303727068124578e-05, -3.011809327220197e-09
>   -37.76248166104331, -9.154071614724073e-09, -1.808332187648097e-05
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  ( 144.8407820, -37.7624817)
> Lower Left  ( 144.8407633, -37.8744355)
> Upper Right ( 145.0711547, -37.7625732)
> Lower Right ( 145.0711360, -37.8745270)
> Center      ( 144.9559590, -37.8185044)
> Band 1 Block=2048x2048 Type=UInt16, ColorInterp=Red
>   Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=12
> Band 2 Block=2048x2048 Type=UInt16, ColorInterp=Green
>   Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=12
> Band 3 Block=2048x2048 Type=UInt16, ColorInterp=Blue
>   Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=12
> Band 4 Block=2048x2048 Type=UInt16, ColorInterp=Alpha
>   Overviews: 5000x3095, 2500x1547, 1250x773, 625x386, 312x193
>   Overviews: arbitrary
>   Image Structure Metadata:
>     NBITS=12
>
> If you want to use the JP2MrSID driver, you need to set --config GDAL_SKIP
> "JP2ECW JPEG2000 JP2OPENJPEG"
>
> > Dennis,
> > I believe you can use Even's GDAL API Proxy to avoid crashes in third
> >party libraries.  See:
> > http://trac.osgeo.org/gdal/ticket/4979
>
> Indeed,
>
> $ gdalinfo  --config GDAL_API_PROXY YES
> IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
> ERROR 1: Read from pipe failed
> gdalinfo failed - unable to open
>
> '/home/even/gdal/data/jpeg2000/FCGC600031035/IMG_PHR1A_MS_002/IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2'.
>
> But that's only band-aid and you need to use another driver in order to
> open
> the file successfully
>
> Best regards,
>
> Even
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130523/09093b51/attachment-0001.html>

From jdaniel at usgs.gov  Thu May 23 09:07:53 2013
From: jdaniel at usgs.gov (John Daniel)
Date: Thu, 23 May 2013 11:07:53 -0500
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <201305221946.22339.even.rouault@mines-paris.org>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
Message-ID: <C4E523BC-6ACF-4449-A8EE-0B1AEE59712A@usgs.gov>

Even,
Is this crash specific to GDAL 1.10? We have been using the old ECW library for a couple of years with good success. It is a bit buggy. I never did get it running on Solaris. We are still on GDAL 1.9.2.

I have been worried about this old ECW library blocking us from future updates. We are testing Kakadu right now. If ECW has problems in GDAL 1.10, that would be important to know.

Are there any issues with Kakadu and GDAL 1.10? I'm worried about the way GDAL links directly to Kakadu object files instead of using the library.

Thanks

John Daniel
Software Engineer
Stinger Ghaffarian Technologies (SGT, Inc.)
Contractor to the U.S. Geological Survey (USGS)
Earth Resources Observation and Science (EROS) Center
47914 252nd Street
Sioux Falls, South Dakota 57198
Phone: 905.240.2953
Mobile: 905.442.9385
Skype: 303.586.1987
Email: jdaniel at usgs.gov

On May 22, 2013, at 12:46 PM, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le mercredi 22 mai 2013 19:22:09, Frank Warmerdam a ?crit :
>> Dennis,
>> 
>> Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I was
>> never really able to trace down the issues.  I would encourage you to
>> consider alternatives - one possibility is the MrSID SDK's JPEG2000
>> support.  If Tamas's build includes MrSID support then all you need to do
>> is set the GDAL_SKIP environment variable to JP2ECW which would make GDAL
>> skip the ECW based driver.   If Tamas hasn't built with MrSID then it falls
>> to you to build GDAL which can be somewhat complicated.
> 
> I can replicate the crash with the JP2ECW driver with ECW SDK 3.3. It occurs 
> actually in the SDK itself, not in GDAL, so nothing that we can really do 
> about that (except using GDAL API Proxy, see below). Newer versions of the SDK 
> don't produce this crash.


From warmerdam at pobox.com  Thu May 23 10:37:33 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu, 23 May 2013 10:37:33 -0700
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <C4E523BC-6ACF-4449-A8EE-0B1AEE59712A@usgs.gov>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
	<C4E523BC-6ACF-4449-A8EE-0B1AEE59712A@usgs.gov>
Message-ID: <CA+YzLBfAdANgs68HRh_2kA3k67_5dq1cKNQ6ySTLfFueunSofA@mail.gmail.com>

On Thu, May 23, 2013 at 9:07 AM, John Daniel <jdaniel at usgs.gov> wrote:

> Even,
> Is this crash specific to GDAL 1.10? We have been using the old ECW
> library for a couple of years with good success. It is a bit buggy. I never
> did get it running on Solaris. We are still on GDAL 1.9.2.
>

John,

In my experience the crashes with the ECW 3.3 library are not specific to
recent versions of GDAL.  I've run into them over the years.


>
> I have been worried about this old ECW library blocking us from future
> updates. We are testing Kakadu right now. If ECW has problems in GDAL 1.10,
> that would be important to know.
>
> Are there any issues with Kakadu and GDAL 1.10? I'm worried about the way
> GDAL links directly to Kakadu object files instead of using the library.
>

I am not aware of any problems with Kakadu and GDAL 1.10.  If you run into
something i'd be interested in fixing it.

Why does the direct use of the app directory object files concern you?  I
can't recall exactly why it is setup that way.  It seems to me I once tried
to use the library for the apps area but it was missing something I needed.
 It seems the current arrangement is just a bit ackward but hopefully not a
serious barrier for Kakadu licensees.

Best regards,
Frank


 even.rouault at mines-paris.org <even.rouault at mines-paris.org>> wrote:

>
> > Le mercredi 22 mai 2013 19:22:09, Frank Warmerdam a ?crit :
> >> Dennis,
> >>
> >> Ah.  In my experience the ECW SDK 3.3 JPEG2000 support is buggy and I
> was
> >> never really able to trace down the issues.  I would encourage you to
> >> consider alternatives - one possibility is the MrSID SDK's JPEG2000
> >> support.  If Tamas's build includes MrSID support then all you need to
> do
> >> is set the GDAL_SKIP environment variable to JP2ECW which would make
> GDAL
> >> skip the ECW based driver.   If Tamas hasn't built with MrSID then it
> falls
> >> to you to build GDAL which can be somewhat complicated.
> >
> > I can replicate the crash with the JP2ECW driver with ECW SDK 3.3. It
> occurs
> > actually in the SDK itself, not in GDAL, so nothing that we can really do
> > about that (except using GDAL API Proxy, see below). Newer versions of
> the SDK
> > don't produce this crash.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130523/07c6292a/attachment.html>

From even.rouault at mines-paris.org  Thu May 23 10:51:27 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 23 May 2013 19:51:27 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <519E1AE2.8060007@c-s.fr>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
	<519E1AE2.8060007@c-s.fr>
Message-ID: <201305231951.28131.even.rouault@mines-paris.org>

Le jeudi 23 mai 2013 15:34:26, Julien Malik a ?crit :
> Hello Even,
> 
> On 05/22/2013 07:46 PM, Even Rouault wrote:
> > Frank's above suggestions are the way to go. Tamas' builds do include
> > MrSID support as a plugin (XXXX-mrsid.msi packages). But they also
> > include the OpenJPEG driver, which can successfully open this file and
> > should be the next driver used after skipping JP2ECW :
> > 
> > $ gdalinfo --config GDAL_SKIP JP2ECW
> > IMG_PHR1A_MS_201202250025599_SEN_PRG_FC_5847-002_R1C1.JP2
> 
> Does this mean that in an ideal "free software only" setup, OpenJPEG is
> now the default driver (used before Jasper) ?

This is not really new. The openjpeg driver has always been registered before 
the jasper one.

> 
> Thanks,
> Julien

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu May 23 10:57:31 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 23 May 2013 19:57:31 +0200
Subject: [gdal-dev] Can I leave OGR_INTERLEAVED_READING=YES on all the
	time?
In-Reply-To: <CA+=cGJnavJsjLKn2ij_AkP0iFBsHXrt4auPv_p6dSg4ss6agZQ@mail.gmail.com>
References: <CA+=cGJnavJsjLKn2ij_AkP0iFBsHXrt4auPv_p6dSg4ss6agZQ@mail.gmail.com>
Message-ID: <201305231957.32028.even.rouault@mines-paris.org>

Le jeudi 23 mai 2013 11:01:46, Ian Turton a ?crit :
> I'm developing an application that wraps OGR for feature ingest which works
> fine. With the new OSM driver all is good until a user tries to open a
> large file which hangs unless OGR_INTERLEAVED_READING=YES is set (then all
> is fine again).
> 
> However I don't really want users to have to decide if they have a large
> file or not and then mess around with environment variables, so is there
> any downside to setting this on in my code and leaving it on all the time?

No, no downside at all. You can always set OGR_INTERLEAVED_READING=YES 
provided that you actually use the layer interleaved reading pattern 
documented in the OSM driver documentation page.

> 
> if not what is the size break point at which I should turn it on?

Standard access pattern works while the OSM layers don't store more than 
100,000 features each. Above that threshold, you must use the interleaved 
reading pattern.

> 
> cheers
> 
> Ian

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jdaniel at usgs.gov  Thu May 23 11:17:35 2013
From: jdaniel at usgs.gov (John Daniel)
Date: Thu, 23 May 2013 13:17:35 -0500
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <CA+YzLBfAdANgs68HRh_2kA3k67_5dq1cKNQ6ySTLfFueunSofA@mail.gmail.com>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
	<C4E523BC-6ACF-4449-A8EE-0B1AEE59712A@usgs.gov>
	<CA+YzLBfAdANgs68HRh_2kA3k67_5dq1cKNQ6ySTLfFueunSofA@mail.gmail.com>
Message-ID: <9A95FC2B-3377-49A6-B5C1-571B775C3310@usgs.gov>

On May 23, 2013, at 12:37 PM, Frank Warmerdam <warmerdam at pobox.com> wrote:

> John,
> 
> In my experience the crashes with the ECW 3.3 library are not specific to recent versions of GDAL.  I've run into them over the years. 

Frank,
I was just curious about potential future problems with GDAL 1.10. If ECW runs as well, or as poorly, as it does with GDAL 1.9.2, then I'm happy.

> Why does the direct use of the app directory object files concern you?  I can't recall exactly why it is setup that way.  It seems to me I once tried to use the library for the apps area but it was missing something I needed.  It seems the current arrangement is just a bit ackward but hopefully not a serious barrier for Kakadu licensees. 

Because changing the interface to the shared library is a big deal. Kakadu isn't going to do that without good reason and clear documentation on how to handle it. Our relatively recent Kakadu 7.1 library does just that and requires a minor patch to GDAL 1.9.2. However, Kakadu can change its internal code at any time and would be under no expectation to tell anyone or explain the changes.  

We are experiencing this exact problem with libXML. Our old version was using undocumented internals of libz. When the sysadmins updated libz for someone else's requirements, any application that used libXML, including GDAL, ceased to function. We still don't have all of our servers operational. We move slowly around here. 

We also had trouble building Kakadu so that its object files were compatible with GDAL. Now we also have a patch for Kakadu to add -fPIC for apps. 

I have no expectation that ECW 3.3 will continue to function in the future. It already doesn't work on our Solaris machines and needs patches for my Mac. Kakadu is well supported so I'm not worried about that. But I am a bit worried about direct linking to object files in a proprietary and very expensive library. There is potential for a future problem there.

John Daniel
Software Engineer
Stinger Ghaffarian Technologies (SGT, Inc.)
Contractor to the U.S. Geological Survey (USGS)
Earth Resources Observation and Science (EROS) Center
47914 252nd Street
Sioux Falls, South Dakota 57198
Phone: 905.240.2953
Mobile: 905.442.9385
Skype: 303.586.1987
Email: jdaniel at usgs.gov


> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130523/bc24147a/attachment-0001.html>

From even.rouault at mines-paris.org  Thu May 23 11:26:28 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 23 May 2013 20:26:28 +0200
Subject: [gdal-dev] GDAL_API_PROXY and deregistering drivers
	(python/win32) [SEC=UNCLASSIFIED]
In-Reply-To: <08A7084C05C8C94A9EA11656A36D3EE17EF50F62@PVAC01EXMX01.internal.govt>
References: <08A7084C05C8C94A9EA11656A36D3EE17EF50F62@PVAC01EXMX01.internal.govt>
Message-ID: <201305232026.28261.even.rouault@mines-paris.org>

Le jeudi 23 mai 2013 09:18:44, Pinner, Luke a ?crit :
> Greetings,
> 
> Following on from the GDAL 1.10 JP2000 Problem/Crash thread
> (http://osgeo-org.1560.x6.nabble.com/gdal-dev-GDAL-1-10-JP2000-Problem-Cra
> sh-td5054876.html), I'm trying to use the GDAL API Proxy and deregister the
> JP2ECW driver at runtime to avoid crashes with those Pleiades JP2s.  I'm
> stuck with the ERDAS ECW/JP2 v3.3 SDK at the moment due to the licensing
> of the v.4+ SDK and the need to support ECW on Linux.  However,
> deregistering fails when opening a dataset using the API Proxy.  Below is
> a simple test script that demonstrates this.
> 
> from osgeo import gdal
> print gdal.__version__
> gdal.UseExceptions()
> 
> f='img_phr1a_p_001/img_phr1a_p_201202250025599_sen_ipu_20120504_1737-002_r1
> c1.jp2'
> 
> gdal.AllRegister()
> 
> d=gdal.GetDriverByName('JP2ECW')
> d.Deregister()
> ds=gdal.Open(f)
> print 'No PROXY:'+ds.GetDriver().GetDescription()
> del ds;ds=None
> 
> gdal.AllRegister()
> 
> d=gdal.GetDriverByName('JP2ECW')
> d.Deregister()
> ds=gdal.Open('API_PROXY:'+f)
> print 'API_PROXY:'+ds.GetDriver().GetDescription()
> del ds;ds=None
> 
> This prints:
> 1.10.0
> No PROXY:JP2OpenJPEG
> API_PROXY:JP2ECW
> 

On which OS did you run the above test ? On Linux (and provided that 
GDAL_API_PROXY_SERVER is not set to YES or gdalserver) , I get JP2OpenJPEG on 
both cases. However on Windows, I would get the same result as you.

The reason is that in the Linux case, the "server" is forked at the first use 
of it, and so it inherits the active drivers at that point. In your case, 
JP2ECW is deregistered so the forked process will not use it either.

On Windows, a new executable is launched (gdalserver) and its first step is to 
call GDALAllRegister(), which ignores any deregistering done on client side.

> I realise it's a bit of a dumb test, i.e. if gdal can open it, what's the
> problem...? But the crashes with this particular file are happening when
> running another operation after successfully opening the file. So what I
> was hoping to do was wrap a try: except: around the operation and if that
> fails, deregister the crappy (but much faster) ERDAS driver and fall back
> to the OpenJPEG driver.

Not sure to have completely followed you on this.
My understanding is that you would do :
- open the file in API_PROXY mode
- if that works (ds != None and possibly attempting to read 1 pixel since 
crashes also sometimes occur in I/O operations), use the dataset, or if you 
want to avoid client/server roundtrips, open it again in standard mode (so 
with JP2ECW)
- if that fails, deregister JP2ECW and open it as usual in standard mode (with 
JP2OpenJPEG) and re-register JP2ECW just after having opened the file, for the 
next files

I'm confident that you can do that with the current state of code.


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From Luke.Pinner at environment.gov.au  Thu May 23 17:16:12 2013
From: Luke.Pinner at environment.gov.au (Pinner, Luke)
Date: Fri, 24 May 2013 00:16:12 +0000
Subject: [gdal-dev] GDAL_API_PROXY and deregistering drivers
 (python/win32) [SEC=UNCLASSIFIED]
In-Reply-To: <201305232026.28261.even.rouault@mines-paris.org>
References: <08A7084C05C8C94A9EA11656A36D3EE17EF50F62@PVAC01EXMX01.internal.govt>
	<201305232026.28261.even.rouault@mines-paris.org>
Message-ID: <08A7084C05C8C94A9EA11656A36D3EE17EF520E0@PVAC01EXMX01.internal.govt>



 -----Original Message-----
> From: Even Rouault [mailto:even.rouault at mines-paris.org]
>
> On which OS did you run the above test ? On Linux (and provided that
> GDAL_API_PROXY_SERVER is not set to YES or gdalserver) , I get JP2OpenJPEG on
> both cases. However on Windows, I would get the same result as you.
>

Yes, it was Windows and no GDAL_API_PROXY_SERVER set.

> Not sure to have completely followed you on this.
> My understanding is that you would do :
> - open the file in API_PROXY mode
> - if that works (ds != None and possibly attempting to read 1 pixel since
> crashes also sometimes occur in I/O operations), use the dataset, or if you
> want to avoid client/server roundtrips, open it again in standard mode (so
> with JP2ECW)
> - if that fails, deregister JP2ECW and open it as usual in standard mode (with
> JP2OpenJPEG) and re-register JP2ECW just after having opened the file, for the
> next files
>
> I'm confident that you can do that with the current state of code.
>

Yes, it was an I/O operation that caused the crash. I've also had previous problems with the JP2MrSID driver with other datasets so was hoping to do something generic like the following snippet. The idea was to gracefully handle JP2s that might crash more than one driver and therefore the entire gdal process if opened/used in standard mode as you suggest.  Admittedly it's a bit of a corner case...

drivers=filter(None,[gdal.GetDriverByName(d) for d in ['JP2ECW','JP2KAK','JP2MrSID']])
for d in drivers+[None]:
    try:
        ds=gdal.Open('API_PROXY:'+f)  #Some jp2s crash on open
        result = do_some_operation(ds) #Some crash on I/O
        break
    except:
        if d:d.Deregister()#skip crashing driver

gdal.AllRegister() #Reset drivers

However, setting GDAL_SKIP seems to work so I'll use that instead.

drivers=filter(None,[gdal.GetDriverByName(d) for d in ['JP2ECW','JP2KAK','JP2MrSID']])
drivers=[d.ShortName for d in drivers]+[''] #Filter the list to only installed drivers
for d in drivers:
    try:
        ds=gdal.Open('API_PROXY:'+f) #Some jp2s crash on open
        result = do_some_operation(ds) #Some crash on I/O
        break
    except:
        os.environ['GDAL_SKIP']=d #skip crashing driver or reset env

Luke

If you have received this transmission in error please notify us immediately by return e-mail and delete all copies. If this e-mail or any attachments have been sent to you in error, that error does not constitute waiver of any confidentiality, privilege or copyright in respect of information in the e-mail or attachments.

Please consider the environment before printing this email.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/7f307789/attachment.html>

From julien.malik at c-s.fr  Fri May 24 03:04:32 2013
From: julien.malik at c-s.fr (Julien Malik)
Date: Fri, 24 May 2013 12:04:32 +0200
Subject: [gdal-dev] OGR VRT - affine transform ?
Message-ID: <519F3B30.3000403@c-s.fr>

Hello,

Is it possible to apply an on-the-fly affine transform to an OGR dataset 
with the help of VRT ?
Could not find any help or mailing list message about this...

The source of the issue is we want to display in QGIS a 
non-georeferenced raster with an associated GML mask, where the 
coordinates in the mask are in pixel indices, relative to the raster (X 
and Y coordinates are unsigned integers).
When loading those two layers as-is in QGis, the raster is correctly 
displayed (north up, south down) but the GML mask is inverted, with a 
symmetry around the Y axis (Y coordinates interpreted as south->north 
when Y increases). We would like the GML mask to be overlayed on the 
raster, so applying "f(Y)=-Y" on the coordinates would do the trick.
Any other idea to cope with this issue would be appreciated. We asked on 
qgis-users and still no luck.

Thanks in advance,
Julien



From jaak at nutiteq.com  Fri May 24 06:16:25 2013
From: jaak at nutiteq.com (Jaak Laineste (Nutiteq))
Date: Fri, 24 May 2013 16:16:25 +0300
Subject: [gdal-dev] Some OGR drivers do not work
In-Reply-To: <CA+YzLBd0QnBQMP9w7ZTjAjd1eVykbp5sHUpA-QbO72UP0Gd0vw@mail.gmail.com>
References: <4D7740AE-B6AC-491A-899D-046AE421B4FC@nutiteq.com>
	<CA+YzLBd0QnBQMP9w7ZTjAjd1eVykbp5sHUpA-QbO72UP0Gd0vw@mail.gmail.com>
Message-ID: <CAFqye3JUdCwwDHdHVNEh6wzCjkc0ujX6F7owpEkfogb98=Q53A@mail.gmail.com>

2013/5/20 Frank Warmerdam <warmerdam at pobox.com>

>
>
>
> On Mon, May 20, 2013 at 9:26 AM, Jaak Laineste (Nutiteq) <jaak at nutiteq.com
> > wrote:
>
>> Hello,
>>
>> I compiled GDAL 0.10 release for Android, with basic driver package. I
>> left cURL and other more complex dependencies for later. It works with
>> partial success:
>>
>> a) Snags during compiling:
>>  1. had to disable gif driver, as there was "undefined reference to
>> `GIFAbstractDataset::GetMetadataItem". I don't see any real use of that
>> anyway.
>>  2. from tif_open.c I removed lines 99 and 100 (asserts for 64bit types),
>> as they appear not to work on 32bit ARMv7 (they assert false). Would it be
>> safe enough? Interesting is that I did not have this problem with GDAL 0.9
>>
>
>  Jaak,
>
> When using a built-in libtiff build, libtiff uses the GDAL GIntBig and
> GUIntBig types for 64 bit integers.  So this failure means that the
> definitions for these types in gdal/port/cpl_port.h are not actually
> 64bits.  That looks like:
>
> #if defined(WIN32) && defined(_MSC_VER)
>
> #define VSI_LARGE_API_SUPPORTED
> typedef __int64          GIntBig;
> typedef unsigned __int64 GUIntBig;
>
> #elif HAVE_LONG_LONG
>
> typedef long long        GIntBig;
> typedef unsigned long long GUIntBig;
>
> #else
>
> typedef long             GIntBig;
> typedef unsigned long    GUIntBig;
>
> #endif
>
> What is an appropriate 64bit integer type on Android?  You are likely
> falling into the case that just uses long and unsigned long which is not
> great on a 32bit platform.
>
> Note that not getting this type right is likely behind some of the other
> failures you are seeing.
>

I now recompiled with #define HAVE_LONG_LONG 1 (manually added it to
cpl_config.h) and it seems to work now.

 3. Some other tweaks and changes as described in [1] to get also Swig Java
>> bindings working
>>
>> b) Runtime problems. Main problem is that some OGR drivers do not open
>> some of test files, even if ogr.GetDriver() reports them. See [2] for
>> reported the list. There is no any error message, and debugging this via
>> Android NDK would be a bit too much for me.
>>
>
> You could customize error handling to log to a file or some other suitable
> mechanism from gdal/port/cpl_error.cpp, and also turn on debug output.  For
> a logging error handler do this near the start of your program:
>
>   CPLSetConfigOption("CPL_LOG", "/tmp/your.log");
>   CPLPushErrorHandler(CPLLoggingErrorHandler);
>
> to enable debugging output do:
>
>   CPLSetConfigOption("CPL_DEBUG", "ON");
>
> I haven't used the logging error handler for a long time so it might be
> quirkly/broken/wrong.
>
>
I tried that now with mixed results. The file logger works with GDAL, but
not with OGR. So for this specific issue could not use it. But I managed to
hack at least error messages (stdout) to Android own logger, and got the
info what I needed:

1. esrigeojson file - opens ok, this has own parser I guess

2. KML and some other files - no error message, no open. I suspect same
problem as 5. below.

3. GML file:
ERROR 1: Unable to create Xerces C++ or Expat based GML reader, Xerces or
Expat support
-> should add Expat or Xerces, simple (in theory)

4. GPX file
ERROR 6: OGR/GPX driver has not been built with read support. Expat library
required
-> adding Expat should do it, simple

5. other geojson file - error:
 ERROR 4: Unable to open EPSG support file gcs.csv.

This last one brings me to two questions:

a) where can I define folder from where the EPSG support files are read
from? When I had similar problem with proj.4, then I did ugly hack (almost
hardcoded) to pj_open_lib.c, and there is PROJ_LIB variable, but I could
not find similar thing for GDAL. Android JNI does not provide easily
packaged files for C++, but that's another story.

b) how are gdal/osr and proj.4 related in general. If I compile gdal
without proj.4 then does OSR provide some kind of lite standalone
replacement for it?

Jaak
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/50dc865b/attachment.html>

From warmerdam at pobox.com  Fri May 24 06:35:02 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 24 May 2013 06:35:02 -0700
Subject: [gdal-dev] Some OGR drivers do not work
In-Reply-To: <CAFqye3JUdCwwDHdHVNEh6wzCjkc0ujX6F7owpEkfogb98=Q53A@mail.gmail.com>
References: <4D7740AE-B6AC-491A-899D-046AE421B4FC@nutiteq.com>
	<CA+YzLBd0QnBQMP9w7ZTjAjd1eVykbp5sHUpA-QbO72UP0Gd0vw@mail.gmail.com>
	<CAFqye3JUdCwwDHdHVNEh6wzCjkc0ujX6F7owpEkfogb98=Q53A@mail.gmail.com>
Message-ID: <CA+YzLBeiA+9jmwfduWujWnkQXmLnnJa0ML7vNLeKd=2uWY8CbA@mail.gmail.com>

On Fri, May 24, 2013 at 6:16 AM, Jaak Laineste (Nutiteq)
<jaak at nutiteq.com>wrote:

>
> Note that not getting this type right is likely behind some of the other
>> failures you are seeing.
>>
>
> I now recompiled with #define HAVE_LONG_LONG 1 (manually added it to
> cpl_config.h) and it seems to work now.
>

Excellent!


>  3. Some other tweaks and changes as described in [1] to get also Swig
>>> Java bindings working
>>>
>>> b) Runtime problems. Main problem is that some OGR drivers do not open
>>> some of test files, even if ogr.GetDriver() reports them. See [2] for
>>> reported the list. There is no any error message, and debugging this via
>>> Android NDK would be a bit too much for me.
>>>
>>
>> You could customize error handling to log to a file or some other
>> suitable mechanism from gdal/port/cpl_error.cpp, and also turn on debug
>> output.  For a logging error handler do this near the start of your program:
>>
>>   CPLSetConfigOption("CPL_LOG", "/tmp/your.log");
>>   CPLPushErrorHandler(CPLLoggingErrorHandler);
>>
>> to enable debugging output do:
>>
>>   CPLSetConfigOption("CPL_DEBUG", "ON");
>>
>> I haven't used the logging error handler for a long time so it might be
>> quirkly/broken/wrong.
>>
>>
> I tried that now with mixed results. The file logger works with GDAL, but
> not with OGR. So for this specific issue could not use it. But I managed to
> hack at least error messages (stdout) to Android own logger, and got the
> info what I needed:
>
> 1. esrigeojson file - opens ok, this has own parser I guess
>
> 2. KML and some other files - no error message, no open. I suspect same
> problem as 5. below.
>

I'm not sure why this is.


> 3. GML file:
> ERROR 1: Unable to create Xerces C++ or Expat based GML reader, Xerces or
> Expat support
> -> should add Expat or Xerces, simple (in theory)
>
> 4. GPX file
> ERROR 6: OGR/GPX driver has not been built with read support. Expat
> library required
> -> adding Expat should do it, simple
>
> 5. other geojson file - error:
>  ERROR 4: Unable to open EPSG support file gcs.csv.
>
This last one brings me to two questions:
>
> a) where can I define folder from where the EPSG support files are read
> from? When I had similar problem with proj.4, then I did ugly hack (almost
> hardcoded) to pj_open_lib.c, and there is PROJ_LIB variable, but I could
> not find similar thing for GDAL. Android JNI does not provide easily
> packaged files for C++, but that's another story.
>

The location to search for can be set various ways, but the easiest in code
is to call the following at startup.

CPLSetConfigOption("GDAL_DATA", "...");



> b) how are gdal/osr and proj.4 related in general. If I compile gdal
> without proj.4 then does OSR provide some kind of lite standalone
> replacement for it?
>
> Jaak
>

Without PROJ.4 there will be no support for coordinate system
transformations (ie. convert a point from lat/long to utm), but coordinate
system lookups for the purposes of reading and writing files is fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/6d9cc8b3/attachment-0001.html>

From warmerdam at pobox.com  Fri May 24 06:48:12 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 24 May 2013 06:48:12 -0700
Subject: [gdal-dev] OGR VRT - affine transform ?
In-Reply-To: <519F3B30.3000403@c-s.fr>
References: <519F3B30.3000403@c-s.fr>
Message-ID: <CA+YzLBc4G5-V9k+mNyeePjiqros9UwxohUfQyCHJF5TeuoL31A@mail.gmail.com>

Julien,

I am not aware of any existing way to do this.  I might be nice if an OGR
VRT could apply something like this on the fly, but that doesn't exist
currently.

Best regards,
Frank


On Fri, May 24, 2013 at 3:04 AM, Julien Malik <julien.malik at c-s.fr> wrote:

> Hello,
>
> Is it possible to apply an on-the-fly affine transform to an OGR dataset
> with the help of VRT ?
> Could not find any help or mailing list message about this...
>
> The source of the issue is we want to display in QGIS a non-georeferenced
> raster with an associated GML mask, where the coordinates in the mask are
> in pixel indices, relative to the raster (X and Y coordinates are unsigned
> integers).
> When loading those two layers as-is in QGis, the raster is correctly
> displayed (north up, south down) but the GML mask is inverted, with a
> symmetry around the Y axis (Y coordinates interpreted as south->north when
> Y increases). We would like the GML mask to be overlayed on the raster, so
> applying "f(Y)=-Y" on the coordinates would do the trick.
> Any other idea to cope with this issue would be appreciated. We asked on
> qgis-users and still no luck.
>
> Thanks in advance,
> Julien
>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/1f7c6bc8/attachment.html>

From julien.malik at c-s.fr  Fri May 24 06:58:03 2013
From: julien.malik at c-s.fr (Julien Malik)
Date: Fri, 24 May 2013 15:58:03 +0200
Subject: [gdal-dev] OGR VRT - affine transform ?
In-Reply-To: <CA+YzLBc4G5-V9k+mNyeePjiqros9UwxohUfQyCHJF5TeuoL31A@mail.gmail.com>
References: <519F3B30.3000403@c-s.fr>
	<CA+YzLBc4G5-V9k+mNyeePjiqros9UwxohUfQyCHJF5TeuoL31A@mail.gmail.com>
Message-ID: <519F71EB.8040003@c-s.fr>

OK, thanks a lot for the information.

Best regards,
Julien

On 05/24/2013 03:48 PM, Frank Warmerdam wrote:
> Julien,
>
> I am not aware of any existing way to do this.  I might be nice if an 
> OGR VRT could apply something like this on the fly, but that doesn't 
> exist currently.
>
> Best regards,
> Frank
>
>
> On Fri, May 24, 2013 at 3:04 AM, Julien Malik <julien.malik at c-s.fr 
> <mailto:julien.malik at c-s.fr>> wrote:
>
>     Hello,
>
>     Is it possible to apply an on-the-fly affine transform to an OGR
>     dataset with the help of VRT ?
>     Could not find any help or mailing list message about this...
>
>     The source of the issue is we want to display in QGIS a
>     non-georeferenced raster with an associated GML mask, where the
>     coordinates in the mask are in pixel indices, relative to the
>     raster (X and Y coordinates are unsigned integers).
>     When loading those two layers as-is in QGis, the raster is
>     correctly displayed (north up, south down) but the GML mask is
>     inverted, with a symmetry around the Y axis (Y coordinates
>     interpreted as south->north when Y increases). We would like the
>     GML mask to be overlayed on the raster, so applying "f(Y)=-Y" on
>     the coordinates would do the trick.
>     Any other idea to cope with this issue would be appreciated. We
>     asked on qgis-users and still no luck.
>
>     Thanks in advance,
>     Julien
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam at pobox.com <mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam 
> <http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Software Developer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/03fcbae1/attachment.html>

From jukka.rahkonen at mmmtike.fi  Fri May 24 08:02:54 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 24 May 2013 15:02:54 +0000 (UTC)
Subject: [gdal-dev] OGR VRT - affine transform ?
References: <519F3B30.3000403@c-s.fr>
	<CA+YzLBc4G5-V9k+mNyeePjiqros9UwxohUfQyCHJF5TeuoL31A@mail.gmail.com>
Message-ID: <loom.20130524T164555-358@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> 
> 
> Julien,
> I am not aware of any existing way to do this. ?I might be nice if an OGR
VRT could apply something like this on the fly, but that doesn't exist
currently.


I wonder if it could be done by using the Spatialite SQL dialect and
ScaleCoordinates or ReflectCoordinates
http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html#p15

This SQL is changing the sign of y-coordinates
select ScaleCoords(geometry,1,-1) from polygons limit 1

And a quick test:
Case 1
======

ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"
INFO: Open of `cities.shp'
      using driver `ESRI Shapefile' successful.
.....
OGRFeature(SELECT):0
  POINT (23.903381170918806 66.586845471705118)


Case 2
======
ogrinfo -ro cities.shp  -dialect SQLITE 
-sql "select ScaleCoords(GEOMETRY,1,-1)  from cities"
INFO: Open of `cities.shp'
      using driver `ESRI Shapefile' successful.
.....
OGRFeature(SELECT):0
  POINT (23.903381170918806 -66.586845471705118)

At least the query makes y coordinate negative but I am not sure if that was
the meaning.

-Jukka Rahkonen-




From jukka.rahkonen at mmmtike.fi  Fri May 24 08:39:08 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 24 May 2013 15:39:08 +0000 (UTC)
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
Message-ID: <loom.20130524T172841-56@post.gmane.org>

Hi,

This works with ogrinfo
ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"

I tried to make a VRT file which would do the same 

<OGRVRTDataSource>
<OGRVRTLayer name="cities">
<SrcDataSource>cities.shp</SrcDataSource>
<LayerSRS>WGS84</LayerSRS>
<SrcSQL>SELECT GEOMETRY from cities</SrcSQL>
</OGRVRTLayer>
</OGRVRTDataSource>

Now ogrinfo does not find geometries

ogrinfo cities.vrt
INFO: Open of `cities.vrt'
      using driver `VRT' successful.
1: citiesERROR 1: SQL Expression Parsing Error: syntax error
ERROR 1: SQL statement failed, or returned no layer result:
"SELECT GEOMETRY from cities"

This exact use case is not at all interesting but there would be quite nice
possibilities if Spatialite SQL queries could be fired from the VRT and all
this would be supported for on-the-fly conversions
http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html



-Jukka Rahkonen-


From pedrocostaarma at sapo.pt  Fri May 24 09:23:50 2013
From: pedrocostaarma at sapo.pt (Pedro Costa)
Date: Fri, 24 May 2013 17:23:50 +0100
Subject: [gdal-dev] select shapes in a folder by geometry type
Message-ID: <519F9416.5030802@sapo.pt>

Hi guys,

I'm trying  to make a script that converts 3d shapefiles to 2d.
I'm using the loop 'for...do'' and this command:

'ogr2ogr -f "ESRI Shapefile" -nlt POINT 2d_points/$shp $shp'

My problem is that i don't  know how to select only shapefiles of 
points, and next only polygons, and next only lines to put the right 
geometry in the command.
For example, i have tried the '-where "OGR_GEOMETRY='Point'"'  like that:

ogr2ogr -where "OGR_GEOMETRY='Point'" -f "ESRI Shapefile" -nlt POLYGON 
2d_poligonos/$shp $shp

But don't work because ogr converts shapefiles of polygons and lines 
into points!

Can anyone tell me how i can select  only shapefiles of points in a 
folder with many shapefiles of many geometry types?

Thanks

From eadam at co.lincoln.or.us  Fri May 24 09:44:19 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 24 May 2013 09:44:19 -0700
Subject: [gdal-dev] select shapes in a folder by geometry type
In-Reply-To: <519F9416.5030802@sapo.pt>
References: <519F9416.5030802@sapo.pt>
Message-ID: <CACqBkM_POLkofKjRD2CgCe6RxpTwfWgQT1PW89Bg8G4HAK1V1g@mail.gmail.com>

If you are using a recent version can you ignore geometry type and use
the -dim 2 switch?

-dim val:(starting with GDAL 1.10) Force the coordinate dimension to
val (valid values are 2 or 3). This affects both the layer geometry
type, and feature geometries.

Best Regards, Eli


On Fri, May 24, 2013 at 9:23 AM, Pedro Costa <pedrocostaarma at sapo.pt> wrote:
> Hi guys,
>
> I'm trying  to make a script that converts 3d shapefiles to 2d.
> I'm using the loop 'for...do'' and this command:
>
> 'ogr2ogr -f "ESRI Shapefile" -nlt POINT 2d_points/$shp $shp'
>
> My problem is that i don't  know how to select only shapefiles of points,
> and next only polygons, and next only lines to put the right geometry in the
> command.
> For example, i have tried the '-where "OGR_GEOMETRY='Point'"'  like that:
>
> ogr2ogr -where "OGR_GEOMETRY='Point'" -f "ESRI Shapefile" -nlt POLYGON
> 2d_poligonos/$shp $shp
>
> But don't work because ogr converts shapefiles of polygons and lines into
> points!
>
> Can anyone tell me how i can select  only shapefiles of points in a folder
> with many shapefiles of many geometry types?
>
> Thanks
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri May 24 09:46:48 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 24 May 2013 09:46:48 -0700
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
In-Reply-To: <loom.20130524T172841-56@post.gmane.org>
References: <loom.20130524T172841-56@post.gmane.org>
Message-ID: <CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>

Jukka,

Agreed!  The SrcSQL directive in the VRT should accept a dialect option.
 I'll try to do that this afternoon as we are "sprinting" here at FOSS4G NA
and this would be a nice sized feature to add.

Best regards,
Frank



On Fri, May 24, 2013 at 8:39 AM, Jukka Rahkonen
<jukka.rahkonen at mmmtike.fi>wrote:

> Hi,
>
> This works with ogrinfo
> ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"
>
> I tried to make a VRT file which would do the same
>
> <OGRVRTDataSource>
> <OGRVRTLayer name="cities">
> <SrcDataSource>cities.shp</SrcDataSource>
> <LayerSRS>WGS84</LayerSRS>
> <SrcSQL>SELECT GEOMETRY from cities</SrcSQL>
> </OGRVRTLayer>
> </OGRVRTDataSource>
>
> Now ogrinfo does not find geometries
>
> ogrinfo cities.vrt
> INFO: Open of `cities.vrt'
>       using driver `VRT' successful.
> 1: citiesERROR 1: SQL Expression Parsing Error: syntax error
> ERROR 1: SQL statement failed, or returned no layer result:
> "SELECT GEOMETRY from cities"
>
> This exact use case is not at all interesting but there would be quite nice
> possibilities if Spatialite SQL queries could be fired from the VRT and all
> this would be supported for on-the-fly conversions
> http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html
>
>
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/51424db7/attachment-0001.html>

From pedrocostaarma at sapo.pt  Fri May 24 10:03:29 2013
From: pedrocostaarma at sapo.pt (Pedro Costa)
Date: Fri, 24 May 2013 18:03:29 +0100
Subject: [gdal-dev] select shapes in a folder by geometry type
In-Reply-To: <CACqBkM_POLkofKjRD2CgCe6RxpTwfWgQT1PW89Bg8G4HAK1V1g@mail.gmail.com>
References: <519F9416.5030802@sapo.pt>
	<CACqBkM_POLkofKjRD2CgCe6RxpTwfWgQT1PW89Bg8G4HAK1V1g@mail.gmail.com>
Message-ID: <519F9D61.20704@sapo.pt>

Hi Eli,

Like that?[1]

[1] ogr2ogr -f "ESRI Shapefile" -dim 2 pontos_2d.shp ocup_ilegal.shp

With this command don't work. I'm using 1.9 version but the '-dim' 
option don't show up if i type  'ogr2ogr --long-usage'.


Em 24-05-2013 17:44, Eli Adam escreveu:
> If you are using a recent version can you ignore geometry type and use
> the -dim 2 switch?
>
> -dim val:(starting with GDAL 1.10) Force the coordinate dimension to
> val (valid values are 2 or 3). This affects both the layer geometry
> type, and feature geometries.
>
> Best Regards, Eli
>
>
> On Fri, May 24, 2013 at 9:23 AM, Pedro Costa <pedrocostaarma at sapo.pt> wrote:
>> Hi guys,
>>
>> I'm trying  to make a script that converts 3d shapefiles to 2d.
>> I'm using the loop 'for...do'' and this command:
>>
>> 'ogr2ogr -f "ESRI Shapefile" -nlt POINT 2d_points/$shp $shp'
>>
>> My problem is that i don't  know how to select only shapefiles of points,
>> and next only polygons, and next only lines to put the right geometry in the
>> command.
>> For example, i have tried the '-where "OGR_GEOMETRY='Point'"'  like that:
>>
>> ogr2ogr -where "OGR_GEOMETRY='Point'" -f "ESRI Shapefile" -nlt POLYGON
>> 2d_poligonos/$shp $shp
>>
>> But don't work because ogr converts shapefiles of polygons and lines into
>> points!
>>
>> Can anyone tell me how i can select  only shapefiles of points in a folder
>> with many shapefiles of many geometry types?
>>
>> Thanks
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Fri May 24 10:15:43 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 24 May 2013 10:15:43 -0700
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
In-Reply-To: <CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>
References: <loom.20130524T172841-56@post.gmane.org>
	<CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>
Message-ID: <CA+YzLBfFkjaJci94+PH66wWedAeR1RWsnGNU6+TrjupBgjyLYg@mail.gmail.com>

Jukka,

It turns out you can already assign a dialect.  I think it is roughly like:

  <SrcSQL dialect="sqlite">SELECT ...</SrcSQL>

It seems to be touched on it the docs for the OGR VRT driver as well.

Best regards,
Frank



On Fri, May 24, 2013 at 9:46 AM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Jukka,
>
> Agreed!  The SrcSQL directive in the VRT should accept a dialect option.
>  I'll try to do that this afternoon as we are "sprinting" here at FOSS4G NA
> and this would be a nice sized feature to add.
>
> Best regards,
> Frank
>
>
>
> On Fri, May 24, 2013 at 8:39 AM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi
> > wrote:
>
>> Hi,
>>
>> This works with ogrinfo
>> ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"
>>
>> I tried to make a VRT file which would do the same
>>
>> <OGRVRTDataSource>
>> <OGRVRTLayer name="cities">
>> <SrcDataSource>cities.shp</SrcDataSource>
>> <LayerSRS>WGS84</LayerSRS>
>> <SrcSQL>SELECT GEOMETRY from cities</SrcSQL>
>> </OGRVRTLayer>
>> </OGRVRTDataSource>
>>
>> Now ogrinfo does not find geometries
>>
>> ogrinfo cities.vrt
>> INFO: Open of `cities.vrt'
>>       using driver `VRT' successful.
>> 1: citiesERROR 1: SQL Expression Parsing Error: syntax error
>> ERROR 1: SQL statement failed, or returned no layer result:
>> "SELECT GEOMETRY from cities"
>>
>> This exact use case is not at all interesting but there would be quite
>> nice
>> possibilities if Spatialite SQL queries could be fired from the VRT and
>> all
>> this would be supported for on-the-fly conversions
>> http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html
>>
>>
>>
>> -Jukka Rahkonen-
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/5e3d0b45/attachment.html>

From eadam at co.lincoln.or.us  Fri May 24 10:19:17 2013
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 24 May 2013 10:19:17 -0700
Subject: [gdal-dev] select shapes in a folder by geometry type
In-Reply-To: <519F9D61.20704@sapo.pt>
References: <519F9416.5030802@sapo.pt>
	<CACqBkM_POLkofKjRD2CgCe6RxpTwfWgQT1PW89Bg8G4HAK1V1g@mail.gmail.com>
	<519F9D61.20704@sapo.pt>
Message-ID: <CACqBkM_sWOSkaP8y08Ueb5c24ex5DXHUwCRHtYHb2aHLN+OUJA@mail.gmail.com>

> [1] ogr2ogr -f "ESRI Shapefile" -dim 2 pontos_2d.shp ocup_ilegal.shp

Yes just like this.

>
> With this command don't work. I'm using 1.9 version but the '-dim' option
> don't show up if i type  'ogr2ogr --long-usage'.

It is only in GDAL 1.10+ so it will not work in 1.9.

Eli

>
>
> Em 24-05-2013 17:44, Eli Adam escreveu:
>
>> If you are using a recent version can you ignore geometry type and use
>> the -dim 2 switch?
>>
>> -dim val:(starting with GDAL 1.10) Force the coordinate dimension to
>> val (valid values are 2 or 3). This affects both the layer geometry
>> type, and feature geometries.
>>
>> Best Regards, Eli
>>
>>
>> On Fri, May 24, 2013 at 9:23 AM, Pedro Costa <pedrocostaarma at sapo.pt>
>> wrote:
>>>
>>> Hi guys,
>>>
>>> I'm trying  to make a script that converts 3d shapefiles to 2d.
>>> I'm using the loop 'for...do'' and this command:
>>>
>>> 'ogr2ogr -f "ESRI Shapefile" -nlt POINT 2d_points/$shp $shp'
>>>
>>> My problem is that i don't  know how to select only shapefiles of points,
>>> and next only polygons, and next only lines to put the right geometry in
>>> the
>>> command.
>>> For example, i have tried the '-where "OGR_GEOMETRY='Point'"'  like that:
>>>
>>> ogr2ogr -where "OGR_GEOMETRY='Point'" -f "ESRI Shapefile" -nlt POLYGON
>>> 2d_poligonos/$shp $shp
>>>
>>> But don't work because ogr converts shapefiles of polygons and lines into
>>> points!
>>>
>>> Can anyone tell me how i can select  only shapefiles of points in a
>>> folder
>>> with many shapefiles of many geometry types?
>>>
>>> Thanks
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at mmmtike.fi  Fri May 24 10:37:13 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 24 May 2013 17:37:13 +0000 (UTC)
Subject: [gdal-dev] OGR VRT - affine transform ?
References: <519F3B30.3000403@c-s.fr>
	<CA+YzLBc4G5-V9k+mNyeePjiqros9UwxohUfQyCHJF5TeuoL31A@mail.gmail.com>
	<loom.20130524T164555-358@post.gmane.org>
Message-ID: <loom.20130524T192934-502@post.gmane.org>

Jukka Rahkonen <jukka.rahkonen <at> mmmtike.fi> writes:


> 
> I wonder if it could be done by using the Spatialite SQL dialect and
> ScaleCoordinates or ReflectCoordinates
> http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html#p15
> 
> This SQL is changing the sign of y-coordinates
> select ScaleCoords(geometry,1,-1) from polygons limit 1

Frank Warmerdam in another thread just wrote that SQL dialect can be
selected in VRT and thus this might work for changing the sign of y
coordinate of the GML source data

<OGRVRTDataSource>
<OGRVRTLayer name="negative_y">
<SrcDataSource>antarctis.gml</SrcDataSource>
<LayerSRS>WGS84</LayerSRS>
<SrcSQL dialect="sqlite">SELECT ScaleCoords(geometry,1,-1) from
antarctis</SrcSQL>
</OGRVRTLayer>
</OGRVRTDataSource>

-Jukka Rahkonen-


From jukka.rahkonen at mmmtike.fi  Fri May 24 10:46:23 2013
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Fri, 24 May 2013 17:46:23 +0000
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
In-Reply-To: <CA+YzLBfFkjaJci94+PH66wWedAeR1RWsnGNU6+TrjupBgjyLYg@mail.gmail.com>
References: <loom.20130524T172841-56@post.gmane.org>
	<CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>,
	<CA+YzLBfFkjaJci94+PH66wWedAeR1RWsnGNU6+TrjupBgjyLYg@mail.gmail.com>
Message-ID: <84446DEF76453C439E9E97E438E13A63C10460@suutari.haapa.mmm.fi>

Hi Frank,

Great, and I guess that this syntax example about how to select the dialect will be added to the driver manual page http://www.gdal.org/ogr/drv_vrt.html  in your documentation sprint of FOSS4G NA.

-Jukka-

________________________________
Frank Warmerdam wrote:


Jukka,

It turns out you can already assign a dialect.  I think it is roughly like:

  <SrcSQL dialect="sqlite">SELECT ...</SrcSQL>

It seems to be touched on it the docs for the OGR VRT driver as well.

Best regards,
Frank



On Fri, May 24, 2013 at 9:46 AM, Frank Warmerdam <warmerdam at pobox.com<mailto:warmerdam at pobox.com>> wrote:
Jukka,

Agreed!  The SrcSQL directive in the VRT should accept a dialect option.  I'll try to do that this afternoon as we are "sprinting" here at FOSS4G NA and this would be a nice sized feature to add.

Best regards,
Frank



On Fri, May 24, 2013 at 8:39 AM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi<mailto:jukka.rahkonen at mmmtike.fi>> wrote:
Hi,

This works with ogrinfo
ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"

I tried to make a VRT file which would do the same

<OGRVRTDataSource>
<OGRVRTLayer name="cities">
<SrcDataSource>cities.shp</SrcDataSource>
<LayerSRS>WGS84</LayerSRS>
<SrcSQL>SELECT GEOMETRY from cities</SrcSQL>
</OGRVRTLayer>
</OGRVRTDataSource>

Now ogrinfo does not find geometries

ogrinfo cities.vrt
INFO: Open of `cities.vrt'
      using driver `VRT' successful.
1: citiesERROR 1: SQL Expression Parsing Error: syntax error
ERROR 1: SQL statement failed, or returned no layer result:
"SELECT GEOMETRY from cities"

This exact use case is not at all interesting but there would be quite nice
possibilities if Spatialite SQL queries could be fired from the VRT and all
this would be supported for on-the-fly conversions
http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html



-Jukka Rahkonen-

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com<mailto:warmerdam at pobox.com>
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer



--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com<mailto:warmerdam at pobox.com>
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer

From warmerdam at pobox.com  Fri May 24 11:09:07 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 24 May 2013 11:09:07 -0700
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
In-Reply-To: <84446DEF76453C439E9E97E438E13A63C10460@suutari.haapa.mmm.fi>
References: <loom.20130524T172841-56@post.gmane.org>
	<CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>
	<CA+YzLBfFkjaJci94+PH66wWedAeR1RWsnGNU6+TrjupBgjyLYg@mail.gmail.com>
	<84446DEF76453C439E9E97E438E13A63C10460@suutari.haapa.mmm.fi>
Message-ID: <CA+YzLBcpJgytSN2fqJ1ZoK16gwCPS=tSjZAFjXS+tHC9fX6HJA@mail.gmail.com>

Jukka,

I do see it mentioned there in the SrcSQL docs.

Best regards,
Frank



On Fri, May 24, 2013 at 10:46 AM, Rahkonen Jukka
<jukka.rahkonen at mmmtike.fi>wrote:

> Hi Frank,
>
> Great, and I guess that this syntax example about how to select the
> dialect will be added to the driver manual page
> http://www.gdal.org/ogr/drv_vrt.html  in your documentation sprint of
> FOSS4G NA.
>
> -Jukka-
>
> ________________________________
> Frank Warmerdam wrote:
>
>
> Jukka,
>
> It turns out you can already assign a dialect.  I think it is roughly like:
>
>   <SrcSQL dialect="sqlite">SELECT ...</SrcSQL>
>
> It seems to be touched on it the docs for the OGR VRT driver as well.
>
> Best regards,
> Frank
>
>
>
> On Fri, May 24, 2013 at 9:46 AM, Frank Warmerdam <warmerdam at pobox.com
> <mailto:warmerdam at pobox.com>> wrote:
> Jukka,
>
> Agreed!  The SrcSQL directive in the VRT should accept a dialect option.
>  I'll try to do that this afternoon as we are "sprinting" here at FOSS4G NA
> and this would be a nice sized feature to add.
>
> Best regards,
> Frank
>
>
>
> On Fri, May 24, 2013 at 8:39 AM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi
> <mailto:jukka.rahkonen at mmmtike.fi>> wrote:
> Hi,
>
> This works with ogrinfo
> ogrinfo -ro cities.shp  -dialect SQLITE -sql "select GEOMETRY from cities"
>
> I tried to make a VRT file which would do the same
>
> <OGRVRTDataSource>
> <OGRVRTLayer name="cities">
> <SrcDataSource>cities.shp</SrcDataSource>
> <LayerSRS>WGS84</LayerSRS>
> <SrcSQL>SELECT GEOMETRY from cities</SrcSQL>
> </OGRVRTLayer>
> </OGRVRTDataSource>
>
> Now ogrinfo does not find geometries
>
> ogrinfo cities.vrt
> INFO: Open of `cities.vrt'
>       using driver `VRT' successful.
> 1: citiesERROR 1: SQL Expression Parsing Error: syntax error
> ERROR 1: SQL statement failed, or returned no layer result:
> "SELECT GEOMETRY from cities"
>
> This exact use case is not at all interesting but there would be quite nice
> possibilities if Spatialite SQL queries could be fired from the VRT and all
> this would be supported for on-the-fly conversions
> http://www.gaia-gis.it/gaia-sins/spatialite-sql-4.0.0.html
>
>
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com<mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com<mailto:warmerdam at pobox.com>
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130524/e81918ee/attachment-0001.html>

From johan.o.hedin at gmail.com  Fri May 24 12:08:52 2013
From: johan.o.hedin at gmail.com (Johan Hedin)
Date: Fri, 24 May 2013 21:08:52 +0200
Subject: [gdal-dev] GDAL 1.10 JP2000 Problem/Crash
In-Reply-To: <9A95FC2B-3377-49A6-B5C1-571B775C3310@usgs.gov>
References: <CALqbEi4XGU=M4z9iYxZFZERR9ViHUSDE3=1_W17P92EXbjeLng@mail.gmail.com>
	<CALqbEi4OT9qjrsdgVCdhWY79OBEzoTNchA4UOGaP_Mfv17ya4A@mail.gmail.com>
	<CA+YzLBfiWH7kirZaydWF6x8dFfrj6t_exfKTfMn9ntQbZGpzHA@mail.gmail.com>
	<201305221946.22339.even.rouault@mines-paris.org>
	<C4E523BC-6ACF-4449-A8EE-0B1AEE59712A@usgs.gov>
	<CA+YzLBfAdANgs68HRh_2kA3k67_5dq1cKNQ6ySTLfFueunSofA@mail.gmail.com>
	<9A95FC2B-3377-49A6-B5C1-571B775C3310@usgs.gov>
Message-ID: <CA+rY5eJAsUb0wVYXSKntmq1EYDy5F_69LFk2YS1p975et2b13A@mail.gmail.com>

Hi everyone,

I have seen crashes in libecwj2 when reading certain JPG2000 files as
well (on Linux). I have tracked it down to the bundled XML-handling
code in libecwj2 but have not had time to fully investigate.

But what I found was that if I turn off optimization when compiling
libecwj2 this bug can be avoided. Basically you just pass -O0 and you
are all set. Assuming that you are on Linux.

I have written a small note about this in the ECW wikipage on
osgeo.org: http://trac.osgeo.org/gdal/wiki/ECW.

If I get time to dig more into this I will update the wiki and post my
findings on the list.

I'm dependent on the 3.3 SDK as well and with all the fixes that are
mentioned on the wiki page above I think the the 3.3 SDK is working
quite well on Linux and that it should be possible to maintain it at
least for the foreseeable future.

Regards
Johan


2013/5/23 John Daniel <jdaniel at usgs.gov>:
> On May 23, 2013, at 12:37 PM, Frank Warmerdam <warmerdam at pobox.com> wrote:
>
> John,
>
> In my experience the crashes with the ECW 3.3 library are not specific to
> recent versions of GDAL.  I've run into them over the years.
>
>
> Frank,
> I was just curious about potential future problems with GDAL 1.10. If ECW
> runs as well, or as poorly, as it does with GDAL 1.9.2, then I'm happy.
>
> Why does the direct use of the app directory object files concern you?  I
> can't recall exactly why it is setup that way.  It seems to me I once tried
> to use the library for the apps area but it was missing something I needed.
> It seems the current arrangement is just a bit ackward but hopefully not a
> serious barrier for Kakadu licensees.
>
>
> Because changing the interface to the shared library is a big deal. Kakadu
> isn't going to do that without good reason and clear documentation on how to
> handle it. Our relatively recent Kakadu 7.1 library does just that and
> requires a minor patch to GDAL 1.9.2. However, Kakadu can change its
> internal code at any time and would be under no expectation to tell anyone
> or explain the changes.
>
> We are experiencing this exact problem with libXML. Our old version was
> using undocumented internals of libz. When the sysadmins updated libz for
> someone else's requirements, any application that used libXML, including
> GDAL, ceased to function. We still don't have all of our servers
> operational. We move slowly around here.
>
> We also had trouble building Kakadu so that its object files were compatible
> with GDAL. Now we also have a patch for Kakadu to add -fPIC for apps.
>
> I have no expectation that ECW 3.3 will continue to function in the future.
> It already doesn't work on our Solaris machines and needs patches for my
> Mac. Kakadu is well supported so I'm not worried about that. But I am a bit
> worried about direct linking to object files in a proprietary and very
> expensive library. There is potential for a future problem there.
>
> John Daniel
> Software Engineer
> Stinger Ghaffarian Technologies (SGT, Inc.)
> Contractor to the U.S. Geological Survey (USGS)
> Earth Resources Observation and Science (EROS) Center
> 47914 252nd Street
> Sioux Falls, South Dakota 57198
> Phone: 905.240.2953
> Mobile: 905.442.9385
> Skype: 303.586.1987
> Email: jdaniel at usgs.gov
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at mmmtike.fi  Fri May 24 12:27:24 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 24 May 2013 19:27:24 +0000 (UTC)
Subject: [gdal-dev] Is using geometry in SQL inside VRT supported?
References: <loom.20130524T172841-56@post.gmane.org>
	<CA+YzLBd4t0tfivzi9GpUhw4DH4L4ruJMbnds0n7vjqsmuj5Trw@mail.gmail.com>
	<CA+YzLBfFkjaJci94+PH66wWedAeR1RWsnGNU6+TrjupBgjyLYg@mail.gmail.com>
	<84446DEF76453C439E9E97E438E13A63C10460@suutari.haapa.mmm.fi>
	<CA+YzLBcpJgytSN2fqJ1ZoK16gwCPS=tSjZAFjXS+tHC9fX6HJA@mail.gmail.com>
Message-ID: <loom.20130524T210013-3@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> Jukka,
> I do see it mentioned there in the SrcSQL docs. ?

Hi,

I did see it too but I did not undestand what it means before I saw your
example. XML is not my native language and the meaning of "Starting with OGR
1.10, an optional dialect attribute can be specified on the SrcSQL element"
was not obvious for me. I am sure that within a week I have forgotton the
exact syntax again but now I know that at least I will find it from the mail
archive.

Regards,

-Jukka-
 
> Best regards,
> Frank



From jukka.rahkonen at mmmtike.fi  Fri May 24 14:52:43 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri, 24 May 2013 21:52:43 +0000 (UTC)
Subject: [gdal-dev] Ogr2ogr with -dialect and VRT
Message-ID: <loom.20130524T234351-239@post.gmane.org>

Hi,

The -dialect parameter in ogr2ogr does not have an effect when using VRT as
datasource but could it be made to inject the selected dialect into SrcSQL
element of the VRT? Thus  
ogr2ogr -dialect SQLITE 
would lead to 
<SrcSQL dialect="sqlite">SELECT ...</SrcSQL>


-Jukka Rahkonen- 


From even.rouault at mines-paris.org  Sat May 25 00:23:15 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 25 May 2013 09:23:15 +0200
Subject: [gdal-dev] Ogr2ogr with -dialect and VRT
In-Reply-To: <loom.20130524T234351-239@post.gmane.org>
References: <loom.20130524T234351-239@post.gmane.org>
Message-ID: <201305250923.16109.even.rouault@mines-paris.org>

Le vendredi 24 mai 2013 23:52:43, Jukka Rahkonen a ?crit :
> Hi,
> 
> The -dialect parameter in ogr2ogr does not have an effect when using VRT as
> datasource but could it be made to inject the selected dialect into SrcSQL
> element of the VRT? Thus
> ogr2ogr -dialect SQLITE
> would lead to
> <SrcSQL dialect="sqlite">SELECT ...</SrcSQL>

(Almost) everything is possible in matter of software development, but IMHO 
the above would be a horrible hack in the code, whereas you can simply edit a 
text file to indicate your will.

Furthermore " ogr2ogr -dialect sqlite dst.shp src.vrt -sql "someSQL" " is 
something valid currently and it means to run someSQL with the sqlite dialect 
on top of src.vrt would naturally return (the fact that src.vrt can run some 
SQL internally is something that ogr2ogr doesn't know).

> 
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Sat May 25 01:32:16 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 25 May 2013 11:32:16 +0300
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <1369130389.519b4595d50c6@imp.free.fr>
References: <519A76E7.4050801@gmail.com> <1369080823.519a83f71e1fe@imp.free.fr>
	<519A96B0.2080307@gmail.com> <1369123062.519b28f62a3a5@imp.free.fr>
	<519B2B2B.6030406@gmail.com> <1369125489.519b32719be5c@imp.free.fr>
	<519B40BD.8090002@gmail.com> <1369130389.519b4595d50c6@imp.free.fr>
Message-ID: <51A07710.3030609@gmail.com>

On 05/21/2013 12:59 PM, Even Rouault wrote:
> This is perhaps due to the WFS/GML driver running in streaming mode 
> now. It uses the schema to be able to decode the GetFeature XML 
> on-the-fly. Previously it downloaded the whole file in memory and 
> could analyze its structure without relying on the XML schema 
> (although I believe that if the schema was available, it was used, so 
> I'm not completely sure that's the explanation). You can probably 
> revert to the old behaviour by setting the environmenent variable 
> OGR_WFS_USE_STREAMING to NO. 

Another thing related to streaming mode.

I was wondering why the geometries the WFS were not being parsed by the 
client. It turns out that GDAL uses the tag "geometryProperty" by 
default (ogrgmllayer.cpp:601). The WFS I have uses the field name from 
PostGIS when replying to the DescribeFeatureType request. So I need to 
add a hack to the server to always use the "geometryProperty" tag.

This seems to be a small deficiency in GDAL; that it doesn't have the 
concept of a field name for geometries. This may limit the usability of 
GDAL as a component of a WFS.

Ari


From even.rouault at mines-paris.org  Sat May 25 01:44:04 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 25 May 2013 10:44:04 +0200
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <51A07710.3030609@gmail.com>
References: <519A76E7.4050801@gmail.com> <1369130389.519b4595d50c6@imp.free.fr>
	<51A07710.3030609@gmail.com>
Message-ID: <201305251044.04574.even.rouault@mines-paris.org>

Hi Ari,

> Another thing related to streaming mode.

I fail to see how below is related to streaming mode... This is a generic 
behaviour of the GML driver

> 
> I was wondering why the geometries the WFS were not being parsed by the
> client. It turns out that GDAL uses the tag "geometryProperty" by
> default (ogrgmllayer.cpp:601). The WFS I have uses the field name from
> PostGIS when replying to the DescribeFeatureType request. So I need to
> add a hack to the server to always use the "geometryProperty" tag.
> 
> This seems to be a small deficiency in GDAL; that it doesn't have the
> concept of a field name for geometries. This may limit the usability of
> GDAL as a component of a WFS.

The issue is that, as far as I've understood, you use a schema not generated 
by the GML driver with GML output generated by the GML driver.

OGR layers have a concept of GetGeometryColumn(), in read mode. The GML driver 
is able to read a GML whose geometry name is not "geometryProperty". What 
could be done is to add a layer creation option to specify a geometry name 
instead of the default "geometryProperty". Would you be interested in that ?

> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Sat May 25 02:04:42 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 25 May 2013 12:04:42 +0300
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <201305251044.04574.even.rouault@mines-paris.org>
References: <519A76E7.4050801@gmail.com> <1369130389.519b4595d50c6@imp.free.fr>
	<51A07710.3030609@gmail.com>
	<201305251044.04574.even.rouault@mines-paris.org>
Message-ID: <51A07EAA.8000903@gmail.com>

On 05/25/2013 11:44 AM, Even Rouault wrote:
> Hi Ari,
>
>> Another thing related to streaming mode.
> I fail to see how below is related to streaming mode... This is a generic
> behaviour of the GML driver

Because it appears when GDAL uses the DescribeFeatureType request's 
output as a gfs...(?) maybe, I think :)

>
>> I was wondering why the geometries the WFS were not being parsed by the
>> client. It turns out that GDAL uses the tag "geometryProperty" by
>> default (ogrgmllayer.cpp:601). The WFS I have uses the field name from
>> PostGIS when replying to the DescribeFeatureType request. So I need to
>> add a hack to the server to always use the "geometryProperty" tag.
>>
>> This seems to be a small deficiency in GDAL; that it doesn't have the
>> concept of a field name for geometries. This may limit the usability of
>> GDAL as a component of a WFS.
> The issue is that, as far as I've understood, you use a schema not generated
> by the GML driver with GML output generated by the GML driver.

Could the driver do it? Ok, I see InsertHeader method in 
OGRGMLDataSource class, which would perhaps be the one to do it, but it 
is probably not open in the bindings. Which is why I used Perl tools to 
query PostGIS and reply to DescribeFeatureType request.

> OGR layers have a concept of GetGeometryColumn(), in read mode. The GML driver
> is able to read a GML whose geometry name is not "geometryProperty". What
> could be done is to add a layer creation option to specify a geometry name
> instead of the default "geometryProperty". Would you be interested in that ?

I think the right thing to do would be to open the schema methods to the 
bindings. But then it would be first needed in the OGR C API. But is the 
schema method a generic thing for a DataSource and thus something for 
the API? Hm.

Ari

>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Sat May 25 02:37:02 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 25 May 2013 11:37:02 +0200
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <51A07EAA.8000903@gmail.com>
References: <519A76E7.4050801@gmail.com>
	<201305251044.04574.even.rouault@mines-paris.org>
	<51A07EAA.8000903@gmail.com>
Message-ID: <201305251137.02145.even.rouault@mines-paris.org>

Le samedi 25 mai 2013 11:04:42, Ari Jolma a ?crit :
> On 05/25/2013 11:44 AM, Even Rouault wrote:
> > Hi Ari,
> > 
> >> Another thing related to streaming mode.
> > 
> > I fail to see how below is related to streaming mode... This is a generic
> > behaviour of the GML driver
> 
> Because it appears when GDAL uses the DescribeFeatureType request's
> output as a gfs...(?) maybe, I think :)

If the GML driver detects that the file passed to it is a WFS GetFeature 
document and that it is opened through /vsicurl_streaming/ , yes it cannot 
access the schema other by using the DescribeFeatureType document indicated in 
the schemaLocation property of the top XML element. So if the 
DescribeFeatureType document indicates a geometry name inconsistant with the 
one of the GML, this can likely cause issue.

> 
> >> I was wondering why the geometries the WFS were not being parsed by the
> >> client. It turns out that GDAL uses the tag "geometryProperty" by
> >> default (ogrgmllayer.cpp:601). The WFS I have uses the field name from
> >> PostGIS when replying to the DescribeFeatureType request. So I need to
> >> add a hack to the server to always use the "geometryProperty" tag.
> >> 
> >> This seems to be a small deficiency in GDAL; that it doesn't have the
> >> concept of a field name for geometries. This may limit the usability of
> >> GDAL as a component of a WFS.
> > 
> > The issue is that, as far as I've understood, you use a schema not
> > generated by the GML driver with GML output generated by the GML driver.
> 
> Could the driver do it? Ok, I see InsertHeader method in
> OGRGMLDataSource class, which would perhaps be the one to do it, but it
> is probably not open in the bindings. Which is why I used Perl tools to
> query PostGIS and reply to DescribeFeatureType request.

If you output to a regular file, the GML driver will generate a .xsd file with 
the schema alongside the GML file. If you output to /vsistdout/ directly, then 
of course it is not possible to generate the .xsd file.
If you don't want to write on the filesystem, an alternative would be to output 
to /vsimem/ so that you can read both files afterwards.
Another way if you want to use the .xsd generated by the GML driver and keep 
the advantage of using streaming to vsistdout, would be to:
1) Output to /vsimem/ , create the layer definition, but write 0 feature. You 
just fetch the .xsd that can be used for DescribeFeatureType
2) Output to /vsistdout/ with all the needed features.

> 
> > OGR layers have a concept of GetGeometryColumn(), in read mode. The GML
> > driver is able to read a GML whose geometry name is not
> > "geometryProperty". What could be done is to add a layer creation option
> > to specify a geometry name instead of the default "geometryProperty".
> > Would you be interested in that ?
> 
> I think the right thing to do would be to open the schema methods to the
> bindings. But then it would be first needed in the OGR C API. But is the
> schema method a generic thing for a DataSource and thus something for
> the API? Hm.

Seems a bit too specific to make it available at the OGR C API level. The trick 
I mentionned above should be a workaround.

But as I'm not in front of your computer, I'm not really sure to have 
understood your whole setup...

> 
> Ari
> 
> >> Ari
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Sat May 25 02:54:46 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sat, 25 May 2013 12:54:46 +0300
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <201305251137.02145.even.rouault@mines-paris.org>
References: <519A76E7.4050801@gmail.com>
	<201305251044.04574.even.rouault@mines-paris.org>
	<51A07EAA.8000903@gmail.com>
	<201305251137.02145.even.rouault@mines-paris.org>
Message-ID: <51A08A66.7090901@gmail.com>

On 05/25/2013 12:37 PM, Even Rouault wrote:
> If you output to a regular file, the GML driver will generate a .xsd 
> file with the schema alongside the GML file. If you output to 
> /vsistdout/ directly, then of course it is not possible to generate 
> the .xsd file. If you don't want to write on the filesystem, an 
> alternative would be to output to /vsimem/ so that you can read both 
> files afterwards. Another way if you want to use the .xsd generated by 
> the GML driver and keep the advantage of using streaming to vsistdout, 
> would be to: 1) Output to /vsimem/ , create the layer definition, but 
> write 0 feature. You just fetch the .xsd that can be used for 
> DescribeFeatureType 2) Output to /vsistdout/ with all the needed 
> features. 

so, if I understand correctly:

my $postgis = Geo::OGR::Open($Datasource);
my $postgis_layer = $postgis->Layer($Name);

my $vsi = '/vsimem/';
my $gml = Geo::OGR::Driver('GML')->Create($vsi, {
     TARGET_NAMESPACE => 'http://www.opengis.net/wfs', PREFIX => 'wfs' });
my $gml_layer = $gml->CreateLayer($Name);

my $schema = $postgis_layer->GetLayerDefn;
for my $i (0..$schema->GetFieldCount-1) {
     $gml_layer->CreateField($schema->GetFieldDefn($i));
}

# at this point there should be a .xsd in /vsimem/, which could/should 
be used for the DescribeFeatureType request

I'll try this later. Now I'm happy with the hack.

Ari


From even.rouault at mines-paris.org  Sat May 25 03:35:32 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 25 May 2013 12:35:32 +0200
Subject: [gdal-dev] Issues with WFS driver
In-Reply-To: <51A08A66.7090901@gmail.com>
References: <519A76E7.4050801@gmail.com>
	<201305251137.02145.even.rouault@mines-paris.org>
	<51A08A66.7090901@gmail.com>
Message-ID: <201305251235.32218.even.rouault@mines-paris.org>

Le samedi 25 mai 2013 11:54:46, Ari Jolma a ?crit :
> On 05/25/2013 12:37 PM, Even Rouault wrote:
> > If you output to a regular file, the GML driver will generate a .xsd
> > file with the schema alongside the GML file. If you output to
> > /vsistdout/ directly, then of course it is not possible to generate
> > the .xsd file. If you don't want to write on the filesystem, an
> > alternative would be to output to /vsimem/ so that you can read both
> > files afterwards. Another way if you want to use the .xsd generated by
> > the GML driver and keep the advantage of using streaming to vsistdout,
> > would be to: 1) Output to /vsimem/ , create the layer definition, but
> > write 0 feature. You just fetch the .xsd that can be used for
> > DescribeFeatureType 2) Output to /vsistdout/ with all the needed
> > features.
> 
> so, if I understand correctly:
> 
> my $postgis = Geo::OGR::Open($Datasource);
> my $postgis_layer = $postgis->Layer($Name);
> 
> my $vsi = '/vsimem/';

You need to specify a valid filename, something like "/vsimem/something.gml"

> my $gml = Geo::OGR::Driver('GML')->Create($vsi, {
>      TARGET_NAMESPACE => 'http://www.opengis.net/wfs', PREFIX => 'wfs' });
> my $gml_layer = $gml->CreateLayer($Name);
> 
> my $schema = $postgis_layer->GetLayerDefn;
> for my $i (0..$schema->GetFieldCount-1) {
>      $gml_layer->CreateField($schema->GetFieldDefn($i));
> }

Close the datasource at that point so files get flushed.

> 
> # at this point there should be a .xsd in /vsimem/, which could/should
> be used for the DescribeFeatureType request

Yes, there should be a "/vsimem/something.xsd" now

> 
> I'll try this later. Now I'm happy with the hack.
> 
> Ari

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From pcorti at gmail.com  Sat May 25 08:47:59 2013
From: pcorti at gmail.com (Paolo Corti)
Date: Sat, 25 May 2013 17:47:59 +0200
Subject: [gdal-dev] Accessing to a NetCDF subdataset with Python
Message-ID: <CAHXrU-LbeeWVPjb9QFxyYkyzisAOo=+n_gg=0=2hVLRoc3+5hQ@mail.gmail.com>

Hi list

I am with GDAL 1.10.
I thought it was possible to access to a netCDF subdataset in the
usual manner (using GetRasterBand), but it does not seem to work in my
local box:

>>> from osgeo import gdal
>>> from osgeo.gdalconst import *
>>> gdal.AllRegister()
>>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc"'
>>> ds = gdal.Open(file_nc, GA_ReadOnly)
>>> ds.RasterCount
0

while, using the subdataset name access syntax, it is working:

>>> from osgeo import gdal
>>> from osgeo.gdalconst import *
>>> gdal.AllRegister()
>>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area'
>>> ds = gdal.Open(file_nc, GA_ReadOnly)
Warning 1: Latitude grid not spaced evenly.
Seting projection for grid spacing is within 0.1 degrees threshold.
>>> ds.RasterCount
1

Now, do I have a local problem, or the second way is the only way to
access to a subdataset?
And in such a case, is the only way to programmatically access to the
subdatasets by reading their name using GetSubdataset or there is a
better way?

>>> ds.GetSubDatasets()
[('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area', '[128x256] area
(32-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lat_bnds', '[128x2]
lat_bnds (64-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lon_bnds', '[256x2]
lon_bnds (64-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":msk_rgn', '[128x256]
msk_rgn (32-bit integer)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":pr', '[1x128x256]
precipitation_flux (32-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":tas', '[1x128x256]
air_temperature (32-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":time_bnds', '[1x2]
time_bnds (64-bit floating-point)'),
('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":ua', '[1x17x128x256]
eastward_wind (32-bit floating-point)')]
>>> sds = gdal.Open(ds.GetSubDatasets()[0][0])

thanks in advance!
p

-- 
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti

From even.rouault at mines-paris.org  Sat May 25 10:11:35 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 25 May 2013 19:11:35 +0200
Subject: [gdal-dev] Accessing to a NetCDF subdataset with Python
In-Reply-To: <CAHXrU-LbeeWVPjb9QFxyYkyzisAOo=+n_gg=0=2hVLRoc3+5hQ@mail.gmail.com>
References: <CAHXrU-LbeeWVPjb9QFxyYkyzisAOo=+n_gg=0=2hVLRoc3+5hQ@mail.gmail.com>
Message-ID: <201305251911.35637.even.rouault@mines-paris.org>

Le samedi 25 mai 2013 17:47:59, Paolo Corti a ?crit :
> Hi list
> 
> I am with GDAL 1.10.
> I thought it was possible to access to a netCDF subdataset in the
> usual manner (using GetRasterBand), but it does not seem to work in my
> 
> local box:
> >>> from osgeo import gdal
> >>> from osgeo.gdalconst import *
> >>> gdal.AllRegister()
> >>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc"'
> >>> ds = gdal.Open(file_nc, GA_ReadOnly)
> >>> ds.RasterCount
> 
> 0

If the netcdf file has only one variable with 2 dimensions, then you can 
directly open the dataset with the filename. If there are more than one 
variable with 2 dimensions, you need to specify the subdataset name 
(logically)

> 
> while, using the subdataset name access syntax, it is working:
> >>> from osgeo import gdal
> >>> from osgeo.gdalconst import *
> >>> gdal.AllRegister()
> >>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area'
> >>> ds = gdal.Open(file_nc, GA_ReadOnly)
> 
> Warning 1: Latitude grid not spaced evenly.
> Seting projection for grid spacing is within 0.1 degrees threshold.
> 
> >>> ds.RasterCount
> 
> 1
> 
> Now, do I have a local problem, or the second way is the only way to
> access to a subdataset?

See above answer

> And in such a case, is the only way to programmatically access to the
> subdatasets by reading their name using GetSubdataset or there is a
> better way?

I can't think of a better way.

> 
> >>> ds.GetSubDatasets()
> 
> [('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area', '[128x256] area
> (32-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lat_bnds', '[128x2]
> lat_bnds (64-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lon_bnds', '[256x2]
> lon_bnds (64-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":msk_rgn', '[128x256]
> msk_rgn (32-bit integer)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":pr', '[1x128x256]
> precipitation_flux (32-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":tas', '[1x128x256]
> air_temperature (32-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":time_bnds', '[1x2]
> time_bnds (64-bit floating-point)'),
> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":ua', '[1x17x128x256]
> eastward_wind (32-bit floating-point)')]
> 
> >>> sds = gdal.Open(ds.GetSubDatasets()[0][0])
> 
> thanks in advance!
> p

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From pcorti at gmail.com  Sun May 26 01:46:05 2013
From: pcorti at gmail.com (Paolo Corti)
Date: Sun, 26 May 2013 10:46:05 +0200
Subject: [gdal-dev] Accessing to a NetCDF subdataset with Python
In-Reply-To: <201305251911.35637.even.rouault@mines-paris.org>
References: <CAHXrU-LbeeWVPjb9QFxyYkyzisAOo=+n_gg=0=2hVLRoc3+5hQ@mail.gmail.com>
	<201305251911.35637.even.rouault@mines-paris.org>
Message-ID: <CAHXrU-+Dvy28W0Le75rQ_T5AEuqE5i7b5LAyMFkcQJL3fHM0LA@mail.gmail.com>

On Sat, May 25, 2013 at 7:11 PM, Even Rouault
<even.rouault at mines-paris.org> wrote:
> Le samedi 25 mai 2013 17:47:59, Paolo Corti a ?crit :
>> Hi list
>>
>> I am with GDAL 1.10.
>> I thought it was possible to access to a netCDF subdataset in the
>> usual manner (using GetRasterBand), but it does not seem to work in my
>>
>> local box:
>> >>> from osgeo import gdal
>> >>> from osgeo.gdalconst import *
>> >>> gdal.AllRegister()
>> >>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc"'
>> >>> ds = gdal.Open(file_nc, GA_ReadOnly)
>> >>> ds.RasterCount
>>
>> 0
>
> If the netcdf file has only one variable with 2 dimensions, then you can
> directly open the dataset with the filename. If there are more than one
> variable with 2 dimensions, you need to specify the subdataset name
> (logically)
>
>>
>> while, using the subdataset name access syntax, it is working:
>> >>> from osgeo import gdal
>> >>> from osgeo.gdalconst import *
>> >>> gdal.AllRegister()
>> >>> file_nc = 'NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area'
>> >>> ds = gdal.Open(file_nc, GA_ReadOnly)
>>
>> Warning 1: Latitude grid not spaced evenly.
>> Seting projection for grid spacing is within 0.1 degrees threshold.
>>
>> >>> ds.RasterCount
>>
>> 1
>>
>> Now, do I have a local problem, or the second way is the only way to
>> access to a subdataset?
>
> See above answer
>
>> And in such a case, is the only way to programmatically access to the
>> subdatasets by reading their name using GetSubdataset or there is a
>> better way?
>
> I can't think of a better way.
>
>>
>> >>> ds.GetSubDatasets()
>>
>> [('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":area', '[128x256] area
>> (32-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lat_bnds', '[128x2]
>> lat_bnds (64-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":lon_bnds', '[256x2]
>> lon_bnds (64-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":msk_rgn', '[128x256]
>> msk_rgn (32-bit integer)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":pr', '[1x128x256]
>> precipitation_flux (32-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":tas', '[1x128x256]
>> air_temperature (32-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":time_bnds', '[1x2]
>> time_bnds (64-bit floating-point)'),
>> ('NETCDF:"sresa1b_ncar_ccsm3_0_run1_200001.nc":ua', '[1x17x128x256]
>> eastward_wind (32-bit floating-point)')]
>>
>> >>> sds = gdal.Open(ds.GetSubDatasets()[0][0])
>>
>> thanks in advance!
>> p
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html

Thanks Even!
I have not been working with dataset having subdatasets for a while
now, and I did
not consider that, while this is not the case for the netcdf file I am
working with, the subdatasets may be multibands!
Now you put me on the correct route, thanks :)
cheers
p

-- 
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti

From jukka.rahkonen at mmmtike.fi  Sun May 26 07:25:50 2013
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Sun, 26 May 2013 14:25:50 +0000
Subject: [gdal-dev] Ogr2ogr with -dialect and VRT
In-Reply-To: <201305250923.16109.even.rouault@mines-paris.org>
References: <loom.20130524T234351-239@post.gmane.org>,
	<201305250923.16109.even.rouault@mines-paris.org>
Message-ID: <84446DEF76453C439E9E97E438E13A63C107F9@suutari.haapa.mmm.fi>

Even Rouault wrote:

> Le vendredi 24 mai 2013 23:52:43, Jukka Rahkonen a ?crit :
>> Hi,
>>
>> The -dialect parameter in ogr2ogr does not have an effect when using VRT as
>> datasource but could it be made to inject the selected dialect into SrcSQL
>> element of the VRT? Thus
>> ogr2ogr -dialect SQLITE
>> would lead to
>> <SrcSQL dialect="sqlite">SELECT ...</SrcSQL>

> (Almost) everything is possible in matter of software development, but IMHO
> the above would be a horrible hack in the code, whereas you can simply edit a
> text file to indicate your will.

After rethinking I agree that using -dialect as I suggested is not a good idea and that editing a text file is simple. I do not agree that making VRT to indicate my will is always easy but it helps a lot if there are some examples about the correct use and syntax.

I suggest to add a new example into Virtual Format manual page http://www.gdal.org/ogr/drv_vrt.html and it might be something like this:

Example: SQLite/Spatialite SQL dialect (GDAL >=1.10.0)

The following example will return four different layers which are generated in a fly from the same polygon shapefile. The first one is the shapefile layer as it stands. The second layer gives simplified polygons by applying Spatialite function "Simplify" with parameter tolerance=10. In the third layer the original geometries are replaced by their convace hulls. In the fourth layer Spatialite function PointOnSurface is used for replacing the original geometries by points which are inside the corresponding source polygons. Note that for using the last three layers of this VRT file GDAL must be compiled with SQLite and Spatialite.

<OGRVRTDataSource>
<OGRVRTLayer name="polygons">
<SrcDataSource>polygons.shp</SrcDataSource>
</OGRVRTLayer>
<OGRVRTLayer name="polygons_as_simplified">
<SrcDataSource>polygons.shp</SrcDataSource>
<SrcSQL dialect="sqlite">SELECT Simplify(geometry,10) from polygons</SrcSQL>
</OGRVRTLayer>
<OGRVRTLayer name="polygons_as_hulls">
<SrcDataSource>polygons.shp</SrcDataSource>
<SrcSQL dialect="sqlite">SELECT ConvexHull(geometry) from polygons</SrcSQL>
</OGRVRTLayer>
<OGRVRTLayer name="polygons_as_points">
<SrcDataSource>polygons.shp</SrcDataSource>
<SrcSQL dialect="sqlite">SELECT PointOnSurface(geometry) from polygons</SrcSQL>
</OGRVRTLayer>
</OGRVRTDataSource>

The last Other note on the driver page dealing with the normal use of VRT driver feels somehow outdated
"Normally the SrcDataSource is a non-spatial tabular format (such as MySQL, SQLite, CSV, OCI, or ODBC) but it can also be a spatial database in which case the geometry can be directly copied over. "

Regards,

-Jukka Rahkonen-

From even.rouault at mines-paris.org  Sun May 26 07:34:36 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 26 May 2013 16:34:36 +0200
Subject: [gdal-dev] Ogr2ogr with -dialect and VRT
In-Reply-To: <84446DEF76453C439E9E97E438E13A63C107F9@suutari.haapa.mmm.fi>
References: <loom.20130524T234351-239@post.gmane.org>
	<201305250923.16109.even.rouault@mines-paris.org>
	<84446DEF76453C439E9E97E438E13A63C107F9@suutari.haapa.mmm.fi>
Message-ID: <201305261634.36474.even.rouault@mines-paris.org>

Le dimanche 26 mai 2013 16:25:50, Rahkonen Jukka a ?crit :
> I suggest to add a new example into Virtual Format manual page
> http://www.gdal.org/ogr/drv_vrt.html and it might be something like this:

Hi Jukka,

I've committed your changes. Thanks

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sun May 26 07:46:31 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 26 May 2013 16:46:31 +0200
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for regular I/O
Message-ID: <201305261646.31371.even.rouault@mines-paris.org>

Hi,

I've just commited in trunk a new file port/vsipreload.cpp.

This file is the source code for a standalone shared library that can be 
LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API to be used 
with binaries using regular libc I/O API.

WARNING: Linux glibc ONLY. Might work with some adaptations (mainly around 
64bit symbols) on other Unix systems

Compile:
g++ -Wall -fPIC port/vsipreload.cpp -shared -o vsipreload.so -Iport \
	-L. -L.libs -lgdal

Examples :

LD_PRELOAD=vsipreload.so gdalinfo \
	/vsicurl/http://download.osgeo.org/gdal/data/ecw/spif83.ecw

LD_PRELOAD=vsipreload.so gdalinfo \
 'HDF4_EOS:EOS_GRID:"/vsicurl/http://download.osgeo.org/gdal/data/hdf4/MOD09Q1G_EVI.A2006233.h07v03.005.2008338190308.hdf":MODIS_NACP_EVI:MODIS_EVI'

LD_PRELOAD=vsipreload.so ogrinfo \
	 /vsicurl/http://svn.osgeo.org/gdal/trunk/autotest/ogr/data/testavc -ro

LD_PRELOAD=vsipreload.so ogrinfo -ro \
	
/vsizip//vsicurl/http://download.osgeo.org/gdal/1.10.0/gdalautotest-1.10.0.zip/gdalautotest-1.10.0/ogr/data/testavc

It can work even with non GDAL binaries :

LD_PRELOAD=vsipreload.so h5dump -d /x \
	/vsicurl/http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc

LD_PRELOAD=vsipreload.so sqlite3 \
	 /vsicurl/http://download.osgeo.org/gdal/data/sqlite3/polygon.db \
	"select * from polygon limit 10"

This can work with all VSI Large File API filesystems : /vsizip/ , /vsitar/, 
/vsisubfile/ , etc...

This is still a bit experimental in the sense that only the most common glibc 
I/O API have been overloaded. If exotic ones are used with /vsi files, crashes 
are likely.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Sun May 26 09:56:30 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Sun, 26 May 2013 19:56:30 +0300
Subject: [gdal-dev] VERSION in trunk
Message-ID: <51A23EBE.4080700@gmail.com>

Hi,

Shouldn't the trunk VERSION contain 1.11.0?

Ari


From warmerdam at pobox.com  Sun May 26 11:41:26 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun, 26 May 2013 11:41:26 -0700
Subject: [gdal-dev] VERSION in trunk
In-Reply-To: <51A23EBE.4080700@gmail.com>
References: <51A23EBE.4080700@gmail.com>
Message-ID: <CA+YzLBfG-LiYPrS-j13AVCh6L53xfyp0E04b_2aFXnu==am1Qg@mail.gmail.com>

Done, thanks


On Sun, May 26, 2013 at 9:56 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

> Hi,
>
> Shouldn't the trunk VERSION contain 1.11.0?
>
> Ari
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130526/ee4e6f6c/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon May 27 01:56:04 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 27 May 2013 08:56:04 +0000 (UTC)
Subject: [gdal-dev] Hstore errors with OSM driver
Message-ID: <loom.20130527T102615-171@post.gmane.org>

Hi,

I got some error messages when converting OSM data into PostGIS by using
hstore for saving the additional tags. My command was:

ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
password='passwd'" germany.osm.pbf -gt 20000 -progress --config
OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc -lco fid=fid
-lco COLUMN_TYPES=other_tags=hstore --config PG_USE_COPY YES

I believe that issues are easy to reproduce by downloading germany.osm.pbf
of any other biggish country extract from http://download.geofabrik.de.

There two different types of errors:

ERROR 1: COPY statement failed.
ERROR:  Unexpected end of string
CONTEXT:  COPY points, line 9241, column other_tags: "addr:housenumber=>"

ERROR:  Syntax error near '8' at position 22
CONTEXT:  COPY points, line 17629, column other_tags: "opening_hours=>Mo-Fr.
8.00-18.00"

ERROR:  Syntax error near 'S' at position 45
CONTEXT:  COPY lines, line 17840, column other_tags:
"addr:interpolation=>,addr:street=>"Lintacher Stra??e""

I have a few questions:

I guess that the "Unexpected end of string" comes from keys without values.
Does the error mean that no tags were saved for the failing feature?

What is the reason for the syntax errors and can user do anything for
avoiding them?

How can I find the suspicious features from the PostGIS tables? Error
message gives a line number but it does not seem to have a corresponding
field in the resulting database table. Field "fid" was my favourite but
tracing by fid->osm_id did not lead to a correct feature.

-Jukka Rahkonen-






From even.rouault at mines-paris.org  Mon May 27 04:39:10 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 27 May 2013 13:39:10 +0200
Subject: [gdal-dev] Hstore errors with OSM driver
In-Reply-To: <loom.20130527T102615-171@post.gmane.org>
References: <loom.20130527T102615-171@post.gmane.org>
Message-ID: <1369654750.51a345de4d522@imp.free.fr>

Hi Jukka,

it appears that the quoting rules for key/values in HSTORE are more severe than
what I thought (and is documented...). Would you mind filing a Trac ticket about
that ? Thanks.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html




From jukka.rahkonen at mmmtike.fi  Mon May 27 07:47:09 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 27 May 2013 14:47:09 +0000 (UTC)
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
Message-ID: <loom.20130527T163158-922@post.gmane.org>

Hi,

I have measured a huge speed difference by running the same conversion from
OSM data file into PostGIS either with or without using the -skipfailures
parameter.

Without -skipfailures conversion takes about two minutes but if I add the
parameter it takes at least two hours. The command I used is this

ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
password='passwd'" finland.osm.pbf -gt 20000 -progress 
--config OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc 
-lco fid=fid -skipfailures  --config PG_USE_COPY YES

I wonder if it really needs to be so slow. My guess is that -skipfailures
somehow invalidates my -gt 20000 parameter.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Mon May 27 08:12:45 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 27 May 2013 17:12:45 +0200
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <loom.20130527T163158-922@post.gmane.org>
References: <loom.20130527T163158-922@post.gmane.org>
Message-ID: <1369667565.51a377ed78996@imp.free.fr>

Selon Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>:

> Hi,
>
> I have measured a huge speed difference by running the same conversion from
> OSM data file into PostGIS either with or without using the -skipfailures
> parameter.
>
> Without -skipfailures conversion takes about two minutes but if I add the
> parameter it takes at least two hours. The command I used is this
>
> ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
> password='passwd'" finland.osm.pbf -gt 20000 -progress
> --config OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc
> -lco fid=fid -skipfailures  --config PG_USE_COPY YES
>
> I wonder if it really needs to be so slow. My guess is that -skipfailures
> somehow invalidates my -gt 20000 parameter.

Yes, it does. In -skipfailures mode, the transaction must be per feature, so
that a failure on a feature doesn't impact other features.

>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From jukka.rahkonen at mmmtike.fi  Mon May 27 09:12:22 2013
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Mon, 27 May 2013 16:12:22 +0000
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <1369667565.51a377ed78996@imp.free.fr>
References: <loom.20130527T163158-922@post.gmane.org>,
	<1369667565.51a377ed78996@imp.free.fr>
Message-ID: <84446DEF76453C439E9E97E438E13A63C10C2F@suutari.haapa.mmm.fi>

Even Rouault wrote:

> Selon Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>:

>> Hi,
>>
>> I have measured a huge speed difference by running the same conversion from
>> OSM data file into PostGIS either with or without using the -skipfailures
>> parameter.
>>
>> Without -skipfailures conversion takes about two minutes but if I add the
>> parameter it takes at least two hours. The command I used is this
>>
>> ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
>> password='passwd'" finland.osm.pbf -gt 20000 -progress
>> --config OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc
>> -lco fid=fid -skipfailures  --config PG_USE_COPY YES
>>
>> I wonder if it really needs to be so slow. My guess is that -skipfailures
>> somehow invalidates my -gt 20000 parameter.

> Yes, it does. In -skipfailures mode, the transaction must be per feature, so
> that a failure on a feature doesn't impact other features.

Don't you feel that the price is rather high? In this example like 120 minutes vs. 2 minutes. Could you imagine a Speedy Sanitizer (TM) option which would use a small super fast in-memory container for collecting something like one thousand valid features before flushing them into the database? 

-Jukka-

From woodbri at swoodbridge.com  Mon May 27 11:52:57 2013
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 27 May 2013 14:52:57 -0400
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <1369667565.51a377ed78996@imp.free.fr>
References: <loom.20130527T163158-922@post.gmane.org>
	<1369667565.51a377ed78996@imp.free.fr>
Message-ID: <51A3AB89.7070105@swoodbridge.com>

Even,

Would it make sense to create and load a stored procedure that you use 
to load the feature with, then you can trap exceptions and ignore them. 
I would think that this would be much faster. Well the stored procedure 
is run in a transaction bout you could do something like:

begin;
select loadfeatureskipfailures(<args>) from features where gid between 
gid_from and gid_to;
commit;

And run this in a loop incrementing gid_from and gid_to over your range 
of features.

I would think that something along these lines would be faster than 
doing every insert in a separate transaction.

-Steve W

On 5/27/2013 11:12 AM, Even Rouault wrote:
> Selon Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>:
>
>> Hi,
>>
>> I have measured a huge speed difference by running the same conversion from
>> OSM data file into PostGIS either with or without using the -skipfailures
>> parameter.
>>
>> Without -skipfailures conversion takes about two minutes but if I add the
>> parameter it takes at least two hours. The command I used is this
>>
>> ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
>> password='passwd'" finland.osm.pbf -gt 20000 -progress
>> --config OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc
>> -lco fid=fid -skipfailures  --config PG_USE_COPY YES
>>
>> I wonder if it really needs to be so slow. My guess is that -skipfailures
>> somehow invalidates my -gt 20000 parameter.
>
> Yes, it does. In -skipfailures mode, the transaction must be per feature, so
> that a failure on a feature doesn't impact other features.
>
>>
>> -Jukka Rahkonen-
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From even.rouault at mines-paris.org  Mon May 27 12:01:50 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 27 May 2013 21:01:50 +0200
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <84446DEF76453C439E9E97E438E13A63C10C2F@suutari.haapa.mmm.fi>
References: <loom.20130527T163158-922@post.gmane.org>
	<1369667565.51a377ed78996@imp.free.fr>
	<84446DEF76453C439E9E97E438E13A63C10C2F@suutari.haapa.mmm.fi>
Message-ID: <201305272101.51040.even.rouault@mines-paris.org>


> 
> Don't you feel that the price is rather high? In this example like 120
> minutes vs. 2 minutes. Could you imagine a Speedy Sanitizer (TM) option
> which would use a small super fast in-memory container for collecting
> something like one thousand valid features before flushing them into the
> database?

Actually that would be more complicated than that. You only know if features 
are valid once you have submitted them to the database (otherwise we could 
discard them before). So the idea would rather be to retain in memory the 
features of a transaction. If the transaction succeeds, fine. If it fails, you 
then need to resubmit the features one by one in single feature transactions 
(but if you have statistically at least one failure by multiple feature 
transactions, then you'd better just use single feature transaction). Another 
problem I see is that currently, ogr2ogr doesn't detect failures in COPY mode, 
since the error will be caught by PostgreSQL at COMMIT time, and the error 
propagation isn't done properly currently.

> 
> -Jukka-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon May 27 12:06:38 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 27 May 2013 21:06:38 +0200
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <51A3AB89.7070105@swoodbridge.com>
References: <loom.20130527T163158-922@post.gmane.org>
	<1369667565.51a377ed78996@imp.free.fr>
	<51A3AB89.7070105@swoodbridge.com>
Message-ID: <201305272106.38472.even.rouault@mines-paris.org>

Le lundi 27 mai 2013 20:52:57, Stephen Woodbridge a ?crit :
> Even,
> 
> Would it make sense to create and load a stored procedure that you use
> to load the feature with, then you can trap exceptions and ignore them.
> I would think that this would be much faster. Well the stored procedure
> is run in a transaction bout you could do something like:
> 
> begin;
> select loadfeatureskipfailures(<args>) from features where gid between
> gid_from and gid_to;
> commit;
> 
> And run this in a loop incrementing gid_from and gid_to over your range
> of features.
> 
> I would think that something along these lines would be faster than
> doing every insert in a separate transaction.

I'm afraid I'm not familiar enough with PG stored procedures to really assess 
the feasability of your suggestion. What is the features table in your example 
? How is it populated ? And I'm a bit skeptical that this could catch and 
recover errors in a better way than doing it from the outside. 

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From woodbri at swoodbridge.com  Mon May 27 13:05:24 2013
From: woodbri at swoodbridge.com (Stephen Woodbridge)
Date: Mon, 27 May 2013 16:05:24 -0400
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <201305272106.38472.even.rouault@mines-paris.org>
References: <loom.20130527T163158-922@post.gmane.org>
	<1369667565.51a377ed78996@imp.free.fr>
	<51A3AB89.7070105@swoodbridge.com>
	<201305272106.38472.even.rouault@mines-paris.org>
Message-ID: <51A3BC84.7060703@swoodbridge.com>

On 5/27/2013 3:06 PM, Even Rouault wrote:
> Le lundi 27 mai 2013 20:52:57, Stephen Woodbridge a ?crit :
>> Even,
>>
>> Would it make sense to create and load a stored procedure that you use
>> to load the feature with, then you can trap exceptions and ignore them.
>> I would think that this would be much faster. Well the stored procedure
>> is run in a transaction bout you could do something like:
>>
>> begin;
>> select loadfeatureskipfailures(<args>) from features where gid between
>> gid_from and gid_to;
>> commit;
>>
>> And run this in a loop incrementing gid_from and gid_to over your range
>> of features.
>>
>> I would think that something along these lines would be faster than
>> doing every insert in a separate transaction.
>
> I'm afraid I'm not familiar enough with PG stored procedures to really assess
> the feasability of your suggestion. What is the features table in your example
> ? How is it populated ? And I'm a bit skeptical that this could catch and
> recover errors in a better way than doing it from the outside.
>

Hi Even,

My reference to features was a generic reference to the incoming stream 
of feature to be loaded.

In a plpgsql function you can do something like this:

...
BEGIN
   INSERT ....
EXCEPTION
   WHEN SQLSTATE NOT '00000' THEN
     RAISE NOTICE 'Exception % caught, ignoring', SQLSTATE;
     -- NOOP
END;
...

http://www.postgresql.org/docs/9.0/interactive/plpgsql-control-structures.html#PLPGSQL-ERROR-TRAPPING

Anyway, my idea is that the function can recover from the error, so if 
you can feed your data in chucks through the function that can ignore 
errors that this might be faster than

BEGIN;
INSERT ...
COMMIT;

for every feature, but it might not be because a plpgsql function 
effectively runs inside of an implicit transaction. I think it would be 
faster if you could do something like:

BEGIN:
SELECT loadfeature(<args>);
SELECT loadfeature(<args>);
SELECT loadfeature(<args>);
...
SELECT loadfeature(<args>);
SELECT loadfeature(<args>);
SELECT loadfeature(<args>);
COMMIT;

Since none of the loadfeature() calls will fail if you trap the 
exceptions that you are interested in ignoring. This would allow you to 
insert a block of feature in a transaction and ignore any failures.

Without some testing I can't be sure of the performance implication.

-Steve W

From jukka.rahkonen at mmmtike.fi  Mon May 27 13:35:45 2013
From: jukka.rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Mon, 27 May 2013 20:35:45 +0000
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <201305272101.51040.even.rouault@mines-paris.org>
References: <loom.20130527T163158-922@post.gmane.org>
	<1369667565.51a377ed78996@imp.free.fr>
	<84446DEF76453C439E9E97E438E13A63C10C2F@suutari.haapa.mmm.fi>,
	<201305272101.51040.even.rouault@mines-paris.org>
Message-ID: <84446DEF76453C439E9E97E438E13A63C10CA0@suutari.haapa.mmm.fi>

Even Rouault wrote:

>
>> Don't you feel that the price is rather high? In this example like 120
>> minutes vs. 2 minutes. Could you imagine a Speedy Sanitizer (TM) option
>> which would use a small super fast in-memory container for collecting
>> something like one thousand valid features before flushing them into the
>> database?

> Actually that would be more complicated than that. You only know if features
> are valid once you have submitted them to the database (otherwise we could
> discard them before). So the idea would rather be to retain in memory the
> features of a transaction. If the transaction succeeds, fine. If it fails, you
> then need to resubmit the features one by one in single feature transactions
> (but if you have statistically at least one failure by multiple feature
> transactions, then you'd better just use single feature transaction). Another
> problem I see is that currently, ogr2ogr doesn't detect failures in COPY mode,
> since the error will be caught by PostgreSQL at COMMIT time, and the error
> propagation isn't done properly currently.

If they were geometry errors I guess I would have a try by using
-dialect SQLite -sql "select * from layer where IsValid(geometry)=1"

That should work very well with PostGIS because the IsValid function in Spatialite comes from GEOS.  If the problem comes from attributes which are not accepted by the target datastore I fear it will be hard to solve because I do not believe there can be any general method for validating attributes between all the possible formats.
I came to think this because some OSM tags were not accepted by PostGIS hstore. It is perhaps a bug in GDAL and can be corrected that way. Theoretically data errors would be best to correct in the source data but user may not have a software for doing that of the source format can be hard to handle. I quess that the OSM protobuf format belongs to the latter group.

-Jukka Rahkonen- 


From mario at geosar.ch  Tue May 28 02:08:06 2013
From: mario at geosar.ch (Mario Jurcevic)
Date: Tue, 28 May 2013 11:08:06 +0200
Subject: [gdal-dev] ogr2ogr interlis 1 driver arguments
Message-ID: <51A473F6.5010509@geosar.ch>

Hi,
with gdal 1.9.2 when passing to ogr2ogr the layer names to import ( 
interlis 1 driver ) some layers could not be found.
Instead when importing the whole file everything is OK.

The ili file contains 109 layers.

Is there some limitations on the arguments length?

Thanks.

Regards,
Mario Jurcevic







From lauri.kajan at gmail.com  Tue May 28 04:06:46 2013
From: lauri.kajan at gmail.com (Lauri Kajan)
Date: Tue, 28 May 2013 14:06:46 +0300
Subject: [gdal-dev] Reading gml with schema
Message-ID: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>

Hello everybody,

I have tired to read gml file from National Land Suvey of Finnish without a
success.
Does anybody have any idea what's the problem?

The gml has a quite complex schema. Is this a problem for ogr?
I have tried to download all the schema files to the same folder with the
same name than the file but it doesn't work.


Here is a sample:
https://docs.google.com/file/d/0BwbdYcPHdb1pOEs1eGNiZnBhMUk/edit?usp=sharing

Thanks!


Lauri Kajan
Software Developer

Karttakeskus Ltd.
Atomitie 2
00370 Helsinki
Finland
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/5aa82cd5/attachment.html>

From ari.jolma at gmail.com  Tue May 28 07:11:26 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 28 May 2013 17:11:26 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
Message-ID: <51A4BB0E.4020908@gmail.com>

Lauri,

There are at least these issues with the file:

- Piste should be gml:Point
- Murtoviiva should be gml:LineString
- Alue should be gml:Polygon
- all features should be wrapped into gml:featureMember elements
- everything should be in gml:FeatureCollection
- complex geometries should be wrapped into gml:GeometryCollection elements

With these changes and limitations I can open (a small piece) of the 
file with ogrinfo. All are probably changeable by XSLT. Of course my 
knowledge about GML and it's parsing in GDAL is limited, so take this 
with a grain of salt.

Cheers,

Ari

the changed piece:

<?xml version="1.0" encoding="UTF-8"?>
<gml:FeatureCollection xmlns:gml="http://www.opengis.net/gml">
<harvatLouhikot>
     <gml:featureMember>
         <HarvaLouhikko gid="733051928" dimension="3">
             <sijaintitarkkuus>10000</sijaintitarkkuus>
             <korkeustarkkuus>100001</korkeustarkkuus>
             <aineistolahde>1</aineistolahde>
             <alkupvm>2005-11-15</alkupvm>
             <suunta>0</suunta>
             <sijainti>
                 <gml:Point>
                     <gml:pos srsDimension="3">368845.895 7588505.642 
308.292</gml:pos>
                 </gml:Point>
             </sijainti>
             <kohderyhma>13</kohderyhma>
             <kohdeluokka>34200</kohdeluokka>
         </HarvaLouhikko>
         </gml:featureMember>
     </harvatLouhikot>
<hietikot>
     <gml:featureMember>
         <Hietikko gid="775477697" dimension="3">
             <sijaintitarkkuus>5000</sijaintitarkkuus>
             <aineistolahde>1</aineistolahde>
             <alkupvm>2005-11-15</alkupvm>
             <sijainti>
             <gml:GeometryCollection>
             <gml:geometryMember>
                 <gml:Point>
                     <gml:pos srsDimension="3">368010.039 7584945.893 
0.000</gml:pos>
                 </gml:Point>
                 </gml:geometryMember>
                 <gml:geometryMember>
                 <gml:Polygon>
                     <gml:exterior>
                         <gml:LinearRing>
                             <gml:posList srsDimension="3">368000.000 
7584931.821 370.229 368000.000 7584936.222 369.780 368001.115 
7584941.126 368.906 368002.650 7584954.132 364.859 368002.478 
7584969.653 361.051 368008.553 7584975.749 359.563 368016.839 
7584970.791 359.517 368019.890 7584958.174 360.232 368023.171 
7584944.026 362.917 368022.143 7584935.253 365.008 368016.168 
7584924.893 368.340 368004.859 7584923.913 369.824 368000.000 
7584931.821 370.229</gml:posList>
                         </gml:LinearRing>
                     </gml:exterior>
                 </gml:Polygon>
                 </gml:geometryMember>
                 </gml:GeometryCollection>
             </sijainti>
             <kohderyhma>64</kohderyhma>
             <kohdeluokka>34300</kohdeluokka>
         </Hietikko>
         </gml:featureMember>
     </hietikot>
</gml:FeatureCollection>


On 05/28/2013 02:06 PM, Lauri Kajan wrote:
> Hello everybody,
>
> I have tired to read gml file from National Land Suvey of Finnish 
> without a success.
> Does anybody have any idea what's the problem?
>
> The gml has a quite complex schema. Is this a problem for ogr?
> I have tried to download all the schema files to the same folder with 
> the same name than the file but it doesn't work.
>
>
> Here is a sample:
> https://docs.google.com/file/d/0BwbdYcPHdb1pOEs1eGNiZnBhMUk/edit?usp=sharing 
>
>
> Thanks!
>
>
> Lauri Kajan
> Software Developer
>
> Karttakeskus Ltd.
> Atomitie 2
> 00370 Helsinki
> Finland
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/174f3311/attachment-0001.html>

From federicojurio at suremptec.com.ar  Tue May 28 07:13:52 2013
From: federicojurio at suremptec.com.ar (Federico Jurio)
Date: Tue, 28 May 2013 11:13:52 -0300
Subject: [gdal-dev] Calculating polygon area
Message-ID: <CADmC3azJ6PXVE_kcYqO1E7D24KASdnQn-y+5dcqRyJxUzqOrZA@mail.gmail.com>

Dear all, here I am with one question which I'm sure has such a simple
answer that I already feel embarassed in advance! Here goes anyway... I'm
trying to calculate the area length on a GeoTIFF file using GetArea()
method of OGRPolygon class and i'm not sure which is the unit that returns.

This is the information about the raster dataset

"GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS
84\",6378137,298.2572235630016,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]"

Thanks for your patience

-- 
Federico Jurio
SUR Emprendimientos Tecnol?gicos

Per? 345  Piso 5to Oficina "B" (C1067AAG)
Ciudad de Buenos Aires, Argentina
Tel. +54 (11) 4342-2976/84
federicojurio at suremptec.com.ar
www.suremptec.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/5a4609c8/attachment.html>

From hobu.inc at gmail.com  Tue May 28 07:24:21 2013
From: hobu.inc at gmail.com (Howard Butler)
Date: Tue, 28 May 2013 09:24:21 -0500
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <201305261646.31371.even.rouault@mines-paris.org>
References: <201305261646.31371.even.rouault@mines-paris.org>
Message-ID: <0BCDAF9D-A851-4CFD-B07D-A062C679323D@gmail.com>


On May 26, 2013, at 9:46 AM, Even Rouault <even.rouault at mines-paris.org> wrote:
> This file is the source code for a standalone shared library that can be 
> LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API to be used 
> with binaries using regular libc I/O API.

> This can work with all VSI Large File API filesystems : /vsizip/ , /vsitar/, 
> /vsisubfile/ , etc...

Cool!

Next question, if you'll pardon my ignorance, why would we ever want to do this? What does the VSI preload provide?

Howard

From etourigny.dev at gmail.com  Tue May 28 07:27:21 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 28 May 2013 11:27:21 -0300
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <0BCDAF9D-A851-4CFD-B07D-A062C679323D@gmail.com>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<0BCDAF9D-A851-4CFD-B07D-A062C679323D@gmail.com>
Message-ID: <CA+TxYvMKRwZnrOoHLEAjcQYnds6dWF62WFn4GtTGE-VhL7kJYA@mail.gmail.com>

On Tue, May 28, 2013 at 11:24 AM, Howard Butler <hobu.inc at gmail.com> wrote:

>
> On May 26, 2013, at 9:46 AM, Even Rouault <even.rouault at mines-paris.org>
> wrote:
> > This file is the source code for a standalone shared library that can be
> > LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API to
> be used
> > with binaries using regular libc I/O API.
>
> > This can work with all VSI Large File API filesystems : /vsizip/ ,
> /vsitar/,
> > /vsisubfile/ , etc...
>
> Cool!
>

Way cool, Even! I'll test it when I have the time.


>
> Next question, if you'll pardon my ignorance, why would we ever want to do
> this? What does the VSI preload provide?
>


You can open files over ftp/http connexions and files that are compressed
inside zip/tgz/gz archives. This was not previously possible with certain
drivers (hdf4, netcdf, etc.)


>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/72f50a54/attachment.html>

From lauri.kajan at gmail.com  Tue May 28 07:34:02 2013
From: lauri.kajan at gmail.com (Lauri Kajan)
Date: Tue, 28 May 2013 17:34:02 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <51A4BB0E.4020908@gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<51A4BB0E.4020908@gmail.com>
Message-ID: <CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>

Hi Ari,

I think that shouldn't be neccessary.
The gml file points to the xsd schema file (
http://xml.nls.fi/XML/Schema/Maastotietojarjestelma/MTK/201202/Maastotiedot.xsd
).
In this schema those tags are defined to be "aliases" for these known gml
tags by using the substitutionGroup. So actually that <Maastotiedot> is a
<gml:FeatureCollection>. Is this supported by OGR?

I'm not an xml/gml expert either so it's hard to find the problem.

-Lauri





On Tue, May 28, 2013 at 5:11 PM, Ari Jolma <ari.jolma at gmail.com> wrote:

>  Lauri,
>
> There are at least these issues with the file:
>
> - Piste should be gml:Point
> - Murtoviiva should be gml:LineString
> - Alue should be gml:Polygon
> - all features should be wrapped into gml:featureMember elements
> - everything should be in gml:FeatureCollection
> - complex geometries should be wrapped into gml:GeometryCollection elements
>
> With these changes and limitations I can open (a small piece) of the file
> with ogrinfo. All are probably changeable by XSLT. Of course my knowledge
> about GML and it's parsing in GDAL is limited, so take this with a grain of
> salt.
>
> Cheers,
>
> Ari
>
> the changed piece:
>
> <?xml version="1.0" encoding="UTF-8"?>
> <gml:FeatureCollection xmlns:gml="http://www.opengis.net/gml"<http://www.opengis.net/gml>
> >
> <harvatLouhikot>
>     <gml:featureMember>
>         <HarvaLouhikko gid="733051928" dimension="3">
>             <sijaintitarkkuus>10000</sijaintitarkkuus>
>             <korkeustarkkuus>100001</korkeustarkkuus>
>             <aineistolahde>1</aineistolahde>
>             <alkupvm>2005-11-15</alkupvm>
>             <suunta>0</suunta>
>             <sijainti>
>                 <gml:Point>
>                     <gml:pos srsDimension="3">368845.895 7588505.642
> 308.292</gml:pos>
>                 </gml:Point>
>             </sijainti>
>             <kohderyhma>13</kohderyhma>
>             <kohdeluokka>34200</kohdeluokka>
>         </HarvaLouhikko>
>         </gml:featureMember>
>     </harvatLouhikot>
> <hietikot>
>     <gml:featureMember>
>         <Hietikko gid="775477697" dimension="3">
>             <sijaintitarkkuus>5000</sijaintitarkkuus>
>             <aineistolahde>1</aineistolahde>
>             <alkupvm>2005-11-15</alkupvm>
>             <sijainti>
>             <gml:GeometryCollection>
>             <gml:geometryMember>
>                 <gml:Point>
>                     <gml:pos srsDimension="3">368010.039 7584945.893
> 0.000</gml:pos>
>                 </gml:Point>
>                 </gml:geometryMember>
>                 <gml:geometryMember>
>                 <gml:Polygon>
>                     <gml:exterior>
>                         <gml:LinearRing>
>                             <gml:posList srsDimension="3">368000.000
> 7584931.821 370.229 368000.000 7584936.222 369.780 368001.115 7584941.126
> 368.906 368002.650 7584954.132 364.859 368002.478 7584969.653 361.051
> 368008.553 7584975.749 359.563 368016.839 7584970.791 359.517 368019.890
> 7584958.174 360.232 368023.171 7584944.026 362.917 368022.143 7584935.253
> 365.008 368016.168 7584924.893 368.340 368004.859 7584923.913 369.824
> 368000.000 7584931.821 370.229</gml:posList>
>                         </gml:LinearRing>
>                     </gml:exterior>
>                 </gml:Polygon>
>                 </gml:geometryMember>
>                 </gml:GeometryCollection>
>             </sijainti>
>             <kohderyhma>64</kohderyhma>
>             <kohdeluokka>34300</kohdeluokka>
>         </Hietikko>
>         </gml:featureMember>
>     </hietikot>
> </gml:FeatureCollection>
>
>
>
> On 05/28/2013 02:06 PM, Lauri Kajan wrote:
>
>  Hello everybody,
>
>  I have tired to read gml file from National Land Suvey of Finnish
> without a success.
> Does anybody have any idea what's the problem?
>
>  The gml has a quite complex schema. Is this a problem for ogr?
> I have tried to download all the schema files to the same folder with the
> same name than the file but it doesn't work.
>
>
>  Here is a sample:
>
> https://docs.google.com/file/d/0BwbdYcPHdb1pOEs1eGNiZnBhMUk/edit?usp=sharing
>
>  Thanks!
>
>
>  Lauri Kajan
> Software Developer
>
>  Karttakeskus Ltd.
> Atomitie 2
> 00370 Helsinki
> Finland
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttp://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/3ebe1931/attachment-0001.html>

From nhopton at gmail.com  Tue May 28 07:43:12 2013
From: nhopton at gmail.com (Nick Hopton)
Date: Tue, 28 May 2013 15:43:12 +0100
Subject: [gdal-dev] TIFs with TABs problem
Message-ID: <CA+Nt1_n1rrJtSRy0SS6-ifdGYvLmwW8W_jh1iWC9Ri4YmEYTjw@mail.gmail.com>

A friend, a relative newcomer to GIS, is having problems loading some of
the TIFs created with Mapinfo into QGIS. Each TIF has a TAB file and in
some cases the TAB file is interpreted correctly and in other cases the TAB
file is (apparently) not recognised.

I think this might be a problem with Gdal rather than a problem with QGIS.
Taking just two of the TIFs, the output from gdalinfo when run on
33044061.TIF indicates that things are working as they should. However,
when gdalinfo is run on 33044071.TIF the spatial data in its TAB file is
not recognised. See the listings below.

The strange thing is that all of the TIFs can successfully be converted
from TIF to GeoTIFF using gdalwarp. (But it is important to my friend that
he should be able to open Mapinfo raster images directly.)

Any ideas?

Regards,
Nick.


Contents of 33044061.TAB:
------------------------
!table
!version 300
!charset WindowsLatin1

Definition Table
  File "33044061.tif"
  Type "RASTER"
  (582429,263569) (1,7594) Label "Pt 1",
  (582372,265177) (1,0) Label "Pt 2",
  (584784,265263) (11335,1) Label "Pt 3",
  (584841,263655) (11335,7594) Label "Pt 4"
  CoordSys Earth Projection 8, 79, "m", -2, 49, 0.9996012717, 400000,
-100000
  Units "m"

Results of running gdalinfo on 33044061.TIF:
-------------------------------------------
nick at nick-6150M2MA:~/Desktop/tabstuff$ gdalinfo 33044061.TIF
Warning 1: TIFFFetchNormalTag:ASCII value for tag "ImageDescription"
contains null byte in value; value incorrectly truncated during reading due
to implementation limitations
Driver: GTiff/GeoTIFF
Files: 33044061.TIF
Size is 11335, 7594
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["OSGB_1936",
            SPHEROID["Airy 1930",6377563.396,299.3249646],
            TOWGS84[375,-111,431,-0,-0,-0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",49],
    PARAMETER["central_meridian",-2],
    PARAMETER["scale_factor",0.9996012717],
    PARAMETER["false_easting",400000],
    PARAMETER["false_northing",-100000],
    UNIT["Meter",1]]
GeoTransform =
  582371.785312838, 0.2128106799708935, 0.007506419931892793
  265177.0453393974, 0.007597130759524194, -0.2117600570261751
Metadata:
  TIFFTAG_IMAGEDESCRIPTION=
  TIFFTAG_XRESOLUTION=300
  TIFFTAG_YRESOLUTION=300
  TIFFTAG_MINSAMPLEVALUE=0
  TIFFTAG_MAXSAMPLEVALUE=1
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  COMPRESSION=CCITTFAX4
  INTERLEAVE=BAND
  MINISWHITE=YES
Corner Coordinates:
Upper Left  (  582371.785,  265177.045) (  0d40'19.83"E, 52d15'14.75"N)
Lower Left  (  582428.789,  263568.939) (  0d40'19.71"E, 52d14'22.68"N)
Upper Right (  584783.994,  265263.159) (  0d42'27.09"E, 52d15'14.63"N)
Lower Right (  584840.998,  263655.053) (  0d42'26.92"E, 52d14'22.57"N)
Center      (  583606.392,  264416.049) (  0d41'23.39"E, 52d14'48.66"N)
Band 1 Block=512x512 Type=Byte, ColorInterp=Palette
  Image Structure Metadata:
    NBITS=1
  Color Table (RGB with 2 entries)
    0: 255,255,255,255
    1: 0,0,0,255
nick at nick-6150M2MA:~/Desktop/tabstuff$

Contents of 33044071.TAB:
------------------------
!table
!version 300
!charset WindowsLatin1

Definition Table
  File "33044071.tif"
  Type "RASTER"
  (584841,263655) (1,7576) Label "Pt 1",
  (584784,265263) (1,0) Label "Pt 2",
  (587197,265349) (11335,1) Label "Pt 3",
  (587254,263740) (11335,7576) Label "Pt 4"
  CoordSys Earth Projection 8, 79, "m", -2, 49, 0.9996012717, 400000,
-100000
  Units "m"

Results of running gdalinfo on 33044071.TIF:
-------------------------------------------
nick at nick-6150M2MA:~/Desktop/tabstuff$ gdalinfo 33044071.TIF
Warning 1: TIFFFetchNormalTag:ASCII value for tag "ImageDescription"
contains null byte in value; value incorrectly truncated during reading due
to implementation limitations
Driver: GTiff/GeoTIFF
Files: 33044071.TIF
Size is 11335, 7576
Coordinate System is `'
GCP Projection =
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["OSGB_1936",
            SPHEROID["Airy 1930",6377563.396,299.3249646],
            TOWGS84[375,-111,431,-0,-0,-0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",49],
    PARAMETER["central_meridian",-2],
    PARAMETER["scale_factor",0.9996012717],
    PARAMETER["false_easting",400000],
    PARAMETER["false_northing",-100000],
    UNIT["Meter",1]]
GCP[  0]: Id=Pt 1, Info=
          (1,7576) -> (584841,263655,0)
GCP[  1]: Id=Pt 2, Info=
          (1,0) -> (584784,265263,0)
GCP[  2]: Id=Pt 3, Info=
          (11335,1) -> (587197,265349,0)
GCP[  3]: Id=Pt 4, Info=
          (11335,7576) -> (587254,263740,0)
Metadata:
  TIFFTAG_IMAGEDESCRIPTION=
  TIFFTAG_XRESOLUTION=300
  TIFFTAG_YRESOLUTION=300
  TIFFTAG_MINSAMPLEVALUE=0
  TIFFTAG_MAXSAMPLEVALUE=1
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  COMPRESSION=CCITTFAX4
  INTERLEAVE=BAND
  MINISWHITE=YES
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 7576.0)
Upper Right (11335.0,    0.0)
Lower Right (11335.0, 7576.0)
Center      ( 5667.5, 3788.0)
Band 1 Block=512x512 Type=Byte, ColorInterp=Palette
  Image Structure Metadata:
    NBITS=1
  Color Table (RGB with 2 entries)
    0: 255,255,255,255
    1: 0,0,0,255
nick at nick-6150M2MA:~/Desktop/tabstuff$

-- 
Nick Hopton, Caversham, Reading, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/562f242a/attachment.html>

From Tyler.Mitchell at actian.com  Tue May 28 07:38:58 2013
From: Tyler.Mitchell at actian.com (Tyler Mitchell)
Date: Tue, 28 May 2013 10:38:58 -0400
Subject: [gdal-dev] Calculating polygon area
In-Reply-To: <CADmC3azJ6PXVE_kcYqO1E7D24KASdnQn-y+5dcqRyJxUzqOrZA@mail.gmail.com>
References: <CADmC3azJ6PXVE_kcYqO1E7D24KASdnQn-y+5dcqRyJxUzqOrZA@mail.gmail.com>
Message-ID: <D1DA13B2-66FE-4454-9BAA-EA4028DD5683@actian.com>

Did you get square degrees back?  Project to a meter or feet based projection to get a measure more meaningful.  

Cheers,
Tyler

On 2013-05-28, at 7:14 AM, "Federico Jurio" <federicojurio at suremptec.com.ar> wrote:



	Dear all, here I am with one question which I'm sure has such a simple answer that I already feel embarassed in advance! Here goes anyway... I'm trying to calculate the area length on a GeoTIFF file using GetArea() method of OGRPolygon class and i'm not sure which is the unit that returns.

	This is the information about the raster dataset

	"GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.2572235630016,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0],UNIT[\"degree\",0.0174532925199433],AUTHORITY[\"EPSG\",\"4326\"]]"

	Thanks for your patience
	

	-- 
	
	Federico Jurio
	
	SUR Emprendimientos Tecnol?gicos
	

	Per? 345  Piso 5to Oficina "B" (C1067AAG)
	
	Ciudad de Buenos Aires, Argentina
	Tel. +54 (11) 4342-2976/84
	federicojurio at suremptec.com.ar
	www.suremptec.com

	_______________________________________________
	gdal-dev mailing list
	gdal-dev at lists.osgeo.org
	http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/4bab49fd/attachment.html>

From gdal at stripfamily.net  Tue May 28 08:25:35 2013
From: gdal at stripfamily.net (David Strip)
Date: Tue, 28 May 2013 09:25:35 -0600
Subject: [gdal-dev] What's the best way to fix an incorrect projection in a
	geotiff
Message-ID: <51A4CC6F.6030806@stripfamily.net>

I have a geotiff that contains data in Penn. State-Plane, but the 
coordinate system is listed as GCS WGS84. What's the best way to fix 
this, esp if I have multiple files with this problem?
I can use listgeo to get a file of the all the tags, edit the coordinate 
system to the correct value, then use tiffcp on each file to strip out 
the tags and then use geotifcp to put back the correct ones, but I 
suspect there's a better way, perhaps using gdalwarp with the -to option 
set to override the input SRS, creating a trivial warp? Or maybe 
something simpler that I'm not seeing.
thanks
David



From warmerdam at pobox.com  Tue May 28 08:38:26 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 28 May 2013 08:38:26 -0700
Subject: [gdal-dev] What's the best way to fix an incorrect projection
 in a geotiff
In-Reply-To: <51A4CC6F.6030806@stripfamily.net>
References: <51A4CC6F.6030806@stripfamily.net>
Message-ID: <CA+YzLBfPZyp3oRRj-hXpkp_jzrFE2SendU+KOAfwSPEATzYBrg@mail.gmail.com>

David,

The simpliest way of correcting the coordinate system might be something
like:

  gdal_translate -a_srs EPSG:27700 wrong.tif right.tif

This assumes the coordinates are ok.  This does result in copying the whole
image and repacking it but avoids any resampling that might occur with
gdalwarp.

Best regards,
Frank



On Tue, May 28, 2013 at 8:25 AM, David Strip <gdal at stripfamily.net> wrote:

> I have a geotiff that contains data in Penn. State-Plane, but the
> coordinate system is listed as GCS WGS84. What's the best way to fix this,
> esp if I have multiple files with this problem?
> I can use listgeo to get a file of the all the tags, edit the coordinate
> system to the correct value, then use tiffcp on each file to strip out the
> tags and then use geotifcp to put back the correct ones, but I suspect
> there's a better way, perhaps using gdalwarp with the -to option set to
> override the input SRS, creating a trivial warp? Or maybe something simpler
> that I'm not seeing.
> thanks
> David
>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/8eb26071/attachment-0001.html>

From gdal at stripfamily.net  Tue May 28 08:51:04 2013
From: gdal at stripfamily.net (David Strip)
Date: Tue, 28 May 2013 09:51:04 -0600
Subject: [gdal-dev] What's the best way to fix an incorrect projection
 in a geotiff
In-Reply-To: <CA+YzLBfPZyp3oRRj-hXpkp_jzrFE2SendU+KOAfwSPEATzYBrg@mail.gmail.com>
References: <51A4CC6F.6030806@stripfamily.net>
	<CA+YzLBfPZyp3oRRj-hXpkp_jzrFE2SendU+KOAfwSPEATzYBrg@mail.gmail.com>
Message-ID: <51A4D268.9020902@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/27070643/attachment.html>

From pedrocostaarma at sapo.pt  Tue May 28 09:19:41 2013
From: pedrocostaarma at sapo.pt (Pedro Costa)
Date: Tue, 28 May 2013 17:19:41 +0100
Subject: [gdal-dev] select shapes in a folder by geometry type
In-Reply-To: <CACqBkM_sWOSkaP8y08Ueb5c24ex5DXHUwCRHtYHb2aHLN+OUJA@mail.gmail.com>
References: <519F9416.5030802@sapo.pt>
	<CACqBkM_POLkofKjRD2CgCe6RxpTwfWgQT1PW89Bg8G4HAK1V1g@mail.gmail.com>
	<519F9D61.20704@sapo.pt>
	<CACqBkM_sWOSkaP8y08Ueb5c24ex5DXHUwCRHtYHb2aHLN+OUJA@mail.gmail.com>
Message-ID: <51A4D91D.60107@sapo.pt>

I was getting confused between version 1.1+ and 1.10+.
Aftercompile the latest, and used the '-dim' option worked.

thank you :-)









Em 24-05-2013 18:19, Eli Adam escreveu:
>> [1] ogr2ogr -f "ESRI Shapefile" -dim 2 pontos_2d.shp ocup_ilegal.shp
> Yes just like this.
>
>> With this command don't work. I'm using 1.9 version but the '-dim' option
>> don't show up if i type  'ogr2ogr --long-usage'.
> It is only in GDAL 1.10+ so it will not work in 1.9.
>
> Eli
>
>>
>> Em 24-05-2013 17:44, Eli Adam escreveu:
>>
>>> If you are using a recent version can you ignore geometry type and use
>>> the -dim 2 switch?
>>>
>>> -dim val:(starting with GDAL 1.10) Force the coordinate dimension to
>>> val (valid values are 2 or 3). This affects both the layer geometry
>>> type, and feature geometries.
>>>
>>> Best Regards, Eli
>>>
>>>
>>> On Fri, May 24, 2013 at 9:23 AM, Pedro Costa <pedrocostaarma at sapo.pt>
>>> wrote:
>>>> Hi guys,
>>>>
>>>> I'm trying  to make a script that converts 3d shapefiles to 2d.
>>>> I'm using the loop 'for...do'' and this command:
>>>>
>>>> 'ogr2ogr -f "ESRI Shapefile" -nlt POINT 2d_points/$shp $shp'
>>>>
>>>> My problem is that i don't  know how to select only shapefiles of points,
>>>> and next only polygons, and next only lines to put the right geometry in
>>>> the
>>>> command.
>>>> For example, i have tried the '-where "OGR_GEOMETRY='Point'"'  like that:
>>>>
>>>> ogr2ogr -where "OGR_GEOMETRY='Point'" -f "ESRI Shapefile" -nlt POLYGON
>>>> 2d_poligonos/$shp $shp
>>>>
>>>> But don't work because ogr converts shapefiles of polygons and lines into
>>>> points!
>>>>
>>>> Can anyone tell me how i can select  only shapefiles of points in a
>>>> folder
>>>> with many shapefiles of many geometry types?
>>>>
>>>> Thanks
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Tue May 28 09:35:57 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 28 May 2013 18:35:57 +0200
Subject: [gdal-dev] What's the best way to fix an incorrect projection
	in a geotiff
In-Reply-To: <51A4CC6F.6030806@stripfamily.net>
References: <51A4CC6F.6030806@stripfamily.net>
Message-ID: <1369758957.51a4dced89066@imp.free.fr>

Selon David Strip <gdal at stripfamily.net>:

> I have a geotiff that contains data in Penn. State-Plane, but the
> coordinate system is listed as GCS WGS84. What's the best way to fix
> this, esp if I have multiple files with this problem?
> I can use listgeo to get a file of the all the tags, edit the coordinate
> system to the correct value, then use tiffcp on each file to strip out
> the tags and then use geotifcp to put back the correct ones, but I
> suspect there's a better way, perhaps using gdalwarp with the -to option
> set to override the input SRS, creating a trivial warp? Or maybe
> something simpler that I'm not seeing.

You can use the gdal_edit utility with the -a_srs option. See
http://www.gdal.org/gdal_edit.html

> thanks
> David
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From warmerdam at pobox.com  Tue May 28 10:15:06 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 28 May 2013 10:15:06 -0700
Subject: [gdal-dev] TIFs with TABs problem
In-Reply-To: <CA+Nt1_n1rrJtSRy0SS6-ifdGYvLmwW8W_jh1iWC9Ri4YmEYTjw@mail.gmail.com>
References: <CA+Nt1_n1rrJtSRy0SS6-ifdGYvLmwW8W_jh1iWC9Ri4YmEYTjw@mail.gmail.com>
Message-ID: <CA+YzLBf1MayvTS1SuE6uw00cRx_JrurnDcQS-fVYiDbFhTO5Tg@mail.gmail.com>

Nick,

I haven't tried the .TAB files locally, but I see they are both resulting
in georeferencing info.  The one is expressed as a geotransform with
rotation and shear while the other is expressed as ground control points.

I believe that the .TAB reader attempts to compute a geotransform from the
points in the TAB and if it can do so with minimal error then that is what
is returned - a solution easier to utilize in QGIS and other applications.

If the control points do not represent a clean affine transformation for
the image then it falls back to returning them as ground control points
which relatively few applications can utilize directly.

One "solution" is to run gdalwarp to transform the image that isn't
currently working so well into a north up affine transformation style
image.

eg.

gdalwarp 33044071.TIF 33044071_northup.TIF

This warp will be done using the control points (ironically also using a
best fit first order polynomial).

The code responsible for the decision is this from gdal/gcore/gdal_misc.cpp:

/* -------------------------------------------------------------------- */
/*      Try to convert the GCPs into a geotransform definition, if      */
/*      possible.  Otherwise we will need to use them as GCPs.          */
/* -------------------------------------------------------------------- */
    if( !GDALGCPsToGeoTransform( nCoordinateCount, asGCPs,
padfGeoTransform,
                                 FALSE ) )
    {
        if (pnGCPCount && ppasGCPs)
        {
            CPLDebug( "GDAL",
                "GDALLoadTabFile(%s) found file, wasn't able to derive a\n"
                "first order geotransform.  Using points as GCPs.",
                pszFilename );

            *ppasGCPs = (GDAL_GCP *)
                CPLCalloc( sizeof(GDAL_GCP),nCoordinateCount );
            memcpy( *ppasGCPs, asGCPs, sizeof(GDAL_GCP) * nCoordinateCount
);
            *pnGCPCount = nCoordinateCount;
        }
    }
    else
    {
        GDALDeinitGCPs( nCoordinateCount, asGCPs );
    }

I suspect if you change the FALSE to TRUE in the arguments to
GDALGCPsToGeoTransform() you wlil always get an affine transform even when
it is not a very good fit.


Best regards,
Frank


On Tue, May 28, 2013 at 7:43 AM, Nick Hopton <nhopton at gmail.com> wrote:

> A friend, a relative newcomer to GIS, is having problems loading some of
> the TIFs created with Mapinfo into QGIS. Each TIF has a TAB file and in
> some cases the TAB file is interpreted correctly and in other cases the TAB
> file is (apparently) not recognised.
>
> I think this might be a problem with Gdal rather than a problem with QGIS.
> Taking just two of the TIFs, the output from gdalinfo when run on
> 33044061.TIF indicates that things are working as they should. However,
> when gdalinfo is run on 33044071.TIF the spatial data in its TAB file is
> not recognised. See the listings below.
>
> The strange thing is that all of the TIFs can successfully be converted
> from TIF to GeoTIFF using gdalwarp. (But it is important to my friend that
> he should be able to open Mapinfo raster images directly.)
>
> Any ideas?
>
> Regards,
> Nick.
>
>
> Contents of 33044061.TAB:
> ------------------------
> !table
> !version 300
> !charset WindowsLatin1
>
> Definition Table
>   File "33044061.tif"
>   Type "RASTER"
>   (582429,263569) (1,7594) Label "Pt 1",
>   (582372,265177) (1,0) Label "Pt 2",
>   (584784,265263) (11335,1) Label "Pt 3",
>   (584841,263655) (11335,7594) Label "Pt 4"
>   CoordSys Earth Projection 8, 79, "m", -2, 49, 0.9996012717, 400000,
> -100000
>   Units "m"
>
> Results of running gdalinfo on 33044061.TIF:
> -------------------------------------------
> nick at nick-6150M2MA:~/Desktop/tabstuff$ gdalinfo 33044061.TIF
> Warning 1: TIFFFetchNormalTag:ASCII value for tag "ImageDescription"
> contains null byte in value; value incorrectly truncated during reading due
> to implementation limitations
> Driver: GTiff/GeoTIFF
> Files: 33044061.TIF
> Size is 11335, 7594
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["unnamed",
>         DATUM["OSGB_1936",
>             SPHEROID["Airy 1930",6377563.396,299.3249646],
>             TOWGS84[375,-111,431,-0,-0,-0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",49],
>     PARAMETER["central_meridian",-2],
>     PARAMETER["scale_factor",0.9996012717],
>     PARAMETER["false_easting",400000],
>     PARAMETER["false_northing",-100000],
>     UNIT["Meter",1]]
> GeoTransform =
>   582371.785312838, 0.2128106799708935, 0.007506419931892793
>   265177.0453393974, 0.007597130759524194, -0.2117600570261751
> Metadata:
>   TIFFTAG_IMAGEDESCRIPTION=
>   TIFFTAG_XRESOLUTION=300
>   TIFFTAG_YRESOLUTION=300
>   TIFFTAG_MINSAMPLEVALUE=0
>   TIFFTAG_MAXSAMPLEVALUE=1
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   COMPRESSION=CCITTFAX4
>   INTERLEAVE=BAND
>   MINISWHITE=YES
> Corner Coordinates:
> Upper Left  (  582371.785,  265177.045) (  0d40'19.83"E, 52d15'14.75"N)
> Lower Left  (  582428.789,  263568.939) (  0d40'19.71"E, 52d14'22.68"N)
> Upper Right (  584783.994,  265263.159) (  0d42'27.09"E, 52d15'14.63"N)
> Lower Right (  584840.998,  263655.053) (  0d42'26.92"E, 52d14'22.57"N)
> Center      (  583606.392,  264416.049) (  0d41'23.39"E, 52d14'48.66"N)
> Band 1 Block=512x512 Type=Byte, ColorInterp=Palette
>   Image Structure Metadata:
>     NBITS=1
>   Color Table (RGB with 2 entries)
>     0: 255,255,255,255
>     1: 0,0,0,255
> nick at nick-6150M2MA:~/Desktop/tabstuff$
>
> Contents of 33044071.TAB:
> ------------------------
> !table
> !version 300
> !charset WindowsLatin1
>
> Definition Table
>   File "33044071.tif"
>   Type "RASTER"
>   (584841,263655) (1,7576) Label "Pt 1",
>   (584784,265263) (1,0) Label "Pt 2",
>   (587197,265349) (11335,1) Label "Pt 3",
>   (587254,263740) (11335,7576) Label "Pt 4"
>   CoordSys Earth Projection 8, 79, "m", -2, 49, 0.9996012717, 400000,
> -100000
>   Units "m"
>
> Results of running gdalinfo on 33044071.TIF:
> -------------------------------------------
> nick at nick-6150M2MA:~/Desktop/tabstuff$ gdalinfo 33044071.TIF
> Warning 1: TIFFFetchNormalTag:ASCII value for tag "ImageDescription"
> contains null byte in value; value incorrectly truncated during reading due
> to implementation limitations
> Driver: GTiff/GeoTIFF
> Files: 33044071.TIF
> Size is 11335, 7576
> Coordinate System is `'
> GCP Projection =
> PROJCS["unnamed",
>     GEOGCS["unnamed",
>         DATUM["OSGB_1936",
>             SPHEROID["Airy 1930",6377563.396,299.3249646],
>             TOWGS84[375,-111,431,-0,-0,-0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",49],
>     PARAMETER["central_meridian",-2],
>     PARAMETER["scale_factor",0.9996012717],
>     PARAMETER["false_easting",400000],
>     PARAMETER["false_northing",-100000],
>     UNIT["Meter",1]]
> GCP[  0]: Id=Pt 1, Info=
>           (1,7576) -> (584841,263655,0)
> GCP[  1]: Id=Pt 2, Info=
>           (1,0) -> (584784,265263,0)
> GCP[  2]: Id=Pt 3, Info=
>           (11335,1) -> (587197,265349,0)
> GCP[  3]: Id=Pt 4, Info=
>           (11335,7576) -> (587254,263740,0)
> Metadata:
>   TIFFTAG_IMAGEDESCRIPTION=
>   TIFFTAG_XRESOLUTION=300
>   TIFFTAG_YRESOLUTION=300
>   TIFFTAG_MINSAMPLEVALUE=0
>   TIFFTAG_MAXSAMPLEVALUE=1
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   COMPRESSION=CCITTFAX4
>   INTERLEAVE=BAND
>   MINISWHITE=YES
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 7576.0)
> Upper Right (11335.0,    0.0)
> Lower Right (11335.0, 7576.0)
> Center      ( 5667.5, 3788.0)
> Band 1 Block=512x512 Type=Byte, ColorInterp=Palette
>   Image Structure Metadata:
>     NBITS=1
>   Color Table (RGB with 2 entries)
>     0: 255,255,255,255
>     1: 0,0,0,255
> nick at nick-6150M2MA:~/Desktop/tabstuff$
>
> --
> Nick Hopton, Caversham, Reading, England.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/90bb4d38/attachment-0001.html>

From ari.jolma at gmail.com  Tue May 28 10:47:38 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 28 May 2013 20:47:38 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<51A4BB0E.4020908@gmail.com>
	<CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>
Message-ID: <51A4EDBA.5010607@gmail.com>

On 05/28/2013 05:34 PM, Lauri Kajan wrote:
> Hi Ari,
>
> I think that shouldn't be neccessary.
> The gml file points to the xsd schema file 
> (http://xml.nls.fi/XML/Schema/Maastotietojarjestelma/MTK/201202/Maastotiedot.xsd).
> In this schema those tags are defined to be "aliases" for these known 
> gml tags by using the substitutionGroup. So actually that 
> <Maastotiedot> is a <gml:FeatureCollection>. Is this supported by OGR?

I think GDAL wants the xsd to be local file for GML files. However, I 
tried this and I can see GDAL finding the xsd, but failing the overall 
process. Further, it seems that GDAL does not recognize the XML include tag.

Anyway, I assume it is not a simple substitution as all features should 
be wrapped into gml:featureMember elements.

Ari

>
> I'm not an xml/gml expert either so it's hard to find the problem.
>
> -Lauri
>
>
>
>
>
> On Tue, May 28, 2013 at 5:11 PM, Ari Jolma <ari.jolma at gmail.com 
> <mailto:ari.jolma at gmail.com>> wrote:
>
>     Lauri,
>
>     There are at least these issues with the file:
>
>     - Piste should be gml:Point
>     - Murtoviiva should be gml:LineString
>     - Alue should be gml:Polygon
>     - all features should be wrapped into gml:featureMember elements
>     - everything should be in gml:FeatureCollection
>     - complex geometries should be wrapped into gml:GeometryCollection
>     elements
>
>     With these changes and limitations I can open (a small piece) of
>     the file with ogrinfo. All are probably changeable by XSLT. Of
>     course my knowledge about GML and it's parsing in GDAL is limited,
>     so take this with a grain of salt.
>
>     Cheers,
>
>     Ari
>
>     the changed piece:
>
>     <?xml version="1.0" encoding="UTF-8"?>
>     <gml:FeatureCollection xmlns:gml="http://www.opengis.net/gml"
>     <http://www.opengis.net/gml>>
>     <harvatLouhikot>
>         <gml:featureMember>
>             <HarvaLouhikko gid="733051928" dimension="3">
>     <sijaintitarkkuus>10000</sijaintitarkkuus>
>     <korkeustarkkuus>100001</korkeustarkkuus>
>                 <aineistolahde>1</aineistolahde>
>                 <alkupvm>2005-11-15</alkupvm>
>                 <suunta>0</suunta>
>                 <sijainti>
>                     <gml:Point>
>                         <gml:pos srsDimension="3">368845.895
>     7588505.642 308.292</gml:pos>
>                     </gml:Point>
>                 </sijainti>
>                 <kohderyhma>13</kohderyhma>
>                 <kohdeluokka>34200</kohdeluokka>
>             </HarvaLouhikko>
>             </gml:featureMember>
>         </harvatLouhikot>
>     <hietikot>
>         <gml:featureMember>
>             <Hietikko gid="775477697" dimension="3">
>     <sijaintitarkkuus>5000</sijaintitarkkuus>
>                 <aineistolahde>1</aineistolahde>
>                 <alkupvm>2005-11-15</alkupvm>
>                 <sijainti>
>                 <gml:GeometryCollection>
>                 <gml:geometryMember>
>                     <gml:Point>
>                         <gml:pos srsDimension="3">368010.039
>     7584945.893 0.000</gml:pos>
>                     </gml:Point>
>                     </gml:geometryMember>
>                     <gml:geometryMember>
>                     <gml:Polygon>
>                         <gml:exterior>
>                             <gml:LinearRing>
>                                 <gml:posList
>     srsDimension="3">368000.000 7584931.821 370.229 368000.000
>     7584936.222 369.780 368001.115 7584941.126 368.906 368002.650
>     7584954.132 364.859 368002.478 7584969.653 361.051 368008.553
>     7584975.749 359.563 368016.839 7584970.791 359.517 368019.890
>     7584958.174 360.232 368023.171 7584944.026 362.917 368022.143
>     7584935.253 365.008 368016.168 7584924.893 368.340 368004.859
>     7584923.913 369.824 368000.000 7584931.821 370.229</gml:posList>
>                             </gml:LinearRing>
>                         </gml:exterior>
>                     </gml:Polygon>
>                     </gml:geometryMember>
>                     </gml:GeometryCollection>
>                 </sijainti>
>                 <kohderyhma>64</kohderyhma>
>                 <kohdeluokka>34300</kohdeluokka>
>             </Hietikko>
>             </gml:featureMember>
>         </hietikot>
>     </gml:FeatureCollection>
>
>
>
>     On 05/28/2013 02:06 PM, Lauri Kajan wrote:
>>     Hello everybody,
>>
>>     I have tired to read gml file from National Land Suvey of Finnish
>>     without a success.
>>     Does anybody have any idea what's the problem?
>>
>>     The gml has a quite complex schema. Is this a problem for ogr?
>>     I have tried to download all the schema files to the same folder
>>     with the same name than the file but it doesn't work.
>>
>>
>>     Here is a sample:
>>     https://docs.google.com/file/d/0BwbdYcPHdb1pOEs1eGNiZnBhMUk/edit?usp=sharing
>>
>>
>>     Thanks!
>>
>>
>>     Lauri Kajan
>>     Software Developer
>>
>>     Karttakeskus Ltd.
>>     Atomitie 2
>>     00370 Helsinki
>>     Finland
>>
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org  <mailto:gdal-dev at lists.osgeo.org>
>>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/bff6a8e7/attachment.html>

From feumar at shaw.ca  Tue May 28 10:49:40 2013
From: feumar at shaw.ca (Martin Feuchtwanger)
Date: Tue, 28 May 2013 10:49:40 -0700
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <loom.20130527T163158-922@post.gmane.org>
References: <loom.20130527T163158-922@post.gmane.org>
Message-ID: <51A4EE34.1000900@shaw.ca>

I was having a similar complaint (which i kept to myself at the time) 
when using *ogr2ogr*.  In my case, converting GDB file to PG database.

First i used some flags, -a_srs -lco -nln, but these turned out to be a 
massive waste of time (several orders of magnitude). So instead i kept 
to the defaults and made desired changes manually after the fact, in the DB.

Maybe there should be some stern warnings in the documentation when 
"luxury" options are computationally expensive? Then users would be less 
likely to judge ogr2ogr as a poor performer.

Martin Feuchtwanger  feumar at shaw.ca  604-254-0361
Vancouver, BC  V5N 1J6
http://members.shaw.ca/geomatics.developer

On 27/05/2013 7:47 AM, Jukka Rahkonen wrote:
> I have measured a huge speed difference by running the same conversion from
> OSM data file into PostGIS either with or without using the -skipfailures
> parameter.
>
> Without -skipfailures conversion takes about two minutes but if I add the
> parameter it takes at least two hours. The command I used is this
>
> ogr2ogr -f PostgreSQL PG:"dbname='gis' host='server' port='4326' user='user'
> password='passwd'" finland.osm.pbf -gt 20000 -progress
> --config OSM_COMPRESS_NODES YES  -lco DIM=2 -lco geometry_name=geoloc
> -lco fid=fid -skipfailures  --config PG_USE_COPY YES
>
> I wonder if it really needs to be so slow. My guess is that -skipfailures
> somehow invalidates my -gt 20000 parameter.
>
> -Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/3ce52cd3/attachment-0001.html>

From even.rouault at mines-paris.org  Tue May 28 10:59:09 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 28 May 2013 19:59:09 +0200
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <CA+TxYvMKRwZnrOoHLEAjcQYnds6dWF62WFn4GtTGE-VhL7kJYA@mail.gmail.com>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<0BCDAF9D-A851-4CFD-B07D-A062C679323D@gmail.com>
	<CA+TxYvMKRwZnrOoHLEAjcQYnds6dWF62WFn4GtTGE-VhL7kJYA@mail.gmail.com>
Message-ID: <201305281959.09252.even.rouault@mines-paris.org>

Le mardi 28 mai 2013 16:27:21, Etienne Tourigny a ?crit :
> On Tue, May 28, 2013 at 11:24 AM, Howard Butler <hobu.inc at gmail.com> wrote:
> > On May 26, 2013, at 9:46 AM, Even Rouault <even.rouault at mines-paris.org>
> > 
> > wrote:
> > > This file is the source code for a standalone shared library that can
> > > be LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API
> > > to
> > 
> > be used
> > 
> > > with binaries using regular libc I/O API.
> > > 
> > > This can work with all VSI Large File API filesystems : /vsizip/ ,
> > 
> > /vsitar/,
> > 
> > > /vsisubfile/ , etc...
> > 
> > Cool!
> 
> Way cool, Even! I'll test it when I have the time.
> 
> > Next question, if you'll pardon my ignorance, why would we ever want to
> > do this? What does the VSI preload provide?
> 
> You can open files over ftp/http connexions and files that are compressed
> inside zip/tgz/gz archives. This was not previously possible with certain
> drivers (hdf4, netcdf, etc.)

Yes exactly, my examples were supposed to illustrate the use cases where it 
was needed. A few drivers do not support the /vsi file systems because they use 
directly the standard IO functions and provide no way of redirecting them 
through the VSI virtual file API, because their underlying library doesn't offer 
this capability.

An alternate way of offering the same capability would be to write a fuse 
module (would probably be less hackish) since the API of fuse modules is much 
more limited than the one of glibc (you have only one read function not read() 
and fread() )!

> 
> > Howard
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Tue May 28 11:16:48 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 28 May 2013 20:16:48 +0200
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <51A4EE34.1000900@shaw.ca>
References: <loom.20130527T163158-922@post.gmane.org>
	<51A4EE34.1000900@shaw.ca>
Message-ID: <201305282016.48057.even.rouault@mines-paris.org>

Le mardi 28 mai 2013 19:49:40, Martin Feuchtwanger a ?crit :
> I was having a similar complaint (which i kept to myself at the time)
> when using *ogr2ogr*.  In my case, converting GDB file to PG database.
> 
> First i used some flags, -a_srs -lco -nln, but these turned out to be a
> massive waste of time (several orders of magnitude). So instead i kept
> to the defaults and made desired changes manually after the fact, in the
> DB.

Martin,

Are you really sure about that ? This would be interesting if you could 
demonstrate that with examples. My belief is that -a_srs and -nln cost should 
be near 0 compared not to using them. They are only used to setup layer 
creation. The effect of -lco of course depends on the option and driver used, 
so there's no general rule to draw about this one.

> 
> Maybe there should be some stern warnings in the documentation when
> "luxury" options are computationally expensive?

We also accept documentation contributions :-) But performance depends 
sometimes on many factors and it is difficult to capture them.

> Then users would be less
> likely to judge ogr2ogr as a poor performer.

I believe that ogr2ogr is generally considered as a good performer. But 
funding can sometimes help implementing improvements :-)

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Tue May 28 13:40:20 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 28 May 2013 22:40:20 +0200
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <51A4EDBA.5010607@gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>
	<51A4EDBA.5010607@gmail.com>
Message-ID: <201305282240.20555.even.rouault@mines-paris.org>

Le mardi 28 mai 2013 19:47:38, Ari Jolma a ?crit :
> On 05/28/2013 05:34 PM, Lauri Kajan wrote:
> > Hi Ari,
> > 
> > I think that shouldn't be neccessary.
> > The gml file points to the xsd schema file
> > (http://xml.nls.fi/XML/Schema/Maastotietojarjestelma/MTK/201202/Maastotie
> > dot.xsd). In this schema those tags are defined to be "aliases" for these
> > known gml tags by using the substitutionGroup. So actually that
> > <Maastotiedot> is a <gml:FeatureCollection>. Is this supported by OGR?
> 
> I think GDAL wants the xsd to be local file for GML files. However, I
> tried this and I can see GDAL finding the xsd, but failing the overall
> process. Further, it seems that GDAL does not recognize the XML include
> tag.
> 
> Anyway, I assume it is not a simple substitution as all features should
> be wrapped into gml:featureMember elements.

Lauri,

Generic GML reading is a very complicated task, since it can model very 
complex data organizations that cannot be represented trivially in the OGR 
data model. Basically the GML reader in OGR is limited to GML documents 
respecting Simple Feature profiles ( GML 3.1.1 simple features profile - OGC(R) 
06-049r1 ). The XSD parser in the GML reader has similar limitations.

The GML reader only tries to analyze the .xsd if it has the same basename as 
the .gml document. Starting with OGR 1.10, you can specify as datasource name 
something like "foo.gml,xsd=bar.xsd". In that instance, Maastotiedot.xsd is 
too complex for the XSD parser to be analyzed. And as the naming of elements 
in the GML doesn't match the hard coded convention of the OGR GML driver 
("somethingMember" elements, usual names for GML geometry elements), the 
autodiscovery of the schema fails also.

However when looking at the GML itself, it should be possible with moderate 
tweaking to make the GML driver aware of the structure of that particular 
schema (provided that it is worth the effort, i.e. there are a significant 
number of GML files following that schema, which must likely be the case if it 
is a sample of the National Land Suvey of Finnish), since it is close from 
what it can understand currently. It has already been done in similar 
situations.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/a73197d5/attachment.html>

From hobu.inc at gmail.com  Tue May 28 14:18:46 2013
From: hobu.inc at gmail.com (Howard Butler)
Date: Tue, 28 May 2013 16:18:46 -0500
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <201305281959.09252.even.rouault@mines-paris.org>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<0BCDAF9D-A851-4CFD-B07D-A062C679323D@gmail.com>
	<CA+TxYvMKRwZnrOoHLEAjcQYnds6dWF62WFn4GtTGE-VhL7kJYA@mail.gmail.com>
	<201305281959.09252.even.rouault@mines-paris.org>
Message-ID: <9760C3B4-6061-4DD9-8E27-12A6D01FFB92@gmail.com>


On May 28, 2013, at 12:59 PM, Even Rouault <even.rouault at mines-paris.org> wrote:
> Yes exactly, my examples were supposed to illustrate the use cases where it 
> was needed. A few drivers do not support the /vsi file systems because they use 
> directly the standard IO functions and provide no way of redirecting them 
> through the VSI virtual file API, because their underlying library doesn't offer 
> this capability.

Sorry I didn't read far enough down to the examples. I saw "preload" and ".so" and immediately thought of symbol chicanery in the context of tracking memory allocations and the like, not twisting curl'able datasources into FILE*'s.

Now that I have your attention, I brought up with Frank at FOSS4GNA that there could sometimes be a need for both MEM drivers to spool off to disk through some sort of out-of-core mmap'd allocation. Does this currently exist in VSI, and if not, do you see any use for such a thing? My thought was there might be scenarios where someone working with multi-gb (or worse) raster data sources where you'd like to control the paging (ie, you have SSD, or you want to create intermediates for some weird processing chain). Maybe not all that useful in exchange for the added complexity...

Howard

From etourigny.dev at gmail.com  Tue May 28 14:57:44 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 28 May 2013 18:57:44 -0300
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <201305261646.31371.even.rouault@mines-paris.org>
References: <201305261646.31371.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvNn5jjzrg9ZFQS8JnJA3HMf6C5nT8-4_Ttzfg17iYGeiA@mail.gmail.com>

On Sun, May 26, 2013 at 11:46 AM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Hi,
>
> I've just commited in trunk a new file port/vsipreload.cpp.
>
> This file is the source code for a standalone shared library that can be
> LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API to be
> used
> with binaries using regular libc I/O API.
>
> WARNING: Linux glibc ONLY. Might work with some adaptations (mainly around
> 64bit symbols) on other Unix systems
>
> Compile:
> g++ -Wall -fPIC port/vsipreload.cpp -shared -o vsipreload.so -Iport \
>         -L. -L.libs -lgdal
>
> Examples :
>
> LD_PRELOAD=vsipreload.so gdalinfo \
>         /vsicurl/http://download.osgeo.org/gdal/data/ecw/spif83.ecw


Even,

I have built vsipreload with a fresh build of svn trunk, but I get the
following error:

$ g++ -Wall -fPIC port/vsipreload.cpp -shared -o vsipreload.so -Iport -L.
-L.libs -lgdal
$ LD_PRELOAD=vsipreload.so gdalinfo         /vsicurl/
http://download.osgeo.org/gdal/data/ecw/spif83.ecw
ERROR: ld.so: object 'vsipreload.so' from LD_PRELOAD cannot be preloaded:
ignored.
ERROR 4: `/vsicurl/http://download.osgeo.org/gdal/data/ecw/spif83.ecw' not
recognised as a supported file format.

gdalinfo failed - unable to open '/vsicurl/
http://download.osgeo.org/gdal/data/ecw/spif83.ecw'.

Is there a way to find out why it cannot be preloaded? Perhaps the
compilation options should be tweaked?

Thanks,
Etienne

My system is Linux Mint 13 ubuntu (quantal), gcc version 4.7.2, 64bits,
3.5.0-30-generic kernel


>
> LD_PRELOAD=vsipreload.so gdalinfo \
>  'HDF4_EOS:EOS_GRID:"/vsicurl/
> http://download.osgeo.org/gdal/data/hdf4/MOD09Q1G_EVI.A2006233.h07v03.005.2008338190308.hdf
> ":MODIS_NACP_EVI:MODIS_EVI'
>
> LD_PRELOAD=vsipreload.so ogrinfo \
>          /vsicurl/
> http://svn.osgeo.org/gdal/trunk/autotest/ogr/data/testavc -ro
>
> LD_PRELOAD=vsipreload.so ogrinfo -ro \
>
> /vsizip//vsicurl/
> http://download.osgeo.org/gdal/1.10.0/gdalautotest-1.10.0.zip/gdalautotest-1.10.0/ogr/data/testavc
>
> It can work even with non GDAL binaries :
>
> LD_PRELOAD=vsipreload.so h5dump -d /x \
>         /vsicurl/
> http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
>
> LD_PRELOAD=vsipreload.so sqlite3 \
>          /vsicurl/http://download.osgeo.org/gdal/data/sqlite3/polygon.db \
>         "select * from polygon limit 10"
>
> This can work with all VSI Large File API filesystems : /vsizip/ ,
> /vsitar/,
> /vsisubfile/ , etc...
>
> This is still a bit experimental in the sense that only the most common
> glibc
> I/O API have been overloaded. If exotic ones are used with /vsi files,
> crashes
> are likely.
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/2b03e8c3/attachment.html>

From etourigny.dev at gmail.com  Tue May 28 15:13:35 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 28 May 2013 19:13:35 -0300
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <CA+TxYvNn5jjzrg9ZFQS8JnJA3HMf6C5nT8-4_Ttzfg17iYGeiA@mail.gmail.com>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<CA+TxYvNn5jjzrg9ZFQS8JnJA3HMf6C5nT8-4_Ttzfg17iYGeiA@mail.gmail.com>
Message-ID: <CA+TxYvPxg1k6hZCcKmbPcCvd_X_aEvNN4XbsbgyyWTkCRenaSQ@mail.gmail.com>

On Tue, May 28, 2013 at 6:57 PM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

>
>
> On Sun, May 26, 2013 at 11:46 AM, Even Rouault <
> even.rouault at mines-paris.org> wrote:
>
>> Hi,
>>
>> I've just commited in trunk a new file port/vsipreload.cpp.
>>
>> This file is the source code for a standalone shared library that can be
>> LD_PRELOAD'ed as an overload of libc to enable VSI Virtual FILE API to be
>> used
>> with binaries using regular libc I/O API.
>>
>> WARNING: Linux glibc ONLY. Might work with some adaptations (mainly around
>> 64bit symbols) on other Unix systems
>>
>> Compile:
>> g++ -Wall -fPIC port/vsipreload.cpp -shared -o vsipreload.so -Iport \
>>         -L. -L.libs -lgdal
>>
>> Examples :
>>
>> LD_PRELOAD=vsipreload.so gdalinfo \
>>         /vsicurl/http://download.osgeo.org/gdal/data/ecw/spif83.ecw
>
>
> Even,
>
> I have built vsipreload with a fresh build of svn trunk, but I get the
> following error:
>
> $ g++ -Wall -fPIC port/vsipreload.cpp -shared -o vsipreload.so -Iport -L.
> -L.libs -lgdal
> $ LD_PRELOAD=vsipreload.so gdalinfo         /vsicurl/
> http://download.osgeo.org/gdal/data/ecw/spif83.ecw
> ERROR: ld.so: object 'vsipreload.so' from LD_PRELOAD cannot be preloaded:
> ignored.
> ERROR 4: `/vsicurl/http://download.osgeo.org/gdal/data/ecw/spif83.ecw'
> not recognised as a supported file format.
>
> gdalinfo failed - unable to open '/vsicurl/
> http://download.osgeo.org/gdal/data/ecw/spif83.ecw'.
>
> Is there a way to find out why it cannot be preloaded? Perhaps the
> compilation options should be tweaked?
>

I have managed to get it working buy using LD_PRELOAD=./vsipreload.so

e.g.
LD_PRELOAD=./vsipreload.so gdalinfo /vsicurl/
http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc

It seems that setting LD_PRELOAD outside of the command works also, so this
mechanism would be used transparently.
But does it have a significant overhead and/or chances it might do damage
if always set?

e.g.
export LD_PRELOAD=./vsipreload.so
gdalinfo /vsicurl/
http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc


Is there any way this could be integrated into gdal to transparently
support vsifile for all drivers, without setting LD_PRELOAD?
In this way this feature would be available to all gdal commands or even
other apps that use gdal.

For example, /vsizip/ is used in QGIS, but it does not work with certain
files (e.g. netcdf ) inside archives. But if I use LD_PRELOAD it works for
netcdf files! Neat stuff!
e.g. LD_PRELOAD=./vsipreload.so qgis

great work
Etienne



> Thanks,
> Etienne
>
> My system is Linux Mint 13 ubuntu (quantal), gcc version 4.7.2, 64bits,
> 3.5.0-30-generic kernel
>
>
>>
>> LD_PRELOAD=vsipreload.so gdalinfo \
>>  'HDF4_EOS:EOS_GRID:"/vsicurl/
>> http://download.osgeo.org/gdal/data/hdf4/MOD09Q1G_EVI.A2006233.h07v03.005.2008338190308.hdf
>> ":MODIS_NACP_EVI:MODIS_EVI'
>>
>> LD_PRELOAD=vsipreload.so ogrinfo \
>>          /vsicurl/
>> http://svn.osgeo.org/gdal/trunk/autotest/ogr/data/testavc -ro
>>
>> LD_PRELOAD=vsipreload.so ogrinfo -ro \
>>
>> /vsizip//vsicurl/
>> http://download.osgeo.org/gdal/1.10.0/gdalautotest-1.10.0.zip/gdalautotest-1.10.0/ogr/data/testavc
>>
>> It can work even with non GDAL binaries :
>>
>> LD_PRELOAD=vsipreload.so h5dump -d /x \
>>         /vsicurl/
>> http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
>>
>> LD_PRELOAD=vsipreload.so sqlite3 \
>>          /vsicurl/http://download.osgeo.org/gdal/data/sqlite3/polygon.db\
>>         "select * from polygon limit 10"
>>
>> This can work with all VSI Large File API filesystems : /vsizip/ ,
>> /vsitar/,
>> /vsisubfile/ , etc...
>>
>> This is still a bit experimental in the sense that only the most common
>> glibc
>> I/O API have been overloaded. If exotic ones are used with /vsi files,
>> crashes
>> are likely.
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/5c22db1a/attachment-0001.html>

From even.rouault at mines-paris.org  Tue May 28 15:20:31 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 29 May 2013 00:20:31 +0200
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <9760C3B4-6061-4DD9-8E27-12A6D01FFB92@gmail.com>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<201305281959.09252.even.rouault@mines-paris.org>
	<9760C3B4-6061-4DD9-8E27-12A6D01FFB92@gmail.com>
Message-ID: <201305290020.31145.even.rouault@mines-paris.org>

> Now that I have your attention, I brought up with Frank at FOSS4GNA that
> there could sometimes be a need for both MEM drivers to spool off to disk
> through some sort of out-of-core mmap'd allocation.

> Does this currently exist in VSI,

No

> and if not, do you see any use for such a thing?

I didn't yet, but apparently you do :-)

> My thought
> was there might be scenarios where someone working with multi-gb (or
> worse) raster data sources where you'd like to control the paging (ie, you
> have SSD, or you want to create intermediates for some weird processing
> chain).

I'm not sure to understand the mention to paging in your sentence. When 
refering to mmap(), paging makes me think of the page size you get with 
sysconf(_SC_PAGE_SIZE), but that's probably not what you meant.

> Maybe not all that useful in exchange for the added complexity...

I'm not entirely clear on the advantages of using mmap() over a backing file 
rather than just doing a very large malloc(). In both cases I guess you would 
get swap trashing when you ping more virtual memory than actual physical 
memory available (although I see the madvise() call that could be used to give 
a hint to avoid pages to stay in RAM for too long). Or perhaps you're thinking 
to a mmap() on a limited portion of the backing file ? And the application 
changes the mapping according to where the user requests data ? But getting 
good performance with mmaping can be tricky ( 
http://stackoverflow.com/questions/6055861/why-is-sequentially-reading-a-large-
file-row-by-row-with-mmap-and-madvise-sequen ), so perhaps the backing to disk 
could also be done with traditionnal IO ?

Anyway this wouldn't be a "usual" VSI file system since its semantics must be 
similar to traditionnal POSIX file I/O (fread(), fwrite(), etc...), and 
mmap'ing is a different beast. This would be more something like a portability 
API for the Unix vs Windows API to establish a memory mapping.

(This discussion makes me think of the latest release of sqlite where they can 
optiionnaly use mmap() : http://www.sqlite.org/mmap.html . Though it is 
limited to situations where the mmap() size you give is big enough to fit the 
file size. If that condition is met, they have observed performance boost by a 
factor of 2 in some situations w.r.t traditionnal I/O methods)

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From feumar at shaw.ca  Tue May 28 15:33:48 2013
From: feumar at shaw.ca (Martin Feuchtwanger)
Date: Tue, 28 May 2013 15:33:48 -0700
Subject: [gdal-dev] Slow convertion from OSM to PG with -skipfailures
In-Reply-To: <201305282016.48057.even.rouault@mines-paris.org>
References: <loom.20130527T163158-922@post.gmane.org>
	<51A4EE34.1000900@shaw.ca>
	<201305282016.48057.even.rouault@mines-paris.org>
Message-ID: <51A530CC.6090902@shaw.ca>

No, Even,  i'm certainly not sure. It's just that when i first tried it 
(with flags) it was taking several days to convert a large GDB file, and 
when i tried without flags, only a few hours. (I guess it's only one 
order of magnitude different!) It's quite possible that is was some 
other factor i wasn't aware of. I only posted because it seemed to 
relate to Jukka's issue.

I'm not complaining about ogr2ogr -- it came through for me in the end :-)

Martin Feuchtwanger  feumar at shaw.ca  604-254-0361
http://members.shaw.ca/geomatics.developer
skype: martin.feuchtwanger

On 28/05/2013 11:16 AM, Even Rouault wrote:
> Le mardi 28 mai 2013 19:49:40, Martin Feuchtwanger a ?crit :
>> I was having a similar complaint (which i kept to myself at the time)
>> when using *ogr2ogr*.  In my case, converting GDB file to PG database.
>>
>> First i used some flags, -a_srs -lco -nln, but these turned out to be a
>> massive waste of time (several orders of magnitude). So instead i kept
>> to the defaults and made desired changes manually after the fact, in the
>> DB.
> Martin,
>
> Are you really sure about that ? This would be interesting if you could
> demonstrate that with examples. My belief is that -a_srs and -nln cost should
> be near 0 compared not to using them. They are only used to setup layer
> creation. The effect of -lco of course depends on the option and driver used,
> so there's no general rule to draw about this one.
>
>> Maybe there should be some stern warnings in the documentation when
>> "luxury" options are computationally expensive?
> We also accept documentation contributions :-) But performance depends
> sometimes on many factors and it is difficult to capture them.
>
>> Then users would be less
>> likely to judge ogr2ogr as a poor performer.
> I believe that ogr2ogr is generally considered as a good performer. But
> funding can sometimes help implementing improvements :-)
>
> Best regards,
>
> Even
>


From even.rouault at mines-paris.org  Tue May 28 15:35:54 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 29 May 2013 00:35:54 +0200
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <CA+TxYvPxg1k6hZCcKmbPcCvd_X_aEvNN4XbsbgyyWTkCRenaSQ@mail.gmail.com>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<CA+TxYvNn5jjzrg9ZFQS8JnJA3HMf6C5nT8-4_Ttzfg17iYGeiA@mail.gmail.com>
	<CA+TxYvPxg1k6hZCcKmbPcCvd_X_aEvNN4XbsbgyyWTkCRenaSQ@mail.gmail.com>
Message-ID: <201305290035.54335.even.rouault@mines-paris.org>


> I have managed to get it working buy using LD_PRELOAD=./vsipreload.so

Yes for some strange reason, some systems require the ./ and some not... My 
old Ubuntu 10.04 does no, but Travis on Ubuntu 12.04 does. Perhaps some 
security measure that has been added in LD_PRELOAD mechanism.

I've just adjusted the examples in the .cpp header to add ./

> 
> e.g.
> LD_PRELOAD=./vsipreload.so gdalinfo /vsicurl/
> http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
> 
> It seems that setting LD_PRELOAD outside of the command works also, so this
> mechanism would be used transparently.
> But does it have a significant overhead and/or chances it might do damage
> if always set?

This should have no impact for I/O on regular files, except for a hopefully 
small performance hit to check if the FILE* is a regular one (and redirect to 
the glibc function) or one that is a VSILFILE* instead (and redirect to VSI 
implementation). On /vsiXXXX files, crashes are theoretically possible if a 
glibc function using the fake FILE* is used, but not overloaded in the .so. 

> 
> e.g.
> export LD_PRELOAD=./vsipreload.so
> gdalinfo /vsicurl/
> http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
> 
> 
> Is there any way this could be integrated into gdal to transparently
> support vsifile for all drivers, without setting LD_PRELOAD?

None that I'm aware of. LD_PRELOAD is really something that must be specified 
before process launching. When GDAL code is reached, it is too late (and those 
limitations are really welcome for obvious security reasons).

> In this way this feature would be available to all gdal commands or even
> other apps that use gdal.
> 
> For example, /vsizip/ is used in QGIS, but it does not work with certain
> files (e.g. netcdf ) inside archives. But if I use LD_PRELOAD it works for
> netcdf files! Neat stuff!
> e.g. LD_PRELOAD=./vsipreload.so qgis

As I mentioned in another post in that thread, the use of a fuse filesystem 
could make it less hackish, although you would need permissions to mount on 
/vsizip , /vsicurl etc which might be problematic if you are not a good friend 
with the system administrator. You don't need to be root to mount a fuse 
filesystem, but you must have write permissions on the mount point I believe.

> 
> great work
> Etienne

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From etourigny.dev at gmail.com  Tue May 28 15:44:03 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Tue, 28 May 2013 19:44:03 -0300
Subject: [gdal-dev] vsipreload: enabling VSI Virtual File API for
	regular I/O
In-Reply-To: <201305290035.54335.even.rouault@mines-paris.org>
References: <201305261646.31371.even.rouault@mines-paris.org>
	<CA+TxYvNn5jjzrg9ZFQS8JnJA3HMf6C5nT8-4_Ttzfg17iYGeiA@mail.gmail.com>
	<CA+TxYvPxg1k6hZCcKmbPcCvd_X_aEvNN4XbsbgyyWTkCRenaSQ@mail.gmail.com>
	<201305290035.54335.even.rouault@mines-paris.org>
Message-ID: <CA+TxYvPpxM__apg2C8c6MBt2tayvFvyNEWi4QY325h2A1uvD0A@mail.gmail.com>

On Tue, May 28, 2013 at 7:35 PM, Even Rouault
<even.rouault at mines-paris.org>wrote:

>
> > I have managed to get it working buy using LD_PRELOAD=./vsipreload.so
>
> Yes for some strange reason, some systems require the ./ and some not... My
> old Ubuntu 10.04 does no, but Travis on Ubuntu 12.04 does. Perhaps some
> security measure that has been added in LD_PRELOAD mechanism.
>
> I've just adjusted the examples in the .cpp header to add ./
>
> >
> > e.g.
> > LD_PRELOAD=./vsipreload.so gdalinfo /vsicurl/
> > http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
> >
> > It seems that setting LD_PRELOAD outside of the command works also, so
> this
> > mechanism would be used transparently.
> > But does it have a significant overhead and/or chances it might do damage
> > if always set?
>
> This should have no impact for I/O on regular files, except for a hopefully
> small performance hit to check if the FILE* is a regular one (and redirect
> to
> the glibc function) or one that is a VSILFILE* instead (and redirect to VSI
> implementation). On /vsiXXXX files, crashes are theoretically possible if a
> glibc function using the fake FILE* is used, but not overloaded in the .so.
>
> >
> > e.g.
> > export LD_PRELOAD=./vsipreload.so
> > gdalinfo /vsicurl/
> > http://download.osgeo.org/gdal/data/netcdf/utm-big-chunks.nc
> >
> >
> > Is there any way this could be integrated into gdal to transparently
> > support vsifile for all drivers, without setting LD_PRELOAD?
>
> None that I'm aware of. LD_PRELOAD is really something that must be
> specified
> before process launching. When GDAL code is reached, it is too late (and
> those
> limitations are really welcome for obvious security reasons).
>

It would probably best (and safer for the time being) to use aliases for
commonly-used apps that would benefit from this (gdal*, qgis, etc)

alias gdalinfo='LD_PRELOAD=/usr/local/lib/vsipreload.so gdalinfo'
alias gdalwarp='LD_PRELOAD=/usr/local/lib/vsipreload.so gdalwarp'
alias qgis='LD_PRELOAD='usr/local/lib/vsipreload.so qgis'


> > In this way this feature would be available to all gdal commands or even
> > other apps that use gdal.
> >
> > For example, /vsizip/ is used in QGIS, but it does not work with certain
> > files (e.g. netcdf ) inside archives. But if I use LD_PRELOAD it works
> for
> > netcdf files! Neat stuff!
> > e.g. LD_PRELOAD=./vsipreload.so qgis
>
> As I mentioned in another post in that thread, the use of a fuse filesystem
> could make it less hackish, although you would need permissions to mount on
> /vsizip , /vsicurl etc which might be problematic if you are not a good
> friend
> with the system administrator. You don't need to be root to mount a fuse
> filesystem, but you must have write permissions on the mount point I
> believe.
>

it seems a little more involved and less flexible


>
> >
> > great work
> > Etienne
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130528/3d13400a/attachment.html>

From thomasc at mirageoscience.com  Tue May 28 16:22:05 2013
From: thomasc at mirageoscience.com (Thomas Campagne)
Date: Tue, 28 May 2013 23:22:05 +0000
Subject: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift
 file when using EPSG codes?
In-Reply-To: <0A52D2F3069984439507D303D0CB4FCF4D651E5F@MBX201.domain.local>
References: <0A52D2F3069984439507D303D0CB4FCF4D6517EB@MBX201.domain.local>
	<5196405B.5060900@gmx.eu>
	<0A52D2F3069984439507D303D0CB4FCF4D6518EC@MBX201.domain.local>
	<kn5ovm$l09$1@ger.gmane.org>
	<0A52D2F3069984439507D303D0CB4FCF4D651E5F@MBX201.domain.local>
Message-ID: <0A52D2F3069984439507D303D0CB4FCF4D743AFC@MBX206.domain.local>

I tested my modification to support the transformation from AGD66 to GDA94 in Australia using a NTv2 file. CRS details are below:

AGD66 => EPSG:4202 => +proj=longlat +ellps=aust_SA +towgs84=-117.808,-51.536,137.784,0.303,0.446,0.234,-0.29 +no_defs
                                       => +proj=longlat +ellps=aust_SA +nadgrids=A66_National_13.09.01.gsb +no_defs

GDA94 => EPSG:4283 => +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs

To support a direct use of the NTv2 (.gsb) file when initializing with an EPSG code, 4202 in the epsg file is now:
	# AGD66
	<4202> +proj=longlat +datum=AGD66 +no_defs  <> 
and the datum is identified in pj_datums.c as:
	"AGD66", "nadgrids=A66_National_13.09.01.gsb", "aust_SA", "Australian Geodetic Datum 1966",

For a set of 4 points from the ICSM documentation, I tested this code modification of pyproj against osgeo/ogr, and cs2cs using two different proj strings to define the source CRS (one with nadgrids the other using towgs84) and the results are the following:
(Lat positive east, Lon positive north, Diff_ columns are the difference between the ICSM result and the calculated results in arc-seconds)

ICSM_inX	ICSM_outX	osgeoX		cs2csnadgridsX	cs2cstowgs84X	pyprojX	Diff_osgeoX	Diff_cs2csnadgridsX	Diff_cs2cstowgs84X	Diff_pyprojX
147.437368	147.438731	147.4387352	147.438731	147.438735	147.4387312	0.0152568	0.0			0.0144000		0.0008136
130.654978	130.656199	130.6562168	130.6562	130.656217	130.6561997	0.0639828	0.0036000		0.0648000		0.0024696
144.423552	144.424868	144.4248765	144.424868	144.424877	144.4248684	0.0307584	0.0			0.0324000		0.0016128
143.925176	143.926495	143.9265029	143.926496	143.926503	143.9264956	0.0284796	0.0036000		0.0288000		0.0020412

ICSM_inY	ICSM_outY	osgeoY		cs2csnadgridsY	cs2cstowgs84Y	pyprojY	Diff_osgeoY	Diff_cs2csnadgridsY	Diff_cs2cstowgs84Y	Diff_pyprojY
-42.806215	-42.804718	-42.80471228	-42.804718	-42.804712	-42.80471834	0.0205844	0.0			0.0216000		0.0012323
-18.027176	-18.025773	-18.02573847	-18.025773	-18.025738	-18.02577316	0.1243058	0.0			0.1260000		0.0005580
-37.952536	-37.951034	-37.95103726	-37.951034	-37.951037	-37.95103375	0.0117468	0.0			0.0108000		0.0009162
-37.654321	-37.652821	-37.65282602	-37.652821	-37.652826	-37.65282077	0.0180580	0.0			0.0180000		0.0008330

The smallest differences with the ICSM results are achieved with cs2cs using the nadgrids parameter and the modified pyproj.
I also used the osgeo python library and its output seems to be similar than cs2cs using the towgs84 parameter.

For my usage I do not need to get into sub-metric accuracy so I assume the cs2cs using the nadgrids parameter and the modified pyproj to be roughly the same.
I still wonder why there is a small difference as they should be using the same parameters. 
Any ideas? Due to float rounding being handled differently?



I am looking into expanding this to following datums as they are country specific:
 AGD 1966, AGD 1984, NAD83(HARN), Cape, Lisbon, Datum 73, DHDN, Corrego Alegre 1961, Corrego Alegre 1970-72, NZGD 1949, OSGB36.

I am now encountering some difficulties dealing with NTv2 files that are not covering the full extents of the area where a datum is being used.
Examples are:
- PENR2009.gsb for Spain converting from ED50 (4230) to ETRS89 (4258) but ED50 was used over other countries in Europe,
- SAD69_003.GSB and SAD96_003.GSB for Brazil converting from SAD (4291 / 4618) to SIRGAS2000 (4674) but SAD was used over other countries in South America.

I tried:
> cs2cs -v -f %.6f +proj=longlat +ellps=intl +nadgrids=@PENR2009.gsb +towgs84=-87,-98,-121,0,0,0,0 +no_defs 
>                           +to +proj=longlat +ellps=GRS80 
> +towgs84=0,0,0,0,0,0,0 +no_defs
But there is a mention that the towgs84 parameter was specified but not used and then the conversion outside of Spain is not done (not even with the towgs84 parameter)

How could we have proj reverting to the towgs84 parameter when a point falls outside of the area covered by the NTv2 file?


Thomas

-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Thomas Campagne
Sent: May-22-13 11:43 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift file when using EPSG codes?

Thanks Andr?!

I will add a line for AGD66 datum and nadgrid file in pj_datums.c, and make the appropriate change in the epsg file , and compile from source. 

Is possible to default to the use of +towgs84 when there is no successful grids with +nadgrids?

For New-Zealand the line in pj_datums.c is:
"nzgd49",	"nadgrids=nzgd2kgrid0005.gsb", 	"intl",	 "New Zealand Geodetic Datum 1949"
And the epsg file contains:
# NZGD49
<4272> +proj=longlat +datum=nzgd49 +no_defs  <>

Could the following work if points are not located within the area covered by the NTv2 file?

pj_datums.c contains:
"nzgd49",	" nadgrids=@nzgd2kgrid0005.gsb ", 	"intl", "New Zealand Geodetic Datum 1949"
And the epsg file contains:
# NZGD49
<4272> +proj=longlat +datum=nzgd49 + towgs84=59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993 +no_defs  <>



-----Original Message-----
From: gdal-dev-bounces at lists.osgeo.org [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Andre Joost
Sent: May-17-13 10:21 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How to set GDAL/cs2cs/proj to use NTv2 grid shift file when using EPSG codes?

Am 17.05.2013 19:00, schrieb Thomas Campagne:

> When I run cs2cs -v +init=epsg:4267 I still do not understand how the
> +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat parameter is being
> generated as I cannot find it within the text/csv files.
>

EPSG:4267 expands to
+proj=longlat +datum=NAD27 +no_defs

and the nadgrids are in the "+datum=NAD27". This is hardcoded in <http://trac.osgeo.org/proj/browser/trunk/proj/src/pj_datums.c>
> "NAD27",    "nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat",
> 	                                                     "clrk66",
> 	                                "North_American_Datum_1927",


> Any idea about which files to edit to add the nadgrids parameter to 
> the proj string referenced by a given EPSG code (4202 for AGD66 as 
> example)?


You could add a line for AGD66 datum and nadgrid file in the file, and compile from source. And you have to change the share/proj/epsg file to use your datum istead of +towgs84.

Or try to insert the +nadgrids=<filename> for the AGD66 entry directly.

HTH,
Andr? Joost


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at mmmtike.fi  Wed May 29 01:14:35 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 29 May 2013 08:14:35 +0000 (UTC)
Subject: [gdal-dev] =?utf-8?q?OSM_to_Postgis_very_slow_without_PG=5FUSE=5F?=
	=?utf-8?q?COPY_YES?=
Message-ID: <loom.20130529T085604-95@post.gmane.org>

Hi,

I was comparing OSM -> PostGIS conversion with and without 
--config PG_USE_COPY YES

With PG_USE_COPY YES - 1 minute
Without PG_USE_COPY YES - I canceled the conversion after an hour

The difference is so big that I wonder if it really comes only from the
write method or if there is something else going on as well.

I had -gt 20000 included in both tests as you can see from my command below.
For the slow run I just cut away the PG_USE_COPY config option.

ogr2ogr -f PostgreSQL PG:"dbname='db' host='host' port='4326' user='user'
password='passwd'" finland.osm.pbf -gt 20000 -progress --config
OSM_COMPRESS_NODES YES  --config PG_USE_COPY YES

I have no access to the PostgreSQL configuration but I can ask from the DB
admins if there is something that should be checked from the postgresql.conf
file.

-Jukka Rahkonen-


From nhopton at gmail.com  Wed May 29 01:23:21 2013
From: nhopton at gmail.com (Nick Hopton)
Date: Wed, 29 May 2013 09:23:21 +0100
Subject: [gdal-dev] TIFs with TABs problem
In-Reply-To: <CA+YzLBf1MayvTS1SuE6uw00cRx_JrurnDcQS-fVYiDbFhTO5Tg@mail.gmail.com>
References: <CA+Nt1_n1rrJtSRy0SS6-ifdGYvLmwW8W_jh1iWC9Ri4YmEYTjw@mail.gmail.com>
	<CA+YzLBf1MayvTS1SuE6uw00cRx_JrurnDcQS-fVYiDbFhTO5Tg@mail.gmail.com>
Message-ID: <CA+Nt1_nf9xZSjs0+=yPZvZ26LbUFASj_PUzVQzAHde==bJPcNw@mail.gmail.com>

Many thanks for this Frank, the reason for the problem should have occurred
to me. As you say, gdalwarp is the answer.

Best wishes,
Nick.


On Tue, May 28, 2013 at 6:15 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> Nick,
>
> I haven't tried the .TAB files locally, but I see they are both resulting
> in georeferencing info.  The one is expressed as a geotransform with
> rotation and shear while the other is expressed as ground control points.
>
> I believe that the .TAB reader attempts to compute a geotransform from the
> points in the TAB and if it can do so with minimal error then that is what
> is returned - a solution easier to utilize in QGIS and other applications.
>
> If the control points do not represent a clean affine transformation for
> the image then it falls back to returning them as ground control points
> which relatively few applications can utilize directly.
>
> One "solution" is to run gdalwarp to transform the image that isn't
> currently working so well into a north up affine transformation style
> image.
>
> eg.
>
> gdalwarp 33044071.TIF 33044071_northup.TIF
>
> This warp will be done using the control points (ironically also using a
> best fit first order polynomial).
>
> The code responsible for the decision is this from
> gdal/gcore/gdal_misc.cpp:
>
> /* -------------------------------------------------------------------- */
> /*      Try to convert the GCPs into a geotransform definition, if      */
> /*      possible.  Otherwise we will need to use them as GCPs.          */
> /* -------------------------------------------------------------------- */
>     if( !GDALGCPsToGeoTransform( nCoordinateCount, asGCPs,
> padfGeoTransform,
>                                  FALSE ) )
>     {
>         if (pnGCPCount && ppasGCPs)
>         {
>             CPLDebug( "GDAL",
>                 "GDALLoadTabFile(%s) found file, wasn't able to derive a\n"
>                 "first order geotransform.  Using points as GCPs.",
>                 pszFilename );
>
>             *ppasGCPs = (GDAL_GCP *)
>                 CPLCalloc( sizeof(GDAL_GCP),nCoordinateCount );
>             memcpy( *ppasGCPs, asGCPs, sizeof(GDAL_GCP) * nCoordinateCount
> );
>             *pnGCPCount = nCoordinateCount;
>         }
>     }
>     else
>     {
>         GDALDeinitGCPs( nCoordinateCount, asGCPs );
>     }
>
> I suspect if you change the FALSE to TRUE in the arguments to
> GDALGCPsToGeoTransform() you wlil always get an affine transform even when
> it is not a very good fit.
>
>
> Best regards,
> Frank
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>

-- 
Nick Hopton, Caversham, Reading, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130529/77153026/attachment.html>

From even.rouault at mines-paris.org  Wed May 29 06:06:33 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 29 May 2013 15:06:33 +0200
Subject: [gdal-dev] OSM to Postgis very slow without PG_USE_COPY YES
In-Reply-To: <loom.20130529T085604-95@post.gmane.org>
References: <loom.20130529T085604-95@post.gmane.org>
Message-ID: <201305291506.33796.even.rouault@mines-paris.org>

Le mercredi 29 mai 2013 10:14:35, Jukka Rahkonen a ?crit :
> Hi,
> 
> I was comparing OSM -> PostGIS conversion with and without
> --config PG_USE_COPY YES
> 
> With PG_USE_COPY YES - 1 minute
> Without PG_USE_COPY YES - I canceled the conversion after an hour
> 
> The difference is so big that I wonder if it really comes only from the
> write method or if there is something else going on as well.
> 
> I had -gt 20000 included in both tests as you can see from my command
> below. For the slow run I just cut away the PG_USE_COPY config option.
> 
> ogr2ogr -f PostgreSQL PG:"dbname='db' host='host' port='4326' user='user'
> password='passwd'" finland.osm.pbf -gt 20000 -progress --config
> OSM_COMPRESS_NODES YES  --config PG_USE_COPY YES
> 
> I have no access to the PostgreSQL configuration but I can ask from the DB
> admins if there is something that should be checked from the
> postgresql.conf file.

Jukka,

Here are the timings I get:

$ time ogr2ogr -f postgresql pg:dbname=autotest finland.osm.pbf -progress --
config OSM_COMPRESS_NODES YES --config PG_USE_COPY YES -overwrite -gt 20000
0...10...20...30...40...50...60...70...80...90...100 - done.

real	0m54.851s
user	0m20.480s
sys	0m0.510s
$ time ogr2ogr -f postgresql pg:dbname=autotest finland.osm.pbf -progress --
config OSM_COMPRESS_NODES YES -overwrite -gt 20000
0...10...20...30...40...50...60...70...80...90...100 - done.

real	4m13.079s
user	0m47.790s
sys	0m7.850s

So COPY mode is approximatively 4x faster than doing INSERTs, which is 
reasonnable.

I'm not sure why you observe so poor performance with INSERTs. My configuration 
of the server is the stock one delivered by the PostgreSQL 8.4 package of 
Ubuntu 10.04. No tweaking at all.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Wed May 29 06:37:38 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 29 May 2013 16:37:38 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <201305282240.20555.even.rouault@mines-paris.org>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>
	<51A4EDBA.5010607@gmail.com>
	<201305282240.20555.even.rouault@mines-paris.org>
Message-ID: <51A604A2.1040603@gmail.com>

On 05/28/2013 11:40 PM, Even Rouault wrote:
>
> Le mardi 28 mai 2013 19:47:38, Ari Jolma a ?crit :
>
> > On 05/28/2013 05:34 PM, Lauri Kajan wrote:
>
> > > Hi Ari,
>
> > >
>
> > > I think that shouldn't be neccessary.
>
> > > The gml file points to the xsd schema file
>
> > > 
> (http://xml.nls.fi/XML/Schema/Maastotietojarjestelma/MTK/201202/Maastotie
>
> > > dot.xsd). In this schema those tags are defined to be "aliases" 
> for these
>
> > > known gml tags by using the substitutionGroup. So actually that
>
> > > <Maastotiedot> is a <gml:FeatureCollection>. Is this supported by OGR?
>
> >
>
> > I think GDAL wants the xsd to be local file for GML files. However, I
>
> > tried this and I can see GDAL finding the xsd, but failing the overall
>
> > process. Further, it seems that GDAL does not recognize the XML include
>
> > tag.
>
> >
>
> > Anyway, I assume it is not a simple substitution as all features should
>
> > be wrapped into gml:featureMember elements.
>
> Lauri,
>
> Generic GML reading is a very complicated task, since it can model 
> very complex data organizations that cannot be represented trivially 
> in the OGR data model. Basically the GML reader in OGR is limited to 
> GML documents respecting Simple Feature profiles ( GML 3.1.1 simple 
> features profile - OGC(R) 06-049r1 
> <http://portal.opengeospatial.org/files/?artifact_id=15201> ). The XSD 
> parser in the GML reader has similar limitations.
>
> The GML reader only tries to analyze the .xsd if it has the same 
> basename as the .gml document. Starting with OGR 1.10, you can specify 
> as datasource name something like "foo.gml,xsd=bar.xsd". In that 
> instance, Maastotiedot.xsd is too complex for the XSD parser to be 
> analyzed. And as the naming of elements in the GML doesn't match the 
> hard coded convention of the OGR GML driver ("somethingMember" 
> elements, usual names for GML geometry elements), the autodiscovery of 
> the schema fails also.
>
> However when looking at the GML itself, it should be possible with 
> moderate tweaking to make the GML driver aware of the structure of 
> that particular schema (provided that it is worth the effort, i.e. 
> there are a significant number of GML files following that schema, 
> which must likely be the case if it is a sample of the National Land 
> Suvey of Finnish), since it is close from what it can understand 
> currently. It has already been done in similar situations.
>


I'm cc'ing Pekka Sarkola, as I remember him asking about this a while back.

Even, by tweaking I hope you mean tweaking the GML itself? As I believe 
(being quite ignorant of / unexperienced with XSLT) that with a simple 
XSLT the XML could be made readable by GDAL. Again, being unexperienced 
with XSLT, I'm not sure but hope that XSLT processors run in sequential 
mode, thus the reading could be conveniently handled with a pipe. Hmm, 
how would that actually work, I'm not sure(?).

Anyway, if and when this is *the* GML format NLS Finland uses to serve 
its data, it would be worthwhile to develop a publishable solution.

Cheers,

Ari


> Best regards,
>
> Even
>
> -- 
>
> Geospatial professional services
>
> http://even.rouault.free.fr/services.html
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130529/f6a1cbfc/attachment-0001.html>

From even.rouault at mines-paris.org  Wed May 29 07:00:19 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 29 May 2013 16:00:19 +0200
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <51A604A2.1040603@gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<201305282240.20555.even.rouault@mines-paris.org>
	<51A604A2.1040603@gmail.com>
Message-ID: <201305291600.19797.even.rouault@mines-paris.org>


> I'm cc'ing Pekka Sarkola, as I remember him asking about this a while back.
> 
> Even, by tweaking I hope you mean tweaking the GML itself? 

I really meant the GML driver itself, so as to avoid an additional preliminary 
conversion step. Admitedly this is not a very elegant solution as it adds a 
bit of knowledge of a specific application schema to the GML driver itself (the 
elegant one would be to make the GML driver self discover application schemas 
from the XSD, but this looks like to be a huge and complicated task), but I 
guess this is OK for that kind of public/governmental data sources. The 
changes would likely be to make it understand at which indentation level the 
features are, and to make it recognize Piste as gml:Point, Murtoviiva as 
gml:LineString and Alue as gml:Polygon.

Another option would be to make something similar to the NAS driver which is a 
specialized GML driver for the NAS GML application schema, but NAS has indeed 
specific processing that make it more worthwhile to deserve a specific driver 
for it.

> As I believe
> (being quite ignorant of / unexperienced with XSLT) that with a simple
> XSLT the XML could be made readable by GDAL.

Yes, this is also certainly doable.

> Again, being unexperienced
> with XSLT, I'm not sure but hope that XSLT processors run in sequential
> mode, thus the reading could be conveniently handled with a pipe. Hmm,
> how would that actually work, I'm not sure(?).

I made a quick serach but I couldn't find a definitive answer on whether XSLT 
processors can operate with a SAX parser, and not only on a DOM.


-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From ari.jolma at gmail.com  Wed May 29 07:33:49 2013
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 29 May 2013 17:33:49 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <201305291600.19797.even.rouault@mines-paris.org>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<201305282240.20555.even.rouault@mines-paris.org>
	<51A604A2.1040603@gmail.com>
	<201305291600.19797.even.rouault@mines-paris.org>
Message-ID: <51A611CD.10305@gmail.com>

On 05/29/2013 05:00 PM, Even Rouault wrote:
>> Again, being unexperienced
>> with XSLT, I'm not sure but hope that XSLT processors run in sequential
>> mode, thus the reading could be conveniently handled with a pipe. Hmm,
>> how would that actually work, I'm not sure(?).
> I made a quick serach but I couldn't find a definitive answer on whether XSLT
> processors can operate with a SAX parser, and not only on a DOM.

I meant also how would it work with GDAL. How to organize the piping? 
For example with ogrinfo:

mkfifo x
cat maastotieto.gml | xslt > x
ogrinfo x

Would this work?

Ari


From even.rouault at mines-paris.org  Wed May 29 07:56:14 2013
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 29 May 2013 16:56:14 +0200
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <51A611CD.10305@gmail.com>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<201305291600.19797.even.rouault@mines-paris.org>
	<51A611CD.10305@gmail.com>
Message-ID: <201305291656.15062.even.rouault@mines-paris.org>

Le mercredi 29 mai 2013 16:33:49, Ari Jolma a ?crit :
> On 05/29/2013 05:00 PM, Even Rouault wrote:
> >> Again, being unexperienced
> >> with XSLT, I'm not sure but hope that XSLT processors run in sequential
> >> mode, thus the reading could be conveniently handled with a pipe. Hmm,
> >> how would that actually work, I'm not sure(?).
> > 
> > I made a quick serach but I couldn't find a definitive answer on whether
> > XSLT processors can operate with a SAX parser, and not only on a DOM.
> 
> I meant also how would it work with GDAL. How to organize the piping?
> For example with ogrinfo:
> 
> mkfifo x
> cat maastotieto.gml | xslt > x
> ogrinfo x
> 
> Would this work?

Well, the situation is a bit complicated and needs some explanation. The GML 
driver needs to know the schema of the data, in a broad sense. The schema can 
be of course the .xsd, provided that the OGR GML XSD parser can understand it 
(see previous emails). If there's no .xsd or if it cannot be understood, the 
GML driver will make a full analysis of the file to deduce automatically a 
schema that will be written in a .gfs file. When the .xsd or .gfs file are 
generated, the driver is able to parse the GML in a streaming mode.

So, the above would (likely, I have not tested) work if a x.gfs file already 
exists. As all files conforming to the Maastotiedot.xsd have the same 
structure, you could likely use a .gfs generated for one of them for the other 
ones (caution: this file must have all the possible classes so they are 
recorded in the .gfs)

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Wed May 29 12:43:51 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 29 May 2013 19:43:51 +0000 (UTC)
Subject: [gdal-dev] Reading gml with schema
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<CAKWoFM+hp4Ky+=f0K4H_X97D0xzi9rfa1q1t5cfgMVDJbfU-EQ@mail.gmail.com>
	<51A4EDBA.5010607@gmail.com>
	<201305282240.20555.even.rouault@mines-paris.org>
	<51A604A2.1040603@gmail.com>
Message-ID: <loom.20130529T212816-229@post.gmane.org>

Ari Jolma <ari.jolma <at> gmail.com> writes:

>     Even, by tweaking I hope you mean tweaking the GML itself? As I
>     believe (being quite ignorant of / unexperienced with XSLT) that
>     with a simple XSLT the XML could be made readable by GDAL. Again,
>     being unexperienced with XSLT, I'm not sure but hope that XSLT
>     processors run in sequential mode, thus the reading could be
>     conveniently handled with a pipe. Hmm, how would that actually work,
>     I'm not sure(?).
>     Anyway, if and when this is *the* GML format NLS Finland uses to
>     serve its data, it would be worthwhile to develop a publishable
>     solution.
>     Cheers,
>     Ari

It is only *one* of the odd GML formats of NLS. There are a few much more 
complicated ones for cadastrial data. The starting point of the schmemas is
on an open server

http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistotietojen_kyselypalvelu_WFS/Asiakasdokumentaatio/Kuvaus/DescribeFeatureType.xml

This docements poinst to other schemas which can be accessed only thought a
secured WFS server. I guess I do not make a big crime by revealing that the
beginning of the "TYPENAME=ktjkiiwfs:PalstanTietoja" contains references to
nine more schmemas which are at least mostly on an open server again and
they look like this

http://xml.nls.fi/XML/Schema/sovellus/ktjkii/modules/kiinteistorekisteri/tietopalvelu/aineistopalvelu/source/xml/fi/nls/ktjkii/aineistopalvelu/schema/tyypit_aineistopalvelu.xsd

I somehow feel that better than to fiddle with the standard GML driver would
be to make a special NLS driver which would support reading the topological
data first but could be extended later to support also cadastrial data from NLS.

-Jukka Rahkonen-



From jgrn at illinois.edu  Wed May 29 14:57:27 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 29 May 2013 16:57:27 -0500
Subject: [gdal-dev] gdal_translate file naming for sds and HDF4 files
Message-ID: <CABG0rfuv7fZHL19nXG4Wc5zOOwUvWT4chP8awoDRMRRFveUfQw@mail.gmail.com>

Folks:

I'm using a Windows install of GDAL 1.7.0 (FWTools) -- when I run:

gdal_translate -sds -of "GTiff" [some.hdf] "myoutput"

The output filenames do not have the .tif extension.  If I set the output
file to "myoutput.tif", it appends the "layer numbers" to the end of the
file, e.g. myoutput.tif1.  Any tricks to getting the naming working
properly (myoutput1.tif would be what I'd expect)?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130529/9d9a186b/attachment.html>

From pekka.sarkola at gispo.fi  Thu May 30 03:01:04 2013
From: pekka.sarkola at gispo.fi (Pekka Sarkola)
Date: Thu, 30 May 2013 13:01:04 +0300
Subject: [gdal-dev] Reading gml with schema
In-Reply-To: <201305291656.15062.even.rouault@mines-paris.org>
References: <CAKWoFMJy5Rj_XMDfadUoAa2FOJ2Xkz325ZAu4PtGL9-DdOS1sA@mail.gmail.com>
	<201305291600.19797.even.rouault@mines-paris.org>
	<51A611CD.10305@gmail.com>
	<201305291656.15062.even.rouault@mines-paris.org>
Message-ID: <003401ce5d1c$9904d020$cb0e7060$@gispo.fi>

Hi Folks,

Ari: thanks to raise my head. I'm now member of (also) this mailing list.

Yes, it seems that NLSFI has very unique way to create those GML's. However I have understood that they like pretty much follow INSPIRE guidelines. So, this kind of GML's could be common in Europe, soon.

I think there will few possibilities:
- Ask NLSFI to change their GML specs more like OGC GML simple features.
- Create NLSFI specific drivers for GDAL
- Develop GDAL's driver format to better support "non-simple-features" GML/XML.
- Make best practices how to use XSLT to convert "non-simple-features" GML to "simple features" GML
- something else...

Rgs,

Pekka

---   Pekka Sarkola  -  pekka.sarkola at gispo.fi  -  www.paikkatieto.com   ---


-----Alkuper?inen viesti-----
L?hett?j?: Even Rouault [mailto:even.rouault at mines-paris.org] 
L?hetetty: 29. toukokuuta 2013 17:56
Vastaanottaja: Ari Jolma
Kopio: Lauri Kajan; gdal-dev at lists.osgeo.org; pekka at gispo.fi
Aihe: Re: [gdal-dev] Reading gml with schema

Le mercredi 29 mai 2013 16:33:49, Ari Jolma a ?crit :
> On 05/29/2013 05:00 PM, Even Rouault wrote:
> >> Again, being unexperienced
> >> with XSLT, I'm not sure but hope that XSLT processors run in 
> >> sequential mode, thus the reading could be conveniently handled 
> >> with a pipe. Hmm, how would that actually work, I'm not sure(?).
> > 
> > I made a quick serach but I couldn't find a definitive answer on 
> > whether XSLT processors can operate with a SAX parser, and not only on a DOM.
> 
> I meant also how would it work with GDAL. How to organize the piping?
> For example with ogrinfo:
> 
> mkfifo x
> cat maastotieto.gml | xslt > x
> ogrinfo x
> 
> Would this work?

Well, the situation is a bit complicated and needs some explanation. The GML driver needs to know the schema of the data, in a broad sense. The schema can be of course the .xsd, provided that the OGR GML XSD parser can understand it (see previous emails). If there's no .xsd or if it cannot be understood, the GML driver will make a full analysis of the file to deduce automatically a schema that will be written in a .gfs file. When the .xsd or .gfs file are generated, the driver is able to parse the GML in a streaming mode.

So, the above would (likely, I have not tested) work if a x.gfs file already exists. As all files conforming to the Maastotiedot.xsd have the same structure, you could likely use a .gfs generated for one of them for the other ones (caution: this file must have all the possible classes so they are recorded in the .gfs)

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html


From jukka.rahkonen at mmmtike.fi  Thu May 30 12:46:56 2013
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 30 May 2013 19:46:56 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?gdal=5Ftranslate_file_naming_for_sds_and_HDF?=
	=?utf-8?q?4_files?=
References: <CABG0rfuv7fZHL19nXG4Wc5zOOwUvWT4chP8awoDRMRRFveUfQw@mail.gmail.com>
Message-ID: <loom.20130530T214224-344@post.gmane.org>

Jonathan Greenberg <jgrn <at> illinois.edu> writes:

> 
> Folks:
> I'm using a Windows install of GDAL 1.7.0 (FWTools) -- when I run:
> 
> gdal_translate -sds -of "GTiff" [some.hdf] "myoutput"
> The output filenames do not have the .tif extension. ?If I set the output
file to "myoutput.tif", it appends the "layer numbers" to the end of the
file, e.g. myoutput.tif1. ?Any tricks to getting the naming working properly
(myoutput1.tif would be what I'd expect)?

Hi,

First, acquire more fresh GDAL, current version is 1.10. Use OSGeo4W or
download Windows binaries from http://gisinternals.com/sdk/

Then, perhaps you should use gdalinfo first for seeing the exact names of
layers as GDAL understands them and use such a layer name as input instead
of [some.hdf]. Read usage examples from http://www.gdal.org/frmt_hdf4.html

-Jukka Rahkonen-


From Stefan.Blumentrath at nina.no  Thu May 30 13:34:31 2013
From: Stefan.Blumentrath at nina.no (SBL)
Date: Thu, 30 May 2013 13:34:31 -0700 (PDT)
Subject: [gdal-dev] SOSI driver in OSGeo4W-version of GDAL
Message-ID: <1369946071728-5057046.post@n6.nabble.com>

Dear all

On Linux systems the Norwegian SOSI-driver works now well and can be
compiled easily:
http://osgeo-org.1560.x6.nabble.com/Compile-GDAL-OGR-with-SOSI-support-tt5045207.html#a5049558

I would love to get that driver also into OSGeo4W (see also: 
Packaging-the-FYBA-lib-for-SOSI-support-in-the-OSGeo4W-version-of-GDAL
<http://osgeo-org.1560.x6.nabble.com/Packaging-the-FYBA-lib-for-SOSI-support-in-the-OSGeo4W-version-of-GDAL-tt5050052.html>  
and  #359 <http://trac.osgeo.org/osgeo4w/ticket/359>  ).

I would be willing to contribute e.g. with packaging the required FYBA lib,
though I do not have any experience with this (hope the learning curve there
is not too steep...).

If someone could help me getting started, that would be great. My (very
basic) questions are:
Do I have to use a certain compiler / build environment (Microsoft Visual
Studio or gcc via Cygwin / MSYS)?
I guess there are also adjustments of the build routines in GDAL necessary
in order to integrate the SOSI-driver as a GDAL-plugin in OSGeo4W?
Something else?

I am grateful for any advise/help!

Cheers
Stefan





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/SOSI-driver-in-OSGeo4W-version-of-GDAL-tp5057046.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Thu May 30 13:50:57 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Thu, 30 May 2013 17:50:57 -0300
Subject: [gdal-dev] gdal_translate file naming for sds and HDF4 files
In-Reply-To: <loom.20130530T214224-344@post.gmane.org>
References: <CABG0rfuv7fZHL19nXG4Wc5zOOwUvWT4chP8awoDRMRRFveUfQw@mail.gmail.com>
	<loom.20130530T214224-344@post.gmane.org>
Message-ID: <CA+TxYvNXg26csk_dnvY-7LtZey5s+qv=9BmRxR8zmqdRWexYag@mail.gmail.com>

On Thu, May 30, 2013 at 4:46 PM, Jukka Rahkonen
<jukka.rahkonen at mmmtike.fi>wrote:

> Jonathan Greenberg <jgrn <at> illinois.edu> writes:
>
> >
> > Folks:
> > I'm using a Windows install of GDAL 1.7.0 (FWTools) -- when I run:
> >
> > gdal_translate -sds -of "GTiff" [some.hdf] "myoutput"
> > The output filenames do not have the .tif extension.  If I set the output
> file to "myoutput.tif", it appends the "layer numbers" to the end of the
> file, e.g. myoutput.tif1.  Any tricks to getting the naming working
> properly
> (myoutput1.tif would be what I'd expect)?
>
> Hi,
>
> First, acquire more fresh GDAL, current version is 1.10. Use OSGeo4W or
> download Windows binaries from http://gisinternals.com/sdk/


actually the same thing happens with gdal-1.10. I will prepare a bug report
and fix.


>
>
> Then, perhaps you should use gdalinfo first for seeing the exact names of
> layers as GDAL understands them and use such a layer name as input instead
> of [some.hdf]. Read usage examples from http://www.gdal.org/frmt_hdf4.html


the idea of using the -sds argument is to generate an output file for each
subdataset, without having to search for subdataset names


>
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130530/1c5065a5/attachment.html>

From adiba.nizami at gmail.com  Thu May 30 22:36:50 2013
From: adiba.nizami at gmail.com (adi_khan)
Date: Thu, 30 May 2013 22:36:50 -0700 (PDT)
Subject: [gdal-dev] gdal_merge does not mosaic
Message-ID: <1369978610574-5057095.post@n6.nabble.com>

I am using gdal 1.4.5 and wish to use gdal_merge to mosaic *.img images.

The command runs successfully (no error is reported) but the output file
contains the last input image and not mosaiced output.
I use openEV to see the output file.

This is how is used the command :

gdal_merge.py -of HFA -o mosaic.img  img1.img img2.img img3.img




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-merge-does-not-mosaic-tp5057095.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Fri May 31 07:46:27 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 31 May 2013 11:46:27 -0300
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <1369978610574-5057095.post@n6.nabble.com>
References: <1369978610574-5057095.post@n6.nabble.com>
Message-ID: <CA+TxYvMwRGMsHEdjU9KzSCV6_VqFgFm7O=_DJnaTqRSHxUpfOw@mail.gmail.com>

Update to gdal 1.9 and try again.

On Fri, May 31, 2013 at 2:36 AM, adi_khan <adiba.nizami at gmail.com> wrote:

> I am using gdal 1.4.5 and wish to use gdal_merge to mosaic *.img images.
>
> The command runs successfully (no error is reported) but the output file
> contains the last input image and not mosaiced output.
> I use openEV to see the output file.
>
> This is how is used the command :
>
> gdal_merge.py -of HFA -o mosaic.img  img1.img img2.img img3.img
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-merge-does-not-mosaic-tp5057095.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/807d74f0/attachment.html>

From warmerdam at pobox.com  Fri May 31 07:51:00 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 31 May 2013 07:51:00 -0700
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <1369978610574-5057095.post@n6.nabble.com>
References: <1369978610574-5057095.post@n6.nabble.com>
Message-ID: <CA+YzLBc1zf-arm4Uc5OKH-TCZX1XhW-V5dMPA87_Ab_iUTXssw@mail.gmail.com>

Hi,

GDAL 1.4.5 is ancient.  Consider upgrading.  The last release was 1.10.0.

Your commandline looks ok.  Without knowing much about your input images or
what your output looks like it is hard to judge what went wrong.

Are img1.img, img2.img and img3.img spatially distinct?  Is the produced
mosaic the right extents to hold all the input images?

One thing to keep in mind is that if mosaic.img already exists it will just
be written into, not recreated.  So if you created it once with the wrong
size, subsequent runs won't recreate it the right size for everything.

Best regards,
Frank


On Thu, May 30, 2013 at 10:36 PM, adi_khan <adiba.nizami at gmail.com> wrote:

> I am using gdal 1.4.5 and wish to use gdal_merge to mosaic *.img images.
>
> The command runs successfully (no error is reported) but the output file
> contains the last input image and not mosaiced output.
> I use openEV to see the output file.
>
> This is how is used the command :
>
> gdal_merge.py -of HFA -o mosaic.img  img1.img img2.img img3.img
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-merge-does-not-mosaic-tp5057095.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/3e0a3197/attachment.html>

From andre+joost at nurfuerspam.de  Fri May 31 08:05:56 2013
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 31 May 2013 17:05:56 +0200
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <1369978610574-5057095.post@n6.nabble.com>
References: <1369978610574-5057095.post@n6.nabble.com>
Message-ID: <koaee0$vui$1@ger.gmane.org>

Am 31.05.2013 07:36, schrieb adi_khan:
> I am using gdal 1.4.5 and wish to use gdal_merge to mosaic *.img images.
>

Please update to the current version. GDAL 1.10.0 is out now, available 
for Windows via gisinternals.com.

Greetings,
Andr? Joost



From jgrn at illinois.edu  Fri May 31 09:04:57 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 31 May 2013 11:04:57 -0500
Subject: [gdal-dev] gdal_translate file naming for sds and HDF4 files
In-Reply-To: <bf5bcf3daa79433f99cfa4789a0f86b6@CHIHT1.ad.uillinois.edu>
References: <CABG0rfuv7fZHL19nXG4Wc5zOOwUvWT4chP8awoDRMRRFveUfQw@mail.gmail.com>
	<loom.20130530T214224-344@post.gmane.org>
	<bf5bcf3daa79433f99cfa4789a0f86b6@CHIHT1.ad.uillinois.edu>
Message-ID: <CABG0rfv9a5sb4BJ3uj8+=JZsFOzTCxBY9bayvw0GTRMQ0LvBUw@mail.gmail.com>

Thanks -- I did notice it was an earlier version (switching to the latest
OSGeo4W), I apologize for not checking the latest, but as Etienne
confirmed, the bug seems to be there in the latest as well.  The HDF files
from various sources are so odd when it comes to naming layers, that this
SDS argument is really helpful (if it would name the files correctly).

Speaking of -sds --> perhaps I can request that gdal_translate allow for a
layer # flag rather than the full layer name for subdataset files?  Is this
relatively easy to implement (since gdalinfo seems to already have the
capability)?

--j


On Thu, May 30, 2013 at 3:50 PM, Etienne Tourigny
<etourigny.dev at gmail.com>wrote:

>
>
> On Thu, May 30, 2013 at 4:46 PM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi
> > wrote:
>
>> Jonathan Greenberg <jgrn <at> illinois.edu> writes:
>>
>> >
>> > Folks:
>> > I'm using a Windows install of GDAL 1.7.0 (FWTools) -- when I run:
>> >
>> > gdal_translate -sds -of "GTiff" [some.hdf] "myoutput"
>> > The output filenames do not have the .tif extension.  If I set the
>> output
>> file to "myoutput.tif", it appends the "layer numbers" to the end of the
>> file, e.g. myoutput.tif1.  Any tricks to getting the naming working
>> properly
>> (myoutput1.tif would be what I'd expect)?
>>
>>  Hi,
>>
>> First, acquire more fresh GDAL, current version is 1.10. Use OSGeo4W or
>> download Windows binaries from http://gisinternals.com/sdk/
>>
>
>  actually the same thing happens with gdal-1.10. I will prepare a bug
> report and fix.
>
>
>>
>>
>> Then, perhaps you should use gdalinfo first for seeing the exact names of
>> layers as GDAL understands them and use such a layer name as input instead
>> of [some.hdf]. Read usage examples from
>> http://www.gdal.org/frmt_hdf4.html
>
>
>  the idea of using the -sds argument is to generate an output file for
> each subdataset, without having to search for subdataset names
>
>
>>
>>
>> -Jukka Rahkonen-
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>


-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/b5eb3bd0/attachment-0001.html>

From adiba.nizami at gmail.com  Fri May 31 10:48:14 2013
From: adiba.nizami at gmail.com (adi_khan)
Date: Fri, 31 May 2013 10:48:14 -0700 (PDT)
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <CA+YzLBc1zf-arm4Uc5OKH-TCZX1XhW-V5dMPA87_Ab_iUTXssw@mail.gmail.com>
References: <1369978610574-5057095.post@n6.nabble.com>
	<CA+YzLBc1zf-arm4Uc5OKH-TCZX1XhW-V5dMPA87_Ab_iUTXssw@mail.gmail.com>
Message-ID: <1370022494351-5057219.post@n6.nabble.com>

Thanks for your reply frank.
I understand that the GDAL I am using is ancient, but considering 'upgrading
to other version' not an option could you tell me if there's a way I can
mosaic using 1.4.5 only?
 Input images are spatially distinct. And the output image I.e. mosaic.img
was not already created when I ran the command.
I will post the gdalinfo of inputs images, the command output and gdalinfo
of output image in next post. 
I just wanted to confirm whether 1.4.5 supports mosaic or not.
Thanks.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-merge-does-not-mosaic-tp5057095p5057219.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Fri May 31 11:28:14 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 31 May 2013 15:28:14 -0300
Subject: [gdal-dev] gdal_translate file naming for sds and HDF4 files
In-Reply-To: <CABG0rfv9a5sb4BJ3uj8+=JZsFOzTCxBY9bayvw0GTRMQ0LvBUw@mail.gmail.com>
References: <CABG0rfuv7fZHL19nXG4Wc5zOOwUvWT4chP8awoDRMRRFveUfQw@mail.gmail.com>
	<loom.20130530T214224-344@post.gmane.org>
	<bf5bcf3daa79433f99cfa4789a0f86b6@CHIHT1.ad.uillinois.edu>
	<CABG0rfv9a5sb4BJ3uj8+=JZsFOzTCxBY9bayvw0GTRMQ0LvBUw@mail.gmail.com>
Message-ID: <CA+TxYvMd_0wGgR5SooyNq_D+TwwXfYG=D49VgP177RLDiKOofQ@mail.gmail.com>

On Fri, May 31, 2013 at 1:04 PM, Jonathan Greenberg <jgrn at illinois.edu>wrote:

> Thanks -- I did notice it was an earlier version (switching to the latest
> OSGeo4W), I apologize for not checking the latest, but as Etienne
> confirmed, the bug seems to be there in the latest as well.  The HDF files
> from various sources are so odd when it comes to naming layers, that this
> SDS argument is really helpful (if it would name the files correctly).
>
> Speaking of -sds --> perhaps I can request that gdal_translate allow for a
> layer # flag rather than the full layer name for subdataset files?  Is this
> relatively easy to implement (since gdalinfo seems to already have the
> capability)?
>

that depends on the driver actually... for hdf4 files normal syntax uses
number, whereas the netcdf driver uses variable name (which is more
informative). Changing this behaviour involves tweaking the driver code,
not gdal_translate.

e.g.
SUBDATASET_1_NAME=HDF4_SDS:MODIS_L1B:GSUB1.A2001124.0855.003.200219309451.hdf:0

SUBDATASET_1_NAME=NETCDF:"sst.nc":lon_bnds

Now perhaps you mean to select a single dataset by number, without the full
SUBDATASET_X_NAME syntax ?

such as
gdalinfo -subdatset 1 file.hdf

which would be equivalent to
gdalinfo HDF4_SDS:file.hdf:0

that would be marginally handy, but not much as the rest of gdal uses the
driver:file:subdataset syntax.


> --j
>
>
> On Thu, May 30, 2013 at 3:50 PM, Etienne Tourigny <etourigny.dev at gmail.com
> > wrote:
>
>>
>>
>> On Thu, May 30, 2013 at 4:46 PM, Jukka Rahkonen <
>> jukka.rahkonen at mmmtike.fi> wrote:
>>
>>> Jonathan Greenberg <jgrn <at> illinois.edu> writes:
>>>
>>> >
>>> > Folks:
>>> > I'm using a Windows install of GDAL 1.7.0 (FWTools) -- when I run:
>>> >
>>> > gdal_translate -sds -of "GTiff" [some.hdf] "myoutput"
>>> > The output filenames do not have the .tif extension.  If I set the
>>> output
>>> file to "myoutput.tif", it appends the "layer numbers" to the end of the
>>> file, e.g. myoutput.tif1.  Any tricks to getting the naming working
>>> properly
>>> (myoutput1.tif would be what I'd expect)?
>>>
>>>  Hi,
>>>
>>> First, acquire more fresh GDAL, current version is 1.10. Use OSGeo4W or
>>> download Windows binaries from http://gisinternals.com/sdk/
>>>
>>
>>  actually the same thing happens with gdal-1.10. I will prepare a bug
>> report and fix.
>>
>>
>>>
>>>
>>> Then, perhaps you should use gdalinfo first for seeing the exact names of
>>> layers as GDAL understands them and use such a layer name as input
>>> instead
>>> of [some.hdf]. Read usage examples from
>>> http://www.gdal.org/frmt_hdf4.html
>>>
>>
>>  the idea of using the -sds argument is to generate an output file for
>> each subdataset, without having to search for subdataset names
>>
>>
>>>
>>>
>>> -Jukka Rahkonen-
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 607 South Mathews Avenue, MC 150
> Urbana, IL 61801
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/0ad98233/attachment.html>

From jrepetto at free.fr  Fri May 31 15:47:41 2013
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Sat, 01 Jun 2013 00:47:41 +0200
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <1370022494351-5057219.post@n6.nabble.com>
References: <1369978610574-5057095.post@n6.nabble.com>
	<CA+YzLBc1zf-arm4Uc5OKH-TCZX1XhW-V5dMPA87_Ab_iUTXssw@mail.gmail.com>
	<1370022494351-5057219.post@n6.nabble.com>
Message-ID: <51A9288D.8060208@free.fr>

On 31/05/2013 19:48, adi_khan wrote:
> Thanks for your reply frank.
> I understand that the GDAL I am using is ancient, but considering 'upgrading
> to other version' not an option could you tell me if there's a way I can
> mosaic using 1.4.5 only?

Another option is to use gdalwarp instead of gdal_merge.py :
gdalwarp -of HFA img1.img img2.img img3.img mosaic.img


From etourigny.dev at gmail.com  Fri May 31 16:10:26 2013
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 31 May 2013 20:10:26 -0300
Subject: [gdal-dev] gdal_merge does not mosaic
In-Reply-To: <51A9288D.8060208@free.fr>
References: <1369978610574-5057095.post@n6.nabble.com>
	<CA+YzLBc1zf-arm4Uc5OKH-TCZX1XhW-V5dMPA87_Ab_iUTXssw@mail.gmail.com>
	<1370022494351-5057219.post@n6.nabble.com>
	<51A9288D.8060208@free.fr>
Message-ID: <CA+TxYvM-FhnscEKAf2CCeyPAwttURKPoLDsNTPoZ1yBQ1OtfSA@mail.gmail.com>

On Fri, May 31, 2013 at 7:47 PM, Jean-Claude Repetto <jrepetto at free.fr>wrote:

> On 31/05/2013 19:48, adi_khan wrote:
>
>> Thanks for your reply frank.
>> I understand that the GDAL I am using is ancient, but considering
>> 'upgrading
>> to other version' not an option could you tell me if there's a way I can
>> mosaic using 1.4.5 only?
>>
>
> Another option is to use gdalwarp instead of gdal_merge.py :
> gdalwarp -of HFA img1.img img2.img img3.img mosaic.img


I hadn't even noticed that gdal_merge was being used. gdalwarp is far
better than gdal_merge.py IMHO


>
>
> ______________________________**_________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/**mailman/listinfo/gdal-dev<http://lists.osgeo.org/mailman/listinfo/gdal-dev>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/bad75fbf/attachment.html>

From gdal at stripfamily.net  Fri May 31 16:24:51 2013
From: gdal at stripfamily.net (David Strip)
Date: Fri, 31 May 2013 17:24:51 -0600
Subject: [gdal-dev] GDALRasterBand::RasterIO and FlushCache
Message-ID: <51A93143.50903@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/89915b18/attachment.html>

From warmerdam at pobox.com  Fri May 31 16:38:14 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 31 May 2013 16:38:14 -0700
Subject: [gdal-dev] GDALRasterBand::RasterIO and FlushCache
In-Reply-To: <51A93143.50903@stripfamily.net>
References: <51A93143.50903@stripfamily.net>
Message-ID: <CA+YzLBc+Jxbt6SeJwL8NyC5E-gQoeHYQAt-PGC3oYOWzZFgXPA@mail.gmail.com>

David,

Note that the image cache will start discarding blocks on it's own when it
is full.  I think the default cache is about 64MB.    I don't think that
flushing the cache should be part of normal applications operations, though
if you are very tight on memory you might want to alter the default size.
 Note that the cached blocks are discarded when the dataset is closed.

I will update the example to free the buffer at the end.

Best regards,
Frank

On Fri, May 31, 2013 at 4:24 PM, David Strip <gdal at stripfamily.net> wrote:

>  I'm reading a fairly large (at least to me) geotif (about 2GB) a line at
> a time. I noticed that memory usage increases as I read the image. It
> appears that what's going on is that the driver hangs onto these lines of
> the image, even though I'm providing the same buffer for it to read into
> each time. At this point I noticed the FlushCache method. Calling this
> after each reading each scan line solves the problem of the growing memory
> usage.
>
> I assume this behavior of caching whatever is read is deliberate. I think
> it would be useful in the API examples to make this behavior clear and
> perhaps show the use of the FlushCache method.
> For example, the API Tutorial page shows this for how to read a line into
> a buffer:
>
> *Reading Raster Data
> *There are a few ways to read raster data, but the most common is via the
> GDALRasterBand::RasterIO() method. This method will automatically take care
> of data type conversion, up/down sampling and windowing. The following code
> will read the first scanline of data into a similarly sized buffer,
> converting it to floating point as part of the operation.
>
> In C++:
>
>         float *pafScanline;
>         int   nXSize = poBand->GetXSize();
>
>         pafScanline = (float *) CPLMalloc(sizeof(float)*nXSize);
>         poBand->RasterIO( GF_Read, 0, 0, nXSize, 1,
>                           pafScanline, nXSize, 1, GDT_Float32,
>                           0, 0 );
>
> The pafScanline buffer should be freed with CPLFree() when it is no longer
> used.
>
> I think it would be useful to point out, in addition to the need to
> CPLFree the buffer that if you are using this example in a loop to read the
> image a line at a time, you should FlushCache every line (or periodically)
> to keep from accumulating the entire image in the cache (which is invisible
> to the user). It seems (to me) that it would be better to put this in the
> API Tutorial rather than as a code snippet in the Wiki, since the tutorial
> is where most people would look when starting out.
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/d7677c7a/attachment.html>

From warmerdam at pobox.com  Fri May 31 16:43:35 2013
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 31 May 2013 16:43:35 -0700
Subject: [gdal-dev] GDALRasterBand::RasterIO and FlushCache
In-Reply-To: <CA+YzLBc+Jxbt6SeJwL8NyC5E-gQoeHYQAt-PGC3oYOWzZFgXPA@mail.gmail.com>
References: <51A93143.50903@stripfamily.net>
	<CA+YzLBc+Jxbt6SeJwL8NyC5E-gQoeHYQAt-PGC3oYOWzZFgXPA@mail.gmail.com>
Message-ID: <CA+YzLBdzLRxBrObWvy8QfpZmJngYPm0VRNRnodEuyxOmDseXdg@mail.gmail.com>

David,

I see I misunderstood about the free and it is already documented.  So I
think the docs are good now and that most users should never even need to
think about the caching aspect.

Best regards,
Frank

On Fri, May 31, 2013 at 4:38 PM, Frank Warmerdam <warmerdam at pobox.com>wrote:

> David,
>
> Note that the image cache will start discarding blocks on it's own when it
> is full.  I think the default cache is about 64MB.    I don't think that
> flushing the cache should be part of normal applications operations, though
> if you are very tight on memory you might want to alter the default size.
>  Note that the cached blocks are discarded when the dataset is closed.
>
> I will update the example to free the buffer at the end.
>
> Best regards,
> Frank
>
> On Fri, May 31, 2013 at 4:24 PM, David Strip <gdal at stripfamily.net> wrote:
>
>>  I'm reading a fairly large (at least to me) geotif (about 2GB) a line at
>> a time. I noticed that memory usage increases as I read the image. It
>> appears that what's going on is that the driver hangs onto these lines of
>> the image, even though I'm providing the same buffer for it to read into
>> each time. At this point I noticed the FlushCache method. Calling this
>> after each reading each scan line solves the problem of the growing memory
>> usage.
>>
>> I assume this behavior of caching whatever is read is deliberate. I think
>> it would be useful in the API examples to make this behavior clear and
>> perhaps show the use of the FlushCache method.
>> For example, the API Tutorial page shows this for how to read a line into
>> a buffer:
>>
>> *Reading Raster Data
>> *There are a few ways to read raster data, but the most common is via
>> the GDALRasterBand::RasterIO() method. This method will automatically take
>> care of data type conversion, up/down sampling and windowing. The following
>> code will read the first scanline of data into a similarly sized buffer,
>> converting it to floating point as part of the operation.
>>
>> In C++:
>>
>>         float *pafScanline;
>>         int   nXSize = poBand->GetXSize();
>>
>>         pafScanline = (float *) CPLMalloc(sizeof(float)*nXSize);
>>         poBand->RasterIO( GF_Read, 0, 0, nXSize, 1,
>>                           pafScanline, nXSize, 1, GDT_Float32,
>>                           0, 0 );
>>
>> The pafScanline buffer should be freed with CPLFree() when it is no
>> longer used.
>>
>> I think it would be useful to point out, in addition to the need to
>> CPLFree the buffer that if you are using this example in a loop to read the
>> image a line at a time, you should FlushCache every line (or periodically)
>> to keep from accumulating the entire image in the cache (which is invisible
>> to the user). It seems (to me) that it would be better to put this in the
>> API Tutorial rather than as a code snippet in the Wiki, since the tutorial
>> is where most people would look when starting out.
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Software Developer
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/f0e79d78/attachment-0001.html>

From taibc_coltech at yahoo.com  Fri May 31 20:18:09 2013
From: taibc_coltech at yahoo.com (taibc)
Date: Fri, 31 May 2013 20:18:09 -0700 (PDT)
Subject: [gdal-dev] Can't convert geometry from Dgn file to Shape file ?
Message-ID: <1370056689684-5057267.post@n6.nabble.com>

Hi everyone,

I am using below codes to try convert geometry from a Dgn file to Shape
file. But, I can't exit the FeatureReading loop:

void convert()
{
   OGRRegisterAll();
   OGRDataSource       *poDS,  *poSHPDS;
   const char *pszDriverName = "ESRI Shapefile";
   OGRSFDriver *poDriver;
   poDriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(
		  pszDriverName );
		
   // Open file DGN
   poDS = OGRSFDriverRegistrar::Open( sourceFile, FALSE );
				
   if( poDS == NULL )
  {
	 cout << "Error opeing DGN file." << endl;
  	return false;				
  }
  // Create datasource for file shp
  poSHPDS = poDriver->CreateDataSource(destinationPath,NULL);
  if( poSHPDS == NULL )
  {
	cout << "Error creating shape file." << endl;
        return false;
  }
		
  OGRLayer  *poLayer, *poSHPLayer;
				
  // Get Layer from DGN file
  poLayer = poDS->GetLayer(0);
				
  // Create new Layer of SHP file	
  poSHPLayer = poSHPDS->CreateLayer (shpFileName, NULL, wkbPolygon, NULL);
  if(poSHPLayer == NULL)
  {
	  cout << "Error creating Layer of Shape File." << endl;
          return false;
  }
  OGRFeature *poFeature;
  
  poLayer->ResetReading();
		
  *while( (poFeature = poLayer->GetNextFeature()) != NULL ) // Can't exit
this loop* 
  {
			
	OGRGeometry *poGeometry;
	poGeometry = poFeature->GetGeometryRef();
		
	// if feature is a Polygon
	if( poGeometry != NULL && (wkbFlatten(poGeometry->getGeometryType()) ==
wkbPolygon ) )
	{		
		OGRFeature *poSHPFeature; 
		//Create new Feature shape file
		poSHPFeature = OGRFeature::CreateFeature (poSHPLayer->GetLayerDefn()); 
	        poSHPFeature->SetGeometry (poGeometry);
		OGRPolygon *poPolygon = (OGRPolygon*) poSHPFeature->GetGeometryRef();

                poLayer->SetSpatialFilter(poGeometry); 
		poLayer->ResetReading ();
                
         }	
         OGRFeature::DestroyFeature( poFeature );
        
    }
    OGRDataSource::DestroyDataSource( poDS );
    OGRDataSource::DestroyDataSource( poSHPDS );
    return true;
}

Please find my attached dgn file.  Dc19.dgn
<http://osgeo-org.1560.x6.nabble.com/file/n5057267/Dc19.dgn>  

Are there anyone know why and how to fix it ?

Thanks and regards,
Tai



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Can-t-convert-geometry-from-Dgn-file-to-Shape-file-tp5057267.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From dshean at gmail.com  Fri May 31 23:58:25 2013
From: dshean at gmail.com (David Shean)
Date: Fri, 31 May 2013 23:58:25 -0700
Subject: [gdal-dev] ReprojectImage and nodata
Message-ID: <A311E0D7-9B12-41DE-8A04-FE96D246A990@gmail.com>

Hi list,
I'm having some issues with the Python ReprojectImage function not respecting nodata.

My input dataset has nodata value -32767.  I am using ReprojectImage to resample and warp the src_ds in memory to match the resolution and srs of a second dataset.  The output of ReprojectImage has nodata pixels filled with 0, despite the fact that both the input src_ds and dst_ds nodata are specified to -32767 before the warp.

Here's a snippet:

   src_gt = src_ds.GetGeoTransform()
   src_srs = geolib.get_srs(src_ds)
   gra = gdal.GRA_CubicSpline

   #Use GDAL memory driver
   memdrv = gdal.GetDriverByName('MEM')
   #Compute output image dimensions
   dst_nl = int(round((extent[3] - extent[1])/res))
   dst_ns = int(round((extent[2] - extent[0])/res))
   #Create output dataset
   src_b = src_ds.GetRasterBand(1)
   src_dt = src_b.DataType
   dst_ds = memdrv.Create('', dst_ns, dst_nl, src_ds.RasterCount, src_dt) 
   dst_ds.SetProjection(t_srs.ExportToWkt())
   dst_gt = [extent[0], res, src_gt[2], extent[3], src_gt[4], -res]
   dst_ds.SetGeoTransform(dst_gt)

   for n in range(1, src_ds.RasterCount+1):
       src_b = src_ds.GetRasterBand(n)
	#Extract ndv from src_b, with defaults if undefined
       src_ndv = malib.get_ndv(src_b)
       if src_ndv is not None:
           dst_ds.GetRasterBand(n).SetNoDataValue(src_ndv)

   result = gdal.ReprojectImage(src_ds, dst_ds, src_srs.ExportToWkt(), t_srs.ExportToWkt(), \
   gra, 0.0, 0.0, prog_func)

   return dst_ds

I see that it should be possible to pass SrcNoDataReal and DstNoDataReal as GdalWarpOptions (http://www.gdal.org/structGDALWarpOptions.html), but this is not supported by ReprojectImage as far as I can tell.  

I can hack a dst_ds.GetRasterBand(n).SetNoDataValue(0) fix in the above loop, and then replace the value of those pixels using numpy to obtain my desired output ndv, but this is problematic because 0 is technically in my valid input range.  I'm using 1.11dev (4/13/2013).
-David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20130531/137eaf69/attachment.html>

