From even.rouault at spatialys.com  Mon Jan  2 06:55:04 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 2 Jan 2023 15:55:04 +0100
Subject: [gdal-dev] GDAL 3.6.2 rc1 available
Message-ID: <004a0003-4065-18bb-5757-26943d742a35@spatialys.com>

Hi,

To celebrate the New Year, another ahead of planned schedule release 
candidate, mostly to
address another issue (https://github.com/OSGeo/gdal/pull/6959) when 
generating
multi-layer GeoPackage files, related to multi-threaded RTree building 
added in 3.6.0.

Pick up an archive among the following ones (by ascending size):


 ? https://download.osgeo.org/gdal/3.6.2/gdal-3.6.2rc1.tar.xz
 ? https://download.osgeo.org/gdal/3.6.2/gdal-3.6.2rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.6.2/gdal362rc1.zip

A snapshot of the gdalautotest suite is also available :

https://download.osgeo.org/gdal/3.6.2/gdalautotest-3.6.2rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.6.2/gdalautotest-3.6.2rc1.zip

The NEWS file is here :

 ? https://github.com/OSGeo/gdal/blob/v3.6.2RC1/NEWS.md

For those looking at the diff with 3.6.1, don't be surprised by the 
apparent massive amount of changes:
[RFC69](https://gdal.org/development/rfc/rfc69_cplusplus_formatting.html):
Whole code base C/C++ reformatting has been applied in the 3.6 branch.

The concatenatation of the 2 following diffs should give a more readable 
view of the actual changes:

git diff v3.6.1..f5d08c6c641dd426c61e78d84186fa88ce826d75
git diff 81c17e553056144200b863e4d3095593298bfde5..v3.6.2RC1


Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Simon.Wright at jbarisk.com  Tue Jan  3 09:33:34 2023
From: Simon.Wright at jbarisk.com (Simon Wright)
Date: Tue, 3 Jan 2023 17:33:34 +0000
Subject: [gdal-dev] GetAreaOfUse() and EPSG:29902
Message-ID: <LO3P123MB3291E46B21AFE558854859E390F49@LO3P123MB3291.GBRP123.PROD.OUTLOOK.COM>

Dear All

Happy New Year!

I'm trying to use the GetAreaOfUse() method on a osgeo.osr.SpatialReference to check the validity of coordinates.

With the following for the Irish National Grid (EPSG:29902) I get the WGS84 bounds - west, east, south, north - of the spatial reference system to be -10.56, -5.93, 51.39, 55.43:

>>> from osgeo import osr
>>> srs = osr.SpatialReference()
>>> srs.ImportFromEPSG(29902)
0
>>> aou = srs.GetAreaOfUse()
>>> aou.west_lon_degree, aou.east_lon_degree, aou.south_lat_degree, aou.north_lat_degree
(-10.56, -5.93, 51.39, 55.43)

However, at https://epsg.io/29902 the WGS84<https://epsg.io/29902%20the%20WGS84> bounds are listed as -10.56, -5.34, 51.39, 55.43.

How is the GetAreaOfUse() method implemented? And is there a bug in the values stored for the EPSG:29902 projection?  Or is there another reason why the values differ to those listed at epsg.io.



Many thanks, best wishes, Simon.




Simon Wright
JBA Risk Management Limited

--


e: Simon.Wright at jbarisk.com
d:+44 (0)1756 587258
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image600659.png
Type: image/png
Size: 9321 bytes
Desc: image600659.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image372249.png
Type: image/png
Size: 651 bytes
Desc: image372249.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image259261.png
Type: image/png
Size: 715 bytes
Desc: image259261.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image886659.png
Type: image/png
Size: 966 bytes
Desc: image886659.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image857924.png
Type: image/png
Size: 784 bytes
Desc: image857924.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/65e085e7/attachment-0009.png>

From adamgutonski at protonmail.com  Tue Jan  3 09:33:32 2023
From: adamgutonski at protonmail.com (adamgutonski)
Date: Tue, 03 Jan 2023 17:33:32 +0000
Subject: [gdal-dev] GDAL bindings support for Java 17
Message-ID: <1gAkJdtLYoujD8AbzTFnNP8xNf7BLbzs8aqHcci32peepL3Qb3xp9rJYs3Fr_R3HA9QH3qopmlUlpmRqTXHBTl9eN2rDsbqSxjAMKB6M1Vs=@protonmail.com>

Hello,

My question is, is it possible to build the GDAL bindings for Java 17? I am trying to build GDAL with Java bindings for Java temurin-17.jdk when prior I have been able to build and use the bindings successfully for Java adoptopenjdk-8.jdk, using the exact same build process. However when I run the equivalent build steps with Java 17 I continue to receive this link error when implementing the bindings:

Native library load failed.
java.lang.UnsatisfiedLinkError: no gdalalljni in java.library.path: ...
Exception in thread "main" java.lang.UnsatisfiedLinkError: 'void org.gdal.gdal.gdalJNI.AllRegister()'
at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
at org.gdal.gdal.gdal.AllRegister(gdal.java:664) at Main.main(Main.java:14)

My system specs:

System Version: macOS 12.6.1 (21G217)

Kernel Version: Darwin 21.6.0

Boot Volume: Macintosh HD

Boot Mode: Normal

Secure Virtual Memory: Enabled

System Integrity Protection: Enabled

Time since boot: 15 days 20:17

Model Name: MacBook Pro

Model Identifier: MacBookPro18,3

Chip: Apple M1 Pro

When I run the build I see that the Java bindings are generated, the .jar and libgdalalljni.dylib are created in /build/swig/java. Here are the build commands used:

sudo arch -x86_64 /usr/local/homebrew/bin/cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local/bin -DBUILD_JAVA_BINDINGS=ON -DBUILD_PYTHON_BINDINGS=OFF -DCMAKE_OSX_ARCHITECTURES=x86_64 -DGDAL_USE_ZSTD=OFF

sudo arch -x86_64 /usr/local/homebrew/bin/cmake --build .

sudo arch -x86_64 /usr/local/homebrew/bin/cmake --build . --target install

Again, all of the above steps work when I am using JDK 8. So does GDAL support Java bindings for JDK 17? Is there a way to resolve the error no gdalalljni in java.library.path? Here are the path settings in IntelliJ IDE:

VM options: -Djava.library.path=/Users/<username>/code/gdal-<version>/build/swig/java:$PATH$ Environment Vars: PATH=/Users/<username>/code/gdal-<version>:/Users/<username>/code/gdal-<version>/build/swig/java:$PATH$
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/4dc9ab2d/attachment.htm>

From even.rouault at spatialys.com  Tue Jan  3 09:51:18 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Jan 2023 18:51:18 +0100
Subject: [gdal-dev] GetAreaOfUse() and EPSG:29902
In-Reply-To: <LO3P123MB3291E46B21AFE558854859E390F49@LO3P123MB3291.GBRP123.PROD.OUTLOOK.COM>
References: <LO3P123MB3291E46B21AFE558854859E390F49@LO3P123MB3291.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <edc62850-fec2-0b82-679d-7a545e143203@spatialys.com>

Simon,

epsg.io is not a reference site. You should rather consult epsg.org

For CRS EPSG:29902, it refers to extent 
https://epsg.org/extent_3767/Ireland-onshore.html which has -5.93? as 
east longitude

https://epsg.org/extent_1305/Europe-Ireland-Republic-and-Ulster-onshore.html 
has -5.34? as east longitude.? So epsg.io is perhaps confused by which 
extent to use, or an update has occured between the last state of the 
database it used and today.

Even

Le 03/01/2023 ? 18:33, Simon Wright a ?crit?:
>
> Dear All
>
> Happy New Year!
>
> I?m trying to use the GetAreaOfUse() method on a 
> osgeo.osr.SpatialReference to check the validity of coordinates.
>
> With the following for the Irish National Grid (EPSG:29902) I get the 
> WGS84 bounds ? west, east, south, north - of the spatial reference 
> system to be -10.56, -5.93, 51.39, 55.43:
>
> >>> from osgeo import osr
>
> >>> srs = osr.SpatialReference()
>
> >>> srs.ImportFromEPSG(29902)
>
> 0
>
> >>> aou = srs.GetAreaOfUse()
>
> >>> aou.west_lon_degree, aou.east_lon_degree, aou.south_lat_degree, 
> aou.north_lat_degree
>
> (-10.56, -5.93, 51.39, 55.43)
>
> However, at https://epsg.io/29902 the WGS84 
> <https://epsg.io/29902%20the%20WGS84> bounds are listed as -10.56, 
> -5.34, 51.39, 55.43.
>
> How is the GetAreaOfUse() method implemented? And is there a bug in 
> the values stored for the EPSG:29902 projection?? Or is there another 
> reason why the values differ to those listed at epsg.io.
>
> Many thanks, best wishes, Simon.
>
> **
>
> **
>
> **
>
> **
>
> *Simon Wright*
>
> *JBA Risk Management Limited*
>
> -- 
>
> e: ? 	*Simon.Wright at jbarisk.com* <mailto:Simon.Wright at jbarisk.com>
> d: 	+44?(0)1756?587258
> t: 	*+44?(0)1756?799919* <tel:+44%20(0)1756%20799919>
>
> 	
>
> *www.jbarisk.com* <http://www.jbarisk.com/>
>
> Facebook <https://www.facebook.com/TheFloodPeople>
>
> 	
> LinkedIn <https://www.linkedin.com/company/jba-risk-management/>
>
> 	
> Twitter <https://twitter.com/JBARisk>
>
> 	
> YouTube <https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>
>
> 	
>
> All JBA Risk Management's email messages contain confidential 
> information and are intended only for the individual(s) named. If you 
> are not the named addressee you should not disseminate, distribute or 
> copy this e-mail.
> Please notify the sender immediately by email if you have received 
> this email by mistake and delete this email from your system.
> JBA Risk Management Limited is registered in England, company number 
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North 
> Yorkshire, BD23 3FD, England.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image600659.png
Type: image/png
Size: 9321 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image372249.png
Type: image/png
Size: 651 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image259261.png
Type: image/png
Size: 715 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image886659.png
Type: image/png
Size: 966 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image857924.png
Type: image/png
Size: 784 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/5b856e13/attachment-0009.png>

From even.rouault at spatialys.com  Tue Jan  3 12:03:49 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 3 Jan 2023 21:03:49 +0100
Subject: [gdal-dev] GDAL bindings support for Java 17
In-Reply-To: <1gAkJdtLYoujD8AbzTFnNP8xNf7BLbzs8aqHcci32peepL3Qb3xp9rJYs3Fr_R3HA9QH3qopmlUlpmRqTXHBTl9eN2rDsbqSxjAMKB6M1Vs=@protonmail.com>
References: <1gAkJdtLYoujD8AbzTFnNP8xNf7BLbzs8aqHcci32peepL3Qb3xp9rJYs3Fr_R3HA9QH3qopmlUlpmRqTXHBTl9eN2rDsbqSxjAMKB6M1Vs=@protonmail.com>
Message-ID: <eae5f5e6-84e9-d96c-4fe3-40bb8efe29eb@spatialys.com>

Adam,

I cannot help with Mac specificities, but on Ubuntu 20.04, after "sudo 
apt install openjdk-17-jdk openjdk-17-jre", the GDAL Java bindings build 
work just fine and the Java tests run with "ctest -R java" as well.

Even

Le 03/01/2023 ? 18:33, adamgutonski via gdal-dev a ?crit?:
> Hello,
>
> My question is, is it possible to build the GDAL bindings for Java 
> 17?? I am trying to build GDAL with Java bindings for Java 
> temurin-17.jdk when prior I have been able to build and use the 
> bindings successfully for Java adoptopenjdk-8.jdk, using the exact 
> same build process.? However when I run the equivalent build steps 
> with Java 17 I continue to receive this link error when implementing 
> the bindings:
>
> *Native library load failed.*
> *java.lang.UnsatisfiedLinkError: no gdalalljni in java.library.path:* ...
> Exception in thread "main" java.lang.UnsatisfiedLinkError: 'void 
> org.gdal.gdal.gdalJNI.AllRegister()'
> at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
> at org.gdal.gdal.gdal.AllRegister(gdal.java:664)
> at Main.main(Main.java:14)
>
> My system specs:
>
> System Version: macOS 12.6.1 (21G217)
>
> Kernel Version: Darwin 21.6.0
>
> Boot Volume: Macintosh HD
>
> Boot Mode: Normal
>
> Secure Virtual Memory: Enabled
>
> System Integrity Protection: Enabled
>
> Time since boot: 15 days 20:17
>
> Model Name: MacBook Pro
>
> Model Identifier: MacBookPro18,3
>
> Chip: Apple M1 Pro
>
>
> When I run the build I see that the Java bindings are generated, the 
> .jar and libgdalalljni.dylib are created in /build/swig/java. Here are 
> the build?commands used:
>
> sudo arch -x86_64 /usr/local/homebrew/bin/cmake .. 
> -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local/bin 
> -DBUILD_JAVA_BINDINGS=ON -DBUILD_PYTHON_BINDINGS=OFF 
> -DCMAKE_OSX_ARCHITECTURES=x86_64 -DGDAL_USE_ZSTD=OFF
>
>
> sudo arch -x86_64 /usr/local/homebrew/bin/cmake --build .
>
>
> sudo arch -x86_64 /usr/local/homebrew/bin/cmake --build . --target install
>
>
> Again, all of the above steps work when I am using JDK 8.? So does 
> GDAL support Java bindings for JDK 17?? Is there a way to resolve the 
> error *no gdalalljni in java.library.path? *Here are the path settings 
> in IntelliJ IDE:
> *
> *
> *VM options: 
> -Djava.library.path=/Users/<username>/code/gdal-<version>/build/swig/java:$PATH$ 
> Environment Vars: 
> PATH=/Users/<username>/code/gdal-<version>:/Users/<username>/code/gdal-<version>/build/swig/java:$PATH$ 
> *
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230103/bc1c751e/attachment.htm>

From madsvlad at gmail.com  Wed Jan  4 10:34:18 2023
From: madsvlad at gmail.com (Rick Harding)
Date: Wed, 4 Jan 2023 10:34:18 -0800
Subject: [gdal-dev] gdal_contour produces extremely tiny/skinny
 isoline/isopolygon geometry
Message-ID: <CAFFOy7zEmOsBsn7NRZtsVjjj+DD4u8TYfcW4Oh59XL1jmC1Rig@mail.gmail.com>

Hi,

I am using gdal_contour to generate iso-polygons from a hillshade raster
created via the gdal_dem tool. In certain situations, I am seeing a lot of
tiny/narrow polygons and large polygons with long, skinny *whiskers*
protruding out (and sometimes in) . In these cases, the vertices in the
*skinny* areas are less than 1e-07 away from their nearest edge/vertex.

Here is an example of how the tool is being called (GDAL version 3.4.1):
> gdal_contour -p -f GPKG -amin level -nln hillshade -fl 231
295-hillshade-polygon.tif ./295-hillshade-polygons.gpkg

For reference, the hillshade raster has EPSG:4326 defined as its CRS with a
geo-pixel size of (0.044031311154586,-0.044031311154586).

The diagram below depicts a simple example when working through the
marching-squares algorithm by hand with a single threshold level of 231
(prior to the interpolation step):

      229               229              229
          x----------------x----------------x
          |                |                |
          |                |                |
          |     case 2     *      case 1    |
          |               /|\               |
          |              / | \              |
          |             /  |  \             |
      230 x------------*---o---*------------x 230
          |            |  231  |            |
          |            |   |   |            |
          |            |   |   |            |
          |     case 6 |   |   |  case 9    |
          |            |   |   |            |
          |            |  231  |            |
      230 x------------*---o---*------------x 230
          |             \  |  /             |
          |              \ | /              |
          |               \|/               |
          |    case 4      *     case 8     |
          |                |                |
          |                |                |
          x----------------x----------------x
         229              227              226

I would expect the vertices surrounding each of the 231 intensity values to
be coincident, but the final result has the vertices in each set ~8e-08
apart.This leads me to believe there might be some precision issue in
gdal_contour during bipolar edge interpolation?

I ran this same configuration through another isoline generator for
comparison (see https://github.com/rveciana/raster-marching-squares) and
got what I would expect: a degenerate line with two sets of coincident
vertices around each 231 intensity pixel location.

If necessary, I can provide a complete example with the hillshade raster
and the generated polygons.

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230104/b97d1ff9/attachment.htm>

From bradh at frogmouth.net  Wed Jan  4 13:27:54 2023
From: bradh at frogmouth.net (Brad Hards)
Date: Thu, 05 Jan 2023 08:27:54 +1100
Subject: [gdal-dev] gdal_contour produces extremely tiny/skinny
 isoline/isopolygon geometry
In-Reply-To: <CAFFOy7zEmOsBsn7NRZtsVjjj+DD4u8TYfcW4Oh59XL1jmC1Rig@mail.gmail.com>
References: <CAFFOy7zEmOsBsn7NRZtsVjjj+DD4u8TYfcW4Oh59XL1jmC1Rig@mail.gmail.com>
Message-ID: <4801185.31r3eYUQgx@audax>

On Thursday, 5 January 2023 5:34:18 AM AEDT Rick Harding wrote:
> Hi,
> 
> I am using gdal_contour to generate iso-polygons from a hillshade raster
> created via the gdal_dem tool. In certain situations, I am seeing a lot of
> tiny/narrow polygons and large polygons with long, skinny *whiskers*
> protruding out (and sometimes in) . In these cases, the vertices in the
> *skinny* areas are less than 1e-07 away from their nearest edge/vertex.

This seems like the expected behaviour (or at least, reasonable behaviour). 
gdal_contour is expecting a DEM input (not a generic raster or image), and is 
trying to make meaningful contour lines (as you'd see on a map to represent 
elevation). There is an introduction to how it works in
https://github.com/OSGeo/gdal/blob/master/alg/contour.cpp#L380-L549

gdal_contour should take the same input you used for the hillshsade. Input of 
hillshade is probably always going to give you weird results.

It might help to say what you're actually trying to achieve with this (as 
opposed to how), but if you are looking for generic iso-lines of the 
hillshade, try https://gdal.org/programs/gdal_polygonize.html

Brad




From even.rouault at spatialys.com  Wed Jan  4 23:40:28 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Jan 2023 08:40:28 +0100
Subject: [gdal-dev] GDAL 3.6.2 is released
Message-ID: <35bf5e7a-f369-3cb5-cc8d-17e3e0a87f43@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the 
release of the GDAL/OGR 3.6.2 bug fix version (promoting rc1 to final)

Consult the release notes for the list of issues addressed:
 ? https://github.com/OSGeo/gdal/blob/v3.6.2/NEWS.md

The sources are available at:

 ??? https://download.osgeo.org/gdal/3.6.2/gdal-3.6.2.tar.xz
 ??? https://download.osgeo.org/gdal/3.6.2/gdal-3.6.2.tar.gz
 ??? https://download.osgeo.org/gdal/3.6.2/gdal362.zip

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From echterhoff at interactive-instruments.de  Thu Jan  5 05:00:39 2023
From: echterhoff at interactive-instruments.de (Johannes Echterhoff)
Date: Thu, 5 Jan 2023 13:00:39 +0000
Subject: [gdal-dev] GML driver - gfs geometry type values and supported GML
 geometry types
Message-ID: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>

Hi,

The GML driver shows behavior that I do not understand: When I load a feature with a gml:Polygon, which, in the gfs file, is defined with GeomPropertyDefn/Type = Surface, then the geometry does not appear to be understood. At least when I try to load the data in QGIS 3.28.0, then the layer has an unknown geometry type. If, on the other hand, I set GeomPropertyDefn/Type to "Polygon", "MultiPolygon", or even "MultiSurface", the geometry is recognized. Same problem if the feature has a gml:LineString as geometry, and I declare it as GeomPropertyDefn/Type = Curve.

What am I missing here? :-)

Is there some documentation available that sheds light on which gfs geometry type values support which GML geometry types?

Best regards,
Johannes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/59be7633/attachment.htm>

From even.rouault at spatialys.com  Thu Jan  5 06:12:50 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Jan 2023 15:12:50 +0100
Subject: [gdal-dev] GML driver - gfs geometry type values and supported
 GML geometry types
In-Reply-To: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
References: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
Message-ID: <7935d116-880d-6f48-44d2-b5e001ac2887@spatialys.com>

Johannes,

this is more an issue on QGIS side, in its OGR provider where there's 
likely a lack of mapping between the OGR geometry types and QGIS 
geometry types for Curve and Surface (just guessing, didn't check). The 
root cause is that Curve and Surface in OGC/ISO specs are abstract types 
only, not directly instantiable. So it is really hard to have datasets 
where they are reported as layer geometry types, unless you try hard to 
do so, as you did. I'd suggest you use CurvePolygon (resp. 
CompoundCurve) instead of Surface (resp. Curve) in your .gfs file. 
That's what the OGR XSD reader does when encountering a 
gml:SurfacePropertyType or gml:CurvePropertyType. Those are instanciable 
types and QGIS should behave properly

Even

Le 05/01/2023 ? 14:00, Johannes Echterhoff a ?crit?:
>
> Hi,
>
> The GML driver shows behavior that I do not understand: When I load a 
> feature with a gml:Polygon, which, in the gfs file, is defined with 
> GeomPropertyDefn/Type = Surface, then the geometry does not appear to 
> be understood. At least when I try to load the data in QGIS 3.28.0, 
> then the layer has an unknown geometry type. If, on the other hand, I 
> set GeomPropertyDefn/Type to ?Polygon?, ?MultiPolygon?, or even 
> ?MultiSurface?, the geometry is recognized. Same problem if the 
> feature has a gml:LineString as geometry, and I declare it as 
> GeomPropertyDefn/Type = Curve.
>
> What am I missing here? :-)
>
> Is there some documentation available that sheds light on which gfs 
> geometry type values support which GML geometry types?
>
> Best regards,
>
> Johannes
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/ea0cb562/attachment.htm>

From even.rouault at spatialys.com  Thu Jan  5 06:41:45 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Jan 2023 15:41:45 +0100
Subject: [gdal-dev] Call for review and comments on RFC90: Direct access to
 compressed raster data
Message-ID: <aea47ea1-e591-9881-7383-1bb9906369d7@spatialys.com>

Hi,

I've submitted RFC90: Direct access to compressed raster data for review 
and comments:

 ??? ??? https://github.com/OSGeo/gdal/pull/7020

Summary: """

The document proposes 2 new methods to directly obtain the content of a 
window of interest of a raster dataset in its native compressed format. 
Those methods can be optionally implemented and used by drivers to perform:
- extraction of a compressed tile as a standalone file from a container 
format (GeoTIFF, GeoPackage, etc.)
- creation of mosaics from a set of tiles in individual files
- lossless conversion between container formats using the same 
compression method
"""

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From echterhoff at interactive-instruments.de  Thu Jan  5 06:59:36 2023
From: echterhoff at interactive-instruments.de (Johannes Echterhoff)
Date: Thu, 5 Jan 2023 14:59:36 +0000
Subject: [gdal-dev] GML driver - gfs geometry type values and supported
 GML geometry types
In-Reply-To: <7935d116-880d-6f48-44d2-b5e001ac2887@spatialys.com>
References: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <7935d116-880d-6f48-44d2-b5e001ac2887@spatialys.com>
Message-ID: <GV1P193MB223279B832A472FD193523BCFCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>

Even,
Thank you, that was very helpful. Then I?ll map Curve to CompoundCurve and Surface to CurvePolygon.
The possible reason, that this may be due to a lack of mapping between OGR and QGIS geometry types, is quite intriguing. I tried to find out more on the web, and came across https://github.com/qgis/QGIS/blob/master/src/core/providers/ogr/qgsogrprovider.cpp (if that is the right place to look for the actual code), but could not find out more about the implemented mapping. Oh well, it?s ok.
Again, thanks, and best regards,
Johannes

Von: Even Rouault <even.rouault at spatialys.com>
Gesendet: Donnerstag, 5. Januar 2023 15:13
An: Johannes Echterhoff <echterhoff at interactive-instruments.de>; gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] GML driver - gfs geometry type values and supported GML geometry types


Johannes,

this is more an issue on QGIS side, in its OGR provider where there's likely a lack of mapping between the OGR geometry types and QGIS geometry types for Curve and Surface (just guessing, didn't check). The root cause is that Curve and Surface in OGC/ISO specs are abstract types only, not directly instantiable. So it is really hard to have datasets where they are reported as layer geometry types, unless you try hard to do so, as you did. I'd suggest you use CurvePolygon (resp. CompoundCurve) instead of Surface (resp. Curve) in your .gfs file. That's what the OGR XSD reader does when encountering a gml:SurfacePropertyType or gml:CurvePropertyType. Those are instanciable types and QGIS should behave properly

Even
Le 05/01/2023 ? 14:00, Johannes Echterhoff a ?crit :
Hi,

The GML driver shows behavior that I do not understand: When I load a feature with a gml:Polygon, which, in the gfs file, is defined with GeomPropertyDefn/Type = Surface, then the geometry does not appear to be understood. At least when I try to load the data in QGIS 3.28.0, then the layer has an unknown geometry type. If, on the other hand, I set GeomPropertyDefn/Type to ?Polygon?, ?MultiPolygon?, or even ?MultiSurface?, the geometry is recognized. Same problem if the feature has a gml:LineString as geometry, and I declare it as GeomPropertyDefn/Type = Curve.

What am I missing here? :-)

Is there some documentation available that sheds light on which gfs geometry type values support which GML geometry types?

Best regards,
Johannes



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/fd4dd22b/attachment.htm>

From daniel.mannarino at gmail.com  Thu Jan  5 08:16:18 2023
From: daniel.mannarino at gmail.com (Daniel Mannarino)
Date: Thu, 5 Jan 2023 11:16:18 -0500
Subject: [gdal-dev] gdalwarp vs gdal_translate for scaling
Message-ID: <CAO8qHHHDgVmRPU_UpgmSw3u6CYZ1C-mdkjvkKEwZuuzy1t2WpA@mail.gmail.com>

Hi folks!



We have a process that generates web mercator zoom levels by resampling
from the next higher up, from the original resolution down to zoom level 0.
Currently we do so with gdalwarp, but a team member realized that
gdal_translate is capable of the same, and at first glance is much faster.
Unfortunately, using the two commands (below) which I intended to do
exactly the same thing winds up with slightly different results (can/should
I post a small image here to illustrate?).

I won't ask "Which is correct?" because the answer is almost certainly
"That depends on what you want". But can someone help me understand the
difference between what is done with the gdalwarp command versus the
gdal_translate one so that I can decide if using gdal_translate is an
acceptable solution? Here are the two commands:



gdalwarp -te 12523442.714243278 0.0 15028131.257091936 2504688.5428798534
-ts 65536 65536 -r mode -co TILED=YES ../source_tiles/everything.vrt
007R_013C_warp_mode.tif



gdal_translate -r mode -projwin 12523442.714243278 2504688.5428798534
15028131.257091936 0.0 -outsize 65536 65536 -co TILED=YES
../source_tiles/everything.vrt 007R_013C_translate_mode.tif



Thank you!

Daniel Mannarino
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/0cebe32f/attachment.htm>

From pcorti at gmail.com  Thu Jan  5 08:56:36 2023
From: pcorti at gmail.com (Paolo Corti)
Date: Thu, 5 Jan 2023 17:56:36 +0100
Subject: [gdal-dev] vsicurl and HDF5
Message-ID: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>

Hi all

Do you know if I can read HDF5 files with vsicurl?
I made a few tests, but I am getting this error, so I was wondering it
it is even possible:

gdalinfo /vsicurl/https://...../myfile.h5

ERROR 1: CPLCreateUserFaultMapping(): syscall(__NR_userfaultfd)
failed: error = 38

gdalinfo failed - unable to open '/vsicurl/...myfile.h5'.


many thanks in advance
Paolo

-- 
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1

From even.rouault at spatialys.com  Thu Jan  5 09:03:31 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Jan 2023 18:03:31 +0100
Subject: [gdal-dev] vsicurl and HDF5
In-Reply-To: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
References: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
Message-ID: <a1c4476a-0f75-deb0-c33b-4c6ab9c29894@spatialys.com>

Paolo,

Le 05/01/2023 ? 17:56, Paolo Corti a ?crit?:
> Hi all
>
> Do you know if I can read HDF5 files with vsicurl?
> I made a few tests, but I am getting this error, so I was wondering it
> it is even possible:

yes this is possible. If you get the error message you mention, it means 
that the HDF5 driver is not used, but rather the netCDF one, since the 
Linux userfaultfd system call is the trick used by the netCDF driver to 
allow /vsicurl/ usage. Perhaps you are running from a container (like 
Docker) that doesn't enable that system call by default.? With Docker, 
you might need to start your container with --privileged=true

If you have the HDF5 driver available, it is better integrated with the 
VSI virtual file systems and that shoud work on any operating systems, 
whereas /vsicurl/ with the netCDF driver can only work with Linux

Demo:

$ gdalinfo 
/vsicurl/http://download.osgeo.org/gdal/data/hdf5/vlstr_metadata.h5
Driver: HDF5Image/HDF5 Dataset
Files: /vsicurl/http://download.osgeo.org/gdal/data/hdf5/vlstr_metadata.h5
Size is 3024, 1673
Corner Coordinates:
Upper Left? (??? 0.0,??? 0.0)
Lower Left? (??? 0.0, 1673.0)
Upper Right ( 3024.0,??? 0.0)
Lower Right ( 3024.0, 1673.0)
Center????? ( 1512.0,? 836.5)
Band 1 Block=3024x1 Type=Byte, ColorInterp=Undefined
 ? Metadata:
 ??? TEST_BANDNAMES=SAA
 ??? TEST_CODING=0.6666666667 0.0000000000 TRUE
 ??? TEST_FLAGS=255=noValue
 ??? TEST_MAPPING=Geographic Lat/Lon 0.5000000000 0.5000000000 
27.3154761905 -5.0833333333 0.0029761905 0.0029761905 WGS84 Degrees
 ??? TEST_NOVALUE=255
 ??? TEST_RANGE=0 255 0 255

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.


From hyoklee at hdfgroup.org  Thu Jan  5 09:05:04 2023
From: hyoklee at hdfgroup.org (Joe Lee)
Date: Thu, 5 Jan 2023 17:05:04 +0000
Subject: [gdal-dev] vsicurl and HDF5
In-Reply-To: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
References: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
Message-ID: <DM6PR17MB23962AA272209F5707CCF83EC2FA9@DM6PR17MB2396.namprd17.prod.outlook.com>

Yes, it works fine with GDAL 3.6.1:

nene-[11:02am]~/src/software>gdalinfo --version
GDAL 3.6.1, released 2022/12/14
nene-[11:02am]~/src/software>gdalinfo /vsicurl/https://gamma.hdfgroup.org/ftp/pub/outgoing/NASAHDF/VNP46A1.A2020302.h07v07.001.2020303075447.h5
Driver: HDF5/Hierarchical Data Format Release 5
Files: /vsicurl/https://gamma.hdfgroup.org/ftp/pub/outgoing/NASAHDF/VNP46A1.A2020302.h07v07.001.2020303075447.h5
Size is 512, 512
Metadata:
  AlgorithmType=OPS
  EndTime=2020-10-28 23:59:59
  HDFEOS_GRIDS_VNP_Grid_DNB_CMfill=No
HDFEOS_GRIDS_VNP_Grid_DNB_Data_Fields_BrightnessTemperature_M12_add_offset=203
?


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Paolo Corti <pcorti at gmail.com>
Date: Thursday, January 5, 2023 at 10:57 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] vsicurl and HDF5
Hi all

Do you know if I can read HDF5 files with vsicurl?
I made a few tests, but I am getting this error, so I was wondering it
it is even possible:

gdalinfo /vsicurl/https://...../myfile.h5

ERROR 1: CPLCreateUserFaultMapping(): syscall(__NR_userfaultfd)
failed: error = 38

gdalinfo failed - unable to open '/vsicurl/...myfile.h5'.


many thanks in advance
Paolo

--
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/4cc35356/attachment.htm>

From pcorti at gmail.com  Thu Jan  5 10:10:12 2023
From: pcorti at gmail.com (Paolo Corti)
Date: Thu, 5 Jan 2023 19:10:12 +0100
Subject: [gdal-dev] vsicurl and HDF5
In-Reply-To: <a1c4476a-0f75-deb0-c33b-4c6ab9c29894@spatialys.com>
References: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
 <a1c4476a-0f75-deb0-c33b-4c6ab9c29894@spatialys.com>
Message-ID: <CAHXrU-J3oVLMeC8WvjhVDmgnFDNPyROpEj6rE5Vhvf3KdjpKbQ@mail.gmail.com>

On Thu, Jan 5, 2023 at 6:03 PM Even Rouault <even.rouault at spatialys.com> wrote:
>
> Paolo,
>
> Le 05/01/2023 ? 17:56, Paolo Corti a ?crit :
> > Hi all
> >
> > Do you know if I can read HDF5 files with vsicurl?
> > I made a few tests, but I am getting this error, so I was wondering it
> > it is even possible:
>
> yes this is possible. If you get the error message you mention, it means
> that the HDF5 driver is not used, but rather the netCDF one, since the
> Linux userfaultfd system call is the trick used by the netCDF driver to
> allow /vsicurl/ usage. Perhaps you are running from a container (like
> Docker) that doesn't enable that system call by default.  With Docker,
> you might need to start your container with --privileged=true
>
> If you have the HDF5 driver available, it is better integrated with the
> VSI virtual file systems and that shoud work on any operating systems,
> whereas /vsicurl/ with the netCDF driver can only work with Linux
>

Thanks Even!
I just tried with the osgeo GDAL container, and it is working, many thanks!
Previously I tried to run it from OSX, and I got that error.

Thanks also to Joe for testing that :)


--
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1

From hyoklee at hdfgroup.org  Thu Jan  5 10:14:34 2023
From: hyoklee at hdfgroup.org (Joe Lee)
Date: Thu, 5 Jan 2023 18:14:34 +0000
Subject: [gdal-dev] vsicurl and HDF5
In-Reply-To: <CAHXrU-J3oVLMeC8WvjhVDmgnFDNPyROpEj6rE5Vhvf3KdjpKbQ@mail.gmail.com>
References: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
 <a1c4476a-0f75-deb0-c33b-4c6ab9c29894@spatialys.com>
 <CAHXrU-J3oVLMeC8WvjhVDmgnFDNPyROpEj6rE5Vhvf3KdjpKbQ@mail.gmail.com>
Message-ID: <DM6PR17MB239612BDD03214A39D3A2806C2FA9@DM6PR17MB2396.namprd17.prod.outlook.com>

Hi, Paolo!

I tested on mac:

Darwin nene.ad.hdfgroup.org 21.6.0 Darwin Kernel Version 21.6.0: Sun Nov  6 23:31:16 PST 2022; root:xnu-8020.240.14~1/RELEASE_X86_64 x86_64

I?m using `brew install gdal.`

I just tested with 3.6.2 and also worked fine. ?
I hope it works on your Mac too!


From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Paolo Corti <pcorti at gmail.com>
Date: Thursday, January 5, 2023 at 12:10 PM
To: Even Rouault <even.rouault at spatialys.com>
Cc: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] vsicurl and HDF5
On Thu, Jan 5, 2023 at 6:03 PM Even Rouault <even.rouault at spatialys.com> wrote:
>
> Paolo,
>
> Le 05/01/2023 ? 17:56, Paolo Corti a ?crit :
> > Hi all
> >
> > Do you know if I can read HDF5 files with vsicurl?
> > I made a few tests, but I am getting this error, so I was wondering it
> > it is even possible:
>
> yes this is possible. If you get the error message you mention, it means
> that the HDF5 driver is not used, but rather the netCDF one, since the
> Linux userfaultfd system call is the trick used by the netCDF driver to
> allow /vsicurl/ usage. Perhaps you are running from a container (like
> Docker) that doesn't enable that system call by default.  With Docker,
> you might need to start your container with --privileged=true
>
> If you have the HDF5 driver available, it is better integrated with the
> VSI virtual file systems and that shoud work on any operating systems,
> whereas /vsicurl/ with the netCDF driver can only work with Linux
>

Thanks Even!
I just tried with the osgeo GDAL container, and it is working, many thanks!
Previously I tried to run it from OSX, and I got that error.

Thanks also to Joe for testing that :)


--
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/cdbb187d/attachment-0001.htm>

From pcorti at gmail.com  Thu Jan  5 10:24:54 2023
From: pcorti at gmail.com (Paolo Corti)
Date: Thu, 5 Jan 2023 19:24:54 +0100
Subject: [gdal-dev] vsicurl and HDF5
In-Reply-To: <DM6PR17MB239612BDD03214A39D3A2806C2FA9@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <CAHXrU-+eVLA8Emg+=dCEyWYtS4G+rTJSCdZKz7SZvhr=mhjqzA@mail.gmail.com>
 <a1c4476a-0f75-deb0-c33b-4c6ab9c29894@spatialys.com>
 <CAHXrU-J3oVLMeC8WvjhVDmgnFDNPyROpEj6rE5Vhvf3KdjpKbQ@mail.gmail.com>
 <DM6PR17MB239612BDD03214A39D3A2806C2FA9@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <CAHXrU-+EZy8MUw2u6UGXwSoAa=0esN=t6M-EgJgx4aqoASdwmQ@mail.gmail.com>

On Thu, Jan 5, 2023 at 7:14 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Hi, Paolo!
>
>
>
> I tested on mac:
>
>
>
> Darwin nene.ad.hdfgroup.org 21.6.0 Darwin Kernel Version 21.6.0: Sun Nov  6 23:31:16 PST 2022; root:xnu-8020.240.14~1/RELEASE_X86_64 x86_64
>
>
>
> I?m using `brew install gdal.`
>
>
>
> I just tested with 3.6.2 and also worked fine. ?
>
> I hope it works on your Mac too!
>

ah it works for me too now!
Not sure why I got that error before, but great that works from osx too
thanks again

-- 
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1

From even.rouault at spatialys.com  Thu Jan  5 13:50:12 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 5 Jan 2023 22:50:12 +0100
Subject: [gdal-dev] GML driver - gfs geometry type values and supported
 GML geometry types
In-Reply-To: <GV1P193MB223279B832A472FD193523BCFCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
References: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <7935d116-880d-6f48-44d2-b5e001ac2887@spatialys.com>
 <GV1P193MB223279B832A472FD193523BCFCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
Message-ID: <df971557-7a03-32ee-8eaf-588322d908f6@spatialys.com>

> The possible reason, that this may be due to a lack of mapping between 
> OGR and QGIS geometry types, is quite intriguing. I tried to find out 
> more on the web, and came across 
> https://github.com/qgis/QGIS/blob/master/src/core/providers/ogr/qgsogrprovider.cpp 
> (if that is the right place to look for the actual code),
>
==> 
https://github.com/qgis/QGIS/blob/389a8edc721693baa8070fbce8b8488fcc7a7e8c/src/core/providers/ogr/qgsogrproviderutils.cpp#L1935


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230105/d81f1ad8/attachment.htm>

From pcorti at gmail.com  Thu Jan  5 14:19:28 2023
From: pcorti at gmail.com (Paolo Corti)
Date: Thu, 5 Jan 2023 23:19:28 +0100
Subject: [gdal-dev] using vsicurl to read metadata of a resource over https
 with credentials
Message-ID: <CAHXrU-+dpU-ffO1yRb2+0bEkybvGJ=wJqMdWC8Aof1i66n10Gg@mail.gmail.com>

Hi all

I am trying to read metadata from a file over https on a public web
site which requires authentication using gdalinfo and vsicurl - I
don't want to download the file as it is really large.
Without authentication gdalinfo works correctly. However I need to use
authentication, but so far I didn't manage to do that.

This is what I have tried to do so far:

When I am using the browser as an authenticated user, I can download
the file. Looking at the curl call generated by my browser dev
toolbar, I see that the key is the header named "Cookie" containing my
token.

Looking at the doc [1], it looks like GDAL_HTTP_HEADER_FILE
configuration option (or GDAL_HTTP_HEADERS for 3.6) is the way to go.
For that purpose I created a text file containing my header "Cookie"
and its value in the format Cookie:value. Then I have exported
GDAL_HTTP_HEADER_FILE to the file path.

However gdalinfo is still not working and I am wondering If I am doing
something wrong or if there is any other option to include in the
command.

The error I am getting is:

gdalinfo /vsicurl/https://[a-public-site-requiring-credentials]/[my-file-h5]

ERROR 1: Range downloading not supported by this server!
gdalinfo failed - unable to open '/vsicurl/https://l....h5'


Many thanks
Paolo


[1] https://gdal.org/user/virtual_file_systems.html

-- 
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1

From mdsumner at gmail.com  Thu Jan  5 15:36:11 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 6 Jan 2023 10:36:11 +1100
Subject: [gdal-dev] gdalwarp vs gdal_translate for scaling
In-Reply-To: <CAO8qHHHDgVmRPU_UpgmSw3u6CYZ1C-mdkjvkKEwZuuzy1t2WpA@mail.gmail.com>
References: <CAO8qHHHDgVmRPU_UpgmSw3u6CYZ1C-mdkjvkKEwZuuzy1t2WpA@mail.gmail.com>
Message-ID: <CAAcGz9-ico9ujftxtUApAgb-vQJxmX0CGadKpAroSV7u0jgDyg@mail.gmail.com>

in short, warp will give you exactly the target extent of a (possibly) new
grid specification in that -te subdivided by the -ts.

translate will give you approximately the extent provided to projwin, but
snapped to the source grid alignment at a particular zoom implied by the
projwin subdivided by the outsize.

Further, translate can do scaling but warp cannot, which I guess is why you
have a vrt in the workflow - you can scale a source virtually with
translate to vrt, then warp (or translate) that.

(Finally it's a bit sloppy to have such arbitrary extent values that warp
will preserve and I routinely snap them to the source alignment, and I'm
interested to provide such a feature in the warper options too.)

Hope that helps!






On Fri, 6 Jan 2023, 03:16 Daniel Mannarino, <daniel.mannarino at gmail.com>
wrote:

> Hi folks!
>
>
>
> We have a process that generates web mercator zoom levels by resampling
> from the next higher up, from the original resolution down to zoom level 0.
> Currently we do so with gdalwarp, but a team member realized that
> gdal_translate is capable of the same, and at first glance is much faster.
> Unfortunately, using the two commands (below) which I intended to do
> exactly the same thing winds up with slightly different results (can/should
> I post a small image here to illustrate?).
>
> I won't ask "Which is correct?" because the answer is almost certainly
> "That depends on what you want". But can someone help me understand the
> difference between what is done with the gdalwarp command versus the
> gdal_translate one so that I can decide if using gdal_translate is an
> acceptable solution? Here are the two commands:
>
>
>
> gdalwarp -te 12523442.714243278 0.0 15028131.257091936 2504688.5428798534
> -ts 65536 65536 -r mode -co TILED=YES ../source_tiles/everything.vrt
> 007R_013C_warp_mode.tif
>
>
>
> gdal_translate -r mode -projwin 12523442.714243278 2504688.5428798534
> 15028131.257091936 0.0 -outsize 65536 65536 -co TILED=YES
> ../source_tiles/everything.vrt 007R_013C_translate_mode.tif
>
>
>
> Thank you!
>
> Daniel Mannarino
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/55aec946/attachment.htm>

From andrew at aitchison.me.uk  Thu Jan  5 15:51:56 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 5 Jan 2023 23:51:56 +0000 (GMT)
Subject: [gdal-dev] using vsicurl to read metadata of a resource over
 https with credentials
In-Reply-To: <CAHXrU-+dpU-ffO1yRb2+0bEkybvGJ=wJqMdWC8Aof1i66n10Gg@mail.gmail.com>
References: <CAHXrU-+dpU-ffO1yRb2+0bEkybvGJ=wJqMdWC8Aof1i66n10Gg@mail.gmail.com>
Message-ID: <0a8df75a-c80c-3c4d-d210-58f59364705c@aitchison.me.uk>

lOn Thu, 5 Jan 2023, Paolo Corti wrote:

> I am trying to read metadata from a file over https on a public web
> site which requires authentication using gdalinfo and vsicurl - I
> don't want to download the file as it is really large.
> Without authentication gdalinfo works correctly. However I need to use
> authentication, but so far I didn't manage to do that.

> However gdalinfo is still not working and I am wondering If I am doing
> something wrong or if there is any other option to include in the
> command.
>
> The error I am getting is:
>
> gdalinfo /vsicurl/https://[a-public-site-requiring-credentials]/[my-file-h5]
>
> ERROR 1: Range downloading not supported by this server!
> gdalinfo failed - unable to open '/vsicurl/https://l....h5'

Hmm. Can you use gdalinfo /vsicurl *on this site* without autjentication ?

"Range downloading not supported" suggests that the server can only
give you the whole file, not just the bits with the metadata.
I don't think this is about authentication at all.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From mdsumner at gmail.com  Thu Jan  5 15:55:58 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 6 Jan 2023 10:55:58 +1100
Subject: [gdal-dev] gdalwarp vs gdal_translate for scaling
In-Reply-To: <CAAcGz9-ico9ujftxtUApAgb-vQJxmX0CGadKpAroSV7u0jgDyg@mail.gmail.com>
References: <CAO8qHHHDgVmRPU_UpgmSw3u6CYZ1C-mdkjvkKEwZuuzy1t2WpA@mail.gmail.com>
 <CAAcGz9-ico9ujftxtUApAgb-vQJxmX0CGadKpAroSV7u0jgDyg@mail.gmail.com>
Message-ID: <CAAcGz9-HjNL1UubroPi-VPsdR9O6Q7F4qYV-=7quEkdL8xdQKQ@mail.gmail.com>

ugh, sorry just realized my comment (sentence begins 'Further ...') about
"scaling" is completely irrelevant - you mean spatial and not data scaling.
Just ignore that one sentence.

Cheers, Mike



On Fri, Jan 6, 2023 at 10:36 AM Michael Sumner <mdsumner at gmail.com> wrote:

> in short, warp will give you exactly the target extent of a (possibly) new
> grid specification in that -te subdivided by the -ts.
>
> translate will give you approximately the extent provided to projwin, but
> snapped to the source grid alignment at a particular zoom implied by the
> projwin subdivided by the outsize.
>
> Further, translate can do scaling but warp cannot, which I guess is why
> you have a vrt in the workflow - you can scale a source virtually with
> translate to vrt, then warp (or translate) that.
>
> (Finally it's a bit sloppy to have such arbitrary extent values that warp
> will preserve and I routinely snap them to the source alignment, and I'm
> interested to provide such a feature in the warper options too.)
>
> Hope that helps!
>
>
>
>
>
>
> On Fri, 6 Jan 2023, 03:16 Daniel Mannarino, <daniel.mannarino at gmail.com>
> wrote:
>
>> Hi folks!
>>
>>
>>
>> We have a process that generates web mercator zoom levels by resampling
>> from the next higher up, from the original resolution down to zoom level 0.
>> Currently we do so with gdalwarp, but a team member realized that
>> gdal_translate is capable of the same, and at first glance is much faster.
>> Unfortunately, using the two commands (below) which I intended to do
>> exactly the same thing winds up with slightly different results (can/should
>> I post a small image here to illustrate?).
>>
>> I won't ask "Which is correct?" because the answer is almost certainly
>> "That depends on what you want". But can someone help me understand the
>> difference between what is done with the gdalwarp command versus the
>> gdal_translate one so that I can decide if using gdal_translate is an
>> acceptable solution? Here are the two commands:
>>
>>
>>
>> gdalwarp -te 12523442.714243278 0.0 15028131.257091936 2504688.5428798534
>> -ts 65536 65536 -r mode -co TILED=YES ../source_tiles/everything.vrt
>> 007R_013C_warp_mode.tif
>>
>>
>>
>> gdal_translate -r mode -projwin 12523442.714243278 2504688.5428798534
>> 15028131.257091936 0.0 -outsize 65536 65536 -co TILED=YES
>> ../source_tiles/everything.vrt 007R_013C_translate_mode.tif
>>
>>
>>
>> Thank you!
>>
>> Daniel Mannarino
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/4db71598/attachment-0001.htm>

From echterhoff at interactive-instruments.de  Thu Jan  5 22:05:31 2023
From: echterhoff at interactive-instruments.de (Johannes Echterhoff)
Date: Fri, 6 Jan 2023 06:05:31 +0000
Subject: [gdal-dev] GML driver - gfs geometry type values and supported
 GML geometry types
In-Reply-To: <df971557-7a03-32ee-8eaf-588322d908f6@spatialys.com>
References: <GV1P193MB223234B611F4F6C210E02777FCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <7935d116-880d-6f48-44d2-b5e001ac2887@spatialys.com>
 <GV1P193MB223279B832A472FD193523BCFCFA9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>
 <df971557-7a03-32ee-8eaf-588322d908f6@spatialys.com>
Message-ID: <GV1P193MB2232B3404C4A37E37C5C2098FCFB9@GV1P193MB2232.EURP193.PROD.OUTLOOK.COM>

Even,
Thank you so much for providing the right place in the source code with the relevant information about OGR-to-QGIS geometry type mappings! I?ll document that in my mapping instructions.
Best regards,
Johannes

Von: Even Rouault <even.rouault at spatialys.com>
Gesendet: Donnerstag, 5. Januar 2023 22:50
An: Johannes Echterhoff <echterhoff at interactive-instruments.de>; gdal-dev at lists.osgeo.org
Betreff: Re: AW: [gdal-dev] GML driver - gfs geometry type values and supported GML geometry types

The possible reason, that this may be due to a lack of mapping between OGR and QGIS geometry types, is quite intriguing. I tried to find out more on the web, and came across https://github.com/qgis/QGIS/blob/master/src/core/providers/ogr/qgsogrprovider.cpp (if that is the right place to look for the actual code),

==> https://github.com/qgis/QGIS/blob/389a8edc721693baa8070fbce8b8488fcc7a7e8c/src/core/providers/ogr/qgsogrproviderutils.cpp#L1935



--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/53dd85a6/attachment.htm>

From mdsumner at gmail.com  Fri Jan  6 04:27:38 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 6 Jan 2023 23:27:38 +1100
Subject: [gdal-dev] Call for review and comments on RFC90: Direct access
 to compressed raster data
In-Reply-To: <aea47ea1-e591-9881-7383-1bb9906369d7@spatialys.com>
References: <aea47ea1-e591-9881-7383-1bb9906369d7@spatialys.com>
Message-ID: <CAAcGz989+ys+UuAGs1RMf45prLiGMXu81NJFX0=RXsFuDFPDwA@mail.gmail.com>

beautiful!

This has been low level on my mind to ask about. Thanks!

Cheers, Mike

On Fri, 6 Jan 2023, 01:42 Even Rouault, <even.rouault at spatialys.com> wrote:

> Hi,
>
> I've submitted RFC90: Direct access to compressed raster data for review
> and comments:
>
>          https://github.com/OSGeo/gdal/pull/7020
>
> Summary: """
>
> The document proposes 2 new methods to directly obtain the content of a
> window of interest of a raster dataset in its native compressed format.
> Those methods can be optionally implemented and used by drivers to perform:
> - extraction of a compressed tile as a standalone file from a container
> format (GeoTIFF, GeoPackage, etc.)
> - creation of mosaics from a set of tiles in individual files
> - lossless conversion between container formats using the same
> compression method
> """
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/9fb8948e/attachment.htm>

From pcorti at gmail.com  Fri Jan  6 06:14:28 2023
From: pcorti at gmail.com (Paolo Corti)
Date: Fri, 6 Jan 2023 15:14:28 +0100
Subject: [gdal-dev] using vsicurl to read metadata of a resource over
 https with credentials
In-Reply-To: <0a8df75a-c80c-3c4d-d210-58f59364705c@aitchison.me.uk>
References: <CAHXrU-+dpU-ffO1yRb2+0bEkybvGJ=wJqMdWC8Aof1i66n10Gg@mail.gmail.com>
 <0a8df75a-c80c-3c4d-d210-58f59364705c@aitchison.me.uk>
Message-ID: <CAHXrU-JTV=E6h1FTdn5d+pv5nQQbUaPJ2TdEQt8=xANnTFPpAQ@mail.gmail.com>

On Fri, Jan 6, 2023 at 12:52 AM Andrew C Aitchison
<andrew at aitchison.me.uk> wrote:
>
> Hmm. Can you use gdalinfo /vsicurl *on this site* without autjentication ?
>
> "Range downloading not supported" suggests that the server can only
> give you the whole file, not just the bits with the metadata.
> I don't think this is about authentication at all.
>
> --
> Andrew C. Aitchison                      Kendal, UK
>                     andrew at aitchison.me.uk


Hi Andrew
the site without authentication was a test on my dev environment.
Thanks for the idea - interesting: I didn't know it is possible to
configure that in a web server. It could be as you say, however I am
getting the same error when sending the request without credentials.
I'd rather expect for HTTP 401 in that case.
thanks again

Paolo

--
Paolo Corti
Geospatial software developer
web: http://www.paolocorti.net
twitter: @capooti
skype: capooti
#drt3jc1

From carsten.lockenkoetter at web.de  Fri Jan  6 11:34:32 2023
From: carsten.lockenkoetter at web.de (=?iso-8859-1?Q?Carsten_Lockenk=F6tter?=)
Date: Fri, 6 Jan 2023 20:34:32 +0100
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <000301d92204$53f578b0$fbe06a10$@web.de>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
Message-ID: <001601d92205$e6e49060$b4adb120$@web.de>

Hi,



I'm currently building a workflow to crop possible white or black borders
from my Geotiff files and create raster tiles with an alpha band.

I'm using some Python functions provided by you, such as gdal_calc.py.



My workflow works so far, but my problem is that I have to run everything on
my customer's server.

Unfortunately, I don't have the ability to install software there, so I
can't install Python and gdal_calc.py can't be run.



So far, I've always downloaded the compiled binaries from gisinternals.com
and copied them to the server (the zip archive) to use gdalwarp, for
example.

But with that, I can't run gdal_calc, right? Python is still needed for
that, or am I mistaken?



Is there a way to use gdal_calc/gdal_retile without having to install
software components?

If there are approaches to control the functions through a wrapper, that
would also help me.

I have knowledge in C# and could use MaxRev.Gdal.Core, for example. However,
I haven't found an approach yet to use gdal_calc.

I probably have to rewrite the Python script in C#?



Regards,

Carsten

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/2e530649/attachment-0001.htm>

From idan at miara.com  Fri Jan  6 12:14:35 2023
From: idan at miara.com (Idan Miara)
Date: Fri, 6 Jan 2023 22:14:35 +0200
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <001601d92205$e6e49060$b4adb120$@web.de>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
 <001601d92205$e6e49060$b4adb120$@web.de>
Message-ID: <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>

Hi!

gdal_calc is implemented fully in python, so you would need python to run
it.

Assuming your client uses Windows and you don't have admin privileges to
install software, you could install official Python and gdal (from
https://www.lfd.uci.edu/~gohlke/pythonlibs/, which unfortunately is not
maintained anymore) on another Windows machine and then just zip it and
unzip on your clients' pc.

Another option is using OSGeo4W (or QGIS).
In the same way, you could also be able to install it, zip and unzip (I
haven't tried this method recently)

You might still need to install on your clients' pc Visual Studio
Redistributables (which I think both Python and QGIS installers install for
you automatically).
I was successful with both methods, but I think that the first method is
easier.

Maybe also https://pyinstaller.org/en/stable/ could help if you needed to
pack gdal_calc more like a "stand alone app", but I think that wasn't your
issue.

Kind regards,
Idan

On Fri, 6 Jan 2023 at 21:34, Carsten Lockenk?tter <
carsten.lockenkoetter at web.de> wrote:

> Hi,
>
>
>
> I'm currently building a workflow to crop possible white or black borders
> from my Geotiff files and create raster tiles with an alpha band.
>
> I'm using some Python functions provided by you, such as gdal_calc.py.
>
>
>
> My workflow works so far, but my problem is that I have to run everything
> on my customer's server.
>
> Unfortunately, I don't have the ability to install software there, so I
> can't install Python and gdal_calc.py can't be run.
>
>
>
> So far, I've always downloaded the compiled binaries from gisinternals.com
> and copied them to the server (the zip archive) to use gdalwarp, for
> example.
>
> But with that, I can't run gdal_calc, right? Python is still needed for
> that, or am I mistaken?
>
>
>
> Is there a way to use gdal_calc/gdal_retile without having to install
> software components?
>
> If there are approaches to control the functions through a wrapper, that
> would also help me.
>
> I have knowledge in C# and could use MaxRev.Gdal.Core, for example.
> However, I haven't found an approach yet to use gdal_calc.
>
> I probably have to rewrite the Python script in C#?
>
>
>
> Regards,
>
> Carsten
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/157eb31a/attachment.htm>

From carsten.lockenkoetter at web.de  Fri Jan  6 16:18:47 2023
From: carsten.lockenkoetter at web.de (=?utf-8?Q?Carsten_Lockenk=C3=B6tter?=)
Date: Sat, 7 Jan 2023 01:18:47 +0100
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
 <001601d92205$e6e49060$b4adb120$@web.de>
 <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>
Message-ID: <005401d9222d$9ce31220$d6a93660$@web.de>

Hi Idan,

 

Yes, the operating system is Windows.

You mean that I should zip the whole Python installation folder and copy it to the customer environment? 

Or just the Scripts folder? 

Sorry, I am a beginner in Python.

 

I had also thought of the third option with the "stand alone app".

I was just not sure if all dependencies (e.g. numpy) are included.

 

I will try out the options soon, thank you.

I had just hoped that there was an easier way.

It's a pity that the path with Python is so difficult for beginners and that you may have to install it from an unofficial source.

I had already tried to install GDAL via ?pip install GDAL?, but it requires c++ build tools.

Can't this be simplified?

 

Why are scripts like gdal_calc not included to the ?standard? package so that they can be run similarly to gdalinfo?

This would probably make everything a little easier.

 

Regards,

Carsten

 

Von: Idan Miara <idan at miara.com> 
Gesendet: Freitag, 6. Januar 2023 21:15
An: Carsten Lockenk?tter <carsten.lockenkoetter at web.de>
Cc: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Using gdal_calc without python

 

Hi!

 

gdal_calc is implemented fully in python, so you would need python to run it.

 

Assuming your client uses Windows and you don't have admin privileges to install software, you could install official Python and gdal (from https://www.lfd.uci.edu/~gohlke/pythonlibs/, which unfortunately is not maintained anymore) on another Windows machine and then just zip it and unzip on your clients' pc. 

 

Another option is using OSGeo4W (or QGIS).

In the same way, you could also be able to install it, zip and unzip (I haven't tried this method recently)

 

You might still need to install on your clients' pc Visual Studio Redistributables (which I think both Python and QGIS installers install for you automatically).

I was successful with both methods, but I think that the first method is easier.

 

Maybe also https://pyinstaller.org/en/stable/ could help if you needed to pack gdal_calc more like a "stand alone app", but I think that wasn't your issue.

 

Kind regards,

Idan

 

On Fri, 6 Jan 2023 at 21:34, Carsten Lockenk?tter <carsten.lockenkoetter at web.de <mailto:carsten.lockenkoetter at web.de> > wrote:

Hi,

 

I'm currently building a workflow to crop possible white or black borders from my Geotiff files and create raster tiles with an alpha band.

I'm using some Python functions provided by you, such as gdal_calc.py.

 

My workflow works so far, but my problem is that I have to run everything on my customer's server. 

Unfortunately, I don't have the ability to install software there, so I can't install Python and gdal_calc.py can't be run.

 

So far, I've always downloaded the compiled binaries from gisinternals.com <http://gisinternals.com>  and copied them to the server (the zip archive) to use gdalwarp, for example. 

But with that, I can't run gdal_calc, right? Python is still needed for that, or am I mistaken?

 

Is there a way to use gdal_calc/gdal_retile without having to install software components? 

If there are approaches to control the functions through a wrapper, that would also help me. 

I have knowledge in C# and could use MaxRev.Gdal.Core, for example. However, I haven't found an approach yet to use gdal_calc. 

I probably have to rewrite the Python script in C#?

 

Regards,

Carsten

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230107/27284a8a/attachment.htm>

From warmerdam at pobox.com  Fri Jan  6 18:20:19 2023
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 6 Jan 2023 21:20:19 -0500
Subject: [gdal-dev] Call for review and comments on RFC90: Direct access
 to compressed raster data
In-Reply-To: <CAAcGz989+ys+UuAGs1RMf45prLiGMXu81NJFX0=RXsFuDFPDwA@mail.gmail.com>
References: <aea47ea1-e591-9881-7383-1bb9906369d7@spatialys.com>
 <CAAcGz989+ys+UuAGs1RMf45prLiGMXu81NJFX0=RXsFuDFPDwA@mail.gmail.com>
Message-ID: <CA+YzLBddaBqb2RP59QabVnWpEX+3mRrY7vSafyRuM+Oe7mZXOg@mail.gmail.com>

Even,

Very nice!  I am quite supportive.   The interfaces make sense to me.

Best regards,
Frank


On Fri, Jan 6, 2023 at 7:28 AM Michael Sumner <mdsumner at gmail.com> wrote:

> beautiful!
>
> This has been low level on my mind to ask about. Thanks!
>
> Cheers, Mike
>
> On Fri, 6 Jan 2023, 01:42 Even Rouault, <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> I've submitted RFC90: Direct access to compressed raster data for review
>> and comments:
>>
>>          https://github.com/OSGeo/gdal/pull/7020
>>
>> Summary: """
>>
>> The document proposes 2 new methods to directly obtain the content of a
>> window of interest of a raster dataset in its native compressed format.
>> Those methods can be optionally implemented and used by drivers to
>> perform:
>> - extraction of a compressed tile as a standalone file from a container
>> format (GeoTIFF, GeoPackage, etc.)
>> - creation of mosaics from a set of tiles in individual files
>> - lossless conversion between container formats using the same
>> compression method
>> """
>>
>> Even
>>
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230106/a69e8037/attachment-0001.htm>

From idan at miara.com  Sat Jan  7 23:31:36 2023
From: idan at miara.com (Idan Miara)
Date: Sun, 8 Jan 2023 09:31:36 +0200
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <005401d9222d$9ce31220$d6a93660$@web.de>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
 <001601d92205$e6e49060$b4adb120$@web.de>
 <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>
 <005401d9222d$9ce31220$d6a93660$@web.de>
Message-ID: <CADmqiFXmZreS0GL0cUW1Ao6UFnayjHfnSj_L-JZhL5-mo0Er7A@mail.gmail.com>

Hi Carsten,

> You mean that I should zip the whole Python installation folder and copy
it to the customer environment?, Or just the Scripts folder?

Zipping just the scripts folder won't be helpful, as they are only thin
wrappers that are fully dependent on Python and the respective script.

It would be better to zip the whole Python folder and unzip it on the other
computer to the exact same path.
Otherwise - the exe files in the scripts folder might not work (IIRC they
are created when you install Python or the respective package and hardcode
the Python path so you can run them from any folder if they are in the
Windows Path).

You can avoid using the files in the Scripts folder, by calling the script
explicitly (so you are not dependent on any specific folder location or
folder in the path):
For example, for gdal_calc:
`c:\path_to_your_python\python -m osgeo_utils.gdal_calc <input>`
or for pip:
`c:\path_to_your_python\python -m pip install <input>`

Otherwise, if you still want to call the scripts without the full explicit
command then you should note that there were some changes in the wrappers
in gdal 3.5.
In gdal < 3.5 the scripts were thin python wrapper fils, which you could
create batch files for easier access for them:
https://github.com/OSGeo/gdal/blob/master/swig/python/gdal-utils/osgeo_utils/auxiliary/batch_creator.py
I gdal >= 3.5 those wrappers were replaced by thin exe wrappers (which I
think won't work if you change your python folder after installing them):
https://github.com/OSGeo/gdal/pull/5296

> I had also thought of the third option with the "stand alone app". I was
just not sure if all dependencies (e.g. numpy) are included.
I think that dependencies are handled, but again, I don't think that would
be helpful for your use case.


> I had already tried to install GDAL via ?pip install GDAL?, but it
requires c++ build tools. Can't this be simplified?
Yes, it's complicated, you can see discussion here:
https://github.com/OSGeo/gdal/issues/4352

> Why are scripts like gdal_calc not included to the ?standard? package so
that they can be run similarly to gdalinfo?
gdal_calc was implemented only in Python (utilizing the power of
Python...).
gdalinfo was implemented in c++ (and with a Python clone for educational
purposes)

Kind regards,
Idan

On Sat, 7 Jan 2023 at 02:18, Carsten Lockenk?tter <
carsten.lockenkoetter at web.de> wrote:

> Hi Idan,
>
>
>
> Yes, the operating system is Windows.
>
> You mean that I should zip the whole Python installation folder and copy
> it to the customer environment?
>
> Or just the Scripts folder?
>
> Sorry, I am a beginner in Python.
>
>
>
> I had also thought of the third option with the "stand alone app".
>
> I was just not sure if all dependencies (e.g. numpy) are included.
>
>
>
> I will try out the options soon, thank you.
>
> I had just hoped that there was an easier way.
>
> It's a pity that the path with Python is so difficult for beginners and
> that you may have to install it from an unofficial source.
>
> I had already tried to install GDAL via ?pip install GDAL?, but it
> requires c++ build tools.
>
> Can't this be simplified?
>
>
>
> Why are scripts like gdal_calc not included to the ?standard? package so
> that they can be run similarly to gdalinfo?
>
> This would probably make everything a little easier.
>
>
>
> Regards,
>
> Carsten
>
>
>
> *Von:* Idan Miara <idan at miara.com>
> *Gesendet:* Freitag, 6. Januar 2023 21:15
> *An:* Carsten Lockenk?tter <carsten.lockenkoetter at web.de>
> *Cc:* gdal-dev at lists.osgeo.org
> *Betreff:* Re: [gdal-dev] Using gdal_calc without python
>
>
>
> Hi!
>
>
>
> gdal_calc is implemented fully in python, so you would need python to run
> it.
>
>
>
> Assuming your client uses Windows and you don't have admin privileges to
> install software, you could install official Python and gdal (from
> https://www.lfd.uci.edu/~gohlke/pythonlibs/, which unfortunately is not
> maintained anymore) on another Windows machine and then just zip it and
> unzip on your clients' pc.
>
>
>
> Another option is using OSGeo4W (or QGIS).
>
> In the same way, you could also be able to install it, zip and unzip (I
> haven't tried this method recently)
>
>
>
> You might still need to install on your clients' pc Visual Studio
> Redistributables (which I think both Python and QGIS installers install for
> you automatically).
>
> I was successful with both methods, but I think that the first method is
> easier.
>
>
>
> Maybe also https://pyinstaller.org/en/stable/ could help if you needed to
> pack gdal_calc more like a "stand alone app", but I think that wasn't your
> issue.
>
>
>
> Kind regards,
>
> Idan
>
>
>
> On Fri, 6 Jan 2023 at 21:34, Carsten Lockenk?tter <
> carsten.lockenkoetter at web.de> wrote:
>
> Hi,
>
>
>
> I'm currently building a workflow to crop possible white or black borders
> from my Geotiff files and create raster tiles with an alpha band.
>
> I'm using some Python functions provided by you, such as gdal_calc.py.
>
>
>
> My workflow works so far, but my problem is that I have to run everything
> on my customer's server.
>
> Unfortunately, I don't have the ability to install software there, so I
> can't install Python and gdal_calc.py can't be run.
>
>
>
> So far, I've always downloaded the compiled binaries from gisinternals.com
> and copied them to the server (the zip archive) to use gdalwarp, for
> example.
>
> But with that, I can't run gdal_calc, right? Python is still needed for
> that, or am I mistaken?
>
>
>
> Is there a way to use gdal_calc/gdal_retile without having to install
> software components?
>
> If there are approaches to control the functions through a wrapper, that
> would also help me.
>
> I have knowledge in C# and could use MaxRev.Gdal.Core, for example.
> However, I haven't found an approach yet to use gdal_calc.
>
> I probably have to rewrite the Python script in C#?
>
>
>
> Regards,
>
> Carsten
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230108/650e8263/attachment.htm>

From tsvibar at gmail.com  Sat Jan  7 23:37:38 2023
From: tsvibar at gmail.com (Micha Silver)
Date: Sun, 8 Jan 2023 09:37:38 +0200
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <005401d9222d$9ce31220$d6a93660$@web.de>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
 <001601d92205$e6e49060$b4adb120$@web.de>
 <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>
 <005401d9222d$9ce31220$d6a93660$@web.de>
Message-ID: <5a6f708b-1e90-3217-1a3f-f80d170499ad@gmail.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230108/8a77473c/attachment-0001.htm>

From carsten.lockenkoetter at web.de  Sun Jan  8 03:02:26 2023
From: carsten.lockenkoetter at web.de (=?utf-8?Q?Carsten_Lockenk=C3=B6tter?=)
Date: Sun, 8 Jan 2023 12:02:26 +0100
Subject: [gdal-dev] Using gdal_calc without python
In-Reply-To: <5a6f708b-1e90-3217-1a3f-f80d170499ad@gmail.com>
References: <000301d92204$53f578b0$fbe06a10$@web.de>
 <001601d92205$e6e49060$b4adb120$@web.de>
 <CADmqiFWkRWKSzYisJnhd7TE3BA_3RcXJy7HyV14Me2jdLW-y3w@mail.gmail.com>
 <005401d9222d$9ce31220$d6a93660$@web.de>
 <5a6f708b-1e90-3217-1a3f-f80d170499ad@gmail.com>
Message-ID: <001401d92350$b2063f50$1612bdf0$@web.de>

Hi,

 

i tried the ?stand alone apps? and it works as aspected. Thanks Idan.

In the discussion there was posted some new wheel files 1 hour ago.

 <https://github.com/cgohlke/gdal.whl/releases> https://github.com/cgohlke/gdal.whl/releases

 

Von: Micha Silver <tsvibar at gmail.com> 
Gesendet: Sonntag, 8. Januar 2023 08:38
An: Carsten Lockenk?tter <carsten.lockenkoetter at web.de>; 'Idan Miara' <idan at miara.com>
Cc: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Using gdal_calc without python

 

This might be a good case for installing conda ( <https://conda.io/miniconda.html> https://conda.io/miniconda.html). The installation goes in a user's home directory (no need for admin rights), then you can setup a conda environment with whatever version of python you prefer, and install gdal in that env. and have access to all necessary gdal python scripts.

 

On 07/01/2023 2:18, Carsten Lockenk?tter wrote:

Hi Idan,

 

Yes, the operating system is Windows.

You mean that I should zip the whole Python installation folder and copy it to the customer environment? 

Or just the Scripts folder? 

Sorry, I am a beginner in Python.

 

I had also thought of the third option with the "stand alone app".

I was just not sure if all dependencies (e.g. numpy) are included.

 

I will try out the options soon, thank you.

I had just hoped that there was an easier way.

It's a pity that the path with Python is so difficult for beginners and that you may have to install it from an unofficial source.

I had already tried to install GDAL via ?pip install GDAL?, but it requires c++ build tools.

Can't this be simplified?

 

Why are scripts like gdal_calc not included to the ?standard? package so that they can be run similarly to gdalinfo?

This would probably make everything a little easier.

 

Regards,

Carsten

 

Von: Idan Miara  <mailto:idan at miara.com> <idan at miara.com> 
Gesendet: Freitag, 6. Januar 2023 21:15
An: Carsten Lockenk?tter  <mailto:carsten.lockenkoetter at web.de> <carsten.lockenkoetter at web.de>
Cc: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
Betreff: Re: [gdal-dev] Using gdal_calc without python

 

Hi!

 

gdal_calc is implemented fully in python, so you would need python to run it.

 

Assuming your client uses Windows and you don't have admin privileges to install software, you could install official Python and gdal (from https://www.lfd.uci.edu/~gohlke/pythonlibs/, which unfortunately is not maintained anymore) on another Windows machine and then just zip it and unzip on your clients' pc. 

 

Another option is using OSGeo4W (or QGIS).

In the same way, you could also be able to install it, zip and unzip (I haven't tried this method recently)

 

You might still need to install on your clients' pc Visual Studio Redistributables (which I think both Python and QGIS installers install for you automatically).

I was successful with both methods, but I think that the first method is easier.

 

Maybe also https://pyinstaller.org/en/stable/ could help if you needed to pack gdal_calc more like a "stand alone app", but I think that wasn't your issue.

 

Kind regards,

Idan

 

On Fri, 6 Jan 2023 at 21:34, Carsten Lockenk?tter <carsten.lockenkoetter at web.de <mailto:carsten.lockenkoetter at web.de> > wrote:

Hi,

 

I'm currently building a workflow to crop possible white or black borders from my Geotiff files and create raster tiles with an alpha band.

I'm using some Python functions provided by you, such as gdal_calc.py.

 

My workflow works so far, but my problem is that I have to run everything on my customer's server. 

Unfortunately, I don't have the ability to install software there, so I can't install Python and gdal_calc.py can't be run.

 

So far, I've always downloaded the compiled binaries from gisinternals.com <http://gisinternals.com>  and copied them to the server (the zip archive) to use gdalwarp, for example. 

But with that, I can't run gdal_calc, right? Python is still needed for that, or am I mistaken?

 

Is there a way to use gdal_calc/gdal_retile without having to install software components? 

If there are approaches to control the functions through a wrapper, that would also help me. 

I have knowledge in C# and could use MaxRev.Gdal.Core, for example. However, I haven't found an approach yet to use gdal_calc. 

I probably have to rewrite the Python script in C#?

 

Regards,

Carsten

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
https://lists.osgeo.org/mailman/listinfo/gdal-dev





_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230108/64a1dd3e/attachment.htm>

From Isabell.Riesinger at ldbv.bayern.de  Mon Jan  9 01:37:47 2023
From: Isabell.Riesinger at ldbv.bayern.de (Riesinger, Isabell (LDBV))
Date: Mon, 9 Jan 2023 09:37:47 +0000
Subject: [gdal-dev] Error with gdal_translate Raster conversion to MRF
Message-ID: <fe935cf4baa543c7a4f80de66059fc3f@ldbv.bayern.de>

Hello,



i tried to convert a 4-channel Tiff image (aerial image with 20cm GSD, 3 Channels RGBNIR) to the format MRF with gdal_translate. I used gdal_translate in QGIS 3.22 and in the OSGeo4W Shell with following command line:



gdal_translate -a_srs EPSG:25832 -of MRF C:/Temp/AdV/COG_Gdal/Data/122013_0_0275_rgbi.tif C:/Temp/AdV/COG_Gdal/Output/122013_0_0275_rgbi.mrf





However the result are just coloured pixel:

[cid:image003.jpg at 01D92416.69380620]





The versions I used are:



QGIS-Version
3.22.13-Bia?owie?a
QGIS-Codeversion
02ff117<https://github.com/qgis/QGIS/commit/02ff117c4e4d6a4c8c6bd4c1559a60a983d8c700>
Qt-Version
5.15.3
Python-Version
3.9.5
GDAL-Version
3.6.0

PROJ-Version
9.1.0
EPSG-Registraturdatenbankversion
v10.074 (2022-08-01)
GEOS-Version
3.11.1-CAPI-1.17.1
SQLite-Version
3.39.4
PDAL-Version
2.4.3
PostgreSQL-Client-Version
14.3
SpatiaLite-Version
5.0.1
QWT-Version
6.1.6
QScintilla2-Version
2.13.1
BS-Version
Windows 10 Version 2009

Aktive Python-Erweiterungen
copy_coords
0.2
hoehengenauigkeitanflaechen
0.1
ndom_berechnen
0.1
schwellwertndvi
0.1
wbt_for_qgis
1.0.5
db_manager
0.1.20
grassprovider
2.12.99
MetaSearch
0.3.5
processing
2.12.99
sagaprovider
2.12.99

Best regards



Isabell





--

Isabell Riesinger

Landesamt f?r Digitalisierung, Breitband und Vermessung

Alexandrastra?e 4, 80538 M?nchen

Adressansicht im BayernAtlas: https://v.bayern.de/nqhhX



Telefon: +49 (89) 2129 1063

E-Mail: mailto:isabell.riesinger at ldbv.bayern.de

Internet: http://www.ldbv.bayern.de

Datenschutz: https://www.ldbv.bayern.de/datenschutz.html



Instagram: https://www.instagram.com/ldbv.bayern

Besuchen Sie uns auch auf unserer Karrierewebseite www.bayern-insider.de


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 42774 bytes
Desc: image003.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment-0001.jpg>

From Isabell.Riesinger at ldbv.bayern.de  Mon Jan  9 03:55:32 2023
From: Isabell.Riesinger at ldbv.bayern.de (Riesinger, Isabell (LDBV))
Date: Mon, 9 Jan 2023 11:55:32 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 224, Issue 14
In-Reply-To: <mailman.56765.1673257502.32175.gdal-dev@lists.osgeo.org>
References: <mailman.56765.1673257502.32175.gdal-dev@lists.osgeo.org>
Message-ID: <dabeaf2ae7f3498ca1c68defdcca18ee@ldbv.bayern.de>

Just as addition:

I tried the same with a 3-channel image (RGB), so this seems to work. But the result image.mrf has a coordinate offset regarding to the original image.

Best regards 
Isabell

-----Urspr?ngliche Nachricht-----
Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von gdal-dev-request at lists.osgeo.org
Gesendet: Montag, 9. Januar 2023 10:45
An: gdal-dev at lists.osgeo.org
Betreff: gdal-dev Digest, Vol 224, Issue 14

Send gdal-dev mailing list submissions to
	gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
	gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
	gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Error with gdal_translate Raster conversion to MRF
      (Riesinger, Isabell (LDBV))


----------------------------------------------------------------------

Message: 1
Date: Mon, 9 Jan 2023 09:37:47 +0000
From: "Riesinger, Isabell (LDBV)" <Isabell.Riesinger at ldbv.bayern.de>
To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Error with gdal_translate Raster conversion to MRF
Message-ID: <fe935cf4baa543c7a4f80de66059fc3f at ldbv.bayern.de>
Content-Type: text/plain; charset="iso-8859-2"

Hello,



i tried to convert a 4-channel Tiff image (aerial image with 20cm GSD, 3 Channels RGBNIR) to the format MRF with gdal_translate. I used gdal_translate in QGIS 3.22 and in the OSGeo4W Shell with following command line:



gdal_translate -a_srs EPSG:25832 -of MRF C:/Temp/AdV/COG_Gdal/Data/122013_0_0275_rgbi.tif C:/Temp/AdV/COG_Gdal/Output/122013_0_0275_rgbi.mrf





However the result are just coloured pixel:

[cid:image003.jpg at 01D92416.69380620]





The versions I used are:



QGIS-Version
3.22.13-Bia?owie?a
QGIS-Codeversion
02ff117<https://github.com/qgis/QGIS/commit/02ff117c4e4d6a4c8c6bd4c1559a60a983d8c700>
Qt-Version
5.15.3
Python-Version
3.9.5
GDAL-Version
3.6.0

PROJ-Version
9.1.0
EPSG-Registraturdatenbankversion
v10.074 (2022-08-01)
GEOS-Version
3.11.1-CAPI-1.17.1
SQLite-Version
3.39.4
PDAL-Version
2.4.3
PostgreSQL-Client-Version
14.3
SpatiaLite-Version
5.0.1
QWT-Version
6.1.6
QScintilla2-Version
2.13.1
BS-Version
Windows 10 Version 2009

Aktive Python-Erweiterungen
copy_coords
0.2
hoehengenauigkeitanflaechen
0.1
ndom_berechnen
0.1
schwellwertndvi
0.1
wbt_for_qgis
1.0.5
db_manager
0.1.20
grassprovider
2.12.99
MetaSearch
0.3.5
processing
2.12.99
sagaprovider
2.12.99

Best regards



Isabell





--

Isabell Riesinger

Landesamt f?r Digitalisierung, Breitband und Vermessung

Alexandrastra?e 4, 80538 M?nchen

Adressansicht im BayernAtlas: https://v.bayern.de/nqhhX



Telefon: +49 (89) 2129 1063

E-Mail: mailto:isabell.riesinger at ldbv.bayern.de

Internet: http://www.ldbv.bayern.de

Datenschutz: https://www.ldbv.bayern.de/datenschutz.html



Instagram: https://www.instagram.com/ldbv.bayern

Besuchen Sie uns auch auf unserer Karrierewebseite www.bayern-insider.de


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 42774 bytes
Desc: image003.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment.jpg>

------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 224, Issue 14
*****************************************

From Isabell.Riesinger at ldbv.bayern.de  Mon Jan  9 04:08:27 2023
From: Isabell.Riesinger at ldbv.bayern.de (Riesinger, Isabell (LDBV))
Date: Mon, 9 Jan 2023 12:08:27 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 224, Issue 14
In-Reply-To: <mailman.56765.1673257502.32175.gdal-dev@lists.osgeo.org>
References: <mailman.56765.1673257502.32175.gdal-dev@lists.osgeo.org>
Message-ID: <d8c84d46ff42446ea544d018ea336add@ldbv.bayern.de>

Now it works. The problem in the first try seemed to be the rotation of the aerial image because of the coordinate system. I  tried the same with a digital Orthophoto and here it works.

Best regards

Isabell 

-----Urspr?ngliche Nachricht-----
Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von gdal-dev-request at lists.osgeo.org
Gesendet: Montag, 9. Januar 2023 10:45
An: gdal-dev at lists.osgeo.org
Betreff: gdal-dev Digest, Vol 224, Issue 14

Send gdal-dev mailing list submissions to
	gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
	gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
	gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Error with gdal_translate Raster conversion to MRF
      (Riesinger, Isabell (LDBV))


----------------------------------------------------------------------

Message: 1
Date: Mon, 9 Jan 2023 09:37:47 +0000
From: "Riesinger, Isabell (LDBV)" <Isabell.Riesinger at ldbv.bayern.de>
To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Error with gdal_translate Raster conversion to MRF
Message-ID: <fe935cf4baa543c7a4f80de66059fc3f at ldbv.bayern.de>
Content-Type: text/plain; charset="iso-8859-2"

Hello,



i tried to convert a 4-channel Tiff image (aerial image with 20cm GSD, 3 Channels RGBNIR) to the format MRF with gdal_translate. I used gdal_translate in QGIS 3.22 and in the OSGeo4W Shell with following command line:



gdal_translate -a_srs EPSG:25832 -of MRF C:/Temp/AdV/COG_Gdal/Data/122013_0_0275_rgbi.tif C:/Temp/AdV/COG_Gdal/Output/122013_0_0275_rgbi.mrf





However the result are just coloured pixel:

[cid:image003.jpg at 01D92416.69380620]





The versions I used are:



QGIS-Version
3.22.13-Bia?owie?a
QGIS-Codeversion
02ff117<https://github.com/qgis/QGIS/commit/02ff117c4e4d6a4c8c6bd4c1559a60a983d8c700>
Qt-Version
5.15.3
Python-Version
3.9.5
GDAL-Version
3.6.0

PROJ-Version
9.1.0
EPSG-Registraturdatenbankversion
v10.074 (2022-08-01)
GEOS-Version
3.11.1-CAPI-1.17.1
SQLite-Version
3.39.4
PDAL-Version
2.4.3
PostgreSQL-Client-Version
14.3
SpatiaLite-Version
5.0.1
QWT-Version
6.1.6
QScintilla2-Version
2.13.1
BS-Version
Windows 10 Version 2009

Aktive Python-Erweiterungen
copy_coords
0.2
hoehengenauigkeitanflaechen
0.1
ndom_berechnen
0.1
schwellwertndvi
0.1
wbt_for_qgis
1.0.5
db_manager
0.1.20
grassprovider
2.12.99
MetaSearch
0.3.5
processing
2.12.99
sagaprovider
2.12.99

Best regards



Isabell





--

Isabell Riesinger

Landesamt f?r Digitalisierung, Breitband und Vermessung

Alexandrastra?e 4, 80538 M?nchen

Adressansicht im BayernAtlas: https://v.bayern.de/nqhhX



Telefon: +49 (89) 2129 1063

E-Mail: mailto:isabell.riesinger at ldbv.bayern.de

Internet: http://www.ldbv.bayern.de

Datenschutz: https://www.ldbv.bayern.de/datenschutz.html



Instagram: https://www.instagram.com/ldbv.bayern

Besuchen Sie uns auch auf unserer Karrierewebseite www.bayern-insider.de


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.jpg
Type: image/jpeg
Size: 42774 bytes
Desc: image003.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/79e6dee5/attachment.jpg>

------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 224, Issue 14
*****************************************

From even.rouault at spatialys.com  Mon Jan  9 06:19:07 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Jan 2023 15:19:07 +0100
Subject: [gdal-dev] Announcing SOZip: Seek-Optimized profile for the .zip
 format
Message-ID: <27880af0-3036-3c99-9cbf-7ecb0ffd509c@spatialys.com>

Hi,

It is my pleasure to announce ( 
https://github.com/sozip/sozip-spec/blob/master/blog/01-announcement.md 
) the initial release of the specification ( 
https://github.com/sozip/sozip-spec/blob/master/sozip_specification.md ) 
for the SOZip (Seek-Optimized Zip) profile to the ZIP file format, as 
well as its GDAL implementation.

What is SOZip ?
----------------------

A Seek-Optimized ZIP file (SOZip) is a ZIP file that contains one or 
several Deflate-compressed files that are organized and annotated such 
that a SOZip-aware reader can perform very fast random access (seek) 
within a compressed file.

SOZip makes it possible to access large compressed files directly from a 
.zip file without prior decompression. It is not a new file format, but 
a profile of the existing ZIP format, done in a fully backward 
compatible way. ZIP readers that are non-SOZip aware can read a 
SOZip-enabled file normally and ignore the extended features that 
support efficient seek capability.

Use cases
--------------

The SOZip specification is intended to be general purpose / not domain 
specific. It was first developed to serve geospatial use cases, which 
commonly have large compressed files inside of ZIP archives. In 
particular, it makes it possible for users to read large GIS files using 
the Shapefile, GeoPackage or FlatGeobuf formats (which have no native 
provision for compression) compressed in .zip files without prior 
decompression.

Efficient random access and selective decompression are a requirement to 
provide acceptable performance in many usage scenarios: spatial index 
filtering, access to a feature by its identifier, etc.

Performance
------------------

SOZip is efficient:

* The overhead of using a file from a SOZip archive, compared to using 
it uncompressed, is of the order of 10% for common read operations.
* Generation of a SOZip file can be much faster than regular ZIP 
generation when using multithreading.
* SOZip files are typically only ~ 5% larger than regular ZIPs 
(dependent on content, and chunk size)

Have a look at benchmarking results: 
https://github.com/sozip/sozip-spec/blob/master/README.md#benchmarking

Other ZIP related specification
------------------------------------------

The SOZip GitHub organization also hosts the KeyValuePairs extra-field 
specification ( 
https://github.com/sozip/keyvaluepairs-spec/blob/master/zip_keyvalue_extra_field_specification.md 
), to be able to encode arbitrary key-value pairs of metadata associated 
with a file within a ZIP. For example to store the Content-Type of a file.

How does this relate to GDAL ?
-------------------------------------------

Pull request https://github.com/OSGeo/gdal/pull/7042 has been submitted 
with the following enhancements:

*? The /vsizip/ virtual file system uses the SOZip index to perform fast
 ??? random access within a compressed SOZip-enabled file.

* The Shapefile and GPKG drivers can directly generate SOZip-enabled 
.shz/.shp.zip or .gpkg.zip files.

*? Addition of the CPLAddFileInZip() C function that can compress a file 
and add
 ??? it to an new or existing ZIP file, and enable the SOZip 
optimization when relevant.

*? The existed VSIGetFileMetadata() method can be called on a filename of
 ??? the form /vsizip/path/to/the/file.zip/path/inside/the/zip/file and
 ??? with domain = "ZIP" to get information if a SOZip index is 
available for that file.

*? The sozip 
(https://github.com/rouault/gdal/blob/sozip/doc/source/programs/sozip.rst) 
new command line utility
 ??? can be used to create a seek-optimized ZIP file, to append files to 
an existing ZIP file, list the
 ??? contents of a ZIP file and display the SOZip optimization status or 
validate a SOZip file.

Best regards,

Even

-- 

http://www.spatialys.com
My software is free, but my time generally not.


From elpaso at itopen.it  Mon Jan  9 06:29:55 2023
From: elpaso at itopen.it (Alessandro Pasotti)
Date: Mon, 09 Jan 2023 15:29:55 +0100
Subject: [gdal-dev] Announcing SOZip: Seek-Optimized profile for the
 .zip format
In-Reply-To: <27880af0-3036-3c99-9cbf-7ecb0ffd509c@spatialys.com>
Message-ID: <c593b48e-8433-4f68-84e7-6ef0849ea1c5@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/bac989fa/attachment.htm>

From even.rouault at spatialys.com  Mon Jan  9 06:35:03 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Jan 2023 15:35:03 +0100
Subject: [gdal-dev] Announcing SOZip: Seek-Optimized profile for the
 .zip format
In-Reply-To: <c593b48e-8433-4f68-84e7-6ef0849ea1c5@email.android.com>
References: <c593b48e-8433-4f68-84e7-6ef0849ea1c5@email.android.com>
Message-ID: <78122c4a-c64a-51c5-a2d2-34fc57e86661@spatialys.com>


Le 09/01/2023 ? 15:29, Alessandro Pasotti a ?crit?:
> Thank you!
> This is amazing.
>
> Will it be enabled by default?

Yes, the current strategy implemented in the PR is to enable it by 
default when adding files larger than 1 MB through the new 
CPLAddFileInZip() function, which is used when using "ogr2ogr 
out.gpkg.zip input" or "ogr2ogr out.shp.zip input". Of course, there's a 
new configuration option / env. variable to change the default: 
CPL_SOZIP_ENABLED=AUTO/YES/NO.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From kirk.waters at noaa.gov  Mon Jan  9 10:48:32 2023
From: kirk.waters at noaa.gov (Kirk Waters - NOAA Federal)
Date: Mon, 9 Jan 2023 13:48:32 -0500
Subject: [gdal-dev] feet converting to meters unexpectedly
Message-ID: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>

I think I've gotten this solved for my purposes now, but I'm reporting it
here in case anyone else might run across issues using gdal in a conda
environment. If I make a conda environment containing:
python
pdal=2.4.2
gdal
(which ends up with gdal version 3.5.1, pdal version 2.4.2), I get a weird
behavior where
gdalwarp input.tif output.tif
will change the values in the raster as if it is converting from feet to
meters. My example raster where I see this has georeferencing of
EPSG:3521+6360 and is a 32-bit floating point DEM. My use case would have
more arguments to gdalwarp, but I simplified to the minimum that showed the
problem.

If I change the environment package list for conda to not specify the pdal
version, I'll get pdal version 2.4.3 and gdal version 3.6.2 and the raster
will convert correctly.

I did note that in a setup where it converts the values, I see this warning:
Warning 1: Unknown units=US survey foot

Kirk Waters, PhD
NOAA Office for Coastal Management
Applied Sciences Program
?Phone: 843-284-6962? (New as of 2022)
coast.noaa.gov/digitalcoast
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/c843ec5c/attachment-0001.htm>

From even.rouault at spatialys.com  Mon Jan  9 11:10:08 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Jan 2023 20:10:08 +0100
Subject: [gdal-dev] feet converting to meters unexpectedly
In-Reply-To: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
References: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
Message-ID: <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>

Hi,

This is indeed https://github.com/OSGeo/gdal/issues/6839 which has been 
fixed in GDAL 3.6.1.

Even

Le 09/01/2023 ? 19:48, Kirk Waters - NOAA Federal via gdal-dev a ?crit?:
> I think I've gotten this solved for my purposes now, but I'm reporting 
> it here in case anyone else might run across issues using gdal in a 
> conda environment. If I make a conda environment containing:
> python
> pdal=2.4.2
> gdal
> (which ends up with gdal version 3.5.1, pdal version 2.4.2), I get a 
> weird behavior where
> gdalwarp input.tif output.tif
> will change the values in the raster as if it is converting from feet 
> to meters. My example raster where I see this has georeferencing of 
> EPSG:3521+6360 and is a 32-bit floating point DEM. My use case would 
> have more arguments to gdalwarp, but I simplified to the minimum that 
> showed the problem.
>
> If I change the environment package list for conda to not specify the 
> pdal version, I'll get pdal version 2.4.3 and gdal version 3.6.2 and 
> the raster will convert correctly.
>
> I did note that in a setup where it converts the values, I see this 
> warning:
> Warning 1: Unknown units=US survey foot
>
> Kirk Waters, PhD
> NOAA Office for Coastal Management
> Applied Sciences Program
> ?Phone: 843-284-6962? (New as of 2022)
> coast.noaa.gov/digitalcoast <http://coast.noaa.gov/digitalcoast>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/5c13a27a/attachment.htm>

From even.rouault at spatialys.com  Mon Jan  9 11:17:45 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Jan 2023 20:17:45 +0100
Subject: [gdal-dev] feet converting to meters unexpectedly
In-Reply-To: <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
References: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
 <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
Message-ID: <2dbe407f-8fc0-7c41-8c5e-c95485893f04@spatialys.com>

I should also mention that you can probably workaround the issue by 
adding the -novshift switch to your gdalwarp command line: 
https://gdal.org/programs/gdalwarp.html#cmdoption-gdalwarp-novshift

Le 09/01/2023 ? 20:10, Even Rouault a ?crit?:
>
> Hi,
>
> This is indeed https://github.com/OSGeo/gdal/issues/6839 which has 
> been fixed in GDAL 3.6.1.
>
> Even
>
> Le 09/01/2023 ? 19:48, Kirk Waters - NOAA Federal via gdal-dev a ?crit?:
>> I think I've gotten this solved for my purposes now, but I'm 
>> reporting it here in case anyone else might run across issues using 
>> gdal in a conda environment. If I make a conda environment containing:
>> python
>> pdal=2.4.2
>> gdal
>> (which ends up with gdal version 3.5.1, pdal version 2.4.2), I get a 
>> weird behavior where
>> gdalwarp input.tif output.tif
>> will change the values in the raster as if it is converting from feet 
>> to meters. My example raster where I see this has georeferencing of 
>> EPSG:3521+6360 and is a 32-bit floating point DEM. My use case would 
>> have more arguments to gdalwarp, but I simplified to the minimum that 
>> showed the problem.
>>
>> If I change the environment package list for conda to not specify the 
>> pdal version, I'll get pdal version 2.4.3 and gdal version 3.6.2 and 
>> the raster will convert correctly.
>>
>> I did note that in a setup where it converts the values, I see this 
>> warning:
>> Warning 1: Unknown units=US survey foot
>>
>> Kirk Waters, PhD
>> NOAA Office for Coastal Management
>> Applied Sciences Program
>> ?Phone: 843-284-6962? (New as of 2022)
>> coast.noaa.gov/digitalcoast <http://coast.noaa.gov/digitalcoast>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/93532bca/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan  9 11:22:58 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 9 Jan 2023 19:22:58 +0000
Subject: [gdal-dev] feet converting to meters unexpectedly
In-Reply-To: <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
References: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
 <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
Message-ID: <AM0PR09MB32193C0BE7C9CE5FD812F59DFDFE9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I noticed that the survey foot is now deemed obsolete https://www.nist.gov/pml/us-surveyfoot since 1st of January. Should/could there be warnings in GDAL/Proj about that? Or will also the corresponding entries in the EPSG database become obsolete in time?

-Jukka Rahkonen-


L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: maanantai 9. tammikuuta 2023 21.10
Vastaanottaja: Kirk Waters - NOAA Federal <kirk.waters at noaa.gov>; gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] feet converting to meters unexpectedly


Hi,

This is indeed https://github.com/OSGeo/gdal/issues/6839<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fissues%2F6839&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=50fmqgZrGZQQdpKoc1fOlTL0yhI2z1Wf9Dabs0KwExs%3D&reserved=0> which has been fixed in GDAL 3.6.1.

Even
Le 09/01/2023 ? 19:48, Kirk Waters - NOAA Federal via gdal-dev a ?crit :
I think I've gotten this solved for my purposes now, but I'm reporting it here in case anyone else might run across issues using gdal in a conda environment. If I make a conda environment containing:
python
pdal=2.4.2
gdal
(which ends up with gdal version 3.5.1, pdal version 2.4.2), I get a weird behavior where
gdalwarp input.tif output.tif
will change the values in the raster as if it is converting from feet to meters. My example raster where I see this has georeferencing of EPSG:3521+6360 and is a 32-bit floating point DEM. My use case would have more arguments to gdalwarp, but I simplified to the minimum that showed the problem.

If I change the environment package list for conda to not specify the pdal version, I'll get pdal version 2.4.3 and gdal version 3.6.2 and the raster will convert correctly.

I did note that in a setup where it converts the values, I see this warning:
Warning 1: Unknown units=US survey foot

Kirk Waters, PhD
NOAA Office for Coastal Management
Applied Sciences Program
?Phone: 843-284-6962 (New as of 2022)
coast.noaa.gov/digitalcoast<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fcoast.noaa.gov%2Fdigitalcoast&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mFBiuSZzlkEop5b4qQLEcKr1Xmmmu1sGw0NxxOE0dj4%3D&reserved=0>




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3ZnHOEI50I0QfHU5qO6IIOZlEMB4WFJRaBhAaB0vW%2Bk%3D&reserved=0>

--

http://www.spatialys.com<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332944041%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3XoD5Rxng%2BozCi%2FyIAClJLUZHwuJnAhXM%2BAjTn4QtrM%3D&reserved=0>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/e6640ba6/attachment-0001.htm>

From kirk.waters at noaa.gov  Mon Jan  9 11:29:20 2023
From: kirk.waters at noaa.gov (Kirk Waters - NOAA Federal)
Date: Mon, 9 Jan 2023 14:29:20 -0500
Subject: [gdal-dev] feet converting to meters unexpectedly
In-Reply-To: <AM0PR09MB32193C0BE7C9CE5FD812F59DFDFE9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
 <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
 <AM0PR09MB32193C0BE7C9CE5FD812F59DFDFE9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <CADm=QrR=xNPRGw5yK1ufOEv47ggNwvZQBXBE0g7GZgjiFYDaVQ@mail.gmail.com>

It's not exactly that it is obsolete. A better way to think of it might be
that it will not be part of the state plane 2022 definitions, which won't
be out until about 2025. It will always be part of the state plane 1983
definitions.

Kirk


On Mon, Jan 9, 2023 at 2:23 PM Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
>
>
> I noticed that the survey foot is now deemed obsolete
> https://www.nist.gov/pml/us-surveyfoot since 1st of January. Should/could
> there be warnings in GDAL/Proj about that? Or will also the corresponding
> entries in the EPSG database become obsolete in time?
>
>
>
> -Jukka Rahkonen-
>
>
>
>
>
> *L?hett?j?:* gdal-dev <gdal-dev-bounces at lists.osgeo.org> *Puolesta *Even
> Rouault
> *L?hetetty:* maanantai 9. tammikuuta 2023 21.10
> *Vastaanottaja:* Kirk Waters - NOAA Federal <kirk.waters at noaa.gov>;
> gdal-dev at lists.osgeo.org
> *Aihe:* Re: [gdal-dev] feet converting to meters unexpectedly
>
>
>
> Hi,
>
> This is indeed https://github.com/OSGeo/gdal/issues/6839
> <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fissues%2F6839&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=50fmqgZrGZQQdpKoc1fOlTL0yhI2z1Wf9Dabs0KwExs%3D&reserved=0>
> which has been fixed in GDAL 3.6.1.
>
> Even
>
> Le 09/01/2023 ? 19:48, Kirk Waters - NOAA Federal via gdal-dev a ?crit :
>
> I think I've gotten this solved for my purposes now, but I'm reporting it
> here in case anyone else might run across issues using gdal in a conda
> environment. If I make a conda environment containing:
>
> python
>
> pdal=2.4.2
>
> gdal
>
> (which ends up with gdal version 3.5.1, pdal version 2.4.2), I get a weird
> behavior where
>
> gdalwarp input.tif output.tif
>
> will change the values in the raster as if it is converting from feet to
> meters. My example raster where I see this has georeferencing of
> EPSG:3521+6360 and is a 32-bit floating point DEM. My use case would have
> more arguments to gdalwarp, but I simplified to the minimum that showed the
> problem.
>
>
>
> If I change the environment package list for conda to not specify the pdal
> version, I'll get pdal version 2.4.3 and gdal version 3.6.2 and the raster
> will convert correctly.
>
>
>
> I did note that in a setup where it converts the values, I see this
> warning:
>
> Warning 1: Unknown units=US survey foot
>
>
> Kirk Waters, PhD
>
> NOAA Office for Coastal Management
>
> Applied Sciences Program
>
> ?Phone: 843-284-6962 (New as of 2022)
>
> coast.noaa.gov/digitalcoast
> <https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fcoast.noaa.gov%2Fdigitalcoast&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mFBiuSZzlkEop5b4qQLEcKr1Xmmmu1sGw0NxxOE0dj4%3D&reserved=0>
>
>
>
>
>
> _______________________________________________
>
> gdal-dev mailing list
>
> gdal-dev at lists.osgeo.org
>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3ZnHOEI50I0QfHU5qO6IIOZlEMB4WFJRaBhAaB0vW%2Bk%3D&reserved=0>
>
> --
>
> http://www.spatialys.com <https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332944041%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3XoD5Rxng%2BozCi%2FyIAClJLUZHwuJnAhXM%2BAjTn4QtrM%3D&reserved=0>
>
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/49f803c8/attachment.htm>

From even.rouault at spatialys.com  Mon Jan  9 11:31:51 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 9 Jan 2023 20:31:51 +0100
Subject: [gdal-dev] feet converting to meters unexpectedly
In-Reply-To: <AM0PR09MB32193C0BE7C9CE5FD812F59DFDFE9@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <CADm=QrTxxOaV6dnRMJPp-TYJ9_wVYvHah-JMtKRaqSJeyeRh3g@mail.gmail.com>
 <67afd496-a0ed-1d31-c0ec-fb73d368ad9a@spatialys.com>
 <AM0PR09MB32193C0BE7C9CE5FD812F59DFDFE9@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <0058be5c-474a-c742-37fc-8f8aebdae4f9@spatialys.com>


Le 09/01/2023 ? 20:22, Rahkonen Jukka a ?crit?:
>
> Hi,
>
> I noticed that the survey foot is now deemed obsolete 
> https://www.nist.gov/pml/us-surveyfoot since 1^st of January. 
> Should/could there be warnings in GDAL/Proj about that? Or will also 
> the corresponding entries in the EPSG database become obsolete in time?
>
The US government rightly wants to fix the future, but it can't fix the 
past. I bet that the use of CRS using US Survey Foot will outlive all of 
us. IMHO, I don't think it is GDAL/Proj responsibility to do anything 
special regarding that. Probably that tagging those CRS in the EPSG 
database will indeed be the next action, but I believe this should be 
with care as it could have surprising effects. Probably the supersession 
mechanism would be more appropriate than deprecation (deprecation in 
EPSG is often used to tag broken entries. there is nothing broken with 
US Survey Foot)

Even

> -Jukka Rahkonen-
>
> *L?hett?j?:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *Puolesta 
> *Even Rouault
> *L?hetetty:* maanantai 9. tammikuuta 2023 21.10
> *Vastaanottaja:* Kirk Waters - NOAA Federal <kirk.waters at noaa.gov>; 
> gdal-dev at lists.osgeo.org
> *Aihe:* Re: [gdal-dev] feet converting to meters unexpectedly
>
> Hi,
>
> This is indeed https://github.com/OSGeo/gdal/issues/6839 
> <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fissues%2F6839&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=50fmqgZrGZQQdpKoc1fOlTL0yhI2z1Wf9Dabs0KwExs%3D&reserved=0> 
> which has been fixed in GDAL 3.6.1.
>
> Even
>
> Le 09/01/2023 ? 19:48, Kirk Waters - NOAA Federal via gdal-dev a ?crit?:
>
>     I think I've gotten this solved for my purposes now, but I'm
>     reporting it here in case anyone else might run across issues
>     using gdal in a conda environment. If I make a conda environment
>     containing:
>
>     python
>
>     pdal=2.4.2
>
>     gdal
>
>     (which ends up with gdal version 3.5.1, pdal version 2.4.2), I get
>     a weird behavior where
>
>     gdalwarp input.tif output.tif
>
>     will change the values in the raster as if it is converting from
>     feet to meters. My example raster where I see this has
>     georeferencing of EPSG:3521+6360 and is a 32-bit floating point
>     DEM. My use case would have more arguments to gdalwarp, but I
>     simplified to the minimum that showed the problem.
>
>     If I change the environment package list for conda to not specify
>     the pdal version, I'll get pdal version 2.4.3 and gdal version
>     3.6.2 and the raster will convert correctly.
>
>     I did note that in a setup where it converts the values, I see
>     this warning:
>
>     Warning 1: Unknown units=US survey foot
>
>
>     Kirk Waters, PhD
>
>     NOAA Office for Coastal Management
>
>     Applied Sciences Program
>
>     ?Phone: 843-284-6962 (New as of 2022)
>
>     coast.noaa.gov/digitalcoast
>     <https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fcoast.noaa.gov%2Fdigitalcoast&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mFBiuSZzlkEop5b4qQLEcKr1Xmmmu1sGw0NxxOE0dj4%3D&reserved=0>
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org
>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev  <https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332787798%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3ZnHOEI50I0QfHU5qO6IIOZlEMB4WFJRaBhAaB0vW%2Bk%3D&reserved=0>
>
> -- 
> http://www.spatialys.com  <https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7Cff99c3d359784e7f45ce08daf2752dad%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638088882332944041%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=3XoD5Rxng%2BozCi%2FyIAClJLUZHwuJnAhXM%2BAjTn4QtrM%3D&reserved=0>
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230109/60d79c7f/attachment-0001.htm>

From andrew at aitchison.me.uk  Thu Jan 12 09:34:24 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 12 Jan 2023 17:34:24 +0000 (GMT)
Subject: [gdal-dev] gdal git - Test 28 test-virtual-memory (SEGFAULT)
Message-ID: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>


git master sources from today, on Ubuntu 21/10.

With Ubuntu clang version 15.0.2-1 there is one failure that
is not present in my g++ (Ubuntu 12.2.0-3ubuntu1) build:
 	28 - test-virtual-memory (SEGFAULT)

Here is a section of the "make test" output, followed by
     autotest/cpp/testvirtualmem
and
     gdb autotest/cpp/testvirtualmem
runs.

28/51 Testing: test-virtual-memory
28/51 Test: test-virtual-memory
Command: "/home/werdna/git/gdal.build./autotest/cpp/testvirtualmem"
Directory: /home/werdna/git/gdal.build./autotest/cpp
Output:
----------------------------------------------------------
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only mapping
<end of output>
----------------------------------------------------------
Test Failed.
----------------------------------------------------------


*******************************


# autotest/cpp/testvirtualmem
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
Physical memory : 16645120000 bytes
Testing CPLVirtualMemFileMapNew()
test_two_pages()
test_raw_auto(format=EHDR, bFileMapping=1)
test_raw_auto(format=EHDR, bFileMapping=0)
ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only mapping
Segmentation fault (core dumped)


*******************************


# gdb autotest/cpp/testvirtualmem
Starting program: /home/werdna/git/gdal.build.llvm/autotest/cpp/testvirtualmem

[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
Physical memory : 16645120000 bytes
Testing CPLVirtualMemFileMapNew()
[New Thread 0x7fffec1ff6c0 (LWP 2288144)]
test_two_pages()
[New Thread 0x7fffeb9fe6c0 (LWP 2288145)]

Thread 1 "testvirtualmem" received signal SIGSEGV, Segmentation fault.
0x000055555556291d in (anonymous namespace)::test_two_pages (ctxt=0x55555560dc10) at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
133                 char val = addr[MINIMUM_PAGE_SIZE * (i % 3)];
(gdb) where
#0  0x000055555556291d in (anonymous namespace)::test_two_pages (ctxt=0x55555560dc10)
     at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
#1  0x000055555556250e in (anonymous namespace)::testvitualmem_test_Test::TestBody (this=0x55555560bd10)
     at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:266
#2  0x0000555555599d6f in void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) ()
#3  0x0000555555589f56 in testing::Test::Run() ()
#4  0x000055555558a115 in testing::TestInfo::Run() ()
#5  0x000055555558a6e9 in testing::TestSuite::Run() ()
#6  0x000055555558fbdf in testing::internal::UnitTestImpl::RunAllTests() ()
#7  0x000055555559a337 in bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) ()
#8  0x000055555558a1d5 in testing::UnitTest::Run() ()
#9  0x0000555555566971 in RUN_ALL_TESTS () at /usr/include/gtest/gtest.h:2293
#10 0x0000555555566853 in main (argc=1, argv=0x55555560bc00) at /home/werdna/git/gdal/autotest/cpp/main_gtest.cpp:55


-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From even.rouault at spatialys.com  Thu Jan 12 10:49:02 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 12 Jan 2023 19:49:02 +0100
Subject: [gdal-dev] gdal git - Test 28 test-virtual-memory (SEGFAULT)
In-Reply-To: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>
References: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>
Message-ID: <3d61bf80-cb57-1c19-798d-cf8830b7cc18@spatialys.com>

Andrew,

how did you get clang 15.0.2 on Ubuntu 21:10 ? Not through the apt 
package manager with the default apt repositories, right ? Because I've 
just tried with ubuntu 22.04 and this is only clang 14.0.0 that gets 
distributed, and the test runs fine.

That said, I'm moderately surprised that you hit an issue. The 
virtualmem code stuff does some on-the-fly at-hand un-assembling (cf 
https://gdal.org/development/rfc/rfc45_virtualmem.html#low-level-machinery-cpl-virtualmem-h), 
so if a compiler emits new machine instructions the code isn't ready 
for, such errors could happen. So, assuming the compiler you use isn't 
broken, I suspect some code updates are required. But we need to be able 
to reproduce first. Did you also use particular CPPFLAGS that activate 
AVX instruction set or something like that ?

Apart from the inconvenience of the test suite not passing, that doesn't 
invalidate your GDAL build in general. This is a very specific 
functionality that no one triggers without explicitly asking for it.

Even

Le 12/01/2023 ? 18:34, Andrew C Aitchison a ?crit?:
>
> git master sources from today, on Ubuntu 21/10.
>
> With Ubuntu clang version 15.0.2-1 there is one failure that
> is not present in my g++ (Ubuntu 12.2.0-3ubuntu1) build:
> ????28 - test-virtual-memory (SEGFAULT)
>
> Here is a section of the "make test" output, followed by
> ??? autotest/cpp/testvirtualmem
> and
> ??? gdb autotest/cpp/testvirtualmem
> runs.
>
> 28/51 Testing: test-virtual-memory
> 28/51 Test: test-virtual-memory
> Command: "/home/werdna/git/gdal.build./autotest/cpp/testvirtualmem"
> Directory: /home/werdna/git/gdal.build./autotest/cpp
> Output:
> ----------------------------------------------------------
> [==========] Running 1 test from 1 test suite.
> [----------] Global test environment set-up.
> [----------] 1 test from testvitualmem
> [ RUN????? ] testvitualmem.test
> ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only 
> mapping
> <end of output>
> ----------------------------------------------------------
> Test Failed.
> ----------------------------------------------------------
>
>
> *******************************
>
>
> # autotest/cpp/testvirtualmem
> [==========] Running 1 test from 1 test suite.
> [----------] Global test environment set-up.
> [----------] 1 test from testvitualmem
> [ RUN????? ] testvitualmem.test
> Physical memory : 16645120000 bytes
> Testing CPLVirtualMemFileMapNew()
> test_two_pages()
> test_raw_auto(format=EHDR, bFileMapping=1)
> test_raw_auto(format=EHDR, bFileMapping=0)
> ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only 
> mapping
> Segmentation fault (core dumped)
>
>
> *******************************
>
>
> # gdb autotest/cpp/testvirtualmem
> Starting program: 
> /home/werdna/git/gdal.build.llvm/autotest/cpp/testvirtualmem
>
> [Thread debugging using libthread_db enabled]
> Using host libthread_db library 
> "/lib/x86_64-linux-gnu/libthread_db.so.1".
> [==========] Running 1 test from 1 test suite.
> [----------] Global test environment set-up.
> [----------] 1 test from testvitualmem
> [ RUN????? ] testvitualmem.test
> Physical memory : 16645120000 bytes
> Testing CPLVirtualMemFileMapNew()
> [New Thread 0x7fffec1ff6c0 (LWP 2288144)]
> test_two_pages()
> [New Thread 0x7fffeb9fe6c0 (LWP 2288145)]
>
> Thread 1 "testvirtualmem" received signal SIGSEGV, Segmentation fault.
> 0x000055555556291d in (anonymous namespace)::test_two_pages 
> (ctxt=0x55555560dc10) at 
> /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
> 133???????????????? char val = addr[MINIMUM_PAGE_SIZE * (i % 3)];
> (gdb) where
> #0? 0x000055555556291d in (anonymous namespace)::test_two_pages 
> (ctxt=0x55555560dc10)
> ??? at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
> #1? 0x000055555556250e in (anonymous 
> namespace)::testvitualmem_test_Test::TestBody (this=0x55555560bd10)
> ??? at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:266
> #2? 0x0000555555599d6f in void 
> testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, 
> void>(testing::Test*, void (testing::Test::*)(), char const*) ()
> #3? 0x0000555555589f56 in testing::Test::Run() ()
> #4? 0x000055555558a115 in testing::TestInfo::Run() ()
> #5? 0x000055555558a6e9 in testing::TestSuite::Run() ()
> #6? 0x000055555558fbdf in 
> testing::internal::UnitTestImpl::RunAllTests() ()
> #7? 0x000055555559a337 in bool 
> testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, 
> bool>(testing::internal::UnitTestImpl*, bool 
> (testing::internal::UnitTestImpl::*)(), char const*) ()
> #8? 0x000055555558a1d5 in testing::UnitTest::Run() ()
> #9? 0x0000555555566971 in RUN_ALL_TESTS () at 
> /usr/include/gtest/gtest.h:2293
> #10 0x0000555555566853 in main (argc=1, argv=0x55555560bc00) at 
> /home/werdna/git/gdal/autotest/cpp/main_gtest.cpp:55
>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew at aitchison.me.uk  Thu Jan 12 09:34:24 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 12 Jan 2023 17:34:24 +0000 (GMT)
Subject: [gdal-dev] gdal git - Test 28 test-virtual-memory (SEGFAULT)
Message-ID: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>


git master sources from today, on Ubuntu 21/10.

With Ubuntu clang version 15.0.2-1 there is one failure that
is not present in my g++ (Ubuntu 12.2.0-3ubuntu1) build:
 	28 - test-virtual-memory (SEGFAULT)

Here is a section of the "make test" output, followed by
     autotest/cpp/testvirtualmem
and
     gdb autotest/cpp/testvirtualmem
runs.

28/51 Testing: test-virtual-memory
28/51 Test: test-virtual-memory
Command: "/home/werdna/git/gdal.build./autotest/cpp/testvirtualmem"
Directory: /home/werdna/git/gdal.build./autotest/cpp
Output:
----------------------------------------------------------
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only mapping
<end of output>
----------------------------------------------------------
Test Failed.
----------------------------------------------------------


*******************************


# autotest/cpp/testvirtualmem
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
Physical memory : 16645120000 bytes
Testing CPLVirtualMemFileMapNew()
test_two_pages()
test_raw_auto(format=EHDR, bFileMapping=1)
test_raw_auto(format=EHDR, bFileMapping=0)
ERROR 1: CPLVirtualMemManagerThread: trying to write into read-only mapping
Segmentation fault (core dumped)


*******************************


# gdb autotest/cpp/testvirtualmem
Starting program: /home/werdna/git/gdal.build.llvm/autotest/cpp/testvirtualmem

[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from testvitualmem
[ RUN      ] testvitualmem.test
Physical memory : 16645120000 bytes
Testing CPLVirtualMemFileMapNew()
[New Thread 0x7fffec1ff6c0 (LWP 2288144)]
test_two_pages()
[New Thread 0x7fffeb9fe6c0 (LWP 2288145)]

Thread 1 "testvirtualmem" received signal SIGSEGV, Segmentation fault.
0x000055555556291d in (anonymous namespace)::test_two_pages (ctxt=0x55555560dc10) at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
133                 char val = addr[MINIMUM_PAGE_SIZE * (i % 3)];
(gdb) where
#0  0x000055555556291d in (anonymous namespace)::test_two_pages (ctxt=0x55555560dc10)
     at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:133
#1  0x000055555556250e in (anonymous namespace)::testvitualmem_test_Test::TestBody (this=0x55555560bd10)
     at /home/werdna/git/gdal/autotest/cpp/testvirtualmem.cpp:266
#2  0x0000555555599d6f in void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) ()
#3  0x0000555555589f56 in testing::Test::Run() ()
#4  0x000055555558a115 in testing::TestInfo::Run() ()
#5  0x000055555558a6e9 in testing::TestSuite::Run() ()
#6  0x000055555558fbdf in testing::internal::UnitTestImpl::RunAllTests() ()
#7  0x000055555559a337 in bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) ()
#8  0x000055555558a1d5 in testing::UnitTest::Run() ()
#9  0x0000555555566971 in RUN_ALL_TESTS () at /usr/include/gtest/gtest.h:2293
#10 0x0000555555566853 in main (argc=1, argv=0x55555560bc00) at /home/werdna/git/gdal/autotest/cpp/main_gtest.cpp:55


-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk


From andrew at aitchison.me.uk  Thu Jan 12 14:23:43 2023
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Thu, 12 Jan 2023 22:23:43 +0000 (GMT)
Subject: [gdal-dev] gdal git - Test 28 test-virtual-memory (SEGFAULT)
In-Reply-To: <3d61bf80-cb57-1c19-798d-cf8830b7cc18@spatialys.com>
References: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>
 <3d61bf80-cb57-1c19-798d-cf8830b7cc18@spatialys.com>
Message-ID: <254ca020-c47b-1768-c3e3-5f9febcd601c@aitchison.me.uk>

On Thu, 12 Jan 2023, Even Rouault wrote:

> Andrew,
>
> how did you get clang 15.0.2 on Ubuntu 21:10 ? Not through the apt package 
> manager with the default apt repositories, right ? Because I've just tried 
> with ubuntu 22.04 and this is only clang 14.0.0 that gets distributed, and 
> the test runs fine.

'sudo apt reinstall clang-15' gives:

Get:1 http://gb.archive.ubuntu.com/ubuntu kinetic/universe amd64 clang-15 
amd64 1:15.0.2-1 [80.5 kB]
Fetched 80.5 kB in 0s (205 kB/s)
(Reading database ... 1008451 files and directories currently installed.)
Preparing to unpack .../clang-15_1%3a15.0.2-1_amd64.deb ...
Unpacking clang-15 (1:15.0.2-1) over (1:15.0.2-1) ...
Setting up clang-15 (1:15.0.2-1) ...

I think the "universe" and "clang-15" might be the significant differences.

> That said, I'm moderately surprised that you hit an issue. The virtualmem 
> code stuff does some on-the-fly at-hand un-assembling (cf 
> https://gdal.org/development/rfc/rfc45_virtualmem.html#low-level-machinery-cpl-virtualmem-h), 
> so if a compiler emits new machine instructions the code isn't ready for, 
> such errors could happen. So, assuming the compiler you use isn't broken, I 
> suspect some code updates are required. But we need to be able to reproduce 
> first. Did you also use particular CPPFLAGS that activate AVX instruction set 
> or something like that ?

Not explicitly, but
    autotest/cpp/CMakeFiles/testvirtualmem.dir/flags.make
does mention such things, though the flags in the clang-14 version
are no different. Here it is in full:
-------------------------
# CMAKE generated file: DO NOT EDIT!
# Generated by "Unix Makefiles" Generator, CMake Version 3.24

# compile CXX with /usr/lib/llvm-15/bin/clang++
CXX_DEFINES = -DDONT_DEPRECATE_SPRINTF -DGDAL_COMPILATION -DGDAL_TEST_ROOT_DIR=\"/home/werdna/git/gdal/autotest\" -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME

CXX_INCLUDES = -I/home/werdna/git/gdal/apps -I/home/werdna/git/gdal/alg -I/home/werdna/git/gdal/gcore -I/home/werdna/git/gdal.build.llvm/gcore -I/home/werdna/git/gdal/port -I/home/werdna/git/gdal.build.llvm/port -I/home/werdna/git/gdal/ogr -I/home/werdna/git/gdal/ogr/ogrsf_frmts -I/home/werdna/git/gdal/frmts -I/home/werdna/git/gdal.build.llvm/gcore/gdal_version_full

CXX_FLAGS =  -fno-finite-math-only -fvisibility=hidden  -g -Wall -Wextra -Winit-self -Wunused-parameter -Wmissing-declarations -Wshorten-64-to-32 -Wshadow -Wshadow-field -Wmissing-include-dirs -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla -Wdate-time -Wnull-dereference -Wextra-semi -Wcomma -Wfloat-conversion -Wdocumentation -Wno-documentation-deprecated-sync -Wunused-private-field -Wnon-virtual-dtor -Woverloaded-virtual -Wsuggest-override -fno-operator-names -Wzero-as-null-pointer-constant -DGTEST_HAS_PTHREAD=1 -std=gnu++11
-------------------------

The overall CMakeCache.txt is at
https://www.aitchison.me.uk/gdal/CMakeCache.txt.clang15.20230112.txt


> Apart from the inconvenience of the test suite not passing, that doesn't 
> invalidate your GDAL build in general. This is a very specific functionality 
> that no one triggers without explicitly asking for it.
>
> Even

Thanks.

-- 
Andrew C. Aitchison                      Kendal, UK
                    andrew at aitchison.me.uk

From even.rouault at spatialys.com  Thu Jan 12 15:43:14 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 13 Jan 2023 00:43:14 +0100
Subject: [gdal-dev] gdal git - Test 28 test-virtual-memory (SEGFAULT)
In-Reply-To: <254ca020-c47b-1768-c3e3-5f9febcd601c@aitchison.me.uk>
References: <85c297bd-b970-0247-a924-36aa67b3505b@aitchison.me.uk>
 <3d61bf80-cb57-1c19-798d-cf8830b7cc18@spatialys.com>
 <254ca020-c47b-1768-c3e3-5f9febcd601c@aitchison.me.uk>
Message-ID: <c0b5839a-9552-221d-35d7-18b01c3bace1@spatialys.com>

fixed per https://github.com/OSGeo/gdal/pull/7058

Even

Le 12/01/2023 ? 23:23, Andrew C Aitchison a ?crit?:
> On Thu, 12 Jan 2023, Even Rouault wrote:
>
>> Andrew,
>>
>> how did you get clang 15.0.2 on Ubuntu 21:10 ? Not through the apt 
>> package manager with the default apt repositories, right ? Because 
>> I've just tried with ubuntu 22.04 and this is only clang 14.0.0 that 
>> gets distributed, and the test runs fine.
>
> 'sudo apt reinstall clang-15' gives:
>
> Get:1 http://gb.archive.ubuntu.com/ubuntu kinetic/universe amd64 
> clang-15 amd64 1:15.0.2-1 [80.5 kB]
> Fetched 80.5 kB in 0s (205 kB/s)
> (Reading database ... 1008451 files and directories currently installed.)
> Preparing to unpack .../clang-15_1%3a15.0.2-1_amd64.deb ...
> Unpacking clang-15 (1:15.0.2-1) over (1:15.0.2-1) ...
> Setting up clang-15 (1:15.0.2-1) ...
>
> I think the "universe" and "clang-15" might be the significant 
> differences.
>
>> That said, I'm moderately surprised that you hit an issue. The 
>> virtualmem code stuff does some on-the-fly at-hand un-assembling (cf 
>> https://gdal.org/development/rfc/rfc45_virtualmem.html#low-level-machinery-cpl-virtualmem-h), 
>> so if a compiler emits new machine instructions the code isn't ready 
>> for, such errors could happen. So, assuming the compiler you use 
>> isn't broken, I suspect some code updates are required. But we need 
>> to be able to reproduce first. Did you also use particular CPPFLAGS 
>> that activate AVX instruction set or something like that ?
>
> Not explicitly, but
> ?? autotest/cpp/CMakeFiles/testvirtualmem.dir/flags.make
> does mention such things, though the flags in the clang-14 version
> are no different. Here it is in full:
> -------------------------
> # CMAKE generated file: DO NOT EDIT!
> # Generated by "Unix Makefiles" Generator, CMake Version 3.24
>
> # compile CXX with /usr/lib/llvm-15/bin/clang++
> CXX_DEFINES = -DDONT_DEPRECATE_SPRINTF -DGDAL_COMPILATION 
> -DGDAL_TEST_ROOT_DIR=\"/home/werdna/git/gdal/autotest\" 
> -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME 
> -DHAVE_SSSE3_AT_COMPILE_TIME
>
> CXX_INCLUDES = -I/home/werdna/git/gdal/apps 
> -I/home/werdna/git/gdal/alg -I/home/werdna/git/gdal/gcore 
> -I/home/werdna/git/gdal.build.llvm/gcore -I/home/werdna/git/gdal/port 
> -I/home/werdna/git/gdal.build.llvm/port -I/home/werdna/git/gdal/ogr 
> -I/home/werdna/git/gdal/ogr/ogrsf_frmts -I/home/werdna/git/gdal/frmts 
> -I/home/werdna/git/gdal.build.llvm/gcore/gdal_version_full
>
> CXX_FLAGS =? -fno-finite-math-only -fvisibility=hidden? -g -Wall 
> -Wextra -Winit-self -Wunused-parameter -Wmissing-declarations 
> -Wshorten-64-to-32 -Wshadow -Wshadow-field -Wmissing-include-dirs 
> -Wformat -Werror=format-security -Wno-format-nonliteral -Werror=vla 
> -Wdate-time -Wnull-dereference -Wextra-semi -Wcomma -Wfloat-conversion 
> -Wdocumentation -Wno-documentation-deprecated-sync 
> -Wunused-private-field -Wnon-virtual-dtor -Woverloaded-virtual 
> -Wsuggest-override -fno-operator-names -Wzero-as-null-pointer-constant 
> -DGTEST_HAS_PTHREAD=1 -std=gnu++11
> -------------------------
>
> The overall CMakeCache.txt is at
> https://www.aitchison.me.uk/gdal/CMakeCache.txt.clang15.20230112.txt
>
>
>> Apart from the inconvenience of the test suite not passing, that 
>> doesn't invalidate your GDAL build in general. This is a very 
>> specific functionality that no one triggers without explicitly asking 
>> for it.
>>
>> Even
>
> Thanks.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From lnicola at dend.ro  Mon Jan 16 03:58:28 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Mon, 16 Jan 2023 13:58:28 +0200
Subject: [gdal-dev] Interaction between no data and resampling
Message-ID: <4011117a-6618-4051-819a-70406a4983d3@betaapp.fastmail.com>

Hello,

I've been looking over the docs and the code, but I'm still a little confused about how masking and/or no data are handled during resampling in GDAL. I'm interested mostly in the `cubic` and `average` resamples, but I assume the answers will apply to the other modes just as well.

In my understanding:
 * `cubic` will happily include "no data" values in the computation, likely outputting not very useful results
 * `average` will ignore no data input pixels; but how does average pick the weights? The `gdal_translate` docs say "Starting with GDAL 3.1, this is a weighted average taking into account properly the weight of source pixels not contributing fully to the target pixel". I assume that's mostly unrelated.
 * the `-srcnodata` docs and `gdalwarpkernel.cpp` suggest that masked pixels are not included in the computation (unlike those of no data?)
I know two ways of handling masked/no data pixels during resampling:
 * ignore them and rescale the remaining weights of the input pixels (e.g. a 4x4 grid in the `cubic` case), outputting no data if there's no valid pixel among the inputs -- this seems "ideal"
 * output no data if any of the input (e.g. 4x4 grid) pixels are no data
The latter method can be simulated in a reasonably easy way by making a validity mask, resampling it with the same method, then thresholding it to get a new mask which only keeps the "pure" pixels. It might even be possible (but maybe not too easy) to implement do this with a VRT. But its disadvantage is that it tends to expand the invalid areas.

So my main question if there's a supported way to handle this in GDAL (using band masks?), and what does it do (will I get the "ideal" result from above?).

Regards,
Laurentiu Nicola
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/8f3f3fc0/attachment.htm>

From lnicola at dend.ro  Mon Jan 16 04:05:03 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Mon, 16 Jan 2023 14:05:03 +0200
Subject: [gdal-dev] Interaction between no data and resampling
In-Reply-To: <4011117a-6618-4051-819a-70406a4983d3@betaapp.fastmail.com>
References: <4011117a-6618-4051-819a-70406a4983d3@betaapp.fastmail.com>
Message-ID: <72f837c9-80b5-4e9a-a90b-e58b758730af@betaapp.fastmail.com>

PS:

On Mon, Jan 16, 2023, at 13:58, Lauren?iu Nicola wrote:
> 
>  * the `-srcnodata` docs and `gdalwarpkernel.cpp` suggest that masked pixels are not included in the computation (unlike those of no data?)
The remark in the brackets is wrong, of course, since the docs are specifically about `-srcnodata` . But I'm still unsure how these are handled in the code. I probably missed something, but I saw the checks <https://github.com/OSGeo/gdal/blob/master/alg/gdalwarpkernel.cpp#L1225> for a mask, but not no data.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/7225e0c7/attachment.htm>

From lnicola at dend.ro  Mon Jan 16 04:32:47 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Mon, 16 Jan 2023 14:32:47 +0200
Subject: [gdal-dev] Interaction between no data and resampling
In-Reply-To: <72f837c9-80b5-4e9a-a90b-e58b758730af@betaapp.fastmail.com>
References: <4011117a-6618-4051-819a-70406a4983d3@betaapp.fastmail.com>
 <72f837c9-80b5-4e9a-a90b-e58b758730af@betaapp.fastmail.com>
Message-ID: <e4578776-7185-4f76-a314-8f02c6688ee1@betaapp.fastmail.com>

PPS: Looks like some experimentation is probably better than weeks of worrying :-). It looks like the input no data values are actually not included in the computation. But I'd still like to know how they are handled, if that's possible.

Laurentiu

On Mon, Jan 16, 2023, at 14:05, Lauren?iu Nicola via gdal-dev wrote:
> PS:
> 
> On Mon, Jan 16, 2023, at 13:58, Lauren?iu Nicola wrote:
>> 
>>  * the `-srcnodata` docs and `gdalwarpkernel.cpp` suggest that masked pixels are not included in the computation (unlike those of no data?)
> The remark in the brackets is wrong, of course, since the docs are specifically about `-srcnodata` . But I'm still unsure how these are handled in the code. I probably missed something, but I saw the checks <https://github.com/OSGeo/gdal/blob/master/alg/gdalwarpkernel.cpp#L1225> for a mask, but not no data.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/d0af794e/attachment-0001.htm>

From even.rouault at spatialys.com  Mon Jan 16 09:02:47 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Jan 2023 18:02:47 +0100
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
Message-ID: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>

Hi,

Motion: Approve RFC90: Direct access to compressed raster data:

https://github.com/OSGeo/gdal/pull/7020

Starting with my +1

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Mon Jan 16 10:49:22 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 16 Jan 2023 18:49:22 +0000
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
Message-ID: <AM0PR09MB321933BCFD8FAB85D2B68B75FDC19@AM0PR09MB3219.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: maanantai 16. tammikuuta 2023 19.03
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: Approve RFC90: Direct access to compressed raster data

Hi,

Motion: Approve RFC90: Direct access to compressed raster data:

https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fpull%2F7020&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=GYfxNFA5oYiL8wGZzuAvyur6t8oxBVqQYgDB8SWLIwg%3D&reserved=0

Starting with my +1

Even

-- 
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rCvk7GKM68zEfkMNNexSx2%2Flp1%2BK6ohRXGHmkQWwSW8%3D&reserved=0
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FWT%2FhEfr2WEZ3jIlTRhlY%2FNDWz3OBxhuqAOcJ%2BxRWkY%3D&reserved=0

From warmerdam at pobox.com  Mon Jan 16 11:54:26 2023
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon, 16 Jan 2023 14:54:26 -0500
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <AM0PR09MB321933BCFD8FAB85D2B68B75FDC19@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
 <AM0PR09MB321933BCFD8FAB85D2B68B75FDC19@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <CA+YzLBdj5zKsuKEXpqC+Jok=J8KGSd46whYkWvAJaUqv23wkzA@mail.gmail.com>

+1 Frank

On Mon, Jan 16, 2023 at 1:49 PM Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> +1
>
> -Jukka Rahkonen-
>
> -----Alkuper?inen viesti-----
> L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even
> Rouault
> L?hetetty: maanantai 16. tammikuuta 2023 19.03
> Vastaanottaja: gdal-dev at lists.osgeo.org
> Aihe: [gdal-dev] Motion: Approve RFC90: Direct access to compressed raster
> data
>
> Hi,
>
> Motion: Approve RFC90: Direct access to compressed raster data:
>
>
> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fpull%2F7020&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=GYfxNFA5oYiL8wGZzuAvyur6t8oxBVqQYgDB8SWLIwg%3D&reserved=0
>
> Starting with my +1
>
> Even
>
> --
>
> https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=rCvk7GKM68zEfkMNNexSx2%2Flp1%2BK6ohRXGHmkQWwSW8%3D&reserved=0
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
>
> https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C4f723d3633d343e143e308daf7e38d49%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638094853948894849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FWT%2FhEfr2WEZ3jIlTRhlY%2FNDWz3OBxhuqAOcJ%2BxRWkY%3D&reserved=0
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/e220dfa2/attachment.htm>

From sean.gillies at gmail.com  Mon Jan 16 12:17:34 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Mon, 16 Jan 2023 13:17:34 -0700
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
Message-ID: <CAOodmJo_zdk525snMvdX3fMKUbBEtPnoF9Z1rO1-yRW-qR+mcA@mail.gmail.com>

I'm +1. Norman Barker wrote something like this when we worked together, so
I get the point of it clearly.

https://www.rfc-editor.org/rfc/rfc6838#page-13 has some things to say about
the parameters returned by GetCompressionFormat after, e.g., "image/jpeg".

* Parameters are case insensitive
* Order has no meaning
* More than one instance of a parameter is an error

It's possible that some image media types are defined so that no such
parameters are allowed. I don't see that this is the case for image/jpeg,
so we're probably fine.

If we don't want to think about official media types at all, which might be
a good idea, couldn't we use driver names instead? "JPEG; foo=bar" instead
of "image/jpeg; foo=bar" for example.


On Mon, Jan 16, 2023 at 10:03 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Motion: Approve RFC90: Direct access to compressed raster data:
>
> https://github.com/OSGeo/gdal/pull/7020
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/33224555/attachment.htm>

From even.rouault at spatialys.com  Mon Jan 16 12:39:53 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Jan 2023 21:39:53 +0100
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <CAOodmJo_zdk525snMvdX3fMKUbBEtPnoF9Z1rO1-yRW-qR+mcA@mail.gmail.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
 <CAOodmJo_zdk525snMvdX3fMKUbBEtPnoF9Z1rO1-yRW-qR+mcA@mail.gmail.com>
Message-ID: <ac615be8-c619-f1a4-5cd0-2cbea32e6b0e@spatialys.com>

H Sean,

>
> If we don't want to think about official media types at all, which 
> might be a good idea, couldn't we use driver names instead? "JPEG; 
> foo=bar" instead of "image/jpeg; foo=bar" for example.

Initially I had used driver names + a char** papszOptions for 
ReadCompressedData(), but I also needed characteristics of the format to 
be returned in the list of strings of GetCompressionFormats(). So I 
figured out that using a single string with a MIME type syntax could 
suit both purposes while being (or maybe just looking) more standard. 
The reasoning was that parameters are not really driver specific, but 
are about characteristics of the underlying format (you could request 
"image/jpeg;foo=bar" to the JPEG, JPEGXL or GTiff drivers). But indeed 
this is a "mime type-like" syntax, not necessarily a strictly IANA 
conforming one. Given that this is intended to be mostly a GDAL internal 
implementation detail for inter-driver communication, I don't think 
adhering strictly to IANA rules is critical But I have no strong opinion 
and changing that to using driver-like names without the "image/" prefix 
isn't a big deal if you feel that is better.

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mateusz at loskot.net  Mon Jan 16 13:21:12 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 16 Jan 2023 22:21:12 +0100
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
Message-ID: <CABUeae-aAA=sogZyHyQ3mt8eLAfsbA93g6YEeLQtm9qU2gfLMg@mail.gmail.com>

+1   Mateusz


On Mon, 16 Jan 2023, 18:02 Even Rouault, <even.rouault at spatialys.com> wrote:

> Hi,
>
> Motion: Approve RFC90: Direct access to compressed raster data:
>
> https://github.com/OSGeo/gdal/pull/7020
>
> Starting with my +1
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/aaad48e7/attachment.htm>

From even.rouault at spatialys.com  Mon Jan 16 14:41:15 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Jan 2023 23:41:15 +0100
Subject: [gdal-dev] Interaction between no data and resampling
In-Reply-To: <e4578776-7185-4f76-a314-8f02c6688ee1@betaapp.fastmail.com>
References: <4011117a-6618-4051-819a-70406a4983d3@betaapp.fastmail.com>
 <72f837c9-80b5-4e9a-a90b-e58b758730af@betaapp.fastmail.com>
 <e4578776-7185-4f76-a314-8f02c6688ee1@betaapp.fastmail.com>
Message-ID: <a06d0ec9-bbf8-053e-fbc9-2862c6bf2d43@spatialys.com>

hopefully https://github.com/OSGeo/gdal/pull/7077 should answer your 
question. You'll note subtle differences of behavior between gdalwarp on 
one side and gdaladdo/gdal_translate on the other side

Even

Le 16/01/2023 ? 13:32, Lauren?iu Nicola via gdal-dev a ?crit?:
> PPS: Looks like some experimentation is probably better than weeks of 
> worrying :-). It looks like the input no data values are actually not 
> included in the computation. But I'd still like to know how they are 
> handled, if that's possible.
>
> Laurentiu
>
> On Mon, Jan 16, 2023, at 14:05, Lauren?iu Nicola via gdal-dev wrote:
>> PS:
>>
>> On Mon, Jan 16, 2023, at 13:58, Lauren?iu Nicola wrote:
>>>
>>>   * the |-srcnodata| docs and |gdalwarpkernel.cpp| suggest that
>>>     masked pixels are not included in the computation (unlike those
>>>     of no data?)
>>>
>> The remark in the brackets is wrong, of course, since the docs are 
>> specifically about |-srcnodata| . But I'm still unsure how these are 
>> handled in the code. I probably missed something, but I saw the 
>> checks 
>> <https://github.com/OSGeo/gdal/blob/master/alg/gdalwarpkernel.cpp#L1225> 
>> for a mask, but not no data.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230116/b94af604/attachment.htm>

From pigrecoinfinito at gmail.com  Tue Jan 17 07:30:35 2023
From: pigrecoinfinito at gmail.com (=?UTF-8?Q?Tot=C3=B2_Fiandaca?=)
Date: Tue, 17 Jan 2023 16:30:35 +0100
Subject: [gdal-dev] How to extract field domains from a gdb
Message-ID: <CADk2tEQO8DaCCGhV=yaq5OwpPrdLDRqwKqkBTVaVGoLkj4ZP9A@mail.gmail.com>

QGIS with gdal 3.6+ reads and writes gdb,
how can I export field domains to dbf/csv tables?

In the QGIS Browser I see the domains and I would like to export them in
tables with at least two fields: code, description

-- 
*Ing. Salvatore Fiandaca*
*mobile*.:+39 327.493.8955
*m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
*C.F*.: FNDSVT71E29Z103G
*P.IVA*: 06597870820
*membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
*socio GFOSS.it - *http://gfoss.it/
*member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
<https://www.osgeo.org/member/fiandaca/>
*blog:*
* https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/> FB: Co-admin
- https://www.facebook.com/qgis.it/ <https://www.facebook.com/qgis.it/>**
<https://www.facebook.com/qgis.it/> *
*TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
<https://twitter.com/totofiandaca>*

43?51'0.54"N  10?34'27.62"E - EPSG:4326

?Se la conoscenza deve essere aperta a tutti,
perch? mai limitarne l?accesso??
R. Stallman

Questo documento, allegati inclusi, contiene informazioni di propriet? di
FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega di
informare tempestivamente il mittente e distruggere la copia in proprio
possesso.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230117/88dc68fb/attachment-0001.htm>

From even.rouault at spatialys.com  Tue Jan 17 07:39:53 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Jan 2023 16:39:53 +0100
Subject: [gdal-dev] How to extract field domains from a gdb
In-Reply-To: <CADk2tEQO8DaCCGhV=yaq5OwpPrdLDRqwKqkBTVaVGoLkj4ZP9A@mail.gmail.com>
References: <CADk2tEQO8DaCCGhV=yaq5OwpPrdLDRqwKqkBTVaVGoLkj4ZP9A@mail.gmail.com>
Message-ID: <27d8df24-bf1c-8f16-ea39-b092a0097895@spatialys.com>

Hi,

I don't think we have a ready-made utility for that, so you'll have to 
write code using the field domain API: 
https://gdal.org/doxygen/classOGRCodedFieldDomain.html and 
https://gdal.org/doxygen/classGDALDataset.html#a64d001fa0fe53c6aa51e983ca14bad39

With GDAL master, it might also be easier to use the -json output of 
ogrinfo :

$ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb

[...}

 ? "domains":{
 ??? "MedianType":{
 ????? "description":"Road median types.",
 ????? "type":"coded",
 ????? "fieldType":"Integer",
 ????? "fieldSubType":"Int16",
 ????? "splitPolicy":"default value",
 ????? "mergePolicy":"default value",
 ????? "codedValues":{
 ??????? "0":"None",
 ??????? "1":"Cement"
 ????? }
 ??? },
 ??? "RoadSurfaceType":{
 ????? "description":"The road surface type",
 ????? "type":"coded",
 ????? "fieldType":"Integer",
 ????? "splitPolicy":"default value",
 ????? "mergePolicy":"default value",
 ????? "codedValues":{
 ??????? "1":"Asphalt",
 ??????? "2":"Gravel",
 ??????? "3":"Oiled Sand",
 ??????? "4":"Dirt"
 ????? }
 ??? },
 ??? "SpeedLimit":{
 ????? "description":"The maximun speed of the road",
 ????? "type":"range",
 ????? "fieldType":"Integer",
 ????? "fieldSubType":"Int16",
 ????? "splitPolicy":"default value",
 ????? "mergePolicy":"default value",
 ????? "minValue":40,
 ????? "minValueIncluded":true,
 ????? "maxValue":100,
 ????? "maxValueIncluded":true
 ??? }
 ? },


I can be imagine that a "Save as" context menu entry in QGIS would be a 
cool enhancement.

Even


Le 17/01/2023 ? 16:30, Tot? Fiandaca a ?crit?:
> QGIS with gdal 3.6+ reads and writes gdb,
> how can I export field domains to dbf/csv tables?
>
> In the QGIS Browser I see the domains and I would like to export them 
> in tables with at least two fields: code, description
>
> -- 
> *Ing. Salvatore Fiandaca*
> *mobile*.:+39 327.493.8955
> *m*: *pigrecoinfinito at gmail.com <mailto:pigrecoinfinito at gmail.com>*
> *C.F*.: FNDSVT71E29Z103G
> *P.IVA*: 06597870820
> *membro QGIS Italia - http://qgis.it/*
> *socio GFOSS.it - *http://gfoss.it/
> *member OSGeo* - *https://www.osgeo.org/member/fiandaca/* 
> <https://www.osgeo.org/member/fiandaca/>
> *blog:**?https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/>
> FB: Co-admin - 
> https://www.facebook.com/qgis.it/**<https://www.facebook.com/qgis.it/> *
> *TW:<http://goog_95411464>**https://twitter.com/totofiandaca*
>
> 43?51'0.54"N??10?34'27.62"E - EPSG:4326
>
> ?Se la conoscenza deve essere aperta a tutti,
> perch? mai limitarne l?accesso??
> R. Stallman
>
> Questo documento, allegati inclusi, contiene informazioni di propriet? 
> di FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal 
> destinatario in relazione alle finalit? per le quali ? stato ricevuto. 
> E' vietata qualsiasi forma di riproduzione o divulgazione senza 
> l'esplicito consenso di FIANDACA SALVATORE.?Qualora fosse stato 
> ricevuto per errore si prega di informare tempestivamente il mittente 
> e distruggere la copia in proprio possesso.
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230117/88682800/attachment.htm>

From pigrecoinfinito at gmail.com  Tue Jan 17 08:46:19 2023
From: pigrecoinfinito at gmail.com (=?UTF-8?Q?Tot=C3=B2_Fiandaca?=)
Date: Tue, 17 Jan 2023 17:46:19 +0100
Subject: [gdal-dev] How to extract field domains from a gdb
In-Reply-To: <27d8df24-bf1c-8f16-ea39-b092a0097895@spatialys.com>
References: <CADk2tEQO8DaCCGhV=yaq5OwpPrdLDRqwKqkBTVaVGoLkj4ZP9A@mail.gmail.com>
 <27d8df24-bf1c-8f16-ea39-b092a0097895@spatialys.com>
Message-ID: <CADk2tETdCicyq7Jwcuqa-JWLLkRRmUkQdPw3E8jj9j2hq1w4_g@mail.gmail.com>

wow!!!

>I can be imagine that a "Save as" context menu entry in QGIS would be a
cool enhancement.

Great, works great!!!

Please if you tell me how much you would like to implement it so I organize
a fundraiser.

Il giorno mar 17 gen 2023 alle ore 16:40 Even Rouault <
even.rouault at spatialys.com> ha scritto:

> Hi,
>
> I don't think we have a ready-made utility for that, so you'll have to
> write code using the field domain API:
> https://gdal.org/doxygen/classOGRCodedFieldDomain.html and
> https://gdal.org/doxygen/classGDALDataset.html#a64d001fa0fe53c6aa51e983ca14bad39
>
> With GDAL master, it might also be easier to use the -json output of
> ogrinfo :
>
> $ ogrinfo -json autotest/ogr/data/filegdb/Domains.gdb
>
> [...}
>
>   "domains":{
>     "MedianType":{
>       "description":"Road median types.",
>       "type":"coded",
>       "fieldType":"Integer",
>       "fieldSubType":"Int16",
>       "splitPolicy":"default value",
>       "mergePolicy":"default value",
>       "codedValues":{
>         "0":"None",
>         "1":"Cement"
>       }
>     },
>     "RoadSurfaceType":{
>       "description":"The road surface type",
>       "type":"coded",
>       "fieldType":"Integer",
>       "splitPolicy":"default value",
>       "mergePolicy":"default value",
>       "codedValues":{
>         "1":"Asphalt",
>         "2":"Gravel",
>         "3":"Oiled Sand",
>         "4":"Dirt"
>       }
>     },
>     "SpeedLimit":{
>       "description":"The maximun speed of the road",
>       "type":"range",
>       "fieldType":"Integer",
>       "fieldSubType":"Int16",
>       "splitPolicy":"default value",
>       "mergePolicy":"default value",
>       "minValue":40,
>       "minValueIncluded":true,
>       "maxValue":100,
>       "maxValueIncluded":true
>     }
>   },
>
>
> I can be imagine that a "Save as" context menu entry in QGIS would be a
> cool enhancement.
>
> Even
>
>
> Le 17/01/2023 ? 16:30, Tot? Fiandaca a ?crit :
>
> QGIS with gdal 3.6+ reads and writes gdb,
> how can I export field domains to dbf/csv tables?
>
> In the QGIS Browser I see the domains and I would like to export them in
> tables with at least two fields: code, description
>
> --
> *Ing. Salvatore Fiandaca*
> *mobile*.:+39 327.493.8955
> *m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
> *C.F*.: FNDSVT71E29Z103G
> *P.IVA*: 06597870820
> *membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
> *socio GFOSS.it - *http://gfoss.it/
> *member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
> <https://www.osgeo.org/member/fiandaca/>
> *blog:*
> * https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/>  FB:
> Co-admin - https://www.facebook.com/qgis.it/
> <https://www.facebook.com/qgis.it/>**
> <https://www.facebook.com/qgis.it/> *
> *TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
> <https://twitter.com/totofiandaca>*
>
> 43?51'0.54"N  10?34'27.62"E - EPSG:4326
>
> ?Se la conoscenza deve essere aperta a tutti,
> perch? mai limitarne l?accesso??
> R. Stallman
>
> Questo documento, allegati inclusi, contiene informazioni di propriet? di
> FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
> in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
> qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
> di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega
> di informare tempestivamente il mittente e distruggere la copia in proprio
> possesso.
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
*Ing. Salvatore Fiandaca*
*mobile*.:+39 327.493.8955
*m*: *pigrecoinfinito at gmail.com <pigrecoinfinito at gmail.com>*
*C.F*.: FNDSVT71E29Z103G
*P.IVA*: 06597870820
*membro QGIS Italia - http://qgis.it/ <http://qgis.it/>*
*socio GFOSS.it - *http://gfoss.it/
*member OSGeo* - *https://www.osgeo.org/member/fiandaca/*
<https://www.osgeo.org/member/fiandaca/>
*blog:*
* https://pigrecoinfinito.com/ <https://pigrecoinfinito.com/> FB: Co-admin
- https://www.facebook.com/qgis.it/ <https://www.facebook.com/qgis.it/>**
<https://www.facebook.com/qgis.it/> *
*TW:  <http://goog_95411464>**https://twitter.com/totofiandaca
<https://twitter.com/totofiandaca>*

43?51'0.54"N  10?34'27.62"E - EPSG:4326

?Se la conoscenza deve essere aperta a tutti,
perch? mai limitarne l?accesso??
R. Stallman

Questo documento, allegati inclusi, contiene informazioni di propriet? di
FIANDACA SALVATORE e deve essere utilizzato esclusivamente dal destinatario
in relazione alle finalit? per le quali ? stato ricevuto. E' vietata
qualsiasi forma di riproduzione o divulgazione senza l'esplicito consenso
di FIANDACA SALVATORE. Qualora fosse stato ricevuto per errore si prega di
informare tempestivamente il mittente e distruggere la copia in proprio
possesso.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230117/a3ef5e01/attachment-0001.htm>

From ni_hao88 at hotmail.com  Tue Jan 17 13:16:37 2023
From: ni_hao88 at hotmail.com (ni hao)
Date: Tue, 17 Jan 2023 21:16:37 +0000
Subject: [gdal-dev] jp2
Message-ID: <DM5PR02MB38621236CB777EBAF75D9AADF1C69@DM5PR02MB3862.namprd02.prod.outlook.com>

Hi list,

I'd like to convert NITF to a jpeg2000 (*.jp2) that can be opened by STK (Satellite Tool Kit).
I don't have any JP2 decoder.

is this command right?
gdal_translate -of JPEG2000 input.ntf output.jp2
the progress bar showed 0 to 100%, but the result output.jp2 is empty

Thank you

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230117/058e4320/attachment.htm>

From aryan.landi at trelleborg.com  Thu Jan 19 04:23:34 2023
From: aryan.landi at trelleborg.com (Aryan Landi)
Date: Thu, 19 Jan 2023 12:23:34 +0000
Subject: [gdal-dev] Parsing s57 chart with GDAL.
Message-ID: <C1D6F458-FDCA-41E3-8728-BC2FAB84A249@trelleborg.com>

Hi all,

I am unable to use the GDAL/OGR S57 driver to parse s57 charts. According to the official tutorial at https://gdal.org/tutorials/vector_api_tut.html<https://ddec1-0-en-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fgdal.org%2ftutorials%2fvector%5fapi%5ftut.html&umid=13d2fd67-3eca-462f-840d-c2d3dbebac5c&auth=b6670b9751c5c90ededae23711566d84a7ddb070-2fb38fd794274bb72553fe7321f02a983f2a6600>, I should be able to do something like:


GDALDataset       *poDS;

poDS = (GDALDataset*) GDALOpenEx( ?s57Chart.000", GDAL_OF_VECTOR, NULL, NULL, NULL );

However, poDS becomes NULL. On further investigation, invoking the gdalinfo command on a file returns

ERROR 4: `s57Chart.000' not recognized as a supported file format.
gdalinfo failed - unable to open ?s57Chart.000?.

If I use the ogrinfo command, the result is correct.

So it seems that GDALOpenEx is unable to locate the correct driver, which is shipped with GDAL.

Anyone who knows how to parse a s57 chart using GDAL 3.7?

Best regards,

Aryan Mohammadi Landi.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/99a91c33/attachment.htm>

From even.rouault at spatialys.com  Thu Jan 19 04:30:39 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2023 13:30:39 +0100
Subject: [gdal-dev] Parsing s57 chart with GDAL.
In-Reply-To: <C1D6F458-FDCA-41E3-8728-BC2FAB84A249@trelleborg.com>
References: <C1D6F458-FDCA-41E3-8728-BC2FAB84A249@trelleborg.com>
Message-ID: <713d431c-c832-719f-7395-ce2388b7fa77@spatialys.com>

Aryan,

You likely need to register the drivers with GDALAllRegister(): 
https://gdal.org/tutorials/vector_api_tut.html#reading-from-ogr

Even

Le 19/01/2023 ? 13:23, Aryan Landi a ?crit?:
> Hi all,
>
> I am unable to use the GDAL/OGR S57 driver to parse s57 charts. 
> According to the official tutorial at 
> https://gdal.org/tutorials/vector_api_tut.html 
> <https://ddec1-0-en-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2fgdal.org%2ftutorials%2fvector%5fapi%5ftut.html&umid=13d2fd67-3eca-462f-840d-c2d3dbebac5c&auth=b6670b9751c5c90ededae23711566d84a7ddb070-2fb38fd794274bb72553fe7321f02a983f2a6600>, 
> I should be able to do something like:
>
> GDALDataset*poDS;
>
> poDS=(GDALDataset*)GDALOpenEx(?s57Chart.000",GDAL_OF_VECTOR,NULL,NULL,NULL);
>
> However, poDS becomes NULL. On further investigation, invoking the 
> gdalinfo command on a file returns
>
> ERROR 4: `s57Chart.000' not recognized as a supported file format.
> gdalinfo failed - unable to open ?s57Chart.000?.
>
> If I use the ogrinfo command, the result is correct.
>
> So it seems that GDALOpenEx is unable to locate the correct driver, 
> which is shipped with GDAL.
>
> Anyone who knows how to parse a s57 chart using GDAL 3.7?
>
> Best regards,
>
> Aryan Mohammadi Landi.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/81e41690/attachment-0001.htm>

From aryan.landi at trelleborg.com  Thu Jan 19 05:50:21 2023
From: aryan.landi at trelleborg.com (Aryan Landi)
Date: Thu, 19 Jan 2023 13:50:21 +0000
Subject: [gdal-dev] Parsing s57 chart with GDAL.
In-Reply-To: <C1D6F458-FDCA-41E3-8728-BC2FAB84A249@trelleborg.com>
References: <C1D6F458-FDCA-41E3-8728-BC2FAB84A249@trelleborg.com>
Message-ID: <1F3DEC5E-6C20-4190-AD7A-0E963F966AE2@trelleborg.com>

Hi again,

I also do that. Here is the full code snippet that does not work.

#include "ogrsf_frmts.h"

int main()

{
GDALAllRegister();

GDALDataset *poDS;

poDS = (GDALDataset*) GDALOpenEx( "US5LA26M.000", GDAL_OF_VECTOR, NULL, NULL, NULL );
if( poDS == NULL )
{
printf( "Open failed.\n" );
exit( 1 );
}
}



Den 19. jan. 2023 kl. 13.23 skrev Aryan Landi <aryan.landi at trelleborg.com<mailto:aryan.landi at trelleborg.com>>:

  CAUTION: External Mail
Hi all,

I am unable to use the GDAL/OGR S57 driver to parse s57 charts. According to the official tutorial at https://gdal.org/tutorials/vector_api_tut.html<https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=https%3a%2f%2fgdal.org%2ftutorials%2fvector%5fapi%5ftut.html&umid=0557ffb0-6eb1-4f6b-80d6-1131e1983409&auth=b6670b9751c5c90ededae23711566d84a7ddb070-b06f87e0005818871cbf737adb302076abd31b48>, I should be able to do something like:


GDALDataset       *poDS;

poDS = (GDALDataset*) GDALOpenEx( ?s57Chart.000", GDAL_OF_VECTOR, NULL, NULL, NULL );

However, poDS becomes NULL. On further investigation, invoking the gdalinfo command on a file returns

ERROR 4: `s57Chart.000' not recognized as a supported file format.
gdalinfo failed - unable to open ?s57Chart.000?.

If I use the ogrinfo command, the result is correct.

So it seems that GDALOpenEx is unable to locate the correct driver, which is shipped with GDAL.

Anyone who knows how to parse a s57 chart using GDAL 3.7?

Best regards,

Aryan Mohammadi Landi.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://ddec1-0-en-ctp.trendmicro.com:443/wis/clicktime/v1/query?url=https%3a%2f%2flists.osgeo.org%2fmailman%2flistinfo%2fgdal%2ddev&umid=0557ffb0-6eb1-4f6b-80d6-1131e1983409&auth=b6670b9751c5c90ededae23711566d84a7ddb070-22e347d19f280b9bf24a6d423d3574fa65c3ae72

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/2a724826/attachment.htm>

From even.rouault at spatialys.com  Thu Jan 19 09:52:21 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2023 18:52:21 +0100
Subject: [gdal-dev] Motion: Approve RFC90: Direct access to compressed
 raster data
In-Reply-To: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
References: <4c6a67e1-00b5-c0f3-671d-de2e059d9abd@spatialys.com>
Message-ID: <f33ab9e4-1dd8-b842-b817-442df6e2b02f@spatialys.com>

Hi,

I declare this motion passed with +1 from PSC members JukkaR, FrankW, 
SeanG, MateuzL and me.

Even

Le 16/01/2023 ? 18:02, Even Rouault a ?crit?:
> Hi,
>
> Motion: Approve RFC90: Direct access to compressed raster data:
>
> https://github.com/OSGeo/gdal/pull/7020
>
> Starting with my +1
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Thu Jan 19 11:09:34 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 19 Jan 2023 19:09:34 +0000
Subject: [gdal-dev] Any trick to run SELECT gdal_get_pixel_value for lots of
 points?
Message-ID: <AM0PR09MB321947795F520D4C68FA10EBFDC49@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

I tried the new SQL function "gdal_get_pixel_value" from this PR https://github.com/OSGeo/gdal/pull/6877. It is made to query a single point at a time but with some SQL I managed to query a few points with one ogrinfo command. I think that the query works even the

ogrinfo -sql "SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 100, 200) as p1 UNION SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 100, 400) as p1 UNION SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 300, 400) as p1" p3412A.gpkg --config OGR_SQLITE_ALLOW_EXTERNAL_ACCESS YES
INFO: Open of `p3412A.gpkg'
      using driver `GPKG' successful.

Layer name: SELECT
Geometry: None
Feature Count: 3
Layer SRS WKT:
(unknown)
p1: Real (0.0)
OGRFeature(SELECT):0
  p1 (Real) = 11.1850004196167

OGRFeature(SELECT):1
  p1 (Real) = 11.7200002670288

OGRFeature(SELECT):2
  p1 (Real) = 13.5690002441406

However, the SQL statement with UNIONs gets too long if user wants to query hundreds or points. Is there any simple trick, SQL based or other, to make such a query?
The ultimate use case would be to find an alternative for the GRASS function v.drape https://grass.osgeo.org/grass82/manuals/v.drape.html.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/09a1374b/attachment.htm>

From lnicola at dend.ro  Thu Jan 19 11:17:10 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 19 Jan 2023 21:17:10 +0200
Subject: [gdal-dev] Any trick to run SELECT gdal_get_pixel_value for
 lots of points?
In-Reply-To: <AM0PR09MB321947795F520D4C68FA10EBFDC49@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB321947795F520D4C68FA10EBFDC49@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <02c7addf-c27d-4297-b78b-ea7c25e63a67@app.fastmail.com>

Hi,

I think I've mentioned it on the mailing list before, but https://www.orfeo-toolbox.org/CookBook/Applications/app_SampleExtraction.html has a pretty good (threaded) implementation of this.

Of course, it's an extra piece of software to install. If you want to do it in pure SQL, you could also try VALUES to define a set of sampling coordinates, then call gdal_get_pixel_value over it.

Regards,
Lauren?iu

On Thu, Jan 19, 2023, at 21:09, Rahkonen Jukka wrote:
> Hi,
>  
> I tried the new SQL function ?gdal_get_pixel_value? from this PR https://github.com/OSGeo/gdal/pull/6877. It is made to query a single point at a time but with some SQL I managed to query a few points with one ogrinfo command. I think that the query works even the
>  
> ogrinfo -sql "SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 100, 200) as p1 UNION SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 100, 400) as p1 UNION SELECT gdal_get_pixel_value('P3412A.tif', 1, 'pixel', 300, 400) as p1" p3412A.gpkg --config OGR_SQLITE_ALLOW_EXTERNAL_ACCESS YES
> INFO: Open of `p3412A.gpkg'
>       using driver `GPKG' successful.
>  
> Layer name: SELECT
> Geometry: None
> Feature Count: 3
> Layer SRS WKT:
> (unknown)
> p1: Real (0.0)
> OGRFeature(SELECT):0
>   p1 (Real) = 11.1850004196167
>  
> OGRFeature(SELECT):1
>   p1 (Real) = 11.7200002670288
>  
> OGRFeature(SELECT):2
>   p1 (Real) = 13.5690002441406
>  
> However, the SQL statement with UNIONs gets too long if user wants to query hundreds or points. Is there any simple trick, SQL based or other, to make such a query?
> The ultimate use case would be to find an alternative for the GRASS function v.drape https://grass.osgeo.org/grass82/manuals/v.drape.html.
>  
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/8498beb1/attachment.htm>

From even.rouault at spatialys.com  Thu Jan 19 11:24:10 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Jan 2023 20:24:10 +0100
Subject: [gdal-dev] Any trick to run SELECT gdal_get_pixel_value for
 lots of points?
In-Reply-To: <AM0PR09MB321947795F520D4C68FA10EBFDC49@AM0PR09MB3219.eurprd09.prod.outlook.com>
References: <AM0PR09MB321947795F520D4C68FA10EBFDC49@AM0PR09MB3219.eurprd09.prod.outlook.com>
Message-ID: <7599c415-1bac-468e-8a56-d69b2fd39a95@spatialys.com>

Hi Jukka,

Recursive Common Table Expressions (CTE) (cf "3.1. Recursive Query 
Examples" of https://www.sqlite.org/lang_with.html) can help if you want 
to sample along one or two axis

Below an example for x in [1,3] and y in [1,4]

$ ogr2ogr -of CSV /vsistdout/ :memory: -sql "WITH RECURSIVE list_x(x) AS 
(VALUES(1) UNION ALL SELECT x+1 FROM list_x WHERE x<3), list_y(y) AS 
(VALUES(1) UNION ALL SELECT y+1 FROM list_y WHERE y<4) SELECT x, y, 
gdal_get_pixel_value('byte.tif', 1, 'pixel', x, y) as val FROM list_y, 
list_x" --config OGR_SQLITE_ALLOW_EXTERNAL_ACCESS YES
x,y,val
"1","1","132"
"2","1","107"
"3","1","123"
"1","2","132"
"2","2","140"
"3","2","132"
"1","3","132"
"2","3","123"
"3","3","123"
"1","4","156"
"2","4","132"
"3","4","140"

Otherwise if you have a list of (x,y) values in a OGR readable format 
(CSV, etc.), you could select the x, y values from it:

$ cat list_points.csv

x,y
1,2
3,4
5,6

$ ogr2ogr -of csv /vsistdout/ list_points.csv -sql "SELECT x, y, 
gdal_get_pixel_value('byte.tif', 1, 'pixel', cast(l.x as real), cast(l.y 
as real)) AS val FROM list_points l" -dialect SQLite --config 
OGR_SQLITE_ALLOW_EXTERNAL_ACCESS YES
x,y,"val"
"1","2","132"
"3","4","140"
"5","6","132"

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From veypor at gmail.com  Thu Jan 19 21:22:03 2023
From: veypor at gmail.com (Vaheed Ghaffari)
Date: Thu, 19 Jan 2023 22:22:03 -0700
Subject: [gdal-dev] Stitching and geo coordinating drone images
Message-ID: <CAOTEB0=C7Y57i93AiP_4Wb21EoBZBshm8Qtpe-EGu+xhDp4xUg@mail.gmail.com>

Hello,
I need some verification from the pros out there. I am trying to stitch
together a set of images taken by the DJI drone camera (M300) and add geo
coordination.
Raw images are not geo coordinated, but I can access the photo information
in XMP fields, including the coordinates of the image center (principal
point). I am trying to use the GDAL C# Nuget Package.

Here are the steps I am taking:
1- Calculate geotransform array 6 coefficients using the principal point
coordinates, calculated GSD and camera pitch/yaw/roll for each image
2- Use setgeotransform assign the array to the images
3-Use GdalWarp try to stitch the geocoordinated images together.

I am not getting any good results. the output of the Warp function is
always a modified version of my last image in the dataset. I tried using a
basic geotranform array (without roll or coordination move) for testing and
got the same/similar results.

I can provide the detailed code if required, but I have a feeling that I am
missing steps.
I appreciate the help,

-Vaheed
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230119/b0bb88c0/attachment.htm>

From bo.victor.thomsen at gmail.com  Fri Jan 20 00:07:11 2023
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Fri, 20 Jan 2023 09:07:11 +0100
Subject: [gdal-dev] Stitching and geo coordinating drone images
In-Reply-To: <CAOTEB0=C7Y57i93AiP_4Wb21EoBZBshm8Qtpe-EGu+xhDp4xUg@mail.gmail.com>
References: <CAOTEB0=C7Y57i93AiP_4Wb21EoBZBshm8Qtpe-EGu+xhDp4xUg@mail.gmail.com>
Message-ID: <b3ac767e-d005-1090-bfb3-99549860bff2@gmail.com>

Try WebODM (https://opendronemap.org/webodm/). It's an open-source tool 
to this kind of work-flow.



Med venlig hilsen / Best regards

Bo Victor Thomsen

Den 20-01-2023 kl. 06:22 skrev Vaheed Ghaffari:
> Hello,
> I need some verification from the pros out there. I am trying to 
> stitch together a set of images taken by the DJI drone camera (M300) 
> and add geo coordination.
> Raw images are not geo coordinated, but I can access the photo 
> information in XMP fields, including the coordinates of the image 
> center (principal point). I am trying to use the GDAL C# Nuget Package.
>
> Here are the steps I am taking:
> 1- Calculate geotransform array 6 coefficients using the principal 
> point coordinates, calculated GSD and camera pitch/yaw/roll for each image
> 2- Use?setgeotransform assign the array to the images
> 3-Use GdalWarp try to stitch the geocoordinated images together.
>
> I am not getting any good results. the output of the Warp function is 
> always a modified version of my last image in the dataset. I tried 
> using a basic geotranform array (without roll or coordination move) 
> for testing and got the same/similar results.
>
> I can provide the detailed?code if required, but I?have a feeling that 
> I am missing steps.
> I appreciate the?help,
>
> -Vaheed
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Jan 20 11:11:25 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Jan 2023 20:11:25 +0100
Subject: [gdal-dev] Call for review on RFC 91: GDALDataset::Close() method
Message-ID: <d0983887-dcaf-afb8-306c-8dac553820f7@spatialys.com>

Hi,

Just to notify you that "RFC 91: GDALDataset::Close() method" is 
available for review in https://github.com/OSGeo/gdal/pull/7108

Admittedly, nothing particularly exciting, but this should provide GDAL 
users with better error detection.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From schwehr at gmail.com  Fri Jan 20 15:23:13 2023
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 20 Jan 2023 15:23:13 -0800
Subject: [gdal-dev] Call for review on RFC 91: GDALDataset::Close()
 method
In-Reply-To: <d0983887-dcaf-afb8-306c-8dac553820f7@spatialys.com>
References: <d0983887-dcaf-afb8-306c-8dac553820f7@spatialys.com>
Message-ID: <CACmBxysJL0q1x9Q=Gdh9_5miWYivVKFPzwQ7YUFueYHACzUajQ@mail.gmail.com>

While it might not be exciting, I think this is a solid API improvement.

On Fri, Jan 20, 2023 at 11:11 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Just to notify you that "RFC 91: GDALDataset::Close() method" is
> available for review in https://github.com/OSGeo/gdal/pull/7108
>
> Admittedly, nothing particularly exciting, but this should provide GDAL
> users with better error detection.
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230120/a5e5980e/attachment.htm>

From sean.gillies at gmail.com  Sat Jan 21 12:42:06 2023
From: sean.gillies at gmail.com (Sean Gillies)
Date: Sat, 21 Jan 2023 13:42:06 -0700
Subject: [gdal-dev] Call for review on RFC 91: GDALDataset::Close()
 method
In-Reply-To: <CACmBxysJL0q1x9Q=Gdh9_5miWYivVKFPzwQ7YUFueYHACzUajQ@mail.gmail.com>
References: <d0983887-dcaf-afb8-306c-8dac553820f7@spatialys.com>
 <CACmBxysJL0q1x9Q=Gdh9_5miWYivVKFPzwQ7YUFueYHACzUajQ@mail.gmail.com>
Message-ID: <CAOodmJpHU9ZE_sQSKvBZOw37P-8=thFgU-JmMk=Mci+xJZLOKA@mail.gmail.com>

I'm excited!

On Fri, Jan 20, 2023 at 4:23 PM Kurt Schwehr <schwehr at gmail.com> wrote:

> While it might not be exciting, I think this is a solid API improvement.
>
> On Fri, Jan 20, 2023 at 11:11 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> Just to notify you that "RFC 91: GDALDataset::Close() method" is
>> available for review in https://github.com/OSGeo/gdal/pull/7108
>>
>> Admittedly, nothing particularly exciting, but this should provide GDAL
>> users with better error detection.
>>
>> Even
>>
>> --
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230121/6c7b1969/attachment.htm>

From mankoff at gmail.com  Mon Jan 23 04:46:15 2023
From: mankoff at gmail.com (Ken Mankoff)
Date: Mon, 23 Jan 2023 07:46:15 -0500
Subject: [gdal-dev] near identical files being treated differently
Message-ID: <87edrlju5k.fsf@t480.home>

Hello,

I have two near-identical files available at:

wget https://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_4X5.OCN.nc

wget https://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_144X90_gas.OCN.nc

They differ only in their dimensions:

$ diff <(ncdump -h GLMELT_4X5.OCN.nc) <(ncdump -h GLMELT_144X90_gas.OCN.nc)|cat -n
     1  1c1
     2  < netcdf GLMELT_4X5.OCN {
     3  ---
     4  > netcdf GLMELT_144X90_gas.OCN {
     5  3,4c3,4
     6  <       lon = 72 ;
     7  <       lat = 46 ;
     8  ---
     9  >       lon = 144 ;
    10  >       lat = 90 ;


However, "galinfo" sees them differently, and therefore they are treated very differently in, for example, QGIS.


$ diff <(gdalinfo GLMELT_4X5.OCN.nc) <(gdalinfo GLMELT_144X90_gas.OCN.nc)|cat -n
     1  2,3c2,6
     2  < Files: GLMELT_4X5.OCN.nc
     3  < Size is 72, 46
     4  ---
     5  > Files: GLMELT_144X90_gas.OCN.nc
     6  >        GLMELT_144X90_gas.OCN.nc.aux.xml
     7  > Size is 144, 90
     8  > Origin = (-180.000000000000000,90.000000000000000)
     9  > Pixel Size = (2.500000000000000,-2.000000000000000)
    10  8,13c11,18
    11  < Upper Left  (    0.0,    0.0)
    12  < Lower Left  (    0.0,   46.0)
    13  < Upper Right (   72.0,    0.0)
    14  < Lower Right (   72.0,   46.0)
    15  < Center      (   36.0,   23.0)
    16  < Band 1 Block=72x1 Type=Float32, ColorInterp=Undefined
    17  ---
    18  > Upper Left  (-180.0000000,  90.0000000) 
    19  > Lower Left  (-180.0000000, -90.0000000) 
    20  > Upper Right ( 180.0000000,  90.0000000) 
    21  > Lower Right ( 180.0000000, -90.0000000) 
    22  > Center      (   0.0000000,   0.0000000) 
    23  > Band 1 Block=144x1 Type=Float32, ColorInterp=Undefined
    24  >   Min=0.000 Max=1.000 
    25  >   Minimum=0.000, Maximum=1.000, Mean=0.018, StdDev=0.134
    26  16a22,25
    27  >     STATISTICS_MAXIMUM=1
    28  >     STATISTICS_MEAN=0.018364197530864
    29  >     STATISTICS_MINIMUM=0
    30  >     STATISTICS_STDDEV=0.13426449188044


That is, the larger file contains key info:

Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (2.500000000000000,-2.000000000000000)

Which then generates correct Corner Coordinates.

Given that the 'ncdump' of the two files is identical (except size), can someone clarify what I'm doing wrong here?

Thanks,

  Ken Mankoff

From even.rouault at spatialys.com  Mon Jan 23 07:39:42 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Jan 2023 16:39:42 +0100
Subject: [gdal-dev] near identical files being treated differently
In-Reply-To: <87edrlju5k.fsf@t480.home>
References: <87edrlju5k.fsf@t480.home>
Message-ID: <d5adb41c-011b-1890-9682-7ff7001014b0@spatialys.com>

Ken,

if you do "gdalinfo --debug on GLMELT_4X5.OCN.nc", you'll see

GDAL_netCDF: Latitude/Y is not equally spaced (with a 0.05% tolerance). 
You may set the GDAL_NETCDF_IGNORE_EQUALLY_SPACED_XY_CHECK configuration 
option to YES to ignore this check

and indeed

$ ncdump -v lat GLMELT_4X5.OCN.nc
[...]
 ?lat = -89, -86, -82, -78, -74, -70, -66, -62, -58, -54, -50, -46, -42, 
-38,
 ??? -34, -30, -26, -22, -18, -14, -10, -6, -2, 2, 6, 10, 14, 18, 22, 
26, 30,
 ??? 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 74, 78, 82, 86, 89 ;


So you can see the spacing is 4 degree, except for the first and lat 
samples where it is 3. So GDAL cannot report a geotransform matrix for 
such file.

I've just submitted https://github.com/OSGeo/gdal/pull/7113 where GDAL 
will report a GEOLOCATION metadata domain, that can be used by gdalwarp 
to rectify such file

$ gdalinfo autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc

[...]

Geolocation:
 ? GEOREFERENCING_CONVENTION=PIXEL_CENTER
 ? LINE_OFFSET=0
 ? LINE_STEP=1
 ? PIXEL_OFFSET=0
 ? PIXEL_STEP=1
 ? SRS=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]
 ? X_BAND=1
X_DATASET=NETCDF:"autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc":lon
 ? Y_BAND=1
Y_DATASET=NETCDF:"autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc":lat

Even

Le 23/01/2023 ? 13:46, Ken Mankoff a ?crit?:
> wgethttps://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_4X5.OCN.nc
>
> wgethttps://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_144X90_gas.OCN.nc

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From anjashep at umich.edu  Mon Jan 23 15:05:47 2023
From: anjashep at umich.edu (Anja Sheppard)
Date: Mon, 23 Jan 2023 18:05:47 -0500
Subject: [gdal-dev] Build difficulties (Ubuntu 20.04)
Message-ID: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>

Hello gdal community--

I am new to this tool, and am trying to build it on Ubuntu 20.04. I don't
use conda, so I'm running into problems with the dependencies. I downloaded
the current release .tar.gz file from https://gdal.org/download.html and
then unpacked it. I then followed the instructions on the build help
website which I found through the readme. I ran:

*$ mkdir build*
*$ cd build*
*$ cmake ..*

And then the result was the output pasted at the end of this email.

What are the dependencies that I can just install with apt? I don't use
conda or any of the other package managers listed in the readme. Any help
is appreciated.

Alternatively, if anyone has any other tools that can be used for
converting .DAT to .IMG or .JPG files, I would be very eager to hear more.
I have not been able to successfully view a .DAT image from the NASA PDS
website as of yet.

Thanks,

Anja Sheppard


























































































































































































































































*-- The C compiler identification is GNU 9.4.0-- The CXX compiler
identification is GNU 9.4.0-- Check for working C compiler: /usr/bin/cc--
Check for working C compiler: /usr/bin/cc -- works-- Detecting C compiler
ABI info-- Detecting C compiler ABI info - done-- Detecting C compile
features-- Detecting C compile features - done-- Check for working CXX
compiler: /usr/bin/c++-- Check for working CXX compiler: /usr/bin/c++ --
works-- Detecting CXX compiler ABI info-- Detecting CXX compiler ABI info -
done-- Detecting CXX compile features-- Detecting CXX compile features -
done-- Performing Test test_sse-- Performing Test test_sse - Success--
Looking for C++ include xmmintrin.h-- Looking for C++ include xmmintrin.h -
found-- Performing Test test_sse2-- Performing Test test_sse2 - Success--
Looking for C++ include emmintrin.h-- Looking for C++ include emmintrin.h -
found-- Performing Test test_ssse3-- Performing Test test_ssse3 - Success--
Looking for C++ include tmmintrin.h-- Looking for C++ include tmmintrin.h -
found-- Performing Test test_sse4.1-- Performing Test test_sse4.1 -
Success-- Looking for C++ include smmintrin.h-- Looking for C++ include
smmintrin.h - found-- Performing Test test_avx-- Performing Test test_avx -
Success-- Looking for C++ include immintrin.h-- Looking for C++ include
immintrin.h - found-- Performing Test test_avx2-- Performing Test test_avx2
- Success-- Found Python: /usr/bin/python3.8 (found suitable version
"3.8.10", minimum required is "3.6") found components: Interpreter
Development NumPy -- Performing Test HAVE_WFLAG_ALL-- Performing Test
HAVE_WFLAG_ALL - Success-- Performing Test HAVE_WFLAG_EXTRA-- Performing
Test HAVE_WFLAG_EXTRA - Success-- Performing Test HAVE_WFLAG_INIT_SELF--
Performing Test HAVE_WFLAG_INIT_SELF - Success-- Performing Test
HAVE_WFLAG_UNUSED_PARAMETER-- Performing Test HAVE_WFLAG_UNUSED_PARAMETER -
Success-- Performing Test HAVE_WFLAG_MISSING_PROTOTYPES-- Performing Test
HAVE_WFLAG_MISSING_PROTOTYPES - Success-- Performing Test
HAVE_WFLAG_MISSING_DECLARATIONS-- Performing Test
HAVE_WFLAG_MISSING_DECLARATIONS - Success-- Performing Test
HAVE_WFLAG_SHORTEN_64_TO_32-- Performing Test HAVE_WFLAG_SHORTEN_64_TO_32 -
Failed-- Performing Test HAVE_WFLAG_LOGICAL_OP-- Performing Test
HAVE_WFLAG_LOGICAL_OP - Success-- Performing Test HAVE_WFLAG_SHADOW--
Performing Test HAVE_WFLAG_SHADOW - Success-- Performing Test
HAVE_WFLAG_SHADOW_FIELD-- Performing Test HAVE_WFLAG_SHADOW_FIELD -
Failed-- Performing Test HAVE_WFLAG_MISSING_INCLUDE_DIRS-- Performing Test
HAVE_WFLAG_MISSING_INCLUDE_DIRS - Success-- Performing Test
HAVE_WFLAG_FORMAT_SECURITY-- Performing Test HAVE_WFLAG_FORMAT_SECURITY -
Success-- Performing Test HAVE_WFLAG_ERROR_VLA-- Performing Test
HAVE_WFLAG_ERROR_VLA - Success-- Performing Test HAVE_WFLAG_NO_CLOBBERED--
Performing Test HAVE_WFLAG_NO_CLOBBERED - Success-- Performing Test
HAVE_WFLAG_DATE_TIME-- Performing Test HAVE_WFLAG_DATE_TIME - Success--
Performing Test HAVE_WFLAG_NULL_DEREFERENCE-- Performing Test
HAVE_WFLAG_NULL_DEREFERENCE - Success-- Performing Test
HAVE_WFLAG_DUPLICATE_COND-- Performing Test HAVE_WFLAG_DUPLICATE_COND -
Failed-- Performing Test HAVE_WFLAG_EXTRA_SEMI-- Performing Test
HAVE_WFLAG_EXTRA_SEMI - Success-- Performing Test HAVE_WFLAG_COMMA--
Performing Test HAVE_WFLAG_COMMA - Failed-- Performing Test
HAVE_WFLAG_FLOAT_CONVERSION-- Performing Test HAVE_WFLAG_FLOAT_CONVERSION -
Success-- Performing Test HAVE_WFLAG_DOCUMENTATION_AND_NO_DEPRECATED--
Performing Test HAVE_WFLAG_DOCUMENTATION_AND_NO_DEPRECATED - Failed--
Performing Test HAVE_WFLAG_UNUSED_PRIVATE_FIELD-- Performing Test
HAVE_WFLAG_UNUSED_PRIVATE_FIELD - Failed-- Performing Test
HAVE_WFLAG_NON_VIRTUAL_DTOR-- Performing Test HAVE_WFLAG_NON_VIRTUAL_DTOR -
Success-- Performing Test HAVE_WFLAG_OVERLOADED_VIRTUAL-- Performing Test
HAVE_WFLAG_OVERLOADED_VIRTUAL - Success-- Performing Test
HAVE_WFLAG_SUGGEST_OVERRIDE-- Performing Test HAVE_WFLAG_SUGGEST_OVERRIDE -
Success-- Performing Test HAVE_FLAG_NO_OPERATOR_NAMES-- Performing Test
HAVE_FLAG_NO_OPERATOR_NAMES - Success-- Performing Test
HAVE_GCC_WARNING_ZERO_AS_NULL_POINTER_CONSTANT-- Performing Test
HAVE_GCC_WARNING_ZERO_AS_NULL_POINTER_CONSTANT - Success-- Performing Test
HAVE_WFLAG_OLD_STYLE_CAST-- Performing Test HAVE_WFLAG_OLD_STYLE_CAST -
Success-- Performing Test HAVE_WFLAG_EFFCXX-- Performing Test
HAVE_WFLAG_EFFCXX - Success-- Looking for vsnprintf-- Looking for vsnprintf
- found-- Looking for getcwd-- Looking for getcwd - found-- Looking for
fcntl.h-- Looking for fcntl.h - found-- Looking for unistd.h-- Looking for
unistd.h - found-- Looking for sys/types.h-- Looking for sys/types.h -
found-- Looking for locale.h-- Looking for locale.h - found-- Looking for
xlocale.h-- Looking for xlocale.h - not found-- Looking for direct.h--
Looking for direct.h - not found-- Looking for dlfcn.h-- Looking for
dlfcn.h - found-- Looking for stdint.h-- Looking for stdint.h - found--
Looking for stddef.h-- Looking for stddef.h - found-- Check size of int--
Check size of int - done-- Check size of unsigned long-- Check size of
unsigned long - done-- Check size of void*-- Check size of void* - done--
Check size of size_t-- Check size of size_t - done-- Check if the system is
big endian-- Searching 16 bit integer-- Check size of unsigned short--
Check size of unsigned short - done-- Using unsigned short-- Check if the
system is big endian - little endian-- Looking for pthread.h-- Looking for
pthread.h - found-- Performing Test CMAKE_HAVE_LIBC_PTHREAD-- Performing
Test CMAKE_HAVE_LIBC_PTHREAD - Failed-- Looking for pthread_create in
pthreads-- Looking for pthread_create in pthreads - not found-- Looking for
pthread_create in pthread-- Looking for pthread_create in pthread - found--
Found Threads: TRUE  -- Performing Test HAVE_PTHREAD_MUTEX_RECURSIVE--
Performing Test HAVE_PTHREAD_MUTEX_RECURSIVE - Success-- Performing Test
HAVE_PTHREAD_MUTEX_ADAPTIVE_NP-- Performing Test
HAVE_PTHREAD_MUTEX_ADAPTIVE_NP - Success-- Performing Test
HAVE_PTHREAD_SPINLOCK-- Performing Test HAVE_PTHREAD_SPINLOCK - Success--
Performing Test HAVE_5ARGS_MREMAP-- Performing Test HAVE_5ARGS_MREMAP -
Success-- Performing Test HAVE_PTHREAD_ATFORK-- Performing Test
HAVE_PTHREAD_ATFORK - Success-- Looking for sys/stat.h-- Looking for
sys/stat.h - found-- Looking for linux/fs.h-- Looking for linux/fs.h -
found-- Looking for readlink-- Looking for readlink - found-- Looking for
posix_spawnp-- Looking for posix_spawnp - found-- Looking for
posix_memalign-- Looking for posix_memalign - found-- Looking for vfork--
Looking for vfork - found-- Looking for mmap-- Looking for mmap - found--
Looking for sigaction-- Looking for sigaction - found-- Looking for
statvfs-- Looking for statvfs - found-- Looking for statvfs64-- Looking for
statvfs64 - found-- Looking for lstat-- Looking for lstat - found-- Looking
for getrlimit-- Looking for getrlimit - found-- Looking for RLIMIT_AS--
Looking for RLIMIT_AS - found-- Looking for ftell64-- Looking for ftell64 -
not found-- Looking for ftello64-- Looking for ftello64 - found-- Looking
for fseek64-- Looking for fseek64 - not found-- Looking for fseeko64--
Looking for fseeko64 - found-- Looking for stat64-- Looking for stat64 -
found-- Performing Test NO_UNIX_STDIO_64-- Performing Test NO_UNIX_STDIO_64
- Failed-- Looking for fopen64-- Looking for fopen64 - found-- Check size
of off_t-- Check size of off_t - done-- Looking for pread64-- Looking for
pread64 - found-- Looking for ftruncate64-- Looking for ftruncate64 -
found-- Performing Test HAVE_USELOCALE-- Performing Test HAVE_USELOCALE -
Success-- Performing Test HAVE_HIDE_INTERNAL_SYMBOLS-- Performing Test
HAVE_HIDE_INTERNAL_SYMBOLS - Success-- Performing Test
HAVE_GCC_ATOMIC_BUILTINS-- Performing Test HAVE_GCC_ATOMIC_BUILTINS -
Success-- Performing Test HAVE_GCC_BSWAP-- Performing Test HAVE_GCC_BSWAP -
Success-- Performing Test HAVE_SC_PHYS_PAGES-- Performing Test
HAVE_SC_PHYS_PAGES - Success-- Performing Test HAVE_SCHED_GETAFFINITY--
Performing Test HAVE_SCHED_GETAFFINITY - Success-- Performing Test
INT128_TEST-- Performing Test INT128_TEST - Success-- checking if sprintf
can be overloaded for GDAL compilation-- Performing Test
DEPRECATE_SPRINTF-- Performing Test DEPRECATE_SPRINTF - Failed-- Looking
for linux/userfaultfd.h-- Looking for linux/userfaultfd.h - found--
GDAL_VERSION          = 3.6.2-- GDAL_ABI_FULL_VERSION = 32.3.6.2--
GDAL_SOVERSION        = 32-- Could NOT find ODBC (missing: ODBC_LIBRARY
ODBC_INCLUDE_DIR ODBCINST) -- Could NOT find ODBCCPP (missing:
ODBCCPP_LIBRARY ODBCCPP_INCLUDE_DIR) -- Could NOT find MSSQL_ODBC (missing:
MSSQL_ODBC_LIBRARY MSSQL_ODBC_INCLUDE_DIR MSSQL_ODBC_VERSION) -- Could NOT
find MySQL (missing: MYSQL_LIBRARY MYSQL_INCLUDE_DIR) -- Could NOT find
CURL (missing: CURL_LIBRARY CURL_INCLUDE_DIR) -- Performing Test
Iconv_IS_BUILT_IN-- Performing Test Iconv_IS_BUILT_IN - Success-- Found
Iconv: /usr/lib/x86_64-linux-gnu/libc.so  -- Performing Test
_ICONV_SECOND_ARGUMENT_IS_NOT_CONST-- Performing Test
_ICONV_SECOND_ARGUMENT_IS_NOT_CONST - Success-- Performing Test
ICONV_HAS_EXTRA_CHARSETS-- Performing Test ICONV_HAS_EXTRA_CHARSETS -
Success-- Could NOT find LibXml2 (missing: LIBXML2_LIBRARY
LIBXML2_INCLUDE_DIR) -- Could NOT find EXPAT (missing: EXPAT_DIR)-- Found
EXPAT: /usr/lib/x86_64-linux-gnu/libexpat.so (found version "2.2.9") --
Failed to find XercesC (missing: XercesC_LIBRARY XercesC_INCLUDE_DIR
XercesC_VERSION) -- Found ZLIB: /usr/lib/x86_64-linux-gnu/libz.so (found
version "1.2.11") -- Could NOT find Deflate (missing: Deflate_LIBRARY
Deflate_INCLUDE_DIR) -- Could NOT find OpenSSL, try to set the path to
OpenSSL root folder in the system variable OPENSSL_ROOT_DIR (missing:
OPENSSL_CRYPTO_LIBRARY OPENSSL_INCLUDE_DIR SSL Crypto) -- Could NOT find
CryptoPP (missing: CRYPTOPP_LIBRARY CRYPTOPP_TEST_KNOWNBUG
CRYPTOPP_INCLUDE_DIR) CMake Error at
/usr/share/cmake-3.16/Modules/FindPackageHandleStandardArgs.cmake:146
(message):  Could NOT find PROJ (missing: PROJ_LIBRARY PROJ_INCLUDE_DIR)
(Required is  at least version "6.0")Call Stack (most recent call first):
/usr/share/cmake-3.16/Modules/FindPackageHandleStandardArgs.cmake:393
(_FPHSA_FAILURE_MESSAGE)  cmake/modules/packages/FindPROJ.cmake:57
(find_package_handle_standard_args)
cmake/helpers/CheckDependentLibraries.cmake:355 (find_package)
gdal.cmake:264 (include)  CMakeLists.txt:224 (include)-- Configuring
incomplete, errors occurred!*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230123/44b41aa0/attachment.htm>

From even.rouault at spatialys.com  Mon Jan 23 15:10:30 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Jan 2023 00:10:30 +0100
Subject: [gdal-dev] Build difficulties (Ubuntu 20.04)
In-Reply-To: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>
References: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>
Message-ID: <a3055162-ef1e-d10f-5f36-8daad410770e@spatialys.com>

Anja,

the minimum will be to install PROJ with:

apt-get install libproj-dev

For a build with nearly all open source dependencies, you can find the 
list to install in 
https://github.com/OSGeo/gdal/blob/5db56957dd9b5d00098f5ac8abb75a3c756cc0aa/.github/workflows/cmake_builds.yml#L57

You can also play with the ready-made Docker images listed at 
https://github.com/OSGeo/gdal/tree/master/docker

Even


Le 24/01/2023 ? 00:05, Anja Sheppard a ?crit?:
> Hello gdal community--
>
> I am new to this tool, and am trying to build it on Ubuntu 20.04. I 
> don't use conda, so I'm running into problems with the dependencies. I 
> downloaded the current release .tar.gz file from 
> https://gdal.org/download.html?and then unpacked it. I then followed 
> the instructions?on the build help website which I found through the 
> readme. I ran:
>
> *$ mkdir build*
> *$ cd build*
> *$ cmake ..*
>
> And then the result was the output pasted at the end of this email.
>
> What are the dependencies?that I can just install with apt? I don't 
> use conda or any of the other package managers listed in the readme. 
> Any help is appreciated.
>
> Alternatively, if anyone has any other tools that can be used for 
> converting .DAT to .IMG or .JPG files, I would be very eager?to hear 
> more. I have?not been able to successfully?view a .DAT image from the 
> NASA PDS website as of yet.
>
> Thanks,
>
> Anja Sheppard
>
> *-- The C compiler identification is GNU 9.4.0
> -- The CXX compiler identification is GNU 9.4.0
> -- Check for working C compiler: /usr/bin/cc
> -- Check for working C compiler: /usr/bin/cc -- works
> -- Detecting C compiler ABI info
> -- Detecting C compiler ABI info - done
> -- Detecting C compile features
> -- Detecting C compile features - done
> -- Check for working CXX compiler: /usr/bin/c++
> -- Check for working CXX compiler: /usr/bin/c++ -- works
> -- Detecting CXX compiler ABI info
> -- Detecting CXX compiler ABI info - done
> -- Detecting CXX compile features
> -- Detecting CXX compile features - done
> -- Performing Test test_sse
> -- Performing Test test_sse - Success
> -- Looking for C++ include xmmintrin.h
> -- Looking for C++ include xmmintrin.h - found
> -- Performing Test test_sse2
> -- Performing Test test_sse2 - Success
> -- Looking for C++ include emmintrin.h
> -- Looking for C++ include emmintrin.h - found
> -- Performing Test test_ssse3
> -- Performing Test test_ssse3 - Success
> -- Looking for C++ include tmmintrin.h
> -- Looking for C++ include tmmintrin.h - found
> -- Performing Test test_sse4.1
> -- Performing Test test_sse4.1 - Success
> -- Looking for C++ include smmintrin.h
> -- Looking for C++ include smmintrin.h - found
> -- Performing Test test_avx
> -- Performing Test test_avx - Success
> -- Looking for C++ include immintrin.h
> -- Looking for C++ include immintrin.h - found
> -- Performing Test test_avx2
> -- Performing Test test_avx2 - Success
> -- Found Python: /usr/bin/python3.8 (found suitable version "3.8.10", 
> minimum required is "3.6") found components: Interpreter Development 
> NumPy
> -- Performing Test HAVE_WFLAG_ALL
> -- Performing Test HAVE_WFLAG_ALL - Success
> -- Performing Test HAVE_WFLAG_EXTRA
> -- Performing Test HAVE_WFLAG_EXTRA - Success
> -- Performing Test HAVE_WFLAG_INIT_SELF
> -- Performing Test HAVE_WFLAG_INIT_SELF - Success
> -- Performing Test HAVE_WFLAG_UNUSED_PARAMETER
> -- Performing Test HAVE_WFLAG_UNUSED_PARAMETER - Success
> -- Performing Test HAVE_WFLAG_MISSING_PROTOTYPES
> -- Performing Test HAVE_WFLAG_MISSING_PROTOTYPES - Success
> -- Performing Test HAVE_WFLAG_MISSING_DECLARATIONS
> -- Performing Test HAVE_WFLAG_MISSING_DECLARATIONS - Success
> -- Performing Test HAVE_WFLAG_SHORTEN_64_TO_32
> -- Performing Test HAVE_WFLAG_SHORTEN_64_TO_32 - Failed
> -- Performing Test HAVE_WFLAG_LOGICAL_OP
> -- Performing Test HAVE_WFLAG_LOGICAL_OP - Success
> -- Performing Test HAVE_WFLAG_SHADOW
> -- Performing Test HAVE_WFLAG_SHADOW - Success
> -- Performing Test HAVE_WFLAG_SHADOW_FIELD
> -- Performing Test HAVE_WFLAG_SHADOW_FIELD - Failed
> -- Performing Test HAVE_WFLAG_MISSING_INCLUDE_DIRS
> -- Performing Test HAVE_WFLAG_MISSING_INCLUDE_DIRS - Success
> -- Performing Test HAVE_WFLAG_FORMAT_SECURITY
> -- Performing Test HAVE_WFLAG_FORMAT_SECURITY - Success
> -- Performing Test HAVE_WFLAG_ERROR_VLA
> -- Performing Test HAVE_WFLAG_ERROR_VLA - Success
> -- Performing Test HAVE_WFLAG_NO_CLOBBERED
> -- Performing Test HAVE_WFLAG_NO_CLOBBERED - Success
> -- Performing Test HAVE_WFLAG_DATE_TIME
> -- Performing Test HAVE_WFLAG_DATE_TIME - Success
> -- Performing Test HAVE_WFLAG_NULL_DEREFERENCE
> -- Performing Test HAVE_WFLAG_NULL_DEREFERENCE - Success
> -- Performing Test HAVE_WFLAG_DUPLICATE_COND
> -- Performing Test HAVE_WFLAG_DUPLICATE_COND - Failed
> -- Performing Test HAVE_WFLAG_EXTRA_SEMI
> -- Performing Test HAVE_WFLAG_EXTRA_SEMI - Success
> -- Performing Test HAVE_WFLAG_COMMA
> -- Performing Test HAVE_WFLAG_COMMA - Failed
> -- Performing Test HAVE_WFLAG_FLOAT_CONVERSION
> -- Performing Test HAVE_WFLAG_FLOAT_CONVERSION - Success
> -- Performing Test HAVE_WFLAG_DOCUMENTATION_AND_NO_DEPRECATED
> -- Performing Test HAVE_WFLAG_DOCUMENTATION_AND_NO_DEPRECATED - Failed
> -- Performing Test HAVE_WFLAG_UNUSED_PRIVATE_FIELD
> -- Performing Test HAVE_WFLAG_UNUSED_PRIVATE_FIELD - Failed
> -- Performing Test HAVE_WFLAG_NON_VIRTUAL_DTOR
> -- Performing Test HAVE_WFLAG_NON_VIRTUAL_DTOR - Success
> -- Performing Test HAVE_WFLAG_OVERLOADED_VIRTUAL
> -- Performing Test HAVE_WFLAG_OVERLOADED_VIRTUAL - Success
> -- Performing Test HAVE_WFLAG_SUGGEST_OVERRIDE
> -- Performing Test HAVE_WFLAG_SUGGEST_OVERRIDE - Success
> -- Performing Test HAVE_FLAG_NO_OPERATOR_NAMES
> -- Performing Test HAVE_FLAG_NO_OPERATOR_NAMES - Success
> -- Performing Test HAVE_GCC_WARNING_ZERO_AS_NULL_POINTER_CONSTANT
> -- Performing Test HAVE_GCC_WARNING_ZERO_AS_NULL_POINTER_CONSTANT - 
> Success
> -- Performing Test HAVE_WFLAG_OLD_STYLE_CAST
> -- Performing Test HAVE_WFLAG_OLD_STYLE_CAST - Success
> -- Performing Test HAVE_WFLAG_EFFCXX
> -- Performing Test HAVE_WFLAG_EFFCXX - Success
> -- Looking for vsnprintf
> -- Looking for vsnprintf - found
> -- Looking for getcwd
> -- Looking for getcwd - found
> -- Looking for fcntl.h
> -- Looking for fcntl.h - found
> -- Looking for unistd.h
> -- Looking for unistd.h - found
> -- Looking for sys/types.h
> -- Looking for sys/types.h - found
> -- Looking for locale.h
> -- Looking for locale.h - found
> -- Looking for xlocale.h
> -- Looking for xlocale.h - not found
> -- Looking for direct.h
> -- Looking for direct.h - not found
> -- Looking for dlfcn.h
> -- Looking for dlfcn.h - found
> -- Looking for stdint.h
> -- Looking for stdint.h - found
> -- Looking for stddef.h
> -- Looking for stddef.h - found
> -- Check size of int
> -- Check size of int - done
> -- Check size of unsigned long
> -- Check size of unsigned long - done
> -- Check size of void*
> -- Check size of void* - done
> -- Check size of size_t
> -- Check size of size_t - done
> -- Check if the system is big endian
> -- Searching 16 bit integer
> -- Check size of unsigned short
> -- Check size of unsigned short - done
> -- Using unsigned short
> -- Check if the system is big endian - little endian
> -- Looking for pthread.h
> -- Looking for pthread.h - found
> -- Performing Test CMAKE_HAVE_LIBC_PTHREAD
> -- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Failed
> -- Looking for pthread_create in pthreads
> -- Looking for pthread_create in pthreads - not found
> -- Looking for pthread_create in pthread
> -- Looking for pthread_create in pthread - found
> -- Found Threads: TRUE
> -- Performing Test HAVE_PTHREAD_MUTEX_RECURSIVE
> -- Performing Test HAVE_PTHREAD_MUTEX_RECURSIVE - Success
> -- Performing Test HAVE_PTHREAD_MUTEX_ADAPTIVE_NP
> -- Performing Test HAVE_PTHREAD_MUTEX_ADAPTIVE_NP - Success
> -- Performing Test HAVE_PTHREAD_SPINLOCK
> -- Performing Test HAVE_PTHREAD_SPINLOCK - Success
> -- Performing Test HAVE_5ARGS_MREMAP
> -- Performing Test HAVE_5ARGS_MREMAP - Success
> -- Performing Test HAVE_PTHREAD_ATFORK
> -- Performing Test HAVE_PTHREAD_ATFORK - Success
> -- Looking for sys/stat.h
> -- Looking for sys/stat.h - found
> -- Looking for linux/fs.h
> -- Looking for linux/fs.h - found
> -- Looking for readlink
> -- Looking for readlink - found
> -- Looking for posix_spawnp
> -- Looking for posix_spawnp - found
> -- Looking for posix_memalign
> -- Looking for posix_memalign - found
> -- Looking for vfork
> -- Looking for vfork - found
> -- Looking for mmap
> -- Looking for mmap - found
> -- Looking for sigaction
> -- Looking for sigaction - found
> -- Looking for statvfs
> -- Looking for statvfs - found
> -- Looking for statvfs64
> -- Looking for statvfs64 - found
> -- Looking for lstat
> -- Looking for lstat - found
> -- Looking for getrlimit
> -- Looking for getrlimit - found
> -- Looking for RLIMIT_AS
> -- Looking for RLIMIT_AS - found
> -- Looking for ftell64
> -- Looking for ftell64 - not found
> -- Looking for ftello64
> -- Looking for ftello64 - found
> -- Looking for fseek64
> -- Looking for fseek64 - not found
> -- Looking for fseeko64
> -- Looking for fseeko64 - found
> -- Looking for stat64
> -- Looking for stat64 - found
> -- Performing Test NO_UNIX_STDIO_64
> -- Performing Test NO_UNIX_STDIO_64 - Failed
> -- Looking for fopen64
> -- Looking for fopen64 - found
> -- Check size of off_t
> -- Check size of off_t - done
> -- Looking for pread64
> -- Looking for pread64 - found
> -- Looking for ftruncate64
> -- Looking for ftruncate64 - found
> -- Performing Test HAVE_USELOCALE
> -- Performing Test HAVE_USELOCALE - Success
> -- Performing Test HAVE_HIDE_INTERNAL_SYMBOLS
> -- Performing Test HAVE_HIDE_INTERNAL_SYMBOLS - Success
> -- Performing Test HAVE_GCC_ATOMIC_BUILTINS
> -- Performing Test HAVE_GCC_ATOMIC_BUILTINS - Success
> -- Performing Test HAVE_GCC_BSWAP
> -- Performing Test HAVE_GCC_BSWAP - Success
> -- Performing Test HAVE_SC_PHYS_PAGES
> -- Performing Test HAVE_SC_PHYS_PAGES - Success
> -- Performing Test HAVE_SCHED_GETAFFINITY
> -- Performing Test HAVE_SCHED_GETAFFINITY - Success
> -- Performing Test INT128_TEST
> -- Performing Test INT128_TEST - Success
> -- checking if sprintf can be overloaded for GDAL compilation
> -- Performing Test DEPRECATE_SPRINTF
> -- Performing Test DEPRECATE_SPRINTF - Failed
> -- Looking for linux/userfaultfd.h
> -- Looking for linux/userfaultfd.h - found
> -- GDAL_VERSION ? ? ? ? ?= 3.6.2
> -- GDAL_ABI_FULL_VERSION = 32.3.6.2
> -- GDAL_SOVERSION ? ? ? ?= 32
> -- Could NOT find ODBC (missing: ODBC_LIBRARY ODBC_INCLUDE_DIR ODBCINST)
> -- Could NOT find ODBCCPP (missing: ODBCCPP_LIBRARY ODBCCPP_INCLUDE_DIR)
> -- Could NOT find MSSQL_ODBC (missing: MSSQL_ODBC_LIBRARY 
> MSSQL_ODBC_INCLUDE_DIR MSSQL_ODBC_VERSION)
> -- Could NOT find MySQL (missing: MYSQL_LIBRARY MYSQL_INCLUDE_DIR)
> -- Could NOT find CURL (missing: CURL_LIBRARY CURL_INCLUDE_DIR)
> -- Performing Test Iconv_IS_BUILT_IN
> -- Performing Test Iconv_IS_BUILT_IN - Success
> -- Found Iconv: /usr/lib/x86_64-linux-gnu/libc.so
> -- Performing Test _ICONV_SECOND_ARGUMENT_IS_NOT_CONST
> -- Performing Test _ICONV_SECOND_ARGUMENT_IS_NOT_CONST - Success
> -- Performing Test ICONV_HAS_EXTRA_CHARSETS
> -- Performing Test ICONV_HAS_EXTRA_CHARSETS - Success
> -- Could NOT find LibXml2 (missing: LIBXML2_LIBRARY LIBXML2_INCLUDE_DIR)
> -- Could NOT find EXPAT (missing: EXPAT_DIR)
> -- Found EXPAT: /usr/lib/x86_64-linux-gnu/libexpat.so (found version 
> "2.2.9")
> -- Failed to find XercesC (missing: XercesC_LIBRARY 
> XercesC_INCLUDE_DIR XercesC_VERSION)
> -- Found ZLIB: /usr/lib/x86_64-linux-gnu/libz.so (found version "1.2.11")
> -- Could NOT find Deflate (missing: Deflate_LIBRARY Deflate_INCLUDE_DIR)
> -- Could NOT find OpenSSL, try to set the path to OpenSSL root folder 
> in the system variable OPENSSL_ROOT_DIR (missing: 
> OPENSSL_CRYPTO_LIBRARY OPENSSL_INCLUDE_DIR SSL Crypto)
> -- Could NOT find CryptoPP (missing: CRYPTOPP_LIBRARY 
> CRYPTOPP_TEST_KNOWNBUG CRYPTOPP_INCLUDE_DIR)
> CMake Error at 
> /usr/share/cmake-3.16/Modules/FindPackageHandleStandardArgs.cmake:146 
> (message):
> ? Could NOT find PROJ (missing: PROJ_LIBRARY PROJ_INCLUDE_DIR) 
> (Required is
> ? at least version "6.0")
> Call Stack (most recent call first):
> /usr/share/cmake-3.16/Modules/FindPackageHandleStandardArgs.cmake:393 
> (_FPHSA_FAILURE_MESSAGE)
> ? cmake/modules/packages/FindPROJ.cmake:57 
> (find_package_handle_standard_args)
> ? cmake/helpers/CheckDependentLibraries.cmake:355 (find_package)
> ? gdal.cmake:264 (include)
> ? CMakeLists.txt:224 (include)
>
>
> -- Configuring incomplete, errors occurred!*
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230124/f03c408b/attachment-0001.htm>

From mankoff at gmail.com  Mon Jan 23 16:35:48 2023
From: mankoff at gmail.com (Ken Mankoff)
Date: Mon, 23 Jan 2023 19:35:48 -0500
Subject: [gdal-dev] near identical files being treated differently
In-Reply-To: <d5adb41c-011b-1890-9682-7ff7001014b0@spatialys.com>
References: <87edrlju5k.fsf@t480.home>
 <d5adb41c-011b-1890-9682-7ff7001014b0@spatialys.com>
Message-ID: <87h6wgixaz.fsf@t480.home>

Hi Even,

Thanks for the explanation.

I'm not clear on what use case your PR supports. I can't gdalwarp the file - the model expects it in its current format. But if QGIS and etc. can now successfully reproject the file for display, that would be nice.

Anyway, now I understand what was happening, and can work around it. I mostly work with the 144x90 file (the one that worked) anyway.

Thank you.

  -k.

On 2023-01-23 at 10:39 -05, Even Rouault <even.rouault at spatialys.com> wrote:
> Ken,
>
> if you do "gdalinfo --debug on GLMELT_4X5.OCN.nc", you'll see
>
> GDAL_netCDF: Latitude/Y is not equally spaced (with a 0.05% tolerance). You may set the
> GDAL_NETCDF_IGNORE_EQUALLY_SPACED_XY_CHECK configuration option to YES to ignore this check
>
> and indeed
>
> $ ncdump -v lat GLMELT_4X5.OCN.nc
> [...]
> ?lat = -89, -86, -82, -78, -74, -70, -66, -62, -58, -54, -50, -46, -42, -38,
> ??? -34, -30, -26, -22, -18, -14, -10, -6, -2, 2, 6, 10, 14, 18, 22, 26, 30,
> ??? 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 74, 78, 82, 86, 89 ;
>
>
> So you can see the spacing is 4 degree, except for the first and lat
> samples where it is 3. So GDAL cannot report a geotransform matrix for
> such file.
>
> I've just submitted https://github.com/OSGeo/gdal/pull/7113 where GDAL
> will report a GEOLOCATION metadata domain, that can be used by
> gdalwarp to rectify such file
>
> $ gdalinfo autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc
>
> [...]
>
> Geolocation:
> ? GEOREFERENCING_CONVENTION=PIXEL_CENTER
> ? LINE_OFFSET=0
> ? LINE_STEP=1
> ? PIXEL_OFFSET=0
> ? PIXEL_STEP=1
> ? SRS=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]]
> ? X_BAND=1
> X_DATASET=NETCDF:"autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc":lon
> ? Y_BAND=1
> Y_DATASET=NETCDF:"autotest/gdrivers/data/netcdf/GLMELT_4X5.OCN.nc":lat
>
> Even
>
> Le 23/01/2023 ? 13:46, Ken Mankoff a ?crit?:
>> wgethttps://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_4X5.OCN.nc
>>
>> wgethttps://portal.nccs.nasa.gov/GISS_modelE/modelE_input_data/GLMELT_144X90_gas.OCN.nc


From dg0yt at darc.de  Mon Jan 23 21:28:32 2023
From: dg0yt at darc.de (dg0yt at darc.de)
Date: Tue, 24 Jan 2023 06:28:32 +0100 (CET)
Subject: [gdal-dev] Build difficulties (Ubuntu 20.04)
In-Reply-To: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>
References: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>
Message-ID: <2103941124.75754.1674538112661@office.mailbox.org>

> What are the dependencies?that I can just install with apt? I don't use conda or any of the other package managers listed in the readme. Any help is appreciated.

I would suggest to look at the gdal packaging in Ubuntu or Debian. There are "make-depends" in the dsc files or in debian/control.
My entry page is 
https://tracker.debian.org/pkg/gdal 
dsc file are linked via an icon in the "versioned links" on the left side. 
debian/control can be reached via "browse source code" on the right side.

From sebastic at xs4all.nl  Mon Jan 23 22:14:27 2023
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Tue, 24 Jan 2023 07:14:27 +0100
Subject: [gdal-dev] Build difficulties (Ubuntu 20.04)
In-Reply-To: <2103941124.75754.1674538112661@office.mailbox.org>
References: <CAK=EQyMbvUnOZ1OPj-O0OCa-APM+AV6QVEMpu1DK+jm3cELxQQ@mail.gmail.com>
 <2103941124.75754.1674538112661@office.mailbox.org>
Message-ID: <7906ef1a-6fe9-f164-eb52-466e90791f13@xs4all.nl>

On 1/24/23 06:28, dg0yt at darc.de wrote:
> I would suggest to look at the gdal packaging in Ubuntu or Debian. There are "make-depends" in the dsc files or in debian/control.
> My entry page is
> https://tracker.debian.org/pkg/gdal
> dsc file are linked via an icon in the "versioned links" on the left side.
> debian/control can be reached via "browse source code" on the right side.

If you want to install the build dependencies, ensure you have deb-src 
lines enabled in sources.list and use:

  apt build-dep gdal

Kind Regards,

Bas

-- 
  GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1


From matteo.ghetta at gmail.com  Tue Jan 24 07:04:40 2023
From: matteo.ghetta at gmail.com (matteo)
Date: Tue, 24 Jan 2023 16:04:40 +0100
Subject: [gdal-dev] Statistics of QGIS downloads
Message-ID: <7b9814eb-6d45-ce31-669e-c21c4c97fdb4@gmail.com>

Hi all,

if I'm not wrong (Tim?) there was kind of dashboard to see the download 
statistics of QGIS, but I cannot find it anymore.

Is there a link available?

Cheers and thanks

Matteo

From matteo.ghetta at gmail.com  Tue Jan 24 07:05:45 2023
From: matteo.ghetta at gmail.com (matteo)
Date: Tue, 24 Jan 2023 16:05:45 +0100
Subject: [gdal-dev] Statistics of QGIS downloads
In-Reply-To: <7b9814eb-6d45-ce31-669e-c21c4c97fdb4@gmail.com>
References: <7b9814eb-6d45-ce31-669e-c21c4c97fdb4@gmail.com>
Message-ID: <86f28b8a-596b-665b-d14e-07a3c28e9122@gmail.com>

sorry, wrong mailing list :)

On 1/24/23 16:04, matteo wrote:
> Hi all,
> 
> if I'm not wrong (Tim?) there was kind of dashboard to see the download 
> statistics of QGIS, but I cannot find it anymore.
> 
> Is there a link available?
> 
> Cheers and thanks
> 
> Matteo

From angus at myheat.ca  Tue Jan 24 16:36:14 2023
From: angus at myheat.ca (Angus Dickey)
Date: Tue, 24 Jan 2023 17:36:14 -0700
Subject: [gdal-dev] GDAL Overestimating Physical Memory
Message-ID: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>

Hi all,

I am running into an issue where GDAL is overestimating the amount of
physical memory it has leading to it locking up the OS by taking 100% of
the memory. Here is an example program that illustrates the issue:

#include <stdio.h>
#include "gdal.h"

int main(void) {
   printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
   printf("GDAL thinks is has %lld bytes of physical memory\n",
CPLGetPhysicalRAM());
   printf("GDAL thinks it has %lld bytes of usable physical memory\n",
CPLGetUsablePhysicalRAM());
   return 0;
}

When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:

$ ./get_gdal_memory
GDAL version is 3.5.1
GDAL thinks is has 811526475776 bytes of physical memory
GDAL thinks it has 811526475776 bytes of usable physical memory

Which is not consistent with the actual available memory:

$ free -h
               total        used        free      shared  buff/cache
available
Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
1.8Gi
Swap:          256Mi          0B       256Mi

So GDAL thinks it has 755GB of memory but it only has 2GB, this causes
issues with the raster read cache and maybe elsewhere. I suspect this is
happening because it is running in a Linux container
<https://linuxcontainers.org/> and GDAL is getting the total physical
memory of the host, not the container. The strange thing is Linux
containers use cgroups for memory restrictions and the API docs mention it
was fixed in GDAL 2.4.0
<https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv> but I am still
seeing the issue in 3.5.1.

Any help or insight would be appreciated; I am happy to provide any
additional information or testing.

Thanks,

Angus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230124/b9a2b6ff/attachment.htm>

From even.rouault at spatialys.com  Tue Jan 24 16:50:28 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2023 01:50:28 +0100
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
Message-ID: <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>

Angus,

there has been a recent extra fix that landed in GDAL 3.6.2 that might 
possibly help: https://github.com/OSGeo/gdal/pull/6926

Even

Le 25/01/2023 ? 01:36, Angus Dickey a ?crit?:
> Hi all,
>
> I am running into an issue?where GDAL is overestimating the amount of 
> physical memory?it has leading to it locking up the OS by?taking 100% 
> of the memory. Here is an example program that illustrates the issue:
>
> #include <stdio.h>
> #include "gdal.h"
>
> int main(void) {
> ? ?printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
> ? ?printf("GDAL thinks is has %lld bytes of physical memory\n", 
> CPLGetPhysicalRAM());
> ? ?printf("GDAL thinks it has %lld bytes of usable physical memory\n", 
> CPLGetUsablePhysicalRAM());
> ? ?return 0;
> }
>
> When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>
> $ ./get_gdal_memory
> GDAL version is 3.5.1
> GDAL thinks is has 811526475776 bytes of physical memory
> GDAL thinks it has 811526475776 bytes of usable physical memory
>
> Which is not consistent with the actual available memory:
>
> $ free -h
> ? ? ? ? ? ? ? ?total ? ? ? ?used ? ? ? ?free ? ? ?shared ?buff/cache ? 
> available
> Mem: ? ? ? ? ? 2.0Gi ? ? ? 148Mi ? ? ? 1.2Gi ? ? ? 0.0Ki 639Mi ? ? ? 1.8Gi
> Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B ? ? ? 256Mi
>
> So GDAL thinks it has 755GB of memory?but it only has 2GB, this causes 
> issues with the raster read cache and maybe elsewhere. I suspect this 
> is happening because it is running in a Linux container 
> <https://linuxcontainers.org/>?and GDAL is getting the total physical 
> memory of the host, not the container. The strange thing is Linux 
> containers use cgroups for memory restrictions and the API docs 
> mention it was fixed in GDAL 2.4.0 
> <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv>?but I am 
> still seeing the issue?in 3.5.1.
>
> Any help or insight would be appreciated; I am happy to provide any 
> additional?information?or testing.
>
> Thanks,
>
> Angus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230125/4fff862f/attachment.htm>

From angus at myheat.ca  Tue Jan 24 21:24:20 2023
From: angus at myheat.ca (Angus Dickey)
Date: Tue, 24 Jan 2023 22:24:20 -0700
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
Message-ID: <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>

Even,


Thanks for the reply, I went ahead and compiled the latest GDAL 3.6.2 on
Ubuntu 22.04. Unfortunately I ended up with a similar result, GDAL thinks
it has 755GB of RAM to work with when it only has 2GB:


$ gdalinfo --version
GDAL 3.6.2, released 2023/01/02 (debug build)

$ ./get_gdal_memory
GDAL version is 3.6.2
GDAL thinks is has 811526475776 bytes of physical memory
GDAL thinks it has 811526475776 bytes of usable physical memory

$ free -h
               total        used        free      shared  buff/cache
available
Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
1.8Gi
Swap:          256Mi          0B       256Mi

My knowledge on the subject is limited but I think Linux containers (LXC)
uses cgroups and not setrlimit to limit resources, so maybe that is why the
new changes had no effect. To reproduce this issue you can create a
container using  LXC, LXD, or a hypervision like proxmox (what I am using)
and call CPLGetUsablePhysicalRAM().

If there is any other info that might be helpful let me know. I might try a
Docker container (it also uses cgroups) and is more popular than LXC,
although it fulfills a different function.

thanks,

Angus


On Tue, Jan 24, 2023 at 5:50 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Angus,
>
> there has been a recent extra fix that landed in GDAL 3.6.2 that might
> possibly help: https://github.com/OSGeo/gdal/pull/6926
>
> Even
> Le 25/01/2023 ? 01:36, Angus Dickey a ?crit :
>
> Hi all,
>
> I am running into an issue where GDAL is overestimating the amount of
> physical memory it has leading to it locking up the OS by taking 100% of
> the memory. Here is an example program that illustrates the issue:
>
> #include <stdio.h>
> #include "gdal.h"
>
> int main(void) {
>    printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
>    printf("GDAL thinks is has %lld bytes of physical memory\n",
> CPLGetPhysicalRAM());
>    printf("GDAL thinks it has %lld bytes of usable physical memory\n",
> CPLGetUsablePhysicalRAM());
>    return 0;
> }
>
> When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>
> $ ./get_gdal_memory
> GDAL version is 3.5.1
> GDAL thinks is has 811526475776 bytes of physical memory
> GDAL thinks it has 811526475776 bytes of usable physical memory
>
> Which is not consistent with the actual available memory:
>
> $ free -h
>                total        used        free      shared  buff/cache
> available
> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
> 1.8Gi
> Swap:          256Mi          0B       256Mi
>
> So GDAL thinks it has 755GB of memory but it only has 2GB, this causes
> issues with the raster read cache and maybe elsewhere. I suspect this is
> happening because it is running in a Linux container
> <https://linuxcontainers.org/> and GDAL is getting the total physical
> memory of the host, not the container. The strange thing is Linux
> containers use cgroups for memory restrictions and the API docs mention
> it was fixed in GDAL 2.4.0
> <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv> but I am still
> seeing the issue in 3.5.1.
>
> Any help or insight would be appreciated; I am happy to provide any
> additional information or testing.
>
> Thanks,
>
> Angus
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230124/488d304c/attachment.htm>

From even.rouault at spatialys.com  Wed Jan 25 03:49:23 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2023 12:49:23 +0100
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
Message-ID: <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>

Angus,

I'm not familiar with LXC. I tried to setup LXD with 
https://linuxcontainers.org/lxd/introduction/ but it fails with a 
mysterious "Error: Failed to create local member network "lxdbr0" in 
project "default": Failed generating auto config: Failed to 
automatically find an unused IPv4 subnet, manual configuration required"

Anyway, I've attempted in https://github.com/OSGeo/gdal/pull/7124 to 
better take into account cgroup to get memory limitation. Could you give 
this a try?

Even

Le 25/01/2023 ? 06:24, Angus Dickey a ?crit?:
>
> Even,
>
>
> Thanks for the reply, I went ahead and compiled the latest GDAL 3.6.2 
> on Ubuntu 22.04. Unfortunately I ended up with a similar result, GDAL 
> thinks it has 755GB of RAM to work with when it only has 2GB:
>
>
> $ gdalinfo --version
> GDAL 3.6.2, released 2023/01/02 (debug build)
>
> $ ./get_gdal_memory
> GDAL version is 3.6.2
> GDAL thinks is has 811526475776 bytes of physical memory
> GDAL thinks it has 811526475776 bytes of usable physical memory
>
> $ free -h
> ? ? ? ? ? ? ? ?total ? ? ? ?used ? ? ? ?free ?shared ?buff/cache ? 
> available
> Mem: ? ? ? ? ? 2.0Gi ? ? ? 148Mi ? ? ? 1.2Gi 0.0Ki ? ? ? 639Mi ? ? ? 1.8Gi
> Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B ? ? ? 256Mi
>
>
> My knowledge on the subject is limited?but I think Linux containers 
> (LXC) uses cgroups and not setrlimit to limit resources,?so maybe that 
> is why the new changes had no effect. To reproduce this issue you can 
> create a container using? LXC, LXD, or a hypervision like proxmox 
> (what I am using) and call CPLGetUsablePhysicalRAM().
>
> If there is any other info that might be helpful let me know.?I might 
> try a Docker container (it also uses cgroups) and is more popular than 
> LXC, although it fulfills a different function.
>
> thanks,
>
> Angus
>
>
> On Tue, Jan 24, 2023 at 5:50 PM Even Rouault 
> <even.rouault at spatialys.com> wrote:
>
>     Angus,
>
>     there has been a recent extra fix that landed in GDAL 3.6.2 that
>     might possibly help: https://github.com/OSGeo/gdal/pull/6926
>
>     Even
>
>     Le 25/01/2023 ? 01:36, Angus Dickey a ?crit?:
>>     Hi all,
>>
>>     I am running into an issue?where GDAL is overestimating the
>>     amount of physical memory?it has leading to it locking up the OS
>>     by?taking 100% of the memory. Here is an example program that
>>     illustrates the issue:
>>
>>     #include <stdio.h>
>>     #include "gdal.h"
>>
>>     int main(void) {
>>     ? ?printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
>>     ? ?printf("GDAL thinks is has %lld bytes of physical memory\n",
>>     CPLGetPhysicalRAM());
>>     ? ?printf("GDAL thinks it has %lld bytes of usable physical
>>     memory\n", CPLGetUsablePhysicalRAM());
>>     ? ?return 0;
>>     }
>>
>>     When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>>
>>     $ ./get_gdal_memory
>>     GDAL version is 3.5.1
>>     GDAL thinks is has 811526475776 bytes of physical memory
>>     GDAL thinks it has 811526475776 bytes of usable physical memory
>>
>>     Which is not consistent with the actual available memory:
>>
>>     $ free -h
>>     ? ? ? ? ? ? ? ?total ? ? ? ?used ? ? ? ?free ? ?shared
>>     ?buff/cache ? available
>>     Mem: ? ? ? ? ? 2.0Gi ? ? ? 148Mi ? ? ? 1.2Gi ? ? 0.0Ki ? ? ?
>>     639Mi ? ? ? 1.8Gi
>>     Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B ? ? ? 256Mi
>>
>>     So GDAL thinks it has 755GB of memory?but it only has 2GB, this
>>     causes issues with the raster read cache and maybe elsewhere. I
>>     suspect this is happening because it is running in a Linux
>>     container <https://linuxcontainers.org/>?and GDAL is getting the
>>     total physical memory of the host, not the container. The strange
>>     thing is Linux containers use cgroups for memory restrictions and
>>     the API docs mention it was fixed in GDAL 2.4.0
>>     <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv>?but I
>>     am still seeing the issue?in 3.5.1.
>>
>>     Any help or insight would be appreciated; I am happy to provide
>>     any additional?information?or testing.
>>
>>     Thanks,
>>
>>     Angus
>>
>>     _______________________________________________
>>     gdal-dev mailing list
>>     gdal-dev at lists.osgeo.org
>>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230125/76ea3ff5/attachment-0001.htm>

From even.rouault at spatialys.com  Wed Jan 25 03:56:37 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Jan 2023 12:56:37 +0100
Subject: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method
Message-ID: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>

Hi,

Motion: adopt RFC 91: GDALDataset::Close() method

https://github.com/OSGeo/gdal/pull/7108

Starting with my +1,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From schwehr at gmail.com  Wed Jan 25 06:48:08 2023
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 25 Jan 2023 06:48:08 -0800
Subject: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method
In-Reply-To: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
References: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
Message-ID: <CACmBxyuBStTAusPYe-o0k5hR-nJbfYX=2zTHeP63aoH3tpFUJA@mail.gmail.com>

+1 KurtS

On Wed, Jan 25, 2023, 3:56 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Motion: adopt RFC 91: GDALDataset::Close() method
>
> https://github.com/OSGeo/gdal/pull/7108
>
> Starting with my +1,
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230125/7c7c8fe4/attachment.htm>

From mateusz at loskot.net  Wed Jan 25 07:00:45 2023
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 25 Jan 2023 16:00:45 +0100
Subject: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method
In-Reply-To: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
References: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
Message-ID: <CABUeae_WmL621vaav77tmP0=+6ir_MyUcSypBVxOCDPxjZZTtA@mail.gmail.com>

+1    Mateusz

On Wed, 25 Jan 2023 at 12:56, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
> Motion: adopt RFC 91: GDALDataset::Close() method
>
> https://github.com/OSGeo/gdal/pull/7108
>
> Starting with my +1,
>
> Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jan 25 07:11:33 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 25 Jan 2023 15:11:33 +0000
Subject: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method
In-Reply-To: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
References: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
Message-ID: <AM0PR09MB3219806D5B05065E6137B4EEFDCE9@AM0PR09MB3219.eurprd09.prod.outlook.com>

+0

I suppose it is good but I do not claim that I know that it is.

-Jukka Rahkonen-

-----Alkuper?inen viesti-----
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Even Rouault
L?hetetty: keskiviikko 25. tammikuuta 2023 13.57
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method

Hi,

Motion: adopt RFC 91: GDALDataset::Close() method

https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fpull%2F7108&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C1a2947e12fc645153b1708dafecb43bc%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638102446218372001%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=94Dyfc6UPErCXarsFgI5SXmODlsWaCcbW1OCPvVykgk%3D&reserved=0

Starting with my +1,

Even

-- 
https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C1a2947e12fc645153b1708dafecb43bc%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638102446218372001%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=2DUlP71z8loAKgQrUixYzBTYmtyB85GJHOQgWctrC4Q%3D&reserved=0
My software is free, but my time generally not.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C1a2947e12fc645153b1708dafecb43bc%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C0%7C638102446218372001%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=gBrYkSJN87nZ5EwoHFcKxA%2FxZMAiQTCZZm0YfHTW3N8%3D&reserved=0

From angus at myheat.ca  Wed Jan 25 17:13:54 2023
From: angus at myheat.ca (Angus Dickey)
Date: Wed, 25 Jan 2023 18:13:54 -0700
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
 <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
Message-ID: <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>

Even,

Thanks, that is some quick turn around! I imagine Proxmox
<https://www.proxmox.com/en/> or LXD
<https://linuxcontainers.org/lxd/introduction/> are pretty much what
everyone uses to create linux containers. LXC is the underlying technology
but also has a set of command line tools that can be used to create
containers. In your case it sounds like LXD can't choose a subnet for your
linux bridge, which is mysterious and I don't know how to fix that.

I tried your update inside a container and am still seeing the problem
where GDAL thinks it has the full host memory:

$ gdalinfo --version
GDAL 3.7.0dev, released 2023/99/99 (debug build)
$ ./get_gdal_memory
GDAL version is 3.7.0dev
GDAL thinks it has 135083474944 bytes of physical memory
GDAL thinks it has 135083474944 bytes of usable physical memory
sysinfo() thinks it has 135083474944 bytes of physical memory
$ free -h
               total        used        free      shared  buff/cache
available
Mem:           2.0Gi       152Mi       1.1Gi       0.0Ki       755Mi
1.8Gi
Swap:          256Mi          0B       256Mi
$ cat /proc/meminfo | grep MemTotal
MemTotal:        2048000 kB

I wanted to dig a bit but am no expert in containerization and cgroup v2.
It seems that some tools show the memory the container has (free
<https://man7.org/linux/man-pages/man1/free.1.html>& /proc/meminfo
<https://man7.org/linux/man-pages/man5/proc.5.html>) and others (sysinfo
<https://man7.org/linux/man-pages/man2/sysinfo.2.html>) show the host
memory. For cgroups v2 I see your code is trying to find the max memory
from a specific memory.max file in /sys/fs/cgroup/. In my *containers *that
file (actually all the memory.max files) contain the default value "max".

$ find /sys/fs/cgroup -type f -name memory.max -exec sh -c "cat '{}'" \;
max
max
max
... all max ...
max

If I try the same thing on the *host *I actually find it is set to the
expected value.

cat $ /sys/fs/cgroup/lxc/901/memory.max
2097152000

The cgroup values on the host appear to be what is limiting the container
memory, more rules can be added inside the container but they are still
beholden to the host rules. I am not sure how free & /proc/memory are
getting the correct available memory but maybe I will ask the proxmox or
LXD people.

Thanks again,

Angus


On Wed, Jan 25, 2023 at 4:49 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Angus,
>
> I'm not familiar with LXC. I tried to setup LXD with
> https://linuxcontainers.org/lxd/introduction/ but it fails with a
> mysterious "Error: Failed to create local member network "lxdbr0" in
> project "default": Failed generating auto config: Failed to automatically
> find an unused IPv4 subnet, manual configuration required"
>
> Anyway, I've attempted in https://github.com/OSGeo/gdal/pull/7124 to
> better take into account cgroup to get memory limitation. Could you give
> this a try?
>
> Even
> Le 25/01/2023 ? 06:24, Angus Dickey a ?crit :
>
> Even,
>
>
> Thanks for the reply, I went ahead and compiled the latest GDAL 3.6.2 on
> Ubuntu 22.04. Unfortunately I ended up with a similar result, GDAL thinks
> it has 755GB of RAM to work with when it only has 2GB:
>
>
> $ gdalinfo --version
> GDAL 3.6.2, released 2023/01/02 (debug build)
>
> $ ./get_gdal_memory
> GDAL version is 3.6.2
> GDAL thinks is has 811526475776 bytes of physical memory
> GDAL thinks it has 811526475776 bytes of usable physical memory
>
> $ free -h
>                total        used        free      shared  buff/cache
> available
> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
> 1.8Gi
> Swap:          256Mi          0B       256Mi
>
> My knowledge on the subject is limited but I think Linux containers (LXC)
> uses cgroups and not setrlimit to limit resources, so maybe that is why the
> new changes had no effect. To reproduce this issue you can create a
> container using  LXC, LXD, or a hypervision like proxmox (what I am using)
> and call CPLGetUsablePhysicalRAM().
>
> If there is any other info that might be helpful let me know. I might try
> a Docker container (it also uses cgroups) and is more popular than LXC,
> although it fulfills a different function.
>
> thanks,
>
> Angus
>
>
> On Tue, Jan 24, 2023 at 5:50 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Angus,
>>
>> there has been a recent extra fix that landed in GDAL 3.6.2 that might
>> possibly help: https://github.com/OSGeo/gdal/pull/6926
>>
>> Even
>> Le 25/01/2023 ? 01:36, Angus Dickey a ?crit :
>>
>> Hi all,
>>
>> I am running into an issue where GDAL is overestimating the amount of
>> physical memory it has leading to it locking up the OS by taking 100% of
>> the memory. Here is an example program that illustrates the issue:
>>
>> #include <stdio.h>
>> #include "gdal.h"
>>
>> int main(void) {
>>    printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
>>    printf("GDAL thinks is has %lld bytes of physical memory\n",
>> CPLGetPhysicalRAM());
>>    printf("GDAL thinks it has %lld bytes of usable physical memory\n",
>> CPLGetUsablePhysicalRAM());
>>    return 0;
>> }
>>
>> When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>>
>> $ ./get_gdal_memory
>> GDAL version is 3.5.1
>> GDAL thinks is has 811526475776 bytes of physical memory
>> GDAL thinks it has 811526475776 bytes of usable physical memory
>>
>> Which is not consistent with the actual available memory:
>>
>> $ free -h
>>                total        used        free      shared  buff/cache
>> available
>> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
>>   1.8Gi
>> Swap:          256Mi          0B       256Mi
>>
>> So GDAL thinks it has 755GB of memory but it only has 2GB, this causes
>> issues with the raster read cache and maybe elsewhere. I suspect this is
>> happening because it is running in a Linux container
>> <https://linuxcontainers.org/> and GDAL is getting the total physical
>> memory of the host, not the container. The strange thing is Linux
>> containers use cgroups for memory restrictions and the API docs mention
>> it was fixed in GDAL 2.4.0
>> <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv> but I am
>> still seeing the issue in 3.5.1.
>>
>> Any help or insight would be appreciated; I am happy to provide any
>> additional information or testing.
>>
>> Thanks,
>>
>> Angus
>>
>> _______________________________________________
>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230125/c410f79e/attachment.htm>

From lnicola at dend.ro  Wed Jan 25 23:21:54 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 26 Jan 2023 09:21:54 +0200
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
 <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
 <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
Message-ID: <b94b9764-9f9c-43cc-9bf2-6c5092b73d84@betaapp.fastmail.com>

Hello,

I also managed to reproduce this in Docker (4 GB limit):

# cat /proc/self/cgroup 
0::/
# cat /sys/fs/cgroup/memory.max
4294967296
# autotest/cpp/gdallimits 
CPLGetNumCPUs = 32
CPLGetUsablePhysicalRAM = 62 GB

(podman behaves exactly the same)

Laurentiu

On Thu, Jan 26, 2023, at 03:13, Angus Dickey wrote:
> Even,
> 
> Thanks, that is some quick turn around! I imagine Proxmox <https://www.proxmox.com/en/> or LXD <https://linuxcontainers.org/lxd/introduction/> are pretty much what everyone uses to create linux containers. LXC is the underlying technology but also has a set of command line tools that can be used to create containers. In your case it sounds like LXD can't choose a subnet for your linux bridge, which is mysterious and I don't know how to fix that.
> 
> I tried your update inside a container and am still seeing the problem where GDAL thinks it has the full host memory:
> 
> $ gdalinfo --version
> GDAL 3.7.0dev, released 2023/99/99 (debug build)
> $ ./get_gdal_memory
> GDAL version is 3.7.0dev
> GDAL thinks it has 135083474944 bytes of physical memory
> GDAL thinks it has 135083474944 bytes of usable physical memory
> sysinfo() thinks it has 135083474944 bytes of physical memory
> $ free -h
>                total        used        free      shared  buff/cache   available
> Mem:           2.0Gi       152Mi       1.1Gi       0.0Ki       755Mi       1.8Gi
> Swap:          256Mi          0B       256Mi
> $ cat /proc/meminfo | grep MemTotal
> MemTotal:        2048000 kB
> 
> I wanted to dig a bit but am no expert in containerization and cgroup v2. It seems that some tools show the memory the container has (free  <https://man7.org/linux/man-pages/man1/free.1.html>& /proc/meminfo <https://man7.org/linux/man-pages/man5/proc.5.html>) and others (sysinfo <https://man7.org/linux/man-pages/man2/sysinfo.2.html>) show the host memory. For cgroups v2 I see your code is trying to find the max memory from a specific memory.max file in /sys/fs/cgroup/. In my *containers *that file (actually all the memory.max files) contain the default value "max".
> 
> $ find /sys/fs/cgroup -type f -name memory.max -exec sh -c "cat '{}'" \;
> max
> max
> max
> ... all max ...
> max
> 
> If I try the same thing on the *host *I actually find it is set to the expected value.
> 
> cat $ /sys/fs/cgroup/lxc/901/memory.max
> 2097152000
> 
> The cgroup values on the host appear to be what is limiting the container memory, more rules can be added inside the container but they are still beholden to the host rules. I am not sure how free & /proc/memory are getting the correct available memory but maybe I will ask the proxmox or LXD people.
> 
> Thanks again,
> 
> Angus
> 
> 
> On Wed, Jan 25, 2023 at 4:49 AM Even Rouault <even.rouault at spatialys.com> wrote:
>> Angus,
>> 
>> I'm not familiar with LXC. I tried to setup LXD with https://linuxcontainers.org/lxd/introduction/ but it fails with a mysterious "Error: Failed to create local member network "lxdbr0" in project "default": Failed generating auto config: Failed to automatically find an unused IPv4 subnet, manual configuration required"
>> 
>> Anyway, I've attempted in https://github.com/OSGeo/gdal/pull/7124 to better take into account cgroup to get memory limitation. Could you give this a try?
>> 
>> Even
>> 
>> Le 25/01/2023 ? 06:24, Angus Dickey a ?crit :
>>> Even,
>>> 
>>> 
>>> 
>>> Thanks for the reply, I went ahead and compiled the latest GDAL 3.6.2 on Ubuntu 22.04. Unfortunately I ended up with a similar result, GDAL thinks it has 755GB of RAM to work with when it only has 2GB:
>>> 
>>> 
>>> 
>>> $ gdalinfo --version
>>> GDAL 3.6.2, released 2023/01/02 (debug build)
>>> 
>>> $ ./get_gdal_memory
>>> GDAL version is 3.6.2
>>> GDAL thinks is has 811526475776 bytes of physical memory
>>> GDAL thinks it has 811526475776 bytes of usable physical memory
>>> 
>>> $ free -h
>>>                total        used        free      shared  buff/cache   available
>>> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi       1.8Gi
>>> Swap:          256Mi          0B       256Mi
>>> 
>>> 
>>> My knowledge on the subject is limited but I think Linux containers (LXC) uses cgroups and not setrlimit to limit resources, so maybe that is why the new changes had no effect. To reproduce this issue you can create a container using  LXC, LXD, or a hypervision like proxmox (what I am using) and call CPLGetUsablePhysicalRAM().
>>> 
>>> If there is any other info that might be helpful let me know. I might try a Docker container (it also uses cgroups) and is more popular than LXC, although it fulfills a different function.
>>> 
>>> thanks,
>>> 
>>> Angus
>>> 
>>> 
>>> On Tue, Jan 24, 2023 at 5:50 PM Even Rouault <even.rouault at spatialys.com> wrote:
>>>> Angus,
>>>> 
>>>> there has been a recent extra fix that landed in GDAL 3.6.2 that might possibly help: https://github.com/OSGeo/gdal/pull/6926
>>>> 
>>>> Even
>>>> 
>>>> Le 25/01/2023 ? 01:36, Angus Dickey a ?crit :
>>>>> Hi all,
>>>>> 
>>>>> I am running into an issue where GDAL is overestimating the amount of physical memory it has leading to it locking up the OS by taking 100% of the memory. Here is an example program that illustrates the issue:
>>>>> 
>>>>> #include <stdio.h>
>>>>> #include "gdal.h"
>>>>> 
>>>>> int main(void) {
>>>>>    printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
>>>>>    printf("GDAL thinks is has %lld bytes of physical memory\n", CPLGetPhysicalRAM());
>>>>>    printf("GDAL thinks it has %lld bytes of usable physical memory\n", CPLGetUsablePhysicalRAM());
>>>>>    return 0;
>>>>> }
>>>>> 
>>>>> When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>>>>> 
>>>>> $ ./get_gdal_memory 
>>>>> GDAL version is 3.5.1
>>>>> GDAL thinks is has 811526475776 bytes of physical memory
>>>>> GDAL thinks it has 811526475776 bytes of usable physical memory
>>>>> 
>>>>> Which is not consistent with the actual available memory:
>>>>> 
>>>>> $ free -h
>>>>>                total        used        free      shared  buff/cache   available
>>>>> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi       1.8Gi
>>>>> Swap:          256Mi          0B       256Mi
>>>>> 
>>>>> So GDAL thinks it has 755GB of memory but it only has 2GB, this causes issues with the raster read cache and maybe elsewhere. I suspect this is happening because it is running in a Linux container <https://linuxcontainers.org/> and GDAL is getting the total physical memory of the host, not the container. The strange thing is Linux containers use cgroups for memory restrictions and the API docs mention it was fixed in GDAL 2.4.0 <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv> but I am still seeing the issue in 3.5.1.
>>>>> 
>>>>> Any help or insight would be appreciated; I am happy to provide any additional information or testing.
>>>>> 
>>>>> Thanks,
>>>>> 
>>>>> Angus
>>>>> 
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>> 
>>>> -- 
>>>> http://www.spatialys.com
>>>> My software is free, but my time generally not.
>> -- 
>> http://www.spatialys.com
>> My software is free, but my time generally not.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230126/85152952/attachment-0001.htm>

From even.rouault at spatialys.com  Thu Jan 26 06:52:39 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2023 15:52:39 +0100
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
 <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
 <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
Message-ID: <e6a6f25f-4eda-cbed-caf4-a5419e57b924@spatialys.com>

Angus,

I've just edited the pull request to take into account MemTotal of 
/proc/meminfo. Only tested on my host Linux, but hopefully that should 
work also for your setup given the elements you've mentionned.

Lauren?iu,

are you 100% positive you've tested the updated version of the pull 
request? I've just given a try to running gdallimits under Docker from a 
Ubuntu 22.04 host and it successfully takes into account the 
/sys/fs/cgroup/memory.max limit

Even

Le 26/01/2023 ? 02:13, Angus Dickey a ?crit?:
> Even,
>
> Thanks, that is some quick turn around! I imagine Proxmox 
> <https://www.proxmox.com/en/>?or LXD 
> <https://linuxcontainers.org/lxd/introduction/> are pretty much what 
> everyone uses to create linux containers. LXC is the underlying 
> technology but also has a set of command line tools that can be used 
> to create containers. In your case it sounds like LXD can't choose a 
> subnet for your linux bridge, which is mysterious and I don't know how 
> to fix that.
>
> I tried your update inside a container and am still seeing the problem 
> where GDAL thinks it has the full host memory:
>
> $ gdalinfo --version
> GDAL 3.7.0dev, released 2023/99/99 (debug build)
> $?./get_gdal_memory
> GDAL version is 3.7.0dev
> GDAL thinks it has 135083474944 bytes of physical memory
> GDAL thinks it has 135083474944 bytes of usable physical memory
> sysinfo() thinks it has 135083474944 bytes of physical memory
> $ free -h
> ? ? ? ? ? ? ? ?total ? ? ? ?used ? ? ? ?free ? ? ?shared ?buff/cache ? 
> available
> Mem: ? ? ? ? ? 2.0Gi ? ? ? 152Mi ? ? ? 1.1Gi ? ? ? 0.0Ki ? 755Mi ? ? ? 
> 1.8Gi
> Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B ? ? ? 256Mi
> $ cat /proc/meminfo | grep MemTotal
> MemTotal: ? ? ? ?2048000 kB
>
> I wanted to dig a bit but am no expert in containerization?and cgroup 
> v2. It seems that some tools show the memory the container has (free 
> <https://man7.org/linux/man-pages/man1/free.1.html>& /proc/meminfo 
> <https://man7.org/linux/man-pages/man5/proc.5.html>) and others 
> (sysinfo <https://man7.org/linux/man-pages/man2/sysinfo.2.html>) show 
> the host memory. For cgroups v2 I see your code is trying to find the 
> max memory from a specific memory.max file in /sys/fs/cgroup/. In my 
> /containers /that file (actually all the memory.max?files) contain the 
> default value "max".
>
> $ find /sys/fs/cgroup -type f -name memory.max -exec sh -c "cat '{}'" \;
> max
> max
> max
> ... all max ...
> max
>
> If I try the same thing on the /host /I actually find it is set to the 
> expected value.
>
> cat $ /sys/fs/cgroup/lxc/901/memory.max
> 2097152000
>
> The cgroup values on the host appear to be what is limiting the 
> container memory, more rules can be added inside the container but 
> they are still beholden to the host rules. I am not sure how free & 
> /proc/memory?are getting the correct available?memory but maybe I will 
> ask the proxmox or LXD people.
>
> Thanks again,
>
> Angus
>
>
> On Wed, Jan 25, 2023 at 4:49 AM Even Rouault 
> <even.rouault at spatialys.com> wrote:
>
>     Angus,
>
>     I'm not familiar with LXC. I tried to setup LXD with
>     https://linuxcontainers.org/lxd/introduction/ but it fails with a
>     mysterious "Error: Failed to create local member network "lxdbr0"
>     in project "default": Failed generating auto config: Failed to
>     automatically find an unused IPv4 subnet, manual configuration
>     required"
>
>     Anyway, I've attempted in https://github.com/OSGeo/gdal/pull/7124
>     to better take into account cgroup to get memory limitation. Could
>     you give this a try?
>
>     Even
>
>     Le 25/01/2023 ? 06:24, Angus Dickey a ?crit?:
>>
>>     Even,
>>
>>
>>     Thanks for the reply, I went ahead and compiled the latest GDAL
>>     3.6.2 on Ubuntu 22.04. Unfortunately I ended up with a similar
>>     result, GDAL thinks it has 755GB of RAM to work with when it only
>>     has 2GB:
>>
>>
>>     $ gdalinfo --version
>>     GDAL 3.6.2, released 2023/01/02 (debug build)
>>
>>     $ ./get_gdal_memory
>>     GDAL version is 3.6.2
>>     GDAL thinks is has 811526475776 bytes of physical memory
>>     GDAL thinks it has 811526475776 bytes of usable physical memory
>>
>>     $ free -h
>>     ? ? ? ? ? ? ? ?total ? ? ? ?used ?free ? ? ?shared ?buff/cache ?
>>     available
>>     Mem: ? ? ? ? ? 2.0Gi ? ? ? 148Mi 1.2Gi ? ? ? 0.0Ki ? ? ? 639Mi ?
>>     ? ? 1.8Gi
>>     Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B 256Mi
>>
>>
>>     My knowledge on the subject is limited?but I think Linux
>>     containers (LXC) uses cgroups and not setrlimit to limit
>>     resources,?so maybe that is why the new changes had no effect. To
>>     reproduce this issue you can create a container using? LXC, LXD,
>>     or a hypervision like proxmox (what I am using) and call
>>     CPLGetUsablePhysicalRAM().
>>
>>     If there is any other info that might be helpful let me know.?I
>>     might try a Docker container (it also uses cgroups) and is more
>>     popular than LXC, although it fulfills a different function.
>>
>>     thanks,
>>
>>     Angus
>>
>>
>>     On Tue, Jan 24, 2023 at 5:50 PM Even Rouault
>>     <even.rouault at spatialys.com> wrote:
>>
>>         Angus,
>>
>>         there has been a recent extra fix that landed in GDAL 3.6.2
>>         that might possibly help: https://github.com/OSGeo/gdal/pull/6926
>>
>>         Even
>>
>>         Le 25/01/2023 ? 01:36, Angus Dickey a ?crit?:
>>>         Hi all,
>>>
>>>         I am running into an issue?where GDAL is overestimating the
>>>         amount of physical memory?it has leading to it locking up
>>>         the OS by?taking 100% of the memory. Here is an example
>>>         program that illustrates the issue:
>>>
>>>         #include <stdio.h>
>>>         #include "gdal.h"
>>>
>>>         int main(void) {
>>>         ? ?printf("GDAL version is %s\n",
>>>         GDALVersionInfo("RELEASE_NAME"));
>>>         ? ?printf("GDAL thinks is has %lld bytes of physical
>>>         memory\n", CPLGetPhysicalRAM());
>>>         ? ?printf("GDAL thinks it has %lld bytes of usable physical
>>>         memory\n", CPLGetUsablePhysicalRAM());
>>>         ? ?return 0;
>>>         }
>>>
>>>         When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>>>
>>>         $ ./get_gdal_memory
>>>         GDAL version is 3.5.1
>>>         GDAL thinks is has 811526475776 bytes of physical memory
>>>         GDAL thinks it has 811526475776 bytes of usable physical memory
>>>
>>>         Which is not consistent with the actual available memory:
>>>
>>>         $ free -h
>>>         ? ? ? ? ? ? ? ?total ? ? ? ?used ?free ? ? ?shared
>>>         ?buff/cache available
>>>         Mem: ? ? ? ? ? 2.0Gi ? ? ? 148Mi 1.2Gi ? ? ? 0.0Ki ? ? ?
>>>         639Mi 1.8Gi
>>>         Swap: ? ? ? ? ?256Mi ? ? ? ? ?0B 256Mi
>>>
>>>         So GDAL thinks it has 755GB of memory?but it only has 2GB,
>>>         this causes issues with the raster read cache and maybe
>>>         elsewhere. I suspect this is happening because it is running
>>>         in a Linux container <https://linuxcontainers.org/>?and GDAL
>>>         is getting the total physical memory of the host, not the
>>>         container. The strange thing is Linux containers use cgroups
>>>         for memory restrictions and the API docs mention it was
>>>         fixed in GDAL 2.4.0
>>>         <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv>?but
>>>         I am still seeing the issue?in 3.5.1.
>>>
>>>         Any help or insight would be appreciated; I am happy to
>>>         provide any additional?information?or testing.
>>>
>>>         Thanks,
>>>
>>>         Angus
>>>
>>>         _______________________________________________
>>>         gdal-dev mailing list
>>>         gdal-dev at lists.osgeo.org
>>>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>         -- 
>>         http://www.spatialys.com
>>         My software is free, but my time generally not.
>>
>     -- 
>     http://www.spatialys.com
>     My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230126/b04cb368/attachment.htm>

From lnicola at dend.ro  Thu Jan 26 07:31:59 2023
From: lnicola at dend.ro (=?UTF-8?Q?Lauren=C8=9Biu_Nicola?=)
Date: Thu, 26 Jan 2023 17:31:59 +0200
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <e6a6f25f-4eda-cbed-caf4-a5419e57b924@spatialys.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
 <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
 <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
 <e6a6f25f-4eda-cbed-caf4-a5419e57b924@spatialys.com>
Message-ID: <1d471001-789e-49df-9809-32b645205f04@betaapp.fastmail.com>



On Thu, Jan 26, 2023, at 16:52, Even Rouault wrote:
> Lauren?iu,
> 
> are you 100% positive you've tested the updated version of the pull request? I've just given a try to running gdallimits under Docker from a Ubuntu 22.04 host and it successfully takes into account the /sys/fs/cgroup/memory.max limit
> 
I'm afraid not, or at least it's working now. Sorry for the false alarm.

Laurentiu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230126/7543e212/attachment-0001.htm>

From even.rouault at spatialys.com  Thu Jan 26 13:27:21 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Jan 2023 22:27:21 +0100
Subject: [gdal-dev] Announcing SOZip: Seek-Optimized profile for the
 .zip format
In-Reply-To: <27880af0-3036-3c99-9cbf-7ecb0ffd509c@spatialys.com>
References: <27880af0-3036-3c99-9cbf-7ecb0ffd509c@spatialys.com>
Message-ID: <2ad3b46d-3eec-bb0f-727f-ca9ac7c0bec9@spatialys.com>

Hi,

The implementation has just been merged into GDAL master

You can for example test it with gdal-master and QGIS Conda packages:
conda create --name sozip_test
conda activate sozip_test
conda install -c gdal-master gdal
conda install -c conda-forge qgis

And for example with a large GeoPackage file (filenames to adapt of course):
sozip -j output.gpkg.zip /path/to/input.gpkg
qgis output.gpkg.zip

Even

Le 09/01/2023 ? 15:19, Even Rouault a ?crit?:
> Hi,
>
> It is my pleasure to announce ( 
> https://github.com/sozip/sozip-spec/blob/master/blog/01-announcement.md 
> ) the initial release of the specification ( 
> https://github.com/sozip/sozip-spec/blob/master/sozip_specification.md 
> ) for the SOZip (Seek-Optimized Zip) profile to the ZIP file format, 
> as well as its GDAL implementation.
>
> What is SOZip ?
> ----------------------
>
> A Seek-Optimized ZIP file (SOZip) is a ZIP file that contains one or 
> several Deflate-compressed files that are organized and annotated such 
> that a SOZip-aware reader can perform very fast random access (seek) 
> within a compressed file.
>
> SOZip makes it possible to access large compressed files directly from 
> a .zip file without prior decompression. It is not a new file format, 
> but a profile of the existing ZIP format, done in a fully backward 
> compatible way. ZIP readers that are non-SOZip aware can read a 
> SOZip-enabled file normally and ignore the extended features that 
> support efficient seek capability.
>
> Use cases
> --------------
>
> The SOZip specification is intended to be general purpose / not domain 
> specific. It was first developed to serve geospatial use cases, which 
> commonly have large compressed files inside of ZIP archives. In 
> particular, it makes it possible for users to read large GIS files 
> using the Shapefile, GeoPackage or FlatGeobuf formats (which have no 
> native provision for compression) compressed in .zip files without 
> prior decompression.
>
> Efficient random access and selective decompression are a requirement 
> to provide acceptable performance in many usage scenarios: spatial 
> index filtering, access to a feature by its identifier, etc.
>
> Performance
> ------------------
>
> SOZip is efficient:
>
> * The overhead of using a file from a SOZip archive, compared to using 
> it uncompressed, is of the order of 10% for common read operations.
> * Generation of a SOZip file can be much faster than regular ZIP 
> generation when using multithreading.
> * SOZip files are typically only ~ 5% larger than regular ZIPs 
> (dependent on content, and chunk size)
>
> Have a look at benchmarking results: 
> https://github.com/sozip/sozip-spec/blob/master/README.md#benchmarking
>
> Other ZIP related specification
> ------------------------------------------
>
> The SOZip GitHub organization also hosts the KeyValuePairs extra-field 
> specification ( 
> https://github.com/sozip/keyvaluepairs-spec/blob/master/zip_keyvalue_extra_field_specification.md 
> ), to be able to encode arbitrary key-value pairs of metadata 
> associated with a file within a ZIP. For example to store the 
> Content-Type of a file.
>
> How does this relate to GDAL ?
> -------------------------------------------
>
> Pull request https://github.com/OSGeo/gdal/pull/7042 has been 
> submitted with the following enhancements:
>
> *? The /vsizip/ virtual file system uses the SOZip index to perform fast
> ??? random access within a compressed SOZip-enabled file.
>
> * The Shapefile and GPKG drivers can directly generate SOZip-enabled 
> .shz/.shp.zip or .gpkg.zip files.
>
> *? Addition of the CPLAddFileInZip() C function that can compress a 
> file and add
> ??? it to an new or existing ZIP file, and enable the SOZip 
> optimization when relevant.
>
> *? The existed VSIGetFileMetadata() method can be called on a filename of
> ??? the form /vsizip/path/to/the/file.zip/path/inside/the/zip/file and
> ??? with domain = "ZIP" to get information if a SOZip index is 
> available for that file.
>
> *? The sozip 
> (https://github.com/rouault/gdal/blob/sozip/doc/source/programs/sozip.rst) 
> new command line utility
> ??? can be used to create a seek-optimized ZIP file, to append files 
> to an existing ZIP file, list the
> ??? contents of a ZIP file and display the SOZip optimization status 
> or validate a SOZip file.
>
> Best regards,
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From angus at myheat.ca  Thu Jan 26 15:13:07 2023
From: angus at myheat.ca (Angus Dickey)
Date: Thu, 26 Jan 2023 16:13:07 -0700
Subject: [gdal-dev] GDAL Overestimating Physical Memory
In-Reply-To: <e6a6f25f-4eda-cbed-caf4-a5419e57b924@spatialys.com>
References: <CABADqykJDO05X35BZsyn2BpZRoBd3_knvmrxUc-hbXDNLp_XbQ@mail.gmail.com>
 <fd02b014-b21e-a543-86fe-e7a1210df2c8@spatialys.com>
 <CABADqykmJvWbpjP2zTJWaWEoB8xyqi9yPsbD5n9GPSjN1JVrFA@mail.gmail.com>
 <e49b8fda-960e-3c48-0a4c-d84e66324ebf@spatialys.com>
 <CABADqynROKJhy2V9mxRFM=3M66X0=n5etACcnM7SuTdWOqfNUA@mail.gmail.com>
 <e6a6f25f-4eda-cbed-caf4-a5419e57b924@spatialys.com>
Message-ID: <CABADqykj2AW5VWFZArxxrigcymXyQ86t-4L6rU_nwaCxR0gO1w@mail.gmail.com>

Even,


I pulled the updated PR and it is working well in a Linux container:


$ ./get_gdal_memory
GDAL version is 3.7.0dev
GDAL thinks it has 2097152000 bytes of physical memory
GDAL thinks it has 2097152000 bytes of usable physical memory
sysinfo() thinks it has 811526475776 bytes of physical memory


Thank you for this change, it should make GDAL in LXCs much more stable.
Maybe someday sysinfo()
<https://man7.org/linux/man-pages/man2/sysinfo.2.html> will be updated
to understand cgroup v2 or a new library function will be created to make
this easier for you.


Angus

On Thu, Jan 26, 2023 at 7:52 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Angus,
>
> I've just edited the pull request to take into account MemTotal of
> /proc/meminfo. Only tested on my host Linux, but hopefully that should work
> also for your setup given the elements you've mentionned.
>
> Lauren?iu,
>
> are you 100% positive you've tested the updated version of the pull
> request? I've just given a try to running gdallimits under Docker from a
> Ubuntu 22.04 host and it successfully takes into account the /sys/fs/cgroup/memory.max
> limit
>
> Even
> Le 26/01/2023 ? 02:13, Angus Dickey a ?crit :
>
> Even,
>
> Thanks, that is some quick turn around! I imagine Proxmox
> <https://www.proxmox.com/en/> or LXD
> <https://linuxcontainers.org/lxd/introduction/> are pretty much what
> everyone uses to create linux containers. LXC is the underlying technology
> but also has a set of command line tools that can be used to create
> containers. In your case it sounds like LXD can't choose a subnet for your
> linux bridge, which is mysterious and I don't know how to fix that.
>
> I tried your update inside a container and am still seeing the problem
> where GDAL thinks it has the full host memory:
>
> $ gdalinfo --version
> GDAL 3.7.0dev, released 2023/99/99 (debug build)
> $ ./get_gdal_memory
> GDAL version is 3.7.0dev
> GDAL thinks it has 135083474944 bytes of physical memory
> GDAL thinks it has 135083474944 bytes of usable physical memory
> sysinfo() thinks it has 135083474944 bytes of physical memory
> $ free -h
>                total        used        free      shared  buff/cache
> available
> Mem:           2.0Gi       152Mi       1.1Gi       0.0Ki       755Mi
> 1.8Gi
> Swap:          256Mi          0B       256Mi
> $ cat /proc/meminfo | grep MemTotal
> MemTotal:        2048000 kB
>
> I wanted to dig a bit but am no expert in containerization and cgroup v2.
> It seems that some tools show the memory the container has (free
> <https://man7.org/linux/man-pages/man1/free.1.html>& /proc/meminfo
> <https://man7.org/linux/man-pages/man5/proc.5.html>) and others (sysinfo
> <https://man7.org/linux/man-pages/man2/sysinfo.2.html>) show the host
> memory. For cgroups v2 I see your code is trying to find the max memory
> from a specific memory.max file in /sys/fs/cgroup/. In my *containers *that
> file (actually all the memory.max files) contain the default value "max".
>
> $ find /sys/fs/cgroup -type f -name memory.max -exec sh -c "cat '{}'" \;
> max
> max
> max
> ... all max ...
> max
>
> If I try the same thing on the *host *I actually find it is set to the
> expected value.
>
> cat $ /sys/fs/cgroup/lxc/901/memory.max
> 2097152000
>
> The cgroup values on the host appear to be what is limiting the container
> memory, more rules can be added inside the container but they are still
> beholden to the host rules. I am not sure how free & /proc/memory are
> getting the correct available memory but maybe I will ask the proxmox or
> LXD people.
>
> Thanks again,
>
> Angus
>
>
> On Wed, Jan 25, 2023 at 4:49 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Angus,
>>
>> I'm not familiar with LXC. I tried to setup LXD with
>> https://linuxcontainers.org/lxd/introduction/ but it fails with a
>> mysterious "Error: Failed to create local member network "lxdbr0" in
>> project "default": Failed generating auto config: Failed to automatically
>> find an unused IPv4 subnet, manual configuration required"
>>
>> Anyway, I've attempted in https://github.com/OSGeo/gdal/pull/7124 to
>> better take into account cgroup to get memory limitation. Could you give
>> this a try?
>>
>> Even
>> Le 25/01/2023 ? 06:24, Angus Dickey a ?crit :
>>
>> Even,
>>
>>
>> Thanks for the reply, I went ahead and compiled the latest GDAL 3.6.2 on
>> Ubuntu 22.04. Unfortunately I ended up with a similar result, GDAL thinks
>> it has 755GB of RAM to work with when it only has 2GB:
>>
>>
>> $ gdalinfo --version
>> GDAL 3.6.2, released 2023/01/02 (debug build)
>>
>> $ ./get_gdal_memory
>> GDAL version is 3.6.2
>> GDAL thinks is has 811526475776 bytes of physical memory
>> GDAL thinks it has 811526475776 bytes of usable physical memory
>>
>> $ free -h
>>                total        used        free      shared  buff/cache
>> available
>> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
>>   1.8Gi
>> Swap:          256Mi          0B       256Mi
>>
>> My knowledge on the subject is limited but I think Linux containers (LXC)
>> uses cgroups and not setrlimit to limit resources, so maybe that is why the
>> new changes had no effect. To reproduce this issue you can create a
>> container using  LXC, LXD, or a hypervision like proxmox (what I am using)
>> and call CPLGetUsablePhysicalRAM().
>>
>> If there is any other info that might be helpful let me know. I might try
>> a Docker container (it also uses cgroups) and is more popular than LXC,
>> although it fulfills a different function.
>>
>> thanks,
>>
>> Angus
>>
>>
>> On Tue, Jan 24, 2023 at 5:50 PM Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> Angus,
>>>
>>> there has been a recent extra fix that landed in GDAL 3.6.2 that might
>>> possibly help: https://github.com/OSGeo/gdal/pull/6926
>>>
>>> Even
>>> Le 25/01/2023 ? 01:36, Angus Dickey a ?crit :
>>>
>>> Hi all,
>>>
>>> I am running into an issue where GDAL is overestimating the amount of
>>> physical memory it has leading to it locking up the OS by taking 100% of
>>> the memory. Here is an example program that illustrates the issue:
>>>
>>> #include <stdio.h>
>>> #include "gdal.h"
>>>
>>> int main(void) {
>>>    printf("GDAL version is %s\n", GDALVersionInfo("RELEASE_NAME"));
>>>    printf("GDAL thinks is has %lld bytes of physical memory\n",
>>> CPLGetPhysicalRAM());
>>>    printf("GDAL thinks it has %lld bytes of usable physical memory\n",
>>> CPLGetUsablePhysicalRAM());
>>>    return 0;
>>> }
>>>
>>> When this is compiled with GDAL 3.5.1 on Ubuntu 22.04 we get:
>>>
>>> $ ./get_gdal_memory
>>> GDAL version is 3.5.1
>>> GDAL thinks is has 811526475776 bytes of physical memory
>>> GDAL thinks it has 811526475776 bytes of usable physical memory
>>>
>>> Which is not consistent with the actual available memory:
>>>
>>> $ free -h
>>>                total        used        free      shared  buff/cache
>>> available
>>> Mem:           2.0Gi       148Mi       1.2Gi       0.0Ki       639Mi
>>>   1.8Gi
>>> Swap:          256Mi          0B       256Mi
>>>
>>> So GDAL thinks it has 755GB of memory but it only has 2GB, this causes
>>> issues with the raster read cache and maybe elsewhere. I suspect this is
>>> happening because it is running in a Linux container
>>> <https://linuxcontainers.org/> and GDAL is getting the total physical
>>> memory of the host, not the container. The strange thing is Linux
>>> containers use cgroups for memory restrictions and the API docs mention
>>> it was fixed in GDAL 2.4.0
>>> <https://gdal.org/api/cpl.html#_CPPv417CPLGetPhysicalRAMv> but I am
>>> still seeing the issue in 3.5.1.
>>>
>>> Any help or insight would be appreciated; I am happy to provide any
>>> additional information or testing.
>>>
>>> Thanks,
>>>
>>> Angus
>>>
>>> _______________________________________________
>>> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> -- http://www.spatialys.com
>>> My software is free, but my time generally not.
>>>
>>> -- http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230126/8e76ae18/attachment-0001.htm>

From groechenig at zt-gis.at  Thu Jan 26 21:49:41 2023
From: groechenig at zt-gis.at (=?iso-8859-1?Q?Simon_Gr=F6chenig?=)
Date: Fri, 27 Jan 2023 05:49:41 +0000
Subject: [gdal-dev] Bad GDB performance
Message-ID: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>

Hi all,

I am struggling with a bad performance at reading FileGeodatabases in QGIS. I hope, this is the place where I can find someone to help me find the bottleneck.

I have uploaded a sample dataset here: https://mega.nz/file/nnxVULyC#QcuGJEHedayIC7b1i14J0X8OBExVfhcb55DnnVtGzuc

Loading a QGIS project containing this GDB (layer Kataster/GST) results in a layer loading time of 5+ seconds according to the QGIS Debugging/Development Tools. I expect less than 1 second to load this dataset.

I appreciate any help to find if it is a GDAL or a dataset issue?

Simon


------------------------------------------------
Vermessungskanzlei Neumayr
Simon Gr?chenig - Geoinformation

[cid:image001.jpg at 01D9321B.8619E4D0]

Albin Egger-Str. 10
9900 Lienz
Tel: +43 4852-68568-31
Email: groechenig at zt-gis.at<mailto:groechenig at zt-gis.at>
Web: http://www.zt-gis.at/

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/22a66184/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1879 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/22a66184/attachment.jpg>

From karsten at terragis.net  Thu Jan 26 21:54:43 2023
From: karsten at terragis.net (karsten)
Date: Thu, 26 Jan 2023 21:54:43 -0800
Subject: [gdal-dev] clip raster to one cell at coordinates
In-Reply-To: <136FC60EC39B41949B4A0910DD74F5E0@terragispc>
References: <136FC60EC39B41949B4A0910DD74F5E0@terragispc>
Message-ID: <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>

Hi All,
 
in an application I have a user click on a map and I need to
programmatically clip a raster layer 
to the one raster cell for those coordinates at the click location. 
I was looking e.g. at https://gdal.org/programs/gdal_rasterize.html to run
as a command 
line tool, but so far could not figure out if I can some can "feed" that a
vector point to the tool as an input
without first writing a shape file with the point onto disk. 

Does somebody have any pointers to a command line tool (or a python example)
I could use to achieve this ? 
 
Thanks 
Karsten
 
Karsten Vennemann
Principal

Terra GIS LTD
2119 Boyer Ave E 
Seattle, WA  98112
USA 
 <http://www.terragis.net/> www.terragis.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230126/5b9d5b7e/attachment.htm>

From mdsumner at gmail.com  Fri Jan 27 00:01:24 2023
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 27 Jan 2023 19:01:24 +1100
Subject: [gdal-dev] clip raster to one cell at coordinates
In-Reply-To: <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>
References: <136FC60EC39B41949B4A0910DD74F5E0@terragispc>
 <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>
Message-ID: <CAAcGz99Wznrmm68w20UBGtmKdSUaBd_0=L4fn1P3KjWFrDkHUA@mail.gmail.com>

Hi Karsten,

An option is to run gdallocationinfo, get the col (P) and row (L) value and
then feed that into

gdal_translate -srcwin P L col -outsize 1 1  in.tif out.tif ##I think
that's right

You otherwise have to do the "grid logic", which (while easy ...) I'd
rather like to see exposed explicitly in GDAL as functionality and I'm
exploring this in various ways atm.  (I think you can't use -projwin as it
seems to need at least a half pixel width and height to count as non zero
so it's still a bit tricky to get the right values).

Cheers, Mike


On Fri, Jan 27, 2023 at 5:01 PM karsten <karsten at terragis.net> wrote:

> Hi All,
>
> in an application I have a user click on a map and I need to
> programmatically clip a raster layer
> to the one raster cell for those coordinates at the click location.
> I was looking e.g. at https://gdal.org/programs/gdal_rasterize.html to
> run as a command
> line tool, but so far could not figure out if I can some can "feed" that a
> vector point to the tool as an input
> without first writing a shape file with the point onto disk.
>
> Does somebody have any pointers to a command line tool (or a python
> example) I could use to achieve this ?
>
> Thanks
> Karsten
>
> Karsten Vennemann
> Principal
>
> Terra GIS LTD
> 2119 Boyer Ave E
> Seattle, WA  98112
> USA
> www.terragis.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/ce82ef1c/attachment-0001.htm>

From even.rouault at spatialys.com  Fri Jan 27 04:37:53 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2023 13:37:53 +0100
Subject: [gdal-dev] Bad GDB performance
In-Reply-To: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
References: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
Message-ID: <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>

Hi Simon,

fix queued in https://github.com/OSGeo/gdal/pull/7131

Even

Le 27/01/2023 ? 06:49, Simon Gr?chenig a ?crit?:
>
> Hi all,
>
> I am struggling with a bad performance at reading FileGeodatabases in 
> QGIS. I hope, this is the place where I can find someone to help me 
> find the bottleneck.
>
> I have uploaded a sample dataset here: 
> https://mega.nz/file/nnxVULyC#QcuGJEHedayIC7b1i14J0X8OBExVfhcb55DnnVtGzuc
>
> Loading a QGIS project containing this GDB (layer Kataster/GST) 
> results in a layer loading time of 5+ seconds according to the QGIS 
> Debugging/Development Tools. I expect less than 1 second to load this 
> dataset.
>
> I appreciate any help to find if it is a GDAL or a dataset issue?
>
> Simon
>
> ------------------------------------------------
>
> Vermessungskanzlei Neumayr
>
> Simon Gr?chenig - Geoinformation
>
> Albin Egger-Str. 10
>
> 9900 Lienz
>
> Tel: +43 4852-68568-31
>
> Email: groechenig at zt-gis.at <mailto:groechenig at zt-gis.at>
>
> Web: http://www.zt-gis.at/ <http://www.zt-gis.at/>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/2f4d98ce/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1879 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/2f4d98ce/attachment.jpg>

From alansnow21 at gmail.com  Fri Jan 27 05:19:09 2023
From: alansnow21 at gmail.com (Alan Snow)
Date: Fri, 27 Jan 2023 07:19:09 -0600
Subject: [gdal-dev] clip raster to one cell at coordinates
In-Reply-To: <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>
References: <136FC60EC39B41949B4A0910DD74F5E0@terragispc>
 <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>
Message-ID: <CAGybdFSv8hF+Bgt=2juaw7y9QU=s4eeK6OaDodzFbqHneHKbhQ@mail.gmail.com>

This example may be helpful:
https://gis.stackexchange.com/questions/358036/extracting-data-from-a-raster/358058

On Fri, Jan 27, 2023, 12:00 AM karsten <karsten at terragis.net> wrote:

> Hi All,
>
> in an application I have a user click on a map and I need to
> programmatically clip a raster layer
> to the one raster cell for those coordinates at the click location.
> I was looking e.g. at https://gdal.org/programs/gdal_rasterize.html to
> run as a command
> line tool, but so far could not figure out if I can some can "feed" that a
> vector point to the tool as an input
> without first writing a shape file with the point onto disk.
>
> Does somebody have any pointers to a command line tool (or a python
> example) I could use to achieve this ?
>
> Thanks
> Karsten
>
> Karsten Vennemann
> Principal
>
> Terra GIS LTD
> 2119 Boyer Ave E
> Seattle, WA  98112
> USA
> www.terragis.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/12be57b7/attachment.htm>

From groechenig at zt-gis.at  Fri Jan 27 05:35:36 2023
From: groechenig at zt-gis.at (=?utf-8?B?U2ltb24gR3LDtmNoZW5pZw==?=)
Date: Fri, 27 Jan 2023 13:35:36 +0000
Subject: [gdal-dev] Bad GDB performance
In-Reply-To: <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>
References: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>
Message-ID: <DU0P251MB06736CC2031BE24726D2BF828ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>

Hi Even,

great, thank you!

Is the GDB itself fine? Or is there something I can do to fix the database?

Simon


Von: Even Rouault <even.rouault at spatialys.com>
Gesendet: Freitag, 27. J?nner 2023 13:38
An: Simon Gr?chenig <groechenig at zt-gis.at>; gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Bad GDB performance


Hi Simon,

fix queued in https://github.com/OSGeo/gdal/pull/7131

Even
Le 27/01/2023 ? 06:49, Simon Gr?chenig a ?crit :
Hi all,

I am struggling with a bad performance at reading FileGeodatabases in QGIS. I hope, this is the place where I can find someone to help me find the bottleneck.

I have uploaded a sample dataset here: https://mega.nz/file/nnxVULyC#QcuGJEHedayIC7b1i14J0X8OBExVfhcb55DnnVtGzuc

Loading a QGIS project containing this GDB (layer Kataster/GST) results in a layer loading time of 5+ seconds according to the QGIS Debugging/Development Tools. I expect less than 1 second to load this dataset.

I appreciate any help to find if it is a GDAL or a dataset issue?

Simon


------------------------------------------------
Vermessungskanzlei Neumayr
Simon Gr?chenig - Geoinformation

[cid:image001.jpg at 01D9325C.9C62F010]

Albin Egger-Str. 10
9900 Lienz
Tel: +43 4852-68568-31
Email: groechenig at zt-gis.at<mailto:groechenig at zt-gis.at>
Web: http://www.zt-gis.at/




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/095ba251/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1879 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/095ba251/attachment-0001.jpg>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jan 27 06:07:14 2023
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 27 Jan 2023 14:07:14 +0000
Subject: [gdal-dev] clip raster to one cell at coordinates
In-Reply-To: <CAGybdFSv8hF+Bgt=2juaw7y9QU=s4eeK6OaDodzFbqHneHKbhQ@mail.gmail.com>
References: <136FC60EC39B41949B4A0910DD74F5E0@terragispc>
 <5E85A3A7A52B4E6EAC6EA3351831D8B1@terragispc>
 <CAGybdFSv8hF+Bgt=2juaw7y9QU=s4eeK6OaDodzFbqHneHKbhQ@mail.gmail.com>
Message-ID: <AM0PR09MB32198945DC66BEB2811878E4FDCC9@AM0PR09MB3219.eurprd09.prod.outlook.com>

Hi,

There is also a brand new option to query pixel values with ogrinfo (sic!) by using SQL function "gdal_get_pixel_value". See usage example and some discussion https://lists.osgeo.org/pipermail/gdal-dev/2023-January/056759.html. Of course the function can be reached without ogrinfo from other code.

-Jukka Rahkonen-

L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Puolesta Alan Snow
L?hetetty: perjantai 27. tammikuuta 2023 15.19
Vastaanottaja: karsten <karsten at terragis.net>
Kopio: gdal dev <gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] clip raster to one cell at coordinates

This example may be helpful: https://gis.stackexchange.com/questions/358036/extracting-data-from-a-raster/358058<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F358036%2Fextracting-data-from-a-raster%2F358058&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C85a22789f1314481619808db00692763%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638104223860873847%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=zHbA%2Bz0krbTg16Xro6TPqZAZfSqNm7ah9GuH99n7m0c%3D&reserved=0>

On Fri, Jan 27, 2023, 12:00 AM karsten <karsten at terragis.net<mailto:karsten at terragis.net>> wrote:
Hi All,

in an application I have a user click on a map and I need to programmatically clip a raster layer
to the one raster cell for those coordinates at the click location.
I was looking e.g. at https://gdal.org/programs/gdal_rasterize.html<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgdal.org%2Fprograms%2Fgdal_rasterize.html&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C85a22789f1314481619808db00692763%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638104223861030112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=C3%2Fwd85eQsvtguEBYnm24gwmpgjo8Ohuetmetn0Sx%2Fw%3D&reserved=0> to run as a command
line tool, but so far could not figure out if I can some can "feed" that a vector point to the tool as an input
without first writing a shape file with the point onto disk.

Does somebody have any pointers to a command line tool (or a python example) I could use to achieve this ?

Thanks
Karsten

Karsten Vennemann
Principal

Terra GIS LTD
2119 Boyer Ave E
Seattle, WA  98112
USA
www.terragis.net<https://eur06.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.terragis.net%2F&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C85a22789f1314481619808db00692763%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638104223861030112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=U59b7t3bd5QtQe%2B%2FA%2FXkw15Y7du%2B%2Fy5m4YJnclBbJ%2F0%3D&reserved=0>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://eur06.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=05%7C01%7Cjukka.rahkonen%40maanmittauslaitos.fi%7C85a22789f1314481619808db00692763%7Cc4f8a63255804a1c92371d5a571b71fa%7C0%7C1%7C638104223861030112%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000%7C%7C%7C&sdata=%2BuSDGL4mSlw%2Bs%2BD0XmImGT%2BKjJGG%2Flokh%2F99qjnr8A0%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/84b4ed8f/attachment.htm>

From even.rouault at spatialys.com  Fri Jan 27 06:22:33 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2023 15:22:33 +0100
Subject: [gdal-dev] Bad GDB performance
In-Reply-To: <DU0P251MB0673ACED0AED8FC40009F3338ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
References: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>
 <DU0P251MB0673ACED0AED8FC40009F3338ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
Message-ID: <0467809b-e488-1166-9bfa-6892e85fd5fc@spatialys.com>

Hi Simon,

the GDB is fine. GDAL struggles because it tries to identify the CRS 
definition from the GDB ( 
'PROJCS["GK_31",GEOGCS["GCS_MGI",DATUM["D_MGI",SPHEROID["Bessel_1841",6377397.155,299.1528128]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-5000000.0],PARAMETER["Central_Meridian",13.3333333333333],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]' 
) with a known one (EPSG, ESRI) in PROJ CRS database. But there is no 
match for the GK_31 name so it has to go to slower methods.

Do you know how that CRS was attributed to the layers ? (through some 
choice in a list of predefined CRS ? no idea how Arc stuff works)

I believe this CRS should be identified as EPSG:31255, which in the 
current ESRI CRS database, is called MGI_Austria_GK_Central:

PROJCS["MGI_Austria_GK_Central",GEOGCS["GCS_MGI",DATUM["D_MGI",SPHEROID["Bessel_1841",6377397.155,299.1528128]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-5000000.0],PARAMETER["Central_Meridian",13.3333333333333],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]

Which version of ArcMap / ArcGIS was used to produce this GDB ?

Even

Le 27/01/2023 ? 14:34, Simon Gr?chenig a ?crit?:
>
> Hi Even,
>
> great, thank you!
>
> Is the GDB itself fine? Or is there something I can do to fix the 
> database?
>
> Simon
>
> *Von:*Even Rouault <even.rouault at spatialys.com>
> *Gesendet:* Freitag, 27. J?nner 2023 13:38
> *An:* Simon Gr?chenig <groechenig at zt-gis.at>; gdal-dev at lists.osgeo.org
> *Betreff:* Re: [gdal-dev] Bad GDB performance
>
> Hi Simon,
>
> fix queued in https://github.com/OSGeo/gdal/pull/7131
>
> Even
>
> Le 27/01/2023 ? 06:49, Simon Gr?chenig a ?crit?:
>
>     Hi all,
>
>     I am struggling with a bad performance at reading FileGeodatabases
>     in QGIS. I hope, this is the place where I can find someone to
>     help me find the bottleneck.
>
>     I have uploaded a sample dataset here:
>     https://mega.nz/file/nnxVULyC#QcuGJEHedayIC7b1i14J0X8OBExVfhcb55DnnVtGzuc
>
>     Loading a QGIS project containing this GDB (layer Kataster/GST)
>     results in a layer loading time of 5+ seconds according to the
>     QGIS Debugging/Development Tools. I expect less than 1 second to
>     load this dataset.
>
>     I appreciate any help to find if it is a GDAL or a dataset issue?
>
>     Simon
>
>     ------------------------------------------------
>
>     Vermessungskanzlei Neumayr
>
>     Simon Gr?chenig - Geoinformation
>
>     Albin Egger-Str. 10
>
>     9900 Lienz
>
>     Tel: +43 4852-68568-31
>
>     Email: groechenig at zt-gis.at
>
>     Web: http://www.zt-gis.at/
>
>
>
>     _______________________________________________
>
>     gdal-dev mailing list
>
>     gdal-dev at lists.osgeo.org
>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/8e5079f6/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1879 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/8e5079f6/attachment-0001.jpg>

From groechenig at zt-gis.at  Fri Jan 27 06:32:34 2023
From: groechenig at zt-gis.at (=?utf-8?B?U2ltb24gR3LDtmNoZW5pZw==?=)
Date: Fri, 27 Jan 2023 14:32:34 +0000
Subject: [gdal-dev] Bad GDB performance
In-Reply-To: <0467809b-e488-1166-9bfa-6892e85fd5fc@spatialys.com>
References: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>
 <DU0P251MB0673ACED0AED8FC40009F3338ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <0467809b-e488-1166-9bfa-6892e85fd5fc@spatialys.com>
Message-ID: <DU0P251MB06730CC0A4393627E73F101D8ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>

Hi,

ok, thanks.

> Do you know how that CRS was attributed to the layers ? (through some choice in a list of predefined CRS ? no idea how Arc stuff works)

No, a third party tool created the layer. If necessary I can contact the developer.

> I believe this CRS should be identified as EPSG:31255

Yes, that is the correct code.

> Which version of ArcMap / ArcGIS was used to produce this GDB ?
ArcGIS Desktop 10.8.1

Simon


Von: Even Rouault <even.rouault at spatialys.com>
Gesendet: Freitag, 27. J?nner 2023 15:23
An: Simon Gr?chenig <groechenig at zt-gis.at>
Cc: gdal-dev at lists.osgeo.org
Betreff: Re: AW: [gdal-dev] Bad GDB performance


Hi Simon,

the GDB is fine. GDAL struggles because it tries to identify the CRS definition from the GDB ( 'PROJCS["GK_31",GEOGCS["GCS_MGI",DATUM["D_MGI",SPHEROID["Bessel_1841",6377397.155,299.1528128]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-5000000.0],PARAMETER["Central_Meridian",13.3333333333333],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]' ) with a known one (EPSG, ESRI) in PROJ CRS database. But there is no match for the GK_31 name so it has to go to slower methods.

Do you know how that CRS was attributed to the layers ? (through some choice in a list of predefined CRS ? no idea how Arc stuff works)

I believe this CRS should be identified as EPSG:31255, which in the current ESRI CRS database, is called MGI_Austria_GK_Central:

PROJCS["MGI_Austria_GK_Central",GEOGCS["GCS_MGI",DATUM["D_MGI",SPHEROID["Bessel_1841",6377397.155,299.1528128]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-5000000.0],PARAMETER["Central_Meridian",13.3333333333333],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]

Which version of ArcMap / ArcGIS was used to produce this GDB ?

Even
Le 27/01/2023 ? 14:34, Simon Gr?chenig a ?crit :
Hi Even,

great, thank you!

Is the GDB itself fine? Or is there something I can do to fix the database?

Simon


Von: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Gesendet: Freitag, 27. J?nner 2023 13:38
An: Simon Gr?chenig <groechenig at zt-gis.at><mailto:groechenig at zt-gis.at>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Betreff: Re: [gdal-dev] Bad GDB performance


Hi Simon,

fix queued in https://github.com/OSGeo/gdal/pull/7131

Even
Le 27/01/2023 ? 06:49, Simon Gr?chenig a ?crit :
Hi all,

I am struggling with a bad performance at reading FileGeodatabases in QGIS. I hope, this is the place where I can find someone to help me find the bottleneck.

I have uploaded a sample dataset here: https://mega.nz/file/nnxVULyC#QcuGJEHedayIC7b1i14J0X8OBExVfhcb55DnnVtGzuc

Loading a QGIS project containing this GDB (layer Kataster/GST) results in a layer loading time of 5+ seconds according to the QGIS Debugging/Development Tools. I expect less than 1 second to load this dataset.

I appreciate any help to find if it is a GDAL or a dataset issue?

Simon


------------------------------------------------
Vermessungskanzlei Neumayr
Simon Gr?chenig - Geoinformation

[cid:image001.jpg at 01D93264.4D30EA30]

Albin Egger-Str. 10
9900 Lienz
Tel: +43 4852-68568-31
Email: groechenig at zt-gis.at<mailto:groechenig at zt-gis.at>
Web: http://www.zt-gis.at/





_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/938104dc/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 1879 bytes
Desc: image001.jpg
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/938104dc/attachment-0001.jpg>

From even.rouault at spatialys.com  Fri Jan 27 06:35:39 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 27 Jan 2023 15:35:39 +0100
Subject: [gdal-dev] Bad GDB performance
In-Reply-To: <DU0P251MB06730CC0A4393627E73F101D8ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
References: <DU0P251MB0673322522D4A02573BC9A548ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <f00dca9a-3c05-3473-ab19-a10e91411965@spatialys.com>
 <DU0P251MB0673ACED0AED8FC40009F3338ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
 <0467809b-e488-1166-9bfa-6892e85fd5fc@spatialys.com>
 <DU0P251MB06730CC0A4393627E73F101D8ECC9@DU0P251MB0673.EURP251.PROD.OUTLOOK.COM>
Message-ID: <0c2efe38-447b-72c3-03fd-c5de0c297c96@spatialys.com>

> No, a third party tool created the layer. If necessary I can contact 
> the developer.
>
That could indeed be interesting to know how they set the CRS to the 
layer. From different bug reports, I've the feeling that there are 
different aliases in the ESRI CRS world that aren't fully captured in 
the data publicly available in 
https://github.com/Esri/projection-engine-db-doc/


-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230127/79a60177/attachment.htm>

From aryan.landi at trelleborg.com  Mon Jan 30 00:43:39 2023
From: aryan.landi at trelleborg.com (Aryan Landi)
Date: Mon, 30 Jan 2023 08:43:39 +0000
Subject: [gdal-dev] Reading s57 charts with GDAL
Message-ID: <73FEAC94-0AA1-478F-B205-880FF0DE5631@trelleborg.com>

Hi all,

I recently wrote about the difficulty of reading an s57 chart with GDAL following the standard example, as it seems that GDAL cannot find the s57 driver (the gdalinfo command also returns an error). I am curious to know, if this is a general problem, or if it is only my local GDAL installation. The example I try to run is the following:

#include "ogrsf_frmts.h"

int main()

{
GDALAllRegister();

GDALDataset *poDS;

poDS = (GDALDataset*) GDALOpenEx( "US5LA26M.000", GDAL_OF_VECTOR, NULL, NULL, NULL );
if( poDS == NULL )
{
printf( "Open failed.\n" );
exit( 1 );
}
}
.

When I run this, poDS is NULL and the program exits after printing the error message.
It happens on all the different s57 charts I have used. Charts are available from NOAA at https://charts.noaa.gov/ENCs/ENCs.shtml. It would be great to see, if someone can replicate this bug.

Best regards,

Aryan.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/1b58c5da/attachment.htm>

From bradh at frogmouth.net  Mon Jan 30 02:46:16 2023
From: bradh at frogmouth.net (bradh at frogmouth.net)
Date: Mon, 30 Jan 2023 21:46:16 +1100
Subject: [gdal-dev] Reading s57 charts with GDAL
In-Reply-To: <73FEAC94-0AA1-478F-B205-880FF0DE5631@trelleborg.com>
Message-ID: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/4b6f0758/attachment.htm>

From aryan.landi at trelleborg.com  Mon Jan 30 03:31:47 2023
From: aryan.landi at trelleborg.com (Aryan Landi)
Date: Mon, 30 Jan 2023 11:31:47 +0000
Subject: [gdal-dev] Reading s57 charts with GDAL
In-Reply-To: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>
References: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>
Message-ID: <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>

Hi again,

Not sure what you mean by ?support files?. The command line tool returns:

ERROR 4: `US5LA26M.000' not recognized as a supported file format.
gdalinfo failed - unable to open 'US5LA26M.000


Den 30. jan. 2023 kl. 11.46 skrev bradh at frogmouth.net<mailto:bradh at frogmouth.net>:

Do you have the two support files in the same directory?

What errors do you get with the command line tool?



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/93994a61/attachment-0001.htm>

From even.rouault at spatialys.com  Mon Jan 30 04:08:39 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 30 Jan 2023 13:08:39 +0100
Subject: [gdal-dev] Motion: adopt RFC 91: GDALDataset::Close() method
In-Reply-To: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
References: <e5d1eef8-5fa7-d11e-2ea5-4d8c1a274cc5@spatialys.com>
Message-ID: <8e62ce13-ad54-f0be-2e69-6dc772de6673@spatialys.com>

Hi,

I declare this motion passed with +1 from PSC members KurtS, MateuszL 
and me, and +0 from JukkaR

Even

Le 25/01/2023 ? 12:56, Even Rouault a ?crit?:
> Hi,
>
> Motion: adopt RFC 91: GDALDataset::Close() method
>
> https://github.com/OSGeo/gdal/pull/7108
>
> Starting with my +1,
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andreas.oxenstierna at t-kartor.com  Mon Jan 30 04:42:54 2023
From: andreas.oxenstierna at t-kartor.com (Andreas Oxenstierna)
Date: Mon, 30 Jan 2023 12:42:54 +0000
Subject: [gdal-dev] Reading s57 charts with GDAL
In-Reply-To: <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>
References: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>
 <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>
Message-ID: <eb3538e6-43c6-4f6c-8679-54e661b0a2fb@Spark>

Hi

S57 is a vector format so you need to use ogr

Check that
ogrinfo --formats
reports:
  S57 -vector- (rw+v): IHO S-57 (ENC)

Best Regards / V?nliga h?lsningar

Andreas Oxenstierna
Senior Strategic Advisor

+46 733 206 831<tel:%20+46733206831>
andreas.oxenstierna at t-kartor.com<mailto:andreas.oxenstierna at t-kartor.com>
connect on Linkedin<https://www.linkedin.com/in/andreas-oxenstierna-52876325/>

[cid:BBA78FFF71DD4E84AFCC262661B2FB86]
T-Kartor Geospatial AB
Olof Mohlins v?g 12
291 62 Kristianstad

<www.t-kartor.com>
t-kartor.com<www.t-kartor.com>
+46 44 206 800<tel:%20+4644206800>
info at t-kartor.com<mailto:info at t-kartor.com>
This e-mail is private and confidential between the sender and the addressee. In the event of misdirection, the recipient is prohibited from using, copying or disseminating it or any information in it. Please notify the above of any such misdirection.
On 30 Jan 2023, 12:32 +0100, Aryan Landi <aryan.landi at trelleborg.com>, wrote:
You don't often get email from aryan.landi at trelleborg.com. Learn why this is important<https://aka.ms/LearnAboutSenderIdentification>
Hi again,

Not sure what you mean by ?support files?. The command line tool returns:

ERROR 4: `US5LA26M.000' not recognized as a supported file format.
gdalinfo failed - unable to open 'US5LA26M.000


Den 30. jan. 2023 kl. 11.46 skrev bradh at frogmouth.net<mailto:bradh at frogmouth.net>:

Do you have the two support files in the same directory?

What errors do you get with the command line tool?



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/cc6f0e33/attachment.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: BBA78FFF71DD4E84AFCC262661B2FB86.png
Type: image/png
Size: 3748 bytes
Desc: BBA78FFF71DD4E84AFCC262661B2FB86.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/cc6f0e33/attachment.png>

From aryan.landi at trelleborg.com  Mon Jan 30 07:00:06 2023
From: aryan.landi at trelleborg.com (Aryan Landi)
Date: Mon, 30 Jan 2023 15:00:06 +0000
Subject: [gdal-dev] Reading s57 charts with GDAL
In-Reply-To: <eb3538e6-43c6-4f6c-8679-54e661b0a2fb@Spark>
References: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>
 <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>
 <eb3538e6-43c6-4f6c-8679-54e661b0a2fb@Spark>
Message-ID: <3F94268A-FC94-44B8-B19D-5140EAC25EAE@trelleborg.com>

Hi again.

Yes, ogrinfo lists the correct information. But my understanding was that GDAL works both with raster and vector, and thus exposes the org drivers.
Should I then use ogr directly instead of through GDAL?

Den 30. jan. 2023 kl. 13.42 skrev Andreas Oxenstierna <andreas.oxenstierna at t-kartor.com<mailto:andreas.oxenstierna at t-kartor.com>>:

Hi

S57 is a vector format so you need to use ogr

Check that
ogrinfo --formats
reports:
  S57 -vector- (rw+v): IHO S-57 (ENC)

Best Regards / V?nliga h?lsningar

Andreas Oxenstierna
Senior Strategic Advisor

+46 733 206 831<tel:%20+46733206831>
andreas.oxenstierna at t-kartor.com<mailto:andreas.oxenstierna at t-kartor.com>
connect on Linkedin<https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=https%3a%2f%2fwww.linkedin.com%2fin%2fandreas%2doxenstierna%2d52876325%2f&umid=0df62896-8d17-451f-9cd9-35f0a552b53b&auth=b6670b9751c5c90ededae23711566d84a7ddb070-0b169618e546f2449347b11dad7b17de00f9776b>

<BBA78FFF71DD4E84AFCC262661B2FB86.png>
T-Kartor Geospatial AB
Olof Mohlins v?g 12
291 62 Kristianstad

<https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=www.t%2dkartor.com&umid=0df62896-8d17-451f-9cd9-35f0a552b53b&auth=b6670b9751c5c90ededae23711566d84a7ddb070-f9b1fabc496e2119c028481fdc9b5a571aaa864a>
t-kartor.com<https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=www.t%2dkartor.com&umid=0df62896-8d17-451f-9cd9-35f0a552b53b&auth=b6670b9751c5c90ededae23711566d84a7ddb070-f9b1fabc496e2119c028481fdc9b5a571aaa864a>
+46 44 206 800<tel:%20+4644206800>
info at t-kartor.com<mailto:info at t-kartor.com>
This e-mail is private and confidential between the sender and the addressee. In the event of misdirection, the recipient is prohibited from using, copying or disseminating it or any information in it. Please notify the above of any such misdirection.
On 30 Jan 2023, 12:32 +0100, Aryan Landi <aryan.landi at trelleborg.com<mailto:aryan.landi at trelleborg.com>>, wrote:
You don't often get email from aryan.landi at trelleborg.com<mailto:aryan.landi at trelleborg.com>. Learn why this is important<https://ddec1-0-en-ctp.trendmicro.com/wis/clicktime/v1/query?url=https%3a%2f%2faka.ms%2fLearnAboutSenderIdentification&umid=0df62896-8d17-451f-9cd9-35f0a552b53b&auth=b6670b9751c5c90ededae23711566d84a7ddb070-afb2c5798043424a735c2d0d69a831f74877fb8a>
Hi again,

Not sure what you mean by ?support files?. The command line tool returns:

ERROR 4: `US5LA26M.000' not recognized as a supported file format.
gdalinfo failed - unable to open 'US5LA26M.000


Den 30. jan. 2023 kl. 11.46 skrev bradh at frogmouth.net<mailto:bradh at frogmouth.net>:

Do you have the two support files in the same directory?

What errors do you get with the command line tool?




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/d54de957/attachment-0001.htm>

From louis-philippe.rousseaulambert at ec.gc.ca  Mon Jan 30 07:54:43 2023
From: louis-philippe.rousseaulambert at ec.gc.ca (Rousseau Lambert,Louis-Philippe (ECCC))
Date: Mon, 30 Jan 2023 10:54:43 -0500
Subject: [gdal-dev] Metadata keys in upper or lower case ?
Message-ID: <7681d312-ff48-a9ce-05b7-e4b41e56d2ae@ec.gc.ca>

Hi everyone !

I would like to know if there is a rule or a best practice for a raster 
file's metadata key to be written in upper or lower case ?

 ?I read https://gdal.org/user/raster_data_model.html#metadata and saw 
that "/The names are required to be well behaved tokens (no spaces, or 
odd characters//)./" but I didn't read anything about upper vs lower 
cases. While I see examples of both (upper and lower case) in different 
valid files, I would like to know if a documented recommendation exists ?

Thanks

LP
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/42c3e3f4/attachment.htm>

From even.rouault at spatialys.com  Mon Jan 30 08:33:56 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 30 Jan 2023 17:33:56 +0100
Subject: [gdal-dev] Metadata keys in upper or lower case ?
In-Reply-To: <7681d312-ff48-a9ce-05b7-e4b41e56d2ae@ec.gc.ca>
References: <7681d312-ff48-a9ce-05b7-e4b41e56d2ae@ec.gc.ca>
Message-ID: <6c862e58-d1fd-cce5-b454-f3b64ae87832@spatialys.com>

Louis-Philippe,

there's no recommendation. Each format or community within a format may 
have different practices.

Some formats may accept some odd characters (but definitely not '=', as 
key/value pairs are stored as "key=value" strings internally), but 
keeping to alphanumeric + underscore is the best way to be universally 
accepted.

That said you'd better not use several metadata keys that only defer by 
case, otherwise you're going to confuse a lot of places in GDAL as 
comparisons are done in a case insensitive way. I mean: "foo" and "BAR" 
are fine within the same metadata. But not "foo", "Foo" and "FOO".

Even

Le 30/01/2023 ? 16:54, Rousseau Lambert,Louis-Philippe (ECCC) a ?crit?:
>
> Hi everyone !
>
> I would like to know if there is a rule or a best practice for a 
> raster file's metadata key to be written in upper or lower case ?
>
> ?I read https://gdal.org/user/raster_data_model.html#metadata and saw 
> that "/The names are required to be well behaved tokens (no spaces, or 
> odd characters//)./" but I didn't read anything about upper vs lower 
> cases. While I see examples of both (upper and lower case) in 
> different valid files, I would like to know if a documented 
> recommendation exists ?
>
> Thanks
>
> LP
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230130/539dc1ea/attachment.htm>

From bradh at frogmouth.net  Mon Jan 30 22:36:26 2023
From: bradh at frogmouth.net (Brad Hards)
Date: Tue, 31 Jan 2023 17:36:26 +1100
Subject: [gdal-dev] Reading s57 charts with GDAL
In-Reply-To: <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>
References: <52f28896-3923-459b-ac0d-83c29c466d0f@email.android.com>
 <285001B1-35B4-4DBB-8F78-73B574177F66@trelleborg.com>
Message-ID: <5643533.DvuYhMxLoT@audax>

On Monday, 30 January 2023 10:31:47 PM AEDT Aryan Landi wrote:
> Hi again,
> 
> Not sure what you mean by ?support files?.
There are two support files that translate vectors - see the documentation.

https://gdal.org/drivers/vector/s57.html

> The command line tool returns:
> 
> ERROR 4: `US5LA26M.000' not recognized as a supported file format.
> gdalinfo failed - unable to open 'US5LA26M.000
As others have pointed out, that is expected.

I can say that:

#include "ogrsf_frmts.h"

int main()

{
  GDALAllRegister();

  GDALDataset *poDS;

  poDS = (GDALDataset *)GDALOpenEx("ENC_ROOT/US2EC03M/US2EC03M.000",
                                   GDAL_OF_VECTOR, NULL, NULL, NULL);
  if (poDS == NULL) {
    printf("Open failed.\n");
    exit(1);
  }
  printf("loaded\n");
}


results in "loaded" on my machine.



From even.rouault at spatialys.com  Tue Jan 31 03:27:05 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2023 12:27:05 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only geometries
Message-ID: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>

Hi,

Please find for review "RFC 92 text: WKB Only geometries" at 
https://github.com/OSGeo/gdal/pull/7149

This RFC provides shortcuts to avoid instantiation of full OGRGeometry 
instances
in scenarios where only the WKB representation of geometries is needed. The
hope is to save CPU time.

This is something I wanted to at least experiment. I've mixed feelings 
if it's something we actually want to adopt.

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From sethg at geographika.co.uk  Tue Jan 31 05:20:03 2023
From: sethg at geographika.co.uk (Seth G)
Date: Tue, 31 Jan 2023 14:20:03 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
Message-ID: <93c4e08d-b73c-4329-b53a-2d1de5dad662@app.fastmail.com>

Hi Even,

Is it correct to say the workflow for OGR layer in MapServer is similar to that of QGIS?
OGR features / geometries are loaded, and then converted into MapServer shapes using the OGRGeometry function [1]. Would using WKB here be any more performant?
The PostGIS driver already has code to convert from WKB to shape [2] which could be repurposed. 

Seth

[1] https://github.com/MapServer/MapServer/blob/f3f05d4cf30af615d5f443a1c47c20b6117e52cb/mapogr.cpp#L250
[2] https://github.com/MapServer/MapServer/blob/f3f05d4cf30af615d5f443a1c47c20b6117e52cb/mappostgis.cpp#L663

--
web:https://geographika.net
twitter: @geographika

On Tue, Jan 31, 2023, at 12:27 PM, Even Rouault wrote:
> Hi,
>
> Please find for review "RFC 92 text: WKB Only geometries" at 
> https://github.com/OSGeo/gdal/pull/7149
>
> This RFC provides shortcuts to avoid instantiation of full OGRGeometry 
> instances
> in scenarios where only the WKB representation of geometries is needed. The
> hope is to save CPU time.
>
> This is something I wanted to at least experiment. I've mixed feelings 
> if it's something we actually want to adopt.
>
> Even
>
> -- 
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue Jan 31 08:08:18 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2023 17:08:18 +0100
Subject: [gdal-dev] Call for discussion on RFC 92 text: WKB Only
 geometries
In-Reply-To: <93c4e08d-b73c-4329-b53a-2d1de5dad662@app.fastmail.com>
References: <9dced7b2-f806-9309-d6f1-f2b02a18f656@spatialys.com>
 <93c4e08d-b73c-4329-b53a-2d1de5dad662@app.fastmail.com>
Message-ID: <62d04b32-71a0-5e96-6a0e-24c7bc372468@spatialys.com>

Hi Seth,

Le 31/01/2023 ? 14:20, Seth G a ?crit?:
> Hi Even,
>
> Is it correct to say the workflow for OGR layer in MapServer is similar to that of QGIS?
Not quite, because currently MapServer as you point out use 
"materialized geometries" to get the points, the number of rings in a 
polygons, etc.
> Would using WKB here be any more performant?
In the general case where the geometries in the datasource aren't 
encoding using WKB, probably not because you would have to pay for the 
WKB serialization & deserialization. It could, perhaps, help, a bit, for 
GeoPackage. To get the best performance, you'd need to have 2 code 
paths: one for OGR materialized geometry (the current one), and another 
one for OGR WKBOnly geometries.
> The PostGIS driver already has code to convert from WKB to shape [2] which could be repurposed.

Yes, if that was done, reusing the WKB -> msShapeObj converter from the 
PostGIS connector would be the way to go

Even

>
> Seth
>
> [1] https://github.com/MapServer/MapServer/blob/f3f05d4cf30af615d5f443a1c47c20b6117e52cb/mapogr.cpp#L250
> [2] https://github.com/MapServer/MapServer/blob/f3f05d4cf30af615d5f443a1c47c20b6117e52cb/mappostgis.cpp#L663
>
> --
> web:https://geographika.net
> twitter: @geographika
>
> On Tue, Jan 31, 2023, at 12:27 PM, Even Rouault wrote:
>> Hi,
>>
>> Please find for review "RFC 92 text: WKB Only geometries" at
>> https://github.com/OSGeo/gdal/pull/7149
>>
>> This RFC provides shortcuts to avoid instantiation of full OGRGeometry
>> instances
>> in scenarios where only the WKB representation of geometries is needed. The
>> hope is to save CPU time.
>>
>> This is something I wanted to at least experiment. I've mixed feelings
>> if it's something we actually want to adopt.
>>
>> Even
>>
>> -- 
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From L.Kladivova at seznam.cz  Tue Jan 31 10:42:20 2023
From: L.Kladivova at seznam.cz (=?utf-8?q?Linda_Kladivov=C3=A1?=)
Date: Tue, 31 Jan 2023 19:42:20 +0100 (CET)
Subject: [gdal-dev] Updating the MVT tile set using ogr2ogr
Message-ID: <3tk.IcAv.2hxeeWc9bS7.1ZsM4C@seznam.cz>

Hello guys,



it is possible to update the MVT tileset using ogr2ogr?




My data often changes and I would need to reseed tiles in the specific area 
given by MBR.




I am looking for similar functionality as GeoServer provides (https://docs.
geoserver.org/latest/en/user/geowebcache/rest/seed.html
(https://docs.geoserver.org/latest/en/user/geowebcache/rest/seed.html)).




Thank you for your answer.




Best regards,

Linda Kladivova
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230131/415c84cb/attachment.htm>

From even.rouault at spatialys.com  Tue Jan 31 11:02:37 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2023 20:02:37 +0100
Subject: [gdal-dev] Updating the MVT tile set using ogr2ogr
In-Reply-To: <3tk.IcAv.2hxeeWc9bS7.1ZsM4C@seznam.cz>
References: <3tk.IcAv.2hxeeWc9bS7.1ZsM4C@seznam.cz>
Message-ID: <a2f3236e-8847-2cf6-81b9-a82fb1e9de3d@spatialys.com>

Linda,

you'll have to do a bit of manual work. You may use the -spat option of 
ogr2ogr with bounds that exactly match the bounds of affected MVT tiles 
in EPSG:3857, and then move the generated .pbf tiles back to the full 
dataset.

Even

Le 31/01/2023 ? 19:42, Linda Kladivov? a ?crit?:
> Hello guys,
>
> it is possible to update the MVT tileset using ogr2ogr?
>
> My data often changes and I would need to reseed tiles in the specific 
> area given by MBR.
>
> I am looking for similar functionality as GeoServer provides 
> (https://docs.geoserver.org/latest/en/user/geowebcache/rest/seed.html).
>
> Thank you for your answer.
>
> Best regards,
> Linda Kladivova
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Tue Jan 31 11:08:04 2023
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 31 Jan 2023 20:08:04 +0100
Subject: [gdal-dev] Updating the MVT tile set using ogr2ogr
In-Reply-To: <a2f3236e-8847-2cf6-81b9-a82fb1e9de3d@spatialys.com>
References: <3tk.IcAv.2hxeeWc9bS7.1ZsM4C@seznam.cz>
 <a2f3236e-8847-2cf6-81b9-a82fb1e9de3d@spatialys.com>
Message-ID: <57680d3c-6cd7-6f62-95ea-8fad4cf55a08@spatialys.com>

Actually you may need to actually use -clipdst to avoid generating 
partial tiles.

Le 31/01/2023 ? 20:02, Even Rouault a ?crit?:
> Linda,
>
> you'll have to do a bit of manual work. You may use the -spat option 
> of ogr2ogr with bounds that exactly match the bounds of affected MVT 
> tiles in EPSG:3857, and then move the generated .pbf tiles back to the 
> full dataset.
>
> Even
>
> Le 31/01/2023 ? 19:42, Linda Kladivov? a ?crit?:
>> Hello guys,
>>
>> it is possible to update the MVT tileset using ogr2ogr?
>>
>> My data often changes and I would need to reseed tiles in the 
>> specific area given by MBR.
>>
>> I am looking for similar functionality as GeoServer provides 
>> (https://docs.geoserver.org/latest/en/user/geowebcache/rest/seed.html).
>>
>> Thank you for your answer.
>>
>> Best regards,
>> Linda Kladivova
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From L.Kladivova at seznam.cz  Tue Jan 31 11:19:38 2023
From: L.Kladivova at seznam.cz (=?utf-8?q?Linda_Kladivov=C3=A1?=)
Date: Tue, 31 Jan 2023 20:19:38 +0100 (CET)
Subject: [gdal-dev] Updating the MVT tile set using ogr2ogr
In-Reply-To: <57680d3c-6cd7-6f62-95ea-8fad4cf55a08@spatialys.com>
References: <3tk.IcAv.2hxeeWc9bS7.1ZsM4C@seznam.cz>
 <a2f3236e-8847-2cf6-81b9-a82fb1e9de3d@spatialys.com>
 <57680d3c-6cd7-6f62-95ea-8fad4cf55a08@spatialys.com>
Message-ID: <3wK.Ic9F.dCgYOCe9xM.1ZsMdA@seznam.cz>


Even,




thank you for your quick answer. Just one quick question - is it possible to
do what you suggest with vector tiles in a user-defined tiling scheme (CRS 
which I use is EPSG:5514)?




Thanks!


Linda

---------- P?vodn? e-mail ----------
Od: Even Rouault <even.rouault at spatialys.com>
Komu: Linda Kladivov? <L.Kladivova at seznam.cz>, gdal-dev at lists.osgeo.org
Datum: 31. 1. 2023 20:08:08
P?edm?t: Re: [gdal-dev] Updating the MVT tile set using ogr2ogr
"Actually you may need to actually use -clipdst to avoid generating 
partial tiles. 

Le 31/01/2023 ? 20:02, Even Rouault a ?crit?: 
> Linda, 
> 
> you'll have to do a bit of manual work. You may use the -spat option 
> of ogr2ogr with bounds that exactly match the bounds of affected MVT 
> tiles in EPSG:3857, and then move the generated .pbf tiles back to the 
> full dataset. 
> 
> Even 
> 
> Le 31/01/2023 ? 19:42, Linda Kladivov? a ?crit?: 
>> Hello guys, 
>> 
>> it is possible to update the MVT tileset using ogr2ogr? 
>> 
>> My data often changes and I would need to reseed tiles in the 
>> specific area given by MBR. 
>> 
>> I am looking for similar functionality as GeoServer provides 
>> (https://docs.geoserver.org/latest/en/user/geowebcache/rest/seed.html). 
>> 
>> Thank you for your answer. 
>> 
>> Best regards, 
>> Linda Kladivova 
>> 
>> _______________________________________________ 
>> gdal-dev mailing list 
>> gdal-dev at lists.osgeo.org 
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev 
> 
-- 
http://www.spatialys.com 
My software is free, but my time generally not. 

"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20230131/f5511d20/attachment-0001.htm>

